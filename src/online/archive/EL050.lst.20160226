* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page   1
* EL050.cbl
* Options: int("EL050.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL050.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL050.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL050.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL050 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/07/94 08:48:38.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.032.
     9*
    10
    11*AUTHOR.     LOGIC, INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page   2
* EL050.cbl
    14*REMARKS.
    15*            THIS SUBROUTINE IS THE EDIT ROUTINE FOR THE
    16*            ON-LINE CREDIT SYSTEM.
    17*
    18******************************************************************
    19*                   C H A N G E   L O G
    20*
    21* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    22*-----------------------------------------------------------------
    23*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    24* EFFECTIVE    NUMBER
    25*-----------------------------------------------------------------
    26* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    27* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    28*                          SMVA  ADD NEW CLM TYPE G FOR SECURE PAY
    29* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
    30*                                IS OPEN OR CNC DT < PD THRU
    31* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
    32* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
    33* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
    34* 042709  CR2009031600001  AJRA  ADD VIN UPDATE TO CERT TRAILER
    35* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
    36* 060710  CR2009061500002  AJRA  NO REFUND FLAG WHEN NO DISAB REFU
    37* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
    38* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
    39* 042412  IR2012042300001  AJRA  FIX MSG FOR AH CLOSED CLAIM
    40* 061412  CR2011022800001  AJRA  NAPERSOFT
    41* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    42* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
    43* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    44* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    45* 111113  CR2013110500002  AJRA  ALLOW CANCEL WHEN CLAIM DENIED
    46* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
    47* 040914  IR2014040900001  AJRA  CHECK ALL OPEN/CLOSED CLAIMS
    48* 050614  IR2014050500002  AJRA  ALLOW CANCEL OF OLD COVERAGE
    49* 051914  CR2014043000002  TANA  CHANGE EDIT FOR CANCEL DATE
    50* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    51* 091114  IR2014091000001  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
    52*                                CERT #, ADD 2898 FORCIBLE ERROR
    53* 072215  IR2015031000002  PEMA  CHG EDIT FOR ERROR 2889
    54******************************************************************
    55 ENVIRONMENT DIVISION.
    56
    57 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page   3
* EL050.cbl
    59 WORKING-STORAGE SECTION.
    60 01  DFH-START PIC X(04).
    61
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  EL050   WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '*********** VMOD 2.032 *********'.
    65
    66 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP VALUE +0.
    67 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    68                                   USAGE POINTER.
    69 77  FILLER                        PIC S9(8)   COMP VALUE +0.
    70 77  ERPLAN-WS-COMP                PIC S9(8)   COMP VALUE +0.
    71 77  ERPLAN-POINTER  REDEFINES ERPLAN-WS-COMP
    72                                   USAGE IS POINTER.
    73 77  ELCNTL-WS-COMP                PIC S9(8)   COMP VALUE +0.
    74 77  ELCNTL-POINTER  REDEFINES ELCNTL-WS-COMP
    75                                   USAGE IS POINTER.
    76 77  ERACCT-WS-COMP                PIC S9(8)   COMP VALUE +0.
    77 77  ERACCT-POINTER  REDEFINES ERACCT-WS-COMP
    78                                   USAGE IS POINTER.
    79
    80 77  ERFORM-WS-COMP                PIC S9(8)   COMP VALUE +0.
    81 77  ERFORM-POINTER  REDEFINES ERFORM-WS-COMP
    82                                   USAGE IS POINTER.
    83
    84*    COPY ELC50WS.
    85*****************************************************************
    86*                                                               *
    87*                            ELC50WS.                           *
    88*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    89*                            VMOD=2.061.                        *
    90*                                                               *
    91*   THIS IS THE WORKING STORAGE FOR EL050                       *
    92*                                   EL517                       *
    93*****************************************************************
    94******************************************************************
    95*                   C H A N G E   L O G
    96*
    97* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    98*-----------------------------------------------------------------
    99*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   100* EFFECTIVE    NUMBER
   101*-----------------------------------------------------------------
   102* 123102                   PEMA  ADD DCC PROCESSING
   103* 082003  CR2002100700004  PEMA  ADD ER-2702 TO SUPPORT ERROR
   104* 082203  CR2003040800006  PEMA  ADD CERT NO ERROR
   105* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
   106* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   107* 111504  CR2004110300005  PEMA  SPLIT SPP BANK COMMISSION
   108* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
   109* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
   110* 092205  CR2005050300006  PEMA  ADD PROCESSING FOR SPP LEASE
   111* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
   112* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
   113* 071906  CR2006012700002  PEMA  ADD 'MI' AND 'MU' TO AH CASH
   114* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
   115* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
   116* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page   4
* EL050.cbl
   117* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
   118* 022608  CR2008022100006  PEMA  CHANGE NC TRUNC ERROR MESSAGE
   119* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   120* 102908  CR2007091400001  PEMA  ADD NEW ERROR 2882
   121* 030309  CR2009021700001  PEMA  ADD ER-2883
   122* 042709  CR2009031600001  AJRA  ADD ELCRTT VIN UPDATE
   123* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   124* 012010  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   125* 071910  CR2010042900001  PEMA  SEPARATE CITY AND STATE
   126* 101010  CR2010012700001  PEMA  DEALER DIRECT FLAT FEE
   127* 011211  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
   128* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
   129* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
   130* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   131* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
   132* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
   133* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   134* 061412  CR2011022800001  AJRA  NAPERSOFT
   135* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   136* 012213  CR2013011600001  PEMA  ADD ERROR 3058
   137* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
   138* 101314  IR2013100100002  PEMA  ADD ERROR 1572
   139* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
   140* 021714  CR2013080900002  PEMA  ADD ERROR 1573 and 1574
   141* 040914  IR2014040900001  AJRA  ADD ERROR 2896
   142* 051914  CR2014043000002  TANA  ADD CAUSAL STATE AND ERROR 2897
   143* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   144* 091114  IR2014091000001  TANA  ADD ERROR 2898
   145* 121815  CR2015121700006  PEMA  ADD ERROR 3827
   146*-----------------------------------------------------------------
   147
   148 01  WORK-AREAS.
   149
   150*****************************************************************
   151*        WORKING STORAGE AREA FOR CLIENT-MON                    *
   152*****************************************************************
   153
   154     12  WS-SUB                   PIC S9(4)     COMP    VALUE +0.
   155     12  WS-SUB1                  PIC S9(4)     COMP    VALUE +0.
   156     12  WS-SUB2                  PIC S9(4)     COMP    VALUE +0.
   157     12  WS-NAME-EDIT-WORK-AREA.
   158         16  WS-WORK-MEMB-NAME    PIC X(6)      VALUE SPACES.
   159         16  WS-WORK-MEMB-TABLE   REDEFINES WS-WORK-MEMB-NAME.
   160             20  WS-MEMB-LETTER   OCCURS 6 TIMES PIC X.
   161         16  WS-WORK-NAME.
   162             20  WS-WORK-LETTER-1 PIC X         VALUE SPACES.
   163             20  WS-WORK-LETTER-2 PIC X         VALUE SPACES.
   164             20  FILLER           PIC X(10)     VALUE SPACES.
   165         16  WS-WORK-TABLE REDEFINES WS-WORK-NAME.
   166             20  WS-TBL-LETTER OCCURS 12 TIMES PIC X.
   167
   168*****************************************************************
   169*        END OF WORKING STORAGE FOR CLIENT-MON                  *
   170*****************************************************************
   171
   172     12  WS-ERRESC-KEY.
   173         16 WS-ERRESC-SEARCH-KEY.
   174             20  WS-ERRESC-COMPANY-CD PIC  X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page   5
* EL050.cbl
   175             20  WS-ERRESC-CARRIER    PIC  X.
   176             20  WS-ERRESC-GROUP      PIC X(6).
   177             20  WS-ERRESC-STATE      PIC XX.
   178             20  WS-ERRESC-ACCOUNT    PIC X(10).
   179         16 WS-ERRESC-RESIDUAL-KEY.
   180             20  WS-ERRESC-AGENT      PIC X(10).
   181             20  WS-ERRESC-RES-STATE  PIC XX.
   182             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
   183*                                          YYYYMMDD
   184     12  WS-COMMISSION                PIC SV9(5) COMP-3.
   185     12  FILE-ID-ERRESC               PIC X(8)   VALUE 'ERRESC'.
   186
   187*RESIDENT STATE TAX MASTER(ERRESS)
   188*
   189     12  WS-ERRESS-KEY.
   190         16  WS-ERRESS-COMPANY-CD      PIC  X.
   191         16  WS-ERRESS-RESIDENT-STATE  PIC XX.
   192         16  WS-ERRESS-COVERAGE-CAT    PIC  X.
   193         16  WS-ERRESS-EXPIRE-DT       PIC 9(8) COMP-3.
   194*                                          YYYYMMDD
   195
   196     12  WS-CONTRACT-DATE              PIC 9(8).
   197*                                          YYYYMMDD
   198     12  WS-NEXT-CONTRACT-DATE         PIC 9(8).
   199     12  FILLER REDEFINES WS-NEXT-CONTRACT-DATE.
   200         16 WS-YEAR-YY                 PIC   9999.
   201         16 FILLER                     PIC 9(4).
   202*                                          YYYYMMDD
   203     12  WS-SAVE-ERRESS-KEY            PIC X(9).
   204     12  WS-RES-STATE-TAX              PIC SV9(5) COMP-3.
   205     12  WS-RES-MUNI-TAX               PIC SV9(5) COMP-3.
   206     12  FILE-ID-ERRESS                PIC X(8)  VALUE 'ERRESS'.
   207
   208     12  DPRB-1ST-TIME-SW              PIC X     VALUE SPACE.
   209         88  DPRB-1ST-TIME                      VALUE ' '.
   210
   211*****************************************************************
   212*        END OF WORKING STORAGE FOR CLIENT-DMD                  *
   213*****************************************************************
   214
   215     12  WS-SAVE-ST-ELCNTL       PIC X(750)     VALUE LOW-VALUES.
   216     12  WS-AGE-AT-EXPIRE        PIC 99         VALUE ZERO.
   217     12  WS-ST-LF-PREM-TAX       PIC S9V9(4) COMP-3 VALUE +0.
   218     12  WS-ST-AH-PREM-TAX-I     PIC S9V9(4) COMP-3 VALUE +0.
   219     12  WS-ST-AH-PREM-TAX-G     PIC S9V9(4) COMP-3 VALUE +0.
   220     12  WS-ST-REFUND-CLAIM-FLAG PIC X          VALUE SPACES.
   221     12  WS-ST-CAUSAL-STATE      PIC X          VALUE SPACES.
   222     12  ws-st-agent-sig-edit    pic x          value spaces.
   223     12  WS-ERROR                PIC S9(4)       VALUE +0 COMP.
   224     12  WS-CSL-AMT1              PIC S9(7)V99  COMP-3  VALUE +0.
   225     12  WS-CSL-AMT2              PIC S9(7)V99  COMP-3  VALUE +0.
   226     12  WS-AH-BENEFIT-CD         PIC XX        VALUE ZERO.
   227         88 POLICY-HAS-AH            VALUE '01' THRU '89'.
   228         88 NO-AH-COVERAGE           VALUE '  ' '00'.
   229     12  WS-LF-BENEFIT-CD         PIC XX        VALUE ZERO.
   230         88 POLICY-HAS-LIFE          VALUE '01' THRU '89'.
   231         88 NO-LIFE-COVERAGE         VALUE '  ' '00'.
   232     12  WS-CERT-EFF-DT           PIC XX        VALUE LOW-VALUE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page   6
* EL050.cbl
   233
   234     12  WS-AH-COMP-CD            PIC XX        VALUE ZERO.
   235     12  WS-LF-COMP-CD            PIC XX        VALUE ZERO.
   236
   237     12  WS-R78-METHOD            PIC X         VALUE SPACES.
   238     12  WS-COMP-MAX-CAP          PIC S9(3)V99  COMP-3  VALUE +0.
   239     12  WS-PL-TOL-LF-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   240     12  WS-PL-TOL-LF-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   241     12  WS-PL-TOL-LF-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   242     12  WS-PL-TOL-LF-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   243     12  WS-PL-TOL-LF-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   244     12  WS-PL-TOL-AH-CLAIM       PIC S9(3)V99  COMP-3  VALUE +0.
   245     12  WS-PL-TOL-AH-PREM        PIC S9(3)V99  COMP-3  VALUE +0.
   246     12  WS-PL-TOL-AH-REFUND      PIC S9(3)V99  COMP-3  VALUE +0.
   247     12  WS-PL-TOL-AH-PREM-PCT    PIC S9V9(4)   COMP-3  VALUE +0.
   248     12  WS-PL-TOL-AH-REFUND-PCT  PIC S9V9(4)   COMP-3  VALUE +0.
   249     12  WS-PL-SALES-TAX          PIC S9V9(4)   COMP-3  VALUE +0.
   250     12  WS-LIFE-REVISION         PIC XXX   VALUE SPACES.
   251     12  WS-AH-REVISION           PIC XXX   VALUE SPACES.
   252     12  WS-MINIMUM-REFUND        PIC S9(3)V99  COMP-3  VALUE +0.
   253     12  WS-TOL-LF-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   254     12  WS-TOL-LF-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   255     12  WS-TOL-LF-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   256     12  WS-TOL-AH-CLAIM          PIC S9(3)V99  COMP-3  VALUE +0.
   257     12  WS-TOL-AH-PREM           PIC S9(3)V99  COMP-3  VALUE +0.
   258     12  WS-TOL-AH-REFUND         PIC S9(3)V99  COMP-3  VALUE +0.
   259     12  WS-TOL-LF-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   260     12  WS-TOL-LF-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   261     12  WS-TOL-AH-HIGH-PREM-PCT  PIC S9(7)V99  COMP-3  VALUE +0.
   262     12  WS-TOL-AH-LOW-PREM-PCT   PIC S9(7)V99  COMP-3  VALUE +0.
   263     12  WS-TOL-LF-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   264     12  WS-TOL-LF-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   265     12  WS-TOL-AH-HIGH-PREM-AMT  PIC S9(7)V99  COMP-3  VALUE +0.
   266     12  WS-TOL-AH-LOW-PREM-AMT   PIC S9(7)V99  COMP-3  VALUE +0.
   267     12  WS-TOL-LF-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   268     12  WS-TOL-LF-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   269     12  WS-TOL-AH-PREM-PCT       PIC S9V9(4)   COMP-3  VALUE +0.
   270     12  WS-TOL-AH-REFUND-PCT     PIC S9V9(4)   COMP-3  VALUE +0.
   271     12  WS-PAYMENT-AMT           PIC S9(7)V99  COMP-3  VALUE +0.
   272     12  WS-LF-BENEFIT-AMT        PIC S9(11)V99 COMP-3  VALUE +0.
   273     12  WS-FREE-LOOK-PERIOD      PIC S9(03)    COMP-3  VALUE +0.
   274     12  WS-CSL-CALC-CD           PIC X         VALUE SPACES.
   275     12  WS-PREM-REJECT-SW        PIC X         VALUE SPACES.
   276     12  WS-REF-REJECT-SW         PIC X         VALUE SPACES.
   277     12  WS-IG-OVRD-AH-PL         PIC X         VALUE SPACES.
   278     12  WS-IG-OVRD-LF-PL         PIC X         VALUE SPACES.
   279     12  WS-IG-OVRD-AM            PIC X         VALUE SPACES.
   280     12  WS-IG-OVRD-AH-BEN        PIC X         VALUE SPACES.
   281     12  WS-IG-OVRD-LF-BEN        PIC X         VALUE SPACES.
   282     12  WS-IG-OVRD-AH            PIC X         VALUE SPACES.
   283     12  WS-IG-OVRD-LF            PIC X         VALUE SPACES.
   284     12  WS-IG-OVRD               PIC X         VALUE SPACES.
   285     12  WS-BIRTH-DATE-FLAG       PIC X         VALUE SPACES.
   286     12  WS-JOINT-AGE-FLAG        PIC X         VALUE SPACES.
   287     12  WS-CURRENT-MONTH-END     PIC XX        VALUE LOW-VALUE.
   288     12  WS-REM-TRM-CALC-OPTION   PIC X         VALUE SPACE.
   289     12  WS-2671-SW               PIC X         VALUE SPACE.
   290     12  WS-2672-SW               PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page   7
* EL050.cbl
   291     12  WS-OUTSIDE-AMT-LIMITS    PIC X         VALUE SPACE.
   292         88  OUTSIDE-AMT-LIMITS                 VALUE 'Y'.
   293     12  WS-FUTURE-CANCEL-DT-SW   PIC X         VALUE SPACE.
   294         88  CANCEL-FUTURE-DT                   VALUE 'Y'.
   295     12  W-BROWSE-SW              PIC X         VALUE SPACE.
   296
   297     12  WS-FILE-ADDRESSED        PIC X    VALUE SPACE.
   298         88  ELCNTL-FILE-ADDRESSED              VALUE '1'.
   299         88  ERPLAN-FILE-ADDRESSED              VALUE '2'.
   300         88  ERFORM-FILE-ADDRESSED              VALUE '3'.
   301         88  ERACCT-FILE-ADDRESSED              VALUE '4'.
   302
   303     12  WS-CREDIT-EDIT-CONTROLS.
   304         16  WS-MIN-PREMIUM       PIC S9(3)V99  COMP-3  VALUE +0.
   305         16  WS-MIN-AGE           PIC 99                VALUE  0.
   306         16  WS-DEFAULT-AGE       PIC 99                VALUE  0.
   307         16  WS-MIN-TERM          PIC S9(3)     COMP-3  VALUE +0.
   308         16  WS-MAX-TERM          PIC S9(3)     COMP-3  VALUE +0.
   309         16  WS-DEFAULT-SEX       PIC X         VALUE SPACE.
   310
   311     12  WS-AGE-FIELDS.
   312         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   313         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   314         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   315         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   316
   317     12  WS-SAVE-ALLOWABLE-BENEFIT.
   318         16  WS-SAVE-BENEFIT-CODE       PIC XX.
   319         16  WS-SAVE-BENEFIT-TYPE       PIC X.
   320         16  WS-SAVE-BENEFIT-REVISION   PIC XXX.
   321         16  WS-SAVE-BENEFIT-REM-TERM   PIC X.
   322         16  WS-SAVE-BENEFIT-RETRO-Y-N  PIC X.
   323         16  FILLER                      PIC XX.
   324
   325     12  WS-DEFAULT-APR           PIC S9(3)V9(4) COMP-3 VALUE +0.
   326     12  WS-STATE-ABBREVIATION    PIC XX        VALUE SPACES.
   327     12  WS-CLP-STATE             PIC XX        VALUE SPACES.
   328     12  WS-TOL-CLP-PCT           PIC S9V9(4)   COMP-3 VALUE +0.
   329     12  WS-SPP-LEASE-COMM        PIC S9(5)V99  COMP-3 VALUE +0.
   330     12  WS-BANK-FEE              PIC S999V99   COMP-3 VALUE +0.
   331     12  WS-BANK-LFEE             PIC S999V99   COMP-3 VALUE +0.
   332     12  WS-BANK-NOCHRGB          PIC 99        VALUE ZEROS.
   333     12  WS-DCC-LF-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   334     12  WS-DCC-AH-RATE           PIC S99V9(5)  COMP-3 VALUE +0.
   335
   336     12  WS-LF-REM-TERM-CALC      PIC X         VALUE SPACE.
   337     12  WS-AM-LF-BENE-REM-TERM   PIC X         VALUE SPACE.
   338     12  WS-LF-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   339     12  WS-LF-REFUND-CALC        PIC X         VALUE SPACE.
   340     12  WS-LF-SPECIAL-CALC-CD    PIC X         VALUE SPACE.
   341     12  WS-LF-EARNINGS-CALC      PIC X         VALUE SPACE.
   342     12  WS-LF-JOINT-INDICATOR    PIC X         VALUE SPACE.
   343     12  WS-LF-COVERAGE-TYPE      PIC X         VALUE SPACE.
   344         88  WS-REDUCING              VALUE 'R'.
   345         88  WS-LEVEL                 VALUE 'L' 'P'.
   346     12  WS-LF-BEN-CATEGORY       PIC X         VALUE SPACES.
   347
   348     12  WS-AH-REM-TERM-CALC      PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page   8
* EL050.cbl
   349     12  WS-AM-AH-BENE-REM-TERM   PIC X         VALUE SPACE.
   350     12  WS-AH-BENEFIT-ALPHA      PIC X(3)      VALUE SPACES.
   351     12  WS-AH-REFUND-CALC        PIC X         VALUE SPACES.
   352     12  WS-AH-SPECIAL-CALC-CD    PIC X         VALUE SPACES.
   353     12  ws-ah-max-bens           pic 99        value zeros.
   354     12  WS-AH-EARNINGS-CALC      PIC X         VALUE SPACES.
   355     12  WS-AH-JOINT-INDICATOR    PIC X         VALUE SPACES.
   356     12  WS-AH-BEN-CATEGORY       PIC X         VALUE SPACES.
   357     12  WS-AH-DCC-TRUNC          PIC X         VALUE SPACES.
   358
   359     12  WS-ACCT-REIN-TABLE       PIC XXX       VALUE SPACES.
   360     12  WS-ACCT-STATUS           PIC X         VALUE SPACES.
   361     12  WS-ACCT-STD-AH-TYPE      PIC XX        VALUE SPACES.
   362     12  WS-ACCT-LF-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   363     12  WS-ACCT-LF-DEVIATION     PIC XXX       VALUE SPACES.
   364     12  WS-ACCT-AH-DEV-PCT       PIC S9V9(6)   COMP-3 VALUE ZERO.
   365     12  WS-ACCT-AH-DEVIATION     PIC XXX       VALUE SPACES.
   366     12  WS-ACCT-CLASS-TABLE      PIC XX        VALUE SPACES.
   367     12  WS-ACCT-USER-FLD-5       PIC XX        VALUE SPACES.
   368     12  WS-ACCT-BUSINESS-TYPE    PIC XX        VALUE SPACES.
   369     12  WS-ACCT-SIG-SW.
   370         16  WS-ACCT-SIG-SW-A     PIC X         VALUE SPACES.
   371         16  WS-ACCT-SIG-SW-B     PIC X         VALUE SPACES.
   372     12  WS-ACCT-AH-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   373     12  WS-ACCT-LF-OB-RT         PIC S99V9(5)  COMP-3 VALUE ZERO.
   374     12  WS-ACCT-ADDL-CLP         PIC S9(5)V99  COMP-3 VALUE +0.
   375     12  WS-ACCT-I-CLP            PIC S9(5)V99  COMP-3 VALUE +0.
   376     12  WS-ADMIN-FEES            PIC S9(5)V99  COMP-3 VALUE +0.
   377     12  WS-CSO-ADMIN-FEE         PIC S9(5)V99  COMP-3 VALUE +0.
   378     12  ws-cred-union-fees       pic s9(5)v99  comp-3 value +0.
   379     12  WS-1ST-YR-ALLOW          PIC S9(5)V99  COMP-3 VALUE +0.
   380     12  WS-COMM-AND-MFEE         PIC S9(5)V99  COMP-3 VALUE +0.
   381     12  WS-INITIALS.
   382         16  WS-INIT-1            PIC X         VALUE SPACES.
   383         16  WS-INIT-2            PIC X         VALUE SPACES.
   384
   385     12  WS-EDIT-LOAN-OFC-SW    PIC X(01)       VALUE 'N'.
   386     12  WS-ERROR-LINE          PIC X(72)       VALUE SPACES.
   387     12  WS-CURRENT-BIN-DT      PIC XX     VALUE LOW-VALUES.
   388     12  WS-CANCEL-EXIT-DT      PIC XX     VALUE LOW-VALUES.
   389     12  WS-ATT-AGE             PIC S9(3)V99    COMP-3 VALUE +0.
   390*    12  WS-ATT-AGE             PIC 99          COMP-3 VALUE ZERO.
   391     12  WS-WORK-AGE            PIC S999        COMP-3 VALUE ZERO.
   392     12  WS-EDIT-AGE            PIC S999        COMP-3 VALUE ZERO.
   393     12  WS-AH-EDIT-AGE         PIC S999        COMP-3 VALUE ZERO.
   394     12  WS-LF-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   395     12  WS-AH-MAX-ISSUE-AGE    PIC S999        COMP-3 VALUE ZERO.
   396     12  WS-WORK-TERM           PIC S999        COMP-3 VALUE ZERO.
   397     12  WS-WORK-RATE           PIC S99V9(5)    COMP-3 VALUE ZERO.
   398     12  WS-WK-RATE             PIC SV9(5)      COMP-3 VALUE ZERO.
   399     12  WS-COMM-CK-AMT         PIC S9(7)V99    COMP-3 VALUE ZERO.
   400     12  WS-TEX-FACT-2          PIC S9(3)       COMP-3 VALUE ZERO.
   401     12  WS-TEX-FACT-3          PIC S9(3)       COMP-3 VALUE ZERO.
   402     12  WS-WK-C1               PIC S9(7)       COMP-3 VALUE ZERO.
   403     12  WS-WK-C2               PIC S9(7)       COMP-3 VALUE ZERO.
   404     12  WS-WK-C3               PIC S9(7)V99    COMP-3 VALUE ZERO.
   405     12  WS-WK-C4               PIC S9(7)V99    COMP-3 VALUE ZERO.
   406     12  WS-CALC-WORK           PIC S9(8)V9(5)  COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page   9
* EL050.cbl
   407     12  WS-UNSIGN-WRK1         PIC 9(9)V99     COMP-3 VALUE ZERO.
   408     12  WS-UNSIGN-WRK2         PIC 9(9)V99     COMP-3 VALUE ZERO.
   409     12  WS-UNSIGN-WRK3         PIC 9(9)V99     COMP-3 VALUE ZERO.
   410     12  WS-UNSIGN-WRK4         PIC 9(9)V99     COMP-3 VALUE ZERO.
   411     12  WS-UNSIGN-WRK5         PIC 9(9)V99     COMP-3 VALUE ZERO.
   412     12  WS-UNSIGN-WRK6         PIC 9(9)V99     COMP-3 VALUE ZERO.
   413******** FLA
   414     12  WS-SIGN-WRK1           PIC S9(7)V99    COMP-3 VALUE ZERO.
   415     12  WS-SIGN-WRK2           PIC S9(7)V99    COMP-3 VALUE ZERO.
   416     12  WS-SIGN-WRK4           PIC S9(7)V99    COMP-3 VALUE ZERO.
   417     12  WS-SV-LF-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   418     12  WS-SV-AH-CANCEL-DT     PIC XX    VALUE LOW-VALUES.
   419********
   420     12  WS-SAVE-PREM-CHECK     PIC S9(5)V99    COMP-3 VALUE ZERO.
   421     12  WS-SAVE-REFUND-CHECK   PIC S9(5)V99    COMP-3 VALUE ZERO.
   422     12  WS-SAVE-CLAIM-CHECK    PIC S9(5)V99    COMP-3 VALUE ZERO.
   423     12  WS-WORK-MAX-BENEFIT-AMT PIC S9(5)V99   COMP-3 VALUE ZERO.
   424     12  WS-AEC-WORK-AREA       PIC 9(5)V99     COMP-3 VALUE ZERO.
   425     12  WS-AEC-SIGNED-AREA     PIC S9(5)V99    COMP-3 VALUE +0.
   426     12  WS-LOOKUP-TYPE         PIC X      VALUE SPACE.
   427     12  WS-EXPIRE-DT           PIC XX     VALUE LOW-VALUES.
   428     12  WS-TERM                PIC S9(3)       COMP-3 VALUE +0.
   429     12  WS-CLAIM-ATTACHED-COUNT PIC S9(4)      COMP   VALUE +0.
   430
   431     12  WS-SKIP-CODE-CHECK     PIC X    VALUE ' '.
   432         88  VALID-SKIP-CODE       VALUE ' ' 'A' 'X'
   433                                         '0' THRU '9'.
   434
   435     12  NUMBER-OF-MONTHS.
   436         16  SK-MO OCCURS 12 TIMES PIC X.
   437
   438     12  WS-WORK-DATE.
   439         16  WS-YEAR            PIC 99    VALUE 00.
   440         16  WS-MONTH           PIC 99    VALUE 00.
   441         16  WS-DAY             PIC 99    VALUE 00.
   442
   443     12  WS-WORK-LF-CRIT-PER    PIC 9(03)   VALUE ZEROS.
   444     12  WS-WORK-CRIT-DEV       REDEFINES
   445         WS-WORK-LF-CRIT-PER    PIC X(03).
   446
   447     12  WS-ODD-DAYS-OVER       PIC 9(3)      VALUE ZERO.
   448     12  WS-DAYS-TO-1ST-PMT     PIC 9(3)      VALUE ZERO.
   449
   450     12  WS-WORK-DATE-FROM.
   451         16  WS-WDF-MONTH       PIC 99        VALUE ZERO.
   452         16  FILLER             PIC X  VALUE SPACE.
   453         16  WS-WDF-DAY         PIC 99        VALUE ZERO.
   454         16  FILLER             PIC X         VALUE SPACE.
   455         16  WS-WDF-YEAR        PIC 99        VALUE ZERO.
   456
   457     12  WS-WORK-DATE-THRU.
   458         16  WS-WDT-MONTH       PIC 99        VALUE ZERO.
   459         16  FILLER             PIC X         VALUE SPACE.
   460         16  WS-WDT-DAY         PIC 99        VALUE ZERO.
   461         16  FILLER             PIC X         VALUE SPACE.
   462         16  WS-WDT-YEAR        PIC 99        VALUE ZERO.
   463
   464     12  WS-LF-INPUT-CD.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  10
* EL050.cbl
   465         16  WS-LF-INPUT-CD-1   PIC X     VALUE ' '.
   466         16  WS-LF-INPUT-CD-2   PIC X     VALUE ' '.
   467
   468     12  WS-AH-INPUT-CD         PIC XXX       VALUE SPACES.
   469     12  WS-AH-INPUT-CD-R REDEFINES WS-AH-INPUT-CD.
   470         16  WS-AH-INPUT-CD-1   PIC X.
   471         16  WS-AH-INPUT-CD-2-3 PIC XX.
   472
   473     12  WS-SWITCHES.
   474         16  DATE-RANGE-SW            PIC X    VALUE SPACES.
   475         16  ACCOUNT-MAST-FOUND-SW    PIC X    VALUE SPACES.
   476             88  ACCOUNT-MAST-FOUND       VALUE 'Y'.
   477         16  BANK-ACCT-SW             PIC X    VALUE SPACES.
   478             88  BANK-ACCT-FOUND          VALUE 'Y'.
   479         16  AGTC-MASTER-SW           PIC X    VALUE SPACES.
   480             88  AGENT-MASTER-FOUND       VALUE 'Y'.
   481         16  BXRF-MASTER-SW           PIC X    VALUE SPACES.
   482             88  BXRF-MASTER-FOUND        VALUE 'Y'.
   483         16  COMP-MASTER-SW           PIC X    VALUE SPACES.
   484             88  COMP-MASTER-FOUND        VALUE 'Y'.
   485         16  LOFC-MASTER-SW           PIC X    VALUE SPACES.
   486             88  LOFC-MASTER-FOUND        VALUE 'Y'.
   487         16  PDEF-MASTER-SW           PIC X    VALUE SPACES.
   488             88  PDEF-MASTER-FOUND        VALUE 'Y'.
   489         16  STAT-MASTER-SW           PIC X    VALUE SPACES.
   490             88  STAT-MASTER-FOUND        VALUE 'Y'.
   491         16  PLAN-MASTER-SW           PIC X    VALUE SPACES.
   492             88  PLAN-MASTER-FOUND        VALUE 'Y'.
   493         16  PLAN-MASTER-LIFE-SW      PIC X    VALUE SPACES.
   494             88  LF-PLAN-MASTER-FOUND     VALUE 'Y'.
   495         16  PLAN-MASTER-AH-SW        PIC X    VALUE SPACES.
   496             88  AH-PLAN-MASTER-FOUND     VALUE 'Y'.
   497         16  FORM-MASTER-SW           PIC X(1) VALUE SPACES.
   498             88  FORM-MASTER-FOUND        VALUE 'Y'.
   499         16  FORM-MASTER-LIFE-SW      PIC X(1) VALUE SPACES.
   500             88  LF-FORM-MASTER-FOUND     VALUE 'Y'.
   501         16  FORM-MASTER-AH-SW        PIC X(1) VALUE SPACES.
   502             88  AH-FORM-MASTER-FOUND     VALUE 'Y'.
   503         16  PROCESS-FORM-EDITS-SW    PIC X(1) VALUE SPACES.
   504             88  PROCESS-FORM-EDITS       VALUE 'Y'.
   505         16  BEN-SEARCH-SW            PIC X    VALUE SPACES.
   506             88  NO-BENEFIT-FOUND         VALUE 'N'.
   507         16  ACCOUNT-LIFE-CK-SW       PIC X(3) VALUE SPACES.
   508             88  ACCOUNT-LIFE-CHECKED     VALUE  'YES'.
   509         16  ACCOUNT-AH-CK-SW         PIC X(3) VALUE SPACES.
   510             88  ACCOUNT-AH-CHECKED       VALUE  'YES'.
   511         16  AH-BENEFIT-ERROR         PIC X    VALUE SPACE.
   512             88  AH-BENEFIT-FOUND         VALUE ' '.
   513             88  NO-AH-BENEFIT-MATCH      VALUE '1'.
   514         16  LF-BENEFIT-ERROR         PIC X    VALUE SPACE.
   515             88  LF-BENEFIT-FOUND         VALUE ' '.
   516             88  NO-LF-BENEFIT-MATCH      VALUE '1'.
   517         16  STATE-RECORD-ERROR       PIC X    VALUE SPACES.
   518             88  NO-STATE-RECORD          VALUE '1'.
   519         16  WS-NSP-ST-CD-LF          PIC XX   VALUE SPACE.
   520             88  LF-REIN-NSP-NOT-USED     VALUE '  '.
   521         16  WS-NSP-ST-CD-AH          PIC XX   VALUE SPACE.
   522             88  AH-REIN-NSP-NOT-USED     VALUE '  '.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  11
* EL050.cbl
   523         16  CERT-STATUS-SW           PIC X    VALUE SPACE.
   524             88  CERT-WAS-FOUND           VALUE ' '.
   525             88  CERT-WAS-NOT-FOUND       VALUE '1'.
   526         16  WS-BROWSE-STARTED-SW     PIC X    VALUE SPACE.
   527             88  BROWSE-STARTED           VALUE 'Y'.
   528         16  WS-JOINT-AGE-SW          PIC X    VALUE SPACE.
   529             88  JOINT-AGE-USED-IN-EDIT   VALUE 'Y'.
   530         16  WS-CERT-ADDED-FOR-CLM-SW PIC X    VALUE SPACE.
   531             88  CERT-WAS-ADDED-FOR-CLM   VALUE 'Y'.
   532         16  WS-CERT-AND-CLM-ONLINE-SW PIC X    VALUE SPACE.
   533             88  CERT-AND-CLM-ONLINE      VALUE 'Y'.
   534         16  WS-AH-CANCEL-SW          PIC X    VALUE SPACE.
   535             88  AH-COVERAGE-CANCELLED    VALUE 'Y'.
   536         16  WS-LF-CANCEL-SW          PIC X    VALUE SPACE.
   537             88  LF-COVERAGE-CANCELLED    VALUE 'Y'.
   538         16  WS-APP-CERT-SW           PIC X    VALUE SPACE.
   539             88  APP-CERT-USED            VALUE 'Y' 'A'.
   540         16  WS-CTBL-READ-SW          PIC X    VALUE SPACE.
   541             88  CTBL-TABLE-FOUND         VALUE 'Y'.
   542             88  FIRST-TIME-THROUGH       VALUE '1'.
   543             88  CTBL-NOT-FOUND           VALUE '2'.
   544
   545         16  WS-REIN-READ-SW          PIC X    VALUE SPACE.
   546             88  REIN-TABLE-NOT-FOUND     VALUE 'N'.
   547
   548         16  WS-DLO-ERROR-SW          PIC X    VALUE SPACE.
   549             88  DLO-ERROR-FOUND          VALUE 'Y'.
   550
   551********FLA
   552     12  WS-TOLERANCE-SWITCH      PIC 9           VALUE ZERO.
   553     12  WS-SAVE-DATA-ENTRY-SW    PIC X           VALUE SPACES.
   554********
   555     12  RC-SW-1                  PIC X           VALUE '0'.
   556     12  RC-SW-2                  PIC X           VALUE '0'.
   557     12  CTBL-SW                  PIC X(4)        VALUE 'XXXX'.
   558     12  REIN-SW                  PIC X(4)        VALUE 'XXXX'.
   559     12  SUB                      PIC 9(4) COMP   VALUE ZEROS.
   560     12  SUB1                     PIC 9(4) COMP   VALUE ZEROS.
   561     12  SUB2                     PIC 9(4) COMP   VALUE ZEROS.
   562     12  SUB3                     PIC 9(4) COMP   VALUE ZEROS.
   563     12  SUB4                     PIC 9(4) COMP   VALUE ZEROS.
   564     12  SUB5                     PIC 9(4) COMP   VALUE ZEROS.
   565     12  SUB6                     PIC 9(4) COMP   VALUE ZEROS.
   566     12  IB                       PIC 9(4) COMP   VALUE ZEROS.
   567     12  LIT-SPACES               PIC X           VALUE SPACES.
   568     12  JOURNAL-LENGTH           PIC S9999 COMP  VALUE ZERO.
   569     12  ELMSTR-LENGTH            PIC S9999 COMP  VALUE +11.
   570     12  ERMAIL-FOUND             PIC X           VALUE SPACES.
   571     12  ERPNDM-FOUND             PIC X           VALUE SPACES.
   572     12  WS-LF-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   573     12  WS-AH-PMF-COMM           PIC S9V9(5) COMP-3 VALUE +0.
   574     12  WS-SECPAY-SWITCH         PIC X VALUE ' '.
   575         88  WS-SECURE-PAY-CARRIER   VALUE 'Y'.
   576         88  WS-NO-SECURE-PAY        VALUE ' ' 'N'.
   577     12  WS-SKIP-ADDR-EDIT-SW     PIC X VALUE ' '.
   578         88  SKIP-ADDR-EDIT         VALUE 'Y'.
   579
   580 01  WS-EXTRA-PERIODS-BY-STATE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  12
* EL050.cbl
   581     12  WS-INT-PERIODS          PIC 9.
   582     12  WS-EXTRA-PMTS           PIC 9.
   583 01  ws-net-only-state           pic x value 'N'.
   584 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   585     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   586     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   587 01  WS-CRI-SSN-WORK-AREA.
   588     05  WS-CRI-SOC-SEC-NO.
   589         10  WS-SS-REPT-CD       PIC X(5).
   590         10  WS-SS-LAST-NAME     PIC X(5).
   591         10  WS-SS-INITIAL       PIC X.
   592
   593     05  WS-CRI-REPORT-CODE.
   594         10  FILLER              PIC X(5).
   595         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   596
   597     05  WS-CRI-LAST-NAME.
   598         10  WS-CRI-NAME-MOVE    PIC X(5).
   599         10  FILLER              PIC X(10).
   600
   601 01  WS-NUM-TABLE                PIC X(26)  VALUE
   602     '12345678012345070923456789'.
   603 01  FILLER REDEFINES WS-NUM-TABLE.
   604     05  WS-NUM OCCURS 26        PIC 9.
   605 01  WS-WORK-FACT                PIC S9V9(6) COMP-3 VALUE +0.
   606 01  V1                          PIC S999 COMP-3.
   607 01  V2                          PIC S999 COMP-3.
   608 01  V3                          PIC S999 COMP-3.
   609 01  WS-WORK-VIN                 PIC X(17)  VALUE SPACES.
   610 01  FILLER REDEFINES WS-WORK-VIN.
   611     05  WS-WORK-VIN-N OCCURS 17        PIC 9.
   612 01  WS-VIN-TOTAL                PIC S9(9)  VALUE +0.
   613 01  WS-VIN-FINAL                PIC S9(7)  VALUE +0.
   614 01  WS-VIN-REMAINDER            PIC S999   VALUE +0.
   615 01  WS-HEX-WORK.
   616     05  FILLER                  PIC X  VALUE LOW-VALUES.
   617     05  WS-HEX-BYTE             PIC X.
   618 01  WS-CHARCD REDEFINES WS-HEX-WORK PIC S9(4)  COMP.
   619 01  WS-CHARCD-A                 PIC S9(4)   COMP VALUE +65.
   620 01  WS-WORK-HIN-ROW-B.
   621     05  WS-ROW-B-VAL OCCURS 16 PIC 9 VALUE ZERO.
   622
   623 01  ws-benefit-cd-chg-sw      pic x value spaces.
   624     88  benefit-code-chg           value 'Y'.
   625 01  WS-WORK-HIN-ROW-C       PIC X(16)  VALUE '9876543298765432'.
   626 01  FILLER REDEFINES WS-WORK-HIN-ROW-C.
   627     05  WS-ROW-C-VAL OCCURS 16  PIC 9.
   628 01  WS-ROW-D-TABLE.
   629     05  WS-ROW-D-VAL OCCURS 16 PIC S999 VALUE +0 COMP-3.
   630
   631 01  WS-HIN-TABLE-B.
   632     05  F                       PIC XX VALUE 'A2'.
   633     05  F                       PIC XX VALUE 'B3'.
   634     05  F                       PIC XX VALUE 'C4'.
   635     05  F                       PIC XX VALUE 'D5'.
   636     05  F                       PIC XX VALUE 'E6'.
   637     05  F                       PIC XX VALUE 'F7'.
   638     05  F                       PIC XX VALUE 'G8'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  13
* EL050.cbl
   639     05  F                       PIC XX VALUE 'H9'.
   640     05  F                       PIC XX VALUE 'I1'.
   641     05  F                       PIC XX VALUE 'J2'.
   642     05  F                       PIC XX VALUE 'K3'.
   643     05  F                       PIC XX VALUE 'L4'.
   644     05  F                       PIC XX VALUE 'M5'.
   645     05  F                       PIC XX VALUE 'N6'.
   646     05  F                       PIC XX VALUE 'O0'.
   647     05  F                       PIC XX VALUE 'P7'.
   648     05  F                       PIC XX VALUE 'Q0'.
   649     05  F                       PIC XX VALUE 'R8'.
   650     05  F                       PIC XX VALUE 'S9'.
   651     05  F                       PIC XX VALUE 'T2'.
   652     05  F                       PIC XX VALUE 'U3'.
   653     05  F                       PIC XX VALUE 'V4'.
   654     05  F                       PIC XX VALUE 'W5'.
   655     05  F                       PIC XX VALUE 'X6'.
   656     05  F                       PIC XX VALUE 'Y7'.
   657     05  F                       PIC XX VALUE 'Z8'.
   658 01  WS-HIN-TABLE-B-RED REDEFINES WS-HIN-TABLE-B OCCURS 26.
   659     05  WS-VAL-IN               PIC X.
   660     05  WS-VAL-OUT              PIC 9.
   661 01  WS-GOOD-HIN                 PIC X  VALUE 'Y'.
   662 01  WS-COMPARE-BINARY-DATES.
   663     05  WS-971231                PIC XX VALUE X'92FF'.
   664     05  WS-931231                PIC XX VALUE X'8CFF'.
   665     05  WS-791231                PIC XX VALUE X'77FF'.
   666     05  WS-771001                PIC XX VALUE X'74A1'.
   667     05  WS-820301                PIC XX VALUE X'7B41'.
   668     05  WS-831031                PIC XX VALUE X'7DBF'.
   669     05  WS-831231                PIC XX VALUE X'7DFF'.
   670     05  WS-810831                PIC XX VALUE X'7A7F'.
   671     05  WS-830901                PIC XX VALUE X'7D81'.
   672
   673 01  FILE-ACCESS-IDS.
   674     12  CNTL-ID                  PIC X(8)       VALUE 'ELCNTL'.
   675     12  ACCT-ID                  PIC X(8)       VALUE 'ERACCT2'.
   676     12  PLAN-ID                  PIC X(8)       VALUE 'ERPLAN'.
   677     12  FORM-ID                  PIC X(8)       VALUE 'ERFORM'.
   678     12  CERT-ID                  PIC X(8)       VALUE 'ELCERT'.
   679     12  CLMS-ID                  PIC X(8)       VALUE 'ELMSTR5'.
   680     12  REIN-ID                  PIC X(8)       VALUE 'ERREIN'.
   681     12  CTBL-ID                  PIC X(8)       VALUE 'ERCTBL'.
   682     12  FILE-ERMAIL              PIC X(8)       VALUE 'ERMAIL'.
   683     12  FILE-ERPNDM              PIC X(8)       VALUE 'ERPNDM'.
   684     12  COMP-ID                  PIC X(8)       VALUE 'ERCOMP'.
   685     12  LOFC-ID                  PIC X(8)       VALUE 'ERLOFC'.
   686     12  PDEF-ID                  PIC X(8)       VALUE 'ERPDEF'.
   687     12  STAT-ID                  PIC X(8)       VALUE 'ELSTAT'.
   688     12  BXRF-ID                  PIC X(8)       VALUE 'ERBXRF'.
   689     12  AGTC-ID                  PIC X(8)       VALUE 'ERAGTC'.
   690     12  CRTT-ID                  PIC X(8)       VALUE 'ELCRTT'.
   691 01  DD-IU-SW                    PIC X   VALUE ' '.
   692     88  DD-IU-PRESENT                 VALUE 'Y'.
   693
   694 01  ACCESS-KEYS.
   695     12  ELMSTR-KEY.
   696         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  14
* EL050.cbl
   697         16  MSTR-CERT-NO         PIC X(11)   VALUE SPACES.
   698     12  W-CLAIM-KEY.
   699         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   700         16  W-CL-CERT-NO         PIC X(11)   VALUE SPACES.
   701
   702     12  ELCNTL-KEY.
   703         16  CNTL-COMP-ID         PIC XXX     VALUE SPACES.
   704         16  CNTL-REC-TYPE        PIC X       VALUE SPACE.
   705         16  CNTL-ACCESS          PIC X(4)    VALUE SPACES.
   706         16  CNTL-SEQ-NO          PIC S9(4)    COMP VALUE +0.
   707
   708     12  ELCERT-KEY.
   709         16  CERT-COMP-CD         PIC X       VALUE LOW-VALUES.
   710         16  CERT-CARRIER         PIC X       VALUE SPACE.
   711         16  CERT-GROUPING        PIC X(6)    VALUE SPACES.
   712         16  CERT-STATE           PIC XX      VALUE SPACES.
   713         16  CERT-ACCOUNT         PIC X(10)   VALUE SPACES.
   714         16  CERT-EFF-DT          PIC XX      VALUE LOW-VALUES.
   715         16  CERT-CERT-NO         PIC X(11)   VALUE SPACES.
   716
   717     12  ELCERT2-KEY.
   718         16  CERT2-COMP-CD        PIC X       VALUE LOW-VALUE.
   719         16  CERT2-CERT-NO        PIC X(11)   VALUE SPACES.
   720
   721     12  ELCERT-LENGTH            PIC S9(4)    COMP  VALUE +450.
   722
   723     12  ELCERT-SAVE.
   724         16  FILLER                      PIC XX    VALUE SPACES.
   725
   726         16  WCS-CONTROL-PRIMARY.
   727             20  WCS-COMPANY-CD          PIC X  VALUE LOW-VALUE.
   728             20  WCS-CARRIER             PIC X     VALUE SPACE.
   729             20  WCS-GROUPING            PIC X(6)  VALUE SPACES.
   730             20  WCS-STATE               PIC XX    VALUE SPACES.
   731             20  WCS-ACCOUNT             PIC X(10) VALUE SPACES.
   732             20  WCS-CERT-EFF-DT         PIC XX VALUE LOW-VALUES.
   733             20  WCS-CERT-NO.
   734                 24  WCS-CERT-PRIME      PIC X(10) VALUE SPACES.
   735                 24  WCS-CERT-SFX        PIC X     VALUE SPACE.
   736
   737         16  CS-CONTROL-BY-NAME.
   738             20  CS-COMPANY-CD-A1        PIC X  VALUE LOW-VALUES.
   739             20  CS-INSURED-LAST-NAME    PIC X(15) VALUE SPACES.
   740             20  CS-INSURED-INITIALS.
   741                 24  CS-INSURED-INITIAL1 PIC X VALUE SPACE.
   742                 24  CS-INSURED-INITIAL2 PIC X VALUE SPACE.
   743
   744         16  CS-CONTROL-BY-SSN.
   745             20  CS-COMPANY-CD-A2        PIC X VALUE LOW-VALUES.
   746             20  CS-SOC-SEC-NO.
   747                 24  CS-SSN-STATE        PIC XX VALUE SPACES.
   748                 24  CS-SSN-ACCOUNT      PIC X(6) VALUE SPACES.
   749                 24  CS-SSN-LN3.
   750                     28 CS-INSURED-INITIALS-A2   PIC XX
   751                                     VALUE SPACES.
   752                     28 CS-PART-LAST-NAME-A2     PIC X
   753                                     VALUE SPACE.
   754
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  15
* EL050.cbl
   755         16  CS-CONTROL-BY-CERT-NO.
   756             20  CS-COMPANY-CD-A4        PIC X  VALUE LOW-VALUES.
   757             20  CS-CERT-NO-A4           PIC X(11)
   758                                     VALUE SPACES.
   759
   760         16  CS-CONTROL-BY-MEMB.
   761             20  CS-COMPANY-CD-A5        PIC X VALUE LOW-VALUES.
   762             20  CS-MEMBER-NO.
   763                 24  CS-MEMB-STATE     PIC XX VALUE SPACES.
   764                 24  CS-MEMB-ACCOUNT   PIC X(6) VALUE SPACES.
   765                 24  CS-MEMB-LN4.
   766                     28 CS-INSURED-INITIALS-A5   PIC XX
   767                                      VALUE SPACES.
   768                     28 CS-PART-LAST-NAME-A5     PIC XX
   769                                      VALUE SPACES.
   770
   771         16  FILLER              PIC X(360) VALUE SPACES.
   772
   773     12  ERACCT-KEY.
   774         16  ACCT-COMP-CD         PIC X     VALUE LOW-VALUES.
   775         16  ACCT-CARRIER         PIC X     VALUE SPACES.
   776         16  ACCT-GROUPING        PIC X(06) VALUE SPACES.
   777         16  ACCT-STATE           PIC X(02) VALUE SPACES.
   778         16  ACCT-ACCOUNT         PIC X(10) VALUE SPACES.
   779         16  ACCT-EXP-DT          PIC X(02) VALUE LOW-VALUES.
   780
   781     12  ERCOMP-KEY.
   782         16  COMP-COMP-CD         PIC X     VALUE LOW-VALUES.
   783         16  COMP-CARRIER         PIC X     VALUE SPACES.
   784         16  COMP-GROUPING        PIC X(06) VALUE SPACES.
   785         16  COMP-FIN-RESP        PIC X(10) VALUE SPACES.
   786         16  COMP-ACCOUNT         PIC X(10) VALUE SPACES.
   787         16  COMP-TYPE            PIC X     VALUE SPACES.
   788
   789     12  ERLOFC-KEY.
   790         16  LOFC-COMP-CD         PIC X     VALUE LOW-VALUES.
   791         16  LOFC-CARRIER         PIC X     VALUE SPACES.
   792         16  LOFC-GROUPING        PIC X(06) VALUE SPACES.
   793         16  LOFC-STATE           PIC XX    VALUE SPACES.
   794         16  LOFC-ACCOUNT         PIC X(10) VALUE SPACES.
   795         16  LOFC-CODE            PIC X(5)  VALUE SPACES.
   796
   797     12  WS-ELCRTT-KEY.
   798         16  WS-ELCRTT-PRIMARY       PIC X(33).
   799         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   800
   801     12  ERBXRF-KEY.
   802         16  BXRF-COMP-CD         PIC X     VALUE LOW-VALUES.
   803         16  BXRF-CARRIER         PIC X     VALUE SPACES.
   804         16  BXRF-GROUPING        PIC X(06) VALUE SPACES.
   805         16  BXRF-BANK-NUMBER     PIC X(10) VALUE SPACES.
   806
   807     12  ERAGTC-KEY.
   808         16  AGTC-COMP-CD         PIC X     VALUE LOW-VALUES.
   809         16  AGTC-CARRIER         PIC X     VALUE SPACES.
   810         16  AGTC-GROUPING        PIC X(06) VALUE SPACES.
   811         16  AGTC-BANK            PIC X(10) VALUE SPACES.
   812         16  AGTC-EXP-DT          PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  16
* EL050.cbl
   813         16  AGTC-TYPE            PIC X     VALUE SPACES.
   814
   815     12  ERPLAN-KEY.
   816         16  PLAN-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   817         16  PLAN-CARRIER         PIC X     VALUE SPACES.
   818         16  PLAN-GROUPING        PIC X(6)  VALUE SPACES.
   819         16  PLAN-STATE           PIC X(2)  VALUE SPACES.
   820         16  PLAN-ACCOUNT         PIC X(10) VALUE SPACES.
   821         16  PLAN-BENEFIT-TYPE    PIC X     VALUE SPACE.
   822         16  PLAN-BENEFIT-CODE    PIC X(2)  VALUE SPACES.
   823         16  PLAN-REVISION-NO     PIC X(3)  VALUE SPACES.
   824
   825     12  ERFORM-KEY.
   826         16  FORM-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   827         16  FORM-STATE           PIC X(2)  VALUE SPACES.
   828         16  FORM-FORM-ID         PIC X(12) VALUE SPACES.
   829         16  FORM-FORM-EXP-DT     PIC X(2)  VALUE SPACES.
   830
   831     12  ERREIN-KEY.
   832         16  REIN-COMP-CD         PIC X     VALUE LOW-VALUES.
   833         16  REIN-TYPE            PIC X     VALUE SPACES.
   834         16  REIN-TABLE-CO.
   835             20  REIN-CODE-1      PIC X     VALUE SPACE.
   836             20  REIN-CODE-2      PIC X     VALUE SPACE.
   837             20  REIN-CODE-3      PIC X     VALUE SPACE.
   838         16  FILLER               PIC X(3)  VALUE SPACES.
   839
   840     12  ERCTBL-KEY.
   841         16  CTBL-COMPANY-CD      PIC X     VALUE LOW-VALUES.
   842         16  CTBL-TABLE           PIC XXX   VALUE SPACES.
   843         16  CTBL-CNTRL-2.
   844             20  CTBL-BEN-TYPE    PIC X     VALUE SPACE.
   845             20  CTBL-BEN-CODE    PIC XX    VALUE SPACES.
   846
   847     12  ELCRTO-KEY.
   848         16  ELCRTO-COMPANY-CD       PIC X.
   849         16  ELCRTO-CARRIER          PIC X.
   850         16  ELCRTO-GROUPING         PIC X(6).
   851         16  ELCRTO-STATE            PIC XX.
   852         16  ELCRTO-ACCOUNT          PIC X(10).
   853         16  ELCRTO-CERT-EFF-DT      PIC XX.
   854         16  ELCRTO-CERT-NO.
   855             20  ELCRTO-CERT-PRIME   PIC X(10).
   856             20  ELCRTO-CERT-SFX     PIC X.
   857         16  ELCRTO-RECORD-TYPE      PIC X.
   858         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   859
   860
   861     12  WS-ACCESS.
   862         16  FILLER               PIC XX    VALUE SPACES.
   863         16  WS-BEN-CD            PIC XX    VALUE SPACES.
   864
   865     12  WS-CARR-ACCESS.
   866         16  FILLER               PIC X(3)  VALUE SPACES.
   867         16  WS-CARR              PIC X     VALUE SPACE.
   868*DMD CUSTOM CODING FIELDS BELOW POPULATED BY CF-RATING-SWITCH
   869*WHEN EL050 IS INVOLED BY EL631, EL6311,EL6312,EL6313,EL517
   870     12  WS-DMD-RATING-SW         PIC X         VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  17
* EL050.cbl
   871         88  WS-DMD-LF-RATING   VALUE 'Y'.
   872         88  WS-DMD-AH-RATING   VALUE 'Y'.
   873         88  WS-DMD-NO-RATING   VALUE 'N'.
   874
   875     12  WS-LF-BEN-CD            PIC XX  VALUE SPACES.
   876         88  WS-LF-CASH            VALUE 'MJ' 'MS'
   877                                         'NJ' 'NL'
   878                                         'PJ' 'PL'
   879                                         'SJ' 'SL'.
   880     12  WS-AH-BEN-CD            PIC XX  VALUE SPACES.
   881         88  WS-AH-CASH            VALUE 'MJ' 'MS' 'MI' 'MU'
   882                                         'NI' 'NJ' 'NL' 'NU'
   883                                         'PJ' 'PL' 'PI' 'PU'
   884                                         'SI' 'SJ' 'SL' 'SU'
   885                                         'MX' 'MY' 'MZ'.
   886 01  ERPDEF-KEY-SAVE             PIC X(18).
   887 01  ERPDEF-KEY.
   888     12  ERPDEF-COMPANY-CD       PIC X.
   889     12  ERPDEF-STATE            PIC XX.
   890     12  ERPDEF-PROD-CD          PIC XXX.
   891     12  F                       PIC X(7).
   892     12  ERPDEF-BEN-TYPE         PIC X.
   893     12  ERPDEF-BEN-CODE         PIC XX.
   894     12  ERPDEF-EXP-DT           PIC XX.
   895
   896 01  ELSTAT-KEY-SAVE             PIC X(20).
   897 01  ELSTAT-KEY.
   898     12  ELSTAT-COMPANY-ID       PIC XXX.
   899     12  ELSTAT-CARRIER          PIC X.
   900     12  ELSTAT-GROUP            PIC X(6).
   901     12  ELSTAT-STATE            PIC XX.
   902     12  ELSTAT-EXP-DT           PIC 9(8).
   903 01  WS-ERROR-VALUES.
   904     12  ER-1570                     PIC S9(4)   VALUE +1570.
   905     12  ER-1571                     PIC S9(4)   VALUE +1571.
   906     12  er-1572                     pic s9(4)   value +1572.
   907     12  er-1573                     pic s9(4)   value +1573.
   908     12  er-1574                     pic s9(4)   value +1574.
   909     12  ER-1575                     PIC S9(4)   VALUE +1575.
   910     12  er-1576                     pic s9(4)   value +1576.
   911     12  er-1743                     pic s9(4)   value +1743.
   912     12  er-1744                     pic s9(4)   value +1744.
   913     12  er-1745                     pic s9(4)   value +1745.
   914     12  er-1746                     pic s9(4)   value +1746.
   915     12  er-1747                     pic s9(4)   value +1747.
   916     12  er-1748                     pic s9(4)   value +1748.
   917     12  ER-1891                     PIC S9(4)   VALUE +1891.
   918     12  ER-1892                     PIC S9(4)   VALUE +1892.
   919     12  ER-1893                     PIC S9(4)   VALUE +1893.
   920     12  ER-1894                     PIC S9(4)   VALUE +1894.
   921     12  ER-1895                     PIC S9(4)   VALUE +1895.
   922     12  ER-1896                     PIC S9(4)   VALUE +1896.
   923     12  ER-1897                     PIC S9(4)   VALUE +1897.
   924     12  ER-1898                     PIC S9(4)   VALUE +1898.
   925     12  ER-1899                     PIC S9(4)   VALUE +1899.
   926     12  ER-1900                     PIC S9(4)   VALUE +1900.
   927     12  ER-1901                     PIC S9(4)   VALUE +1901.
   928     12  ER-1902                     PIC S9(4)   VALUE +1902.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  18
* EL050.cbl
   929     12  ER-1903                     PIC S9(4)   VALUE +1903.
   930     12  ER-1904                     PIC S9(4)   VALUE +1904.
   931     12  ER-1905                     PIC S9(4)   VALUE +1905.
   932     12  ER-1906                     PIC S9(4)   VALUE +1906.
   933     12  ER-1907                     PIC S9(4)   VALUE +1907.
   934     12  ER-1909                     PIC S9(4)   VALUE +1909.
   935     12  ER-1910                     PIC S9(4)   VALUE +1910.
   936     12  ER-1911                     PIC S9(4)   VALUE +1911.
   937     12  ER-1912                     PIC S9(4)   VALUE +1912.
   938     12  ER-1913                     PIC S9(4)   VALUE +1913.
   939     12  ER-1914                     PIC S9(4)   VALUE +1914.
   940     12  ER-1915                     PIC S9(4)   VALUE +1915.
   941     12  ER-1916                     PIC S9(4)   VALUE +1916.
   942     12  ER-1917                     PIC S9(4)   VALUE +1917.
   943     12  ER-1918                     PIC S9(4)   VALUE +1918.
   944     12  ER-1919                     PIC S9(4)   VALUE +1919.
   945     12  ER-1920                     PIC S9(4)   VALUE +1920.
   946     12  ER-1921                     PIC S9(4)   VALUE +1921.
   947     12  ER-1922                     PIC S9(4)   VALUE +1922.
   948     12  ER-1923                     PIC S9(4)   VALUE +1923.
   949     12  ER-1924                     PIC S9(4)   VALUE +1924.
   950     12  ER-1925                     PIC S9(4)   VALUE +1925.
   951     12  ER-1926                     PIC S9(4)   VALUE +1926.
   952     12  ER-1927                     PIC S9(4)   VALUE +1927.
   953     12  ER-2393                     PIC S9(4)   VALUE +2393.
   954     12  ER-2600                     PIC S9(4)   VALUE +2600.
   955     12  ER-2601                     PIC S9(4)   VALUE +2601.
   956     12  ER-2602                     PIC S9(4)   VALUE +2602.
   957     12  ER-2603                     PIC S9(4)   VALUE +2603.
   958     12  ER-2604                     PIC S9(4)   VALUE +2604.
   959     12  ER-2605                     PIC S9(4)   VALUE +2605.
   960     12  ER-2606                     PIC S9(4)   VALUE +2606.
   961     12  ER-2607                     PIC S9(4)   VALUE +2607.
   962     12  ER-2608                     PIC S9(4)   VALUE +2608.
   963     12  ER-2609                     PIC S9(4)   VALUE +2609.
   964     12  ER-2610                     PIC S9(4)   VALUE +2610.
   965     12  ER-2611                     PIC S9(4)   VALUE +2611.
   966     12  ER-2612                     PIC S9(4)   VALUE +2612.
   967     12  ER-2613                     PIC S9(4)   VALUE +2613.
   968     12  ER-2614                     PIC S9(4)   VALUE +2614.
   969     12  ER-2615                     PIC S9(4)   VALUE +2615.
   970     12  ER-2616                     PIC S9(4)   VALUE +2616.
   971     12  ER-2617                     PIC S9(4)   VALUE +2617.
   972     12  ER-2618                     PIC S9(4)   VALUE +2618.
   973     12  ER-2619                     PIC S9(4)   VALUE +2619.
   974     12  ER-2620                     PIC S9(4)   VALUE +2620.
   975     12  ER-2621                     PIC S9(4)   VALUE +2621.
   976     12  ER-2622                     PIC S9(4)   VALUE +2622.
   977     12  ER-2623                     PIC S9(4)   VALUE +2623.
   978     12  ER-2624                     PIC S9(4)   VALUE +2624.
   979     12  ER-2625                     PIC S9(4)   VALUE +2625.
   980     12  ER-2626                     PIC S9(4)   VALUE +2626.
   981     12  ER-2627                     PIC S9(4)   VALUE +2627.
   982     12  ER-2628                     PIC S9(4)   VALUE +2628.
   983     12  ER-2629                     PIC S9(4)   VALUE +2629.
   984     12  ER-2630                     PIC S9(4)   VALUE +2630.
   985     12  ER-2631                     PIC S9(4)   VALUE +2631.
   986     12  ER-2632                     PIC S9(4)   VALUE +2632.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  19
* EL050.cbl
   987     12  ER-2633                     PIC S9(4)   VALUE +2633.
   988     12  ER-2634                     PIC S9(4)   VALUE +2634.
   989     12  ER-2635                     PIC S9(4)   VALUE +2635.
   990     12  ER-2636                     PIC S9(4)   VALUE +2636.
   991     12  ER-2637                     PIC S9(4)   VALUE +2637.
   992     12  ER-2638                     PIC S9(4)   VALUE +2638.
   993     12  ER-2639                     PIC S9(4)   VALUE +2639.
   994     12  ER-2640                     PIC S9(4)   VALUE +2640.
   995     12  ER-2641                     PIC S9(4)   VALUE +2641.
   996     12  ER-2642                     PIC S9(4)   VALUE +2642.
   997     12  ER-2643                     PIC S9(4)   VALUE +2643.
   998     12  ER-2644                     PIC S9(4)   VALUE +2644.
   999     12  ER-2645                     PIC S9(4)   VALUE +2645.
  1000     12  ER-2646                     PIC S9(4)   VALUE +2646.
  1001     12  ER-2647                     PIC S9(4)   VALUE +2647.
  1002     12  ER-2648                     PIC S9(4)   VALUE +2648.
  1003     12  ER-2649                     PIC S9(4)   VALUE +2649.
  1004     12  ER-2650                     PIC S9(4)   VALUE +2650.
  1005     12  ER-2651                     PIC S9(4)   VALUE +2651.
  1006     12  ER-2652                     PIC S9(4)   VALUE +2652.
  1007     12  ER-2653                     PIC S9(4)   VALUE +2653.
  1008     12  ER-2654                     PIC S9(4)   VALUE +2654.
  1009     12  ER-2655                     PIC S9(4)   VALUE +2655.
  1010     12  ER-2656                     PIC S9(4)   VALUE +2656.
  1011     12  ER-2657                     PIC S9(4)   VALUE +2657.
  1012     12  ER-2658                     PIC S9(4)   VALUE +2658.
  1013     12  ER-2659                     PIC S9(4)   VALUE +2659.
  1014     12  ER-2660                     PIC S9(4)   VALUE +2660.
  1015     12  ER-2661                     PIC S9(4)   VALUE +2661.
  1016     12  ER-2662                     PIC S9(4)   VALUE +2662.
  1017     12  ER-2663                     PIC S9(4)   VALUE +2663.
  1018     12  ER-2664                     PIC S9(4)   VALUE +2664.
  1019     12  ER-2665                     PIC S9(4)   VALUE +2665.
  1020     12  ER-2666                     PIC S9(4)   VALUE +2666.
  1021     12  ER-2667                     PIC S9(4)   VALUE +2667.
  1022     12  ER-2668                     PIC S9(4)   VALUE +2668.
  1023     12  ER-2669                     PIC S9(4)   VALUE +2669.
  1024     12  ER-2670                     PIC S9(4)   VALUE +2670.
  1025     12  ER-2671                     PIC S9(4)   VALUE +2671.
  1026     12  ER-2672                     PIC S9(4)   VALUE +2672.
  1027     12  ER-2673                     PIC S9(4)   VALUE +2673.
  1028     12  ER-2674                     PIC S9(4)   VALUE +2674.
  1029     12  ER-2675                     PIC S9(4)   VALUE +2675.
  1030     12  ER-2676                     PIC S9(4)   VALUE +2676.
  1031     12  ER-2677                     PIC S9(4)   VALUE +2677.
  1032     12  ER-2678                     PIC S9(4)   VALUE +2678.
  1033     12  ER-2679                     PIC S9(4)   VALUE +2679.
  1034     12  ER-2680                     PIC S9(4)   VALUE +2680.
  1035     12  ER-2681                     PIC S9(4)   VALUE +2681.
  1036     12  ER-2682                     PIC S9(4)   VALUE +2682.
  1037     12  ER-2683                     PIC S9(4)   VALUE +2683.
  1038     12  ER-2684                     PIC S9(4)   VALUE +2684.
  1039     12  ER-2685                     PIC S9(4)   VALUE +2685.
  1040     12  ER-2686                     PIC S9(4)   VALUE +2686.
  1041     12  ER-2687                     PIC S9(4)   VALUE +2687.
  1042     12  ER-2688                     PIC S9(4)   VALUE +2688.
  1043     12  ER-2689                     PIC S9(4)   VALUE +2689.
  1044     12  ER-2690                     PIC S9(4)   VALUE +2690.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  20
* EL050.cbl
  1045     12  ER-2691                     PIC S9(4)   VALUE +2691.
  1046     12  ER-2692                     PIC S9(4)   VALUE +2692.
  1047     12  ER-2693                     PIC S9(4)   VALUE +2693.
  1048     12  ER-2694                     PIC S9(4)   VALUE +2694.
  1049     12  ER-2695                     PIC S9(4)   VALUE +2695.
  1050     12  ER-2696                     PIC S9(4)   VALUE +2696.
  1051     12  ER-2697                     PIC S9(4)   VALUE +2697.
  1052     12  ER-2698                     PIC S9(4)   VALUE +2698.
  1053     12  ER-2699                     PIC S9(4)   VALUE +2699.
  1054     12  ER-2700                     PIC S9(4)   VALUE +2700.
  1055     12  ER-2701                     PIC S9(4)   VALUE +2701.
  1056     12  ER-2702                     PIC S9(4)   VALUE +2702.
  1057     12  ER-2703                     PIC S9(4)   VALUE +2703.
  1058     12  ER-2704                     PIC S9(4)   VALUE +2704.
  1059     12  ER-2707                     PIC S9(4)   VALUE +2707.
  1060     12  ER-2720                     PIC S9(4)   VALUE +2720.
  1061     12  ER-2709                     PIC S9(4)   VALUE +2709.
  1062     12  ER-2717                     PIC S9(4)   VALUE +2717.
  1063     12  ER-2718                     PIC S9(4)   VALUE +2718.
  1064     12  ER-2719                     PIC S9(4)   VALUE +2719.
  1065     12  ER-2721                     PIC S9(4)   VALUE +2721.
  1066     12  ER-2722                     PIC S9(4)   VALUE +2722.
  1067     12  ER-2723                     PIC S9(4)   VALUE +2723.
  1068     12  ER-2724                     PIC S9(4)   VALUE +2724.
  1069     12  ER-2725                     PIC S9(4)   VALUE +2725.
  1070     12  ER-2726                     PIC S9(4)   VALUE +2726.
  1071     12  ER-2727                     PIC S9(4)   VALUE +2727.
  1072     12  ER-2728                     PIC S9(4)   VALUE +2728.
  1073     12  ER-2729                     PIC S9(4)   VALUE +2729.
  1074     12  ER-2730                     PIC S9(4)   VALUE +2730.
  1075     12  ER-2731                     PIC S9(4)   VALUE +2731.
  1076     12  ER-2732                     PIC S9(4)   VALUE +2732.
  1077     12  ER-2733                     PIC S9(4)   VALUE +2733.
  1078     12  ER-2734                     PIC S9(4)   VALUE +2734.
  1079     12  ER-2735                     PIC S9(4)   VALUE +2735.
  1080     12  ER-2736                     PIC S9(4)   VALUE +2736.
  1081     12  ER-2737                     PIC S9(4)   VALUE +2737.
  1082     12  ER-2738                     PIC S9(4)   VALUE +2738.
  1083     12  ER-2739                     PIC S9(4)   VALUE +2739.
  1084     12  ER-2740                     PIC S9(4)   VALUE +2740.
  1085     12  ER-2741                     PIC S9(4)   VALUE +2741.
  1086     12  ER-2742                     PIC S9(4)   VALUE +2742.
  1087     12  ER-2743                     PIC S9(4)   VALUE +2743.
  1088     12  ER-2744                     PIC S9(4)   VALUE +2744.
  1089     12  ER-2745                     PIC S9(4)   VALUE +2745.
  1090     12  ER-2746                     PIC S9(4)   VALUE +2746.
  1091     12  ER-2747                     PIC S9(4)   VALUE +2747.
  1092     12  ER-2748                     PIC S9(4)   VALUE +2748.
  1093     12  ER-2749                     PIC S9(4)   VALUE +2749.
  1094     12  ER-2750                     PIC S9(4)   VALUE +2750.
  1095     12  ER-2751                     PIC S9(4)   VALUE +2751.
  1096     12  ER-2752                     PIC S9(4)   VALUE +2752.
  1097     12  ER-2753                     PIC S9(4)   VALUE +2753.
  1098     12  ER-2754                     PIC S9(4)   VALUE +2754.
  1099     12  ER-2755                     PIC S9(4)   VALUE +2755.
  1100     12  ER-2756                     PIC S9(4)   VALUE +2756.
  1101     12  ER-2757                     PIC S9(4)   VALUE +2757.
  1102     12  ER-2758                     PIC S9(4)   VALUE +2758.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  21
* EL050.cbl
  1103     12  ER-2759                     PIC S9(4)   VALUE +2759.
  1104     12  ER-2760                     PIC S9(4)   VALUE +2760.
  1105     12  ER-2761                     PIC S9(4)   VALUE +2761.
  1106     12  ER-2762                     PIC S9(4)   VALUE +2762.
  1107     12  ER-2763                     PIC S9(4)   VALUE +2763.
  1108     12  ER-2764                     PIC S9(4)   VALUE +2764.
  1109     12  ER-2765                     PIC S9(4)   VALUE +2765.
  1110     12  ER-2766                     PIC S9(4)   VALUE +2766.
  1111     12  ER-2767                     PIC S9(4)   VALUE +2767.
  1112     12  ER-2768                     PIC S9(4)   VALUE +2768.
  1113     12  ER-2769                     PIC S9(4)   VALUE +2769.
  1114     12  ER-2770                     PIC S9(4)   VALUE +2770.
  1115     12  ER-2771                     PIC S9(4)   VALUE +2771.
  1116     12  ER-2772                     PIC S9(4)   VALUE +2772.
  1117     12  ER-2773                     PIC S9(4)   VALUE +2773.
  1118     12  ER-2774                     PIC S9(4)   VALUE +2774.
  1119     12  ER-2775                     PIC S9(4)   VALUE +2775.
  1120     12  ER-2776                     PIC S9(4)   VALUE +2776.
  1121     12  ER-2777                     PIC S9(4)   VALUE +2777.
  1122     12  ER-2778                     PIC S9(4)   VALUE +2778.
  1123     12  ER-2779                     PIC S9(4)   VALUE +2779.
  1124     12  ER-2780                     PIC S9(4)   VALUE +2780.
  1125     12  ER-2781                     PIC S9(4)   VALUE +2781.
  1126     12  ER-2782                     PIC S9(4)   VALUE +2782.
  1127     12  ER-2783                     PIC S9(4)   VALUE +2783.
  1128     12  ER-2786                     PIC S9(4)   VALUE +2786.
  1129     12  ER-2787                     PIC S9(4)   VALUE +2787.
  1130     12  ER-2788                     PIC S9(4)   VALUE +2788.
  1131     12  ER-2789                     PIC S9(4)   VALUE +2789.
  1132     12  ER-2792                     PIC S9(4)   VALUE +2792.
  1133     12  ER-2793                     PIC S9(4)   VALUE +2793.
  1134     12  ER-2794                     PIC S9(4)   VALUE +2794.
  1135     12  ER-2795                     PIC S9(4)   VALUE +2795.
  1136     12  ER-2796                     PIC S9(4)   VALUE +2796.
  1137     12  ER-2798                     PIC S9(4)   VALUE +2798.
  1138     12  ER-2799                     PIC S9(4)   VALUE +2799.
  1139     12  ER-2869                     PIC S9(4)   VALUE +2869.
  1140     12  ER-2879                     PIC S9(4)   VALUE +2879.
  1141     12  ER-2881                     PIC S9(4)   VALUE +2881.
  1142     12  ER-2883                     PIC S9(4)   VALUE +2883.
  1143     12  ER-2882                     PIC S9(4)   VALUE +2882.
  1144     12  ER-2884                     PIC S9(4)   VALUE +2884.
  1145     12  ER-2885                     PIC S9(4)   VALUE +2885.
  1146     12  ER-2886                     PIC S9(4)   VALUE +2886.
  1147     12  ER-2887                     PIC S9(4)   VALUE +2887.
  1148     12  ER-2888                     PIC S9(4)   VALUE +2888.
  1149     12  ER-2889                     PIC S9(4)   VALUE +2889.
  1150     12  ER-2890                     PIC S9(4)   VALUE +2890.
  1151     12  ER-2891                     PIC S9(4)   VALUE +2891.
  1152     12  ER-2892                     PIC S9(4)   VALUE +2892.
  1153     12  ER-2896                     PIC S9(4)   VALUE +2896.
  1154     12  ER-2897                     PIC S9(4)   VALUE +2897.
  1155     12  ER-2898                     PIC S9(4)   VALUE +2898.
  1156     12  ER-2963                     PIC S9(4)   VALUE +2963.
  1157     12  ER-2964                     PIC S9(4)   VALUE +2964.
  1158     12  ER-2965                     PIC S9(4)   VALUE +2965.
  1159     12  ER-2969                     PIC S9(4)   VALUE +2969.
  1160     12  ER-3006                     PIC S9(4)   VALUE +3006.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  22
* EL050.cbl
  1161     12  ER-3049                     PIC S9(4)   VALUE +3049.
  1162     12  ER-3050                     PIC S9(4)   VALUE +3050.
  1163     12  ER-3052                     PIC S9(4)   VALUE +3052.
  1164     12  ER-3054                     PIC S9(4)   VALUE +3054.
  1165     12  ER-3057                     PIC S9(4)   VALUE +3057.
  1166     12  ER-3058                     PIC S9(4)   VALUE +3058.
  1167     12  ER-3780                     PIC S9(4)   VALUE +3780.
  1168     12  ER-3781                     PIC S9(4)   VALUE +3781.
  1169     12  ER-3782                     PIC S9(4)   VALUE +3782.
  1170     12  ER-3789                     PIC S9(4)   VALUE +3789.
  1171     12  ER-3790                     PIC S9(4)   VALUE +3790.
  1172     12  ER-3825                     PIC S9(4)   VALUE +3825.
  1173     12  ER-3826                     PIC S9(4)   VALUE +3826.
  1174     12  ER-3827                     PIC S9(4)   VALUE +3827.
  1175     12  ER-3843                     PIC S9(4)   VALUE +3843.
  1176     12  ER-7812                     PIC S9(4)   VALUE +7812.
  1177     12  ER-7813                     PIC S9(4)   VALUE +7813.
  1178     12  ER-7814                     PIC S9(4)   VALUE +7814.
  1179     12  ER-7815                     PIC S9(4)   VALUE +7815.
  1180     12  ER-7816                     PIC S9(4)   VALUE +7816.
  1181     12  ER-7817                     PIC S9(4)   VALUE +7817.
  1182     12  ER-7818                     PIC S9(4)   VALUE +7818.
  1183     12  ER-7819                     PIC S9(4)   VALUE +7819.
  1184     12  ER-7820                     PIC S9(4)   VALUE +7820.
  1185     12  ER-7823                     PIC S9(4)   VALUE +7823.
  1186     12  ER-7825                     PIC S9(4)   VALUE +7825.
  1187     12  ER-8002                     PIC S9(4)   VALUE +8002.
  1188     12  ER-8030                     PIC S9(4)   VALUE +8030.
  1189     12  ER-8036                     PIC S9(4)   VALUE +8036.
  1190     12  ER-8037                     PIC S9(4)   VALUE +8037.
  1191     12  ER-8038                     PIC S9(4)   VALUE +8038.
  1192     12  ER-8039                     PIC S9(4)   VALUE +8039.
  1193     12  ER-8040                     PIC S9(4)   VALUE +8040.
  1194     12  ER-8041                     PIC S9(4)   VALUE +8041.
  1195     12  ER-8042                     PIC S9(4)   VALUE +8042.
  1196     12  ER-8043                     PIC S9(4)   VALUE +8043.
  1197     12  ER-8044                     PIC S9(4)   VALUE +8044.
  1198     12  ER-8045                     PIC S9(4)   VALUE +8045.
  1199     12  ER-8046                     PIC S9(4)   VALUE +8046.
  1200     12  ER-8050                     PIC S9(4)   VALUE +8050.
  1201     12  ER-8067                     PIC S9(4)   VALUE +8067.
  1202     12  ER-8068                     PIC S9(4)   VALUE +8068.
  1203     12  ER-8069                     PIC S9(4)   VALUE +8069.
  1204     12  ER-8070                     PIC S9(4)   VALUE +8070.
  1205     12  ER-8071                     PIC S9(4)   VALUE +8071.
  1206     12  ER-8072                     PIC S9(4)   VALUE +8072.
  1207     12  ER-8074                     PIC S9(4)   VALUE +8074.
  1208     12  ER-8075                     PIC S9(4)   VALUE +8075.
  1209     12  ER-8076                     PIC S9(4)   VALUE +8076.
  1210     12  ER-8077                     PIC S9(4)   VALUE +8077.
  1211     12  ER-8078                     PIC S9(4)   VALUE +8078.
  1212     12  ER-8079                     PIC S9(4)   VALUE +8079.
  1213     12  ER-8080                     PIC S9(4)   VALUE +8080.
  1214     12  ER-8081                     PIC S9(4)   VALUE +8081.
  1215     12  ER-8082                     PIC S9(4)   VALUE +8082.
  1216     12  ER-8083                     PIC S9(4)   VALUE +8083.
  1217     12  ER-8084                     PIC S9(4)   VALUE +8084.
  1218     12  ER-8085                     PIC S9(4)   VALUE +8085.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  23
* EL050.cbl
  1219     12  ER-8086                     PIC S9(4)   VALUE +8086.
  1220     12  ER-8087                     PIC S9(4)   VALUE +8087.
  1221     12  ER-8088                     PIC S9(4)   VALUE +8088.
  1222     12  ER-8089                     PIC S9(4)   VALUE +8089.
  1223     12  ER-8090                     PIC S9(4)   VALUE +8090.
  1224     12  ER-8091                     PIC S9(4)   VALUE +8091.
  1225     12  ER-8092                     PIC S9(4)   VALUE +8092.
  1226     12  ER-8093                     PIC S9(4)   VALUE +8093.
  1227     12  ER-8094                     PIC S9(4)   VALUE +8094.
  1228     12  ER-8095                     PIC S9(4)   VALUE +8095.
  1229     12  ER-8096                     PIC S9(4)   VALUE +8096.
  1230     12  ER-8097                     PIC S9(4)   VALUE +8097.
  1231     12  ER-8098                     PIC S9(4)   VALUE +8098.
  1232     12  ER-8099                     PIC S9(4)   VALUE +8099.
  1233     12  ER-8109                     PIC S9(4)   VALUE +8109.
  1234     12  ER-8110                     PIC S9(4)   VALUE +8110.
  1235     12  ER-8111                     PIC S9(4)   VALUE +8111.
  1236     12  ER-8112                     PIC S9(4)   VALUE +8112.
  1237     12  ER-8113                     PIC S9(4)   VALUE +8113.
  1238     12  ER-8114                     PIC S9(4)   VALUE +8114.
  1239     12  ER-8116                     PIC S9(4)   VALUE +8116.
  1240     12  ER-8148                     PIC S9(4)   VALUE +8148.
  1241     12  ER-8152                     PIC S9(4)   VALUE +8152.
  1242     12  ER-8300                     PIC S9(4)   VALUE +8300.
  1243     12  ER-8301                     PIC S9(4)   VALUE +8301.
  1244     12  ER-8302                     PIC S9(4)   VALUE +8302.
  1245     12  ER-8303                     PIC S9(4)   VALUE +8303.
  1246     12  ER-8304                     PIC S9(4)   VALUE +8304.
  1247     12  ER-8310                     PIC S9(4)   VALUE +8310.
  1248     12  ER-8311                     PIC S9(4)   VALUE +8311.
  1249     12  ER-8312                     PIC S9(4)   VALUE +8312.
  1250     12  ER-8313                     PIC S9(4)   VALUE +8313.
  1251     12  ER-8314                     PIC S9(4)   VALUE +8314.
  1252     12  ER-8315                     PIC S9(4)   VALUE +8315.
  1253     12  ER-8316                     PIC S9(4)   VALUE +8316.
  1254     12  ER-8317                     PIC S9(4)   VALUE +8317.
  1255     12  ER-9236                     PIC S9(4)   VALUE +9236.
  1256     12  ER-9501                     PIC S9(4)   VALUE +9501.
  1257     12  ER-9503                     PIC S9(4)   VALUE +9503.
  1258     12  ER-9263                     PIC S9(4)   VALUE +9263.
  1259     12  ER-9813                     PIC S9(4)   VALUE +9813.
  1260     12  ER-9999                     PIC S9(4)   VALUE +9999.
  1261******************************************************************
  1262***************   END OF ELC50WS     ****************************
  1263******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  24
* EL050.cbl
  1266 01  WORKING-STORAGE-WORK-AREAS.
  1267     12  WS-RESPONSE             PIC S9(8)  COMP.
  1268         88  WS-RESP-NORMAL           VALUE +00.
  1269         88  WS-RESP-ERROR            VALUE +01.
  1270         88  WS-RESP-NOTFND           VALUE +13.
  1271         88  WS-RESP-DUPREC           VALUE +14.
  1272         88  WS-RESP-ENDFILE          VALUE +20.
  1273     12  WS-AH-CLAIM-RESCINDED        PIC X  VALUE 'N'.
  1274     12  WORK-AREAS.
  1275         16  WK-CONV-GREG.
  1276             24  WCG-CENT             PIC XX.
  1277             24  WCG-REST             PIC X(4).
  1278         16  WORK-GREGORIAN-DATE.
  1279             24  WK-GREG-CENT         PIC XX.
  1280             24  WK-GREG-DATE-YYMMDD.
  1281                 28  WK-GREG-YYMM     PIC X(4).
  1282                 28  WK-GREG-DD       PIC XX.
  1283
  1284         16  WORK-SELECT-DATE.
  1285             24  WK-SELECT-CENT            PIC XX.
  1286             24  WK-SELECT-DATE-YYMMDD.
  1287                 28  WK-SELECT-GREG-YYMM   PIC X(4).
  1288                 28  FILLER                PIC XX.
  1289
  1290         16  WK-FORM-NO.
  1291             24  WK-FORM-BANK-ID       PIC X(5).
  1292             24  WK-FORM-UNDRWRTR      PIC X(1).
  1293             24  WK-FORM-MASTER-POL-NO PIC X(6).
  1294
  1295         16  WK-MEMBER-NO.
  1296             24  WK-MEMBER-1-6        PIC X(6).
  1297             24  WK-MEMBER-7-12       PIC X(6).
  1298
  1299         16  WK-FULL-CERT-NO.
  1300             24  WK-CERT-POS-1-2      PIC X(2).
  1301             24  WK-CERT-POS-3        PIC X(1).
  1302             24  WK-CERT-POS-4        PIC X(1).
  1303             24  WK-CERT-POS-5-6      PIC X(2).
  1304             24  WK-CERT-POS-7        PIC X(1).
  1305             24  WK-CERT-POS-8-11     PIC X(4).
  1306
  1307         16  WK-VALID-RATE-CODE       PIC X  VALUE ' '.
  1308             88  VALID-RATE-CODE        VALUE 'Y'.
  1309             88  FOUND-TO-BE-INVALID    VALUE 'N'.
  1310
  1311         16  DLO001-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1312         16  DLO002-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1313         16  DLO003-COMM-LENGTH    PIC S9(4)   COMP VALUE +8.
  1314         16  DLO007-COMM-LENGTH    PIC S9(4)   COMP VALUE +51.
  1315         16  DLO011-COMM-LENGTH    PIC S9(4)   COMP VALUE +20.
  1316         16  DLO017-COMM-LENGTH    PIC S9(4)   COMP VALUE +6.
  1317         16  DLO019-COMM-LENGTH    PIC S9(4)   COMP VALUE +14.
  1318         16  DLO021-COMM-LENGTH    PIC S9(4)   COMP VALUE +5.
  1319         16  DLO022-COMM-LENGTH    PIC S9(4)   COMP VALUE +4.
  1320         16  DLO023-COMM-LENGTH    PIC S9(4)   COMP VALUE +132.
  1321
  1322* DLO001
  1323 01  WS-DLO-MASTER-POLICY-FORM.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  25
* EL050.cbl
  1324     12  DMPF-POLICY-FORM-NUMBER   PIC X(6).
  1325     12  DMPF-RETURN-CODE          PIC XX.
  1326         88  DMPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1327         88  DMPF-POLICY-NOT-INPUT             VALUE '01'.
  1328         88  DMPF-POLICY-NOT-FOUND             VALUE '02'.
  1329         88  DMPF-POLICY-INACTIVE              VALUE '03'.
  1330         88  DMPF-GEN-ERR-MPN-TBL              VALUE 'E1'.
  1331         88  DMPF-MPN-TABLE-NOT-OPEN           VALUE 'N1'.
  1332
  1333* DLO002
  1334 01  WS-DLO-INTERNAL-POLICY-FORM.
  1335     12  DIPF-POLICY-FORM-NUMBER   PIC X(6).
  1336     12  DIPF-RETURN-CODE          PIC XX.
  1337         88  DIPF-SUCCESSFUL-EDIT              VALUE 'OK'.
  1338         88  DIPF-POLICY-NOT-INPUT             VALUE '01'.
  1339         88  DIPF-POLICY-NOT-FOUND             VALUE '02'.
  1340         88  DIPF-POLICY-INACTIVE              VALUE '03'.
  1341         88  DIPF-GEN-ERR-PFA-TBL              VALUE 'E1'.
  1342         88  DIPF-PFA-TABLE-NOT-OPEN           VALUE 'N1'.
  1343
  1344* DLO003
  1345 01  WS-DLO-VALID-BANK-ID.
  1346     12  DVBI-BANK-ID              PIC X(5).
  1347     12  DVBI-BANK-ID-TYPE         PIC X.
  1348         88  DVBI-BILLING-BANK                 VALUE 'B'.
  1349         88  DVBI-PLAN-BANK                    VALUE 'P'.
  1350         88  DVBI-ENROLL-BANK                  VALUE 'E'.
  1351         88  DVBI-NEGOT-BANK                   VALUE 'N'.
  1352         88  DVBI-PROCESS-CENTER               VALUE 'X'.
  1353     12  DVBI-RETURN-CODE          PIC XX.
  1354         88  DVBI-SUCCESSFUL-EDIT              VALUE 'OK'.
  1355         88  DVBI-BANK-ID-NOT-INPUT            VALUE '01'.
  1356         88  DVBI-BANK-ID-TYPE-NOT-INPUT       VALUE '02'.
  1357         88  DVBI-BANK-ID-TYPE-INVALID         VALUE '03'.
  1358         88  DVBI-BANK-ID-NOT-FOUND            VALUE '04'.
  1359         88  DVBI-BANK-ID-INACTIVE             VALUE '05'.
  1360         88  DVBI-BANK-ID-TYPE-INCORRECT       VALUE '06'.
  1361         88  DVBI-GEN-ERR-BNK-TBL              VALUE 'E1'.
  1362         88  DVBI-BNK-TABLE-NOT-OPEN           VALUE 'N1'.
  1363
  1364* DLO007
  1365 01  WS-DLO-CERT-UNDRWRTR-ASSIGN.
  1366     12  DCUA-RES-STATE            PIC XX.
  1367     12  DCUA-BEN-TYPE             PIC XX.
  1368     12  DCUA-SYS-IDENT            PIC X.
  1369         88  DCUA-CLAIM                        VALUE 'C'.
  1370         88  DCUA-PREMIUM                      VALUE 'P'.
  1371     12  DCUA-COVERAGE-RULE        PIC X.
  1372     12  DCUA-CLIENT-ID            PIC X(10).
  1373     12  DCUA-EFF-DATE             PIC X(8).
  1374     12  DCUA-PREV-CERT-NUMBER     PIC X(11).
  1375     12  DCUA-RETURN-CODE          PIC XX.
  1376         88  DCUA-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1377     12  DCUA-CERT-NUMBER          PIC X(11).
  1378     12  DCUA-UNDRWRTR-CODE        PIC XX.
  1379     12  DCUA-UNDRWRTR-GROUP-CODE  PIC X.
  1380
  1381* DLO011
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  26
* EL050.cbl
  1382 01  WS-DLO-PREM-RATES-BEN-TYPE.
  1383     12  DPRB-RATE-CODE            PIC X(4).
  1384     12  DPRB-COVERAGE-CATEG       PIC X.
  1385     12  DPRB-RETURN-CODE          PIC XX.
  1386         88  DPRB-SUCCESSFUL-PROCESS           VALUE 'OK'.
  1387         88  DPRB-NO-RATE-CODE                 VALUE '01'.
  1388         88  DPRB-NO-COV-CATEG                 VALUE '02'.
  1389         88  DPRB-NO-TOT-RATE-CODE             VALUE '03'.
  1390         88  DPRB-NO-COV-CAT-RATE-BEN-TYP      VALUE '04'.
  1391         88  DPRB-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1392         88  DPRB-GEN-ERR-RTT-TBL              VALUE 'E2'.
  1393         88  DPRB-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1394         88  DPRB-RTT-TABLE-NOT-OPEN           VALUE 'N2'.
  1395     12  DPRB-TOT-RATE-AMT         PIC 9(3)V9(3).
  1396     12  DPRB-COV-CAT-RATE         PIC 9(2)V9(3).
  1397     12  DPRB-BEN-TYPE             PIC XX.
  1398
  1399* DLO017
  1400 01  WS-DLO-VALID-RATE-CODE.
  1401     12  DVRC-RATE-CODE            PIC X(4).
  1402     12  DVRC-RETURN-CODE          PIC XX.
  1403         88  DVRC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1404         88  DVRC-RATE-CODE-NOT-INPUT          VALUE '01'.
  1405         88  DVRC-RATE-CODE-NOT-FOUND          VALUE '02'.
  1406         88  DVRC-RATE-CODE-INACTIVE           VALUE '03'.
  1407         88  DVRC-GEN-ERR-TTR-TBL              VALUE 'E1'.
  1408         88  DVRC-TTR-TABLE-NOT-OPEN           VALUE 'N1'.
  1409
  1410* DLO019
  1411 01  WS-DLO-ORIG-COV-CAT.
  1412     12  DOCC-ORIG-BEN-TYPE        PIC XX.
  1413     12  DOCC-RETURN-CODE          PIC XX.
  1414     12  DOCC-ORIG-COV-CAT         PIC X.
  1415     12  DOCC-UNDERWITER           PIC XX.
  1416     12  DOCC-UNDW-GROUP-CODE      PIC X.
  1417     12  DOCC-FILLER               PIC X(6).
  1418
  1419* DLO021
  1420 01  WS-DLO-VALID-LOAN-OFFICER.
  1421     12  DVLO-LOAN-OFFICER.
  1422         16  DVLO-BILL-TYPE        PIC X.
  1423         16  DVLO-BILL-SOURCE      PIC X.
  1424         16  DVLO-BATCH-TYPE       PIC X.
  1425     12  DVLO-RETURN-CODE          PIC XX.
  1426         88  DVLO-SUCCESSFUL-EDIT              VALUE 'OK'.
  1427         88  DVLO-LOAN-OFFCR-NOT-INPUT         VALUE '01'.
  1428         88  DVLO-BILL-TYPE-INVALID            VALUE '02'.
  1429         88  DVLO-BILL-SOURCE-INVALID          VALUE '03'.
  1430         88  DVLO-BATCH-TYPE-M-INVALID         VALUE '04'.
  1431         88  DVLO-BATCH-TYPE-D-INVALID         VALUE '05'.
  1432
  1433* DLO022
  1434 01  WS-DLO-VALID-STATE-CODE.
  1435     12  DVSC-STATE-CODE           PIC XX.
  1436     12  DVSC-RETURN-CODE          PIC XX.
  1437         88  DVSC-SUCCESSFUL-EDIT              VALUE 'OK'.
  1438
  1439* DLO023
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  27
* EL050.cbl
  1440 01  WS-DLO-VALID-CODE-VALUES.
  1441     12  DVCV-SYSTEM-ID            PIC XX.
  1442         88  DVCV-CLAIMS                       VALUE 'CL'.
  1443         88  DVCV-CREDIT                       VALUE 'CR'.
  1444     12  DVCV-RECORD-TYPE          PIC XX.
  1445         88  DVCV-DENIAL-CODE                  VALUE 'DN'.
  1446         88  DVCV-EOB-CODE                     VALUE 'EO'.
  1447         88  DVCV-ICD9-CODE                    VALUE 'I9'.
  1448         88  DVCV-OCCUPATION-CODE              VALUE 'OC'.
  1449         88  DVCV-PAYMENT-CODE                 VALUE 'PN'.
  1450         88  DVCV-CAUSE-CODE                   VALUE 'CS'.
  1451         88  DVCV-COV-CAT-CODE                 VALUE 'CV'.
  1452         88  DVCV-RES-STATE-CODE               VALUE 'ST'.
  1453     12  DVCV-RECORD-KEY           PIC X(6).
  1454     12  DVCV-RETURN-CODE          PIC XX.
  1455         88  DVCV-SUCCESSFUL-EDIT              VALUE 'OK'.
  1456         88  DVCV-NO-RECORD-TYPE-INPUT         VALUE '01'.
  1457         88  DVCV-NO-SYSTEM-ID-INPUT           VALUE '02'.
  1458         88  DVCV-NO-RECORD-KEY-INPUT          VALUE '03'.
  1459         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '04'.
  1460         88  DVCV-INVALID-SYSTEM-ID-INPUT      VALUE '05'.
  1461         88  DVCV-INVALID-RECORD-KEY-INPUT     VALUE '06'.
  1462     12  DVCV-CODE-DESC            PIC X(60).
  1463     12  DVCV-GEN-DESC-1           PIC X(20).
  1464     12  DVCV-GEN-DESC-2           PIC X(20).
  1465     12  DVCV-GEN-DESC-3           PIC X(20).
  1466
  1467****  this is for aggregate report.
  1468****  Length is erpndb + 100 of passed-key-area
  1469 01  ws-passed-key-length        pic s9(4) comp value +587.
  1470 01  ws-pass-to-pemaggo.
  1471     05  ws-passed-erpndb        pic x(585).
  1472     05  ws-exceed-limit-yn      pic x.
  1473     05  ws-has-claim-yn         pic x.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  28
* EL050.cbl
  1475*    COPY ERCBXRF.
  1476******************************************************************
  1477*                                                                *
  1478*                                                                *
  1479*                            ERCBXRF                             *
  1480*                                                                *
  1481*   ONLINE CREDIT SYSTEM                                         *
  1482*                                                                *
  1483*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1484*                                                                *
  1485*   FILE TYPE = VSAM,KSDS                                        *
  1486*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1487*                                                                *
  1488*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1489*       ALTERNATE PATH = NONE                                    *
  1490*                                                                *
  1491*   LOG = NO                                                     *
  1492*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1493*                                                                *
  1494******************************************************************
  1495
  1496 01  BANK-CROSS-REFERENCE.
  1497     12  BK-RECORD-ID                PIC XX.
  1498         88  VALID-BK-ID             VALUE 'BK'.
  1499
  1500     12  BK-CONTROL-PRIMARY.
  1501         16  BK-COMPANY-CD           PIC X.
  1502         16  BK-CARRIER              PIC X.
  1503         16  BK-GROUPING             PIC X(6).
  1504         16  BK-BANK-NO              PIC X(10).
  1505
  1506     12  BK-MAINT-INFORMATION.
  1507         16  BK-LAST-MAINT-DT        PIC XX.
  1508         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1509         16  BK-LAST-MAINT-USER      PIC X(4).
  1510         16  FILLER                  PIC X(9).
  1511
  1512     12  FILLER                      PIC X(37).
  1513
  1514     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1515
  1516     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1517                            DEPENDING ON BK-BANK-POINTER-CNT.
  1518         16  BK-AM-ACCOUNT           PIC X(10).
  1519         16  BK-AM-EXP-DT            PIC XX.
  1520         16  BK-AM-EFF-DT            PIC XX.
  1521         16  BK-AM-STATE             PIC XX.
  1522         16  FILLER                  PIC X(20).
  1523
  1524******************************************************************
  1525
  1526*    COPY ERCCOMP.
  1527******************************************************************
  1528*                                                                *
  1529*                                                                *
  1530*                            ERCCOMP                             *
  1531*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1532*                            VMOD=2.019                          *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  29
* EL050.cbl
  1533*                                                                *
  1534*   ONLINE CREDIT SYSTEM                                         *
  1535*                                                                *
  1536*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1537*                                                                *
  1538*   FILE TYPE = VSAM,KSDS                                        *
  1539*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1540*                                                                *
  1541*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1542*       ALTERNATE PATH = NONE                                    *
  1543*                                                                *
  1544*   LOG = NO                                                     *
  1545*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1546*                                                                *
  1547******************************************************************
  1548*                   C H A N G E   L O G
  1549*
  1550* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1551*-----------------------------------------------------------------
  1552*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1553* EFFECTIVE    NUMBER
  1554*-----------------------------------------------------------------
  1555* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1556* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1557* 092205    2005050300006  PEMA  ADD LEASE FEE
  1558* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1559* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1560* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1561* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1562* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1563* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1564******************************************************************
  1565
  1566 01  COMPENSATION-MASTER.
  1567     12  CO-RECORD-ID                          PIC XX.
  1568         88  VALID-CO-ID                          VALUE 'CO'.
  1569
  1570     12  CO-CONTROL-PRIMARY.
  1571         16  CO-COMPANY-CD                     PIC X.
  1572         16  CO-CONTROL.
  1573             20  CO-CTL-1.
  1574                 24  CO-CARR-GROUP.
  1575                     28  CO-CARRIER            PIC X.
  1576                     28  CO-GROUPING.
  1577                         32  CO-GROUP-PREFIX   PIC XXX.
  1578                         32  CO-GROUP-PRIME    PIC XXX.
  1579                 24  CO-RESP-NO.
  1580                     28  CO-RESP-PREFIX        PIC X(4).
  1581                     28  CO-RESP-PRIME         PIC X(6).
  1582             20  CO-CTL-2.
  1583                 24  CO-ACCOUNT.
  1584                     28  CO-ACCT-PREFIX        PIC X(4).
  1585                     28  CO-ACCT-PRIME         PIC X(6).
  1586         16  CO-TYPE                           PIC X.
  1587             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1588             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1589             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1590
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  30
* EL050.cbl
  1591     12  CO-MAINT-INFORMATION.
  1592         16  CO-LAST-MAINT-DT                  PIC XX.
  1593         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1594         16  CO-LAST-MAINT-USER                PIC X(4).
  1595     12  FILLER                                PIC XX.
  1596     12  CO-STMT-TYPE                          PIC XXX.
  1597     12  CO-COMP-TYPE                          PIC X.
  1598         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1599     12  CO-STMT-OWNER                         PIC X(4).
  1600     12  CO-BALANCE-CONTROL                    PIC X.
  1601         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1602         88  CO-NO-BALANCE                        VALUE 'N'.
  1603
  1604     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1605         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1606         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1607         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1608
  1609     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1610         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1611         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1612
  1613     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1614     12  CO-GA-DIRECT-DEP                      PIC X.
  1615     12  CO-FUTURE-SPACE                       PIC X.
  1616         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1617
  1618     12  CO-ACCT-NAME                          PIC X(30).
  1619     12  CO-MAIL-NAME                          PIC X(30).
  1620     12  CO-ADDR-1                             PIC X(30).
  1621     12  CO-ADDR-2                             PIC X(30).
  1622     12  CO-ADDR-3.
  1623         16  CO-ADDR-CITY                      PIC X(27).
  1624         16  CO-ADDR-STATE                     PIC XX.
  1625     12  CO-CSO-1099                           PIC X.
  1626     12  CO-ZIP.
  1627         16  CO-ZIP-PRIME.
  1628             20  CO-ZIP-PRI-1ST                PIC X.
  1629                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1630             20  FILLER                        PIC X(4).
  1631         16  CO-ZIP-PLUS4                      PIC X(4).
  1632     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1633         16  CO-CAN-POSTAL-1                   PIC XXX.
  1634         16  CO-CAN-POSTAL-2                   PIC XXX.
  1635         16  FILLER                            PIC XXX.
  1636     12  CO-SOC-SEC                            PIC X(13).
  1637     12  CO-TELEPHONE.
  1638         16  CO-AREA-CODE                      PIC XXX.
  1639         16  CO-PREFIX                         PIC XXX.
  1640         16  CO-PHONE                          PIC X(4).
  1641
  1642     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1643
  1644     12  CO-AR-BAL-LEVEL                       PIC X.
  1645         88  CO-AR-REF-LVL                        VALUE '1'.
  1646         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1647         88  CO-AR-BILL-LVL                       VALUE '2'.
  1648         88  CO-AR-AGT-LVL                        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  31
* EL050.cbl
  1649         88  CO-AR-FR-LVL                         VALUE '4'.
  1650
  1651     12  CO-AR-NORMAL-PRINT                    PIC X.
  1652         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1653         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1654
  1655     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1656
  1657     12  CO-AR-REPORTING                       PIC X.
  1658         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1659         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1660
  1661     12  CO-AR-PULL-CHECK                      PIC X.
  1662         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1663         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1664
  1665     12  CO-AR-BALANCE-PRINT                   PIC X.
  1666         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1667
  1668     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1669         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1670         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1671         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1672
  1673     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1674
  1675     12  CO-USER-CODE                          PIC X.
  1676     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1677
  1678******************************************************************
  1679*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1680*    THE LAST MONTH END RUN.
  1681******************************************************************
  1682
  1683     12  CO-LAST-ACTIVITY-DATE.
  1684         16  CO-ACT-YEAR                       PIC 99.
  1685         16  CO-ACT-MONTH                      PIC 99.
  1686         16  CO-ACT-DAY                        PIC 99.
  1687
  1688     12  CO-LAST-STMT-DT.
  1689         16  CO-LAST-STMT-YEAR                 PIC 99.
  1690         16  CO-LAST-STMT-MONTH                PIC 99.
  1691         16  CO-LAST-STMT-DAY                  PIC 99.
  1692
  1693     12  CO-MO-END-TOTALS.
  1694         16  CO-MONTHLY-TOTALS.
  1695             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1696             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1697             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1698             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1699             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1700
  1701         16  CO-AGING-TOTALS.
  1702             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1703             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1704             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1705             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1706
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  32
* EL050.cbl
  1707         16  CO-YTD-TOTALS.
  1708             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1709             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1710
  1711         16  CO-OVER-UNDER-TOTALS.
  1712             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1713             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1714
  1715     12  CO-MISCELLANEOUS-TOTALS.
  1716         16  CO-FICA-TOTALS.
  1717             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1718             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1719
  1720         16  CO-CLAIM-TOTALS.
  1721             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1722             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1723
  1724******************************************************************
  1725*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1726*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1727******************************************************************
  1728
  1729     12  CO-CURRENT-TOTALS.
  1730         16  CO-CURRENT-LAST-STMT-DT.
  1731             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1732             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1733             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1734
  1735         16  CO-CURRENT-MONTHLY-TOTALS.
  1736             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1737             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1738             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1739             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1740             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1741
  1742         16  CO-CURRENT-AGING-TOTALS.
  1743             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1744             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1745             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1746             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1747
  1748         16  CO-CURRENT-YTD-TOTALS.
  1749             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1750             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1751
  1752     12  CO-PAID-COMM-TOTALS.
  1753         16  CO-YTD-PAID-COMMS.
  1754             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1755             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1756
  1757     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1758         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1759         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1760
  1761     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1762         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1763         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1764         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  33
* EL050.cbl
  1765         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1766         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1767         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1768         88  CO-FINAL-LETTER                  VALUE 'F'.
  1769         88  CO-RECONCILING                   VALUE 'R'.
  1770         88  CO-PHONE-CALL                    VALUE 'P'.
  1771         88  CO-LEGAL                         VALUE 'L'.
  1772         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1773         88  CO-WRITE-OFF                     VALUE 'W'.
  1774         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1775
  1776     12  CO-CSR-CODE                       PIC X(4).
  1777
  1778     12  CO-GA-STATUS-INFO.
  1779         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1780         16  CO-GA-TERMINATION-DT          PIC XX.
  1781         16  CO-GA-STATUS-CODE             PIC X.
  1782             88  CO-GA-ACTIVE                 VALUE 'A'.
  1783             88  CO-GA-INACTIVE               VALUE 'I'.
  1784             88  CO-GA-PENDING                VALUE 'P'.
  1785         16  CO-GA-COMMENTS.
  1786             20  CO-GA-COMMENT-1           PIC X(40).
  1787             20  CO-GA-COMMENT-2           PIC X(40).
  1788             20  CO-GA-COMMENT-3           PIC X(40).
  1789             20  CO-GA-COMMENT-4           PIC X(40).
  1790
  1791     12  CO-RPTCD2                         PIC X(10).
  1792     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1793         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1794         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1795
  1796     12  CO-TYPE-AGENT                     PIC X(01).
  1797         88  CO-CORPORATION                   VALUE 'C'.
  1798         88  CO-PARTNERSHIP                   VALUE 'P'.
  1799         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1800         88  CO-TRUST                         VALUE 'T'.
  1801         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1802
  1803     12  CO-FAXNO.
  1804         16  CO-FAX-AREA-CODE                  PIC XXX.
  1805         16  CO-FAX-PREFIX                     PIC XXX.
  1806         16  CO-FAX-PHONE                      PIC X(4).
  1807
  1808     12  CO-BANK-INFORMATION.
  1809         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1810         16  CO-BANK-TRANSIT-NON REDEFINES
  1811             CO-BANK-TRANSIT-NO                PIC 9(8).
  1812
  1813         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1814     12  CO-MISC-DEDUCT-INFO REDEFINES
  1815                  CO-BANK-INFORMATION.
  1816         16  CO-MD-GL-ACCT                     PIC X(10).
  1817         16  CO-MD-DIV                         PIC XX.
  1818         16  CO-MD-CENTER                      PIC X(4).
  1819         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1820         16  CO-CREATE-AP-CHECK                PIC X.
  1821         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1822         16  FILLER                            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  34
* EL050.cbl
  1823     12  CO-ACH-STATUS                         PIC X.
  1824         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1825         88  CO-ACH-PENDING                        VALUE 'P'.
  1826
  1827     12  CO-BILL-SW                            PIC X.
  1828     12  CO-CONTROL-NAME                       PIC X(30).
  1829     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1830     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1831     12  CO-CLP-STATE                          PIC XX.
  1832     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1833     12  CO-SPP-REFUND-EDIT                    PIC X.
  1834
  1835******************************************************************
  1836
  1837*    COPY ERCAGTC.
  1838******************************************************************
  1839*                                                                *
  1840*                                                                *
  1841*                            ERCAGTC                             *
  1842*                            VMOD=2.001                          *
  1843*                                                                *
  1844*   ONLINE CREDIT SYSTEM                                         *
  1845*                                                                *
  1846*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  1847*                                                                *
  1848*   FILE TYPE = VSAM,KSDS                                        *
  1849*   RECORD SIZE = 450   RECFORM = FIXED                          *
  1850*                                                                *
  1851*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  1852*       ALTERNATE PATH = NONE                                    *
  1853*                                                                *
  1854*   LOG = NO                                                     *
  1855*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1856*                                                                *
  1857******************************************************************
  1858*                   C H A N G E   L O G
  1859*
  1860* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1861*-----------------------------------------------------------------
  1862*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1863* EFFECTIVE    NUMBER
  1864*-----------------------------------------------------------------
  1865* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  1866* 111004                         NEW FILE AND COPYBOOK
  1867* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  1868******************************************************************
  1869 01  AGENT-COMMISSIONS.
  1870     12  AG-RECORD-ID                          PIC XX.
  1871         88  VALID-CO-ID                          VALUE 'AG'.
  1872     12  AG-CONTROL-PRIMARY.
  1873         16  AG-COMPANY-CD                     PIC X.
  1874         16  AG-CONTROL.
  1875             20  AG-CTL-1.
  1876                 24  AG-CARR-GROUP.
  1877                     28  AG-CARRIER            PIC X.
  1878                     28  AG-GROUPING           PIC X(6).
  1879                 24  AG-BANK                   PIC X(10).
  1880             20  AG-CTL-2.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  35
* EL050.cbl
  1881                 24  AG-EXP-DT                 PIC XX.
  1882         16  AG-TYPE                           PIC X.
  1883             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  1884             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  1885     12  AG-MAINT-INFORMATION.
  1886         16  AG-LAST-MAINT-DT                  PIC XX.
  1887         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1888         16  AG-LAST-MAINT-USER                PIC X(4).
  1889         16  FILLER                            PIC X(10).
  1890     12  AG-EFF-DT                             PIC XX.
  1891     12  AG-COMM-STRUCTURE.
  1892         16  AG-AGT-COMMS OCCURS 10.
  1893             20  AG-AGT                PIC X(10).
  1894             20  AG-COM-TYP            PIC X.
  1895             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  1896             20  AG-RECALC-LV-INDIC    PIC X.
  1897             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  1898             20  AG-LRCALC-LV-INDIC    PIC X.
  1899             20  FILLER                PIC X(05).
  1900     12  FILLER                  PIC X(145).
  1901******************************************************************
  1902*    COPY ERCRESS.
  1903******************************************************************
  1904*                                                                *
  1905*                            ERCRESS                             *
  1906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1907*                            VMOD=2.002                          *
  1908*                                                                *
  1909*   CREDIT RESIDENT STATE TAXES MASTER                          *
  1910*                                                                *
  1911*   THIS COPYBOOK IS USED FOR THE ONLINE/BATCH                   *
  1912*   VSAM RESIDENT STATE TAX MASTER                              *
  1913*                                                                *
  1914*   FILE DESCRIPTION = ER.TEST.ERRESS                           *
  1915*                                                                *
  1916*   FILE TYPE = VSAM,KSDS                                        *
  1917*   RECORD SIZE = 0047 RECFORM = FIXED                           *
  1918*                                                                *
  1919*   BASE CLUSTER  NAME = ERRESS                   RKP=00,LEN=09  *
  1920*       ALTERNATE PATH1 = 0000000 (ALT GROUPING)  RKP=00,LEN=00  *
  1921*                                                                *
  1922*   LOG = NO                                                     *
  1923*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1924*                                                                *
  1925*                                                                *
  1926******************************************************************
  1927
  1928 01  RESIDENT-STATE-TAX-MASTER.
  1929
  1930     10  ERRESS-PRIMARY-KEY.
  1931         15  RES-COMPANY-CD        PIC X.
  1932         15  RES-RESIDENT-STATE    PIC XX.
  1933         15  RES-COVERAGE-CATEGORY PIC X.
  1934         15  RES-EXPIRE-DATE       PIC 9(8) COMP-3.
  1935*                                      YYYYMMDD
  1936*****FIRST  OCCURRENCE IS LIFE, SECOND IS P & C
  1937
  1938     10  RES-TAX-RECORD-DATA OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  36
* EL050.cbl
  1939
  1940         15 RES-1YR-STATE-TAX      PIC  SV9(5) COMP-3.
  1941         15 RES-1YR-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1942         15 RES-REN-STATE-TAX      PIC  SV9(5) COMP-3.
  1943         15 RES-REN-MUNICIPAL-TAX  PIC  SV9(5) COMP-3.
  1944
  1945     10 RES-RECALC-SW              PIC   X.
  1946         88 RECALC                VALUE 'Y'.
  1947         88 NO-RECALC             VALUE 'N'.
  1948     10  RES-MAINT-BY              PIC X(4).
  1949     10  RES-LST-MAINT-TIME        PIC 9(7)    COMP-3.
  1950     10  RES-LST-MAINT-DATE        PIC 9(8)    COMP-3.
  1951*                                      YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  37
* EL050.cbl
  1953*    COPY ERCRESC.
  1954******************************************************************
  1955*                                                                *
  1956*                            ERCRESC                             *
  1957*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1958*                            VMOD=2.003                          *
  1959*                                                                *
  1960*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *
  1961*                                                                *
  1962*   FILE TYPE = VSAM,KSDS                                        *
  1963*   RECORD SIZE = 103 RECFORM = FIXED                            *
  1964*                                                                *
  1965*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *
  1966*       ALTERNATE PATH1 = NONE                                   *
  1967*                                                                *
  1968*   LOG = NO                                                     *
  1969*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1970*                                                                *
  1971******************************************************************
  1972
  1973 01  ACCOUNT-RESIDENT-ST-COMMISSION.
  1974
  1975     10  ERRESC-RECORD-KEY.
  1976         15  RESC-COMPANY-CD           PIC   X.
  1977         15  RESC-CARRIER              PIC   X.
  1978         15  RESC-GROUP                PIC   X(6).
  1979         15  RESC-STATE                PIC   XX.
  1980         15  RESC-ACCOUNT              PIC   X(10).
  1981         15  RESC-AGENT                PIC   X(10).
  1982         15  RESC-RESIDENT-STATE       PIC   XX.
  1983         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.
  1984*                                           YYYYMMDD
  1985     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.
  1986
  1987     10  RESC-COMM-RECORD-DATA.
  1988         15  RESC-COMMISSIONS OCCURS 12 TIMES.
  1989             20 RESC-COVERAGE-CAT      PIC    X.
  1990             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.
  1991             20 RESC-COMMISSION-TAB REDEFINES
  1992                RESC-COMMISSION-PER    PIC  XXX.
  1993
  1994     10  RESC-MAINT-BY                 PIC X(4).
  1995     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.
  1996     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.
  1997*                                          YYYYMMDD
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  38
* EL050.cbl
  1999*    COPY ERCPLAN.
  2000******************************************************************
  2001*                                                                *
  2002*                                                                *
  2003*                            ERCPLAN                             *
  2004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2005*                            VMOD=2.003                          *
  2006*                                                                *
  2007*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2008*                                                                *
  2009*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2010*   PLAN MASTER                                                  *
  2011*                                                                *
  2012*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2013*                                                                *
  2014*   FILE TYPE = VSAM,KSDS                                        *
  2015*   RECORD SIZE = 420   RECFORM = FIX                            *
  2016*                                                                *
  2017*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2018*       ALTERNATE PATH1 = N/A                                    *
  2019*                                                                *
  2020*   LOG = NO                                                     *
  2021*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2022*                                                                *
  2023*                                                                *
  2024******************************************************************
  2025
  2026 01  PLAN-MASTER.
  2027     12  PL-RECORD-ID                      PIC XX.
  2028         88  VALID-PL-ID                      VALUE 'PL'.
  2029
  2030     12  PL-CONTROL-PRIMARY.
  2031         16  PL-COMPANY-CD                 PIC X.
  2032         16  PL-MSTR-CNTRL.
  2033             20  PL-CONTROL-A.
  2034                 24  PL-CARRIER            PIC X.
  2035                 24  PL-GROUPING           PIC X(6).
  2036                 24  PL-STATE              PIC XX.
  2037                 24  PL-ACCOUNT            PIC X(10).
  2038             20  PL-BENEFIT-TYPE           PIC X.
  2039             20  PL-BENEFIT-CODE           PIC XX.
  2040             20  PL-REVISION-NO            PIC X(3).
  2041
  2042     12  PL-CONTROL-BY-VAR-GRP.
  2043         16  PL-COMPANY-CD-A1              PIC X.
  2044         16  PL-VG-CARRIER                 PIC X.
  2045         16  PL-VG-GROUPING                PIC X(6).
  2046         16  PL-VG-STATE                   PIC XX.
  2047         16  PL-VG-ACCOUNT                 PIC X(10).
  2048         16  PL-BENEFIT-TYPE-A1            PIC X.
  2049         16  PL-BENEFIT-CODE-A1            PIC XX.
  2050         16  PL-REVISION-NO-A1             PIC 999.
  2051
  2052     12  PL-MAINT-INFORMATION.
  2053         16  PL-LAST-MAINT-DT              PIC XX.
  2054         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2055         16  PL-LAST-MAINT-USER            PIC X(4).
  2056         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  39
* EL050.cbl
  2057
  2058     12  PL-LIABILITY-LIMITS.
  2059         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2060         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2061             20  PL-LM-AGE                 PIC S99        COMP-3.
  2062             20  PL-LM-DUR                 PIC S999       COMP-3.
  2063             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2064             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2065
  2066     12  FILLER                            PIC X(30).
  2067
  2068     12  PL-GL-ACCOUNT-NOS.
  2069         16  PL-PREMIUM-GL                 PIC X(8).
  2070         16  PL-COMM-GL                    PIC X(8).
  2071         16  PL-CLAIM-GL                   PIC X(8).
  2072     12  FILLER                            PIC X(24).
  2073     12  PL-TOLERANCES.
  2074         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2075         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2076         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2077         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2078         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2079         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2080     12  PL-OVER-SHORT.
  2081         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2082         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2083     12  FILLER                            PIC X(24).
  2084     12  PLAN-MISC.
  2085         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2086         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2087         16  PL-IG                         PIC X.
  2088         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2089         16  PL-POLICY-FORM                PIC X(12).
  2090         16  PL-EDIT-FOR-FORM              PIC X(01).
  2091         16  PL-DEV-CODE                   PIC XXX.
  2092         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2093         16  PL-CALC-METHOD                PIC X.
  2094         16  PL-BENEFIT-GROUP              PIC X(05).
  2095         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2096
  2097         16  FILLER                        PIC X(99).
  2098******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  40
* EL050.cbl
  2100*    COPY ELCCERT.
  2101******************************************************************
  2102*                                                                *
  2103*                            ELCCERT.                            *
  2104*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2105*                            VMOD=2.013                          *
  2106*                                                                *
  2107*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  2108*                                                                *
  2109*   FILE TYPE = VSAM,KSDS                                        *
  2110*   RECORD SIZE = 450  RECFORM = FIXED                           *
  2111*                                                                *
  2112*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  2113*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  2114*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  2115*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  2116*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  2117*                                                                *
  2118*   LOG = YES                                                    *
  2119*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2120******************************************************************
  2121*                   C H A N G E   L O G
  2122*
  2123* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2124*-----------------------------------------------------------------
  2125*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2126* EFFECTIVE    NUMBER
  2127*-----------------------------------------------------------------
  2128* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2129* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2130* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  2131* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2132* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2133* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  2134* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2135* 032612  CR2011110200001  PEMA  AHL CHANGES
  2136* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  2137******************************************************************
  2138
  2139 01  CERTIFICATE-MASTER.
  2140     12  CM-RECORD-ID                      PIC XX.
  2141         88  VALID-CM-ID                      VALUE 'CM'.
  2142
  2143     12  CM-CONTROL-PRIMARY.
  2144         16  CM-COMPANY-CD                 PIC X.
  2145         16  CM-CARRIER                    PIC X.
  2146         16  CM-GROUPING.
  2147             20  CM-GROUPING-PREFIX        PIC X(3).
  2148             20  CM-GROUPING-PRIME         PIC X(3).
  2149         16  CM-STATE                      PIC XX.
  2150         16  CM-ACCOUNT.
  2151             20  CM-ACCOUNT-PREFIX         PIC X(4).
  2152             20  CM-ACCOUNT-PRIME          PIC X(6).
  2153         16  CM-CERT-EFF-DT                PIC XX.
  2154         16  CM-CERT-NO.
  2155             20  CM-CERT-PRIME             PIC X(10).
  2156             20  CM-CERT-SFX               PIC X.
  2157
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  41
* EL050.cbl
  2158     12  CM-CONTROL-BY-NAME.
  2159         16  CM-COMPANY-CD-A1              PIC X.
  2160         16  CM-INSURED-LAST-NAME          PIC X(15).
  2161         16  CM-INSURED-INITIALS.
  2162             20  CM-INSURED-INITIAL1       PIC X.
  2163             20  CM-INSURED-INITIAL2       PIC X.
  2164
  2165     12  CM-CONTROL-BY-SSN.
  2166         16  CM-COMPANY-CD-A2              PIC X.
  2167         16  CM-SOC-SEC-NO.
  2168             20  CM-SSN-STATE              PIC XX.
  2169             20  CM-SSN-ACCOUNT            PIC X(6).
  2170             20  CM-SSN-LN3.
  2171                 25  CM-INSURED-INITIALS-A2.
  2172                     30 CM-INSURED-INITIAL1-A2   PIC X.
  2173                     30 CM-INSURED-INITIAL2-A2   PIC X.
  2174                 25 CM-PART-LAST-NAME-A2         PIC X.
  2175
  2176     12  CM-CONTROL-BY-CERT-NO.
  2177         16  CM-COMPANY-CD-A4              PIC X.
  2178         16  CM-CERT-NO-A4                 PIC X(11).
  2179
  2180     12  CM-CONTROL-BY-MEMB.
  2181         16  CM-COMPANY-CD-A5              PIC X.
  2182         16  CM-MEMBER-NO.
  2183             20  CM-MEMB-STATE             PIC XX.
  2184             20  CM-MEMB-ACCOUNT           PIC X(6).
  2185             20  CM-MEMB-LN4.
  2186                 25  CM-INSURED-INITIALS-A5.
  2187                     30 CM-INSURED-INITIAL1-A5   PIC X.
  2188                     30 CM-INSURED-INITIAL2-A5   PIC X.
  2189                 25 CM-PART-LAST-NAME-A5         PIC XX.
  2190
  2191     12  CM-INSURED-PROFILE-DATA.
  2192         16  CM-INSURED-FIRST-NAME.
  2193             20  CM-INSURED-1ST-INIT       PIC X.
  2194             20  FILLER                    PIC X(9).
  2195         16  CM-INSURED-ISSUE-AGE          PIC 99.
  2196         16  CM-INSURED-SEX                PIC X.
  2197             88  CM-SEX-MALE                  VALUE 'M'.
  2198             88  CM-SEX-FEMAL                 VALUE 'F'.
  2199         16  CM-INSURED-JOINT-AGE          PIC 99.
  2200         16  CM-JOINT-INSURED-NAME.
  2201             20  CM-JT-LAST-NAME           PIC X(15).
  2202             20  CM-JT-FIRST-NAME.
  2203                 24  CM-JT-1ST-INIT        PIC X.
  2204                 24  FILLER                PIC X(9).
  2205             20  CM-JT-INITIAL             PIC X.
  2206
  2207     12  CM-LIFE-DATA.
  2208         16  CM-LF-BENEFIT-CD              PIC XX.
  2209         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  2210         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  2211         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  2212         16  CM-LF-DEV-CODE                PIC XXX.
  2213         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2214         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  2215         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  42
* EL050.cbl
  2216         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  2217         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2218         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2219         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  2220         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2221         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  2222         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2223         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2224         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  2225         16  cm-temp-epiq                  pic xx.
  2226             88  EPIQ-CLASS                  value 'EQ'.
  2227*        16  FILLER                        PIC XX.
  2228
  2229     12  CM-AH-DATA.
  2230         16  CM-AH-BENEFIT-CD              PIC XX.
  2231         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  2232         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  2233         16  CM-AH-DEV-CODE                PIC XXX.
  2234         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  2235         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  2236         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  2237         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  2238         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  2239         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  2240         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  2241         16  CM-AH-PAID-THRU-DT            PIC XX.
  2242             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  2243         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  2244         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  2245         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  2246         16  FILLER                        PIC X.
  2247
  2248     12  CM-LOAN-INFORMATION.
  2249         16  CM-LIVES                      PIC S9(7)     COMP-3.
  2250         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  2251                                           PIC S9(5)V99  COMP-3.
  2252         16  CM-BILLED                     PIC S9(7)     COMP-3.
  2253         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  2254         16  CM-PAY-FREQUENCY              PIC S99.
  2255         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  2256         16  CM-RATE-CLASS                 PIC XX.
  2257         16  CM-BENEFICIARY                PIC X(25).
  2258         16  CM-POLICY-FORM-NO             PIC X(12).
  2259         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  2260         16  CM-LAST-ADD-ON-DT             PIC XX.
  2261         16  CM-DEDUCTIBLE-AMOUNTS.
  2262             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  2263             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  2264         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2265             20  CM-RESIDENT-STATE         PIC XX.
  2266             20  CM-RATE-CODE              PIC X(4).
  2267             20  FILLER                    PIC XX.
  2268         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  2269             20  CM-LOAN-OFFICER           PIC X(5).
  2270             20  FILLER                    PIC XXX.
  2271         16  CM-CSR-CODE                   PIC XXX.
  2272         16  CM-UNDERWRITING-CODE          PIC X.
  2273             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  43
* EL050.cbl
  2274         16  CM-POST-CARD-IND              PIC X.
  2275         16  CM-NH-INTERFACE-SW            PIC X.
  2276         16  CM-PREMIUM-TYPE               PIC X.
  2277             88  CM-SING-PRM                  VALUE '1'.
  2278             88  CM-O-B-COVERAGE              VALUE '2'.
  2279             88  CM-OPEN-END                  VALUE '3'.
  2280         16  CM-IND-GRP-TYPE               PIC X.
  2281             88  CM-INDIVIDUAL                VALUE 'I'.
  2282             88  CM-GROUP                     VALUE 'G'.
  2283         16  CM-SKIP-CODE                  PIC X.
  2284             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  2285             88  SKIP-JULY                    VALUE '1'.
  2286             88  SKIP-AUGUST                  VALUE '2'.
  2287             88  SKIP-SEPTEMBER               VALUE '3'.
  2288             88  SKIP-JULY-AUG                VALUE '4'.
  2289             88  SKIP-AUG-SEPT                VALUE '5'.
  2290             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  2291             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  2292             88  SKIP-JUNE                    VALUE '8'.
  2293             88  SKIP-JUNE-JULY               VALUE '9'.
  2294             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  2295             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  2296         16  CM-PAYMENT-MODE               PIC X.
  2297             88  PAY-MONTHLY                  VALUE SPACE.
  2298             88  PAY-WEEKLY                   VALUE '1'.
  2299             88  PAY-SEMI-MONTHLY             VALUE '2'.
  2300             88  PAY-BI-WEEKLY                VALUE '3'.
  2301             88  PAY-SEMI-ANUALLY             VALUE '4'.
  2302         16  CM-LOAN-NUMBER                PIC X(8).
  2303         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  2304         16  CM-OLD-LOF                    PIC XXX.
  2305*        16  CM-LOAN-OFFICER               PIC XXX.
  2306         16  CM-REIN-TABLE                 PIC XXX.
  2307         16  CM-SPECIAL-REIN-CODE          PIC X.
  2308         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  2309         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  2310         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  2311
  2312     12  CM-STATUS-DATA.
  2313         16  CM-ENTRY-STATUS               PIC X.
  2314         16  CM-ENTRY-DT                   PIC XX.
  2315
  2316         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  2317         16  CM-LF-CANCEL-DT               PIC XX.
  2318         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  2319
  2320         16  CM-LF-STATUS-AT-DEATH         PIC X.
  2321         16  CM-LF-DEATH-DT                PIC XX.
  2322         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  2323
  2324         16  CM-LF-CURRENT-STATUS          PIC X.
  2325             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2326                                                'M' '4' '5' '9'.
  2327             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  2328             88  CM-LF-POLICY-PENDING         VALUE '2'.
  2329             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  2330             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  2331             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  44
* EL050.cbl
  2332             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  2333             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2334             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  2335             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2336             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  2337             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  2338             88  CM-LF-DECLINED               VALUE 'D'.
  2339             88  CM-LF-VOIDED                 VALUE 'V'.
  2340
  2341         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  2342         16  CM-AH-CANCEL-DT               PIC XX.
  2343         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  2344
  2345         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  2346         16  CM-AH-SETTLEMENT-DT           PIC XX.
  2347         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  2348
  2349         16  CM-AH-CURRENT-STATUS          PIC X.
  2350             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  2351                                                'M' '4' '5' '9'.
  2352             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  2353             88  CM-AH-POLICY-PENDING         VALUE '2'.
  2354             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  2355             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  2356             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  2357             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  2358             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2359             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  2360             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2361             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  2362             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  2363             88  CM-AH-DECLINED               VALUE 'D'.
  2364             88  CM-AH-VOIDED                 VALUE 'V'.
  2365
  2366         16  CM-CLAIM-INTERFACE-SW         PIC X.
  2367             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  2368             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  2369             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  2370         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  2371
  2372         16  CM-ENTRY-BATCH                PIC X(6).
  2373         16  CM-LF-EXIT-BATCH              PIC X(6).
  2374         16  CM-AH-EXIT-BATCH              PIC X(6).
  2375         16  CM-LAST-MONTH-END             PIC XX.
  2376
  2377     12  CM-NOTE-SW                        PIC X.
  2378         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  2379         88  CERT-NOTES-PRESENT               VALUE '1'.
  2380         88  BILLING-NOTES-PRESENT            VALUE '2'.
  2381         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  2382         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  2383         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  2384         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  2385         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  2386     12  CM-COMP-EXCP-SW                   PIC X.
  2387         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  2388         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  2389     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  45
* EL050.cbl
  2390         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  2391         88  INSURED-ADDR-PRESENT             VALUE '1'.
  2392
  2393*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  2394     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  2395     12  FILLER                            PIC X.
  2396
  2397*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  2398     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  2399     12  FILLER                            PIC X.
  2400*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  2401     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  2402
  2403     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  2404         88  CERT-ADDED-BATCH                 VALUE ' '.
  2405         88  CERT-ADDED-ONLINE                VALUE '1'.
  2406         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  2407         88  CERT-PURGED-OFFLINE              VALUE '3'.
  2408         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  2409     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  2410         88  CERT-AS-LOADED                   VALUE ' '.
  2411         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  2412         88  CERT-CLAIM-ONLINE                VALUE '2'.
  2413         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  2414         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  2415         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  2416         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  2417         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  2418
  2419     12  CM-ACCOUNT-COMM-PCTS.
  2420         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  2421         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  2422
  2423     12  CM-USER-FIELD                     PIC X.
  2424     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  2425     12  CM-CLP-STATE                      PIC XX.
  2426     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  2427     12  CM-USER-RESERVED                  PIC XXX.
  2428     12  FILLER REDEFINES CM-USER-RESERVED.
  2429         16  CM-AH-CLASS-CD                PIC XX.
  2430         16  F                             PIC X.
  2431******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  46
* EL050.cbl
  2433*    COPY ERCMAIL.
  2434******************************************************************
  2435*                                                                *
  2436*                                                                *
  2437*                            ERCMAIL                             *
  2438*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2439*                            VMOD=2.003                          *
  2440*                                                                *
  2441*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  2442*                                                                *
  2443*   FILE TYPE = VSAM,KSDS                                        *
  2444*   RECORD SIZE = 374   RECFORM = FIX                            *
  2445*                                                                *
  2446*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  2447*   ALTERNATE PATH    = NOT USED                                 *
  2448*                                                                *
  2449*   LOG = YES                                                    *
  2450*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2451******************************************************************
  2452*                   C H A N G E   L O G
  2453*
  2454* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2455*-----------------------------------------------------------------
  2456*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2457* EFFECTIVE    NUMBER
  2458*-----------------------------------------------------------------
  2459* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2460* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2461* 111108                   PEMA  ADD CRED BENE ADDR2
  2462******************************************************************
  2463
  2464 01  MAILING-DATA.
  2465     12  MA-RECORD-ID                      PIC XX.
  2466         88  VALID-MA-ID                       VALUE 'MA'.
  2467
  2468     12  MA-CONTROL-PRIMARY.
  2469         16  MA-COMPANY-CD                 PIC X.
  2470         16  MA-CARRIER                    PIC X.
  2471         16  MA-GROUPING.
  2472             20  MA-GROUPING-PREFIX        PIC XXX.
  2473             20  MA-GROUPING-PRIME         PIC XXX.
  2474         16  MA-STATE                      PIC XX.
  2475         16  MA-ACCOUNT.
  2476             20  MA-ACCOUNT-PREFIX         PIC X(4).
  2477             20  MA-ACCOUNT-PRIME          PIC X(6).
  2478         16  MA-CERT-EFF-DT                PIC XX.
  2479         16  MA-CERT-NO.
  2480             20  MA-CERT-PRIME             PIC X(10).
  2481             20  MA-CERT-SFX               PIC X.
  2482
  2483     12  FILLER                            PIC XX.
  2484
  2485     12  MA-ACCESS-CONTROL.
  2486         16  MA-SOURCE-SYSTEM              PIC XX.
  2487             88  MA-FROM-CREDIT                VALUE 'CR'.
  2488             88  MA-FROM-VSI                   VALUE 'VS'.
  2489             88  MA-FROM-WARRANTY              VALUE 'WA'.
  2490             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  47
* EL050.cbl
  2491         16  MA-RECORD-ADD-DT              PIC XX.
  2492         16  MA-RECORD-ADDED-BY            PIC XXXX.
  2493         16  MA-LAST-MAINT-DT              PIC XX.
  2494         16  MA-LAST-MAINT-BY              PIC XXXX.
  2495         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2496
  2497     12  MA-PROFILE-INFO.
  2498         16  MA-QUALIFY-CODE-1             PIC XX.
  2499         16  MA-QUALIFY-CODE-2             PIC XX.
  2500         16  MA-QUALIFY-CODE-3             PIC XX.
  2501         16  MA-QUALIFY-CODE-4             PIC XX.
  2502         16  MA-QUALIFY-CODE-5             PIC XX.
  2503
  2504         16  MA-INSURED-LAST-NAME          PIC X(15).
  2505         16  MA-INSURED-FIRST-NAME         PIC X(10).
  2506         16  MA-INSURED-MIDDLE-INIT        PIC X.
  2507         16  MA-INSURED-ISSUE-AGE          PIC 99.
  2508         16  MA-INSURED-BIRTH-DT           PIC XX.
  2509         16  MA-INSURED-SEX                PIC X.
  2510             88  MA-SEX-MALE                   VALUE 'M'.
  2511             88  MA-SEX-FEMALE                 VALUE 'F'.
  2512         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  2513
  2514         16  MA-ADDRESS-CORRECTED          PIC X.
  2515         16  MA-JOINT-BIRTH-DT             PIC XX.
  2516*        16  FILLER                        PIC X(12).
  2517
  2518         16  MA-ADDRESS-LINE-1             PIC X(30).
  2519         16  MA-ADDRESS-LINE-2             PIC X(30).
  2520         16  MA-CITY-STATE.
  2521             20  MA-CITY                   PIC X(28).
  2522             20  MA-ADDR-STATE             PIC XX.
  2523         16  MA-ZIP.
  2524             20  MA-ZIP-CODE.
  2525                 24  MA-ZIP-CODE-1ST       PIC X(1).
  2526                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2527                 24  FILLER                PIC X(4).
  2528             20  MA-ZIP-PLUS4              PIC X(4).
  2529         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  2530             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  2531             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  2532             20  FILLER                    PIC X(3).
  2533
  2534         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  2535
  2536         16  FILLER                        PIC XXX.
  2537*        16  FILLER                        PIC X(10).
  2538
  2539     12  MA-CRED-BENE-INFO.
  2540         16  MA-CRED-BENE-NAME                 PIC X(25).
  2541         16  MA-CRED-BENE-ADDR                 PIC X(30).
  2542         16  MA-CRED-BENE-ADDR2                PIC X(30).
  2543         16  MA-CRED-BENE-CTYST.
  2544             20  MA-CRED-BENE-CITY             PIC X(28).
  2545             20  MA-CRED-BENE-STATE            PIC XX.
  2546         16  MA-CRED-BENE-ZIP.
  2547             20  MA-CB-ZIP-CODE.
  2548                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  48
* EL050.cbl
  2549                     88  MA-CB-CANADIAN-POST-CODE
  2550                                           VALUE 'A' THRU 'Z'.
  2551                 24  FILLER                    PIC X(4).
  2552             20  MA-CB-ZIP-PLUS4               PIC X(4).
  2553         16  MA-CB-CANADIAN-POSTAL-CODE
  2554                            REDEFINES MA-CRED-BENE-ZIP.
  2555             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  2556             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  2557             20  FILLER                        PIC X(3).
  2558     12  MA-POST-CARD-MAIL-DATA.
  2559         16  MA-MAIL-DATA OCCURS 7.
  2560             20  MA-MAIL-TYPE              PIC X.
  2561                 88  MA-12MO-MAILING           VALUE '1'.
  2562                 88  MA-EXP-MAILING            VALUE '2'.
  2563             20  MA-MAIL-STATUS            PIC X.
  2564                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  2565                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  2566                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  2567             20  MA-MAIL-DATE              PIC XX.
  2568     12  FILLER                            PIC XX.
  2569     12  FILLER                            PIC XX.
  2570*    12  FILLER                            PIC X(30).
  2571******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  49
* EL050.cbl
  2573*    COPY ERCPNDM.
  2574******************************************************************
  2575*                                                                *
  2576*                                                                *
  2577*                            ERCPNDM                             *
  2578*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2579*                            VMOD=2.003                          *
  2580*                                                                *
  2581*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2582*                                                                *
  2583*   FILE TYPE = VSAM,KSDS                                        *
  2584*   RECORD SIZE = 374   RECFORM = FIX                            *
  2585*                                                                *
  2586*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2587*   ALTERNATE PATH    = NOT USED                                 *
  2588*                                                                *
  2589*   LOG = YES                                                    *
  2590*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2591******************************************************************
  2592*                   C H A N G E   L O G
  2593*
  2594* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2595*-----------------------------------------------------------------
  2596*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2597* EFFECTIVE    NUMBER
  2598*-----------------------------------------------------------------
  2599* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2600* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2601* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2602******************************************************************
  2603
  2604 01  PENDING-MAILING-DATA.
  2605     12  PM-RECORD-ID                      PIC XX.
  2606         88  VALID-MA-ID                       VALUE 'PM'.
  2607
  2608     12  PM-CONTROL-PRIMARY.
  2609         16  PM-COMPANY-CD                 PIC X.
  2610         16  PM-ENTRY-BATCH                PIC X(6).
  2611         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2612         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2613
  2614     12  FILLER                            PIC X(14).
  2615
  2616     12  PM-ACCESS-CONTROL.
  2617         16  PM-SOURCE-SYSTEM              PIC XX.
  2618             88  PM-FROM-CREDIT                VALUE 'CR'.
  2619             88  PM-FROM-VSI                   VALUE 'VS'.
  2620             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2621             88  PM-FROM-OTHER                 VALUE 'OT'.
  2622         16  PM-RECORD-ADD-DT              PIC XX.
  2623         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2624         16  PM-LAST-MAINT-DT              PIC XX.
  2625         16  PM-LAST-MAINT-BY              PIC XXXX.
  2626         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2627
  2628     12  PM-PROFILE-INFO.
  2629         16  PM-QUALIFY-CODE-1             PIC XX.
  2630         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  50
* EL050.cbl
  2631         16  PM-QUALIFY-CODE-3             PIC XX.
  2632         16  PM-QUALIFY-CODE-4             PIC XX.
  2633         16  PM-QUALIFY-CODE-5             PIC XX.
  2634
  2635         16  PM-INSURED-LAST-NAME          PIC X(15).
  2636         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2637         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2638         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2639         16  PM-INSURED-BIRTH-DT           PIC XX.
  2640         16  PM-INSURED-SEX                PIC X.
  2641             88  PM-SEX-MALE                   VALUE 'M'.
  2642             88  PM-SEX-FEMALE                 VALUE 'F'.
  2643         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2644
  2645         16  PM-ADDRESS-CORRECTED          PIC X.
  2646         16  PM-JOINT-BIRTH-DT             PIC XX.
  2647*        16  FILLER                        PIC X(12).
  2648
  2649         16  PM-ADDRESS-LINE-1             PIC X(30).
  2650         16  PM-ADDRESS-LINE-2             PIC X(30).
  2651         16  PM-CITY-STATE.
  2652             20  PM-CITY                   PIC X(28).
  2653             20  PM-STATE                  PIC XX.
  2654         16  PM-ZIP.
  2655             20  PM-ZIP-CODE.
  2656                 24  PM-ZIP-1              PIC X.
  2657                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2658                 24  FILLER                PIC X(4).
  2659             20  PM-ZIP-PLUS4              PIC X(4).
  2660         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2661             20  PM-CAN-POST1              PIC XXX.
  2662             20  PM-CAN-POST2              PIC XXX.
  2663             20  FILLER                    PIC XXX.
  2664
  2665         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2666
  2667         16  FILLER                        PIC X(03).
  2668
  2669     12  PM-CRED-BENE-INFO.
  2670         16  PM-CRED-BENE-NAME             PIC X(25).
  2671         16  PM-CRED-BENE-ADDR             PIC X(30).
  2672         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2673         16  PM-CRED-BENE-CTYST.
  2674             20  PM-CRED-BENE-CITY         PIC X(28).
  2675             20  PM-CRED-BENE-STATE        PIC XX.
  2676         16  PM-CRED-BENE-ZIP.
  2677             20  PM-CB-ZIP-CODE.
  2678                 24  PM-CB-ZIP-1           PIC X.
  2679                     88  PM-CB-CANADIAN-POST-CODE
  2680                                  VALUE 'A' THRU 'Z'.
  2681                 24  FILLER                PIC X(4).
  2682             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2683         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2684             20  PM-CB-CAN-POST1           PIC XXX.
  2685             20  PM-CB-CAN-POST2           PIC XXX.
  2686             20  FILLER                    PIC XXX.
  2687     12  PM-POST-CARD-MAIL-DATA.
  2688         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  51
* EL050.cbl
  2689             20  PM-MAIL-TYPE              PIC X.
  2690                 88  PM-12MO-MAILING           VALUE '1'.
  2691                 88  PM-EXP-MAILING            VALUE '2'.
  2692             20  PM-MAIL-STATUS            PIC X.
  2693                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2694                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2695                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2696             20  PM-MAIL-DATE              PIC XX.
  2697     12  FILLER                            PIC XX.
  2698     12  FILLER                            PIC X(12).
  2699*    12  FILLER                            PIC X(30).
  2700
  2701******************************************************************
  2702*                                COPY ERCLOFC.
  2703******************************************************************
  2704*                                                                *
  2705*                                                                *
  2706*                            ERCLOFC                             *
  2707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2708*                            VMOD=2.003                          *
  2709*                                                                *
  2710*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  2711*                                                                *
  2712*   FILE TYPE = VSAM,KSDS                                        *
  2713*   RECORD SIZE = 670   RECFORM = FIX                            *
  2714*                                                                *
  2715*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  2716*                                                                *
  2717*   LOG = YES                                                    *
  2718*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2719*                                                                *
  2720******************************************************************
  2721
  2722 01  LOAN-OFFICER-MASTER.
  2723     12  LO-RECORD-ID                PIC XX.
  2724         88  VALID-LO-ID                VALUE 'LO'.
  2725
  2726     12  LO-CONTROL-PRIMARY.
  2727         16  LO-COMPANY-CD           PIC X.
  2728         16  LO-CARRIER              PIC X.
  2729         16  LO-GROUPING.
  2730             20  LO-GROUPING-PREFIX  PIC XXX.
  2731             20  LO-GROUPING-PRIME   PIC XXX.
  2732         16  LO-STATE                PIC XX.
  2733         16  LO-ACCOUNT.
  2734             20  LO-ACCOUNT-PREFIX   PIC X(4).
  2735             20  LO-ACCOUNT-PRIME    PIC X(6).
  2736         16  LO-OFFICER-CODE         PIC X(5).
  2737
  2738     12  LO-OFFICER-NAME             PIC X(30).
  2739
  2740     12  LO-LAST-MAINT-DT            PIC XX.
  2741     12  LO-LAST-USER                PIC X(4).
  2742     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  2743
  2744     12  LO-COMP-CONTROL             PIC X.
  2745             88  LO-SHOW-COMP           VALUE 'Y'.
  2746             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  52
* EL050.cbl
  2747     12  LO-DETAIL-CONTROL           PIC X.
  2748             88  LO-PRINT-DETAIL        VALUE 'D'.
  2749             88  LO-PRINT-SUMMARY       VALUE 'S'.
  2750
  2751     12  LO-SV-CARRIER               PIC X.
  2752     12  LO-SV-GROUPING              PIC X(6).
  2753     12  LO-SV-STATE                 PIC XX.
  2754
  2755     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  2756     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  2757
  2758     12  LO-OFFICER-INFO.
  2759         16  FILLER OCCURS 12 TIMES.
  2760             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  2761             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  2762             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  2763             20  LO-LF-PREM          PIC S9(7) COMP-3.
  2764             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  2765             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  2766             20  LO-AH-PREM          PIC S9(7) COMP-3.
  2767             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  2768     12  FILLER                      PIC X(198).
  2769******************************************************************
  2770*                                COPY ERCPDEF.
  2771******************************************************************
  2772*                                                                *
  2773*                                                                *
  2774*                            ERCPDEF.                            *
  2775*                                                                *
  2776*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  2777*                                                                *
  2778*    FILE TYPE = VSAM,KSDS                                       *
  2779*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  2780*                                                                *
  2781*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  2782*                                                                *
  2783*    LOG = YES                                                   *
  2784*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2785******************************************************************
  2786*                   C H A N G E   L O G
  2787*
  2788* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2789*-----------------------------------------------------------------
  2790*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2791* EFFECTIVE    NUMBER
  2792*-----------------------------------------------------------------
  2793* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2794* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2795* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  2796******************************************************************
  2797 01  PRODUCT-MASTER.
  2798    12  PD-RECORD-ID                 PIC X(02).
  2799        88  VALID-PD-ID                  VALUE 'PD'.
  2800    12  PD-CONTROL-PRIMARY.
  2801        16  PD-COMPANY-CD            PIC X.
  2802        16  PD-STATE                 PIC XX.
  2803        16  PD-PRODUCT-CD            PIC XXX.
  2804        16  PD-FILLER                PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  53
* EL050.cbl
  2805        16  PD-BEN-TYPE              PIC X.
  2806        16  PD-BEN-CODE              PIC XX.
  2807        16  PD-PROD-EXP-DT           PIC XX.
  2808    12  FILLER                       PIC X(50).
  2809    12  PD-PRODUCT-DATA OCCURS 8.
  2810        16  PD-PROD-CODE             PIC X.
  2811            88  PD-PROD-LIFE           VALUE 'L'.
  2812            88  PD-PROD-PROP           VALUE 'P'.
  2813            88  PD-PROD-AH             VALUE 'A'.
  2814            88  PD-PROD-IU             VALUE 'I'.
  2815            88  PD-PROD-GAP            VALUE 'G'.
  2816            88  PD-PROD-FAML           VALUE 'F'.
  2817        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  2818        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  2819        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  2820        16  PD-MAX-TERM              PIC S999        COMP-3.
  2821        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  2822        16  FILLER                   PIC X.
  2823        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  2824        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  2825        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  2826        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  2827        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  2828        16  PD-REC-CRIT-PERIOD       PIC 99.
  2829        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  2830            20  PD-RECURRING-YN      PIC X.
  2831            20  FILLER               PIC X.
  2832        16  PD-RTW-MOS               PIC 99.
  2833        16  PD-MAX-EXTENSION         PIC 99.
  2834        16  pd-ben-pct               pic sv999 comp-3.
  2835*       16  FILLER                   PIC XX.
  2836    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  2837    12  PD-TERM-LIMITS OCCURS 15.
  2838        16  PD-LOW-TERM              PIC S999        COMP-3.
  2839        16  PD-HI-TERM               PIC S999        COMP-3.
  2840*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  2841    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  2842        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  2843        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  2844    12  PD-EARN-FACTORS.
  2845        16  FILLER OCCURS 15.
  2846            20  FILLER OCCURS 15.
  2847                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  2848    12  PD-PRODUCT-DESC              PIC X(80).
  2849    12  PD-TRUNCATED                 PIC X.
  2850    12  FILLER                       PIC X(59).
  2851    12  PD-MAINT-INFORMATION.
  2852        16  PD-LAST-MAINT-DT         PIC X(02).
  2853        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2854        16  PD-LAST-MAINT-BY         PIC X(04).
  2855*                                COPY ELCSTATE.
  2856******************************************************************
  2857*                                                                *
  2858*                                                                *
  2859*                            ELCSTATE.                           *
  2860*                                                                *
  2861*   FILE DESCRIPTION = LOGIC STATE CONTROLS                      *
  2862*                                                                *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  54
* EL050.cbl
  2863*   FILE TYPE = VSAM,KSDS                                        *
  2864*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2865*                                                                *
  2866*   BASE CLUSTER = ELSTAT                        RKP=2,LEN=20    *
  2867*       ALTERNATE INDEX = NONE                                   *
  2868*                                                                *
  2869*   LOG = YES                                                    *
  2870*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2871******************************************************************
  2872*                   C H A N G E   L O G
  2873*
  2874* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2875*-----------------------------------------------------------------
  2876*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2877* EFFECTIVE    NUMBER
  2878*-----------------------------------------------------------------
  2879* 122710  CR2010012700001  PEMA  NEW COPYBOOK
  2880******************************************************************
  2881*
  2882 01  STATE-FILE.
  2883     12  SF-RECORD-ID                       PIC XX.
  2884         88  VALID-CF-ID                        VALUE 'SF'.
  2885     12  SF-CONTROL-PRIMARY.
  2886         16  SF-COMPANY-ID                  PIC XXX.
  2887         16  SF-CARRIER-CODE                PIC X.
  2888         16  SF-GROUPING                    PIC X(6).
  2889         16  SF-STATE-CODE                  PIC XX.
  2890         16  SF-EXPIRE-DATE                 PIC 9(8).
  2891****************************************************************
  2892*             STATE CONTROLS
  2893****************************************************************
  2894     12  SF-LAST-MAINT-DT                   PIC XX.
  2895     12  SF-LAST-MAINT-BY                   PIC X(4).
  2896     12  SF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2897     12  SF-STATE-RT-CONTROLS.
  2898         16  SF-ST-RT-CALC                  PIC X.
  2899     12  SF-ST-TAX-CONTROLS.
  2900         16  SF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2901         16  SF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2902         16  SF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2903     12  SF-ST-REFUND-OPTIONS.
  2904         16  SF-ST-RF-LR-CALC               PIC X.
  2905         16  SF-ST-RF-LL-CALC               PIC X.
  2906         16  SF-ST-RF-LN-CALC               PIC X.
  2907         16  SF-ST-RF-AH-CALC               PIC X.
  2908         16  SF-ST-RF-CP-CALC               PIC X.
  2909     12  SF-ST-UNEARN-PREM-OPTIONS.
  2910         16  SF-ST-LUEP-R78                 PIC X.
  2911         16  SF-ST-LUEP-PRO                 PIC X.
  2912         16  SF-ST-LUEP-ST                  PIC X.
  2913         16  SF-ST-LUEP-DOM                 PIC X.
  2914         16  SF-ST-AUEP-R78                 PIC X.
  2915         16  SF-ST-AUEP-PRO                 PIC X.
  2916         16  SF-ST-AUEP-ST                  PIC X.
  2917         16  SF-ST-AUEP-DOM                 PIC X.
  2918         16  SF-ST-CUEP-R78                 PIC X.
  2919         16  SF-ST-CUEP-PRO                 PIC X.
  2920         16  SF-ST-CUEP-ST                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  55
* EL050.cbl
  2921         16  SF-ST-CUEP-DOM                 PIC X.
  2922     12  SF-ST-EARN-PREM-OPTIONS.
  2923         16  SF-ST-LEP-R78                  PIC X.
  2924         16  SF-ST-LEP-PRO                  PIC X.
  2925         16  SF-ST-LEP-ST                   PIC X.
  2926         16  SF-ST-LEP-DOM                  PIC X.
  2927         16  SF-ST-AEP-R78                  PIC X.
  2928         16  SF-ST-AEP-PRO                  PIC X.
  2929         16  SF-ST-AEP-ST                   PIC X.
  2930         16  SF-ST-AEP-DOM                  PIC X.
  2931         16  SF-ST-CEP-R78                  PIC X.
  2932         16  SF-ST-CEP-PRO                  PIC X.
  2933         16  SF-ST-CEP-ST                   PIC X.
  2934         16  SF-ST-CEP-DOM                  PIC X.
  2935     12  SF-FOR-FUTURE-USE                  PIC X(179).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  56
* EL050.cbl
  2937*    COPY ELCCRTT.
  2938******************************************************************
  2939*                                                                *
  2940*                            ELCCRTT.                            *
  2941*                                                                *
  2942*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  2943*                                                                *
  2944*   FILE TYPE = VSAM,KSDS                                        *
  2945*   RECORD SIZE = 552  RECFORM = FIXED                           *
  2946*                                                                *
  2947*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  2948*                                                                *
  2949*   LOG = YES                                                    *
  2950*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2951******************************************************************
  2952*                   C H A N G E   L O G
  2953*
  2954* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2955*-----------------------------------------------------------------
  2956*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2957* EFFECTIVE    NUMBER
  2958*-----------------------------------------------------------------
  2959* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  2960* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  2961* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  2962* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  2963* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  2964* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2965* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  2966* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  2967******************************************************************
  2968
  2969 01  CERTIFICATE-TRAILERS.
  2970     12  CS-RECORD-ID                      PIC XX.
  2971         88  VALID-CS-ID                      VALUE 'CS'.
  2972
  2973     12  CS-CONTROL-PRIMARY.
  2974         16  CS-COMPANY-CD                 PIC X.
  2975         16  CS-CARRIER                    PIC X.
  2976         16  CS-GROUPING                   PIC X(6).
  2977         16  CS-STATE                      PIC XX.
  2978         16  CS-ACCOUNT                    PIC X(10).
  2979         16  CS-CERT-EFF-DT                PIC XX.
  2980         16  CS-CERT-NO.
  2981             20  CS-CERT-PRIME             PIC X(10).
  2982             20  CS-CERT-SFX               PIC X.
  2983         16  CS-TRAILER-TYPE               PIC X.
  2984             88  COMM-TRLR           VALUE 'A'.
  2985             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  2986             88  CERT-DATA-TRLR      VALUE 'C'.
  2987
  2988     12  CS-DATA-AREA                      PIC X(516).
  2989
  2990     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  2991         16  CS-BANK-COMMISSION-AREA.
  2992             20  CS-BANK-COMMS       OCCURS 10.
  2993                 24  CS-AGT                PIC X(10).
  2994                 24  CS-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  57
* EL050.cbl
  2995                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  2996                 24  CS-RECALC-LV-INDIC    PIC X.
  2997                 24  FILLER                PIC X(10).
  2998         16  FILLER                        PIC X(256).
  2999
  3000     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3001****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3002         16  CS-MB-CLAIM-DATA OCCURS 24.
  3003             20  CS-CLAIM-NO               PIC X(7).
  3004             20  CS-CLAIM-TYPE             PIC X.
  3005                 88  CS-AH-CLM               VALUE 'A'.
  3006                 88  CS-IU-CLM               VALUE 'I'.
  3007                 88  CS-GP-CLM               VALUE 'G'.
  3008                 88  CS-LF-CLM               VALUE 'L'.
  3009                 88  CS-PR-CLM               VALUE 'P'.
  3010                 88  CS-FL-CLM               VALUE 'F'.
  3011             20  CS-INSURED-TYPE           PIC X.
  3012                 88  CS-PRIM-INSURED          VALUE 'P'.
  3013                 88  CS-CO-BORROWER           VALUE 'C'.
  3014             20  CS-BENEFIT-PERIOD         PIC 99.
  3015             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  3016             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  3017             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  3018         16  FILLER                        PIC X(12).
  3019     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3020         16  CS-VIN-NUMBER                 PIC X(17).
  3021         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3022         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3023         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3024         16  cs-agent-name.
  3025             20  cs-agent-fname            pic x(20).
  3026             20  cs-agent-mi               pic x.
  3027             20  cs-agent-lname            pic x(25).
  3028         16  cs-license-no                 pic x(15).
  3029         16  cs-npn-number                 pic x(10).
  3030         16  cs-agent-edit-status          pic x.
  3031             88  cs-ae-refer-to-manager      value 'M'.
  3032             88  cs-ae-cover-sheet           value 'C'.
  3033             88  cs-ae-sig-form              value 'S'.
  3034             88  cs-ae-verified              value 'V'.
  3035             88  cs-unidentified-signature   value 'U'.
  3036             88  cs-cert-returned            value 'R'.
  3037             88  cs-accept-no-commission     value 'N'.
  3038         16  FILLER                        PIC X(424).
  3039*        16  FILLER                        PIC X(496).
  3040*    COPY ELCCRTO.
  3041******************************************************************
  3042*                                                                *
  3043*                            ELCCRTO.                            *
  3044*                                                                *
  3045*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  3046*                                                                *
  3047*   FILE TYPE = VSAM,KSDS                                        *
  3048*   RECORD SIZE = 524  RECFORM = FIXED                           *
  3049*                                                                *
  3050*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  3051*                                                                *
  3052*   LOG = YES                                                    *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  58
* EL050.cbl
  3053*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3054******************************************************************
  3055*                   C H A N G E   L O G
  3056*
  3057* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3058*-----------------------------------------------------------------
  3059*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3060* EFFECTIVE    NUMBER
  3061*-----------------------------------------------------------------
  3062* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  3063* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  3064* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  3065* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3066* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  3067******************************************************************
  3068 01  ORIGINAL-CERTIFICATE.
  3069     12  OC-RECORD-ID                      PIC XX.
  3070         88  VALID-OC-ID                      VALUE 'OC'.
  3071     12  OC-CONTROL-PRIMARY.
  3072         16  OC-COMPANY-CD                 PIC X.
  3073         16  OC-CARRIER                    PIC X.
  3074         16  OC-GROUPING                   PIC X(6).
  3075         16  OC-STATE                      PIC XX.
  3076         16  OC-ACCOUNT                    PIC X(10).
  3077         16  OC-CERT-EFF-DT                PIC XX.
  3078         16  OC-CERT-NO.
  3079             20  OC-CERT-PRIME             PIC X(10).
  3080             20  OC-CERT-SFX               PIC X.
  3081         16  OC-RECORD-TYPE                PIC X.
  3082         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  3083     12  OC-LAST-MAINT-DT                  PIC XX.
  3084     12  OC-LAST-MAINT-BY                  PIC X(4).
  3085     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  3086     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  3087     12  FILLER                            PIC X(49).
  3088     12  OC-ORIG-REC.
  3089         16  OC-INS-LAST-NAME              PIC X(15).
  3090         16  OC-INS-FIRST-NAME             PIC X(10).
  3091         16  OC-INS-MIDDLE-INIT            PIC X.
  3092         16  OC-INS-AGE                    PIC S999     COMP-3.
  3093         16  OC-JNT-LAST-NAME              PIC X(15).
  3094         16  OC-JNT-FIRST-NAME             PIC X(10).
  3095         16  OC-JNT-MIDDLE-INIT            PIC X.
  3096         16  OC-JNT-AGE                    PIC S999     COMP-3.
  3097         16  OC-LF-BENCD                   PIC XX.
  3098         16  OC-LF-TERM                    PIC S999      COMP-3.
  3099         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  3100         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3101         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  3102         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  3103         16  OC-LF-EXP-DT                  PIC XX.
  3104         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  3105         16  OC-LF-CANCEL-DT               PIC XX.
  3106         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3107         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3108         16  OC-AH-BENCD                   PIC XX.
  3109         16  OC-AH-TERM                    PIC S999      COMP-3.
  3110         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  59
* EL050.cbl
  3111         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  3112         16  OC-AH-EXP-DT                  PIC XX.
  3113         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3114         16  OC-AH-CP                      PIC 99.
  3115         16  OC-AH-CANCEL-DT               PIC XX.
  3116         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  3117         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3118         16  OC-CRED-BENE-NAME             PIC X(25).
  3119         16  OC-1ST-PMT-DT                 PIC XX.
  3120         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  3121         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  3122         16  OC-ISSUE-TRAN-IND             PIC X.
  3123         16  OC-CANCEL-TRAN-IND            PIC X.
  3124         16  FILLER                        PIC X(211).
  3125
  3126     12  FILLER                            PIC X(50).
  3127******************************************************************
  3128
  3129*    COPY ELCDATE.
  3130******************************************************************
  3131*                                                                *
  3132*                                                                *
  3133*                            ELCDATE.                            *
  3134*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3135*                            VMOD=2.003
  3136*                                                                *
  3137*                                                                *
  3138*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3139*                 LENGTH = 200                                   *
  3140******************************************************************
  3141
  3142 01  DATE-CONVERSION-DATA.
  3143     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3144     12  DC-OPTION-CODE                PIC X.
  3145         88  BIN-TO-GREG                VALUE ' '.
  3146         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3147         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3148         88  YMD-GREG-TO-BIN            VALUE '3'.
  3149         88  MDY-GREG-TO-BIN            VALUE '4'.
  3150         88  JULIAN-TO-BIN              VALUE '5'.
  3151         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3152         88  FIND-CENTURY               VALUE '7'.
  3153         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3154         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3155         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3156         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3157         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3158         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3159         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3160         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3161         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3162         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3163         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3164         88  BIN-3-TO-GREG              VALUE 'I'.
  3165         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3166         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3167         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3168         88  MDCY-GREG-TO-BIN           VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  60
* EL050.cbl
  3169         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3170         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3171         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3172         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3173         88  THREE-CHARACTER-BIN
  3174                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3175         88  GREGORIAN-TO-BIN
  3176                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3177         88  BIN-TO-GREGORIAN
  3178                  VALUES ' ' '1' 'I' '8' 'G'.
  3179         88  JULIAN-TO-BINARY
  3180                  VALUES '5' 'C' 'E' 'F'.
  3181     12  DC-ERROR-CODE                 PIC X.
  3182         88  NO-CONVERSION-ERROR        VALUE ' '.
  3183         88  DATE-CONVERSION-ERROR
  3184                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3185         88  DATE-IS-ZERO               VALUE '1'.
  3186         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  3187         88  DATE-IS-INVALID            VALUE '3'.
  3188         88  DATE1-GREATER-DATE2        VALUE '4'.
  3189         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3190         88  DATE-INVALID-OPTION        VALUE '9'.
  3191         88  INVALID-CENTURY            VALUE 'A'.
  3192         88  ONLY-CENTURY               VALUE 'B'.
  3193         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3194         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3195     12  DC-END-OF-MONTH               PIC X.
  3196         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3197     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3198         88  USE-NORMAL-PROCESS         VALUE ' '.
  3199         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3200         88  ADJUST-UP-100-YRS          VALUE '2'.
  3201     12  FILLER                        PIC X.
  3202     12  DC-CONVERSION-DATES.
  3203         16  DC-BIN-DATE-1             PIC XX.
  3204         16  DC-BIN-DATE-2             PIC XX.
  3205         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3206         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3207                       DC-GREG-DATE-1-EDIT.
  3208             20  DC-EDIT1-MONTH        PIC 99.
  3209             20  SLASH1-1              PIC X.
  3210             20  DC-EDIT1-DAY          PIC 99.
  3211             20  SLASH1-2              PIC X.
  3212             20  DC-EDIT1-YEAR         PIC 99.
  3213         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3214         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3215                     DC-GREG-DATE-2-EDIT.
  3216             20  DC-EDIT2-MONTH        PIC 99.
  3217             20  SLASH2-1              PIC X.
  3218             20  DC-EDIT2-DAY          PIC 99.
  3219             20  SLASH2-2              PIC X.
  3220             20  DC-EDIT2-YEAR         PIC 99.
  3221         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3222         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3223                     DC-GREG-DATE-1-YMD.
  3224             20  DC-YMD-YEAR           PIC 99.
  3225             20  DC-YMD-MONTH          PIC 99.
  3226             20  DC-YMD-DAY            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  61
* EL050.cbl
  3227         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3228         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3229                      DC-GREG-DATE-1-MDY.
  3230             20  DC-MDY-MONTH          PIC 99.
  3231             20  DC-MDY-DAY            PIC 99.
  3232             20  DC-MDY-YEAR           PIC 99.
  3233         16  DC-GREG-DATE-1-ALPHA.
  3234             20  DC-ALPHA-MONTH        PIC X(10).
  3235             20  DC-ALPHA-DAY          PIC 99.
  3236             20  FILLER                PIC XX.
  3237             20  DC-ALPHA-CENTURY.
  3238                 24 DC-ALPHA-CEN-N     PIC 99.
  3239             20  DC-ALPHA-YEAR         PIC 99.
  3240         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3241         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3242         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3243         16  DC-JULIAN-DATE            PIC 9(05).
  3244         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3245                                       PIC 9(05).
  3246         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3247             20  DC-JULIAN-YEAR        PIC 99.
  3248             20  DC-JULIAN-DAYS        PIC 999.
  3249         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3250         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3251         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3252     12  DATE-CONVERSION-VARIBLES.
  3253         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3254         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3255             20  FILLER                PIC 9(3).
  3256             20  HOLD-CEN-1-CCYY.
  3257                 24  HOLD-CEN-1-CC     PIC 99.
  3258                 24  HOLD-CEN-1-YY     PIC 99.
  3259             20  HOLD-CEN-1-MO         PIC 99.
  3260             20  HOLD-CEN-1-DA         PIC 99.
  3261         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3262             20  HOLD-CEN-1-R-MO       PIC 99.
  3263             20  HOLD-CEN-1-R-DA       PIC 99.
  3264             20  HOLD-CEN-1-R-CCYY.
  3265                 24  HOLD-CEN-1-R-CC   PIC 99.
  3266                 24  HOLD-CEN-1-R-YY   PIC 99.
  3267             20  FILLER                PIC 9(3).
  3268         16  HOLD-CENTURY-1-X.
  3269             20  FILLER                PIC X(3)  VALUE SPACES.
  3270             20  HOLD-CEN-1-X-CCYY.
  3271                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3272                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3273             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3274             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3275         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3276             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3277             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3278             20  HOLD-CEN-1-R-X-CCYY.
  3279                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3280                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3281             20  FILLER                PIC XXX.
  3282         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3283         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3284         16  DC-JULIAN-DATE-1          PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  62
* EL050.cbl
  3285         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3286             20  DC-JULIAN-1-CCYY.
  3287                 24  DC-JULIAN-1-CC    PIC 99.
  3288                 24  DC-JULIAN-1-YR    PIC 99.
  3289             20  DC-JULIAN-DA-1        PIC 999.
  3290         16  DC-JULIAN-DATE-2          PIC 9(07).
  3291         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3292             20  DC-JULIAN-2-CCYY.
  3293                 24  DC-JULIAN-2-CC    PIC 99.
  3294                 24  DC-JULIAN-2-YR    PIC 99.
  3295             20  DC-JULIAN-DA-2        PIC 999.
  3296         16  DC-GREG-DATE-A-EDIT.
  3297             20  DC-EDITA-MONTH        PIC 99.
  3298             20  SLASHA-1              PIC X VALUE '/'.
  3299             20  DC-EDITA-DAY          PIC 99.
  3300             20  SLASHA-2              PIC X VALUE '/'.
  3301             20  DC-EDITA-CCYY.
  3302                 24  DC-EDITA-CENT     PIC 99.
  3303                 24  DC-EDITA-YEAR     PIC 99.
  3304         16  DC-GREG-DATE-B-EDIT.
  3305             20  DC-EDITB-MONTH        PIC 99.
  3306             20  SLASHB-1              PIC X VALUE '/'.
  3307             20  DC-EDITB-DAY          PIC 99.
  3308             20  SLASHB-2              PIC X VALUE '/'.
  3309             20  DC-EDITB-CCYY.
  3310                 24  DC-EDITB-CENT     PIC 99.
  3311                 24  DC-EDITB-YEAR     PIC 99.
  3312         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3313         16  DC-GREG-DATE-CYMD-R REDEFINES
  3314                              DC-GREG-DATE-CYMD.
  3315             20  DC-CYMD-CEN           PIC 99.
  3316             20  DC-CYMD-YEAR          PIC 99.
  3317             20  DC-CYMD-MONTH         PIC 99.
  3318             20  DC-CYMD-DAY           PIC 99.
  3319         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3320         16  DC-GREG-DATE-MDCY-R REDEFINES
  3321                              DC-GREG-DATE-MDCY.
  3322             20  DC-MDCY-MONTH         PIC 99.
  3323             20  DC-MDCY-DAY           PIC 99.
  3324             20  DC-MDCY-CEN           PIC 99.
  3325             20  DC-MDCY-YEAR          PIC 99.
  3326    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3327        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3328    12  DC-EL310-DATE                  PIC X(21).
  3329    12  FILLER                         PIC X(28).
  3330
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  63
* EL050.cbl
  3332*    COPY ELCCALC.
  3333******************************************************************
  3334*                                                                *
  3335*                           ELCCALC.                            *
  3336*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3337*                            VMOD=2.025                          *
  3338*                                                                *
  3339*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3340*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3341*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3342*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3343*                                                                *
  3344*  PASSED TO ELRTRM                                              *
  3345*  -----------------                                             *
  3346*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3347*  ORIGINAL TERM                                                 *
  3348*  BEGINNING DATE                                                *
  3349*  ENDING DATE                                                   *
  3350*  COMPANY I.D.                                                  *
  3351*  ACCOUNT MASTER USER FIELD                                     *
  3352*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3353*  FREE LOOK DAYS                                                *
  3354*                                                                *
  3355*  RETURNED FROM ELRTRM                                          *
  3356*  ---------------------                                         *
  3357*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3358*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3359*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3360*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3361*----------------------------------------------------------------*
  3362*  PASSED TO ELRAMT                                              *
  3363*  ----------------                                              *
  3364*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3365*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3366*  ORIGINAL AMOUNT                                               *
  3367*  ALTERNATE BENEFIT (BALLON)                                    *
  3368*  A.P.R. - NET PAY ONLY                                         *
  3369*  METHOD
  3370*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3371*  COMPANY I.D.                                                  *
  3372*  BENEFIT TYPE                                                  *
  3373*                                                                *
  3374*  RETURNED FROM ELRAMT                                          *
  3375*  --------------------                                          *
  3376*  REMAINING AMOUNT 1 - CURRENT                                  *
  3377*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3378*  REMAINING AMOUNT FACTOR
  3379*----------------------------------------------------------------*
  3380*  PASSED TO ELRESV                                              *
  3381*  -----------------                                             *
  3382*  CERTIFICATE EFFECTIVE DATE                                    *
  3383*  VALUATION DATE                                                *
  3384*  PAID THRU DATE                                                *
  3385*  BENEFIT                                                       *
  3386*  INCURRED DATE                                                 *
  3387*  REPORTED DATE                                                 *
  3388*  ISSUE AGE                                                     *
  3389*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  64
* EL050.cbl
  3390*  CDT PERCENT                                                   *
  3391*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3392* *CLAIM TYPE (LIFE, A/H)                                        *
  3393* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3394* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3395*                                                                *
  3396*  RETURNED FROM ELRESV                                          *
  3397*  --------------------                                          *
  3398*  CDT TABLE USED                                                *
  3399*  CDT FACTOR USED                                               *
  3400*  PAY TO CURRENT RESERVE                                        *
  3401*  I.B.N.R. - A/H ONLY                                           *
  3402*  FUTURE (ACCRUED) AH ONLY                                      *
  3403*----------------------------------------------------------------*
  3404*  PASSED TO ELRATE                                              *
  3405*  ----------------                                              *
  3406*  CERT ISSUE DATE                                               *
  3407*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3408*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3409*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3410*  STATE CODE (CLIENT DEFINED)                                   *
  3411*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3412*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3413*  DEVIATION CODE                                                *
  3414*  ISSUE AGE                                                     *
  3415*  ORIGINAL BENEFIT AMOUNT                                       *
  3416*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3417*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3418*  BENEFIT KIND (LIFE OR A/H)                                    *
  3419*  A.P.R.                                                        *
  3420*  METHOD
  3421*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3422*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3423*  COMPANY I.D. (3 CHARACTER)                                    *
  3424*  BENEFIT CODE                                                  *
  3425*  BENEFIT OVERRIDE CODE                                         *
  3426*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3427*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3428*  JOINT INDICATOR (CSL ONLY)                                    *
  3429*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3430*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3431*                                                                *
  3432*  RETURNED FROM ELRATE                                          *
  3433*  --------------------                                          *
  3434*  CALCULATED PREMIUM                                            *
  3435*  PREMIUM RATE                                                  *
  3436*  MORTALITY CODE                                                *
  3437*  MAX ATTAINED AGE                                              *
  3438*  MAX AGE                                                       *
  3439*  MAX TERM                                                      *
  3440*  MAX MONTHLY BENEFIT                                           *
  3441*  MAX TOTAL BENIFIT                                             *
  3442*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3443*----------------------------------------------------------------*
  3444*  PASSED TO ELRFND                                              *
  3445*  ----------------                                              *
  3446*  CERT ISSUE DATE                                               *
  3447*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  65
* EL050.cbl
  3448*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3449*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3450*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3451*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3452*  STATE CODE (CLIENT DEFINED)                                   *
  3453*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3454*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3455*  DEVIATION CODE                                                *
  3456*  ISSUE AGE                                                     *
  3457*  ORIGINAL BENEFIT AMOUNT                                       *
  3458*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3459*  PROCESS TYPE (CANCEL)                                         *
  3460*  BENEFIT KIND (LIFE OR A/H)                                    *
  3461*  A.P.R.                                                        *
  3462*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3463*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3464*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3465*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3466*  COMPANY I.D. (3 CHARACTER)                                    *
  3467*  BENEFIT CODE                                                  *
  3468*  BENEFIT OVERRIDE CODE                                         *
  3469*                                                                *
  3470*  RETURNED FROM ELRFND                                          *
  3471*  --------------------                                          *
  3472*  CALCULATED REFUND                                             *
  3473*----------------------------------------------------------------*
  3474*  PASSED TO ELEARN                                              *
  3475*  ----------------                                              *
  3476*  CERT ISSUE DATE                                               *
  3477*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3478*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3479*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3480*  STATE CODE (CLIENT DEFINED)                                   *
  3481*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3482*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3483*  DEVIATION CODE                                                *
  3484*  ISSUE AGE                                                     *
  3485*  ORIGINAL BENEFIT AMOUNT                                       *
  3486*  BENEFIT KIND (LIFE OR A/H)                                    *
  3487*  A.P.R.                                                        *
  3488*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3489*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3490*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3491*  COMPANY I.D. (3 CHARACTER)                                    *
  3492*  BENEFIT CODE                                                  *
  3493*  BENEFIT OVERRIDE CODE                                         *
  3494*                                                                *
  3495*  RETURNED FROM ELEARN                                          *
  3496*  --------------------                                          *
  3497*  INDICATED  EARNINGS                                           *
  3498*----------------------------------------------------------------*
  3499*                 LENGTH = 450                                   *
  3500*                                                                *
  3501******************************************************************
  3502******************************************************************
  3503*                   C H A N G E   L O G
  3504*
  3505* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  66
* EL050.cbl
  3506*-----------------------------------------------------------------
  3507*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3508* EFFECTIVE    NUMBER
  3509*-----------------------------------------------------------------
  3510* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3511* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3512* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3513* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3514* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3515* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3516* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3517* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3518* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3519* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  3520******************************************************************
  3521
  3522 01  CALCULATION-PASS-AREA.
  3523     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3524                                     COMP.
  3525
  3526     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3527       88  NO-CP-ERROR                             VALUE ZERO.
  3528       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3529                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3530       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3531       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3532       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3533       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3534       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3535       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3536       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3537       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3538       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3539       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3540       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3541       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3542       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3543       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3544       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3545       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3546       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3547
  3548     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3549       88  NO-CP-ERROR-2                           VALUE ZERO.
  3550***********************  INPUT AREAS ****************************
  3551
  3552     12  CP-CALCULATION-AREA.
  3553         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3554         16  CP-CERT-EFF-DT        PIC XX.
  3555         16  CP-VALUATION-DT       PIC XX.
  3556         16  CP-PAID-THRU-DT       PIC XX.
  3557         16  CP-BENEFIT-TYPE       PIC X.
  3558           88  CP-AH                               VALUE 'A' 'D'
  3559                                                   'I' 'U'.
  3560           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3561           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3562         16  CP-INCURRED-DT        PIC XX.
  3563         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  67
* EL050.cbl
  3564         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3565         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3566         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3567                                     COMP-3.
  3568         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3569                                     COMP-3.
  3570         16  CP-CDT-METHOD         PIC X.
  3571           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3572           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3573           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3574         16  CP-CLAIM-TYPE         PIC X.
  3575           88  CP-AH-CLAIM                         VALUE 'A'.
  3576           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3577         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  3578                                     COMP-3.
  3579         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3580                                     COMP-3.
  3581         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3582                                     COMP-3.
  3583         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3584                                     COMP-3.
  3585         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3586                                     COMP-3.
  3587         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3588                                     COMP-3.
  3589         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3590                                     COMP-3.
  3591         16  CP-REM-TERM-METHOD    PIC X.
  3592           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3593           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3594           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3595           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3596           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3597           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3598           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3599         16  CP-EARNING-METHOD     PIC X.
  3600           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3601           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3602           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3603           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3604           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3605           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3606           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3607           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3608           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3609           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3610           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3611           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3612           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3613           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3614         16  CP-PROCESS-TYPE       PIC X.
  3615           88  CP-CLAIM                            VALUE '1'.
  3616           88  CP-CANCEL                           VALUE '2'.
  3617           88  CP-ISSUE                            VALUE '3'.
  3618         16  CP-SPECIAL-CALC-CD    PIC X.
  3619           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3620           88  CP-1-MTH-INTEREST               VALUE ' '.
  3621           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  68
* EL050.cbl
  3622           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3623           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3624           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3625           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3626           88  CP-FARM-PLAN                    VALUE 'F'.
  3627           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3628           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3629           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3630           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3631           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3632           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3633           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3634           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3635           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  3636           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3637                                                     'W' 'X'.
  3638           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3639           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3640           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3641           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3642           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3643           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3644           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3645           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3646           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3647           88  CP-CSL-METH-1                   VALUE '5'.
  3648           88  CP-CSL-METH-2                   VALUE '6'.
  3649           88  CP-CSL-METH-3                   VALUE '7'.
  3650           88  CP-CSL-METH-4                   VALUE '8'.
  3651
  3652         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3653                                     COMP-3.
  3654         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3655         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3656         16  CP-STATE              PIC XX          VALUE SPACE.
  3657         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3658         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3659           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3660               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3661         16  CP-R78-OPTION         PIC X.
  3662           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3663           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3664
  3665         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3666         16  CP-IBNR-RESERVE-SW    PIC X.
  3667         16  CP-CLAIM-STATUS       PIC X.
  3668         16  CP-RATE-FILE          PIC X.
  3669         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3670                                     COMP-3.
  3671
  3672         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3673         16  CP-AH-OVERRIDE-CODE   PIC X.
  3674
  3675         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3676                                     COMP-3.
  3677         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3678                                   PIC S9(5)V99 COMP-3.
  3679         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  69
* EL050.cbl
  3680                                     COMP-3.
  3681         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3682                                     COMP-3.
  3683         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3684                                     COMP-3.
  3685         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3686                                  PIC S9(7)V99 COMP-3.
  3687
  3688         16  CP-PAID-FROM-DATE     PIC X(02).
  3689         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3690         16  CP-EXT-DAYS-CALC      PIC X.
  3691           88  CP-EXT-NO-CHG                   VALUE ' '.
  3692           88  CP-EXT-CHG-LF                   VALUE '1'.
  3693           88  CP-EXT-CHG-AH                   VALUE '2'.
  3694           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3695         16  CP-DOMICILE-STATE     PIC XX.
  3696         16  CP-CARRIER            PIC X.
  3697         16  CP-REIN-FLAG          PIC X.
  3698         16  CP-REM-TRM-CALC-OPTION PIC X.
  3699           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3700                      '2' '3' '4' '5'.
  3701           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3702           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3703           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3704           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3705           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3706           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3707           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3708           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3709         16  CP-SIG-SWITCH         PIC X.
  3710         16  CP-RATING-METHOD      PIC X.
  3711           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3712           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3713           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3714           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3715           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3716           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3717           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3718           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3719           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3720         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3721                                     COMP-3.
  3722         16  CP-BEN-CATEGORY       PIC X.
  3723         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3724         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3725                                   PIC S99V9(5) COMP-3.
  3726         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3727         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3728                                   PIC S99V9(5) COMP-3.
  3729         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3730         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3731         16  CP-EXPIRE-DT          PIC XX.
  3732         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3733         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3734         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3735         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3736         16  CP-DDF-SPEC-CALC      PIC X.
  3737             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  70
* EL050.cbl
  3738             88  CP-CALC-CLP              VALUE 'C'.
  3739         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3740         16  CP-CANCEL-REASON      PIC X.
  3741         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3742         16  CP-PMT-MODE           PIC X.
  3743         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3744         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3745         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3746         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3747         16  FILLER                PIC X.
  3748
  3749***************    OUTPUT FROM ELRESV   ************************
  3750
  3751         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  3752
  3753         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3754                                     COMP-3.
  3755         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3756                                     COMP-3.
  3757         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3758                                     COMP-3.
  3759         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3760                                     COMP-3.
  3761         16  FILLER                PIC X(09).
  3762***************    OUTPUT FROM ELRTRM   *************************
  3763
  3764         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3765                                     COMP-3.
  3766         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3767                                     COMP-3.
  3768         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3769                                     COMP-3.
  3770         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3771                                     COMP-3.
  3772         16  FILLER                PIC X(12).
  3773
  3774***************    OUTPUT FROM ELRAMT   *************************
  3775
  3776         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3777                                     COMP-3.
  3778         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3779                                     COMP-3.
  3780         16  FILLER                PIC X(12).
  3781
  3782***************    OUTPUT FROM ELRATE   *************************
  3783
  3784         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3785                                     COMP-3.
  3786         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3787                                     COMP-3.
  3788         16  CP-MORTALITY-CODE     PIC X(4).
  3789         16  CP-RATE-EDIT-FLAG     PIC X.
  3790             88  CP-RATES-NEED-APR                  VALUE '1'.
  3791         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3792                                     COMP-3.
  3793         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3794         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3795         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  71
* EL050.cbl
  3796                                   PIC S9(7)V99 COMP-3.
  3797         16  FILLER                PIC X(07).
  3798
  3799***************    OUTPUT FROM ELRFND   *************************
  3800
  3801         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3802                                     COMP-3.
  3803         16  CP-REFUND-TYPE-USED   PIC X.
  3804           88  CP-R-AS-R78                         VALUE '1'.
  3805           88  CP-R-AS-PRORATA                     VALUE '2'.
  3806           88  CP-R-AS-CALIF                       VALUE '3'.
  3807           88  CP-R-AS-TEXAS                       VALUE '4'.
  3808           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3809           88  CP-R-AS-NET-PAY                     VALUE '5'.
  3810           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3811           88  CP-R-AS-MEAN                        VALUE '8'.
  3812           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3813           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3814           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3815           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3816           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3817           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3818         16  FILLER                PIC X(12).
  3819
  3820***************    OUTPUT FROM ELEARN   *************************
  3821
  3822         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3823                                     COMP-3.
  3824         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3825                                     COMP-3.
  3826         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3827                                     COMP-3.
  3828         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3829                                     COMP-3.
  3830         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3831                                     COMP-3.
  3832         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3833                                     COMP-3.
  3834         16  CP-EARNING-TYPE-USED  PIC X.
  3835           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3836           88  CP-E-AS-R78                         VALUE '1'.
  3837           88  CP-E-AS-PRORATA                     VALUE '2'.
  3838           88  CP-E-AS-TEXAS                       VALUE '4'.
  3839           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3840           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3841           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3842           88  CP-E-AS-MEAN                        VALUE '8'.
  3843           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3844         16  FILLER                PIC X(12).
  3845
  3846***************    OUTPUT FROM ELPMNT   *************************
  3847
  3848         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3849                                     COMP-3.
  3850         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3851                                     COMP-3.
  3852         16  FILLER                PIC X(12).
  3853
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  72
* EL050.cbl
  3854***************   MISC WORK AREAS    *****************************
  3855         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3856                                     COMP-3.
  3857         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3858                                     COMP-3.
  3859         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3860                                     COMP-3.
  3861         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3862                                     COMP-3.
  3863         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3864                                     COMP-3.
  3865         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3866                                     COMP-3.
  3867         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  3868             88  OPEN-RATE-FILE                   VALUE 'O'.
  3869             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3870             88  IO-ERROR                         VALUE 'E'.
  3871
  3872         16  CP-FIRST-PAY-DATE     PIC XX.
  3873
  3874         16  CP-JOINT-INDICATOR    PIC X.
  3875
  3876         16  CP-RESERVE-REMAINING-TERM
  3877                                   PIC S9(4)V9    VALUE ZERO
  3878                                     COMP-3.
  3879
  3880         16  CP-INSURED-BIRTH-DT   PIC XX.
  3881
  3882         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3883                                     COMP-3.
  3884
  3885         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3886                                     COMP-3.
  3887
  3888         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3889                                     COMP-3.
  3890
  3891         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3892                                     COMP-3.
  3893
  3894         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3895                                     COMP-3.
  3896
  3897         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3898                                     COMP-3.
  3899
  3900         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3901                                     COMP-3.
  3902
  3903         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3904             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3905
  3906         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3907                                     COMP-3.
  3908         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3909                                     COMP-3.
  3910         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3911         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  73
* EL050.cbl
  3912         16  cp-net-only-state     pic x value spaces.
  3913         16  FILLER                PIC X(13).
  3914******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  74
* EL050.cbl
  3916******************************************************************
  3917*** THE FOLLOWING AREA IS RESERVED FOR THE INFORMATION PASSED  ***
  3918*** FROM PROGRAM TO PROGRAM DURING THE EDITING PROCESS.  IF    ***
  3919*** ANY FIELD IS MODIFIED OR THE AREA IS EXTENDED, ALL PROGRAMS***
  3920*** CALLING EL050 MUST BE MODIFIED IDENTICALLY TO REFLECT THIS ***
  3921*** MODIFICATION.                                              ***
  3922*** ONCE COMPILED, THIS AREA IS CONSIDERED TO BE A 1036 BYTE   ***
  3923*** WORK AREA WITH A LENGTH IDENTICAL TO THE DFHCOMMAREA       ***
  3924******************************************************************
  3925*    COPY ERCPNDB.
  3926******************************************************************
  3927*                                                                *
  3928*                                                                *
  3929*                            ERCPNDB.                            *
  3930*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3931*                            VMOD=2.025                          *
  3932*                                                                *
  3933*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3934*                                                                *
  3935******************************************************************
  3936*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3937*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3938******************************************************************
  3939*                                                                *
  3940*                                                                *
  3941*   FILE TYPE = VSAM,KSDS                                        *
  3942*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3943*                                                                *
  3944*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3945*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3946*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3947*                                                 RKP=13,LEN=36  *
  3948*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3949*                                      AND CHG-SEQ.)             *
  3950*                                                RKP=49,LEN=11   *
  3951*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3952*                                      AND CHG-SEQ.)             *
  3953*                                                RKP=60,LEN=15   *
  3954*                                                                *
  3955*   LOG = NO                                                     *
  3956*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3957******************************************************************
  3958******************************************************************
  3959*                   C H A N G E   L O G
  3960*
  3961* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3962*-----------------------------------------------------------------
  3963*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3964* EFFECTIVE    NUMBER
  3965*-----------------------------------------------------------------
  3966* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3967* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3968* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3969* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3970* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3971* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3972* 032306                   PEMA  ADD BOW LOAN NUMBER
  3973* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  75
* EL050.cbl
  3974* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3975* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3976* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3977* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3978* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3979* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3980* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3981* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3982******************************************************************
  3983
  3984 01  PENDING-BUSINESS.
  3985     12  PB-RECORD-ID                     PIC XX.
  3986         88  VALID-PB-ID                        VALUE 'PB'.
  3987
  3988     12  PB-CONTROL-PRIMARY.
  3989         16  PB-COMPANY-CD                PIC X.
  3990         16  PB-ENTRY-BATCH               PIC X(6).
  3991         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3992         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3993
  3994     12  PB-CONTROL-BY-ACCOUNT.
  3995         16  PB-COMPANY-CD-A1             PIC X.
  3996         16  PB-CARRIER                   PIC X.
  3997         16  PB-GROUPING.
  3998             20  PB-GROUPING-PREFIX       PIC XXX.
  3999             20  PB-GROUPING-PRIME        PIC XXX.
  4000         16  PB-STATE                     PIC XX.
  4001         16  PB-ACCOUNT.
  4002             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4003             20  PB-ACCOUNT-PRIME         PIC X(6).
  4004         16  PB-CERT-EFF-DT               PIC XX.
  4005         16  PB-CERT-NO.
  4006             20  PB-CERT-PRIME            PIC X(10).
  4007             20  PB-CERT-SFX              PIC X.
  4008         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4009
  4010         16  PB-RECORD-TYPE               PIC X.
  4011             88  PB-MAILING-DATA                VALUE '0'.
  4012             88  PB-ISSUE                       VALUE '1'.
  4013             88  PB-CANCELLATION                VALUE '2'.
  4014             88  PB-BATCH-TRAILER               VALUE '9'.
  4015
  4016     12  PB-CONTROL-BY-ORIG-BATCH.
  4017         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4018         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4019         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4020         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4021
  4022     12  PB-CONTROL-BY-CSR.
  4023         16  PB-CSR-COMPANY-CD            PIC X.
  4024         16  PB-CSR-ID                    PIC X(4).
  4025         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4026         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4027         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4028******************************************************************
  4029*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4030******************************************************************
  4031
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  76
* EL050.cbl
  4032     12  PB-LAST-MAINT-DT                 PIC XX.
  4033     12  PB-LAST-MAINT-BY                 PIC X(4).
  4034     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4035
  4036     12  PB-RECORD-BODY                   PIC X(375).
  4037
  4038     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4039         16  PB-CERT-ORIGIN               PIC X.
  4040             88  CLASIC-CREATED-CERT         VALUE '1'.
  4041         16  PB-I-NAME.
  4042             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4043             20  PB-I-INSURED-FIRST-NAME.
  4044                 24  PB-I-INSURED-1ST-INIT PIC X.
  4045                 24  FILLER                PIC X(9).
  4046             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4047         16  PB-I-AGE                     PIC S99   COMP-3.
  4048         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4049         16  PB-I-BIRTHDAY                PIC XX.
  4050         16  PB-I-INSURED-SEX             PIC X.
  4051             88  PB-SEX-MALE     VALUE 'M'.
  4052             88  PB-SEX-FEMALE   VALUE 'F'.
  4053
  4054         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4055         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4056         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4057         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4058         16  PB-I-SKIP-CODE               PIC X.
  4059             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4060             88  PB-SKIP-JULY              VALUE '1'.
  4061             88  PB-SKIP-AUGUST            VALUE '2'.
  4062             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4063             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4064             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4065             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4066             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4067             88  PB-SKIP-JUNE              VALUE '8'.
  4068             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4069             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4070             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4071         16  PB-I-TERM-TYPE               PIC X.
  4072             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4073             88  PB-PAID-WEEKLY            VALUE 'W'.
  4074             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4075             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4076             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4077         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4078         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4079         16  PB-I-DATA-ENTRY-SW           PIC X.
  4080             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4081             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4082             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4083             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4084         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4085         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4086*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4087         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4088         16  FILLER                       PIC X.
  4089
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  77
* EL050.cbl
  4090         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4091             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4092             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4093                                                   '90' THRU '99'.
  4094         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4095                                          PIC XX.
  4096         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4097         16  PB-I-AMOUNT-FINANCED REDEFINES
  4098                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4099         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4100         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4101                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4102         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4103         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4104         16  PB-I-CLP-AMOUNT REDEFINES
  4105                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4106         16  PB-I-LF-CALC-FLAG            PIC X.
  4107             88 PB-COMP-LF-PREM               VALUE '?'.
  4108         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4109         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4110         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4111         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4112         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4113         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4114         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4115         16  PB-I-LF-ABBR                 PIC XXX.
  4116         16  PB-I-LF-INPUT-CD             PIC XX.
  4117
  4118         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4119             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4120             88  PB-INVALID-AH               VALUE '  ' '00'
  4121                                                   '90' THRU '99'.
  4122         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4123         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4124         16  PB-I-AH-CALC-FLAG            PIC X.
  4125             88 PB-COMP-AH-PREM                  VALUE '?'.
  4126         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4127         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4128         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4129         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4130         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4131         16  PB-I-AH-ABBR                 PIC XXX.
  4132         16  PB-I-AH-INPUT-CD             PIC XXX.
  4133
  4134         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4135         16  PB-I-REIN-TABLE              PIC XXX.
  4136         16  PB-I-BUSINESS-TYPE           PIC 99.
  4137         16  PB-I-INDV-GRP-CD             PIC X.
  4138         16  PB-I-MORT-CODE.
  4139             20  PB-I-TABLE               PIC X.
  4140             20  PB-I-INTEREST            PIC XX.
  4141             20  PB-I-MORT-TYP            PIC X.
  4142         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4143         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4144         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4145         16  PB-I-INDV-GRP-OVRD           PIC X.
  4146         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4147         16  PB-I-SIG-SW                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  78
* EL050.cbl
  4148             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4149         16  PB-I-RATE-CLASS              PIC XX.
  4150         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4151         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4152         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4153         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4154         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4155         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4156         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4157         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4158         16  PB-I-OB-FLAG                 PIC X.
  4159             88  PB-I-OB                      VALUE 'B'.
  4160             88  PB-I-SUMMARY                 VALUE 'Z'.
  4161         16  PB-I-ENTRY-STATUS            PIC X.
  4162             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4163                                              'M' '5' '9' '2'.
  4164             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4165             88  PB-I-POLICY-PENDING          VALUE '2'.
  4166             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4167             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4168             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4169             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4170             88  PB-I-REIN-ONLY               VALUE '9'.
  4171             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4172             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4173             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4174             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4175         16  PB-I-INT-CODE                PIC X.
  4176             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4177             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4178         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4179         16  PB-I-SOC-SEC-NO              PIC X(11).
  4180         16  PB-I-MEMBER-NO               PIC X(12).
  4181         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4182*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4183         16  PB-I-OLD-LOF                 PIC XXX.
  4184         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4185         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4186         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4187         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4188         16  PB-I-LIFE-INDICATOR          PIC X.
  4189             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4190         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4191         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4192                                          PIC S9(5)V99    COMP-3.
  4193         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4194             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4195             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4196         16  PB-I-1ST-PMT-DT              PIC XX.
  4197         16  PB-I-JOINT-INSURED.
  4198             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4199             20 PB-I-JOINT-FIRST-NAME.
  4200                24  PB-I-JOINT-FIRST-INIT PIC X.
  4201                24  FILLER                PIC X(9).
  4202             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4203*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4204         16  PB-I-BENEFICIARY-NAME.
  4205             20  PB-I-BANK-NUMBER         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  79
* EL050.cbl
  4206             20  FILLER                   PIC X(15).
  4207         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4208         16  PB-I-REFERENCE               PIC X(12).
  4209         16  FILLER REDEFINES PB-I-REFERENCE.
  4210             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4211             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4212             20  PB-I-CLP-STATE           PIC XX.
  4213         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4214             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4215             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4216             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4217         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4218         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4219         16  PB-I-RESIDENT-STATE          PIC XX.
  4220         16  PB-I-RATE-CODE               PIC X(4).
  4221         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4222         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4223         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4224         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4225         16  PB-I-BANK-NOCHRGB            PIC 99.
  4226         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4227         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4228
  4229     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4230         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4231             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4232         16  PB-C-CANCEL-ORIGIN           PIC X.
  4233             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4234         16  PB-C-LF-CANCEL-DT            PIC XX.
  4235         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4236         16  PB-C-LF-CALC-REQ             PIC X.
  4237             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4238         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4239         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4240         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4241             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4242         16  PB-C-AH-CANCEL-DT            PIC XX.
  4243         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4244         16  PB-C-AH-CALC-REQ             PIC X.
  4245             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4246         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4247         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4248         16  PB-C-LAST-NAME               PIC X(15).
  4249         16  PB-C-REFUND-SW               PIC X.
  4250             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4251             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4252         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4253         16  PB-C-PAYEE-CODE              PIC X(6).
  4254         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4255         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4256         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4257         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4258         16  PB-C-REFERENCE               PIC X(12).
  4259         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4260         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4261         16  PB-C-POST-CARD-IND           PIC X.
  4262         16  PB-C-CANCEL-REASON           PIC X.
  4263         16  PB-C-REF-INTERFACE-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  80
* EL050.cbl
  4264         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4265         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4266         16  FILLER                       PIC X(01).
  4267*        16  FILLER                       PIC X(18).
  4268         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4269*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4270         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4271         16  PB-CANCELED-CERT-DATA.
  4272             20  PB-CI-INSURED-NAME.
  4273                 24  PB-CI-LAST-NAME      PIC X(15).
  4274                 24  PB-CI-INITIALS       PIC XX.
  4275             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4276             20  PB-CI-INSURED-SEX        PIC X.
  4277             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4278             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4279             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4280             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4281             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4282             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4283             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4284             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4285             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4286             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4287             20  PB-CI-RATE-CLASS         PIC XX.
  4288             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4289             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4290             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4291             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4292             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4293             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4294             20  PB-CI-LF-ABBR            PIC X(3).
  4295             20  PB-CI-AH-ABBR            PIC X(3).
  4296             20  PB-CI-OB-FLAG            PIC X.
  4297                 88  PB-CI-OB                VALUE 'B'.
  4298             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4299                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4300                                           'M' '4' '5' '9' '2'.
  4301                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4302                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4303                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4304                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4305                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4306                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4307                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4308                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4309                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4310                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4311                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4312                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4313                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4314             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4315                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4316                                           'M' '4' '5' '9' '2'.
  4317                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4318                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4319                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4320                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4321                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  81
* EL050.cbl
  4322                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4323                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4324                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4325                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4326                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4327                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4328                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4329                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4330             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4331             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4332             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4333             20  PB-CI-MEMBER-NO          PIC X(12).
  4334             20  PB-CI-INT-CODE           PIC X.
  4335                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4336                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4337             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4338             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4339             20  PB-CI-COMP-EXCP-SW       PIC X.
  4340                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4341                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4342             20  PB-CI-ENTRY-STATUS       PIC X.
  4343             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4344             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4345             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4346             20  PB-CI-DEATH-DT           PIC XX.
  4347             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4348             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4349             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4350             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4351             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4352             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4353             20  PB-CI-ENTRY-DT              PIC XX.
  4354             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4355             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4356             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4357             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4358             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4359             20  PB-CI-OLD-LOF               PIC XXX.
  4360*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4361             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4362             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4363             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4364             20  PB-CI-INDV-GRP-CD           PIC X.
  4365             20  PB-CI-BENEFICIARY-NAME.
  4366                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4367                 24  FILLER                  PIC X(15).
  4368             20  PB-CI-NOTE-SW               PIC X.
  4369             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4370             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4371             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4372             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4373             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4374             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4375             20  PB-CI-FIRST-NAME            PIC X(10).
  4376             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4377
  4378         16  FILLER                       PIC X(13).
  4379*032306  16  FILLER                       PIC X(27).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  82
* EL050.cbl
  4380*        16  FILLER                       PIC X(46).
  4381
  4382     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4383         16  FILLER                       PIC X(10).
  4384         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4385         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4386         16  PB-M-INSURED-MID-INIT        PIC X.
  4387         16  PB-M-INSURED-AGE             PIC 99.
  4388         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4389         16  PB-M-INSURED-SEX             PIC X.
  4390         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4391         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4392         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4393         16  PB-M-INSURED-CITY-STATE.
  4394             20  PB-M-INSURED-CITY        PIC X(28).
  4395             20  PB-M-INSURED-STATE       PIC XX.
  4396         16  PB-M-INSURED-ZIP-CODE.
  4397             20  PB-M-INSURED-ZIP-PRIME.
  4398                 24  PB-M-INSURED-ZIP-1   PIC X.
  4399                     88  PB-M-CANADIAN-POST-CODE
  4400                                             VALUE 'A' THRU 'Z'.
  4401                 24  FILLER               PIC X(4).
  4402             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4403         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4404                                        PB-M-INSURED-ZIP-CODE.
  4405             20  PM-M-INS-CAN-POST1       PIC XXX.
  4406             20  PM-M-INS-CAN-POST2       PIC XXX.
  4407             20  FILLER                   PIC XXX.
  4408         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4409         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4410         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4411         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4412         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4413         16  PB-M-CRED-BENE-CITYST.
  4414             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4415             20  PB-M-CRED-BENE-STATE     PIC XX.
  4416         16  FILLER                       PIC X(92).
  4417
  4418     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4419         16  FILLER                       PIC X(10).
  4420         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4421         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4422         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4423         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4424         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4425         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4426         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4427         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4428         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4429         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4430         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4431         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4432         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4433         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4434         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4435         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4436         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4437         16  PB-ACCOUNT-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  83
* EL050.cbl
  4438         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4439         16  PB-REFERENCE                 PIC X(12).
  4440         16  PB-B-RECEIVED-DT             PIC XX.
  4441         16  FILLER                       PIC X(234).
  4442
  4443     12  PB-RECORD-STATUS.
  4444         16  PB-CREDIT-SELECT-DT          PIC XX.
  4445         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4446         16  PB-BILLED-DT                 PIC XX.
  4447         16  PB-BILLING-STATUS            PIC X.
  4448             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4449             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4450             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4451         16  PB-RECORD-BILL               PIC X.
  4452             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4453             88  PB-RECORD-RETURNED           VALUE 'R'.
  4454             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4455             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4456             88  PB-OVERRIDE-AH               VALUE 'A'.
  4457             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4458         16  PB-BATCH-ENTRY               PIC X.
  4459             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4460             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4461             88  PB-REISSUED-CERT             VALUE 'E'.
  4462             88  PB-CASH-CERT                 VALUE 'C'.
  4463             88  PB-MONTHLY-CERT              VALUE 'M'.
  4464             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4465             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4466             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4467         16  PB-FORCE-CODE                PIC X.
  4468             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4469             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4470             88  PB-CANCEL-FORCE              VALUE '8'.
  4471             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4472             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4473             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4474             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4475             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4476             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4477             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4478         16  PB-FATAL-FLAG                PIC X.
  4479             88  PB-FATAL-ERRORS              VALUE 'X'.
  4480         16  PB-FORCE-ER-CD               PIC X.
  4481             88  PB-FORCE-ERRORS              VALUE 'F'.
  4482             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4483         16  PB-WARN-ER-CD                PIC X.
  4484             88  PB-WARNING-ERRORS            VALUE 'W'.
  4485         16  FILLER                       PIC X.
  4486         16  PB-OUT-BAL-CD                PIC X.
  4487             88  PB-OUT-OF-BAL                VALUE 'O'.
  4488         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4489         16  PB-AH-OVERRIDE-L1            PIC X.
  4490         16  PB-INPUT-DT                  PIC XX.
  4491         16  PB-INPUT-BY                  PIC X(4).
  4492         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4493         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4494         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4495         16  PB-LF-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  84
* EL050.cbl
  4496         16  PB-AH-EARNING-METHOD         PIC X.
  4497         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4498         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4499         16  PB-REIN-CD                   PIC XXX.
  4500         16  PB-LF-REFUND-TYPE            PIC X.
  4501         16  PB-AH-REFUND-TYPE            PIC X.
  4502         16  PB-ACCT-EFF-DT               PIC XX.
  4503         16  PB-ACCT-EXP-DT               PIC XX.
  4504         16  PB-COMPANY-ID                PIC X(3).
  4505         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4506         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4507         16  PB-SV-CARRIER                PIC X.
  4508         16  PB-SV-GROUPING               PIC X(6).
  4509         16  PB-SV-STATE                  PIC XX.
  4510         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4511         16  PB-GA-BILLING-INFO.
  4512             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4513                                          PIC XX.
  4514         16  PB-SV-REMIT-TO  REDEFINES
  4515             PB-GA-BILLING-INFO           PIC X(10).
  4516         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4517         16  PB-I-LOAN-OFFICER            PIC X(5).
  4518         16  PB-I-VIN                     PIC X(17).
  4519
  4520         16  FILLER                       PIC X(04).
  4521         16  IMNET-BYPASS-SW              PIC X.
  4522
  4523******************************************************************
  4524*                COMMON EDIT ERRORS                              *
  4525******************************************************************
  4526
  4527     12  PB-COMMON-ERRORS.
  4528         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4529                                           PIC S9(4)     COMP.
  4530
  4531******************************************************************
  4532
  4533* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  4534*    COPY ELC50W1.
  4535******************************************************************
  4536*                                                                *
  4537*                                                                *
  4538*                             ELC50W1                            *
  4539*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4540*                            VMOD=2.004                          *
  4541*                                                                *
  4542*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  4543*                                                                *
  4544*                                                                *
  4545******************************************************************
  4546
  4547     12  WK-WORK-AREA.
  4548         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  4549         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  4550         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  4551         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  4552         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  4553         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  85
* EL050.cbl
  4554         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  4555         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  4556         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  4557         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  4558         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  4559         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  4560         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  4561         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
  4562         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  4563         16  WK-CREDIT-EDIT-CONTROLS.
  4564             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  4565             20  WK-MIN-AGE           PIC 99  VALUE 00.
  4566             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  4567             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  4568             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  4569             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  4570         16  WK-CANCEL-EXIT-DT        PIC XX VALUE LOW-VALUE.
  4571         16  WK-SAVE-REIN-DATA.
  4572             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  4573             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  4574             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  4575         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  4576             88  ENTRY-FROM-EL6311       VALUE '6'.
  4577         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  4578         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  4579     12  WK-RECORD-ADDRESSES.
  4580         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4581         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  4582         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  4583         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  4584         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  4585         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  4586         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4587         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  4588     12  WK-OVER-SHORT-AREA.
  4589         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  4590         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  4591         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  4592             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  4593         16  FILLER                   PIC X(5) VALUE SPACES.
  4594
  4595*    COPY ELCEDITC.
  4596******************************************************************
  4597*                                                                *
  4598*                                                                *
  4599*                            ELCEDITC                            *
  4600*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4601*                            VMOD=2.012                          *
  4602*                                                                *
  4603*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  4604*                     EL6313, EL050 AND EL517.                   *
  4605*                                                                *
  4606******************************************************************
  4607******************************************************************
  4608*                   C H A N G E   L O G
  4609*
  4610* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4611*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  86
* EL050.cbl
  4612*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4613* EFFECTIVE    NUMBER
  4614*-----------------------------------------------------------------
  4615* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4616******************************************************************
  4617
  4618     12  EDIT-CRITERIA-DATA.
  4619         16  EC-CO-MONTH-END-DT       PIC XX.
  4620         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  4621         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4622         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4623         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4624         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  4625         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  4626         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  4627         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  4628         16  EC-CO-REM-TERM-CALC      PIC X.
  4629               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  4630               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  4631               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  4632               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  4633
  4634         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  4635               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  4636               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  4637               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  4638               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  4639               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  4640               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  4641               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  4642               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  4643               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  4644               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  4645
  4646         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  4647               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  4648               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  4649               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  4650               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  4651               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
  4652               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  4653               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  4654               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  4655
  4656         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  4657                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  4658                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  4659
  4660         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  4661                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  4662                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  4663                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  4664                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  4665                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  4666                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  4667                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  4668                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  4669
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  87
* EL050.cbl
  4670         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  4671               88  EC-BR-REDUCING                   VALUE 'R'.
  4672               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  4673
  4674         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  4675         16  EC-BR-LF-DESC             PIC X(10).
  4676         16  EC-BR-AH-DESC             PIC X(10).
  4677         16  EC-BR-LF-COMMENT          PIC X(10).
  4678         16  EC-BR-AH-COMMENT          PIC X(10).
  4679
  4680         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  4681               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  4682               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  4683               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4684               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  4685
  4686         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  4687               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  4688               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  4689               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4690               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  4691
  4692         16  EC-BR-LF-REFUND-CALC      PIC X.
  4693                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  4694                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4695                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  4696                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  4697                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  4698                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  4699                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4700
  4701         16  EC-BR-AH-REFUND-CALC      PIC X.
  4702                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  4703                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4704                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  4705                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  4706                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  4707                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  4708                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  4709                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4710
  4711         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  4712                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  4713                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  4714                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  4715
  4716         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  4717                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  4718                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  4719                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  4720
  4721         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  4722         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  4723         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  4724         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  4725
  4726         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  4727         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  88
* EL050.cbl
  4728                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  4729                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  4730                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  4731                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  4732
  4733         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  4734               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  4735               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  4736               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  4737               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  4738               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  4739
  4740         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  4741               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  4742               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  4743               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  4744               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  4745               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  4746
  4747         16  EC-ST-LF-REFUND-CALC      PIC X.
  4748                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  4749                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4750                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  4751                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  4752                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  4753                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  4754                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  4755                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4756
  4757         16  EC-ST-AH-REFUND-CALC      PIC X.
  4758                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  4759                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4760                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  4761                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  4762                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  4763                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  4764                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  4765                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4766
  4767         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
  4768         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  4769         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4770         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  4771         16  EC-AM-EXPIRATION-DT       PIC XX.
  4772         16  EC-AM-EFFECTIVE-DT        PIC XX.
  4773         16  EC-AM-CLASS-CD            PIC XX.
  4774         16  EC-AM-LF-DEVIATION        PIC XXX.
  4775         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4776         16  EC-AM-AH-DEVIATION        PIC XXX.
  4777         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  4778         16  EC-AM-PHONE-NO            PIC X(10).
  4779
  4780         16  EC-AM-LF-REFUND-CALC      PIC X.
  4781                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  4782                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  4783                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  4784                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  4785                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  89
* EL050.cbl
  4786                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  4787                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  4788
  4789         16  EC-AM-AH-REFUND-CALC      PIC X.
  4790                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  4791                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  4792                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  4793                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  4794                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  4795                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  4796                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  4797
  4798         16  EC-AM-BEN-I-G-CD          PIC X.
  4799                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  4800                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  4801                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  4802
  4803         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4804         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4805         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4806         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4807         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4808         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4809         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4810         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4811         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4812
  4813         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4814         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  4815         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  4816         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4817         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  4818         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  4819         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  4820         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  4821         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  4822         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  4823         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  4824         16  EC-RT-LF-NSP-ST           PIC XX.
  4825         16  EC-RT-AH-NSP-ST           PIC XX.
  4826         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4827         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  4828
  4829         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  4830             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4831                                             'M' '5' '9' '2'.
  4832             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  4833             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  4834             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  4835             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  4836             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  4837             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  4838             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  4839             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  4840             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  4841             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  4842
  4843         16  EC-CM-AH-PRIOR-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  90
* EL050.cbl
  4844             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  4845                                             'M' '5' '9' '2'.
  4846             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  4847             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  4848             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  4849             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  4850             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  4851             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  4852             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  4853             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  4854             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  4855             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  4856
  4857         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4858         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  4859         16  EC-CM-LF-CANCEL-DT        PIC XX.
  4860         16  EC-CM-AH-CANCEL-DT        PIC XX.
  4861         16  EC-CM-DEATH-DT            PIC XX.
  4862
  4863*DMD CUSTOM CODING FIELDS BELOW
  4864*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  4865         16  EC-BR-DMD-RATING-SW       PIC X.
  4866                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  4867                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  4868                 88  NO-DMD-RATING               VALUE 'N'.
  4869
  4870         16  EC-NEW-CERT               PIC X(11).
  4871         16  EC-NEW-STATE              PIC XX.
  4872         16  FILLER                    PIC X.
  4873*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  4874         16  OVER-SHORT-EDIT-FIELDS.
  4875             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4876             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4877             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  4878             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  4879             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  4880             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4881             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4882             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  4883             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  4884         16  FILLER                    PIC X(71).
  4885******************************************************************
  4886
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  91
* EL050.cbl
  4888*    COPY ELCDIFRD.
  4889******************************************************************
  4890*                                                                *
  4891*                                                                *
  4892*                            ELCDIFRD.                           *
  4893*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4894*                            VMOD=2.004                          *
  4895*                                                                *
  4896*   WORKING STORAGE FOR REFUND DIFFERENCES                       *
  4897*                                                                *
  4898******************************************************************
  4899*
  4900  01  WS-DIFFERENCE-CALCULATION.
  4901        12  WK-REFUND-OVER-PCT     PIC S9V9(4) COMP-3 VALUE +0.
  4902        12  WK-REFUND-OVR-SHT-CALC PIC S999V99 COMP-3 VALUE +0.
  4903        12  WK-REFUND-DIFFERENCE   PIC S999V99 COMP-3 VALUE +0.
  4904        12  WS-PL-REF-OVS-AMT      PIC S999V99 COMP-3 VALUE +0.
  4905        12  WS-PL-REF-OVS-PCT      PIC S9V9(4) COMP-3 VALUE +0.
  4906        12  WS-AH-PL-REF-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4907        12  WS-AH-PL-REF-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4908        12  WS-AH-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4909        12  WS-AH-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4910        12  WS-LF-REFUND-OVS-AMT   PIC S999V99 COMP-3 VALUE +0.
  4911        12  WS-LF-REFUND-OVS-PCT   PIC S9V9(4) COMP-3 VALUE +0.
  4912
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  92
* EL050.cbl
  4914****************************************************************
  4915*
  4916* Copyright (c) 2007 by Clerity Solutions, Inc.
  4917* All rights reserved.
  4918*
  4919****************************************************************
  4920 01  DFHEIV.
  4921   02  DFHEIV0               PIC X(35).
  4922   02  DFHEIV1               PIC X(08).
  4923   02  DFHEIV2               PIC X(08).
  4924   02  DFHEIV3               PIC X(08).
  4925   02  DFHEIV4               PIC X(06).
  4926   02  DFHEIV5               PIC X(04).
  4927   02  DFHEIV6               PIC X(04).
  4928   02  DFHEIV7               PIC X(02).
  4929   02  DFHEIV8               PIC X(02).
  4930   02  DFHEIV9               PIC X(01).
  4931   02  DFHEIV10              PIC S9(7) COMP-3.
  4932   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4933   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4934   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4935   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4936   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4937   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4938   02  DFHEIV17              PIC X(04).
  4939   02  DFHEIV18              PIC X(04).
  4940   02  DFHEIV19              PIC X(04).
  4941   02  DFHEIV20              USAGE IS POINTER.
  4942   02  DFHEIV21              USAGE IS POINTER.
  4943   02  DFHEIV22              USAGE IS POINTER.
  4944   02  DFHEIV23              USAGE IS POINTER.
  4945   02  DFHEIV24              USAGE IS POINTER.
  4946   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4947   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4948   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4949   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4950   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4951   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4952   02  FILLER                PIC X(02).
  4953   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4954   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4955   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4956   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4957   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4958 LINKAGE  SECTION.
  4959*****************************************************************
  4960*                                                               *
  4961* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  4962* All rights reserved.                                          *
  4963*                                                               *
  4964*****************************************************************
  4965 01  dfheiblk.
  4966     02  eibtime          pic s9(7) comp-3.
  4967     02  eibdate          pic s9(7) comp-3.
  4968     02  eibtrnid         pic x(4).
  4969     02  eibtaskn         pic s9(7) comp-3.
  4970     02  eibtrmid         pic x(4).
  4971     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  93
* EL050.cbl
  4972     02  eibcposn         pic s9(4) comp.
  4973     02  eibcalen         pic s9(4) comp.
  4974     02  eibaid           pic x(1).
  4975     02  eibfiller1       pic x(1).
  4976     02  eibfn            pic x(2).
  4977     02  eibfiller2       pic x(2).
  4978     02  eibrcode         pic x(6).
  4979     02  eibfiller3       pic x(2).
  4980     02  eibds            pic x(8).
  4981     02  eibreqid         pic x(8).
  4982     02  eibrsrce         pic x(8).
  4983     02  eibsync          pic x(1).
  4984     02  eibfree          pic x(1).
  4985     02  eibrecv          pic x(1).
  4986     02  eibsend          pic x(1).
  4987     02  eibatt           pic x(1).
  4988     02  eibeoc           pic x(1).
  4989     02  eibfmh           pic x(1).
  4990     02  eibcompl         pic x(1).
  4991     02  eibsig           pic x(1).
  4992     02  eibconf          pic x(1).
  4993     02  eiberr           pic x(1).
  4994     02  eibrldbk         pic x(1).
  4995     02  eiberrcd         pic x(4).
  4996     02  eibsynrb         pic x(1).
  4997     02  eibnodat         pic x(1).
  4998     02  eibfiller5       pic x(2).
  4999     02  eibresp          pic 9(09) comp.
  5000     02  eibresp2         pic 9(09) comp.
  5001     02  dfheigdj         pic s9(4) comp.
  5002     02  dfheigdk         pic s9(4) comp.
  5003
  5004 01  DFHCOMMAREA                   PIC X(1036).
  5005
  5006*01 PARMLIST .
  5007*    02  FILLER                    PIC S9(8)   COMP.
  5008*    02  ELCNTL-POINTER            PIC S9(8)   COMP.
  5009*    02  ERACCT-POINTER            PIC S9(8)   COMP.
  5010*    02  ERREIN-POINTER            PIC S9(8)   COMP.
  5011*    02  ERCTBL-POINTER            PIC S9(8)   COMP.
  5012*    02  ERFORM-POINTER            PIC S9(8)   COMP.
  5013*    02  ELMSTR-POINTER            PIC S9(8)   COMP.
  5014*    02  ERPLAN-POINTER            PIC S9(8)   COMP.
  5015
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  94
* EL050.cbl
  5017*    COPY ELCCNTL.
  5018******************************************************************
  5019*                                                                *
  5020*                                                                *
  5021*                            ELCCNTL.                            *
  5022*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5023*                            VMOD=2.059                          *
  5024*                                                                *
  5025*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5026*                                                                *
  5027*   FILE TYPE = VSAM,KSDS                                        *
  5028*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5029*                                                                *
  5030*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5031*       ALTERNATE INDEX = NONE                                   *
  5032*                                                                *
  5033*   LOG = YES                                                    *
  5034*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5035******************************************************************
  5036*                   C H A N G E   L O G
  5037*
  5038* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5039*-----------------------------------------------------------------
  5040*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5041* EFFECTIVE    NUMBER
  5042*-----------------------------------------------------------------
  5043* 082503                   PEMA  ADD BENEFIT GROUP
  5044* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5045* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5046* 092705    2005050300006  PEMA  ADD SPP LEASES
  5047* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5048* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5049* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5050* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5051* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5052* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5053* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5054* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5055* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5056* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5057******************************************************************
  5058*
  5059 01  CONTROL-FILE.
  5060     12  CF-RECORD-ID                       PIC XX.
  5061         88  VALID-CF-ID                        VALUE 'CF'.
  5062
  5063     12  CF-CONTROL-PRIMARY.
  5064         16  CF-COMPANY-ID                  PIC XXX.
  5065         16  CF-RECORD-TYPE                 PIC X.
  5066             88  CF-COMPANY-MASTER              VALUE '1'.
  5067             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5068             88  CF-STATE-MASTER                VALUE '3'.
  5069             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5070             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5071             88  CF-CARRIER-MASTER              VALUE '6'.
  5072             88  CF-MORTALITY-MASTER            VALUE '7'.
  5073             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  5074             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  95
* EL050.cbl
  5075             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5076             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5077             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5078             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5079             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5080             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5081             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5082             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5083             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5084         16  CF-ACCESS-CD-GENL              PIC X(4).
  5085         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5086             20  CF-PROCESSOR               PIC X(4).
  5087         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5088             20  CF-STATE-CODE              PIC XX.
  5089             20  FILLER                     PIC XX.
  5090         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5091             20  FILLER                     PIC XX.
  5092             20  CF-HI-BEN-IN-REC           PIC XX.
  5093         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5094             20  FILLER                     PIC XXX.
  5095             20  CF-CARRIER-CNTL            PIC X.
  5096         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5097             20  FILLER                     PIC XX.
  5098             20  CF-HI-TYPE-IN-REC          PIC 99.
  5099         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5100             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5101                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5102             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5103             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5104         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5105             20  FILLER                     PIC X.
  5106             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5107         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5108             20  FILLER                     PIC XX.
  5109             20  CF-MORTGAGE-PLAN           PIC XX.
  5110         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5111
  5112     12  CF-LAST-MAINT-DT                   PIC XX.
  5113     12  CF-LAST-MAINT-BY                   PIC X(4).
  5114     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5115
  5116     12  CF-RECORD-BODY                     PIC X(728).
  5117
  5118
  5119****************************************************************
  5120*             COMPANY MASTER RECORD                            *
  5121****************************************************************
  5122
  5123     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5124         16  CF-COMPANY-ADDRESS.
  5125             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5126             20  CF-CL-IN-CARE-OF           PIC X(30).
  5127             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5128             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5129             20  CF-CL-CITY-STATE           PIC X(30).
  5130             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5131             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  5132         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  96
* EL050.cbl
  5133         16  CF-COMPANY-PASSWORD            PIC X(8).
  5134         16  CF-SECURITY-OPTION             PIC X.
  5135             88  ALL-SECURITY                   VALUE '1'.
  5136             88  COMPANY-VERIFY                 VALUE '2'.
  5137             88  PROCESSOR-VERIFY               VALUE '3'.
  5138             88  NO-SECURITY                    VALUE '4'.
  5139             88  ALL-BUT-TERM                   VALUE '5'.
  5140         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5141             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5142         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5143             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5144         16  CF-INFORCE-LOCATION            PIC X.
  5145             88  CERTS-ARE-ONLINE               VALUE '1'.
  5146             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5147             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5148         16  CF-LOWER-CASE-LETTERS          PIC X.
  5149         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5150             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5151             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5152             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5153             88  CF-ACCNT-CNTL                  VALUE '3'.
  5154             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5155
  5156         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5157         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5158
  5159         16  CF-LGX-CREDIT-USER             PIC X.
  5160             88  CO-IS-NOT-USER                 VALUE 'N'.
  5161             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5162
  5163         16 CF-CREDIT-CALC-CODES.
  5164             20  CF-CR-REM-TERM-CALC PIC X.
  5165               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5166               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5167               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5168               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5169               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5170               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5171               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5172             20  CF-CR-R78-METHOD           PIC X.
  5173               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5174               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5175
  5176         16  CF-CLAIM-CONTROL-COUNTS.
  5177             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5178                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5179
  5180             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5181                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5182
  5183             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5184                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5185
  5186             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5187                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5188
  5189         16  CF-CURRENT-MONTH-END           PIC XX.
  5190
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  97
* EL050.cbl
  5191         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5192             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5193             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5194             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5195             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5196                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5197                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5198             20  CF-CO-PREM-REJECT-SW       PIC X.
  5199                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5200                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5201             20  CF-CO-REF-REJECT-SW        PIC X.
  5202                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5203                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5204
  5205         16  CF-CO-REPORTING-DT             PIC XX.
  5206         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5207         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5208           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5209           88  CF-CO-MONTH-END                  VALUE '1'.
  5210
  5211         16  CF-LGX-CLAIM-USER              PIC X.
  5212             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5213             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5214
  5215         16  CF-CREDIT-EDIT-CONTROLS.
  5216             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5217             20  CF-MIN-AGE                 PIC 99.
  5218             20  CF-DEFAULT-AGE             PIC 99.
  5219             20  CF-MIN-TERM                PIC S999      COMP-3.
  5220             20  CF-MAX-TERM                PIC S999      COMP-3.
  5221             20  CF-DEFAULT-SEX             PIC X.
  5222             20  CF-JOINT-AGE-INPUT         PIC X.
  5223                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5224             20  CF-BIRTH-DATE-INPUT        PIC X.
  5225                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5226             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5227                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5228                 88  CF-ZERO-CARRIER            VALUE '1'.
  5229                 88  CF-ZERO-GROUPING           VALUE '2'.
  5230                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5231             20  CF-EDIT-SW                 PIC X.
  5232                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5233             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5234             20  CF-CR-PR-METHOD            PIC X.
  5235               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5236               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5237             20  FILLER                     PIC X.
  5238
  5239         16  CF-CREDIT-MISC-CONTROLS.
  5240             20  CF-REIN-TABLE-SW           PIC X.
  5241                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5242             20  CF-COMP-TABLE-SW           PIC X.
  5243                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5244             20  CF-EXPERIENCE-RETENTION-AGE
  5245                                            PIC S9        COMP-3.
  5246             20  CF-CONVERSION-DT           PIC XX.
  5247             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5248             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  98
* EL050.cbl
  5249                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5250                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5251
  5252             20  CF-CR-CHECK-NO-CONTROL.
  5253                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5254                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5255                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5256                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5257                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5258                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5259
  5260                 24  CF-CR-CHECK-COUNT       REDEFINES
  5261                     CF-CR-CHECK-COUNTER      PIC X(4).
  5262
  5263                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5264                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5265
  5266                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5267                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5268                 24  CF-MAIL-PROCESSING       PIC X.
  5269                     88  MAIL-PROCESSING          VALUE 'Y'.
  5270
  5271         16  CF-MISC-SYSTEM-CONTROL.
  5272             20  CF-SYSTEM-C                 PIC X.
  5273                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5274             20  CF-SYSTEM-D                 PIC X.
  5275                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5276             20  CF-SOC-SEC-NO-SW            PIC X.
  5277                 88  SOC-SEC-NO-USED             VALUE '1'.
  5278             20  CF-MEMBER-NO-SW             PIC X.
  5279                 88  MEMBER-NO-USED              VALUE '1'.
  5280             20  CF-TAX-ID-NUMBER            PIC X(11).
  5281             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5282             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5283                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5284                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5285                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5286                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5287             20  CF-SYSTEM-E                 PIC X.
  5288                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5289
  5290         16  CF-LGX-LIFE-USER               PIC X.
  5291             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5292             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5293
  5294         16  CF-CR-MONTH-END-DT             PIC XX.
  5295
  5296         16  CF-FILE-MAINT-DATES.
  5297             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5298                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5299             20  CF-LAST-BATCH       REDEFINES
  5300                 CF-LAST-BATCH-NO               PIC X(4).
  5301             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5302             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5303             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5304             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5305             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5306             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page  99
* EL050.cbl
  5307             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5308             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5309             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5310             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5311
  5312         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5313         16  FILLER                         PIC X.
  5314
  5315         16  CF-ALT-MORT-CODE               PIC X(4).
  5316         16  CF-MEMBER-CAPTION              PIC X(10).
  5317
  5318         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5319             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5320             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5321             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5322             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5323             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5324
  5325         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5326
  5327         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5328         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5329         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5330         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5331
  5332         16  CF-AH-OVERRIDE-L1              PIC X.
  5333         16  CF-AH-OVERRIDE-L2              PIC XX.
  5334         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5335         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5336
  5337         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5338         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5339
  5340         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5341         16  CF-AR-LAST-EL860-DT            PIC XX.
  5342         16  CF-MP-MONTH-END-DT             PIC XX.
  5343
  5344         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5345         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5346             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5347
  5348         16  CF-AR-MONTH-END-DT             PIC XX.
  5349
  5350         16  CF-CRDTCRD-USER                PIC X.
  5351             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5352             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5353
  5354         16  CF-CC-MONTH-END-DT             PIC XX.
  5355
  5356         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5357
  5358         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5359             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5360             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5361             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5362         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5363         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5364         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 100
* EL050.cbl
  5365         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5366             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5367             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5368         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5369         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5370         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5371             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5372         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5373
  5374         16  CF-CL-ZIP-CODE.
  5375             20  CF-CL-ZIP-PRIME.
  5376                 24  CF-CL-ZIP-1ST          PIC X.
  5377                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5378                 24  FILLER                 PIC X(4).
  5379             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5380         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5381             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5382             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5383             20  FILLER                     PIC XXX.
  5384
  5385         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5386         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5387         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5388         16  CF-CO-OPTION-START-DATE        PIC XX.
  5389         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5390           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5391                                                      '3' '4'.
  5392           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5393           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5394           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5395           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5396           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5397           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5398
  5399         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5400
  5401         16  CF-PAYMENT-APPROVAL-LEVELS.
  5402             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5403             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5404             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5405             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5406             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5407             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5408
  5409         16  CF-END-USER-REPORTING-USER     PIC X.
  5410             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5411             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5412
  5413         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5414             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5415             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5416
  5417         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5418
  5419         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5420         16  FILLER                         PIC X.
  5421
  5422         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 101
* EL050.cbl
  5423             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5424             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5425             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5426
  5427         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5428
  5429         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5430             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5431             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5432
  5433         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5434             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5435             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5436
  5437         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5438
  5439         16  CF-CO-ACH-ID-CODE              PIC  X.
  5440             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5441             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5442             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5443         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5444         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5445         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5446         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5447         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5448         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5449         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5450         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5451         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5452                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5453         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5454                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5455
  5456         16  CF-CO-OVER-SHORT.
  5457             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5458             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5459
  5460*         16  FILLER                         PIC X(102).
  5461         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5462             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5463             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5464
  5465         16  CF-AH-APPROVAL-DAYS.
  5466             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5467             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5468             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5469             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5470
  5471         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5472
  5473         16  CF-APPROV-LEV-5.
  5474             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5475             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5476             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5477
  5478         16  FILLER                         PIC X(68).
  5479****************************************************************
  5480*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 102
* EL050.cbl
  5481****************************************************************
  5482
  5483     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5484         16  CF-PROCESSOR-NAME              PIC X(30).
  5485         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5486         16  CF-PROCESSOR-TITLE             PIC X(26).
  5487         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5488                 88  MESSAGE-YES                VALUE 'Y'.
  5489                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5490
  5491*****************************************************
  5492****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5493****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5494****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5495****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5496*****************************************************
  5497
  5498         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5499             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5500             20  CF-APPLICATION-FORCE       PIC X.
  5501             20  CF-INDIVIDUAL-APP.
  5502                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5503                     28  CF-BROWSE-APP      PIC X.
  5504                     28  CF-UPDATE-APP      PIC X.
  5505
  5506         16  CF-CURRENT-TERM-ON             PIC X(4).
  5507         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5508             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5509             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5510             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5511             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5512             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5513             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5514             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5515         16  CF-PROCESSOR-CARRIER           PIC X.
  5516             88  NO-CARRIER-SECURITY            VALUE ' '.
  5517         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5518             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5519         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5520             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5521         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5522             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5523
  5524         16  CF-PROC-SYS-ACCESS-SW.
  5525             20  CF-PROC-CREDIT-CLAIMS-SW.
  5526                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5527                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5528                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5529                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5530             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5531                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5532                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5533             20  CF-PROC-LIFE-GNRLDGR-SW.
  5534                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5535                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5536                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5537                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5538             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 103
* EL050.cbl
  5539                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5540                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5541         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5542             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5543             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5544         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5545
  5546         16  CF-APPROVAL-LEVEL                  PIC X.
  5547             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5548             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5549             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5550             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5551             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5552
  5553         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5554
  5555         16  CF-LANGUAGE-TYPE                   PIC X.
  5556             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5557             88  CF-LANG-IS-FR                      VALUE 'F'.
  5558
  5559         16  CF-CSR-IND                         PIC X.
  5560         16  FILLER                             PIC X(239).
  5561
  5562****************************************************************
  5563*             PROCESSOR/REMINDERS RECORD                       *
  5564****************************************************************
  5565
  5566     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5567         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5568             20  CF-START-REMIND-DT         PIC XX.
  5569             20  CF-END-REMIND-DT           PIC XX.
  5570             20  CF-REMINDER-TEXT           PIC X(50).
  5571         16  FILLER                         PIC X(296).
  5572
  5573
  5574****************************************************************
  5575*             STATE MASTER RECORD                              *
  5576****************************************************************
  5577
  5578     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5579         16  CF-STATE-ABBREVIATION          PIC XX.
  5580         16  CF-STATE-NAME                  PIC X(25).
  5581         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5582         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5583             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5584             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5585             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5586             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5587                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5588                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5589             20  CF-ST-PREM-REJECT-SW       PIC X.
  5590                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5591                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5592             20  CF-ST-REF-REJECT-SW        PIC X.
  5593                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5594                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5595         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5596         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 104
* EL050.cbl
  5597         16  CF-ST-REFUND-RULES.
  5598             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5599             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5600             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5601         16  CF-ST-FST-PMT-EXTENSION.
  5602             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5603             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5604                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5605                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5606                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5607                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5608         16  CF-ST-STATE-CALL.
  5609             20  CF-ST-CALL-UNEARNED        PIC X.
  5610             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5611             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5612         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5613             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5614             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5615         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5616         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5617         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5618         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5619         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5620         16  FILLER                         PIC X.
  5621         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5622             20  CF-ST-BENEFIT-CD           PIC XX.
  5623             20  CF-ST-BENEFIT-KIND         PIC X.
  5624                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5625                 88  CF-ST-AH-KIND              VALUE 'A'.
  5626             20  CF-ST-REM-TERM-CALC        PIC X.
  5627                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5628                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5629                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5630                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5631                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5632                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5633                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5634                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5635
  5636             20  CF-ST-REFUND-CALC          PIC X.
  5637                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5638                 88  ST-REFD-BY-R78             VALUE '1'.
  5639                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5640                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5641                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5642                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5643                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5644                 88  ST-REFD-UTAH               VALUE '7'.
  5645                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5646                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5647                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5648
  5649             20  CF-ST-EARNING-CALC         PIC X.
  5650                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5651                 88  ST-EARN-BY-R78             VALUE '1'.
  5652                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5653                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5654                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 105
* EL050.cbl
  5655                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5656                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5657                 88  ST-EARN-MEAN               VALUE '8'.
  5658                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5659
  5660             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5661                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5662                 88  ST-OVRD-BY-R78             VALUE '1'.
  5663                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5664                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5665                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5666                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5667                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5668                 88  ST-OVRD-MEAN               VALUE '8'.
  5669                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5670             20  cf-st-extra-periods        pic 9.
  5671*            20  FILLER                     PIC X.
  5672
  5673         16  CF-ST-COMMISSION-CAPS.
  5674             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5675             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5676             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5677             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5678         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5679                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5680
  5681         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5682
  5683         16  CF-ST-STATUTORY-INTEREST.
  5684             20  CF-ST-STAT-DATE-FROM       PIC X.
  5685                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5686                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5687             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5688             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5689             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5690             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5691             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5692
  5693         16  CF-ST-OVER-SHORT.
  5694             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5695             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5696
  5697         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5698
  5699         16  CF-ST-RT-CALC                  PIC X.
  5700
  5701         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5702         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5703         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5704         16  CF-ST-RF-LR-CALC               PIC X.
  5705         16  CF-ST-RF-LL-CALC               PIC X.
  5706         16  CF-ST-RF-LN-CALC               PIC X.
  5707         16  CF-ST-RF-AH-CALC               PIC X.
  5708         16  CF-ST-RF-CP-CALC               PIC X.
  5709*        16  FILLER                         PIC X(206).
  5710*CIDMOD         16  FILLER                         PIC X(192).
  5711         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5712             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 106
* EL050.cbl
  5713         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5714         16  CF-ST-VFY-2ND-BENE             PIC X.
  5715         16  CF-ST-CAUSAL-STATE             PIC X.
  5716         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5717         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5718         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5719             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5720         16  CF-ST-NET-ONLY-STATE           PIC X.
  5721             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5722         16  FILLER                         PIC X(181).
  5723
  5724****************************************************************
  5725*             BENEFIT MASTER RECORD                            *
  5726****************************************************************
  5727
  5728     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5729         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5730             20  CF-BENEFIT-CODE            PIC XX.
  5731             20  CF-BENEFIT-NUMERIC  REDEFINES
  5732                 CF-BENEFIT-CODE            PIC XX.
  5733             20  CF-BENEFIT-ALPHA           PIC XXX.
  5734             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5735             20  CF-BENEFIT-COMMENT         PIC X(10).
  5736
  5737             20  CF-LF-COVERAGE-TYPE        PIC X.
  5738                 88  CF-REDUCING                VALUE 'R'.
  5739                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5740
  5741             20  CF-SPECIAL-CALC-CD         PIC X.
  5742                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5743                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5744                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5745                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5746                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5747                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5748                 88  CF-FARM-PLAN               VALUE 'F'.
  5749                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5750                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5751                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5752                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5753                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5754                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5755                 88  CF-PRUDENTIAL              VALUE 'P'.
  5756                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5757                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5758                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5759                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5760                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5761                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5762
  5763             20  CF-JOINT-INDICATOR         PIC X.
  5764                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5765
  5766*            20  FILLER                     PIC X(12).
  5767             20  cf-maximum-benefits        pic s999 comp-3.
  5768             20  FILLER                     PIC X(09).
  5769             20  CF-BENEFIT-CATEGORY        PIC X.
  5770             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 107
* EL050.cbl
  5771
  5772             20  CF-CO-REM-TERM-CALC        PIC X.
  5773                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5774                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5775                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5776                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5777                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5778
  5779             20  CF-CO-EARNINGS-CALC        PIC X.
  5780                 88  CO-EARN-BY-R78             VALUE '1'.
  5781                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5782                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5783                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5784                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5785                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5786                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5787                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5788
  5789             20  CF-CO-REFUND-CALC          PIC X.
  5790                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5791                 88  CO-REFD-BY-R78             VALUE '1'.
  5792                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5793                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5794                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5795                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5796                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5797                 88  CO-REFD-MEAN               VALUE '8'.
  5798                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5799                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5800                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5801
  5802             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5803                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5804                 88  CO-OVRD-BY-R78             VALUE '1'.
  5805                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5806                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5807                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5808                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5809                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5810                 88  CO-OVRD-MEAN               VALUE '8'.
  5811                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5812
  5813             20  CF-CO-BEN-I-G-CD           PIC X.
  5814                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5815                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5816                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5817
  5818         16  FILLER                         PIC X(304).
  5819
  5820
  5821****************************************************************
  5822*             CARRIER MASTER RECORD                            *
  5823****************************************************************
  5824
  5825     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5826         16  CF-ADDRESS-DATA.
  5827             20  CF-MAIL-TO-NAME            PIC X(30).
  5828             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 108
* EL050.cbl
  5829             20  CF-ADDRESS-LINE-1          PIC X(30).
  5830             20  CF-ADDRESS-LINE-2          PIC X(30).
  5831             20  CF-CITY-STATE              PIC X(30).
  5832             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5833             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5834
  5835         16  CF-CLAIM-NO-CONTROL.
  5836             20  CF-CLAIM-NO-METHOD         PIC X.
  5837                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5838                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5839                 88  CLAIM-NO-SEQ               VALUE '3'.
  5840                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5841             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5842                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5843                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5844                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5845
  5846         16  CF-CHECK-NO-CONTROL.
  5847             20  CF-CHECK-NO-METHOD         PIC X.
  5848                 88  CHECK-NO-MANUAL            VALUE '1'.
  5849                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5850                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5851                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5852             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5853                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5854
  5855         16  CF-DOMICILE-STATE              PIC XX.
  5856
  5857         16  CF-EXPENSE-CONTROLS.
  5858             20  CF-EXPENSE-METHOD          PIC X.
  5859                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5860                 88  DOLLARS-PER-PMT            VALUE '2'.
  5861                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5862                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5863             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5864             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5865
  5866         16  CF-CORRESPONDENCE-CONTROL.
  5867             20  CF-LETTER-RESEND-OPT       PIC X.
  5868                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5869                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5870             20  FILLER                     PIC X(4).
  5871
  5872         16  CF-RESERVE-CONTROLS.
  5873             20  CF-MANUAL-SW               PIC X.
  5874                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5875             20  CF-FUTURE-SW               PIC X.
  5876                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5877             20  CF-PTC-SW                  PIC X.
  5878                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5879             20  CF-IBNR-SW                 PIC X.
  5880                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5881             20  CF-PTC-LF-SW               PIC X.
  5882                 88  CF-LF-PTC-USED             VALUE '1'.
  5883             20  CF-CDT-ACCESS-METHOD       PIC X.
  5884                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5885                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5886                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 109
* EL050.cbl
  5887             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5888
  5889         16  CF-CLAIM-CALC-METHOD           PIC X.
  5890             88  360-PLUS-MONTHS                VALUE '1'.
  5891             88  365-PLUS-MONTHS                VALUE '2'.
  5892             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5893             88  360-DAILY                      VALUE '4'.
  5894             88  365-DAILY                      VALUE '5'.
  5895
  5896         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5897         16  FILLER                         PIC X(11).
  5898
  5899         16  CF-LIMIT-AMOUNTS.
  5900             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5901             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5902             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5903             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5904             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5905             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5906             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5907             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5908             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5909             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5910
  5911         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5912         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5913         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5914
  5915         16  CF-ZIP-CODE.
  5916             20  CF-ZIP-PRIME.
  5917                 24  CF-ZIP-1ST             PIC X.
  5918                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5919                 24  FILLER                 PIC X(4).
  5920             20  CF-ZIP-PLUS4               PIC X(4).
  5921         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5922             20  CF-CAN-POSTAL-1            PIC XXX.
  5923             20  CF-CAN-POSTAL-2            PIC XXX.
  5924             20  FILLER                     PIC XXX.
  5925
  5926         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5927         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5928         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5929
  5930         16  CF-RATING-SWITCH               PIC X.
  5931             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5932             88  CF-NO-RATING                   VALUE 'N'.
  5933
  5934         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5935
  5936         16  CF-CARRIER-OVER-SHORT.
  5937             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5938             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5939
  5940         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5941         16  CF-SECPAY-SWITCH               PIC X.
  5942             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5943             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5944         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 110
* EL050.cbl
  5945         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5946         16  FILLER                         PIC X(444).
  5947*        16  FILLER                         PIC X(452).
  5948
  5949
  5950****************************************************************
  5951*             MORTALITY MASTER RECORD                          *
  5952****************************************************************
  5953
  5954     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5955         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5956                                INDEXED BY CF-MORT-NDX.
  5957             20  CF-MORT-TABLE              PIC X(5).
  5958             20  CF-MORT-TABLE-TYPE         PIC X.
  5959                 88  CF-MORT-JOINT              VALUE 'J'.
  5960                 88  CF-MORT-SINGLE             VALUE 'S'.
  5961                 88  CF-MORT-COMBINED           VALUE 'C'.
  5962                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5963                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5964             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5965             20  CF-MORT-AGE-METHOD         PIC XX.
  5966                 88  CF-AGE-LAST                VALUE 'AL'.
  5967                 88  CF-AGE-NEAR                VALUE 'AN'.
  5968             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5969             20  CF-MORT-ADJUSTMENT-DIRECTION
  5970                                            PIC X.
  5971                 88  CF-MINUS                   VALUE '-'.
  5972                 88  CF-PLUS                    VALUE '+'.
  5973             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5974             20  CF-MORT-JOINT-CODE         PIC X.
  5975                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5976             20  CF-MORT-PC-Q               PIC X.
  5977                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5978             20  CF-MORT-TABLE-CODE         PIC X(4).
  5979             20  CF-MORT-COMMENTS           PIC X(15).
  5980             20  FILLER                     PIC X(14).
  5981
  5982         16  FILLER                         PIC X(251).
  5983
  5984
  5985****************************************************************
  5986*             BUSSINESS TYPE MASTER RECORD                     *
  5987****************************************************************
  5988
  5989     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5990* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5991* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5992* AND RECORD 05 IS TYPES 81-99
  5993         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5994             20  CF-BUSINESS-TITLE          PIC  X(19).
  5995             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5996                                            PIC S9V9(4) COMP-3.
  5997             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5998             20  FILLER                     PIC  X.
  5999         16  FILLER                         PIC  X(248).
  6000
  6001
  6002****************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 111
* EL050.cbl
  6003*             TERMINAL MASTER RECORD                           *
  6004****************************************************************
  6005
  6006     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6007
  6008         16  CF-COMPANY-TERMINALS.
  6009             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6010                                  PIC X(4).
  6011         16  FILLER               PIC X(248).
  6012
  6013
  6014****************************************************************
  6015*             LIFE EDIT MASTER RECORD                          *
  6016****************************************************************
  6017
  6018     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6019         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6020             20  CF-LIFE-CODE-IN            PIC XX.
  6021             20  CF-LIFE-CODE-OUT           PIC XX.
  6022         16  FILLER                         PIC X(248).
  6023
  6024
  6025****************************************************************
  6026*             AH EDIT MASTER RECORD                            *
  6027****************************************************************
  6028
  6029     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6030         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6031             20  CF-AH-CODE-IN              PIC XXX.
  6032             20  CF-AH-CODE-OUT             PIC XX.
  6033         16  FILLER                         PIC X(248).
  6034
  6035
  6036****************************************************************
  6037*             CREDIBILITY TABLES                               *
  6038****************************************************************
  6039
  6040     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6041         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6042                             INDEXED BY CF-CRDB-NDX.
  6043             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6044             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6045             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6046         16  FILLER                         PIC  X(332).
  6047
  6048
  6049****************************************************************
  6050*             REPORT CUSTOMIZATION RECORD                      *
  6051****************************************************************
  6052
  6053     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6054         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6055             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6056             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6057             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6058**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6059****       A T-TRANSFER.                                   ****
  6060             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 112
* EL050.cbl
  6061
  6062         16  FILLER                         PIC XX.
  6063
  6064         16  CF-CARRIER-CNTL-OPT.
  6065             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6066                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6067                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6068             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6069                                            PIC X.
  6070         16  CF-GROUP-CNTL-OPT.
  6071             20  CF-GROUP-OPT-SEQ           PIC 9.
  6072                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6073                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6074             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6075                                            PIC X(6).
  6076         16  CF-STATE-CNTL-OPT.
  6077             20  CF-STATE-OPT-SEQ           PIC 9.
  6078                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6079                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6080             20  CF-STATE-SELECT OCCURS 3 TIMES
  6081                                            PIC XX.
  6082         16  CF-ACCOUNT-CNTL-OPT.
  6083             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6084                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6085                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6086             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6087                                            PIC X(10).
  6088         16  CF-BUS-TYP-CNTL-OPT.
  6089             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6090                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6091                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6092             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6093                                            PIC XX.
  6094         16  CF-LF-TYP-CNTL-OPT.
  6095             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6096                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6097                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6098             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6099                                            PIC XX.
  6100         16  CF-AH-TYP-CNTL-OPT.
  6101             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6102                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6103                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6104             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  6105                                            PIC XX.
  6106         16  CF-REPTCD1-CNTL-OPT.
  6107             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6108                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6109                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6110             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6111                                            PIC X(10).
  6112         16  CF-REPTCD2-CNTL-OPT.
  6113             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6114                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6115                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6116             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6117                                            PIC X(10).
  6118         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 113
* EL050.cbl
  6119             20  CF-USER1-OPT-SEQ           PIC 9.
  6120                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6121                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6122             20  CF-USER1-SELECT OCCURS 3 TIMES
  6123                                            PIC X(10).
  6124         16  CF-USER2-CNTL-OPT.
  6125             20  CF-USER2-OPT-SEQ           PIC 9.
  6126                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6127                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6128             20  CF-USER2-SELECT OCCURS 3 TIMES
  6129                                            PIC X(10).
  6130         16  CF-USER3-CNTL-OPT.
  6131             20  CF-USER3-OPT-SEQ           PIC 9.
  6132                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6133                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6134             20  CF-USER3-SELECT OCCURS 3 TIMES
  6135                                            PIC X(10).
  6136         16  CF-USER4-CNTL-OPT.
  6137             20  CF-USER4-OPT-SEQ           PIC 9.
  6138                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6139                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6140             20  CF-USER4-SELECT OCCURS 3 TIMES
  6141                                            PIC X(10).
  6142         16  CF-USER5-CNTL-OPT.
  6143             20  CF-USER5-OPT-SEQ           PIC 9.
  6144                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6145                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6146             20  CF-USER5-SELECT OCCURS 3 TIMES
  6147                                            PIC X(10).
  6148         16  CF-REINS-CNTL-OPT.
  6149             20  CF-REINS-OPT-SEQ           PIC 9.
  6150                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6151                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6152             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6153                 24  CF-REINS-PRIME         PIC XXX.
  6154                 24  CF-REINS-SUB           PIC XXX.
  6155
  6156         16  CF-AGENT-CNTL-OPT.
  6157             20  CF-AGENT-OPT-SEQ           PIC 9.
  6158                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6159                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6160             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6161                                            PIC X(10).
  6162
  6163         16  FILLER                         PIC X(43).
  6164
  6165         16  CF-LOSS-RATIO-SELECT.
  6166             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6167             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6168         16  CF-ENTRY-DATE-SELECT.
  6169             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6170             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6171         16  CF-EFFECTIVE-DATE-SELECT.
  6172             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6173             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6174
  6175         16  CF-EXCEPTION-LIST-IND          PIC X.
  6176             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 114
* EL050.cbl
  6177
  6178         16  FILLER                         PIC X(318).
  6179
  6180****************************************************************
  6181*                  EXCEPTION REPORTING RECORD                  *
  6182****************************************************************
  6183
  6184     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6185         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6186             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6187
  6188         16  CF-COMBINED-LIFE-AH-OPT.
  6189             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6190             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6191             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6192             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6193
  6194         16  CF-LIFE-OPT.
  6195             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6196             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6197             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6198             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6199             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6200             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6201             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6202             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6203             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6204             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6205
  6206         16  CF-AH-OPT.
  6207             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6208             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6209             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6210             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6211             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6212             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6213             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6214             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6215             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6216             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6217
  6218         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6219             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6220             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  6221             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6222
  6223         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6224
  6225         16  FILLER                         PIC X(673).
  6226
  6227
  6228****************************************************************
  6229*             MORTGAGE SYSTEM PLAN RECORD                      *
  6230****************************************************************
  6231
  6232     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6233         16  CF-PLAN-TYPE                   PIC X.
  6234             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 115
* EL050.cbl
  6235             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6236             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6237         16  CF-PLAN-ABBREV                 PIC XXX.
  6238         16  CF-PLAN-DESCRIPT               PIC X(10).
  6239         16  CF-PLAN-NOTES                  PIC X(20).
  6240         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6241         16  CF-PLAN-UNDERWRITING.
  6242             20  CF-PLAN-TERM-DATA.
  6243                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6244                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6245             20  CF-PLAN-AGE-DATA.
  6246                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6247                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6248                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6249             20  CF-PLAN-BENEFIT-DATA.
  6250                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6251                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6252                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6253                                            PIC S9(7)V99  COMP-3.
  6254         16  CF-PLAN-POLICY-FORMS.
  6255             20  CF-POLICY-FORM             PIC X(12).
  6256             20  CF-MASTER-APPLICATION      PIC X(12).
  6257             20  CF-MASTER-POLICY           PIC X(12).
  6258         16  CF-PLAN-RATING.
  6259             20  CF-RATE-CODE               PIC X(5).
  6260             20  CF-SEX-RATING              PIC X.
  6261                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6262                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6263             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6264             20  CF-SUB-STD-TYPE            PIC X.
  6265                 88  CF-PCT-OF-PREM            VALUE '1'.
  6266                 88  CF-PCT-OF-BENE            VALUE '2'.
  6267         16  CF-PLAN-PREM-TOLERANCES.
  6268             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6269             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6270         16  CF-PLAN-PYMT-TOLERANCES.
  6271             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6272             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6273         16  CF-PLAN-MISC-DATA.
  6274             20  FILLER                     PIC X.
  6275             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6276             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6277         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6278         16  CF-PLAN-IND-GRP                PIC X.
  6279             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6280                                                     '1'.
  6281             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6282                                                     '2'.
  6283         16  CF-MIB-SEARCH-SW               PIC X.
  6284             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6285             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6286             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6287             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6288         16  CF-ALPHA-SEARCH-SW             PIC X.
  6289             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6290             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6291             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6292             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 116
* EL050.cbl
  6293             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6294             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6295             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6296             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6297             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6298             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6299                                                     'A' 'B' 'C'
  6300                                                     'X' 'Y' 'Z'.
  6301         16  CF-EFF-DT-RULE-SW              PIC X.
  6302             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6303             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6304             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6305             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6306             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6307         16  FILLER                         PIC X(4).
  6308         16  CF-HEALTH-QUESTIONS            PIC X.
  6309             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6310         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6311         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6312         16  CF-PLAN-SNGL-JNT               PIC X.
  6313             88  CF-COMBINED-PLAN              VALUE 'C'.
  6314             88  CF-JNT-PLAN                   VALUE 'J'.
  6315             88  CF-SNGL-PLAN                  VALUE 'S'.
  6316         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6317         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6318         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6319         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6320         16  CF-RERATE-CNTL                 PIC  X.
  6321             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6322             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6323             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6324             88  CF-AUTO-RECALC                 VALUE '4'.
  6325         16  CF-BENEFIT-TYPE                PIC  X.
  6326             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6327             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6328         16  CF-POLICY-FEE                  PIC S999V99
  6329                                                    COMP-3.
  6330         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6331         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6332         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6333         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6334         16  FILLER                         PIC  X(32).
  6335         16  CF-TERMINATION-FORM            PIC  X(04).
  6336         16  FILLER                         PIC  X(08).
  6337         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6338                                                       COMP-3.
  6339         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6340         16  CF-ISSUE-LETTER                PIC  X(4).
  6341         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6342         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6343             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6344             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6345         16  CF-MP-REFUND-CALC              PIC X.
  6346             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6347             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6348             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6349             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6350             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 117
* EL050.cbl
  6351             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6352             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6353             88  CF-MP-REFD-MEAN                VALUE '8'.
  6354         16  CF-ALT-RATE-CODE               PIC  X(5).
  6355
  6356
  6357         16  FILLER                         PIC X(498).
  6358****************************************************************
  6359*             MORTGAGE COMPANY MASTER RECORD                   *
  6360****************************************************************
  6361
  6362     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6363         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6364         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6365             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6366             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6367             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6368             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6369             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6370
  6371         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6372         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6373         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6374         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6375         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6376
  6377         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6378             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6379         16  CF-MP-RECON-USE-IND            PIC X(1).
  6380             88  CF-MP-USE-RECON             VALUE 'Y'.
  6381         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6382             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6383         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6384             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6385             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6386         16  FILLER                         PIC X(1).
  6387         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6388             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6389         16  CF-MORTG-MIB-VERSION           PIC X.
  6390             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6391             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6392             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6393         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6394             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6395                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6396             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6397                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6398             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6399                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6400             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6401                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6402             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6403                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6404             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6405                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6406         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6407         16  FILLER                         PIC X(7).
  6408         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 118
* EL050.cbl
  6409             20  CF-MORTG-MIB-COMM          PIC X(5).
  6410             20  CF-MORTG-MIB-TERM          PIC X(5).
  6411         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6412             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6413         16  FILLER                         PIC X(03).
  6414         16  CF-MP-CHECK-NO-CONTROL.
  6415             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6416                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6417                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6418                                                ' ' LOW-VALUES.
  6419                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6420                                               VALUE '3'.
  6421         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6422         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6423         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6424             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6425                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6426             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6427                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6428             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6429                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6430             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6431                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6432             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6433                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6434             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6435                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6436         16  CF-MORTG-BILLING-AREA.
  6437             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6438                                            PIC X.
  6439         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6440         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6441         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6442         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6443             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6444             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6445         16  FILLER                         PIC X.
  6446         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6447             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6448             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6449         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6450         16  FILLER                         PIC X(8).
  6451         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6452         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6453         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6454         16  CF-ACH-COMPANY-ID.
  6455             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6456                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6457                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6458                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6459             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6460         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6461             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6462         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6463             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6464             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6465         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6466         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 119
* EL050.cbl
  6467         16  FILLER                         PIC X(536).
  6468
  6469****************************************************************
  6470*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6471****************************************************************
  6472
  6473     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6474         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6475             20  CF-FEMALE-HEIGHT.
  6476                 24  CF-FEMALE-FT           PIC 99.
  6477                 24  CF-FEMALE-IN           PIC 99.
  6478             20  CF-FEMALE-MIN-WT           PIC 999.
  6479             20  CF-FEMALE-MAX-WT           PIC 999.
  6480         16  FILLER                         PIC X(428).
  6481
  6482     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6483         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6484             20  CF-MALE-HEIGHT.
  6485                 24  CF-MALE-FT             PIC 99.
  6486                 24  CF-MALE-IN             PIC 99.
  6487             20  CF-MALE-MIN-WT             PIC 999.
  6488             20  CF-MALE-MAX-WT             PIC 999.
  6489         16  FILLER                         PIC X(428).
  6490******************************************************************
  6491*             AUTOMATIC ACTIVITY RECORD                          *
  6492******************************************************************
  6493     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6494         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6495             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6496             20  CF-SYS-LETTER-ID           PIC X(04).
  6497             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6498             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6499             20  CF-SYS-RESET-SW            PIC X(01).
  6500             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6501             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6502
  6503         16  FILLER                         PIC X(50).
  6504
  6505         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6506             20  CF-USER-ACTIVE-SW          PIC X(01).
  6507             20  CF-USER-LETTER-ID          PIC X(04).
  6508             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6509             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6510             20  CF-USER-RESET-SW           PIC X(01).
  6511             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6512             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6513             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6514
  6515         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 120
* EL050.cbl
  6517*    COPY ERCACCT.
  6518******************************************************************
  6519*                                                                *
  6520*                                                                *
  6521*                            ERCACCT                             *
  6522*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6523*                            VMOD=2.031                          *
  6524*                                                                *
  6525*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6526*                                                                *
  6527*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6528*   VSAM ACCOUNT MASTER FILES.                                   *
  6529*                                                                *
  6530*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6531*                                                                *
  6532*   FILE TYPE = VSAM,KSDS                                        *
  6533*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6534*                                                                *
  6535*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6536*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6537*                                                                *
  6538*   LOG = NO                                                     *
  6539*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6540*                                                                *
  6541*                                                                *
  6542******************************************************************
  6543*                   C H A N G E   L O G
  6544*
  6545* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6546*-----------------------------------------------------------------
  6547*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6548* EFFECTIVE    NUMBER
  6549*-----------------------------------------------------------------
  6550* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6551* 092705    2005050300006  PEMA  ADD SPP LEASES
  6552* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6553* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6554* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6555* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6556* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6557******************************************************************
  6558
  6559 01  ACCOUNT-MASTER.
  6560     12  AM-RECORD-ID                      PIC XX.
  6561         88  VALID-AM-ID                      VALUE 'AM'.
  6562
  6563     12  AM-CONTROL-PRIMARY.
  6564         16  AM-COMPANY-CD                 PIC X.
  6565         16  AM-MSTR-CNTRL.
  6566             20  AM-CONTROL-A.
  6567                 24  AM-CARRIER            PIC X.
  6568                 24  AM-GROUPING.
  6569                     28 AM-GROUPING-PREFIX PIC XXX.
  6570                     28 AM-GROUPING-PRIME  PIC XXX.
  6571                 24  AM-STATE              PIC XX.
  6572                 24  AM-ACCOUNT.
  6573                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6574                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 121
* EL050.cbl
  6575             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6576                                           PIC X(19).
  6577             20  AM-CNTRL-B.
  6578                 24  AM-EXPIRATION-DT      PIC XX.
  6579                 24  FILLER                PIC X(4).
  6580             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6581                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6582
  6583     12  AM-CONTROL-BY-VAR-GRP.
  6584         16  AM-COMPANY-CD-A1              PIC X.
  6585         16  AM-VG-CARRIER                 PIC X.
  6586         16  AM-VG-GROUPING                PIC X(6).
  6587         16  AM-VG-STATE                   PIC XX.
  6588         16  AM-VG-ACCOUNT                 PIC X(10).
  6589         16  AM-VG-DATE.
  6590             20  AM-VG-EXPIRATION-DT       PIC XX.
  6591             20  FILLER                    PIC X(4).
  6592         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6593                                           PIC 9(11)      COMP-3.
  6594     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6595         16  FILLER                        PIC X(10).
  6596         16  AM-VG-KEY3.
  6597             20  AM-VG3-ACCOUNT            PIC X(10).
  6598             20  AM-VG3-EXP-DT             PIC XX.
  6599         16  FILLER                        PIC X(4).
  6600     12  AM-MAINT-INFORMATION.
  6601         16  AM-LAST-MAINT-DT              PIC XX.
  6602         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6603         16  AM-LAST-MAINT-USER            PIC X(4).
  6604         16  FILLER                        PIC XX.
  6605
  6606     12  AM-EFFECTIVE-DT                   PIC XX.
  6607     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6608
  6609     12  AM-PREV-DATES  COMP-3.
  6610         16  AM-PREV-EXP-DT                PIC 9(11).
  6611         16  AM-PREV-EFF-DT                PIC 9(11).
  6612
  6613     12  AM-REPORT-CODE-1                  PIC X(10).
  6614     12  AM-REPORT-CODE-2                  PIC X(10).
  6615
  6616     12  AM-CITY-CODE                      PIC X(4).
  6617     12  AM-COUNTY-PARISH                  PIC X(6).
  6618
  6619     12  AM-NAME                           PIC X(30).
  6620     12  AM-PERSON                         PIC X(30).
  6621     12  AM-ADDRS                          PIC X(30).
  6622     12  AM-CITY.
  6623         16  AM-ADDR-CITY                  PIC X(28).
  6624         16  AM-ADDR-STATE                 PIC XX.
  6625     12  AM-ZIP.
  6626         16  AM-ZIP-PRIME.
  6627             20  AM-ZIP-PRI-1ST            PIC X.
  6628                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6629             20  FILLER                    PIC X(4).
  6630         16  AM-ZIP-PLUS4                  PIC X(4).
  6631     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6632         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 122
* EL050.cbl
  6633         16  AM-CAN-POSTAL-2               PIC XXX.
  6634         16  FILLER                        PIC XXX.
  6635     12  AM-TEL-NO.
  6636         16  AM-AREA-CODE                  PIC 999.
  6637         16  AM-TEL-PRE                    PIC 999.
  6638         16  AM-TEL-NBR                    PIC 9(4).
  6639     12  AM-TEL-LOC                        PIC X.
  6640         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6641         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6642
  6643     12  AM-COMM-STRUCTURE.
  6644         16  AM-DEFN-1.
  6645             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6646                 24  AM-AGT.
  6647                     28  AM-AGT-PREFIX     PIC X(4).
  6648                     28  AM-AGT-PRIME      PIC X(6).
  6649                 24  AM-COM-TYP            PIC X.
  6650                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6651                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6652                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6653                 24  AM-RECALC-LV-INDIC    PIC X.
  6654                 24  AM-RETRO-LV-INDIC     PIC X.
  6655                 24  AM-GL-CODES           PIC X.
  6656                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6657                 24  FILLER                PIC X(01).
  6658         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6659             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6660                 24  FILLER                PIC X(11).
  6661                 24  AM-L-COMA             PIC XXX.
  6662                 24  AM-J-COMA             PIC XXX.
  6663                 24  AM-A-COMA             PIC XXX.
  6664                 24  FILLER                PIC X(6).
  6665
  6666     12  AM-COMM-CHANGE-STATUS             PIC X.
  6667         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6668
  6669     12  AM-CSR-CODE                       PIC X(4).
  6670
  6671     12  AM-BILLING-STATUS                 PIC X.
  6672         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6673         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6674     12  AM-AUTO-REFUND-SW                 PIC X.
  6675         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6676         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6677     12  AM-GPCD                           PIC 99.
  6678     12  AM-IG                             PIC X.
  6679         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6680         88  AM-HAS-GROUP                     VALUE '2'.
  6681     12  AM-STATUS                         PIC X.
  6682         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6683         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6684         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6685         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6686         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6687         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6688     12  AM-REMIT-TO                       PIC 99.
  6689     12  AM-ID-NO                          PIC X(11).
  6690
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 123
* EL050.cbl
  6691     12  AM-CAL-TABLE                      PIC XX.
  6692     12  AM-LF-DEVIATION                   PIC XXX.
  6693     12  AM-AH-DEVIATION                   PIC XXX.
  6694     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6695     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6696     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6697     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6698     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6699     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6700
  6701     12  AM-USER-FIELDS.
  6702         16  AM-FLD-1                      PIC XX.
  6703         16  AM-FLD-2                      PIC XX.
  6704         16  AM-FLD-3                      PIC XX.
  6705         16  AM-FLD-4                      PIC XX.
  6706         16  AM-FLD-5                      PIC XX.
  6707
  6708     12  AM-1ST-PROD-DATE.
  6709         16  AM-1ST-PROD-YR                PIC XX.
  6710         16  AM-1ST-PROD-MO                PIC XX.
  6711         16  AM-1ST-PROD-DA                PIC XX.
  6712     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6713     12  AM-CERTS-PURGED-DATE.
  6714         16  AM-PUR-YR                     PIC XX.
  6715         16  AM-PUR-MO                     PIC XX.
  6716         16  AM-PUR-DA                     PIC XX.
  6717     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6718     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6719     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6720     12  AM-INACTIVE-DATE.
  6721         16  AM-INA-MO                     PIC 99.
  6722         16  AM-INA-DA                     PIC 99.
  6723         16  AM-INA-YR                     PIC 99.
  6724     12  AM-AR-HI-CERT-DATE                PIC XX.
  6725
  6726     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6727     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6728
  6729     12  AM-OB-PAYMENT-MODE                PIC X.
  6730         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6731         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6732         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6733         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6734
  6735     12  AM-AH-ONLY-INDICATOR              PIC X.
  6736         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6737         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6738
  6739     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6740
  6741     12  AM-OVER-SHORT.
  6742         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6743         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6744
  6745     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6746     12  AM-DCC-CLP-STATE                  PIC XX.
  6747
  6748     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 124
* EL050.cbl
  6749     12  AM-RECALC-REIN                    PIC X.
  6750
  6751     12  AM-REI-TABLE                      PIC XXX.
  6752     12  AM-REI-ET-LF                      PIC X.
  6753     12  AM-REI-ET-AH                      PIC X.
  6754     12  AM-REI-PE-LF                      PIC X.
  6755     12  AM-REI-PE-AH                      PIC X.
  6756     12  AM-REI-PRT-ST                     PIC X.
  6757     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6758     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6759     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6760     12  AM-REI-GROUP-A                    PIC X(6).
  6761     12  AM-REI-MORT                       PIC X(4).
  6762     12  AM-REI-PRT-OW                     PIC X.
  6763     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6764     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6765     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6766     12  AM-REI-GROUP-B                    PIC X(6).
  6767
  6768     12  AM-TRUST-TYPE                     PIC X(2).
  6769
  6770     12  AM-EMPLOYER-STMT-USED             PIC X.
  6771     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6772
  6773     12  AM-STD-AH-TYPE                    PIC XX.
  6774     12  AM-EARN-METHODS.
  6775         16  AM-EARN-METHOD-R              PIC X.
  6776             88 AM-REF-RL-R78                 VALUE 'R'.
  6777             88 AM-REF-RL-PR                  VALUE 'P'.
  6778             88 AM-REF-RL-MEAN                VALUE 'M'.
  6779             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6780         16  AM-EARN-METHOD-L              PIC X.
  6781             88 AM-REF-LL-R78                 VALUE 'R'.
  6782             88 AM-REF-LL-PR                  VALUE 'P'.
  6783             88 AM-REF-LL-MEAN                VALUE 'M'.
  6784             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6785         16  AM-EARN-METHOD-A              PIC X.
  6786             88 AM-REF-AH-R78                 VALUE 'R'.
  6787             88 AM-REF-AH-PR                  VALUE 'P'.
  6788             88 AM-REF-AH-MEAN                VALUE 'M'.
  6789             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6790             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6791             88 AM-REF-AH-NET                 VALUE 'N'.
  6792
  6793     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6794     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6795     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6796
  6797     12  AM-RET-Y-N                        PIC X.
  6798     12  AM-RET-P-E                        PIC X.
  6799     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6800     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6801     12  AM-RET-GRP                        PIC X(6).
  6802     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6803         16  AM-POOL-PRIME                 PIC XXX.
  6804         16  AM-POOL-SUB                   PIC XXX.
  6805     12  AM-RETRO-EARNINGS.
  6806         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 125
* EL050.cbl
  6807         16  AM-RET-EARN-L                 PIC X.
  6808         16  AM-RET-EARN-A                 PIC X.
  6809     12  AM-RET-ST-TAX-USE                 PIC X.
  6810         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6811         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6812     12  AM-RETRO-BEG-EARNINGS.
  6813         16  AM-RET-BEG-EARN-R             PIC X.
  6814         16  AM-RET-BEG-EARN-L             PIC X.
  6815         16  AM-RET-BEG-EARN-A             PIC X.
  6816     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6817     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6818
  6819     12  AM-USER-SELECT-OPTIONS.
  6820         16  AM-USER-SELECT-1              PIC X(10).
  6821         16  AM-USER-SELECT-2              PIC X(10).
  6822         16  AM-USER-SELECT-3              PIC X(10).
  6823         16  AM-USER-SELECT-4              PIC X(10).
  6824         16  AM-USER-SELECT-5              PIC X(10).
  6825
  6826     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6827
  6828     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6829
  6830     12  AM-RPT045A-SWITCH                 PIC X.
  6831         88  RPT045A-OFF                   VALUE 'N'.
  6832
  6833     12  AM-INSURANCE-LIMITS.
  6834         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6835         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6836
  6837     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6838         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6839
  6840     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6841         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6842         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6843
  6844     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6845
  6846     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6847     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6848     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6849     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6850     12  AM-DCC-UEF-STATE                  PIC XX.
  6851     12  FILLER                            PIC XXX.
  6852     12  AM-REPORT-CODE-3                  PIC X(10).
  6853*    12  FILLER                            PIC X(22).
  6854
  6855     12  AM-RESERVE-DATE.
  6856         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6857         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6858         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6859
  6860     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6861     12  AM-NOTIFICATION-TYPES.
  6862         16  AM-NOTIF-OF-LETTERS           PIC X.
  6863         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6864         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 126
* EL050.cbl
  6865         16  AM-NOTIF-OF-STATUS            PIC X.
  6866
  6867     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6868         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6869         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6870         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6871         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6872
  6873     12  AM-BENEFIT-CONTROLS.
  6874         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6875             20  AM-BENEFIT-CODE           PIC XX.
  6876             20  AM-BENEFIT-TYPE           PIC X.
  6877             20  AM-BENEFIT-REVISION       PIC XXX.
  6878             20  AM-BENEFIT-REM-TERM       PIC X.
  6879             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6880             20  FILLER                    PIC XX.
  6881         16  FILLER                        PIC X(80).
  6882
  6883     12  AM-TRANSFER-DATA.
  6884         16  AM-TRANSFERRED-FROM.
  6885             20  AM-TRNFROM-CARRIER        PIC X.
  6886             20  AM-TRNFROM-GROUPING.
  6887                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6888                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6889             20  AM-TRNFROM-STATE          PIC XX.
  6890             20  AM-TRNFROM-ACCOUNT.
  6891                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6892                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6893             20  AM-TRNFROM-DTE            PIC XX.
  6894         16  AM-TRANSFERRED-TO.
  6895             20  AM-TRNTO-CARRIER          PIC X.
  6896             20  AM-TRNTO-GROUPING.
  6897                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6898                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6899             20  AM-TRNTO-STATE            PIC XX.
  6900             20  AM-TRNTO-ACCOUNT.
  6901                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6902                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6903             20  AM-TRNTO-DTE              PIC XX.
  6904         16  FILLER                        PIC X(10).
  6905
  6906     12  AM-SAVED-REMIT-TO                 PIC 99.
  6907
  6908     12  AM-COMM-STRUCTURE-SAVED.
  6909         16  AM-DEFN-1-SAVED.
  6910             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6911                 24  AM-AGT-SV             PIC X(10).
  6912                 24  AM-COM-TYP-SV         PIC X.
  6913                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6914                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6915                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6916                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6917                 24  FILLER                PIC X.
  6918                 24  AM-GL-CODES-SV        PIC X.
  6919                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6920                 24  FILLER                PIC X.
  6921         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6922             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 127
* EL050.cbl
  6923                 24  FILLER                PIC X(11).
  6924                 24  AM-L-COMA-SV          PIC XXX.
  6925                 24  AM-J-COMA-SV          PIC XXX.
  6926                 24  AM-A-COMA-SV          PIC XXX.
  6927                 24  FILLER                PIC X(6).
  6928
  6929     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6930         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6931            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6932            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6933            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6934
  6935     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6936     12  FILLER                            PIC X(120).
  6937
  6938     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6939         16  AM-CONTROL-NAME               PIC X(30).
  6940         16  AM-EXECUTIVE-ONE.
  6941             20  AM-EXEC1-NAME             PIC X(15).
  6942             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6943                                                          COMP-3.
  6944             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6945                                                          COMP-3.
  6946         16  AM-EXECUTIVE-TWO.
  6947             20  AM-EXEC2-NAME             PIC X(15).
  6948             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6949                                                          COMP-3.
  6950             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6951                                                          COMP-3.
  6952
  6953     12  AM-RETRO-ADDITIONAL-DATA.
  6954         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6955         16  AM-RETRO-PREM-P-E             PIC X.
  6956         16  AM-RETRO-CLMS-P-I             PIC X.
  6957         16  AM-RETRO-RET-BRACKET-LF.
  6958             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6959                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6960                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6961             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6962                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6963                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6964             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6965                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6966                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6967         16  AM-RETRO-RET-BRACKET-AH.
  6968             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6969                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6970                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6971                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6972             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6973                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6974                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6975             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6976                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6977                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6978
  6979     12  AM-COMMENTS.
  6980         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 128
* EL050.cbl
  6981
  6982     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6983         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6984         16  AM-FLI-BILLING-CODE           PIC X.
  6985         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6986         16  AM-FLI-UNITED-IDENT           PIC X.
  6987         16  AM-FLI-INTEREST-LOST-DATA.
  6988             20  AM-FLI-BANK-NO            PIC X(5).
  6989             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6990             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6991             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6992         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6993             20  AM-FLI-AGT                PIC X(9).
  6994             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6995             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6996         16  FILLER                        PIC X(102).
  6997
  6998     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6999         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  7000             20  AM-BENEFIT-DMD-CODE         PIC XX.
  7001             20  AM-BENEFIT-DMD-TYPE         PIC X.
  7002             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  7003             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  7004             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  7005         16  FILLER                          PIC X(10).
  7006******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 129
* EL050.cbl
  7008*    COPY ERCREIN.
  7009******************************************************************
  7010*                                                                *
  7011*                            ERCREIN                             *
  7012*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7013*                            VMOD=2.010                          *
  7014*                                                                *
  7015*   ONLINE CREDIT SYSTEM                                         *
  7016*                                                                *
  7017*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  7018*                                                                *
  7019*   FILE TYPE = VSAM,KSDS                                        *
  7020*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  7021*                                                                *
  7022*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  7023*       ALTERNATE PATH = NONE                                    *
  7024*                                                                *
  7025*   LOG = NO                                                     *
  7026*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7027*                                                                *
  7028******************************************************************
  7029*                   C H A N G E   L O G
  7030*
  7031* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7032*-----------------------------------------------------------------
  7033*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7034* EFFECTIVE    NUMBER
  7035*-----------------------------------------------------------------
  7036* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  7037* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  7038******************************************************************
  7039 01  REINSURANCE-RECORD.
  7040     12  RE-RECORD-ID                      PIC XX.
  7041         88  VALID-RE-ID                      VALUE 'RE'.
  7042
  7043     12  RE-CONTROL-PRIMARY.
  7044         16  RE-COMPANY-CD                 PIC X.
  7045         16  RE-KEY.
  7046             20  RE-CODE                   PIC X.
  7047                 88  RE-TABLE-RECORD          VALUE 'A'.
  7048                 88  RE-COMPANY-RECORD        VALUE 'B'.
  7049             20  RE-TABLE                  PIC XXX.
  7050             20  FILLER                    PIC XXX.
  7051         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  7052             20  FILLER                    PIC X.
  7053             20  RE-COMPANY.
  7054                 24  RE-COMP-PRIME         PIC XXX.
  7055                 24  RE-COMP-SUB           PIC XXX.
  7056
  7057     12  RE-MAINT-INFORMATION.
  7058         16  RE-LAST-MAINT-DT              PIC XX.
  7059         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7060         16  RE-LAST-MAINT-USER            PIC X(4).
  7061         16  FILLER                        PIC X(10).
  7062
  7063     12  RE-TABLE-DATA.
  7064         16  RE-100-COMP                   PIC 99.
  7065
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 130
* EL050.cbl
  7066         16  RE-COMP-INFO    OCCURS 30 TIMES.
  7067             20  RE-REI-COMP-NO.
  7068                 24  RE-REI-COMP           PIC XXX.
  7069                 24  RE-REI-COMP-SUB       PIC XXX.
  7070             20  RE-LF-QC                  PIC X.
  7071             20  RE-AH-QC                  PIC X.
  7072             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  7073             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  7074             20  RE-LFAGE-LO               PIC 99.
  7075             20  RE-LFAGE-HI               PIC 99.
  7076             20  RE-AHAGE-LO               PIC 99.
  7077             20  RE-AHAGE-HI               PIC 99.
  7078             20  RE-LFTRM-LO               PIC S999       COMP-3.
  7079             20  RE-LFTRM-HI               PIC S999       COMP-3.
  7080             20  RE-AHTRM-LO               PIC S999       COMP-3.
  7081             20  RE-AHTRM-HI               PIC S999       COMP-3.
  7082             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  7083             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  7084             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  7085             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  7086             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  7087             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  7088             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  7089             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  7090             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  7091             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  7092             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  7093             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  7094             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  7095             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  7096             20  RE-LF-BEN-CODE            PIC X.
  7097             20  RE-AH-BEN-CODE            PIC X.
  7098             20  RE-INTERACTIVE            PIC X.
  7099             20  RE-REMAINING              PIC X.
  7100             20  RE-LF-RUNOFF-SW           PIC X.
  7101             20  RE-AH-RUNOFF-SW           PIC X.
  7102             20  FILLER                    PIC X(19).
  7103
  7104         16  RE-COMP-INFO-END              PIC X(6).
  7105         16  RE-NSP-ST-CD-LF               PIC XX.
  7106         16  RE-NSP-ST-CD-AH               PIC XX.
  7107         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  7108             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  7109
  7110         16  FILLER                        PIC X(27).
  7111
  7112     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  7113         16  RE-NAME                       PIC X(30).
  7114         16  RE-LF-PE                      PIC X.
  7115         16  RE-AH-PE                      PIC X.
  7116         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  7117         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  7118         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  7119         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  7120         16  RE-PRT-ST                     PIC X.
  7121         16  RE-PRT-OW                     PIC X.
  7122         16  RE-MORT-CODE                  PIC X(4).
  7123         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 131
* EL050.cbl
  7124         16  RE-ZERO-LF-FEE                PIC X.
  7125         16  RE-ZERO-AH-FEE                PIC X.
  7126         16  RE-CEDE-NAME                  PIC X(30).
  7127         16  RE-LF-COMM                    PIC X.
  7128         16  RE-AH-COMM                    PIC X.
  7129         16  RE-LF-TAX                     PIC X.
  7130         16  RE-AH-TAX                     PIC X.
  7131         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  7132         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  7133         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  7134
  7135         16  RE-COMP-CARRIER-SECURITY      PIC X.
  7136             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  7137
  7138         16  RE-LF-CEDING-FEE-BRACKETS.
  7139             20  RE-LF-FEE-METHOD          PIC X.
  7140                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  7141                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  7142                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  7143                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  7144             20  RE-LF-FEE-BASIS           PIC X.
  7145                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  7146                 88  RE-LF-NET-CEDED               VALUE '2'.
  7147                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  7148                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  7149                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  7150                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  7151                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7152                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  7153             20  FILLER                    PIC XXX.
  7154             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  7155                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7156                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7157
  7158         16  RE-AH-CEDING-FEE-BRACKETS.
  7159             20  RE-AH-FEE-METHOD          PIC X.
  7160                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  7161                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  7162                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  7163                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  7164             20  RE-AH-FEE-BASIS           PIC X.
  7165                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  7166                 88  RE-AH-NET-CEDED               VALUE '2'.
  7167                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  7168                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  7169                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  7170                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  7171                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  7172                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  7173             20  FILLER                    PIC XXX.
  7174             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  7175                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  7176                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  7177
  7178         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  7179
  7180         16  RE-OLD-CEDING-STMT            PIC X.
  7181
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 132
* EL050.cbl
  7182         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  7183         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  7184         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7185         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  7186         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  7187         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  7188         16  RE-REINS-GROUPING-CODE        PIC X(6).
  7189         16  RE-MORT-SW                    PIC X.
  7190         16  RE-CEDING-TYPE-FLAG           PIC X.
  7191             88  RE-NO-CESSION-TYPE                VALUE ' '.
  7192             88  RE-CEDED                          VALUE 'C'.
  7193             88  RE-ASSUMED                        VALUE 'A'.
  7194             88  RE-PHANTOM                        VALUE 'P'.
  7195
  7196         16  RE-CEDING-STMT-OPT-A          PIC X.
  7197             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  7198         16  RE-CEDING-STMT-OPT-B          PIC X.
  7199             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  7200         16  RE-CEDING-STMT-OPT-C          PIC X.
  7201             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  7202         16  RE-CEDING-STMT-OPT-D          PIC X.
  7203             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  7204         16  RE-CEDING-STMT-OPT-E          PIC X.
  7205             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  7206
  7207         16  RE-PRT-CRSV                   PIC X.
  7208
  7209         16  RE-GL-CENTER                  PIC X(4).
  7210
  7211         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  7212
  7213         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  7214
  7215         16  RE-EARN-STOP-CODE             PIC X.
  7216             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  7217             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  7218
  7219         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  7220             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  7221
  7222         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  7223         16  FILLER                        PIC X(2281).
  7224
  7225         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  7226
  7227******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 133
* EL050.cbl
  7229*    COPY ERCCTBL.
  7230******************************************************************
  7231*                                                                *
  7232*                                                                *
  7233*                            ERCCTBL                             *
  7234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7235*                            VMOD=2.003
  7236*                                                                *
  7237*   ONLINE CREDIT SYSTEM                                         *
  7238*                                                                *
  7239*   FILE DESCRIPTION = COMPENSATION TABLE                        *
  7240*                                                                *
  7241*   FILE TYPE = VSAM,KSDS                                        *
  7242*   RECORD SIZE = 200   RECFORM = FIXED                          *
  7243*                                                                *
  7244*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *
  7245*       ALTERNATE PATH = NONE                                    *
  7246*                                                                *
  7247*   LOG = NO                                                     *
  7248*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7249*                                                                *
  7250*                                                                *
  7251******************************************************************
  7252
  7253 01  COMM-TABLE-RECORD.
  7254     12  CT-RECORD-ID                      PIC XX.
  7255         88  VALID-CT-ID                      VALUE 'CT'.
  7256
  7257     12  CT-CONTROL-PRIMARY.
  7258         16  CT-COMPANY-CD                 PIC X.
  7259         16  CT-TABLE                      PIC XXX.
  7260         16  CT-CNTRL-2.
  7261             20  CT-BEN-TYPE               PIC X.
  7262             20  CT-BEN-CODE               PIC XX.
  7263
  7264     12  CT-MAINT-INFORMATION.
  7265         16  CT-LAST-MAINT-DT              PIC XX.
  7266         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  7267         16  CT-LAST-MAINT-USER            PIC X(4).
  7268         16  FILLER                        PIC X(31).
  7269
  7270     12  CT-LIMITS.
  7271         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3.
  7272
  7273         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3.
  7274
  7275         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3.
  7276
  7277     12  CT-RATES.
  7278         16  CT-RTX          OCCURS 27 TIMES.
  7279             20  CT-RT                     PIC SV9(5)     COMP-3.
  7280             20  CT-RT-R   REDEFINES
  7281                 CT-RT                     PIC XXX.
  7282
  7283     12  FILLER                            PIC  X(42).
  7284
  7285******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 134
* EL050.cbl
  7287*    COPY ERCFORM.
  7288******************************************************************
  7289*                                                                *
  7290*                                                                *
  7291*                            ERCFORM.                            *
  7292*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7293*                            VMOD=2.003                          *
  7294*                                                                *
  7295*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  7296*                                                                *
  7297*    FILE TYPE = VSAM,KSDS                                       *
  7298*    RECORD SIZE = 500  RECFORM = FIXED                          *
  7299*                                                                *
  7300*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  7301*                                                                *
  7302*    LOG = YES                                                   *
  7303*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7304******************************************************************
  7305 01  FORM-MASTER.
  7306    12  FO-RECORD-ID                 PIC X(02).
  7307        88  VALID-FO-ID                  VALUE 'FO'.
  7308
  7309    12  FO-CONTROL-PRIMARY.
  7310        16  FO-COMPANY-CD            PIC X(01).
  7311        16  FO-STATE                 PIC X(02).
  7312        16  FO-FORM-ID               PIC X(12).
  7313        16  FO-FORM-EXP-DT           PIC X(02).
  7314
  7315    12  FO-POLICY-FORM-DATA.
  7316        16  FO-IND-GRP-CD            PIC X(01).
  7317        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  7318        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7319        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  7320        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7321        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  7322        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  7323        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  7324        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  7325        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  7326        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  7327        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7328        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  7329        16  FO-DIS-DEF-TYPE          PIC 9(02).
  7330        16  FO-DISMEMBERMENT-CD      PIC X(01).
  7331        16  FO-APP-CERT-USE-CD       PIC X(01).
  7332
  7333    12  FILLER                       PIC X(29).
  7334
  7335    12  FO-FORM-PLAN-TABLE.
  7336        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  7337            20  FO-PLAN-TYPE         PIC X(01).
  7338            20  FO-PLAN-ID           PIC X(02).
  7339            20  FO-PLAN-TERM         PIC 9(03).
  7340            20  FO-PLAN-REFUND-METHOD
  7341                                     PIC X.
  7342
  7343    12  FILLER                       PIC X(30).
  7344
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 135
* EL050.cbl
  7345    12  FO-COMMENTS-AREA.
  7346        16  FO-COMMENT-LINE-1        PIC X(78).
  7347
  7348    12  FILLER                       PIC X(20).
  7349
  7350    12  FO-MAINT-INFORMATION.
  7351        16  FO-LAST-MAINT-DT         PIC X(02).
  7352        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  7353        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 136
* EL050.cbl
  7355*    COPY ELCMSTR.
  7356******************************************************************
  7357*                                                                *
  7358*                            ELCMSTR.                            *
  7359*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7360*                            VMOD=2.012                          *
  7361*                                                                *
  7362*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7363*                                                                *
  7364*   FILE TYPE = VSAM,KSDS                                        *
  7365*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7366*                                                                *
  7367*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7368*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7369*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7370*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7371*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7372*                                                 RKP=75,LEN=21  *
  7373*                                                                *
  7374*   **** NOTE ****                                               *
  7375*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7376*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7377*                                                                *
  7378*   LOG = YES                                                    *
  7379*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7380******************************************************************
  7381*                   C H A N G E   L O G
  7382*
  7383* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7384*-----------------------------------------------------------------
  7385*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7386* EFFECTIVE    NUMBER
  7387*-----------------------------------------------------------------
  7388* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7389* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7390* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7391* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7392* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7393******************************************************************
  7394 01  CLAIM-MASTER.
  7395     12  CL-RECORD-ID                PIC XX.
  7396         88  VALID-CL-ID         VALUE 'CL'.
  7397
  7398     12  CL-CONTROL-PRIMARY.
  7399         16  CL-COMPANY-CD           PIC X.
  7400         16  CL-CARRIER              PIC X.
  7401         16  CL-CLAIM-NO             PIC X(7).
  7402         16  CL-CERT-NO.
  7403             20  CL-CERT-PRIME       PIC X(10).
  7404             20  CL-CERT-SFX         PIC X.
  7405
  7406     12  CL-CONTROL-BY-NAME.
  7407         16  CL-COMPANY-CD-A1        PIC X.
  7408         16  CL-INSURED-LAST-NAME    PIC X(15).
  7409         16  CL-INSURED-NAME.
  7410             20  CL-INSURED-1ST-NAME PIC X(12).
  7411             20  CL-INSURED-MID-INIT PIC X.
  7412
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 137
* EL050.cbl
  7413     12  CL-CONTROL-BY-SSN.
  7414         16  CL-COMPANY-CD-A2        PIC X.
  7415         16  CL-SOC-SEC-NO.
  7416             20  CL-SSN-STATE        PIC XX.
  7417             20  CL-SSN-ACCOUNT      PIC X(6).
  7418             20  CL-SSN-LN3          PIC X(3).
  7419
  7420     12  CL-CONTROL-BY-CERT-NO.
  7421         16  CL-COMPANY-CD-A4        PIC X.
  7422         16  CL-CERT-NO-A4.
  7423             20  CL-CERT-A4-PRIME    PIC X(10).
  7424             20  CL-CERT-A4-SFX      PIC X.
  7425
  7426     12  CL-CONTROL-BY-CCN.
  7427         16  CL-COMPANY-CD-A5        PIC X.
  7428         16  CL-CCN-A5.
  7429             20  CL-CCN.
  7430                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7431                 24  CL-CCN-PRIME-A5 PIC X(12).
  7432             20  CL-CCN-FILLER-A5    PIC X(4).
  7433
  7434     12  CL-INSURED-PROFILE-DATA.
  7435         16  CL-INSURED-BIRTH-DT     PIC XX.
  7436         16  CL-INSURED-SEX-CD       PIC X.
  7437             88  INSURED-IS-MALE        VALUE 'M'.
  7438             88  INSURED-IS-FEMALE      VALUE 'F'.
  7439             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7440         16  CL-INSURED-OCC-CD       PIC X(6).
  7441         16  FILLER                  PIC X(5).
  7442
  7443     12  CL-PROCESSING-INFO.
  7444         16  CL-PROCESSOR-ID         PIC X(4).
  7445         16  CL-CLAIM-STATUS         PIC X.
  7446             88  CLAIM-IS-OPEN          VALUE 'O'.
  7447             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7448         16  CL-CLAIM-TYPE           PIC X.
  7449*            88  AH-CLAIM               VALUE 'A'.
  7450*            88  LIFE-CLAIM             VALUE 'L'.
  7451*            88  PROPERTY-CLAIM         VALUE 'P'.
  7452*            88  IUI-CLAIM              VALUE 'I'.
  7453*            88  GAP-CLAIM              VALUE 'G'.
  7454*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7455         16  CL-CLAIM-PREM-TYPE      PIC X.
  7456             88  SINGLE-PREMIUM         VALUE '1'.
  7457             88  O-B-COVERAGE           VALUE '2'.
  7458             88  OPEN-END-COVERAGE      VALUE '3'.
  7459         16  CL-INCURRED-DT          PIC XX.
  7460         16  CL-REPORTED-DT          PIC XX.
  7461         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7462         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7463         16  CL-LAST-PMT-DT          PIC XX.
  7464         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7465         16  CL-PAID-THRU-DT         PIC XX.
  7466         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7467         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7468         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7469         16  CL-PMT-CALC-METHOD      PIC X.
  7470             88  CL-360-DAY-YR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 138
* EL050.cbl
  7471             88  CL-365-DAY-YR          VALUE '2'.
  7472             88  CL-FULL-MONTHS         VALUE '3'.
  7473         16  CL-CAUSE-CD             PIC X(6).
  7474
  7475         16  CL-PRIME-CERT-NO.
  7476             20  CL-PRIME-CERT-PRIME PIC X(10).
  7477             20  CL-PRIME-CERT-SFX   PIC X.
  7478
  7479         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7480             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7481             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7482
  7483         16  CL-MICROFILM-NO         PIC X(10).
  7484         16  FILLER REDEFINES CL-MICROFILM-NO.
  7485             20  CL-BENEFIT-PERIOD   PIC 99.
  7486             20  FILLER              PIC X(8).
  7487         16  CL-PROG-FORM-TYPE       PIC X.
  7488         16  CL-LAST-ADD-ON-DT       PIC XX.
  7489
  7490         16  CL-LAST-REOPEN-DT       PIC XX.
  7491         16  CL-LAST-CLOSE-DT        PIC XX.
  7492         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7493             88  FINAL-PAID             VALUE '1'.
  7494             88  CLAIM-DENIED           VALUE '2'.
  7495             88  AUTO-CLOSE             VALUE '3'.
  7496             88  MANUAL-CLOSE           VALUE '4'.
  7497             88  BENEFITS-CHANGED       VALUE 'C'.
  7498             88  SETUP-ERRORS           VALUE 'E'.
  7499         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7500         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7501         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7502             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7503         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7504         16  FILLER                  PIC X.
  7505
  7506     12  CL-CERTIFICATE-DATA.
  7507         16  CL-CERT-ORIGIN          PIC X.
  7508             88  CERT-WAS-ONLINE        VALUE '1'.
  7509             88  CERT-WAS-CREATED       VALUE '2'.
  7510             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7511         16  CL-CERT-KEY-DATA.
  7512             20  CL-CERT-CARRIER     PIC X.
  7513             20  CL-CERT-GROUPING    PIC X(6).
  7514             20  CL-CERT-STATE       PIC XX.
  7515             20  CL-CERT-ACCOUNT.
  7516                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7517                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7518             20  CL-CERT-EFF-DT      PIC XX.
  7519
  7520     12  CL-STATUS-CONTROLS.
  7521         16  CL-PRIORITY-CD          PIC X.
  7522             88  CONFIDENTIAL-DATA      VALUE '8'.
  7523             88  HIGHEST-PRIORITY       VALUE '9'.
  7524         16  CL-SUPV-ATTN-CD         PIC X.
  7525             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7526             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7527         16  CL-PURGED-DT            PIC XX.
  7528         16  CL-RESTORED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 139
* EL050.cbl
  7529         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7530         16  CL-NEXT-RESEND-DT       PIC XX.
  7531         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7532         16  CL-CRITICAL-PERIOD      PIC 99.
  7533*        16  FILLER                  PIC XX.
  7534         16  CL-LAST-MAINT-DT        PIC XX.
  7535         16  CL-LAST-MAINT-USER      PIC X(4).
  7536         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7537         16  CL-LAST-MAINT-TYPE      PIC X.
  7538             88  CLAIM-SET-UP           VALUE ' '.
  7539             88  PAYMENT-MADE           VALUE '1'.
  7540             88  LETTER-SENT            VALUE '2'.
  7541             88  MASTER-WAS-ALTERED     VALUE '3'.
  7542             88  MASTER-WAS-RESTORED    VALUE '4'.
  7543             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7544             88  FILE-CONVERTED         VALUE '6'.
  7545             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7546             88  ERROR-CORRECTION       VALUE 'E'.
  7547         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7548         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7549         16  CL-BENEFICIARY          PIC X(10).
  7550         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7551         16  CL-DENIAL-TYPE          PIC X.
  7552             88  CL-TYPE-DENIAL          VALUE '1'.
  7553             88  CL-TYPE-RESCISSION      VALUE '2'.
  7554             88  CL-TYPE-REFORMATION     VALUE '3'.
  7555             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7556             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7557         16  filler                  pic x(5).
  7558*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7559*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7560*        16  CL-RTW-DT               PIC XX.
  7561
  7562     12  CL-TRAILER-CONTROLS.
  7563         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7564             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7565             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7566             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7567         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7568         16  FILLER                  PIC XX.
  7569         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7570         16  CL-ADDRESS-TRAILER-CNT.
  7571             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7572                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7573             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7574                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7575             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7576                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7577             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7578                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7579             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7580                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7581             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7582                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7583             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7584                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7585
  7586     12  CL-CV-REFERENCE-NO.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 140
* EL050.cbl
  7587         16  CL-CV-REFNO-PRIME       PIC X(18).
  7588         16  CL-CV-REFNO-SFX         PIC XX.
  7589
  7590     12  CL-FILE-LOCATION            PIC X(4).
  7591
  7592     12  CL-PROCESS-ERRORS.
  7593         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7594             88  NO-FATAL-ERRORS        VALUE ZERO.
  7595         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7596             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7597
  7598     12  CL-PRODUCT-CD               PIC X.
  7599
  7600     12  CL-CURRENT-KEY-DATA.
  7601         16  CL-CURRENT-CARRIER      PIC X.
  7602         16  CL-CURRENT-GROUPING     PIC X(6).
  7603         16  CL-CURRENT-STATE        PIC XX.
  7604         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7605
  7606     12  CL-ASSOCIATES               PIC X.
  7607         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7608         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7609         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7610         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7611
  7612     12  CL-ACTIVITY-CODE            PIC 99.
  7613     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7614     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7615
  7616     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7617     12  CL-LAG-REPORT-CODE          PIC 9.
  7618     12  CL-LOAN-TYPE                PIC XX.
  7619     12  CL-LEGAL-STATE              PIC XX.
  7620
  7621     12  CL-YESNOSW                  PIC X.
  7622     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7623         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7624         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7625         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7626     12  cl-insured-type             pic x.
  7627         88  cl-claim-on-primary         value 'P'.
  7628         88  cl-claim-on-co-borrower     value 'C'.
  7629     12  cl-benefit-expiration-dt    PIC XX.
  7630
  7631 01  PLAN-RECORDS.
  7632     12  LINK-LIFE-PLAN-RECORD   PIC X(420).
  7633     12  LINK-AH-PLAN-RECORD     PIC X(420).
  7634
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 141
* EL050.cbl
  7636 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE
  7637                          ACCOUNT-MASTER REINSURANCE-RECORD
  7638                          COMM-TABLE-RECORD FORM-MASTER
  7639                          CLAIM-MASTER PLAN-RECORDS.
  7640 0000-DFHEXIT SECTION.
  7641     MOVE '9#                    $   ' TO DFHEIV0.
  7642     MOVE 'EL050' TO DFHEIV1.
  7643     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7644
  7645     MOVE DFHCOMMAREA            TO  PENDING-BUSINESS.
  7646
  7647
  7648* EXEC CICS  HANDLE CONDITION
  7649*           ERROR    (9300-ABEND)
  7650*           NOTOPEN  (3990-FILES-NOT-OPEN)
  7651*    END-EXEC.
  7652*    MOVE '"$.J                  ! " #00007643' TO DFHEIV0
  7653     MOVE X'22242E4A2020202020202020' TO DFHEIV0(1:12)
  7654     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7655     MOVE X'2220233030303037363433' TO DFHEIV0(25:11)
  7656     CALL 'kxdfhei1' USING DFHEIV0
  7657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7658
  7659
  7660 0000-COPY-PROCEDURE-DIV.
  7661*                          COPY ELC50PD.
  7662******************************************************************
  7663*                                                                *
  7664*                            ELC50PD                             *
  7665*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7666*                            VMOD=2.188                          *
  7667*                                                                *
  7668******************************************************************
  7669*                   C H A N G E   L O G
  7670*
  7671* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7672*-----------------------------------------------------------------
  7673*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7674* EFFECTIVE    NUMBER
  7675*-----------------------------------------------------------------
  7676* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7677* 123102                   PEMA  ADD ER-2721 FOR QUICKCALC (I/G)
  7678* 082003  CR2002100700004  PEMA  ADD PROCESSING FOR ERRORS 2702,
  7679*                             2709 AND 2718
  7680* 082203  CR2003040800006  PEMA  ADD PROCESSING FOR ERROR 2722
  7681* 100703  CR2003080800002  PEMA  ADD SUPER GAP PROCESSING
  7682* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7683* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  7684* 062904    2004020600012  PEMA  ON CANCELS, CHECK TO SEE IF CLAIM
  7685*                                IS OPEN OR CNC DT < PD THRU
  7686* 111504    2004110300005  PEMA  SPLIT SPP BANK COMMISSION
  7687* 121304  CR2004110200005  PEMA  ADD EDIT FOR NON SPP DEV PCT
  7688* 011305                   PEMA  CHNG EDIT ON APR PER JJVA.
  7689* 061405                   PEMA  ADD CLP STATE PROCESS FOR DCC
  7690* 070705  CR2005040700001  PEMA  MOVE TOTAL FEE TO AH CALC
  7691* 071305  CR2005011100006  PEMA  ADD MAX PREMIUM EDIT
  7692* 080805  CR2005031100002  PEMA  ADD EDIT FOR GA INACTIVE
  7693* 083005  IR2005063000004  PEMA  ALTER REM TERM MTHD FOR WI
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 142
* EL050.cbl
  7694* 092205  CR2005050300006  PEMA  ADD SPP LEASES
  7695* 093005  CR2005082500004  PEMA  RUN "M" CERTS THRU FULL EDIT
  7696* 020906                   PEMA  EXPAND LOAN OFFICER
  7697* 042106  CR2006021300001  PEMA  ADD PROCESSING FOR GA EFF DATE
  7698* 050506  CR2006033000001  PEMA  ADD EDIT FOR SPACES ON CERT NO
  7699* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
  7700* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
  7701* 083106  CR2006063000001  PEMA  ADD LOAN OFFICER FIELD EDIT
  7702* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
  7703* 102706  CR2006052600003  PEMA  ADD SIG SW PROCESSING FOR CID
  7704* 030807  CR2007022000001  PEMA  EDIT FOR NON NUMERICS ON CERT NO
  7705* 040407  CR2007010300001  PEMA  GO AROUND CT CODE
  7706* 061207  CR2006062600002  PEMA  ADD APR EDIT FOR S BENCODES
  7707* 062707  CR2006050800002  PEMA  CHANGE J TYPE TO I TYPE
  7708* 062907  CR2006080800002  PEMA  INIT FIELDS USED FOR VIN CALC
  7709* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7710* 122807  CR2007010300002  PEMA  CHG VIN EDIT TO ISSUE ONLY
  7711* 040708  CR2007083100002  PEMA  ADD FREEZE STATUS
  7712* 050508  CR2008010200004  PEMA  FIX MO REFUNDING
  7713* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7714* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7715* 090408  CR2008081900002  PEMA  UPDATE MO REFUNDING
  7716* 102908    2007091400001  PEMA  ADD ERROR FOR LEVEL > 1 MO TO 1ST
  7717* 012909  CR2009010500003  PEMA  ADD EDIT FOR REF > 0 FOR ADDENDUM
  7718* 030309  CR2009021700001  PEMA  ADD EDIT FOR BENE AND INS ADDR
  7719* 030509  CR2008050500001  AJRA  ADD CCC CARRIER 6 TO VIN EDIT
  7720* 042709  CR2009032000001  PEMA  CHG ATT AGE EDITING
  7721* 050509  CR2009031600001  AJRA  USE EFF DT TO CALC EXP DT FOR BIU
  7722*                                UPDATE VIN ON CERT TRAILER
  7723* 061009    2008042300002  PEMA  BYPASS ER 2681 FOR FARM PLANS
  7724* 072109  CR2008111300003  AJRA  FIX MSG JOINT AGE OVER 55 ON DISA
  7725* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7726* 101509  CR2009062900001  PEMA  HANDLE NON NUMERIC ISSUES
  7727* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7728* 022210  CR2009090400001  PEMA  ADD VALIDATION FOR NAME FIELDS
  7729* 022510  IR2010022400002  PEMA  MAKE 55 AND 56 CODING FOR DCC ONL
  7730* 040610  IR2010030800001  PEMA  INIT Alternate BENEFIT
  7731* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  7732* 042310  CR2009061500002  AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7733* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
  7734* 080310  CR2010042900001  PEMA  SEPARATE CITY AND STATE
  7735* 091610  CR2010061500001  PEMA  USE TOTAL BENE FOR RATING BENEFIT
  7736* 111610  CR2010010400006  PEMA  ADD BALLOON/AUTO DLR EDIT
  7737* 012711  CR2011010400001  PEMA  CORRECT EXP DT CALC ON FARM LOANS
  7738* 020711  CR2010032500001  PEMA  ADDED NEW LOAN TERM EDIT
  7739* 020711  CR2010032900001  PEMA  ADDED NEW ATTAINED AGE EDIT
  7740* 031611  CR2011030300001  PEMA  REMOVE ERROR 2671
  7741* 031611  CR2011030300002  PEMA  ADD EDIT FOR TERM ON JT COVERAGE
  7742* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  7743* 040811  CR2010030900001  AJRA  CANCELS WITH CLAIMS PROCESS
  7744* 041811  CR2010030900001  AJRA  REMOVE ERROR 2727
  7745* 050311  IR2011050300001  AJRA  FIX MSG FOR RESCINDED COVERAGE
  7746* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7747* 071311  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
  7748* 072111  IR2011072100001  PEMA  FIX ATT AGE ERROR 2669
  7749* 083111    2011083100001  PEMA  CORRECT MAX TOT BEN
  7750* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  7751* 110811  CR2011083000003  PEMA  GROSS EDIT FOR SPPDDF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 143
* EL050.cbl
  7752* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  7753* 120511  IR2011120200002  PEMA  CORRECT DCC TRUNCATED ISSUD
  7754* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
  7755* 032912  CR2011110200001  PEMA  AHL CHANGES
  7756* 040512  IR2012040500002  PEMA  REMOVE NUM CERTNO EDIT FOR AHL
  7757* 041012  IR2012041000004  AJRA  BYPASS MSG ON AHL REISSUE
  7758* 042012  CR2011110200001  PEMA  BYPASS ERROR 2787 FOR AHL ONLY
  7759* 080712  CR201208XX0000X  PEMA  MODIFY CLP ST PROCESSING FOR DCC
  7760* 081612  CR2011062300001  PEMA  REMOVE EXT DAY CHG FOR REFUNDS
  7761* 091012  CR2012090700001  PEMA  INCREASE EDIT TO $3,000
  7762* 111212  CR2011083000003  PEMA  REMOVE ERROR FOR SPEC CALC CD E
  7763* 112612  IR2012060600001  AJRA  EDIT APR ON S TYPE DISAB ONLY COV
  7764* 010713  IR2012112000001  PEMA  USE NEW CLASS CODES FOR AHL
  7765* 011513  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7766* 012213  CR2013011600001  PEMA  ADD ERROR 3058 AND MOD 2648
  7767* 022513  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  7768* 031513  CR2012100500002  PEMA  CORRECT TOL PCT PROCESS
  7769* 032013  IR2013031900001  PEMA  CORRECT DEFAULT SETTING ON TOL.
  7770* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  7771* 081613  CR2013072300001  PEMA  USE EXP DT TO EDIT CANC DTE.
  7772* 101614  IR2013090600001  PEMA  SET INTERFACE-SW-2 IF NOT SET
  7773* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
  7774* 120213  CR2013112500001  PEMA  Correct address edit - 2694
  7775* 021714  CR2013080900002  PEMA  ADD ERROR FOR DEFAULT AGE
  7776* 032714  CR2012121800001  AJRA  MSG FOR NO ADDRESS ON INSURED
  7777* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7778* 052114  IR2014042900002  PEMA  CORRECT CANCEL EDIT ON VOIDS
  7779* 051914  CR2014043000002  TANA  ADD CAUSAL STATE
  7780* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  7781* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  7782* 100114  IR2014100100003  TANA  CHANGE 2890 EDIT FOR EXACT MATCH
  7783*                                CERT #, ADD 2898 FORCIBLE ERROR
  7784* 100214  IR2014100100002  PEMA  CHG WAY CAR7 CLP IS CALCED
  7785* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  7786* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
  7787* 121815  CR2015121700006  PEMA  ADD ERROR 3827 (foreign vin)
  7788* 010416  CR2015082600001  PEMA  ADD CID and DCC TO MON CODE
  7789* 010816  IR2015092900001  PEMA  USE CLP STATE WHERE NEEDED
  7790******************************************************************
  7791************* PROCEDURE DIVISION FOR EL050 & EL517 ***************
  7792******************************************************************
  7793
  7794     INITIALIZE  WS-CRI-SSN-WORK-AREA.
  7795
  7796     MOVE SPACES                 TO PB-FATAL-FLAG
  7797                                    PB-FORCE-ER-CD
  7798                                    PB-WARN-ER-CD
  7799                                    PB-OUT-BAL-CD.
  7800
  7801     MOVE SPACE                  TO WS-IG-OVRD-AH
  7802                                    WS-IG-OVRD-LF
  7803                                    WS-IG-OVRD-AM
  7804                                    WS-IG-OVRD
  7805                                    WS-IG-OVRD-AH-PL
  7806                                    WS-IG-OVRD-LF-PL
  7807                                    WS-IG-OVRD-AH-BEN
  7808                                    WS-IG-OVRD-LF-BEN.
  7809
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 144
* EL050.cbl
  7810******************************************************************
  7811*************       INITIALIZE COMMON ERRORS       ***************
  7812******************************************************************
  7813
  7814     MOVE +0                     TO PB-NO-OF-ERRORS.
  7815     MOVE LOW-VALUES             TO PB-COMMON-ERRORS.
  7816
  7817******************************************************************
  7818
  7819     MOVE EIBDATE                TO DC-JULIAN-DATE.
  7820     SET JULIAN-TO-BIN           TO TRUE.
  7821*    MOVE 5                      TO DC-OPTION-CODE.
  7822     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7823     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  7824
  7825     MOVE ZERO                   TO  SUB4.
  7826
  7827 0040-INITIALIZE-GA-BILL-DT.
  7828
  7829     ADD +1                      TO  SUB4.
  7830
  7831     IF  SUB4 GREATER THAN +5
  7832         GO TO 0050-CHECK-CNTL-FOUND.
  7833
  7834     IF  PB-GA-BILL-DT (SUB4) = SPACES
  7835         MOVE LOW-VALUES         TO  PB-GA-BILL-DT (SUB4).
  7836
  7837     GO TO 0040-INITIALIZE-GA-BILL-DT.
  7838
  7839 0050-CHECK-CNTL-FOUND.
  7840
  7841     IF WK-CNTL-RECORD-FOUND-SW = 'Y'
  7842        MOVE WK-CR-REM-TERM-CALC      TO WS-LF-REM-TERM-CALC
  7843                                         WS-AH-REM-TERM-CALC
  7844                                         EC-CO-REM-TERM-CALC
  7845        MOVE WK-CR-R78-METHOD         TO WS-R78-METHOD
  7846        MOVE WK-CO-MAX-CAP            TO WS-COMP-MAX-CAP
  7847        MOVE WK-CO-TOL-CLAIM          TO WS-TOL-LF-CLAIM
  7848                                         WS-TOL-AH-CLAIM
  7849        MOVE WK-CO-TOL-PREM           TO WS-TOL-LF-PREM
  7850                                         WS-TOL-AH-PREM
  7851                                         EC-CO-TOL-PREM
  7852        MOVE WK-CO-TOL-REFUND         TO WS-TOL-LF-REFUND
  7853                                         WS-TOL-AH-REFUND
  7854                                         EC-CO-TOL-REFUND
  7855        MOVE WK-REFUND-OVS-AMT        TO WS-LF-REFUND-OVS-AMT
  7856                                         WS-AH-REFUND-OVS-AMT
  7857                                         EC-CO-OVR-SHT-AMT
  7858        MOVE WK-CO-TOL-PREM-PCT       TO WS-TOL-LF-PREM-PCT
  7859                                         WS-TOL-AH-PREM-PCT
  7860                                         EC-CO-TOL-PREM-PCT
  7861        MOVE WK-CO-TOL-REFUND-PCT     TO WS-TOL-LF-REFUND-PCT
  7862                                         WS-TOL-AH-REFUND-PCT
  7863                                         EC-CO-TOL-REFUND-PCT
  7864        MOVE WK-REFUND-OVS-PCT        TO WS-LF-REFUND-OVS-PCT
  7865                                         WS-AH-REFUND-OVS-PCT
  7866                                         EC-CO-OVR-SHT-PCT
  7867        MOVE WK-CO-REF-REJECT-SW      TO WS-REF-REJECT-SW
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 145
* EL050.cbl
  7868        MOVE WK-CO-PREM-REJECT-SW     TO WS-PREM-REJECT-SW
  7869        MOVE WK-CREDIT-EDIT-CONTROLS  TO WS-CREDIT-EDIT-CONTROLS
  7870        MOVE WK-MIN-PREMIUM           TO EC-CO-MIN-PREMIUM
  7871        MOVE WK-MIN-TERM              TO EC-CO-MIN-TERM
  7872        MOVE WK-MAX-TERM              TO EC-CO-MAX-TERM
  7873        MOVE WK-MIN-AGE               TO EC-CO-MIN-AGE
  7874        MOVE WK-DEFAULT-APR           TO WS-DEFAULT-APR
  7875        MOVE WK-BIRTH-DATE-INPUT      TO WS-BIRTH-DATE-FLAG
  7876        MOVE WK-JOINT-AGE-INPUT       TO WS-JOINT-AGE-FLAG
  7877        MOVE WK-REM-TRM-CALC-OPTION   TO WS-REM-TRM-CALC-OPTION
  7878        MOVE PB-CREDIT-SELECT-DT      TO WS-CURRENT-MONTH-END
  7879                                         EC-CO-MONTH-END-DT
  7880        MOVE WK-CANCEL-EXIT-DT        TO WS-CANCEL-EXIT-DT
  7881          GO TO 0100-READ-ACCT.
  7882
  7883     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  7884     MOVE SPACES                 TO CNTL-ACCESS.
  7885     MOVE '1'                    TO CNTL-REC-TYPE.
  7886     MOVE +0                     TO CNTL-SEQ-NO.
  7887
  7888     MOVE '1' TO RC-SW-1.
  7889     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  7890     IF NOT CF-COMPANY-MASTER
  7891         MOVE ZEROS             TO WK-CO-TOL-PREM
  7892                                   WK-CO-TOL-CLAIM
  7893                                   WK-CO-TOL-REFUND
  7894                                   WK-REFUND-OVS-AMT
  7895                                   WK-REFUND-OVS-PCT
  7896                                   WK-CO-TOL-PREM-PCT
  7897                                   WK-CO-TOL-REFUND-PCT
  7898                                   WK-DEFAULT-APR
  7899                                   WK-CO-MAX-CAP
  7900        MOVE SPACES             TO WK-CR-REM-TERM-CALC
  7901                                   WK-CR-R78-METHOD
  7902                                   WK-CO-REF-REJECT-SW
  7903                                   WK-CO-PREM-REJECT-SW
  7904                                   WK-REM-TRM-CALC-OPTION
  7905                                   WK-BIRTH-DATE-INPUT
  7906                                   WK-JOINT-AGE-INPUT
  7907        MOVE LOW-VALUES         TO WK-CANCEL-EXIT-DT
  7908        MOVE SPACES             TO WK-CREDIT-EDIT-CONTROLS
  7909        INITIALIZE    WK-CREDIT-EDIT-CONTROLS
  7910        MOVE ' '                TO WK-CNTL-RECORD-FOUND-SW
  7911          GO TO 0099-COMPANY-NOT-FOUND.
  7912
  7913     IF CF-CO-TOL-PREM-PCT NOT NUMERIC
  7914        MOVE +0                    TO CF-CO-TOL-PREM-PCT.
  7915     IF CF-CO-TOL-REFUND-PCT NOT NUMERIC
  7916        MOVE +0                    TO CF-CO-TOL-REFUND-PCT.
  7917     IF CF-CO-TOL-CAP NOT NUMERIC
  7918        MOVE +0                    TO CF-CO-TOL-CAP.
  7919     IF CF-DEFAULT-APR NOT NUMERIC
  7920        MOVE +0                    TO CF-DEFAULT-APR.
  7921
  7922     MOVE CF-CR-REM-TERM-CALC      TO WK-CR-REM-TERM-CALC.
  7923     MOVE CF-CR-R78-METHOD         TO WK-CR-R78-METHOD.
  7924     MOVE CF-CO-TOL-CAP            TO WK-CO-MAX-CAP.
  7925     MOVE CF-CO-TOL-CLAIM          TO WK-CO-TOL-CLAIM.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 146
* EL050.cbl
  7926     MOVE CF-CO-TOL-PREM           TO WK-CO-TOL-PREM.
  7927     MOVE CF-CO-TOL-REFUND         TO WK-CO-TOL-REFUND.
  7928     MOVE CF-CO-TOL-REFUND-PCT     TO WK-CO-TOL-REFUND-PCT.
  7929     MOVE CF-CO-TOL-PREM-PCT       TO WK-CO-TOL-PREM-PCT.
  7930     MOVE CF-CO-REF-REJECT-SW      TO WK-CO-REF-REJECT-SW.
  7931     MOVE CF-CO-PREM-REJECT-SW     TO WK-CO-PREM-REJECT-SW.
  7932     MOVE CF-CREDIT-EDIT-CONTROLS  TO WK-CREDIT-EDIT-CONTROLS.
  7933     MOVE CF-DEFAULT-APR           TO WK-DEFAULT-APR.
  7934
  7935     IF CF-CO-OVR-SHT-AMT NUMERIC AND
  7936          CF-CO-OVR-SHT-AMT > +0
  7937        MOVE CF-CO-OVR-SHT-AMT   TO WK-REFUND-OVS-AMT.
  7938
  7939     IF CF-CO-OVR-SHT-PCT NUMERIC AND
  7940          CF-CO-OVR-SHT-PCT > +0
  7941        MOVE CF-CO-OVR-SHT-PCT   TO WK-REFUND-OVS-PCT.
  7942
  7943     IF CF-VALID-REM-TRM-OPTION
  7944         MOVE CF-REM-TRM-CALC-OPTION TO WK-REM-TRM-CALC-OPTION
  7945     ELSE
  7946         MOVE SPACE                TO WK-REM-TRM-CALC-OPTION.
  7947
  7948     MOVE CF-BIRTH-DATE-INPUT      TO WK-BIRTH-DATE-INPUT.
  7949     MOVE CF-JOINT-AGE-INPUT       TO WK-JOINT-AGE-INPUT.
  7950     MOVE CF-CR-MONTH-END-DT       TO WK-CANCEL-EXIT-DT.
  7951     MOVE 'Y'                      TO WK-CNTL-RECORD-FOUND-SW.
  7952
  7953     GO TO 0050-CHECK-CNTL-FOUND.
  7954
  7955 0099-COMPANY-NOT-FOUND.
  7956
  7957     MOVE ER-2616                TO WS-ERROR.
  7958     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7959
  7960 0100-READ-ACCT.
  7961
  7962     MOVE SPACES                 TO DATE-RANGE-SW.
  7963
  7964     IF WK-ACCT-ADDR = ZEROS
  7965        GO TO 0102-ACCT-GETMAIN.
  7966
  7967     MOVE WK-ACCT-ADDR           TO ERACCT-WS-COMP.
  7968     SET ERACCT-FILE-ADDRESSED   TO TRUE.
  7969     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  7970
  7971     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  7972        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  7973        GO TO 0105-READ-ACCT
  7974     END-IF
  7975
  7976     IF PB-CARRIER NOT = SPACES
  7977        IF PB-CARRIER NOT = AM-VG-CARRIER
  7978           GO TO 0105-READ-ACCT.
  7979
  7980     IF PB-STATE NOT = SPACES
  7981        IF PB-STATE NOT = AM-VG-STATE
  7982           GO TO 0105-READ-ACCT.
  7983
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 147
* EL050.cbl
  7984     IF PB-GROUPING NOT = SPACES
  7985        IF PB-GROUPING NOT = AM-VG-GROUPING
  7986           GO TO 0105-READ-ACCT.
  7987
  7988     MOVE 'X'                 TO DATE-RANGE-SW.
  7989
  7990     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  7991        MOVE 'X'                 TO DATE-RANGE-SW
  7992        GO TO 0105-READ-ACCT.
  7993
  7994     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  7995        GO TO 0105-READ-ACCT.
  7996
  7997     GO TO 0180-ACCOUNT-FOUND.
  7998
  7999 0102-ACCT-GETMAIN.
  8000     PERFORM 8560-GETMAIN THRU 8560-EXIT.
  8001     MOVE ERACCT-WS-COMP         TO WK-ACCT-ADDR.
  8002
  8003 0105-READ-ACCT.
  8004     MOVE PB-COMPANY-CD          TO ACCT-COMP-CD.
  8005     MOVE PB-CARRIER             TO ACCT-CARRIER.
  8006     MOVE PB-GROUPING            TO ACCT-GROUPING.
  8007     MOVE PB-STATE               TO ACCT-STATE.
  8008     MOVE PB-ACCOUNT             TO ACCT-ACCOUNT.
  8009     MOVE PB-CERT-EFF-DT         TO ACCT-EXP-DT.
  8010
  8011     PERFORM 8570-START-ACCOUNT-MASTER THRU 8570-EXIT.
  8012
  8013     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
  8014
  8015 0110-FIND-ACCT-TOLERANCES-LOOP.
  8016     PERFORM 8580-READ-ACCOUNT-MASTER THRU 8580-EXIT.
  8017
  8018     IF (PB-COMPANY-CD NOT = AM-COMPANY-CD-A1)
  8019        OR (PB-ACCOUNT NOT = AM-VG-ACCOUNT)
  8020        GO TO 0199-ACCT-NOT-FOUND
  8021     END-IF
  8022     IF PB-CARRIER NOT = SPACES
  8023        IF PB-CARRIER NOT = AM-VG-CARRIER
  8024           GO TO 0199-ACCT-NOT-FOUND.
  8025
  8026     IF PB-STATE NOT = SPACES
  8027        IF PB-STATE NOT = AM-VG-STATE
  8028           GO TO 0199-ACCT-NOT-FOUND.
  8029
  8030     IF PB-GROUPING NOT = SPACES
  8031        IF PB-GROUPING NOT = AM-VG-GROUPING
  8032           GO TO 0199-ACCT-NOT-FOUND.
  8033
  8034     MOVE 'X'                    TO DATE-RANGE-SW.
  8035
  8036     IF PB-CERT-EFF-DT LESS AM-EFFECTIVE-DT
  8037        MOVE 'X'                 TO DATE-RANGE-SW
  8038        GO TO 0199-ACCT-NOT-FOUND.
  8039
  8040     IF PB-CERT-EFF-DT NOT LESS AM-EXPIRATION-DT
  8041        GO TO 0110-FIND-ACCT-TOLERANCES-LOOP.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 148
* EL050.cbl
  8042
  8043 0180-ACCOUNT-FOUND.
  8044     MOVE 'Y'                    TO ACCOUNT-MAST-FOUND-SW.
  8045     MOVE AM-CARRIER             TO PB-SV-CARRIER.
  8046     MOVE AM-STATE               TO PB-SV-STATE.
  8047     MOVE AM-GROUPING            TO PB-SV-GROUPING.
  8048
  8049     IF AM-CANCEL-FEE  NOT NUMERIC
  8050        MOVE ZEROS TO AM-CANCEL-FEE.
  8051
  8052     IF AM-MAX-MON-BEN NOT NUMERIC
  8053        MOVE ZEROS TO AM-MAX-MON-BEN.
  8054
  8055     IF AM-MAX-TOT-BEN NOT NUMERIC
  8056        MOVE ZEROS TO AM-MAX-TOT-BEN.
  8057
  8058     IF AM-CLP-TOL-PCT NOT NUMERIC
  8059        MOVE +0                  TO AM-CLP-TOL-PCT
  8060     END-IF
  8061     IF AM-SPP-LEASE-COMM NOT NUMERIC
  8062        MOVE +0                  TO AM-SPP-LEASE-COMM
  8063     END-IF
  8064     IF AM-MAX-MON-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8065        MOVE ER-2611             TO   WS-ERROR
  8066        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8067
  8068     IF AM-MAX-TOT-BEN = ZEROS AND (PB-COMPANY-ID = 'CSL')
  8069        MOVE ER-2621             TO   WS-ERROR
  8070        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8071
  8072     IF (PB-I-AH-BENEFIT-CD = ZERO OR SPACE)
  8073        AND (AM-STD-AH-TYPE NOT = SPACES AND ZEROS)
  8074        AND (PB-I-AH-INPUT-CD = SPACE OR ZERO)
  8075        AND (PB-I-AH-PREMIUM-AMT NOT = ZERO)
  8076         MOVE AM-STD-AH-TYPE    TO PB-I-AH-BENEFIT-CD.
  8077
  8078     MOVE AM-LF-DEVIATION        TO WS-ACCT-LF-DEVIATION.
  8079     MOVE AM-LF-DEVIATION-PCT    TO WS-ACCT-LF-DEV-PCT.
  8080     MOVE AM-AH-DEVIATION        TO WS-ACCT-AH-DEVIATION.
  8081     MOVE AM-AH-DEVIATION-PCT    TO WS-ACCT-AH-DEV-PCT.
  8082     IF AM-CLP-TOL-PCT NOT = ZEROS
  8083        MOVE AM-CLP-TOL-PCT      TO WS-TOL-CLP-PCT
  8084     END-IF
  8085     IF AM-SPP-LEASE-COMM NOT = ZEROS
  8086        MOVE AM-SPP-LEASE-COMM   TO WS-SPP-LEASE-COMM
  8087     END-IF
  8088*    IF PB-COMPANY-ID = 'DCC'
  8089*       MOVE +0                  TO WS-ACCT-ADDL-CLP
  8090*                                   WS-ADMIN-FEES
  8091*       PERFORM VARYING SUB5 FROM +1 BY +1 UNTIL
  8092*          (SUB5 > +10)
  8093*          IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8094*             AND (AM-A-COM (SUB5) NUMERIC)
  8095*             COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  8096*                + (AM-A-COM (SUB5) * 1000)
  8097*             IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8098*                COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8099*                + (AM-A-COM (SUB5) * 1000)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 149
* EL050.cbl
  8100*             END-IF
  8101*             IF AM-COM-TYP (SUB5) = 'N'
  8102*                COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8103*                + (AM-A-COM (SUB5) * 1000)
  8104*             END-IF
  8105*          END-IF
  8106*       END-PERFORM
  8107*    END-IF
  8108     IF (PB-COMPANY-ID = 'DCC')
  8109        AND (PB-ISSUE)
  8110        MOVE +0                  TO WS-ACCT-ADDL-CLP
  8111                                    ws-cred-union-fees
  8112        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8113           (SUB5 > +10)
  8114           MOVE +0 TO WS-WK-RATE
  8115           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N' OR
  8116                                   'O' OR 'S')
  8117              IF (AM-A-COM (SUB5) NUMERIC)
  8118                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8119                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8120              ELSE
  8121                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8122                 IF PB-ISSUE
  8123                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8124                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8125                 ELSE
  8126                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8127                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8128                 END-IF
  8129                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8130                 MOVE ZEROS             TO WS-SUB1
  8131                                           WS-COMMISSION
  8132                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8133                 MOVE '0530'               TO CTBL-SW
  8134                 MOVE ' '                  TO WS-CTBL-READ-SW
  8135                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8136                 IF FIRST-TIME-THROUGH
  8137                    MOVE 'AA'              TO CTBL-BEN-CODE
  8138                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8139                 END-IF
  8140                 IF CTBL-TABLE-FOUND
  8141                    IF PB-ISSUE
  8142                       COMPUTE WS-COMM-CK-AMT =
  8143                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8144                    ELSE
  8145                       COMPUTE WS-COMM-CK-AMT =
  8146                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8147                    END-IF
  8148                    PERFORM 8800-GET-COMP-RATE
  8149                              THRU 8800-EXIT
  8150                 END-IF
  8151              END-IF
  8152              if am-com-typ (sub5) = 'O' or 'S'
  8153                 compute ws-cred-union-fees rounded =
  8154                    ws-cred-union-fees +
  8155                    (pb-i-ah-premium-amt * ws-wk-rate)
  8156              else
  8157                 COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 150
* EL050.cbl
  8158                + (WS-WK-RATE * 1000)
  8159              end-if
  8160           END-IF
  8161        END-PERFORM
  8162     END-IF
  8163     IF PB-COMPANY-ID EQUAL 'CRI'
  8164         MOVE AM-REPORT-CODE-1   TO WS-CRI-REPORT-CODE.
  8165
  8166     IF PB-COMPANY-ID EQUAL 'NCL'
  8167         MOVE 'Y'                TO AM-BENEFIT-TABLE-USAGE
  8168     END-IF
  8169
  8170     GO TO 0200-READ-CERT.
  8171
  8172 0199-ACCT-NOT-FOUND.
  8173
  8174     MOVE 'N'                    TO ACCOUNT-MAST-FOUND-SW.
  8175
  8176     IF DATE-RANGE-SW NOT = SPACES
  8177        MOVE ER-2601             TO WS-ERROR
  8178        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8179     ELSE
  8180        MOVE ER-2619             TO WS-ERROR
  8181        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8182
  8183     GO TO 9990-RETURN.
  8184
  8185 0200-READ-CERT.
  8186
  8187     MOVE PB-COMPANY-CD          TO CERT-COMP-CD.
  8188     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  8189     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  8190     MOVE PB-SV-STATE            TO CERT-STATE.
  8191     MOVE PB-ACCOUNT             TO CERT-ACCOUNT.
  8192     MOVE PB-CERT-EFF-DT         TO CERT-EFF-DT.
  8193     MOVE PB-CERT-NO             TO CERT-CERT-NO.
  8194
  8195     PERFORM 8590-READ-CERT-MASTER THRU 8590-EXIT.
  8196
  8197     IF CERT-WAS-NOT-FOUND
  8198        GO TO 0299-CERT-NOT-FOUND.
  8199
  8200     IF CERT-WAS-CREATED-FOR-CLAIM AND PB-CANCELLATION
  8201        MOVE ER-2759             TO WS-ERROR
  8202        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8203        GO TO 0298-UNLOCK-RETURN.
  8204
  8205     IF CERT-PURGED-OFFLINE AND PB-CANCELLATION
  8206         MOVE ER-2758            TO WS-ERROR
  8207         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8208         GO TO 0298-UNLOCK-RETURN.
  8209
  8210     IF PB-ISSUE
  8211        IF (CERT-ADDED-BATCH) AND (CM-RECORD-ID = 'CM')
  8212           IF CERT-WAS-CREATED-FOR-CLAIM
  8213              NEXT SENTENCE
  8214            ELSE
  8215              MOVE ER-2626       TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 151
* EL050.cbl
  8216              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8217              GO TO 0298-UNLOCK-RETURN.
  8218
  8219     IF NOT PB-CANCELLATION
  8220        GO TO 0300-CONTINUE-EDIT.
  8221
  8222     MOVE CM-INSURED-LAST-NAME    TO PB-CI-LAST-NAME.
  8223     MOVE CM-INSURED-INITIALS     TO PB-CI-INITIALS.
  8224     MOVE CM-INSURED-FIRST-NAME   TO PB-CI-FIRST-NAME.
  8225     MOVE CM-INSURED-ISSUE-AGE    TO PB-CI-INSURED-AGE.
  8226     MOVE CM-INSURED-SEX          TO PB-CI-INSURED-SEX.
  8227     MOVE CM-SOC-SEC-NO           TO PB-CI-SOC-SEC-NO.
  8228
  8229     MOVE CM-LF-ORIG-TERM         TO PB-CI-LF-TERM.
  8230     MOVE CM-LF-BENEFIT-CD        TO PB-CI-LF-BENEFIT-CD.
  8231     MOVE CM-LF-BENEFIT-AMT       TO PB-CI-LF-BENEFIT-AMT.
  8232     MOVE CM-LF-PREMIUM-AMT       TO PB-CI-LF-PREMIUM-AMT.
  8233     MOVE CM-LF-ALT-BENEFIT-AMT   TO PB-CI-LF-ALT-BENEFIT-AMT.
  8234     MOVE CM-LF-ALT-PREMIUM-AMT   TO PB-CI-LF-ALT-PREMIUM-AMT.
  8235     MOVE CM-LF-CRITICAL-PERIOD   TO PB-CI-LF-CRIT-PER.
  8236     MOVE CM-LF-DEV-CODE          TO PB-CI-RATE-DEV-LF.
  8237     MOVE CM-LF-DEV-PCT           TO PB-CI-RATE-DEV-PCT-LF.
  8238
  8239     MOVE CM-AH-ORIG-TERM         TO PB-CI-AH-TERM.
  8240     MOVE CM-AH-BENEFIT-CD        TO PB-CI-AH-BENEFIT-CD.
  8241     MOVE CM-AH-BENEFIT-AMT       TO PB-CI-AH-BENEFIT-AMT.
  8242     MOVE CM-AH-PREMIUM-AMT       TO PB-CI-AH-PREMIUM-AMT.
  8243     MOVE CM-AH-CRITICAL-PERIOD   TO PB-CI-AH-CRIT-PER.
  8244     MOVE CM-AH-DEV-CODE          TO PB-CI-RATE-DEV-AH.
  8245     MOVE CM-AH-DEV-PCT           TO PB-CI-RATE-DEV-PCT-AH.
  8246
  8247     MOVE CM-RATE-CLASS           TO PB-CI-RATE-CLASS.
  8248     MOVE CM-NOTE-SW              TO PB-CI-NOTE-SW.
  8249
  8250     MOVE CM-CREDIT-INTERFACE-SW-1
  8251                                  TO PB-CI-CREDIT-INTERFACE-SW-1.
  8252     MOVE CM-CREDIT-INTERFACE-SW-2
  8253                                  TO PB-CI-CREDIT-INTERFACE-SW-2.
  8254
  8255     IF CM-O-B-COVERAGE
  8256         MOVE 'B'                 TO PB-CI-OB-FLAG.
  8257
  8258     IF CM-LIVES NOT NUMERIC
  8259         MOVE ZERO                TO CM-LIVES.
  8260
  8261     IF CM-BILLED NOT NUMERIC
  8262         MOVE ZERO                TO CM-BILLED.
  8263
  8264     IF CM-CREDIT-INTERFACE-SW-2 = SPACE
  8265         MOVE CM-AH-CURRENT-STATUS TO PB-CI-AH-POLICY-STATUS
  8266         MOVE CM-LF-CURRENT-STATUS TO PB-CI-LF-POLICY-STATUS
  8267         MOVE CM-AH-CANCEL-DT      TO PB-CI-AH-PRIOR-CANCEL-DT
  8268         MOVE CM-LF-CANCEL-DT      TO PB-CI-LF-PRIOR-CANCEL-DT
  8269         MOVE CM-AH-ITD-CANCEL-AMT TO PB-CI-AH-CANCEL-AMT
  8270         MOVE CM-LF-ITD-CANCEL-AMT TO PB-CI-LF-CANCEL-AMT.
  8271         MOVE CM-LIVES             TO PB-CI-LIVES
  8272*The next line causes a problem with my change  I dont think it is
  8273*00400          MOVE CM-BILLED            TO PB-I-NUM-BILLED.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 152
* EL050.cbl
  8274
  8275     MOVE PB-CI-LF-POLICY-STATUS   TO EC-CM-LF-PRIOR-STATUS.
  8276     MOVE PB-CI-AH-POLICY-STATUS   TO EC-CM-AH-PRIOR-STATUS.
  8277     MOVE PB-CI-AH-CANCEL-AMT      TO EC-CM-AH-PRIOR-REFUND.
  8278     MOVE PB-CI-LF-CANCEL-AMT      TO EC-CM-LF-PRIOR-REFUND.
  8279     MOVE PB-CI-LF-PRIOR-CANCEL-DT TO EC-CM-LF-CANCEL-DT.
  8280     MOVE PB-CI-AH-PRIOR-CANCEL-DT TO EC-CM-AH-CANCEL-DT.
  8281
  8282     MOVE CM-LF-DEATH-DT           TO PB-CI-DEATH-DT.
  8283     MOVE PB-CI-DEATH-DT           TO EC-CM-DEATH-DT.
  8284     MOVE CM-AH-SETTLEMENT-DT      TO PB-CI-AH-SETTLEMENT-DT.
  8285     MOVE CM-AH-PAID-THRU-DT       TO PB-CI-AH-PAID-THRU-DT.
  8286
  8287     IF CM-LIFE-COMM-PCT NUMERIC
  8288         MOVE CM-LIFE-COMM-PCT   TO PB-CI-LIFE-COMMISSION
  8289     ELSE
  8290         MOVE ZEROS              TO PB-CI-LIFE-COMMISSION.
  8291
  8292     IF CM-AH-COMM-PCT NUMERIC
  8293         MOVE CM-AH-COMM-PCT     TO PB-CI-AH-COMMISSION
  8294     ELSE
  8295         MOVE ZEROS              TO PB-CI-AH-COMMISSION.
  8296
  8297     MOVE CM-ENTRY-STATUS          TO PB-CI-ENTRY-STATUS.
  8298
  8299     IF CM-LOAN-APR       NOT NUMERIC
  8300           MOVE ZERO               TO CM-LOAN-APR.
  8301
  8302     IF CM-PAY-FREQUENCY  NOT NUMERIC
  8303           MOVE ZERO               TO CM-PAY-FREQUENCY.
  8304
  8305     IF CM-LOAN-TERM      NOT NUMERIC
  8306           MOVE ZERO               TO CM-LOAN-TERM.
  8307
  8308     IF CM-LF-TERM-IN-DAYS   NOT NUMERIC
  8309           MOVE ZERO               TO CM-LF-TERM-IN-DAYS.
  8310
  8311     IF CM-PMT-EXTENSION-DAYS  NOT NUMERIC
  8312           MOVE ZERO               TO CM-PMT-EXTENSION-DAYS.
  8313
  8314     MOVE CM-PAY-FREQUENCY         TO PB-CI-PAY-FREQUENCY.
  8315     MOVE CM-LOAN-APR              TO PB-CI-LOAN-APR.
  8316     MOVE CM-LOAN-TERM             TO PB-CI-LOAN-TERM.
  8317     MOVE CM-LF-TERM-IN-DAYS       TO PB-CI-TERM-IN-DAYS.
  8318     MOVE CM-PMT-EXTENSION-DAYS    TO PB-CI-EXTENTION-DAYS.
  8319     MOVE CM-LF-LOAN-EXPIRE-DT     TO PB-CI-LF-EXPIRE-DT.
  8320     MOVE CM-AH-LOAN-EXPIRE-DT     TO PB-CI-AH-EXPIRE-DT.
  8321     MOVE CM-LOAN-1ST-PMT-DT       TO PB-CI-LOAN-1ST-PMT-DT.
  8322     MOVE CM-ENTRY-DT              TO PB-CI-ENTRY-DT.
  8323     MOVE CM-ENTRY-BATCH           TO PB-CI-ENTRY-BATCH.
  8324     MOVE CM-LOAN-OFFICER          TO PB-CI-LOAN-OFFICER.
  8325     MOVE CM-IND-GRP-TYPE          TO PB-CI-INDV-GRP-CD
  8326
  8327     IF CM-STATE = CM-SSN-STATE
  8328         MOVE SPACES               TO PB-CI-SOC-SEC-NO.
  8329
  8330     IF CM-STATE NOT = CM-MEMB-STATE
  8331         MOVE CM-MEMBER-NO         TO PB-CI-MEMBER-NO.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 153
* EL050.cbl
  8332
  8333     MOVE CM-COMP-EXCP-SW          TO PB-CI-COMP-EXCP-SW.
  8334
  8335     IF PB-COMPANY-ID = 'CVL' OR 'DCC'
  8336        MOVE CM-BENEFICIARY      TO PB-CI-BENEFICIARY-NAME
  8337        IF CM-ADDL-CLP NOT NUMERIC
  8338           MOVE +0               TO CM-ADDL-CLP
  8339        END-IF
  8340        MOVE CM-ADDL-CLP         TO PB-CI-ADDL-CLP
  8341        IF AM-DCC-PRODUCT-CODE = 'DDF'
  8342           MOVE CM-DDF-IU-RATE-UP TO PB-CI-DDF-IU-RATE-UP
  8343        END-IF
  8344     END-IF
  8345     IF PB-COMPANY-ID = 'DCC'
  8346        MOVE +0                  TO WS-ADMIN-FEES
  8347                                    WS-CSO-ADMIN-FEE
  8348                                    WS-COMM-AND-MFEE
  8349                                    WS-1ST-YR-ALLOW
  8350        PERFORM VARYING SUB5 FROM +2 BY +1 UNTIL
  8351           (SUB5 > +10)
  8352           MOVE +0 TO WS-WK-RATE
  8353           IF (AM-COM-TYP (SUB5) = 'I' OR 'L' OR 'J' OR 'N')
  8354              IF (AM-A-COM (SUB5) NUMERIC)
  8355                 AND (AM-A-COMA (SUB5) (3:1) NOT = 'L' AND 'M')
  8356                 MOVE AM-A-COM (SUB5) TO WS-WK-RATE
  8357              ELSE
  8358                 MOVE PB-COMPANY-CD     TO CTBL-COMPANY-CD
  8359                 IF PB-ISSUE
  8360                    MOVE PB-I-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8361                    MOVE PB-I-AH-TERM      TO WS-WORK-TERM
  8362                 ELSE
  8363                    MOVE PB-CI-AH-BENEFIT-CD TO CTBL-BEN-CODE
  8364                    MOVE PB-CI-AH-TERM       TO WS-WORK-TERM
  8365                 END-IF
  8366                 MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
  8367                 MOVE ZEROS             TO WS-SUB1
  8368                                           WS-COMMISSION
  8369                 MOVE AM-A-COMA (SUB5)  TO CTBL-TABLE
  8370                 MOVE '0530'               TO CTBL-SW
  8371                 MOVE ' '                  TO WS-CTBL-READ-SW
  8372                 PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8373                 IF FIRST-TIME-THROUGH
  8374                    MOVE 'AA'              TO CTBL-BEN-CODE
  8375                    PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
  8376                 END-IF
  8377                 IF CTBL-TABLE-FOUND
  8378                    IF PB-ISSUE
  8379                       COMPUTE WS-COMM-CK-AMT =
  8380                          PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM
  8381                    ELSE
  8382                       COMPUTE WS-COMM-CK-AMT =
  8383                          PB-CI-AH-BENEFIT-AMT * PB-CI-AH-TERM
  8384                    END-IF
  8385                    PERFORM 8800-GET-COMP-RATE
  8386                              THRU 8800-EXIT
  8387                 END-IF
  8388              END-IF
  8389              IF AM-COM-TYP (SUB5) = 'I'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 154
* EL050.cbl
  8390                 COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE
  8391                   + (WS-WK-RATE * 1000)
  8392              END-IF
  8393              IF AM-COM-TYP (SUB5) = 'N'
  8394                 COMPUTE WS-CSO-ADMIN-FEE = WS-CSO-ADMIN-FEE
  8395                   + (WS-WK-RATE * 1000)
  8396              END-IF
  8397              IF AM-COM-TYP (SUB5) = 'L' OR 'N'
  8398                 COMPUTE WS-ADMIN-FEES = WS-ADMIN-FEES
  8399                   + (WS-WK-RATE * 1000)
  8400              END-IF
  8401              IF AM-COM-TYP (SUB5) = 'J' OR 'L'
  8402                 COMPUTE WS-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
  8403                   + (WS-WK-RATE * 1000)
  8404              END-IF
  8405           END-IF
  8406        END-PERFORM
  8407     END-IF
  8408     GO TO 0300-CONTINUE-EDIT.
  8409
  8410 0298-UNLOCK-RETURN.
  8411      PERFORM 9250-UNLOCK-RETURN
  8412      GO TO 9990-RETURN.
  8413
  8414 0299-CERT-NOT-FOUND.
  8415
  8416     MOVE '1'                     TO CERT-STATUS-SW.
  8417
  8418     IF PB-COMPANY-ID = 'UCL'
  8419         IF WS-ERROR = ER-2799
  8420             GO TO 3000-CONTINUE-EDIT.
  8421
  8422     IF NOT PB-CANCELLATION
  8423         GO TO 0300-CONTINUE-EDIT.
  8424
  8425     MOVE ER-2726                  TO  WS-ERROR.
  8426     PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT.
  8427     MOVE SPACES                 TO PB-CANCELED-CERT-DATA.
  8428     MOVE ZEROS                  TO PB-CI-INSURED-AGE
  8429                                    PB-CI-LF-TERM
  8430                                    PB-C-LF-REM-TERM
  8431                                    PB-CI-AH-TERM
  8432                                    PB-C-AH-REM-TERM
  8433                                    PB-CI-LF-BENEFIT-CD
  8434                                    PB-CI-LF-BENEFIT-AMT
  8435                                    PB-CI-LF-ALT-BENEFIT-AMT
  8436                                    PB-CI-LF-PREMIUM-AMT
  8437                                    PB-CI-LF-ALT-PREMIUM-AMT
  8438                                    PB-CI-AH-BENEFIT-CD
  8439                                    PB-CI-AH-BENEFIT-AMT
  8440                                    PB-CI-AH-PREMIUM-AMT
  8441                                    PB-CI-PAY-FREQUENCY
  8442                                    PB-CI-LOAN-APR
  8443                                    PB-CI-LOAN-TERM
  8444                                    PB-CI-LIFE-COMMISSION
  8445                                    PB-CI-AH-COMMISSION
  8446                                    PB-CI-CURR-SEQ
  8447                                    PB-CI-AH-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 155
* EL050.cbl
  8448                                    PB-CI-LF-CANCEL-AMT
  8449                                    PB-CI-RATE-DEV-PCT-LF
  8450                                    PB-CI-RATE-DEV-PCT-AH
  8451                                    PB-CI-EXTENTION-DAYS
  8452                                    PB-CI-TERM-IN-DAYS
  8453                                    PB-CI-LIVES
  8454                                    PB-CI-LF-CRIT-PER
  8455                                    PB-CI-AH-CRIT-PER
  8456                                    PB-CI-ADDL-CLP
  8457                                    PB-CI-DDF-IU-RATE-UP.
  8458
  8459     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
  8460                                    PB-CI-AH-SETTLEMENT-DT
  8461                                    PB-CI-DEATH-DT
  8462                                    PB-CI-LF-PRIOR-CANCEL-DT
  8463                                    PB-CI-AH-PRIOR-CANCEL-DT
  8464                                    PB-CI-ENTRY-DT
  8465                                    PB-CI-LF-EXPIRE-DT
  8466                                    PB-CI-AH-EXPIRE-DT
  8467                                    PB-CI-LOAN-1ST-PMT-DT.
  8468
  8469     IF ACCOUNT-MAST-FOUND
  8470        MOVE AM-EXPIRATION-DT     TO PB-ACCT-EXP-DT
  8471        MOVE AM-EFFECTIVE-DT      TO PB-ACCT-EFF-DT.
  8472
  8473
  8474 0300-CONTINUE-EDIT.
  8475
  8476     IF PB-ISSUE
  8477        IF PB-I-LF-INPUT-CD NOT = SPACE AND ZERO
  8478            PERFORM 6370-EDIT-INPUT-LF-CODE THRU 6370-EXIT.
  8479
  8480     IF PB-ISSUE
  8481        IF PB-I-AH-INPUT-CD NOT = SPACE AND ZERO
  8482            PERFORM 6380-EDIT-INPUT-AH-CODE THRU 6380-EXIT.
  8483
  8484     IF PB-ISSUE
  8485       IF (PB-COMPANY-ID = 'WDS' OR 'FLI') OR
  8486          (AM-NO-AH-ONLY)
  8487           IF PB-I-AH-BENEFIT-CD NOT = ZEROS
  8488               IF PB-I-LIFE-BENEFIT-CD = ZEROS
  8489                   MOVE ER-2679 TO WS-ERROR
  8490                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8491
  8492     IF PB-ISSUE
  8493        MOVE PB-I-AH-BENEFIT-CD    TO WS-AH-BENEFIT-CD
  8494        MOVE PB-I-LIFE-BENEFIT-CD  TO WS-LF-BENEFIT-CD
  8495        MOVE PB-CERT-EFF-DT        TO WS-CERT-EFF-DT
  8496     ELSE
  8497        MOVE CM-AH-BENEFIT-CD      TO WS-AH-BENEFIT-CD
  8498        MOVE CM-LF-BENEFIT-CD      TO WS-LF-BENEFIT-CD
  8499        MOVE CM-CERT-EFF-DT        TO WS-CERT-EFF-DT.
  8500
  8501     MOVE 'N'                    TO PLAN-MASTER-SW
  8502                                    PLAN-MASTER-LIFE-SW
  8503                                    FORM-MASTER-SW
  8504                                    WS-APP-CERT-SW.
  8505
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 156
* EL050.cbl
  8506     MOVE ZEROS                  TO WS-PL-TOL-LF-PREM
  8507                                    WS-PL-TOL-LF-REFUND
  8508                                    WS-PL-REF-OVS-AMT
  8509                                    WS-PL-TOL-LF-PREM-PCT
  8510                                    WS-PL-TOL-LF-REFUND-PCT
  8511                                    WS-PL-REF-OVS-PCT
  8512                                    WS-PL-TOL-LF-CLAIM.
  8513
  8514     IF PB-COMPANY-ID = 'NCL'
  8515       IF PB-ISSUE
  8516         IF PB-I-POLICY-FORM-NO NOT = SPACES  AND  ZEROS
  8517             PERFORM  3350-GET-ERFORM   THRU  3350-EXIT
  8518             IF FORM-MASTER-FOUND
  8519                 MOVE FO-APP-CERT-USE-CD TO WS-APP-CERT-SW.
  8520
  8521     IF WS-LF-BENEFIT-CD = ZEROS  OR  SPACES
  8522        GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8523
  8524********************** MON CODE **********************
  8525     IF PB-COMPANY-ID = 'MON'
  8526     IF PB-ISSUE
  8527     IF WS-LF-BENEFIT-CD = ('11' OR '12' OR '13' OR '14' OR '26')
  8528        AND (PB-I-LOAN-APR NOT NUMERIC OR
  8529             PB-I-LOAN-APR = ZERO)
  8530               MOVE 14.0         TO PB-I-LOAN-APR.
  8531******************************************************
  8532
  8533     IF PB-COMPANY-ID = 'NCL'
  8534       IF PB-ISSUE
  8535           IF FORM-MASTER-FOUND
  8536             IF FO-DISMEMBERMENT-CD = 'Y'  AND
  8537                AM-DISMBR-COVERAGE
  8538                 MOVE WS-LF-BENEFIT-CD TO  WS-LF-INPUT-CD
  8539                 IF WS-LF-INPUT-CD-1 NOT = 'B'
  8540                   MOVE '8'            TO  WS-LF-INPUT-CD-1
  8541                   MOVE WS-LF-INPUT-CD TO  WS-LF-BENEFIT-CD
  8542                                           PB-I-LIFE-BENEFIT-CD.
  8543
  8544     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  8545
  8546     IF WK-LIFE-BEN-ADDR NOT = ZEROS
  8547         MOVE WK-LIFE-BEN-ADDR   TO ELCNTL-WS-COMP
  8548         SET ELCNTL-FILE-ADDRESSED   TO TRUE
  8549         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  8550         PERFORM 8555-RELOAD-CONTROL-FILE THRU 8555-EXIT
  8551         IF WS-LF-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  8552           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  8553             GO TO 0301-LIFE-BENEFIT-SEARCH
  8554         ELSE
  8555             NEXT SENTENCE
  8556     ELSE
  8557         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  8558
  8559     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  8560     MOVE '4'                    TO CNTL-REC-TYPE.
  8561     MOVE +0                     TO CNTL-SEQ-NO.
  8562     MOVE WS-ACCESS              TO CNTL-ACCESS.
  8563
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 157
* EL050.cbl
  8564     MOVE '1' TO RC-SW-2.
  8565     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  8566
  8567     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  8568        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  8569         GO TO 0305-BENEFIT-NOT-FOUND.
  8570
  8571     MOVE ELCNTL-WS-COMP         TO WK-LIFE-BEN-ADDR.
  8572
  8573 0301-LIFE-BENEFIT-SEARCH.
  8574
  8575     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  8576
  8577     IF NO-BENEFIT-FOUND
  8578        GO TO 0305-BENEFIT-NOT-FOUND.
  8579
  8580     IF WS-BEN-CD = '99'
  8581        GO TO 0305-BENEFIT-NOT-FOUND.
  8582
  8583     IF PB-COMPANY-ID = 'NCL'
  8584         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8585             GO TO 0304-LIFE-BENEFIT-FOUND.
  8586
  8587     MOVE +1                     TO SUB5.
  8588     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8589
  8590* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  8591* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  8592     IF PB-COMPANY-ID = 'DMD'
  8593         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  8594
  8595 0302-EDIT-ACCT-LF-BENEFITS.
  8596
  8597     IF AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8598        IF WS-BEN-CD EQUAL AM-BENEFIT-CODE (SUB5)
  8599           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8600                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8601           GO TO 03XX-GET-LIFE-ERPLAN.
  8602
  8603     IF SUB5 LESS THAN +20
  8604        ADD +1                   TO SUB5
  8605        GO TO 0302-EDIT-ACCT-LF-BENEFITS.
  8606
  8607     MOVE +1                     TO SUB5.
  8608
  8609     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8610        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8611
  8612 0303-EDIT-DMD-EXTRA-BENEFITS.
  8613
  8614     IF AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1
  8615        IF WS-BEN-CD EQUAL AM-BENEFIT-DMD-CODE (SUB5)
  8616           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8617                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  8618           GO TO 03XX-GET-LIFE-ERPLAN.
  8619
  8620     IF SUB5 LESS THAN +30
  8621        ADD +1                   TO SUB5
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 158
* EL050.cbl
  8622        GO TO 0303-EDIT-DMD-EXTRA-BENEFITS.
  8623
  8624     MOVE +1                     TO SUB5.
  8625
  8626 03XX-EDIT-FOR-NINETY-LF.
  8627
  8628***************************************************************
  8629*                                                             *
  8630*    NINETY BENEFIT PLAN TYPES:                               *
  8631*                                                             *
  8632*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  8633*      92 = ALL GROUP REDUCING BENEFITS                       *
  8634*      93 = ALL INDIVIDUAL LEVEL BENEFITS                     *
  8635*      94 = ALL GROUP LEVEL BENEFITS                          *
  8636*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  8637*           BENEFIT CONTROLS.                                 *
  8638*      99 = ALL BENEFITS                                      *
  8639*                                                             *
  8640***************************************************************
  8641
  8642     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  8643                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8644
  8645     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  8646       AND
  8647        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8648        GO TO 03XX-GET-LIFE-ERPLAN.
  8649
  8650     IF (AM-BENEFIT-CODE (SUB5) EQUAL '91')
  8651       AND
  8652        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8653        IF CF-REDUCING (SUB3)
  8654           IF (PB-I-INDV-GRP-OVRD = 'I')
  8655              OR
  8656           ((AM-IG = '1') AND
  8657           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8658              OR
  8659           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8660           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
  8661           (AM-IG NOT = '2'))
  8662              GO TO 03XX-GET-LIFE-ERPLAN.
  8663
  8664     IF (AM-BENEFIT-CODE (SUB5) EQUAL '92')
  8665       AND
  8666        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8667        IF CF-REDUCING (SUB3)
  8668           IF (PB-I-INDV-GRP-OVRD = 'G')
  8669              OR
  8670           ((AM-IG = '2') AND
  8671           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8672              OR
  8673           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8674           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8675           (AM-IG NOT = '1'))
  8676              GO TO 03XX-GET-LIFE-ERPLAN.
  8677
  8678     IF (AM-BENEFIT-CODE (SUB5) EQUAL '93')
  8679       AND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 159
* EL050.cbl
  8680        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8681        IF CF-LEVEL    (SUB3)
  8682           IF (PB-I-INDV-GRP-OVRD = 'I')
  8683              OR
  8684           ((AM-IG = '1') AND
  8685           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8686              OR
  8687           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8688           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8689            (AM-IG NOT = '2'))
  8690              GO TO 03XX-GET-LIFE-ERPLAN.
  8691
  8692     IF (AM-BENEFIT-CODE (SUB5) EQUAL '94')
  8693       AND
  8694        (AM-BENEFIT-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8695        IF CF-LEVEL    (SUB3)
  8696           IF (PB-I-INDV-GRP-OVRD = 'G')
  8697              OR
  8698           ((AM-IG = '2') AND
  8699           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8700              OR
  8701           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8702           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8703           (AM-IG NOT = '1'))
  8704              GO TO 03XX-GET-LIFE-ERPLAN.
  8705
  8706     IF SUB5 LESS THAN +20
  8707        ADD +1                   TO SUB5
  8708        GO TO 03XX-EDIT-FOR-NINETY-LF.
  8709
  8710     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8711
  8712     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  8713        GO TO 03XX-EDIT-FOR-NINETY-LF-CONT.
  8714
  8715     MOVE +1                     TO SUB5.
  8716
  8717 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8718
  8719     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  8720                                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8721
  8722     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  8723       AND
  8724        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8725        GO TO 03XX-GET-LIFE-ERPLAN.
  8726
  8727     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91')
  8728       AND
  8729        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8730        IF CF-REDUCING (SUB3)
  8731           IF (PB-I-INDV-GRP-OVRD = 'I')
  8732              OR
  8733           ((AM-IG = '1') AND
  8734           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8735              OR
  8736           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8737           (PB-I-INDV-GRP-OVRD  NOT = 'G') AND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 160
* EL050.cbl
  8738           (AM-IG NOT = '2'))
  8739              GO TO 03XX-GET-LIFE-ERPLAN.
  8740
  8741     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92')
  8742       AND
  8743        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8744        IF CF-REDUCING (SUB3)
  8745           IF (PB-I-INDV-GRP-OVRD = 'G')
  8746              OR
  8747           ((AM-IG = '2') AND
  8748           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  8749              OR
  8750           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8751           (PB-I-INDV-GRP-OVRD NOT  = 'I') AND
  8752           (AM-IG NOT = '1'))
  8753              GO TO 03XX-GET-LIFE-ERPLAN.
  8754
  8755     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '93')
  8756       AND
  8757        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8758        IF CF-LEVEL    (SUB3)
  8759           IF (PB-I-INDV-GRP-OVRD = 'I')
  8760              OR
  8761           ((AM-IG = '1') AND
  8762           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8763              OR
  8764           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  8765           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  8766            (AM-IG NOT = '2'))
  8767              GO TO 03XX-GET-LIFE-ERPLAN.
  8768
  8769     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '94')
  8770       AND
  8771        (AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-LIFE-OVERRIDE-L1)
  8772        IF CF-LEVEL    (SUB3)
  8773           IF (PB-I-INDV-GRP-OVRD = 'G')
  8774              OR
  8775           ((AM-IG = '2') AND
  8776           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  8777              OR
  8778           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  8779           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  8780           (AM-IG NOT = '1'))
  8781              GO TO 03XX-GET-LIFE-ERPLAN.
  8782
  8783     IF SUB5 LESS THAN +30
  8784        ADD +1                   TO SUB5
  8785        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-LF.
  8786
  8787     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  8788
  8789 03XX-EDIT-FOR-NINETY-LF-CONT.
  8790
  8791     MOVE +99                    TO SUB5.
  8792
  8793     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  8794        IF PB-ISSUE
  8795           MOVE ER-1924          TO  WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 161
* EL050.cbl
  8796           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  8797
  8798     GO TO 0304-LIFE-BENEFIT-FOUND.
  8799
  8800 03XX-GET-LIFE-ERPLAN.
  8801
  8802     IF WK-PLAN-ADDR EQUAL +0
  8803        GO TO 03XX-ERPLAN-LIFE-GETMAIN.
  8804
  8805     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  8806     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  8807     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  8808     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
  8809     MOVE 'Y'                    TO PLAN-MASTER-SW
  8810                                    PLAN-MASTER-LIFE-SW.
  8811     GO TO XXXX-CHECK-LF-PLAN-KEY.
  8812
  8813 03XX-ERPLAN-LIFE-GETMAIN.
  8814
  8815     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  8816     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  8817
  8818 03XX-ERPLAN-LIFE-READ.
  8819
  8820     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  8821     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  8822     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  8823     MOVE PB-SV-STATE            TO PLAN-STATE.
  8824     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  8825     MOVE PB-LIFE-OVERRIDE-L1    TO PLAN-BENEFIT-TYPE.
  8826     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  8827     MOVE WS-SAVE-BENEFIT-REVISION
  8828                                 TO PLAN-REVISION-NO.
  8829
  8830     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  8831     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-LIFE-SW.
  8832
  8833     IF PB-COMPANY-ID = 'NCL'
  8834       IF NOT LF-PLAN-MASTER-FOUND
  8835         IF NOT PB-POLICY-IS-DECLINED  AND
  8836            NOT PB-POLICY-IS-VOIDED
  8837             MOVE  ER-1921         TO  WS-ERROR
  8838             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  8839             GO TO 0304-LIFE-BENEFIT-FOUND.
  8840
  8841     IF NOT LF-PLAN-MASTER-FOUND
  8842        GO TO 0304-LIFE-BENEFIT-FOUND.
  8843
  8844 XXXX-CHECK-LF-PLAN-KEY.
  8845
  8846     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  8847        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  8848        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  8849        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  8850        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  8851        (PB-LIFE-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  8852        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  8853        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 162
* EL050.cbl
  8854        MOVE 'N'                 TO PLAN-MASTER-SW
  8855          GO TO 03XX-ERPLAN-LIFE-READ.
  8856
  8857     MOVE PLAN-MASTER          TO LINK-LIFE-PLAN-RECORD.
  8858
  8859     IF  PB-CANCELLATION
  8860         GO TO  0303-LF-ACCT-BEN-FOUND.
  8861
  8862     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  8863        IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  8864           (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  8865           IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  8866              MOVE ER-2644             TO WS-ERROR
  8867              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8868           ELSE
  8869              NEXT SENTENCE
  8870        ELSE
  8871           IF PB-COMPANY-ID NOT = 'NCL'
  8872              IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  8873                 MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  8874
  8875 0303-LF-ACCT-BEN-FOUND.
  8876
  8877     MOVE PL-REVISION-NO         TO WS-LIFE-REVISION.
  8878
  8879     IF PL-DEV-CODE NOT = SPACES
  8880        MOVE PL-DEV-CODE         TO WS-ACCT-LF-DEVIATION.
  8881
  8882     IF PL-DEV-PCT NUMERIC AND
  8883        PL-DEV-PCT NOT = ZEROS
  8884        MOVE PL-DEV-PCT          TO WS-ACCT-LF-DEV-PCT.
  8885
  8886     IF PL-TOL-PREM-AMT GREATER THAN +0
  8887        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-LF-PREM.
  8888
  8889     IF PL-TOL-REF-AMT GREATER THAN +0
  8890        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-LF-REFUND.
  8891
  8892     IF PL-TOL-PREM-PCT GREATER THAN +0
  8893        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-LF-PREM-PCT.
  8894
  8895     IF PL-TOL-REF-PCT GREATER THAN +0
  8896        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-LF-REFUND-PCT.
  8897
  8898     IF PL-TOL-CLM-AMT GREATER THAN +0
  8899        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-LF-CLAIM.
  8900
  8901     IF PL-OVER-SHORT-AMT NUMERIC  AND
  8902                          PL-OVER-SHORT-AMT > +0
  8903        MOVE PL-OVER-SHORT-AMT   TO WS-PL-REF-OVS-AMT.
  8904
  8905     IF PL-OVER-SHORT-PCT NUMERIC  AND
  8906                          PL-OVER-SHORT-PCT > +0
  8907        MOVE PL-OVER-SHORT-PCT   TO WS-PL-REF-OVS-PCT.
  8908
  8909     IF PL-SALES-TAX NUMERIC AND
  8910                          PL-SALES-TAX > +0
  8911         MOVE PL-SALES-TAX       TO WS-PL-SALES-TAX.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 163
* EL050.cbl
  8912
  8913     IF PL-IG NOT EQUAL SPACES AND ZEROS
  8914        MOVE PL-IG               TO WS-IG-OVRD-LF-PL
  8915                                    WS-IG-OVRD-AM.
  8916
  8917 0304-LIFE-BENEFIT-FOUND.
  8918
  8919     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-LF-BENEFIT-ALPHA.
  8920
  8921     IF PB-ISSUE
  8922        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-LF-ABBR
  8923     ELSE
  8924        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-LF-ABBR.
  8925
  8926     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO WS-LF-COVERAGE-TYPE.
  8927     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-LF-SPECIAL-CALC-CD.
  8928     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-LF-JOINT-INDICATOR.
  8929     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-LF-BEN.
  8930     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-LF-EARNINGS-CALC
  8931                                         WS-LF-REFUND-CALC.
  8932     if (ws-lf-earnings-calc = '5')
  8933        and (pb-i-loan-apr = zeros)
  8934        and (benefit-code-chg)
  8935        move +99.9999 to pb-i-loan-apr
  8936     end-if
  8937
  8938     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  8939        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-LF-REFUND-CALC.
  8940
  8941     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  8942        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-LF-REM-TERM-CALC.
  8943     MOVE CF-BENEFIT-CATEGORY (SUB3) TO WS-LF-BEN-CATEGORY
  8944
  8945     MOVE CF-LF-COVERAGE-TYPE  (SUB3) TO EC-BR-LF-COVERAGE-TYPE.
  8946     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-LF-SPECIAL-CALC-CD.
  8947     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-LF-BEN-I-G-CD.
  8948     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-LF-EARNINGS-CALC.
  8949     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-LF-REFUND-CALC.
  8950     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-LF-REM-TERM-CALC.
  8951
  8952     IF PB-COMPANY-ID = 'NCL'  AND
  8953        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  8954         NEXT SENTENCE
  8955     ELSE
  8956         IF SUB5 NOT GREATER THAN +20
  8957            IF WS-SAVE-BENEFIT-REM-TERM  GREATER '0'
  8958               MOVE WS-SAVE-BENEFIT-REM-TERM
  8959                                      TO WS-AM-LF-BENE-REM-TERM
  8960                                         EC-BR-LF-REM-TERM-CALC.
  8961
  8962     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-LF-COMMENT.
  8963     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-LF-DESC.
  8964
  8965     GO TO 0310-FIND-AH-BENEFIT-RECORD.
  8966
  8967 0305-BENEFIT-NOT-FOUND.
  8968
  8969     MOVE '1'                    TO LF-BENEFIT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 164
* EL050.cbl
  8970     MOVE ER-2604                TO WS-ERROR.
  8971     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8972
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 165
* EL050.cbl
  8974
  8975 0310-FIND-AH-BENEFIT-RECORD.
  8976
  8977     MOVE 'N'                    TO PLAN-MASTER-SW
  8978                                    PLAN-MASTER-AH-SW.
  8979
  8980     MOVE ZEROS                  TO WS-PL-TOL-AH-PREM
  8981                                    WS-PL-TOL-AH-REFUND
  8982                                    WS-AH-PL-REF-OVS-AMT
  8983                                    WS-PL-TOL-AH-PREM-PCT
  8984                                    WS-PL-TOL-AH-REFUND-PCT
  8985                                    WS-AH-PL-REF-OVS-PCT
  8986                                    WS-PL-TOL-AH-CLAIM.
  8987     MOVE ' '                    TO WS-AH-DCC-TRUNC
  8988
  8989
  8990     if pb-issue
  8991        IF PB-I-AH-INPUT-CD EQUAL ZEROS
  8992           MOVE SPACES              TO PB-I-AH-INPUT-CD
  8993        end-if
  8994        IF (PB-I-AH-INPUT-CD NOT EQUAL SPACES)
  8995           and (PB-I-AH-BENEFIT-CD = SPACES OR ZEROS)
  8996           GO TO 0399-BENEFIT-NOT-FOUND
  8997        end-if
  8998     end-if
  8999
  9000     IF WS-AH-BENEFIT-CD = ZEROS  OR  SPACES
  9001        GO TO 0400-FIND-CARRIER.
  9002
  9003     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9004
  9005     IF WK-AH-BEN-ADDR NOT = ZEROS
  9006         MOVE WK-AH-BEN-ADDR     TO ELCNTL-WS-COMP
  9007         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9008         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9009         IF WS-AH-BENEFIT-CD NOT GREATER THAN CF-HI-BEN-IN-REC
  9010           AND NOT LESS THAN CF-BENEFIT-CODE (1)
  9011             GO TO 0311-AH-BENEFIT-SEARCH
  9012         ELSE
  9013             NEXT SENTENCE
  9014     ELSE
  9015         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9016
  9017     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9018     MOVE '5'                    TO CNTL-REC-TYPE.
  9019     MOVE +0                     TO CNTL-SEQ-NO.
  9020     MOVE WS-ACCESS              TO CNTL-ACCESS.
  9021
  9022     MOVE '2' TO RC-SW-2.
  9023     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9024
  9025     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID)  OR
  9026        (CNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  9027          GO TO 0399-BENEFIT-NOT-FOUND.
  9028
  9029     MOVE ELCNTL-WS-COMP         TO WK-AH-BEN-ADDR.
  9030
  9031 0311-AH-BENEFIT-SEARCH.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 166
* EL050.cbl
  9032
  9033     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
  9034
  9035     IF NO-BENEFIT-FOUND
  9036         GO TO 0399-BENEFIT-NOT-FOUND.
  9037
  9038     IF WS-BEN-CD = '99'
  9039        GO TO 0399-BENEFIT-NOT-FOUND.
  9040
  9041     IF PB-COMPANY-ID  =  'NCL'
  9042         IF CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9043             GO TO 0314-A-H-BENEFIT-FOUND.
  9044
  9045     MOVE +1                     TO SUB5.
  9046     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9047
  9048* FOR DMD, OVERRIDE VALUE IN WS-BEN-CD WITH BEN CODE FROM CERT #
  9049* BEFORE CHECKING BEN CODE AGAINST ACCOUNT MASTER VALID VALUES.
  9050     IF PB-COMPANY-ID = 'DMD'
  9051         MOVE PB-CERT-NO (5:2)   TO WS-BEN-CD.
  9052
  9053 0312-EDIT-ACCT-AH-BENEFITS.
  9054
  9055     IF AM-BENEFIT-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9056        IF WS-BEN-CD = AM-BENEFIT-CODE (SUB5)
  9057           MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9058                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9059           GO TO 03XX-GET-AH-ERPLAN.
  9060
  9061     IF SUB5 LESS THAN +20
  9062        ADD +1                   TO SUB5
  9063        GO TO 0312-EDIT-ACCT-AH-BENEFITS.
  9064
  9065     MOVE +1                     TO SUB5.
  9066
  9067     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9068        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9069
  9070 0313-EDIT-DMD-EXTRA-BENEFITS.
  9071
  9072     IF AM-BENEFIT-DMD-TYPE (SUB5) = PB-AH-OVERRIDE-L1
  9073        IF WS-BEN-CD = AM-BENEFIT-DMD-CODE (SUB5)
  9074           MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9075                                 TO WS-SAVE-ALLOWABLE-BENEFIT
  9076           GO TO 03XX-GET-AH-ERPLAN.
  9077
  9078     IF SUB5 LESS THAN +30
  9079        ADD +1                   TO SUB5
  9080        GO TO 0313-EDIT-DMD-EXTRA-BENEFITS.
  9081
  9082     MOVE +1                     TO SUB5.
  9083
  9084 03XX-EDIT-FOR-NINETY-AH.
  9085
  9086***************************************************************
  9087*                                                             *
  9088*    NINETY BENEFIT PLAN TYPES:                               *
  9089*                                                             *
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 167
* EL050.cbl
  9090*      91 = ALL INDIVIDUAL REDUCING BENEFITS.                 *
  9091*      92 = ALL GROUP REDUCING BENEFITS.                      *
  9092*      98 = ALL BENEFITS EXCEPT THOSE CODED IN ACCOUNT        *
  9093*           BENEFIT CONTROLS.                                 *
  9094*      99 = ALL BENEFITS.                                     *
  9095*                                                             *
  9096***************************************************************
  9097
  9098     MOVE AM-ALLOWABLE-BENEFITS (SUB5)
  9099                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9100
  9101     IF (AM-BENEFIT-CODE (SUB5) EQUAL '98' OR '99')
  9102       AND
  9103        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9104        GO TO 03XX-GET-AH-ERPLAN.
  9105
  9106     IF AM-BENEFIT-CODE (SUB5) EQUAL '91'
  9107       AND
  9108        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9109           IF (PB-I-INDV-GRP-OVRD = 'I')
  9110              OR
  9111           ((AM-IG = '1') AND
  9112           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9113              OR
  9114           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9115           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9116           (AM-IG NOT = '2'))
  9117              GO TO 03XX-GET-AH-ERPLAN.
  9118
  9119     IF AM-BENEFIT-CODE (SUB5) EQUAL '92'
  9120       AND
  9121        AM-BENEFIT-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9122           IF (PB-I-INDV-GRP-OVRD = 'G')
  9123              OR
  9124           ((AM-IG = '2') AND
  9125           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9126              OR
  9127           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9128           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9129           (AM-IG NOT = '1'))
  9130              GO TO 03XX-GET-AH-ERPLAN.
  9131
  9132     IF SUB5 LESS THAN +20
  9133        ADD +1                   TO SUB5
  9134        GO TO 03XX-EDIT-FOR-NINETY-AH.
  9135
  9136     IF  PB-COMPANY-ID NOT EQUAL 'DMD'
  9137        GO TO 03XX-EDIT-FOR-NINETY-AH-CONT.
  9138
  9139     MOVE +1                    TO SUB5.
  9140
  9141 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9142
  9143     MOVE AM-ALLOWABLE-DMD-BENEFITS (SUB5)
  9144                                TO WS-SAVE-ALLOWABLE-BENEFIT.
  9145
  9146     IF (AM-BENEFIT-DMD-CODE (SUB5) EQUAL '98' OR '99')
  9147       AND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 168
* EL050.cbl
  9148        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9149        GO TO 03XX-GET-AH-ERPLAN.
  9150
  9151     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '91'
  9152       AND
  9153        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9154           IF (PB-I-INDV-GRP-OVRD = 'I')
  9155              OR
  9156           ((AM-IG = '1') AND
  9157           (PB-I-INDV-GRP-OVRD NOT = 'G'))
  9158              OR
  9159           ((CF-CO-BEN-I-G-CD (SUB3) = 'I') AND
  9160           (PB-I-INDV-GRP-OVRD NOT = 'G')  AND
  9161           (AM-IG NOT = '2'))
  9162              GO TO 03XX-GET-AH-ERPLAN.
  9163
  9164     IF AM-BENEFIT-DMD-CODE (SUB5) EQUAL '92'
  9165       AND
  9166        AM-BENEFIT-DMD-TYPE (SUB5) EQUAL PB-AH-OVERRIDE-L1
  9167           IF (PB-I-INDV-GRP-OVRD = 'G')
  9168              OR
  9169           ((AM-IG = '2') AND
  9170           (PB-I-INDV-GRP-OVRD NOT = 'I'))
  9171              OR
  9172           ((CF-CO-BEN-I-G-CD (SUB3) = 'G') AND
  9173           (PB-I-INDV-GRP-OVRD NOT = 'I')  AND
  9174           (AM-IG NOT = '1'))
  9175              GO TO 03XX-GET-AH-ERPLAN.
  9176
  9177     IF SUB5 LESS THAN +30
  9178        ADD +1                   TO SUB5
  9179        GO TO 03XX-EDIT-DMD-EXTRA-NINETY-AH.
  9180
  9181 03XX-EDIT-FOR-NINETY-AH-CONT.
  9182
  9183     MOVE +99                    TO SUB5.
  9184
  9185     MOVE SPACES                 TO WS-SAVE-ALLOWABLE-BENEFIT.
  9186
  9187     IF AM-BENEFIT-TABLE-USAGE EQUAL 'Y' OR 'E'
  9188        IF PB-ISSUE
  9189           MOVE ER-1925          TO  WS-ERROR
  9190           PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  9191
  9192     GO TO 0314-A-H-BENEFIT-FOUND.
  9193
  9194 03XX-GET-AH-ERPLAN.
  9195
  9196     IF WK-PLAN-ADDR EQUAL +0
  9197         GO TO 03XX-ERPLAN-AH-GETMAIN.
  9198
  9199     MOVE WK-PLAN-ADDR           TO ERPLAN-WS-COMP.
  9200     SET ERPLAN-FILE-ADDRESSED   TO TRUE.
  9201     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
  9202     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
  9203     MOVE 'Y'                    TO PLAN-MASTER-SW
  9204                                    PLAN-MASTER-AH-SW.
  9205*****GO TO XXXX-CHECK-AH-PLAN-KEY.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 169
* EL050.cbl
  9206     GO TO 03XX-ERPLAN-AH-READ.
  9207
  9208 03XX-ERPLAN-AH-GETMAIN.
  9209
  9210     PERFORM 8557-GETMAIN-ERPLAN THRU 8557-EXIT.
  9211     MOVE ERPLAN-WS-COMP         TO WK-PLAN-ADDR.
  9212
  9213 03XX-ERPLAN-AH-READ.
  9214
  9215     MOVE PB-COMPANY-CD          TO PLAN-COMPANY-CD.
  9216     MOVE PB-SV-CARRIER          TO PLAN-CARRIER.
  9217     MOVE PB-SV-GROUPING         TO PLAN-GROUPING.
  9218     MOVE PB-SV-STATE            TO PLAN-STATE.
  9219     MOVE PB-ACCOUNT             TO PLAN-ACCOUNT.
  9220     MOVE PB-AH-OVERRIDE-L1      TO PLAN-BENEFIT-TYPE.
  9221     MOVE WS-SAVE-BENEFIT-CODE   TO PLAN-BENEFIT-CODE.
  9222     MOVE WS-SAVE-BENEFIT-REVISION
  9223                                 TO PLAN-REVISION-NO.
  9224
  9225     PERFORM 8585-READ-PLAN-MASTER THRU 8585-EXIT.
  9226     MOVE PLAN-MASTER-SW         TO PLAN-MASTER-AH-SW.
  9227
  9228     IF PB-COMPANY-ID = 'NCL'
  9229       IF NOT AH-PLAN-MASTER-FOUND
  9230         IF NOT PB-POLICY-IS-DECLINED  AND
  9231            NOT PB-POLICY-IS-VOIDED
  9232             MOVE  ER-1922         TO  WS-ERROR
  9233             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
  9234             GO TO 0314-A-H-BENEFIT-FOUND.
  9235
  9236     IF NOT AH-PLAN-MASTER-FOUND
  9237        GO TO 0314-A-H-BENEFIT-FOUND.
  9238
  9239 XXXX-CHECK-AH-PLAN-KEY.
  9240
  9241     IF (PB-COMPANY-CD   NOT EQUAL PL-COMPANY-CD) OR
  9242        (PB-SV-CARRIER   NOT EQUAL PL-CARRIER)    OR
  9243        (PB-SV-GROUPING  NOT EQUAL PL-GROUPING)   OR
  9244        (PB-SV-STATE     NOT EQUAL PL-STATE)      OR
  9245        (PB-ACCOUNT      NOT EQUAL PL-ACCOUNT)    OR
  9246        (PB-AH-OVERRIDE-L1 NOT EQUAL PL-BENEFIT-TYPE) OR
  9247        (PL-BENEFIT-CODE NOT EQUAL WS-SAVE-BENEFIT-CODE)   OR
  9248        (PL-REVISION-NO  NOT EQUAL WS-SAVE-BENEFIT-REVISION)
  9249        MOVE 'N'                 TO PLAN-MASTER-SW
  9250          GO TO 03XX-ERPLAN-AH-READ.
  9251
  9252     MOVE PLAN-MASTER          TO LINK-AH-PLAN-RECORD.
  9253
  9254     IF  PB-CANCELLATION
  9255         GO TO  0313-AH-ACCT-BEN-FOUND.
  9256
  9257     IF PL-EDIT-FOR-FORM EQUAL 'Y'
  9258       IF (PL-POLICY-FORM NOT EQUAL SPACES AND ZEROS) AND
  9259          (PB-I-POLICY-FORM-NO NOT EQUAL SPACES AND ZEROS)
  9260          IF PL-POLICY-FORM NOT EQUAL PB-I-POLICY-FORM-NO
  9261             MOVE ER-2644             TO WS-ERROR
  9262             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9263          ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 170
* EL050.cbl
  9264             NEXT SENTENCE
  9265       ELSE
  9266          IF PB-COMPANY-ID NOT = 'NCL'
  9267             IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
  9268                MOVE PL-POLICY-FORM   TO PB-I-POLICY-FORM-NO.
  9269
  9270 0313-AH-ACCT-BEN-FOUND.
  9271
  9272     MOVE PL-REVISION-NO         TO WS-AH-REVISION.
  9273
  9274     IF PL-DEV-CODE NOT = SPACES
  9275        MOVE PL-DEV-CODE         TO WS-ACCT-AH-DEVIATION.
  9276
  9277     IF PL-DEV-PCT NUMERIC AND
  9278        PL-DEV-PCT NOT = ZEROS
  9279        MOVE PL-DEV-PCT          TO WS-ACCT-AH-DEV-PCT.
  9280
  9281     IF PL-TOL-PREM-AMT NOT EQUAL +0
  9282        MOVE PL-TOL-PREM-AMT     TO WS-PL-TOL-AH-PREM.
  9283
  9284     IF PL-TOL-REF-AMT NOT EQUAL +0
  9285        MOVE PL-TOL-REF-AMT      TO WS-PL-TOL-AH-REFUND.
  9286
  9287     IF PL-TOL-PREM-PCT GREATER THAN +0
  9288        MOVE PL-TOL-PREM-PCT     TO WS-PL-TOL-AH-PREM-PCT.
  9289
  9290     IF PL-TOL-REF-PCT GREATER THAN +0
  9291        MOVE PL-TOL-REF-PCT      TO WS-PL-TOL-AH-REFUND-PCT.
  9292
  9293     IF PL-TOL-CLM-AMT NOT EQUAL +0
  9294        MOVE PL-TOL-CLM-AMT      TO WS-PL-TOL-AH-CLAIM.
  9295
  9296     IF PL-OVER-SHORT-AMT NUMERIC AND
  9297                          PL-OVER-SHORT-AMT > +0
  9298        MOVE PL-OVER-SHORT-AMT   TO WS-AH-PL-REF-OVS-AMT.
  9299
  9300     IF PL-OVER-SHORT-PCT NUMERIC AND
  9301                          PL-OVER-SHORT-PCT > +0
  9302        MOVE PL-OVER-SHORT-PCT TO WS-AH-PL-REF-OVS-PCT.
  9303
  9304     IF PL-IG NOT EQUAL SPACES AND ZEROS
  9305        MOVE PL-IG               TO WS-IG-OVRD-AH-PL
  9306        IF WS-IG-OVRD-AM EQUAL SPACES
  9307            MOVE PL-IG           TO WS-IG-OVRD-AM.
  9308
  9309 0314-A-H-BENEFIT-FOUND.
  9310
  9311     MOVE CF-BENEFIT-ALPHA     (SUB3) TO WS-AH-BENEFIT-ALPHA.
  9312
  9313     IF PB-ISSUE
  9314        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-I-AH-ABBR
  9315       ELSE
  9316        MOVE CF-BENEFIT-ALPHA  (SUB3) TO PB-CI-AH-ABBR.
  9317
  9318     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO WS-AH-SPECIAL-CALC-CD
  9319     if cf-maximum-benefits (sub3) numeric
  9320        move cf-maximum-benefits (sub3)
  9321                                 to ws-ah-max-bens
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 171
* EL050.cbl
  9322     else
  9323        move zeros               to ws-ah-max-bens
  9324     end-if
  9325     MOVE CF-JOINT-INDICATOR   (SUB3) TO WS-AH-JOINT-INDICATOR.
  9326     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO WS-IG-OVRD-AH-BEN.
  9327     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO WS-AH-EARNINGS-CALC
  9328                                         WS-AH-REFUND-CALC.
  9329
  9330     IF CF-CO-REFUND-CALC (SUB3) GREATER '0'
  9331        MOVE CF-CO-REFUND-CALC    (SUB3) TO WS-AH-REFUND-CALC.
  9332
  9333     IF CF-CO-REM-TERM-CALC (SUB3) GREATER '0'
  9334        MOVE CF-CO-REM-TERM-CALC (SUB3)  TO WS-AH-REM-TERM-CALC.
  9335     MOVE CF-BENEFIT-CATEGORY (SUB3)  TO WS-AH-BEN-CATEGORY
  9336
  9337     MOVE CF-BENEFIT-ALPHA     (SUB3) TO EC-BR-AH-COVERAGE-TYPE.
  9338     MOVE CF-SPECIAL-CALC-CD   (SUB3) TO EC-BR-AH-SPECIAL-CALC-CD.
  9339     MOVE CF-CO-BEN-I-G-CD     (SUB3) TO EC-BR-AH-BEN-I-G-CD.
  9340     MOVE CF-CO-EARNINGS-CALC  (SUB3) TO EC-BR-AH-EARNINGS-CALC.
  9341     MOVE CF-CO-REFUND-CALC    (SUB3) TO EC-BR-AH-REFUND-CALC.
  9342     MOVE CF-CO-REM-TERM-CALC  (SUB3) TO EC-BR-AH-REM-TERM-CALC.
  9343
  9344     IF PB-COMPANY-ID = 'NCL'  AND
  9345        CF-SPECIAL-CALC-CD (SUB3)  =  'O'
  9346         NEXT SENTENCE
  9347     ELSE
  9348         IF SUB5 NOT GREATER THAN +20
  9349            IF WS-SAVE-BENEFIT-REM-TERM   GREATER '0'
  9350                MOVE WS-SAVE-BENEFIT-REM-TERM
  9351                                      TO WS-AM-AH-BENE-REM-TERM
  9352                                         EC-BR-AH-REM-TERM-CALC.
  9353
  9354     MOVE CF-BENEFIT-COMMENT   (SUB3) TO EC-BR-AH-COMMENT.
  9355     MOVE CF-BENEFIT-DESCRIP   (SUB3) TO EC-BR-AH-DESC.
  9356
  9357     GO TO 0400-FIND-CARRIER.
  9358
  9359 0399-BENEFIT-NOT-FOUND.
  9360
  9361     MOVE '1'                    TO AH-BENEFIT-ERROR.
  9362     MOVE ER-2605                TO WS-ERROR.
  9363     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9364
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 172
* EL050.cbl
  9366
  9367 0400-FIND-CARRIER.
  9368
  9369     MOVE PB-SV-CARRIER          TO WS-CARR.
  9370
  9371     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9372     MOVE ZEROS                  TO CNTL-SEQ-NO.
  9373     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
  9374     MOVE '6'                    TO CNTL-REC-TYPE.
  9375
  9376*INITIALIZE ELC50WS RATING SWITCH FIELD FOR DMD
  9377     MOVE SPACE                  TO WS-DMD-RATING-SW
  9378                                    EC-BR-DMD-RATING-SW.
  9379
  9380     MOVE '2'                    TO RC-SW-1.
  9381     PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
  9382
  9383     IF NOT CF-CARRIER-MASTER
  9384        GO TO 0400-CARRIER-NOT-FOUND.
  9385
  9386 0400-BUILD-CARR-TOL.
  9387
  9388     IF CF-CR-TOL-PREM NUMERIC AND
  9389        CF-CR-TOL-PREM GREATER THAN +0
  9390        MOVE CF-CR-TOL-PREM      TO WS-TOL-LF-PREM
  9391                                    WS-TOL-AH-PREM.
  9392
  9393     IF CF-CR-TOL-REFUND NUMERIC AND
  9394        CF-CR-TOL-REFUND GREATER THAN +0
  9395        MOVE  CF-CR-TOL-REFUND   TO WS-TOL-LF-REFUND
  9396                                    WS-TOL-AH-REFUND.
  9397
  9398     IF CF-CR-OVR-SHT-AMT NUMERIC AND
  9399        CF-CR-OVR-SHT-AMT GREATER THAN +0
  9400        MOVE CF-CR-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9401                                    WS-AH-REFUND-OVS-AMT.
  9402
  9403     IF CF-CR-OVR-SHT-PCT NUMERIC AND
  9404        CF-CR-OVR-SHT-PCT GREATER THAN +0
  9405        MOVE CF-CR-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9406                                    WS-AH-REFUND-OVS-PCT.
  9407
  9408     IF CF-CR-TOL-PREM-PCT NUMERIC AND
  9409        CF-CR-TOL-PREM-PCT GREATER THAN +0
  9410        MOVE CF-CR-TOL-PREM-PCT  TO WS-TOL-LF-PREM-PCT
  9411                                    WS-TOL-AH-PREM-PCT.
  9412
  9413     IF CF-CR-TOL-REFUND-PCT NUMERIC AND
  9414        CF-CR-TOL-REFUND-PCT GREATER THAN +0
  9415        MOVE CF-CR-TOL-REFUND-PCT TO WS-TOL-LF-REFUND-PCT
  9416                                     WS-TOL-AH-REFUND-PCT.
  9417
  9418     IF CF-COMPANY-ID EQUAL 'DMD'
  9419         MOVE CF-RATING-SWITCH   TO WS-DMD-RATING-SW
  9420                                    EC-BR-DMD-RATING-SW.
  9421
  9422     MOVE CF-SECPAY-SWITCH       TO WS-SECPAY-SWITCH
  9423     IF CF-CARRIER-CLP-TOL-PCT NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 173
* EL050.cbl
  9424        MOVE +0                  TO CF-CARRIER-CLP-TOL-PCT
  9425     END-IF
  9426     IF CF-CARRIER-LEASE-COMM NOT NUMERIC
  9427        MOVE +0                  TO CF-CARRIER-LEASE-COMM
  9428     END-IF
  9429     IF WS-TOL-CLP-PCT = ZEROS
  9430        MOVE CF-CARRIER-CLP-TOL-PCT TO WS-TOL-CLP-PCT
  9431     END-IF
  9432
  9433     IF WS-SPP-LEASE-COMM = ZEROS
  9434        MOVE CF-CARRIER-LEASE-COMM TO WS-SPP-LEASE-COMM
  9435     END-IF
  9436     GO TO 0400-FIND-ERPDEF.
  9437
  9438 0400-CARRIER-NOT-FOUND.
  9439
  9440     MOVE ER-2602                TO WS-ERROR.
  9441     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9442
  9443 0400-FIND-ERPDEF.
  9444     IF PB-COMPANY-ID = 'DCC'
  9445        AND AM-DCC-PRODUCT-CODE = 'DDF'
  9446        CONTINUE
  9447     ELSE
  9448        GO TO 0400-FIND-ERCOMP
  9449     END-IF
  9450     MOVE ' '                    TO PDEF-MASTER-SW
  9451     MOVE PB-COMPANY-CD          TO ERPDEF-KEY
  9452     MOVE PB-STATE               TO ERPDEF-STATE
  9453     IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
  9454        MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
  9455     END-IF
  9456     MOVE AM-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9457     MOVE 'A'                    TO ERPDEF-BEN-TYPE
  9458     IF PB-ISSUE
  9459        MOVE PB-I-AH-BENEFIT-CD  TO ERPDEF-BEN-CODE
  9460     ELSE
  9461        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
  9462     END-IF
  9463     MOVE PB-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9464     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9465     PERFORM 8587-START-ERPDEF   THRU 8587-EXIT
  9466     IF PDEF-MASTER-FOUND
  9467        MOVE 'N'                 TO PDEF-MASTER-SW
  9468        PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9469        IF PDEF-MASTER-FOUND
  9470           IF (ERPDEF-KEY-SAVE (1:16) =
  9471                        PD-CONTROL-PRIMARY (1:16))
  9472              AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9473              CONTINUE
  9474           ELSE
  9475              PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
  9476              IF (ERPDEF-KEY-SAVE (1:16) =
  9477                        PD-CONTROL-PRIMARY (1:16))
  9478                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
  9479                 CONTINUE
  9480              ELSE
  9481                 MOVE 'N'        TO PDEF-MASTER-SW
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 174
* EL050.cbl
  9482              END-IF
  9483           END-IF
  9484        END-IF
  9485        PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
  9486     END-IF
  9487     IF PDEF-MASTER-FOUND
  9488        IF PD-TRUNCATED = 'Y'
  9489           MOVE 'T'              TO WS-AH-DCC-TRUNC
  9490        END-IF
  9491     END-IF
  9492     .
  9493 0400-FIND-ERCOMP.
  9494     IF PB-COMPANY-ID = 'DCC'
  9495        PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9496           (WS-SUB1 > +10)
  9497           IF AM-COM-TYP (WS-SUB1) = 'K' OR 'I' OR 'L' OR 'J'
  9498                 OR 'A' OR 'N'
  9499              MOVE PB-COMPANY-CD TO COMP-COMP-CD
  9500              MOVE PB-CARRIER    TO COMP-CARRIER
  9501              MOVE PB-GROUPING   TO COMP-GROUPING
  9502              MOVE LOW-VALUES    TO COMP-ACCOUNT
  9503              MOVE AM-AGT (WS-SUB1)
  9504                                 TO COMP-FIN-RESP
  9505              MOVE 'G'           TO COMP-TYPE
  9506              PERFORM 8582-READ-COMPENSATION-MASTER
  9507                                 THRU 8582-EXIT
  9508              IF COMP-MASTER-FOUND
  9509                 IF CO-GA-INACTIVE
  9510                    MOVE ER-2763 TO WS-ERROR
  9511                    PERFORM 9900-ERROR-FORMAT
  9512                                 THRU 9900-EXIT
  9513                    MOVE +11     TO WS-SUB1
  9514                 END-IF
  9515                 IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9516                    OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9517                    MOVE ER-2788 TO WS-ERROR
  9518                    PERFORM 9900-ERROR-FORMAT
  9519                                 THRU 9900-EXIT
  9520                    MOVE +11     TO WS-SUB1
  9521                 END-IF
  9522              END-IF
  9523           END-IF
  9524        END-PERFORM
  9525     END-IF
  9526     IF PB-COMPANY-ID = 'DCC'
  9527        IF AM-DCC-CLP-STATE NOT = SPACES AND LOW-VALUES
  9528           MOVE AM-DCC-CLP-STATE TO PB-I-CLP-STATE
  9529                                    WS-CLP-STATE
  9530        ELSE
  9531           MOVE SPACES           TO PB-I-CLP-STATE
  9532                                    WS-CLP-STATE
  9533        END-IF
  9534     END-IF
  9535
  9536     IF (PB-COMPANY-ID = 'DCC')
  9537        AND(WS-AH-BEN-CATEGORY = 'G' OR 'L')
  9538        AND (AM-DCC-PRODUCT-CODE NOT = 'DDF')
  9539        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 175
* EL050.cbl
  9540     ELSE
  9541        GO TO 0400-FIND-STATE-RECORD
  9542     END-IF
  9543     MOVE SPACES                 TO WS-CLP-STATE
  9544     MOVE +0                     TO WS-BANK-FEE
  9545                                    WS-BANK-LFEE
  9546                                    WS-BANK-NOCHRGB
  9547
  9548     MOVE LOW-VALUES             TO COMP-FIN-RESP
  9549     IF (PB-ISSUE)
  9550        AND (PB-I-BANK-NUMBER NOT =
  9551            SPACES AND ZEROS AND LOW-VALUES)
  9552        MOVE PB-I-BANK-NUMBER    TO COMP-FIN-RESP
  9553     ELSE
  9554        IF (PB-CANCELLATION)
  9555           AND (PB-CI-BANK-NUMBER NOT =
  9556                SPACES AND ZEROS AND LOW-VALUES)
  9557           MOVE PB-CI-BANK-NUMBER TO COMP-FIN-RESP
  9558        END-IF
  9559     END-IF
  9560     IF COMP-FIN-RESP NOT = LOW-VALUES
  9561        MOVE PB-COMPANY-CD       TO COMP-COMP-CD
  9562        MOVE PB-CARRIER          TO COMP-CARRIER
  9563        MOVE PB-GROUPING         TO COMP-GROUPING
  9564        MOVE LOW-VALUES          TO COMP-ACCOUNT
  9565        MOVE 'B'                 TO COMP-TYPE
  9566        PERFORM 8582-READ-COMPENSATION-MASTER
  9567                                 THRU 8582-EXIT
  9568        IF COMP-MASTER-FOUND
  9569           IF CO-MAX-BANK-FEE NOT NUMERIC
  9570              MOVE +0            TO CO-MAX-BANK-FEE
  9571           END-IF
  9572           IF CO-MAX-BANK-FEE-LEASE NOT NUMERIC
  9573              MOVE +0            TO CO-MAX-BANK-FEE-LEASE
  9574           END-IF
  9575           IF CO-GA-INACTIVE
  9576              MOVE ER-2763       TO WS-ERROR
  9577              PERFORM 9900-ERROR-FORMAT
  9578                                 THRU 9900-EXIT
  9579           END-IF
  9580           IF (CO-GA-EFFECTIVE-DT = SPACES OR LOW-VALUES)
  9581              OR (PB-CERT-EFF-DT < CO-GA-EFFECTIVE-DT)
  9582              MOVE ER-2788 TO WS-ERROR
  9583              PERFORM 9900-ERROR-FORMAT
  9584                                 THRU 9900-EXIT
  9585              MOVE +11     TO WS-SUB1
  9586           END-IF
  9587           IF WS-AH-BEN-CATEGORY = 'G'
  9588              MOVE CO-MAX-BANK-FEE
  9589                                 TO WS-BANK-FEE
  9590                                    PB-I-BANK-FEE
  9591           ELSE
  9592              MOVE CO-MAX-BANK-FEE-LEASE
  9593                                 TO WS-BANK-LFEE
  9594                                    PB-I-BANK-FEE
  9595           END-IF
  9596           IF ((CO-SPP-REFUND-EDIT = 'N' OR 'B' OR ' ')
  9597              AND (WS-AH-REFUND-CALC = 'G'))
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 176
* EL050.cbl
  9598                        OR
  9599              ((CO-SPP-REFUND-EDIT = 'R' OR ' ' OR 'B')
  9600              AND (WS-AH-REFUND-CALC NOT = 'G'))
  9601              CONTINUE
  9602           ELSE
  9603              MOVE ER-2789 TO WS-ERROR
  9604              PERFORM 9900-ERROR-FORMAT
  9605                                 THRU 9900-EXIT
  9606           END-IF
  9607           MOVE CO-CLP-STATE     TO WS-CLP-STATE
  9608                                    PB-I-CLP-STATE
  9609           MOVE CO-COMPANY-CD    TO BXRF-COMP-CD
  9610           MOVE CO-CARRIER       TO BXRF-CARRIER
  9611           MOVE CO-GROUPING      TO BXRF-GROUPING
  9612           MOVE CO-RESP-NO       TO BXRF-BANK-NUMBER
  9613           MOVE BXRF-MAX-REC-LENGTH
  9614                                 TO BXRF-REC-LENGTH
  9615           PERFORM 8584-READ-BANK-CROSS-REF
  9616                                 THRU 8584-EXIT
  9617           IF BXRF-MASTER-FOUND
  9618              MOVE ' '           TO BANK-ACCT-SW
  9619              MOVE BK-BANK-POINTER-CNT
  9620                                 TO BK-BANK-POINTER-CNT
  9621              PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9622                 (WS-SUB1 > BK-BANK-POINTER-CNT)
  9623                 OR (BANK-ACCT-FOUND)
  9624                 IF (BK-AM-ACCOUNT (WS-SUB1) = PB-ACCOUNT)
  9625                    AND (BK-AM-EXP-DT (WS-SUB1)
  9626                                 > PB-CERT-EFF-DT)
  9627                    AND (BK-AM-EFF-DT (WS-SUB1)
  9628                                 NOT > PB-CERT-EFF-DT)
  9629                    SET BANK-ACCT-FOUND TO TRUE
  9630                 END-IF
  9631              END-PERFORM
  9632              IF NOT BANK-ACCT-FOUND
  9633                 MOVE ZEROS      TO WS-BANK-FEE
  9634                                    WS-BANK-LFEE
  9635                 MOVE ER-2869    TO WS-ERROR
  9636                 PERFORM 9900-ERROR-FORMAT
  9637                                 THRU 9900-EXIT
  9638              ELSE
  9639                 PERFORM 5000-PROCESS-REPS
  9640                                 THRU 5000-EXIT
  9641                 IF AGENT-MASTER-FOUND
  9642                    MOVE +0      TO WS-BANK-FEE
  9643                                    WS-BANK-LFEE
  9644*                   MOVE AG-SPP-FEES (1)
  9645*                                TO PB-I-BANK-FEE
  9646*                                   WS-BANK-FEE
  9647                    PERFORM VARYING WS-SUB1 FROM +1 BY +1 UNTIL
  9648                       (WS-SUB1 > +10)
  9649                       IF AG-SPP-FEES (WS-SUB1) NOT NUMERIC
  9650                          MOVE +0 TO AG-SPP-FEES (WS-SUB1)
  9651                       END-IF
  9652                       IF AG-SPP-LFEES (WS-SUB1) NOT NUMERIC
  9653                          MOVE +0 TO AG-SPP-LFEES (WS-SUB1)
  9654                       END-IF
  9655                       COMPUTE WS-BANK-FEE = WS-BANK-FEE +
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 177
* EL050.cbl
  9656                          AG-SPP-FEES (WS-SUB1)
  9657                       COMPUTE WS-BANK-LFEE = WS-BANK-LFEE +
  9658                          AG-SPP-LFEES (WS-SUB1)
  9659                    END-PERFORM
  9660                    IF WS-AH-BEN-CATEGORY = 'G'
  9661                       MOVE WS-BANK-FEE
  9662                                 TO PB-I-BANK-FEE
  9663                    ELSE
  9664                       MOVE WS-BANK-LFEE
  9665                                 TO PB-I-BANK-FEE
  9666                    END-IF
  9667                 END-IF
  9668              END-IF
  9669           END-IF
  9670        ELSE
  9671           MOVE ER-2879          TO WS-ERROR
  9672           PERFORM 9900-ERROR-FORMAT
  9673                                 THRU 9900-EXIT
  9674        END-IF
  9675     ELSE
  9676        MOVE ER-2879             TO WS-ERROR
  9677        PERFORM 9900-ERROR-FORMAT
  9678                                 THRU 9900-EXIT
  9679     END-IF
  9680     IF WS-AH-BEN-CATEGORY = 'G'
  9681        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9682        + WS-BANK-FEE
  9683     ELSE
  9684        COMPUTE WS-ACCT-ADDL-CLP = WS-ACCT-ADDL-CLP
  9685        + WS-BANK-LFEE
  9686     END-IF
  9687     .
  9688 0400-FIND-STATE-RECORD.
  9689
  9690     IF WK-STATE-ADDR NOT = ZEROS
  9691         MOVE WK-STATE-ADDR      TO ELCNTL-WS-COMP
  9692         SET ELCNTL-FILE-ADDRESSED TO TRUE
  9693         PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
  9694         PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
  9695         IF PB-SV-STATE = CF-STATE-CODE
  9696             GO TO 0405-CONTINUE-EDIT
  9697         ELSE
  9698             NEXT SENTENCE
  9699     ELSE
  9700         PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
  9701
  9702     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
  9703     MOVE PB-SV-STATE            TO CNTL-ACCESS.
  9704     MOVE '3'                    TO CNTL-REC-TYPE.
  9705     MOVE +0                     TO CNTL-SEQ-NO.
  9706
  9707     MOVE '3'                    TO RC-SW-2.
  9708     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
  9709
  9710     IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
  9711        CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
  9712        PB-SV-STATE   NOT = CF-STATE-CODE)
  9713        MOVE ZEROS               TO WS-TOL-LF-CLAIM
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 178
* EL050.cbl
  9714                                    WS-TOL-AH-CLAIM
  9715                                    WS-MINIMUM-REFUND
  9716                                    WS-TOL-LF-PREM
  9717                                    WS-TOL-AH-PREM
  9718                                    WS-TOL-LF-REFUND
  9719                                    WS-TOL-AH-REFUND
  9720                                    EC-ST-TOL-PREM-PCT
  9721                                    WS-TOL-LF-PREM-PCT
  9722                                    WS-TOL-AH-PREM-PCT
  9723                                    EC-ST-TOL-REFUND-PCT
  9724                                    WS-TOL-LF-REFUND-PCT
  9725                                    WS-TOL-AH-REFUND-PCT
  9726                                    EC-ST-TOL-PREM
  9727                                    EC-ST-TOL-REFUND
  9728                                    EC-ST-FST-PMT-DAYS-MAX
  9729                                    WS-FREE-LOOK-PERIOD
  9730                                    WS-ST-LF-PREM-TAX
  9731                                    WS-ST-AH-PREM-TAX-I
  9732                                    WS-ST-AH-PREM-TAX-G
  9733                                    WS-BANK-FEE
  9734                                    WS-BANK-LFEE
  9735                                    WS-TOL-CLP-PCT
  9736                                    WS-SPP-LEASE-COMM
  9737                                    WS-INT-PERIODS
  9738                                    WS-EXTRA-PMTS
  9739        MOVE SPACES              TO WS-STATE-ABBREVIATION
  9740                                    EC-ST-FST-PMT-DAYS-CHG
  9741                                    WS-LF-REM-TERM-CALC
  9742                                    WS-LF-REFUND-CALC
  9743                                    EC-ST-LF-REM-TERM-CALC
  9744                                    EC-ST-LF-REFUND-CALC
  9745                                    WS-AH-REM-TERM-CALC
  9746                                    WS-AH-REFUND-CALC
  9747                                    WS-LF-BEN-CATEGORY
  9748                                    WS-AH-BEN-CATEGORY
  9749                                    WS-CLP-STATE
  9750                                    WS-ST-REFUND-CLAIM-FLAG
  9751                                    WS-ST-CAUSAL-STATE
  9752                                    ws-st-agent-sig-edit
  9753                                    EC-ST-AH-REM-TERM-CALC
  9754                                    EC-ST-AH-REFUND-CALC
  9755          GO TO 0499-STATE-NOT-FOUND.
  9756
  9757     MOVE ELCNTL-WS-COMP         TO WK-STATE-ADDR.
  9758
  9759 0405-CONTINUE-EDIT.
  9760
  9761     if pb-company-id = 'AHL'
  9762        continue
  9763     else
  9764        IF PB-CERT-PRIME NOT NUMERIC
  9765           MOVE ER-2722          TO WS-ERROR
  9766           PERFORM 9900-ERROR-FORMAT
  9767                                 THRU 9900-EXIT
  9768        end-if
  9769     END-IF
  9770*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9771*       MOVE +0                  TO SUB3
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 179
* EL050.cbl
  9772*       INSPECT PB-CERT-PRIME TALLYING SUB3 FOR ALL ' '
  9773*       IF SUB3 > +0
  9774*          MOVE ER-2722          TO WS-ERROR
  9775*          PERFORM 9900-ERROR-FORMAT
  9776*                                THRU 9900-EXIT
  9777*       END-IF
  9778*    END-IF
  9779*    IF PB-COMPANY-ID = 'CID' OR 'DCC'
  9780*       IF PB-CERT-PRIME NOT NUMERIC
  9781*          AND (WS-LF-SPECIAL-CALC-CD NOT = 'E')
  9782*          AND (WS-AH-SPECIAL-CALC-CD NOT = 'E')
  9783*          AND (PB-I-LF-BENEFIT-CD (1:1) NOT = 'H')
  9784*          AND (PB-I-AH-BENEFIT-CD (1:1) NOT = 'H')
  9785*
  9786*          MOVE ER-2722          TO WS-ERROR
  9787*          PERFORM 9900-ERROR-FORMAT
  9788*                                THRU 9900-EXIT
  9789*       END-IF
  9790*    END-IF
  9791
  9792     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREVIATION.
  9793
  9794     IF CF-ST-TOL-CLAIM NOT = ZEROS
  9795        MOVE CF-ST-TOL-CLAIM     TO WS-TOL-LF-CLAIM
  9796                                    WS-TOL-AH-CLAIM.
  9797
  9798     IF CF-ST-REFUND-MIN NOT NUMERIC
  9799        MOVE ZEROS               TO CF-ST-REFUND-MIN.
  9800
  9801     IF CF-ST-REFUND-MIN NOT = ZEROS
  9802        MOVE CF-ST-REFUND-MIN    TO WS-MINIMUM-REFUND.
  9803
  9804     IF CF-ST-TOL-PREM  NOT = ZEROS
  9805        MOVE CF-ST-TOL-PREM      TO WS-TOL-LF-PREM
  9806                                    WS-TOL-AH-PREM
  9807        MOVE CF-ST-PREM-REJECT-SW TO WS-PREM-REJECT-SW.
  9808
  9809     IF CF-ST-TOL-REFUND NOT = ZEROS
  9810        MOVE CF-ST-TOL-REFUND    TO WS-TOL-LF-REFUND
  9811                                    WS-TOL-AH-REFUND
  9812        MOVE CF-ST-REF-REJECT-SW TO WS-REF-REJECT-SW.
  9813
  9814     IF CF-ST-OVR-SHT-AMT NUMERIC AND
  9815        CF-ST-OVR-SHT-AMT GREATER THAN +0
  9816        MOVE CF-ST-OVR-SHT-AMT   TO WS-LF-REFUND-OVS-AMT
  9817                                    WS-AH-REFUND-OVS-AMT
  9818                                    EC-ST-OVR-SHT-AMT.
  9819
  9820     IF CF-ST-TOL-PREM-PCT NUMERIC AND
  9821        CF-ST-TOL-PREM-PCT GREATER THAN +0
  9822        MOVE CF-ST-TOL-PREM-PCT  TO EC-ST-TOL-PREM-PCT
  9823                                    WS-TOL-LF-PREM-PCT
  9824                                    WS-TOL-AH-PREM-PCT.
  9825
  9826     IF CF-ST-TOL-REF-PCT NUMERIC AND
  9827        CF-ST-TOL-REF-PCT GREATER THAN +0
  9828        MOVE CF-ST-TOL-REF-PCT   TO EC-ST-TOL-REFUND-PCT
  9829                                    WS-TOL-LF-REFUND-PCT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 180
* EL050.cbl
  9830                                    WS-TOL-AH-REFUND-PCT.
  9831
  9832     IF CF-ST-OVR-SHT-PCT NUMERIC AND
  9833        CF-ST-OVR-SHT-PCT GREATER THAN +0
  9834        MOVE CF-ST-OVR-SHT-PCT   TO WS-LF-REFUND-OVS-PCT
  9835                                    WS-AH-REFUND-OVS-PCT
  9836                                    EC-ST-OVR-SHT-PCT.
  9837
  9838     MOVE CF-ST-TOL-PREM         TO EC-ST-TOL-PREM.
  9839     MOVE CF-ST-TOL-REFUND       TO EC-ST-TOL-REFUND.
  9840
  9841     IF CF-ST-FST-PMT-DAYS-MAX NOT NUMERIC
  9842          MOVE ZERO              TO CF-ST-FST-PMT-DAYS-MAX.
  9843
  9844     MOVE CF-ST-FST-PMT-DAYS-MAX TO EC-ST-FST-PMT-DAYS-MAX.
  9845     MOVE CF-ST-FST-PMT-DAYS-CHG TO EC-ST-FST-PMT-DAYS-CHG.
  9846     MOVE CF-ST-FREE-LOOK-PERIOD TO WS-FREE-LOOK-PERIOD.
  9847
  9848     IF CF-ST-LF-PREM-TAX NUMERIC
  9849        MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
  9850     END-IF
  9851     IF CF-ST-AH-PREM-TAX-I NUMERIC
  9852        MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
  9853     END-IF
  9854     IF CF-ST-AH-PREM-TAX-G NUMERIC
  9855        MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
  9856     END-IF
  9857
  9858     IF CF-ST-REF-AH-DEATH-IND > SPACES
  9859         MOVE CF-ST-REF-AH-DEATH-IND TO WS-ST-REFUND-CLAIM-FLAG
  9860     END-IF.
  9861
  9862     IF CF-ST-CAUSAL-STATE > SPACES
  9863         MOVE CF-ST-CAUSAL-STATE TO WS-ST-CAUSAL-STATE
  9864     END-IF.
  9865     if cf-st-extra-interest-periods not numeric
  9866        move zeros               to cf-st-extra-interest-periods
  9867     end-if
  9868     if cf-st-extra-payments not numeric
  9869        move zeros               to cf-st-extra-payments
  9870     end-if
  9871
  9872     move cf-st-extra-interest-periods
  9873                                 to ws-int-periods
  9874     move cf-st-extra-payments   to ws-extra-pmts
  9875     move cf-st-agent-sig-edit   to ws-st-agent-sig-edit
  9876     move cf-st-net-only-state   to ws-net-only-state
  9877     IF WS-LF-BENEFIT-CD = ZEROS
  9878        GO TO 0410-CHECK-AH.
  9879
  9880     IF CF-ST-RT-CALC NOT = SPACES
  9881        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9882                                    EC-ST-LF-REM-TERM-CALC
  9883     END-IF
  9884
  9885     IF WS-LF-COVERAGE-TYPE = 'R'
  9886        IF WS-LF-EARNINGS-CALC = '5'
  9887           IF CF-ST-RF-LN-CALC > '0'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 181
* EL050.cbl
  9888              MOVE CF-ST-RF-LN-CALC
  9889                                 TO WS-LF-REFUND-CALC
  9890                                    EC-ST-LF-REFUND-CALC
  9891           END-IF
  9892        ELSE
  9893           IF CF-ST-RF-LR-CALC > '0'
  9894              MOVE CF-ST-RF-LR-CALC
  9895                                 TO WS-LF-REFUND-CALC
  9896                                    EC-ST-LF-REFUND-CALC
  9897           END-IF
  9898        END-IF
  9899     ELSE
  9900        IF CF-ST-RF-LL-CALC > '0'
  9901           MOVE CF-ST-RF-LL-CALC TO WS-LF-REFUND-CALC
  9902                                    EC-ST-LF-REFUND-CALC
  9903        END-IF
  9904     END-IF
  9905
  9906     IF CF-ST-RT-CALC NOT = SPACES
  9907        MOVE CF-ST-RT-CALC       TO WS-LF-REM-TERM-CALC
  9908                                    EC-ST-LF-REM-TERM-CALC
  9909     END-IF
  9910
  9911     MOVE WS-LF-BENEFIT-CD       TO WS-BEN-CD.
  9912     MOVE PB-LIFE-OVERRIDE-L1    TO WS-LOOKUP-TYPE.
  9913
  9914     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9915
  9916     IF NO-BENEFIT-FOUND
  9917        GO TO 0410-CHECK-AH.
  9918
  9919     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9920        MOVE CF-ST-REM-TERM-CALC  (SUB3)
  9921                                 TO EC-ST-LF-REM-TERM-CALC
  9922                                    WS-LF-REM-TERM-CALC
  9923     END-IF
  9924
  9925     IF CF-ST-REFUND-CALC (SUB3) > '0'
  9926        MOVE CF-ST-REFUND-CALC (SUB3)
  9927                                 TO WS-LF-REFUND-CALC
  9928                                    EC-ST-LF-REFUND-CALC
  9929     END-IF
  9930*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-LF-REFUND-CALC.
  9931     if cf-st-extra-periods (sub3) not numeric
  9932        move zeros               to cf-st-extra-periods (sub3)
  9933     end-if
  9934     if cf-st-extra-periods (sub3) > zeros
  9935        if ws-lf-ben-category = 'P'
  9936           move cf-st-extra-periods (sub3)
  9937                                 to ws-extra-pmts
  9938        else
  9939           if ws-lf-ben-category = 'I'
  9940              move cf-st-extra-periods (sub3)
  9941                                 to ws-int-periods
  9942           end-if
  9943        end-if
  9944     end-if
  9945     .
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 182
* EL050.cbl
  9946 0410-CHECK-AH.
  9947
  9948     IF WS-AH-BENEFIT-CD = ZEROS
  9949        GO TO 0500-SET-ACCOUNT.
  9950
  9951     IF CF-ST-RT-CALC NOT = SPACES
  9952        MOVE CF-ST-RT-CALC       TO WS-AH-REM-TERM-CALC
  9953                                    EC-ST-AH-REM-TERM-CALC
  9954     END-IF
  9955
  9956     IF WS-AH-SPECIAL-CALC-CD = 'C'
  9957        IF CF-ST-RF-CP-CALC > '0'
  9958           MOVE CF-ST-RF-CP-CALC TO WS-AH-REFUND-CALC
  9959                                    EC-ST-AH-REFUND-CALC
  9960        END-IF
  9961     ELSE
  9962        IF CF-ST-RF-AH-CALC > '0'
  9963           MOVE CF-ST-RF-AH-CALC TO WS-AH-REFUND-CALC
  9964                                    EC-ST-AH-REFUND-CALC
  9965        END-IF
  9966     END-IF
  9967     MOVE WS-AH-BENEFIT-CD       TO WS-BEN-CD.
  9968     MOVE PB-AH-OVERRIDE-L1      TO WS-LOOKUP-TYPE
  9969
  9970     PERFORM 7100-FIND-BENEFIT-IN-STATE THRU 7199-EXIT.
  9971
  9972     IF NO-BENEFIT-FOUND
  9973        GO TO 0500-SET-ACCOUNT.
  9974
  9975     IF CF-ST-REM-TERM-CALC  (SUB3)   GREATER '0'
  9976        MOVE CF-ST-REM-TERM-CALC (SUB3)
  9977                                 TO WS-AH-REM-TERM-CALC
  9978                                    EC-ST-AH-REM-TERM-CALC
  9979     END-IF
  9980
  9981     IF CF-ST-REFUND-CALC  (SUB3)   GREATER '0'
  9982        MOVE CF-ST-REFUND-CALC (SUB3)
  9983                                 TO WS-AH-REFUND-CALC
  9984                                    EC-ST-AH-REFUND-CALC
  9985     END-IF
  9986
  9987*    MOVE CF-ST-REFUND-CALC  (SUB3)     TO EC-ST-AH-REFUND-CALC.
  9988
  9989     GO TO 0500-SET-ACCOUNT.
  9990
  9991 0499-STATE-NOT-FOUND.
  9992
  9993     MOVE ER-2603                TO WS-ERROR.
  9994     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9995
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 183
* EL050.cbl
  9997
  9998 0500-SET-ACCOUNT.
  9999*  BEFORE WE SET CARRIER STATE LETS LOOK FOR THE CLP STATE
 10000     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10001        MOVE CONTROL-FILE        TO WS-SAVE-ST-ELCNTL
 10002        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 10003        MOVE WS-CLP-STATE        TO CNTL-ACCESS
 10004        MOVE '3'                 TO CNTL-REC-TYPE
 10005        MOVE +0                  TO CNTL-SEQ-NO
 10006
 10007        MOVE '3'                 TO RC-SW-2
 10008        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 10009
 10010        IF (CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 10011           CNTL-REC-TYPE NOT = CF-RECORD-TYPE OR
 10012           WS-CLP-STATE  NOT = CF-STATE-CODE)
 10013           MOVE ZEROS            TO WS-ST-LF-PREM-TAX
 10014                                    WS-ST-AH-PREM-TAX-I
 10015                                    WS-ST-AH-PREM-TAX-G
 10016        ELSE
 10017           IF CF-ST-LF-PREM-TAX NUMERIC
 10018              MOVE CF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10019           END-IF
 10020           IF CF-ST-AH-PREM-TAX-I NUMERIC
 10021              MOVE CF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10022           END-IF
 10023           IF CF-ST-AH-PREM-TAX-G NUMERIC
 10024              MOVE CF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10025           END-IF
 10026        END-IF
 10027        MOVE WS-SAVE-ST-ELCNTL   TO CONTROL-FILE
 10028     END-IF
 10029*  BEFORE WE SET ACCOUNT LETS LOOK FOR THE CARRIER STATE
 10030*  FOR DCC ONLY
 10031     IF PB-COMPANY-ID = 'DCC'
 10032
 10033     MOVE ' '                    TO STAT-MASTER-SW
 10034     MOVE PB-COMPANY-ID          TO ELSTAT-COMPANY-ID
 10035     MOVE PB-CARRIER             TO ELSTAT-CARRIER
 10036     MOVE PB-GROUPING            TO ELSTAT-GROUP
 10037     MOVE PB-STATE               TO ELSTAT-STATE
 10038     IF WS-CLP-STATE NOT = SPACES AND ZEROS AND LOW-VALUES
 10039        MOVE WS-CLP-STATE        TO ELSTAT-STATE
 10040     END-IF
 10041
 10042     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 10043     SET BIN-TO-GREG             TO TRUE
 10044     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 10045     MOVE DC-GREG-DATE-CYMD      TO ELSTAT-EXP-DT
 10046     MOVE ELSTAT-KEY             TO ELSTAT-KEY-SAVE
 10047
 10048     PERFORM 8750-START-ELSTAT   THRU 8750-EXIT
 10049     IF STAT-MASTER-FOUND
 10050        MOVE 'N'                 TO STAT-MASTER-SW
 10051        PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10052        IF STAT-MASTER-FOUND
 10053           IF (ELSTAT-KEY-SAVE (1:12) =
 10054                        SF-CONTROL-PRIMARY (1:12))
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 184
* EL050.cbl
 10055              IF (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10056                 MOVE 'F'        TO STAT-MASTER-SW
 10057              ELSE
 10058                 PERFORM 8752-READ-ELSTAT THRU 8752-EXIT
 10059                 IF (STAT-MASTER-FOUND)
 10060                    AND (ELSTAT-KEY-SAVE (1:12) =
 10061                        SF-CONTROL-PRIMARY (1:12))
 10062                    AND (DC-GREG-DATE-CYMD < SF-EXPIRE-DATE)
 10063                    MOVE 'F'     TO STAT-MASTER-SW
 10064                 END-IF
 10065              END-IF
 10066           END-IF
 10067        END-IF
 10068     END-IF
 10069
 10070     IF STAT-MASTER-SW = 'F'
 10071        IF SF-ST-LF-PREM-TAX NUMERIC
 10072           MOVE SF-ST-LF-PREM-TAX   TO WS-ST-LF-PREM-TAX
 10073        END-IF
 10074        IF SF-ST-AH-PREM-TAX-I NUMERIC
 10075           MOVE SF-ST-AH-PREM-TAX-I TO WS-ST-AH-PREM-TAX-I
 10076        END-IF
 10077        IF SF-ST-AH-PREM-TAX-G NUMERIC
 10078           MOVE SF-ST-AH-PREM-TAX-G TO WS-ST-AH-PREM-TAX-G
 10079        END-IF
 10080     END-IF
 10081
 10082     END-IF
 10083     IF (PB-COMPANY-ID = 'DCC')
 10084        AND (PB-ISSUE)
 10085        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10086        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 10087        AND (AM-GPCD = 06)
 10088        MOVE 'Y'                 TO WS-GOOD-HIN
 10089        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10090           MOVE PB-I-VIN         TO WS-WORK-VIN
 10091           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 10092              (V1 > 16)
 10093              IF WS-WORK-VIN (V1:1) NUMERIC
 10094                 MOVE WS-WORK-VIN-N (V1)
 10095                                 TO WS-ROW-B-VAL (V1)
 10096              ELSE
 10097                 PERFORM VARYING V2 FROM +1 BY +1 UNTIL
 10098                    (WS-WORK-VIN (V1:1) = WS-VAL-IN (V2))
 10099                    OR (V2 > 26)
 10100                 END-PERFORM
 10101                 IF V2 < 27
 10102                    MOVE WS-VAL-OUT (V2) TO WS-ROW-B-VAL (V1)
 10103                 ELSE
 10104                    MOVE 'N'     TO WS-GOOD-HIN
 10105                 END-IF
 10106              END-IF
 10107              COMPUTE WS-ROW-D-VAL (V1) =
 10108                 WS-ROW-C-VAL (V1) * WS-ROW-B-VAL (V1)
 10109              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL +
 10110                 WS-ROW-D-VAL (V1)
 10111           END-PERFORM
 10112           MOVE ZEROS            TO WS-VIN-REMAINDER
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 185
* EL050.cbl
 10113           DIVIDE WS-VIN-TOTAL BY 10 GIVING WS-VIN-FINAL
 10114             REMAINDER WS-VIN-REMAINDER
 10115           IF WS-VIN-REMAINDER = WS-WORK-VIN-N (17)
 10116              CONTINUE
 10117           ELSE
 10118              MOVE 'N'           TO WS-GOOD-HIN
 10119           END-IF
 10120        ELSE
 10121           MOVE 'N'              TO WS-GOOD-HIN
 10122        END-IF
 10123        IF WS-GOOD-HIN NOT = 'Y'
 10124           MOVE ER-3826           TO WS-ERROR
 10125           PERFORM 9900-ERROR-FORMAT
 10126                                 THRU 9900-EXIT
 10127        END-IF
 10128     END-IF
 10129     IF (PB-COMPANY-ID = 'DCC')
 10130        AND (PB-ISSUE)
 10131        AND (WS-AH-BEN-CATEGORY = 'L' OR 'G')
 10132        AND (AM-GPCD NOT = 06)
 10133        IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 10134           perform 3400-edit-vin thru 3400-exit
 10135        ELSE
 10136          MOVE ER-3826           TO WS-ERROR
 10137          PERFORM 9900-ERROR-FORMAT
 10138                                 THRU 9900-EXIT
 10139        END-IF
 10140     END-IF
 10141     if (pb-company-id = 'CID')
 10142        and (pb-issue)
 10143        and (pb-i-vin not = spaces and low-values and zeros)
 10144        perform 3400-edit-vin    thru 3400-exit
 10145     end-if
 10146******************************************************************
 10147******* THIS CODE ALLOWS THE FORM MASTER BENEFIT CODES TERM
 10148******* AND REFUND METHOD TO OVERRIDE COMPANY AND STATE REFUND
 10149******* METHODS.
 10150******************************************************************
 10151     IF PB-COMPANY-ID EQUAL TO 'NCL'
 10152        IF PB-CANCELLATION
 10153           IF ((PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES)
 10154              OR (PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES))
 10155                PERFORM 3350-GET-ERFORM THRU 3350-EXIT
 10156                IF FORM-MASTER-FOUND
 10157                    PERFORM 3357-BENEFIT-SEARCH THRU 3357-EXIT.
 10158******************************************************************
 10159
 10160     MOVE AM-EXPIRATION-DT       TO PB-ACCT-EXP-DT.
 10161     MOVE AM-EFFECTIVE-DT        TO PB-ACCT-EFF-DT.
 10162
 10163     MOVE AM-STD-AH-TYPE         TO WS-ACCT-STD-AH-TYPE.
 10164     MOVE AM-REI-TABLE           TO WS-ACCT-REIN-TABLE.
 10165     MOVE AM-STATUS              TO WS-ACCT-STATUS.
 10166     MOVE AM-CAL-TABLE           TO WS-ACCT-CLASS-TABLE.
 10167
 10168
 10169     MOVE AM-GPCD                TO WS-ACCT-BUSINESS-TYPE.
 10170     MOVE AM-FLD-4               TO WS-ACCT-SIG-SW.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 186
* EL050.cbl
 10171     MOVE AM-EDIT-LOAN-OFC       TO WS-EDIT-LOAN-OFC-SW.
 10172
 10173     IF AM-LF-OB-RATE NOT NUMERIC
 10174         MOVE ZERO               TO AM-LF-OB-RATE.
 10175
 10176     IF AM-LF-OB-RATE-JNT NOT NUMERIC
 10177         MOVE ZERO               TO AM-LF-OB-RATE-JNT.
 10178
 10179     IF AM-AH-OB-RATE NOT NUMERIC
 10180         MOVE ZERO               TO AM-AH-OB-RATE.
 10181
 10182     IF WS-LF-JOINT-INDICATOR = 'J'
 10183         MOVE AM-LF-OB-RATE-JNT  TO WS-ACCT-LF-OB-RT
 10184     ELSE
 10185         MOVE AM-LF-OB-RATE      TO WS-ACCT-LF-OB-RT.
 10186
 10187     MOVE AM-AH-OB-RATE          TO WS-ACCT-AH-OB-RT.
 10188
 10189     IF WS-IG-OVRD-AM  EQUAL SPACE
 10190         MOVE AM-IG              TO WS-IG-OVRD-AM.
 10191
 10192     IF WS-IG-OVRD-AH-PL NOT EQUAL SPACE
 10193         MOVE WS-IG-OVRD-AH-PL      TO WS-IG-OVRD-AH
 10194                                       WS-IG-OVRD
 10195     ELSE
 10196         IF WS-IG-OVRD-AH-BEN NOT EQUAL SPACE
 10197             MOVE WS-IG-OVRD-AH-BEN TO WS-IG-OVRD-AH
 10198                                       WS-IG-OVRD
 10199         ELSE
 10200             MOVE AM-IG             TO WS-IG-OVRD-AH
 10201                                       WS-IG-OVRD.
 10202
 10203     IF WS-IG-OVRD-LF-PL NOT EQUAL SPACE
 10204         MOVE WS-IG-OVRD-LF-PL      TO WS-IG-OVRD-LF
 10205                                       WS-IG-OVRD
 10206     ELSE
 10207         IF WS-IG-OVRD-LF-BEN NOT EQUAL SPACE
 10208             MOVE WS-IG-OVRD-LF-BEN TO WS-IG-OVRD-LF
 10209                                       WS-IG-OVRD
 10210         ELSE
 10211             MOVE AM-IG             TO WS-IG-OVRD-LF
 10212                                       WS-IG-OVRD.
 10213
 10214     INSPECT WS-IG-OVRD-AH  CONVERTING     '12'  TO 'IG'.
 10215     INSPECT WS-IG-OVRD-LF  CONVERTING     '12'  TO 'IG'.
 10216     INSPECT WS-IG-OVRD-AM  CONVERTING     '12'  TO 'IG'.
 10217     INSPECT WS-IG-OVRD     CONVERTING     '12'  TO 'IG'.
 10218     INSPECT WS-ACCT-STATUS CONVERTING   '543210' TO 'SFCTIA'.
 10219
 10220     MOVE AM-TEL-NO              TO EC-AM-PHONE-NO.
 10221     MOVE AM-CAL-TABLE           TO EC-AM-CLASS-CD.
 10222     MOVE WS-ACCT-LF-DEVIATION   TO EC-AM-LF-DEVIATION.
 10223     MOVE WS-ACCT-LF-DEV-PCT     TO EC-AM-LF-DEV-PERCENT.
 10224
 10225     MOVE WS-ACCT-AH-DEVIATION   TO EC-AM-AH-DEVIATION.
 10226     MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT.
 10227     MOVE WS-IG-OVRD-AM          TO EC-AM-BEN-I-G-CD.
 10228     MOVE AM-EFFECTIVE-DT        TO EC-AM-EFFECTIVE-DT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 187
* EL050.cbl
 10229     MOVE AM-EXPIRATION-DT       TO EC-AM-EXPIRATION-DT.
 10230     MOVE WS-ACCT-AH-OB-RT       TO EC-RT-AH-RATE.
 10231     MOVE WS-ACCT-LF-OB-RT       TO EC-RT-LF-RATE.
 10232
 10233     IF WS-ACCT-AH-DEV-PCT > +0
 10234        MOVE WS-ACCT-AH-DEV-PCT     TO EC-AM-AH-DEV-PERCENT
 10235     ELSE
 10236        MOVE +0                     TO EC-AM-AH-DEV-PERCENT.
 10237
 10238     IF WS-AM-LF-BENE-REM-TERM GREATER THAN '0'
 10239        MOVE WS-AM-LF-BENE-REM-TERM  TO WS-LF-REM-TERM-CALC.
 10240     IF WS-AM-AH-BENE-REM-TERM GREATER THAN '0'
 10241        MOVE WS-AM-AH-BENE-REM-TERM  TO WS-AH-REM-TERM-CALC.
 10242
 10243        IF AM-EARN-METHOD-L = 'S'
 10244            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10245                                        WS-LF-REFUND-CALC.
 10246
 10247        IF AM-EARN-METHOD-R = 'S'
 10248            MOVE '9'                 TO EC-AM-LF-REFUND-CALC
 10249                                        WS-LF-REFUND-CALC.
 10250
 10251     IF WS-LF-COVERAGE-TYPE = 'R'
 10252         IF AM-EARN-METHOD-R = 'R'
 10253            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10254                                    WS-LF-REFUND-CALC.
 10255     IF WS-LF-COVERAGE-TYPE = 'R'
 10256         IF AM-EARN-METHOD-R = 'P'
 10257            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10258                                    WS-LF-REFUND-CALC.
 10259     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10260         IF AM-EARN-METHOD-L = 'R'
 10261            MOVE '1'             TO EC-AM-LF-REFUND-CALC
 10262                                    WS-LF-REFUND-CALC.
 10263     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10264         IF AM-EARN-METHOD-L = 'P'
 10265            MOVE '2'             TO EC-AM-LF-REFUND-CALC
 10266                                    WS-LF-REFUND-CALC.
 10267     IF WS-LF-COVERAGE-TYPE = 'R'
 10268         IF AM-EARN-METHOD-R = 'A'
 10269            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10270                                    WS-LF-REFUND-CALC.
 10271     IF WS-LF-COVERAGE-TYPE = 'R'
 10272         IF AM-EARN-METHOD-R = 'M'
 10273            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10274                                    WS-LF-REFUND-CALC.
 10275     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10276         IF AM-EARN-METHOD-L = 'A'
 10277            MOVE '6'             TO EC-AM-LF-REFUND-CALC
 10278                                    WS-LF-REFUND-CALC.
 10279     IF WS-LF-COVERAGE-TYPE = 'L' OR 'P'
 10280         IF AM-EARN-METHOD-L = 'M'
 10281            MOVE '8'             TO EC-AM-LF-REFUND-CALC
 10282                                    WS-LF-REFUND-CALC.
 10283
 10284     IF AM-EARN-METHOD-A = 'R'
 10285        MOVE '1'                 TO EC-AM-AH-REFUND-CALC
 10286                                    WS-AH-REFUND-CALC.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 188
* EL050.cbl
 10287     IF AM-EARN-METHOD-A = 'P'
 10288        MOVE '2'                 TO EC-AM-AH-REFUND-CALC
 10289                                    WS-AH-REFUND-CALC.
 10290     IF AM-EARN-METHOD-A = 'C'
 10291        MOVE '3'                 TO EC-AM-AH-REFUND-CALC
 10292                                    WS-AH-REFUND-CALC.
 10293     IF AM-EARN-METHOD-A = 'A'
 10294        MOVE '6'                 TO EC-AM-AH-REFUND-CALC
 10295                                    WS-AH-REFUND-CALC.
 10296     IF AM-EARN-METHOD-A = 'M'
 10297        MOVE '8'                 TO EC-AM-AH-REFUND-CALC
 10298                                    WS-AH-REFUND-CALC.
 10299     IF AM-EARN-METHOD-A = 'N'
 10300        MOVE '5'                 TO EC-AM-AH-REFUND-CALC
 10301                                    WS-AH-REFUND-CALC.
 10302     IF AM-EARN-METHOD-A = 'S'
 10303        MOVE '9'                 TO EC-AM-AH-REFUND-CALC
 10304                                    WS-AH-REFUND-CALC.
 10305
 10306     IF AM-TOL-PREM NOT = ZEROS
 10307        MOVE AM-TOL-PREM         TO WS-TOL-LF-PREM
 10308                                    WS-TOL-AH-PREM.
 10309
 10310     IF AM-OVR-SHT-AMT NUMERIC AND
 10311                  AM-OVR-SHT-AMT > 0
 10312        MOVE AM-OVR-SHT-AMT      TO WS-LF-REFUND-OVS-AMT
 10313                                    EC-AM-LF-OVR-SHT-AMT
 10314                                    WS-AH-REFUND-OVS-AMT
 10315                                    EC-AM-AH-OVR-SHT-AMT.
 10316
 10317     IF AM-OVR-SHT-PCT NUMERIC AND
 10318                    AM-OVR-SHT-PCT > 0
 10319        MOVE AM-OVR-SHT-PCT      TO WS-LF-REFUND-OVS-PCT
 10320                                    EC-AM-LF-OVR-SHT-PCT
 10321                                    WS-AH-REFUND-OVS-PCT
 10322                                    EC-AM-AH-OVR-SHT-PCT.
 10323
 10324     IF AM-TOL-REF-PCT NUMERIC AND
 10325                  AM-TOL-REF-PCT > 0
 10326        MOVE AM-TOL-REF-PCT      TO WS-TOL-LF-REFUND-PCT
 10327                                    WS-TOL-AH-REFUND-PCT.
 10328
 10329     IF AM-TOL-REF  NOT = ZEROS  AND
 10330                  AM-TOL-REF NUMERIC
 10331        MOVE AM-TOL-REF          TO WS-TOL-LF-REFUND
 10332                                    EC-AM-LF-TOL-REFUND
 10333                                    WS-TOL-AH-REFUND
 10334                                    EC-AM-AH-TOL-REFUND.
 10335
 10336     IF AM-TOL-CLM  NOT = ZEROS
 10337        MOVE AM-TOL-CLM          TO WS-TOL-LF-CLAIM
 10338                                    WS-TOL-AH-CLAIM.
 10339
 10340     IF AM-CLP-TOL-PCT NOT NUMERIC
 10341        MOVE +0                  TO AM-CLP-TOL-PCT
 10342     END-IF
 10343
 10344     IF AM-SPP-LEASE-COMM NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 189
* EL050.cbl
 10345        MOVE +0                  TO AM-SPP-LEASE-COMM
 10346     END-IF
 10347     IF WS-PL-TOL-LF-PREM-PCT NOT EQUAL +0
 10348        MOVE WS-PL-TOL-LF-PREM-PCT
 10349                                 TO WS-TOL-LF-PREM-PCT.
 10350
 10351     IF WS-PL-TOL-AH-PREM-PCT NOT EQUAL +0
 10352        MOVE WS-PL-TOL-AH-PREM-PCT
 10353                                 TO WS-TOL-AH-PREM-PCT.
 10354
 10355     IF WS-PL-TOL-LF-REFUND-PCT NOT EQUAL +0
 10356        MOVE WS-PL-TOL-LF-REFUND-PCT
 10357                                 TO WS-TOL-LF-REFUND-PCT.
 10358
 10359     IF WS-PL-TOL-AH-REFUND-PCT NOT EQUAL +0
 10360        MOVE WS-PL-TOL-AH-REFUND-PCT
 10361                                 TO WS-TOL-AH-REFUND-PCT.
 10362
 10363     IF WS-PL-REF-OVS-AMT > +0
 10364        MOVE WS-PL-REF-OVS-AMT TO WS-LF-REFUND-OVS-AMT.
 10365
 10366     IF WS-PL-REF-OVS-PCT > +0
 10367        MOVE WS-PL-REF-OVS-PCT TO WS-LF-REFUND-OVS-PCT
 10368
 10369     IF WS-PL-TOL-LF-PREM NOT EQUAL +0
 10370        MOVE WS-PL-TOL-LF-PREM   TO WS-TOL-LF-PREM.
 10371     IF WS-PL-TOL-AH-PREM NOT EQUAL +0
 10372        MOVE WS-PL-TOL-AH-PREM   TO WS-TOL-AH-PREM.
 10373     IF WS-PL-TOL-LF-REFUND NOT EQUAL +0
 10374        MOVE WS-PL-TOL-LF-REFUND TO WS-TOL-LF-REFUND.
 10375     IF WS-PL-TOL-AH-REFUND NOT EQUAL +0
 10376        MOVE WS-PL-TOL-AH-REFUND TO WS-TOL-AH-REFUND.
 10377     IF WS-PL-TOL-LF-CLAIM NOT EQUAL +0
 10378        MOVE WS-PL-TOL-LF-CLAIM  TO WS-TOL-LF-CLAIM.
 10379     IF WS-PL-TOL-AH-CLAIM NOT EQUAL +0
 10380        MOVE WS-PL-TOL-AH-CLAIM  TO WS-TOL-AH-CLAIM.
 10381
 10382     IF WS-AH-PL-REF-OVS-AMT > +0
 10383        MOVE WS-AH-PL-REF-OVS-AMT TO WS-AH-REFUND-OVS-AMT.
 10384
 10385     IF WS-AH-PL-REF-OVS-PCT > +0
 10386        MOVE WS-AH-PL-REF-OVS-PCT TO WS-AH-REFUND-OVS-PCT.
 10387
 10388     MOVE WS-TOL-LF-PREM         TO EC-AM-LF-TOL-PREM.
 10389     MOVE WS-TOL-AH-PREM         TO EC-AM-AH-TOL-PREM.
 10390
 10391     IF PB-CANCELLATION
 10392        GO TO 3000-CONTINUE-EDIT.
 10393
 10394     MOVE +1 TO SUB1.
 10395     MOVE WS-LF-BENEFIT-CD       TO WS-LF-COMP-CD.
 10396     MOVE WS-AH-BENEFIT-CD       TO WS-AH-COMP-CD.
 10397
 10398     IF CF-COMPANY-ID = 'DMD'
 10399       IF WS-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 10400         MOVE PB-CERT-NO (5:2)   TO WS-LF-COMP-CD
 10401        ELSE
 10402         MOVE PB-CERT-NO (5:2)   TO WS-AH-COMP-CD.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 190
* EL050.cbl
 10403
 10404  0525-FIND-ACCT-COMM.
 10405     IF AM-COM-TYP (SUB1) = 'C' OR 'D' OR 'F' OR 'S'
 10406        NEXT SENTENCE
 10407      ELSE
 10408         ADD +1 TO SUB1
 10409         IF SUB1 LESS +11
 10410            GO TO 0525-FIND-ACCT-COMM
 10411          ELSE
 10412             GO TO 0560-EDIT-CONTINUE.
 10413
 10414     MOVE PB-COMPANY-CD          TO CTBL-COMPANY-CD.
 10415     MOVE ZERO                   TO PB-I-AH-COMMISSION
 10416                                    PB-I-LIFE-COMMISSION.
 10417***  IF PB-COMPANY-ID = 'CRI'
 10418     IF PB-PREM-ACCTNG-ONLY
 10419         GO TO 0560-EDIT-CONTINUE.
 10420
 10421     MOVE '0530' TO CTBL-SW.
 10422     MOVE ' '    TO WS-CTBL-READ-SW.
 10423
 10424
 10425 0530-GET-AH-COMP.
 10426     IF NO-AH-COVERAGE  OR
 10427        NO-AH-BENEFIT-MATCH
 10428           GO TO 0540-NEXT-READ-STEP.
 10429
 10430     IF AM-A-COM (SUB1) NUMERIC
 10431        AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10432         MOVE AM-A-COM (SUB1)    TO WS-COMMISSION
 10433         MOVE PB-AH-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10434         PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10435         MOVE WS-COMMISSION      TO PB-I-AH-COMMISSION
 10436     ELSE
 10437          MOVE WS-AH-COMP-CD     TO CTBL-BEN-CODE
 10438          MOVE PB-I-AH-TERM      TO WS-WORK-TERM
 10439          MOVE PB-AH-OVERRIDE-L1 TO CTBL-BEN-TYPE
 10440          MOVE ZEROS             TO WS-SUB1
 10441                                    WS-COMMISSION
 10442          PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10443          MOVE AM-A-COMA (SUB1)  TO CTBL-TABLE
 10444          IF WS-COMMISSION > ZEROS
 10445             MOVE WS-COMMISSION  TO PB-I-AH-COMMISSION
 10446             GO TO 0540-NEXT-READ-STEP
 10447          END-IF
 10448          PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10449          IF CTBL-TABLE-FOUND
 10450             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10451                                        PB-I-AH-TERM
 10452             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10453             MOVE WS-WK-RATE        TO PB-I-AH-COMMISSION
 10454             GO TO 0540-NEXT-READ-STEP
 10455          ELSE
 10456             IF FIRST-TIME-THROUGH
 10457                 GO TO 0530-GET-AH-COMP
 10458             ELSE
 10459                 MOVE ER-2609                TO WS-ERROR
 10460                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 191
* EL050.cbl
 10461
 10462 0540-NEXT-READ-STEP.
 10463     MOVE '0540' TO CTBL-SW.
 10464     MOVE ' '    TO WS-CTBL-READ-SW.
 10465
 10466 0540-GET-LF-COMP.
 10467     IF NO-LIFE-COVERAGE  OR
 10468        NO-LF-BENEFIT-MATCH
 10469           GO TO 0560-EDIT-CONTINUE.
 10470
 10471     IF WS-LF-JOINT-INDICATOR = 'J'
 10472        IF AM-J-COM (SUB1) NUMERIC
 10473           and (am-j-com (sub1) (3:1) not = 'L' and 'M')
 10474           MOVE AM-J-COM (SUB1)      TO WS-COMMISSION
 10475           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10476           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10477           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10478        ELSE
 10479           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10480           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10481           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10482           MOVE ZEROS                TO WS-SUB1
 10483                                        WS-COMMISSION
 10484           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10485           IF WS-COMMISSION > ZEROS
 10486              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10487              GO TO 0560-EDIT-CONTINUE
 10488           END-IF
 10489           MOVE AM-J-COMA (SUB1)     TO CTBL-TABLE
 10490           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10491           IF CTBL-TABLE-FOUND
 10492              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10493              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10494              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10495              GO TO 0560-EDIT-CONTINUE
 10496           ELSE
 10497              IF FIRST-TIME-THROUGH
 10498                  GO TO 0540-GET-LF-COMP
 10499              ELSE
 10500                  MOVE ER-2609                TO WS-ERROR
 10501                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10502                  GO TO 0560-EDIT-CONTINUE.
 10503
 10504     IF WS-LF-JOINT-INDICATOR IS NOT = 'J'
 10505        IF AM-L-COM (SUB1) NUMERIC
 10506           and (am-l-coma (sub1) (3:1) not = 'L' and 'M')
 10507           MOVE AM-L-COM (SUB1)      TO WS-COMMISSION
 10508           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10509           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10510           MOVE WS-COMMISSION        TO PB-I-LIFE-COMMISSION
 10511        ELSE
 10512           MOVE WS-LF-COMP-CD        TO CTBL-BEN-CODE
 10513           MOVE PB-I-LF-TERM         TO WS-WORK-TERM
 10514           MOVE PB-LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 10515           MOVE ZEROS                TO WS-SUB1
 10516                                        WS-COMMISSION
 10517           PERFORM 6650-GET-RES-STATE-COMM THRU 6700-COMM-EXIT
 10518           IF WS-COMMISSION IS GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 192
* EL050.cbl
 10519              MOVE WS-COMMISSION     TO PB-I-LIFE-COMMISSION
 10520              GO TO 0560-EDIT-CONTINUE
 10521           END-IF
 10522           MOVE AM-L-COMA (SUB1)     TO CTBL-TABLE
 10523           PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 10524           IF CTBL-TABLE-FOUND
 10525              MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10526              PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10527              MOVE WS-WK-RATE           TO PB-I-LIFE-COMMISSION
 10528              GO TO 0560-EDIT-CONTINUE
 10529           ELSE
 10530              IF FIRST-TIME-THROUGH
 10531                  GO TO 0540-GET-LF-COMP
 10532              ELSE
 10533                  MOVE ER-2609                TO WS-ERROR
 10534                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10535
 10536*    GO TO 0560-EDIT-CONTINUE.
 10537
 10538 0560-EDIT-CONTINUE.
 10539     MOVE ZEROS                  TO WS-LF-PMF-COMM
 10540                                    WS-AH-PMF-COMM
 10541*****   THIS ROUTINE VALIDATES THE EXISTENCE OF A COMMISSION
 10542*****   TABLE FOR THE 'O', 'P' AND 'K' AGENT TYPES
 10543     PERFORM VARYING SUB1 FROM +1 BY +1 UNTIL
 10544        (SUB1 > +10)
 10545        IF AM-COM-TYP (SUB1) = 'O' OR 'P' OR 'K' OR 'A'
 10546           MOVE WS-AH-BENEFIT-CD TO WS-AH-COMP-CD
 10547           MOVE '0530'           TO CTBL-SW
 10548           MOVE ' '              TO WS-CTBL-READ-SW
 10549           PERFORM 0561-CHECK-AH THRU 0561-EXIT
 10550           MOVE WS-LF-BENEFIT-CD TO WS-LF-COMP-CD
 10551           MOVE '0540'           TO CTBL-SW
 10552           MOVE ' '              TO WS-CTBL-READ-SW
 10553           PERFORM 0563-CHECK-LF THRU 0563-EXIT
 10554        END-IF
 10555     END-PERFORM
 10556     GO TO 0564-EDIT-CONTINUE
 10557     .
 10558 0561-CHECK-AH.
 10559     IF (NO-AH-COVERAGE)
 10560        OR (NO-AH-BENEFIT-MATCH)
 10561        CONTINUE
 10562     ELSE
 10563        IF (AM-A-COM (SUB1) NUMERIC)
 10564           AND (AM-A-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10565           IF (AM-COM-TYP (SUB1) = 'A')
 10566              AND (WS-AH-PMF-COMM = ZEROS)
 10567              MOVE AM-A-COM (SUB1) TO WS-AH-PMF-COMM
 10568           END-IF
 10569           CONTINUE
 10570        ELSE
 10571           MOVE WS-AH-COMP-CD    TO CTBL-BEN-CODE
 10572           MOVE PB-I-AH-TERM     TO WS-WORK-TERM
 10573           MOVE PB-AH-OVERRIDE-L1
 10574                                 TO CTBL-BEN-TYPE
 10575           MOVE ZEROS            TO WS-SUB1
 10576                                    WS-COMMISSION
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 193
* EL050.cbl
 10577           MOVE AM-A-COMA (SUB1) TO CTBL-TABLE
 10578           PERFORM 8300-READ-CTBL-TABLE
 10579                                 THRU 8300-EXIT
 10580           IF CTBL-TABLE-FOUND
 10581              IF (AM-COM-TYP (SUB1) = 'A')
 10582                 AND (WS-AH-PMF-COMM = ZEROS)
 10583                 COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT *
 10584                                        PB-I-AH-TERM
 10585                 PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10586                 MOVE WS-WK-RATE        TO WS-AH-PMF-COMM
 10587              END-IF
 10588              CONTINUE
 10589           ELSE
 10590              IF FIRST-TIME-THROUGH
 10591                 GO TO 0561-CHECK-AH
 10592              ELSE
 10593                 MOVE ER-2609    TO WS-ERROR
 10594                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10595              END-IF
 10596           END-IF
 10597        END-IF
 10598     END-IF
 10599     .
 10600 0561-EXIT.
 10601     EXIT.
 10602 0563-CHECK-LF.
 10603     IF (NO-LIFE-COVERAGE)
 10604        OR (NO-LF-BENEFIT-MATCH)
 10605        CONTINUE
 10606     ELSE
 10607        IF WS-LF-JOINT-INDICATOR = 'J'
 10608           IF AM-J-COM (SUB1) NUMERIC
 10609              AND (AM-J-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10610              IF (AM-COM-TYP (SUB1) = 'A')
 10611                 AND (WS-LF-PMF-COMM = ZEROS)
 10612                 MOVE AM-J-COM (SUB1) TO WS-LF-PMF-COMM
 10613              END-IF
 10614              CONTINUE
 10615           ELSE
 10616              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10617              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10618              MOVE PB-LIFE-OVERRIDE-L1
 10619                                 TO CTBL-BEN-TYPE
 10620              MOVE ZEROS         TO WS-SUB1
 10621                                    WS-COMMISSION
 10622              MOVE AM-J-COMA (SUB1)
 10623                                 TO CTBL-TABLE
 10624              PERFORM 8300-READ-CTBL-TABLE
 10625                                 THRU 8300-EXIT
 10626              IF CTBL-TABLE-FOUND
 10627                 IF (AM-COM-TYP (SUB1) = 'A')
 10628                    AND (WS-LF-PMF-COMM = ZEROS)
 10629                    MOVE PB-I-LF-BENEFIT-AMT  TO WS-COMM-CK-AMT
 10630                    PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 10631                    MOVE WS-WK-RATE        TO WS-LF-PMF-COMM
 10632                 END-IF
 10633                 CONTINUE
 10634              ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 194
* EL050.cbl
 10635                 IF FIRST-TIME-THROUGH
 10636                    GO TO 0563-CHECK-LF
 10637                 ELSE
 10638                    MOVE ER-2609 TO WS-ERROR
 10639                    PERFORM 9900-ERROR-FORMAT
 10640                                 THRU 9900-EXIT
 10641*                   GO TO 0560-EDIT-CONTINUE
 10642                 END-IF
 10643              END-IF
 10644           END-IF
 10645        ELSE
 10646           IF AM-L-COM (SUB1) NUMERIC
 10647              AND (AM-L-COMA (SUB1) (3:1) NOT = 'L' AND 'M')
 10648              IF (AM-COM-TYP (SUB1) = 'A')
 10649                 AND (WS-LF-PMF-COMM = ZEROS)
 10650                 MOVE AM-L-COM (SUB1) TO WS-LF-PMF-COMM
 10651              END-IF
 10652              CONTINUE
 10653           ELSE
 10654              MOVE WS-LF-COMP-CD TO CTBL-BEN-CODE
 10655              MOVE PB-I-LF-TERM  TO WS-WORK-TERM
 10656              MOVE PB-LIFE-OVERRIDE-L1
 10657                                 TO CTBL-BEN-TYPE
 10658              MOVE ZEROS         TO WS-SUB1
 10659                                    WS-COMMISSION
 10660              MOVE AM-L-COMA (SUB1)
 10661                                 TO CTBL-TABLE
 10662              PERFORM 8300-READ-CTBL-TABLE
 10663                                 THRU 8300-EXIT
 10664              IF CTBL-TABLE-FOUND
 10665                 CONTINUE
 10666              ELSE
 10667                 IF FIRST-TIME-THROUGH
 10668                    GO TO 0563-CHECK-LF
 10669                 ELSE
 10670                    MOVE ER-2609 TO WS-ERROR
 10671                    PERFORM 9900-ERROR-FORMAT
 10672                                 THRU 9900-EXIT
 10673                 END-IF
 10674              END-IF
 10675           END-IF
 10676        END-IF
 10677     END-IF
 10678     .
 10679 0563-EXIT.
 10680     EXIT.
 10681 0564-EDIT-CONTINUE.
 10682
 10683     IF  PB-COMPANY-ID EQUAL 'DMD'
 10684         IF PB-I-NUM-BILLED EQUAL ZEROS
 10685            MOVE ER-8148       TO WS-ERROR
 10686            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10687
 10688*    IF  PB-I-BIRTHDAY GREATER THAN LOW-VALUE
 10689*         MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 10690*         MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-2
 10691*         SET ELAPSED-BETWEEN-BIN TO TRUE
 10692*         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 195
* EL050.cbl
 10693*         IF NO-CONVERSION-ERROR
 10694*             COMPUTE PB-I-AGE  =  DC-ELAPSED-MONTHS / +12
 10695*         ELSE
 10696*             IF PB-COMPANY-ID EQUAL 'HAN'
 10697*                 MOVE ZEROS     TO PB-I-AGE.
 10698     IF PB-I-BIRTHDAY > LOW-VALUES
 10699        MOVE PB-I-BIRTHDAY       TO DC-BIN-DATE-1
 10700        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10701        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10702        PERFORM 8500-DATE-CONVERT
 10703                                 THRU 8500-EXIT
 10704        IF NO-CONVERSION-ERROR
 10705           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10706           IF PB-I-AGE > ZEROS
 10707              IF WS-WORK-AGE NOT = PB-I-AGE
 10708                 MOVE ER-9501    TO WS-ERROR
 10709                 PERFORM 9900-ERROR-FORMAT
 10710                                 THRU 9900-EXIT
 10711              END-IF
 10712           ELSE
 10713              MOVE WS-WORK-AGE   TO PB-I-AGE
 10714           END-IF
 10715        END-IF
 10716     END-IF
 10717     MOVE 'N'                   TO WS-INS-AGE-DEFAULTED
 10718                                   WS-INS-AGE-SET
 10719     IF PB-I-AGE = ZEROS
 10720        IF PB-COMPANY-ID NOT = 'HAN'  AND  'JHL'
 10721           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 10722                                   WS-INS-AGE-SET
 10723           MOVE WS-DEFAULT-AGE  TO PB-I-AGE.
 10724
 10725     MOVE PB-I-AGE              TO WS-EDIT-AGE
 10726                                   WS-AH-EDIT-AGE.
 10727
 10728     IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 10729        MOVE PB-I-JOINT-BIRTHDAY TO DC-BIN-DATE-1
 10730        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 10731        SET ELAPSED-BETWEEN-BIN  TO TRUE
 10732        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10733        IF NO-CONVERSION-ERROR
 10734           COMPUTE WS-WORK-AGE = DC-ELAPSED-MONTHS / +12
 10735           IF PB-I-JOINT-AGE > 0
 10736              IF WS-WORK-AGE NOT = PB-I-JOINT-AGE
 10737                 MOVE ER-9503    TO WS-ERROR
 10738                 PERFORM 9900-ERROR-FORMAT
 10739                                 THRU 9900-EXIT
 10740              END-IF
 10741           ELSE
 10742              MOVE WS-WORK-AGE   TO PB-I-JOINT-AGE
 10743           END-IF
 10744        ELSE
 10745           MOVE ZEROS            TO PB-I-JOINT-AGE
 10746        END-IF
 10747     END-IF
 10748     IF PB-I-JOINT-AGE NOT NUMERIC
 10749        MOVE ZERO               TO PB-I-JOINT-AGE.
 10750
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 196
* EL050.cbl
 10751     MOVE 'N'                   TO WS-JNT-AGE-DEFAULTED
 10752                                   WS-JNT-AGE-SET
 10753     IF PB-COMPANY-ID = 'NCL' OR 'CID' OR 'DCC' OR 'AHL'
 10754        IF (WS-LF-JOINT-INDICATOR = 'J')  OR
 10755           (WS-AH-JOINT-INDICATOR = 'J')
 10756           IF PB-I-JOINT-AGE = ZEROS
 10757               MOVE 'Y'                TO WS-JNT-AGE-DEFAULTED
 10758                                          WS-JNT-AGE-SET
 10759               MOVE WS-DEFAULT-AGE     TO PB-I-JOINT-AGE
 10760           END-IF
 10761        END-IF
 10762     END-IF
 10763
 10764     MOVE ' ' TO PB-I-LIFE-INDICATOR
 10765     IF WS-LF-JOINT-INDICATOR = 'J'
 10766        MOVE 'J'                TO PB-I-LIFE-INDICATOR
 10767        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10768            IF  PB-I-JOINT-AGE = ZERO
 10769                MOVE ER-2686       TO WS-ERROR
 10770                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10771            ELSE
 10772                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10773                    MOVE PB-I-JOINT-AGE TO WS-EDIT-AGE
 10774                    IF PB-COMPANY-ID NOT = 'LBL'
 10775                        MOVE ER-2685    TO WS-ERROR
 10776                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10777
 10778     IF WS-AH-JOINT-INDICATOR = 'J'
 10779        IF  WS-JOINT-AGE-FLAG = '1' OR 'Y'
 10780            IF  PB-I-JOINT-AGE = ZERO
 10781                MOVE ER-2686       TO WS-ERROR
 10782                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10783            ELSE
 10784                IF  PB-I-JOINT-AGE GREATER PB-I-AGE
 10785                    MOVE PB-I-JOINT-AGE TO WS-AH-EDIT-AGE
 10786                                           WS-EDIT-AGE
 10787                    IF PB-COMPANY-ID NOT = 'LBL'
 10788                        MOVE ER-2685    TO WS-ERROR
 10789                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10790
 10791******************************************************************
 10792*    MINIMUM AGE IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 10793******************************************************************
 10794
 10795     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10796        (WS-AH-SPECIAL-CALC-CD = 'O')
 10797        NEXT SENTENCE
 10798     ELSE
 10799        IF PB-I-AGE LESS THAN WS-MIN-AGE  OR
 10800          (PB-I-JOINT-AGE LESS THAN WS-MIN-AGE  AND
 10801           (WS-LF-JOINT-INDICATOR = 'J'  OR
 10802            WS-AH-JOINT-INDICATOR = 'J')  AND
 10803           (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 10804            MOVE ER-2627             TO WS-ERROR
 10805            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10806
 10807     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 10808        (WS-AH-SPECIAL-CALC-CD = 'O')
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 197
* EL050.cbl
 10809         NEXT SENTENCE
 10810     ELSE
 10811         IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10812            WS-AH-JOINT-INDICATOR = 'J'
 10813             IF PB-I-JOINT-INSURED = SPACES
 10814                 IF PB-COMPANY-ID NOT = 'JAL'
 10815                     MOVE ER-2696    TO WS-ERROR
 10816                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10817
 10818     IF PB-COMPANY-ID NOT = 'BOA'
 10819        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10820           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10821           IF (PB-I-JOINT-AGE NOT = ZEROS OR
 10822               PB-I-JOINT-INSURED NOT = SPACES)
 10823                MOVE ER-2691         TO WS-ERROR
 10824                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10825
 10826     IF PB-COMPANY-ID = 'BOA'
 10827        IF (WS-LF-JOINT-INDICATOR NOT = 'J') AND
 10828           (WS-AH-JOINT-INDICATOR NOT = 'J')
 10829            IF PB-I-JOINT-AGE NOT = ZEROS
 10830                MOVE ER-2691         TO WS-ERROR
 10831                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10832
 10833     IF PB-COMPANY-ID = 'CRI'
 10834        IF PB-I-SIG-SW = 'J'
 10835           IF WS-LF-JOINT-INDICATOR NOT = 'J'  AND
 10836              WS-AH-JOINT-INDICATOR NOT = 'J'
 10837              MOVE ER-2675       TO WS-ERROR
 10838              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10839
 10840     IF PB-COMPANY-ID = 'CRI'
 10841        IF PB-I-SIG-SW = 'S'
 10842           IF WS-LF-JOINT-INDICATOR = 'J'  OR
 10843              WS-AH-JOINT-INDICATOR = 'J'
 10844              MOVE ER-2676       TO WS-ERROR
 10845              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10846
 10847     IF PB-COMPANY-ID = 'CVL'
 10848         IF (WS-AH-JOINT-INDICATOR = 'J') AND
 10849            (WS-LF-JOINT-INDICATOR NOT = 'J')
 10850              MOVE ER-2783           TO WS-ERROR
 10851              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10852     IF (WS-LF-JOINT-INDICATOR = 'J')
 10853        AND (WS-AH-JOINT-INDICATOR = 'J')
 10854        AND (PB-I-LF-TERM > 120)
 10855        AND (PB-I-LF-TERM NOT = PB-I-AH-TERM)
 10856        MOVE ER-2783             TO WS-ERROR
 10857        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10858     END-IF
 10859     MOVE SPACE                  TO PB-I-INDV-GRP-CD.
 10860
 10861     IF PB-I-INDV-GRP-OVRD = 'I'
 10862        MOVE ER-2666             TO WS-ERROR
 10863        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10864        MOVE 'I'                 TO PB-I-INDV-GRP-CD.
 10865
 10866     IF PB-I-INDV-GRP-OVRD = 'G'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 198
* EL050.cbl
 10867        MOVE ER-2666             TO WS-ERROR
 10868        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10869        MOVE 'G'                 TO PB-I-INDV-GRP-CD.
 10870
 10871     IF PB-I-INDV-GRP-OVRD = 'I' OR 'G'
 10872        NEXT SENTENCE
 10873     ELSE
 10874        MOVE WS-IG-OVRD          TO PB-I-INDV-GRP-CD.
 10875
 10876     IF PB-I-INDV-GRP-OVRD = WS-IG-OVRD
 10877        IF WS-ERROR = ER-2666
 10878           MOVE +0    TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 10879           SUBTRACT +1           FROM PB-NO-OF-ERRORS.
 10880
 10881     IF PB-COMPANY-ID = 'CID'
 10882        IF PB-STATE = 'UT' OR 'MO'
 10883           IF ((PB-I-LIFE-BENEFIT-CD = '45' OR '46'
 10884                 OR '76' OR '77')
 10885                      OR
 10886               (PB-I-AH-BENEFIT-CD = '38' OR '39' OR '40'
 10887                   OR '41' OR '42' OR '63' OR '64' OR '65'
 10888                   OR '66' OR '67' OR '2H' OR '2I' OR '2J'
 10889                   OR '2K' OR '2L'))
 10890              AND PB-I-INDV-GRP-CD = 'I'
 10891              MOVE ER-2721             TO WS-ERROR
 10892              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10893           END-IF
 10894        END-IF
 10895     END-IF
 10896
 10897     MOVE WS-ST-LF-PREM-TAX      TO PB-I-LF-PREM-TAX
 10898     IF PB-I-INDV-GRP-CD   = '1' OR 'I'
 10899        MOVE WS-ST-AH-PREM-TAX-I TO PB-I-AH-PREM-TAX
 10900     ELSE
 10901        MOVE WS-ST-AH-PREM-TAX-G TO PB-I-AH-PREM-TAX
 10902     END-IF
 10903
 10904*    MOVE WS-BANK-FEE            TO PB-I-BANK-FEE
 10905*    MOVE WS-BANK-NOCHRGB        TO PB-I-BANK-NOCHRGB
 10906     MOVE 'NO '                  TO ACCOUNT-LIFE-CK-SW
 10907                                    ACCOUNT-AH-CK-SW.
 10908
 10909     IF PB-REISSUED-CERT       OR
 10910        PB-REIN-ONLY-CERT      OR
 10911        PB-POLICY-IS-DECLINED  OR
 10912        PB-POLICY-IS-VOIDED
 10913*       OR PB-MONTHLY-CERT
 10914         GO TO 3000-CONTINUE-EDIT.
 10915
 10916     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 10917        IF WS-EDIT-AGE           > +65
 10918           MOVE ER-2709          TO WS-ERROR
 10919           PERFORM 9900-ERROR-FORMAT
 10920                                 THRU 9900-EXIT
 10921        ELSE
 10922           IF WS-EDIT-AGE        > +55
 10923              MOVE ER-2718       TO WS-ERROR
 10924              PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 199
* EL050.cbl
 10925                                 THRU 9900-EXIT
 10926           END-IF
 10927        END-IF
 10928     IF PB-COMPANY-ID = 'DCC'
 10929        IF WS-EDIT-AGE           > +65
 10930           MOVE ER-2709          TO WS-ERROR
 10931           PERFORM 9900-ERROR-FORMAT
 10932                                 THRU 9900-EXIT
 10933        END-IF
 10934     END-IF
 10935     .
 10936
 10937 0565-LIFE-PLAN-LIMIT-EDITS.
 10938
 10939     IF NOT LF-PLAN-MASTER-FOUND
 10940        MOVE +0                  TO EC-AM-LF-MAX-ATT-AGE
 10941                                    EC-AM-LF-MAX-TOT-BEN
 10942        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10943
 10944     MOVE LINK-LIFE-PLAN-RECORD  TO PLAN-MASTER.
 10945
 10946     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 10947         IF PL-LM-AGE (1) = ZEROS
 10948             GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10949
 10950     IF NO-LF-BENEFIT-MATCH          OR
 10951        WS-LF-BENEFIT-CD = ZEROS     OR
 10952        WS-LF-SPECIAL-CALC-CD = 'M'
 10953        GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10954
 10955     MOVE 'YES'                  TO ACCOUNT-LIFE-CK-SW.
 10956     MOVE +1                     TO SUB2.
 10957
 10958     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 10959        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 10960           MOVE +5   TO SUB2
 10961           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 10962              (PL-LM-DUR (SUB2) EQUAL +0) AND
 10963              (PL-LM-AGE (SUB2) EQUAL +0)
 10964              MOVE 'NO ' TO ACCOUNT-LIFE-CK-SW
 10965              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 10966
 10967     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 10968
 10969     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 10970                               + PB-I-LF-ALT-BENEFIT-AMT.
 10971
 10972 0568-CHECK-LIFE-ATT-AGE.
 10973
 10974     IF PL-ATT-AGE NUMERIC AND
 10975        PL-ATT-AGE > +0
 10976        MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10977     END-IF
 10978*    IF PL-ATT-AGE NUMERIC AND
 10979*       PL-ATT-AGE > +0
 10980*       MOVE PL-ATT-AGE          TO EC-AM-LF-MAX-ATT-AGE
 10981*       IF PB-I-BIRTHDAY > LOW-VALUES
 10982*          MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 200
* EL050.cbl
 10983*          COMPUTE DC-ELAPSED-MONTHS = PL-ATT-AGE * +12
 10984*          MOVE ZERO             TO DC-ELAPSED-DAYS
 10985*          SET BIN-PLUS-ELAPSED  TO TRUE
 10986*          PERFORM 8500-DATE-CONVERT
 10987*                                THRU 8500-EXIT
 10988*          IF NO-CONVERSION-ERROR
 10989*             IF PB-I-LF-EXPIRE-DT > DC-BIN-DATE-2
 10990*             MOVE ER-2669       TO WS-ERROR
 10991*             PERFORM 9900-ERROR-FORMAT
 10992*                                THRU 9900-EXIT
 10993*          END-IF
 10994*       ELSE
 10995*          IF WS-ATT-AGE >= PL-ATT-AGE
 10996*             MOVE ER-2669       TO WS-ERROR
 10997*             PERFORM 9900-ERROR-FORMAT
 10998*                                THRU 9900-EXIT
 10999*          END-IF
 11000*       END-IF
 11001*    END-IF
 11002     .
 11003 0570-CHECK-LIFE-LIMITS.
 11004
 11005     IF PB-COMPANY-ID EQUAL 'CRI'
 11006        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11007           IF SUB2 GREATER THAN +4
 11008              MOVE ER-2637 TO WS-ERROR
 11009              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11010              GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11011
 11012     IF PB-COMPANY-ID  =  'NCL'
 11013        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11014            SUB2 GREATER THAN +8
 11015             MOVE 'U'         TO PB-BATCH-ENTRY
 11016             MOVE ER-2637     TO WS-ERROR
 11017             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11018             GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11019
 11020     IF SUB2 > +8
 11021        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11022           AND (PB-I-SIG-SW = 'Y')
 11023           CONTINUE
 11024        ELSE
 11025           MOVE ER-2637          TO WS-ERROR
 11026           PERFORM 9900-ERROR-FORMAT
 11027                                 THRU 9900-EXIT
 11028        END-IF
 11029        GO TO 0580-AH-PLAN-LIMIT-EDITS
 11030     END-IF
 11031     MOVE PL-LM-AGE (SUB2)    TO EC-AM-LF-MAX-AGE.
 11032     MOVE PL-LM-DUR (SUB2)    TO EC-AM-LF-MAX-TERM.
 11033     MOVE PL-LM-AMT (SUB2)    TO EC-AM-LF-MAX-TOT-BEN.
 11034
 11035     IF WS-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11036        ADD +1  TO SUB2
 11037        GO TO 0570-CHECK-LIFE-LIMITS.
 11038
 11039     IF PB-COMPANY-ID = 'NCL'
 11040         GO TO 0570-CHECK-NCL-LIFE-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 201
* EL050.cbl
 11041
 11042     IF (PB-I-LF-TERM > PL-LM-DUR (SUB2))
 11043        OR (WS-LF-BENEFIT-AMT > PL-LM-AMT (SUB2))
 11044        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11045           AND (PB-I-SIG-SW = 'Y')
 11046           CONTINUE
 11047        ELSE
 11048           MOVE ER-2637          TO WS-ERROR
 11049           PERFORM 9900-ERROR-FORMAT
 11050                                 THRU 9900-EXIT
 11051        END-IF
 11052     END-IF
 11053     GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11054
 11055
 11056 0570-CHECK-NCL-LIFE-LIMITS.
 11057
 11058     IF PB-I-LF-TERM  NOT GREATER THAN PL-LM-DUR (SUB2)  AND
 11059        WS-LF-BENEFIT-AMT  NOT GREATER THAN PL-LM-AMT (SUB2)
 11060         GO TO 0575-CHECK-NCL-SIG-SWITCH.
 11061
 11062     IF APP-CERT-USED
 11063         IF SUB2  LESS THAN  +5
 11064             MOVE +5          TO SUB2
 11065             GO TO 0570-CHECK-LIFE-LIMITS.
 11066
 11067     MOVE ER-2637             TO WS-ERROR.
 11068     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11069
 11070     MOVE 'U'                 TO PB-BATCH-ENTRY.
 11071
 11072 0575-CHECK-NCL-SIG-SWITCH.
 11073
 11074     IF NOT APP-CERT-USED
 11075         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11076
 11077     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11078        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11079        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11080        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11081         GO TO 0580-AH-PLAN-LIMIT-EDITS.
 11082
 11083     IF SUB2 GREATER THAN +4
 11084         IF PL-LM-AGE (5) = ZEROS  AND
 11085            PL-LM-AGE (6) = ZEROS  AND
 11086            PL-LM-AGE (7) = ZEROS  AND
 11087            PL-LM-AGE (8) = ZEROS
 11088             MOVE  ER-1927        TO WS-ERROR
 11089             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11090             GO TO 0580-AH-PLAN-LIMIT-EDITS
 11091         ELSE
 11092             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11093                 MOVE  ER-1920    TO WS-ERROR
 11094                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11095
 11096     IF PB-I-SIG-SW  = 'Y'
 11097       IF NOT PB-I-POLICY-ACCEPTED  AND
 11098          NOT PB-I-POLICY-DECLINED
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 202
* EL050.cbl
 11099           MOVE 'U'               TO PB-BATCH-ENTRY
 11100           MOVE  ER-1926          TO WS-ERROR
 11101           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11102
 11103
 11104 0580-AH-PLAN-LIMIT-EDITS.
 11105
 11106     IF PB-COMPANY-ID = 'CID' OR 'AHL'
 11107        IF PB-I-AH-BENEFIT-AMT > +1250
 11108           MOVE ER-2702          TO WS-ERROR
 11109           PERFORM 9900-ERROR-FORMAT
 11110                                 THRU 9900-EXIT
 11111        END-IF
 11112     END-IF
 11113
 11114     IF (PB-COMPANY-ID = 'DCC')
 11115        AND (PB-MONTHLY-CERT)
 11116        IF PB-I-AH-BENEFIT-AMT > +3000
 11117           MOVE ER-2881          TO WS-ERROR
 11118           PERFORM 9900-ERROR-FORMAT
 11119                                 THRU 9900-EXIT
 11120        END-IF
 11121     END-IF
 11122     IF NOT AH-PLAN-MASTER-FOUND
 11123        MOVE +0                  TO EC-AM-AH-MAX-ATT-AGE
 11124        GO TO 3000-CONTINUE-EDIT.
 11125
 11126     MOVE LINK-AH-PLAN-RECORD    TO PLAN-MASTER.
 11127
 11128     IF PB-COMPANY-ID NOT = 'NCL' AND 'ACE'
 11129         IF PL-LM-AGE (1) = ZEROS
 11130             GO TO 3000-CONTINUE-EDIT.
 11131
 11132     IF NO-AH-BENEFIT-MATCH          OR
 11133        WS-AH-BENEFIT-CD = ZEROS     OR
 11134        WS-AH-SPECIAL-CALC-CD = 'M'
 11135        GO TO 3000-CONTINUE-EDIT.
 11136
 11137     MOVE 'YES'                  TO ACCOUNT-AH-CK-SW.
 11138     MOVE +1                     TO SUB2.
 11139
 11140     IF PB-COMPANY-ID EQUAL 'CRI' OR 'ACE'
 11141        IF PB-I-SIG-SW EQUAL 'S' OR 'J'
 11142           MOVE +5 TO SUB2
 11143           IF (PL-LM-AMT (SUB2) EQUAL +0) AND
 11144              (PL-LM-MOA (SUB2) EQUAL +0) AND
 11145              (PL-LM-DUR (SUB2) EQUAL +0) AND
 11146              (PL-LM-AGE (SUB2) EQUAL +0)
 11147              MOVE 'NO ' TO ACCOUNT-AH-CK-SW
 11148              GO TO 3000-CONTINUE-EDIT.
 11149
 11150     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 11151
 11152 0590-CHECK-AH-ATT-AGE.
 11153
 11154     IF PL-ATT-AGE NUMERIC AND
 11155        PL-ATT-AGE GREATER THAN +0
 11156        MOVE PL-ATT-AGE          TO EC-AM-AH-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 203
* EL050.cbl
 11157     END-IF
 11158*       IF WS-ATT-AGE >= PL-ATT-AGE
 11159*          MOVE ER-3054          TO WS-ERROR
 11160*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11161     .
 11162 0597-CHECK-AH-LIMITS.
 11163
 11164     IF PB-COMPANY-ID EQUAL 'CRI'
 11165        IF PB-I-SIG-SW NOT EQUAL 'S' AND 'J'
 11166           IF SUB2 GREATER THAN +4
 11167              MOVE ER-2638       TO WS-ERROR
 11168              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11169              GO TO 3000-CONTINUE-EDIT.
 11170
 11171     IF PB-COMPANY-ID  =  'NCL'
 11172        IF (SUB2 GREATER THAN +4  AND  NOT APP-CERT-USED)  OR
 11173            SUB2 GREATER THAN +8
 11174             MOVE 'U'            TO PB-BATCH-ENTRY
 11175             MOVE ER-2638        TO WS-ERROR
 11176             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11177             GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11178
 11179     IF SUB2 > +8
 11180        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11181           AND (PB-I-SIG-SW = 'Y')
 11182           CONTINUE
 11183        ELSE
 11184           MOVE ER-2638          TO WS-ERROR
 11185           PERFORM 9900-ERROR-FORMAT
 11186                                 THRU 9900-EXIT
 11187        END-IF
 11188        GO TO 3000-CONTINUE-EDIT
 11189     END-IF
 11190
 11191     IF PB-COMPANY-ID = 'CRI'
 11192        IF WS-ERROR = ER-2638
 11193           MOVE ZERO             TO PB-I-NO-OF-PAYMENTS.
 11194
 11195     MOVE PL-LM-AGE (SUB2)       TO EC-AM-AH-MAX-AGE.
 11196     MOVE PL-LM-DUR (SUB2)       TO EC-AM-AH-MAX-TERM.
 11197     MOVE PL-LM-MOA (SUB2)       TO EC-AM-AH-MAX-MON-BEN.
 11198     MOVE PL-LM-AMT (SUB2)       TO EC-AM-AH-MAX-TOT-BEN.
 11199
 11200     IF WS-AH-EDIT-AGE  GREATER THAN  PL-LM-AGE (SUB2)
 11201        ADD +1                   TO SUB2
 11202        GO TO 0597-CHECK-AH-LIMITS.
 11203
 11204     IF PB-COMPANY-ID = 'NCL'
 11205         GO TO 0597-CHECK-NCL-AH-LIMITS.
 11206
 11207     IF (PB-I-AH-TERM > PL-LM-DUR (SUB2))
 11208        OR (PB-I-AH-BENEFIT-AMT > PL-LM-MOA (SUB2))
 11209        OR ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11210                                 > PL-LM-AMT (SUB2))
 11211        IF (PB-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL')
 11212           AND (PB-I-SIG-SW = 'Y')
 11213           CONTINUE
 11214        ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 204
* EL050.cbl
 11215           MOVE ER-2638          TO WS-ERROR
 11216           PERFORM 9900-ERROR-FORMAT
 11217                                 THRU 9900-EXIT
 11218        END-IF
 11219     END-IF
 11220
 11221     IF  PB-COMPANY-ID   EQUAL    'CRI'
 11222         IF  WS-ERROR    EQUAL    ER-2638
 11223             IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 11224                MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 11225                MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11226                SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11227                MOVE  ER-1910    TO  WS-ERROR
 11228                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 11229
 11230     IF PB-COMPANY-ID = 'CRI'
 11231        IF WS-ERROR = ER-2638
 11232            MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 11233            SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 11234            MOVE ZERO            TO PB-I-NO-OF-PAYMENTS.
 11235
 11236     GO TO 3000-CONTINUE-EDIT.
 11237
 11238 0597-CHECK-NCL-AH-LIMITS.
 11239
 11240     IF PB-I-AH-TERM  NOT GREATER THAN  PL-LM-DUR (SUB2)  AND
 11241        PB-I-AH-BENEFIT-AMT NOT GREATER THAN PL-LM-MOA (SUB2)  AND
 11242        ((PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 11243                            NOT GREATER THAN PL-LM-AMT (SUB2))
 11244         GO TO 0599-CHECK-NCL-SIG-SWITCH.
 11245
 11246     IF APP-CERT-USED
 11247         IF SUB2  LESS THAN  +5
 11248             MOVE +5             TO SUB2
 11249             GO TO 0597-CHECK-AH-LIMITS.
 11250
 11251     MOVE ER-2638                TO WS-ERROR.
 11252     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11253
 11254     MOVE 'U'                    TO PB-BATCH-ENTRY.
 11255
 11256 0599-CHECK-NCL-SIG-SWITCH.
 11257
 11258     IF NOT APP-CERT-USED
 11259         GO TO 3000-CONTINUE-EDIT.
 11260
 11261     IF PL-L-LIMITS (1)  =  PL-L-LIMITS (5)  AND
 11262        PL-L-LIMITS (2)  =  PL-L-LIMITS (6)  AND
 11263        PL-L-LIMITS (3)  =  PL-L-LIMITS (7)  AND
 11264        PL-L-LIMITS (4)  =  PL-L-LIMITS (8)
 11265         GO TO 3000-CONTINUE-EDIT.
 11266
 11267     IF SUB2 GREATER THAN +4
 11268         IF PL-LM-AGE (5) = ZEROS  AND
 11269            PL-LM-AGE (6) = ZEROS  AND
 11270            PL-LM-AGE (7) = ZEROS  AND
 11271            PL-LM-AGE (8) = ZEROS
 11272             MOVE  ER-1927        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 205
* EL050.cbl
 11273             PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 11274             GO TO 3000-CONTINUE-EDIT
 11275         ELSE
 11276             IF PB-I-SIG-SW  NOT = 'S' AND 'J' AND 'Y'
 11277                 MOVE  ER-1920    TO WS-ERROR
 11278                 PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11279
 11280     IF PB-I-SIG-SW  = 'Y'
 11281       IF NOT PB-I-POLICY-ACCEPTED  AND
 11282          NOT PB-I-POLICY-DECLINED
 11283           MOVE 'U'               TO PB-BATCH-ENTRY
 11284           MOVE  ER-1926          TO WS-ERROR
 11285           PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 11286
 11287******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 206
* EL050.cbl
 11289
 11290 3000-CONTINUE-EDIT.
 11291
 11292     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 11293     MOVE AM-CSR-CODE            TO PB-CSR-ID.
 11294     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 11295     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 11296     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 11297
 11298     IF BROWSE-STARTED
 11299        PERFORM 9990-RETURN THRU 9990-EXIT
 11300        MOVE SPACES              TO WS-BROWSE-STARTED-SW.
 11301
 11302     IF PB-CERT-EFF-DT GREATER WS-CURRENT-BIN-DT
 11303        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11304        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-2
 11305        SET ELAPSED-BETWEEN-BIN  TO TRUE
 11306*       MOVE 1                   TO DC-OPTION-CODE
 11307        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 11308        IF DATE-CONVERSION-ERROR
 11309           MOVE ER-2622          TO WS-ERROR
 11310           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11311        ELSE
 11312           IF DC-ELAPSED-MONTHS   GREATER THAN +2
 11313              MOVE ER-2623       TO WS-ERROR
 11314              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11315           ELSE
 11316              MOVE ER-2622       TO WS-ERROR
 11317              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11318
 11319     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 11320     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2.
 11321     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 11322*    MOVE 1                      TO DC-OPTION-CODE.
 11323     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11324     IF DATE-CONVERSION-ERROR
 11325        GO TO 3005-EDIT-CONTINUE
 11326     ELSE
 11327        IF DC-ELAPSED-DAYS GREATER +180
 11328           MOVE ER-2613          TO WS-ERROR
 11329           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11330        ELSE
 11331           IF DC-ELAPSED-DAYS GREATER +90
 11332              MOVE ER-2612       TO WS-ERROR
 11333              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11334           ELSE
 11335             IF DC-ELAPSED-DAYS GREATER +60
 11336                MOVE ER-2614     TO WS-ERROR
 11337                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11338
 11339 3005-EDIT-CONTINUE.
 11340
 11341     IF PB-CANCELLATION
 11342         GO TO 3700-EDIT-CANCEL.
 11343
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 207
* EL050.cbl
 11345******************************************************************
 11346*                  E D I T   I S S U E                           *
 11347******************************************************************
 11348
 11349 3020-EDIT-ISSUE.
 11350
 11351      MOVE WS-TOL-LF-PREM         TO PB-CALC-TOLERANCE.
 11352      MOVE WS-PREM-REJECT-SW      TO PB-TOLERANCE-REJECT-SW.
 11353      MOVE WS-LF-EARNINGS-CALC    TO PB-LF-EARNING-METHOD.
 11354      MOVE WS-AH-EARNINGS-CALC    TO PB-AH-EARNING-METHOD.
 11355      MOVE WS-ACCT-REIN-TABLE     TO PB-REIN-CD.
 11356
 11357     IF PB-ISSUE-FORCE
 11358        OR PB-ISSUE-DATE-FORCED
 11359        OR PB-FORCE-OFF
 11360        OR PB-OVERCHARGE-FORCE
 11361        CONTINUE
 11362     ELSE
 11363        MOVE ER-2670             TO WS-ERROR
 11364        PERFORM 9900-ERROR-FORMAT
 11365                                 THRU 9900-EXIT
 11366     END-IF
 11367     .
 11368 3022-SET-POLICY-STATUS.
 11369
 11370     MOVE '2'                    TO PB-I-ENTRY-STATUS.
 11371
 11372     IF (PB-REISSUED-CERT)
 11373             OR
 11374        ((PB-COMPANY-ID NOT = 'DCC')
 11375         AND (PB-MONTHLY-CERT))
 11376         MOVE '5'                TO PB-I-ENTRY-STATUS
 11377         MOVE 'E'                TO PB-BATCH-ENTRY
 11378     END-IF
 11379
 11380     IF PB-COMPANY-ID = 'DCC'
 11381        IF PB-MONTHLY-CERT
 11382           MOVE 'M'              TO PB-I-ENTRY-STATUS
 11383        END-IF
 11384        IF PB-CASH-CERT
 11385           MOVE 'C'              TO PB-I-ENTRY-STATUS
 11386        END-IF
 11387     END-IF
 11388     IF PB-POLICY-IS-DECLINED
 11389         MOVE 'D'                TO PB-I-ENTRY-STATUS.
 11390     IF PB-POLICY-IS-VOIDED
 11391         MOVE 'V'                TO PB-I-ENTRY-STATUS.
 11392     IF PB-NEEDS-UNDERWRITING
 11393         MOVE 'U'                TO PB-I-ENTRY-STATUS.
 11394     IF PB-REIN-ONLY-CERT
 11395         MOVE '9'                TO PB-I-ENTRY-STATUS.
 11396     IF PB-PREM-ACCTNG-ONLY
 11397         MOVE 'P'                TO PB-I-ENTRY-STATUS.
 11398
 11399     MOVE SPACE                  TO PB-I-OB-FLAG.
 11400
 11401     IF PB-I-RATE-CLASS-OVRD NOT = ZERO AND SPACE
 11402         MOVE ER-2665            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 208
* EL050.cbl
 11403         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11404         MOVE PB-I-RATE-CLASS-OVRD TO PB-I-RATE-CLASS.
 11405
 11406     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 11407        AND WS-AH-SPECIAL-CALC-CD = 'Z'
 11408           MOVE 'Z'             TO PB-I-OB-FLAG.
 11409
 11410     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 11411        AND WS-LF-SPECIAL-CALC-CD = 'Z'
 11412           MOVE 'Z'             TO PB-I-OB-FLAG.
 11413
 11414     IF ACCOUNT-MAST-FOUND
 11415         MOVE WS-ACCT-LF-DEVIATION  TO PB-I-RATE-DEVIATION-LF
 11416         MOVE WS-ACCT-AH-DEVIATION  TO PB-I-RATE-DEVIATION-AH
 11417         MOVE WS-ACCT-LF-DEV-PCT    TO PB-I-RATE-DEV-PCT-LF
 11418         MOVE WS-ACCT-AH-DEV-PCT    TO PB-I-RATE-DEV-PCT-AH
 11419         MOVE WS-ACCT-BUSINESS-TYPE TO PB-I-BUSINESS-TYPE
 11420         MOVE WS-ACCT-REIN-TABLE    TO PB-I-REIN-TABLE
 11421         MOVE WS-ACCT-ADDL-CLP      TO PB-I-ADDL-CLP
 11422     END-IF
 11423
 11424     IF ACCOUNT-MAST-FOUND
 11425        AND (PB-I-RATE-CLASS-OVRD = ZERO OR SPACE)
 11426         MOVE WS-ACCT-CLASS-TABLE  TO PB-I-RATE-CLASS.
 11427
 11428     IF (ACCOUNT-MAST-FOUND)
 11429        AND (WS-ACCT-STATUS = 'I' OR 'F' OR 'S')
 11430        IF PB-REISSUED-CERT
 11431           CONTINUE
 11432        ELSE
 11433           MOVE ER-2608          TO WS-ERROR
 11434           PERFORM 9900-ERROR-FORMAT
 11435                                 THRU 9900-EXIT
 11436         END-IF
 11437     END-IF
 11438
 11439     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 11440        MOVE PB-I-LF-CRIT-PER    TO WS-WORK-LF-CRIT-PER
 11441        MOVE WS-WORK-CRIT-DEV    TO PB-I-RATE-DEVIATION-LF.
 11442
 11443**********   DMD CUSTOM CODE FOLLOWS  **********
 11444 3024-EDIT-DMD-FIELDS.
 11445     IF PB-COMPANY-ID NOT = 'DMD'
 11446        GO TO 3025-EDIT-REINSURANCE.
 11447
 11448*** FOR DMD ONLY : COMPARE THE MONTH AND THE YEAR OF THE
 11449*** EFFECTIVE DATE TO THE CREDIT SELECT DATE.  IT IS A FATAL
 11450*** ERROR IF THEY ARE NOT EQUAL.
 11451
 11452     MOVE PB-CREDIT-SELECT-DT      TO DC-BIN-DATE-1.
 11453     SET BIN-TO-GREG               TO TRUE.
 11454     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 11455     MOVE DC-GREG-DATE-CYMD        TO WORK-SELECT-DATE.
 11456**   MOVE DC-GREG-DATE-CYMD        TO WK-SELECT-DATE-YYMMDD.
 11457
 11458     MOVE PB-CERT-EFF-DT           TO DC-BIN-DATE-1.
 11459     SET BIN-TO-GREG               TO TRUE.
 11460     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 209
* EL050.cbl
 11461     MOVE DC-GREG-DATE-CYMD        TO WORK-GREGORIAN-DATE.
 11462**   MOVE DC-GREG-DATE-CYMD        TO WK-GREG-DATE-YYMMDD.
 11463
 11464     IF WK-GREG-YYMM  NOT EQUAL WK-SELECT-GREG-YYMM
 11465        MOVE ER-8116               TO WS-ERROR
 11466        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11467
 11468     MOVE PB-I-RESIDENT-STATE      TO DCUA-RES-STATE.
 11469
 11470     MOVE PB-CERT-NO               TO DCUA-PREV-CERT-NUMBER
 11471                                      WK-FULL-CERT-NO.
 11472     MOVE PB-CERT-NO (3:1)         TO DCUA-SYS-IDENT.
 11473
 11474     MOVE PB-ACCOUNT               TO DCUA-CLIENT-ID.
 11475
 11476     IF PB-VALID-LIFE
 11477        MOVE PB-I-LF-BENEFIT-CD    TO DCUA-BEN-TYPE
 11478     ELSE
 11479        IF PB-VALID-AH
 11480          MOVE PB-I-AH-BENEFIT-CD  TO DCUA-BEN-TYPE.
 11481
 11482
 11483     MOVE WK-CERT-POS-7            TO DCUA-COVERAGE-RULE.
 11484     MOVE WORK-GREGORIAN-DATE      TO DCUA-EFF-DATE.
 11485     MOVE SPACES                   TO DCUA-CERT-NUMBER
 11486                                      DCUA-UNDRWRTR-CODE
 11487                                      DCUA-UNDRWRTR-GROUP-CODE
 11488                                      DCUA-RETURN-CODE.
 11489
 11490****************************************************************
 11491*** CERTIFICATE NUMBER AND UNDERWRITER ASSIGNMENT :          ***
 11492***   CALL SUBROUTINE DLO007 TO GET A NEW UNDERWRITER.       ***
 11493***   COMPARE THE NEW UNDERWRITER WITH THE CURRENT ONE,      ***
 11494***   AND IF THEY ARE DIFFERENT, PREVENT ANY OTHER UPDATES   ***
 11495***   TO THIS RECORD.                                        ***
 11496****************************************************************
 11497     MOVE ' '                      TO WS-DLO-ERROR-SW.
 11498     PERFORM 7730-CALL-DL7 THRU 7730-EXIT.
 11499     IF DCUA-SUCCESSFUL-PROCESS
 11500        GO TO 3024-EDIT-DL7-CONT.
 11501
 11502     IF DCUA-RETURN-CODE EQUAL '01'
 11503        MOVE ER-8110               TO WS-ERROR
 11504        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11505        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11506        GO TO 3024-EDIT-DL7-CONT.
 11507
 11508     IF DCUA-RETURN-CODE EQUAL '02'
 11509        MOVE ER-8111               TO WS-ERROR
 11510        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11512        GO TO 3024-EDIT-DL7-CONT.
 11513
 11514     IF DCUA-RETURN-CODE EQUAL '03'
 11515        MOVE ER-8074               TO WS-ERROR
 11516        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11517        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11518        GO TO 3024-EDIT-DL7-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 210
* EL050.cbl
 11519
 11520     IF DCUA-RETURN-CODE EQUAL '04'
 11521        MOVE ER-8075               TO WS-ERROR
 11522        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11523        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11524        GO TO 3024-EDIT-DL7-CONT.
 11525
 11526     IF DCUA-RETURN-CODE EQUAL '05'
 11527        MOVE ER-8076               TO WS-ERROR
 11528        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11529        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11530        GO TO 3024-EDIT-DL7-CONT.
 11531
 11532     IF DCUA-RETURN-CODE EQUAL '06'
 11533        MOVE ER-8077               TO WS-ERROR
 11534        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11535        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11536        GO TO 3024-EDIT-DL7-CONT.
 11537
 11538     IF DCUA-RETURN-CODE EQUAL '07'
 11539        MOVE ER-8078               TO WS-ERROR
 11540        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11541        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11542        GO TO 3024-EDIT-DL7-CONT.
 11543
 11544     IF DCUA-RETURN-CODE EQUAL 'E1'
 11545        MOVE ER-8079               TO WS-ERROR
 11546        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11547        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11548        GO TO 3024-EDIT-DL7-CONT.
 11549
 11550     IF DCUA-RETURN-CODE EQUAL 'E2'
 11551        MOVE ER-8080               TO WS-ERROR
 11552        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11553        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11554        GO TO 3024-EDIT-DL7-CONT.
 11555
 11556     IF DCUA-RETURN-CODE EQUAL 'E3'
 11557        MOVE ER-8098               TO WS-ERROR
 11558        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11559        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11560        GO TO 3024-EDIT-DL7-CONT.
 11561
 11562     IF DCUA-RETURN-CODE EQUAL 'C1'
 11563        MOVE ER-8099               TO WS-ERROR
 11564        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11566        GO TO 3024-EDIT-DL7-CONT.
 11567
 11568     IF DCUA-RETURN-CODE EQUAL 'U1'
 11569        MOVE ER-8109               TO WS-ERROR
 11570        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11572        GO TO 3024-EDIT-DL7-CONT.
 11573
 11574     IF DCUA-RETURN-CODE EQUAL 'N1'
 11575        MOVE ER-8112               TO WS-ERROR
 11576        MOVE 'Y'                   TO WS-DLO-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 211
* EL050.cbl
 11577        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11578        GO TO 3024-EDIT-DL7-CONT.
 11579
 11580     IF DCUA-RETURN-CODE EQUAL 'N2'
 11581        MOVE ER-8113               TO WS-ERROR
 11582        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11583        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11584        GO TO 3024-EDIT-DL7-CONT.
 11585
 11586     IF DCUA-RETURN-CODE EQUAL 'N3'
 11587        MOVE ER-8114               TO WS-ERROR
 11588        MOVE 'Y'                   TO WS-DLO-ERROR-SW
 11589        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11590        GO TO 3024-EDIT-DL7-CONT.
 11591
 11592     MOVE 'Y'                      TO WS-DLO-ERROR-SW.
 11593     MOVE ER-8097                  TO WS-ERROR.
 11594     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 11595     GO TO 3024-EDIT-DL7-CONT.
 11596
 11597 3024-EDIT-DL7-CONT.
 11598
 11599     MOVE DCUA-UNDRWRTR-CODE       TO EC-NEW-STATE.
 11600     MOVE DCUA-CERT-NUMBER         TO EC-NEW-CERT.
 11601     IF DCUA-UNDRWRTR-CODE = PB-SV-STATE
 11602        NEXT SENTENCE
 11603     ELSE
 11604        MOVE ER-9263               TO WS-ERROR
 11605        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11606
 11607******* CERT NUMBER MUST BE THE SAME OR A 'K' TRANSACTION IS
 11608******* NECESSARY. NO FURTHER UPDATES ARE ALLOWED...
 11609     IF DCUA-CERT-NUMBER = PB-CERT-NO
 11610        NEXT SENTENCE
 11611     ELSE
 11612        MOVE ER-8039               TO WS-ERROR
 11613        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11614
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 212
* EL050.cbl
 11616****************************************************************
 11617*** VALIDATE STATE  : DLO022                                 ***
 11618****************************************************************
 11619     MOVE PB-I-RESIDENT-STATE      TO DVSC-STATE-CODE.
 11620     MOVE SPACES                   TO DVSC-RETURN-CODE.
 11621
 11622     PERFORM 7770-CALL-DL22 THRU 7770-EXIT.
 11623     IF DVSC-SUCCESSFUL-EDIT
 11624        GO TO 3024-EDIT-DL22-CONT.
 11625
 11626     IF DVSC-RETURN-CODE EQUAL '01'
 11627        MOVE ER-8300               TO WS-ERROR
 11628        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11629        GO TO 3024-EDIT-DL22-CONT.
 11630
 11631     IF DVSC-RETURN-CODE EQUAL '02'
 11632        MOVE ER-8301               TO WS-ERROR
 11633        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11634        GO TO 3024-EDIT-DL22-CONT.
 11635
 11636     IF DVSC-RETURN-CODE EQUAL '03'
 11637        MOVE ER-8302               TO WS-ERROR
 11638        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11639        GO TO 3024-EDIT-DL22-CONT.
 11640
 11641     IF DVSC-RETURN-CODE EQUAL 'N1'
 11642        MOVE ER-8304               TO WS-ERROR
 11643        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11644        GO TO 3024-EDIT-DL22-CONT.
 11645
 11646     MOVE ER-8303                  TO WS-ERROR
 11647     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11648
 11649 3024-EDIT-DL22-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 213
* EL050.cbl
 11651****************************************************************
 11652*** VALIDATE LOAN OFFICER : DLO021                           ***
 11653****************************************************************
 11654
 11655     MOVE PB-I-LOAN-OFFICER         TO DVLO-LOAN-OFFICER.
 11656     MOVE SPACES                    TO DVLO-RETURN-CODE.
 11657     PERFORM 7760-CALL-DL21 THRU 7760-EXIT.
 11658     IF DVLO-SUCCESSFUL-EDIT
 11659        GO TO 3024-EDIT-DL21-CONT.
 11660
 11661     IF DVLO-RETURN-CODE EQUAL '01'
 11662        MOVE ER-8081               TO WS-ERROR
 11663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11664        GO TO 3024-EDIT-DL21-CONT.
 11665
 11666     IF DVLO-RETURN-CODE EQUAL '02'
 11667        MOVE ER-8082               TO WS-ERROR
 11668        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11669        GO TO 3024-EDIT-DL21-CONT.
 11670
 11671     IF DVLO-RETURN-CODE EQUAL '03'
 11672        MOVE ER-8083               TO WS-ERROR
 11673        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11674        GO TO 3024-EDIT-DL21-CONT.
 11675
 11676     IF DVLO-RETURN-CODE EQUAL '04'
 11677        MOVE ER-8084               TO WS-ERROR
 11678        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11679        GO TO 3024-EDIT-DL21-CONT.
 11680
 11681     IF DVLO-RETURN-CODE EQUAL '05'
 11682        MOVE ER-8085               TO WS-ERROR
 11683        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11684        GO TO 3024-EDIT-DL21-CONT.
 11685
 11686     MOVE ER-7825                  TO WS-ERROR
 11687     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11688     GO TO 3024-EDIT-DL21-CONT.
 11689
 11690 3024-EDIT-DL21-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 214
* EL050.cbl
 11692
 11693****************************************************************
 11694*** VALIDATE INTERNAL POLICY FORM NUMBER : DLO002            ***
 11695****************************************************************
 11696
 11697     MOVE PB-I-MEMBER-NO         TO WK-MEMBER-NO.
 11698     MOVE WK-MEMBER-1-6          TO DIPF-POLICY-FORM-NUMBER.
 11699     MOVE SPACES                 TO DIPF-RETURN-CODE.
 11700     PERFORM 7710-CALL-DL2  THRU 7710-EXIT.
 11701     IF DIPF-SUCCESSFUL-EDIT
 11702        GO TO 3024-EDIT-DL02-CONT.
 11703
 11704     IF DIPF-RETURN-CODE EQUAL '01'
 11705        MOVE ER-8086               TO WS-ERROR
 11706        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11707        GO TO 3024-EDIT-DL02-CONT.
 11708
 11709     IF DIPF-RETURN-CODE EQUAL '02'
 11710        MOVE ER-8087               TO WS-ERROR
 11711        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11712        GO TO 3024-EDIT-DL02-CONT.
 11713
 11714     IF DIPF-RETURN-CODE EQUAL '03'
 11715        MOVE ER-8088               TO WS-ERROR
 11716        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11717        GO TO 3024-EDIT-DL02-CONT.
 11718
 11719     MOVE ER-8095                  TO WS-ERROR
 11720     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11721     GO TO 3024-EDIT-DL02-CONT.
 11722
 11723 3024-EDIT-DL02-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 215
* EL050.cbl
 11725
 11726****************************************************************
 11727*** VALIDATE BANK ID : DLO003                                ***
 11728****************************************************************
 11729
 11730     MOVE WK-GREG-CENT           TO WCG-CENT.
 11731     MOVE WK-GREG-YYMM           TO WCG-REST.
 11732     IF WK-MEMBER-7-12 NOT = WK-CONV-GREG
 11733        MOVE ER-8040               TO WS-ERROR
 11734        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11735
 11736     MOVE PB-I-POLICY-FORM-NO    TO  WK-FORM-NO.
 11737     MOVE WK-FORM-BANK-ID        TO  DVBI-BANK-ID.
 11738     MOVE 'P'                    TO  DVBI-BANK-ID-TYPE.
 11739     MOVE SPACES                 TO  DVBI-RETURN-CODE.
 11740     PERFORM 7720-CALL-DL3       THRU 7720-EXIT.
 11741     IF DVBI-SUCCESSFUL-EDIT
 11742        GO TO 3024-EDIT-DL03-CONT.
 11743
 11744     IF DVBI-RETURN-CODE EQUAL '01'
 11745        MOVE ER-8089               TO WS-ERROR
 11746        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11747        GO TO 3024-EDIT-DL03-CONT.
 11748
 11749     IF DVBI-RETURN-CODE EQUAL '02'
 11750        MOVE ER-8090               TO WS-ERROR
 11751        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11752        GO TO 3024-EDIT-DL03-CONT.
 11753
 11754     IF DVBI-RETURN-CODE EQUAL '03'
 11755        MOVE ER-8091               TO WS-ERROR
 11756        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11757        GO TO 3024-EDIT-DL03-CONT.
 11758
 11759     IF DVBI-RETURN-CODE EQUAL '04'
 11760        MOVE ER-8092               TO WS-ERROR
 11761        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11762        GO TO 3024-EDIT-DL03-CONT.
 11763
 11764     IF DVBI-RETURN-CODE EQUAL '05'
 11765        MOVE ER-8093               TO WS-ERROR
 11766        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11767        GO TO 3024-EDIT-DL03-CONT.
 11768
 11769     IF DVBI-RETURN-CODE EQUAL '06'
 11770        MOVE ER-8094               TO WS-ERROR
 11771        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11772        GO TO 3024-EDIT-DL03-CONT.
 11773
 11774     MOVE ER-8096                  TO WS-ERROR
 11775     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 11776     GO TO 3024-EDIT-DL03-CONT.
 11777
 11778 3024-EDIT-DL03-CONT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 216
* EL050.cbl
 11780
 11781     IF DCUA-UNDRWRTR-GROUP-CODE = WK-FORM-UNDRWRTR
 11782        NEXT SENTENCE
 11783     ELSE
 11784        MOVE ER-8042               TO WS-ERROR
 11785        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11786
 11787     MOVE WK-FORM-MASTER-POL-NO  TO  DMPF-POLICY-FORM-NUMBER.
 11788     MOVE SPACES                 TO  DMPF-RETURN-CODE.
 11789     PERFORM 7700-CALL-DL1  THRU 7700-EXIT.
 11790
 11791     IF DMPF-RETURN-CODE = '01'
 11792        MOVE ER-8067               TO WS-ERROR
 11793        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11794        GO TO 3024-EDIT-DL01-CONT.
 11795
 11796     IF DMPF-RETURN-CODE = '02'
 11797        MOVE ER-8068               TO WS-ERROR
 11798        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11799        GO TO 3024-EDIT-DL01-CONT.
 11800
 11801     IF DMPF-RETURN-CODE = '03'
 11802        MOVE ER-8069               TO WS-ERROR
 11803        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11804        GO TO 3024-EDIT-DL01-CONT.
 11805
 11806     IF DMPF-RETURN-CODE = 'E1'
 11807        MOVE ER-8070               TO WS-ERROR
 11808        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11809        GO TO 3024-EDIT-DL01-CONT.
 11810
 11811     IF DMPF-RETURN-CODE = 'N1'
 11812        MOVE ER-8071               TO WS-ERROR
 11813        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11814        GO TO 3024-EDIT-DL01-CONT.
 11815
 11816     IF DMPF-RETURN-CODE NOT = 'OK'
 11817        MOVE ER-8072               TO WS-ERROR
 11818        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11819
 11820 3024-EDIT-DL01-CONT.
 11821******************************************************************
 11822***  VALIDATES RATE CODES : DLO017                             ***
 11823******************************************************************
 11824
 11825      MOVE PB-I-RATE-CODE           TO DVRC-RATE-CODE.
 11826      MOVE SPACES                   TO DVRC-RETURN-CODE.
 11827      PERFORM 7750-CALL-DL17 THRU 7750-EXIT.
 11828      IF DVRC-SUCCESSFUL-EDIT
 11829        MOVE 'Y'                   TO WK-VALID-RATE-CODE
 11830        GO TO 3024-CHECK-VALID-RATE.
 11831
 11832      MOVE 'N'                     TO WK-VALID-RATE-CODE.
 11833
 11834      IF DVRC-RETURN-CODE EQUAL '01'
 11835         MOVE ER-7817                   TO WS-ERROR
 11836         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11837         GO TO 3025-EDIT-REINSURANCE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 217
* EL050.cbl
 11838
 11839      IF DVRC-RETURN-CODE EQUAL '02'
 11840         MOVE ER-7818                   TO WS-ERROR
 11841         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11842         GO TO 3025-EDIT-REINSURANCE.
 11843
 11844      IF DVRC-RETURN-CODE EQUAL '03'
 11845         MOVE ER-7819                   TO WS-ERROR
 11846         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11847         GO TO 3025-EDIT-REINSURANCE.
 11848
 11849       MOVE ER-7820                     TO WS-ERROR.
 11850       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11851       GO TO 3025-EDIT-REINSURANCE.
 11852
 11853******************************************************************
 11854***  GET PREMIUM RATES : DLO011                                ***
 11855******************************************************************
 11856
 11857 3024-CHECK-VALID-RATE.
 11858
 11859     IF VALID-RATE-CODE
 11860        MOVE PB-I-RATE-CODE        TO DPRB-RATE-CODE
 11861        MOVE WK-CERT-POS-4         TO DPRB-COVERAGE-CATEG
 11862        MOVE SPACES                TO DPRB-RETURN-CODE
 11863        PERFORM 7740-CALL-DL11 THRU 7740-EXIT
 11864     ELSE
 11865         GO TO 3025-EDIT-REINSURANCE.
 11866
 11867      IF DPRB-SUCCESSFUL-PROCESS
 11868         IF PB-VALID-LIFE
 11869             MOVE DPRB-COV-CAT-RATE     TO PB-I-LF-RATE
 11870             GO TO 3025-EDIT-REINSURANCE
 11871         ELSE
 11872             IF PB-VALID-AH
 11873                 MOVE DPRB-COV-CAT-RATE TO PB-I-AH-RATE
 11874                 GO TO 3025-EDIT-REINSURANCE.
 11875
 11876      IF DPRB-RETURN-CODE EQUAL '01'
 11877         MOVE ER-7812                   TO WS-ERROR
 11878         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11879         GO TO 3025-EDIT-REINSURANCE.
 11880
 11881      IF DPRB-RETURN-CODE EQUAL '02'
 11882         MOVE ER-7813                   TO WS-ERROR
 11883         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11884         GO TO 3025-EDIT-REINSURANCE.
 11885
 11886      IF DPRB-RETURN-CODE EQUAL '03'
 11887         MOVE ER-7814                   TO WS-ERROR
 11888         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11889         GO TO 3025-EDIT-REINSURANCE.
 11890
 11891      IF DPRB-RETURN-CODE EQUAL '04'
 11892         IF NOT DPRB-1ST-TIME
 11893            MOVE ER-7815                   TO WS-ERROR
 11894            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11895            GO TO 3025-EDIT-REINSURANCE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 218
* EL050.cbl
 11896          ELSE
 11897         IF PB-VALID-LIFE
 11898            MOVE PB-I-LF-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11899          ELSE
 11900            MOVE PB-I-AH-BENEFIT-CD    TO DOCC-ORIG-BEN-TYPE
 11901         END-IF
 11902         MOVE SPACES                TO DOCC-RETURN-CODE
 11903         MOVE 'X'                   TO DPRB-1ST-TIME-SW
 11904         PERFORM 7755-CALL-DL19 THRU 7755-EXIT
 11905         IF DOCC-RETURN-CODE = 'OK'
 11906             MOVE DOCC-ORIG-COV-CAT     TO WK-CERT-POS-4
 11907             GO TO 3024-CHECK-VALID-RATE
 11908           ELSE
 11909             MOVE ER-7823               TO WS-ERROR
 11910             PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
 11911             GO TO 3025-EDIT-REINSURANCE.
 11912
 11913       MOVE ER-7816                     TO WS-ERROR.
 11914       PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
 11915       GO TO 3025-EDIT-REINSURANCE.
 11916
 11917**********   DMD CUSTOM CODE ABOVE    **********
 11918
 11919 3025-EDIT-REINSURANCE.
 11920     IF PB-I-SPECIAL-REIN-CODE = SPACE
 11921         GO TO 3027-EDIT-CONTINUE.
 11922
 11923     MOVE LOW-VALUES               TO ERREIN-KEY.
 11924     MOVE PB-COMPANY-CD            TO REIN-COMP-CD.
 11925     MOVE PB-I-SPECIAL-REIN-CODE   TO REIN-CODE-1
 11926                                      REIN-CODE-2
 11927                                      REIN-CODE-3.
 11928     MOVE 'A'                      TO REIN-TYPE.
 11929
 11930     MOVE REIN-TABLE-CO            TO PB-I-REIN-TABLE.
 11931
 11932     MOVE '3026' TO REIN-SW.
 11933     MOVE ' '                   TO WS-REIN-READ-SW.
 11934
 11935     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11936     IF REIN-TABLE-NOT-FOUND
 11937         GO TO 3026-NO-SPEC-TABLE.
 11938
 11939     MOVE RE-TABLE              TO WK-REIN-TABLE.
 11940     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11941                                   WS-NSP-ST-CD-LF.
 11942     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11943                                   WS-NSP-ST-CD-AH.
 11944
 11945     GO TO 3040-EDIT-CONTINUE.
 11946
 11947 3026-NO-SPEC-TABLE.
 11948
 11949     MOVE ER-2664                TO WS-ERROR.
 11950     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11951     GO TO 3040-EDIT-CONTINUE.
 11952
 11953 3027-EDIT-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 219
* EL050.cbl
 11954
 11955     IF PB-I-REIN-TABLE = SPACES
 11956       GO TO 3040-EDIT-CONTINUE.
 11957
 11958     IF PB-I-REIN-TABLE = WK-REIN-TABLE
 11959          MOVE WK-REIN-ST-LF     TO WS-NSP-ST-CD-LF
 11960          MOVE WK-REIN-ST-AH     TO WS-NSP-ST-CD-AH
 11961           GO TO 3040-EDIT-CONTINUE.
 11962
 11963     MOVE LOW-VALUES            TO ERREIN-KEY.
 11964     MOVE PB-COMPANY-CD         TO REIN-COMP-CD.
 11965     MOVE 'A'                   TO REIN-TYPE.
 11966     MOVE PB-I-REIN-TABLE       TO REIN-TABLE-CO.
 11967
 11968     MOVE '3028'                TO REIN-SW.
 11969     MOVE ' '                   TO WS-REIN-READ-SW.
 11970
 11971     PERFORM 8200-READ-REIN-TABLE THRU 8200-EXIT.
 11972     IF REIN-TABLE-NOT-FOUND
 11973         GO TO 3028-NO-REIN-TABLE.
 11974
 11975     MOVE PB-I-REIN-TABLE       TO WK-REIN-TABLE.
 11976     MOVE RE-NSP-ST-CD-LF       TO WK-REIN-ST-LF
 11977                                   WS-NSP-ST-CD-LF.
 11978     MOVE RE-NSP-ST-CD-AH       TO WK-REIN-ST-AH
 11979                                   WS-NSP-ST-CD-AH.
 11980
 11981     GO TO 3040-EDIT-CONTINUE.
 11982
 11983 3028-NO-REIN-TABLE.
 11984
 11985     MOVE ER-2615                TO WS-ERROR.
 11986     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11987     GO TO 3040-EDIT-CONTINUE.
 11988
 11989 3040-EDIT-CONTINUE.
 11990
 11991     IF PB-I-LF-PREM-CALC NOT NUMERIC
 11992         MOVE ZEROS              TO PB-I-LF-PREM-CALC.
 11993
 11994     IF PB-I-AH-PREM-CALC NOT NUMERIC
 11995         MOVE ZEROS              TO PB-I-AH-PREM-CALC.
 11996
 11997     IF (NOT PB-REISSUED-CERT)
 11998        AND (NOT PB-MONTHLY-CERT)
 11999        IF (LF-BENEFIT-FOUND AND WS-LF-SPECIAL-CALC-CD = 'O')
 12000            MOVE '001'           TO PB-I-LF-TERM
 12001            MOVE 'M'             TO PB-I-INSURED-SEX.
 12002
 12003     IF (NOT PB-REISSUED-CERT)
 12004        AND (NOT PB-MONTHLY-CERT)
 12005        IF (AH-BENEFIT-FOUND AND WS-AH-SPECIAL-CALC-CD = 'O')
 12006            MOVE '001'           TO PB-I-AH-TERM
 12007            MOVE 'M'             TO PB-I-INSURED-SEX.
 12008
 12009 3040-EDIT-1ST-PMT-DT.
 12010     MOVE ZEROS                  TO WS-DAYS-TO-1ST-PMT
 12011     IF PB-I-EXTENTION-DAYS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 220
* EL050.cbl
 12012         MOVE ZEROS TO PB-I-EXTENTION-DAYS.
 12013
 12014******************************************************************
 12015*                                                                *
 12016*        IF THE EFFECTIVE DATE WAS ENTER AND 1ST PMT DATE,       *
 12017*        EXPIRE DATE, AND EXTENSION DAYS  WERE NOT ENTERED,      *
 12018*        SET THE 1ST PMT DATE BASED ON THE EFFECTIVE DATE OF     *
 12019*        THE CERTIFICATE.  (EFFECTIVE DATE PLUS ONE MONTH).      *
 12020*                                                                *
 12021******************************************************************
 12022
 12023     IF PB-EFF-DT-PROCESSING
 12024        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12025                                    PB-I-LF-EXPIRE-DT
 12026                                    PB-I-AH-EXPIRE-DT
 12027        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12028        MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12029        MOVE ZERO                TO DC-ELAPSED-DAYS
 12030        MOVE +1                  TO DC-ELAPSED-MONTHS
 12031        SET BIN-PLUS-ELAPSED     TO TRUE
 12032*       MOVE 6                   TO DC-OPTION-CODE
 12033        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12034        IF NO-CONVERSION-ERROR
 12035           MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12036
 12037******************************************************************
 12038*                                                                *
 12039*        IF EXTENSION DAYS WERE ENTERED, AND THE 1ST PMT         *
 12040*        DATE AS WELL AS THE EXPIRE DATES WERE NOT ENTERED,      *
 12041*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12042*        (EFFECTIVE DATE + ONE MONTH + EXTENSION DAYS)           *
 12043*                                                                *
 12044******************************************************************
 12045
 12046     IF PB-EXT-DAYS-PROCESSING
 12047          MOVE LOW-VALUE              TO PB-I-1ST-PMT-DT
 12048                                         PB-I-LF-EXPIRE-DT
 12049                                         PB-I-AH-EXPIRE-DT
 12050          MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 12051          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12052          MOVE +1                     TO DC-ELAPSED-MONTHS
 12053          MOVE PB-I-EXTENTION-DAYS    TO DC-ELAPSED-DAYS
 12054          SET BIN-PLUS-ELAPSED        TO TRUE
 12055*         MOVE 6                      TO DC-OPTION-CODE
 12056          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12057          IF NO-CONVERSION-ERROR
 12058             MOVE DC-BIN-DATE-2       TO PB-I-1ST-PMT-DT.
 12059
 12060******************************************************************
 12061*                                                                *
 12062*        IF EXPIRE DATES WERE ENTERED, SET THE 1ST PMT DATE      *
 12063*        BASED ON THE OLDEST EXPIRE DATE.                        *
 12064*        SET THE 1ST PMT DATE BASED ON THE EXTENSION DAYS.       *
 12065*        (EXPIRE DATE - (TERM -1))  *  -1.
 12066*                                                                *
 12067******************************************************************
 12068
 12069     IF PB-EXPIRE-DT-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 221
* EL050.cbl
 12070        IF PB-I-LF-EXPIRE-DT GREATER THAN PB-I-AH-EXPIRE-DT
 12071           IF PB-I-AH-EXPIRE-DT GREATER THAN LOW-VALUES
 12072              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12073              MOVE PB-I-AH-TERM      TO WS-TERM
 12074           ELSE
 12075              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12076              MOVE PB-I-LF-TERM      TO WS-TERM
 12077        ELSE
 12078           IF PB-I-LF-EXPIRE-DT GREATER THAN LOW-VALUES
 12079              MOVE PB-I-LF-EXPIRE-DT TO WS-EXPIRE-DT
 12080              MOVE PB-I-LF-TERM      TO WS-TERM
 12081           ELSE
 12082              MOVE PB-I-AH-EXPIRE-DT TO WS-EXPIRE-DT
 12083              MOVE PB-I-AH-TERM      TO WS-TERM.
 12084
 12085     IF PB-EXPIRE-DT-PROCESSING
 12086        MOVE LOW-VALUE           TO PB-I-1ST-PMT-DT
 12087        MOVE ZEROS               TO PB-I-EXTENTION-DAYS
 12088        MOVE WS-EXPIRE-DT        TO DC-BIN-DATE-1
 12089        MOVE ZERO                TO DC-ELAPSED-DAYS
 12090                                    DC-ODD-DAYS-OVER
 12091          COMPUTE DC-ELAPSED-MONTHS = (WS-TERM - 1) * -1
 12092          SET BIN-PLUS-ELAPSED    TO TRUE
 12093*         MOVE 6                  TO DC-OPTION-CODE
 12094          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12095          IF NO-CONVERSION-ERROR
 12096             MOVE DC-BIN-DATE-2    TO PB-I-1ST-PMT-DT.
 12097
 12098******************************************************************
 12099*                                                                *
 12100*            1ST PAYMENT DATE PROCESSING                         *
 12101*                                                                *
 12102******************************************************************
 12103
 12104     IF PB-1ST-PMT-DT-PROCESSING
 12105        MOVE LOW-VALUE           TO PB-I-LF-EXPIRE-DT
 12106                                    PB-I-AH-EXPIRE-DT
 12107        MOVE ZEROS               TO PB-I-EXTENTION-DAYS.
 12108
 12109     IF  PB-I-1ST-PMT-DT GREATER THAN PB-CERT-EFF-DT
 12110         NEXT SENTENCE
 12111     ELSE
 12112         MOVE ER-2680                 TO WS-ERROR
 12113         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12114         GO TO 3060-ORIG-TERM-CHECK.
 12115
 12116     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12117     MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-2.
 12118     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12119*    MOVE 1                      TO DC-OPTION-CODE.
 12120     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 12121                                    DC-ELAPSED-DAYS
 12122                                    DC-ODD-DAYS-OVER.
 12123
 12124     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12125
 12126     IF DATE-CONVERSION-ERROR
 12127        GO TO 3060-ORIG-TERM-CHECK.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 222
* EL050.cbl
 12128
 12129     MOVE DC-ELAPSED-DAYS        TO WS-DAYS-TO-1ST-PMT
 12130     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 12131        AND (WS-LF-COVERAGE-TYPE = 'L')
 12132        IF (DC-ELAPSED-MONTHS > 1)
 12133                      OR
 12134           ((DC-ELAPSED-MONTHS = 1)
 12135           AND (DC-ODD-DAYS-OVER > 0))
 12136           MOVE ER-2882          TO WS-ERROR
 12137           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12138        END-IF
 12139     END-IF
 12140     if dc-elapsed-months > 0
 12141        compute ws-days-to-1st-pmt = (dc-elapsed-months * 30)
 12142        + dc-odd-days-over
 12143     end-if
 12144     IF PB-EXT-DAYS-PROCESSING
 12145        CONTINUE
 12146     ELSE
 12147        IF DC-ELAPSED-MONTHS = +0
 12148           MOVE DC-ELAPSED-DAYS  TO WS-DAYS-TO-1ST-PMT
 12149        ELSE
 12150           IF (WS-LF-EARNINGS-CALC = '4')
 12151              AND (DC-ELAPSED-MONTHS > ZERO)
 12152              AND (DC-ELAPSED-DAYS > ZERO)
 12153              COMPUTE PB-I-EXTENTION-DAYS = DC-ELAPSED-DAYS - 30
 12154           ELSE
 12155              PERFORM 6400-COMPUTE-EXTENSION-DAYS
 12156                                 THRU 6499-EXIT
 12157              MOVE WS-ODD-DAYS-OVER
 12158                                 TO PB-I-EXTENTION-DAYS
 12159           END-IF
 12160        END-IF
 12161     END-IF
 12162******************************************************************
 12163*                                                                *
 12164*            FIND THE DIFFERENCE BETWEEN 1ST PAYMENT AND         *
 12165*            EFFECTIVE DATE AND COMPARE TO THE MAX DAYS.         *
 12166*            ADJUST MAX DAYS TO ALLOW FOR THE FIRST MONTH        *
 12167*            AND ANY ODD DAYS.                                   *
 12168*                                                                *
 12169******************************************************************
 12170
 12171     COMPUTE DC-ELAPSED-DAYS = DC-ELAPSED-DAYS -
 12172                              (EC-ST-FST-PMT-DAYS-MAX + 32)
 12173     IF WS-LF-EARNINGS-CALC NOT = '4'
 12174        IF DC-ELAPSED-DAYS > ZEROS
 12175           MOVE ER-2681          TO WS-ERROR
 12176           PERFORM 9900-ERROR-FORMAT
 12177                                 THRU 9900-EXIT
 12178        END-IF
 12179     END-IF
 12180
 12181     IF WS-LF-EARNINGS-CALC NOT = '4'
 12182        IF PB-I-EXTENTION-DAYS GREATER EC-ST-FST-PMT-DAYS-MAX
 12183           MOVE ER-2681          TO WS-ERROR
 12184           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12185
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 223
* EL050.cbl
 12186     IF (PB-I-LF-EXPIRE-DT = LOW-VALUE) AND
 12187        (PB-I-LF-TERM NOT = ZERO) AND
 12188         NOT NO-LIFE-COVERAGE
 12189          MOVE PB-I-1ST-PMT-DT   TO DC-BIN-DATE-1
 12190          COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM - +1
 12191          IF WS-LF-EARNINGS-CALC = '4'
 12192             COMPUTE DC-ELAPSED-MONTHS = PB-I-LF-TERM -
 12193             PB-I-PAY-FREQUENCY
 12194          END-IF
 12195          MOVE ZERO              TO DC-ELAPSED-DAYS
 12196                                    DC-ODD-DAYS-OVER
 12197          MOVE 1                 TO DC-END-OF-MONTH
 12198          SET BIN-PLUS-ELAPSED        TO TRUE
 12199*         MOVE 6                 TO DC-OPTION-CODE
 12200          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12201          IF NO-CONVERSION-ERROR
 12202             MOVE DC-BIN-DATE-2       TO PB-I-LF-EXPIRE-DT
 12203             IF (WS-LF-EARNINGS-CALC = 'B') AND
 12204                (WS-LF-SPECIAL-CALC-CD = 'L')
 12205                  MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-1
 12206                  MOVE ZERO           TO DC-ELAPSED-DAYS
 12207                  MOVE +1             TO DC-ELAPSED-MONTHS
 12208                  SET BIN-PLUS-ELAPSED  TO TRUE
 12209*                 MOVE 6              TO DC-OPTION-CODE
 12210                  PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12211                  IF NO-CONVERSION-ERROR
 12212                     MOVE DC-BIN-DATE-2 TO PB-I-LF-EXPIRE-DT.
 12213
 12214* okay, i had to move the new att age edit down here because the
 12215* expiration date could get recalculated and i need the exp date
 12216     IF (EC-AM-LF-MAX-ATT-AGE NUMERIC)
 12217        AND (EC-AM-LF-MAX-ATT-AGE > +0)
 12218        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 12219        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12220           AND ZEROS
 12221           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12222           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12223           SET ELAPSED-BETWEEN-BIN TO TRUE
 12224           PERFORM 8500-DATE-CONVERT
 12225                                 THRU 8500-EXIT
 12226           IF NO-CONVERSION-ERROR
 12227              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12228                 MOVE ER-2669       TO WS-ERROR
 12229*                PERFORM 9900-ERROR-FORMAT
 12230*                                THRU 9900-EXIT
 12231              END-IF
 12232           END-IF
 12233        ELSE
 12234           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 12235           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12236              MOVE ER-2669       TO WS-ERROR
 12237*             PERFORM 9900-ERROR-FORMAT
 12238*                                THRU 9900-EXIT
 12239           ELSE
 12240              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12241                 MOVE ER-1570    TO WS-ERROR
 12242                 PERFORM 9900-ERROR-FORMAT
 12243                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 224
* EL050.cbl
 12244              END-IF
 12245           END-IF
 12246        END-IF
 12247        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12248           AND ZEROS
 12249           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12250           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 12251           SET ELAPSED-BETWEEN-BIN TO TRUE
 12252           PERFORM 8500-DATE-CONVERT
 12253                                 THRU 8500-EXIT
 12254           IF NO-CONVERSION-ERROR
 12255              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-LF-MAX-ATT-AGE
 12256                 MOVE ER-2669       TO WS-ERROR
 12257*                PERFORM 9900-ERROR-FORMAT
 12258*                                THRU 9900-EXIT
 12259              END-IF
 12260           END-IF
 12261        ELSE
 12262           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12263             (PB-I-LF-TERM / 12)
 12264           IF WS-ATT-AGE >= EC-AM-LF-MAX-ATT-AGE
 12265              MOVE ER-2669       TO WS-ERROR
 12266*             PERFORM 9900-ERROR-FORMAT
 12267*                                THRU 9900-EXIT
 12268           ELSE
 12269              IF (WS-ATT-AGE + 1) >= EC-AM-LF-MAX-ATT-AGE
 12270                 MOVE ER-1571    TO WS-ERROR
 12271                 PERFORM 9900-ERROR-FORMAT
 12272                                 THRU 9900-EXIT
 12273              END-IF
 12274           END-IF
 12275        END-IF
 12276        IF WS-ERROR = ER-2669
 12277           PERFORM 9900-ERROR-FORMAT
 12278                                 THRU 9900-EXIT
 12279        END-IF
 12280     END-IF
 12281     IF (PB-I-AH-EXPIRE-DT = LOW-VALUE) AND
 12282        (PB-I-AH-TERM NOT = ZERO) AND
 12283         NOT NO-AH-COVERAGE
 12284          IF (PB-I-AH-BENEFIT-CD = '55' OR '56')
 12285             AND (PB-COMPANY-ID = 'DCC')
 12286             MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
 12287             MOVE PB-I-AH-TERM        TO DC-ELAPSED-MONTHS
 12288          ELSE
 12289             IF WS-LF-EARNINGS-CALC = '4'
 12290                MOVE PB-I-1ST-PMT-DT  TO DC-BIN-DATE-1
 12291                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM -
 12292                PB-I-PAY-FREQUENCY
 12293             ELSE
 12294                MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 12295                COMPUTE DC-ELAPSED-MONTHS = PB-I-AH-TERM - +1
 12296             END-IF
 12297          END-IF
 12298          MOVE ZERO                   TO DC-ELAPSED-DAYS
 12299                                         DC-ODD-DAYS-OVER
 12300          MOVE 1                      TO DC-END-OF-MONTH
 12301          SET BIN-PLUS-ELAPSED        TO TRUE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 225
* EL050.cbl
 12302*         MOVE 6                      TO DC-OPTION-CODE
 12303          PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12304          IF NO-CONVERSION-ERROR
 12305             MOVE DC-BIN-DATE-2       TO PB-I-AH-EXPIRE-DT.
 12306     IF (EC-AM-AH-MAX-ATT-AGE NUMERIC)
 12307        AND (EC-AM-AH-MAX-ATT-AGE > +0)
 12308        AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 12309        IF PB-I-BIRTHDAY > LOW-VALUES
 12310           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 12311           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12312           SET ELAPSED-BETWEEN-BIN TO TRUE
 12313           PERFORM 8500-DATE-CONVERT
 12314                                 THRU 8500-EXIT
 12315           IF NO-CONVERSION-ERROR
 12316              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12317                 MOVE ER-3054       TO WS-ERROR
 12318*                PERFORM 9900-ERROR-FORMAT
 12319*                                THRU 9900-EXIT
 12320              END-IF
 12321           END-IF
 12322        ELSE
 12323           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 12324           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12325              MOVE ER-3054       TO WS-ERROR
 12326*             PERFORM 9900-ERROR-FORMAT
 12327*                                THRU 9900-EXIT
 12328           END-IF
 12329        END-IF
 12330        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 12331           AND ZEROS
 12332           MOVE PB-I-JOINT-BIRTHDAY    TO DC-BIN-DATE-1
 12333           MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 12334           SET ELAPSED-BETWEEN-BIN TO TRUE
 12335           PERFORM 8500-DATE-CONVERT
 12336                                 THRU 8500-EXIT
 12337           IF NO-CONVERSION-ERROR
 12338              IF (DC-ELAPSED-MONTHS / +12) >= EC-AM-AH-MAX-ATT-AGE
 12339                 MOVE ER-3054       TO WS-ERROR
 12340*                PERFORM 9900-ERROR-FORMAT
 12341*                                THRU 9900-EXIT
 12342              END-IF
 12343           END-IF
 12344        ELSE
 12345           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 12346             (PB-I-AH-TERM / 12)
 12347           IF WS-ATT-AGE >= EC-AM-AH-MAX-ATT-AGE
 12348              MOVE ER-3054       TO WS-ERROR
 12349*             PERFORM 9900-ERROR-FORMAT
 12350*                                THRU 9900-EXIT
 12351           END-IF
 12352        END-IF
 12353        IF WS-ERROR = ER-3054
 12354           PERFORM 9900-ERROR-FORMAT
 12355                                 THRU 9900-EXIT
 12356        END-IF
 12357     END-IF
 12358     MOVE SPACE                       TO DC-END-OF-MONTH.
 12359
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 226
* EL050.cbl
 12360     IF PB-COMPANY-ID = 'NCB'
 12361        GO TO 3040-EDIT-EXTENSION-DAYS.
 12362
 12363     IF PB-I-AH-EXPIRE-DT NOT EQUAL LOW-VALUES
 12364       AND
 12365        PB-I-LF-EXPIRE-DT NOT EQUAL LOW-VALUES
 12366        NEXT SENTENCE
 12367     ELSE
 12368        GO TO 3040-EDIT-EXTENSION-DAYS.
 12369
 12370     IF PB-I-LF-EXPIRE-DT LESS THAN PB-I-AH-EXPIRE-DT
 12371        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 12372        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-2
 12373     ELSE
 12374        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 12375        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-2.
 12376
 12377     SET ELAPSED-BETWEEN-BIN TO TRUE.
 12378*    MOVE '1'      TO DC-OPTION-CODE
 12379     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 12380     IF (NO-CONVERSION-ERROR)
 12381        AND (DC-ELAPSED-MONTHS > +1)
 12382        AND (WS-AH-BEN-CATEGORY NOT = 'D')
 12383        MOVE ER-2668   TO WS-ERROR
 12384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12385
 12386 3040-EDIT-EXTENSION-DAYS.
 12387
 12388     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 12389        AND (PB-COMPANY-ID NOT EQUAL 'CSL')
 12390         GO TO 3050-EDIT-TERM-IN-DAYS
 12391     ELSE
 12392         MOVE ZEROS             TO PB-I-TERM-IN-DAYS.
 12393
 12394     IF PB-I-EXTENTION-DAYS NOT NUMERIC
 12395         MOVE ZEROS             TO PB-I-EXTENTION-DAYS
 12396     ELSE
 12397        IF (PB-I-EXTENTION-DAYS > EC-ST-FST-PMT-DAYS-MAX)
 12398           AND (WS-LF-EARNINGS-CALC NOT = '4')
 12399           MOVE ER-2681         TO WS-ERROR
 12400           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12401
 12402     IF PB-I-EXTENTION-DAYS NOT = ZERO  OR
 12403        (PB-I-LF-EXPIRE-DT = LOW-VALUES) AND
 12404        (PB-I-AH-EXPIRE-DT = LOW-VALUES)
 12405         GO TO 3060-ORIG-TERM-CHECK.
 12406
 12407     GO TO 3060-ORIG-TERM-CHECK.
 12408
 12409 3050-EDIT-TERM-IN-DAYS.
 12410
 12411     MOVE ZEROS                  TO PB-I-EXTENTION-DAYS.
 12412
 12413     IF PB-I-TERM-IN-DAYS NOT NUMERIC
 12414         MOVE ZEROS              TO PB-I-TERM-IN-DAYS
 12415     ELSE
 12416         IF PB-I-TERM-IN-DAYS NOT GREATER THAN ZERO
 12417            MOVE ER-2682         TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 227
* EL050.cbl
 12418            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12419
 12420     DIVIDE +31 INTO PB-I-TERM-IN-DAYS GIVING PB-I-LF-TERM
 12421                                       REMAINDER WS-WORK-TERM.
 12422     IF WS-WORK-TERM GREATER THAN ZERO
 12423         ADD +1 TO PB-I-LF-TERM.
 12424
 12425     IF NOT NO-AH-COVERAGE
 12426         MOVE ER-2684            TO WS-ERROR
 12427         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12428
 12429
 12430 3060-ORIG-TERM-CHECK.
 12431
 12432******************************************************************
 12433*    TERM IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12434******************************************************************
 12435
 12436     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12437        NEXT SENTENCE
 12438     ELSE
 12439        IF NOT NO-LIFE-COVERAGE
 12440           IF PB-I-LF-TERM NUMERIC
 12441              AND (PB-I-LF-TERM GREATER THAN ZERO)
 12442              AND (PB-I-LF-TERM NOT GREATER THAN WS-MAX-TERM)
 12443              AND (PB-I-LF-TERM NOT GREATER THAN +360)
 12444                  NEXT SENTENCE
 12445           ELSE
 12446              MOVE ER-2647       TO WS-ERROR
 12447              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12448
 12449     IF NOT NO-AH-COVERAGE
 12450         IF PB-I-AH-TERM NUMERIC
 12451            AND (PB-I-AH-TERM GREATER THAN ZERO)
 12452            AND (PB-I-AH-TERM NOT GREATER THAN WS-MAX-TERM)
 12453            AND (PB-I-AH-TERM NOT GREATER THAN +360)
 12454             NEXT SENTENCE
 12455          ELSE
 12456              MOVE ER-2658       TO WS-ERROR
 12457              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12458
 12459     IF PB-COMPANY-ID = 'NCB'
 12460        GO TO 3070-LOAN-TERM-CHECK.
 12461
 12462     IF POLICY-HAS-AH
 12463       AND
 12464        POLICY-HAS-LIFE
 12465       AND
 12466        PB-I-LF-TERM NUMERIC
 12467       AND
 12468        PB-I-AH-TERM NUMERIC
 12469        NEXT SENTENCE
 12470     ELSE
 12471        GO TO 3070-LOAN-TERM-CHECK.
 12472
 12473     COMPUTE WS-TEX-FACT-2 EQUAL (PB-I-AH-TERM - PB-I-LF-TERM).
 12474     IF WS-TEX-FACT-2 LESS THAN +0
 12475        MULTIPLY +1 BY WS-TEX-FACT-2.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 228
* EL050.cbl
 12476
 12477     IF WS-TEX-FACT-2 GREATER THAN +1
 12478        MOVE ER-2668             TO WS-ERROR
 12479        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12480
 12481 3070-LOAN-TERM-CHECK.
 12482
 12483     IF (WS-LF-BENEFIT-CD = ZERO)
 12484         OR (NO-LF-BENEFIT-MATCH)
 12485            GO TO 3125-EDIT-PMT-FREQ.
 12486*    IF PB-COMPANY-ID NOT = 'DCC'
 12487*       IF WS-LF-SPECIAL-CALC-CD NOT  = 'T' AND 'U'
 12488*          AND 'V' AND 'W' AND 'X'
 12489*          GO TO 3125-EDIT-PMT-FREQ
 12490*       END-IF
 12491*    ELSE
 12492*       IF WS-AH-DCC-TRUNC = 'T'
 12493*          CONTINUE
 12494*       ELSE
 12495*          GO TO 3125-EDIT-PMT-FREQ
 12496*       END-IF
 12497*    END-IF
 12498     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12499                    OR
 12500        ((PB-COMPANY-ID = 'DCC')
 12501        AND (WS-AH-DCC-TRUNC = 'T'))
 12502        CONTINUE
 12503     ELSE
 12504        GO TO 3125-EDIT-PMT-FREQ
 12505     END-IF
 12506     IF PB-I-LOAN-TERM NOT NUMERIC
 12507         MOVE ZEROS              TO PB-I-LOAN-TERM.
 12508
 12509     IF PB-I-LOAN-TERM GREATER THAN ZERO             AND
 12510        PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM     AND
 12511*       PB-I-LOAN-TERM NOT GREATER THAN WS-MAX-TERM  AND
 12512        PB-I-LOAN-TERM NOT GREATER THAN +360
 12513         NEXT SENTENCE
 12514     ELSE
 12515         MOVE ER-2648            TO WS-ERROR
 12516         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12517
 12518     if  PB-I-LOAN-TERM > WS-MAX-TERM
 12519        MOVE ER-3058             TO WS-ERROR
 12520        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12521     end-if
 12522
 12523     IF WS-STATE-ABBREVIATION = 'NC'
 12524        IF PB-I-LOAN-TERM > +59
 12525           CONTINUE
 12526        ELSE
 12527           MOVE ER-2792          TO WS-ERROR
 12528           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12529        END-IF
 12530     END-IF
 12531
 12532     .
 12533 3125-EDIT-PMT-FREQ.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 229
* EL050.cbl
 12534     IF (WS-LF-BENEFIT-CD = ZERO)
 12535         OR (NO-LF-BENEFIT-MATCH)
 12536            GO TO 3127-EDIT-LOAN-OFFICER.
 12537     IF (WS-LF-SPECIAL-CALC-CD = 'T' OR 'U' OR 'V' OR 'W' OR 'X')
 12538                    OR
 12539        ((PB-COMPANY-ID = 'DCC')
 12540        AND (WS-AH-DCC-TRUNC = 'T'))
 12541                    OR
 12542         (PB-COMPANY-ID = 'AHL')
 12543        CONTINUE
 12544     ELSE
 12545        IF (PB-I-LOAN-TERM > ZEROS)
 12546           AND (PB-I-LOAN-TERM NOT = PB-I-LF-TERM)
 12547           MOVE ER-1575          TO WS-ERROR
 12548           PERFORM 9900-ERROR-FORMAT
 12549                                 THRU 9900-EXIT
 12550        END-IF
 12551     END-IF
 12552     IF WS-LF-EARNINGS-CALC NOT = '4'
 12553         IF PB-I-PAY-FREQUENCY  NOT = ZEROS
 12554            MOVE ER-2653         TO WS-ERROR
 12555            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12556            GO TO 3127-EDIT-LOAN-OFFICER
 12557         ELSE
 12558            GO TO 3127-EDIT-LOAN-OFFICER.
 12559
 12560     IF PB-I-PAY-FREQUENCY = ZERO OR 1
 12561         MOVE ER-2655            TO WS-ERROR
 12562         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12563         GO TO 3127-EDIT-LOAN-OFFICER.
 12564
 12565     IF PB-I-PAY-FREQUENCY GREATER THAN PB-I-LF-TERM
 12566         MOVE ER-2654            TO WS-ERROR
 12567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12568         GO TO 3127-EDIT-LOAN-OFFICER.
 12569
 12570     DIVIDE PB-I-LF-TERM BY PB-I-PAY-FREQUENCY
 12571         GIVING WS-TEX-FACT-2
 12572             REMAINDER WS-TEX-FACT-3.
 12573
 12574*    IF WS-TEX-FACT-3 NOT = ZERO
 12575*       MOVE ER-2654             TO WS-ERROR
 12576*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12577
 12578
 12579 3127-EDIT-LOAN-OFFICER.
 12580
 12581     IF WS-EDIT-LOAN-OFC-SW = 'Y'
 12582        IF PB-I-LOAN-OFFICER = SPACES OR LOW-VALUES
 12583           MOVE ER-2690          TO WS-ERROR
 12584           PERFORM 9900-ERROR-FORMAT
 12585                                 THRU 9900-EXIT
 12586        ELSE
 12587           MOVE PB-COMPANY-CD    TO LOFC-COMP-CD
 12588           MOVE PB-SV-CARRIER    TO LOFC-CARRIER
 12589           MOVE PB-SV-GROUPING   TO LOFC-GROUPING
 12590           MOVE PB-SV-STATE      TO LOFC-STATE
 12591           MOVE PB-ACCOUNT       TO LOFC-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 230
* EL050.cbl
 12592           MOVE PB-I-LOAN-OFFICER
 12593                                 TO LOFC-CODE
 12594           PERFORM 8586-READ-LOAN-OFFICER
 12595                                 THRU 8586-EXIT
 12596           IF (NOT LOFC-MASTER-FOUND)
 12597              AND (PB-I-LOAN-OFFICER NOT = 'XXXXX' AND 'XXX')
 12598              MOVE ER-3006       TO WS-ERROR
 12599              PERFORM 9900-ERROR-FORMAT
 12600                                 THRU 9900-EXIT
 12601           END-IF
 12602        END-IF
 12603     END-IF
 12604     .
 12605 3129-EDIT-APR.
 12606
 12607     IF (WS-LF-BENEFIT-CD = ZERO)
 12608        OR (NO-LF-BENEFIT-MATCH)
 12609        IF PB-COMPANY-ID NOT = 'DCC'
 12610           GO TO 3130-EDIT-AGE
 12611*       ELSE
 12612*          IF WS-AH-BEN-CATEGORY = 'G' OR 'L'
 12613*             GO TO 3130-EDIT-AGE
 12614*          END-IF
 12615        END-IF
 12616     END-IF
 12617
 12618     IF (WS-STATE-ABBREVIATION = 'OH')
 12619         AND (PB-I-RATE-CLASS NOT = 'L ')
 12620         AND (PB-I-LF-TERM GREATER THAN 60)
 12621         AND (PB-CERT-EFF-DT GREATER WS-831031)
 12622         GO TO 3129-APR-CONT.
 12623
 12624     IF (WS-STATE-ABBREVIATION = 'RI')
 12625         AND (PB-I-LF-TERM GREATER THAN 60)
 12626         AND (PB-CERT-EFF-DT GREATER WS-831231)
 12627         GO TO 3129-APR-CONT.
 12628
 12629     IF (WS-STATE-ABBREVIATION = 'UT')
 12630         AND (PB-I-LF-TERM GREATER THAN 62)
 12631         AND (PB-CERT-EFF-DT GREATER WS-810831)
 12632         AND (PB-CERT-EFF-DT LESS WS-830901)
 12633         GO TO 3129-APR-CONT.
 12634
 12635     IF PB-COMPANY-ID = 'LAP'
 12636        IF WS-LF-EARNINGS-CALC  NOT = '5' AND '7'
 12637           IF PB-I-LOAN-APR GREATER THAN ZEROS
 12638              MOVE ER-2656         TO WS-ERROR
 12639              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12640              GO TO 3130-EDIT-AGE.
 12641
 12642     IF (WS-LF-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12643        (WS-AH-EARNINGS-CALC  NOT = '5' AND '7')  AND
 12644        (WS-LF-SPECIAL-CALC-CD NOT = 'G')
 12645        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12646        AND (WS-LF-BENEFIT-CD (1:1) NOT = 'S')
 12647        AND (WS-AH-BENEFIT-CD (1:1) NOT = 'S')
 12648         GO TO 3130-EDIT-AGE.
 12649
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 231
* EL050.cbl
 12650 3129-APR-CONT.
 12651     IF ((WS-AH-SPECIAL-CALC-CD = 'M') OR
 12652         (WS-LF-SPECIAL-CALC-CD = 'M'))
 12653         GO TO 3130-EDIT-AGE.
 12654
 12655     IF (WS-LF-BENEFIT-CD (1:1) = 'S' OR
 12656         WS-AH-BENEFIT-CD (1:1) = 'S')
 12657        AND (PB-COMPANY-ID = 'DCC')
 12658        AND (PB-I-LOAN-APR = ZERO)
 12659        MOVE ER-2657             TO WS-ERROR
 12660        PERFORM 9900-ERROR-FORMAT
 12661                                 THRU 9900-EXIT
 12662        GO TO 3130-EDIT-AGE
 12663     END-IF
 12664*    IF PB-I-LOAN-APR = ZERO
 12665*       MOVE WS-DEFAULT-APR      TO PB-I-LOAN-APR
 12666*    END-IF
 12667
 12668     if pb-i-loan-apr = +99.9999
 12669        move er-2656             to ws-error
 12670        PERFORM 9900-ERROR-FORMAT
 12671                                 THRU 9900-EXIT
 12672        GO TO 3130-EDIT-AGE
 12673     end-if
 12674*    IF PB-I-LOAN-APR = ZERO
 12675*       MOVE ER-2656             TO WS-ERROR
 12676*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12677*       GO TO 3130-EDIT-AGE.
 12678
 12679*    IF PB-I-LOAN-APR LESS +00.0001 OR GREATER +98.999
 12680     if pb-i-loan-apr not = +99.9999
 12681        IF PB-I-LOAN-APR > +30.000
 12682           MOVE ER-2657          TO WS-ERROR
 12683           PERFORM 9900-ERROR-FORMAT
 12684                                 THRU 9900-EXIT
 12685        end-if
 12686     end-if
 12687     .
 12688 3130-EDIT-AGE.
 12689
 12690******************************************************************
 12691*    ATTAINED AGE EDIT IS NOT REQUIRED FOR OUTSTANDING BUSINESS  *
 12692******************************************************************
 12693
 12694     IF NOT NO-LIFE-COVERAGE
 12695        IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12696           IF (WS-EDIT-AGE + (PB-I-LF-TERM / 12)) GREATER +99
 12697               MOVE ER-2628             TO WS-ERROR
 12698               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12699
 12700     IF NOT NO-AH-COVERAGE
 12701        IF WS-AH-SPECIAL-CALC-CD NOT = 'O'
 12702           IF (WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12)) GREATER +99
 12703               MOVE ER-2628         TO WS-ERROR
 12704               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12705
 12706 3133-SEX-CODE.
 12707     IF PB-I-INSURED-SEX = SPACE OR ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 232
* EL050.cbl
 12708         IF WS-DEFAULT-SEX = 'M'
 12709             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX
 12710          ELSE
 12711             IF WS-DEFAULT-SEX = 'F'
 12712             MOVE WS-DEFAULT-SEX TO PB-I-INSURED-SEX.
 12713
 12714     IF PB-I-INSURED-SEX = '1'
 12715         MOVE 'M' TO PB-I-INSURED-SEX.
 12716
 12717     IF PB-I-INSURED-SEX = '2'
 12718         MOVE 'F' TO PB-I-INSURED-SEX.
 12719
 12720 3134-SIG-SW-EDIT.
 12721     IF PB-I-SIG-SW = SPACE
 12722         MOVE 'N'                TO  PB-I-SIG-SW.
 12723
 12724     IF PB-COMPANY-ID = 'NCL'
 12725         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR 'Y' OR ' '
 12726             NEXT SENTENCE
 12727         ELSE
 12728             MOVE ER-1923        TO  WS-ERROR
 12729             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12730     ELSE
 12731     IF PB-COMPANY-ID = 'CRI'
 12732         IF PB-I-SIG-SW = 'S' OR 'J' OR 'N' OR ' '
 12733             NEXT SENTENCE
 12734         ELSE
 12735             MOVE ER-2606        TO  WS-ERROR
 12736             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12737     ELSE
 12738     IF PB-COMPANY-ID = 'TMS'
 12739         IF PB-I-SIG-SW = 'N' OR 'U' OR 'O'
 12740             NEXT SENTENCE
 12741         ELSE
 12742             MOVE ER-2689        TO  WS-ERROR
 12743             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12744     ELSE
 12745         IF PB-I-SIG-SW = 'Y' OR 'N'
 12746             NEXT SENTENCE
 12747         ELSE
 12748             MOVE ER-2651        TO  WS-ERROR
 12749             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12750
 12751     IF PB-COMPANY-ID = 'FLA'
 12752         IF (WS-EDIT-AGE GREATER 54  OR
 12753             WS-AH-EDIT-AGE GREATER 54)  AND
 12754            PB-I-SIG-SW = 'N'
 12755            MOVE ER-2651         TO  WS-ERROR
 12756            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12757
 12758 3135-NAME-EDIT.
 12759
 12760     IF (PB-I-JOINT-FIRST-NAME NOT = SPACES)
 12761        AND (PB-I-JOINT-FIRST-NAME (1:1) = SPACES)
 12762        PERFORM UNTIL PB-I-JOINT-FIRST-NAME (1:1) NOT = SPACES
 12763           MOVE PB-I-JOINT-FIRST-NAME (2:9)
 12764                                 TO PB-I-JOINT-FIRST-NAME
 12765        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 233
* EL050.cbl
 12766     END-IF
 12767     IF (PB-I-JOINT-LAST-NAME NOT = SPACES)
 12768        AND (PB-I-JOINT-LAST-NAME (1:1) = SPACES)
 12769        PERFORM UNTIL PB-I-JOINT-LAST-NAME (1:1) NOT = SPACES
 12770           MOVE PB-I-JOINT-LAST-NAME (2:14)
 12771                                 TO PB-I-JOINT-LAST-NAME
 12772        END-PERFORM
 12773     END-IF
 12774     IF (PB-I-INSURED-FIRST-NAME NOT = SPACES)
 12775        AND (PB-I-INSURED-FIRST-NAME (1:1) = SPACES)
 12776        PERFORM UNTIL PB-I-INSURED-FIRST-NAME (1:1) NOT = SPACES
 12777           MOVE PB-I-INSURED-FIRST-NAME (2:9)
 12778                                 TO PB-I-INSURED-FIRST-NAME
 12779        END-PERFORM
 12780     END-IF
 12781     IF (PB-I-INSURED-LAST-NAME NOT = SPACES)
 12782        AND (PB-I-INSURED-LAST-NAME (1:1) = SPACES)
 12783        PERFORM UNTIL PB-I-INSURED-LAST-NAME (1:1) NOT = SPACES
 12784           MOVE PB-I-INSURED-LAST-NAME (2:14)
 12785                                 TO PB-I-INSURED-LAST-NAME
 12786        END-PERFORM
 12787     END-IF
 12788     IF PB-I-INSURED-LAST-NAME = SPACES
 12789       AND WS-LF-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12790       AND WS-AH-SPECIAL-CALC-CD NOT = 'O' AND 'Z'
 12791           MOVE ER-2660    TO WS-ERROR
 12792           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12793
 12794 3136-EDIT-SEX.
 12795
 12796******************************************************************
 12797*    SEX CODE IS NOT REQUIRED FOR OUTSTANDING BUSINESS           *
 12798******************************************************************
 12799
 12800     IF (WS-LF-SPECIAL-CALC-CD = 'O') OR
 12801        (WS-AH-SPECIAL-CALC-CD = 'O')
 12802        NEXT SENTENCE
 12803     ELSE
 12804        IF PB-I-INSURED-SEX = 'M' OR 'F'
 12805           NEXT SENTENCE
 12806        ELSE
 12807           MOVE ER-2629            TO WS-ERROR
 12808           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12809
 12810 3137-EDIT-EFF-DATE.
 12811
 12812     IF PB-REISSUED-CERT       OR
 12813        PB-POLICY-IS-DECLINED  OR
 12814        PB-POLICY-IS-VOIDED
 12815         GO TO 3139-EDIT-COVERAGE-CODES.
 12816
 12817     MOVE SPACE                  TO WS-2671-SW
 12818                                    WS-2672-SW.
 12819
 12820     IF (PB-COMPANY-ID EQUAL 'HAN' OR 'JHL' OR 'BNE')
 12821         IF PB-CERT-EFF-DT GREATER THAN WS-CURRENT-MONTH-END
 12822             MOVE ER-2703        TO WS-ERROR
 12823             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 234
* EL050.cbl
 12824             GO TO 3139-EDIT-COVERAGE-CODES.
 12825
 12826     IF PB-CERT-EFF-DT NOT LESS THAN WS-CURRENT-MONTH-END
 12827         GO TO 3139-EDIT-COVERAGE-CODES.
 12828
 12829     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12830     MOVE WS-CURRENT-MONTH-END   TO DC-BIN-DATE-2.
 12831*    MOVE '1'                    TO DC-OPTION-CODE.
 12832     SET ELAPSED-BETWEEN-BIN     TO TRUE.
 12833     MOVE +0                     TO DC-ELAPSED-MONTHS
 12834                                    DC-ELAPSED-DAYS.
 12835     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 12836
 12837     IF DATE-CONVERSION-ERROR
 12838         GO TO 3139-EDIT-COVERAGE-CODES.
 12839
 12840     IF DC-ELAPSED-DAYS GREATER +180
 12841         MOVE ER-2672            TO WS-ERROR
 12842         MOVE 'Y'                TO WS-2672-SW
 12843         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12844     END-IF
 12845
 12846     IF WS-ERROR = ER-2671  AND
 12847        PB-COMPANY-ID  = 'LBL'
 12848        MOVE +0     TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 12849        MOVE SPACE               TO WS-2671-SW
 12850        SUBTRACT +1            FROM PB-NO-OF-ERRORS.
 12851
 12852     IF PB-ISSUE-DATE-FORCED  AND
 12853      ((WS-2671-SW NOT = SPACE) OR (WS-2672-SW NOT = SPACE))
 12854         SUBTRACT +1           FROM PB-NO-OF-ERRORS
 12855         MOVE ER-2673            TO WS-ERROR
 12856         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12857         MOVE SPACE              TO WS-2671-SW
 12858                                    WS-2672-SW.
 12859
 12860     IF DC-ELAPSED-MONTHS IS GREATER THAN +9
 12861         IF PB-ISSUE-DATE-FORCED
 12862             MOVE ER-2600          TO  WS-ERROR
 12863             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12864         ELSE
 12865             MOVE ER-2692          TO  WS-ERROR
 12866             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12867
 12868
 12869 3139-EDIT-COVERAGE-CODES.
 12870
 12871     if pb-company-id not = 'AHL'
 12872        IF (PB-I-LF-PREMIUM-AMT + PB-I-AH-PREMIUM-AMT +
 12873           PB-I-LF-ALT-PREMIUM-AMT) > 50000.00
 12874           MOVE ER-2787          TO WS-ERROR
 12875           PERFORM 9900-ERROR-FORMAT
 12876                                 THRU 9900-EXIT
 12877        END-IF
 12878     end-if
 12879     IF WS-LF-SPECIAL-CALC-CD NOT = 'O'
 12880        IF (PB-I-LF-BENEFIT-AMT + PB-I-LF-ALT-BENEFIT-AMT)
 12881                                 > 250000.00
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 235
* EL050.cbl
 12882           MOVE ER-2719          TO WS-ERROR
 12883           PERFORM 9900-ERROR-FORMAT
 12884                                 THRU 9900-EXIT
 12885        END-IF
 12886     END-IF
 12887
 12888     IF PB-POLICY-IS-DECLINED  OR
 12889        PB-POLICY-IS-VOIDED
 12890         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12891
 12892     IF (PB-I-LF-BENEFIT-CD = ZEROS  OR  SPACES)  AND
 12893        (PB-I-AH-BENEFIT-CD = ZEROS  OR  SPACES)
 12894         MOVE ER-2630                TO WS-ERROR
 12895         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12896
 12897     IF PB-I-LF-BENEFIT-CD = ZERO  AND
 12898        PB-I-LF-BENEFIT-AMT = ZERO  AND
 12899        PB-I-LF-PREMIUM-AMT = ZERO
 12900         GO TO 3140-CHECK-AH-FOR-ZERO.
 12901
 12902     IF PB-I-LF-BENEFIT-CD NOT = ZERO  AND
 12903        PB-I-LF-BENEFIT-AMT NOT = ZERO  AND
 12904        PB-I-LF-PREMIUM-AMT NOT = ZERO
 12905         GO TO 3140-CHECK-AH-FOR-ZERO.
 12906
 12907     IF (PB-I-LF-BENEFIT-CD = ZERO)
 12908        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12909        MOVE ER-2631             TO WS-ERROR
 12910        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12911     END-IF
 12912
 12913
 12914******************************************************************
 12915*    BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12916******************************************************************
 12917
 12918     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12919        NEXT SENTENCE
 12920     ELSE
 12921        IF PB-I-LF-BENEFIT-AMT = ZERO
 12922           MOVE ER-2632             TO WS-ERROR
 12923           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12924
 12925
 12926******************************************************************
 12927*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12928******************************************************************
 12929
 12930     IF WS-LF-SPECIAL-CALC-CD = 'O'
 12931        CONTINUE
 12932     ELSE
 12933        IF PB-I-LF-PREMIUM-AMT = ZERO
 12934           IF (NOT PB-COMP-LF-PREM)
 12935              AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L')
 12936              and (ws-lf-ben-category not = 'C')
 12937              MOVE ER-2633       TO WS-ERROR
 12938              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12939           END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 236
* EL050.cbl
 12940        END-IF
 12941     END-IF
 12942     .
 12943 3140-CHECK-AH-FOR-ZERO.
 12944
 12945     IF PB-I-AH-BENEFIT-CD = ZERO  AND
 12946        PB-I-AH-BENEFIT-AMT = ZERO  AND
 12947        PB-I-AH-PREMIUM-AMT = ZERO
 12948         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12949
 12950     IF PB-COMPANY-ID = 'CSL'  AND
 12951        PB-I-AH-BENEFIT-CD = ZERO  AND
 12952        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12953        PB-I-AH-PREMIUM-AMT = ZERO
 12954         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12955
 12956     IF PB-I-AH-BENEFIT-CD NOT = ZERO  AND
 12957        PB-I-AH-BENEFIT-AMT NOT = ZERO  AND
 12958        PB-I-AH-PREMIUM-AMT NOT = ZERO
 12959         GO TO 3140-EDIT-MAX-AMT-SIZES.
 12960
 12961     IF PB-I-AH-BENEFIT-CD = ZERO
 12962         MOVE ER-2634            TO WS-ERROR
 12963         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12964
 12965******************************************************************
 12966*     BENEFIT AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12967******************************************************************
 12968
 12969     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12970        NEXT SENTENCE
 12971     ELSE
 12972        IF PB-I-AH-BENEFIT-AMT = ZERO
 12973           MOVE ER-2635             TO WS-ERROR
 12974           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12975
 12976******************************************************************
 12977*    PREMIMUM AMT. IS NOT REQUIRED FOR OUTSTANDING BUSINESS
 12978******************************************************************
 12979
 12980     IF WS-AH-SPECIAL-CALC-CD = 'O'
 12981        NEXT SENTENCE
 12982     ELSE
 12983        IF PB-I-AH-PREMIUM-AMT = ZERO
 12984            IF NOT PB-COMP-AH-PREM
 12985                MOVE ER-2636    TO WS-ERROR
 12986                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12987
 12988
 12989 3140-EDIT-MAX-AMT-SIZES.
 12990* CUSTOM CODE FOR CLIENT    'DMD'
 12991     MOVE ZEROS                   TO WS-RES-STATE-TAX
 12992                                     WS-RES-MUNI-TAX
 12993                                     PB-I-STATE-TAX
 12994                                     PB-I-MUNI-TAX.
 12995
 12996     PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 12997
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 237
* EL050.cbl
 12998     IF WS-AH-SPECIAL-CALC-CD = 'O' OR 'Z'
 12999        GO TO 3150-RATE-OUTSTAND-BAL.
 13000
 13001     IF WS-LF-SPECIAL-CALC-CD = 'O' OR 'Z'
 13002        GO TO 3150-RATE-OUTSTAND-BAL.
 13003
 13004     IF WS-LF-EARNINGS-CALC EQUAL '5'
 13005        GO TO 3150-RATE-OUTSTAND-BAL.
 13006
 13007     IF (PB-COMPANY-ID EQUAL 'FIA' OR 'PLI' OR 'NCB' OR 'AFC'
 13008                             OR 'RIC')
 13009        GO TO 3150-RATE-OUTSTAND-BAL.
 13010
 13011     IF PB-COMPANY-ID EQUAL 'TMS' OR 'ACM'
 13012        IF PB-I-LOAN-APR GREATER THAN ZEROS
 13013            GO TO 3150-RATE-OUTSTAND-BAL
 13014        ELSE
 13015           IF WS-AH-EARNINGS-CALC EQUAL '5' OR '7'
 13016               GO TO 3150-RATE-OUTSTAND-BAL.
 13017
 13018     IF NOT PB-NO-MONTHS-SKIPPED
 13019        GO TO 3150-RATE-OUTSTAND-BAL.
 13020
 13021     IF PB-I-LF-TERM NOT = PB-I-AH-TERM
 13022        GO TO 3150-RATE-OUTSTAND-BAL.
 13023
 13024     IF (PB-I-LF-BENEFIT-AMT NOT = ZERO)
 13025        IF PB-I-AH-BENEFIT-AMT NOT = ZERO
 13026           COMPUTE WS-AEC-WORK-AREA EQUAL PB-I-LF-BENEFIT-AMT -
 13027             (PB-I-AH-BENEFIT-AMT * PB-I-AH-TERM)
 13028           MOVE WS-AEC-WORK-AREA TO WS-AEC-SIGNED-AREA
 13029           IF WS-AEC-SIGNED-AREA GREATER THAN PB-I-LF-TERM
 13030              MOVE ER-2693     TO WS-ERROR
 13031              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13032              GO TO 3150-RATE-OUTSTAND-BAL
 13033           ELSE
 13034              GO TO 3150-RATE-OUTSTAND-BAL.
 13035
 13036 3150-RATE-OUTSTAND-BAL.
 13037
 13038* DMD RATING TEST
 13039     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13040         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13041         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13042         MOVE ER-2687                 TO WS-ERROR
 13043         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13044         MOVE 'B'                     TO PB-I-OB-FLAG
 13045         GO TO 3260-EDIT-CONTINUE.
 13046
 13047     IF  PB-COMPANY-ID   EQUAL    'CRI'
 13048         IF  WS-ERROR    EQUAL    ER-2693
 13049             IF  WS-LF-EARNINGS-CALC   EQUAL  '5'
 13050                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13051                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13052                 MOVE  +0            TO  WS-ERROR.
 13053
 13054     IF  PB-COMPANY-ID   EQUAL    'CDL'
 13055         IF  WS-ERROR    EQUAL    ER-2693
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 238
* EL050.cbl
 13056             IF WS-STATE-ABBREVIATION EQUAL 'NC'
 13057                 MOVE  +0  TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13058                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13059                 MOVE  +0            TO  WS-ERROR.
 13060
 13061     IF PLAN-MASTER-AH-SW = 'Y'
 13062        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13063            IF  WS-ERROR    EQUAL    ER-2693
 13064              IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13065                 MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13066                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13067                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13068                 MOVE  ER-1910           TO  WS-ERROR
 13069                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13070
 13071     IF PLAN-MASTER-AH-SW = 'Y'
 13072        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13073            IF PB-I-AH-BENEFIT-AMT GREATER THAN PL-LM-MOA (SUB2)
 13074               MOVE  PL-LM-MOA (SUB2)  TO  PB-I-AH-BENEFIT-AMT
 13075               MOVE  ER-1910           TO  WS-ERROR
 13076               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 13077
 13078     IF PLAN-MASTER-AH-SW = 'Y'
 13079        IF  PB-COMPANY-ID   EQUAL    'CRI'
 13080            IF  WS-ERROR    EQUAL    ER-2693
 13081                IF  PB-I-AH-BENEFIT-AMT  =  PL-LM-MOA (SUB2)
 13082                 MOVE  +0   TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13083                 SUBTRACT  +1   FROM  PB-NO-OF-ERRORS
 13084                 MOVE  +0       TO  WS-ERROR.
 13085
 13086     IF WS-ERROR = ER-2693
 13087        IF PB-COMPANY-ID = 'JAL' AND
 13088           PB-I-AH-BENEFIT-CD = '16' OR '26' OR '34' OR '35'
 13089           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13090           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13091
 13092     IF WS-ERROR = ER-2693
 13093        IF PB-COMPANY-ID = 'NCL'  AND
 13094           PB-I-AH-BENEFIT-CD = 'OA'
 13095           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13096           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13097
 13098     IF WS-ERROR = ER-2693
 13099        IF PB-COMPANY-ID = 'CNL' AND
 13100           PB-I-LF-BENEFIT-CD = '71' OR '72'
 13101           MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13102           SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13103
 13104     IF WS-ERROR = ER-2693
 13105        IF PB-COMPANY-ID = 'HER'
 13106           IF WS-LEVEL
 13107              MOVE +0        TO PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 13108              SUBTRACT +1    FROM PB-NO-OF-ERRORS.
 13109
 13110     IF ((LF-BENEFIT-FOUND) AND
 13111         (NOT NO-LIFE-COVERAGE)  AND
 13112         (WS-LF-SPECIAL-CALC-CD = 'O'))
 13113       OR   ((AH-BENEFIT-FOUND) AND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 239
* EL050.cbl
 13114             (NOT NO-AH-COVERAGE)    AND
 13115             (WS-AH-SPECIAL-CALC-CD = 'O'))
 13116         NEXT SENTENCE
 13117     ELSE
 13118         GO TO 3215-EDIT-RATES.
 13119
 13120     IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13121        AND WS-LF-SPECIAL-CALC-CD NOT = 'O'
 13122           MOVE ER-2674          TO WS-ERROR
 13123           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13124           GO TO 3215-EDIT-RATES.
 13125
 13126     IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13127        AND WS-AH-SPECIAL-CALC-CD NOT = 'O'
 13128           MOVE ER-2674          TO WS-ERROR
 13129           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13130           GO TO 3215-EDIT-RATES.
 13131
 13132     MOVE 'B'                    TO PB-I-OB-FLAG.
 13133
 13134     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13135         NEXT SENTENCE
 13136     ELSE
 13137         IF NOT NO-LIFE-COVERAGE
 13138             IF WS-ACCT-LF-OB-RT = ZERO
 13139                MOVE ER-2641    TO WS-ERROR
 13140                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13141
 13142     IF PB-COMPANY-ID = 'CRI'
 13143       IF LF-BENEFIT-FOUND AND NOT NO-LIFE-COVERAGE
 13144         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13145         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13146         IF WS-ERROR = ER-2675
 13147            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13148            MOVE ER-2687              TO WS-ERROR
 13149            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13150         ELSE
 13151            MOVE ER-2687              TO WS-ERROR
 13152            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13153
 13154
 13155     IF PB-COMPANY-ID = 'FIA' OR 'GTL' OR 'NCL'
 13156         NEXT SENTENCE
 13157     ELSE
 13158       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 13159            NEXT SENTENCE
 13160       ELSE
 13161         IF NOT NO-AH-COVERAGE
 13162             IF WS-ACCT-AH-OB-RT = ZERO
 13163                MOVE ER-2642    TO WS-ERROR
 13164                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13165
 13166     IF PB-COMPANY-ID = 'CRI'
 13167       IF AH-BENEFIT-FOUND AND NOT NO-AH-COVERAGE
 13168         MOVE PB-I-AH-PREMIUM-AMT     TO PB-I-AH-PREM-CALC
 13169         IF WS-ERROR = ER-2676
 13170            SUBTRACT +1               FROM PB-NO-OF-ERRORS
 13171            MOVE ER-2687              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 240
* EL050.cbl
 13172            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13173         ELSE
 13174            MOVE ER-2687              TO WS-ERROR
 13175            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13176
 13177     IF PB-COMPANY-ID NOT = 'GIC'
 13178         COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13179            (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000
 13180     ELSE
 13181         IF PB-I-LF-PREM-CALC = ZEROS
 13182             COMPUTE PB-I-LF-PREM-CALC ROUNDED =
 13183                (WS-ACCT-LF-OB-RT * PB-I-LF-BENEFIT-AMT) / 1000.
 13184
 13185     IF PB-COMPANY-ID NOT = 'GIC'
 13186         COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13187            (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000
 13188     ELSE
 13189         IF PB-I-AH-PREM-CALC = ZEROS
 13190             COMPUTE PB-I-AH-PREM-CALC ROUNDED =
 13191                (WS-ACCT-AH-OB-RT * PB-I-AH-BENEFIT-AMT) / 1000.
 13192
 13193     MOVE ZEROS TO PB-I-MORT-CODE.
 13194
 13195     GO TO 3260-EDIT-CONTINUE.
 13196
 13197
 13198 3215-EDIT-RATES.
 13199     IF ACCOUNT-MAST-FOUND
 13200         NEXT SENTENCE
 13201     ELSE
 13202         GO TO 3999-END-EDIT.
 13203
 13204 3220-CHECK-LF-RATES.
 13205
 13206     IF PB-COMPANY-ID = 'DCC'
 13207        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 13208        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 13209        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13210           AND (NOT WS-LF-CASH))
 13211                           OR
 13212           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 13213           AND (NOT WS-AH-CASH)))
 13214                       AND
 13215           (PB-I-ENTRY-STATUS NOT = '5')
 13216           MOVE 'M'              TO PB-BATCH-ENTRY
 13217                                    PB-I-ENTRY-STATUS
 13218        END-IF
 13219     END-IF
 13220     MOVE ZEROS                  TO PB-I-LF-PREM-CALC
 13221                                    PB-I-AH-PREM-CALC
 13222                                    PB-I-LF-ALT-PREM-CALC
 13223                                    PB-I-LF-ALT-RATE
 13224                                    PB-I-LF-REI-RATE
 13225                                    PB-I-LF-ALT-REI-RATE
 13226                                    PB-I-AH-REI-RATE
 13227                                    PB-I-TOT-FEES-CALC.
 13228
 13229     IF PB-COMPANY-ID EQUAL 'DMD'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 241
* EL050.cbl
 13230        NEXT SENTENCE
 13231     ELSE
 13232        MOVE ZEROS               TO PB-I-LF-RATE
 13233                                    PB-I-AH-RATE.
 13234
 13235     IF PB-I-TOT-FEES NOT NUMERIC
 13236        MOVE ZEROS               TO PB-I-TOT-FEES
 13237     END-IF
 13238     IF PB-I-LIVES NOT NUMERIC
 13239         MOVE ZERO               TO PB-I-LIVES.
 13240
 13241     IF PB-I-NUM-BILLED NOT NUMERIC
 13242         MOVE ZERO               TO PB-I-NUM-BILLED.
 13243
 13244     IF PB-I-LF-PREM-TAX NOT NUMERIC
 13245        MOVE +0                  TO PB-I-LF-PREM-TAX
 13246     END-IF
 13247
 13248     IF PB-I-AH-PREM-TAX NOT NUMERIC
 13249        MOVE +0                  TO PB-I-AH-PREM-TAX
 13250     END-IF
 13251
 13252     IF PB-I-PAY-FREQUENCY NOT NUMERIC OR
 13253        PB-I-PAY-FREQUENCY = ZEROS
 13254            MOVE 12 TO CP-PAY-FREQUENCY
 13255     ELSE
 13256            MOVE PB-I-PAY-FREQUENCY TO CP-PAY-FREQUENCY.
 13257
 13258     IF PB-I-STATE-TAX NOT NUMERIC
 13259         MOVE ZEROS               TO PB-I-STATE-TAX.
 13260
 13261     IF PB-I-MUNI-TAX NOT NUMERIC
 13262         MOVE ZEROS               TO PB-I-MUNI-TAX.
 13263
 13264     MOVE SPACES                 TO CP-BEN-CATEGORY
 13265     IF PB-COMPANY-ID  = 'CSL'  AND
 13266        PB-I-LF-TERM NOT = ZERO
 13267        COMPUTE WS-PAYMENT-AMT =
 13268             PB-I-LF-BENEFIT-AMT / PB-I-LF-TERM
 13269        COMPUTE WS-CSL-AMT1 =
 13270             PB-I-LF-TERM * AM-MAX-MON-BEN
 13271        COMPUTE WS-CSL-AMT2 =
 13272             WS-PAYMENT-AMT * PB-I-LF-TERM
 13273        IF CP-PAY-FREQUENCY NOT = 12
 13274           MOVE PB-I-LF-BENEFIT-AMT    TO WS-PAYMENT-AMT
 13275           MOVE '8' TO WS-CSL-CALC-CD
 13276        ELSE
 13277           IF WS-PAYMENT-AMT GREATER THAN AM-MAX-MON-BEN AND
 13278              (PB-I-LF-TERM * AM-MAX-MON-BEN) NOT GREATER THAN
 13279               AM-MAX-TOT-BEN
 13280               MOVE '6' TO WS-CSL-CALC-CD
 13281           ELSE
 13282              IF (WS-CSL-AMT1  GREATER THAN
 13283                 AM-MAX-TOT-BEN) AND
 13284                 (WS-CSL-AMT2  GREATER THAN
 13285                 AM-MAX-TOT-BEN)
 13286                 MOVE '7' TO WS-CSL-CALC-CD
 13287              ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 242
* EL050.cbl
 13288                 MOVE '5' TO WS-CSL-CALC-CD.
 13289
 13290     IF NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND
 13291         NEXT SENTENCE
 13292     ELSE
 13293         GO TO 3300-CHECK-AH-RATES.
 13294
 13295*****     CODE FOR CRITICAL PERIOD LIFE COVERAGE.    *****
 13296
 13297     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13298        IF (PB-I-LF-CRIT-PER    EQUAL +0)
 13299              OR
 13300           (PB-I-PAYMENT-AMOUNT EQUAL +0)
 13301           MOVE ER-2618          TO WS-ERROR
 13302           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13303           GO TO 3300-CHECK-AH-RATES.
 13304
 13305     IF WS-LF-SPECIAL-CALC-CD EQUAL 'C'
 13306           COMPUTE PB-I-LF-BENEFIT-AMT    EQUAL
 13307                   PB-I-PAYMENT-AMOUNT * PB-I-LF-CRIT-PER.
 13308
 13309     IF WS-LF-SPECIAL-CALC-CD = 'M'
 13310         MOVE ER-2687             TO WS-ERROR
 13311         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13312         MOVE 'Z000'              TO PB-I-MORT-CODE
 13313         MOVE PB-I-LF-PREMIUM-AMT TO PB-I-LF-PREM-CALC
 13314         GO TO 3300-CHECK-AH-RATES.
 13315
 13316     IF WS-LF-SPECIAL-CALC-CD = 'Z'
 13317        IF PB-I-LIVES = ZERO
 13318           MOVE ER-2688          TO WS-ERROR
 13319           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13320
 13321     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 13322
 13323     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 13324     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 13325     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 13326     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 13327     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 13328     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 13329     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 13330     MOVE '3'                    TO CP-PROCESS-TYPE.
 13331     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 13332     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 13333
 13334******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13335     IF PB-COMPANY-ID EQUAL 'CDL'
 13336         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13337            CP-EARN-AS-NET-PAY)
 13338             IF PB-CERT-EFF-DT GREATER  WS-931231
 13339                 MOVE '1'        TO CP-EARNING-METHOD.
 13340*******
 13341
 13342     MOVE PB-SV-STATE            TO CP-STATE.
 13343     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 13344     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 13345     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 243
* EL050.cbl
 13346     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13347     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 13348                                    CP-RATING-BENEFIT-AMT.
 13349     IF CP-STATE-STD-ABBRV = 'OR'
 13350         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13351                                         PB-I-LF-ALT-BENEFIT-AMT.
 13352     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 13353     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 13354     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 13355     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 13356     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 13357     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 13358     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 13359     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 13360     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13361                                    CP-REMAINING-TERM
 13362                                    CP-LOAN-TERM.
 13363
 13364     IF PB-COMPANY-ID IS EQUAL TO 'UCL' OR 'CDL' OR 'CSL' OR 'NCB'
 13365         NEXT SENTENCE
 13366     ELSE
 13367         IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 13368             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13369                                           PB-I-LF-PREMIUM-AMT.
 13370
 13371     IF PB-COMPANY-ID EQUAL 'CSL'
 13372        IF (CP-RATE-AS-STANDARD) AND (CP-CSL-VALID-NP-BENEFIT-CD)
 13373           COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13374                                         PB-I-LF-PREMIUM-AMT.
 13375
 13376     IF PB-COMPANY-ID EQUAL 'NCB'
 13377         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13378            CP-EARN-AS-NET-PAY
 13379             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13380                 PB-I-LF-PREMIUM-AMT.
 13381
 13382     IF (CP-TRUNCATED-LIFE)
 13383        or ((pb-company-id = 'AHL')
 13384           and (pb-i-loan-term > pb-i-lf-term))
 13385        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 13386
 13387     IF PB-COMPANY-ID EQUAL 'CRI'
 13388        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 13389
 13390     IF CP-TERM-IS-DAYS
 13391         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 13392     ELSE
 13393         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13394     IF PB-COMPANY-ID = 'DCC'
 13395        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13396        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 13397        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 13398        IF WS-LF-BEN-CATEGORY = 'D'
 13399           MOVE WS-LF-PMF-COMM   TO CP-DCC-PMF-COMM
 13400           MOVE PB-I-LIFE-COMMISSION
 13401                                 TO CP-DCC-ACT-COMM
 13402           MOVE WS-LF-BEN-CATEGORY
 13403                                 TO CP-BEN-CATEGORY
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 244
* EL050.cbl
 13404        END-IF
 13405        IF (CP-BENEFIT-CD (1:1) = 'P')
 13406           AND (PB-I-LOAN-TERM NOT = ZEROS)
 13407           MOVE PB-I-LOAN-TERM   TO CP-LOAN-TERM
 13408           add pb-i-ah-premium-amt to cp-original-premium
 13409        END-IF
 13410     END-IF
 13411     IF PB-COMPANY-ID = 'CSL'
 13412         MOVE WS-PAYMENT-AMT        TO CP-REMAINING-BENEFIT
 13413         MOVE WS-LF-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 13414         MOVE WS-CSL-CALC-CD        TO CP-SPECIAL-CALC-CD.
 13415
 13416     IF PB-COMPANY-ID = 'CSL'
 13417        MOVE PB-I-AH-BENEFIT-AMT TO CP-MONTHLY-PAYMENT.
 13418
 13419     IF (CP-SPECIAL-CALC-CD = 'H')
 13420        OR (PB-COMPANY-ID = 'DCC')
 13421         MOVE PB-I-LF-ALT-BENEFIT-AMT
 13422                                    TO CP-ALTERNATE-BENEFIT
 13423         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 13424     if (pb-company-id = 'CID')
 13425        and (ws-lf-earnings-calc = '4')
 13426        and (cp-state-std-abbrv = 'MN' OR 'WA')
 13427        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13428        move pb-i-term-type      to cp-pmt-mode
 13429        move pb-i-no-of-payments to cp-no-of-pmts
 13430     end-if
 13431     move ws-net-only-state      to cp-net-only-state
 13432     IF (PB-COMPANY-ID = 'CID')
 13433        AND (WS-LF-EARNINGS-CALC = 'B')
 13434        AND (CP-STATE-STD-ABBRV = 'MN')
 13435        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13436                                 TO CP-ALTERNATE-BENEFIT
 13437        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13438     END-IF
 13439     IF (PB-COMPANY-ID = 'CID')
 13440        AND (WS-LF-EARNINGS-CALC = 'B')
 13441        MOVE PB-I-LF-ALT-BENEFIT-AMT
 13442                                 TO CP-ALTERNATE-BENEFIT
 13443        MOVE PB-I-LF-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13444        move ws-days-to-1st-pmt  to cp-days-to-1st-pmt
 13445*       compute cp-original-benefit = pb-i-lf-benefit-amt -
 13446*         pb-i-lf-alt-premium-amt
 13447        MOVE WS-LF-BEN-CATEGORY  TO CP-BEN-CATEGORY
 13448        IF WS-LF-BEN-CATEGORY = 'P'
 13449           MOVE WS-EXTRA-PMTS    TO CP-EXTRA-PERIODS
 13450        ELSE
 13451           IF WS-LF-BEN-CATEGORY = 'I'
 13452              MOVE WS-INT-PERIODS TO CP-EXTRA-PERIODS
 13453           END-IF
 13454        END-IF
 13455     END-IF
 13456     MOVE PB-I-LF-EXPIRE-DT     TO CP-EXPIRE-DT
 13457     MOVE 'R'                   TO CP-RATE-FILE.
 13458     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13459
 13460     IF CP-ERROR-RATE-NOT-FOUND
 13461        MOVE ER-2641            TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 245
* EL050.cbl
 13462        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13463        GO TO 3300-CHECK-AH-RATES.
 13464
 13465     IF PB-COMPANY-ID EQUAL 'CRI'
 13466        IF CP-ERROR-NO-LIMITS-CRI
 13467           IF NOT ACCOUNT-LIFE-CHECKED
 13468              MOVE ER-2607      TO WS-ERROR
 13469              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13470
 13471******************************************************************
 13472*    BYPASS EDITING FOR SUMMARY PROCESSING - SPECIAL CALC. 'Z'.  *
 13473*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13474******************************************************************
 13475
 13476* CALC LIFE AGE AT EXPIRATION.
 13477
 13478     COMPUTE WS-AGE-AT-EXPIRE =
 13479          ((PB-I-LF-TERM / 12) + PB-I-AGE).
 13480
 13481*    IF PB-STATE = 'CO' OR 'UT'
 13482*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13483*        MOVE 'F'            TO PB-FATAL-FLAG
 13484*        MOVE ER-2709        TO WS-ERROR
 13485*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13486*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13487
 13488*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13489*        MOVE 'X'            TO PB-FATAL-FLAG
 13490*        MOVE ER-2718        TO WS-ERROR
 13491*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13492*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13493
 13494* CALC A & H AGE AT EXPIRATION.
 13495
 13496     COMPUTE WS-AGE-AT-EXPIRE =
 13497          ((PB-I-AH-TERM / 12) + PB-I-AGE).
 13498
 13499*    IF PB-STATE = 'CO' OR 'UT'
 13500*      IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13501*        MOVE 'F'            TO PB-FATAL-FLAG
 13502*        MOVE ER-2709        TO WS-ERROR
 13503*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13504*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13505
 13506*    IF WS-AGE-AT-EXPIRE  GREATER THAN  71
 13507*        MOVE 'X'            TO PB-FATAL-FLAG
 13508*        MOVE ER-2718        TO WS-ERROR
 13509*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13510*        GO TO PREMIUM-EDITING-IS-BYPASSED.
 13511
 13512     IF ACCOUNT-LIFE-CHECKED  OR PB-POLICY-IS-VOIDED
 13513        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13514
 13515     IF (WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13516        and (not pb-monthly-cert)
 13517        GO TO 3221-CHECK-ERROR-RATE-OPEN
 13518     end-if
 13519
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 246
* EL050.cbl
 13520     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13521        GO TO 3221-CHECK-ERROR-RATE-OPEN.
 13522
 13523     IF CP-ERROR-AMT-OUTSIDE-LIMIT
 13524         MOVE 'Y'            TO WS-OUTSIDE-AMT-LIMITS
 13525         MOVE ER-2639        TO WS-ERROR
 13526         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13527
 13528
 13529******************************************************************
 13530*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13531******************************************************************
 13532
 13533 PREMIUM-EDITING-IS-BYPASSED.
 13534     IF (CP-R-MAX-ATT-AGE NUMERIC)
 13535        AND (CP-R-MAX-ATT-AGE > +0)
 13536        AND (PB-I-LF-EXPIRE-DT NOT = LOW-VALUES)
 13537        IF PB-I-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13538           MOVE PB-I-BIRTHDAY    TO DC-BIN-DATE-1
 13539           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13540           MOVE '1'              TO DC-OPTION-CODE
 13541           PERFORM 8500-DATE-CONVERT
 13542                                 THRU 8500-EXIT
 13543           IF NO-CONVERSION-ERROR
 13544              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13545                 MOVE ER-2661       TO WS-ERROR
 13546*                PERFORM 9900-ERROR-FORMAT
 13547*                                THRU 9900-EXIT
 13548              END-IF
 13549           END-IF
 13550        ELSE
 13551           COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-LF-TERM / 12)
 13552           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13553              MOVE ER-2661       TO WS-ERROR
 13554*             PERFORM 9900-ERROR-FORMAT
 13555*                                THRU 9900-EXIT
 13556           ELSE
 13557              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13558                 MOVE ER-1570    TO WS-ERROR
 13559                 PERFORM 9900-ERROR-FORMAT
 13560                                 THRU 9900-EXIT
 13561              END-IF
 13562           END-IF
 13563        END-IF
 13564        IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 13565           MOVE PB-I-JOINT-BIRTHDAY
 13566                                 TO DC-BIN-DATE-1
 13567           MOVE PB-I-LF-EXPIRE-DT TO DC-BIN-DATE-2
 13568           MOVE '1'              TO DC-OPTION-CODE
 13569           PERFORM 8500-DATE-CONVERT
 13570                                 THRU 8500-EXIT
 13571           IF NO-CONVERSION-ERROR
 13572              IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 13573                 MOVE ER-2661       TO WS-ERROR
 13574*                PERFORM 9900-ERROR-FORMAT
 13575*                                THRU 9900-EXIT
 13576              END-IF
 13577           ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 247
* EL050.cbl
 13578              DISPLAY ' JNT AGE ERROR ' DC-ERROR-CODE
 13579           END-IF
 13580        ELSE
 13581           COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 13582             (PB-I-LF-TERM / 12)
 13583           IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 13584              MOVE ER-2661       TO WS-ERROR
 13585*             PERFORM 9900-ERROR-FORMAT
 13586*                                THRU 9900-EXIT
 13587           ELSE
 13588              IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 13589                 MOVE ER-1571    TO WS-ERROR
 13590                 PERFORM 9900-ERROR-FORMAT
 13591                                 THRU 9900-EXIT
 13592              END-IF
 13593           END-IF
 13594        END-IF
 13595        IF WS-ERROR = ER-2661
 13596           PERFORM 9900-ERROR-FORMAT
 13597                                 THRU 9900-EXIT
 13598        END-IF
 13599     END-IF
 13600*    IF CP-ERROR-ATT-OUTSIDE-LIMIT
 13601*       MOVE ER-2661             TO WS-ERROR
 13602*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13603
 13604     IF CP-ERROR-AGE-OUTSIDE-LIMIT
 13605        MOVE ER-2662             TO WS-ERROR
 13606        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13607
 13608     IF CP-ERROR-TERM-OUTSIDE-LIMIT
 13609        MOVE ER-2677             TO WS-ERROR
 13610        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13611
 13612     IF CP-ERROR-LOAN-TERM
 13613        MOVE ER-2648             TO WS-ERROR
 13614        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13615
 13616 3221-CHECK-ERROR-RATE-OPEN.
 13617
 13618     IF CP-ERROR-RATE-FILE-NOTOPEN
 13619         GO TO 3990-FILES-NOT-OPEN.
 13620
 13621     IF PB-COMPANY-ID NOT = 'DMD'
 13622        MOVE CP-PREMIUM-RATE       TO PB-I-LF-RATE
 13623     END-IF
 13624     .
 13625 3221-CONTINUE.
 13626     MOVE ZEROS                  TO WS-DCC-LF-RATE
 13627                                    WS-DCC-AH-RATE
 13628     IF PB-COMPANY-ID = 'DCC'
 13629        IF WS-LF-BEN-CATEGORY = 'D'
 13630           COMPUTE PB-I-LF-CLP ROUNDED = PB-I-LF-PREMIUM-AMT *
 13631              (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 13632        END-IF
 13633     END-IF
 13634     MOVE CP-CALC-PREMIUM        TO PB-I-LF-PREM-CALC.
 13635*   X'A4FF' = 12/31/2009
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 248
* EL050.cbl
 13636     IF (PB-COMPANY-ID = 'CID')
 13637        AND (WS-LF-EARNINGS-CALC = 'B')
 13638        AND (CP-STATE-STD-ABBRV = 'MN')
 13639        AND (PB-CERT-EFF-DT > X'A4FF')
 13640        MOVE CP-LF-BALLOON-PREM  TO PB-I-LF-ALT-PREM-CALC
 13641     END-IF
 13642     MOVE CP-POLICY-FEE          TO PB-I-LF-POLICY-FEE.
 13643
 13644     MOVE CP-PREMIUM-RATE        TO EC-RT-LF-RATE.
 13645     IF (PB-COMPANY-ID = 'DCC')
 13646        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13647        AND (PB-I-POLICY-IS-MONTHLY)
 13648        MOVE CP-PREMIUM-RATE     TO WS-DCC-LF-RATE
 13649        MOVE PB-I-LF-PREM-CALC   TO PB-I-TOT-FEES-CALC
 13650     END-IF
 13651     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-LF-MAX-ATT-AGE.
 13652     MOVE CP-R-MAX-AGE           TO EC-RT-LF-MAX-AGE.
 13653     MOVE CP-R-MAX-TERM          TO EC-RT-LF-MAX-TERM.
 13654     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-LF-MAX-TOT-BEN.
 13655     IF (PB-COMPANY-ID = 'DCC')
 13656        AND (PB-I-LF-BENEFIT-CD NOT = '  ' AND '00')
 13657        AND (WS-LF-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 13658        AND (PB-I-RATE-DEV-PCT-LF = +0 OR +1)
 13659        MOVE ER-2786             TO WS-ERROR
 13660        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13661     END-IF
 13662
 13663     MOVE CP-MORTALITY-CODE      TO PB-I-MORT-CODE.
 13664
 13665******************************************************************
 13666*    PREMIUM EDITING IS BYPASSED           - SPECIAL CALC. 'E'.  *
 13667******************************************************************
 13668     IF (WS-LF-SPECIAL-CALC-CD = 'E')
 13669        and ((not pb-monthly-cert)
 13670        or (ws-lf-ben-category = 'C'))
 13671        GO TO 3225-CHECK-ALT-LIFE-RATE.
 13672
 13673     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13674        GO TO 3225-CHECK-ALT-LIFE-RATE
 13675     ELSE
 13676       IF PB-I-LF-RATE = ZERO
 13677          MOVE ER-2641          TO WS-ERROR
 13678          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13679
 13680 3225-CHECK-ALT-LIFE-RATE.
 13681
 13682     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13683        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13684        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13685         GO TO 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13686
 13687     IF (WS-LF-EARNINGS-CALC NOT = 'B')
 13688         IF (PB-I-LF-ALT-BENEFIT-AMT > +0
 13689             AND PB-COMPANY-ID NOT = 'DCC')
 13690                   OR
 13691              (PB-I-LF-ALT-PREMIUM-AMT > +0
 13692              AND WS-LF-SPECIAL-CALC-CD NOT = 'H'
 13693              AND PB-COMPANY-ID NOT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 249
* EL050.cbl
 13694             MOVE ER-2720        TO  WS-ERROR
 13695             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13696             GO TO 3225-RATING-CONT
 13697         ELSE
 13698             GO TO 3225-RATING-CONT.
 13699     IF (PB-COMPANY-ID = 'CID' OR 'AHL')
 13700        AND (AM-GPCD = 01 OR 06 OR 15)
 13701        MOVE ER-2798             TO WS-ERROR
 13702        PERFORM 9900-ERROR-FORMAT
 13703                                 THRU 9900-EXIT
 13704*       GO TO 3225-RATING-CONT
 13705     END-IF
 13706     if (pb-company-id = 'CID')
 13707        and (ws-lf-earnings-calc = 'B')
 13708        and (ws-lf-ben-category = 'P' or 'I')
 13709        and (ws-net-only-state = 'Y')
 13710        move cp-lf-balloon-prem  to pb-i-lf-alt-prem-calc
 13711        display ' balloon prem ' pb-i-lf-alt-prem-calc
 13712        go to 3225-rating-cont
 13713     end-if
 13714     IF (PB-COMPANY-ID = 'CID')
 13715        AND (WS-LF-EARNINGS-CALC = 'B')
 13716        AND (CP-STATE-STD-ABBRV = 'MN')
 13717        AND (PB-CERT-EFF-DT > X'A4FF')
 13718        GO TO 3225-RATING-CONT
 13719     END-IF
 13720     IF PB-COMPANY-ID = 'DCC'
 13721        IF (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 13722           AND (PB-I-POLICY-IS-MONTHLY)
 13723           GO TO 3225-RATING-CONT
 13724        END-IF
 13725     END-IF
 13726
 13727     IF PB-COMPANY-ID EQUAL 'WDS' AND
 13728        (WS-STATE-ABBREVIATION EQUAL 'MN' OR 'NC') AND
 13729        CP-EARN-AS-REG-BALLOON
 13730        NEXT SENTENCE
 13731     ELSE
 13732        MOVE '2'                 TO CP-EARNING-METHOD.
 13733
 13734 3225-SET-ALT-LIFE-RATE-LOOKUP.
 13735
 13736     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 13737
 13738     IF (PB-COMPANY-ID EQUAL 'GTL') AND
 13739        (WS-STATE-ABBREVIATION EQUAL 'PA') AND
 13740        (CP-SPECIAL-CALC-CD EQUAL 'H')
 13741         NEXT SENTENCE
 13742     ELSE
 13743         MOVE SPACE              TO CP-SPECIAL-CALC-CD.
 13744
 13745     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 13746     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 13747     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 13748                                     CP-RATING-BENEFIT-AMT.
 13749     IF CP-STATE-STD-ABBRV = 'OR'
 13750         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13751                                         PB-I-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 250
* EL050.cbl
 13752     IF PB-COMPANY-ID = 'DCC'
 13753        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13754     END-IF
 13755     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 13756     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 13757     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 13758                                    CP-REMAINING-TERM
 13759                                    CP-LOAN-TERM.
 13760     IF WS-LF-SPECIAL-CALC-CD = 'L'
 13761        ADD +1                   TO CP-ORIGINAL-TERM
 13762                                    CP-REMAINING-TERM
 13763                                    CP-LOAN-TERM.
 13764
 13765     MOVE 'R'                   TO CP-RATE-FILE.
 13766     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13767
 13768     IF CP-ERROR-RATE-NOT-FOUND
 13769         MOVE ER-2641            TO WS-ERROR
 13770         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13771         GO TO 3300-CHECK-AH-RATES.
 13772
 13773     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-RATE.
 13774     MOVE CP-CALC-PREMIUM        TO PB-I-LF-ALT-PREM-CALC.
 13775
 13776     IF CP-R-MAX-TOT-BEN  GREATER THAN  EC-RT-LF-MAX-TOT-BEN
 13777         MOVE CP-R-MAX-TOT-BEN   TO EC-RT-LF-MAX-TOT-BEN.
 13778
 13779     COMPUTE WS-LF-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT
 13780                               + PB-I-LF-ALT-BENEFIT-AMT.
 13781
 13782     IF ACCOUNT-LIFE-CHECKED  OR
 13783        PB-POLICY-IS-VOIDED   OR
 13784        ((WS-LF-SPECIAL-CALC-CD = 'E'  OR  'Z')
 13785        and (not pb-monthly-cert))
 13786        GO TO 3225-CONTINUE.
 13787
 13788     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13789        GO TO 3225-CONTINUE.
 13790
 13791     IF WS-LF-BENEFIT-AMT  GREATER THAN
 13792                             EC-RT-LF-MAX-TOT-BEN
 13793        MOVE 'Y'           TO WS-OUTSIDE-AMT-LIMITS
 13794        MOVE ER-2639       TO WS-ERROR
 13795        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13796
 13797 3225-CONTINUE.
 13798     IF PB-I-LF-ALT-RATE = ZERO
 13799         MOVE ER-2659            TO WS-ERROR
 13800         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13801
 13802     IF PB-I-LF-ALT-BENEFIT-AMT = ZERO OR
 13803        PB-I-LF-ALT-PREMIUM-AMT = ZERO
 13804        MOVE ER-2698             TO WS-ERROR
 13805        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13806
 13807 3225-RATING-CONT.
 13808
 13809     IF (WS-LF-SPECIAL-CALC-CD = 'E')
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 251
* EL050.cbl
 13810        and (not pb-monthly-cert)
 13811         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13812         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13813         IF (PB-COMPANY-ID = 'DCC')
 13814            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 13815            CONTINUE
 13816         ELSE
 13817            MOVE ER-2687         TO WS-ERROR
 13818            PERFORM 9900-ERROR-FORMAT
 13819                                 THRU 9900-EXIT
 13820         END-IF
 13821         GO TO 3290-EDIT-LF-REIN-RATE
 13822     END-IF
 13823
 13824* DMD RATING TEST
 13825     IF (CF-COMPANY-ID = 'DMD') AND NO-DMD-RATING
 13826         MOVE PB-I-LF-PREMIUM-AMT     TO PB-I-LF-PREM-CALC
 13827         MOVE PB-I-LF-ALT-PREMIUM-AMT TO PB-I-LF-ALT-PREM-CALC
 13828         MOVE ER-2687                 TO WS-ERROR
 13829         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13830         GO TO 3290-EDIT-LF-REIN-RATE.
 13831
 13832 3230-CLIENT-MORT-CD-SPECIALS.
 13833
 13834     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 13835     SET BIN-TO-GREG          TO TRUE.
 13836*    MOVE ' '                 TO DC-OPTION-CODE.
 13837     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 13838     MOVE DC-GREG-DATE-1-YMD  TO WS-WORK-DATE.
 13839
 13840 C-POS-3230-MORT-CD.
 13841     IF PB-COMPANY-ID = 'POS' AND
 13842        PB-SV-CARRIER = '2'
 13843         NEXT SENTENCE
 13844     ELSE
 13845         GO TO C-POS-3240-MORT-CD.
 13846
 13847     IF PB-SV-GROUPING = '030'
 13848        AND PB-CERT-EFF-DT GREATER THAN WS-791231
 13849         MOVE '2350' TO PB-I-MORT-CODE
 13850      ELSE
 13851         MOVE '3300' TO PB-I-MORT-CODE.
 13852
 13853
 13854 C-POS-3240-MORT-CD.
 13855     IF PB-COMPANY-ID = 'POS' AND
 13856        PB-SV-CARRIER = '1'
 13857         NEXT SENTENCE
 13858     ELSE
 13859         GO TO 3230-CONTINUE.
 13860
 13861     IF PB-SV-STATE = '45' OR '47'
 13862        OR PB-CERT-EFF-DT LESS THAN WS-771001
 13863         MOVE '5200' TO PB-I-MORT-CODE
 13864     ELSE
 13865         MOVE '8300' TO PB-I-MORT-CODE.
 13866
 13867 3230-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 252
* EL050.cbl
 13868
 13869     IF PB-COMPANY-ID IS NOT EQUAL TO 'CID'
 13870        GO TO 3240-CONTINUE
 13871     END-IF
 13872
 13873     IF PB-CERT-EFF-DT > WS-971231
 13874        GO TO 3240-CONTINUE
 13875     END-IF
 13876
 13877     IF LF-BENEFIT-FOUND AND
 13878        WS-LF-JOINT-INDICATOR IS EQUAL TO 'J'
 13879         MOVE 'F250'       TO PB-I-MORT-CODE
 13880     ELSE
 13881         IF PB-I-INDV-GRP-CD IS EQUAL TO 'I'
 13882             MOVE '7250'   TO PB-I-MORT-CODE
 13883         ELSE
 13884             MOVE '4251'   TO PB-I-MORT-CODE
 13885         END-IF
 13886     END-IF
 13887
 13888     .
 13889 3240-CONTINUE.
 13890
 13891     IF PB-COMPANY-ID NOT = 'GNL'
 13892         GO TO 3256-CONTINUE.
 13893
 13894     IF PB-CERT-EFF-DT  LESS THAN WS-820301
 13895         MOVE 'A300' TO PB-I-MORT-CODE
 13896     ELSE
 13897         MOVE '8350' TO PB-I-MORT-CODE.
 13898
 13899 3256-CONTINUE.
 13900     IF PB-COMPANY-ID NOT = 'ABL'
 13901         GO TO 3260-EDIT-CONTINUE.
 13902
 13903     IF PB-I-LF-TERM GREATER THAN 59
 13904         MOVE 'F550' TO PB-I-MORT-CODE
 13905     ELSE
 13906         MOVE 'E550' TO PB-I-MORT-CODE.
 13907
 13908 3260-EDIT-CONTINUE.
 13909     MOVE PB-I-LF-RATE TO PB-I-LF-REI-RATE.
 13910
 13911 3290-EDIT-LF-REIN-RATE.
 13912     IF LF-REIN-NSP-NOT-USED
 13913         GO TO 3290-RATING-CONT.
 13914
 13915     IF PB-COMPANY-ID = 'DCC'
 13916        GO TO 3290-RATING-CONT.
 13917     MOVE PB-LIFE-OVERRIDE-L1   TO CP-LIFE-OVERRIDE-CODE.
 13918     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 13919     MOVE WS-LF-COVERAGE-TYPE   TO CP-BENEFIT-TYPE.
 13920     MOVE '3'                   TO CP-PROCESS-TYPE.
 13921     MOVE WS-LF-EARNINGS-CALC   TO CP-EARNING-METHOD.
 13922
 13923******** SPECIAL CODE FOR CDL AND STATE OF NORTH CAROLINA..
 13924     IF PB-COMPANY-ID EQUAL 'CDL'
 13925         IF (WS-STATE-ABBREVIATION EQUAL 'NC' AND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 253
* EL050.cbl
 13926            CP-EARN-AS-NET-PAY)
 13927             MOVE PB-CERT-EFF-DT TO DC-BIN-DATE-1
 13928*            MOVE SPACE          TO DC-OPTION-CODE
 13929             SET BIN-TO-GREG     TO TRUE
 13930             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 13931***  Y2K PROJ 7744
 13932             IF DC-GREG-DATE-CYMD GREATER 19931231
 13933                 MOVE '1'        TO CP-EARNING-METHOD.
 13934***  Y2K PROJ 7744
 13935*******
 13936
 13937     MOVE WS-LF-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 13938     MOVE PB-SV-STATE           TO CP-STATE.
 13939     MOVE PB-I-RATE-CLASS       TO CP-CLASS-CODE.
 13940     MOVE ZERO                  TO CP-DEVIATION-CODE
 13941                                   CP-RATE-DEV-PCT.
 13942     MOVE PB-I-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 13943     MOVE PB-I-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 13944                                   CP-RATING-BENEFIT-AMT.
 13945
 13946************ SPECIAL CODE FOR NCB AND STATE OF NORTH CAROLINA
 13947     IF PB-COMPANY-ID EQUAL 'NCB'
 13948         IF WS-STATE-ABBREVIATION EQUAL 'NC' AND
 13949            CP-EARN-AS-NET-PAY
 13950             COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 13951                 PB-I-LF-PREMIUM-AMT.
 13952************
 13953
 13954     IF CP-STATE-STD-ABBRV = 'OR'
 13955         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 13956                                         PB-I-LF-ALT-BENEFIT-AMT.
 13957     MOVE PB-I-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 13958     MOVE WS-EDIT-AGE           TO CP-ISSUE-AGE.
 13959     MOVE PB-CERT-EFF-DT        TO CP-CERT-EFF-DT.
 13960     MOVE PB-COMPANY-ID         TO CP-COMPANY-ID.
 13961     MOVE PB-COMPANY-CD         TO CP-COMPANY-CD.
 13962     MOVE PB-I-LOAN-APR         TO CP-LOAN-APR.
 13963     MOVE PB-I-LF-CRIT-PER      TO CP-CRITICAL-MONTHS.
 13964     MOVE PB-I-LF-TERM          TO CP-ORIGINAL-TERM
 13965                                   CP-REMAINING-TERM
 13966                                   CP-LOAN-TERM.
 13967     IF CP-TRUNCATED-LIFE
 13968        MOVE PB-I-LOAN-TERM     TO CP-LOAN-TERM.
 13969
 13970     IF CP-TERM-IS-DAYS
 13971         MOVE PB-I-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 13972     ELSE
 13973         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 13974
 13975     IF PB-COMPANY-ID = 'DCC'
 13976        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 13977     END-IF
 13978     IF PB-COMPANY-ID NOT = 'TIC'
 13979          MOVE ZERO          TO CP-CLASS-CODE.
 13980
 13981     MOVE WS-NSP-ST-CD-LF    TO CP-STATE.
 13982
 13983     MOVE 'R'                   TO CP-RATE-FILE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 254
* EL050.cbl
 13984     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 13985
 13986     IF CP-ERROR-RATE-NOT-FOUND
 13987        IF PB-I-OB
 13988           MOVE ER-2625      TO WS-ERROR
 13989           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13990           GO TO 3299-EDIT-CONTINUE
 13991        ELSE
 13992           MOVE ER-2643      TO WS-ERROR
 13993           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13994           GO TO 3299-EDIT-CONTINUE.
 13995
 13996     MOVE CP-PREMIUM-RATE    TO PB-I-LF-REI-RATE.
 13997
 13998     MOVE CP-PREMIUM-RATE    TO EC-RT-LF-NSP-RATE.
 13999     MOVE WS-NSP-ST-CD-LF    TO EC-RT-LF-NSP-ST.
 14000
 14001     IF PB-I-LF-REI-RATE = ZERO
 14002         MOVE ER-2643        TO WS-ERROR
 14003         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14004
 14005 3290-CHECK-ALT-REIN-RATE.
 14006
 14007     IF WS-LF-EARNINGS-CALC NOT = 'B'
 14008        GO TO 3290-RATING-CONT.
 14009
 14010     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 14011     MOVE '2'                    TO CP-EARNING-METHOD.
 14012     MOVE SPACE                  TO CP-SPECIAL-CALC-CD.
 14013     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 14014     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14015     MOVE PB-I-LF-ALT-BENEFIT-AMT TO CP-ORIGINAL-BENEFIT
 14016                                     CP-RATING-BENEFIT-AMT.
 14017     IF CP-STATE-STD-ABBRV = 'OR'
 14018         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14019                                         PB-I-LF-ALT-BENEFIT-AMT.
 14020     IF PB-COMPANY-ID = 'DCC'
 14021        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14022     END-IF
 14023     MOVE PB-I-LF-ALT-PREMIUM-AMT TO CP-ORIGINAL-PREMIUM.
 14024     MOVE ZERO                   TO CP-CRITICAL-MONTHS
 14025     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14026                                    CP-REMAINING-TERM
 14027                                    CP-LOAN-TERM.
 14028     IF WS-LF-SPECIAL-CALC-CD = 'L'
 14029        ADD +1                   TO CP-ORIGINAL-TERM
 14030                                    CP-REMAINING-TERM
 14031                                    CP-LOAN-TERM.
 14032
 14033     MOVE 'R'                   TO CP-RATE-FILE.
 14034     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14035
 14036     MOVE CP-PREMIUM-RATE        TO PB-I-LF-ALT-REI-RATE.
 14037
 14038     IF PB-I-LF-ALT-REI-RATE = ZERO
 14039         MOVE ER-2643            TO WS-ERROR
 14040         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14041
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 255
* EL050.cbl
 14042 3290-RATING-CONT.
 14043
 14044     IF PB-I-OB
 14045*       GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14046        GO TO 3300-CHECK-AH-RATES.
 14047
 14048 3299-EDIT-CONTINUE.
 14049
 14050     IF  PB-I-MORT-CODE GREATER THAN SPACES
 14051         NEXT SENTENCE
 14052     ELSE
 14053         MOVE ER-2620           TO WS-ERROR
 14054         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14055
 14056 3300-CHECK-AH-RATES.
 14057     IF NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND
 14058         NEXT SENTENCE
 14059     ELSE
 14060         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14061
 14062     IF ((WS-AH-SPECIAL-CALC-CD = 'E')
 14063        and (not pb-monthly-cert))
 14064                  or
 14065        ((CF-COMPANY-ID = 'DMD') AND
 14066                (NO-DMD-RATING))
 14067         IF (PB-COMPANY-ID = 'DCC')
 14068            AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14069            CONTINUE
 14070         ELSE
 14071            MOVE ER-2687         TO WS-ERROR
 14072            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14073         END-IF
 14074         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14075         GO TO 3335-EDIT-AH-REIN-NSP-RATE
 14076     END-IF
 14077
 14078     IF PB-I-OB
 14079        GO TO 3335-EDIT-AH-REIN-NSP-RATE.
 14080
 14081     IF WS-AH-SPECIAL-CALC-CD = 'M'
 14082         MOVE ER-2687             TO WS-ERROR
 14083         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14084         MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14085         GO TO 3999-END-EDIT.
 14086
 14087*****     CODE FOR CRITICAL PERIOD A & H COVERAGE.   *****
 14088     if pb-company-id = 'AHL'
 14089        go to 3300-skip-crit-per
 14090     end-if
 14091     if (pb-i-ah-crit-per not = zeros)
 14092        and (ws-ah-special-calc-cd not = 'C')
 14093        MOVE ER-1572             TO WS-ERROR
 14094        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14095        go to 3300-skip-crit-per
 14096     END-IF
 14097     if (pb-company-id = 'DCC')
 14098        and (am-dcc-product-code not = spaces)
 14099        go to 3300-skip-crit-per
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 256
* EL050.cbl
 14100     end-if
 14101     IF WS-AH-SPECIAL-CALC-CD EQUAL 'C'
 14102        IF PB-I-AH-CRIT-PER = ZERO
 14103           move ws-ah-max-bens   to pb-i-ah-crit-per
 14104*          MOVE ER-2618       TO WS-ERROR
 14105*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14106*          GO TO 3999-END-EDIT
 14107        END-IF
 14108     END-IF
 14109     if (ws-ah-special-calc-cd = 'C')
 14110        and (pb-i-ah-crit-per <> ws-ah-max-bens)
 14111        MOVE ER-1576             TO WS-ERROR
 14112        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14113     end-if
 14114
 14115     .
 14116 3300-skip-crit-per.
 14117     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14118     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14119     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14120     MOVE WS-AH-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14121     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14122     MOVE PB-SV-STATE            TO CP-STATE.
 14123     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14124     MOVE PB-I-RATE-DEVIATION-AH TO CP-DEVIATION-CODE.
 14125     MOVE PB-I-RATE-DEV-PCT-AH   TO CP-RATE-DEV-PCT.
 14126*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14127     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14128     MOVE '3'                    TO CP-PROCESS-TYPE.
 14129     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14130     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14131                                    CP-RATING-BENEFIT-AMT.
 14132     IF PB-COMPANY-ID = 'CID'
 14133               OR
 14134        CP-STATE-STD-ABBRV = 'OR'
 14135         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14136                                         PB-I-AH-TERM.
 14137     IF PB-COMPANY-ID = 'DCC' OR 'CID'
 14138        IF (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S' OR 'P')
 14139           AND (PB-I-POLICY-IS-MONTHLY)
 14140           MOVE PB-I-LF-BENEFIT-AMT
 14141                                 TO CP-NET-BENEFIT-AMT
 14142           move pb-i-ah-premium-amt to cp-original-premium
 14143           add pb-i-lf-premium-amt to cp-original-premium
 14144        END-IF
 14145     END-IF
 14146     MOVE SPACES                 TO CP-BEN-CATEGORY
 14147     IF PB-COMPANY-ID = 'DCC'
 14148        MOVE WS-AH-BEN-CATEGORY  TO CP-BEN-CATEGORY
 14149        EVALUATE TRUE
 14150           WHEN (WS-AH-BEN-CATEGORY = 'G')
 14151              AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14152              MOVE PB-I-LF-BENEFIT-AMT
 14153                                 TO CP-RATING-BENEFIT-AMT
 14154              MOVE WS-AH-DCC-TRUNC TO CP-DDF-SPEC-CALC
 14155           WHEN WS-AH-BEN-CATEGORY = 'G'
 14156              MOVE PB-I-UNPAID-CASH-PRICE
 14157                                 TO CP-RATING-BENEFIT-AMT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 257
* EL050.cbl
 14158           WHEN WS-AH-BEN-CATEGORY = 'D'
 14159              MOVE WS-AH-PMF-COMM
 14160                                 TO CP-DCC-PMF-COMM
 14161              MOVE PB-I-AH-COMMISSION
 14162                                 TO CP-DCC-ACT-COMM
 14163        END-EVALUATE
 14164     END-IF
 14165     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14166     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14167     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14168     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14169     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14170     MOVE PB-I-AH-CRIT-PER       TO CP-CRITICAL-MONTHS.
 14171     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14172                                    CP-REMAINING-TERM
 14173                                    WS-WORK-TERM.
 14174     MOVE PB-I-EXTENTION-DAYS    TO CP-TERM-OR-EXT-DAYS.
 14175
 14176     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14177     SET BIN-TO-GREG             TO TRUE.
 14178*    MOVE ' '                    TO DC-OPTION-CODE.
 14179     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 14180     MOVE DC-GREG-DATE-1-YMD     TO WS-WORK-DATE.
 14181
 14182     MOVE PB-I-SKIP-CODE         TO WS-SKIP-CODE-CHECK.
 14183     IF NOT VALID-SKIP-CODE
 14184         MOVE ER-2683            TO WS-ERROR
 14185         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14186         GO TO 3320-RATE-CONTINUE.
 14187
 14188     IF PB-NO-MONTHS-SKIPPED
 14189         GO TO 3320-RATE-CONTINUE.
 14190
 14191     MOVE SPACE TO NUMBER-OF-MONTHS.
 14192
 14193     IF PB-I-SKIP-CODE = '7' OR '8' OR '9'
 14194         MOVE 'S'                TO SK-MO (6).
 14195     IF PB-I-SKIP-CODE = '1' OR '4' OR '6' OR '7' OR '9'
 14196         MOVE 'S'                TO SK-MO (7).
 14197     IF PB-I-SKIP-CODE = '2' OR '4' OR '5' OR '6' OR '7' OR 'A'
 14198         MOVE 'S'                TO SK-MO (8).
 14199     IF PB-I-SKIP-CODE = '3' OR '5' OR '6' OR 'A'
 14200         MOVE 'S'                TO SK-MO (9).
 14201     IF PB-I-SKIP-CODE = 'A'
 14202         MOVE 'S'                TO SK-MO (10).
 14203
 14204     MOVE 1                      TO SUB2.
 14205     MOVE PB-I-AH-TERM           TO SUB3.
 14206     MOVE WS-MONTH               TO SUB1.
 14207     PERFORM 3310-GET-SKIP-MO UNTIL SUB2 GREATER THAN SUB3.
 14208     GO TO 3320-RATE-CONTINUE.
 14209
 14210 3310-GET-SKIP-MO.
 14211     IF SUB1 = 13
 14212         MOVE 1                  TO SUB1.
 14213
 14214     IF SK-MO (SUB1) = 'S'
 14215         SUBTRACT 1 FROM WS-WORK-TERM.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 258
* EL050.cbl
 14216
 14217     ADD 1 TO SUB2
 14218              SUB1.
 14219
 14220 3320-RATE-CONTINUE.
 14221
 14222     IF WS-WORK-TERM = ZERO
 14223         MOVE 1                  TO WS-WORK-TERM.
 14224
 14225     MOVE WS-WORK-TERM           TO PB-I-AH-RATE-TRM
 14226                                    CP-LOAN-TERM.
 14227
 14228     IF PB-COMPANY-ID EQUAL 'DMD'
 14229         NEXT SENTENCE
 14230     ELSE
 14231         MOVE ZERO               TO PB-I-AH-RATE
 14232                                    PB-I-AH-REI-RATE.
 14233
 14234
 14235     IF PB-COMPANY-ID EQUAL 'CRI'
 14236        MOVE PB-I-SIG-SW         TO CP-SIG-SWITCH.
 14237
 14238     IF PB-COMPANY-ID = 'CSL'
 14239         MOVE AM-MAX-MON-BEN     TO CP-R-MAX-MON-BEN
 14240         MOVE AM-MAX-TOT-BEN     TO CP-R-MAX-TOT-BEN
 14241         MOVE WS-AH-JOINT-INDICATOR TO CP-JOINT-INDICATOR
 14242         MOVE WS-CSL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14243
 14244     IF PB-COMPANY-ID = 'DCC'
 14245        IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14246           COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14247              PB-I-RATE-DEV-PCT-LF
 14248        END-IF
 14249        MOVE PB-I-LF-ALT-BENEFIT-AMT
 14250                                 TO CP-ALTERNATE-BENEFIT
 14251        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14252        MOVE PB-I-TERM-TYPE      TO CP-PMT-MODE
 14253        MOVE PB-I-NO-OF-PAYMENTS TO CP-NO-OF-PMTS
 14254     END-IF
 14255     IF (PB-COMPANY-ID = 'CID')
 14256        AND (WS-LF-EARNINGS-CALC = 'B')
 14257        AND (CP-STATE-STD-ABBRV = 'MN')
 14258        MOVE 'Y'                 TO CP-AH-BALLOON-SW
 14259     ELSE
 14260        MOVE ' '                 TO CP-AH-BALLOON-SW
 14261     END-IF
 14262     MOVE PB-I-LOAN-TERM         TO CP-LOAN-TERM
 14263     MOVE 'R'                   TO CP-RATE-FILE.
 14264     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14265
 14266     IF (CP-ERROR-RATE-NOT-FOUND)
 14267        and (not pb-monthly-cert)
 14268        IF PB-I-OB
 14269           MOVE ER-2624          TO WS-ERROR
 14270           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14271           GO TO 3340-CALCULATE-PREMIUM-AMT
 14272        ELSE
 14273          IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 259
* EL050.cbl
 14274              NEXT SENTENCE
 14275          ELSE
 14276           MOVE ER-2642          TO WS-ERROR
 14277           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14278           GO TO 3340-CALCULATE-PREMIUM-AMT.
 14279
 14280     IF PB-COMPANY-ID EQUAL 'CSL' AND
 14281        CP-ERROR-DIV-BY-ZERO
 14282           MOVE ER-3782          TO WS-ERROR
 14283           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14284
 14285     IF PB-COMPANY-ID EQUAL 'CRI'
 14286        IF CP-ERROR-NO-LIMITS-CRI
 14287           IF NOT ACCOUNT-AH-CHECKED
 14288              MOVE ER-2607          TO WS-ERROR
 14289              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14290
 14291     IF ACCOUNT-AH-CHECKED
 14292        NEXT SENTENCE
 14293     ELSE
 14294       IF CP-ERROR-AMT-OUTSIDE-LIMIT
 14295          MOVE ER-2640           TO WS-ERROR
 14296          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14297
 14298     IF PB-COMPANY-ID = 'CRI'
 14299         IF WS-ERROR = ER-2640
 14300             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14301     IF ACCOUNT-AH-CHECKED
 14302        CONTINUE
 14303     ELSE
 14304        IF (CP-R-MAX-ATT-AGE NUMERIC)
 14305           AND (CP-R-MAX-ATT-AGE > +0)
 14306           AND (PB-I-AH-EXPIRE-DT NOT = LOW-VALUES)
 14307           IF PB-I-BIRTHDAY NOT = SPACES AND LOW-VALUES AND ZEROS
 14308              MOVE PB-I-BIRTHDAY TO DC-BIN-DATE-1
 14309              MOVE PB-I-AH-EXPIRE-DT
 14310                                 TO DC-BIN-DATE-2
 14311              MOVE '1'           TO DC-OPTION-CODE
 14312              PERFORM 8500-DATE-CONVERT
 14313                                 THRU 8500-EXIT
 14314              IF NO-CONVERSION-ERROR
 14315                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14316                    MOVE ER-2661       TO WS-ERROR
 14317*                   PERFORM 9900-ERROR-FORMAT
 14318*                                THRU 9900-EXIT
 14319                 END-IF
 14320              END-IF
 14321           ELSE
 14322              COMPUTE WS-ATT-AGE = PB-I-AGE + (PB-I-AH-TERM / 12)
 14323              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14324                 MOVE ER-2661    TO WS-ERROR
 14325*                PERFORM 9900-ERROR-FORMAT
 14326*                                THRU 9900-EXIT
 14327              ELSE
 14328                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14329                    MOVE ER-1570 TO WS-ERROR
 14330                    PERFORM 9900-ERROR-FORMAT
 14331                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 260
* EL050.cbl
 14332                 END-IF
 14333              END-IF
 14334           END-IF
 14335           IF PB-I-JOINT-BIRTHDAY NOT = LOW-VALUES AND SPACES
 14336              MOVE PB-I-JOINT-BIRTHDAY
 14337                                    TO DC-BIN-DATE-1
 14338              MOVE PB-I-AH-EXPIRE-DT TO DC-BIN-DATE-2
 14339              MOVE '1'              TO DC-OPTION-CODE
 14340              PERFORM 8500-DATE-CONVERT
 14341                                    THRU 8500-EXIT
 14342              IF NO-CONVERSION-ERROR
 14343                 IF (DC-ELAPSED-MONTHS / 12) >= CP-R-MAX-ATT-AGE
 14344                    MOVE ER-2661       TO WS-ERROR
 14345*                   PERFORM 9900-ERROR-FORMAT
 14346*                                   THRU 9900-EXIT
 14347                 END-IF
 14348              END-IF
 14349           ELSE
 14350              COMPUTE WS-ATT-AGE = PB-I-JOINT-AGE +
 14351                (PB-I-AH-TERM / 12)
 14352              IF WS-ATT-AGE >= CP-R-MAX-ATT-AGE
 14353                 MOVE ER-2661       TO WS-ERROR
 14354*                PERFORM 9900-ERROR-FORMAT
 14355*                                   THRU 9900-EXIT
 14356              ELSE
 14357                 IF (WS-ATT-AGE + 1) >= CP-R-MAX-ATT-AGE
 14358                    MOVE ER-1571 TO WS-ERROR
 14359                    PERFORM 9900-ERROR-FORMAT
 14360                                 THRU 9900-EXIT
 14361                 END-IF
 14362              END-IF
 14363           END-IF
 14364           IF WS-ERROR = ER-2661
 14365              PERFORM 9900-ERROR-FORMAT
 14366                                    THRU 9900-EXIT
 14367           END-IF
 14368        END-IF
 14369     END-IF
 14370*    IF ACCOUNT-AH-CHECKED
 14371*       NEXT SENTENCE
 14372*    ELSE
 14373*       IF CP-ERROR-ATT-OUTSIDE-LIMIT
 14374*          MOVE ER-2661          TO WS-ERROR
 14375*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14376
 14377     IF ACCOUNT-AH-CHECKED
 14378        NEXT SENTENCE
 14379     ELSE
 14380        IF CP-ERROR-AGE-OUTSIDE-LIMIT
 14381           MOVE ER-2663          TO WS-ERROR
 14382           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14383
 14384     IF ACCOUNT-AH-CHECKED OR
 14385        (WS-AH-SPECIAL-CALC-CD = 'Z') OR
 14386         PB-POLICY-IS-VOIDED
 14387        NEXT SENTENCE
 14388     ELSE
 14389        IF CP-ERROR-TOT-OUTSIDE-LIMIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 261
* EL050.cbl
 14390           MOVE ER-2667            TO WS-ERROR
 14391           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14392
 14393     IF PB-COMPANY-ID = 'CRI'
 14394         IF WS-ERROR = ER-2667
 14395             MOVE ZERO           TO PB-I-NO-OF-PAYMENTS.
 14396
 14397     IF ACCOUNT-AH-CHECKED
 14398        NEXT SENTENCE
 14399     ELSE
 14400        IF CP-ERROR-TERM-OUTSIDE-LIMIT
 14401           MOVE ER-2678            TO WS-ERROR
 14402           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14403
 14404     IF CP-ERROR-RATE-FILE-NOTOPEN
 14405         GO TO 3990-FILES-NOT-OPEN.
 14406
 14407 3321-CONTINUE.
 14408     MOVE CP-PREMIUM-RATE        TO PB-I-AH-RATE.
 14409     MOVE CP-CALC-PREMIUM        TO PB-I-AH-PREM-CALC.
 14410     IF (PB-COMPANY-ID = 'DCC')
 14411        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 14412        MOVE CP-CALC-PREMIUM     TO PB-I-CLP-AMOUNT
 14413                                    PB-I-LF-ALT-PREM-CALC
 14414        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14415        IF WS-AH-BEN-CATEGORY = 'G'
 14416           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14417           + PB-I-ADDL-CLP)
 14418           * (1 + WS-TOL-CLP-PCT)
 14419*          * (1 + WS-TOL-CLP-PCT) - WS-ACCT-I-CLP
 14420        ELSE
 14421           COMPUTE WS-TOL-LF-HIGH-PREM-AMT = (PB-I-CLP-AMOUNT
 14422           + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM
 14423*          + PB-I-ADDL-CLP) + WS-SPP-LEASE-COMM - WS-ACCT-I-CLP
 14424        END-IF
 14425        MOVE WS-TOL-LF-HIGH-PREM-AMT
 14426                                 TO PB-I-AH-PREM-CALC
 14427        IF PB-I-AH-PREMIUM-AMT > WS-TOL-LF-HIGH-PREM-AMT
 14428           MOVE ER-8152          TO WS-ERROR
 14429           PERFORM 9900-ERROR-FORMAT
 14430                                 THRU 9900-EXIT
 14431        ELSE
 14432           IF PB-I-AH-PREMIUM-AMT < (PB-I-CLP-AMOUNT +
 14433                 PB-I-ADDL-CLP)
 14434              MOVE ER-8148       TO WS-ERROR
 14435              PERFORM 9900-ERROR-FORMAT
 14436                                 THRU 9900-EXIT
 14437           END-IF
 14438        END-IF
 14439     END-IF
 14440     IF (PB-COMPANY-ID = 'DCC')
 14441        AND (PB-I-POLICY-IS-MONTHLY)
 14442        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14443        MOVE CP-PREMIUM-RATE     TO WS-DCC-AH-RATE
 14444        IF PB-I-LF-BENEFIT-CD (1:1) NOT = 'N' AND 'S'
 14445           MOVE PB-I-AH-PREM-CALC TO PB-I-TOT-FEES-CALC
 14446        END-IF
 14447     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 262
* EL050.cbl
 14448     IF (PB-COMPANY-ID = 'DCC')
 14449        AND (PB-I-AH-BENEFIT-CD NOT = '  ' AND '00')
 14450        AND (WS-AH-BEN-CATEGORY NOT = 'G' AND 'L' AND 'D')
 14451        AND (PB-I-RATE-DEV-PCT-AH = +0 OR +1)
 14452        MOVE ER-2786             TO WS-ERROR
 14453        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14454     END-IF
 14455     MOVE +0                     TO PB-I-AH-CLP
 14456     IF PB-COMPANY-ID = 'DCC'
 14457        evaluate true
 14458           when WS-AH-BEN-CATEGORY = 'D'
 14459              COMPUTE PB-I-AH-CLP ROUNDED = PB-I-AH-PREMIUM-AMT
 14460                * (1 - CP-DCC-ACT-COMM) / (1 + CP-DCC-PMF-COMM)
 14461           when WS-AH-BEN-CATEGORY = 'G' OR 'L'
 14462              MOVE PB-I-CLP-AMOUNT TO PB-I-AH-CLP
 14463           when WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14464              compute ws-cred-union-fees rounded =
 14465                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14466                    pb-i-ah-commission)
 14467              COMPUTE PB-I-AH-CLP =
 14468                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14469        end-evaluate
 14470     END-IF
 14471     MOVE CP-POLICY-FEE          TO PB-I-AH-POLICY-FEE.
 14472
 14473     IF PB-I-NO-OF-PAYMENTS NOT NUMERIC
 14474         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
 14475
 14476     IF PB-I-PAYMENT-AMOUNT NOT NUMERIC
 14477         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 14478
 14479     if (ws-ah-special-calc-cd = 'E')
 14480        and (pb-monthly-cert)
 14481        MOVE PB-I-AH-PREMIUM-AMT TO PB-I-AH-PREM-CALC
 14482     end-if
 14483     IF PB-COMPANY-ID = 'CRI'
 14484         IF PB-I-NO-OF-PAYMENTS = ZERO  OR
 14485            PB-I-PAYMENT-AMOUNT = ZERO
 14486             NEXT SENTENCE
 14487         ELSE
 14488             COMPUTE PB-I-AH-PREM-CALC =
 14489                 (PB-I-PAYMENT-AMOUNT * PB-I-NO-OF-PAYMENTS) *
 14490                 (CP-PREMIUM-RATE / 100)
 14491             IF PB-I-RATE-DEV-PCT-AH NOT = ZERO
 14492                 COMPUTE PB-I-AH-PREM-CALC = PB-I-AH-PREM-CALC *
 14493                                             PB-I-RATE-DEV-PCT-AH.
 14494
 14495     IF (PB-I-AH-RATE  = ZERO)
 14496        and (not pb-monthly-cert)
 14497       IF PB-COMPANY-ID = 'AHL' AND PB-BATCH-ENTRY = 'E'
 14498           NEXT SENTENCE
 14499       ELSE
 14500         MOVE ER-2642            TO WS-ERROR
 14501         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14502
 14503     MOVE CP-PREMIUM-RATE        TO EC-RT-AH-RATE.
 14504     MOVE CP-R-MAX-ATT-AGE       TO EC-RT-AH-MAX-ATT-AGE.
 14505     MOVE CP-R-MAX-AGE           TO EC-RT-AH-MAX-AGE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 263
* EL050.cbl
 14506     MOVE CP-R-MAX-TERM          TO EC-RT-AH-MAX-TERM.
 14507     MOVE CP-R-MAX-TOT-BEN       TO EC-RT-AH-MAX-TOT-BEN.
 14508     MOVE CP-R-MAX-MON-BEN       TO EC-RT-AH-MAX-MON-BEN.
 14509
 14510     IF (PB-COMPANY-ID = 'DCC')
 14511        AND (WS-AH-BEN-CATEGORY = 'G')
 14512        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 14513        MOVE +0                  TO PB-I-DDF-IU-RATE-UP
 14514        IF CP-DEVIATION-CODE NOT = '000'
 14515           MOVE '000'            TO CP-DEVIATION-CODE
 14516           PERFORM 7000-GET-RATE THRU 7000-EXIT
 14517           IF NO-CP-ERROR
 14518              COMPUTE PB-I-DDF-IU-RATE-UP =
 14519              PB-I-AH-CLP - CP-CALC-PREMIUM
 14520           ELSE
 14521              MOVE ER-3057        TO WS-ERROR
 14522              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14523           END-IF
 14524        END-IF
 14525     END-IF
 14526     .
 14527 3335-EDIT-AH-REIN-NSP-RATE.
 14528     IF PB-COMPANY-ID = 'DCC'
 14529        if WS-AH-BEN-CATEGORY = 'C'   *> Credit Union
 14530              compute ws-cred-union-fees rounded =
 14531                 ws-cred-union-fees + (pb-i-ah-premium-amt *
 14532                    pb-i-ah-commission)
 14533              COMPUTE PB-I-AH-CLP =
 14534                 PB-I-AH-PREMIUM-AMT - ws-cred-union-fees
 14535        end-if
 14536     END-IF
 14537     IF AH-REIN-NSP-NOT-USED
 14538         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14539
 14540     MOVE PB-I-AH-RATE TO PB-I-AH-REI-RATE.
 14541     IF PB-COMPANY-ID = 'DCC'
 14542         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14543     MOVE WS-STATE-ABBREVIATION TO CP-STATE-STD-ABBRV.
 14544     MOVE WS-AH-EARNINGS-CALC   TO CP-EARNING-METHOD.
 14545     MOVE WS-AH-SPECIAL-CALC-CD TO CP-SPECIAL-CALC-CD.
 14546     MOVE PB-SV-STATE            TO CP-STATE.
 14547     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14548     MOVE ZERO                   TO CP-DEVIATION-CODE
 14549                                    CP-RATE-DEV-PCT.
 14550*    MOVE 'A'                    TO CP-BENEFIT-TYPE.
 14551     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 14552     MOVE '3'                    TO CP-PROCESS-TYPE.
 14553     MOVE PB-I-AH-BENEFIT-CD     TO CP-BENEFIT-CD.
 14554     MOVE PB-I-AH-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14555                                    CP-RATING-BENEFIT-AMT.
 14556     IF CP-STATE-STD-ABBRV = 'OR'
 14557         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-AH-BENEFIT-AMT *
 14558                                         PB-I-AH-TERM.
 14559     MOVE WS-AH-EDIT-AGE         TO CP-ISSUE-AGE.
 14560     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14561     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 14562     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14563     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 264
* EL050.cbl
 14564     MOVE PB-I-AH-TERM           TO CP-ORIGINAL-TERM
 14565                                    CP-REMAINING-TERM
 14566                                    WS-WORK-TERM.
 14567     MOVE PB-I-EXTENTION-DAYS   TO CP-TERM-OR-EXT-DAYS.
 14568     IF PB-COMPANY-ID = 'DCC'
 14569        MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14570     END-IF
 14571     IF  PB-COMPANY-ID = 'TIC'
 14572         IF PB-I-REIN-TABLE = '01T' OR '02T' OR '03T'
 14573            MOVE ZERO TO CP-CLASS-CODE.
 14574
 14575     IF PB-COMPANY-ID NOT = 'TIC'
 14576          MOVE ZERO          TO CP-CLASS-CODE.
 14577
 14578     MOVE ZERO               TO CP-DEVIATION-CODE.
 14579
 14580     MOVE WS-NSP-ST-CD-AH    TO CP-STATE.
 14581
 14582     MOVE ZERO               TO PB-I-AH-REI-RATE.
 14583
 14584     MOVE 'R'                   TO CP-RATE-FILE.
 14585     PERFORM 7000-GET-RATE THRU 7000-EXIT.
 14586
 14587     IF CP-ERROR-RATE-NOT-FOUND
 14588         MOVE ER-2645        TO WS-ERROR
 14589         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14590         GO TO 3340-CALCULATE-PREMIUM-AMT.
 14591
 14592     MOVE CP-PREMIUM-RATE    TO PB-I-AH-REI-RATE.
 14593
 14594     MOVE CP-PREMIUM-RATE    TO EC-RT-AH-NSP-RATE.
 14595     MOVE WS-NSP-ST-CD-AH    TO EC-RT-AH-NSP-ST.
 14596
 14597     IF PB-I-AH-REI-RATE = ZERO
 14598         MOVE ER-2645        TO WS-ERROR
 14599         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14600
 14601
 14602 3340-CALCULATE-PREMIUM-AMT.
 14603
 14604     IF PB-COMPANY-ID = 'NCL'
 14605         IF (WS-LF-SPECIAL-CALC-CD = 'O'  OR
 14606             WS-AH-SPECIAL-CALC-CD = 'O')
 14607             GO TO 3999-END-EDIT.
 14608
 14609     IF PB-COMPANY-ID = 'TIC' OR 'WDS' OR 'HAN' OR 'BNE' OR
 14610                        'AN1' OR 'TFS' OR 'MON' OR 'NCL' OR
 14611                        'TMS' OR 'GTL' OR 'CID' OR 'DCC'
 14612                         OR 'AHL'
 14613         NEXT SENTENCE
 14614     ELSE
 14615         IF WS-STATE-ABBREVIATION = 'CT'
 14616             IF (NOT NO-LIFE-COVERAGE  AND  LF-BENEFIT-FOUND) AND
 14617                (NOT NO-AH-COVERAGE  AND  AH-BENEFIT-FOUND)
 14618                 COMPUTE PB-I-LF-PREM-CALC =
 14619                                     PB-I-LF-PREM-CALC * .90
 14620                 COMPUTE PB-I-LF-ALT-PREM-CALC =
 14621                                     PB-I-LF-ALT-PREM-CALC * .90
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 265
* EL050.cbl
 14622                 COMPUTE PB-I-AH-PREM-CALC =
 14623                                     PB-I-AH-PREM-CALC * .90.
 14624
 14625     IF PB-COMP-LF-PREM
 14626        MOVE PB-I-LF-PREM-CALC       TO PB-I-LF-PREMIUM-AMT
 14627        MOVE PB-I-LF-ALT-PREM-CALC   TO PB-I-LF-ALT-PREMIUM-AMT.
 14628
 14629     IF PB-COMP-AH-PREM
 14630        MOVE PB-I-AH-PREM-CALC       TO PB-I-AH-PREMIUM-AMT.
 14631
 14632 3340-CHECK-DCC-TOT-FEES.
 14633     IF (PB-COMPANY-ID = 'DCC')
 14634        AND (PB-I-LF-BENEFIT-CD (1:1) = 'N' OR 'S')
 14635        AND (PB-I-AH-BENEFIT-CD (1:1) = 'N' OR 'S')
 14636        AND (PB-I-POLICY-IS-MONTHLY)
 14637        CONTINUE
 14638     ELSE
 14639        GO TO 3340-EDIT-LF-AH-TOL
 14640     END-IF
 14641     MOVE WS-DCC-LF-RATE         TO CP-DCC-LF-RATE
 14642     MOVE WS-DCC-AH-RATE         TO CP-DCC-AH-RATE
 14643     IF PB-I-RATE-DEV-PCT-LF NOT = ZEROS
 14644        COMPUTE CP-DCC-LF-RATE = WS-DCC-LF-RATE *
 14645           PB-I-RATE-DEV-PCT-LF
 14646     END-IF
 14647     IF PB-I-RATE-DEV-PCT-AH NOT = ZEROS
 14648        COMPUTE CP-DCC-AH-RATE = WS-DCC-AH-RATE *
 14649           PB-I-RATE-DEV-PCT-AH
 14650     END-IF
 14651     MOVE 'N'                    TO CP-BEN-CATEGORY
 14652     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 14653
 14654     MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC.
 14655     MOVE AM-MAX-MON-BEN         TO CP-R-MAX-MON-BEN.
 14656     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN.
 14657     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 14658     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 14659     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 14660     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 14661     MOVE '3'                    TO CP-PROCESS-TYPE.
 14662     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 14663     MOVE WS-PL-SALES-TAX        TO CP-SALES-TAX.
 14664
 14665     MOVE PB-SV-STATE            TO CP-STATE.
 14666     MOVE PB-I-RATE-CLASS        TO CP-CLASS-CODE.
 14667     MOVE PB-I-RATE-DEVIATION-LF TO CP-DEVIATION-CODE.
 14668     MOVE PB-I-RATE-DEV-PCT-LF   TO CP-RATE-DEV-PCT.
 14669     MOVE PB-I-LF-BENEFIT-CD     TO CP-BENEFIT-CD.
 14670     MOVE PB-I-LF-BENEFIT-AMT    TO CP-ORIGINAL-BENEFIT
 14671                                    CP-RATING-BENEFIT-AMT.
 14672     IF CP-STATE-STD-ABBRV = 'OR'
 14673         COMPUTE CP-RATING-BENEFIT-AMT = PB-I-LF-BENEFIT-AMT +
 14674                                         PB-I-LF-ALT-BENEFIT-AMT.
 14675     MOVE PB-I-LF-PREMIUM-AMT    TO CP-ORIGINAL-PREMIUM.
 14676     MOVE PB-I-1ST-PMT-DT        TO CP-FIRST-PAY-DATE.
 14677     MOVE WS-EDIT-AGE            TO CP-ISSUE-AGE.
 14678     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14679     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 266
* EL050.cbl
 14680     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 14681     MOVE PB-I-LOAN-APR          TO CP-LOAN-APR.
 14682     MOVE PB-I-LF-CRIT-PER       TO CP-CRITICAL-MONTHS
 14683     MOVE PB-I-LF-TERM           TO CP-ORIGINAL-TERM
 14684                                    CP-REMAINING-TERM
 14685                                    CP-LOAN-TERM.
 14686     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
 14687        COMPUTE CP-ORIGINAL-BENEFIT = PB-I-LF-BENEFIT-AMT -
 14688           PB-I-LF-PREMIUM-AMT
 14689     end-if
 14690
 14691     IF CP-TRUNCATED-LIFE
 14692        MOVE PB-I-LOAN-TERM      TO CP-LOAN-TERM.
 14693
 14694     IF CP-TERM-IS-DAYS
 14695         MOVE PB-I-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
 14696     ELSE
 14697         MOVE PB-I-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 14698
 14699     MOVE WS-DAYS-TO-1ST-PMT  TO CP-DAYS-TO-1ST-PMT
 14700     IF CP-SPECIAL-CALC-CD = 'H'
 14701         MOVE PB-I-LF-ALT-BENEFIT-AMT
 14702                                    TO CP-ALTERNATE-BENEFIT
 14703         MOVE PB-I-AH-BENEFIT-AMT   TO CP-MONTHLY-PAYMENT.
 14704     MOVE PB-I-AH-BENEFIT-AMT    TO CP-MONTHLY-PAYMENT
 14705     MOVE 'R'                    TO CP-RATE-FILE
 14706     PERFORM 7000-GET-RATE       THRU 7000-EXIT
 14707     IF NOT CP-ERROR-RATE-NOT-FOUND
 14708        MOVE CP-CALC-PREMIUM     TO PB-I-TOT-FEES-CALC
 14709        IF (CP-DCC-LF-RATE NOT = ZEROS)
 14710           AND (CP-BENEFIT-CD (1:1) = 'S')
 14711           MOVE CP-LF-PREM       TO PB-I-LF-PREM-CALC
 14712                                    PB-I-LF-PREMIUM-AMT
 14713        END-IF
 14714     ELSE
 14715        MOVE +0                  TO PB-I-TOT-FEES-CALC
 14716     END-IF
 14717     .
 14718 3340-EDIT-LF-AH-TOL.
 14719
 14720***    UNSIGN-WRK1    =    LIFE DIFFERENCE
 14721***    UNSIGN-WRK2    =    AH   DIFFERENCE
 14722***    UNSIGN-WRK3    =    LIFE + AH DIFFERENCE
 14723***
 14724     ADD PB-I-LF-PREMIUM-AMT   PB-I-LF-ALT-PREMIUM-AMT
 14725         PB-I-AH-PREMIUM-AMT
 14726          GIVING WS-CALC-WORK.
 14727
 14728     IF WS-CALC-WORK LESS THAN WS-MIN-PREMIUM
 14729        AND WS-CALC-WORK NOT = ZERO
 14730         MOVE ER-2649            TO WS-ERROR
 14731         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14732
 14733     SUBTRACT PB-I-LF-PREM-CALC
 14734             FROM PB-I-LF-PREMIUM-AMT
 14735                 GIVING WS-UNSIGN-WRK1.
 14736
 14737     SUBTRACT PB-I-LF-ALT-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 267
* EL050.cbl
 14738             FROM PB-I-LF-ALT-PREMIUM-AMT
 14739                 GIVING WS-UNSIGN-WRK4.
 14740
 14741     COMPUTE WS-UNSIGN-WRK1 = WS-UNSIGN-WRK1
 14742                                + WS-UNSIGN-WRK4.
 14743
 14744     SUBTRACT PB-I-AH-PREM-CALC
 14745             FROM PB-I-AH-PREMIUM-AMT
 14746                 GIVING WS-UNSIGN-WRK2.
 14747
 14748******************************************************************
 14749*    DO NOT CHECK TOLERANCE FOR LIFE AND/OR A&H OVERRIDE.        *
 14750******************************************************************
 14751
 14752     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 14753         MOVE ZERO TO WS-UNSIGN-WRK1.
 14754
 14755     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 14756         MOVE ZERO TO WS-UNSIGN-WRK2.
 14757
 14758     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2
 14759             GIVING WS-UNSIGN-WRK3.
 14760
 14761 3342-CONTINUE.
 14762
 14763     IF (PB-I-LF-RATE = ZERO  AND
 14764         PB-I-AH-RATE = ZERO)
 14765         IF WS-LF-SPECIAL-CALC-CD = 'O' OR
 14766            WS-AH-SPECIAL-CALC-CD = 'O'
 14767              NEXT SENTENCE
 14768         ELSE
 14769             GO TO 3345-EDIT-CONTINUE.
 14770
 14771     IF  PB-RECORD-BILL   =  'B' OR  'L'
 14772         NEXT SENTENCE
 14773     ELSE
 14774     IF PB-COMPANY-ID EQUAL 'PEK' OR 'MON'
 14775        IF WS-UNSIGN-WRK3 GREATER THAN WS-TOL-LF-PREM
 14776           IF (PB-REISSUED-CERT         OR
 14777               PB-POLICY-IS-DECLINED    OR
 14778               PB-POLICY-IS-VOIDED)
 14779              NEXT SENTENCE
 14780           ELSE
 14781              IF WS-PREM-REJECT-SW = SPACE
 14782                 MOVE ER-2652    TO WS-ERROR
 14783                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14784                 GO TO 3344-CHECK-AH
 14785              ELSE
 14786                 MOVE ER-2650    TO WS-ERROR
 14787                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14788                 GO TO 3344-CHECK-AH.
 14789
 14790***
 14791***   COMPUTE HIGH AND LOW LIFE PERCENT TOLERANCES
 14792***
 14793
 14794     IF WS-TOL-LF-PREM-PCT IS GREATER THAN ZEROS
 14795         COMPUTE WS-TOL-LF-HIGH-PREM-PCT =
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 268
* EL050.cbl
 14796            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14797             (1 + WS-TOL-LF-PREM-PCT)
 14798         COMPUTE WS-TOL-LF-LOW-PREM-PCT  =
 14799            (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) *
 14800             (1 - WS-TOL-LF-PREM-PCT)
 14801     ELSE
 14802         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT
 14803         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 14804
 14805***
 14806***   COMPUTE HIGH AND LOW LIFE AMOUNT TOLERANCES
 14807***
 14808
 14809     COMPUTE WS-TOL-LF-HIGH-PREM-AMT EQUAL
 14810         PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC +
 14811          WS-TOL-LF-PREM.
 14812
 14813     COMPUTE WS-TOL-LF-LOW-PREM-AMT EQUAL
 14814         (PB-I-LF-PREM-CALC + PB-I-LF-ALT-PREM-CALC) -
 14815          WS-TOL-LF-PREM.
 14816
 14817     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14818        MOVE +0                  TO WS-TOL-LF-LOW-PREM-AMT.
 14819
 14820     IF PB-REISSUED-CERT
 14821        or PB-POLICY-IS-DECLINED
 14822        or PB-POLICY-IS-VOIDED
 14823        continue
 14824     ELSE
 14825        IF (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14826              > WS-TOL-LF-HIGH-PREM-AMT)
 14827           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14828              < WS-TOL-LF-LOW-PREM-AMT))
 14829                      or
 14830           (((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14831              > WS-TOL-LF-HIGH-PREM-PCT)
 14832           OR ((PB-I-LF-PREMIUM-AMT + PB-I-LF-ALT-PREMIUM-AMT)
 14833              < WS-TOL-LF-LOW-PREM-PCT))
 14834           IF WS-PREM-REJECT-SW = SPACE
 14835              MOVE ER-2652       TO WS-ERROR
 14836              PERFORM 9900-ERROR-FORMAT
 14837                                 THRU 9900-EXIT
 14838           ELSE
 14839              MOVE ER-2650       TO WS-ERROR
 14840              PERFORM 9900-ERROR-FORMAT
 14841                                 THRU 9900-EXIT
 14842           end-if
 14843        end-if
 14844     end-if
 14845
 14846*    IF  WS-ERROR  =  ER-2650  OR  ER-2652
 14847*        IF  PB-RECORD-BILL   =  'B' OR  'L'
 14848*            MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14849*            SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14850
 14851     IF WS-ERROR  =  ER-2650  OR  ER-2652
 14852        IF (PB-RECORD-BILL   =  'B' OR  'L')
 14853                      OR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 269
* EL050.cbl
 14854           ((PB-COMPANY-ID = 'DCC')
 14855           AND (PB-I-LF-BENEFIT-CD = '00' OR '  ' or 'DD'))
 14856           MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14857           SUBTRACT  +1     FROM  PB-NO-OF-ERRORS
 14858        END-IF
 14859     END-IF
 14860
 14861     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14862        IF WS-COMP-MAX-CAP GREATER THAN +0
 14863           IF WS-UNSIGN-WRK1 GREATER THAN WS-COMP-MAX-CAP
 14864              IF (PB-REISSUED-CERT         OR
 14865                  PB-POLICY-IS-DECLINED    OR
 14866                  PB-POLICY-IS-VOIDED)
 14867                 NEXT SENTENCE
 14868              ELSE
 14869                  MOVE ER-2646   TO  WS-ERROR
 14870                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14871
 14872 3344-CVL-TOLERANCE-CHECK.
 14873
 14874      IF PB-COMPANY-ID  IS NOT EQUAL TO  'CVL'
 14875          GO TO 3344-CHECK-AH.
 14876
 14877      IF PB-I-LF-ALT-PREMIUM-AMT  IS EQUAL TO  ZEROS
 14878          GO TO 3344-CHECK-AH.
 14879
 14880      MOVE ZERO                  TO  WS-UNSIGN-WRK5
 14881                                     WS-UNSIGN-WRK6.
 14882
 14883      IF PB-I-LF-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14884          COMPUTE WS-UNSIGN-WRK5 = WS-UNSIGN-WRK5
 14885                                 + PB-I-LF-PREMIUM-AMT
 14886                                 - PB-I-LF-PREM-CALC.
 14887
 14888      IF PB-I-LF-ALT-PREMIUM-AMT  IS NOT EQUAL TO  ZERO
 14889          COMPUTE WS-UNSIGN-WRK6 = WS-UNSIGN-WRK6
 14890                                 + PB-I-LF-ALT-PREMIUM-AMT
 14891                                 - PB-I-LF-ALT-PREM-CALC.
 14892
 14893      IF WS-UNSIGN-WRK5  IS GREATER THAN  ZERO
 14894          IF WS-UNSIGN-WRK5  IS GREATER THAN  WS-TOL-LF-PREM
 14895              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14896                 MOVE ER-2652    TO  WS-ERROR
 14897                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14898              ELSE
 14899                 MOVE ER-2650    TO  WS-ERROR
 14900                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14901
 14902      IF WS-UNSIGN-WRK6  IS GREATER THAN  ZERO
 14903          IF WS-UNSIGN-WRK6  IS GREATER THAN  WS-TOL-LF-PREM
 14904              IF WS-PREM-REJECT-SW  IS EQUAL TO  SPACE
 14905                 MOVE ER-2652    TO  WS-ERROR
 14906                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14907              ELSE
 14908                 MOVE ER-2650    TO  WS-ERROR
 14909                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14910
 14911 3344-CHECK-AH.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 270
* EL050.cbl
 14912
 14913****************************************************************
 14914***   COMPUTE HIGH AND LOW AH PERCENT TOLERANCES
 14915***
 14916
 14917     IF WS-TOL-AH-PREM-PCT IS GREATER THAN ZEROS
 14918         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-I-AH-PREM-CALC *
 14919             (1 + WS-TOL-AH-PREM-PCT)
 14920         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-I-AH-PREM-CALC *
 14921             (1 - WS-TOL-AH-PREM-PCT)
 14922     ELSE
 14923         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT
 14924         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 14925
 14926***
 14927***   COMPUTE HIGH AND LOW AH AMOUNT TOLERANCES
 14928***
 14929
 14930     COMPUTE WS-TOL-AH-HIGH-PREM-AMT EQUAL
 14931         PB-I-AH-PREM-CALC + WS-TOL-AH-PREM.
 14932
 14933     COMPUTE WS-TOL-AH-LOW-PREM-AMT EQUAL
 14934         PB-I-AH-PREM-CALC - WS-TOL-AH-PREM.
 14935
 14936     IF PB-COMPANY-ID EQUAL 'FLC' OR 'CDC'
 14937        MOVE +0                  TO WS-TOL-AH-LOW-PREM-AMT.
 14938
 14939     IF (PB-REISSUED-CERT)
 14940        OR (PB-POLICY-IS-DECLINED)
 14941        OR (PB-POLICY-IS-VOIDED)
 14942        OR (AM-DCC-PRODUCT-CODE = 'DDF')
 14943        CONTINUE
 14944     ELSE
 14945        IF ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-AMT)
 14946              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-AMT))
 14947                          or
 14948           ((PB-I-AH-PREMIUM-AMT > WS-TOL-AH-HIGH-PREM-PCT)
 14949              OR (PB-I-AH-PREMIUM-AMT < WS-TOL-AH-LOW-PREM-PCT))
 14950           IF WS-PREM-REJECT-SW = SPACE
 14951              MOVE ER-3052       TO WS-ERROR
 14952              PERFORM 9900-ERROR-FORMAT
 14953                                 THRU 9900-EXIT
 14954           ELSE
 14955              MOVE ER-3050       TO WS-ERROR
 14956              PERFORM 9900-ERROR-FORMAT
 14957                                 THRU 9900-EXIT
 14958           END-IF
 14959        END-IF
 14960     END-IF
 14961     if (pb-company-id = 'DCC')
 14962        and ((pb-i-ah-benefit-cd (1:1) = 'N' or 'S')
 14963        or (pb-i-lf-benefit-cd (1:1) = 'N' or 'S'))
 14964        and (pb-i-policy-is-monthly)
 14965        compute ws-tol-ah-high-prem-amt =
 14966           pb-i-tot-fees-calc + ws-tol-ah-prem
 14967        compute ws-tol-ah-low-prem-amt =
 14968           pb-i-tot-fees-calc - ws-tol-ah-prem
 14969        if ws-tol-ah-prem-pct > zeros
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 271
* EL050.cbl
 14970           compute ws-tol-ah-high-prem-pct = pb-i-tot-fees-calc *
 14971              (1 + ws-tol-ah-prem-pct)
 14972           compute ws-tol-ah-low-prem-pct  = pb-i-tot-fees-calc *
 14973              (1 - ws-tol-ah-prem-pct)
 14974        else
 14975           move +9999999.99      to ws-tol-ah-high-prem-pct
 14976           move +0               to ws-tol-ah-low-prem-pct
 14977        end-if
 14978        if ((pb-i-tot-fees > ws-tol-ah-high-prem-amt)
 14979            or
 14980           (pb-i-tot-fees < ws-tol-ah-low-prem-amt))
 14981                          or
 14982           ((pb-i-tot-fees > ws-tol-ah-high-prem-pct)
 14983           or
 14984           (pb-i-tot-fees < ws-tol-ah-low-prem-pct))
 14985            move er-3049         to ws-error
 14986           perform 9900-error-format
 14987                                 thru 9900-exit
 14988
 14989        end-if
 14990     end-if
 14991     IF  WS-ERROR  =  ER-3050   OR   ER-3052
 14992         IF  PB-RECORD-BILL   =  'B' OR 'A'
 14993             MOVE  +0     TO  PB-COMMON-ERROR (PB-NO-OF-ERRORS)
 14994             SUBTRACT  +1     FROM  PB-NO-OF-ERRORS.
 14995
 14996     IF PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC'
 14997        IF WS-COMP-MAX-CAP GREATER THAN +0
 14998           IF WS-UNSIGN-WRK2 GREATER THAN WS-COMP-MAX-CAP
 14999              IF (PB-REISSUED-CERT         OR
 15000                  PB-POLICY-IS-DECLINED    OR
 15001                  PB-POLICY-IS-VOIDED)
 15002                 NEXT SENTENCE
 15003              ELSE
 15004                  MOVE ER-2646   TO  WS-ERROR
 15005                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15006
 15007     IF (PB-COMPANY-ID NOT EQUAL 'FLC' AND 'CDC') OR
 15008        (WS-COMP-MAX-CAP EQUAL +0)
 15009           GO TO 3345-EDIT-CONTINUE.
 15010
 15011     IF ((PB-I-AH-PREM-CALC + PB-I-LF-PREM-CALC) - WS-CALC-WORK)
 15012        GREATER THAN WS-COMP-MAX-CAP
 15013           MOVE ER-2646          TO  WS-ERROR
 15014           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15015
 15016 3345-EDIT-CONTINUE.
 15017
 15018*    IF PB-COMPANY-ID    EQUAL    'NCL'
 15019*       IF PB-ENTRY-BATCH   NUMERIC
 15020*          IF PB-ISSUE
 15021*              MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO
 15022*          ELSE
 15023*              IF PB-CANCELLATION
 15024*                 MOVE PB-ENTRY-BATCH TO  PB-C-MICROFILM-NO.
 15025
 15026*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15027*        IF  PB-I-MICROFILM-NO     NUMERIC    AND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 272
* EL050.cbl
 15028*            PB-I-MICROFILM-NO  NOT EQUAL  ZEROS
 15029*            MOVE  PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO
 15030*        ELSE
 15031*            MOVE  ER-1909            TO  WS-ERROR
 15032*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15033
 15034     IF PB-I-POLICY-ACCEPTED
 15035        IF PB-POLICY-IS-DECLINED  OR
 15036           PB-REISSUED-CERT  OR
 15037           PB-REIN-ONLY-CERT  OR
 15038           PB-POLICY-IS-VOIDED
 15039            MOVE  ER-1891         TO  WS-ERROR
 15040            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15041        ELSE
 15042            MOVE SPACE            TO  PB-BATCH-ENTRY
 15043            MOVE '2'              TO  PB-I-ENTRY-STATUS.
 15044
 15045     IF PB-I-POLICY-DECLINED
 15046        IF PB-REISSUED-CERT  OR
 15047           PB-REIN-ONLY-CERT  OR
 15048           PB-POLICY-IS-VOIDED
 15049            MOVE  ER-1906         TO  WS-ERROR
 15050            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15051        ELSE
 15052            MOVE  'D'             TO  PB-BATCH-ENTRY
 15053                                      PB-I-ENTRY-STATUS.
 15054
 15055     IF PB-I-NEEDS-UNDERWRITING
 15056        IF PB-POLICY-IS-DECLINED OR
 15057           PB-REISSUED-CERT  OR
 15058           PB-REIN-ONLY-CERT  OR
 15059           PB-POLICY-IS-VOIDED
 15060            MOVE  ER-1907         TO  WS-ERROR
 15061            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15062        ELSE
 15063            MOVE 'U'              TO  PB-BATCH-ENTRY
 15064                                      PB-I-ENTRY-STATUS.
 15065
 15066     IF PB-NEEDS-UNDERWRITING
 15067        MOVE  ER-1901             TO  WS-ERROR
 15068        PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15069     IF PB-COMPANY-ID = 'DCC'
 15070        MOVE PB-I-LF-BENEFIT-CD  TO WS-LF-BEN-CD
 15071        MOVE PB-I-AH-BENEFIT-CD  TO WS-AH-BEN-CD
 15072        IF (((WS-LF-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15073           AND (NOT WS-LF-CASH))
 15074                           OR
 15075           ((WS-AH-BEN-CD (1:1) = 'N' OR 'M' OR 'S' OR 'P')
 15076           AND (NOT WS-AH-CASH)))
 15077                       AND
 15078           (PB-I-ENTRY-STATUS NOT = '5')
 15079           MOVE 'M'              TO PB-BATCH-ENTRY
 15080                                    PB-I-ENTRY-STATUS
 15081        END-IF
 15082     END-IF
 15083     move pending-business       to ws-passed-erpndb
 15084     move ' '                    to ws-exceed-limit-yn
 15085     perform 7780-call-agg       thru 7780-exit
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 273
* EL050.cbl
 15086     display ' el050 exceed ' ws-exceed-limit-yn
 15087     if ws-exceed-limit-yn = 'Y'
 15088        MOVE  ER-9813            TO WS-ERROR
 15089        PERFORM  9900-ERROR-FORMAT
 15090                                 THRU 9900-EXIT
 15091     end-if
 15092     IF  PB-COMPANY-ID NOT = 'NCL'
 15093         GO TO 3999-END-EDIT.
 15094
 15095     IF PB-REISSUED-CERT  OR
 15096        PB-POLICY-IS-DECLINED  OR
 15097        PB-POLICY-IS-VOIDED  OR
 15098        PB-I-OB
 15099         GO TO 3999-END-EDIT.
 15100
 15101     IF PB-I-POLICY-FORM-NO = SPACES  OR  ZEROS
 15102         MOVE  ER-2644            TO  WS-ERROR
 15103         PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15104         GO TO 3999-END-EDIT.
 15105
 15106     MOVE 'N'                     TO  FORM-MASTER-SW.
 15107     PERFORM  3350-GET-ERFORM  THRU  3350-EXIT.
 15108
 15109     IF NOT FORM-MASTER-FOUND
 15110         GO TO 3999-END-EDIT.
 15111
 15112     MOVE 'N'                     TO  FORM-MASTER-LIFE-SW
 15113                                      FORM-MASTER-AH-SW.
 15114
 15115     IF  PB-I-LIFE-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15116         MOVE  +1                 TO SUB6
 15117         PERFORM  3355-EDIT-FORM-LF-BENEFITS THRU 3355-EXIT.
 15118
 15119     IF PB-I-AH-BENEFIT-CD NOT = ZEROS  AND  SPACES
 15120         MOVE  +1                 TO SUB6
 15121         PERFORM  3356-EDIT-FORM-AH-BENEFITS THRU 3356-EXIT.
 15122
 15123     IF LF-FORM-MASTER-FOUND  OR
 15124        AH-FORM-MASTER-FOUND
 15125         GO TO 3360-CHECK-FORM-LIMITS
 15126     ELSE
 15127         GO TO 3999-END-EDIT.
 15128
 15129******************************************************************
 15130*                  3350-GET-ERFORM                               *
 15131*    THIS SECTION READS THE POLICY FORM MASTER FILE.  THIS FILE  *
 15132*    IS READ TO VERIFY POLICY FORM NUMBER AND VALID BENEFITS.    *
 15133******************************************************************
 15134
 15135 3350-GET-ERFORM.
 15136
 15137     IF  WK-FORM-ADDR      EQUAL    ZEROS
 15138         GO TO  3350-ERFORM-GETMAIN.
 15139
 15140     MOVE  WK-FORM-ADDR           TO  ERFORM-WS-COMP.
 15141     SET ERFORM-FILE-ADDRESSED    TO  TRUE.
 15142     PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT.
 15143     MOVE 'Y'                     TO FORM-MASTER-SW.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 274
* EL050.cbl
 15144
 15145     IF PB-CANCELLATION
 15146         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15147            PB-SV-STATE          EQUAL   FO-STATE       AND
 15148            CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15149              GO TO 3350-EXIT
 15150         ELSE
 15151             NEXT SENTENCE
 15152     ELSE
 15153         IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15154            PB-SV-STATE          EQUAL   FO-STATE       AND
 15155            PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15156              GO TO 3350-EXIT.
 15157
 15158 3350-ERFORM-GETMAIN.
 15159
 15160     PERFORM  8400-GETMAIN-ERFORM      THRU  8400-EXIT.
 15161     MOVE  ERFORM-WS-COMP         TO  WK-FORM-ADDR.
 15162
 15163 3350-ERFORM-READ.
 15164
 15165     MOVE  PB-COMPANY-CD          TO  FORM-COMPANY-CD.
 15166     MOVE  PB-SV-STATE            TO  FORM-STATE.
 15167     IF PB-CANCELLATION
 15168         MOVE  CM-POLICY-FORM-NO      TO  FORM-FORM-ID
 15169     ELSE
 15170         MOVE  PB-I-POLICY-FORM-NO    TO  FORM-FORM-ID.
 15171     MOVE  PB-CERT-EFF-DT         TO  FORM-FORM-EXP-DT.
 15172
 15173     PERFORM  8450-READ-FORM-MASTER  THRU  8450-EXIT.
 15174
 15175     IF FORM-MASTER-FOUND
 15176       IF PB-CANCELLATION
 15177          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15178             PB-SV-STATE          EQUAL   FO-STATE       AND
 15179             CM-POLICY-FORM-NO    EQUAL   FO-FORM-ID
 15180              GO  TO 3350-EXIT
 15181          ELSE
 15182              NEXT SENTENCE
 15183       ELSE
 15184          IF PB-COMPANY-CD        EQUAL   FO-COMPANY-CD  AND
 15185             PB-SV-STATE          EQUAL   FO-STATE       AND
 15186             PB-I-POLICY-FORM-NO  EQUAL   FO-FORM-ID
 15187              GO  TO 3350-EXIT.
 15188
 15189     MOVE  'N'                    TO  FORM-MASTER-SW.
 15190     MOVE  ER-1895                TO  WS-ERROR.
 15191     PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15192
 15193 3350-EXIT.
 15194      EXIT.
 15195
 15196******************************************************************
 15197*                  3355-EDIT-FORM-LF-BENEFITS                    *
 15198*   THIS SECTION IS USED TO VERIFY THAT THE LIFE BENEFIT IS      *
 15199*   VALID FOR THE POLICY FORM USED.                              *
 15200******************************************************************
 15201
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 275
* EL050.cbl
 15202 3355-EDIT-FORM-LF-BENEFITS.
 15203
 15204     IF PB-LIFE-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15205        PB-I-LIFE-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15206         MOVE  'Y'                TO  FORM-MASTER-LIFE-SW
 15207         GO TO   3355-EXIT.
 15208
 15209     IF  SUB6    LESS THAN   +40
 15210         ADD  +1      TO  SUB6
 15211         GO TO  3355-EDIT-FORM-LF-BENEFITS.
 15212
 15213     MOVE  ER-1896         TO  WS-ERROR.
 15214     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15215
 15216 3355-EXIT.
 15217      EXIT.
 15218
 15219******************************************************************
 15220*                  3356-EDIT-FORM-AH-BENEFITS                    *
 15221*   THIS SECTION IS USED TO VERIFY THAT THE A&H BENEFIT IS       *
 15222*   VALID FOR THE POLICY FORM USED.                              *
 15223******************************************************************
 15224
 15225 3356-EDIT-FORM-AH-BENEFITS.
 15226
 15227     IF PB-AH-OVERRIDE-L1  =  FO-PLAN-TYPE (SUB6)  AND
 15228        PB-I-AH-BENEFIT-CD =  FO-PLAN-ID (SUB6)
 15229         MOVE  'Y'                TO  FORM-MASTER-AH-SW
 15230         GO TO  3356-EXIT.
 15231
 15232      IF  SUB6    LESS THAN     +40
 15233          ADD  +1      TO  SUB6
 15234          GO TO  3356-EDIT-FORM-AH-BENEFITS.
 15235
 15236     MOVE  ER-1897         TO  WS-ERROR.
 15237     PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15238
 15239 3356-EXIT.
 15240      EXIT.
 15241
 15242******************************************************************
 15243*                  3357-BENEFIT-SEARCH                           *
 15244*   THIS SECTION IS USED TO FIND A MATCHING BENEFIT CODE FOR     *
 15245*   CANCELLATIONS ONLY.                                          *
 15246******************************************************************
 15247 3357-BENEFIT-SEARCH.
 15248     IF PB-CI-LF-BENEFIT-CD NOT = ZEROS AND SPACES
 15249         MOVE +1                          TO SUB6
 15250         PERFORM 3358-BENEFIT-LIFE-SEARCH THRU 3358-EXIT.
 15251
 15252     IF PB-CI-AH-BENEFIT-CD NOT = ZEROS AND SPACES
 15253         MOVE +1                          TO SUB6
 15254         PERFORM 3359-BENEFIT-AH-SEARCH   THRU 3359-EXIT.
 15255
 15256 3357-EXIT.
 15257     EXIT.
 15258
 15259******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 276
* EL050.cbl
 15260*                  3358-BENEFIT-LIFE-SEARCH                      *
 15261*   THE COMPANY OR STATE LIFE REFUND METHOD WILL BE REPLACED BY  *
 15262*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15263*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15264******************************************************************
 15265 3358-BENEFIT-LIFE-SEARCH.
 15266     IF PB-LIFE-OVERRIDE-L1     EQUAL TO FO-PLAN-TYPE (SUB6)
 15267       IF PB-CI-LF-BENEFIT-CD EQUAL TO FO-PLAN-ID  (SUB6)
 15268         IF (PB-CI-LF-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15269           OR PB-CI-LF-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15270              IF FO-PLAN-REFUND-METHOD (SUB6)
 15271                     IS GREATER THAN SPACES
 15272                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15273                                          WS-LF-REFUND-CALC
 15274                 GO TO 3358-EXIT.
 15275
 15276     IF SUB6 LESS THAN +40
 15277         ADD +1                 TO SUB6
 15278         GO TO 3358-BENEFIT-LIFE-SEARCH.
 15279
 15280 3358-EXIT.
 15281     EXIT.
 15282******************************************************************
 15283*                  3359-BENEFIT-AH-SEARCH                        *
 15284*   THE COMPANY OR STATE A/H  REFUND METHOD WILL BE REPLACED BY  *
 15285*   THE FORM BENEFIT REFUND METHOD IF THE CANCELLATIONS TERM     *
 15286*   IS LESS THAN OR EQUAL TO THE FORM BENEFIT PLAN TERM.         *
 15287******************************************************************
 15288 3359-BENEFIT-AH-SEARCH.
 15289     IF PB-AH-OVERRIDE-L1      EQUAL TO FO-PLAN-TYPE (SUB6)
 15290       IF PB-CI-AH-BENEFIT-CD  EQUAL TO FO-PLAN-ID  (SUB6)
 15291         IF (PB-CI-AH-TERM  IS LESS THAN FO-PLAN-TERM (SUB6)
 15292           OR PB-CI-AH-TERM IS EQUAL TO  FO-PLAN-TERM (SUB6))
 15293              IF FO-PLAN-REFUND-METHOD (SUB6)
 15294                      IS GREATER THAN SPACES
 15295                 MOVE FO-PLAN-REFUND-METHOD (SUB6) TO
 15296                                          WS-AH-REFUND-CALC
 15297                 GO TO 3359-EXIT.
 15298
 15299     IF SUB6 LESS THAN +40
 15300         ADD +1                 TO SUB6
 15301         GO TO 3359-BENEFIT-AH-SEARCH.
 15302
 15303 3359-EXIT.
 15304     EXIT.
 15305
 15306******************************************************************
 15307*                  3360-CHECK-FORM-LIMITS                        *
 15308*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15309*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15310******************************************************************
 15311
 15312 3360-CHECK-FORM-LIMITS.
 15313
 15314     IF FO-IND-GRP-CD = 'I'  OR  'G'
 15315         MOVE  FO-IND-GRP-CD    TO  PB-I-INDV-GRP-CD.
 15316
 15317     IF NOT LF-FORM-MASTER-FOUND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 277
* EL050.cbl
 15318         GO TO 3360-CHECK-FORM-AH-LIMITS.
 15319
 15320 3360-CHECK-FORM-LF-MIN-ISS-AGE.
 15321
 15322     IF PB-I-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  OR
 15323       (PB-I-JOINT-AGE  LESS THAN  FO-LF-MIN-ISSUE-AGE  AND
 15324        WS-LF-JOINT-INDICATOR = 'J'  AND
 15325        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15326         IF PB-COMPANY-ID = 'NCL'
 15327            MOVE  ER-1911          TO  WS-ERROR
 15328            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15329         ELSE
 15330            MOVE  ER-1892          TO  WS-ERROR
 15331            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15332
 15333 3360-CHECK-FORM-LF-ATT-AGE.
 15334
 15335     COMPUTE WS-ATT-AGE = WS-EDIT-AGE + (PB-I-LF-TERM / 12).
 15336
 15337     IF  FO-MAX-ATT-AGE     NUMERIC  AND
 15338         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15339         IF  WS-ATT-AGE     GREATER THAN  FO-MAX-ATT-AGE
 15340            IF PB-COMPANY-ID = 'NCL'
 15341                MOVE  ER-1913      TO  WS-ERROR
 15342                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15343            ELSE
 15344                MOVE  ER-1894      TO  WS-ERROR
 15345                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15346
 15347 3360-CHECK-FORM-LF-MAX-ISS-AGE.
 15348
 15349     IF  FO-LF-MAX-ISSUE-AGE   NUMERIC   AND
 15350         FO-LF-MAX-ISSUE-AGE   GREATER THAN   ZEROS
 15351         IF  WS-EDIT-AGE  GREATER THAN  FO-LF-MAX-ISSUE-AGE
 15352            IF PB-COMPANY-ID = 'NCL'
 15353                MOVE  ER-1914      TO  WS-ERROR
 15354                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15355            ELSE
 15356                MOVE  ER-1899      TO  WS-ERROR
 15357                PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15358
 15359 3360-CHECK-FORM-LF-TERM-BAMT.
 15360
 15361     IF  FO-LF-MAX-TERM   NUMERIC   AND
 15362         FO-LF-MAX-TERM   GREATER THAN   ZEROS
 15363         IF  PB-I-LF-TERM   GREATER THAN  FO-LF-MAX-TERM
 15364           IF  PB-COMPANY-ID = 'NCL'
 15365               MOVE  ER-1916       TO  WS-ERROR
 15366               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15367           ELSE
 15368               MOVE  ER-1902       TO  WS-ERROR
 15369               PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15370
 15371     COMPUTE  WS-LF-BENEFIT-AMT  =  PB-I-LF-BENEFIT-AMT  +
 15372                                    PB-I-LF-ALT-BENEFIT-AMT.
 15373
 15374     IF  FO-MAX-LF-AMT   NUMERIC   AND
 15375         FO-MAX-LF-AMT   GREATER THAN   ZEROS
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 278
* EL050.cbl
 15376         IF  WS-LF-BENEFIT-AMT   GREATER THAN  FO-MAX-LF-AMT
 15377             IF  PB-COMPANY-ID = 'NCL'
 15378                 MOVE  ER-1918     TO  WS-ERROR
 15379                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15380             ELSE
 15381                 MOVE  ER-1904     TO  WS-ERROR
 15382                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15383
 15384******************************************************************
 15385*                  3360-CHECK-FORM-AH-LIMITS                     *
 15386*   THIS SECTION WILL EDIT THE POLICY FORM CRITERIA FOR THE MIN  *
 15387*   AND MAX ISSUE AGE, ATTAINED AGE, MAX TERM AND MAX BENEFITS.  *
 15388******************************************************************
 15389
 15390 3360-CHECK-FORM-AH-LIMITS.
 15391
 15392     IF NOT AH-FORM-MASTER-FOUND
 15393         GO TO 3999-END-EDIT.
 15394
 15395 3360-CHECK-FORM-AH-MIN-ISS-AGE.
 15396
 15397     IF PB-I-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  OR
 15398       (PB-I-JOINT-AGE  LESS THAN  FO-AH-MIN-ISSUE-AGE  AND
 15399        WS-AH-JOINT-INDICATOR = 'J'  AND
 15400        (WS-JOINT-AGE-FLAG = '1' OR 'Y'))
 15401         IF PB-COMPANY-ID = 'NCL'
 15402            MOVE  ER-1912          TO  WS-ERROR
 15403            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15404         ELSE
 15405            MOVE  ER-1893          TO  WS-ERROR
 15406            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15407
 15408 3360-CHECK-FORM-AH-ATT-AGE.
 15409
 15410     COMPUTE WS-ATT-AGE = WS-AH-EDIT-AGE + (PB-I-AH-TERM / 12).
 15411
 15412     IF  FO-MAX-ATT-AGE     NUMERIC     AND
 15413         FO-MAX-ATT-AGE     GREATER THAN  ZEROS
 15414         IF  WS-ATT-AGE   GREATER THAN  FO-MAX-ATT-AGE
 15415            IF PB-COMPANY-ID = 'NCL'
 15416                MOVE  ER-1913      TO  WS-ERROR
 15417                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT
 15418            ELSE
 15419                MOVE  ER-1894      TO  WS-ERROR
 15420                PERFORM  9900-ERROR-FORMAT THRU 9900-EXIT.
 15421
 15422 3360-CHECK-FORM-AH-MAX-ISS-AGE.
 15423
 15424     IF  FO-AH-MAX-ISSUE-AGE    NUMERIC   AND
 15425         FO-AH-MAX-ISSUE-AGE    GREATER THAN  +0
 15426         IF  WS-AH-EDIT-AGE  GREATER THAN  FO-AH-MAX-ISSUE-AGE
 15427            IF PB-COMPANY-ID = 'NCL'
 15428                MOVE  ER-1915      TO  WS-ERROR
 15429                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15430            ELSE
 15431                MOVE  ER-1900      TO  WS-ERROR
 15432                PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15433
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 279
* EL050.cbl
 15434 3360-CHECK-FORM-AH-TERM-BAMT.
 15435
 15436     IF  FO-AH-MAX-TERM    NUMERIC   AND
 15437         FO-AH-MAX-TERM    GREATER THAN  +0
 15438         IF  PB-I-AH-TERM      GREATER THAN   FO-AH-MAX-TERM
 15439             IF  PB-COMPANY-ID = 'NCL'
 15440                 MOVE  ER-1917     TO  WS-ERROR
 15441                 PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT
 15442             ELSE
 15443                  MOVE  ER-1903    TO  WS-ERROR
 15444                  PERFORM  9900-ERROR-FORMAT   THRU  9900-EXIT.
 15445
 15446     IF  FO-MAX-AH-AMT    NUMERIC   AND
 15447         FO-MAX-AH-AMT    GREATER THAN  +0
 15448         IF  PB-I-AH-BENEFIT-AMT   GREATER THAN   FO-MAX-AH-AMT
 15449             IF  PB-COMPANY-ID = 'NCL'
 15450                 MOVE  ER-1919     TO  WS-ERROR
 15451                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15452             ELSE
 15453                 MOVE  ER-1905     TO  WS-ERROR
 15454                 PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15455
 15456     GO TO 3999-END-EDIT.
 15457
 15458******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 280
* EL050.cbl
 15460 3400-edit-vin.
 15461
 15462     MOVE PB-I-VIN               TO WS-WORK-VIN
 15463     MOVE +8                     TO V2
 15464     MOVE ZEROS                  TO WS-VIN-TOTAL
 15465     PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 15466      (V1 > 17)
 15467        IF WS-WORK-VIN (V1:1) = ' ' OR 'O' OR 'I' OR 'Q'
 15468           MOVE ER-3825          TO WS-ERROR
 15469           PERFORM 9900-ERROR-FORMAT
 15470                                 THRU 9900-EXIT
 15471        ELSE
 15472           IF V1 = 8
 15473              MOVE 10            TO V2
 15474           END-IF
 15475           IF V1 = 9
 15476              MOVE 0             TO V2
 15477           END-IF
 15478           IF V1 = 10
 15479              MOVE 9             TO V2
 15480           END-IF
 15481           IF WS-WORK-VIN (V1:1) NUMERIC
 15482              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15483               + (WS-WORK-VIN-N (V1) * V2)
 15484           ELSE
 15485              MOVE WS-WORK-VIN (V1:1)
 15486                            TO WS-HEX-BYTE
 15487              COMPUTE V3 = (WS-CHARCD - WS-CHARCD-A) + 1
 15488              COMPUTE WS-VIN-TOTAL = WS-VIN-TOTAL
 15489               + (WS-NUM (V3) * V2)
 15490           END-IF
 15491           COMPUTE V2 = V2 - 1
 15492        END-IF
 15493     END-PERFORM
 15494     MOVE ZEROS                  TO WS-VIN-REMAINDER
 15495     DIVIDE WS-VIN-TOTAL BY 11 GIVING WS-VIN-FINAL
 15496        REMAINDER WS-VIN-REMAINDER
 15497     IF ((WS-WORK-VIN (9:1) = 'X')
 15498        AND (WS-VIN-REMAINDER = 10))
 15499                OR
 15500        (WS-WORK-VIN-N (9) = WS-VIN-REMAINDER)
 15501        CONTINUE
 15502     ELSE
 15503        IF WS-WORK-VIN (1:1) > 0 AND < 6
 15504           MOVE ER-3826          TO WS-ERROR
 15505           PERFORM 9900-ERROR-FORMAT
 15506                                 THRU 9900-EXIT
 15507        ELSE
 15508           MOVE ER-3827          TO WS-ERROR
 15509           PERFORM 9900-ERROR-FORMAT
 15510                                 THRU 9900-EXIT
 15511        END-IF
 15512     END-IF
 15513
 15514     .
 15515 3400-exit.
 15516     exit.
 15517******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 281
* EL050.cbl
 15518*                  E D I T   C A N C E L                         *
 15519******************************************************************
 15520
 15521 3700-EDIT-CANCEL.
 15522     IF PB-COMPANY-ID = 'DMD'
 15523         MOVE ZEROS                   TO WS-RES-STATE-TAX
 15524                                         WS-RES-MUNI-TAX
 15525                                         PB-CI-STATE-TAX
 15526                                         PB-CI-MUNI-TAX
 15527         PERFORM 6600-GET-STATE-MUNICIPAL-TAX THRU 6640-EXIT.
 15528
 15529*    IF PB-COMPANY-ID  EQUAL  'NCL'
 15530*       IF PB-ENTRY-BATCH  NUMERIC
 15531*          IF PB-CANCELLATION
 15532*             MOVE PB-ENTRY-BATCH      TO  PB-C-MICROFILM-NO
 15533*          ELSE
 15534*             IF PB-ISSUE
 15535*                 MOVE PB-ENTRY-BATCH  TO  PB-I-MICROFILM-NO.
 15536
 15537     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 15538        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 15539     END-IF
 15540*    IF PB-C-MICROFILM-NO  NOT NUMERIC
 15541*        MOVE ZEROS              TO  PB-C-MICROFILM-NO.
 15542
 15543     IF CM-ENTRY-STATUS = 'V'
 15544        MOVE ER-2780             TO WS-ERROR
 15545        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15546        GO TO 3999-END-EDIT.
 15547
 15548     IF CM-ENTRY-STATUS = 'D'
 15549        MOVE ER-2781             TO WS-ERROR
 15550        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15551        GO TO 3999-END-EDIT.
 15552
 15553     IF CM-ENTRY-STATUS = 'U'
 15554        MOVE ER-2782             TO WS-ERROR
 15555        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15556
 15557***************************************************************
 15558*                                                             *
 15559*   THE FOLLOWING LOGIC ALLOWS FOR VOIDING OF CANCELS         *
 15560*   FOR EITHER OR BOTH LIFE AND A/H COVERAGE, BUT DOES        *
 15561*   NOT ALLOW FOR VOIDING OF ONE COVERAGE AND ADJUSTING       *
 15562*   OF ANOTHER COVERAGE.                                      *
 15563*                                                             *
 15564***************************************************************
 15565
 15566     MOVE SPACE                  TO PB-C-LF-CANCEL-VOID-SW
 15567                                    PB-C-AH-CANCEL-VOID-SW.
 15568
 15569     IF PB-C-LF-CANCEL-AMT = ZERO
 15570        NEXT SENTENCE
 15571     ELSE
 15572        IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 15573           AND
 15574           ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 15575               MOVE '1'          TO PB-C-LF-CANCEL-VOID-SW
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 282
* EL050.cbl
 15576               MOVE ER-2745           TO WS-ERROR
 15577               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15578
 15579     IF PB-C-AH-CANCEL-AMT = ZERO
 15580        NEXT SENTENCE
 15581     ELSE
 15582        IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 15583           AND
 15584           (PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT = ZERO)
 15585               MOVE '1'          TO PB-C-AH-CANCEL-VOID-SW
 15586               MOVE ER-2745           TO WS-ERROR
 15587               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15588
 15589     IF WS-LF-EARNINGS-CALC = '4'
 15590        MOVE '4'                   TO WS-LF-REFUND-CALC.
 15591
 15592     MOVE WS-TOL-LF-REFUND         TO PB-CALC-TOLERANCE.
 15593     MOVE WS-REF-REJECT-SW         TO PB-TOLERANCE-REJECT-SW.
 15594     MOVE WS-LF-REM-TERM-CALC      TO PB-LF-TERM-CALC-METHOD.
 15595     MOVE WS-AH-REM-TERM-CALC      TO PB-AH-TERM-CALC-METHOD.
 15596     MOVE WS-LF-REFUND-CALC        TO PB-LF-REFUND-TYPE.
 15597     MOVE WS-AH-REFUND-CALC        TO PB-AH-REFUND-TYPE.
 15598
 15599     MOVE ZERO                     TO PB-C-LF-REF-CALC
 15600                                      PB-C-AH-REF-CALC.
 15601     MOVE WS-ACCT-REIN-TABLE       TO PB-REIN-CD.
 15602
 15603******************************************************************
 15604*        EDIT BOTH THE CANCEL DATE AND REFUND AMOUNT             *
 15605*             TO VALIDATE COVERAGE.                              *
 15606******************************************************************
 15607
 15608     IF PB-C-LF-CANCEL-DT  = LOW-VALUE AND
 15609        PB-C-LF-CANCEL-AMT = ZEROS
 15610          MOVE 'N'                 TO WS-LF-CANCEL-SW
 15611      ELSE
 15612          MOVE 'Y'                 TO WS-LF-CANCEL-SW.
 15613
 15614     IF PB-C-AH-CANCEL-DT = LOW-VALUE  AND
 15615        PB-C-AH-CANCEL-AMT = ZEROS
 15616          MOVE 'N'                 TO WS-AH-CANCEL-SW
 15617      ELSE
 15618          MOVE 'Y'                 TO WS-AH-CANCEL-SW.
 15619
 15620     EVALUATE TRUE
 15621         WHEN PB-CANCEL-FORCE             OR
 15622              PB-CANCEL-DATE-FORCED       OR
 15623              PB-FORCE-OFF
 15624                  IF PB-COMPANY-ID = 'ACE'
 15625                     MOVE AM-CANCEL-FEE  TO  PB-CI-CANCEL-FEE
 15626                  END-IF
 15627         WHEN (PB-CANCEL-DATE-FORCED-NO-FEE  OR
 15628               PB-ALL-CANCEL-FORCED-NO-FEE)  AND
 15629              (PB-COMPANY-ID = 'ACE' )
 15630                  MOVE ZEROES TO PB-CI-CANCEL-FEE
 15631         WHEN OTHER
 15632              IF PB-COMPANY-ID = 'ACE'
 15633                 MOVE ER-2794              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 283
* EL050.cbl
 15634              ELSE
 15635                 MOVE ER-2749              TO WS-ERROR
 15636              END-IF
 15637              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15638     END-EVALUATE.
 15639
 15640
 15641*    IF  PB-COMPANY-ID    EQUAL    'HER'
 15642*        IF  PB-C-MICROFILM-NO     EQUAL       ZEROS
 15643*            MOVE  ER-1909            TO  WS-ERROR
 15644*            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT
 15645*        ELSE
 15646*            MOVE  PB-C-MICROFILM-NO  TO  CM-CAN-MICROFILM-NO.
 15647
 15648     MOVE WS-ST-LF-PREM-TAX      TO PB-C-LF-PREM-TAX
 15649     IF PB-CI-INDV-GRP-CD   = '1' OR 'I'
 15650        MOVE WS-ST-AH-PREM-TAX-I TO PB-C-AH-PREM-TAX
 15651     ELSE
 15652        MOVE WS-ST-AH-PREM-TAX-G TO PB-C-AH-PREM-TAX
 15653     END-IF
 15654     .
 15655 3705-EDIT-CANCEL-DT.
 15656
 15657     IF LF-COVERAGE-CANCELLED
 15658        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15659         MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-1
 15660         MOVE WS-CURRENT-MONTH-END
 15661                                 TO DC-BIN-DATE-2
 15662         SET ELAPSED-BETWEEN-BIN TO TRUE
 15663*        MOVE 1                  TO DC-OPTION-CODE
 15664         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15665         IF DATE-CONVERSION-ERROR
 15666            NEXT SENTENCE
 15667          ELSE
 15668             IF DC-ELAPSED-DAYS GREATER +180
 15669                IF PB-CANCEL-DATE-FORCED  OR
 15670                   PB-CANCEL-DATE-FORCED-NO-FEE
 15671                      MOVE ER-2751  TO WS-ERROR
 15672                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15673                 ELSE
 15674                   MOVE ER-2752  TO WS-ERROR
 15675                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15676
 15677     IF AH-COVERAGE-CANCELLED
 15678        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15679         MOVE PB-C-AH-CANCEL-DT TO DC-BIN-DATE-1
 15680         MOVE WS-CURRENT-MONTH-END
 15681                                 TO DC-BIN-DATE-2
 15682         SET ELAPSED-BETWEEN-BIN TO TRUE
 15683*        MOVE 1                  TO DC-OPTION-CODE
 15684         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15685         IF DATE-CONVERSION-ERROR
 15686            NEXT SENTENCE
 15687          ELSE
 15688             IF DC-ELAPSED-DAYS GREATER +180
 15689                IF PB-CANCEL-DATE-FORCED OR
 15690                   PB-CANCEL-DATE-FORCED-NO-FEE
 15691                      MOVE ER-2751  TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 284
* EL050.cbl
 15692                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15693                 ELSE
 15694                   MOVE ER-2752  TO WS-ERROR
 15695                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15696
 15697     IF WS-ERROR = ER-2752
 15698        AND (PB-COMPANY-ID = 'ABL'
 15699         OR  PB-COMPANY-ID = 'FGL'
 15700         OR  PB-COMPANY-ID = 'IST'
 15701         OR  PB-COMPANY-ID = 'JHL'
 15702         OR  PB-COMPANY-ID = 'LAP'
 15703         OR  PB-COMPANY-ID = 'LBL'
 15704         OR  PB-COMPANY-ID = 'NCB'
 15705         OR  PB-COMPANY-ID = 'NLI'
 15706         OR  PB-COMPANY-ID = 'OFI'
 15707         OR  PB-COMPANY-ID = 'PLI'
 15708         OR  PB-COMPANY-ID = 'TAO'
 15709         OR  PB-COMPANY-ID = 'TIC'
 15710         OR  PB-COMPANY-ID = 'HER'
 15711         OR  WS-LF-SPECIAL-CALC-CD = 'Z'
 15712         OR  WS-AH-SPECIAL-CALC-CD = 'Z')
 15713            SUBTRACT +1          FROM PB-NO-OF-ERRORS
 15714            MOVE ER-2762     TO WS-ERROR
 15715            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15716
 15717     IF LF-COVERAGE-CANCELLED
 15718        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15719        IF PB-C-LF-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15720             MOVE ER-2733         TO WS-ERROR
 15721             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15722
 15723     IF AH-COVERAGE-CANCELLED
 15724        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15725        IF PB-C-AH-CANCEL-DT GREATER WS-CURRENT-BIN-DT
 15726              MOVE ER-2733        TO WS-ERROR
 15727              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15728
 15729     IF (PB-CI-LF-BENEFIT-CD    NOT =  ZEROS)  AND
 15730        (PB-CI-AH-BENEFIT-CD    NOT =  ZEROS)
 15731        IF (PB-C-LF-CANCEL-DT   NOT =  LOW-VALUE)  AND
 15732           (PB-C-AH-CANCEL-DT   NOT =  LOW-VALUE)
 15733            IF PB-C-LF-CANCEL-DT  NOT = PB-C-AH-CANCEL-DT
 15734              IF PB-COMPANY-ID NOT = 'LAP'
 15735               MOVE ER-2704            TO WS-ERROR
 15736               PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 15737
 15738     IF CERT-WAS-NOT-FOUND
 15739         GO TO 3999-END-EDIT.
 15740
 15741     IF PB-COMPANY-ID EQUAL 'CDC'
 15742        IF LF-COVERAGE-CANCELLED
 15743           AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15744            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15745            MOVE PB-C-LF-CANCEL-DT
 15746                                 TO DC-BIN-DATE-2
 15747            SET ELAPSED-BETWEEN-BIN TO TRUE
 15748*           MOVE 1               TO DC-OPTION-CODE
 15749            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 285
* EL050.cbl
 15750            IF DATE-CONVERSION-ERROR
 15751               NEXT SENTENCE
 15752             ELSE
 15753                IF DC-ELAPSED-DAYS GREATER +60
 15754                   MOVE 'N'      TO PB-C-LF-COMM-CHARGEBACK.
 15755
 15756     IF PB-COMPANY-ID EQUAL 'CDC'
 15757        IF AH-COVERAGE-CANCELLED
 15758           AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15759            MOVE PB-CERT-EFF-DT  TO DC-BIN-DATE-1
 15760            MOVE PB-C-AH-CANCEL-DT
 15761                                 TO DC-BIN-DATE-2
 15762            MOVE +0              TO DC-ELAPSED-DAYS
 15763                                    DC-ELAPSED-MONTHS
 15764            SET ELAPSED-BETWEEN-BIN  TO TRUE
 15765*           MOVE 1               TO DC-OPTION-CODE
 15766            PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15767            IF DATE-CONVERSION-ERROR
 15768               NEXT SENTENCE
 15769             ELSE
 15770                IF DC-ELAPSED-DAYS GREATER +60
 15771                   MOVE 'N'      TO PB-C-AH-COMM-CHARGEBACK.
 15772
 15773     MOVE +0                     TO DC-ELAPSED-DAYS
 15774                                    DC-ELAPSED-MONTHS.
 15775
 15776     IF (WS-LF-SPECIAL-CALC-CD = 'Z')  OR
 15777        (WS-AH-SPECIAL-CALC-CD = 'Z')
 15778          MOVE 'Z'                TO PB-CI-OB-FLAG
 15779          MOVE ER-2767            TO WS-ERROR
 15780          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15781          MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 15782          MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 15783          GO TO 3775-OVER-REF-CHK
 15784        ELSE
 15785          MOVE ZEROS              TO PB-CI-LIVES
 15786                                     PB-C-LIVES
 15787          IF PB-CI-OB-FLAG NOT = 'B'
 15788             MOVE SPACE           TO PB-CI-OB-FLAG.
 15789
 15790     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 15791         MOVE ZEROS              TO PB-CI-EXTENTION-DAYS
 15792     ELSE
 15793         MOVE ZEROS              TO PB-CI-TERM-IN-DAYS.
 15794
 15795     IF (PB-CI-ENTRY-DT GREATER THAN PB-CREDIT-SELECT-DT)
 15796        AND (PB-CI-CREDIT-INTERFACE-SW-1 NOT = SPACE AND '3')
 15797            MOVE ER-2760         TO WS-ERROR
 15798            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15799
 15800     IF LF-COVERAGE-CANCELLED
 15801        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15802         IF PB-C-LF-CANCEL-DT LESS PB-CERT-EFF-DT
 15803            AND (PB-C-LF-CANCEL-DT NOT = LOW-VALUES)
 15804               MOVE ER-2774       TO WS-ERROR
 15805               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15806
 15807     IF AH-COVERAGE-CANCELLED
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 286
* EL050.cbl
 15808        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15809         IF PB-C-AH-CANCEL-DT LESS PB-CERT-EFF-DT
 15810            AND (PB-C-AH-CANCEL-DT NOT = LOW-VALUES)
 15811               MOVE ER-2775       TO WS-ERROR
 15812               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15813
 15814     IF LF-COVERAGE-CANCELLED
 15815        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15816         IF PB-C-LF-CANCEL-DT = LOW-VALUES
 15817            MOVE ER-2776         TO WS-ERROR
 15818            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15819
 15820     IF AH-COVERAGE-CANCELLED
 15821        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15822         IF PB-C-AH-CANCEL-DT = LOW-VALUES
 15823            MOVE ER-2777         TO WS-ERROR
 15824            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15825
 15826     IF LF-COVERAGE-CANCELLED
 15827        AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15828        if pb-ci-lf-expire-dt = low-values or spaces
 15829           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15830           MOVE PB-CI-LF-TERM    TO DC-ELAPSED-MONTHS
 15831           MOVE PB-CI-EXTENTION-DAYS
 15832                                 TO DC-ELAPSED-DAYS
 15833           SET BIN-PLUS-ELAPSED  TO TRUE
 15834           PERFORM 8500-DATE-CONVERT
 15835                                 THRU 8500-EXIT
 15836           IF DATE-CONVERSION-ERROR
 15837              move low-values    to dc-bin-date-2
 15838           end-if
 15839        else
 15840           move pb-ci-lf-expire-dt
 15841                                 to dc-bin-date-2
 15842        end-if
 15843        IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
 15844           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15845                             OR  'FIA'
 15846              MOVE DC-BIN-DATE-2 TO PB-C-LF-CANCEL-DT
 15847           ELSE
 15848              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15849              MOVE ER-2731       TO WS-ERROR
 15850              PERFORM 9900-ERROR-FORMAT
 15851                                 THRU 9900-EXIT
 15852           end-if
 15853        end-if
 15854     end-if
 15855*    IF LF-COVERAGE-CANCELLED
 15856*       AND (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 15857*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15858*        MOVE PB-CI-LF-TERM        TO DC-ELAPSED-MONTHS
 15859*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15860*        SET BIN-PLUS-ELAPSED      TO TRUE
 15861*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15862*        IF DATE-CONVERSION-ERROR
 15863*           NEXT SENTENCE
 15864*         ELSE
 15865*           IF PB-C-LF-CANCEL-DT GREATER DC-BIN-DATE-2
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 287
* EL050.cbl
 15866*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15867*                            OR  'FIA'
 15868*                MOVE DC-BIN-DATE-2   TO  PB-C-LF-CANCEL-DT
 15869*              ELSE
 15870*               MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15871*               MOVE ER-2731       TO WS-ERROR
 15872*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15873     .
 15874 3705-EDIT-AH-CANCEL-DT.
 15875     IF AH-COVERAGE-CANCELLED
 15876        AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15877        if pb-ci-AH-expire-dt = low-values or spaces
 15878           MOVE PB-CERT-EFF-DT   TO DC-BIN-DATE-1
 15879           MOVE PB-CI-AH-TERM    TO DC-ELAPSED-MONTHS
 15880           MOVE PB-CI-EXTENTION-DAYS
 15881                                 TO DC-ELAPSED-DAYS
 15882           SET BIN-PLUS-ELAPSED  TO TRUE
 15883           PERFORM 8500-DATE-CONVERT
 15884                                 THRU 8500-EXIT
 15885           IF DATE-CONVERSION-ERROR
 15886              move low-values    to dc-bin-date-2
 15887           end-if
 15888        else
 15889           move pb-ci-ah-expire-dt
 15890                                 to dc-bin-date-2
 15891        end-if
 15892        IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15893           IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15894                             OR  'FIA'
 15895              MOVE DC-BIN-DATE-2 TO PB-C-AH-CANCEL-DT
 15896           ELSE
 15897              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15898              MOVE ER-2771       TO WS-ERROR
 15899              PERFORM 9900-ERROR-FORMAT
 15900                                 THRU 9900-EXIT
 15901           end-if
 15902        end-if
 15903     end-if
 15904*    IF AH-COVERAGE-CANCELLED
 15905*       AND (PB-CI-AH-BENEFIT-CD NOT = ZERO)
 15906*        MOVE PB-CERT-EFF-DT       TO DC-BIN-DATE-1
 15907*        MOVE PB-CI-AH-TERM        TO DC-ELAPSED-MONTHS
 15908*        MOVE PB-CI-EXTENTION-DAYS TO DC-ELAPSED-DAYS
 15909**       MOVE 6                    TO DC-OPTION-CODE
 15910*        SET BIN-PLUS-ELAPSED      TO TRUE
 15911*        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 15912*        IF DATE-CONVERSION-ERROR
 15913*           NEXT SENTENCE
 15914*         ELSE
 15915*           IF PB-C-AH-CANCEL-DT GREATER DC-BIN-DATE-2
 15916*             IF PB-COMPANY-ID = 'JHL' OR 'BNE' OR 'HAN'
 15917*                             OR 'FIA'
 15918*               MOVE DC-BIN-DATE-2   TO  PB-C-AH-CANCEL-DT
 15919*             ELSE
 15920*              MOVE 'Y'           TO WS-FUTURE-CANCEL-DT-SW
 15921*              MOVE ER-2771       TO WS-ERROR
 15922*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15923     .
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 288
* EL050.cbl
 15924 3705-EDIT-CONTINUED.
 15925
 15926*    IF LF-COVERAGE-CANCELLED
 15927*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15928*         IF PB-C-LF-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15929*            MOVE ER-2727         TO WS-ERROR
 15930*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15931*
 15932*    IF AH-COVERAGE-CANCELLED
 15933*      IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15934*        IF PB-COMPANY-ID = 'ACE'
 15935*           MOVE ER-2727        TO WS-ERROR
 15936*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15937*        ELSE
 15938*           IF PB-C-AH-CANCEL-DT NOT GREATER PB-CI-AH-PAID-THRU-DT
 15939*              MOVE ER-2727     TO WS-ERROR
 15940*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15941
 15942     IF PB-COMPANY-ID = 'ACE'
 15943       IF AH-COVERAGE-CANCELLED
 15944         IF PB-CI-AH-PAID-THRU-DT NOT = LOW-VALUE
 15945           IF PB-C-AH-CANCEL-DT LESS THAN PB-CI-AH-PAID-THRU-DT
 15946              MOVE ER-2732      TO WS-ERROR
 15947              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15948
 15949     IF PB-COMPANY-ID      EQUAL   'HER'
 15950        IF WS-ERROR        EQUAL   ER-2727
 15951            SUBTRACT  +1           FROM  PB-NO-OF-ERRORS
 15952            MOVE  ER-2725          TO  WS-ERROR
 15953            PERFORM  9900-ERROR-FORMAT  THRU  9900-EXIT.
 15954
 15955     IF PB-C-CLAIM-CREATED-CANCEL
 15956            MOVE ER-2748         TO WS-ERROR
 15957            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15958
 15959     IF PB-C-LAST-NAME NOT = SPACES
 15960         IF PB-C-LAST-NAME NOT = PB-CI-LAST-NAME
 15961            MOVE ER-2747         TO WS-ERROR
 15962            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15963
 15964 3710-EDIT-LUMP-SUM-PRIOR.
 15965
 15966     IF AH-COVERAGE-CANCELLED
 15967         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15968             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-AH-CANCEL-DT
 15969                MOVE ER-2735    TO WS-ERROR
 15970                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15971
 15972     IF LF-COVERAGE-CANCELLED
 15973         IF (PB-CI-AH-SETTLEMENT-DT NOT = LOW-VALUE)
 15974             IF PB-CI-AH-SETTLEMENT-DT NOT = PB-C-LF-CANCEL-DT
 15975                MOVE ER-2735    TO WS-ERROR
 15976                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15977
 15978 3710-EDIT-PRIOR-DEATH.
 15979
 15980*    IF LF-COVERAGE-CANCELLED
 15981*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 289
* EL050.cbl
 15982*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15983*           (NOT PB-CI-OB)
 15984*             IF PB-CI-DEATH-DT NOT = PB-C-LF-CANCEL-DT
 15985*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-LF-CANCEL-DT
 15986*                   MOVE ER-2732  TO WS-ERROR
 15987*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15988*
 15989*    IF AH-COVERAGE-CANCELLED
 15990*        IF (PB-CI-DEATH-DT NOT = LOW-VALUE) AND
 15991*           (CM-LF-STATUS-AT-DEATH NOT = SPACE) AND
 15992*           (NOT PB-CI-OB)
 15993*             IF PB-CI-DEATH-DT NOT = PB-C-AH-CANCEL-DT
 15994*                IF PB-CERT-EFF-DT NOT EQUAL PB-C-AH-CANCEL-DT
 15995*                   MOVE ER-2732  TO WS-ERROR
 15996*                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15997
 15998     IF PB-CI-DEATH-DT NOT = LOW-VALUES
 15999         IF (PB-C-LF-CANCEL-AMT = ZERO) AND
 16000            (NOT PB-COMP-LF-CANCEL)
 16001             NEXT SENTENCE
 16002         ELSE
 16003           IF PB-C-LF-CANCEL-VOIDED
 16004              NEXT SENTENCE
 16005           ELSE
 16006              MOVE ER-2753      TO WS-ERROR
 16007              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16008
 16009     IF CANCEL-FUTURE-DT
 16010         GO TO 3999-END-EDIT.
 16011
 16012 3715-GET-REMAIN-TERM-LF.
 16013
 16014     IF NO-LF-BENEFIT-MATCH  OR
 16015        WS-LF-BENEFIT-CD = ZEROS
 16016        GO TO 3730-GET-AH-REMAIN-TERM.
 16017
 16018     MOVE PB-LIFE-OVERRIDE-L1    TO CP-LIFE-OVERRIDE-CODE.
 16019     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16020     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16021     MOVE PB-C-LF-CANCEL-DT      TO CP-VALUATION-DT.
 16022     MOVE PB-SV-STATE            TO CP-STATE.
 16023     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16024     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 16025     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16026     MOVE '2'                    TO CP-PROCESS-TYPE.
 16027     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16028     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16029     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16030     IF (PB-COMPANY-ID = 'CID')
 16031        AND (CP-STATE-STD-ABBRV = 'WI')
 16032        MOVE '7'                 TO CP-REM-TERM-METHOD
 16033        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16034     ELSE
 16035        MOVE WS-LF-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16036        MOVE WS-REM-TRM-CALC-OPTION
 16037                                 TO CP-REM-TRM-CALC-OPTION
 16038     END-IF
 16039**  X'9B41' = 07/01/2003       X'A2FB' = 08/27/2008
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 290
* EL050.cbl
 16040     IF (PB-COMPANY-ID = 'CID')
 16041        AND (CP-STATE-STD-ABBRV = 'MO')
 16042        AND (PB-CERT-EFF-DT >= X'9B41')
 16043        AND (PB-CERT-EFF-DT <= X'A2FB')
 16044        MOVE '7'                 TO CP-REM-TERM-METHOD
 16045        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16046     END-IF
 16047     MOVE PB-CI-LF-TERM          TO CP-ORIGINAL-TERM
 16048                                    CP-LOAN-TERM.
 16049     IF CP-TRUNCATED-LIFE
 16050        MOVE PB-CI-LOAN-TERM     TO CP-LOAN-TERM.
 16051
 16052     IF CP-TERM-IS-DAYS
 16053         MOVE PB-CI-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
 16054     ELSE
 16055         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16056
 16057     MOVE WS-FREE-LOOK-PERIOD     TO CP-FREE-LOOK.
 16058
 16059     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16060
 16061     IF LF-COVERAGE-CANCELLED
 16062        AND PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 16063        NEXT SENTENCE
 16064      ELSE
 16065          GO TO 3730-GET-AH-REMAIN-TERM.
 16066
 16067 3720-GET-LF-REFUND.
 16068
 16069     IF PB-C-LF-CANCEL-VOIDED
 16070        GO TO 3730-GET-AH-REMAIN-TERM
 16071     end-if
 16072
 16073     IF PB-COMPANY-ID EQUAL 'BOA'
 16074         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16075         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16076         GO TO 3730-GET-AH-REMAIN-TERM.
 16077
 16078     IF (WS-LF-SPECIAL-CALC-CD = 'M') OR
 16079        (WS-AH-SPECIAL-CALC-CD = 'M')
 16080         MOVE ER-2767            TO WS-ERROR
 16081         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16082         MOVE PB-C-LF-CANCEL-AMT TO PB-C-LF-REF-CALC
 16083         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16084         GO TO 3780-UPDATE-CANCEL-CERT.
 16085
 16086*    if (ws-lf-earnings-calc = '6')
 16087*       or (pb-c-lf-refund-override = '6')
 16088*       move cp-remaining-term-1 to cp-remaining-term-2
 16089*    end-if
 16090     MOVE CP-REMAINING-TERM-2    TO CP-REMAINING-TERM
 16091
 16092     MOVE WS-LF-EARNINGS-CALC    TO CP-EARNING-METHOD.
 16093     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT.
 16094     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16095     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY
 16096     MOVE ZEROS                  TO CP-ALTERNATE-BENEFIT
 16097     MOVE AM-MAX-TOT-BEN         TO CP-R-MAX-TOT-BEN
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 291
* EL050.cbl
 16098     IF (PB-COMPANY-ID = 'DCC')
 16099        AND (AM-DCC-PRODUCT-CODE = 'DDF')
 16100        IF PDEF-MASTER-FOUND
 16101           PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16102              (V1 > +8)
 16103              OR (PD-PROD-CODE (V1) = 'L')
 16104           END-PERFORM
 16105           IF V1 < +9
 16106              MOVE PD-MAX-AMT (V1)
 16107                           TO CP-R-MAX-TOT-BEN
 16108                              EC-AM-LF-MAX-TOT-BEN
 16109           END-IF
 16110        ELSE
 16111        MOVE ' '                 TO PDEF-MASTER-SW
 16112        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16113        MOVE PB-STATE            TO ERPDEF-STATE
 16114        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16115           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16116        END-IF
 16117        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16118        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16119        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16120        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16121        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16122        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16123        IF PDEF-MASTER-FOUND
 16124           MOVE 'N'              TO PDEF-MASTER-SW
 16125           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16126           IF PDEF-MASTER-FOUND
 16127              IF (ERPDEF-KEY-SAVE (1:16) =
 16128                           PD-CONTROL-PRIMARY (1:16))
 16129                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16130                 CONTINUE
 16131              ELSE
 16132                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16133                 IF (ERPDEF-KEY-SAVE (1:16) =
 16134                           PD-CONTROL-PRIMARY (1:16))
 16135                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16136                    CONTINUE
 16137                 ELSE
 16138                    MOVE 'N'     TO PDEF-MASTER-SW
 16139                 END-IF
 16140              END-IF
 16141
 16142              IF PDEF-MASTER-FOUND
 16143                 PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16144                    (V1 > +8)
 16145                    OR (PD-PROD-CODE (V1) = 'L')
 16146                 END-PERFORM
 16147                 IF V1 < +9
 16148                    MOVE PD-MAX-AMT (V1)
 16149                                 TO CP-R-MAX-TOT-BEN
 16150                                    EC-AM-LF-MAX-TOT-BEN
 16151                 END-IF
 16152              END-IF
 16153           END-IF
 16154           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16155        END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 292
* EL050.cbl
 16156        END-IF
 16157     END-IF
 16158     PERFORM 7500-GET-REMAIN-AMOUNT THRU 7500-EXIT.
 16159
 16160     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT.
 16161
 16162     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16163                                    PB-C-LF-REM-TERM.
 16164
 16165     MOVE WS-LF-REFUND-CALC      TO CP-EARNING-METHOD.
 16166     MOVE WS-LF-EARNINGS-CALC    TO CP-RATING-METHOD.
 16167
 16168     IF PB-COMPANY-ID EQUAL 'FLC'
 16169        IF PB-C-LF-REFUND-OVERRIDE EQUAL 'R'
 16170           MOVE 'N'              TO PB-C-LF-COMM-CHARGEBACK
 16171           COMPUTE PB-C-LF-REF-CALC EQUAL (PB-CI-LF-PREMIUM-AMT
 16172                    + PB-CI-LF-ALT-PREMIUM-AMT)
 16173                    - CM-LF-ITD-DEATH-AMT
 16174           IF PB-C-LF-REF-CALC LESS THAN +0
 16175              MOVE +0            TO PB-C-LF-REF-CALC
 16176              GO TO 3730-GET-AH-REMAIN-TERM
 16177           ELSE
 16178              GO TO 3730-GET-AH-REMAIN-TERM.
 16179
 16180     IF PB-C-LF-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16181                            OR '4' OR '5' OR '6' OR '8'
 16182                            OR '9' OR 'G'
 16183        MOVE PB-C-LF-REFUND-OVERRIDE
 16184                                 TO CP-EARNING-METHOD.
 16185
 16186     if pb-company-id = 'AHL'
 16187        MOVE CM-LF-CLASS-CD      TO CP-CLASS-CODE
 16188        if cp-class-code = spaces
 16189           move zeros            to cp-class-code
 16190        end-if
 16191     ELSE
 16192        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16193     END-IF
 16194*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16195     MOVE PB-CI-LF-BENEFIT-CD    TO CP-BENEFIT-CD.
 16196     MOVE PB-CI-LF-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16197                                    CP-RATING-BENEFIT-AMT.
 16198     IF CP-STATE-STD-ABBRV = 'OR'
 16199         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16200                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16201     MOVE PB-CI-LF-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16202     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16203     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16204     MOVE PB-CI-RATE-DEV-LF      TO CP-DEVIATION-CODE.
 16205     MOVE PB-CI-RATE-DEV-PCT-LF  TO CP-RATE-DEV-PCT.
 16206     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
 16207     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16208     IF WS-DEFAULT-APR NOT NUMERIC
 16209         MOVE ZEROS TO WS-DEFAULT-APR.
 16210****   N O T E   ****
 16211*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
 16212*      THE OH HARD CODING IN ELCRFNDP
 16213
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 293
* EL050.cbl
 16214     IF PB-COMPANY-ID = 'CID'
 16215        IF CP-STATE-STD-ABBRV = 'OH'
 16216           MOVE WS-LF-EARNINGS-CALC
 16217                                 TO CP-EARNING-METHOD
 16218        END-IF
 16219     END-IF
 16220
 16221****   N O T E   ****
 16222
 16223     IF CP-EARN-AS-NET-PAY
 16224         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16225            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16226                MOVE WS-DEFAULT-APR
 16227                                 TO  CP-LOAN-APR
 16228                MOVE ER-3780     TO  WS-ERROR
 16229                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16230            ELSE
 16231                MOVE ER-3781     TO  WS-ERROR
 16232                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16233*    MOVE EC-ST-FST-PMT-DAYS-CHG TO CP-EXT-DAYS-CALC
 16234     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16235
 16236     IF CP-REFUND-TYPE-USED NOT = SPACE
 16237         MOVE CP-REFUND-TYPE-USED TO PB-LF-REFUND-TYPE.
 16238
 16239     IF CP-ERROR-RATE-IS-ZERO OR
 16240        CP-ERROR-RATE-NOT-FOUND
 16241        MOVE ER-2740             TO WS-ERROR
 16242        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16243
 16244     IF CP-ERROR-RATE-FILE-NOTOPEN
 16245        MOVE ER-2617             TO WS-ERROR
 16246        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16247
 16248     IF PB-COMPANY-ID = 'DCC'
 16249        AND PB-CI-ENTRY-STATUS = 'M'
 16250        MOVE +0                  TO PB-C-LF-REF-CALC
 16251     ELSE
 16252        MOVE CP-CALC-REFUND      TO PB-C-LF-REF-CALC
 16253     END-IF
 16254
 16255     IF WS-LF-EARNINGS-CALC NOT = 'B'
 16256         GO TO 3730-GET-AH-REMAIN-TERM.
 16257
 16258*    IF WS-LF-SPECIAL-CALC-CD = 'L'
 16259*       ADD +1                   TO PB-C-LF-REM-TERM
 16260*                                   CP-REMAINING-TERM
 16261*                                   CP-ORIGINAL-TERM.
 16262
 16263     MOVE 'L'                    TO CP-BENEFIT-TYPE.
 16264     MOVE '2'                    TO CP-EARNING-METHOD
 16265                                    CP-RATING-METHOD.
 16266     IF PB-COMPANY-ID = 'CID'
 16267        IF (CP-STATE-STD-ABBRV = 'MN')
 16268           AND (PB-CERT-EFF-DT > X'A4FF')
 16269           AND (WS-LF-EARNINGS-CALC = 'B')
 16270           MOVE '5'              TO CP-EARNING-METHOD
 16271           MOVE WS-LF-EARNINGS-CALC TO CP-RATING-METHOD
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 294
* EL050.cbl
 16272        END-IF
 16273     END-IF
 16274     MOVE PB-CI-LF-ALT-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16275                                        CP-REMAINING-BENEFIT
 16276                                        CP-RATING-BENEFIT-AMT.
 16277     IF CP-STATE-STD-ABBRV = 'OR'
 16278         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-LF-BENEFIT-AMT +
 16279                                         PB-CI-LF-ALT-BENEFIT-AMT.
 16280     MOVE PB-CI-LF-ALT-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16281     MOVE 'LEV'                  TO CP-DEVIATION-CODE.
 16282
 16283     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16284
 16285     IF CP-ERROR-RATE-IS-ZERO OR
 16286        CP-ERROR-RATE-NOT-FOUND
 16287        MOVE ER-2740             TO WS-ERROR
 16288        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16289
 16290     IF CP-ERROR-RATE-FILE-NOTOPEN
 16291        MOVE ER-2617             TO WS-ERROR
 16292        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16293
 16294     ADD  CP-CALC-REFUND         TO PB-C-LF-REF-CALC.
 16295
 16296******************************************************************
 16297
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 295
* EL050.cbl
 16299 3730-GET-AH-REMAIN-TERM.
 16300     IF NO-AH-BENEFIT-MATCH  OR
 16301        WS-AH-BENEFIT-CD = ZEROS
 16302         GO TO 3770-CHECK-REFUNDS.
 16303
 16304     IF PB-CI-AH-LUMP-SUM-DISAB
 16305         IF  PB-C-AH-CANCEL-AMT = ZERO
 16306            IF NOT PB-COMP-AH-CANCEL
 16307             GO TO 3770-CHECK-REFUNDS.
 16308
 16309     MOVE PB-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE.
 16310     MOVE PB-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 16311     MOVE PB-CI-LOAN-1ST-PMT-DT  TO CP-FIRST-PAY-DATE.
 16312     MOVE PB-C-AH-CANCEL-DT      TO CP-VALUATION-DT.
 16313     MOVE PB-SV-STATE            TO CP-STATE.
 16314     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV.
 16315     MOVE PB-AH-OVERRIDE-L1      TO CP-BENEFIT-TYPE.
 16316     MOVE WS-AH-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD.
 16317     MOVE '2'                    TO CP-PROCESS-TYPE.
 16318     MOVE PB-COMPANY-ID          TO CP-COMPANY-ID.
 16319     MOVE PB-COMPANY-CD          TO CP-COMPANY-CD.
 16320     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5.
 16321     IF (PB-COMPANY-ID = 'CID')
 16322        AND (CP-STATE-STD-ABBRV = 'WI')
 16323        MOVE '7'                 TO CP-REM-TERM-METHOD
 16324        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16325     ELSE
 16326        MOVE WS-AH-REM-TERM-CALC TO CP-REM-TERM-METHOD
 16327        MOVE WS-REM-TRM-CALC-OPTION
 16328                                 TO CP-REM-TRM-CALC-OPTION
 16329     END-IF
 16330     IF (PB-COMPANY-ID = 'CID')
 16331        AND (CP-STATE-STD-ABBRV = 'MO')
 16332        AND (PB-CERT-EFF-DT >= X'9B41')
 16333        AND (PB-CERT-EFF-DT <= X'A2FB')
 16334        MOVE '7'                 TO CP-REM-TERM-METHOD
 16335        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
 16336     END-IF
 16337     MOVE PB-CI-AH-TERM          TO CP-ORIGINAL-TERM
 16338                                    CP-LOAN-TERM.
 16339     IF NOT CP-TERM-IS-DAYS
 16340         MOVE PB-CI-EXTENTION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 16341
 16342     MOVE WS-FREE-LOOK-PERIOD    TO CP-FREE-LOOK.
 16343
 16344     PERFORM 7400-GET-REMAIN-TERM THRU 7400-EXIT.
 16345
 16346     IF AH-COVERAGE-CANCELLED
 16347        AND PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 16348        NEXT SENTENCE
 16349      ELSE
 16350         GO TO 3770-CHECK-REFUNDS.
 16351
 16352 3740-GET-AH-REFUND.
 16353
 16354     IF PB-C-AH-CANCEL-VOIDED
 16355        GO TO 3780-UPDATE-CANCEL-CERT
 16356     END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 296
* EL050.cbl
 16357
 16358     IF PB-COMPANY-ID = 'BOA'
 16359         MOVE PB-C-AH-CANCEL-AMT TO PB-C-AH-REF-CALC
 16360         GO TO 3770-CHECK-REFUNDS.
 16361
 16362     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 16363*    MOVE ' '                    TO DC-OPTION-CODE
 16364     SET BIN-TO-GREG             TO TRUE
 16365     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 16366     MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM
 16367                                    PB-C-AH-REM-TERM.
 16368     MOVE WS-AH-REFUND-CALC      TO CP-EARNING-METHOD.
 16369     MOVE WS-AH-EARNINGS-CALC    TO CP-RATING-METHOD.
 16370
 16371     IF PB-COMPANY-ID EQUAL 'FLC'
 16372        IF PB-C-AH-REFUND-OVERRIDE EQUAL 'R'
 16373           MOVE 'N'              TO PB-C-AH-COMM-CHARGEBACK
 16374           COMPUTE PB-C-AH-REF-CALC EQUAL (PB-CI-AH-PREMIUM-AMT
 16375                    - CM-AH-ITD-AH-PMT)
 16376           IF PB-C-AH-REF-CALC LESS THAN +0
 16377              MOVE +0            TO PB-C-AH-REF-CALC
 16378              GO TO 3770-CHECK-REFUNDS
 16379           ELSE
 16380              GO TO 3770-CHECK-REFUNDS.
 16381
 16382     IF PB-COMPANY-ID = 'DCC'
 16383        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16384            AND (CP-EARNING-METHOD NOT = 'G' AND 'D')
 16385           MOVE 'S'              TO CP-EARNING-METHOD
 16386        END-IF
 16387     END-IF
 16388     IF PB-C-AH-REFUND-OVERRIDE EQUAL '1' OR '2' OR '3'
 16389                            OR '4' OR '5' OR '6' OR '8'
 16390                            OR '9' OR 'G' OR 'S'
 16391        MOVE PB-C-AH-REFUND-OVERRIDE
 16392                                 TO CP-EARNING-METHOD.
 16393
 16394     if pb-company-id = 'AHL'
 16395        MOVE CM-AH-CLASS-CD      TO CP-CLASS-CODE
 16396        if cp-class-code = spaces
 16397           move zeros            to cp-class-code
 16398        end-if
 16399     ELSE
 16400        MOVE PB-CI-RATE-CLASS    TO  CP-CLASS-CODE
 16401     END-IF
 16402*    MOVE PB-CI-RATE-CLASS       TO CP-CLASS-CODE.
 16403     MOVE PB-CI-AH-BENEFIT-CD    TO CP-BENEFIT-CD.
 16404     MOVE PB-CI-AH-BENEFIT-AMT   TO CP-ORIGINAL-BENEFIT
 16405                                    CP-RATING-BENEFIT-AMT.
 16406     IF CP-STATE-STD-ABBRV = 'OR'
 16407         COMPUTE CP-RATING-BENEFIT-AMT = PB-CI-AH-BENEFIT-AMT *
 16408                                         PB-CI-AH-TERM.
 16409     MOVE PB-CI-AH-PREMIUM-AMT   TO CP-ORIGINAL-PREMIUM.
 16410     MOVE PB-CI-PAY-FREQUENCY    TO CP-PAY-FREQUENCY.
 16411     MOVE PB-CI-INSURED-AGE      TO CP-ISSUE-AGE.
 16412     MOVE PB-CI-RATE-DEV-AH      TO CP-DEVIATION-CODE.
 16413     MOVE PB-CI-RATE-DEV-PCT-AH  TO CP-RATE-DEV-PCT.
 16414     MOVE PB-CI-LOAN-APR         TO CP-LOAN-APR.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 297
* EL050.cbl
 16415
 16416     IF CP-STATE-STD-ABBRV = 'OH'
 16417        IF (PB-COMPANY-ID NOT EQUAL 'HER' AND 'NCL' AND 'ACM'
 16418                                AND 'CID' AND 'DCC' AND 'AHL')
 16419           IF (CP-ORIGINAL-TERM GREATER 60) AND
 16420              (DC-GREG-DATE-CYMD GREATER 19831101) AND
 16421              (PB-CI-LF-BENEFIT-CD NOT = ZERO)
 16422              MOVE '6' TO CP-EARNING-METHOD
 16423           END-IF
 16424        END-IF
 16425        IF PB-COMPANY-ID = 'CID'
 16426           IF NO-LIFE-COVERAGE
 16427              IF CP-CRITICAL-PERIOD
 16428                 MOVE '2'       TO CP-EARNING-METHOD
 16429              ELSE
 16430                 MOVE '6'       TO CP-EARNING-METHOD
 16431              END-IF
 16432           ELSE
 16433              IF WS-LF-COVERAGE-TYPE = 'L'
 16434                 MOVE '2'       TO CP-EARNING-METHOD
 16435              ELSE
 16436                 IF (PB-CI-LF-TERM > +60) OR
 16437                    (WS-LF-EARNINGS-CALC = '5')
 16438                    IF CP-CRITICAL-PERIOD
 16439                       MOVE '2'  TO CP-EARNING-METHOD
 16440                    ELSE
 16441                       MOVE '6'  TO CP-EARNING-METHOD
 16442                    END-IF
 16443                 ELSE
 16444                    MOVE '1'     TO CP-EARNING-METHOD
 16445                 END-IF
 16446              END-IF
 16447           END-IF
 16448        END-IF
 16449     END-IF
 16450
 16451*    IF CP-STATE-STD-ABBRV = 'VA'
 16452*       IF DC-GREG-DATE-CYMD GREATER 19921231
 16453*          IF CP-ORIGINAL-TERM GREATER 61
 16454*             MOVE '6' TO CP-EARNING-METHOD
 16455*          ELSE
 16456*             MOVE '1' TO CP-EARNING-METHOD.
 16457
 16458     IF WS-DEFAULT-APR NOT NUMERIC
 16459         MOVE ZEROS TO WS-DEFAULT-APR.
 16460     IF CP-EARN-AS-NET-PAY
 16461         IF CP-LOAN-APR NOT GREATER THAN ZEROS
 16462            IF WS-DEFAULT-APR GREATER THAN ZEROS
 16463                MOVE WS-DEFAULT-APR
 16464                                 TO  CP-LOAN-APR
 16465                MOVE ER-3780     TO  WS-ERROR
 16466                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 16467            ELSE
 16468                MOVE ER-3781     TO  WS-ERROR
 16469                PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
 16470     MOVE PB-C-CANCEL-REASON     TO CP-CANCEL-REASON
 16471     IF PB-COMPANY-ID = 'DCC'
 16472        AND CP-CANCEL-REASON = 'R'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 298
* EL050.cbl
 16473        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16474        MOVE WS-ADMIN-FEES       TO CP-DDF-ADMIN-FEES
 16475     END-IF
 16476     IF PB-COMPANY-ID = 'DCC'
 16477        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16478        AND (CP-EARNING-METHOD = 'D')
 16479        AND (CP-CANCEL-REASON NOT = 'R')
 16480        CONTINUE
 16481     ELSE
 16482        GO TO 3750-CONTINUE
 16483     END-IF
 16484     MOVE ' '                    TO DD-IU-SW
 16485     IF NOT PDEF-MASTER-FOUND
 16486        MOVE ' '                 TO PDEF-MASTER-SW
 16487        MOVE PB-COMPANY-CD       TO ERPDEF-KEY
 16488        MOVE PB-STATE            TO ERPDEF-STATE
 16489        IF AM-DCC-CLP-STATE NOT = PB-STATE AND SPACES
 16490           MOVE AM-DCC-CLP-STATE TO ERPDEF-STATE
 16491        END-IF
 16492        MOVE AM-DCC-PRODUCT-CODE TO ERPDEF-PROD-CD
 16493        MOVE 'A'                 TO ERPDEF-BEN-TYPE
 16494        MOVE PB-CI-AH-BENEFIT-CD TO ERPDEF-BEN-CODE
 16495        MOVE PB-CERT-EFF-DT      TO ERPDEF-EXP-DT
 16496        MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 16497        PERFORM 8587-START-ERPDEF THRU 8587-EXIT
 16498        IF PDEF-MASTER-FOUND
 16499           MOVE 'N'              TO PDEF-MASTER-SW
 16500           PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16501           IF PDEF-MASTER-FOUND
 16502              IF (ERPDEF-KEY-SAVE (1:16) =
 16503                           PD-CONTROL-PRIMARY (1:16))
 16504                 AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16505                 CONTINUE
 16506              ELSE
 16507                 PERFORM 8588-READ-ERPDEF THRU 8588-EXIT
 16508                 IF (ERPDEF-KEY-SAVE (1:16) =
 16509                           PD-CONTROL-PRIMARY (1:16))
 16510                    AND (PB-CERT-EFF-DT < PD-PROD-EXP-DT)
 16511                    CONTINUE
 16512                 ELSE
 16513                    MOVE ER-2740 TO WS-ERROR
 16514                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16515                    GO TO 3770-CHECK-REFUNDS
 16516                 END-IF
 16517              END-IF
 16518           END-IF
 16519           PERFORM 8589-ENDBR-ERPDEF THRU 8589-EXIT
 16520        END-IF
 16521     END-IF
 16522     IF PDEF-MASTER-FOUND
 16523        PERFORM VARYING V1 FROM +1 BY +1 UNTIL
 16524           (V1 > +8)
 16525           OR (PD-PROD-CODE (V1) = 'I')
 16526        END-PERFORM
 16527        IF V1 < +9
 16528           SET DD-IU-PRESENT        TO TRUE
 16529        END-IF
 16530        IF WS-AH-DCC-TRUNC = 'T'
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 299
* EL050.cbl
 16531           MOVE PB-CI-LOAN-TERM     TO WS-TERM
 16532        ELSE
 16533           MOVE CP-ORIGINAL-TERM    TO WS-TERM
 16534        END-IF
 16535        EVALUATE TRUE
 16536           WHEN WS-TERM > +168
 16537              MOVE 15               TO V1
 16538           WHEN WS-TERM > +156
 16539              MOVE 14               TO V1
 16540           WHEN WS-TERM > +144
 16541              MOVE 13               TO V1
 16542           WHEN WS-TERM > +132
 16543              MOVE 12               TO V1
 16544           WHEN WS-TERM > +120
 16545              MOVE 11               TO V1
 16546           WHEN WS-TERM > +108
 16547              MOVE 10               TO V1
 16548           WHEN WS-TERM > +96
 16549              MOVE 9                TO V1
 16550           WHEN WS-TERM > +84
 16551              MOVE 8                TO V1
 16552           WHEN WS-TERM > +72
 16553              MOVE 7                TO V1
 16554           WHEN WS-TERM > +60
 16555              MOVE 6                TO V1
 16556           WHEN WS-TERM > +48
 16557              MOVE 5                TO V1
 16558           WHEN WS-TERM > +36
 16559              MOVE 4                TO V1
 16560           WHEN WS-TERM > +24
 16561              MOVE 3                TO V1
 16562           WHEN WS-TERM > +12
 16563              MOVE 2                TO V1
 16564           WHEN OTHER
 16565              MOVE 1                TO V1
 16566        END-EVALUATE
 16567
 16568        EVALUATE TRUE
 16569*          WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM)
 16570*             < +13)
 16571*             AND (DD-IU-PRESENT)
 16572*             MOVE 2                TO V2
 16573*          WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +13
 16574*             MOVE 1                TO V2
 16575           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +25
 16576              MOVE 2                TO V2
 16577           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +37
 16578              MOVE 3                TO V2
 16579           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +49
 16580              MOVE 4                TO V2
 16581           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +61
 16582              MOVE 5                TO V2
 16583           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +73
 16584              MOVE 6                TO V2
 16585           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +85
 16586              MOVE 7                TO V2
 16587           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +97
 16588              MOVE 8                TO V2
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 300
* EL050.cbl
 16589           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +109
 16590              MOVE 9                TO V2
 16591           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +121
 16592              MOVE 10               TO V2
 16593           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +133
 16594              MOVE 11               TO V2
 16595           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +145
 16596              MOVE 12               TO V2
 16597           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +157
 16598              MOVE 13               TO V2
 16599           WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < +169
 16600              MOVE 14               TO V2
 16601           WHEN OTHER
 16602              MOVE 15               TO V2
 16603        END-EVALUATE
 16604
 16605        MOVE PD-UEP-FACTOR (V1 V2 + 1)
 16606                                 TO CP-DDF-LO-FACT
 16607        MOVE PD-UEP-FACTOR (V1 V2)
 16608                                 TO CP-DDF-HI-FACT
 16609
 16610        MOVE PD-1ST-YR-ADMIN-ALLOW TO CP-DDF-YR1AF
 16611        MOVE CM-AH-CLP     TO CP-DDF-CLP
 16612        COMPUTE WS-COMM-AND-MFEE = WS-COMM-AND-MFEE +
 16613           (CM-AH-PREMIUM-AMT - CM-AH-CLP - CM-ADDL-CLP)
 16614        MOVE WS-COMM-AND-MFEE TO CP-DDF-COMM-AND-MFEE
 16615        MOVE WS-CSO-ADMIN-FEE TO CP-DDF-CSO-ADMIN-FEE
 16616        COMPUTE CP-1ST-YR-ALLOW = WS-1ST-YR-ALLOW
 16617           + PD-1ST-YR-ADMIN-ALLOW
 16618
 16619        MOVE 'G'                 TO CP-DDF-SPEC-CALC
 16620*       IF PI-CLP-YN = 'Y'
 16621*          MOVE 'C'              TO CP-DDF-SPEC-CALC
 16622*          MOVE CM-AH-CLP        TO CP-ORIGINAL-PREMIUM
 16623*          MOVE ZEROS            TO CP-DDF-ADDL-CLP
 16624*       END-IF
 16625
 16626        IF DD-IU-PRESENT
 16627           MOVE 'I'              TO CP-EARNING-METHOD
 16628        END-IF
 16629        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16630                                     CP-CLP-RATE-UP
 16631        IF CP-IU-RATE-UP NOT = ZEROS
 16632           COMPUTE WS-WORK-FACT = 1 - (CM-ADDL-CLP
 16633              + CM-AH-CLP) / CP-ORIGINAL-PREMIUM
 16634           COMPUTE CP-IU-RATE-UP = CP-IU-RATE-UP
 16635              / (1 - WS-WORK-FACT)
 16636        END-IF
 16637     END-IF
 16638     .
 16639 3750-CONTINUE.
 16640     PERFORM 7600-GET-REFUND THRU 7600-EXIT.
 16641
 16642     IF CP-REFUND-TYPE-USED NOT = SPACE
 16643         MOVE CP-REFUND-TYPE-USED TO PB-AH-REFUND-TYPE.
 16644
 16645     IF CP-ERROR-RATE-IS-ZERO OR
 16646        CP-ERROR-RATE-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 301
* EL050.cbl
 16647        MOVE ER-2740             TO WS-ERROR
 16648        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16649
 16650     IF CP-ERROR-RATE-FILE-NOTOPEN
 16651        MOVE ER-2617             TO WS-ERROR
 16652        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16653     IF PB-COMPANY-ID = 'DCC'
 16654        AND PB-CI-ENTRY-STATUS = 'M'
 16655        MOVE +0                  TO PB-C-AH-REF-CALC
 16656     ELSE
 16657        MOVE CP-CALC-REFUND      TO PB-C-AH-REF-CALC
 16658     END-IF
 16659     IF PB-COMPANY-ID = 'DCC'
 16660        AND (WS-AH-BEN-CATEGORY = 'G' OR 'L')
 16661        AND (CP-EARNING-METHOD = 'D' OR 'I')
 16662        MOVE PB-CI-DDF-IU-RATE-UP TO CP-IU-RATE-UP
 16663        MOVE 'C'                 TO CP-DDF-SPEC-CALC
 16664        MOVE CM-AH-CLP           TO CP-ORIGINAL-PREMIUM
 16665        MOVE ZEROS               TO CP-1ST-YR-ALLOW
 16666        PERFORM 7600-GET-REFUND  THRU 7600-EXIT
 16667        MOVE CP-CALC-REFUND      TO PB-C-AH-RFND-CLP
 16668*       DISPLAY ' CALC CLP   ' CP-CALC-REFUND
 16669     END-IF
 16670     GO TO 3770-CHECK-REFUNDS.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 302
* EL050.cbl
 16672
 16673 3770-CHECK-REFUNDS.
 16674
 16675     IF PB-CI-LF-CANCEL-AMT NOT = ZERO
 16676        IF PB-C-LF-CANCEL-VOID-SW = SPACE
 16677           MOVE ER-2766          TO WS-ERROR
 16678           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16679           SUBTRACT PB-CI-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 16680           IF PB-C-LF-REF-CALC LESS THAN ZERO
 16681              MOVE ZEROS         TO PB-C-LF-REF-CALC.
 16682
 16683     IF PB-CI-AH-CANCEL-AMT NOT = ZERO
 16684        IF PB-C-AH-CANCEL-VOID-SW = SPACE
 16685           MOVE ER-2766          TO WS-ERROR
 16686           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16687           SUBTRACT PB-CI-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 16688           IF PB-C-AH-REF-CALC LESS THAN ZERO
 16689              MOVE ZEROS         TO PB-C-AH-REF-CALC.
 16690
 16691     IF PB-COMP-LF-CANCEL
 16692        MOVE PB-C-LF-REF-CALC    TO PB-C-LF-CANCEL-AMT
 16693        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16694           IF PB-C-LF-CANCEL-AMT LESS THAN +1.00
 16695              MOVE +0            TO  PB-C-LF-CANCEL-AMT.
 16696
 16697     IF PB-COMP-AH-CANCEL
 16698        MOVE PB-C-AH-REF-CALC    TO PB-C-AH-CANCEL-AMT
 16699        IF PB-COMPANY-ID  =  'FIA' OR 'UAL'
 16700           IF PB-C-AH-CANCEL-AMT LESS THAN +1.00
 16701              MOVE +0            TO  PB-C-AH-CANCEL-AMT.
 16702
 16703     SUBTRACT PB-C-LF-REF-CALC FROM PB-C-LF-CANCEL-AMT
 16704             GIVING WS-UNSIGN-WRK1
 16705     SUBTRACT PB-C-AH-REF-CALC FROM PB-C-AH-CANCEL-AMT
 16706             GIVING WS-UNSIGN-WRK2.
 16707
 16708     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16709         MOVE ZERO TO WS-UNSIGN-WRK1.
 16710
 16711     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 16712         MOVE ZERO TO WS-UNSIGN-WRK2.
 16713
 16714     ADD WS-UNSIGN-WRK1 WS-UNSIGN-WRK2 GIVING WS-UNSIGN-WRK3.
 16715
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 303
* EL050.cbl
 16717
 16718 3772-CONTINUE.
 16719
 16720**********************************
 16721*** UNSIGN-WRK3 SHOULD CHECK IF GREATER THAN LF-REFUND TOLERANCE
 16722*** ONLY.  ADDING LF-REFUND TOLERANCE AND AH-REFUND TOLERANCE
 16723*** DOUBLES THE TOLERANCE AMOUNT.
 16724***    CHANGED ONLY FOR MON NOW, BUT SHOULD BE IN EFFECT FOR ALL.
 16725**********************************
 16726     IF PB-COMPANY-ID = 'MON' or 'CID' or 'DCC' or 'CAP'
 16727     IF WS-UNSIGN-WRK3 >= WS-TOL-LF-REFUND
 16728         IF WS-REF-REJECT-SW = SPACE
 16729             MOVE ER-2754        TO WS-ERROR
 16730             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16731           ELSE
 16732             MOVE ER-2736        TO WS-ERROR
 16733             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16734**********************************
 16735
 16736 3773-CONTINUE.
 16737
 16738     IF PB-C-LF-CANCEL-AMT GREATER THAN +0
 16739        IF PB-C-LF-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16740           MOVE ER-2723          TO WS-ERROR
 16741           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16742
 16743     IF PB-C-AH-CANCEL-AMT GREATER THAN +0
 16744        IF PB-C-AH-CANCEL-AMT    LESS THAN WS-MINIMUM-REFUND
 16745           MOVE ER-2724          TO WS-ERROR
 16746           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16747
 16748     IF WS-LF-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16749         COMPUTE WS-TOL-LF-HIGH-PREM-PCT = PB-C-LF-REF-CALC *
 16750             (1 + WS-LF-REFUND-OVS-PCT)
 16751     ELSE
 16752         MOVE +9999999.99        TO  WS-TOL-LF-HIGH-PREM-PCT.
 16753
 16754     IF WS-TOL-LF-REFUND-PCT IS GREATER THAN ZEROS
 16755         COMPUTE WS-TOL-LF-LOW-PREM-PCT  = PB-C-LF-REF-CALC *
 16756             (1 - WS-TOL-LF-REFUND-PCT)
 16757     ELSE
 16758         MOVE +0                 TO  WS-TOL-LF-LOW-PREM-PCT.
 16759
 16760     IF (PB-COMPANY-ID = 'DCC')
 16761        AND (PB-CI-ENTRY-STATUS = 'M')
 16762        AND (PB-C-LF-CANCEL-AMT > +0)
 16763        MOVE ER-3843             TO WS-ERROR
 16764        PERFORM 9900-ERROR-FORMAT
 16765                                 THRU 9900-EXIT
 16766     END-IF
 16767     EVALUATE TRUE
 16768        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16769           CONTINUE
 16770        WHEN PB-C-LF-CANCEL-AMT = +0
 16771                 AND PB-C-LF-REF-CALC > +0
 16772           CONTINUE
 16773        WHEN WS-LF-REFUND-OVS-AMT = 0
 16774                 AND WS-TOL-LF-REFUND = 0
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 304
* EL050.cbl
 16775           CONTINUE
 16776        WHEN OTHER
 16777           IF WS-TOL-LF-REFUND  = +0
 16778              MOVE PB-C-LF-REF-CALC TO WS-TOL-LF-REFUND
 16779           END-IF
 16780           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16781                (PB-C-LF-REF-CALC - WS-TOL-LF-REFUND ) <
 16782                          (PB-C-LF-CANCEL-AMT))
 16783              CONTINUE
 16784           ELSE
 16785              IF WS-LF-REFUND-OVS-AMT = +0
 16786                 MOVE +9999999.99      TO WS-LF-REFUND-OVS-AMT
 16787              END-IF
 16788              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16789                  (PB-C-LF-REF-CALC + WS-LF-REFUND-OVS-AMT) >
 16790                                       PB-C-LF-CANCEL-AMT)
 16791                 CONTINUE
 16792              ELSE
 16793                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16794                   MOVE ER-2754   TO  WS-ERROR
 16795                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16796                 ELSE
 16797                    MOVE ER-2736   TO  WS-ERROR
 16798                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16799                 END-IF
 16800              END-IF
 16801           END-IF
 16802     END-EVALUATE.
 16803
 16804     EVALUATE TRUE
 16805        WHEN (PB-C-LF-REF-CALC = PB-C-LF-CANCEL-AMT)
 16806           CONTINUE
 16807        WHEN PB-C-LF-CANCEL-AMT = +0
 16808                 AND PB-C-LF-REF-CALC > +0
 16809           CONTINUE
 16810        WHEN OTHER
 16811           IF ((PB-C-LF-REF-CALC > PB-C-LF-CANCEL-AMT) AND
 16812               (PB-C-LF-CANCEL-AMT > WS-TOL-LF-LOW-PREM-PCT))
 16813              CONTINUE
 16814           ELSE
 16815              IF ((PB-C-LF-REF-CALC < PB-C-LF-CANCEL-AMT) AND
 16816               (PB-C-LF-CANCEL-AMT < WS-TOL-LF-HIGH-PREM-PCT))
 16817                CONTINUE
 16818              ELSE
 16819                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16820                     MOVE ER-2754   TO  WS-ERROR
 16821                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16822                 ELSE
 16823                     MOVE ER-2736   TO  WS-ERROR
 16824                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16825                 END-IF
 16826              END-IF
 16827           END-IF
 16828     END-EVALUATE.
 16829
 16830     IF WS-AH-REFUND-OVS-PCT IS GREATER THAN ZEROS
 16831         COMPUTE WS-TOL-AH-HIGH-PREM-PCT = PB-C-AH-REF-CALC *
 16832             (1 + WS-AH-REFUND-OVS-PCT)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 305
* EL050.cbl
 16833     ELSE
 16834         MOVE +9999999.99        TO  WS-TOL-AH-HIGH-PREM-PCT.
 16835
 16836     IF WS-TOL-AH-REFUND-PCT GREATER THAN ZEROS
 16837         COMPUTE WS-TOL-AH-LOW-PREM-PCT  = PB-C-AH-REF-CALC *
 16838             (1 - WS-TOL-AH-REFUND-PCT)
 16839     ELSE
 16840         MOVE +0                 TO  WS-TOL-AH-LOW-PREM-PCT.
 16841
 16842     IF (PB-COMPANY-ID = 'DCC')
 16843        AND (PB-CI-ENTRY-STATUS = 'M')
 16844        AND (PB-C-AH-CANCEL-AMT > +0)
 16845        MOVE ER-3843             TO WS-ERROR
 16846        PERFORM 9900-ERROR-FORMAT
 16847                                 THRU 9900-EXIT
 16848     END-IF
 16849     EVALUATE TRUE
 16850        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
 16851           CONTINUE
 16852*       WHEN PB-C-AH-REF-CALC = +0 AND
 16853*                  PB-C-AH-CANCEL-AMT > +0
 16854        WHEN PB-C-AH-CANCEL-AMT = +0 AND
 16855                   PB-C-AH-REF-CALC > +0
 16856           CONTINUE
 16857        WHEN WS-AH-REFUND-OVS-AMT = +0
 16858                AND WS-TOL-AH-REFUND = +0
 16859           CONTINUE
 16860        WHEN OTHER
 16861           IF WS-TOL-AH-REFUND = +0
 16862              MOVE PB-C-AH-REF-CALC TO WS-TOL-AH-REFUND
 16863           END-IF
 16864           IF ((PB-C-AH-REF-CALC > PB-C-AH-CANCEL-AMT) AND
 16865               (PB-C-AH-REF-CALC - WS-TOL-AH-REFUND) <
 16866                                         PB-C-AH-CANCEL-AMT)
 16867              CONTINUE
 16868           ELSE
 16869              IF WS-AH-REFUND-OVS-AMT = +0
 16870                 MOVE +9999999.99 TO
 16871                         WS-AH-REFUND-OVS-AMT
 16872              END-IF
 16873              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16874                  (PB-C-AH-REF-CALC + WS-AH-REFUND-OVS-AMT) >
 16875                                         PB-C-AH-CANCEL-AMT)
 16876                 CONTINUE
 16877              ELSE
 16878                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16879                    MOVE ER-2754   TO  WS-ERROR
 16880                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16881                 ELSE
 16882                    MOVE ER-2736   TO  WS-ERROR
 16883                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16884                 END-IF
 16885              END-IF
 16886           END-IF
 16887     END-EVALUATE.
 16888
 16889     EVALUATE TRUE
 16890        WHEN (PB-C-AH-REF-CALC = PB-C-AH-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 306
* EL050.cbl
 16891           CONTINUE
 16892*       WHEN PB-C-AH-REF-CALC > +0 AND
 16893*                  PB-C-AH-CANCEL-AMT = +0
 16894        WHEN PB-C-AH-CANCEL-AMT > +0 AND
 16895                   PB-C-AH-REF-CALC = +0
 16896           CONTINUE
 16897        WHEN OTHER
 16898           IF ((PB-C-AH-REF-CALC >  PB-C-AH-CANCEL-AMT) AND
 16899               (PB-C-AH-CANCEL-AMT > WS-TOL-AH-LOW-PREM-PCT))
 16900              CONTINUE
 16901           ELSE
 16902              IF ((PB-C-AH-REF-CALC < PB-C-AH-CANCEL-AMT) AND
 16903                (PB-C-AH-CANCEL-AMT < WS-TOL-AH-HIGH-PREM-PCT))
 16904                 CONTINUE
 16905              ELSE
 16906                 IF WS-REF-REJECT-SW IS EQUAL TO SPACE
 16907                     MOVE ER-2754   TO  WS-ERROR
 16908                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16909                 ELSE
 16910                     MOVE ER-2736   TO  WS-ERROR
 16911                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16912                 END-IF
 16913              END-IF
 16914           END-IF
 16915     END-EVALUATE.
 16916
 16917     IF (PB-C-LF-CANCEL-AMT = ZERO)
 16918        AND (PB-C-AH-CANCEL-AMT = ZERO)
 16919        IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16920           AND  PB-C-LF-REF-CALC < +1.00
 16921           AND  PB-C-AH-REF-CALC < +1.00
 16922           CONTINUE
 16923        ELSE
 16924           IF (PB-COMPANY-ID = 'DCC')
 16925              AND (PB-CI-ENTRY-STATUS = 'M')
 16926              CONTINUE
 16927           ELSE
 16928              MOVE ER-2741       TO WS-ERROR
 16929              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16930           END-IF
 16931        END-IF
 16932     END-IF
 16933
 16934     IF (PB-C-LF-CANCEL-AMT = ZERO
 16935        AND WS-LF-BENEFIT-CD NOT = ZERO
 16936        AND NOT PB-CI-LF-DEATH-CLAIM-APPLIED
 16937        AND PB-C-LF-REF-CALC NOT = ZERO)
 16938        OR
 16939        (PB-C-LF-CANCEL-AMT = ZERO
 16940        AND WS-LF-BENEFIT-CD NOT = ZERO
 16941        AND PB-C-LF-CANCEL-DT = LOW-VALUES)
 16942             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16943                AND PB-C-LF-REF-CALC LESS THAN +1.00
 16944                NEXT SENTENCE
 16945             ELSE
 16946                MOVE ER-2739        TO WS-ERROR
 16947                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16948
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 307
* EL050.cbl
 16949     IF (PB-C-AH-CANCEL-AMT = ZERO
 16950        AND WS-AH-BENEFIT-CD NOT = ZERO
 16951        AND NOT PB-CI-AH-LUMP-SUM-DISAB
 16952        AND PB-C-AH-REF-CALC NOT = ZERO)
 16953        OR
 16954        (PB-C-AH-CANCEL-AMT = ZERO
 16955        AND WS-AH-BENEFIT-CD NOT = ZERO
 16956        AND PB-C-AH-CANCEL-DT = LOW-VALUES)
 16957             IF (PB-COMPANY-ID = 'FIA' OR 'UAL')
 16958                AND PB-C-AH-REF-CALC LESS THAN +1.00
 16959                NEXT SENTENCE
 16960             ELSE
 16961                MOVE ER-2738        TO WS-ERROR
 16962                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16963
 16964 3775-OVER-REF-CHK.
 16965
 16966     IF PB-CI-ENTRY-STATUS = '5'
 16967        GO TO 3780-UPDATE-CANCEL-CERT.
 16968
 16969     COMPUTE WS-UNSIGN-WRK1 = PB-CI-LF-PREMIUM-AMT +
 16970                              PB-CI-LF-ALT-PREMIUM-AMT.
 16971
 16972     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 16973        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16974                                 PB-C-LF-REF-CALC
 16975      ELSE
 16976        COMPUTE WS-UNSIGN-WRK2 = PB-CI-LF-CANCEL-AMT +
 16977                                 PB-C-LF-CANCEL-AMT.
 16978
 16979     IF WS-UNSIGN-WRK2 GREATER THAN WS-UNSIGN-WRK1
 16980        MOVE ER-2755             TO WS-ERROR
 16981        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16982
 16983     MOVE PB-CI-AH-PREMIUM-AMT   TO WS-UNSIGN-WRK1.
 16984
 16985     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 16986        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16987                                 PB-C-AH-REF-CALC
 16988      ELSE
 16989        COMPUTE WS-UNSIGN-WRK3 = PB-CI-AH-CANCEL-AMT +
 16990                                 PB-C-AH-CANCEL-AMT.
 16991
 16992     IF WS-UNSIGN-WRK3 GREATER THAN WS-UNSIGN-WRK1
 16993        MOVE ER-2778             TO WS-ERROR
 16994        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16995
 16996     IF PB-CI-OB-FLAG NOT = 'Z'
 16997        NEXT SENTENCE
 16998       ELSE
 16999         IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17000            MOVE ER-2757           TO WS-ERROR
 17001            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17002
 17003 3780-UPDATE-CANCEL-CERT.
 17004
 17005     IF PB-CI-CREDIT-INTERFACE-SW-1 = '1'
 17006        MOVE ER-2728              TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 308
* EL050.cbl
 17007        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17008
 17009     IF PB-CI-CREDIT-INTERFACE-SW-1 = '2'
 17010         MOVE ER-2729              TO WS-ERROR
 17011         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17012
 17013     IF PB-CI-LF-BENEFIT-CD = ZERO
 17014         GO TO 3780-UPDATE-CONT-1.
 17015
 17016     IF PB-C-LF-CANCEL-DT = LOW-VALUE
 17017         GO TO 3780-UPDATE-CONT-1.
 17018
 17019     IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17020       AND
 17021        (PB-C-LF-CANCEL-AMT NEGATIVE)
 17022       AND
 17023        (PB-CI-LF-POLICY-STATUS NOT = '6' AND '7')
 17024       AND
 17025        ((PB-C-LF-CANCEL-AMT + PB-CI-LF-CANCEL-AMT) = ZERO)
 17026            NEXT SENTENCE
 17027       ELSE
 17028        IF (PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17029          AND
 17030***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17031***       AND
 17032           (PB-CI-LF-PRIOR-CANCEL-DT NOT = PB-C-LF-CANCEL-DT)
 17033            IF PB-C-LF-CANCEL-VOID-SW = SPACE
 17034               MOVE ER-2730      TO WS-ERROR
 17035               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17036               GO TO 3999-END-EDIT
 17037            ELSE
 17038               GO TO 3999-END-EDIT
 17039        ELSE
 17040            IF PB-CI-LF-PRIOR-CANCEL-DT = PB-C-LF-CANCEL-DT
 17041               MOVE ER-2765           TO WS-ERROR
 17042               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17043               GO TO 3785-CHECK-NH.
 17044*              GO TO 3999-END-EDIT.
 17045
 17046 3780-UPDATE-CONT-1.
 17047     MOVE 'N' TO WS-AH-CLAIM-RESCINDED
 17048
 17049     IF PB-CI-AH-BENEFIT-CD = ZERO
 17050         GO TO 3780-UPDATE-CONT-2.
 17051
 17052     IF PB-C-AH-CANCEL-DT = LOW-VALUE
 17053         GO TO 3780-UPDATE-CONT-2.
 17054
 17055     PERFORM 7250-LOOK-FOR-RESCINDED-CLAIM THRU 7250-EXIT.
 17056
 17057     IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17058       AND
 17059        (PB-C-AH-CANCEL-AMT NEGATIVE)
 17060       AND
 17061        (PB-CI-AH-POLICY-STATUS NOT = '6' AND '7')
 17062       AND
 17063        ((PB-C-AH-CANCEL-AMT + PB-CI-AH-CANCEL-AMT) = ZERO)
 17064            NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 309
* EL050.cbl
 17065       ELSE
 17066        IF (PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE)
 17067          AND
 17068***        (PB-CI-CREDIT-INTERFACE-SW-2 NOT = '1' AND '3' AND '4')
 17069***       AND
 17070           (PB-CI-AH-PRIOR-CANCEL-DT NOT = PB-C-AH-CANCEL-DT)
 17071           IF WS-AH-CLAIM-RESCINDED <> 'Y'
 17072            IF PB-C-AH-CANCEL-VOID-SW = SPACE
 17073               MOVE ER-2773      TO WS-ERROR
 17074               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17075               GO TO 3999-END-EDIT
 17076            ELSE
 17077               GO TO 3999-END-EDIT
 17078            END-IF
 17079           ELSE
 17080             IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17081                IF MSTR-CERT-NO = W-CL-CERT-NO
 17082                   MOVE ER-2890 TO WS-ERROR
 17083                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17084                   GO TO 3999-END-EDIT
 17085                ELSE
 17086                   MOVE ER-2898 TO WS-ERROR
 17087                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17088                   GO TO 3999-END-EDIT
 17089                END-IF
 17090             ELSE
 17091                GO TO 3785-CHECK-NH
 17092             END-IF
 17093           END-IF
 17094          ELSE
 17095            IF PB-CI-AH-PRIOR-CANCEL-DT = PB-C-AH-CANCEL-DT
 17096              IF WS-AH-CLAIM-RESCINDED = 'Y'
 17097                IF PB-C-AH-CANCEL-DT <> PB-CERT-EFF-DT
 17098                   IF MSTR-CERT-NO = W-CL-CERT-NO
 17099                      MOVE ER-2890 TO WS-ERROR
 17100                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17101                      GO TO 3999-END-EDIT
 17102                   ELSE
 17103                      MOVE ER-2898 TO WS-ERROR
 17104                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17105                      GO TO 3999-END-EDIT
 17106                   END-IF
 17107                ELSE
 17108                   MOVE ER-2765 TO WS-ERROR
 17109                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17110                   GO TO 3785-CHECK-NH
 17111                END-IF
 17112              ELSE
 17113               MOVE ER-2765      TO WS-ERROR
 17114               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17115               GO TO 3785-CHECK-NH.
 17116*              GO TO 3999-END-EDIT.
 17117
 17118 3780-UPDATE-CONT-2.
 17119
 17120     IF PB-C-LF-CANCEL-AMT NOT = ZERO
 17121        AND WS-LF-BENEFIT-CD = ZERO
 17122           MOVE ER-2743           TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 310
* EL050.cbl
 17123           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17124
 17125     IF PB-C-AH-CANCEL-AMT NOT = ZERO
 17126        AND WS-AH-BENEFIT-CD = ZERO
 17127           MOVE ER-2744           TO WS-ERROR
 17128           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17129
 17130     IF ((PB-C-LF-CANCEL-AMT NEGATIVE) OR
 17131        (PB-C-AH-CANCEL-AMT NEGATIVE))
 17132        AND
 17133        ((PB-CI-LF-POLICY-STATUS = '6' OR '7') OR
 17134         (PB-CI-AH-POLICY-STATUS = '6' OR '7'))
 17135           MOVE ER-2746           TO WS-ERROR
 17136           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17137
 17138     IF (PB-C-LF-CANCEL-AMT NEGATIVE)
 17139       AND
 17140        (PB-C-LF-CANCEL-VOID-SW NOT = '1')
 17141             MOVE ER-2737        TO WS-ERROR
 17142             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17143
 17144     IF (PB-C-AH-CANCEL-AMT NEGATIVE)
 17145       AND
 17146        (PB-C-AH-CANCEL-VOID-SW NOT = '1')
 17147             MOVE ER-2737        TO WS-ERROR
 17148             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17149
 17150     IF  CM-CLAIM-ATTACHED-COUNT GREATER +0
 17151         IF  PB-COMPANY-ID = 'HAN' OR 'JHL' OR 'CVL' OR 'CNL'
 17152             OR 'CID' OR 'DCC' OR 'AHL'
 17153             PERFORM 7300-CHECK-FOR-OPEN-CLMS THRU 7300-EXIT
 17154         ELSE
 17155             IF PB-COMPANY-ID = 'FIA' OR 'MTL'
 17156                 MOVE ER-2768    TO WS-ERROR
 17157                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17158             ELSE
 17159                 MOVE ER-2756    TO WS-ERROR
 17160                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17161
 17162     IF CERT-PEND-ISSUE-RETURNED
 17163        MOVE ER-2772             TO WS-ERROR
 17164        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17165 3785-CHECK-NH.
 17166     IF PB-STATE NOT = 'NH'
 17167        GO TO 3999-END-EDIT
 17168     END-IF
 17169
 17170     MOVE ER-2796                TO WS-ERROR
 17171     PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
 17172     IF (PB-C-REF-INTERFACE-SW = 'Y')
 17173        OR (CM-NH-INTERFACE-SW = 'Y')
 17174        MOVE ER-2793             TO WS-ERROR
 17175        PERFORM 9900-ERROR-FORMAT
 17176                                 THRU 9900-EXIT
 17177     END-IF
 17178     MOVE +0                     TO WS-PAYMENT-AMT
 17179     IF PB-CERT-EFF-DT = PB-C-LF-CANCEL-DT OR PB-C-AH-CANCEL-DT
 17180        GO TO 3999-END-EDIT
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 311
* EL050.cbl
 17181     END-IF
 17182     IF (PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) = ZEROS
 17183        GO TO 3999-END-EDIT
 17184     END-IF
 17185     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
 17186     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-2
 17187     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-2
 17188        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
 17189     END-IF
 17190     MOVE '1'                    TO DC-OPTION-CODE
 17191     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17192     IF NO-CONVERSION-ERROR
 17193        IF DC-ELAPSED-DAYS < +16
 17194           GO TO 3999-END-EDIT
 17195        END-IF
 17196     END-IF
 17197     MOVE +0                     TO DC-ELAPSED-DAYS
 17198     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1
 17199     MOVE WS-CURRENT-BIN-DT      TO DC-BIN-DATE-2
 17200     MOVE '1'                    TO DC-OPTION-CODE
 17201     PERFORM 8500-DATE-CONVERT   THRU 8500-EXIT
 17202     IF NO-CONVERSION-ERROR
 17203        IF DC-ELAPSED-DAYS > +30
 17204           COMPUTE DC-ELAPSED-DAYS = (DC-ELAPSED-DAYS - +30) + +15
 17205        ELSE
 17206           GO TO 3999-END-EDIT
 17207        END-IF
 17208     ELSE
 17209        GO TO 3999-END-EDIT
 17210     END-IF
 17211     COMPUTE WS-PAYMENT-AMT ROUNDED =
 17212        ((PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT) *
 17213           (1.10 ** (DC-ELAPSED-DAYS / 365) - 1))
 17214     IF WS-PAYMENT-AMT < 600.00
 17215        GO TO 3999-END-EDIT
 17216     END-IF
 17217     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17218
 17219     IF (ERMAIL-FOUND = ' ')
 17220         AND (MA-INSURED-SOC-SEC-NO (1:9) NUMERIC)
 17221         AND (MA-INSURED-SOC-SEC-NO (1:9) NOT = ZEROS)
 17222        GO TO 3999-END-EDIT
 17223     END-IF
 17224     MOVE ER-2795                TO WS-ERROR
 17225     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 17226
 17227     GO TO 3999-END-EDIT.
 17228******************************************************************
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 312
* EL050.cbl
 17230 3990-FILES-NOT-OPEN.
 17231
 17232     MOVE ER-2617                TO WS-ERROR.
 17233     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17234     GO TO 9990-RETURN.
 17235
 17236 3999-END-EDIT.
 17237
 17238     MOVE CERTIFICATE-MASTER    TO ELCERT-SAVE.
 17239
 17240     IF PB-CANCELLATION AND CERT-WAS-FOUND
 17241         PERFORM 4000-UPDATE-CANCELLED-CERT THRU 4299-EXIT
 17242         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17243             PERFORM 9250-UNLOCK-RETURN
 17244             GO TO 9990-RETURN
 17245          ELSE
 17246             PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17247             GO TO 9990-RETURN.
 17248
 17249     IF PB-CANCELLATION
 17250          GO TO 9990-RETURN.
 17251
 17252     IF CERT-WAS-NOT-FOUND
 17253        MOVE SPACES              TO CERTIFICATE-MASTER.
 17254
 17255     PERFORM 4500-UPDATE-NEW-CERT THRU 4999-EXIT.
 17256
 17257     IF CERT-WAS-FOUND
 17258         IF CERTIFICATE-MASTER = ELCERT-SAVE
 17259             PERFORM 9250-UNLOCK-RETURN
 17260          ELSE
 17261            PERFORM 7800-REWRITE-CERT THRU 7800-EXIT
 17262      ELSE
 17263         PERFORM 8000-WRITE-CERT THRU 8000-EXIT.
 17264
 17265     IF PB-I-VIN NOT = SPACES AND LOW-VALUES AND ZEROS
 17266        IF ((PB-COMPANY-ID = 'DCC')
 17267           AND (PB-CARRIER = '2' OR '4' OR '6'))
 17268                         or
 17269            (pb-company-id = 'CID')
 17270            PERFORM 8180-UPDATE-VIN-NUMBER THRU 8180-EXIT
 17271        END-IF
 17272     END-IF.
 17273
 17274     IF WS-INS-AGE-SET = 'Y' OR WS-JNT-AGE-SET = 'Y'
 17275         PERFORM 8195-UPDATE-AGE-FLAGS THRU 8195-EXIT
 17276     END-IF.
 17277     move ' '                    to ws-ins-age-defaulted
 17278     perform 8150-read-elcrtt    thru 8150-exit
 17279     if ws-ins-age-defaulted = 'Y'
 17280        move er-1573             to ws-error
 17281        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17282     end-if
 17283
 17284     if ws-jnt-age-defaulted = 'Y'
 17285        move er-1574             to ws-error
 17286        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17287     end-if
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 313
* EL050.cbl
 17288***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17289***                                                           ****
 17290***  Set an error if the state requires verification of agent ****
 17291***  and agent hasn't verified yet and the status is not =    ****
 17292***  9,5,d and V and the term for lf or ah > 1 (not OB)       ****
 17293***  and the entry date > 09/01/2015.                         ****
 17294***                                                           ****
 17295***=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=_=****
 17296     if (pb-input-dt >= X'AD81')    *> 09/01/2015
 17297        and (pb-i-entry-status not = '5' and 'D' and 'V')
 17298        and (pb-account (9:2) not = 'OB')
 17299        if (ws-st-agent-sig-edit = 'Y')
 17300           and (am-report-code-1 not = 'CONLEY')
 17301           evaluate true
 17302              when cs-agent-edit-status = 'C'
 17303                 move er-1743    to ws-error
 17304                 perform 9900-error-format
 17305                                 thru 9900-exit
 17306              when cs-agent-edit-status = 'S'
 17307                 move er-1744    to ws-error
 17308                 perform 9900-error-format
 17309                                 thru 9900-exit
 17310              when cs-agent-edit-status = 'M'
 17311                 move er-1745    to ws-error
 17312                 perform 9900-error-format
 17313                                 thru 9900-exit
 17314              when cs-agent-edit-status = 'R'
 17315                 move er-1747    to ws-error
 17316                 perform 9900-error-format
 17317                                 thru 9900-exit
 17318              when cs-agent-edit-status = 'N'
 17319                 move er-1748    to ws-error
 17320                 perform 9900-error-format
 17321                                 thru 9900-exit
 17322              when cs-agent-edit-status <> 'V' and 'U' and
 17323                                           'R' and 'N'
 17324                 move er-1746    to ws-error
 17325                 perform 9900-error-format
 17326                                 thru 9900-exit
 17327           end-evaluate
 17328        end-if
 17329     end-if
 17330     MOVE ' '                    TO WS-SKIP-ADDR-EDIT-SW
 17331     IF ((PB-COMPANY-ID = 'DCC')
 17332        AND (WS-NO-SECURE-PAY))
 17333                  OR
 17334        (WS-LF-SPECIAL-CALC-CD = 'O'
 17335        OR WS-AH-SPECIAL-CALC-CD = 'O')
 17336        SET SKIP-ADDR-EDIT       TO TRUE
 17337     END-IF
 17338     IF (PB-I-MAIL-ADDRS-NOT-PRESENT)
 17339        AND (NOT SKIP-ADDR-EDIT)
 17340        MOVE ER-2963             TO WS-ERROR
 17341        PERFORM 9900-ERROR-FORMAT
 17342                                 THRU 9900-EXIT
 17343        GO TO 9990-RETURN
 17344     END-IF
 17345     PERFORM 8100-READ-ERPNDM THRU 8100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 314
* EL050.cbl
 17346     IF ERPNDM-FOUND NOT = 'X'
 17347        IF ((PM-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17348           OR (PM-CITY        = SPACES OR LOW-VALUES)
 17349           OR (PM-STATE       = SPACES OR LOW-VALUES)
 17350           OR (PM-ZIP         = SPACES OR LOW-VALUES))
 17351           AND (NOT SKIP-ADDR-EDIT)
 17352           MOVE ER-2694          TO WS-ERROR
 17353           PERFORM 9900-ERROR-FORMAT
 17354                                 THRU 9900-EXIT
 17355        END-IF
 17356        MOVE ' '                 TO STATE-RECORD-ERROR
 17357        MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17358        MOVE PM-STATE            TO CNTL-ACCESS
 17359        MOVE '3'                 TO CNTL-REC-TYPE
 17360        MOVE +0                  TO CNTL-SEQ-NO
 17361        MOVE '0'                 TO RC-SW-2
 17362        PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17363        IF (NO-STATE-RECORD)
 17364           OR (CF-RECORD-TYPE NOT = '3')
 17365           OR (PM-STATE NOT = CF-STATE-CODE)
 17366           IF (PM-STATE = SPACES)
 17367              AND (SKIP-ADDR-EDIT)
 17368              CONTINUE
 17369           ELSE
 17370              MOVE ER-2963       TO WS-ERROR
 17371              PERFORM 9900-ERROR-FORMAT
 17372                                 THRU 9900-EXIT
 17373           END-IF
 17374        END-IF
 17375        IF PM-CRED-BENE-NAME     = SPACES OR LOW-VALUES
 17376           MOVE ER-2883          TO WS-ERROR
 17377           PERFORM 9900-ERROR-FORMAT
 17378                                 THRU 9900-EXIT
 17379        END-IF
 17380        IF PM-CRED-BENE-STATE NOT = SPACES AND LOW-VALUES
 17381           MOVE ' '                 TO STATE-RECORD-ERROR
 17382           MOVE PB-COMPANY-ID       TO CNTL-COMP-ID
 17383           MOVE PM-CRED-BENE-STATE  TO CNTL-ACCESS
 17384           MOVE '3'                 TO CNTL-REC-TYPE
 17385           MOVE +0                  TO CNTL-SEQ-NO
 17386           MOVE '0'                 TO RC-SW-2
 17387           PERFORM 9100-READ-CONTROL THRU 9100-EXIT
 17388           IF NO-STATE-RECORD
 17389              OR (CF-RECORD-TYPE NOT = '3')
 17390              OR (PM-CRED-BENE-STATE NOT = CF-STATE-CODE)
 17391              MOVE ER-2964          TO WS-ERROR
 17392              PERFORM 9900-ERROR-FORMAT
 17393                                    THRU 9900-EXIT
 17394           END-IF
 17395        END-IF
 17396     ELSE
 17397        IF NOT SKIP-ADDR-EDIT
 17398           MOVE ER-2393          TO WS-ERROR
 17399           PERFORM 9900-ERROR-FORMAT
 17400                                 THRU 9900-EXIT
 17401        END-IF
 17402     END-IF
 17403
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 315
* EL050.cbl
 17404     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT.
 17405
 17406     IF (ERMAIL-FOUND = ' ' AND
 17407        ERPNDM-FOUND = ' ')
 17408        IF (MA-ACCESS-CONTROL = PM-ACCESS-CONTROL AND
 17409           MA-PROFILE-INFO = PM-PROFILE-INFO AND
 17410           MA-CRED-BENE-INFO = PM-CRED-BENE-INFO)
 17411          OR
 17412           (MA-LAST-MAINT-DT GREATER THAN PM-LAST-MAINT-DT)
 17413          OR
 17414           (MA-LAST-MAINT-DT = PM-LAST-MAINT-DT AND
 17415           MA-LAST-MAINT-HHMMSS GREATER THAN PM-LAST-MAINT-HHMMSS)
 17416           GO TO 3999-UNLOCK-ERMAIL.
 17417
 17418     IF ERPNDM-FOUND = 'X'
 17419        GO TO 3999-UNLOCK-ERMAIL.
 17420
 17421     IF PM-INSURED-LAST-NAME      = SPACES
 17422        AND PM-INSURED-FIRST-NAME = SPACES
 17423        AND PM-ADDRESS-LINE-1     = SPACES
 17424        AND PM-ADDRESS-LINE-2     = SPACES
 17425        AND PM-CITY-STATE         = SPACES
 17426        AND PM-CRED-BENE-NAME     = SPACES
 17427        AND PM-CRED-BENE-ADDR     = SPACES
 17428        AND PM-CRED-BENE-CTYST    = SPACES
 17429        GO TO 3999-UNLOCK-ERMAIL
 17430     END-IF
 17431
 17432     MOVE SPACES                 TO MAILING-DATA.
 17433
 17434     MOVE 'MA'                   TO MA-RECORD-ID.
 17435     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 17436     MOVE PM-ACCESS-CONTROL      TO MA-ACCESS-CONTROL.
 17437     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 17438     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 17439     MOVE PB-SV-STATE            TO MA-STATE.
 17440     MOVE PM-PROFILE-INFO        TO MA-PROFILE-INFO
 17441     MOVE PM-CRED-BENE-INFO      TO MA-CRED-BENE-INFO
 17442
 17443     MOVE WS-CURRENT-BIN-DT      TO MA-LAST-MAINT-DT
 17444     MOVE PB-LAST-MAINT-BY       TO MA-LAST-MAINT-BY
 17445
 17446     IF ERMAIL-FOUND = ' '
 17447        PERFORM 8120-REWRITE-ERMAIL THRU 8120-EXIT
 17448     ELSE
 17449        MOVE WS-CURRENT-BIN-DT   TO MA-RECORD-ADD-DT
 17450        MOVE PB-LAST-MAINT-BY    TO MA-RECORD-ADDED-BY
 17451        PERFORM 8130-WRITE-ERMAIL THRU 8130-EXIT.
 17452
 17453     GO TO 9990-RETURN.
 17454
 17455 3999-UNLOCK-ERMAIL.
 17456     IF ERMAIL-FOUND = ' '
 17457        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT.
 17458
 17459     GO TO 9990-RETURN.
 17460******************************************************************
 17461
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 316
* EL050.cbl
 17463 4000-UPDATE-CANCELLED-CERT.
 17464     IF CERT-WAS-NOT-FOUND
 17465        GO TO 4299-EXIT.
 17466
 17467*    MOVE PB-C-MICROFILM-NO      TO  CM-CAN-MICROFILM-NO.
 17468     IF PB-C-NH-INT-ON-REFS > ZEROS
 17469        MOVE PB-C-NH-INT-ON-REFS TO CM-NH-INT-ON-REFS
 17470     END-IF
 17471     IF PB-C-REF-INTERFACE-SW = 'Y'
 17472        MOVE PB-C-REF-INTERFACE-SW
 17473                                 TO CM-NH-INTERFACE-SW
 17474     END-IF
 17475     PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17476     IF ERMAIL-FOUND = 'X'
 17477        OR ((MA-ADDRESS-LINE-1 = SPACES OR LOW-VALUES)
 17478        OR (MA-CITY        = SPACES OR LOW-VALUES)
 17479        OR (MA-ADDR-STATE  = SPACES OR LOW-VALUES)
 17480        OR (MA-ZIP         = SPACES OR LOW-VALUES))
 17481           MOVE ER-2694          TO WS-ERROR
 17482           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17483     END-IF
 17484
 17485     IF PB-C-POST-CARD-IND = 'Y'
 17486        MOVE +8                  TO SUB
 17487*        PERFORM 8110-READ-ERMAIL THRU 8110-EXIT
 17488        IF ERMAIL-FOUND = ' '
 17489           PERFORM VARYING SUB FROM +1 BY +1 UNTIL
 17490              (SUB > +7)
 17491              OR (MA-MAIL-STATUS (SUB) = '1')
 17492           END-PERFORM
 17493        END-IF
 17494        IF (SUB > +7)
 17495           OR (ERMAIL-FOUND = 'X')
 17496           MOVE ER-3789          TO WS-ERROR
 17497           PERFORM 9900-ERROR-FORMAT
 17498                                 THRU 9900-EXIT
 17499        END-IF
 17500     ELSE
 17501        MOVE 'N'                 TO PB-C-POST-CARD-IND
 17502     END-IF
 17503
 17504     IF ERMAIL-FOUND = ' '
 17505        PERFORM 8140-UNLOCK-ERMAIL THRU 8140-EXIT
 17506     END-IF.
 17507
 17508     MOVE PB-C-POST-CARD-IND     TO CM-POST-CARD-IND
 17509
 17510     IF PB-CI-OB-FLAG = 'Z'
 17511        GO TO 4150-SUMMARY-CERT-CANCEL.
 17512
 17513     IF PB-C-LF-CANCEL-VOIDED
 17514         PERFORM 4200-REVERSE-LF-CANCEL.
 17515     IF PB-C-AH-CANCEL-VOIDED
 17516         PERFORM 4200-REVERSE-AH-CANCEL.
 17517
 17518 4100-APPLY-LF-CANCEL.
 17519
 17520     MOVE +0                     TO WS-SUB.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 317
* EL050.cbl
 17521
 17522 4100-CHECK-LF-ERRORS.
 17523
 17524     ADD +1                       TO WS-SUB.
 17525
 17526     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17527        IF LF-COVERAGE-CANCELLED
 17528           GO TO 4100-LF-CANCEL-CONT
 17529        ELSE
 17530           GO TO 4100-UPDATE-LF-COVERAGE.
 17531
 17532     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17533                                   ER-2729 OR
 17534                                   ER-2730 OR
 17535                                   ER-2731 OR
 17536                                   ER-2732 OR
 17537                                   ER-2737 OR
 17538                                   ER-2740 OR
 17539                                   ER-2743 OR
 17540                                   ER-2749 OR
 17541                                   ER-2750 OR
 17542                                   ER-2755 OR
 17543                                   ER-2757 OR
 17544                                   ER-2760 OR
 17545                                   ER-2772 OR
 17546                                   ER-2774 OR
 17547                                   ER-2776 OR
 17548                                   ER-2794
 17549        GO TO 4100-UPDATE-LF-COVERAGE.
 17550
 17551     GO TO 4100-CHECK-LF-ERRORS.
 17552
 17553 4100-UPDATE-LF-COVERAGE.
 17554
 17555     MOVE PB-CI-LF-CANCEL-AMT         TO CM-LF-ITD-CANCEL-AMT
 17556     MOVE PB-CI-LF-PRIOR-CANCEL-DT    TO CM-LF-CANCEL-DT
 17557     IF NOT CM-LF-DEATH-CLAIM-APPLIED
 17558        MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
 17559     END-IF
 17560     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17561                                      TO CM-CREDIT-INTERFACE-SW-2.
 17562     IF CM-LF-CANCEL-DT = LOW-VALUE
 17563         MOVE LOW-VALUE               TO CM-LF-CANCEL-EXIT-DT.
 17564
 17565     IF CM-LF-CANCEL-EXIT-DT = LOW-VALUE
 17566         MOVE SPACES                  TO CM-LF-EXIT-BATCH
 17567                                         CM-LF-STATUS-AT-CANCEL.
 17568
 17569     GO TO 4100-APPLY-AH-CANCEL.
 17570
 17571 4100-LF-CANCEL-CONT.
 17572     IF PB-C-LF-CANCEL-VOIDED
 17573         GO TO 4100-APPLY-AH-CANCEL.
 17574
 17575     IF PB-CI-LF-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17576         GO TO 4100-APPLY-AH-CANCEL.
 17577
 17578     IF PB-C-LF-CANCEL-AMT GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 318
* EL050.cbl
 17579        IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17580           MOVE PB-C-LF-REF-CALC   TO CM-LF-ITD-CANCEL-AMT
 17581        ELSE
 17582           MOVE PB-C-LF-CANCEL-AMT TO CM-LF-ITD-CANCEL-AMT.
 17583
 17584     MOVE PB-C-LF-CANCEL-DT        TO CM-LF-CANCEL-DT.
 17585     MOVE WS-CANCEL-EXIT-DT        TO CM-LF-CANCEL-EXIT-DT.
 17586
 17587     IF (PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUE)
 17588         MOVE PB-ENTRY-BATCH       TO CM-LF-EXIT-BATCH.
 17589
 17590     IF (CM-LF-STATUS-AT-CANCEL = SPACE)
 17591        AND (NOT CM-LF-DEATH-CLAIM-APPLIED)
 17592         MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-CANCEL
 17593         MOVE '8'                  TO CM-LF-CURRENT-STATUS.
 17594
 17595     IF PB-RECORD-RETURNED
 17596        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17597      ELSE
 17598        MOVE '1'                   TO CM-CREDIT-INTERFACE-SW-2.
 17599
 17600 4100-APPLY-AH-CANCEL.
 17601
 17602     MOVE +0                      TO WS-SUB.
 17603
 17604 4100-CHECK-AH-ERRORS.
 17605
 17606     ADD +1                       TO WS-SUB.
 17607
 17608     IF WS-SUB GREATER THAN PB-NO-OF-ERRORS
 17609        IF AH-COVERAGE-CANCELLED
 17610           GO TO 4100-AH-CANCEL-CONT
 17611        ELSE
 17612           GO TO 4100-UPDATE-AH-COVERAGE.
 17613
 17614     IF PB-COMMON-ERROR (WS-SUB) = ER-2717 OR
 17615                                   ER-2729 OR
 17616                                   ER-2732 OR
 17617                                   ER-2737 OR
 17618                                   ER-2740 OR
 17619                                   ER-2744 OR
 17620                                   ER-2749 OR
 17621                                   ER-2750 OR
 17622                                   ER-2755 OR
 17623                                   ER-2757 OR
 17624                                   ER-2760 OR
 17625                                   ER-2771 OR
 17626                                   ER-2772 OR
 17627                                   ER-2773 OR
 17628                                   ER-2775 OR
 17629                                   ER-2777 OR
 17630                                   ER-2778 OR
 17631                                   ER-2794
 17632        GO TO 4100-UPDATE-AH-COVERAGE.
 17633
 17634     GO TO 4100-CHECK-AH-ERRORS.
 17635
 17636 4100-UPDATE-AH-COVERAGE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 319
* EL050.cbl
 17637
 17638     MOVE PB-CI-AH-CANCEL-AMT         TO CM-AH-ITD-CANCEL-AMT
 17639     MOVE PB-CI-AH-PRIOR-CANCEL-DT    TO CM-AH-CANCEL-DT
 17640     MOVE PB-CI-AH-POLICY-STATUS      TO CM-AH-CURRENT-STATUS
 17641     MOVE PB-CI-CREDIT-INTERFACE-SW-2
 17642                                      TO CM-CREDIT-INTERFACE-SW-2.
 17643     IF CM-AH-CANCEL-DT = LOW-VALUE
 17644         MOVE LOW-VALUE               TO CM-AH-CANCEL-EXIT-DT.
 17645
 17646     IF CM-AH-CANCEL-EXIT-DT = LOW-VALUE
 17647         MOVE SPACES                  TO CM-AH-EXIT-BATCH
 17648                                         CM-AH-STATUS-AT-CANCEL.
 17649
 17650     IF LF-COVERAGE-CANCELLED
 17651         IF PB-RECORD-RETURNED
 17652              MOVE '7'                TO CM-CREDIT-INTERFACE-SW-2
 17653          ELSE
 17654              MOVE '1'                TO CM-CREDIT-INTERFACE-SW-2.
 17655
 17656     GO TO 4299-EXIT.
 17657
 17658 4100-AH-CANCEL-CONT.
 17659     IF PB-C-AH-CANCEL-VOIDED
 17660         GO TO 4299-EXIT.
 17661
 17662     if cm-credit-interface-sw-2 = ' '
 17663        if pb-fatal-errors or pb-unforced-errors
 17664           move '4'              to cm-credit-interface-sw-2
 17665        else
 17666           move '1'              to cm-credit-interface-sw-2
 17667        end-if
 17668     end-if
 17669     IF PB-CI-AH-PRIOR-CANCEL-DT NOT = LOW-VALUE
 17670         GO TO 4299-EXIT.
 17671
 17672     IF PB-C-AH-CANCEL-AMT GREATER ZERO
 17673        IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17674           MOVE PB-C-AH-REF-CALC     TO CM-AH-ITD-CANCEL-AMT
 17675        ELSE
 17676           MOVE PB-C-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT.
 17677
 17678     MOVE PB-C-AH-CANCEL-DT      TO CM-AH-CANCEL-DT.
 17679     MOVE WS-CANCEL-EXIT-DT      TO CM-AH-CANCEL-EXIT-DT.
 17680
 17681     IF (PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUE)
 17682         MOVE PB-ENTRY-BATCH     TO CM-AH-EXIT-BATCH.
 17683
 17684     IF CM-AH-STATUS-AT-CANCEL = SPACE
 17685         MOVE CM-AH-CURRENT-STATUS TO CM-AH-STATUS-AT-CANCEL
 17686         MOVE '8'                TO CM-AH-CURRENT-STATUS.
 17687
 17688     IF PB-RECORD-RETURNED
 17689        MOVE '7'                 TO CM-CREDIT-INTERFACE-SW-2
 17690      ELSE
 17691        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 17692
 17693     GO TO 4299-EXIT.
 17694
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 320
* EL050.cbl
 17695 4150-SUMMARY-CERT-CANCEL.
 17696     MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-2.
 17697
 17698     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17699        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17700                      PB-CI-LF-CANCEL-AMT + PB-C-LF-REF-CALC
 17701     ELSE
 17702        COMPUTE CM-LF-ITD-CANCEL-AMT =
 17703                       PB-CI-LF-CANCEL-AMT + PB-C-LF-CANCEL-AMT.
 17704
 17705     IF PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH
 17706        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17707                       PB-CI-AH-CANCEL-AMT + PB-C-AH-REF-CALC
 17708     ELSE
 17709        COMPUTE CM-AH-ITD-CANCEL-AMT =
 17710                       PB-CI-AH-CANCEL-AMT + PB-C-AH-CANCEL-AMT.
 17711
 17712     IF (PB-CI-LIVES - PB-C-LIVES) LESS ZERO
 17713        NEXT SENTENCE
 17714     ELSE
 17715        COMPUTE CM-LIVES = PB-CI-LIVES - PB-C-LIVES.
 17716
 17717     GO TO 4299-EXIT.
 17718
 17719 4200-REVERSE-LF-CANCEL.
 17720     MOVE LOW-VALUE                TO CM-LF-CANCEL-DT.
 17721
 17722     IF CM-LF-CANCEL-APPLIED
 17723        MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
 17724        MOVE SPACES                TO CM-LF-EXIT-BATCH
 17725        MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS.
 17726
 17727     MOVE SPACE                    TO CM-LF-STATUS-AT-CANCEL.
 17728
 17729     IF PB-RECORD-RETURNED
 17730        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17731       ELSE
 17732        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17733
 17734 4200-REVERSE-LF-EXIT.
 17735       EXIT.
 17736
 17737 4200-REVERSE-AH-CANCEL.
 17738     MOVE LOW-VALUE                TO CM-AH-CANCEL-DT.
 17739
 17740     IF CM-AH-CANCEL-APPLIED
 17741        MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
 17742        MOVE SPACES                TO CM-AH-EXIT-BATCH
 17743        MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS.
 17744
 17745     MOVE SPACE                    TO CM-AH-STATUS-AT-CANCEL.
 17746
 17747     IF PB-RECORD-RETURNED
 17748        MOVE '7'                   TO CM-CREDIT-INTERFACE-SW-2
 17749       ELSE
 17750        MOVE '5'                   TO CM-CREDIT-INTERFACE-SW-2.
 17751
 17752 4200-REVERSE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 321
* EL050.cbl
 17753       EXIT.
 17754
 17755 4299-EXIT.
 17756       EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 322
* EL050.cbl
 17758
 17759 4500-UPDATE-NEW-CERT.
 17760     IF CERT-WAS-FOUND
 17761         NEXT SENTENCE
 17762       ELSE
 17763         GO TO 4520-BUILD-NEW-KEY.
 17764
 17765     IF  CLASIC-CREATED-CERT
 17766         GO TO 4999-EXIT.
 17767
 17768     IF  CERT-WAS-CREATED-FOR-CLAIM
 17769         GO TO 4520-BUILD-NEW-KEY.
 17770
 17771     IF CERT-ADDED-BATCH
 17772        IF CM-RECORD-ID = 'CM'
 17773            GO TO 4999-EXIT.
 17774
 17775 4520-BUILD-NEW-KEY.
 17776* BUILD CONTROL PRIMARY
 17777
 17778     MOVE PB-COMPANY-CD             TO CM-COMPANY-CD
 17779                                       CM-COMPANY-CD-A1
 17780                                       CM-COMPANY-CD-A2
 17781                                       CM-COMPANY-CD-A4
 17782                                       CM-COMPANY-CD-A5.
 17783
 17784     MOVE PB-SV-CARRIER             TO CM-CARRIER.
 17785     MOVE PB-SV-GROUPING            TO CM-GROUPING.
 17786     MOVE PB-SV-STATE               TO CM-STATE.
 17787     MOVE PB-ACCOUNT                TO CM-ACCOUNT.
 17788     MOVE PB-CERT-PRIME             TO CM-CERT-PRIME.
 17789     MOVE PB-CERT-SFX               TO CM-CERT-SFX.
 17790     MOVE PB-CERT-EFF-DT            TO CM-CERT-EFF-DT.
 17791
 17792     MOVE CM-CERT-NO                TO CM-CERT-NO-A4.
 17793
 17794     MOVE PB-I-INSURED-1ST-INIT      TO CM-INSURED-INITIAL1.
 17795     MOVE PB-I-INSURED-MIDDLE-INIT   TO CM-INSURED-INITIAL2.
 17796     MOVE PB-I-INSURED-LAST-NAME     TO CM-INSURED-LAST-NAME.
 17797     MOVE PB-I-INSURED-FIRST-NAME    TO CM-INSURED-FIRST-NAME.
 17798
 17799     IF PB-I-SOC-SEC-NO EQUAL '000000000  '
 17800        MOVE ZEROS                   TO PB-I-SOC-SEC-NO.
 17801
 17802     IF PB-I-SOC-SEC-NO   = SPACES OR ZERO
 17803         MOVE PB-SV-STATE            TO CM-SSN-STATE
 17804         MOVE PB-ACCOUNT-PRIME       TO CM-SSN-ACCOUNT
 17805         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 17806         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A2
 17807     ELSE
 17808         MOVE PB-I-SOC-SEC-NO        TO CM-SOC-SEC-NO.
 17809
 17810     IF PB-COMPANY-ID   EQUAL  'CRI'
 17811         MOVE PB-I-INSURED-LAST-NAME  TO WS-CRI-LAST-NAME
 17812         MOVE WS-CRI-RPT-CD-MOVE      TO WS-SS-REPT-CD
 17813         MOVE WS-CRI-NAME-MOVE        TO WS-SS-LAST-NAME
 17814         MOVE PB-I-INSURED-1ST-INIT   TO WS-SS-INITIAL
 17815         MOVE WS-CRI-SOC-SEC-NO       TO CM-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 323
* EL050.cbl
 17816
 17817     IF (PB-I-SOC-SEC-NO   = SPACES OR ZERO) AND
 17818        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17819         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A2.
 17820
 17821     IF PB-COMPANY-ID  = 'LBL'
 17822        IF PB-I-JOINT-COVERAGE
 17823            MOVE PB-I-JOINT-LAST-NAME   TO CM-MEMBER-NO
 17824                                           PB-I-MEMBER-NO
 17825            GO TO 4550-CONT-CERT-PROCESS.
 17826
 17827     IF PB-COMPANY-ID  = 'MON' OR 'PEM'
 17828        NEXT SENTENCE
 17829     ELSE
 17830        GO TO 4540-BUILD-MEMBER-NO.
 17831
 17832******************************************************************
 17833*                                                                *
 17834*    FOLLOWING MEMBER NUMBER ROUTINE IS DESIGNED SPECIFICALLY    *
 17835*    FOR 'MON'.                                                  *
 17836*                                                                *
 17837******************************************************************
 17838
 17839     MOVE PB-I-INSURED-LAST-NAME TO WS-WORK-NAME.
 17840     MOVE SPACES                 TO WS-WORK-MEMB-NAME.
 17841     MOVE +1                     TO WS-SUB1
 17842                                    WS-SUB2.
 17843
 17844 4530-EDIT-MEMB-NAME.
 17845
 17846     IF WS-TBL-LETTER (WS-SUB1) GREATER SPACE AND LESS ZERO
 17847        MOVE WS-TBL-LETTER (WS-SUB1) TO WS-MEMB-LETTER (WS-SUB2)
 17848        ADD +1                       TO WS-SUB2.
 17849
 17850     IF WS-SUB1 LESS THAN +12 AND WS-SUB2 LESS THAN +7
 17851        ADD +1                       TO WS-SUB1
 17852        GO TO 4530-EDIT-MEMB-NAME.
 17853
 17854     MOVE WS-WORK-MEMB-NAME          TO CM-MEMB-ACCOUNT.
 17855     MOVE PB-SV-STATE                TO CM-MEMB-STATE.
 17856     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 17857*    MOVE SPACE                      TO DC-OPTION-CODE.
 17858     SET  BIN-TO-GREG                TO TRUE.
 17859     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 17860     MOVE DC-GREG-DATE-1-YMD         TO CM-MEMB-LN4.
 17861
 17862     GO TO 4550-CONT-CERT-PROCESS.
 17863
 17864******************************************************************
 17865*    END FOR 'MON' CODE FOR MEMBER NO.                           *
 17866******************************************************************
 17867
 17868 4540-BUILD-MEMBER-NO.
 17869
 17870     IF PB-I-MEMBER-NO  = SPACES OR ZERO
 17871         MOVE PB-SV-STATE            TO CM-MEMB-STATE
 17872         MOVE PB-ACCOUNT-PRIME       TO CM-MEMB-ACCOUNT
 17873         MOVE PB-I-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 324
* EL050.cbl
 17874         MOVE CM-INSURED-INITIALS    TO CM-INSURED-INITIALS-A5
 17875     ELSE
 17876         MOVE PB-I-MEMBER-NO         TO CM-MEMBER-NO.
 17877
 17878     IF (PB-I-MEMBER-NO  = SPACES OR ZERO) AND
 17879        (CM-INSURED-INITIALS  = SPACES OR ZERO)
 17880         MOVE PB-I-AGE               TO CM-INSURED-INITIALS-A5.
 17881
 17882 4550-CONT-CERT-PROCESS.
 17883
 17884*    IF PB-I-MICROFILM-NO  NOT NUMERIC
 17885*        MOVE ZEROS              TO  CM-ISS-MICROFILM-NO
 17886*    ELSE
 17887*        MOVE PB-I-MICROFILM-NO  TO  CM-ISS-MICROFILM-NO.
 17888
 17889     IF CERT-WAS-CREATED-FOR-CLAIM
 17890        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17891        MOVE 'Y'                   TO WS-CERT-ADDED-FOR-CLM-SW.
 17892
 17893     IF CERT-AND-CLAIM-ONLINE
 17894        MOVE CM-CLAIM-ATTACHED-COUNT TO WS-CLAIM-ATTACHED-COUNT
 17895        MOVE 'Y'                   TO WS-CERT-AND-CLM-ONLINE-SW.
 17896
 17897     MOVE 'CM'                     TO CM-RECORD-ID.
 17898     MOVE LOW-VALUES               TO CM-STATUS-DATA.
 17899
 17900     IF CERT-WAS-ADDED-FOR-CLM OR CERT-AND-CLM-ONLINE
 17901        MOVE '1'                     TO CM-CLAIM-INTERFACE-SW
 17902        MOVE WS-CLAIM-ATTACHED-COUNT TO CM-CLAIM-ATTACHED-COUNT
 17903     ELSE
 17904        MOVE SPACE                TO CM-CLAIM-INTERFACE-SW
 17905        MOVE ZERO                 TO CM-CLAIM-ATTACHED-COUNT.
 17906
 17907     MOVE ZERO                     TO CM-LOAN-BALANCE.
 17908     MOVE '1'                      TO CM-PREMIUM-TYPE.
 17909     MOVE PB-I-AGE                 TO CM-INSURED-ISSUE-AGE.
 17910     MOVE PB-I-JOINT-AGE           TO CM-INSURED-JOINT-AGE.
 17911     MOVE PB-I-JOINT-INSURED       TO CM-JOINT-INSURED-NAME.
 17912     MOVE PB-I-INSURED-SEX         TO CM-INSURED-SEX.
 17913     MOVE ZEROS                    TO CM-LF-REMAINING-AMT
 17914                                      CM-LF-ITD-CANCEL-AMT
 17915                                      CM-LF-ITD-DEATH-AMT
 17916                                      CM-AH-ITD-AH-PMT
 17917                                      CM-AH-ITD-LUMP-PMT
 17918                                      CM-AH-ITD-CANCEL-AMT
 17919                                      CM-LF-NSP-PREMIUM-AMT
 17920                                      CM-AH-NSP-PREMIUM-AMT.
 17921*                                     CM-CLAIM-DEDUCT-WITHHELD
 17922*                                     CM-CANCEL-DEDUCT-WITHHELD.
 17923     if pb-i-loan-apr = +99.9999
 17924        move zeros                 to cm-loan-apr
 17925     else
 17926        MOVE PB-I-LOAN-APR         TO CM-LOAN-APR
 17927     end-if
 17928     MOVE PB-I-PAY-FREQUENCY       TO CM-PAY-FREQUENCY.
 17929     MOVE PB-I-RATE-CLASS          TO CM-RATE-CLASS.
 17930     MOVE PB-LAST-MAINT-BY         TO CM-CSR-CODE.
 17931     MOVE PB-I-RATE-DEVIATION-LF   TO CM-LF-DEV-CODE.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 325
* EL050.cbl
 17932     MOVE PB-I-RATE-DEVIATION-AH   TO CM-AH-DEV-CODE.
 17933     MOVE PB-I-RATE-DEV-PCT-LF     TO CM-LF-DEV-PCT.
 17934     MOVE PB-I-RATE-DEV-PCT-AH     TO CM-AH-DEV-PCT.
 17935     MOVE PB-I-LIFE-COMMISSION     TO CM-LIFE-COMM-PCT.
 17936     MOVE PB-I-AH-COMMISSION       TO CM-AH-COMM-PCT.
 17937     MOVE PB-I-LOAN-TERM           TO CM-LOAN-TERM.
 17938     MOVE PB-I-1ST-PMT-DT          TO CM-LOAN-1ST-PMT-DT.
 17939
 17940     IF PB-I-LIVES NOT NUMERIC
 17941         MOVE ZERO                 TO PB-I-LIVES.
 17942
 17943     IF PB-I-NUM-BILLED NOT NUMERIC
 17944         MOVE ZERO                 TO PB-I-NUM-BILLED.
 17945
 17946     MOVE PB-I-LIVES               TO CM-LIVES.
 17947     MOVE PB-I-NUM-BILLED          TO CM-BILLED.
 17948
 17949     IF PB-COMPANY-ID EQUAL  'DMD'
 17950         MOVE PB-I-RESIDENT-STATE      TO CM-RESIDENT-STATE
 17951         MOVE PB-I-RATE-CODE           TO CM-RATE-CODE.
 17952
 17953     MOVE PB-I-LF-BENEFIT-CD       TO CM-LF-BENEFIT-CD.
 17954     MOVE PB-I-LF-TERM             TO CM-LF-ORIG-TERM.
 17955     MOVE PB-I-LF-ALT-BENEFIT-AMT  TO CM-LF-ALT-BENEFIT-AMT.
 17956     MOVE PB-I-LF-BENEFIT-AMT      TO CM-LF-BENEFIT-AMT.
 17957     MOVE PB-I-LF-ALT-PREMIUM-AMT  TO CM-LF-ALT-PREMIUM-AMT.
 17958     MOVE PB-I-LF-CLP              TO CM-LF-CLP
 17959
 17960     IF PB-I-LF-POLICY-FEE NUMERIC
 17961        MOVE PB-I-LF-POLICY-FEE    TO CM-LF-POLICY-FEE
 17962     ELSE
 17963        MOVE +0                    TO CM-LF-POLICY-FEE.
 17964
 17965     IF PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH
 17966        MOVE PB-I-LF-PREM-CALC     TO CM-LF-PREMIUM-AMT
 17967        MOVE PB-I-LF-ALT-PREM-CALC TO CM-LF-ALT-PREMIUM-AMT
 17968     ELSE
 17969        MOVE PB-I-LF-PREMIUM-AMT   TO CM-LF-PREMIUM-AMT.
 17970
 17971     MOVE PB-I-LF-RATE             TO  CM-LF-PREMIUM-RATE.
 17972     MOVE PB-I-LF-ALT-RATE         TO  CM-LF-ALT-PREMIUM-RATE.
 17973     MOVE PB-I-AH-RATE             TO  CM-AH-PREMIUM-RATE.
 17974     MOVE PB-I-LF-CRIT-PER         TO CM-LF-CRITICAL-PERIOD.
 17975     MOVE PB-I-LF-EXPIRE-DT        TO CM-LF-LOAN-EXPIRE-DT.
 17976     MOVE PB-I-AH-BENEFIT-CD       TO CM-AH-BENEFIT-CD.
 17977     MOVE PB-I-AH-TERM             TO CM-AH-ORIG-TERM.
 17978     MOVE PB-I-AH-BENEFIT-AMT      TO CM-AH-BENEFIT-AMT.
 17979     MOVE PB-I-AH-CLP              TO CM-AH-CLP
 17980
 17981     IF PB-I-AH-POLICY-FEE NUMERIC
 17982        MOVE PB-I-AH-POLICY-FEE    TO CM-AH-POLICY-FEE
 17983     ELSE
 17984        MOVE +0                    TO CM-AH-POLICY-FEE.
 17985
 17986     IF PB-OVERRIDE-AH   OR PB-OVERRIDE-BOTH
 17987        MOVE PB-I-AH-PREM-CALC     TO CM-AH-PREMIUM-AMT
 17988     ELSE
 17989        MOVE PB-I-AH-PREMIUM-AMT   TO CM-AH-PREMIUM-AMT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 326
* EL050.cbl
 17990
 17991     MOVE PB-I-AH-CRIT-PER         TO CM-AH-CRITICAL-PERIOD.
 17992     MOVE PB-I-AH-EXPIRE-DT        TO CM-AH-LOAN-EXPIRE-DT.
 17993
 17994     MOVE LOW-VALUES               TO CM-AH-PAID-THRU-DT
 17995                                      CM-LF-DEATH-EXIT-DT
 17996                                      CM-AH-SETTLEMENT-EXIT-DT.
 17997
 17998*    IF PB-COMPANY-ID = 'ABL' OR 'FGL' OR 'CGL' OR
 17999*                       'TIH' OR 'OFL' OR 'FLA' OR
 18000*                       'TII' OR 'TMS' OR 'CRI' OR
 18001*                       'NCL'
 18002     MOVE PB-I-SIG-SW            TO CM-USER-FIELD
 18003
 18004     IF NOT NO-LIFE-COVERAGE AND LF-BENEFIT-FOUND
 18005         IF WS-LF-SPECIAL-CALC-CD = 'O'
 18006            MOVE '2'                TO CM-PREMIUM-TYPE.
 18007
 18008     IF NOT NO-AH-COVERAGE AND AH-BENEFIT-FOUND
 18009         IF WS-AH-SPECIAL-CALC-CD = 'O'
 18010            MOVE '2'                TO CM-PREMIUM-TYPE.
 18011
 18012     IF (NOT NO-LIFE-COVERAGE  AND  WS-LF-SPECIAL-CALC-CD = 'D')
 18013         MOVE PB-I-TERM-IN-DAYS     TO CM-LF-TERM-IN-DAYS
 18014     ELSE
 18015         MOVE ZEROS                 TO CM-LF-TERM-IN-DAYS
 18016         MOVE PB-I-EXTENTION-DAYS   TO CM-PMT-EXTENSION-DAYS.
 18017
 18018     MOVE PB-I-LOAN-OFFICER         TO CM-LOAN-OFFICER.
 18019     MOVE PB-I-INDV-GRP-CD          TO CM-IND-GRP-TYPE.
 18020     MOVE PB-I-POLICY-FORM-NO       TO CM-POLICY-FORM-NO.
 18021     MOVE PB-I-BENEFICIARY-NAME     TO CM-BENEFICIARY.
 18022     MOVE PB-ENTRY-BATCH            TO CM-ENTRY-BATCH.
 18023     MOVE PB-I-REIN-TABLE           TO CM-REIN-TABLE.
 18024     MOVE PB-I-SPECIAL-REIN-CODE    TO CM-SPECIAL-REIN-CODE.
 18025     MOVE SPACE                     TO CM-PAYMENT-MODE.
 18026
 18027     IF PB-NO-MONTHS-SKIPPED
 18028         MOVE SPACE                 TO CM-SKIP-CODE
 18029     ELSE
 18030         MOVE PB-I-SKIP-CODE        TO CM-SKIP-CODE.
 18031
 18032     MOVE '2'                       TO CM-LF-CURRENT-STATUS.
 18033     MOVE SPACE                     TO CM-LF-STATUS-AT-DEATH
 18034                                       CM-LF-STATUS-AT-CANCEL.
 18035
 18036     MOVE '2'                       TO CM-AH-CURRENT-STATUS.
 18037     MOVE SPACE                     TO CM-AH-STATUS-AT-SETTLEMENT
 18038                                       CM-AH-STATUS-AT-CANCEL.
 18039
 18040     MOVE '1'                       TO CM-ENTRY-STATUS.
 18041
 18042     IF PB-REISSUED-CERT
 18043        MOVE '5'                    TO CM-ENTRY-STATUS.
 18044
 18045     IF PB-MONTHLY-CERT
 18046        MOVE 'M'                    TO CM-ENTRY-STATUS.
 18047
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 327
* EL050.cbl
 18048     IF PB-CASH-CERT
 18049        MOVE 'C'                    TO CM-ENTRY-STATUS.
 18050
 18051     MOVE PB-I-ADDL-CLP          TO CM-ADDL-CLP
 18052     MOVE PB-I-CLP-STATE         TO CM-CLP-STATE
 18053     IF PB-POLICY-IS-DECLINED
 18054        MOVE 'D'                    TO CM-ENTRY-STATUS.
 18055
 18056     IF PB-POLICY-IS-VOIDED
 18057        MOVE 'V'                    TO CM-ENTRY-STATUS.
 18058
 18059     IF PB-NEEDS-UNDERWRITING
 18060        MOVE 'U'                    TO CM-ENTRY-STATUS.
 18061
 18062     IF PB-REIN-ONLY-CERT
 18063        MOVE '9'                    TO CM-ENTRY-STATUS.
 18064
 18065     IF PB-I-UNDERWRITING-STATUS =  'A'  OR  'D'
 18066         MOVE 'Y'                   TO CM-UNDERWRITING-CODE
 18067     ELSE
 18068         MOVE SPACE                 TO CM-UNDERWRITING-CODE.
 18069
 18070     IF PB-RECORD-RETURNED
 18071        MOVE '4'                    TO CM-CREDIT-INTERFACE-SW-1
 18072      ELSE
 18073        MOVE '1'                    TO CM-CREDIT-INTERFACE-SW-1.
 18074
 18075     IF PB-I-MAIL-ADDRS-PRESENT
 18076        MOVE '1'                    TO CM-INSURED-ADDRESS-SW.
 18077
 18078     MOVE WS-CURRENT-MONTH-END      TO CM-LAST-MONTH-END
 18079                                       CM-ENTRY-DT.
 18080
 18081 4999-EXIT.
 18082     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 328
* EL050.cbl
 18084
 18085 5000-PROCESS-REPS.
 18086     MOVE ' '                    TO AGTC-MASTER-SW
 18087     MOVE ERCOMP-KEY (1:18)      TO ERAGTC-KEY (1:18)
 18088     MOVE CO-TYPE                TO AGTC-TYPE
 18089     MOVE PB-CERT-EFF-DT         TO AGTC-EXP-DT
 18090     PERFORM 8583-READ-ERAGTC    THRU 8583-EXIT
 18091     IF (AGTC-MASTER-SW NOT = 'N')
 18092        AND (ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18))
 18093        AND (PB-CERT-EFF-DT = AG-EXP-DT)
 18094        PERFORM 8583-READ-ERAGTC-NEXT
 18095                                 THRU 8583-EXIT
 18096     END-IF
 18097     IF AGTC-MASTER-SW = 'N'
 18098        CONTINUE
 18099     ELSE
 18100        IF ERCOMP-KEY (1:18) = AG-CONTROL-PRIMARY (1:18)
 18101           IF (PB-CERT-EFF-DT NOT < AG-EFF-DT)
 18102              AND (PB-CERT-EFF-DT < AG-EXP-DT)
 18103              MOVE 'Y'           TO AGTC-MASTER-SW
 18104           END-IF
 18105        END-IF
 18106     END-IF
 18107     .
 18108 5000-EXIT.
 18109     EXIT.
 18110 6370-EDIT-INPUT-LF-CODE.
 18111     move ' ' to ws-benefit-cd-chg-sw
 18112     IF WK-LIFE-EDIT-ADDR NOT = ZEROS
 18113        MOVE +1                  TO SUB
 18114        MOVE WK-LIFE-EDIT-ADDR   TO ELCNTL-WS-COMP
 18115        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18116        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18117        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18118        GO TO 6370-SEARCH-LOOP.
 18119
 18120     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18121
 18122     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18123     MOVE SPACES                 TO CNTL-ACCESS.
 18124*    MOVE 'L'                    TO CNTL-REC-TYPE.
 18125     MOVE PB-LIFE-OVERRIDE-L1    TO CNTL-REC-TYPE.
 18126     MOVE +0                     TO CNTL-SEQ-NO.
 18127     MOVE '4' TO RC-SW-2.
 18128     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18129
 18130     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18131        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18132        GO TO 6370-NO-LF-FOUND.
 18133
 18134     MOVE ELCNTL-WS-COMP         TO WK-LIFE-EDIT-ADDR.
 18135     MOVE +1                     TO SUB.
 18136
 18137 6370-SEARCH-LOOP.
 18138     IF CF-LIFE-CODE-OUT (SUB) = ZEROS
 18139         GO TO 6370-NO-LF-FOUND.
 18140
 18141     IF PB-I-LF-INPUT-CD = CF-LIFE-CODE-IN (SUB)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 329
* EL050.cbl
 18142        if (pb-i-lf-benefit-cd not = zeros and spaces)
 18143           and (cf-life-code-out (sub) not = pb-i-lf-benefit-cd)
 18144           set benefit-code-chg to true
 18145        end-if
 18146        MOVE CF-LIFE-CODE-OUT (SUB) TO PB-I-LF-BENEFIT-CD
 18147        GO TO 6370-HER-NET-PAY-CHECK.
 18148
 18149     ADD 1   TO SUB.
 18150*    IF SUB GREATER 120
 18151     IF SUB GREATER 200
 18152         GO TO 6370-NO-LF-FOUND.
 18153
 18154     GO TO 6370-SEARCH-LOOP.
 18155
 18156 6370-NO-LF-FOUND.
 18157
 18158     if (pb-i-lf-benefit-cd not = zeros and spaces)
 18159        and (pb-i-lf-input-cd not = pb-i-lf-benefit-cd)
 18160        set benefit-code-chg to true
 18161     end-if
 18162     MOVE PB-I-LF-INPUT-CD       TO PB-I-LF-BENEFIT-CD.
 18163
 18164 6370-HER-NET-PAY-CHECK.
 18165
 18166     IF PB-COMPANY-ID = 'CID'
 18167        IF PB-SV-STATE = 'CA' OR 'MN'
 18168           IF PB-I-LF-BENEFIT-CD = '02'
 18169              MOVE '2G'          TO PB-I-LF-BENEFIT-CD
 18170           ELSE
 18171              IF PB-I-LF-BENEFIT-CD = '04'
 18172                 MOVE '2H'       TO PB-I-LF-BENEFIT-CD
 18173              END-IF
 18174           END-IF
 18175        END-IF
 18176     END-IF
 18177
 18178     IF PB-COMPANY-ID NOT = 'HER'
 18179         GO TO 6370-EXIT.
 18180
 18181     IF PB-I-LF-BENEFIT-CD NOT = '33'  AND  '34'
 18182         GO TO 6370-EXIT.
 18183
 18184     IF PB-I-LF-TERM NOT NUMERIC
 18185         MOVE ZEROS              TO PB-I-LF-TERM.
 18186
 18187     IF PB-I-LOAN-TERM NOT NUMERIC
 18188         MOVE ZEROS              TO PB-I-LOAN-TERM.
 18189
 18190     IF PB-I-LOAN-TERM GREATER THAN PB-I-LF-TERM
 18191         GO TO 6370-EXIT.
 18192
 18193     IF PB-I-LF-BENEFIT-CD = '33'
 18194         MOVE '31'               TO PB-I-LF-BENEFIT-CD.
 18195
 18196     IF PB-I-LF-BENEFIT-CD = '34'
 18197         MOVE '32'               TO PB-I-LF-BENEFIT-CD.
 18198
 18199 6370-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 330
* EL050.cbl
 18200     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 331
* EL050.cbl
 18202
 18203 6380-EDIT-INPUT-AH-CODE.
 18204     IF WK-AH-EDIT-ADDR NOT = ZEROS
 18205        MOVE +1                  TO SUB
 18206        MOVE WK-AH-EDIT-ADDR     TO ELCNTL-WS-COMP
 18207        SET ELCNTL-FILE-ADDRESSED   TO TRUE
 18208        PERFORM 8900-ADDRESS-FILE   THRU 8900-ADDRESS-EXIT
 18209        PERFORM 8555-RELOAD-CONTROL-FILE  THRU  8555-EXIT
 18210        GO TO 6380-SEARCH-LOOP.
 18211
 18212     PERFORM 9200-CONTROL-GETMAIN THRU 9200-EXIT.
 18213
 18214     MOVE PB-COMPANY-ID          TO CNTL-COMP-ID
 18215     MOVE SPACES                 TO CNTL-ACCESS.
 18216     MOVE 'A'                    TO CNTL-REC-TYPE.
 18217*    MOVE PB-AH-OVERRIDE-L1      TO CNTL-REC-TYPE.
 18218     MOVE +0                     TO CNTL-SEQ-NO.
 18219     MOVE '5' TO RC-SW-2.
 18220     PERFORM 9100-READ-CONTROL THRU 9100-EXIT.
 18221
 18222     IF CF-COMPANY-ID NOT = PB-COMPANY-ID OR
 18223        CF-RECORD-TYPE NOT = CNTL-REC-TYPE
 18224        GO TO 6380-NO-AH-FOUND.
 18225
 18226     MOVE ELCNTL-WS-COMP         TO WK-AH-EDIT-ADDR.
 18227     MOVE +1 TO SUB.
 18228
 18229 6380-SEARCH-LOOP.
 18230     IF CF-AH-CODE-OUT (SUB) = ZEROS
 18231         GO TO 6380-NO-AH-FOUND.
 18232
 18233     IF PB-I-AH-INPUT-CD = CF-AH-CODE-IN (SUB)
 18234         MOVE CF-AH-CODE-OUT (SUB) TO PB-I-AH-BENEFIT-CD
 18235         GO TO 6380-CSO-AH-ONLY-CHECKS.
 18236
 18237     ADD 1   TO SUB.
 18238     IF SUB GREATER THAN 96
 18239*    IF SUB GREATER THAN 300
 18240         GO TO 6380-NO-AH-FOUND.
 18241
 18242     GO TO 6380-SEARCH-LOOP.
 18243
 18244 6380-NO-AH-FOUND.
 18245
 18246     MOVE PB-I-AH-INPUT-CD       TO WS-AH-INPUT-CD.
 18247
 18248     IF WS-AH-INPUT-CD-1 IS EQUAL TO SPACE
 18249         MOVE WS-AH-INPUT-CD-2-3 TO PB-I-AH-BENEFIT-CD
 18250     ELSE
 18251         MOVE PB-I-AH-INPUT-CD   TO PB-I-AH-BENEFIT-CD.
 18252
 18253 6380-CSO-AH-ONLY-CHECKS.
 18254
 18255     IF PB-COMPANY-ID = 'CSO' OR 'CID'
 18256        NEXT SENTENCE
 18257      ELSE
 18258        GO TO 6380-EXIT.
 18259
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 332
* EL050.cbl
 18260     IF PB-I-LF-BENEFIT-CD NOT = SPACES AND ZEROS
 18261         GO TO 6380-CSO-LIFE-WITH-AH-CHECKS.
 18262
 18263
 18264     GO TO 6380-EXIT
 18265     .
 18266 6380-CSO-LIFE-WITH-AH-CHECKS.
 18267
 18268
 18269     .
 18270 6380-EXIT.
 18271     EXIT.
 18272
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 333
* EL050.cbl
 18274
 18275 6400-COMPUTE-EXTENSION-DAYS.
 18276
 18277******************************************************************
 18278*                                                                *
 18279*                   COMPUTE EXTENSION DAYS                       *
 18280*                                                                *
 18281*    THE DATE ROUTINE ASSUMES THAT A MONTH IS 30 DAYS.  IT IS    *
 18282*    NECESSARY TO ADJUST THE ODD DAYS OVER BECAUSE OF THIS.      *
 18283*    THIS ROUTINE IS USED TO ADJUST THE ODD DAYS AND COMPUTE     *
 18284*    THE EXTENSION DAYS.                                         *
 18285*                                                                *
 18286******************************************************************
 18287
 18288     MOVE DC-GREG-DATE-1-EDIT    TO WS-WORK-DATE-FROM.
 18289     MOVE DC-GREG-DATE-2-EDIT    TO WS-WORK-DATE-THRU.
 18290
 18291******************************************************************
 18292*    IF THE FIRST PAYMENT DATE IS GREATER THAN ONE MONTH PAST    *
 18293*       THE EFFECTIVE DT., THE EXTENSION DAYS NEED TO REFLECT IT.*
 18294******************************************************************
 18295
 18296     IF DC-ELAPSED-MONTHS GREATER THAN +0
 18297        COMPUTE WS-ODD-DAYS-OVER =
 18298               ((DC-ELAPSED-MONTHS - 1) * 30) + DC-ODD-DAYS-OVER
 18299     ELSE
 18300        MOVE DC-ODD-DAYS-OVER    TO WS-ODD-DAYS-OVER.
 18301
 18302     IF WS-ODD-DAYS-OVER = ZEROS
 18303           GO TO 6499-EXIT
 18304     ELSE
 18305        IF WS-WDF-DAY GREATER THAN WS-WDT-DAY
 18306           IF WS-WDF-MONTH = 02
 18307              PERFORM 6415-CHECK-LEAP-YEAR THRU 6415-EXIT
 18308              ADD 2       TO  WS-ODD-DAYS-OVER
 18309              GO TO 6499-EXIT
 18310           ELSE
 18311              IF DC-DAYS-IN-MONTH = 31 AND WS-WDF-DAY NOT = 31
 18312                 SUBTRACT 1 FROM WS-ODD-DAYS-OVER
 18313                 GO TO 6499-EXIT
 18314               ELSE
 18315                 GO TO 6499-EXIT
 18316        ELSE
 18317           GO TO 6499-EXIT.
 18318
 18319 6412-CHECK-TO-DAY.
 18320
 18321        IF WS-WDT-MONTH = 02 AND WS-ODD-DAYS-OVER NOT = 0
 18322           IF WS-WDT-DAY = 28
 18323              ADD 2              TO WS-ODD-DAYS-OVER
 18324           ELSE
 18325              IF WS-WDT-DAY = 29
 18326                 ADD 1           TO WS-ODD-DAYS-OVER
 18327              ELSE
 18328                 NEXT SENTENCE
 18329        ELSE
 18330           IF WS-WDT-DAY = 31 AND WS-ODD-DAYS-OVER NOT = 0
 18331              SUBTRACT 1         FROM WS-ODD-DAYS-OVER.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 334
* EL050.cbl
 18332
 18333     GO TO 6499-EXIT.
 18334
 18335
 18336 6415-CHECK-LEAP-YEAR.
 18337
 18338     IF DC-DAYS-IN-MONTH = 29
 18339        SUBTRACT 1 FROM WS-ODD-DAYS-OVER.
 18340
 18341 6415-EXIT.
 18342     EXIT.
 18343
 18344 6499-EXIT.
 18345      EXIT.
 18346
 18347 6500-END.
 18348     EXIT.
 18349
 18350
 18351******************************************************************
 18352************* PROCEDURE DIVISION FOR EL050 ***********************
 18353********************** ELC50PD END *******************************
 18354
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 335
* EL050.cbl
 18356
 18357**START***********************************************************
 18358*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475   *
 18359*            PARAGRAPHS  6600 THRU 6700-COMM-EXIT                *
 18360******************************************************************
 18361*
 18362 6600-GET-STATE-MUNICIPAL-TAX.
 18363
 18364     IF PB-COMPANY-ID NOT = 'DMD'
 18365         GO TO 6640-EXIT.
 18366
 18367     MOVE PB-COMPANY-CD       TO WS-ERRESS-COMPANY-CD.
 18368     MOVE PB-CERT-NO (1:2)    TO WS-ERRESS-RESIDENT-STATE.
 18369     MOVE PB-CERT-NO (4:1)    TO WS-ERRESS-COVERAGE-CAT.
 18370*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMATT TO READ MASTER
 18371*
 18372***  Y2K PROJ 7744
 18373     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18374     SET BIN-TO-GREG          TO TRUE.
 18375     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18376
 18377     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18378
 18379     MOVE WS-CONTRACT-DATE    TO WS-ERRESS-EXPIRE-DT.
 18380     MOVE WS-ERRESS-KEY       TO WS-SAVE-ERRESS-KEY.
 18381
 18382
 18383* EXEC CICS HANDLE CONDITION
 18384*        INVREQ    (6610-START-BROWSE)
 18385*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18386*        NOTFND    (6630-END-OF-FILE)
 18387*    END-EXEC.
 18388*    MOVE '"$8JI                 ! # #00018370' TO DFHEIV0
 18389     MOVE X'2224384A4920202020202020' TO DFHEIV0(1:12)
 18390     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18391     MOVE X'2320233030303138333730' TO DFHEIV0(25:11)
 18392     CALL 'kxdfhei1' USING DFHEIV0
 18393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18394
 18395
 18396 6610-START-BROWSE.
 18397
 18398
 18399* EXEC CICS HANDLE CONDITION
 18400*        NOTFND    (6630-END-OF-FILE)
 18401*        DISABLED  (6630-ERRESS-PROBLEM)
 18402*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18403*        ENDFILE   (6630-END-OF-FILE)
 18404*    END-EXEC.
 18405*    MOVE '"$IcJ''                ! $ #00018378' TO DFHEIV0
 18406     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18407     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18408     MOVE X'2420233030303138333738' TO DFHEIV0(25:11)
 18409     CALL 'kxdfhei1' USING DFHEIV0
 18410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18411
 18412
 18413
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 336
* EL050.cbl
 18414* EXEC CICS STARTBR
 18415*        DATASET (FILE-ID-ERRESS)
 18416*        RIDFLD  (WS-ERRESS-KEY)
 18417*        GTEQ
 18418*    END-EXEC.
 18419     MOVE 0
 18420       TO DFHEIV11
 18421*    MOVE '&,         G          &   #00018385' TO DFHEIV0
 18422     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18423     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18424     MOVE X'2020233030303138333835' TO DFHEIV0(25:11)
 18425     CALL 'kxdfhei1' USING DFHEIV0,
 18426           FILE-ID-ERRESS,
 18427           WS-ERRESS-KEY,
 18428           DFHEIV99,
 18429           DFHEIV11,
 18430           DFHEIV99
 18431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18432
 18433
 18434 6620-READ-NEXT-ERRESS-MASTER.
 18435
 18436
 18437* EXEC CICS HANDLE CONDITION
 18438*        NOTFND    (6630-END-OF-FILE)
 18439*        ENDFILE   (6630-END-OF-FILE)
 18440*        DISABLED  (6630-ERRESS-PROBLEM)
 18441*        NOTOPEN   (6630-ERRESS-PROBLEM)
 18442*    END-EXEC.
 18443*    MOVE '"$I''cJ                ! % #00018393' TO DFHEIV0
 18444     MOVE X'22244927634A202020202020' TO DFHEIV0(1:12)
 18445     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18446     MOVE X'2520233030303138333933' TO DFHEIV0(25:11)
 18447     CALL 'kxdfhei1' USING DFHEIV0
 18448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18449
 18450
 18451
 18452* EXEC CICS READNEXT
 18453*        DATASET (FILE-ID-ERRESS)
 18454*        INTO    (RESIDENT-STATE-TAX-MASTER)
 18455*        RIDFLD  (WS-ERRESS-KEY)
 18456*    END-EXEC.
 18457     MOVE LENGTH OF
 18458      RESIDENT-STATE-TAX-MASTER
 18459       TO DFHEIV12
 18460     MOVE 0
 18461       TO DFHEIV11
 18462*    MOVE '&.IL                  )   #00018400' TO DFHEIV0
 18463     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18464     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18465     MOVE X'2020233030303138343030' TO DFHEIV0(25:11)
 18466     CALL 'kxdfhei1' USING DFHEIV0,
 18467           FILE-ID-ERRESS,
 18468           RESIDENT-STATE-TAX-MASTER,
 18469           DFHEIV12,
 18470           WS-ERRESS-KEY,
 18471           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 337
* EL050.cbl
 18472           DFHEIV11,
 18473           DFHEIV99,
 18474           DFHEIV99
 18475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18476
 18477
 18478     IF WS-SAVE-ERRESS-KEY (1:4) NOT = ERRESS-PRIMARY-KEY (1:4)
 18479
 18480* EXEC CICS ENDBR
 18481*            DATASET (FILE-ID-ERRESS)
 18482*       END-EXEC
 18483     MOVE 0
 18484       TO DFHEIV11
 18485*    MOVE '&2                    $   #00018407' TO DFHEIV0
 18486     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18487     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18488     MOVE X'2020233030303138343037' TO DFHEIV0(25:11)
 18489     CALL 'kxdfhei1' USING DFHEIV0,
 18490           FILE-ID-ERRESS,
 18491           DFHEIV11,
 18492           DFHEIV99
 18493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18494        GO TO 6630-END-OF-FILE.
 18495
 18496     IF WS-CONTRACT-DATE < RES-EXPIRE-DATE
 18497        NEXT SENTENCE
 18498      ELSE
 18499        GO TO 6620-READ-NEXT-ERRESS-MASTER.
 18500
 18501*IS IT LIFE(1) OR IS IT P&C(2) ?????
 18502*WS-SUB1 SELECTS LIFE OR P&C RES-TAX-RECORD-DATA OCCURRENCE OF MAS
 18503*
 18504     MOVE +2                     TO WS-SUB1.
 18505
 18506     IF PB-ISSUE
 18507     IF PB-I-POLICY-FORM-NO (6:1) = '1'
 18508        MOVE +1                  TO WS-SUB1.
 18509
 18510     IF PB-CANCELLATION
 18511     IF PB-C-POLICY-FORM-NO (6:1) = '1'
 18512        MOVE +1                  TO WS-SUB1.
 18513*
 18514*CONVERT ANNIVERSARY  DATE OF ACCOUNT MASTER TO YYYYMMDD FORMAT.
 18515*
 18516***  Y2K PROJ 7744
 18517     MOVE AM-ANNIVERSARY-DATE     TO WS-NEXT-CONTRACT-DATE.
 18518***  Y2K PROJ 7744
 18519
 18520*BUMP ANNIVERSARY DATE UP BY 1 YEAR IN WS-NEXT-CONTRACT-DATE
 18521* TEST IF ANNIVERSARY DATE HAS EXISTED MORE THAN 1 YEAR
 18522* TEST TO DETERMINE IF STATE AND MUNICIPAL RENEWAL PERCENT TAX APP
 18523
 18524     ADD 1                    TO WS-YEAR-YY.
 18525
 18526     IF WS-CONTRACT-DATE > WS-NEXT-CONTRACT-DATE
 18527         MOVE RES-REN-STATE-TAX (WS-SUB1)
 18528                              TO WS-RES-STATE-TAX
 18529         MOVE RES-REN-MUNICIPAL-TAX (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 338
* EL050.cbl
 18530                              TO WS-RES-MUNI-TAX
 18531     ELSE
 18532         MOVE RES-1YR-STATE-TAX (WS-SUB1)
 18533                              TO WS-RES-STATE-TAX
 18534         MOVE RES-1YR-MUNICIPAL-TAX (WS-SUB1)
 18535                              TO WS-RES-MUNI-TAX.
 18536
 18537*COMPUTE TAX DEPENDING ON NON ZERO AMOUNTS
 18538
 18539     IF PB-CANCELLATION
 18540         GO TO 6640-CANCEL-TAX.
 18541
 18542     IF PB-I-LF-PREMIUM-AMT > ZEROS
 18543         COMPUTE PB-I-STATE-TAX ROUNDED =
 18544                                   PB-I-LF-PREMIUM-AMT
 18545                                 * WS-RES-STATE-TAX
 18546         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18547                                   PB-I-LF-PREMIUM-AMT
 18548                                 * WS-RES-MUNI-TAX
 18549     ELSE
 18550     IF PB-I-AH-PREMIUM-AMT > ZEROS
 18551         COMPUTE PB-I-STATE-TAX ROUNDED =
 18552                                   PB-I-AH-PREMIUM-AMT
 18553                                 * WS-RES-STATE-TAX
 18554         COMPUTE PB-I-MUNI-TAX ROUNDED =
 18555                                   PB-I-AH-PREMIUM-AMT
 18556                                 * WS-RES-MUNI-TAX.
 18557
 18558
 18559* EXEC CICS ENDBR
 18560*         DATASET (FILE-ID-ERRESS)
 18561*    END-EXEC.
 18562     MOVE 0
 18563       TO DFHEIV11
 18564*    MOVE '&2                    $   #00018474' TO DFHEIV0
 18565     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18566     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18567     MOVE X'2020233030303138343734' TO DFHEIV0(25:11)
 18568     CALL 'kxdfhei1' USING DFHEIV0,
 18569           FILE-ID-ERRESS,
 18570           DFHEIV11,
 18571           DFHEIV99
 18572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18573
 18574
 18575     GO TO 6640-EXIT.
 18576
 18577 6640-CANCEL-TAX.
 18578     MOVE CM-POLICY-FORM-NO    TO PB-C-POLICY-FORM-NO.
 18579
 18580     IF PB-C-LF-CANCEL-AMT > ZEROS
 18581         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18582                                   PB-C-LF-CANCEL-AMT
 18583                                 * WS-RES-STATE-TAX
 18584         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18585                                   PB-C-LF-CANCEL-AMT
 18586                                *  WS-RES-MUNI-TAX
 18587     ELSE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 339
* EL050.cbl
 18588     IF PB-C-AH-CANCEL-AMT > ZEROS
 18589         COMPUTE PB-CI-STATE-TAX ROUNDED =
 18590                                   PB-C-AH-CANCEL-AMT
 18591                                 * WS-RES-STATE-TAX
 18592         COMPUTE PB-CI-MUNI-TAX ROUNDED =
 18593                                   PB-C-AH-CANCEL-AMT
 18594                                *  WS-RES-MUNI-TAX.
 18595
 18596
 18597* EXEC CICS ENDBR
 18598*         DATASET (FILE-ID-ERRESS)
 18599*    END-EXEC.
 18600     MOVE 0
 18601       TO DFHEIV11
 18602*    MOVE '&2                    $   #00018499' TO DFHEIV0
 18603     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18604     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18605     MOVE X'2020233030303138343939' TO DFHEIV0(25:11)
 18606     CALL 'kxdfhei1' USING DFHEIV0,
 18607           FILE-ID-ERRESS,
 18608           DFHEIV11,
 18609           DFHEIV99
 18610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18611
 18612
 18613     GO TO 6640-EXIT.
 18614
 18615 6630-END-OF-FILE.
 18616     MOVE ER-8002              TO WS-ERROR.
 18617     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18618
 18619     GO TO 6640-EXIT.
 18620
 18621 6630-ERRESS-PROBLEM.
 18622     MOVE ER-8044              TO WS-ERROR.
 18623     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18624
 18625 6640-EXIT.
 18626     EXIT.
 18627
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 340
* EL050.cbl
 18629 6650-GET-RES-STATE-COMM.
 18630
 18631     IF PB-COMPANY-ID NOT = 'DMD'
 18632         GO TO 6700-COMM-EXIT.
 18633
 18634     MOVE PB-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 18635     MOVE PB-SV-CARRIER       TO WS-ERRESC-CARRIER.
 18636     MOVE PB-SV-GROUPING      TO WS-ERRESC-GROUP.
 18637     MOVE PB-SV-STATE         TO WS-ERRESC-STATE.
 18638     MOVE PB-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 18639     MOVE AM-AGT (SUB1)       TO WS-ERRESC-AGENT.
 18640     MOVE PB-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 18641
 18642*CONVERT PB-CERT-EFF-DT TO YYYYMMDD FORMAT TO READ MASTER
 18643*
 18644***  Y2K PROJ 7744
 18645     MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1.
 18646     SET BIN-TO-GREG          TO TRUE.
 18647     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 18648
 18649     MOVE DC-GREG-DATE-CYMD   TO WS-CONTRACT-DATE.
 18650***  Y2K PROJ 7744
 18651
 18652     MOVE WS-CONTRACT-DATE    TO WS-ERRESC-EXPIRE-DT.
 18653
 18654
 18655* EXEC CICS HANDLE CONDITION
 18656*        INVREQ    (6660-START-BROWSE)
 18657*        DISABLED  (6690-ERRESC-PROBLEM)
 18658*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18659*        NOTFND    (6690-END-OF-FILE)
 18660*    END-EXEC.
 18661*    MOVE '"$8cJI                ! & #00018544' TO DFHEIV0
 18662     MOVE X'222438634A49202020202020' TO DFHEIV0(1:12)
 18663     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18664     MOVE X'2620233030303138353434' TO DFHEIV0(25:11)
 18665     CALL 'kxdfhei1' USING DFHEIV0
 18666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18667
 18668
 18669
 18670* EXEC CICS RESETBR
 18671*        DATASET (FILE-ID-ERRESC)
 18672*        RIDFLD  (WS-ERRESC-KEY)
 18673*    END-EXEC.
 18674     MOVE 0
 18675       TO DFHEIV11
 18676*    MOVE '&4         G          &   #00018551' TO DFHEIV0
 18677     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18678     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18679     MOVE X'2020233030303138353531' TO DFHEIV0(25:11)
 18680     CALL 'kxdfhei1' USING DFHEIV0,
 18681           FILE-ID-ERRESC,
 18682           WS-ERRESC-KEY,
 18683           DFHEIV99,
 18684           DFHEIV11,
 18685           DFHEIV99
 18686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 341
* EL050.cbl
 18687
 18688
 18689 6660-START-BROWSE.
 18690
 18691
 18692* EXEC CICS HANDLE CONDITION
 18693*        NOTFND    (6690-END-OF-FILE)
 18694*        DISABLED  (6690-ERRESC-PROBLEM)
 18695*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18696*        ENDFILE   (6690-END-OF-FILE)
 18697*    END-EXEC.
 18698*    MOVE '"$IcJ''                ! '' #00018558' TO DFHEIV0
 18699     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18700     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18701     MOVE X'2720233030303138353538' TO DFHEIV0(25:11)
 18702     CALL 'kxdfhei1' USING DFHEIV0
 18703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18704
 18705
 18706
 18707* EXEC CICS STARTBR
 18708*        DATASET (FILE-ID-ERRESC)
 18709*        RIDFLD  (WS-ERRESC-KEY)
 18710*        GTEQ
 18711*    END-EXEC.
 18712     MOVE 0
 18713       TO DFHEIV11
 18714*    MOVE '&,         G          &   #00018565' TO DFHEIV0
 18715     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18716     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18717     MOVE X'2020233030303138353635' TO DFHEIV0(25:11)
 18718     CALL 'kxdfhei1' USING DFHEIV0,
 18719           FILE-ID-ERRESC,
 18720           WS-ERRESC-KEY,
 18721           DFHEIV99,
 18722           DFHEIV11,
 18723           DFHEIV99
 18724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18725
 18726
 18727     MOVE WS-ERRESC-KEY           TO ERRESC-RECORD-KEY.
 18728
 18729 6670-READ-NEXT-ERRESC-MASTER.
 18730
 18731
 18732* EXEC CICS HANDLE CONDITION
 18733*        NOTFND    (6690-END-OF-FILE)
 18734*        DISABLED  (6690-ERRESC-PROBLEM)
 18735*        NOTOPEN   (6690-ERRESC-PROBLEM)
 18736*        ENDFILE   (6690-END-OF-FILE)
 18737*    END-EXEC.
 18738*    MOVE '"$IcJ''                ! ( #00018575' TO DFHEIV0
 18739     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 18740     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18741     MOVE X'2820233030303138353735' TO DFHEIV0(25:11)
 18742     CALL 'kxdfhei1' USING DFHEIV0
 18743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18744
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 342
* EL050.cbl
 18745
 18746
 18747* EXEC CICS READNEXT
 18748*        DATASET (FILE-ID-ERRESC)
 18749*        INTO    (ACCOUNT-RESIDENT-ST-COMMISSION)
 18750*        RIDFLD  (ERRESC-RECORD-KEY)
 18751*    END-EXEC.
 18752     MOVE LENGTH OF
 18753      ACCOUNT-RESIDENT-ST-COMMISSION
 18754       TO DFHEIV12
 18755     MOVE 0
 18756       TO DFHEIV11
 18757*    MOVE '&.IL                  )   #00018582' TO DFHEIV0
 18758     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 18759     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18760     MOVE X'2020233030303138353832' TO DFHEIV0(25:11)
 18761     CALL 'kxdfhei1' USING DFHEIV0,
 18762           FILE-ID-ERRESC,
 18763           ACCOUNT-RESIDENT-ST-COMMISSION,
 18764           DFHEIV12,
 18765           ERRESC-RECORD-KEY,
 18766           DFHEIV99,
 18767           DFHEIV11,
 18768           DFHEIV99,
 18769           DFHEIV99
 18770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18771
 18772
 18773     IF ERRESC-RECORD-KEY (1:32) = WS-ERRESC-KEY (1:32)
 18774        NEXT SENTENCE
 18775     ELSE
 18776
 18777* EXEC CICS ENDBR
 18778*            DATASET (FILE-ID-ERRESC)
 18779*       END-EXEC
 18780     MOVE 0
 18781       TO DFHEIV11
 18782*    MOVE '&2                    $   #00018591' TO DFHEIV0
 18783     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18784     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18785     MOVE X'2020233030303138353931' TO DFHEIV0(25:11)
 18786     CALL 'kxdfhei1' USING DFHEIV0,
 18787           FILE-ID-ERRESC,
 18788           DFHEIV11,
 18789           DFHEIV99
 18790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18791        GO TO 6690-END-OF-FILE.
 18792
 18793     IF WS-CONTRACT-DATE < RESC-EFFECTIVE-DATE
 18794
 18795* EXEC CICS ENDBR
 18796*            DATASET (FILE-ID-ERRESC)
 18797*       END-EXEC
 18798     MOVE 0
 18799       TO DFHEIV11
 18800*    MOVE '&2                    $   #00018597' TO DFHEIV0
 18801     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18802     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 343
* EL050.cbl
 18803     MOVE X'2020233030303138353937' TO DFHEIV0(25:11)
 18804     CALL 'kxdfhei1' USING DFHEIV0,
 18805           FILE-ID-ERRESC,
 18806           DFHEIV11,
 18807           DFHEIV99
 18808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18809        GO TO 6690-END-OF-FILE.
 18810
 18811     IF WS-CONTRACT-DATE < RESC-EXPIRE-DATE
 18812        NEXT SENTENCE
 18813      ELSE
 18814        GO TO 6670-READ-NEXT-ERRESC-MASTER.
 18815
 18816* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 18817*
 18818     MOVE ZEROS               TO WS-SUB WS-SUB1.
 18819
 18820     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 18821
 18822     IF WS-SUB1 > ZERO
 18823         IF RESC-COMMISSION-PER (WS-SUB) IS NUMERIC
 18824             PERFORM 6680-SET-COMMISSION
 18825         ELSE
 18826             PERFORM 6680-SET-TABLE-CODE.
 18827
 18828
 18829* EXEC CICS ENDBR
 18830*         DATASET (FILE-ID-ERRESC)
 18831*    END-EXEC.
 18832     MOVE 0
 18833       TO DFHEIV11
 18834*    MOVE '&2                    $   #00018619' TO DFHEIV0
 18835     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18836     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18837     MOVE X'2020233030303138363139' TO DFHEIV0(25:11)
 18838     CALL 'kxdfhei1' USING DFHEIV0,
 18839           FILE-ID-ERRESC,
 18840           DFHEIV11,
 18841           DFHEIV99
 18842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18843
 18844
 18845     GO TO 6700-COMM-EXIT.
 18846
 18847 6680-SET-TABLE-CODE.
 18848     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 18849        MOVE ZEROS             TO WS-SUB1
 18850     ELSE
 18851* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 18852* TO COMPUTE AH COMMISSION.
 18853        MOVE WS-AH-COMP-CD                TO CTBL-BEN-CODE
 18854        MOVE PB-I-AH-TERM                 TO WS-WORK-TERM
 18855        MOVE PB-AH-OVERRIDE-L1            TO CTBL-BEN-TYPE
 18856        MOVE RESC-COMMISSION-TAB (WS-SUB) TO CTBL-TABLE
 18857        PERFORM 6680-READ-CTBL-TABLE
 18858        IF WS-CTBL-READ-SW NOT = 'Y'
 18859           MOVE ZEROS          TO WS-SUB1.
 18860
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 344
* EL050.cbl
 18861 6680-READ-CTBL-TABLE.
 18862*
 18863* WHEN CTBL-SW = '0540' READ COMMISSION TABLE(CTBL)
 18864* TO COMPUTE LIFE COMMISSION
 18865
 18866     IF CTBL-SW = '0540'
 18867        MOVE WS-LF-COMP-CD       TO CTBL-BEN-CODE
 18868        MOVE PB-I-LF-TERM        TO WS-WORK-TERM
 18869        MOVE PB-LIFE-OVERRIDE-L1 TO CTBL-BEN-TYPE.
 18870
 18871     PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT.
 18872
 18873     IF CTBL-TABLE-FOUND
 18874        IF CTBL-SW = '0530'
 18875             COMPUTE WS-COMM-CK-AMT = PB-I-AH-BENEFIT-AMT
 18876                                    * PB-I-AH-TERM
 18877             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18878             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-AH-COMMISSION
 18879        ELSE
 18880             MOVE PB-I-LF-BENEFIT-AMT TO WS-COMM-CK-AMT
 18881             PERFORM 8800-GET-COMP-RATE THRU 8800-EXIT
 18882             MOVE WS-WK-RATE TO WS-COMMISSION PB-I-LIFE-COMMISSION
 18883     ELSE
 18884        IF FIRST-TIME-THROUGH
 18885            GO TO 6680-READ-CTBL-TABLE
 18886        ELSE
 18887            MOVE ZEROS         TO WS-SUB1.
 18888
 18889 6680-SET-COMMISSION.
 18890     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 18891           MOVE ZEROS          TO WS-SUB1
 18892       ELSE
 18893           MOVE RESC-COMMISSION-PER (WS-SUB)
 18894                               TO WS-COMMISSION
 18895           IF CTBL-SW = '0530'
 18896               MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 18897           ELSE
 18898               MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 18899
 18900 6680-SEARCH-CATEGORY.
 18901     ADD +1                   TO WS-SUB.
 18902     IF WS-SUB > +12
 18903         GO TO 6680-EXIT.
 18904
 18905     IF PB-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 18906          MOVE WS-SUB         TO WS-SUB1
 18907          GO TO 6680-EXIT.
 18908
 18909     GO TO 6680-SEARCH-CATEGORY.
 18910
 18911 6680-EXIT.
 18912     EXIT.
 18913
 18914 6690-END-OF-FILE.
 18915     GO TO 6700-COMM-EXIT.
 18916
 18917 6690-ERRESC-PROBLEM.
 18918      MOVE ER-8030              TO WS-ERROR.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 345
* EL050.cbl
 18919      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18920
 18921      GO TO 6700-COMM-EXIT.
 18922
 18923 6700-COMM-EXIT.
 18924     EXIT.
 18925
 18926 7000-GET-RATE.
 18927
 18928* EXEC CICS LINK
 18929*        PROGRAM    ('ELRATE')
 18930*        COMMAREA   (CALCULATION-PASS-AREA)
 18931*        LENGTH     (CP-COMM-LENGTH)
 18932*    END-EXEC.
 18933     MOVE 'ELRATE' TO DFHEIV1
 18934*    MOVE '."C                   (   #00018705' TO DFHEIV0
 18935     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 18936     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18937     MOVE X'2020233030303138373035' TO DFHEIV0(25:11)
 18938     CALL 'kxdfhei1' USING DFHEIV0,
 18939           DFHEIV1,
 18940           CALCULATION-PASS-AREA,
 18941           CP-COMM-LENGTH,
 18942           DFHEIV99,
 18943           DFHEIV99,
 18944           DFHEIV99,
 18945           DFHEIV99
 18946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18947
 18948
 18949 7000-EXIT.
 18950     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 346
* EL050.cbl
 18952 7100-FIND-BENEFIT-IN-STATE.
 18953     MOVE 'N'                    TO BEN-SEARCH-SW.
 18954
 18955     PERFORM 7100-BENEFIT-DUMMY THRU 7100-DUMMY-EXIT
 18956         VARYING SUB3 FROM 1 BY 1 UNTIL
 18957            ((SUB3 GREATER 50) OR
 18958              ((CF-ST-BENEFIT-CD (SUB3) = WS-BEN-CD)
 18959               AND (WS-LOOKUP-TYPE = CF-ST-BENEFIT-KIND (SUB3)))).
 18960
 18961     IF SUB3 NOT = 51
 18962         MOVE 'Y'                TO BEN-SEARCH-SW.
 18963
 18964     GO TO 7199-EXIT.
 18965
 18966 7100-BENEFIT-DUMMY.
 18967
 18968 7100-DUMMY-EXIT.
 18969     EXIT.
 18970
 18971 7199-EXIT.
 18972     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 347
* EL050.cbl
 18974 7200-FIND-BENEFIT.
 18975     MOVE 'N'                    TO BEN-SEARCH-SW.
 18976
 18977     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18978         VARYING SUB3 FROM 1 BY 1 UNTIL
 18979            ((SUB3 GREATER 8) OR
 18980            (CF-BENEFIT-NUMERIC (SUB3) = WS-BEN-CD)).
 18981
 18982     IF SUB3 NOT = 9
 18983         MOVE 'Y'                TO BEN-SEARCH-SW.
 18984
 18985     GO TO 7200-EXIT.
 18986
 18987 7200-BENEFIT-DUMMY.
 18988
 18989 7200-DUMMY-EXIT.
 18990     EXIT.
 18991
 18992 7200-EXIT.
 18993     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 348
* EL050.cbl
 18995 7250-LOOK-FOR-RESCINDED-CLAIM.
 18996     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 18997                                    W-CL-COMP-CD.
 18998     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 18999                                    W-CL-CERT-NO.
 19000
 19001
 19002* EXEC CICS HANDLE CONDITION
 19003*        NOTFND  (7250-CONTINUE)
 19004*        ENDFILE (7250-CONTINUE)
 19005*    END-EXEC.
 19006*    MOVE '"$I''                  ! ) #00018763' TO DFHEIV0
 19007     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19009     MOVE X'2920233030303138373633' TO DFHEIV0(25:11)
 19010     CALL 'kxdfhei1' USING DFHEIV0
 19011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19012
 19013
 19014
 19015* EXEC CICS IGNORE CONDITION
 19016*        DUPKEY
 19017*    END-EXEC.
 19018*    MOVE '"*$                   !   #00018768' TO DFHEIV0
 19019     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19020     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19021     MOVE X'2020233030303138373638' TO DFHEIV0(25:11)
 19022     CALL 'kxdfhei1' USING DFHEIV0
 19023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19024
 19025
 19026
 19027* EXEC CICS STARTBR
 19028*        DATASET   (CLMS-ID)
 19029*        RIDFLD    (ELMSTR-KEY)
 19030*        GENERIC   EQUAL
 19031*        KEYLENGTH (ELMSTR-LENGTH)
 19032*    END-EXEC.
 19033     MOVE 0
 19034       TO DFHEIV11
 19035*    MOVE '&,   KG    E          &   #00018772' TO DFHEIV0
 19036     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19037     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19038     MOVE X'2020233030303138373732' TO DFHEIV0(25:11)
 19039     CALL 'kxdfhei1' USING DFHEIV0,
 19040           CLMS-ID,
 19041           ELMSTR-KEY,
 19042           ELMSTR-LENGTH,
 19043           DFHEIV11,
 19044           DFHEIV99
 19045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19046
 19047
 19048     MOVE 'Y'                    TO W-BROWSE-SW.
 19049
 19050 7250-NEXT-CLAIM.
 19051
 19052
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 349
* EL050.cbl
 19053* EXEC CICS READNEXT
 19054*        DATASET   (CLMS-ID)
 19055*        RIDFLD    (ELMSTR-KEY)
 19056*        SET       (ADDRESS OF CLAIM-MASTER)
 19057*    END-EXEC.
 19058     MOVE 0
 19059       TO DFHEIV11
 19060*    MOVE '&.S                   )   #00018783' TO DFHEIV0
 19061     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19062     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19063     MOVE X'2020233030303138373833' TO DFHEIV0(25:11)
 19064     CALL 'kxdfhei1' USING DFHEIV0,
 19065           CLMS-ID,
 19066           DFHEIV20,
 19067           DFHEIV99,
 19068           ELMSTR-KEY,
 19069           DFHEIV99,
 19070           DFHEIV11,
 19071           DFHEIV99,
 19072           DFHEIV99
 19073     SET ADDRESS OF CLAIM-MASTER TO
 19074         DFHEIV20
 19075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19076
 19077
 19078     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19079        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19080         GO TO 7250-CONTINUE
 19081     END-IF.
 19082
 19083     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19084        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19085        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19086        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19087        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19088         GO TO 7250-NEXT-CLAIM
 19089     END-IF.
 19090
 19091     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19092        OR (CL-CLAIM-TYPE = 'I')
 19093        OR (CL-CLAIM-TYPE = 'G')
 19094        OR (CL-CLAIM-TYPE = 'F')
 19095          IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19096              MOVE 'Y' TO WS-AH-CLAIM-RESCINDED
 19097              GO TO 7250-CONTINUE
 19098          END-IF
 19099     END-IF.
 19100
 19101     GO TO 7250-NEXT-CLAIM.
 19102
 19103 7250-CONTINUE.
 19104
 19105     IF W-BROWSE-SW = 'Y'
 19106
 19107* EXEC CICS ENDBR
 19108*            DATASET   (CLMS-ID)
 19109*        END-EXEC
 19110     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 350
* EL050.cbl
 19111       TO DFHEIV11
 19112*    MOVE '&2                    $   #00018817' TO DFHEIV0
 19113     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19114     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19115     MOVE X'2020233030303138383137' TO DFHEIV0(25:11)
 19116     CALL 'kxdfhei1' USING DFHEIV0,
 19117           CLMS-ID,
 19118           DFHEIV11,
 19119           DFHEIV99
 19120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19121         MOVE 'N' TO W-BROWSE-SW
 19122     END-IF.
 19123
 19124 7250-EXIT.
 19125     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 351
* EL050.cbl
 19127 7300-CHECK-FOR-OPEN-CLMS.
 19128
 19129*    MOVE PB-COMPANY-ID          TO CNTL-COMP-ID.
 19130*    MOVE SPACES                 TO CNTL-ACCESS.
 19131*    MOVE '1'                    TO CNTL-REC-TYPE.
 19132*    MOVE +0                     TO CNTL-SEQ-NO.
 19133
 19134*    MOVE '3'                    TO RC-SW-1.
 19135*    PERFORM 9000-READ-CONTROL THRU 9000-EXIT.
 19136
 19137*    IF NOT CF-COMPANY-MASTER
 19138*         PERFORM 0099-COMPANY-NOT-FOUND
 19139*         GO TO 7300-EXIT.
 19140
 19141     MOVE PB-COMPANY-CD          TO MSTR-COMP-CD
 19142                                    W-CL-COMP-CD.
 19143     MOVE PB-CERT-NO             TO MSTR-CERT-NO
 19144                                    W-CL-CERT-NO.
 19145
 19146
 19147* EXEC CICS HANDLE CONDITION
 19148*        NOTFND  (7300-CONTINUE)
 19149*        ENDFILE (7300-CONTINUE)
 19150*    END-EXEC.
 19151*    MOVE '"$I''                  ! * #00018845' TO DFHEIV0
 19152     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19154     MOVE X'2A20233030303138383435' TO DFHEIV0(25:11)
 19155     CALL 'kxdfhei1' USING DFHEIV0
 19156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19157
 19158
 19159
 19160* EXEC CICS IGNORE CONDITION
 19161*        DUPKEY
 19162*    END-EXEC.
 19163*    MOVE '"*$                   !   #00018850' TO DFHEIV0
 19164     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 19165     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19166     MOVE X'2020233030303138383530' TO DFHEIV0(25:11)
 19167     CALL 'kxdfhei1' USING DFHEIV0
 19168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19169
 19170
 19171
 19172* EXEC CICS STARTBR
 19173*        DATASET   (CLMS-ID)
 19174*        RIDFLD    (ELMSTR-KEY)
 19175*        GENERIC   EQUAL
 19176*        KEYLENGTH (ELMSTR-LENGTH)
 19177*    END-EXEC.
 19178     MOVE 0
 19179       TO DFHEIV11
 19180*    MOVE '&,   KG    E          &   #00018854' TO DFHEIV0
 19181     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 19182     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19183     MOVE X'2020233030303138383534' TO DFHEIV0(25:11)
 19184     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 352
* EL050.cbl
 19185           CLMS-ID,
 19186           ELMSTR-KEY,
 19187           ELMSTR-LENGTH,
 19188           DFHEIV11,
 19189           DFHEIV99
 19190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19191
 19192
 19193     MOVE 'Y'                    TO W-BROWSE-SW.
 19194
 19195 7300-NEXT-CLAIM.
 19196
 19197
 19198* EXEC CICS READNEXT
 19199*        DATASET   (CLMS-ID)
 19200*        RIDFLD    (ELMSTR-KEY)
 19201*        SET       (ADDRESS OF CLAIM-MASTER)
 19202*    END-EXEC.
 19203     MOVE 0
 19204       TO DFHEIV11
 19205*    MOVE '&.S                   )   #00018865' TO DFHEIV0
 19206     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19207     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19208     MOVE X'2020233030303138383635' TO DFHEIV0(25:11)
 19209     CALL 'kxdfhei1' USING DFHEIV0,
 19210           CLMS-ID,
 19211           DFHEIV20,
 19212           DFHEIV99,
 19213           ELMSTR-KEY,
 19214           DFHEIV99,
 19215           DFHEIV11,
 19216           DFHEIV99,
 19217           DFHEIV99
 19218     SET ADDRESS OF CLAIM-MASTER TO
 19219         DFHEIV20
 19220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19221
 19222
 19223     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 19224        MSTR-CERT-NO(1:10) NOT = W-CL-CERT-NO(1:10)
 19225         GO TO 7300-CONTINUE.
 19226
 19227     IF PB-SV-CARRIER  NOT = CL-CARRIER        OR
 19228        PB-SV-GROUPING NOT = CL-CERT-GROUPING  OR
 19229        PB-SV-STATE    NOT = CL-CERT-STATE     OR
 19230        PB-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 19231        PB-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 19232         GO TO 7300-NEXT-CLAIM.
 19233
 19234*    IF CL-CLAIM-TYPE = CF-AH-OVERRIDE-L1 OR
 19235     IF (CL-CLAIM-TYPE = PB-AH-OVERRIDE-L1)
 19236        OR (CL-CLAIM-TYPE = 'I')
 19237        OR (CL-CLAIM-TYPE = 'G')
 19238        OR (CL-CLAIM-TYPE = 'F')
 19239        IF CLAIM-IS-OPEN
 19240           IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19241             AND PB-C-AH-CANCEL-DT > SPACES
 19242              MOVE ER-2896        TO WS-ERROR
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 353
* EL050.cbl
 19243              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19244           END-IF
 19245           EVALUATE TRUE
 19246             WHEN WS-ST-REFUND-CLAIM-FLAG = '1'
 19247                 MOVE ER-2884      TO WS-ERROR
 19248             WHEN WS-ST-REFUND-CLAIM-FLAG = '2'
 19249                 MOVE ER-2887      TO WS-ERROR
 19250             WHEN WS-ST-REFUND-CLAIM-FLAG = '3'
 19251                 MOVE ER-2886      TO WS-ERROR
 19252             WHEN WS-ST-REFUND-CLAIM-FLAG = '4'
 19253                 MOVE ER-2888      TO WS-ERROR
 19254             WHEN WS-ST-REFUND-CLAIM-FLAG = '5'
 19255                 MOVE ER-2885      TO WS-ERROR
 19256             WHEN OTHER
 19257                 MOVE ER-2768      TO WS-ERROR
 19258           END-EVALUATE
 19259           IF PB-C-AH-CANCEL-VOIDED OR
 19260              ((WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19261                NOT AH-COVERAGE-CANCELLED)
 19262               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19263               MOVE ER-2768      TO WS-ERROR
 19264           END-IF
 19265           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19266           IF (WS-ST-REFUND-CLAIM-FLAG = '2' OR '3' OR '4') AND
 19267              PB-FORCE-CODE NOT EQUAL '8'
 19268               MOVE SPACES TO WS-ST-REFUND-CLAIM-FLAG
 19269           END-IF
 19270           PERFORM 8190-UPDATE-REFUND-CLAIM-FLAG THRU 8190-EXIT
 19271           GO TO 7300-NEXT-CLAIM
 19272        ELSE
 19273           IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19274*****THIS IS A RESCISSION OR REFORMATION
 19275              IF AH-COVERAGE-CANCELLED
 19276                 IF WS-ST-CAUSAL-STATE = ('A' OR 'B')
 19277                    MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 19278                    MOVE 1                   TO DC-ELAPSED-DAYS
 19279                    MOVE ZERO                TO DC-ELAPSED-MONTHS
 19280                    SET BIN-PLUS-ELAPSED     TO TRUE
 19281                    PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 19282                    IF NO-CONVERSION-ERROR
 19283                       IF NOT (DC-BIN-DATE-2 = PB-C-AH-CANCEL-DT
 19284                        OR PB-C-AH-CANCEL-DT = CL-CERT-EFF-DT)
 19285                          MOVE ER-2897 TO WS-ERROR
 19286                          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19287                          GO TO 7300-NEXT-CLAIM
 19288                       END-IF
 19289                    END-IF
 19290                 ELSE
 19291                   IF PB-C-AH-CANCEL-DT <> CL-CERT-EFF-DT
 19292                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19293                         MOVE ER-2890 TO WS-ERROR
 19294                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19295                         GO TO 7300-NEXT-CLAIM
 19296                      ELSE
 19297                         MOVE ER-2898 TO WS-ERROR
 19298                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19299                         GO TO 7300-NEXT-CLAIM
 19300                      END-IF
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 354
* EL050.cbl
 19301                   END-IF
 19302                 END-IF
 19303              END-IF
 19304           ELSE
 19305              IF CL-DENIAL-TYPE = '1'  AND
 19306                 CL-TOTAL-PAID-AMT = 0
 19307                    GO TO 7300-NEXT-CLAIM
 19308              END-IF
 19309              IF PB-C-AH-CANCEL-DT <= CL-PAID-THRU-DT
 19310               AND PB-C-AH-CANCEL-DT > SPACES
 19311                 MOVE ER-2756        TO WS-ERROR
 19312                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19313                 GO TO 7300-NEXT-CLAIM
 19314              END-IF
 19315           END-IF
 19316        END-IF
 19317     ELSE
 19318*       IF CL-CLAIM-TYPE = CF-LIFE-OVERRIDE-L1
 19319        IF CL-CLAIM-TYPE = PB-LIFE-OVERRIDE-L1
 19320           IF (CLAIM-IS-OPEN)
 19321              and ((pb-ci-lf-cancel-amt + pb-c-lf-cancel-amt)
 19322                 <> zeros
 19323              or (pb-ci-ah-cancel-amt + pb-c-ah-cancel-amt)
 19324                 <> zeros)
 19325              MOVE ER-2889      TO WS-ERROR
 19326              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19327              GO TO 7300-NEXT-CLAIM
 19328           ELSE
 19329              IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
 19330*****THIS IS A RESCISSION OR REFORMATION or refor to rescission
 19331                 IF (LF-COVERAGE-CANCELLED AND
 19332                     PB-C-LF-CANCEL-DT <> CL-CERT-EFF-DT)
 19333                      IF MSTR-CERT-NO = W-CL-CERT-NO
 19334                         MOVE ER-2890 TO WS-ERROR
 19335                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19336                         GO TO 7300-NEXT-CLAIM
 19337                      ELSE
 19338                         MOVE ER-2898 TO WS-ERROR
 19339                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19340                         GO TO 7300-NEXT-CLAIM
 19341                      END-IF
 19342                 END-IF
 19343              ELSE
 19344                 IF (CL-DENIAL-TYPE = '1')   *> regular denial
 19345                    and (CL-TOTAL-PAID-AMT = 0)
 19346                    GO TO 7300-NEXT-CLAIM
 19347                 END-IF
 19348                 IF (
 19349                      (AH-COVERAGE-CANCELLED)
 19350                      AND (PB-C-AH-CANCEL-DT <> CL-INCURRED-DT)
 19351                      AND (WS-AH-CLAIM-RESCINDED <> 'Y')
 19352                      and (pb-ci-ah-cancel-amt +
 19353                         pb-c-ah-cancel-amt) <> zeros
 19354                    )
 19355                               OR
 19356                    (
 19357                      (LF-COVERAGE-CANCELLED)
 19358                      AND (PB-C-LF-CANCEL-DT <> CL-INCURRED-DT)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 355
* EL050.cbl
 19359                      AND (WS-ST-REFUND-CLAIM-FLAG = '4')
 19360                      and (pb-ci-lf-cancel-amt +
 19361                         pb-c-lf-cancel-amt) <> zeros
 19362                    )
 19363                       MOVE ER-2965 TO WS-ERROR
 19364                       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19365                       GO TO 7300-NEXT-CLAIM
 19366                 END-IF
 19367                 IF LF-COVERAGE-CANCELLED
 19368                  IF CL-TOTAL-PAID-AMT > 0
 19369                    IF WS-ST-REFUND-CLAIM-FLAG = '4'
 19370                      IF PB-C-LF-CANCEL-DT = CL-INCURRED-DT
 19371                        MOVE ER-2891 TO WS-ERROR
 19372                        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19373                        GO TO 7300-NEXT-CLAIM
 19374                      END-IF
 19375                    ELSE
 19376****only show this error if cert num matches exactly
 19377                      IF PB-CERT-NO = CL-CERT-NO
 19378                         MOVE ER-2892 TO WS-ERROR
 19379                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19380                         GO TO 7300-NEXT-CLAIM
 19381                      END-IF
 19382                    END-IF
 19383                  END-IF
 19384                 END-IF
 19385              END-IF
 19386           END-IF
 19387        END-IF
 19388     END-IF
 19389
 19390     GO TO 7300-NEXT-CLAIM.
 19391
 19392 7300-CONTINUE.
 19393
 19394     IF W-BROWSE-SW = 'Y'
 19395
 19396* EXEC CICS ENDBR
 19397*            DATASET   (CLMS-ID)
 19398*        END-EXEC.
 19399     MOVE 0
 19400       TO DFHEIV11
 19401*    MOVE '&2                    $   #00019043' TO DFHEIV0
 19402     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19403     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19404     MOVE X'2020233030303139303433' TO DFHEIV0(25:11)
 19405     CALL 'kxdfhei1' USING DFHEIV0,
 19406           CLMS-ID,
 19407           DFHEIV11,
 19408           DFHEIV99
 19409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19410
 19411
 19412 7300-EXIT.
 19413     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 356
* EL050.cbl
 19415
 19416 7400-GET-REMAIN-TERM.
 19417
 19418* EXEC CICS LINK
 19419*        PROGRAM    ('ELRTRM')
 19420*        COMMAREA   (CALCULATION-PASS-AREA)
 19421*        LENGTH     (CP-COMM-LENGTH)
 19422*    END-EXEC.
 19423     MOVE 'ELRTRM' TO DFHEIV1
 19424*    MOVE '."C                   (   #00019052' TO DFHEIV0
 19425     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19426     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19427     MOVE X'2020233030303139303532' TO DFHEIV0(25:11)
 19428     CALL 'kxdfhei1' USING DFHEIV0,
 19429           DFHEIV1,
 19430           CALCULATION-PASS-AREA,
 19431           CP-COMM-LENGTH,
 19432           DFHEIV99,
 19433           DFHEIV99,
 19434           DFHEIV99,
 19435           DFHEIV99
 19436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19437
 19438
 19439 7400-EXIT.
 19440     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 357
* EL050.cbl
 19442
 19443 7500-GET-REMAIN-AMOUNT.
 19444
 19445* EXEC CICS LINK
 19446*        PROGRAM    ('ELRAMT')
 19447*        COMMAREA   (CALCULATION-PASS-AREA)
 19448*        LENGTH     (CP-COMM-LENGTH)
 19449*    END-EXEC.
 19450     MOVE 'ELRAMT' TO DFHEIV1
 19451*    MOVE '."C                   (   #00019063' TO DFHEIV0
 19452     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19453     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19454     MOVE X'2020233030303139303633' TO DFHEIV0(25:11)
 19455     CALL 'kxdfhei1' USING DFHEIV0,
 19456           DFHEIV1,
 19457           CALCULATION-PASS-AREA,
 19458           CP-COMM-LENGTH,
 19459           DFHEIV99,
 19460           DFHEIV99,
 19461           DFHEIV99,
 19462           DFHEIV99
 19463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19464
 19465
 19466 7500-EXIT.
 19467     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 358
* EL050.cbl
 19469
 19470 7600-GET-REFUND.
 19471
 19472* EXEC CICS LINK
 19473*        PROGRAM    ('ELRFND')
 19474*        COMMAREA   (CALCULATION-PASS-AREA)
 19475*        LENGTH     (CP-COMM-LENGTH)
 19476*    END-EXEC.
 19477     MOVE 'ELRFND' TO DFHEIV1
 19478*    MOVE '."C                   (   #00019074' TO DFHEIV0
 19479     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19480     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19481     MOVE X'2020233030303139303734' TO DFHEIV0(25:11)
 19482     CALL 'kxdfhei1' USING DFHEIV0,
 19483           DFHEIV1,
 19484           CALCULATION-PASS-AREA,
 19485           CP-COMM-LENGTH,
 19486           DFHEIV99,
 19487           DFHEIV99,
 19488           DFHEIV99,
 19489           DFHEIV99
 19490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19491
 19492
 19493 7600-EXIT.
 19494     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 359
* EL050.cbl
 19496 7700-CALL-DL1.
 19497
 19498* EXEC CICS LINK
 19499*        PROGRAM    ('DLO001')
 19500*        COMMAREA   (WS-DLO-MASTER-POLICY-FORM)
 19501*        LENGTH     (DLO001-COMM-LENGTH)
 19502*    END-EXEC.
 19503     MOVE 'DLO001' TO DFHEIV1
 19504*    MOVE '."C                   (   #00019084' TO DFHEIV0
 19505     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19506     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19507     MOVE X'2020233030303139303834' TO DFHEIV0(25:11)
 19508     CALL 'kxdfhei1' USING DFHEIV0,
 19509           DFHEIV1,
 19510           WS-DLO-MASTER-POLICY-FORM,
 19511           DLO001-COMM-LENGTH,
 19512           DFHEIV99,
 19513           DFHEIV99,
 19514           DFHEIV99,
 19515           DFHEIV99
 19516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19517
 19518
 19519 7700-EXIT.
 19520     EXIT.
 19521
 19522 7710-CALL-DL2.
 19523
 19524* EXEC CICS LINK
 19525*        PROGRAM    ('DLO002')
 19526*        COMMAREA   (WS-DLO-INTERNAL-POLICY-FORM)
 19527*        LENGTH     (DLO002-COMM-LENGTH)
 19528*    END-EXEC.
 19529     MOVE 'DLO002' TO DFHEIV1
 19530*    MOVE '."C                   (   #00019094' TO DFHEIV0
 19531     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19532     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19533     MOVE X'2020233030303139303934' TO DFHEIV0(25:11)
 19534     CALL 'kxdfhei1' USING DFHEIV0,
 19535           DFHEIV1,
 19536           WS-DLO-INTERNAL-POLICY-FORM,
 19537           DLO002-COMM-LENGTH,
 19538           DFHEIV99,
 19539           DFHEIV99,
 19540           DFHEIV99,
 19541           DFHEIV99
 19542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19543
 19544
 19545 7710-EXIT.
 19546     EXIT.
 19547
 19548 7720-CALL-DL3.
 19549
 19550* EXEC CICS LINK
 19551*        PROGRAM    ('DLO003')
 19552*        COMMAREA   (WS-DLO-VALID-BANK-ID)
 19553*        LENGTH     (DLO003-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 360
* EL050.cbl
 19554*    END-EXEC.
 19555     MOVE 'DLO003' TO DFHEIV1
 19556*    MOVE '."C                   (   #00019104' TO DFHEIV0
 19557     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19558     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19559     MOVE X'2020233030303139313034' TO DFHEIV0(25:11)
 19560     CALL 'kxdfhei1' USING DFHEIV0,
 19561           DFHEIV1,
 19562           WS-DLO-VALID-BANK-ID,
 19563           DLO003-COMM-LENGTH,
 19564           DFHEIV99,
 19565           DFHEIV99,
 19566           DFHEIV99,
 19567           DFHEIV99
 19568     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19569
 19570
 19571 7720-EXIT.
 19572     EXIT.
 19573
 19574 7730-CALL-DL7.
 19575
 19576* EXEC CICS LINK
 19577*        PROGRAM    ('DLO007')
 19578*        COMMAREA   (WS-DLO-CERT-UNDRWRTR-ASSIGN)
 19579*        LENGTH     (DLO007-COMM-LENGTH)
 19580*    END-EXEC.
 19581     MOVE 'DLO007' TO DFHEIV1
 19582*    MOVE '."C                   (   #00019114' TO DFHEIV0
 19583     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19584     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19585     MOVE X'2020233030303139313134' TO DFHEIV0(25:11)
 19586     CALL 'kxdfhei1' USING DFHEIV0,
 19587           DFHEIV1,
 19588           WS-DLO-CERT-UNDRWRTR-ASSIGN,
 19589           DLO007-COMM-LENGTH,
 19590           DFHEIV99,
 19591           DFHEIV99,
 19592           DFHEIV99,
 19593           DFHEIV99
 19594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19595
 19596
 19597 7730-EXIT.
 19598     EXIT.
 19599
 19600 7740-CALL-DL11.
 19601
 19602* EXEC CICS LINK
 19603*        PROGRAM    ('DLO011')
 19604*        COMMAREA   (WS-DLO-PREM-RATES-BEN-TYPE)
 19605*        LENGTH     (DLO011-COMM-LENGTH)
 19606*    END-EXEC.
 19607     MOVE 'DLO011' TO DFHEIV1
 19608*    MOVE '."C                   (   #00019124' TO DFHEIV0
 19609     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19610     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19611     MOVE X'2020233030303139313234' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 361
* EL050.cbl
 19612     CALL 'kxdfhei1' USING DFHEIV0,
 19613           DFHEIV1,
 19614           WS-DLO-PREM-RATES-BEN-TYPE,
 19615           DLO011-COMM-LENGTH,
 19616           DFHEIV99,
 19617           DFHEIV99,
 19618           DFHEIV99,
 19619           DFHEIV99
 19620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19621
 19622
 19623 7740-EXIT.
 19624     EXIT.
 19625
 19626 7750-CALL-DL17.
 19627
 19628* EXEC CICS LINK
 19629*        PROGRAM    ('DLO017')
 19630*        COMMAREA   (WS-DLO-VALID-RATE-CODE)
 19631*        LENGTH     (DLO017-COMM-LENGTH)
 19632*    END-EXEC.
 19633     MOVE 'DLO017' TO DFHEIV1
 19634*    MOVE '."C                   (   #00019134' TO DFHEIV0
 19635     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19636     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19637     MOVE X'2020233030303139313334' TO DFHEIV0(25:11)
 19638     CALL 'kxdfhei1' USING DFHEIV0,
 19639           DFHEIV1,
 19640           WS-DLO-VALID-RATE-CODE,
 19641           DLO017-COMM-LENGTH,
 19642           DFHEIV99,
 19643           DFHEIV99,
 19644           DFHEIV99,
 19645           DFHEIV99
 19646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19647
 19648
 19649 7750-EXIT.
 19650     EXIT.
 19651
 19652 7755-CALL-DL19.
 19653
 19654* EXEC CICS LINK
 19655*        PROGRAM    ('DLO019')
 19656*        COMMAREA   (WS-DLO-ORIG-COV-CAT)
 19657*        LENGTH     (DLO019-COMM-LENGTH)
 19658*    END-EXEC.
 19659     MOVE 'DLO019' TO DFHEIV1
 19660*    MOVE '."C                   (   #00019144' TO DFHEIV0
 19661     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19662     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19663     MOVE X'2020233030303139313434' TO DFHEIV0(25:11)
 19664     CALL 'kxdfhei1' USING DFHEIV0,
 19665           DFHEIV1,
 19666           WS-DLO-ORIG-COV-CAT,
 19667           DLO019-COMM-LENGTH,
 19668           DFHEIV99,
 19669           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 362
* EL050.cbl
 19670           DFHEIV99,
 19671           DFHEIV99
 19672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19673
 19674
 19675 7755-EXIT.
 19676     EXIT.
 19677
 19678 7760-CALL-DL21.
 19679
 19680* EXEC CICS LINK
 19681*        PROGRAM    ('DLO021')
 19682*        COMMAREA   (WS-DLO-VALID-LOAN-OFFICER)
 19683*        LENGTH     (DLO021-COMM-LENGTH)
 19684*    END-EXEC.
 19685     MOVE 'DLO021' TO DFHEIV1
 19686*    MOVE '."C                   (   #00019154' TO DFHEIV0
 19687     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19688     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19689     MOVE X'2020233030303139313534' TO DFHEIV0(25:11)
 19690     CALL 'kxdfhei1' USING DFHEIV0,
 19691           DFHEIV1,
 19692           WS-DLO-VALID-LOAN-OFFICER,
 19693           DLO021-COMM-LENGTH,
 19694           DFHEIV99,
 19695           DFHEIV99,
 19696           DFHEIV99,
 19697           DFHEIV99
 19698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19699
 19700
 19701 7760-EXIT.
 19702     EXIT.
 19703
 19704 7770-CALL-DL22.
 19705
 19706* EXEC CICS LINK
 19707*        PROGRAM    ('DLO022')
 19708*        COMMAREA   (WS-DLO-VALID-STATE-CODE)
 19709*        LENGTH     (DLO022-COMM-LENGTH)
 19710*    END-EXEC.
 19711     MOVE 'DLO022' TO DFHEIV1
 19712*    MOVE '."C                   (   #00019164' TO DFHEIV0
 19713     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19714     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19715     MOVE X'2020233030303139313634' TO DFHEIV0(25:11)
 19716     CALL 'kxdfhei1' USING DFHEIV0,
 19717           DFHEIV1,
 19718           WS-DLO-VALID-STATE-CODE,
 19719           DLO022-COMM-LENGTH,
 19720           DFHEIV99,
 19721           DFHEIV99,
 19722           DFHEIV99,
 19723           DFHEIV99
 19724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19725
 19726
 19727 7770-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 363
* EL050.cbl
 19728     EXIT.
 19729
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 364
* EL050.cbl
 19731
 19732 7780-CALL-AGG.
 19733
 19734* EXEC CICS LINK
 19735*        PROGRAM    ('ELAGGO')
 19736*        COMMAREA   (WS-PASS-to-pemaggo)
 19737*        LENGTH     (ws-passed-key-LENGTH)
 19738*    END-EXEC.
 19739     MOVE 'ELAGGO' TO DFHEIV1
 19740*    MOVE '."C                   (   #00019176' TO DFHEIV0
 19741     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19742     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19743     MOVE X'2020233030303139313736' TO DFHEIV0(25:11)
 19744     CALL 'kxdfhei1' USING DFHEIV0,
 19745           DFHEIV1,
 19746           WS-PASS-to-pemaggo,
 19747           ws-passed-key-LENGTH,
 19748           DFHEIV99,
 19749           DFHEIV99,
 19750           DFHEIV99,
 19751           DFHEIV99
 19752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19753
 19754 7780-EXIT.
 19755     EXIT.
 19756 7800-REWRITE-CERT.
 19757******************************************************************
 19758*     IF THE ALTERNATE INDEXES CHANGE DELETE THE CERTIFICATE     *
 19759*        AND WRITE THE RECORD TO REBUILD THE ALTERNATE INDEXES.  *
 19760******************************************************************
 19761
 19762     IF CM-CONTROL-BY-NAME     = CS-CONTROL-BY-NAME      AND
 19763        CM-CONTROL-BY-SSN      = CS-CONTROL-BY-SSN       AND
 19764        CM-CONTROL-BY-CERT-NO  = CS-CONTROL-BY-CERT-NO   AND
 19765        CM-CONTROL-BY-MEMB     = CS-CONTROL-BY-MEMB
 19766
 19767* EXEC CICS REWRITE
 19768*                  DATASET (CERT-ID)
 19769*                  FROM    (CERTIFICATE-MASTER)
 19770*              END-EXEC
 19771     MOVE LENGTH OF
 19772      CERTIFICATE-MASTER
 19773       TO DFHEIV11
 19774*    MOVE '&& L                  %   #00019193' TO DFHEIV0
 19775     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19776     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19777     MOVE X'2020233030303139313933' TO DFHEIV0(25:11)
 19778     CALL 'kxdfhei1' USING DFHEIV0,
 19779           CERT-ID,
 19780           CERTIFICATE-MASTER,
 19781           DFHEIV11,
 19782           DFHEIV99
 19783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19784        GO TO 7800-EXIT.
 19785
 19786       PERFORM 7900-DELETE-CERT THRU 7900-EXIT.
 19787       PERFORM 8000-WRITE-CERT  THRU 8000-EXIT.
 19788
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 365
* EL050.cbl
 19789 7800-EXIT.
 19790      EXIT.
 19791
 19792 7900-DELETE-CERT.
 19793
 19794* EXEC CICS DELETE
 19795*        DATASET (CERT-ID)
 19796*    END-EXEC.
 19797*    MOVE '&(                    &   #00019206' TO DFHEIV0
 19798     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 19799     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19800     MOVE X'2020233030303139323036' TO DFHEIV0(25:11)
 19801     CALL 'kxdfhei1' USING DFHEIV0,
 19802           CERT-ID,
 19803           DFHEIV99,
 19804           DFHEIV99,
 19805           DFHEIV99,
 19806           DFHEIV99
 19807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19808
 19809
 19810 7900-EXIT.
 19811     EXIT.
 19812
 19813 8000-WRITE-CERT.
 19814
 19815* EXEC CICS HANDLE CONDITION
 19816*        DUPKEY    (8000-FREE-MAIN)
 19817*    END-EXEC.
 19818*    MOVE '"$$                   ! + #00019214' TO DFHEIV0
 19819     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19821     MOVE X'2B20233030303139323134' TO DFHEIV0(25:11)
 19822     CALL 'kxdfhei1' USING DFHEIV0
 19823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19824
 19825
 19826
 19827* EXEC CICS WRITE
 19828*        DATASET     (CERT-ID)
 19829*        FROM        (CERTIFICATE-MASTER)
 19830*        RIDFLD      (ELCERT-KEY)
 19831*    END-EXEC.
 19832     MOVE LENGTH OF
 19833      CERTIFICATE-MASTER
 19834       TO DFHEIV11
 19835*    MOVE '&$ L                  ''   #00019218' TO DFHEIV0
 19836     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 19837     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19838     MOVE X'2020233030303139323138' TO DFHEIV0(25:11)
 19839     CALL 'kxdfhei1' USING DFHEIV0,
 19840           CERT-ID,
 19841           CERTIFICATE-MASTER,
 19842           DFHEIV11,
 19843           ELCERT-KEY,
 19844           DFHEIV99,
 19845           DFHEIV99
 19846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 366
* EL050.cbl
 19847
 19848
 19849 8000-FREE-MAIN.
 19850
 19851 8000-EXIT.
 19852      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 367
* EL050.cbl
 19854
 19855 8100-READ-ERPNDM.
 19856
 19857* EXEC CICS HANDLE CONDITION
 19858*         NOTFND     (8100-NOTFND)
 19859*         ENDFILE    (8100-NOTFND)
 19860*    END-EXEC.
 19861*    MOVE '"$I''                  ! , #00019231' TO DFHEIV0
 19862     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19864     MOVE X'2C20233030303139323331' TO DFHEIV0(25:11)
 19865     CALL 'kxdfhei1' USING DFHEIV0
 19866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19867
 19868
 19869     MOVE SPACES                 TO ERPNDM-FOUND.
 19870     MOVE PB-CONTROL-PRIMARY     TO PM-CONTROL-PRIMARY.
 19871
 19872
 19873* EXEC CICS READ
 19874*         DATASET   (FILE-ERPNDM)
 19875*         RIDFLD    (PM-CONTROL-PRIMARY)
 19876*         INTO      (PENDING-MAILING-DATA)
 19877*    END-EXEC.
 19878     MOVE LENGTH OF
 19879      PENDING-MAILING-DATA
 19880       TO DFHEIV11
 19881*    MOVE '&"IL       E          (   #00019239' TO DFHEIV0
 19882     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19883     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19884     MOVE X'2020233030303139323339' TO DFHEIV0(25:11)
 19885     CALL 'kxdfhei1' USING DFHEIV0,
 19886           FILE-ERPNDM,
 19887           PENDING-MAILING-DATA,
 19888           DFHEIV11,
 19889           PM-CONTROL-PRIMARY,
 19890           DFHEIV99,
 19891           DFHEIV99,
 19892           DFHEIV99
 19893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19894
 19895
 19896     GO TO 8100-EXIT.
 19897
 19898 8100-NOTFND.
 19899
 19900     MOVE 'X'                    TO ERPNDM-FOUND.
 19901     MOVE ER-2694                TO WS-ERROR.
 19902     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19903     MOVE ER-2883                TO WS-ERROR
 19904     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 19905     .
 19906 8100-EXIT.
 19907     EXIT.
 19908
 19909 8110-READ-ERMAIL.
 19910
 19911* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 368
* EL050.cbl
 19912*         NOTFND     (8110-NOTFND)
 19913*         ENDFILE    (8110-NOTFND)
 19914*    END-EXEC.
 19915*    MOVE '"$I''                  ! - #00019259' TO DFHEIV0
 19916     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19917     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19918     MOVE X'2D20233030303139323539' TO DFHEIV0(25:11)
 19919     CALL 'kxdfhei1' USING DFHEIV0
 19920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19921
 19922
 19923     MOVE SPACES                 TO ERMAIL-FOUND.
 19924     MOVE PB-CONTROL-BY-ACCOUNT  TO MA-CONTROL-PRIMARY.
 19925     MOVE PB-SV-CARRIER          TO MA-CARRIER.
 19926     MOVE PB-SV-GROUPING         TO MA-GROUPING.
 19927     MOVE PB-SV-STATE            TO MA-STATE.
 19928
 19929
 19930* EXEC CICS READ
 19931*         UPDATE
 19932*         DATASET   (FILE-ERMAIL)
 19933*         RIDFLD    (MA-CONTROL-PRIMARY)
 19934*         INTO      (MAILING-DATA)
 19935*    END-EXEC.
 19936     MOVE LENGTH OF
 19937      MAILING-DATA
 19938       TO DFHEIV11
 19939*    MOVE '&"IL       EU         (   #00019270' TO DFHEIV0
 19940     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 19941     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19942     MOVE X'2020233030303139323730' TO DFHEIV0(25:11)
 19943     CALL 'kxdfhei1' USING DFHEIV0,
 19944           FILE-ERMAIL,
 19945           MAILING-DATA,
 19946           DFHEIV11,
 19947           MA-CONTROL-PRIMARY,
 19948           DFHEIV99,
 19949           DFHEIV99,
 19950           DFHEIV99
 19951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19952
 19953
 19954     GO TO 8110-EXIT.
 19955
 19956 8110-NOTFND.
 19957     MOVE 'X'                    TO ERMAIL-FOUND.
 19958
 19959 8110-EXIT.
 19960     EXIT.
 19961
 19962 8120-REWRITE-ERMAIL.
 19963
 19964* EXEC CICS REWRITE
 19965*         DATASET    (FILE-ERMAIL)
 19966*         FROM       (MAILING-DATA)
 19967*    END-EXEC.
 19968     MOVE LENGTH OF
 19969      MAILING-DATA
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 369
* EL050.cbl
 19970       TO DFHEIV11
 19971*    MOVE '&& L                  %   #00019286' TO DFHEIV0
 19972     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 19973     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19974     MOVE X'2020233030303139323836' TO DFHEIV0(25:11)
 19975     CALL 'kxdfhei1' USING DFHEIV0,
 19976           FILE-ERMAIL,
 19977           MAILING-DATA,
 19978           DFHEIV11,
 19979           DFHEIV99
 19980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19981
 19982
 19983 8120-EXIT.
 19984     EXIT.
 19985
 19986 8130-WRITE-ERMAIL.
 19987
 19988* EXEC CICS HANDLE CONDITION
 19989*         DUPKEY   (8130-EXIT)
 19990*    END-EXEC.
 19991*    MOVE '"$$                   ! . #00019295' TO DFHEIV0
 19992     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 19993     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19994     MOVE X'2E20233030303139323935' TO DFHEIV0(25:11)
 19995     CALL 'kxdfhei1' USING DFHEIV0
 19996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19997
 19998
 19999
 20000* EXEC CICS WRITE
 20001*         DATASET     (FILE-ERMAIL)
 20002*         RIDFLD      (MA-CONTROL-PRIMARY)
 20003*         FROM        (MAILING-DATA)
 20004*    END-EXEC.
 20005     MOVE LENGTH OF
 20006      MAILING-DATA
 20007       TO DFHEIV11
 20008*    MOVE '&$ L                  ''   #00019299' TO DFHEIV0
 20009     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20010     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20011     MOVE X'2020233030303139323939' TO DFHEIV0(25:11)
 20012     CALL 'kxdfhei1' USING DFHEIV0,
 20013           FILE-ERMAIL,
 20014           MAILING-DATA,
 20015           DFHEIV11,
 20016           MA-CONTROL-PRIMARY,
 20017           DFHEIV99,
 20018           DFHEIV99
 20019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20020
 20021
 20022 8130-EXIT.
 20023     EXIT.
 20024
 20025 8140-UNLOCK-ERMAIL.
 20026
 20027* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 370
* EL050.cbl
 20028*         DATASET   (FILE-ERMAIL)
 20029*    END-EXEC.
 20030*    MOVE '&*                    #   #00019309' TO DFHEIV0
 20031     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20032     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20033     MOVE X'2020233030303139333039' TO DFHEIV0(25:11)
 20034     CALL 'kxdfhei1' USING DFHEIV0,
 20035           FILE-ERMAIL,
 20036           DFHEIV99
 20037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20038
 20039
 20040 8140-EXIT.
 20041     EXIT.
 20042
 20043 8150-read-elcrtt.
 20044
 20045
 20046* EXEC CICS HANDLE CONDITION
 20047*        NOTFND   (8150-exit)
 20048*    END-EXEC
 20049*    MOVE '"$I                   ! / #00019318' TO DFHEIV0
 20050     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20051     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20052     MOVE X'2F20233030303139333138' TO DFHEIV0(25:11)
 20053     CALL 'kxdfhei1' USING DFHEIV0
 20054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20055
 20056     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20057     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20058
 20059
 20060* EXEC CICS READ
 20061*        DATASET  (CRTT-ID)
 20062*        RIDFLD   (WS-ELCRTT-KEY)
 20063*        INTO     (CERTIFICATE-TRAILERS)
 20064*    END-EXEC
 20065     MOVE LENGTH OF
 20066      CERTIFICATE-TRAILERS
 20067       TO DFHEIV11
 20068*    MOVE '&"IL       E          (   #00019325' TO DFHEIV0
 20069     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20070     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20071     MOVE X'2020233030303139333235' TO DFHEIV0(25:11)
 20072     CALL 'kxdfhei1' USING DFHEIV0,
 20073           CRTT-ID,
 20074           CERTIFICATE-TRAILERS,
 20075           DFHEIV11,
 20076           WS-ELCRTT-KEY,
 20077           DFHEIV99,
 20078           DFHEIV99,
 20079           DFHEIV99
 20080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20081
 20082     move cs-ins-age-default-flag to ws-ins-age-defaulted
 20083     move cs-jnt-age-default-flag to ws-jnt-age-defaulted
 20084
 20085     .
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 371
* EL050.cbl
 20086 8150-exit.
 20087     exit.
 20088 8180-UPDATE-VIN-NUMBER.
 20089
 20090* EXEC CICS HANDLE CONDITION
 20091*        NOTFND   (8180-NOTFND)
 20092*    END-EXEC.
 20093*    MOVE '"$I                   ! 0 #00019338' TO DFHEIV0
 20094     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20096     MOVE X'3020233030303139333338' TO DFHEIV0(25:11)
 20097     CALL 'kxdfhei1' USING DFHEIV0
 20098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20099
 20100
 20101     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20102     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20103
 20104
 20105* EXEC CICS READ
 20106*        UPDATE
 20107*        DATASET  (CRTT-ID)
 20108*        RIDFLD   (WS-ELCRTT-KEY)
 20109*        INTO     (CERTIFICATE-TRAILERS)
 20110*    END-EXEC.
 20111     MOVE LENGTH OF
 20112      CERTIFICATE-TRAILERS
 20113       TO DFHEIV11
 20114*    MOVE '&"IL       EU         (   #00019345' TO DFHEIV0
 20115     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20116     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20117     MOVE X'2020233030303139333435' TO DFHEIV0(25:11)
 20118     CALL 'kxdfhei1' USING DFHEIV0,
 20119           CRTT-ID,
 20120           CERTIFICATE-TRAILERS,
 20121           DFHEIV11,
 20122           WS-ELCRTT-KEY,
 20123           DFHEIV99,
 20124           DFHEIV99,
 20125           DFHEIV99
 20126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20127
 20128
 20129     IF PB-I-VIN NOT EQUAL CS-VIN-NUMBER
 20130         MOVE PB-I-VIN TO CS-VIN-NUMBER
 20131
 20132* EXEC CICS REWRITE
 20133*           DATASET  (CRTT-ID)
 20134*           FROM     (CERTIFICATE-TRAILERS)
 20135*        END-EXEC
 20136     MOVE LENGTH OF
 20137      CERTIFICATE-TRAILERS
 20138       TO DFHEIV11
 20139*    MOVE '&& L                  %   #00019354' TO DFHEIV0
 20140     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20141     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20142     MOVE X'2020233030303139333534' TO DFHEIV0(25:11)
 20143     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 372
* EL050.cbl
 20144           CRTT-ID,
 20145           CERTIFICATE-TRAILERS,
 20146           DFHEIV11,
 20147           DFHEIV99
 20148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20149     ELSE
 20150
 20151* EXEC CICS UNLOCK
 20152*          DATASET  (CRTT-ID)
 20153*       END-EXEC
 20154*    MOVE '&*                    #   #00019359' TO DFHEIV0
 20155     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 20156     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20157     MOVE X'2020233030303139333539' TO DFHEIV0(25:11)
 20158     CALL 'kxdfhei1' USING DFHEIV0,
 20159           CRTT-ID,
 20160           DFHEIV99
 20161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20162     END-IF.
 20163
 20164     GO TO 8180-EXIT.
 20165
 20166 8180-NOTFND.
 20167
 20168     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20169     MOVE 'CS'         TO CS-RECORD-ID.
 20170     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20171     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20172     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20173     MOVE PB-I-VIN     TO CS-VIN-NUMBER.
 20174
 20175* EXEC CICS WRITE
 20176*       DATASET  (CRTT-ID)
 20177*       RIDFLD   (WS-ELCRTT-KEY)
 20178*       FROM     (CERTIFICATE-TRAILERS)
 20179*    END-EXEC.
 20180     MOVE LENGTH OF
 20181      CERTIFICATE-TRAILERS
 20182       TO DFHEIV11
 20183*    MOVE '&$ L                  ''   #00019374' TO DFHEIV0
 20184     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20185     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20186     MOVE X'2020233030303139333734' TO DFHEIV0(25:11)
 20187     CALL 'kxdfhei1' USING DFHEIV0,
 20188           CRTT-ID,
 20189           CERTIFICATE-TRAILERS,
 20190           DFHEIV11,
 20191           WS-ELCRTT-KEY,
 20192           DFHEIV99,
 20193           DFHEIV99
 20194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20195
 20196
 20197 8180-EXIT.
 20198     EXIT.
 20199
 20200 8190-UPDATE-REFUND-CLAIM-FLAG.
 20201
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 373
* EL050.cbl
 20202* EXEC CICS HANDLE CONDITION
 20203*        NOTFND   (8190-NOTFND)
 20204*    END-EXEC.
 20205*    MOVE '"$I                   ! 1 #00019384' TO DFHEIV0
 20206     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20207     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20208     MOVE X'3120233030303139333834' TO DFHEIV0(25:11)
 20209     CALL 'kxdfhei1' USING DFHEIV0
 20210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20211
 20212
 20213     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20214     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20215
 20216
 20217* EXEC CICS READ
 20218*        UPDATE
 20219*        DATASET  (CRTT-ID)
 20220*        RIDFLD   (WS-ELCRTT-KEY)
 20221*        INTO     (CERTIFICATE-TRAILERS)
 20222*    END-EXEC.
 20223     MOVE LENGTH OF
 20224      CERTIFICATE-TRAILERS
 20225       TO DFHEIV11
 20226*    MOVE '&"IL       EU         (   #00019391' TO DFHEIV0
 20227     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20228     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20229     MOVE X'2020233030303139333931' TO DFHEIV0(25:11)
 20230     CALL 'kxdfhei1' USING DFHEIV0,
 20231           CRTT-ID,
 20232           CERTIFICATE-TRAILERS,
 20233           DFHEIV11,
 20234           WS-ELCRTT-KEY,
 20235           DFHEIV99,
 20236           DFHEIV99,
 20237           DFHEIV99
 20238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20239
 20240
 20241     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20242
 20243* EXEC CICS REWRITE
 20244*       DATASET  (CRTT-ID)
 20245*       FROM     (CERTIFICATE-TRAILERS)
 20246*    END-EXEC.
 20247     MOVE LENGTH OF
 20248      CERTIFICATE-TRAILERS
 20249       TO DFHEIV11
 20250*    MOVE '&& L                  %   #00019399' TO DFHEIV0
 20251     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20252     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20253     MOVE X'2020233030303139333939' TO DFHEIV0(25:11)
 20254     CALL 'kxdfhei1' USING DFHEIV0,
 20255           CRTT-ID,
 20256           CERTIFICATE-TRAILERS,
 20257           DFHEIV11,
 20258           DFHEIV99
 20259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 374
* EL050.cbl
 20260
 20261
 20262     GO TO 8190-EXIT.
 20263
 20264 8190-NOTFND.
 20265
 20266     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20267     MOVE 'CS'         TO CS-RECORD-ID.
 20268     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20269     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20270     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20271     MOVE WS-ST-REFUND-CLAIM-FLAG TO CS-REFUND-CLAIM-FLAG.
 20272
 20273* EXEC CICS WRITE
 20274*       DATASET  (CRTT-ID)
 20275*       RIDFLD   (WS-ELCRTT-KEY)
 20276*       FROM     (CERTIFICATE-TRAILERS)
 20277*    END-EXEC.
 20278     MOVE LENGTH OF
 20279      CERTIFICATE-TRAILERS
 20280       TO DFHEIV11
 20281*    MOVE '&$ L                  ''   #00019414' TO DFHEIV0
 20282     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20283     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20284     MOVE X'2020233030303139343134' TO DFHEIV0(25:11)
 20285     CALL 'kxdfhei1' USING DFHEIV0,
 20286           CRTT-ID,
 20287           CERTIFICATE-TRAILERS,
 20288           DFHEIV11,
 20289           WS-ELCRTT-KEY,
 20290           DFHEIV99,
 20291           DFHEIV99
 20292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20293
 20294
 20295 8190-EXIT.
 20296     EXIT.
 20297
 20298 8195-UPDATE-AGE-FLAGS.
 20299
 20300* EXEC CICS HANDLE CONDITION
 20301*        NOTFND   (8195-NOTFND)
 20302*    END-EXEC.
 20303*    MOVE '"$I                   ! 2 #00019424' TO DFHEIV0
 20304     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20306     MOVE X'3220233030303139343234' TO DFHEIV0(25:11)
 20307     CALL 'kxdfhei1' USING DFHEIV0
 20308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20309
 20310
 20311     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
 20312     MOVE 'C'                TO WS-ELCRTT-REC-TYPE
 20313
 20314
 20315* EXEC CICS READ
 20316*        UPDATE
 20317*        DATASET  (CRTT-ID)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 375
* EL050.cbl
 20318*        RIDFLD   (WS-ELCRTT-KEY)
 20319*        INTO     (CERTIFICATE-TRAILERS)
 20320*    END-EXEC.
 20321     MOVE LENGTH OF
 20322      CERTIFICATE-TRAILERS
 20323       TO DFHEIV11
 20324*    MOVE '&"IL       EU         (   #00019431' TO DFHEIV0
 20325     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20326     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 20327     MOVE X'2020233030303139343331' TO DFHEIV0(25:11)
 20328     CALL 'kxdfhei1' USING DFHEIV0,
 20329           CRTT-ID,
 20330           CERTIFICATE-TRAILERS,
 20331           DFHEIV11,
 20332           WS-ELCRTT-KEY,
 20333           DFHEIV99,
 20334           DFHEIV99,
 20335           DFHEIV99
 20336     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20337
 20338
 20339     IF WS-INS-AGE-SET = 'Y'
 20340        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 20341     END-IF
 20342     IF WS-JNT-AGE-SET = 'Y'
 20343        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 20344     END-IF
 20345
 20346
 20347* EXEC CICS REWRITE
 20348*       DATASET  (CRTT-ID)
 20349*       FROM     (CERTIFICATE-TRAILERS)
 20350*    END-EXEC.
 20351     MOVE LENGTH OF
 20352      CERTIFICATE-TRAILERS
 20353       TO DFHEIV11
 20354*    MOVE '&& L                  %   #00019445' TO DFHEIV0
 20355     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 20356     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 20357     MOVE X'2020233030303139343435' TO DFHEIV0(25:11)
 20358     CALL 'kxdfhei1' USING DFHEIV0,
 20359           CRTT-ID,
 20360           CERTIFICATE-TRAILERS,
 20361           DFHEIV11,
 20362           DFHEIV99
 20363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20364
 20365
 20366     GO TO 8195-EXIT.
 20367
 20368 8195-NOTFND.
 20369
 20370     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 20371     MOVE 'CS'         TO CS-RECORD-ID.
 20372     MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY.
 20373     MOVE 'C'          TO WS-ELCRTT-REC-TYPE.
 20374     MOVE WS-ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 20375     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 376
* EL050.cbl
 20376     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 20377
 20378* EXEC CICS WRITE
 20379*       DATASET  (CRTT-ID)
 20380*       RIDFLD   (WS-ELCRTT-KEY)
 20381*       FROM     (CERTIFICATE-TRAILERS)
 20382*    END-EXEC.
 20383     MOVE LENGTH OF
 20384      CERTIFICATE-TRAILERS
 20385       TO DFHEIV11
 20386*    MOVE '&$ L                  ''   #00019461' TO DFHEIV0
 20387     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20388     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20389     MOVE X'2020233030303139343631' TO DFHEIV0(25:11)
 20390     CALL 'kxdfhei1' USING DFHEIV0,
 20391           CRTT-ID,
 20392           CERTIFICATE-TRAILERS,
 20393           DFHEIV11,
 20394           WS-ELCRTT-KEY,
 20395           DFHEIV99,
 20396           DFHEIV99
 20397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20398
 20399
 20400 8195-EXIT.
 20401     EXIT.
 20402
 20403 8200-READ-REIN-TABLE.
 20404
 20405* EXEC CICS HANDLE CONDITION
 20406*         NOTFND   (8200-NOTFND)
 20407*    END-EXEC.
 20408*    MOVE '"$I                   ! 3 #00019471' TO DFHEIV0
 20409     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20410     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20411     MOVE X'3320233030303139343731' TO DFHEIV0(25:11)
 20412     CALL 'kxdfhei1' USING DFHEIV0
 20413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20414
 20415
 20416
 20417* EXEC CICS READ
 20418*        DATASET     (REIN-ID)
 20419*        SET         (ADDRESS OF REINSURANCE-RECORD)
 20420*        RIDFLD      (ERREIN-KEY)
 20421*    END-EXEC.
 20422*    MOVE '&"S        E          (   #00019475' TO DFHEIV0
 20423     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20424     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20425     MOVE X'2020233030303139343735' TO DFHEIV0(25:11)
 20426     CALL 'kxdfhei1' USING DFHEIV0,
 20427           REIN-ID,
 20428           DFHEIV20,
 20429           DFHEIV99,
 20430           ERREIN-KEY,
 20431           DFHEIV99,
 20432           DFHEIV99,
 20433           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 377
* EL050.cbl
 20434     SET ADDRESS OF REINSURANCE-RECORD TO
 20435         DFHEIV20
 20436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20437
 20438
 20439     GO TO 8200-EXIT.
 20440
 20441 8200-NOTFND.
 20442     MOVE 'N'             TO WS-REIN-READ-SW.
 20443
 20444 8200-EXIT.
 20445      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 378
* EL050.cbl
 20447
 20448 8300-READ-CTBL-TABLE.
 20449
 20450* EXEC CICS HANDLE CONDITION
 20451*        NOTFND    (8300-NOTFND)
 20452*        DISABLED  (8300-ERRESS-PROBLEM)
 20453*        NOTOPEN   (8300-ERRESS-PROBLEM)
 20454*        ENDFILE   (8300-NOTFND)
 20455*    END-EXEC.
 20456*    MOVE '"$IcJ''                ! 4 #00019491' TO DFHEIV0
 20457     MOVE X'222449634A27202020202020' TO DFHEIV0(1:12)
 20458     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20459     MOVE X'3420233030303139343931' TO DFHEIV0(25:11)
 20460     CALL 'kxdfhei1' USING DFHEIV0
 20461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20462
 20463
 20464
 20465* EXEC CICS READ
 20466*        DATASET     (CTBL-ID)
 20467*        SET         (ADDRESS OF COMM-TABLE-RECORD)
 20468*        RIDFLD      (ERCTBL-KEY)
 20469*    END-EXEC.
 20470*    MOVE '&"S        E          (   #00019498' TO DFHEIV0
 20471     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20472     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20473     MOVE X'2020233030303139343938' TO DFHEIV0(25:11)
 20474     CALL 'kxdfhei1' USING DFHEIV0,
 20475           CTBL-ID,
 20476           DFHEIV20,
 20477           DFHEIV99,
 20478           ERCTBL-KEY,
 20479           DFHEIV99,
 20480           DFHEIV99,
 20481           DFHEIV99
 20482     SET ADDRESS OF COMM-TABLE-RECORD TO
 20483         DFHEIV20
 20484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20485
 20486
 20487     MOVE 'Y'                          TO WS-CTBL-READ-SW.
 20488
 20489     GO TO 8300-EXIT.
 20490
 20491 8300-NOTFND.
 20492
 20493     IF CTBL-SW = '0530'
 20494         MOVE 'AA'                     TO WS-AH-COMP-CD
 20495         MOVE '0550'                   TO CTBL-SW
 20496         MOVE '1'                      TO WS-CTBL-READ-SW
 20497         GO TO 8300-EXIT.
 20498
 20499     IF CTBL-SW = '0540'
 20500         MOVE 'AA'                     TO WS-LF-COMP-CD
 20501         MOVE '0550'                   TO CTBL-SW
 20502         MOVE '1'                      TO WS-CTBL-READ-SW
 20503         GO TO 8300-EXIT.
 20504
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 379
* EL050.cbl
 20505     IF CTBL-SW = '0550'
 20506         MOVE '2'                      TO WS-CTBL-READ-SW
 20507         GO TO 8300-EXIT.
 20508
 20509     GO TO 8300-EXIT.
 20510
 20511 8300-ERRESS-PROBLEM.
 20512
 20513      MOVE ER-8050              TO WS-ERROR.
 20514      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20515
 20516     GO TO 8300-EXIT.
 20517
 20518 8300-EXIT.
 20519      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 380
* EL050.cbl
 20521
 20522
 20523 8400-GETMAIN-ERFORM.
 20524
 20525
 20526* EXEC CICS   GETMAIN
 20527*        LENGTH  (500)
 20528*        SET     (ADDRESS OF FORM-MASTER)
 20529*    END-EXEC.
 20530     MOVE 500
 20531       TO DFHEIV11
 20532*    MOVE '," L                  $   #00019542' TO DFHEIV0
 20533     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20534     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20535     MOVE X'2020233030303139353432' TO DFHEIV0(25:11)
 20536     CALL 'kxdfhei1' USING DFHEIV0,
 20537           DFHEIV20,
 20538           DFHEIV11,
 20539           DFHEIV99
 20540     SET ADDRESS OF FORM-MASTER TO
 20541         DFHEIV20
 20542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20543
 20544
 20545     SET ERFORM-POINTER TO ADDRESS OF FORM-MASTER.
 20546
 20547 8400-EXIT.
 20548      EXIT.
 20549
 20550 8450-READ-FORM-MASTER.
 20551
 20552
 20553* EXEC CICS  HANDLE CONDITION
 20554*        NOTFND   (8450-FORM-NOT-FOUND)
 20555*        ENDFILE  (8450-FORM-NOT-FOUND)
 20556*    END-EXEC.
 20557*    MOVE '"$I''                  ! 5 #00019554' TO DFHEIV0
 20558     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20559     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20560     MOVE X'3520233030303139353534' TO DFHEIV0(25:11)
 20561     CALL 'kxdfhei1' USING DFHEIV0
 20562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20563
 20564
 20565
 20566* EXEC CICS   READ
 20567*        DATASET   (FORM-ID)
 20568*        RIDFLD    (ERFORM-KEY)
 20569*        INTO      (FORM-MASTER)
 20570*        GTEQ
 20571*    END-EXEC.
 20572     MOVE LENGTH OF
 20573      FORM-MASTER
 20574       TO DFHEIV11
 20575*    MOVE '&"IL       G          (   #00019559' TO DFHEIV0
 20576     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20577     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20578     MOVE X'2020233030303139353539' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 381
* EL050.cbl
 20579     CALL 'kxdfhei1' USING DFHEIV0,
 20580           FORM-ID,
 20581           FORM-MASTER,
 20582           DFHEIV11,
 20583           ERFORM-KEY,
 20584           DFHEIV99,
 20585           DFHEIV99,
 20586           DFHEIV99
 20587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20588
 20589
 20590     MOVE  'Y'           TO  FORM-MASTER-SW.
 20591
 20592     GO TO  8450-EXIT.
 20593
 20594 8450-FORM-NOT-FOUND.
 20595
 20596     MOVE  'N'           TO  FORM-MASTER-SW.
 20597
 20598 8450-EXIT.
 20599      EXIT.
 20600
 20601 8500-DATE-CONVERT.
 20602
 20603* EXEC CICS LINK
 20604*        PROGRAM    ('ELDATCV')
 20605*        COMMAREA   (DATE-CONVERSION-DATA)
 20606*        LENGTH     (DC-COMM-LENGTH)
 20607*    END-EXEC.
 20608     MOVE 'ELDATCV' TO DFHEIV1
 20609*    MOVE '."C                   (   #00019578' TO DFHEIV0
 20610     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20611     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20612     MOVE X'2020233030303139353738' TO DFHEIV0(25:11)
 20613     CALL 'kxdfhei1' USING DFHEIV0,
 20614           DFHEIV1,
 20615           DATE-CONVERSION-DATA,
 20616           DC-COMM-LENGTH,
 20617           DFHEIV99,
 20618           DFHEIV99,
 20619           DFHEIV99,
 20620           DFHEIV99
 20621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20622
 20623
 20624 8500-EXIT.
 20625     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 382
* EL050.cbl
 20627
 20628 8555-RELOAD-CONTROL-FILE.
 20629     CONTINUE.
 20630
 20631 8555-EXIT.
 20632     EXIT.
 20633
 20634 8557-GETMAIN-ERPLAN.
 20635
 20636
 20637* EXEC CICS GETMAIN
 20638*        LENGTH    (840)
 20639*        SET       (ADDRESS OF PLAN-RECORDS)
 20640*    END-EXEC.
 20641     MOVE 840
 20642       TO DFHEIV11
 20643*    MOVE '," L                  $   #00019596' TO DFHEIV0
 20644     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20645     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20646     MOVE X'2020233030303139353936' TO DFHEIV0(25:11)
 20647     CALL 'kxdfhei1' USING DFHEIV0,
 20648           DFHEIV20,
 20649           DFHEIV11,
 20650           DFHEIV99
 20651     SET ADDRESS OF PLAN-RECORDS TO
 20652         DFHEIV20
 20653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20654
 20655
 20656     SET ERPLAN-POINTER  TO ADDRESS OF PLAN-RECORDS.
 20657
 20658 8557-EXIT.
 20659     EXIT.
 20660
 20661 8560-GETMAIN.
 20662
 20663* EXEC CICS GETMAIN
 20664*        LENGTH    (2000)
 20665*        SET       (ADDRESS OF ACCOUNT-MASTER)
 20666*    END-EXEC.
 20667     MOVE 2000
 20668       TO DFHEIV11
 20669*    MOVE '," L                  $   #00019607' TO DFHEIV0
 20670     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 20671     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20672     MOVE X'2020233030303139363037' TO DFHEIV0(25:11)
 20673     CALL 'kxdfhei1' USING DFHEIV0,
 20674           DFHEIV20,
 20675           DFHEIV11,
 20676           DFHEIV99
 20677     SET ADDRESS OF ACCOUNT-MASTER TO
 20678         DFHEIV20
 20679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20680
 20681
 20682     SET ERACCT-POINTER TO ADDRESS OF ACCOUNT-MASTER.
 20683
 20684 8560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 383
* EL050.cbl
 20685     EXIT.
 20686
 20687 8570-START-ACCOUNT-MASTER.
 20688
 20689* EXEC CICS HANDLE CONDITION
 20690*        NOTFND    (0199-ACCT-NOT-FOUND)
 20691*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20692*    END-EXEC.
 20693*    MOVE '"$I''                  ! 6 #00019618' TO DFHEIV0
 20694     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20695     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20696     MOVE X'3620233030303139363138' TO DFHEIV0(25:11)
 20697     CALL 'kxdfhei1' USING DFHEIV0
 20698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20699
 20700
 20701
 20702* EXEC CICS STARTBR
 20703*        DATASET    (ACCT-ID)
 20704*        RIDFLD     (ERACCT-KEY)
 20705*        GTEQ
 20706*    END-EXEC.
 20707     MOVE 0
 20708       TO DFHEIV11
 20709*    MOVE '&,         G          &   #00019623' TO DFHEIV0
 20710     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20711     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20712     MOVE X'2020233030303139363233' TO DFHEIV0(25:11)
 20713     CALL 'kxdfhei1' USING DFHEIV0,
 20714           ACCT-ID,
 20715           ERACCT-KEY,
 20716           DFHEIV99,
 20717           DFHEIV11,
 20718           DFHEIV99
 20719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20720
 20721
 20722 8570-EXIT.
 20723     EXIT.
 20724
 20725 8580-READ-ACCOUNT-MASTER.
 20726
 20727* EXEC CICS HANDLE CONDITION
 20728*        NOTFND    (0199-ACCT-NOT-FOUND)
 20729*        ENDFILE   (0199-ACCT-NOT-FOUND)
 20730*    END-EXEC.
 20731*    MOVE '"$I''                  ! 7 #00019633' TO DFHEIV0
 20732     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20734     MOVE X'3720233030303139363333' TO DFHEIV0(25:11)
 20735     CALL 'kxdfhei1' USING DFHEIV0
 20736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20737
 20738
 20739
 20740* EXEC CICS READNEXT
 20741*        DATASET     (ACCT-ID)
 20742*        INTO        (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 384
* EL050.cbl
 20743*        RIDFLD      (ERACCT-KEY)
 20744*    END-EXEC.
 20745     MOVE LENGTH OF
 20746      ACCOUNT-MASTER
 20747       TO DFHEIV12
 20748     MOVE 0
 20749       TO DFHEIV11
 20750*    MOVE '&.IL                  )   #00019638' TO DFHEIV0
 20751     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20752     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20753     MOVE X'2020233030303139363338' TO DFHEIV0(25:11)
 20754     CALL 'kxdfhei1' USING DFHEIV0,
 20755           ACCT-ID,
 20756           ACCOUNT-MASTER,
 20757           DFHEIV12,
 20758           ERACCT-KEY,
 20759           DFHEIV99,
 20760           DFHEIV11,
 20761           DFHEIV99,
 20762           DFHEIV99
 20763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20764
 20765
 20766 8580-EXIT.
 20767     EXIT.
 20768
 20769 8582-READ-COMPENSATION-MASTER.
 20770
 20771* EXEC CICS HANDLE CONDITION
 20772*        NOTFND    (8582-COMP-NOT-FOUND)
 20773*        ENDFILE   (8582-COMP-NOT-FOUND)
 20774*    END-EXEC.
 20775*    MOVE '"$I''                  ! 8 #00019648' TO DFHEIV0
 20776     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20777     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20778     MOVE X'3820233030303139363438' TO DFHEIV0(25:11)
 20779     CALL 'kxdfhei1' USING DFHEIV0
 20780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20781
 20782
 20783
 20784* EXEC CICS READ
 20785*        DATASET     (COMP-ID)
 20786*        INTO        (COMPENSATION-MASTER)
 20787*        RIDFLD      (ERCOMP-KEY)
 20788*    END-EXEC.
 20789     MOVE LENGTH OF
 20790      COMPENSATION-MASTER
 20791       TO DFHEIV11
 20792*    MOVE '&"IL       E          (   #00019653' TO DFHEIV0
 20793     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20794     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20795     MOVE X'2020233030303139363533' TO DFHEIV0(25:11)
 20796     CALL 'kxdfhei1' USING DFHEIV0,
 20797           COMP-ID,
 20798           COMPENSATION-MASTER,
 20799           DFHEIV11,
 20800           ERCOMP-KEY,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 385
* EL050.cbl
 20801           DFHEIV99,
 20802           DFHEIV99,
 20803           DFHEIV99
 20804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20805
 20806
 20807     MOVE 'Y'                    TO COMP-MASTER-SW
 20808
 20809     GO TO 8582-EXIT
 20810     .
 20811 8582-COMP-NOT-FOUND.
 20812
 20813     MOVE 'N'                    TO COMP-MASTER-SW.
 20814
 20815 8582-EXIT.
 20816     EXIT.
 20817
 20818 8583-READ-ERAGTC.
 20819
 20820* EXEC CICS HANDLE CONDITION
 20821*        NOTFND    (8583-AGTC-NOT-FOUND)
 20822*        ENDFILE   (8583-AGTC-NOT-FOUND)
 20823*    END-EXEC.
 20824*    MOVE '"$I''                  ! 9 #00019671' TO DFHEIV0
 20825     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20827     MOVE X'3920233030303139363731' TO DFHEIV0(25:11)
 20828     CALL 'kxdfhei1' USING DFHEIV0
 20829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20830
 20831
 20832
 20833* EXEC CICS STARTBR
 20834*        DATASET    (AGTC-ID)
 20835*        RIDFLD     (ERAGTC-KEY)
 20836*        GTEQ
 20837*    END-EXEC.
 20838     MOVE 0
 20839       TO DFHEIV11
 20840*    MOVE '&,         G          &   #00019676' TO DFHEIV0
 20841     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20842     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20843     MOVE X'2020233030303139363736' TO DFHEIV0(25:11)
 20844     CALL 'kxdfhei1' USING DFHEIV0,
 20845           AGTC-ID,
 20846           ERAGTC-KEY,
 20847           DFHEIV99,
 20848           DFHEIV11,
 20849           DFHEIV99
 20850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20851
 20852
 20853 8583-READ-ERAGTC-NEXT.
 20854
 20855* EXEC CICS READNEXT
 20856*        DATASET     (AGTC-ID)
 20857*        INTO        (AGENT-COMMISSIONS)
 20858*        RIDFLD      (ERAGTC-KEY)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 386
* EL050.cbl
 20859*    END-EXEC.
 20860     MOVE LENGTH OF
 20861      AGENT-COMMISSIONS
 20862       TO DFHEIV12
 20863     MOVE 0
 20864       TO DFHEIV11
 20865*    MOVE '&.IL                  )   #00019683' TO DFHEIV0
 20866     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 20867     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20868     MOVE X'2020233030303139363833' TO DFHEIV0(25:11)
 20869     CALL 'kxdfhei1' USING DFHEIV0,
 20870           AGTC-ID,
 20871           AGENT-COMMISSIONS,
 20872           DFHEIV12,
 20873           ERAGTC-KEY,
 20874           DFHEIV99,
 20875           DFHEIV11,
 20876           DFHEIV99,
 20877           DFHEIV99
 20878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20879
 20880
 20881*    MOVE 'Y'                    TO AGTC-MASTER-SW
 20882
 20883     GO TO 8583-EXIT
 20884     .
 20885 8583-AGTC-NOT-FOUND.
 20886
 20887     MOVE 'N'                    TO AGTC-MASTER-SW.
 20888
 20889 8583-EXIT.
 20890     EXIT.
 20891
 20892 8584-READ-BANK-CROSS-REF.
 20893
 20894* EXEC CICS HANDLE CONDITION
 20895*        NOTFND    (8584-BXRF-NOT-FOUND)
 20896*        ENDFILE   (8584-BXRF-NOT-FOUND)
 20897*    END-EXEC.
 20898*    MOVE '"$I''                  ! : #00019701' TO DFHEIV0
 20899     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20900     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20901     MOVE X'3A20233030303139373031' TO DFHEIV0(25:11)
 20902     CALL 'kxdfhei1' USING DFHEIV0
 20903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20904
 20905
 20906
 20907* EXEC CICS READ
 20908*        DATASET     (BXRF-ID)
 20909*        INTO        (BANK-CROSS-REFERENCE)
 20910*        RIDFLD      (ERBXRF-KEY)
 20911*        LENGTH      (BXRF-REC-LENGTH)
 20912*    END-EXEC.
 20913*    MOVE '&"IL       E          (   #00019706' TO DFHEIV0
 20914     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20915     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20916     MOVE X'2020233030303139373036' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 387
* EL050.cbl
 20917     CALL 'kxdfhei1' USING DFHEIV0,
 20918           BXRF-ID,
 20919           BANK-CROSS-REFERENCE,
 20920           BXRF-REC-LENGTH,
 20921           ERBXRF-KEY,
 20922           DFHEIV99,
 20923           DFHEIV99,
 20924           DFHEIV99
 20925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20926
 20927
 20928     MOVE 'Y'                    TO BXRF-MASTER-SW
 20929
 20930     GO TO 8584-EXIT
 20931     .
 20932 8584-BXRF-NOT-FOUND.
 20933
 20934     MOVE 'N'                    TO BXRF-MASTER-SW.
 20935
 20936 8584-EXIT.
 20937     EXIT.
 20938
 20939 8585-READ-PLAN-MASTER.
 20940
 20941
 20942* EXEC CICS HANDLE CONDITION
 20943*        NOTFND    (8585-PLAN-NOT-FOUND)
 20944*        ENDFILE   (8585-PLAN-NOT-FOUND)
 20945*    END-EXEC.
 20946*    MOVE '"$I''                  ! ; #00019726' TO DFHEIV0
 20947     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20948     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20949     MOVE X'3B20233030303139373236' TO DFHEIV0(25:11)
 20950     CALL 'kxdfhei1' USING DFHEIV0
 20951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20952
 20953
 20954
 20955* EXEC CICS READ
 20956*        DATASET     (PLAN-ID)
 20957*        INTO        (PLAN-MASTER)
 20958*        RIDFLD      (ERPLAN-KEY)
 20959*    END-EXEC.
 20960     MOVE LENGTH OF
 20961      PLAN-MASTER
 20962       TO DFHEIV11
 20963*    MOVE '&"IL       E          (   #00019731' TO DFHEIV0
 20964     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20965     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20966     MOVE X'2020233030303139373331' TO DFHEIV0(25:11)
 20967     CALL 'kxdfhei1' USING DFHEIV0,
 20968           PLAN-ID,
 20969           PLAN-MASTER,
 20970           DFHEIV11,
 20971           ERPLAN-KEY,
 20972           DFHEIV99,
 20973           DFHEIV99,
 20974           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 388
* EL050.cbl
 20975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20976
 20977
 20978     MOVE 'Y'                    TO PLAN-MASTER-SW.
 20979
 20980     GO TO 8585-EXIT.
 20981
 20982 8585-PLAN-NOT-FOUND.
 20983
 20984     MOVE 'N'                    TO PLAN-MASTER-SW.
 20985
 20986 8585-EXIT.
 20987     EXIT.
 20988
 20989 8586-READ-LOAN-OFFICER.
 20990
 20991* EXEC CICS READ
 20992*        DATASET     (LOFC-ID)
 20993*        INTO        (LOAN-OFFICER-MASTER)
 20994*        RIDFLD      (ERLOFC-KEY)
 20995*        RESP        (WS-RESPONSE)
 20996*    END-EXEC
 20997     MOVE LENGTH OF
 20998      LOAN-OFFICER-MASTER
 20999       TO DFHEIV11
 21000*    MOVE '&"IL       E          (  N#00019749' TO DFHEIV0
 21001     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21002     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21003     MOVE X'204E233030303139373439' TO DFHEIV0(25:11)
 21004     CALL 'kxdfhei1' USING DFHEIV0,
 21005           LOFC-ID,
 21006           LOAN-OFFICER-MASTER,
 21007           DFHEIV11,
 21008           ERLOFC-KEY,
 21009           DFHEIV99,
 21010           DFHEIV99,
 21011           DFHEIV99
 21012     MOVE EIBRESP  TO WS-RESPONSE
 21013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21014
 21015     IF WS-RESP-NORMAL
 21016        MOVE 'Y'                 TO LOFC-MASTER-SW
 21017     ELSE
 21018        MOVE 'N'                 TO LOFC-MASTER-SW
 21019     END-IF
 21020     .
 21021 8586-EXIT.
 21022     EXIT.
 21023 8587-START-ERPDEF.
 21024
 21025* EXEC CICS STARTBR
 21026*       DATASET   (PDEF-ID)
 21027*       RIDFLD    (ERPDEF-KEY)
 21028*       GTEQ
 21029*       RESP      (WS-RESPONSE)
 21030*    END-EXEC
 21031     MOVE 0
 21032       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 389
* EL050.cbl
 21033*    MOVE '&,         G          &  N#00019765' TO DFHEIV0
 21034     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21035     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21036     MOVE X'204E233030303139373635' TO DFHEIV0(25:11)
 21037     CALL 'kxdfhei1' USING DFHEIV0,
 21038           PDEF-ID,
 21039           ERPDEF-KEY,
 21040           DFHEIV99,
 21041           DFHEIV11,
 21042           DFHEIV99
 21043     MOVE EIBRESP  TO WS-RESPONSE
 21044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21045     IF WS-RESP-NORMAL
 21046        MOVE 'Y'                 TO PDEF-MASTER-SW
 21047     ELSE
 21048        MOVE 'N'                 TO PDEF-MASTER-SW
 21049     END-IF
 21050     .
 21051 8587-EXIT.
 21052     EXIT.
 21053 8588-READ-ERPDEF.
 21054
 21055* EXEC CICS READNEXT
 21056*       DATASET   (PDEF-ID)
 21057*       RIDFLD    (ERPDEF-KEY)
 21058*       INTO      (PRODUCT-MASTER)
 21059*       RESP      (WS-RESPONSE)
 21060*    END-EXEC
 21061     MOVE LENGTH OF
 21062      PRODUCT-MASTER
 21063       TO DFHEIV12
 21064     MOVE 0
 21065       TO DFHEIV11
 21066*    MOVE '&.IL                  )  N#00019780' TO DFHEIV0
 21067     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21068     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21069     MOVE X'204E233030303139373830' TO DFHEIV0(25:11)
 21070     CALL 'kxdfhei1' USING DFHEIV0,
 21071           PDEF-ID,
 21072           PRODUCT-MASTER,
 21073           DFHEIV12,
 21074           ERPDEF-KEY,
 21075           DFHEIV99,
 21076           DFHEIV11,
 21077           DFHEIV99,
 21078           DFHEIV99
 21079     MOVE EIBRESP  TO WS-RESPONSE
 21080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21081     IF WS-RESP-NORMAL
 21082        MOVE 'Y'                 TO PDEF-MASTER-SW
 21083     ELSE
 21084        MOVE 'N'                 TO PDEF-MASTER-SW
 21085     END-IF
 21086     .
 21087 8588-EXIT.
 21088     EXIT.
 21089 8589-ENDBR-ERPDEF.
 21090
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 390
* EL050.cbl
 21091* EXEC CICS ENDBR
 21092*       DATASET   (PDEF-ID)
 21093*    END-EXEC
 21094     MOVE 0
 21095       TO DFHEIV11
 21096*    MOVE '&2                    $   #00019795' TO DFHEIV0
 21097     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21098     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21099     MOVE X'2020233030303139373935' TO DFHEIV0(25:11)
 21100     CALL 'kxdfhei1' USING DFHEIV0,
 21101           PDEF-ID,
 21102           DFHEIV11,
 21103           DFHEIV99
 21104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21105     .
 21106 8589-EXIT.
 21107     EXIT.
 21108 8590-READ-CERT-MASTER.
 21109     IF PB-COMPANY-ID = 'UCL'
 21110         GO TO 8690-READ-CERT-MASTER-UCL.
 21111
 21112
 21113* EXEC CICS HANDLE CONDITION
 21114*         NOTFND    (0299-CERT-NOT-FOUND)
 21115*    END-EXEC.
 21116*    MOVE '"$I                   ! < #00019805' TO DFHEIV0
 21117     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21118     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21119     MOVE X'3C20233030303139383035' TO DFHEIV0(25:11)
 21120     CALL 'kxdfhei1' USING DFHEIV0
 21121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21122
 21123
 21124
 21125* EXEC CICS READ
 21126*        DATASET     (CERT-ID)
 21127*        INTO        (CERTIFICATE-MASTER)
 21128*        RIDFLD      (ELCERT-KEY)
 21129*        UPDATE
 21130*    END-EXEC.
 21131     MOVE LENGTH OF
 21132      CERTIFICATE-MASTER
 21133       TO DFHEIV11
 21134*    MOVE '&"IL       EU         (   #00019809' TO DFHEIV0
 21135     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21136     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21137     MOVE X'2020233030303139383039' TO DFHEIV0(25:11)
 21138     CALL 'kxdfhei1' USING DFHEIV0,
 21139           CERT-ID,
 21140           CERTIFICATE-MASTER,
 21141           DFHEIV11,
 21142           ELCERT-KEY,
 21143           DFHEIV99,
 21144           DFHEIV99,
 21145           DFHEIV99
 21146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21147
 21148
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 391
* EL050.cbl
 21149 8590-EXIT.
 21150     EXIT.
 21151
 21152 8690-READ-CERT-MASTER-UCL.
 21153
 21154* EXEC CICS HANDLE CONDITION
 21155*         NOTFND    (8700-READ-CERT-MASTER)
 21156*    END-EXEC.
 21157*    MOVE '"$I                   ! = #00019820' TO DFHEIV0
 21158     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21160     MOVE X'3D20233030303139383230' TO DFHEIV0(25:11)
 21161     CALL 'kxdfhei1' USING DFHEIV0
 21162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21163
 21164
 21165 8690-READ-CERT-CONT.
 21166
 21167* EXEC CICS READ
 21168*        DATASET     (CERT-ID)
 21169*        INTO        (CERTIFICATE-MASTER)
 21170*        RIDFLD      (ELCERT-KEY)
 21171*        UPDATE
 21172*    END-EXEC.
 21173     MOVE LENGTH OF
 21174      CERTIFICATE-MASTER
 21175       TO DFHEIV11
 21176*    MOVE '&"IL       EU         (   #00019825' TO DFHEIV0
 21177     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21178     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 21179     MOVE X'2020233030303139383235' TO DFHEIV0(25:11)
 21180     CALL 'kxdfhei1' USING DFHEIV0,
 21181           CERT-ID,
 21182           CERTIFICATE-MASTER,
 21183           DFHEIV11,
 21184           ELCERT-KEY,
 21185           DFHEIV99,
 21186           DFHEIV99,
 21187           DFHEIV99
 21188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21189
 21190
 21191     GO TO 8590-EXIT.
 21192
 21193 8700-READ-CERT-MASTER.
 21194     MOVE PB-COMPANY-CD          TO CERT2-COMP-CD.
 21195     MOVE PB-CERT-NO             TO CERT2-CERT-NO.
 21196
 21197* EXEC CICS HANDLE CONDITION
 21198*         DUPKEY    (8720-COMP-ACCOUNTS)
 21199*         ENDFILE   (8730-END-BROWSE)
 21200*         NOTFND    (8740-NOT-FOUND)
 21201*    END-EXEC.
 21202*    MOVE '"$$''I                 ! > #00019837' TO DFHEIV0
 21203     MOVE X'222424274920202020202020' TO DFHEIV0(1:12)
 21204     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21205     MOVE X'3E20233030303139383337' TO DFHEIV0(25:11)
 21206     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 392
* EL050.cbl
 21207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21208
 21209
 21210
 21211* EXEC CICS STARTBR
 21212*        DATASET     ('ELCERT5')
 21213*        RIDFLD      (ELCERT2-KEY)
 21214*        EQUAL
 21215*    END-EXEC.
 21216     MOVE 'ELCERT5' TO DFHEIV1
 21217     MOVE 0
 21218       TO DFHEIV11
 21219*    MOVE '&,         E          &   #00019843' TO DFHEIV0
 21220     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
 21221     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21222     MOVE X'2020233030303139383433' TO DFHEIV0(25:11)
 21223     CALL 'kxdfhei1' USING DFHEIV0,
 21224           DFHEIV1,
 21225           ELCERT2-KEY,
 21226           DFHEIV99,
 21227           DFHEIV11,
 21228           DFHEIV99
 21229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21230
 21231
 21232 8710-READ-NEXT.
 21233
 21234* EXEC CICS READNEXT
 21235*        DATASET     ('ELCERT5')
 21236*        INTO        (CERTIFICATE-MASTER)
 21237*        RIDFLD      (ELCERT2-KEY)
 21238*    END-EXEC.
 21239     MOVE LENGTH OF
 21240      CERTIFICATE-MASTER
 21241       TO DFHEIV12
 21242     MOVE 'ELCERT5' TO DFHEIV1
 21243     MOVE 0
 21244       TO DFHEIV11
 21245*    MOVE '&.IL                  )   #00019850' TO DFHEIV0
 21246     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21247     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21248     MOVE X'2020233030303139383530' TO DFHEIV0(25:11)
 21249     CALL 'kxdfhei1' USING DFHEIV0,
 21250           DFHEIV1,
 21251           CERTIFICATE-MASTER,
 21252           DFHEIV12,
 21253           ELCERT2-KEY,
 21254           DFHEIV99,
 21255           DFHEIV11,
 21256           DFHEIV99,
 21257           DFHEIV99
 21258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21259
 21260
 21261 8720-COMP-ACCOUNTS.
 21262
 21263* EXEC CICS ENTER
 21264*         TRACEID (001)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 393
* EL050.cbl
 21265*         FROM (PB-C-LAST-NAME)
 21266*    END-EXEC.
 21267     MOVE 001
 21268       TO DFHEIV11
 21269*    MOVE ':$F                   %   #00019857' TO DFHEIV0
 21270     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21271     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21272     MOVE X'2020233030303139383537' TO DFHEIV0(25:11)
 21273     CALL 'kxdfhei1' USING DFHEIV0,
 21274           DFHEIV11,
 21275           PB-C-LAST-NAME,
 21276           DFHEIV99,
 21277           DFHEIV99
 21278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21279
 21280
 21281
 21282* EXEC CICS ENTER
 21283*         TRACEID (002)
 21284*         FROM (CM-INSURED-LAST-NAME)
 21285*    END-EXEC.
 21286     MOVE 002
 21287       TO DFHEIV11
 21288*    MOVE ':$F                   %   #00019862' TO DFHEIV0
 21289     MOVE X'3A2446202020202020202020' TO DFHEIV0(1:12)
 21290     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 21291     MOVE X'2020233030303139383632' TO DFHEIV0(25:11)
 21292     CALL 'kxdfhei1' USING DFHEIV0,
 21293           DFHEIV11,
 21294           CM-INSURED-LAST-NAME,
 21295           DFHEIV99,
 21296           DFHEIV99
 21297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21298
 21299
 21300     IF PB-CERT-NO NOT = CM-CERT-NO
 21301         GO TO 8730-END-BROWSE.
 21302
 21303     IF PB-ACCOUNT = CM-ACCOUNT
 21304         IF PB-C-LAST-NAME = CM-INSURED-LAST-NAME
 21305             MOVE ER-2799        TO WS-ERROR
 21306             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21307             MOVE CM-CERT-EFF-DT TO EC-AM-EFFECTIVE-DT
 21308             GO TO 8730-END-BROWSE.
 21309
 21310     GO TO 8710-READ-NEXT.
 21311
 21312 8730-END-BROWSE.
 21313
 21314* EXEC CICS ENDBR
 21315*         DATASET    ('ELCERT5')
 21316*    END-EXEC.
 21317     MOVE 'ELCERT5' TO DFHEIV1
 21318     MOVE 0
 21319       TO DFHEIV11
 21320*    MOVE '&2                    $   #00019880' TO DFHEIV0
 21321     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21322     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 394
* EL050.cbl
 21323     MOVE X'2020233030303139383830' TO DFHEIV0(25:11)
 21324     CALL 'kxdfhei1' USING DFHEIV0,
 21325           DFHEIV1,
 21326           DFHEIV11,
 21327           DFHEIV99
 21328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21329
 21330
 21331 8740-NOT-FOUND.
 21332     GO TO 0299-CERT-NOT-FOUND.
 21333
 21334 8750-START-ELSTAT.
 21335
 21336* EXEC CICS STARTBR
 21337*       DATASET   (STAT-ID)
 21338*       RIDFLD    (ELSTAT-KEY)
 21339*       GTEQ
 21340*       RESP      (WS-RESPONSE)
 21341*    END-EXEC
 21342     MOVE 0
 21343       TO DFHEIV11
 21344*    MOVE '&,         G          &  N#00019888' TO DFHEIV0
 21345     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21346     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21347     MOVE X'204E233030303139383838' TO DFHEIV0(25:11)
 21348     CALL 'kxdfhei1' USING DFHEIV0,
 21349           STAT-ID,
 21350           ELSTAT-KEY,
 21351           DFHEIV99,
 21352           DFHEIV11,
 21353           DFHEIV99
 21354     MOVE EIBRESP  TO WS-RESPONSE
 21355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21356     IF WS-RESP-NORMAL
 21357        MOVE 'Y'                 TO STAT-MASTER-SW
 21358     ELSE
 21359        MOVE 'N'                 TO STAT-MASTER-SW
 21360     END-IF
 21361     .
 21362 8750-EXIT.
 21363     EXIT.
 21364 8752-READ-ELSTAT.
 21365
 21366* EXEC CICS READNEXT
 21367*       DATASET   (STAT-ID)
 21368*       RIDFLD    (ELSTAT-KEY)
 21369*       INTO      (STATE-FILE)
 21370*       RESP      (WS-RESPONSE)
 21371*    END-EXEC
 21372     MOVE LENGTH OF
 21373      STATE-FILE
 21374       TO DFHEIV12
 21375     MOVE 0
 21376       TO DFHEIV11
 21377*    MOVE '&.IL                  )  N#00019903' TO DFHEIV0
 21378     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 21379     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21380     MOVE X'204E233030303139393033' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 395
* EL050.cbl
 21381     CALL 'kxdfhei1' USING DFHEIV0,
 21382           STAT-ID,
 21383           STATE-FILE,
 21384           DFHEIV12,
 21385           ELSTAT-KEY,
 21386           DFHEIV99,
 21387           DFHEIV11,
 21388           DFHEIV99,
 21389           DFHEIV99
 21390     MOVE EIBRESP  TO WS-RESPONSE
 21391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21392     IF WS-RESP-NORMAL
 21393        MOVE 'Y'                 TO STAT-MASTER-SW
 21394     ELSE
 21395        MOVE 'N'                 TO STAT-MASTER-SW
 21396     END-IF
 21397     .
 21398 8752-EXIT.
 21399     EXIT.
 21400 8800-GET-COMP-RATE.
 21401     MOVE +1 TO IB.
 21402     IF WS-COMM-CK-AMT GREATER CT-TBF (1)
 21403         ADD +9 TO IB
 21404         IF WS-COMM-CK-AMT GREATER CT-TBF (2)
 21405             ADD +9 TO IB
 21406             IF WS-COMM-CK-AMT GREATER CT-TBF (3)
 21407                MOVE ZEROS       TO WS-WK-RATE
 21408                GO TO 8800-EXIT.
 21409
 21410     IF PB-I-AGE GREATER CT-AGE (1)
 21411         ADD +3 TO IB
 21412         IF PB-I-AGE GREATER CT-AGE (2)
 21413             ADD +3 TO IB
 21414             IF PB-I-AGE GREATER CT-AGE (3)
 21415                MOVE ZEROS       TO WS-WK-RATE
 21416                GO TO 8800-EXIT.
 21417
 21418     IF WS-WORK-TERM GREATER CT-TRM (1)
 21419         ADD +1 TO IB
 21420         IF WS-WORK-TERM GREATER CT-TRM (2)
 21421             ADD +1 TO IB
 21422             IF WS-WORK-TERM GREATER CT-TRM (3)
 21423                MOVE ZEROS       TO WS-WK-RATE
 21424                GO TO 8800-EXIT.
 21425
 21426     IF CT-RT (IB) NOT NUMERIC
 21427         MOVE CT-RT-R (IB) TO CTBL-TABLE
 21428         PERFORM 8300-READ-CTBL-TABLE THRU 8300-EXIT
 21429         GO TO 8800-GET-COMP-RATE.
 21430
 21431     MOVE CT-RT (IB) TO WS-WK-RATE.
 21432
 21433 8800-EXIT.
 21434     EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 396
* EL050.cbl
 21436 8900-ADDRESS-FILE.
 21437     IF ERACCT-FILE-ADDRESSED
 21438         SET ADDRESS OF ACCOUNT-MASTER TO ERACCT-POINTER
 21439         GO TO 8900-ADDRESS-EXIT.
 21440
 21441     IF ELCNTL-FILE-ADDRESSED
 21442         SET ADDRESS OF CONTROL-FILE   TO ELCNTL-POINTER
 21443         GO TO 8900-ADDRESS-EXIT.
 21444
 21445     IF ERPLAN-FILE-ADDRESSED
 21446         SET ADDRESS OF PLAN-RECORDS TO ERPLAN-POINTER
 21447         GO TO 8900-ADDRESS-EXIT.
 21448
 21449     IF ERFORM-FILE-ADDRESSED
 21450         SET ADDRESS OF FORM-MASTER TO ERFORM-POINTER
 21451         GO TO 8900-ADDRESS-EXIT.
 21452
 21453 8900-ADDRESS-EXIT.
 21454     EXIT.
 21455
 21456 9000-READ-CONTROL.
 21457
 21458* EXEC CICS HANDLE CONDITION
 21459*        NOTFND    (9000-NOTFND)
 21460*    END-EXEC.
 21461*    MOVE '"$I                   ! ? #00019974' TO DFHEIV0
 21462     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21463     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21464     MOVE X'3F20233030303139393734' TO DFHEIV0(25:11)
 21465     CALL 'kxdfhei1' USING DFHEIV0
 21466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21467
 21468
 21469
 21470* EXEC CICS READ
 21471*        DATASET     (CNTL-ID)
 21472*        SET         (ADDRESS OF CONTROL-FILE)
 21473*        RIDFLD      (ELCNTL-KEY)
 21474*        GTEQ
 21475*    END-EXEC.
 21476*    MOVE '&"S        G          (   #00019978' TO DFHEIV0
 21477     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21478     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21479     MOVE X'2020233030303139393738' TO DFHEIV0(25:11)
 21480     CALL 'kxdfhei1' USING DFHEIV0,
 21481           CNTL-ID,
 21482           DFHEIV20,
 21483           DFHEIV99,
 21484           ELCNTL-KEY,
 21485           DFHEIV99,
 21486           DFHEIV99,
 21487           DFHEIV99
 21488     SET ADDRESS OF CONTROL-FILE TO
 21489         DFHEIV20
 21490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21491
 21492
 21493     GO TO 9000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 397
* EL050.cbl
 21494
 21495 9000-NOTFND.
 21496     IF RC-SW-1 = '1'
 21497        MOVE ER-2616              TO WS-ERROR
 21498        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21499        GO TO 9000-EXIT.
 21500
 21501     IF RC-SW-1 = '2'
 21502        MOVE ER-2602              TO WS-ERROR
 21503        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21504
 21505 9000-EXIT.
 21506      EXIT.
 21507
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 398
* EL050.cbl
 21509 9100-READ-CONTROL.
 21510
 21511* EXEC CICS HANDLE CONDITION
 21512*        NOTFND  (9100-NOTFND)
 21513*        ENDFILE (9100-NOTFND)
 21514*    END-EXEC.
 21515*    MOVE '"$I''                  ! @ #00020002' TO DFHEIV0
 21516     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21517     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21518     MOVE X'4020233030303230303032' TO DFHEIV0(25:11)
 21519     CALL 'kxdfhei1' USING DFHEIV0
 21520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21521
 21522
 21523
 21524* EXEC CICS READ
 21525*        DATASET     (CNTL-ID)
 21526*        INTO        (CONTROL-FILE)
 21527*        RIDFLD      (ELCNTL-KEY)
 21528*        GTEQ
 21529*    END-EXEC.
 21530     MOVE LENGTH OF
 21531      CONTROL-FILE
 21532       TO DFHEIV11
 21533*    MOVE '&"IL       G          (   #00020007' TO DFHEIV0
 21534     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21535     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21536     MOVE X'2020233030303230303037' TO DFHEIV0(25:11)
 21537     CALL 'kxdfhei1' USING DFHEIV0,
 21538           CNTL-ID,
 21539           CONTROL-FILE,
 21540           DFHEIV11,
 21541           ELCNTL-KEY,
 21542           DFHEIV99,
 21543           DFHEIV99,
 21544           DFHEIV99
 21545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21546
 21547
 21548     GO TO 9100-EXIT.
 21549
 21550 9100-NOTFND.
 21551     IF RC-SW-2 = '0'
 21552        MOVE '1'                  TO STATE-RECORD-ERROR
 21553        GO TO 9100-EXIT
 21554     END-IF
 21555     IF RC-SW-2 = '1'
 21556        MOVE '1'                  TO LF-BENEFIT-ERROR
 21557        MOVE ER-2604              TO WS-ERROR
 21558        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21559        GO TO 9100-EXIT.
 21560
 21561     IF RC-SW-2 = '2'
 21562        MOVE '1'                  TO AH-BENEFIT-ERROR
 21563        MOVE ER-2605              TO WS-ERROR
 21564        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21565        GO TO 9100-EXIT.
 21566
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 399
* EL050.cbl
 21567     IF RC-SW-2 = '3'
 21568         MOVE ER-2603           TO WS-ERROR
 21569         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21570         GO TO 9100-EXIT.
 21571
 21572     IF RC-SW-2 = '4'
 21573         MOVE PB-I-LF-INPUT-CD  TO PB-I-LF-BENEFIT-CD
 21574         GO TO 9100-EXIT.
 21575
 21576     IF RC-SW-2 = '5'
 21577         MOVE PB-I-AH-INPUT-CD  TO WS-AH-INPUT-CD
 21578         IF WS-AH-INPUT-CD-1 = SPACE
 21579             MOVE WS-AH-INPUT-CD-2-3  TO PB-I-AH-BENEFIT-CD
 21580         ELSE
 21581             MOVE PB-I-AH-INPUT-CD    TO PB-I-AH-BENEFIT-CD.
 21582
 21583 9100-EXIT.
 21584      EXIT.
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 400
* EL050.cbl
 21586 9200-CONTROL-GETMAIN.
 21587
 21588* EXEC CICS GETMAIN
 21589*         LENGTH   (750)
 21590*         SET      (ADDRESS OF CONTROL-FILE)
 21591*    END-EXEC.
 21592     MOVE 750
 21593       TO DFHEIV11
 21594*    MOVE '," L                  $   #00020053' TO DFHEIV0
 21595     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 21596     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21597     MOVE X'2020233030303230303533' TO DFHEIV0(25:11)
 21598     CALL 'kxdfhei1' USING DFHEIV0,
 21599           DFHEIV20,
 21600           DFHEIV11,
 21601           DFHEIV99
 21602     SET ADDRESS OF CONTROL-FILE TO
 21603         DFHEIV20
 21604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21605
 21606
 21607     SET ELCNTL-POINTER TO ADDRESS OF CONTROL-FILE.
 21608
 21609 9200-EXIT.
 21610     EXIT.
 21611
 21612 9250-UNLOCK-RETURN.
 21613
 21614* EXEC CICS UNLOCK
 21615*        DATASET   (CERT-ID)
 21616*    END-EXEC.
 21617*    MOVE '&*                    #   #00020064' TO DFHEIV0
 21618     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 21619     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21620     MOVE X'2020233030303230303634' TO DFHEIV0(25:11)
 21621     CALL 'kxdfhei1' USING DFHEIV0,
 21622           CERT-ID,
 21623           DFHEIV99
 21624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21625
 21626
 21627 9300-ABEND.
 21628     MOVE DFHEIBLK               TO WS-ERROR-LINE.
 21629
 21630
 21631* EXEC CICS LINK
 21632*        PROGRAM   ('EL004')
 21633*        COMMAREA  (WS-ERROR-LINE)
 21634*        LENGTH    (72)
 21635*    END-EXEC.
 21636     MOVE 'EL004' TO DFHEIV1
 21637     MOVE 72
 21638       TO DFHEIV11
 21639*    MOVE '."C                   (   #00020071' TO DFHEIV0
 21640     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21641     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21642     MOVE X'2020233030303230303731' TO DFHEIV0(25:11)
 21643     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 401
* EL050.cbl
 21644           DFHEIV1,
 21645           WS-ERROR-LINE,
 21646           DFHEIV11,
 21647           DFHEIV99,
 21648           DFHEIV99,
 21649           DFHEIV99,
 21650           DFHEIV99
 21651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21652
 21653
 21654     MOVE WS-ERROR-LINE          TO PENDING-BUSINESS.
 21655
 21656
 21657* EXEC CICS ABEND
 21658*        ABCODE ('EL50')
 21659*    END-EXEC.
 21660     MOVE 'EL50' TO DFHEIV5
 21661*    MOVE '.,A                   "   #00020079' TO DFHEIV0
 21662     MOVE X'2E2C41202020202020202020' TO DFHEIV0(1:12)
 21663     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 21664     MOVE X'2020233030303230303739' TO DFHEIV0(25:11)
 21665     CALL 'kxdfhei1' USING DFHEIV0,
 21666           DFHEIV5
 21667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21668
 21669
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 402
* EL050.cbl
 21671
 21672******************************************************************
 21673*                                                                *
 21674*            E R R O R   F O R M A T   R O U T I N E             *
 21675*                                                                *
 21676******************************************************************
 21677
 21678 9900-ERROR-FORMAT.
 21679
 21680     IF WS-ERROR  = PB-COMMON-ERROR (1) OR
 21681                    PB-COMMON-ERROR (2) OR
 21682                    PB-COMMON-ERROR (3) OR
 21683                    PB-COMMON-ERROR (4) OR
 21684                    PB-COMMON-ERROR (5) OR
 21685                    PB-COMMON-ERROR (6) OR
 21686                    PB-COMMON-ERROR (7) OR
 21687                    PB-COMMON-ERROR (8) OR
 21688                    PB-COMMON-ERROR (9) OR
 21689                    PB-COMMON-ERROR (10)
 21690        GO TO 9900-EXIT.
 21691
 21692     IF PB-NO-OF-ERRORS = +10
 21693        GO TO 9900-EXIT.
 21694
 21695     ADD +1  TO PB-NO-OF-ERRORS.
 21696     MOVE WS-ERROR               TO PB-COMMON-ERROR
 21697                                       (PB-NO-OF-ERRORS).
 21698 9900-EXIT.
 21699     EXIT.
 21700
 21701 9990-RETURN.
 21702     IF BROWSE-STARTED
 21703
 21704* EXEC CICS ENDBR
 21705*            DATASET  (ACCT-ID)
 21706*       END-EXEC.
 21707     MOVE 0
 21708       TO DFHEIV11
 21709*    MOVE '&2                    $   #00020116' TO DFHEIV0
 21710     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21711     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21712     MOVE X'2020233030303230313136' TO DFHEIV0(25:11)
 21713     CALL 'kxdfhei1' USING DFHEIV0,
 21714           ACCT-ID,
 21715           DFHEIV11,
 21716           DFHEIV99
 21717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21718
 21719
 21720 9990-EXIT.
 21721     EXIT.
 21722
 21723
 21724****Check for CRTO record, add one if not found.
 21725 9991-CHECK-FOR-ELCRTO.
 21726
 21727* EXEC CICS HANDLE CONDITION
 21728*         NOTFND  (9991-CRTO-NOT-FOUND)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 403
* EL050.cbl
 21729*         ENDFILE (9991-CRTO-NOT-FOUND)
 21730*     END-EXEC.
 21731*    MOVE '"$I''                  ! A #00020126' TO DFHEIV0
 21732     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21733     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21734     MOVE X'4120233030303230313236' TO DFHEIV0(25:11)
 21735     CALL 'kxdfhei1' USING DFHEIV0
 21736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21737
 21738     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTO-KEY
 21739     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 21740     MOVE +0                     TO ELCRTO-SEQ-NO
 21741
 21742
 21743* EXEC CICS READ
 21744*       DATASET   ('ELCRTO')
 21745*       INTO      (ORIGINAL-CERTIFICATE)
 21746*       RIDFLD    (ELCRTO-KEY)
 21747*       GTEQ
 21748*       RESP      (WS-RESPONSE)
 21749*    END-EXEC
 21750     MOVE LENGTH OF
 21751      ORIGINAL-CERTIFICATE
 21752       TO DFHEIV11
 21753     MOVE 'ELCRTO' TO DFHEIV1
 21754*    MOVE '&"IL       G          (  N#00020134' TO DFHEIV0
 21755     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21756     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21757     MOVE X'204E233030303230313334' TO DFHEIV0(25:11)
 21758     CALL 'kxdfhei1' USING DFHEIV0,
 21759           DFHEIV1,
 21760           ORIGINAL-CERTIFICATE,
 21761           DFHEIV11,
 21762           ELCRTO-KEY,
 21763           DFHEIV99,
 21764           DFHEIV99,
 21765           DFHEIV99
 21766     MOVE EIBRESP  TO WS-RESPONSE
 21767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21768
 21769     IF WS-RESP-NORMAL
 21770        AND (OC-CONTROL-PRIMARY (1:33) =
 21771                 PB-CONTROL-BY-ACCOUNT (1:33))
 21772        AND (OC-RECORD-TYPE =  'I')
 21773           IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 21774               GO TO 9991-CHECK-INDICATORS
 21775           ELSE
 21776               SUBTRACT +1 FROM OC-KEY-SEQ-NO
 21777               GO TO 9991-CRTO-ADD-REC
 21778           END-IF
 21779     END-IF.
 21780
 21781 9991-CRTO-NOT-FOUND.
 21782
 21783     MOVE SPACES              TO ORIGINAL-CERTIFICATE
 21784     MOVE 'OC'                TO OC-RECORD-ID
 21785     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 21786                              TO OC-CONTROL-PRIMARY (1:33)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 404
* EL050.cbl
 21787     MOVE +4096               TO OC-KEY-SEQ-NO.
 21788
 21789 9991-CRTO-ADD-REC.
 21790
 21791     MOVE 'E050'              TO OC-LAST-MAINT-BY
 21792     MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 21793     MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 21794     MOVE 'I'                 TO OC-RECORD-TYPE
 21795     IF PB-ISSUE
 21796         MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 21797         MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 21798         MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 21799         MOVE PB-I-AGE               TO OC-INS-AGE
 21800         MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 21801         MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 21802         MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 21803         MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 21804         MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 21805         MOVE PB-I-LF-TERM           TO OC-LF-TERM
 21806         MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 21807         MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 21808         MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21809         MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21810         MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 21811         IF PB-I-JOINT-COMMISSION > +0
 21812             MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 21813         ELSE
 21814             MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 21815         END-IF
 21816         MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 21817         MOVE +0                     TO OC-LF-CANCEL-AMT
 21818                                        OC-LF-ITD-CANCEL-AMT
 21819         MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 21820         MOVE PB-I-AH-TERM           TO OC-AH-TERM
 21821         MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 21822         MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 21823         MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 21824         MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 21825         MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 21826         MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 21827         MOVE +0                     TO OC-AH-CANCEL-AMT
 21828                                        OC-AH-ITD-CANCEL-AMT
 21829         MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 21830         MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 21831         MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 21832     ELSE
 21833         MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 21834         MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 21835         MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 21836         MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 21837         MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 21838         MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 21839         MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 21840         MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 21841         IF ((PB-C-LF-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21842          (CM-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21843             MOVE SPACES             TO OC-LF-BENCD
 21844             MOVE ZEROS              TO OC-LF-TERM
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 405
* EL050.cbl
 21845                                        OC-LF-BEN-AMT
 21846                                        OC-LF-PRM-AMT
 21847                                        OC-LF-ALT-BEN-AMT
 21848                                        OC-LF-ALT-PRM-AMT
 21849                                        OC-LF-COMM-PCT
 21850                                        OC-LF-CANCEL-AMT
 21851             MOVE LOW-VALUES         TO OC-LF-EXP-DT
 21852             MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
 21853         ELSE
 21854             MOVE CM-LF-BENEFIT-CD   TO OC-LF-BENCD
 21855             MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
 21856             MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
 21857             MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
 21858             MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 21859             MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 21860             MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
 21861             MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
 21862             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 21863             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 21864         END-IF
 21865         MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 21866         IF ((PB-C-AH-CANCEL-DT = SPACES OR LOW-VALUES) AND
 21867          (CM-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES))
 21868             MOVE SPACES             TO OC-AH-BENCD
 21869             MOVE ZEROS              TO OC-AH-TERM
 21870                                        OC-AH-BEN-AMT
 21871                                        OC-AH-PRM-AMT
 21872                                        OC-AH-COMM-PCT
 21873                                        OC-AH-CANCEL-AMT
 21874                                        OC-AH-CP
 21875             MOVE LOW-VALUES         TO OC-AH-EXP-DT
 21876             MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
 21877         ELSE
 21878             MOVE CM-AH-BENEFIT-CD   TO OC-AH-BENCD
 21879             MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
 21880             MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
 21881             MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
 21882             MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
 21883             MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
 21884             MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
 21885             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 21886             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 21887         END-IF
 21888         MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 21889         MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 21890         MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 21891         MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 21892     END-IF
 21893     MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 21894
 21895     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 21896
 21897
 21898* EXEC CICS READ
 21899*         DATASET   (FILE-ERMAIL)
 21900*         RIDFLD    (MA-CONTROL-PRIMARY)
 21901*         INTO      (MAILING-DATA)
 21902*         RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 406
* EL050.cbl
 21903*    END-EXEC
 21904     MOVE LENGTH OF
 21905      MAILING-DATA
 21906       TO DFHEIV11
 21907*    MOVE '&"IL       E          (  N#00020270' TO DFHEIV0
 21908     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21909     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21910     MOVE X'204E233030303230323730' TO DFHEIV0(25:11)
 21911     CALL 'kxdfhei1' USING DFHEIV0,
 21912           FILE-ERMAIL,
 21913           MAILING-DATA,
 21914           DFHEIV11,
 21915           MA-CONTROL-PRIMARY,
 21916           DFHEIV99,
 21917           DFHEIV99,
 21918           DFHEIV99
 21919     MOVE EIBRESP  TO WS-RESPONSE
 21920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21921
 21922     IF WS-RESP-NORMAL
 21923         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 21924     END-IF.
 21925
 21926     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 21927     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 21928
 21929
 21930* EXEC CICS READ
 21931*         DATASET  (CRTT-ID)
 21932*         RIDFLD   (WS-ELCRTT-KEY)
 21933*         INTO     (CERTIFICATE-TRAILERS)
 21934*         RESP     (WS-RESPONSE)
 21935*    END-EXEC
 21936     MOVE LENGTH OF
 21937      CERTIFICATE-TRAILERS
 21938       TO DFHEIV11
 21939*    MOVE '&"IL       E          (  N#00020284' TO DFHEIV0
 21940     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21941     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21942     MOVE X'204E233030303230323834' TO DFHEIV0(25:11)
 21943     CALL 'kxdfhei1' USING DFHEIV0,
 21944           CRTT-ID,
 21945           CERTIFICATE-TRAILERS,
 21946           DFHEIV11,
 21947           WS-ELCRTT-KEY,
 21948           DFHEIV99,
 21949           DFHEIV99,
 21950           DFHEIV99
 21951     MOVE EIBRESP  TO WS-RESPONSE
 21952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21953
 21954     IF WS-RESP-NORMAL
 21955         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
 21956         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
 21957     END-IF.
 21958
 21959
 21960* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 407
* EL050.cbl
 21961*       DATASET   ('ELCRTO')
 21962*       FROM      (ORIGINAL-CERTIFICATE)
 21963*       RIDFLD    (OC-CONTROL-PRIMARY)
 21964*       RESP      (WS-RESPONSE)
 21965*    END-EXEC.
 21966     MOVE LENGTH OF
 21967      ORIGINAL-CERTIFICATE
 21968       TO DFHEIV11
 21969     MOVE 'ELCRTO' TO DFHEIV1
 21970*    MOVE '&$ L                  ''  N#00020296' TO DFHEIV0
 21971     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 21972     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21973     MOVE X'204E233030303230323936' TO DFHEIV0(25:11)
 21974     CALL 'kxdfhei1' USING DFHEIV0,
 21975           DFHEIV1,
 21976           ORIGINAL-CERTIFICATE,
 21977           DFHEIV11,
 21978           OC-CONTROL-PRIMARY,
 21979           DFHEIV99,
 21980           DFHEIV99
 21981     MOVE EIBRESP  TO WS-RESPONSE
 21982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21983
 21984
 21985     GO TO 9991-EXIT.
 21986
 21987 9991-CHECK-INDICATORS.
 21988
 21989     IF PB-ISSUE AND OC-ISSUE-TRAN-IND NOT = 'N'
 21990         GO TO 9991-EXIT
 21991     END-IF.
 21992
 21993     IF PB-CANCELLATION AND OC-CANCEL-TRAN-IND NOT = 'N'
 21994         GO TO 9991-EXIT
 21995     END-IF.
 21996
 21997
 21998* EXEC CICS READ
 21999*       DATASET   ('ELCRTO')
 22000*       INTO      (ORIGINAL-CERTIFICATE)
 22001*       RIDFLD    (OC-CONTROL-PRIMARY)
 22002*       UPDATE
 22003*       RESP      (WS-RESPONSE)
 22004*    END-EXEC
 22005     MOVE LENGTH OF
 22006      ORIGINAL-CERTIFICATE
 22007       TO DFHEIV11
 22008     MOVE 'ELCRTO' TO DFHEIV1
 22009*    MOVE '&"IL       EU         (  N#00020315' TO DFHEIV0
 22010     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22011     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22012     MOVE X'204E233030303230333135' TO DFHEIV0(25:11)
 22013     CALL 'kxdfhei1' USING DFHEIV0,
 22014           DFHEIV1,
 22015           ORIGINAL-CERTIFICATE,
 22016           DFHEIV11,
 22017           OC-CONTROL-PRIMARY,
 22018           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 408
* EL050.cbl
 22019           DFHEIV99,
 22020           DFHEIV99
 22021     MOVE EIBRESP  TO WS-RESPONSE
 22022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22023     IF WS-RESP-NORMAL
 22024        IF PB-ISSUE
 22025          MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 22026          MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 22027          MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 22028          MOVE PB-I-AGE               TO OC-INS-AGE
 22029          MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 22030          MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 22031          MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 22032          MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 22033          MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 22034          MOVE PB-I-LF-TERM           TO OC-LF-TERM
 22035          MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 22036          MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 22037          MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 22038          MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 22039          MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 22040          IF PB-I-JOINT-COMMISSION > +0
 22041              MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 22042          ELSE
 22043              MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 22044          END-IF
 22045          MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 22046          MOVE PB-I-AH-TERM           TO OC-AH-TERM
 22047          MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 22048          MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 22049          MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 22050          MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 22051          MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 22052          MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 22053          MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 22054
 22055          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO MA-CONTROL-PRIMARY
 22056
 22057* EXEC CICS READ
 22058*             DATASET   (FILE-ERMAIL)
 22059*             RIDFLD    (MA-CONTROL-PRIMARY)
 22060*             INTO      (MAILING-DATA)
 22061*             RESP      (WS-RESPONSE)
 22062*         END-EXEC
 22063     MOVE LENGTH OF
 22064      MAILING-DATA
 22065       TO DFHEIV11
 22066*    MOVE '&"IL       E          (  N#00020355' TO DFHEIV0
 22067     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22068     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22069     MOVE X'204E233030303230333535' TO DFHEIV0(25:11)
 22070     CALL 'kxdfhei1' USING DFHEIV0,
 22071           FILE-ERMAIL,
 22072           MAILING-DATA,
 22073           DFHEIV11,
 22074           MA-CONTROL-PRIMARY,
 22075           DFHEIV99,
 22076           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 409
* EL050.cbl
 22077           DFHEIV99
 22078     MOVE EIBRESP  TO WS-RESPONSE
 22079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22080          IF WS-RESP-NORMAL
 22081             MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
 22082          END-IF
 22083
 22084          MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
 22085          MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
 22086
 22087* EXEC CICS READ
 22088*             DATASET  (CRTT-ID)
 22089*             RIDFLD   (WS-ELCRTT-KEY)
 22090*             INTO     (CERTIFICATE-TRAILERS)
 22091*             RESP     (WS-RESPONSE)
 22092*         END-EXEC
 22093     MOVE LENGTH OF
 22094      CERTIFICATE-TRAILERS
 22095       TO DFHEIV11
 22096*    MOVE '&"IL       E          (  N#00020367' TO DFHEIV0
 22097     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22098     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22099     MOVE X'204E233030303230333637' TO DFHEIV0(25:11)
 22100     CALL 'kxdfhei1' USING DFHEIV0,
 22101           CRTT-ID,
 22102           CERTIFICATE-TRAILERS,
 22103           DFHEIV11,
 22104           WS-ELCRTT-KEY,
 22105           DFHEIV99,
 22106           DFHEIV99,
 22107           DFHEIV99
 22108     MOVE EIBRESP  TO WS-RESPONSE
 22109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22110          IF WS-RESP-NORMAL
 22111             MOVE CS-INS-AGE-DEFAULT-FLAG TO
 22112                               OC-INS-AGE-DEFAULT-FLAG
 22113             MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 22114                               OC-JNT-AGE-DEFAULT-FLAG
 22115          END-IF
 22116
 22117        ELSE
 22118          IF PB-C-LF-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22119             MOVE PB-C-LF-CANCEL-DT  TO OC-LF-CANCEL-DT
 22120             MOVE PB-C-LF-CANCEL-AMT TO OC-LF-CANCEL-AMT
 22121             MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
 22122          END-IF
 22123          IF PB-C-AH-CANCEL-DT NOT = SPACES AND LOW-VALUES
 22124             MOVE PB-C-AH-CANCEL-DT  TO OC-AH-CANCEL-DT
 22125             MOVE PB-C-AH-CANCEL-AMT TO OC-AH-CANCEL-AMT
 22126             MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
 22127          END-IF
 22128          MOVE 'Y'                   TO OC-CANCEL-TRAN-IND
 22129        END-IF
 22130
 22131* EXEC CICS REWRITE
 22132*          DATASET   ('ELCRTO')
 22133*          FROM      (ORIGINAL-CERTIFICATE)
 22134*          RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 410
* EL050.cbl
 22135*       END-EXEC
 22136     MOVE LENGTH OF
 22137      ORIGINAL-CERTIFICATE
 22138       TO DFHEIV11
 22139     MOVE 'ELCRTO' TO DFHEIV1
 22140*    MOVE '&& L                  %  N#00020393' TO DFHEIV0
 22141     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22142     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22143     MOVE X'204E233030303230333933' TO DFHEIV0(25:11)
 22144     CALL 'kxdfhei1' USING DFHEIV0,
 22145           DFHEIV1,
 22146           ORIGINAL-CERTIFICATE,
 22147           DFHEIV11,
 22148           DFHEIV99
 22149     MOVE EIBRESP  TO WS-RESPONSE
 22150     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22151     END-IF.
 22152
 22153 9991-EXIT.
 22154     EXIT.
 22155
 22156
 22157 9999-RETURN.
 22158     MOVE PENDING-BUSINESS       TO  DFHCOMMAREA.
 22159
 22160
 22161* EXEC CICS RETURN
 22162*    END-EXEC.
 22163*    MOVE '.(                    ''   #00020407' TO DFHEIV0
 22164     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 22165     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 22166     MOVE X'2020233030303230343037' TO DFHEIV0(25:11)
 22167     CALL 'kxdfhei1' USING DFHEIV0,
 22168           DFHEIV99,
 22169           DFHEIV99,
 22170           DFHEIV99,
 22171           DFHEIV99,
 22172           DFHEIV99,
 22173           DFHEIV99
 22174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22175
 22176
 22177
 22178* GOBACK.
 22179     MOVE '9%                    "   ' TO DFHEIV0
 22180     MOVE 'EL050' TO DFHEIV1
 22181     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22182     GOBACK.
 22183
 22184 9999-DFHBACK SECTION.
 22185     MOVE '9%                    "   ' TO DFHEIV0
 22186     MOVE 'EL050' TO DFHEIV1
 22187     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22188     GOBACK.
 22189 9999-DFHEXIT.
 22190     IF DFHEIGDJ EQUAL 0001
 22191         NEXT SENTENCE
 22192     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 411
* EL050.cbl
 22193         GO TO 9300-ABEND,
 22194               3990-FILES-NOT-OPEN
 22195         DEPENDING ON DFHEIGDI
 22196     ELSE IF DFHEIGDJ EQUAL 3
 22197         GO TO 6610-START-BROWSE,
 22198               6630-ERRESS-PROBLEM,
 22199               6630-END-OF-FILE
 22200         DEPENDING ON DFHEIGDI
 22201     ELSE IF DFHEIGDJ EQUAL 4
 22202         GO TO 6630-END-OF-FILE,
 22203               6630-ERRESS-PROBLEM,
 22204               6630-ERRESS-PROBLEM,
 22205               6630-END-OF-FILE
 22206         DEPENDING ON DFHEIGDI
 22207     ELSE IF DFHEIGDJ EQUAL 5
 22208         GO TO 6630-END-OF-FILE,
 22209               6630-END-OF-FILE,
 22210               6630-ERRESS-PROBLEM,
 22211               6630-ERRESS-PROBLEM
 22212         DEPENDING ON DFHEIGDI
 22213     ELSE IF DFHEIGDJ EQUAL 6
 22214         GO TO 6660-START-BROWSE,
 22215               6690-ERRESC-PROBLEM,
 22216               6690-ERRESC-PROBLEM,
 22217               6690-END-OF-FILE
 22218         DEPENDING ON DFHEIGDI
 22219     ELSE IF DFHEIGDJ EQUAL 7
 22220         GO TO 6690-END-OF-FILE,
 22221               6690-ERRESC-PROBLEM,
 22222               6690-ERRESC-PROBLEM,
 22223               6690-END-OF-FILE
 22224         DEPENDING ON DFHEIGDI
 22225     ELSE IF DFHEIGDJ EQUAL 8
 22226         GO TO 6690-END-OF-FILE,
 22227               6690-ERRESC-PROBLEM,
 22228               6690-ERRESC-PROBLEM,
 22229               6690-END-OF-FILE
 22230         DEPENDING ON DFHEIGDI
 22231     ELSE IF DFHEIGDJ EQUAL 9
 22232         GO TO 7250-CONTINUE,
 22233               7250-CONTINUE
 22234         DEPENDING ON DFHEIGDI
 22235     ELSE IF DFHEIGDJ EQUAL 10
 22236         GO TO 7300-CONTINUE,
 22237               7300-CONTINUE
 22238         DEPENDING ON DFHEIGDI
 22239     ELSE IF DFHEIGDJ EQUAL 11
 22240         GO TO 8000-FREE-MAIN
 22241         DEPENDING ON DFHEIGDI
 22242     ELSE IF DFHEIGDJ EQUAL 12
 22243         GO TO 8100-NOTFND,
 22244               8100-NOTFND
 22245         DEPENDING ON DFHEIGDI
 22246     ELSE IF DFHEIGDJ EQUAL 13
 22247         GO TO 8110-NOTFND,
 22248               8110-NOTFND
 22249         DEPENDING ON DFHEIGDI
 22250     ELSE IF DFHEIGDJ EQUAL 14
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 412
* EL050.cbl
 22251         GO TO 8130-EXIT
 22252         DEPENDING ON DFHEIGDI
 22253     ELSE IF DFHEIGDJ EQUAL 15
 22254         GO TO 8150-exit
 22255         DEPENDING ON DFHEIGDI
 22256     ELSE IF DFHEIGDJ EQUAL 16
 22257         GO TO 8180-NOTFND
 22258         DEPENDING ON DFHEIGDI
 22259     ELSE IF DFHEIGDJ EQUAL 17
 22260         GO TO 8190-NOTFND
 22261         DEPENDING ON DFHEIGDI
 22262     ELSE IF DFHEIGDJ EQUAL 18
 22263         GO TO 8195-NOTFND
 22264         DEPENDING ON DFHEIGDI
 22265     ELSE IF DFHEIGDJ EQUAL 19
 22266         GO TO 8200-NOTFND
 22267         DEPENDING ON DFHEIGDI
 22268     ELSE IF DFHEIGDJ EQUAL 20
 22269         GO TO 8300-NOTFND,
 22270               8300-ERRESS-PROBLEM,
 22271               8300-ERRESS-PROBLEM,
 22272               8300-NOTFND
 22273         DEPENDING ON DFHEIGDI
 22274     ELSE IF DFHEIGDJ EQUAL 21
 22275         GO TO 8450-FORM-NOT-FOUND,
 22276               8450-FORM-NOT-FOUND
 22277         DEPENDING ON DFHEIGDI
 22278     ELSE IF DFHEIGDJ EQUAL 22
 22279         GO TO 0199-ACCT-NOT-FOUND,
 22280               0199-ACCT-NOT-FOUND
 22281         DEPENDING ON DFHEIGDI
 22282     ELSE IF DFHEIGDJ EQUAL 23
 22283         GO TO 0199-ACCT-NOT-FOUND,
 22284               0199-ACCT-NOT-FOUND
 22285         DEPENDING ON DFHEIGDI
 22286     ELSE IF DFHEIGDJ EQUAL 24
 22287         GO TO 8582-COMP-NOT-FOUND,
 22288               8582-COMP-NOT-FOUND
 22289         DEPENDING ON DFHEIGDI
 22290     ELSE IF DFHEIGDJ EQUAL 25
 22291         GO TO 8583-AGTC-NOT-FOUND,
 22292               8583-AGTC-NOT-FOUND
 22293         DEPENDING ON DFHEIGDI
 22294     ELSE IF DFHEIGDJ EQUAL 26
 22295         GO TO 8584-BXRF-NOT-FOUND,
 22296               8584-BXRF-NOT-FOUND
 22297         DEPENDING ON DFHEIGDI
 22298     ELSE IF DFHEIGDJ EQUAL 27
 22299         GO TO 8585-PLAN-NOT-FOUND,
 22300               8585-PLAN-NOT-FOUND
 22301         DEPENDING ON DFHEIGDI
 22302     ELSE IF DFHEIGDJ EQUAL 28
 22303         GO TO 0299-CERT-NOT-FOUND
 22304         DEPENDING ON DFHEIGDI
 22305     ELSE IF DFHEIGDJ EQUAL 29
 22306         GO TO 8700-READ-CERT-MASTER
 22307         DEPENDING ON DFHEIGDI
 22308     ELSE IF DFHEIGDJ EQUAL 30
* Micro Focus Server Express         V5.1 revision 000 18-Jan-16 09:11 Page 413
* EL050.cbl
 22309         GO TO 8720-COMP-ACCOUNTS,
 22310               8730-END-BROWSE,
 22311               8740-NOT-FOUND
 22312         DEPENDING ON DFHEIGDI
 22313     ELSE IF DFHEIGDJ EQUAL 31
 22314         GO TO 9000-NOTFND
 22315         DEPENDING ON DFHEIGDI
 22316     ELSE IF DFHEIGDJ EQUAL 32
 22317         GO TO 9100-NOTFND,
 22318               9100-NOTFND
 22319         DEPENDING ON DFHEIGDI
 22320     ELSE IF DFHEIGDJ EQUAL 33
 22321         GO TO 9991-CRTO-NOT-FOUND,
 22322               9991-CRTO-NOT-FOUND
 22323         DEPENDING ON DFHEIGDI.
 22324     MOVE '9%                    "   ' TO DFHEIV0
 22325     MOVE 'EL050' TO DFHEIV1
 22326     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 22327     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40688     Code:       90317
