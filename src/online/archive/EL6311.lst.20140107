* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68******************************************************************
    69
    70 ENVIRONMENT DIVISION.
    71
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page   3
* EL6311.cbl
    73 DATA DIVISION.
    74 WORKING-STORAGE SECTION.
    75 01  DFH-START PIC X(04).
    76 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    77 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    78 77  FILLER  PIC X(32)  VALUE '********************************'.
    79 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    80 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    81 77  A1                          PIC S999 COMP-3 VALUE +0.
    82 77  N1                          PIC S999 COMP-3 VALUE +0.
    83 77  N2                          PIC S999 COMP-3 VALUE +0.
    84 77  N3                          PIC S999 COMP-3 VALUE +0.
    85 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    86 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    87 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    88     88  REVERSAL                    VALUE 'Y'.
    89 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    90 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    91 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    92 77  WS-TALLY                    PIC 99  VALUE ZEROS.
    93 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
    94     88  ERMAIL-FOUND                 VALUE 'Y'.
    95 77  A2                          PIC S9(5) COMP-3 VALUE +0.
    96 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    97 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    98 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
    99     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   100
   101*    COPY ELCSCTM.
   102******************************************************************
   103*                                                                *
   104*                                                                *
   105*                            ELCSCTM                             *
   106*                            VMOD=2.001                          *
   107*                                                                *
   108*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   109*                                                                *
   110******************************************************************
   111 01  SECURITY-MESSAGE.
   112     12  FILLER                          PIC X(30)
   113            VALUE '** LOGIC SECURITY VIOLATION -'.
   114     12  SM-READ                         PIC X(6).
   115     12  FILLER                          PIC X(5)
   116            VALUE ' PGM='.
   117     12  SM-PGM                          PIC X(6).
   118     12  FILLER                          PIC X(5)
   119            VALUE ' OPR='.
   120     12  SM-PROCESSOR-ID                 PIC X(4).
   121     12  FILLER                          PIC X(6)
   122            VALUE ' TERM='.
   123     12  SM-TERMID                       PIC X(4).
   124     12  FILLER                          PIC XX   VALUE SPACE.
   125     12  SM-JUL-DATE                     PIC 9(5).
   126     12  FILLER                          PIC X    VALUE SPACE.
   127     12  SM-TIME                         PIC 99.99.
   128
   129
   130*    COPY ELCSCRTY.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page   4
* EL6311.cbl
   131******************************************************************
   132*                                                                *
   133*                                                                *
   134*                            ELCSCRTY                            *
   135*                            VMOD=2.001                          *
   136*                                                                *
   137*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   138*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   139*        SAVED IN PI-SECURITY-ADDRESS.                           *
   140*                                                                *
   141******************************************************************
   142 01  SECURITY-CONTROL.
   143     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   144     12  FILLER                       PIC XX    VALUE 'SC'.
   145     12  SC-CREDIT-CODES.
   146         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   147             20  SC-CREDIT-DISPLAY    PIC X.
   148             20  SC-CREDIT-UPDATE     PIC X.
   149     12  SC-CLAIMS-CODES.
   150         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   151             20  SC-CLAIMS-DISPLAY    PIC X.
   152             20  SC-CLAIMS-UPDATE     PIC X.
   153
   154 01  WS-VA-NO-COMM-MESS.
   155     12  FILLER                  PIC X(41) VALUE
   156        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   157 01  WS-OC-MESSAGE.
   158     12  FILLER                  PIC X(43) VALUE
   159        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   160     12  WS-OC-DIS-AMT           PIC -----9.99.
   161     12  FILLER                  PIC X(4) VALUE ' ON '.
   162     12  WS-OC-DATE              PIC X(10).
   163 01  WS-DATE-AREA.
   164     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   165     12  WS-CURRENT-DT.
   166         16  FILLER              PIC X(6)    VALUE SPACES.
   167         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   168     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   169     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   170     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   171
   172 01  STANDARD-AREAS.
   173     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   174     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   175     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   176     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   177     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   178     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   179     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   180     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   181     12  PGM-NAME                PIC X(8).
   182     12  TIME-IN                 PIC S9(7).
   183     12  TIME-OUT-R  REDEFINES TIME-IN.
   184         16  FILLER              PIC X.
   185         16  TIME-OUT            PIC 99V99.
   186         16  FILLER              PIC XX.
   187     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   188     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page   5
* EL6311.cbl
   189     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   190     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   191     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   192     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   193     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   194     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   195     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   196     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   197     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   198     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   199     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   200     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   201     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   202     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   203     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   204     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   205     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   206     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   207     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   208     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   209     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   210     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   211     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   212     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   213     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   214     12  FILE-ID                 PIC X(8).
   215     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   216     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   217     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   218     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   219     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   220     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   221     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   222     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   223     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   224     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   225     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   226     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   227     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   228     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   229     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   230
   231 01  WS-PASS-AREA.
   232     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   233     05  WS-PASS-VADS-REC    PIC X(350).
   234*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   235*                                COPY ELCZREC.
   236******************************************************************
   237*                                                                *
   238*                                                                *
   239*                            ELCZREC.                            *
   240*                                                                *
   241*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   242*                                                                *
   243******************************************************************
   244*-----------------------------------------------------------------
   245*                   C H A N G E   L O G
   246*
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page   6
* EL6311.cbl
   247* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   248*-----------------------------------------------------------------
   249*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   250* EFFECTIVE    NUMBER
   251*-----------------------------------------------------------------
   252* 122011    2011022800001  AJRA  NEW FILE
   253* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   254* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   255* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   256*-----------------------------------------------------------------
   257 01  W-Z-CONTROL-DATA.
   258     05  W-NUMBER-OF-COPIES      PIC  9.
   259     05  FILLER                  PIC  X.
   260     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   261     05  FILLER                  PIC  X.
   262     05  W-DAYS-TO-RESEND        PIC  999.
   263     05  FILLER                  PIC  X.
   264     05  W-FORM-TO-RESEND        PIC  X(4).
   265     05  W-ADD-BAR-CODE          PIC  X.
   266     05  W-PROMPT-LETTER         PIC  X.
   267     05  W-HAS-RETURN-ENV        PIC  X.
   268     05  W-ENCLOSURE-CD          PIC  XXX.
   269     05  FILLER                  PIC  X.
   270     05  W-AUTO-CLOSE-IND        PIC  X.
   271     05  FILLER                  PIC  X.
   272     05  W-LETTER-TO-BENE        PIC  X.
   273     05  FILLER                  PIC  X.
   274     05  W-LETTER-TO-ACCT        PIC  X.
   275     05  FILLER                  PIC  X.
   276     05  W-LETTER-TYPE           PIC  X.
   277     05  FILLER                  PIC  X.
   278     05  W-PRINT-CERTIFICATE     PIC  X.
   279     05  FILLER                  PIC  X.
   280     05  W-REFUND-REQUIRED       PIC  X.
   281     05  FILLER                  PIC  X.
   282     05  W-ONBASE-CODE           PIC  XX.
   283     05  FILLER                  PIC  X.
   284     05  W-ACCT-SUMM             PIC  X.
   285     05  FILLER                  PIC  X.
   286     05  W-CSO-SUMM              PIC  X.
   287     05  FILLER                  PIC  X.
   288     05  W-REASONS-REQUIRED      PIC  X.
   289     05  FILLER                  PIC  X(29).
   290******************************************************************
   291*                                                                *
   292*              A C C E S S   K E Y S                             *
   293*                                                                *
   294******************************************************************
   295
   296 01  ACCESS-KEYS.
   297     12  ERPYAJ-KEY.
   298         16  ERPYAJ-COMPANY-CD       PIC X.
   299         16  ERPYAJ-CARRIER          PIC X.
   300         16  ERPYAJ-GROUPING         PIC X(6).
   301         16  ERPYAJ-FIN-RESP         PIC X(10).
   302         16  ERPYAJ-ACCOUNT          PIC X(10).
   303         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   304         16  ERPYAJ-TYPE             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page   7
* EL6311.cbl
   305     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   306     12  ELCERT-KEY.
   307         16  ELCERT-COMPANY-CD       PIC X.
   308         16  ELCERT-CARRIER          PIC X.
   309         16  ELCERT-GROUPING         PIC X(6).
   310         16  ELCERT-STATE            PIC XX.
   311         16  ELCERT-ACCOUNT          PIC X(10).
   312         16  ELCERT-CERT-EFF-DT      PIC XX.
   313         16  ELCERT-CERT-NO.
   314             20  ELCERT-CERT-PRIME   PIC X(10).
   315             20  ELCERT-CERT-SFX     PIC X.
   316
   317     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   318     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   319     12  ELCRTO-KEY.
   320         16  ELCRTO-COMPANY-CD       PIC X.
   321         16  ELCRTO-CARRIER          PIC X.
   322         16  ELCRTO-GROUPING         PIC X(6).
   323         16  ELCRTO-STATE            PIC XX.
   324         16  ELCRTO-ACCOUNT          PIC X(10).
   325         16  ELCRTO-CERT-EFF-DT      PIC XX.
   326         16  ELCRTO-CERT-NO.
   327             20  ELCRTO-CERT-PRIME   PIC X(10).
   328             20  ELCRTO-CERT-SFX     PIC X.
   329         16  ELCRTO-RECORD-TYPE      PIC X.
   330         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   331
   332     12  ELCRTT-KEY.
   333         16  ELCRTT-PRIMARY          PIC X(33).
   334         16  ELCRTT-REC-TYPE         PIC X(1).
   335     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   336     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
   337
   338     12  ERPNDB-KEY.
   339         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   340         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   341         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   342         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   343             ERPNDB-BATCH-SEQ-NO     PIC XX.
   344         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   345
   346     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   347     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   348     12  ELLETR-KEY.
   349         16  LETR-COMPANY-CD     PIC X.
   350         16  LETR-LETTER-ID      PIC X(4).
   351         16  LETR-FILLER         PIC X(8).
   352         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   353     12  ERPNDM-KEY.
   354         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   355         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   356         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   357         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   358
   359*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   360     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   361*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   362     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page   8
* EL6311.cbl
   363
   364     12  ERPNDB-ALT-KEY.
   365         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   366         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   367         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   368         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   369         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   370         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   371         16  ERPNDB-CERT-NO.
   372             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   373             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   374         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   375         16  ERPNDB-RECORD-TYPE      PIC X.
   376
   377      12  ERPNDB-CSR-KEY.
   378          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   379          20  ERPNDB-CSR-ID                PIC X(4).
   380          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   381          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   382          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   383
   384     12  ERNOTE-KEY.
   385         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   386         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   387         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   388         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   389         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   390         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   391         16  ERNOTE-CERT-NO.
   392             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   393             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   394
   395     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   396     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   397
   398     12  ERCNOT-KEY.
   399         16  ERCNOT-PART-KEY.
   400             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   401             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   402             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   403             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   404             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   405             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   406             20  ERCNOT-CERT-NO.
   407                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   408                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   409         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   410         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   411
   412     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   413     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   414
   415     12  ERMAIL-KEY.
   416         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   417         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   418         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   419         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   420         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page   9
* EL6311.cbl
   421         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   422         16  ERMAIL-CERT-NO.
   423             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   424             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   425
   426     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   427     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   428
   429     12  ERRQST-KEY.
   430         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   431         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   432
   433     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   434     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   435
   436     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   437
   438     12  ERLOFC-KEY.
   439         16  ERLOFC-COMPANY-CD          PIC  X.
   440         16  ERLOFC-CARRIER             PIC  X.
   441         16  ERLOFC-GROUPING            PIC  X(6).
   442         16  ERLOFC-STATE               PIC  XX.
   443         16  ERLOFC-ACCOUNT             PIC  X(10).
   444         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   445*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   446
   447     12  ERACCT-KEY.
   448         16  ERACCT-COMPANY-CD          PIC  X.
   449         16  ERACCT-CARRIER             PIC  X.
   450         16  ERACCT-GROUPING            PIC  X(6).
   451         16  ERACCT-STATE               PIC  XX.
   452         16  ERACCT-ACCOUNT             PIC  X(10).
   453         16  ERACCT-EXP-DT.
   454             20  ERACCT-DT              PIC  XX.
   455             20  ERACCT-FILL            PIC  X(4).
   456
   457     12  ERENDT-KEY.
   458         16  ENDT-COMPANY-CD       PIC X.
   459         16  ENDT-CARRIER          PIC X.
   460         16  ENDT-GROUPING         PIC X(6).
   461         16  ENDT-STATE            PIC XX.
   462         16  ENDT-ACCOUNT          PIC X(10).
   463         16  ENDT-CERT-EFF-DT      PIC XX.
   464         16  ENDT-CERT-PRIME       PIC X(10).
   465         16  ENDT-CERT-SFX         PIC X.
   466         16  ENDT-RECORD-TYPE      PIC X.
   467         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   468
   469 01  WS-ELMSTR-WORK.
   470     12  ELMSTR-KEY.
   471         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   472         16  MSTR-CERT-NO.
   473             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   474             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   475     12  W-CLAIM-KEY.
   476         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   477         16  W-CL-CERT-NO.
   478             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  10
* EL6311.cbl
   479             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   480      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   481 01  CANCEL-GEN-PASS-AREA.
   482     05  CG-OPTION-CODE          PIC X.
   483         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   484         88  CG-FLAT-CANCEL        VALUE '1'.
   485         88  CG-CANCEL             VALUE '2'.
   486         88  CG-CANCEL-REISSUE     VALUE '3'.
   487     05  CG-ERROR-CODE           PIC 99.
   488         88  CG-SUCCESS            VALUE 00.
   489         88  CG-DATE-ERROR         VALUE 01.
   490         88  CG-CERT-NOT-FOUND     VALUE 02.
   491         88  CG-AMOUNT-ERROR       VALUE 04.
   492         88  CG-OPTION-ERROR       VALUE 05.
   493         88  CG-PREV-CAN           VALUE 06.
   494         88  CG-INVALID-DATA       VALUE 07.
   495         88  CG-NO-ACCT-MSTR       VALUE 08.
   496         88  CG-SFX-A-EXIST        VALUE 09.
   497         88  CG-MISC-ERROR         VALUE 99.
   498     05  CG-COMPANY-ID           PIC XXX.
   499     05  CG-PROC-ID              PIC XXXX.
   500     05  CG-CURRENT-DT           PIC XX.
   501     05  CG-MONTH-END-DT         PIC XX.
   502     05  CG-CERT-KEY.
   503         10  CG-CERT-COMPANY-CD  PIC X.
   504         10  CG-CERT-CARRIER     PIC X.
   505         10  CG-CERT-GROUP       PIC X(6).
   506         10  CG-CERT-STATE       PIC XX.
   507         10  CG-CERT-ACCOUNT     PIC X(10).
   508         10  CG-CERT-EFF-DT      PIC XX.
   509         10  CG-CERT-CERT-NO     PIC X(11).
   510     05  CG-LF-CAN-DATA.
   511         10  CG-LF-CAN-DT        PIC XX.
   512         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   513     05  CG-AH-CAN-DATA.
   514         10  CG-AH-CAN-DT        PIC XX.
   515         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   516     05  CG-CERT-PROFILE-DATA.
   517         10  CG-INS-LNAME        PIC X(15).
   518         10  CG-INS-FNAME        PIC X(10).
   519         10  CG-INS-MID-INIT     PIC X.
   520         10  CG-INS-AGE          PIC 99.
   521         10  CG-JNT-LNAME        PIC X(15).
   522         10  CG-JNT-FNAME        PIC X(10).
   523         10  CG-JNT-MID-INIT     PIC X.
   524         10  CG-JNT-AGE          PIC 99.
   525     05  CG-LF-ISS-DATA.
   526         10  CG-LF-BENCD         PIC XX.
   527         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   528         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   529     05  CG-AH-ISS-DATA.
   530         10  CG-AH-BENCD         PIC XX.
   531         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   532     05  CG-BATCH-NO             PIC X(6).
   533     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   534     05  FILLER                  PIC X(306).
   535******************************************************************
   536*                                                                *
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  11
* EL6311.cbl
   537*            G E N E R A L   W O R K   A R E A                   *
   538*                                                                *
   539******************************************************************
   540
   541 01  WORK-AREA.
   542     12  WS-RESPONSE             PIC S9(8)   COMP.
   543         88  RESP-NORMAL                  VALUE +00.
   544         88  RESP-NOTFND                  VALUE +13.
   545         88  RESP-DUPREC                  VALUE +14.
   546         88  RESP-DUPKEY                  VALUE +15.
   547         88  RESP-NOTOPEN                 VALUE +19.
   548         88  RESP-ENDFILE                 VALUE +20.
   549     12  DEEDIT-FIELD            PIC X(15).
   550     12  FILLER          REDEFINES DEEDIT-FIELD.
   551         16  FILLER              PIC X(4).
   552         16  DEEDIT-FIELD-X11    PIC X(11).
   553     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   554                                 PIC S9(15).
   555     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   556                                 PIC S9(13)V99.
   557     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   558                                 PIC S9(11)V9999.
   559     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   560     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   561     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   562         16  WS-CALC-TERM-WHOLE  PIC S999.
   563         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   564
   565     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   566     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   567         16  WS-HR-MINS          PIC 99V99.
   568         16  FILLER              PIC XX.
   569
   570     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   571     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   572
   573     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   574     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   575
   576     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   577     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   578     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   579     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   580     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   581     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   582     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   583
   584     12  QID.
   585         16  QID-TERM            PIC X(4).
   586         16  FILLER              PIC X(4)    VALUE '607B'.
   587
   588     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   589         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   590
   591     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   592         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   593
   594     12  WS-MODE-CODE            PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  12
* EL6311.cbl
   595         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   596                                         'A'.
   597
   598     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   599
   600     12  WS-NUMERIC-SW           PIC X.
   601        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   602
   603     12  WS-EDIT-CSO-FIELD.
   604         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   605                                 PIC X.
   606
   607     12  WS-SAVE-INPUT-FIELDS.
   608         16  WS-BAGE             PIC 99       VALUE ZERO.
   609*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   610         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   611         16  FILLER REDEFINES WS-BAPR.
   612             20  WS-APR-WHOLE-NUM    PIC 99.
   613             20  WS-APR-DEC          PIC 9999.
   614         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   615         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   616
   617         16  WS-B-COVERAGE OCCURS 2 TIMES.
   618             20  WS-TERM-IN-DAYS-SW  PIC X.
   619                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   620             20  WS-BTERM        PIC 999       COMP-3.
   621             20  WS-BALT-TERM    PIC 999       COMP-3.
   622             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   623             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   624             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   625             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   626             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   627             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   628
   629         16  WS-C-FIELDS COMP-3.
   630             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   631             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   632             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   633
   634         16  WS-D-FIELDS COMP-3.
   635             20  WS-DRISS        PIC S9(5)    VALUE +0.
   636             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   637             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   638             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   639             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   640             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   641
   642     12  WS-SAVE-BIRTH-DATE.
   643         16  FILLER              PIC X(4)   VALUE SPACES.
   644         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   645
   646     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   647     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   648     12  FILLER REDEFINES WS-WORK-BIN-RED.
   649         16  FILLER              PIC X(02).
   650         16  WS-WORK-BIN-DT      PIC X(02).
   651     12  WS-SW-1                 PIC X     VALUE SPACE.
   652     12  WS-SW-2                 PIC X     VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  13
* EL6311.cbl
   653     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   654         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   655     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   656         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   657
   658     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   659     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   660     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   661     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   662     12  WS-CONVERTED-CANCEL-DATES.
   663         16  WS-CONVERTED-CANDT1                  PIC XX.
   664         16  WS-CONVERTED-CANDT2                  PIC XX.
   665
   666     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   667
   668     12  WS-REC-FOUND-SW         PIC X.
   669         88  RECORD-NOT-FOUND    VALUE 'N'.
   670
   671     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   672         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   673         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   674
   675     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   676         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   677         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   678
   679     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   680         88  BROWSE-STARTED      VALUE 'Y'.
   681
   682     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   683         88  FIRST-TIME          VALUE 'Y'.
   684
   685     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   686         88  FIRST-ENTRY         VALUE 'Y'.
   687
   688     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   689         88  REC-BILLED          VALUE 'Y'.
   690
   691     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   692         88  NO-CURSOR-SET       VALUE +0.
   693         88  CURSOR-SET          VALUE +1.
   694
   695     12  WS-ERR-SW               PIC X.
   696         88  STD-ERRORS          VALUE 'S'.
   697         88  TRN-ERRORS          VALUE 'T'.
   698
   699     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   700         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   701
   702     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   703         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   704
   705     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   706         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   707
   708     12  WS-ERR-CODE.
   709         16  FILLER              PIC 99.
   710         16  WS-ERROR-SUB        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  14
* EL6311.cbl
   711
   712     12  WS-DATE-WORK.
   713         16  WS-WORK-MM          PIC XX.
   714         16  WS-WORK-DD          PIC XX.
   715         16  WS-WORK-YY          PIC XX.
   716
   717     12  WS-MM-YY.
   718         16  WS-MM               PIC XX.
   719         16  FILLER              PIC X     VALUE '/'.
   720         16  WS-YY               PIC XX.
   721
   722     12  WS-CERT-EFF-DT          PIC XX.
   723
   724     12  WS-MEMBER-NO            PIC X(12).
   725     12  FILLER  REDEFINES  WS-MEMBER-NO.
   726         16  WS-MEMBER-NO-1-8    PIC 9(8).
   727         16  FILLER              PIC X(4).
   728
   729     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   730
   731     12  WS-ERPNDB-ALT-KEY.
   732         16  WS-PB-COMPANY-CD-A1         PIC X.
   733         16  WS-PB-CARRIER               PIC X.
   734         16  WS-PB-GROUPING              PIC X(6).
   735         16  WS-PB-STATE                 PIC XX.
   736         16  WS-PB-ACCOUNT               PIC X(10).
   737         16  WS-PB-CERT-EFF-DT           PIC XX.
   738         16  WS-PB-CERT-NO.
   739             20  WS-PB-CERT-PRIME        PIC X(10).
   740             20  WS-PB-CERT-SFX          PIC X.
   741         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   742         16  WS-PB-RECORD-TYPE           PIC X.
   743
   744     12  WS-SHOW-SAVE-AREAS.
   745         16  WS-NEW-CERT-NO.
   746             20  WS-NEW-PRIME    PIC X(10).
   747             20  WS-NEW-SUFFIX   PIC X.
   748         16  WS-NEW-CERT-EFF-DT  PIC XX.
   749         16  WS-NEW-RECORD-TYPE  PIC X.
   750         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   751             88   SHOW-RECORD            VALUE 'Y'.
   752
   753     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   754
   755     12  WS-BATCH-NO.
   756         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   757         16  FILLER              PIC X(5) VALUE SPACES.
   758
   759     12  WS-FIRST-NAME.
   760         16  WS-1ST-INIT         PIC X.
   761         16  FILLER              PIC X(9).
   762
   763     12  WS-INITIALS.
   764         16  WS-INITIAL-1        PIC X.
   765         16  WS-INITIAL-2        PIC X.
   766
   767     12  WS-C-HDG.
   768         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  15
* EL6311.cbl
   769         16  FILLER              PIC X(4) VALUE '-REF'.
   770
   771     12  WS-D-PREM-HDG.
   772         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   773         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   774
   775     12  WS-D-REFUND-HDG.
   776         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   777         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   778
   779     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   780
   781     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   782     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   783     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   784     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   785     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   786     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   787     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   788
   789     12  WS-01-CANCEL-ERR        PIC X(25)
   790         VALUE 'CANCEL DATE ERROR'.
   791     12  WS-02-CANCEL-ERR        PIC X(25)
   792         VALUE 'CERT NOT FOUND'.
   793     12  WS-04-CANCEL-ERR        PIC X(25)
   794         VALUE 'CANCEL AMOUNT ERROR'.
   795     12  WS-05-CANCEL-ERR        PIC X(25)
   796         VALUE 'CANCEL OPTION ERROR'.
   797     12  WS-06-CANCEL-ERR        PIC X(25)
   798         VALUE 'PREVIOUSLY CANCELLED'.
   799     12  WS-07-CANCEL-ERR        PIC X(25)
   800         VALUE 'INVALID DATA'.
   801     12  WS-08-CANCEL-ERR        PIC X(25)
   802         VALUE 'NO ACCOUNT MASTER'.
   803     12  WS-09-CANCEL-ERR        PIC X(25)
   804         VALUE 'SUFFIX ALREADY EXISTS'.
   805     12  WS-99-CANCEL-ERR        PIC X(25)
   806         VALUE 'MISC CANCEL ERROR'.
   807
   808     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   809     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   810
   811     12  WS-AGE-FIELDS.
   812         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   813         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   814         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   815         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   816
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  16
* EL6311.cbl
   818
   819******************************************************************
   820*                                                                *
   821*                 B A T C H   T O T A L S                        *
   822*                                                                *
   823******************************************************************
   824
   825     12  WS-BATCH-RECORD.
   826         16  FILLER                       PIC X(10).
   827         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   828         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   829         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   830         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   831         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   832         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   833         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   834         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   835         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   836         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   837         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   838         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   839         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   840         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   841         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   842         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   843         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   844         16  WS-ACCOUNT-NAME              PIC X(30).
   845         16  FILLER                       PIC X.
   846         16  WS-REFERENCE                 PIC X(12).
   847         16  FILLER                       PIC X(197).
   848
   849     12  WS-BATCH-TOTALS.
   850         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   851         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   852         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   853         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   854         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   855         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   856         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   857         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   858         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   859         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   860         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   861         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   862         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   863         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   864         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   865         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   866         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   867         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   868         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   869
   870     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   871
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  17
* EL6311.cbl
   873
   874******************************************************************
   875*                                                                *
   876*                E R R O R   M E S S A G E S                     *
   877*                                                                *
   878******************************************************************
   879
   880 01  ERROR-MESSAGES.
   881     12  ER-0004                 PIC  9(4) VALUE 0004.
   882     12  ER-0008                 PIC  9(4) VALUE 0008.
   883     12  ER-0023                 PIC  9(4) VALUE 0023.
   884     12  ER-0029                 PIC  9(4) VALUE 0029.
   885     12  ER-0033                 PIC  9(4) VALUE 0033.
   886     12  ER-0070                 PIC  9(4) VALUE 0070.
   887     12  ER-0220                 PIC  9(4) VALUE 0220.
   888     12  ER-0248                 PIC  9(4) VALUE 0248.
   889     12  ER-0280                 PIC  9(4) VALUE 0280.
   890     12  ER-0348                 PIC  9(4) VALUE 0348.
   891     12  ER-0582                 PIC  9(4) VALUE 0582.
   892     12  ER-0877                 PIC  9(4) VALUE 0877.
   893     12  ER-1236                 PIC  9(4) VALUE 1236.
   894     12  ER-1570                 PIC  9(4) VALUE 1570.
   895     12  ER-1575                 PIC  9(4) VALUE 1575.
   896     12  ER-1609                 PIC  9(4) VALUE 1609.
   897     12  ER-1819                 PIC  9(4) VALUE 1819.
   898     12  ER-2077                 PIC  9(4) VALUE 2077.
   899     12  ER-2129                 PIC  9(4) VALUE 2129.
   900     12  ER-2188                 PIC  9(4) VALUE 2188.
   901     12  ER-2192                 PIC  9(4) VALUE 2192.
   902     12  ER-2196                 PIC  9(4) VALUE 2196.
   903     12  ER-2197                 PIC  9(4) VALUE 2197.
   904     12  ER-2198                 PIC  9(4) VALUE 2198.
   905     12  ER-2200                 PIC  9(4) VALUE 2200.
   906     12  ER-2212                 PIC  9(4) VALUE 2212.
   907     12  ER-2218                 PIC  9(4) VALUE 2218.
   908     12  ER-2220                 PIC  9(4) VALUE 2220.
   909     12  ER-2222                 PIC  9(4) VALUE 2222.
   910     12  ER-2223                 PIC  9(4) VALUE 2223.
   911     12  ER-2224                 PIC  9(4) VALUE 2224.
   912     12  ER-2225                 PIC  9(4) VALUE 2225.
   913     12  ER-2226                 PIC  9(4) VALUE 2226.
   914     12  ER-2227                 PIC  9(4) VALUE 2227.
   915     12  ER-2228                 PIC  9(4) VALUE 2228.
   916     12  ER-2240                 PIC  9(4) VALUE 2240.
   917     12  ER-2241                 PIC  9(4) VALUE 2241.
   918     12  ER-2242                 PIC  9(4) VALUE 2242.
   919     12  ER-2243                 PIC  9(4) VALUE 2243.
   920     12  ER-2244                 PIC  9(4) VALUE 2244.
   921     12  ER-2245                 PIC  9(4) VALUE 2245.
   922     12  ER-2246                 PIC  9(4) VALUE 2246.
   923     12  ER-2247                 PIC  9(4) VALUE 2247.
   924     12  ER-2251                 PIC  9(4) VALUE 2251.
   925     12  ER-2252                 PIC  9(4) VALUE 2252.
   926     12  ER-2253                 PIC  9(4) VALUE 2253.
   927     12  ER-2254                 PIC  9(4) VALUE 2254.
   928     12  ER-2255                 PIC  9(4) VALUE 2255.
   929     12  ER-2256                 PIC  9(4) VALUE 2256.
   930     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  18
* EL6311.cbl
   931     12  ER-2258                 PIC  9(4) VALUE 2258.
   932     12  ER-2259                 PIC  9(4) VALUE 2259.
   933     12  ER-2260                 PIC  9(4) VALUE 2260.
   934     12  ER-2261                 PIC  9(4) VALUE 2261.
   935     12  ER-2287                 PIC  9(4) VALUE 2287.
   936     12  ER-2336                 PIC  9(4) VALUE 2336.
   937     12  ER-2337                 PIC  9(4) VALUE 2337.
   938     12  ER-2437                 PIC  9(4) VALUE 2437.
   939     12  ER-2471                 PIC  9(4) VALUE 2471.
   940     12  ER-2530                 PIC  9(4) VALUE 2530.
   941     12  ER-2531                 PIC  9(4) VALUE 2531.
   942     12  ER-2532                 PIC  9(4) VALUE 2532.
   943     12  ER-2533                 PIC  9(4) VALUE 2533.
   944     12  ER-2547                 PIC  9(4) VALUE 2547.
   945     12  ER-2591                 PIC  9(4) VALUE 2591.
   946     12  ER-2592                 PIC  9(4) VALUE 2592.
   947     12  ER-2593                 PIC  9(4) VALUE 2593.
   948     12  ER-2600                 PIC  9(4) VALUE 2600.
   949     12  ER-2601                 PIC  9(4) VALUE 2601.
   950     12  ER-2604                 PIC  9(4) VALUE 2604.
   951     12  ER-2605                 PIC  9(4) VALUE 2605.
   952     12  ER-2606                 PIC  9(4) VALUE 2606.
   953     12  ER-2607                 PIC  9(4) VALUE 2607.
   954     12  ER-2622                 PIC  9(4) VALUE 2622.
   955     12  ER-2625                 PIC  9(4) VALUE 2625.
   956     12  ER-2626                 PIC  9(4) VALUE 2626.
   957     12  ER-2627                 PIC  9(4) VALUE 2627.
   958     12  ER-2628                 PIC  9(4) VALUE 2628.
   959     12  ER-2629                 PIC  9(4) VALUE 2629.
   960     12  ER-2630                 PIC  9(4) VALUE 2630.
   961     12  ER-2631                 PIC  9(4) VALUE 2631.
   962     12  ER-2632                 PIC  9(4) VALUE 2632.
   963     12  ER-2633                 PIC  9(4) VALUE 2633.
   964     12  ER-2634                 PIC  9(4) VALUE 2634.
   965     12  ER-2635                 PIC  9(4) VALUE 2635.
   966     12  ER-2636                 PIC  9(4) VALUE 2636.
   967     12  ER-2639                 PIC  9(4) VALUE 2639.
   968     12  ER-2640                 PIC  9(4) VALUE 2640.
   969     12  ER-2647                 PIC  9(4) VALUE 2647.
   970     12  ER-2648                 PIC  9(4) VALUE 2648.
   971     12  ER-2649                 PIC  9(4) VALUE 2649.
   972     12  ER-2650                 PIC  9(4) VALUE 2650.
   973     12  ER-2653                 PIC  9(4) VALUE 2653.
   974     12  ER-2654                 PIC  9(4) VALUE 2654.
   975     12  ER-2655                 PIC  9(4) VALUE 2655.
   976     12  ER-2656                 PIC  9(4) VALUE 2656.
   977     12  ER-2657                 PIC  9(4) VALUE 2657.
   978     12  ER-2660                 PIC  9(4) VALUE 2660.
   979     12  ER-2661                 PIC  9(4) VALUE 2661.
   980     12  ER-2662                 PIC  9(4) VALUE 2662.
   981     12  ER-2663                 PIC  9(4) VALUE 2663.
   982     12  ER-2664                 PIC  9(4) VALUE 2664.
   983     12  ER-2667                 PIC  9(4) VALUE 2667.
   984     12  ER-2668                 PIC  9(4) VALUE 2668.
   985     12  ER-2669                 PIC  9(4) VALUE 2669.
   986     12  ER-2670                 PIC  9(4) VALUE 2670.
   987     12  ER-2671                 PIC  9(4) VALUE 2671.
   988     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  19
* EL6311.cbl
   989     12  ER-2673                 PIC  9(4) VALUE 2673.
   990     12  ER-2677                 PIC  9(4) VALUE 2677.
   991     12  ER-2678                 PIC  9(4) VALUE 2678.
   992     12  ER-2679                 PIC  9(4) VALUE 2679.
   993     12  ER-2680                 PIC  9(4) VALUE 2680.
   994     12  ER-2681                 PIC  9(4) VALUE 2681.
   995     12  ER-2682                 PIC  9(4) VALUE 2682.
   996     12  ER-2683                 PIC  9(4) VALUE 2683.
   997     12  ER-2684                 PIC  9(4) VALUE 2684.
   998     12  ER-2686                 PIC  9(4) VALUE 2686.
   999     12  ER-2689                 PIC  9(4) VALUE 2689.
  1000     12  ER-2690                 PIC  9(4) VALUE 2690.
  1001     12  ER-2693                 PIC  9(4) VALUE 2693.
  1002     12  ER-2695                 PIC  9(4) VALUE 2695.
  1003     12  ER-2701                 PIC  9(4) VALUE 2701.
  1004     12  ER-2720                 PIC  9(4) VALUE 2720.
  1005     12  ER-2709                 PIC  9(4) VALUE 2709.
  1006     12  ER-2704                 PIC  9(4) VALUE 2704.
  1007     12  ER-2725                 PIC  9(4) VALUE 2725.
  1008     12  ER-2726                 PIC  9(4) VALUE 2726.
  1009     12  ER-2728                 PIC  9(4) VALUE 2728.
  1010     12  ER-2729                 PIC  9(4) VALUE 2729.
  1011     12  ER-2731                 PIC  9(4) VALUE 2731.
  1012     12  ER-2732                 PIC  9(4) VALUE 2732.
  1013     12  ER-2733                 PIC  9(4) VALUE 2733.
  1014     12  ER-2735                 PIC  9(4) VALUE 2735.
  1015     12  ER-2738                 PIC  9(4) VALUE 2738.
  1016     12  ER-2742                 PIC  9(4) VALUE 2742.
  1017     12  ER-2743                 PIC  9(4) VALUE 2743.
  1018     12  ER-2744                 PIC  9(4) VALUE 2744.
  1019     12  ER-2747                 PIC  9(4) VALUE 2747.
  1020     12  ER-2749                 PIC  9(4) VALUE 2749.
  1021     12  ER-2753                 PIC  9(4) VALUE 2753.
  1022     12  ER-2755                 PIC  9(4) VALUE 2755.
  1023     12  ER-2757                 PIC  9(4) VALUE 2757.
  1024     12  ER-2771                 PIC  9(4) VALUE 2771.
  1025     12  ER-2774                 PIC  9(4) VALUE 2774.
  1026     12  ER-2775                 PIC  9(4) VALUE 2775.
  1027     12  ER-2776                 PIC  9(4) VALUE 2776.
  1028     12  ER-2777                 PIC  9(4) VALUE 2777.
  1029     12  ER-2794                 PIC  9(4) VALUE 2794.
  1030     12  ER-2799                 PIC  9(4) VALUE 2799.
  1031     12  ER-2900                 PIC  9(4) VALUE 2900.
  1032     12  ER-2902                 PIC  9(4) VALUE 2902.
  1033     12  ER-2945                 PIC  9(4) VALUE 2945.
  1034     12  ER-3000                 PIC  9(4) VALUE 3000.
  1035     12  ER-3006                 PIC  9(4) VALUE 3006.
  1036     12  ER-3054                 PIC  9(4) VALUE 3054.
  1037     12  ER-3224                 PIC  9(4) VALUE 3224.
  1038     12  ER-3504                 PIC  9(4) VALUE 3504.
  1039     12  ER-3513                 PIC  9(4) VALUE 3513.
  1040     12  ER-3831                 PIC  9(4) VALUE 3831.
  1041     12  ER-3834                 PIC  9(4) VALUE 3834.
  1042     12  ER-3835                 PIC  9(4) VALUE 3835.
  1043     12  ER-4005                 PIC  9(4) VALUE 4005.
  1044     12  ER-7144                 PIC  9(4) VALUE 7144.
  1045     12  ER-7401                 PIC  9(4) VALUE 7401.
  1046     12  ER-7402                 PIC  9(4) VALUE 7402.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  20
* EL6311.cbl
  1047     12  ER-7403                 PIC  9(4) VALUE 7403.
  1048     12  ER-7404                 PIC  9(4) VALUE 7404.
  1049     12  ER-7423                 PIC  9(4) VALUE 7423.
  1050     12  ER-7424                 PIC  9(4) VALUE 7424.
  1051     12  ER-7433                 PIC  9(4) VALUE 7433.
  1052     12  ER-7450                 PIC  9(4) VALUE 7450.
  1053     12  ER-7451                 PIC  9(4) VALUE 7451.
  1054     12  ER-7530                 PIC  9(4) VALUE 7530.
  1055     12  ER-7573                 PIC  9(4) VALUE 7573.
  1056     12  ER-7631                 PIC  9(4) VALUE 7631.
  1057     12  ER-7632                 PIC  9(4) VALUE 7632.
  1058     12  ER-7633                 PIC  9(4) VALUE 7633.
  1059     12  ER-7537                 PIC  9(4) VALUE 7537.
  1060     12  ER-7538                 PIC  9(4) VALUE 7538.
  1061     12  ER-7574                 PIC  9(4) VALUE 7574.
  1062     12  ER-7997                 PIC  9(4) VALUE 7997.
  1063     12  ER-7998                 PIC  9(4) VALUE 7998.
  1064     12  ER-8148                 PIC  9(4) VALUE 8148.
  1065     12  ER-9063                 PIC  9(4) VALUE 9063.
  1066     12  ER-9076                 PIC  9(4) VALUE 9076.
  1067     12  ER-9618                 PIC  9(4) VALUE 9618.
  1068     12  ER-9841                 PIC  9(4) VALUE 9841.
  1069
  1070*                                COPY ELCTEXT.
  1071******************************************************************
  1072*                                                                *
  1073*                                                                *
  1074*                            ELCTEXT.                            *
  1075*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1076*                            VMOD=2.008                          *
  1077*                                                                *
  1078*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1079*                                     FORM LETTERS,              *
  1080*                                     CERT FORM DISPLAY.
  1081*                                                                *
  1082*   FILE TYPE = VSAM,KSDS                                        *
  1083*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1084*                                                                *
  1085*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1086*       ALTERNATE INDEX = NONE                                   *
  1087*                                                                *
  1088*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1089*       ALTERNATE INDEX = NONE                                   *
  1090*                                                                *
  1091*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1092*       ALTERNATE INDEX = NONE                                   *
  1093*                                                                *
  1094*   LOG = NO                                                     *
  1095*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1096******************************************************************
  1097 01  TEXT-FILES.
  1098     12  TEXT-FILE-ID                PIC XX.
  1099         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1100         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1101         88  HELP-FILE-TEXT             VALUE 'TH'.
  1102
  1103     12  TX-CONTROL-PRIMARY.
  1104         16  TX-COMPANY-CD           PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  21
* EL6311.cbl
  1105             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1106         16  TX-ACCESS-CD-GENL       PIC X(12).
  1107
  1108         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1109             20  TX-LETTER-NO        PIC X(4).
  1110             20  FILLER              PIC X(8).
  1111
  1112         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1113             20  TX-FORM-NO          PIC X(12).
  1114
  1115         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1116             20  TX-HELP-TYPE        PIC X.
  1117                 88  HELP-FOR-GENERAL   VALUE ' '.
  1118                 88  HELP-BY-SCREEN     VALUE 'S'.
  1119                 88  HELP-BY-ERROR      VALUE 'E'.
  1120             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1121                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1122             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1123                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1124             20  FILLER              PIC X(4).
  1125
  1126         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1127
  1128     12  TX-PROCESS-CONTROL          PIC XX.
  1129         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1130
  1131     12  TX-TEXT-LINE                PIC X(70).
  1132
  1133     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1134         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1135         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1136         88  TX-VALID-FORM-SQUEEZE-VALUE
  1137                                        VALUE 'Y' ' '.
  1138
  1139     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1140         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1141         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1142         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1143         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1144         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1145         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1146         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1147                                              'K' 'N' ' '
  1148                                              'Z'.
  1149
  1150     12  TX-ARCHIVE-SW               PIC X.
  1151         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1152         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1153         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1154
  1155     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1156     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1157
  1158     12  TX-BSR-CODE                 PIC X.
  1159         88  TX-BSR-LETTER              VALUE 'B'.
  1160         88  TX-NON-BSR-LETTER          VALUE ' '.
  1161
  1162     12  FILLER                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  22
* EL6311.cbl
  1163*****************************************************************
  1164*                                COPY ELCCRTO.
  1165******************************************************************
  1166*                                                                *
  1167*                            ELCCRTO.                            *
  1168*                                                                *
  1169*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1170*                                                                *
  1171*   FILE TYPE = VSAM,KSDS                                        *
  1172*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1173*                                                                *
  1174*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1175*                                                                *
  1176*   LOG = YES                                                    *
  1177*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1178******************************************************************
  1179*                   C H A N G E   L O G
  1180*
  1181* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1182*-----------------------------------------------------------------
  1183*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1184* EFFECTIVE    NUMBER
  1185*-----------------------------------------------------------------
  1186* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1187* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1188* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1189* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1190* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1191******************************************************************
  1192 01  ORIGINAL-CERTIFICATE.
  1193     12  OC-RECORD-ID                      PIC XX.
  1194         88  VALID-OC-ID                      VALUE 'OC'.
  1195     12  OC-CONTROL-PRIMARY.
  1196         16  OC-COMPANY-CD                 PIC X.
  1197         16  OC-CARRIER                    PIC X.
  1198         16  OC-GROUPING                   PIC X(6).
  1199         16  OC-STATE                      PIC XX.
  1200         16  OC-ACCOUNT                    PIC X(10).
  1201         16  OC-CERT-EFF-DT                PIC XX.
  1202         16  OC-CERT-NO.
  1203             20  OC-CERT-PRIME             PIC X(10).
  1204             20  OC-CERT-SFX               PIC X.
  1205         16  OC-RECORD-TYPE                PIC X.
  1206         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1207     12  OC-LAST-MAINT-DT                  PIC XX.
  1208     12  OC-LAST-MAINT-BY                  PIC X(4).
  1209     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1210     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1211     12  FILLER                            PIC X(49).
  1212     12  OC-ORIG-REC.
  1213         16  OC-INS-LAST-NAME              PIC X(15).
  1214         16  OC-INS-FIRST-NAME             PIC X(10).
  1215         16  OC-INS-MIDDLE-INIT            PIC X.
  1216         16  OC-INS-AGE                    PIC S999     COMP-3.
  1217         16  OC-JNT-LAST-NAME              PIC X(15).
  1218         16  OC-JNT-FIRST-NAME             PIC X(10).
  1219         16  OC-JNT-MIDDLE-INIT            PIC X.
  1220         16  OC-JNT-AGE                    PIC S999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  23
* EL6311.cbl
  1221         16  OC-LF-BENCD                   PIC XX.
  1222         16  OC-LF-TERM                    PIC S999      COMP-3.
  1223         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1224         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1225         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1226         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1227         16  OC-LF-EXP-DT                  PIC XX.
  1228         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1229         16  OC-LF-CANCEL-DT               PIC XX.
  1230         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1231         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1232         16  OC-AH-BENCD                   PIC XX.
  1233         16  OC-AH-TERM                    PIC S999      COMP-3.
  1234         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1235         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1236         16  OC-AH-EXP-DT                  PIC XX.
  1237         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1238         16  OC-AH-CP                      PIC 99.
  1239         16  OC-AH-CANCEL-DT               PIC XX.
  1240         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1241         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1242         16  OC-CRED-BENE-NAME             PIC X(25).
  1243         16  OC-1ST-PMT-DT                 PIC XX.
  1244         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1245         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1246         16  OC-ISSUE-TRAN-IND             PIC X.
  1247         16  OC-CANCEL-TRAN-IND            PIC X.
  1248         16  FILLER                        PIC X(211).
  1249
  1250     12  FILLER                            PIC X(50).
  1251******************************************************************
  1252*                                COPY ERCACCT.
  1253******************************************************************
  1254*                                                                *
  1255*                                                                *
  1256*                            ERCACCT                             *
  1257*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1258*                            VMOD=2.031                          *
  1259*                                                                *
  1260*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1261*                                                                *
  1262*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1263*   VSAM ACCOUNT MASTER FILES.                                   *
  1264*                                                                *
  1265*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1266*                                                                *
  1267*   FILE TYPE = VSAM,KSDS                                        *
  1268*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1269*                                                                *
  1270*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1271*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1272*                                                                *
  1273*   LOG = NO                                                     *
  1274*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1275*                                                                *
  1276*                                                                *
  1277******************************************************************
  1278*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  24
* EL6311.cbl
  1279*
  1280* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1281*-----------------------------------------------------------------
  1282*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1283* EFFECTIVE    NUMBER
  1284*-----------------------------------------------------------------
  1285* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1286* 092705    2005050300006  PEMA  ADD SPP LEASES
  1287* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1288* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1289* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1290* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1291* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1292******************************************************************
  1293
  1294 01  ACCOUNT-MASTER.
  1295     12  AM-RECORD-ID                      PIC XX.
  1296         88  VALID-AM-ID                      VALUE 'AM'.
  1297
  1298     12  AM-CONTROL-PRIMARY.
  1299         16  AM-COMPANY-CD                 PIC X.
  1300         16  AM-MSTR-CNTRL.
  1301             20  AM-CONTROL-A.
  1302                 24  AM-CARRIER            PIC X.
  1303                 24  AM-GROUPING.
  1304                     28 AM-GROUPING-PREFIX PIC XXX.
  1305                     28 AM-GROUPING-PRIME  PIC XXX.
  1306                 24  AM-STATE              PIC XX.
  1307                 24  AM-ACCOUNT.
  1308                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1309                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1310             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1311                                           PIC X(19).
  1312             20  AM-CNTRL-B.
  1313                 24  AM-EXPIRATION-DT      PIC XX.
  1314                 24  FILLER                PIC X(4).
  1315             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1316                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1317
  1318     12  AM-CONTROL-BY-VAR-GRP.
  1319         16  AM-COMPANY-CD-A1              PIC X.
  1320         16  AM-VG-CARRIER                 PIC X.
  1321         16  AM-VG-GROUPING                PIC X(6).
  1322         16  AM-VG-STATE                   PIC XX.
  1323         16  AM-VG-ACCOUNT                 PIC X(10).
  1324         16  AM-VG-DATE.
  1325             20  AM-VG-EXPIRATION-DT       PIC XX.
  1326             20  FILLER                    PIC X(4).
  1327         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1328                                           PIC 9(11)      COMP-3.
  1329     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1330         16  FILLER                        PIC X(10).
  1331         16  AM-VG-KEY3.
  1332             20  AM-VG3-ACCOUNT            PIC X(10).
  1333             20  AM-VG3-EXP-DT             PIC XX.
  1334         16  FILLER                        PIC X(4).
  1335     12  AM-MAINT-INFORMATION.
  1336         16  AM-LAST-MAINT-DT              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  25
* EL6311.cbl
  1337         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1338         16  AM-LAST-MAINT-USER            PIC X(4).
  1339         16  FILLER                        PIC XX.
  1340
  1341     12  AM-EFFECTIVE-DT                   PIC XX.
  1342     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1343
  1344     12  AM-PREV-DATES  COMP-3.
  1345         16  AM-PREV-EXP-DT                PIC 9(11).
  1346         16  AM-PREV-EFF-DT                PIC 9(11).
  1347
  1348     12  AM-REPORT-CODE-1                  PIC X(10).
  1349     12  AM-REPORT-CODE-2                  PIC X(10).
  1350
  1351     12  AM-CITY-CODE                      PIC X(4).
  1352     12  AM-COUNTY-PARISH                  PIC X(6).
  1353
  1354     12  AM-NAME                           PIC X(30).
  1355     12  AM-PERSON                         PIC X(30).
  1356     12  AM-ADDRS                          PIC X(30).
  1357     12  AM-CITY.
  1358         16  AM-ADDR-CITY                  PIC X(28).
  1359         16  AM-ADDR-STATE                 PIC XX.
  1360     12  AM-ZIP.
  1361         16  AM-ZIP-PRIME.
  1362             20  AM-ZIP-PRI-1ST            PIC X.
  1363                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1364             20  FILLER                    PIC X(4).
  1365         16  AM-ZIP-PLUS4                  PIC X(4).
  1366     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1367         16  AM-CAN-POSTAL-1               PIC XXX.
  1368         16  AM-CAN-POSTAL-2               PIC XXX.
  1369         16  FILLER                        PIC XXX.
  1370     12  AM-TEL-NO.
  1371         16  AM-AREA-CODE                  PIC 999.
  1372         16  AM-TEL-PRE                    PIC 999.
  1373         16  AM-TEL-NBR                    PIC 9(4).
  1374     12  AM-TEL-LOC                        PIC X.
  1375         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1376         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1377
  1378     12  AM-COMM-STRUCTURE.
  1379         16  AM-DEFN-1.
  1380             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1381                 24  AM-AGT.
  1382                     28  AM-AGT-PREFIX     PIC X(4).
  1383                     28  AM-AGT-PRIME      PIC X(6).
  1384                 24  AM-COM-TYP            PIC X.
  1385                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1386                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1387                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1388                 24  AM-RECALC-LV-INDIC    PIC X.
  1389                 24  AM-RETRO-LV-INDIC     PIC X.
  1390                 24  AM-GL-CODES           PIC X.
  1391                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1392                 24  FILLER                PIC X(01).
  1393         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1394             20  AM-COM-TBLS        OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  26
* EL6311.cbl
  1395                 24  FILLER                PIC X(11).
  1396                 24  AM-L-COMA             PIC XXX.
  1397                 24  AM-J-COMA             PIC XXX.
  1398                 24  AM-A-COMA             PIC XXX.
  1399                 24  FILLER                PIC X(6).
  1400
  1401     12  AM-COMM-CHANGE-STATUS             PIC X.
  1402         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1403
  1404     12  AM-CSR-CODE                       PIC X(4).
  1405
  1406     12  AM-BILLING-STATUS                 PIC X.
  1407         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1408         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1409     12  AM-AUTO-REFUND-SW                 PIC X.
  1410         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1411         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1412     12  AM-GPCD                           PIC 99.
  1413     12  AM-IG                             PIC X.
  1414         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1415         88  AM-HAS-GROUP                     VALUE '2'.
  1416     12  AM-STATUS                         PIC X.
  1417         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1418         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1419         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1420         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1421         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1422         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1423     12  AM-REMIT-TO                       PIC 99.
  1424     12  AM-ID-NO                          PIC X(11).
  1425
  1426     12  AM-CAL-TABLE                      PIC XX.
  1427     12  AM-LF-DEVIATION                   PIC XXX.
  1428     12  AM-AH-DEVIATION                   PIC XXX.
  1429     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1430     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1431     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1432     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1433     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1434     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1435
  1436     12  AM-USER-FIELDS.
  1437         16  AM-FLD-1                      PIC XX.
  1438         16  AM-FLD-2                      PIC XX.
  1439         16  AM-FLD-3                      PIC XX.
  1440         16  AM-FLD-4                      PIC XX.
  1441         16  AM-FLD-5                      PIC XX.
  1442
  1443     12  AM-1ST-PROD-DATE.
  1444         16  AM-1ST-PROD-YR                PIC XX.
  1445         16  AM-1ST-PROD-MO                PIC XX.
  1446         16  AM-1ST-PROD-DA                PIC XX.
  1447     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1448     12  AM-CERTS-PURGED-DATE.
  1449         16  AM-PUR-YR                     PIC XX.
  1450         16  AM-PUR-MO                     PIC XX.
  1451         16  AM-PUR-DA                     PIC XX.
  1452     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  27
* EL6311.cbl
  1453     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1454     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1455     12  AM-INACTIVE-DATE.
  1456         16  AM-INA-MO                     PIC 99.
  1457         16  AM-INA-DA                     PIC 99.
  1458         16  AM-INA-YR                     PIC 99.
  1459     12  AM-AR-HI-CERT-DATE                PIC XX.
  1460
  1461     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1462     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1463
  1464     12  AM-OB-PAYMENT-MODE                PIC X.
  1465         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1466         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1467         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1468         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1469
  1470     12  AM-AH-ONLY-INDICATOR              PIC X.
  1471         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1472         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1473
  1474     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1475
  1476     12  AM-OVER-SHORT.
  1477         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1478         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1479
  1480     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1481     12  AM-DCC-CLP-STATE                  PIC XX.
  1482
  1483     12  AM-RECALC-COMM                    PIC X.
  1484     12  AM-RECALC-REIN                    PIC X.
  1485
  1486     12  AM-REI-TABLE                      PIC XXX.
  1487     12  AM-REI-ET-LF                      PIC X.
  1488     12  AM-REI-ET-AH                      PIC X.
  1489     12  AM-REI-PE-LF                      PIC X.
  1490     12  AM-REI-PE-AH                      PIC X.
  1491     12  AM-REI-PRT-ST                     PIC X.
  1492     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1493     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1494     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1495     12  AM-REI-GROUP-A                    PIC X(6).
  1496     12  AM-REI-MORT                       PIC X(4).
  1497     12  AM-REI-PRT-OW                     PIC X.
  1498     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1499     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1500     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1501     12  AM-REI-GROUP-B                    PIC X(6).
  1502
  1503     12  AM-TRUST-TYPE                     PIC X(2).
  1504
  1505     12  AM-EMPLOYER-STMT-USED             PIC X.
  1506     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1507
  1508     12  AM-STD-AH-TYPE                    PIC XX.
  1509     12  AM-EARN-METHODS.
  1510         16  AM-EARN-METHOD-R              PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  28
* EL6311.cbl
  1511             88 AM-REF-RL-R78                 VALUE 'R'.
  1512             88 AM-REF-RL-PR                  VALUE 'P'.
  1513             88 AM-REF-RL-MEAN                VALUE 'M'.
  1514             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1515         16  AM-EARN-METHOD-L              PIC X.
  1516             88 AM-REF-LL-R78                 VALUE 'R'.
  1517             88 AM-REF-LL-PR                  VALUE 'P'.
  1518             88 AM-REF-LL-MEAN                VALUE 'M'.
  1519             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1520         16  AM-EARN-METHOD-A              PIC X.
  1521             88 AM-REF-AH-R78                 VALUE 'R'.
  1522             88 AM-REF-AH-PR                  VALUE 'P'.
  1523             88 AM-REF-AH-MEAN                VALUE 'M'.
  1524             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1525             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1526             88 AM-REF-AH-NET                 VALUE 'N'.
  1527
  1528     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1529     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1530     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1531
  1532     12  AM-RET-Y-N                        PIC X.
  1533     12  AM-RET-P-E                        PIC X.
  1534     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1535     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1536     12  AM-RET-GRP                        PIC X(6).
  1537     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1538         16  AM-POOL-PRIME                 PIC XXX.
  1539         16  AM-POOL-SUB                   PIC XXX.
  1540     12  AM-RETRO-EARNINGS.
  1541         16  AM-RET-EARN-R                 PIC X.
  1542         16  AM-RET-EARN-L                 PIC X.
  1543         16  AM-RET-EARN-A                 PIC X.
  1544     12  AM-RET-ST-TAX-USE                 PIC X.
  1545         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1546         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1547     12  AM-RETRO-BEG-EARNINGS.
  1548         16  AM-RET-BEG-EARN-R             PIC X.
  1549         16  AM-RET-BEG-EARN-L             PIC X.
  1550         16  AM-RET-BEG-EARN-A             PIC X.
  1551     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1552     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1553
  1554     12  AM-USER-SELECT-OPTIONS.
  1555         16  AM-USER-SELECT-1              PIC X(10).
  1556         16  AM-USER-SELECT-2              PIC X(10).
  1557         16  AM-USER-SELECT-3              PIC X(10).
  1558         16  AM-USER-SELECT-4              PIC X(10).
  1559         16  AM-USER-SELECT-5              PIC X(10).
  1560
  1561     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1562
  1563     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1564
  1565     12  AM-RPT045A-SWITCH                 PIC X.
  1566         88  RPT045A-OFF                   VALUE 'N'.
  1567
  1568     12  AM-INSURANCE-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  29
* EL6311.cbl
  1569         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1570         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1571
  1572     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1573         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1574
  1575     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1576         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1577         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1578
  1579     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1580
  1581     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1582     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1583     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1584     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1585     12  AM-DCC-UEF-STATE                  PIC XX.
  1586     12  FILLER                            PIC XXX.
  1587     12  AM-REPORT-CODE-3                  PIC X(10).
  1588*    12  FILLER                            PIC X(22).
  1589
  1590     12  AM-RESERVE-DATE.
  1591         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1592         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1593         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1594
  1595     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1596     12  AM-NOTIFICATION-TYPES.
  1597         16  AM-NOTIF-OF-LETTERS           PIC X.
  1598         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1599         16  AM-NOTIF-OF-REPORTS           PIC X.
  1600         16  AM-NOTIF-OF-STATUS            PIC X.
  1601
  1602     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1603         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1604         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1605         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1606         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1607
  1608     12  AM-BENEFIT-CONTROLS.
  1609         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1610             20  AM-BENEFIT-CODE           PIC XX.
  1611             20  AM-BENEFIT-TYPE           PIC X.
  1612             20  AM-BENEFIT-REVISION       PIC XXX.
  1613             20  AM-BENEFIT-REM-TERM       PIC X.
  1614             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1615             20  FILLER                    PIC XX.
  1616         16  FILLER                        PIC X(80).
  1617
  1618     12  AM-TRANSFER-DATA.
  1619         16  AM-TRANSFERRED-FROM.
  1620             20  AM-TRNFROM-CARRIER        PIC X.
  1621             20  AM-TRNFROM-GROUPING.
  1622                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1623                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1624             20  AM-TRNFROM-STATE          PIC XX.
  1625             20  AM-TRNFROM-ACCOUNT.
  1626                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  30
* EL6311.cbl
  1627                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1628             20  AM-TRNFROM-DTE            PIC XX.
  1629         16  AM-TRANSFERRED-TO.
  1630             20  AM-TRNTO-CARRIER          PIC X.
  1631             20  AM-TRNTO-GROUPING.
  1632                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1633                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1634             20  AM-TRNTO-STATE            PIC XX.
  1635             20  AM-TRNTO-ACCOUNT.
  1636                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1637                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1638             20  AM-TRNTO-DTE              PIC XX.
  1639         16  FILLER                        PIC X(10).
  1640
  1641     12  AM-SAVED-REMIT-TO                 PIC 99.
  1642
  1643     12  AM-COMM-STRUCTURE-SAVED.
  1644         16  AM-DEFN-1-SAVED.
  1645             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1646                 24  AM-AGT-SV             PIC X(10).
  1647                 24  AM-COM-TYP-SV         PIC X.
  1648                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1649                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1650                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1651                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1652                 24  FILLER                PIC X.
  1653                 24  AM-GL-CODES-SV        PIC X.
  1654                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1655                 24  FILLER                PIC X.
  1656         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1657             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1658                 24  FILLER                PIC X(11).
  1659                 24  AM-L-COMA-SV          PIC XXX.
  1660                 24  AM-J-COMA-SV          PIC XXX.
  1661                 24  AM-A-COMA-SV          PIC XXX.
  1662                 24  FILLER                PIC X(6).
  1663
  1664     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1665         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1666            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1667            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1668            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1669
  1670     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1671     12  FILLER                            PIC X(120).
  1672
  1673     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1674         16  AM-CONTROL-NAME               PIC X(30).
  1675         16  AM-EXECUTIVE-ONE.
  1676             20  AM-EXEC1-NAME             PIC X(15).
  1677             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1678                                                          COMP-3.
  1679             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1680                                                          COMP-3.
  1681         16  AM-EXECUTIVE-TWO.
  1682             20  AM-EXEC2-NAME             PIC X(15).
  1683             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1684                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  31
* EL6311.cbl
  1685             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1686                                                          COMP-3.
  1687
  1688     12  AM-RETRO-ADDITIONAL-DATA.
  1689         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1690         16  AM-RETRO-PREM-P-E             PIC X.
  1691         16  AM-RETRO-CLMS-P-I             PIC X.
  1692         16  AM-RETRO-RET-BRACKET-LF.
  1693             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1694                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1695                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1696             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1697                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1698                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1699             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1700                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1701                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1702         16  AM-RETRO-RET-BRACKET-AH.
  1703             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1704                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1705                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1706                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1707             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1708                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1709                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1710             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1711                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1712                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1713
  1714     12  AM-COMMENTS.
  1715         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1716
  1717     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1718         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1719         16  AM-FLI-BILLING-CODE           PIC X.
  1720         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1721         16  AM-FLI-UNITED-IDENT           PIC X.
  1722         16  AM-FLI-INTEREST-LOST-DATA.
  1723             20  AM-FLI-BANK-NO            PIC X(5).
  1724             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1725             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1726             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1727         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1728             20  AM-FLI-AGT                PIC X(9).
  1729             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1730             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1731         16  FILLER                        PIC X(102).
  1732
  1733     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1734         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1735             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1736             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1737             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1738             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1739             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1740         16  FILLER                          PIC X(10).
  1741******************************************************************
  1742*                                COPY ELCVADS.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  32
* EL6311.cbl
  1743******************************************************************
  1744*                                                                *
  1745*                                                                *
  1746*                            ELCVADS.                            *
  1747*                                                                *
  1748*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1749*   ELVADS                  LENGTH = 350                         *
  1750******************************************************************
  1751******************************************************************
  1752*                   C H A N G E   L O G
  1753*
  1754* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1755*-----------------------------------------------------------------
  1756*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1757* EFFECTIVE    NUMBER
  1758*-----------------------------------------------------------------
  1759* 100111    2011022800001  AJRA  NAPERSOFT
  1760******************************************************************
  1761
  1762 01  VIRGINIA-DISCLOSURE.
  1763     12  VD-COMPANY-CD              PIC X.
  1764     12  VD-CARRIER                 PIC X.
  1765     12  VD-GROUPING.
  1766         20  VD-GROUPING-PREFIX     PIC XXX.
  1767         20  VD-GROUPING-PRIME      PIC XXX.
  1768     12  VD-STATE                   PIC XX.
  1769     12  VD-ACCOUNT.
  1770         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1771         20  VD-ACCOUNT-PRIME       PIC X(6).
  1772     12  VD-CERT-EFF-DT             PIC XX.
  1773     12  VD-CERT-NO.
  1774         20  VD-CERT-PRIME          PIC X(10).
  1775         20  VD-CERT-SFX            PIC X.
  1776     12  VD-ENTRY-BATCH             PIC X(6).
  1777     12  VD-CSR-ID                  PIC X(4).
  1778     12  VD-NAME.
  1779         20  VD-INSURED-LAST-NAME   PIC X(15).
  1780         20  VD-INSURED-FIRST-NAME.
  1781             24  VD-INSURED-1ST-INIT PIC X.
  1782             24  FILLER             PIC X(9).
  1783         20  VD-INSURED-MIDDLE-INIT PIC X.
  1784     12  VD-JOINT-INSURED.
  1785         20 VD-JOINT-LAST-NAME      PIC X(15).
  1786         20 VD-JOINT-FIRST-NAME.
  1787            24  VD-JOINT-FIRST-INIT PIC X.
  1788            24  FILLER              PIC X(9).
  1789         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1790     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1791     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1792     12  VD-INSURED-CITY-STATE.
  1793         20  VD-INSURED-CITY        PIC X(28).
  1794         20  VD-INSURED-STATE       PIC XX.
  1795     12  VD-INSURED-ZIP-CODE.
  1796         20  VD-INSURED-ZIP-PRIME.
  1797             24  VD-INSURED-ZIP-1   PIC X.
  1798                 88  VD-CANADIAN-POST-CODE
  1799                                       VALUE 'A' THRU 'Z'.
  1800             24  FILLER             PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  33
* EL6311.cbl
  1801         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1802     12  VD-BENEFICIARY-NAME        PIC X(30).
  1803     12  VD-ACCOUNT-NAME            PIC X(30).
  1804     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1805     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1806     12  VD-1ST-PMT-DT              PIC XX.
  1807     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1808         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1809         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1810                                             '90' THRU '99'.
  1811     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1812                                    PIC XX.
  1813     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1814     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1815     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1816     12  VD-LF-TERM                 PIC S999   COMP-3.
  1817     12  VD-AH-BENEFIT-CD           PIC XX.
  1818         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1819         88  VD-INVALID-AH             VALUE '  ' '00'
  1820                                             '90' THRU '99'.
  1821     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1822     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1823     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1824     12  VD-AH-TERM                 PIC S999   COMP-3.
  1825     12  VD-LETTER-ID               PIC X(4).
  1826     12  VD-PROC-ID                 PIC X(4).
  1827     12  VD-COMP-ID                 PIC X(3).
  1828     12  VD-CURRENT-DATE            PIC XX.
  1829     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1830     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1831     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  34
* EL6311.cbl
  1833*    COPY ELCDATE.
  1834******************************************************************
  1835*                                                                *
  1836*                                                                *
  1837*                            ELCDATE.                            *
  1838*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1839*                            VMOD=2.003
  1840*                                                                *
  1841*                                                                *
  1842*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1843*                 LENGTH = 200                                   *
  1844******************************************************************
  1845
  1846 01  DATE-CONVERSION-DATA.
  1847     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1848     12  DC-OPTION-CODE                PIC X.
  1849         88  BIN-TO-GREG                VALUE ' '.
  1850         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1851         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1852         88  YMD-GREG-TO-BIN            VALUE '3'.
  1853         88  MDY-GREG-TO-BIN            VALUE '4'.
  1854         88  JULIAN-TO-BIN              VALUE '5'.
  1855         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1856         88  FIND-CENTURY               VALUE '7'.
  1857         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1858         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1859         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1860         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1861         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1862         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1863         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1864         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1865         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1866         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1867         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1868         88  BIN-3-TO-GREG              VALUE 'I'.
  1869         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1870         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1871         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1872         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1873         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1874         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1875         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1876         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1877         88  THREE-CHARACTER-BIN
  1878                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1879         88  GREGORIAN-TO-BIN
  1880                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1881         88  BIN-TO-GREGORIAN
  1882                  VALUES ' ' '1' 'I' '8' 'G'.
  1883         88  JULIAN-TO-BINARY
  1884                  VALUES '5' 'C' 'E' 'F'.
  1885     12  DC-ERROR-CODE                 PIC X.
  1886         88  NO-CONVERSION-ERROR        VALUE ' '.
  1887         88  DATE-CONVERSION-ERROR
  1888                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1889         88  DATE-IS-ZERO               VALUE '1'.
  1890         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  35
* EL6311.cbl
  1891         88  DATE-IS-INVALID            VALUE '3'.
  1892         88  DATE1-GREATER-DATE2        VALUE '4'.
  1893         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1894         88  DATE-INVALID-OPTION        VALUE '9'.
  1895         88  INVALID-CENTURY            VALUE 'A'.
  1896         88  ONLY-CENTURY               VALUE 'B'.
  1897         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1898         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1899     12  DC-END-OF-MONTH               PIC X.
  1900         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1901     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1902         88  USE-NORMAL-PROCESS         VALUE ' '.
  1903         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1904         88  ADJUST-UP-100-YRS          VALUE '2'.
  1905     12  FILLER                        PIC X.
  1906     12  DC-CONVERSION-DATES.
  1907         16  DC-BIN-DATE-1             PIC XX.
  1908         16  DC-BIN-DATE-2             PIC XX.
  1909         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1910         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1911                       DC-GREG-DATE-1-EDIT.
  1912             20  DC-EDIT1-MONTH        PIC 99.
  1913             20  SLASH1-1              PIC X.
  1914             20  DC-EDIT1-DAY          PIC 99.
  1915             20  SLASH1-2              PIC X.
  1916             20  DC-EDIT1-YEAR         PIC 99.
  1917         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1918         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1919                     DC-GREG-DATE-2-EDIT.
  1920             20  DC-EDIT2-MONTH        PIC 99.
  1921             20  SLASH2-1              PIC X.
  1922             20  DC-EDIT2-DAY          PIC 99.
  1923             20  SLASH2-2              PIC X.
  1924             20  DC-EDIT2-YEAR         PIC 99.
  1925         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1926         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1927                     DC-GREG-DATE-1-YMD.
  1928             20  DC-YMD-YEAR           PIC 99.
  1929             20  DC-YMD-MONTH          PIC 99.
  1930             20  DC-YMD-DAY            PIC 99.
  1931         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1932         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1933                      DC-GREG-DATE-1-MDY.
  1934             20  DC-MDY-MONTH          PIC 99.
  1935             20  DC-MDY-DAY            PIC 99.
  1936             20  DC-MDY-YEAR           PIC 99.
  1937         16  DC-GREG-DATE-1-ALPHA.
  1938             20  DC-ALPHA-MONTH        PIC X(10).
  1939             20  DC-ALPHA-DAY          PIC 99.
  1940             20  FILLER                PIC XX.
  1941             20  DC-ALPHA-CENTURY.
  1942                 24 DC-ALPHA-CEN-N     PIC 99.
  1943             20  DC-ALPHA-YEAR         PIC 99.
  1944         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1945         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1946         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1947         16  DC-JULIAN-DATE            PIC 9(05).
  1948         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  36
* EL6311.cbl
  1949                                       PIC 9(05).
  1950         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1951             20  DC-JULIAN-YEAR        PIC 99.
  1952             20  DC-JULIAN-DAYS        PIC 999.
  1953         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1954         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1955         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1956     12  DATE-CONVERSION-VARIBLES.
  1957         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1958         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1959             20  FILLER                PIC 9(3).
  1960             20  HOLD-CEN-1-CCYY.
  1961                 24  HOLD-CEN-1-CC     PIC 99.
  1962                 24  HOLD-CEN-1-YY     PIC 99.
  1963             20  HOLD-CEN-1-MO         PIC 99.
  1964             20  HOLD-CEN-1-DA         PIC 99.
  1965         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1966             20  HOLD-CEN-1-R-MO       PIC 99.
  1967             20  HOLD-CEN-1-R-DA       PIC 99.
  1968             20  HOLD-CEN-1-R-CCYY.
  1969                 24  HOLD-CEN-1-R-CC   PIC 99.
  1970                 24  HOLD-CEN-1-R-YY   PIC 99.
  1971             20  FILLER                PIC 9(3).
  1972         16  HOLD-CENTURY-1-X.
  1973             20  FILLER                PIC X(3)  VALUE SPACES.
  1974             20  HOLD-CEN-1-X-CCYY.
  1975                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1976                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1977             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1978             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1979         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1980             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1981             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1982             20  HOLD-CEN-1-R-X-CCYY.
  1983                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1984                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1985             20  FILLER                PIC XXX.
  1986         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1987         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1988         16  DC-JULIAN-DATE-1          PIC 9(07).
  1989         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1990             20  DC-JULIAN-1-CCYY.
  1991                 24  DC-JULIAN-1-CC    PIC 99.
  1992                 24  DC-JULIAN-1-YR    PIC 99.
  1993             20  DC-JULIAN-DA-1        PIC 999.
  1994         16  DC-JULIAN-DATE-2          PIC 9(07).
  1995         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1996             20  DC-JULIAN-2-CCYY.
  1997                 24  DC-JULIAN-2-CC    PIC 99.
  1998                 24  DC-JULIAN-2-YR    PIC 99.
  1999             20  DC-JULIAN-DA-2        PIC 999.
  2000         16  DC-GREG-DATE-A-EDIT.
  2001             20  DC-EDITA-MONTH        PIC 99.
  2002             20  SLASHA-1              PIC X VALUE '/'.
  2003             20  DC-EDITA-DAY          PIC 99.
  2004             20  SLASHA-2              PIC X VALUE '/'.
  2005             20  DC-EDITA-CCYY.
  2006                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  37
* EL6311.cbl
  2007                 24  DC-EDITA-YEAR     PIC 99.
  2008         16  DC-GREG-DATE-B-EDIT.
  2009             20  DC-EDITB-MONTH        PIC 99.
  2010             20  SLASHB-1              PIC X VALUE '/'.
  2011             20  DC-EDITB-DAY          PIC 99.
  2012             20  SLASHB-2              PIC X VALUE '/'.
  2013             20  DC-EDITB-CCYY.
  2014                 24  DC-EDITB-CENT     PIC 99.
  2015                 24  DC-EDITB-YEAR     PIC 99.
  2016         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2017         16  DC-GREG-DATE-CYMD-R REDEFINES
  2018                              DC-GREG-DATE-CYMD.
  2019             20  DC-CYMD-CEN           PIC 99.
  2020             20  DC-CYMD-YEAR          PIC 99.
  2021             20  DC-CYMD-MONTH         PIC 99.
  2022             20  DC-CYMD-DAY           PIC 99.
  2023         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2024         16  DC-GREG-DATE-MDCY-R REDEFINES
  2025                              DC-GREG-DATE-MDCY.
  2026             20  DC-MDCY-MONTH         PIC 99.
  2027             20  DC-MDCY-DAY           PIC 99.
  2028             20  DC-MDCY-CEN           PIC 99.
  2029             20  DC-MDCY-YEAR          PIC 99.
  2030    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2031        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2032    12  DC-EL310-DATE                  PIC X(21).
  2033    12  FILLER                         PIC X(28).
  2034
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  38
* EL6311.cbl
  2036*    COPY ELCLOGOF.
  2037******************************************************************
  2038*                                                                *
  2039*                                                                *
  2040*                            ELCLOGOF.                           *
  2041*                            VMOD=2.001                          *
  2042*                                                                *
  2043*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2044*                                                                *
  2045******************************************************************
  2046 01  CLASIC-LOGOFF.
  2047     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2048     12  LOGOFF-TEXT.
  2049         16  FILLER          PIC X(5)    VALUE SPACES.
  2050         16  LOGOFF-MSG.
  2051             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2052             20  FILLER      PIC X       VALUE SPACES.
  2053             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2054         16  FILLER          PIC X(80)
  2055           VALUE '* YOU ARE NOW LOGGED OFF'.
  2056         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2057         16  FILLER          PIC X       VALUE QUOTE.
  2058         16  LOGOFF-SYS-MSG  PIC X(17)
  2059           VALUE 'S CLAS-IC SYSTEM '.
  2060     12  TEXT-MESSAGES.
  2061         16  UNACCESS-MSG    PIC X(29)
  2062             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2063         16  PGMIDERR-MSG    PIC X(17)
  2064             VALUE 'PROGRAM NOT FOUND'.
  2065
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  39
* EL6311.cbl
  2067*    COPY ELCATTR.
  2068******************************************************************
  2069*                                                                *
  2070*                            ELCATTR.                            *
  2071*                            VMOD=2.001                          *
  2072*                                                                *
  2073*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2074*                                                                *
  2075*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2076*                                                                *
  2077*                   POS 1   P=PROTECTED                          *
  2078*                           U=UNPROTECTED                        *
  2079*                           S=ASKIP                              *
  2080*                   POS 2   A=ALPHA/NUMERIC                      *
  2081*                           N=NUMERIC                            *
  2082*                   POS 3   N=NORMAL                             *
  2083*                           B=BRIGHT                             *
  2084*                           D=DARK                               *
  2085*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2086*                           OF=MODIFIED DATA TAG OFF             *
  2087*                                                                *
  2088*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2089******************************************************************
  2090 01  ATTRIBUTE-LIST.
  2091     12  AL-PABOF            PIC X       VALUE 'Y'.
  2092     12  AL-PABON            PIC X       VALUE 'Z'.
  2093     12  AL-PADOF            PIC X       VALUE '%'.
  2094     12  AL-PADON            PIC X       VALUE '_'.
  2095     12  AL-PANOF            PIC X       VALUE '-'.
  2096     12  AL-PANON            PIC X       VALUE '/'.
  2097     12  AL-SABOF            PIC X       VALUE '8'.
  2098     12  AL-SABON            PIC X       VALUE '9'.
  2099     12  AL-SADOF            PIC X       VALUE '@'.
  2100     12  AL-SADON            PIC X       VALUE QUOTE.
  2101     12  AL-SANOF            PIC X       VALUE '0'.
  2102     12  AL-SANON            PIC X       VALUE '1'.
  2103     12  AL-UABOF            PIC X       VALUE 'H'.
  2104     12  AL-UABON            PIC X       VALUE 'I'.
  2105     12  AL-UADOF            PIC X       VALUE '<'.
  2106     12  AL-UADON            PIC X       VALUE '('.
  2107     12  AL-UANOF            PIC X       VALUE ' '.
  2108     12  AL-UANON            PIC X       VALUE 'A'.
  2109     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2110     12  AL-UNBON            PIC X       VALUE 'R'.
  2111     12  AL-UNDOF            PIC X       VALUE '*'.
  2112     12  AL-UNDON            PIC X       VALUE ')'.
  2113     12  AL-UNNOF            PIC X       VALUE '&'.
  2114     12  AL-UNNON            PIC X       VALUE 'J'.
  2115
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  40
* EL6311.cbl
  2117*    COPY ELCEMIB.
  2118******************************************************************
  2119*                                                                *
  2120*                                                                *
  2121*                            ELCEMIB.                            *
  2122*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2123*                            VMOD=2.005                          *
  2124*                                                                *
  2125*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2126*                                                                *
  2127******************************************************************
  2128 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2129     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2130     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2131     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2132     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2133     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2134     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2135     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2136     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2137     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2138         88  EMI-NO-ERRORS                    VALUE '1'.
  2139         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2140         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2141     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2142         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2143     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2144         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2145         88  EMI-AREA1-FULL                   VALUE '2'.
  2146     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2147         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2148         88  EMI-AREA2-FULL                   VALUE '2'.
  2149     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2150         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2151         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2152         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2153         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2154         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2155     12  EMI-ERROR-LINES.
  2156         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2157         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2158         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2159         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2160             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2161                 24  EMI-ERR-NUM         PIC X(4).
  2162                 24  EMI-FILLER          PIC X.
  2163                 24  EMI-SEV             PIC X.
  2164                 24  FILLER              PIC X.
  2165             20  FILLER                  PIC X(02).
  2166     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2167         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2168             20  EMI-ERROR-NUMBER    PIC X(4).
  2169             20  EMI-FILL            PIC X.
  2170             20  EMI-SEVERITY        PIC X.
  2171             20  FILLER              PIC X.
  2172             20  EMI-ERROR-TEXT.
  2173                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2174                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  41
* EL6311.cbl
  2175     12  EMI-SEVERITY-SAVE           PIC X.
  2176         88  EMI-NOTE                    VALUE 'N'.
  2177         88  EMI-WARNING                 VALUE 'W'.
  2178         88  EMI-FORCABLE                VALUE 'F'.
  2179         88  EMI-FATAL                   VALUE 'X'.
  2180     12  EMI-MESSAGE-FLAG            PIC X.
  2181         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2182         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2183     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2184     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2185         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2186         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2187         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2188     12  emi-claim-no                pic x(7).
  2189     12  emi-claim-type              pic x(6).
  2190     12  FILLER                      PIC X(124)  VALUE SPACES.
  2191     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2192     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2193     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2194     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2195
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  42
* EL6311.cbl
  2197*    COPY ELCINTF.
  2198******************************************************************
  2199*                                                                *
  2200*                                                                *
  2201*                            ELCINTF.                            *
  2202*                            VMOD=2.017                          *
  2203*                                                                *
  2204*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2205*                                                                *
  2206*       LENGTH = 1024                                            *
  2207*                                                                *
  2208******************************************************************
  2209*                   C H A N G E   L O G
  2210*
  2211* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2212*-----------------------------------------------------------------
  2213*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2214* EFFECTIVE    NUMBER
  2215*-----------------------------------------------------------------
  2216* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2217******************************************************************
  2218 01  PROGRAM-INTERFACE-BLOCK.
  2219     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2220     12  PI-CALLING-PROGRAM              PIC X(8).
  2221     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2222     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2223     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2224     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2225     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2226     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2227     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2228     12  PI-COMPANY-ID                   PIC XXX.
  2229     12  PI-COMPANY-CD                   PIC X.
  2230
  2231     12  PI-COMPANY-PASSWORD             PIC X(8).
  2232
  2233     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2234
  2235     12  PI-CONTROL-IN-PROGRESS.
  2236         16  PI-CARRIER                  PIC X.
  2237         16  PI-GROUPING                 PIC X(6).
  2238         16  PI-STATE                    PIC XX.
  2239         16  PI-ACCOUNT                  PIC X(10).
  2240         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2241                                         PIC X(10).
  2242         16  PI-CLAIM-CERT-GRP.
  2243             20  PI-CLAIM-NO             PIC X(7).
  2244             20  PI-CERT-NO.
  2245                 25  PI-CERT-PRIME       PIC X(10).
  2246                 25  PI-CERT-SFX         PIC X.
  2247             20  PI-CERT-EFF-DT          PIC XX.
  2248         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2249             20  PI-PLAN-CODE            PIC X(2).
  2250             20  PI-REVISION-NUMBER      PIC X(3).
  2251             20  PI-PLAN-EFF-DT          PIC X(2).
  2252             20  PI-PLAN-EXP-DT          PIC X(2).
  2253             20  FILLER                  PIC X(11).
  2254         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  43
* EL6311.cbl
  2255             20  PI-OE-REFERENCE-1.
  2256                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2257                 25  PI-OE-REF-1-SUFF    PIC XX.
  2258
  2259     12  PI-SESSION-IN-PROGRESS          PIC X.
  2260         88  CLAIM-SESSION                   VALUE '1'.
  2261         88  CREDIT-SESSION                  VALUE '2'.
  2262         88  WARRANTY-SESSION                VALUE '3'.
  2263         88  MORTGAGE-SESSION                VALUE '4'.
  2264         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2265
  2266
  2267*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2268
  2269     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2270     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2271
  2272     12  PI-CREDIT-USER                  PIC X.
  2273         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2274         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2275
  2276     12  PI-CLAIM-USER                   PIC X.
  2277         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2278         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2279
  2280     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2281         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2282         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2283         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2284         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2285         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2286
  2287     12  PI-PROCESSOR-ID                 PIC X(4).
  2288
  2289     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2290
  2291     12  PI-MEMBER-CAPTION               PIC X(10).
  2292
  2293     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2294         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2295
  2296     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2297     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2298     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2299     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2300
  2301     12  PI-AH-OVERRIDE-L1               PIC X.
  2302     12  PI-AH-OVERRIDE-L2               PIC XX.
  2303     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2304     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2305
  2306     12  PI-NEW-SYSTEM                   PIC X(2).
  2307
  2308     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2309     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2310         88  PI-USES-PAID-TO                 VALUE '1'.
  2311     12  PI-CRDTCRD-SYSTEM.
  2312         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  44
* EL6311.cbl
  2313             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2314             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2315         16  PI-CC-MONTH-END-DT          PIC XX.
  2316     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2317
  2318     12  PI-OE-REFERENCE-2.
  2319         16  PI-OE-REF-2-PRIME           PIC X(10).
  2320         16  PI-OE-REF-2-SUFF            PIC X.
  2321
  2322     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2323
  2324     12  PI-LANGUAGE-TYPE                PIC X.
  2325             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2326             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2327             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2328
  2329     12  PI-POLICY-LINKAGE-IND           PIC X.
  2330         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2331         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2332                                                   LOW-VALUES.
  2333
  2334     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2335     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2336         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2337         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2338
  2339     12  PI-PROCESSOR-CSR-IND            PIC X.
  2340         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2341         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2342
  2343     12  FILLER                          PIC X(3).
  2344
  2345     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2346
  2347     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2348         PI-SYSTEM-LEVEL.
  2349
  2350         16  PI-ENTRY-CODES.
  2351             20  PI-ENTRY-CD-1           PIC X.
  2352             20  PI-ENTRY-CD-2           PIC X.
  2353
  2354         16  PI-RETURN-CODES.
  2355             20  PI-RETURN-CD-1          PIC X.
  2356             20  PI-RETURN-CD-2          PIC X.
  2357
  2358         16  PI-UPDATE-STATUS-SAVE.
  2359             20  PI-UPDATE-BY            PIC X(4).
  2360             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2361
  2362         16  PI-LOWER-CASE-LETTERS       PIC X.
  2363             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2364
  2365*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2366*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2367*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2368
  2369         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2370             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  45
* EL6311.cbl
  2371             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2372             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2373             88  ACCNT-CNTL                  VALUE '3'.
  2374             88  CARR-ACCNT-CNTL             VALUE '4'.
  2375
  2376         16  PI-PROCESSOR-CAP-LIST.
  2377             20  PI-SYSTEM-CONTROLS.
  2378                24 PI-SYSTEM-DISPLAY     PIC X.
  2379                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2380                24 PI-SYSTEM-MODIFY      PIC X.
  2381                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2382             20  FILLER                  PIC XX.
  2383             20  PI-DISPLAY-CAP          PIC X.
  2384                 88  DISPLAY-CAP             VALUE 'Y'.
  2385             20  PI-MODIFY-CAP           PIC X.
  2386                 88  MODIFY-CAP              VALUE 'Y'.
  2387             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2388                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2389             20  PI-FORCE-CAP            PIC X.
  2390                 88  FORCE-CAP               VALUE 'Y'.
  2391
  2392         16  PI-PROGRAM-CONTROLS.
  2393             20  PI-PGM-PRINT-OPT        PIC X.
  2394             20  PI-PGM-FORMAT-OPT       PIC X.
  2395             20  PI-PGM-PROCESS-OPT      PIC X.
  2396             20  PI-PGM-TOTALS-OPT       PIC X.
  2397
  2398         16  PI-HELP-INTERFACE.
  2399             20  PI-LAST-ERROR-NO        PIC X(4).
  2400             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2401
  2402         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2403             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2404
  2405         16  PI-CR-CONTROL-IN-PROGRESS.
  2406             20  PI-CR-CARRIER           PIC X.
  2407             20  PI-CR-GROUPING          PIC X(6).
  2408             20  PI-CR-STATE             PIC XX.
  2409             20  PI-CR-ACCOUNT           PIC X(10).
  2410             20  PI-CR-FIN-RESP          PIC X(10).
  2411             20  PI-CR-TYPE              PIC X.
  2412
  2413         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2414
  2415         16  PI-CR-MONTH-END-DT          PIC XX.
  2416
  2417         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2418             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2419             88  PI-ZERO-CARRIER             VALUE '1'.
  2420             88  PI-ZERO-GROUPING            VALUE '2'.
  2421             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2422
  2423         16  PI-CARRIER-SECURITY         PIC X.
  2424             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2425
  2426         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2427             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2428             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  46
* EL6311.cbl
  2429
  2430         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2431             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2432                                         INDEXED BY PI-ACCESS-NDX
  2433                                         PIC X.
  2434
  2435         16  PI-GA-BILLING-CONTROL       PIC X.
  2436             88  PI-GA-BILLING               VALUE '1'.
  2437
  2438         16  PI-MAIL-PROCESSING          PIC X.
  2439             88  PI-MAIL-YES                 VALUE 'Y'.
  2440
  2441         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2442
  2443         16  PI-AR-SYSTEM.
  2444             20  PI-AR-PROCESSING-CNTL   PIC X.
  2445                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2446             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2447             20  PI-AR-MONTH-END-DT      PIC XX.
  2448
  2449         16  PI-MP-SYSTEM.
  2450             20  PI-MORTGAGE-USER            PIC X.
  2451                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2452                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2453             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2454                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2455                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2456                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2457                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2458                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2459             20  PI-MP-MONTH-END-DT          PIC XX.
  2460             20  PI-MP-REFERENCE-NO.
  2461                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2462                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2463
  2464         16  PI-LABEL-CONTROL            PIC X(01).
  2465             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2466             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2467
  2468         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2469             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2470
  2471         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2472             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2473             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2474
  2475         16  FILLER                      PIC X(14).
  2476
  2477     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2478******************************************************************
  2479
  2480     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2481*    COPY ELC631PI.
  2482******************************************************************
  2483*                                                                *
  2484*                                                                *
  2485*                            ELC631PI                            *
  2486*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  47
* EL6311.cbl
  2487*                                                                *
  2488*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2489*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2490*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2491*                                                                *
  2492*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2493*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2494*    BETWEEN PROGRAMS.                                           *
  2495*                                                                *
  2496*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2497*                                                                *
  2498*               EL631 - EL6311 - EL6312 - EL6313                 *
  2499*                                                                *
  2500******************************************************************
  2501
  2502         16  PI-631-DATA.
  2503             20  PI-ERPNDB-KEY.
  2504                 24  PI-PB-COMPANY-CD     PIC X.
  2505                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2506                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2507                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2508
  2509             20  PI-ERPNDB-ALT-KEY.
  2510                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2511                 24  PI-PB-CARRIER        PIC X.
  2512                 24  PI-PB-GROUPING       PIC X(6).
  2513                 24  PI-PB-STATE          PIC XX.
  2514                 24  PI-PB-ACCOUNT        PIC X(10).
  2515                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2516                 24  PI-PB-CERT-NO.
  2517                     28  PI-PB-CERT-PRIME PIC X(10).
  2518                     28  PI-PB-CERT-SFX   PIC X.
  2519                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2520                 24  PI-PB-RECORD-TYPE    PIC X.
  2521
  2522             20  PI-ERPNDB-CSR-KEY.
  2523                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2524                 24  PI-PB-CSR-ID             PIC X(4).
  2525                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2526                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2527                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2528
  2529             20  PI-BROWSE-TYPE               PIC X.
  2530                 88  PI-FILE-BROWSE             VALUE ' '.
  2531                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2532                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2533                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2534                 88  PI-CSR-BROWSE              VALUE '4'.
  2535
  2536             20  PI-MAINT-FUNCTION            PIC X.
  2537                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2538                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2539                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2540                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2541                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2542                 88  PI-PF5-FUNCTION            VALUE '5'.
  2543                 88  PI-PF6-FUNCTION            VALUE '6'.
  2544
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  48
* EL6311.cbl
  2545             20  PI-FILE-SWITCHES.
  2546                 24  PI-ALL-ISSUES-SW         PIC X.
  2547                     88  ALL-ISSUES             VALUE 'Y'.
  2548                 24  PI-ALL-CANCELS-SW        PIC X.
  2549                     88  ALL-CANCELS            VALUE 'Y'.
  2550                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2551                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2552                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2553                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2554                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2555                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2556                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2557                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2558                 24  PI-HOLD-REC-SW           PIC X.
  2559                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2560                 24  PI-CHANGE-REC-SW         PIC X.
  2561                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2562                 24  PI-CHK-REQ-REC-SW        PIC X.
  2563                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2564                 24  PI-ISSUE-WARNING-SW      PIC X.
  2565                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2566                 24  PI-CANCEL-WARNING-SW     PIC X.
  2567                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2568             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2569                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2570             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2571                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2572
  2573             20  PI-MAP-NAME                  PIC X(8).
  2574
  2575             20  PI-CURSOR                    PIC S9(4) COMP.
  2576
  2577             20  PI-PREV-ALT-KEY              PIC X(36).
  2578             20  PI-PREV-CSR-KEY              PIC X(15).
  2579             20  PI-PREV-KEY.
  2580                 24  PI-PREV-COMPANY-CD       PIC X.
  2581                 24  PI-PREV-BATCH            PIC X(6).
  2582                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2583                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2584             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2585             20  PI-BROWSE-SW                 PIC X.
  2586                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2587                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2588             20  PI-SV-CARRIER                PIC X.
  2589             20  PI-SV-GROUPING               PIC X(6).
  2590             20  PI-SV-STATE                  PIC XX.
  2591             20  PI-EDIT-SW                   PIC X.
  2592             20  PI-DISPLAY-SW                PIC XX.
  2593                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  2594                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2595             20  PI-CRITERIA-DATA             PIC X(350).
  2596             20  PI-BMODE                     PIC X.
  2597             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2598             20  PI-BPMTS                     PIC S999     COMP-3.
  2599             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2600             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2601             20  PI-CSR-SESSION-SW            PIC X.
  2602                 88  CSR-EDIT-SESSION           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  49
* EL6311.cbl
  2603             20  PI-ERRORS-SW                 PIC X.
  2604                 88  FATAL-ERRORS               VALUE 'X'.
  2605*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2606             20  FILLER                       PIC X(5).
  2607
  2608        16  FILLER             PIC X(94).
  2609
  2610 01  W-LETTER-COMMUNICATION-AREAS.
  2611*    COPY ELC1042.
  2612******************************************************************
  2613*                                                                *
  2614*                                                                *
  2615*                           ELC1042                              *
  2616*                            VMOD=2.002                          *
  2617*                                                                *
  2618*    NOTE                                                        *
  2619*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2620*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2621*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2622*        TO THESE PROGRAMS.                                      *
  2623*                                                                *
  2624*    NOTE                                                        *
  2625*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2626*        USE ONLY!                                               *
  2627*                                                                *
  2628******************************************************************
  2629
  2630         16  PI-1042-WA.
  2631             20  PI-ACTION       PIC  X(01).
  2632                 88 PI-SHOW-MODE           VALUE '1'.
  2633                 88 PI-CLEAR-MODE          VALUE '2'.
  2634                 88 PI-CREATE-MODE         VALUE '3'.
  2635             20  PI-COMM-CONTROL PIC  X(12).
  2636             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2637             20  PI-EOF-SW       PIC  X(01).
  2638                 88  PI-FILE-EOF           VALUE 'Y'.
  2639             20  PI-FILETYP      PIC  X(01).
  2640             20  PI-FORM-SQUEEZE-CONTROL
  2641                                 PIC  X(01).
  2642                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2643                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2644             20  PI-LAST-CONTROL PIC  X(12).
  2645             20  PI-TEMP-STOR-ITEMS
  2646                                 PIC S9(04) COMP.
  2647             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2648             20  PI-UPDATE-SW    PIC  9(01).
  2649                 88 ANY-UPDATES            VALUE 1.
  2650             20  PI-104-SCREEN-SENT-IND
  2651                                 PIC  X(01).
  2652                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2653                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2654             20  PI-1042-SCREEN-SENT-IND
  2655                                 PIC  X(01).
  2656                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2657                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2658             20  PI-1042-ARCHIVE-IND
  2659                                 PIC  X(01).
  2660                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  50
* EL6311.cbl
  2661             20  FILLER          PIC  X(29).
  2662*    COPY ELC689PI.
  2663******************************************************************
  2664*                                                                *
  2665*                            ELC689PI                            *
  2666*                            VMOD=2.003                          *
  2667*                                                                *
  2668*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2669*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2670*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2671*                                                                *
  2672*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2673*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2674*    BETWEEN PROGRAMS.                                           *
  2675*                                                                *
  2676*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2677*                                                                *
  2678*               EL631 - EL689  - EL6891 - EL6892                 *
  2679*                                                                *
  2680******************************************************************
  2681*                   C H A N G E   L O G
  2682*
  2683* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2684*-----------------------------------------------------------------
  2685*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2686* EFFECTIVE    NUMBER
  2687*-----------------------------------------------------------------
  2688* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2689* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2690* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2691******************************************************************
  2692
  2693
  2694         16  PI-689-WORK-AREA.
  2695             20  PI-689-ALT-PRINTER-ID
  2696                                 PIC  X(04).
  2697             20  PI-689-ARCHIVE-NUMBER
  2698                                 PIC  9(08).
  2699             20  PI-689-ARCHIVE-SW
  2700                                 PIC  X(01).
  2701                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2702             20  PI-689-DATA-SOURCE
  2703                                 PIC  X(01).
  2704                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2705                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2706                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2707                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2708                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2709             20  PI-689-ERROR-IND
  2710                                 PIC  X(01).
  2711                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2712             20  PI-689-ERROR    PIC  9(04).
  2713                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2714                 88  PI-689-FATAL-ERROR
  2715                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2716                            0042 0047 0051 0066 0067 0070
  2717                            0168 0169 0174 0175 0176 0177 0179
  2718                            0180 0181 0182 0184 0185 0189 0190
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  51
* EL6311.cbl
  2719                            0191
  2720                            0215 0279 0280
  2721                            0412 0413 0454
  2722                            0533 0537
  2723                            2055 2114 2208 2209 2216 2232 2369
  2724                            2398 2433 2908 2999
  2725                            3000 3770 3771 3775
  2726                            7250 7365 7367 7368 7369 7370 7371
  2727                            7272 7373 7374 7376 7377 7378 7379
  2728                            7381 7388 7390 7393 7395 7396 7398
  2729                            9095 9096 9281 9298 9299 9320 9327
  2730                            9426 9427.
  2731                 88  PI-689-STOP-ERROR
  2732                     VALUES 0004 0008 0013 0023 0029 0033
  2733                            0042 0047 0066 0067 0070
  2734                            0168 0169 0174 0175 0176 0177
  2735                            0181 0182 0184 0185 0189 0190
  2736                            0279 0280
  2737                            0412 0413 0454
  2738                            2055 2208 2209 2216 2232
  2739                            2398 2999
  2740                            3000 3770 3771 3775
  2741                            7250 7365 7369 7370 7371
  2742                            7272 7373 7374 7376 7377 7378 7379
  2743                            7381 7388 7390 7393 7396 7398
  2744                            9095 9096 9299 9320 9426.
  2745             20  PI-689-FOLLOW-UP-DATE
  2746                                 PIC  X(02).
  2747             20  PI-689-FORM-NUMBER
  2748                                 PIC  X(04).
  2749             20  PI-689-LABEL-SOURCE
  2750                                 PIC X(01).
  2751                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2752                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2753                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2754                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2755                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2756                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2757                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2758             20  PI-689-NUMBER-COPIES
  2759                                 PIC  9(01).
  2760             20  PI-689-NUMBER-LABEL-LINES
  2761                                 PIC  9(01).
  2762             20  PI-689-NUMBER-TEXT-RECORDS
  2763                                 PIC  9(03).
  2764             20  PI-689-PRINT-ORDER-SW
  2765                                 PIC  X(01).
  2766                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2767                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2768                 88  PI-689-PRINT-LATER     VALUE '3'.
  2769                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2770             20  PI-689-PRINT-RESTRICTION
  2771                                 PIC  X(01).
  2772                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2773                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2774                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2775             20  PI-689-PRINT-SW PIC  X(01).
  2776                 88  PI-689-PRINT-PERFORMED VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  52
* EL6311.cbl
  2777             20  PI-689-RESEND-DATE-1
  2778                                 PIC  X(02).
  2779             20  PI-689-RESEND-LETR-1
  2780                                 PIC X(4).
  2781             20  PI-689-TEMP-STOR-ID
  2782                                 PIC  X(08).
  2783             20  PI-689-USE-SCREEN-IND
  2784                                 PIC  X(01).
  2785                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2786             20  PI-689-ARCH-POINTER
  2787                                 PIC S9(08) COMP.
  2788                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2789             20  PI-689-ARCT-POINTER
  2790                                 PIC S9(08) COMP.
  2791                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2792             20  PI-689-VARIABLE-DATA-GRP.
  2793                 24  PI-689-VARIABLE-DATA-1
  2794                                 PIC  X(30).
  2795                 24  PI-689-VARIABLE-DATA-2
  2796                                 PIC  X(30).
  2797                 24  PI-689-VARIABLE-DATA-3
  2798                                 PIC  X(30).
  2799                 24  PI-689-VARIABLE-DATA-4
  2800                                 PIC  X(30).
  2801
  2802         16  PI-689-KEY-DATA-FIELDS.
  2803             20  PI-689-ACCOUNT  PIC  X(10).
  2804             20  PI-689-CARRIER  PIC  X(01).
  2805             20  PI-689-CERT-NO.
  2806                 24  PI-689-CERT-PRIME
  2807                                 PIC  X(10).
  2808                 24  PI-689-CERT-SFX
  2809                                 PIC  X(01).
  2810             20  PI-689-CHG-SEQ-NO
  2811                                 PIC S9(04)    COMP.
  2812             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2813                                 PIC  X(02).
  2814             20  PI-689-ENTRY-BATCH
  2815                                 PIC  X(06).
  2816             20  PI-689-EFF-DATE PIC  X(02).
  2817             20  PI-689-EXP-DATE PIC  X(02).
  2818             20  PI-689-GROUPING PIC  X(06).
  2819             20  PI-689-RESP-PERSON
  2820                                 PIC  X(10).
  2821             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2822             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2823                                 PIC  X(04).
  2824             20  PI-689-STATE    PIC  X(02).
  2825             20  PI-689-TYPE     PIC  X(01).
  2826             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2827             20  PI-689-ALT-SEQ-NO
  2828                                 PIC S9(04)    COMP.
  2829         16  PI-689-DATE-EDIT    PIC  X(08).
  2830         16  PI-689-FOLLOW-UP-EDIT
  2831                                 PIC  X(08).
  2832         16  PI-689-RESEND1-EDIT PIC  X(08).
  2833         16  PI-689-SEQ-EDIT     PIC  X(08).
  2834         16  PI-689-BCSEQ-EDIT   PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  53
* EL6311.cbl
  2835         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2836             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2837         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2838         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  54
* EL6311.cbl
  2840
  2841 01  WS-EL6315-PASS-AREA.
  2842        16  PI-6315-ISS-CAN-SW      PIC X.
  2843        16  FILLER                  PIC X(120).
  2844        16  PI-RES-REF-CLM-TYPE     PIC X.
  2845        16  FILLER                  PIC X.
  2846        16  PI-6315-PASS-AREA.
  2847            20 FILLER               PIC X(236).
  2848            20 PI-6315-FINALIZED    PIC X.
  2849            20 FILLER               PIC X(280).
  2850
  2851 01  WS-EL6316-PASS-AREA.
  2852        16  PI-ISS-CAN-SW           PIC X.
  2853        16  FILLER                  PIC X(121).
  2854        16  PI-CLM-RESC-IND         PIC X.
  2855        16  PI-6316-PASS-AREA.
  2856            20 FILLER               PIC X(236).
  2857            20 PI-6316-FINALIZED    PIC X.
  2858            20 FILLER               PIC X(280).
  2859
  2860******************************************************************
  2861*                                                                *
  2862*         P A S S   A R E A   F O R   E D I T                    *
  2863*                                                                *
  2864******************************************************************
  2865
  2866 01  PASSED-RECORD.
  2867     12  RECORD-SAVE                  PIC X(585).
  2868* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2869*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2870*                    BY  WK-CURRENT-DATE.
  2871******************************************************************
  2872*                                                                *
  2873*                                                                *
  2874*                             ELC50W1                            *
  2875*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2876*                            VMOD=2.004                          *
  2877*                                                                *
  2878*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2879*                                                                *
  2880*                                                                *
  2881******************************************************************
  2882
  2883     12  WK-WORK-AREA.
  2884         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2885         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2886         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2887         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2888         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2889         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2890         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2891         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2892         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2893         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2894         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2895         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2896         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2897         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  55
* EL6311.cbl
  2898         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2899         16  WK-CREDIT-EDIT-CONTROLS.
  2900             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2901             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2902             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2903             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2904             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2905             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2906         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2907         16  WK-SAVE-REIN-DATA.
  2908             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2909             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2910             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2911         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2912             88  ENTRY-FROM-EL6311       VALUE '6'.
  2913         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2914         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2915     12  WK-RECORD-ADDRESSES.
  2916         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2917         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2918         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2919         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2920         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2921         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2922         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2923         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2924     12  WK-OVER-SHORT-AREA.
  2925         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2926         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2927         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2928             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2929         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  56
* EL6311.cbl
  2931
  2932*    COPY ELCEDITC.
  2933******************************************************************
  2934*                                                                *
  2935*                                                                *
  2936*                            ELCEDITC                            *
  2937*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2938*                            VMOD=2.012                          *
  2939*                                                                *
  2940*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2941*                     EL6313, EL050 AND EL517.                   *
  2942*                                                                *
  2943******************************************************************
  2944******************************************************************
  2945*                   C H A N G E   L O G
  2946*
  2947* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2948*-----------------------------------------------------------------
  2949*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2950* EFFECTIVE    NUMBER
  2951*-----------------------------------------------------------------
  2952* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2953******************************************************************
  2954
  2955     12  EDIT-CRITERIA-DATA.
  2956         16  EC-CO-MONTH-END-DT       PIC XX.
  2957         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  2958         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  2959         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  2960         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  2961         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  2962         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  2963         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  2964         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  2965         16  EC-CO-REM-TERM-CALC      PIC X.
  2966               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  2967               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  2968               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  2969               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  2970
  2971         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  2972               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  2973               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  2974               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  2975               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  2976               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  2977               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  2978               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  2979               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  2980               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  2981               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  2982
  2983         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  2984               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  2985               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  2986               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  2987               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  2988               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  57
* EL6311.cbl
  2989               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  2990               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  2991               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  2992
  2993         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  2994                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  2995                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  2996
  2997         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  2998                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  2999                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3000                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3001                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3002                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3003                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3004                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3005                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3006
  3007         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3008               88  EC-BR-REDUCING                   VALUE 'R'.
  3009               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3010
  3011         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3012         16  EC-BR-LF-DESC             PIC X(10).
  3013         16  EC-BR-AH-DESC             PIC X(10).
  3014         16  EC-BR-LF-COMMENT          PIC X(10).
  3015         16  EC-BR-AH-COMMENT          PIC X(10).
  3016
  3017         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3018               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3019               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3020               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3021               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3022
  3023         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3024               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3025               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3026               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3027               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3028
  3029         16  EC-BR-LF-REFUND-CALC      PIC X.
  3030                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3031                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3032                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3033                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3034                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3035                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3036                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3037
  3038         16  EC-BR-AH-REFUND-CALC      PIC X.
  3039                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3040                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3041                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3042                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3043                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3044                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3045                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3046                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  58
* EL6311.cbl
  3047
  3048         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3049                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3050                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3051                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3052
  3053         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3054                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3055                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3056                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3057
  3058         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3059         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3060         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3061         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3062
  3063         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3064         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3065                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3066                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3067                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3068                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3069
  3070         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3071               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3072               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3073               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3074               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3075               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3076
  3077         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3078               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3079               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3080               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3081               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3082               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3083
  3084         16  EC-ST-LF-REFUND-CALC      PIC X.
  3085                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3086                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3087                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3088                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3089                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3090                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3091                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3092                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3093
  3094         16  EC-ST-AH-REFUND-CALC      PIC X.
  3095                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3096                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3097                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3098                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3099                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3100                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3101                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3102                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3103
  3104         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  59
* EL6311.cbl
  3105         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3106         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3107         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3108         16  EC-AM-EXPIRATION-DT       PIC XX.
  3109         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3110         16  EC-AM-CLASS-CD            PIC XX.
  3111         16  EC-AM-LF-DEVIATION        PIC XXX.
  3112         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3113         16  EC-AM-AH-DEVIATION        PIC XXX.
  3114         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3115         16  EC-AM-PHONE-NO            PIC X(10).
  3116
  3117         16  EC-AM-LF-REFUND-CALC      PIC X.
  3118                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3119                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3120                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3121                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3122                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3123                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3124                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3125
  3126         16  EC-AM-AH-REFUND-CALC      PIC X.
  3127                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3128                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3129                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3130                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3131                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3132                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3133                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3134
  3135         16  EC-AM-BEN-I-G-CD          PIC X.
  3136                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3137                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3138                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3139
  3140         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3141         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3142         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3143         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3144         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3145         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3146         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3147         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3148         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3149
  3150         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3151         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3152         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3153         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3154         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3155         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3156         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3157         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3158         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3159         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3160         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3161         16  EC-RT-LF-NSP-ST           PIC XX.
  3162         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  60
* EL6311.cbl
  3163         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3164         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3165
  3166         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3167             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3168                                             'M' '5' '9' '2'.
  3169             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3170             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3171             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3172             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3173             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3174             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3175             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3176             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3177             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3178             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3179
  3180         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3181             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3182                                             'M' '5' '9' '2'.
  3183             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3184             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3185             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3186             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3187             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3188             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3189             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3190             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3191             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3192             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3193
  3194         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3195         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3196         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3197         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3198         16  EC-CM-DEATH-DT            PIC XX.
  3199
  3200*DMD CUSTOM CODING FIELDS BELOW
  3201*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3202         16  EC-BR-DMD-RATING-SW       PIC X.
  3203                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3204                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3205                 88  NO-DMD-RATING               VALUE 'N'.
  3206
  3207         16  EC-NEW-CERT               PIC X(11).
  3208         16  EC-NEW-STATE              PIC XX.
  3209         16  FILLER                    PIC X.
  3210*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3211         16  OVER-SHORT-EDIT-FIELDS.
  3212             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3213             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3214             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3215             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3216             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3217             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3218             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3219             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3220             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  61
* EL6311.cbl
  3221         16  FILLER                    PIC X(71).
  3222
  3223******************************************************************
  3224
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  62
* EL6311.cbl
  3226
  3227*    COPY ELCJPFX.
  3228******************************************************************
  3229*                                                                *
  3230*                                                                *
  3231*                            ELCJPFX.                            *
  3232*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3233*                            VMOD=2.002                          *
  3234*                                                                *
  3235*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3236*                                                                *
  3237*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3238*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3239*        ELCNTL - CONTROL FILE                                   *
  3240*        ELMSTR - CLAIM MASTERS                                  *
  3241*        ELTRLR - ACTIVITY TRAILERS                              *
  3242*        ELCHKQ - CHECK QUE                                      *
  3243******************************************************************
  3244 01  JOURNAL-RECORD.
  3245     12  jp-date                     pic s9(5) comp-3.
  3246     12  jp-time                     pic s9(7) comp-3.
  3247     12  JP-USER-ID                  PIC X(4).
  3248     12  JP-FILE-ID                  PIC X(8).
  3249     12  JP-PROGRAM-ID               PIC X(8).
  3250     12  JP-RECORD-TYPE              PIC X.
  3251         88 JP-ADD              VALUE 'A'.
  3252         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3253         88 JP-AFTER-CHANGE     VALUE 'C'.
  3254         88 JP-DELETE           VALUE 'D'.
  3255         88 JP-GENERIC-DELETE   VALUE 'G'.
  3256         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3257         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3258     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3259     12  JP-RECORD-AREA
  3260
  3261
  3262                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  63
* EL6311.cbl
  3264*    COPY ELCAID.
  3265******************************************************************
  3266*                                                                *
  3267*                            ELCAID.                             *
  3268*                            VMOD=2.001                          *
  3269*                                                                *
  3270*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3271*                                                                *
  3272*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3273*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3274******************************************************************
  3275
  3276 01  DFHAID.
  3277   02  DFHNULL   PIC  X  VALUE  ' '.
  3278   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3279   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3280   02  DFHPEN    PIC  X  VALUE  '='.
  3281   02  DFHOPID   PIC  X  VALUE  'W'.
  3282   02  DFHPA1    PIC  X  VALUE  '%'.
  3283   02  DFHPA2    PIC  X  VALUE  '>'.
  3284   02  DFHPA3    PIC  X  VALUE  ','.
  3285   02  DFHPF1    PIC  X  VALUE  '1'.
  3286   02  DFHPF2    PIC  X  VALUE  '2'.
  3287   02  DFHPF3    PIC  X  VALUE  '3'.
  3288   02  DFHPF4    PIC  X  VALUE  '4'.
  3289   02  DFHPF5    PIC  X  VALUE  '5'.
  3290   02  DFHPF6    PIC  X  VALUE  '6'.
  3291   02  DFHPF7    PIC  X  VALUE  '7'.
  3292   02  DFHPF8    PIC  X  VALUE  '8'.
  3293   02  DFHPF9    PIC  X  VALUE  '9'.
  3294   02  DFHPF10   PIC  X  VALUE  ':'.
  3295   02  DFHPF11   PIC  X  VALUE  '#'.
  3296   02  DFHPF12   PIC  X  VALUE  '@'.
  3297   02  DFHPF13   PIC  X  VALUE  'A'.
  3298   02  DFHPF14   PIC  X  VALUE  'B'.
  3299   02  DFHPF15   PIC  X  VALUE  'C'.
  3300   02  DFHPF16   PIC  X  VALUE  'D'.
  3301   02  DFHPF17   PIC  X  VALUE  'E'.
  3302   02  DFHPF18   PIC  X  VALUE  'F'.
  3303   02  DFHPF19   PIC  X  VALUE  'G'.
  3304   02  DFHPF20   PIC  X  VALUE  'H'.
  3305   02  DFHPF21   PIC  X  VALUE  'I'.
  3306*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3307   02  DFHPF22   PIC  X  VALUE  '['.
  3308   02  DFHPF23   PIC  X  VALUE  '.'.
  3309   02  DFHPF24   PIC  X  VALUE  '<'.
  3310   02  DFHMSRE   PIC  X  VALUE  'X'.
  3311   02  DFHSTRF   PIC  X  VALUE  'h'.
  3312   02  DFHTRIG   PIC  X  VALUE  '"'.
  3313
  3314 01  FILLER    REDEFINES DFHAID.
  3315     12  FILLER              PIC X(8).
  3316     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3317
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  64
* EL6311.cbl
  3319*    COPY EL6311S.
  3320 01  EL631BI.
  3321     05  FILLER            PIC  X(0012).
  3322*    -------------------------------
  3323     05  BDATEL PIC S9(0004) COMP.
  3324     05  BDATEF PIC  X(0001).
  3325     05  FILLER REDEFINES BDATEF.
  3326         10  BDATEA PIC  X(0001).
  3327     05  BDATEI PIC  X(0008).
  3328*    -------------------------------
  3329     05  BTIMEL PIC S9(0004) COMP.
  3330     05  BTIMEF PIC  X(0001).
  3331     05  FILLER REDEFINES BTIMEF.
  3332         10  BTIMEA PIC  X(0001).
  3333     05  BTIMEI PIC  X(0005).
  3334*    -------------------------------
  3335     05  BHEADL PIC S9(0004) COMP.
  3336     05  BHEADF PIC  X(0001).
  3337     05  FILLER REDEFINES BHEADF.
  3338         10  BHEADA PIC  X(0001).
  3339     05  BHEADI PIC  X(0038).
  3340*    -------------------------------
  3341     05  BNCERTLL PIC S9(0004) COMP.
  3342     05  BNCERTLF PIC  X(0001).
  3343     05  FILLER REDEFINES BNCERTLF.
  3344         10  BNCERTLA PIC  X(0001).
  3345     05  BNCERTLI PIC  X(0008).
  3346*    -------------------------------
  3347     05  BNCERTL PIC S9(0004) COMP.
  3348     05  BNCERTF PIC  X(0001).
  3349     05  FILLER REDEFINES BNCERTF.
  3350         10  BNCERTA PIC  X(0001).
  3351     05  BNCERTI PIC  X(0011).
  3352*    -------------------------------
  3353     05  BNSTATLL PIC S9(0004) COMP.
  3354     05  BNSTATLF PIC  X(0001).
  3355     05  FILLER REDEFINES BNSTATLF.
  3356         10  BNSTATLA PIC  X(0001).
  3357     05  BNSTATLI PIC  X(0009).
  3358*    -------------------------------
  3359     05  BNSTATL PIC S9(0004) COMP.
  3360     05  BNSTATF PIC  X(0001).
  3361     05  FILLER REDEFINES BNSTATF.
  3362         10  BNSTATA PIC  X(0001).
  3363     05  BNSTATI PIC  X(0002).
  3364*    -------------------------------
  3365     05  BCHGTL PIC S9(0004) COMP.
  3366     05  BCHGTF PIC  X(0001).
  3367     05  FILLER REDEFINES BCHGTF.
  3368         10  BCHGTA PIC  X(0001).
  3369     05  BCHGTI PIC  X(0004).
  3370*    -------------------------------
  3371     05  BCHGL PIC S9(0004) COMP.
  3372     05  BCHGF PIC  X(0001).
  3373     05  FILLER REDEFINES BCHGF.
  3374         10  BCHGA PIC  X(0001).
  3375     05  BCHGI PIC  X(0004).
  3376*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  65
* EL6311.cbl
  3377     05  BMAINTL PIC S9(0004) COMP.
  3378     05  BMAINTF PIC  X(0001).
  3379     05  FILLER REDEFINES BMAINTF.
  3380         10  BMAINTA PIC  X(0001).
  3381     05  BMAINTI PIC  X(0001).
  3382*    -------------------------------
  3383     05  BMANTBYL PIC S9(0004) COMP.
  3384     05  BMANTBYF PIC  X(0001).
  3385     05  FILLER REDEFINES BMANTBYF.
  3386         10  BMANTBYA PIC  X(0001).
  3387     05  BMANTBYI PIC  X(0004).
  3388*    -------------------------------
  3389     05  BCHGHDGL PIC S9(0004) COMP.
  3390     05  BCHGHDGF PIC  X(0001).
  3391     05  FILLER REDEFINES BCHGHDGF.
  3392         10  BCHGHDGA PIC  X(0001).
  3393     05  BCHGHDGI PIC  X(0003).
  3394*    -------------------------------
  3395     05  BMANTDTL PIC S9(0004) COMP.
  3396     05  BMANTDTF PIC  X(0001).
  3397     05  FILLER REDEFINES BMANTDTF.
  3398         10  BMANTDTA PIC  X(0001).
  3399     05  BMANTDTI PIC  X(0008).
  3400*    -------------------------------
  3401     05  BMANTATL PIC S9(0004) COMP.
  3402     05  BMANTATF PIC  X(0001).
  3403     05  FILLER REDEFINES BMANTATF.
  3404         10  BMANTATA PIC  X(0001).
  3405     05  BMANTATI PIC  X(0005).
  3406*    -------------------------------
  3407     05  BCSRL PIC S9(0004) COMP.
  3408     05  BCSRF PIC  X(0001).
  3409     05  FILLER REDEFINES BCSRF.
  3410         10  BCSRA PIC  X(0001).
  3411     05  BCSRI PIC  X(0004).
  3412*    -------------------------------
  3413     05  BBATCHL PIC S9(0004) COMP.
  3414     05  BBATCHF PIC  X(0001).
  3415     05  FILLER REDEFINES BBATCHF.
  3416         10  BBATCHA PIC  X(0001).
  3417     05  BBATCHI PIC  X(0006).
  3418*    -------------------------------
  3419     05  BSEQL PIC S9(0004) COMP.
  3420     05  BSEQF PIC  X(0001).
  3421     05  FILLER REDEFINES BSEQF.
  3422         10  BSEQA PIC  X(0001).
  3423     05  BSEQI PIC  X(0004).
  3424*    -------------------------------
  3425     05  BMOENDTL PIC S9(0004) COMP.
  3426     05  BMOENDTF PIC  X(0001).
  3427     05  FILLER REDEFINES BMOENDTF.
  3428         10  BMOENDTA PIC  X(0001).
  3429     05  BMOENDTI PIC  X(0008).
  3430*    -------------------------------
  3431     05  BCARRL PIC S9(0004) COMP.
  3432     05  BCARRF PIC  X(0001).
  3433     05  FILLER REDEFINES BCARRF.
  3434         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  66
* EL6311.cbl
  3435     05  BCARRI PIC  X(0001).
  3436*    -------------------------------
  3437     05  BGROUPL PIC S9(0004) COMP.
  3438     05  BGROUPF PIC  X(0001).
  3439     05  FILLER REDEFINES BGROUPF.
  3440         10  BGROUPA PIC  X(0001).
  3441     05  BGROUPI PIC  X(0006).
  3442*    -------------------------------
  3443     05  BSTATEL PIC S9(0004) COMP.
  3444     05  BSTATEF PIC  X(0001).
  3445     05  FILLER REDEFINES BSTATEF.
  3446         10  BSTATEA PIC  X(0001).
  3447     05  BSTATEI PIC  X(0002).
  3448*    -------------------------------
  3449     05  BACCTL PIC S9(0004) COMP.
  3450     05  BACCTF PIC  X(0001).
  3451     05  FILLER REDEFINES BACCTF.
  3452         10  BACCTA PIC  X(0001).
  3453     05  BACCTI PIC  X(0010).
  3454*    -------------------------------
  3455     05  BVINHL PIC S9(0004) COMP.
  3456     05  BVINHF PIC  X(0001).
  3457     05  FILLER REDEFINES BVINHF.
  3458         10  BVINHA PIC  X(0001).
  3459     05  BVINHI PIC  X(0004).
  3460*    -------------------------------
  3461     05  BVINL PIC S9(0004) COMP.
  3462     05  BVINF PIC  X(0001).
  3463     05  FILLER REDEFINES BVINF.
  3464         10  BVINA PIC  X(0001).
  3465     05  BVINI PIC  X(0017).
  3466*    -------------------------------
  3467     05  BREFHDGL PIC S9(0004) COMP.
  3468     05  BREFHDGF PIC  X(0001).
  3469     05  FILLER REDEFINES BREFHDGF.
  3470         10  BREFHDGA PIC  X(0001).
  3471     05  BREFHDGI PIC  X(0004).
  3472*    -------------------------------
  3473     05  BREFL PIC S9(0004) COMP.
  3474     05  BREFF PIC  X(0001).
  3475     05  FILLER REDEFINES BREFF.
  3476         10  BREFA PIC  X(0001).
  3477     05  BREFI PIC  X(0012).
  3478*    -------------------------------
  3479     05  BAGEDEFL PIC S9(0004) COMP.
  3480     05  BAGEDEFF PIC  X(0001).
  3481     05  FILLER REDEFINES BAGEDEFF.
  3482         10  BAGEDEFA PIC  X(0001).
  3483     05  BAGEDEFI PIC  X(0004).
  3484*    -------------------------------
  3485     05  BCERTNOL PIC S9(0004) COMP.
  3486     05  BCERTNOF PIC  X(0001).
  3487     05  FILLER REDEFINES BCERTNOF.
  3488         10  BCERTNOA PIC  X(0001).
  3489     05  BCERTNOI PIC  X(0010).
  3490*    -------------------------------
  3491     05  BSUFIXL PIC S9(0004) COMP.
  3492     05  BSUFIXF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  67
* EL6311.cbl
  3493     05  FILLER REDEFINES BSUFIXF.
  3494         10  BSUFIXA PIC  X(0001).
  3495     05  BSUFIXI PIC  X(0001).
  3496*    -------------------------------
  3497     05  BEFFDTL PIC S9(0004) COMP.
  3498     05  BEFFDTF PIC  X(0001).
  3499     05  FILLER REDEFINES BEFFDTF.
  3500         10  BEFFDTA PIC  X(0001).
  3501     05  BEFFDTI PIC  X(0008).
  3502*    -------------------------------
  3503     05  BLSTNML PIC S9(0004) COMP.
  3504     05  BLSTNMF PIC  X(0001).
  3505     05  FILLER REDEFINES BLSTNMF.
  3506         10  BLSTNMA PIC  X(0001).
  3507     05  BLSTNMI PIC  X(0015).
  3508*    -------------------------------
  3509     05  B1STNML PIC S9(0004) COMP.
  3510     05  B1STNMF PIC  X(0001).
  3511     05  FILLER REDEFINES B1STNMF.
  3512         10  B1STNMA PIC  X(0001).
  3513     05  B1STNMI PIC  X(0010).
  3514*    -------------------------------
  3515     05  BINITL PIC S9(0004) COMP.
  3516     05  BINITF PIC  X(0001).
  3517     05  FILLER REDEFINES BINITF.
  3518         10  BINITA PIC  X(0001).
  3519     05  BINITI PIC  X(0001).
  3520*    -------------------------------
  3521     05  BSEXL PIC S9(0004) COMP.
  3522     05  BSEXF PIC  X(0001).
  3523     05  FILLER REDEFINES BSEXF.
  3524         10  BSEXA PIC  X(0001).
  3525     05  BSEXI PIC  X(0001).
  3526*    -------------------------------
  3527     05  BAGEL PIC S9(0004) COMP.
  3528     05  BAGEF PIC  X(0001).
  3529     05  FILLER REDEFINES BAGEF.
  3530         10  BAGEA PIC  X(0001).
  3531     05  BAGEI PIC  X(0002).
  3532*    -------------------------------
  3533     05  BBIRTHL PIC S9(0004) COMP.
  3534     05  BBIRTHF PIC  X(0001).
  3535     05  FILLER REDEFINES BBIRTHF.
  3536         10  BBIRTHA PIC  X(0001).
  3537     05  BBIRTHI PIC  X(0008).
  3538*    -------------------------------
  3539     05  B1STPMTL PIC S9(0004) COMP.
  3540     05  B1STPMTF PIC  X(0001).
  3541     05  FILLER REDEFINES B1STPMTF.
  3542         10  B1STPMTA PIC  X(0001).
  3543     05  B1STPMTI PIC  X(0008).
  3544*    -------------------------------
  3545     05  BDAYSL PIC S9(0004) COMP.
  3546     05  BDAYSF PIC  X(0001).
  3547     05  FILLER REDEFINES BDAYSF.
  3548         10  BDAYSA PIC  X(0001).
  3549     05  BDAYSI PIC  X(0003).
  3550*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  68
* EL6311.cbl
  3551     05  BLNTRML PIC S9(0004) COMP.
  3552     05  BLNTRMF PIC  X(0001).
  3553     05  FILLER REDEFINES BLNTRMF.
  3554         10  BLNTRMA PIC  X(0001).
  3555     05  BLNTRMI PIC  X(0003).
  3556*    -------------------------------
  3557     05  BLNOFCRL PIC S9(0004) COMP.
  3558     05  BLNOFCRF PIC  X(0001).
  3559     05  FILLER REDEFINES BLNOFCRF.
  3560         10  BLNOFCRA PIC  X(0001).
  3561     05  BLNOFCRI PIC  X(0005).
  3562*    -------------------------------
  3563     05  BMODEL PIC S9(0004) COMP.
  3564     05  BMODEF PIC  X(0001).
  3565     05  FILLER REDEFINES BMODEF.
  3566         10  BMODEA PIC  X(0001).
  3567     05  BMODEI PIC  X(0001).
  3568*    -------------------------------
  3569     05  BFREQL PIC S9(0004) COMP.
  3570     05  BFREQF PIC  X(0001).
  3571     05  FILLER REDEFINES BFREQF.
  3572         10  BFREQA PIC  X(0001).
  3573     05  BFREQI PIC  X(0002).
  3574*    -------------------------------
  3575     05  BPMTSL PIC S9(0004) COMP.
  3576     05  BPMTSF PIC  X(0001).
  3577     05  FILLER REDEFINES BPMTSF.
  3578         10  BPMTSA PIC  X(0001).
  3579     05  BPMTSI PIC  999.
  3580*    -------------------------------
  3581     05  BPMTAMTL PIC S9(0004) COMP.
  3582     05  BPMTAMTF PIC  X(0001).
  3583     05  FILLER REDEFINES BPMTAMTF.
  3584         10  BPMTAMTA PIC  X(0001).
  3585     05  BPMTAMTI PIC  9(7)V99.
  3586*    -------------------------------
  3587     05  BAPRL PIC S9(0004) COMP.
  3588     05  BAPRF PIC  X(0001).
  3589     05  FILLER REDEFINES BAPRF.
  3590         10  BAPRA PIC  X(0001).
  3591     05  BAPRI PIC  X(7).
  3592*    -------------------------------
  3593     05  BLIVESL PIC S9(0004) COMP.
  3594     05  BLIVESF PIC  X(0001).
  3595     05  FILLER REDEFINES BLIVESF.
  3596         10  BLIVESA PIC  X(0001).
  3597     05  BLIVESI PIC  X(0009).
  3598*    -------------------------------
  3599     05  BMEMCAPL PIC S9(0004) COMP.
  3600     05  BMEMCAPF PIC  X(0001).
  3601     05  FILLER REDEFINES BMEMCAPF.
  3602         10  BMEMCAPA PIC  X(0001).
  3603     05  BMEMCAPI PIC  X(0011).
  3604*    -------------------------------
  3605     05  BORIGHDL PIC S9(0004) COMP.
  3606     05  BORIGHDF PIC  X(0001).
  3607     05  FILLER REDEFINES BORIGHDF.
  3608         10  BORIGHDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  69
* EL6311.cbl
  3609     05  BORIGHDI PIC  X(0009).
  3610*    -------------------------------
  3611     05  DMDBILL PIC S9(0004) COMP.
  3612     05  DMDBILF PIC  X(0001).
  3613     05  FILLER REDEFINES DMDBILF.
  3614         10  DMDBILA PIC  X(0001).
  3615     05  DMDBILI PIC  X(0006).
  3616*    -------------------------------
  3617     05  BFORCEL PIC S9(0004) COMP.
  3618     05  BFORCEF PIC  X(0001).
  3619     05  FILLER REDEFINES BFORCEF.
  3620         10  BFORCEA PIC  X(0001).
  3621     05  BFORCEI PIC  X(0001).
  3622*    -------------------------------
  3623     05  BENTRYL PIC S9(0004) COMP.
  3624     05  BENTRYF PIC  X(0001).
  3625     05  FILLER REDEFINES BENTRYF.
  3626         10  BENTRYA PIC  X(0001).
  3627     05  BENTRYI PIC  X(0001).
  3628*    -------------------------------
  3629     05  BREINL PIC S9(0004) COMP.
  3630     05  BREINF PIC  X(0001).
  3631     05  FILLER REDEFINES BREINF.
  3632         10  BREINA PIC  X(0001).
  3633     05  BREINI PIC  X(0001).
  3634*    -------------------------------
  3635     05  BBILCDL PIC S9(0004) COMP.
  3636     05  BBILCDF PIC  X(0001).
  3637     05  FILLER REDEFINES BBILCDF.
  3638         10  BBILCDA PIC  X(0001).
  3639     05  BBILCDI PIC  X(0001).
  3640*    -------------------------------
  3641     05  BUNWRITL PIC S9(0004) COMP.
  3642     05  BUNWRITF PIC  X(0001).
  3643     05  FILLER REDEFINES BUNWRITF.
  3644         10  BUNWRITA PIC  X(0001).
  3645     05  BUNWRITI PIC  X(0001).
  3646*    -------------------------------
  3647     05  BSKPCDL PIC S9(0004) COMP.
  3648     05  BSKPCDF PIC  X(0001).
  3649     05  FILLER REDEFINES BSKPCDF.
  3650         10  BSKPCDA PIC  X(0001).
  3651     05  BSKPCDI PIC  X(0001).
  3652*    -------------------------------
  3653     05  BINDGRPL PIC S9(0004) COMP.
  3654     05  BINDGRPF PIC  X(0001).
  3655     05  FILLER REDEFINES BINDGRPF.
  3656         10  BINDGRPA PIC  X(0001).
  3657     05  BINDGRPI PIC  X(0001).
  3658*    -------------------------------
  3659     05  BSIGL PIC S9(0004) COMP.
  3660     05  BSIGF PIC  X(0001).
  3661     05  FILLER REDEFINES BSIGF.
  3662         10  BSIGA PIC  X(0001).
  3663     05  BSIGI PIC  X(0001).
  3664*    -------------------------------
  3665     05  BRTCLSL PIC S9(0004) COMP.
  3666     05  BRTCLSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  70
* EL6311.cbl
  3667     05  FILLER REDEFINES BRTCLSF.
  3668         10  BRTCLSA PIC  X(0001).
  3669     05  BRTCLSI PIC  X(0002).
  3670*    -------------------------------
  3671     05  BCHGCNTL PIC S9(0004) COMP.
  3672     05  BCHGCNTF PIC  X(0001).
  3673     05  FILLER REDEFINES BCHGCNTF.
  3674         10  BCHGCNTA PIC  X(0001).
  3675     05  BCHGCNTI PIC  X(0003).
  3676*    -------------------------------
  3677     05  BMEMBERL PIC S9(0004) COMP.
  3678     05  BMEMBERF PIC  X(0001).
  3679     05  FILLER REDEFINES BMEMBERF.
  3680         10  BMEMBERA PIC  X(0001).
  3681     05  BMEMBERI PIC  X(0012).
  3682*    -------------------------------
  3683     05  BORGNOL PIC S9(0004) COMP.
  3684     05  BORGNOF PIC  X(0001).
  3685     05  FILLER REDEFINES BORGNOF.
  3686         10  BORGNOA PIC  X(0001).
  3687     05  BORGNOI PIC  X(0006).
  3688*    -------------------------------
  3689     05  BORGSEQL PIC S9(0004) COMP.
  3690     05  BORGSEQF PIC  X(0001).
  3691     05  FILLER REDEFINES BORGSEQF.
  3692         10  BORGSEQA PIC  X(0001).
  3693     05  BORGSEQI PIC  X(0004).
  3694*    -------------------------------
  3695     05  BBILLEDL PIC S9(0004) COMP.
  3696     05  BBILLEDF PIC  X(0001).
  3697     05  FILLER REDEFINES BBILLEDF.
  3698         10  BBILLEDA PIC  X(0001).
  3699     05  BBILLEDI PIC  9(9).
  3700*    -------------------------------
  3701     05  BKIND1L PIC S9(0004) COMP.
  3702     05  BKIND1F PIC  X(0001).
  3703     05  FILLER REDEFINES BKIND1F.
  3704         10  BKIND1A PIC  X(0001).
  3705     05  BKIND1I PIC  X(0002).
  3706*    -------------------------------
  3707     05  BTYPE1L PIC S9(0004) COMP.
  3708     05  BTYPE1F PIC  X(0001).
  3709     05  FILLER REDEFINES BTYPE1F.
  3710         10  BTYPE1A PIC  X(0001).
  3711     05  BTYPE1I PIC  X(0003).
  3712*    -------------------------------
  3713     05  BTERM1L PIC S9(0004) COMP.
  3714     05  BTERM1F PIC  X(0001).
  3715     05  FILLER REDEFINES BTERM1F.
  3716         10  BTERM1A PIC  X(0001).
  3717     05  BTERM1I PIC  X(0003).
  3718*    -------------------------------
  3719     05  BBEN1L PIC S9(0004) COMP.
  3720     05  BBEN1F PIC  X(0001).
  3721     05  FILLER REDEFINES BBEN1F.
  3722         10  BBEN1A PIC  X(0001).
  3723     05  BBEN1I PIC  X(0012).
  3724*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  71
* EL6311.cbl
  3725     05  BPREM1L PIC S9(0004) COMP.
  3726     05  BPREM1F PIC  X(0001).
  3727     05  FILLER REDEFINES BPREM1F.
  3728         10  BPREM1A PIC  X(0001).
  3729     05  BPREM1I PIC  X(0011).
  3730*    -------------------------------
  3731     05  BEXPIR1L PIC S9(0004) COMP.
  3732     05  BEXPIR1F PIC  X(0001).
  3733     05  FILLER REDEFINES BEXPIR1F.
  3734         10  BEXPIR1A PIC  X(0001).
  3735     05  BEXPIR1I PIC  X(0008).
  3736*    -------------------------------
  3737     05  BCP1L PIC S9(0004) COMP.
  3738     05  BCP1F PIC  X(0001).
  3739     05  FILLER REDEFINES BCP1F.
  3740         10  BCP1A PIC  X(0001).
  3741     05  BCP1I PIC  X(0002).
  3742*    -------------------------------
  3743     05  BALTBN1L PIC S9(0004) COMP.
  3744     05  BALTBN1F PIC  X(0001).
  3745     05  FILLER REDEFINES BALTBN1F.
  3746         10  BALTBN1A PIC  X(0001).
  3747     05  BALTBN1I PIC  X(0012).
  3748*    -------------------------------
  3749     05  BALTPR1L PIC S9(0004) COMP.
  3750     05  BALTPR1F PIC  X(0001).
  3751     05  FILLER REDEFINES BALTPR1F.
  3752         10  BALTPR1A PIC  X(0001).
  3753     05  BALTPR1I PIC  X(0011).
  3754*    -------------------------------
  3755     05  BBNCD1L PIC S9(0004) COMP.
  3756     05  BBNCD1F PIC  X(0001).
  3757     05  FILLER REDEFINES BBNCD1F.
  3758         10  BBNCD1A PIC  X(0001).
  3759     05  BBNCD1I PIC  X(0003).
  3760*    -------------------------------
  3761     05  BCPRM1L PIC S9(0004) COMP.
  3762     05  BCPRM1F PIC  X(0001).
  3763     05  FILLER REDEFINES BCPRM1F.
  3764         10  BCPRM1A PIC  X(0001).
  3765     05  BCPRM1I PIC  X(0011).
  3766*    -------------------------------
  3767     05  BCAPRM1L PIC S9(0004) COMP.
  3768     05  BCAPRM1F PIC  X(0001).
  3769     05  FILLER REDEFINES BCAPRM1F.
  3770         10  BCAPRM1A PIC  X(0001).
  3771     05  BCAPRM1I PIC  X(0011).
  3772*    -------------------------------
  3773     05  BENABR1L PIC S9(0004) COMP.
  3774     05  BENABR1F PIC  X(0001).
  3775     05  FILLER REDEFINES BENABR1F.
  3776         10  BENABR1A PIC  X(0001).
  3777     05  BENABR1I PIC  X(0005).
  3778*    -------------------------------
  3779     05  BDIFF1L PIC S9(0004) COMP.
  3780     05  BDIFF1F PIC  X(0001).
  3781     05  FILLER REDEFINES BDIFF1F.
  3782         10  BDIFF1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  72
* EL6311.cbl
  3783     05  BDIFF1I PIC  X(0011).
  3784*    -------------------------------
  3785     05  BBILIT1L PIC S9(0004) COMP.
  3786     05  BBILIT1F PIC  X(0001).
  3787     05  FILLER REDEFINES BBILIT1F.
  3788         10  BBILIT1A PIC  X(0001).
  3789     05  BBILIT1I PIC  X(0008).
  3790*    -------------------------------
  3791     05  BADIFF1L PIC S9(0004) COMP.
  3792     05  BADIFF1F PIC  X(0001).
  3793     05  FILLER REDEFINES BADIFF1F.
  3794         10  BADIFF1A PIC  X(0001).
  3795     05  BADIFF1I PIC  X(0011).
  3796*    -------------------------------
  3797     05  BKIND2L PIC S9(0004) COMP.
  3798     05  BKIND2F PIC  X(0001).
  3799     05  FILLER REDEFINES BKIND2F.
  3800         10  BKIND2A PIC  X(0001).
  3801     05  BKIND2I PIC  X(0002).
  3802*    -------------------------------
  3803     05  BTYPE2L PIC S9(0004) COMP.
  3804     05  BTYPE2F PIC  X(0001).
  3805     05  FILLER REDEFINES BTYPE2F.
  3806         10  BTYPE2A PIC  X(0001).
  3807     05  BTYPE2I PIC  X(0003).
  3808*    -------------------------------
  3809     05  BTERM2L PIC S9(0004) COMP.
  3810     05  BTERM2F PIC  X(0001).
  3811     05  FILLER REDEFINES BTERM2F.
  3812         10  BTERM2A PIC  X(0001).
  3813     05  BTERM2I PIC  X(0003).
  3814*    -------------------------------
  3815     05  BBEN2L PIC S9(0004) COMP.
  3816     05  BBEN2F PIC  X(0001).
  3817     05  FILLER REDEFINES BBEN2F.
  3818         10  BBEN2A PIC  X(0001).
  3819     05  BBEN2I PIC  X(0012).
  3820*    -------------------------------
  3821     05  BPREM2L PIC S9(0004) COMP.
  3822     05  BPREM2F PIC  X(0001).
  3823     05  FILLER REDEFINES BPREM2F.
  3824         10  BPREM2A PIC  X(0001).
  3825     05  BPREM2I PIC  X(0011).
  3826*    -------------------------------
  3827     05  BEXPIR2L PIC S9(0004) COMP.
  3828     05  BEXPIR2F PIC  X(0001).
  3829     05  FILLER REDEFINES BEXPIR2F.
  3830         10  BEXPIR2A PIC  X(0001).
  3831     05  BEXPIR2I PIC  X(0008).
  3832*    -------------------------------
  3833     05  BCP2L PIC S9(0004) COMP.
  3834     05  BCP2F PIC  X(0001).
  3835     05  FILLER REDEFINES BCP2F.
  3836         10  BCP2A PIC  X(0001).
  3837     05  BCP2I PIC  X(0002).
  3838*    -------------------------------
  3839     05  BALTBN2L PIC S9(0004) COMP.
  3840     05  BALTBN2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  73
* EL6311.cbl
  3841     05  FILLER REDEFINES BALTBN2F.
  3842         10  BALTBN2A PIC  X(0001).
  3843     05  BALTBN2I PIC  X(0012).
  3844*    -------------------------------
  3845     05  BALTPR2L PIC S9(0004) COMP.
  3846     05  BALTPR2F PIC  X(0001).
  3847     05  FILLER REDEFINES BALTPR2F.
  3848         10  BALTPR2A PIC  X(0001).
  3849     05  BALTPR2I PIC  X(0011).
  3850*    -------------------------------
  3851     05  BBNCD2L PIC S9(0004) COMP.
  3852     05  BBNCD2F PIC  X(0001).
  3853     05  FILLER REDEFINES BBNCD2F.
  3854         10  BBNCD2A PIC  X(0001).
  3855     05  BBNCD2I PIC  X(0003).
  3856*    -------------------------------
  3857     05  BCPRM2L PIC S9(0004) COMP.
  3858     05  BCPRM2F PIC  X(0001).
  3859     05  FILLER REDEFINES BCPRM2F.
  3860         10  BCPRM2A PIC  X(0001).
  3861     05  BCPRM2I PIC  X(0011).
  3862*    -------------------------------
  3863     05  BCAPRM2L PIC S9(0004) COMP.
  3864     05  BCAPRM2F PIC  X(0001).
  3865     05  FILLER REDEFINES BCAPRM2F.
  3866         10  BCAPRM2A PIC  X(0001).
  3867     05  BCAPRM2I PIC  X(0011).
  3868*    -------------------------------
  3869     05  BENABR2L PIC S9(0004) COMP.
  3870     05  BENABR2F PIC  X(0001).
  3871     05  FILLER REDEFINES BENABR2F.
  3872         10  BENABR2A PIC  X(0001).
  3873     05  BENABR2I PIC  X(0005).
  3874*    -------------------------------
  3875     05  BDIFF2L PIC S9(0004) COMP.
  3876     05  BDIFF2F PIC  X(0001).
  3877     05  FILLER REDEFINES BDIFF2F.
  3878         10  BDIFF2A PIC  X(0001).
  3879     05  BDIFF2I PIC  X(0011).
  3880*    -------------------------------
  3881     05  BBILIT2L PIC S9(0004) COMP.
  3882     05  BBILIT2F PIC  X(0001).
  3883     05  FILLER REDEFINES BBILIT2F.
  3884         10  BBILIT2A PIC  X(0001).
  3885     05  BBILIT2I PIC  X(0008).
  3886*    -------------------------------
  3887     05  BADIFF2L PIC S9(0004) COMP.
  3888     05  BADIFF2F PIC  X(0001).
  3889     05  FILLER REDEFINES BADIFF2F.
  3890         10  BADIFF2A PIC  X(0001).
  3891     05  BADIFF2I PIC  X(0011).
  3892*    -------------------------------
  3893     05  BERMSG1L PIC S9(0004) COMP.
  3894     05  BERMSG1F PIC  X(0001).
  3895     05  FILLER REDEFINES BERMSG1F.
  3896         10  BERMSG1A PIC  X(0001).
  3897     05  BERMSG1I PIC  X(0078).
  3898*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  74
* EL6311.cbl
  3899     05  BERMSG2L PIC S9(0004) COMP.
  3900     05  BERMSG2F PIC  X(0001).
  3901     05  FILLER REDEFINES BERMSG2F.
  3902         10  BERMSG2A PIC  X(0001).
  3903     05  BERMSG2I PIC  X(0078).
  3904*    -------------------------------
  3905     05  BERMSG3L PIC S9(0004) COMP.
  3906     05  BERMSG3F PIC  X(0001).
  3907     05  FILLER REDEFINES BERMSG3F.
  3908         10  BERMSG3A PIC  X(0001).
  3909     05  BERMSG3I PIC  X(0078).
  3910*    -------------------------------
  3911     05  BPFENTRL PIC S9(0004) COMP.
  3912     05  BPFENTRF PIC  X(0001).
  3913     05  FILLER REDEFINES BPFENTRF.
  3914         10  BPFENTRA PIC  X(0001).
  3915     05  BPFENTRI PIC  9(2).
  3916*    -------------------------------
  3917     05  BPF5HDRL PIC S9(0004) COMP.
  3918     05  BPF5HDRF PIC  X(0001).
  3919     05  FILLER REDEFINES BPF5HDRF.
  3920         10  BPF5HDRA PIC  X(0001).
  3921     05  BPF5HDRI PIC  X(0005).
  3922*    -------------------------------
  3923     05  BPF4HDRL PIC S9(0004) COMP.
  3924     05  BPF4HDRF PIC  X(0001).
  3925     05  FILLER REDEFINES BPF4HDRF.
  3926         10  BPF4HDRA PIC  X(0001).
  3927     05  BPF4HDRI PIC  X(0013).
  3928*    -------------------------------
  3929     05  BF15HDRL PIC S9(0004) COMP.
  3930     05  BF15HDRF PIC  X(0001).
  3931     05  FILLER REDEFINES BF15HDRF.
  3932         10  BF15HDRA PIC  X(0001).
  3933     05  BF15HDRI PIC  X(0010).
  3934 01  EL631BO REDEFINES EL631BI.
  3935     05  FILLER            PIC  X(0012).
  3936*    -------------------------------
  3937     05  FILLER            PIC  X(0003).
  3938     05  BDATEO PIC  X(0008).
  3939*    -------------------------------
  3940     05  FILLER            PIC  X(0003).
  3941     05  BTIMEO PIC  99.99.
  3942*    -------------------------------
  3943     05  FILLER            PIC  X(0003).
  3944     05  BHEADO PIC  X(0038).
  3945*    -------------------------------
  3946     05  FILLER            PIC  X(0003).
  3947     05  BNCERTLO PIC  X(0008).
  3948*    -------------------------------
  3949     05  FILLER            PIC  X(0003).
  3950     05  BNCERTO PIC  X(0011).
  3951*    -------------------------------
  3952     05  FILLER            PIC  X(0003).
  3953     05  BNSTATLO PIC  X(0009).
  3954*    -------------------------------
  3955     05  FILLER            PIC  X(0003).
  3956     05  BNSTATO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  75
* EL6311.cbl
  3957*    -------------------------------
  3958     05  FILLER            PIC  X(0003).
  3959     05  BCHGTO PIC  X(0004).
  3960*    -------------------------------
  3961     05  FILLER            PIC  X(0003).
  3962     05  BCHGO PIC  ZZZ9.
  3963*    -------------------------------
  3964     05  FILLER            PIC  X(0003).
  3965     05  BMAINTO PIC  X(0001).
  3966*    -------------------------------
  3967     05  FILLER            PIC  X(0003).
  3968     05  BMANTBYO PIC  X(0004).
  3969*    -------------------------------
  3970     05  FILLER            PIC  X(0003).
  3971     05  BCHGHDGO PIC  X(0003).
  3972*    -------------------------------
  3973     05  FILLER            PIC  X(0003).
  3974     05  BMANTDTO PIC  X(0008).
  3975*    -------------------------------
  3976     05  FILLER            PIC  X(0003).
  3977     05  BMANTATO PIC  99.99.
  3978*    -------------------------------
  3979     05  FILLER            PIC  X(0003).
  3980     05  BCSRO PIC  X(0004).
  3981*    -------------------------------
  3982     05  FILLER            PIC  X(0003).
  3983     05  BBATCHO PIC  X(0006).
  3984*    -------------------------------
  3985     05  FILLER            PIC  X(0003).
  3986     05  BSEQO PIC  X(0004).
  3987*    -------------------------------
  3988     05  FILLER            PIC  X(0003).
  3989     05  BMOENDTO PIC  X(0008).
  3990*    -------------------------------
  3991     05  FILLER            PIC  X(0003).
  3992     05  BCARRO PIC  X(0001).
  3993*    -------------------------------
  3994     05  FILLER            PIC  X(0003).
  3995     05  BGROUPO PIC  X(0006).
  3996*    -------------------------------
  3997     05  FILLER            PIC  X(0003).
  3998     05  BSTATEO PIC  X(0002).
  3999*    -------------------------------
  4000     05  FILLER            PIC  X(0003).
  4001     05  BACCTO PIC  X(0010).
  4002*    -------------------------------
  4003     05  FILLER            PIC  X(0003).
  4004     05  BVINHO PIC  X(0004).
  4005*    -------------------------------
  4006     05  FILLER            PIC  X(0003).
  4007     05  BVINO PIC  X(0017).
  4008*    -------------------------------
  4009     05  FILLER            PIC  X(0003).
  4010     05  BREFHDGO PIC  X(0004).
  4011*    -------------------------------
  4012     05  FILLER            PIC  X(0003).
  4013     05  BREFO PIC  X(0012).
  4014*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  76
* EL6311.cbl
  4015     05  FILLER            PIC  X(0003).
  4016     05  BAGEDEFO PIC  X(0004).
  4017*    -------------------------------
  4018     05  FILLER            PIC  X(0003).
  4019     05  BCERTNOO PIC  X(0010).
  4020*    -------------------------------
  4021     05  FILLER            PIC  X(0003).
  4022     05  BSUFIXO PIC  X(0001).
  4023*    -------------------------------
  4024     05  FILLER            PIC  X(0003).
  4025     05  BEFFDTO PIC  X(0008).
  4026*    -------------------------------
  4027     05  FILLER            PIC  X(0003).
  4028     05  BLSTNMO PIC  X(0015).
  4029*    -------------------------------
  4030     05  FILLER            PIC  X(0003).
  4031     05  B1STNMO PIC  X(0010).
  4032*    -------------------------------
  4033     05  FILLER            PIC  X(0003).
  4034     05  BINITO PIC  X(0001).
  4035*    -------------------------------
  4036     05  FILLER            PIC  X(0003).
  4037     05  BSEXO PIC  X(0001).
  4038*    -------------------------------
  4039     05  FILLER            PIC  X(0003).
  4040     05  BAGEO PIC  X(0002).
  4041*    -------------------------------
  4042     05  FILLER            PIC  X(0003).
  4043     05  BBIRTHO PIC  X(0008).
  4044*    -------------------------------
  4045     05  FILLER            PIC  X(0003).
  4046     05  B1STPMTO PIC  X(0008).
  4047*    -------------------------------
  4048     05  FILLER            PIC  X(0003).
  4049     05  BDAYSO PIC  X(0003).
  4050*    -------------------------------
  4051     05  FILLER            PIC  X(0003).
  4052     05  BLNTRMO PIC  X(0003).
  4053*    -------------------------------
  4054     05  FILLER            PIC  X(0003).
  4055     05  BLNOFCRO PIC  X(0005).
  4056*    -------------------------------
  4057     05  FILLER            PIC  X(0003).
  4058     05  BMODEO PIC  X(0001).
  4059*    -------------------------------
  4060     05  FILLER            PIC  X(0003).
  4061     05  BFREQO PIC  X(0002).
  4062*    -------------------------------
  4063     05  FILLER            PIC  X(0003).
  4064     05  BPMTSO PIC  X(0003).
  4065*    -------------------------------
  4066     05  FILLER            PIC  X(0003).
  4067     05  BPMTAMTO PIC  ZZZZZ9.99.
  4068*    -------------------------------
  4069     05  FILLER            PIC  X(0003).
  4070     05  BAPRO PIC  99.9999.
  4071*    -------------------------------
  4072     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  77
* EL6311.cbl
  4073     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4074*    -------------------------------
  4075     05  FILLER            PIC  X(0003).
  4076     05  BMEMCAPO PIC  X(0011).
  4077*    -------------------------------
  4078     05  FILLER            PIC  X(0003).
  4079     05  BORIGHDO PIC  X(0009).
  4080*    -------------------------------
  4081     05  FILLER            PIC  X(0003).
  4082     05  DMDBILO PIC  X(0006).
  4083*    -------------------------------
  4084     05  FILLER            PIC  X(0003).
  4085     05  BFORCEO PIC  X(0001).
  4086*    -------------------------------
  4087     05  FILLER            PIC  X(0003).
  4088     05  BENTRYO PIC  X(0001).
  4089*    -------------------------------
  4090     05  FILLER            PIC  X(0003).
  4091     05  BREINO PIC  X(0001).
  4092*    -------------------------------
  4093     05  FILLER            PIC  X(0003).
  4094     05  BBILCDO PIC  X(0001).
  4095*    -------------------------------
  4096     05  FILLER            PIC  X(0003).
  4097     05  BUNWRITO PIC  X(0001).
  4098*    -------------------------------
  4099     05  FILLER            PIC  X(0003).
  4100     05  BSKPCDO PIC  X(0001).
  4101*    -------------------------------
  4102     05  FILLER            PIC  X(0003).
  4103     05  BINDGRPO PIC  X(0001).
  4104*    -------------------------------
  4105     05  FILLER            PIC  X(0003).
  4106     05  BSIGO PIC  X(0001).
  4107*    -------------------------------
  4108     05  FILLER            PIC  X(0003).
  4109     05  BRTCLSO PIC  X(0002).
  4110*    -------------------------------
  4111     05  FILLER            PIC  X(0003).
  4112     05  BCHGCNTO PIC  X(0003).
  4113*    -------------------------------
  4114     05  FILLER            PIC  X(0003).
  4115     05  BMEMBERO PIC  X(0012).
  4116*    -------------------------------
  4117     05  FILLER            PIC  X(0003).
  4118     05  BORGNOO PIC  X(0006).
  4119*    -------------------------------
  4120     05  FILLER            PIC  X(0003).
  4121     05  BORGSEQO PIC  X(0004).
  4122*    -------------------------------
  4123     05  FILLER            PIC  X(0003).
  4124     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4125*    -------------------------------
  4126     05  FILLER            PIC  X(0003).
  4127     05  BKIND1O PIC  X(0002).
  4128*    -------------------------------
  4129     05  FILLER            PIC  X(0003).
  4130     05  BTYPE1O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  78
* EL6311.cbl
  4131*    -------------------------------
  4132     05  FILLER            PIC  X(0003).
  4133     05  BTERM1O PIC  X(0003).
  4134*    -------------------------------
  4135     05  FILLER            PIC  X(0003).
  4136     05  BBEN1O PIC  X(0012).
  4137*    -------------------------------
  4138     05  FILLER            PIC  X(0003).
  4139     05  BPREM1O PIC  X(0011).
  4140*    -------------------------------
  4141     05  FILLER            PIC  X(0003).
  4142     05  BEXPIR1O PIC  X(0008).
  4143*    -------------------------------
  4144     05  FILLER            PIC  X(0003).
  4145     05  BCP1O PIC  X(0002).
  4146*    -------------------------------
  4147     05  FILLER            PIC  X(0003).
  4148     05  BALTBN1O PIC  X(0012).
  4149*    -------------------------------
  4150     05  FILLER            PIC  X(0003).
  4151     05  BALTPR1O PIC  X(0011).
  4152*    -------------------------------
  4153     05  FILLER            PIC  X(0003).
  4154     05  BBNCD1O PIC  X(0003).
  4155*    -------------------------------
  4156     05  FILLER            PIC  X(0003).
  4157     05  BCPRM1O PIC  X(0011).
  4158*    -------------------------------
  4159     05  FILLER            PIC  X(0003).
  4160     05  BCAPRM1O PIC  X(0011).
  4161*    -------------------------------
  4162     05  FILLER            PIC  X(0003).
  4163     05  BENABR1O PIC  X(0005).
  4164*    -------------------------------
  4165     05  FILLER            PIC  X(0003).
  4166     05  BDIFF1O PIC  X(0011).
  4167*    -------------------------------
  4168     05  FILLER            PIC  X(0003).
  4169     05  BBILIT1O PIC  X(0008).
  4170*    -------------------------------
  4171     05  FILLER            PIC  X(0003).
  4172     05  BADIFF1O PIC  X(0011).
  4173*    -------------------------------
  4174     05  FILLER            PIC  X(0003).
  4175     05  BKIND2O PIC  X(0002).
  4176*    -------------------------------
  4177     05  FILLER            PIC  X(0003).
  4178     05  BTYPE2O PIC  X(0003).
  4179*    -------------------------------
  4180     05  FILLER            PIC  X(0003).
  4181     05  BTERM2O PIC  X(0003).
  4182*    -------------------------------
  4183     05  FILLER            PIC  X(0003).
  4184     05  BBEN2O PIC  X(0012).
  4185*    -------------------------------
  4186     05  FILLER            PIC  X(0003).
  4187     05  BPREM2O PIC  X(0011).
  4188*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  79
* EL6311.cbl
  4189     05  FILLER            PIC  X(0003).
  4190     05  BEXPIR2O PIC  X(0008).
  4191*    -------------------------------
  4192     05  FILLER            PIC  X(0003).
  4193     05  BCP2O PIC  X(0002).
  4194*    -------------------------------
  4195     05  FILLER            PIC  X(0003).
  4196     05  BALTBN2O PIC  X(0012).
  4197*    -------------------------------
  4198     05  FILLER            PIC  X(0003).
  4199     05  BALTPR2O PIC  X(0011).
  4200*    -------------------------------
  4201     05  FILLER            PIC  X(0003).
  4202     05  BBNCD2O PIC  X(0003).
  4203*    -------------------------------
  4204     05  FILLER            PIC  X(0003).
  4205     05  BCPRM2O PIC  X(0011).
  4206*    -------------------------------
  4207     05  FILLER            PIC  X(0003).
  4208     05  BCAPRM2O PIC  X(0011).
  4209*    -------------------------------
  4210     05  FILLER            PIC  X(0003).
  4211     05  BENABR2O PIC  X(0005).
  4212*    -------------------------------
  4213     05  FILLER            PIC  X(0003).
  4214     05  BDIFF2O PIC  X(0011).
  4215*    -------------------------------
  4216     05  FILLER            PIC  X(0003).
  4217     05  BBILIT2O PIC  X(0008).
  4218*    -------------------------------
  4219     05  FILLER            PIC  X(0003).
  4220     05  BADIFF2O PIC  X(0011).
  4221*    -------------------------------
  4222     05  FILLER            PIC  X(0003).
  4223     05  BERMSG1O PIC  X(0078).
  4224*    -------------------------------
  4225     05  FILLER            PIC  X(0003).
  4226     05  BERMSG2O PIC  X(0078).
  4227*    -------------------------------
  4228     05  FILLER            PIC  X(0003).
  4229     05  BERMSG3O PIC  X(0078).
  4230*    -------------------------------
  4231     05  FILLER            PIC  X(0003).
  4232     05  BPFENTRO PIC  X(0002).
  4233*    -------------------------------
  4234     05  FILLER            PIC  X(0003).
  4235     05  BPF5HDRO PIC  X(0005).
  4236*    -------------------------------
  4237     05  FILLER            PIC  X(0003).
  4238     05  BPF4HDRO PIC  X(0013).
  4239*    -------------------------------
  4240     05  FILLER            PIC  X(0003).
  4241     05  BF15HDRO PIC  X(0010).
  4242*    -------------------------------
  4243 01  EL631CI REDEFINES EL631BI.
  4244     05  FILLER            PIC  X(0012).
  4245*    -------------------------------
  4246     05  CDATEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  80
* EL6311.cbl
  4247     05  CDATEF PIC  X(0001).
  4248     05  FILLER REDEFINES CDATEF.
  4249         10  CDATEA PIC  X(0001).
  4250     05  CDATEI PIC  X(0008).
  4251*    -------------------------------
  4252     05  CTIMEL PIC S9(0004) COMP.
  4253     05  CTIMEF PIC  X(0001).
  4254     05  FILLER REDEFINES CTIMEF.
  4255         10  CTIMEA PIC  X(0001).
  4256     05  CTIMEI PIC  X(0005).
  4257*    -------------------------------
  4258     05  CHEADL PIC S9(0004) COMP.
  4259     05  CHEADF PIC  X(0001).
  4260     05  FILLER REDEFINES CHEADF.
  4261         10  CHEADA PIC  X(0001).
  4262     05  CHEADI PIC  X(0038).
  4263*    -------------------------------
  4264     05  CCHGTL PIC S9(0004) COMP.
  4265     05  CCHGTF PIC  X(0001).
  4266     05  FILLER REDEFINES CCHGTF.
  4267         10  CCHGTA PIC  X(0001).
  4268     05  CCHGTI PIC  X(0004).
  4269*    -------------------------------
  4270     05  CCHGL PIC S9(0004) COMP.
  4271     05  CCHGF PIC  X(0001).
  4272     05  FILLER REDEFINES CCHGF.
  4273         10  CCHGA PIC  X(0001).
  4274     05  CCHGI PIC  X(0004).
  4275*    -------------------------------
  4276     05  CMAINTL PIC S9(0004) COMP.
  4277     05  CMAINTF PIC  X(0001).
  4278     05  FILLER REDEFINES CMAINTF.
  4279         10  CMAINTA PIC  X(0001).
  4280     05  CMAINTI PIC  X(0001).
  4281*    -------------------------------
  4282     05  CMANTBYL PIC S9(0004) COMP.
  4283     05  CMANTBYF PIC  X(0001).
  4284     05  FILLER REDEFINES CMANTBYF.
  4285         10  CMANTBYA PIC  X(0001).
  4286     05  CMANTBYI PIC  X(0004).
  4287*    -------------------------------
  4288     05  CCHGHDGL PIC S9(0004) COMP.
  4289     05  CCHGHDGF PIC  X(0001).
  4290     05  FILLER REDEFINES CCHGHDGF.
  4291         10  CCHGHDGA PIC  X(0001).
  4292     05  CCHGHDGI PIC  X(0003).
  4293*    -------------------------------
  4294     05  CMANTDTL PIC S9(0004) COMP.
  4295     05  CMANTDTF PIC  X(0001).
  4296     05  FILLER REDEFINES CMANTDTF.
  4297         10  CMANTDTA PIC  X(0001).
  4298     05  CMANTDTI PIC  X(0008).
  4299*    -------------------------------
  4300     05  CMANTATL PIC S9(0004) COMP.
  4301     05  CMANTATF PIC  X(0001).
  4302     05  FILLER REDEFINES CMANTATF.
  4303         10  CMANTATA PIC  X(0001).
  4304     05  CMANTATI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  81
* EL6311.cbl
  4305*    -------------------------------
  4306     05  CCSRL PIC S9(0004) COMP.
  4307     05  CCSRF PIC  X(0001).
  4308     05  FILLER REDEFINES CCSRF.
  4309         10  CCSRA PIC  X(0001).
  4310     05  CCSRI PIC  X(0004).
  4311*    -------------------------------
  4312     05  CBATCHL PIC S9(0004) COMP.
  4313     05  CBATCHF PIC  X(0001).
  4314     05  FILLER REDEFINES CBATCHF.
  4315         10  CBATCHA PIC  X(0001).
  4316     05  CBATCHI PIC  X(0006).
  4317*    -------------------------------
  4318     05  CSEQL PIC S9(0004) COMP.
  4319     05  CSEQF PIC  X(0001).
  4320     05  FILLER REDEFINES CSEQF.
  4321         10  CSEQA PIC  X(0001).
  4322     05  CSEQI PIC  X(0004).
  4323*    -------------------------------
  4324     05  CMOENDTL PIC S9(0004) COMP.
  4325     05  CMOENDTF PIC  X(0001).
  4326     05  FILLER REDEFINES CMOENDTF.
  4327         10  CMOENDTA PIC  X(0001).
  4328     05  CMOENDTI PIC  X(0008).
  4329*    -------------------------------
  4330     05  CCARRL PIC S9(0004) COMP.
  4331     05  CCARRF PIC  X(0001).
  4332     05  FILLER REDEFINES CCARRF.
  4333         10  CCARRA PIC  X(0001).
  4334     05  CCARRI PIC  X(0001).
  4335*    -------------------------------
  4336     05  CGROUPL PIC S9(0004) COMP.
  4337     05  CGROUPF PIC  X(0001).
  4338     05  FILLER REDEFINES CGROUPF.
  4339         10  CGROUPA PIC  X(0001).
  4340     05  CGROUPI PIC  X(0006).
  4341*    -------------------------------
  4342     05  CSTATEL PIC S9(0004) COMP.
  4343     05  CSTATEF PIC  X(0001).
  4344     05  FILLER REDEFINES CSTATEF.
  4345         10  CSTATEA PIC  X(0001).
  4346     05  CSTATEI PIC  X(0002).
  4347*    -------------------------------
  4348     05  CACCTL PIC S9(0004) COMP.
  4349     05  CACCTF PIC  X(0001).
  4350     05  FILLER REDEFINES CACCTF.
  4351         10  CACCTA PIC  X(0001).
  4352     05  CACCTI PIC  X(0010).
  4353*    -------------------------------
  4354     05  CORIGHDL PIC S9(0004) COMP.
  4355     05  CORIGHDF PIC  X(0001).
  4356     05  FILLER REDEFINES CORIGHDF.
  4357         10  CORIGHDA PIC  X(0001).
  4358     05  CORIGHDI PIC  X(0011).
  4359*    -------------------------------
  4360     05  CORGNOL PIC S9(0004) COMP.
  4361     05  CORGNOF PIC  X(0001).
  4362     05  FILLER REDEFINES CORGNOF.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  82
* EL6311.cbl
  4363         10  CORGNOA PIC  X(0001).
  4364     05  CORGNOI PIC  X(0006).
  4365*    -------------------------------
  4366     05  CORGSEQL PIC S9(0004) COMP.
  4367     05  CORGSEQF PIC  X(0001).
  4368     05  FILLER REDEFINES CORGSEQF.
  4369         10  CORGSEQA PIC  X(0001).
  4370     05  CORGSEQI PIC  X(0004).
  4371*    -------------------------------
  4372     05  CREFHDGL PIC S9(0004) COMP.
  4373     05  CREFHDGF PIC  X(0001).
  4374     05  FILLER REDEFINES CREFHDGF.
  4375         10  CREFHDGA PIC  X(0001).
  4376     05  CREFHDGI PIC  X(0010).
  4377*    -------------------------------
  4378     05  CREFL PIC S9(0004) COMP.
  4379     05  CREFF PIC  X(0001).
  4380     05  FILLER REDEFINES CREFF.
  4381         10  CREFA PIC  X(0001).
  4382     05  CREFI PIC  X(0012).
  4383*    -------------------------------
  4384     05  CNHINTL PIC S9(0004) COMP.
  4385     05  CNHINTF PIC  X(0001).
  4386     05  FILLER REDEFINES CNHINTF.
  4387         10  CNHINTA PIC  X(0001).
  4388     05  CNHINTI PIC  9(7)V99.
  4389*    -------------------------------
  4390     05  CCERTNOL PIC S9(0004) COMP.
  4391     05  CCERTNOF PIC  X(0001).
  4392     05  FILLER REDEFINES CCERTNOF.
  4393         10  CCERTNOA PIC  X(0001).
  4394     05  CCERTNOI PIC  X(0010).
  4395*    -------------------------------
  4396     05  CSUFIXL PIC S9(0004) COMP.
  4397     05  CSUFIXF PIC  X(0001).
  4398     05  FILLER REDEFINES CSUFIXF.
  4399         10  CSUFIXA PIC  X(0001).
  4400     05  CSUFIXI PIC  X(0001).
  4401*    -------------------------------
  4402     05  CEFFDTL PIC S9(0004) COMP.
  4403     05  CEFFDTF PIC  X(0001).
  4404     05  FILLER REDEFINES CEFFDTF.
  4405         10  CEFFDTA PIC  X(0001).
  4406     05  CEFFDTI PIC  X(0008).
  4407*    -------------------------------
  4408     05  CLSTNML PIC S9(0004) COMP.
  4409     05  CLSTNMF PIC  X(0001).
  4410     05  FILLER REDEFINES CLSTNMF.
  4411         10  CLSTNMA PIC  X(0001).
  4412     05  CLSTNMI PIC  X(0015).
  4413*    -------------------------------
  4414     05  CPCYNL PIC S9(0004) COMP.
  4415     05  CPCYNF PIC  X(0001).
  4416     05  FILLER REDEFINES CPCYNF.
  4417         10  CPCYNA PIC  X(0001).
  4418     05  CPCYNI PIC  X(0001).
  4419*    -------------------------------
  4420     05  CINAMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  83
* EL6311.cbl
  4421     05  CINAMEF PIC  X(0001).
  4422     05  FILLER REDEFINES CINAMEF.
  4423         10  CINAMEA PIC  X(0001).
  4424     05  CINAMEI PIC  X(0015).
  4425*    -------------------------------
  4426     05  CINITSL PIC S9(0004) COMP.
  4427     05  CINITSF PIC  X(0001).
  4428     05  FILLER REDEFINES CINITSF.
  4429         10  CINITSA PIC  X(0001).
  4430     05  CINITSI PIC  X(0010).
  4431*    -------------------------------
  4432     05  CCANREAL PIC S9(0004) COMP.
  4433     05  CCANREAF PIC  X(0001).
  4434     05  FILLER REDEFINES CCANREAF.
  4435         10  CCANREAA PIC  X(0001).
  4436     05  CCANREAI PIC  X(0001).
  4437*    -------------------------------
  4438     05  CKIND1L PIC S9(0004) COMP.
  4439     05  CKIND1F PIC  X(0001).
  4440     05  FILLER REDEFINES CKIND1F.
  4441         10  CKIND1A PIC  X(0001).
  4442     05  CKIND1I PIC  X(0002).
  4443*    -------------------------------
  4444     05  CCANDT1L PIC S9(0004) COMP.
  4445     05  CCANDT1F PIC  X(0001).
  4446     05  FILLER REDEFINES CCANDT1F.
  4447         10  CCANDT1A PIC  X(0001).
  4448     05  CCANDT1I PIC  X(0008).
  4449*    -------------------------------
  4450     05  CREFND1L PIC S9(0004) COMP.
  4451     05  CREFND1F PIC  X(0001).
  4452     05  FILLER REDEFINES CREFND1F.
  4453         10  CREFND1A PIC  X(0001).
  4454     05  CREFND1I PIC  S9(9)V99.
  4455*    -------------------------------
  4456     05  CMTHD1L PIC S9(0004) COMP.
  4457     05  CMTHD1F PIC  X(0001).
  4458     05  FILLER REDEFINES CMTHD1F.
  4459         10  CMTHD1A PIC  X(0001).
  4460     05  CMTHD1I PIC  X(0001).
  4461*    -------------------------------
  4462     05  CKIND2L PIC S9(0004) COMP.
  4463     05  CKIND2F PIC  X(0001).
  4464     05  FILLER REDEFINES CKIND2F.
  4465         10  CKIND2A PIC  X(0001).
  4466     05  CKIND2I PIC  X(0002).
  4467*    -------------------------------
  4468     05  CCANDT2L PIC S9(0004) COMP.
  4469     05  CCANDT2F PIC  X(0001).
  4470     05  FILLER REDEFINES CCANDT2F.
  4471         10  CCANDT2A PIC  X(0001).
  4472     05  CCANDT2I PIC  X(0008).
  4473*    -------------------------------
  4474     05  CREFND2L PIC S9(0004) COMP.
  4475     05  CREFND2F PIC  X(0001).
  4476     05  FILLER REDEFINES CREFND2F.
  4477         10  CREFND2A PIC  X(0001).
  4478     05  CREFND2I PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  84
* EL6311.cbl
  4479*    -------------------------------
  4480     05  CMTHD2L PIC S9(0004) COMP.
  4481     05  CMTHD2F PIC  X(0001).
  4482     05  FILLER REDEFINES CMTHD2F.
  4483         10  CMTHD2A PIC  X(0001).
  4484     05  CMTHD2I PIC  X(0001).
  4485*    -------------------------------
  4486     05  CLIVESL PIC S9(0004) COMP.
  4487     05  CLIVESF PIC  X(0001).
  4488     05  FILLER REDEFINES CLIVESF.
  4489         10  CLIVESA PIC  X(0001).
  4490     05  CLIVESI PIC  X(0003).
  4491*    -------------------------------
  4492     05  CFORCEL PIC S9(0004) COMP.
  4493     05  CFORCEF PIC  X(0001).
  4494     05  FILLER REDEFINES CFORCEF.
  4495         10  CFORCEA PIC  X(0001).
  4496     05  CFORCEI PIC  X(0001).
  4497*    -------------------------------
  4498     05  CBILCDL PIC S9(0004) COMP.
  4499     05  CBILCDF PIC  X(0001).
  4500     05  FILLER REDEFINES CBILCDF.
  4501         10  CBILCDA PIC  X(0001).
  4502     05  CBILCDI PIC  X(0001).
  4503*    -------------------------------
  4504     05  CCRFND1L PIC S9(0004) COMP.
  4505     05  CCRFND1F PIC  X(0001).
  4506     05  FILLER REDEFINES CCRFND1F.
  4507         10  CCRFND1A PIC  X(0001).
  4508     05  CCRFND1I PIC  X(0011).
  4509*    -------------------------------
  4510     05  CCRFND2L PIC S9(0004) COMP.
  4511     05  CCRFND2F PIC  X(0001).
  4512     05  FILLER REDEFINES CCRFND2F.
  4513         10  CCRFND2A PIC  X(0001).
  4514     05  CCRFND2I PIC  X(0011).
  4515*    -------------------------------
  4516     05  CBILIT1L PIC S9(0004) COMP.
  4517     05  CBILIT1F PIC  X(0001).
  4518     05  FILLER REDEFINES CBILIT1F.
  4519         10  CBILIT1A PIC  X(0001).
  4520     05  CBILIT1I PIC  X(0008).
  4521*    -------------------------------
  4522     05  CDRFND1L PIC S9(0004) COMP.
  4523     05  CDRFND1F PIC  X(0001).
  4524     05  FILLER REDEFINES CDRFND1F.
  4525         10  CDRFND1A PIC  X(0001).
  4526     05  CDRFND1I PIC  X(0011).
  4527*    -------------------------------
  4528     05  CBILIT2L PIC S9(0004) COMP.
  4529     05  CBILIT2F PIC  X(0001).
  4530     05  FILLER REDEFINES CBILIT2F.
  4531         10  CBILIT2A PIC  X(0001).
  4532     05  CBILIT2I PIC  X(0008).
  4533*    -------------------------------
  4534     05  CDRFND2L PIC S9(0004) COMP.
  4535     05  CDRFND2F PIC  X(0001).
  4536     05  FILLER REDEFINES CDRFND2F.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  85
* EL6311.cbl
  4537         10  CDRFND2A PIC  X(0001).
  4538     05  CDRFND2I PIC  X(0011).
  4539*    -------------------------------
  4540     05  CCANTXTL PIC S9(0004) COMP.
  4541     05  CCANTXTF PIC  X(0001).
  4542     05  FILLER REDEFINES CCANTXTF.
  4543         10  CCANTXTA PIC  X(0001).
  4544     05  CCANTXTI PIC  X(0005).
  4545*    -------------------------------
  4546     05  CCANFEEL PIC S9(0004) COMP.
  4547     05  CCANFEEF PIC  X(0001).
  4548     05  FILLER REDEFINES CCANFEEF.
  4549         10  CCANFEEA PIC  X(0001).
  4550     05  CCANFEEI PIC  X(0002).
  4551*    -------------------------------
  4552     05  CTERM1L PIC S9(0004) COMP.
  4553     05  CTERM1F PIC  X(0001).
  4554     05  FILLER REDEFINES CTERM1F.
  4555         10  CTERM1A PIC  X(0001).
  4556     05  CTERM1I PIC  X(0003).
  4557*    -------------------------------
  4558     05  CRTERM1L PIC S9(0004) COMP.
  4559     05  CRTERM1F PIC  X(0001).
  4560     05  FILLER REDEFINES CRTERM1F.
  4561         10  CRTERM1A PIC  X(0001).
  4562     05  CRTERM1I PIC  X(0003).
  4563*    -------------------------------
  4564     05  CPREM1L PIC S9(0004) COMP.
  4565     05  CPREM1F PIC  X(0001).
  4566     05  FILLER REDEFINES CPREM1F.
  4567         10  CPREM1A PIC  X(0001).
  4568     05  CPREM1I PIC  X(0011).
  4569*    -------------------------------
  4570     05  CTERM2L PIC S9(0004) COMP.
  4571     05  CTERM2F PIC  X(0001).
  4572     05  FILLER REDEFINES CTERM2F.
  4573         10  CTERM2A PIC  X(0001).
  4574     05  CTERM2I PIC  X(0003).
  4575*    -------------------------------
  4576     05  CRTERM2L PIC S9(0004) COMP.
  4577     05  CRTERM2F PIC  X(0001).
  4578     05  FILLER REDEFINES CRTERM2F.
  4579         10  CRTERM2A PIC  X(0001).
  4580     05  CRTERM2I PIC  X(0003).
  4581*    -------------------------------
  4582     05  CPREM2L PIC S9(0004) COMP.
  4583     05  CPREM2F PIC  X(0001).
  4584     05  FILLER REDEFINES CPREM2F.
  4585         10  CPREM2A PIC  X(0001).
  4586     05  CPREM2I PIC  X(0011).
  4587*    -------------------------------
  4588     05  CENTRDTL PIC S9(0004) COMP.
  4589     05  CENTRDTF PIC  X(0001).
  4590     05  FILLER REDEFINES CENTRDTF.
  4591         10  CENTRDTA PIC  X(0001).
  4592     05  CENTRDTI PIC  X(0008).
  4593*    -------------------------------
  4594     05  CPAYEEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  86
* EL6311.cbl
  4595     05  CPAYEEF PIC  X(0001).
  4596     05  FILLER REDEFINES CPAYEEF.
  4597         10  CPAYEEA PIC  X(0001).
  4598     05  CPAYEEI PIC  X(0006).
  4599*    -------------------------------
  4600     05  CRFNDSWL PIC S9(0004) COMP.
  4601     05  CRFNDSWF PIC  X(0001).
  4602     05  FILLER REDEFINES CRFNDSWF.
  4603         10  CRFNDSWA PIC  X(0001).
  4604     05  CRFNDSWI PIC  X(0003).
  4605*    -------------------------------
  4606     05  CLFHDGL PIC S9(0004) COMP.
  4607     05  CLFHDGF PIC  X(0001).
  4608     05  FILLER REDEFINES CLFHDGF.
  4609         10  CLFHDGA PIC  X(0001).
  4610     05  CLFHDGI PIC  X(0006).
  4611*    -------------------------------
  4612     05  CAHHDGL PIC S9(0004) COMP.
  4613     05  CAHHDGF PIC  X(0001).
  4614     05  FILLER REDEFINES CAHHDGF.
  4615         10  CAHHDGA PIC  X(0001).
  4616     05  CAHHDGI PIC  X(0006).
  4617*    -------------------------------
  4618     05  CENTDTL PIC S9(0004) COMP.
  4619     05  CENTDTF PIC  X(0001).
  4620     05  FILLER REDEFINES CENTDTF.
  4621         10  CENTDTA PIC  X(0001).
  4622     05  CENTDTI PIC  X(0008).
  4623*    -------------------------------
  4624     05  CENTBYL PIC S9(0004) COMP.
  4625     05  CENTBYF PIC  X(0001).
  4626     05  FILLER REDEFINES CENTBYF.
  4627         10  CENTBYA PIC  X(0001).
  4628     05  CENTBYI PIC  X(0004).
  4629*    -------------------------------
  4630     05  CCHGCNTL PIC S9(0004) COMP.
  4631     05  CCHGCNTF PIC  X(0001).
  4632     05  FILLER REDEFINES CCHGCNTF.
  4633         10  CCHGCNTA PIC  X(0001).
  4634     05  CCHGCNTI PIC  X(0003).
  4635*    -------------------------------
  4636     05  CLFREFNL PIC S9(0004) COMP.
  4637     05  CLFREFNF PIC  X(0001).
  4638     05  FILLER REDEFINES CLFREFNF.
  4639         10  CLFREFNA PIC  X(0001).
  4640     05  CLFREFNI PIC  X(0006).
  4641*    -------------------------------
  4642     05  CAHREFNL PIC S9(0004) COMP.
  4643     05  CAHREFNF PIC  X(0001).
  4644     05  FILLER REDEFINES CAHREFNF.
  4645         10  CAHREFNA PIC  X(0001).
  4646     05  CAHREFNI PIC  X(0006).
  4647*    -------------------------------
  4648     05  CREINCDL PIC S9(0004) COMP.
  4649     05  CREINCDF PIC  X(0001).
  4650     05  FILLER REDEFINES CREINCDF.
  4651         10  CREINCDA PIC  X(0001).
  4652     05  CREINCDI PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  87
* EL6311.cbl
  4653*    -------------------------------
  4654     05  CAEFFDTL PIC S9(0004) COMP.
  4655     05  CAEFFDTF PIC  X(0001).
  4656     05  FILLER REDEFINES CAEFFDTF.
  4657         10  CAEFFDTA PIC  X(0001).
  4658     05  CAEFFDTI PIC  X(0008).
  4659*    -------------------------------
  4660     05  CAEXPDTL PIC S9(0004) COMP.
  4661     05  CAEXPDTF PIC  X(0001).
  4662     05  FILLER REDEFINES CAEXPDTF.
  4663         10  CAEXPDTA PIC  X(0001).
  4664     05  CAEXPDTI PIC  X(0008).
  4665*    -------------------------------
  4666     05  COMMLFL PIC S9(0004) COMP.
  4667     05  COMMLFF PIC  X(0001).
  4668     05  FILLER REDEFINES COMMLFF.
  4669         10  COMMLFA PIC  X(0001).
  4670     05  COMMLFI PIC  X(0006).
  4671*    -------------------------------
  4672     05  COMMAHL PIC S9(0004) COMP.
  4673     05  COMMAHF PIC  X(0001).
  4674     05  FILLER REDEFINES COMMAHF.
  4675         10  COMMAHA PIC  X(0001).
  4676     05  COMMAHI PIC  X(0006).
  4677*    -------------------------------
  4678     05  CERMSG1L PIC S9(0004) COMP.
  4679     05  CERMSG1F PIC  X(0001).
  4680     05  FILLER REDEFINES CERMSG1F.
  4681         10  CERMSG1A PIC  X(0001).
  4682     05  CERMSG1I PIC  X(0078).
  4683*    -------------------------------
  4684     05  CERMSG2L PIC S9(0004) COMP.
  4685     05  CERMSG2F PIC  X(0001).
  4686     05  FILLER REDEFINES CERMSG2F.
  4687         10  CERMSG2A PIC  X(0001).
  4688     05  CERMSG2I PIC  X(0078).
  4689*    -------------------------------
  4690     05  CERMSG3L PIC S9(0004) COMP.
  4691     05  CERMSG3F PIC  X(0001).
  4692     05  FILLER REDEFINES CERMSG3F.
  4693         10  CERMSG3A PIC  X(0001).
  4694     05  CERMSG3I PIC  X(0078).
  4695*    -------------------------------
  4696     05  CPFENTRL PIC S9(0004) COMP.
  4697     05  CPFENTRF PIC  X(0001).
  4698     05  FILLER REDEFINES CPFENTRF.
  4699         10  CPFENTRA PIC  X(0001).
  4700     05  CPFENTRI PIC  9(2).
  4701*    -------------------------------
  4702     05  CPF5HDRL PIC S9(0004) COMP.
  4703     05  CPF5HDRF PIC  X(0001).
  4704     05  FILLER REDEFINES CPF5HDRF.
  4705         10  CPF5HDRA PIC  X(0001).
  4706     05  CPF5HDRI PIC  X(0005).
  4707*    -------------------------------
  4708     05  CPF4HDRL PIC S9(0004) COMP.
  4709     05  CPF4HDRF PIC  X(0001).
  4710     05  FILLER REDEFINES CPF4HDRF.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  88
* EL6311.cbl
  4711         10  CPF4HDRA PIC  X(0001).
  4712     05  CPF4HDRI PIC  X(0013).
  4713*    -------------------------------
  4714     05  CF15HDRL PIC S9(0004) COMP.
  4715     05  CF15HDRF PIC  X(0001).
  4716     05  FILLER REDEFINES CF15HDRF.
  4717         10  CF15HDRA PIC  X(0001).
  4718     05  CF15HDRI PIC  X(0022).
  4719 01  EL631CO REDEFINES EL631BI.
  4720     05  FILLER            PIC  X(0012).
  4721*    -------------------------------
  4722     05  FILLER            PIC  X(0003).
  4723     05  CDATEO PIC  X(0008).
  4724*    -------------------------------
  4725     05  FILLER            PIC  X(0003).
  4726     05  CTIMEO PIC  99.99.
  4727*    -------------------------------
  4728     05  FILLER            PIC  X(0003).
  4729     05  CHEADO PIC  X(0038).
  4730*    -------------------------------
  4731     05  FILLER            PIC  X(0003).
  4732     05  CCHGTO PIC  X(0004).
  4733*    -------------------------------
  4734     05  FILLER            PIC  X(0003).
  4735     05  CCHGO PIC  ZZZ9.
  4736*    -------------------------------
  4737     05  FILLER            PIC  X(0003).
  4738     05  CMAINTO PIC  X(0001).
  4739*    -------------------------------
  4740     05  FILLER            PIC  X(0003).
  4741     05  CMANTBYO PIC  X(0004).
  4742*    -------------------------------
  4743     05  FILLER            PIC  X(0003).
  4744     05  CCHGHDGO PIC  X(0003).
  4745*    -------------------------------
  4746     05  FILLER            PIC  X(0003).
  4747     05  CMANTDTO PIC  X(0008).
  4748*    -------------------------------
  4749     05  FILLER            PIC  X(0003).
  4750     05  CMANTATO PIC  99.99.
  4751*    -------------------------------
  4752     05  FILLER            PIC  X(0003).
  4753     05  CCSRO PIC  X(0004).
  4754*    -------------------------------
  4755     05  FILLER            PIC  X(0003).
  4756     05  CBATCHO PIC  X(0006).
  4757*    -------------------------------
  4758     05  FILLER            PIC  X(0003).
  4759     05  CSEQO PIC  X(0004).
  4760*    -------------------------------
  4761     05  FILLER            PIC  X(0003).
  4762     05  CMOENDTO PIC  X(0008).
  4763*    -------------------------------
  4764     05  FILLER            PIC  X(0003).
  4765     05  CCARRO PIC  X(0001).
  4766*    -------------------------------
  4767     05  FILLER            PIC  X(0003).
  4768     05  CGROUPO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  89
* EL6311.cbl
  4769*    -------------------------------
  4770     05  FILLER            PIC  X(0003).
  4771     05  CSTATEO PIC  X(0002).
  4772*    -------------------------------
  4773     05  FILLER            PIC  X(0003).
  4774     05  CACCTO PIC  X(0010).
  4775*    -------------------------------
  4776     05  FILLER            PIC  X(0003).
  4777     05  CORIGHDO PIC  X(0011).
  4778*    -------------------------------
  4779     05  FILLER            PIC  X(0003).
  4780     05  CORGNOO PIC  X(0006).
  4781*    -------------------------------
  4782     05  FILLER            PIC  X(0003).
  4783     05  CORGSEQO PIC  X(0004).
  4784*    -------------------------------
  4785     05  FILLER            PIC  X(0003).
  4786     05  CREFHDGO PIC  X(0010).
  4787*    -------------------------------
  4788     05  FILLER            PIC  X(0003).
  4789     05  CREFO PIC  X(0012).
  4790*    -------------------------------
  4791     05  FILLER            PIC  X(0003).
  4792     05  CNHINTO PIC  999999.99.
  4793*    -------------------------------
  4794     05  FILLER            PIC  X(0003).
  4795     05  CCERTNOO PIC  X(0010).
  4796*    -------------------------------
  4797     05  FILLER            PIC  X(0003).
  4798     05  CSUFIXO PIC  X(0001).
  4799*    -------------------------------
  4800     05  FILLER            PIC  X(0003).
  4801     05  CEFFDTO PIC  X(0008).
  4802*    -------------------------------
  4803     05  FILLER            PIC  X(0003).
  4804     05  CLSTNMO PIC  X(0015).
  4805*    -------------------------------
  4806     05  FILLER            PIC  X(0003).
  4807     05  CPCYNO PIC  X(0001).
  4808*    -------------------------------
  4809     05  FILLER            PIC  X(0003).
  4810     05  CINAMEO PIC  X(0015).
  4811*    -------------------------------
  4812     05  FILLER            PIC  X(0003).
  4813     05  CINITSO PIC  X(0010).
  4814*    -------------------------------
  4815     05  FILLER            PIC  X(0003).
  4816     05  CCANREAO PIC  X(0001).
  4817*    -------------------------------
  4818     05  FILLER            PIC  X(0003).
  4819     05  CKIND1O PIC  X(0002).
  4820*    -------------------------------
  4821     05  FILLER            PIC  X(0003).
  4822     05  CCANDT1O PIC  X(0008).
  4823*    -------------------------------
  4824     05  FILLER            PIC  X(0003).
  4825     05  CREFND1O PIC  Z(7).99-.
  4826*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  90
* EL6311.cbl
  4827     05  FILLER            PIC  X(0003).
  4828     05  CMTHD1O PIC  X(0001).
  4829*    -------------------------------
  4830     05  FILLER            PIC  X(0003).
  4831     05  CKIND2O PIC  X(0002).
  4832*    -------------------------------
  4833     05  FILLER            PIC  X(0003).
  4834     05  CCANDT2O PIC  X(0008).
  4835*    -------------------------------
  4836     05  FILLER            PIC  X(0003).
  4837     05  CREFND2O PIC  Z(7).99-.
  4838*    -------------------------------
  4839     05  FILLER            PIC  X(0003).
  4840     05  CMTHD2O PIC  X(0001).
  4841*    -------------------------------
  4842     05  FILLER            PIC  X(0003).
  4843     05  CLIVESO PIC  X(0003).
  4844*    -------------------------------
  4845     05  FILLER            PIC  X(0003).
  4846     05  CFORCEO PIC  X(0001).
  4847*    -------------------------------
  4848     05  FILLER            PIC  X(0003).
  4849     05  CBILCDO PIC  X(0001).
  4850*    -------------------------------
  4851     05  FILLER            PIC  X(0003).
  4852     05  CCRFND1O PIC  Z(7).99-.
  4853*    -------------------------------
  4854     05  FILLER            PIC  X(0003).
  4855     05  CCRFND2O PIC  Z(7).99-.
  4856*    -------------------------------
  4857     05  FILLER            PIC  X(0003).
  4858     05  CBILIT1O PIC  X(0008).
  4859*    -------------------------------
  4860     05  FILLER            PIC  X(0003).
  4861     05  CDRFND1O PIC  Z(7).99-.
  4862*    -------------------------------
  4863     05  FILLER            PIC  X(0003).
  4864     05  CBILIT2O PIC  X(0008).
  4865*    -------------------------------
  4866     05  FILLER            PIC  X(0003).
  4867     05  CDRFND2O PIC  Z(7).99-.
  4868*    -------------------------------
  4869     05  FILLER            PIC  X(0003).
  4870     05  CCANTXTO PIC  X(0005).
  4871*    -------------------------------
  4872     05  FILLER            PIC  X(0003).
  4873     05  CCANFEEO PIC  Z9.
  4874*    -------------------------------
  4875     05  FILLER            PIC  X(0003).
  4876     05  CTERM1O PIC  ZZ9.
  4877*    -------------------------------
  4878     05  FILLER            PIC  X(0003).
  4879     05  CRTERM1O PIC  ZZ9.
  4880*    -------------------------------
  4881     05  FILLER            PIC  X(0003).
  4882     05  CPREM1O PIC  ZZZZZZ9.99-.
  4883*    -------------------------------
  4884     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  91
* EL6311.cbl
  4885     05  CTERM2O PIC  ZZ9.
  4886*    -------------------------------
  4887     05  FILLER            PIC  X(0003).
  4888     05  CRTERM2O PIC  ZZ9.
  4889*    -------------------------------
  4890     05  FILLER            PIC  X(0003).
  4891     05  CPREM2O PIC  ZZZZZZ9.99-.
  4892*    -------------------------------
  4893     05  FILLER            PIC  X(0003).
  4894     05  CENTRDTO PIC  X(0008).
  4895*    -------------------------------
  4896     05  FILLER            PIC  X(0003).
  4897     05  CPAYEEO PIC  X(0006).
  4898*    -------------------------------
  4899     05  FILLER            PIC  X(0003).
  4900     05  CRFNDSWO PIC  X(0003).
  4901*    -------------------------------
  4902     05  FILLER            PIC  X(0003).
  4903     05  CLFHDGO PIC  X(0006).
  4904*    -------------------------------
  4905     05  FILLER            PIC  X(0003).
  4906     05  CAHHDGO PIC  X(0006).
  4907*    -------------------------------
  4908     05  FILLER            PIC  X(0003).
  4909     05  CENTDTO PIC  X(0008).
  4910*    -------------------------------
  4911     05  FILLER            PIC  X(0003).
  4912     05  CENTBYO PIC  X(0004).
  4913*    -------------------------------
  4914     05  FILLER            PIC  X(0003).
  4915     05  CCHGCNTO PIC  X(0003).
  4916*    -------------------------------
  4917     05  FILLER            PIC  X(0003).
  4918     05  CLFREFNO PIC  X(0006).
  4919*    -------------------------------
  4920     05  FILLER            PIC  X(0003).
  4921     05  CAHREFNO PIC  X(0006).
  4922*    -------------------------------
  4923     05  FILLER            PIC  X(0003).
  4924     05  CREINCDO PIC  X(0003).
  4925*    -------------------------------
  4926     05  FILLER            PIC  X(0003).
  4927     05  CAEFFDTO PIC  X(0008).
  4928*    -------------------------------
  4929     05  FILLER            PIC  X(0003).
  4930     05  CAEXPDTO PIC  X(0008).
  4931*    -------------------------------
  4932     05  FILLER            PIC  X(0003).
  4933     05  COMMLFO PIC  .99999.
  4934*    -------------------------------
  4935     05  FILLER            PIC  X(0003).
  4936     05  COMMAHO PIC  .99999.
  4937*    -------------------------------
  4938     05  FILLER            PIC  X(0003).
  4939     05  CERMSG1O PIC  X(0078).
  4940*    -------------------------------
  4941     05  FILLER            PIC  X(0003).
  4942     05  CERMSG2O PIC  X(0078).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  92
* EL6311.cbl
  4943*    -------------------------------
  4944     05  FILLER            PIC  X(0003).
  4945     05  CERMSG3O PIC  X(0078).
  4946*    -------------------------------
  4947     05  FILLER            PIC  X(0003).
  4948     05  CPFENTRO PIC  X(0002).
  4949*    -------------------------------
  4950     05  FILLER            PIC  X(0003).
  4951     05  CPF5HDRO PIC  X(0005).
  4952*    -------------------------------
  4953     05  FILLER            PIC  X(0003).
  4954     05  CPF4HDRO PIC  X(0013).
  4955*    -------------------------------
  4956     05  FILLER            PIC  X(0003).
  4957     05  CF15HDRO PIC  X(0022).
  4958*    -------------------------------
  4959 01  EL631DI REDEFINES EL631BI.
  4960     05  FILLER            PIC  X(0012).
  4961*    -------------------------------
  4962     05  DDATEL PIC S9(0004) COMP.
  4963     05  DDATEF PIC  X(0001).
  4964     05  FILLER REDEFINES DDATEF.
  4965         10  DDATEA PIC  X(0001).
  4966     05  DDATEI PIC  X(0008).
  4967*    -------------------------------
  4968     05  DTIMEL PIC S9(0004) COMP.
  4969     05  DTIMEF PIC  X(0001).
  4970     05  FILLER REDEFINES DTIMEF.
  4971         10  DTIMEA PIC  X(0001).
  4972     05  DTIMEI PIC  X(0005).
  4973*    -------------------------------
  4974     05  DHEADL PIC S9(0004) COMP.
  4975     05  DHEADF PIC  X(0001).
  4976     05  FILLER REDEFINES DHEADF.
  4977         10  DHEADA PIC  X(0001).
  4978     05  DHEADI PIC  X(0038).
  4979*    -------------------------------
  4980     05  DLDATEL PIC S9(0004) COMP.
  4981     05  DLDATEF PIC  X(0001).
  4982     05  FILLER REDEFINES DLDATEF.
  4983         10  DLDATEA PIC  X(0001).
  4984     05  DLDATEI PIC  X(0010).
  4985*    -------------------------------
  4986     05  DBATCHL PIC S9(0004) COMP.
  4987     05  DBATCHF PIC  X(0001).
  4988     05  FILLER REDEFINES DBATCHF.
  4989         10  DBATCHA PIC  X(0001).
  4990     05  DBATCHI PIC  X(0011).
  4991*    -------------------------------
  4992     05  DACCTNML PIC S9(0004) COMP.
  4993     05  DACCTNMF PIC  X(0001).
  4994     05  FILLER REDEFINES DACCTNMF.
  4995         10  DACCTNMA PIC  X(0001).
  4996     05  DACCTNMI PIC  X(0030).
  4997*    -------------------------------
  4998     05  DPROCDTL PIC S9(0004) COMP.
  4999     05  DPROCDTF PIC  X(0001).
  5000     05  FILLER REDEFINES DPROCDTF.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  93
* EL6311.cbl
  5001         10  DPROCDTA PIC  X(0001).
  5002     05  DPROCDTI PIC  X(0008).
  5003*    -------------------------------
  5004     05  DINPUTL PIC S9(0004) COMP.
  5005     05  DINPUTF PIC  X(0001).
  5006     05  FILLER REDEFINES DINPUTF.
  5007         10  DINPUTA PIC  X(0001).
  5008     05  DINPUTI PIC  X(0008).
  5009*    -------------------------------
  5010     05  DMAINDTL PIC S9(0004) COMP.
  5011     05  DMAINDTF PIC  X(0001).
  5012     05  FILLER REDEFINES DMAINDTF.
  5013         10  DMAINDTA PIC  X(0001).
  5014     05  DMAINDTI PIC  X(0008).
  5015*    -------------------------------
  5016     05  DCARRL PIC S9(0004) COMP.
  5017     05  DCARRF PIC  X(0001).
  5018     05  FILLER REDEFINES DCARRF.
  5019         10  DCARRA PIC  X(0001).
  5020     05  DCARRI PIC  X(0001).
  5021*    -------------------------------
  5022     05  DGROUPL PIC S9(0004) COMP.
  5023     05  DGROUPF PIC  X(0001).
  5024     05  FILLER REDEFINES DGROUPF.
  5025         10  DGROUPA PIC  X(0001).
  5026     05  DGROUPI PIC  X(0006).
  5027*    -------------------------------
  5028     05  DSTATEL PIC S9(0004) COMP.
  5029     05  DSTATEF PIC  X(0001).
  5030     05  FILLER REDEFINES DSTATEF.
  5031         10  DSTATEA PIC  X(0001).
  5032     05  DSTATEI PIC  X(0002).
  5033*    -------------------------------
  5034     05  DACCTL PIC S9(0004) COMP.
  5035     05  DACCTF PIC  X(0001).
  5036     05  FILLER REDEFINES DACCTF.
  5037         10  DACCTA PIC  X(0001).
  5038     05  DACCTI PIC  X(0010).
  5039*    -------------------------------
  5040     05  DRECVDTL PIC S9(0004) COMP.
  5041     05  DRECVDTF PIC  X(0001).
  5042     05  FILLER REDEFINES DRECVDTF.
  5043         10  DRECVDTA PIC  X(0001).
  5044     05  DRECVDTI PIC  X(0008).
  5045*    -------------------------------
  5046     05  DCSRL PIC S9(0004) COMP.
  5047     05  DCSRF PIC  X(0001).
  5048     05  FILLER REDEFINES DCSRF.
  5049         10  DCSRA PIC  X(0001).
  5050     05  DCSRI PIC  X(0004).
  5051*    -------------------------------
  5052     05  DREFHDGL PIC S9(0004) COMP.
  5053     05  DREFHDGF PIC  X(0001).
  5054     05  FILLER REDEFINES DREFHDGF.
  5055         10  DREFHDGA PIC  X(0001).
  5056     05  DREFHDGI PIC  X(0010).
  5057*    -------------------------------
  5058     05  DREFL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  94
* EL6311.cbl
  5059     05  DREFF PIC  X(0001).
  5060     05  FILLER REDEFINES DREFF.
  5061         10  DREFA PIC  X(0001).
  5062     05  DREFI PIC  X(0012).
  5063*    -------------------------------
  5064     05  DLFPHDGL PIC S9(0004) COMP.
  5065     05  DLFPHDGF PIC  X(0001).
  5066     05  FILLER REDEFINES DLFPHDGF.
  5067         10  DLFPHDGA PIC  X(0001).
  5068     05  DLFPHDGI PIC  X(0010).
  5069*    -------------------------------
  5070     05  DAHPHDGL PIC S9(0004) COMP.
  5071     05  DAHPHDGF PIC  X(0001).
  5072     05  FILLER REDEFINES DAHPHDGF.
  5073         10  DAHPHDGA PIC  X(0001).
  5074     05  DAHPHDGI PIC  X(0010).
  5075*    -------------------------------
  5076     05  DLFRHDGL PIC S9(0004) COMP.
  5077     05  DLFRHDGF PIC  X(0001).
  5078     05  FILLER REDEFINES DLFRHDGF.
  5079         10  DLFRHDGA PIC  X(0001).
  5080     05  DLFRHDGI PIC  X(0009).
  5081*    -------------------------------
  5082     05  DAHRHDGL PIC S9(0004) COMP.
  5083     05  DAHRHDGF PIC  X(0001).
  5084     05  FILLER REDEFINES DAHRHDGF.
  5085         10  DAHRHDGA PIC  X(0001).
  5086     05  DAHRHDGI PIC  X(0009).
  5087*    -------------------------------
  5088     05  DRISSL PIC S9(0004) COMP.
  5089     05  DRISSF PIC  X(0001).
  5090     05  FILLER REDEFINES DRISSF.
  5091         10  DRISSA PIC  X(0001).
  5092     05  DRISSI PIC  X(0005).
  5093*    -------------------------------
  5094     05  DRLFPRML PIC S9(0004) COMP.
  5095     05  DRLFPRMF PIC  X(0001).
  5096     05  FILLER REDEFINES DRLFPRMF.
  5097         10  DRLFPRMA PIC  X(0001).
  5098     05  DRLFPRMI PIC  S9(9)V99.
  5099*    -------------------------------
  5100     05  DRAHPRML PIC S9(0004) COMP.
  5101     05  DRAHPRMF PIC  X(0001).
  5102     05  FILLER REDEFINES DRAHPRMF.
  5103         10  DRAHPRMA PIC  X(0001).
  5104     05  DRAHPRMI PIC  S9(9)V99.
  5105*    -------------------------------
  5106     05  DRCANCL PIC S9(0004) COMP.
  5107     05  DRCANCF PIC  X(0001).
  5108     05  FILLER REDEFINES DRCANCF.
  5109         10  DRCANCA PIC  X(0001).
  5110     05  DRCANCI PIC  X(0005).
  5111*    -------------------------------
  5112     05  DRLFRFDL PIC S9(0004) COMP.
  5113     05  DRLFRFDF PIC  X(0001).
  5114     05  FILLER REDEFINES DRLFRFDF.
  5115         10  DRLFRFDA PIC  X(0001).
  5116     05  DRLFRFDI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  95
* EL6311.cbl
  5117*    -------------------------------
  5118     05  DRAHRFDL PIC S9(0004) COMP.
  5119     05  DRAHRFDF PIC  X(0001).
  5120     05  FILLER REDEFINES DRAHRFDF.
  5121         10  DRAHRFDA PIC  X(0001).
  5122     05  DRAHRFDI PIC  S9(9)V99.
  5123*    -------------------------------
  5124     05  DEISSL PIC S9(0004) COMP.
  5125     05  DEISSF PIC  X(0001).
  5126     05  FILLER REDEFINES DEISSF.
  5127         10  DEISSA PIC  X(0001).
  5128     05  DEISSI PIC  X(0005).
  5129*    -------------------------------
  5130     05  DELFPRML PIC S9(0004) COMP.
  5131     05  DELFPRMF PIC  X(0001).
  5132     05  FILLER REDEFINES DELFPRMF.
  5133         10  DELFPRMA PIC  X(0001).
  5134     05  DELFPRMI PIC  X(0011).
  5135*    -------------------------------
  5136     05  DEAHPRML PIC S9(0004) COMP.
  5137     05  DEAHPRMF PIC  X(0001).
  5138     05  FILLER REDEFINES DEAHPRMF.
  5139         10  DEAHPRMA PIC  X(0001).
  5140     05  DEAHPRMI PIC  X(0011).
  5141*    -------------------------------
  5142     05  DECANCL PIC S9(0004) COMP.
  5143     05  DECANCF PIC  X(0001).
  5144     05  FILLER REDEFINES DECANCF.
  5145         10  DECANCA PIC  X(0001).
  5146     05  DECANCI PIC  X(0005).
  5147*    -------------------------------
  5148     05  DELFRFDL PIC S9(0004) COMP.
  5149     05  DELFRFDF PIC  X(0001).
  5150     05  FILLER REDEFINES DELFRFDF.
  5151         10  DELFRFDA PIC  X(0001).
  5152     05  DELFRFDI PIC  X(0011).
  5153*    -------------------------------
  5154     05  DEAHRFDL PIC S9(0004) COMP.
  5155     05  DEAHRFDF PIC  X(0001).
  5156     05  FILLER REDEFINES DEAHRFDF.
  5157         10  DEAHRFDA PIC  X(0001).
  5158     05  DEAHRFDI PIC  X(0011).
  5159*    -------------------------------
  5160     05  DCISSL PIC S9(0004) COMP.
  5161     05  DCISSF PIC  X(0001).
  5162     05  FILLER REDEFINES DCISSF.
  5163         10  DCISSA PIC  X(0001).
  5164     05  DCISSI PIC  X(0005).
  5165*    -------------------------------
  5166     05  DCLFPRML PIC S9(0004) COMP.
  5167     05  DCLFPRMF PIC  X(0001).
  5168     05  FILLER REDEFINES DCLFPRMF.
  5169         10  DCLFPRMA PIC  X(0001).
  5170     05  DCLFPRMI PIC  X(0011).
  5171*    -------------------------------
  5172     05  DCAHPRML PIC S9(0004) COMP.
  5173     05  DCAHPRMF PIC  X(0001).
  5174     05  FILLER REDEFINES DCAHPRMF.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  96
* EL6311.cbl
  5175         10  DCAHPRMA PIC  X(0001).
  5176     05  DCAHPRMI PIC  X(0011).
  5177*    -------------------------------
  5178     05  DCCANCL PIC S9(0004) COMP.
  5179     05  DCCANCF PIC  X(0001).
  5180     05  FILLER REDEFINES DCCANCF.
  5181         10  DCCANCA PIC  X(0001).
  5182     05  DCCANCI PIC  X(0005).
  5183*    -------------------------------
  5184     05  DCLFRFDL PIC S9(0004) COMP.
  5185     05  DCLFRFDF PIC  X(0001).
  5186     05  FILLER REDEFINES DCLFRFDF.
  5187         10  DCLFRFDA PIC  X(0001).
  5188     05  DCLFRFDI PIC  X(0011).
  5189*    -------------------------------
  5190     05  DCAHRFDL PIC S9(0004) COMP.
  5191     05  DCAHRFDF PIC  X(0001).
  5192     05  FILLER REDEFINES DCAHRFDF.
  5193         10  DCAHRFDA PIC  X(0001).
  5194     05  DCAHRFDI PIC  X(0011).
  5195*    -------------------------------
  5196     05  DOISSL PIC S9(0004) COMP.
  5197     05  DOISSF PIC  X(0001).
  5198     05  FILLER REDEFINES DOISSF.
  5199         10  DOISSA PIC  X(0001).
  5200     05  DOISSI PIC  X(0005).
  5201*    -------------------------------
  5202     05  DOLFPRML PIC S9(0004) COMP.
  5203     05  DOLFPRMF PIC  X(0001).
  5204     05  FILLER REDEFINES DOLFPRMF.
  5205         10  DOLFPRMA PIC  X(0001).
  5206     05  DOLFPRMI PIC  X(0011).
  5207*    -------------------------------
  5208     05  DOAHPRML PIC S9(0004) COMP.
  5209     05  DOAHPRMF PIC  X(0001).
  5210     05  FILLER REDEFINES DOAHPRMF.
  5211         10  DOAHPRMA PIC  X(0001).
  5212     05  DOAHPRMI PIC  X(0011).
  5213*    -------------------------------
  5214     05  DOCANCL PIC S9(0004) COMP.
  5215     05  DOCANCF PIC  X(0001).
  5216     05  FILLER REDEFINES DOCANCF.
  5217         10  DOCANCA PIC  X(0001).
  5218     05  DOCANCI PIC  X(0005).
  5219*    -------------------------------
  5220     05  DOLFRFDL PIC S9(0004) COMP.
  5221     05  DOLFRFDF PIC  X(0001).
  5222     05  FILLER REDEFINES DOLFRFDF.
  5223         10  DOLFRFDA PIC  X(0001).
  5224     05  DOLFRFDI PIC  X(0011).
  5225*    -------------------------------
  5226     05  DOAHRFDL PIC S9(0004) COMP.
  5227     05  DOAHRFDF PIC  X(0001).
  5228     05  FILLER REDEFINES DOAHRFDF.
  5229         10  DOAHRFDA PIC  X(0001).
  5230     05  DOAHRFDI PIC  X(0011).
  5231*    -------------------------------
  5232     05  DITOTALL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  97
* EL6311.cbl
  5233     05  DITOTALF PIC  X(0001).
  5234     05  FILLER REDEFINES DITOTALF.
  5235         10  DITOTALA PIC  X(0001).
  5236     05  DITOTALI PIC  X(0005).
  5237*    -------------------------------
  5238     05  DIFATALL PIC S9(0004) COMP.
  5239     05  DIFATALF PIC  X(0001).
  5240     05  FILLER REDEFINES DIFATALF.
  5241         10  DIFATALA PIC  X(0001).
  5242     05  DIFATALI PIC  X(0005).
  5243*    -------------------------------
  5244     05  DIFORCEL PIC S9(0004) COMP.
  5245     05  DIFORCEF PIC  X(0001).
  5246     05  FILLER REDEFINES DIFORCEF.
  5247         10  DIFORCEA PIC  X(0001).
  5248     05  DIFORCEI PIC  X(0005).
  5249*    -------------------------------
  5250     05  DIHOLDL PIC S9(0004) COMP.
  5251     05  DIHOLDF PIC  X(0001).
  5252     05  FILLER REDEFINES DIHOLDF.
  5253         10  DIHOLDA PIC  X(0001).
  5254     05  DIHOLDI PIC  X(0005).
  5255*    -------------------------------
  5256     05  DIAVAILL PIC S9(0004) COMP.
  5257     05  DIAVAILF PIC  X(0001).
  5258     05  FILLER REDEFINES DIAVAILF.
  5259         10  DIAVAILA PIC  X(0001).
  5260     05  DIAVAILI PIC  X(0005).
  5261*    -------------------------------
  5262     05  DIGPREML PIC S9(0004) COMP.
  5263     05  DIGPREMF PIC  X(0001).
  5264     05  FILLER REDEFINES DIGPREMF.
  5265         10  DIGPREMA PIC  X(0001).
  5266     05  DIGPREMI PIC  X(0011).
  5267*    -------------------------------
  5268     05  DIBPREML PIC S9(0004) COMP.
  5269     05  DIBPREMF PIC  X(0001).
  5270     05  FILLER REDEFINES DIBPREMF.
  5271         10  DIBPREMA PIC  X(0001).
  5272     05  DIBPREMI PIC  X(0011).
  5273*    -------------------------------
  5274     05  DCTOTALL PIC S9(0004) COMP.
  5275     05  DCTOTALF PIC  X(0001).
  5276     05  FILLER REDEFINES DCTOTALF.
  5277         10  DCTOTALA PIC  X(0001).
  5278     05  DCTOTALI PIC  X(0005).
  5279*    -------------------------------
  5280     05  DCFATALL PIC S9(0004) COMP.
  5281     05  DCFATALF PIC  X(0001).
  5282     05  FILLER REDEFINES DCFATALF.
  5283         10  DCFATALA PIC  X(0001).
  5284     05  DCFATALI PIC  X(0005).
  5285*    -------------------------------
  5286     05  DCFORCEL PIC S9(0004) COMP.
  5287     05  DCFORCEF PIC  X(0001).
  5288     05  FILLER REDEFINES DCFORCEF.
  5289         10  DCFORCEA PIC  X(0001).
  5290     05  DCFORCEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  98
* EL6311.cbl
  5291*    -------------------------------
  5292     05  DCHOLDL PIC S9(0004) COMP.
  5293     05  DCHOLDF PIC  X(0001).
  5294     05  FILLER REDEFINES DCHOLDF.
  5295         10  DCHOLDA PIC  X(0001).
  5296     05  DCHOLDI PIC  X(0005).
  5297*    -------------------------------
  5298     05  DCAVAILL PIC S9(0004) COMP.
  5299     05  DCAVAILF PIC  X(0001).
  5300     05  FILLER REDEFINES DCAVAILF.
  5301         10  DCAVAILA PIC  X(0001).
  5302     05  DCAVAILI PIC  X(0005).
  5303*    -------------------------------
  5304     05  DCGPREML PIC S9(0004) COMP.
  5305     05  DCGPREMF PIC  X(0001).
  5306     05  FILLER REDEFINES DCGPREMF.
  5307         10  DCGPREMA PIC  X(0001).
  5308     05  DCGPREMI PIC  X(0011).
  5309*    -------------------------------
  5310     05  DCBPREML PIC S9(0004) COMP.
  5311     05  DCBPREMF PIC  X(0001).
  5312     05  FILLER REDEFINES DCBPREMF.
  5313         10  DCBPREMA PIC  X(0001).
  5314     05  DCBPREMI PIC  X(0011).
  5315*    -------------------------------
  5316     05  DNTOTALL PIC S9(0004) COMP.
  5317     05  DNTOTALF PIC  X(0001).
  5318     05  FILLER REDEFINES DNTOTALF.
  5319         10  DNTOTALA PIC  X(0001).
  5320     05  DNTOTALI PIC  X(0005).
  5321*    -------------------------------
  5322     05  DNFATALL PIC S9(0004) COMP.
  5323     05  DNFATALF PIC  X(0001).
  5324     05  FILLER REDEFINES DNFATALF.
  5325         10  DNFATALA PIC  X(0001).
  5326     05  DNFATALI PIC  X(0005).
  5327*    -------------------------------
  5328     05  DNFORCEL PIC S9(0004) COMP.
  5329     05  DNFORCEF PIC  X(0001).
  5330     05  FILLER REDEFINES DNFORCEF.
  5331         10  DNFORCEA PIC  X(0001).
  5332     05  DNFORCEI PIC  X(0005).
  5333*    -------------------------------
  5334     05  DNHOLDL PIC S9(0004) COMP.
  5335     05  DNHOLDF PIC  X(0001).
  5336     05  FILLER REDEFINES DNHOLDF.
  5337         10  DNHOLDA PIC  X(0001).
  5338     05  DNHOLDI PIC  X(0005).
  5339*    -------------------------------
  5340     05  DNAVAILL PIC S9(0004) COMP.
  5341     05  DNAVAILF PIC  X(0001).
  5342     05  FILLER REDEFINES DNAVAILF.
  5343         10  DNAVAILA PIC  X(0001).
  5344     05  DNAVAILI PIC  X(0005).
  5345*    -------------------------------
  5346     05  DNGPREML PIC S9(0004) COMP.
  5347     05  DNGPREMF PIC  X(0001).
  5348     05  FILLER REDEFINES DNGPREMF.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page  99
* EL6311.cbl
  5349         10  DNGPREMA PIC  X(0001).
  5350     05  DNGPREMI PIC  X(0011).
  5351*    -------------------------------
  5352     05  DNBPREML PIC S9(0004) COMP.
  5353     05  DNBPREMF PIC  X(0001).
  5354     05  FILLER REDEFINES DNBPREMF.
  5355         10  DNBPREMA PIC  X(0001).
  5356     05  DNBPREMI PIC  X(0011).
  5357*    -------------------------------
  5358     05  DERMSGL PIC S9(0004) COMP.
  5359     05  DERMSGF PIC  X(0001).
  5360     05  FILLER REDEFINES DERMSGF.
  5361         10  DERMSGA PIC  X(0001).
  5362     05  DERMSGI PIC  X(0075).
  5363*    -------------------------------
  5364     05  DPFENTRL PIC S9(0004) COMP.
  5365     05  DPFENTRF PIC  X(0001).
  5366     05  FILLER REDEFINES DPFENTRF.
  5367         10  DPFENTRA PIC  X(0001).
  5368     05  DPFENTRI PIC  9(2).
  5369 01  EL631DO REDEFINES EL631BI.
  5370     05  FILLER            PIC  X(0012).
  5371*    -------------------------------
  5372     05  FILLER            PIC  X(0003).
  5373     05  DDATEO PIC  X(0008).
  5374*    -------------------------------
  5375     05  FILLER            PIC  X(0003).
  5376     05  DTIMEO PIC  99.99.
  5377*    -------------------------------
  5378     05  FILLER            PIC  X(0003).
  5379     05  DHEADO PIC  X(0038).
  5380*    -------------------------------
  5381     05  FILLER            PIC  X(0003).
  5382     05  DLDATEO PIC  X(0010).
  5383*    -------------------------------
  5384     05  FILLER            PIC  X(0003).
  5385     05  DBATCHO PIC  X(0011).
  5386*    -------------------------------
  5387     05  FILLER            PIC  X(0003).
  5388     05  DACCTNMO PIC  X(0030).
  5389*    -------------------------------
  5390     05  FILLER            PIC  X(0003).
  5391     05  DPROCDTO PIC  X(0008).
  5392*    -------------------------------
  5393     05  FILLER            PIC  X(0003).
  5394     05  DINPUTO PIC  X(0008).
  5395*    -------------------------------
  5396     05  FILLER            PIC  X(0003).
  5397     05  DMAINDTO PIC  X(0008).
  5398*    -------------------------------
  5399     05  FILLER            PIC  X(0003).
  5400     05  DCARRO PIC  X(0001).
  5401*    -------------------------------
  5402     05  FILLER            PIC  X(0003).
  5403     05  DGROUPO PIC  X(0006).
  5404*    -------------------------------
  5405     05  FILLER            PIC  X(0003).
  5406     05  DSTATEO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 100
* EL6311.cbl
  5407*    -------------------------------
  5408     05  FILLER            PIC  X(0003).
  5409     05  DACCTO PIC  X(0010).
  5410*    -------------------------------
  5411     05  FILLER            PIC  X(0003).
  5412     05  DRECVDTO PIC  X(0008).
  5413*    -------------------------------
  5414     05  FILLER            PIC  X(0003).
  5415     05  DCSRO PIC  X(0004).
  5416*    -------------------------------
  5417     05  FILLER            PIC  X(0003).
  5418     05  DREFHDGO PIC  X(0010).
  5419*    -------------------------------
  5420     05  FILLER            PIC  X(0003).
  5421     05  DREFO PIC  X(0012).
  5422*    -------------------------------
  5423     05  FILLER            PIC  X(0003).
  5424     05  DLFPHDGO PIC  X(0010).
  5425*    -------------------------------
  5426     05  FILLER            PIC  X(0003).
  5427     05  DAHPHDGO PIC  X(0010).
  5428*    -------------------------------
  5429     05  FILLER            PIC  X(0003).
  5430     05  DLFRHDGO PIC  X(0009).
  5431*    -------------------------------
  5432     05  FILLER            PIC  X(0003).
  5433     05  DAHRHDGO PIC  X(0009).
  5434*    -------------------------------
  5435     05  FILLER            PIC  X(0003).
  5436     05  DRISSO PIC  ZZ99-.
  5437*    -------------------------------
  5438     05  FILLER            PIC  X(0003).
  5439     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5440*    -------------------------------
  5441     05  FILLER            PIC  X(0003).
  5442     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5443*    -------------------------------
  5444     05  FILLER            PIC  X(0003).
  5445     05  DRCANCO PIC  ZZ99-.
  5446*    -------------------------------
  5447     05  FILLER            PIC  X(0003).
  5448     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5449*    -------------------------------
  5450     05  FILLER            PIC  X(0003).
  5451     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5452*    -------------------------------
  5453     05  FILLER            PIC  X(0003).
  5454     05  DEISSO PIC  ZZ99-.
  5455*    -------------------------------
  5456     05  FILLER            PIC  X(0003).
  5457     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5458*    -------------------------------
  5459     05  FILLER            PIC  X(0003).
  5460     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5461*    -------------------------------
  5462     05  FILLER            PIC  X(0003).
  5463     05  DECANCO PIC  ZZ99-.
  5464*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 101
* EL6311.cbl
  5465     05  FILLER            PIC  X(0003).
  5466     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5467*    -------------------------------
  5468     05  FILLER            PIC  X(0003).
  5469     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5470*    -------------------------------
  5471     05  FILLER            PIC  X(0003).
  5472     05  DCISSO PIC  ZZ99-.
  5473*    -------------------------------
  5474     05  FILLER            PIC  X(0003).
  5475     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5476*    -------------------------------
  5477     05  FILLER            PIC  X(0003).
  5478     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5479*    -------------------------------
  5480     05  FILLER            PIC  X(0003).
  5481     05  DCCANCO PIC  ZZ99-.
  5482*    -------------------------------
  5483     05  FILLER            PIC  X(0003).
  5484     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5485*    -------------------------------
  5486     05  FILLER            PIC  X(0003).
  5487     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5488*    -------------------------------
  5489     05  FILLER            PIC  X(0003).
  5490     05  DOISSO PIC  ZZ99-.
  5491*    -------------------------------
  5492     05  FILLER            PIC  X(0003).
  5493     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5494*    -------------------------------
  5495     05  FILLER            PIC  X(0003).
  5496     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5497*    -------------------------------
  5498     05  FILLER            PIC  X(0003).
  5499     05  DOCANCO PIC  ZZ99-.
  5500*    -------------------------------
  5501     05  FILLER            PIC  X(0003).
  5502     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5503*    -------------------------------
  5504     05  FILLER            PIC  X(0003).
  5505     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5506*    -------------------------------
  5507     05  FILLER            PIC  X(0003).
  5508     05  DITOTALO PIC  ZZZ99.
  5509*    -------------------------------
  5510     05  FILLER            PIC  X(0003).
  5511     05  DIFATALO PIC  ZZZ99.
  5512*    -------------------------------
  5513     05  FILLER            PIC  X(0003).
  5514     05  DIFORCEO PIC  ZZZ99.
  5515*    -------------------------------
  5516     05  FILLER            PIC  X(0003).
  5517     05  DIHOLDO PIC  ZZZ99.
  5518*    -------------------------------
  5519     05  FILLER            PIC  X(0003).
  5520     05  DIAVAILO PIC  ZZZ99.
  5521*    -------------------------------
  5522     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 102
* EL6311.cbl
  5523     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5524*    -------------------------------
  5525     05  FILLER            PIC  X(0003).
  5526     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5527*    -------------------------------
  5528     05  FILLER            PIC  X(0003).
  5529     05  DCTOTALO PIC  ZZZ99.
  5530*    -------------------------------
  5531     05  FILLER            PIC  X(0003).
  5532     05  DCFATALO PIC  ZZZ99.
  5533*    -------------------------------
  5534     05  FILLER            PIC  X(0003).
  5535     05  DCFORCEO PIC  ZZZ99.
  5536*    -------------------------------
  5537     05  FILLER            PIC  X(0003).
  5538     05  DCHOLDO PIC  ZZZ99.
  5539*    -------------------------------
  5540     05  FILLER            PIC  X(0003).
  5541     05  DCAVAILO PIC  ZZZ99.
  5542*    -------------------------------
  5543     05  FILLER            PIC  X(0003).
  5544     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5545*    -------------------------------
  5546     05  FILLER            PIC  X(0003).
  5547     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5548*    -------------------------------
  5549     05  FILLER            PIC  X(0003).
  5550     05  DNTOTALO PIC  ---99.
  5551*    -------------------------------
  5552     05  FILLER            PIC  X(0003).
  5553     05  DNFATALO PIC  ---99.
  5554*    -------------------------------
  5555     05  FILLER            PIC  X(0003).
  5556     05  DNFORCEO PIC  ---99.
  5557*    -------------------------------
  5558     05  FILLER            PIC  X(0003).
  5559     05  DNHOLDO PIC  ---99.
  5560*    -------------------------------
  5561     05  FILLER            PIC  X(0003).
  5562     05  DNAVAILO PIC  ---99.
  5563*    -------------------------------
  5564     05  FILLER            PIC  X(0003).
  5565     05  DNGPREMO PIC  -------9.99.
  5566*    -------------------------------
  5567     05  FILLER            PIC  X(0003).
  5568     05  DNBPREMO PIC  -------9.99.
  5569*    -------------------------------
  5570     05  FILLER            PIC  X(0003).
  5571     05  DERMSGO PIC  X(0075).
  5572*    -------------------------------
  5573     05  FILLER            PIC  X(0003).
  5574     05  DPFENTRO PIC  X(0002).
  5575*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 103
* EL6311.cbl
  5577 01  MAP-B REDEFINES EL631BI.
  5578     12  FILLER                  PIC X(569).
  5579*    12  FILLER                  PIC X(512).
  5580*    12  FILLER                  PIC X(510).
  5581     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5582         16  BKIND-LEN               PIC S9(4)  COMP.
  5583         16  BKIND-ATTRB             PIC X.
  5584         16  BKIND                   PIC XX.
  5585         16  BTYPE-LEN               PIC S9(4)  COMP.
  5586         16  BTYPE-ATTRB             PIC X.
  5587         16  BTYPE                   PIC X(3).
  5588         16  BTERM-LEN               PIC S9(4)  COMP.
  5589         16  BTERM-ATTRB             PIC X.
  5590         16  BTERMI                  PIC 999.
  5591         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5592         16  BBEN-LEN                PIC S9(4)  COMP.
  5593         16  BBEN-ATTRB              PIC X.
  5594         16  BBENI                   PIC 9(10)V99.
  5595*        16  BBENI                   PIC 9(12).
  5596         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5597         16  BPREM-LEN               PIC S9(4)  COMP.
  5598         16  BPREM-ATTRB             PIC X.
  5599         16  BPREMI                  PIC S9(9)V99.
  5600*        16  BPREMI                  PIC 9(11).
  5601         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5602         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5603         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5604         16  BEXPIRE-ATTRB           PIC X.
  5605         16  BEXPIRE                 PIC X(8).
  5606         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5607         16  BCRIT-PERD-ATTRB        PIC X.
  5608         16  BCRIT-PERDI             PIC 99.
  5609         16  BCRIT-PERDO REDEFINES
  5610                         BCRIT-PERDI PIC ZZ.
  5611         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5612         16  BALT-BEN-ATTRB          PIC X.
  5613         16  BALT-BENI               PIC 9(10)V99.
  5614*        16  BALT-BENI               PIC 9(12).
  5615         16  BALT-BENO REDEFINES
  5616                           BALT-BENI PIC Z(9).ZZ.
  5617         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5618         16  BALT-PREM-ATTRB         PIC X.
  5619         16  BALT-PREMI              PIC 9(9)V99.
  5620*        16  BALT-PREMI              PIC 9(11).
  5621         16  BALT-PREMO REDEFINES
  5622                          BALT-PREMI PIC Z(7).ZZ-.
  5623         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5624         16  BBEN-CD-ATTRB           PIC X.
  5625         16  BBEN-CD                 PIC XXX.
  5626         16  BCPREM-LEN              PIC S9(4)  COMP.
  5627         16  BCPREM-ATTRB            PIC X.
  5628         16  BCPREMI                 PIC S9(9)V99.
  5629*        16  BCPREMI                 PIC X(11).
  5630         16  BCPREMO REDEFINES BCPREMI
  5631                                     PIC Z(7).99-.
  5632         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5633         16  BCALT-PREM-ATTRB        PIC X.
  5634         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 104
* EL6311.cbl
  5635         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5636         16  BBEN-ABBR-ATTRB         PIC X.
  5637         16  BBEN-ABBR               PIC X(5).
  5638         16  BDIFF-LEN               PIC S9(4)  COMP.
  5639         16  BDIFF-ATTRB             PIC X.
  5640         16  BDIFFO                  PIC Z(7).99-.
  5641         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5642         16  BBILL-LIT-ATTRB         PIC X.
  5643         16  BBILL-LIT               PIC X(8).
  5644         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5645         16  BDALT-PREM-ATTRB        PIC X.
  5646         16  BDALT-PREM              PIC Z(7).99-.
  5647
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 105
* EL6311.cbl
  5649
  5650****************************************************************
  5651*
  5652* Copyright (c) 2007 by Clerity Solutions, Inc.
  5653* All rights reserved.
  5654*
  5655****************************************************************
  5656 01  DFHEIV.
  5657   02  DFHEIV0               PIC X(35).
  5658   02  DFHEIV1               PIC X(08).
  5659   02  DFHEIV2               PIC X(08).
  5660   02  DFHEIV3               PIC X(08).
  5661   02  DFHEIV4               PIC X(06).
  5662   02  DFHEIV5               PIC X(04).
  5663   02  DFHEIV6               PIC X(04).
  5664   02  DFHEIV7               PIC X(02).
  5665   02  DFHEIV8               PIC X(02).
  5666   02  DFHEIV9               PIC X(01).
  5667   02  DFHEIV10              PIC S9(7) COMP-3.
  5668   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5669   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5670   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5671   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5672   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5673   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5674   02  DFHEIV17              PIC X(04).
  5675   02  DFHEIV18              PIC X(04).
  5676   02  DFHEIV19              PIC X(04).
  5677   02  DFHEIV20              USAGE IS POINTER.
  5678   02  DFHEIV21              USAGE IS POINTER.
  5679   02  DFHEIV22              USAGE IS POINTER.
  5680   02  DFHEIV23              USAGE IS POINTER.
  5681   02  DFHEIV24              USAGE IS POINTER.
  5682   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5683   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5684   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5685   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5686   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5687   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5688   02  FILLER                PIC X(02).
  5689   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5690   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5691   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5692   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5693   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5694 LINKAGE  SECTION.
  5695*****************************************************************
  5696*                                                               *
  5697* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5698* All rights reserved.                                          *
  5699*                                                               *
  5700*****************************************************************
  5701 01  dfheiblk.
  5702     02  eibtime          pic s9(7) comp-3.
  5703     02  eibdate          pic s9(7) comp-3.
  5704     02  eibtrnid         pic x(4).
  5705     02  eibtaskn         pic s9(7) comp-3.
  5706     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 106
* EL6311.cbl
  5707     02  dfheigdi         pic s9(4) comp.
  5708     02  eibcposn         pic s9(4) comp.
  5709     02  eibcalen         pic s9(4) comp.
  5710     02  eibaid           pic x(1).
  5711     02  eibfiller1       pic x(1).
  5712     02  eibfn            pic x(2).
  5713     02  eibfiller2       pic x(2).
  5714     02  eibrcode         pic x(6).
  5715     02  eibfiller3       pic x(2).
  5716     02  eibds            pic x(8).
  5717     02  eibreqid         pic x(8).
  5718     02  eibrsrce         pic x(8).
  5719     02  eibsync          pic x(1).
  5720     02  eibfree          pic x(1).
  5721     02  eibrecv          pic x(1).
  5722     02  eibsend          pic x(1).
  5723     02  eibatt           pic x(1).
  5724     02  eibeoc           pic x(1).
  5725     02  eibfmh           pic x(1).
  5726     02  eibcompl         pic x(1).
  5727     02  eibsig           pic x(1).
  5728     02  eibconf          pic x(1).
  5729     02  eiberr           pic x(1).
  5730     02  eibrldbk         pic x(1).
  5731     02  eiberrcd         pic x(4).
  5732     02  eibsynrb         pic x(1).
  5733     02  eibnodat         pic x(1).
  5734     02  eibfiller5       pic x(2).
  5735     02  eibresp          pic 9(09) comp.
  5736     02  eibresp2         pic 9(09) comp.
  5737     02  dfheigdj         pic s9(4) comp.
  5738     02  dfheigdk         pic s9(4) comp.
  5739 01  DFHCOMMAREA                 PIC X(1300).
  5740
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 107
* EL6311.cbl
  5742*    COPY ERCPNDB.
  5743******************************************************************
  5744*                                                                *
  5745*                                                                *
  5746*                            ERCPNDB.                            *
  5747*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5748*                            VMOD=2.025                          *
  5749*                                                                *
  5750*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5751*                                                                *
  5752******************************************************************
  5753*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5754*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5755******************************************************************
  5756*                                                                *
  5757*                                                                *
  5758*   FILE TYPE = VSAM,KSDS                                        *
  5759*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5760*                                                                *
  5761*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5762*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5763*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5764*                                                 RKP=13,LEN=36  *
  5765*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5766*                                      AND CHG-SEQ.)             *
  5767*                                                RKP=49,LEN=11   *
  5768*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5769*                                      AND CHG-SEQ.)             *
  5770*                                                RKP=60,LEN=15   *
  5771*                                                                *
  5772*   LOG = NO                                                     *
  5773*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5774******************************************************************
  5775******************************************************************
  5776*                   C H A N G E   L O G
  5777*
  5778* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5779*-----------------------------------------------------------------
  5780*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5781* EFFECTIVE    NUMBER
  5782*-----------------------------------------------------------------
  5783* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5784* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5785* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5786* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5787* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5788* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5789* 032306                   PEMA  ADD BOW LOAN NUMBER
  5790* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5791* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5792* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5793* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5794* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5795* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5796* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5797* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5798******************************************************************
  5799
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 108
* EL6311.cbl
  5800 01  PENDING-BUSINESS.
  5801     12  PB-RECORD-ID                     PIC XX.
  5802         88  VALID-PB-ID                        VALUE 'PB'.
  5803
  5804     12  PB-CONTROL-PRIMARY.
  5805         16  PB-COMPANY-CD                PIC X.
  5806         16  PB-ENTRY-BATCH               PIC X(6).
  5807         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5808         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5809
  5810     12  PB-CONTROL-BY-ACCOUNT.
  5811         16  PB-COMPANY-CD-A1             PIC X.
  5812         16  PB-CARRIER                   PIC X.
  5813         16  PB-GROUPING.
  5814             20  PB-GROUPING-PREFIX       PIC XXX.
  5815             20  PB-GROUPING-PRIME        PIC XXX.
  5816         16  PB-STATE                     PIC XX.
  5817         16  PB-ACCOUNT.
  5818             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5819             20  PB-ACCOUNT-PRIME         PIC X(6).
  5820         16  PB-CERT-EFF-DT               PIC XX.
  5821         16  PB-CERT-NO.
  5822             20  PB-CERT-PRIME            PIC X(10).
  5823             20  PB-CERT-SFX              PIC X.
  5824         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5825
  5826         16  PB-RECORD-TYPE               PIC X.
  5827             88  PB-MAILING-DATA                VALUE '0'.
  5828             88  PB-ISSUE                       VALUE '1'.
  5829             88  PB-CANCELLATION                VALUE '2'.
  5830             88  PB-BATCH-TRAILER               VALUE '9'.
  5831
  5832     12  PB-CONTROL-BY-ORIG-BATCH.
  5833         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5834         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5835         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5836         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5837
  5838     12  PB-CONTROL-BY-CSR.
  5839         16  PB-CSR-COMPANY-CD            PIC X.
  5840         16  PB-CSR-ID                    PIC X(4).
  5841         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5842         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5843         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5844******************************************************************
  5845*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5846******************************************************************
  5847
  5848     12  PB-LAST-MAINT-DT                 PIC XX.
  5849     12  PB-LAST-MAINT-BY                 PIC X(4).
  5850     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5851
  5852     12  PB-RECORD-BODY                   PIC X(375).
  5853
  5854     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5855         16  PB-CERT-ORIGIN               PIC X.
  5856             88  CLASIC-CREATED-CERT         VALUE '1'.
  5857         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 109
* EL6311.cbl
  5858             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5859             20  PB-I-INSURED-FIRST-NAME.
  5860                 24  PB-I-INSURED-1ST-INIT PIC X.
  5861                 24  FILLER                PIC X(9).
  5862             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5863         16  PB-I-AGE                     PIC S99   COMP-3.
  5864         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5865         16  PB-I-BIRTHDAY                PIC XX.
  5866         16  PB-I-INSURED-SEX             PIC X.
  5867             88  PB-SEX-MALE     VALUE 'M'.
  5868             88  PB-SEX-FEMALE   VALUE 'F'.
  5869
  5870         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5871         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5872         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5873         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5874         16  PB-I-SKIP-CODE               PIC X.
  5875             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5876             88  PB-SKIP-JULY              VALUE '1'.
  5877             88  PB-SKIP-AUGUST            VALUE '2'.
  5878             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5879             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5880             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5881             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5882             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5883             88  PB-SKIP-JUNE              VALUE '8'.
  5884             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5885             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5886             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5887         16  PB-I-TERM-TYPE               PIC X.
  5888             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5889             88  PB-PAID-WEEKLY            VALUE 'W'.
  5890             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5891             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5892             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5893         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5894         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5895         16  PB-I-DATA-ENTRY-SW           PIC X.
  5896             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5897             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5898             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5899             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5900         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5901         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5902*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5903         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5904         16  FILLER                       PIC X.
  5905
  5906         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5907             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5908             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5909                                                   '90' THRU '99'.
  5910         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5911                                          PIC XX.
  5912         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5913         16  PB-I-AMOUNT-FINANCED REDEFINES
  5914                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5915         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 110
* EL6311.cbl
  5916         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5917                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5918         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5919         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5920         16  PB-I-CLP-AMOUNT REDEFINES
  5921                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5922         16  PB-I-LF-CALC-FLAG            PIC X.
  5923             88 PB-COMP-LF-PREM               VALUE '?'.
  5924         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5925         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5926         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5927         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5928         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5929         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5930         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5931         16  PB-I-LF-ABBR                 PIC XXX.
  5932         16  PB-I-LF-INPUT-CD             PIC XX.
  5933
  5934         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5935             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5936             88  PB-INVALID-AH               VALUE '  ' '00'
  5937                                                   '90' THRU '99'.
  5938         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5939         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5940         16  PB-I-AH-CALC-FLAG            PIC X.
  5941             88 PB-COMP-AH-PREM                  VALUE '?'.
  5942         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5943         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5944         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5945         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5946         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5947         16  PB-I-AH-ABBR                 PIC XXX.
  5948         16  PB-I-AH-INPUT-CD             PIC XXX.
  5949
  5950         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5951         16  PB-I-REIN-TABLE              PIC XXX.
  5952         16  PB-I-BUSINESS-TYPE           PIC 99.
  5953         16  PB-I-INDV-GRP-CD             PIC X.
  5954         16  PB-I-MORT-CODE.
  5955             20  PB-I-TABLE               PIC X.
  5956             20  PB-I-INTEREST            PIC XX.
  5957             20  PB-I-MORT-TYP            PIC X.
  5958         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5959         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5960         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5961         16  PB-I-INDV-GRP-OVRD           PIC X.
  5962         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5963         16  PB-I-SIG-SW                  PIC X.
  5964             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5965         16  PB-I-RATE-CLASS              PIC XX.
  5966         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5967         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5968         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5969         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5970         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5971         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5972         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5973         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 111
* EL6311.cbl
  5974         16  PB-I-OB-FLAG                 PIC X.
  5975             88  PB-I-OB                      VALUE 'B'.
  5976             88  PB-I-SUMMARY                 VALUE 'Z'.
  5977         16  PB-I-ENTRY-STATUS            PIC X.
  5978             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5979                                              'M' '5' '9' '2'.
  5980             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5981             88  PB-I-POLICY-PENDING          VALUE '2'.
  5982             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5983             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5984             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5985             88  PB-I-REIN-ONLY               VALUE '9'.
  5986             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5987             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5988             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5989             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5990         16  PB-I-INT-CODE                PIC X.
  5991             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5992             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5993         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5994         16  PB-I-SOC-SEC-NO              PIC X(11).
  5995         16  PB-I-MEMBER-NO               PIC X(12).
  5996         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5997*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5998         16  PB-I-OLD-LOF                 PIC XXX.
  5999         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6000         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6001         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6002         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6003         16  PB-I-LIFE-INDICATOR          PIC X.
  6004             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6005         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6006         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6007                                          PIC S9(5)V99    COMP-3.
  6008         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6009             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6010             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6011         16  PB-I-1ST-PMT-DT              PIC XX.
  6012         16  PB-I-JOINT-INSURED.
  6013             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6014             20 PB-I-JOINT-FIRST-NAME.
  6015                24  PB-I-JOINT-FIRST-INIT PIC X.
  6016                24  FILLER                PIC X(9).
  6017             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6018*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6019         16  PB-I-BENEFICIARY-NAME.
  6020             20  PB-I-BANK-NUMBER         PIC X(10).
  6021             20  FILLER                   PIC X(15).
  6022         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6023         16  PB-I-REFERENCE               PIC X(12).
  6024         16  FILLER REDEFINES PB-I-REFERENCE.
  6025             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6026             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6027             20  PB-I-CLP-STATE           PIC XX.
  6028         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6029             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6030             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6031             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 112
* EL6311.cbl
  6032         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6033         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6034         16  PB-I-RESIDENT-STATE          PIC XX.
  6035         16  PB-I-RATE-CODE               PIC X(4).
  6036         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6037         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6038         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6039         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6040         16  PB-I-BANK-NOCHRGB            PIC 99.
  6041         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6042         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6043
  6044     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6045         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6046             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6047         16  PB-C-CANCEL-ORIGIN           PIC X.
  6048             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6049         16  PB-C-LF-CANCEL-DT            PIC XX.
  6050         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6051         16  PB-C-LF-CALC-REQ             PIC X.
  6052             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6053         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6054         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6055         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6056             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6057         16  PB-C-AH-CANCEL-DT            PIC XX.
  6058         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6059         16  PB-C-AH-CALC-REQ             PIC X.
  6060             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6061         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6062         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6063         16  PB-C-LAST-NAME               PIC X(15).
  6064         16  PB-C-REFUND-SW               PIC X.
  6065             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6066             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6067         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6068         16  PB-C-PAYEE-CODE              PIC X(6).
  6069         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6070         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6071         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6072         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6073         16  PB-C-REFERENCE               PIC X(12).
  6074         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6075         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6076         16  PB-C-POST-CARD-IND           PIC X.
  6077         16  PB-C-CANCEL-REASON           PIC X.
  6078         16  PB-C-REF-INTERFACE-SW        PIC X.
  6079         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6080         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6081         16  FILLER                       PIC X(01).
  6082*        16  FILLER                       PIC X(18).
  6083         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6084*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6085         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6086         16  PB-CANCELED-CERT-DATA.
  6087             20  PB-CI-INSURED-NAME.
  6088                 24  PB-CI-LAST-NAME      PIC X(15).
  6089                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 113
* EL6311.cbl
  6090             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6091             20  PB-CI-INSURED-SEX        PIC X.
  6092             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6093             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6094             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6095             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6096             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6097             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6098             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6099             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6100             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6101             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6102             20  PB-CI-RATE-CLASS         PIC XX.
  6103             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6104             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6105             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6106             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6107             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6108             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6109             20  PB-CI-LF-ABBR            PIC X(3).
  6110             20  PB-CI-AH-ABBR            PIC X(3).
  6111             20  PB-CI-OB-FLAG            PIC X.
  6112                 88  PB-CI-OB                VALUE 'B'.
  6113             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6114                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6115                                           'M' '4' '5' '9' '2'.
  6116                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6117                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6118                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6119                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6120                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6121                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6122                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6123                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6124                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6125                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6126                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6127                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6128             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6129                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6130                                           'M' '4' '5' '9' '2'.
  6131                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6132                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6133                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6134                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6135                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6136                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6137                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6138                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6139                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6140                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6141                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6142                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6143             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6144             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6145             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6146             20  PB-CI-MEMBER-NO          PIC X(12).
  6147             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 114
* EL6311.cbl
  6148                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6149                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6150             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6151             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6152             20  PB-CI-COMP-EXCP-SW       PIC X.
  6153                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6154                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6155             20  PB-CI-ENTRY-STATUS       PIC X.
  6156             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6157             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6158             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6159             20  PB-CI-DEATH-DT           PIC XX.
  6160             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6161             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6162             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6163             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6164             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6165             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6166             20  PB-CI-ENTRY-DT              PIC XX.
  6167             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6168             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6169             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6170             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6171             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6172             20  PB-CI-OLD-LOF               PIC XXX.
  6173*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6174             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6175             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6176             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6177             20  PB-CI-INDV-GRP-CD           PIC X.
  6178             20  PB-CI-BENEFICIARY-NAME.
  6179                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6180                 24  FILLER                  PIC X(15).
  6181             20  PB-CI-NOTE-SW               PIC X.
  6182             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6183             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6184             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6185             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6186             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6187             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6188             20  PB-CI-FIRST-NAME            PIC X(10).
  6189             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6190
  6191         16  FILLER                       PIC X(13).
  6192*032306  16  FILLER                       PIC X(27).
  6193*        16  FILLER                       PIC X(46).
  6194
  6195     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6196         16  FILLER                       PIC X(10).
  6197         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6198         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6199         16  PB-M-INSURED-MID-INIT        PIC X.
  6200         16  PB-M-INSURED-AGE             PIC 99.
  6201         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6202         16  PB-M-INSURED-SEX             PIC X.
  6203         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6204         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6205         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 115
* EL6311.cbl
  6206         16  PB-M-INSURED-CITY-STATE.
  6207             20  PB-M-INSURED-CITY        PIC X(28).
  6208             20  PB-M-INSURED-STATE       PIC XX.
  6209         16  PB-M-INSURED-ZIP-CODE.
  6210             20  PB-M-INSURED-ZIP-PRIME.
  6211                 24  PB-M-INSURED-ZIP-1   PIC X.
  6212                     88  PB-M-CANADIAN-POST-CODE
  6213                                             VALUE 'A' THRU 'Z'.
  6214                 24  FILLER               PIC X(4).
  6215             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6216         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6217                                        PB-M-INSURED-ZIP-CODE.
  6218             20  PM-M-INS-CAN-POST1       PIC XXX.
  6219             20  PM-M-INS-CAN-POST2       PIC XXX.
  6220             20  FILLER                   PIC XXX.
  6221         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6222         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6223         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6224         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6225         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6226         16  PB-M-CRED-BENE-CITYST.
  6227             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6228             20  PB-M-CRED-BENE-STATE     PIC XX.
  6229         16  FILLER                       PIC X(92).
  6230
  6231     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6232         16  FILLER                       PIC X(10).
  6233         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6234         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6235         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6236         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6237         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6238         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6239         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6240         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6241         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6242         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6243         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6244         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6245         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6246         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6247         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6248         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6249         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6250         16  PB-ACCOUNT-NAME              PIC X(30).
  6251         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6252         16  PB-REFERENCE                 PIC X(12).
  6253         16  PB-B-RECEIVED-DT             PIC XX.
  6254         16  FILLER                       PIC X(234).
  6255
  6256     12  PB-RECORD-STATUS.
  6257         16  PB-CREDIT-SELECT-DT          PIC XX.
  6258         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6259         16  PB-BILLED-DT                 PIC XX.
  6260         16  PB-BILLING-STATUS            PIC X.
  6261             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6262             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6263             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 116
* EL6311.cbl
  6264         16  PB-RECORD-BILL               PIC X.
  6265             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6266             88  PB-RECORD-RETURNED           VALUE 'R'.
  6267             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6268             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6269             88  PB-OVERRIDE-AH               VALUE 'A'.
  6270             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6271         16  PB-BATCH-ENTRY               PIC X.
  6272             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6273             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6274             88  PB-REISSUED-CERT             VALUE 'E'.
  6275             88  PB-MONTHLY-CERT              VALUE 'M'.
  6276             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6277             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6278             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6279         16  PB-FORCE-CODE                PIC X.
  6280             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6281             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6282             88  PB-CANCEL-FORCE              VALUE '8'.
  6283             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6284             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6285             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6286             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6287             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6288             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6289             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6290         16  PB-FATAL-FLAG                PIC X.
  6291             88  PB-FATAL-ERRORS              VALUE 'X'.
  6292         16  PB-FORCE-ER-CD               PIC X.
  6293             88  PB-FORCE-ERRORS              VALUE 'F'.
  6294             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6295         16  PB-WARN-ER-CD                PIC X.
  6296             88  PB-WARNING-ERRORS            VALUE 'W'.
  6297         16  FILLER                       PIC X.
  6298         16  PB-OUT-BAL-CD                PIC X.
  6299             88  PB-OUT-OF-BAL                VALUE 'O'.
  6300         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6301         16  PB-AH-OVERRIDE-L1            PIC X.
  6302         16  PB-INPUT-DT                  PIC XX.
  6303         16  PB-INPUT-BY                  PIC X(4).
  6304         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6305         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6306         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6307         16  PB-LF-EARNING-METHOD         PIC X.
  6308         16  PB-AH-EARNING-METHOD         PIC X.
  6309         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6310         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6311         16  PB-REIN-CD                   PIC XXX.
  6312         16  PB-LF-REFUND-TYPE            PIC X.
  6313         16  PB-AH-REFUND-TYPE            PIC X.
  6314         16  PB-ACCT-EFF-DT               PIC XX.
  6315         16  PB-ACCT-EXP-DT               PIC XX.
  6316         16  PB-COMPANY-ID                PIC X(3).
  6317         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6318         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6319         16  PB-SV-CARRIER                PIC X.
  6320         16  PB-SV-GROUPING               PIC X(6).
  6321         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 117
* EL6311.cbl
  6322         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6323         16  PB-GA-BILLING-INFO.
  6324             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6325                                          PIC XX.
  6326         16  PB-SV-REMIT-TO  REDEFINES
  6327             PB-GA-BILLING-INFO           PIC X(10).
  6328         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6329         16  PB-I-LOAN-OFFICER            PIC X(5).
  6330         16  PB-I-VIN                     PIC X(17).
  6331
  6332         16  FILLER                       PIC X(04).
  6333         16  IMNET-BYPASS-SW              PIC X.
  6334
  6335******************************************************************
  6336*                COMMON EDIT ERRORS                              *
  6337******************************************************************
  6338
  6339     12  PB-COMMON-ERRORS.
  6340         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6341                                           PIC S9(4)     COMP.
  6342
  6343******************************************************************
  6344
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 118
* EL6311.cbl
  6346*    COPY ELCCERT.
  6347******************************************************************
  6348*                                                                *
  6349*                            ELCCERT.                            *
  6350*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6351*                            VMOD=2.013                          *
  6352*                                                                *
  6353*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6354*                                                                *
  6355*   FILE TYPE = VSAM,KSDS                                        *
  6356*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6357*                                                                *
  6358*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6359*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6360*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6361*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6362*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6363*                                                                *
  6364*   LOG = YES                                                    *
  6365*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6366******************************************************************
  6367*                   C H A N G E   L O G
  6368*
  6369* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6370*-----------------------------------------------------------------
  6371*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6372* EFFECTIVE    NUMBER
  6373*-----------------------------------------------------------------
  6374* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6375* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6376* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6377* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6378* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6379* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6380* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6381* 032612  CR2011110200001  PEMA  AHL CHANGES
  6382******************************************************************
  6383
  6384 01  CERTIFICATE-MASTER.
  6385     12  CM-RECORD-ID                      PIC XX.
  6386         88  VALID-CM-ID                      VALUE 'CM'.
  6387
  6388     12  CM-CONTROL-PRIMARY.
  6389         16  CM-COMPANY-CD                 PIC X.
  6390         16  CM-CARRIER                    PIC X.
  6391         16  CM-GROUPING.
  6392             20  CM-GROUPING-PREFIX        PIC X(3).
  6393             20  CM-GROUPING-PRIME         PIC X(3).
  6394         16  CM-STATE                      PIC XX.
  6395         16  CM-ACCOUNT.
  6396             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6397             20  CM-ACCOUNT-PRIME          PIC X(6).
  6398         16  CM-CERT-EFF-DT                PIC XX.
  6399         16  CM-CERT-NO.
  6400             20  CM-CERT-PRIME             PIC X(10).
  6401             20  CM-CERT-SFX               PIC X.
  6402
  6403     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 119
* EL6311.cbl
  6404         16  CM-COMPANY-CD-A1              PIC X.
  6405         16  CM-INSURED-LAST-NAME          PIC X(15).
  6406         16  CM-INSURED-INITIALS.
  6407             20  CM-INSURED-INITIAL1       PIC X.
  6408             20  CM-INSURED-INITIAL2       PIC X.
  6409
  6410     12  CM-CONTROL-BY-SSN.
  6411         16  CM-COMPANY-CD-A2              PIC X.
  6412         16  CM-SOC-SEC-NO.
  6413             20  CM-SSN-STATE              PIC XX.
  6414             20  CM-SSN-ACCOUNT            PIC X(6).
  6415             20  CM-SSN-LN3.
  6416                 25  CM-INSURED-INITIALS-A2.
  6417                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6418                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6419                 25 CM-PART-LAST-NAME-A2         PIC X.
  6420
  6421     12  CM-CONTROL-BY-CERT-NO.
  6422         16  CM-COMPANY-CD-A4              PIC X.
  6423         16  CM-CERT-NO-A4                 PIC X(11).
  6424
  6425     12  CM-CONTROL-BY-MEMB.
  6426         16  CM-COMPANY-CD-A5              PIC X.
  6427         16  CM-MEMBER-NO.
  6428             20  CM-MEMB-STATE             PIC XX.
  6429             20  CM-MEMB-ACCOUNT           PIC X(6).
  6430             20  CM-MEMB-LN4.
  6431                 25  CM-INSURED-INITIALS-A5.
  6432                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6433                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6434                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6435
  6436     12  CM-INSURED-PROFILE-DATA.
  6437         16  CM-INSURED-FIRST-NAME.
  6438             20  CM-INSURED-1ST-INIT       PIC X.
  6439             20  FILLER                    PIC X(9).
  6440         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6441         16  CM-INSURED-SEX                PIC X.
  6442             88  CM-SEX-MALE                  VALUE 'M'.
  6443             88  CM-SEX-FEMAL                 VALUE 'F'.
  6444         16  CM-INSURED-JOINT-AGE          PIC 99.
  6445         16  CM-JOINT-INSURED-NAME.
  6446             20  CM-JT-LAST-NAME           PIC X(15).
  6447             20  CM-JT-FIRST-NAME.
  6448                 24  CM-JT-1ST-INIT        PIC X.
  6449                 24  FILLER                PIC X(9).
  6450             20  CM-JT-INITIAL             PIC X.
  6451
  6452     12  CM-LIFE-DATA.
  6453         16  CM-LF-BENEFIT-CD              PIC XX.
  6454         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6455         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6456         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6457         16  CM-LF-DEV-CODE                PIC XXX.
  6458         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6459         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6460         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6461         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 120
* EL6311.cbl
  6462         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6463         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6464         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6465         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6466         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6467         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6468         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6469         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6470         16  FILLER                        PIC XX.
  6471
  6472     12  CM-AH-DATA.
  6473         16  CM-AH-BENEFIT-CD              PIC XX.
  6474         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6475         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6476         16  CM-AH-DEV-CODE                PIC XXX.
  6477         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6478         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6479         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6480         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6481         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6482         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6483         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6484         16  CM-AH-PAID-THRU-DT            PIC XX.
  6485             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6486         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6487         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6488         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6489         16  FILLER                        PIC X.
  6490
  6491     12  CM-LOAN-INFORMATION.
  6492         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6493         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6494                                           PIC S9(5)V99  COMP-3.
  6495         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6496         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6497         16  CM-PAY-FREQUENCY              PIC S99.
  6498         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6499         16  CM-RATE-CLASS                 PIC XX.
  6500         16  CM-BENEFICIARY                PIC X(25).
  6501         16  CM-POLICY-FORM-NO             PIC X(12).
  6502         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6503         16  CM-LAST-ADD-ON-DT             PIC XX.
  6504         16  CM-DEDUCTIBLE-AMOUNTS.
  6505             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6506             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6507         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6508             20  CM-RESIDENT-STATE         PIC XX.
  6509             20  CM-RATE-CODE              PIC X(4).
  6510             20  FILLER                    PIC XX.
  6511         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6512             20  CM-LOAN-OFFICER           PIC X(5).
  6513             20  FILLER                    PIC XXX.
  6514         16  CM-CSR-CODE                   PIC XXX.
  6515         16  CM-UNDERWRITING-CODE          PIC X.
  6516             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6517         16  CM-POST-CARD-IND              PIC X.
  6518         16  CM-NH-INTERFACE-SW            PIC X.
  6519         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 121
* EL6311.cbl
  6520             88  CM-SING-PRM                  VALUE '1'.
  6521             88  CM-O-B-COVERAGE              VALUE '2'.
  6522             88  CM-OPEN-END                  VALUE '3'.
  6523         16  CM-IND-GRP-TYPE               PIC X.
  6524             88  CM-INDIVIDUAL                VALUE 'I'.
  6525             88  CM-GROUP                     VALUE 'G'.
  6526         16  CM-SKIP-CODE                  PIC X.
  6527             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6528             88  SKIP-JULY                    VALUE '1'.
  6529             88  SKIP-AUGUST                  VALUE '2'.
  6530             88  SKIP-SEPTEMBER               VALUE '3'.
  6531             88  SKIP-JULY-AUG                VALUE '4'.
  6532             88  SKIP-AUG-SEPT                VALUE '5'.
  6533             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6534             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6535             88  SKIP-JUNE                    VALUE '8'.
  6536             88  SKIP-JUNE-JULY               VALUE '9'.
  6537             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6538             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6539         16  CM-PAYMENT-MODE               PIC X.
  6540             88  PAY-MONTHLY                  VALUE SPACE.
  6541             88  PAY-WEEKLY                   VALUE '1'.
  6542             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6543             88  PAY-BI-WEEKLY                VALUE '3'.
  6544             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6545         16  CM-LOAN-NUMBER                PIC X(8).
  6546         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6547         16  CM-OLD-LOF                    PIC XXX.
  6548*        16  CM-LOAN-OFFICER               PIC XXX.
  6549         16  CM-REIN-TABLE                 PIC XXX.
  6550         16  CM-SPECIAL-REIN-CODE          PIC X.
  6551         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6552         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6553         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6554
  6555     12  CM-STATUS-DATA.
  6556         16  CM-ENTRY-STATUS               PIC X.
  6557         16  CM-ENTRY-DT                   PIC XX.
  6558
  6559         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6560         16  CM-LF-CANCEL-DT               PIC XX.
  6561         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6562
  6563         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6564         16  CM-LF-DEATH-DT                PIC XX.
  6565         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6566
  6567         16  CM-LF-CURRENT-STATUS          PIC X.
  6568             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6569                                                'M' '4' '5' '9'.
  6570             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6571             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6572             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6573             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6574             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6575             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6576             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6577             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 122
* EL6311.cbl
  6578             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6579             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6580             88  CM-LF-DECLINED               VALUE 'D'.
  6581             88  CM-LF-VOIDED                 VALUE 'V'.
  6582
  6583         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6584         16  CM-AH-CANCEL-DT               PIC XX.
  6585         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6586
  6587         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6588         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6589         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6590
  6591         16  CM-AH-CURRENT-STATUS          PIC X.
  6592             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6593                                                'M' '4' '5' '9'.
  6594             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6595             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6596             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6597             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6598             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6599             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6600             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6601             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6602             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6603             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6604             88  CM-AH-DECLINED               VALUE 'D'.
  6605             88  CM-AH-VOIDED                 VALUE 'V'.
  6606
  6607         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6608             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6609             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6610             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6611         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6612
  6613         16  CM-ENTRY-BATCH                PIC X(6).
  6614         16  CM-LF-EXIT-BATCH              PIC X(6).
  6615         16  CM-AH-EXIT-BATCH              PIC X(6).
  6616         16  CM-LAST-MONTH-END             PIC XX.
  6617
  6618     12  CM-NOTE-SW                        PIC X.
  6619         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6620         88  CERT-NOTES-PRESENT               VALUE '1'.
  6621         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6622         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6623         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6624         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6625         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6626         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6627     12  CM-COMP-EXCP-SW                   PIC X.
  6628         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6629         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6630     12  CM-INSURED-ADDRESS-SW             PIC X.
  6631         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6632         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6633
  6634*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6635     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 123
* EL6311.cbl
  6636     12  FILLER                            PIC X.
  6637
  6638*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6639     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6640     12  FILLER                            PIC X.
  6641*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6642     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6643
  6644     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6645         88  CERT-ADDED-BATCH                 VALUE ' '.
  6646         88  CERT-ADDED-ONLINE                VALUE '1'.
  6647         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6648         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6649         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6650     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6651         88  CERT-AS-LOADED                   VALUE ' '.
  6652         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6653         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6654         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6655         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6656         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6657         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6658         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6659
  6660     12  CM-ACCOUNT-COMM-PCTS.
  6661         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6662         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6663
  6664     12  CM-USER-FIELD                     PIC X.
  6665     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6666     12  CM-CLP-STATE                      PIC XX.
  6667     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6668     12  CM-USER-RESERVED                  PIC XXX.
  6669     12  FILLER REDEFINES CM-USER-RESERVED.
  6670         16  CM-AH-CLASS-CD                PIC XX.
  6671         16  F                             PIC X.
  6672******************************************************************
  6673
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 124
* EL6311.cbl
  6675*    COPY ERCNOTE.
  6676******************************************************************
  6677*                                                                *
  6678*                                                                *
  6679*                            ERCNOTE                             *
  6680*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6681*                            VMOD=2.003                          *
  6682*                                                                *
  6683*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6684*                                                                *
  6685*        FILE TYPE= VSAM,KSDS                                    *
  6686*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6687*                                                                *
  6688*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6689*                                                                *
  6690*        LOG = YES                                               *
  6691*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6692*                                                                *
  6693******************************************************************
  6694*                   C H A N G E   L O G
  6695*
  6696* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6697*-----------------------------------------------------------------
  6698*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6699* EFFECTIVE    NUMBER
  6700*-----------------------------------------------------------------
  6701* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6702*                                FILE WILL CONTAIN BILLING NOTES O
  6703******************************************************************
  6704
  6705 01  CERTIFICATE-NOTE.
  6706     12  CN-RECORD-ID                PIC  XX.
  6707         88  VALID-CN-ID                  VALUE 'CN'.
  6708
  6709     12  CN-CONTROL-PRIMARY.
  6710         16  CN-COMPANY-CD           PIC X.
  6711         16  CN-CARRIER              PIC X.
  6712         16  CN-GROUPING.
  6713             20 CN-GROUPING-PREFIX   PIC XXX.
  6714             20 CN-GROUPING-PRIME    PIC XXX.
  6715         16  CN-STATE                PIC XX.
  6716         16  CN-ACCOUNT.
  6717             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6718             20 CN-ACCOUNT-PRIME     PIC X(6).
  6719         16  CN-CERT-EFF-DT          PIC XX.
  6720         16  CN-CERT-NO.
  6721             20  CN-CERT-PRIME       PIC X(10).
  6722             20  CN-CERT-SFX         PIC X.
  6723
  6724     12  CN-BILLING-START-LINE-NO    PIC 99.
  6725     12  CN-BILLING-END-LINE-NO      PIC 99.
  6726
  6727     12  CN-LINES.
  6728         16  CN-LINE OCCURS 10       PIC X(77).
  6729
  6730     12  CN-LAST-MAINT-DT            PIC XX.
  6731     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6732     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 125
* EL6311.cbl
  6733     12  FILLER                      PIC X(6).
  6734******************************************************************
  6735
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 126
* EL6311.cbl
  6737*    COPY ERCPNDM.
  6738******************************************************************
  6739*                                                                *
  6740*                                                                *
  6741*                            ERCPNDM                             *
  6742*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6743*                            VMOD=2.003                          *
  6744*                                                                *
  6745*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6746*                                                                *
  6747*   FILE TYPE = VSAM,KSDS                                        *
  6748*   RECORD SIZE = 374   RECFORM = FIX                            *
  6749*                                                                *
  6750*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6751*   ALTERNATE PATH    = NOT USED                                 *
  6752*                                                                *
  6753*   LOG = YES                                                    *
  6754*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6755******************************************************************
  6756*                   C H A N G E   L O G
  6757*
  6758* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6759*-----------------------------------------------------------------
  6760*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6761* EFFECTIVE    NUMBER
  6762*-----------------------------------------------------------------
  6763* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6764* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6765* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6766******************************************************************
  6767
  6768 01  PENDING-MAILING-DATA.
  6769     12  PM-RECORD-ID                      PIC XX.
  6770         88  VALID-MA-ID                       VALUE 'PM'.
  6771
  6772     12  PM-CONTROL-PRIMARY.
  6773         16  PM-COMPANY-CD                 PIC X.
  6774         16  PM-ENTRY-BATCH                PIC X(6).
  6775         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6776         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6777
  6778     12  FILLER                            PIC X(14).
  6779
  6780     12  PM-ACCESS-CONTROL.
  6781         16  PM-SOURCE-SYSTEM              PIC XX.
  6782             88  PM-FROM-CREDIT                VALUE 'CR'.
  6783             88  PM-FROM-VSI                   VALUE 'VS'.
  6784             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6785             88  PM-FROM-OTHER                 VALUE 'OT'.
  6786         16  PM-RECORD-ADD-DT              PIC XX.
  6787         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6788         16  PM-LAST-MAINT-DT              PIC XX.
  6789         16  PM-LAST-MAINT-BY              PIC XXXX.
  6790         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6791
  6792     12  PM-PROFILE-INFO.
  6793         16  PM-QUALIFY-CODE-1             PIC XX.
  6794         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 127
* EL6311.cbl
  6795         16  PM-QUALIFY-CODE-3             PIC XX.
  6796         16  PM-QUALIFY-CODE-4             PIC XX.
  6797         16  PM-QUALIFY-CODE-5             PIC XX.
  6798
  6799         16  PM-INSURED-LAST-NAME          PIC X(15).
  6800         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6801         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6802         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6803         16  PM-INSURED-BIRTH-DT           PIC XX.
  6804         16  PM-INSURED-SEX                PIC X.
  6805             88  PM-SEX-MALE                   VALUE 'M'.
  6806             88  PM-SEX-FEMALE                 VALUE 'F'.
  6807         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6808
  6809         16  PM-ADDRESS-CORRECTED          PIC X.
  6810         16  PM-JOINT-BIRTH-DT             PIC XX.
  6811*        16  FILLER                        PIC X(12).
  6812
  6813         16  PM-ADDRESS-LINE-1             PIC X(30).
  6814         16  PM-ADDRESS-LINE-2             PIC X(30).
  6815         16  PM-CITY-STATE.
  6816             20  PM-CITY                   PIC X(28).
  6817             20  PM-STATE                  PIC XX.
  6818         16  PM-ZIP.
  6819             20  PM-ZIP-CODE.
  6820                 24  PM-ZIP-1              PIC X.
  6821                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6822                 24  FILLER                PIC X(4).
  6823             20  PM-ZIP-PLUS4              PIC X(4).
  6824         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6825             20  PM-CAN-POST1              PIC XXX.
  6826             20  PM-CAN-POST2              PIC XXX.
  6827             20  FILLER                    PIC XXX.
  6828
  6829         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6830
  6831         16  FILLER                        PIC X(03).
  6832
  6833     12  PM-CRED-BENE-INFO.
  6834         16  PM-CRED-BENE-NAME             PIC X(25).
  6835         16  PM-CRED-BENE-ADDR             PIC X(30).
  6836         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6837         16  PM-CRED-BENE-CTYST.
  6838             20  PM-CRED-BENE-CITY         PIC X(28).
  6839             20  PM-CRED-BENE-STATE        PIC XX.
  6840         16  PM-CRED-BENE-ZIP.
  6841             20  PM-CB-ZIP-CODE.
  6842                 24  PM-CB-ZIP-1           PIC X.
  6843                     88  PM-CB-CANADIAN-POST-CODE
  6844                                  VALUE 'A' THRU 'Z'.
  6845                 24  FILLER                PIC X(4).
  6846             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6847         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6848             20  PM-CB-CAN-POST1           PIC XXX.
  6849             20  PM-CB-CAN-POST2           PIC XXX.
  6850             20  FILLER                    PIC XXX.
  6851     12  PM-POST-CARD-MAIL-DATA.
  6852         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 128
* EL6311.cbl
  6853             20  PM-MAIL-TYPE              PIC X.
  6854                 88  PM-12MO-MAILING           VALUE '1'.
  6855                 88  PM-EXP-MAILING            VALUE '2'.
  6856             20  PM-MAIL-STATUS            PIC X.
  6857                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6858                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6859                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6860             20  PM-MAIL-DATE              PIC XX.
  6861     12  FILLER                            PIC XX.
  6862     12  FILLER                            PIC X(12).
  6863*    12  FILLER                            PIC X(30).
  6864
  6865******************************************************************
  6866
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 129
* EL6311.cbl
  6868*    COPY ERCMAIL.
  6869******************************************************************
  6870*                                                                *
  6871*                                                                *
  6872*                            ERCMAIL                             *
  6873*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6874*                            VMOD=2.003                          *
  6875*                                                                *
  6876*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6877*                                                                *
  6878*   FILE TYPE = VSAM,KSDS                                        *
  6879*   RECORD SIZE = 374   RECFORM = FIX                            *
  6880*                                                                *
  6881*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6882*   ALTERNATE PATH    = NOT USED                                 *
  6883*                                                                *
  6884*   LOG = YES                                                    *
  6885*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6886******************************************************************
  6887*                   C H A N G E   L O G
  6888*
  6889* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6890*-----------------------------------------------------------------
  6891*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6892* EFFECTIVE    NUMBER
  6893*-----------------------------------------------------------------
  6894* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6895* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6896* 111108                   PEMA  ADD CRED BENE ADDR2
  6897******************************************************************
  6898
  6899 01  MAILING-DATA.
  6900     12  MA-RECORD-ID                      PIC XX.
  6901         88  VALID-MA-ID                       VALUE 'MA'.
  6902
  6903     12  MA-CONTROL-PRIMARY.
  6904         16  MA-COMPANY-CD                 PIC X.
  6905         16  MA-CARRIER                    PIC X.
  6906         16  MA-GROUPING.
  6907             20  MA-GROUPING-PREFIX        PIC XXX.
  6908             20  MA-GROUPING-PRIME         PIC XXX.
  6909         16  MA-STATE                      PIC XX.
  6910         16  MA-ACCOUNT.
  6911             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6912             20  MA-ACCOUNT-PRIME          PIC X(6).
  6913         16  MA-CERT-EFF-DT                PIC XX.
  6914         16  MA-CERT-NO.
  6915             20  MA-CERT-PRIME             PIC X(10).
  6916             20  MA-CERT-SFX               PIC X.
  6917
  6918     12  FILLER                            PIC XX.
  6919
  6920     12  MA-ACCESS-CONTROL.
  6921         16  MA-SOURCE-SYSTEM              PIC XX.
  6922             88  MA-FROM-CREDIT                VALUE 'CR'.
  6923             88  MA-FROM-VSI                   VALUE 'VS'.
  6924             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6925             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 130
* EL6311.cbl
  6926         16  MA-RECORD-ADD-DT              PIC XX.
  6927         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6928         16  MA-LAST-MAINT-DT              PIC XX.
  6929         16  MA-LAST-MAINT-BY              PIC XXXX.
  6930         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6931
  6932     12  MA-PROFILE-INFO.
  6933         16  MA-QUALIFY-CODE-1             PIC XX.
  6934         16  MA-QUALIFY-CODE-2             PIC XX.
  6935         16  MA-QUALIFY-CODE-3             PIC XX.
  6936         16  MA-QUALIFY-CODE-4             PIC XX.
  6937         16  MA-QUALIFY-CODE-5             PIC XX.
  6938
  6939         16  MA-INSURED-LAST-NAME          PIC X(15).
  6940         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6941         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6942         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6943         16  MA-INSURED-BIRTH-DT           PIC XX.
  6944         16  MA-INSURED-SEX                PIC X.
  6945             88  MA-SEX-MALE                   VALUE 'M'.
  6946             88  MA-SEX-FEMALE                 VALUE 'F'.
  6947         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6948
  6949         16  MA-ADDRESS-CORRECTED          PIC X.
  6950         16  MA-JOINT-BIRTH-DT             PIC XX.
  6951*        16  FILLER                        PIC X(12).
  6952
  6953         16  MA-ADDRESS-LINE-1             PIC X(30).
  6954         16  MA-ADDRESS-LINE-2             PIC X(30).
  6955         16  MA-CITY-STATE.
  6956             20  MA-CITY                   PIC X(28).
  6957             20  MA-ADDR-STATE             PIC XX.
  6958         16  MA-ZIP.
  6959             20  MA-ZIP-CODE.
  6960                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6961                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6962                 24  FILLER                PIC X(4).
  6963             20  MA-ZIP-PLUS4              PIC X(4).
  6964         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6965             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6966             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6967             20  FILLER                    PIC X(3).
  6968
  6969         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6970
  6971         16  FILLER                        PIC XXX.
  6972*        16  FILLER                        PIC X(10).
  6973
  6974     12  MA-CRED-BENE-INFO.
  6975         16  MA-CRED-BENE-NAME                 PIC X(25).
  6976         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6977         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6978         16  MA-CRED-BENE-CTYST.
  6979             20  MA-CRED-BENE-CITY             PIC X(28).
  6980             20  MA-CRED-BENE-STATE            PIC XX.
  6981         16  MA-CRED-BENE-ZIP.
  6982             20  MA-CB-ZIP-CODE.
  6983                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 131
* EL6311.cbl
  6984                     88  MA-CB-CANADIAN-POST-CODE
  6985                                           VALUE 'A' THRU 'Z'.
  6986                 24  FILLER                    PIC X(4).
  6987             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6988         16  MA-CB-CANADIAN-POSTAL-CODE
  6989                            REDEFINES MA-CRED-BENE-ZIP.
  6990             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6991             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6992             20  FILLER                        PIC X(3).
  6993     12  MA-POST-CARD-MAIL-DATA.
  6994         16  MA-MAIL-DATA OCCURS 7.
  6995             20  MA-MAIL-TYPE              PIC X.
  6996                 88  MA-12MO-MAILING           VALUE '1'.
  6997                 88  MA-EXP-MAILING            VALUE '2'.
  6998             20  MA-MAIL-STATUS            PIC X.
  6999                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7000                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7001                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7002             20  MA-MAIL-DATE              PIC XX.
  7003     12  FILLER                            PIC XX.
  7004     12  FILLER                            PIC XX.
  7005*    12  FILLER                            PIC X(30).
  7006******************************************************************
  7007
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 132
* EL6311.cbl
  7009*    COPY ERCRQST.
  7010******************************************************************
  7011*                                                                *
  7012*                                                                *
  7013*                            ERCRQST.                            *
  7014*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7015*                            VMOD=2.002                          *
  7016*                                                                *
  7017*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7018*                                                                *
  7019*   FILE TYPE = VSAM,KSDS                                        *
  7020*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7021*                                                                *
  7022*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7023*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7024*                                   ACCOUNT, REF, BATCH)         *
  7025*                                                RKP=9, LEN=38   *
  7026*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7027*                                   ACCOUNT, REF, BATCH)         *
  7028*                                                RKP=47, LEN=46  *
  7029*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  7030*                                   BATCH)                       *
  7031*                                                RKP=93, LEN=24  *
  7032*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7033*                                   REF, BATCH)                  *
  7034*                                                RKP=117, LEN=35 *
  7035*   LOG = NO                                                     *
  7036*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7037******************************************************************
  7038
  7039 01  AR-REQUEST-RECORD.
  7040     12  RQ-RECORD-ID                     PIC XX.
  7041         88  VALID-RQ-ID                        VALUE 'RQ'.
  7042
  7043     12  RQ-CONTROL-PRIMARY.
  7044         16  RQ-COMPANY-CD                PIC X.
  7045         16  RQ-ENTRY-BATCH               PIC X(6).
  7046
  7047     12  RQ-CONTROL-BY-ACCT-REF.
  7048         16  RQ-COMPANY-CD-A1             PIC X.
  7049         16  RQ-CARRIER-A1                PIC X.
  7050         16  RQ-GROUPING-A1               PIC X(6).
  7051         16  RQ-STATE-A1                  PIC XX.
  7052         16  RQ-ACCOUNT-A1                PIC X(10).
  7053         16  RQ-REFERENCE-A1              PIC X(12).
  7054         16  RQ-BATCH-A1                  PIC X(6).
  7055
  7056     12  RQ-CONTROL-BY-FIN-RESP.
  7057         16  RQ-COMPANY-CD-A2             PIC X.
  7058         16  RQ-CARRIER-A2                PIC X.
  7059         16  RQ-GROUPING-A2               PIC X(6).
  7060         16  RQ-FIN-RESP-A2               PIC X(10).
  7061         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7062         16  RQ-REFERENCE-A2              PIC X(12).
  7063         16  RQ-BATCH-A2                  PIC X(6).
  7064
  7065     12  RQ-CONTROL-BY-ACCT-AGENT.
  7066         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 133
* EL6311.cbl
  7067         16  RQ-CARRIER-A3                PIC X.
  7068         16  RQ-GROUPING-A3               PIC X(6).
  7069         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7070         16  RQ-BATCH-A3                  PIC X(6).
  7071
  7072     12  RQ-CONTROL-BY-SUMMARY.
  7073         16  RQ-COMPANY-CD-A4             PIC X.
  7074         16  RQ-SUMMARY-CODE              PIC X(6).
  7075         16  RQ-ACCOUNT-A4                PIC X(10).
  7076         16  RQ-REFERENCE-A4              PIC X(12).
  7077         16  RQ-BATCH-A4                  PIC X(6).
  7078
  7079     12  RQ-REQUEST-METHOD                PIC X.
  7080         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7081         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7082         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7083         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7084     12  FILLER                           PIC X.
  7085     12  RQ-STATUS                        PIC X.
  7086         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7087         88  RQ-RESUBMIT                      VALUE 'R'.
  7088     12  RQ-PROCESSOR-ID                  PIC X(4).
  7089     12  RQ-ENTRY-DT                      PIC XX.
  7090     12  RQ-MO-END-DT                     PIC XX.
  7091     12  RQ-REQUEST-DT                    PIC XX.
  7092     12  RQ-STMT-DT                       PIC XX.
  7093     12  RQ-REVERSAL-DT                   PIC XX.
  7094     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7095     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7096
  7097     12  FILLER                           PIC X(27).
  7098
  7099******************************************************************
  7100
  7101
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 134
* EL6311.cbl
  7103*    COPY ERCLOFC.
  7104******************************************************************
  7105*                                                                *
  7106*                                                                *
  7107*                            ERCLOFC                             *
  7108*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7109*                            VMOD=2.003                          *
  7110*                                                                *
  7111*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7112*                                                                *
  7113*   FILE TYPE = VSAM,KSDS                                        *
  7114*   RECORD SIZE = 670   RECFORM = FIX                            *
  7115*                                                                *
  7116*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7117*                                                                *
  7118*   LOG = YES                                                    *
  7119*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7120*                                                                *
  7121******************************************************************
  7122
  7123 01  LOAN-OFFICER-MASTER.
  7124     12  LO-RECORD-ID                PIC XX.
  7125         88  VALID-LO-ID                VALUE 'LO'.
  7126
  7127     12  LO-CONTROL-PRIMARY.
  7128         16  LO-COMPANY-CD           PIC X.
  7129         16  LO-CARRIER              PIC X.
  7130         16  LO-GROUPING.
  7131             20  LO-GROUPING-PREFIX  PIC XXX.
  7132             20  LO-GROUPING-PRIME   PIC XXX.
  7133         16  LO-STATE                PIC XX.
  7134         16  LO-ACCOUNT.
  7135             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7136             20  LO-ACCOUNT-PRIME    PIC X(6).
  7137         16  LO-OFFICER-CODE         PIC X(5).
  7138
  7139     12  LO-OFFICER-NAME             PIC X(30).
  7140
  7141     12  LO-LAST-MAINT-DT            PIC XX.
  7142     12  LO-LAST-USER                PIC X(4).
  7143     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7144
  7145     12  LO-COMP-CONTROL             PIC X.
  7146             88  LO-SHOW-COMP           VALUE 'Y'.
  7147             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7148     12  LO-DETAIL-CONTROL           PIC X.
  7149             88  LO-PRINT-DETAIL        VALUE 'D'.
  7150             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7151
  7152     12  LO-SV-CARRIER               PIC X.
  7153     12  LO-SV-GROUPING              PIC X(6).
  7154     12  LO-SV-STATE                 PIC XX.
  7155
  7156     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7157     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7158
  7159     12  LO-OFFICER-INFO.
  7160         16  FILLER OCCURS 12 TIMES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 135
* EL6311.cbl
  7161             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7162             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7163             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7164             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7165             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7166             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7167             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7168             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7169     12  FILLER                      PIC X(198).
  7170******************************************************************
  7171
  7172*    COPY ERCPYAJ.
  7173******************************************************************
  7174*                                                                *
  7175*                            ERCPYAJ                             *
  7176*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7177*                            VMOD=2.015                          *
  7178*                                                                *
  7179*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7180*                                                                *
  7181*                                                                *
  7182*   FILE TYPE = VSAM,KSDS                                        *
  7183*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7184*                                                                *
  7185*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7186*       ALTERNATE PATHS = NONE                                   *
  7187*                                                                *
  7188*   LOG = YES                                                    *
  7189*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7190******************************************************************
  7191******************************************************************
  7192*                   C H A N G E   L O G
  7193*
  7194* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7195*-----------------------------------------------------------------
  7196*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7197* EFFECTIVE    NUMBER
  7198*-----------------------------------------------------------------
  7199* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7200* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7201******************************************************************
  7202
  7203 01  PENDING-PAY-ADJ.
  7204     12  PY-RECORD-ID                     PIC XX.
  7205         88  VALID-PY-ID                        VALUE 'PY'.
  7206
  7207     12  PY-CONTROL-PRIMARY.
  7208         16  PY-COMPANY-CD                PIC X.
  7209         16  PY-CARRIER                   PIC X.
  7210         16  PY-GROUPING                  PIC X(6).
  7211         16  PY-FIN-RESP                  PIC X(10).
  7212         16  PY-ACCOUNT                   PIC X(10).
  7213         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7214                                          PIC X(10).
  7215         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7216         16  PY-RECORD-TYPE               PIC X.
  7217             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7218             88  PY-DEPOSIT                   VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 136
* EL6311.cbl
  7219             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7220             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7221             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7222             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7223             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7224             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7225             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7226             88  PY-FICA-ENTRY                VALUE 'F'.
  7227             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7228             88  PY-POLICY-FEE                VALUE 'W'.
  7229             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7230
  7231     12  PY-PYMT-TYPE                     PIC X.
  7232             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7233             88  PY-REINS-PYMT                VALUE 'R'.
  7234             88  PY-EXP-PYMT                  VALUE 'E'.
  7235
  7236     12  PY-BIL-INV                       PIC X(6).
  7237     12  PY-REF-NO                        PIC X(12).
  7238
  7239     12  PY-LAST-MAINT-DT                 PIC XX.
  7240     12  PY-LAST-MAINT-BY                 PIC X(4).
  7241     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7242
  7243     12  PY-PYADJ-RECORD.
  7244         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7245         16  PY-ENTRY-COMMENT             PIC X(30).
  7246         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7247             20  PY-GL-ACCOUNT            PIC X(10).
  7248             20  PY-GL-STATE              PIC X(02).
  7249             20  PY-GL-CANC-SW            PIC X(01).
  7250                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7251                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7252             20  PY-GL-COMMENT            PIC X(10).
  7253             20  FILLER      REDEFINES PY-GL-COMMENT.
  7254                 24  PY-GL-CHECK-NO       PIC 9(06).
  7255                 24  FILLER               PIC X(04).
  7256             20  FILLER                   PIC X(07).
  7257         16  PY-SAVE-ACCOUNT              PIC X(10).
  7258         16  PY-SAVE-TYPE                 PIC X(01).
  7259
  7260         16  PY-LETTERS.
  7261             20  PY-LETTER OCCURS 3 TIMES
  7262                           INDEXED BY PY-LET-NDX
  7263                                          PIC X(04).
  7264
  7265         16  PY-ERCOMP-TYPE               PIC X.
  7266             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7267             88  PY-GA-TYPE                   VALUE 'G'.
  7268             88  PY-BANK-TYPE                 VALUE 'B'.
  7269         16  FILLER                       PIC X(05).
  7270
  7271     12  PY-RECORD-STATUS.
  7272         16  PY-CREDIT-SELECT-DT          PIC XX.
  7273         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7274         16  PY-BILLED-DATE               PIC XX.
  7275         16  PY-REPORTED-DT               PIC XX.
  7276         16  PY-PMT-APPLIED               PIC X.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 137
* EL6311.cbl
  7277             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7278             88  PY-GA-PMT                    VALUE 'G'.
  7279             88  PY-OVWRITE-PMT               VALUE 'O'.
  7280             88  PY-NON-AR-PMT                VALUE 'N'.
  7281         16  FILLER                       PIC X(5).
  7282         16  PY-INPUT-DT                  PIC XX.
  7283         16  PY-CHECK-NUMBER              PIC X(6).
  7284         16  PY-VOID-SW                   PIC X.
  7285             88  PY-CHECK-VOIDED              VALUE 'V'.
  7286         16  PY-CHECK-ORIGIN-SW           PIC X.
  7287             88  PY-BILLING-CHECK             VALUE 'B'.
  7288             88  PY-REFUND-CHECK              VALUE 'R'.
  7289             88  PY-GA-CHECK                  VALUE 'G'.
  7290             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7291             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7292         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7293         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7294         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7295         16  PY-BILL-FLAG                 PIC X.
  7296             88  PY-BILLED                    VALUE 'B'.
  7297         16  PY-AR-FLAG                   PIC X.
  7298             88  PY-AR-CYCLE                  VALUE 'C'.
  7299             88  PY-AR-MONTH-END              VALUE 'M'.
  7300         16  PY-AR-DATE                   PIC XX.
  7301
  7302     12  PY-GL-CODES.
  7303         16  PY-GL-DB                     PIC X(14).
  7304         16  PY-GL-CR                     PIC X(14).
  7305         16  PY-GL-FLAG                   PIC X.
  7306         16  PY-GL-DATE                   PIC XX.
  7307
  7308     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7309     12  FILLER                           PIC X(3).
  7310******************************************************************
  7311
  7312*    COPY ERCCNOT.
  7313******************************************************************
  7314*                                                                *
  7315*                            ERCCNOT                             *
  7316*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7317*                            VMOD=2.003                          *
  7318*                                                                *
  7319*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7320*                                                                *
  7321*        FILE TYPE= VSAM,KSDS                                    *
  7322*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7323*                                                                *
  7324*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7325*                                                                *
  7326*        LOG = YES                                               *
  7327*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7328*                                                                *
  7329******************************************************************
  7330*                   C H A N G E   L O G
  7331*
  7332* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7333*-----------------------------------------------------------------
  7334*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 138
* EL6311.cbl
  7335* EFFECTIVE    NUMBER
  7336*-----------------------------------------------------------------
  7337* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7338******************************************************************
  7339
  7340 01  CERT-NOTE-FILE.
  7341     12  CZ-RECORD-ID                PIC  XX.
  7342         88  VALID-CZ-ID                  VALUE 'CZ'.
  7343
  7344     12  CZ-CONTROL-PRIMARY.
  7345         16  CZ-COMPANY-CD           PIC X.
  7346         16  CZ-CARRIER              PIC X.
  7347         16  CZ-GROUPING.
  7348             20 CZ-GROUPING-PREFIX   PIC XXX.
  7349             20 CZ-GROUPING-PRIME    PIC XXX.
  7350         16  CZ-STATE                PIC XX.
  7351         16  CZ-ACCOUNT.
  7352             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7353             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7354         16  CZ-CERT-EFF-DT          PIC XX.
  7355         16  CZ-CERT-NO.
  7356             20  CZ-CERT-PRIME       PIC X(10).
  7357             20  CZ-CERT-SFX         PIC X.
  7358         16  CZ-RECORD-TYPE          PIC X.
  7359             88  CERT-NOTE           VALUE '1'.
  7360             88  CLAIM-CERT-NOTE     VALUE '2'.
  7361         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7362
  7363     12  CZ-LAST-MAINT-DT            PIC XX.
  7364     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7365     12  CZ-LAST-MAINT-USER          PIC X(4).
  7366
  7367     12  CZ-NOTE-INFORMATION.
  7368         16  CZ-NOTE                 PIC X(63).
  7369         16  FILLER                  PIC X(39).
  7370******************************************************************
  7371
  7372*    COPY ELCMSTR.
  7373******************************************************************
  7374*                                                                *
  7375*                            ELCMSTR.                            *
  7376*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7377*                            VMOD=2.012                          *
  7378*                                                                *
  7379*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7380*                                                                *
  7381*   FILE TYPE = VSAM,KSDS                                        *
  7382*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7383*                                                                *
  7384*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7385*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7386*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7387*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7388*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7389*                                                 RKP=75,LEN=21  *
  7390*                                                                *
  7391*   **** NOTE ****                                               *
  7392*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 139
* EL6311.cbl
  7393*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7394*                                                                *
  7395*   LOG = YES                                                    *
  7396*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7397******************************************************************
  7398*                   C H A N G E   L O G
  7399*
  7400* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7401*-----------------------------------------------------------------
  7402*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7403* EFFECTIVE    NUMBER
  7404*-----------------------------------------------------------------
  7405* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7406* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7407* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7408******************************************************************
  7409 01  CLAIM-MASTER.
  7410     12  CL-RECORD-ID                PIC XX.
  7411         88  VALID-CL-ID         VALUE 'CL'.
  7412
  7413     12  CL-CONTROL-PRIMARY.
  7414         16  CL-COMPANY-CD           PIC X.
  7415         16  CL-CARRIER              PIC X.
  7416         16  CL-CLAIM-NO             PIC X(7).
  7417         16  CL-CERT-NO.
  7418             20  CL-CERT-PRIME       PIC X(10).
  7419             20  CL-CERT-SFX         PIC X.
  7420
  7421     12  CL-CONTROL-BY-NAME.
  7422         16  CL-COMPANY-CD-A1        PIC X.
  7423         16  CL-INSURED-LAST-NAME    PIC X(15).
  7424         16  CL-INSURED-NAME.
  7425             20  CL-INSURED-1ST-NAME PIC X(12).
  7426             20  CL-INSURED-MID-INIT PIC X.
  7427
  7428     12  CL-CONTROL-BY-SSN.
  7429         16  CL-COMPANY-CD-A2        PIC X.
  7430         16  CL-SOC-SEC-NO.
  7431             20  CL-SSN-STATE        PIC XX.
  7432             20  CL-SSN-ACCOUNT      PIC X(6).
  7433             20  CL-SSN-LN3          PIC X(3).
  7434
  7435     12  CL-CONTROL-BY-CERT-NO.
  7436         16  CL-COMPANY-CD-A4        PIC X.
  7437         16  CL-CERT-NO-A4.
  7438             20  CL-CERT-A4-PRIME    PIC X(10).
  7439             20  CL-CERT-A4-SFX      PIC X.
  7440
  7441     12  CL-CONTROL-BY-CCN.
  7442         16  CL-COMPANY-CD-A5        PIC X.
  7443         16  CL-CCN-A5.
  7444             20  CL-CCN.
  7445                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7446                 24  CL-CCN-PRIME-A5 PIC X(12).
  7447             20  CL-CCN-FILLER-A5    PIC X(4).
  7448
  7449     12  CL-INSURED-PROFILE-DATA.
  7450         16  CL-INSURED-BIRTH-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 140
* EL6311.cbl
  7451         16  CL-INSURED-SEX-CD       PIC X.
  7452             88  INSURED-IS-MALE        VALUE 'M'.
  7453             88  INSURED-IS-FEMALE      VALUE 'F'.
  7454             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7455         16  CL-INSURED-OCC-CD       PIC X(6).
  7456         16  FILLER                  PIC X(5).
  7457
  7458     12  CL-PROCESSING-INFO.
  7459         16  CL-PROCESSOR-ID         PIC X(4).
  7460         16  CL-CLAIM-STATUS         PIC X.
  7461             88  CLAIM-IS-OPEN          VALUE 'O'.
  7462             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7463         16  CL-CLAIM-TYPE           PIC X.
  7464*            88  AH-CLAIM               VALUE 'A'.
  7465*            88  LIFE-CLAIM             VALUE 'L'.
  7466*            88  PROPERTY-CLAIM         VALUE 'P'.
  7467*            88  IUI-CLAIM              VALUE 'I'.
  7468*            88  GAP-CLAIM              VALUE 'G'.
  7469         16  CL-CLAIM-PREM-TYPE      PIC X.
  7470             88  SINGLE-PREMIUM         VALUE '1'.
  7471             88  O-B-COVERAGE           VALUE '2'.
  7472             88  OPEN-END-COVERAGE      VALUE '3'.
  7473         16  CL-INCURRED-DT          PIC XX.
  7474         16  CL-REPORTED-DT          PIC XX.
  7475         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7476         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7477         16  CL-LAST-PMT-DT          PIC XX.
  7478         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7479         16  CL-PAID-THRU-DT         PIC XX.
  7480         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7481         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7482         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7483         16  CL-PMT-CALC-METHOD      PIC X.
  7484             88  CL-360-DAY-YR          VALUE '1'.
  7485             88  CL-365-DAY-YR          VALUE '2'.
  7486             88  CL-FULL-MONTHS         VALUE '3'.
  7487         16  CL-CAUSE-CD             PIC X(6).
  7488
  7489         16  CL-PRIME-CERT-NO.
  7490             20  CL-PRIME-CERT-PRIME PIC X(10).
  7491             20  CL-PRIME-CERT-SFX   PIC X.
  7492
  7493         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7494             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7495             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7496
  7497         16  CL-MICROFILM-NO         PIC X(10).
  7498         16  CL-PROG-FORM-TYPE       PIC X.
  7499         16  CL-LAST-ADD-ON-DT       PIC XX.
  7500
  7501         16  CL-LAST-REOPEN-DT       PIC XX.
  7502         16  CL-LAST-CLOSE-DT        PIC XX.
  7503         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7504             88  FINAL-PAID             VALUE '1'.
  7505             88  CLAIM-DENIED           VALUE '2'.
  7506             88  AUTO-CLOSE             VALUE '3'.
  7507             88  MANUAL-CLOSE           VALUE '4'.
  7508             88  BENEFITS-CHANGED       VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 141
* EL6311.cbl
  7509             88  SETUP-ERRORS           VALUE 'E'.
  7510         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7511         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7512         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7513             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7514         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7515         16  FILLER                  PIC X.
  7516
  7517     12  CL-CERTIFICATE-DATA.
  7518         16  CL-CERT-ORIGIN          PIC X.
  7519             88  CERT-WAS-ONLINE        VALUE '1'.
  7520             88  CERT-WAS-CREATED       VALUE '2'.
  7521             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7522         16  CL-CERT-KEY-DATA.
  7523             20  CL-CERT-CARRIER     PIC X.
  7524             20  CL-CERT-GROUPING    PIC X(6).
  7525             20  CL-CERT-STATE       PIC XX.
  7526             20  CL-CERT-ACCOUNT.
  7527                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7528                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7529             20  CL-CERT-EFF-DT      PIC XX.
  7530
  7531     12  CL-STATUS-CONTROLS.
  7532         16  CL-PRIORITY-CD          PIC X.
  7533             88  CONFIDENTIAL-DATA      VALUE '8'.
  7534             88  HIGHEST-PRIORITY       VALUE '9'.
  7535         16  CL-SUPV-ATTN-CD         PIC X.
  7536             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7537             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7538         16  CL-PURGED-DT            PIC XX.
  7539         16  CL-RESTORED-DT          PIC XX.
  7540         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7541         16  CL-NEXT-RESEND-DT       PIC XX.
  7542         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7543         16  CL-CRITICAL-PERIOD      PIC 99.
  7544*        16  FILLER                  PIC XX.
  7545         16  CL-LAST-MAINT-DT        PIC XX.
  7546         16  CL-LAST-MAINT-USER      PIC X(4).
  7547         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7548         16  CL-LAST-MAINT-TYPE      PIC X.
  7549             88  CLAIM-SET-UP           VALUE ' '.
  7550             88  PAYMENT-MADE           VALUE '1'.
  7551             88  LETTER-SENT            VALUE '2'.
  7552             88  MASTER-WAS-ALTERED     VALUE '3'.
  7553             88  MASTER-WAS-RESTORED    VALUE '4'.
  7554             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7555             88  FILE-CONVERTED         VALUE '6'.
  7556             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7557             88  ERROR-CORRECTION       VALUE 'E'.
  7558         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7559         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7560         16  CL-BENEFICIARY          PIC X(10).
  7561         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7562         16  CL-DENIAL-TYPE          PIC X.
  7563             88  CL-TYPE-DENIAL          VALUE '1'.
  7564             88  CL-TYPE-RESCISSION      VALUE '2'.
  7565             88  CL-TYPE-REFORMATION     VALUE '3'.
  7566             88  CL-TYPE-REF-TO-RES      VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 142
* EL6311.cbl
  7567             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7568         16  CL-CRIT-PER-RECURRENT   PIC X.
  7569         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7570         16  CL-RTW-DT               PIC XX.
  7571
  7572     12  CL-TRAILER-CONTROLS.
  7573         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7574             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7575             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7576             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7577         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7578         16  FILLER                  PIC XX.
  7579         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7580         16  CL-ADDRESS-TRAILER-CNT.
  7581             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7582                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7583             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7584                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7585             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7586                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7587             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7588                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7589             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7590                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7591             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7592                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7593             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7594                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7595
  7596     12  CL-CV-REFERENCE-NO.
  7597         16  CL-CV-REFNO-PRIME       PIC X(18).
  7598         16  CL-CV-REFNO-SFX         PIC XX.
  7599
  7600     12  CL-FILE-LOCATION            PIC X(4).
  7601
  7602     12  CL-PROCESS-ERRORS.
  7603         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7604             88  NO-FATAL-ERRORS        VALUE ZERO.
  7605         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7606             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7607
  7608     12  CL-PRODUCT-CD               PIC X.
  7609
  7610     12  CL-CURRENT-KEY-DATA.
  7611         16  CL-CURRENT-CARRIER      PIC X.
  7612         16  CL-CURRENT-GROUPING     PIC X(6).
  7613         16  CL-CURRENT-STATE        PIC XX.
  7614         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7615
  7616     12  CL-ASSOCIATES               PIC X.
  7617         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7618         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7619         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7620         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7621
  7622     12  CL-ACTIVITY-CODE            PIC 99.
  7623     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7624     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 143
* EL6311.cbl
  7625
  7626     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7627     12  CL-LAG-REPORT-CODE          PIC 9.
  7628     12  CL-LOAN-TYPE                PIC XX.
  7629     12  CL-LEGAL-STATE              PIC XX.
  7630
  7631     12  CL-YESNOSW                  PIC X.
  7632     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7633         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7634         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7635         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7636     12  cl-insured-claim            pic x.
  7637         88  cl-claim-on-primary         value 'P'.
  7638         88  cl-claim-on-secondary       value 'S'.
  7639     12  cl-benefit-expiration-dt    PIC XX.
  7640
  7641*    COPY ERCENDT.
  7642******************************************************************
  7643*                                                                *
  7644*                                                                *
  7645*                            ERCENDT.                            *
  7646*                            VMOD=2.001                          *
  7647*                                                                *
  7648*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7649*                                                                *
  7650*   FILE TYPE = VSAM,KSDS                                        *
  7651*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7652*                                                                *
  7653*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7654*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7655*                                                                *
  7656*   LOG = NO                                                     *
  7657*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7658******************************************************************
  7659*-----------------------------------------------------------------
  7660*                   C H A N G E   L O G
  7661*
  7662* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7663*-----------------------------------------------------------------
  7664*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7665* EFFECTIVE    NUMBER
  7666*-----------------------------------------------------------------
  7667* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7668*                                WITH OPEN CLAIMS
  7669* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7670* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7671* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7672*-----------------------------------------------------------------
  7673 01  ENDORSEMENT-RECORD.
  7674     12  EN-RECORD-ID                PIC XX.
  7675         88  VALID-EN-ID                VALUE 'EN'.
  7676     12  EN-CONTROL-PRIMARY.
  7677         16  EN-COMPANY-CD           PIC X.
  7678         16  EN-CARRIER              PIC X.
  7679         16  EN-GROUPING             PIC X(6).
  7680         16  EN-STATE                PIC XX.
  7681         16  EN-ACCOUNT              PIC X(10).
  7682         16  EN-CERT-EFF-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 144
* EL6311.cbl
  7683         16  EN-CERT-NO.
  7684             20  EN-CERT-PRIME       PIC X(10).
  7685             20  EN-CERT-SFX         PIC X.
  7686         16  EN-REC-TYPE             PIC X.
  7687             88  EN-ISSUE               VALUE 'I'.
  7688             88  EN-CANCELLATION        VALUE 'C'.
  7689         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7690     12  EN-CONTROL-BY-ARCH-NO.
  7691         16  EN-COMPANY-CD-A1              PIC X.
  7692         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7693     12  EN-LAST-MAINT-DT            PIC XX.
  7694     12  EN-LAST-MAINT-BY            PIC X(4).
  7695     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7696     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7697     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7698         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7699         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7700         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7701         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7702         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7703         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7704         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7705         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7706         16  EN-LF-ORIG-BENCD        PIC XX.
  7707         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7708         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7709         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7710         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7711         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7712         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7713*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7714         16  EN-ORIG-CRED-BENE       PIC X(25).
  7715         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7716         16  FILLER                  PIC X.
  7717         16  EN-AH-ORIG-BENCD        PIC XX.
  7718         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7719         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7720         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7721         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7722*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7723*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7724         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7725         16  F                       PIC X(09).
  7726         16  EN-AH-ORIG-CP           PIC 99.
  7727         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7728         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7729         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7730         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7731         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7732         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7733         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7734         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7735         16  EN-LF-NEW-BENCD         PIC XX.
  7736         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7737         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7738         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7739         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7740         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 145
* EL6311.cbl
  7741         16  EN-LF-NEW-EXP-DT        PIC XX.
  7742         16  EN-NEW-CRED-BENE        PIC X(25).
  7743         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7744         16  FILLER                  PIC X.
  7745         16  EN-AH-NEW-BENCD         PIC XX.
  7746         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7747         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7748         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7749         16  EN-AH-NEW-EXP-DT        PIC XX.
  7750*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7751*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7752*        16  F                       PIC X(12).
  7753         16  EN-AH-NEW-CP            PIC 99.
  7754         16  EN-SIG-SW               PIC X.
  7755         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7756         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7757         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7758         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7759         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7760         16  FILLER                  PIC X(33).
  7761     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7762         16  EN-LF-ORIG-REF-DT       PIC XX.
  7763         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7764         16  EN-AH-ORIG-REF-DT       PIC XX.
  7765         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7766         16  EN-LF-NEW-REF-DT        PIC XX.
  7767         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7768         16  EN-AH-NEW-REF-DT        PIC XX.
  7769         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7770         16  EN-FLAG-CERT            PIC X.
  7771         16  EN-INS-LAST-NAME        PIC X(15).
  7772         16  EN-INS-FIRST-NAME       PIC X(10).
  7773         16  EN-INS-MIDDLE-INIT      PIC X.
  7774         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7775         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7776         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7777         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7778         16  FILLER                  PIC X(262).
  7779     12  EN-MONEY-SW             PIC X.
  7780     12  EN-HEALTH-APP           PIC X.
  7781     12  EN-VOUCHER-SW           PIC X.
  7782     12  EN-PAYEE                PIC X(14).
  7783     12  EN-INPUT-DT             PIC XX.
  7784     12  EN-PROCESS-DT           PIC XX.
  7785     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7786     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7787     12  EN-REASON-CODES.
  7788         16  F OCCURS 12.
  7789             20  EN-REASON-CODE  PIC X(4).
  7790     12  EN-TEMPLATE-USED        PIC X(8).
  7791     12  EN-DOCU-TYPE            PIC X.
  7792         88  EN-VERI-DOCU          VALUE 'V'.
  7793         88  EN-GCE-DOCU           VALUE 'G'.
  7794         88  EN-CANC-DOCU          VALUE 'C'.
  7795     12  EN-COMMENTS1            PIC X(13).
  7796     12  EN-COMMENTS2            PIC X(70).
  7797     12  EN-COMM-CHGBK           PIC X.
  7798         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 146
* EL6311.cbl
  7799         88  EN-CHG-ACCT           VALUE 'Y'.
  7800     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7801     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7802     12  EN-BATCH-NUMBER         PIC X(6).
  7803     12  EN-ACCT-SUMM            PIC X.
  7804     12  EN-CSO-SUMM             PIC X.
  7805     12  FILLER                  PIC X(13).
  7806******************************************************************
  7807
  7808*    COPY ELCCRTT.
  7809******************************************************************
  7810*                                                                *
  7811*                            ELCCRTT.                            *
  7812*                                                                *
  7813*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7814*                                                                *
  7815*   FILE TYPE = VSAM,KSDS                                        *
  7816*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7817*                                                                *
  7818*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7819*                                                                *
  7820*   LOG = YES                                                    *
  7821*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7822******************************************************************
  7823*                   C H A N G E   L O G
  7824*
  7825* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7826*-----------------------------------------------------------------
  7827*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7828* EFFECTIVE    NUMBER
  7829*-----------------------------------------------------------------
  7830* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7831* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7832* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7833* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7834* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7835******************************************************************
  7836
  7837 01  CERTIFICATE-TRAILERS.
  7838     12  CS-RECORD-ID                      PIC XX.
  7839         88  VALID-CS-ID                      VALUE 'CS'.
  7840
  7841     12  CS-CONTROL-PRIMARY.
  7842         16  CS-COMPANY-CD                 PIC X.
  7843         16  CS-CARRIER                    PIC X.
  7844         16  CS-GROUPING                   PIC X(6).
  7845         16  CS-STATE                      PIC XX.
  7846         16  CS-ACCOUNT                    PIC X(10).
  7847         16  CS-CERT-EFF-DT                PIC XX.
  7848         16  CS-CERT-NO.
  7849             20  CS-CERT-PRIME             PIC X(10).
  7850             20  CS-CERT-SFX               PIC X.
  7851         16  CS-TRAILER-TYPE               PIC X.
  7852             88  COMM-TRLR           VALUE 'A'.
  7853             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7854             88  CERT-DATA-TRLR      VALUE 'C'.
  7855
  7856     12  CS-DATA-AREA                      PIC X(516).
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 147
* EL6311.cbl
  7857
  7858     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7859         16  CS-BANK-COMMISSION-AREA.
  7860             20  CS-BANK-COMMS       OCCURS 10.
  7861                 24  CS-AGT                PIC X(10).
  7862                 24  CS-COM-TYP            PIC X.
  7863                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7864                 24  CS-RECALC-LV-INDIC    PIC X.
  7865                 24  FILLER                PIC X(10).
  7866         16  FILLER                        PIC X(256).
  7867
  7868     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7869****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7870****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  7871         16  CS-MB-CLAIM-DATA OCCURS 2.
  7872             20  FILLER OCCURS 10.
  7873                 24  CS-CLAIM-TYPE         PIC X.
  7874                     88  CS-AH-CLM           VALUE 'A'.
  7875                     88  CS-IU-CLM           VALUE 'I'.
  7876                     88  CS-GP-CLM           VALUE 'G'.
  7877                     88  CS-LF-CLM           VALUE 'L'.
  7878                     88  CS-PR-CLM           VALUE 'P'.
  7879                 24  CS-BANK               PIC S999 COMP-3.
  7880                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  7881                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  7882                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  7883         16  FILLER                        PIC X(216).
  7884     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7885         16  CS-VIN-NUMBER                 PIC X(17).
  7886         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7887         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7888         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7889         16  FILLER                        PIC X(496).
  7890******************************************************************
  7891
  7892 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  7893                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  7894                          PENDING-MAILING-DATA MAILING-DATA
  7895                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  7896                          PENDING-PAY-ADJ CERT-NOTE-FILE
  7897                          CLAIM-MASTER ENDORSEMENT-RECORD
  7898                          CERTIFICATE-TRAILERS.
  7899 0000-DFHEXIT SECTION.
  7900     MOVE '9#                    $   ' TO DFHEIV0.
  7901     MOVE 'EL6311' TO DFHEIV1.
  7902     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7903
  7904     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7905     MOVE EIBTRMID               TO QID-TERM.
  7906     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  7907     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7908     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7909     MOVE 2                      TO EMI-SWITCH2.
  7910
  7911     IF EIBCALEN = 0
  7912         GO TO 8800-UNAUTHORIZED-ACCESS.
  7913
  7914     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 148
* EL6311.cbl
  7915     MOVE '5'                   TO DC-OPTION-CODE.
  7916     PERFORM 9700-DATE-LINK.
  7917     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  7918     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  7919
  7920     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  7921     MOVE SPACE                  TO DC-OPTION-CODE.
  7922     PERFORM 9700-DATE-LINK.
  7923     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  7924     MOVE LOW-VALUES             TO EL631BI.
  7925
  7926
  7927* EXEC CICS HANDLE CONDITION
  7928*        PGMIDERR  (9600-PGMID-ERROR)
  7929*        ERROR     (9990-ABEND)
  7930*        INVREQ    (9990-ABEND)
  7931*        QIDERR    (0010-MAIN-LOGIC)
  7932*    END-EXEC.
  7933*    MOVE '"$L.8N                ! " #00007922' TO DFHEIV0
  7934     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  7935     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7936     MOVE X'2220233030303037393232' TO DFHEIV0(25:11)
  7937     CALL 'kxdfhei1' USING DFHEIV0
  7938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7939
  7940
  7941     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7942         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7943             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7944             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7945             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7946             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7947             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7948             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7949             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7950             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7951
  7952             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  7953                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  7954
  7955             ELSE
  7956                 NEXT SENTENCE
  7957
  7958         ELSE
  7959             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  7960             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7961             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7962             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7963             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7964             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7965             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7966             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7967             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7968             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  7969             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  7970             GO TO 3900-RE-DISPLAY-RECORD
  7971     ELSE
  7972         GO TO 0020-MAIN-LOGIC.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 149
* EL6311.cbl
  7973
  7974 0010-MAIN-LOGIC.
  7975     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  7976                                    WS-FIRST-ENTRY-SW.
  7977
  7978     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  7979
  7980     MOVE LOW-VALUES             TO EC-NEW-CERT
  7981                                    EC-NEW-STATE.
  7982
  7983     IF PI-DISPLAY-ORIGINAL-BATCH
  7984         NEXT SENTENCE
  7985     ELSE
  7986         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  7987             GO TO 5000-BROWSE-BATCH-HEADERS.
  7988
  7989     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  7990         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  7991
  7992     IF PI-CSR-BROWSE
  7993        GO TO 4200-BROWSE-CSR-FORWARD.
  7994
  7995     IF PI-FILE-BROWSE
  7996         GO TO 4300-BROWSE-FILE-FORWARD.
  7997
  7998     GO TO 4000-BROWSE-DETAIL-FORWARD.
  7999
  8000 0020-MAIN-LOGIC.
  8001     IF EIBAID = DFHCLEAR
  8002         GO TO 9400-CLEAR.
  8003
  8004     MOVE LOW-VALUES             TO EC-NEW-CERT
  8005                                    EC-NEW-STATE.
  8006
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 150
* EL6311.cbl
  8008
  8009******************************************************************
  8010*                                                                *
  8011*              R E C E I V E   M A P                             *
  8012*                                                                *
  8013******************************************************************
  8014
  8015 0200-RECEIVE.
  8016     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8017         MOVE ER-0008            TO EMI-ERROR
  8018         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8019         IF PI-MAP-NAME = EL631B
  8020             MOVE -1                 TO BMAINTL
  8021             GO TO 8200-SEND-DATAONLY
  8022         ELSE
  8023             IF PI-MAP-NAME = EL631C
  8024                 MOVE -1                 TO CMAINTL
  8025                 GO TO 8200-SEND-DATAONLY
  8026             ELSE
  8027                 IF PI-MAP-NAME = EL631D
  8028                     MOVE -1                 TO DPFENTRL
  8029                     GO TO 8200-SEND-DATAONLY.
  8030
  8031
  8032* EXEC CICS RECEIVE
  8033*        MAP      (PI-MAP-NAME)
  8034*        MAPSET   (MAPSET-EL6311S)
  8035*        INTO     (EL631BI)
  8036*    END-EXEC.
  8037     MOVE LENGTH OF
  8038      EL631BI
  8039       TO DFHEIV11
  8040*    MOVE '8"T I  L              ''   #00008019' TO DFHEIV0
  8041     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8042     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8043     MOVE X'2020233030303038303139' TO DFHEIV0(25:11)
  8044     CALL 'kxdfhei1' USING DFHEIV0,
  8045           PI-MAP-NAME,
  8046           EL631BI,
  8047           DFHEIV11,
  8048           MAPSET-EL6311S,
  8049           DFHEIV99,
  8050           DFHEIV99
  8051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8052
  8053
  8054******************************************************************
  8055*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8056******************************************************************
  8057
  8058     IF BTYPE-LEN (1) EQUAL +3
  8059        IF BTYPE (1) EQUAL ALL ' '
  8060            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8061
  8062     IF BTYPE-LEN (2) EQUAL +3
  8063        IF BTYPE (2) EQUAL ALL ' '
  8064            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8065
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 151
* EL6311.cbl
  8066     INSPECT EL631BI CONVERTING '_' TO ' '.
  8067
  8068     IF PI-MAP-NAME = EL631B
  8069         IF BPFENTRL GREATER THAN ZEROS
  8070             IF EIBAID NOT = DFHENTER
  8071                 MOVE ER-0004       TO EMI-ERROR
  8072                 MOVE -1            TO BPFENTRL
  8073                 MOVE AL-UNBOF      TO BPFENTRA
  8074                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8075                 GO TO 8200-SEND-DATAONLY
  8076             ELSE
  8077                 IF BPFENTRI NUMERIC AND
  8078                   (BPFENTRI GREATER 0 AND LESS 25)
  8079                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8080                 ELSE
  8081                     MOVE ER-0029  TO EMI-ERROR
  8082                     MOVE AL-UNBON TO BPFENTRA
  8083                     MOVE -1       TO BPFENTRL
  8084                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8085                     GO TO 8200-SEND-DATAONLY
  8086         ELSE
  8087             NEXT SENTENCE
  8088     ELSE
  8089         IF PI-MAP-NAME = EL631C
  8090            IF CPFENTRL GREATER THAN ZEROS
  8091                IF EIBAID NOT = DFHENTER
  8092                 MOVE ER-0004         TO EMI-ERROR
  8093                 MOVE -1              TO CPFENTRL
  8094                 MOVE AL-UNBOF        TO CPFENTRA
  8095                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8096                 GO TO 8200-SEND-DATAONLY
  8097             ELSE
  8098                 IF CPFENTRI NUMERIC AND
  8099                   (CPFENTRI GREATER 0 AND LESS 25)
  8100                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8101                 ELSE
  8102                     MOVE ER-0029      TO EMI-ERROR
  8103                     MOVE AL-UNBON     TO CPFENTRA
  8104                     MOVE -1           TO CPFENTRL
  8105                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8106                     GO TO 8200-SEND-DATAONLY
  8107         ELSE
  8108             NEXT SENTENCE
  8109     ELSE
  8110     IF PI-MAP-NAME = EL631D
  8111         IF DPFENTRL GREATER THAN ZEROS
  8112             IF EIBAID NOT = DFHENTER
  8113                 MOVE ER-0004         TO EMI-ERROR
  8114                 MOVE -1              TO DPFENTRL
  8115                 MOVE AL-UNBOF        TO DPFENTRA
  8116                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8117                 GO TO 8200-SEND-DATAONLY
  8118             ELSE
  8119                 IF DPFENTRI NUMERIC AND
  8120                   (DPFENTRI GREATER 0 AND LESS 25)
  8121                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8122                 ELSE
  8123                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 152
* EL6311.cbl
  8124                     MOVE AL-UNBON     TO DPFENTRA
  8125                     MOVE -1           TO DPFENTRL
  8126                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8127                     GO TO 8200-SEND-DATAONLY.
  8128
  8129     IF EIBAID = DFHPF23
  8130         GO TO 8810-PF23.
  8131
  8132     IF EIBAID = DFHPF24
  8133         GO TO 9200-RETURN-MAIN-MENU.
  8134
  8135     IF EIBAID = DFHPF12
  8136         GO TO 9500-PF12.
  8137
  8138     IF PI-MAP-NAME = EL631B
  8139        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8140
  8141     IF PI-MAP-NAME = EL631C
  8142        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8143
  8144     IF PI-MAP-NAME = EL631D
  8145        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8146
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 153
* EL6311.cbl
  8148
  8149******************************************************************
  8150*                                                                *
  8151*      ISSUE SCREEN PF KEY CHECKING                              *
  8152*                                                                *
  8153******************************************************************
  8154
  8155******************************************************************
  8156*                                                                *
  8157*      PF KEY FUNCTIONS:                                         *
  8158*                                                                *
  8159*      PF1  = BROWSE FORWARD                                     *
  8160*      PF2  = BROWSE BACKWARD                                    *
  8161*      PF3  = CERTIFICATE LOOKUP                                 *
  8162*      PF4  = DISPLAY BATCH HEADER                               *
  8163*      PF5  = ADD ISSUE  SCREEN                                  *
  8164*      PF6  = ADD CANCEL SCREEN                                  *
  8165*      PF7  = CERTIFICATE DISPLAY                                *
  8166*      PF8  = CERTIFICATE NOTES                                  *
  8167*      PF9  = EDIT CONTROL                                       *
  8168*      PF10 = DISPLAY LETTER SCREEN                              *
  8169*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8170*      PF12 = HELP SCREEN                                        *
  8171*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8172*      PF14 = ACCOUNT MASTER                                     *
  8173*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8174*      PF16 = DISPLAY LETTER REVIEW                              *
  8175*                                                                *
  8176******************************************************************
  8177
  8178 0300-CHECK-ISSUE-PF-KEYS.
  8179     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8180        MOVE ER-2337            TO EMI-ERROR
  8181        MOVE -1                  TO BMAINTL
  8182        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8183        GO TO 8200-SEND-DATAONLY.
  8184
  8185     IF EIBAID = DFHPF1
  8186        MOVE '0'                TO PI-EDIT-SW
  8187        IF PI-PRIMARY-BROWSE
  8188           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8189        ELSE
  8190           IF PI-PRIMARY-WITH-SELECT
  8191              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8192           ELSE
  8193              IF PI-FILE-BROWSE
  8194                 GO TO 4300-BROWSE-FILE-FORWARD
  8195              ELSE
  8196                 IF PI-CSR-BROWSE
  8197                    GO TO 4200-BROWSE-CSR-FORWARD
  8198                 ELSE
  8199                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8200
  8201     IF EIBAID = DFHPF2
  8202        MOVE '0'                TO PI-EDIT-SW
  8203        IF PI-PRIMARY-BROWSE
  8204           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8205        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 154
* EL6311.cbl
  8206           IF PI-PRIMARY-WITH-SELECT
  8207              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8208           ELSE
  8209              IF PI-FILE-BROWSE
  8210                 GO TO 4800-BROWSE-FILE-BACKWARD
  8211              ELSE
  8212                 IF PI-CSR-BROWSE
  8213                    GO TO 4900-BROWSE-CSR-BACKWARD
  8214                 ELSE
  8215                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8216
  8217     IF EIBAID = DFHPF3
  8218        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8219        MOVE XCTL-EL127         TO PGM-NAME
  8220        GO TO 9300-XCTL.
  8221
  8222     IF (EIBAID = DFHPF15 OR DFHPF6)
  8223        AND (CSR-EDIT-SESSION)
  8224*       AND (FATAL-OR-UNFORCED)
  8225        AND (FATAL-ERRORS)
  8226        MOVE ER-1819             TO EMI-ERROR
  8227        MOVE -1                  TO BMAINTL
  8228        MOVE AL-UANON            TO BMAINTA
  8229        PERFORM 9900-ERROR-FORMAT
  8230                                 THRU 9900-EXIT
  8231        GO TO 8200-SEND-DATAONLY
  8232     END-IF
  8233     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8234      OR (EIBAID = DFHPF10)
  8235        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8236        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8237        IF (RESP-NORMAL)
  8238           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8239              AM-CONTROL-PRIMARY (1:20))
  8240            IF AM-NAME NOT GREATER THAN SPACES OR
  8241               AM-ADDRS NOT GREATER THAN SPACES  OR
  8242               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8243               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8244               AM-ZIP NOT GREATER THAN SPACES
  8245               MOVE ER-3834             TO EMI-ERROR
  8246               MOVE -1                  TO BMAINTL
  8247               MOVE AL-UANON            TO BMAINTA
  8248               PERFORM 9900-ERROR-FORMAT
  8249                                 THRU 9900-EXIT
  8250               GO TO 8200-SEND-DATAONLY
  8251            END-IF
  8252        ELSE
  8253           MOVE ER-1609             TO EMI-ERROR
  8254           MOVE -1                  TO BMAINTL
  8255           MOVE AL-UANON            TO BMAINTA
  8256           PERFORM 9900-ERROR-FORMAT
  8257                                THRU 9900-EXIT
  8258           GO TO 8200-SEND-DATAONLY
  8259        END-IF
  8260
  8261        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8262        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8263        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 155
* EL6311.cbl
  8264            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8265               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8266               MA-CITY NOT GREATER THAN SPACES OR
  8267               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8268               MA-ZIP-CODE NOT GREATER THAN SPACES
  8269               MOVE ER-3835             TO EMI-ERROR
  8270               MOVE -1                  TO BMAINTL
  8271               MOVE AL-UANON            TO BMAINTA
  8272               PERFORM 9900-ERROR-FORMAT
  8273                                 THRU 9900-EXIT
  8274               GO TO 8200-SEND-DATAONLY
  8275            END-IF
  8276        ELSE
  8277           MOVE ER-3000             TO EMI-ERROR
  8278           MOVE -1                  TO BMAINTL
  8279           MOVE AL-UANON            TO BMAINTA
  8280           PERFORM 9900-ERROR-FORMAT
  8281                                THRU 9900-EXIT
  8282           GO TO 8200-SEND-DATAONLY
  8283        END-IF
  8284
  8285     END-IF
  8286     IF (EIBAID = DFHPF15)
  8287        AND (CSR-EDIT-SESSION)
  8288        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8289        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8290        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8291        MOVE PI-SV-STATE         TO PI-STATE
  8292        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8293        MOVE BCERTNOI            TO PI-CERT-PRIME
  8294        MOVE BSUFIXI             TO PI-CERT-SFX
  8295        MOVE BEFFDTI             TO DEEDIT-FIELD
  8296        PERFORM 8600-DEEDIT
  8297        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8298        MOVE '4'                 TO DC-OPTION-CODE
  8299        PERFORM 9700-DATE-LINK
  8300        IF DATE-CONVERSION-ERROR
  8301           MOVE ER-0348          TO EMI-ERROR
  8302           MOVE -1               TO BEFFDTL
  8303           MOVE AL-UABON         TO BEFFDTA
  8304           PERFORM 9900-ERROR-FORMAT
  8305                                 THRU 9900-EXIT
  8306           GO TO 8200-SEND-DATAONLY
  8307        ELSE
  8308           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8309           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8310           MOVE XCTL-EL6315      TO PGM-NAME
  8311           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8312           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8313           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8314           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8315           GO TO 9300-XCTL
  8316        END-IF
  8317     END-IF
  8318
  8319     IF EIBAID = DFHPF4
  8320        MOVE '0'                TO PI-EDIT-SW
  8321        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 156
* EL6311.cbl
  8322           NEXT SENTENCE
  8323        ELSE
  8324           GO TO 7200-DISPLAY-BATCHES.
  8325
  8326     IF EIBAID = DFHPF5
  8327        MOVE ER-0029                TO EMI-ERROR
  8328        MOVE -1                     TO BPFENTRL
  8329        MOVE AL-UNBON               TO BPFENTRA
  8330        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8331        GO TO 8200-SEND-DATAONLY.
  8332*        MOVE '0'                TO PI-EDIT-SW
  8333*        IF PI-DISPLAY-ORIGINAL-BATCH
  8334*           NEXT SENTENCE
  8335*        ELSE
  8336*           MOVE EL631B              TO PI-MAP-NAME
  8337*           MOVE LOW-VALUES          TO EL631BI
  8338*           MOVE 'A'                 TO BMAINTO
  8339*           MOVE AL-UANON            TO BMAINTA
  8340*           MOVE -1                  TO BMAINTL
  8341*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8342*           GO TO 8100-SEND-INITIAL-MAP.
  8343
  8344     IF EIBAID = DFHPF6
  8345        IF NOT CSR-EDIT-SESSION
  8346           MOVE ER-0029                TO EMI-ERROR
  8347           MOVE -1                     TO BPFENTRL
  8348           MOVE AL-UNBON               TO BPFENTRA
  8349           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8350           GO TO 8200-SEND-DATAONLY
  8351*           MOVE '0'              TO PI-EDIT-SW
  8352*           IF PI-DISPLAY-ORIGINAL-BATCH
  8353*              NEXT SENTENCE
  8354*           ELSE
  8355*              MOVE EL631C        TO PI-MAP-NAME
  8356*              MOVE LOW-VALUES    TO EL631CI
  8357*              MOVE 'A'           TO CMAINTO
  8358*              MOVE AL-UANON      TO CMAINTA
  8359*              MOVE -1            TO CMAINTL
  8360*              MOVE '6'           TO PI-MAINT-FUNCTION
  8361*              GO TO 8100-SEND-INITIAL-MAP
  8362*           END-IF
  8363        ELSE
  8364           PERFORM 5100-PROCESS-POL-RESC
  8365                                 THRU 5100-EXIT
  8366           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8367           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8368                                    PI-PREV-SEQ-NO
  8369           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8370*                                    WS-CANCEL-LETTER-SW
  8371                                    PI-ALL-ISSUES-SW
  8372                                    PI-ALL-CANCELS-SW
  8373           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8374        END-IF
  8375     END-IF
  8376     IF EIBAID = DFHPF7
  8377        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8378        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8379        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 157
* EL6311.cbl
  8380        MOVE PI-SV-STATE            TO PI-STATE
  8381        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8382        MOVE BCERTNOI               TO PI-CERT-PRIME
  8383        MOVE BSUFIXI                TO PI-CERT-SFX
  8384        MOVE BEFFDTI                TO DEEDIT-FIELD
  8385        PERFORM 8600-DEEDIT
  8386        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8387        MOVE '4'                    TO DC-OPTION-CODE
  8388        PERFORM 9700-DATE-LINK
  8389        IF DATE-CONVERSION-ERROR
  8390           MOVE ER-0348            TO EMI-ERROR
  8391           MOVE -1                  TO BEFFDTL
  8392           MOVE AL-UABON            TO BEFFDTA
  8393           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8394           GO TO 8200-SEND-DATAONLY
  8395        ELSE
  8396           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8397           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8398           MOVE XCTL-EL1273        TO PGM-NAME
  8399           GO TO 9300-XCTL.
  8400
  8401     IF EIBAID = DFHPF8
  8402        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8403        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8404        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8405        MOVE PI-SV-STATE            TO PI-STATE
  8406        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8407        MOVE BCERTNOI               TO PI-CERT-PRIME
  8408        MOVE BSUFIXI                TO PI-CERT-SFX
  8409        MOVE BEFFDTI                TO DEEDIT-FIELD
  8410        PERFORM 8600-DEEDIT
  8411        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8412        MOVE '4'                    TO DC-OPTION-CODE
  8413        PERFORM 9700-DATE-LINK
  8414        IF DATE-CONVERSION-ERROR
  8415           MOVE ER-0348            TO EMI-ERROR
  8416           MOVE -1                  TO BEFFDTL
  8417           MOVE AL-UABON            TO BEFFDTA
  8418           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8419           GO TO 8200-SEND-DATAONLY
  8420        ELSE
  8421           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8422           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8423           IF PI-COMPANY-ID = 'DMD'
  8424               MOVE XCTL-EL401DMD      TO PGM-NAME
  8425             ELSE
  8426               MOVE XCTL-EL1279        TO PGM-NAME
  8427           END-IF
  8428           GO TO 9300-XCTL.
  8429
  8430     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8431        MOVE XCTL-EL6312         TO PGM-NAME
  8432
  8433* EXEC CICS XCTL
  8434*           PROGRAM   (PGM-NAME)
  8435*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8436*           LENGTH    (WS-COMM-LENGTH)
  8437*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 158
* EL6311.cbl
  8438*    MOVE '.$C                   %   #00008403' TO DFHEIV0
  8439     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8440     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8441     MOVE X'2020233030303038343033' TO DFHEIV0(25:11)
  8442     CALL 'kxdfhei1' USING DFHEIV0,
  8443           PGM-NAME,
  8444           PROGRAM-INTERFACE-BLOCK,
  8445           WS-COMM-LENGTH,
  8446           DFHEIV99
  8447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8448     ELSE
  8449        MOVE '0'                 TO  PI-EDIT-SW.
  8450
  8451     IF  EIBAID = DFHPF10
  8452         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8453         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8454         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8455                                    PI-1042-WA
  8456         MOVE 4                  TO PI-689-DATA-SOURCE
  8457         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8458         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8459         MOVE PI-SV-STATE        TO PI-689-STATE
  8460         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8461         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8462         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8463         MOVE PI-PB-ALT-CHG-SEQ-NO
  8464                                 TO PI-689-ALT-SEQ-NO
  8465         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8466         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8467         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8468         MOVE +0                 TO PI-689-CONTROL
  8469         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8470                                    PI-689-EXP-DATE
  8471                                    PI-689-RESP-PERSON
  8472                                    PI-689-TYPE
  8473                                    PI-689-FOLLOW-UP-EDIT
  8474                                    PI-689-RESEND1-EDIT
  8475                                    PI-689-SEQ-EDIT
  8476                                    PI-689-BCSEQ-EDIT
  8477                                    PI-689-LBL-OVERRIDE
  8478         MOVE W-LETTER-COMMUNICATION-AREAS
  8479                                 TO PI-PROGRAM-WORK-AREA
  8480         MOVE XCTL-EL689         TO PGM-NAME
  8481         GO TO 9300-XCTL.
  8482
  8483     IF  EIBAID = DFHPF16
  8484         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8485         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8486         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8487                                    PI-1042-WA
  8488         MOVE 4                  TO PI-689-DATA-SOURCE
  8489         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8490         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8491         MOVE PI-SV-STATE        TO PI-689-STATE
  8492         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8493         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8494         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8495         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 159
* EL6311.cbl
  8496                                 TO PI-689-ALT-SEQ-NO
  8497         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8498         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8499         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8500         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8501         MOVE W-LETTER-COMMUNICATION-AREAS
  8502                                 TO PI-PROGRAM-WORK-AREA
  8503         MOVE XCTL-EL690         TO PGM-NAME
  8504         GO TO 9300-XCTL.
  8505
  8506     IF EIBAID = DFHPF13
  8507         MOVE XCTL-EL6313        TO PGM-NAME
  8508         GO TO 9300-XCTL.
  8509
  8510     IF EIBAID = DFHPF17
  8511        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8512        IF (PB-I-LOAN-APR > ZEROS)
  8513           and (pb-i-loan-apr < 99.9999)
  8514           AND (PB-I-BENEFICIARY-NAME NOT
  8515              = SPACES AND LOW-VALUES)
  8516
  8517           MOVE LINK-ELVADS          TO PGM-NAME
  8518
  8519* EXEC CICS LINK
  8520*              PROGRAM    (PGM-NAME)
  8521*              COMMAREA   (WS-PASS-AREA)
  8522*              LENGTH     (WS-PASS-AREA-LENGTH)
  8523*          END-EXEC
  8524*    MOVE '."C                   (   #00008478' TO DFHEIV0
  8525     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8526     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8527     MOVE X'2020233030303038343738' TO DFHEIV0(25:11)
  8528     CALL 'kxdfhei1' USING DFHEIV0,
  8529           PGM-NAME,
  8530           WS-PASS-AREA,
  8531           WS-PASS-AREA-LENGTH,
  8532           DFHEIV99,
  8533           DFHEIV99,
  8534           DFHEIV99,
  8535           DFHEIV99
  8536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8537
  8538           MOVE 0000             TO EMI-ERROR
  8539           MOVE -1               TO BMAINTL
  8540           PERFORM 9900-ERROR-FORMAT
  8541                                 THRU 9900-EXIT
  8542           GO TO 8200-SEND-DATAONLY
  8543        ELSE
  8544           MOVE ER-0877            TO EMI-ERROR
  8545           MOVE -1                  TO BEFFDTL
  8546           MOVE AL-UABON            TO BEFFDTA
  8547           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8548           GO TO 8200-SEND-DATAONLY
  8549        END-IF
  8550     END-IF
  8551     IF EIBAID = DFHPF14
  8552        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8553        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 160
* EL6311.cbl
  8554        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8555        MOVE PI-SV-STATE            TO PI-CR-STATE
  8556        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8557        MOVE SPACE                  TO PI-EDIT-SW
  8558        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8559        MOVE XCTL-EL650             TO PGM-NAME
  8560        GO TO 9300-XCTL.
  8561
  8562     IF EIBAID = DFHPF15
  8563        IF PI-COMPANY-ID  =  'HER'
  8564            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8565            MOVE XCTL-EL680         TO PGM-NAME
  8566            GO TO 9300-XCTL.
  8567
  8568     IF EIBAID = DFHENTER OR DFHPF11
  8569        GO TO 1000-ISSUE-MAINLINE.
  8570
  8571     MOVE ER-0029                TO EMI-ERROR
  8572     MOVE -1                     TO BPFENTRL
  8573     MOVE AL-UNBON               TO BPFENTRA
  8574     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8575     GO TO 8200-SEND-DATAONLY.
  8576
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 161
* EL6311.cbl
  8578
  8579******************************************************************
  8580*                                                                *
  8581*      CANCEL SCREEN PF KEY CHECKING                             *
  8582*                                                                *
  8583******************************************************************
  8584
  8585******************************************************************
  8586*                                                                *
  8587*      PF KEY FUNCTIONS:                                         *
  8588*                                                                *
  8589*      PF1  = BROWSE FORWARD                                     *
  8590*      PF2  = BROWSE BACKWARD                                    *
  8591*      PF3  = CERTIFICATE LOOKUP                                 *
  8592*      PF4  = DISPLAY BATCH HEADER                               *
  8593*      PF5  = ADD ISSUE SCREEN                                   *
  8594*      PF6  = ADD CANCEL SCREEN                                  *
  8595*      PF7  = CERTIFICATE DISPLAY                                *
  8596*      PF8  = CERTIFICATE NOTES                                  *
  8597*      PF9  = EDIT CONTROL                                       *
  8598*      PF10 = DISPLAY LETTER SCREEN                              *
  8599*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8600*      PF12 = DISPLAY HELP SCREEN                                *
  8601*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8602*      PF14 = ACCOUNT MASTER                                     *
  8603*      PF16 = LETTER REVIEW                                      *
  8604*                                                                *
  8605******************************************************************
  8606
  8607 0400-CHECK-CANCEL-PF-KEYS.
  8608     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8609        MOVE ER-2337             TO EMI-ERROR
  8610        MOVE -1                  TO CMAINTL
  8611        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8612        GO TO 8200-SEND-DATAONLY.
  8613
  8614     IF EIBAID = DFHPF1
  8615        MOVE '0'                TO PI-EDIT-SW
  8616        IF PI-PRIMARY-BROWSE
  8617           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8618        ELSE
  8619           IF PI-PRIMARY-WITH-SELECT
  8620              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8621           ELSE
  8622              IF PI-FILE-BROWSE
  8623                 GO TO 4300-BROWSE-FILE-FORWARD
  8624              ELSE
  8625                 IF PI-CSR-BROWSE
  8626                    GO TO 4200-BROWSE-CSR-FORWARD
  8627                 ELSE
  8628                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8629
  8630     IF EIBAID = DFHPF2
  8631        MOVE '0'                TO PI-EDIT-SW
  8632        IF PI-PRIMARY-BROWSE
  8633           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8634        ELSE
  8635           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 162
* EL6311.cbl
  8636              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8637           ELSE
  8638              IF PI-FILE-BROWSE
  8639                 GO TO 4800-BROWSE-FILE-BACKWARD
  8640              ELSE
  8641                 IF PI-CSR-BROWSE
  8642                    GO TO 4900-BROWSE-CSR-BACKWARD
  8643                 ELSE
  8644                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8645
  8646     IF EIBAID = DFHPF3
  8647        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8648        MOVE XCTL-EL127         TO PGM-NAME
  8649        GO TO 9300-XCTL.
  8650
  8651     IF (EIBAID = DFHPF15 OR DFHPF17)
  8652        AND (CSR-EDIT-SESSION)
  8653*       AND (FATAL-OR-UNFORCED)
  8654        AND (FATAL-ERRORS)
  8655        MOVE ER-1819             TO EMI-ERROR
  8656        MOVE -1                  TO CMAINTL
  8657        MOVE AL-UANON            TO CMAINTA
  8658        PERFORM 9900-ERROR-FORMAT
  8659                                 THRU 9900-EXIT
  8660        GO TO 8200-SEND-DATAONLY
  8661     END-IF
  8662     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8663       AND (CSR-EDIT-SESSION)
  8664        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8665        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8666        IF (RESP-NORMAL)
  8667           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8668              AM-CONTROL-PRIMARY (1:20))
  8669            IF AM-NAME NOT GREATER THAN SPACES OR
  8670               AM-ADDRS NOT GREATER THAN SPACES  OR
  8671               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8672               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8673               AM-ZIP NOT GREATER THAN SPACES
  8674               MOVE ER-3834             TO EMI-ERROR
  8675               MOVE -1                  TO BMAINTL
  8676               MOVE AL-UANON            TO BMAINTA
  8677               PERFORM 9900-ERROR-FORMAT
  8678                                 THRU 9900-EXIT
  8679               GO TO 8200-SEND-DATAONLY
  8680            END-IF
  8681        ELSE
  8682           MOVE ER-1609             TO EMI-ERROR
  8683           MOVE -1                  TO BMAINTL
  8684           MOVE AL-UANON            TO BMAINTA
  8685           PERFORM 9900-ERROR-FORMAT
  8686                                THRU 9900-EXIT
  8687           GO TO 8200-SEND-DATAONLY
  8688        END-IF
  8689
  8690        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8691        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8692        IF (ERMAIL-FOUND)
  8693            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 163
* EL6311.cbl
  8694               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8695               MA-CITY NOT GREATER THAN SPACES OR
  8696               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8697               MA-ZIP-CODE NOT GREATER THAN SPACES
  8698               MOVE ER-3835             TO EMI-ERROR
  8699               MOVE -1                  TO BMAINTL
  8700               MOVE AL-UANON            TO BMAINTA
  8701               PERFORM 9900-ERROR-FORMAT
  8702                                 THRU 9900-EXIT
  8703               GO TO 8200-SEND-DATAONLY
  8704            END-IF
  8705        ELSE
  8706           MOVE ER-3000             TO EMI-ERROR
  8707           MOVE -1                  TO BMAINTL
  8708           MOVE AL-UANON            TO BMAINTA
  8709           PERFORM 9900-ERROR-FORMAT
  8710                                THRU 9900-EXIT
  8711           GO TO 8200-SEND-DATAONLY
  8712        END-IF
  8713
  8714     END-IF
  8715     IF (EIBAID = DFHPF15 OR DFHPF17)
  8716        AND (CSR-EDIT-SESSION)
  8717        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8718        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8719        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8720        MOVE PI-SV-STATE         TO PI-STATE
  8721        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8722        MOVE CCERTNOI            TO PI-CERT-PRIME
  8723        MOVE CSUFIXI             TO PI-CERT-SFX
  8724        MOVE CEFFDTI             TO DEEDIT-FIELD
  8725        PERFORM 8600-DEEDIT
  8726        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8727        MOVE '4'                 TO DC-OPTION-CODE
  8728        PERFORM 9700-DATE-LINK
  8729        IF DATE-CONVERSION-ERROR
  8730           MOVE ER-0348          TO EMI-ERROR
  8731           MOVE -1               TO CEFFDTL
  8732           MOVE AL-UABON         TO CEFFDTA
  8733           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8734           GO TO 8200-SEND-DATAONLY
  8735        ELSE
  8736           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8737           PERFORM 6000-CREATE-TEMP-STORAGE
  8738                                 THRU 6000-EXIT
  8739           IF EIBAID = DFHPF17
  8740               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8741                                  THRU 6400-EXIT
  8742               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8743                                 '2' AND '3' AND '4'
  8744                  MOVE ER-3831     TO  EMI-ERROR
  8745                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8746                  GO TO 8200-SEND-DATAONLY
  8747               END-IF
  8748               MOVE 'Y'          TO PI-CLM-RESC-IND
  8749           ELSE
  8750               MOVE 'N'          TO PI-CLM-RESC-IND
  8751           END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 164
* EL6311.cbl
  8752           MOVE XCTL-EL6316      TO PGM-NAME
  8753           MOVE '2'              TO PI-ISS-CAN-SW
  8754           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8755           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8756           GO TO 9300-XCTL
  8757        END-IF
  8758     END-IF
  8759
  8760     IF EIBAID = DFHPF4
  8761        MOVE '0'                TO PI-EDIT-SW
  8762        IF PI-DISPLAY-ORIGINAL-BATCH
  8763           NEXT SENTENCE
  8764        ELSE
  8765           GO TO 7200-DISPLAY-BATCHES.
  8766
  8767     IF EIBAID = DFHPF5
  8768        MOVE ER-0029                TO EMI-ERROR
  8769        MOVE -1                     TO BPFENTRL
  8770        MOVE AL-UNBON               TO BPFENTRA
  8771        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8772        GO TO 8200-SEND-DATAONLY.
  8773*        MOVE '0'                TO PI-EDIT-SW
  8774*        IF PI-DISPLAY-ORIGINAL-BATCH
  8775*           NEXT SENTENCE
  8776*        ELSE
  8777*           MOVE EL631B              TO PI-MAP-NAME
  8778*           MOVE LOW-VALUES          TO EL631BI
  8779*           MOVE 'A'                 TO BMAINTO
  8780*           MOVE AL-UANON            TO BMAINTA
  8781*           MOVE -1                  TO BMAINTL
  8782*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8783*           GO TO 8100-SEND-INITIAL-MAP.
  8784
  8785     IF EIBAID = DFHPF6
  8786        MOVE ER-0029                TO EMI-ERROR
  8787        MOVE -1                     TO BPFENTRL
  8788        MOVE AL-UNBON               TO BPFENTRA
  8789        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8790        GO TO 8200-SEND-DATAONLY.
  8791*        MOVE '0'                TO PI-EDIT-SW
  8792*        IF PI-DISPLAY-ORIGINAL-BATCH
  8793*           NEXT SENTENCE
  8794*        ELSE
  8795*           MOVE EL631C              TO PI-MAP-NAME
  8796*           MOVE LOW-VALUES          TO EL631CI
  8797*           MOVE 'A'                 TO CMAINTO
  8798*           MOVE AL-UANON            TO CMAINTA
  8799*           MOVE -1                  TO CMAINTL
  8800*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8801*           GO TO 8100-SEND-INITIAL-MAP.
  8802
  8803     IF EIBAID = DFHPF7
  8804        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8805        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8806        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8807        MOVE PI-SV-STATE            TO PI-STATE
  8808        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8809        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 165
* EL6311.cbl
  8810        MOVE CSUFIXI                TO PI-CERT-SFX
  8811        MOVE CEFFDTI                TO DEEDIT-FIELD
  8812        PERFORM 8600-DEEDIT
  8813        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8814        MOVE '4'                    TO DC-OPTION-CODE
  8815        PERFORM 9700-DATE-LINK
  8816        IF DATE-CONVERSION-ERROR
  8817           MOVE ER-0348            TO EMI-ERROR
  8818           MOVE -1                  TO BEFFDTL
  8819           MOVE AL-UABON            TO BEFFDTA
  8820           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8821           GO TO 8200-SEND-DATAONLY
  8822        ELSE
  8823           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8824           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8825           MOVE XCTL-EL1273        TO PGM-NAME
  8826           GO TO 9300-XCTL.
  8827
  8828     IF EIBAID = DFHPF8
  8829        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8830        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8831        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8832        MOVE PI-SV-STATE            TO PI-STATE
  8833        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8834        MOVE CCERTNOI               TO PI-CERT-PRIME
  8835        MOVE CSUFIXI                TO PI-CERT-SFX
  8836        MOVE CEFFDTI                TO DEEDIT-FIELD
  8837        PERFORM 8600-DEEDIT
  8838        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8839        MOVE '4'                    TO DC-OPTION-CODE
  8840        PERFORM 9700-DATE-LINK
  8841        IF DATE-CONVERSION-ERROR
  8842           MOVE ER-0348             TO EMI-ERROR
  8843           MOVE -1                  TO BEFFDTL
  8844           MOVE AL-UABON            TO BEFFDTA
  8845           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8846           GO TO 8200-SEND-DATAONLY
  8847        ELSE
  8848           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8849           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8850           IF PI-COMPANY-ID = 'DMD'
  8851               MOVE XCTL-EL401DMD      TO PGM-NAME
  8852             ELSE
  8853               MOVE XCTL-EL1279        TO PGM-NAME
  8854           END-IF
  8855           GO TO 9300-XCTL.
  8856
  8857     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8858        MOVE XCTL-EL6312     TO PGM-NAME
  8859
  8860* EXEC CICS XCTL
  8861*           PROGRAM  (PGM-NAME)
  8862*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  8863*           LENGTH   (WS-COMM-LENGTH)
  8864*       END-EXEC
  8865*    MOVE '.$C                   %   #00008805' TO DFHEIV0
  8866     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8867     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 166
* EL6311.cbl
  8868     MOVE X'2020233030303038383035' TO DFHEIV0(25:11)
  8869     CALL 'kxdfhei1' USING DFHEIV0,
  8870           PGM-NAME,
  8871           PROGRAM-INTERFACE-BLOCK,
  8872           WS-COMM-LENGTH,
  8873           DFHEIV99
  8874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8875     ELSE
  8876        MOVE '0'                 TO  PI-EDIT-SW.
  8877
  8878     IF EIBAID = DFHPF10
  8879         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8880         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  8881         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8882         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8883                                    PI-1042-WA
  8884         MOVE 4                  TO PI-689-DATA-SOURCE
  8885         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8886         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8887         MOVE PI-SV-STATE        TO PI-689-STATE
  8888         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8889         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8890         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8891         MOVE PI-PB-ALT-CHG-SEQ-NO
  8892                                 TO PI-689-ALT-SEQ-NO
  8893         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8894         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8895         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8896         MOVE +0                 TO PI-689-CONTROL
  8897         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8898                                    PI-689-EXP-DATE
  8899                                    PI-689-RESP-PERSON
  8900                                    PI-689-TYPE
  8901                                    PI-689-FOLLOW-UP-EDIT
  8902                                    PI-689-RESEND1-EDIT
  8903                                    PI-689-SEQ-EDIT
  8904                                    PI-689-BCSEQ-EDIT
  8905                                    PI-689-LBL-OVERRIDE
  8906         MOVE W-LETTER-COMMUNICATION-AREAS
  8907                                 TO PI-PROGRAM-WORK-AREA
  8908         MOVE XCTL-EL689         TO PGM-NAME
  8909         GO TO 9300-XCTL.
  8910
  8911     IF  EIBAID = DFHPF16
  8912         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8913         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8914         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8915                                    PI-1042-WA
  8916         MOVE 4                  TO PI-689-DATA-SOURCE
  8917         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8918         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8919         MOVE PI-SV-STATE        TO PI-689-STATE
  8920         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8921         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8922         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8923         MOVE PI-PB-ALT-CHG-SEQ-NO
  8924                                 TO PI-689-ALT-SEQ-NO
  8925         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 167
* EL6311.cbl
  8926         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8927         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8928         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8929         MOVE W-LETTER-COMMUNICATION-AREAS
  8930                                 TO PI-PROGRAM-WORK-AREA
  8931         MOVE XCTL-EL690         TO PGM-NAME
  8932         GO TO 9300-XCTL.
  8933
  8934     IF EIBAID = DFHPF13
  8935        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8936        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8937        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8938        MOVE PI-SV-STATE            TO PI-STATE
  8939        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8940        MOVE CCERTNOI               TO PI-CERT-PRIME
  8941        MOVE CSUFIXI                TO PI-CERT-SFX
  8942        MOVE CEFFDTI                TO DEEDIT-FIELD
  8943        PERFORM 8600-DEEDIT
  8944        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8945        MOVE '4'                    TO DC-OPTION-CODE
  8946        PERFORM 9700-DATE-LINK
  8947        IF DATE-CONVERSION-ERROR
  8948           MOVE ER-0348            TO EMI-ERROR
  8949           MOVE -1                  TO CEFFDTL
  8950           MOVE AL-UABON            TO CEFFDTA
  8951           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8952           GO TO 8200-SEND-DATAONLY
  8953        ELSE
  8954           MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  8955           MOVE AL-UANON            TO CEFFDTA
  8956           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8957           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8958           MOVE XCTL-EL677         TO PGM-NAME
  8959           GO TO 9300-XCTL.
  8960
  8961     IF EIBAID = DFHPF14
  8962        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8963        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8964        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8965        MOVE PI-SV-STATE            TO PI-CR-STATE
  8966        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8967        MOVE SPACE                  TO PI-EDIT-SW
  8968        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8969        MOVE XCTL-EL650             TO PGM-NAME
  8970        GO TO 9300-XCTL.
  8971
  8972     IF EIBAID = DFHENTER OR DFHPF11
  8973        GO TO 2000-CANCEL-MAINLINE.
  8974
  8975     MOVE ER-0029                TO EMI-ERROR.
  8976     MOVE -1                     TO CPFENTRL.
  8977     MOVE AL-UNBON               TO CPFENTRA.
  8978     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8979     GO TO 8200-SEND-DATAONLY.
  8980
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 168
* EL6311.cbl
  8982
  8983******************************************************************
  8984*                                                                *
  8985*      BATCH SCREEN PF KEY CHECKING                              *
  8986*                                                                *
  8987******************************************************************
  8988
  8989******************************************************************
  8990*                                                                *
  8991*      PF KEY FUNCTIONS:                                         *
  8992*                                                                *
  8993*      PF1 = BROWSE FORWARD                                      *
  8994*      PF2 = BROWSE BACKWARD                                     *
  8995*      PF3 = DISPLAY PREMIUM TOTALS                              *
  8996*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  8997*                                                                *
  8998*                                                                *
  8999******************************************************************
  9000
  9001 0500-CHECK-BATCH-PF-KEYS.
  9002     IF EIBAID = DFHPF1
  9003        MOVE '0'                TO PI-EDIT-SW
  9004        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9005           GO TO 5000-BROWSE-BATCH-HEADERS
  9006        ELSE
  9007           IF PI-GOOD-BROWSE
  9008              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9009                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9010              ELSE
  9011                 IF PI-FILE-BROWSE
  9012                    GO TO 4300-BROWSE-FILE-FORWARD
  9013                 ELSE
  9014                    IF PI-CSR-BROWSE
  9015                       GO TO 4200-BROWSE-CSR-FORWARD
  9016                    ELSE
  9017                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9018           ELSE
  9019              GO TO 0800-BROWSE-ERROR.
  9020
  9021     IF EIBAID = DFHPF2
  9022        MOVE '0'                TO PI-EDIT-SW
  9023        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9024           GO TO 5500-BROWSE-BATCH-BACKWARD
  9025        ELSE
  9026           IF PI-GOOD-BROWSE
  9027              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9028                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9029              ELSE
  9030                 IF PI-FILE-BROWSE
  9031                    GO TO 4800-BROWSE-FILE-BACKWARD
  9032                 ELSE
  9033                    IF PI-CSR-BROWSE
  9034                       GO TO 4900-BROWSE-CSR-BACKWARD
  9035                    ELSE
  9036                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9037           ELSE
  9038              GO TO 0800-BROWSE-ERROR.
  9039
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 169
* EL6311.cbl
  9040     IF EIBAID = DFHPF3
  9041        GO TO 3000-BATCH-MAINLINE.
  9042
  9043     IF  EIBAID = DFHPF4
  9044        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9045        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9046        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9047        MOVE PI-SV-STATE            TO PI-CR-STATE
  9048        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9049                                       PI-CR-FIN-RESP
  9050        MOVE 'A'                    TO PI-CR-TYPE
  9051        MOVE SPACE                  TO PI-EDIT-SW
  9052        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9053        MOVE XCTL-EL640             TO PGM-NAME
  9054        GO TO 9300-XCTL.
  9055
  9056     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9057       AND
  9058        (EIBAID = DFHENTER)
  9059           GO TO 3500-EDIT-BATCH-DATA.
  9060
  9061     IF EIBAID = DFHENTER
  9062        GO TO 3500-EDIT-BATCH-DATA.
  9063
  9064     MOVE ER-0029             TO EMI-ERROR.
  9065     MOVE -1                  TO DPFENTRL.
  9066     MOVE AL-UNBON            TO DPFENTRA.
  9067     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9068     GO TO 8200-SEND-DATAONLY.
  9069
  9070 0800-BROWSE-ERROR.
  9071     MOVE ER-2258                TO EMI-ERROR.
  9072     MOVE -1                     TO DPFENTRL.
  9073     MOVE AL-UNBON               TO DPFENTRA.
  9074     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9075     GO TO 8200-SEND-DATAONLY.
  9076
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 170
* EL6311.cbl
  9078
  9079******************************************************************
  9080*                                                                *
  9081*                I S S U E   M A I N L I N E                     *
  9082*                                                                *
  9083******************************************************************
  9084
  9085 1000-ISSUE-MAINLINE.
  9086     IF PI-DISPLAY-ORIGINAL-BATCH
  9087        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9088           MOVE ER-0023             TO EMI-ERROR
  9089           MOVE -1                  TO BMAINTL
  9090           MOVE AL-UABON            TO BMAINTA
  9091           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9092           GO TO 8200-SEND-DATAONLY
  9093        ELSE
  9094           NEXT SENTENCE
  9095     ELSE
  9096        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9097           MOVE ER-0023             TO EMI-ERROR
  9098           MOVE -1                  TO BMAINTL
  9099           MOVE AL-UABON            TO BMAINTA
  9100           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9101           GO TO 8200-SEND-DATAONLY.
  9102
  9103     IF BMAINTI = 'S'
  9104        GO TO 1100-SHOW-REQUEST.
  9105
  9106     IF NOT MODIFY-CAP
  9107         MOVE 'UPDATE'       TO SM-READ
  9108         PERFORM 9995-SECURITY-VIOLATION
  9109         MOVE ER-0070        TO EMI-ERROR
  9110         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9111         GO TO 8100-SEND-INITIAL-MAP.
  9112
  9113     IF BMAINTL GREATER THAN ZEROS
  9114        IF PI-PF5-FUNCTION
  9115           IF BMAINTI NOT = 'A'
  9116              MOVE AL-UABON  TO BMAINTA
  9117              MOVE -1        TO BMAINTL
  9118              MOVE ER-2260   TO EMI-ERROR
  9119              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9120              GO TO 8200-SEND-DATAONLY.
  9121
  9122     IF BCERTNOL = ZEROS
  9123       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9124         NEXT SENTENCE
  9125     ELSE
  9126         IF BCERTNOL NOT = ZEROS
  9127             MOVE AL-UANON       TO BCERTNOA
  9128         ELSE
  9129             MOVE -1             TO BCERTNOL
  9130             MOVE  1             TO SET-CURSOR-SW
  9131             MOVE ER-2218        TO EMI-ERROR
  9132             MOVE AL-UABON       TO BCERTNOA
  9133             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9134
  9135     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 171
* EL6311.cbl
  9136         MOVE AL-UANON       TO BSUFIXA
  9137     ELSE
  9138         MOVE AL-SANOF       TO BSUFIXA.
  9139
  9140     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9141        NEXT SENTENCE
  9142     ELSE
  9143        IF BEFFDTL NOT = ZEROS
  9144           MOVE AL-UNNON             TO BEFFDTA
  9145           MOVE BEFFDTI              TO DEEDIT-FIELD
  9146           PERFORM 8600-DEEDIT
  9147           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9148           MOVE 4                    TO DC-OPTION-CODE
  9149           PERFORM 9700-DATE-LINK
  9150           IF NO-CONVERSION-ERROR
  9151              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9152              ELSE
  9153              MOVE -1                TO BEFFDTL
  9154              MOVE  1                TO SET-CURSOR-SW
  9155              MOVE ER-2226           TO EMI-ERROR
  9156              MOVE AL-UNBON          TO BEFFDTA
  9157              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9158           ELSE
  9159              MOVE -1                TO BEFFDTL
  9160              MOVE  1                TO SET-CURSOR-SW
  9161              MOVE ER-2220           TO EMI-ERROR
  9162              MOVE AL-UNBON          TO BEFFDTA
  9163              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9164
  9165     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9166
  9167     IF BCERTNOL NOT = ZEROS
  9168        MOVE BCERTNOI                TO WS-NEW-PRIME
  9169     ELSE
  9170        MOVE SPACES                  TO WS-NEW-PRIME.
  9171
  9172     IF BSUFIXL NOT = ZEROS
  9173        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9174     ELSE
  9175        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9176
  9177     IF BEFFDTL NOT = ZEROS
  9178        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9179     ELSE
  9180        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9181
  9182     IF BMAINTI = 'A' OR 'K' OR 'S'
  9183        NEXT SENTENCE
  9184     ELSE
  9185        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9186        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9187           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9188           WS-PB-RECORD-TYPE NOT = '1'
  9189           IF BMAINTI = 'C'
  9190               MOVE ER-2287          TO EMI-ERROR
  9191               MOVE -1               TO BCERTNOL
  9192               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9193               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 172
* EL6311.cbl
  9194               GO TO 8200-SEND-DATAONLY
  9195             ELSE
  9196               MOVE ER-2260          TO EMI-ERROR
  9197               MOVE -1               TO BCERTNOL
  9198               MOVE AL-UABON         TO BCERTNOA
  9199               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9200               GO TO 8200-SEND-DATAONLY.
  9201
  9202     IF BMAINTI = 'D'
  9203         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9204
  9205*    IF BMICRNOL  NOT =  ZEROS
  9206*        IF BMICRNOI  NUMERIC
  9207*            MOVE AL-UNNON       TO  BMICRNOA
  9208*        ELSE
  9209*            MOVE -1             TO  BMICRNOL
  9210*            MOVE 1              TO  SET-CURSOR-SW
  9211*            MOVE AL-UNBON       TO  BMICRNOA
  9212*            MOVE ER-2701        TO  EMI-ERROR
  9213*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9214     IF BVINL NOT = ZEROS
  9215        MOVE AL-UANON            TO BVINA
  9216     END-IF
  9217     IF B1STNML NOT = ZEROS
  9218         MOVE AL-UANON                TO B1STNMA.
  9219
  9220     IF BINITL  NOT = ZEROS
  9221        MOVE AL-UANON                TO BINITA.
  9222
  9223     IF BSEXL NOT = ZEROS
  9224        IF BSEXI = 'M' OR 'F'
  9225           MOVE AL-UANON             TO BSEXA
  9226        ELSE
  9227           MOVE -1               TO BSEXL
  9228           MOVE ER-2629          TO EMI-ERROR
  9229           MOVE AL-UABON         TO BSEXA
  9230           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9231
  9232     IF BAGEL NOT = ZEROS
  9233         IF BAGEI NUMERIC
  9234             MOVE BAGEI              TO WS-BAGE
  9235             MOVE AL-UNNON           TO BAGEA
  9236         ELSE
  9237             MOVE -1                 TO BAGEL
  9238             MOVE  1                 TO SET-CURSOR-SW
  9239             MOVE ER-2223            TO EMI-ERROR
  9240             MOVE AL-UNBON           TO BAGEA
  9241             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9242
  9243     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9244
  9245     IF (BBIRTHL GREATER THAN +0) AND
  9246        (BBIRTHI NOT EQUAL SPACES)
  9247        NEXT SENTENCE
  9248     ELSE
  9249        GO TO 1010-CHECK-AGE.
  9250
  9251     MOVE BBIRTHI                TO DEEDIT-FIELD.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 173
* EL6311.cbl
  9252     PERFORM 8600-DEEDIT.
  9253     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9254     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9255     MOVE AL-UNNON               TO BBIRTHA.
  9256     MOVE '4'                    TO DC-OPTION-CODE.
  9257     PERFORM 9700-DATE-LINK.
  9258     IF DATE-CONVERSION-ERROR
  9259        MOVE -1                  TO BBIRTHL
  9260        MOVE  1                  TO SET-CURSOR-SW
  9261        MOVE ER-2228             TO EMI-ERROR
  9262        MOVE AL-UNBON            TO BBIRTHA
  9263        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9264        GO TO 1010-CHECK-AGE.
  9265
  9266     IF (NO-CONVERSION-ERROR) AND
  9267        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9268        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9269        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9270        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9271                                    WS-CONVERTED-BIRTH
  9272        MOVE AL-UANON            TO BBIRTHA
  9273     ELSE
  9274        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9275        MOVE AL-UANON            TO BBIRTHA.
  9276
  9277 1010-CHECK-AGE.
  9278
  9279*    IF BAGEL = ZERO
  9280*       IF BBIRTHL GREATER THAN ZERO
  9281*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9282
  9283     IF B1STPMTL NOT = ZEROS
  9284        IF B1STPMTI = SPACES
  9285           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9286        ELSE
  9287           MOVE B1STPMTI             TO DEEDIT-FIELD
  9288           PERFORM 8600-DEEDIT
  9289           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9290           MOVE AL-UNNON             TO B1STPMTA
  9291           MOVE 4                    TO DC-OPTION-CODE
  9292           PERFORM 9700-DATE-LINK
  9293           IF NO-CONVERSION-ERROR
  9294              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9295              MOVE AL-UANON          TO B1STPMTA
  9296           ELSE
  9297              MOVE -1                TO B1STPMTL
  9298              MOVE  1                TO SET-CURSOR-SW
  9299              MOVE ER-2200           TO EMI-ERROR
  9300              MOVE AL-UNBON          TO B1STPMTA
  9301              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9302
  9303     IF BDAYSL NOT = ZEROS
  9304         IF BDAYSI NUMERIC
  9305             MOVE AL-UNNON           TO BDAYSA
  9306         ELSE
  9307             MOVE -1                 TO BDAYSL
  9308             MOVE ER-2530            TO EMI-ERROR
  9309             MOVE AL-UNBON           TO BDAYSA
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 174
* EL6311.cbl
  9310             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9311
  9312     IF BLNTRML NOT = ZEROS
  9313         IF BLNTRMI NUMERIC
  9314             MOVE AL-UNNON       TO BLNTRMA
  9315         ELSE
  9316             MOVE -1             TO BLNTRML
  9317             MOVE ER-2533        TO EMI-ERROR
  9318             MOVE AL-UNBON       TO BLNTRMA
  9319             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9320
  9321**   IF PI-COMPANY-ID = 'DMD'
  9322     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9323        NEXT SENTENCE
  9324     ELSE
  9325         IF BLNOFCRL NOT = ZEROS
  9326            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9327            IF LOAN-OFFICER-FOUND
  9328                MOVE AL-UANON        TO BLNOFCRA
  9329             ELSE
  9330                 MOVE SPACE          TO WS-LOAN-OFFICER
  9331                 MOVE -1             TO BLNOFCRL
  9332                 MOVE  1             TO SET-CURSOR-SW
  9333                 MOVE ER-3006        TO EMI-ERROR
  9334                 MOVE AL-UNBON       TO BLNOFCRA
  9335                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9336
  9337     IF BFREQL NOT = ZEROS
  9338         IF BFREQI NUMERIC
  9339             MOVE AL-UNNON       TO BFREQA
  9340         ELSE
  9341             MOVE -1             TO BFREQL
  9342             MOVE  1             TO SET-CURSOR-SW
  9343             MOVE ER-2223        TO EMI-ERROR
  9344             MOVE AL-UNBON       TO BFREQA
  9345             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9346
  9347     IF BMODEL NOT = ZEROS
  9348         MOVE BMODEI             TO WS-MODE-CODE
  9349                                    PI-BMODE
  9350         IF WS-MODE-CODE-VALID
  9351             MOVE AL-UANON       TO BMODEA
  9352         ELSE
  9353             MOVE -1             TO BMODEL
  9354             MOVE ER-2591        TO EMI-ERROR
  9355             MOVE AL-UABON       TO BMODEA
  9356             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9357
  9358     IF BPMTSL NOT = ZEROS
  9359         IF BPMTSI NUMERIC
  9360             MOVE AL-UNNON           TO BPMTSA
  9361             MOVE BPMTSI             TO PI-BPMTS
  9362         ELSE
  9363             MOVE -1                 TO BPMTSL
  9364             MOVE ER-2592            TO EMI-ERROR
  9365             MOVE AL-UNBON           TO BPMTSA
  9366             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9367
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 175
* EL6311.cbl
  9368     IF BPMTAMTL NOT = ZEROS
  9369
  9370* EXEC CICS BIF DEEDIT
  9371*            FIELD  (BPMTAMTI)
  9372*            LENGTH (9)
  9373*       END-EXEC
  9374     MOVE 9
  9375       TO DFHEIV11
  9376*    MOVE '@"L                   #   #00009304' TO DFHEIV0
  9377     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9378     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9379     MOVE X'2020233030303039333034' TO DFHEIV0(25:11)
  9380     CALL 'kxdfhei1' USING DFHEIV0,
  9381           BPMTAMTI,
  9382           DFHEIV11
  9383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9384        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9385*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9386*        PERFORM 8600-DEEDIT
  9387*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9388
  9389*    IF BAPRL NOT = ZEROS
  9390*        EXEC CICS BIF DEEDIT
  9391*            FIELD  (BAPRI)
  9392*            LENGTH (7)
  9393*        END-EXEC
  9394*        MOVE BAPRI              TO WS-BAPR.
  9395
  9396     IF BAPRL > 0
  9397        MOVE +0                  TO  WS-BAPR
  9398        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9399           (WS-SUB > 7)
  9400           OR (BAPRI (WS-SUB:1) NUMERIC)
  9401           OR (BAPRI (WS-SUB:1) = '.')
  9402        END-PERFORM
  9403        IF WS-SUB > 7
  9404           MOVE ER-2471       TO EMI-ERROR
  9405           MOVE -1            TO BAPRL
  9406           MOVE AL-UNBON      TO BAPRA
  9407           PERFORM 9900-ERROR-FORMAT
  9408                                 THRU 9900-EXIT
  9409        ELSE
  9410           IF BAPRI (WS-SUB:1) NUMERIC
  9411              MOVE WS-SUB           TO WS-BEG
  9412              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9413                 (WS-SUB > 7)
  9414                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9415              END-PERFORM
  9416              COMPUTE WS-END = WS-SUB - WS-BEG
  9417              MOVE BAPRI (WS-BEG:WS-END)
  9418                                 TO WS-APR-WHOLE-NUM
  9419           END-IF
  9420           IF BAPRI (WS-SUB:1) = '.'
  9421              COMPUTE WS-BEG = WS-SUB + 1
  9422              IF (WS-BEG < 8)
  9423                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9424                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9425                    (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 176
* EL6311.cbl
  9426                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9427                 END-PERFORM
  9428                 COMPUTE WS-END = WS-SUB - WS-BEG
  9429                 MOVE BAPRI (WS-BEG:WS-END)
  9430                                 TO WS-APR-DEC (1:WS-END)
  9431              END-IF
  9432           END-IF
  9433           MOVE AL-UNNON      TO BAPRA
  9434           MOVE WS-BAPR       TO BAPRO
  9435        END-IF
  9436     END-IF
  9437*     IF BAPRL NOT = ZEROS
  9438*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9439*        PERFORM 8600-DEEDIT
  9440*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9441
  9442     IF BLIVESL NOT = ZEROS
  9443        MOVE BLIVESI             TO DEEDIT-FIELD
  9444        PERFORM 8600-DEEDIT
  9445        IF DEEDIT-FIELD-V0 NUMERIC
  9446           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9447           MOVE AL-UNNON         TO BLIVESA
  9448        ELSE
  9449           MOVE -1               TO BLIVESL
  9450           MOVE AL-UNBON         TO BLIVESA
  9451           MOVE ER-2223          TO EMI-ERROR
  9452           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9453
  9454*DMD CUSTOM CODING*************START
  9455*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9456     IF PI-COMPANY-ID NOT = 'DMD'
  9457         MOVE ZEROS               TO BBILLEDL
  9458         GO TO 1010-EDIT-CONT.
  9459
  9460     IF BBILLEDL NOT = ZEROS
  9461        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9462        MOVE 'Y'                 TO WS-NUMERIC-SW
  9463        MOVE +1                  TO WS-CSO-SUB
  9464        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9465        IF CSO-NUMERIC-FIELD
  9466
  9467* EXEC CICS BIF DEEDIT
  9468*              FIELD  (BBILLEDI)
  9469*              LENGTH (9)
  9470*          END-EXEC
  9471     MOVE 9
  9472       TO DFHEIV11
  9473*    MOVE '@"L                   #   #00009390' TO DFHEIV0
  9474     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9475     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9476     MOVE X'2020233030303039333930' TO DFHEIV0(25:11)
  9477     CALL 'kxdfhei1' USING DFHEIV0,
  9478           BBILLEDI,
  9479           DFHEIV11
  9480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9481           MOVE BBILLEDI         TO WS-BILLED
  9482           MOVE AL-UNNON         TO BBILLEDA
  9483        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 177
* EL6311.cbl
  9484           MOVE -1               TO BBILLEDL
  9485           MOVE AL-UNBON         TO BBILLEDA
  9486           MOVE ER-2547          TO EMI-ERROR
  9487           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9488     ELSE
  9489        IF BMAINTI EQUAL 'A'
  9490           MOVE -1               TO BBILLEDL
  9491           MOVE AL-UNBON         TO BBILLEDA
  9492           MOVE ER-8148          TO EMI-ERROR
  9493           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9494
  9495 1010-EDIT-CONT.
  9496
  9497     IF BFORCEL  NOT = ZEROS
  9498         IF FORCE-CAP
  9499            MOVE AL-UANON            TO BFORCEA
  9500         ELSE
  9501            MOVE ER-2945             TO EMI-ERROR
  9502            MOVE AL-UABON            TO BFORCEA
  9503            MOVE -1                  TO BFORCEL
  9504            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9505
  9506     IF BENTRYL NOT = ZEROS
  9507        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9508                         'D' AND 'V' AND 'U' AND 'M'
  9509           MOVE ER-2224              TO EMI-ERROR
  9510           MOVE AL-UABON             TO BENTRYA
  9511           MOVE -1                   TO BENTRYL
  9512           MOVE  1                   TO SET-CURSOR-SW
  9513           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9514        ELSE
  9515           MOVE AL-UANON             TO BENTRYA.
  9516
  9517     IF BUNWRITL NOT = ZEROS
  9518        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9519           MOVE ER-7574              TO EMI-ERROR
  9520           MOVE AL-UABON             TO BUNWRITA
  9521           MOVE -1                   TO BUNWRITL
  9522           MOVE  1                   TO SET-CURSOR-SW
  9523           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9524        ELSE
  9525           MOVE AL-UANON             TO BUNWRITA.
  9526
  9527     IF BREINL  NOT = ZEROS
  9528         MOVE AL-UANON               TO BREINA.
  9529
  9530     IF BBILCDL NOT = ZEROS
  9531        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9532                             AND 'A' AND 'B' AND 'E'
  9533           MOVE ER-2225              TO EMI-ERROR
  9534           MOVE AL-UABON             TO BBILCDA
  9535           MOVE -1                   TO BBILCDL
  9536           MOVE  1                   TO SET-CURSOR-SW
  9537           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9538        ELSE
  9539           MOVE AL-UANON             TO BBILCDA.
  9540
  9541     IF BSKPCDL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 178
* EL6311.cbl
  9542         MOVE AL-UANON               TO BSKPCDA.
  9543
  9544     IF BINDGRPL NOT = ZEROS
  9545         MOVE AL-UANON               TO BINDGRPA.
  9546
  9547     IF BSIGL   NOT = ZEROS
  9548         MOVE AL-UANON               TO BSIGA.
  9549
  9550     IF BRTCLSL NOT = ZEROS
  9551         MOVE AL-UANON               TO BRTCLSA.
  9552
  9553     IF BMEMBERL NOT = ZEROS
  9554         MOVE AL-UANON               TO BMEMBERA.
  9555
  9556     MOVE +0                         TO WS-SUB1.
  9557
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 179
* EL6311.cbl
  9559
  9560******************************************************************
  9561*                                                                *
  9562*           E D I T   I S S U E   C O V E R A G E S              *
  9563*                                                                *
  9564******************************************************************
  9565
  9566 1020-EDIT-COVERAGES.
  9567     ADD +1                      TO WS-SUB1.
  9568
  9569     IF WS-SUB1 GREATER +2
  9570        GO TO 1025-EDIT-COMPLETE.
  9571
  9572     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9573       IF (BMODEL   GREATER ZERO  OR
  9574            BPMTSL   GREATER ZERO  OR
  9575            BPMTAMTL GREATER ZERO)
  9576          AND
  9577            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9578               GO TO 1021-CONT-EDIT.
  9579
  9580     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9581        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9582        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9583        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9584        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9585        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9586        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9587        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9588        NEXT SENTENCE
  9589         ELSE
  9590            GO TO 1020-EDIT-COVERAGES.
  9591
  9592 1021-CONT-EDIT.
  9593
  9594     IF BMAINTI = 'A'
  9595        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9596           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9597        ELSE
  9598           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9599           MOVE ER-7404          TO EMI-ERROR
  9600           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9601           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9602     ELSE
  9603        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9604           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9605
  9606     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9607        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9608        PERFORM 8600-DEEDIT
  9609        IF DEEDIT-FIELD-V0 NUMERIC
  9610           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9611        ELSE
  9612           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9613
  9614     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9615*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9616        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 180
* EL6311.cbl
  9617           BPMTSL  GREATER THAN ZEROS
  9618           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9619
  9620     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9621         IF BMODEL   GREATER THAN ZEROS  OR
  9622            BPMTSL   GREATER THAN ZEROS  OR
  9623            BPMTAMTL GREATER THAN ZEROS
  9624             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9625
  9626     IF BMAINTI = ('C' OR 'K')
  9627        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9628           NEXT SENTENCE
  9629        ELSE
  9630           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9631           PERFORM 8600-DEEDIT
  9632           IF DEEDIT-FIELD-V0 NUMERIC
  9633              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9634              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9635                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9636              ELSE
  9637                    MOVE ER-2241      TO EMI-ERROR
  9638                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9639                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9640                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9641           ELSE
  9642              MOVE ER-2223          TO EMI-ERROR
  9643              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9644              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9645              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9646     ELSE
  9647        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9648            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9649            PERFORM 8600-DEEDIT
  9650            IF DEEDIT-FIELD-V0      NUMERIC
  9651               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9652                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9653                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9654               ELSE
  9655                  MOVE ER-2241         TO EMI-ERROR
  9656                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9657                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9658                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9659            ELSE
  9660              MOVE ER-2223             TO EMI-ERROR
  9661              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9662              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9663              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9664        ELSE
  9665            MOVE ER-2240               TO EMI-ERROR
  9666            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9667            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9668*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9669*        IF BMODEL  GREATER THAN ZEROS  AND
  9670*           BPMTSL  GREATER THAN ZEROS
  9671*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9672
  9673     IF BBEN-LEN (WS-SUB1) = ZEROS
  9674        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 181
* EL6311.cbl
  9675           NEXT SENTENCE
  9676     ELSE
  9677        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9678           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9679
  9680* EXEC CICS BIF DEEDIT
  9681*              FIELD  (BBENI (WS-SUB1))
  9682*              LENGTH (12)
  9683*          END-EXEC
  9684     MOVE 12
  9685       TO DFHEIV11
  9686*    MOVE '@"L                   #   #00009592' TO DFHEIV0
  9687     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9688     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9689     MOVE X'2020233030303039353932' TO DFHEIV0(25:11)
  9690     CALL 'kxdfhei1' USING DFHEIV0,
  9691           BBENI(WS-SUB1),
  9692           DFHEIV11
  9693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9694           IF BBENI (WS-SUB1)  NUMERIC
  9695              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9696                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9697*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9698*          PERFORM 8600-DEEDIT
  9699*          IF DEEDIT-FIELD-V2  NUMERIC
  9700*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9701*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9702              ELSE
  9703                 MOVE ER-7632    TO EMI-ERROR
  9704                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9705                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9706                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9707           ELSE
  9708              MOVE ER-2223         TO EMI-ERROR
  9709              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9710              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9711              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9712        ELSE
  9713           MOVE ER-7632    TO EMI-ERROR
  9714           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9715           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9716           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9717
  9718     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9719        AND (BMAINTI = ('C' OR 'K'))
  9720        CONTINUE
  9721     ELSE
  9722        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9723           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9724           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9725              FOR ALL '.'
  9726           IF WS-TALLY > 1
  9727              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9728                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9729              END-PERFORM
  9730              IF A1 < 9
  9731                 ADD 3 TO A1
  9732                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 182
* EL6311.cbl
  9733              END-IF
  9734           ELSE
  9735              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9736                (A1 > 11)
  9737                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9738                  LOW-VALUES OR SPACES)
  9739              END-PERFORM
  9740              IF A1 > 1 AND < 12
  9741                 MOVE SPACES
  9742                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9743              END-IF
  9744           END-IF
  9745
  9746* EXEC CICS BIF DEEDIT
  9747*              FIELD  (BPREMI (WS-SUB1))
  9748*              LENGTH (11)
  9749*          END-EXEC
  9750     MOVE 11
  9751       TO DFHEIV11
  9752*    MOVE '@"L                   #   #00009647' TO DFHEIV0
  9753     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9754     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9755     MOVE X'2020233030303039363437' TO DFHEIV0(25:11)
  9756     CALL 'kxdfhei1' USING DFHEIV0,
  9757           BPREMI(WS-SUB1),
  9758           DFHEIV11
  9759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9760           IF BPREMI (WS-SUB1) NUMERIC
  9761              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9762                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9763*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9764*          PERFORM 8600-DEEDIT
  9765*          IF DEEDIT-FIELD-V2  NUMERIC
  9766*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9767*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9768              ELSE
  9769                 IF PI-COMPANY-ID NOT = 'DCC'
  9770                    MOVE ER-7633    TO EMI-ERROR
  9771                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9772                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9773                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9774                 END-IF
  9775              END-IF
  9776           ELSE
  9777              MOVE ER-2223         TO EMI-ERROR
  9778              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9779              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9780              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9781           END-IF
  9782        ELSE
  9783           IF PI-COMPANY-ID NOT = 'DCC'
  9784              MOVE ER-7633         TO EMI-ERROR
  9785              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9786              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9787              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9788           END-IF
  9789        END-IF
  9790     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 183
* EL6311.cbl
  9791
  9792     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9793        NEXT SENTENCE
  9794     ELSE
  9795        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9796
  9797* EXEC CICS BIF DEEDIT
  9798*           FIELD  (BCPREMI (WS-SUB1))
  9799*           LENGTH (11)
  9800*       END-EXEC
  9801     MOVE 11
  9802       TO DFHEIV11
  9803*    MOVE '@"L                   #   #00009687' TO DFHEIV0
  9804     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9805     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9806     MOVE X'2020233030303039363837' TO DFHEIV0(25:11)
  9807     CALL 'kxdfhei1' USING DFHEIV0,
  9808           BCPREMI(WS-SUB1),
  9809           DFHEIV11
  9810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9811        IF BCPREMI (WS-SUB1) NUMERIC
  9812           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  9813*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
  9814*       PERFORM 8600-DEEDIT
  9815*       IF DEEDIT-FIELD-V2  NUMERIC
  9816*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
  9817        ELSE
  9818           MOVE ER-2223         TO EMI-ERROR
  9819           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
  9820           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
  9821           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9822
  9823     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9824        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  9825        PERFORM 8600-DEEDIT
  9826        IF DEEDIT-FIELD-V0 NUMERIC
  9827           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  9828           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9829         ELSE
  9830           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  9831           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9832           MOVE ER-2223              TO EMI-ERROR
  9833           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9834
  9835     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9836        IF BEXPIRE   (WS-SUB1) = SPACES
  9837           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  9838        ELSE
  9839           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
  9840           PERFORM 8600-DEEDIT
  9841           IF DEEDIT-FIELD-V0        NUMERIC
  9842              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
  9843              MOVE 4                TO DC-OPTION-CODE
  9844              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9845              PERFORM 9700-DATE-LINK
  9846              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
  9847                                                        (WS-SUB1)
  9848              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 184
* EL6311.cbl
  9849                 NEXT SENTENCE
  9850              ELSE
  9851                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  9852                 MOVE ER-2531    TO EMI-ERROR
  9853                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  9854                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9855           ELSE
  9856             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  9857             MOVE ER-2532        TO EMI-ERROR
  9858             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  9859             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9860
  9861     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
  9862        NEXT SENTENCE
  9863     ELSE
  9864
  9865* EXEC CICS BIF DEEDIT
  9866*           FIELD  (BALT-BENI (WS-SUB1))
  9867*           LENGTH (12)
  9868*       END-EXEC
  9869     MOVE 12
  9870       TO DFHEIV11
  9871*    MOVE '@"L                   #   #00009744' TO DFHEIV0
  9872     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9873     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9874     MOVE X'2020233030303039373434' TO DFHEIV0(25:11)
  9875     CALL 'kxdfhei1' USING DFHEIV0,
  9876           BALT-BENI(WS-SUB1),
  9877           DFHEIV11
  9878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9879        IF BALT-BENI (WS-SUB1) NUMERIC
  9880           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
  9881*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
  9882*       PERFORM 8600-DEEDIT
  9883*       IF DEEDIT-FIELD-V0 NUMERIC
  9884*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
  9885        ELSE
  9886           MOVE ER-2223         TO EMI-ERROR
  9887           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
  9888           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
  9889           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9890
  9891     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
  9892        NEXT SENTENCE
  9893     ELSE
  9894
  9895* EXEC CICS BIF DEEDIT
  9896*           FIELD  (BALT-PREMI (WS-SUB1))
  9897*           LENGTH (11)
  9898*       END-EXEC
  9899     MOVE 11
  9900       TO DFHEIV11
  9901*    MOVE '@"L                   #   #00009763' TO DFHEIV0
  9902     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9903     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9904     MOVE X'2020233030303039373633' TO DFHEIV0(25:11)
  9905     CALL 'kxdfhei1' USING DFHEIV0,
  9906           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 185
* EL6311.cbl
  9907           DFHEIV11
  9908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9909        IF BALT-PREMI (WS-SUB1) NUMERIC
  9910           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
  9911*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
  9912*       PERFORM 8600-DEEDIT
  9913*       IF DEEDIT-FIELD-V0 NUMERIC
  9914*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
  9915        ELSE
  9916           MOVE ER-2223         TO EMI-ERROR
  9917           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
  9918           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
  9919           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9920
  9921      GO TO 1020-EDIT-COVERAGES.
  9922
  9923 1025-EDIT-COMPLETE.
  9924     IF PI-COMPANY-ID  =  'DMD'
  9925        MOVE LOW-VALUES             TO BNCERTI
  9926                                       BNSTATI.
  9927
  9928     IF EMI-ERROR = ZEROS
  9929         NEXT SENTENCE
  9930     ELSE
  9931         GO TO 8200-SEND-DATAONLY.
  9932
  9933     IF BMAINTI = 'A'
  9934         GO TO 1200-ADD-ISSUE-ROUTINE.
  9935
  9936     IF BMAINTI = 'C'
  9937         GO TO 1300-CHANGE-ISSUE-ROUTINE.
  9938
  9939     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
  9940
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 186
* EL6311.cbl
  9942
  9943 1030-EDIT-FOR-NUMERICS.
  9944     IF WS-CSO-SUB EQUAL 10
  9945        GO TO 1030-EDIT-EXIT.
  9946
  9947     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
  9948        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
  9949        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
  9950           ADD +1               TO WS-CSO-SUB
  9951           GO TO 1030-EDIT-FOR-NUMERICS.
  9952
  9953     MOVE 'N'                   TO WS-NUMERIC-SW.
  9954
  9955 1030-EDIT-EXIT.
  9956******************************************************************
  9957*                                                                *
  9958*                 C A L C U L A T E   A G E                      *
  9959*                                                                *
  9960******************************************************************
  9961
  9962
  9963 1095-CALC-AGE.
  9964
  9965     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
  9966     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
  9967     MOVE 1                  TO DC-OPTION-CODE.
  9968     PERFORM 9700-DATE-LINK
  9969     IF NO-CONVERSION-ERROR
  9970         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
  9971         MOVE WS-BAGE            TO BAGEI
  9972         MOVE +2                 TO BAGEL
  9973         MOVE AL-UNNON TO BAGEA.
  9974
  9975 1099-EXIT.
  9976     EXIT.
  9977
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 187
* EL6311.cbl
  9979
  9980******************************************************************
  9981*                                                                *
  9982*                   S H O W   I S S U E                          *
  9983*                                                                *
  9984******************************************************************
  9985
  9986 1100-SHOW-REQUEST.
  9987     MOVE 'S'                    TO PI-MAINT-FUNCTION.
  9988
  9989     IF BCERTNOL = ZEROS AND
  9990        BEFFDTL  = ZEROS
  9991        MOVE -1                  TO BMAINTL
  9992        GO TO 8200-SEND-DATAONLY.
  9993
  9994     MOVE BCERTNOI               TO WS-NEW-PRIME.
  9995
  9996     IF BSUFIXL NOT = ZEROS
  9997        MOVE BSUFIXI             TO WS-NEW-SUFFIX
  9998     ELSE
  9999        MOVE SPACE               TO WS-NEW-SUFFIX.
 10000
 10001     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10002     PERFORM 8600-DEEDIT.
 10003     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10004     MOVE '4'                    TO DC-OPTION-CODE.
 10005     PERFORM 9700-DATE-LINK.
 10006     IF DATE-CONVERSION-ERROR
 10007        MOVE ER-0348             TO EMI-ERROR
 10008        MOVE -1                  TO BEFFDTL
 10009        MOVE AL-UABON            TO BEFFDTA
 10010        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10011        GO TO 8200-SEND-DATAONLY
 10012     ELSE
 10013        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10014        MOVE AL-UANON            TO BEFFDTA
 10015        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10016
 10017     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10018
 10019     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10020        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10021          MOVE 'Y'                    TO WS-SHOW-SW
 10022          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10023             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10024           ELSE
 10025             IF PI-FILE-BROWSE
 10026                GO TO 4300-BROWSE-FILE-FORWARD
 10027              ELSE
 10028                IF PI-CSR-BROWSE
 10029                   GO TO 4200-BROWSE-CSR-FORWARD
 10030                ELSE
 10031                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10032        ELSE
 10033           GO TO 3900-RE-DISPLAY-RECORD.
 10034
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 188
* EL6311.cbl
 10036
 10037******************************************************************
 10038*                                                                *
 10039*            A D D   I S S U E   R O U T I N E                   *
 10040*                                                                *
 10041******************************************************************
 10042
 10043***************************************************************
 10044*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10045*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10046*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10047*     4. LINK TO THE EDIT ROUTINE.                            *
 10048*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10049*     6. WRITE THE NEW ISSUE RECORD.                          *
 10050*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10051*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10052*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10053*        ELSE                                                 *
 10054*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10055***************************************************************
 10056
 10057 1200-ADD-ISSUE-ROUTINE.
 10058     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10059
 10060
 10061* EXEC CICS GETMAIN
 10062*        SET     (ADDRESS OF PENDING-BUSINESS)
 10063*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10064*    END-EXEC.
 10065*    MOVE '," L                  $   #00009918' TO DFHEIV0
 10066     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10067     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10068     MOVE X'2020233030303039393138' TO DFHEIV0(25:11)
 10069     CALL 'kxdfhei1' USING DFHEIV0,
 10070           DFHEIV20,
 10071           ERPNDB-RECORD-LENGTH,
 10072           DFHEIV99
 10073     SET ADDRESS OF PENDING-BUSINESS TO
 10074         DFHEIV20
 10075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10076
 10077
 10078
 10079* EXEC CICS HANDLE CONDITION
 10080*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10081*    END-EXEC.
 10082*    MOVE '"$I                   ! # #00009923' TO DFHEIV0
 10083     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10084     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10085     MOVE X'2320233030303039393233' TO DFHEIV0(25:11)
 10086     CALL 'kxdfhei1' USING DFHEIV0
 10087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10088
 10089
 10090     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10091     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10092     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10093
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 189
* EL6311.cbl
 10094
 10095* EXEC CICS READ
 10096*        INTO    (PENDING-BUSINESS)
 10097*        DATASET (FILE-ID-ERPNDB)
 10098*        RIDFLD  (ERPNDB-KEY)
 10099*    END-EXEC.
 10100     MOVE LENGTH OF
 10101      PENDING-BUSINESS
 10102       TO DFHEIV11
 10103*    MOVE '&"IL       E          (   #00009931' TO DFHEIV0
 10104     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10105     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10106     MOVE X'2020233030303039393331' TO DFHEIV0(25:11)
 10107     CALL 'kxdfhei1' USING DFHEIV0,
 10108           FILE-ID-ERPNDB,
 10109           PENDING-BUSINESS,
 10110           DFHEIV11,
 10111           ERPNDB-KEY,
 10112           DFHEIV99,
 10113           DFHEIV99,
 10114           DFHEIV99
 10115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10116
 10117
 10118     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10119
 10120     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10121     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10122     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10123     MOVE SPACES                 TO PENDING-BUSINESS.
 10124     MOVE 'PB'                   TO PB-RECORD-ID.
 10125     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10126     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10127     MOVE SPACES                 TO PB-CERT-SFX.
 10128     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10129     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10130                                    PB-ALT-CHG-SEQ-NO.
 10131
 10132     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10133     MOVE '1'                    TO PB-RECORD-TYPE.
 10134
 10135     IF BSUFIXL NOT = ZEROS
 10136        MOVE BSUFIXI             TO PB-CERT-SFX.
 10137
 10138     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10139
 10140     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10141     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10142
 10143     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10144                                    PB-I-LF-PREM-CALC
 10145                                    PB-I-LF-ALT-PREM-CALC
 10146                                    PB-I-LF-RATE
 10147                                    PB-I-LF-ALT-RATE
 10148                                    PB-I-LF-REI-RATE
 10149                                    PB-I-LF-ALT-REI-RATE
 10150                                    PB-I-RATE-DEV-PCT-LF
 10151                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 190
* EL6311.cbl
 10152                                    PB-I-AH-RATE
 10153                                    PB-I-AH-REI-RATE
 10154                                    PB-I-AH-RATE-TRM
 10155                                    PB-I-RATE-DEV-PCT-AH
 10156                                    PB-I-BUSINESS-TYPE
 10157                                    PB-I-LIFE-COMMISSION
 10158                                    PB-I-JOINT-COMMISSION
 10159                                    PB-I-JOINT-AGE
 10160                                    PB-I-AH-COMMISSION
 10161                                    PB-I-CURR-SEQ
 10162                                    PB-CHG-COUNT
 10163                                    PB-LF-BILLED-AMTS
 10164                                    PB-AH-BILLED-AMTS
 10165                                    PB-CALC-TOLERANCE
 10166                                    PB-I-EXTENTION-DAYS
 10167*                                   PB-I-MICROFILM-NO
 10168                                    PB-I-TERM-IN-DAYS.
 10169
 10170     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10171                                    PB-I-LF-EXPIRE-DT
 10172                                    PB-I-AH-EXPIRE-DT
 10173                                    PB-BILLED-DT
 10174                                    PB-ACCT-EFF-DT
 10175                                    PB-ACCT-EXP-DT
 10176                                    PB-I-1ST-PMT-DT.
 10177
 10178     MOVE 'X'                    TO PB-FATAL-FLAG.
 10179
 10180     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10181
 10182     IF BLSTNML GREATER THAN ZEROS
 10183         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10184
 10185*    IF BMICRNOL  GREATER  ZEROS
 10186*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10187*    ELSE
 10188*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10189     IF BVINL > ZEROS
 10190        MOVE BVINI               TO PB-I-VIN
 10191     END-IF
 10192     IF B1STNML GREATER THAN ZEROS
 10193         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10194
 10195     IF BINITL  GREATER THAN ZEROS
 10196         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10197
 10198     IF BBIRTHL GREATER THAN ZERO
 10199         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10200     ELSE
 10201         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10202
 10203     IF B1STPMTL GREATER THAN ZERO
 10204         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10205     ELSE
 10206         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10207
 10208     IF BAGEL    GREATER THAN ZEROS
 10209         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 191
* EL6311.cbl
 10210        ELSE
 10211         MOVE ZEROS              TO PB-I-AGE.
 10212
 10213     IF BSEXL    GREATER THAN ZEROS
 10214         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10215
 10216     IF BTERM-LEN (1) GREATER THAN ZEROS
 10217        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10218     ELSE
 10219        MOVE ZEROS               TO PB-I-LF-TERM.
 10220
 10221     IF BTERM-LEN (2) GREATER THAN ZEROS
 10222        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10223     ELSE
 10224        MOVE ZEROS               TO PB-I-AH-TERM.
 10225
 10226     IF BLNTRML       GREATER THAN ZEROS
 10227         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10228        ELSE
 10229         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10230
 10231     IF BFREQL        GREATER THAN ZEROS
 10232         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10233        ELSE
 10234         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10235
 10236     IF BSKPCDL       GREATER THAN ZEROS
 10237         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10238
 10239     IF BMODEL        GREATER THAN ZEROS
 10240         MOVE BMODEI             TO PB-I-TERM-TYPE
 10241                                    PI-BMODE.
 10242
 10243     IF BPMTSL        GREATER THAN ZEROS
 10244         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10245                                    PI-BPMTS
 10246        ELSE
 10247         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10248                                    PI-BPMTS.
 10249
 10250     IF BPMTAMTL      GREATER THAN ZEROS
 10251         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10252        ELSE
 10253         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10254
 10255     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10256        IF BTYPE  (1)   NOT = ZEROS
 10257           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10258                                    PI-BTYPE (1)
 10259           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10260           MOVE SPACES           TO PB-I-LF-ABBR
 10261        ELSE
 10262           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10263                                    PB-I-LF-ABBR
 10264           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10265     ELSE
 10266        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10267                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 192
* EL6311.cbl
 10268        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10269
 10270     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10271         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10272     ELSE
 10273         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10274
 10275     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10276         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10277     ELSE
 10278         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10279
 10280     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10281         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10282            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10283            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10284         ELSE
 10285            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10286            MOVE '?'             TO PB-I-LF-CALC-FLAG
 10287     ELSE
 10288         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10289
 10290     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10291         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10292
 10293     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10294         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10295         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10296     ELSE
 10297         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10298
 10299     IF  BALT-PREM-LEN     (2) > ZEROS
 10300         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10301     ELSE
 10302         MOVE ZEROS            TO PB-I-TOT-FEES.
 10303
 10304     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10305        IF BTYPE      (2)   NOT = ZEROS
 10306           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10307                                  PI-BTYPE (2)
 10308           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10309           MOVE SPACES         TO PB-I-AH-ABBR
 10310        ELSE
 10311           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10312                                  PB-I-AH-ABBR
 10313           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10314     ELSE
 10315        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10316                                  PB-I-AH-ABBR
 10317        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10318
 10319     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10320         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10321     ELSE
 10322         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10323
 10324     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10325         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 193
* EL6311.cbl
 10326            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10327            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10328         ELSE
 10329            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10330            MOVE '?'             TO PB-I-AH-CALC-FLAG
 10331     ELSE
 10332         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10333
 10334     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10335         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10336
 10337     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10338        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10339     ELSE
 10340        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10341
 10342     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10343        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10344     ELSE
 10345        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10346
 10347     IF BINDGRPL  GREATER THAN ZEROS
 10348         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10349
 10350     IF BRTCLSL   GREATER THAN ZEROS
 10351         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10352
 10353     IF BSIGL     GREATER THAN ZEROS
 10354         MOVE BSIGI              TO PB-I-SIG-SW.
 10355     IF BAPRL > ZEROS
 10356         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10357     ELSE
 10358        if pi-company-id = 'CID'
 10359           move +99.9999         to pb-i-loan-apr
 10360        else
 10361           MOVE ZEROS            TO PB-I-LOAN-APR
 10362        end-if
 10363     end-if
 10364     IF BMEMBERL  GREATER THAN ZEROS
 10365         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10366
 10367     IF BLNOFCRL  GREATER THAN ZEROS
 10368         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10369
 10370     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10371        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10372     ELSE
 10373        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10374
 10375     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10376        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10377     ELSE
 10378        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10379
 10380     IF BDAYSL   GREATER THAN ZEROS
 10381        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10382                                    PB-I-EXTENTION-DAYS
 10383     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 194
* EL6311.cbl
 10384        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10385                                    PB-I-EXTENTION-DAYS.
 10386
 10387     IF BDAYSL GREATER THAN ZEROS
 10388        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10389
 10390     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10391        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10392           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10393
 10394     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10395        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10396           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10397
 10398     IF B1STPMTL GREATER THAN ZEROS
 10399        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10400
 10401     IF PB-EXT-DAYS-PROCESSING
 10402        IF PB-I-EXTENTION-DAYS = ZEROS
 10403           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10404
 10405     IF PB-EXPIRE-DT-PROCESSING
 10406        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10407           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10408             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10409
 10410     IF PB-1ST-PMT-DT-PROCESSING
 10411        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10412           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10413
 10414     IF BREINL GREATER THAN ZEROS
 10415        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10416
 10417     IF BENTRYL NOT = ZEROS
 10418        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10419        IF PI-COMPANY-ID = 'CID'
 10420           AND (PB-BATCH-ENTRY = 'P')
 10421           AND (PB-STATE = 'VA')
 10422           PERFORM 1500-UPDATE-ERNOTE
 10423                                 THRU 1500-EXIT
 10424        END-IF
 10425     END-IF
 10426     IF BUNWRITL NOT = ZEROS
 10427        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10428
 10429     IF BFORCEL NOT = ZEROS
 10430        MOVE BFORCEI             TO PB-FORCE-CODE.
 10431
 10432     IF BBILCDL NOT = ZEROS
 10433        MOVE BBILCDI             TO PB-RECORD-BILL.
 10434
 10435     IF BLIVESL GREATER THAN ZEROS
 10436        MOVE WS-BLIVES           TO PB-I-LIVES
 10437     ELSE
 10438        MOVE ZEROS               TO PB-I-LIVES.
 10439
 10440     IF BBILLEDL GREATER THAN ZEROS
 10441        MOVE WS-BILLED           TO PB-I-NUM-BILLED
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 195
* EL6311.cbl
 10442     ELSE
 10443        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10444
 10445*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10446
 10447 1260-WRITE-PB-RECORD.
 10448     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10449                                    PB-INPUT-BY.
 10450     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10451     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10452                                    PB-INPUT-DT.
 10453
 10454     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10455     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10456                                    PB-CONTROL-BY-ORIG-BATCH.
 10457
 10458
 10459     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10460     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10461     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10462     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10463     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10464
 10465     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10466
 10467     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10468
 10469     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10470     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10471     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10472
 10473     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10474     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10475
 10476 1275-WRITE-PENDING-BUSINESS.
 10477     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10478     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10479     MOVE 'A'                    TO JP-RECORD-TYPE.
 10480     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10481
 10482
 10483* EXEC CICS HANDLE CONDITION
 10484*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10485*    END-EXEC.
 10486*    MOVE '"$%                   ! $ #00010301' TO DFHEIV0
 10487     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10488     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10489     MOVE X'2420233030303130333031' TO DFHEIV0(25:11)
 10490     CALL 'kxdfhei1' USING DFHEIV0
 10491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10492
 10493
 10494
 10495* EXEC CICS WRITE
 10496*        DATASET (FILE-ID-ERPNDB)
 10497*        FROM    (PENDING-BUSINESS)
 10498*        RIDFLD  (PB-CONTROL-PRIMARY)
 10499*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 196
* EL6311.cbl
 10500     MOVE LENGTH OF
 10501      PENDING-BUSINESS
 10502       TO DFHEIV11
 10503*    MOVE '&$ L                  ''   #00010305' TO DFHEIV0
 10504     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10505     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10506     MOVE X'2020233030303130333035' TO DFHEIV0(25:11)
 10507     CALL 'kxdfhei1' USING DFHEIV0,
 10508           FILE-ID-ERPNDB,
 10509           PENDING-BUSINESS,
 10510           DFHEIV11,
 10511           PB-CONTROL-PRIMARY,
 10512           DFHEIV99,
 10513           DFHEIV99
 10514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10515
 10516
 10517     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10518
 10519     PERFORM 8400-LOG-JOURNAL-RECORD.
 10520
 10521******************************************************************
 10522*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10523******************************************************************
 10524     display ' made it to add orig cert '
 10525     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10526     MOVE ' '                    TO WS-ERMAIL-SW
 10527
 10528* EXEC CICS READ
 10529*       DATASET   (FILE-ID-ERMAIL)
 10530*       SET       (ADDRESS OF MAILING-DATA)
 10531*       RIDFLD    (ERMAIL-KEY)
 10532*       RESP      (WS-RESPONSE)
 10533*    END-EXEC
 10534*    MOVE '&"S        E          (  N#00010321' TO DFHEIV0
 10535     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10536     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10537     MOVE X'204E233030303130333231' TO DFHEIV0(25:11)
 10538     CALL 'kxdfhei1' USING DFHEIV0,
 10539           FILE-ID-ERMAIL,
 10540           DFHEIV20,
 10541           DFHEIV99,
 10542           ERMAIL-KEY,
 10543           DFHEIV99,
 10544           DFHEIV99,
 10545           DFHEIV99
 10546     SET ADDRESS OF MAILING-DATA TO
 10547         DFHEIV20
 10548     MOVE EIBRESP  TO WS-RESPONSE
 10549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10550     IF RESP-NORMAL
 10551        SET ERMAIL-FOUND TO TRUE
 10552     END-IF
 10553
 10554     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 10555     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10556     MOVE 'OC'                   TO OC-RECORD-ID
 10557     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 197
* EL6311.cbl
 10558                                 TO OC-CONTROL-PRIMARY (1:33)
 10559     MOVE 'I'                    TO OC-RECORD-TYPE
 10560     MOVE +4096                  TO OC-KEY-SEQ-NO
 10561     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10562     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10563     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10564     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10565     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10566     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10567     MOVE PB-I-AGE               TO OC-INS-AGE
 10568     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10569     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10570     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10571     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10572     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10573     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10574     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10575     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10576     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10577     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10578     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10579     IF PB-I-JOINT-COMMISSION > +0
 10580         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10581     ELSE
 10582         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10583     END-IF
 10584     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10585     MOVE +0                     TO OC-LF-CANCEL-AMT
 10586                                    OC-LF-ITD-CANCEL-AMT
 10587     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10588     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10589     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10590     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10591     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10592     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10593     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10594     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10595     MOVE +0                     TO OC-AH-CANCEL-AMT
 10596                                    OC-AH-ITD-CANCEL-AMT
 10597     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10598     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10599     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10600     IF ERMAIL-FOUND
 10601        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10602     END-IF
 10603     IF NOT CERT-TRL-REC-NOT-FOUND
 10604        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10605                           OC-INS-AGE-DEFAULT-FLAG
 10606        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10607                           OC-JNT-AGE-DEFAULT-FLAG
 10608     END-IF
 10609     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10610     .
 10611 1275-WRITE-ELCRTO.
 10612
 10613* EXEC CICS WRITE
 10614*       DATASET   ('ELCRTO')
 10615*       FROM      (ORIGINAL-CERTIFICATE)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 198
* EL6311.cbl
 10616*       RIDFLD    (OC-CONTROL-PRIMARY)
 10617*       RESP      (WS-RESPONSE)
 10618*    END-EXEC
 10619     MOVE LENGTH OF
 10620      ORIGINAL-CERTIFICATE
 10621       TO DFHEIV11
 10622     MOVE 'ELCRTO' TO DFHEIV1
 10623*    MOVE '&$ L                  ''  N#00010389' TO DFHEIV0
 10624     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10625     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10626     MOVE X'204E233030303130333839' TO DFHEIV0(25:11)
 10627     CALL 'kxdfhei1' USING DFHEIV0,
 10628           DFHEIV1,
 10629           ORIGINAL-CERTIFICATE,
 10630           DFHEIV11,
 10631           OC-CONTROL-PRIMARY,
 10632           DFHEIV99,
 10633           DFHEIV99
 10634     MOVE EIBRESP  TO WS-RESPONSE
 10635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10636     display ' just wrote 1275 ' ws-response
 10637     IF RESP-DUPKEY
 10638        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10639        GO TO 1275-WRITE-ELCRTO
 10640     ELSE
 10641        IF NOT RESP-NORMAL
 10642           MOVE -1               TO BMAINTL
 10643           MOVE ER-7450          TO EMI-ERROR
 10644           PERFORM 9900-ERROR-FORMAT
 10645                                 THRU 9900-EXIT
 10646           GO TO 8200-SEND-DATAONLY
 10647        END-IF
 10648     END-IF
 10649******************************************************************
 10650*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10651******************************************************************
 10652
 10653
 10654* EXEC CICS READ
 10655*        INTO    (PENDING-BUSINESS)
 10656*        DATASET (FILE-ID-ERPNDB)
 10657*        RIDFLD  (ERPNDB-KEY)
 10658*        UPDATE
 10659*    END-EXEC.
 10660     MOVE LENGTH OF
 10661      PENDING-BUSINESS
 10662       TO DFHEIV11
 10663*    MOVE '&"IL       EU         (   #00010412' TO DFHEIV0
 10664     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10665     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10666     MOVE X'2020233030303130343132' TO DFHEIV0(25:11)
 10667     CALL 'kxdfhei1' USING DFHEIV0,
 10668           FILE-ID-ERPNDB,
 10669           PENDING-BUSINESS,
 10670           DFHEIV11,
 10671           ERPNDB-KEY,
 10672           DFHEIV99,
 10673           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 199
* EL6311.cbl
 10674           DFHEIV99
 10675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10676
 10677
 10678     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10679     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10680     MOVE 'B'                    TO JP-RECORD-TYPE.
 10681     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10682
 10683     PERFORM 8400-LOG-JOURNAL-RECORD.
 10684
 10685     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10686
 10687
 10688* EXEC CICS REWRITE
 10689*        DATASET (FILE-ID-ERPNDB)
 10690*        FROM    (PENDING-BUSINESS)
 10691*    END-EXEC.
 10692     MOVE LENGTH OF
 10693      PENDING-BUSINESS
 10694       TO DFHEIV11
 10695*    MOVE '&& L                  %   #00010428' TO DFHEIV0
 10696     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10697     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10698     MOVE X'2020233030303130343238' TO DFHEIV0(25:11)
 10699     CALL 'kxdfhei1' USING DFHEIV0,
 10700           FILE-ID-ERPNDB,
 10701           PENDING-BUSINESS,
 10702           DFHEIV11,
 10703           DFHEIV99
 10704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10705
 10706
 10707     MOVE 'C'                    TO JP-RECORD-TYPE.
 10708     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10709
 10710     PERFORM 8400-LOG-JOURNAL-RECORD.
 10711
 10712     IF WS-ERRORS-PRESENT
 10713         GO TO 3900-RE-DISPLAY-RECORD.
 10714
 10715     MOVE ZEROS                  TO EMI-ERROR.
 10716     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10717     MOVE LOW-VALUES             TO EL631BI.
 10718     MOVE  -1                    TO BMAINTL.
 10719     GO TO 8100-SEND-INITIAL-MAP.
 10720
 10721 1280-BATCH-HDR-NOT-FOUND.
 10722     MOVE -1                     TO BMAINTL.
 10723     MOVE ER-7450                TO EMI-ERROR.
 10724     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10725     GO TO 8200-SEND-DATAONLY.
 10726
 10727 1290-DUPLICATE-ALT-INDEX.
 10728
 10729******************************************************************
 10730*                                                                *
 10731*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 200
* EL6311.cbl
 10732*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10733*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10734*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10735*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10736*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10737*                                                                *
 10738******************************************************************
 10739
 10740     IF LCP-ONCTR-01 =  0
 10741         ADD 1 TO LCP-ONCTR-01
 10742        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10743
 10744     ADD +1                      TO WS-SEQ-NO-COUNTER.
 10745
 10746     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10747         NEXT SENTENCE
 10748     ELSE
 10749         ADD +1 TO PB-BATCH-SEQ-NO
 10750                   PB-CSR-BATCH-SEQ-NO
 10751         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10752         GO TO 1275-WRITE-PENDING-BUSINESS.
 10753
 10754     MOVE -1                     TO BCERTNOL.
 10755     MOVE AL-UABON               TO BCERTNOA.
 10756     MOVE AL-UNBON               TO BEFFDTA.
 10757
 10758     MOVE 1                      TO EMI-SUB
 10759                                    EMI-SWITCH1
 10760                                    EMI-SWITCH-AREA-1
 10761                                    EMI-SWITCH-AREA-2.
 10762
 10763     MOVE SPACES                 TO EMI-ERROR-LINES.
 10764
 10765
 10766* EXEC CICS SYNCPOINT ROLLBACK
 10767*    END-EXEC.
 10768*    MOVE '6"R                   !   #00010491' TO DFHEIV0
 10769     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10770     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10771     MOVE X'2020233030303130343931' TO DFHEIV0(25:11)
 10772     CALL 'kxdfhei1' USING DFHEIV0
 10773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10774
 10775
 10776     MOVE ER-2247                TO EMI-ERROR.
 10777     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10778     GO TO 8200-SEND-DATAONLY.
 10779
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 201
* EL6311.cbl
 10781
 10782
 10783 1295-READ-CERT-TRAILER.
 10784
 10785
 10786* EXEC CICS GETMAIN
 10787*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 10788*        LENGTH  (ELCRTT-RECORD-LENGTH)
 10789*        INITIMG (GETMAIN-SPACE)
 10790*    END-EXEC
 10791*    MOVE ',"IL                  $   #00010503' TO DFHEIV0
 10792     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10793     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10794     MOVE X'2020233030303130353033' TO DFHEIV0(25:11)
 10795     CALL 'kxdfhei1' USING DFHEIV0,
 10796           DFHEIV20,
 10797           ELCRTT-RECORD-LENGTH,
 10798           GETMAIN-SPACE
 10799     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 10800         DFHEIV20
 10801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10802
 10803     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 10804     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 10805     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 10806
 10807
 10808* EXEC CICS HANDLE CONDITION
 10809*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 10810*    END-EXEC.
 10811*    MOVE '"$I                   ! % #00010513' TO DFHEIV0
 10812     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10813     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10814     MOVE X'2520233030303130353133' TO DFHEIV0(25:11)
 10815     CALL 'kxdfhei1' USING DFHEIV0
 10816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10817
 10818
 10819
 10820* EXEC CICS READ
 10821*        DATASET  (CRTT-ID)
 10822*        RIDFLD   (ELCRTT-KEY)
 10823*        INTO     (CERTIFICATE-TRAILERS)
 10824*    END-EXEC.
 10825     MOVE LENGTH OF
 10826      CERTIFICATE-TRAILERS
 10827       TO DFHEIV11
 10828*    MOVE '&"IL       E          (   #00010517' TO DFHEIV0
 10829     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10830     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10831     MOVE X'2020233030303130353137' TO DFHEIV0(25:11)
 10832     CALL 'kxdfhei1' USING DFHEIV0,
 10833           CRTT-ID,
 10834           CERTIFICATE-TRAILERS,
 10835           DFHEIV11,
 10836           ELCRTT-KEY,
 10837           DFHEIV99,
 10838           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 202
* EL6311.cbl
 10839           DFHEIV99
 10840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10841
 10842
 10843     GO TO 1295-EXIT.
 10844
 10845 1295-CERT-TRL-REC-NOTFND.
 10846     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 10847
 10848 1295-EXIT.
 10849     EXIT.
 10850
 10851******************************************************************
 10852*                                                                *
 10853*          C H A N G E   I S S U E   R O U T I N E               *
 10854*                                                                *
 10855******************************************************************
 10856
 10857***************************************************************
 10858*                                                             *
 10859*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 10860*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10861*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 10862*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 10863*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 10864*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 10865*     5. LINK TO THE EDIT ROUTINE.                            *
 10866*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10867*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 10868*              THE EDIT ROUTINE.                              *
 10869*     7. REWRITE THE NEW ISSUE                                *
 10870*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10871*                                                             *
 10872***************************************************************
 10873
 10874 1300-CHANGE-ISSUE-ROUTINE.
 10875     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 10876
 10877     IF BCHGL NOT = ZEROS
 10878        MOVE ER-2196             TO EMI-ERROR
 10879        MOVE AL-UABON            TO BMAINTA
 10880        MOVE -1                  TO BMAINTL
 10881        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10882        GO TO 8200-SEND-DATAONLY.
 10883
 10884     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10885
 10886     IF BSUFIXL NOT = ZEROS
 10887        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10888     ELSE
 10889        MOVE SPACE               TO WS-NEW-SUFFIX.
 10890
 10891     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10892     PERFORM 8600-DEEDIT.
 10893     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10894     MOVE '4'                    TO DC-OPTION-CODE.
 10895     PERFORM 9700-DATE-LINK.
 10896     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 203
* EL6311.cbl
 10897        MOVE ER-0348             TO EMI-ERROR
 10898        MOVE -1                  TO BEFFDTL
 10899        MOVE AL-UABON            TO BEFFDTA
 10900        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10901        GO TO 8200-SEND-DATAONLY
 10902     ELSE
 10903        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10904        MOVE AL-UANON            TO BEFFDTA
 10905        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10906
 10907 1325-PROCESS-ISSUE-CHANGES.
 10908
 10909* EXEC CICS HANDLE CONDITION
 10910*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 10911*    END-EXEC.
 10912*    MOVE '"$I                   ! & #00010588' TO DFHEIV0
 10913     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10914     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10915     MOVE X'2620233030303130353838' TO DFHEIV0(25:11)
 10916     CALL 'kxdfhei1' USING DFHEIV0
 10917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10918
 10919
 10920     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10921     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 10922     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 10923
 10924
 10925* EXEC CICS GETMAIN
 10926*        SET      (ADDRESS OF PENDING-BUSINESS)
 10927*        LENGTH   (ERPNDB-RECORD-LENGTH)
 10928*        INITIMG  (GETMAIN-SPACE)
 10929*     END-EXEC.
 10930*    MOVE ',"IL                  $   #00010596' TO DFHEIV0
 10931     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10932     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10933     MOVE X'2020233030303130353936' TO DFHEIV0(25:11)
 10934     CALL 'kxdfhei1' USING DFHEIV0,
 10935           DFHEIV20,
 10936           ERPNDB-RECORD-LENGTH,
 10937           GETMAIN-SPACE
 10938     SET ADDRESS OF PENDING-BUSINESS TO
 10939         DFHEIV20
 10940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10941
 10942
 10943
 10944* EXEC CICS READ
 10945*        INTO    (PENDING-BUSINESS)
 10946*        DATASET (FILE-ID-ERPNDB)
 10947*        RIDFLD  (ERPNDB-KEY)
 10948*    END-EXEC.
 10949     MOVE LENGTH OF
 10950      PENDING-BUSINESS
 10951       TO DFHEIV11
 10952*    MOVE '&"IL       E          (   #00010602' TO DFHEIV0
 10953     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10954     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 204
* EL6311.cbl
 10955     MOVE X'2020233030303130363032' TO DFHEIV0(25:11)
 10956     CALL 'kxdfhei1' USING DFHEIV0,
 10957           FILE-ID-ERPNDB,
 10958           PENDING-BUSINESS,
 10959           DFHEIV11,
 10960           ERPNDB-KEY,
 10961           DFHEIV99,
 10962           DFHEIV99,
 10963           DFHEIV99
 10964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10965
 10966
 10967     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10968
 10969
 10970* EXEC CICS HANDLE CONDITION
 10971*         NOTFND     (1385-REC-NOT-FOUND)
 10972*    END-EXEC.
 10973*    MOVE '"$I                   ! '' #00010610' TO DFHEIV0
 10974     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10975     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10976     MOVE X'2720233030303130363130' TO DFHEIV0(25:11)
 10977     CALL 'kxdfhei1' USING DFHEIV0
 10978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10979
 10980
 10981**********************************************************
 10982*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 10983*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 10984**********************************************************
 10985
 10986
 10987* EXEC CICS READ
 10988*        DATASET (FILE-ID-ERPNDB)
 10989*        INTO    (PENDING-BUSINESS)
 10990*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10991*    END-EXEC.
 10992     MOVE LENGTH OF
 10993      PENDING-BUSINESS
 10994       TO DFHEIV11
 10995*    MOVE '&"IL       E          (   #00010619' TO DFHEIV0
 10996     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10997     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10998     MOVE X'2020233030303130363139' TO DFHEIV0(25:11)
 10999     CALL 'kxdfhei1' USING DFHEIV0,
 11000           FILE-ID-ERPNDB,
 11001           PENDING-BUSINESS,
 11002           DFHEIV11,
 11003           PI-PREV-CONTROL-PRIMARY,
 11004           DFHEIV99,
 11005           DFHEIV99,
 11006           DFHEIV99
 11007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11008
 11009
 11010********** DO NOT ALLOW CHANGES IF THRU A/R
 11011     IF BMAINTI = 'C'
 11012         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 205
* EL6311.cbl
 11013             MOVE ER-4005          TO EMI-ERROR
 11014             MOVE -1               TO BMAINTL
 11015             MOVE AL-UABON         TO BMAINTA
 11016             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11017             GO TO 8200-SEND-DATAONLY.
 11018**********
 11019
 11020     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11021        MOVE -1                 TO BMAINTL
 11022        MOVE ER-2197            TO EMI-ERROR
 11023        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11024        GO TO 8200-SEND-DATAONLY.
 11025
 11026     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11027        MOVE ER-2196             TO EMI-ERROR
 11028        MOVE AL-UABON            TO BMAINTA
 11029        MOVE -1                  TO BMAINTL
 11030        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11031        GO TO 8200-SEND-DATAONLY.
 11032
 11033     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11034
 11035     IF PB-BILLED-DT = LOW-VALUES AND
 11036        PB-CHG-COUNT = ZEROS
 11037        NEXT SENTENCE
 11038     ELSE
 11039        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11040            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11041           OR
 11042           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11043            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11044           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11045
 11046
 11047* EXEC CICS READ
 11048*        DATASET (FILE-ID-ERPNDB)
 11049*        INTO    (PENDING-BUSINESS)
 11050*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11051*        UPDATE
 11052*    END-EXEC.
 11053     MOVE LENGTH OF
 11054      PENDING-BUSINESS
 11055       TO DFHEIV11
 11056*    MOVE '&"IL       EU         (   #00010661' TO DFHEIV0
 11057     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11058     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11059     MOVE X'2020233030303130363631' TO DFHEIV0(25:11)
 11060     CALL 'kxdfhei1' USING DFHEIV0,
 11061           FILE-ID-ERPNDB,
 11062           PENDING-BUSINESS,
 11063           DFHEIV11,
 11064           PI-PREV-CONTROL-PRIMARY,
 11065           DFHEIV99,
 11066           DFHEIV99,
 11067           DFHEIV99
 11068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11069
 11070
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 206
* EL6311.cbl
 11071     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11072     MOVE 'B'                    TO JP-RECORD-TYPE
 11073     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11074     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11075
 11076     PERFORM 8400-LOG-JOURNAL-RECORD.
 11077
 11078     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11079        PB-CHG-COUNT NOT = ZEROS
 11080        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11081            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11082           OR
 11083           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11084            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11085            MOVE LOW-VALUES             TO PB-BILLED-DT
 11086            ADD +1                      TO PB-CHG-COUNT.
 11087
 11088     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11089     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11090     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11091     MOVE '5'                    TO DC-OPTION-CODE.
 11092     PERFORM 9700-DATE-LINK
 11093     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11094
 11095*    IF BMICRNOL  GREATER  ZEROS
 11096*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11097
 11098     IF BVINL > ZEROS
 11099        MOVE BVINI               TO PB-I-VIN
 11100     END-IF
 11101     IF (BFORCEL NOT = ZEROS)
 11102        AND (PB-COMPANY-ID = 'DCC')
 11103        AND (BFORCEI = ' ')
 11104        AND (PB-FORCE-CODE = 'O')
 11105        COMPUTE PB-I-AH-PREMIUM-AMT =
 11106           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11107        PERFORM 1800-REMOVE-CERT-NOTES
 11108                                 THRU 1800-EXIT
 11109        PERFORM 1900-DELETE-ERPYAJ
 11110                                 THRU 1900-EXIT
 11111        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11112     END-IF
 11113     IF (BFORCEL NOT = ZEROS)
 11114        AND (PB-COMPANY-ID = 'DCC')
 11115        AND (BFORCEI = 'O')
 11116        AND (PB-FORCE-CODE NOT = 'O')
 11117        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11118           PB-I-AH-PREM-CALC
 11119        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11120        MOVE SPACE               TO DC-OPTION-CODE
 11121        PERFORM 9700-DATE-LINK
 11122        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11123        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11124        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11125        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11126        PERFORM 1500-UPDATE-ERNOTE
 11127                                 THRU 1500-EXIT
 11128        PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 207
* EL6311.cbl
 11129                                 THRU 1600-EXIT
 11130     END-IF
 11131     IF BLSTNML  GREATER THAN ZEROS
 11132         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11133
 11134     IF B1STNML  GREATER THAN ZEROS
 11135         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11136
 11137     IF BINITL   GREATER THAN ZEROS
 11138         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11139
 11140     IF BBIRTHL  GREATER THAN ZERO
 11141         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11142
 11143     IF B1STPMTL GREATER THAN ZERO
 11144         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11145
 11146     IF BAGEL    GREATER THAN ZEROS
 11147         MOVE BAGEI              TO PB-I-AGE.
 11148
 11149     MOVE 'N'                    TO WS-INS-AGE-SET
 11150                                    WS-JNT-AGE-SET.
 11151     IF BAGEL    GREATER THAN ZEROS
 11152        MOVE 'Y'                TO WS-INS-AGE-SET
 11153        IF BAGEI = ZERO AND
 11154             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11155           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11156           MOVE 'AGE*'          TO BAGEDEFO
 11157        ELSE
 11158           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11159           MOVE 'AGE '          TO BAGEDEFO
 11160        END-IF
 11161        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11162     END-IF.
 11163
 11164     IF BSEXL    GREATER THAN ZEROS
 11165         MOVE BSEXI              TO PB-I-INSURED-SEX.
 11166
 11167     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11168        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11169
 11170     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11171        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11172
 11173     IF BLNTRML  GREATER THAN ZEROS
 11174         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11175
 11176     IF BFREQL   GREATER THAN ZEROS
 11177         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11178
 11179     IF BSKPCDL  GREATER THAN ZEROS
 11180         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11181
 11182     IF BMODEL   GREATER THAN ZEROS
 11183         MOVE BMODEI             TO PB-I-TERM-TYPE
 11184                                    PI-BMODE.
 11185
 11186     IF BPMTSL   GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 208
* EL6311.cbl
 11187         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11188                                    PI-BPMTS.
 11189
 11190     IF BPMTAMTL GREATER THAN ZEROS
 11191         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11192
 11193     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11194         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11195
 11196     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11197         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11198
 11199     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11200
 11201     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11202         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11203            SUBTRACT PB-I-LF-PREMIUM-AMT
 11204                     FROM WS-B-LF-ISS-PRM-ENTERED
 11205            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11206            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11207            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11208         ELSE
 11209            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11210            MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11211
 11212     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11213            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11214                     FROM WS-B-LF-ISS-PRM-ENTERED
 11215         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11216         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11217
 11218     IF  BALT-PREM-LEN     (2)  > ZEROS
 11219         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11220
 11221     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11222         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11223
 11224     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11225         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11226            SUBTRACT PB-I-AH-PREMIUM-AMT
 11227                     FROM WS-B-AH-ISS-PRM-ENTERED
 11228            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11229            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11230            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11231         ELSE
 11232            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11233            MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11234
 11235     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11236        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11237
 11238     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11239        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11240
 11241     IF BINDGRPL            GREATER THAN ZEROS
 11242         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11243
 11244     IF BRTCLSL             GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 209
* EL6311.cbl
 11245         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11246
 11247     IF BSIGL               GREATER THAN ZEROS
 11248         MOVE BSIGI              TO PB-I-SIG-SW.
 11249
 11250     IF BAPRL               GREATER THAN ZEROS
 11251         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11252
 11253     IF BMEMBERL            GREATER THAN ZEROS
 11254         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11255
 11256     IF BLNOFCRL            GREATER THAN ZEROS
 11257         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11258
 11259     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11260        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11261
 11262     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11263        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11264
 11265     IF BDAYSL              GREATER THAN ZEROS
 11266        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11267                                    PB-I-EXTENTION-DAYS.
 11268
 11269     IF BDAYSL GREATER THAN ZEROS
 11270        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11271
 11272     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11273        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11274           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11275
 11276     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11277        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11278           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11279
 11280     IF B1STPMTL GREATER THAN ZEROS
 11281        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11282
 11283     IF PB-EXT-DAYS-PROCESSING
 11284        IF PB-I-EXTENTION-DAYS = ZEROS
 11285           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11286
 11287     IF PB-EXPIRE-DT-PROCESSING
 11288        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11289           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11290             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11291
 11292     IF PB-1ST-PMT-DT-PROCESSING
 11293        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11294           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11295
 11296     IF BREINL GREATER THAN ZEROS
 11297        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11298
 11299     IF BFORCEL NOT = ZEROS
 11300        MOVE BFORCEI             TO PB-FORCE-CODE.
 11301     IF (BENTRYL NOT = ZEROS)
 11302        AND (PB-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 210
* EL6311.cbl
 11303        AND (PB-STATE = 'VA')
 11304        AND (BENTRYI NOT = 'P')
 11305        AND (PB-BATCH-ENTRY = 'P')
 11306        PERFORM 1800-REMOVE-CERT-NOTES
 11307                                 THRU 1800-EXIT
 11308     END-IF
 11309     IF BENTRYL NOT = ZEROS
 11310        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11311        IF PI-COMPANY-ID = 'CID'
 11312           AND (PB-BATCH-ENTRY = 'P')
 11313           AND (PB-STATE = 'VA')
 11314           PERFORM 1500-UPDATE-ERNOTE
 11315                                 THRU 1500-EXIT
 11316        END-IF
 11317     END-IF
 11318
 11319     IF BUNWRITL NOT = ZEROS
 11320        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11321
 11322     IF BBILCDL NOT = ZEROS
 11323        MOVE BBILCDI             TO PB-RECORD-BILL.
 11324
 11325     IF BLIVESL GREATER THAN ZEROS
 11326        MOVE WS-BLIVES           TO PB-I-LIVES.
 11327
 11328
 11329*DMD CUSTOM CODING*************START
 11330     IF PI-COMPANY-ID NOT = 'DMD'
 11331         MOVE ZEROS               TO BBILLEDL.
 11332*DMD CUSTOM CODING*************END
 11333
 11334     IF BBILLEDL GREATER THAN ZEROS
 11335        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11336
 11337
 11338*****************************************************************
 11339*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11340*****************************************************************
 11341
 11342     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11343        IF BTYPE  (1)   = ZEROS OR SPACES
 11344           IF REMOVE-LF-COVERAGE
 11345               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11346                                        PI-BTYPE (1)
 11347               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11348                                        WS-B-LF-ISS-PRM-ENTERED
 11349               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11350                                        WS-B-LF-ISS-PRM-ENTERED
 11351               SUBTRACT PB-I-LF-PREM-CALC FROM
 11352                                        WS-B-LF-ISS-PRM-COMPUTED
 11353               MOVE ZEROS            TO PB-I-LF-TERM
 11354                                        PB-I-LF-BENEFIT-AMT
 11355                                        PB-I-LF-PREMIUM-AMT
 11356                                        PB-I-LF-BENEFIT-CD
 11357                                        PB-I-LF-PREM-CALC
 11358                                        PB-I-LF-CRIT-PER
 11359                                        PB-I-LF-ALT-BENEFIT-AMT
 11360                                        PB-I-LF-ALT-PREMIUM-AMT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 211
* EL6311.cbl
 11361               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11362           ELSE
 11363               NEXT SENTENCE
 11364        ELSE
 11365           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11366                                    PI-BTYPE (1).
 11367     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11368        IF BTYPE  (2)   = ZEROS OR SPACES
 11369           IF  REMOVE-AH-COVERAGE
 11370               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11371                                        PI-BTYPE (2)
 11372               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11373                                        WS-B-AH-ISS-PRM-ENTERED
 11374               SUBTRACT PB-I-AH-PREM-CALC FROM
 11375                                        WS-B-AH-ISS-PRM-COMPUTED
 11376               MOVE ZEROS            TO PB-I-AH-TERM
 11377                                        PB-I-AH-BENEFIT-AMT
 11378                                        PB-I-AH-PREMIUM-AMT
 11379                                        PB-I-AH-BENEFIT-CD
 11380                                        PB-I-AH-PREM-CALC
 11381                                        PB-I-AH-CRIT-PER
 11382               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11383           ELSE
 11384               NEXT SENTENCE
 11385        ELSE
 11386           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11387                                    PI-BTYPE (2).
 11388 1360-REWRITE-PB-RECORD.
 11389     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11390
 11391     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11392     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11393
 11394     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11395
 11396     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11397     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11398
 11399     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11400         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11401
 11402     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11403         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11404
 11405     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11406
 11407     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11408
 11409     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11410
 11411     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11412     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11413     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11414
 11415     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11416     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11417
 11418 1375-REWRITE-PB-RECORD.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 212
* EL6311.cbl
 11419     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11420     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11421     MOVE 'C'                    TO JP-RECORD-TYPE.
 11422     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11423
 11424
 11425* EXEC CICS REWRITE
 11426*        DATASET (FILE-ID-ERPNDB)
 11427*        FROM    (PENDING-BUSINESS)
 11428*    END-EXEC.
 11429     MOVE LENGTH OF
 11430      PENDING-BUSINESS
 11431       TO DFHEIV11
 11432*    MOVE '&& L                  %   #00011021' TO DFHEIV0
 11433     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11434     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11435     MOVE X'2020233030303131303231' TO DFHEIV0(25:11)
 11436     CALL 'kxdfhei1' USING DFHEIV0,
 11437           FILE-ID-ERPNDB,
 11438           PENDING-BUSINESS,
 11439           DFHEIV11,
 11440           DFHEIV99
 11441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11442
 11443
 11444     PERFORM 8400-LOG-JOURNAL-RECORD.
 11445******************************************************************
 11446*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11447******************************************************************
 11448     display ' made it to update orig cert '
 11449     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11450     MOVE ' '                    TO WS-ERMAIL-SW
 11451
 11452* EXEC CICS READ
 11453*       DATASET   (FILE-ID-ERMAIL)
 11454*       SET       (ADDRESS OF MAILING-DATA)
 11455*       RIDFLD    (ERMAIL-KEY)
 11456*       RESP      (WS-RESPONSE)
 11457*    END-EXEC
 11458*    MOVE '&"S        E          (  N#00011033' TO DFHEIV0
 11459     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11460     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11461     MOVE X'204E233030303131303333' TO DFHEIV0(25:11)
 11462     CALL 'kxdfhei1' USING DFHEIV0,
 11463           FILE-ID-ERMAIL,
 11464           DFHEIV20,
 11465           DFHEIV99,
 11466           ERMAIL-KEY,
 11467           DFHEIV99,
 11468           DFHEIV99,
 11469           DFHEIV99
 11470     SET ADDRESS OF MAILING-DATA TO
 11471         DFHEIV20
 11472     MOVE EIBRESP  TO WS-RESPONSE
 11473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11474     IF RESP-NORMAL
 11475        SET ERMAIL-FOUND TO TRUE
 11476     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 213
* EL6311.cbl
 11477
 11478     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11479     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11480                                 TO ELCRTO-KEY
 11481     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11482     MOVE +0                     TO ELCRTO-SEQ-NO
 11483
 11484* EXEC CICS READ
 11485*       DATASET   ('ELCRTO')
 11486*       INTO      (ORIGINAL-CERTIFICATE)
 11487*       RIDFLD    (ELCRTO-KEY)
 11488*       GTEQ
 11489*       RESP      (WS-RESPONSE)
 11490*    END-EXEC
 11491     MOVE LENGTH OF
 11492      ORIGINAL-CERTIFICATE
 11493       TO DFHEIV11
 11494     MOVE 'ELCRTO' TO DFHEIV1
 11495*    MOVE '&"IL       G          (  N#00011048' TO DFHEIV0
 11496     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11497     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11498     MOVE X'204E233030303131303438' TO DFHEIV0(25:11)
 11499     CALL 'kxdfhei1' USING DFHEIV0,
 11500           DFHEIV1,
 11501           ORIGINAL-CERTIFICATE,
 11502           DFHEIV11,
 11503           ELCRTO-KEY,
 11504           DFHEIV99,
 11505           DFHEIV99,
 11506           DFHEIV99
 11507     MOVE EIBRESP  TO WS-RESPONSE
 11508     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11509     display ' just read gteq ' ws-response
 11510     IF RESP-NORMAL
 11511        AND (OC-CONTROL-PRIMARY (1:33) =
 11512                 PB-CONTROL-BY-ACCOUNT (1:33))
 11513        AND (OC-RECORD-TYPE = 'I')
 11514        display ' resp norm, key =, type i '
 11515        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11516           display ' end proc blank '
 11517           display ' csr edit session ' PI-CSR-SESSION-SW
 11518           IF NOT CSR-EDIT-SESSION
 11519
 11520* EXEC CICS READ
 11521*                DATASET   ('ELCRTO')
 11522*                INTO      (ORIGINAL-CERTIFICATE)
 11523*                RIDFLD    (OC-CONTROL-PRIMARY)
 11524*                UPDATE
 11525*                RESP      (WS-RESPONSE)
 11526*             END-EXEC
 11527     MOVE LENGTH OF
 11528      ORIGINAL-CERTIFICATE
 11529       TO DFHEIV11
 11530     MOVE 'ELCRTO' TO DFHEIV1
 11531*    MOVE '&"IL       EU         (  N#00011065' TO DFHEIV0
 11532     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11533     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11534     MOVE X'204E233030303131303635' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 214
* EL6311.cbl
 11535     CALL 'kxdfhei1' USING DFHEIV0,
 11536           DFHEIV1,
 11537           ORIGINAL-CERTIFICATE,
 11538           DFHEIV11,
 11539           OC-CONTROL-PRIMARY,
 11540           DFHEIV99,
 11541           DFHEIV99,
 11542           DFHEIV99
 11543     MOVE EIBRESP  TO WS-RESPONSE
 11544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11545              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11546              IF RESP-NORMAL
 11547                 display ' good read upd '
 11548                 MOVE PB-I-INSURED-LAST-NAME TO
 11549                         OC-INS-LAST-NAME
 11550                 MOVE PB-I-INSURED-FIRST-NAME TO
 11551                         OC-INS-FIRST-NAME
 11552                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11553                         OC-INS-MIDDLE-INIT
 11554                 MOVE PB-I-AGE         TO OC-INS-AGE
 11555                 MOVE PB-I-JOINT-LAST-NAME   TO
 11556                         OC-JNT-LAST-NAME
 11557                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11558                         OC-JNT-FIRST-NAME
 11559                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11560                         OC-JNT-MIDDLE-INIT
 11561                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11562                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11563                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11564                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11565                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11566                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11567                         OC-LF-ALT-BEN-AMT
 11568                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11569                         OC-LF-ALT-PRM-AMT
 11570                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11571                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11572                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11573                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11574                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11575                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11576                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11577                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11578                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11579                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11580                 IF OC-CANCEL-TRAN-IND = 'N'
 11581                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 11582                    MOVE +0            TO OC-LF-CANCEL-AMT
 11583                                          OC-LF-ITD-CANCEL-AMT
 11584                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 11585                    MOVE +0            TO OC-AH-CANCEL-AMT
 11586                                          OC-AH-ITD-CANCEL-AMT
 11587                 END-IF
 11588                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11589                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11590                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11591                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11592                 IF ERMAIL-FOUND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 215
* EL6311.cbl
 11593                    MOVE MA-CRED-BENE-NAME
 11594                                 TO OC-CRED-BENE-NAME
 11595                 END-IF
 11596                 IF NOT CERT-TRL-REC-NOT-FOUND
 11597                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11598                           OC-INS-AGE-DEFAULT-FLAG
 11599                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11600                           OC-JNT-AGE-DEFAULT-FLAG
 11601                 END-IF
 11602
 11603* EXEC CICS REWRITE
 11604*                   DATASET   ('ELCRTO')
 11605*                   FROM      (ORIGINAL-CERTIFICATE)
 11606*                   RESP      (WS-RESPONSE)
 11607*                END-EXEC
 11608     MOVE LENGTH OF
 11609      ORIGINAL-CERTIFICATE
 11610       TO DFHEIV11
 11611     MOVE 'ELCRTO' TO DFHEIV1
 11612*    MOVE '&& L                  %  N#00011129' TO DFHEIV0
 11613     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11614     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11615     MOVE X'204E233030303131313239' TO DFHEIV0(25:11)
 11616     CALL 'kxdfhei1' USING DFHEIV0,
 11617           DFHEIV1,
 11618           ORIGINAL-CERTIFICATE,
 11619           DFHEIV11,
 11620           DFHEIV99
 11621     MOVE EIBRESP  TO WS-RESPONSE
 11622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11623                 display ' just rewrote ' ws-response
 11624              END-IF
 11625           END-IF
 11626        ELSE
 11627           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11628           MOVE 'OC'             TO OC-RECORD-ID
 11629           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11630           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11631           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11632           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11633           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11634           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11635           MOVE PB-I-AGE         TO OC-INS-AGE
 11636           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11637           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11638           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11639           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11640           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11641           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11642           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11643           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11644           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11645           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11646           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11647           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11648           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11649           MOVE +0               TO OC-LF-CANCEL-AMT
 11650                                    OC-LF-ITD-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 216
* EL6311.cbl
 11651           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11652           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11653           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11654           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11655           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11656           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11657           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11658           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11659           MOVE +0               TO OC-AH-CANCEL-AMT
 11660                                    OC-AH-ITD-CANCEL-AMT
 11661           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11662           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 11663           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 11664           IF ERMAIL-FOUND
 11665              MOVE MA-CRED-BENE-NAME
 11666                                 TO OC-CRED-BENE-NAME
 11667           END-IF
 11668           IF NOT CERT-TRL-REC-NOT-FOUND
 11669              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11670                           OC-INS-AGE-DEFAULT-FLAG
 11671              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11672                           OC-JNT-AGE-DEFAULT-FLAG
 11673           END-IF
 11674           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11675
 11676* EXEC CICS WRITE
 11677*             DATASET   ('ELCRTO')
 11678*             FROM      (ORIGINAL-CERTIFICATE)
 11679*             RIDFLD    (OC-CONTROL-PRIMARY)
 11680*             RESP      (WS-RESPONSE)
 11681*          END-EXEC
 11682     MOVE LENGTH OF
 11683      ORIGINAL-CERTIFICATE
 11684       TO DFHEIV11
 11685     MOVE 'ELCRTO' TO DFHEIV1
 11686*    MOVE '&$ L                  ''  N#00011186' TO DFHEIV0
 11687     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11688     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11689     MOVE X'204E233030303131313836' TO DFHEIV0(25:11)
 11690     CALL 'kxdfhei1' USING DFHEIV0,
 11691           DFHEIV1,
 11692           ORIGINAL-CERTIFICATE,
 11693           DFHEIV11,
 11694           OC-CONTROL-PRIMARY,
 11695           DFHEIV99,
 11696           DFHEIV99
 11697     MOVE EIBRESP  TO WS-RESPONSE
 11698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11699        END-IF
 11700     ELSE
 11701        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11702        MOVE 'OC'                TO OC-RECORD-ID
 11703        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11704                                 TO OC-CONTROL-PRIMARY (1:33)
 11705        MOVE 'I'                 TO OC-RECORD-TYPE
 11706        MOVE +4096               TO OC-KEY-SEQ-NO
 11707        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11708        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 217
* EL6311.cbl
 11709        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11710        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11711        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11712        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11713        MOVE PB-I-AGE            TO OC-INS-AGE
 11714        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11715        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11716        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11717        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11718        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11719        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11720        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11721        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11722        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11723        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11724        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11725        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11726        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11727        MOVE +0                  TO OC-LF-CANCEL-AMT
 11728                                    OC-LF-ITD-CANCEL-AMT
 11729        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11730        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11731        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11732        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11733        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11734        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11735        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11736        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11737        MOVE +0                  TO OC-AH-CANCEL-AMT
 11738                                    OC-AH-ITD-CANCEL-AMT
 11739        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11740        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 11741        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 11742        IF ERMAIL-FOUND
 11743           MOVE MA-CRED-BENE-NAME
 11744                                 TO OC-CRED-BENE-NAME
 11745        END-IF
 11746        IF NOT CERT-TRL-REC-NOT-FOUND
 11747           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 11748                           OC-INS-AGE-DEFAULT-FLAG
 11749           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 11750                           OC-JNT-AGE-DEFAULT-FLAG
 11751        END-IF
 11752        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11753
 11754* EXEC CICS WRITE
 11755*          DATASET   ('ELCRTO')
 11756*          FROM      (ORIGINAL-CERTIFICATE)
 11757*          RIDFLD    (OC-CONTROL-PRIMARY)
 11758*          RESP      (WS-RESPONSE)
 11759*       END-EXEC
 11760     MOVE LENGTH OF
 11761      ORIGINAL-CERTIFICATE
 11762       TO DFHEIV11
 11763     MOVE 'ELCRTO' TO DFHEIV1
 11764*    MOVE '&$ L                  ''  N#00011246' TO DFHEIV0
 11765     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11766     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 218
* EL6311.cbl
 11767     MOVE X'204E233030303131323436' TO DFHEIV0(25:11)
 11768     CALL 'kxdfhei1' USING DFHEIV0,
 11769           DFHEIV1,
 11770           ORIGINAL-CERTIFICATE,
 11771           DFHEIV11,
 11772           OC-CONTROL-PRIMARY,
 11773           DFHEIV99,
 11774           DFHEIV99
 11775     MOVE EIBRESP  TO WS-RESPONSE
 11776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11777     END-IF
 11778******************************************************************
 11779*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11780******************************************************************
 11781
 11782     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11783     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11784
 11785
 11786* EXEC CICS READ
 11787*        INTO    (PENDING-BUSINESS)
 11788*        DATASET (FILE-ID-ERPNDB)
 11789*        RIDFLD  (ERPNDB-KEY)
 11790*        UPDATE
 11791*    END-EXEC.
 11792     MOVE LENGTH OF
 11793      PENDING-BUSINESS
 11794       TO DFHEIV11
 11795*    MOVE '&"IL       EU         (   #00011260' TO DFHEIV0
 11796     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11797     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11798     MOVE X'2020233030303131323630' TO DFHEIV0(25:11)
 11799     CALL 'kxdfhei1' USING DFHEIV0,
 11800           FILE-ID-ERPNDB,
 11801           PENDING-BUSINESS,
 11802           DFHEIV11,
 11803           ERPNDB-KEY,
 11804           DFHEIV99,
 11805           DFHEIV99,
 11806           DFHEIV99
 11807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11808
 11809
 11810     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 11811     MOVE 'B'                    TO JP-RECORD-TYPE.
 11812     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11813
 11814     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11815
 11816     PERFORM 8400-LOG-JOURNAL-RECORD.
 11817
 11818     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 11819
 11820     MOVE 'C'                    TO JP-RECORD-TYPE.
 11821     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11822
 11823
 11824* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 219
* EL6311.cbl
 11825*        DATASET    (FILE-ID-ERPNDB)
 11826*        FROM       (PENDING-BUSINESS)
 11827*    END-EXEC.
 11828     MOVE LENGTH OF
 11829      PENDING-BUSINESS
 11830       TO DFHEIV11
 11831*    MOVE '&& L                  %   #00011280' TO DFHEIV0
 11832     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11833     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11834     MOVE X'2020233030303131323830' TO DFHEIV0(25:11)
 11835     CALL 'kxdfhei1' USING DFHEIV0,
 11836           FILE-ID-ERPNDB,
 11837           PENDING-BUSINESS,
 11838           DFHEIV11,
 11839           DFHEIV99
 11840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11841
 11842
 11843     PERFORM 8400-LOG-JOURNAL-RECORD.
 11844
 11845     IF WS-ERRORS-PRESENT
 11846        GO TO 3900-RE-DISPLAY-RECORD.
 11847
 11848     MOVE ZEROS                  TO EMI-ERROR.
 11849     MOVE -1                     TO BMAINTL.
 11850     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11851     GO TO 3900-RE-DISPLAY-RECORD.
 11852
 11853 1380-BATCH-HDR-NOT-FOUND.
 11854     MOVE -1                     TO BMAINTL.
 11855     MOVE ER-7450                TO EMI-ERROR.
 11856     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11857     GO TO 8200-SEND-DATAONLY.
 11858
 11859 1385-REC-NOT-FOUND.
 11860     MOVE -1                     TO BMAINTL.
 11861     MOVE ER-7451                TO EMI-ERROR.
 11862     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11863     GO TO 8200-SEND-DATAONLY.
 11864
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 220
* EL6311.cbl
 11866
 11867 1386-UPDATE-AGE-FLAGS.
 11868
 11869
 11870* EXEC CICS GETMAIN
 11871*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11872*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11873*        INITIMG (GETMAIN-SPACE)
 11874*    END-EXEC
 11875*    MOVE ',"IL                  $   #00011311' TO DFHEIV0
 11876     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11877     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11878     MOVE X'2020233030303131333131' TO DFHEIV0(25:11)
 11879     CALL 'kxdfhei1' USING DFHEIV0,
 11880           DFHEIV20,
 11881           ELCRTT-RECORD-LENGTH,
 11882           GETMAIN-SPACE
 11883     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11884         DFHEIV20
 11885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11886
 11887
 11888* EXEC CICS HANDLE CONDITION
 11889*        NOTFND   (1386-NOTFND)
 11890*    END-EXEC.
 11891*    MOVE '"$I                   ! ( #00011317' TO DFHEIV0
 11892     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11893     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11894     MOVE X'2820233030303131333137' TO DFHEIV0(25:11)
 11895     CALL 'kxdfhei1' USING DFHEIV0
 11896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11897
 11898
 11899     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 11900     MOVE 'C'                TO ELCRTT-REC-TYPE
 11901
 11902
 11903* EXEC CICS READ
 11904*        UPDATE
 11905*        DATASET  (CRTT-ID)
 11906*        RIDFLD   (ELCRTT-KEY)
 11907*        INTO     (CERTIFICATE-TRAILERS)
 11908*    END-EXEC.
 11909     MOVE LENGTH OF
 11910      CERTIFICATE-TRAILERS
 11911       TO DFHEIV11
 11912*    MOVE '&"IL       EU         (   #00011324' TO DFHEIV0
 11913     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11914     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11915     MOVE X'2020233030303131333234' TO DFHEIV0(25:11)
 11916     CALL 'kxdfhei1' USING DFHEIV0,
 11917           CRTT-ID,
 11918           CERTIFICATE-TRAILERS,
 11919           DFHEIV11,
 11920           ELCRTT-KEY,
 11921           DFHEIV99,
 11922           DFHEIV99,
 11923           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 221
* EL6311.cbl
 11924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11925
 11926
 11927     IF WS-INS-AGE-SET = 'Y'
 11928        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 11929     END-IF
 11930     IF WS-JNT-AGE-SET = 'Y'
 11931        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 11932     END-IF
 11933
 11934
 11935* EXEC CICS REWRITE
 11936*       DATASET  (CRTT-ID)
 11937*       FROM     (CERTIFICATE-TRAILERS)
 11938*    END-EXEC.
 11939     MOVE LENGTH OF
 11940      CERTIFICATE-TRAILERS
 11941       TO DFHEIV11
 11942*    MOVE '&& L                  %   #00011338' TO DFHEIV0
 11943     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11944     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11945     MOVE X'2020233030303131333338' TO DFHEIV0(25:11)
 11946     CALL 'kxdfhei1' USING DFHEIV0,
 11947           CRTT-ID,
 11948           CERTIFICATE-TRAILERS,
 11949           DFHEIV11,
 11950           DFHEIV99
 11951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11952
 11953
 11954     GO TO 1386-EXIT.
 11955
 11956 1386-NOTFND.
 11957
 11958     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 11959     MOVE 'CS'         TO CS-RECORD-ID.
 11960     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 11961     MOVE 'C'          TO ELCRTT-REC-TYPE.
 11962     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 11963     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 11964     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 11965
 11966* EXEC CICS WRITE
 11967*       DATASET  (CRTT-ID)
 11968*       RIDFLD   (ELCRTT-KEY)
 11969*       FROM     (CERTIFICATE-TRAILERS)
 11970*    END-EXEC.
 11971     MOVE LENGTH OF
 11972      CERTIFICATE-TRAILERS
 11973       TO DFHEIV11
 11974*    MOVE '&$ L                  ''   #00011354' TO DFHEIV0
 11975     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11976     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11977     MOVE X'2020233030303131333534' TO DFHEIV0(25:11)
 11978     CALL 'kxdfhei1' USING DFHEIV0,
 11979           CRTT-ID,
 11980           CERTIFICATE-TRAILERS,
 11981           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 222
* EL6311.cbl
 11982           ELCRTT-KEY,
 11983           DFHEIV99,
 11984           DFHEIV99
 11985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11986
 11987
 11988 1386-EXIT.
 11989     EXIT.
 11990
 11991 1390-UPDATE-ERPNDM.
 11992
 11993
 11994* EXEC CICS HANDLE CONDITION
 11995*        NOTFND (1399-EXIT)
 11996*    END-EXEC.
 11997*    MOVE '"$I                   ! ) #00011365' TO DFHEIV0
 11998     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11999     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12000     MOVE X'2920233030303131333635' TO DFHEIV0(25:11)
 12001     CALL 'kxdfhei1' USING DFHEIV0
 12002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12003
 12004
 12005     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12006
 12007
 12008* EXEC CICS READ
 12009*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12010*        DATASET (FILE-ID-ERPNDM)
 12011*        RIDFLD  (ERPNDM-KEY)
 12012*        UPDATE
 12013*    END-EXEC.
 12014*    MOVE '&"S        EU         (   #00011371' TO DFHEIV0
 12015     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12016     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12017     MOVE X'2020233030303131333731' TO DFHEIV0(25:11)
 12018     CALL 'kxdfhei1' USING DFHEIV0,
 12019           FILE-ID-ERPNDM,
 12020           DFHEIV20,
 12021           DFHEIV99,
 12022           ERPNDM-KEY,
 12023           DFHEIV99,
 12024           DFHEIV99,
 12025           DFHEIV99
 12026     SET ADDRESS OF PENDING-MAILING-DATA TO
 12027         DFHEIV20
 12028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12029
 12030
 12031     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12032     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12033     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12034
 12035     IF BLSTNML GREATER THAN ZEROS
 12036         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12037
 12038     IF B1STNML GREATER  THAN ZEROS
 12039         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 223
* EL6311.cbl
 12040
 12041     IF BINITL GREATER THAN ZEROS
 12042         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12043
 12044     IF BAGEL GREATER THAN ZEROS
 12045         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12046
 12047     IF BBIRTHL GREATER THAN ZEROS
 12048         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12049
 12050     IF BSEXL GREATER THAN ZEROS
 12051         MOVE  BSEXI             TO PM-INSURED-SEX.
 12052
 12053
 12054* EXEC CICS REWRITE
 12055*        DATASET (FILE-ID-ERPNDM)
 12056*        FROM    (PENDING-MAILING-DATA)
 12057*    END-EXEC.
 12058     MOVE LENGTH OF
 12059      PENDING-MAILING-DATA
 12060       TO DFHEIV11
 12061*    MOVE '&& L                  %   #00011400' TO DFHEIV0
 12062     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12063     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12064     MOVE X'2020233030303131343030' TO DFHEIV0(25:11)
 12065     CALL 'kxdfhei1' USING DFHEIV0,
 12066           FILE-ID-ERPNDM,
 12067           PENDING-MAILING-DATA,
 12068           DFHEIV11,
 12069           DFHEIV99
 12070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12071
 12072
 12073 1399-EXIT.
 12074     EXIT.
 12075
 12076******************************************************************
 12077*                                                                *
 12078*          D E L E T E   I S S U E   R O U T I N E               *
 12079*                                                                *
 12080******************************************************************
 12081
 12082 1400-DELETE-ISSUE-ROUTINE.
 12083     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12084
 12085     IF BCHGL NOT = ZEROS
 12086        MOVE ER-2196             TO EMI-ERROR
 12087        MOVE AL-UABON            TO BMAINTA
 12088        MOVE -1                  TO BMAINTL
 12089        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12090        GO TO 8200-SEND-DATAONLY.
 12091
 12092
 12093* EXEC CICS HANDLE CONDITION
 12094*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12095*    END-EXEC.
 12096*    MOVE '"$I                   ! * #00011424' TO DFHEIV0
 12097     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 224
* EL6311.cbl
 12098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12099     MOVE X'2A20233030303131343234' TO DFHEIV0(25:11)
 12100     CALL 'kxdfhei1' USING DFHEIV0
 12101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12102
 12103
 12104     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12105     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12106     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12107
 12108
 12109* EXEC CICS READ
 12110*        SET     (ADDRESS OF PENDING-BUSINESS)
 12111*        DATASET (FILE-ID-ERPNDB)
 12112*        RIDFLD  (ERPNDB-KEY)
 12113*    END-EXEC.
 12114*    MOVE '&"S        E          (   #00011432' TO DFHEIV0
 12115     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12116     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12117     MOVE X'2020233030303131343332' TO DFHEIV0(25:11)
 12118     CALL 'kxdfhei1' USING DFHEIV0,
 12119           FILE-ID-ERPNDB,
 12120           DFHEIV20,
 12121           DFHEIV99,
 12122           ERPNDB-KEY,
 12123           DFHEIV99,
 12124           DFHEIV99,
 12125           DFHEIV99
 12126     SET ADDRESS OF PENDING-BUSINESS TO
 12127         DFHEIV20
 12128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12129
 12130
 12131     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12132
 12133     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12134
 12135     IF BSUFIXL NOT = ZEROS
 12136        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12137     ELSE
 12138        MOVE SPACE               TO WS-NEW-SUFFIX.
 12139
 12140     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12141     PERFORM 8600-DEEDIT.
 12142     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12143     MOVE '4'                    TO DC-OPTION-CODE.
 12144     PERFORM 9700-DATE-LINK.
 12145     IF DATE-CONVERSION-ERROR
 12146        MOVE ER-0348             TO EMI-ERROR
 12147        MOVE -1                  TO BEFFDTL
 12148        MOVE AL-UABON            TO BEFFDTA
 12149        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12150        GO TO 8200-SEND-DATAONLY
 12151     ELSE
 12152        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12153        MOVE AL-UANON            TO BEFFDTA
 12154        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12155
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 225
* EL6311.cbl
 12156
 12157* EXEC CICS HANDLE CONDITION
 12158*         NOTFND    (1490-RECORD-NOT-FOUND)
 12159*    END-EXEC.
 12160*    MOVE '"$I                   ! + #00011463' TO DFHEIV0
 12161     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12162     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12163     MOVE X'2B20233030303131343633' TO DFHEIV0(25:11)
 12164     CALL 'kxdfhei1' USING DFHEIV0
 12165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12166
 12167
 12168
 12169* EXEC CICS READ
 12170*        SET     (ADDRESS OF PENDING-BUSINESS)
 12171*        DATASET (FILE-ID-ERPNDB)
 12172*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12173*        UPDATE
 12174*    END-EXEC.
 12175*    MOVE '&"S        EU         (   #00011467' TO DFHEIV0
 12176     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12177     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12178     MOVE X'2020233030303131343637' TO DFHEIV0(25:11)
 12179     CALL 'kxdfhei1' USING DFHEIV0,
 12180           FILE-ID-ERPNDB,
 12181           DFHEIV20,
 12182           DFHEIV99,
 12183           PI-PREV-CONTROL-PRIMARY,
 12184           DFHEIV99,
 12185           DFHEIV99,
 12186           DFHEIV99
 12187     SET ADDRESS OF PENDING-BUSINESS TO
 12188         DFHEIV20
 12189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12190
 12191
 12192     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12193        MOVE -1                 TO BMAINTL
 12194        MOVE ER-2197            TO EMI-ERROR
 12195        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12196        GO TO 8200-SEND-DATAONLY.
 12197
 12198     IF PB-BILLED-DT NOT = LOW-VALUES
 12199        MOVE -1                 TO BMAINTL
 12200        MOVE ER-2129            TO EMI-ERROR
 12201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12202        GO TO 8200-SEND-DATAONLY.
 12203
 12204     IF PB-CHG-COUNT NOT = ZEROS
 12205        MOVE ER-2336            TO EMI-ERROR
 12206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12207        MOVE AL-UABON            TO BMAINTA
 12208        MOVE -1                  TO BMAINTL
 12209        GO TO 8200-SEND-DATAONLY.
 12210
 12211     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12212        PB-CHG-COUNT NOT = ZEROS
 12213        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 226
* EL6311.cbl
 12214        MOVE AL-UABON            TO BMAINTA
 12215        MOVE -1                  TO BMAINTL
 12216        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12217        GO TO 8200-SEND-DATAONLY.
 12218******************************************************************
 12219*                                                                *
 12220*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12221*                                                                *
 12222******************************************************************
 12223     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12224     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12225     MOVE +0                     TO ELCRTO-SEQ-NO
 12226
 12227* EXEC CICS READ
 12228*       DATASET   ('ELCRTO')
 12229*       INTO      (ORIGINAL-CERTIFICATE)
 12230*       RIDFLD    (ELCRTO-KEY)
 12231*       GTEQ
 12232*       RESP      (WS-RESPONSE)
 12233*    END-EXEC
 12234     MOVE LENGTH OF
 12235      ORIGINAL-CERTIFICATE
 12236       TO DFHEIV11
 12237     MOVE 'ELCRTO' TO DFHEIV1
 12238*    MOVE '&"IL       G          (  N#00011508' TO DFHEIV0
 12239     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12240     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12241     MOVE X'204E233030303131353038' TO DFHEIV0(25:11)
 12242     CALL 'kxdfhei1' USING DFHEIV0,
 12243           DFHEIV1,
 12244           ORIGINAL-CERTIFICATE,
 12245           DFHEIV11,
 12246           ELCRTO-KEY,
 12247           DFHEIV99,
 12248           DFHEIV99,
 12249           DFHEIV99
 12250     MOVE EIBRESP  TO WS-RESPONSE
 12251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12252     IF RESP-NORMAL
 12253        AND (OC-CONTROL-PRIMARY (1:33) =
 12254                 PB-CONTROL-BY-ACCOUNT (1:33))
 12255        AND (OC-RECORD-TYPE = 'I')
 12256
 12257* EXEC CICS READ
 12258*          DATASET   ('ELCRTO')
 12259*          INTO      (ORIGINAL-CERTIFICATE)
 12260*          RIDFLD    (ELCRTO-KEY)
 12261*          UPDATE
 12262*          RESP      (WS-RESPONSE)
 12263*       END-EXEC
 12264     MOVE LENGTH OF
 12265      ORIGINAL-CERTIFICATE
 12266       TO DFHEIV11
 12267     MOVE 'ELCRTO' TO DFHEIV1
 12268*    MOVE '&"IL       EU         (  N#00011519' TO DFHEIV0
 12269     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12270     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12271     MOVE X'204E233030303131353139' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 227
* EL6311.cbl
 12272     CALL 'kxdfhei1' USING DFHEIV0,
 12273           DFHEIV1,
 12274           ORIGINAL-CERTIFICATE,
 12275           DFHEIV11,
 12276           ELCRTO-KEY,
 12277           DFHEIV99,
 12278           DFHEIV99,
 12279           DFHEIV99
 12280     MOVE EIBRESP  TO WS-RESPONSE
 12281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12282        IF RESP-NORMAL
 12283
 12284* EXEC CICS DELETE
 12285*             DATASET   ('ELCRTO')
 12286*          END-EXEC
 12287     MOVE 'ELCRTO' TO DFHEIV1
 12288*    MOVE '&(                    &   #00011527' TO DFHEIV0
 12289     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12290     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12291     MOVE X'2020233030303131353237' TO DFHEIV0(25:11)
 12292     CALL 'kxdfhei1' USING DFHEIV0,
 12293           DFHEIV1,
 12294           DFHEIV99,
 12295           DFHEIV99,
 12296           DFHEIV99,
 12297           DFHEIV99
 12298     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12299        END-IF
 12300     END-IF
 12301******************************************************************
 12302*                                                                *
 12303*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12304*                                                                *
 12305******************************************************************
 12306
 12307* EXEC CICS HANDLE CONDITION
 12308*        NOTFND    (1405-DELETE-CERTIFICATE)
 12309*    END-EXEC.
 12310*    MOVE '"$I                   ! , #00011537' TO DFHEIV0
 12311     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12312     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12313     MOVE X'2C20233030303131353337' TO DFHEIV0(25:11)
 12314     CALL 'kxdfhei1' USING DFHEIV0
 12315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12316
 12317
 12318
 12319* EXEC CICS READ
 12320*        EQUAL
 12321*        DATASET   (FILE-ID-ERPNDM)
 12322*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12323*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12324*        UPDATE
 12325*    END-EXEC.
 12326*    MOVE '&"S        EU         (   #00011541' TO DFHEIV0
 12327     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12328     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12329     MOVE X'2020233030303131353431' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 228
* EL6311.cbl
 12330     CALL 'kxdfhei1' USING DFHEIV0,
 12331           FILE-ID-ERPNDM,
 12332           DFHEIV20,
 12333           DFHEIV99,
 12334           PI-PREV-CONTROL-PRIMARY,
 12335           DFHEIV99,
 12336           DFHEIV99,
 12337           DFHEIV99
 12338     SET ADDRESS OF PENDING-MAILING-DATA TO
 12339         DFHEIV20
 12340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12341
 12342
 12343     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12344     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12345     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12346
 12347     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12348
 12349
 12350* EXEC CICS DELETE
 12351*        DATASET   (FILE-ID-ERPNDM)
 12352*    END-EXEC.
 12353*    MOVE '&(                    &   #00011555' TO DFHEIV0
 12354     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12355     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12356     MOVE X'2020233030303131353535' TO DFHEIV0(25:11)
 12357     CALL 'kxdfhei1' USING DFHEIV0,
 12358           FILE-ID-ERPNDM,
 12359           DFHEIV99,
 12360           DFHEIV99,
 12361           DFHEIV99,
 12362           DFHEIV99
 12363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12364
 12365
 12366******************************************************************
 12367*                PROCESS   CERTIFICATE                           *
 12368******************************************************************
 12369
 12370 1405-DELETE-CERTIFICATE.
 12371
 12372* EXEC CICS HANDLE CONDITION
 12373*         NOTFND  (1420-CONTINUE-DELETE)
 12374*    END-EXEC.
 12375*    MOVE '"$I                   ! - #00011564' TO DFHEIV0
 12376     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12377     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12378     MOVE X'2D20233030303131353634' TO DFHEIV0(25:11)
 12379     CALL 'kxdfhei1' USING DFHEIV0
 12380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12381
 12382
 12383     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12384     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12385     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12386     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12387
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 229
* EL6311.cbl
 12388
 12389* EXEC CICS READ
 12390*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12391*        DATASET (FILE-ID-ELCERT)
 12392*        RIDFLD  (ELCERT-KEY)
 12393*        UPDATE
 12394*    END-EXEC.
 12395*    MOVE '&"S        EU         (   #00011573' TO DFHEIV0
 12396     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12397     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12398     MOVE X'2020233030303131353733' TO DFHEIV0(25:11)
 12399     CALL 'kxdfhei1' USING DFHEIV0,
 12400           FILE-ID-ELCERT,
 12401           DFHEIV20,
 12402           DFHEIV99,
 12403           ELCERT-KEY,
 12404           DFHEIV99,
 12405           DFHEIV99,
 12406           DFHEIV99
 12407     SET ADDRESS OF CERTIFICATE-MASTER TO
 12408         DFHEIV20
 12409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12410
 12411
 12412     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12413
 12414     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12415     MOVE 'B'                    TO JP-RECORD-TYPE
 12416     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12417
 12418     PERFORM 8400-LOG-JOURNAL-RECORD.
 12419
 12420     IF CERT-NOTES-ARE-NOT-PRESENT
 12421        MOVE ' '                 TO WS-CERT-NOTE-SW
 12422     ELSE
 12423        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12424
 12425     IF INSURED-ADDR-PRESENT
 12426        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12427
 12428******************************************************************
 12429******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12430******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12431******************************************************************
 12432******************************************************************
 12433
 12434     IF CERT-ADDED-BATCH AND
 12435        (NOT NO-CLAIM-ATTACHED
 12436         OR
 12437         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12438        GO TO 1410-REWRITE-CERT.
 12439
 12440******************************************************************
 12441******************************************************************
 12442
 12443     IF CERT-ADDED-BATCH  AND
 12444        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12445        GO TO 1410-REWRITE-CERT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 230
* EL6311.cbl
 12446
 12447     IF NO-CLAIM-ATTACHED
 12448        NEXT SENTENCE
 12449     ELSE
 12450        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12451        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12452        GO TO 1410-REWRITE-CERT.
 12453
 12454     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12455     MOVE 'D'                      TO JP-RECORD-TYPE.
 12456     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12457
 12458
 12459* EXEC CICS DELETE
 12460*         DATASET    (FILE-ID-ELCERT)
 12461*    END-EXEC.
 12462*    MOVE '&(                    &   #00011626' TO DFHEIV0
 12463     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12464     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12465     MOVE X'2020233030303131363236' TO DFHEIV0(25:11)
 12466     CALL 'kxdfhei1' USING DFHEIV0,
 12467           FILE-ID-ELCERT,
 12468           DFHEIV99,
 12469           DFHEIV99,
 12470           DFHEIV99,
 12471           DFHEIV99
 12472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12473
 12474
 12475     PERFORM 8400-LOG-JOURNAL-RECORD.
 12476
 12477******************************************************************
 12478*                                                                *
 12479*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12480*                                                                *
 12481******************************************************************
 12482
 12483     IF  CERT-NOTES-ARE-PRESENT
 12484         NEXT SENTENCE
 12485     ELSE
 12486         GO TO 1407-DELETE-MAILING.
 12487
 12488
 12489* EXEC CICS HANDLE CONDITION
 12490*         NOTFND  (1406-DELETE-ERNOTE)
 12491*    END-EXEC.
 12492*    MOVE '"$I                   ! . #00011643' TO DFHEIV0
 12493     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12494     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12495     MOVE X'2E20233030303131363433' TO DFHEIV0(25:11)
 12496     CALL 'kxdfhei1' USING DFHEIV0
 12497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12498
 12499
 12500     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12501     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12502     MOVE 0                     TO ERCNOT-SEQUENCE.
 12503
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 231
* EL6311.cbl
 12504 1406-DELETE-ERCNOT-LOOP.
 12505
 12506
 12507* EXEC CICS READ
 12508*        GTEQ
 12509*        DATASET   (FILE-ID-ERCNOT)
 12510*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12511*        RIDFLD    (ERCNOT-KEY)
 12512*    END-EXEC.
 12513*    MOVE '&"S        G          (   #00011653' TO DFHEIV0
 12514     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12515     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12516     MOVE X'2020233030303131363533' TO DFHEIV0(25:11)
 12517     CALL 'kxdfhei1' USING DFHEIV0,
 12518           FILE-ID-ERCNOT,
 12519           DFHEIV20,
 12520           DFHEIV99,
 12521           ERCNOT-KEY,
 12522           DFHEIV99,
 12523           DFHEIV99,
 12524           DFHEIV99
 12525     SET ADDRESS OF CERT-NOTE-FILE TO
 12526         DFHEIV20
 12527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12528
 12529
 12530     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12531     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12532         GO TO 1406-DELETE-ERNOTE
 12533     END-IF.
 12534
 12535     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12536     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12537     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12538
 12539     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12540
 12541
 12542* EXEC CICS DELETE
 12543*        DATASET   (FILE-ID-ERCNOT)
 12544*        RIDFLD    (ERCNOT-KEY)
 12545*        END-EXEC.
 12546*    MOVE '&(  R                 &   #00011671' TO DFHEIV0
 12547     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12548     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12549     MOVE X'2020233030303131363731' TO DFHEIV0(25:11)
 12550     CALL 'kxdfhei1' USING DFHEIV0,
 12551           FILE-ID-ERCNOT,
 12552           ERCNOT-KEY,
 12553           DFHEIV99,
 12554           DFHEIV99,
 12555           DFHEIV99
 12556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12557
 12558
 12559     PERFORM 8400-LOG-JOURNAL-RECORD.
 12560
 12561     GO TO 1406-DELETE-ERCNOT-LOOP.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 232
* EL6311.cbl
 12562
 12563 1406-DELETE-ERNOTE.
 12564
 12565
 12566* EXEC CICS HANDLE CONDITION
 12567*         NOTFND  (1407-DELETE-MAILING)
 12568*    END-EXEC.
 12569*    MOVE '"$I                   ! / #00011682' TO DFHEIV0
 12570     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12571     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12572     MOVE X'2F20233030303131363832' TO DFHEIV0(25:11)
 12573     CALL 'kxdfhei1' USING DFHEIV0
 12574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12575
 12576
 12577
 12578* EXEC CICS READ
 12579*        EQUAL
 12580*        DATASET   (FILE-ID-ERNOTE)
 12581*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12582*        RIDFLD    (ELCERT-KEY)
 12583*        UPDATE
 12584*    END-EXEC.
 12585*    MOVE '&"S        EU         (   #00011686' TO DFHEIV0
 12586     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12587     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12588     MOVE X'2020233030303131363836' TO DFHEIV0(25:11)
 12589     CALL 'kxdfhei1' USING DFHEIV0,
 12590           FILE-ID-ERNOTE,
 12591           DFHEIV20,
 12592           DFHEIV99,
 12593           ELCERT-KEY,
 12594           DFHEIV99,
 12595           DFHEIV99,
 12596           DFHEIV99
 12597     SET ADDRESS OF CERTIFICATE-NOTE TO
 12598         DFHEIV20
 12599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12600
 12601
 12602     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12603     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12604     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12605
 12606     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12607
 12608
 12609* EXEC CICS DELETE
 12610*        DATASET   (FILE-ID-ERNOTE)
 12611*        END-EXEC.
 12612*    MOVE '&(                    &   #00011700' TO DFHEIV0
 12613     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12614     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12615     MOVE X'2020233030303131373030' TO DFHEIV0(25:11)
 12616     CALL 'kxdfhei1' USING DFHEIV0,
 12617           FILE-ID-ERNOTE,
 12618           DFHEIV99,
 12619           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 233
* EL6311.cbl
 12620           DFHEIV99,
 12621           DFHEIV99
 12622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12623
 12624
 12625     PERFORM 8400-LOG-JOURNAL-RECORD.
 12626
 12627******************************************************************
 12628*                                                                *
 12629*                DELETE MAILING ADDRESS RECORDS                  *
 12630*                                                                *
 12631******************************************************************
 12632
 12633 1407-DELETE-MAILING.
 12634     IF CERT-ADDRESS-PRESENT
 12635        NEXT SENTENCE
 12636     ELSE
 12637        GO TO 1420-CONTINUE-DELETE.
 12638
 12639
 12640* EXEC CICS HANDLE CONDITION
 12641*         NOTFND  (1420-CONTINUE-DELETE)
 12642*    END-EXEC.
 12643*    MOVE '"$I                   ! 0 #00011718' TO DFHEIV0
 12644     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12645     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12646     MOVE X'3020233030303131373138' TO DFHEIV0(25:11)
 12647     CALL 'kxdfhei1' USING DFHEIV0
 12648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12649
 12650
 12651
 12652* EXEC CICS READ
 12653*        EQUAL
 12654*        DATASET   (FILE-ID-ERMAIL)
 12655*        SET       (ADDRESS OF MAILING-DATA)
 12656*        RIDFLD    (ELCERT-KEY)
 12657*        UPDATE
 12658*    END-EXEC.
 12659*    MOVE '&"S        EU         (   #00011722' TO DFHEIV0
 12660     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12661     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12662     MOVE X'2020233030303131373232' TO DFHEIV0(25:11)
 12663     CALL 'kxdfhei1' USING DFHEIV0,
 12664           FILE-ID-ERMAIL,
 12665           DFHEIV20,
 12666           DFHEIV99,
 12667           ELCERT-KEY,
 12668           DFHEIV99,
 12669           DFHEIV99,
 12670           DFHEIV99
 12671     SET ADDRESS OF MAILING-DATA TO
 12672         DFHEIV20
 12673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12674
 12675
 12676     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12677     MOVE 'D'                    TO  JP-RECORD-TYPE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 234
* EL6311.cbl
 12678     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12679
 12680     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12681
 12682
 12683* EXEC CICS DELETE
 12684*        DATASET   (FILE-ID-ERMAIL)
 12685*    END-EXEC.
 12686*    MOVE '&(                    &   #00011736' TO DFHEIV0
 12687     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12688     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12689     MOVE X'2020233030303131373336' TO DFHEIV0(25:11)
 12690     CALL 'kxdfhei1' USING DFHEIV0,
 12691           FILE-ID-ERMAIL,
 12692           DFHEIV99,
 12693           DFHEIV99,
 12694           DFHEIV99,
 12695           DFHEIV99
 12696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12697
 12698
 12699     GO TO 1420-CONTINUE-DELETE.
 12700
 12701 1410-REWRITE-CERT.
 12702     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12703     MOVE 'C'                      TO JP-RECORD-TYPE.
 12704     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12705     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12706
 12707
 12708* EXEC CICS REWRITE
 12709*         DATASET    (FILE-ID-ELCERT)
 12710*         FROM       (CERTIFICATE-MASTER)
 12711*         END-EXEC.
 12712     MOVE LENGTH OF
 12713      CERTIFICATE-MASTER
 12714       TO DFHEIV11
 12715*    MOVE '&& L                  %   #00011748' TO DFHEIV0
 12716     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12717     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12718     MOVE X'2020233030303131373438' TO DFHEIV0(25:11)
 12719     CALL 'kxdfhei1' USING DFHEIV0,
 12720           FILE-ID-ELCERT,
 12721           CERTIFICATE-MASTER,
 12722           DFHEIV11,
 12723           DFHEIV99
 12724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12725
 12726
 12727     PERFORM 8400-LOG-JOURNAL-RECORD.
 12728
 12729 1420-CONTINUE-DELETE.
 12730     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12731     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12732
 12733     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12734     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12735
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 235
* EL6311.cbl
 12736     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12737
 12738 1450-DELETE-PB-RECORD.
 12739     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12740     MOVE 'D'                      TO JP-RECORD-TYPE
 12741     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12742
 12743
 12744* EXEC CICS DELETE
 12745*        DATASET    (FILE-ID-ERPNDB)
 12746*    END-EXEC.
 12747*    MOVE '&(                    &   #00011769' TO DFHEIV0
 12748     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12749     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12750     MOVE X'2020233030303131373639' TO DFHEIV0(25:11)
 12751     CALL 'kxdfhei1' USING DFHEIV0,
 12752           FILE-ID-ERPNDB,
 12753           DFHEIV99,
 12754           DFHEIV99,
 12755           DFHEIV99,
 12756           DFHEIV99
 12757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12758
 12759
 12760     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12761
 12762     PERFORM 8400-LOG-JOURNAL-RECORD.
 12763
 12764     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12765     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12766     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12767
 12768
 12769* EXEC CICS HANDLE CONDITION
 12770*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12771*    END-EXEC.
 12772*    MOVE '"$I                   ! 1 #00011781' TO DFHEIV0
 12773     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12775     MOVE X'3120233030303131373831' TO DFHEIV0(25:11)
 12776     CALL 'kxdfhei1' USING DFHEIV0
 12777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12778
 12779
 12780
 12781* EXEC CICS READ
 12782*        SET     (ADDRESS OF PENDING-BUSINESS)
 12783*        DATASET (FILE-ID-ERPNDB)
 12784*        RIDFLD  (ERPNDB-KEY)
 12785*        UPDATE
 12786*    END-EXEC.
 12787*    MOVE '&"S        EU         (   #00011785' TO DFHEIV0
 12788     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12789     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12790     MOVE X'2020233030303131373835' TO DFHEIV0(25:11)
 12791     CALL 'kxdfhei1' USING DFHEIV0,
 12792           FILE-ID-ERPNDB,
 12793           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 236
* EL6311.cbl
 12794           DFHEIV99,
 12795           ERPNDB-KEY,
 12796           DFHEIV99,
 12797           DFHEIV99,
 12798           DFHEIV99
 12799     SET ADDRESS OF PENDING-BUSINESS TO
 12800         DFHEIV20
 12801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12802
 12803
 12804     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12805
 12806     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 12807
 12808     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12809        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12810        MOVE 'D'                   TO JP-RECORD-TYPE
 12811        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 12812
 12813* EXEC CICS DELETE
 12814*            DATASET    (FILE-ID-ERPNDB)
 12815*       END-EXEC
 12816*    MOVE '&(                    &   #00011800' TO DFHEIV0
 12817     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12818     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12819     MOVE X'2020233030303131383030' TO DFHEIV0(25:11)
 12820     CALL 'kxdfhei1' USING DFHEIV0,
 12821           FILE-ID-ERPNDB,
 12822           DFHEIV99,
 12823           DFHEIV99,
 12824           DFHEIV99,
 12825           DFHEIV99
 12826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12827        PERFORM 8400-LOG-JOURNAL-RECORD
 12828     ELSE
 12829        MOVE 'B'                 TO JP-RECORD-TYPE
 12830        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12831        PERFORM 8400-LOG-JOURNAL-RECORD
 12832        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 12833        MOVE 'C'                 TO JP-RECORD-TYPE
 12834        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12835
 12836* EXEC CICS REWRITE
 12837*            DATASET    (FILE-ID-ERPNDB)
 12838*            FROM       (PENDING-BUSINESS)
 12839*       END-EXEC
 12840     MOVE LENGTH OF
 12841      PENDING-BUSINESS
 12842       TO DFHEIV11
 12843*    MOVE '&& L                  %   #00011811' TO DFHEIV0
 12844     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12845     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12846     MOVE X'2020233030303131383131' TO DFHEIV0(25:11)
 12847     CALL 'kxdfhei1' USING DFHEIV0,
 12848           FILE-ID-ERPNDB,
 12849           PENDING-BUSINESS,
 12850           DFHEIV11,
 12851           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 237
* EL6311.cbl
 12852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12853        PERFORM 8400-LOG-JOURNAL-RECORD.
 12854
 12855******************************************************************
 12856*                                                                *
 12857*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 12858*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 12859*                                                                *
 12860******************************************************************
 12861
 12862     IF NOT PI-AR-PROCESSING
 12863        GO TO 1475-DELETE-FINISHED.
 12864
 12865     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12866        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12867        NEXT SENTENCE
 12868     ELSE
 12869        GO TO 1475-DELETE-FINISHED.
 12870
 12871
 12872* EXEC CICS HANDLE CONDITION
 12873*         NOTFND    (1475-DELETE-FINISHED)
 12874*         END-EXEC.
 12875*    MOVE '"$I                   ! 2 #00011833' TO DFHEIV0
 12876     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12877     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12878     MOVE X'3220233030303131383333' TO DFHEIV0(25:11)
 12879     CALL 'kxdfhei1' USING DFHEIV0
 12880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12881
 12882
 12883     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 12884     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 12885
 12886
 12887* EXEC CICS READ
 12888*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 12889*        DATASET (FILE-ID-ERRQST)
 12890*        RIDFLD  (ERRQST-KEY)
 12891*        UPDATE
 12892*    END-EXEC.
 12893*    MOVE '&"S        EU         (   #00011840' TO DFHEIV0
 12894     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12895     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12896     MOVE X'2020233030303131383430' TO DFHEIV0(25:11)
 12897     CALL 'kxdfhei1' USING DFHEIV0,
 12898           FILE-ID-ERRQST,
 12899           DFHEIV20,
 12900           DFHEIV99,
 12901           ERRQST-KEY,
 12902           DFHEIV99,
 12903           DFHEIV99,
 12904           DFHEIV99
 12905     SET ADDRESS OF AR-REQUEST-RECORD TO
 12906         DFHEIV20
 12907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12908
 12909
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 238
* EL6311.cbl
 12910     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12911
 12912     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 12913
 12914     MOVE 'D'                      TO JP-RECORD-TYPE.
 12915     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 12916
 12917
 12918* EXEC CICS DELETE
 12919*         DATASET    (FILE-ID-ERRQST)
 12920*    END-EXEC.
 12921*    MOVE '&(                    &   #00011854' TO DFHEIV0
 12922     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12923     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12924     MOVE X'2020233030303131383534' TO DFHEIV0(25:11)
 12925     CALL 'kxdfhei1' USING DFHEIV0,
 12926           FILE-ID-ERRQST,
 12927           DFHEIV99,
 12928           DFHEIV99,
 12929           DFHEIV99,
 12930           DFHEIV99
 12931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12932
 12933
 12934     PERFORM 8400-LOG-JOURNAL-RECORD.
 12935
 12936 1475-DELETE-FINISHED.
 12937     MOVE ZEROS                  TO EMI-ERROR.
 12938     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12939     MOVE LOW-VALUES             TO EL631BI.
 12940     MOVE -1                     TO BMAINTL.
 12941     GO TO 8100-SEND-INITIAL-MAP.
 12942
 12943 1480-BATCH-HDR-NOT-FOUND.
 12944     MOVE -1                     TO BMAINTL.
 12945     MOVE ER-7450                TO EMI-ERROR.
 12946     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12947     GO TO 8200-SEND-DATAONLY.
 12948
 12949 1490-RECORD-NOT-FOUND.
 12950     MOVE -1                     TO BMAINTL.
 12951     MOVE ER-7451                TO EMI-ERROR.
 12952     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12953     GO TO 8200-SEND-DATAONLY.
 12954
 12955******************************************************************
 12956*            O V E R   C H A R G E   P R O C E S S I N G         *
 12957******************************************************************
 12958 1500-UPDATE-ERNOTE.
 12959     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 12960     MOVE 'A'                    TO WS-NOTE-SW
 12961     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 12962     .
 12963 1500-EXIT.
 12964     EXIT.
 12965 1510-ADD-ERNOTE-REC.
 12966
 12967* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 239
* EL6311.cbl
 12968*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 12969*        LENGTH  (ERNOTE-RECORD-LENGTH)
 12970*        INITIMG (GETMAIN-SPACE)
 12971*    END-EXEC
 12972*    MOVE ',"IL                  $   #00011890' TO DFHEIV0
 12973     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12974     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12975     MOVE X'2020233030303131383930' TO DFHEIV0(25:11)
 12976     CALL 'kxdfhei1' USING DFHEIV0,
 12977           DFHEIV20,
 12978           ERNOTE-RECORD-LENGTH,
 12979           GETMAIN-SPACE
 12980     SET ADDRESS OF CERTIFICATE-NOTE TO
 12981         DFHEIV20
 12982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12983     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12984                                 TO ERNOTE-KEY
 12985
 12986* EXEC CICS READ
 12987*       DATASET    (FILE-ID-ERNOTE)
 12988*       RIDFLD     (ERNOTE-KEY)
 12989*       INTO       (CERTIFICATE-NOTE)
 12990*       RESP       (WS-RESPONSE)
 12991*       UPDATE
 12992*    END-EXEC
 12993     MOVE LENGTH OF
 12994      CERTIFICATE-NOTE
 12995       TO DFHEIV11
 12996*    MOVE '&"IL       EU         (  N#00011897' TO DFHEIV0
 12997     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12998     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12999     MOVE X'204E233030303131383937' TO DFHEIV0(25:11)
 13000     CALL 'kxdfhei1' USING DFHEIV0,
 13001           FILE-ID-ERNOTE,
 13002           CERTIFICATE-NOTE,
 13003           DFHEIV11,
 13004           ERNOTE-KEY,
 13005           DFHEIV99,
 13006           DFHEIV99,
 13007           DFHEIV99
 13008     MOVE EIBRESP  TO WS-RESPONSE
 13009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13010     IF RESP-NORMAL
 13011        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13012           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13013        END-IF
 13014        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13015           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13016        END-IF
 13017        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13018           (N1 > +10)
 13019           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13020           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13021        END-PERFORM
 13022        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13023          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13024
 13025* EXEC CICS UNLOCK
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 240
* EL6311.cbl
 13026*            DATASET    (FILE-ID-ERNOTE)
 13027*          END-EXEC
 13028*    MOVE '&*                    #   #00011918' TO DFHEIV0
 13029     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13030     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13031     MOVE X'2020233030303131393138' TO DFHEIV0(25:11)
 13032     CALL 'kxdfhei1' USING DFHEIV0,
 13033           FILE-ID-ERNOTE,
 13034           DFHEIV99
 13035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13036        ELSE
 13037          PERFORM VARYING N1 FROM +1 BY +1
 13038           UNTIL (N1 > +10)
 13039           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13040          END-PERFORM
 13041          IF (N1 < +11)
 13042            IF N1 >= CN-BILLING-START-LINE-NO AND
 13043              N1 <= CN-BILLING-END-LINE-NO
 13044              IF PI-COMPANY-ID = 'DCC'
 13045                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13046              ELSE
 13047                 MOVE WS-VA-NO-COMM-MESS
 13048                                    TO CN-LINE (N1)
 13049              END-IF
 13050            ELSE
 13051              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13052               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13053                IF PI-COMPANY-ID = 'DCC'
 13054                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13055                ELSE
 13056                  MOVE WS-VA-NO-COMM-MESS
 13057                                    TO CN-LINE (N1)
 13058                END-IF
 13059                MOVE N1             TO CN-BILLING-END-LINE-NO
 13060              ELSE
 13061                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13062                  IF PI-COMPANY-ID = 'DCC'
 13063                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13064                  ELSE
 13065                     MOVE WS-VA-NO-COMM-MESS
 13066                                    TO CN-LINE (N1)
 13067                  END-IF
 13068                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13069                                      CN-BILLING-START-LINE-NO
 13070                ELSE
 13071                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13072                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13073                     IF PI-COMPANY-ID = 'DCC'
 13074                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13075                     ELSE
 13076                       MOVE WS-VA-NO-COMM-MESS
 13077                                    TO CN-LINE (N1)
 13078                     END-IF
 13079                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13080                  ELSE
 13081                     PERFORM 1700-SQUEEZE-IT-IN
 13082                                 THRU 1700-EXIT
 13083                  END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 241
* EL6311.cbl
 13084                END-IF
 13085              END-IF
 13086            END-IF
 13087            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13088            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13089            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13090
 13091* EXEC CICS REWRITE
 13092*              DATASET    (FILE-ID-ERNOTE)
 13093*              FROM       (CERTIFICATE-NOTE)
 13094*              RESP       (WS-RESPONSE)
 13095*           END-EXEC
 13096     MOVE LENGTH OF
 13097      CERTIFICATE-NOTE
 13098       TO DFHEIV11
 13099*    MOVE '&& L                  %  N#00011975' TO DFHEIV0
 13100     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13101     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13102     MOVE X'204E233030303131393735' TO DFHEIV0(25:11)
 13103     CALL 'kxdfhei1' USING DFHEIV0,
 13104           FILE-ID-ERNOTE,
 13105           CERTIFICATE-NOTE,
 13106           DFHEIV11,
 13107           DFHEIV99
 13108     MOVE EIBRESP  TO WS-RESPONSE
 13109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13110          END-IF
 13111        END-IF
 13112     ELSE
 13113        MOVE SPACES              TO CERTIFICATE-NOTE
 13114        MOVE 'CN'                TO CN-RECORD-ID
 13115        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13116                                 TO CN-CONTROL-PRIMARY
 13117                                    ERNOTE-KEY
 13118        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13119                                    CN-BILLING-END-LINE-NO
 13120        IF PI-COMPANY-ID = 'DCC'
 13121           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13122        ELSE
 13123           MOVE WS-VA-NO-COMM-MESS
 13124                                 TO CN-LINE (1)
 13125        END-IF
 13126        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13127        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13128        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13129
 13130* EXEC CICS WRITE
 13131*          DATASET    (FILE-ID-ERNOTE)
 13132*          FROM       (CERTIFICATE-NOTE)
 13133*          RIDFLD     (ERNOTE-KEY)
 13134*          RESP       (WS-RESPONSE)
 13135*       END-EXEC
 13136     MOVE LENGTH OF
 13137      CERTIFICATE-NOTE
 13138       TO DFHEIV11
 13139*    MOVE '&$ L                  ''  N#00011999' TO DFHEIV0
 13140     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13141     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 242
* EL6311.cbl
 13142     MOVE X'204E233030303131393939' TO DFHEIV0(25:11)
 13143     CALL 'kxdfhei1' USING DFHEIV0,
 13144           FILE-ID-ERNOTE,
 13145           CERTIFICATE-NOTE,
 13146           DFHEIV11,
 13147           ERNOTE-KEY,
 13148           DFHEIV99,
 13149           DFHEIV99
 13150     MOVE EIBRESP  TO WS-RESPONSE
 13151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13152     END-IF
 13153     .
 13154 1510-EXIT.
 13155     EXIT.
 13156 1520-UPDATE-ELCERT.
 13157     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13158                                 TO ELCERT-KEY
 13159
 13160* EXEC CICS READ
 13161*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13162*        DATASET (FILE-ID-ELCERT)
 13163*        RIDFLD  (ELCERT-KEY)
 13164*        UPDATE
 13165*        RESP    (WS-RESPONSE)
 13166*    END-EXEC
 13167*    MOVE '&"S        EU         (  N#00012012' TO DFHEIV0
 13168     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13169     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13170     MOVE X'204E233030303132303132' TO DFHEIV0(25:11)
 13171     CALL 'kxdfhei1' USING DFHEIV0,
 13172           FILE-ID-ELCERT,
 13173           DFHEIV20,
 13174           DFHEIV99,
 13175           ELCERT-KEY,
 13176           DFHEIV99,
 13177           DFHEIV99,
 13178           DFHEIV99
 13179     SET ADDRESS OF CERTIFICATE-MASTER TO
 13180         DFHEIV20
 13181     MOVE EIBRESP  TO WS-RESPONSE
 13182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13183     IF RESP-NORMAL
 13184        IF WS-NOTE-SW = 'A'
 13185           IF CM-NOTE-SW = ' '
 13186              MOVE '2'             TO CM-NOTE-SW
 13187           ELSE
 13188             IF CM-NOTE-SW = '1'
 13189                MOVE '3'           TO CM-NOTE-SW
 13190             ELSE
 13191               IF CM-NOTE-SW = '4'
 13192                  MOVE '6'         TO CM-NOTE-SW
 13193               ELSE
 13194                 IF CM-NOTE-SW = '5'
 13195                    MOVE '7'       TO CM-NOTE-SW
 13196                 END-IF
 13197               END-IF
 13198             END-IF
 13199           END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 243
* EL6311.cbl
 13200        ELSE
 13201           IF CM-NOTE-SW = '2'
 13202              MOVE ' '             TO CM-NOTE-SW
 13203           ELSE
 13204             IF CM-NOTE-SW = '3'
 13205                MOVE '1'           TO CM-NOTE-SW
 13206             ELSE
 13207               IF CM-NOTE-SW = '6'
 13208                  MOVE '4'         TO CM-NOTE-SW
 13209               ELSE
 13210                 IF CM-NOTE-SW = '7'
 13211                    MOVE '5'       TO CM-NOTE-SW
 13212                 END-IF
 13213               END-IF
 13214             END-IF
 13215           END-IF
 13216        END-IF
 13217
 13218* EXEC CICS REWRITE
 13219*          DATASET    (FILE-ID-ELCERT)
 13220*          FROM       (CERTIFICATE-MASTER)
 13221*          RESP       (WS-RESPONSE)
 13222*       END-EXEC
 13223     MOVE LENGTH OF
 13224      CERTIFICATE-MASTER
 13225       TO DFHEIV11
 13226*    MOVE '&& L                  %  N#00012053' TO DFHEIV0
 13227     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13228     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13229     MOVE X'204E233030303132303533' TO DFHEIV0(25:11)
 13230     CALL 'kxdfhei1' USING DFHEIV0,
 13231           FILE-ID-ELCERT,
 13232           CERTIFICATE-MASTER,
 13233           DFHEIV11,
 13234           DFHEIV99
 13235     MOVE EIBRESP  TO WS-RESPONSE
 13236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13237        IF RESP-NORMAL
 13238           CONTINUE
 13239        ELSE
 13240           MOVE WS-RESPONSE TO EMI-ERROR
 13241           PERFORM 9900-ERROR-FORMAT
 13242                                 THRU 9900-EXIT
 13243           GO TO 8200-SEND-DATAONLY
 13244        END-IF
 13245     ELSE
 13246        MOVE -1                  TO BMAINTL
 13247        MOVE 0249                TO EMI-ERROR
 13248        PERFORM 9900-ERROR-FORMAT
 13249                                 THRU 9900-EXIT
 13250        GO TO 8200-SEND-DATAONLY
 13251     END-IF
 13252     .
 13253 1520-EXIT.
 13254     EXIT.
 13255 1600-UPDATE-ERPYAJ.
 13256     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13257                                 THRU 1610-EXIT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 244
* EL6311.cbl
 13258     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13259                                 THRU 1620-EXIT
 13260     .
 13261 1600-EXIT.
 13262     EXIT.
 13263 1610-ADD-ERPYAJ-BANK-REC.
 13264
 13265* EXEC CICS GETMAIN
 13266*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13267*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13268*        INITIMG (GETMAIN-SPACE)
 13269*    END-EXEC
 13270*    MOVE ',"IL                  $   #00012085' TO DFHEIV0
 13271     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13272     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13273     MOVE X'2020233030303132303835' TO DFHEIV0(25:11)
 13274     CALL 'kxdfhei1' USING DFHEIV0,
 13275           DFHEIV20,
 13276           ERPYAJ-RECORD-LENGTH,
 13277           GETMAIN-SPACE
 13278     SET ADDRESS OF PENDING-PAY-ADJ TO
 13279         DFHEIV20
 13280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13281     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13282     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13283     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13284     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13285     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13286     MOVE +10                    TO ERPYAJ-SEQ-NO
 13287     MOVE 'R'                    TO ERPYAJ-TYPE
 13288     IF REVERSAL
 13289        MOVE 'C'                 TO ERPYAJ-TYPE
 13290     END-IF
 13291     MOVE SPACES                 TO PENDING-PAY-ADJ
 13292     MOVE 'PY'                   TO PY-RECORD-ID
 13293     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13294     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13295     IF REVERSAL
 13296        MOVE PB-I-DCC-OVER-CHG-AMT
 13297                                 TO PY-ENTRY-AMT
 13298     END-IF
 13299     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13300                                    PY-INPUT-DT
 13301*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13302*                                   PY-INPUT-DT
 13303     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13304     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13305     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13306     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13307     IF PB-CARRIER = '2'
 13308        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13309     ELSE
 13310        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13311     END-IF
 13312     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13313                                    PY-BILLED-DATE
 13314                                    PY-AR-DATE
 13315                                    PY-REPORTED-DT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 245
* EL6311.cbl
 13316                                    PY-CHECK-WRITTEN-DT
 13317     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13318                                    PY-CHECK-QUE-SEQUENCE
 13319     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13320     PERFORM WITH TEST AFTER
 13321        UNTIL (NOT RESP-DUPKEY)
 13322           AND (NOT RESP-DUPREC)
 13323
 13324* EXEC CICS WRITE
 13325*          DATASET    (FILE-ID-ERPYAJ)
 13326*          FROM       (PENDING-PAY-ADJ)
 13327*          RIDFLD     (ERPYAJ-KEY)
 13328*          RESP       (WS-RESPONSE)
 13329*       END-EXEC
 13330     MOVE LENGTH OF
 13331      PENDING-PAY-ADJ
 13332       TO DFHEIV11
 13333*    MOVE '&$ L                  ''  N#00012132' TO DFHEIV0
 13334     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13335     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13336     MOVE X'204E233030303132313332' TO DFHEIV0(25:11)
 13337     CALL 'kxdfhei1' USING DFHEIV0,
 13338           FILE-ID-ERPYAJ,
 13339           PENDING-PAY-ADJ,
 13340           DFHEIV11,
 13341           ERPYAJ-KEY,
 13342           DFHEIV99,
 13343           DFHEIV99
 13344     MOVE EIBRESP  TO WS-RESPONSE
 13345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13346        IF RESP-DUPKEY OR RESP-DUPREC
 13347           ADD +1                TO ERPYAJ-SEQ-NO
 13348           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13349        END-IF
 13350     END-PERFORM
 13351     .
 13352 1610-EXIT.
 13353     EXIT.
 13354 1620-ADD-ERPYAJ-DLR-REC.
 13355     MOVE 'C'                    TO ERPYAJ-TYPE
 13356     IF REVERSAL
 13357        MOVE 'R'                 TO ERPYAJ-TYPE
 13358     END-IF
 13359     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13360                                    ERPYAJ-ACCOUNT
 13361     ADD +1                      TO ERPYAJ-SEQ-NO
 13362     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13363     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13364     IF PB-CARRIER = '2'
 13365        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13366     ELSE
 13367        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13368     END-IF
 13369     PERFORM WITH TEST AFTER
 13370        UNTIL (NOT RESP-DUPKEY)
 13371           AND (NOT RESP-DUPREC)
 13372
 13373* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 246
* EL6311.cbl
 13374*          DATASET    (FILE-ID-ERPYAJ)
 13375*          FROM       (PENDING-PAY-ADJ)
 13376*          RIDFLD     (ERPYAJ-KEY)
 13377*          RESP       (WS-RESPONSE)
 13378*       END-EXEC
 13379     MOVE LENGTH OF
 13380      PENDING-PAY-ADJ
 13381       TO DFHEIV11
 13382*    MOVE '&$ L                  ''  N#00012164' TO DFHEIV0
 13383     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13384     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13385     MOVE X'204E233030303132313634' TO DFHEIV0(25:11)
 13386     CALL 'kxdfhei1' USING DFHEIV0,
 13387           FILE-ID-ERPYAJ,
 13388           PENDING-PAY-ADJ,
 13389           DFHEIV11,
 13390           ERPYAJ-KEY,
 13391           DFHEIV99,
 13392           DFHEIV99
 13393     MOVE EIBRESP  TO WS-RESPONSE
 13394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13395        IF RESP-DUPKEY OR RESP-DUPREC
 13396           ADD +1                TO ERPYAJ-SEQ-NO
 13397           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13398        END-IF
 13399     END-PERFORM
 13400     .
 13401 1620-EXIT.
 13402     EXIT.
 13403 1700-SQUEEZE-IT-IN.
 13404     IF (N1 > CN-BILLING-END-LINE-NO)
 13405        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13406           N1 = +1
 13407           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13408           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13409              IF PI-COMPANY-ID = 'DCC'
 13410                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13411              ELSE
 13412                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13413              END-IF
 13414              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13415              MOVE +2 TO N1
 13416           END-IF
 13417        END-PERFORM
 13418     ELSE
 13419        IF (N1 < CN-BILLING-START-LINE-NO)
 13420           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13421              N1 = +10
 13422              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13423              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13424                 IF PI-COMPANY-ID = 'DCC'
 13425                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13426                 ELSE
 13427                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13428                 END-IF
 13429                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13430                 MOVE +9 TO N1
 13431              END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 247
* EL6311.cbl
 13432           END-PERFORM
 13433        END-IF
 13434     END-IF
 13435     .
 13436 1700-EXIT.
 13437     EXIT.
 13438 1800-REMOVE-CERT-NOTES.
 13439     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13440                                 TO ERNOTE-KEY
 13441
 13442* EXEC CICS READ
 13443*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13444*       DATASET    (FILE-ID-ERNOTE)
 13445*       RIDFLD     (ERNOTE-KEY)
 13446*       RESP       (WS-RESPONSE)
 13447*       UPDATE
 13448*    END-EXEC
 13449*    MOVE '&"S        EU         (  N#00012216' TO DFHEIV0
 13450     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13451     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13452     MOVE X'204E233030303132323136' TO DFHEIV0(25:11)
 13453     CALL 'kxdfhei1' USING DFHEIV0,
 13454           FILE-ID-ERNOTE,
 13455           DFHEIV20,
 13456           DFHEIV99,
 13457           ERNOTE-KEY,
 13458           DFHEIV99,
 13459           DFHEIV99,
 13460           DFHEIV99
 13461     SET ADDRESS OF CERTIFICATE-NOTE TO
 13462         DFHEIV20
 13463     MOVE EIBRESP  TO WS-RESPONSE
 13464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13465     IF RESP-NORMAL
 13466        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13467           (N1 > +10)
 13468           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13469           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13470        END-PERFORM
 13471        IF N1 < +11
 13472           MOVE SPACES              TO CN-LINE (N1)
 13473           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13474              N1 <= CN-BILLING-END-LINE-NO
 13475              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13476              IF CN-BILLING-END-LINE-NO <
 13477                               CN-BILLING-START-LINE-NO
 13478                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13479                                     CN-BILLING-START-LINE-NO
 13480              END-IF
 13481              PERFORM 1820-SQUEEZE-ERNOTE
 13482                                  THRU 1820-EXIT
 13483           END-IF
 13484           IF CN-LINES = SPACES
 13485
 13486* EXEC CICS DELETE
 13487*                DATASET    (FILE-ID-ERNOTE)
 13488*                RESP       (WS-RESPONSE)
 13489*             END-EXEC
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 248
* EL6311.cbl
 13490*    MOVE '&(                    &  N#00012243' TO DFHEIV0
 13491     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13492     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13493     MOVE X'204E233030303132323433' TO DFHEIV0(25:11)
 13494     CALL 'kxdfhei1' USING DFHEIV0,
 13495           FILE-ID-ERNOTE,
 13496           DFHEIV99,
 13497           DFHEIV99,
 13498           DFHEIV99,
 13499           DFHEIV99
 13500     MOVE EIBRESP  TO WS-RESPONSE
 13501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13502              IF RESP-NORMAL
 13503                 MOVE 'D'        TO WS-NOTE-SW
 13504                 PERFORM 1520-UPDATE-ELCERT
 13505                                 THRU 1520-EXIT
 13506              END-IF
 13507           ELSE
 13508
 13509* EXEC CICS REWRITE
 13510*                DATASET    (FILE-ID-ERNOTE)
 13511*                FROM       (CERTIFICATE-NOTE)
 13512*                RESP       (WS-RESPONSE)
 13513*             END-EXEC
 13514     MOVE LENGTH OF
 13515      CERTIFICATE-NOTE
 13516       TO DFHEIV11
 13517*    MOVE '&& L                  %  N#00012253' TO DFHEIV0
 13518     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13519     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13520     MOVE X'204E233030303132323533' TO DFHEIV0(25:11)
 13521     CALL 'kxdfhei1' USING DFHEIV0,
 13522           FILE-ID-ERNOTE,
 13523           CERTIFICATE-NOTE,
 13524           DFHEIV11,
 13525           DFHEIV99
 13526     MOVE EIBRESP  TO WS-RESPONSE
 13527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13528           END-IF
 13529        END-IF
 13530     END-IF
 13531     .
 13532 1800-EXIT.
 13533     EXIT.
 13534 1820-SQUEEZE-ERNOTE.
 13535     MOVE CN-BILLING-START-LINE-NO TO N2
 13536     IF N2 = 0
 13537         MOVE +1                 TO N2
 13538     END-IF
 13539     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13540        (N1 > +9)
 13541        IF CN-LINE (N1) = SPACES
 13542           MOVE CN-LINE (N1 + +1)
 13543                                 TO CN-LINE (N1)
 13544           MOVE SPACES           TO CN-LINE (N1 + +1)
 13545        END-IF
 13546     END-PERFORM
 13547     .
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 249
* EL6311.cbl
 13548 1820-EXIT.
 13549     EXIT.
 13550 1900-DELETE-ERPYAJ.
 13551     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13552     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13553     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13554     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13555     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13556     MOVE +10                    TO ERPYAJ-SEQ-NO
 13557     MOVE 'R'                    TO ERPYAJ-TYPE
 13558     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13559
 13560* EXEC CICS STARTBR
 13561*       DATASET    (FILE-ID-ERPYAJ)
 13562*       RIDFLD     (ERPYAJ-KEY)
 13563*       RESP       (WS-RESPONSE)
 13564*    END-EXEC
 13565     MOVE 0
 13566       TO DFHEIV11
 13567*    MOVE '&,         G          &  N#00012289' TO DFHEIV0
 13568     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13569     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13570     MOVE X'204E233030303132323839' TO DFHEIV0(25:11)
 13571     CALL 'kxdfhei1' USING DFHEIV0,
 13572           FILE-ID-ERPYAJ,
 13573           ERPYAJ-KEY,
 13574           DFHEIV99,
 13575           DFHEIV11,
 13576           DFHEIV99
 13577     MOVE EIBRESP  TO WS-RESPONSE
 13578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13579     IF RESP-NORMAL
 13580        CONTINUE
 13581     ELSE
 13582        GO TO 1900-GET-DEALER
 13583     END-IF
 13584     .
 13585 1900-READNEXT-ERPYAJ-B.
 13586*  GET THE BANK ERPYAJ RECORD
 13587
 13588* EXEC CICS READNEXT
 13589*       DATASET    (FILE-ID-ERPYAJ)
 13590*       RIDFLD     (ERPYAJ-KEY)
 13591*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13592*       RESP       (WS-RESPONSE)
 13593*    END-EXEC
 13594     MOVE 0
 13595       TO DFHEIV11
 13596*    MOVE '&.S                   )  N#00012302' TO DFHEIV0
 13597     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13598     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13599     MOVE X'204E233030303132333032' TO DFHEIV0(25:11)
 13600     CALL 'kxdfhei1' USING DFHEIV0,
 13601           FILE-ID-ERPYAJ,
 13602           DFHEIV20,
 13603           DFHEIV99,
 13604           ERPYAJ-KEY,
 13605           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 250
* EL6311.cbl
 13606           DFHEIV11,
 13607           DFHEIV99,
 13608           DFHEIV99
 13609     SET ADDRESS OF PENDING-PAY-ADJ TO
 13610         DFHEIV20
 13611     MOVE EIBRESP  TO WS-RESPONSE
 13612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13613     IF RESP-NORMAL
 13614        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13615           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13616              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13617                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13618
 13619* EXEC CICS READ
 13620*                   DATASET    (FILE-ID-ERPYAJ)
 13621*                   RIDFLD     (ERPYAJ-KEY)
 13622*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13623*                   RESP       (WS-RESPONSE)
 13624*                   UPDATE
 13625*                END-EXEC
 13626*    MOVE '&"S        EU         (  N#00012313' TO DFHEIV0
 13627     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13628     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13629     MOVE X'204E233030303132333133' TO DFHEIV0(25:11)
 13630     CALL 'kxdfhei1' USING DFHEIV0,
 13631           FILE-ID-ERPYAJ,
 13632           DFHEIV20,
 13633           DFHEIV99,
 13634           ERPYAJ-KEY,
 13635           DFHEIV99,
 13636           DFHEIV99,
 13637           DFHEIV99
 13638     SET ADDRESS OF PENDING-PAY-ADJ TO
 13639         DFHEIV20
 13640     MOVE EIBRESP  TO WS-RESPONSE
 13641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13642                 IF RESP-NORMAL
 13643
 13644* EXEC CICS DELETE
 13645*                      DATASET   (FILE-ID-ERPYAJ)
 13646*                      RESP      (WS-RESPONSE)
 13647*                   END-EXEC
 13648*    MOVE '&(                    &  N#00012321' TO DFHEIV0
 13649     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13650     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13651     MOVE X'204E233030303132333231' TO DFHEIV0(25:11)
 13652     CALL 'kxdfhei1' USING DFHEIV0,
 13653           FILE-ID-ERPYAJ,
 13654           DFHEIV99,
 13655           DFHEIV99,
 13656           DFHEIV99,
 13657           DFHEIV99
 13658     MOVE EIBRESP  TO WS-RESPONSE
 13659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13660                 END-IF
 13661              ELSE
 13662                 SET REVERSAL    TO TRUE
 13663                 PERFORM 1600-UPDATE-ERPYAJ
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 251
* EL6311.cbl
 13664                                 THRU 1600-EXIT
 13665                 GO TO 1900-EXIT
 13666              END-IF
 13667           ELSE
 13668              GO TO 1900-READNEXT-ERPYAJ-B
 13669           END-IF
 13670        END-IF
 13671
 13672* EXEC CICS ENDBR
 13673*          DATASET   (FILE-ID-ERPYAJ)
 13674*       END-EXEC
 13675     MOVE 0
 13676       TO DFHEIV11
 13677*    MOVE '&2                    $   #00012336' TO DFHEIV0
 13678     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13679     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13680     MOVE X'2020233030303132333336' TO DFHEIV0(25:11)
 13681     CALL 'kxdfhei1' USING DFHEIV0,
 13682           FILE-ID-ERPYAJ,
 13683           DFHEIV11,
 13684           DFHEIV99
 13685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13686     END-IF
 13687     .
 13688 1900-GET-DEALER.
 13689     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13690     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13691     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13692     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13693     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13694     MOVE +10                    TO ERPYAJ-SEQ-NO
 13695     MOVE 'C'                    TO ERPYAJ-TYPE
 13696     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13697
 13698* EXEC CICS STARTBR
 13699*       DATASET    (FILE-ID-ERPYAJ)
 13700*       RIDFLD     (ERPYAJ-KEY)
 13701*       RESP       (WS-RESPONSE)
 13702*    END-EXEC
 13703     MOVE 0
 13704       TO DFHEIV11
 13705*    MOVE '&,         G          &  N#00012350' TO DFHEIV0
 13706     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13707     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13708     MOVE X'204E233030303132333530' TO DFHEIV0(25:11)
 13709     CALL 'kxdfhei1' USING DFHEIV0,
 13710           FILE-ID-ERPYAJ,
 13711           ERPYAJ-KEY,
 13712           DFHEIV99,
 13713           DFHEIV11,
 13714           DFHEIV99
 13715     MOVE EIBRESP  TO WS-RESPONSE
 13716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13717     IF RESP-NORMAL
 13718        CONTINUE
 13719     ELSE
 13720        GO TO 1900-EXIT
 13721     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 252
* EL6311.cbl
 13722     .
 13723 1900-READNEXT-ERPYAJ-D.
 13724*  GET THE DEALER ERPYAJ RECORD
 13725
 13726* EXEC CICS READNEXT
 13727*       DATASET    (FILE-ID-ERPYAJ)
 13728*       RIDFLD     (ERPYAJ-KEY)
 13729*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13730*       RESP       (WS-RESPONSE)
 13731*    END-EXEC
 13732     MOVE 0
 13733       TO DFHEIV11
 13734*    MOVE '&.S                   )  N#00012363' TO DFHEIV0
 13735     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13736     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13737     MOVE X'204E233030303132333633' TO DFHEIV0(25:11)
 13738     CALL 'kxdfhei1' USING DFHEIV0,
 13739           FILE-ID-ERPYAJ,
 13740           DFHEIV20,
 13741           DFHEIV99,
 13742           ERPYAJ-KEY,
 13743           DFHEIV99,
 13744           DFHEIV11,
 13745           DFHEIV99,
 13746           DFHEIV99
 13747     SET ADDRESS OF PENDING-PAY-ADJ TO
 13748         DFHEIV20
 13749     MOVE EIBRESP  TO WS-RESPONSE
 13750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13751     IF RESP-NORMAL
 13752        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13753           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13754              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13755                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13756
 13757* EXEC CICS READ
 13758*                   DATASET    (FILE-ID-ERPYAJ)
 13759*                   RIDFLD     (ERPYAJ-KEY)
 13760*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13761*                   RESP       (WS-RESPONSE)
 13762*                   UPDATE
 13763*                END-EXEC
 13764*    MOVE '&"S        EU         (  N#00012374' TO DFHEIV0
 13765     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13766     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13767     MOVE X'204E233030303132333734' TO DFHEIV0(25:11)
 13768     CALL 'kxdfhei1' USING DFHEIV0,
 13769           FILE-ID-ERPYAJ,
 13770           DFHEIV20,
 13771           DFHEIV99,
 13772           ERPYAJ-KEY,
 13773           DFHEIV99,
 13774           DFHEIV99,
 13775           DFHEIV99
 13776     SET ADDRESS OF PENDING-PAY-ADJ TO
 13777         DFHEIV20
 13778     MOVE EIBRESP  TO WS-RESPONSE
 13779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 253
* EL6311.cbl
 13780                 IF RESP-NORMAL
 13781
 13782* EXEC CICS DELETE
 13783*                      DATASET   (FILE-ID-ERPYAJ)
 13784*                      RESP      (WS-RESPONSE)
 13785*                   END-EXEC
 13786*    MOVE '&(                    &  N#00012382' TO DFHEIV0
 13787     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13788     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13789     MOVE X'204E233030303132333832' TO DFHEIV0(25:11)
 13790     CALL 'kxdfhei1' USING DFHEIV0,
 13791           FILE-ID-ERPYAJ,
 13792           DFHEIV99,
 13793           DFHEIV99,
 13794           DFHEIV99,
 13795           DFHEIV99
 13796     MOVE EIBRESP  TO WS-RESPONSE
 13797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13798                 END-IF
 13799              ELSE
 13800                 SET REVERSAL    TO TRUE
 13801              END-IF
 13802           ELSE
 13803              GO TO 1900-READNEXT-ERPYAJ-D
 13804           END-IF
 13805        END-IF
 13806
 13807* EXEC CICS ENDBR
 13808*          DATASET   (FILE-ID-ERPYAJ)
 13809*       END-EXEC
 13810     MOVE 0
 13811       TO DFHEIV11
 13812*    MOVE '&2                    $   #00012394' TO DFHEIV0
 13813     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13814     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13815     MOVE X'2020233030303132333934' TO DFHEIV0(25:11)
 13816     CALL 'kxdfhei1' USING DFHEIV0,
 13817           FILE-ID-ERPYAJ,
 13818           DFHEIV11,
 13819           DFHEIV99
 13820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13821     END-IF
 13822     .
 13823 1900-EXIT.
 13824     EXIT.
 13825******************************************************************
 13826*            C A N C E L   M A I N L I N E                       *
 13827******************************************************************
 13828
 13829 2000-CANCEL-MAINLINE.
 13830     IF PI-DISPLAY-ORIGINAL-BATCH
 13831        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 13832           MOVE ER-0023             TO EMI-ERROR
 13833           MOVE -1                  TO CMAINTL
 13834           MOVE AL-UABON            TO CMAINTA
 13835           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13836           GO TO 8200-SEND-DATAONLY
 13837        ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 254
* EL6311.cbl
 13838           NEXT SENTENCE
 13839     ELSE
 13840        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 13841           MOVE ER-0023             TO EMI-ERROR
 13842           MOVE -1                  TO CMAINTL
 13843           MOVE AL-UABON            TO CMAINTA
 13844           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13845           GO TO 8200-SEND-DATAONLY.
 13846
 13847     IF CMAINTI = 'S'
 13848        GO TO 2100-SHOW-REQUEST.
 13849
 13850     IF NOT MODIFY-CAP
 13851         MOVE 'UPDATE'       TO SM-READ
 13852         PERFORM 9995-SECURITY-VIOLATION
 13853         MOVE ER-0070        TO EMI-ERROR
 13854         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13855         GO TO 8100-SEND-INITIAL-MAP.
 13856
 13857     IF CMAINTL GREATER THAN ZEROS
 13858        IF PI-PF6-FUNCTION
 13859           IF CMAINTI NOT = 'A'
 13860              MOVE AL-UABON  TO CMAINTA
 13861              MOVE -1        TO CMAINTL
 13862              MOVE ER-2260   TO EMI-ERROR
 13863              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13864              GO TO 8200-SEND-DATAONLY.
 13865
 13866     IF CCERTNOL = ZEROS
 13867       AND (CMAINTI = 'C' OR 'K' OR 'D')
 13868         NEXT SENTENCE
 13869     ELSE
 13870         IF CCERTNOL NOT = ZEROS
 13871             MOVE AL-UANON       TO CCERTNOA
 13872         ELSE
 13873             MOVE -1             TO CCERTNOL
 13874             MOVE  1             TO SET-CURSOR-SW
 13875             MOVE ER-2218       TO EMI-ERROR
 13876             MOVE AL-UABON       TO CCERTNOA
 13877             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13878
 13879     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 13880        NEXT SENTENCE
 13881     ELSE
 13882        IF CEFFDTL NOT = ZEROS
 13883           MOVE AL-UNNON         TO CEFFDTA
 13884           MOVE CEFFDTI TO DEEDIT-FIELD
 13885           PERFORM 8600-DEEDIT
 13886           MOVE 4                TO DC-OPTION-CODE
 13887           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13888           PERFORM 9700-DATE-LINK
 13889           IF NO-CONVERSION-ERROR
 13890              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 13891              ELSE
 13892              MOVE -1            TO CEFFDTL
 13893              MOVE  1            TO SET-CURSOR-SW
 13894              MOVE ER-2226      TO EMI-ERROR
 13895              MOVE AL-UNBON      TO CEFFDTA
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 255
* EL6311.cbl
 13896              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13897          ELSE
 13898          MOVE -1                 TO CEFFDTL
 13899          MOVE  1                 TO SET-CURSOR-SW
 13900          MOVE ER-2220            TO EMI-ERROR
 13901          MOVE AL-UNBON           TO CEFFDTA
 13902          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13903
 13904     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 13905
 13906     IF CCERTNOL NOT = ZEROS
 13907        MOVE CCERTNOI                TO WS-NEW-PRIME
 13908     ELSE
 13909        MOVE SPACES                  TO WS-NEW-PRIME.
 13910
 13911     IF CSUFIXL NOT = ZEROS
 13912        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 13913     ELSE
 13914        MOVE SPACE                   TO WS-NEW-SUFFIX.
 13915
 13916     IF CEFFDTL NOT = ZEROS
 13917        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 13918     ELSE
 13919        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 13920
 13921     IF CMAINTI = 'A' OR 'K' OR 'S'
 13922        NEXT SENTENCE
 13923     ELSE
 13924        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 13925        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 13926           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 13927           WS-PB-RECORD-TYPE NOT = '2'
 13928           IF CMAINTI = 'C'
 13929              MOVE ER-2287          TO EMI-ERROR
 13930              MOVE -1               TO CCERTNOL
 13931              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 13932              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13933              GO TO 8200-SEND-DATAONLY
 13934             ELSE
 13935              MOVE ER-2260          TO EMI-ERROR
 13936              MOVE -1               TO CCERTNOL
 13937              MOVE AL-UABON         TO CCERTNOA
 13938              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13939              GO TO 8200-SEND-DATAONLY.
 13940
 13941     IF CMAINTI = 'D'
 13942        GO TO 2400-DELETE-CANCEL-ROUTINE.
 13943
 13944     IF CLSTNML GREATER THAN ZEROS
 13945         MOVE AL-UANON           TO CLSTNMA.
 13946
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 256
* EL6311.cbl
 13948
 13949******************************************************************
 13950*                                                                *
 13951*           E D I T   C A N C E L   C O V E R A G E S            *
 13952*                                                                *
 13953******************************************************************
 13954
 13955 2015-EDIT-COVERAGES.
 13956     IF CCANDT1L      GREATER THAN ZEROS OR
 13957        CREFND1L      GREATER THAN ZEROS OR
 13958        CCANDT2L      GREATER THAN ZEROS OR
 13959        CREFND2L      GREATER THAN ZEROS OR
 13960        CMTHD1L       GREATER THAN ZEROS OR
 13961        CMTHD2L       GREATER THAN ZEROS OR
 13962        CLIVESL       GREATER THAN ZEROS OR
 13963        CPAYEEL       GREATER THAN ZEROS OR
 13964        CFORCEL       GREATER THAN ZEROS OR
 13965        CBILCDL       GREATER THAN ZEROS OR
 13966        CCANREAL      GREATER THAN ZEROS
 13967            NEXT SENTENCE
 13968         ELSE
 13969            GO TO 2030-EDIT-COMPLETE.
 13970
 13971     IF CCANDT1L = ZEROS
 13972        AND (CMAINTI = 'C' OR 'K')
 13973        NEXT SENTENCE
 13974     ELSE
 13975        IF CCANDT1L      GREATER THAN ZEROS
 13976            MOVE AL-UNNON            TO CCANDT1A
 13977            IF CCANDT1I = SPACES
 13978               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 13979            ELSE
 13980               MOVE CCANDT1I            TO DEEDIT-FIELD
 13981               PERFORM 8600-DEEDIT
 13982               IF DEEDIT-FIELD-V0   NUMERIC
 13983                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13984                  MOVE 4                TO DC-OPTION-CODE
 13985                  PERFORM 9700-DATE-LINK
 13986                  IF NO-CONVERSION-ERROR
 13987                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 13988                  ELSE
 13989                      MOVE -1        TO CCANDT1L
 13990                      MOVE ER-2227   TO EMI-ERROR
 13991                      MOVE AL-UNBON  TO CCANDT1A
 13992                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13993               ELSE
 13994                  MOVE -1         TO CCANDT1L
 13995                  MOVE ER-2223    TO EMI-ERROR
 13996                  MOVE AL-UNBON   TO CCANDT1A
 13997                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13998        ELSE
 13999            IF CREFND1L GREATER THAN ZEROS
 14000               MOVE -1             TO CCANDT1L
 14001               MOVE ER-2222        TO EMI-ERROR
 14002               MOVE AL-UNBOF       TO CCANDT1A
 14003               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14004
 14005     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 257
* EL6311.cbl
 14006        AND (CMAINTI = 'C' OR 'K')
 14007         NEXT SENTENCE
 14008     ELSE
 14009         IF CREFND1L NOT = ZEROS
 14010            MOVE AL-UNNON        TO CREFND1A
 14011
 14012* EXEC CICS BIF DEEDIT
 14013*               FIELD  (CREFND1I)
 14014*               LENGTH (11)
 14015*           END-EXEC
 14016     MOVE 11
 14017       TO DFHEIV11
 14018*    MOVE '@"L                   #   #00012587' TO DFHEIV0
 14019     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14020     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14021     MOVE X'2020233030303132353837' TO DFHEIV0(25:11)
 14022     CALL 'kxdfhei1' USING DFHEIV0,
 14023           CREFND1I,
 14024           DFHEIV11
 14025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14026            MOVE CREFND1I        TO WS-CREFND1
 14027*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14028*           PERFORM 8600-DEEDIT
 14029*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14030            IF WS-CREFND1  = ZEROS
 14031               AND CMAINTI = 'A'
 14032             MOVE ER-2437        TO EMI-ERROR
 14033             MOVE -1             TO CREFND1L
 14034             MOVE AL-UNBON       TO CREFND1A
 14035             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14036
 14037     IF CCANREAL > +0
 14038        MOVE AL-UANON            TO CCANREAA
 14039        IF CCANREAI = 'R' OR ' '
 14040           CONTINUE
 14041        ELSE
 14042           MOVE ER-9841        TO EMI-ERROR
 14043           MOVE -1             TO CCANREAL
 14044           MOVE AL-UABON       TO CCANREAA
 14045           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14046        END-IF
 14047     END-IF
 14048     IF CMTHD1L EQUAL +0
 14049        NEXT SENTENCE
 14050     ELSE
 14051        IF CMTHD1L NOT = +0
 14052           MOVE AL-UNNON        TO CMTHD1A
 14053           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14054                         OR '5' OR '6' OR '8' OR '9'
 14055                         OR 'R' OR ' '
 14056              NEXT SENTENCE
 14057           ELSE
 14058              MOVE ER-0582        TO EMI-ERROR
 14059              MOVE -1             TO CMTHD1L
 14060              MOVE AL-UNBON       TO CMTHD1A
 14061              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14062
 14063     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 258
* EL6311.cbl
 14064        AND (CMAINTI = 'C' OR 'K')
 14065         NEXT SENTENCE
 14066     ELSE
 14067         IF CCANDT2L  GREATER THAN ZEROS
 14068             MOVE AL-UNNON       TO CCANDT2A
 14069             IF CCANDT2I = SPACES
 14070                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14071             ELSE
 14072                MOVE CCANDT2I       TO DEEDIT-FIELD
 14073                PERFORM 8600-DEEDIT
 14074                IF DEEDIT-FIELD-V0   NUMERIC
 14075                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14076                   MOVE 4                TO DC-OPTION-CODE
 14077                   PERFORM 9700-DATE-LINK
 14078                   IF NO-CONVERSION-ERROR
 14079                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14080                   ELSE
 14081                      MOVE -1       TO CCANDT2L
 14082                      MOVE ER-2227  TO EMI-ERROR
 14083                      MOVE AL-UNBON TO CCANDT2A
 14084                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14085                ELSE
 14086                   MOVE -1         TO CCANDT2L
 14087                   MOVE ER-2223    TO EMI-ERROR
 14088                   MOVE AL-UNBON   TO CCANDT2A
 14089                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14090         ELSE
 14091            IF CREFND2L GREATER THAN ZEROS
 14092               MOVE -1             TO CCANDT2L
 14093               MOVE ER-2222        TO EMI-ERROR
 14094               MOVE AL-UNBOF       TO CCANDT2A
 14095               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14096
 14097     IF CREFND2L = ZEROS
 14098        AND (CMAINTI = 'C' OR 'K')
 14099         NEXT SENTENCE
 14100     ELSE
 14101         IF CREFND2L NOT = ZEROS
 14102            MOVE AL-UNNON        TO CREFND2A
 14103
 14104* EXEC CICS BIF DEEDIT
 14105*               FIELD  (CREFND2I)
 14106*               LENGTH (11)
 14107*           END-EXEC
 14108     MOVE 11
 14109       TO DFHEIV11
 14110*    MOVE '@"L                   #   #00012668' TO DFHEIV0
 14111     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14112     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14113     MOVE X'2020233030303132363638' TO DFHEIV0(25:11)
 14114     CALL 'kxdfhei1' USING DFHEIV0,
 14115           CREFND2I,
 14116           DFHEIV11
 14117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14118            MOVE CREFND2I        TO WS-CREFND2
 14119*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14120*           PERFORM 8600-DEEDIT
 14121*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 259
* EL6311.cbl
 14122            IF WS-CREFND2  = ZEROS
 14123               AND CMAINTI = 'A'
 14124             MOVE ER-2437        TO EMI-ERROR
 14125             MOVE -1             TO CREFND2L
 14126             MOVE AL-UNBON       TO CREFND2A
 14127             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14128
 14129     IF CMTHD2L EQUAL +0
 14130        NEXT SENTENCE
 14131     ELSE
 14132        IF CMTHD2L NOT = +0
 14133           MOVE AL-UNNON        TO CMTHD2A
 14134           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14135                         OR '5' OR '6' OR '8' OR '9'
 14136                         OR ' ' OR 'R'
 14137              NEXT SENTENCE
 14138           ELSE
 14139              MOVE ER-0582        TO EMI-ERROR
 14140              MOVE -1             TO CMTHD2L
 14141              MOVE AL-UNBON       TO CMTHD2A
 14142              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14143
 14144     IF CLIVESL GREATER THAN ZEROS
 14145         MOVE CLIVESI            TO DEEDIT-FIELD
 14146         PERFORM 8600-DEEDIT
 14147         IF DEEDIT-FIELD-V0 NUMERIC
 14148             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14149             MOVE AL-UNNON       TO CLIVESA
 14150         ELSE
 14151             MOVE -1             TO CLIVESL
 14152             MOVE AL-UNBON       TO CLIVESA
 14153             MOVE ER-2223        TO EMI-ERROR
 14154             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14155
 14156     IF CFORCEL  NOT = ZEROS
 14157         IF FORCE-CAP
 14158            MOVE AL-UANON            TO CFORCEA
 14159         ELSE
 14160            MOVE ER-2945             TO EMI-ERROR
 14161            MOVE AL-UABON            TO CFORCEA
 14162            MOVE -1                  TO CFORCEL
 14163            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14164
 14165     IF CPAYEEL GREATER THAN ZEROS
 14166        MOVE AL-UANON            TO CPAYEEA.
 14167
 14168     IF CBILCDL NOT = ZEROS
 14169        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14170                             AND 'A' AND 'B' AND 'E'
 14171           MOVE ER-2225              TO EMI-ERROR
 14172           MOVE AL-UABON             TO CBILCDA
 14173           MOVE -1                   TO CBILCDL
 14174           MOVE  1                   TO SET-CURSOR-SW
 14175           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14176        ELSE
 14177           MOVE AL-UANON             TO CBILCDA.
 14178
 14179 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 260
* EL6311.cbl
 14180     IF EMI-ERROR = ZEROS
 14181         NEXT SENTENCE
 14182     ELSE
 14183         GO TO 8200-SEND-DATAONLY.
 14184
 14185     IF CMAINTI = 'A'
 14186        GO TO 2200-ADD-CANCEL-ROUTINE.
 14187
 14188     IF CMAINTI = 'C'
 14189        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14190
 14191     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14192
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 261
* EL6311.cbl
 14194
 14195******************************************************************
 14196*                                                                *
 14197*                   S H O W   C A N C E L                        *
 14198*                                                                *
 14199******************************************************************
 14200
 14201 2100-SHOW-REQUEST.
 14202     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14203
 14204     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14205        MOVE -1                  TO CMAINTL
 14206        GO TO 8200-SEND-DATAONLY.
 14207
 14208     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14209
 14210     IF CSUFIXL NOT = ZEROS
 14211        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14212       ELSE
 14213        MOVE SPACE            TO WS-NEW-SUFFIX.
 14214
 14215     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14216     PERFORM 8600-DEEDIT.
 14217     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14218     MOVE '4'                    TO DC-OPTION-CODE.
 14219     PERFORM 9700-DATE-LINK.
 14220     IF DATE-CONVERSION-ERROR
 14221        MOVE ER-0348             TO EMI-ERROR
 14222        MOVE -1                  TO CEFFDTL
 14223        MOVE AL-UABON            TO CEFFDTA
 14224        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14225        GO TO 8200-SEND-DATAONLY
 14226     ELSE
 14227        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14228        MOVE AL-UANON            TO CEFFDTA
 14229        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14230
 14231     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14232
 14233     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14234        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14235        MOVE 'Y'                    TO WS-SHOW-SW
 14236        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14237           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14238        ELSE
 14239           IF PI-FILE-BROWSE
 14240              GO TO 4300-BROWSE-FILE-FORWARD
 14241           ELSE
 14242              IF PI-CSR-BROWSE
 14243                 GO TO 4200-BROWSE-CSR-FORWARD
 14244              ELSE
 14245                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14246     ELSE
 14247        GO TO 3900-RE-DISPLAY-RECORD.
 14248
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 262
* EL6311.cbl
 14250
 14251
 14252******************************************************************
 14253*                                                                *
 14254*            A D D   C A N C E L   R O U T I N E                 *
 14255*                                                                *
 14256******************************************************************
 14257
 14258 2200-ADD-CANCEL-ROUTINE.
 14259     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14260
 14261
 14262* EXEC CICS GETMAIN
 14263*        SET     (ADDRESS OF PENDING-BUSINESS)
 14264*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14265*    END-EXEC.
 14266*    MOVE '," L                  $   #00012815' TO DFHEIV0
 14267     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14268     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14269     MOVE X'2020233030303132383135' TO DFHEIV0(25:11)
 14270     CALL 'kxdfhei1' USING DFHEIV0,
 14271           DFHEIV20,
 14272           ERPNDB-RECORD-LENGTH,
 14273           DFHEIV99
 14274     SET ADDRESS OF PENDING-BUSINESS TO
 14275         DFHEIV20
 14276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14277
 14278
 14279
 14280* EXEC CICS HANDLE CONDITION
 14281*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14282*    END-EXEC.
 14283*    MOVE '"$I                   ! 3 #00012820' TO DFHEIV0
 14284     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14285     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14286     MOVE X'3320233030303132383230' TO DFHEIV0(25:11)
 14287     CALL 'kxdfhei1' USING DFHEIV0
 14288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14289
 14290
 14291     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14292     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14293     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14294
 14295
 14296* EXEC CICS READ
 14297*        INTO    (PENDING-BUSINESS)
 14298*        DATASET (FILE-ID-ERPNDB)
 14299*        RIDFLD  (ERPNDB-KEY)
 14300*    END-EXEC.
 14301     MOVE LENGTH OF
 14302      PENDING-BUSINESS
 14303       TO DFHEIV11
 14304*    MOVE '&"IL       E          (   #00012828' TO DFHEIV0
 14305     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14306     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14307     MOVE X'2020233030303132383238' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 263
* EL6311.cbl
 14308     CALL 'kxdfhei1' USING DFHEIV0,
 14309           FILE-ID-ERPNDB,
 14310           PENDING-BUSINESS,
 14311           DFHEIV11,
 14312           ERPNDB-KEY,
 14313           DFHEIV99,
 14314           DFHEIV99,
 14315           DFHEIV99
 14316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14317
 14318
 14319     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14320
 14321     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14322     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14323     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14324     MOVE SPACES                 TO PENDING-BUSINESS.
 14325     MOVE 'PB'                   TO PB-RECORD-ID.
 14326     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14327     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14328     MOVE SPACES                 TO PB-CERT-SFX.
 14329     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14330     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14331                                    PB-ALT-CHG-SEQ-NO.
 14332
 14333     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14334     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14335     MOVE '2'                    TO PB-RECORD-TYPE.
 14336
 14337     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14338     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14339
 14340
 14341     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14342                                    PB-ALT-CHG-SEQ-NO
 14343                                    PB-C-LF-REF-CALC
 14344                                    PB-C-AH-REF-CALC
 14345                                    PB-C-LF-RFND-CLP
 14346                                    PB-C-AH-RFND-CLP
 14347                                    PB-CI-INSURED-AGE
 14348                                    PB-CI-LF-TERM
 14349                                    PB-CI-AH-TERM
 14350                                    PB-CI-LF-BENEFIT-CD
 14351                                    PB-CI-LF-BENEFIT-AMT
 14352                                    PB-CI-LF-ALT-BENEFIT-AMT
 14353                                    PB-CI-LF-PREMIUM-AMT
 14354                                    PB-CI-LF-ALT-PREMIUM-AMT
 14355                                    PB-CI-AH-BENEFIT-CD
 14356                                    PB-CI-AH-BENEFIT-AMT
 14357                                    PB-CI-AH-PREMIUM-AMT
 14358                                    PB-CI-PAY-FREQUENCY
 14359                                    PB-CI-LOAN-APR
 14360                                    PB-CI-LOAN-TERM
 14361                                    PB-CI-LIFE-COMMISSION
 14362                                    PB-CI-AH-COMMISSION
 14363                                    PB-CI-CURR-SEQ
 14364                                    PB-CI-AH-CANCEL-AMT
 14365                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 264
* EL6311.cbl
 14366                                    PB-CI-RATE-DEV-PCT-LF
 14367                                    PB-CI-RATE-DEV-PCT-AH
 14368                                    PB-CI-EXTENTION-DAYS
 14369                                    PB-CI-TERM-IN-DAYS
 14370                                    PB-CI-LIVES
 14371                                    PB-CI-LF-CRIT-PER
 14372                                    PB-CI-AH-CRIT-PER
 14373                                    PB-C-LF-REM-TERM
 14374                                    PB-C-AH-REM-TERM
 14375                                    PB-CHG-COUNT
 14376                                    PB-LF-BILLED-AMTS
 14377                                    PB-AH-BILLED-AMTS
 14378                                    PB-C-NH-INT-ON-REFS
 14379*                                   PB-C-MICROFILM-NO
 14380                                    PB-CALC-TOLERANCE.
 14381
 14382     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14383                                    PB-CI-AH-SETTLEMENT-DT
 14384                                    PB-CI-DEATH-DT
 14385                                    PB-CI-LF-PRIOR-CANCEL-DT
 14386                                    PB-CI-AH-PRIOR-CANCEL-DT
 14387                                    PB-CI-ENTRY-DT
 14388                                    PB-CI-LF-EXPIRE-DT
 14389                                    PB-CI-AH-EXPIRE-DT
 14390                                    PB-CI-LOAN-1ST-PMT-DT
 14391                                    PB-C-LF-CANCEL-DT
 14392                                    PB-C-AH-CANCEL-DT
 14393                                    PB-CREDIT-ACCEPT-DT
 14394                                    PB-BILLED-DT
 14395                                    PB-ACCT-EFF-DT
 14396                                    PB-ACCT-EXP-DT.
 14397
 14398     MOVE 'X'                    TO PB-FATAL-FLAG.
 14399
 14400     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14401
 14402     IF CSUFIXL     GREATER THAN ZEROS
 14403        MOVE CSUFIXI             TO PB-CERT-SFX.
 14404
 14405*    IF CMICRNOL  GREATER  ZEROS
 14406*        IF CMICRNOI  NUMERIC
 14407*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14408*            MOVE AL-UNNON       TO  CMICRNOA
 14409*        ELSE
 14410*            MOVE -1             TO  CMICRNOL
 14411*            MOVE AL-UNBON       TO  CMICRNOA
 14412*            MOVE ER-2701        TO  EMI-ERROR
 14413*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14414
 14415     IF CLSTNML     GREATER THAN ZEROS
 14416        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14417
 14418     IF CCANREAL > ZEROS
 14419        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14420     END-IF
 14421     IF CPCYNL > ZEROS
 14422        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14423     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 265
* EL6311.cbl
 14424     IF CCANDT1L    GREATER THAN ZEROS
 14425        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14426
 14427     IF CCANDT2L    GREATER THAN ZEROS
 14428        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14429
 14430     IF CMTHD1L    GREATER THAN +0
 14431        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14432
 14433     IF CMTHD2L    GREATER THAN +0
 14434        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14435
 14436     IF CREFND1L    GREATER THAN ZEROS
 14437        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14438        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14439     ELSE
 14440        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14441
 14442     IF CREFND2L    GREATER THAN ZEROS
 14443        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14444        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14445     ELSE
 14446        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14447
 14448     IF CLIVESL     GREATER THAN ZEROS
 14449        MOVE WS-CLIVES           TO PB-C-LIVES
 14450     ELSE
 14451        MOVE ZEROS               TO PB-C-LIVES.
 14452
 14453     IF CPAYEEL     GREATER THAN ZEROS
 14454        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14455
 14456     IF CFORCEL     GREATER THAN ZEROS
 14457        MOVE CFORCEI             TO PB-FORCE-CODE.
 14458
 14459     IF CBILCDL     GREATER THAN ZEROS
 14460        MOVE CBILCDI             TO PB-RECORD-BILL.
 14461
 14462*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14463
 14464 2260-WRITE-PB-RECORD.
 14465     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14466                                    PB-INPUT-BY.
 14467     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14468     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14469                                    PB-INPUT-DT.
 14470
 14471     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14472     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14473                                    PB-CONTROL-BY-ORIG-BATCH.
 14474
 14475     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14476     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14477     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14478     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14479     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14480
 14481     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 266
* EL6311.cbl
 14482
 14483     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14484
 14485     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14486     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14487     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14488
 14489     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14490     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14491
 14492 2275-WRITE-PENDING-BUSINESS.
 14493     MOVE 'A'                    TO JP-RECORD-TYPE.
 14494     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14495     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14496     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14497
 14498
 14499* EXEC CICS HANDLE CONDITION
 14500*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14501*    END-EXEC.
 14502*    MOVE '"$%                   ! 4 #00013013' TO DFHEIV0
 14503     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14504     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14505     MOVE X'3420233030303133303133' TO DFHEIV0(25:11)
 14506     CALL 'kxdfhei1' USING DFHEIV0
 14507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14508
 14509
 14510
 14511* EXEC CICS WRITE
 14512*        DATASET (FILE-ID-ERPNDB)
 14513*        FROM    (PENDING-BUSINESS)
 14514*        RIDFLD  (PB-CONTROL-PRIMARY)
 14515*    END-EXEC.
 14516     MOVE LENGTH OF
 14517      PENDING-BUSINESS
 14518       TO DFHEIV11
 14519*    MOVE '&$ L                  ''   #00013017' TO DFHEIV0
 14520     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14521     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14522     MOVE X'2020233030303133303137' TO DFHEIV0(25:11)
 14523     CALL 'kxdfhei1' USING DFHEIV0,
 14524           FILE-ID-ERPNDB,
 14525           PENDING-BUSINESS,
 14526           DFHEIV11,
 14527           PB-CONTROL-PRIMARY,
 14528           DFHEIV99,
 14529           DFHEIV99
 14530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14531
 14532
 14533     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14534
 14535     PERFORM 8400-LOG-JOURNAL-RECORD.
 14536
 14537******************************************************************
 14538*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14539******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 267
* EL6311.cbl
 14540
 14541     display ' made it to add orig CANCEL cert '
 14542     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14543     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14544     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14545     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14546
 14547
 14548* EXEC CICS READ
 14549*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14550*        DATASET (FILE-ID-ELCERT)
 14551*        RIDFLD  (ELCERT-KEY)
 14552*        RESP    (WS-RESPONSE)
 14553*    END-EXEC.
 14554*    MOVE '&"S        E          (  N#00013037' TO DFHEIV0
 14555     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14557     MOVE X'204E233030303133303337' TO DFHEIV0(25:11)
 14558     CALL 'kxdfhei1' USING DFHEIV0,
 14559           FILE-ID-ELCERT,
 14560           DFHEIV20,
 14561           DFHEIV99,
 14562           ELCERT-KEY,
 14563           DFHEIV99,
 14564           DFHEIV99,
 14565           DFHEIV99
 14566     SET ADDRESS OF CERTIFICATE-MASTER TO
 14567         DFHEIV20
 14568     MOVE EIBRESP  TO WS-RESPONSE
 14569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14570
 14571
 14572     IF NOT RESP-NORMAL
 14573        GO TO 2276-BYPASS-CRTO
 14574     END-IF
 14575
 14576     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14577     MOVE ' '                    TO WS-ERMAIL-SW
 14578
 14579
 14580* EXEC CICS READ
 14581*       DATASET   (FILE-ID-ERMAIL)
 14582*       SET       (ADDRESS OF MAILING-DATA)
 14583*       RIDFLD    (ERMAIL-KEY)
 14584*       RESP      (WS-RESPONSE)
 14585*    END-EXEC
 14586*    MOVE '&"S        E          (  N#00013051' TO DFHEIV0
 14587     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14588     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14589     MOVE X'204E233030303133303531' TO DFHEIV0(25:11)
 14590     CALL 'kxdfhei1' USING DFHEIV0,
 14591           FILE-ID-ERMAIL,
 14592           DFHEIV20,
 14593           DFHEIV99,
 14594           ERMAIL-KEY,
 14595           DFHEIV99,
 14596           DFHEIV99,
 14597           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 268
* EL6311.cbl
 14598     SET ADDRESS OF MAILING-DATA TO
 14599         DFHEIV20
 14600     MOVE EIBRESP  TO WS-RESPONSE
 14601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14602
 14603     IF RESP-NORMAL
 14604        SET ERMAIL-FOUND TO TRUE
 14605     END-IF
 14606
 14607     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 14608
 14609     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14610     MOVE 'OC'                   TO OC-RECORD-ID
 14611     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14612                                 TO OC-CONTROL-PRIMARY (1:33)
 14613     MOVE 'I'                    TO OC-RECORD-TYPE
 14614     MOVE +4096                  TO OC-KEY-SEQ-NO
 14615     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14616     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14617     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14618
 14619     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14620     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14621     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14622     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14623     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14624     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14625     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14626     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14627     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14628     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14629     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14630     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14631     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14632     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14633     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14634     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14635     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14636     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14637     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14638     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14639     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14640     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14641     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14642     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14643     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14644     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14645     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14646     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14647     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14648     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14649     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 14650     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 14651
 14652     IF ERMAIL-FOUND
 14653        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14654     END-IF
 14655     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 269
* EL6311.cbl
 14656        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 14657                           OC-INS-AGE-DEFAULT-FLAG
 14658        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 14659                           OC-JNT-AGE-DEFAULT-FLAG
 14660     END-IF
 14661     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14662     .
 14663 2275-WRITE-ELCRTO.
 14664
 14665
 14666* EXEC CICS WRITE
 14667*       DATASET   ('ELCRTO')
 14668*       FROM      (ORIGINAL-CERTIFICATE)
 14669*       RIDFLD    (OC-CONTROL-PRIMARY)
 14670*       RESP      (WS-RESPONSE)
 14671*    END-EXEC
 14672     MOVE LENGTH OF
 14673      ORIGINAL-CERTIFICATE
 14674       TO DFHEIV11
 14675     MOVE 'ELCRTO' TO DFHEIV1
 14676*    MOVE '&$ L                  ''  N#00013120' TO DFHEIV0
 14677     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14678     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14679     MOVE X'204E233030303133313230' TO DFHEIV0(25:11)
 14680     CALL 'kxdfhei1' USING DFHEIV0,
 14681           DFHEIV1,
 14682           ORIGINAL-CERTIFICATE,
 14683           DFHEIV11,
 14684           OC-CONTROL-PRIMARY,
 14685           DFHEIV99,
 14686           DFHEIV99
 14687     MOVE EIBRESP  TO WS-RESPONSE
 14688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14689
 14690     display ' just wrote 2275 ' ws-response
 14691     IF RESP-DUPKEY
 14692        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14693        GO TO 2275-WRITE-ELCRTO
 14694     ELSE
 14695        IF NOT RESP-NORMAL
 14696           MOVE -1               TO BMAINTL
 14697           MOVE ER-7450          TO EMI-ERROR
 14698           PERFORM 9900-ERROR-FORMAT
 14699                                 THRU 9900-EXIT
 14700           GO TO 8200-SEND-DATAONLY
 14701        END-IF
 14702     END-IF.
 14703
 14704 2276-BYPASS-CRTO.
 14705******************************************************************
 14706*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14707******************************************************************
 14708
 14709
 14710* EXEC CICS READ
 14711*        INTO    (PENDING-BUSINESS)
 14712*        DATASET (FILE-ID-ERPNDB)
 14713*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 270
* EL6311.cbl
 14714*        UPDATE
 14715*    END-EXEC.
 14716     MOVE LENGTH OF
 14717      PENDING-BUSINESS
 14718       TO DFHEIV11
 14719*    MOVE '&"IL       EU         (   #00013146' TO DFHEIV0
 14720     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14721     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14722     MOVE X'2020233030303133313436' TO DFHEIV0(25:11)
 14723     CALL 'kxdfhei1' USING DFHEIV0,
 14724           FILE-ID-ERPNDB,
 14725           PENDING-BUSINESS,
 14726           DFHEIV11,
 14727           ERPNDB-KEY,
 14728           DFHEIV99,
 14729           DFHEIV99,
 14730           DFHEIV99
 14731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14732
 14733
 14734     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14735     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14736     MOVE 'B'                    TO JP-RECORD-TYPE.
 14737     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14738
 14739     PERFORM 8400-LOG-JOURNAL-RECORD.
 14740
 14741     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14742
 14743
 14744* EXEC CICS REWRITE
 14745*        DATASET (FILE-ID-ERPNDB)
 14746*        FROM    (PENDING-BUSINESS)
 14747*    END-EXEC.
 14748     MOVE LENGTH OF
 14749      PENDING-BUSINESS
 14750       TO DFHEIV11
 14751*    MOVE '&& L                  %   #00013162' TO DFHEIV0
 14752     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14753     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14754     MOVE X'2020233030303133313632' TO DFHEIV0(25:11)
 14755     CALL 'kxdfhei1' USING DFHEIV0,
 14756           FILE-ID-ERPNDB,
 14757           PENDING-BUSINESS,
 14758           DFHEIV11,
 14759           DFHEIV99
 14760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14761
 14762
 14763     MOVE 'C'                    TO JP-RECORD-TYPE.
 14764     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14765
 14766     PERFORM 8400-LOG-JOURNAL-RECORD.
 14767
 14768     IF WS-ERRORS-PRESENT
 14769        GO TO 3900-RE-DISPLAY-RECORD.
 14770
 14771     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 271
* EL6311.cbl
 14772     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14773     MOVE LOW-VALUES             TO EL631CI.
 14774     MOVE  -1                    TO CMAINTL.
 14775     GO TO 8100-SEND-INITIAL-MAP.
 14776
 14777 2280-BATCH-HDR-NOT-FOUND.
 14778     MOVE -1                     TO BMAINTL.
 14779     MOVE ER-7450                TO EMI-ERROR.
 14780     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14781     GO TO 8200-SEND-DATAONLY.
 14782
 14783 2290-DUPLICATE-ALT-INDEX.
 14784
 14785******************************************************************
 14786*                                                                *
 14787*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14788*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14789*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14790*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14791*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14792*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14793*                                                                *
 14794******************************************************************
 14795
 14796     IF LCP-ONCTR-02 =  0
 14797         ADD 1 TO LCP-ONCTR-02
 14798        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14799
 14800     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14801
 14802     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 14803         NEXT SENTENCE
 14804     ELSE
 14805         ADD +1 TO PB-BATCH-SEQ-NO
 14806                   PB-CSR-BATCH-SEQ-NO
 14807         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 14808         GO TO 2275-WRITE-PENDING-BUSINESS.
 14809
 14810     MOVE -1                     TO CCERTNOL.
 14811     MOVE AL-UABON               TO CCERTNOA.
 14812     MOVE AL-UNBON               TO CEFFDTA.
 14813
 14814     MOVE 1                      TO EMI-SUB
 14815                                    EMI-SWITCH1
 14816                                    EMI-SWITCH-AREA-1
 14817                                    EMI-SWITCH-AREA-2.
 14818
 14819     MOVE SPACES                 TO EMI-ERROR-LINES.
 14820
 14821
 14822* EXEC CICS SYNCPOINT ROLLBACK
 14823*    END-EXEC.
 14824*    MOVE '6"R                   !   #00013225' TO DFHEIV0
 14825     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14827     MOVE X'2020233030303133323235' TO DFHEIV0(25:11)
 14828     CALL 'kxdfhei1' USING DFHEIV0
 14829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 272
* EL6311.cbl
 14830
 14831
 14832     MOVE ER-2247                TO EMI-ERROR.
 14833     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14834     GO TO 8200-SEND-DATAONLY.
 14835
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 273
* EL6311.cbl
 14837
 14838******************************************************************
 14839*                                                                *
 14840*          C H A N G E   C A N C E L   R O U T I N E             *
 14841*                                                                *
 14842******************************************************************
 14843
 14844***************************************************************
 14845*                                                             *
 14846*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 14847*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 14848*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 14849*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 14850*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 14851*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 14852*     5. LINK TO THE EDIT ROUTINE.                            *
 14853*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 14854*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 14855*              THE EDIT ROUTINE.                              *
 14856*     7. REWRITE THE NEW ISSUE                                *
 14857*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 14858*                                                             *
 14859***************************************************************
 14860 2300-CHANGE-CANCEL-ROUTINE.
 14861     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 14862
 14863     IF CCHGL NOT = ZEROS
 14864        MOVE ER-2196             TO EMI-ERROR
 14865        MOVE AL-UABON            TO CMAINTA
 14866        MOVE -1                  TO CMAINTL
 14867        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14868        GO TO 8200-SEND-DATAONLY.
 14869
 14870     MOVE CCERTNOI               TO WS-NEW-PRIME.
 14871
 14872     IF CSUFIXL NOT = ZEROS
 14873        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 14874     ELSE
 14875        MOVE SPACE               TO WS-NEW-SUFFIX.
 14876
 14877     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14878     PERFORM 8600-DEEDIT.
 14879     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14880     MOVE '4'                    TO DC-OPTION-CODE.
 14881
 14882     PERFORM 9700-DATE-LINK.
 14883
 14884     IF DATE-CONVERSION-ERROR
 14885        MOVE ER-0348             TO EMI-ERROR
 14886        MOVE -1                  TO CEFFDTL
 14887        MOVE AL-UABON            TO CEFFDTA
 14888        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14889        GO TO 8200-SEND-DATAONLY
 14890     ELSE
 14891        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14892        MOVE AL-UANON            TO CEFFDTA
 14893        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14894
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 274
* EL6311.cbl
 14895 2325-PROCESS-CANCEL-CHANGES.
 14896
 14897* EXEC CICS HANDLE CONDITION
 14898*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 14899*    END-EXEC.
 14900*    MOVE '"$I                   ! 5 #00013292' TO DFHEIV0
 14901     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14903     MOVE X'3520233030303133323932' TO DFHEIV0(25:11)
 14904     CALL 'kxdfhei1' USING DFHEIV0
 14905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14906
 14907
 14908     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 14909     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14910     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14911
 14912
 14913* EXEC CICS GETMAIN
 14914*        SET      (ADDRESS OF PENDING-BUSINESS)
 14915*        LENGTH   (ERPNDB-RECORD-LENGTH)
 14916*        INITIMG  (GETMAIN-SPACE)
 14917*     END-EXEC.
 14918*    MOVE ',"IL                  $   #00013300' TO DFHEIV0
 14919     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14920     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14921     MOVE X'2020233030303133333030' TO DFHEIV0(25:11)
 14922     CALL 'kxdfhei1' USING DFHEIV0,
 14923           DFHEIV20,
 14924           ERPNDB-RECORD-LENGTH,
 14925           GETMAIN-SPACE
 14926     SET ADDRESS OF PENDING-BUSINESS TO
 14927         DFHEIV20
 14928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14929
 14930
 14931
 14932* EXEC CICS READ
 14933*        INTO    (PENDING-BUSINESS)
 14934*        DATASET (FILE-ID-ERPNDB)
 14935*        RIDFLD  (ERPNDB-KEY)
 14936*    END-EXEC.
 14937     MOVE LENGTH OF
 14938      PENDING-BUSINESS
 14939       TO DFHEIV11
 14940*    MOVE '&"IL       E          (   #00013306' TO DFHEIV0
 14941     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14942     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14943     MOVE X'2020233030303133333036' TO DFHEIV0(25:11)
 14944     CALL 'kxdfhei1' USING DFHEIV0,
 14945           FILE-ID-ERPNDB,
 14946           PENDING-BUSINESS,
 14947           DFHEIV11,
 14948           ERPNDB-KEY,
 14949           DFHEIV99,
 14950           DFHEIV99,
 14951           DFHEIV99
 14952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 275
* EL6311.cbl
 14953
 14954
 14955     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14956
 14957
 14958* EXEC CICS HANDLE CONDITION
 14959*         NOTFND     (2385-REC-NOT-FOUND)
 14960*    END-EXEC.
 14961*    MOVE '"$I                   ! 6 #00013314' TO DFHEIV0
 14962     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14963     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14964     MOVE X'3620233030303133333134' TO DFHEIV0(25:11)
 14965     CALL 'kxdfhei1' USING DFHEIV0
 14966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14967
 14968
 14969**********************************************************
 14970*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 14971*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 14972**********************************************************
 14973
 14974
 14975* EXEC CICS READ
 14976*        DATASET (FILE-ID-ERPNDB)
 14977*        INTO    (PENDING-BUSINESS)
 14978*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 14979*    END-EXEC.
 14980     MOVE LENGTH OF
 14981      PENDING-BUSINESS
 14982       TO DFHEIV11
 14983*    MOVE '&"IL       E          (   #00013323' TO DFHEIV0
 14984     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14985     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14986     MOVE X'2020233030303133333233' TO DFHEIV0(25:11)
 14987     CALL 'kxdfhei1' USING DFHEIV0,
 14988           FILE-ID-ERPNDB,
 14989           PENDING-BUSINESS,
 14990           DFHEIV11,
 14991           PI-PREV-CONTROL-PRIMARY,
 14992           DFHEIV99,
 14993           DFHEIV99,
 14994           DFHEIV99
 14995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14996
 14997
 14998********** DO NOT ALLOW CHANGES IF THRU A/R
 14999     IF BMAINTI = 'C'
 15000         IF PB-EL860-INTERNAL-PROCESS
 15001             MOVE ER-4005          TO EMI-ERROR
 15002             MOVE -1               TO BMAINTL
 15003             MOVE AL-UABON         TO BMAINTA
 15004             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15005             GO TO 8200-SEND-DATAONLY.
 15006**********
 15007
 15008     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15009        MOVE -1                 TO CMAINTL
 15010        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 276
* EL6311.cbl
 15011        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15012        GO TO 8200-SEND-DATAONLY.
 15013
 15014     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15015        MOVE ER-2196             TO EMI-ERROR
 15016        MOVE AL-UABON            TO CMAINTA
 15017        MOVE -1                  TO CMAINTL
 15018        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15019        GO TO 8200-SEND-DATAONLY.
 15020     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15021
 15022     IF PB-BILLED-DT = LOW-VALUES AND
 15023        PB-CHG-COUNT = ZEROS
 15024        NEXT SENTENCE
 15025     ELSE
 15026        IF (CREFND1L GREATER THAN ZEROS AND
 15027            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15028           OR
 15029           (CREFND2L GREATER THAN ZEROS AND
 15030            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15031           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15032
 15033
 15034* EXEC CICS READ
 15035*        DATASET (FILE-ID-ERPNDB)
 15036*        INTO    (PENDING-BUSINESS)
 15037*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15038*        UPDATE
 15039*    END-EXEC.
 15040     MOVE LENGTH OF
 15041      PENDING-BUSINESS
 15042       TO DFHEIV11
 15043*    MOVE '&"IL       EU         (   #00013364' TO DFHEIV0
 15044     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15045     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15046     MOVE X'2020233030303133333634' TO DFHEIV0(25:11)
 15047     CALL 'kxdfhei1' USING DFHEIV0,
 15048           FILE-ID-ERPNDB,
 15049           PENDING-BUSINESS,
 15050           DFHEIV11,
 15051           PI-PREV-CONTROL-PRIMARY,
 15052           DFHEIV99,
 15053           DFHEIV99,
 15054           DFHEIV99
 15055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15056
 15057
 15058     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15059     MOVE 'B'                    TO JP-RECORD-TYPE
 15060     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15061     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15062
 15063     PERFORM 8400-LOG-JOURNAL-RECORD.
 15064
 15065     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15066          PB-CHG-COUNT NOT = ZEROS
 15067        IF (CREFND1L GREATER THAN ZEROS AND
 15068            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 277
* EL6311.cbl
 15069           OR
 15070           (CREFND2L GREATER THAN ZEROS AND
 15071            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15072            ADD +1                      TO PB-CHG-COUNT
 15073            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15074
 15075*    IF CMICRNOL  GREATER  ZEROS
 15076*        IF CMICRNOI  NUMERIC
 15077*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15078*            MOVE AL-UNNON       TO  CMICRNOA
 15079*        ELSE
 15080*            MOVE -1             TO  CMICRNOL
 15081*            MOVE AL-UNBON       TO  CMICRNOA
 15082*            MOVE ER-2701        TO  EMI-ERROR
 15083*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15084
 15085     IF CSUFIXL GREATER THAN ZEROS
 15086        MOVE CSUFIXI             TO PB-CERT-SFX.
 15087
 15088     IF CLSTNML GREATER THAN ZEROS
 15089         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15090
 15091     IF CCANREAL > ZEROS
 15092        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15093     END-IF
 15094     IF CPCYNL > ZEROS
 15095        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15096     END-IF
 15097     IF CCANDT1L    GREATER THAN ZEROS
 15098        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15099
 15100     IF CCANDT2L    GREATER THAN ZEROS
 15101        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15102
 15103     IF CMTHD1L    GREATER THAN +0
 15104        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15105
 15106     IF CMTHD2L    GREATER THAN +0
 15107        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15108
 15109     IF CREFND1L    GREATER THAN ZEROS
 15110        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15111        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 15112        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15113        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15114
 15115     IF CREFND2L    GREATER THAN ZEROS
 15116        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15117        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15118        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15119        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15120
 15121     IF CLIVESL     GREATER THAN ZEROS
 15122        MOVE WS-CLIVES           TO PB-C-LIVES.
 15123
 15124     IF CPAYEEL     GREATER THAN ZEROS
 15125        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15126
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 278
* EL6311.cbl
 15127     IF CFORCEL     GREATER THAN ZEROS
 15128        MOVE CFORCEI             TO PB-FORCE-CODE.
 15129
 15130     IF CBILCDL     GREATER THAN ZEROS
 15131        MOVE CBILCDI             TO PB-RECORD-BILL.
 15132
 15133 2360-REWRITE-PB-RECORD.
 15134     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15135     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15136     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15137     MOVE 'C'                    TO JP-RECORD-TYPE.
 15138     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15139     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15140     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15141
 15142     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15143
 15144     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15145     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15146
 15147     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15148
 15149     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15150
 15151     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15152     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15153     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15154
 15155     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15156     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15157
 15158 2375-REWRITE-PENDING-BUSINESS.
 15159     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15160     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15161     MOVE 'C'                    TO JP-RECORD-TYPE.
 15162     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15163
 15164
 15165* EXEC CICS REWRITE
 15166*        DATASET (FILE-ID-ERPNDB)
 15167*        FROM    (PENDING-BUSINESS)
 15168*    END-EXEC.
 15169     MOVE LENGTH OF
 15170      PENDING-BUSINESS
 15171       TO DFHEIV11
 15172*    MOVE '&& L                  %   #00013477' TO DFHEIV0
 15173     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15174     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15175     MOVE X'2020233030303133343737' TO DFHEIV0(25:11)
 15176     CALL 'kxdfhei1' USING DFHEIV0,
 15177           FILE-ID-ERPNDB,
 15178           PENDING-BUSINESS,
 15179           DFHEIV11,
 15180           DFHEIV99
 15181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15182
 15183
 15184     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 279
* EL6311.cbl
 15185
 15186******************************************************************
 15187*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15188******************************************************************
 15189
 15190     display ' made it to update orig cancel cert '
 15191
 15192     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15193     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15194     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15195     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15196
 15197
 15198* EXEC CICS READ
 15199*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15200*        DATASET (FILE-ID-ELCERT)
 15201*        RIDFLD  (ELCERT-KEY)
 15202*        RESP    (WS-RESPONSE)
 15203*    END-EXEC.
 15204*    MOVE '&"S        E          (  N#00013495' TO DFHEIV0
 15205     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15206     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15207     MOVE X'204E233030303133343935' TO DFHEIV0(25:11)
 15208     CALL 'kxdfhei1' USING DFHEIV0,
 15209           FILE-ID-ELCERT,
 15210           DFHEIV20,
 15211           DFHEIV99,
 15212           ELCERT-KEY,
 15213           DFHEIV99,
 15214           DFHEIV99,
 15215           DFHEIV99
 15216     SET ADDRESS OF CERTIFICATE-MASTER TO
 15217         DFHEIV20
 15218     MOVE EIBRESP  TO WS-RESPONSE
 15219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15220
 15221
 15222     IF NOT RESP-NORMAL
 15223        GO TO 2376-BYPASS-CRTO
 15224     END-IF
 15225
 15226
 15227     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15228     MOVE ' '                    TO WS-ERMAIL-SW
 15229
 15230
 15231* EXEC CICS READ
 15232*       DATASET   (FILE-ID-ERMAIL)
 15233*       SET       (ADDRESS OF MAILING-DATA)
 15234*       RIDFLD    (ERMAIL-KEY)
 15235*       RESP      (WS-RESPONSE)
 15236*    END-EXEC
 15237*    MOVE '&"S        E          (  N#00013510' TO DFHEIV0
 15238     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15239     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15240     MOVE X'204E233030303133353130' TO DFHEIV0(25:11)
 15241     CALL 'kxdfhei1' USING DFHEIV0,
 15242           FILE-ID-ERMAIL,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 280
* EL6311.cbl
 15243           DFHEIV20,
 15244           DFHEIV99,
 15245           ERMAIL-KEY,
 15246           DFHEIV99,
 15247           DFHEIV99,
 15248           DFHEIV99
 15249     SET ADDRESS OF MAILING-DATA TO
 15250         DFHEIV20
 15251     MOVE EIBRESP  TO WS-RESPONSE
 15252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15253
 15254     IF RESP-NORMAL
 15255        SET ERMAIL-FOUND TO TRUE
 15256     END-IF
 15257
 15258     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15259
 15260     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15261                                 TO ELCRTO-KEY
 15262     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15263     MOVE +0                     TO ELCRTO-SEQ-NO
 15264
 15265
 15266* EXEC CICS READ
 15267*       DATASET   ('ELCRTO')
 15268*       INTO      (ORIGINAL-CERTIFICATE)
 15269*       RIDFLD    (ELCRTO-KEY)
 15270*       GTEQ
 15271*       RESP      (WS-RESPONSE)
 15272*    END-EXEC
 15273     MOVE LENGTH OF
 15274      ORIGINAL-CERTIFICATE
 15275       TO DFHEIV11
 15276     MOVE 'ELCRTO' TO DFHEIV1
 15277*    MOVE '&"IL       G          (  N#00013528' TO DFHEIV0
 15278     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15279     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15280     MOVE X'204E233030303133353238' TO DFHEIV0(25:11)
 15281     CALL 'kxdfhei1' USING DFHEIV0,
 15282           DFHEIV1,
 15283           ORIGINAL-CERTIFICATE,
 15284           DFHEIV11,
 15285           ELCRTO-KEY,
 15286           DFHEIV99,
 15287           DFHEIV99,
 15288           DFHEIV99
 15289     MOVE EIBRESP  TO WS-RESPONSE
 15290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15291
 15292     display ' just read gteq ' ws-response
 15293     IF RESP-NORMAL
 15294        AND (OC-CONTROL-PRIMARY (1:33) =
 15295                 PB-CONTROL-BY-ACCOUNT (1:33))
 15296        AND (OC-RECORD-TYPE = 'I')
 15297        display ' resp norm, key =, type i '
 15298        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15299           display ' end proc blank '
 15300           display ' csr edit session ' PI-CSR-SESSION-SW
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 281
* EL6311.cbl
 15301           IF NOT CSR-EDIT-SESSION
 15302
 15303* EXEC CICS READ
 15304*                DATASET   ('ELCRTO')
 15305*                INTO      (ORIGINAL-CERTIFICATE)
 15306*                RIDFLD    (OC-CONTROL-PRIMARY)
 15307*                UPDATE
 15308*                RESP      (WS-RESPONSE)
 15309*             END-EXEC
 15310     MOVE LENGTH OF
 15311      ORIGINAL-CERTIFICATE
 15312       TO DFHEIV11
 15313     MOVE 'ELCRTO' TO DFHEIV1
 15314*    MOVE '&"IL       EU         (  N#00013546' TO DFHEIV0
 15315     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15316     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15317     MOVE X'204E233030303133353436' TO DFHEIV0(25:11)
 15318     CALL 'kxdfhei1' USING DFHEIV0,
 15319           DFHEIV1,
 15320           ORIGINAL-CERTIFICATE,
 15321           DFHEIV11,
 15322           OC-CONTROL-PRIMARY,
 15323           DFHEIV99,
 15324           DFHEIV99,
 15325           DFHEIV99
 15326     MOVE EIBRESP  TO WS-RESPONSE
 15327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15328              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15329              IF RESP-NORMAL
 15330                 display ' good read upd '
 15331                 IF OC-ISSUE-TRAN-IND = 'N'
 15332                    MOVE CM-INSURED-LAST-NAME   TO
 15333                         OC-INS-LAST-NAME
 15334                    MOVE CM-INSURED-FIRST-NAME  TO
 15335                         OC-INS-FIRST-NAME
 15336                    MOVE CM-INSURED-INITIAL2    TO
 15337                         OC-INS-MIDDLE-INIT
 15338                    MOVE CM-INSURED-ISSUE-AGE   TO
 15339                         OC-INS-AGE
 15340                    MOVE CM-JT-LAST-NAME        TO
 15341                         OC-JNT-LAST-NAME
 15342                    MOVE CM-JT-FIRST-NAME       TO
 15343                         OC-JNT-FIRST-NAME
 15344                    MOVE CM-JT-INITIAL          TO
 15345                         OC-JNT-MIDDLE-INIT
 15346                    MOVE CM-INSURED-JOINT-AGE   TO
 15347                         OC-JNT-AGE
 15348                    MOVE CM-LF-BENEFIT-CD       TO
 15349                         OC-LF-BENCD
 15350                    MOVE CM-LF-ORIG-TERM        TO
 15351                         OC-LF-TERM
 15352                    MOVE CM-LF-BENEFIT-AMT      TO
 15353                         OC-LF-BEN-AMT
 15354                    MOVE CM-LF-PREMIUM-AMT      TO
 15355                         OC-LF-PRM-AMT
 15356                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15357                         OC-LF-ALT-BEN-AMT
 15358                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 282
* EL6311.cbl
 15359                         OC-LF-ALT-PRM-AMT
 15360                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15361                         OC-LF-EXP-DT
 15362                    MOVE CM-LIFE-COMM-PCT       TO
 15363                         OC-LF-COMM-PCT
 15364                    MOVE CM-AH-BENEFIT-CD       TO
 15365                         OC-AH-BENCD
 15366                    MOVE CM-AH-ORIG-TERM        TO
 15367                         OC-AH-TERM
 15368                    MOVE CM-AH-BENEFIT-AMT      TO
 15369                         OC-AH-BEN-AMT
 15370                    MOVE CM-AH-PREMIUM-AMT      TO
 15371                         OC-AH-PRM-AMT
 15372                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15373                         OC-AH-EXP-DT
 15374                    MOVE CM-AH-COMM-PCT         TO
 15375                         OC-AH-COMM-PCT
 15376                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15377                         OC-AH-CP
 15378                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15379                         OC-1ST-PMT-DT
 15380                 END-IF
 15381                 MOVE PB-C-LF-CANCEL-DT      TO
 15382                         OC-LF-CANCEL-DT
 15383                 MOVE PB-C-LF-CANCEL-AMT     TO
 15384                         OC-LF-CANCEL-AMT
 15385                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15386                         OC-LF-ITD-CANCEL-AMT
 15387                 MOVE PB-C-AH-CANCEL-DT      TO
 15388                         OC-AH-CANCEL-DT
 15389                 MOVE PB-C-AH-CANCEL-AMT     TO
 15390                         OC-AH-CANCEL-AMT
 15391                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15392                         OC-AH-ITD-CANCEL-AMT
 15393                 MOVE 'Y'                    TO
 15394                         OC-CANCEL-TRAN-IND
 15395                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15396                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15397                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15398                 IF ERMAIL-FOUND
 15399                    MOVE MA-CRED-BENE-NAME
 15400                                 TO OC-CRED-BENE-NAME
 15401                 END-IF
 15402                 IF NOT CERT-TRL-REC-NOT-FOUND
 15403                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15404                           OC-INS-AGE-DEFAULT-FLAG
 15405                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15406                           OC-JNT-AGE-DEFAULT-FLAG
 15407                 END-IF
 15408
 15409* EXEC CICS REWRITE
 15410*                   DATASET   ('ELCRTO')
 15411*                   FROM      (ORIGINAL-CERTIFICATE)
 15412*                   RESP      (WS-RESPONSE)
 15413*                END-EXEC
 15414     MOVE LENGTH OF
 15415      ORIGINAL-CERTIFICATE
 15416       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 283
* EL6311.cbl
 15417     MOVE 'ELCRTO' TO DFHEIV1
 15418*    MOVE '&& L                  %  N#00013633' TO DFHEIV0
 15419     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15420     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15421     MOVE X'204E233030303133363333' TO DFHEIV0(25:11)
 15422     CALL 'kxdfhei1' USING DFHEIV0,
 15423           DFHEIV1,
 15424           ORIGINAL-CERTIFICATE,
 15425           DFHEIV11,
 15426           DFHEIV99
 15427     MOVE EIBRESP  TO WS-RESPONSE
 15428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15429                 display ' just rewrote ' ws-response
 15430              END-IF
 15431           END-IF
 15432        ELSE
 15433           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15434           MOVE 'OC'             TO OC-RECORD-ID
 15435           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15436           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15437           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15438           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15439           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15440           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15441           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15442           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15443           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15444           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15445           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15446           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15447           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15448           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15449           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15450           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15451           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15452           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15453           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15454           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15455           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15456           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15457           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15458           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15459           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15460           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15461           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15462           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15463           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15464           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15465           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15466           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15467           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15468           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15469           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15470           IF ERMAIL-FOUND
 15471              MOVE MA-CRED-BENE-NAME
 15472                                 TO OC-CRED-BENE-NAME
 15473           END-IF
 15474           IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 284
* EL6311.cbl
 15475              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15476                           OC-INS-AGE-DEFAULT-FLAG
 15477              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15478                           OC-JNT-AGE-DEFAULT-FLAG
 15479           END-IF
 15480           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15481
 15482* EXEC CICS WRITE
 15483*             DATASET   ('ELCRTO')
 15484*             FROM      (ORIGINAL-CERTIFICATE)
 15485*             RIDFLD    (OC-CONTROL-PRIMARY)
 15486*             RESP      (WS-RESPONSE)
 15487*          END-EXEC
 15488     MOVE LENGTH OF
 15489      ORIGINAL-CERTIFICATE
 15490       TO DFHEIV11
 15491     MOVE 'ELCRTO' TO DFHEIV1
 15492*    MOVE '&$ L                  ''  N#00013690' TO DFHEIV0
 15493     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15494     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15495     MOVE X'204E233030303133363930' TO DFHEIV0(25:11)
 15496     CALL 'kxdfhei1' USING DFHEIV0,
 15497           DFHEIV1,
 15498           ORIGINAL-CERTIFICATE,
 15499           DFHEIV11,
 15500           OC-CONTROL-PRIMARY,
 15501           DFHEIV99,
 15502           DFHEIV99
 15503     MOVE EIBRESP  TO WS-RESPONSE
 15504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15505        END-IF
 15506     ELSE
 15507        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15508        MOVE 'OC'                TO OC-RECORD-ID
 15509        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15510                                 TO OC-CONTROL-PRIMARY (1:33)
 15511        MOVE 'I'                 TO OC-RECORD-TYPE
 15512        MOVE +4096               TO OC-KEY-SEQ-NO
 15513        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15514        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15515        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15516        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15517        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15518        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15519        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15520        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15521        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15522        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15523        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15524        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15525        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15526        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15527        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15528        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15529        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15530        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15531        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15532        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 285
* EL6311.cbl
 15533        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15534        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15535        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15536        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15537        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15538        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15539        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15540        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15541        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15542        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15543        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15544        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15545        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15546        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15547        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15548        IF ERMAIL-FOUND
 15549           MOVE MA-CRED-BENE-NAME
 15550                                 TO OC-CRED-BENE-NAME
 15551        END-IF
 15552        IF NOT CERT-TRL-REC-NOT-FOUND
 15553           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15554                           OC-INS-AGE-DEFAULT-FLAG
 15555           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15556                           OC-JNT-AGE-DEFAULT-FLAG
 15557        END-IF
 15558        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15559
 15560
 15561* EXEC CICS WRITE
 15562*          DATASET   ('ELCRTO')
 15563*          FROM      (ORIGINAL-CERTIFICATE)
 15564*          RIDFLD    (OC-CONTROL-PRIMARY)
 15565*          RESP      (WS-RESPONSE)
 15566*       END-EXEC
 15567     MOVE LENGTH OF
 15568      ORIGINAL-CERTIFICATE
 15569       TO DFHEIV11
 15570     MOVE 'ELCRTO' TO DFHEIV1
 15571*    MOVE '&$ L                  ''  N#00013751' TO DFHEIV0
 15572     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15573     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15574     MOVE X'204E233030303133373531' TO DFHEIV0(25:11)
 15575     CALL 'kxdfhei1' USING DFHEIV0,
 15576           DFHEIV1,
 15577           ORIGINAL-CERTIFICATE,
 15578           DFHEIV11,
 15579           OC-CONTROL-PRIMARY,
 15580           DFHEIV99,
 15581           DFHEIV99
 15582     MOVE EIBRESP  TO WS-RESPONSE
 15583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15584     END-IF.
 15585
 15586 2376-BYPASS-CRTO.
 15587******************************************************************
 15588*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15589******************************************************************
 15590
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 286
* EL6311.cbl
 15591
 15592* EXEC CICS HANDLE CONDITION
 15593*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15594*    END-EXEC.
 15595*    MOVE '"$I                   ! 7 #00013764' TO DFHEIV0
 15596     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15597     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15598     MOVE X'3720233030303133373634' TO DFHEIV0(25:11)
 15599     CALL 'kxdfhei1' USING DFHEIV0
 15600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15601
 15602
 15603
 15604* EXEC CICS READ
 15605*        INTO    (PENDING-BUSINESS)
 15606*        DATASET (FILE-ID-ERPNDB)
 15607*        RIDFLD  (ERPNDB-KEY)
 15608*        UPDATE
 15609*    END-EXEC.
 15610     MOVE LENGTH OF
 15611      PENDING-BUSINESS
 15612       TO DFHEIV11
 15613*    MOVE '&"IL       EU         (   #00013768' TO DFHEIV0
 15614     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15615     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15616     MOVE X'2020233030303133373638' TO DFHEIV0(25:11)
 15617     CALL 'kxdfhei1' USING DFHEIV0,
 15618           FILE-ID-ERPNDB,
 15619           PENDING-BUSINESS,
 15620           DFHEIV11,
 15621           ERPNDB-KEY,
 15622           DFHEIV99,
 15623           DFHEIV99,
 15624           DFHEIV99
 15625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15626
 15627
 15628     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15629     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15630     MOVE 'B'                    TO JP-RECORD-TYPE.
 15631     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15632
 15633     PERFORM 8400-LOG-JOURNAL-RECORD.
 15634
 15635     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15636
 15637
 15638* EXEC CICS REWRITE
 15639*        DATASET (FILE-ID-ERPNDB)
 15640*        FROM    (PENDING-BUSINESS)
 15641*    END-EXEC.
 15642     MOVE LENGTH OF
 15643      PENDING-BUSINESS
 15644       TO DFHEIV11
 15645*    MOVE '&& L                  %   #00013784' TO DFHEIV0
 15646     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15647     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15648     MOVE X'2020233030303133373834' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 287
* EL6311.cbl
 15649     CALL 'kxdfhei1' USING DFHEIV0,
 15650           FILE-ID-ERPNDB,
 15651           PENDING-BUSINESS,
 15652           DFHEIV11,
 15653           DFHEIV99
 15654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15655
 15656
 15657     MOVE 'C'                    TO JP-RECORD-TYPE.
 15658     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15659
 15660     PERFORM 8400-LOG-JOURNAL-RECORD.
 15661
 15662     IF WS-ERRORS-PRESENT
 15663         GO TO 3900-RE-DISPLAY-RECORD.
 15664
 15665     MOVE ZEROS                  TO EMI-ERROR
 15666     MOVE -1                     TO CMAINTL
 15667     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15668     GO TO 3900-RE-DISPLAY-RECORD.
 15669
 15670 2380-BATCH-HDR-NOT-FOUND.
 15671     MOVE -1                     TO BMAINTL.
 15672     MOVE ER-7450                TO EMI-ERROR.
 15673     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15674     GO TO 8200-SEND-DATAONLY.
 15675
 15676 2385-REC-NOT-FOUND.
 15677     MOVE -1                     TO BMAINTL.
 15678     MOVE ER-7451                TO EMI-ERROR.
 15679     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15680     GO TO 8200-SEND-DATAONLY.
 15681
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 288
* EL6311.cbl
 15683
 15684******************************************************************
 15685*                                                                *
 15686*          D E L E T E   C A N C E L   R O U T I N E             *
 15687*                                                                *
 15688******************************************************************
 15689
 15690 2400-DELETE-CANCEL-ROUTINE.
 15691     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15692
 15693     IF CCHGL NOT = ZEROS
 15694        MOVE ER-2196             TO EMI-ERROR
 15695        MOVE AL-UABON            TO CMAINTA
 15696        MOVE -1                  TO CMAINTL
 15697        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15698        GO TO 8200-SEND-DATAONLY.
 15699
 15700
 15701* EXEC CICS HANDLE CONDITION
 15702*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15703*    END-EXEC.
 15704*    MOVE '"$I                   ! 8 #00013832' TO DFHEIV0
 15705     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15706     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15707     MOVE X'3820233030303133383332' TO DFHEIV0(25:11)
 15708     CALL 'kxdfhei1' USING DFHEIV0
 15709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15710
 15711
 15712     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15713     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15714     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15715
 15716
 15717* EXEC CICS READ
 15718*        SET     (ADDRESS OF PENDING-BUSINESS)
 15719*        DATASET (FILE-ID-ERPNDB)
 15720*        RIDFLD  (ERPNDB-KEY)
 15721*    END-EXEC.
 15722*    MOVE '&"S        E          (   #00013840' TO DFHEIV0
 15723     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15724     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15725     MOVE X'2020233030303133383430' TO DFHEIV0(25:11)
 15726     CALL 'kxdfhei1' USING DFHEIV0,
 15727           FILE-ID-ERPNDB,
 15728           DFHEIV20,
 15729           DFHEIV99,
 15730           ERPNDB-KEY,
 15731           DFHEIV99,
 15732           DFHEIV99,
 15733           DFHEIV99
 15734     SET ADDRESS OF PENDING-BUSINESS TO
 15735         DFHEIV20
 15736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15737
 15738
 15739     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15740
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 289
* EL6311.cbl
 15741     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15742
 15743     IF CSUFIXL NOT = ZEROS
 15744        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15745     ELSE
 15746        MOVE SPACE               TO WS-NEW-SUFFIX.
 15747
 15748     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15749
 15750     PERFORM 8600-DEEDIT.
 15751     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15752     MOVE '4'                    TO DC-OPTION-CODE.
 15753     PERFORM 9700-DATE-LINK.
 15754
 15755     IF DATE-CONVERSION-ERROR
 15756        MOVE ER-0348             TO EMI-ERROR
 15757        MOVE -1                  TO CEFFDTL
 15758        MOVE AL-UABON            TO CEFFDTA
 15759        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15760        GO TO 8200-SEND-DATAONLY
 15761     ELSE
 15762        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15763        MOVE AL-UANON            TO CEFFDTA
 15764        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15765
 15766
 15767* EXEC CICS HANDLE CONDITION
 15768*         NOTFND    (2490-RECORD-NOT-FOUND)
 15769*    END-EXEC.
 15770*    MOVE '"$I                   ! 9 #00013873' TO DFHEIV0
 15771     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15772     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15773     MOVE X'3920233030303133383733' TO DFHEIV0(25:11)
 15774     CALL 'kxdfhei1' USING DFHEIV0
 15775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15776
 15777
 15778
 15779* EXEC CICS READ
 15780*        SET     (ADDRESS OF PENDING-BUSINESS)
 15781*        DATASET (FILE-ID-ERPNDB)
 15782*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15783*        UPDATE
 15784*    END-EXEC.
 15785*    MOVE '&"S        EU         (   #00013877' TO DFHEIV0
 15786     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15787     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15788     MOVE X'2020233030303133383737' TO DFHEIV0(25:11)
 15789     CALL 'kxdfhei1' USING DFHEIV0,
 15790           FILE-ID-ERPNDB,
 15791           DFHEIV20,
 15792           DFHEIV99,
 15793           PI-PREV-CONTROL-PRIMARY,
 15794           DFHEIV99,
 15795           DFHEIV99,
 15796           DFHEIV99
 15797     SET ADDRESS OF PENDING-BUSINESS TO
 15798         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 290
* EL6311.cbl
 15799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15800
 15801
 15802     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15803        MOVE -1                 TO CMAINTL
 15804        MOVE ER-2197            TO EMI-ERROR
 15805        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15806        GO TO 8200-SEND-DATAONLY.
 15807
 15808     IF PB-BILLED-DT NOT = LOW-VALUES
 15809        MOVE -1                 TO CMAINTL
 15810        MOVE ER-2129            TO EMI-ERROR
 15811        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15812        GO TO 8200-SEND-DATAONLY.
 15813
 15814     IF PB-CHG-COUNT NOT = ZEROS
 15815        MOVE ER-2336            TO EMI-ERROR
 15816        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15817        MOVE AL-UABON            TO CMAINTA
 15818        MOVE -1                  TO CMAINTL
 15819        GO TO 8200-SEND-DATAONLY.
 15820
 15821     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 15822        PB-CHG-COUNT NOT = ZEROS
 15823        MOVE ER-2196             TO EMI-ERROR
 15824        MOVE AL-UABON            TO CMAINTA
 15825        MOVE -1                  TO CMAINTL
 15826        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15827        GO TO 8200-SEND-DATAONLY.
 15828
 15829     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 15830        MOVE ER-2900 TO EMI-ERROR
 15831        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15832        MOVE AL-UABON         TO CMAINTA
 15833        MOVE -1               TO CMAINTL
 15834        GO TO 8200-SEND-DATAONLY.
 15835
 15836
 15837* EXEC CICS HANDLE CONDITION
 15838*         NOTFND  (2475-CONTINUE-DELETE)
 15839*    END-EXEC
 15840*    MOVE '"$I                   ! : #00013918' TO DFHEIV0
 15841     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15842     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15843     MOVE X'3A20233030303133393138' TO DFHEIV0(25:11)
 15844     CALL 'kxdfhei1' USING DFHEIV0
 15845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15846
 15847     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15848     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15849     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15850     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15851
 15852
 15853* EXEC CICS READ
 15854*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15855*        DATASET (FILE-ID-ELCERT)
 15856*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 291
* EL6311.cbl
 15857*        UPDATE
 15858*    END-EXEC.
 15859*    MOVE '&"S        EU         (   #00013927' TO DFHEIV0
 15860     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15861     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15862     MOVE X'2020233030303133393237' TO DFHEIV0(25:11)
 15863     CALL 'kxdfhei1' USING DFHEIV0,
 15864           FILE-ID-ELCERT,
 15865           DFHEIV20,
 15866           DFHEIV99,
 15867           ELCERT-KEY,
 15868           DFHEIV99,
 15869           DFHEIV99,
 15870           DFHEIV99
 15871     SET ADDRESS OF CERTIFICATE-MASTER TO
 15872         DFHEIV20
 15873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15874
 15875
 15876     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15877
 15878     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 15879     MOVE 'B'                    TO JP-RECORD-TYPE.
 15880     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 15881     PERFORM 8400-LOG-JOURNAL-RECORD.
 15882
 15883     IF PB-CI-LIVES NOT NUMERIC
 15884         MOVE ZERO                    TO PB-CI-LIVES.
 15885
 15886     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15887        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15888           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15889           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 15890           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 15891                                            CM-LF-CANCEL-DT
 15892           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 15893        ELSE
 15894           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15895           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 15896           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 15897           MOVE PB-CI-LIVES              TO CM-LIVES.
 15898
 15899     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15900        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15901           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15902               MOVE CM-LF-STATUS-AT-CANCEL
 15903                                        TO CM-LF-CURRENT-STATUS
 15904               MOVE SPACE
 15905                                        TO CM-LF-STATUS-AT-CANCEL
 15906           ELSE
 15907               MOVE PB-CI-LF-POLICY-STATUS
 15908                                        TO CM-LF-CURRENT-STATUS
 15909        ELSE
 15910           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 15911
 15912
 15913     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15914        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 292
* EL6311.cbl
 15915           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15916           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 15917           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 15918                                            CM-AH-CANCEL-DT
 15919           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 15920        ELSE
 15921           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15922           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 15923           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 15924           MOVE PB-CI-LIVES              TO CM-LIVES.
 15925
 15926     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15927        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 15928           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15929               MOVE CM-AH-STATUS-AT-CANCEL
 15930                                        TO CM-AH-CURRENT-STATUS
 15931               MOVE SPACE
 15932                                        TO CM-AH-STATUS-AT-CANCEL
 15933           ELSE
 15934               MOVE PB-CI-AH-POLICY-STATUS
 15935                                        TO CM-AH-CURRENT-STATUS
 15936        ELSE
 15937           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 15938
 15939 2450-REWRITE-CERT.
 15940     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 15941     MOVE 'C'                      TO JP-RECORD-TYPE.
 15942     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 15943
 15944
 15945* EXEC CICS REWRITE
 15946*        DATASET  (FILE-ID-ELCERT)
 15947*        FROM     (CERTIFICATE-MASTER)
 15948*    END-EXEC.
 15949     MOVE LENGTH OF
 15950      CERTIFICATE-MASTER
 15951       TO DFHEIV11
 15952*    MOVE '&& L                  %   #00014002' TO DFHEIV0
 15953     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15954     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15955     MOVE X'2020233030303134303032' TO DFHEIV0(25:11)
 15956     CALL 'kxdfhei1' USING DFHEIV0,
 15957           FILE-ID-ELCERT,
 15958           CERTIFICATE-MASTER,
 15959           DFHEIV11,
 15960           DFHEIV99
 15961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15962
 15963
 15964     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 15965
 15966     PERFORM 8400-LOG-JOURNAL-RECORD.
 15967
 15968 2475-CONTINUE-DELETE.
 15969     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 15970     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 15971
 15972     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 293
* EL6311.cbl
 15973     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 15974
 15975     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 15976
 15977     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 15978     MOVE 'D'                    TO JP-RECORD-TYPE
 15979     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15980
 15981
 15982* EXEC CICS DELETE
 15983*        DATASET    (FILE-ID-ERPNDB)
 15984*    END-EXEC.
 15985*    MOVE '&(                    &   #00014024' TO DFHEIV0
 15986     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15987     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15988     MOVE X'2020233030303134303234' TO DFHEIV0(25:11)
 15989     CALL 'kxdfhei1' USING DFHEIV0,
 15990           FILE-ID-ERPNDB,
 15991           DFHEIV99,
 15992           DFHEIV99,
 15993           DFHEIV99,
 15994           DFHEIV99
 15995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15996
 15997
 15998     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15999
 16000     PERFORM 8400-LOG-JOURNAL-RECORD.
 16001
 16002     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16003     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16004
 16005
 16006* EXEC CICS HANDLE CONDITION
 16007*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16008*    END-EXEC.
 16009*    MOVE '"$I                   ! ; #00014035' TO DFHEIV0
 16010     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16011     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16012     MOVE X'3B20233030303134303335' TO DFHEIV0(25:11)
 16013     CALL 'kxdfhei1' USING DFHEIV0
 16014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16015
 16016
 16017
 16018* EXEC CICS READ
 16019*        SET     (ADDRESS OF PENDING-BUSINESS)
 16020*        DATASET (FILE-ID-ERPNDB)
 16021*        RIDFLD  (ERPNDB-KEY)
 16022*        UPDATE
 16023*    END-EXEC.
 16024*    MOVE '&"S        EU         (   #00014039' TO DFHEIV0
 16025     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16026     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16027     MOVE X'2020233030303134303339' TO DFHEIV0(25:11)
 16028     CALL 'kxdfhei1' USING DFHEIV0,
 16029           FILE-ID-ERPNDB,
 16030           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 294
* EL6311.cbl
 16031           DFHEIV99,
 16032           ERPNDB-KEY,
 16033           DFHEIV99,
 16034           DFHEIV99,
 16035           DFHEIV99
 16036     SET ADDRESS OF PENDING-BUSINESS TO
 16037         DFHEIV20
 16038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16039
 16040
 16041     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16042     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16043
 16044     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16045        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16046        MOVE 'D'                 TO JP-RECORD-TYPE
 16047        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16048
 16049* EXEC CICS DELETE
 16050*            DATASET    (FILE-ID-ERPNDB)
 16051*       END-EXEC
 16052*    MOVE '&(                    &   #00014053' TO DFHEIV0
 16053     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16054     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16055     MOVE X'2020233030303134303533' TO DFHEIV0(25:11)
 16056     CALL 'kxdfhei1' USING DFHEIV0,
 16057           FILE-ID-ERPNDB,
 16058           DFHEIV99,
 16059           DFHEIV99,
 16060           DFHEIV99,
 16061           DFHEIV99
 16062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16063        PERFORM 8400-LOG-JOURNAL-RECORD
 16064     ELSE
 16065        MOVE 'B'                 TO JP-RECORD-TYPE
 16066        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16067        PERFORM 8400-LOG-JOURNAL-RECORD
 16068        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16069        MOVE 'C'                 TO JP-RECORD-TYPE
 16070        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16071
 16072* EXEC CICS REWRITE
 16073*            DATASET    (FILE-ID-ERPNDB)
 16074*            FROM       (PENDING-BUSINESS)
 16075*       END-EXEC
 16076     MOVE LENGTH OF
 16077      PENDING-BUSINESS
 16078       TO DFHEIV11
 16079*    MOVE '&& L                  %   #00014064' TO DFHEIV0
 16080     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16081     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16082     MOVE X'2020233030303134303634' TO DFHEIV0(25:11)
 16083     CALL 'kxdfhei1' USING DFHEIV0,
 16084           FILE-ID-ERPNDB,
 16085           PENDING-BUSINESS,
 16086           DFHEIV11,
 16087           DFHEIV99
 16088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 295
* EL6311.cbl
 16089        PERFORM 8400-LOG-JOURNAL-RECORD.
 16090
 16091******************************************************************
 16092*                                                                *
 16093*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16094*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16095*                                                                *
 16096******************************************************************
 16097
 16098     IF NOT PI-AR-PROCESSING
 16099        GO TO 2480-DELETE-FINISHED.
 16100
 16101     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16102        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16103        NEXT SENTENCE
 16104     ELSE
 16105        GO TO 2480-DELETE-FINISHED.
 16106
 16107
 16108* EXEC CICS HANDLE CONDITION
 16109*         NOTFND    (2480-DELETE-FINISHED)
 16110*    END-EXEC.
 16111*    MOVE '"$I                   ! < #00014086' TO DFHEIV0
 16112     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16113     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16114     MOVE X'3C20233030303134303836' TO DFHEIV0(25:11)
 16115     CALL 'kxdfhei1' USING DFHEIV0
 16116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16117
 16118
 16119     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16120     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16121
 16122
 16123* EXEC CICS READ
 16124*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16125*        DATASET (FILE-ID-ERRQST)
 16126*        RIDFLD  (ERRQST-KEY)
 16127*        UPDATE
 16128*    END-EXEC.
 16129*    MOVE '&"S        EU         (   #00014093' TO DFHEIV0
 16130     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16131     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16132     MOVE X'2020233030303134303933' TO DFHEIV0(25:11)
 16133     CALL 'kxdfhei1' USING DFHEIV0,
 16134           FILE-ID-ERRQST,
 16135           DFHEIV20,
 16136           DFHEIV99,
 16137           ERRQST-KEY,
 16138           DFHEIV99,
 16139           DFHEIV99,
 16140           DFHEIV99
 16141     SET ADDRESS OF AR-REQUEST-RECORD TO
 16142         DFHEIV20
 16143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16144
 16145
 16146     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 296
* EL6311.cbl
 16147
 16148     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16149
 16150     MOVE 'D'                      TO JP-RECORD-TYPE.
 16151     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16152
 16153
 16154* EXEC CICS DELETE
 16155*         DATASET    (FILE-ID-ERRQST)
 16156*    END-EXEC.
 16157*    MOVE '&(                    &   #00014107' TO DFHEIV0
 16158     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16159     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16160     MOVE X'2020233030303134313037' TO DFHEIV0(25:11)
 16161     CALL 'kxdfhei1' USING DFHEIV0,
 16162           FILE-ID-ERRQST,
 16163           DFHEIV99,
 16164           DFHEIV99,
 16165           DFHEIV99,
 16166           DFHEIV99
 16167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16168
 16169
 16170     PERFORM 8400-LOG-JOURNAL-RECORD.
 16171
 16172 2480-DELETE-FINISHED.
 16173     MOVE ZEROS                  TO EMI-ERROR.
 16174     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16175     MOVE LOW-VALUES             TO EL631CI.
 16176     MOVE -1                     TO CMAINTL.
 16177     GO TO 8100-SEND-INITIAL-MAP.
 16178
 16179 2485-BATCH-HDR-NOT-FOUND.
 16180     MOVE -1                     TO CMAINTL
 16181     MOVE AL-UABON               TO CMAINTA.
 16182     MOVE ER-7450                TO EMI-ERROR.
 16183     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16184     GO TO 8200-SEND-DATAONLY.
 16185
 16186 2490-RECORD-NOT-FOUND.
 16187     MOVE -1                     TO CMAINTL
 16188     MOVE AL-UABON               TO CMAINTA.
 16189     MOVE ER-7451                TO EMI-ERROR.
 16190     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16191     GO TO 8200-SEND-DATAONLY.
 16192
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 297
* EL6311.cbl
 16194
 16195***************************************************************
 16196*                                                             *
 16197*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16198*                                                             *
 16199***************************************************************
 16200
 16201***************************************************************
 16202*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16203*     AN ALREADY BILLED RECORD.                               *
 16204***************************************************************
 16205
 16206 2700-BUILD-CORRECTION-RECORD.
 16207     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16208     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16209     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16210     MOVE '5'                    TO DC-OPTION-CODE.
 16211     PERFORM 9700-DATE-LINK.
 16212     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16213
 16214     IF PB-CHG-COUNT = ZEROS
 16215        MOVE +1                  TO WS-SEQ-SAVE
 16216     ELSE
 16217        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16218
 16219     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16220     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16221
 16222     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16223
 16224     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16225     MOVE 'A'                    TO JP-RECORD-TYPE.
 16226     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16227
 16228
 16229* EXEC CICS WRITE
 16230*        DATASET    (FILE-ID-ERPNDB)
 16231*        FROM       (PENDING-BUSINESS)
 16232*        RIDFLD     (PB-CONTROL-PRIMARY)
 16233*    END-EXEC.
 16234     MOVE LENGTH OF
 16235      PENDING-BUSINESS
 16236       TO DFHEIV11
 16237*    MOVE '&$ L                  ''   #00014169' TO DFHEIV0
 16238     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16239     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16240     MOVE X'2020233030303134313639' TO DFHEIV0(25:11)
 16241     CALL 'kxdfhei1' USING DFHEIV0,
 16242           FILE-ID-ERPNDB,
 16243           PENDING-BUSINESS,
 16244           DFHEIV11,
 16245           PB-CONTROL-PRIMARY,
 16246           DFHEIV99,
 16247           DFHEIV99
 16248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16249
 16250
 16251     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 298
* EL6311.cbl
 16252
 16253     PERFORM 8400-LOG-JOURNAL-RECORD.
 16254
 16255 2799-EXIT.
 16256      EXIT.
 16257
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 299
* EL6311.cbl
 16259
 16260******************************************************************
 16261*                                                                *
 16262*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 16263*                                                                *
 16264******************************************************************
 16265
 16266 2800-REWRITE-ISSUE-CERT-KEY.
 16267     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16268
 16269     IF  BCERTNOL GREATER THAN ZEROS
 16270         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 16271
 16272     IF  BSUFIXL  GREATER THAN ZEROS
 16273         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 16274
 16275     IF  BEFFDTL  GREATER THAN ZEROS
 16276         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16277
 16278 2810-READ-BY-ACCOUNT.
 16279
 16280* EXEC CICS HANDLE CONDITION
 16281*         NOTFND    (2820-PROCESS-REWRITE)
 16282*    END-EXEC.
 16283*    MOVE '"$I                   ! = #00014203' TO DFHEIV0
 16284     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16285     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16286     MOVE X'3D20233030303134323033' TO DFHEIV0(25:11)
 16287     CALL 'kxdfhei1' USING DFHEIV0
 16288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16289
 16290
 16291
 16292* EXEC CICS READ
 16293*        SET     (ADDRESS OF PENDING-BUSINESS)
 16294*        DATASET (FILE-ID-ERPNDB2)
 16295*        RIDFLD  (ERPNDB-ALT-KEY)
 16296*    END-EXEC.
 16297*    MOVE '&"S        E          (   #00014207' TO DFHEIV0
 16298     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16299     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16300     MOVE X'2020233030303134323037' TO DFHEIV0(25:11)
 16301     CALL 'kxdfhei1' USING DFHEIV0,
 16302           FILE-ID-ERPNDB2,
 16303           DFHEIV20,
 16304           DFHEIV99,
 16305           ERPNDB-ALT-KEY,
 16306           DFHEIV99,
 16307           DFHEIV99,
 16308           DFHEIV99
 16309     SET ADDRESS OF PENDING-BUSINESS TO
 16310         DFHEIV20
 16311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16312
 16313
 16314     GO TO 2890-DUPLICATE-RECORD.
 16315
 16316  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 300
* EL6311.cbl
 16317
 16318* EXEC CICS HANDLE CONDITION
 16319*         NOTFND    (2885-RECORD-MISSING)
 16320*    END-EXEC.
 16321*    MOVE '"$I                   ! > #00014216' TO DFHEIV0
 16322     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16323     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16324     MOVE X'3E20233030303134323136' TO DFHEIV0(25:11)
 16325     CALL 'kxdfhei1' USING DFHEIV0
 16326     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16327
 16328
 16329     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16330
 16331
 16332* EXEC CICS READ
 16333*        SET     (ADDRESS OF PENDING-BUSINESS)
 16334*        DATASET (FILE-ID-ERPNDB)
 16335*        RIDFLD  (ERPNDB-KEY)
 16336*        UPDATE
 16337*    END-EXEC.
 16338*    MOVE '&"S        EU         (   #00014222' TO DFHEIV0
 16339     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16340     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16341     MOVE X'2020233030303134323232' TO DFHEIV0(25:11)
 16342     CALL 'kxdfhei1' USING DFHEIV0,
 16343           FILE-ID-ERPNDB,
 16344           DFHEIV20,
 16345           DFHEIV99,
 16346           ERPNDB-KEY,
 16347           DFHEIV99,
 16348           DFHEIV99,
 16349           DFHEIV99
 16350     SET ADDRESS OF PENDING-BUSINESS TO
 16351         DFHEIV20
 16352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16353
 16354
 16355     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16356     MOVE 'D'                    TO JP-RECORD-TYPE.
 16357     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16358     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16359
 16360     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16361
 16362     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16363     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16364     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16365
 16366
 16367* EXEC CICS DELETE
 16368*        DATASET    (FILE-ID-ERPNDB)
 16369*    END-EXEC.
 16370*    MOVE '&(                    &   #00014240' TO DFHEIV0
 16371     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16372     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16373     MOVE X'2020233030303134323430' TO DFHEIV0(25:11)
 16374     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 301
* EL6311.cbl
 16375           FILE-ID-ERPNDB,
 16376           DFHEIV99,
 16377           DFHEIV99,
 16378           DFHEIV99,
 16379           DFHEIV99
 16380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16381
 16382
 16383     PERFORM 8400-LOG-JOURNAL-RECORD.
 16384
 16385
 16386* EXEC CICS GETMAIN
 16387*        SET      (ADDRESS OF PENDING-BUSINESS)
 16388*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16389*        INITIMG  (GETMAIN-SPACE)
 16390*    END-EXEC.
 16391*    MOVE ',"IL                  $   #00014246' TO DFHEIV0
 16392     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16393     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16394     MOVE X'2020233030303134323436' TO DFHEIV0(25:11)
 16395     CALL 'kxdfhei1' USING DFHEIV0,
 16396           DFHEIV20,
 16397           ERPNDB-RECORD-LENGTH,
 16398           GETMAIN-SPACE
 16399     SET ADDRESS OF PENDING-BUSINESS TO
 16400         DFHEIV20
 16401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16402
 16403
 16404     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16405
 16406
 16407* EXEC CICS HANDLE CONDITION
 16408*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 16409*    END-EXEC.
 16410*    MOVE '"$I                   ! ? #00014254' TO DFHEIV0
 16411     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16412     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16413     MOVE X'3F20233030303134323534' TO DFHEIV0(25:11)
 16414     CALL 'kxdfhei1' USING DFHEIV0
 16415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16416
 16417
 16418
 16419* EXEC CICS READ
 16420*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16421*        DATASET (FILE-ID-ELCERT)
 16422*        RIDFLD  (ELCERT-KEY)
 16423*        UPDATE
 16424*    END-EXEC.
 16425*    MOVE '&"S        EU         (   #00014258' TO DFHEIV0
 16426     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16427     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16428     MOVE X'2020233030303134323538' TO DFHEIV0(25:11)
 16429     CALL 'kxdfhei1' USING DFHEIV0,
 16430           FILE-ID-ELCERT,
 16431           DFHEIV20,
 16432           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 302
* EL6311.cbl
 16433           ELCERT-KEY,
 16434           DFHEIV99,
 16435           DFHEIV99,
 16436           DFHEIV99
 16437     SET ADDRESS OF CERTIFICATE-MASTER TO
 16438         DFHEIV20
 16439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16440
 16441
 16442     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16443     MOVE 'B'                    TO JP-RECORD-TYPE
 16444     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16445     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16446
 16447     IF INSURED-ADDR-PRESENT
 16448        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16449
 16450     IF CERT-NOTES-ARE-NOT-PRESENT
 16451        MOVE SPACE               TO WS-CERT-NOTE-SW
 16452     ELSE
 16453        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16454
 16455     IF CERT-ADDED-BATCH      OR
 16456        CERT-AND-CLAIM-ONLINE OR
 16457        CERT-WAS-CREATED-FOR-CLAIM
 16458        NEXT SENTENCE
 16459     ELSE
 16460        GO TO 2825-DELETE-CERTIFICATE.
 16461
 16462     PERFORM 8400-LOG-JOURNAL-RECORD.
 16463
 16464*********************************************************
 16465** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16466     IF CERT-ADDED-BATCH
 16467         GO TO 2822-REWRITE-ELCERT.
 16468*********************************************************
 16469
 16470     IF NO-CLAIM-ATTACHED
 16471        NEXT SENTENCE
 16472     ELSE
 16473        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 16474        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 16475
 16476 2822-REWRITE-ELCERT.
 16477     MOVE 'C'                    TO JP-RECORD-TYPE
 16478     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16479
 16480     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16481
 16482
 16483* EXEC CICS REWRITE
 16484*         DATASET    (FILE-ID-ELCERT)
 16485*         FROM       (CERTIFICATE-MASTER)
 16486*    END-EXEC.
 16487     MOVE LENGTH OF
 16488      CERTIFICATE-MASTER
 16489       TO DFHEIV11
 16490*    MOVE '&& L                  %   #00014305' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 303
* EL6311.cbl
 16491     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16492     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16493     MOVE X'2020233030303134333035' TO DFHEIV0(25:11)
 16494     CALL 'kxdfhei1' USING DFHEIV0,
 16495           FILE-ID-ELCERT,
 16496           CERTIFICATE-MASTER,
 16497           DFHEIV11,
 16498           DFHEIV99
 16499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16500
 16501
 16502     PERFORM 8400-LOG-JOURNAL-RECORD.
 16503
 16504     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16505
 16506 2825-DELETE-CERTIFICATE.
 16507     MOVE 'D'                      TO JP-RECORD-TYPE.
 16508     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16509
 16510     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16511
 16512
 16513* EXEC CICS DELETE
 16514*         DATASET    (FILE-ID-ELCERT)
 16515*    END-EXEC.
 16516*    MOVE '&(                    &   #00014320' TO DFHEIV0
 16517     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16518     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16519     MOVE X'2020233030303134333230' TO DFHEIV0(25:11)
 16520     CALL 'kxdfhei1' USING DFHEIV0,
 16521           FILE-ID-ELCERT,
 16522           DFHEIV99,
 16523           DFHEIV99,
 16524           DFHEIV99,
 16525           DFHEIV99
 16526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16527
 16528
 16529     PERFORM 8400-LOG-JOURNAL-RECORD.
 16530
 16531******************************************************************
 16532*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 16533******************************************************************
 16534
 16535     IF CERT-NOTES-ARE-PRESENT
 16536        NEXT SENTENCE
 16537     ELSE
 16538        GO TO 2827-DELETE-MAILING.
 16539
 16540
 16541* EXEC CICS HANDLE CONDITION
 16542*         NOTFND  (2827-DELETE-MAILING)
 16543*    END-EXEC.
 16544*    MOVE '"$I                   ! @ #00014335' TO DFHEIV0
 16545     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16546     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16547     MOVE X'4020233030303134333335' TO DFHEIV0(25:11)
 16548     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 304
* EL6311.cbl
 16549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16550
 16551
 16552
 16553* EXEC CICS READ
 16554*        EQUAL
 16555*        DATASET   (FILE-ID-ERNOTE)
 16556*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 16557*        RIDFLD    (ELCERT-KEY)
 16558*        UPDATE
 16559*    END-EXEC.
 16560*    MOVE '&"S        EU         (   #00014339' TO DFHEIV0
 16561     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16562     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16563     MOVE X'2020233030303134333339' TO DFHEIV0(25:11)
 16564     CALL 'kxdfhei1' USING DFHEIV0,
 16565           FILE-ID-ERNOTE,
 16566           DFHEIV20,
 16567           DFHEIV99,
 16568           ELCERT-KEY,
 16569           DFHEIV99,
 16570           DFHEIV99,
 16571           DFHEIV99
 16572     SET ADDRESS OF CERTIFICATE-NOTE TO
 16573         DFHEIV20
 16574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16575
 16576
 16577     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 16578     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16579     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 16580
 16581     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16582
 16583
 16584* EXEC CICS DELETE
 16585*        DATASET   (FILE-ID-ERNOTE)
 16586*    END-EXEC.
 16587*    MOVE '&(                    &   #00014353' TO DFHEIV0
 16588     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16589     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16590     MOVE X'2020233030303134333533' TO DFHEIV0(25:11)
 16591     CALL 'kxdfhei1' USING DFHEIV0,
 16592           FILE-ID-ERNOTE,
 16593           DFHEIV99,
 16594           DFHEIV99,
 16595           DFHEIV99,
 16596           DFHEIV99
 16597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16598
 16599
 16600     PERFORM 8400-LOG-JOURNAL-RECORD.
 16601
 16602******************************************************************
 16603*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 16604******************************************************************
 16605
 16606 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 305
* EL6311.cbl
 16607     IF CERT-ADDRESS-PRESENT
 16608        NEXT SENTENCE
 16609     ELSE
 16610        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16611
 16612
 16613* EXEC CICS HANDLE CONDITION
 16614*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 16615*    END-EXEC.
 16616*    MOVE '"$I                   ! A #00014369' TO DFHEIV0
 16617     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16618     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16619     MOVE X'4120233030303134333639' TO DFHEIV0(25:11)
 16620     CALL 'kxdfhei1' USING DFHEIV0
 16621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16622
 16623
 16624     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 16625
 16626
 16627* EXEC CICS READ
 16628*        EQUAL
 16629*        DATASET   (FILE-ID-ERMAIL)
 16630*        SET       (ADDRESS OF MAILING-DATA)
 16631*        RIDFLD    (ERMAIL-KEY)
 16632*        UPDATE
 16633*    END-EXEC.
 16634*    MOVE '&"S        EU         (   #00014375' TO DFHEIV0
 16635     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16636     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16637     MOVE X'2020233030303134333735' TO DFHEIV0(25:11)
 16638     CALL 'kxdfhei1' USING DFHEIV0,
 16639           FILE-ID-ERMAIL,
 16640           DFHEIV20,
 16641           DFHEIV99,
 16642           ERMAIL-KEY,
 16643           DFHEIV99,
 16644           DFHEIV99,
 16645           DFHEIV99
 16646     SET ADDRESS OF MAILING-DATA TO
 16647         DFHEIV20
 16648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16649
 16650
 16651     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 16652     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16653     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 16654
 16655     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 16656
 16657
 16658* EXEC CICS DELETE
 16659*        DATASET   (FILE-ID-ERMAIL)
 16660*    END-EXEC.
 16661*    MOVE '&(                    &   #00014389' TO DFHEIV0
 16662     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16663     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16664     MOVE X'2020233030303134333839' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 306
* EL6311.cbl
 16665     CALL 'kxdfhei1' USING DFHEIV0,
 16666           FILE-ID-ERMAIL,
 16667           DFHEIV99,
 16668           DFHEIV99,
 16669           DFHEIV99,
 16670           DFHEIV99
 16671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16672
 16673
 16674     PERFORM 8400-LOG-JOURNAL-RECORD.
 16675
 16676 2830-BUILD-NEW-ISSUE-RECORD.
 16677     MOVE SPACES                 TO ELCERT-KEY.
 16678
 16679     IF  BCERTNOL GREATER THAN ZEROS
 16680         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 16681
 16682     IF  BSUFIXL  GREATER THAN ZEROS
 16683         MOVE BSUFIXI            TO  PB-CERT-SFX.
 16684
 16685     IF BEFFDTL GREATER THAN ZEROS
 16686        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 16687
 16688 2870-WRITE-PENDING-BUSINESS.
 16689     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16690     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16691     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16692     MOVE '5'                    TO DC-OPTION-CODE.
 16693     PERFORM 9700-DATE-LINK.
 16694     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16695
 16696     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16697
 16698     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16699     MOVE 'A'                    TO JP-RECORD-TYPE.
 16700     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16701
 16702
 16703* EXEC CICS WRITE
 16704*        DATASET  (FILE-ID-ERPNDB)
 16705*        FROM     (PENDING-BUSINESS)
 16706*        RIDFLD   (PB-CONTROL-PRIMARY)
 16707*    END-EXEC.
 16708     MOVE LENGTH OF
 16709      PENDING-BUSINESS
 16710       TO DFHEIV11
 16711*    MOVE '&$ L                  ''   #00014421' TO DFHEIV0
 16712     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16713     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16714     MOVE X'2020233030303134343231' TO DFHEIV0(25:11)
 16715     CALL 'kxdfhei1' USING DFHEIV0,
 16716           FILE-ID-ERPNDB,
 16717           PENDING-BUSINESS,
 16718           DFHEIV11,
 16719           PB-CONTROL-PRIMARY,
 16720           DFHEIV99,
 16721           DFHEIV99
 16722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 307
* EL6311.cbl
 16723
 16724
 16725     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 16726
 16727     PERFORM 8400-LOG-JOURNAL-RECORD.
 16728
 16729     GO TO 1325-PROCESS-ISSUE-CHANGES.
 16730
 16731 2885-RECORD-MISSING.
 16732     MOVE -1                     TO BMAINTL
 16733     MOVE AL-UABON               TO BMAINTA
 16734     MOVE ER-2902                TO EMI-ERROR.
 16735     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16736     GO TO 8200-SEND-DATAONLY.
 16737
 16738 2890-DUPLICATE-RECORD.
 16739     MOVE -1                     TO BMAINTL.
 16740     MOVE AL-UABON               TO BCERTNOA.
 16741     MOVE AL-UNBON               TO BEFFDTA.
 16742     MOVE SPACE                  TO BMAINTI.
 16743
 16744     MOVE 1                      TO EMI-SUB
 16745                                    EMI-SWITCH1
 16746                                    EMI-SWITCH-AREA-1
 16747                                    EMI-SWITCH-AREA-2.
 16748
 16749     MOVE SPACES                 TO EMI-ERROR-LINES.
 16750
 16751
 16752* EXEC CICS SYNCPOINT ROLLBACK
 16753*    END-EXEC.
 16754*    MOVE '6"R                   !   #00014453' TO DFHEIV0
 16755     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16756     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16757     MOVE X'2020233030303134343533' TO DFHEIV0(25:11)
 16758     CALL 'kxdfhei1' USING DFHEIV0
 16759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16760
 16761
 16762     MOVE ER-2247                TO EMI-ERROR.
 16763     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 16764     GO TO 8200-SEND-DATAONLY.
 16765
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 308
* EL6311.cbl
 16767
 16768******************************************************************
 16769*                                                                *
 16770*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 16771*                                                                *
 16772******************************************************************
 16773
 16774 2900-REWRITE-CAN-CERT-KEY.
 16775     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16776
 16777     IF  CCERTNOL GREATER THAN ZEROS
 16778         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 16779
 16780     IF  CSUFIXL  GREATER THAN ZEROS
 16781         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 16782
 16783     IF  CEFFDTL  GREATER THAN ZEROS
 16784         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16785
 16786 2910-READ-BY-ACCOUNT.
 16787
 16788* EXEC CICS HANDLE CONDITION
 16789*         NOTFND    (2920-PROCESS-REWRITE)
 16790*    END-EXEC.
 16791*    MOVE '"$I                   ! B #00014481' TO DFHEIV0
 16792     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16794     MOVE X'4220233030303134343831' TO DFHEIV0(25:11)
 16795     CALL 'kxdfhei1' USING DFHEIV0
 16796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16797
 16798
 16799
 16800* EXEC CICS READ
 16801*        SET     (ADDRESS OF PENDING-BUSINESS)
 16802*        DATASET (FILE-ID-ERPNDB2)
 16803*        RIDFLD  (ERPNDB-ALT-KEY)
 16804*    END-EXEC.
 16805*    MOVE '&"S        E          (   #00014485' TO DFHEIV0
 16806     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16807     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16808     MOVE X'2020233030303134343835' TO DFHEIV0(25:11)
 16809     CALL 'kxdfhei1' USING DFHEIV0,
 16810           FILE-ID-ERPNDB2,
 16811           DFHEIV20,
 16812           DFHEIV99,
 16813           ERPNDB-ALT-KEY,
 16814           DFHEIV99,
 16815           DFHEIV99,
 16816           DFHEIV99
 16817     SET ADDRESS OF PENDING-BUSINESS TO
 16818         DFHEIV20
 16819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16820
 16821
 16822     GO TO 2990-DUPLICATE-RECORD.
 16823
 16824  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 309
* EL6311.cbl
 16825
 16826* EXEC CICS HANDLE CONDITION
 16827*         NOTFND    (2985-RECORD-MISSING)
 16828*    END-EXEC.
 16829*    MOVE '"$I                   ! C #00014494' TO DFHEIV0
 16830     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16831     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16832     MOVE X'4320233030303134343934' TO DFHEIV0(25:11)
 16833     CALL 'kxdfhei1' USING DFHEIV0
 16834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16835
 16836
 16837     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16838
 16839
 16840* EXEC CICS READ
 16841*        SET     (ADDRESS OF PENDING-BUSINESS)
 16842*        DATASET (FILE-ID-ERPNDB)
 16843*        RIDFLD  (ERPNDB-KEY)
 16844*        UPDATE
 16845*    END-EXEC.
 16846*    MOVE '&"S        EU         (   #00014500' TO DFHEIV0
 16847     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16848     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16849     MOVE X'2020233030303134353030' TO DFHEIV0(25:11)
 16850     CALL 'kxdfhei1' USING DFHEIV0,
 16851           FILE-ID-ERPNDB,
 16852           DFHEIV20,
 16853           DFHEIV99,
 16854           ERPNDB-KEY,
 16855           DFHEIV99,
 16856           DFHEIV99,
 16857           DFHEIV99
 16858     SET ADDRESS OF PENDING-BUSINESS TO
 16859         DFHEIV20
 16860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16861
 16862
 16863     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16864     MOVE 'D'                    TO JP-RECORD-TYPE.
 16865     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16866     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16867
 16868     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16869
 16870     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16871     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16872     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16873
 16874
 16875* EXEC CICS DELETE
 16876*        DATASET    (FILE-ID-ERPNDB)
 16877*    END-EXEC.
 16878*    MOVE '&(                    &   #00014518' TO DFHEIV0
 16879     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16880     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16881     MOVE X'2020233030303134353138' TO DFHEIV0(25:11)
 16882     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 310
* EL6311.cbl
 16883           FILE-ID-ERPNDB,
 16884           DFHEIV99,
 16885           DFHEIV99,
 16886           DFHEIV99,
 16887           DFHEIV99
 16888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16889
 16890
 16891     PERFORM 8400-LOG-JOURNAL-RECORD.
 16892
 16893
 16894* EXEC CICS GETMAIN
 16895*        SET      (ADDRESS OF PENDING-BUSINESS)
 16896*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16897*        INITIMG  (GETMAIN-SPACE)
 16898*    END-EXEC.
 16899*    MOVE ',"IL                  $   #00014524' TO DFHEIV0
 16900     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16901     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16902     MOVE X'2020233030303134353234' TO DFHEIV0(25:11)
 16903     CALL 'kxdfhei1' USING DFHEIV0,
 16904           DFHEIV20,
 16905           ERPNDB-RECORD-LENGTH,
 16906           GETMAIN-SPACE
 16907     SET ADDRESS OF PENDING-BUSINESS TO
 16908         DFHEIV20
 16909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16910
 16911
 16912     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16913
 16914 2950-PROCESS-CANCELS.
 16915
 16916
 16917* EXEC CICS HANDLE CONDITION
 16918*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 16919*    END-EXEC.
 16920*    MOVE '"$I                   ! D #00014534' TO DFHEIV0
 16921     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16923     MOVE X'4420233030303134353334' TO DFHEIV0(25:11)
 16924     CALL 'kxdfhei1' USING DFHEIV0
 16925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16926
 16927
 16928
 16929* EXEC CICS READ
 16930*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16931*        DATASET (FILE-ID-ELCERT)
 16932*        RIDFLD  (ELCERT-KEY)
 16933*        UPDATE
 16934*    END-EXEC.
 16935*    MOVE '&"S        EU         (   #00014538' TO DFHEIV0
 16936     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16937     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16938     MOVE X'2020233030303134353338' TO DFHEIV0(25:11)
 16939     CALL 'kxdfhei1' USING DFHEIV0,
 16940           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 311
* EL6311.cbl
 16941           DFHEIV20,
 16942           DFHEIV99,
 16943           ELCERT-KEY,
 16944           DFHEIV99,
 16945           DFHEIV99,
 16946           DFHEIV99
 16947     SET ADDRESS OF CERTIFICATE-MASTER TO
 16948         DFHEIV20
 16949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16950
 16951
 16952     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16953
 16954     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16955     MOVE 'B'                      TO JP-RECORD-TYPE.
 16956     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16957     PERFORM 8400-LOG-JOURNAL-RECORD.
 16958
 16959     IF PB-CI-LIVES NOT NUMERIC
 16960         MOVE ZERO                    TO PB-CI-LIVES.
 16961
 16962     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16963        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16964        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16965        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16966                                         CM-LF-CANCEL-DT
 16967     ELSE
 16968        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16969        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16970        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16971        MOVE PB-CI-LIVES              TO CM-LIVES.
 16972
 16973     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16974        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16975            MOVE CM-LF-STATUS-AT-CANCEL
 16976                                     TO CM-LF-CURRENT-STATUS
 16977            MOVE SPACE
 16978                                     TO CM-LF-STATUS-AT-CANCEL
 16979        ELSE
 16980            MOVE PB-CI-LF-POLICY-STATUS
 16981                                     TO CM-LF-CURRENT-STATUS
 16982     ELSE
 16983        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16984
 16985     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16986        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16987        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16988        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16989                                         CM-AH-CANCEL-DT
 16990     ELSE
 16991        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16992        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16993        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16994        MOVE PB-CI-LIVES              TO CM-LIVES.
 16995
 16996     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16997        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16998            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 312
* EL6311.cbl
 16999                                     TO CM-AH-CURRENT-STATUS
 17000            MOVE SPACE
 17001                                     TO CM-AH-STATUS-AT-CANCEL
 17002        ELSE
 17003            MOVE PB-CI-AH-POLICY-STATUS
 17004                                     TO CM-AH-CURRENT-STATUS
 17005     ELSE
 17006        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17007
 17008 2975-REWRITE-CERT.
 17009     MOVE 'C'                      TO JP-RECORD-TYPE.
 17010     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17011
 17012
 17013* EXEC CICS REWRITE
 17014*        DATASET    (FILE-ID-ELCERT)
 17015*        FROM       (CERTIFICATE-MASTER)
 17016*    END-EXEC.
 17017     MOVE LENGTH OF
 17018      CERTIFICATE-MASTER
 17019       TO DFHEIV11
 17020*    MOVE '&& L                  %   #00014605' TO DFHEIV0
 17021     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17022     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17023     MOVE X'2020233030303134363035' TO DFHEIV0(25:11)
 17024     CALL 'kxdfhei1' USING DFHEIV0,
 17025           FILE-ID-ELCERT,
 17026           CERTIFICATE-MASTER,
 17027           DFHEIV11,
 17028           DFHEIV99
 17029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17030
 17031
 17032     PERFORM 8400-LOG-JOURNAL-RECORD.
 17033
 17034 2960-BUILD-NEW-CANCEL-RECORD.
 17035     IF  CCERTNOL GREATER THAN ZEROS
 17036         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17037
 17038     IF  CSUFIXL  GREATER THAN ZEROS
 17039         MOVE CSUFIXI             TO PB-CERT-SFX.
 17040
 17041     IF  CEFFDTL  GREATER  THAN ZEROS
 17042         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17043
 17044 2970-WRITE-PENDING-BUSINESS.
 17045     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17046     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17047     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17048     MOVE '5'                    TO DC-OPTION-CODE.
 17049     PERFORM 9700-DATE-LINK.
 17050     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17051
 17052     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17053
 17054     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17055                                    PB-CI-INSURED-SEX
 17056                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 313
* EL6311.cbl
 17057                                    PB-CI-AH-BENEFIT-CD
 17058                                    PB-CI-RATE-CLASS
 17059                                    PB-CI-RATE-DEV-LF
 17060                                    PB-CI-RATE-DEV-AH
 17061                                    PB-CI-LF-ABBR
 17062                                    PB-CI-AH-ABBR
 17063                                    PB-CI-OB-FLAG
 17064                                    PB-CI-LF-POLICY-STATUS
 17065                                    PB-CI-AH-POLICY-STATUS
 17066                                    PB-CI-INDV-GRP-CD
 17067                                    PB-CI-BENEFICIARY-NAME
 17068                                    PB-CI-NOTE-SW
 17069                                    PB-CI-SOC-SEC-NO
 17070                                    PB-CI-MEMBER-NO
 17071                                    PB-CI-INT-CODE
 17072                                    PB-CI-COMP-EXCP-SW
 17073                                    PB-CI-ENTRY-STATUS
 17074                                    PB-CI-CREDIT-INTERFACE-SW-1
 17075                                    PB-CI-CREDIT-INTERFACE-SW-2
 17076                                    PB-CI-ENTRY-BATCH.
 17077
 17078     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17079                                    PB-CI-AH-SETTLEMENT-DT
 17080                                    PB-CI-DEATH-DT
 17081                                    PB-CI-LF-PRIOR-CANCEL-DT
 17082                                    PB-CI-AH-PRIOR-CANCEL-DT
 17083                                    PB-CI-LOAN-1ST-PMT-DT
 17084                                    PB-CI-ENTRY-DT
 17085                                    PB-CI-LF-EXPIRE-DT
 17086                                    PB-CI-AH-EXPIRE-DT.
 17087
 17088     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17089                                    PB-CI-LF-TERM
 17090                                    PB-CI-LF-BENEFIT-AMT
 17091                                    PB-CI-LF-ALT-BENEFIT-AMT
 17092                                    PB-CI-LF-PREMIUM-AMT
 17093                                    PB-CI-LF-ALT-PREMIUM-AMT
 17094                                    PB-CI-AH-TERM
 17095                                    PB-CI-AH-BENEFIT-AMT
 17096                                    PB-CI-AH-PREMIUM-AMT
 17097                                    PB-CI-RATE-DEV-PCT-LF
 17098                                    PB-CI-RATE-DEV-PCT-AH
 17099                                    PB-CI-LIFE-COMMISSION
 17100                                    PB-CI-AH-COMMISSION
 17101                                    PB-CI-PAY-FREQUENCY
 17102                                    PB-CI-LOAN-APR
 17103                                    PB-CI-LOAN-TERM
 17104                                    PB-CI-CURR-SEQ
 17105                                    PB-CI-AH-CANCEL-AMT
 17106                                    PB-CI-LF-CANCEL-AMT
 17107                                    PB-CI-EXTENTION-DAYS
 17108                                    PB-CI-TERM-IN-DAYS
 17109                                    PB-CI-LOAN-OFFICER
 17110                                    PB-CI-LIVES
 17111                                    PB-CI-LF-CRIT-PER
 17112                                    PB-CI-AH-CRIT-PER
 17113                                    PB-C-LF-REM-TERM
 17114                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 314
* EL6311.cbl
 17115
 17116     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17117     MOVE 'A'                    TO JP-RECORD-TYPE.
 17118     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17119
 17120
 17121* EXEC CICS HANDLE CONDITION
 17122*        DUPREC   (2990-DUPLICATE-RECORD)
 17123*    END-EXEC.
 17124*    MOVE '"$%                   ! E #00014698' TO DFHEIV0
 17125     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17126     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17127     MOVE X'4520233030303134363938' TO DFHEIV0(25:11)
 17128     CALL 'kxdfhei1' USING DFHEIV0
 17129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17130
 17131
 17132
 17133* EXEC CICS WRITE
 17134*        DATASET  (FILE-ID-ERPNDB)
 17135*        FROM     (PENDING-BUSINESS)
 17136*        RIDFLD   (PB-CONTROL-PRIMARY)
 17137*    END-EXEC.
 17138     MOVE LENGTH OF
 17139      PENDING-BUSINESS
 17140       TO DFHEIV11
 17141*    MOVE '&$ L                  ''   #00014702' TO DFHEIV0
 17142     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17143     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17144     MOVE X'2020233030303134373032' TO DFHEIV0(25:11)
 17145     CALL 'kxdfhei1' USING DFHEIV0,
 17146           FILE-ID-ERPNDB,
 17147           PENDING-BUSINESS,
 17148           DFHEIV11,
 17149           PB-CONTROL-PRIMARY,
 17150           DFHEIV99,
 17151           DFHEIV99
 17152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17153
 17154
 17155     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17156
 17157     PERFORM 8400-LOG-JOURNAL-RECORD.
 17158
 17159     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17160
 17161 2985-RECORD-MISSING.
 17162     MOVE -1                     TO CMAINTL
 17163     MOVE AL-UABON               TO CMAINTA.
 17164
 17165     MOVE ER-2902                TO EMI-ERROR.
 17166     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17167     GO TO 8200-SEND-DATAONLY.
 17168
 17169 2990-DUPLICATE-RECORD.
 17170     MOVE SPACE                  TO CMAINTI.
 17171     MOVE -1                     TO CMAINTL.
 17172     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 315
* EL6311.cbl
 17173     MOVE AL-UNBON               TO CEFFDTA.
 17174
 17175     MOVE 1                      TO EMI-SUB
 17176                                    EMI-SWITCH1
 17177                                    EMI-SWITCH-AREA-1
 17178                                    EMI-SWITCH-AREA-2.
 17179     MOVE SPACES                 TO EMI-ERROR-LINES.
 17180
 17181
 17182* EXEC CICS SYNCPOINT ROLLBACK
 17183*    END-EXEC.
 17184*    MOVE '6"R                   !   #00014734' TO DFHEIV0
 17185     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17186     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17187     MOVE X'2020233030303134373334' TO DFHEIV0(25:11)
 17188     CALL 'kxdfhei1' USING DFHEIV0
 17189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17190
 17191
 17192     MOVE ER-2247                TO EMI-ERROR.
 17193     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17194     GO TO 8200-SEND-DATAONLY.
 17195
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 316
* EL6311.cbl
 17197
 17198***************************************************************
 17199*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17200*     PREMIUM FOR A SINGLE BATCH.                             *
 17201*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17202***************************************************************
 17203
 17204 3000-BATCH-MAINLINE.
 17205     IF PI-PREV-KEY NOT = SPACES
 17206         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17207     ELSE
 17208         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17209
 17210     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17211
 17212 3010-READNEXT.
 17213
 17214* EXEC CICS READ
 17215*         DATASET    (FILE-ID-ERPNDB)
 17216*         SET        (ADDRESS OF PENDING-BUSINESS)
 17217*         RIDFLD     (ERPNDB-KEY)
 17218*         GTEQ
 17219*    END-EXEC.
 17220*    MOVE '&"S        G          (   #00014758' TO DFHEIV0
 17221     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17222     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17223     MOVE X'2020233030303134373538' TO DFHEIV0(25:11)
 17224     CALL 'kxdfhei1' USING DFHEIV0,
 17225           FILE-ID-ERPNDB,
 17226           DFHEIV20,
 17227           DFHEIV99,
 17228           ERPNDB-KEY,
 17229           DFHEIV99,
 17230           DFHEIV99,
 17231           DFHEIV99
 17232     SET ADDRESS OF PENDING-BUSINESS TO
 17233         DFHEIV20
 17234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17235
 17236
 17237     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 17238        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 17239          GO TO 3030-END-BATCH.
 17240
 17241     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 17242
 17243     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 17244        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 17245          GO TO 3020-BUMP-SEQ.
 17246
 17247     IF PB-ISSUE
 17248        ADD +1                   TO WS-ISS-TOTAL-CNT
 17249        IF PB-FATAL-ERRORS
 17250           ADD +1                      TO WS-ISS-FATAL-CNT
 17251           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17252           GO TO 3020-BUMP-SEQ
 17253        ELSE
 17254           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 317
* EL6311.cbl
 17255              ADD +1                      TO WS-ISS-FORCE-CNT
 17256              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17257              GO TO 3020-BUMP-SEQ
 17258           ELSE
 17259              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17260                 ADD +1                      TO WS-ISS-HOLD-CNT
 17261                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 17262                 GO TO 3020-BUMP-SEQ
 17263              ELSE
 17264                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 17265                     THRU  3299-EXIT
 17266                 GO TO 3020-BUMP-SEQ.
 17267
 17268     IF PB-CANCELLATION
 17269        ADD +1                   TO WS-CAN-TOTAL-CNT
 17270        IF PB-FATAL-ERRORS
 17271           ADD +1                 TO WS-CAN-FATAL-CNT
 17272           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17273           GO TO 3020-BUMP-SEQ
 17274        ELSE
 17275           IF PB-UNFORCED-ERRORS
 17276              ADD +1                 TO WS-CAN-FORCE-CNT
 17277              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17278              GO TO 3020-BUMP-SEQ
 17279           ELSE
 17280              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 17281                 ADD +1                 TO WS-CAN-HOLD-CNT
 17282                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 17283                 GO TO 3020-BUMP-SEQ
 17284              ELSE
 17285                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 17286                     THRU  3499-EXIT
 17287                 GO TO 3020-BUMP-SEQ.
 17288
 17289     IF PB-BATCH-TRAILER
 17290         GO TO 3030-END-BATCH.
 17291
 17292 3020-BUMP-SEQ.
 17293     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 17294     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17295     GO TO 3010-READNEXT.
 17296
 17297 3030-END-BATCH.
 17298     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 17299     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 17300     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 17301     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 17302
 17303     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17304                                          - WS-ISS-FORCE-CNT
 17305                                          - WS-ISS-HOLD-CNT).
 17306
 17307     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 17308     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 17309
 17310     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 17311     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 17312     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 318
* EL6311.cbl
 17313     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 17314     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17315                                          - WS-CAN-FORCE-CNT
 17316                                          - WS-CAN-HOLD-CNT).
 17317     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 17318     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 17319
 17320     COMPUTE WS-NET-TOTAL-CNT
 17321         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 17322     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 17323     COMPUTE WS-NET-FATAL-CNT
 17324         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 17325     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 17326     COMPUTE WS-NET-FORCE-CNT
 17327         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 17328     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 17329     COMPUTE WS-NET-HOLD-CNT
 17330         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 17331     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 17332
 17333     COMPUTE WS-NET-AVAIL-CNT
 17334          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 17335                              - WS-ISS-FORCE-CNT
 17336                              - WS-ISS-HOLD-CNT)
 17337          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 17338                              - WS-CAN-FORCE-CNT
 17339                              - WS-CAN-HOLD-CNT).
 17340     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 17341
 17342     COMPUTE WS-NET-GOOD-PREM
 17343         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 17344     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 17345     COMPUTE WS-NET-BAD-PREM
 17346         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 17347     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 17348
 17349     MOVE 0000                   TO EMI-ERROR.
 17350     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17351     MOVE -1                     TO DPFENTRL.
 17352     GO TO 8200-SEND-DATAONLY.
 17353
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 319
* EL6311.cbl
 17355
 17356******************************************************************
 17357*                                                                *
 17358*           A D D    B A D   I S S U E   P R E M I U M           *
 17359*                                                                *
 17360******************************************************************
 17361
 17362 3100-ADD-BAD-ISSUE-PREM.
 17363     IF PB-OVERRIDE-LIFE
 17364       OR PB-OVERRIDE-BOTH
 17365           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 17366           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 17367       ELSE
 17368           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 17369           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 17370
 17371     IF PB-OVERRIDE-AH
 17372       OR PB-OVERRIDE-BOTH
 17373           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 17374       ELSE
 17375           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 17376
 17377 3199-EXIT.
 17378     EXIT.
 17379
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 320
* EL6311.cbl
 17381
 17382******************************************************************
 17383*                                                                *
 17384*       A D D   G O O D   I S S U E   P R E M I U M              *
 17385*                                                                *
 17386******************************************************************
 17387
 17388 3200-ADD-GOOD-ISSUE-PREM.
 17389     IF PB-OVERRIDE-LIFE
 17390       OR PB-OVERRIDE-BOTH
 17391           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 17392           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 17393       ELSE
 17394           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17395           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 17396
 17397     IF PB-OVERRIDE-AH
 17398       OR PB-OVERRIDE-BOTH
 17399           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 17400       ELSE
 17401           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 17402
 17403 3299-EXIT.
 17404     EXIT.
 17405
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 321
* EL6311.cbl
 17407
 17408
 17409******************************************************************
 17410*                                                                *
 17411*        A D D   B A D   C A N C E L   P R E M I U M             *
 17412*                                                                *
 17413******************************************************************
 17414
 17415 3300-ADD-BAD-CANCEL-PREM.
 17416     IF PB-OVERRIDE-LIFE
 17417       OR PB-OVERRIDE-BOTH
 17418           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 17419       ELSE
 17420           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17421
 17422     IF PB-OVERRIDE-AH
 17423       OR PB-OVERRIDE-BOTH
 17424           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 17425       ELSE
 17426           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 17427
 17428 3399-EXIT.
 17429     EXIT.
 17430
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 322
* EL6311.cbl
 17432
 17433******************************************************************
 17434*                                                                *
 17435*       A D D   G O O D   C A N C E L   P R E M I U M            *
 17436*                                                                *
 17437******************************************************************
 17438
 17439 3400-ADD-GOOD-CANCEL-PREM.
 17440     IF PB-OVERRIDE-LIFE
 17441       OR PB-OVERRIDE-BOTH
 17442           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17443       ELSE
 17444           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17445
 17446     IF PB-OVERRIDE-AH
 17447       OR PB-OVERRIDE-BOTH
 17448           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17449       ELSE
 17450           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17451
 17452 3499-EXIT.
 17453     EXIT.
 17454
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 323
* EL6311.cbl
 17456
 17457******************************************************************
 17458*                                                                *
 17459*           E D I T   B A T C H   D A T A                        *
 17460*                                                                *
 17461******************************************************************
 17462
 17463 3500-EDIT-BATCH-DATA.
 17464     IF PI-PREV-KEY NOT = SPACES
 17465        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17466     ELSE
 17467        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17468
 17469     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17470     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17471
 17472
 17473* EXEC CICS HANDLE CONDITION
 17474*         NOTFND      (3590-NOT-FOUND)
 17475*    END-EXEC.
 17476*    MOVE '"$I                   ! F #00015000' TO DFHEIV0
 17477     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17478     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17479     MOVE X'4620233030303135303030' TO DFHEIV0(25:11)
 17480     CALL 'kxdfhei1' USING DFHEIV0
 17481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17482
 17483
 17484     IF DRISSL   GREATER THAN ZEROS OR
 17485        DRISSL   GREATER THAN ZEROS OR
 17486        DRLFPRML GREATER THAN ZEROS OR
 17487        DRAHPRML GREATER THAN ZEROS OR
 17488        DRCANCL  GREATER THAN ZEROS OR
 17489        DRLFRFDL GREATER THAN ZEROS OR
 17490        DRAHRFDL GREATER THAN ZEROS
 17491              NEXT SENTENCE
 17492          ELSE
 17493              MOVE ER-3224    TO EMI-ERROR
 17494              MOVE -1         TO DPFENTRL
 17495              MOVE AL-UNBON   TO DPFENTRA
 17496              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17497              GO TO 8200-SEND-DATAONLY.
 17498
 17499     IF NOT MODIFY-CAP
 17500         MOVE 'UPDATE'       TO SM-READ
 17501         PERFORM 9995-SECURITY-VIOLATION
 17502         MOVE ER-0070        TO EMI-ERROR
 17503         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17504         GO TO 8100-SEND-INITIAL-MAP.
 17505
 17506        IF DRISSL GREATER THAN ZEROS
 17507           MOVE AL-UNNON         TO DRISSA
 17508           MOVE DRISSI           TO DEEDIT-FIELD
 17509           PERFORM 8600-DEEDIT
 17510           IF DEEDIT-FIELD-V0  NUMERIC
 17511              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 17512           ELSE
 17513              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 324
* EL6311.cbl
 17514              MOVE -1         TO DRISSL
 17515              MOVE AL-UNBON   TO DRISSA
 17516              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17517
 17518        IF DRLFPRML GREATER THAN ZEROS
 17519           MOVE AL-UNNON         TO DRLFPRMA
 17520
 17521* EXEC CICS BIF DEEDIT
 17522*              FIELD  (DRLFPRMI)
 17523*              LENGTH (11)
 17524*          END-EXEC
 17525     MOVE 11
 17526       TO DFHEIV11
 17527*    MOVE '@"L                   #   #00015040' TO DFHEIV0
 17528     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17529     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17530     MOVE X'2020233030303135303430' TO DFHEIV0(25:11)
 17531     CALL 'kxdfhei1' USING DFHEIV0,
 17532           DRLFPRMI,
 17533           DFHEIV11
 17534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17535           IF DRLFPRMI NUMERIC
 17536              MOVE DRLFPRMI   TO WS-DRLFPRM
 17537*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 17538*          PERFORM 8600-DEEDIT
 17539*          IF DEEDIT-FIELD-V2  NUMERIC
 17540*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 17541           ELSE
 17542              MOVE ER-2223    TO EMI-ERROR
 17543              MOVE -1         TO DRLFPRML
 17544              MOVE AL-UNBON   TO DRLFPRMA
 17545              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17546
 17547        IF DRAHPRML GREATER THAN ZEROS
 17548           MOVE AL-UNNON         TO DRAHPRMA
 17549
 17550* EXEC CICS BIF DEEDIT
 17551*              FIELD  (DRAHPRMI)
 17552*              LENGTH (11)
 17553*          END-EXEC
 17554     MOVE 11
 17555       TO DFHEIV11
 17556*    MOVE '@"L                   #   #00015058' TO DFHEIV0
 17557     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17558     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17559     MOVE X'2020233030303135303538' TO DFHEIV0(25:11)
 17560     CALL 'kxdfhei1' USING DFHEIV0,
 17561           DRAHPRMI,
 17562           DFHEIV11
 17563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17564           IF DRAHPRMI NUMERIC
 17565              MOVE DRAHPRMI   TO WS-DRAHPRM
 17566*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 17567*          PERFORM 8600-DEEDIT
 17568*          IF DEEDIT-FIELD-V2  NUMERIC
 17569*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 17570           ELSE
 17571              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 325
* EL6311.cbl
 17572              MOVE -1         TO DRAHPRML
 17573              MOVE AL-UNBON   TO DRAHPRMA
 17574              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17575
 17576        IF DRCANCL GREATER THAN ZEROS
 17577           MOVE AL-UNNON         TO DRCANCA
 17578           MOVE DRCANCI          TO DEEDIT-FIELD
 17579           PERFORM 8600-DEEDIT
 17580           IF DEEDIT-FIELD-V0  NUMERIC
 17581              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 17582           ELSE
 17583              MOVE ER-2223    TO EMI-ERROR
 17584              MOVE -1         TO DRCANCL
 17585              MOVE AL-UNBON   TO DRCANCL
 17586              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17587
 17588        IF DRLFRFDL GREATER THAN ZEROS
 17589           MOVE AL-UNNON         TO DRLFRFDA
 17590
 17591* EXEC CICS BIF DEEDIT
 17592*              FIELD  (DRLFRFDI)
 17593*              LENGTH (11)
 17594*          END-EXEC
 17595     MOVE 11
 17596       TO DFHEIV11
 17597*    MOVE '@"L                   #   #00015088' TO DFHEIV0
 17598     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17599     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17600     MOVE X'2020233030303135303838' TO DFHEIV0(25:11)
 17601     CALL 'kxdfhei1' USING DFHEIV0,
 17602           DRLFRFDI,
 17603           DFHEIV11
 17604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17605           IF DRLFRFDI NUMERIC
 17606              MOVE DRLFRFDI   TO WS-DRLFRFD
 17607*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 17608*          PERFORM 8600-DEEDIT
 17609*          IF DEEDIT-FIELD-V2  NUMERIC
 17610*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 17611           ELSE
 17612              MOVE ER-2223    TO EMI-ERROR
 17613              MOVE -1         TO DRLFRFDL
 17614              MOVE AL-UNBON   TO DRLFRFDA
 17615              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17616
 17617        IF DRAHRFDL GREATER THAN ZEROS
 17618           MOVE AL-UNNON         TO DRAHRFDA
 17619
 17620* EXEC CICS BIF DEEDIT
 17621*              FIELD  (DRAHRFDI)
 17622*              LENGTH (11)
 17623*          END-EXEC
 17624     MOVE 11
 17625       TO DFHEIV11
 17626*    MOVE '@"L                   #   #00015106' TO DFHEIV0
 17627     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17628     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17629     MOVE X'2020233030303135313036' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 326
* EL6311.cbl
 17630     CALL 'kxdfhei1' USING DFHEIV0,
 17631           DRAHRFDI,
 17632           DFHEIV11
 17633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17634           IF DRAHRFDI NUMERIC
 17635              MOVE DRAHRFDI   TO WS-DRAHRFD
 17636*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 17637*          PERFORM 8600-DEEDIT
 17638*          IF DEEDIT-FIELD-V2  NUMERIC
 17639*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 17640           ELSE
 17641              MOVE ER-2223    TO EMI-ERROR
 17642              MOVE -1         TO DRAHRFDL
 17643              MOVE AL-UNBON   TO DRAHRFDA
 17644              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17645
 17646     IF EMI-ERROR = ZEROS
 17647        GO 3600-UPDATE-BATCH-HEADER.
 17648
 17649     GO TO 8200-SEND-DATAONLY.
 17650
 17651 3590-NOT-FOUND.
 17652     MOVE ER-2192                TO EMI-ERROR.
 17653     MOVE -1                     TO DPFENTRL.
 17654     MOVE AL-UNBON               TO DPFENTRA.
 17655     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17656     GO TO 8200-SEND-DATAONLY.
 17657
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 327
* EL6311.cbl
 17659
 17660******************************************************************
 17661*                                                                *
 17662*           U P D A T E   B A T C H   H E A D E R                *
 17663*                                                                *
 17664******************************************************************
 17665
 17666 3600-UPDATE-BATCH-HEADER.
 17667
 17668* EXEC CICS HANDLE CONDITION
 17669*         NOTFND      (3690-NOT-FOUND)
 17670*    END-EXEC.
 17671*    MOVE '"$I                   ! G #00015143' TO DFHEIV0
 17672     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17673     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17674     MOVE X'4720233030303135313433' TO DFHEIV0(25:11)
 17675     CALL 'kxdfhei1' USING DFHEIV0
 17676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17677
 17678
 17679
 17680* EXEC CICS READ
 17681*        DATASET (FILE-ID-ERPNDB)
 17682*        RIDFLD  (ERPNDB-KEY)
 17683*        SET     (ADDRESS OF PENDING-BUSINESS)
 17684*        UPDATE
 17685*    END-EXEC.
 17686*    MOVE '&"S        EU         (   #00015147' TO DFHEIV0
 17687     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17688     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17689     MOVE X'2020233030303135313437' TO DFHEIV0(25:11)
 17690     CALL 'kxdfhei1' USING DFHEIV0,
 17691           FILE-ID-ERPNDB,
 17692           DFHEIV20,
 17693           DFHEIV99,
 17694           ERPNDB-KEY,
 17695           DFHEIV99,
 17696           DFHEIV99,
 17697           DFHEIV99
 17698     SET ADDRESS OF PENDING-BUSINESS TO
 17699         DFHEIV20
 17700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17701
 17702
 17703     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17704     MOVE 'B'                    TO JP-RECORD-TYPE.
 17705     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17706
 17707     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17708
 17709     PERFORM 8400-LOG-JOURNAL-RECORD.
 17710
 17711     IF DRISSL GREATER THAN ZEROS
 17712        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 17713
 17714     IF DRCANCL GREATER THAN ZEROS
 17715        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 17716
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 328
* EL6311.cbl
 17717
 17718     IF DRLFPRML GREATER THAN ZEROS
 17719        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 17720
 17721     IF DRAHPRML GREATER THAN ZEROS
 17722        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 17723
 17724     IF DRLFRFDL GREATER THAN ZEROS
 17725        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 17726
 17727     IF DRAHRFDL GREATER THAN ZEROS
 17728        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 17729
 17730 3670-REWRITE-BATCH-HEADER.
 17731     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 17732        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 17733        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 17734        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 17735        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 17736        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 17737        MOVE SPACE               TO PB-OUT-BAL-CD
 17738     ELSE
 17739        MOVE 'O'                 TO PB-OUT-BAL-CD.
 17740
 17741     MOVE 'C'                    TO JP-RECORD-TYPE.
 17742     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17743
 17744
 17745* EXEC CICS REWRITE
 17746*         DATASET      (FILE-ID-ERPNDB)
 17747*         FROM         (PENDING-BUSINESS)
 17748*    END-EXEC.
 17749     MOVE LENGTH OF
 17750      PENDING-BUSINESS
 17751       TO DFHEIV11
 17752*    MOVE '&& L                  %   #00015195' TO DFHEIV0
 17753     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17754     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17755     MOVE X'2020233030303135313935' TO DFHEIV0(25:11)
 17756     CALL 'kxdfhei1' USING DFHEIV0,
 17757           FILE-ID-ERPNDB,
 17758           PENDING-BUSINESS,
 17759           DFHEIV11,
 17760           DFHEIV99
 17761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17762
 17763
 17764     PERFORM 8400-LOG-JOURNAL-RECORD.
 17765
 17766     GO TO 7200-DISPLAY-BATCHES.
 17767
 17768 3690-NOT-FOUND.
 17769     MOVE ER-2192                TO EMI-ERROR.
 17770     MOVE -1                     TO DPFENTRL.
 17771     MOVE AL-UNBON               TO DPFENTRA.
 17772     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17773     GO TO 8200-SEND-DATAONLY.
 17774
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 329
* EL6311.cbl
 17776
 17777******************************************************************
 17778*                                                                *
 17779*           R E - D I S P L A Y   R E C O R D                    *
 17780*                                                                *
 17781******************************************************************
 17782
 17783 3900-RE-DISPLAY-RECORD.
 17784
 17785* EXEC CICS HANDLE CONDITION
 17786*         NOTFND   (3990-NOT-FOUND)
 17787*    END-EXEC.
 17788*    MOVE '"$I                   ! H #00015220' TO DFHEIV0
 17789     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17790     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17791     MOVE X'4820233030303135323230' TO DFHEIV0(25:11)
 17792     CALL 'kxdfhei1' USING DFHEIV0
 17793     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17794
 17795
 17796     IF PI-DISPLAY-ORIGINAL-BATCH
 17797         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 17798     ELSE
 17799         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 17800
 17801
 17802* EXEC CICS READ
 17803*         DATASET   (FILE-ID)
 17804*         RIDFLD    (PI-PREV-KEY)
 17805*         SET       (ADDRESS OF PENDING-BUSINESS)
 17806*    END-EXEC.
 17807*    MOVE '&"S        E          (   #00015229' TO DFHEIV0
 17808     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17809     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17810     MOVE X'2020233030303135323239' TO DFHEIV0(25:11)
 17811     CALL 'kxdfhei1' USING DFHEIV0,
 17812           FILE-ID,
 17813           DFHEIV20,
 17814           DFHEIV99,
 17815           PI-PREV-KEY,
 17816           DFHEIV99,
 17817           DFHEIV99,
 17818           DFHEIV99
 17819     SET ADDRESS OF PENDING-BUSINESS TO
 17820         DFHEIV20
 17821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17822
 17823
 17824     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 17825
 17826     IF PB-ISSUE
 17827         GO TO 7000-DISPLAY-ISSUES.
 17828
 17829     IF PB-CANCELLATION
 17830         GO TO 7100-DISPLAY-CANCELS.
 17831
 17832     IF PB-BATCH-TRAILER
 17833         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 330
* EL6311.cbl
 17834
 17835 3990-NOT-FOUND.
 17836     MOVE LOW-VALUES             TO EL631BI.
 17837
 17838     IF PI-MAP-NAME = EL631B
 17839         MOVE -1                  TO BMAINTL
 17840     ELSE
 17841         MOVE -1                  TO CMAINTL.
 17842
 17843     GO TO 8100-SEND-INITIAL-MAP.
 17844
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 331
* EL6311.cbl
 17846
 17847***************************************************************
 17848*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 17849*                                                             *
 17850*      1. START BROWSE WITH                                   *
 17851*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 17852*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 17853*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 17854*                                                             *
 17855*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 17856*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 17857*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 17858*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 17859*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 17860*               AND IS IT TO BE DISPLAYED.                    *
 17861*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 17862*               DISPLAYED.                                    *
 17863*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 17864*               DISPLAYED.                                    *
 17865*                                                             *
 17866*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 17867*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 17868***************************************************************
 17869
 17870 4000-BROWSE-DETAIL-FORWARD.
 17871     IF FIRST-TIME
 17872        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 17873     ELSE
 17874        IF SHOW-RECORD
 17875           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 17876           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 17877           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 17878           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 17879           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 17880        ELSE
 17881           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 17882
 17883
 17884* EXEC CICS HANDLE CONDITION
 17885*         NOTFND   (4050-END-RECORDS)
 17886*         ENDFILE  (4050-END-RECORDS)
 17887*    END-EXEC.
 17888*    MOVE '"$I''                  ! I #00015294' TO DFHEIV0
 17889     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 17890     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17891     MOVE X'4920233030303135323934' TO DFHEIV0(25:11)
 17892     CALL 'kxdfhei1' USING DFHEIV0
 17893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17894
 17895
 17896
 17897* EXEC CICS STARTBR
 17898*         DATASET   (FILE-ID-ERPNDB2)
 17899*         RIDFLD    (ERPNDB-ALT-KEY)
 17900*    END-EXEC.
 17901     MOVE 0
 17902       TO DFHEIV11
 17903*    MOVE '&,         G          &   #00015299' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 332
* EL6311.cbl
 17904     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17905     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17906     MOVE X'2020233030303135323939' TO DFHEIV0(25:11)
 17907     CALL 'kxdfhei1' USING DFHEIV0,
 17908           FILE-ID-ERPNDB2,
 17909           ERPNDB-ALT-KEY,
 17910           DFHEIV99,
 17911           DFHEIV11,
 17912           DFHEIV99
 17913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17914
 17915
 17916     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 17917
 17918     IF FIRST-TIME OR SHOW-RECORD
 17919        MOVE SPACE               TO WS-FIRST-TIME-SW
 17920        GO TO 4005-READ-NEXT-RECORD.
 17921
 17922
 17923* EXEC CICS READNEXT
 17924*         DATASET    (FILE-ID-ERPNDB2)
 17925*         SET        (ADDRESS OF PENDING-BUSINESS)
 17926*         RIDFLD     (ERPNDB-ALT-KEY)
 17927*    END-EXEC.
 17928     MOVE 0
 17929       TO DFHEIV11
 17930*    MOVE '&.S                   )   #00015310' TO DFHEIV0
 17931     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17932     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17933     MOVE X'2020233030303135333130' TO DFHEIV0(25:11)
 17934     CALL 'kxdfhei1' USING DFHEIV0,
 17935           FILE-ID-ERPNDB2,
 17936           DFHEIV20,
 17937           DFHEIV99,
 17938           ERPNDB-ALT-KEY,
 17939           DFHEIV99,
 17940           DFHEIV11,
 17941           DFHEIV99,
 17942           DFHEIV99
 17943     SET ADDRESS OF PENDING-BUSINESS TO
 17944         DFHEIV20
 17945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17946
 17947
 17948 4005-READ-NEXT-RECORD.
 17949
 17950* EXEC CICS READNEXT
 17951*         DATASET    (FILE-ID-ERPNDB2)
 17952*         SET        (ADDRESS OF PENDING-BUSINESS)
 17953*         RIDFLD     (ERPNDB-ALT-KEY)
 17954*    END-EXEC.
 17955     MOVE 0
 17956       TO DFHEIV11
 17957*    MOVE '&.S                   )   #00015317' TO DFHEIV0
 17958     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17959     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17960     MOVE X'2020233030303135333137' TO DFHEIV0(25:11)
 17961     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 333
* EL6311.cbl
 17962           FILE-ID-ERPNDB2,
 17963           DFHEIV20,
 17964           DFHEIV99,
 17965           ERPNDB-ALT-KEY,
 17966           DFHEIV99,
 17967           DFHEIV11,
 17968           DFHEIV99,
 17969           DFHEIV99
 17970     SET ADDRESS OF PENDING-BUSINESS TO
 17971         DFHEIV20
 17972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17973
 17974
 17975     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17976
 17977     IF WS-BATCH-PREFIX = '#CL'
 17978        GO TO 4005-READ-NEXT-RECORD.
 17979
 17980     IF SHOW-RECORD
 17981        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 17982           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 17983           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 17984           PB-STATE         NOT = PI-PB-STATE          OR
 17985           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 17986           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 17987           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 17988           GO TO 4050-END-RECORDS
 17989        ELSE
 17990           GO TO 4010-CHECK-REC-TYPE.
 17991
 17992     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 17993        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 17994        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 17995        PB-STATE            NOT = PI-PB-STATE          OR
 17996        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 17997        GO TO 4050-END-RECORDS.
 17998
 17999     IF PB-BATCH-TRAILER
 18000        GO TO 4005-READ-NEXT-RECORD.
 18001
 18002     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18003        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18004           GO TO 4005-READ-NEXT-RECORD
 18005        ELSE
 18006           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18007              GO TO 4010-CHECK-REC-TYPE
 18008           ELSE
 18009              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18010                 GO TO 4010-CHECK-REC-TYPE
 18011              ELSE
 18012                 GO TO 4005-READ-NEXT-RECORD.
 18013
 18014     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18015        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18016           GO TO 4005-READ-NEXT-RECORD.
 18017
 18018 4010-CHECK-REC-TYPE.
 18019     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 334
* EL6311.cbl
 18020         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18021             NEXT SENTENCE
 18022         ELSE
 18023             GO TO 4005-READ-NEXT-RECORD.
 18024
 18025     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18026         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18027             NEXT SENTENCE
 18028        ELSE
 18029             GO TO 4005-READ-NEXT-RECORD.
 18030
 18031     IF NOT DISPLAY-CHANGE-RECORDS AND
 18032            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18033        GO TO 4005-READ-NEXT-RECORD.
 18034
 18035     IF DISPLAY-HOLD-RECORDS AND
 18036        NOT PB-RECORD-ON-HOLD
 18037          GO TO 4005-READ-NEXT-RECORD.
 18038
 18039     IF PB-ISSUE
 18040        IF DISPLAY-CHK-REQ-RECORDS
 18041            GO TO 4005-READ-NEXT-RECORD.
 18042
 18043     IF PB-ISSUE
 18044        IF ISSUE-WITH-WARNING
 18045           IF PB-WARNING-ERRORS
 18046              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18047                  GO TO 4005-READ-NEXT-RECORD
 18048              ELSE
 18049                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18050                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18051                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18052                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18053                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18054                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18055                 GO TO 7000-DISPLAY-ISSUES
 18056           ELSE
 18057              GO TO 4005-READ-NEXT-RECORD.
 18058
 18059     IF PB-ISSUE
 18060        IF (ISSUES-IN-ERROR AND
 18061            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18062            ALL-ISSUES
 18063            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18064            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18065            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18066            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18067            MOVE PB-SV-STATE            TO PI-SV-STATE
 18068            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18069            GO TO 7000-DISPLAY-ISSUES
 18070        ELSE
 18071            GO TO 4005-READ-NEXT-RECORD.
 18072
 18073     IF PB-CANCELLATION
 18074        IF DISPLAY-CHK-REQ-RECORDS
 18075           IF PB-C-REFUND-REQUESTED
 18076              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18077              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 335
* EL6311.cbl
 18078              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18079              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18080              MOVE PB-SV-STATE            TO PI-SV-STATE
 18081              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18082              GO TO 7100-DISPLAY-CANCELS
 18083           ELSE
 18084               GO TO 4005-READ-NEXT-RECORD.
 18085
 18086     IF PB-CANCELLATION
 18087        IF CANCEL-WITH-WARNING
 18088           IF PB-WARNING-ERRORS
 18089              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18090                  GO TO 4005-READ-NEXT-RECORD
 18091              ELSE
 18092                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18093                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18094                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18095                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18096                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18097                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18098                 GO TO 7100-DISPLAY-CANCELS
 18099           ELSE
 18100              GO TO 4005-READ-NEXT-RECORD.
 18101
 18102     IF PB-CANCELLATION
 18103        IF (CANCEL-IN-ERROR  AND
 18104            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18105            ALL-CANCELS
 18106            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18107            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18108            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18109            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18110            MOVE PB-SV-STATE            TO PI-SV-STATE
 18111            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18112            GO TO 7100-DISPLAY-CANCELS.
 18113
 18114     GO TO 4005-READ-NEXT-RECORD.
 18115
 18116 4050-END-RECORDS.
 18117******************************************************************
 18118*                                                                *
 18119*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18120*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18121*         PROGRAM.                                               *
 18122*                                                                *
 18123******************************************************************
 18124
 18125     IF BROWSE-STARTED
 18126        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18127
 18128* EXEC CICS ENDBR
 18129*            DATASET  (FILE-ID-ERPNDB2)
 18130*       END-EXEC.
 18131     MOVE 0
 18132       TO DFHEIV11
 18133*    MOVE '&2                    $   #00015475' TO DFHEIV0
 18134     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18135     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 336
* EL6311.cbl
 18136     MOVE X'2020233030303135343735' TO DFHEIV0(25:11)
 18137     CALL 'kxdfhei1' USING DFHEIV0,
 18138           FILE-ID-ERPNDB2,
 18139           DFHEIV11,
 18140           DFHEIV99
 18141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18142
 18143
 18144     IF  EIBTRNID NOT = TRANS-EXB1
 18145         IF PENDING-BUS-RECS-FOUND
 18146             NEXT SENTENCE
 18147           ELSE
 18148             MOVE '9'            TO PI-BROWSE-SW
 18149             GO TO 9400-CLEAR.
 18150
 18151     IF SHOW-RECORD
 18152        MOVE ER-2253            TO EMI-ERROR
 18153       ELSE
 18154        MOVE ER-2254            TO EMI-ERROR.
 18155
 18156     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18157
 18158     IF PI-MAP-NAME = SPACES
 18159        MOVE -1                  TO DPFENTRL
 18160        MOVE EL631D               TO PI-MAP-NAME
 18161        GO TO 8100-SEND-INITIAL-MAP.
 18162
 18163     IF PI-MAP-NAME = EL631B
 18164        MOVE -1                  TO BMAINTL
 18165     ELSE
 18166        IF PI-MAP-NAME = EL631C
 18167           MOVE -1               TO CMAINTL
 18168        ELSE
 18169           MOVE -1               TO DPFENTRL.
 18170
 18171     GO TO 8200-SEND-DATAONLY.
 18172
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 337
* EL6311.cbl
 18174
 18175***************************************************************
 18176*                                                             *
 18177*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18178*                                                             *
 18179*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18180*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18181*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18182*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18183*                                                             *
 18184*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18185*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18186*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18187*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18188*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18189*                AND IS IT TO BE DISPLAYED.                   *
 18190*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18191*                DISPLAYED.                                   *
 18192*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18193*                DISPLAYED.                                   *
 18194*                                                             *
 18195*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18196*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18197*                                                             *
 18198*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18199*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18200*                THEY ARE NOT TO BE DISPLAYED.                *
 18201*                                                             *
 18202***************************************************************
 18203
 18204 4100-BROWSE-PRIMARY-FORWARD.
 18205     IF FIRST-TIME  OR SHOW-RECORD
 18206        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18207        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18208        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18209     ELSE
 18210        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18211        IF ERPNDB-BATCH-SEQ-NO = +9999
 18212           GO TO 4150-END-BATCH
 18213        ELSE
 18214           IF DISPLAY-CHANGE-RECORDS
 18215              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18216           ELSE
 18217              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18218              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18219
 18220     IF FIRST-TIME
 18221         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 18222            PI-PB-BATCH-SEQ-NO NOT = ZERO
 18223              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 18224
 18225
 18226* EXEC CICS HANDLE CONDITION
 18227*         ENDFILE  (4150-END-BATCH)
 18228*    END-EXEC.
 18229*    MOVE '"$''                   ! J #00015560' TO DFHEIV0
 18230     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 18231     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 338
* EL6311.cbl
 18232     MOVE X'4A20233030303135353630' TO DFHEIV0(25:11)
 18233     CALL 'kxdfhei1' USING DFHEIV0
 18234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18235
 18236
 18237 4105-READ-NEXT.
 18238
 18239* EXEC CICS HANDLE CONDITION
 18240*         NOTFND    (4150-END-BATCH)
 18241*    END-EXEC.
 18242*    MOVE '"$I                   ! K #00015565' TO DFHEIV0
 18243     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18245     MOVE X'4B20233030303135353635' TO DFHEIV0(25:11)
 18246     CALL 'kxdfhei1' USING DFHEIV0
 18247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18248
 18249
 18250     MOVE SPACES                 TO WS-REC-FOUND-SW.
 18251
 18252     IF PI-DISPLAY-ORIGINAL-BATCH
 18253        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18254     ELSE
 18255        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18256
 18257
 18258* EXEC CICS READ
 18259*         DATASET   (FILE-ID)
 18260*         SET       (ADDRESS OF PENDING-BUSINESS)
 18261*         RIDFLD    (ERPNDB-KEY)
 18262*         GTEQ
 18263*    END-EXEC.
 18264*    MOVE '&"S        G          (   #00015576' TO DFHEIV0
 18265     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18266     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18267     MOVE X'2020233030303135353736' TO DFHEIV0(25:11)
 18268     CALL 'kxdfhei1' USING DFHEIV0,
 18269           FILE-ID,
 18270           DFHEIV20,
 18271           DFHEIV99,
 18272           ERPNDB-KEY,
 18273           DFHEIV99,
 18274           DFHEIV99,
 18275           DFHEIV99
 18276     SET ADDRESS OF PENDING-BUSINESS TO
 18277         DFHEIV20
 18278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18279
 18280
 18281     IF PI-DISPLAY-ORIGINAL-BATCH
 18282        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18283           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18284           GO TO 4150-END-BATCH
 18285        ELSE
 18286           IF PB-BATCH-TRAILER
 18287              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 18288              GO TO 4105-READ-NEXT
 18289           ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 339
* EL6311.cbl
 18290              NEXT SENTENCE
 18291     ELSE
 18292        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 18293           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 18294           GO TO 4150-END-BATCH.
 18295
 18296     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18297
 18298     IF WS-BATCH-PREFIX = '#CL'
 18299         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18300         GO TO 4105-READ-NEXT.
 18301
 18302     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18303     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18304     MOVE PB-STATE               TO PI-PB-STATE.
 18305     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18306
 18307     IF PB-BATCH-TRAILER
 18308        IF SHOW-RECORD
 18309           GO TO 4150-END-BATCH
 18310        ELSE
 18311           MOVE ER-2251         TO EMI-ERROR
 18312           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18313           MOVE 1               TO PI-BROWSE-TYPE
 18314           GO TO 7200-DISPLAY-BATCHES.
 18315
 18316     IF SHOW-RECORD
 18317           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18318              GO TO 4110-BUMP-SEQ
 18319           ELSE
 18320              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18321                 GO TO 4110-BUMP-SEQ
 18322              ELSE
 18323                 GO TO 4107-CHECK-REC-TYPE.
 18324
 18325     IF NOT  PI-PRIMARY-WITH-SELECT
 18326        GO TO 4107-CHECK-REC-TYPE.
 18327
 18328     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18329        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18330           GO TO 4110-BUMP-SEQ
 18331        ELSE
 18332           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18333              GO TO 4107-CHECK-REC-TYPE
 18334           ELSE
 18335              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18336                 GO TO 4107-CHECK-REC-TYPE
 18337              ELSE
 18338                 GO TO 4110-BUMP-SEQ.
 18339
 18340     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18341        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18342           GO TO 4110-BUMP-SEQ.
 18343
 18344 4107-CHECK-REC-TYPE.
 18345     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18346         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18347             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 340
* EL6311.cbl
 18348           ELSE
 18349             GO TO 4110-BUMP-SEQ.
 18350
 18351     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18352         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18353             NEXT SENTENCE
 18354           ELSE
 18355             GO TO 4110-BUMP-SEQ.
 18356
 18357     IF NOT DISPLAY-CHANGE-RECORDS AND
 18358        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18359           GO TO 4110-BUMP-SEQ.
 18360
 18361     IF DISPLAY-HOLD-RECORDS AND
 18362        NOT PB-RECORD-ON-HOLD
 18363          GO TO 4110-BUMP-SEQ.
 18364
 18365     IF PB-ISSUE
 18366        IF DISPLAY-CHK-REQ-RECORDS
 18367            GO TO 4110-BUMP-SEQ.
 18368
 18369     IF PB-ISSUE
 18370        IF ISSUE-WITH-WARNING
 18371           IF PB-WARNING-ERRORS
 18372              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18373                  GO TO 4110-BUMP-SEQ
 18374              ELSE
 18375                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18376                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18377                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18378                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18379                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18380                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18381                 GO TO 7000-DISPLAY-ISSUES
 18382        ELSE
 18383            GO TO 4110-BUMP-SEQ.
 18384
 18385     IF PB-ISSUE
 18386        IF (ISSUES-IN-ERROR AND
 18387            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18388            ALL-ISSUES
 18389            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18390            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18391            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18392            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18393            MOVE PB-SV-STATE            TO PI-SV-STATE
 18394            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18395            GO TO 7000-DISPLAY-ISSUES
 18396        ELSE
 18397            GO TO 4110-BUMP-SEQ.
 18398
 18399     IF PB-CANCELLATION
 18400        IF DISPLAY-CHK-REQ-RECORDS
 18401           IF PB-C-REFUND-REQUESTED
 18402              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18403              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18404              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18405              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 341
* EL6311.cbl
 18406              MOVE PB-SV-STATE            TO PI-SV-STATE
 18407              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18408              GO TO 7100-DISPLAY-CANCELS
 18409           ELSE
 18410              GO TO 4110-BUMP-SEQ.
 18411
 18412     IF PB-CANCELLATION
 18413        IF CANCEL-WITH-WARNING
 18414           IF PB-WARNING-ERRORS
 18415              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18416                  GO TO 4110-BUMP-SEQ
 18417              ELSE
 18418                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18419                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18420                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18421                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18422                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18423                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18424                 GO TO 7100-DISPLAY-CANCELS
 18425           ELSE
 18426              GO TO 4110-BUMP-SEQ.
 18427
 18428     IF PB-CANCELLATION
 18429        IF (CANCEL-IN-ERROR  AND
 18430            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18431            ALL-CANCELS
 18432            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18433            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18434            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18435            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18436            MOVE PB-SV-STATE            TO PI-SV-STATE
 18437            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 18438            GO TO 7100-DISPLAY-CANCELS.
 18439
 18440 4110-BUMP-SEQ.
 18441     IF NOT DISPLAY-CHANGE-RECORDS
 18442        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18443        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18444     ELSE
 18445        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18446           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18447           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18448        ELSE
 18449           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18450           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18451
 18452     GO TO 4105-READ-NEXT.
 18453
 18454 4150-END-BATCH.
 18455******************************************************************
 18456*                                                                *
 18457*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18458*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 18459*         PROGRAM.                                               *
 18460*                                                                *
 18461******************************************************************
 18462
 18463     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 342
* EL6311.cbl
 18464         IF PENDING-BUS-RECS-FOUND
 18465             NEXT SENTENCE
 18466           ELSE
 18467             MOVE '9'            TO PI-BROWSE-SW
 18468             GO TO 9400-CLEAR.
 18469
 18470     IF SHOW-RECORD
 18471        MOVE ER-2253             TO EMI-ERROR
 18472     ELSE
 18473        MOVE ER-2251             TO EMI-ERROR.
 18474
 18475     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18476
 18477     IF PI-MAP-NAME = SPACES
 18478        MOVE -1                  TO BMAINTL
 18479        MOVE EL631B              TO PI-MAP-NAME
 18480        GO TO 8100-SEND-INITIAL-MAP.
 18481
 18482     IF PI-MAP-NAME = EL631B
 18483        MOVE -1                  TO BMAINTL
 18484     ELSE
 18485        IF PI-MAP-NAME = EL631C
 18486           MOVE -1               TO CMAINTL
 18487        ELSE
 18488           MOVE -1               TO DPFENTRL.
 18489
 18490     GO TO 8200-SEND-DATAONLY.
 18491
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 343
* EL6311.cbl
 18493
 18494***************************************************************
 18495*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 18496*                                                             *
 18497*      1. START BROWSE WITH                                   *
 18498*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18499*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18500*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18501*                                                             *
 18502*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18503*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18504*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18505*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18506*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18507*               AND IS IT TO BE DISPLAYED.                    *
 18508*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18509*               DISPLAYED.                                    *
 18510*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18511*               DISPLAYED.                                    *
 18512*                                                             *
 18513*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18514*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18515***************************************************************
 18516
 18517 4200-BROWSE-CSR-FORWARD.
 18518
 18519     IF FIRST-TIME
 18520        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 18521     ELSE
 18522        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 18523
 18524
 18525* EXEC CICS HANDLE CONDITION
 18526*         NOTFND   (4250-END-RECORDS)
 18527*         ENDFILE  (4250-END-RECORDS)
 18528*    END-EXEC.
 18529*    MOVE '"$I''                  ! L #00015826' TO DFHEIV0
 18530     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18531     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18532     MOVE X'4C20233030303135383236' TO DFHEIV0(25:11)
 18533     CALL 'kxdfhei1' USING DFHEIV0
 18534     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18535
 18536
 18537
 18538* EXEC CICS STARTBR
 18539*         DATASET   (FILE-ID-ERPNDB4)
 18540*         RIDFLD    (ERPNDB-CSR-KEY)
 18541*    END-EXEC.
 18542     MOVE 0
 18543       TO DFHEIV11
 18544*    MOVE '&,         G          &   #00015831' TO DFHEIV0
 18545     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18546     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18547     MOVE X'2020233030303135383331' TO DFHEIV0(25:11)
 18548     CALL 'kxdfhei1' USING DFHEIV0,
 18549           FILE-ID-ERPNDB4,
 18550           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 344
* EL6311.cbl
 18551           DFHEIV99,
 18552           DFHEIV11,
 18553           DFHEIV99
 18554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18555
 18556
 18557     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18558
 18559     IF FIRST-TIME
 18560        MOVE SPACE               TO WS-FIRST-TIME-SW
 18561        GO TO 4205-READ-NEXT-RECORD.
 18562
 18563
 18564* EXEC CICS READNEXT
 18565*         DATASET    (FILE-ID-ERPNDB4)
 18566*         SET        (ADDRESS OF PENDING-BUSINESS)
 18567*         RIDFLD     (ERPNDB-CSR-KEY)
 18568*    END-EXEC.
 18569     MOVE 0
 18570       TO DFHEIV11
 18571*    MOVE '&.S                   )   #00015842' TO DFHEIV0
 18572     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18573     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18574     MOVE X'2020233030303135383432' TO DFHEIV0(25:11)
 18575     CALL 'kxdfhei1' USING DFHEIV0,
 18576           FILE-ID-ERPNDB4,
 18577           DFHEIV20,
 18578           DFHEIV99,
 18579           ERPNDB-CSR-KEY,
 18580           DFHEIV99,
 18581           DFHEIV11,
 18582           DFHEIV99,
 18583           DFHEIV99
 18584     SET ADDRESS OF PENDING-BUSINESS TO
 18585         DFHEIV20
 18586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18587
 18588
 18589 4205-READ-NEXT-RECORD.
 18590
 18591
 18592* EXEC CICS READNEXT
 18593*         DATASET    (FILE-ID-ERPNDB4)
 18594*         SET        (ADDRESS OF PENDING-BUSINESS)
 18595*         RIDFLD     (ERPNDB-CSR-KEY)
 18596*    END-EXEC.
 18597     MOVE 0
 18598       TO DFHEIV11
 18599*    MOVE '&.S                   )   #00015850' TO DFHEIV0
 18600     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18601     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18602     MOVE X'2020233030303135383530' TO DFHEIV0(25:11)
 18603     CALL 'kxdfhei1' USING DFHEIV0,
 18604           FILE-ID-ERPNDB4,
 18605           DFHEIV20,
 18606           DFHEIV99,
 18607           ERPNDB-CSR-KEY,
 18608           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 345
* EL6311.cbl
 18609           DFHEIV11,
 18610           DFHEIV99,
 18611           DFHEIV99
 18612     SET ADDRESS OF PENDING-BUSINESS TO
 18613         DFHEIV20
 18614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18615
 18616
 18617     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18618
 18619     IF WS-BATCH-PREFIX = '#CL'
 18620        GO TO 4205-READ-NEXT-RECORD.
 18621
 18622     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 18623        PB-CSR-ID           NOT = PI-PB-CSR-ID
 18624        GO TO 4250-END-RECORDS.
 18625
 18626     IF PB-BATCH-TRAILER
 18627        GO TO 4205-READ-NEXT-RECORD.
 18628
 18629     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18630        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18631           GO TO 4205-READ-NEXT-RECORD
 18632        ELSE
 18633           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18634              GO TO 4210-CHECK-REC-TYPE
 18635           ELSE
 18636              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18637                 GO TO 4210-CHECK-REC-TYPE
 18638              ELSE
 18639                 GO TO 4205-READ-NEXT-RECORD.
 18640
 18641     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18642        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18643           GO TO 4205-READ-NEXT-RECORD.
 18644
 18645 4210-CHECK-REC-TYPE.
 18646     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18647         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18648             NEXT SENTENCE
 18649         ELSE
 18650             GO TO 4205-READ-NEXT-RECORD.
 18651
 18652     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18653         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18654             NEXT SENTENCE
 18655        ELSE
 18656             GO TO 4205-READ-NEXT-RECORD.
 18657
 18658     IF NOT DISPLAY-CHANGE-RECORDS AND
 18659            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18660        GO TO 4205-READ-NEXT-RECORD.
 18661
 18662     IF DISPLAY-HOLD-RECORDS AND
 18663        NOT PB-RECORD-ON-HOLD
 18664          GO TO 4205-READ-NEXT-RECORD.
 18665
 18666     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 346
* EL6311.cbl
 18667        IF DISPLAY-CHK-REQ-RECORDS
 18668            GO TO 4205-READ-NEXT-RECORD.
 18669
 18670     IF PB-ISSUE
 18671        IF ISSUE-WITH-WARNING
 18672           IF PB-WARNING-ERRORS
 18673              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18674                  GO TO 4205-READ-NEXT-RECORD
 18675              ELSE
 18676                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18677                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18678                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18679                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18680                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18681                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18682                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18683                 GO TO 7000-DISPLAY-ISSUES
 18684           ELSE
 18685              GO TO 4205-READ-NEXT-RECORD.
 18686
 18687     IF PB-ISSUE
 18688        IF (ISSUES-IN-ERROR AND
 18689            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18690            ALL-ISSUES
 18691            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18692            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18693            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18694            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18695            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18696            MOVE PB-SV-STATE            TO PI-SV-STATE
 18697            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18698            GO TO 7000-DISPLAY-ISSUES
 18699        ELSE
 18700            GO TO 4205-READ-NEXT-RECORD.
 18701
 18702     IF PB-CANCELLATION
 18703        IF DISPLAY-CHK-REQ-RECORDS
 18704           IF PB-C-REFUND-REQUESTED
 18705              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18706              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18707              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18708              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18709              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18710              MOVE PB-SV-STATE            TO PI-SV-STATE
 18711              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18712              GO TO 7100-DISPLAY-CANCELS
 18713           ELSE
 18714               GO TO 4205-READ-NEXT-RECORD.
 18715
 18716     IF PB-CANCELLATION
 18717        IF CANCEL-WITH-WARNING
 18718           IF PB-WARNING-ERRORS
 18719              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18720                  GO TO 4205-READ-NEXT-RECORD
 18721              ELSE
 18722                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18723                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18724                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 347
* EL6311.cbl
 18725                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18726                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18727                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18728                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18729                 GO TO 7100-DISPLAY-CANCELS
 18730           ELSE
 18731              GO TO 4205-READ-NEXT-RECORD.
 18732
 18733     IF PB-CANCELLATION
 18734        IF (CANCEL-IN-ERROR  AND
 18735            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18736            ALL-CANCELS
 18737            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18738            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18739            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18740            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18741            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18742            MOVE PB-SV-STATE            TO PI-SV-STATE
 18743            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18744            GO TO 7100-DISPLAY-CANCELS.
 18745
 18746     GO TO 4205-READ-NEXT-RECORD.
 18747
 18748 4250-END-RECORDS.
 18749******************************************************************
 18750*                                                                *
 18751*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18752*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18753*         PROGRAM.                                               *
 18754*                                                                *
 18755******************************************************************
 18756
 18757     IF BROWSE-STARTED
 18758        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18759
 18760* EXEC CICS ENDBR
 18761*            DATASET  (FILE-ID-ERPNDB4)
 18762*       END-EXEC.
 18763     MOVE 0
 18764       TO DFHEIV11
 18765*    MOVE '&2                    $   #00015998' TO DFHEIV0
 18766     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18767     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18768     MOVE X'2020233030303135393938' TO DFHEIV0(25:11)
 18769     CALL 'kxdfhei1' USING DFHEIV0,
 18770           FILE-ID-ERPNDB4,
 18771           DFHEIV11,
 18772           DFHEIV99
 18773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18774
 18775
 18776     IF  EIBTRNID NOT = TRANS-EXB1
 18777         IF PENDING-BUS-RECS-FOUND
 18778             NEXT SENTENCE
 18779           ELSE
 18780             MOVE '9'            TO PI-BROWSE-SW
 18781             GO TO 9400-CLEAR.
 18782
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 348
* EL6311.cbl
 18783     IF SHOW-RECORD
 18784        MOVE ER-2253            TO EMI-ERROR
 18785       ELSE
 18786        MOVE ER-2254            TO EMI-ERROR.
 18787
 18788     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18789
 18790     IF PI-MAP-NAME = SPACES
 18791        MOVE -1                  TO DPFENTRL
 18792        MOVE EL631D               TO PI-MAP-NAME
 18793        GO TO 8100-SEND-INITIAL-MAP.
 18794
 18795     IF PI-MAP-NAME = EL631B
 18796        MOVE -1                  TO BMAINTL
 18797     ELSE
 18798        IF PI-MAP-NAME = EL631C
 18799           MOVE -1               TO CMAINTL
 18800        ELSE
 18801           MOVE -1               TO DPFENTRL.
 18802
 18803     GO TO 8200-SEND-DATAONLY.
 18804
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 349
* EL6311.cbl
 18806
 18807***************************************************************
 18808*                                                             *
 18809*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 18810*                                                             *
 18811*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 18812*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18813*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18814*                                                             *
 18815*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18816*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18817*          A. IS IT WITHIN THE SAME COMPANY                   *
 18818*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18819*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18820*                AND IS IT TO BE DISPLAYED.                   *
 18821*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18822*                DISPLAYED.                                   *
 18823*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18824*                DISPLAYED.                                   *
 18825*                                                             *
 18826*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18827*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18828*                                                             *
 18829*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18830*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18831*                THEY ARE NOT TO BE DISPLAYED.                *
 18832*                                                             *
 18833***************************************************************
 18834
 18835 4300-BROWSE-FILE-FORWARD.
 18836     IF FIRST-TIME OR SHOW-RECORD
 18837        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 18838        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 18839        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18840     ELSE
 18841        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18842        IF ERPNDB-BATCH-SEQ-NO = +9999
 18843           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 18844        ELSE
 18845           IF DISPLAY-CHANGE-RECORDS
 18846              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18847           ELSE
 18848              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18849              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18850
 18851
 18852* EXEC CICS HANDLE CONDITION
 18853*         ENDFILE  (4350-END-BATCH)
 18854*         NOTFND   (4350-END-BATCH)
 18855*    END-EXEC.
 18856*    MOVE '"$''I                  ! M #00016077' TO DFHEIV0
 18857     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18858     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18859     MOVE X'4D20233030303136303737' TO DFHEIV0(25:11)
 18860     CALL 'kxdfhei1' USING DFHEIV0
 18861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18862
 18863
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 350
* EL6311.cbl
 18864 4305-READ-NEXT.
 18865     IF PI-DISPLAY-ORIGINAL-BATCH
 18866        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18867     ELSE
 18868        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18869
 18870
 18871* EXEC CICS READ
 18872*         DATASET   (FILE-ID)
 18873*         SET       (ADDRESS OF PENDING-BUSINESS)
 18874*         RIDFLD    (ERPNDB-KEY)
 18875*         GTEQ
 18876*    END-EXEC.
 18877*    MOVE '&"S        G          (   #00016088' TO DFHEIV0
 18878     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18879     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18880     MOVE X'2020233030303136303838' TO DFHEIV0(25:11)
 18881     CALL 'kxdfhei1' USING DFHEIV0,
 18882           FILE-ID,
 18883           DFHEIV20,
 18884           DFHEIV99,
 18885           ERPNDB-KEY,
 18886           DFHEIV99,
 18887           DFHEIV99,
 18888           DFHEIV99
 18889     SET ADDRESS OF PENDING-BUSINESS TO
 18890         DFHEIV20
 18891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18892
 18893
 18894     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 18895        GO TO 4350-END-BATCH.
 18896
 18897     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 18898                                    WS-BATCH-NO.
 18899
 18900     IF  WS-BATCH-PREFIX = '#CL'
 18901         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18902         GO TO 4305-READ-NEXT.
 18903
 18904     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 18905     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18906     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18907     MOVE PB-STATE               TO PI-PB-STATE.
 18908     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18909
 18910     IF PB-BATCH-TRAILER
 18911        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 18912        GO TO 4305-READ-NEXT.
 18913
 18914     IF SHOW-RECORD
 18915           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18916              GO TO 4310-BUMP-SEQ
 18917           ELSE
 18918              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18919                 GO TO 4310-BUMP-SEQ
 18920              ELSE
 18921                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 351
* EL6311.cbl
 18922
 18923     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18924        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18925           GO TO 4310-BUMP-SEQ
 18926        ELSE
 18927           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18928              GO TO 4307-CHECK-REC-TYPE
 18929           ELSE
 18930              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18931                 GO TO 4307-CHECK-REC-TYPE
 18932              ELSE
 18933                 GO TO 4310-BUMP-SEQ.
 18934
 18935     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18936        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18937           GO TO 4310-BUMP-SEQ.
 18938
 18939 4307-CHECK-REC-TYPE.
 18940     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18941         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18942             NEXT SENTENCE
 18943         ELSE
 18944             GO TO 4310-BUMP-SEQ.
 18945
 18946     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18947         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18948             NEXT SENTENCE
 18949        ELSE
 18950             GO TO 4310-BUMP-SEQ.
 18951
 18952     IF NOT DISPLAY-CHANGE-RECORDS AND
 18953            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18954        GO TO 4310-BUMP-SEQ.
 18955
 18956     IF DISPLAY-HOLD-RECORDS AND
 18957        NOT PB-RECORD-ON-HOLD
 18958          GO TO 4310-BUMP-SEQ.
 18959
 18960     IF PB-ISSUE
 18961        IF DISPLAY-CHK-REQ-RECORDS
 18962           GO TO 4310-BUMP-SEQ.
 18963
 18964     IF PB-ISSUE
 18965        IF ISSUE-WITH-WARNING
 18966           IF PB-WARNING-ERRORS
 18967              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18968                  GO TO 4310-BUMP-SEQ
 18969              ELSE
 18970                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18971                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18972                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18973                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18974                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18975                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18976                 GO TO 7000-DISPLAY-ISSUES
 18977           ELSE
 18978              GO TO 4310-BUMP-SEQ.
 18979
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 352
* EL6311.cbl
 18980     IF PB-ISSUE
 18981        IF (ISSUES-IN-ERROR AND
 18982            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18983            ALL-ISSUES
 18984            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18985            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18986            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18987            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18988            MOVE PB-SV-STATE            TO PI-SV-STATE
 18989            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18990            GO TO 7000-DISPLAY-ISSUES
 18991        ELSE
 18992            GO TO 4310-BUMP-SEQ.
 18993
 18994     IF PB-CANCELLATION
 18995        IF DISPLAY-CHK-REQ-RECORDS
 18996           IF PB-C-REFUND-REQUESTED
 18997              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18998              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18999              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19000              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19001              MOVE PB-SV-STATE            TO PI-SV-STATE
 19002              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19003              GO TO 7100-DISPLAY-CANCELS
 19004           ELSE
 19005              GO TO 4310-BUMP-SEQ.
 19006
 19007     IF PB-CANCELLATION
 19008        IF CANCEL-WITH-WARNING
 19009           IF PB-WARNING-ERRORS
 19010              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19011                  GO TO 4310-BUMP-SEQ
 19012              ELSE
 19013                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19014                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19015                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19016                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19017                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19018                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19019                 GO TO 7100-DISPLAY-CANCELS
 19020           ELSE
 19021              GO TO 4310-BUMP-SEQ.
 19022
 19023     IF PB-CANCELLATION
 19024        IF (CANCEL-IN-ERROR  AND
 19025            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19026            ALL-CANCELS
 19027            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19028            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19029            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19030            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19031            MOVE PB-SV-STATE            TO PI-SV-STATE
 19032            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19033            GO TO 7100-DISPLAY-CANCELS.
 19034
 19035 4310-BUMP-SEQ.
 19036     IF NOT DISPLAY-CHANGE-RECORDS
 19037        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 353
* EL6311.cbl
 19038        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19039     ELSE
 19040        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19041           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19042           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19043        ELSE
 19044           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19045           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19046
 19047     GO TO 4305-READ-NEXT.
 19048
 19049 4350-END-BATCH.
 19050
 19051******************************************************************
 19052*                                                                *
 19053*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19054*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19055*         PROGRAM.                                               *
 19056*                                                                *
 19057******************************************************************
 19058
 19059     IF  EIBTRNID NOT = TRANS-EXB1
 19060         IF PENDING-BUS-RECS-FOUND
 19061             NEXT SENTENCE
 19062           ELSE
 19063             MOVE '9'            TO PI-BROWSE-SW
 19064             GO TO 9400-CLEAR.
 19065
 19066     IF SHOW-RECORD
 19067        MOVE ER-2253            TO EMI-ERROR
 19068     ELSE
 19069        MOVE ER-2251            TO EMI-ERROR.
 19070
 19071     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19072
 19073     IF PI-MAP-NAME = SPACES
 19074        MOVE -1                  TO BMAINTL
 19075        MOVE EL631B               TO PI-MAP-NAME
 19076        GO TO 8100-SEND-INITIAL-MAP.
 19077
 19078     IF PI-MAP-NAME = EL631B
 19079        MOVE -1                  TO BMAINTL
 19080     ELSE
 19081        IF PI-MAP-NAME = EL631C
 19082           MOVE -1               TO CMAINTL
 19083        ELSE
 19084           MOVE -1               TO DPFENTRL.
 19085
 19086     GO TO 8200-SEND-DATAONLY.
 19087
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 354
* EL6311.cbl
 19089
 19090******************************************************************
 19091*                                                                *
 19092*        B R O W S E   D E T A I L   B A C K W A R D             *
 19093*                                                                *
 19094******************************************************************
 19095
 19096 4500-BROWSE-DETAIL-BACKWARD.
 19097
 19098     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19099
 19100
 19101* EXEC CICS HANDLE CONDITION
 19102*         NOTFND   (4570-NOT-FOUND)
 19103*         ENDFILE  (4550-END-RECORDS)
 19104*    END-EXEC
 19105*    MOVE '"$I''                  ! N #00016301' TO DFHEIV0
 19106     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19108     MOVE X'4E20233030303136333031' TO DFHEIV0(25:11)
 19109     CALL 'kxdfhei1' USING DFHEIV0
 19110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19111
 19112
 19113* EXEC CICS STARTBR
 19114*         DATASET   (FILE-ID-ERPNDB2)
 19115*         RIDFLD    (ERPNDB-ALT-KEY)
 19116*    END-EXEC.
 19117     MOVE 0
 19118       TO DFHEIV11
 19119*    MOVE '&,         G          &   #00016306' TO DFHEIV0
 19120     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19121     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19122     MOVE X'2020233030303136333036' TO DFHEIV0(25:11)
 19123     CALL 'kxdfhei1' USING DFHEIV0,
 19124           FILE-ID-ERPNDB2,
 19125           ERPNDB-ALT-KEY,
 19126           DFHEIV99,
 19127           DFHEIV11,
 19128           DFHEIV99
 19129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19130
 19131
 19132     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19133                                    WS-FIRST-TIME-SW.
 19134
 19135 4505-READ-PREV-RECORD.
 19136
 19137* EXEC CICS READPREV
 19138*         DATASET    (FILE-ID-ERPNDB2)
 19139*         SET        (ADDRESS OF PENDING-BUSINESS)
 19140*         RIDFLD     (ERPNDB-ALT-KEY)
 19141*    END-EXEC.
 19142     MOVE 0
 19143       TO DFHEIV11
 19144*    MOVE '&0S                   )   #00016315' TO DFHEIV0
 19145     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19146     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 355
* EL6311.cbl
 19147     MOVE X'2020233030303136333135' TO DFHEIV0(25:11)
 19148     CALL 'kxdfhei1' USING DFHEIV0,
 19149           FILE-ID-ERPNDB2,
 19150           DFHEIV20,
 19151           DFHEIV99,
 19152           ERPNDB-ALT-KEY,
 19153           DFHEIV99,
 19154           DFHEIV11,
 19155           DFHEIV99,
 19156           DFHEIV99
 19157     SET ADDRESS OF PENDING-BUSINESS TO
 19158         DFHEIV20
 19159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19160
 19161
 19162     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19163
 19164     IF WS-BATCH-PREFIX = '#CL'
 19165         GO TO 4505-READ-PREV-RECORD.
 19166
 19167     IF FIRST-TIME
 19168         MOVE SPACE               TO WS-FIRST-TIME-SW
 19169         GO TO 4505-READ-PREV-RECORD.
 19170
 19171     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19172        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19173        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19174        PB-STATE         NOT = PI-PB-STATE    OR
 19175        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19176          GO TO 4550-END-RECORDS.
 19177
 19178
 19179     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19180
 19181     IF PB-BATCH-TRAILER
 19182        GO TO 4505-READ-PREV-RECORD.
 19183
 19184     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19185
 19186     IF  WS-BATCH-PREFIX = '#CL'
 19187         GO TO 4505-READ-PREV-RECORD.
 19188
 19189     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19190        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19191           GO TO 4505-READ-PREV-RECORD
 19192        ELSE
 19193           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19194              GO TO 4510-CHECK-REC-TYPE
 19195           ELSE
 19196              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19197                 GO TO 4510-CHECK-REC-TYPE
 19198              ELSE
 19199                 GO TO 4505-READ-PREV-RECORD.
 19200
 19201     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19202        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19203           GO TO 4505-READ-PREV-RECORD.
 19204
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 356
* EL6311.cbl
 19205 4510-CHECK-REC-TYPE.
 19206     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19207         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19208             NEXT SENTENCE
 19209         ELSE
 19210             GO TO 4505-READ-PREV-RECORD.
 19211
 19212     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19213         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19214             NEXT SENTENCE
 19215        ELSE
 19216             GO TO 4505-READ-PREV-RECORD.
 19217
 19218     IF NOT DISPLAY-CHANGE-RECORDS AND
 19219            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19220        GO TO 4505-READ-PREV-RECORD.
 19221
 19222     IF DISPLAY-HOLD-RECORDS AND
 19223        NOT PB-RECORD-ON-HOLD
 19224          GO TO 4505-READ-PREV-RECORD.
 19225
 19226     IF PB-ISSUE
 19227        IF DISPLAY-CHK-REQ-RECORDS
 19228           GO TO 4505-READ-PREV-RECORD.
 19229
 19230     IF PB-ISSUE
 19231        IF ISSUE-WITH-WARNING
 19232           IF PB-WARNING-ERRORS
 19233              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19234                  GO TO 4505-READ-PREV-RECORD
 19235              ELSE
 19236                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19237                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19238                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19239                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19240                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19241                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19242                 GO TO 7000-DISPLAY-ISSUES
 19243           ELSE
 19244              GO TO 4505-READ-PREV-RECORD.
 19245
 19246     IF PB-ISSUE
 19247        IF (ISSUES-IN-ERROR AND
 19248            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19249            ALL-ISSUES
 19250            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19251            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19252            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19253            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19254            MOVE PB-SV-STATE            TO PI-SV-STATE
 19255            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19256            GO TO 7000-DISPLAY-ISSUES
 19257        ELSE
 19258            GO TO 4505-READ-PREV-RECORD.
 19259
 19260     IF PB-CANCELLATION
 19261        IF DISPLAY-CHK-REQ-RECORDS
 19262           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 357
* EL6311.cbl
 19263              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19264              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19265              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19266              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19267              MOVE PB-SV-STATE            TO PI-SV-STATE
 19268              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19269              GO TO 7100-DISPLAY-CANCELS
 19270           ELSE
 19271              GO TO 4505-READ-PREV-RECORD.
 19272
 19273     IF PB-CANCELLATION
 19274        IF CANCEL-WITH-WARNING
 19275           IF PB-WARNING-ERRORS
 19276              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19277                  GO TO 4505-READ-PREV-RECORD
 19278              ELSE
 19279                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19280                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19281                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19282                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19283                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19284                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19285                 GO TO 7100-DISPLAY-CANCELS
 19286           ELSE
 19287              GO TO 4505-READ-PREV-RECORD.
 19288
 19289     IF PB-CANCELLATION
 19290        IF (CANCEL-IN-ERROR  AND
 19291            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19292            ALL-CANCELS
 19293            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19294            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19295            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19296            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19297            MOVE PB-SV-STATE            TO PI-SV-STATE
 19298            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19299            GO TO 7100-DISPLAY-CANCELS.
 19300
 19301     GO TO 4505-READ-PREV-RECORD.
 19302
 19303 4550-END-RECORDS.
 19304     IF PI-MAP-NAME = EL631B
 19305        MOVE -1                  TO BMAINTL
 19306     ELSE
 19307        IF PI-MAP-NAME = EL631C
 19308           MOVE -1               TO CMAINTL
 19309        ELSE
 19310           MOVE -1               TO DPFENTRL.
 19311
 19312     MOVE ER-2255               TO EMI-ERROR.
 19313     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19314     GO TO 8200-SEND-DATAONLY.
 19315
 19316 4570-NOT-FOUND.
 19317
 19318******************************************************************
 19319*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19320******************************************************************
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 358
* EL6311.cbl
 19321
 19322
 19323* EXEC CICS RESETBR
 19324*         DATASET    (FILE-ID-ERPNDB2)
 19325*         RIDFLD     (ERPNDB-ALT-KEY)
 19326*    END-EXEC.
 19327     MOVE 0
 19328       TO DFHEIV11
 19329*    MOVE '&4         G          &   #00016481' TO DFHEIV0
 19330     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19331     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19332     MOVE X'2020233030303136343831' TO DFHEIV0(25:11)
 19333     CALL 'kxdfhei1' USING DFHEIV0,
 19334           FILE-ID-ERPNDB2,
 19335           ERPNDB-ALT-KEY,
 19336           DFHEIV99,
 19337           DFHEIV11,
 19338           DFHEIV99
 19339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19340
 19341
 19342
 19343* EXEC CICS READNEXT
 19344*         DATASET    (FILE-ID-ERPNDB2)
 19345*         SET        (ADDRESS OF PENDING-BUSINESS)
 19346*         RIDFLD     (ERPNDB-ALT-KEY)
 19347*    END-EXEC.
 19348     MOVE 0
 19349       TO DFHEIV11
 19350*    MOVE '&.S                   )   #00016486' TO DFHEIV0
 19351     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19352     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19353     MOVE X'2020233030303136343836' TO DFHEIV0(25:11)
 19354     CALL 'kxdfhei1' USING DFHEIV0,
 19355           FILE-ID-ERPNDB2,
 19356           DFHEIV20,
 19357           DFHEIV99,
 19358           ERPNDB-ALT-KEY,
 19359           DFHEIV99,
 19360           DFHEIV11,
 19361           DFHEIV99,
 19362           DFHEIV99
 19363     SET ADDRESS OF PENDING-BUSINESS TO
 19364         DFHEIV20
 19365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19366
 19367
 19368
 19369* EXEC CICS READPREV
 19370*         DATASET    (FILE-ID-ERPNDB2)
 19371*         SET        (ADDRESS OF PENDING-BUSINESS)
 19372*         RIDFLD     (ERPNDB-ALT-KEY)
 19373*    END-EXEC.
 19374     MOVE 0
 19375       TO DFHEIV11
 19376*    MOVE '&0S                   )   #00016492' TO DFHEIV0
 19377     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19378     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 359
* EL6311.cbl
 19379     MOVE X'2020233030303136343932' TO DFHEIV0(25:11)
 19380     CALL 'kxdfhei1' USING DFHEIV0,
 19381           FILE-ID-ERPNDB2,
 19382           DFHEIV20,
 19383           DFHEIV99,
 19384           ERPNDB-ALT-KEY,
 19385           DFHEIV99,
 19386           DFHEIV11,
 19387           DFHEIV99,
 19388           DFHEIV99
 19389     SET ADDRESS OF PENDING-BUSINESS TO
 19390         DFHEIV20
 19391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19392
 19393
 19394 4580-READ-PREV-RECORD.
 19395
 19396* EXEC CICS READPREV
 19397*         DATASET    (FILE-ID-ERPNDB2)
 19398*         SET        (ADDRESS OF PENDING-BUSINESS)
 19399*         RIDFLD     (ERPNDB-ALT-KEY)
 19400*    END-EXEC.
 19401     MOVE 0
 19402       TO DFHEIV11
 19403*    MOVE '&0S                   )   #00016499' TO DFHEIV0
 19404     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19405     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19406     MOVE X'2020233030303136343939' TO DFHEIV0(25:11)
 19407     CALL 'kxdfhei1' USING DFHEIV0,
 19408           FILE-ID-ERPNDB2,
 19409           DFHEIV20,
 19410           DFHEIV99,
 19411           ERPNDB-ALT-KEY,
 19412           DFHEIV99,
 19413           DFHEIV11,
 19414           DFHEIV99,
 19415           DFHEIV99
 19416     SET ADDRESS OF PENDING-BUSINESS TO
 19417         DFHEIV20
 19418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19419
 19420
 19421     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19422
 19423     IF WS-BATCH-PREFIX = '#CL'
 19424        GO TO 4580-READ-PREV-RECORD.
 19425
 19426     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19427     GO TO 4505-READ-PREV-RECORD.
 19428
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 360
* EL6311.cbl
 19430
 19431******************************************************************
 19432*                                                                *
 19433*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 19434*                                                                *
 19435******************************************************************
 19436
 19437 4600-BROWSE-PRIMARY-BACKWARD.
 19438        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 19439
 19440     IF ERPNDB-BATCH-SEQ-NO = +9999
 19441        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19442
 19443        IF ERPNDB-BATCH-SEQ-NO = +0000
 19444           GO TO 4650-END-BATCH
 19445        ELSE
 19446           IF PI-MAP-NAME NOT = EL631D
 19447              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19448                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19449              ELSE
 19450                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19451                 IF DISPLAY-CHANGE-RECORDS
 19452                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19453                 ELSE
 19454                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19455
 19456
 19457* EXEC CICS HANDLE CONDITION
 19458*         NOTFND    (4680-NOT-FOUND)
 19459*         ENDFILE   (4680-NOT-FOUND)
 19460*    END-EXEC.
 19461*    MOVE '"$I''                  ! O #00016540' TO DFHEIV0
 19462     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19463     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19464     MOVE X'4F20233030303136353430' TO DFHEIV0(25:11)
 19465     CALL 'kxdfhei1' USING DFHEIV0
 19466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19467
 19468
 19469 4605-READ-NEXT.
 19470     IF ERPNDB-BATCH-SEQ-NO = +0000
 19471        GO TO 4650-END-BATCH.
 19472
 19473     IF PI-DISPLAY-ORIGINAL-BATCH
 19474        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19475     ELSE
 19476        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19477
 19478
 19479* EXEC CICS READ
 19480*         DATASET   (FILE-ID)
 19481*         SET       (ADDRESS OF PENDING-BUSINESS)
 19482*         RIDFLD    (ERPNDB-KEY)
 19483*    END-EXEC.
 19484*    MOVE '&"S        E          (   #00016554' TO DFHEIV0
 19485     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19486     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19487     MOVE X'2020233030303136353534' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 361
* EL6311.cbl
 19488     CALL 'kxdfhei1' USING DFHEIV0,
 19489           FILE-ID,
 19490           DFHEIV20,
 19491           DFHEIV99,
 19492           ERPNDB-KEY,
 19493           DFHEIV99,
 19494           DFHEIV99,
 19495           DFHEIV99
 19496     SET ADDRESS OF PENDING-BUSINESS TO
 19497         DFHEIV20
 19498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19499
 19500
 19501     IF NOT  PI-PRIMARY-WITH-SELECT
 19502        GO TO 4607-CHECK-REC-TYPE.
 19503
 19504     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19505
 19506     IF  WS-BATCH-PREFIX = '#CL'
 19507         GO TO 4610-BUMP-SEQ.
 19508
 19509     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19510        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19511           GO TO 4610-BUMP-SEQ
 19512        ELSE
 19513           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19514              GO TO 4607-CHECK-REC-TYPE
 19515           ELSE
 19516              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19517                 GO TO 4607-CHECK-REC-TYPE
 19518              ELSE
 19519                 GO TO 4610-BUMP-SEQ.
 19520
 19521     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19522        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19523           GO TO 4610-BUMP-SEQ.
 19524
 19525 4607-CHECK-REC-TYPE.
 19526     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19527         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19528             NEXT SENTENCE
 19529         ELSE
 19530             GO TO 4610-BUMP-SEQ.
 19531
 19532     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19533         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19534             NEXT SENTENCE
 19535        ELSE
 19536             GO TO 4610-BUMP-SEQ.
 19537
 19538     IF NOT DISPLAY-CHANGE-RECORDS AND
 19539            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19540        GO TO 4610-BUMP-SEQ.
 19541
 19542     IF DISPLAY-HOLD-RECORDS AND
 19543        NOT PB-RECORD-ON-HOLD
 19544          GO TO 4610-BUMP-SEQ.
 19545
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 362
* EL6311.cbl
 19546     IF PB-ISSUE
 19547        IF DISPLAY-CHK-REQ-RECORDS
 19548           GO TO 4610-BUMP-SEQ.
 19549
 19550     IF PB-ISSUE
 19551        IF ISSUE-WITH-WARNING
 19552           IF PB-WARNING-ERRORS
 19553              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19554                  GO TO 4610-BUMP-SEQ
 19555              ELSE
 19556                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19557                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19558                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19559                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19560                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19561                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19562                 GO TO 7000-DISPLAY-ISSUES
 19563           ELSE
 19564              GO TO 4610-BUMP-SEQ.
 19565
 19566     IF PB-ISSUE
 19567        IF (ISSUES-IN-ERROR AND
 19568            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19569            ALL-ISSUES
 19570            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19571            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19572            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19573            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19574            MOVE PB-SV-STATE            TO PI-SV-STATE
 19575            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19576            GO TO 7000-DISPLAY-ISSUES
 19577        ELSE
 19578            GO TO 4610-BUMP-SEQ.
 19579
 19580     IF PB-CANCELLATION
 19581        IF DISPLAY-CHK-REQ-RECORDS
 19582           IF PB-C-REFUND-REQUESTED
 19583              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19584              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19585              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19586              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19587              MOVE PB-SV-STATE            TO PI-SV-STATE
 19588              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19589              GO TO 7100-DISPLAY-CANCELS
 19590           ELSE
 19591              GO TO 4610-BUMP-SEQ.
 19592
 19593     IF PB-CANCELLATION
 19594        IF CANCEL-WITH-WARNING
 19595           IF PB-WARNING-ERRORS
 19596              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19597                  GO TO 4610-BUMP-SEQ
 19598              ELSE
 19599                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19600                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19601                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19602                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19603                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 363
* EL6311.cbl
 19604                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19605                 GO TO 7100-DISPLAY-CANCELS
 19606           ELSE
 19607              GO TO 4610-BUMP-SEQ.
 19608
 19609     IF PB-CANCELLATION
 19610        IF (CANCEL-IN-ERROR  AND
 19611            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19612            ALL-CANCELS
 19613            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19614            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19615            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19616            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19617            MOVE PB-SV-STATE            TO PI-SV-STATE
 19618            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19619            GO TO 7100-DISPLAY-CANCELS.
 19620
 19621 4610-BUMP-SEQ.
 19622     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 19623        GO TO 4650-END-BATCH.
 19624
 19625     IF DISPLAY-CHANGE-RECORDS
 19626        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19627           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 19628        ELSE
 19629           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19630           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19631        ELSE
 19632           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19633           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 19634
 19635        GO TO 4605-READ-NEXT.
 19636
 19637 4650-END-BATCH.
 19638     IF PI-MAP-NAME = EL631B
 19639        MOVE -1                  TO BMAINTL
 19640     ELSE
 19641        IF PI-MAP-NAME = EL631C
 19642           MOVE -1               TO CMAINTL
 19643        ELSE
 19644           MOVE -1               TO DPFENTRL.
 19645
 19646     MOVE ER-2252               TO EMI-ERROR.
 19647     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19648     GO TO 8200-SEND-DATAONLY.
 19649
 19650 4680-NOT-FOUND.
 19651     IF DISPLAY-CHANGE-RECORDS
 19652        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19653           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19654        ELSE
 19655           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19656           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19657     ELSE
 19658        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 19659
 19660     GO TO 4605-READ-NEXT.
 19661
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 364
* EL6311.cbl
 19663
 19664******************************************************************
 19665*                                                                *
 19666*        B R O W S E   F I L E   B A C K W A R D S               *
 19667*                                                                *
 19668******************************************************************
 19669
 19670 4800-BROWSE-FILE-BACKWARD.
 19671
 19672* EXEC CICS HANDLE CONDITION
 19673*         NOTFND   (4860-NOT-FOUND)
 19674*         ENDFILE  (4850-END-RECORDS)
 19675*    END-EXEC.
 19676*    MOVE '"$I''                  ! P #00016730' TO DFHEIV0
 19677     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19678     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19679     MOVE X'5020233030303136373330' TO DFHEIV0(25:11)
 19680     CALL 'kxdfhei1' USING DFHEIV0
 19681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19682
 19683
 19684     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 19685
 19686     IF PI-DISPLAY-ORIGINAL-BATCH
 19687        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19688     ELSE
 19689        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19690
 19691
 19692* EXEC CICS STARTBR
 19693*         DATASET   (FILE-ID)
 19694*         RIDFLD    (ERPNDB-KEY)
 19695*    END-EXEC.
 19696     MOVE 0
 19697       TO DFHEIV11
 19698*    MOVE '&,         G          &   #00016742' TO DFHEIV0
 19699     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19700     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19701     MOVE X'2020233030303136373432' TO DFHEIV0(25:11)
 19702     CALL 'kxdfhei1' USING DFHEIV0,
 19703           FILE-ID,
 19704           ERPNDB-KEY,
 19705           DFHEIV99,
 19706           DFHEIV11,
 19707           DFHEIV99
 19708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19709
 19710
 19711     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19712
 19713
 19714* EXEC CICS READPREV
 19715*         DATASET    (FILE-ID-ERPNDB)
 19716*         SET        (ADDRESS OF PENDING-BUSINESS)
 19717*         RIDFLD     (ERPNDB-KEY)
 19718*    END-EXEC.
 19719     MOVE 0
 19720       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 365
* EL6311.cbl
 19721*    MOVE '&0S                   )   #00016749' TO DFHEIV0
 19722     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19723     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19724     MOVE X'2020233030303136373439' TO DFHEIV0(25:11)
 19725     CALL 'kxdfhei1' USING DFHEIV0,
 19726           FILE-ID-ERPNDB,
 19727           DFHEIV20,
 19728           DFHEIV99,
 19729           ERPNDB-KEY,
 19730           DFHEIV99,
 19731           DFHEIV11,
 19732           DFHEIV99,
 19733           DFHEIV99
 19734     SET ADDRESS OF PENDING-BUSINESS TO
 19735         DFHEIV20
 19736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19737
 19738
 19739 4810-READ-PREV-RECORD.
 19740
 19741* EXEC CICS READPREV
 19742*         DATASET    (FILE-ID-ERPNDB)
 19743*         SET        (ADDRESS OF PENDING-BUSINESS)
 19744*         RIDFLD     (ERPNDB-KEY)
 19745*    END-EXEC.
 19746     MOVE 0
 19747       TO DFHEIV11
 19748*    MOVE '&0S                   )   #00016756' TO DFHEIV0
 19749     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19750     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19751     MOVE X'2020233030303136373536' TO DFHEIV0(25:11)
 19752     CALL 'kxdfhei1' USING DFHEIV0,
 19753           FILE-ID-ERPNDB,
 19754           DFHEIV20,
 19755           DFHEIV99,
 19756           ERPNDB-KEY,
 19757           DFHEIV99,
 19758           DFHEIV11,
 19759           DFHEIV99,
 19760           DFHEIV99
 19761     SET ADDRESS OF PENDING-BUSINESS TO
 19762         DFHEIV20
 19763     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19764
 19765
 19766     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 19767        GO TO 4850-END-RECORDS.
 19768
 19769     IF PB-BATCH-TRAILER
 19770        GO TO 4810-READ-PREV-RECORD.
 19771
 19772     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19773
 19774     IF  WS-BATCH-PREFIX = '#CL'
 19775         GO TO 4810-READ-PREV-RECORD.
 19776
 19777     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19778        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 366
* EL6311.cbl
 19779           GO TO 4810-READ-PREV-RECORD
 19780        ELSE
 19781           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19782              GO TO 4820-CHECK-REC-TYPE
 19783           ELSE
 19784              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19785                 GO TO 4820-CHECK-REC-TYPE
 19786              ELSE
 19787                 GO TO 4810-READ-PREV-RECORD.
 19788
 19789     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19790        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19791           GO TO 4810-READ-PREV-RECORD.
 19792
 19793 4820-CHECK-REC-TYPE.
 19794     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19795         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19796             NEXT SENTENCE
 19797         ELSE
 19798             GO TO 4810-READ-PREV-RECORD.
 19799
 19800     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19801         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19802             NEXT SENTENCE
 19803        ELSE
 19804             GO TO 4810-READ-PREV-RECORD.
 19805
 19806     IF NOT DISPLAY-CHANGE-RECORDS AND
 19807            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19808        GO TO 4810-READ-PREV-RECORD.
 19809
 19810     IF DISPLAY-HOLD-RECORDS AND
 19811        NOT PB-RECORD-ON-HOLD
 19812          GO TO 4810-READ-PREV-RECORD.
 19813
 19814     IF PB-ISSUE
 19815        IF DISPLAY-CHK-REQ-RECORDS
 19816           GO TO 4810-READ-PREV-RECORD.
 19817
 19818     IF PB-ISSUE
 19819        IF ISSUE-WITH-WARNING
 19820           IF PB-WARNING-ERRORS
 19821              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19822                  GO TO 4810-READ-PREV-RECORD
 19823              ELSE
 19824                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19825                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19826                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19827                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19828                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19829                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19830                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19831                 GO TO 7000-DISPLAY-ISSUES
 19832           ELSE
 19833              GO TO 4810-READ-PREV-RECORD.
 19834
 19835     IF PB-ISSUE
 19836        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 367
* EL6311.cbl
 19837            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19838            ALL-ISSUES
 19839            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19840            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19841            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19842            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19843            MOVE PB-SV-STATE            TO PI-SV-STATE
 19844            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19845            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19846            GO TO 7000-DISPLAY-ISSUES
 19847        ELSE
 19848            GO TO 4810-READ-PREV-RECORD.
 19849
 19850     IF PB-CANCELLATION
 19851        IF DISPLAY-CHK-REQ-RECORDS
 19852           IF PB-C-REFUND-REQUESTED
 19853              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19854              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19855              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19856              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19857              MOVE PB-SV-STATE            TO PI-SV-STATE
 19858              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19859              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19860              GO TO 7100-DISPLAY-CANCELS
 19861           ELSE
 19862              GO TO 4810-READ-PREV-RECORD.
 19863
 19864     IF PB-CANCELLATION
 19865        IF CANCEL-WITH-WARNING
 19866           IF PB-WARNING-ERRORS
 19867              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19868                  GO TO 4810-READ-PREV-RECORD
 19869              ELSE
 19870                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19871                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19872                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19873                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19874                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19875                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19876                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19877                 GO TO 7100-DISPLAY-CANCELS
 19878           ELSE
 19879              GO TO 4810-READ-PREV-RECORD.
 19880
 19881     IF PB-CANCELLATION
 19882        IF (CANCEL-IN-ERROR  AND
 19883            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19884            ALL-CANCELS
 19885            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19886            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19887            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19888            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19889            MOVE PB-SV-STATE            TO PI-SV-STATE
 19890            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19891            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19892            GO TO 7100-DISPLAY-CANCELS.
 19893
 19894     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 368
* EL6311.cbl
 19895
 19896 4850-END-RECORDS.
 19897     MOVE ER-2252                TO EMI-ERROR.
 19898     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19899
 19900     IF PI-MAP-NAME = EL631B
 19901        MOVE -1                  TO BPFENTRL
 19902     ELSE
 19903        MOVE -1                  TO CPFENTRL.
 19904
 19905     GO TO 8200-SEND-DATAONLY.
 19906
 19907 4860-NOT-FOUND.
 19908
 19909******************************************************************
 19910*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 19911******************************************************************
 19912
 19913
 19914* EXEC CICS RESETBR
 19915*         DATASET    (FILE-ID-ERPNDB)
 19916*         RIDFLD     (ERPNDB-KEY)
 19917*     END-EXEC.
 19918     MOVE 0
 19919       TO DFHEIV11
 19920*    MOVE '&4         G          &   #00016909' TO DFHEIV0
 19921     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19922     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19923     MOVE X'2020233030303136393039' TO DFHEIV0(25:11)
 19924     CALL 'kxdfhei1' USING DFHEIV0,
 19925           FILE-ID-ERPNDB,
 19926           ERPNDB-KEY,
 19927           DFHEIV99,
 19928           DFHEIV11,
 19929           DFHEIV99
 19930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19931
 19932
 19933
 19934* EXEC CICS READNEXT
 19935*         DATASET    (FILE-ID-ERPNDB)
 19936*         SET        (ADDRESS OF PENDING-BUSINESS)
 19937*         RIDFLD     (ERPNDB-KEY)
 19938*    END-EXEC.
 19939     MOVE 0
 19940       TO DFHEIV11
 19941*    MOVE '&.S                   )   #00016914' TO DFHEIV0
 19942     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19943     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19944     MOVE X'2020233030303136393134' TO DFHEIV0(25:11)
 19945     CALL 'kxdfhei1' USING DFHEIV0,
 19946           FILE-ID-ERPNDB,
 19947           DFHEIV20,
 19948           DFHEIV99,
 19949           ERPNDB-KEY,
 19950           DFHEIV99,
 19951           DFHEIV11,
 19952           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 369
* EL6311.cbl
 19953           DFHEIV99
 19954     SET ADDRESS OF PENDING-BUSINESS TO
 19955         DFHEIV20
 19956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19957
 19958
 19959
 19960* EXEC CICS READPREV
 19961*         DATASET    (FILE-ID-ERPNDB)
 19962*         SET        (ADDRESS OF PENDING-BUSINESS)
 19963*         RIDFLD     (ERPNDB-KEY)
 19964*    END-EXEC.
 19965     MOVE 0
 19966       TO DFHEIV11
 19967*    MOVE '&0S                   )   #00016920' TO DFHEIV0
 19968     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19969     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19970     MOVE X'2020233030303136393230' TO DFHEIV0(25:11)
 19971     CALL 'kxdfhei1' USING DFHEIV0,
 19972           FILE-ID-ERPNDB,
 19973           DFHEIV20,
 19974           DFHEIV99,
 19975           ERPNDB-KEY,
 19976           DFHEIV99,
 19977           DFHEIV11,
 19978           DFHEIV99,
 19979           DFHEIV99
 19980     SET ADDRESS OF PENDING-BUSINESS TO
 19981         DFHEIV20
 19982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19983
 19984
 19985     GO TO 4810-READ-PREV-RECORD.
 19986
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 370
* EL6311.cbl
 19988
 19989******************************************************************
 19990*                                                                *
 19991*           B R O W S E   C S R   B A C K W A R D                *
 19992*                                                                *
 19993******************************************************************
 19994
 19995 4900-BROWSE-CSR-BACKWARD.
 19996
 19997     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19998
 19999
 20000* EXEC CICS HANDLE CONDITION
 20001*         NOTFND   (4970-NOT-FOUND)
 20002*         ENDFILE  (4950-END-RECORDS)
 20003*    END-EXEC
 20004*    MOVE '"$I''                  ! Q #00016940' TO DFHEIV0
 20005     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20006     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20007     MOVE X'5120233030303136393430' TO DFHEIV0(25:11)
 20008     CALL 'kxdfhei1' USING DFHEIV0
 20009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20010
 20011
 20012* EXEC CICS STARTBR
 20013*         DATASET   (FILE-ID-ERPNDB4)
 20014*         RIDFLD    (ERPNDB-CSR-KEY)
 20015*    END-EXEC.
 20016     MOVE 0
 20017       TO DFHEIV11
 20018*    MOVE '&,         G          &   #00016945' TO DFHEIV0
 20019     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20020     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20021     MOVE X'2020233030303136393435' TO DFHEIV0(25:11)
 20022     CALL 'kxdfhei1' USING DFHEIV0,
 20023           FILE-ID-ERPNDB4,
 20024           ERPNDB-CSR-KEY,
 20025           DFHEIV99,
 20026           DFHEIV11,
 20027           DFHEIV99
 20028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20029
 20030
 20031     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20032                                    WS-FIRST-TIME-SW.
 20033
 20034 4905-READ-PREV-RECORD.
 20035
 20036* EXEC CICS READPREV
 20037*         DATASET    (FILE-ID-ERPNDB4)
 20038*         SET        (ADDRESS OF PENDING-BUSINESS)
 20039*         RIDFLD     (ERPNDB-CSR-KEY)
 20040*    END-EXEC.
 20041     MOVE 0
 20042       TO DFHEIV11
 20043*    MOVE '&0S                   )   #00016954' TO DFHEIV0
 20044     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20045     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 371
* EL6311.cbl
 20046     MOVE X'2020233030303136393534' TO DFHEIV0(25:11)
 20047     CALL 'kxdfhei1' USING DFHEIV0,
 20048           FILE-ID-ERPNDB4,
 20049           DFHEIV20,
 20050           DFHEIV99,
 20051           ERPNDB-CSR-KEY,
 20052           DFHEIV99,
 20053           DFHEIV11,
 20054           DFHEIV99,
 20055           DFHEIV99
 20056     SET ADDRESS OF PENDING-BUSINESS TO
 20057         DFHEIV20
 20058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20059
 20060
 20061     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20062
 20063     IF WS-BATCH-PREFIX = '#CL'
 20064         GO TO 4905-READ-PREV-RECORD.
 20065
 20066     IF FIRST-TIME
 20067         MOVE SPACE               TO WS-FIRST-TIME-SW
 20068         GO TO 4905-READ-PREV-RECORD.
 20069
 20070     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20071        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20072        GO TO 4950-END-RECORDS.
 20073
 20074     IF PB-BATCH-TRAILER
 20075        GO TO 4905-READ-PREV-RECORD.
 20076
 20077     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20078
 20079     IF  WS-BATCH-PREFIX = '#CL'
 20080         GO TO 4905-READ-PREV-RECORD.
 20081
 20082     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20083        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20084           GO TO 4905-READ-PREV-RECORD
 20085        ELSE
 20086           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20087              GO TO 4910-CHECK-REC-TYPE
 20088           ELSE
 20089              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20090                 GO TO 4910-CHECK-REC-TYPE
 20091              ELSE
 20092                 GO TO 4905-READ-PREV-RECORD.
 20093
 20094     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20095        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20096           GO TO 4905-READ-PREV-RECORD.
 20097
 20098 4910-CHECK-REC-TYPE.
 20099     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20100         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20101             NEXT SENTENCE
 20102         ELSE
 20103             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 372
* EL6311.cbl
 20104
 20105     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20106         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20107             NEXT SENTENCE
 20108        ELSE
 20109             GO TO 4905-READ-PREV-RECORD.
 20110
 20111     IF NOT DISPLAY-CHANGE-RECORDS AND
 20112            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20113        GO TO 4905-READ-PREV-RECORD.
 20114
 20115     IF DISPLAY-HOLD-RECORDS AND
 20116        NOT PB-RECORD-ON-HOLD
 20117          GO TO 4905-READ-PREV-RECORD.
 20118
 20119     IF PB-ISSUE
 20120        IF DISPLAY-CHK-REQ-RECORDS
 20121           GO TO 4905-READ-PREV-RECORD.
 20122
 20123     IF PB-ISSUE
 20124        IF ISSUE-WITH-WARNING
 20125           IF PB-WARNING-ERRORS
 20126              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20127                  GO TO 4505-READ-PREV-RECORD
 20128              ELSE
 20129                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20130                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20131                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20132                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20133                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20134                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20135                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20136                 GO TO 7000-DISPLAY-ISSUES
 20137           ELSE
 20138              GO TO 4905-READ-PREV-RECORD.
 20139
 20140     IF PB-ISSUE
 20141        IF (ISSUES-IN-ERROR AND
 20142            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20143            ALL-ISSUES
 20144            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20145            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20146            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20147            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20148            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20149            MOVE PB-SV-STATE            TO PI-SV-STATE
 20150            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20151            GO TO 7000-DISPLAY-ISSUES
 20152        ELSE
 20153            GO TO 4905-READ-PREV-RECORD.
 20154
 20155     IF PB-CANCELLATION
 20156        IF DISPLAY-CHK-REQ-RECORDS
 20157           IF PB-C-REFUND-REQUESTED
 20158              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20159              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20160              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20161              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 373
* EL6311.cbl
 20162              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20163              MOVE PB-SV-STATE            TO PI-SV-STATE
 20164              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20165              GO TO 7100-DISPLAY-CANCELS
 20166           ELSE
 20167              GO TO 4905-READ-PREV-RECORD.
 20168
 20169     IF PB-CANCELLATION
 20170        IF CANCEL-WITH-WARNING
 20171           IF PB-WARNING-ERRORS
 20172              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20173                  GO TO 4505-READ-PREV-RECORD
 20174              ELSE
 20175                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20176                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20177                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20178                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20179                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20180                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20181                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20182                 GO TO 7100-DISPLAY-CANCELS
 20183           ELSE
 20184              GO TO 4905-READ-PREV-RECORD.
 20185
 20186     IF PB-CANCELLATION
 20187        IF (CANCEL-IN-ERROR  AND
 20188            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20189            ALL-CANCELS
 20190            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20191            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20192            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20193            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20194            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20195            MOVE PB-SV-STATE            TO PI-SV-STATE
 20196            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20197            GO TO 7100-DISPLAY-CANCELS.
 20198
 20199     GO TO 4905-READ-PREV-RECORD.
 20200
 20201 4950-END-RECORDS.
 20202     IF PI-MAP-NAME = EL631B
 20203        MOVE -1                  TO BMAINTL
 20204     ELSE
 20205        IF PI-MAP-NAME = EL631C
 20206           MOVE -1               TO CMAINTL
 20207        ELSE
 20208           MOVE -1               TO DPFENTRL.
 20209
 20210     MOVE ER-2255               TO EMI-ERROR.
 20211     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20212     GO TO 8200-SEND-DATAONLY.
 20213
 20214 4970-NOT-FOUND.
 20215
 20216******************************************************************
 20217*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20218******************************************************************
 20219
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 374
* EL6311.cbl
 20220
 20221* EXEC CICS RESETBR
 20222*         DATASET    (FILE-ID-ERPNDB4)
 20223*         RIDFLD     (ERPNDB-CSR-KEY)
 20224*    END-EXEC.
 20225     MOVE 0
 20226       TO DFHEIV11
 20227*    MOVE '&4         G          &   #00017119' TO DFHEIV0
 20228     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20229     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20230     MOVE X'2020233030303137313139' TO DFHEIV0(25:11)
 20231     CALL 'kxdfhei1' USING DFHEIV0,
 20232           FILE-ID-ERPNDB4,
 20233           ERPNDB-CSR-KEY,
 20234           DFHEIV99,
 20235           DFHEIV11,
 20236           DFHEIV99
 20237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20238
 20239
 20240
 20241* EXEC CICS READNEXT
 20242*         DATASET    (FILE-ID-ERPNDB4)
 20243*         SET        (ADDRESS OF PENDING-BUSINESS)
 20244*         RIDFLD     (ERPNDB-CSR-KEY)
 20245*    END-EXEC.
 20246     MOVE 0
 20247       TO DFHEIV11
 20248*    MOVE '&.S                   )   #00017124' TO DFHEIV0
 20249     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20250     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20251     MOVE X'2020233030303137313234' TO DFHEIV0(25:11)
 20252     CALL 'kxdfhei1' USING DFHEIV0,
 20253           FILE-ID-ERPNDB4,
 20254           DFHEIV20,
 20255           DFHEIV99,
 20256           ERPNDB-CSR-KEY,
 20257           DFHEIV99,
 20258           DFHEIV11,
 20259           DFHEIV99,
 20260           DFHEIV99
 20261     SET ADDRESS OF PENDING-BUSINESS TO
 20262         DFHEIV20
 20263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20264
 20265
 20266
 20267* EXEC CICS READPREV
 20268*         DATASET    (FILE-ID-ERPNDB4)
 20269*         SET        (ADDRESS OF PENDING-BUSINESS)
 20270*         RIDFLD     (ERPNDB-CSR-KEY)
 20271*    END-EXEC.
 20272     MOVE 0
 20273       TO DFHEIV11
 20274*    MOVE '&0S                   )   #00017130' TO DFHEIV0
 20275     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20276     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20277     MOVE X'2020233030303137313330' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 375
* EL6311.cbl
 20278     CALL 'kxdfhei1' USING DFHEIV0,
 20279           FILE-ID-ERPNDB4,
 20280           DFHEIV20,
 20281           DFHEIV99,
 20282           ERPNDB-CSR-KEY,
 20283           DFHEIV99,
 20284           DFHEIV11,
 20285           DFHEIV99,
 20286           DFHEIV99
 20287     SET ADDRESS OF PENDING-BUSINESS TO
 20288         DFHEIV20
 20289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20290
 20291
 20292 4980-READ-PREV-RECORD.
 20293
 20294* EXEC CICS READPREV
 20295*         DATASET    (FILE-ID-ERPNDB4)
 20296*         SET        (ADDRESS OF PENDING-BUSINESS)
 20297*         RIDFLD     (ERPNDB-CSR-KEY)
 20298*    END-EXEC.
 20299     MOVE 0
 20300       TO DFHEIV11
 20301*    MOVE '&0S                   )   #00017137' TO DFHEIV0
 20302     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20303     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20304     MOVE X'2020233030303137313337' TO DFHEIV0(25:11)
 20305     CALL 'kxdfhei1' USING DFHEIV0,
 20306           FILE-ID-ERPNDB4,
 20307           DFHEIV20,
 20308           DFHEIV99,
 20309           ERPNDB-CSR-KEY,
 20310           DFHEIV99,
 20311           DFHEIV11,
 20312           DFHEIV99,
 20313           DFHEIV99
 20314     SET ADDRESS OF PENDING-BUSINESS TO
 20315         DFHEIV20
 20316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20317
 20318
 20319     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20320
 20321     IF WS-BATCH-PREFIX = '#CL'
 20322        GO TO 4980-READ-PREV-RECORD.
 20323
 20324     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20325     GO TO 4905-READ-PREV-RECORD.
 20326
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 376
* EL6311.cbl
 20328
 20329
 20330******************************************************************
 20331*                                                                *
 20332*        B R O W S E   B A T C H   H E A D E R S                 *
 20333*                                                                *
 20334******************************************************************
 20335
 20336 5000-BROWSE-BATCH-HEADERS.
 20337
 20338     IF EIBTRNID NOT = TRANS-EXB1
 20339        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 20340        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20341        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20342        GO TO 5010-READ-NEXT-RECORD.
 20343
 20344     IF EIBAID = DFHPF4
 20345        MOVE '0'                TO PI-EDIT-SW
 20346        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 20347        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 20348        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 20349        GO TO 5010-READ-NEXT-RECORD.
 20350
 20351     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20352     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 20353     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20354
 20355
 20356* EXEC CICS HANDLE CONDITION
 20357*         ENDFILE  (5050-NOT-FOUND)
 20358*    END-EXEC.
 20359*    MOVE '"$''                   ! R #00017179' TO DFHEIV0
 20360     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 20361     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20362     MOVE X'5220233030303137313739' TO DFHEIV0(25:11)
 20363     CALL 'kxdfhei1' USING DFHEIV0
 20364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20365
 20366
 20367 5010-READ-NEXT-RECORD.
 20368
 20369* EXEC CICS HANDLE CONDITION
 20370*         NOTFND    (5050-NOT-FOUND)
 20371*    END-EXEC.
 20372*    MOVE '"$I                   ! S #00017184' TO DFHEIV0
 20373     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20374     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20375     MOVE X'5320233030303137313834' TO DFHEIV0(25:11)
 20376     CALL 'kxdfhei1' USING DFHEIV0
 20377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20378
 20379
 20380
 20381* EXEC CICS READ
 20382*         DATASET   (FILE-ID-ERPNDB)
 20383*         SET       (ADDRESS OF PENDING-BUSINESS)
 20384*         RIDFLD    (ERPNDB-KEY)
 20385*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 377
* EL6311.cbl
 20386*    END-EXEC.
 20387*    MOVE '&"S        G          (   #00017188' TO DFHEIV0
 20388     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20389     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20390     MOVE X'2020233030303137313838' TO DFHEIV0(25:11)
 20391     CALL 'kxdfhei1' USING DFHEIV0,
 20392           FILE-ID-ERPNDB,
 20393           DFHEIV20,
 20394           DFHEIV99,
 20395           ERPNDB-KEY,
 20396           DFHEIV99,
 20397           DFHEIV99,
 20398           DFHEIV99
 20399     SET ADDRESS OF PENDING-BUSINESS TO
 20400         DFHEIV20
 20401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20402
 20403
 20404     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 20405         GO TO 5050-NOT-FOUND.
 20406
 20407     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20408
 20409     IF WS-BATCH-PREFIX = '#CL'
 20410         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20411         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 20412         GO TO 5010-READ-NEXT-RECORD.
 20413
 20414     IF NOT PB-BATCH-TRAILER
 20415         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20416         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 20417         GO TO 5010-READ-NEXT-RECORD.
 20418
 20419     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20420         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20421             NEXT SENTENCE
 20422         ELSE
 20423             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 20424             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20425             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20426             GO TO 5010-READ-NEXT-RECORD.
 20427
 20428     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20429         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20430             NEXT SENTENCE
 20431        ELSE
 20432             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 20433             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 20434             GO TO 5010-READ-NEXT-RECORD.
 20435
 20436     IF EIBAID = DFHPF4
 20437        MOVE '0'                TO PI-EDIT-SW
 20438        GO TO 7200-DISPLAY-BATCHES.
 20439
 20440     IF PI-CSR-BROWSE
 20441        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20442           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20443           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 378
* EL6311.cbl
 20444           GO TO 5010-READ-NEXT-RECORD.
 20445
 20446     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20447       IF PI-PB-CARRIER    = SPACES AND
 20448          PI-PB-GROUPING   = SPACES AND
 20449          PI-PB-STATE      = SPACES AND
 20450          PI-PB-ACCOUNT    = SPACES
 20451            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20452            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20453            GO TO 7200-DISPLAY-BATCHES
 20454         ELSE
 20455           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20456              PI-PB-GROUPING   = PB-GROUPING AND
 20457              PI-PB-STATE      = PB-STATE    AND
 20458              PI-PB-ACCOUNT    = PB-ACCOUNT
 20459              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20460              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20461              GO TO 7200-DISPLAY-BATCHES.
 20462
 20463     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20464     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20465
 20466
 20467* EXEC CICS HANDLE CONDITION
 20468*         NOTFND    (5050-NOT-FOUND)
 20469*    END-EXEC.
 20470*    MOVE '"$I                   ! T #00017257' TO DFHEIV0
 20471     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20472     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20473     MOVE X'5420233030303137323537' TO DFHEIV0(25:11)
 20474     CALL 'kxdfhei1' USING DFHEIV0
 20475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20476
 20477
 20478
 20479* EXEC CICS READ
 20480*         DATASET   (FILE-ID-ERPNDB)
 20481*         SET       (ADDRESS OF PENDING-BUSINESS)
 20482*         RIDFLD    (ERPNDB-KEY)
 20483*         GTEQ
 20484*    END-EXEC.
 20485*    MOVE '&"S        G          (   #00017261' TO DFHEIV0
 20486     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20487     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20488     MOVE X'2020233030303137323631' TO DFHEIV0(25:11)
 20489     CALL 'kxdfhei1' USING DFHEIV0,
 20490           FILE-ID-ERPNDB,
 20491           DFHEIV20,
 20492           DFHEIV99,
 20493           ERPNDB-KEY,
 20494           DFHEIV99,
 20495           DFHEIV99,
 20496           DFHEIV99
 20497     SET ADDRESS OF PENDING-BUSINESS TO
 20498         DFHEIV20
 20499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20500
 20501
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 379
* EL6311.cbl
 20502     GO TO 5010-READ-NEXT-RECORD.
 20503
 20504 5050-NOT-FOUND.
 20505
 20506******************************************************************
 20507*                                                                *
 20508*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 20509*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 20510*         PROGRAM.                                               *
 20511*                                                                *
 20512******************************************************************
 20513
 20514     IF EIBTRNID NOT = TRANS-EXB1
 20515        IF PENDING-BUS-RECS-FOUND
 20516            NEXT SENTENCE
 20517          ELSE
 20518            MOVE '9'            TO PI-BROWSE-SW
 20519            GO TO 9400-CLEAR.
 20520
 20521     MOVE ER-2256                TO EMI-ERROR.
 20522     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20523
 20524     IF PI-MAP-NAME = SPACES
 20525        MOVE EL631D              TO PI-MAP-NAME
 20526        MOVE -1                  TO DPFENTRL
 20527        GO TO 8100-SEND-INITIAL-MAP.
 20528
 20529     IF PI-MAP-NAME = EL631B
 20530        MOVE -1                  TO BMAINTL
 20531     ELSE
 20532        IF PI-MAP-NAME = EL631C
 20533           MOVE -1               TO CMAINTL
 20534        ELSE
 20535           MOVE -1               TO DPFENTRL
 20536           GO TO 8200-SEND-DATAONLY.
 20537
 20538     GO TO 8100-SEND-INITIAL-MAP.
 20539
 20540     .
 20541 5100-PROCESS-POL-RESC.
 20542     MOVE ZEROS                  TO CG-LF-BENCD
 20543                                    CG-AH-BENCD
 20544                                    CG-LF-CAN-AMT
 20545                                    CG-AH-CAN-AMT
 20546     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20547                                    CG-AH-CAN-DT
 20548     MOVE SPACES                 TO CG-BATCH-NO
 20549     MOVE '4'                    TO CG-OPTION-CODE
 20550     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 20551     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 20552     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 20553     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 20554     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 20555     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 20556     MOVE PI-SV-STATE            TO CG-CERT-STATE
 20557     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 20558     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 20559     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 380
* EL6311.cbl
 20560     MOVE PI-PREV-ALT-KEY (1:33)
 20561                                 TO CG-CERT-KEY
 20562     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 20563     MOVE ZEROS                  TO CG-LF-CAN-AMT
 20564                                    CG-AH-CAN-AMT
 20565     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20566                                    CG-AH-CAN-DT
 20567     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 20568     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 20569      display 'about to cancel ' cg-cert-key
 20570
 20571* EXEC CICS LINK
 20572*        PROGRAM  ('ELCANC')
 20573*        COMMAREA (CANCEL-GEN-PASS-AREA)
 20574*    END-EXEC
 20575     MOVE LENGTH OF
 20576      CANCEL-GEN-PASS-AREA
 20577       TO DFHEIV11
 20578     MOVE 'ELCANC' TO DFHEIV1
 20579*    MOVE '."C                   (   #00017336' TO DFHEIV0
 20580     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20581     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20582     MOVE X'2020233030303137333336' TO DFHEIV0(25:11)
 20583     CALL 'kxdfhei1' USING DFHEIV0,
 20584           DFHEIV1,
 20585           CANCEL-GEN-PASS-AREA,
 20586           DFHEIV11,
 20587           DFHEIV99,
 20588           DFHEIV99,
 20589           DFHEIV99,
 20590           DFHEIV99
 20591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20592     IF CG-SUCCESS
 20593        CONTINUE
 20594     ELSE
 20595        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 20596        MOVE '3'                 TO EMI-SWITCH1
 20597        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 20598        EVALUATE TRUE
 20599           WHEN CG-DATE-ERROR
 20600             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20601           WHEN CG-CERT-NOT-FOUND
 20602             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20603           WHEN CG-AMOUNT-ERROR
 20604             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20605           WHEN CG-OPTION-ERROR
 20606             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20607           WHEN CG-PREV-CAN
 20608             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20609           WHEN CG-INVALID-DATA
 20610             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20611           WHEN CG-NO-ACCT-MSTR
 20612             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20613           WHEN CG-SFX-A-EXIST
 20614             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20615           WHEN CG-MISC-ERROR
 20616             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20617           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 381
* EL6311.cbl
 20618             MOVE ' ERROR - ELCANC - RETURN '
 20619                                 TO EMI-ERROR-TEXT (1) (12:25)
 20620        END-EVALUATE
 20621        GO TO 8200-SEND-DATAONLY
 20622     END-IF
 20623     .
 20624 5100-EXIT.
 20625     EXIT.
 20626
 20627******************************************************************
 20628*                                                                *
 20629*        B R O W S E   B A T C H   B A C K W A R D S             *
 20630*                                                                *
 20631******************************************************************
 20632
 20633 5500-BROWSE-BATCH-BACKWARD.
 20634
 20635* EXEC CICS HANDLE CONDITION
 20636*         NOTFND   (5550-END-RECORDS)
 20637*         ENDFILE  (5550-END-RECORDS)
 20638*    END-EXEC.
 20639*    MOVE '"$I''                  ! U #00017382' TO DFHEIV0
 20640     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20641     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20642     MOVE X'5520233030303137333832' TO DFHEIV0(25:11)
 20643     CALL 'kxdfhei1' USING DFHEIV0
 20644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20645
 20646
 20647 5505-START-BROWSE.
 20648     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20649     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 20650     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20651
 20652
 20653* EXEC CICS STARTBR
 20654*         DATASET   (FILE-ID-ERPNDB)
 20655*         RIDFLD    (ERPNDB-ALT-KEY)
 20656*    END-EXEC.
 20657     MOVE 0
 20658       TO DFHEIV11
 20659*    MOVE '&,         G          &   #00017392' TO DFHEIV0
 20660     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20661     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20662     MOVE X'2020233030303137333932' TO DFHEIV0(25:11)
 20663     CALL 'kxdfhei1' USING DFHEIV0,
 20664           FILE-ID-ERPNDB,
 20665           ERPNDB-ALT-KEY,
 20666           DFHEIV99,
 20667           DFHEIV11,
 20668           DFHEIV99
 20669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20670
 20671
 20672     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20673
 20674
 20675* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 382
* EL6311.cbl
 20676*         DATASET    (FILE-ID-ERPNDB)
 20677*         SET        (ADDRESS OF PENDING-BUSINESS)
 20678*         RIDFLD     (ERPNDB-KEY)
 20679*    END-EXEC.
 20680     MOVE 0
 20681       TO DFHEIV11
 20682*    MOVE '&.S                   )   #00017399' TO DFHEIV0
 20683     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20684     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20685     MOVE X'2020233030303137333939' TO DFHEIV0(25:11)
 20686     CALL 'kxdfhei1' USING DFHEIV0,
 20687           FILE-ID-ERPNDB,
 20688           DFHEIV20,
 20689           DFHEIV99,
 20690           ERPNDB-KEY,
 20691           DFHEIV99,
 20692           DFHEIV11,
 20693           DFHEIV99,
 20694           DFHEIV99
 20695     SET ADDRESS OF PENDING-BUSINESS TO
 20696         DFHEIV20
 20697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20698
 20699
 20700
 20701* EXEC CICS READPREV
 20702*         DATASET    (FILE-ID-ERPNDB)
 20703*         SET        (ADDRESS OF PENDING-BUSINESS)
 20704*         RIDFLD     (ERPNDB-KEY)
 20705*    END-EXEC.
 20706     MOVE 0
 20707       TO DFHEIV11
 20708*    MOVE '&0S                   )   #00017405' TO DFHEIV0
 20709     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20710     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20711     MOVE X'2020233030303137343035' TO DFHEIV0(25:11)
 20712     CALL 'kxdfhei1' USING DFHEIV0,
 20713           FILE-ID-ERPNDB,
 20714           DFHEIV20,
 20715           DFHEIV99,
 20716           ERPNDB-KEY,
 20717           DFHEIV99,
 20718           DFHEIV11,
 20719           DFHEIV99,
 20720           DFHEIV99
 20721     SET ADDRESS OF PENDING-BUSINESS TO
 20722         DFHEIV20
 20723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20724
 20725
 20726
 20727* EXEC CICS READPREV
 20728*         DATASET    (FILE-ID-ERPNDB)
 20729*         SET        (ADDRESS OF PENDING-BUSINESS)
 20730*         RIDFLD     (ERPNDB-KEY)
 20731*    END-EXEC.
 20732     MOVE 0
 20733       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 383
* EL6311.cbl
 20734*    MOVE '&0S                   )   #00017411' TO DFHEIV0
 20735     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20736     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20737     MOVE X'2020233030303137343131' TO DFHEIV0(25:11)
 20738     CALL 'kxdfhei1' USING DFHEIV0,
 20739           FILE-ID-ERPNDB,
 20740           DFHEIV20,
 20741           DFHEIV99,
 20742           ERPNDB-KEY,
 20743           DFHEIV99,
 20744           DFHEIV11,
 20745           DFHEIV99,
 20746           DFHEIV99
 20747     SET ADDRESS OF PENDING-BUSINESS TO
 20748         DFHEIV20
 20749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20750
 20751
 20752     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20753        GO TO 5550-END-RECORDS.
 20754
 20755     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20756
 20757     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20758
 20759     IF  WS-BATCH-PREFIX = '#CL'
 20760             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20761
 20762* EXEC CICS ENDBR
 20763*                 DATASET  (FILE-ID-ERPNDB)
 20764*            END-EXEC
 20765     MOVE 0
 20766       TO DFHEIV11
 20767*    MOVE '&2                    $   #00017426' TO DFHEIV0
 20768     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20769     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20770     MOVE X'2020233030303137343236' TO DFHEIV0(25:11)
 20771     CALL 'kxdfhei1' USING DFHEIV0,
 20772           FILE-ID-ERPNDB,
 20773           DFHEIV11,
 20774           DFHEIV99
 20775     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20776         GO TO 5505-START-BROWSE.
 20777
 20778     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20779         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20780             NEXT SENTENCE
 20781         ELSE
 20782             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20783
 20784* EXEC CICS ENDBR
 20785*                 DATASET  (FILE-ID-ERPNDB)
 20786*            END-EXEC
 20787     MOVE 0
 20788       TO DFHEIV11
 20789*    MOVE '&2                    $   #00017436' TO DFHEIV0
 20790     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20791     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 384
* EL6311.cbl
 20792     MOVE X'2020233030303137343336' TO DFHEIV0(25:11)
 20793     CALL 'kxdfhei1' USING DFHEIV0,
 20794           FILE-ID-ERPNDB,
 20795           DFHEIV11,
 20796           DFHEIV99
 20797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20798             GO TO 5505-START-BROWSE.
 20799
 20800
 20801     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20802         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20803             NEXT SENTENCE
 20804        ELSE
 20805             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20806
 20807* EXEC CICS ENDBR
 20808*                 DATASET  (FILE-ID-ERPNDB)
 20809*            END-EXEC
 20810     MOVE 0
 20811       TO DFHEIV11
 20812*    MOVE '&2                    $   #00017447' TO DFHEIV0
 20813     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20814     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20815     MOVE X'2020233030303137343437' TO DFHEIV0(25:11)
 20816     CALL 'kxdfhei1' USING DFHEIV0,
 20817           FILE-ID-ERPNDB,
 20818           DFHEIV11,
 20819           DFHEIV99
 20820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20821             GO TO 5505-START-BROWSE.
 20822
 20823     IF NOT PB-BATCH-TRAILER
 20824        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20825
 20826* EXEC CICS ENDBR
 20827*            DATASET  (FILE-ID-ERPNDB)
 20828*       END-EXEC
 20829     MOVE 0
 20830       TO DFHEIV11
 20831*    MOVE '&2                    $   #00017454' TO DFHEIV0
 20832     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20833     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20834     MOVE X'2020233030303137343534' TO DFHEIV0(25:11)
 20835     CALL 'kxdfhei1' USING DFHEIV0,
 20836           FILE-ID-ERPNDB,
 20837           DFHEIV11,
 20838           DFHEIV99
 20839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20840        GO TO 5505-START-BROWSE.
 20841
 20842     IF PI-CSR-BROWSE
 20843        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20844           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 20845
 20846* EXEC CICS ENDBR
 20847*               DATASET  (FILE-ID-ERPNDB)
 20848*          END-EXEC
 20849     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 385
* EL6311.cbl
 20850       TO DFHEIV11
 20851*    MOVE '&2                    $   #00017462' TO DFHEIV0
 20852     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20853     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20854     MOVE X'2020233030303137343632' TO DFHEIV0(25:11)
 20855     CALL 'kxdfhei1' USING DFHEIV0,
 20856           FILE-ID-ERPNDB,
 20857           DFHEIV11,
 20858           DFHEIV99
 20859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20860           GO TO 5505-START-BROWSE.
 20861
 20862     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20863        IF PI-PB-CARRIER    = SPACES AND
 20864           PI-PB-GROUPING   = SPACES AND
 20865           PI-PB-STATE      = SPACES AND
 20866           PI-PB-ACCOUNT    = SPACES
 20867             GO TO 7200-DISPLAY-BATCHES
 20868          ELSE
 20869            IF PI-PB-CARRIER    = PB-CARRIER  AND
 20870               PI-PB-GROUPING   = PB-GROUPING AND
 20871               PI-PB-STATE      = PB-STATE    AND
 20872               PI-PB-ACCOUNT    = PB-ACCOUNT
 20873                 GO TO 7200-DISPLAY-BATCHES.
 20874
 20875     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 20876
 20877
 20878* EXEC CICS ENDBR
 20879*         DATASET  (FILE-ID-ERPNDB)
 20880*    END-EXEC.
 20881     MOVE 0
 20882       TO DFHEIV11
 20883*    MOVE '&2                    $   #00017482' TO DFHEIV0
 20884     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20885     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20886     MOVE X'2020233030303137343832' TO DFHEIV0(25:11)
 20887     CALL 'kxdfhei1' USING DFHEIV0,
 20888           FILE-ID-ERPNDB,
 20889           DFHEIV11,
 20890           DFHEIV99
 20891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20892
 20893
 20894     GO TO 5505-START-BROWSE.
 20895
 20896 5550-END-RECORDS.
 20897     MOVE ER-2257                TO EMI-ERROR.
 20898     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20899     MOVE -1                     TO DPFENTRL.
 20900
 20901     GO TO 8200-SEND-DATAONLY.
 20902
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 386
* EL6311.cbl
 20904
 20905******************************************************************
 20906*                                                                *
 20907*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 20908*                                                                *
 20909******************************************************************
 20910
 20911 6000-CREATE-TEMP-STORAGE.
 20912
 20913
 20914* EXEC CICS HANDLE CONDITION
 20915*        QIDERR  (6050-QID-ERROR)
 20916*    END-EXEC.
 20917*    MOVE '"$N                   ! V #00017505' TO DFHEIV0
 20918     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20920     MOVE X'5620233030303137353035' TO DFHEIV0(25:11)
 20921     CALL 'kxdfhei1' USING DFHEIV0
 20922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20923
 20924
 20925
 20926* EXEC CICS WRITEQ TS
 20927*        QUEUE    (QID)
 20928*        FROM     (PROGRAM-INTERFACE-BLOCK)
 20929*        LENGTH   (WS-COMM-LENGTH)
 20930*        ITEM     (W-ONE)
 20931*    END-EXEC.
 20932*    MOVE '*" I                  ''   #00017509' TO DFHEIV0
 20933     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 20934     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20935     MOVE X'2020233030303137353039' TO DFHEIV0(25:11)
 20936     CALL 'kxdfhei1' USING DFHEIV0,
 20937           QID,
 20938           PROGRAM-INTERFACE-BLOCK,
 20939           WS-COMM-LENGTH,
 20940           W-ONE,
 20941           DFHEIV99,
 20942           DFHEIV99
 20943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20944
 20945
 20946 6000-EXIT.
 20947      EXIT.
 20948
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 387
* EL6311.cbl
 20950
 20951******************************************************************
 20952*                                                                *
 20953*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 20954*                                                                *
 20955******************************************************************
 20956
 20957 6050-RECOVER-TEMP-STORAGE.
 20958     IF PGM-NAME = XCTL-EL6312
 20959        GO TO 6050-EXIT.
 20960
 20961     IF PGM-NAME = XCTL-EL6313
 20962        GO TO 6050-EXIT.
 20963
 20964     IF PGM-NAME = XCTL-EL6315
 20965         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 20966     END-IF
 20967
 20968     IF PGM-NAME = XCTL-EL6316
 20969         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 20970     END-IF
 20971
 20972
 20973* EXEC CICS HANDLE CONDITION
 20974*        QIDERR  (6050-QID-ERROR)
 20975*    END-EXEC.
 20976*    MOVE '"$N                   ! W #00017542' TO DFHEIV0
 20977     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20978     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20979     MOVE X'5720233030303137353432' TO DFHEIV0(25:11)
 20980     CALL 'kxdfhei1' USING DFHEIV0
 20981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20982
 20983
 20984
 20985* EXEC CICS READQ TS
 20986*         QUEUE   (QID)
 20987*         INTO    (PROGRAM-INTERFACE-BLOCK)
 20988*         LENGTH  (WS-COMM-LENGTH)
 20989*         ITEM    (W-ONE)
 20990*     END-EXEC.
 20991*    MOVE '*$II   L              ''   #00017546' TO DFHEIV0
 20992     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 20993     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20994     MOVE X'2020233030303137353436' TO DFHEIV0(25:11)
 20995     CALL 'kxdfhei1' USING DFHEIV0,
 20996           QID,
 20997           PROGRAM-INTERFACE-BLOCK,
 20998           WS-COMM-LENGTH,
 20999           W-ONE,
 21000           DFHEIV99,
 21001           DFHEIV99
 21002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21003
 21004
 21005 6050-DELETE-TEMP-STORAGE.
 21006
 21007
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 388
* EL6311.cbl
 21008* EXEC CICS DELETEQ TS
 21009*        QUEUE   (QID)
 21010*    END-EXEC.
 21011*    MOVE '*&                    #   #00017555' TO DFHEIV0
 21012     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21013     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21014     MOVE X'2020233030303137353535' TO DFHEIV0(25:11)
 21015     CALL 'kxdfhei1' USING DFHEIV0,
 21016           QID,
 21017           DFHEIV99
 21018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21019
 21020
 21021     GO TO 6050-EXIT.
 21022
 21023 6050-QID-ERROR.
 21024     MOVE ER-0033                TO EMI-ERROR
 21025     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21026
 21027 6050-EXIT.
 21028      EXIT.
 21029
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 389
* EL6311.cbl
 21031
 21032******************************************************************
 21033*                                                                *
 21034*            T E R M   C O N V E R S I O N                       *
 21035*                                                                *
 21036******************************************************************
 21037
 21038 6100-TERM-CONVERSION.
 21039
 21040     IF PI-BPMTS = ZERO
 21041         GO TO 6199-EXIT.
 21042
 21043     IF PI-BMODE = ' ' OR 'M'
 21044         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21045         GO TO 6105-ROUND-TERM.
 21046
 21047     IF PI-BMODE = 'S'
 21048         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21049         GO TO 6105-ROUND-TERM.
 21050
 21051     IF PI-BMODE = 'W'
 21052         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21053         GO TO 6105-ROUND-TERM.
 21054
 21055     IF PI-BMODE = 'B'
 21056         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21057         GO TO 6105-ROUND-TERM.
 21058
 21059     IF PI-BMODE = 'T'
 21060         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21061
 21062 6105-ROUND-TERM.
 21063
 21064     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21065         ADD +1                  TO WS-CALC-TERM-WHOLE
 21066         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21067
 21068     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21069         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21070
 21071     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21072         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21073                                      WS-BTERM    (WS-SUB1)
 21074         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21075
 21076     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21077         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21078             MOVE -1               TO BMODEL
 21079             MOVE ER-2593          TO EMI-ERROR
 21080             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21081             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21082
 21083 6124-CHECK-BENEFIT.
 21084
 21085     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21086        GO TO 6126-COMPUTE-BENEFIT.
 21087
 21088     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 390
* EL6311.cbl
 21089
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 391
* EL6311.cbl
 21091******************************************************************
 21092**         COMPUTE TERM AND BENEFIT
 21093******************************************************************
 21094 6125-COMPUTE-TERM-BENEFIT.
 21095
 21096     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21097        PI-BPMTAMT = ZERO
 21098         GO TO 6199-EXIT.
 21099
 21100     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21101                                     WS-BTERM  (WS-SUB1).
 21102     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21103
 21104 6126-COMPUTE-BENEFIT.
 21105
 21106     IF PI-BMODE = 'M' OR  ' '
 21107         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21108
 21109     IF PI-BMODE = 'W'
 21110         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21111
 21112     IF PI-BMODE = 'S'
 21113         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21114
 21115     IF PI-BMODE = 'B'
 21116         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21117
 21118     IF PI-BMODE = 'T'
 21119         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21120
 21121     IF WS-SUB1 = +1
 21122        COMPUTE WS-BBEN (WS-SUB1) =
 21123                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21124
 21125     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21126     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21127     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21128
 21129 6199-EXIT.
 21130     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 392
* EL6311.cbl
 21132
 21133******************************************************************
 21134*                                                                *
 21135*             D I S P L A Y   I S S U E S                        *
 21136*                                                                *
 21137******************************************************************
 21138
 21139 6200-CREATE-VADS.
 21140     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21141     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21142     MOVE SPACES                 TO WS-PASS-VADS-REC
 21143
 21144* EXEC CICS GETMAIN
 21145*       SET      (ADDRESS OF PENDING-BUSINESS)
 21146*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21147*       INITIMG  (GETMAIN-SPACE)
 21148*       RESP     (WS-RESPONSE)
 21149*    END-EXEC
 21150*    MOVE ',"IL                  $  N#00017681' TO DFHEIV0
 21151     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21152     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21153     MOVE X'204E233030303137363831' TO DFHEIV0(25:11)
 21154     CALL 'kxdfhei1' USING DFHEIV0,
 21155           DFHEIV20,
 21156           ERPNDB-RECORD-LENGTH,
 21157           GETMAIN-SPACE
 21158     SET ADDRESS OF PENDING-BUSINESS TO
 21159         DFHEIV20
 21160     MOVE EIBRESP  TO WS-RESPONSE
 21161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21162
 21163* EXEC CICS READ
 21164*       INTO    (PENDING-BUSINESS)
 21165*       DATASET (FILE-ID-ERPNDB)
 21166*       RIDFLD  (ERPNDB-KEY)
 21167*       RESP    (WS-RESPONSE)
 21168*    END-EXEC
 21169     MOVE LENGTH OF
 21170      PENDING-BUSINESS
 21171       TO DFHEIV11
 21172*    MOVE '&"IL       E          (  N#00017687' TO DFHEIV0
 21173     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21175     MOVE X'204E233030303137363837' TO DFHEIV0(25:11)
 21176     CALL 'kxdfhei1' USING DFHEIV0,
 21177           FILE-ID-ERPNDB,
 21178           PENDING-BUSINESS,
 21179           DFHEIV11,
 21180           ERPNDB-KEY,
 21181           DFHEIV99,
 21182           DFHEIV99,
 21183           DFHEIV99
 21184     MOVE EIBRESP  TO WS-RESPONSE
 21185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21186     IF RESP-NORMAL
 21187        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21188        IF (RESP-NORMAL)
 21189           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 393
* EL6311.cbl
 21190              AM-CONTROL-PRIMARY (1:20))
 21191           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21192        ELSE
 21193           MOVE 'ACCOUNT NOT FOUND'
 21194                                 TO VD-ACCOUNT-NAME
 21195        END-IF
 21196        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21197                                    TO M1
 21198        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21199        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21200           (A2 > M1)
 21201           OR (WS-WORK-FIELD (A2:1) = '*')
 21202           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21203           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21204        END-PERFORM
 21205        IF A2 > M1
 21206           CONTINUE
 21207        ELSE
 21208           MOVE WS-WORK-FIELD (1:A2 - 1)
 21209                                    TO VD-ACCOUNT-NAME
 21210        END-IF
 21211        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21212        MOVE PB-CARRIER          TO VD-CARRIER
 21213        MOVE PB-GROUPING         TO VD-GROUPING
 21214        MOVE PB-STATE            TO VD-STATE
 21215        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21216        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21217        MOVE PB-CERT-NO          TO VD-CERT-NO
 21218        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21219        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21220        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 21221        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 21222        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 21223        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 21224        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 21225        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 21226        MOVE PB-CSR-ID           TO VD-CSR-ID
 21227        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 21228        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 21229        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 21230        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 21231        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 21232        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 21233        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 21234        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 21235        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 21236        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 21237        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 21238        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 21239        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 21240     END-IF
 21241     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 21242
 21243
 21244* EXEC CICS GETMAIN
 21245*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 21246*       LENGTH   (ERPNDM-RECORD-LENGTH)
 21247*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 394
* EL6311.cbl
 21248*       RESP     (WS-RESPONSE)
 21249*    END-EXEC
 21250*    MOVE ',"IL                  $  N#00017750' TO DFHEIV0
 21251     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21252     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21253     MOVE X'204E233030303137373530' TO DFHEIV0(25:11)
 21254     CALL 'kxdfhei1' USING DFHEIV0,
 21255           DFHEIV20,
 21256           ERPNDM-RECORD-LENGTH,
 21257           GETMAIN-SPACE
 21258     SET ADDRESS OF PENDING-MAILING-DATA TO
 21259         DFHEIV20
 21260     MOVE EIBRESP  TO WS-RESPONSE
 21261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21262
 21263
 21264* EXEC CICS READ
 21265*       INTO    (PENDING-MAILING-DATA)
 21266*       DATASET (FILE-ID-ERPNDM)
 21267*       RIDFLD  (ERPNDM-KEY)
 21268*       RESP    (WS-RESPONSE)
 21269*    END-EXEC
 21270     MOVE LENGTH OF
 21271      PENDING-MAILING-DATA
 21272       TO DFHEIV11
 21273*    MOVE '&"IL       E          (  N#00017757' TO DFHEIV0
 21274     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21275     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21276     MOVE X'204E233030303137373537' TO DFHEIV0(25:11)
 21277     CALL 'kxdfhei1' USING DFHEIV0,
 21278           FILE-ID-ERPNDM,
 21279           PENDING-MAILING-DATA,
 21280           DFHEIV11,
 21281           ERPNDM-KEY,
 21282           DFHEIV99,
 21283           DFHEIV99,
 21284           DFHEIV99
 21285     MOVE EIBRESP  TO WS-RESPONSE
 21286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21287
 21288     IF RESP-NORMAL
 21289        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 21290        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 21291        MOVE PM-CITY              TO VD-INSURED-CITY
 21292        MOVE PM-STATE             TO VD-INSURED-STATE
 21293        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 21294     END-IF
 21295
 21296     MOVE 'VAC1'                  TO VD-LETTER-ID
 21297     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 21298     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 21299     MOVE EIBTIME                 TO VD-CURRENT-TIME
 21300     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 21301     MOVE +0                      TO VD-ARCHIVE-NO
 21302     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 21303     .
 21304 6200-EXIT.
 21305     EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 395
* EL6311.cbl
 21306 6210-READ-ERACCT.
 21307     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 21308     MOVE LOW-VALUES             TO ERACCT-FILL
 21309
 21310* EXEC CICS READ
 21311*         DATASET   ('ERACCT')
 21312*         INTO      (ACCOUNT-MASTER)
 21313*         RIDFLD    (ERACCT-KEY)
 21314*         GTEQ
 21315*         RESP      (WS-RESPONSE)
 21316*    END-EXEC
 21317     MOVE LENGTH OF
 21318      ACCOUNT-MASTER
 21319       TO DFHEIV11
 21320     MOVE 'ERACCT' TO DFHEIV1
 21321*    MOVE '&"IL       G          (  N#00017785' TO DFHEIV0
 21322     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 21323     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21324     MOVE X'204E233030303137373835' TO DFHEIV0(25:11)
 21325     CALL 'kxdfhei1' USING DFHEIV0,
 21326           DFHEIV1,
 21327           ACCOUNT-MASTER,
 21328           DFHEIV11,
 21329           ERACCT-KEY,
 21330           DFHEIV99,
 21331           DFHEIV99,
 21332           DFHEIV99
 21333     MOVE EIBRESP  TO WS-RESPONSE
 21334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21335     .
 21336 6210-EXIT.
 21337     EXIT.
 21338
 21339 6220-READ-ERMAIL.
 21340
 21341     MOVE ELCERT-KEY             TO ERMAIL-KEY
 21342     MOVE ' '                    TO WS-ERMAIL-SW
 21343
 21344
 21345* EXEC CICS READ
 21346*       DATASET   (FILE-ID-ERMAIL)
 21347*       SET       (ADDRESS OF MAILING-DATA)
 21348*       RIDFLD    (ERMAIL-KEY)
 21349*       RESP      (WS-RESPONSE)
 21350*    END-EXEC
 21351*    MOVE '&"S        E          (  N#00017801' TO DFHEIV0
 21352     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21353     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21354     MOVE X'204E233030303137383031' TO DFHEIV0(25:11)
 21355     CALL 'kxdfhei1' USING DFHEIV0,
 21356           FILE-ID-ERMAIL,
 21357           DFHEIV20,
 21358           DFHEIV99,
 21359           ERMAIL-KEY,
 21360           DFHEIV99,
 21361           DFHEIV99,
 21362           DFHEIV99
 21363     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 396
* EL6311.cbl
 21364         DFHEIV20
 21365     MOVE EIBRESP  TO WS-RESPONSE
 21366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21367
 21368     IF RESP-NORMAL
 21369        SET ERMAIL-FOUND TO TRUE
 21370     END-IF
 21371     .
 21372 6220-EXIT.
 21373     EXIT.
 21374
 21375 6400-CHECK-FOR-RES-REF-CLAIM.
 21376     display 'made it to 6400- for ' pi-cert-no
 21377     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 21378
 21379     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 21380                                    W-CL-COMP-CD.
 21381     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 21382                                    W-CL-CERT-NO.
 21383     MOVE SPACES                 TO MSTR-CERT-SFX.
 21384
 21385
 21386* EXEC CICS HANDLE CONDITION
 21387*        NOTFND  (6400-CONTINUE)
 21388*        ENDFILE (6400-CONTINUE)
 21389*    END-EXEC.
 21390*    MOVE '"$I''                  ! X #00017825' TO DFHEIV0
 21391     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21392     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21393     MOVE X'5820233030303137383235' TO DFHEIV0(25:11)
 21394     CALL 'kxdfhei1' USING DFHEIV0
 21395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21396
 21397
 21398
 21399* EXEC CICS IGNORE CONDITION
 21400*        DUPKEY
 21401*    END-EXEC.
 21402*    MOVE '"*$                   !   #00017830' TO DFHEIV0
 21403     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 21404     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21405     MOVE X'2020233030303137383330' TO DFHEIV0(25:11)
 21406     CALL 'kxdfhei1' USING DFHEIV0
 21407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21408
 21409
 21410
 21411* EXEC CICS STARTBR
 21412*        DATASET   (CLMS-ID)
 21413*        RIDFLD    (ELMSTR-KEY)
 21414*        GENERIC   EQUAL
 21415*        KEYLENGTH (ELMSTR-LENGTH)
 21416*    END-EXEC.
 21417     MOVE 0
 21418       TO DFHEIV11
 21419*    MOVE '&,   KG    E          &   #00017834' TO DFHEIV0
 21420     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 21421     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 397
* EL6311.cbl
 21422     MOVE X'2020233030303137383334' TO DFHEIV0(25:11)
 21423     CALL 'kxdfhei1' USING DFHEIV0,
 21424           CLMS-ID,
 21425           ELMSTR-KEY,
 21426           ELMSTR-LENGTH,
 21427           DFHEIV11,
 21428           DFHEIV99
 21429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21430
 21431
 21432     display 'browse started'
 21433     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21434
 21435 6400-NEXT-CLAIM.
 21436
 21437
 21438* EXEC CICS READNEXT
 21439*        DATASET   (CLMS-ID)
 21440*        RIDFLD    (ELMSTR-KEY)
 21441*        SET       (ADDRESS OF CLAIM-MASTER)
 21442*    END-EXEC.
 21443     MOVE 0
 21444       TO DFHEIV11
 21445*    MOVE '&.S                   )   #00017846' TO DFHEIV0
 21446     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21447     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21448     MOVE X'2020233030303137383436' TO DFHEIV0(25:11)
 21449     CALL 'kxdfhei1' USING DFHEIV0,
 21450           CLMS-ID,
 21451           DFHEIV20,
 21452           DFHEIV99,
 21453           ELMSTR-KEY,
 21454           DFHEIV99,
 21455           DFHEIV11,
 21456           DFHEIV99,
 21457           DFHEIV99
 21458     SET ADDRESS OF CLAIM-MASTER TO
 21459         DFHEIV20
 21460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21461
 21462
 21463     display 'read claim for ' mstr-cert-no
 21464     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21465        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21466         GO TO 6400-CONTINUE
 21467     END-IF.
 21468
 21469     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21470        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21471        PI-STATE       NOT = CL-CERT-STATE     OR
 21472        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21473        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21474         GO TO 6400-NEXT-CLAIM
 21475     END-IF.
 21476
 21477     display 'found claim ' cl-claim-no
 21478        ' with denial type ' cl-denial-type
 21479     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 398
* EL6311.cbl
 21480         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 21481         GO TO 6400-CONTINUE
 21482     END-IF.
 21483
 21484     GO TO 6400-NEXT-CLAIM.
 21485
 21486 6400-CONTINUE.
 21487
 21488     IF WS-BROWSE-STARTED-SW = 'Y'
 21489
 21490* EXEC CICS ENDBR
 21491*            DATASET   (CLMS-ID)
 21492*        END-EXEC
 21493     MOVE 0
 21494       TO DFHEIV11
 21495*    MOVE '&2                    $   #00017878' TO DFHEIV0
 21496     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21497     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21498     MOVE X'2020233030303137383738' TO DFHEIV0(25:11)
 21499     CALL 'kxdfhei1' USING DFHEIV0,
 21500           CLMS-ID,
 21501           DFHEIV11,
 21502           DFHEIV99
 21503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21504         MOVE 'N' TO WS-BROWSE-STARTED-SW
 21505     END-IF.
 21506
 21507 6400-EXIT.
 21508     EXIT.
 21509
 21510 7000-DISPLAY-ISSUES.
 21511
 21512     IF PI-DISPLAY-ORIGINAL-BATCH
 21513        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21514        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21515     ELSE
 21516        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21517
 21518     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21519
 21520     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21521     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21522
 21523     MOVE LOW-VALUES                 TO EL631BI.
 21524     MOVE ZEROS                      TO PI-BPMTAMT
 21525                                        PI-BPMTS.
 21526     MOVE SPACE                      TO PI-BMODE
 21527                                        PI-BTYPE (1)
 21528                                        PI-BTYPE (2).
 21529     MOVE EL631B                     TO PI-MAP-NAME.
 21530     MOVE 'Y'                        TO PI-BROWSE-SW.
 21531     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 21532                                        PI-HIGH-SEQ-NO.
 21533
 21534     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21535        MOVE AL-SABOF                TO BCHGTA
 21536        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 21537        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 399
* EL6311.cbl
 21538     ELSE
 21539        MOVE AL-SADOF                TO BCHGTA
 21540                                        BCHGA
 21541        MOVE PB-CHG-COUNT            TO BCHGO.
 21542
 21543     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 21544     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 21545     MOVE WS-HR-MINS                 TO BMANTATO.
 21546
 21547     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21548        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 21549        MOVE SPACE                   TO DC-OPTION-CODE
 21550        PERFORM 9700-DATE-LINK
 21551        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21552        MOVE 'INACTIVE'              TO BMOENDTO
 21553     ELSE
 21554        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 21555        MOVE SPACE                   TO DC-OPTION-CODE
 21556        PERFORM 9700-DATE-LINK
 21557        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21558        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 21559        MOVE SPACE                   TO DC-OPTION-CODE
 21560        PERFORM 9700-DATE-LINK
 21561        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 21562
 21563*    MOVE PB-I-REFERENCE             TO BREFO.
 21564
 21565*    IF PI-COMPANY-ID EQUAL 'HER'
 21566*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 21567*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 21568*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 21569*                MOVE WS-MEMBER-NO-1-8
 21570*                                TO  BMICRNOO.
 21571
 21572*    IF PB-I-MICROFILM-NO  IS NUMERIC
 21573*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 21574*            MOVE PB-I-MICROFILM-NO
 21575*                                TO  BMICRNOO.
 21576     IF PB-I-VIN NOT = SPACES
 21577        MOVE PB-I-VIN            TO BVINO
 21578     END-IF
 21579
 21580     MOVE PB-CERT-PRIME              TO BCERTNOO.
 21581     MOVE PB-CERT-SFX                TO BSUFIXO.
 21582     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21583     MOVE SPACE                      TO DC-OPTION-CODE.
 21584     PERFORM 9700-DATE-LINK.
 21585     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 21586
 21587     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 21588     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 21589     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 21590     MOVE PB-I-INSURED-SEX           TO BSEXO
 21591
 21592     IF PB-I-AGE NOT = ZEROS
 21593         MOVE PB-I-AGE               TO BAGEO.
 21594
 21595     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 400
* EL6311.cbl
 21596                                 TO ELCERT-KEY
 21597     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 21598     IF NOT CERT-TRL-REC-NOT-FOUND
 21599         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 21600             MOVE 'AGE*'             TO BAGEDEFO
 21601         ELSE
 21602             MOVE 'AGE '             TO BAGEDEFO
 21603         END-IF
 21604     ELSE
 21605         MOVE 'AGE '             TO BAGEDEFO
 21606     END-IF
 21607
 21608     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 21609         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 21610         MOVE SPACE                  TO DC-OPTION-CODE
 21611         PERFORM 9700-DATE-LINK
 21612         IF NO-CONVERSION-ERROR
 21613            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 21614
 21615     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 21616         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 21617         MOVE SPACE                  TO DC-OPTION-CODE
 21618         PERFORM 9700-DATE-LINK
 21619         IF NO-CONVERSION-ERROR
 21620            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 21621
 21622     IF PB-I-EXTENTION-DAYS NUMERIC
 21623        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 21624           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 21625        ELSE
 21626           IF PB-I-TERM-IN-DAYS NUMERIC
 21627              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 21628                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 21629
 21630     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 21631        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 21632
 21633     MOVE PB-FORCE-CODE              TO BFORCEO.
 21634     MOVE PB-I-TERM-TYPE             TO BMODEO
 21635                                        PI-BMODE.
 21636
 21637     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 21638        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 21639
 21640     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 21641         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 21642                                        PI-BPMTS.
 21643
 21644     IF PB-I-PAYMENT-AMOUNT NUMERIC
 21645         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 21646           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 21647                                        PI-BPMTAMT.
 21648
 21649     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 21650     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 21651     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 21652     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 21653     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 401
* EL6311.cbl
 21654     MOVE PB-I-SIG-SW                TO BSIGO.
 21655     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 21656     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 21657     MOVE PB-RECORD-BILL             TO BBILCDO.
 21658     MOVE PB-FORCE-CODE              TO BFORCEO.
 21659
 21660     IF (PB-I-LIVES NUMERIC)
 21661        AND (PB-I-LIVES > ZEROS)
 21662        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21663        IF (RESP-NORMAL)
 21664           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 21665           CONTINUE
 21666        ELSE
 21667           MOVE PB-I-LIVES       TO BLIVESO
 21668        END-IF
 21669     END-IF
 21670
 21671     IF PB-I-NUM-BILLED NUMERIC AND
 21672        PB-I-NUM-BILLED GREATER THAN ZEROS
 21673        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 21674*    ELSE
 21675*       MOVE ZEROS                   TO BBILLEDO.
 21676
 21677     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 21678
 21679     IF PB-I-LOAN-APR NOT = +99.9999
 21680        MOVE PB-I-LOAN-APR           TO BAPRO.
 21681
 21682     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 21683        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 21684
 21685     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 21686        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 21687           MOVE AL-SANOF                TO BORIGHDA
 21688           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 21689           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 21690
 21691     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 21692
 21693     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 21694        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 21695
 21696     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 21697        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 21698                                        PI-BTYPE (1).
 21699
 21700     IF PB-I-LF-TERM     GREATER THAN ZEROS
 21701        MOVE PB-I-LF-TERM            TO BTERMO (1).
 21702
 21703     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 21704        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 21705
 21706     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 21707        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 21708
 21709     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 21710        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 21711
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 402
* EL6311.cbl
 21712     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21713        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 21714
 21715     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 21716         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 21717         MOVE SPACE                  TO DC-OPTION-CODE
 21718         PERFORM 9700-DATE-LINK
 21719         IF NO-CONVERSION-ERROR
 21720            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 21721
 21722     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21723        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 21724        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 21725        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 21726        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 21727                 GIVING BDIFFO (1)
 21728     ELSE
 21729        MOVE SPACES                  TO BBEN-CD     (1)
 21730                                        BBEN-ABBR   (1).
 21731
 21732     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21733        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 21734        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 21735                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 21736
 21737     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21738       IF PB-RECORD-ON-HOLD
 21739          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 21740
 21741     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21742       IF PB-RECORD-RETURNED
 21743          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 21744
 21745     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21746        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21747             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 21748
 21749     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 21750
 21751     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 21752        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 21753
 21754     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 21755        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 21756                                        PI-BTYPE (2).
 21757
 21758     IF PB-I-AH-TERM     GREATER THAN ZEROS
 21759        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 21760
 21761     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 21762        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 21763
 21764     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 21765        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 21766
 21767     IF PB-I-TOT-FEES NOT NUMERIC
 21768        MOVE ZEROS               TO PB-I-TOT-FEES
 21769     END-IF
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 403
* EL6311.cbl
 21770     IF PB-I-TOT-FEES > ZEROS
 21771        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 21772
 21773     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 21774         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 21775         MOVE SPACE                  TO DC-OPTION-CODE
 21776         PERFORM 9700-DATE-LINK
 21777         IF NO-CONVERSION-ERROR
 21778            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 21779
 21780     IF PB-I-TOT-FEES > ZEROS
 21781        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 21782        SUBTRACT PB-I-TOT-FEES FROM
 21783                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 21784
 21785     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21786        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 21787        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 21788        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 21789        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 21790                 GIVING BDIFFO (2)
 21791     ELSE
 21792        MOVE SPACES                  TO BBEN-CD     (2)
 21793                                        BBEN-ABBR   (2).
 21794
 21795     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21796       IF PB-RECORD-ON-HOLD
 21797          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 21798
 21799     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21800       IF PB-RECORD-RETURNED
 21801          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 21802
 21803     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21804        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21805             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 21806
 21807     MOVE PB-CSR-ID                  TO BCSRO.
 21808
 21809     IF PI-COMPANY-ID  =  'DMD'
 21810        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 21811            NEXT SENTENCE
 21812        ELSE
 21813            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 21814               MOVE 'NEW CERT'       TO BNCERTLI
 21815               MOVE EC-NEW-CERT      TO BNCERTO.
 21816
 21817     IF PI-COMPANY-ID  =  'DMD'
 21818        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 21819            NEXT SENTENCE
 21820        ELSE
 21821           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 21822               MOVE 'NEW STATE'      TO BNSTATLI
 21823               MOVE EC-NEW-STATE     TO BNSTATO.
 21824
 21825 7000-CONTINUE.
 21826     MOVE 'C'                        TO BMAINTI.
 21827     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 404
* EL6311.cbl
 21828
 21829     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 21830        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 21831
 21832     IF PI-6315-FINALIZED = 'Y'   AND
 21833        PB-UNFORCED-ERRORS
 21834          MOVE -1                TO BFORCEL
 21835          MOVE  1                TO SET-CURSOR-SW
 21836     END-IF
 21837
 21838     IF NO-CURSOR-SET
 21839        MOVE -1                      TO BMAINTL.
 21840
 21841     GO TO 8100-SEND-INITIAL-MAP.
 21842
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 405
* EL6311.cbl
 21844
 21845******************************************************************
 21846*                                                                *
 21847*             D I S P L A Y   C A N C E L S                      *
 21848*                                                                *
 21849******************************************************************
 21850
 21851 7100-DISPLAY-CANCELS.
 21852     IF PI-DISPLAY-ORIGINAL-BATCH
 21853        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21854        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21855     ELSE
 21856        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21857
 21858     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21859
 21860     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21861     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21862
 21863     MOVE LOW-VALUES                 TO EL631CI.
 21864     MOVE EL631C                     TO PI-MAP-NAME.
 21865     MOVE 'Y'                        TO PI-BROWSE-SW.
 21866     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 21867                                        PI-HIGH-SEQ-NO.
 21868
 21869     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21870        MOVE AL-SABOF                TO CCHGTA
 21871        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 21872        MOVE AL-SANON                TO CCHGA
 21873      ELSE
 21874        MOVE AL-SADOF                TO CCHGTA
 21875                                        CCHGA
 21876        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 21877
 21878*    MOVE PB-C-REFERENCE             TO CREFO.
 21879
 21880*    IF PB-C-MICROFILM-NO IS NUMERIC
 21881*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 21882*          MOVE PB-C-MICROFILM-NO
 21883*                                TO CMICRNOO
 21884*          MOVE AL-UNNON         TO CMICRNOA
 21885*       END-IF
 21886*    END-IF
 21887     IF PB-C-NH-INT-ON-REFS NUMERIC
 21888        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 21889           MOVE PB-C-NH-INT-ON-REFS
 21890                                 TO CNHINTO
 21891           MOVE AL-SANOF         TO CNHINTA
 21892        END-IF
 21893     END-IF
 21894     MOVE PB-CERT-PRIME              TO CCERTNOO.
 21895     MOVE PB-CERT-SFX                TO CSUFIXO.
 21896     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21897     MOVE SPACE                      TO DC-OPTION-CODE.
 21898     PERFORM 9700-DATE-LINK.
 21899     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 21900
 21901     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 406
* EL6311.cbl
 21902        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 21903        MOVE SPACE                   TO DC-OPTION-CODE
 21904        PERFORM 9700-DATE-LINK
 21905        IF NO-CONVERSION-ERROR
 21906           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 21907
 21908     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 21909        NEXT SENTENCE
 21910     ELSE
 21911        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 21912
 21913     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 21914        NEXT SENTENCE
 21915     ELSE
 21916        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 21917
 21918     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 21919        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 21920        MOVE SPACE                   TO DC-OPTION-CODE
 21921        PERFORM 9700-DATE-LINK
 21922        IF NO-CONVERSION-ERROR
 21923           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 21924
 21925     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21926         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 21927
 21928     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21929         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 21930
 21931     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 21932        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 21933        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 21934                 GIVING CDRFND1O.
 21935
 21936     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 21937        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 21938        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 21939                 GIVING CDRFND2O.
 21940
 21941     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21942       IF PB-RECORD-ON-HOLD
 21943          MOVE 'ON HOLD'             TO CBILIT1O.
 21944
 21945     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21946       IF PB-RECORD-RETURNED
 21947          MOVE 'RETURNED'            TO CBILIT1O.
 21948
 21949     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21950        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21951             MOVE 'OVERRIDE'         TO CBILIT1O.
 21952
 21953     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21954       IF PB-RECORD-ON-HOLD
 21955          MOVE 'ON HOLD'             TO CBILIT2O.
 21956
 21957     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21958       IF PB-RECORD-RETURNED
 21959          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 407
* EL6311.cbl
 21960
 21961     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21962        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21963             MOVE 'OVERRIDE'         TO CBILIT2O.
 21964
 21965     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 21966     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 21967     IF PB-C-POST-CARD-IND = 'Y'
 21968        MOVE 'Y'                     TO CPCYNO
 21969     ELSE
 21970        MOVE 'N'                     TO CPCYNO
 21971     END-IF
 21972     MOVE PB-FORCE-CODE              TO CFORCEO.
 21973     MOVE PB-RECORD-BILL             TO CBILCDO.
 21974     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 21975     MOVE SPACES                     TO CINITSO.
 21976     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 21977         MOVE PB-CI-FIRST-NAME       TO CINITSO
 21978     ELSE
 21979         MOVE PB-CI-INITIALS         TO CINITSO
 21980     END-IF.
 21981
 21982     IF PB-CI-CANCEL-FEE NUMERIC
 21983        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 21984        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 21985     ELSE
 21986        MOVE ZEROES                  TO W-CANCEL-FEE.
 21987
 21988     MOVE W-CANCEL-FEE               TO CCANFEEO.
 21989
 21990     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 21991        ADD PB-CI-LF-PREMIUM-AMT
 21992             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 21993
 21994     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 21995        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 21996
 21997     MOVE PB-CI-LF-TERM              TO CTERM1O.
 21998     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 21999     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22000     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22001
 22002     IF PB-C-LIVES NUMERIC
 22003        MOVE PB-C-LIVES              TO CLIVESO.
 22004
 22005     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22006        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22007
 22008     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22009        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22010        MOVE SPACE                   TO DC-OPTION-CODE
 22011        PERFORM 9700-DATE-LINK
 22012        IF NO-CONVERSION-ERROR
 22013           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22014
 22015     IF  PB-C-REFUND-CREATED
 22016         MOVE 'YES'                  TO CRFNDSWO
 22017     ELSE
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 408
* EL6311.cbl
 22018         IF PB-C-REFUND-REQUESTED
 22019            MOVE 'REQ'               TO CRFNDSWO
 22020         ELSE
 22021            MOVE 'NO'                TO CRFNDSWO.
 22022
 22023     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22024     MOVE SPACE                      TO DC-OPTION-CODE.
 22025     PERFORM 9700-DATE-LINK.
 22026     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22027     MOVE PB-INPUT-BY                TO CENTBYO.
 22028
 22029     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22030        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22031        MOVE SPACE                   TO DC-OPTION-CODE
 22032        PERFORM 9700-DATE-LINK
 22033        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22034        MOVE 'INACTIVE'              TO CMOENDTO
 22035     ELSE
 22036        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22037        MOVE SPACE                   TO DC-OPTION-CODE
 22038        PERFORM 9700-DATE-LINK
 22039        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22040        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22041        MOVE SPACE                   TO DC-OPTION-CODE
 22042        PERFORM 9700-DATE-LINK
 22043        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22044
 22045     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22046
 22047     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22048     MOVE WS-HR-MINS                 TO CMANTATO.
 22049
 22050     EVALUATE PB-LF-REFUND-TYPE
 22051        WHEN '1'
 22052           MOVE 'RULE78'            TO CLFREFNO
 22053        WHEN '2'
 22054           MOVE 'PRORAT'            TO CLFREFNO
 22055        WHEN '3'
 22056           MOVE 'CALIF'             TO CLFREFNO
 22057        WHEN '4'
 22058           MOVE 'IRREG'             TO CLFREFNO
 22059        WHEN '5'
 22060           MOVE 'NETPAY'            TO CLFREFNO
 22061        WHEN '6'
 22062           MOVE 'ATCP'              TO CLFREFNO
 22063        WHEN '7'
 22064           MOVE 'UTAH'              TO CLFREFNO
 22065        WHEN '8'
 22066           MOVE 'MEAN'              TO CLFREFNO
 22067        WHEN '9'
 22068           MOVE 'SUM '              TO CLFREFNO
 22069        WHEN 'B'
 22070           MOVE 'BALN'              TO CLFREFNO
 22071     END-EVALUATE.
 22072
 22073     EVALUATE TRUE
 22074        WHEN PB-AH-REFUND-TYPE =  '1'
 22075           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 409
* EL6311.cbl
 22076        WHEN PB-AH-REFUND-TYPE =  '2'
 22077           MOVE 'PRORAT'            TO CAHREFNO
 22078        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22079           MOVE 'CALIF'             TO CAHREFNO
 22080        WHEN PB-AH-REFUND-TYPE =  '4'
 22081           MOVE 'IRREG'             TO CAHREFNO
 22082        WHEN PB-AH-REFUND-TYPE =  '5'
 22083           MOVE 'NETPAY'            TO CAHREFNO
 22084        WHEN PB-AH-REFUND-TYPE =  '6'
 22085           MOVE 'ATCP'              TO CAHREFNO
 22086        WHEN PB-AH-REFUND-TYPE =  '7'
 22087           MOVE 'UTAH'              TO CAHREFNO
 22088        WHEN PB-AH-REFUND-TYPE =  '8'
 22089           MOVE 'MEAN'              TO CAHREFNO
 22090        WHEN PB-AH-REFUND-TYPE =  '9'
 22091           MOVE 'SUM '              TO CAHREFNO
 22092        WHEN PB-AH-REFUND-TYPE =  'B'
 22093           MOVE 'BALN'              TO CAHREFNO
 22094     END-EVALUATE.
 22095
 22096     MOVE PB-REIN-CD                 TO CREINCDO.
 22097
 22098     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22099        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22100        MOVE SPACE                   TO DC-OPTION-CODE
 22101        PERFORM 9700-DATE-LINK
 22102        IF NO-CONVERSION-ERROR
 22103           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22104
 22105     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22106        MOVE 999999                  TO WS-EXP-DT-EDIT
 22107        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22108        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22109     ELSE
 22110        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22111           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22112           MOVE SPACE                   TO DC-OPTION-CODE
 22113           PERFORM 9700-DATE-LINK
 22114           IF NO-CONVERSION-ERROR
 22115              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22116
 22117     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22118        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22119           MOVE AL-SANOF                TO CORIGHDA
 22120           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22121           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22122
 22123     MOVE PB-CSR-ID              TO CCSRO.
 22124
 22125     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22126     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22127
 22128     MOVE 'C'                    TO CMAINTI.
 22129     MOVE AL-UANON               TO CMAINTA.
 22130
 22131     IF PI-6316-FINALIZED = 'Y'  AND
 22132        PB-UNFORCED-ERRORS
 22133          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 410
* EL6311.cbl
 22134          MOVE  1                TO SET-CURSOR-SW
 22135     END-IF
 22136
 22137     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22138        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22139
 22140     IF NO-CURSOR-SET
 22141        MOVE -1                  TO CMAINTL.
 22142
 22143     GO TO 8100-SEND-INITIAL-MAP.
 22144
 22145
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 411
* EL6311.cbl
 22147***************************************************************
 22148*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22149*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22150***************************************************************
 22151
 22152 7200-DISPLAY-BATCHES.
 22153     MOVE EL631D                 TO PI-MAP-NAME.
 22154     MOVE LOW-VALUES             TO EL631DI.
 22155
 22156     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22157
 22158
 22159* EXEC CICS HANDLE CONDITION
 22160*         NOTFND   (3690-NOT-FOUND)
 22161*    END-EXEC.
 22162*    MOVE '"$I                   ! Y #00018535' TO DFHEIV0
 22163     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22164     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22165     MOVE X'5920233030303138353335' TO DFHEIV0(25:11)
 22166     CALL 'kxdfhei1' USING DFHEIV0
 22167     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22168
 22169
 22170     IF PI-DISPLAY-SCREEN
 22171        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22172     ELSE
 22173        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22174
 22175     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22176     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22177
 22178
 22179* EXEC CICS READ
 22180*         DATASET   (FILE-ID-ERPNDB)
 22181*         RIDFLD    (ERPNDB-KEY)
 22182*         SET       (ADDRESS OF PENDING-BUSINESS)
 22183*    END-EXEC.
 22184*    MOVE '&"S        E          (   #00018547' TO DFHEIV0
 22185     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22186     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22187     MOVE X'2020233030303138353437' TO DFHEIV0(25:11)
 22188     CALL 'kxdfhei1' USING DFHEIV0,
 22189           FILE-ID-ERPNDB,
 22190           DFHEIV20,
 22191           DFHEIV99,
 22192           ERPNDB-KEY,
 22193           DFHEIV99,
 22194           DFHEIV99,
 22195           DFHEIV99
 22196     SET ADDRESS OF PENDING-BUSINESS TO
 22197         DFHEIV20
 22198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22199
 22200
 22201     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22202     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22203     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22204     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 412
* EL6311.cbl
 22205     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22206
 22207     MOVE EL631D                 TO PI-MAP-NAME.
 22208     MOVE LOW-VALUES             TO EL631DI.
 22209     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22210
 22211*    IF PI-AR-PROCESSING
 22212*       MOVE PB-REFERENCE        TO DREFO.
 22213
 22214     MOVE PB-CSR-ID              TO DCSRO.
 22215
 22216     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22217        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22218        MOVE SPACE               TO DC-OPTION-CODE
 22219        PERFORM 9700-DATE-LINK
 22220        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 22221        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 22222        MOVE 'INACTIVE'          TO DLDATEO
 22223     ELSE
 22224        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 22225        MOVE SPACE               TO DC-OPTION-CODE
 22226        PERFORM 9700-DATE-LINK
 22227        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 22228
 22229     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 22230     MOVE SPACE                  TO DC-OPTION-CODE.
 22231     PERFORM 9700-DATE-LINK.
 22232     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 22233
 22234     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 22235        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 22236     ELSE
 22237        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 22238        MOVE SPACE               TO DC-OPTION-CODE
 22239        PERFORM 9700-DATE-LINK
 22240        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 22241
 22242     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 22243     MOVE SPACE                  TO DC-OPTION-CODE.
 22244     PERFORM 9700-DATE-LINK.
 22245     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 22246
 22247     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 22248     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 22249
 22250     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 22251        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 22252                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 22253
 22254     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 22255     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 22256     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 22257
 22258     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 22259        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 22260                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 22261
 22262     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 413
* EL6311.cbl
 22263     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 22264     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 22265
 22266     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 22267        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 22268                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 22269
 22270     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 22271     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 22272
 22273     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 22274        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 22275                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 22276
 22277     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 22278     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 22279     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 22280
 22281     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 22282        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 22283                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 22284
 22285     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 22286     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 22287     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 22288
 22289     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 22290        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 22291                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 22292
 22293     MOVE -1                     TO DPFENTRL.
 22294     GO TO 8100-SEND-INITIAL-MAP.
 22295
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 414
* EL6311.cbl
 22297
 22298***************************************************************
 22299*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 22300*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 22301*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 22302*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 22303*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 22304*     ARE THEN SET ACCORDINGLY.                               *
 22305*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 22306*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 22307*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 22308***************************************************************
 22309
 22310******************************************************************
 22311*                                                                *
 22312*            E R R O R   A N A L Y S I S                         *
 22313*                                                                *
 22314******************************************************************
 22315
 22316******************************************************************
 22317*                                                                *
 22318*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 22319*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 22320*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 22321*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 22322*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 22323*                                                                *
 22324*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 22325*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 22326*                                                                *
 22327******************************************************************
 22328
 22329 7300-FORMAT-ERRORS.
 22330     MOVE ' '                    TO PI-ERRORS-SW
 22331     IF PB-COMMON-ERRORS = LOW-VALUES
 22332        IF PB-FATAL-ERRORS
 22333           MOVE ER-2695          TO EMI-ERROR
 22334           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22335           GO TO 7399-EXIT.
 22336
 22337     MOVE +0                     TO WS-SUB4.
 22338
 22339 7310-ERROR-LOOP.
 22340
 22341     ADD +1                      TO WS-SUB4.
 22342
 22343     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22344        GO TO 7350-SET-ERROR-FLAGS.
 22345
 22346     IF PI-COMPANY-ID = 'UCL'
 22347         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 22348             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 22349             MOVE ' '                   TO DC-OPTION-CODE
 22350             PERFORM 9700-DATE-LINK
 22351             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 22352
 22353     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 22354     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 415
* EL6311.cbl
 22355     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 22356
 22357     GO TO 7310-ERROR-LOOP.
 22358
 22359
 22360 7350-SET-ERROR-FLAGS.
 22361
 22362     IF EMI-FATAL-CTR NOT = ZEROS
 22363        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22364        MOVE 'X'                 TO PB-FATAL-FLAG
 22365                                    PI-ERRORS-SW
 22366        GO TO 7355-SET-ERROR-FLAGS.
 22367
 22368     IF EMI-FORCABLE-CTR NOT = ZEROS
 22369        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22370        IF PB-ISSUE
 22371           IF PB-ISSUE-FORCE
 22372              MOVE 'F'           TO PB-FORCE-ER-CD
 22373              MOVE ER-2600       TO EMI-ERROR
 22374              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22375             ELSE
 22376              MOVE 'X'           TO PB-FORCE-ER-CD
 22377*                                   PI-ERRORS-SW
 22378          ELSE
 22379           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 22380              MOVE 'F'           TO PB-FORCE-ER-CD
 22381              MOVE ER-2600       TO EMI-ERROR
 22382              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22383             ELSE
 22384              MOVE 'X'           TO PB-FORCE-ER-CD.
 22385*                                   PI-ERRORS-SW.
 22386
 22387     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 22388     IF PB-ISSUE
 22389         MOVE 'I'                TO ENDT-RECORD-TYPE
 22390     ELSE
 22391         MOVE 'C'                TO ENDT-RECORD-TYPE
 22392     END-IF
 22393     MOVE +0                     TO ENDT-SEQ-NO
 22394
 22395
 22396* EXEC CICS READ
 22397*        DATASET   (FILE-ID-ERENDT)
 22398*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 22399*        RIDFLD    (ERENDT-KEY)
 22400*        RESP      (WS-RESPONSE)
 22401*        GTEQ
 22402*    END-EXEC
 22403*    MOVE '&"S        G          (  N#00018747' TO DFHEIV0
 22404     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 22405     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22406     MOVE X'204E233030303138373437' TO DFHEIV0(25:11)
 22407     CALL 'kxdfhei1' USING DFHEIV0,
 22408           FILE-ID-ERENDT,
 22409           DFHEIV20,
 22410           DFHEIV99,
 22411           ERENDT-KEY,
 22412           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 416
* EL6311.cbl
 22413           DFHEIV99,
 22414           DFHEIV99
 22415     SET ADDRESS OF ENDORSEMENT-RECORD TO
 22416         DFHEIV20
 22417     MOVE EIBRESP  TO WS-RESPONSE
 22418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22419
 22420     IF RESP-NORMAL
 22421        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 22422        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 22423            MOVE ER-0280          TO EMI-ERROR
 22424            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 22425            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 22426            EVALUATE TRUE
 22427              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 22428                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 22429              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 22430                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 22431              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 22432                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 22433            END-EVALUATE
 22434        END-IF
 22435     END-IF
 22436
 22437
 22438
 22439     IF FIRST-ENTRY OR
 22440        EIBAID = DFHPF1 OR DFHPF2
 22441        MOVE '0'                TO PI-EDIT-SW
 22442        GO TO 7399-EXIT.
 22443
 22444 7355-SET-ERROR-FLAGS.
 22445
 22446     IF EMI-WARNING-CTR NOT = ZEROS
 22447        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 22448        MOVE 'W'                 TO PB-WARN-ER-CD.
 22449
 22450     IF PB-UNFORCED-ERRORS OR
 22451        PB-FATAL-ERRORS    OR
 22452        PB-RECORD-ON-HOLD  OR
 22453        PB-RECORD-RETURNED OR
 22454        PB-CANCELLATION
 22455          NEXT SENTENCE
 22456        ELSE
 22457          GO TO 7399-EXIT.
 22458
 22459
 22460* EXEC CICS  HANDLE CONDITION
 22461*           NOTFND   (7399-EXIT)
 22462*    END-EXEC.
 22463*    MOVE '"$I                   ! Z #00018794' TO DFHEIV0
 22464     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22465     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22466     MOVE X'5A20233030303138373934' TO DFHEIV0(25:11)
 22467     CALL 'kxdfhei1' USING DFHEIV0
 22468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22469
 22470
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 417
* EL6311.cbl
 22471     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22472     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 22473     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 22474     MOVE PB-SV-STATE            TO ELCERT-STATE.
 22475
 22476
 22477* EXEC CICS READ
 22478*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 22479*        DATASET (FILE-ID-ELCERT)
 22480*        RIDFLD  (ELCERT-KEY)
 22481*        UPDATE
 22482*    END-EXEC.
 22483*    MOVE '&"S        EU         (   #00018803' TO DFHEIV0
 22484     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22485     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22486     MOVE X'2020233030303138383033' TO DFHEIV0(25:11)
 22487     CALL 'kxdfhei1' USING DFHEIV0,
 22488           FILE-ID-ELCERT,
 22489           DFHEIV20,
 22490           DFHEIV99,
 22491           ELCERT-KEY,
 22492           DFHEIV99,
 22493           DFHEIV99,
 22494           DFHEIV99
 22495     SET ADDRESS OF CERTIFICATE-MASTER TO
 22496         DFHEIV20
 22497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22498
 22499
 22500
 22501     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 22502     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 22503
 22504     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 22505        GO TO 7360-REWRITE-CERT-MASTER.
 22506
 22507     IF PB-ISSUE
 22508        IF PB-RECORD-RETURNED
 22509            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 22510            GO TO 7360-REWRITE-CERT-MASTER
 22511        ELSE
 22512            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 22513            GO TO 7360-REWRITE-CERT-MASTER.
 22514
 22515     IF PB-RECORD-RETURNED
 22516         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 22517         GO TO 7360-REWRITE-CERT-MASTER.
 22518
 22519     IF (PB-C-LF-CANCEL-VOIDED)
 22520        or (pb-c-ah-cancel-voided)
 22521        IF (PB-UNFORCED-ERRORS OR
 22522            PB-FATAL-ERRORS    OR
 22523            PB-RECORD-ON-HOLD)
 22524            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 22525            GO TO 7360-REWRITE-CERT-MASTER
 22526        ELSE
 22527            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 22528            GO TO 7360-REWRITE-CERT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 418
* EL6311.cbl
 22529
 22530     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 22531                            OR PB-RECORD-ON-HOLD)
 22532        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 22533     ELSE
 22534        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 22535
 22536 7360-REWRITE-CERT-MASTER.
 22537
 22538     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22539        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22540
 22541* EXEC CICS UNLOCK
 22542*            DATASET    (FILE-ID-ELCERT)
 22543*       END-EXEC
 22544*    MOVE '&*                    #   #00018850' TO DFHEIV0
 22545     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22546     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22547     MOVE X'2020233030303138383530' TO DFHEIV0(25:11)
 22548     CALL 'kxdfhei1' USING DFHEIV0,
 22549           FILE-ID-ELCERT,
 22550           DFHEIV99
 22551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22552        GO TO 7399-EXIT.
 22553
 22554
 22555* EXEC CICS REWRITE
 22556*         DATASET    (FILE-ID-ELCERT)
 22557*         FROM       (CERTIFICATE-MASTER)
 22558*    END-EXEC.
 22559     MOVE LENGTH OF
 22560      CERTIFICATE-MASTER
 22561       TO DFHEIV11
 22562*    MOVE '&& L                  %   #00018855' TO DFHEIV0
 22563     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22564     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22565     MOVE X'2020233030303138383535' TO DFHEIV0(25:11)
 22566     CALL 'kxdfhei1' USING DFHEIV0,
 22567           FILE-ID-ELCERT,
 22568           CERTIFICATE-MASTER,
 22569           DFHEIV11,
 22570           DFHEIV99
 22571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22572
 22573
 22574 7399-EXIT.
 22575      EXIT.
 22576
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 419
* EL6311.cbl
 22578
 22579*************************************************************
 22580*                                                           *
 22581*              S E T   A T T R I B U T E S                  *
 22582*                                                           *
 22583*************************************************************
 22584
 22585 7400-SET-ATTRIBUTES.
 22586
 22587     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22588        GO TO 7499-EXIT.
 22589
 22590**2601**
 22591
 22592     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 22593        IF PB-ISSUE
 22594           MOVE AL-UABON         TO BEFFDTA
 22595           GO TO 7499-EXIT
 22596         ELSE
 22597           MOVE AL-UABON         TO CEFFDTA
 22598           GO TO 7499-EXIT.
 22599
 22600**2604**
 22601
 22602     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 22603        IF PB-ISSUE
 22604           MOVE AL-UABON         TO BTYPE1A
 22605           MOVE -1               TO BTYPE1L
 22606           MOVE  1               TO SET-CURSOR-SW
 22607           GO TO 7499-EXIT.
 22608
 22609**2605**
 22610
 22611     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 22612        IF PB-ISSUE
 22613           MOVE AL-UABON         TO BTYPE2A
 22614           MOVE -1               TO BTYPE2L
 22615           MOVE  1               TO SET-CURSOR-SW
 22616           GO TO 7499-EXIT.
 22617
 22618**2606**
 22619
 22620     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 22621        IF PB-ISSUE
 22622           MOVE AL-UABON         TO BSIGA
 22623           MOVE -1               TO BSIGL
 22624           MOVE  1               TO SET-CURSOR-SW
 22625           GO TO 7499-EXIT.
 22626
 22627**2607**
 22628
 22629     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22630        IF PB-ISSUE
 22631           MOVE AL-UABON         TO BSIGA
 22632           MOVE -1               TO BSIGL
 22633           MOVE  1               TO SET-CURSOR-SW
 22634           GO TO 7499-EXIT.
 22635
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 420
* EL6311.cbl
 22636**2615**
 22637
 22638     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22639        IF PB-ISSUE
 22640           MOVE AL-UABOF         TO BREINA
 22641           MOVE -1               TO BREINL
 22642           GO TO 7499-EXIT.
 22643
 22644**2622**
 22645
 22646     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 22647        IF PB-ISSUE
 22648           MOVE AL-UABON         TO BEFFDTA
 22649           GO TO 7499-EXIT
 22650        ELSE
 22651           MOVE AL-UABON         TO CEFFDTA
 22652           GO TO 7499-EXIT.
 22653
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 421
* EL6311.cbl
 22655
 22656*************************************************************
 22657*                                                           *
 22658*              I S S U E   E R R O R S                      *
 22659*                                                           *
 22660*************************************************************
 22661
 22662 7420-ISSUE-ERRORS.
 22663
 22664**2626**
 22665
 22666     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 22667        MOVE AL-UABON            TO BCERTNOA
 22668        GO TO 7499-EXIT.
 22669
 22670**2627**
 22671
 22672     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 22673        MOVE AL-UNBON            TO BAGEA
 22674        MOVE -1                  TO BAGEL
 22675        MOVE  1                  TO SET-CURSOR-SW
 22676        GO TO 7499-EXIT.
 22677
 22678**2628**
 22679
 22680     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 22681        MOVE AL-UNBON            TO BAGEA
 22682        MOVE -1                  TO BAGEL
 22683        MOVE  1                  TO SET-CURSOR-SW
 22684        GO TO 7499-EXIT.
 22685
 22686**2629**
 22687
 22688     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 22689        MOVE AL-UABON            TO BSEXA
 22690        MOVE -1                  TO BSEXL
 22691        MOVE  1                  TO SET-CURSOR-SW
 22692        GO TO 7499-EXIT.
 22693
 22694**2630**
 22695
 22696     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 22697        MOVE -1                  TO BTYPE1L
 22698        MOVE  1                  TO SET-CURSOR-SW
 22699        GO TO 7499-EXIT.
 22700
 22701**2631**
 22702
 22703     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 22704        MOVE -1                  TO BTYPE1L
 22705        MOVE  1                  TO SET-CURSOR-SW
 22706        GO TO 7499-EXIT.
 22707
 22708**2632**
 22709
 22710     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 22711        MOVE AL-UNBON            TO BBEN1A
 22712        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 422
* EL6311.cbl
 22713        MOVE  1                  TO SET-CURSOR-SW
 22714        GO TO 7499-EXIT.
 22715
 22716**2633**
 22717
 22718     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 22719        MOVE AL-UNBON            TO BPREM1A
 22720        MOVE -1                  TO BPREM1L
 22721        MOVE  1                  TO SET-CURSOR-SW
 22722        GO TO 7499-EXIT.
 22723
 22724**2634**
 22725
 22726     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 22727        MOVE -1                  TO BTYPE2L
 22728        MOVE  1                  TO SET-CURSOR-SW
 22729        GO TO 7499-EXIT.
 22730
 22731**2635**
 22732
 22733     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 22734        MOVE AL-UNBON            TO BBEN2A
 22735        MOVE -1                  TO BBEN2L
 22736        MOVE  1                  TO SET-CURSOR-SW
 22737        GO TO 7499-EXIT.
 22738
 22739**2636**
 22740
 22741     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 22742        MOVE AL-UNBON            TO BPREM2A
 22743        MOVE -1                  TO BPREM2L
 22744        MOVE  1                  TO SET-CURSOR-SW
 22745        GO TO 7499-EXIT.
 22746
 22747**2639**
 22748
 22749     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 22750        MOVE AL-UNBON            TO BBEN1A
 22751        MOVE -1                  TO BBEN1L
 22752        MOVE  1                  TO SET-CURSOR-SW
 22753        GO TO 7499-EXIT.
 22754
 22755**2640**
 22756
 22757     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 22758        MOVE AL-UNBON            TO BBEN2A
 22759        MOVE -1                  TO BBEN2L
 22760        MOVE  1                  TO SET-CURSOR-SW
 22761        GO TO 7499-EXIT.
 22762
 22763**2647**
 22764
 22765     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 22766        MOVE AL-UNBON            TO BTERM1A
 22767        MOVE -1                  TO BTERM1L
 22768        MOVE  1                  TO SET-CURSOR-SW
 22769        GO TO 7499-EXIT.
 22770
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 423
* EL6311.cbl
 22771**2648**
 22772
 22773     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 22774        MOVE AL-UNBON            TO BLNTRMA
 22775        MOVE -1                  TO BLNTRML
 22776        MOVE  1                  TO SET-CURSOR-SW
 22777        GO TO 7499-EXIT.
 22778
 22779**2649**
 22780
 22781     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22782        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22783            MOVE AL-UNBON            TO BPREM1A
 22784            MOVE -1                  TO BPREM1L
 22785            MOVE  1                  TO SET-CURSOR-SW
 22786            GO TO 7499-EXIT
 22787     ELSE
 22788        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22789           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22790            MOVE AL-UNBON            TO BPREM2A
 22791            MOVE -1                  TO BPREM2L
 22792            MOVE  1                  TO SET-CURSOR-SW
 22793            GO TO 7499-EXIT.
 22794
 22795**2650**
 22796
 22797     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22798        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22799            MOVE AL-UNBON        TO BPREM1A
 22800            MOVE -1              TO BPREM1L
 22801            MOVE  1              TO SET-CURSOR-SW
 22802            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22803                MOVE AL-UNBON        TO BPREM2A
 22804                MOVE -1              TO BPREM2L
 22805                MOVE  1              TO SET-CURSOR-SW
 22806                GO TO 7499-EXIT
 22807            ELSE
 22808                GO TO 7499-EXIT
 22809        ELSE
 22810            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22811                MOVE AL-UNBON        TO BPREM2A
 22812                MOVE -1              TO BPREM2L
 22813                MOVE  1              TO SET-CURSOR-SW
 22814                GO TO 7499-EXIT
 22815            ELSE
 22816                GO TO 7499-EXIT.
 22817
 22818**2651**
 22819
 22820     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22821        MOVE AL-UABON            TO BSIGA
 22822        MOVE -1                  TO BSIGL
 22823        MOVE  1                  TO SET-CURSOR-SW
 22824        GO TO 7499-EXIT.
 22825
 22826**2653**
 22827
 22828     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 424
* EL6311.cbl
 22829        MOVE AL-UABON            TO BFREQA
 22830        MOVE -1                  TO BFREQL
 22831        MOVE  1                  TO SET-CURSOR-SW
 22832        GO TO 7499-EXIT.
 22833
 22834**2654**
 22835
 22836     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 22837        MOVE AL-UABON            TO BFREQA
 22838        MOVE -1                  TO BFREQL
 22839        MOVE  1                  TO SET-CURSOR-SW
 22840        GO TO 7499-EXIT.
 22841
 22842**2655**
 22843
 22844     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 22845        MOVE AL-UABON            TO BFREQA
 22846        MOVE -1                  TO BFREQL
 22847        MOVE  1                  TO SET-CURSOR-SW
 22848        GO TO 7499-EXIT.
 22849
 22850**2656**
 22851
 22852     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 22853        MOVE AL-UNBON            TO BAPRA
 22854        MOVE -1                  TO BAPRL
 22855        MOVE  1                  TO SET-CURSOR-SW
 22856        GO TO 7499-EXIT.
 22857
 22858**2657**
 22859
 22860     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22861        MOVE AL-UNBON            TO BAPRA
 22862        MOVE -1                  TO BAPRL
 22863        MOVE  1                  TO SET-CURSOR-SW
 22864        GO TO 7499-EXIT.
 22865
 22866**2658**
 22867
 22868     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22869        MOVE AL-UNBON            TO BTERM2A
 22870        MOVE -1                  TO BTERM2L
 22871        MOVE  1                  TO SET-CURSOR-SW
 22872        GO TO 7499-EXIT.
 22873
 22874**2660**
 22875
 22876     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 22877        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 22878        MOVE -1                  TO BLSTNML
 22879        MOVE  1                  TO SET-CURSOR-SW
 22880        GO TO 7499-EXIT.
 22881
 22882
 22883**2662**
 22884
 22885     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 22886        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 425
* EL6311.cbl
 22887        MOVE -1                  TO BAGEL
 22888        MOVE  1                  TO SET-CURSOR-SW
 22889        GO TO 7499-EXIT.
 22890
 22891**2663**
 22892
 22893     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 22894        MOVE AL-UNBON            TO BAGEA
 22895        MOVE -1                  TO BAGEL
 22896        MOVE  1                  TO SET-CURSOR-SW
 22897        GO TO 7499-EXIT.
 22898
 22899**2664**
 22900
 22901     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 22902        MOVE AL-UABON            TO BREINA
 22903        MOVE -1                  TO BREINL
 22904        MOVE  1                  TO SET-CURSOR-SW
 22905        GO TO 7499-EXIT.
 22906
 22907**2667**
 22908
 22909     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 22910        MOVE AL-UNBON            TO BBEN2A
 22911        MOVE -1                  TO BBEN2L
 22912        MOVE  1                  TO SET-CURSOR-SW
 22913        GO TO 7499-EXIT.
 22914
 22915**2668**
 22916
 22917     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 22918        MOVE AL-UABON            TO BEFFDTA
 22919        GO TO 7499-EXIT.
 22920
 22921**2669**
 22922
 22923     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 22924       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 22925       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 22926        MOVE AL-UNBON            TO BAGEA
 22927        MOVE -1                  TO BAGEL
 22928        MOVE  1                  TO SET-CURSOR-SW
 22929        GO TO 7499-EXIT.
 22930
 22931**2670**
 22932
 22933     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 22934        MOVE AL-UABON            TO BFORCEA
 22935        MOVE -1                  TO BFORCEL
 22936        MOVE  1                  TO SET-CURSOR-SW
 22937        GO TO 7499-EXIT.
 22938
 22939**2671**
 22940
 22941     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 22942        MOVE AL-UABON            TO BEFFDTA
 22943        GO TO 7499-EXIT.
 22944
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 426
* EL6311.cbl
 22945**2672**
 22946
 22947     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 22948        MOVE AL-UABON            TO BEFFDTA
 22949        GO TO 7499-EXIT.
 22950
 22951**2673**
 22952
 22953     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22954        MOVE AL-UABON            TO BEFFDTA
 22955        GO TO 7499-EXIT.
 22956
 22957**2674**
 22958
 22959     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22960        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 22961        MOVE -1                  TO BTYPE1L
 22962        MOVE  1                  TO SET-CURSOR-SW
 22963        GO TO 7499-EXIT.
 22964
 22965**2677**
 22966
 22967     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 22968        MOVE AL-UNBON            TO BTERM1A
 22969        MOVE -1                  TO BTERM1L
 22970        MOVE  1                  TO SET-CURSOR-SW
 22971        GO TO 7499-EXIT.
 22972
 22973**2678**
 22974
 22975     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 22976        MOVE AL-UNBON            TO BTERM2A
 22977        MOVE -1                  TO BTERM2L
 22978        MOVE  1                  TO SET-CURSOR-SW
 22979        GO TO 7499-EXIT.
 22980
 22981**2679**
 22982
 22983     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 22984        MOVE AL-UABON            TO BTYPE1A
 22985        MOVE -1                  TO BTYPE1L
 22986        MOVE  1                  TO SET-CURSOR-SW
 22987        GO TO 7499-EXIT.
 22988
 22989**2680**
 22990
 22991     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 22992        MOVE AL-UABOF            TO B1STPMTA
 22993        MOVE -1                  TO B1STPMTL
 22994        MOVE  1                  TO SET-CURSOR-SW
 22995        GO TO 7499-EXIT.
 22996
 22997**2681**
 22998
 22999     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23000        MOVE AL-UABON            TO BDAYSA
 23001        MOVE -1                  TO BDAYSL
 23002        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 427
* EL6311.cbl
 23003        GO TO 7499-EXIT.
 23004
 23005**2682**
 23006
 23007     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23008        MOVE AL-UABON            TO BTERM1A
 23009        MOVE -1                  TO BTERM1L
 23010        MOVE  1                  TO SET-CURSOR-SW
 23011        GO TO 7499-EXIT.
 23012
 23013**2683**
 23014
 23015     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23016        MOVE AL-UABON            TO BSKPCDA
 23017        MOVE -1                  TO BSKPCDL
 23018        MOVE  1                  TO SET-CURSOR-SW
 23019        GO TO 7499-EXIT.
 23020
 23021**2684**
 23022
 23023     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23024        MOVE AL-UABON            TO BTYPE2A
 23025        MOVE -1                  TO BTYPE2L
 23026        MOVE  1                  TO SET-CURSOR-SW
 23027        GO TO 7499-EXIT.
 23028
 23029**2686**
 23030
 23031     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23032        MOVE AL-UABON            TO BTYPE2A
 23033        MOVE -1                  TO BTYPE2L
 23034        MOVE  1                  TO SET-CURSOR-SW
 23035        GO TO 7499-EXIT.
 23036
 23037**2689**
 23038
 23039     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23040        MOVE AL-UABON            TO BSIGA
 23041        MOVE -1                  TO BSIGL
 23042        MOVE  1                  TO SET-CURSOR-SW
 23043        GO TO 7499-EXIT.
 23044
 23045**2690**
 23046
 23047     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23048        MOVE AL-UABOF            TO BLNOFCRA
 23049        MOVE -1                  TO BLNOFCRL
 23050        MOVE  1                  TO SET-CURSOR-SW
 23051        GO TO 7499-EXIT.
 23052
 23053**2693**
 23054
 23055     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23056        MOVE AL-UABOF            TO BLNOFCRA
 23057        MOVE AL-UNBON            TO BBEN1A
 23058        MOVE -1                  TO BBEN1L
 23059        MOVE  1                  TO SET-CURSOR-SW
 23060        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 428
* EL6311.cbl
 23061
 23062**2720**
 23063
 23064     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23065        MOVE AL-UNBON            TO BBEN1A
 23066        MOVE -1                  TO BBEN1L
 23067        MOVE  1                  TO SET-CURSOR-SW
 23068        GO TO 7499-EXIT.
 23069
 23070**2709**
 23071
 23072*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23073*       MOVE AL-UNBON            TO BBEN1A
 23074*       MOVE -1                  TO BBEN1L
 23075*       MOVE  1                  TO SET-CURSOR-SW
 23076*       GO TO 7499-EXIT.
 23077
 23078*************************************************************
 23079*                                                           *
 23080*            C A N C E L   E R R O R S                      *
 23081*                                                           *
 23082*************************************************************
 23083
 23084**2726**
 23085
 23086     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23087        MOVE AL-UABON            TO CCERTNOA
 23088        GO TO 7499-EXIT.
 23089
 23090**2728**
 23091
 23092     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23093        MOVE AL-UABON            TO CCERTNOA
 23094        GO TO 7499-EXIT.
 23095
 23096**2729**
 23097
 23098     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23099        MOVE AL-UABON            TO CCERTNOA
 23100        GO TO 7499-EXIT.
 23101
 23102**2730**
 23103
 23104     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23105        MOVE AL-UABON            TO CCERTNOA
 23106        GO TO 7499-EXIT.
 23107
 23108**2731**
 23109
 23110     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23111        MOVE AL-UABON            TO CCANDT1A
 23112        MOVE -1                  TO CCANDT1L
 23113        MOVE  1                  TO SET-CURSOR-SW
 23114        GO TO 7499-EXIT.
 23115
 23116**2732**
 23117
 23118     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 429
* EL6311.cbl
 23119        MOVE AL-UABON            TO CCANDT1A
 23120        MOVE -1                  TO CCANDT1L
 23121        MOVE  1                  TO SET-CURSOR-SW
 23122        GO TO 7499-EXIT.
 23123
 23124**2733**
 23125
 23126     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23127        MOVE AL-UABON            TO CCANDT1A
 23128        MOVE -1                  TO CCANDT1L
 23129        MOVE  1                  TO SET-CURSOR-SW
 23130        GO TO 7499-EXIT.
 23131
 23132**2734**
 23133
 23134     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23135        MOVE AL-UNBON            TO CREFND1A
 23136        MOVE -1                  TO CREFND1L
 23137        MOVE  1                  TO SET-CURSOR-SW
 23138        GO TO 7499-EXIT.
 23139
 23140**2735**
 23141
 23142     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23143        MOVE AL-UABON            TO CCANDT2A
 23144        MOVE -1                  TO CCANDT2L
 23145        MOVE  1                  TO SET-CURSOR-SW
 23146        GO TO 7499-EXIT.
 23147
 23148**2736**
 23149
 23150     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23151        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23152            MOVE AL-UNBON        TO CREFND1A
 23153            MOVE -1              TO CREFND1L
 23154            MOVE  1              TO SET-CURSOR-SW
 23155            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23156                MOVE AL-UNBON        TO CREFND2A
 23157                MOVE -1              TO CREFND2L
 23158                MOVE  1              TO SET-CURSOR-SW
 23159                GO TO 7499-EXIT
 23160            ELSE
 23161                GO TO 7499-EXIT
 23162        ELSE
 23163            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23164                MOVE AL-UNBON        TO CREFND2A
 23165                MOVE -1              TO CREFND2L
 23166                MOVE  1              TO SET-CURSOR-SW
 23167                GO TO 7499-EXIT
 23168            ELSE
 23169                GO TO 7499-EXIT.
 23170
 23171**2738**
 23172
 23173     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23174        MOVE -1                  TO CREFND2L
 23175        MOVE  1                  TO SET-CURSOR-SW
 23176        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 430
* EL6311.cbl
 23177
 23178**2739**
 23179
 23180     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23181        MOVE -1                  TO CREFND1L
 23182        MOVE  1                  TO SET-CURSOR-SW
 23183        GO TO 7499-EXIT.
 23184
 23185**2741**
 23186
 23187     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23188        MOVE -1                  TO CREFND1L
 23189        MOVE  1                  TO SET-CURSOR-SW
 23190        GO TO 7499-EXIT.
 23191
 23192**2743**
 23193
 23194     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23195        MOVE AL-UNBON            TO CCANDT1A
 23196        MOVE -1                  TO CCANDT1L
 23197        MOVE  1                  TO SET-CURSOR-SW
 23198        GO TO 7499-EXIT.
 23199
 23200**2744**
 23201
 23202     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23203        MOVE AL-UNBON            TO CCANDT2A
 23204        MOVE -1                  TO CCANDT2L
 23205        MOVE  1                  TO SET-CURSOR-SW
 23206        GO TO 7499-EXIT.
 23207
 23208**2747**
 23209
 23210     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23211        MOVE AL-UABON            TO CLSTNMA
 23212        MOVE -1                  TO CLSTNML
 23213        MOVE  1                  TO SET-CURSOR-SW
 23214        GO TO 7499-EXIT.
 23215
 23216**2749**
 23217
 23218     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 23219        MOVE AL-UABON            TO CFORCEA
 23220        MOVE -1                  TO CFORCEL
 23221        MOVE  1                  TO SET-CURSOR-SW
 23222        GO TO 7499-EXIT.
 23223
 23224**2753**
 23225
 23226     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 23227        MOVE AL-UNBON            TO CCANDT1A
 23228        MOVE -1                  TO CCANDT1L
 23229        MOVE  1                  TO SET-CURSOR-SW
 23230        GO TO 7499-EXIT.
 23231
 23232**2755**
 23233
 23234     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 431
* EL6311.cbl
 23235        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23236            MOVE AL-UNBON        TO CREFND1A
 23237            MOVE -1              TO CREFND1L
 23238            MOVE  1              TO SET-CURSOR-SW
 23239            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23240                MOVE AL-UNBON        TO CREFND2A
 23241                MOVE -1              TO CREFND2L
 23242                MOVE  1              TO SET-CURSOR-SW
 23243                GO TO 7499-EXIT
 23244            ELSE
 23245                GO TO 7499-EXIT
 23246        ELSE
 23247            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23248                MOVE AL-UNBON        TO CREFND2A
 23249                MOVE -1              TO CREFND2L
 23250                MOVE  1              TO SET-CURSOR-SW
 23251            ELSE
 23252                GO TO 7499-EXIT.
 23253
 23254**2757**
 23255
 23256     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 23257        MOVE AL-UNBON            TO CLIVESA
 23258        MOVE -1                  TO CLIVESL
 23259        MOVE  1                  TO SET-CURSOR-SW
 23260        GO TO 7499-EXIT.
 23261
 23262**2771**
 23263
 23264     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 23265        MOVE AL-UABON            TO CCANDT2A
 23266        MOVE -1                  TO CCANDT2L
 23267        MOVE  1                  TO SET-CURSOR-SW
 23268        GO TO 7499-EXIT.
 23269
 23270**2774**
 23271
 23272     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 23273        MOVE AL-UABON            TO CCANDT1A
 23274        MOVE -1                  TO CCANDT1L
 23275        MOVE  1                  TO SET-CURSOR-SW
 23276        GO TO 7499-EXIT.
 23277
 23278**2775**
 23279
 23280     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 23281        MOVE AL-UABON            TO CCANDT2A
 23282        MOVE -1                  TO CCANDT2L
 23283        MOVE  1                  TO SET-CURSOR-SW
 23284        GO TO 7499-EXIT.
 23285
 23286**2776**
 23287
 23288     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 23289        MOVE AL-UABON            TO CCANDT1A
 23290        MOVE -1                  TO CCANDT1L
 23291        MOVE  1                  TO SET-CURSOR-SW
 23292        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 432
* EL6311.cbl
 23293
 23294
 23295**2777**
 23296
 23297     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 23298        MOVE AL-UABON            TO CCANDT2A
 23299        MOVE -1                  TO CCANDT2L
 23300        MOVE  1                  TO SET-CURSOR-SW
 23301        GO TO 7499-EXIT.
 23302
 23303**2794**
 23304
 23305     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 23306        MOVE AL-UABON            TO CFORCEA
 23307        MOVE -1                  TO CFORCEL
 23308        MOVE  1                  TO SET-CURSOR-SW
 23309        GO TO 7499-EXIT.
 23310
 23311**2799**
 23312
 23313     IF PI-COMPANY-ID = 'UCL'
 23314         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 23315             MOVE AL-UNBON            TO BEFFDTA
 23316             MOVE -1                  TO BEFFDTL
 23317             MOVE  1                  TO SET-CURSOR-SW
 23318             GO TO 7499-EXIT.
 23319
 23320 7499-EXIT.
 23321      EXIT.
 23322
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 433
* EL6311.cbl
 23324
 23325 7500-READ-ERLOFC.
 23326     MOVE SPACES                 TO  WS-LOAN-OFFICER
 23327                                     ERLOFC-KEY.
 23328
 23329     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 23330
 23331     IF ST-ACCNT-CNTL
 23332         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23333
 23334     IF CARR-GROUP-ST-ACCNT-CNTL
 23335         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23336         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 23337         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 23338
 23339     IF CARR-ST-ACCNT-CNTL
 23340         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 23341         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 23342
 23343     IF CARR-ACCNT-CNTL
 23344         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 23345
 23346     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 23347
 23348     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 23349
 23350
 23351* EXEC CICS HANDLE CONDITION
 23352*        NOTFND   (7550-OFFICER-NOTFND)
 23353*    END-EXEC.
 23354*    MOVE '"$I                   ! [ #00019636' TO DFHEIV0
 23355     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23356     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23357     MOVE X'5B20233030303139363336' TO DFHEIV0(25:11)
 23358     CALL 'kxdfhei1' USING DFHEIV0
 23359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23360
 23361
 23362
 23363* EXEC CICS READ
 23364*        DATASET   (FILE-ID-ERLOFC)
 23365*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 23366*        RIDFLD    (ERLOFC-KEY)
 23367*        EQUAL
 23368*    END-EXEC.
 23369*    MOVE '&"S        E          (   #00019640' TO DFHEIV0
 23370     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23371     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23372     MOVE X'2020233030303139363430' TO DFHEIV0(25:11)
 23373     CALL 'kxdfhei1' USING DFHEIV0,
 23374           FILE-ID-ERLOFC,
 23375           DFHEIV20,
 23376           DFHEIV99,
 23377           ERLOFC-KEY,
 23378           DFHEIV99,
 23379           DFHEIV99,
 23380           DFHEIV99
 23381     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 434
* EL6311.cbl
 23382         DFHEIV20
 23383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23384
 23385
 23386     GO TO 7599-EXIT.
 23387
 23388 7550-OFFICER-NOTFND.
 23389     MOVE 'X'                    TO WS-LOAN-OFFICER.
 23390
 23391 7599-EXIT.
 23392      EXIT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 435
* EL6311.cbl
 23394******************************************************************
 23395*                                                                *
 23396*            S  E N D    I N I T I A L   M A P                   *
 23397*                                                                *
 23398******************************************************************
 23399
 23400 8100-SEND-INITIAL-MAP.
 23401     MOVE EIBTIME                TO TIME-IN.
 23402
 23403     IF EIBAID = DFHPF11
 23404        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 23405        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 23406
 23407
 23408     IF PI-COMPANY-ID = CLIENT-GIC
 23409        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23410                                       BCPREM-ATTRB (2).
 23411
 23412     IF PI-COMPANY-ID = (CLIENT-MIC OR
 23413                         CLIENT-PEM OR
 23414                         CLIENT-CSO)
 23415        AND PI-DISPLAY-ORIGINAL-BATCH
 23416          IF PI-MAP-NAME = EL631B
 23417             MOVE AL-SADOF               TO BPF5HDRA
 23418                                            BPF4HDRA
 23419          ELSE
 23420             IF PI-MAP-NAME = EL631C
 23421                MOVE AL-SADOF            TO CPF5HDRA
 23422                                            CPF4HDRA.
 23423
 23424     IF PI-MAP-NAME = EL631B
 23425        MOVE AL-SADOF               TO BPF5HDRA
 23426     ELSE
 23427        MOVE AL-SADOF               TO CPF5HDRA
 23428     END-IF
 23429
 23430*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23431     IF PI-MAP-NAME = EL631B
 23432          IF PI-COMPANY-ID NOT = 'DMD'
 23433             MOVE AL-SANOF            TO BBILLEDA
 23434             MOVE AL-SADOF            TO DMDBILA.
 23435*DMD CUSTOM CODING*************END
 23436
 23437     IF PI-PROCESSOR-ID = 'LGXX'
 23438        IF PI-MAP-NAME = EL631B
 23439           MOVE AL-SABOF                    TO BREFHDGA
 23440           MOVE AL-SANOF                    TO BREFA
 23441        ELSE
 23442           IF PI-MAP-NAME = EL631C
 23443              MOVE AL-SABOF                 TO CREFHDGA
 23444              MOVE AL-SANOF                 TO CREFA.
 23445
 23446*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 23447     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 23448        NEXT SENTENCE
 23449     ELSE
 23450        IF PI-MAP-NAME = EL631C
 23451           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 436
* EL6311.cbl
 23452                                       CCANFEEA.
 23453
 23454     IF PI-MAP-NAME = EL631D
 23455        IF PI-AR-PROCESSING
 23456           MOVE AL-SANOF            TO DREFHDGA
 23457        ELSE
 23458           MOVE AL-SADOF            TO DREFHDGA.
 23459
 23460     IF (PI-COMPANY-ID NOT = 'DCC')
 23461        AND (PI-MAP-NAME = EL631B)
 23462        MOVE AL-SADOF            TO BVINHA
 23463                                    BVINA
 23464     END-IF
 23465     IF PI-MAP-NAME = EL631B
 23466        IF CSR-EDIT-SESSION
 23467           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23468                                 TO BHEADO
 23469           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23470        ELSE
 23471           MOVE AL-SADOF         TO BF15HDRA
 23472           MOVE '4=B-HDR      '  TO BPF4HDRO
 23473        END-IF
 23474        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23475        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 23476        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 23477        MOVE WS-CURRENT-DT          TO BDATEO
 23478        MOVE TIME-OUT               TO BTIMEO
 23479        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23480        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23481        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23482        IF   WS-DISPLAY-SCREEN
 23483             MOVE PB-ENTRY-BATCH    TO BBATCHO
 23484             MOVE PB-SV-CARRIER     TO BCARRO
 23485             MOVE PB-SV-GROUPING    TO BGROUPO
 23486             MOVE PB-SV-STATE       TO BSTATEO
 23487             MOVE PB-ACCOUNT        TO BACCTO
 23488        ELSE
 23489             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 23490     ELSE
 23491        IF PI-MAP-NAME = EL631C
 23492           MOVE '4=B-HDR      '     TO CPF4HDRO
 23493           IF CSR-EDIT-SESSION
 23494              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23495                                 TO CHEADO
 23496           ELSE
 23497              MOVE AL-SADOF      TO CF15HDRA
 23498           END-IF
 23499           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 23500           MOVE WS-CURRENT-DT          TO CDATEO
 23501           MOVE TIME-OUT               TO CTIMEO
 23502           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 23503           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 23504           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 23505           MOVE WS-C-HDG               TO CLFHDGO
 23506           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 23507           MOVE WS-C-HDG               TO CAHHDGO
 23508           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23509           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 437
* EL6311.cbl
 23510           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23511           IF   WS-DISPLAY-SCREEN
 23512                MOVE PB-ENTRY-BATCH    TO CBATCHO
 23513                MOVE PB-SV-CARRIER     TO CCARRO
 23514                MOVE PB-SV-GROUPING    TO CGROUPO
 23515                MOVE PB-SV-STATE       TO CSTATEO
 23516                MOVE PB-ACCOUNT        TO CACCTO
 23517           ELSE
 23518                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 23519        ELSE
 23520           MOVE WS-CURRENT-DT          TO DDATEO
 23521           MOVE TIME-OUT               TO DTIMEO
 23522           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 23523                                          WS-REFUND-HDG-OVERRIDE
 23524           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 23525           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 23526           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 23527                                          WS-REFUND-HDG-OVERRIDE
 23528           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 23529           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 23530           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 23531           IF CSR-EDIT-SESSION
 23532              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23533                                 TO DHEADO
 23534           END-IF
 23535           IF  WS-DISPLAY-SCREEN
 23536               MOVE PB-ENTRY-BATCH     TO DBATCHO
 23537               MOVE PB-CARRIER         TO DCARRO
 23538               MOVE PB-GROUPING        TO DGROUPO
 23539               MOVE PB-STATE           TO DSTATEO
 23540               MOVE PB-ACCOUNT         TO DACCTO
 23541               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 23542           ELSE
 23543               MOVE EL631D             TO PI-MAP-NAME
 23544               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 23545               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 23546
 23547     MOVE SPACE                        TO WS-DISPLAY-SW.
 23548
 23549
 23550* EXEC CICS SEND
 23551*        MAP      (PI-MAP-NAME)
 23552*        MAPSET   (MAPSET-EL6311S)
 23553*        FROM     (EL631BI)
 23554*        ERASE
 23555*        CURSOR
 23556*    END-EXEC.
 23557     MOVE LENGTH OF
 23558      EL631BI
 23559       TO DFHEIV12
 23560     MOVE -1
 23561       TO DFHEIV11
 23562*    MOVE '8$     CT  E    H L F ,   #00019810' TO DFHEIV0
 23563     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 23564     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23565     MOVE X'2020233030303139383130' TO DFHEIV0(25:11)
 23566     CALL 'kxdfhei1' USING DFHEIV0,
 23567           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 438
* EL6311.cbl
 23568           EL631BI,
 23569           DFHEIV12,
 23570           MAPSET-EL6311S,
 23571           DFHEIV99,
 23572           DFHEIV99,
 23573           DFHEIV99,
 23574           DFHEIV11,
 23575           DFHEIV99,
 23576           DFHEIV99,
 23577           DFHEIV99
 23578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23579
 23580
 23581     GO TO 9100-RETURN-TRAN.
 23582
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 439
* EL6311.cbl
 23584
 23585******************************************************************
 23586*                                                                *
 23587*              S E N D    D A T A O N L Y                        *
 23588*                                                                *
 23589******************************************************************
 23590
 23591 8200-SEND-DATAONLY.
 23592     MOVE EIBTIME                TO TIME-IN.
 23593
 23594     IF PI-COMPANY-ID = CLIENT-GIC
 23595        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23596                                       BCPREM-ATTRB (2).
 23597
 23598     IF PI-MAP-NAME = EL631B
 23599        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23600        MOVE WS-CURRENT-DT          TO BDATEO
 23601        MOVE TIME-OUT               TO BTIMEO
 23602        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23603        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23604        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23605        MOVE SPACES                 TO BPFENTRO
 23606        MOVE AL-UANOF               TO BPFENTRA
 23607
 23608*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23609        IF PI-COMPANY-ID NOT = 'DMD'
 23610             MOVE AL-SANOF            TO BBILLEDA
 23611             MOVE AL-SADOF            TO DMDBILA
 23612         ELSE
 23613            NEXT SENTENCE
 23614*DMD CUSTOM CODING*************END
 23615     ELSE
 23616        IF PI-MAP-NAME = EL631C
 23617           MOVE WS-CURRENT-DT          TO CDATEO
 23618           MOVE TIME-OUT               TO CTIMEO
 23619           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23620           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23621           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23622           MOVE SPACES                 TO CPFENTRO
 23623           MOVE AL-UANOF               TO CPFENTRA
 23624        ELSE
 23625           MOVE WS-CURRENT-DT          TO DDATEO
 23626           MOVE TIME-OUT               TO DTIMEO
 23627           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 23628
 23629
 23630* EXEC CICS SEND
 23631*        MAP      (PI-MAP-NAME)
 23632*        MAPSET   (MAPSET-EL6311S)
 23633*        FROM     (EL631BI)
 23634*        DATAONLY
 23635*        CURSOR
 23636*    END-EXEC.
 23637     MOVE LENGTH OF
 23638      EL631BI
 23639       TO DFHEIV12
 23640     MOVE -1
 23641       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 440
* EL6311.cbl
 23642*    MOVE '8$D    CT       H L F ,   #00019866' TO DFHEIV0
 23643     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 23644     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23645     MOVE X'2020233030303139383636' TO DFHEIV0(25:11)
 23646     CALL 'kxdfhei1' USING DFHEIV0,
 23647           PI-MAP-NAME,
 23648           EL631BI,
 23649           DFHEIV12,
 23650           MAPSET-EL6311S,
 23651           DFHEIV99,
 23652           DFHEIV99,
 23653           DFHEIV99,
 23654           DFHEIV11,
 23655           DFHEIV99,
 23656           DFHEIV99,
 23657           DFHEIV99
 23658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23659
 23660
 23661     GO TO 9100-RETURN-TRAN.
 23662
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 441
* EL6311.cbl
 23664
 23665******************************************************************
 23666*                                                                *
 23667*           U T I L I T Y   R O U T I N E S                      *
 23668*                                                                *
 23669******************************************************************
 23670
 23671 8300-SEND-TEXT.
 23672
 23673* EXEC CICS SEND TEXT
 23674*        FROM     (LOGOFF-TEXT)
 23675*        LENGTH   (LOGOFF-LENGTH)
 23676*        ERASE
 23677*        FREEKB
 23678*    END-EXEC.
 23679*    MOVE '8&      T  E F  H   F -   #00019885' TO DFHEIV0
 23680     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 23681     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 23682     MOVE X'2020233030303139383835' TO DFHEIV0(25:11)
 23683     CALL 'kxdfhei1' USING DFHEIV0,
 23684           LOGOFF-TEXT,
 23685           LOGOFF-LENGTH,
 23686           DFHEIV99,
 23687           DFHEIV99,
 23688           DFHEIV99,
 23689           DFHEIV99,
 23690           DFHEIV99,
 23691           DFHEIV99,
 23692           DFHEIV99,
 23693           DFHEIV99,
 23694           DFHEIV99,
 23695           DFHEIV99
 23696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23697
 23698
 23699
 23700* EXEC CICS RETURN
 23701*    END-EXEC.
 23702*    MOVE '.(                    ''   #00019892' TO DFHEIV0
 23703     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23704     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23705     MOVE X'2020233030303139383932' TO DFHEIV0(25:11)
 23706     CALL 'kxdfhei1' USING DFHEIV0,
 23707           DFHEIV99,
 23708           DFHEIV99,
 23709           DFHEIV99,
 23710           DFHEIV99,
 23711           DFHEIV99,
 23712           DFHEIV99
 23713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23714
 23715
 23716 8400-LOG-JOURNAL-RECORD.
 23717     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 23718     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 23719
 23720*    EXEC CICS JOURNAL
 23721*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 442
* EL6311.cbl
 23722*        JTYPEID     ('EL')
 23723*        FROM        (JOURNAL-RECORD)
 23724*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 23725*    END-EXEC.
 23726
 23727 8600-DEEDIT.
 23728
 23729* EXEC CICS BIF DEEDIT
 23730*         FIELD   (DEEDIT-FIELD)
 23731*         LENGTH  (15)
 23732*    END-EXEC.
 23733     MOVE 15
 23734       TO DFHEIV11
 23735*    MOVE '@"L                   #   #00019907' TO DFHEIV0
 23736     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 23737     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23738     MOVE X'2020233030303139393037' TO DFHEIV0(25:11)
 23739     CALL 'kxdfhei1' USING DFHEIV0,
 23740           DEEDIT-FIELD,
 23741           DFHEIV11
 23742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23743
 23744
 23745 8800-UNAUTHORIZED-ACCESS.
 23746     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 23747     GO TO 8300-SEND-TEXT.
 23748
 23749 8810-PF23.
 23750     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 23751     MOVE XCTL-EL005             TO PGM-NAME.
 23752     GO TO 9300-XCTL.
 23753
 23754 9100-RETURN-TRAN.
 23755     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 23756
 23757     IF  PI-MAP-NAME =  EL631B
 23758         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 23759
 23760     IF  PI-MAP-NAME =  EL631C
 23761         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 23762
 23763     IF  PI-MAP-NAME =  EL631D
 23764         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 23765
 23766
 23767* EXEC CICS RETURN
 23768*        TRANSID    (TRANS-EXB1)
 23769*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23770*        LENGTH     (1300)
 23771*    END-EXEC.
 23772     MOVE 1300
 23773       TO DFHEIV11
 23774*    MOVE '.(CT                  ''   #00019933' TO DFHEIV0
 23775     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 23776     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23777     MOVE X'2020233030303139393333' TO DFHEIV0(25:11)
 23778     CALL 'kxdfhei1' USING DFHEIV0,
 23779           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 443
* EL6311.cbl
 23780           PROGRAM-INTERFACE-BLOCK,
 23781           DFHEIV11,
 23782           DFHEIV99,
 23783           DFHEIV99,
 23784           DFHEIV99
 23785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23786
 23787
 23788 9200-RETURN-MAIN-MENU.
 23789     MOVE XCTL-EL626             TO PGM-NAME.
 23790     GO TO 9300-XCTL.
 23791
 23792 9300-XCTL.
 23793
 23794* EXEC CICS XCTL
 23795*        PROGRAM    (PGM-NAME)
 23796*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23797*        LENGTH     (PI-COMM-LENGTH)
 23798*    END-EXEC.
 23799*    MOVE '.$C                   %   #00019944' TO DFHEIV0
 23800     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 23801     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23802     MOVE X'2020233030303139393434' TO DFHEIV0(25:11)
 23803     CALL 'kxdfhei1' USING DFHEIV0,
 23804           PGM-NAME,
 23805           PROGRAM-INTERFACE-BLOCK,
 23806           PI-COMM-LENGTH,
 23807           DFHEIV99
 23808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23809
 23810
 23811 9400-CLEAR.
 23812     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 23813     GO TO 9300-XCTL.
 23814
 23815 9500-PF12.
 23816     MOVE XCTL-EL010             TO PGM-NAME.
 23817     GO TO 9300-XCTL.
 23818
 23819 9600-PGMID-ERROR.
 23820
 23821* EXEC CICS HANDLE CONDITION
 23822*        PGMIDERR    (8300-SEND-TEXT)
 23823*    END-EXEC.
 23824*    MOVE '"$L                   ! \ #00019959' TO DFHEIV0
 23825     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 23826     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23827     MOVE X'5C20233030303139393539' TO DFHEIV0(25:11)
 23828     CALL 'kxdfhei1' USING DFHEIV0
 23829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23830
 23831
 23832     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 23833     MOVE ' '                    TO PI-ENTRY-CD-1.
 23834     MOVE XCTL-EL005             TO PGM-NAME.
 23835     MOVE PGM-NAME               TO LOGOFF-PGM.
 23836     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 23837     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 444
* EL6311.cbl
 23838
 23839 9700-DATE-LINK.
 23840     MOVE LINK-ELDATCV           TO PGM-NAME.
 23841
 23842* EXEC CICS LINK
 23843*        PROGRAM    (PGM-NAME)
 23844*        COMMAREA   (DATE-CONVERSION-DATA)
 23845*        LENGTH     (DC-COMM-LENGTH)
 23846*    END-EXEC.
 23847*    MOVE '."C                   (   #00019972' TO DFHEIV0
 23848     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23849     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23850     MOVE X'2020233030303139393732' TO DFHEIV0(25:11)
 23851     CALL 'kxdfhei1' USING DFHEIV0,
 23852           PGM-NAME,
 23853           DATE-CONVERSION-DATA,
 23854           DC-COMM-LENGTH,
 23855           DFHEIV99,
 23856           DFHEIV99,
 23857           DFHEIV99,
 23858           DFHEIV99
 23859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23860
 23861
 23862 9800-LINK-PENDING-EDIT.
 23863     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 23864     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 23865
 23866     MOVE LINK-EL050             TO PGM-NAME
 23867     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 23868     MOVE ZEROS                  TO WK-CO-MAX-CAP
 23869                                    WK-CO-TOL-CLAIM
 23870                                    WK-CO-TOL-PREM
 23871                                    WK-CO-TOL-REFUND
 23872                                    WK-CO-TOL-PREM-PCT
 23873                                    WK-CO-TOL-REFUND-PCT
 23874                                    WK-REFUND-OVS-AMT
 23875                                    WK-REFUND-OVS-PCT
 23876                                    WK-ACCT-ADDR
 23877                                    WK-LIFE-EDIT-ADDR
 23878                                    WK-AH-EDIT-ADDR
 23879                                    WK-LIFE-BEN-ADDR
 23880                                    WK-AH-BEN-ADDR
 23881                                    WK-STATE-ADDR
 23882                                    WK-PLAN-ADDR
 23883                                    WK-FORM-ADDR
 23884     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 23885
 23886     MOVE '6'                    TO WK-ENTRY-SW.
 23887
 23888     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 23889
 23890     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 23891                                    EC-AM-EXPIRATION-DT
 23892                                    EC-AM-EFFECTIVE-DT
 23893                                    EC-CM-LF-CANCEL-DT
 23894                                    EC-CM-AH-CANCEL-DT
 23895                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 445
* EL6311.cbl
 23896
 23897     MOVE ZEROS                  TO EC-CO-TOL-PREM
 23898                                    EC-CO-TOL-REFUND
 23899                                    EC-CO-MIN-AGE
 23900                                    EC-CO-MIN-PREMIUM
 23901                                    EC-CO-MIN-TERM
 23902                                    EC-CO-MAX-TERM
 23903                                    EC-ST-TOL-PREM
 23904                                    EC-ST-TOL-REFUND
 23905                                    EC-AM-LF-TOL-PREM
 23906                                    EC-AM-AH-TOL-PREM
 23907                                    EC-AM-LF-MAX-ATT-AGE
 23908                                    EC-AM-LF-MAX-AGE
 23909                                    EC-AM-LF-MAX-TERM
 23910                                    EC-AM-LF-MAX-TOT-BEN
 23911                                    EC-AM-AH-MAX-ATT-AGE
 23912                                    EC-AM-AH-MAX-AGE
 23913                                    EC-AM-AH-MAX-TERM
 23914                                    EC-AM-AH-MAX-TOT-BEN
 23915                                    EC-AM-AH-MAX-MON-BEN
 23916                                    EC-RT-LF-MAX-ATT-AGE
 23917                                    EC-RT-LF-MAX-AGE
 23918                                    EC-RT-LF-MAX-TERM
 23919                                    EC-RT-LF-MAX-TOT-BEN
 23920                                    EC-RT-AH-MAX-ATT-AGE
 23921                                    EC-RT-AH-MAX-AGE
 23922                                    EC-RT-AH-MAX-TERM
 23923                                    EC-RT-AH-MAX-TOT-BEN
 23924                                    EC-RT-AH-MAX-MON-BEN
 23925                                    EC-RT-AH-RATE
 23926                                    EC-RT-LF-RATE
 23927                                    EC-RT-LF-NSP-RATE
 23928                                    EC-RT-AH-NSP-RATE
 23929                                    EC-CM-LF-PRIOR-REFUND
 23930                                    EC-CM-AH-PRIOR-REFUND.
 23931
 23932     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 23933                                    EC-ST-TOL-PREM-PCT
 23934                                    EC-AM-LF-TOL-REFUND
 23935                                    EC-AM-LF-DEV-PERCENT
 23936                                    EC-CO-TOL-REFUND-PCT
 23937                                    EC-ST-TOL-REFUND-PCT
 23938                                    EC-AM-AH-TOL-REFUND
 23939                                    EC-AM-AH-DEV-PERCENT.
 23940
 23941
 23942* EXEC CICS LINK
 23943*         PROGRAM   (PGM-NAME)
 23944*         COMMAREA  (PASSED-RECORD)
 23945*         LENGTH    (WS-EDIT-PASS-LENGTH)
 23946*    END-EXEC.
 23947*    MOVE '."C                   (   #00020057' TO DFHEIV0
 23948     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23949     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23950     MOVE X'2020233030303230303537' TO DFHEIV0(25:11)
 23951     CALL 'kxdfhei1' USING DFHEIV0,
 23952           PGM-NAME,
 23953           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 446
* EL6311.cbl
 23954           WS-EDIT-PASS-LENGTH,
 23955           DFHEIV99,
 23956           DFHEIV99,
 23957           DFHEIV99,
 23958           DFHEIV99
 23959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23960
 23961
 23962     MOVE '1'                    TO PI-EDIT-SW.
 23963     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 23964
 23965     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 23966
 23967     IF PI-COMPANY-ID = 'UCL'
 23968         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 23969
 23970     IF VALID-PB-ID
 23971        GO TO 9800-EXIT.
 23972
 23973     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 23974
 23975     IF PI-MAP-NAME = EL631B
 23976        MOVE -1                  TO BMAINTL
 23977       ELSE
 23978        MOVE -1                  TO CMAINTL.
 23979
 23980     GO TO 8200-SEND-DATAONLY.
 23981
 23982 9800-EXIT.
 23983      EXIT.
 23984
 23985 9900-ERROR-FORMAT.
 23986
 23987     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 23988
 23989     IF NOT EMI-ERRORS-COMPLETE
 23990         MOVE LINK-EL001         TO PGM-NAME
 23991
 23992* EXEC CICS LINK
 23993*            PROGRAM    (PGM-NAME)
 23994*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 23995*            LENGTH     (EMI-COMM-LENGTH)
 23996*        END-EXEC.
 23997*    MOVE '."C                   (   #00020092' TO DFHEIV0
 23998     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23999     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24000     MOVE X'2020233030303230303932' TO DFHEIV0(25:11)
 24001     CALL 'kxdfhei1' USING DFHEIV0,
 24002           PGM-NAME,
 24003           ERROR-MESSAGE-INTERFACE-BLOCK,
 24004           EMI-COMM-LENGTH,
 24005           DFHEIV99,
 24006           DFHEIV99,
 24007           DFHEIV99,
 24008           DFHEIV99
 24009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24010
 24011
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 447
* EL6311.cbl
 24012 9900-EXIT.
 24013     EXIT.
 24014
 24015 9990-ABEND.
 24016     MOVE LINK-EL004             TO PGM-NAME.
 24017     MOVE DFHEIBLK               TO EMI-LINE1.
 24018
 24019* EXEC CICS LINK
 24020*        PROGRAM   (PGM-NAME)
 24021*        COMMAREA  (EMI-LINE1)
 24022*        LENGTH    (72)
 24023*    END-EXEC.
 24024     MOVE 72
 24025       TO DFHEIV11
 24026*    MOVE '."C                   (   #00020104' TO DFHEIV0
 24027     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24028     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24029     MOVE X'2020233030303230313034' TO DFHEIV0(25:11)
 24030     CALL 'kxdfhei1' USING DFHEIV0,
 24031           PGM-NAME,
 24032           EMI-LINE1,
 24033           DFHEIV11,
 24034           DFHEIV99,
 24035           DFHEIV99,
 24036           DFHEIV99,
 24037           DFHEIV99
 24038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24039
 24040
 24041     IF PI-MAP-NAME = EL631B
 24042        MOVE -1                  TO BMAINTL
 24043       ELSE
 24044        MOVE -1                  TO CMAINTL.
 24045
 24046     IF EIBTRNID NOT = TRANS-EXB1
 24047        GO TO 8100-SEND-INITIAL-MAP
 24048       ELSE
 24049        GO TO 8200-SEND-DATAONLY.
 24050
 24051 9995-SECURITY-VIOLATION.
 24052*                            COPY ELCSCTP.
 24053******************************************************************
 24054*                                                                *
 24055*                            ELCSCTP                             *
 24056*                            VMOD=2.001                          *
 24057*                                                                *
 24058*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24059******************************************************************
 24060
 24061
 24062     MOVE EIBDATE          TO SM-JUL-DATE.
 24063     MOVE EIBTRMID         TO SM-TERMID.
 24064     MOVE THIS-PGM         TO SM-PGM.
 24065     MOVE EIBTIME          TO TIME-IN.
 24066     MOVE TIME-OUT         TO SM-TIME.
 24067     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24068
 24069
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 448
* EL6311.cbl
 24070* EXEC CICS LINK
 24071*         PROGRAM  ('EL003')
 24072*         COMMAREA (SECURITY-MESSAGE)
 24073*         LENGTH   (80)
 24074*    END-EXEC.
 24075     MOVE 'EL003' TO DFHEIV1
 24076     MOVE 80
 24077       TO DFHEIV11
 24078*    MOVE '."C                   (   #00020138' TO DFHEIV0
 24079     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24081     MOVE X'2020233030303230313338' TO DFHEIV0(25:11)
 24082     CALL 'kxdfhei1' USING DFHEIV0,
 24083           DFHEIV1,
 24084           SECURITY-MESSAGE,
 24085           DFHEIV11,
 24086           DFHEIV99,
 24087           DFHEIV99,
 24088           DFHEIV99,
 24089           DFHEIV99
 24090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24091
 24092
 24093******************************************************************
 24094
 24095
 24096 9999-DFHBACK SECTION.
 24097     MOVE '9%                    "   ' TO DFHEIV0
 24098     MOVE 'EL6311' TO DFHEIV1
 24099     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24100     GOBACK.
 24101 9999-DFHEXIT.
 24102     IF DFHEIGDJ EQUAL 0001
 24103         NEXT SENTENCE
 24104     ELSE IF DFHEIGDJ EQUAL 2
 24105         GO TO 9600-PGMID-ERROR,
 24106               9990-ABEND,
 24107               9990-ABEND,
 24108               0010-MAIN-LOGIC
 24109         DEPENDING ON DFHEIGDI
 24110     ELSE IF DFHEIGDJ EQUAL 3
 24111         GO TO 1280-BATCH-HDR-NOT-FOUND
 24112         DEPENDING ON DFHEIGDI
 24113     ELSE IF DFHEIGDJ EQUAL 4
 24114         GO TO 1290-DUPLICATE-ALT-INDEX
 24115         DEPENDING ON DFHEIGDI
 24116     ELSE IF DFHEIGDJ EQUAL 5
 24117         GO TO 1295-CERT-TRL-REC-NOTFND
 24118         DEPENDING ON DFHEIGDI
 24119     ELSE IF DFHEIGDJ EQUAL 6
 24120         GO TO 1380-BATCH-HDR-NOT-FOUND
 24121         DEPENDING ON DFHEIGDI
 24122     ELSE IF DFHEIGDJ EQUAL 7
 24123         GO TO 1385-REC-NOT-FOUND
 24124         DEPENDING ON DFHEIGDI
 24125     ELSE IF DFHEIGDJ EQUAL 8
 24126         GO TO 1386-NOTFND
 24127         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 449
* EL6311.cbl
 24128     ELSE IF DFHEIGDJ EQUAL 9
 24129         GO TO 1399-EXIT
 24130         DEPENDING ON DFHEIGDI
 24131     ELSE IF DFHEIGDJ EQUAL 10
 24132         GO TO 1480-BATCH-HDR-NOT-FOUND
 24133         DEPENDING ON DFHEIGDI
 24134     ELSE IF DFHEIGDJ EQUAL 11
 24135         GO TO 1490-RECORD-NOT-FOUND
 24136         DEPENDING ON DFHEIGDI
 24137     ELSE IF DFHEIGDJ EQUAL 12
 24138         GO TO 1405-DELETE-CERTIFICATE
 24139         DEPENDING ON DFHEIGDI
 24140     ELSE IF DFHEIGDJ EQUAL 13
 24141         GO TO 1420-CONTINUE-DELETE
 24142         DEPENDING ON DFHEIGDI
 24143     ELSE IF DFHEIGDJ EQUAL 14
 24144         GO TO 1406-DELETE-ERNOTE
 24145         DEPENDING ON DFHEIGDI
 24146     ELSE IF DFHEIGDJ EQUAL 15
 24147         GO TO 1407-DELETE-MAILING
 24148         DEPENDING ON DFHEIGDI
 24149     ELSE IF DFHEIGDJ EQUAL 16
 24150         GO TO 1420-CONTINUE-DELETE
 24151         DEPENDING ON DFHEIGDI
 24152     ELSE IF DFHEIGDJ EQUAL 17
 24153         GO TO 1480-BATCH-HDR-NOT-FOUND
 24154         DEPENDING ON DFHEIGDI
 24155     ELSE IF DFHEIGDJ EQUAL 18
 24156         GO TO 1475-DELETE-FINISHED
 24157         DEPENDING ON DFHEIGDI
 24158     ELSE IF DFHEIGDJ EQUAL 19
 24159         GO TO 2280-BATCH-HDR-NOT-FOUND
 24160         DEPENDING ON DFHEIGDI
 24161     ELSE IF DFHEIGDJ EQUAL 20
 24162         GO TO 2290-DUPLICATE-ALT-INDEX
 24163         DEPENDING ON DFHEIGDI
 24164     ELSE IF DFHEIGDJ EQUAL 21
 24165         GO TO 2380-BATCH-HDR-NOT-FOUND
 24166         DEPENDING ON DFHEIGDI
 24167     ELSE IF DFHEIGDJ EQUAL 22
 24168         GO TO 2385-REC-NOT-FOUND
 24169         DEPENDING ON DFHEIGDI
 24170     ELSE IF DFHEIGDJ EQUAL 23
 24171         GO TO 2380-BATCH-HDR-NOT-FOUND
 24172         DEPENDING ON DFHEIGDI
 24173     ELSE IF DFHEIGDJ EQUAL 24
 24174         GO TO 2485-BATCH-HDR-NOT-FOUND
 24175         DEPENDING ON DFHEIGDI
 24176     ELSE IF DFHEIGDJ EQUAL 25
 24177         GO TO 2490-RECORD-NOT-FOUND
 24178         DEPENDING ON DFHEIGDI
 24179     ELSE IF DFHEIGDJ EQUAL 26
 24180         GO TO 2475-CONTINUE-DELETE
 24181         DEPENDING ON DFHEIGDI
 24182     ELSE IF DFHEIGDJ EQUAL 27
 24183         GO TO 2485-BATCH-HDR-NOT-FOUND
 24184         DEPENDING ON DFHEIGDI
 24185     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 450
* EL6311.cbl
 24186         GO TO 2480-DELETE-FINISHED
 24187         DEPENDING ON DFHEIGDI
 24188     ELSE IF DFHEIGDJ EQUAL 29
 24189         GO TO 2820-PROCESS-REWRITE
 24190         DEPENDING ON DFHEIGDI
 24191     ELSE IF DFHEIGDJ EQUAL 30
 24192         GO TO 2885-RECORD-MISSING
 24193         DEPENDING ON DFHEIGDI
 24194     ELSE IF DFHEIGDJ EQUAL 31
 24195         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24196         DEPENDING ON DFHEIGDI
 24197     ELSE IF DFHEIGDJ EQUAL 32
 24198         GO TO 2827-DELETE-MAILING
 24199         DEPENDING ON DFHEIGDI
 24200     ELSE IF DFHEIGDJ EQUAL 33
 24201         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24202         DEPENDING ON DFHEIGDI
 24203     ELSE IF DFHEIGDJ EQUAL 34
 24204         GO TO 2920-PROCESS-REWRITE
 24205         DEPENDING ON DFHEIGDI
 24206     ELSE IF DFHEIGDJ EQUAL 35
 24207         GO TO 2985-RECORD-MISSING
 24208         DEPENDING ON DFHEIGDI
 24209     ELSE IF DFHEIGDJ EQUAL 36
 24210         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24211         DEPENDING ON DFHEIGDI
 24212     ELSE IF DFHEIGDJ EQUAL 37
 24213         GO TO 2990-DUPLICATE-RECORD
 24214         DEPENDING ON DFHEIGDI
 24215     ELSE IF DFHEIGDJ EQUAL 38
 24216         GO TO 3590-NOT-FOUND
 24217         DEPENDING ON DFHEIGDI
 24218     ELSE IF DFHEIGDJ EQUAL 39
 24219         GO TO 3690-NOT-FOUND
 24220         DEPENDING ON DFHEIGDI
 24221     ELSE IF DFHEIGDJ EQUAL 40
 24222         GO TO 3990-NOT-FOUND
 24223         DEPENDING ON DFHEIGDI
 24224     ELSE IF DFHEIGDJ EQUAL 41
 24225         GO TO 4050-END-RECORDS,
 24226               4050-END-RECORDS
 24227         DEPENDING ON DFHEIGDI
 24228     ELSE IF DFHEIGDJ EQUAL 42
 24229         GO TO 4150-END-BATCH
 24230         DEPENDING ON DFHEIGDI
 24231     ELSE IF DFHEIGDJ EQUAL 43
 24232         GO TO 4150-END-BATCH
 24233         DEPENDING ON DFHEIGDI
 24234     ELSE IF DFHEIGDJ EQUAL 44
 24235         GO TO 4250-END-RECORDS,
 24236               4250-END-RECORDS
 24237         DEPENDING ON DFHEIGDI
 24238     ELSE IF DFHEIGDJ EQUAL 45
 24239         GO TO 4350-END-BATCH,
 24240               4350-END-BATCH
 24241         DEPENDING ON DFHEIGDI
 24242     ELSE IF DFHEIGDJ EQUAL 46
 24243         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 21-Nov-13 09:37 Page 451
* EL6311.cbl
 24244               4550-END-RECORDS
 24245         DEPENDING ON DFHEIGDI
 24246     ELSE IF DFHEIGDJ EQUAL 47
 24247         GO TO 4680-NOT-FOUND,
 24248               4680-NOT-FOUND
 24249         DEPENDING ON DFHEIGDI
 24250     ELSE IF DFHEIGDJ EQUAL 48
 24251         GO TO 4860-NOT-FOUND,
 24252               4850-END-RECORDS
 24253         DEPENDING ON DFHEIGDI
 24254     ELSE IF DFHEIGDJ EQUAL 49
 24255         GO TO 4970-NOT-FOUND,
 24256               4950-END-RECORDS
 24257         DEPENDING ON DFHEIGDI
 24258     ELSE IF DFHEIGDJ EQUAL 50
 24259         GO TO 5050-NOT-FOUND
 24260         DEPENDING ON DFHEIGDI
 24261     ELSE IF DFHEIGDJ EQUAL 51
 24262         GO TO 5050-NOT-FOUND
 24263         DEPENDING ON DFHEIGDI
 24264     ELSE IF DFHEIGDJ EQUAL 52
 24265         GO TO 5050-NOT-FOUND
 24266         DEPENDING ON DFHEIGDI
 24267     ELSE IF DFHEIGDJ EQUAL 53
 24268         GO TO 5550-END-RECORDS,
 24269               5550-END-RECORDS
 24270         DEPENDING ON DFHEIGDI
 24271     ELSE IF DFHEIGDJ EQUAL 54
 24272         GO TO 6050-QID-ERROR
 24273         DEPENDING ON DFHEIGDI
 24274     ELSE IF DFHEIGDJ EQUAL 55
 24275         GO TO 6050-QID-ERROR
 24276         DEPENDING ON DFHEIGDI
 24277     ELSE IF DFHEIGDJ EQUAL 56
 24278         GO TO 6400-CONTINUE,
 24279               6400-CONTINUE
 24280         DEPENDING ON DFHEIGDI
 24281     ELSE IF DFHEIGDJ EQUAL 57
 24282         GO TO 3690-NOT-FOUND
 24283         DEPENDING ON DFHEIGDI
 24284     ELSE IF DFHEIGDJ EQUAL 58
 24285         GO TO 7399-EXIT
 24286         DEPENDING ON DFHEIGDI
 24287     ELSE IF DFHEIGDJ EQUAL 59
 24288         GO TO 7550-OFFICER-NOTFND
 24289         DEPENDING ON DFHEIGDI
 24290     ELSE IF DFHEIGDJ EQUAL 60
 24291         GO TO 8300-SEND-TEXT
 24292         DEPENDING ON DFHEIGDI.
 24293     MOVE '9%                    "   ' TO DFHEIV0
 24294     MOVE 'EL6311' TO DFHEIV1
 24295     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24296     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14768     Code:       96544
