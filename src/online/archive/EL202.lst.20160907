* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page   1
* EL202.cbl
* Options: int("EL202.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL202.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL202.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL202.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2*****************************************************************
     3*                                                               *
     4* Copyright (c) 2014 by Central States Health and Life          *
     5* All rights reserved.                                          *
     6*                                                               *
     7*****************************************************************
     8 identification division.
     9 program-id. EL202.
    10*
    11*AUTHOR.    Cowtown.
    12*           Colleyville, TEXAS.
    13*REMARKS.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page   2
* EL202.cbl
    14***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
    15***                                                            ***
    16***  This program is waken up by a webservice request/http     ***
    17***  request and is passed a remit id. The program will next   ***
    18***  read tables CUC_Logic_Remittance and CUC_Logic_Remittance_***
    19***  cert using the remit id passed and will in turn generate  ***
    20***  a ERPYAJ record, ERPNDB and ERPNDM records.               ***
    21***                                                            ***
    22***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 091114  CR2013121800001  PEMA  NEW PROGRAM
    32* 111715  IR2015111600001  PEMA  CHG G/L ACCTNO ON CID ACH
    33* 040516  IR2016040100001  PEMA  CNVT ALL TEXT TO UPPER CASE
    34*-----------------------------------------------------------------
    35 environment division.
    36 data division.
    37 working-storage section.
    38 01  DFH-START PIC X(04).
    39 77  s1                          pic s999 comp-3 value +0.
    40 77  s2                          pic s999 comp-3 value +0.
    41 77  i1                          pic s999 comp-3 value +0.
    42 77  o1                          pic s999 comp-3 value +0.
    43 77  ws-bin-current-dt           pic xx value low-values.
    44 77  ws-bin-eom-dt               pic xx value low-values.
    45 77  ws-table-sw                 pic x    value spaces.
    46     88  table-found               value 'Y'.
    47 77  ws-sql-code                 pic s9(7) value zeros.
    48 77  ws-dis-sql-code             pic -9999999 value zeros.
    49 77  ws-remit-sw                 pic x value ' '.
    50     88  ws-remit-not-found        value 'N'.
    51 77  work-seq-no                 pic s9(8) comp-3 value +0.
    52 77  ws-rollback-sw              pic x  value spaces.
    53     88  rollback-needed            value 'Y'.
    54 77  ws-commit-sw                pic x  value spaces.
    55     88  commit-needed              value 'Y'.
    56 77  ROLL-BACK                   PIC X(08) VALUE 'ROLLBACK'.
    57 01  P pointer.
    58 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    59 01  var-ptr pointer.
    60 01  env-var-len                 pic 9(4)  binary.
    61 01  rc                          pic 9(9)  binary.
    62 01  WS-KIXSYS.
    63     05  WS-KIX-FIL1             PIC X(10).
    64     05  WS-KIX-APPS             PIC X(10).
    65     05  WS-KIX-ENV              PIC X(10).
    66     05  WS-KIX-MYENV            PIC X(10).
    67     05  WS-KIX-SYS              PIC X(10).
*   68 EXEC SQL
*   69    INCLUDE SQLDA
*   70 END-EXEC
    71 01 SQLDA sync.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page   3
* EL202.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
    72    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    73    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    74    05 SQLN                  PIC S9(4) COMP-5 value 0.
    75    05 SQLD                  PIC S9(4) COMP-5 value 0.
    76    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    77       10 SQLTYPE            PIC S9(4) COMP-5.
    78       10 SQLLEN             PIC S9(4) COMP-5.
    79$IF P64 SET
    80X      *> For 64-bit environments, ensure that SQLDATA is
    81X      *> aligned on an 8-byte boundary.
    82X      10 FILLER             PIC S9(9) COMP-5.
    83$END
    84       10 SQLDATA            USAGE POINTER.
    85       10 SQLIND             USAGE POINTER.
    86       10 SQLNAME.
    87          15 SQLNAMEL        PIC S9(4) COMP-5.
    88          15 SQLNAMEC        PIC X(30).
    89
    90* Values for SQLTYPE
    91
    92 78  ESQL-DATE-CHAR              VALUE 384.
    93 78  ESQL-DATE-CHAR-NULL         VALUE 385.
    94 78  ESQL-DATE-REC               VALUE 386.
    95 78  ESQL-DATE-REC-NULL          VALUE 387.
    96 78  ESQL-TIME-CHAR              VALUE 388.
    97 78  ESQL-TIME-CHAR-NULL         VALUE 389.
    98 78  ESQL-TIME-REC               VALUE 390.
    99 78  ESQL-TIME-REC-NULL          VALUE 391.
   100 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   101 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   102 78  ESQL-TIMESTAMP-REC          VALUE 394.
   103 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   104 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   105 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   106 78  ESQL-TS-OFFSET-REC          VALUE 398.
   107 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   108 78  ESQL-LONGVARBINARY          VALUE 404.
   109 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   110 78  ESQL-LONGVARCHAR            VALUE 408.
   111 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   112 78  ESQL-BINARY                 VALUE 444.
   113 78  ESQL-BINARY-NULL            VALUE 445.
   114 78  ESQL-VARBINARY              VALUE 446.
   115 78  ESQL-VARBINARY-NULL         VALUE 447.
   116 78  ESQL-VARCHAR                VALUE 448.
   117 78  ESQL-VARCHAR-NULL           VALUE 449.
   118
   119 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   120 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   121
   122 78  ESQL-CHAR                   VALUE 452.
   123 78  ESQL-CHAR-NULL              VALUE 453.
   124
   125 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   126 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   127
   128 78  ESQL-DOUBLE                 VALUE 480.
   129 78  ESQL-DOUBLE-NULL            VALUE 481.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page   4
* EL202.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-REAL                   VALUE 482.
   131 78  ESQL-REAL-NULL              VALUE 483.
   132 78  ESQL-DECIMAL                VALUE 484.
   133 78  ESQL-DECIMAL-NULL           VALUE 485.
   134 78  ESQL-INTEGER                VALUE 496.
   135 78  ESQL-INTEGER-NULL           VALUE 497.
   136 78  ESQL-SMALLINT               VALUE 500.
   137 78  ESQL-SMALLINT-NULL          VALUE 501.
   138 78  ESQL-TINYINT                VALUE 502.
   139 78  ESQL-TINYINT-NULL           VALUE 503.
*  140 EXEC SQL
*  141    INCLUDE SQLCA
*  142 END-EXEC
   143 01 SQLCA.
   144     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   145     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   146     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   147     05  SQLERRM.
   148         49  SQLERRML    PIC S9(4) COMP-5.
   149         49  SQLERRMC    PIC X(70).
   150     05  SQLERRP         PIC X(8).
   151     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   152     05  SQLWARN.
   153         10  SQLWARN0    PIC X.
   154         10  SQLWARN1    PIC X.
   155         10  SQLWARN2    PIC X.
   156         10  SQLWARN3    PIC X.
   157         10  SQLWARN4    PIC X.
   158         10  SQLWARN5    PIC X.
   159         10  SQLWARN6    PIC X.
   160         10  SQLWARN7    PIC X.
   161     05  SQLEXT.
   162         10  SQLWARN8    PIC X.
   163         10  SQLWARN9    PIC X.
   164         10  SQLWARN10   PIC X.
   165         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   166     05  SQLSTATE    PIC X(5).
   167 EXEC SQL
   168    BEGIN DECLARE SECTION
   169 END-EXEC
   170 01  ws-remit-id-a               pic x(10).
   171 01  ws-remit-id redefines
   172     ws-remit-id-a               pic 9(10).
   173 01  ws-key-stuff.
   174     05  ws-batch-no             pic x(6) value zeros.
   175     05  ws-batch-no-n redefines
   176         ws-batch-no             pic 9(6).
   177     05  ws-check-key            pic 9(7).
   178     05  ws-check-no             pic x(7).
   179     05  ws-compid               pic xxx.
   180     05  ws-carrier              pic x.
   181     05  ws-grouping             pic x(6).
   182     05  ws-state                pic xx.
   183     05  ws-account              pic x(10).
   184     05  ws-eff-date             pic x(10).
   185     05  ws-certificate          pic x(10).
   186     05  ws-cert-sfx             pic x.
   187     05  ws-seq-no               pic 999.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page   5
* EL202.cbl
   188     05  ws-type                 pic 999.
   189 01  ws-status-code-a            pic x(7) value zeros.
   190 01  ws-status-code redefines
   191     ws-status-code-a            pic 9(7).
   192 01  ws-error-message            pic x(50) value spaces.
   193 01  ws-status-date              pic x(10).
   194 01  sqlcmd                      pic x(1024).
   195 01  svr                         pic x(32).
   196 01  usr                         pic x(32).
   197 01  pass                        pic x(32).
   198 01  usr-pass                    pic x(64).
   199 01  ws-disp-code                pic s9(11).
   200***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   201***                                                            ***
   202***  These indicators are used to determine if a variable      ***
   203***  is        null.           The indicator will be -1        ***
   204***  if the value        is null  and +0 if the value is       ***
   205***  something other than null.  Here is an example on how     ***
   206***  to use the indicator variables.                           ***
   207***                                                            ***
   208***     EXEC SQL                                               ***
   209***        fetch checkapp into                                 ***
   210***           :db-app-status :nu-app-status,                   ***
   211***           :db-app-by     :nu-app-by,                       ***
   212***           :db-app-date   :nu-app-date,                     ***
   213***           :db-app-batch  :nu-app-batch                     ***
   214***     END-EXEC                                               ***
   215***                                                            ***
   216***           OR This way on an update                         ***
   217***                                                            ***
   218***     EXEC SQL                                               ***
   219***        UPDATE                                              ***
   220***           CUC_Logic_Remittance                             ***
   221***        SET                                                 ***
   222***           LogicStatus     = :ws-status-code,               ***
   223***           LogicStatusDate = :ws-status-date,               ***
   224***           BatchNumber     = :ws-batch-no :nu-batchno       ***
   225***        WHERE                                               ***
   226***           RemitId = :ws-remit-id                           ***
   227***     END-EXEC                                               ***
   228***                                                            ***
   229***    Also, when the table has a column with a data type of   ***
   230***  "BIT" and used as true/false move the 1 byte receiving    ***
   231***  field to ws-bit and check out ws-bit-comp. if = zeros,    ***
   232***  then its false. I think true would be 256.                ***
   233***                                                            ***
   234***                                                            ***
   235***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   236 01  ws-bit                      pic x.
   237 01  ws-bit-comp redefines ws-bit pic s9(4) comp.
   238 01  indicator-vaiables-for-nulls.
   239     05  nu-app-status           pic s9(4) comp value +0.
   240     05  nu-app-by               pic s9(4) comp value +0.
   241     05  nu-app-date             pic s9(4) comp value +0.
   242     05  nu-app-batch            pic s9(4) comp value +0.
   243     05  nu-fincar               pic s9(4) comp value +0.
   244     05  nu-batchno              pic s9(4) comp value +0.
   245     05  nu-error-message        pic s9(4) comp value +0.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page   6
* EL202.cbl
   246 01  sql-remit-record.
   247     05  sql-py-RemitId          pic 9(9).
   248     05  sql-py-Carrier          pic x.
   249     05  sql-py-Group            pic x(6).
   250     05  sql-py-State            pic xx.
   251     05  sql-py-AccountNumber    pic x(10).
   252     05  sql-py-Name             pic x(50).
   253     05  sql-py-Addr1            pic x(50).
   254     05  sql-py-Addr2            pic x(50).
   255     05  sql-py-AddrCity         pic x(50).
   256     05  sql-py-AddrState        pic xx.
   257     05  sql-py-AddrZIP          pic x(9).
   258     05  sql-py-ResponsibleCarrier
   259                                 pic x.
   260     05  sql-py-ResponsibleNumber
   261                                 pic x(10).
   262     05  sql-py-LogicStatus      pic 9(7).
   263     05  sql-py-LogicStatusDate  pic x(30).
   264     05  sql-py-company          pic xxx.
   265     05  sql-py-tot-prem         pic x(12).
   266     05  sql-py-tot-prem-n redefines
   267         sql-py-tot-prem         pic 9(9).99.
   268     05  sql-is-ach              pic x.
   269 01  sql-cert-records.
   270     05  sql-pb-CertId           pic 9(9).
   271     05  sql-pb-RemitId          pic 9(9).
   272     05  sql-pb-CertNumber       pic x(11).
   273     05  sql-pb-EffectiveDate    pic x(30).
   274     05  sql-pb-FirstPaymentDate pic x(30).
   275     05  sql-pb-FirstName        pic x(30).
   276     05  sql-pb-LastName         pic x(30).
   277     05  sql-pb-CashIndicator    pic x.
   278     05  sql-pb-LivesCovered     pic 9(7).
   279     05  sql-pb-LfBenCode        pic xx.
   280     05  sql-pb-LfTerm           pic 999.
   281     05  sql-pb-LfBenefit        pic x(12).
   282     05  sql-pb-lfbenefit-n redefines
   283         sql-pb-lfbenefit        pic 9(9).99.
   284     05  sql-pb-LfPremium        pic x(10).
   285     05  sql-pb-lfpremium-n redefines
   286         sql-pb-lfpremium        pic 9(7).99.
   287     05  sql-pb-AhBenCode        pic xx.
   288     05  sql-pb-AhTerm           pic 999.
   289     05  sql-pb-AhBenefit        pic x(10).
   290     05  sql-pb-ahbenefit-n redefines
   291         sql-pb-ahbenefit        pic 9(7).99.
   292     05  sql-pb-AhPremium        pic x(10).
   293     05  sql-pb-ahpremium-n redefines
   294         sql-pb-ahpremium        pic 9(7).99.
   295     05  sql-pb-ErrorMessage     pic x(50).
   296 EXEC SQL
   297    END DECLARE SECTION
   298 END-EXEC
   299 01  ws-roll-back-keys.
   300     05  ws-rb-erpyaj-key        pic x(33) value spaces.
   301 01  ws-batch-header-work-area.
   302     05  ws-lf-iss-premium          pic s9(9)v99 comp-3 value +0.
   303     05  ws-ah-iss-premium          pic s9(9)v99 comp-3 value +0.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page   7
* EL202.cbl
   304     05  ws-iss-cnt                 pic s9(3) comp-3 value +0.
   305     05  ws-cnc-cnt                 pic s9(3) comp-3 value +0.
   306     05  ws-highest-seq-no          pic s9(4) comp value +0.
   307 01  FILE-KEYS.
   308     12  ELCNTL-KEY.
   309         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   310         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   311         16 ELCNTL-ACCESS.
   312             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   313             20  FILLER              PIC X       VALUE SPACES.
   314             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   315         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   316 01  ws-init-erpndb-rec          pic x(585) value spaces.
   317 01  ws-init-erpndm              pic x(374) value spaces.
   318 01  f.
   319     05  ws-batch-seq-no         pic s9(4) comp value +0.
   320     05  ws-connect-sw               pic x  value ' '.
   321         88  connected-to-db             value 'Y'.
   322     05  ws-comp-id              pic xxx.
   323     05  ws-comp-cd              pic x.
   324 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   325     88  RESP-NORMAL                    VALUE +0.
   326     88  resp-file-notfnd               value +12.
   327     88  RESP-NOTFND                    VALUE +13.
   328     88  resp-duprec                    value +14.
   329     88  resp-dupkey                    value +15.
   330     88  resp-invreq                    value +16.
   331     88  RESP-NOTOPEN                   VALUE +19.
   332     88  RESP-ENDFILE                   VALUE +20.
   333     88  resp-lengtherr                 value +22.
   334 01  ws-display-response         pic s9(5) value zeros.
   335 01  ws-work-time-a              pic x(6).
   336 01  ws-work-time redefines ws-work-time-a
   337                                 pic 9(6).
   338 01  ws-work-amt-alpha           pic x(11).
   339 01  ws-work-amt-num redefines ws-work-amt-alpha
   340                                 pic 9(9)v99.
   341 01  ws-qry-string               pic x(80) value spaces.
   342 01  ws-qrystr-len               pic s9(8) comp value +60.
   343 01  ws-var-alpha                pic x(10).
   344 01  ws-seq-alpha                pic x(5).
   345 01  ws-seq-no-num redefines ws-seq-alpha
   346                                 pic 9(5).
   347*                                copy ELCFUNDT.
   348*****************************************************************
   349*                                                               *
   350*                            ELCFUNDT.                          *
   351*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   352*                            VMOD=2.001                         *
   353*                                                               *
   354*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   355*                                                               *
   356*****************************************************************
   357
   358
   359 01  FUNCTION-DATE.
   360     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   361     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page   8
* EL202.cbl
   362         10  WS-FN-CCYR            PIC 9(4).
   363         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   364             15  WS-FN-CC          PIC 99.
   365             15  WS-FN-YR          PIC 99.
   366         10  WS-FN-MO              PIC 99.
   367         10  WS-FN-DA              PIC 99.
   368     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   369     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   370     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   371     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   372     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   373         88  WS-BEHIND-GMT                     VALUE '-'.
   374         88  WS-AFTER-GMT                      VALUE '+'.
   375         88  WS-NO-GMT                         VALUE ZERO.
   376     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   377     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   378*                                COPY ELCDATE.
   379******************************************************************
   380*                                                                *
   381*                                                                *
   382*                            ELCDATE.                            *
   383*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   384*                            VMOD=2.003
   385*                                                                *
   386*                                                                *
   387*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   388*                 LENGTH = 200                                   *
   389******************************************************************
   390
   391 01  DATE-CONVERSION-DATA.
   392     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   393     12  DC-OPTION-CODE                PIC X.
   394         88  BIN-TO-GREG                VALUE ' '.
   395         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   396         88  EDIT-GREG-TO-BIN           VALUE '2'.
   397         88  YMD-GREG-TO-BIN            VALUE '3'.
   398         88  MDY-GREG-TO-BIN            VALUE '4'.
   399         88  JULIAN-TO-BIN              VALUE '5'.
   400         88  BIN-PLUS-ELAPSED           VALUE '6'.
   401         88  FIND-CENTURY               VALUE '7'.
   402         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   403         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   404         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   405         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   406         88  JULIAN-TO-BIN-3            VALUE 'C'.
   407         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   408         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   409         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   410         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   411         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   412         88  CHECK-LEAP-YEAR            VALUE 'H'.
   413         88  BIN-3-TO-GREG              VALUE 'I'.
   414         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   415         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   416         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   417         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   418         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   419         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page   9
* EL202.cbl
   420         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   421         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   422         88  THREE-CHARACTER-BIN
   423                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   424         88  GREGORIAN-TO-BIN
   425                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   426         88  BIN-TO-GREGORIAN
   427                  VALUES ' ' '1' 'I' '8' 'G'.
   428         88  JULIAN-TO-BINARY
   429                  VALUES '5' 'C' 'E' 'F'.
   430     12  DC-ERROR-CODE                 PIC X.
   431         88  NO-CONVERSION-ERROR        VALUE ' '.
   432         88  DATE-CONVERSION-ERROR
   433                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   434         88  DATE-IS-ZERO               VALUE '1'.
   435         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   436         88  DATE-IS-INVALID            VALUE '3'.
   437         88  DATE1-GREATER-DATE2        VALUE '4'.
   438         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   439         88  DATE-INVALID-OPTION        VALUE '9'.
   440         88  INVALID-CENTURY            VALUE 'A'.
   441         88  ONLY-CENTURY               VALUE 'B'.
   442         88  ONLY-LEAP-YEAR             VALUE 'C'.
   443         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   444     12  DC-END-OF-MONTH               PIC X.
   445         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   446     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   447         88  USE-NORMAL-PROCESS         VALUE ' '.
   448         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   449         88  ADJUST-UP-100-YRS          VALUE '2'.
   450     12  FILLER                        PIC X.
   451     12  DC-CONVERSION-DATES.
   452         16  DC-BIN-DATE-1             PIC XX.
   453         16  DC-BIN-DATE-2             PIC XX.
   454         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   455         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   456                       DC-GREG-DATE-1-EDIT.
   457             20  DC-EDIT1-MONTH        PIC 99.
   458             20  SLASH1-1              PIC X.
   459             20  DC-EDIT1-DAY          PIC 99.
   460             20  SLASH1-2              PIC X.
   461             20  DC-EDIT1-YEAR         PIC 99.
   462         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   463         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   464                     DC-GREG-DATE-2-EDIT.
   465             20  DC-EDIT2-MONTH        PIC 99.
   466             20  SLASH2-1              PIC X.
   467             20  DC-EDIT2-DAY          PIC 99.
   468             20  SLASH2-2              PIC X.
   469             20  DC-EDIT2-YEAR         PIC 99.
   470         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   471         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   472                     DC-GREG-DATE-1-YMD.
   473             20  DC-YMD-YEAR           PIC 99.
   474             20  DC-YMD-MONTH          PIC 99.
   475             20  DC-YMD-DAY            PIC 99.
   476         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   477         16  DC-GREG-DATE-1-MDY-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  10
* EL202.cbl
   478                      DC-GREG-DATE-1-MDY.
   479             20  DC-MDY-MONTH          PIC 99.
   480             20  DC-MDY-DAY            PIC 99.
   481             20  DC-MDY-YEAR           PIC 99.
   482         16  DC-GREG-DATE-1-ALPHA.
   483             20  DC-ALPHA-MONTH        PIC X(10).
   484             20  DC-ALPHA-DAY          PIC 99.
   485             20  FILLER                PIC XX.
   486             20  DC-ALPHA-CENTURY.
   487                 24 DC-ALPHA-CEN-N     PIC 99.
   488             20  DC-ALPHA-YEAR         PIC 99.
   489         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   490         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   491         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   492         16  DC-JULIAN-DATE            PIC 9(05).
   493         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   494                                       PIC 9(05).
   495         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   496             20  DC-JULIAN-YEAR        PIC 99.
   497             20  DC-JULIAN-DAYS        PIC 999.
   498         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   499         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   500         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   501     12  DATE-CONVERSION-VARIBLES.
   502         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   503         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   504             20  FILLER                PIC 9(3).
   505             20  HOLD-CEN-1-CCYY.
   506                 24  HOLD-CEN-1-CC     PIC 99.
   507                 24  HOLD-CEN-1-YY     PIC 99.
   508             20  HOLD-CEN-1-MO         PIC 99.
   509             20  HOLD-CEN-1-DA         PIC 99.
   510         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   511             20  HOLD-CEN-1-R-MO       PIC 99.
   512             20  HOLD-CEN-1-R-DA       PIC 99.
   513             20  HOLD-CEN-1-R-CCYY.
   514                 24  HOLD-CEN-1-R-CC   PIC 99.
   515                 24  HOLD-CEN-1-R-YY   PIC 99.
   516             20  FILLER                PIC 9(3).
   517         16  HOLD-CENTURY-1-X.
   518             20  FILLER                PIC X(3)  VALUE SPACES.
   519             20  HOLD-CEN-1-X-CCYY.
   520                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   521                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   522             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   523             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   524         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   525             20  HOLD-CEN-1-R-X-MO     PIC XX.
   526             20  HOLD-CEN-1-R-X-DA     PIC XX.
   527             20  HOLD-CEN-1-R-X-CCYY.
   528                 24  HOLD-CEN-1-R-X-CC PIC XX.
   529                 24  HOLD-CEN-1-R-X-YY PIC XX.
   530             20  FILLER                PIC XXX.
   531         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   532         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   533         16  DC-JULIAN-DATE-1          PIC 9(07).
   534         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   535             20  DC-JULIAN-1-CCYY.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  11
* EL202.cbl
   536                 24  DC-JULIAN-1-CC    PIC 99.
   537                 24  DC-JULIAN-1-YR    PIC 99.
   538             20  DC-JULIAN-DA-1        PIC 999.
   539         16  DC-JULIAN-DATE-2          PIC 9(07).
   540         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   541             20  DC-JULIAN-2-CCYY.
   542                 24  DC-JULIAN-2-CC    PIC 99.
   543                 24  DC-JULIAN-2-YR    PIC 99.
   544             20  DC-JULIAN-DA-2        PIC 999.
   545         16  DC-GREG-DATE-A-EDIT.
   546             20  DC-EDITA-MONTH        PIC 99.
   547             20  SLASHA-1              PIC X VALUE '/'.
   548             20  DC-EDITA-DAY          PIC 99.
   549             20  SLASHA-2              PIC X VALUE '/'.
   550             20  DC-EDITA-CCYY.
   551                 24  DC-EDITA-CENT     PIC 99.
   552                 24  DC-EDITA-YEAR     PIC 99.
   553         16  DC-GREG-DATE-B-EDIT.
   554             20  DC-EDITB-MONTH        PIC 99.
   555             20  SLASHB-1              PIC X VALUE '/'.
   556             20  DC-EDITB-DAY          PIC 99.
   557             20  SLASHB-2              PIC X VALUE '/'.
   558             20  DC-EDITB-CCYY.
   559                 24  DC-EDITB-CENT     PIC 99.
   560                 24  DC-EDITB-YEAR     PIC 99.
   561         16  DC-GREG-DATE-CYMD         PIC 9(08).
   562         16  DC-GREG-DATE-CYMD-R REDEFINES
   563                              DC-GREG-DATE-CYMD.
   564             20  DC-CYMD-CEN           PIC 99.
   565             20  DC-CYMD-YEAR          PIC 99.
   566             20  DC-CYMD-MONTH         PIC 99.
   567             20  DC-CYMD-DAY           PIC 99.
   568         16  DC-GREG-DATE-MDCY         PIC 9(08).
   569         16  DC-GREG-DATE-MDCY-R REDEFINES
   570                              DC-GREG-DATE-MDCY.
   571             20  DC-MDCY-MONTH         PIC 99.
   572             20  DC-MDCY-DAY           PIC 99.
   573             20  DC-MDCY-CEN           PIC 99.
   574             20  DC-MDCY-YEAR          PIC 99.
   575    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   576        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   577    12  DC-EL310-DATE                  PIC X(21).
   578    12  FILLER                         PIC X(28).
   579*                                COPY ELCCNTL.
   580******************************************************************
   581*                                                                *
   582*                                                                *
   583*                            ELCCNTL.                            *
   584*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   585*                            VMOD=2.059                          *
   586*                                                                *
   587*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   588*                                                                *
   589*   FILE TYPE = VSAM,KSDS                                        *
   590*   RECORD SIZE = 750  RECFORM = FIXED                           *
   591*                                                                *
   592*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   593*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  12
* EL202.cbl
   594*                                                                *
   595*   LOG = YES                                                    *
   596*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   597******************************************************************
   598*                   C H A N G E   L O G
   599*
   600* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   601*-----------------------------------------------------------------
   602*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   603* EFFECTIVE    NUMBER
   604*-----------------------------------------------------------------
   605* 082503                   PEMA  ADD BENEFIT GROUP
   606* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   607* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   608* 092705    2005050300006  PEMA  ADD SPP LEASES
   609* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   610* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
   611* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   612* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   613* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   614* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   615* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
   616* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
   617* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
   618* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   619******************************************************************
   620*
   621 01  CONTROL-FILE.
   622     12  CF-RECORD-ID                       PIC XX.
   623         88  VALID-CF-ID                        VALUE 'CF'.
   624
   625     12  CF-CONTROL-PRIMARY.
   626         16  CF-COMPANY-ID                  PIC XXX.
   627         16  CF-RECORD-TYPE                 PIC X.
   628             88  CF-COMPANY-MASTER              VALUE '1'.
   629             88  CF-PROCESSOR-MASTER            VALUE '2'.
   630             88  CF-STATE-MASTER                VALUE '3'.
   631             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   632             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   633             88  CF-CARRIER-MASTER              VALUE '6'.
   634             88  CF-MORTALITY-MASTER            VALUE '7'.
   635             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   636             88  CF-TERMINAL-MASTER             VALUE '9'.
   637             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   638             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   639             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   640             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   641             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   642             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   643             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   644             88  CF-REMINDERS-MASTER            VALUE 'R'.
   645             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   646         16  CF-ACCESS-CD-GENL              PIC X(4).
   647         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   648             20  CF-PROCESSOR               PIC X(4).
   649         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   650             20  CF-STATE-CODE              PIC XX.
   651             20  FILLER                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  13
* EL202.cbl
   652         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   653             20  FILLER                     PIC XX.
   654             20  CF-HI-BEN-IN-REC           PIC XX.
   655         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   656             20  FILLER                     PIC XXX.
   657             20  CF-CARRIER-CNTL            PIC X.
   658         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   659             20  FILLER                     PIC XX.
   660             20  CF-HI-TYPE-IN-REC          PIC 99.
   661         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   662             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   663                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   664             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   665             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   666         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   667             20  FILLER                     PIC X.
   668             20  CF-CUSTOM-REPORT-NO        PIC 999.
   669         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   670             20  FILLER                     PIC XX.
   671             20  CF-MORTGAGE-PLAN           PIC XX.
   672         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   673
   674     12  CF-LAST-MAINT-DT                   PIC XX.
   675     12  CF-LAST-MAINT-BY                   PIC X(4).
   676     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   677
   678     12  CF-RECORD-BODY                     PIC X(728).
   679
   680
   681****************************************************************
   682*             COMPANY MASTER RECORD                            *
   683****************************************************************
   684
   685     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   686         16  CF-COMPANY-ADDRESS.
   687             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   688             20  CF-CL-IN-CARE-OF           PIC X(30).
   689             20  CF-CL-ADDR-LINE-1          PIC X(30).
   690             20  CF-CL-ADDR-LINE-2          PIC X(30).
   691             20  CF-CL-CITY-STATE           PIC X(30).
   692             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   693             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   694         16  CF-COMPANY-CD                  PIC X.
   695         16  CF-COMPANY-PASSWORD            PIC X(8).
   696         16  CF-SECURITY-OPTION             PIC X.
   697             88  ALL-SECURITY                   VALUE '1'.
   698             88  COMPANY-VERIFY                 VALUE '2'.
   699             88  PROCESSOR-VERIFY               VALUE '3'.
   700             88  NO-SECURITY                    VALUE '4'.
   701             88  ALL-BUT-TERM                   VALUE '5'.
   702         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   703             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   704         16  CF-LGX-INTERFACE-CNTL          PIC X.
   705             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   706         16  CF-INFORCE-LOCATION            PIC X.
   707             88  CERTS-ARE-ONLINE               VALUE '1'.
   708             88  CERTS-ARE-OFFLINE              VALUE '2'.
   709             88  NO-CERTS-AVAILABLE             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  14
* EL202.cbl
   710         16  CF-LOWER-CASE-LETTERS          PIC X.
   711         16  CF-CERT-ACCESS-CONTROL         PIC X.
   712             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   713             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   714             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   715             88  CF-ACCNT-CNTL                  VALUE '3'.
   716             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   717
   718         16  CF-FORMS-PRINTER-ID            PIC X(4).
   719         16  CF-CHECK-PRINTER-ID            PIC X(4).
   720
   721         16  CF-LGX-CREDIT-USER             PIC X.
   722             88  CO-IS-NOT-USER                 VALUE 'N'.
   723             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   724
   725         16 CF-CREDIT-CALC-CODES.
   726             20  CF-CR-REM-TERM-CALC PIC X.
   727               88  CR-EARN-AFTER-15TH           VALUE '1'.
   728               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   729               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   730               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   731               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
   732               88  CR-EARN-AFTER-14TH           VALUE '6'.
   733               88  CR-EARN-AFTER-16TH           VALUE '7'.
   734             20  CF-CR-R78-METHOD           PIC X.
   735               88  USE-TERM-PLUS-ONE            VALUE SPACE.
   736               88  DONT-USE-PLUS-ONE            VALUE '1'.
   737
   738         16  CF-CLAIM-CONTROL-COUNTS.
   739             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
   740                 88  CO-CLM-COUNT-RESET         VALUE +99999.
   741
   742             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
   743                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
   744
   745             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
   746                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
   747
   748             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
   749                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
   750
   751         16  CF-CURRENT-MONTH-END           PIC XX.
   752
   753         16  CF-CO-CALC-QUOTE-TOLERANCE.
   754             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
   755             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
   756             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
   757             20  CF-CO-CLAIM-REJECT-SW      PIC X.
   758                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
   759                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
   760             20  CF-CO-PREM-REJECT-SW       PIC X.
   761                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
   762                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
   763             20  CF-CO-REF-REJECT-SW        PIC X.
   764                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
   765                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
   766
   767         16  CF-CO-REPORTING-DT             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  15
* EL202.cbl
   768         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
   769         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
   770           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
   771           88  CF-CO-MONTH-END                  VALUE '1'.
   772
   773         16  CF-LGX-CLAIM-USER              PIC X.
   774             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
   775             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
   776
   777         16  CF-CREDIT-EDIT-CONTROLS.
   778             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
   779             20  CF-MIN-AGE                 PIC 99.
   780             20  CF-DEFAULT-AGE             PIC 99.
   781             20  CF-MIN-TERM                PIC S999      COMP-3.
   782             20  CF-MAX-TERM                PIC S999      COMP-3.
   783             20  CF-DEFAULT-SEX             PIC X.
   784             20  CF-JOINT-AGE-INPUT         PIC X.
   785                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
   786             20  CF-BIRTH-DATE-INPUT        PIC X.
   787                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
   788             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
   789                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
   790                 88  CF-ZERO-CARRIER            VALUE '1'.
   791                 88  CF-ZERO-GROUPING           VALUE '2'.
   792                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
   793             20  CF-EDIT-SW                 PIC X.
   794                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
   795             20  CF-EDIT-RESTART-BATCH      PIC X(6).
   796             20  CF-CR-PR-METHOD            PIC X.
   797               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
   798               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
   799             20  FILLER                     PIC X.
   800
   801         16  CF-CREDIT-MISC-CONTROLS.
   802             20  CF-REIN-TABLE-SW           PIC X.
   803                 88 REIN-TABLES-ARE-USED        VALUE '1'.
   804             20  CF-COMP-TABLE-SW           PIC X.
   805                 88 COMP-TABLES-ARE-USED        VALUE '1'.
   806             20  CF-EXPERIENCE-RETENTION-AGE
   807                                            PIC S9        COMP-3.
   808             20  CF-CONVERSION-DT           PIC XX.
   809             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
   810             20  CF-RUN-FREQUENCY-SW        PIC X.
   811                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
   812                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
   813
   814             20  CF-CR-CHECK-NO-CONTROL.
   815                 24  CF-CR-CHECK-NO-METHOD    PIC X.
   816                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
   817                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
   818                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
   819                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
   820                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
   821
   822                 24  CF-CR-CHECK-COUNT       REDEFINES
   823                     CF-CR-CHECK-COUNTER      PIC X(4).
   824
   825                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  16
* EL202.cbl
   826                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
   827
   828                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
   829                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
   830                 24  CF-MAIL-PROCESSING       PIC X.
   831                     88  MAIL-PROCESSING          VALUE 'Y'.
   832
   833         16  CF-MISC-SYSTEM-CONTROL.
   834             20  CF-SYSTEM-C                 PIC X.
   835                 88  CONFIRMATION-SYS-USED       VALUE '1'.
   836             20  CF-SYSTEM-D                 PIC X.
   837                 88  DAILY-BILL-SYS-USED         VALUE '1'.
   838             20  CF-SOC-SEC-NO-SW            PIC X.
   839                 88  SOC-SEC-NO-USED             VALUE '1'.
   840             20  CF-MEMBER-NO-SW             PIC X.
   841                 88  MEMBER-NO-USED              VALUE '1'.
   842             20  CF-TAX-ID-NUMBER            PIC X(11).
   843             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
   844             20  CF-PAYMENT-APPROVAL-SW      PIC X.
   845                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
   846                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
   847                 88  CF-ALL-APPROVED             VALUE 'Y'.
   848                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
   849             20  CF-SYSTEM-E                 PIC X.
   850                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
   851
   852         16  CF-LGX-LIFE-USER               PIC X.
   853             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
   854             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
   855
   856         16  CF-CR-MONTH-END-DT             PIC XX.
   857
   858         16  CF-FILE-MAINT-DATES.
   859             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
   860                 88  CF-LAST-BATCH-RESET        VALUE +999999.
   861             20  CF-LAST-BATCH       REDEFINES
   862                 CF-LAST-BATCH-NO               PIC X(4).
   863             20  CF-RATES-FILE-MAINT-DT         PIC XX.
   864             20  CF-RATES-FILE-CREATE-DT        PIC XX.
   865             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
   866             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
   867             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
   868             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
   869             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
   870             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
   871             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
   872             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
   873
   874         16  CF-NEXT-COMPANY-ID             PIC XXX.
   875         16  FILLER                         PIC X.
   876
   877         16  CF-ALT-MORT-CODE               PIC X(4).
   878         16  CF-MEMBER-CAPTION              PIC X(10).
   879
   880         16  CF-LIFE-ACCESS-CONTROL         PIC X.
   881             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
   882             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
   883             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  17
* EL202.cbl
   884             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
   885             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
   886
   887         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
   888
   889         16  CF-LIFE-OVERRIDE-L1            PIC X.
   890         16  CF-LIFE-OVERRIDE-L2            PIC XX.
   891         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
   892         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
   893
   894         16  CF-AH-OVERRIDE-L1              PIC X.
   895         16  CF-AH-OVERRIDE-L2              PIC XX.
   896         16  CF-AH-OVERRIDE-L6              PIC X(6).
   897         16  CF-AH-OVERRIDE-L12             PIC X(12).
   898
   899         16  CF-REPORT-CD1-CAPTION          PIC X(10).
   900         16  CF-REPORT-CD2-CAPTION          PIC X(10).
   901
   902         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
   903         16  CF-AR-LAST-EL860-DT            PIC XX.
   904         16  CF-MP-MONTH-END-DT             PIC XX.
   905
   906         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
   907         16  CF-CLAIM-PAID-THRU-TO          PIC X.
   908             88  CF-CLAIM-PAID-TO               VALUE '1'.
   909
   910         16  CF-AR-MONTH-END-DT             PIC XX.
   911
   912         16  CF-CRDTCRD-USER                PIC X.
   913             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
   914             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
   915
   916         16  CF-CC-MONTH-END-DT             PIC XX.
   917
   918         16  CF-PRINT-ADDRESS-LABELS        PIC X.
   919
   920         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
   921             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
   922             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
   923             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
   924         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
   925         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
   926         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
   927         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
   928             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
   929             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
   930         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
   931         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
   932         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
   933             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
   934         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
   935
   936         16  CF-CL-ZIP-CODE.
   937             20  CF-CL-ZIP-PRIME.
   938                 24  CF-CL-ZIP-1ST          PIC X.
   939                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
   940                 24  FILLER                 PIC X(4).
   941             20  CF-CL-ZIP-PLUS4            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  18
* EL202.cbl
   942         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
   943             20  CF-CL-CAN-POSTAL-1         PIC XXX.
   944             20  CF-CL-CAN-POSTAL-2         PIC XXX.
   945             20  FILLER                     PIC XXX.
   946
   947         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
   948         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
   949         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
   950         16  CF-CO-OPTION-START-DATE        PIC XX.
   951         16  CF-REM-TRM-CALC-OPTION         PIC X.
   952           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
   953                                                      '3' '4'.
   954           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
   955           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
   956           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
   957           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
   958           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
   959           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
   960
   961         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
   962
   963         16  CF-PAYMENT-APPROVAL-LEVELS.
   964             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
   965             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
   966             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
   967             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
   968             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
   969             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
   970
   971         16  CF-END-USER-REPORTING-USER     PIC X.
   972             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
   973             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
   974
   975         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
   976             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
   977             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
   978
   979         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
   980
   981         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
   982         16  FILLER                         PIC X.
   983
   984         16  CF-CREDIT-ARCHIVE-CNTL.
   985             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
   986             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
   987             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
   988
   989         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
   990
   991         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
   992             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
   993             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
   994
   995         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
   996             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
   997             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
   998
   999         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  19
* EL202.cbl
  1000
  1001         16  CF-CO-ACH-ID-CODE              PIC  X.
  1002             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1003             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1004             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1005         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1006         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1007         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1008         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1009         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1010         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1011         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1012         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1013         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1014                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1015         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1016                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1017
  1018         16  CF-CO-OVER-SHORT.
  1019             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1020             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1021
  1022*         16  FILLER                         PIC X(102).
  1023         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1024             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1025             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1026
  1027         16  CF-AH-APPROVAL-DAYS.
  1028             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1029             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1030             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1031             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1032
  1033         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1034
  1035         16  CF-APPROV-LEV-5.
  1036             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1037             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1038             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1039
  1040         16  FILLER                         PIC X(68).
  1041****************************************************************
  1042*             PROCESSOR/USER RECORD                            *
  1043****************************************************************
  1044
  1045     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1046         16  CF-PROCESSOR-NAME              PIC X(30).
  1047         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1048         16  CF-PROCESSOR-TITLE             PIC X(26).
  1049         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1050                 88  MESSAGE-YES                VALUE 'Y'.
  1051                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1052
  1053*****************************************************
  1054****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1055****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1056****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1057****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  20
* EL202.cbl
  1058*****************************************************
  1059
  1060         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1061             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1062             20  CF-APPLICATION-FORCE       PIC X.
  1063             20  CF-INDIVIDUAL-APP.
  1064                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1065                     28  CF-BROWSE-APP      PIC X.
  1066                     28  CF-UPDATE-APP      PIC X.
  1067
  1068         16  CF-CURRENT-TERM-ON             PIC X(4).
  1069         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1070             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1071             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1072             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1073             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1074             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1075             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1076             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1077         16  CF-PROCESSOR-CARRIER           PIC X.
  1078             88  NO-CARRIER-SECURITY            VALUE ' '.
  1079         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1080             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1081         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1082             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1083         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1084             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1085
  1086         16  CF-PROC-SYS-ACCESS-SW.
  1087             20  CF-PROC-CREDIT-CLAIMS-SW.
  1088                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1089                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1090                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1091                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1092             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1093                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1094                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1095             20  CF-PROC-LIFE-GNRLDGR-SW.
  1096                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1097                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1098                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1099                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1100             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1101                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1102                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1103         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1104             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1105             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1106         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1107
  1108         16  CF-APPROVAL-LEVEL                  PIC X.
  1109             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1110             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1111             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1112             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1113             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1114
  1115         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  21
* EL202.cbl
  1116
  1117         16  CF-LANGUAGE-TYPE                   PIC X.
  1118             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1119             88  CF-LANG-IS-FR                      VALUE 'F'.
  1120
  1121         16  CF-CSR-IND                         PIC X.
  1122         16  FILLER                             PIC X(239).
  1123
  1124****************************************************************
  1125*             PROCESSOR/REMINDERS RECORD                       *
  1126****************************************************************
  1127
  1128     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1129         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1130             20  CF-START-REMIND-DT         PIC XX.
  1131             20  CF-END-REMIND-DT           PIC XX.
  1132             20  CF-REMINDER-TEXT           PIC X(50).
  1133         16  FILLER                         PIC X(296).
  1134
  1135
  1136****************************************************************
  1137*             STATE MASTER RECORD                              *
  1138****************************************************************
  1139
  1140     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1141         16  CF-STATE-ABBREVIATION          PIC XX.
  1142         16  CF-STATE-NAME                  PIC X(25).
  1143         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1144         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1145             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1146             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1147             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1148             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1149                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1150                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1151             20  CF-ST-PREM-REJECT-SW       PIC X.
  1152                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1153                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1154             20  CF-ST-REF-REJECT-SW        PIC X.
  1155                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1156                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1157         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1158         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1159         16  CF-ST-REFUND-RULES.
  1160             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1161             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1162             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1163         16  CF-ST-FST-PMT-EXTENSION.
  1164             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1165             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1166                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1167                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1168                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1169                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1170         16  CF-ST-STATE-CALL.
  1171             20  CF-ST-CALL-UNEARNED        PIC X.
  1172             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1173             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  22
* EL202.cbl
  1174         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1175             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1176             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1177         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1178         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1179         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1180         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1181         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1182         16  FILLER                         PIC X.
  1183         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1184             20  CF-ST-BENEFIT-CD           PIC XX.
  1185             20  CF-ST-BENEFIT-KIND         PIC X.
  1186                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1187                 88  CF-ST-AH-KIND              VALUE 'A'.
  1188             20  CF-ST-REM-TERM-CALC        PIC X.
  1189                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1190                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1191                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1192                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1193                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1194                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1195                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1196                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1197
  1198             20  CF-ST-REFUND-CALC          PIC X.
  1199                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1200                 88  ST-REFD-BY-R78             VALUE '1'.
  1201                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1202                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1203                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1204                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1205                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1206                 88  ST-REFD-UTAH               VALUE '7'.
  1207                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1208                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1209                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1210
  1211             20  CF-ST-EARNING-CALC         PIC X.
  1212                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1213                 88  ST-EARN-BY-R78             VALUE '1'.
  1214                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1215                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1216                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1217                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1218                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1219                 88  ST-EARN-MEAN               VALUE '8'.
  1220                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1221
  1222             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1223                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1224                 88  ST-OVRD-BY-R78             VALUE '1'.
  1225                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1226                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1227                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1228                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1229                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1230                 88  ST-OVRD-MEAN               VALUE '8'.
  1231                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  23
* EL202.cbl
  1232             20  cf-st-extra-periods        pic 9.
  1233*            20  FILLER                     PIC X.
  1234
  1235         16  CF-ST-COMMISSION-CAPS.
  1236             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1237             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1238             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1239             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1240         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1241                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1242
  1243         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1244
  1245         16  CF-ST-STATUTORY-INTEREST.
  1246             20  CF-ST-STAT-DATE-FROM       PIC X.
  1247                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1248                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1249             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1250             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1251             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1252             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1253             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1254
  1255         16  CF-ST-OVER-SHORT.
  1256             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1257             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1258
  1259         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1260
  1261         16  CF-ST-RT-CALC                  PIC X.
  1262
  1263         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1264         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1265         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1266         16  CF-ST-RF-LR-CALC               PIC X.
  1267         16  CF-ST-RF-LL-CALC               PIC X.
  1268         16  CF-ST-RF-LN-CALC               PIC X.
  1269         16  CF-ST-RF-AH-CALC               PIC X.
  1270         16  CF-ST-RF-CP-CALC               PIC X.
  1271*        16  FILLER                         PIC X(206).
  1272*CIDMOD         16  FILLER                         PIC X(192).
  1273         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1274             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1275         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1276         16  CF-ST-VFY-2ND-BENE             PIC X.
  1277         16  CF-ST-CAUSAL-STATE             PIC X.
  1278         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  1279         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  1280         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  1281             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  1282         16  CF-ST-NET-ONLY-STATE           PIC X.
  1283             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  1284         16  FILLER                         PIC X(181).
  1285
  1286****************************************************************
  1287*             BENEFIT MASTER RECORD                            *
  1288****************************************************************
  1289
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  24
* EL202.cbl
  1290     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1291         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1292             20  CF-BENEFIT-CODE            PIC XX.
  1293             20  CF-BENEFIT-NUMERIC  REDEFINES
  1294                 CF-BENEFIT-CODE            PIC XX.
  1295             20  CF-BENEFIT-ALPHA           PIC XXX.
  1296             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1297             20  CF-BENEFIT-COMMENT         PIC X(10).
  1298
  1299             20  CF-LF-COVERAGE-TYPE        PIC X.
  1300                 88  CF-REDUCING                VALUE 'R'.
  1301                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1302
  1303             20  CF-SPECIAL-CALC-CD         PIC X.
  1304                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1305                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1306                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1307                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1308                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1309                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1310                 88  CF-FARM-PLAN               VALUE 'F'.
  1311                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1312                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1313                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1314                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1315                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1316                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1317                 88  CF-PRUDENTIAL              VALUE 'P'.
  1318                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1319                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1320                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1321                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1322                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1323                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1324
  1325             20  CF-JOINT-INDICATOR         PIC X.
  1326                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1327
  1328*            20  FILLER                     PIC X(12).
  1329             20  cf-maximum-benefits        pic s999 comp-3.
  1330             20  FILLER                     PIC X(09).
  1331             20  CF-BENEFIT-CATEGORY        PIC X.
  1332             20  CF-LOAN-TYPE               PIC X(8).
  1333
  1334             20  CF-CO-REM-TERM-CALC        PIC X.
  1335                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1336                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1337                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1338                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1339                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1340
  1341             20  CF-CO-EARNINGS-CALC        PIC X.
  1342                 88  CO-EARN-BY-R78             VALUE '1'.
  1343                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1344                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1345                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1346                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1347                 88  CO-EARN-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  25
* EL202.cbl
  1348                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1349                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1350
  1351             20  CF-CO-REFUND-CALC          PIC X.
  1352                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1353                 88  CO-REFD-BY-R78             VALUE '1'.
  1354                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1355                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1356                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1357                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1358                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1359                 88  CO-REFD-MEAN               VALUE '8'.
  1360                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1361                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1362                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1363
  1364             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1365                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1366                 88  CO-OVRD-BY-R78             VALUE '1'.
  1367                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1368                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1369                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1370                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1371                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1372                 88  CO-OVRD-MEAN               VALUE '8'.
  1373                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1374
  1375             20  CF-CO-BEN-I-G-CD           PIC X.
  1376                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1377                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1378                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1379
  1380         16  FILLER                         PIC X(304).
  1381
  1382
  1383****************************************************************
  1384*             CARRIER MASTER RECORD                            *
  1385****************************************************************
  1386
  1387     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1388         16  CF-ADDRESS-DATA.
  1389             20  CF-MAIL-TO-NAME            PIC X(30).
  1390             20  CF-IN-CARE-OF              PIC X(30).
  1391             20  CF-ADDRESS-LINE-1          PIC X(30).
  1392             20  CF-ADDRESS-LINE-2          PIC X(30).
  1393             20  CF-CITY-STATE              PIC X(30).
  1394             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1395             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1396
  1397         16  CF-CLAIM-NO-CONTROL.
  1398             20  CF-CLAIM-NO-METHOD         PIC X.
  1399                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1400                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1401                 88  CLAIM-NO-SEQ               VALUE '3'.
  1402                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1403             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1404                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1405                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  26
* EL202.cbl
  1406                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1407
  1408         16  CF-CHECK-NO-CONTROL.
  1409             20  CF-CHECK-NO-METHOD         PIC X.
  1410                 88  CHECK-NO-MANUAL            VALUE '1'.
  1411                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1412                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1413                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1414             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1415                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1416
  1417         16  CF-DOMICILE-STATE              PIC XX.
  1418
  1419         16  CF-EXPENSE-CONTROLS.
  1420             20  CF-EXPENSE-METHOD          PIC X.
  1421                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1422                 88  DOLLARS-PER-PMT            VALUE '2'.
  1423                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1424                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1425             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1426             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1427
  1428         16  CF-CORRESPONDENCE-CONTROL.
  1429             20  CF-LETTER-RESEND-OPT       PIC X.
  1430                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1431                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1432             20  FILLER                     PIC X(4).
  1433
  1434         16  CF-RESERVE-CONTROLS.
  1435             20  CF-MANUAL-SW               PIC X.
  1436                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1437             20  CF-FUTURE-SW               PIC X.
  1438                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1439             20  CF-PTC-SW                  PIC X.
  1440                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1441             20  CF-IBNR-SW                 PIC X.
  1442                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1443             20  CF-PTC-LF-SW               PIC X.
  1444                 88  CF-LF-PTC-USED             VALUE '1'.
  1445             20  CF-CDT-ACCESS-METHOD       PIC X.
  1446                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1447                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1448                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1449             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1450
  1451         16  CF-CLAIM-CALC-METHOD           PIC X.
  1452             88  360-PLUS-MONTHS                VALUE '1'.
  1453             88  365-PLUS-MONTHS                VALUE '2'.
  1454             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1455             88  360-DAILY                      VALUE '4'.
  1456             88  365-DAILY                      VALUE '5'.
  1457
  1458         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1459         16  FILLER                         PIC X(11).
  1460
  1461         16  CF-LIMIT-AMOUNTS.
  1462             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1463             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  27
* EL202.cbl
  1464             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1465             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1466             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1467             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1468             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1469             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1470             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1471             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1472
  1473         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1474         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1475         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1476
  1477         16  CF-ZIP-CODE.
  1478             20  CF-ZIP-PRIME.
  1479                 24  CF-ZIP-1ST             PIC X.
  1480                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1481                 24  FILLER                 PIC X(4).
  1482             20  CF-ZIP-PLUS4               PIC X(4).
  1483         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1484             20  CF-CAN-POSTAL-1            PIC XXX.
  1485             20  CF-CAN-POSTAL-2            PIC XXX.
  1486             20  FILLER                     PIC XXX.
  1487
  1488         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1489         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1490         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1491
  1492         16  CF-RATING-SWITCH               PIC X.
  1493             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1494             88  CF-NO-RATING                   VALUE 'N'.
  1495
  1496         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1497
  1498         16  CF-CARRIER-OVER-SHORT.
  1499             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1500             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1501
  1502         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1503         16  CF-SECPAY-SWITCH               PIC X.
  1504             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  1505             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1506         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1507         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  1508         16  FILLER                         PIC X(444).
  1509*        16  FILLER                         PIC X(452).
  1510
  1511
  1512****************************************************************
  1513*             MORTALITY MASTER RECORD                          *
  1514****************************************************************
  1515
  1516     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1517         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1518                                INDEXED BY CF-MORT-NDX.
  1519             20  CF-MORT-TABLE              PIC X(5).
  1520             20  CF-MORT-TABLE-TYPE         PIC X.
  1521                 88  CF-MORT-JOINT              VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  28
* EL202.cbl
  1522                 88  CF-MORT-SINGLE             VALUE 'S'.
  1523                 88  CF-MORT-COMBINED           VALUE 'C'.
  1524                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1525                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1526             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1527             20  CF-MORT-AGE-METHOD         PIC XX.
  1528                 88  CF-AGE-LAST                VALUE 'AL'.
  1529                 88  CF-AGE-NEAR                VALUE 'AN'.
  1530             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1531             20  CF-MORT-ADJUSTMENT-DIRECTION
  1532                                            PIC X.
  1533                 88  CF-MINUS                   VALUE '-'.
  1534                 88  CF-PLUS                    VALUE '+'.
  1535             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1536             20  CF-MORT-JOINT-CODE         PIC X.
  1537                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1538             20  CF-MORT-PC-Q               PIC X.
  1539                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1540             20  CF-MORT-TABLE-CODE         PIC X(4).
  1541             20  CF-MORT-COMMENTS           PIC X(15).
  1542             20  FILLER                     PIC X(14).
  1543
  1544         16  FILLER                         PIC X(251).
  1545
  1546
  1547****************************************************************
  1548*             BUSSINESS TYPE MASTER RECORD                     *
  1549****************************************************************
  1550
  1551     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1552* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1553* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1554* AND RECORD 05 IS TYPES 81-99
  1555         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1556             20  CF-BUSINESS-TITLE          PIC  X(19).
  1557             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1558                                            PIC S9V9(4) COMP-3.
  1559             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1560             20  FILLER                     PIC  X.
  1561         16  FILLER                         PIC  X(248).
  1562
  1563
  1564****************************************************************
  1565*             TERMINAL MASTER RECORD                           *
  1566****************************************************************
  1567
  1568     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1569
  1570         16  CF-COMPANY-TERMINALS.
  1571             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1572                                  PIC X(4).
  1573         16  FILLER               PIC X(248).
  1574
  1575
  1576****************************************************************
  1577*             LIFE EDIT MASTER RECORD                          *
  1578****************************************************************
  1579
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  29
* EL202.cbl
  1580     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1581         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1582             20  CF-LIFE-CODE-IN            PIC XX.
  1583             20  CF-LIFE-CODE-OUT           PIC XX.
  1584         16  FILLER                         PIC X(248).
  1585
  1586
  1587****************************************************************
  1588*             AH EDIT MASTER RECORD                            *
  1589****************************************************************
  1590
  1591     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1592         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1593             20  CF-AH-CODE-IN              PIC XXX.
  1594             20  CF-AH-CODE-OUT             PIC XX.
  1595         16  FILLER                         PIC X(248).
  1596
  1597
  1598****************************************************************
  1599*             CREDIBILITY TABLES                               *
  1600****************************************************************
  1601
  1602     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1603         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1604                             INDEXED BY CF-CRDB-NDX.
  1605             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1606             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1607             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1608         16  FILLER                         PIC  X(332).
  1609
  1610
  1611****************************************************************
  1612*             REPORT CUSTOMIZATION RECORD                      *
  1613****************************************************************
  1614
  1615     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1616         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1617             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1618             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1619             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1620**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1621****       A T-TRANSFER.                                   ****
  1622             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1623
  1624         16  FILLER                         PIC XX.
  1625
  1626         16  CF-CARRIER-CNTL-OPT.
  1627             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1628                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1629                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1630             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1631                                            PIC X.
  1632         16  CF-GROUP-CNTL-OPT.
  1633             20  CF-GROUP-OPT-SEQ           PIC 9.
  1634                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1635                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1636             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1637                                            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  30
* EL202.cbl
  1638         16  CF-STATE-CNTL-OPT.
  1639             20  CF-STATE-OPT-SEQ           PIC 9.
  1640                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1641                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1642             20  CF-STATE-SELECT OCCURS 3 TIMES
  1643                                            PIC XX.
  1644         16  CF-ACCOUNT-CNTL-OPT.
  1645             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1646                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1647                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1648             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1649                                            PIC X(10).
  1650         16  CF-BUS-TYP-CNTL-OPT.
  1651             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1652                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1653                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1654             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1655                                            PIC XX.
  1656         16  CF-LF-TYP-CNTL-OPT.
  1657             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1658                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1659                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1660             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1661                                            PIC XX.
  1662         16  CF-AH-TYP-CNTL-OPT.
  1663             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1664                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1665                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1666             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1667                                            PIC XX.
  1668         16  CF-REPTCD1-CNTL-OPT.
  1669             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1670                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1671                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1672             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1673                                            PIC X(10).
  1674         16  CF-REPTCD2-CNTL-OPT.
  1675             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1676                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1677                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1678             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1679                                            PIC X(10).
  1680         16  CF-USER1-CNTL-OPT.
  1681             20  CF-USER1-OPT-SEQ           PIC 9.
  1682                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1683                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1684             20  CF-USER1-SELECT OCCURS 3 TIMES
  1685                                            PIC X(10).
  1686         16  CF-USER2-CNTL-OPT.
  1687             20  CF-USER2-OPT-SEQ           PIC 9.
  1688                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1689                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1690             20  CF-USER2-SELECT OCCURS 3 TIMES
  1691                                            PIC X(10).
  1692         16  CF-USER3-CNTL-OPT.
  1693             20  CF-USER3-OPT-SEQ           PIC 9.
  1694                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1695                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  31
* EL202.cbl
  1696             20  CF-USER3-SELECT OCCURS 3 TIMES
  1697                                            PIC X(10).
  1698         16  CF-USER4-CNTL-OPT.
  1699             20  CF-USER4-OPT-SEQ           PIC 9.
  1700                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1701                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1702             20  CF-USER4-SELECT OCCURS 3 TIMES
  1703                                            PIC X(10).
  1704         16  CF-USER5-CNTL-OPT.
  1705             20  CF-USER5-OPT-SEQ           PIC 9.
  1706                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1707                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1708             20  CF-USER5-SELECT OCCURS 3 TIMES
  1709                                            PIC X(10).
  1710         16  CF-REINS-CNTL-OPT.
  1711             20  CF-REINS-OPT-SEQ           PIC 9.
  1712                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1713                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1714             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1715                 24  CF-REINS-PRIME         PIC XXX.
  1716                 24  CF-REINS-SUB           PIC XXX.
  1717
  1718         16  CF-AGENT-CNTL-OPT.
  1719             20  CF-AGENT-OPT-SEQ           PIC 9.
  1720                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1721                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1722             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1723                                            PIC X(10).
  1724
  1725         16  FILLER                         PIC X(43).
  1726
  1727         16  CF-LOSS-RATIO-SELECT.
  1728             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1729             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1730         16  CF-ENTRY-DATE-SELECT.
  1731             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1732             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1733         16  CF-EFFECTIVE-DATE-SELECT.
  1734             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1735             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1736
  1737         16  CF-EXCEPTION-LIST-IND          PIC X.
  1738             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1739
  1740         16  FILLER                         PIC X(318).
  1741
  1742****************************************************************
  1743*                  EXCEPTION REPORTING RECORD                  *
  1744****************************************************************
  1745
  1746     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1747         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1748             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1749
  1750         16  CF-COMBINED-LIFE-AH-OPT.
  1751             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  1752             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  1753             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  32
* EL202.cbl
  1754             20  CF-CANCELLATION-RATIO      PIC S9(02).
  1755
  1756         16  CF-LIFE-OPT.
  1757             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1758             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1759             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1760             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1761             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1762             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1763             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1764             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1765             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1766             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  1767
  1768         16  CF-AH-OPT.
  1769             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  1770             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  1771             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  1772             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  1773             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  1774             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  1775             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  1776             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  1777             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  1778             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  1779
  1780         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  1781             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  1782             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  1783             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  1784
  1785         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  1786
  1787         16  FILLER                         PIC X(673).
  1788
  1789
  1790****************************************************************
  1791*             MORTGAGE SYSTEM PLAN RECORD                      *
  1792****************************************************************
  1793
  1794     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  1795         16  CF-PLAN-TYPE                   PIC X.
  1796             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  1797             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  1798             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  1799         16  CF-PLAN-ABBREV                 PIC XXX.
  1800         16  CF-PLAN-DESCRIPT               PIC X(10).
  1801         16  CF-PLAN-NOTES                  PIC X(20).
  1802         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  1803         16  CF-PLAN-UNDERWRITING.
  1804             20  CF-PLAN-TERM-DATA.
  1805                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  1806                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  1807             20  CF-PLAN-AGE-DATA.
  1808                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  1809                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  1810                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  1811             20  CF-PLAN-BENEFIT-DATA.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  33
* EL202.cbl
  1812                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1813                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  1814                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  1815                                            PIC S9(7)V99  COMP-3.
  1816         16  CF-PLAN-POLICY-FORMS.
  1817             20  CF-POLICY-FORM             PIC X(12).
  1818             20  CF-MASTER-APPLICATION      PIC X(12).
  1819             20  CF-MASTER-POLICY           PIC X(12).
  1820         16  CF-PLAN-RATING.
  1821             20  CF-RATE-CODE               PIC X(5).
  1822             20  CF-SEX-RATING              PIC X.
  1823                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  1824                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  1825             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  1826             20  CF-SUB-STD-TYPE            PIC X.
  1827                 88  CF-PCT-OF-PREM            VALUE '1'.
  1828                 88  CF-PCT-OF-BENE            VALUE '2'.
  1829         16  CF-PLAN-PREM-TOLERANCES.
  1830             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  1831             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  1832         16  CF-PLAN-PYMT-TOLERANCES.
  1833             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  1834             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  1835         16  CF-PLAN-MISC-DATA.
  1836             20  FILLER                     PIC X.
  1837             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  1838             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  1839         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  1840         16  CF-PLAN-IND-GRP                PIC X.
  1841             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  1842                                                     '1'.
  1843             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  1844                                                     '2'.
  1845         16  CF-MIB-SEARCH-SW               PIC X.
  1846             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  1847             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  1848             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  1849             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  1850         16  CF-ALPHA-SEARCH-SW             PIC X.
  1851             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  1852             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  1853             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  1854             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  1855             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  1856             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  1857             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  1858             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  1859             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  1860             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  1861                                                     'A' 'B' 'C'
  1862                                                     'X' 'Y' 'Z'.
  1863         16  CF-EFF-DT-RULE-SW              PIC X.
  1864             88  CF-EFF-DT-ENTER               VALUE 'E'.
  1865             88  CF-EFF-DT-MONTH               VALUE 'M'.
  1866             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  1867             88  CF-EFF-DT-SEMI                VALUE 'S'.
  1868             88  CF-EFF-DT-ANN                 VALUE 'A'.
  1869         16  FILLER                         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  34
* EL202.cbl
  1870         16  CF-HEALTH-QUESTIONS            PIC X.
  1871             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  1872         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  1873         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  1874         16  CF-PLAN-SNGL-JNT               PIC X.
  1875             88  CF-COMBINED-PLAN              VALUE 'C'.
  1876             88  CF-JNT-PLAN                   VALUE 'J'.
  1877             88  CF-SNGL-PLAN                  VALUE 'S'.
  1878         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  1879         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  1880         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  1881         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  1882         16  CF-RERATE-CNTL                 PIC  X.
  1883             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  1884             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  1885             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  1886             88  CF-AUTO-RECALC                 VALUE '4'.
  1887         16  CF-BENEFIT-TYPE                PIC  X.
  1888             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  1889             88  CF-BENEFIT-REDUCES             VALUE '2'.
  1890         16  CF-POLICY-FEE                  PIC S999V99
  1891                                                    COMP-3.
  1892         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  1893         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  1894         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  1895         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  1896         16  FILLER                         PIC  X(32).
  1897         16  CF-TERMINATION-FORM            PIC  X(04).
  1898         16  FILLER                         PIC  X(08).
  1899         16  CF-CLAIM-CAP                   PIC S9(7)V99
  1900                                                       COMP-3.
  1901         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  1902         16  CF-ISSUE-LETTER                PIC  X(4).
  1903         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  1904         16  CF-DEPENDENT-COVERAGE          PIC  X.
  1905             88  CF-YES-DEP-COV                 VALUE 'Y'.
  1906             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  1907         16  CF-MP-REFUND-CALC              PIC X.
  1908             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  1909             88  CF-MP-REFD-BY-R78              VALUE '1'.
  1910             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  1911             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  1912             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  1913             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  1914             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  1915             88  CF-MP-REFD-MEAN                VALUE '8'.
  1916         16  CF-ALT-RATE-CODE               PIC  X(5).
  1917
  1918
  1919         16  FILLER                         PIC X(498).
  1920****************************************************************
  1921*             MORTGAGE COMPANY MASTER RECORD                   *
  1922****************************************************************
  1923
  1924     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1925         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  1926         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  1927             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  35
* EL202.cbl
  1928             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  1929             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  1930             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  1931             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  1932
  1933         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  1934         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  1935         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  1936         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  1937         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  1938
  1939         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  1940             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  1941         16  CF-MP-RECON-USE-IND            PIC X(1).
  1942             88  CF-MP-USE-RECON             VALUE 'Y'.
  1943         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  1944             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  1945         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  1946             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  1947             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  1948         16  FILLER                         PIC X(1).
  1949         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  1950             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  1951         16  CF-MORTG-MIB-VERSION           PIC X.
  1952             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  1953             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  1954             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  1955         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  1956             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  1957                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  1958             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  1959                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  1960             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  1961                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  1962             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  1963                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  1964             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  1965                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  1966             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  1967                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  1968         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  1969         16  FILLER                         PIC X(7).
  1970         16  CF-MORTG-DESTINATION-SYMBOL.
  1971             20  CF-MORTG-MIB-COMM          PIC X(5).
  1972             20  CF-MORTG-MIB-TERM          PIC X(5).
  1973         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  1974             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  1975         16  FILLER                         PIC X(03).
  1976         16  CF-MP-CHECK-NO-CONTROL.
  1977             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  1978                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  1979                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  1980                                                ' ' LOW-VALUES.
  1981                 88  CF-MP-CHECK-NO-PRE-PRINTED
  1982                                               VALUE '3'.
  1983         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  1984         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  1985         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  36
* EL202.cbl
  1986             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  1987                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  1988             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  1989                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  1990             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  1991                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  1992             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  1993                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  1994             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  1995                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  1996             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  1997                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  1998         16  CF-MORTG-BILLING-AREA.
  1999             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2000                                            PIC X.
  2001         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2002         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2003         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2004         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2005             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2006             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2007         16  FILLER                         PIC X.
  2008         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2009             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2010             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2011         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2012         16  FILLER                         PIC X(8).
  2013         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2014         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2015         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2016         16  CF-ACH-COMPANY-ID.
  2017             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2018                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2019                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2020                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2021             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2022         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2023             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2024         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2025             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2026             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2027         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2028         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2029         16  FILLER                         PIC X(536).
  2030
  2031****************************************************************
  2032*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2033****************************************************************
  2034
  2035     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2036         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2037             20  CF-FEMALE-HEIGHT.
  2038                 24  CF-FEMALE-FT           PIC 99.
  2039                 24  CF-FEMALE-IN           PIC 99.
  2040             20  CF-FEMALE-MIN-WT           PIC 999.
  2041             20  CF-FEMALE-MAX-WT           PIC 999.
  2042         16  FILLER                         PIC X(428).
  2043
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  37
* EL202.cbl
  2044     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2045         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2046             20  CF-MALE-HEIGHT.
  2047                 24  CF-MALE-FT             PIC 99.
  2048                 24  CF-MALE-IN             PIC 99.
  2049             20  CF-MALE-MIN-WT             PIC 999.
  2050             20  CF-MALE-MAX-WT             PIC 999.
  2051         16  FILLER                         PIC X(428).
  2052******************************************************************
  2053*             AUTOMATIC ACTIVITY RECORD                          *
  2054******************************************************************
  2055     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2056         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2057             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2058             20  CF-SYS-LETTER-ID           PIC X(04).
  2059             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2060             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2061             20  CF-SYS-RESET-SW            PIC X(01).
  2062             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2063             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2064
  2065         16  FILLER                         PIC X(50).
  2066
  2067         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2068             20  CF-USER-ACTIVE-SW          PIC X(01).
  2069             20  CF-USER-LETTER-ID          PIC X(04).
  2070             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2071             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2072             20  CF-USER-RESET-SW           PIC X(01).
  2073             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2074             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2075             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2076
  2077         16  FILLER                         PIC X(246).
  2078*                                copy ERCPYAJ.
  2079******************************************************************
  2080*                                                                *
  2081*                            ERCPYAJ                             *
  2082*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2083*                            VMOD=2.015                          *
  2084*                                                                *
  2085*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  2086*                                                                *
  2087*                                                                *
  2088*   FILE TYPE = VSAM,KSDS                                        *
  2089*   RECORD SIZE = 200  RECFORM = FIXED                           *
  2090*                                                                *
  2091*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  2092*       ALTERNATE PATHS = NONE                                   *
  2093*                                                                *
  2094*   LOG = YES                                                    *
  2095*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2096******************************************************************
  2097******************************************************************
  2098*                   C H A N G E   L O G
  2099*
  2100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2101*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  38
* EL202.cbl
  2102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2103* EFFECTIVE    NUMBER
  2104*-----------------------------------------------------------------
  2105* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  2106* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  2107******************************************************************
  2108
  2109 01  PENDING-PAY-ADJ.
  2110     12  PY-RECORD-ID                     PIC XX.
  2111         88  VALID-PY-ID                        VALUE 'PY'.
  2112
  2113     12  PY-CONTROL-PRIMARY.
  2114         16  PY-COMPANY-CD                PIC X.
  2115         16  PY-CARRIER                   PIC X.
  2116         16  PY-GROUPING                  PIC X(6).
  2117         16  PY-FIN-RESP                  PIC X(10).
  2118         16  PY-ACCOUNT                   PIC X(10).
  2119         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  2120                                          PIC X(10).
  2121         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  2122         16  PY-RECORD-TYPE               PIC X.
  2123             88  PY-REMIT-RECEIVED            VALUE 'R'.
  2124             88  PY-DEPOSIT                   VALUE 'D'.
  2125             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  2126             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  2127             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  2128             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  2129             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  2130             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  2131             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  2132             88  PY-FICA-ENTRY                VALUE 'F'.
  2133             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  2134             88  PY-POLICY-FEE                VALUE 'W'.
  2135             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  2136
  2137     12  PY-PYMT-TYPE                     PIC X.
  2138             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  2139             88  PY-REINS-PYMT                VALUE 'R'.
  2140             88  PY-EXP-PYMT                  VALUE 'E'.
  2141
  2142     12  PY-BIL-INV                       PIC X(6).
  2143     12  PY-REF-NO                        PIC X(12).
  2144
  2145     12  PY-LAST-MAINT-DT                 PIC XX.
  2146     12  PY-LAST-MAINT-BY                 PIC X(4).
  2147     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2148
  2149     12  PY-PYADJ-RECORD.
  2150         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  2151         16  PY-ENTRY-COMMENT             PIC X(30).
  2152         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  2153             20  PY-GL-ACCOUNT            PIC X(10).
  2154             20  PY-GL-STATE              PIC X(02).
  2155             20  PY-GL-CANC-SW            PIC X(01).
  2156                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  2157                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  2158             20  PY-GL-COMMENT            PIC X(10).
  2159             20  FILLER      REDEFINES PY-GL-COMMENT.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  39
* EL202.cbl
  2160                 24  PY-GL-CHECK-NO       PIC 9(06).
  2161                 24  FILLER               PIC X(04).
  2162             20  FILLER                   PIC X(07).
  2163         16  PY-SAVE-ACCOUNT              PIC X(10).
  2164         16  PY-SAVE-TYPE                 PIC X(01).
  2165
  2166         16  PY-LETTERS.
  2167             20  PY-LETTER OCCURS 3 TIMES
  2168                           INDEXED BY PY-LET-NDX
  2169                                          PIC X(04).
  2170
  2171         16  PY-ERCOMP-TYPE               PIC X.
  2172             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2173             88  PY-GA-TYPE                   VALUE 'G'.
  2174             88  PY-BANK-TYPE                 VALUE 'B'.
  2175         16  FILLER                       PIC X(05).
  2176
  2177     12  PY-RECORD-STATUS.
  2178         16  PY-CREDIT-SELECT-DT          PIC XX.
  2179         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2180         16  PY-BILLED-DATE               PIC XX.
  2181         16  PY-REPORTED-DT               PIC XX.
  2182         16  PY-PMT-APPLIED               PIC X.
  2183             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2184             88  PY-GA-PMT                    VALUE 'G'.
  2185             88  PY-OVWRITE-PMT               VALUE 'O'.
  2186             88  PY-NON-AR-PMT                VALUE 'N'.
  2187         16  FILLER                       PIC X(5).
  2188         16  PY-INPUT-DT                  PIC XX.
  2189         16  PY-CHECK-NUMBER              PIC X(6).
  2190         16  PY-VOID-SW                   PIC X.
  2191             88  PY-CHECK-VOIDED              VALUE 'V'.
  2192         16  PY-CHECK-ORIGIN-SW           PIC X.
  2193             88  PY-BILLING-CHECK             VALUE 'B'.
  2194             88  PY-REFUND-CHECK              VALUE 'R'.
  2195             88  PY-GA-CHECK                  VALUE 'G'.
  2196             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2197             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2198         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2199         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2200         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2201         16  PY-BILL-FLAG                 PIC X.
  2202             88  PY-BILLED                    VALUE 'B'.
  2203         16  PY-AR-FLAG                   PIC X.
  2204             88  PY-AR-CYCLE                  VALUE 'C'.
  2205             88  PY-AR-MONTH-END              VALUE 'M'.
  2206         16  PY-AR-DATE                   PIC XX.
  2207
  2208     12  PY-GL-CODES.
  2209         16  PY-GL-DB                     PIC X(14).
  2210         16  PY-GL-CR                     PIC X(14).
  2211         16  PY-GL-FLAG                   PIC X.
  2212         16  PY-GL-DATE                   PIC XX.
  2213
  2214     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2215     12  FILLER                           PIC X(3).
  2216******************************************************************
  2217*                                copy ERCPNDB.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  40
* EL202.cbl
  2218******************************************************************
  2219*                                                                *
  2220*                                                                *
  2221*                            ERCPNDB.                            *
  2222*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2223*                            VMOD=2.025                          *
  2224*                                                                *
  2225*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2226*                                                                *
  2227******************************************************************
  2228*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2229*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2230******************************************************************
  2231*                                                                *
  2232*                                                                *
  2233*   FILE TYPE = VSAM,KSDS                                        *
  2234*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2235*                                                                *
  2236*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2237*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2238*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2239*                                                 RKP=13,LEN=36  *
  2240*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2241*                                      AND CHG-SEQ.)             *
  2242*                                                RKP=49,LEN=11   *
  2243*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2244*                                      AND CHG-SEQ.)             *
  2245*                                                RKP=60,LEN=15   *
  2246*                                                                *
  2247*   LOG = NO                                                     *
  2248*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2249******************************************************************
  2250******************************************************************
  2251*                   C H A N G E   L O G
  2252*
  2253* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2254*-----------------------------------------------------------------
  2255*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2256* EFFECTIVE    NUMBER
  2257*-----------------------------------------------------------------
  2258* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2259* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2260* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2261* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2262* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2263* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2264* 032306                   PEMA  ADD BOW LOAN NUMBER
  2265* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2266* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2267* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2268* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2269* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2270* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2271* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2272* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2273* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  2274* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2275******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  41
* EL202.cbl
  2276
  2277 01  PENDING-BUSINESS.
  2278     12  PB-RECORD-ID                     PIC XX.
  2279         88  VALID-PB-ID                        VALUE 'PB'.
  2280
  2281     12  PB-CONTROL-PRIMARY.
  2282         16  PB-COMPANY-CD                PIC X.
  2283         16  PB-ENTRY-BATCH               PIC X(6).
  2284         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2285         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2286
  2287     12  PB-CONTROL-BY-ACCOUNT.
  2288         16  PB-COMPANY-CD-A1             PIC X.
  2289         16  PB-CARRIER                   PIC X.
  2290         16  PB-GROUPING.
  2291             20  PB-GROUPING-PREFIX       PIC XXX.
  2292             20  PB-GROUPING-PRIME        PIC XXX.
  2293         16  PB-STATE                     PIC XX.
  2294         16  PB-ACCOUNT.
  2295             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2296             20  PB-ACCOUNT-PRIME         PIC X(6).
  2297         16  PB-CERT-EFF-DT               PIC XX.
  2298         16  PB-CERT-NO.
  2299             20  PB-CERT-PRIME            PIC X(10).
  2300             20  PB-CERT-SFX              PIC X.
  2301         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2302
  2303         16  PB-RECORD-TYPE               PIC X.
  2304             88  PB-MAILING-DATA                VALUE '0'.
  2305             88  PB-ISSUE                       VALUE '1'.
  2306             88  PB-CANCELLATION                VALUE '2'.
  2307             88  PB-BATCH-TRAILER               VALUE '9'.
  2308
  2309     12  PB-CONTROL-BY-ORIG-BATCH.
  2310         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2311         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2312         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2313         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2314
  2315     12  PB-CONTROL-BY-CSR.
  2316         16  PB-CSR-COMPANY-CD            PIC X.
  2317         16  PB-CSR-ID                    PIC X(4).
  2318         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2319         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2320         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2321******************************************************************
  2322*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2323******************************************************************
  2324
  2325     12  PB-LAST-MAINT-DT                 PIC XX.
  2326     12  PB-LAST-MAINT-BY                 PIC X(4).
  2327     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2328
  2329     12  PB-RECORD-BODY                   PIC X(375).
  2330
  2331     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2332         16  PB-CERT-ORIGIN               PIC X.
  2333             88  CLASIC-CREATED-CERT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  42
* EL202.cbl
  2334         16  PB-I-NAME.
  2335             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  2336             20  PB-I-INSURED-FIRST-NAME.
  2337                 24  PB-I-INSURED-1ST-INIT PIC X.
  2338                 24  FILLER                PIC X(9).
  2339             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2340         16  PB-I-AGE                     PIC S99   COMP-3.
  2341         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2342         16  PB-I-BIRTHDAY                PIC XX.
  2343         16  PB-I-INSURED-SEX             PIC X.
  2344             88  PB-SEX-MALE     VALUE 'M'.
  2345             88  PB-SEX-FEMALE   VALUE 'F'.
  2346
  2347         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2348         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2349         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2350         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2351         16  PB-I-SKIP-CODE               PIC X.
  2352             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2353             88  PB-SKIP-JULY              VALUE '1'.
  2354             88  PB-SKIP-AUGUST            VALUE '2'.
  2355             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2356             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2357             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2358             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2359             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2360             88  PB-SKIP-JUNE              VALUE '8'.
  2361             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2362             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2363             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2364         16  PB-I-TERM-TYPE               PIC X.
  2365             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2366             88  PB-PAID-WEEKLY            VALUE 'W'.
  2367             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2368             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2369             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2370         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2371         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2372         16  PB-I-DATA-ENTRY-SW           PIC X.
  2373             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2374             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2375             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2376             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2377         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2378         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2379*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2380         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2381         16  FILLER                       PIC X.
  2382
  2383         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2384             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2385             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2386                                                   '90' THRU '99'.
  2387         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2388                                          PIC XX.
  2389         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2390         16  PB-I-AMOUNT-FINANCED REDEFINES
  2391                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  43
* EL202.cbl
  2392         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  2393         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  2394                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2395         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2396         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2397         16  PB-I-CLP-AMOUNT REDEFINES
  2398                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2399         16  PB-I-LF-CALC-FLAG            PIC X.
  2400             88 PB-COMP-LF-PREM               VALUE '?'.
  2401         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2402         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2403         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2404         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2405         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2406         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2407         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2408         16  PB-I-LF-ABBR                 PIC XXX.
  2409         16  PB-I-LF-INPUT-CD             PIC XX.
  2410
  2411         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2412             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2413             88  PB-INVALID-AH               VALUE '  ' '00'
  2414                                                   '90' THRU '99'.
  2415         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2416         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2417         16  PB-I-AH-CALC-FLAG            PIC X.
  2418             88 PB-COMP-AH-PREM                  VALUE '?'.
  2419         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2420         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2421         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  2422         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2423         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2424         16  PB-I-AH-ABBR                 PIC XXX.
  2425         16  PB-I-AH-INPUT-CD             PIC XXX.
  2426
  2427         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2428         16  PB-I-REIN-TABLE              PIC XXX.
  2429         16  PB-I-BUSINESS-TYPE           PIC 99.
  2430         16  PB-I-INDV-GRP-CD             PIC X.
  2431         16  PB-I-MORT-CODE.
  2432             20  PB-I-TABLE               PIC X.
  2433             20  PB-I-INTEREST            PIC XX.
  2434             20  PB-I-MORT-TYP            PIC X.
  2435         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2436         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2437         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2438         16  PB-I-INDV-GRP-OVRD           PIC X.
  2439         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2440         16  PB-I-SIG-SW                  PIC X.
  2441             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2442         16  PB-I-RATE-CLASS              PIC XX.
  2443         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2444         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  2445         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  2446         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  2447         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  2448         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  2449         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  44
* EL202.cbl
  2450         16  PB-I-BENEFIT-TYPE            PIC XXX.
  2451         16  PB-I-OB-FLAG                 PIC X.
  2452             88  PB-I-OB                      VALUE 'B'.
  2453             88  PB-I-SUMMARY                 VALUE 'Z'.
  2454         16  PB-I-ENTRY-STATUS            PIC X.
  2455             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  2456                                              'M' '5' '9' '2'.
  2457             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  2458             88  PB-I-POLICY-PENDING          VALUE '2'.
  2459             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  2460             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  2461             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  2462             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  2463             88  PB-I-REIN-ONLY               VALUE '9'.
  2464             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  2465             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  2466             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  2467             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  2468         16  PB-I-INT-CODE                PIC X.
  2469             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  2470             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  2471         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  2472         16  PB-I-SOC-SEC-NO              PIC X(11).
  2473         16  PB-I-MEMBER-NO               PIC X(12).
  2474         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  2475*        16  PB-I-LOAN-OFFICER            PIC XXX.
  2476         16  PB-I-OLD-LOF                 PIC XXX.
  2477         16  PB-I-LF-EXPIRE-DT            PIC XX.
  2478         16  PB-I-AH-EXPIRE-DT            PIC XX.
  2479         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  2480         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  2481         16  PB-I-LIFE-INDICATOR          PIC X.
  2482             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  2483         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  2484         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  2485                                          PIC S9(5)V99    COMP-3.
  2486         16  PB-I-MAIL-ADDRS-SW           PIC X.
  2487             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  2488             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  2489         16  PB-I-1ST-PMT-DT              PIC XX.
  2490         16  PB-I-JOINT-INSURED.
  2491             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  2492             20 PB-I-JOINT-FIRST-NAME.
  2493                24  PB-I-JOINT-FIRST-INIT PIC X.
  2494                24  FILLER                PIC X(9).
  2495             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  2496*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  2497         16  PB-I-BENEFICIARY-NAME.
  2498             20  PB-I-BANK-NUMBER         PIC X(10).
  2499             20  FILLER                   PIC X(15).
  2500         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  2501         16  PB-I-REFERENCE               PIC X(12).
  2502         16  FILLER REDEFINES PB-I-REFERENCE.
  2503             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  2504             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  2505             20  PB-I-CLP-STATE           PIC XX.
  2506         16  PB-I-UNDERWRITING-STATUS     PIC X.
  2507             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  45
* EL202.cbl
  2508             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  2509             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  2510         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  2511         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  2512         16  PB-I-RESIDENT-STATE          PIC XX.
  2513         16  PB-I-RATE-CODE               PIC X(4).
  2514         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  2515         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2516         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2517         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  2518         16  PB-I-BANK-NOCHRGB            PIC 99.
  2519         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  2520         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  2521
  2522     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  2523         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  2524             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  2525         16  PB-C-CANCEL-ORIGIN           PIC X.
  2526             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  2527         16  PB-C-LF-CANCEL-DT            PIC XX.
  2528         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2529         16  PB-C-LF-CALC-REQ             PIC X.
  2530             88 PB-COMP-LF-CANCEL            VALUE '?'.
  2531         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  2532         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  2533         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  2534             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  2535         16  PB-C-AH-CANCEL-DT            PIC XX.
  2536         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  2537         16  PB-C-AH-CALC-REQ             PIC X.
  2538             88 PB-COMP-AH-CANCEL            VALUE '?'.
  2539         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  2540         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  2541         16  PB-C-LAST-NAME               PIC X(15).
  2542         16  PB-C-REFUND-SW               PIC X.
  2543             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  2544             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  2545         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  2546         16  PB-C-PAYEE-CODE              PIC X(6).
  2547         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  2548         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  2549         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  2550         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  2551         16  PB-C-REFERENCE               PIC X(12).
  2552         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  2553         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  2554         16  PB-C-POST-CARD-IND           PIC X.
  2555         16  PB-C-CANCEL-REASON           PIC X.
  2556         16  PB-C-REF-INTERFACE-SW        PIC X.
  2557         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  2558         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  2559         16  FILLER                       PIC X(01).
  2560*        16  FILLER                       PIC X(18).
  2561         16  PB-C-POLICY-FORM-NO          PIC X(12).
  2562*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  2563         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  2564         16  PB-CANCELED-CERT-DATA.
  2565             20  PB-CI-INSURED-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  46
* EL202.cbl
  2566                 24  PB-CI-LAST-NAME      PIC X(15).
  2567                 24  PB-CI-INITIALS       PIC XX.
  2568             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  2569             20  PB-CI-INSURED-SEX        PIC X.
  2570             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  2571             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  2572             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  2573             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  2574             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2575             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  2576             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  2577             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  2578             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  2579             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  2580             20  PB-CI-RATE-CLASS         PIC XX.
  2581             20  PB-CI-RATE-DEV-LF        PIC XXX.
  2582             20  PB-CI-RATE-DEV-AH        PIC XXX.
  2583             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  2584             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  2585             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  2586             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  2587             20  PB-CI-LF-ABBR            PIC X(3).
  2588             20  PB-CI-AH-ABBR            PIC X(3).
  2589             20  PB-CI-OB-FLAG            PIC X.
  2590                 88  PB-CI-OB                VALUE 'B'.
  2591             20  PB-CI-LF-POLICY-STATUS   PIC X.
  2592                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  2593                                           'M' '4' '5' '9' '2'.
  2594                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  2595                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  2596                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  2597                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  2598                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  2599                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  2600                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  2601                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  2602                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  2603                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  2604                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  2605                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  2606                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  2607             20  PB-CI-AH-POLICY-STATUS   PIC X.
  2608                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  2609                                           'M' '4' '5' '9' '2'.
  2610                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  2611                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  2612                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  2613                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  2614                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  2615                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  2616                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  2617                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  2618                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  2619                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  2620                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  2621                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  2622                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  2623             20  PB-CI-PAY-FREQUENCY      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  47
* EL202.cbl
  2624             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  2625             20  PB-CI-SOC-SEC-NO         PIC X(11).
  2626             20  PB-CI-MEMBER-NO          PIC X(12).
  2627             20  PB-CI-INT-CODE           PIC X.
  2628                 88  PB-CI-ADD-ON                  VALUE 'A'.
  2629                 88  PB-CI-SIMPLE                  VALUE 'S'.
  2630             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  2631             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  2632             20  PB-CI-COMP-EXCP-SW       PIC X.
  2633                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  2634                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  2635             20  PB-CI-ENTRY-STATUS       PIC X.
  2636             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  2637             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  2638             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  2639             20  PB-CI-DEATH-DT           PIC XX.
  2640             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  2641             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  2642             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2643             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  2644             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  2645             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  2646             20  PB-CI-ENTRY-DT              PIC XX.
  2647             20  PB-CI-ENTRY-BATCH           PIC X(6).
  2648             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  2649             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  2650             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  2651             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  2652             20  PB-CI-OLD-LOF               PIC XXX.
  2653*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  2654             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  2655             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  2656             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  2657             20  PB-CI-INDV-GRP-CD           PIC X.
  2658             20  PB-CI-BENEFICIARY-NAME.
  2659                 24  PB-CI-BANK-NUMBER       PIC X(10).
  2660                 24  FILLER                  PIC X(15).
  2661             20  PB-CI-NOTE-SW               PIC X.
  2662             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  2663             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  2664             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  2665             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  2666             20  PB-CI-LOAN-OFFICER          PIC X(5).
  2667             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  2668             20  PB-CI-FIRST-NAME            PIC X(10).
  2669             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  2670
  2671         16  FILLER                       PIC X(13).
  2672*032306  16  FILLER                       PIC X(27).
  2673*        16  FILLER                       PIC X(46).
  2674
  2675     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  2676         16  FILLER                       PIC X(10).
  2677         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  2678         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  2679         16  PB-M-INSURED-MID-INIT        PIC X.
  2680         16  PB-M-INSURED-AGE             PIC 99.
  2681         16  PB-M-INSURED-BIRTHDAY        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  48
* EL202.cbl
  2682         16  PB-M-INSURED-SEX             PIC X.
  2683         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  2684         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  2685         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  2686         16  PB-M-INSURED-CITY-STATE.
  2687             20  PB-M-INSURED-CITY        PIC X(28).
  2688             20  PB-M-INSURED-STATE       PIC XX.
  2689         16  PB-M-INSURED-ZIP-CODE.
  2690             20  PB-M-INSURED-ZIP-PRIME.
  2691                 24  PB-M-INSURED-ZIP-1   PIC X.
  2692                     88  PB-M-CANADIAN-POST-CODE
  2693                                             VALUE 'A' THRU 'Z'.
  2694                 24  FILLER               PIC X(4).
  2695             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  2696         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  2697                                        PB-M-INSURED-ZIP-CODE.
  2698             20  PM-M-INS-CAN-POST1       PIC XXX.
  2699             20  PM-M-INS-CAN-POST2       PIC XXX.
  2700             20  FILLER                   PIC XXX.
  2701         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  2702         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  2703         16  PB-M-CRED-BENE-NAME          PIC X(30).
  2704         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  2705         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  2706         16  PB-M-CRED-BENE-CITYST.
  2707             20  PB-M-CRED-BENE-CITY      PIC X(28).
  2708             20  PB-M-CRED-BENE-STATE     PIC XX.
  2709         16  FILLER                       PIC X(92).
  2710
  2711     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  2712         16  FILLER                       PIC X(10).
  2713         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2714         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2715         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2716         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2717         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2718         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2719         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2720         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2721         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2722         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  2723         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  2724         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  2725         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  2726         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  2727         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  2728         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  2729         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  2730         16  PB-ACCOUNT-NAME              PIC X(30).
  2731         16  PB-PREM-REF-RPT-FLAG         PIC X.
  2732         16  PB-REFERENCE                 PIC X(12).
  2733         16  PB-B-RECEIVED-DT             PIC XX.
  2734         16  FILLER                       PIC X(234).
  2735
  2736     12  PB-RECORD-STATUS.
  2737         16  PB-CREDIT-SELECT-DT          PIC XX.
  2738         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  2739         16  PB-BILLED-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  49
* EL202.cbl
  2740         16  PB-BILLING-STATUS            PIC X.
  2741             88  PB-ENTRY-REVERSED            VALUE 'R'.
  2742             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  2743             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  2744         16  PB-RECORD-BILL               PIC X.
  2745             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  2746             88  PB-RECORD-RETURNED           VALUE 'R'.
  2747             88  PB-RECORD-ENDORSED           VALUE 'E'.
  2748             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  2749             88  PB-OVERRIDE-AH               VALUE 'A'.
  2750             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  2751         16  PB-BATCH-ENTRY               PIC X.
  2752             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  2753             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  2754             88  PB-REISSUED-CERT             VALUE 'E'.
  2755             88  PB-CASH-CERT                 VALUE 'C'.
  2756             88  PB-MONTHLY-CERT              VALUE 'M'.
  2757             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  2758             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  2759             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  2760         16  PB-FORCE-CODE                PIC X.
  2761             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  2762             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  2763             88  PB-CANCEL-FORCE              VALUE '8'.
  2764             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  2765             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  2766             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  2767             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  2768             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  2769             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  2770             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  2771         16  PB-FATAL-FLAG                PIC X.
  2772             88  PB-FATAL-ERRORS              VALUE 'X'.
  2773         16  PB-FORCE-ER-CD               PIC X.
  2774             88  PB-FORCE-ERRORS              VALUE 'F'.
  2775             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  2776         16  PB-WARN-ER-CD                PIC X.
  2777             88  PB-WARNING-ERRORS            VALUE 'W'.
  2778         16  FILLER                       PIC X.
  2779         16  PB-OUT-BAL-CD                PIC X.
  2780             88  PB-OUT-OF-BAL                VALUE 'O'.
  2781         16  PB-LIFE-OVERRIDE-L1          PIC X.
  2782         16  PB-AH-OVERRIDE-L1            PIC X.
  2783         16  PB-INPUT-DT                  PIC XX.
  2784         16  PB-INPUT-BY                  PIC X(4).
  2785         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  2786         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  2787         16  PB-TOLERANCE-REJECT-SW       PIC X.
  2788         16  PB-LF-EARNING-METHOD         PIC X.
  2789         16  PB-AH-EARNING-METHOD         PIC X.
  2790         16  PB-LF-TERM-CALC-METHOD       PIC X.
  2791         16  PB-AH-TERM-CALC-METHOD       PIC X.
  2792         16  PB-REIN-CD                   PIC XXX.
  2793         16  PB-LF-REFUND-TYPE            PIC X.
  2794         16  PB-AH-REFUND-TYPE            PIC X.
  2795         16  PB-ACCT-EFF-DT               PIC XX.
  2796         16  PB-ACCT-EXP-DT               PIC XX.
  2797         16  PB-COMPANY-ID                PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  50
* EL202.cbl
  2798         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2799         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  2800         16  PB-SV-CARRIER                PIC X.
  2801         16  PB-SV-GROUPING               PIC X(6).
  2802         16  PB-SV-STATE                  PIC XX.
  2803         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  2804         16  PB-GA-BILLING-INFO.
  2805             20  PB-GA-BILL-DT OCCURS 5 TIMES
  2806                                          PIC XX.
  2807         16  PB-SV-REMIT-TO  REDEFINES
  2808             PB-GA-BILLING-INFO           PIC X(10).
  2809         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2810         16  PB-I-LOAN-OFFICER            PIC X(5).
  2811         16  PB-I-VIN                     PIC X(17).
  2812
  2813         16  FILLER                       PIC X(04).
  2814         16  IMNET-BYPASS-SW              PIC X.
  2815
  2816******************************************************************
  2817*                COMMON EDIT ERRORS                              *
  2818******************************************************************
  2819
  2820     12  PB-COMMON-ERRORS.
  2821         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2822                                           PIC S9(4)     COMP.
  2823
  2824******************************************************************
  2825*                                copy ERCPNDM.
  2826******************************************************************
  2827*                                                                *
  2828*                                                                *
  2829*                            ERCPNDM                             *
  2830*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2831*                            VMOD=2.003                          *
  2832*                                                                *
  2833*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  2834*                                                                *
  2835*   FILE TYPE = VSAM,KSDS                                        *
  2836*   RECORD SIZE = 374   RECFORM = FIX                            *
  2837*                                                                *
  2838*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  2839*   ALTERNATE PATH    = NOT USED                                 *
  2840*                                                                *
  2841*   LOG = YES                                                    *
  2842*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2843******************************************************************
  2844*                   C H A N G E   L O G
  2845*
  2846* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2847*-----------------------------------------------------------------
  2848*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2849* EFFECTIVE    NUMBER
  2850*-----------------------------------------------------------------
  2851* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  2852* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  2853* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2854******************************************************************
  2855
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  51
* EL202.cbl
  2856 01  PENDING-MAILING-DATA.
  2857     12  PM-RECORD-ID                      PIC XX.
  2858         88  VALID-MA-ID                       VALUE 'PM'.
  2859
  2860     12  PM-CONTROL-PRIMARY.
  2861         16  PM-COMPANY-CD                 PIC X.
  2862         16  PM-ENTRY-BATCH                PIC X(6).
  2863         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  2864         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  2865
  2866     12  FILLER                            PIC X(14).
  2867
  2868     12  PM-ACCESS-CONTROL.
  2869         16  PM-SOURCE-SYSTEM              PIC XX.
  2870             88  PM-FROM-CREDIT                VALUE 'CR'.
  2871             88  PM-FROM-VSI                   VALUE 'VS'.
  2872             88  PM-FROM-WARRANTY              VALUE 'WA'.
  2873             88  PM-FROM-OTHER                 VALUE 'OT'.
  2874         16  PM-RECORD-ADD-DT              PIC XX.
  2875         16  PM-RECORD-ADDED-BY            PIC XXXX.
  2876         16  PM-LAST-MAINT-DT              PIC XX.
  2877         16  PM-LAST-MAINT-BY              PIC XXXX.
  2878         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  2879
  2880     12  PM-PROFILE-INFO.
  2881         16  PM-QUALIFY-CODE-1             PIC XX.
  2882         16  PM-QUALIFY-CODE-2             PIC XX.
  2883         16  PM-QUALIFY-CODE-3             PIC XX.
  2884         16  PM-QUALIFY-CODE-4             PIC XX.
  2885         16  PM-QUALIFY-CODE-5             PIC XX.
  2886
  2887         16  PM-INSURED-LAST-NAME          PIC X(15).
  2888         16  PM-INSURED-FIRST-NAME         PIC X(10).
  2889         16  PM-INSURED-MIDDLE-INIT        PIC X.
  2890         16  PM-INSURED-ISSUE-AGE          PIC 99.
  2891         16  PM-INSURED-BIRTH-DT           PIC XX.
  2892         16  PM-INSURED-SEX                PIC X.
  2893             88  PM-SEX-MALE                   VALUE 'M'.
  2894             88  PM-SEX-FEMALE                 VALUE 'F'.
  2895         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  2896
  2897         16  PM-ADDRESS-CORRECTED          PIC X.
  2898         16  PM-JOINT-BIRTH-DT             PIC XX.
  2899*        16  FILLER                        PIC X(12).
  2900
  2901         16  PM-ADDRESS-LINE-1             PIC X(30).
  2902         16  PM-ADDRESS-LINE-2             PIC X(30).
  2903         16  PM-CITY-STATE.
  2904             20  PM-CITY                   PIC X(28).
  2905             20  PM-STATE                  PIC XX.
  2906         16  PM-ZIP.
  2907             20  PM-ZIP-CODE.
  2908                 24  PM-ZIP-1              PIC X.
  2909                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2910                 24  FILLER                PIC X(4).
  2911             20  PM-ZIP-PLUS4              PIC X(4).
  2912         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  2913             20  PM-CAN-POST1              PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  52
* EL202.cbl
  2914             20  PM-CAN-POST2              PIC XXX.
  2915             20  FILLER                    PIC XXX.
  2916
  2917         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  2918
  2919         16  FILLER                        PIC X(03).
  2920
  2921     12  PM-CRED-BENE-INFO.
  2922         16  PM-CRED-BENE-NAME             PIC X(25).
  2923         16  PM-CRED-BENE-ADDR             PIC X(30).
  2924         16  PM-CRED-BENE-ADDR2            PIC X(30).
  2925         16  PM-CRED-BENE-CTYST.
  2926             20  PM-CRED-BENE-CITY         PIC X(28).
  2927             20  PM-CRED-BENE-STATE        PIC XX.
  2928         16  PM-CRED-BENE-ZIP.
  2929             20  PM-CB-ZIP-CODE.
  2930                 24  PM-CB-ZIP-1           PIC X.
  2931                     88  PM-CB-CANADIAN-POST-CODE
  2932                                  VALUE 'A' THRU 'Z'.
  2933                 24  FILLER                PIC X(4).
  2934             20  PM-CB-ZIP-PLUS4           PIC X(4).
  2935         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  2936             20  PM-CB-CAN-POST1           PIC XXX.
  2937             20  PM-CB-CAN-POST2           PIC XXX.
  2938             20  FILLER                    PIC XXX.
  2939     12  PM-POST-CARD-MAIL-DATA.
  2940         16  PM-MAIL-DATA OCCURS 7.
  2941             20  PM-MAIL-TYPE              PIC X.
  2942                 88  PM-12MO-MAILING           VALUE '1'.
  2943                 88  PM-EXP-MAILING            VALUE '2'.
  2944             20  PM-MAIL-STATUS            PIC X.
  2945                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  2946                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  2947                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  2948             20  PM-MAIL-DATE              PIC XX.
  2949     12  FILLER                            PIC XX.
  2950     12  FILLER                            PIC X(12).
  2951*    12  FILLER                            PIC X(30).
  2952
  2953******************************************************************
  2954 01  w-doctoken                  pic x(16).
  2955 01  BATCH-TO-PROCESS.
  2956     05  EDIT-COMPANY-CD         PIC X       VALUE LOW-VALUES.
  2957     05  EDIT-BATCH              PIC X(6)    VALUE SPACES.
  2958     05  EDIT-COMPANY-ID         PIC XXX     VALUE SPACES.
  2959     05  EDIT-RESTART-BATCH      PIC X(6)    VALUE SPACES.
  2960 01 output-data.
  2961    05  filler                   pic x(6) value "TITLE=".
  2962    05  output-title             pic x(26) value 'Check Posting'.
  2963    05  filler                   pic x(8) value "&COMPID=".
  2964    05  out-comp-id              pic xxx.
  2965    05  filler                   pic x(5) value "&MSG=".
  2966    05  output-msg               pic x(50).
  2967****************************************************************
  2968*
  2969* Copyright (c) 2007 by Clerity Solutions, Inc.
  2970* All rights reserved.
  2971*
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  53
* EL202.cbl
  2972****************************************************************
  2973 01  DFHEIV.
  2974   02  DFHEIV0               PIC X(35).
  2975   02  DFHEIV1               PIC X(08).
  2976   02  DFHEIV2               PIC X(08).
  2977   02  DFHEIV3               PIC X(08).
  2978   02  DFHEIV4               PIC X(06).
  2979   02  DFHEIV5               PIC X(04).
  2980   02  DFHEIV6               PIC X(04).
  2981   02  DFHEIV7               PIC X(02).
  2982   02  DFHEIV8               PIC X(02).
  2983   02  DFHEIV9               PIC X(01).
  2984   02  DFHEIV10              PIC S9(7) COMP-3.
  2985   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2986   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2987   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2988   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2989   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2990   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2991   02  DFHEIV17              PIC X(04).
  2992   02  DFHEIV18              PIC X(04).
  2993   02  DFHEIV19              PIC X(04).
  2994   02  DFHEIV20              USAGE IS POINTER.
  2995   02  DFHEIV21              USAGE IS POINTER.
  2996   02  DFHEIV22              USAGE IS POINTER.
  2997   02  DFHEIV23              USAGE IS POINTER.
  2998   02  DFHEIV24              USAGE IS POINTER.
  2999   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3000   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3001   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3002   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3003   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3004   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3005   02  FILLER                PIC X(02).
  3006   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3007   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3008   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3009   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3010   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3011 LINKAGE  SECTION.
  3012*****************************************************************
  3013*                                                               *
  3014* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3015* All rights reserved.                                          *
  3016*                                                               *
  3017*****************************************************************
  3018 01  dfheiblk.
  3019     02  eibtime          pic s9(7) comp-3.
  3020     02  eibdate          pic s9(7) comp-3.
  3021     02  eibtrnid         pic x(4).
  3022     02  eibtaskn         pic s9(7) comp-3.
  3023     02  eibtrmid         pic x(4).
  3024     02  dfheigdi         pic s9(4) comp.
  3025     02  eibcposn         pic s9(4) comp.
  3026     02  eibcalen         pic s9(4) comp.
  3027     02  eibaid           pic x(1).
  3028     02  eibfiller1       pic x(1).
  3029     02  eibfn            pic x(2).
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  54
* EL202.cbl
  3030     02  eibfiller2       pic x(2).
  3031     02  eibrcode         pic x(6).
  3032     02  eibfiller3       pic x(2).
  3033     02  eibds            pic x(8).
  3034     02  eibreqid         pic x(8).
  3035     02  eibrsrce         pic x(8).
  3036     02  eibsync          pic x(1).
  3037     02  eibfree          pic x(1).
  3038     02  eibrecv          pic x(1).
  3039     02  eibsend          pic x(1).
  3040     02  eibatt           pic x(1).
  3041     02  eibeoc           pic x(1).
  3042     02  eibfmh           pic x(1).
  3043     02  eibcompl         pic x(1).
  3044     02  eibsig           pic x(1).
  3045     02  eibconf          pic x(1).
  3046     02  eiberr           pic x(1).
  3047     02  eibrldbk         pic x(1).
  3048     02  eiberrcd         pic x(4).
  3049     02  eibsynrb         pic x(1).
  3050     02  eibnodat         pic x(1).
  3051     02  eibfiller5       pic x(2).
  3052     02  eibresp          pic 9(09) comp.
  3053     02  eibresp2         pic 9(09) comp.
  3054     02  dfheigdj         pic s9(4) comp.
  3055     02  dfheigdk         pic s9(4) comp.
  3056 01  DFHCOMMAREA                     PIC X(1024).
  3057 01  var  pic x(30).
  3058 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  3059 0000-DFHEXIT SECTION.
  3060     MOVE '9#                    $   ' TO DFHEIV0.
  3061     MOVE 'EL202' TO DFHEIV1.
  3062     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3063***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3064***                                                            ***
  3065***                                                We don't    ***
  3066***  have any form fields to browse through, we are getting    ***
  3067***  the information we need through the variables that are    ***
  3068***  included in the URL. These variables are retrieved by     ***
  3069***  the           exec cics web extract                       ***
  3070***                   querystring  (data-value)                ***
  3071***                   querystrlen  (data-value)                ***
  3072***                end-exec                                    ***
  3073***  BTW, you must provide the length, it isn't passed to you. ***
  3074***  Allow for extra on the length or you will get a length    ***
  3075***  error instead of just truncation.                         ***
  3076***                                                            ***
  3077***  This program is expecting                                 ***
  3078*** http://logictest:5002/cics/cwba/EL202?comp=DCC&remit=00001 ***
  3079***http://slunikix:7001/cics/cwba/EL202?comp=DCC&remit=0000000001*
  3080***                                                            ***
  3081***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3082     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  3083     string ws-fn-hours ws-fn-minutes ws-fn-seconds
  3084        delimited by size into ws-work-time-a
  3085     end-string
  3086     string ws-fn-mo     '/'
  3087            ws-fn-da     '/'
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  55
* EL202.cbl
  3088            ws-fn-ccyr
  3089        delimited by size into ws-status-date
  3090     end-string
  3091     move ws-fn-cymd             to dc-greg-date-cymd
  3092     move 'L'                    to dc-option-code
  3093     perform 9700-date-convert   thru 9700-exit
  3094     if no-conversion-error
  3095        move dc-bin-date-1       to ws-bin-current-dt
  3096     else
  3097        display ' error current dt invalid ' dc-error-code
  3098     end-if
  3099     set P to address of KIXSYS
  3100     CALL "getenv" using by value P returning var-ptr
  3101     if var-ptr = null then
  3102        display ' kixsys not set '
  3103     else
  3104        set address of var to var-ptr
  3105        move 0 to env-var-len
  3106        inspect var tallying env-var-len
  3107          for characters before X'00'
  3108        unstring var (1:env-var-len) delimited by '/'
  3109           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  3110              WS-KIX-SYS
  3111        end-unstring
  3112     end-if
  3113
  3114* exec cics web extract
  3115*       querystring  (ws-qry-string)
  3116*       querystrlen  (ws-qrystr-len)
  3117*    end-exec
  3118*    MOVE 'X0  QL                .   #00003016' TO DFHEIV0
  3119     MOVE X'58302020514C202020202020' TO DFHEIV0(1:12)
  3120     MOVE X'202020202020202020202E20' TO DFHEIV0(13:12)
  3121     MOVE X'2020233030303033303136' TO DFHEIV0(25:11)
  3122     CALL 'kxdfhei1' USING DFHEIV0,
  3123           DFHEIV99,
  3124           DFHEIV99,
  3125           ws-qry-string,
  3126           ws-qrystr-len,
  3127           DFHEIV99,
  3128           DFHEIV99,
  3129           DFHEIV99,
  3130           DFHEIV99,
  3131           DFHEIV99,
  3132           DFHEIV99,
  3133           DFHEIV99,
  3134           DFHEIV99,
  3135           DFHEIV99
  3136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3137     display ' qry string ' ws-qry-string
  3138     display ' gry len    ' ws-qrystr-len
  3139     move ws-qry-string (6:3)    to ws-comp-id
  3140     move ws-qry-string (16:10)  to ws-var-alpha
  3141     move zeros                  to ws-remit-id-a
  3142     move +10                    to o1
  3143     perform varying i1 from +10 by -1 until i1 < +1
  3144        if ws-var-alpha (i1:1) numeric
  3145           move ws-var-alpha (i1:1) to ws-remit-id-a (o1:1)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  56
* EL202.cbl
  3146           subtract +1 from o1
  3147        end-if
  3148     end-perform
  3149     move 'Successful Run   '    to output-msg
  3150     move ws-comp-id             to elcntl-key
  3151     move '1'                    to elcntl-rec-type
  3152     move +0                     to elcntl-seq
  3153
  3154* exec cics read
  3155*       dataset  ('ELCNTL')
  3156*       into     (control-file)
  3157*       ridfld   (elcntl-key)
  3158*       resp     (ws-response)
  3159*    end-exec
  3160     MOVE LENGTH OF
  3161      control-file
  3162       TO DFHEIV11
  3163     MOVE 'ELCNTL' TO DFHEIV1
  3164*    MOVE '&"IL       E          (  N#00003036' TO DFHEIV0
  3165     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3166     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3167     MOVE X'204E233030303033303336' TO DFHEIV0(25:11)
  3168     CALL 'kxdfhei1' USING DFHEIV0,
  3169           DFHEIV1,
  3170           control-file,
  3171           DFHEIV11,
  3172           elcntl-key,
  3173           DFHEIV99,
  3174           DFHEIV99,
  3175           DFHEIV99
  3176     MOVE EIBRESP  TO ws-response
  3177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3178     if resp-normal
  3179        display ' good cntl read '
  3180        move cf-cr-month-end-dt  to ws-bin-eom-dt
  3181        move cf-company-cd       to ws-comp-cd
  3182     else
  3183        move 'Company Rec not found ' to output-msg
  3184        display ' error elcntl read ' ws-response ' '
  3185           elcntl-key (1:8)
  3186        go to 0000-return
  3187     end-if
  3188     perform 0010-connect-db     thru 0010-exit
  3189     perform 0020-process-remit  thru 0020-exit
  3190     perform 0050-open-cursor    thru 0050-exit
  3191     perform 0060-process-input  thru 0060-exit
  3192     perform 0130-start-edit     thru 0130-exit
  3193     perform 0226-update-remit-table
  3194                                 thru 0226-exit
  3195     perform 0225-commit-work    thru 0225-exit
  3196     .
  3197 0000-return.
  3198     if connected-to-db
  3199        perform 0230-disconnect  thru 0230-exit
  3200     end-if
  3201     perform 0220-send-form      thru 0220-exit
  3202     if rollback-needed
  3203        display ' executing roll back '
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  57
* EL202.cbl
  3204        perform 0005-rollback    thru 0005-exit
  3205*       CALL 'kixvsam' USING ROLL-BACK
  3206*       exec cics syncpoint
  3207*          rollback
  3208*          resp (ws-response)
  3209*       end-exec
  3210*       display ' rollback resp ' ws-response
  3211     end-if
  3212
  3213* exec cics
  3214*       return
  3215*    end-exec
  3216*    MOVE '.(                    ''   #00003076' TO DFHEIV0
  3217     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3218     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3219     MOVE X'2020233030303033303736' TO DFHEIV0(25:11)
  3220     CALL 'kxdfhei1' USING DFHEIV0,
  3221           DFHEIV99,
  3222           DFHEIV99,
  3223           DFHEIV99,
  3224           DFHEIV99,
  3225           DFHEIV99,
  3226           DFHEIV99
  3227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3228
  3229* goback
  3230
  3231     MOVE '9%                    "   ' TO DFHEIV0
  3232     MOVE 'EL202' TO DFHEIV1
  3233     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3234     goback
  3235     .
  3236 0005-rollback.
  3237     if ws-rb-erpyaj-key not = spaces
  3238        move ws-rb-erpyaj-key    to py-control-primary
  3239
  3240* EXEC CICS DELETE
  3241*          DATASET  ('ERPYAJ')
  3242*          RIDFLD   (PY-CONTROL-PRIMARY)
  3243*          resp     (ws-response)
  3244*       END-EXEC
  3245     MOVE 'ERPYAJ' TO DFHEIV1
  3246*    MOVE '&(  R                 &  N#00003084' TO DFHEIV0
  3247     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  3248     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3249     MOVE X'204E233030303033303834' TO DFHEIV0(25:11)
  3250     CALL 'kxdfhei1' USING DFHEIV0,
  3251           DFHEIV1,
  3252           PY-CONTROL-PRIMARY,
  3253           DFHEIV99,
  3254           DFHEIV99,
  3255           DFHEIV99
  3256     MOVE EIBRESP  TO ws-response
  3257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3258        if resp-normal
  3259           display ' good delete on erpyaj '
  3260        else
  3261           display ' bad delete on erpyaj ' ws-response
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  58
* EL202.cbl
  3262        end-if
  3263     end-if
  3264     if ws-batch-no not = zeros
  3265        move ws-comp-cd          to pb-company-cd
  3266        move ws-batch-no         to pb-entry-batch
  3267        move +0                  to pb-batch-seq-no
  3268                                    pb-batch-chg-seq-no
  3269
  3270* exec cics delete
  3271*          dataset   ('ERPNDB')
  3272*          ridfld    (pb-control-primary)
  3273*          keylength (7)
  3274*          generic
  3275*          resp     (ws-response)
  3276*       end-exec
  3277     MOVE 'ERPNDB' TO DFHEIV1
  3278     MOVE 7
  3279       TO DFHEIV11
  3280*    MOVE '&(  RKG               &  N#00003100' TO DFHEIV0
  3281     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  3282     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3283     MOVE X'204E233030303033313030' TO DFHEIV0(25:11)
  3284     CALL 'kxdfhei1' USING DFHEIV0,
  3285           DFHEIV1,
  3286           pb-control-primary,
  3287           DFHEIV11,
  3288           DFHEIV99,
  3289           DFHEIV99
  3290     MOVE EIBRESP  TO ws-response
  3291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3292        if resp-normal
  3293           display ' good delete on erpndb '
  3294        else
  3295           display ' bad delete on erpndp ' ws-response
  3296        end-if
  3297     end-if
  3298     if ws-batch-no not = zeros
  3299        move ws-comp-cd          to pm-company-cd
  3300        move ws-batch-no         to pm-entry-batch
  3301        move +0                  to pm-batch-seq-no
  3302                                    pm-batch-chg-seq-no
  3303
  3304* exec cics delete
  3305*          dataset   ('ERPNDM')
  3306*          ridfld    (pm-control-primary)
  3307*          keylength (7)
  3308*          generic
  3309*          resp     (ws-response)
  3310*       end-exec
  3311     MOVE 'ERPNDM' TO DFHEIV1
  3312     MOVE 7
  3313       TO DFHEIV11
  3314*    MOVE '&(  RKG               &  N#00003118' TO DFHEIV0
  3315     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  3316     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3317     MOVE X'204E233030303033313138' TO DFHEIV0(25:11)
  3318     CALL 'kxdfhei1' USING DFHEIV0,
  3319           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  59
* EL202.cbl
  3320           pm-control-primary,
  3321           DFHEIV11,
  3322           DFHEIV99,
  3323           DFHEIV99
  3324     MOVE EIBRESP  TO ws-response
  3325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3326        if resp-normal
  3327           display ' good delete on erpndm '
  3328        else
  3329           display ' bad delete on erpndm ' ws-response
  3330        end-if
  3331     end-if
  3332     .
  3333 0005-exit.
  3334     exit.
  3335 0010-CONNECT-DB.
  3336***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3337***                                                            ***
  3338***  Even though it's on ntcso2, CUConnect is the test DB      ***
  3339***  The production DB is ezLink_Prod.  The table names are    ***
  3340***  the same.                                                 ***
  3341***                                                            ***
  3342***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3343     move 'NTCSO2_CUConnect'     to svr
  3344     move 'sa'                   to usr
  3345     move 'ntcso2'               to pass
  3346     if ws-kix-myenv = 'cid1p'
  3347        move 'NTCSO2_ezLink_Prod' to svr
  3348        move 'sa'                to usr
  3349        move 'ntcso2'            to pass
  3350     end-if
  3351     string
  3352         usr delimited space
  3353         "." delimited size
  3354         pass delimited space into usr-pass
  3355     end-string
  3356     display ' About to connect to ' svr ' ' usr-pass
  3357     EXEC SQL
  3358        CONNECT TO :svr USER :usr-pass
  3359     END-EXEC
  3360     if sqlcode not = 0
  3361        display "Error: cannot connect to " svr
  3362        display sqlcode
  3363        display sqlerrmc
  3364        move 'Failed to connect to DB'
  3365                                 to output-msg
  3366        go to 0000-return
  3367     else
  3368        set connected-to-db to true
  3369        display ' Successful Connect ' sqlcode
  3370     end-if
  3371     .
  3372 0010-EXIT.
  3373     EXIT.
  3374 0020-process-remit.
  3375     perform 0030-get-tbl-row    thru 0030-exit
  3376     perform 0040-build-erpyaj   thru 0040-exit
  3377     .
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  60
* EL202.cbl
  3378 0020-exit.
  3379     exit.
  3380 0030-get-tbl-row.
  3381***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3382***                                                            ***
  3383***  I'm only expecting one row so no cursor is declared       ***
  3384***                                                            ***
  3385***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3386     display ' about to get table row ' ws-remit-id
  3387     move ' '                    to ws-remit-sw
  3388*    exec sql
  3389*       SELECT
  3390*          RemitId,
  3391*          Carrier,
  3392*          Group,
  3393*          State,
  3394*          AccountNumber,
  3395*          Name,
  3396*          Addr1,
  3397*          Addr2,
  3398*          AddrCity,
  3399*          AddrState,
  3400*          AddrZIP,
  3401*          ResponsibleCarrier,
  3402*          ResponsibleNumber,
  3403*          LogicStatus,
  3404*          LogicStatusDate,
  3405*          Company,
  3406*          TotalPremium
  3407*       INTO
  3408*          :sql-py-RemitId,
  3409*          :sql-py-Carrier,
  3410*          :sql-py-Group,
  3411*          :sql-py-State,
  3412*          :sql-py-AccountNumber,
  3413*          :sql-py-Name,
  3414*          :sql-py-Addr1,
  3415*          :sql-py-Addr2,
  3416*          :sql-py-AddrCity,
  3417*          :sql-py-AddrState,
  3418*          :sql-py-AddrZIP,
  3419*          :sql-py-ResponsibleCarrier,
  3420*          :sql-py-ResponsibleNumber,
  3421*          :sql-py-LogicStatus,
  3422*          :sql-py-LogicStatusDate,
  3423*          :sql-py-company,
  3424*          :sql-py-tot-prem
  3425*       FROM
  3426*          CUC_Logic_Remittance
  3427*       WHERE
  3428*          RemitId = :ws-remit-id
  3429*    end-exec
  3430     exec sql
  3431        SELECT
  3432           CUC_Logic_Remittance.RemitId,
  3433           Carrier,
  3434           [Group],
  3435           [State],
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  61
* EL202.cbl
  3436           AccountNumber,
  3437           Name,
  3438           Addr1,
  3439           Addr2,
  3440           AddrCity,
  3441           AddrState,
  3442           AddrZIP,
  3443           ResponsibleCarrier,
  3444           ResponsibleNumber,
  3445           LogicStatus,
  3446           Company,
  3447           TotalPremium,
  3448           CUC_Remittance.IsACH
  3449        INTO
  3450           :sql-py-RemitId,
  3451           :sql-py-Carrier,
  3452           :sql-py-Group,
  3453           :sql-py-State,
  3454           :sql-py-AccountNumber,
  3455           :sql-py-Name,
  3456           :sql-py-Addr1,
  3457           :sql-py-Addr2,
  3458           :sql-py-AddrCity,
  3459           :sql-py-AddrState,
  3460           :sql-py-AddrZIP,
  3461           :sql-py-ResponsibleCarrier,
  3462           :sql-py-ResponsibleNumber,
  3463           :sql-py-LogicStatus,
  3464           :sql-py-company,
  3465           :sql-py-tot-prem,
  3466           :sql-is-ach
  3467        FROM
  3468           CUC_Logic_Remittance inner join CUC_Remittance on
  3469              CUC_Logic_Remittance.RemitId =
  3470                 CUC_Remittance.RemitId
  3471        WHERE
  3472           CUC_Logic_Remittance.RemitId = :ws-remit-id
  3473     end-exec
  3474     if sqlcode not = 0
  3475        set ws-remit-not-found   to true
  3476        move sqlcode             to ws-sql-code
  3477        move ws-sql-code         to ws-dis-sql-code
  3478        display ' dis sql code ' ws-dis-sql-code
  3479        display "Error: cannot read row "
  3480        display ' sql return code ' sqlcode
  3481        display ' sql err mess    ' sqlerrmc
  3482        move ' Remittance Not Found '
  3483                                 to output-msg
  3484        go to 0000-return
  3485     end-if
  3486     display ' good get on table ' sqlcode
  3487     if sql-py-LogicStatus = 2
  3488        move 'Remit previously processed '
  3489                                 to output-msg
  3490        go to 0000-return
  3491     end-if
  3492     .
  3493 0030-exit.
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  62
* EL202.cbl
  3494     exit.
  3495 0040-build-erpyaj.
  3496     compute work-seq-no = ws-work-time * 3
  3497     MOVE 'PY'                   TO pending-pay-adj
  3498     move zeros                  to py-file-seq-no
  3499                                    py-last-maint-hhmmss
  3500                                    py-entry-amt
  3501                                    py-check-que-control
  3502                                    py-check-que-sequence
  3503     move low-values             to py-last-maint-dt
  3504                                    py-credit-select-dt
  3505                                    py-credit-accept-dt
  3506                                    py-billed-date
  3507                                    py-reported-dt
  3508                                    py-input-dt
  3509                                    py-check-written-dt
  3510                                    py-ar-date
  3511                                    py-gl-date
  3512     MOVE cf-COMPANY-CD          TO PY-COMPANY-CD
  3513     MOVE function upper-case(sql-py-responsiblecarrier)
  3514                                 TO PY-CARRIER
  3515     MOVE function upper-case(sql-py-group)
  3516                                 TO PY-GROUPING
  3517     MOVE function upper-case(sql-py-responsiblenumber)
  3518                                 TO PY-FIN-RESP
  3519     MOVE function upper-case(sql-py-accountnumber)
  3520                                 TO PY-ACCOUNT
  3521     ADD +1                      TO WORK-SEQ-NO.
  3522     MOVE WORK-SEQ-NO            TO PY-FILE-SEQ-NO.
  3523     move 'R'                    to py-record-type
  3524     move 'E202'                 to py-last-maint-by
  3525     move ws-bin-current-dt      to py-last-maint-dt
  3526                                    py-input-dt
  3527     move ws-work-time           to py-last-maint-hhmmss
  3528*    move +20.00                 to py-entry-amt
  3529     move ws-bin-eom-dt          to py-credit-select-dt
  3530     move 'A'                    to py-ercomp-type
  3531     move sql-is-ach             to ws-bit
  3532     display ' bit comp ' ws-bit-comp
  3533     evaluate true
  3534        when (ws-comp-id = 'DCC')
  3535           and (py-carrier = '9')
  3536           and (ws-bit-comp = zeros)      *> ACH FALSE
  3537           move '2725040310'     to py-gl-account
  3538        when (ws-comp-id = 'DCC')
  3539           and (py-carrier = '7')
  3540           and (ws-bit-comp not = zeros)  *> ACH TRUE
  3541           move '1108121010'     to py-gl-account
  3542        when (ws-comp-id = 'DCC')
  3543           and (py-carrier = '9')
  3544           and (ws-bit-comp not = zeros)  *> ACH TRUE
  3545           move '1108121250'     to py-gl-account
  3546        when (ws-comp-id = 'CID')
  3547           and (ws-bit-comp not = zeros)  *> ACH TRUE
  3548           move '1108124700'     to py-gl-account
  3549        when (ws-comp-id = 'DCC')
  3550           move '1825013400'     to py-gl-account
  3551        when other
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  63
* EL202.cbl
  3552           move '1825099050'     to py-gl-account
  3553     end-evaluate
  3554     if ws-bit-comp not = zeros     *>  ACH TRUE
  3555        move 'ACH'               to py-gl-comment
  3556     end-if
  3557*    if ws-comp-id = 'CID'
  3558*       move '1825099050'        to py-gl-account
  3559*    else
  3560*       move '1825013400'        to py-gl-account
  3561*    end-if
  3562     move +11                    to s2
  3563     move zeros                  to ws-work-amt-alpha
  3564     perform varying s1 from +11 by -1 until s1 < +1
  3565        if sql-py-tot-prem (s1:1) numeric
  3566           move sql-py-tot-prem (s1:1)
  3567                                 to ws-work-amt-alpha (s2:1)
  3568           subtract +1 from s2
  3569        end-if
  3570     end-perform
  3571     display ' tot premium ' ws-work-amt-num
  3572     move ws-work-amt-num        to py-entry-amt
  3573     .
  3574 0040-write.
  3575     display ' about to write pyaj '
  3576
  3577* EXEC CICS WRITE
  3578*        DATASET  ('ERPYAJ')
  3579*        FROM     (PENDING-PAY-ADJ)
  3580*        RIDFLD   (PY-CONTROL-PRIMARY)
  3581*        resp     (ws-response)
  3582*    END-EXEC
  3583     MOVE LENGTH OF
  3584      PENDING-PAY-ADJ
  3585       TO DFHEIV11
  3586     MOVE 'ERPYAJ' TO DFHEIV1
  3587*    MOVE '&$ L                  ''  N#00003375' TO DFHEIV0
  3588     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3589     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3590     MOVE X'204E233030303033333735' TO DFHEIV0(25:11)
  3591     CALL 'kxdfhei1' USING DFHEIV0,
  3592           DFHEIV1,
  3593           PENDING-PAY-ADJ,
  3594           DFHEIV11,
  3595           PY-CONTROL-PRIMARY,
  3596           DFHEIV99,
  3597           DFHEIV99
  3598     MOVE EIBRESP  TO ws-response
  3599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3600     if resp-normal
  3601        move py-control-primary  to ws-rb-erpyaj-key
  3602        move 2                   to ws-status-code
  3603     else
  3604        if resp-duprec
  3605           add +1                to py-file-seq-no
  3606           go to 0040-write
  3607        else
  3608           move 3                to ws-status-code
  3609           move ws-response      to ws-display-response
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  64
* EL202.cbl
  3610           move spaces           to ws-error-message
  3611           string ' Bad write on ERPYAJ FILE ' ws-display-response
  3612              delimited by size into ws-error-message
  3613           end-string
  3614           perform 0226-update-remit-table
  3615                                 thru 0226-exit
  3616           perform 0225-commit-work
  3617                                 thru 0225-exit
  3618           go to 0000-return
  3619        end-if
  3620     end-if
  3621     .
  3622 0040-exit.
  3623     exit.
  3624 0050-open-cursor.
  3625*    display ' declare cursor ' ws-begin-dt ' ' ws-end-dt
  3626***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  3627***                                                            ***
  3628***  The dates on the sql table have values in the time        ***
  3629***  so I convert it to a string and just use mm/dd/yyyy       ***
  3630***  to perform the comparison.                                ***
  3631***                                                            ***
  3632***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  3633     EXEC SQL
  3634        DECLARE
  3635           remitcerts cursor for
  3636        SELECT
  3637           CertId,
  3638           RemitId,
  3639           CertNumber,
  3640           EffectiveDate,
  3641           FirstPaymentDate,
  3642           FirstName,
  3643           LastName,
  3644           CashIndicator,
  3645           LivesCovered,
  3646           LfBenCode,
  3647           LfTerm,
  3648           LfBenefit,
  3649           LfPremium,
  3650           AhBenCode,
  3651           AhTerm,
  3652           AhBenefit,
  3653           AhPremium,
  3654           ErrorMessage
  3655        FROM
  3656           CUC_Logic_Remittance_Cert
  3657        WHERE
  3658           RemitId = :ws-remit-id
  3659     end-exec
  3660     if sqlcode not = 0
  3661        display "Error: cannot declare cursor "
  3662        display ' sql retrun code ' sqlcode
  3663        display ' sql err mess    ' sqlerrmc
  3664        move ' Error declaring cursor '
  3665                                 to output-msg
  3666        move 3                   to ws-status-code
  3667        move sqlcode             to ws-display-response
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  65
* EL202.cbl
  3668        move spaces              to ws-error-message
  3669        string ' Error declaring cursor   ' ws-display-response
  3670           delimited by size into ws-error-message
  3671        end-string
  3672        perform 0226-update-remit-table
  3673                                 thru 0226-exit
  3674        perform 0225-commit-work thru 0225-exit
  3675        go to 0000-return
  3676     end-if
  3677     display ' good declare cursor ' ws-remit-id
  3678     EXEC SQL
  3679        open remitcerts
  3680     END-EXEC
  3681     if sqlcode not = 0
  3682        display "Error: cannot open cursor "
  3683        display ' sql retrun code ' sqlcode
  3684        display ' sql err mess    ' sqlerrmc
  3685        move ' Error opening cursor '
  3686                                 to output-msg
  3687        move 3                   to ws-status-code
  3688        move sqlcode             to ws-display-response
  3689        move spaces              to ws-error-message
  3690        string ' Error openning cursor    ' ws-display-response
  3691           delimited by size into ws-error-message
  3692        end-string
  3693        perform 0226-update-remit-table
  3694                                 thru 0226-exit
  3695        perform 0225-commit-work thru 0225-exit
  3696        go to 0000-return
  3697     end-if
  3698     display ' good open cursor ' ws-remit-id
  3699     .
  3700 0050-exit.
  3701     exit.
  3702 0060-process-input.
  3703     perform until sqlcode not = 0
  3704        EXEC SQL
  3705           fetch remitcerts into
  3706              :sql-pb-CertId,
  3707              :sql-pb-RemitId,
  3708              :sql-pb-CertNumber,
  3709              :sql-pb-EffectiveDate,
  3710              :sql-pb-FirstPaymentDate,
  3711              :sql-pb-FirstName,
  3712              :sql-pb-LastName,
  3713              :sql-pb-CashIndicator,
  3714              :sql-pb-LivesCovered,
  3715              :sql-pb-LfBenCode,
  3716              :sql-pb-LfTerm,
  3717              :sql-pb-LfBenefit,
  3718              :sql-pb-LfPremium,
  3719              :sql-pb-AhBenCode,
  3720              :sql-pb-AhTerm,
  3721              :sql-pb-AhBenefit,
  3722              :sql-pb-AhPremium,
  3723              :sql-pb-ErrorMessage
  3724        END-EXEC
  3725        if sqlcode = 0
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  66
* EL202.cbl
  3726           perform 0070-bld-erpndb
  3727                                 thru 0070-exit
  3728           perform 0110-write-erpndb
  3729                                 thru 0110-exit
  3730           perform 0120-write-erpndm
  3731                                 thru 0120-exit
  3732        else
  3733           if sqlcode not = 0 and 100
  3734              display "Error: cannot fetch row "
  3735              display ' sql return code ' sqlcode
  3736              display ' sql err mess    ' sqlerrmc
  3737              move ' Error fetching cursor '
  3738                                 to output-msg
  3739              set rollback-needed to true
  3740              move 3             to ws-status-code
  3741              move sqlcode       to ws-display-response
  3742              move spaces        to ws-error-message
  3743              string ' Error during fetch cursor '
  3744                ws-display-response
  3745                 delimited by size into ws-error-message
  3746              end-string
  3747              perform 0226-update-remit-table
  3748                                 thru 0226-exit
  3749              perform 0225-commit-work
  3750                                 thru 0225-exit
  3751              go to 0000-return
  3752           end-if
  3753        end-if
  3754     end-perform
  3755     if sqlcode = 100
  3756        display ' Normal end of record set '
  3757        perform 0100-build-batch-hdr
  3758                                 thru 0100-exit
  3759        perform 0110-write-erpndb
  3760                                 thru 0110-exit
  3761     end-if
  3762     EXEC SQL
  3763         close remitcerts
  3764     END-EXEC
  3765     if sqlcode not = 0
  3766        display "Error: cannot close cursor "
  3767        display ' sql retrun code ' sqlcode
  3768        display ' sql err mess    ' sqlerrmc
  3769     end-if
  3770     .
  3771 0060-exit.
  3772     exit.
  3773 0070-bld-erpndb.
  3774     if ws-batch-no-n = zeros
  3775        perform 0080-get-batch-no thru 0080-exit
  3776     end-if
  3777     move ws-init-erpndb-rec     to pending-business
  3778     move ws-batch-no            to pb-entry-batch
  3779                                    pb-original-entry-batch
  3780                                    pb-csr-entry-batch
  3781     add +1 to ws-batch-seq-no
  3782     move ws-batch-seq-no        to pb-batch-seq-no
  3783                                    pb-original-seq-no
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  67
* EL202.cbl
  3784                                    pb-csr-batch-seq-no
  3785     move function upper-case(sql-pb-certnumber)
  3786                                 to pb-cert-no
  3787     string sql-pb-effectivedate (1:4)
  3788            sql-pb-effectivedate (6:2)
  3789            sql-pb-effectivedate (9:2)
  3790        delimited by size into dc-greg-date-cymd-r
  3791     end-string
  3792     move 'L'                    to dc-option-code
  3793     perform 9700-date-convert   thru 9700-exit
  3794     if no-conversion-error
  3795        move dc-bin-date-1       to pb-cert-eff-dt
  3796     else
  3797        display ' error cvtdte eff dt ' sql-pb-effectivedate
  3798           ' ' dc-error-code
  3799     end-if
  3800     move function upper-case(sql-pb-lastname)
  3801                                 to pb-i-insured-last-name
  3802     move function upper-case(sql-pb-firstname)
  3803                                 to pb-i-insured-first-name
  3804     if sql-pb-lfbencode = zeros
  3805        move spaces              to sql-pb-lfbencode
  3806     end-if
  3807     move function upper-case(sql-pb-lfbencode)
  3808                                 to pb-i-life-benefit-cd
  3809                                    pb-i-lf-input-cd
  3810     if pb-i-life-benefit-cd = spaces
  3811        move zeros               to pb-i-life-benefit-cd
  3812     end-if
  3813     move sql-pb-lfterm          to pb-i-lf-term
  3814     move 'L'                    to pb-ah-override-l1
  3815     move +11                    to s2
  3816     move zeros                  to ws-work-amt-alpha
  3817     perform varying s1 from +12 by -1 until s1 < +1
  3818        if sql-pb-lfbenefit (s1:1) numeric
  3819           move sql-pb-lfbenefit (s1:1)
  3820                                 to ws-work-amt-alpha (s2:1)
  3821           subtract +1 from s2
  3822        end-if
  3823     end-perform
  3824     display ' lf benefit  ' ws-work-amt-num
  3825     move ws-work-amt-num        to pb-i-lf-benefit-amt
  3826     move +11                    to s2
  3827     move zeros                  to ws-work-amt-alpha
  3828     perform varying s1 from +10 by -1 until s1 < +1
  3829        if sql-pb-lfpremium (s1:1) numeric
  3830           move sql-pb-lfpremium (s1:1)
  3831                                 to ws-work-amt-alpha (s2:1)
  3832           subtract +1 from s2
  3833        end-if
  3834     end-perform
  3835     display ' lf premium  ' ws-work-amt-num
  3836     move ws-work-amt-num        to pb-i-lf-premium-amt
  3837     if sql-pb-ahbencode = zeros
  3838        move spaces              to sql-pb-ahbencode
  3839     end-if
  3840     move function upper-case(sql-pb-ahbencode)
  3841                                 to pb-i-ah-benefit-cd
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  68
* EL202.cbl
  3842                                    pb-i-ah-input-cd
  3843     if pb-i-ah-benefit-cd = spaces
  3844        move zeros               to pb-i-ah-benefit-cd
  3845     end-if
  3846     move 'A'                    to pb-ah-override-l1
  3847     move sql-pb-ahterm          to pb-i-ah-term
  3848     move +11                    to s2
  3849     move zeros                  to ws-work-amt-alpha
  3850     perform varying s1 from +10 by -1 until s1 < +1
  3851        if sql-pb-ahbenefit (s1:1) numeric
  3852           move sql-pb-ahbenefit (s1:1)
  3853                                 to ws-work-amt-alpha (s2:1)
  3854           subtract +1 from s2
  3855        end-if
  3856     end-perform
  3857     display ' ah benefit  ' ws-work-amt-num
  3858     move ws-work-amt-num        to pb-i-ah-benefit-amt
  3859     move +11                    to s2
  3860     move zeros                  to ws-work-amt-alpha
  3861     perform varying s1 from +10 by -1 until s1 < +1
  3862        if sql-pb-ahpremium (s1:1) numeric
  3863           move sql-pb-ahpremium (s1:1)
  3864                                 to ws-work-amt-alpha (s2:1)
  3865           subtract +1 from s2
  3866        end-if
  3867     end-perform
  3868     display ' ah premium  ' ws-work-amt-num
  3869     move ws-bin-eom-dt          to pb-credit-select-dt
  3870     move ws-work-amt-num        to pb-i-ah-premium-amt
  3871     move sql-pb-LivesCovered    to pb-i-lives
  3872     move function upper-case(sql-pb-CashIndicator)
  3873                                 to pb-i-entry-status
  3874                                    pb-batch-entry
  3875     compute ws-lf-iss-premium =
  3876        ws-lf-iss-premium + pb-i-lf-premium-amt
  3877     compute ws-ah-iss-premium =
  3878        ws-ah-iss-premium + pb-i-ah-premium-amt
  3879     move 'A'                    to pb-force-code
  3880     compute ws-iss-cnt = ws-iss-cnt + +1
  3881     move pb-batch-seq-no           to ws-highest-seq-no
  3882*    display ' sql-pb-CertId           ' sql-pb-CertId
  3883*    display ' sql-pb-RemitId          ' sql-pb-RemitId
  3884*    display ' sql-pb-CertNumber       ' sql-pb-CertNumber
  3885*    display ' sql-pb-EffectiveDate    ' sql-pb-EffectiveDate
  3886*    display ' sql-pb-FirstPaymentDate ' sql-pb-FirstPaymentDate
  3887*    display ' sql-pb-FirstName        ' sql-pb-FirstName
  3888*    display ' sql-pb-LastName         ' sql-pb-LastName
  3889*    display ' sql-pb-CashIndicator    ' sql-pb-CashIndicator
  3890*    display ' sql-pb-LivesCovered     ' sql-pb-LivesCovered
  3891*    display ' sql-pb-LfBenCode        ' sql-pb-LfBenCode
  3892*    display ' sql-pb-LfTerm           ' sql-pb-LfTerm
  3893*    display ' sql-pb-LfBenefit        ' sql-pb-LfBenefit
  3894*    display ' sql-pb-LfPremium        ' sql-pb-LfPremium
  3895*    display ' sql-pb-AhBenCode        ' sql-pb-AhBenCode
  3896*    display ' sql-pb-AhTerm           ' sql-pb-AhTerm
  3897*    display ' sql-pb-AhBenefit        ' sql-pb-AhBenefit
  3898*    display ' sql-pb-AhPremium        ' sql-pb-AhPremium
  3899*    display ' sql-pb-ErrorMessage     ' sql-pb-ErrorMessage
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  69
* EL202.cbl
  3900     .
  3901 0070-exit.
  3902     exit.
  3903 0080-get-batch-no.
  3904     perform 0090-init-erpndb    thru 0090-exit
  3905     perform 0240-init-erpndm    thru 0240-exit
  3906     move ws-comp-id             to elcntl-key
  3907     move '1'                    to elcntl-rec-type
  3908     move +0                     to elcntl-seq
  3909
  3910* exec cics read update
  3911*       dataset  ('ELCNTL')
  3912*       into     (control-file)
  3913*       ridfld   (elcntl-key)
  3914*       resp     (ws-response)
  3915*    end-exec
  3916     MOVE LENGTH OF
  3917      control-file
  3918       TO DFHEIV11
  3919     MOVE 'ELCNTL' TO DFHEIV1
  3920*    MOVE '&"IL       EU         (  N#00003690' TO DFHEIV0
  3921     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3922     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3923     MOVE X'204E233030303033363930' TO DFHEIV0(25:11)
  3924     CALL 'kxdfhei1' USING DFHEIV0,
  3925           DFHEIV1,
  3926           control-file,
  3927           DFHEIV11,
  3928           elcntl-key,
  3929           DFHEIV99,
  3930           DFHEIV99,
  3931           DFHEIV99
  3932     MOVE EIBRESP  TO ws-response
  3933     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3934     if resp-normal
  3935        add +1                   to cf-last-batch-no
  3936        move cf-last-batch-no    to ws-batch-no-n
  3937        move +0                  to ws-batch-seq-no
  3938
  3939* exec cics rewrite
  3940*          dataset  ('ELCNTL')
  3941*          from     (control-file)
  3942*          resp     (ws-response)
  3943*       end-exec
  3944     MOVE LENGTH OF
  3945      control-file
  3946       TO DFHEIV11
  3947     MOVE 'ELCNTL' TO DFHEIV1
  3948*    MOVE '&& L                  %  N#00003700' TO DFHEIV0
  3949     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3950     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3951     MOVE X'204E233030303033373030' TO DFHEIV0(25:11)
  3952     CALL 'kxdfhei1' USING DFHEIV0,
  3953           DFHEIV1,
  3954           control-file,
  3955           DFHEIV11,
  3956           DFHEIV99
  3957     MOVE EIBRESP  TO ws-response
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  70
* EL202.cbl
  3958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3959        if not resp-normal
  3960           display ' bad rewrite on cntl - batch no '
  3961              ws-batch-no-n
  3962           move ' Error rewrite ELCNTL '
  3963                                 to output-msg
  3964           set rollback-needed   to true
  3965           move ws-response         to ws-display-response
  3966           move spaces              to ws-error-message
  3967           string ' Bad rewrite  ELCNTL FILE '
  3968              ws-display-response
  3969              delimited by size into ws-error-message
  3970           end-string
  3971           move 3                to ws-status-code
  3972           perform 0226-update-remit-table
  3973                                 thru 0226-exit
  3974           perform 0225-commit-work
  3975                                 thru 0225-exit
  3976           go to 0000-return
  3977        end-if
  3978     else
  3979        display ' bad read upde on cntl - batch no '
  3980              elcntl-key (1:4)
  3981     end-if
  3982     .
  3983 0080-exit.
  3984     exit.
  3985 0090-init-erpndb.
  3986     move 'PB'                   to pending-business
  3987     INITIALIZE PB-issue-RECORD
  3988     initialize pb-record-status
  3989     move low-values             to pb-i-lf-expire-dt
  3990                                    pb-i-ah-expire-dt
  3991                                    pb-i-1st-pmt-dt
  3992                                    pb-i-last-add-on-dt
  3993                                    pb-i-birthday
  3994                                    pb-i-joint-birthday
  3995                                    pb-credit-select-dt
  3996                                    pb-credit-accept-dt
  3997                                    pb-billed-dt
  3998                                    pb-input-dt
  3999                                    pb-acct-eff-dt
  4000                                    pb-acct-exp-dt
  4001                                    pb-confirmation-rept-dt
  4002                                    pb-ga-bill-dt (1)
  4003                                    pb-ga-bill-dt (2)
  4004                                    pb-ga-bill-dt (3)
  4005                                    pb-ga-bill-dt (4)
  4006                                    pb-ga-bill-dt (5)
  4007     move ws-comp-id             to pb-company-id
  4008     move ws-comp-cd             to pb-company-cd
  4009                                    pb-company-cd-a1
  4010                                    pb-original-company-cd
  4011                                    pb-csr-company-cd
  4012     move zeros                  to pb-chg-count
  4013                                    pb-batch-chg-seq-no
  4014                                    pb-alt-chg-seq-no
  4015                                    pb-original-chg-seq-no
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  71
* EL202.cbl
  4016                                    pb-csr-batch-chg-seq-no
  4017                                    pb-i-rate-deviation-lf
  4018                                    pb-i-rate-deviation-ah
  4019                                    pb-no-of-errors
  4020                                    pb-lf-billed-amts
  4021                                    pb-ah-billed-amts
  4022     move function upper-case(sql-py-carrier)
  4023                                 to pb-carrier
  4024                                    pb-sv-carrier
  4025     move function upper-case(sql-py-group)
  4026                                 to pb-grouping
  4027                                    pb-sv-grouping
  4028     move function upper-case(sql-py-state)
  4029                                 to pb-state
  4030                                    pb-sv-state
  4031     move function upper-case(sql-py-accountnumber)
  4032                                 to pb-account
  4033     move '1'                    to pb-record-type
  4034     move 'E202'                 to pb-last-maint-by
  4035                                    pb-input-by
  4036     move ws-bin-current-dt      to pb-last-maint-dt
  4037                                    pb-input-dt
  4038     move ws-work-time           to pb-last-maint-hhmmss
  4039     perform varying s1 from +1 by +1 until s1 > +10
  4040        move +0                  to pb-common-error (s1)
  4041     end-perform
  4042     move pending-business       to ws-init-erpndb-rec
  4043     .
  4044 0090-exit.
  4045     exit.
  4046 0100-BUILD-BATCH-HDR.
  4047     display ' about to build batch hdr '
  4048     move ws-init-erpndb-rec     to pending-business
  4049     move ws-batch-no            to pb-entry-batch
  4050                                    pb-original-entry-batch
  4051                                    pb-csr-entry-batch
  4052                                    pb-cert-no
  4053     add +1 to ws-batch-seq-no
  4054     move 9999                   to pb-batch-seq-no
  4055                                    pb-original-seq-no
  4056                                    pb-csr-batch-seq-no
  4057     move high-values            to pb-cert-eff-dt
  4058     move zeros                  to PB-B-LF-ISS-PRM-REMITTED
  4059                                    PB-B-LF-ISS-PRM-ENTERED
  4060                                    PB-B-LF-ISS-PRM-COMPUTED
  4061                                    PB-B-LF-CAN-PRM-REMITTED
  4062                                    PB-B-LF-CAN-PRM-ENTERED
  4063                                    PB-B-LF-CAN-PRM-COMPUTED
  4064                                    PB-B-AH-ISS-PRM-REMITTED
  4065                                    PB-B-AH-ISS-PRM-ENTERED
  4066                                    PB-B-AH-ISS-PRM-COMPUTED
  4067                                    PB-B-AH-CAN-PRM-REMITTED
  4068                                    PB-B-AH-CAN-PRM-ENTERED
  4069                                    PB-B-AH-CAN-PRM-COMPUTED
  4070                                    PB-B-ISSUE-CNT-REMITTED
  4071                                    PB-B-ISSUE-CNT-ENTERED
  4072                                    PB-B-CANCEL-CNT-REMITTED
  4073                                    PB-B-CANCEL-CNT-ENTERED
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  72
* EL202.cbl
  4074                                    PB-B-HIGHEST-SEQ-NO
  4075                                    PB-LF-BILLED-AMTS
  4076                                    PB-AH-BILLED-AMTS
  4077                                    PB-CHG-COUNT
  4078                                    PB-CALC-TOLERANCE
  4079     move spaces                 to pb-account-name
  4080                                    pb-prem-ref-rpt-flag
  4081                                    pb-reference
  4082     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
  4083                                    PB-BILLED-DT
  4084                                    PB-ACCT-EFF-DT
  4085                                    PB-ACCT-EXP-DT
  4086     MOVE '9'                    TO PB-RECORD-TYPE
  4087     move ws-iss-cnt             to pb-b-issue-cnt-remitted
  4088     move ws-lf-iss-premium      to pb-b-lf-iss-prm-remitted
  4089     move ws-ah-iss-premium      to pb-b-ah-iss-prm-remitted
  4090     move ws-highest-seq-no      to pb-b-highest-seq-no
  4091     move ws-bin-current-dt      to pb-b-received-dt
  4092     move ws-bin-eom-dt          to pb-credit-select-dt
  4093     move function upper-case(sql-py-Name)
  4094                                 to PB-ACCOUNT-NAME
  4095     .
  4096 0100-EXIT.
  4097     EXIT.
  4098 0110-write-erpndb.
  4099     display ' about to write pend bus ' pb-record-type
  4100
  4101* EXEC CICS WRITE
  4102*        DATASET  ('ERPNDB')
  4103*        FROM     (PENDING-BUSINESS)
  4104*        RIDFLD   (PB-CONTROL-PRIMARY)
  4105*        RESP     (WS-RESPONSE)
  4106*    END-EXEC
  4107     MOVE LENGTH OF
  4108      PENDING-BUSINESS
  4109       TO DFHEIV11
  4110     MOVE 'ERPNDB' TO DFHEIV1
  4111*    MOVE '&$ L                  ''  N#00003846' TO DFHEIV0
  4112     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4113     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4114     MOVE X'204E233030303033383436' TO DFHEIV0(25:11)
  4115     CALL 'kxdfhei1' USING DFHEIV0,
  4116           DFHEIV1,
  4117           PENDING-BUSINESS,
  4118           DFHEIV11,
  4119           PB-CONTROL-PRIMARY,
  4120           DFHEIV99,
  4121           DFHEIV99
  4122     MOVE EIBRESP  TO WS-RESPONSE
  4123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4124     IF NOT RESP-NORMAL
  4125        DISPLAY ' ERPNDB BTCH WRITE ERROR ' WS-RESPONSE
  4126        move ' Error writing erpndb  '
  4127                           to output-msg
  4128        set rollback-needed to true
  4129        move ws-response         to ws-display-response
  4130        move spaces              to ws-error-message
  4131        string ' Bad write on ERPNDB FILE ' ws-display-response
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  73
* EL202.cbl
  4132           delimited by size into ws-error-message
  4133        end-string
  4134        move 3             to ws-status-code
  4135        perform 0226-update-remit-table
  4136                           thru 0226-exit
  4137        perform 0225-commit-work
  4138                           thru 0225-exit
  4139        go to 0000-return
  4140     END-IF
  4141     .
  4142 0110-exit.
  4143     exit.
  4144 0120-write-erpndm.
  4145     display ' about to write pend mail '
  4146     move ws-init-erpndm         to pending-mailing-data
  4147     move pb-control-primary     to pm-control-primary
  4148     move function upper-case(sql-py-Name)
  4149                                 to PM-CRED-BENE-NAME
  4150     move function upper-case(sql-py-Addr1)
  4151                                 to PM-CRED-BENE-ADDR
  4152     move function upper-case(sql-py-Addr2)
  4153                                 to PM-CRED-BENE-ADDR2
  4154     move function upper-case(sql-py-AddrCity)
  4155                                 to PM-CRED-BENE-CITY
  4156     move function upper-case(sql-py-AddrState)
  4157                                 to pm-cred-bene-state
  4158     move sql-py-AddrZIP         to pm-cred-bene-zip
  4159
  4160* EXEC CICS WRITE
  4161*        DATASET  ('ERPNDM')
  4162*        FROM     (PENDING-MAILING-DATA)
  4163*        RIDFLD   (PM-CONTROL-PRIMARY)
  4164*        RESP     (WS-RESPONSE)
  4165*    END-EXEC
  4166     MOVE LENGTH OF
  4167      PENDING-MAILING-DATA
  4168       TO DFHEIV11
  4169     MOVE 'ERPNDM' TO DFHEIV1
  4170*    MOVE '&$ L                  ''  N#00003887' TO DFHEIV0
  4171     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4172     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4173     MOVE X'204E233030303033383837' TO DFHEIV0(25:11)
  4174     CALL 'kxdfhei1' USING DFHEIV0,
  4175           DFHEIV1,
  4176           PENDING-MAILING-DATA,
  4177           DFHEIV11,
  4178           PM-CONTROL-PRIMARY,
  4179           DFHEIV99,
  4180           DFHEIV99
  4181     MOVE EIBRESP  TO WS-RESPONSE
  4182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4183     IF NOT RESP-NORMAL
  4184        move ' Error writing erpndm  '
  4185                                 to output-msg
  4186        set rollback-needed to true
  4187        move ws-response         to ws-display-response
  4188        move spaces              to ws-error-message
  4189        string ' Bad write on ERPNDM FILE ' ws-display-response
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  74
* EL202.cbl
  4190           delimited by size into ws-error-message
  4191        end-string
  4192        move 3                   to ws-status-code
  4193        perform 0226-update-remit-table
  4194                                 thru 0226-exit
  4195        perform 0225-commit-work
  4196                                 thru 0225-exit
  4197        go to 0000-return
  4198        DISPLAY ' ERPNDM WRITE ERROR ' WS-RESPONSE
  4199     END-IF
  4200     .
  4201 0120-exit.
  4202     exit.
  4203 0130-start-edit.
  4204     display ' about to start edit '
  4205     MOVE ws-comp-cd             TO EDIT-COMPANY-CD
  4206     MOVE WS-BATCH-NO            TO EDIT-BATCH
  4207     MOVE ws-comp-id             TO EDIT-COMPANY-ID
  4208     MOVE SPACES                 TO EDIT-RESTART-BATCH
  4209
  4210* EXEC CICS START
  4211*         TRANSID       ('EXEB')
  4212*         FROM          (BATCH-TO-PROCESS)
  4213*    END-EXEC
  4214     MOVE LENGTH OF
  4215      BATCH-TO-PROCESS
  4216       TO DFHEIV11
  4217     MOVE 'EXEB' TO DFHEIV5
  4218*    MOVE '0( LF                 1   #00003919' TO DFHEIV0
  4219     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  4220     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  4221     MOVE X'2020233030303033393139' TO DFHEIV0(25:11)
  4222     CALL 'kxdfhei1' USING DFHEIV0,
  4223           DFHEIV99,
  4224           DFHEIV5,
  4225           DFHEIV99,
  4226           BATCH-TO-PROCESS,
  4227           DFHEIV11,
  4228           DFHEIV99,
  4229           DFHEIV99,
  4230           DFHEIV99,
  4231           DFHEIV99,
  4232           DFHEIV99,
  4233           DFHEIV99,
  4234           DFHEIV99,
  4235           DFHEIV99,
  4236           DFHEIV99,
  4237           DFHEIV99,
  4238           DFHEIV99
  4239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4240
  4241* EXEC CICS DELAY
  4242*       INTERVAL    (02)
  4243*    END-EXEC
  4244     MOVE 02 TO DFHEIV10
  4245*    MOVE '0$I                   &   #00003923' TO DFHEIV0
  4246     MOVE X'302449202020202020202020' TO DFHEIV0(1:12)
  4247     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  75
* EL202.cbl
  4248     MOVE X'2020233030303033393233' TO DFHEIV0(25:11)
  4249     CALL 'kxdfhei1' USING DFHEIV0,
  4250           DFHEIV10,
  4251           DFHEIV99,
  4252           DFHEIV99,
  4253           DFHEIV99,
  4254           DFHEIV99
  4255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4256     .
  4257 0130-exit.
  4258     exit.
  4259 0220-send-form.
  4260     move ws-comp-id             to out-comp-id
  4261     move 'CU CONNECT '          to output-title
  4262     display ' about to send form '
  4263
  4264* exec cics document create
  4265*       doctoken   (w-doctoken)
  4266*       template   ('WCHECKS')
  4267*       symbollist (output-data)
  4268*       listlength (length of output-data)
  4269*    end-exec
  4270     MOVE 'WCHECKS'
  4271      TO DFHEIVL0
  4272     MOVE LENGTH OF
  4273      output-data TO DFHEIV16
  4274*    MOVE '\"D tSL               )   #00003933' TO DFHEIV0
  4275     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
  4276     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4277     MOVE X'2020233030303033393333' TO DFHEIV0(25:11)
  4278     CALL 'kxdfhei1' USING DFHEIV0,
  4279           w-doctoken,
  4280           DFHEIV99,
  4281           DFHEIVL0,
  4282           output-data,
  4283           DFHEIV16,
  4284           DFHEIV99,
  4285           DFHEIV99,
  4286           DFHEIV99
  4287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4288
  4289* exec cics web send
  4290*       doctoken(w-doctoken)
  4291*    end-exec
  4292*    MOVE 'X$D                   *   #00003939' TO DFHEIV0
  4293     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
  4294     MOVE X'202020202020202020202A20' TO DFHEIV0(13:12)
  4295     MOVE X'2020233030303033393339' TO DFHEIV0(25:11)
  4296     CALL 'kxdfhei1' USING DFHEIV0,
  4297           w-doctoken,
  4298           DFHEIV99,
  4299           DFHEIV99,
  4300           DFHEIV99,
  4301           DFHEIV99,
  4302           DFHEIV99,
  4303           DFHEIV99,
  4304           DFHEIV99,
  4305           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  76
* EL202.cbl
  4306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4307     .
  4308 0220-exit.
  4309     exit.
  4310 0225-commit-work.
  4311     display ' about to commit work   '
  4312     if connected-to-db
  4313        EXEC SQL
  4314            commit work
  4315        END-EXEC
  4316     end-if
  4317     .
  4318 0225-exit.
  4319     exit.
  4320 0226-update-remit-table.
  4321     if ws-batch-no = zeros
  4322        move -1                  to nu-batchno
  4323     else
  4324        move +0                  to nu-batchno
  4325     end-if
  4326     if ws-error-message = spaces
  4327        move -1                  to nu-error-message
  4328     else
  4329        move +0                  to nu-error-message
  4330     end-if
  4331     EXEC SQL
  4332        UPDATE
  4333           CUC_Logic_Remittance
  4334        SET
  4335           LogicStatus = :ws-status-code,
  4336           LogicStatusDate = :ws-status-date,
  4337           BatchNumber = :ws-batch-no :nu-batchno,
  4338           ErrorMessage = :ws-error-message :nu-error-message
  4339        WHERE
  4340           RemitId = :ws-remit-id
  4341     END-EXEC
  4342     .
  4343 0226-exit.
  4344     exit.
  4345 0230-disconnect.
  4346     display ' about to disconnect DB '
  4347     if connected-to-db
  4348        EXEC SQL
  4349            disconnect all
  4350        END-EXEC
  4351        move ' ' to ws-connect-sw
  4352     end-if
  4353     .
  4354 0230-exit.
  4355     exit.
  4356 0240-init-erpndm.
  4357     display ' made it to init pndm '
  4358     move spaces                 to pending-mailing-data
  4359     move 'PM'                   to pm-record-id
  4360     move zeros                  to pm-batch-seq-no
  4361                                    pm-batch-chg-seq-no
  4362                                    pm-last-maint-hhmmss
  4363                                    pm-insured-issue-age
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  77
* EL202.cbl
  4364                                    pm-phone-no
  4365     move low-values             to pm-record-add-dt
  4366                                    pm-last-maint-dt
  4367                                    pm-insured-birth-dt
  4368                                    pm-joint-birth-dt
  4369     perform varying s1 from +1 by +1 until s1 > +7
  4370        move low-values          to pm-mail-date (s1)
  4371     end-perform
  4372     move 'CR'                   to pm-source-system
  4373     move ws-bin-current-dt      to pm-record-add-dt
  4374                                    pm-last-maint-dt
  4375     move 'E202'                 to pm-last-maint-by
  4376                                    pm-record-added-by
  4377     move ws-work-time           to pm-last-maint-hhmmss
  4378     move pending-mailing-data   to ws-init-erpndm
  4379     .
  4380 0240-exit.
  4381     exit.
  4382 9700-DATE-CONVERT.
  4383
  4384* EXEC CICS LINK
  4385*         PROGRAM  ('ELDATCV')
  4386*         COMMAREA (DATE-CONVERSION-DATA)
  4387*         LENGTH   (DC-COMM-LENGTH)
  4388*    END-EXEC.
  4389     MOVE 'ELDATCV' TO DFHEIV1
  4390*    MOVE '."C                   (   #00004018' TO DFHEIV0
  4391     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4393     MOVE X'2020233030303034303138' TO DFHEIV0(25:11)
  4394     CALL 'kxdfhei1' USING DFHEIV0,
  4395           DFHEIV1,
  4396           DATE-CONVERSION-DATA,
  4397           DC-COMM-LENGTH,
  4398           DFHEIV99,
  4399           DFHEIV99,
  4400           DFHEIV99,
  4401           DFHEIV99
  4402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4403
  4404 9700-EXIT.
  4405      EXIT.
  4406
  4407 9999-DFHBACK SECTION.
  4408     MOVE '9%                    "   ' TO DFHEIV0
  4409     MOVE 'EL202' TO DFHEIV1
  4410     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4411     GOBACK.
  4412 9999-DFHEXIT.
  4413     IF DFHEIGDJ EQUAL 0001
  4414         NEXT SENTENCE.
  4415     MOVE '9%                    "   ' TO DFHEIV0
  4416     MOVE 'EL202' TO DFHEIV1
  4417     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4418     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Micro Focus Server Express         V5.1 revision 000 06-Apr-16 08:37 Page  78
* EL202.cbl
* Total Messages:     0
* Data:      138620     Code:       17605
