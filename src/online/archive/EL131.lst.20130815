* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page   1
* EL131.cbl
* Options: int("EL131.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL131.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL131.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL131.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL131 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/03/95 18:43:40.
     7*                            VMOD=2.046.
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*REMARKS. TRANSACTION EX24 - CLAIM MAINTENANCE.
    12*
    13******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page   2
* EL131.cbl
    14*                   C H A N G E   L O G
    15*
    16* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    17*-----------------------------------------------------------------
    18*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    19* EFFECTIVE    NUMBER
    20*-----------------------------------------------------------------
    21* 101501    2001100100006  SMVA  ADD USERID, POPULATE COMPO
    22* 062602    2002030700006  PEMA  Add note type of 'S'
    23*                                  (special review)
    24* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    25* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    26* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    27* 032612    2011110200001  PEMA  AHL CHANGES
    28* 040412    2012040400003  AJRA  DO NOT DELETE CERT ON AHL
    29* 032613    2013032500002  AJRA  PROTECT CERT#,CARR,GRP,ST,ACCT,EF
    30* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    31* 060413    2013060300001  AJRA  CHECK FOR AUTO PAY WHEN BENE REMO
    32* 071613    2013071200001  PEMA  REMOVE INC & RPT DATE EDITS.
    33******************************************************************
    34
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page   3
* EL131.cbl
    36 ENVIRONMENT DIVISION.
    37
    38 DATA DIVISION.
    39
    40 WORKING-STORAGE SECTION.
    41 01  DFH-START PIC X(04).
    42
    43 77  FILLER  PIC X(32)  VALUE '********************************'.
    44 77  FILLER  PIC X(32)  VALUE '*   EL131  WORKING STORAGE     *'.
    45 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.046 *********'.
    46 77  s1                          pic s999 comp-3 value+0.
    47 77  s2                          pic s999 comp-3 value+0.
    48 77  a1                          pic s999 comp-3 value+0.
    49 77  WS-CRIT-PER-RECURRENT       PIC X     VALUE ' '.
    50 77  WS-CRITICAL-PERIOD          PIC 99    VALUE ZEROS.
    51 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    52 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    53 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    54 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    55 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    56 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    57     88  ERPDEF-FOUND                 VALUE 'Y'.
    58
    59 01  LCP-TIME-OF-DAY-XX.
    60     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    61     05  FILLER                    PIC 99.
    62 01  LCP-CICS-TIME                 PIC 9(15).
    63*                            COPY ELCSCTM.
    64******************************************************************
    65*                                                                *
    66*                                                                *
    67*                            ELCSCTM                             *
    68*                            VMOD=2.001                          *
    69*                                                                *
    70*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    71*                                                                *
    72******************************************************************
    73 01  SECURITY-MESSAGE.
    74     12  FILLER                          PIC X(30)
    75            VALUE '** LOGIC SECURITY VIOLATION -'.
    76     12  SM-READ                         PIC X(6).
    77     12  FILLER                          PIC X(5)
    78            VALUE ' PGM='.
    79     12  SM-PGM                          PIC X(6).
    80     12  FILLER                          PIC X(5)
    81            VALUE ' OPR='.
    82     12  SM-PROCESSOR-ID                 PIC X(4).
    83     12  FILLER                          PIC X(6)
    84            VALUE ' TERM='.
    85     12  SM-TERMID                       PIC X(4).
    86     12  FILLER                          PIC XX   VALUE SPACE.
    87     12  SM-JUL-DATE                     PIC 9(5).
    88     12  FILLER                          PIC X    VALUE SPACE.
    89     12  SM-TIME                         PIC 99.99.
    90
    91
    92*                            COPY ELCSCRTY.
    93******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page   4
* EL131.cbl
    94*                                                                *
    95*                                                                *
    96*                            ELCSCRTY                            *
    97*                            VMOD=2.001                          *
    98*                                                                *
    99*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   100*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   101*        SAVED IN PI-SECURITY-ADDRESS.                           *
   102*                                                                *
   103******************************************************************
   104 01  SECURITY-CONTROL.
   105     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   106     12  FILLER                       PIC XX    VALUE 'SC'.
   107     12  SC-CREDIT-CODES.
   108         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   109             20  SC-CREDIT-DISPLAY    PIC X.
   110             20  SC-CREDIT-UPDATE     PIC X.
   111     12  SC-CLAIMS-CODES.
   112         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   113             20  SC-CLAIMS-DISPLAY    PIC X.
   114             20  SC-CLAIMS-UPDATE     PIC X.
   115
   116*                            COPY ELCNWA.
   117*****************************************************************
   118*                                                               *
   119*                                                               *
   120*                            ELCNWA.                            *
   121*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   122*                            VMOD=2.003                         *
   123*                                                               *
   124*            M O V E   N A M E   W O R K   A R E A.             *
   125*                                                               *
   126*****************************************************************.
   127
   128 01  WS-NAME-WORK-AREA.
   129     05  WS-INSURED-LAST-NAME        PIC X(15).
   130     05  WS-INSURED-1ST-NAME         PIC X(12).
   131     05  WS-INSURED-MID-INIT         PIC X.
   132
   133     05  WS-NAME-WORK.
   134         10  WS-NW                   PIC X
   135             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   136
   137     05  WS-NAME-WORK2.
   138         10  WS-NW2                  PIC X
   139             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   140                                        NWA-INDEX0.
   141
   142     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   143                                     COMP-3.
   144
   145
   146 01  ws-dcc-error-line.
   147     05  filler occurs 15.
   148         10  ws-error-no        pic x(4).
   149 01  WS-DATE-AREA.
   150     12  SAVE-DATE              PIC X(8)    VALUE SPACES.
   151     12  SAVE-BIN-DATE          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page   5
* EL131.cbl
   152     12  SAVE-DATE-CCYYMMDD.
   153         16  SAVE-DATE-CC       PIC XX      VALUE SPACES.
   154         16  SAVE-DATE-YMD.
   155             20  SAVE-DATE-YY   PIC XX      VALUE SPACES.
   156             20  FILLER         PIC X(4)    VALUE SPACES.
   157
   158 01  WS-BLANK                   PIC X       VALUE ' '.
   159
   160 01  CSO-WORK-FIELDS.
   161     05  WS-HOLD-CLAIM-STATUS    PIC X.
   162
   163 01  LITERALS-NUMBERS.
   164     12  SC-ITEM                 PIC S9(4)   VALUE +1    COMP.
   165     12  NINETY                  PIC S9(4)   VALUE +90   COMP.
   166     12  ELMSTR-GENERIC-LENGTH   PIC S9(4)   VALUE +9    COMP.
   167     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   168     12  THIS-PGM                PIC X(8)    VALUE 'EL131'.
   169     12  TRAN-ID                 PIC X(4)    VALUE 'EX24'.
   170     12  MAP-ID                  PIC X(4)    VALUE '131A'.
   171
   172     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   173     12  XCTL-EL004              PIC X(8)    VALUE 'EL004'.
   174     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   175     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   176     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   177     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   178     12  XCTL-EL141              PIC X(8)    VALUE 'EL141'.
   179     12  XCTL-EL142              PIC X(8)    VALUE 'EL142'.
   180     12  XCTL-EL400DMD           PIC X(8)    VALUE 'EL400DMD'.
   181
   182     12  LINK-1523               PIC X(8)    VALUE 'EL1523'.
   183
   184     12  DATE-CONV               PIC X(8)    VALUE 'ELDATCV'.
   185
   186     12  RTRM-FILE-ID            PIC X(8)    VALUE 'ELRTRM'.
   187     12  CLMS-FILE-ID            PIC X(8)    VALUE 'ELMSTR'.
   188     12  NOTE-FILE-ID            PIC X(8)    VALUE 'ERNOTE'.
   189     12  CERT-FILE-ID            PIC X(8)    VALUE 'ELCERT'.
   190     12  TRLR-FILE-ID            PIC X(8)    VALUE 'ELTRLR'.
   191     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   192     12  ACTQ-FILE-ID            PIC X(8)    VALUE 'ELACTQ'.
   193     12  CHKQ-FILE-ID            PIC X(8)    VALUE 'ELCHKQ'.
   194     12  ACCT-FILE-ID            PIC X(8)    VALUE 'ERACCT'.
   195     12  ARCH-FILE-ID            PIC X(8)    VALUE 'ELARCH'.
   196     12  ALPH-FILE-ID            PIC X(8)    VALUE 'ELALPH'.
   197
   198     12  MISC-SUB                PIC S9(3)   COMP-3  VALUE +0.
   199     12  ONE-OR-MIN1             PIC S9      COMP-3  VALUE +1.
   200     12  WS-READNEXT-SWITCH      PIC S99     VALUE +1.
   201     12  WS-ASSOC-CERT-TOTAL     PIC S99             VALUE ZEROS.
   202         88  NO-ASSOCIATED-CERTS                     VALUE ZEROS.
   203     12  WS-ASSOC-CERT-SEQU      PIC S99             VALUE ZEROS.
   204     12  WS-ASSOCIATED-CERTS     PIC S9      COMP-3  VALUE +0.
   205     12  WS-DIAGNOSIS            PIC X(60)   VALUE SPACES.
   206     12  WS-CLAIM-SEQU.
   207         16  FILLER              PIC X VALUE '('.
   208         16  WS-CURRENT-SEQU     PIC Z9.
   209         16  FILLER              PIC X(04) VALUE ' OF '.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page   6
* EL131.cbl
   210         16  WS-OF-SEQU          PIC Z9.
   211         16  FILLER              PIC X VALUE ')'.
   212     12  WS-EDIT-BEN-CODE        PIC XX.
   213         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   214                                          '90' THRU '99'.
   215
   216     12  WS-EDIT-AMT             PIC ZZZ,ZZZ.99.
   217     12  WS-EDIT-NUMBER          PIC ZZZ9.
   218
   219     12  WS-RESPONSE             PIC S9(8)   COMP.
   220         88  WS-RESP-NORMAL              VALUE +00.
   221         88  WS-RESP-ERROR               VALUE +01.
   222         88  WS-RESP-NOTFND              VALUE +13.
   223         88  WS-RESP-DUPKEY              VALUE +15.
   224         88  WS-RESP-NOTOPEN             VALUE +19.
   225         88  WS-RESP-ENDFILE             VALUE +20.
   226
   227     12  WS-MOS-PAID             PIC 999.
   228     12  WS-ODD-DAYS             PIC 99.
   229     12  WS-REM-MOS              PIC 999.
   230     12  WS-REM-DAYS             PIC 99.
   231     12  WS-TERM-IN-DAYS         PIC 9(4).
   232     12  WS-REM-TERM-IN-DAYS     PIC 9(4).
   233
   234     12  WS-BROWSE-SW            PIC X       VALUE 'N'.
   235     12  WS-UPDATE-SW            PIC X       VALUE 'N'.
   236     12  WS-OPEN-CLOSE-SW        PIC X       VALUE ' '.
   237     12  WS-RESET-SW             PIC X       VALUE 'N'.
   238     12  WS-REC-FOUND-SW         PIC X       VALUE 'N'.
   239     12  WS-DMO-LENGTH           PIC S9(4)   VALUE +108 COMP.
   240     12  WS-DCT-LENGTH           PIC S9(4)   VALUE +53 COMP.
   241
   242 01  DMD-DATE-YYYYMMDD.
   243     12  DMD-DECADE          PIC XX      VALUE SPACES.
   244     12  DMD-YYMMDD.
   245         16  DMD-YY          PIC XX      VALUE SPACES.
   246         16  DMD-MM          PIC XX      VALUE SPACES.
   247         16  DMD-DD          PIC XX      VALUE SPACES.
   248
   249 01  DMD-DATE-MMDDYYYY.
   250     12  DMD-MDY-MM          PIC XX      VALUE SPACES.
   251     12  DMD-MDY-SLASH1      PIC X       VALUE '/'.
   252     12  DMD-MDY-DD          PIC XX      VALUE SPACES.
   253     12  DMD-MDY-SLASH2      PIC X       VALUE '/'.
   254     12  DMD-MDY-DECADE      PIC XX      VALUE SPACES.
   255     12  DMD-MDY-YY          PIC XX      VALUE SPACES.
   256
   257 01  WS-MAIL-CODE.
   258     12  FILLER              PIC X.
   259     12  DMD-MAIL-CODE.
   260         16  WS-MAIL-4       PIC X(4).
   261         16  WS-MAIL-5       PIC X.
   262     12  FILLER              PIC X(4).
   263
   264     12  W-NAME-LAST             PIC  X(15).
   265     12  W-NAME-FIRST            PIC  X(15).
   266     12  W-NAME-MIDDLE.
   267         16  FILLER              PIC  X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page   7
* EL131.cbl
   268         16  W-NAME-MIDDLE-2     PIC  X.
   269         16  FILLER              PIC  X(13).
   270
   271*    COPY ELCDCTB.
   272******************************************************************
   273*                                                                *
   274*                                                                *
   275*                            ELCDCTB.                            *
   276*                            VMOD=2.002                          *
   277*                                                                *
   278*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
   279*       COMMUNICATIONS AREA                                      *
   280*                                                                *
   281******************************************************************
   282 01  DCT-COMMUNICATION-AREA.
   283     12  DCT-BILLING-BANK-ID      PIC  X(05).
   284     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
   285     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
   286     12  DCT-PRODUCT-CODE         PIC  X(02).
   287     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
   288     12  DCT-RETURN-CODE          PIC  X(02).
   289     12  DCT-MAIL-CODE            PIC  X(05).
   290     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
   291     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page   8
* EL131.cbl
   293 01  ERROR-SWITCHES.
   294     12  ERROR-SWITCH            PIC X.
   295         88  SCREEN-ERROR                    VALUE 'X'.
   296     12  MSTR-KEY-SWITCH         PIC X.
   297         88  MSTR-KEY-CHANGED                VALUE 'X'.
   298     12  CERT-KEY-SWITCH         PIC X.
   299*********SET TO X IF ALTERNATE INDEXES WILL CHANGE
   300         88  CERT-ALT-KEY-CHANGED            VALUE 'X'.
   301*********SET TO Y IF PRIMARY KEY WILL CHANGE
   302         88  CERT-KEY-CHANGED                VALUE 'Y'.
   303     12  MSTR-SWITCH             PIC X.
   304         88  MSTR-UPDATES                    VALUE 'X'.
   305     12  CERT-SWITCH             PIC X.
   306         88  CERT-UPDATES                    VALUE 'X'.
   307     12  UPDATE-SWITCH           PIC X.
   308         88  UPDATES-PRESENT                 VALUE 'X'.
   309     12  TRLR-SWITCH             PIC X.
   310         88  TRLR-UPDATE-REQUIRED            VALUE 'X'.
   311         88  UPDATE-MADE                     VALUE 'Y'.
   312     12  NINETY-TRLR-SWITCH      PIC X.
   313         88  NINETY-TRLR-UPDATED             VALUE 'X'.
   314     12  NINETY5-TRLR-SWITCH      PIC X  VALUE ' '.
   315         88  NINETY5-TRLR-UPDATED             VALUE 'X'.
   316     12  EARNINGS-CALC-SWITCH    PIC X.
   317         88  TEX-REG                         VALUE '4'.
   318         88  NET-PAY                         VALUE '5'.
   319     12  DLYACTV-SW              PIC X       VALUE 'N'.
   320         88  DLYACTV-RECORD-NEEDED           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page   9
* EL131.cbl
   322 01  EDIT-WORK-AREA.
   323     12  COUNT-2                 PIC 9.
   324     12  CALL-PGM                PIC X(8).
   325     12  TRANS-ID                PIC X(4).
   326     12  CHECK-PFKEYS            PIC 99.
   327     12  CHECK-MAINT             PIC X.
   328         88  ADD-ALPHA-RECORD                VALUE 'A'.
   329         88  CHANGE-CLAIM                    VALUE 'C'.
   330         88  DELETE-CLAIM                    VALUE 'D'.
   331         88  CHANGE-NAME                     VALUE 'N'.
   332         88  VALID-OPTIONS                   VALUE 'A' 'C'
   333                                                   'D' 'N'.
   334
   335     12  HOLD-BENEFIT            PIC XX.
   336     12  HOLD-FREQ               PIC XX.
   337     12  HOLD-REPORTED           PIC XX  VALUE LOW-VALUES.
   338     12  HOLD-INCUR              PIC XX  VALUE LOW-VALUES.
   339     12  HOLD-PDTHRU             PIC XX.
   340     12  HOLD-ADDON              PIC XX.
   341     12  HOLD-NODAYS             PIC 9(4).
   342     12  HOLD-NOPMTS             PIC 9(3).
   343     12  HOLD-PDAMT              PIC 9(7)V99    COMP-3.
   344     12  HOLD-LOANBAL            PIC 9(7)V99    COMP-3  VALUE 0.
   345     12  HOLD-APR                PIC 9(3)V9(4)  COMP-3  VALUE 0.
   346     12  HOLD-BIRTH              PIC XX.
   347     12  HOLD-END                PIC XX.
   348     12  HOLD-EFF                PIC XX.
   349     12  HOLD-ENTRY              PIC XX.
   350     12  HOLD-LF-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   351     12  HOLD-LF-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   352     12  HOLD-AH-CV-BEN          PIC S9(9)V99   COMP-3  VALUE +0.
   353     12  HOLD-AH-RATE            PIC S9(4)V99   COMP-3  VALUE +0.
   354     12  HOLD-LF-CV-CAN          PIC XX.
   355     12  HOLD-AH-CV-CAN          PIC XX.
   356     12  DIVIDE-QUOT             PIC 9(3).
   357     12  DIVIDE-REM              PIC 9(3).
   358
   359     12  WS-ALPHA-DATE.
   360         16  WS-ALPHA-YEAR.
   361             20  WS-ALPHA-YY-1   PIC 99.
   362             20  WS-ALPHA-YY-2   PIC 99.
   363         16  WS-ALPHA-MM         PIC 99.
   364         16  WS-ALPHA-DD         PIC 99.
   365
   366     12  BUILD-VALID-DATE.
   367         16  BUILD-MONTH         PIC 99.
   368         16  BUILD-DAY           PIC 99.
   369         16  BUILD-YEAR          PIC 99.
   370     12  DEEDIT-MMYY-INPUT.
   371         16  FILLER              PIC X.
   372         16  DEEDIT-MONTH        PIC XX.
   373         16  DEEDIT-YEAR         PIC XX.
   374     12  DEEDIT-BEN              PIC 9(9)V99.
   375     12  DEEDIT-DATE-INPUT.
   376         16  FILLER              PIC XX.
   377         16  DEEDIT-DATE         PIC X(6).
   378     12  WORK-DATE-MDY.
   379         16  MONTH-WORK          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  10
* EL131.cbl
   380         16  FILLER              PIC X(4).
   381         16  YEAR-WORK           PIC XX.
   382     12  WORK-DATE-MY.
   383         16  WORK-MONTH          PIC XX.
   384         16  WORK-SLASH          PIC X       VALUE '/'.
   385         16  WORK-YEAR           PIC XX.
   386     12  HOLD-DATE.
   387         16  HOLD-MONTH          PIC 99.
   388         16  FILLER              PIC X(4).
   389         16  HOLD-YEAR           PIC 99.
   390     12  SPLIT-INFO-LINE-1.
   391         16  SPLIT-INFO-DESC     PIC X(15).
   392         16  FILLER              PIC X(5)    VALUE ' OLD='.
   393         16  SPLIT-INFO-OLD      PIC X(40).
   394     12  EFF-TERM-MO             PIC 9(4).
   395     12  CURR-MO                 PIC 9(4).
   396     12  WS-BIN-CURRENT-DT       PIC XX.
   397     12  WS-CALC-METHOD          PIC X.
   398     12  WS-INITIALS.
   399         16  WS-INIT-1           PIC X.
   400         16  WS-INIT-2           PIC X.
   401     12  WS-REIN-TABLE.
   402         16  WS-REIN-1           PIC X.
   403         16  WS-REIN-2           PIC X.
   404         16  WS-REIN-3           PIC X.
   405     12  PI-KEY.
   406         16  PI-TERM             PIC X(4).
   407         16  PI-QUAL             PIC X(4).
   408     12  CHECK-KEY               PIC X(20).
   409     12  SAVE-ACCT-KEY           PIC X(20).
   410     12  SKIP-ATTRIBUTE          PIC X      VALUE SPACES.
   411     12  WS-SOC-SEC-NUMBER.
   412         16  WS-SOC-SEC-NO       PIC 9(9).
   413         16  WS-SOC-SEC-BLANK    PIC X(2).
   414     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   415         16  WS-SSN-1-3          PIC 9(3).
   416         16  WS-SSN-DASH1        PIC X(1).
   417         16  WS-SSN-4-5          PIC 9(2).
   418         16  WS-SSN-DASH2        PIC X(1).
   419         16  WS-SSN-6-9          PIC 9(4).
   420     12  AUTO-PAY-TO-BENE        PIC X     VALUE 'N'.
   421
   422 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   423     12  M                   PIC S9(7)V99           VALUE ZEROS.
   424     12  L                   PIC S9(7)V99           VALUE ZEROS.
   425     12  N                   PIC S9(3)              VALUE ZEROS.
   426     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   427     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   428     12  I                   PIC S99V9(5)           VALUE ZEROS.
   429     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   430     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   431     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   432     12  R                   PIC S9(3)              VALUE ZEROS.
   433     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   434     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   435     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   436     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   437     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  11
* EL131.cbl
   438     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   439     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   440     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   441     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   442
   443 01  TERM-CALC-WORK-AREA.
   444     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   445     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   446     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   447     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   448     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   449     12  V-EXPONENTS.
   450        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   451     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   452
   453 01  TIME-IN.
   454     12  UN-HOURS                PIC XX.
   455     12  UN-MINUTES              PIC XX.
   456     12  FILLER                  PIC XX.
   457
   458 01  TIME-OUT.
   459     12  FOR-HOURS               PIC XX.
   460     12  FILLER                  PIC X       VALUE '.'.
   461     12  FOR-MINUTES             PIC XX.
   462
   463 01  ERROR-NUMBERS.
   464     12  ER-0000                 PIC X(4)    VALUE '0000'.
   465     12  ER-0004                 PIC X(4)    VALUE '0004'.
   466     12  ER-0008                 PIC X(4)    VALUE '0008'.
   467     12  ER-0023                 PIC X(4)    VALUE '0023'.
   468     12  ER-0029                 PIC X(4)    VALUE '0029'.
   469     12  ER-0068                 PIC X(4)    VALUE '0068'.
   470     12  ER-0070                 PIC X(4)    VALUE '0070'.
   471     12  ER-0149                 PIC X(4)    VALUE '0149'.
   472     12  ER-0154                 PIC X(4)    VALUE '0154'.
   473     12  ER-0169                 PIC X(4)    VALUE '0169'.
   474     12  ER-0192                 PIC X(4)    VALUE '0192'.
   475     12  ER-0199                 PIC X(4)    VALUE '0199'.
   476     12  ER-0203                 PIC X(4)    VALUE '0203'.
   477     12  ER-0204                 PIC X(4)    VALUE '0204'.
   478     12  ER-0205                 PIC X(4)    VALUE '0205'.
   479     12  ER-0206                 PIC X(4)    VALUE '0206'.
   480     12  ER-0208                 PIC X(4)    VALUE '0208'.
   481     12  ER-0210                 PIC X(4)    VALUE '0210'.
   482     12  ER-0215                 PIC X(4)    VALUE '0215'.
   483     12  ER-0219                 PIC X(4)    VALUE '0219'.
   484     12  ER-0220                 PIC X(4)    VALUE '0220'.
   485     12  ER-0222                 PIC X(4)    VALUE '0222'.
   486     12  ER-0223                 PIC X(4)    VALUE '0223'.
   487     12  ER-0224                 PIC X(4)    VALUE '0224'.
   488     12  ER-0227                 PIC X(4)    VALUE '0227'.
   489     12  ER-0230                 PIC X(4)    VALUE '0230'.
   490     12  ER-0232                 PIC X(4)    VALUE '0232'.
   491     12  ER-0233                 PIC X(4)    VALUE '0233'.
   492     12  ER-0236                 PIC X(4)    VALUE '0236'.
   493     12  ER-0237                 PIC X(4)    VALUE '0237'.
   494     12  ER-0238                 PIC X(4)    VALUE '0238'.
   495     12  ER-0240                 PIC X(4)    VALUE '0240'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  12
* EL131.cbl
   496     12  ER-0241                 PIC X(4)    VALUE '0241'.
   497     12  ER-0243                 PIC X(4)    VALUE '0243'.
   498     12  ER-0244                 PIC X(4)    VALUE '0244'.
   499     12  ER-0246                 PIC X(4)    VALUE '0246'.
   500     12  ER-0247                 PIC X(4)    VALUE '0247'.
   501     12  ER-0248                 PIC X(4)    VALUE '0248'.
   502     12  ER-0250                 PIC X(4)    VALUE '0250'.
   503     12  ER-0251                 PIC X(4)    VALUE '0251'.
   504     12  ER-0253                 PIC X(4)    VALUE '0253'.
   505     12  ER-0256                 PIC X(4)    VALUE '0256'.
   506     12  ER-0257                 PIC X(4)    VALUE '0257'.
   507     12  ER-0258                 PIC X(4)    VALUE '0258'.
   508     12  ER-0259                 PIC X(4)    VALUE '0259'.
   509     12  ER-0260                 PIC X(4)    VALUE '0260'.
   510     12  ER-0261                 PIC X(4)    VALUE '0261'.
   511     12  ER-0262                 PIC X(4)    VALUE '0262'.
   512     12  ER-0263                 PIC X(4)    VALUE '0263'.
   513     12  ER-0273                 PIC X(4)    VALUE '0273'.
   514     12  ER-0274                 PIC X(4)    VALUE '0274'.
   515     12  ER-0276                 PIC X(4)    VALUE '0276'.
   516     12  ER-0282                 PIC X(4)    VALUE '0282'.
   517     12  ER-0283                 PIC X(4)    VALUE '0283'.
   518     12  ER-0309                 PIC X(4)    VALUE '0309'.
   519     12  ER-0310                 PIC X(4)    VALUE '0310'.
   520     12  ER-0311                 PIC X(4)    VALUE '0311'.
   521     12  ER-0333                 PIC X(4)    VALUE '0333'.
   522     12  ER-0360                 PIC X(4)    VALUE '0360'.
   523     12  ER-0377                 PIC X(4)    VALUE '0377'.
   524     12  ER-0402                 PIC X(4)    VALUE '0402'.
   525     12  ER-0416                 PIC X(4)    VALUE '0416'.
   526     12  ER-0426                 PIC X(4)    VALUE '0426'.
   527     12  ER-0427                 PIC X(4)    VALUE '0427'.
   528     12  ER-0428                 PIC X(4)    VALUE '0428'.
   529     12  ER-0429                 PIC X(4)    VALUE '0429'.
   530     12  ER-0430                 PIC X(4)    VALUE '0430'.
   531     12  ER-0458                 PIC X(4)    VALUE '0458'.
   532     12  ER-0475                 PIC X(4)    VALUE '0475'.
   533     12  ER-0491                 PIC X(4)    VALUE '0491'.
   534     12  ER-0509                 PIC X(4)    VALUE '0509'.
   535     12  ER-0510                 PIC X(4)    VALUE '0510'.
   536     12  ER-0511                 PIC X(4)    VALUE '0511'.
   537     12  ER-0512                 PIC X(4)    VALUE '0512'.
   538     12  ER-0519                 PIC X(4)    VALUE '0519'.
   539     12  ER-0520                 PIC X(4)    VALUE '0520'.
   540     12  ER-0521                 PIC X(4)    VALUE '0521'.
   541     12  ER-0547                 PIC X(4)    VALUE '0547'.
   542     12  ER-0548                 PIC X(4)    VALUE '0548'.
   543     12  ER-0549                 PIC X(4)    VALUE '0549'.
   544     12  ER-0565                 PIC X(4)    VALUE '0565'.
   545     12  ER-0598                 PIC X(4)    VALUE '0598'.
   546     12  ER-0639                 PIC X(4)    VALUE '0639'.
   547     12  ER-0797                 PIC X(4)    VALUE '0797'.
   548     12  ER-0802                 PIC X(4)    VALUE '0802'.
   549     12  ER-0803                 PIC X(4)    VALUE '0803'.
   550     12  ER-0849                 PIC X(4)    VALUE '0849'.
   551     12  ER-0885                 PIC X(4)    VALUE '0885'.
   552     12  ER-0887                 PIC X(4)    VALUE '0887'.
   553     12  ER-0919                 PIC X(4)    VALUE '0919'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  13
* EL131.cbl
   554     12  ER-0921                 PIC X(4)    VALUE '0921'.
   555     12  ER-0938                 PIC X(4)    VALUE '0938'.
   556     12  ER-0946                 PIC X(4)    VALUE '0946'.
   557     12  ER-0947                 PIC X(4)    VALUE '0947'.
   558     12  ER-0948                 PIC X(4)    VALUE '0948'.
   559     12  ER-0949                 PIC X(4)    VALUE '0949'.
   560     12  ER-0950                 PIC X(4)    VALUE '0950'.
   561     12  ER-0951                 PIC X(4)    VALUE '0951'.
   562     12  ER-0954                 PIC X(4)    VALUE '0954'.
   563     12  ER-0974                 PIC X(4)    VALUE '0974'.
   564     12  ER-0975                 PIC X(4)    VALUE '0975'.
   565     12  ER-1651                 PIC X(4)    VALUE '1651'.
   566     12  ER-1652                 PIC X(4)    VALUE '1652'.
   567     12  ER-1653                 PIC X(4)    VALUE '1653'.
   568     12  ER-1654                 PIC X(4)    VALUE '1654'.
   569     12  ER-1655                 PIC X(4)    VALUE '1655'.
   570     12  er-1656                 pic x(4)    value '1656'.
   571     12  ER-1661                 PIC X(4)    VALUE '1661'.
   572     12  ER-1662                 PIC X(4)    VALUE '1662'.
   573     12  ER-1773                 PIC X(4)    VALUE '1773'.
   574     12  ER-2280                 PIC X(4)    VALUE '2280'.
   575     12  ER-2878                 PIC X(4)    VALUE '2878'.
   576     12  ER-7641                 PIC X(4)    VALUE '7641'.
   577     12  ER-7642                 PIC X(4)    VALUE '7642'.
   578     12  ER-7650                 PIC X(4)    VALUE '7650'.
   579     12  ER-7651                 PIC X(4)    VALUE '7651'.
   580     12  ER-7687                 PIC X(4)    VALUE '7687'.
   581     12  ER-7689                 PIC X(4)    VALUE '7689'.
   582     12  ER-7690                 PIC X(4)    VALUE '7690'.
   583     12  ER-7691                 PIC X(4)    VALUE '7691'.
   584     12  ER-8003                 PIC X(4)    VALUE '8003'.
   585     12  ER-8051                 PIC X(4)    VALUE '8051'.
   586     12  ER-8052                 PIC X(4)    VALUE '8052'.
   587     12  ER-8053                 PIC X(4)    VALUE '8053'.
   588     12  ER-8054                 PIC X(4)    VALUE '8054'.
   589     12  ER-8055                 PIC X(4)    VALUE '8055'.
   590     12  ER-8056                 PIC X(4)    VALUE '8056'.
   591     12  ER-8057                 PIC X(4)    VALUE '8057'.
   592     12  ER-8058                 PIC X(4)    VALUE '8058'.
   593     12  ER-8059                 PIC X(4)    VALUE '8059'.
   594     12  ER-8060                 PIC X(4)    VALUE '8060'.
   595     12  ER-8061                 PIC X(4)    VALUE '8061'.
   596     12  ER-8062                 PIC X(4)    VALUE '8062'.
   597     12  ER-8063                 PIC X(4)    VALUE '8063'.
   598     12  ER-8064                 PIC X(4)    VALUE '8064'.
   599     12  ER-8065                 PIC X(4)    VALUE '8065'.
   600     12  ER-8066                 PIC X(4)    VALUE '8066'.
   601     12  ER-8152                 PIC X(4)    VALUE '8152'.
   602     12  ER-8153                 PIC X(4)    VALUE '8153'.
   603     12  ER-8154                 PIC X(4)    VALUE '8154'.
   604     12  ER-8155                 PIC X(4)    VALUE '8155'.
   605 01  ERPDEF-KEY-SAVE             PIC X(18).
   606 01  ERPDEF-KEY.
   607     12  ERPDEF-COMPANY-CD       PIC X.
   608     12  ERPDEF-STATE            PIC XX.
   609     12  ERPDEF-PROD-CD          PIC XXX.
   610     12  F                       PIC X(7).
   611     12  ERPDEF-BEN-TYPE         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  14
* EL131.cbl
   612     12  ERPDEF-BEN-CODE         PIC XX.
   613     12  ERPDEF-EXP-DT           PIC XX.
   614 01  MSTR-KEY.
   615     12  COMPANY-CODE            PIC X.
   616     12  CARRIER-CODE            PIC X.
   617     12  CLAIM-NO                PIC X(7).
   618     12  CERT-NO.
   619         16  CERT-NO-PRIME       PIC X(10).
   620         16  CERT-NO-SUFX        PIC X.
   621
   622 01  WS-SAVE-CLAIM-KEY.
   623     12  WS-SAVE-COMPANY-CD      PIC X.
   624     12  WS-SAVE-CARRIER         PIC X.
   625     12  WS-SAVE-CLAIM-NO        PIC X(7).
   626     12  WS-SAVE-CERT-NO.
   627         16  WS-CERT-NO-PRIME    PIC X(10).
   628         16  WS-CERT-NO-SUFX     PIC X.
   629
   630 01  CERT-KEY.
   631     12  CERT-COMPANY-CODE       PIC X.
   632     12  CERT-CARRIER            PIC X.
   633     12  CERT-GROUP              PIC X(6).
   634     12  CERT-STATE              PIC XX.
   635     12  CERT-ACCOUNT            PIC X(10).
   636     12  CERT-DATE               PIC XX.
   637     12  CERT-CERT.
   638         16  CERT-CERT-PRIME     PIC X(10).
   639         16  CERT-CERT-SUFX      PIC X.
   640
   641 01  ELCRTT-KEY.
   642     05  CTRLR-COMP-CD       PIC X.
   643     05  CTRLR-CARRIER       PIC X.
   644     05  CTRLR-GROUPING      PIC X(6).
   645     05  CTRLR-STATE         PIC X(2).
   646     05  CTRLR-ACCOUNT       PIC X(10).
   647     05  CTRLR-EFF-DT        PIC XX.
   648     05  CTRLR-CERT-NO       PIC X(11).
   649     05  CTRLR-REC-TYPE      PIC X.
   650 01  NOTE-KEY.
   651     12  NOTE-COMP-CD            PIC X.
   652     12  NOTE-CERT-KEY.
   653         16  NOTE-CARRIER        PIC X.
   654         16  NOTE-GROUP          PIC X(6).
   655         16  NOTE-STATE          PIC XX.
   656         16  NOTE-ACCOUNT        PIC X(10).
   657         16  NOTE-DATE           PIC XX.
   658         16  NOTE-CERT-NO        PIC X(11).
   659
   660 01  TRLR-KEY.
   661     12  TRLR-MAIN-KEY.
   662         16  TRLR-COMPANY-CD     PIC X.
   663         16  TRLR-CARRIER        PIC X.
   664         16  TRLR-CLAIM-NO       PIC X(07).
   665         16  TRLR-CERT-NO        PIC X(11).
   666     12  TRLR-SEQ-NO             PIC S9(4)   COMP.
   667
   668 01  BENEFIT-KEY.
   669     12  BEN-CO-ID               PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  15
* EL131.cbl
   670     12  BEN-REC-TYPE            PIC X.
   671     12  FILLER                  PIC XX.
   672     12  BEN-ACC-CD              PIC XX.
   673     12  BEN-SEQ-NO              PIC S9(4)   COMP.
   674
   675 01  CNTL-KEY.
   676     12  CNTL-CO-ID              PIC X(3).
   677     12  CNTL-REC-TYPE           PIC X.
   678     12  CNTL-PROC-ID            PIC X(4).
   679     12  CNTL-STATE-ACCESS REDEFINES CNTL-PROC-ID.
   680         16  CNTL-STATE-NUMBER   PIC XX.
   681         16  FILLER              PIC XX.
   682     12  CNTL-CARRIER-ACCESS REDEFINES CNTL-PROC-ID.
   683         16  FILLER              PIC X(3).
   684         16  CNTL-CARRIER        PIC X.
   685     12  CNTL-SEQ-NO             PIC S9(4)   COMP.
   686
   687 01  ACTQ-KEY                    PIC X(20).
   688
   689 01  WS-LAST-TRLR-KEY            PIC X(22)  VALUE SPACES.
   690
   691 01  CHKQ-KEY.
   692     12  CHKQ-COMPANY-CODE       PIC X.
   693     12  CHKQ-CONTROL-NO         PIC S9(8)  COMP.
   694     12  CHKQ-SEQ-NO             PIC S9(4)  COMP.
   695
   696 01  ARCH-KEY.
   697     12  ARCH-COMPANY-CODE       PIC X.
   698     12  ARCH-ARCHIVE-NO         PIC S9(8)  COMP.
   699     12  ARCH-RECORD-TYPE        PIC X.
   700     12  ARCH-SEQ-NO             PIC S9(4)  COMP.
   701
   702 01  ACCT-KEY.
   703     05  ACCT-PARTIAL-KEY.
   704         12  ACCT-COMPANY-CODE   PIC X.
   705         12  ACCT-CARRIER        PIC X.
   706         12  ACCT-GROUP          PIC X(6).
   707         12  ACCT-STATE          PIC XX.
   708         12  ACCT-ACCOUNT        PIC X(10).
   709     05  ACCT-DATE               PIC XX.
   710
   711 01  WS-ELBENE-KEY.
   712     12  WS-ELBENE-COMPANY-CD    PIC X.
   713     12  WS-ELBENE-RECORD-TYPE   PIC X.
   714     12  WS-ELBENE-ID            PIC X(10).
   715
   716 01  ELALPH-KEY.
   717     12  ELALPH-COMPANY-CD       PIC X.
   718     12  ELALPH-SOURCE           PIC X.
   719     12  ELALPH-NAME.
   720         16  ELALPH-LAST-NAME    PIC X(15).
   721         16  ELALPH-FIRST-NAME.
   722             20  ELALPH-FIRST-INIT   PIC X.
   723             20  FILLER              PIC X(11).
   724         16  ELALPH-MIDDLE-INIT  PIC X.
   725     12  ELALPH-DATE             PIC X(08).
   726     12  ELALPH-TIME             PIC S9(04)    COMP.
   727
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  16
* EL131.cbl
   728 01  COMP-LENGTHS.
   729     12  CNTL-GENERIC-LENGTH     PIC S9(4)   COMP VALUE +8.
   730     12  JOURNAL-LENGTH          PIC S9(4)   COMP VALUE +0.
   731     12  DATE-LENGTH             PIC S9(4)   COMP VALUE +8.
   732     12  MO-YR-LENGTH            PIC S9(4)   COMP VALUE +5.
   733     12  TERM-LENGTH             PIC S9(4)   COMP VALUE +3.
   734     12  BEN-LENGTH              PIC S9(4)   COMP VALUE +11.
   735     12  FREQ-LENGTH             PIC S9(4)   COMP VALUE +2.
   736     12  MSTR-LENGTH             PIC S9(4)   COMP VALUE +350.
   737     12  CERT-LENGTH             PIC S9(4)   COMP VALUE +450.
   738     12  TRLR-LENGTH             PIC S9(4)   COMP VALUE +200.
   739     12  ACTQ-LENGTH             PIC S9(4)   COMP VALUE +60.
   740     12  CHKQ-LENGTH             PIC S9(4)   COMP VALUE +100.
   741     12  ARCH-LENGTH             PIC S9(4)   COMP VALUE +90.
   742     12  ALPH-LENGTH             PIC S9(4)   COMP VALUE +128.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  17
* EL131.cbl
   744*                                COPY ELCLNKLT.
   745******************************************************************
   746*                                                                *
   747*                                                                *
   748*                           ELCLNKLT                             *
   749*                            VMOD=2.003                          *
   750*                                                                *
   751*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   752*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   753*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   754*                                                                *
   755*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   756*   COMPLETING THE REQUIRED FIELDS.                              *
   757*                                                                *
   758*   THE CALLING PROGRAM SHOULD CHECK:                            *
   759*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   760*                              9999 INDICATES AN UNKNOWN ABEND   *
   761*                                   WAS DETECTED.                *
   762*                              ALL OTHER VALUES ARE NORMAL ERROR *
   763*                              CODES FOUND IN THE ERROR FILE.    *
   764******************************************************************
   765 01  W-1523-LINKDATA.
   766     12  W-1523-COMMON-PI-DATA.
   767         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   768         16  FILLER              PIC  X(67).
   769         16  W-1523-COMPANY-CD   PIC  X(01).
   770         16  FILLER              PIC  X(10).
   771         16  W-1523-CONTROL-IN-PROGRESS.
   772             20  W-1523-CARRIER  PIC  X(01).
   773             20  W-1523-GROUPING PIC  X(06).
   774             20  W-1523-STATE    PIC  X(02).
   775             20  W-1523-ACCOUNT  PIC  X(10).
   776             20  W-1523-CLAIM-CERT-GRP.
   777                 24  W-1523-CLAIM-NO
   778                                 PIC  X(07).
   779                 24  W-1523-CERT-NO.
   780                     28  W-1523-CERT-PRIME
   781                                 PIC  X(10).
   782                     28  W-1523-CERT-SFX
   783                                 PIC  X(01).
   784                 24  W-1523-CERT-EFF-DT
   785                                 PIC  X(02).
   786         16  FILLER              PIC X(265).
   787
   788     12  W-1523-WORK-AREA.
   789         16  W-1523-FORM-NUMBER  PIC  X(04).
   790         16  W-1523-NUMBER-COPIES
   791                                 PIC  9(01).
   792         16  W-1523-ADDR-TYPE    PIC  X(02).
   793         16  W-1523-FOLLOW-UP-DATE
   794                                 PIC  X(02).
   795         16  W-1523-RESEND-DATE  PIC  X(02).
   796         16  W-1523-ERROR-CODE   PIC  9(04).
   797             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   798             88  W-1523-FATAL-ERROR
   799                                    VALUES  0006 0013 0042
   800                                            0154 0168 0169
   801                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  18
* EL131.cbl
   802                                            0179 0186 0281
   803                                            0332 2055 3697
   804                                            3698 3699 3770
   805                                            3771 3772 7675
   806                                            9106 9808 9883
   807                                            9887.
   808             88  W-1523-STOP-ERRORS
   809                                    VALUES  0013 0042 0154
   810                                            0168 0169 0172
   811                                            0281 0332 2055
   812                                            3698 3699 7675
   813                                            9106 9808 9883
   814                                            9999.
   815         16  W-1523-REASON       PIC  X(70).
   816         16  W-1523-ARCHIVE-NUMBER
   817                                 PIC  9(08).
   818     12  W-1523-POINTER-AREA.
   819         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   820         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   821         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   822         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   823         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  19
* EL131.cbl
   825*                                COPY ELCINTF.
   826******************************************************************
   827*                                                                *
   828*                                                                *
   829*                            ELCINTF.                            *
   830*                            VMOD=2.017                          *
   831*                                                                *
   832*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   833*                                                                *
   834*       LENGTH = 1024                                            *
   835*                                                                *
   836******************************************************************
   837*                   C H A N G E   L O G
   838*
   839* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   840*-----------------------------------------------------------------
   841*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   842* EFFECTIVE    NUMBER
   843*-----------------------------------------------------------------
   844* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   845******************************************************************
   846 01  PROGRAM-INTERFACE-BLOCK.
   847     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   848     12  PI-CALLING-PROGRAM              PIC X(8).
   849     12  PI-SAVED-PROGRAM-1              PIC X(8).
   850     12  PI-SAVED-PROGRAM-2              PIC X(8).
   851     12  PI-SAVED-PROGRAM-3              PIC X(8).
   852     12  PI-SAVED-PROGRAM-4              PIC X(8).
   853     12  PI-SAVED-PROGRAM-5              PIC X(8).
   854     12  PI-SAVED-PROGRAM-6              PIC X(8).
   855     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   856     12  PI-COMPANY-ID                   PIC XXX.
   857     12  PI-COMPANY-CD                   PIC X.
   858
   859     12  PI-COMPANY-PASSWORD             PIC X(8).
   860
   861     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   862
   863     12  PI-CONTROL-IN-PROGRESS.
   864         16  PI-CARRIER                  PIC X.
   865         16  PI-GROUPING                 PIC X(6).
   866         16  PI-STATE                    PIC XX.
   867         16  PI-ACCOUNT                  PIC X(10).
   868         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   869                                         PIC X(10).
   870         16  PI-CLAIM-CERT-GRP.
   871             20  PI-CLAIM-NO             PIC X(7).
   872             20  PI-CERT-NO.
   873                 25  PI-CERT-PRIME       PIC X(10).
   874                 25  PI-CERT-SFX         PIC X.
   875             20  PI-CERT-EFF-DT          PIC XX.
   876         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   877             20  PI-PLAN-CODE            PIC X(2).
   878             20  PI-REVISION-NUMBER      PIC X(3).
   879             20  PI-PLAN-EFF-DT          PIC X(2).
   880             20  PI-PLAN-EXP-DT          PIC X(2).
   881             20  FILLER                  PIC X(11).
   882         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  20
* EL131.cbl
   883             20  PI-OE-REFERENCE-1.
   884                 25  PI-OE-REF-1-PRIME   PIC X(18).
   885                 25  PI-OE-REF-1-SUFF    PIC XX.
   886
   887     12  PI-SESSION-IN-PROGRESS          PIC X.
   888         88  CLAIM-SESSION                   VALUE '1'.
   889         88  CREDIT-SESSION                  VALUE '2'.
   890         88  WARRANTY-SESSION                VALUE '3'.
   891         88  MORTGAGE-SESSION                VALUE '4'.
   892         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   893
   894
   895*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   896
   897     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   898     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   899
   900     12  PI-CREDIT-USER                  PIC X.
   901         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   902         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   903
   904     12  PI-CLAIM-USER                   PIC X.
   905         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   906         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   907
   908     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   909         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   910         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   911         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   912         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   913         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   914
   915     12  PI-PROCESSOR-ID                 PIC X(4).
   916
   917     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   918
   919     12  PI-MEMBER-CAPTION               PIC X(10).
   920
   921     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   922         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   923
   924     12  PI-LIFE-OVERRIDE-L1             PIC X.
   925     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   926     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   927     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   928
   929     12  PI-AH-OVERRIDE-L1               PIC X.
   930     12  PI-AH-OVERRIDE-L2               PIC XX.
   931     12  PI-AH-OVERRIDE-L6               PIC X(6).
   932     12  PI-AH-OVERRIDE-L12              PIC X(12).
   933
   934     12  PI-NEW-SYSTEM                   PIC X(2).
   935
   936     12  PI-PRIMARY-CERT-NO              PIC X(11).
   937     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   938         88  PI-USES-PAID-TO                 VALUE '1'.
   939     12  PI-CRDTCRD-SYSTEM.
   940         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  21
* EL131.cbl
   941             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   942             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   943         16  PI-CC-MONTH-END-DT          PIC XX.
   944     12  PI-PROCESSOR-PRINTER            PIC X(4).
   945
   946     12  PI-OE-REFERENCE-2.
   947         16  PI-OE-REF-2-PRIME           PIC X(10).
   948         16  PI-OE-REF-2-SUFF            PIC X.
   949
   950     12  PI-REM-TRM-CALC-OPTION          PIC X.
   951
   952     12  PI-LANGUAGE-TYPE                PIC X.
   953             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   954             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   955             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   956
   957     12  PI-POLICY-LINKAGE-IND           PIC X.
   958         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   959         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   960                                                   LOW-VALUES.
   961
   962     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   963     12  PI-CLAIM-PW-SESSION             PIC X(1).
   964         88  PI-CLAIM-CREDIT                 VALUE '1'.
   965         88  PI-CLAIM-CONVEN                 VALUE '2'.
   966
   967     12  PI-PROCESSOR-CSR-IND            PIC X.
   968         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   969         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   970
   971     12  FILLER                          PIC X(3).
   972
   973     12  PI-SYSTEM-LEVEL                 PIC X(145).
   974
   975     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   976         PI-SYSTEM-LEVEL.
   977
   978         16  PI-ENTRY-CODES.
   979             20  PI-ENTRY-CD-1           PIC X.
   980             20  PI-ENTRY-CD-2           PIC X.
   981
   982         16  PI-RETURN-CODES.
   983             20  PI-RETURN-CD-1          PIC X.
   984             20  PI-RETURN-CD-2          PIC X.
   985
   986         16  PI-UPDATE-STATUS-SAVE.
   987             20  PI-UPDATE-BY            PIC X(4).
   988             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   989
   990         16  PI-LOWER-CASE-LETTERS       PIC X.
   991             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   992
   993*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   994*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   995*            88  CARRIER-CLM-CNTL            VALUE '2'.
   996
   997         16  PI-CERT-ACCESS-CONTROL      PIC X.
   998             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  22
* EL131.cbl
   999             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1000             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1001             88  ACCNT-CNTL                  VALUE '3'.
  1002             88  CARR-ACCNT-CNTL             VALUE '4'.
  1003
  1004         16  PI-PROCESSOR-CAP-LIST.
  1005             20  PI-SYSTEM-CONTROLS.
  1006                24 PI-SYSTEM-DISPLAY     PIC X.
  1007                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1008                24 PI-SYSTEM-MODIFY      PIC X.
  1009                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1010             20  FILLER                  PIC XX.
  1011             20  PI-DISPLAY-CAP          PIC X.
  1012                 88  DISPLAY-CAP             VALUE 'Y'.
  1013             20  PI-MODIFY-CAP           PIC X.
  1014                 88  MODIFY-CAP              VALUE 'Y'.
  1015             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1016                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1017             20  PI-FORCE-CAP            PIC X.
  1018                 88  FORCE-CAP               VALUE 'Y'.
  1019
  1020         16  PI-PROGRAM-CONTROLS.
  1021             20  PI-PGM-PRINT-OPT        PIC X.
  1022             20  PI-PGM-FORMAT-OPT       PIC X.
  1023             20  PI-PGM-PROCESS-OPT      PIC X.
  1024             20  PI-PGM-TOTALS-OPT       PIC X.
  1025
  1026         16  PI-HELP-INTERFACE.
  1027             20  PI-LAST-ERROR-NO        PIC X(4).
  1028             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1029
  1030         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1031             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1032
  1033         16  PI-CR-CONTROL-IN-PROGRESS.
  1034             20  PI-CR-CARRIER           PIC X.
  1035             20  PI-CR-GROUPING          PIC X(6).
  1036             20  PI-CR-STATE             PIC XX.
  1037             20  PI-CR-ACCOUNT           PIC X(10).
  1038             20  PI-CR-FIN-RESP          PIC X(10).
  1039             20  PI-CR-TYPE              PIC X.
  1040
  1041         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1042
  1043         16  PI-CR-MONTH-END-DT          PIC XX.
  1044
  1045         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1046             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1047             88  PI-ZERO-CARRIER             VALUE '1'.
  1048             88  PI-ZERO-GROUPING            VALUE '2'.
  1049             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1050
  1051         16  PI-CARRIER-SECURITY         PIC X.
  1052             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1053
  1054         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1055             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1056             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  23
* EL131.cbl
  1057
  1058         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1059             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1060                                         INDEXED BY PI-ACCESS-NDX
  1061                                         PIC X.
  1062
  1063         16  PI-GA-BILLING-CONTROL       PIC X.
  1064             88  PI-GA-BILLING               VALUE '1'.
  1065
  1066         16  PI-MAIL-PROCESSING          PIC X.
  1067             88  PI-MAIL-YES                 VALUE 'Y'.
  1068
  1069         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1070
  1071         16  PI-AR-SYSTEM.
  1072             20  PI-AR-PROCESSING-CNTL   PIC X.
  1073                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1074             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1075             20  PI-AR-MONTH-END-DT      PIC XX.
  1076
  1077         16  PI-MP-SYSTEM.
  1078             20  PI-MORTGAGE-USER            PIC X.
  1079                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1080                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1081             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1082                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1083                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1084                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1085                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1086                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1087             20  PI-MP-MONTH-END-DT          PIC XX.
  1088             20  PI-MP-REFERENCE-NO.
  1089                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1090                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1091
  1092         16  PI-LABEL-CONTROL            PIC X(01).
  1093             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1094             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1095
  1096         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1097             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1098
  1099         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1100             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1101             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1102
  1103         16  FILLER                      PIC X(14).
  1104
  1105     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1106******************************************************************
  1107     12  EL131-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
  1108         16  PI-NO-PMTS                    PIC 9(4).
  1109         16  PI-CERT-SWITCH                PIC X.
  1110             88  CREATED-CERT              VALUE '2'.
  1111         16  PI-PREM-TYPE                  PIC X.
  1112         16  PI-SAVE-CERT-NO.
  1113             20  PI-SAVE-CERT-NO-PRIME     PIC X(10).
  1114             20  PI-SAVE-CERT-NO-SUFX      PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  24
* EL131.cbl
  1115         16  FILLER                        PIC X(46).
  1116         16  PI-CLAIM-DELETED-SWITCH       PIC X(1).
  1117         16  PI-PAYMENT-AMT                PIC S9(7)V99   COMP-3.
  1118         16  PI-REC-FOUND-SW               PIC X.
  1119         16  PI-LETTER-SW                  PIC X.
  1120         16  PI-PREV-TRLR-KEY              PIC X(22).
  1121         16  pi-claim-type                 pic x.
  1122         16  PI-AUTO-PAY-SEQ               PIC S9(4)      COMP.
  1123         16  FILLER                        PIC X(544).
  1124
  1125 01  SAVE-RECORD                 PIC X(450).
  1126
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  25
* EL131.cbl
  1128*                                COPY ELCLOGOF SUPPRESS.
  1129******************************************************************
  1130*                                                                *
  1131*                                                                *
  1132*                            ELCLOGOF.                           *
  1133*                            VMOD=2.001                          *
  1134*                                                                *
  1135*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1136*                                                                *
  1137******************************************************************
  1138 01  CLASIC-LOGOFF.
  1139     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1140     12  LOGOFF-TEXT.
  1141         16  FILLER          PIC X(5)    VALUE SPACES.
  1142         16  LOGOFF-MSG.
  1143             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1144             20  FILLER      PIC X       VALUE SPACES.
  1145             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1146         16  FILLER          PIC X(80)
  1147           VALUE '* YOU ARE NOW LOGGED OFF'.
  1148         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1149         16  FILLER          PIC X       VALUE QUOTE.
  1150         16  LOGOFF-SYS-MSG  PIC X(17)
  1151           VALUE 'S CLAS-IC SYSTEM '.
  1152     12  TEXT-MESSAGES.
  1153         16  UNACCESS-MSG    PIC X(29)
  1154             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1155         16  PGMIDERR-MSG    PIC X(17)
  1156             VALUE 'PROGRAM NOT FOUND'.
  1157
  1158*                                COPY ELCATTR SUPPRESS.
  1159******************************************************************
  1160*                                                                *
  1161*                            ELCATTR.                            *
  1162*                            VMOD=2.001                          *
  1163*                                                                *
  1164*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1165*                                                                *
  1166*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1167*                                                                *
  1168*                   POS 1   P=PROTECTED                          *
  1169*                           U=UNPROTECTED                        *
  1170*                           S=ASKIP                              *
  1171*                   POS 2   A=ALPHA/NUMERIC                      *
  1172*                           N=NUMERIC                            *
  1173*                   POS 3   N=NORMAL                             *
  1174*                           B=BRIGHT                             *
  1175*                           D=DARK                               *
  1176*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1177*                           OF=MODIFIED DATA TAG OFF             *
  1178*                                                                *
  1179*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1180******************************************************************
  1181 01  ATTRIBUTE-LIST.
  1182     12  AL-PABOF            PIC X       VALUE 'Y'.
  1183     12  AL-PABON            PIC X       VALUE 'Z'.
  1184     12  AL-PADOF            PIC X       VALUE '%'.
  1185     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  26
* EL131.cbl
  1186     12  AL-PANOF            PIC X       VALUE '-'.
  1187     12  AL-PANON            PIC X       VALUE '/'.
  1188     12  AL-SABOF            PIC X       VALUE '8'.
  1189     12  AL-SABON            PIC X       VALUE '9'.
  1190     12  AL-SADOF            PIC X       VALUE '@'.
  1191     12  AL-SADON            PIC X       VALUE QUOTE.
  1192     12  AL-SANOF            PIC X       VALUE '0'.
  1193     12  AL-SANON            PIC X       VALUE '1'.
  1194     12  AL-UABOF            PIC X       VALUE 'H'.
  1195     12  AL-UABON            PIC X       VALUE 'I'.
  1196     12  AL-UADOF            PIC X       VALUE '<'.
  1197     12  AL-UADON            PIC X       VALUE '('.
  1198     12  AL-UANOF            PIC X       VALUE ' '.
  1199     12  AL-UANON            PIC X       VALUE 'A'.
  1200     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1201     12  AL-UNBON            PIC X       VALUE 'R'.
  1202     12  AL-UNDOF            PIC X       VALUE '*'.
  1203     12  AL-UNDON            PIC X       VALUE ')'.
  1204     12  AL-UNNOF            PIC X       VALUE '&'.
  1205     12  AL-UNNON            PIC X       VALUE 'J'.
  1206
  1207*                                COPY ELCAID SUPPRESS.
  1208******************************************************************
  1209*                                                                *
  1210*                            ELCAID.                             *
  1211*                            VMOD=2.001                          *
  1212*                                                                *
  1213*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1214*                                                                *
  1215*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1216*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1217******************************************************************
  1218
  1219 01  DFHAID.
  1220   02  DFHNULL   PIC  X  VALUE  ' '.
  1221   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1222   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1223   02  DFHPEN    PIC  X  VALUE  '='.
  1224   02  DFHOPID   PIC  X  VALUE  'W'.
  1225   02  DFHPA1    PIC  X  VALUE  '%'.
  1226   02  DFHPA2    PIC  X  VALUE  '>'.
  1227   02  DFHPA3    PIC  X  VALUE  ','.
  1228   02  DFHPF1    PIC  X  VALUE  '1'.
  1229   02  DFHPF2    PIC  X  VALUE  '2'.
  1230   02  DFHPF3    PIC  X  VALUE  '3'.
  1231   02  DFHPF4    PIC  X  VALUE  '4'.
  1232   02  DFHPF5    PIC  X  VALUE  '5'.
  1233   02  DFHPF6    PIC  X  VALUE  '6'.
  1234   02  DFHPF7    PIC  X  VALUE  '7'.
  1235   02  DFHPF8    PIC  X  VALUE  '8'.
  1236   02  DFHPF9    PIC  X  VALUE  '9'.
  1237   02  DFHPF10   PIC  X  VALUE  ':'.
  1238   02  DFHPF11   PIC  X  VALUE  '#'.
  1239   02  DFHPF12   PIC  X  VALUE  '@'.
  1240   02  DFHPF13   PIC  X  VALUE  'A'.
  1241   02  DFHPF14   PIC  X  VALUE  'B'.
  1242   02  DFHPF15   PIC  X  VALUE  'C'.
  1243   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  27
* EL131.cbl
  1244   02  DFHPF17   PIC  X  VALUE  'E'.
  1245   02  DFHPF18   PIC  X  VALUE  'F'.
  1246   02  DFHPF19   PIC  X  VALUE  'G'.
  1247   02  DFHPF20   PIC  X  VALUE  'H'.
  1248   02  DFHPF21   PIC  X  VALUE  'I'.
  1249*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1250   02  DFHPF22   PIC  X  VALUE  '['.
  1251   02  DFHPF23   PIC  X  VALUE  '.'.
  1252   02  DFHPF24   PIC  X  VALUE  '<'.
  1253   02  DFHMSRE   PIC  X  VALUE  'X'.
  1254   02  DFHSTRF   PIC  X  VALUE  'h'.
  1255   02  DFHTRIG   PIC  X  VALUE  '"'.
  1256 01  FILLER REDEFINES DFHAID.
  1257     12  FILLER                  PIC X(8).
  1258     12  AID-KEYS OCCURS 24 TIMES.
  1259         16  FILLER              PIC X.
  1260
  1261*                                COPY EL131S.
  1262 01  EL131AI.
  1263     05  FILLER            PIC  X(0012).
  1264*    -------------------------------
  1265     05  DATEL PIC S9(0004) COMP.
  1266     05  DATEF PIC  X(0001).
  1267     05  FILLER REDEFINES DATEF.
  1268         10  DATEA PIC  X(0001).
  1269     05  DATEI PIC  X(0008).
  1270*    -------------------------------
  1271     05  TIMEL PIC S9(0004) COMP.
  1272     05  TIMEF PIC  X(0001).
  1273     05  FILLER REDEFINES TIMEF.
  1274         10  TIMEA PIC  X(0001).
  1275     05  TIMEI PIC  X(0005).
  1276*    -------------------------------
  1277     05  SEQUL PIC S9(0004) COMP.
  1278     05  SEQUF PIC  X(0001).
  1279     05  FILLER REDEFINES SEQUF.
  1280         10  SEQUA PIC  X(0001).
  1281     05  SEQUI PIC  X(0010).
  1282*    -------------------------------
  1283     05  COMPL PIC S9(0004) COMP.
  1284     05  COMPF PIC  X(0001).
  1285     05  FILLER REDEFINES COMPF.
  1286         10  COMPA PIC  X(0001).
  1287     05  COMPI PIC  X(0003).
  1288*    -------------------------------
  1289     05  USERIDL PIC S9(0004) COMP.
  1290     05  USERIDF PIC  X(0001).
  1291     05  FILLER REDEFINES USERIDF.
  1292         10  USERIDA PIC  X(0001).
  1293     05  USERIDI PIC  X(0004).
  1294*    -------------------------------
  1295     05  CCNOL PIC S9(0004) COMP.
  1296     05  CCNOF PIC  X(0001).
  1297     05  FILLER REDEFINES CCNOF.
  1298         10  CCNOA PIC  X(0001).
  1299     05  CCNOI PIC  X(0016).
  1300*    -------------------------------
  1301     05  MAINTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  28
* EL131.cbl
  1302     05  MAINTF PIC  X(0001).
  1303     05  FILLER REDEFINES MAINTF.
  1304         10  MAINTA PIC  X(0001).
  1305     05  MAINTI PIC  X(0001).
  1306*    -------------------------------
  1307     05  CLAIML PIC S9(0004) COMP.
  1308     05  CLAIMF PIC  X(0001).
  1309     05  FILLER REDEFINES CLAIMF.
  1310         10  CLAIMA PIC  X(0001).
  1311     05  CLAIMI PIC  X(0007).
  1312*    -------------------------------
  1313     05  CARRL PIC S9(0004) COMP.
  1314     05  CARRF PIC  X(0001).
  1315     05  FILLER REDEFINES CARRF.
  1316         10  CARRA PIC  X(0001).
  1317     05  CARRI PIC  X(0001).
  1318*    -------------------------------
  1319     05  CERTL PIC S9(0004) COMP.
  1320     05  CERTF PIC  X(0001).
  1321     05  FILLER REDEFINES CERTF.
  1322         10  CERTA PIC  X(0001).
  1323     05  CERTI PIC  X(0010).
  1324*    -------------------------------
  1325     05  SUFXL PIC S9(0004) COMP.
  1326     05  SUFXF PIC  X(0001).
  1327     05  FILLER REDEFINES SUFXF.
  1328         10  SUFXA PIC  X(0001).
  1329     05  SUFXI PIC  X(0001).
  1330*    -------------------------------
  1331     05  TYPEL PIC S9(0004) COMP.
  1332     05  TYPEF PIC  X(0001).
  1333     05  FILLER REDEFINES TYPEF.
  1334         10  TYPEA PIC  X(0001).
  1335     05  TYPEI PIC  X(0001).
  1336*    -------------------------------
  1337     05  LABEL1L PIC S9(0004) COMP.
  1338     05  LABEL1F PIC  X(0001).
  1339     05  FILLER REDEFINES LABEL1F.
  1340         10  LABEL1A PIC  X(0001).
  1341     05  LABEL1I PIC  X(0011).
  1342*    -------------------------------
  1343     05  PCERTNOL PIC S9(0004) COMP.
  1344     05  PCERTNOF PIC  X(0001).
  1345     05  FILLER REDEFINES PCERTNOF.
  1346         10  PCERTNOA PIC  X(0001).
  1347     05  PCERTNOI PIC  X(0010).
  1348*    -------------------------------
  1349     05  PSUFXL PIC S9(0004) COMP.
  1350     05  PSUFXF PIC  X(0001).
  1351     05  FILLER REDEFINES PSUFXF.
  1352         10  PSUFXA PIC  X(0001).
  1353     05  PSUFXI PIC  X(0001).
  1354*    -------------------------------
  1355     05  STATUSL PIC S9(0004) COMP.
  1356     05  STATUSF PIC  X(0001).
  1357     05  FILLER REDEFINES STATUSF.
  1358         10  STATUSA PIC  X(0001).
  1359     05  STATUSI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  29
* EL131.cbl
  1360*    -------------------------------
  1361     05  INCL PIC S9(0004) COMP.
  1362     05  INCF PIC  X(0001).
  1363     05  FILLER REDEFINES INCF.
  1364         10  INCA PIC  X(0001).
  1365     05  INCI PIC  X(0008).
  1366*    -------------------------------
  1367     05  REPL PIC S9(0004) COMP.
  1368     05  REPF PIC  X(0001).
  1369     05  FILLER REDEFINES REPF.
  1370         10  REPA PIC  X(0001).
  1371     05  REPI PIC  X(0008).
  1372*    -------------------------------
  1373     05  CAUSEL PIC S9(0004) COMP.
  1374     05  CAUSEF PIC  X(0001).
  1375     05  FILLER REDEFINES CAUSEF.
  1376         10  CAUSEA PIC  X(0001).
  1377     05  CAUSEI PIC  X(0006).
  1378*    -------------------------------
  1379     05  ENDL PIC S9(0004) COMP.
  1380     05  ENDF PIC  X(0001).
  1381     05  FILLER REDEFINES ENDF.
  1382         10  ENDA PIC  X(0001).
  1383     05  ENDI PIC  X(0008).
  1384*    -------------------------------
  1385     05  DIAGL PIC S9(0004) COMP.
  1386     05  DIAGF PIC  X(0001).
  1387     05  FILLER REDEFINES DIAGF.
  1388         10  DIAGA PIC  X(0001).
  1389     05  DIAGI PIC  X(0060).
  1390*    -------------------------------
  1391     05  ACCSWL PIC S9(0004) COMP.
  1392     05  ACCSWF PIC  X(0001).
  1393     05  FILLER REDEFINES ACCSWF.
  1394         10  ACCSWA PIC  X(0001).
  1395     05  ACCSWI PIC  X(0001).
  1396*    -------------------------------
  1397     05  BENEL PIC S9(0004) COMP.
  1398     05  BENEF PIC  X(0001).
  1399     05  FILLER REDEFINES BENEF.
  1400         10  BENEA PIC  X(0001).
  1401     05  BENEI PIC  X(0010).
  1402*    -------------------------------
  1403     05  BIRTHL PIC S9(0004) COMP.
  1404     05  BIRTHF PIC  X(0001).
  1405     05  FILLER REDEFINES BIRTHF.
  1406         10  BIRTHA PIC  X(0001).
  1407     05  BIRTHI PIC  X(0008).
  1408*    -------------------------------
  1409     05  SOCIALL PIC S9(0004) COMP.
  1410     05  SOCIALF PIC  X(0001).
  1411     05  FILLER REDEFINES SOCIALF.
  1412         10  SOCIALA PIC  X(0001).
  1413     05  SOCIALI PIC  X(0011).
  1414*    -------------------------------
  1415     05  SEXL PIC S9(0004) COMP.
  1416     05  SEXF PIC  X(0001).
  1417     05  FILLER REDEFINES SEXF.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  30
* EL131.cbl
  1418         10  SEXA PIC  X(0001).
  1419     05  SEXI PIC  X(0001).
  1420*    -------------------------------
  1421     05  MLNAMEL PIC S9(0004) COMP.
  1422     05  MLNAMEF PIC  X(0001).
  1423     05  FILLER REDEFINES MLNAMEF.
  1424         10  MLNAMEA PIC  X(0001).
  1425     05  MLNAMEI PIC  X(0015).
  1426*    -------------------------------
  1427     05  MFNAMEL PIC S9(0004) COMP.
  1428     05  MFNAMEF PIC  X(0001).
  1429     05  FILLER REDEFINES MFNAMEF.
  1430         10  MFNAMEA PIC  X(0001).
  1431     05  MFNAMEI PIC  X(0012).
  1432*    -------------------------------
  1433     05  MMINITL PIC S9(0004) COMP.
  1434     05  MMINITF PIC  X(0001).
  1435     05  FILLER REDEFINES MMINITF.
  1436         10  MMINITA PIC  X(0001).
  1437     05  MMINITI PIC  X(0001).
  1438*    -------------------------------
  1439     05  LOANNOL PIC S9(0004) COMP.
  1440     05  LOANNOF PIC  X(0001).
  1441     05  FILLER REDEFINES LOANNOF.
  1442         10  LOANNOA PIC  X(0001).
  1443     05  LOANNOI PIC  X(0008).
  1444*    -------------------------------
  1445     05  CRTLNMEL PIC S9(0004) COMP.
  1446     05  CRTLNMEF PIC  X(0001).
  1447     05  FILLER REDEFINES CRTLNMEF.
  1448         10  CRTLNMEA PIC  X(0001).
  1449     05  CRTLNMEI PIC  X(0015).
  1450*    -------------------------------
  1451     05  CRTFNMEL PIC S9(0004) COMP.
  1452     05  CRTFNMEF PIC  X(0001).
  1453     05  FILLER REDEFINES CRTFNMEF.
  1454         10  CRTFNMEA PIC  X(0001).
  1455     05  CRTFNMEI PIC  X(0012).
  1456*    -------------------------------
  1457     05  CRTINITL PIC S9(0004) COMP.
  1458     05  CRTINITF PIC  X(0001).
  1459     05  FILLER REDEFINES CRTINITF.
  1460         10  CRTINITA PIC  X(0001).
  1461     05  CRTINITI PIC  X(0001).
  1462*    -------------------------------
  1463     05  LOANBALL PIC S9(0004) COMP.
  1464     05  LOANBALF PIC  X(0001).
  1465     05  FILLER REDEFINES LOANBALF.
  1466         10  LOANBALA PIC  X(0001).
  1467     05  LOANBALI PIC  9(7)V99.
  1468*    -------------------------------
  1469     05  PROCL PIC S9(0004) COMP.
  1470     05  PROCF PIC  X(0001).
  1471     05  FILLER REDEFINES PROCF.
  1472         10  PROCA PIC  X(0001).
  1473     05  PROCI PIC  X(0004).
  1474*    -------------------------------
  1475     05  SUPVL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  31
* EL131.cbl
  1476     05  SUPVF PIC  X(0001).
  1477     05  FILLER REDEFINES SUPVF.
  1478         10  SUPVA PIC  X(0001).
  1479     05  SUPVI PIC  X(0001).
  1480*    -------------------------------
  1481     05  PRICDL PIC S9(0004) COMP.
  1482     05  PRICDF PIC  X(0001).
  1483     05  FILLER REDEFINES PRICDF.
  1484         10  PRICDA PIC  X(0001).
  1485     05  PRICDI PIC  X(0001).
  1486*    -------------------------------
  1487     05  CRITPL PIC S9(0004) COMP.
  1488     05  CRITPF PIC  X(0001).
  1489     05  FILLER REDEFINES CRITPF.
  1490         10  CRITPA PIC  X(0001).
  1491     05  CRITPI PIC  X(0002).
  1492*    -------------------------------
  1493     05  CRITPTL PIC S9(0004) COMP.
  1494     05  CRITPTF PIC  X(0001).
  1495     05  FILLER REDEFINES CRITPTF.
  1496         10  CRITPTA PIC  X(0001).
  1497     05  CRITPTI PIC  X(0001).
  1498*    -------------------------------
  1499     05  RTWMOSL PIC S9(0004) COMP.
  1500     05  RTWMOSF PIC  X(0001).
  1501     05  FILLER REDEFINES RTWMOSF.
  1502         10  RTWMOSA PIC  X(0001).
  1503     05  RTWMOSI PIC  X(0002).
  1504*    -------------------------------
  1505     05  FILETOL PIC S9(0004) COMP.
  1506     05  FILETOF PIC  X(0001).
  1507     05  FILLER REDEFINES FILETOF.
  1508         10  FILETOA PIC  X(0001).
  1509     05  FILETOI PIC  X(0004).
  1510*    -------------------------------
  1511     05  PTHRHDGL PIC S9(0004) COMP.
  1512     05  PTHRHDGF PIC  X(0001).
  1513     05  FILLER REDEFINES PTHRHDGF.
  1514         10  PTHRHDGA PIC  X(0001).
  1515     05  PTHRHDGI PIC  X(0010).
  1516*    -------------------------------
  1517     05  PDTHRUL PIC S9(0004) COMP.
  1518     05  PDTHRUF PIC  X(0001).
  1519     05  FILLER REDEFINES PDTHRUF.
  1520         10  PDTHRUA PIC  X(0001).
  1521     05  PDTHRUI PIC  X(0008).
  1522*    -------------------------------
  1523     05  PDAMTL PIC S9(0004) COMP.
  1524     05  PDAMTF PIC  X(0001).
  1525     05  FILLER REDEFINES PDAMTF.
  1526         10  PDAMTA PIC  X(0001).
  1527     05  PDAMTI PIC  9(7)V99.
  1528*    -------------------------------
  1529     05  NODAYSL PIC S9(0004) COMP.
  1530     05  NODAYSF PIC  X(0001).
  1531     05  FILLER REDEFINES NODAYSF.
  1532         10  NODAYSA PIC  X(0001).
  1533     05  NODAYSI PIC  9(5).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  32
* EL131.cbl
  1534*    -------------------------------
  1535     05  NOPMTSL PIC S9(0004) COMP.
  1536     05  NOPMTSF PIC  X(0001).
  1537     05  FILLER REDEFINES NOPMTSF.
  1538         10  NOPMTSA PIC  X(0001).
  1539     05  NOPMTSI PIC  9(4).
  1540*    -------------------------------
  1541     05  FORMTYPL PIC S9(0004) COMP.
  1542     05  FORMTYPF PIC  X(0001).
  1543     05  FILLER REDEFINES FORMTYPF.
  1544         10  FORMTYPA PIC  X(0001).
  1545     05  FORMTYPI PIC  X(0001).
  1546*    -------------------------------
  1547     05  ESTL PIC S9(0004) COMP.
  1548     05  ESTF PIC  X(0001).
  1549     05  FILLER REDEFINES ESTF.
  1550         10  ESTA PIC  X(0001).
  1551     05  ESTI PIC  X(0008).
  1552*    -------------------------------
  1553     05  AUIDL PIC S9(0004) COMP.
  1554     05  AUIDF PIC  X(0001).
  1555     05  FILLER REDEFINES AUIDF.
  1556         10  AUIDA PIC  X(0001).
  1557     05  AUIDI PIC  X(0004).
  1558*    -------------------------------
  1559     05  OCCL PIC S9(0004) COMP.
  1560     05  OCCF PIC  X(0001).
  1561     05  FILLER REDEFINES OCCF.
  1562         10  OCCA PIC  X(0001).
  1563     05  OCCI PIC  X(0006).
  1564*    -------------------------------
  1565     05  MNTDTL PIC S9(0004) COMP.
  1566     05  MNTDTF PIC  X(0001).
  1567     05  FILLER REDEFINES MNTDTF.
  1568         10  MNTDTA PIC  X(0001).
  1569     05  MNTDTI PIC  X(0008).
  1570*    -------------------------------
  1571     05  MNTTYPEL PIC S9(0004) COMP.
  1572     05  MNTTYPEF PIC  X(0001).
  1573     05  FILLER REDEFINES MNTTYPEF.
  1574         10  MNTTYPEA PIC  X(0001).
  1575     05  MNTTYPEI PIC  X(0006).
  1576*    -------------------------------
  1577     05  CERTCARL PIC S9(0004) COMP.
  1578     05  CERTCARF PIC  X(0001).
  1579     05  FILLER REDEFINES CERTCARF.
  1580         10  CERTCARA PIC  X(0001).
  1581     05  CERTCARI PIC  X(0001).
  1582*    -------------------------------
  1583     05  CERTGRPL PIC S9(0004) COMP.
  1584     05  CERTGRPF PIC  X(0001).
  1585     05  FILLER REDEFINES CERTGRPF.
  1586         10  CERTGRPA PIC  X(0001).
  1587     05  CERTGRPI PIC  X(0006).
  1588*    -------------------------------
  1589     05  CERTSTL PIC S9(0004) COMP.
  1590     05  CERTSTF PIC  X(0001).
  1591     05  FILLER REDEFINES CERTSTF.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  33
* EL131.cbl
  1592         10  CERTSTA PIC  X(0001).
  1593     05  CERTSTI PIC  X(0002).
  1594*    -------------------------------
  1595     05  CERTACTL PIC S9(0004) COMP.
  1596     05  CERTACTF PIC  X(0001).
  1597     05  FILLER REDEFINES CERTACTF.
  1598         10  CERTACTA PIC  X(0001).
  1599     05  CERTACTI PIC  X(0010).
  1600*    -------------------------------
  1601     05  CERTEFFL PIC S9(0004) COMP.
  1602     05  CERTEFFF PIC  X(0001).
  1603     05  FILLER REDEFINES CERTEFFF.
  1604         10  CERTEFFA PIC  X(0001).
  1605     05  CERTEFFI PIC  X(0008).
  1606*    -------------------------------
  1607     05  ISSAGEL PIC S9(0004) COMP.
  1608     05  ISSAGEF PIC  X(0001).
  1609     05  FILLER REDEFINES ISSAGEF.
  1610         10  ISSAGEA PIC  X(0001).
  1611     05  ISSAGEI PIC  X(0002).
  1612*    -------------------------------
  1613     05  APRL PIC S9(0004) COMP.
  1614     05  APRF PIC  X(0001).
  1615     05  FILLER REDEFINES APRF.
  1616         10  APRA PIC  X(0001).
  1617     05  APRI PIC  9(4)V9(4).
  1618*    -------------------------------
  1619     05  PMTFREQL PIC S9(0004) COMP.
  1620     05  PMTFREQF PIC  X(0001).
  1621     05  FILLER REDEFINES PMTFREQF.
  1622         10  PMTFREQA PIC  X(0001).
  1623     05  PMTFREQI PIC  99.
  1624*    -------------------------------
  1625     05  INDGRPL PIC S9(0004) COMP.
  1626     05  INDGRPF PIC  X(0001).
  1627     05  FILLER REDEFINES INDGRPF.
  1628         10  INDGRPA PIC  X(0001).
  1629     05  INDGRPI PIC  X(0001).
  1630*    -------------------------------
  1631     05  PREMTYPL PIC S9(0004) COMP.
  1632     05  PREMTYPF PIC  X(0001).
  1633     05  FILLER REDEFINES PREMTYPF.
  1634         10  PREMTYPA PIC  X(0001).
  1635     05  PREMTYPI PIC  X(0001).
  1636*    -------------------------------
  1637     05  REINCDL PIC S9(0004) COMP.
  1638     05  REINCDF PIC  X(0001).
  1639     05  FILLER REDEFINES REINCDF.
  1640         10  REINCDA PIC  X(0001).
  1641     05  REINCDI PIC  X(0001).
  1642*    -------------------------------
  1643     05  JNTLNMEL PIC S9(0004) COMP.
  1644     05  JNTLNMEF PIC  X(0001).
  1645     05  FILLER REDEFINES JNTLNMEF.
  1646         10  JNTLNMEA PIC  X(0001).
  1647     05  JNTLNMEI PIC  X(0015).
  1648*    -------------------------------
  1649     05  JNTFNMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  34
* EL131.cbl
  1650     05  JNTFNMEF PIC  X(0001).
  1651     05  FILLER REDEFINES JNTFNMEF.
  1652         10  JNTFNMEA PIC  X(0001).
  1653     05  JNTFNMEI PIC  X(0012).
  1654*    -------------------------------
  1655     05  JNTINITL PIC S9(0004) COMP.
  1656     05  JNTINITF PIC  X(0001).
  1657     05  FILLER REDEFINES JNTINITF.
  1658         10  JNTINITA PIC  X(0001).
  1659     05  JNTINITI PIC  X(0001).
  1660*    -------------------------------
  1661     05  JNTAGEL PIC S9(0004) COMP.
  1662     05  JNTAGEF PIC  X(0001).
  1663     05  FILLER REDEFINES JNTAGEF.
  1664         10  JNTAGEA PIC  X(0001).
  1665     05  JNTAGEI PIC  X(0002).
  1666*    -------------------------------
  1667     05  ADDONDTL PIC S9(0004) COMP.
  1668     05  ADDONDTF PIC  X(0001).
  1669     05  FILLER REDEFINES ADDONDTF.
  1670         10  ADDONDTA PIC  X(0001).
  1671     05  ADDONDTI PIC  X(0008).
  1672*    -------------------------------
  1673     05  LCVDSCRL PIC S9(0004) COMP.
  1674     05  LCVDSCRF PIC  X(0001).
  1675     05  FILLER REDEFINES LCVDSCRF.
  1676         10  LCVDSCRA PIC  X(0001).
  1677     05  LCVDSCRI PIC  X(0006).
  1678*    -------------------------------
  1679     05  LCVKINDL PIC S9(0004) COMP.
  1680     05  LCVKINDF PIC  X(0001).
  1681     05  FILLER REDEFINES LCVKINDF.
  1682         10  LCVKINDA PIC  X(0001).
  1683     05  LCVKINDI PIC  X(0003).
  1684*    -------------------------------
  1685     05  LCVCDL PIC S9(0004) COMP.
  1686     05  LCVCDF PIC  X(0001).
  1687     05  FILLER REDEFINES LCVCDF.
  1688         10  LCVCDA PIC  X(0001).
  1689     05  LCVCDI PIC  X(0002).
  1690*    -------------------------------
  1691     05  LCVOTRML PIC S9(0004) COMP.
  1692     05  LCVOTRMF PIC  X(0001).
  1693     05  FILLER REDEFINES LCVOTRMF.
  1694         10  LCVOTRMA PIC  X(0001).
  1695     05  LCVOTRMI PIC  999.
  1696*    -------------------------------
  1697     05  LCVRTRML PIC S9(0004) COMP.
  1698     05  LCVRTRMF PIC  X(0001).
  1699     05  FILLER REDEFINES LCVRTRMF.
  1700         10  LCVRTRMA PIC  X(0001).
  1701     05  LCVRTRMI PIC  X(0003).
  1702*    -------------------------------
  1703     05  LCVRATEL PIC S9(0004) COMP.
  1704     05  LCVRATEF PIC  X(0001).
  1705     05  FILLER REDEFINES LCVRATEF.
  1706         10  LCVRATEA PIC  X(0001).
  1707     05  LCVRATEI PIC  9999V99.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  35
* EL131.cbl
  1708*    -------------------------------
  1709     05  LCVBENEL PIC S9(0004) COMP.
  1710     05  LCVBENEF PIC  X(0001).
  1711     05  FILLER REDEFINES LCVBENEF.
  1712         10  LCVBENEA PIC  X(0001).
  1713     05  LCVBENEI PIC  9(9)V99.
  1714*    -------------------------------
  1715     05  LCVFORML PIC S9(0004) COMP.
  1716     05  LCVFORMF PIC  X(0001).
  1717     05  FILLER REDEFINES LCVFORMF.
  1718         10  LCVFORMA PIC  X(0001).
  1719     05  LCVFORMI PIC  X(0012).
  1720*    -------------------------------
  1721     05  LCVCNDTL PIC S9(0004) COMP.
  1722     05  LCVCNDTF PIC  X(0001).
  1723     05  FILLER REDEFINES LCVCNDTF.
  1724         10  LCVCNDTA PIC  X(0001).
  1725     05  LCVCNDTI PIC  X(0008).
  1726*    -------------------------------
  1727     05  LCVEXITL PIC S9(0004) COMP.
  1728     05  LCVEXITF PIC  X(0001).
  1729     05  FILLER REDEFINES LCVEXITF.
  1730         10  LCVEXITA PIC  X(0001).
  1731     05  LCVEXITI PIC  X(0008).
  1732*    -------------------------------
  1733     05  LCVSTATL PIC S9(0004) COMP.
  1734     05  LCVSTATF PIC  X(0001).
  1735     05  FILLER REDEFINES LCVSTATF.
  1736         10  LCVSTATA PIC  X(0001).
  1737     05  LCVSTATI PIC  X(0006).
  1738*    -------------------------------
  1739     05  ACVDSCRL PIC S9(0004) COMP.
  1740     05  ACVDSCRF PIC  X(0001).
  1741     05  FILLER REDEFINES ACVDSCRF.
  1742         10  ACVDSCRA PIC  X(0001).
  1743     05  ACVDSCRI PIC  X(0006).
  1744*    -------------------------------
  1745     05  ACVKINDL PIC S9(0004) COMP.
  1746     05  ACVKINDF PIC  X(0001).
  1747     05  FILLER REDEFINES ACVKINDF.
  1748         10  ACVKINDA PIC  X(0001).
  1749     05  ACVKINDI PIC  X(0003).
  1750*    -------------------------------
  1751     05  ACVCDL PIC S9(0004) COMP.
  1752     05  ACVCDF PIC  X(0001).
  1753     05  FILLER REDEFINES ACVCDF.
  1754         10  ACVCDA PIC  X(0001).
  1755     05  ACVCDI PIC  X(0002).
  1756*    -------------------------------
  1757     05  ACVOTRML PIC S9(0004) COMP.
  1758     05  ACVOTRMF PIC  X(0001).
  1759     05  FILLER REDEFINES ACVOTRMF.
  1760         10  ACVOTRMA PIC  X(0001).
  1761     05  ACVOTRMI PIC  999.
  1762*    -------------------------------
  1763     05  ACVRTRML PIC S9(0004) COMP.
  1764     05  ACVRTRMF PIC  X(0001).
  1765     05  FILLER REDEFINES ACVRTRMF.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  36
* EL131.cbl
  1766         10  ACVRTRMA PIC  X(0001).
  1767     05  ACVRTRMI PIC  X(0003).
  1768*    -------------------------------
  1769     05  ACVRATEL PIC S9(0004) COMP.
  1770     05  ACVRATEF PIC  X(0001).
  1771     05  FILLER REDEFINES ACVRATEF.
  1772         10  ACVRATEA PIC  X(0001).
  1773     05  ACVRATEI PIC  9999V99.
  1774*    -------------------------------
  1775     05  ACVBENEL PIC S9(0004) COMP.
  1776     05  ACVBENEF PIC  X(0001).
  1777     05  FILLER REDEFINES ACVBENEF.
  1778         10  ACVBENEA PIC  X(0001).
  1779     05  ACVBENEI PIC  9(9)V99.
  1780*    -------------------------------
  1781     05  ACVFORML PIC S9(0004) COMP.
  1782     05  ACVFORMF PIC  X(0001).
  1783     05  FILLER REDEFINES ACVFORMF.
  1784         10  ACVFORMA PIC  X(0001).
  1785     05  ACVFORMI PIC  X(0012).
  1786*    -------------------------------
  1787     05  ACVCNDTL PIC S9(0004) COMP.
  1788     05  ACVCNDTF PIC  X(0001).
  1789     05  FILLER REDEFINES ACVCNDTF.
  1790         10  ACVCNDTA PIC  X(0001).
  1791     05  ACVCNDTI PIC  X(0008).
  1792*    -------------------------------
  1793     05  ACVEXITL PIC S9(0004) COMP.
  1794     05  ACVEXITF PIC  X(0001).
  1795     05  FILLER REDEFINES ACVEXITF.
  1796         10  ACVEXITA PIC  X(0001).
  1797     05  ACVEXITI PIC  X(0008).
  1798*    -------------------------------
  1799     05  ACVSTATL PIC S9(0004) COMP.
  1800     05  ACVSTATF PIC  X(0001).
  1801     05  FILLER REDEFINES ACVSTATF.
  1802         10  ACVSTATA PIC  X(0001).
  1803     05  ACVSTATI PIC  X(0006).
  1804*    -------------------------------
  1805     05  LABEL2L PIC S9(0004) COMP.
  1806     05  LABEL2F PIC  X(0001).
  1807     05  FILLER REDEFINES LABEL2F.
  1808         10  LABEL2A PIC  X(0001).
  1809     05  LABEL2I PIC  X(0014).
  1810*    -------------------------------
  1811     05  BCERT1L PIC S9(0004) COMP.
  1812     05  BCERT1F PIC  X(0001).
  1813     05  FILLER REDEFINES BCERT1F.
  1814         10  BCERT1A PIC  X(0001).
  1815     05  BCERT1I PIC  X(0010).
  1816*    -------------------------------
  1817     05  BSUFX1L PIC S9(0004) COMP.
  1818     05  BSUFX1F PIC  X(0001).
  1819     05  FILLER REDEFINES BSUFX1F.
  1820         10  BSUFX1A PIC  X(0001).
  1821     05  BSUFX1I PIC  X(0001).
  1822*    -------------------------------
  1823     05  BCERT2L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  37
* EL131.cbl
  1824     05  BCERT2F PIC  X(0001).
  1825     05  FILLER REDEFINES BCERT2F.
  1826         10  BCERT2A PIC  X(0001).
  1827     05  BCERT2I PIC  X(0010).
  1828*    -------------------------------
  1829     05  BSUFX2L PIC S9(0004) COMP.
  1830     05  BSUFX2F PIC  X(0001).
  1831     05  FILLER REDEFINES BSUFX2F.
  1832         10  BSUFX2A PIC  X(0001).
  1833     05  BSUFX2I PIC  X(0001).
  1834*    -------------------------------
  1835     05  BCERT3L PIC S9(0004) COMP.
  1836     05  BCERT3F PIC  X(0001).
  1837     05  FILLER REDEFINES BCERT3F.
  1838         10  BCERT3A PIC  X(0001).
  1839     05  BCERT3I PIC  X(0010).
  1840*    -------------------------------
  1841     05  BSUFX3L PIC S9(0004) COMP.
  1842     05  BSUFX3F PIC  X(0001).
  1843     05  FILLER REDEFINES BSUFX3F.
  1844         10  BSUFX3A PIC  X(0001).
  1845     05  BSUFX3I PIC  X(0001).
  1846*    -------------------------------
  1847     05  BCERT4L PIC S9(0004) COMP.
  1848     05  BCERT4F PIC  X(0001).
  1849     05  FILLER REDEFINES BCERT4F.
  1850         10  BCERT4A PIC  X(0001).
  1851     05  BCERT4I PIC  X(0010).
  1852*    -------------------------------
  1853     05  BSUFX4L PIC S9(0004) COMP.
  1854     05  BSUFX4F PIC  X(0001).
  1855     05  FILLER REDEFINES BSUFX4F.
  1856         10  BSUFX4A PIC  X(0001).
  1857     05  BSUFX4I PIC  X(0001).
  1858*    -------------------------------
  1859     05  BCERT5L PIC S9(0004) COMP.
  1860     05  BCERT5F PIC  X(0001).
  1861     05  FILLER REDEFINES BCERT5F.
  1862         10  BCERT5A PIC  X(0001).
  1863     05  BCERT5I PIC  X(0010).
  1864*    -------------------------------
  1865     05  BSUFX5L PIC S9(0004) COMP.
  1866     05  BSUFX5F PIC  X(0001).
  1867     05  FILLER REDEFINES BSUFX5F.
  1868         10  BSUFX5A PIC  X(0001).
  1869     05  BSUFX5I PIC  X(0001).
  1870*    -------------------------------
  1871     05  MSG1L PIC S9(0004) COMP.
  1872     05  MSG1F PIC  X(0001).
  1873     05  FILLER REDEFINES MSG1F.
  1874         10  MSG1A PIC  X(0001).
  1875     05  MSG1I PIC  X(0072).
  1876*    -------------------------------
  1877     05  MSG2L PIC S9(0004) COMP.
  1878     05  MSG2F PIC  X(0001).
  1879     05  FILLER REDEFINES MSG2F.
  1880         10  MSG2A PIC  X(0001).
  1881     05  MSG2I PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  38
* EL131.cbl
  1882*    -------------------------------
  1883     05  PFKEYL PIC S9(0004) COMP.
  1884     05  PFKEYF PIC  X(0001).
  1885     05  FILLER REDEFINES PFKEYF.
  1886         10  PFKEYA PIC  X(0001).
  1887     05  PFKEYI PIC  99.
  1888*    -------------------------------
  1889     05  PFKEY6L PIC S9(0004) COMP.
  1890     05  PFKEY6F PIC  X(0001).
  1891     05  FILLER REDEFINES PFKEY6F.
  1892         10  PFKEY6A PIC  X(0001).
  1893     05  PFKEY6I PIC  X(0016).
  1894 01  EL131AO REDEFINES EL131AI.
  1895     05  FILLER            PIC  X(0012).
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  DATEO PIC  X(0008).
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  TIMEO PIC  99.99.
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  SEQUO PIC  X(0010).
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  COMPO PIC  X(0003).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  USERIDO PIC  X(0004).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  CCNOO PIC  X(0016).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  MAINTO PIC  X(0001).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  CLAIMO PIC  X(0007).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  CARRO PIC  X(0001).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  CERTO PIC  X(0010).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  SUFXO PIC  X(0001).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  TYPEO PIC  X(0001).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  LABEL1O PIC  X(0011).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  PCERTNOO PIC  X(0010).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  39
* EL131.cbl
  1940     05  PSUFXO PIC  X(0001).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  STATUSO PIC  X(0006).
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  INCO PIC  X(0008).
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  REPO PIC  X(0008).
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
  1952     05  CAUSEO PIC  X(0006).
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  ENDO PIC  X(0008).
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  DIAGO PIC  X(0060).
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  ACCSWO PIC  X(0001).
  1962*    -------------------------------
  1963     05  FILLER            PIC  X(0003).
  1964     05  BENEO PIC  X(0010).
  1965*    -------------------------------
  1966     05  FILLER            PIC  X(0003).
  1967     05  BIRTHO PIC  X(0008).
  1968*    -------------------------------
  1969     05  FILLER            PIC  X(0003).
  1970     05  SOCIALO PIC  X(0011).
  1971*    -------------------------------
  1972     05  FILLER            PIC  X(0003).
  1973     05  SEXO PIC  X(0001).
  1974*    -------------------------------
  1975     05  FILLER            PIC  X(0003).
  1976     05  MLNAMEO PIC  X(0015).
  1977*    -------------------------------
  1978     05  FILLER            PIC  X(0003).
  1979     05  MFNAMEO PIC  X(0012).
  1980*    -------------------------------
  1981     05  FILLER            PIC  X(0003).
  1982     05  MMINITO PIC  X(0001).
  1983*    -------------------------------
  1984     05  FILLER            PIC  X(0003).
  1985     05  LOANNOO PIC  X(0008).
  1986*    -------------------------------
  1987     05  FILLER            PIC  X(0003).
  1988     05  CRTLNMEO PIC  X(0015).
  1989*    -------------------------------
  1990     05  FILLER            PIC  X(0003).
  1991     05  CRTFNMEO PIC  X(0012).
  1992*    -------------------------------
  1993     05  FILLER            PIC  X(0003).
  1994     05  CRTINITO PIC  X(0001).
  1995*    -------------------------------
  1996     05  FILLER            PIC  X(0003).
  1997     05  LOANBALO PIC  ZZZZZ9.99.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  40
* EL131.cbl
  1998*    -------------------------------
  1999     05  FILLER            PIC  X(0003).
  2000     05  PROCO PIC  X(0004).
  2001*    -------------------------------
  2002     05  FILLER            PIC  X(0003).
  2003     05  SUPVO PIC  X(0001).
  2004*    -------------------------------
  2005     05  FILLER            PIC  X(0003).
  2006     05  PRICDO PIC  X(0001).
  2007*    -------------------------------
  2008     05  FILLER            PIC  X(0003).
  2009     05  CRITPO PIC  X(0002).
  2010*    -------------------------------
  2011     05  FILLER            PIC  X(0003).
  2012     05  CRITPTO PIC  X(0001).
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  RTWMOSO PIC  X(0002).
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  FILETOO PIC  X(0004).
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  PTHRHDGO PIC  X(0010).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  PDTHRUO PIC  X(0008).
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  PDAMTO PIC  Z(06).99.
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  NODAYSO PIC  ZZZ99.
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  NOPMTSO PIC  ZZ99.
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  FORMTYPO PIC  X(0001).
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  ESTO PIC  X(0008).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  AUIDO PIC  X(0004).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  OCCO PIC  X(0006).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  MNTDTO PIC  X(0008).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  MNTTYPEO PIC  X(0006).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  CERTCARO PIC  X(0001).
  2055*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  41
* EL131.cbl
  2056     05  FILLER            PIC  X(0003).
  2057     05  CERTGRPO PIC  X(0006).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  CERTSTO PIC  X(0002).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  CERTACTO PIC  X(0010).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  CERTEFFO PIC  X(0008).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  ISSAGEO PIC  X(0002).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  APRO PIC  9(3).9(4).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  PMTFREQO PIC  99.
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  INDGRPO PIC  X(0001).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  PREMTYPO PIC  X(0001).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  REINCDO PIC  X(0001).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  JNTLNMEO PIC  X(0015).
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  JNTFNMEO PIC  X(0012).
  2091*    -------------------------------
  2092     05  FILLER            PIC  X(0003).
  2093     05  JNTINITO PIC  X(0001).
  2094*    -------------------------------
  2095     05  FILLER            PIC  X(0003).
  2096     05  JNTAGEO PIC  X(0002).
  2097*    -------------------------------
  2098     05  FILLER            PIC  X(0003).
  2099     05  ADDONDTO PIC  X(0008).
  2100*    -------------------------------
  2101     05  FILLER            PIC  X(0003).
  2102     05  LCVDSCRO PIC  X(0006).
  2103*    -------------------------------
  2104     05  FILLER            PIC  X(0003).
  2105     05  LCVKINDO PIC  X(0003).
  2106*    -------------------------------
  2107     05  FILLER            PIC  X(0003).
  2108     05  LCVCDO PIC  X(0002).
  2109*    -------------------------------
  2110     05  FILLER            PIC  X(0003).
  2111     05  LCVOTRMO PIC  999.
  2112*    -------------------------------
  2113     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  42
* EL131.cbl
  2114     05  LCVRTRMO PIC  999.
  2115*    -------------------------------
  2116     05  FILLER            PIC  X(0003).
  2117     05  LCVRATEO PIC  ZZZ.ZZ.
  2118*    -------------------------------
  2119     05  FILLER            PIC  X(0003).
  2120     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2121*    -------------------------------
  2122     05  FILLER            PIC  X(0003).
  2123     05  LCVFORMO PIC  X(0012).
  2124*    -------------------------------
  2125     05  FILLER            PIC  X(0003).
  2126     05  LCVCNDTO PIC  X(0008).
  2127*    -------------------------------
  2128     05  FILLER            PIC  X(0003).
  2129     05  LCVEXITO PIC  X(0008).
  2130*    -------------------------------
  2131     05  FILLER            PIC  X(0003).
  2132     05  LCVSTATO PIC  X(0006).
  2133*    -------------------------------
  2134     05  FILLER            PIC  X(0003).
  2135     05  ACVDSCRO PIC  X(0006).
  2136*    -------------------------------
  2137     05  FILLER            PIC  X(0003).
  2138     05  ACVKINDO PIC  X(0003).
  2139*    -------------------------------
  2140     05  FILLER            PIC  X(0003).
  2141     05  ACVCDO PIC  X(0002).
  2142*    -------------------------------
  2143     05  FILLER            PIC  X(0003).
  2144     05  ACVOTRMO PIC  999.
  2145*    -------------------------------
  2146     05  FILLER            PIC  X(0003).
  2147     05  ACVRTRMO PIC  999.
  2148*    -------------------------------
  2149     05  FILLER            PIC  X(0003).
  2150     05  ACVRATEO PIC  ZZZ.ZZ.
  2151*    -------------------------------
  2152     05  FILLER            PIC  X(0003).
  2153     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2154*    -------------------------------
  2155     05  FILLER            PIC  X(0003).
  2156     05  ACVFORMO PIC  X(0012).
  2157*    -------------------------------
  2158     05  FILLER            PIC  X(0003).
  2159     05  ACVCNDTO PIC  X(0008).
  2160*    -------------------------------
  2161     05  FILLER            PIC  X(0003).
  2162     05  ACVEXITO PIC  X(0008).
  2163*    -------------------------------
  2164     05  FILLER            PIC  X(0003).
  2165     05  ACVSTATO PIC  X(0006).
  2166*    -------------------------------
  2167     05  FILLER            PIC  X(0003).
  2168     05  LABEL2O PIC  X(0014).
  2169*    -------------------------------
  2170     05  FILLER            PIC  X(0003).
  2171     05  BCERT1O PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  43
* EL131.cbl
  2172*    -------------------------------
  2173     05  FILLER            PIC  X(0003).
  2174     05  BSUFX1O PIC  X(0001).
  2175*    -------------------------------
  2176     05  FILLER            PIC  X(0003).
  2177     05  BCERT2O PIC  X(0010).
  2178*    -------------------------------
  2179     05  FILLER            PIC  X(0003).
  2180     05  BSUFX2O PIC  X(0001).
  2181*    -------------------------------
  2182     05  FILLER            PIC  X(0003).
  2183     05  BCERT3O PIC  X(0010).
  2184*    -------------------------------
  2185     05  FILLER            PIC  X(0003).
  2186     05  BSUFX3O PIC  X(0001).
  2187*    -------------------------------
  2188     05  FILLER            PIC  X(0003).
  2189     05  BCERT4O PIC  X(0010).
  2190*    -------------------------------
  2191     05  FILLER            PIC  X(0003).
  2192     05  BSUFX4O PIC  X(0001).
  2193*    -------------------------------
  2194     05  FILLER            PIC  X(0003).
  2195     05  BCERT5O PIC  X(0010).
  2196*    -------------------------------
  2197     05  FILLER            PIC  X(0003).
  2198     05  BSUFX5O PIC  X(0001).
  2199*    -------------------------------
  2200     05  FILLER            PIC  X(0003).
  2201     05  MSG1O PIC  X(0072).
  2202*    -------------------------------
  2203     05  FILLER            PIC  X(0003).
  2204     05  MSG2O PIC  X(0072).
  2205*    -------------------------------
  2206     05  FILLER            PIC  X(0003).
  2207     05  PFKEYO PIC  X(0002).
  2208*    -------------------------------
  2209     05  FILLER            PIC  X(0003).
  2210     05  PFKEY6O PIC  X(0016).
  2211*    -------------------------------
  2212
  2213*                                COPY ELCEMIB SUPPRESS.
  2214******************************************************************
  2215*                                                                *
  2216*                                                                *
  2217*                            ELCEMIB.                            *
  2218*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2219*                            VMOD=2.005                          *
  2220*                                                                *
  2221*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2222*                                                                *
  2223******************************************************************
  2224 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2225     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2226     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2227     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2228     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2229     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  44
* EL131.cbl
  2230     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2231     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2232     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2233     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2234         88  EMI-NO-ERRORS                    VALUE '1'.
  2235         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2236         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2237     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2238         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2239     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2240         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2241         88  EMI-AREA1-FULL                   VALUE '2'.
  2242     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2243         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2244         88  EMI-AREA2-FULL                   VALUE '2'.
  2245     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2246         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2247         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2248         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2249         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2250         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2251     12  EMI-ERROR-LINES.
  2252         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2253         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2254         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2255         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2256             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2257                 24  EMI-ERR-NUM         PIC X(4).
  2258                 24  EMI-FILLER          PIC X.
  2259                 24  EMI-SEV             PIC X.
  2260                 24  FILLER              PIC X.
  2261             20  FILLER                  PIC X(02).
  2262     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2263         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2264             20  EMI-ERROR-NUMBER    PIC X(4).
  2265             20  EMI-FILL            PIC X.
  2266             20  EMI-SEVERITY        PIC X.
  2267             20  FILLER              PIC X.
  2268             20  EMI-ERROR-TEXT.
  2269                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2270                 24  FILLER          PIC X(55).
  2271     12  EMI-SEVERITY-SAVE           PIC X.
  2272         88  EMI-NOTE                    VALUE 'N'.
  2273         88  EMI-WARNING                 VALUE 'W'.
  2274         88  EMI-FORCABLE                VALUE 'F'.
  2275         88  EMI-FATAL                   VALUE 'X'.
  2276     12  EMI-MESSAGE-FLAG            PIC X.
  2277         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2278         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2279     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2280     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2281         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2282         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2283         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2284     12  emi-claim-no                pic x(7).
  2285     12  emi-claim-type              pic x(6).
  2286     12  FILLER                      PIC X(124)  VALUE SPACES.
  2287     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  45
* EL131.cbl
  2288     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2289     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2290     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2291
  2292*                                COPY ELCJPFX SUPPRESS.
  2293******************************************************************
  2294*                                                                *
  2295*                                                                *
  2296*                            ELCJPFX.                            *
  2297*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2298*                            VMOD=2.002                          *
  2299*                                                                *
  2300*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2301*                                                                *
  2302*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2303*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2304*        ELCNTL - CONTROL FILE                                   *
  2305*        ELMSTR - CLAIM MASTERS                                  *
  2306*        ELTRLR - ACTIVITY TRAILERS                              *
  2307*        ELCHKQ - CHECK QUE                                      *
  2308******************************************************************
  2309 01  JOURNAL-RECORD.
  2310     12  JP-USER-ID                  PIC X(4).
  2311     12  JP-FILE-ID                  PIC X(8).
  2312     12  JP-PROGRAM-ID               PIC X(8).
  2313     12  JP-RECORD-TYPE              PIC X.
  2314         88 JP-ADD              VALUE 'A'.
  2315         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2316         88 JP-AFTER-CHANGE     VALUE 'C'.
  2317         88 JP-DELETE           VALUE 'D'.
  2318         88 JP-GENERIC-DELETE   VALUE 'G'.
  2319         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2320         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2321     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2322     12  JP-RECORD-AREA
  2323
  2324
  2325                                 PIC X(750).
  2326
  2327*                                COPY ELCCALC.
  2328******************************************************************
  2329*                                                                *
  2330*                           ELCCALC.                            *
  2331*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2332*                            VMOD=2.025                          *
  2333*                                                                *
  2334*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2335*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2336*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2337*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2338*                                                                *
  2339*  PASSED TO ELRTRM                                              *
  2340*  -----------------                                             *
  2341*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2342*  ORIGINAL TERM                                                 *
  2343*  BEGINNING DATE                                                *
  2344*  ENDING DATE                                                   *
  2345*  COMPANY I.D.                                                  *
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  46
* EL131.cbl
  2346*  ACCOUNT MASTER USER FIELD                                     *
  2347*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2348*  FREE LOOK DAYS                                                *
  2349*                                                                *
  2350*  RETURNED FROM ELRTRM                                          *
  2351*  ---------------------                                         *
  2352*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2353*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2354*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2355*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2356*----------------------------------------------------------------*
  2357*  PASSED TO ELRAMT                                              *
  2358*  ----------------                                              *
  2359*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2360*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2361*  ORIGINAL AMOUNT                                               *
  2362*  ALTERNATE BENEFIT (BALLON)                                    *
  2363*  A.P.R. - NET PAY ONLY                                         *
  2364*  METHOD
  2365*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2366*  COMPANY I.D.                                                  *
  2367*  BENEFIT TYPE                                                  *
  2368*                                                                *
  2369*  RETURNED FROM ELRAMT                                          *
  2370*  --------------------                                          *
  2371*  REMAINING AMOUNT 1 - CURRENT                                  *
  2372*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2373*  REMAINING AMOUNT FACTOR
  2374*----------------------------------------------------------------*
  2375*  PASSED TO ELRESV                                              *
  2376*  -----------------                                             *
  2377*  CERTIFICATE EFFECTIVE DATE                                    *
  2378*  VALUATION DATE                                                *
  2379*  PAID THRU DATE                                                *
  2380*  BENEFIT                                                       *
  2381*  INCURRED DATE                                                 *
  2382*  REPORTED DATE                                                 *
  2383*  ISSUE AGE                                                     *
  2384*  TERM                                                          *
  2385*  CDT PERCENT                                                   *
  2386*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2387* *CLAIM TYPE (LIFE, A/H)                                        *
  2388* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2389* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2390*                                                                *
  2391*  RETURNED FROM ELRESV                                          *
  2392*  --------------------                                          *
  2393*  CDT TABLE USED                                                *
  2394*  CDT FACTOR USED                                               *
  2395*  PAY TO CURRENT RESERVE                                        *
  2396*  I.B.N.R. - A/H ONLY                                           *
  2397*  FUTURE (ACCRUED) AH ONLY                                      *
  2398*----------------------------------------------------------------*
  2399*  PASSED TO ELRATE                                              *
  2400*  ----------------                                              *
  2401*  CERT ISSUE DATE                                               *
  2402*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2403*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  47
* EL131.cbl
  2404*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2405*  STATE CODE (CLIENT DEFINED)                                   *
  2406*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2407*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2408*  DEVIATION CODE                                                *
  2409*  ISSUE AGE                                                     *
  2410*  ORIGINAL BENEFIT AMOUNT                                       *
  2411*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2412*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2413*  BENEFIT KIND (LIFE OR A/H)                                    *
  2414*  A.P.R.                                                        *
  2415*  METHOD
  2416*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2417*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2418*  COMPANY I.D. (3 CHARACTER)                                    *
  2419*  BENEFIT CODE                                                  *
  2420*  BENEFIT OVERRIDE CODE                                         *
  2421*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2422*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2423*  JOINT INDICATOR (CSL ONLY)                                    *
  2424*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2425*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2426*                                                                *
  2427*  RETURNED FROM ELRATE                                          *
  2428*  --------------------                                          *
  2429*  CALCULATED PREMIUM                                            *
  2430*  PREMIUM RATE                                                  *
  2431*  MORTALITY CODE                                                *
  2432*  MAX ATTAINED AGE                                              *
  2433*  MAX AGE                                                       *
  2434*  MAX TERM                                                      *
  2435*  MAX MONTHLY BENEFIT                                           *
  2436*  MAX TOTAL BENIFIT                                             *
  2437*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2438*----------------------------------------------------------------*
  2439*  PASSED TO ELRFND                                              *
  2440*  ----------------                                              *
  2441*  CERT ISSUE DATE                                               *
  2442*  REFUND DATE                                                   *
  2443*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2444*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2445*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2446*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2447*  STATE CODE (CLIENT DEFINED)                                   *
  2448*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2449*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2450*  DEVIATION CODE                                                *
  2451*  ISSUE AGE                                                     *
  2452*  ORIGINAL BENEFIT AMOUNT                                       *
  2453*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2454*  PROCESS TYPE (CANCEL)                                         *
  2455*  BENEFIT KIND (LIFE OR A/H)                                    *
  2456*  A.P.R.                                                        *
  2457*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2458*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2459*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2460*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2461*  COMPANY I.D. (3 CHARACTER)                                    *
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  48
* EL131.cbl
  2462*  BENEFIT CODE                                                  *
  2463*  BENEFIT OVERRIDE CODE                                         *
  2464*                                                                *
  2465*  RETURNED FROM ELRFND                                          *
  2466*  --------------------                                          *
  2467*  CALCULATED REFUND                                             *
  2468*----------------------------------------------------------------*
  2469*  PASSED TO ELEARN                                              *
  2470*  ----------------                                              *
  2471*  CERT ISSUE DATE                                               *
  2472*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2473*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2474*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2475*  STATE CODE (CLIENT DEFINED)                                   *
  2476*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2477*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2478*  DEVIATION CODE                                                *
  2479*  ISSUE AGE                                                     *
  2480*  ORIGINAL BENEFIT AMOUNT                                       *
  2481*  BENEFIT KIND (LIFE OR A/H)                                    *
  2482*  A.P.R.                                                        *
  2483*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2484*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2485*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2486*  COMPANY I.D. (3 CHARACTER)                                    *
  2487*  BENEFIT CODE                                                  *
  2488*  BENEFIT OVERRIDE CODE                                         *
  2489*                                                                *
  2490*  RETURNED FROM ELEARN                                          *
  2491*  --------------------                                          *
  2492*  INDICATED  EARNINGS                                           *
  2493*----------------------------------------------------------------*
  2494*                 LENGTH = 450                                   *
  2495*                                                                *
  2496******************************************************************
  2497******************************************************************
  2498*                   C H A N G E   L O G
  2499*
  2500* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2501*-----------------------------------------------------------------
  2502*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2503* EFFECTIVE    NUMBER
  2504*-----------------------------------------------------------------
  2505* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2506* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2507* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2508* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2509* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2510* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2511* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2512* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2513* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2514******************************************************************
  2515
  2516 01  CALCULATION-PASS-AREA.
  2517     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2518                                     COMP.
  2519
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  49
* EL131.cbl
  2520     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2521       88  NO-CP-ERROR                             VALUE ZERO.
  2522       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2523                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2524       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2525       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2526       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2527       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2528       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2529       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2530       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2531       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2532       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2533       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2534       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2535       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2536       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2537       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2538       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2539       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2540       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2541
  2542     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2543       88  NO-CP-ERROR-2                           VALUE ZERO.
  2544***********************  INPUT AREAS ****************************
  2545
  2546     12  CP-CALCULATION-AREA.
  2547         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2548         16  CP-CERT-EFF-DT        PIC XX.
  2549         16  CP-VALUATION-DT       PIC XX.
  2550         16  CP-PAID-THRU-DT       PIC XX.
  2551         16  CP-BENEFIT-TYPE       PIC X.
  2552           88  CP-AH                               VALUE 'A' 'D'
  2553                                                   'I' 'U'.
  2554           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2555           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2556         16  CP-INCURRED-DT        PIC XX.
  2557         16  CP-REPORTED-DT        PIC XX.
  2558         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2559         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2560         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2561                                     COMP-3.
  2562         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2563                                     COMP-3.
  2564         16  CP-CDT-METHOD         PIC X.
  2565           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2566           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2567           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2568         16  CP-CLAIM-TYPE         PIC X.
  2569           88  CP-AH-CLAIM                         VALUE 'A'.
  2570           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2571         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2572                                     COMP-3.
  2573         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2574                                     COMP-3.
  2575         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2576                                     COMP-3.
  2577         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  50
* EL131.cbl
  2578                                     COMP-3.
  2579         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2580                                     COMP-3.
  2581         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2582                                     COMP-3.
  2583         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2584                                     COMP-3.
  2585         16  CP-REM-TERM-METHOD    PIC X.
  2586           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2587           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2588           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2589           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2590           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2591           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2592           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2593         16  CP-EARNING-METHOD     PIC X.
  2594           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2595           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2596           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2597           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2598           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2599           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2600           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2601           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2602           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2603           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2604           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2605           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2606           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2607           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2608         16  CP-PROCESS-TYPE       PIC X.
  2609           88  CP-CLAIM                            VALUE '1'.
  2610           88  CP-CANCEL                           VALUE '2'.
  2611           88  CP-ISSUE                            VALUE '3'.
  2612         16  CP-SPECIAL-CALC-CD    PIC X.
  2613           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2614           88  CP-1-MTH-INTEREST               VALUE ' '.
  2615           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2616           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2617           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2618           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2619           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2620           88  CP-FARM-PLAN                    VALUE 'F'.
  2621           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2622           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2623           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2624           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2625           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2626           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2627           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2628           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2629           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2630           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2631                                                     'W' 'X'.
  2632           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2633           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2634           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2635           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  51
* EL131.cbl
  2636           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2637           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2638           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2639           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2640           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2641           88  CP-CSL-METH-1                   VALUE '5'.
  2642           88  CP-CSL-METH-2                   VALUE '6'.
  2643           88  CP-CSL-METH-3                   VALUE '7'.
  2644           88  CP-CSL-METH-4                   VALUE '8'.
  2645
  2646         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2647                                     COMP-3.
  2648         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2649         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2650         16  CP-STATE              PIC XX          VALUE SPACE.
  2651         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2652         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2653           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2654               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2655         16  CP-R78-OPTION         PIC X.
  2656           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2657           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2658
  2659         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2660         16  CP-IBNR-RESERVE-SW    PIC X.
  2661         16  CP-CLAIM-STATUS       PIC X.
  2662         16  CP-RATE-FILE          PIC X.
  2663         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2664                                     COMP-3.
  2665
  2666         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2667         16  CP-AH-OVERRIDE-CODE   PIC X.
  2668
  2669         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2670                                     COMP-3.
  2671         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2672                                   PIC S9(5)V99 COMP-3.
  2673         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2674                                     COMP-3.
  2675         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2676                                     COMP-3.
  2677         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2678                                     COMP-3.
  2679         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2680                                  PIC S9(7)V99 COMP-3.
  2681
  2682         16  CP-PAID-FROM-DATE     PIC X(02).
  2683         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2684         16  CP-EXT-DAYS-CALC      PIC X.
  2685           88  CP-EXT-NO-CHG                   VALUE ' '.
  2686           88  CP-EXT-CHG-LF                   VALUE '1'.
  2687           88  CP-EXT-CHG-AH                   VALUE '2'.
  2688           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2689         16  CP-DOMICILE-STATE     PIC XX.
  2690         16  CP-CARRIER            PIC X.
  2691         16  CP-REIN-FLAG          PIC X.
  2692         16  CP-REM-TRM-CALC-OPTION PIC X.
  2693           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  52
* EL131.cbl
  2694                      '2' '3' '4' '5'.
  2695           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2696           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2697           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2698           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2699           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2700           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2701           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2702           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2703         16  CP-SIG-SWITCH         PIC X.
  2704         16  CP-RATING-METHOD      PIC X.
  2705           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2706           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2707           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2708           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2709           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2710           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2711           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2712           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2713           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2714         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2715                                     COMP-3.
  2716         16  CP-BEN-CATEGORY       PIC X.
  2717         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2718         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2719                                   PIC S99V9(5) COMP-3.
  2720         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2721         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2722                                   PIC S99V9(5) COMP-3.
  2723         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2724         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2725         16  CP-EXPIRE-DT          PIC XX.
  2726         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2727         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2728         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2729         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2730         16  CP-DDF-SPEC-CALC      PIC X.
  2731             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2732             88  CP-CALC-CLP              VALUE 'C'.
  2733         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2734         16  CP-CANCEL-REASON      PIC X.
  2735         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2736         16  CP-PMT-MODE           PIC X.
  2737         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2738         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2739         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2740         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2741         16  FILLER                PIC X.
  2742
  2743***************    OUTPUT FROM ELRESV   ************************
  2744
  2745         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2746
  2747         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2748                                     COMP-3.
  2749         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2750                                     COMP-3.
  2751         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  53
* EL131.cbl
  2752                                     COMP-3.
  2753         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2754                                     COMP-3.
  2755         16  FILLER                PIC X(09).
  2756***************    OUTPUT FROM ELRTRM   *************************
  2757
  2758         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2759                                     COMP-3.
  2760         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2761                                     COMP-3.
  2762         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2763                                     COMP-3.
  2764         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2765                                     COMP-3.
  2766         16  FILLER                PIC X(12).
  2767
  2768***************    OUTPUT FROM ELRAMT   *************************
  2769
  2770         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2771                                     COMP-3.
  2772         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2773                                     COMP-3.
  2774         16  FILLER                PIC X(12).
  2775
  2776***************    OUTPUT FROM ELRATE   *************************
  2777
  2778         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2779                                     COMP-3.
  2780         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2781                                     COMP-3.
  2782         16  CP-MORTALITY-CODE     PIC X(4).
  2783         16  CP-RATE-EDIT-FLAG     PIC X.
  2784             88  CP-RATES-NEED-APR                  VALUE '1'.
  2785         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2786                                     COMP-3.
  2787         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2788         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2789         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2790                                   PIC S9(7)V99 COMP-3.
  2791         16  FILLER                PIC X(07).
  2792
  2793***************    OUTPUT FROM ELRFND   *************************
  2794
  2795         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2796                                     COMP-3.
  2797         16  CP-REFUND-TYPE-USED   PIC X.
  2798           88  CP-R-AS-R78                         VALUE '1'.
  2799           88  CP-R-AS-PRORATA                     VALUE '2'.
  2800           88  CP-R-AS-CALIF                       VALUE '3'.
  2801           88  CP-R-AS-TEXAS                       VALUE '4'.
  2802           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2803           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2804           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2805           88  CP-R-AS-MEAN                        VALUE '8'.
  2806           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2807           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2808           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2809           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  54
* EL131.cbl
  2810           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2811           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2812         16  FILLER                PIC X(12).
  2813
  2814***************    OUTPUT FROM ELEARN   *************************
  2815
  2816         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2817                                     COMP-3.
  2818         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2819                                     COMP-3.
  2820         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2821                                     COMP-3.
  2822         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2823                                     COMP-3.
  2824         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2825                                     COMP-3.
  2826         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2827                                     COMP-3.
  2828         16  CP-EARNING-TYPE-USED  PIC X.
  2829           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2830           88  CP-E-AS-R78                         VALUE '1'.
  2831           88  CP-E-AS-PRORATA                     VALUE '2'.
  2832           88  CP-E-AS-TEXAS                       VALUE '4'.
  2833           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2834           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2835           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2836           88  CP-E-AS-MEAN                        VALUE '8'.
  2837           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2838         16  FILLER                PIC X(12).
  2839
  2840***************    OUTPUT FROM ELPMNT   *************************
  2841
  2842         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2843                                     COMP-3.
  2844         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2845                                     COMP-3.
  2846         16  FILLER                PIC X(12).
  2847
  2848***************   MISC WORK AREAS    *****************************
  2849         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2850                                     COMP-3.
  2851         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2852                                     COMP-3.
  2853         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2854                                     COMP-3.
  2855         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2856                                     COMP-3.
  2857         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2858                                     COMP-3.
  2859         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2860                                     COMP-3.
  2861         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2862             88  OPEN-RATE-FILE                   VALUE 'O'.
  2863             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2864             88  IO-ERROR                         VALUE 'E'.
  2865
  2866         16  CP-FIRST-PAY-DATE     PIC XX.
  2867
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  55
* EL131.cbl
  2868         16  CP-JOINT-INDICATOR    PIC X.
  2869
  2870         16  CP-RESERVE-REMAINING-TERM
  2871                                   PIC S9(4)V9    VALUE ZERO
  2872                                     COMP-3.
  2873
  2874         16  CP-INSURED-BIRTH-DT   PIC XX.
  2875
  2876         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2877                                     COMP-3.
  2878
  2879         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2880                                     COMP-3.
  2881
  2882         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2883                                     COMP-3.
  2884
  2885         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2886                                     COMP-3.
  2887
  2888         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2889                                     COMP-3.
  2890
  2891         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2892                                     COMP-3.
  2893
  2894         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2895                                     COMP-3.
  2896
  2897         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2898             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2899
  2900         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2901                                     COMP-3.
  2902         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2903                                     COMP-3.
  2904         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2905         16  FILLER                PIC X(15).
  2906******************************************************************
  2907
  2908*                                COPY ELCDATE.
  2909******************************************************************
  2910*                                                                *
  2911*                                                                *
  2912*                            ELCDATE.                            *
  2913*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2914*                            VMOD=2.003
  2915*                                                                *
  2916*                                                                *
  2917*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2918*                 LENGTH = 200                                   *
  2919******************************************************************
  2920
  2921 01  DATE-CONVERSION-DATA.
  2922     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2923     12  DC-OPTION-CODE                PIC X.
  2924         88  BIN-TO-GREG                VALUE ' '.
  2925         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  56
* EL131.cbl
  2926         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2927         88  YMD-GREG-TO-BIN            VALUE '3'.
  2928         88  MDY-GREG-TO-BIN            VALUE '4'.
  2929         88  JULIAN-TO-BIN              VALUE '5'.
  2930         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2931         88  FIND-CENTURY               VALUE '7'.
  2932         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2933         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2934         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2935         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2936         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2937         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2938         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2939         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2940         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2941         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2942         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2943         88  BIN-3-TO-GREG              VALUE 'I'.
  2944         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2945         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2946         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2947         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2948         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2949         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2950         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2951         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2952         88  THREE-CHARACTER-BIN
  2953                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2954         88  GREGORIAN-TO-BIN
  2955                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2956         88  BIN-TO-GREGORIAN
  2957                  VALUES ' ' '1' 'I' '8' 'G'.
  2958         88  JULIAN-TO-BINARY
  2959                  VALUES '5' 'C' 'E' 'F'.
  2960     12  DC-ERROR-CODE                 PIC X.
  2961         88  NO-CONVERSION-ERROR        VALUE ' '.
  2962         88  DATE-CONVERSION-ERROR
  2963                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2964         88  DATE-IS-ZERO               VALUE '1'.
  2965         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2966         88  DATE-IS-INVALID            VALUE '3'.
  2967         88  DATE1-GREATER-DATE2        VALUE '4'.
  2968         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2969         88  DATE-INVALID-OPTION        VALUE '9'.
  2970         88  INVALID-CENTURY            VALUE 'A'.
  2971         88  ONLY-CENTURY               VALUE 'B'.
  2972         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2973         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2974     12  DC-END-OF-MONTH               PIC X.
  2975         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2976     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2977         88  USE-NORMAL-PROCESS         VALUE ' '.
  2978         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2979         88  ADJUST-UP-100-YRS          VALUE '2'.
  2980     12  FILLER                        PIC X.
  2981     12  DC-CONVERSION-DATES.
  2982         16  DC-BIN-DATE-1             PIC XX.
  2983         16  DC-BIN-DATE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  57
* EL131.cbl
  2984         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2985         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2986                       DC-GREG-DATE-1-EDIT.
  2987             20  DC-EDIT1-MONTH        PIC 99.
  2988             20  SLASH1-1              PIC X.
  2989             20  DC-EDIT1-DAY          PIC 99.
  2990             20  SLASH1-2              PIC X.
  2991             20  DC-EDIT1-YEAR         PIC 99.
  2992         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2993         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2994                     DC-GREG-DATE-2-EDIT.
  2995             20  DC-EDIT2-MONTH        PIC 99.
  2996             20  SLASH2-1              PIC X.
  2997             20  DC-EDIT2-DAY          PIC 99.
  2998             20  SLASH2-2              PIC X.
  2999             20  DC-EDIT2-YEAR         PIC 99.
  3000         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3001         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3002                     DC-GREG-DATE-1-YMD.
  3003             20  DC-YMD-YEAR           PIC 99.
  3004             20  DC-YMD-MONTH          PIC 99.
  3005             20  DC-YMD-DAY            PIC 99.
  3006         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3007         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3008                      DC-GREG-DATE-1-MDY.
  3009             20  DC-MDY-MONTH          PIC 99.
  3010             20  DC-MDY-DAY            PIC 99.
  3011             20  DC-MDY-YEAR           PIC 99.
  3012         16  DC-GREG-DATE-1-ALPHA.
  3013             20  DC-ALPHA-MONTH        PIC X(10).
  3014             20  DC-ALPHA-DAY          PIC 99.
  3015             20  FILLER                PIC XX.
  3016             20  DC-ALPHA-CENTURY.
  3017                 24 DC-ALPHA-CEN-N     PIC 99.
  3018             20  DC-ALPHA-YEAR         PIC 99.
  3019         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3020         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3021         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3022         16  DC-JULIAN-DATE            PIC 9(05).
  3023         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  3024                                       PIC 9(05).
  3025         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3026             20  DC-JULIAN-YEAR        PIC 99.
  3027             20  DC-JULIAN-DAYS        PIC 999.
  3028         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3029         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3030         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3031     12  DATE-CONVERSION-VARIBLES.
  3032         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3033         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3034             20  FILLER                PIC 9(3).
  3035             20  HOLD-CEN-1-CCYY.
  3036                 24  HOLD-CEN-1-CC     PIC 99.
  3037                 24  HOLD-CEN-1-YY     PIC 99.
  3038             20  HOLD-CEN-1-MO         PIC 99.
  3039             20  HOLD-CEN-1-DA         PIC 99.
  3040         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3041             20  HOLD-CEN-1-R-MO       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  58
* EL131.cbl
  3042             20  HOLD-CEN-1-R-DA       PIC 99.
  3043             20  HOLD-CEN-1-R-CCYY.
  3044                 24  HOLD-CEN-1-R-CC   PIC 99.
  3045                 24  HOLD-CEN-1-R-YY   PIC 99.
  3046             20  FILLER                PIC 9(3).
  3047         16  HOLD-CENTURY-1-X.
  3048             20  FILLER                PIC X(3)  VALUE SPACES.
  3049             20  HOLD-CEN-1-X-CCYY.
  3050                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3051                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3052             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3053             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3054         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3055             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3056             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3057             20  HOLD-CEN-1-R-X-CCYY.
  3058                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3059                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3060             20  FILLER                PIC XXX.
  3061         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3062         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3063         16  DC-JULIAN-DATE-1          PIC 9(07).
  3064         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3065             20  DC-JULIAN-1-CCYY.
  3066                 24  DC-JULIAN-1-CC    PIC 99.
  3067                 24  DC-JULIAN-1-YR    PIC 99.
  3068             20  DC-JULIAN-DA-1        PIC 999.
  3069         16  DC-JULIAN-DATE-2          PIC 9(07).
  3070         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3071             20  DC-JULIAN-2-CCYY.
  3072                 24  DC-JULIAN-2-CC    PIC 99.
  3073                 24  DC-JULIAN-2-YR    PIC 99.
  3074             20  DC-JULIAN-DA-2        PIC 999.
  3075         16  DC-GREG-DATE-A-EDIT.
  3076             20  DC-EDITA-MONTH        PIC 99.
  3077             20  SLASHA-1              PIC X VALUE '/'.
  3078             20  DC-EDITA-DAY          PIC 99.
  3079             20  SLASHA-2              PIC X VALUE '/'.
  3080             20  DC-EDITA-CCYY.
  3081                 24  DC-EDITA-CENT     PIC 99.
  3082                 24  DC-EDITA-YEAR     PIC 99.
  3083         16  DC-GREG-DATE-B-EDIT.
  3084             20  DC-EDITB-MONTH        PIC 99.
  3085             20  SLASHB-1              PIC X VALUE '/'.
  3086             20  DC-EDITB-DAY          PIC 99.
  3087             20  SLASHB-2              PIC X VALUE '/'.
  3088             20  DC-EDITB-CCYY.
  3089                 24  DC-EDITB-CENT     PIC 99.
  3090                 24  DC-EDITB-YEAR     PIC 99.
  3091         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3092         16  DC-GREG-DATE-CYMD-R REDEFINES
  3093                              DC-GREG-DATE-CYMD.
  3094             20  DC-CYMD-CEN           PIC 99.
  3095             20  DC-CYMD-YEAR          PIC 99.
  3096             20  DC-CYMD-MONTH         PIC 99.
  3097             20  DC-CYMD-DAY           PIC 99.
  3098         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3099         16  DC-GREG-DATE-MDCY-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  59
* EL131.cbl
  3100                              DC-GREG-DATE-MDCY.
  3101             20  DC-MDCY-MONTH         PIC 99.
  3102             20  DC-MDCY-DAY           PIC 99.
  3103             20  DC-MDCY-CEN           PIC 99.
  3104             20  DC-MDCY-YEAR          PIC 99.
  3105    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3106        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3107    12  DC-EL310-DATE                  PIC X(21).
  3108    12  FILLER                         PIC X(28).
  3109
  3110*                                COPY ELCDMO.
  3111******************************************************************
  3112*                                                                *
  3113*                                                                *
  3114*                            ELCDMO.                             *
  3115*                            VMOD=2.004                          *
  3116*                                                                *
  3117*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  3118*        COMMUNICATION AREA                                      *
  3119*   FILE TYPE = NA                                               *
  3120*   RECORD SIZE = 110    RECFORM = FIXED                         *
  3121*                                                                *
  3122******************************************************************
  3123 01  DMO-COMMUNICATION-AREA.
  3124     12  DM-RECORD-TYPE                  PIC  X(02).
  3125             88  DM-ISSUE-TRAN                VALUE 'CC'.
  3126             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  3127             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  3128     12  DM-DIST-CODE                    PIC  X(04).
  3129     12  DM-MAIL-CODE                    PIC  X(05).
  3130     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  3131     12  DM-INSURED-NAME                 PIC  X(30).
  3132     12  DM-CLAIM-NO                     PIC  X(07).
  3133     12  DM-CLAIM-TYPE                   PIC  X.
  3134
  3135     12  DM-STATUS-DATA-AREA.
  3136         16  DM-CLAIM-STATUS             PIC  X.
  3137             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  3138             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  3139             88  DM-CLOSED                        VALUE '3'.
  3140             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  3141             88  DM-DEFAULT                       VALUE '9'.
  3142         16  DM-STATUS-DATE              PIC  X(08).
  3143******YYYYMMDD
  3144         16  DM-STAT-CHANGE-TYPE         PIC  X.
  3145             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  3146             88  DM-CLAIM-DENIED                  VALUE 'D'.
  3147             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  3148             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  3149             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  3150             88  DM-RE-OPENED                     VALUE 'R'.
  3151             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  3152             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  3153             88  DM-CLAIM-DELETED                 VALUE 'X'.
  3154         16  DM-STAT-CARRIER             PIC X.
  3155
  3156     12  DM-DRAFT-DATA-AREA.
  3157         16  DM-PAYMENT-TYPE             PIC  X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  60
* EL131.cbl
  3158             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  3159         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  3160         16  DM-PAYMENT-DATE             PIC  X(08).
  3161******YYYYMMDD
  3162         16  DM-CERT-NO                  PIC  X(11).
  3163         16  DM-TRLR-SEQ-NO              PIC  9(04).
  3164         16  DM-CARRIER                  PIC  X.
  3165
  3166     12  DM-RETURN-CODE                  PIC  XX.
  3167*                                COPY ERCPDEF.
  3168******************************************************************
  3169*                                                                *
  3170*                                                                *
  3171*                            ERCPDEF.                            *
  3172*                                                                *
  3173*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  3174*                                                                *
  3175*    FILE TYPE = VSAM,KSDS                                       *
  3176*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  3177*                                                                *
  3178*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  3179*                                                                *
  3180*    LOG = YES                                                   *
  3181*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3182******************************************************************
  3183 01  PRODUCT-MASTER.
  3184    12  PD-RECORD-ID                 PIC X(02).
  3185        88  VALID-PD-ID                  VALUE 'PD'.
  3186    12  PD-CONTROL-PRIMARY.
  3187        16  PD-COMPANY-CD            PIC X.
  3188        16  PD-STATE                 PIC XX.
  3189        16  PD-PRODUCT-CD            PIC XXX.
  3190        16  PD-FILLER                PIC X(7).
  3191        16  PD-BEN-TYPE              PIC X.
  3192        16  PD-BEN-CODE              PIC XX.
  3193        16  PD-PROD-EXP-DT           PIC XX.
  3194    12  FILLER                       PIC X(50).
  3195    12  PD-PRODUCT-DATA OCCURS 8.
  3196        16  PD-PROD-CODE             PIC X.
  3197            88  PD-PROD-LIFE           VALUE 'L'.
  3198            88  PD-PROD-PROP           VALUE 'P'.
  3199            88  PD-PROD-AH             VALUE 'A'.
  3200            88  PD-PROD-IU             VALUE 'I'.
  3201            88  PD-PROD-GAP            VALUE 'G'.
  3202        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  3203        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  3204        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  3205        16  PD-MAX-TERM              PIC S999        COMP-3.
  3206        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  3207        16  FILLER                   PIC X.
  3208        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  3209        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  3210        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  3211        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
  3212        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  3213        16  PD-REC-CRIT-PERIOD       PIC X.
  3214        16  PD-RTW-MOS               PIC 99.
  3215        16  FILLER                   PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  61
* EL131.cbl
  3216    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  3217    12  PD-TERM-LIMITS OCCURS 15.
  3218        16  PD-LOW-TERM              PIC S999        COMP-3.
  3219        16  PD-HI-TERM               PIC S999        COMP-3.
  3220*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  3221    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  3222        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  3223        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  3224    12  PD-EARN-FACTORS.
  3225        16  FILLER OCCURS 15.
  3226            20  FILLER OCCURS 15.
  3227                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  3228    12  PD-PRODUCT-DESC              PIC X(80).
  3229    12  PD-TRUNCATED                 PIC X.
  3230    12  FILLER                       PIC X(59).
  3231    12  PD-MAINT-INFORMATION.
  3232        16  PD-LAST-MAINT-DT         PIC X(02).
  3233        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  3234        16  PD-LAST-MAINT-BY         PIC X(04).
  3235*                                COPY ELCCRTT.
  3236******************************************************************
  3237*                                                                *
  3238*                            ELCCRTT.                            *
  3239*                                                                *
  3240*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  3241*                                                                *
  3242*   FILE TYPE = VSAM,KSDS                                        *
  3243*   RECORD SIZE = 552  RECFORM = FIXED                           *
  3244*                                                                *
  3245*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  3246*                                                                *
  3247*   LOG = YES                                                    *
  3248*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3249******************************************************************
  3250*                   C H A N G E   L O G
  3251*
  3252* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3253*-----------------------------------------------------------------
  3254*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3255* EFFECTIVE    NUMBER
  3256*-----------------------------------------------------------------
  3257* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  3258* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  3259* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  3260* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  3261* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  3262******************************************************************
  3263
  3264 01  CERTIFICATE-TRAILERS.
  3265     12  CS-RECORD-ID                      PIC XX.
  3266         88  VALID-CS-ID                      VALUE 'CS'.
  3267
  3268     12  CS-CONTROL-PRIMARY.
  3269         16  CS-COMPANY-CD                 PIC X.
  3270         16  CS-CARRIER                    PIC X.
  3271         16  CS-GROUPING                   PIC X(6).
  3272         16  CS-STATE                      PIC XX.
  3273         16  CS-ACCOUNT                    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  62
* EL131.cbl
  3274         16  CS-CERT-EFF-DT                PIC XX.
  3275         16  CS-CERT-NO.
  3276             20  CS-CERT-PRIME             PIC X(10).
  3277             20  CS-CERT-SFX               PIC X.
  3278         16  CS-TRAILER-TYPE               PIC X.
  3279             88  COMM-TRLR           VALUE 'A'.
  3280             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  3281             88  CERT-DATA-TRLR      VALUE 'C'.
  3282
  3283     12  CS-DATA-AREA                      PIC X(516).
  3284
  3285     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  3286         16  CS-BANK-COMMISSION-AREA.
  3287             20  CS-BANK-COMMS       OCCURS 10.
  3288                 24  CS-AGT                PIC X(10).
  3289                 24  CS-COM-TYP            PIC X.
  3290                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  3291                 24  CS-RECALC-LV-INDIC    PIC X.
  3292                 24  FILLER                PIC X(10).
  3293         16  FILLER                        PIC X(256).
  3294
  3295     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  3296****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  3297****  1ST OCCURANCE IS PRIMARY, 2ND IS SECONDARY INSURED
  3298         16  CS-MB-CLAIM-DATA OCCURS 2.
  3299             20  FILLER OCCURS 10.
  3300                 24  CS-CLAIM-TYPE         PIC X.
  3301                     88  CS-AH-CLM           VALUE 'A'.
  3302                     88  CS-IU-CLM           VALUE 'I'.
  3303                     88  CS-GP-CLM           VALUE 'G'.
  3304                     88  CS-LF-CLM           VALUE 'L'.
  3305                     88  CS-PR-CLM           VALUE 'P'.
  3306                 24  CS-BANK               PIC S999 COMP-3.
  3307                 24  CS-NO-OF-CLAIMS       PIC S999 COMP-3.
  3308                 24  CS-DAYS-PAID          PIC S9(7) COMP-3.
  3309                 24  CS-TOTAL-PAID         PIC S9(9)V99 COMP-3.
  3310         16  FILLER                        PIC X(216).
  3311     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  3312         16  CS-VIN-NUMBER                 PIC X(17).
  3313         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  3314         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  3315         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  3316         16  FILLER                        PIC X(496).
  3317******************************************************************
  3318
  3319****************************************************************
  3320*
  3321* Copyright (c) 2007 by Clerity Solutions, Inc.
  3322* All rights reserved.
  3323*
  3324****************************************************************
  3325 01  DFHEIV.
  3326   02  DFHEIV0               PIC X(35).
  3327   02  DFHEIV1               PIC X(08).
  3328   02  DFHEIV2               PIC X(08).
  3329   02  DFHEIV3               PIC X(08).
  3330   02  DFHEIV4               PIC X(06).
  3331   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  63
* EL131.cbl
  3332   02  DFHEIV6               PIC X(04).
  3333   02  DFHEIV7               PIC X(02).
  3334   02  DFHEIV8               PIC X(02).
  3335   02  DFHEIV9               PIC X(01).
  3336   02  DFHEIV10              PIC S9(7) COMP-3.
  3337   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3338   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3339   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3340   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3341   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3342   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3343   02  DFHEIV17              PIC X(04).
  3344   02  DFHEIV18              PIC X(04).
  3345   02  DFHEIV19              PIC X(04).
  3346   02  DFHEIV20              USAGE IS POINTER.
  3347   02  DFHEIV21              USAGE IS POINTER.
  3348   02  DFHEIV22              USAGE IS POINTER.
  3349   02  DFHEIV23              USAGE IS POINTER.
  3350   02  DFHEIV24              USAGE IS POINTER.
  3351   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3352   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3353   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3354   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3355   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3356   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3357   02  FILLER                PIC X(02).
  3358   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3359   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3360   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3361   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3362   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3363 LINKAGE  SECTION.
  3364*****************************************************************
  3365*                                                               *
  3366* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3367* All rights reserved.                                          *
  3368*                                                               *
  3369*****************************************************************
  3370 01  dfheiblk.
  3371     02  eibtime          pic s9(7) comp-3.
  3372     02  eibdate          pic s9(7) comp-3.
  3373     02  eibtrnid         pic x(4).
  3374     02  eibtaskn         pic s9(7) comp-3.
  3375     02  eibtrmid         pic x(4).
  3376     02  dfheigdi         pic s9(4) comp.
  3377     02  eibcposn         pic s9(4) comp.
  3378     02  eibcalen         pic s9(4) comp.
  3379     02  eibaid           pic x(1).
  3380     02  eibfiller1       pic x(1).
  3381     02  eibfn            pic x(2).
  3382     02  eibfiller2       pic x(2).
  3383     02  eibrcode         pic x(6).
  3384     02  eibfiller3       pic x(2).
  3385     02  eibds            pic x(8).
  3386     02  eibreqid         pic x(8).
  3387     02  eibrsrce         pic x(8).
  3388     02  eibsync          pic x(1).
  3389     02  eibfree          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  64
* EL131.cbl
  3390     02  eibrecv          pic x(1).
  3391     02  eibsend          pic x(1).
  3392     02  eibatt           pic x(1).
  3393     02  eibeoc           pic x(1).
  3394     02  eibfmh           pic x(1).
  3395     02  eibcompl         pic x(1).
  3396     02  eibsig           pic x(1).
  3397     02  eibconf          pic x(1).
  3398     02  eiberr           pic x(1).
  3399     02  eibrldbk         pic x(1).
  3400     02  eiberrcd         pic x(4).
  3401     02  eibsynrb         pic x(1).
  3402     02  eibnodat         pic x(1).
  3403     02  eibfiller5       pic x(2).
  3404     02  eibresp          pic 9(09) comp.
  3405     02  eibresp2         pic 9(09) comp.
  3406     02  dfheigdj         pic s9(4) comp.
  3407     02  dfheigdk         pic s9(4) comp.
  3408 01  DFHCOMMAREA                 PIC X(1024).
  3409
  3410*                                COPY ELCMSTR.
  3411******************************************************************
  3412*                                                                *
  3413*                            ELCMSTR.                            *
  3414*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3415*                            VMOD=2.012                          *
  3416*                                                                *
  3417*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3418*                                                                *
  3419*   FILE TYPE = VSAM,KSDS                                        *
  3420*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3421*                                                                *
  3422*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3423*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3424*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3425*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3426*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3427*                                                 RKP=75,LEN=21  *
  3428*                                                                *
  3429*   **** NOTE ****                                               *
  3430*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3431*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3432*                                                                *
  3433*   LOG = YES                                                    *
  3434*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3435******************************************************************
  3436*                   C H A N G E   L O G
  3437*
  3438* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3439*-----------------------------------------------------------------
  3440*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3441* EFFECTIVE    NUMBER
  3442*-----------------------------------------------------------------
  3443* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3444* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3445* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3446******************************************************************
  3447 01  CLAIM-MASTER.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  65
* EL131.cbl
  3448     12  CL-RECORD-ID                PIC XX.
  3449         88  VALID-CL-ID         VALUE 'CL'.
  3450
  3451     12  CL-CONTROL-PRIMARY.
  3452         16  CL-COMPANY-CD           PIC X.
  3453         16  CL-CARRIER              PIC X.
  3454         16  CL-CLAIM-NO             PIC X(7).
  3455         16  CL-CERT-NO.
  3456             20  CL-CERT-PRIME       PIC X(10).
  3457             20  CL-CERT-SFX         PIC X.
  3458
  3459     12  CL-CONTROL-BY-NAME.
  3460         16  CL-COMPANY-CD-A1        PIC X.
  3461         16  CL-INSURED-LAST-NAME    PIC X(15).
  3462         16  CL-INSURED-NAME.
  3463             20  CL-INSURED-1ST-NAME PIC X(12).
  3464             20  CL-INSURED-MID-INIT PIC X.
  3465
  3466     12  CL-CONTROL-BY-SSN.
  3467         16  CL-COMPANY-CD-A2        PIC X.
  3468         16  CL-SOC-SEC-NO.
  3469             20  CL-SSN-STATE        PIC XX.
  3470             20  CL-SSN-ACCOUNT      PIC X(6).
  3471             20  CL-SSN-LN3          PIC X(3).
  3472
  3473     12  CL-CONTROL-BY-CERT-NO.
  3474         16  CL-COMPANY-CD-A4        PIC X.
  3475         16  CL-CERT-NO-A4.
  3476             20  CL-CERT-A4-PRIME    PIC X(10).
  3477             20  CL-CERT-A4-SFX      PIC X.
  3478
  3479     12  CL-CONTROL-BY-CCN.
  3480         16  CL-COMPANY-CD-A5        PIC X.
  3481         16  CL-CCN-A5.
  3482             20  CL-CCN.
  3483                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3484                 24  CL-CCN-PRIME-A5 PIC X(12).
  3485             20  CL-CCN-FILLER-A5    PIC X(4).
  3486
  3487     12  CL-INSURED-PROFILE-DATA.
  3488         16  CL-INSURED-BIRTH-DT     PIC XX.
  3489         16  CL-INSURED-SEX-CD       PIC X.
  3490             88  INSURED-IS-MALE        VALUE 'M'.
  3491             88  INSURED-IS-FEMALE      VALUE 'F'.
  3492             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3493         16  CL-INSURED-OCC-CD       PIC X(6).
  3494         16  FILLER                  PIC X(5).
  3495
  3496     12  CL-PROCESSING-INFO.
  3497         16  CL-PROCESSOR-ID         PIC X(4).
  3498         16  CL-CLAIM-STATUS         PIC X.
  3499             88  CLAIM-IS-OPEN          VALUE 'O'.
  3500             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3501         16  CL-CLAIM-TYPE           PIC X.
  3502*            88  AH-CLAIM               VALUE 'A'.
  3503*            88  LIFE-CLAIM             VALUE 'L'.
  3504*            88  PROPERTY-CLAIM         VALUE 'P'.
  3505*            88  IUI-CLAIM              VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  66
* EL131.cbl
  3506*            88  GAP-CLAIM              VALUE 'G'.
  3507         16  CL-CLAIM-PREM-TYPE      PIC X.
  3508             88  SINGLE-PREMIUM         VALUE '1'.
  3509             88  O-B-COVERAGE           VALUE '2'.
  3510             88  OPEN-END-COVERAGE      VALUE '3'.
  3511         16  CL-INCURRED-DT          PIC XX.
  3512         16  CL-REPORTED-DT          PIC XX.
  3513         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3514         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3515         16  CL-LAST-PMT-DT          PIC XX.
  3516         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3517         16  CL-PAID-THRU-DT         PIC XX.
  3518         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3519         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3520         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3521         16  CL-PMT-CALC-METHOD      PIC X.
  3522             88  CL-360-DAY-YR          VALUE '1'.
  3523             88  CL-365-DAY-YR          VALUE '2'.
  3524             88  CL-FULL-MONTHS         VALUE '3'.
  3525         16  CL-CAUSE-CD             PIC X(6).
  3526
  3527         16  CL-PRIME-CERT-NO.
  3528             20  CL-PRIME-CERT-PRIME PIC X(10).
  3529             20  CL-PRIME-CERT-SFX   PIC X.
  3530
  3531         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3532             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3533             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3534
  3535         16  CL-MICROFILM-NO         PIC X(10).
  3536         16  CL-PROG-FORM-TYPE       PIC X.
  3537         16  CL-LAST-ADD-ON-DT       PIC XX.
  3538
  3539         16  CL-LAST-REOPEN-DT       PIC XX.
  3540         16  CL-LAST-CLOSE-DT        PIC XX.
  3541         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3542             88  FINAL-PAID             VALUE '1'.
  3543             88  CLAIM-DENIED           VALUE '2'.
  3544             88  AUTO-CLOSE             VALUE '3'.
  3545             88  MANUAL-CLOSE           VALUE '4'.
  3546             88  BENEFITS-CHANGED       VALUE 'C'.
  3547             88  SETUP-ERRORS           VALUE 'E'.
  3548         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3549         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3550         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3551             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3552         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3553         16  FILLER                  PIC X.
  3554
  3555     12  CL-CERTIFICATE-DATA.
  3556         16  CL-CERT-ORIGIN          PIC X.
  3557             88  CERT-WAS-ONLINE        VALUE '1'.
  3558             88  CERT-WAS-CREATED       VALUE '2'.
  3559             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3560         16  CL-CERT-KEY-DATA.
  3561             20  CL-CERT-CARRIER     PIC X.
  3562             20  CL-CERT-GROUPING    PIC X(6).
  3563             20  CL-CERT-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  67
* EL131.cbl
  3564             20  CL-CERT-ACCOUNT.
  3565                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3566                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3567             20  CL-CERT-EFF-DT      PIC XX.
  3568
  3569     12  CL-STATUS-CONTROLS.
  3570         16  CL-PRIORITY-CD          PIC X.
  3571             88  CONFIDENTIAL-DATA      VALUE '8'.
  3572             88  HIGHEST-PRIORITY       VALUE '9'.
  3573         16  CL-SUPV-ATTN-CD         PIC X.
  3574             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3575             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3576         16  CL-PURGED-DT            PIC XX.
  3577         16  CL-RESTORED-DT          PIC XX.
  3578         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3579         16  CL-NEXT-RESEND-DT       PIC XX.
  3580         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3581         16  CL-CRITICAL-PERIOD      PIC 99.
  3582*        16  FILLER                  PIC XX.
  3583         16  CL-LAST-MAINT-DT        PIC XX.
  3584         16  CL-LAST-MAINT-USER      PIC X(4).
  3585         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3586         16  CL-LAST-MAINT-TYPE      PIC X.
  3587             88  CLAIM-SET-UP           VALUE ' '.
  3588             88  PAYMENT-MADE           VALUE '1'.
  3589             88  LETTER-SENT            VALUE '2'.
  3590             88  MASTER-WAS-ALTERED     VALUE '3'.
  3591             88  MASTER-WAS-RESTORED    VALUE '4'.
  3592             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3593             88  FILE-CONVERTED         VALUE '6'.
  3594             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3595             88  ERROR-CORRECTION       VALUE 'E'.
  3596         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3597         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3598         16  CL-BENEFICIARY          PIC X(10).
  3599         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3600         16  CL-DENIAL-TYPE          PIC X.
  3601             88  CL-TYPE-DENIAL          VALUE '1'.
  3602             88  CL-TYPE-RESCISSION      VALUE '2'.
  3603             88  CL-TYPE-REFORMATION     VALUE '3'.
  3604             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3605             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3606         16  CL-CRIT-PER-RECURRENT   PIC X.
  3607         16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3608         16  CL-RTW-DT               PIC XX.
  3609
  3610     12  CL-TRAILER-CONTROLS.
  3611         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3612             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3613             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3614             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3615         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3616         16  FILLER                  PIC XX.
  3617         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3618         16  CL-ADDRESS-TRAILER-CNT.
  3619             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3620                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3621             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  68
* EL131.cbl
  3622                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3623             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3624                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3625             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3626                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3627             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3628                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3629             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3630                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3631             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3632                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  3633
  3634     12  CL-CV-REFERENCE-NO.
  3635         16  CL-CV-REFNO-PRIME       PIC X(18).
  3636         16  CL-CV-REFNO-SFX         PIC XX.
  3637
  3638     12  CL-FILE-LOCATION            PIC X(4).
  3639
  3640     12  CL-PROCESS-ERRORS.
  3641         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3642             88  NO-FATAL-ERRORS        VALUE ZERO.
  3643         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3644             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3645
  3646     12  CL-PRODUCT-CD               PIC X.
  3647
  3648     12  CL-CURRENT-KEY-DATA.
  3649         16  CL-CURRENT-CARRIER      PIC X.
  3650         16  CL-CURRENT-GROUPING     PIC X(6).
  3651         16  CL-CURRENT-STATE        PIC XX.
  3652         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3653
  3654     12  CL-ASSOCIATES               PIC X.
  3655         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3656         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3657         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3658         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3659
  3660     12  CL-ACTIVITY-CODE            PIC 99.
  3661     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3662     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3663
  3664     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3665     12  CL-LAG-REPORT-CODE          PIC 9.
  3666     12  CL-LOAN-TYPE                PIC XX.
  3667     12  CL-LEGAL-STATE              PIC XX.
  3668
  3669     12  CL-YESNOSW                  PIC X.
  3670     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3671         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3672         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3673         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3674     12  cl-insured-claim            pic x.
  3675         88  cl-claim-on-primary         value 'P'.
  3676         88  cl-claim-on-secondary       value 'S'.
  3677     12  cl-benefit-expiration-dt    PIC XX.
  3678
  3679*                                COPY ELCCERT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  69
* EL131.cbl
  3680******************************************************************
  3681*                                                                *
  3682*                            ELCCERT.                            *
  3683*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3684*                            VMOD=2.013                          *
  3685*                                                                *
  3686*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3687*                                                                *
  3688*   FILE TYPE = VSAM,KSDS                                        *
  3689*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3690*                                                                *
  3691*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3692*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3693*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3694*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3695*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3696*                                                                *
  3697*   LOG = YES                                                    *
  3698*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3699******************************************************************
  3700*                   C H A N G E   L O G
  3701*
  3702* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3703*-----------------------------------------------------------------
  3704*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3705* EFFECTIVE    NUMBER
  3706*-----------------------------------------------------------------
  3707* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3708* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3709* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3710* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3711* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3712* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3713* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3714* 032612  CR2011110200001  PEMA  AHL CHANGES
  3715******************************************************************
  3716
  3717 01  CERTIFICATE-MASTER.
  3718     12  CM-RECORD-ID                      PIC XX.
  3719         88  VALID-CM-ID                      VALUE 'CM'.
  3720
  3721     12  CM-CONTROL-PRIMARY.
  3722         16  CM-COMPANY-CD                 PIC X.
  3723         16  CM-CARRIER                    PIC X.
  3724         16  CM-GROUPING.
  3725             20  CM-GROUPING-PREFIX        PIC X(3).
  3726             20  CM-GROUPING-PRIME         PIC X(3).
  3727         16  CM-STATE                      PIC XX.
  3728         16  CM-ACCOUNT.
  3729             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3730             20  CM-ACCOUNT-PRIME          PIC X(6).
  3731         16  CM-CERT-EFF-DT                PIC XX.
  3732         16  CM-CERT-NO.
  3733             20  CM-CERT-PRIME             PIC X(10).
  3734             20  CM-CERT-SFX               PIC X.
  3735
  3736     12  CM-CONTROL-BY-NAME.
  3737         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  70
* EL131.cbl
  3738         16  CM-INSURED-LAST-NAME          PIC X(15).
  3739         16  CM-INSURED-INITIALS.
  3740             20  CM-INSURED-INITIAL1       PIC X.
  3741             20  CM-INSURED-INITIAL2       PIC X.
  3742
  3743     12  CM-CONTROL-BY-SSN.
  3744         16  CM-COMPANY-CD-A2              PIC X.
  3745         16  CM-SOC-SEC-NO.
  3746             20  CM-SSN-STATE              PIC XX.
  3747             20  CM-SSN-ACCOUNT            PIC X(6).
  3748             20  CM-SSN-LN3.
  3749                 25  CM-INSURED-INITIALS-A2.
  3750                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3751                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3752                 25 CM-PART-LAST-NAME-A2         PIC X.
  3753
  3754     12  CM-CONTROL-BY-CERT-NO.
  3755         16  CM-COMPANY-CD-A4              PIC X.
  3756         16  CM-CERT-NO-A4                 PIC X(11).
  3757
  3758     12  CM-CONTROL-BY-MEMB.
  3759         16  CM-COMPANY-CD-A5              PIC X.
  3760         16  CM-MEMBER-NO.
  3761             20  CM-MEMB-STATE             PIC XX.
  3762             20  CM-MEMB-ACCOUNT           PIC X(6).
  3763             20  CM-MEMB-LN4.
  3764                 25  CM-INSURED-INITIALS-A5.
  3765                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3766                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3767                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3768
  3769     12  CM-INSURED-PROFILE-DATA.
  3770         16  CM-INSURED-FIRST-NAME.
  3771             20  CM-INSURED-1ST-INIT       PIC X.
  3772             20  FILLER                    PIC X(9).
  3773         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3774         16  CM-INSURED-SEX                PIC X.
  3775             88  CM-SEX-MALE                  VALUE 'M'.
  3776             88  CM-SEX-FEMAL                 VALUE 'F'.
  3777         16  CM-INSURED-JOINT-AGE          PIC 99.
  3778         16  CM-JOINT-INSURED-NAME.
  3779             20  CM-JT-LAST-NAME           PIC X(15).
  3780             20  CM-JT-FIRST-NAME.
  3781                 24  CM-JT-1ST-INIT        PIC X.
  3782                 24  FILLER                PIC X(9).
  3783             20  CM-JT-INITIAL             PIC X.
  3784
  3785     12  CM-LIFE-DATA.
  3786         16  CM-LF-BENEFIT-CD              PIC XX.
  3787         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3788         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3789         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3790         16  CM-LF-DEV-CODE                PIC XXX.
  3791         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3792         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3793         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3794         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3795         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  71
* EL131.cbl
  3796         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3797         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3798         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3799         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3800         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3801         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3802         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3803         16  FILLER                        PIC XX.
  3804
  3805     12  CM-AH-DATA.
  3806         16  CM-AH-BENEFIT-CD              PIC XX.
  3807         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3808         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3809         16  CM-AH-DEV-CODE                PIC XXX.
  3810         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3811         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3812         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3813         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3814         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3815         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3816         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3817         16  CM-AH-PAID-THRU-DT            PIC XX.
  3818             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3819         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3820         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3821         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3822         16  FILLER                        PIC X.
  3823
  3824     12  CM-LOAN-INFORMATION.
  3825         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3826         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  3827                                           PIC S9(5)V99  COMP-3.
  3828         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3829         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3830         16  CM-PAY-FREQUENCY              PIC S99.
  3831         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3832         16  CM-RATE-CLASS                 PIC XX.
  3833         16  CM-BENEFICIARY                PIC X(25).
  3834         16  CM-POLICY-FORM-NO             PIC X(12).
  3835         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3836         16  CM-LAST-ADD-ON-DT             PIC XX.
  3837         16  CM-DEDUCTIBLE-AMOUNTS.
  3838             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3839             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3840         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3841             20  CM-RESIDENT-STATE         PIC XX.
  3842             20  CM-RATE-CODE              PIC X(4).
  3843             20  FILLER                    PIC XX.
  3844         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3845             20  CM-LOAN-OFFICER           PIC X(5).
  3846             20  FILLER                    PIC XXX.
  3847         16  CM-CSR-CODE                   PIC XXX.
  3848         16  CM-UNDERWRITING-CODE          PIC X.
  3849             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3850         16  CM-POST-CARD-IND              PIC X.
  3851         16  CM-NH-INTERFACE-SW            PIC X.
  3852         16  CM-PREMIUM-TYPE               PIC X.
  3853             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  72
* EL131.cbl
  3854             88  CM-O-B-COVERAGE              VALUE '2'.
  3855             88  CM-OPEN-END                  VALUE '3'.
  3856         16  CM-IND-GRP-TYPE               PIC X.
  3857             88  CM-INDIVIDUAL                VALUE 'I'.
  3858             88  CM-GROUP                     VALUE 'G'.
  3859         16  CM-SKIP-CODE                  PIC X.
  3860             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3861             88  SKIP-JULY                    VALUE '1'.
  3862             88  SKIP-AUGUST                  VALUE '2'.
  3863             88  SKIP-SEPTEMBER               VALUE '3'.
  3864             88  SKIP-JULY-AUG                VALUE '4'.
  3865             88  SKIP-AUG-SEPT                VALUE '5'.
  3866             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3867             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3868             88  SKIP-JUNE                    VALUE '8'.
  3869             88  SKIP-JUNE-JULY               VALUE '9'.
  3870             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3871             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3872         16  CM-PAYMENT-MODE               PIC X.
  3873             88  PAY-MONTHLY                  VALUE SPACE.
  3874             88  PAY-WEEKLY                   VALUE '1'.
  3875             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3876             88  PAY-BI-WEEKLY                VALUE '3'.
  3877             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3878         16  CM-LOAN-NUMBER                PIC X(8).
  3879         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3880         16  CM-OLD-LOF                    PIC XXX.
  3881*        16  CM-LOAN-OFFICER               PIC XXX.
  3882         16  CM-REIN-TABLE                 PIC XXX.
  3883         16  CM-SPECIAL-REIN-CODE          PIC X.
  3884         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3885         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3886         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3887
  3888     12  CM-STATUS-DATA.
  3889         16  CM-ENTRY-STATUS               PIC X.
  3890         16  CM-ENTRY-DT                   PIC XX.
  3891
  3892         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3893         16  CM-LF-CANCEL-DT               PIC XX.
  3894         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3895
  3896         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3897         16  CM-LF-DEATH-DT                PIC XX.
  3898         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3899
  3900         16  CM-LF-CURRENT-STATUS          PIC X.
  3901             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3902                                                'M' '4' '5' '9'.
  3903             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3904             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3905             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3906             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3907             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3908             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3909             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  3910             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3911             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  73
* EL131.cbl
  3912             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3913             88  CM-LF-DECLINED               VALUE 'D'.
  3914             88  CM-LF-VOIDED                 VALUE 'V'.
  3915
  3916         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3917         16  CM-AH-CANCEL-DT               PIC XX.
  3918         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3919
  3920         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3921         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3922         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3923
  3924         16  CM-AH-CURRENT-STATUS          PIC X.
  3925             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3926                                                'M' '4' '5' '9'.
  3927             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3928             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3929             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3930             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3931             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3932             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3933             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3934             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3935             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  3936             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  3937             88  CM-AH-DECLINED               VALUE 'D'.
  3938             88  CM-AH-VOIDED                 VALUE 'V'.
  3939
  3940         16  CM-CLAIM-INTERFACE-SW         PIC X.
  3941             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  3942             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  3943             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  3944         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  3945
  3946         16  CM-ENTRY-BATCH                PIC X(6).
  3947         16  CM-LF-EXIT-BATCH              PIC X(6).
  3948         16  CM-AH-EXIT-BATCH              PIC X(6).
  3949         16  CM-LAST-MONTH-END             PIC XX.
  3950
  3951     12  CM-NOTE-SW                        PIC X.
  3952         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  3953         88  CERT-NOTES-PRESENT               VALUE '1'.
  3954         88  BILLING-NOTES-PRESENT            VALUE '2'.
  3955         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  3956         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  3957         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  3958         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  3959         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  3960     12  CM-COMP-EXCP-SW                   PIC X.
  3961         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  3962         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  3963     12  CM-INSURED-ADDRESS-SW             PIC X.
  3964         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  3965         88  INSURED-ADDR-PRESENT             VALUE '1'.
  3966
  3967*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  3968     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  3969     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  74
* EL131.cbl
  3970
  3971*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  3972     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  3973     12  FILLER                            PIC X.
  3974*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  3975     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  3976
  3977     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  3978         88  CERT-ADDED-BATCH                 VALUE ' '.
  3979         88  CERT-ADDED-ONLINE                VALUE '1'.
  3980         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  3981         88  CERT-PURGED-OFFLINE              VALUE '3'.
  3982         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  3983     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  3984         88  CERT-AS-LOADED                   VALUE ' '.
  3985         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  3986         88  CERT-CLAIM-ONLINE                VALUE '2'.
  3987         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  3988         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  3989         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  3990         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  3991         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  3992
  3993     12  CM-ACCOUNT-COMM-PCTS.
  3994         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  3995         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3996
  3997     12  CM-USER-FIELD                     PIC X.
  3998     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  3999     12  CM-CLP-STATE                      PIC XX.
  4000     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4001     12  CM-USER-RESERVED                  PIC XXX.
  4002     12  FILLER REDEFINES CM-USER-RESERVED.
  4003         16  CM-AH-CLASS-CD                PIC XX.
  4004         16  F                             PIC X.
  4005******************************************************************
  4006
  4007*                                COPY ELCTRLR.
  4008******************************************************************
  4009*                                                                *
  4010*                            ELCTRLR.                            *
  4011*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4012*                            VMOD=2.014                          *
  4013*                                                                *
  4014*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  4015*                                                                *
  4016*   FILE TYPE = VSAM,KSDS                                        *
  4017*   RECORD SIZE = 200    RECFORM = FIXED                         *
  4018*                                                                *
  4019*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  4020*       ALTERNATE INDEX = NONE                                   *
  4021*                                                                *
  4022*   LOG = YES                                                    *
  4023*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4024******************************************************************
  4025*                   C H A N G E   L O G
  4026*
  4027* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  75
* EL131.cbl
  4028*-----------------------------------------------------------------
  4029*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4030* EFFECTIVE    NUMBER
  4031*-----------------------------------------------------------------
  4032* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  4033* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  4034* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  4035* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  4036* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  4037* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  4038* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  4039* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  4040* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  4041* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  4042* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  4043* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  4044* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  4045* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  4046* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  4047* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  4048******************************************************************
  4049 01  ACTIVITY-TRAILERS.
  4050     12  AT-RECORD-ID                    PIC XX.
  4051         88  VALID-AT-ID                       VALUE 'AT'.
  4052
  4053     12  AT-CONTROL-PRIMARY.
  4054         16  AT-COMPANY-CD               PIC X.
  4055         16  AT-CARRIER                  PIC X.
  4056         16  AT-CLAIM-NO                 PIC X(7).
  4057         16  AT-CERT-NO.
  4058             20  AT-CERT-PRIME           PIC X(10).
  4059             20  AT-CERT-SFX             PIC X.
  4060         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  4061             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  4062             88  AT-LAST-TRL-AVAIL            VALUE +100.
  4063             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  4064             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  4065             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  4066             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  4067             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  4068             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  4069             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  4070             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  4071             88  AT-DIAGNOSIS-TRL             VALUE +90.
  4072             88  AT-BENEFICIARY-TRL           VALUE +91.
  4073             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  4074             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  4075             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  4076             88  AT-ERROR-MSGS-TRL            VALUE +95.
  4077
  4078     12  AT-TRAILER-TYPE                 PIC X.
  4079         88  RESERVE-EXPENSE-TR               VALUE '1'.
  4080         88  PAYMENT-TR                       VALUE '2'.
  4081         88  AUTO-PAY-TR                      VALUE '3'.
  4082         88  CORRESPONDENCE-TR                VALUE '4'.
  4083         88  ADDRESS-TR                       VALUE '5'.
  4084         88  GENERAL-INFO-TR                  VALUE '6'.
  4085         88  AUTO-PROMPT-TR                   VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  76
* EL131.cbl
  4086         88  DENIAL-TR                        VALUE '8'.
  4087         88  INCURRED-CHG-TR                  VALUE '9'.
  4088         88  FORM-CONTROL-TR                  VALUE 'A'.
  4089
  4090     12  AT-RECORDED-DT                  PIC XX.
  4091     12  AT-RECORDED-BY                  PIC X(4).
  4092     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  4093
  4094     12  AT-TRAILER-BODY                 PIC X(165).
  4095
  4096     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  4097         16  AT-RESERVE-CONTROLS.
  4098             20  AT-MANUAL-SW            PIC X.
  4099                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  4100             20  AT-FUTURE-SW            PIC X.
  4101                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  4102             20  AT-PTC-SW               PIC X.
  4103                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  4104             20  AT-IBNR-SW              PIC X.
  4105                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  4106             20  AT-PTC-LF-SW            PIC X.
  4107                 88  AT-LF-PTC-USED          VALUE '1'.
  4108             20  AT-CDT-ACCESS-METHOD    PIC X.
  4109                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  4110                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  4111                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  4112             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  4113         16  AT-LAST-COMPUTED-DT         PIC XX.
  4114         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  4115         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  4116         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  4117         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4118         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  4119         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  4120         16  AT-EXPENSE-CONTROLS.
  4121             20  AT-EXPENSE-METHOD       PIC X.
  4122                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  4123                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  4124                 88  PERCENT-OF-PMT           VALUE '3'.
  4125                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  4126             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  4127             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  4128         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  4129         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  4130
  4131         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  4132         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  4133
  4134*        16  FILLER                      PIC X(53).
  4135         16  FILLER                      PIC X(47).
  4136
  4137         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  4138         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  4139
  4140         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  4141             20  AT-OPEN-CLOSE-DATE      PIC XX.
  4142             20  AT-OPEN-CLOSE-TYPE      PIC X.
  4143*                    C = CLOSED
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  77
* EL131.cbl
  4144*                    O = OPEN
  4145             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  4146*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  4147
  4148     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  4149         16  AT-PAYMENT-TYPE             PIC X.
  4150             88  PARTIAL-PAYMENT                VALUE '1'.
  4151             88  FINAL-PAYMENT                  VALUE '2'.
  4152             88  LUMP-SUM-PAYMENT               VALUE '3'.
  4153             88  ADDITIONAL-PAYMENT             VALUE '4'.
  4154             88  CHARGEABLE-EXPENSE             VALUE '5'.
  4155             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  4156             88  VOIDED-PAYMENT                 VALUE '9'.
  4157             88  TRANSFER                       VALUE 'T'.
  4158             88  LIFE-INTEREST                  VALUE 'I'.
  4159
  4160         16  AT-CLAIM-TYPE               PIC X.
  4161             88  PAID-FOR-AH                    VALUE 'A'.
  4162             88  PAID-FOR-LIFE                  VALUE 'L'.
  4163             88  PAID-FOR-IUI                   VALUE 'I'.
  4164             88  PAID-FOR-GAP                   VALUE 'G'.
  4165         16  AT-CLAIM-PREM-TYPE          PIC X.
  4166             88  AT-SINGLE-PREMIUM              VALUE '1'.
  4167             88  AT-O-B-COVERAGE                VALUE '2'.
  4168             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  4169         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  4170         16  AT-CHECK-NO                 PIC X(7).
  4171         16  AT-PAID-FROM-DT             PIC XX.
  4172         16  AT-PAID-THRU-DT             PIC XX.
  4173         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  4174         16  FILLER                      PIC X.
  4175         16  AT-PAYEES-NAME              PIC X(30).
  4176         16  AT-PAYMENT-ORIGIN           PIC X.
  4177             88  ONLINE-MANUAL-PMT              VALUE '1'.
  4178             88  ONLINE-AUTO-PMT                VALUE '2'.
  4179             88  OFFLINE-PMT                    VALUE '3'.
  4180         16  AT-CHECK-WRITTEN-DT         PIC XX.
  4181         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  4182         16  AT-VOID-DATA.
  4183             20  AT-VOID-DT              PIC XX.
  4184*00144       20  AT-VOID-REASON          PIC X(30).
  4185             20  AT-VOID-REASON          PIC X(26).
  4186         16  AT-PMT-APPROVED-BY          PIC X(04).
  4187         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  4188         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  4189         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  4190                                         PIC S99V9(5)  COMP-3.
  4191         16  AT-CREDIT-INTERFACE.
  4192             20  AT-PMT-SELECT-DT        PIC XX.
  4193                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  4194             20  AT-PMT-ACCEPT-DT        PIC XX.
  4195                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  4196             20  AT-VOID-SELECT-DT       PIC XX.
  4197                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  4198             20  AT-VOID-ACCEPT-DT       PIC XX.
  4199                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  4200
  4201         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  78
* EL131.cbl
  4202                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4203                 88  CONVERSION-PAYMENT           VALUE +99999999.
  4204         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  4205
  4206         16  AT-FORCE-CONTROL            PIC X.
  4207             88  PAYMENT-WAS-FORCED           VALUE '1'.
  4208         16  AT-PREV-LAST-PMT-DT         PIC XX.
  4209         16  AT-PREV-PAID-THRU-DT        PIC XX.
  4210         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4211         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  4212         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  4213         16  AT-BENEFIT-TYPE             PIC X.
  4214
  4215         16  AT-EXPENSE-TYPE             PIC X.
  4216         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  4217
  4218         16  AT-PAYEE-TYPE-CD.
  4219             20  AT-PAYEE-TYPE           PIC X.
  4220                 88  INSURED-PAID           VALUE 'I'.
  4221                 88  BENEFICIARY-PAID       VALUE 'B'.
  4222                 88  ACCOUNT-PAID           VALUE 'A'.
  4223                 88  OTHER-1-PAID           VALUE 'O'.
  4224                 88  OTHER-2-PAID           VALUE 'Q'.
  4225                 88  DOCTOR-PAID            VALUE 'P'.
  4226                 88  EMPLOYER-PAID          VALUE 'E'.
  4227             20  AT-PAYEE-SEQ            PIC X.
  4228
  4229         16  AT-CASH-PAYMENT             PIC X.
  4230         16  AT-GROUPED-PAYMENT          PIC X.
  4231         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  4232         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  4233         16  AT-APPROVED-LEVEL           PIC X.
  4234         16  AT-VOID-TYPE                PIC X.
  4235             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  4236             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  4237         16  AT-AIG-UNEMP-IND            PIC X.
  4238             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  4239         16  AT-ASSOCIATES               PIC X.
  4240             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  4241             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  4242
  4243         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  4244         16  AT-CV-PMT-CODE              PIC X.
  4245             88  FULL-DEATH-PAYMENT         VALUE '1'.
  4246             88  HALF-DEATH-PAYMENT         VALUE '2'.
  4247             88  FULL-ADD-PAYMENT           VALUE '3'.
  4248             88  HALF-ADD-PAYMENT           VALUE '4'.
  4249             88  FULL-RIDER-PAYMENT         VALUE '5'.
  4250             88  HALF-RIDER-PAYMENT         VALUE '6'.
  4251             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  4252             88  ADDL-PAYMENT               VALUE '8'.
  4253
  4254         16  AT-EOB-CODE1                PIC XXX.
  4255         16  AT-EOB-CODE2                PIC XXX.
  4256         16  AT-EOB-CODE3                PIC XXX.
  4257         16  FILLER REDEFINES AT-EOB-CODE3.
  4258             20  AT-PRINT-CLM-FORM       PIC X.
  4259             20  AT-PRINT-SURVEY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  79
* EL131.cbl
  4260             20  FILLER                  PIC X.
  4261         16  AT-EOB-CODE4                PIC XXX.
  4262         16  FILLER REDEFINES AT-EOB-CODE4.
  4263             20  AT-INT-PMT-SELECT-DT    PIC XX.
  4264             20  FILLER                  PIC X.
  4265         16  AT-EOB-CODE5                PIC XXX.
  4266         16  FILLER REDEFINES AT-EOB-CODE5.
  4267             20  AT-PMT-PROOF-DT         PIC XX.
  4268             20  FILLER                  PIC X.
  4269
  4270         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  4271             88  AT-PRINT-EOB            VALUE 'Y'.
  4272
  4273         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  4274         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  4275
  4276     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  4277         16  AT-SCHEDULE-START-DT        PIC XX.
  4278         16  AT-SCHEDULE-END-DT          PIC XX.
  4279         16  AT-TERMINATED-DT            PIC XX.
  4280         16  AT-LAST-PMT-TYPE            PIC X.
  4281             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  4282             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  4283         16  AT-FIRST-PMT-DATA.
  4284             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  4285             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  4286             20  AT-1ST-PAY-THRU-DT      PIC XX.
  4287         16  AT-REGULAR-PMT-DATA.
  4288             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  4289             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  4290             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  4291         16  AT-AUTO-PAYEE-CD.
  4292             20  AT-AUTO-PAYEE-TYPE      PIC X.
  4293                 88  INSURED-PAID-AUTO      VALUE 'I'.
  4294                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  4295                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  4296                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  4297                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  4298             20  AT-AUTO-PAYEE-SEQ       PIC X.
  4299         16  AT-AUTO-PAY-DAY             PIC 99.
  4300         16  AT-AUTO-CASH                PIC X.
  4301             88  AT-CASH                      VALUE 'Y'.
  4302             88  AT-NON-CASH                  VALUE 'N'.
  4303*        16  FILLER                      PIC X(129).
  4304         16  AT-AUTO-END-LETTER          PIC X(4).
  4305         16  FILLER                      PIC X(125).
  4306
  4307         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  4308         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  4309
  4310     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  4311         16  AT-LETTER-SENT-DT           PIC XX.
  4312         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  4313         16  AT-AUTO-RE-SEND-DT          PIC XX.
  4314         16  AT-LETTER-ANSWERED-DT       PIC XX.
  4315         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  4316         16  AT-LETTER-ORIGIN            PIC X.
  4317             88  ONLINE-CREATION              VALUE '1' '3'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  80
* EL131.cbl
  4318             88  OFFLINE-CREATION             VALUE '2' '4'.
  4319             88  NAPER-ONLINE-CREATION        VALUE '3'.
  4320             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  4321         16  AT-STD-LETTER-FORM          PIC X(4).
  4322         16  AT-REASON-TEXT              PIC X(70).
  4323         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  4324         16  AT-ADDRESEE-TYPE            PIC X.
  4325              88  INSURED-ADDRESEE            VALUE 'I'.
  4326              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  4327              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  4328              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  4329              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  4330              88  OTHER-ADDRESEE-1            VALUE 'O'.
  4331              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  4332         16  AT-ADDRESSEE-NAME           PIC X(30).
  4333         16  AT-INITIAL-PRINT-DATE       PIC XX.
  4334         16  AT-RESEND-PRINT-DATE        PIC XX.
  4335         16  AT-CORR-SOL-UNSOL           PIC X.
  4336         16  AT-LETTER-PURGED-DT         PIC XX.
  4337*
  4338*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  4339*
  4340         16  AT-CSO-REDEFINITION.
  4341             20  AT-RESEND-LETTER-FORM   PIC X(4).
  4342             20  AT-AUTO-CLOSE-IND       PIC X(1).
  4343             20  AT-LETTER-TO-BENE       PIC X(1).
  4344             20  AT-STOP-LETTER-DT       PIC X(2).
  4345             20  FILLER                  PIC X(19).
  4346*             20  FILLER                  PIC X(27).
  4347             20  AT-CSO-LETTER-STATUS    PIC X.
  4348                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  4349                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  4350                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  4351             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  4352             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  4353*
  4354*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  4355*
  4356*        16  FILLER                      PIC X(26).
  4357*
  4358*        16  AT-DMD-BSR-CODE             PIC X.
  4359*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  4360*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  4361*
  4362*        16  AT-DMD-LETTER-STATUS        PIC X.
  4363*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  4364*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  4365*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  4366*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  4367*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  4368
  4369         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  4370         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  4371
  4372     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  4373         16  AT-ADDRESS-TYPE             PIC X.
  4374             88  INSURED-ADDRESS               VALUE 'I'.
  4375             88  BENEFICIARY-ADDRESS           VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  81
* EL131.cbl
  4376             88  ACCOUNT-ADDRESS               VALUE 'A'.
  4377             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  4378             88  EMPLOYER-ADDRESS              VALUE 'E'.
  4379             88  OTHER-ADDRESS-1               VALUE 'O'.
  4380             88  OTHER-ADDRESS-2               VALUE 'Q'.
  4381         16  AT-MAIL-TO-NAME             PIC X(30).
  4382         16  AT-ADDRESS-LINE-1           PIC X(30).
  4383         16  AT-ADDRESS-LINE-2           PIC X(30).
  4384         16  AT-CITY-STATE.
  4385             20  AT-CITY                 PIC X(28).
  4386             20  AT-STATE                PIC XX.
  4387         16  AT-ZIP.
  4388             20  AT-ZIP-CODE.
  4389                 24  AT-ZIP-1ST          PIC X.
  4390                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4391                 24  FILLER              PIC X(4).
  4392             20  AT-ZIP-PLUS4            PIC X(4).
  4393         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  4394             20  AT-CAN-POSTAL-1         PIC XXX.
  4395             20  AT-CAN-POSTAL-2         PIC XXX.
  4396             20  FILLER                  PIC XXX.
  4397         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  4398*         16  FILLER                      PIC X(23).
  4399         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  4400         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  4401         16  FILLER                      PIC X(13).
  4402         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  4403         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  4404
  4405     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4406         16  AT-INFO-LINE-1              PIC X(60).
  4407         16  FILLER REDEFINES AT-INFO-LINE-1.
  4408             20  AT-NOTE-ERROR-NO OCCURS 15
  4409                                         PIC X(4).
  4410         16  AT-INFO-LINE-2              PIC X(60).
  4411         16  AT-INFO-TRAILER-TYPE        PIC X.
  4412             88  AT-ERRORS-NOTE          VALUE 'E'.
  4413             88  AT-PAYMENT-NOTE         VALUE 'P'.
  4414             88  AT-CALL-NOTE            VALUE 'C'.
  4415             88  AT-MAINT-NOTE           VALUE 'M'.
  4416             88  AT-CERT-CHANGE          VALUE 'X'.
  4417             88  AT-APPROVAL-NOTE        VALUE 'R'.
  4418             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  4419         16  AT-CALL-TYPE                PIC X.
  4420             88  AT-PHONE-CALL-IN        VALUE 'I'.
  4421             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  4422         16  AT-NOTE-CONTINUATION        PIC X.
  4423             88  AT-CONTINUED-NOTE       VALUE 'X'.
  4424         16  AT-EOB-CODES-EXIST          PIC X.
  4425             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  4426         16  FILLER                      PIC X(35).
  4427         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  4428         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  4429
  4430     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  4431         16  AT-PROMPT-LINE-1            PIC X(60).
  4432         16  AT-PROMPT-LINE-2            PIC X(60).
  4433         16  AT-PROMPT-START-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  82
* EL131.cbl
  4434         16  AT-PROMPT-END-DT            PIC XX.
  4435         16  FILLER                      PIC X(35).
  4436         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  4437         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  4438
  4439     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  4440         16  AT-DENIAL-INFO-1            PIC X(60).
  4441         16  AT-DENIAL-INFO-2            PIC X(60).
  4442         16  AT-DENIAL-DT                PIC XX.
  4443         16  AT-RETRACTION-DT            PIC XX.
  4444         16  AT-DENIAL-REASON-CODE       PIC X(4).
  4445*         16  FILLER                      PIC X(31).
  4446         16  AT-DENIAL-PROOF-DT          PIC XX.
  4447         16  FILLER                      PIC X(29).
  4448         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  4449         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  4450
  4451     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  4452         16  AT-OLD-INCURRED-DT          PIC XX.
  4453         16  AT-OLD-REPORTED-DT          PIC XX.
  4454         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  4455         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  4456         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  4457         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  4458         16  AT-OLD-PAID-THRU-DT         PIC XX.
  4459         16  AT-LAST-PMT-MADE-DT         PIC XX.
  4460         16  FILLER                      PIC X(26).
  4461         16  AT-OLD-DIAG-CODE            PIC X(6).
  4462         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  4463         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  4464         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  4465         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  4466         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  4467         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  4468         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  4469         16  FILLER                      PIC X(25).
  4470         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  4471
  4472     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  4473         16  AT-FORM-SEND-ON-DT          PIC XX.
  4474         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  4475         16  AT-FORM-RE-SEND-DT          PIC XX.
  4476         16  AT-FORM-ANSWERED-DT         PIC XX.
  4477         16  AT-FORM-PRINTED-DT          PIC XX.
  4478         16  AT-FORM-REPRINT-DT          PIC XX.
  4479         16  AT-FORM-TYPE                PIC X.
  4480             88  INITIAL-FORM                  VALUE '1'.
  4481             88  PROGRESS-FORM                 VALUE '2'.
  4482         16  AT-INSTRUCT-LN-1            PIC X(28).
  4483         16  AT-INSTRUCT-LN-2            PIC X(28).
  4484         16  AT-INSTRUCT-LN-3            PIC X(28).
  4485         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  4486         16  AT-FORM-ADDRESS             PIC X.
  4487             88  FORM-TO-INSURED              VALUE 'I'.
  4488             88  FORM-TO-ACCOUNT              VALUE 'A'.
  4489             88  FORM-TO-OTHER-1              VALUE 'O'.
  4490             88  FORM-TO-OTHER-2              VALUE 'Q'.
  4491         16  AT-RELATED-1.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  83
* EL131.cbl
  4492             20 AT-REL-CARR-1            PIC X.
  4493             20 AT-REL-CLAIM-1           PIC X(7).
  4494             20 AT-REL-CERT-1            PIC X(11).
  4495         16  AT-RELATED-2.
  4496             20 AT-REL-CARR-2            PIC X.
  4497             20 AT-REL-CLAIM-2           PIC X(7).
  4498             20 AT-REL-CERT-2            PIC X(11).
  4499         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  4500         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  4501         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  4502         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  4503         16  AT-FORM-REM-PRINT-DT        PIC XX.
  4504         16  AT-STOP-FORM-DT             PIC X(2).
  4505
  4506         16  FILLER                      PIC X(09).
  4507         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  4508         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  4509******************************************************************
  4510
  4511*                                COPY ELCCNTL.
  4512******************************************************************
  4513*                                                                *
  4514*                                                                *
  4515*                            ELCCNTL.                            *
  4516*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4517*                            VMOD=2.059                          *
  4518*                                                                *
  4519*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4520*                                                                *
  4521*   FILE TYPE = VSAM,KSDS                                        *
  4522*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4523*                                                                *
  4524*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4525*       ALTERNATE INDEX = NONE                                   *
  4526*                                                                *
  4527*   LOG = YES                                                    *
  4528*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4529******************************************************************
  4530*                   C H A N G E   L O G
  4531*
  4532* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4533*-----------------------------------------------------------------
  4534*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4535* EFFECTIVE    NUMBER
  4536*-----------------------------------------------------------------
  4537* 082503                   PEMA  ADD BENEFIT GROUP
  4538* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4539* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4540* 092705    2005050300006  PEMA  ADD SPP LEASES
  4541* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4542* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4543* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4544* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4545* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4546* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4547* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4548* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4549******************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  84
* EL131.cbl
  4550*
  4551 01  CONTROL-FILE.
  4552     12  CF-RECORD-ID                       PIC XX.
  4553         88  VALID-CF-ID                        VALUE 'CF'.
  4554
  4555     12  CF-CONTROL-PRIMARY.
  4556         16  CF-COMPANY-ID                  PIC XXX.
  4557         16  CF-RECORD-TYPE                 PIC X.
  4558             88  CF-COMPANY-MASTER              VALUE '1'.
  4559             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4560             88  CF-STATE-MASTER                VALUE '3'.
  4561             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4562             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4563             88  CF-CARRIER-MASTER              VALUE '6'.
  4564             88  CF-MORTALITY-MASTER            VALUE '7'.
  4565             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4566             88  CF-TERMINAL-MASTER             VALUE '9'.
  4567             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4568             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4569             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4570             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4571             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4572             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4573             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4574             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4575             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4576         16  CF-ACCESS-CD-GENL              PIC X(4).
  4577         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4578             20  CF-PROCESSOR               PIC X(4).
  4579         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4580             20  CF-STATE-CODE              PIC XX.
  4581             20  FILLER                     PIC XX.
  4582         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4583             20  FILLER                     PIC XX.
  4584             20  CF-HI-BEN-IN-REC           PIC XX.
  4585         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4586             20  FILLER                     PIC XXX.
  4587             20  CF-CARRIER-CNTL            PIC X.
  4588         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4589             20  FILLER                     PIC XX.
  4590             20  CF-HI-TYPE-IN-REC          PIC 99.
  4591         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4592             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4593                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4594             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4595             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4596         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4597             20  FILLER                     PIC X.
  4598             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4599         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4600             20  FILLER                     PIC XX.
  4601             20  CF-MORTGAGE-PLAN           PIC XX.
  4602         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4603
  4604     12  CF-LAST-MAINT-DT                   PIC XX.
  4605     12  CF-LAST-MAINT-BY                   PIC X(4).
  4606     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4607
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  85
* EL131.cbl
  4608     12  CF-RECORD-BODY                     PIC X(728).
  4609
  4610
  4611****************************************************************
  4612*             COMPANY MASTER RECORD                            *
  4613****************************************************************
  4614
  4615     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4616         16  CF-COMPANY-ADDRESS.
  4617             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4618             20  CF-CL-IN-CARE-OF           PIC X(30).
  4619             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4620             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4621             20  CF-CL-CITY-STATE           PIC X(30).
  4622             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4623             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4624         16  CF-COMPANY-CD                  PIC X.
  4625         16  CF-COMPANY-PASSWORD            PIC X(8).
  4626         16  CF-SECURITY-OPTION             PIC X.
  4627             88  ALL-SECURITY                   VALUE '1'.
  4628             88  COMPANY-VERIFY                 VALUE '2'.
  4629             88  PROCESSOR-VERIFY               VALUE '3'.
  4630             88  NO-SECURITY                    VALUE '4'.
  4631             88  ALL-BUT-TERM                   VALUE '5'.
  4632         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4633             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4634         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4635             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4636         16  CF-INFORCE-LOCATION            PIC X.
  4637             88  CERTS-ARE-ONLINE               VALUE '1'.
  4638             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4639             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4640         16  CF-LOWER-CASE-LETTERS          PIC X.
  4641         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4642             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4643             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4644             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4645             88  CF-ACCNT-CNTL                  VALUE '3'.
  4646             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4647
  4648         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4649         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4650
  4651         16  CF-LGX-CREDIT-USER             PIC X.
  4652             88  CO-IS-NOT-USER                 VALUE 'N'.
  4653             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4654
  4655         16 CF-CREDIT-CALC-CODES.
  4656             20  CF-CR-REM-TERM-CALC PIC X.
  4657               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4658               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4659               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4660               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4661               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4662               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4663               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4664             20  CF-CR-R78-METHOD           PIC X.
  4665               88  USE-TERM-PLUS-ONE            VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  86
* EL131.cbl
  4666               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4667
  4668         16  CF-CLAIM-CONTROL-COUNTS.
  4669             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4670                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4671
  4672             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4673                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4674
  4675             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4676                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4677
  4678             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4679                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4680
  4681         16  CF-CURRENT-MONTH-END           PIC XX.
  4682
  4683         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4684             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4685             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4686             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4687             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4688                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4689                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4690             20  CF-CO-PREM-REJECT-SW       PIC X.
  4691                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4692                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4693             20  CF-CO-REF-REJECT-SW        PIC X.
  4694                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4695                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4696
  4697         16  CF-CO-REPORTING-DT             PIC XX.
  4698         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4699         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4700           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4701           88  CF-CO-MONTH-END                  VALUE '1'.
  4702
  4703         16  CF-LGX-CLAIM-USER              PIC X.
  4704             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4705             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4706
  4707         16  CF-CREDIT-EDIT-CONTROLS.
  4708             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4709             20  CF-MIN-AGE                 PIC 99.
  4710             20  CF-DEFAULT-AGE             PIC 99.
  4711             20  CF-MIN-TERM                PIC S999      COMP-3.
  4712             20  CF-MAX-TERM                PIC S999      COMP-3.
  4713             20  CF-DEFAULT-SEX             PIC X.
  4714             20  CF-JOINT-AGE-INPUT         PIC X.
  4715                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4716             20  CF-BIRTH-DATE-INPUT        PIC X.
  4717                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4718             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4719                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4720                 88  CF-ZERO-CARRIER            VALUE '1'.
  4721                 88  CF-ZERO-GROUPING           VALUE '2'.
  4722                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4723             20  CF-EDIT-SW                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  87
* EL131.cbl
  4724                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4725             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4726             20  CF-CR-PR-METHOD            PIC X.
  4727               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4728               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4729             20  FILLER                     PIC X.
  4730
  4731         16  CF-CREDIT-MISC-CONTROLS.
  4732             20  CF-REIN-TABLE-SW           PIC X.
  4733                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4734             20  CF-COMP-TABLE-SW           PIC X.
  4735                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4736             20  CF-EXPERIENCE-RETENTION-AGE
  4737                                            PIC S9        COMP-3.
  4738             20  CF-CONVERSION-DT           PIC XX.
  4739             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4740             20  CF-RUN-FREQUENCY-SW        PIC X.
  4741                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4742                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4743
  4744             20  CF-CR-CHECK-NO-CONTROL.
  4745                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4746                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4747                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4748                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4749                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4750                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4751
  4752                 24  CF-CR-CHECK-COUNT       REDEFINES
  4753                     CF-CR-CHECK-COUNTER      PIC X(4).
  4754
  4755                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4756                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4757
  4758                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4759                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4760                 24  CF-MAIL-PROCESSING       PIC X.
  4761                     88  MAIL-PROCESSING          VALUE 'Y'.
  4762
  4763         16  CF-MISC-SYSTEM-CONTROL.
  4764             20  CF-SYSTEM-C                 PIC X.
  4765                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4766             20  CF-SYSTEM-D                 PIC X.
  4767                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4768             20  CF-SOC-SEC-NO-SW            PIC X.
  4769                 88  SOC-SEC-NO-USED             VALUE '1'.
  4770             20  CF-MEMBER-NO-SW             PIC X.
  4771                 88  MEMBER-NO-USED              VALUE '1'.
  4772             20  CF-TAX-ID-NUMBER            PIC X(11).
  4773             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4774             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4775                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4776                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4777                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4778                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4779             20  CF-SYSTEM-E                 PIC X.
  4780                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4781
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  88
* EL131.cbl
  4782         16  CF-LGX-LIFE-USER               PIC X.
  4783             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4784             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4785
  4786         16  CF-CR-MONTH-END-DT             PIC XX.
  4787
  4788         16  CF-FILE-MAINT-DATES.
  4789             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4790                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4791             20  CF-LAST-BATCH       REDEFINES
  4792                 CF-LAST-BATCH-NO               PIC X(4).
  4793             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4794             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4795             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4796             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4797             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4798             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  4799             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4800             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4801             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4802             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4803
  4804         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4805         16  FILLER                         PIC X.
  4806
  4807         16  CF-ALT-MORT-CODE               PIC X(4).
  4808         16  CF-MEMBER-CAPTION              PIC X(10).
  4809
  4810         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4811             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4812             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4813             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4814             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4815             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4816
  4817         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4818
  4819         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4820         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4821         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4822         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4823
  4824         16  CF-AH-OVERRIDE-L1              PIC X.
  4825         16  CF-AH-OVERRIDE-L2              PIC XX.
  4826         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4827         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4828
  4829         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4830         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4831
  4832         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4833         16  CF-AR-LAST-EL860-DT            PIC XX.
  4834         16  CF-MP-MONTH-END-DT             PIC XX.
  4835
  4836         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4837         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4838             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4839
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  89
* EL131.cbl
  4840         16  CF-AR-MONTH-END-DT             PIC XX.
  4841
  4842         16  CF-CRDTCRD-USER                PIC X.
  4843             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4844             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4845
  4846         16  CF-CC-MONTH-END-DT             PIC XX.
  4847
  4848         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4849
  4850         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4851             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4852             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4853             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4854         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4855         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4856         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  4857         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4858             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4859             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4860         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4861         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4862         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4863             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4864         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4865
  4866         16  CF-CL-ZIP-CODE.
  4867             20  CF-CL-ZIP-PRIME.
  4868                 24  CF-CL-ZIP-1ST          PIC X.
  4869                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4870                 24  FILLER                 PIC X(4).
  4871             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4872         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4873             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4874             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4875             20  FILLER                     PIC XXX.
  4876
  4877         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4878         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4879         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4880         16  CF-CO-OPTION-START-DATE        PIC XX.
  4881         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4882           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4883                                                      '3' '4'.
  4884           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4885           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4886           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4887           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4888           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4889           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4890
  4891         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4892
  4893         16  CF-PAYMENT-APPROVAL-LEVELS.
  4894             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4895             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4896             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4897             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  90
* EL131.cbl
  4898             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4899             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4900
  4901         16  CF-END-USER-REPORTING-USER     PIC X.
  4902             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4903             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4904
  4905         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4906             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4907             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4908
  4909         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4910
  4911         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4912         16  FILLER                         PIC X.
  4913
  4914         16  CF-CREDIT-ARCHIVE-CNTL.
  4915             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4916             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4917             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4918
  4919         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4920
  4921         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4922             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4923             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4924
  4925         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4926             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4927             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4928
  4929         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4930
  4931         16  CF-CO-ACH-ID-CODE              PIC  X.
  4932             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4933             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4934             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4935         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4936         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4937         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4938         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4939         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4940         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4941         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4942         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4943         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4944                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4945         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4946                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4947
  4948         16  CF-CO-OVER-SHORT.
  4949             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4950             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4951
  4952*         16  FILLER                         PIC X(102).
  4953         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4954             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4955             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  91
* EL131.cbl
  4956
  4957         16  CF-AH-APPROVAL-DAYS.
  4958             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4959             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4960             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4961             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4962
  4963         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4964
  4965         16  FILLER                         PIC X(79).
  4966****************************************************************
  4967*             PROCESSOR/USER RECORD                            *
  4968****************************************************************
  4969
  4970     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4971         16  CF-PROCESSOR-NAME              PIC X(30).
  4972         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4973         16  CF-PROCESSOR-TITLE             PIC X(26).
  4974         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4975                 88  MESSAGE-YES                VALUE 'Y'.
  4976                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4977
  4978*****************************************************
  4979****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4980****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4981****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4982****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4983*****************************************************
  4984
  4985         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4986             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4987             20  CF-APPLICATION-FORCE       PIC X.
  4988             20  CF-INDIVIDUAL-APP.
  4989                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4990                     28  CF-BROWSE-APP      PIC X.
  4991                     28  CF-UPDATE-APP      PIC X.
  4992
  4993         16  CF-CURRENT-TERM-ON             PIC X(4).
  4994         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4995             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4996             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4997             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4998             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4999             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5000             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5001             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5002         16  CF-PROCESSOR-CARRIER           PIC X.
  5003             88  NO-CARRIER-SECURITY            VALUE ' '.
  5004         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5005             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5006         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5007             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5008         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5009             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5010
  5011         16  CF-PROC-SYS-ACCESS-SW.
  5012             20  CF-PROC-CREDIT-CLAIMS-SW.
  5013                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  92
* EL131.cbl
  5014                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5015                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5016                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5017             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5018                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5019                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5020             20  CF-PROC-LIFE-GNRLDGR-SW.
  5021                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5022                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5023                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5024                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5025             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5026                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5027                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5028         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5029             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5030             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5031         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5032
  5033         16  CF-APPROVAL-LEVEL                  PIC X.
  5034             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5035             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5036             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5037             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5038
  5039         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5040
  5041         16  CF-LANGUAGE-TYPE                   PIC X.
  5042             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5043             88  CF-LANG-IS-FR                      VALUE 'F'.
  5044
  5045         16  CF-CSR-IND                         PIC X.
  5046         16  FILLER                             PIC X(239).
  5047
  5048****************************************************************
  5049*             PROCESSOR/REMINDERS RECORD                       *
  5050****************************************************************
  5051
  5052     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5053         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5054             20  CF-START-REMIND-DT         PIC XX.
  5055             20  CF-END-REMIND-DT           PIC XX.
  5056             20  CF-REMINDER-TEXT           PIC X(50).
  5057         16  FILLER                         PIC X(296).
  5058
  5059
  5060****************************************************************
  5061*             STATE MASTER RECORD                              *
  5062****************************************************************
  5063
  5064     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5065         16  CF-STATE-ABBREVIATION          PIC XX.
  5066         16  CF-STATE-NAME                  PIC X(25).
  5067         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5068         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5069             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5070             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5071             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  93
* EL131.cbl
  5072             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5073                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5074                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5075             20  CF-ST-PREM-REJECT-SW       PIC X.
  5076                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5077                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5078             20  CF-ST-REF-REJECT-SW        PIC X.
  5079                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5080                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5081         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5082         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5083         16  CF-ST-REFUND-RULES.
  5084             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5085             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5086             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5087         16  CF-ST-FST-PMT-EXTENSION.
  5088             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5089             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5090                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5091                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5092                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5093                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5094         16  CF-ST-STATE-CALL.
  5095             20  CF-ST-CALL-UNEARNED        PIC X.
  5096             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5097             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5098         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5099             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5100             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5101         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5102         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5103         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5104         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5105         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5106         16  FILLER                         PIC X.
  5107         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5108             20  CF-ST-BENEFIT-CD           PIC XX.
  5109             20  CF-ST-BENEFIT-KIND         PIC X.
  5110                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5111                 88  CF-ST-AH-KIND              VALUE 'A'.
  5112             20  CF-ST-REM-TERM-CALC        PIC X.
  5113                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5114                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5115                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5116                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5117                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5118                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5119                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5120                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5121
  5122             20  CF-ST-REFUND-CALC          PIC X.
  5123                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5124                 88  ST-REFD-BY-R78             VALUE '1'.
  5125                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5126                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5127                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5128                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5129                 88  ST-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  94
* EL131.cbl
  5130                 88  ST-REFD-UTAH               VALUE '7'.
  5131                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5132                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5133                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5134
  5135             20  CF-ST-EARNING-CALC         PIC X.
  5136                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5137                 88  ST-EARN-BY-R78             VALUE '1'.
  5138                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5139                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5140                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5141                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5142                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5143                 88  ST-EARN-MEAN               VALUE '8'.
  5144                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5145
  5146             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5147                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5148                 88  ST-OVRD-BY-R78             VALUE '1'.
  5149                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5150                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5151                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5152                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5153                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5154                 88  ST-OVRD-MEAN               VALUE '8'.
  5155                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5156             20  FILLER                     PIC X.
  5157
  5158         16  CF-ST-COMMISSION-CAPS.
  5159             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5160             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5161             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5162             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5163         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5164                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5165
  5166         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5167
  5168         16  CF-ST-STATUTORY-INTEREST.
  5169             20  CF-ST-STAT-DATE-FROM       PIC X.
  5170                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5171                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5172             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5173             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5174             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5175             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5176             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5177
  5178         16  CF-ST-OVER-SHORT.
  5179             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5180             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5181
  5182         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5183
  5184         16  CF-ST-RT-CALC                  PIC X.
  5185
  5186         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5187         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  95
* EL131.cbl
  5188         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5189         16  CF-ST-RF-LR-CALC               PIC X.
  5190         16  CF-ST-RF-LL-CALC               PIC X.
  5191         16  CF-ST-RF-LN-CALC               PIC X.
  5192         16  CF-ST-RF-AH-CALC               PIC X.
  5193         16  CF-ST-RF-CP-CALC               PIC X.
  5194*        16  FILLER                         PIC X(206).
  5195*CIDMOD         16  FILLER                         PIC X(192).
  5196         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5197             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5198         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5199         16  CF-ST-VFY-2ND-BENE             PIC X.
  5200         16  CF-ST-CAUSAL-STATE             PIC X.
  5201         16  FILLER                         PIC X(185).
  5202
  5203****************************************************************
  5204*             BENEFIT MASTER RECORD                            *
  5205****************************************************************
  5206
  5207     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5208         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5209             20  CF-BENEFIT-CODE            PIC XX.
  5210             20  CF-BENEFIT-NUMERIC  REDEFINES
  5211                 CF-BENEFIT-CODE            PIC XX.
  5212             20  CF-BENEFIT-ALPHA           PIC XXX.
  5213             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5214             20  CF-BENEFIT-COMMENT         PIC X(10).
  5215
  5216             20  CF-LF-COVERAGE-TYPE        PIC X.
  5217                 88  CF-REDUCING                VALUE 'R'.
  5218                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5219
  5220             20  CF-SPECIAL-CALC-CD         PIC X.
  5221                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5222                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5223                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5224                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5225                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5226                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5227                 88  CF-FARM-PLAN               VALUE 'F'.
  5228                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5229                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5230                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5231                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5232                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5233                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5234                 88  CF-PRUDENTIAL              VALUE 'P'.
  5235                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5236                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5237                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5238                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5239                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5240                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5241
  5242             20  CF-JOINT-INDICATOR         PIC X.
  5243                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5244
  5245*            20  FILLER                     PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  96
* EL131.cbl
  5246             20  FILLER                     PIC X(11).
  5247             20  CF-BENEFIT-CATEGORY        PIC X.
  5248             20  CF-LOAN-TYPE               PIC X(8).
  5249
  5250             20  CF-CO-REM-TERM-CALC        PIC X.
  5251                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5252                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5253                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5254                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5255                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5256
  5257             20  CF-CO-EARNINGS-CALC        PIC X.
  5258                 88  CO-EARN-BY-R78             VALUE '1'.
  5259                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5260                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5261                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5262                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5263                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5264                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5265                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5266
  5267             20  CF-CO-REFUND-CALC          PIC X.
  5268                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5269                 88  CO-REFD-BY-R78             VALUE '1'.
  5270                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5271                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5272                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  5273                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5274                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5275                 88  CO-REFD-MEAN               VALUE '8'.
  5276                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5277                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5278                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5279
  5280             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5281                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5282                 88  CO-OVRD-BY-R78             VALUE '1'.
  5283                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5284                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5285                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5286                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5287                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5288                 88  CO-OVRD-MEAN               VALUE '8'.
  5289                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5290
  5291             20  CF-CO-BEN-I-G-CD           PIC X.
  5292                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5293                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5294                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5295
  5296         16  FILLER                         PIC X(304).
  5297
  5298
  5299****************************************************************
  5300*             CARRIER MASTER RECORD                            *
  5301****************************************************************
  5302
  5303     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  97
* EL131.cbl
  5304         16  CF-ADDRESS-DATA.
  5305             20  CF-MAIL-TO-NAME            PIC X(30).
  5306             20  CF-IN-CARE-OF              PIC X(30).
  5307             20  CF-ADDRESS-LINE-1          PIC X(30).
  5308             20  CF-ADDRESS-LINE-2          PIC X(30).
  5309             20  CF-CITY-STATE              PIC X(30).
  5310             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5311             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5312
  5313         16  CF-CLAIM-NO-CONTROL.
  5314             20  CF-CLAIM-NO-METHOD         PIC X.
  5315                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5316                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5317                 88  CLAIM-NO-SEQ               VALUE '3'.
  5318                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5319             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5320                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5321                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5322                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5323
  5324         16  CF-CHECK-NO-CONTROL.
  5325             20  CF-CHECK-NO-METHOD         PIC X.
  5326                 88  CHECK-NO-MANUAL            VALUE '1'.
  5327                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5328                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5329                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5330             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  5331                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5332
  5333         16  CF-DOMICILE-STATE              PIC XX.
  5334
  5335         16  CF-EXPENSE-CONTROLS.
  5336             20  CF-EXPENSE-METHOD          PIC X.
  5337                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5338                 88  DOLLARS-PER-PMT            VALUE '2'.
  5339                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5340                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5341             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5342             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5343
  5344         16  CF-CORRESPONDENCE-CONTROL.
  5345             20  CF-LETTER-RESEND-OPT       PIC X.
  5346                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5347                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5348             20  FILLER                     PIC X(4).
  5349
  5350         16  CF-RESERVE-CONTROLS.
  5351             20  CF-MANUAL-SW               PIC X.
  5352                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5353             20  CF-FUTURE-SW               PIC X.
  5354                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5355             20  CF-PTC-SW                  PIC X.
  5356                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5357             20  CF-IBNR-SW                 PIC X.
  5358                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5359             20  CF-PTC-LF-SW               PIC X.
  5360                 88  CF-LF-PTC-USED             VALUE '1'.
  5361             20  CF-CDT-ACCESS-METHOD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  98
* EL131.cbl
  5362                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5363                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5364                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5365             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5366
  5367         16  CF-CLAIM-CALC-METHOD           PIC X.
  5368             88  360-PLUS-MONTHS                VALUE '1'.
  5369             88  365-PLUS-MONTHS                VALUE '2'.
  5370             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5371             88  360-DAILY                      VALUE '4'.
  5372             88  365-DAILY                      VALUE '5'.
  5373
  5374         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5375         16  FILLER                         PIC X(11).
  5376
  5377         16  CF-LIMIT-AMOUNTS.
  5378             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5379             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5380             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5381             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5382             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5383             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5384             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5385             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5386             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5387             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5388
  5389         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5390         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5391         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5392
  5393         16  CF-ZIP-CODE.
  5394             20  CF-ZIP-PRIME.
  5395                 24  CF-ZIP-1ST             PIC X.
  5396                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5397                 24  FILLER                 PIC X(4).
  5398             20  CF-ZIP-PLUS4               PIC X(4).
  5399         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5400             20  CF-CAN-POSTAL-1            PIC XXX.
  5401             20  CF-CAN-POSTAL-2            PIC XXX.
  5402             20  FILLER                     PIC XXX.
  5403
  5404         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5405         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5406         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5407
  5408         16  CF-RATING-SWITCH               PIC X.
  5409             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5410             88  CF-NO-RATING                   VALUE 'N'.
  5411
  5412         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5413
  5414         16  CF-CARRIER-OVER-SHORT.
  5415             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5416             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5417
  5418         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5419         16  CF-SECPAY-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page  99
* EL131.cbl
  5420             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5421             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5422         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5423         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5424         16  FILLER                         PIC X(444).
  5425*        16  FILLER                         PIC X(452).
  5426
  5427
  5428****************************************************************
  5429*             MORTALITY MASTER RECORD                          *
  5430****************************************************************
  5431
  5432     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5433         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5434                                INDEXED BY CF-MORT-NDX.
  5435             20  CF-MORT-TABLE              PIC X(5).
  5436             20  CF-MORT-TABLE-TYPE         PIC X.
  5437                 88  CF-MORT-JOINT              VALUE 'J'.
  5438                 88  CF-MORT-SINGLE             VALUE 'S'.
  5439                 88  CF-MORT-COMBINED           VALUE 'C'.
  5440                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5441                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5442             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5443             20  CF-MORT-AGE-METHOD         PIC XX.
  5444                 88  CF-AGE-LAST                VALUE 'AL'.
  5445                 88  CF-AGE-NEAR                VALUE 'AN'.
  5446             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5447             20  CF-MORT-ADJUSTMENT-DIRECTION
  5448                                            PIC X.
  5449                 88  CF-MINUS                   VALUE '-'.
  5450                 88  CF-PLUS                    VALUE '+'.
  5451             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5452             20  CF-MORT-JOINT-CODE         PIC X.
  5453                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5454             20  CF-MORT-PC-Q               PIC X.
  5455                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5456             20  CF-MORT-TABLE-CODE         PIC X(4).
  5457             20  CF-MORT-COMMENTS           PIC X(15).
  5458             20  FILLER                     PIC X(14).
  5459
  5460         16  FILLER                         PIC X(251).
  5461
  5462
  5463****************************************************************
  5464*             BUSSINESS TYPE MASTER RECORD                     *
  5465****************************************************************
  5466
  5467     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5468* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5469* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5470* AND RECORD 05 IS TYPES 81-99
  5471         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5472             20  CF-BUSINESS-TITLE          PIC  X(19).
  5473             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5474                                            PIC S9V9(4) COMP-3.
  5475             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5476             20  FILLER                     PIC  X.
  5477         16  FILLER                         PIC  X(248).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 100
* EL131.cbl
  5478
  5479
  5480****************************************************************
  5481*             TERMINAL MASTER RECORD                           *
  5482****************************************************************
  5483
  5484     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5485
  5486         16  CF-COMPANY-TERMINALS.
  5487             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5488                                  PIC X(4).
  5489         16  FILLER               PIC X(248).
  5490
  5491
  5492****************************************************************
  5493*             LIFE EDIT MASTER RECORD                          *
  5494****************************************************************
  5495
  5496     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5497         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5498             20  CF-LIFE-CODE-IN            PIC XX.
  5499             20  CF-LIFE-CODE-OUT           PIC XX.
  5500         16  FILLER                         PIC X(248).
  5501
  5502
  5503****************************************************************
  5504*             AH EDIT MASTER RECORD                            *
  5505****************************************************************
  5506
  5507     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5508         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5509             20  CF-AH-CODE-IN              PIC XXX.
  5510             20  CF-AH-CODE-OUT             PIC XX.
  5511         16  FILLER                         PIC X(248).
  5512
  5513
  5514****************************************************************
  5515*             CREDIBILITY TABLES                               *
  5516****************************************************************
  5517
  5518     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5519         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5520                             INDEXED BY CF-CRDB-NDX.
  5521             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5522             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5523             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5524         16  FILLER                         PIC  X(332).
  5525
  5526
  5527****************************************************************
  5528*             REPORT CUSTOMIZATION RECORD                      *
  5529****************************************************************
  5530
  5531     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5532         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5533             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5534             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5535             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 101
* EL131.cbl
  5536**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5537****       A T-TRANSFER.                                   ****
  5538             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5539
  5540         16  FILLER                         PIC XX.
  5541
  5542         16  CF-CARRIER-CNTL-OPT.
  5543             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5544                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5545                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5546             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5547                                            PIC X.
  5548         16  CF-GROUP-CNTL-OPT.
  5549             20  CF-GROUP-OPT-SEQ           PIC 9.
  5550                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5551                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5552             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5553                                            PIC X(6).
  5554         16  CF-STATE-CNTL-OPT.
  5555             20  CF-STATE-OPT-SEQ           PIC 9.
  5556                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5557                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5558             20  CF-STATE-SELECT OCCURS 3 TIMES
  5559                                            PIC XX.
  5560         16  CF-ACCOUNT-CNTL-OPT.
  5561             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5562                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5563                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5564             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5565                                            PIC X(10).
  5566         16  CF-BUS-TYP-CNTL-OPT.
  5567             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5568                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5569                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5570             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5571                                            PIC XX.
  5572         16  CF-LF-TYP-CNTL-OPT.
  5573             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5574                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5575                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5576             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5577                                            PIC XX.
  5578         16  CF-AH-TYP-CNTL-OPT.
  5579             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5580                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5581                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5582             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5583                                            PIC XX.
  5584         16  CF-REPTCD1-CNTL-OPT.
  5585             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5586                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5587                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5588             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5589                                            PIC X(10).
  5590         16  CF-REPTCD2-CNTL-OPT.
  5591             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5592                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5593                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 102
* EL131.cbl
  5594             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5595                                            PIC X(10).
  5596         16  CF-USER1-CNTL-OPT.
  5597             20  CF-USER1-OPT-SEQ           PIC 9.
  5598                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5599                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5600             20  CF-USER1-SELECT OCCURS 3 TIMES
  5601                                            PIC X(10).
  5602         16  CF-USER2-CNTL-OPT.
  5603             20  CF-USER2-OPT-SEQ           PIC 9.
  5604                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5605                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5606             20  CF-USER2-SELECT OCCURS 3 TIMES
  5607                                            PIC X(10).
  5608         16  CF-USER3-CNTL-OPT.
  5609             20  CF-USER3-OPT-SEQ           PIC 9.
  5610                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5611                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5612             20  CF-USER3-SELECT OCCURS 3 TIMES
  5613                                            PIC X(10).
  5614         16  CF-USER4-CNTL-OPT.
  5615             20  CF-USER4-OPT-SEQ           PIC 9.
  5616                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5617                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5618             20  CF-USER4-SELECT OCCURS 3 TIMES
  5619                                            PIC X(10).
  5620         16  CF-USER5-CNTL-OPT.
  5621             20  CF-USER5-OPT-SEQ           PIC 9.
  5622                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5623                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5624             20  CF-USER5-SELECT OCCURS 3 TIMES
  5625                                            PIC X(10).
  5626         16  CF-REINS-CNTL-OPT.
  5627             20  CF-REINS-OPT-SEQ           PIC 9.
  5628                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5629                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5630             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5631                 24  CF-REINS-PRIME         PIC XXX.
  5632                 24  CF-REINS-SUB           PIC XXX.
  5633
  5634         16  CF-AGENT-CNTL-OPT.
  5635             20  CF-AGENT-OPT-SEQ           PIC 9.
  5636                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5637                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5638             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5639                                            PIC X(10).
  5640
  5641         16  FILLER                         PIC X(43).
  5642
  5643         16  CF-LOSS-RATIO-SELECT.
  5644             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5645             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5646         16  CF-ENTRY-DATE-SELECT.
  5647             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5648             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5649         16  CF-EFFECTIVE-DATE-SELECT.
  5650             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5651             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 103
* EL131.cbl
  5652
  5653         16  CF-EXCEPTION-LIST-IND          PIC X.
  5654             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5655
  5656         16  FILLER                         PIC X(318).
  5657
  5658****************************************************************
  5659*                  EXCEPTION REPORTING RECORD                  *
  5660****************************************************************
  5661
  5662     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5663         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5664             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5665
  5666         16  CF-COMBINED-LIFE-AH-OPT.
  5667             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5668             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5669             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5670             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5671
  5672         16  CF-LIFE-OPT.
  5673             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5674             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5675             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5676             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5677             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5678             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5679             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5680             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5681             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5682             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5683
  5684         16  CF-AH-OPT.
  5685             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5686             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5687             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5688             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5689             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5690             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5691             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5692             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5693             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5694             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5695
  5696         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5697             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5698             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5699             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5700
  5701         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5702
  5703         16  FILLER                         PIC X(673).
  5704
  5705
  5706****************************************************************
  5707*             MORTGAGE SYSTEM PLAN RECORD                      *
  5708****************************************************************
  5709
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 104
* EL131.cbl
  5710     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5711         16  CF-PLAN-TYPE                   PIC X.
  5712             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  5713             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5714             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5715         16  CF-PLAN-ABBREV                 PIC XXX.
  5716         16  CF-PLAN-DESCRIPT               PIC X(10).
  5717         16  CF-PLAN-NOTES                  PIC X(20).
  5718         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5719         16  CF-PLAN-UNDERWRITING.
  5720             20  CF-PLAN-TERM-DATA.
  5721                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5722                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5723             20  CF-PLAN-AGE-DATA.
  5724                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5725                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5726                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5727             20  CF-PLAN-BENEFIT-DATA.
  5728                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5729                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5730                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5731                                            PIC S9(7)V99  COMP-3.
  5732         16  CF-PLAN-POLICY-FORMS.
  5733             20  CF-POLICY-FORM             PIC X(12).
  5734             20  CF-MASTER-APPLICATION      PIC X(12).
  5735             20  CF-MASTER-POLICY           PIC X(12).
  5736         16  CF-PLAN-RATING.
  5737             20  CF-RATE-CODE               PIC X(5).
  5738             20  CF-SEX-RATING              PIC X.
  5739                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5740                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5741             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5742             20  CF-SUB-STD-TYPE            PIC X.
  5743                 88  CF-PCT-OF-PREM            VALUE '1'.
  5744                 88  CF-PCT-OF-BENE            VALUE '2'.
  5745         16  CF-PLAN-PREM-TOLERANCES.
  5746             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5747             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5748         16  CF-PLAN-PYMT-TOLERANCES.
  5749             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5750             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5751         16  CF-PLAN-MISC-DATA.
  5752             20  FILLER                     PIC X.
  5753             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5754             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5755         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5756         16  CF-PLAN-IND-GRP                PIC X.
  5757             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5758                                                     '1'.
  5759             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5760                                                     '2'.
  5761         16  CF-MIB-SEARCH-SW               PIC X.
  5762             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5763             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5764             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5765             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5766         16  CF-ALPHA-SEARCH-SW             PIC X.
  5767             88  CF-MIB-ALPHA-ALL              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 105
* EL131.cbl
  5768             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5769             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5770             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  5771             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5772             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5773             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5774             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5775             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5776             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5777                                                     'A' 'B' 'C'
  5778                                                     'X' 'Y' 'Z'.
  5779         16  CF-EFF-DT-RULE-SW              PIC X.
  5780             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5781             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5782             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5783             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5784             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5785         16  FILLER                         PIC X(4).
  5786         16  CF-HEALTH-QUESTIONS            PIC X.
  5787             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5788         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5789         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5790         16  CF-PLAN-SNGL-JNT               PIC X.
  5791             88  CF-COMBINED-PLAN              VALUE 'C'.
  5792             88  CF-JNT-PLAN                   VALUE 'J'.
  5793             88  CF-SNGL-PLAN                  VALUE 'S'.
  5794         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5795         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5796         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5797         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5798         16  CF-RERATE-CNTL                 PIC  X.
  5799             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5800             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5801             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5802             88  CF-AUTO-RECALC                 VALUE '4'.
  5803         16  CF-BENEFIT-TYPE                PIC  X.
  5804             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5805             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5806         16  CF-POLICY-FEE                  PIC S999V99
  5807                                                    COMP-3.
  5808         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5809         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5810         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5811         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5812         16  FILLER                         PIC  X(32).
  5813         16  CF-TERMINATION-FORM            PIC  X(04).
  5814         16  FILLER                         PIC  X(08).
  5815         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5816                                                       COMP-3.
  5817         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5818         16  CF-ISSUE-LETTER                PIC  X(4).
  5819         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5820         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5821             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5822             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5823         16  CF-MP-REFUND-CALC              PIC X.
  5824             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5825             88  CF-MP-REFD-BY-R78              VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 106
* EL131.cbl
  5826             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5827             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5828             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  5829             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5830             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5831             88  CF-MP-REFD-MEAN                VALUE '8'.
  5832         16  CF-ALT-RATE-CODE               PIC  X(5).
  5833
  5834
  5835         16  FILLER                         PIC X(498).
  5836****************************************************************
  5837*             MORTGAGE COMPANY MASTER RECORD                   *
  5838****************************************************************
  5839
  5840     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5841         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5842         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5843             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5844             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5845             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5846             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5847             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5848
  5849         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5850         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5851         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5852         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5853         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5854
  5855         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5856             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5857         16  CF-MP-RECON-USE-IND            PIC X(1).
  5858             88  CF-MP-USE-RECON             VALUE 'Y'.
  5859         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5860             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5861         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5862             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5863             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5864         16  FILLER                         PIC X(1).
  5865         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5866             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5867         16  CF-MORTG-MIB-VERSION           PIC X.
  5868             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5869             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5870             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5871         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5872             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5873                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5874             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5875                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5876             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5877                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5878             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5879                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5880             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5881                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5882             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5883                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 107
* EL131.cbl
  5884         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5885         16  FILLER                         PIC X(7).
  5886         16  CF-MORTG-DESTINATION-SYMBOL.
  5887             20  CF-MORTG-MIB-COMM          PIC X(5).
  5888             20  CF-MORTG-MIB-TERM          PIC X(5).
  5889         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5890             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5891         16  FILLER                         PIC X(03).
  5892         16  CF-MP-CHECK-NO-CONTROL.
  5893             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5894                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5895                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5896                                                ' ' LOW-VALUES.
  5897                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5898                                               VALUE '3'.
  5899         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5900         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5901         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5902             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5903                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5904             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5905                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5906             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5907                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5908             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5909                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5910             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5911                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5912             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5913                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5914         16  CF-MORTG-BILLING-AREA.
  5915             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5916                                            PIC X.
  5917         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5918         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5919         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5920         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5921             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5922             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5923         16  FILLER                         PIC X.
  5924         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5925             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5926             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5927         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5928         16  FILLER                         PIC X(8).
  5929         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5930         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5931         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5932         16  CF-ACH-COMPANY-ID.
  5933             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5934                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5935                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5936                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5937             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5938         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5939             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5940         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5941             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 108
* EL131.cbl
  5942             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5943         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5944         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  5945         16  FILLER                         PIC X(536).
  5946
  5947****************************************************************
  5948*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5949****************************************************************
  5950
  5951     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5952         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5953             20  CF-FEMALE-HEIGHT.
  5954                 24  CF-FEMALE-FT           PIC 99.
  5955                 24  CF-FEMALE-IN           PIC 99.
  5956             20  CF-FEMALE-MIN-WT           PIC 999.
  5957             20  CF-FEMALE-MAX-WT           PIC 999.
  5958         16  FILLER                         PIC X(428).
  5959
  5960     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5961         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5962             20  CF-MALE-HEIGHT.
  5963                 24  CF-MALE-FT             PIC 99.
  5964                 24  CF-MALE-IN             PIC 99.
  5965             20  CF-MALE-MIN-WT             PIC 999.
  5966             20  CF-MALE-MAX-WT             PIC 999.
  5967         16  FILLER                         PIC X(428).
  5968******************************************************************
  5969*             AUTOMATIC ACTIVITY RECORD                          *
  5970******************************************************************
  5971     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5972         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5973             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5974             20  CF-SYS-LETTER-ID           PIC X(04).
  5975             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5976             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5977             20  CF-SYS-RESET-SW            PIC X(01).
  5978             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5979             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5980
  5981         16  FILLER                         PIC X(50).
  5982
  5983         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5984             20  CF-USER-ACTIVE-SW          PIC X(01).
  5985             20  CF-USER-LETTER-ID          PIC X(04).
  5986             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5987             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5988             20  CF-USER-RESET-SW           PIC X(01).
  5989             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5990             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5991             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5992
  5993         16  FILLER                         PIC X(246).
  5994
  5995*                                COPY ELCACTQ.
  5996******************************************************************
  5997*                                                                *
  5998*                            ELCACTQ.                            *
  5999*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 109
* EL131.cbl
  6000*                            VMOD=2.004                          *
  6001*                                                                *
  6002*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6003*                                                                *
  6004*   FILE TYPE = VSAM,KSDS                                        *
  6005*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6006*                                                                *
  6007*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6008*       ALTERNATE INDEX = NONE                                   *
  6009*                                                                *
  6010*   LOG = YES                                                    *
  6011*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6012*                                                                *
  6013*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6014******************************************************************
  6015
  6016 01  ACTIVITY-QUE.
  6017     12  AQ-RECORD-ID                PIC XX.
  6018         88  VALID-AQ-ID                VALUE 'AQ'.
  6019
  6020     12  AQ-CONTROL-PRIMARY.
  6021         16  AQ-COMPANY-CD           PIC X.
  6022         16  AQ-CARRIER              PIC X.
  6023         16  AQ-CLAIM-NO             PIC X(7).
  6024         16  AQ-CERT-NO.
  6025             20  AQ-CERT-PRIME       PIC X(10).
  6026             20  AQ-CERT-SFX         PIC X.
  6027
  6028     12  AQ-PENDING-ACTIVITY-FLAGS.
  6029         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6030         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6031             88  PENDING-PAYMENTS       VALUE '1'.
  6032         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6033             88  PENDING-FULL-PRINT     VALUE '1'.
  6034             88  PENDING-PART-PRINT     VALUE '2'.
  6035         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6036             88  PENDING-LETTERS        VALUE '1'.
  6037         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6038             88  PENDING-RESTORE        VALUE 'C'.
  6039             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6040
  6041     12  FILLER                      PIC X(20).
  6042
  6043     12  AQ-RESEND-DATE              PIC XX.
  6044     12  AQ-FOLLOWUP-DATE            PIC XX.
  6045     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6046     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6047     12  AQ-AUTO-LETTER              PIC X(4).
  6048     12  FILLER                      PIC XX.
  6049     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6050*****************************************************************
  6051
  6052*                                COPY ERCACCT.
  6053******************************************************************
  6054*                                                                *
  6055*                                                                *
  6056*                            ERCACCT                             *
  6057*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 110
* EL131.cbl
  6058*                            VMOD=2.031                          *
  6059*                                                                *
  6060*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6061*                                                                *
  6062*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6063*   VSAM ACCOUNT MASTER FILES.                                   *
  6064*                                                                *
  6065*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6066*                                                                *
  6067*   FILE TYPE = VSAM,KSDS                                        *
  6068*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6069*                                                                *
  6070*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6071*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6072*                                                                *
  6073*   LOG = NO                                                     *
  6074*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6075*                                                                *
  6076*                                                                *
  6077******************************************************************
  6078*                   C H A N G E   L O G
  6079*
  6080* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6081*-----------------------------------------------------------------
  6082*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6083* EFFECTIVE    NUMBER
  6084*-----------------------------------------------------------------
  6085* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6086* 092705    2005050300006  PEMA  ADD SPP LEASES
  6087* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6088* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6089* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6090* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6091* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6092******************************************************************
  6093
  6094 01  ACCOUNT-MASTER.
  6095     12  AM-RECORD-ID                      PIC XX.
  6096         88  VALID-AM-ID                      VALUE 'AM'.
  6097
  6098     12  AM-CONTROL-PRIMARY.
  6099         16  AM-COMPANY-CD                 PIC X.
  6100         16  AM-MSTR-CNTRL.
  6101             20  AM-CONTROL-A.
  6102                 24  AM-CARRIER            PIC X.
  6103                 24  AM-GROUPING.
  6104                     28 AM-GROUPING-PREFIX PIC XXX.
  6105                     28 AM-GROUPING-PRIME  PIC XXX.
  6106                 24  AM-STATE              PIC XX.
  6107                 24  AM-ACCOUNT.
  6108                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6109                     28  AM-ACCOUNT-PRIME  PIC X(6).
  6110             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6111                                           PIC X(19).
  6112             20  AM-CNTRL-B.
  6113                 24  AM-EXPIRATION-DT      PIC XX.
  6114                 24  FILLER                PIC X(4).
  6115             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 111
* EL131.cbl
  6116                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6117
  6118     12  AM-CONTROL-BY-VAR-GRP.
  6119         16  AM-COMPANY-CD-A1              PIC X.
  6120         16  AM-VG-CARRIER                 PIC X.
  6121         16  AM-VG-GROUPING                PIC X(6).
  6122         16  AM-VG-STATE                   PIC XX.
  6123         16  AM-VG-ACCOUNT                 PIC X(10).
  6124         16  AM-VG-DATE.
  6125             20  AM-VG-EXPIRATION-DT       PIC XX.
  6126             20  FILLER                    PIC X(4).
  6127         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6128                                           PIC 9(11)      COMP-3.
  6129     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6130         16  FILLER                        PIC X(10).
  6131         16  AM-VG-KEY3.
  6132             20  AM-VG3-ACCOUNT            PIC X(10).
  6133             20  AM-VG3-EXP-DT             PIC XX.
  6134         16  FILLER                        PIC X(4).
  6135     12  AM-MAINT-INFORMATION.
  6136         16  AM-LAST-MAINT-DT              PIC XX.
  6137         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6138         16  AM-LAST-MAINT-USER            PIC X(4).
  6139         16  FILLER                        PIC XX.
  6140
  6141     12  AM-EFFECTIVE-DT                   PIC XX.
  6142     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6143
  6144     12  AM-PREV-DATES  COMP-3.
  6145         16  AM-PREV-EXP-DT                PIC 9(11).
  6146         16  AM-PREV-EFF-DT                PIC 9(11).
  6147
  6148     12  AM-REPORT-CODE-1                  PIC X(10).
  6149     12  AM-REPORT-CODE-2                  PIC X(10).
  6150
  6151     12  AM-CITY-CODE                      PIC X(4).
  6152     12  AM-COUNTY-PARISH                  PIC X(6).
  6153
  6154     12  AM-NAME                           PIC X(30).
  6155     12  AM-PERSON                         PIC X(30).
  6156     12  AM-ADDRS                          PIC X(30).
  6157     12  AM-CITY.
  6158         16  AM-ADDR-CITY                  PIC X(28).
  6159         16  AM-ADDR-STATE                 PIC XX.
  6160     12  AM-ZIP.
  6161         16  AM-ZIP-PRIME.
  6162             20  AM-ZIP-PRI-1ST            PIC X.
  6163                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6164             20  FILLER                    PIC X(4).
  6165         16  AM-ZIP-PLUS4                  PIC X(4).
  6166     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6167         16  AM-CAN-POSTAL-1               PIC XXX.
  6168         16  AM-CAN-POSTAL-2               PIC XXX.
  6169         16  FILLER                        PIC XXX.
  6170     12  AM-TEL-NO.
  6171         16  AM-AREA-CODE                  PIC 999.
  6172         16  AM-TEL-PRE                    PIC 999.
  6173         16  AM-TEL-NBR                    PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 112
* EL131.cbl
  6174     12  AM-TEL-LOC                        PIC X.
  6175         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6176         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6177
  6178     12  AM-COMM-STRUCTURE.
  6179         16  AM-DEFN-1.
  6180             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6181                 24  AM-AGT.
  6182                     28  AM-AGT-PREFIX     PIC X(4).
  6183                     28  AM-AGT-PRIME      PIC X(6).
  6184                 24  AM-COM-TYP            PIC X.
  6185                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6186                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6187                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6188                 24  AM-RECALC-LV-INDIC    PIC X.
  6189                 24  AM-RETRO-LV-INDIC     PIC X.
  6190                 24  AM-GL-CODES           PIC X.
  6191                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6192                 24  FILLER                PIC X(01).
  6193         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6194             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6195                 24  FILLER                PIC X(11).
  6196                 24  AM-L-COMA             PIC XXX.
  6197                 24  AM-J-COMA             PIC XXX.
  6198                 24  AM-A-COMA             PIC XXX.
  6199                 24  FILLER                PIC X(6).
  6200
  6201     12  AM-COMM-CHANGE-STATUS             PIC X.
  6202         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6203
  6204     12  AM-CSR-CODE                       PIC X(4).
  6205
  6206     12  AM-BILLING-STATUS                 PIC X.
  6207         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6208         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6209     12  AM-AUTO-REFUND-SW                 PIC X.
  6210         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6211         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6212     12  AM-GPCD                           PIC 99.
  6213     12  AM-IG                             PIC X.
  6214         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6215         88  AM-HAS-GROUP                     VALUE '2'.
  6216     12  AM-STATUS                         PIC X.
  6217         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6218         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6219         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6220         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6221         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6222         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6223     12  AM-REMIT-TO                       PIC 99.
  6224     12  AM-ID-NO                          PIC X(11).
  6225
  6226     12  AM-CAL-TABLE                      PIC XX.
  6227     12  AM-LF-DEVIATION                   PIC XXX.
  6228     12  AM-AH-DEVIATION                   PIC XXX.
  6229     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6230     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6231     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 113
* EL131.cbl
  6232     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6233     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6234     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6235
  6236     12  AM-USER-FIELDS.
  6237         16  AM-FLD-1                      PIC XX.
  6238         16  AM-FLD-2                      PIC XX.
  6239         16  AM-FLD-3                      PIC XX.
  6240         16  AM-FLD-4                      PIC XX.
  6241         16  AM-FLD-5                      PIC XX.
  6242
  6243     12  AM-1ST-PROD-DATE.
  6244         16  AM-1ST-PROD-YR                PIC XX.
  6245         16  AM-1ST-PROD-MO                PIC XX.
  6246         16  AM-1ST-PROD-DA                PIC XX.
  6247     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6248     12  AM-CERTS-PURGED-DATE.
  6249         16  AM-PUR-YR                     PIC XX.
  6250         16  AM-PUR-MO                     PIC XX.
  6251         16  AM-PUR-DA                     PIC XX.
  6252     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6253     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6254     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6255     12  AM-INACTIVE-DATE.
  6256         16  AM-INA-MO                     PIC 99.
  6257         16  AM-INA-DA                     PIC 99.
  6258         16  AM-INA-YR                     PIC 99.
  6259     12  AM-AR-HI-CERT-DATE                PIC XX.
  6260
  6261     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6262     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6263
  6264     12  AM-OB-PAYMENT-MODE                PIC X.
  6265         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6266         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6267         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6268         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6269
  6270     12  AM-AH-ONLY-INDICATOR              PIC X.
  6271         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6272         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6273
  6274     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6275
  6276     12  AM-OVER-SHORT.
  6277         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6278         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6279
  6280     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6281     12  AM-DCC-CLP-STATE                  PIC XX.
  6282
  6283     12  AM-RECALC-COMM                    PIC X.
  6284     12  AM-RECALC-REIN                    PIC X.
  6285
  6286     12  AM-REI-TABLE                      PIC XXX.
  6287     12  AM-REI-ET-LF                      PIC X.
  6288     12  AM-REI-ET-AH                      PIC X.
  6289     12  AM-REI-PE-LF                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 114
* EL131.cbl
  6290     12  AM-REI-PE-AH                      PIC X.
  6291     12  AM-REI-PRT-ST                     PIC X.
  6292     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6293     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6294     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6295     12  AM-REI-GROUP-A                    PIC X(6).
  6296     12  AM-REI-MORT                       PIC X(4).
  6297     12  AM-REI-PRT-OW                     PIC X.
  6298     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6299     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6300     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6301     12  AM-REI-GROUP-B                    PIC X(6).
  6302
  6303     12  AM-TRUST-TYPE                     PIC X(2).
  6304
  6305     12  AM-EMPLOYER-STMT-USED             PIC X.
  6306     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6307
  6308     12  AM-STD-AH-TYPE                    PIC XX.
  6309     12  AM-EARN-METHODS.
  6310         16  AM-EARN-METHOD-R              PIC X.
  6311             88 AM-REF-RL-R78                 VALUE 'R'.
  6312             88 AM-REF-RL-PR                  VALUE 'P'.
  6313             88 AM-REF-RL-MEAN                VALUE 'M'.
  6314             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6315         16  AM-EARN-METHOD-L              PIC X.
  6316             88 AM-REF-LL-R78                 VALUE 'R'.
  6317             88 AM-REF-LL-PR                  VALUE 'P'.
  6318             88 AM-REF-LL-MEAN                VALUE 'M'.
  6319             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6320         16  AM-EARN-METHOD-A              PIC X.
  6321             88 AM-REF-AH-R78                 VALUE 'R'.
  6322             88 AM-REF-AH-PR                  VALUE 'P'.
  6323             88 AM-REF-AH-MEAN                VALUE 'M'.
  6324             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6325             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6326             88 AM-REF-AH-NET                 VALUE 'N'.
  6327
  6328     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6329     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6330     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6331
  6332     12  AM-RET-Y-N                        PIC X.
  6333     12  AM-RET-P-E                        PIC X.
  6334     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6335     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6336     12  AM-RET-GRP                        PIC X(6).
  6337     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6338         16  AM-POOL-PRIME                 PIC XXX.
  6339         16  AM-POOL-SUB                   PIC XXX.
  6340     12  AM-RETRO-EARNINGS.
  6341         16  AM-RET-EARN-R                 PIC X.
  6342         16  AM-RET-EARN-L                 PIC X.
  6343         16  AM-RET-EARN-A                 PIC X.
  6344     12  AM-RET-ST-TAX-USE                 PIC X.
  6345         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6346         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6347     12  AM-RETRO-BEG-EARNINGS.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 115
* EL131.cbl
  6348         16  AM-RET-BEG-EARN-R             PIC X.
  6349         16  AM-RET-BEG-EARN-L             PIC X.
  6350         16  AM-RET-BEG-EARN-A             PIC X.
  6351     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6352     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6353
  6354     12  AM-USER-SELECT-OPTIONS.
  6355         16  AM-USER-SELECT-1              PIC X(10).
  6356         16  AM-USER-SELECT-2              PIC X(10).
  6357         16  AM-USER-SELECT-3              PIC X(10).
  6358         16  AM-USER-SELECT-4              PIC X(10).
  6359         16  AM-USER-SELECT-5              PIC X(10).
  6360
  6361     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6362
  6363     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6364
  6365     12  AM-RPT045A-SWITCH                 PIC X.
  6366         88  RPT045A-OFF                   VALUE 'N'.
  6367
  6368     12  AM-INSURANCE-LIMITS.
  6369         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6370         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6371
  6372     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6373         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6374
  6375     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6376         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6377         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6378
  6379     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6380
  6381     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6382     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6383     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6384     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6385     12  AM-DCC-UEF-STATE                  PIC XX.
  6386     12  FILLER                            PIC XXX.
  6387     12  AM-REPORT-CODE-3                  PIC X(10).
  6388*    12  FILLER                            PIC X(22).
  6389
  6390     12  AM-RESERVE-DATE.
  6391         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6392         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6393         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6394
  6395     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6396     12  AM-NOTIFICATION-TYPES.
  6397         16  AM-NOTIF-OF-LETTERS           PIC X.
  6398         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6399         16  AM-NOTIF-OF-REPORTS           PIC X.
  6400         16  AM-NOTIF-OF-STATUS            PIC X.
  6401
  6402     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6403         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6404         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6405         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 116
* EL131.cbl
  6406         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6407
  6408     12  AM-BENEFIT-CONTROLS.
  6409         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6410             20  AM-BENEFIT-CODE           PIC XX.
  6411             20  AM-BENEFIT-TYPE           PIC X.
  6412             20  AM-BENEFIT-REVISION       PIC XXX.
  6413             20  AM-BENEFIT-REM-TERM       PIC X.
  6414             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6415             20  FILLER                    PIC XX.
  6416         16  FILLER                        PIC X(80).
  6417
  6418     12  AM-TRANSFER-DATA.
  6419         16  AM-TRANSFERRED-FROM.
  6420             20  AM-TRNFROM-CARRIER        PIC X.
  6421             20  AM-TRNFROM-GROUPING.
  6422                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6423                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6424             20  AM-TRNFROM-STATE          PIC XX.
  6425             20  AM-TRNFROM-ACCOUNT.
  6426                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6427                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6428             20  AM-TRNFROM-DTE            PIC XX.
  6429         16  AM-TRANSFERRED-TO.
  6430             20  AM-TRNTO-CARRIER          PIC X.
  6431             20  AM-TRNTO-GROUPING.
  6432                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6433                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6434             20  AM-TRNTO-STATE            PIC XX.
  6435             20  AM-TRNTO-ACCOUNT.
  6436                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6437                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6438             20  AM-TRNTO-DTE              PIC XX.
  6439         16  FILLER                        PIC X(10).
  6440
  6441     12  AM-SAVED-REMIT-TO                 PIC 99.
  6442
  6443     12  AM-COMM-STRUCTURE-SAVED.
  6444         16  AM-DEFN-1-SAVED.
  6445             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6446                 24  AM-AGT-SV             PIC X(10).
  6447                 24  AM-COM-TYP-SV         PIC X.
  6448                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6449                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6450                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6451                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6452                 24  FILLER                PIC X.
  6453                 24  AM-GL-CODES-SV        PIC X.
  6454                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6455                 24  FILLER                PIC X.
  6456         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6457             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  6458                 24  FILLER                PIC X(11).
  6459                 24  AM-L-COMA-SV          PIC XXX.
  6460                 24  AM-J-COMA-SV          PIC XXX.
  6461                 24  AM-A-COMA-SV          PIC XXX.
  6462                 24  FILLER                PIC X(6).
  6463
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 117
* EL131.cbl
  6464     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6465         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6466            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6467            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6468            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6469
  6470     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6471     12  FILLER                            PIC X(120).
  6472
  6473     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6474         16  AM-CONTROL-NAME               PIC X(30).
  6475         16  AM-EXECUTIVE-ONE.
  6476             20  AM-EXEC1-NAME             PIC X(15).
  6477             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6478                                                          COMP-3.
  6479             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6480                                                          COMP-3.
  6481         16  AM-EXECUTIVE-TWO.
  6482             20  AM-EXEC2-NAME             PIC X(15).
  6483             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6484                                                          COMP-3.
  6485             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6486                                                          COMP-3.
  6487
  6488     12  AM-RETRO-ADDITIONAL-DATA.
  6489         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6490         16  AM-RETRO-PREM-P-E             PIC X.
  6491         16  AM-RETRO-CLMS-P-I             PIC X.
  6492         16  AM-RETRO-RET-BRACKET-LF.
  6493             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6494                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6495                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6496             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6497                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6498                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6499             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6500                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6501                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6502         16  AM-RETRO-RET-BRACKET-AH.
  6503             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6504                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6505                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6506                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6507             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6508                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6509                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6510             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6511                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6512                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6513
  6514     12  AM-COMMENTS.
  6515         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  6516
  6517     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6518         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6519         16  AM-FLI-BILLING-CODE           PIC X.
  6520         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6521         16  AM-FLI-UNITED-IDENT           PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 118
* EL131.cbl
  6522         16  AM-FLI-INTEREST-LOST-DATA.
  6523             20  AM-FLI-BANK-NO            PIC X(5).
  6524             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6525             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6526             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6527         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6528             20  AM-FLI-AGT                PIC X(9).
  6529             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6530             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6531         16  FILLER                        PIC X(102).
  6532
  6533     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6534         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6535             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6536             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6537             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6538             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6539             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6540         16  FILLER                          PIC X(10).
  6541******************************************************************
  6542
  6543*                                COPY ELCCHKQ.
  6544******************************************************************
  6545*                                                                *
  6546*                                                                *
  6547*                            ELCCHKQ.                            *
  6548*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6549*                            VMOD=2.007                          *
  6550*                                                                *
  6551*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6552*                                                                *
  6553*   FILE TYPE = VSAM,KSDS                                        *
  6554*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6555*                                                                *
  6556*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6557*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6558*                                                                *
  6559*   LOG = YES                                                    *
  6560*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6561******************************************************************
  6562 01  CHECK-QUE.
  6563     12  CQ-RECORD-ID                PIC XX.
  6564         88  VALID-CQ-ID         VALUE 'CQ'.
  6565
  6566     12  CQ-CONTROL-PRIMARY.
  6567         16  CQ-COMPANY-CD           PIC X.
  6568         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  6569         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  6570
  6571     12  CQ-CONTROL-BY-PAYEE.
  6572         16  CQ-CONTROL-BY-NUMBER.
  6573             20  CQ-COMPANY-CD-A1     PIC X.
  6574             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  6575         16  CQ-PAYEE-CARRIER        PIC X.
  6576         16  CQ-PAYEE-GROUPING       PIC X(6).
  6577         16  CQ-PAYEE-STATE          PIC XX.
  6578         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  6579         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 119
* EL131.cbl
  6580
  6581     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  6582         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  6583         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  6584         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  6585         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  6586         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  6587         16  FILLER                  PIC X(3).
  6588
  6589     12  CQ-ENTRY-TYPE               PIC X.
  6590             88  CHECK-ON-QUE           VALUE 'Q'.
  6591             88  ALIGNMENT-CHECK        VALUE 'A'.
  6592             88  SPOILED-CHECK          VALUE 'S'.
  6593             88  PAYMENT-ABORTED        VALUE 'X'.
  6594
  6595     12  CQ-CLAIM-MAST-CNTL.
  6596         16  CQ-CARRIER              PIC X.
  6597         16  CQ-CLAIM-NO             PIC X(7).
  6598         16  CQ-CERT-NO.
  6599             20  CQ-CERT-PRIME       PIC X(10).
  6600             20  CQ-CERT-SFX         PIC X.
  6601         16  CQ-CLAIM-TYPE           PIC X.
  6602             88  CQ-LIFE-CLAIM          VALUE 'L'.
  6603             88  CQ-AH-CLAIM            VALUE 'A'.
  6604         16  CQ-CLAIM-SUB-TYPE       PIC X.
  6605             88  CQ-FIXED-COVERAGE      VALUE '1'.
  6606             88  CQ-O-B-COVERAGE        VALUE '2'.
  6607             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  6608
  6609     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  6610     12  CQ-CHECK-NUMBER             PIC X(7).
  6611     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  6612     12  CQ-PAYMENT-TYPE             PIC X.
  6613             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  6614             88  CQ-FINAL-PAYMENT          VALUE '2'.
  6615             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  6616             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  6617             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  6618             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  6619             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  6620             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  6621     12  CQ-VOID-INDICATOR           PIC X.
  6622             88  CHECK-IS-STOPPED          VALUE 'S'.
  6623             88  CHECK-IS-VOID             VALUE 'V'.
  6624     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  6625     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  6626     12  CQ-CHECK-BY-USER            PIC X(4).
  6627     12  CQ-PRE-NUMBERING-SW         PIC X.
  6628       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  6629       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  6630
  6631     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  6632     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  6633     12  CQ-LEDGER-FLAG              PIC X(01).
  6634     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  6635     12  CQ-LAST-UPDATED-DT          PIC XX.
  6636     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  6637     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 120
* EL131.cbl
  6638
  6639     12  FILLER                      PIC X(04).
  6640
  6641******************************************************************
  6642
  6643*                                COPY ELCARCH.
  6644******************************************************************
  6645*                                                                *
  6646*                            ELCARCH.                            *
  6647*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6648*                            VMOD=2.007                          *
  6649*                                                                *
  6650*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6651*                                                                *
  6652*   FILE TYPE = VSAM,KSDS                                        *
  6653*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6654*                                                                *
  6655*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6656*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6657*                                                                *
  6658*   LOG = NO                                                     *
  6659*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6660*                                                                *
  6661*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6662******************************************************************
  6663 01  LETTER-ARCHIVE.
  6664     12  LA-RECORD-ID                PIC XX.
  6665         88  VALID-LA-ID                VALUE 'LA'.
  6666
  6667     12  LA-CONTROL-PRIMARY.
  6668         16  LA-COMPANY-CD           PIC X.
  6669         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6670         16  LA-RECORD-TYPE          PIC X.
  6671             88  LA-HEADER-DATA         VALUE '1'.
  6672             88  LA-ADDRESS-DATA        VALUE '2'.
  6673             88  LA-TEXT-DATA           VALUE '3'.
  6674             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6675         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6676
  6677     12  LA-CONTROL-BY-TYPE.
  6678         16  LA-COMPANY-CD-A1        PIC X.
  6679         16  LA-RECORD-TYPE-A1       PIC X.
  6680         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6681         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6682
  6683     12  LA-TEXT-RECORD.
  6684         16  LA-SKIP-CONTROL         PIC XX.
  6685             88  NO-LINES-SKIPPED       VALUE SPACES.
  6686             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6687         16  LA-TEXT-LINE            PIC X(70).
  6688
  6689     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6690         16  FILLER                  PIC XX.
  6691         16  LA-ADDRESS-LINE         PIC X(30).
  6692         16  FILLER                  PIC X(40).
  6693
  6694     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6695         16  FILLER                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 121
* EL131.cbl
  6696         16  LA-CARRIER              PIC X.
  6697         16  LA-CLAIM-NO             PIC X(7).
  6698         16  LA-CERT-NO.
  6699             20  LA-CERT-PRIME       PIC X(10).
  6700             20  LA-CERT-SFX         PIC X.
  6701         16  LA-NO-OF-COPIES         PIC S9.
  6702         16  LA-RESEND-DATE          PIC XX.
  6703         16  LA-PROCESSOR-CD         PIC X(4).
  6704         16  LA-CREATION-DT          PIC XX.
  6705         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6706         16  LA-RESEND-PRINT-DATE    PIC XX.
  6707         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6708         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6709*
  6710* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6711*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6712*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6713*   I        20  LA-DMD-RES-ST           PIC XX.
  6714*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6715*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6716*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6717*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6718*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6719*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6720*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6721*   I        20  LA-DMD-UND-CODE         PIC XX.
  6722*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6723*   V    16  FILLER                  PIC X(15).
  6724* -----
  6725*
  6726* REINSERTED  CSO  MODS
  6727*
  6728         16  FILLER.
  6729             20  FILLER                  PIC X(29).
  6730             20  LA-CSO-LETTER-STATUS    PIC X.
  6731                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6732                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6733                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6734             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6735             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6736*
  6737
  6738     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6739         16  FILLER                  PIC XX.
  6740         16  LA4-CARRIER             PIC X.
  6741         16  LA4-CLAIM-NO            PIC X(7).
  6742         16  LA4-CERT-NO.
  6743             20  LA4-CERT-PRIME      PIC X(10).
  6744             20  LA4-CERT-SFX        PIC X.
  6745         16  LA4-NO-OF-COPIES        PIC S9.
  6746         16  LA4-RESEND-DATE         PIC XX.
  6747         16  LA4-PROCESSOR-CD        PIC X(4).
  6748         16  LA4-CREATION-DT         PIC XX.
  6749         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6750         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6751         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6752         16  LA4-FORM-TYPE           PIC X.
  6753             88  LA4-INITIAL-FORM    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 122
* EL131.cbl
  6754             88  LA4-PROGRESS-FORM   VALUE '2'.
  6755         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6756         16  LA4-STATE               PIC X(02).
  6757         16  FILLER                  PIC X(31).
  6758******************************************************************
  6759
  6760*                                COPY ELCBENE.
  6761******************************************************************
  6762*                                                                *
  6763*                            ELCBENE.                            *
  6764*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6765*                            VMOD=2.006                          *
  6766*                                                                *
  6767*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6768*                                                                *
  6769*   FILE TYPE = VSAM,KSDS                                        *
  6770*   RECORD SIZE = 500   RECFORM = FIX                            *
  6771*                                                                *
  6772*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6773*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6774*                                                                *
  6775*   LOG = YES                                                    *
  6776*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6777*                                                                *
  6778*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6779******************************************************************
  6780
  6781 01  BENEFICIARY-MASTER.
  6782     12  BE-RECORD-ID                PIC XX.
  6783         88  VALID-BE-ID                VALUE 'BE'.
  6784
  6785     12  BE-CONTROL-PRIMARY.
  6786         16  BE-COMPANY-CD           PIC X.
  6787         16  BE-RECORD-TYPE          PIC X.
  6788             88  BENEFICIARY-RECORD  VALUE 'B'.
  6789             88  ADJUSTOR-RECORD     VALUE 'A'.
  6790         16  BE-BENEFICIARY          PIC X(10).
  6791     12  BE-CONTROL-BY-NAME.
  6792         16  BE-COMPANY-CD-A1        PIC X.
  6793         16  BE-RECORD-TYPE-A1       PIC X.
  6794         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6795         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6796
  6797     12  BE-LAST-MAINT-DT            PIC XX.
  6798     12  BE-LAST-MAINT-BY            PIC X(4).
  6799     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6800
  6801     12  BE-ADDRESS-DATA.
  6802         16  BE-MAIL-TO-NAME         PIC X(30).
  6803         16  BE-ADDRESS-LINE-1       PIC X(30).
  6804         16  BE-ADDRESS-LINE-2       PIC X(30).
  6805         16  BE-ADDRESS-LINE-3       PIC X(30).
  6806         16  BE-CITY-STATE.
  6807             20  BE-CITY             PIC X(28).
  6808             20  BE-STATE            PIC XX.
  6809         16  BE-ZIP-CODE.
  6810             20  BE-ZIP-PRIME.
  6811                 24  BE-ZIP-1ST      PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 123
* EL131.cbl
  6812                     88  BE-CANADIAN-POST-CODE
  6813                                         VALUE 'A' THRU 'Z'.
  6814                 24  FILLER          PIC X(4).
  6815             20  BE-ZIP-PLUS4        PIC X(4).
  6816         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6817             20  BE-CAN-POSTAL-1     PIC XXX.
  6818             20  BE-CAN-POSTAL-2     PIC XXX.
  6819             20  FILLER              PIC XXX.
  6820         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6821         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6822
  6823******************************************************************
  6824*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6825*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6826******************************************************************
  6827     12  BE-CARRIER                  PIC X.
  6828
  6829     12  BE-ADDRESS-DATA2.
  6830         16  BE-MAIL-TO-NAME2        PIC X(30).
  6831         16  BE-ADDRESS-LINE-12      PIC X(30).
  6832         16  BE-ADDRESS-LINE-22      PIC X(30).
  6833         16  BE-ADDRESS-LINE-32      PIC X(30).
  6834         16  BE-CITY-STATE2.
  6835             20  BE-CITY2            PIC X(28).
  6836             20  BE-STATE2           PIC XX.
  6837         16  BE-ZIP-CODE2.
  6838             20  BE-ZIP-PRIME2.
  6839                 24  BE-ZIP-1ST2     PIC X.
  6840                     88  BE-CANADIAN-POST-CODE2
  6841                                         VALUE 'A' THRU 'Z'.
  6842                 24  FILLER          PIC X(4).
  6843             20  BE-ZIP-PLUS42       PIC X(4).
  6844         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6845             20  BE-CAN-POSTAL-12    PIC XXX.
  6846             20  BE-CAN-POSTAL-22    PIC XXX.
  6847             20  FILLER              PIC XXX.
  6848         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6849         16  BE-BILLING-STMT-DATA.
  6850             20  BE-BSR              PIC X.
  6851                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  6852                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6853             20  BE-BSR-FROM         PIC X(30).
  6854             20  BE-BSR-DEPT         PIC X(30).
  6855             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  6856             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6857             20  BE-OUTPUT-TYPE      PIC X.
  6858                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6859                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6860
  6861     12  FILLER                      PIC X(28).
  6862******************************************************************
  6863
  6864*                                COPY ELCDAR.
  6865******************************************************************
  6866*                                                                *
  6867*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6868*   FILE TYPE = VSAM,KSDS                                        *
  6869*   RECORD SIZE = 25   RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 124
* EL131.cbl
  6870*   BASE CLUSTER = DLYACTV                                       *
  6871*   LOG = YES                                                    *
  6872*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6873*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6874*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6875*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6876*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6877*               BY PROGRAM "LGINFCE".                            *
  6878*                                                                *
  6879******************************************************************
  6880 01  DAILY-ACTIVITY-RECORD.
  6881     05  DA-KEY.
  6882         10  DA-COMP-CD          PIC X.
  6883         10  DA-CARRIER          PIC X.
  6884         10  DA-CLAIM-NO         PIC X(7).
  6885         10  DA-CERT-NO.
  6886             15  DA-CERT-PRIME   PIC X(10).
  6887             15  DA-CERT-SFX     PIC X.
  6888     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6889     05  DA-RECORD-TYPE          PIC X.
  6890     05  FILLER                  PIC X(2).
  6891******************************************************************
  6892
  6893*                                COPY ELCALPH.
  6894******************************************************************
  6895*                                                                *
  6896*                            ELCALPH.                            *
  6897*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6898*                            VMOD=2.003                          *
  6899*                                                                *
  6900*   FILE DESCRIPTION = ALPHA CROSS REFERENCE FILE                *
  6901*                                                                *
  6902*   FILE TYPE = VSAM,KSDS                                        *
  6903*   RECORD SIZE = 128  RECFORM = FIXED                           *
  6904*                                                                *
  6905*   BASE CLUSTER = ELALPH                         RKP=2,LEN=42   *
  6906*       ALTERNATE PATH1 = ELALPH2 (FULL CONTROL)  RKP=44,LEN=57  *
  6907*                                                                *
  6908*   LOG = YES                                                    *
  6909*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6910*                                                                *
  6911*  NO  CID  MODS  IN  COPYBOOK  ELCALPH                          *
  6912******************************************************************
  6913
  6914 01  ALPHA-INDEX.
  6915     12  AI-RECORD-ID                         PIC XX.
  6916         88  VALID-AI-ID                  VALUE 'AI'.
  6917     12  AI-CONTROL-PRIMARY.
  6918         16  AI-COMPANY-CD                     PIC X.
  6919         16  AI-SOURCE                         PIC X.
  6920             88  AI-CLAIM-SYSTEM          VALUE 'C'.
  6921             88  AI-ADMIN-SYSTEM          VALUE 'A'.
  6922         16  AI-NAME.
  6923             20  AI-LAST-NAME                  PIC X(15).
  6924             20  AI-FIRST-NAME.
  6925                 24  AI-FIRST-INITIAL          PIC X.
  6926                 24  FILLER                    PIC X(11).
  6927             20  AI-MIDDLE-INIT                PIC X.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 125
* EL131.cbl
  6928         16  AI-DATE                           PIC X(8).
  6929         16  AI-TIME                           PIC S9(07) COMP-3.
  6930
  6931     12  AI-CONTROL-BY-ADMIN-KEY.
  6932         16  AI-CM-COMPANY-CD                  PIC X.
  6933         16  AI-CM-SOURCE                      PIC X.
  6934         16  AI-CM-CARRIER                     PIC X.
  6935         16  AI-CM-GROUPING.
  6936             20  AI-CM-GROUPING-PREFIX         PIC X(3).
  6937             20  AI-CM-GROUPING-PRIME          PIC X(3).
  6938         16  AI-CM-STATE                       PIC XX.
  6939         16  AI-CM-PRODUCER.
  6940             20  AI-CM-PRODUCER-PREFIX         PIC X(4).
  6941             20  AI-CM-PRODUCER-PRIME          PIC X(6).
  6942         16  AI-CM-CERT-EFF-DT                 PIC XX.
  6943         16  AI-CM-CERTIFICATE-NUMBER.
  6944             20  AI-CM-CERT-PRIME              PIC X(10).
  6945             20  AI-CM-CERT-SFX                PIC X.
  6946         16  AI-CM-DATE                        PIC X(8).
  6947         16  AI-CM-TIME                        PIC S9(7) COMP-3.
  6948         16  FILLER                            PIC X(11).
  6949
  6950     12  AI-CONTROL-BY-CLAIM-KEY REDEFINES
  6951         AI-CONTROL-BY-ADMIN-KEY.
  6952         16  AI-CL-COMPANY-CD                  PIC X.
  6953         16  AI-CL-SOURCE                      PIC X.
  6954         16  AI-CL-CARRIER                     PIC X.
  6955         16  AI-CL-CLAIM-NUMBER                PIC X(7).
  6956         16  AI-CL-CERTIFICATE-NUMBER.
  6957             20  AI-CL-CERT-PRIME              PIC X(10).
  6958             20  AI-CL-CERT-SFX                PIC X.
  6959         16  AI-CL-DATE                        PIC X(8).
  6960         16  AI-CL-INCURRED-DATE               PIC XX.
  6961         16  AI-CL-CLOSE-DATE                  PIC XX.
  6962         16  AI-CL-TIME                        PIC S9(7)  COMP-3.
  6963         16  AI-CREDIT-CARD-NUMBER.
  6964             20  AI-CCN.
  6965                 24  AI-CCN-PREFIX             PIC X(4).
  6966                 24  AI-CCN-PRIME              PIC X(12).
  6967             20  AI-CCN-FILLER                 PIC X(4).
  6968
  6969     12  AI-MAINT-INFO.
  6970         16  AI-LAST-MAINT-BY                  PIC X(4).
  6971         16  AI-LAST-MAINT-DT                  PIC XX.
  6972         16  AI-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6973
  6974     12  AI-CLAIM-PAID-THRU-DT                 PIC XX.
  6975
  6976     12  FILLER                                PIC X(15).
  6977
  6978
  6979*                                COPY ERCDMDNT.
  6980******************************************************************
  6981*                                                                *
  6982*                            ERCDMDNT                            *
  6983*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6984*                            VMOD=2.005                          *
  6985*                                                                *
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 126
* EL131.cbl
  6986*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  6987*                                                                *
  6988*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  6989*                                                                *
  6990*        FILE TYPE= VSAM,KSDS                                    *
  6991*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6992*                                                                *
  6993*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6994*                                                                *
  6995*        LOG = YES                                               *
  6996*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6997*                                                                *
  6998******************************************************************
  6999
  7000 01  CERTIFICATE-NOTE.
  7001     12  CN-RECORD-ID                     PIC  XX.
  7002         88  VALID-CN-ID                      VALUE 'CN'.
  7003
  7004     12  CN-CONTROL-PRIMARY.
  7005         16  CN-COMPANY-CD                PIC X.
  7006         16  CN-CERT-KEY.
  7007             20  CN-CARRIER               PIC X.
  7008             20  CN-GROUPING.
  7009                 24  CN-GROUPING-PREFIX   PIC XXX.
  7010                 24  CN-GROUPING-PRIME    PIC XXX.
  7011             20  CN-STATE                 PIC XX.
  7012             20  CN-ACCOUNT.
  7013                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7014                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7015             20  CN-CERT-EFF-DT           PIC XX.
  7016             20  CN-CERT-NO.
  7017                 24  CN-CERT-PRIME        PIC X(10).
  7018                 24  CN-CERT-SFX          PIC X.
  7019
  7020     12  CN-BILLING-START-LINE-NO         PIC 99.
  7021     12  CN-BILLING-END-LINE-NO           PIC 99.
  7022
  7023     12  CN-LINES.
  7024         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7025
  7026     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7027         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7028         16  CN-CSI-GENERAL-DATA-AREA.
  7029             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7030
  7031         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7032             CN-CSI-GENERAL-DATA-AREA.
  7033             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7034             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7035             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7036             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
  7037             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7038             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7039             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7040             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7041             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7042             20  FILLER                       PIC XX.
  7043             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 127
* EL131.cbl
  7044             20  FILLER                       PIC X(38).
  7045
  7046         16  CN-CSI-PRODUCT-DATA-AREA.
  7047             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7048
  7049         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7050             CN-CSI-PRODUCT-DATA-AREA.
  7051             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7052             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7053             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7054             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7055             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7056             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7057             20  FILLER                   PIC XX.
  7058             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7059             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7060             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7061             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7062             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7063             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7064             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7065             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7066             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7067             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7068             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7069             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7070             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7071             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7072             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7073             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7074             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7075             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7076             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7077             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7078             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7079             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7080             20  FILLER                   PIC X(25).
  7081
  7082         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7083             CN-CSI-CREDIT-CARD-DATA.
  7084             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7085             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7086             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7087             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7088             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7089             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7090             20  FILLER                   PIC XX.
  7091             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7092             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7093             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7094             20  CN-CSI-FL-ISSUE-ST       PIC XX.
  7095             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7096             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7097             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7098             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7099             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7100             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7101             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 128
* EL131.cbl
  7102             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7103             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7104             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7105             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7106             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7107             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7108             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7109             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7110             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7111             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7112             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7113             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7114             20  FILLER                   PIC X(17).
  7115
  7116         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7117             CN-CSI-FAMILY-LEAVE-DATA.
  7118             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7119             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7120             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7121             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7122             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7123             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7124             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7125             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7126             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7127             20  CN-CSI-SL-INT-ON-PROCEEDS
  7128                                          PIC S9(5)V99  COMP-3.
  7129             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7130             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7131             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7132             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7133             20  CN-CSI-SL-POLICY-BENEFITS
  7134                                          PIC S9(5)V99  COMP-3.
  7135             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7136             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7137             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7138             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7139             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7140             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7141             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7142             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7143             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7144             20  CN-CSI-SL-STATE-NOT      PIC X.
  7145             20  FILLER                   PIC XX.
  7146
  7147         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7148             CN-CSI-SENIOR-LIFE-DATA.
  7149             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7150             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7151             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7152                                          PIC S9(5)V99  COMP-3.
  7153             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7154             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7155             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7156             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7157             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7158             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7159             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 129
* EL131.cbl
  7160             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7161             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7162             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7163             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7164             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7165             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7166             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7167             20  CN-CSI-PP-REPAIR         PIC X.
  7168             20  CN-CSI-PP-REPLACE        PIC X.
  7169             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7170             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7171             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7172             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7173             20  FILLER                   PIC X(5).
  7174
  7175         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7176             CN-CSI-PURCH-PROP-DATA.
  7177             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7178             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7179             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7180             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7181             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7182             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7183             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7184             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7185             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7186             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7187             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7188             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7189             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7190             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7191             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7192             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7193             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7194             20  CN-CSI-EW-REPLACE        PIC X.
  7195             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7196             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7197             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7198             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7199             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7200             20  FILLER                   PIC X(4).
  7201
  7202     12  CN-LAST-MAINT-DT                 PIC XX.
  7203     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7204     12  CN-LAST-MAINT-USER               PIC X(4).
  7205     12  FILLER                           PIC X(6).
  7206
  7207******************************************************************
  7208
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 130
* EL131.cbl
  7210 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7211                          CERTIFICATE-MASTER ACTIVITY-TRAILERS
  7212                          CONTROL-FILE ACTIVITY-QUE
  7213                          ACCOUNT-MASTER CHECK-QUE
  7214                          LETTER-ARCHIVE BENEFICIARY-MASTER
  7215                          DAILY-ACTIVITY-RECORD ALPHA-INDEX
  7216                          CERTIFICATE-NOTE.
  7217 0000-DFHEXIT SECTION.
  7218     MOVE '9#                    $   ' TO DFHEIV0.
  7219     MOVE 'EL131' TO DFHEIV1.
  7220     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7221
  7222     IF EIBCALEN = ZERO
  7223         GO TO 8800-UNAUTHORIZED-ACCESS.
  7224
  7225     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7226     MOVE '5'                    TO DC-OPTION-CODE.
  7227     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7228     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7229     MOVE DC-GREG-DATE-1-YMD     TO  SAVE-DATE-YMD.
  7230     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7231
  7232     IF SAVE-DATE-YY GREATER 70
  7233         MOVE 19                 TO SAVE-DATE-CC
  7234      ELSE
  7235         MOVE 20                 TO SAVE-DATE-CC.
  7236
  7237
  7238* EXEC CICS HANDLE CONDITION
  7239*        PGMIDERR (8820-XCTL-ERROR)
  7240*        NOTFND   (8150-ENTERED-CLAIM-NOTFOUND)
  7241*        ERROR    (9990-ABEND)
  7242*    END-EXEC.
  7243*    MOVE '"$LI.                 ! " #00007233' TO DFHEIV0
  7244     MOVE X'22244C492E20202020202020' TO DFHEIV0(1:12)
  7245     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7246     MOVE X'2220233030303037323333' TO DFHEIV0(25:11)
  7247     CALL 'kxdfhei1' USING DFHEIV0
  7248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7249
  7250
  7251     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7252     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7253     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7254
  7255     INITIALIZE    EDIT-WORK-AREA.
  7256     MOVE '/'                    TO WORK-SLASH.
  7257     MOVE SPACES                 TO ERROR-SWITCHES.
  7258
  7259     MOVE TRAN-ID                TO TRANS-ID.
  7260     MOVE EIBTRMID               TO PI-TERM.
  7261     MOVE MAP-ID                 TO PI-QUAL.
  7262
  7263     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7264
  7265     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7266         MOVE LOW-VALUES         TO EL131AO
  7267         MOVE ER-0008            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 131
* EL131.cbl
  7268         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7269         MOVE -1                 TO MAINTL
  7270         GO TO 8110-SEND-DATA.
  7271
  7272     IF THIS-PGM NOT = PI-CALLING-PROGRAM
  7273         MOVE LOW-VALUES         TO EL131AO
  7274         PERFORM 0100-UPDATE-PI THRU 0120-UPDATE-PI-EXIT
  7275         MOVE 'X'                TO PI-RETURN-CD-1
  7276         PERFORM 5000-BUILD-MAP THRU 5000-EXIT
  7277         MOVE -1                 TO MAINTL
  7278         GO TO 8100-SEND-MAP.
  7279
  7280     IF EIBAID = DFHCLEAR
  7281         GO TO 8200-RETURN-PRIOR.
  7282
  7283     IF PI-PROCESSOR-ID = 'LGXX'
  7284         NEXT SENTENCE
  7285     ELSE
  7286
  7287* EXEC CICS READQ TS
  7288*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7289*            INTO    (SECURITY-CONTROL)
  7290*            LENGTH  (SC-COMM-LENGTH)
  7291*            ITEM    (SC-ITEM)
  7292*        END-EXEC
  7293*    MOVE '*$II   L              ''   #00007274' TO DFHEIV0
  7294     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7295     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7296     MOVE X'2020233030303037323734' TO DFHEIV0(25:11)
  7297     CALL 'kxdfhei1' USING DFHEIV0,
  7298           PI-SECURITY-TEMP-STORE-ID,
  7299           SECURITY-CONTROL,
  7300           SC-COMM-LENGTH,
  7301           SC-ITEM,
  7302           DFHEIV99,
  7303           DFHEIV99
  7304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7305         MOVE SC-CLAIMS-DISPLAY (5)    TO  PI-DISPLAY-CAP
  7306         MOVE SC-CLAIMS-UPDATE  (5)    TO  PI-MODIFY-CAP
  7307         IF NOT DISPLAY-CAP
  7308             MOVE 'READ'               TO  SM-READ
  7309             PERFORM 9995-SECURITY-VIOLATION
  7310             MOVE ER-0070              TO  EMI-ERROR
  7311             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7312             GO TO 8100-SEND-MAP.
  7313
  7314
  7315* EXEC CICS RECEIVE
  7316*        MAP    ('EL131A')
  7317*        MAPSET ('EL131S')
  7318*    END-EXEC.
  7319     MOVE 'EL131A' TO DFHEIV1
  7320     MOVE 'EL131S' TO DFHEIV2
  7321*    MOVE '8"T                   ''   #00007289' TO DFHEIV0
  7322     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  7323     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7324     MOVE X'2020233030303037323839' TO DFHEIV0(25:11)
  7325     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 132
* EL131.cbl
  7326           DFHEIV1,
  7327           EL131AI,
  7328           DFHEIV99,
  7329           DFHEIV2,
  7330           DFHEIV99,
  7331           DFHEIV99
  7332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7333
  7334
  7335     IF PFKEYL GREATER THAN ZERO
  7336         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  7337
  7338     IF SCREEN-ERROR
  7339         MOVE ER-0004 TO EMI-ERROR
  7340         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7341         MOVE -1 TO MAINTL
  7342         GO TO 8110-SEND-DATA.
  7343
  7344     IF EIBAID = DFHPF3
  7345         GO TO 8500-TRLR-MNT.
  7346
  7347     IF EIBAID = DFHPF4
  7348         GO TO 8600-ADDR-MNT.
  7349
  7350     IF EIBAID = DFHPF5
  7351         GO TO 8700-CERT-MNT.
  7352
  7353     IF PI-COMPANY-ID = 'DMD'
  7354       IF EIBAID = DFHPF6
  7355         GO TO 8750-DMD-CLM-FIX.
  7356
  7357     IF EIBAID = DFHPF7
  7358         GO TO 4000-FORCE-ERRORS.
  7359
  7360     IF EIBAID = DFHPF12
  7361         GO TO 8300-GET-HELP.
  7362
  7363     IF EIBAID = DFHPF23
  7364         GO TO 8810-PF23-ENTERED.
  7365
  7366     IF EIBAID = DFHPF24
  7367         GO TO 8400-RETURN-MASTER.
  7368
  7369     IF EIBAID NOT = DFHENTER
  7370         MOVE ER-0029            TO EMI-ERROR
  7371         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7372         MOVE -1                 TO MAINTL
  7373         GO TO 8110-SEND-DATA.
  7374
  7375     IF PI-RETURN-CD-1 =  'X'
  7376         MOVE ER-0311            TO EMI-ERROR
  7377         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7378         MOVE -1                 TO MAINTL
  7379         GO TO 8110-SEND-DATA.
  7380
  7381     IF MAINTI = 'A'
  7382         GO TO 0500-ADD-ALPHA-ONLY.
  7383
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 133
* EL131.cbl
  7384     IF MAINTI = 'N'
  7385         GO TO 0600-CHANGE-NAME.
  7386
  7387     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  7388
  7389     IF SCREEN-ERROR
  7390         GO TO 8110-SEND-DATA.
  7391
  7392     IF NOT UPDATES-PRESENT AND NOT DELETE-CLAIM
  7393         MOVE ER-0276            TO EMI-ERROR
  7394         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7395         MOVE -1                 TO MAINTL
  7396         GO TO 8110-SEND-DATA.
  7397
  7398     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
  7399
  7400     IF SCREEN-ERROR
  7401         GO TO 8110-SEND-DATA.
  7402
  7403     MOVE 'W'                    TO EMI-ACTION-SWITCH.
  7404
  7405     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7406
  7407     IF EMI-FORCABLE-CTR GREATER THAN ZERO
  7408         GO TO 8110-SEND-DATA.
  7409
  7410     IF EMI-FATAL-CTR GREATER THAN ZERO
  7411         GO TO 8110-SEND-DATA.
  7412
  7413     MOVE SPACE                  TO EMI-ACTION-SWITCH.
  7414
  7415     IF WS-OPEN-CLOSE-SW = 'Y'
  7416         IF PI-LETTER-SW = 'Y'
  7417             MOVE PI-COMPANY-ID  TO  CNTL-CO-ID
  7418             MOVE 'T'            TO  CNTL-REC-TYPE
  7419             MOVE SPACES         TO  CNTL-PROC-ID
  7420             MOVE +0             TO  CNTL-SEQ-NO
  7421
  7422* EXEC CICS READ
  7423*                DATASET   (CNTL-FILE-ID)
  7424*                RIDFLD    (CNTL-KEY)
  7425*                SET       (ADDRESS OF CONTROL-FILE)
  7426*            END-EXEC
  7427*    MOVE '&"S        E          (   #00007380' TO DFHEIV0
  7428     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7429     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7430     MOVE X'2020233030303037333830' TO DFHEIV0(25:11)
  7431     CALL 'kxdfhei1' USING DFHEIV0,
  7432           CNTL-FILE-ID,
  7433           DFHEIV20,
  7434           DFHEIV99,
  7435           CNTL-KEY,
  7436           DFHEIV99,
  7437           DFHEIV99,
  7438           DFHEIV99
  7439     SET ADDRESS OF CONTROL-FILE TO
  7440         DFHEIV20
  7441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 134
* EL131.cbl
  7442             PERFORM 7850-AUTO-LETTER-WRITER THRU 7850-EXIT.
  7443
  7444     MOVE ER-0000                TO EMI-ERROR.
  7445     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7446
  7447     MOVE SPACE                  TO MAINTO.
  7448     MOVE -1                     TO MAINTL.
  7449     GO TO 8100-SEND-MAP.
  7450
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 135
* EL131.cbl
  7452 0100-UPDATE-PI.
  7453     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  7454         GO TO 0110-UPDATE-UP.
  7455
  7456     MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6.
  7457     MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5.
  7458     MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4.
  7459     MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3.
  7460     MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2.
  7461     MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1.
  7462     MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM.
  7463     MOVE THIS-PGM               TO PI-CALLING-PROGRAM.
  7464     GO TO 0120-UPDATE-PI-EXIT.
  7465
  7466 0110-UPDATE-UP.
  7467     MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM.
  7468     MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM.
  7469     MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1.
  7470     MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2.
  7471     MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3.
  7472     MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4.
  7473     MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5.
  7474     MOVE SPACES             TO PI-SAVED-PROGRAM-6.
  7475
  7476
  7477* EXEC CICS HANDLE CONDITION
  7478*         QIDERR    (0130-TS-ERROR)
  7479*         ITEMERR   (0130-TS-ERROR)
  7480*    END-EXEC.
  7481*    MOVE '"$N<                  ! # #00007419' TO DFHEIV0
  7482     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  7483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7484     MOVE X'2320233030303037343139' TO DFHEIV0(25:11)
  7485     CALL 'kxdfhei1' USING DFHEIV0
  7486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7487
  7488
  7489
  7490* EXEC CICS READQ TS
  7491*         QUEUE    (PI-KEY)
  7492*         INTO     (PROGRAM-INTERFACE-BLOCK)
  7493*         LENGTH   (PI-COMM-LENGTH)
  7494*    END-EXEC.
  7495*    MOVE '*$I    L              ''   #00007424' TO DFHEIV0
  7496     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7497     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7498     MOVE X'2020233030303037343234' TO DFHEIV0(25:11)
  7499     CALL 'kxdfhei1' USING DFHEIV0,
  7500           PI-KEY,
  7501           PROGRAM-INTERFACE-BLOCK,
  7502           PI-COMM-LENGTH,
  7503           DFHEIV99,
  7504           DFHEIV99,
  7505           DFHEIV99
  7506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7507
  7508
  7509
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 136
* EL131.cbl
  7510* EXEC CICS DELETEQ TS
  7511*         QUEUE    (PI-KEY)
  7512*    END-EXEC.
  7513*    MOVE '*&                    #   #00007430' TO DFHEIV0
  7514     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7515     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7516     MOVE X'2020233030303037343330' TO DFHEIV0(25:11)
  7517     CALL 'kxdfhei1' USING DFHEIV0,
  7518           PI-KEY,
  7519           DFHEIV99
  7520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7521
  7522
  7523 0120-UPDATE-PI-EXIT.
  7524     EXIT.
  7525
  7526 0130-TS-ERROR.
  7527     MOVE LOW-VALUES             TO EL131AO.
  7528     MOVE ER-0192                TO EMI-ERROR.
  7529
  7530     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7531
  7532     GO TO 8100-SEND-MAP.
  7533
  7534 0200-TRANS-PF.
  7535     IF EIBAID NOT = DFHENTER
  7536         MOVE 'X'                TO ERROR-SWITCH
  7537         GO TO 0210-EXIT.
  7538
  7539     IF PFKEYI NOT NUMERIC
  7540         MOVE 'X'                TO ERROR-SWITCH
  7541         GO TO 0210-EXIT.
  7542
  7543     MOVE PFKEYI                 TO CHECK-PFKEYS.
  7544
  7545     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  7546         MOVE 'X' TO ERROR-SWITCH
  7547         GO TO 0210-EXIT.
  7548
  7549     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  7550
  7551 0210-EXIT.
  7552     EXIT.
  7553
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 137
* EL131.cbl
  7555 0500-ADD-ALPHA-ONLY.
  7556******************************************************************
  7557*    ADD NAME TO ALPHA FILE.  NO CHANGES ARE MADE TO THE CLAIM   *
  7558*    RECORD.                                                     *
  7559******************************************************************
  7560
  7561     IF MLNAMEL = +0 AND
  7562        MFNAMEL = +0 AND
  7563        MMINITL = +0
  7564         MOVE ER-0797                TO  EMI-ERROR
  7565         MOVE -1                     TO  MAINTL
  7566         MOVE AL-UABON               TO  MAINTA
  7567         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7568         GO TO 8110-SEND-DATA.
  7569
  7570     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7571     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7572     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7573     MOVE PI-CERT-NO                 TO  CERT-NO.
  7574
  7575
  7576* EXEC CICS READ
  7577*        DATASET   (CLMS-FILE-ID)
  7578*        RIDFLD    (MSTR-KEY)
  7579*        SET       (ADDRESS OF CLAIM-MASTER)
  7580*    END-EXEC.
  7581*    MOVE '&"S        E          (   #00007486' TO DFHEIV0
  7582     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7583     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7584     MOVE X'2020233030303037343836' TO DFHEIV0(25:11)
  7585     CALL 'kxdfhei1' USING DFHEIV0,
  7586           CLMS-FILE-ID,
  7587           DFHEIV20,
  7588           DFHEIV99,
  7589           MSTR-KEY,
  7590           DFHEIV99,
  7591           DFHEIV99,
  7592           DFHEIV99
  7593     SET ADDRESS OF CLAIM-MASTER TO
  7594         DFHEIV20
  7595     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7596
  7597
  7598
  7599* EXEC CICS GETMAIN
  7600*        SET       (ADDRESS OF ALPHA-INDEX)
  7601*        LENGTH    (ALPH-LENGTH)
  7602*        INITIMG   (GETMAIN-SPACE)
  7603*    END-EXEC.
  7604*    MOVE ',"IL                  $   #00007492' TO DFHEIV0
  7605     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7606     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7607     MOVE X'2020233030303037343932' TO DFHEIV0(25:11)
  7608     CALL 'kxdfhei1' USING DFHEIV0,
  7609           DFHEIV20,
  7610           ALPH-LENGTH,
  7611           GETMAIN-SPACE
  7612     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 138
* EL131.cbl
  7613         DFHEIV20
  7614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7615
  7616
  7617     MOVE 'AI'                       TO  AI-RECORD-ID.
  7618     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7619                                         AI-CL-COMPANY-CD.
  7620     MOVE 'C'                        TO  AI-SOURCE
  7621                                         AI-CL-SOURCE.
  7622
  7623     IF MLNAMEL IS GREATER THAN +0
  7624         MOVE MLNAMEI                TO  AI-LAST-NAME
  7625     ELSE
  7626         MOVE CL-INSURED-LAST-NAME   TO  AI-LAST-NAME.
  7627
  7628     IF MFNAMEL IS GREATER THAN +0
  7629         MOVE MFNAMEI                TO  AI-FIRST-NAME
  7630     ELSE
  7631         MOVE CL-INSURED-1ST-NAME    TO  AI-FIRST-NAME.
  7632
  7633     IF MMINITL IS GREATER THAN +0
  7634         MOVE MMINITI                TO  AI-MIDDLE-INIT
  7635     ELSE
  7636         MOVE CL-INSURED-MID-INIT    TO  AI-MIDDLE-INIT.
  7637
  7638     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7639     MOVE '5'                        TO  DC-OPTION-CODE.
  7640     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7641     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7642     IF BUILD-YEAR IS GREATER THAN 50
  7643         MOVE '19'                   TO  WS-ALPHA-YY-1
  7644         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7645         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7646         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7647     ELSE
  7648         MOVE '20'                   TO  WS-ALPHA-YY-1
  7649         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7650         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7651         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7652
  7653     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7654                                         AI-CL-DATE.
  7655
  7656     MOVE EIBTIME                    TO  AI-TIME
  7657                                         AI-CL-TIME.
  7658
  7659     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7660     MOVE 'C'                        TO  AI-CL-SOURCE.
  7661     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7662     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7663     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7664     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7665     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7666
  7667     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7668     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7669     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7670
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 139
* EL131.cbl
  7671
  7672* EXEC CICS WRITE
  7673*        DATASET   (ALPH-FILE-ID)
  7674*        RIDFLD    (AI-CONTROL-PRIMARY)
  7675*        FROM      (ALPHA-INDEX)
  7676*    END-EXEC.
  7677     MOVE LENGTH OF
  7678      ALPHA-INDEX
  7679       TO DFHEIV11
  7680*    MOVE '&$ L                  ''   #00007552' TO DFHEIV0
  7681     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7682     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7683     MOVE X'2020233030303037353532' TO DFHEIV0(25:11)
  7684     CALL 'kxdfhei1' USING DFHEIV0,
  7685           ALPH-FILE-ID,
  7686           ALPHA-INDEX,
  7687           DFHEIV11,
  7688           AI-CONTROL-PRIMARY,
  7689           DFHEIV99,
  7690           DFHEIV99
  7691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7692
  7693
  7694     MOVE LOW-VALUES                 TO  EL131AO.
  7695     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7696     MOVE ER-0000                    TO  EMI-ERROR.
  7697     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7698     MOVE -1                         TO  MAINTL.
  7699     GO TO 8100-SEND-MAP.
  7700
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 140
* EL131.cbl
  7702 0600-CHANGE-NAME.
  7703******************************************************************
  7704*    MOVE NAME IN THE CLAIM RECORD TO THE ALPHA FILE AND REPLACE *
  7705*    IT WITH THE NAME THAT IS KEYED ON THE SCREEN.               *
  7706******************************************************************
  7707
  7708     IF MLNAMEL = +0 AND
  7709        MFNAMEL = +0 AND
  7710        MMINITL = +0
  7711         MOVE ER-0276                TO  EMI-ERROR
  7712         MOVE -1                     TO  MAINTL
  7713         MOVE AL-UABON               TO  MAINTA
  7714         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7715         GO TO 8110-SEND-DATA.
  7716
  7717     MOVE PI-COMPANY-CD              TO  COMPANY-CODE.
  7718     MOVE PI-CARRIER                 TO  CARRIER-CODE.
  7719     MOVE PI-CLAIM-NO                TO  CLAIM-NO.
  7720     MOVE PI-CERT-NO                 TO  CERT-NO.
  7721
  7722
  7723* EXEC CICS READ
  7724*        DATASET   (CLMS-FILE-ID)
  7725*        RIDFLD    (MSTR-KEY)
  7726*        SET       (ADDRESS OF CLAIM-MASTER)
  7727*    END-EXEC.
  7728*    MOVE '&"S        E          (   #00007586' TO DFHEIV0
  7729     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7730     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7731     MOVE X'2020233030303037353836' TO DFHEIV0(25:11)
  7732     CALL 'kxdfhei1' USING DFHEIV0,
  7733           CLMS-FILE-ID,
  7734           DFHEIV20,
  7735           DFHEIV99,
  7736           MSTR-KEY,
  7737           DFHEIV99,
  7738           DFHEIV99,
  7739           DFHEIV99
  7740     SET ADDRESS OF CLAIM-MASTER TO
  7741         DFHEIV20
  7742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7743
  7744
  7745
  7746* EXEC CICS GETMAIN
  7747*        SET       (ADDRESS OF ALPHA-INDEX)
  7748*        LENGTH    (ALPH-LENGTH)
  7749*        INITIMG   (GETMAIN-SPACE)
  7750*    END-EXEC.
  7751*    MOVE ',"IL                  $   #00007592' TO DFHEIV0
  7752     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7753     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7754     MOVE X'2020233030303037353932' TO DFHEIV0(25:11)
  7755     CALL 'kxdfhei1' USING DFHEIV0,
  7756           DFHEIV20,
  7757           ALPH-LENGTH,
  7758           GETMAIN-SPACE
  7759     SET ADDRESS OF ALPHA-INDEX TO
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 141
* EL131.cbl
  7760         DFHEIV20
  7761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7762
  7763
  7764     MOVE 'AI'                       TO  AI-RECORD-ID.
  7765     MOVE CL-COMPANY-CD              TO  AI-COMPANY-CD
  7766                                         AI-CL-COMPANY-CD.
  7767     MOVE 'C'                        TO  AI-SOURCE
  7768                                         AI-CL-SOURCE.
  7769
  7770     MOVE CL-INSURED-LAST-NAME       TO  AI-LAST-NAME.
  7771     MOVE CL-INSURED-1ST-NAME        TO  AI-FIRST-NAME.
  7772     MOVE CL-INSURED-MID-INIT        TO  AI-MIDDLE-INIT.
  7773
  7774     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  7775     MOVE '5'                        TO  DC-OPTION-CODE.
  7776     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  7777     MOVE DC-GREG-DATE-1-MDY         TO  BUILD-VALID-DATE.
  7778     IF BUILD-YEAR IS GREATER THAN 50
  7779         MOVE '19'                   TO  WS-ALPHA-YY-1
  7780         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7781         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7782         MOVE BUILD-DAY              TO  WS-ALPHA-DD
  7783     ELSE
  7784         MOVE '20'                   TO  WS-ALPHA-YY-1
  7785         MOVE BUILD-YEAR             TO  WS-ALPHA-YY-2
  7786         MOVE BUILD-MONTH            TO  WS-ALPHA-MM
  7787         MOVE BUILD-DAY              TO  WS-ALPHA-DD.
  7788
  7789     MOVE WS-ALPHA-DATE              TO  AI-DATE
  7790                                         AI-CL-DATE.
  7791
  7792     MOVE EIBTIME                    TO  AI-TIME
  7793                                         AI-CL-TIME.
  7794
  7795     MOVE CL-COMPANY-CD              TO  AI-CL-COMPANY-CD.
  7796     MOVE 'C'                        TO  AI-CL-SOURCE.
  7797     MOVE CL-CARRIER                 TO  AI-CL-CARRIER.
  7798     MOVE CL-CLAIM-NO                TO  AI-CL-CLAIM-NUMBER.
  7799     MOVE CL-CERT-NO                 TO  AI-CL-CERTIFICATE-NUMBER.
  7800     MOVE CL-INCURRED-DT             TO  AI-CL-INCURRED-DATE.
  7801     MOVE LOW-VALUES                 TO  AI-CL-CLOSE-DATE.
  7802
  7803     MOVE PI-PROCESSOR-ID            TO  AI-LAST-MAINT-BY.
  7804     MOVE SAVE-BIN-DATE              TO  AI-LAST-MAINT-DT.
  7805     MOVE EIBTIME                    TO  AI-LAST-MAINT-HHMMSS.
  7806
  7807     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7808         MOVE 'Y'                TO CL-YESNOSW
  7809     END-IF.
  7810
  7811
  7812* EXEC CICS WRITE
  7813*        DATASET   (ALPH-FILE-ID)
  7814*        RIDFLD    (AI-CONTROL-PRIMARY)
  7815*        FROM      (ALPHA-INDEX)
  7816*    END-EXEC.
  7817     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 142
* EL131.cbl
  7818      ALPHA-INDEX
  7819       TO DFHEIV11
  7820*    MOVE '&$ L                  ''   #00007645' TO DFHEIV0
  7821     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7822     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7823     MOVE X'2020233030303037363435' TO DFHEIV0(25:11)
  7824     CALL 'kxdfhei1' USING DFHEIV0,
  7825           ALPH-FILE-ID,
  7826           ALPHA-INDEX,
  7827           DFHEIV11,
  7828           AI-CONTROL-PRIMARY,
  7829           DFHEIV99,
  7830           DFHEIV99
  7831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7832
  7833
  7834
  7835* EXEC CICS READ
  7836*        DATASET   (CLMS-FILE-ID)
  7837*        RIDFLD    (MSTR-KEY)
  7838*        SET       (ADDRESS OF CLAIM-MASTER)
  7839*        UPDATE
  7840*    END-EXEC.
  7841*    MOVE '&"S        EU         (   #00007651' TO DFHEIV0
  7842     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7843     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7844     MOVE X'2020233030303037363531' TO DFHEIV0(25:11)
  7845     CALL 'kxdfhei1' USING DFHEIV0,
  7846           CLMS-FILE-ID,
  7847           DFHEIV20,
  7848           DFHEIV99,
  7849           MSTR-KEY,
  7850           DFHEIV99,
  7851           DFHEIV99,
  7852           DFHEIV99
  7853     SET ADDRESS OF CLAIM-MASTER TO
  7854         DFHEIV20
  7855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7856
  7857
  7858     if (cl-priority-cd = '8')
  7859        and (pi-processor-id not = 'PEMA'and 'JMS '
  7860             AND 'AMWA' AND 'KMSB')
  7861        MOVE ER-8003             TO EMI-ERROR
  7862        PERFORM 9900-ERROR-FORMAT
  7863                                 THRU 9900-EXIT
  7864        MOVE -1                  TO MAINTL
  7865        GO TO 8110-SEND-DATA
  7866     end-if
  7867
  7868     IF MLNAMEL IS GREATER THAN +0
  7869         MOVE MLNAMEI                TO  CL-INSURED-LAST-NAME.
  7870
  7871     IF MFNAMEL IS GREATER THAN +0
  7872         MOVE MFNAMEI                TO  CL-INSURED-1ST-NAME.
  7873
  7874     IF MMINITL IS GREATER THAN +0
  7875         MOVE MMINITI                TO  CL-INSURED-MID-INIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 143
* EL131.cbl
  7876
  7877     MOVE PI-PROCESSOR-ID            TO  CL-LAST-MAINT-USER.
  7878     MOVE SAVE-BIN-DATE              TO  CL-LAST-MAINT-DT.
  7879     MOVE EIBTIME                    TO  CL-LAST-MAINT-HHMMSS.
  7880     MOVE '3'                        TO  CL-LAST-MAINT-TYPE.
  7881
  7882     IF PI-COMPANY-ID = 'CID' or 'AHL'
  7883         MOVE 'Y'                TO CL-YESNOSW
  7884     END-IF.
  7885
  7886
  7887* EXEC CICS HANDLE CONDITION
  7888*        DUPKEY   (0600-CONTINUE-NAME-UPDATE)
  7889*    END-EXEC.
  7890*    MOVE '"$$                   ! $ #00007686' TO DFHEIV0
  7891     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  7892     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7893     MOVE X'2420233030303037363836' TO DFHEIV0(25:11)
  7894     CALL 'kxdfhei1' USING DFHEIV0
  7895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7896
  7897
  7898
  7899* EXEC CICS REWRITE
  7900*        DATASET   (CLMS-FILE-ID)
  7901*        FROM      (CLAIM-MASTER)
  7902*    END-EXEC.
  7903     MOVE LENGTH OF
  7904      CLAIM-MASTER
  7905       TO DFHEIV11
  7906*    MOVE '&& L                  %   #00007690' TO DFHEIV0
  7907     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7908     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7909     MOVE X'2020233030303037363930' TO DFHEIV0(25:11)
  7910     CALL 'kxdfhei1' USING DFHEIV0,
  7911           CLMS-FILE-ID,
  7912           CLAIM-MASTER,
  7913           DFHEIV11,
  7914           DFHEIV99
  7915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7916
  7917
  7918 0600-CONTINUE-NAME-UPDATE.
  7919
  7920     MOVE LOW-VALUES                 TO  EL131AO.
  7921     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
  7922     MOVE ER-0000                    TO  EMI-ERROR.
  7923     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7924     MOVE -1                         TO  MAINTL.
  7925     GO TO 8100-SEND-MAP.
  7926
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 144
* EL131.cbl
  7928 1000-EDIT-SCREEN.
  7929
  7930     MOVE MAINTI                 TO CHECK-MAINT.
  7931
  7932     IF NOT VALID-OPTIONS
  7933         MOVE 'X'                TO ERROR-SWITCH
  7934         MOVE -1                 TO MAINTL
  7935         MOVE AL-UABON           TO MAINTA
  7936         MOVE ER-0023            TO EMI-ERROR
  7937         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7938         GO TO 1010-EXIT.
  7939
  7940     IF NOT MODIFY-CAP
  7941         MOVE 'UPDATE'           TO  SM-READ
  7942         PERFORM 9995-SECURITY-VIOLATION
  7943         MOVE ER-0070               TO  EMI-ERROR
  7944         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7945         GO TO 8100-SEND-MAP.
  7946
  7947     IF DELETE-CLAIM
  7948         MOVE AL-UANON TO MAINTA
  7949         GO TO 1010-EXIT.
  7950
  7951     MOVE AL-UANON               TO MAINTA.
  7952
  7953     IF CCNOI GREATER THAN LOW-VALUES
  7954         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  7955
  7956     IF PI-COMPANY-ID = 'CSL'
  7957        CONTINUE
  7958     ELSE
  7959        IF TYPEL > ZERO
  7960           IF ((PI-COMPANY-ID = 'CID' or 'AHL')
  7961              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7962                    PI-LIFE-OVERRIDE-L1))
  7963                       OR
  7964              ((PI-COMPANY-ID = 'DCC')
  7965              AND (TYPEI = PI-AH-OVERRIDE-L1 OR
  7966                PI-LIFE-OVERRIDE-L1 OR 'I' OR 'G'))
  7967              MOVE AL-UANON      TO TYPEA
  7968              MOVE 'X'           TO UPDATE-SWITCH MSTR-SWITCH
  7969           ELSE
  7970              MOVE ER-0199       TO EMI-ERROR
  7971              PERFORM 9900-ERROR-FORMAT
  7972                                 THRU 9900-EXIT
  7973              MOVE AL-UABON      TO TYPEA
  7974              MOVE -1            TO TYPEL
  7975              MOVE 'X'           TO ERROR-SWITCH
  7976           END-IF
  7977        ELSE
  7978           MOVE AL-UANOF         TO TYPEA
  7979        END-IF
  7980     END-IF
  7981     IF STATUSI GREATER THAN LOW-VALUES
  7982         IF STATUSI = 'OPEN' OR 'CLOSED' OR 'O' OR 'C'
  7983             MOVE 'Y'            TO WS-OPEN-CLOSE-SW
  7984             MOVE AL-UANON       TO STATUSA
  7985             MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH TRLR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 145
* EL131.cbl
  7986             MOVE 'Y'            TO DLYACTV-SW
  7987         ELSE
  7988             MOVE ER-0333        TO EMI-ERROR
  7989             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7990             MOVE AL-UABON       TO STATUSA
  7991             MOVE -1             TO STATUSL
  7992             MOVE 'X'            TO ERROR-SWITCH
  7993         END-IF
  7994     ELSE
  7995         MOVE SPACE              TO TRLR-SWITCH
  7996         MOVE 'N'                TO DLYACTV-SW
  7997         MOVE AL-UANOF           TO STATUSA.
  7998
  7999     IF PROCI GREATER THAN LOW-VALUES
  8000         PERFORM 1120-EDIT-PROC THRU 1120-EXIT
  8001     ELSE
  8002         MOVE AL-UANOF TO PROCA.
  8003
  8004     IF SEXI GREATER THAN LOW-VALUES
  8005         IF SEXI = 'F' OR 'M'
  8006             MOVE AL-UANON       TO SEXA
  8007             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8008           ELSE
  8009             MOVE ER-0219        TO EMI-ERROR
  8010             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8011             MOVE AL-UABON       TO SEXA
  8012             MOVE -1             TO SEXL
  8013             MOVE 'X'            TO ERROR-SWITCH
  8014       ELSE
  8015         MOVE AL-UANOF           TO SEXA.
  8016
  8017     IF BIRTHL = +0
  8018         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8019         MOVE AL-UANOF           TO  BIRTHA
  8020         GO TO 1000-CONTINUE-EDITS.
  8021
  8022     IF BIRTHI = SPACES
  8023         MOVE LOW-VALUES         TO  HOLD-BIRTH
  8024         MOVE 'X'                TO  UPDATE-SWITCH
  8025                                     MSTR-SWITCH
  8026         GO TO 1000-CONTINUE-EDITS.
  8027
  8028     MOVE BIRTHI                 TO  DEEDIT-DATE-INPUT.
  8029     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  8030     MOVE DEEDIT-DATE            TO  DC-GREG-DATE-1-MDY.
  8031     MOVE '4'                    TO  DC-OPTION-CODE.
  8032     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  8033     IF DATE-CONVERSION-ERROR
  8034         MOVE ER-0220            TO  EMI-ERROR
  8035         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8036         MOVE AL-UABON           TO  BIRTHA
  8037         MOVE -1                 TO  BIRTHL
  8038         MOVE 'X'                TO  ERROR-SWITCH
  8039         GO TO 1000-CONTINUE-EDITS.
  8040
  8041******************************************************************
  8042**   IF CALCULATED BIRTH DATE IS GREATER THAN TODAYS DATE       **
  8043**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 146
* EL131.cbl
  8044**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
  8045******************************************************************
  8046     IF DC-BIN-DATE-1 IS GREATER THAN SAVE-BIN-DATE
  8047         MOVE BIRTHI             TO  DEEDIT-DATE-INPUT
  8048         PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8049         MOVE DEEDIT-DATE        TO  DC-GREG-DATE-1-MDY
  8050         MOVE '4'                TO  DC-OPTION-CODE
  8051         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
  8052         MOVE +0                 TO  DC-ELAPSED-MONTHS
  8053                                     DC-ELAPSED-DAYS
  8054         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8055         IF DATE-CONVERSION-ERROR
  8056             MOVE ER-0220        TO  EMI-ERROR
  8057             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8058             MOVE AL-UABON       TO  BIRTHA
  8059             MOVE -1             TO  BIRTHL
  8060             MOVE 'X'            TO  ERROR-SWITCH
  8061             GO TO 1000-CONTINUE-EDITS.
  8062
  8063     MOVE AL-UANON               TO  BIRTHA.
  8064     MOVE 'X'                    TO  UPDATE-SWITCH
  8065                                     MSTR-SWITCH.
  8066     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHO.
  8067     MOVE DC-BIN-DATE-1          TO  HOLD-BIRTH.
  8068     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
  8069
  8070 1000-CONTINUE-EDITS.
  8071
  8072     IF SOCIALI GREATER THAN LOW-VALUES
  8073         MOVE SOCIALI TO WS-SOC-SEC-NUMBER
  8074         IF WS-SOC-SEC-NO NUMERIC AND
  8075           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
  8076             NEXT SENTENCE
  8077         ELSE
  8078            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
  8079               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
  8080               WS-SSN-DASH2 = '-'
  8081                 NEXT SENTENCE
  8082            ELSE
  8083                 MOVE ER-0887        TO  EMI-ERROR
  8084                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8085                 MOVE AL-UABON       TO  SOCIALA
  8086                 MOVE -1             TO  SOCIALL
  8087                 MOVE 'X'            TO  ERROR-SWITCH
  8088            END-IF
  8089        END-IF
  8090     END-IF.
  8091
  8092     IF SOCIALI GREATER THAN LOW-VALUES
  8093         MOVE AL-UANON           TO SOCIALA
  8094         MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH
  8095     ELSE
  8096         MOVE AL-UANOF           TO SOCIALA.
  8097
  8098     IF OCCI GREATER THAN LOW-VALUES
  8099         MOVE AL-UANON           TO OCCA
  8100         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8101     ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 147
* EL131.cbl
  8102         MOVE AL-UANOF           TO OCCA.
  8103
  8104     IF BENEL NOT GREATER THAN ZERO
  8105            GO TO 1005-CONTINUE-EDITS.
  8106
  8107     IF BENEI = SPACES
  8108        IF PI-AUTO-PAY-SEQ NOT = ZEROS
  8109           MOVE 'N'             TO AUTO-PAY-TO-BENE
  8110           PERFORM 2800-CHECK-AUTO-PAY THRU 2800-EXIT
  8111           IF AUTO-PAY-TO-BENE = 'Y'
  8112               MOVE ER-1773      TO  EMI-ERROR
  8113               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8114               MOVE 'X'          TO ERROR-SWITCH
  8115               MOVE AL-UABON     TO BENEA
  8116               MOVE -1           TO BENEL
  8117           ELSE
  8118               MOVE 'X'          TO UPDATE-SWITCH MSTR-SWITCH
  8119           END-IF
  8120        ELSE
  8121           MOVE 'X'              TO UPDATE-SWITCH MSTR-SWITCH
  8122        END-IF
  8123        GO TO 1005-CONTINUE-EDITS.
  8124
  8125
  8126* EXEC CICS HANDLE CONDITION
  8127*        NOTFND (1004-BENE-NOT-FOUND)
  8128*    END-EXEC.
  8129*    MOVE '"$I                   ! % #00007902' TO DFHEIV0
  8130     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8132     MOVE X'2520233030303037393032' TO DFHEIV0(25:11)
  8133     CALL 'kxdfhei1' USING DFHEIV0
  8134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8135
  8136
  8137     MOVE PI-COMPANY-CD          TO  WS-ELBENE-COMPANY-CD.
  8138     MOVE 'B'                    TO  WS-ELBENE-RECORD-TYPE.
  8139     MOVE BENEI                  TO  WS-ELBENE-ID.
  8140
  8141
  8142* EXEC CICS READ
  8143*        DATASET ('ELBENE')
  8144*        RIDFLD  (WS-ELBENE-KEY)
  8145*        SET     (ADDRESS OF BENEFICIARY-MASTER)
  8146*    END-EXEC.
  8147     MOVE 'ELBENE' TO DFHEIV1
  8148*    MOVE '&"S        E          (   #00007910' TO DFHEIV0
  8149     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8150     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8151     MOVE X'2020233030303037393130' TO DFHEIV0(25:11)
  8152     CALL 'kxdfhei1' USING DFHEIV0,
  8153           DFHEIV1,
  8154           DFHEIV20,
  8155           DFHEIV99,
  8156           WS-ELBENE-KEY,
  8157           DFHEIV99,
  8158           DFHEIV99,
  8159           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 148
* EL131.cbl
  8160     SET ADDRESS OF BENEFICIARY-MASTER TO
  8161         DFHEIV20
  8162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8163
  8164
  8165     MOVE AL-UANON               TO  BENEA.
  8166     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH.
  8167
  8168     GO TO 1005-CONTINUE-EDITS.
  8169
  8170 1004-BENE-NOT-FOUND.
  8171     MOVE ER-0565                TO  EMI-ERROR.
  8172
  8173     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8174     MOVE 'X'                    TO ERROR-SWITCH.
  8175     MOVE AL-UABON               TO BENEA.
  8176     MOVE -1                     TO BENEL.
  8177
  8178 1005-CONTINUE-EDITS.
  8179
  8180     IF DIAGI GREATER THAN LOW-VALUES
  8181         MOVE AL-UANON           TO DIAGA
  8182         MOVE 'X'                TO UPDATE-SWITCH
  8183                                    NINETY-TRLR-SWITCH
  8184     ELSE
  8185         MOVE AL-UANOF           TO DIAGA.
  8186
  8187     IF CAUSEI GREATER THAN LOW-VALUES
  8188         MOVE AL-UANON           TO CAUSEA
  8189         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8190     ELSE
  8191         MOVE AL-UANOF           TO CAUSEA.
  8192
  8193     IF ENDL GREATER THAN ZERO
  8194         MOVE LOW-VALUES         TO HOLD-END
  8195         IF ENDI = SPACES
  8196             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8197         ELSE
  8198             MOVE ENDI           TO DEEDIT-DATE-INPUT
  8199
  8200* EXEC CICS BIF DEEDIT
  8201*                FIELD    (DEEDIT-DATE-INPUT)
  8202*                LENGTH   (DATE-LENGTH)
  8203*            END-EXEC
  8204*    MOVE '@"L                   #   #00007950' TO DFHEIV0
  8205     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8206     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8207     MOVE X'2020233030303037393530' TO DFHEIV0(25:11)
  8208     CALL 'kxdfhei1' USING DFHEIV0,
  8209           DEEDIT-DATE-INPUT,
  8210           DATE-LENGTH
  8211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8212             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8213             MOVE '4'            TO DC-OPTION-CODE
  8214             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8215             IF NOT DATE-CONVERSION-ERROR
  8216                 MOVE DC-BIN-DATE-1      TO HOLD-END
  8217                 MOVE AL-UANON   TO ENDA
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 149
* EL131.cbl
  8218                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8219                 MOVE DC-GREG-DATE-1-EDIT TO ENDO
  8220             ELSE
  8221                 MOVE ER-0224    TO EMI-ERROR
  8222                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8223                 MOVE AL-UABON   TO ENDA
  8224                 MOVE -1         TO ENDL
  8225                 MOVE 'X'        TO ERROR-SWITCH
  8226       ELSE
  8227           MOVE AL-UANOF         TO ENDA.
  8228
  8229     IF INCL GREATER THAN ZERO
  8230         MOVE LOW-VALUES         TO HOLD-INCUR
  8231         IF INCI = SPACES
  8232             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8233         ELSE
  8234             MOVE INCI           TO DEEDIT-DATE-INPUT
  8235
  8236* EXEC CICS BIF DEEDIT
  8237*                FIELD    (DEEDIT-DATE-INPUT)
  8238*                LENGTH   (DATE-LENGTH)
  8239*            END-EXEC
  8240*    MOVE '@"L                   #   #00007977' TO DFHEIV0
  8241     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8242     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8243     MOVE X'2020233030303037393737' TO DFHEIV0(25:11)
  8244     CALL 'kxdfhei1' USING DFHEIV0,
  8245           DEEDIT-DATE-INPUT,
  8246           DATE-LENGTH
  8247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8248             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8249             MOVE '4'            TO DC-OPTION-CODE
  8250             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8251             IF NOT DATE-CONVERSION-ERROR
  8252                 MOVE DC-BIN-DATE-1      TO HOLD-INCUR
  8253                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8254                 MOVE AL-UANON           TO INCA
  8255                 MOVE DC-GREG-DATE-1-EDIT TO INCO
  8256             ELSE
  8257                 MOVE ER-0222    TO EMI-ERROR
  8258                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8259                 MOVE AL-UABON   TO INCA
  8260                 MOVE -1         TO INCL
  8261                 MOVE 'X'        TO ERROR-SWITCH
  8262       ELSE
  8263           IF PI-NO-PMTS = ZEROS
  8264               MOVE AL-UANOF     TO INCA.
  8265
  8266     IF REPL GREATER THAN ZERO
  8267         MOVE LOW-VALUES         TO HOLD-REPORTED
  8268         IF REPI = SPACES
  8269             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8270         ELSE
  8271             MOVE REPI           TO DEEDIT-DATE-INPUT
  8272
  8273* EXEC CICS BIF DEEDIT
  8274*                FIELD    (DEEDIT-DATE-INPUT)
  8275*                LENGTH   (DATE-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 150
* EL131.cbl
  8276*            END-EXEC
  8277*    MOVE '@"L                   #   #00008005' TO DFHEIV0
  8278     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8279     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8280     MOVE X'2020233030303038303035' TO DFHEIV0(25:11)
  8281     CALL 'kxdfhei1' USING DFHEIV0,
  8282           DEEDIT-DATE-INPUT,
  8283           DATE-LENGTH
  8284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8285             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8286             MOVE '4'            TO DC-OPTION-CODE
  8287             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8288             IF NOT DATE-CONVERSION-ERROR
  8289                 MOVE DC-BIN-DATE-1      TO HOLD-REPORTED
  8290                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8291                 MOVE AL-UANON   TO REPA
  8292                 MOVE DC-GREG-DATE-1-EDIT TO REPO
  8293             ELSE
  8294                 MOVE ER-0223    TO EMI-ERROR
  8295                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8296                 MOVE AL-UABON   TO REPA
  8297                 MOVE -1         TO REPL
  8298                 MOVE 'X'        TO ERROR-SWITCH
  8299       ELSE
  8300         MOVE AL-UANOF TO REPA.
  8301
  8302     IF PDTHRUI GREATER THAN LOW-VALUES
  8303        MOVE LOW-VALUES         TO HOLD-PDTHRU
  8304        IF PDTHRUI = SPACES
  8305           MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8306        ELSE
  8307           MOVE PDTHRUI        TO DEEDIT-DATE-INPUT
  8308
  8309* EXEC CICS BIF DEEDIT
  8310*               FIELD    (DEEDIT-DATE-INPUT)
  8311*               LENGTH   (DATE-LENGTH)
  8312*          END-EXEC
  8313*    MOVE '@"L                   #   #00008032' TO DFHEIV0
  8314     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8315     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8316     MOVE X'2020233030303038303332' TO DFHEIV0(25:11)
  8317     CALL 'kxdfhei1' USING DFHEIV0,
  8318           DEEDIT-DATE-INPUT,
  8319           DATE-LENGTH
  8320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8321           MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8322           MOVE '4'            TO DC-OPTION-CODE
  8323           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8324           IF NOT DATE-CONVERSION-ERROR
  8325              MOVE DC-BIN-DATE-1      TO HOLD-PDTHRU
  8326              MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8327              MOVE AL-UANON   TO PDTHRUA
  8328              MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
  8329              IF PI-USES-PAID-TO
  8330                 MOVE '6'            TO DC-OPTION-CODE
  8331                 MOVE -1             TO DC-ELAPSED-DAYS
  8332                 MOVE +0             TO DC-ELAPSED-MONTHS
  8333                 PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 151
* EL131.cbl
  8334                 IF NO-CONVERSION-ERROR
  8335                    MOVE DC-BIN-DATE-2 TO HOLD-PDTHRU
  8336                 ELSE
  8337                    NEXT SENTENCE
  8338              ELSE
  8339                 NEXT SENTENCE
  8340           ELSE
  8341              MOVE ER-0475    TO EMI-ERROR
  8342              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8343              MOVE AL-UABON   TO PDTHRUA
  8344              MOVE -1         TO PDTHRUL
  8345              MOVE 'X'        TO ERROR-SWITCH
  8346     ELSE
  8347        IF MODIFY-CAP
  8348           MOVE AL-UANOF        TO PDTHRUA.
  8349
  8350     IF PDAMTL GREATER THAN +0
  8351         MOVE ZEROS              TO HOLD-PDAMT
  8352
  8353* EXEC CICS BIF DEEDIT
  8354*            FIELD    (PDAMTI)
  8355*            LENGTH   (9)
  8356*        END-EXEC
  8357     MOVE 9
  8358       TO DFHEIV11
  8359*    MOVE '@"L                   #   #00008067' TO DFHEIV0
  8360     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8361     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8362     MOVE X'2020233030303038303637' TO DFHEIV0(25:11)
  8363     CALL 'kxdfhei1' USING DFHEIV0,
  8364           PDAMTI,
  8365           DFHEIV11
  8366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8367         IF PDAMTI NUMERIC
  8368             MOVE PDAMTI         TO HOLD-PDAMT PDAMTO
  8369             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8370             MOVE AL-UNNON       TO PDAMTA
  8371         ELSE
  8372             MOVE ER-0547        TO EMI-ERROR
  8373             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8374             MOVE AL-UNBON       TO PDAMTA
  8375             MOVE -1             TO PDAMTL
  8376             MOVE 'X'            TO ERROR-SWITCH
  8377     ELSE
  8378         IF MODIFY-CAP
  8379            MOVE AL-UNNOF        TO PDAMTA.
  8380
  8381     IF NODAYSI GREATER THAN LOW-VALUES
  8382         MOVE ZEROS              TO HOLD-NODAYS
  8383
  8384* EXEC CICS BIF DEEDIT
  8385*            FIELD (NODAYSI)
  8386*            LENGTH (5)
  8387*        END-EXEC
  8388     MOVE 5
  8389       TO DFHEIV11
  8390*    MOVE '@"L                   #   #00008087' TO DFHEIV0
  8391     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 152
* EL131.cbl
  8392     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8393     MOVE X'2020233030303038303837' TO DFHEIV0(25:11)
  8394     CALL 'kxdfhei1' USING DFHEIV0,
  8395           NODAYSI,
  8396           DFHEIV11
  8397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8398         IF NODAYSI NUMERIC
  8399             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8400             MOVE AL-UNNON       TO NODAYSA
  8401             MOVE NODAYSI        TO  HOLD-NODAYS  NODAYSO
  8402         ELSE
  8403             MOVE ER-0491        TO EMI-ERROR
  8404             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8405             MOVE AL-UNBON       TO NODAYSA
  8406             MOVE -1             TO NODAYSL
  8407             MOVE 'X'            TO ERROR-SWITCH
  8408     ELSE
  8409         IF MODIFY-CAP
  8410            MOVE AL-UNNOF        TO NODAYSA.
  8411
  8412     IF NOPMTSI GREATER THAN LOW-VALUES
  8413         MOVE ZEROS              TO HOLD-NOPMTS
  8414
  8415* EXEC CICS BIF DEEDIT
  8416*            FIELD (NOPMTSI)
  8417*            LENGTH (4)
  8418*        END-EXEC
  8419     MOVE 4
  8420       TO DFHEIV11
  8421*    MOVE '@"L                   #   #00008107' TO DFHEIV0
  8422     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8423     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8424     MOVE X'2020233030303038313037' TO DFHEIV0(25:11)
  8425     CALL 'kxdfhei1' USING DFHEIV0,
  8426           NOPMTSI,
  8427           DFHEIV11
  8428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8429         IF NOPMTSI NUMERIC
  8430             MOVE NOPMTSI        TO HOLD-NOPMTS  NOPMTSO
  8431             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8432             MOVE AL-UNNON       TO NOPMTSA
  8433           ELSE
  8434             MOVE ER-0548        TO EMI-ERROR
  8435             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8436             MOVE AL-UNBON       TO NOPMTSA
  8437             MOVE -1             TO NOPMTSL
  8438             MOVE 'X'            TO ERROR-SWITCH
  8439       ELSE
  8440         IF MODIFY-CAP
  8441            MOVE AL-UNNOF        TO NOPMTSA.
  8442
  8443     IF FORMTYPI GREATER THAN LOW-VALUES
  8444         IF FORMTYPI = ' ' OR 'L' OR 'S'
  8445             MOVE AL-UANON       TO FORMTYPA
  8446             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8447           ELSE
  8448             MOVE ER-7650        TO EMI-ERROR
  8449             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 153
* EL131.cbl
  8450             MOVE AL-UABON       TO FORMTYPA
  8451             MOVE -1             TO FORMTYPL
  8452             MOVE 'X'            TO ERROR-SWITCH
  8453       ELSE
  8454         MOVE AL-UANOF           TO FORMTYPA.
  8455
  8456     IF PRICDL GREATER THAN ZERO
  8457         IF (PRICDI = ' ') OR
  8458            (PRICDI GREATER THAN ZERO   AND
  8459             PRICDI NOT GREATER THAN '9')
  8460             MOVE AL-UANON       TO PRICDA
  8461             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8462         ELSE
  8463             MOVE ER-0274        TO EMI-ERROR
  8464             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8465             MOVE AL-UABON       TO PRICDA
  8466             MOVE -1             TO PRICDL
  8467             MOVE 'X'            TO ERROR-SWITCH
  8468     ELSE
  8469         MOVE AL-UANOF TO PRICDA.
  8470
  8471     IF PI-COMPANY-ID = 'DMD'
  8472     IF PRICDL GREATER THAN ZERO
  8473       IF SYSTEM-MODIFY-CAP  OR
  8474          PI-PROCESSOR-ID = 'LGXX'
  8475             NEXT SENTENCE
  8476           ELSE
  8477            IF CL-PRIORITY-CD = '9'  OR
  8478               PRICDI         = '9'
  8479                  MOVE ER-0938        TO EMI-ERROR
  8480                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8481                  MOVE AL-UABON       TO PRICDA
  8482                  MOVE -1             TO PRICDL
  8483                  MOVE 'X'            TO ERROR-SWITCH.
  8484
  8485     IF FILETOL GREATER THAN ZERO
  8486         MOVE AL-UANON           TO FILETOA
  8487         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8488     ELSE
  8489         MOVE AL-UANOF TO FILETOA.
  8490
  8491     IF SUPVL GREATER THAN ZERO
  8492         IF SUPVI = 'Y' OR 'N' OR SPACE
  8493             MOVE AL-UANON       TO SUPVA
  8494             MOVE 'X'            TO UPDATE-SWITCH MSTR-SWITCH
  8495         ELSE
  8496             MOVE ER-0230        TO EMI-ERROR
  8497             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8498             MOVE AL-UABON       TO SUPVA
  8499             MOVE -1             TO SUPVL
  8500             MOVE 'X'            TO ERROR-SWITCH
  8501     ELSE
  8502         MOVE AL-UANOF           TO SUPVA.
  8503
  8504     IF MLNAMEL GREATER THAN ZERO
  8505         IF MLNAMEI GREATER THAN SPACES
  8506            MOVE AL-UANON        TO MLNAMEA
  8507            MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 154
* EL131.cbl
  8508                                     MSTR-KEY-SWITCH
  8509         ELSE
  8510            MOVE ER-0236         TO EMI-ERROR
  8511            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8512            MOVE AL-UABON        TO MLNAMEA
  8513            MOVE -1              TO MLNAMEL
  8514            MOVE 'X'             TO ERROR-SWITCH
  8515     ELSE
  8516         MOVE AL-UANOF           TO MLNAMEA.
  8517
  8518     IF MFNAMEI GREATER THAN LOW-VALUES
  8519         MOVE AL-UANON           TO MFNAMEA
  8520         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8521     ELSE
  8522         MOVE AL-UANOF           TO MFNAMEA.
  8523
  8524     IF MMINITI GREATER THAN LOW-VALUES
  8525         MOVE AL-UANON           TO MMINITA
  8526         MOVE 'X'                TO UPDATE-SWITCH MSTR-SWITCH
  8527     ELSE
  8528         MOVE AL-UANOF           TO MMINITA.
  8529
  8530     IF CRTLNMEI GREATER THAN LOW-VALUES
  8531         IF CRTLNMEI NOT = SPACES
  8532            MOVE AL-UANON        TO CRTLNMEA
  8533            MOVE 'X'             TO  UPDATE-SWITCH CERT-SWITCH
  8534                                     CERT-KEY-SWITCH
  8535        ELSE
  8536            MOVE ER-0236         TO EMI-ERROR
  8537            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8538            MOVE AL-UABON        TO CRTLNMEA
  8539            MOVE -1              TO CRTLNMEL
  8540            MOVE 'X'             TO ERROR-SWITCH
  8541     ELSE
  8542         MOVE AL-UANOF           TO CRTLNMEA.
  8543
  8544     IF CRTFNMEI GREATER THAN LOW-VALUES
  8545         MOVE AL-UANON           TO CRTFNMEA
  8546         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8547     ELSE
  8548         MOVE AL-UANOF           TO CRTFNMEA.
  8549
  8550     IF CRTINITI GREATER THAN LOW-VALUES
  8551         MOVE AL-UANON           TO CRTINITA
  8552         MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH CERT-KEY-SWITCH
  8553     ELSE
  8554         MOVE AL-UANOF           TO CRTINITA.
  8555
  8556     IF ISSAGEL GREATER THAN ZERO
  8557         IF ISSAGEI NUMERIC
  8558            MOVE AL-UANON        TO ISSAGEA
  8559            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8560         ELSE
  8561            MOVE ER-0237         TO EMI-ERROR
  8562            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8563            MOVE AL-UABON        TO ISSAGEA
  8564            MOVE -1              TO ISSAGEL
  8565            MOVE 'X'             TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 155
* EL131.cbl
  8566     ELSE
  8567         MOVE AL-UANOF           TO ISSAGEA.
  8568
  8569     IF JNTFNMEI GREATER THAN LOW-VALUES
  8570         MOVE AL-UANON           TO JNTFNMEA
  8571         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8572     ELSE
  8573         MOVE AL-UANOF           TO JNTFNMEA.
  8574
  8575     IF JNTLNMEI GREATER THAN LOW-VALUES
  8576         MOVE AL-UANON           TO JNTLNMEA
  8577         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8578     ELSE
  8579         MOVE AL-UANOF           TO JNTLNMEA.
  8580
  8581     IF JNTINITI GREATER THAN LOW-VALUES
  8582         MOVE AL-UANON           TO JNTINITA
  8583         MOVE 'X'                TO UPDATE-SWITCH CERT-SWITCH
  8584     ELSE
  8585         MOVE AL-UANOF           TO JNTINITA.
  8586
  8587     IF JNTAGEL GREATER THAN ZERO
  8588         IF JNTAGEI NUMERIC
  8589            MOVE AL-UANON        TO JNTAGEA
  8590            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8591         ELSE
  8592            MOVE ER-0238         TO EMI-ERROR
  8593            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8594            MOVE AL-UABON        TO JNTAGEA
  8595            MOVE -1              TO JNTAGEL
  8596            MOVE 'X'             TO ERROR-SWITCH
  8597     ELSE
  8598         MOVE AL-UANOF           TO JNTAGEA.
  8599
  8600     IF ADDONDTI GREATER THAN LOW-VALUES
  8601         MOVE LOW-VALUES         TO HOLD-ADDON
  8602         IF ADDONDTI = SPACES
  8603             MOVE 'X'  TO UPDATE-SWITCH MSTR-SWITCH CERT-SWITCH
  8604         ELSE
  8605             MOVE ADDONDTI       TO DEEDIT-DATE-INPUT
  8606
  8607* EXEC CICS BIF DEEDIT
  8608*                FIELD    (DEEDIT-DATE-INPUT)
  8609*                LENGTH   (DATE-LENGTH)
  8610*            END-EXEC
  8611*    MOVE '@"L                   #   #00008288' TO DFHEIV0
  8612     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8613     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8614     MOVE X'2020233030303038323838' TO DFHEIV0(25:11)
  8615     CALL 'kxdfhei1' USING DFHEIV0,
  8616           DEEDIT-DATE-INPUT,
  8617           DATE-LENGTH
  8618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8619             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8620             MOVE '4'            TO DC-OPTION-CODE
  8621             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8622             IF NOT DATE-CONVERSION-ERROR
  8623                 MOVE DC-BIN-DATE-1      TO HOLD-ADDON
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 156
* EL131.cbl
  8624                 MOVE 'X'        TO UPDATE-SWITCH MSTR-SWITCH
  8625                                                  CERT-SWITCH
  8626                 MOVE AL-UANON   TO ADDONDTA
  8627                 MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
  8628             ELSE
  8629                 MOVE ER-7651    TO EMI-ERROR
  8630                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8631                 MOVE AL-UABON   TO ADDONDTA
  8632                 MOVE -1         TO ADDONDTL
  8633                 MOVE 'X'        TO ERROR-SWITCH
  8634       ELSE
  8635         MOVE AL-UANOF TO ADDONDTA.
  8636
  8637     IF LCVCDI GREATER THAN LOW-VALUES
  8638         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
  8639         PERFORM 1240-EDIT-LIFE-CODE THRU 1240-EXIT
  8640     ELSE
  8641         MOVE AL-UANOF           TO LCVCDA.
  8642
  8643     IF ACVCDI GREATER THAN LOW-VALUES
  8644         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
  8645         PERFORM 1310-EDIT-AH-CODE THRU 1310-EXIT
  8646     ELSE
  8647         MOVE AL-UANOF           TO ACVCDA.
  8648
  8649     IF LCVOTRMI GREATER THAN LOW-VALUES
  8650
  8651* EXEC CICS BIF DEEDIT
  8652*            FIELD (LCVOTRMI)
  8653*            LENGTH(3)
  8654*        END-EXEC
  8655     MOVE 3
  8656       TO DFHEIV11
  8657*    MOVE '@"L                   #   #00008323' TO DFHEIV0
  8658     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8659     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8660     MOVE X'2020233030303038333233' TO DFHEIV0(25:11)
  8661     CALL 'kxdfhei1' USING DFHEIV0,
  8662           LCVOTRMI,
  8663           DFHEIV11
  8664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8665         IF LCVOTRMI IS NUMERIC
  8666             MOVE LCVOTRMI       TO LCVOTRMO
  8667             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8668             MOVE AL-UANON       TO LCVOTRMA
  8669         ELSE
  8670             MOVE ER-0241        TO EMI-ERROR
  8671             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8672             MOVE AL-UNBON       TO LCVOTRMA
  8673             MOVE 'X'            TO ERROR-SWITCH
  8674             MOVE -1             TO LCVOTRML
  8675     ELSE
  8676         MOVE AL-UANOF           TO LCVOTRMA.
  8677
  8678     IF ACVOTRMI GREATER THAN LOW-VALUES
  8679
  8680* EXEC CICS BIF DEEDIT
  8681*            FIELD (ACVOTRMI)
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 157
* EL131.cbl
  8682*            LENGTH(3)
  8683*        END-EXEC
  8684     MOVE 3
  8685       TO DFHEIV11
  8686*    MOVE '@"L                   #   #00008341' TO DFHEIV0
  8687     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8688     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8689     MOVE X'2020233030303038333431' TO DFHEIV0(25:11)
  8690     CALL 'kxdfhei1' USING DFHEIV0,
  8691           ACVOTRMI,
  8692           DFHEIV11
  8693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8694         IF ACVOTRMI IS NUMERIC
  8695             MOVE ACVOTRMI       TO ACVOTRMO
  8696             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8697             MOVE AL-UANON       TO ACVOTRMA
  8698         ELSE
  8699             MOVE ER-0241        TO EMI-ERROR
  8700             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8701             MOVE AL-UNBON       TO ACVOTRMA
  8702             MOVE 'X'            TO ERROR-SWITCH
  8703             MOVE -1             TO ACVOTRML
  8704     ELSE
  8705         MOVE AL-UANOF           TO ACVOTRMA.
  8706
  8707     IF LCVRATEL GREATER THAN +0
  8708
  8709* EXEC CICS BIF DEEDIT
  8710*            FIELD (LCVRATEI)
  8711*            LENGTH(6)
  8712*        END-EXEC
  8713     MOVE 6
  8714       TO DFHEIV11
  8715*    MOVE '@"L                   #   #00008359' TO DFHEIV0
  8716     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8717     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8718     MOVE X'2020233030303038333539' TO DFHEIV0(25:11)
  8719     CALL 'kxdfhei1' USING DFHEIV0,
  8720           LCVRATEI,
  8721           DFHEIV11
  8722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8723         IF LCVRATEI IS NUMERIC
  8724             MOVE LCVRATEI       TO HOLD-LF-RATE  LCVRATEO
  8725             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8726             MOVE AL-UNNON       TO LCVRATEA
  8727         ELSE
  8728             MOVE ER-2280        TO EMI-ERROR
  8729             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8730             MOVE AL-UNBON       TO LCVRATEA
  8731             MOVE 'X'            TO ERROR-SWITCH
  8732             MOVE -1             TO LCVRATEL
  8733     ELSE
  8734         MOVE AL-UNNOF           TO LCVRATEA.
  8735
  8736     IF ACVRATEL GREATER THAN +0
  8737
  8738* EXEC CICS BIF DEEDIT
  8739*            FIELD (ACVRATEI)
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 158
* EL131.cbl
  8740*            LENGTH(6)
  8741*        END-EXEC
  8742     MOVE 6
  8743       TO DFHEIV11
  8744*    MOVE '@"L                   #   #00008377' TO DFHEIV0
  8745     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8746     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8747     MOVE X'2020233030303038333737' TO DFHEIV0(25:11)
  8748     CALL 'kxdfhei1' USING DFHEIV0,
  8749           ACVRATEI,
  8750           DFHEIV11
  8751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8752         IF ACVRATEI IS NUMERIC
  8753             MOVE ACVRATEI       TO HOLD-AH-RATE  ACVRATEO
  8754             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8755             MOVE AL-UNNON       TO ACVRATEA
  8756         ELSE
  8757             MOVE ER-2280        TO EMI-ERROR
  8758             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8759             MOVE AL-UNBON       TO ACVRATEA
  8760             MOVE 'X'            TO ERROR-SWITCH
  8761             MOVE -1             TO ACVRATEL
  8762     ELSE
  8763         MOVE AL-UNNOF           TO ACVRATEA.
  8764
  8765     IF LCVBENEL GREATER THAN ZERO
  8766
  8767* EXEC CICS BIF DEEDIT
  8768*            FIELD (LCVBENEI)
  8769*            LENGTH (11)
  8770*        END-EXEC
  8771     MOVE 11
  8772       TO DFHEIV11
  8773*    MOVE '@"L                   #   #00008395' TO DFHEIV0
  8774     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8775     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8776     MOVE X'2020233030303038333935' TO DFHEIV0(25:11)
  8777     CALL 'kxdfhei1' USING DFHEIV0,
  8778           LCVBENEI,
  8779           DFHEIV11
  8780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8781         IF LCVBENEI IS NUMERIC
  8782            MOVE LCVBENEI        TO HOLD-LF-CV-BEN  LCVBENEO
  8783            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8784            MOVE AL-UNNON        TO LCVBENEA
  8785         ELSE
  8786            MOVE ER-0243         TO EMI-ERROR
  8787            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8788            MOVE AL-UNBON        TO LCVBENEA
  8789            MOVE -1              TO LCVBENEL
  8790            MOVE 'X'             TO ERROR-SWITCH
  8791     ELSE
  8792         MOVE AL-UANOF           TO LCVBENEA.
  8793
  8794     IF ACVBENEL GREATER THAN ZERO
  8795
  8796* EXEC CICS BIF DEEDIT
  8797*            FIELD (ACVBENEI)
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 159
* EL131.cbl
  8798*            LENGTH (11)
  8799*        END-EXEC
  8800     MOVE 11
  8801       TO DFHEIV11
  8802*    MOVE '@"L                   #   #00008413' TO DFHEIV0
  8803     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8804     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8805     MOVE X'2020233030303038343133' TO DFHEIV0(25:11)
  8806     CALL 'kxdfhei1' USING DFHEIV0,
  8807           ACVBENEI,
  8808           DFHEIV11
  8809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8810         IF ACVBENEI IS NUMERIC
  8811            MOVE ACVBENEI        TO HOLD-AH-CV-BEN  ACVBENEO
  8812            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8813            MOVE AL-UNNON        TO ACVBENEA
  8814         ELSE
  8815            MOVE ER-0243         TO EMI-ERROR
  8816            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8817            MOVE AL-UNBON        TO ACVBENEA
  8818            MOVE -1              TO ACVBENEL
  8819            MOVE 'X'             TO ERROR-SWITCH
  8820     ELSE
  8821         MOVE AL-UANOF           TO ACVBENEA.
  8822
  8823     IF LCVFORMI GREATER THAN LOW-VALUES
  8824        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8825        MOVE AL-UANON            TO LCVFORMA
  8826     ELSE
  8827        MOVE AL-UANOF            TO LCVFORMA.
  8828
  8829     IF ACVFORMI GREATER THAN LOW-VALUES
  8830        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  8831        MOVE AL-UANON            TO ACVFORMA
  8832     ELSE
  8833        MOVE AL-UANOF            TO ACVFORMA.
  8834
  8835     IF LCVCNDTL GREATER THAN ZERO
  8836         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8837         IF LCVCNDTI = SPACES
  8838             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8839         ELSE
  8840             MOVE LCVCNDTI       TO DEEDIT-DATE-INPUT
  8841             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8842             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8843             MOVE '4'            TO DC-OPTION-CODE
  8844             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8845             IF NOT DATE-CONVERSION-ERROR
  8846                 MOVE DC-BIN-DATE-1      TO HOLD-LF-CV-CAN
  8847                 MOVE AL-UANON   TO LCVCNDTA
  8848                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8849                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
  8850             ELSE
  8851                 MOVE ER-0246    TO EMI-ERROR
  8852                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8853                 MOVE AL-UABON   TO LCVCNDTA
  8854                 MOVE -1         TO LCVCNDTL
  8855                 MOVE 'X'        TO ERROR-SWITCH
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 160
* EL131.cbl
  8856     ELSE
  8857         MOVE LOW-VALUES         TO HOLD-LF-CV-CAN
  8858         MOVE AL-UANOF           TO LCVCNDTA.
  8859
  8860     IF ACVCNDTL GREATER THAN ZERO
  8861         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8862         IF ACVCNDTI = SPACES
  8863             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8864         ELSE
  8865             MOVE ACVCNDTI       TO DEEDIT-DATE-INPUT
  8866             PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT
  8867             MOVE DEEDIT-DATE    TO DC-GREG-DATE-1-MDY
  8868             MOVE '4'            TO DC-OPTION-CODE
  8869             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
  8870             IF NOT DATE-CONVERSION-ERROR
  8871                 MOVE DC-BIN-DATE-1      TO HOLD-AH-CV-CAN
  8872                 MOVE AL-UANON   TO ACVCNDTA
  8873                 MOVE 'X'        TO UPDATE-SWITCH CERT-SWITCH
  8874                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
  8875             ELSE
  8876                 MOVE ER-0246    TO EMI-ERROR
  8877                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8878                 MOVE AL-UABON   TO ACVCNDTA
  8879                 MOVE -1         TO ACVCNDTL
  8880                 MOVE 'X'        TO ERROR-SWITCH
  8881     ELSE
  8882         MOVE LOW-VALUES         TO HOLD-AH-CV-CAN
  8883         MOVE AL-UANOF           TO ACVCNDTA.
  8884
  8885     IF APRL GREATER THAN +0
  8886
  8887* EXEC CICS BIF DEEDIT
  8888*            FIELD    (APRI)
  8889*            LENGTH   (8)
  8890*        END-EXEC
  8891     MOVE 8
  8892       TO DFHEIV11
  8893*    MOVE '@"L                   #   #00008493' TO DFHEIV0
  8894     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8895     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8896     MOVE X'2020233030303038343933' TO DFHEIV0(25:11)
  8897     CALL 'kxdfhei1' USING DFHEIV0,
  8898           APRI,
  8899           DFHEIV11
  8900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8901         IF APRI NUMERIC
  8902            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8903            MOVE APRI            TO HOLD-APR APRO
  8904            MOVE AL-UANON        TO APRA
  8905          ELSE
  8906            MOVE ER-0259         TO EMI-ERROR
  8907            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8908            MOVE AL-UABON        TO APRA
  8909            MOVE -1              TO APRL
  8910            MOVE 'X'             TO ERROR-SWITCH
  8911     ELSE
  8912         MOVE AL-UANOF           TO APRA.
  8913
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 161
* EL131.cbl
  8914     IF PMTFREQL GREATER THAN ZERO
  8915
  8916* EXEC CICS BIF DEEDIT
  8917*            FIELD    (PMTFREQI)
  8918*            LENGTH   (2)
  8919*        END-EXEC
  8920     MOVE 2
  8921       TO DFHEIV11
  8922*    MOVE '@"L                   #   #00008511' TO DFHEIV0
  8923     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8924     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8925     MOVE X'2020233030303038353131' TO DFHEIV0(25:11)
  8926     CALL 'kxdfhei1' USING DFHEIV0,
  8927           PMTFREQI,
  8928           DFHEIV11
  8929     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8930         IF PMTFREQI NUMERIC
  8931            MOVE PMTFREQI        TO  HOLD-FREQ PMTFREQO
  8932            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8933            MOVE AL-UANON        TO PMTFREQA
  8934          ELSE
  8935            MOVE ER-0427         TO EMI-ERROR
  8936            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8937            MOVE AL-UABON        TO PMTFREQA
  8938            MOVE -1              TO PMTFREQL
  8939            MOVE 'X'             TO ERROR-SWITCH
  8940     ELSE
  8941         MOVE AL-UANOF           TO PMTFREQA.
  8942
  8943     IF INDGRPL GREATER THAN ZERO
  8944         IF INDGRPI = 'I' OR 'G' OR SPACE
  8945             MOVE 'X'            TO UPDATE-SWITCH CERT-SWITCH
  8946             MOVE AL-UANON       TO INDGRPA
  8947          ELSE
  8948             MOVE ER-0260        TO EMI-ERROR
  8949             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8950             MOVE AL-UABON       TO INDGRPA
  8951             MOVE -1             TO INDGRPL
  8952             MOVE 'X'            TO ERROR-SWITCH
  8953     ELSE
  8954         MOVE AL-UANOF           TO INDGRPA.
  8955
  8956     IF PREMTYPL GREATER THAN ZERO
  8957         IF PREMTYPI = '1' OR '2' OR '3'
  8958            MOVE PREMTYPI        TO PI-PREM-TYPE
  8959            MOVE AL-UNNON        TO PREMTYPA
  8960            MOVE 'X'             TO UPDATE-SWITCH CERT-SWITCH
  8961          ELSE
  8962            MOVE ER-0227         TO EMI-ERROR
  8963            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8964            MOVE AL-UNBON        TO PREMTYPA
  8965            MOVE -1              TO PREMTYPL
  8966            MOVE 'X'             TO ERROR-SWITCH
  8967     ELSE
  8968         MOVE AL-UANOF           TO PREMTYPA.
  8969
  8970     IF LOANBALL GREATER THAN ZERO
  8971
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 162
* EL131.cbl
  8972* EXEC CICS BIF DEEDIT
  8973*             FIELD    (LOANBALI)
  8974*             LENGTH   (9)
  8975*        END-EXEC
  8976     MOVE 9
  8977       TO DFHEIV11
  8978*    MOVE '@"L                   #   #00008556' TO DFHEIV0
  8979     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8980     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8981     MOVE X'2020233030303038353536' TO DFHEIV0(25:11)
  8982     CALL 'kxdfhei1' USING DFHEIV0,
  8983           LOANBALI,
  8984           DFHEIV11
  8985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8986         IF LOANBALI NUMERIC
  8987             MOVE LOANBALI       TO  HOLD-LOANBAL LOANBALO
  8988             MOVE 'X' TO UPDATE-SWITCH CERT-SWITCH MSTR-SWITCH
  8989             MOVE AL-UNNON TO LOANBALA
  8990         ELSE
  8991             MOVE ER-0639        TO EMI-ERROR
  8992             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8993             MOVE AL-UNBON       TO LOANBALA
  8994             MOVE -1             TO LOANBALL
  8995             MOVE 'X'            TO ERROR-SWITCH
  8996     ELSE
  8997         MOVE AL-UNNOF           TO LOANBALA.
  8998
  8999     IF LOANNOL GREATER THAN ZERO
  9000        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9001        MOVE AL-UANON            TO LOANNOA
  9002     ELSE
  9003        MOVE AL-UANOF            TO LOANNOA.
  9004
  9005     IF REINCDI GREATER THAN LOW-VALUES
  9006        MOVE 'X'                 TO UPDATE-SWITCH CERT-SWITCH
  9007        MOVE AL-UANON            TO REINCDA
  9008     ELSE
  9009        MOVE AL-UANOF            TO REINCDA.
  9010
  9011     IF CERTI GREATER THAN LOW-VALUES
  9012         PERFORM 1460-EDIT-CERT-NO THRU 1460-EXIT
  9013     ELSE
  9014         MOVE AL-UANOF           TO CERTA.
  9015
  9016     IF CERTEFFI GREATER THAN LOW-VALUES
  9017         PERFORM 1470-EDIT-EFF THRU 1470-EXIT
  9018     ELSE
  9019         MOVE AL-UANOF           TO CERTEFFA.
  9020
  9021     IF CERTACTI GREATER THAN LOW-VALUES
  9022         PERFORM 1480-EDIT-ACCT THRU 1480-EXIT
  9023     ELSE
  9024         MOVE AL-UANOF           TO CERTACTA.
  9025
  9026     IF CERTSTI GREATER THAN LOW-VALUES
  9027         PERFORM 1490-EDIT-STATE THRU 1490-EXIT
  9028     ELSE
  9029         MOVE AL-UANOF           TO CERTSTA.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 163
* EL131.cbl
  9030
  9031     IF CERTCARI GREATER THAN LOW-VALUES
  9032         PERFORM 1500-EDIT-CARR THRU 1500-EXIT
  9033     ELSE
  9034         MOVE AL-UANOF           TO CERTCARA.
  9035
  9036     IF DLYACTV-RECORD-NEEDED
  9037         PERFORM 1150-OUTPUT-ACTIVITY-RECORD THRU
  9038                 1150-EXIT
  9039     END-IF.
  9040
  9041     IF CERTEFFI GREATER LOW-VALUES OR
  9042        CERTACTI GREATER LOW-VALUES OR
  9043        CERTSTI  GREATER LOW-VALUES OR
  9044        CERTCARI GREATER LOW-VALUES OR
  9045        CERTGRPI GREATER LOW-VALUES
  9046        PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9047
  9048*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
  9049*      IF PI-PREM-TYPE NOT = '1'  AND
  9050*         PI-NO-PMTS = ZEROS
  9051*          IF LOANBALL GREATER +0 OR
  9052*             ACVBENEL GREATER +0
  9053*               PERFORM 1620-VERIFY-ACCT THRU 1620-EXIT.
  9054
  9055     if accswl > zeros
  9056        if accswi = 'Y' OR 'N'
  9057           MOVE 'X'              TO UPDATE-SWITCH
  9058                                    MSTR-SWITCH
  9059           MOVE AL-UANON         TO accswa
  9060        else
  9061           move er-1656          to emi-error
  9062           PERFORM 9900-ERROR-FORMAT
  9063                                 THRU 9900-EXIT
  9064           move al-uabon         to accswa
  9065           move -1               to accswl
  9066           move 'X'              to error-switch
  9067           move al-uanof         to accswa
  9068        end-if
  9069     end-if
  9070     IF CERTL = ZEROS AND
  9071        SUFXL = ZEROS
  9072          GO TO 1010-EXIT.
  9073
  9074     IF CERTL GREATER THAN ZEROS
  9075         IF CERTI NOT = PI-SAVE-CERT-NO-PRIME
  9076             MOVE CERTI          TO PI-SAVE-CERT-NO-PRIME
  9077             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9078             MOVE 'X'            TO ERROR-SWITCH
  9079             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9080
  9081     IF SUFXL GREATER THAN ZEROS
  9082         IF SUFXI NOT = PI-SAVE-CERT-NO-SUFX
  9083             MOVE SUFXI          TO PI-SAVE-CERT-NO-SUFX
  9084             MOVE 'Y'            TO SKIP-ATTRIBUTE
  9085             MOVE 'X'            TO ERROR-SWITCH
  9086             PERFORM 7000-RESET-ATTRIBUTE THRU 7000-EXIT.
  9087
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 164
* EL131.cbl
  9088 1010-EXIT.
  9089     EXIT.
  9090
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 165
* EL131.cbl
  9092 1120-EDIT-PROC.
  9093     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9094     MOVE '2'                    TO CNTL-REC-TYPE.
  9095     MOVE PROCI                  TO CNTL-PROC-ID.
  9096     MOVE ZERO                   TO CNTL-SEQ-NO.
  9097
  9098
  9099* EXEC CICS HANDLE CONDITION
  9100*         NOTFND    (1120-CNTL-NOTFND)
  9101*    END-EXEC.
  9102*    MOVE '"$I                   ! & #00008672' TO DFHEIV0
  9103     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9104     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9105     MOVE X'2620233030303038363732' TO DFHEIV0(25:11)
  9106     CALL 'kxdfhei1' USING DFHEIV0
  9107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9108
  9109
  9110
  9111* EXEC CICS READ
  9112*         SET      (ADDRESS OF CONTROL-FILE)
  9113*         DATASET  (CNTL-FILE-ID)
  9114*         RIDFLD   (CNTL-KEY)
  9115*    END-EXEC.
  9116*    MOVE '&"S        E          (   #00008676' TO DFHEIV0
  9117     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9118     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9119     MOVE X'2020233030303038363736' TO DFHEIV0(25:11)
  9120     CALL 'kxdfhei1' USING DFHEIV0,
  9121           CNTL-FILE-ID,
  9122           DFHEIV20,
  9123           DFHEIV99,
  9124           CNTL-KEY,
  9125           DFHEIV99,
  9126           DFHEIV99,
  9127           DFHEIV99
  9128     SET ADDRESS OF CONTROL-FILE TO
  9129         DFHEIV20
  9130     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9131
  9132
  9133     MOVE AL-UANON               TO PROCA.
  9134     MOVE 'X' TO UPDATE-SWITCH MSTR-SWITCH MSTR-KEY-SWITCH.
  9135     GO TO 1120-EXIT.
  9136
  9137 1120-CNTL-NOTFND.
  9138     MOVE ER-0273                TO EMI-ERROR.
  9139     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9140     MOVE AL-UABON               TO PROCA.
  9141     MOVE -1                     TO PROCL.
  9142     MOVE 'X'                    TO ERROR-SWITCH.
  9143
  9144 1120-EXIT.
  9145     EXIT.
  9146
  9147*************************************************************
  9148*****    BEGIN PROCESSING FOR OUTPUTTING DLYACTV RECORD    **
  9149*************************************************************
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 166
* EL131.cbl
  9150
  9151 1150-OUTPUT-ACTIVITY-RECORD.
  9152
  9153
  9154* EXEC CICS GETMAIN
  9155*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
  9156*        LENGTH (25)
  9157*        INITIMG (WS-BLANK)
  9158*    END-EXEC.
  9159     MOVE 25
  9160       TO DFHEIV11
  9161*    MOVE ',"IL                  $   #00008702' TO DFHEIV0
  9162     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9163     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9164     MOVE X'2020233030303038373032' TO DFHEIV0(25:11)
  9165     CALL 'kxdfhei1' USING DFHEIV0,
  9166           DFHEIV20,
  9167           DFHEIV11,
  9168           WS-BLANK
  9169     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
  9170         DFHEIV20
  9171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9172
  9173
  9174     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
  9175     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
  9176     MOVE PI-CARRIER             TO DA-CARRIER.
  9177     MOVE PI-CLAIM-NO            TO DA-CLAIM-NO.
  9178     MOVE PI-CERT-NO             TO DA-CERT-NO.
  9179     MOVE ZEROS                  TO DA-TRAILER-SEQ-NO.
  9180     MOVE WS-HOLD-CLAIM-STATUS   TO DA-RECORD-TYPE.
  9181
  9182
  9183* EXEC CICS HANDLE CONDITION
  9184*        NOTOPEN (1150-NOTOPEN-ERROR)
  9185*        DUPREC (1150-EXIT)
  9186*    END-EXEC.
  9187*    MOVE '"$J%                  ! '' #00008716' TO DFHEIV0
  9188     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  9189     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9190     MOVE X'2720233030303038373136' TO DFHEIV0(25:11)
  9191     CALL 'kxdfhei1' USING DFHEIV0
  9192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9193
  9194     MOVE DAILY-ACTIVITY-RECORD  TO JP-RECORD-AREA.
  9195     MOVE 'DLYACTV'              TO JP-FILE-ID.
  9196     MOVE 'A'                    TO JP-RECORD-TYPE.
  9197     MOVE +48                    TO JOURNAL-LENGTH.
  9198
  9199
  9200* EXEC CICS WRITE
  9201*        DATASET ('DLYACTV')
  9202*        RIDFLD (DA-KEY)
  9203*        FROM (DAILY-ACTIVITY-RECORD)
  9204*        LENGTH (25)
  9205*    END-EXEC.
  9206     MOVE 'DLYACTV' TO DFHEIV1
  9207     MOVE 25
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 167
* EL131.cbl
  9208       TO DFHEIV11
  9209*    MOVE '&$ L                  ''   #00008725' TO DFHEIV0
  9210     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9211     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9212     MOVE X'2020233030303038373235' TO DFHEIV0(25:11)
  9213     CALL 'kxdfhei1' USING DFHEIV0,
  9214           DFHEIV1,
  9215           DAILY-ACTIVITY-RECORD,
  9216           DFHEIV11,
  9217           DA-KEY,
  9218           DFHEIV99,
  9219           DFHEIV99
  9220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9221
  9222
  9223     GO TO 1150-EXIT.
  9224
  9225 1150-NOTOPEN-ERROR.
  9226
  9227     MOVE '2955'                 TO EMI-ERROR.
  9228     MOVE -1                     TO MAINTL.
  9229     MOVE AL-UANON               TO MAINTA.
  9230     MOVE 'X'                    TO ERROR-SWITCH.
  9231     PERFORM 9900-ERROR-FORMAT THRU
  9232             9900-EXIT.
  9233
  9234 1150-EXIT.
  9235     EXIT.
  9236
  9237*************************************************************
  9238*****    END OF PROCESSING FOR OUTPUTTING DLYACTV RECORD    *
  9239*************************************************************
  9240
  9241 1240-EDIT-LIFE-CODE.
  9242
  9243     IF INVALID-BENEFIT-CODE
  9244         GO TO 1240-SET-ERROR.
  9245
  9246     MOVE SPACES                 TO BENEFIT-KEY.
  9247     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9248     MOVE '4'                    TO BEN-REC-TYPE.
  9249     MOVE LCVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9250     MOVE ZERO                   TO BEN-SEQ-NO.
  9251
  9252
  9253* EXEC CICS READ GTEQ
  9254*         DATASET  (CNTL-FILE-ID)
  9255*         RIDFLD   (BENEFIT-KEY)
  9256*         SET      (ADDRESS OF CONTROL-FILE)
  9257*    END-EXEC.
  9258*    MOVE '&"S        G          (   #00008761' TO DFHEIV0
  9259     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9260     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9261     MOVE X'2020233030303038373631' TO DFHEIV0(25:11)
  9262     CALL 'kxdfhei1' USING DFHEIV0,
  9263           CNTL-FILE-ID,
  9264           DFHEIV20,
  9265           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 168
* EL131.cbl
  9266           BENEFIT-KEY,
  9267           DFHEIV99,
  9268           DFHEIV99,
  9269           DFHEIV99
  9270     SET ADDRESS OF CONTROL-FILE TO
  9271         DFHEIV20
  9272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9273
  9274
  9275     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9276        CF-RECORD-TYPE NOT = '4'
  9277         GO TO 1240-SET-ERROR.
  9278
  9279     MOVE ZERO                   TO COUNT-2.
  9280     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9281
  9282     IF SCREEN-ERROR
  9283         GO TO 1240-SET-ERROR.
  9284
  9285 1240-SET-CODE-SWITCHES.
  9286     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9287     MOVE AL-UANON               TO LCVCDA.
  9288     GO TO 1240-EXIT.
  9289
  9290 1240-SET-ERROR.
  9291     MOVE ER-0240                TO EMI-ERROR.
  9292     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9293     MOVE 'X'                    TO ERROR-SWITCH.
  9294     MOVE AL-UABON               TO LCVCDA.
  9295     MOVE -1                     TO LCVCDL.
  9296
  9297 1240-EXIT.
  9298     EXIT.
  9299
  9300 1310-EDIT-AH-CODE.
  9301     IF INVALID-BENEFIT-CODE
  9302         GO TO 1310-SET-ERROR.
  9303
  9304     MOVE SPACES                 TO BENEFIT-KEY.
  9305     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
  9306     MOVE '5'                    TO BEN-REC-TYPE.
  9307     MOVE ACVCDI                 TO BEN-ACC-CD HOLD-BENEFIT.
  9308     MOVE ZERO                   TO BEN-SEQ-NO.
  9309
  9310
  9311* EXEC CICS READ GTEQ
  9312*         DATASET  (CNTL-FILE-ID)
  9313*         RIDFLD   (BENEFIT-KEY)
  9314*         SET      (ADDRESS OF CONTROL-FILE)
  9315*    END-EXEC.
  9316*    MOVE '&"S        G          (   #00008802' TO DFHEIV0
  9317     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9318     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9319     MOVE X'2020233030303038383032' TO DFHEIV0(25:11)
  9320     CALL 'kxdfhei1' USING DFHEIV0,
  9321           CNTL-FILE-ID,
  9322           DFHEIV20,
  9323           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 169
* EL131.cbl
  9324           BENEFIT-KEY,
  9325           DFHEIV99,
  9326           DFHEIV99,
  9327           DFHEIV99
  9328     SET ADDRESS OF CONTROL-FILE TO
  9329         DFHEIV20
  9330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9331
  9332
  9333     IF CF-COMPANY-ID  NOT = PI-COMPANY-ID OR
  9334        CF-RECORD-TYPE NOT = '5'
  9335         GO TO 1310-SET-ERROR.
  9336
  9337     MOVE ZERO                   TO COUNT-2.
  9338     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
  9339     IF SCREEN-ERROR
  9340         GO TO 1310-SET-ERROR.
  9341
  9342 1310-SET-CODE-SWITCHES.
  9343     MOVE 'X'                    TO UPDATE-SWITCH CERT-SWITCH.
  9344     MOVE AL-UANON               TO ACVCDA.
  9345     GO TO 1310-EXIT.
  9346
  9347 1310-SET-ERROR.
  9348     MOVE ER-0250                TO EMI-ERROR.
  9349     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9350     MOVE AL-UABON               TO ACVCDA.
  9351     MOVE 'X'                    TO ERROR-SWITCH.
  9352     MOVE -1                     TO ACVCDL.
  9353
  9354 1310-EXIT.
  9355     EXIT.
  9356
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 170
* EL131.cbl
  9358 1460-EDIT-CERT-NO.
  9359     MOVE CERTI                  TO WS-CERT-NO-PRIME.
  9360     MOVE SUFXI                  TO WS-CERT-NO-SUFX.
  9361
  9362     IF WS-SAVE-CERT-NO = SPACES
  9363         MOVE ER-0203            TO EMI-ERROR
  9364         GO TO 1460-CERT-NO-ERROR.
  9365
  9366     IF WS-CERT-NO-PRIME = SPACES AND
  9367        WS-CERT-NO-SUFX GREATER THAN SPACE
  9368            MOVE ER-0210         TO EMI-ERROR
  9369            GO TO 1460-CERT-NO-ERROR.
  9370
  9371     MOVE 'X'                    TO UPDATE-SWITCH.
  9372     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9373     MOVE AL-UANON               TO CERTA.
  9374
  9375     IF SUFXL IS GREATER THAN 0
  9376         MOVE AL-UANON           TO SUFXA.
  9377
  9378     GO TO 1460-EXIT.
  9379
  9380 1460-CERT-NO-ERROR.
  9381     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9382     MOVE AL-UABON               TO SUFXA.
  9383     MOVE AL-UABON               TO CERTA.
  9384     MOVE -1                     TO CERTL.
  9385     MOVE 'X'                    TO ERROR-SWITCH.
  9386
  9387 1460-EXIT.
  9388     EXIT.
  9389
  9390 1470-EDIT-EFF.
  9391     IF CERTEFFI = SPACES
  9392         GO TO 1470-DATE-ERROR.
  9393
  9394     MOVE CERTEFFI               TO DEEDIT-DATE-INPUT.
  9395     PERFORM 1510-DEEDIT-DATE THRU 1510-EXIT.
  9396     IF DEEDIT-DATE = ZERO
  9397         GO TO 1470-DATE-ERROR.
  9398
  9399     MOVE DEEDIT-DATE            TO DC-GREG-DATE-1-MDY.
  9400     MOVE '4'                    TO DC-OPTION-CODE.
  9401     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
  9402     IF NOT DATE-CONVERSION-ERROR
  9403         MOVE DC-BIN-DATE-1      TO HOLD-EFF
  9404         MOVE AL-UANON           TO CERTEFFA
  9405         MOVE 'X'                TO UPDATE-SWITCH
  9406         MOVE 'Y'                TO CERT-KEY-SWITCH
  9407         MOVE DC-GREG-DATE-1-EDIT TO CERTEFFO
  9408         GO TO 1470-EXIT.
  9409
  9410 1470-DATE-ERROR.
  9411     MOVE ER-0215                TO EMI-ERROR.
  9412     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9413     MOVE AL-UABON               TO CERTEFFA.
  9414     MOVE -1                     TO CERTEFFL.
  9415     MOVE 'X'                    TO ERROR-SWITCH.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 171
* EL131.cbl
  9416
  9417 1470-EXIT.
  9418     EXIT.
  9419
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 172
* EL131.cbl
  9421 1480-EDIT-ACCT.
  9422     IF CERTACTI = SPACES
  9423         MOVE ER-0232            TO EMI-ERROR
  9424         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9425         MOVE AL-UABON           TO CERTACTA
  9426         MOVE -1                 TO CERTACTL
  9427         MOVE 'X'                TO ERROR-SWITCH
  9428     ELSE
  9429         MOVE 'X'                TO UPDATE-SWITCH
  9430         MOVE 'Y'                TO CERT-KEY-SWITCH.
  9431
  9432 1480-EXIT.
  9433     EXIT.
  9434
  9435 1490-EDIT-STATE.
  9436     IF CERTSTI = SPACES
  9437         MOVE ER-0233            TO EMI-ERROR
  9438         GO TO 1490-STATE-ERROR.
  9439
  9440     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9441     MOVE '3'                    TO CNTL-REC-TYPE.
  9442     MOVE SPACES                 TO CNTL-STATE-ACCESS.
  9443     MOVE CERTSTI                TO CNTL-STATE-NUMBER.
  9444     MOVE ZERO                   TO CNTL-SEQ-NO.
  9445
  9446
  9447* EXEC CICS HANDLE CONDITION
  9448*         NOTFND (1490-STATE-NOTFND)
  9449*    END-EXEC.
  9450*    MOVE '"$I                   ! ( #00008921' TO DFHEIV0
  9451     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9453     MOVE X'2820233030303038393231' TO DFHEIV0(25:11)
  9454     CALL 'kxdfhei1' USING DFHEIV0
  9455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9456
  9457
  9458
  9459* EXEC CICS READ
  9460*         SET        (ADDRESS OF CONTROL-FILE)
  9461*         DATASET    ('ELCNTL')
  9462*         RIDFLD     (CNTL-KEY)
  9463*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9464*         GENERIC
  9465*    END-EXEC.
  9466     MOVE 'ELCNTL' TO DFHEIV1
  9467*    MOVE '&"S  KG    E          (   #00008925' TO DFHEIV0
  9468     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9469     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9470     MOVE X'2020233030303038393235' TO DFHEIV0(25:11)
  9471     CALL 'kxdfhei1' USING DFHEIV0,
  9472           DFHEIV1,
  9473           DFHEIV20,
  9474           DFHEIV99,
  9475           CNTL-KEY,
  9476           CNTL-GENERIC-LENGTH,
  9477           DFHEIV99,
  9478           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 173
* EL131.cbl
  9479     SET ADDRESS OF CONTROL-FILE TO
  9480         DFHEIV20
  9481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9482
  9483
  9484     MOVE AL-UANON               TO CERTSTA.
  9485     MOVE 'X'                    TO UPDATE-SWITCH.
  9486     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9487     GO TO 1490-EXIT.
  9488
  9489 1490-STATE-NOTFND.
  9490     MOVE ER-0149                TO EMI-ERROR.
  9491
  9492 1490-STATE-ERROR.
  9493     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9494     MOVE AL-UABON               TO CERTSTA.
  9495     MOVE -1                     TO CERTSTL.
  9496     MOVE 'X'                    TO ERROR-SWITCH.
  9497
  9498 1490-EXIT.
  9499     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 174
* EL131.cbl
  9501 1500-EDIT-CARR.
  9502     IF CERTCARI = SPACES
  9503         GO TO 1500-CARR-NOTFND.
  9504
  9505     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
  9506     MOVE '6'                    TO CNTL-REC-TYPE.
  9507     MOVE SPACES                 TO CNTL-CARRIER-ACCESS.
  9508     MOVE CERTCARI               TO CNTL-CARRIER.
  9509     MOVE ZERO                   TO CNTL-SEQ-NO.
  9510
  9511
  9512* EXEC CICS HANDLE CONDITION
  9513*         NOTFND   (1500-CARR-NOTFND)
  9514*    END-EXEC.
  9515*    MOVE '"$I                   ! ) #00008960' TO DFHEIV0
  9516     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9517     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9518     MOVE X'2920233030303038393630' TO DFHEIV0(25:11)
  9519     CALL 'kxdfhei1' USING DFHEIV0
  9520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9521
  9522
  9523
  9524* EXEC CICS READ
  9525*         SET        (ADDRESS OF CONTROL-FILE)
  9526*         DATASET    ('ELCNTL')
  9527*         RIDFLD     (CNTL-KEY)
  9528*         KEYLENGTH  (CNTL-GENERIC-LENGTH)
  9529*         GENERIC
  9530*    END-EXEC.
  9531     MOVE 'ELCNTL' TO DFHEIV1
  9532*    MOVE '&"S  KG    E          (   #00008964' TO DFHEIV0
  9533     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  9534     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9535     MOVE X'2020233030303038393634' TO DFHEIV0(25:11)
  9536     CALL 'kxdfhei1' USING DFHEIV0,
  9537           DFHEIV1,
  9538           DFHEIV20,
  9539           DFHEIV99,
  9540           CNTL-KEY,
  9541           CNTL-GENERIC-LENGTH,
  9542           DFHEIV99,
  9543           DFHEIV99
  9544     SET ADDRESS OF CONTROL-FILE TO
  9545         DFHEIV20
  9546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9547
  9548
  9549     MOVE AL-UANON               TO CERTCARA.
  9550     MOVE 'X'                    TO UPDATE-SWITCH.
  9551     MOVE 'Y'                    TO CERT-KEY-SWITCH.
  9552     GO TO 1500-EXIT.
  9553
  9554 1500-CARR-NOTFND.
  9555     MOVE ER-0360                TO EMI-ERROR.
  9556     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9557     MOVE AL-UABON               TO CERTCARA.
  9558     MOVE -1                     TO CERTCARL.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 175
* EL131.cbl
  9559     MOVE 'X'                    TO ERROR-SWITCH.
  9560
  9561 1500-EXIT.
  9562     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 176
* EL131.cbl
  9564 1510-DEEDIT-DATE.
  9565
  9566* EXEC CICS BIF DEEDIT
  9567*         FIELD    (DEEDIT-DATE-INPUT)
  9568*         LENGTH   (DATE-LENGTH)
  9569*    END-EXEC.
  9570*    MOVE '@"L                   #   #00008988' TO DFHEIV0
  9571     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9572     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9573     MOVE X'2020233030303038393838' TO DFHEIV0(25:11)
  9574     CALL 'kxdfhei1' USING DFHEIV0,
  9575           DEEDIT-DATE-INPUT,
  9576           DATE-LENGTH
  9577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9578
  9579
  9580 1510-EXIT.
  9581     EXIT.
  9582
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 177
* EL131.cbl
  9584 1620-VERIFY-ACCT.
  9585
  9586     MOVE PI-COMPANY-CD          TO ACCT-COMPANY-CODE.
  9587     MOVE PI-CARRIER             TO ACCT-CARRIER.
  9588     MOVE PI-GROUPING            TO ACCT-GROUP.
  9589     MOVE PI-STATE               TO ACCT-STATE.
  9590     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
  9591
  9592     IF CERTEFFI GREATER THAN LOW-VALUES
  9593         MOVE HOLD-EFF           TO ACCT-DATE
  9594     ELSE
  9595         MOVE PI-CERT-EFF-DT     TO HOLD-EFF ACCT-DATE.
  9596
  9597     IF CERTACTI GREATER THAN LOW-VALUES
  9598         MOVE CERTACTI           TO  ACCT-ACCOUNT.
  9599     IF CERTSTI GREATER THAN LOW-VALUES
  9600         MOVE CERTSTI            TO  ACCT-STATE.
  9601     IF CERTCARI GREATER THAN LOW-VALUES
  9602         MOVE CERTCARI           TO  ACCT-CARRIER.
  9603     IF CERTGRPI GREATER THAN LOW-VALUES
  9604         MOVE CERTGRPI           TO ACCT-GROUP.
  9605
  9606     MOVE ACCT-PARTIAL-KEY       TO SAVE-ACCT-KEY.
  9607
  9608
  9609* EXEC CICS HANDLE CONDITION
  9610*         NOTFND  (1620-ACCT-NOTFND)
  9611*    END-EXEC.
  9612*    MOVE '"$I                   ! * #00009021' TO DFHEIV0
  9613     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9614     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9615     MOVE X'2A20233030303039303231' TO DFHEIV0(25:11)
  9616     CALL 'kxdfhei1' USING DFHEIV0
  9617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9618
  9619
  9620
  9621* EXEC CICS STARTBR
  9622*         DATASET   (ACCT-FILE-ID)
  9623*         RIDFLD    (ACCT-KEY)
  9624*    END-EXEC.
  9625     MOVE 0
  9626       TO DFHEIV11
  9627*    MOVE '&,         G          &   #00009025' TO DFHEIV0
  9628     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9629     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9630     MOVE X'2020233030303039303235' TO DFHEIV0(25:11)
  9631     CALL 'kxdfhei1' USING DFHEIV0,
  9632           ACCT-FILE-ID,
  9633           ACCT-KEY,
  9634           DFHEIV99,
  9635           DFHEIV11,
  9636           DFHEIV99
  9637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9638
  9639
  9640 1620-ACCT-LOOP.
  9641
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 178
* EL131.cbl
  9642
  9643* EXEC CICS READNEXT
  9644*         DATASET  (ACCT-FILE-ID)
  9645*         RIDFLD   (ACCT-KEY)
  9646*         SET      (ADDRESS OF ACCOUNT-MASTER)
  9647*    END-EXEC.
  9648     MOVE 0
  9649       TO DFHEIV11
  9650*    MOVE '&.S                   )   #00009032' TO DFHEIV0
  9651     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9652     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9653     MOVE X'2020233030303039303332' TO DFHEIV0(25:11)
  9654     CALL 'kxdfhei1' USING DFHEIV0,
  9655           ACCT-FILE-ID,
  9656           DFHEIV20,
  9657           DFHEIV99,
  9658           ACCT-KEY,
  9659           DFHEIV99,
  9660           DFHEIV11,
  9661           DFHEIV99,
  9662           DFHEIV99
  9663     SET ADDRESS OF ACCOUNT-MASTER TO
  9664         DFHEIV20
  9665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9666
  9667
  9668     IF SAVE-ACCT-KEY NOT = ACCT-PARTIAL-KEY
  9669         GO TO 1620-ACCT-NOTFND.
  9670
  9671     IF HOLD-EFF NOT LESS AM-EFFECTIVE-DT  AND
  9672        HOLD-EFF     LESS AM-EXPIRATION-DT
  9673         NEXT SENTENCE
  9674     ELSE
  9675         GO TO 1620-ACCT-LOOP.
  9676
  9677     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
  9678         GO TO 1620-ACCT-END-BROWSE.
  9679
  9680     IF LOANBALL GREATER THAN +0
  9681         IF AM-MAX-TOT-BEN NUMERIC  AND
  9682            AM-MAX-TOT-BEN GREATER THAN ZERO
  9683             IF HOLD-LOANBAL GREATER THAN AM-MAX-TOT-BEN
  9684                 MOVE AL-UNBON     TO LOANBALA
  9685                 MOVE -1           TO LOANBALL
  9686                 MOVE 'X'          TO ERROR-SWITCH
  9687                 MOVE ER-7641      TO EMI-ERROR
  9688                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9689
  9690     IF ACVBENEL GREATER THAN +0
  9691         IF AM-MAX-MON-BEN NUMERIC  AND
  9692            AM-MAX-MON-BEN GREATER THAN ZERO
  9693             IF HOLD-AH-CV-BEN GREATER THAN AM-MAX-MON-BEN
  9694                 MOVE AL-UNBON     TO ACVBENEA
  9695                 MOVE -1           TO ACVBENEL
  9696                 MOVE 'X'          TO ERROR-SWITCH
  9697                 MOVE ER-7642      TO EMI-ERROR
  9698                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9699
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 179
* EL131.cbl
  9700 1620-ACCT-END-BROWSE.
  9701
  9702
  9703* EXEC CICS ENDBR
  9704*         DATASET (ACCT-FILE-ID)
  9705*    END-EXEC.
  9706     MOVE 0
  9707       TO DFHEIV11
  9708*    MOVE '&2                    $   #00009072' TO DFHEIV0
  9709     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9710     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9711     MOVE X'2020233030303039303732' TO DFHEIV0(25:11)
  9712     CALL 'kxdfhei1' USING DFHEIV0,
  9713           ACCT-FILE-ID,
  9714           DFHEIV11,
  9715           DFHEIV99
  9716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9717
  9718
  9719     GO TO 1620-EXIT.
  9720
  9721 1620-ACCT-NOTFND.
  9722
  9723     MOVE -1                     TO MAINTL.
  9724     MOVE 'X'                    TO ERROR-SWITCH.
  9725     MOVE ER-0426                TO EMI-ERROR.
  9726     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9727
  9728 1620-EXIT.
  9729     EXIT.
  9730
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 180
* EL131.cbl
  9732 2000-UPDATE-CLAIM.
  9733
  9734     MOVE SPACES                 TO ERROR-SWITCH.
  9735     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
  9736     MOVE PI-CARRIER             TO CARRIER-CODE.
  9737     MOVE PI-CLAIM-NO            TO CLAIM-NO.
  9738     MOVE PI-CERT-NO             TO CERT-NO.
  9739
  9740     IF DELETE-CLAIM
  9741         GO TO 3000-DELETE-CLAIM.
  9742
  9743     IF  NOT MODIFY-CAP
  9744         MOVE ER-0070            TO EMI-ERROR
  9745         MOVE 'X'                TO ERROR-SWITCH
  9746         MOVE -1                 TO MAINTL
  9747         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9748         GO TO 2000-EXIT.
  9749
  9750     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
  9751     MOVE ZERO                   TO TRLR-SEQ-NO.
  9752
  9753
  9754* EXEC CICS READ UPDATE
  9755*         SET       (ADDRESS OF CLAIM-MASTER)
  9756*         DATASET   (CLMS-FILE-ID)
  9757*         RIDFLD    (MSTR-KEY)
  9758*    END-EXEC.
  9759*    MOVE '&"S        EU         (   #00009110' TO DFHEIV0
  9760     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9761     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9762     MOVE X'2020233030303039313130' TO DFHEIV0(25:11)
  9763     CALL 'kxdfhei1' USING DFHEIV0,
  9764           CLMS-FILE-ID,
  9765           DFHEIV20,
  9766           DFHEIV99,
  9767           MSTR-KEY,
  9768           DFHEIV99,
  9769           DFHEIV99,
  9770           DFHEIV99
  9771     SET ADDRESS OF CLAIM-MASTER TO
  9772         DFHEIV20
  9773     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9774
  9775
  9776     IF (CL-PRIORITY-CD = '8')
  9777        AND (PI-PROCESSOR-ID NOT = 'PEMA' AND 'JMS '
  9778             AND 'AMWA' AND 'KMSB')
  9779        MOVE ER-8003             TO EMI-ERROR
  9780        PERFORM 9900-ERROR-FORMAT
  9781                                 THRU 9900-EXIT
  9782        MOVE -1                  TO MAINTL
  9783        GO TO 8110-SEND-DATA
  9784     END-IF
  9785
  9786     IF PI-UPDATE-BY NOT = CL-LAST-MAINT-USER
  9787         MOVE ER-0068            TO EMI-ERROR
  9788         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9789         GO TO 2000-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 181
* EL131.cbl
  9790
  9791     IF PI-UPDATE-HHMMSS NOT = CL-LAST-MAINT-HHMMSS
  9792         MOVE ER-0068            TO EMI-ERROR
  9793         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9794         GO TO 2000-EXIT.
  9795
  9796     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  9797         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS.
  9798
  9799     IF CL-PURGED-DT NOT = LOW-VALUES
  9800         MOVE ER-7691            TO EMI-ERROR
  9801         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9802         GO TO 2000-EXIT.
  9803
  9804     IF CERT-KEY-CHANGED
  9805         PERFORM 2060-CHANGE-CERT THRU 2060-EXIT.
  9806
  9807     IF SCREEN-ERROR
  9808         MOVE ER-0068            TO EMI-ERROR
  9809         PERFORM 2010-RELEASE-REC THRU 2010-EXIT
  9810         GO TO 2000-EXIT.
  9811
  9812     IF NINETY-TRLR-UPDATED
  9813         PERFORM 2425-UPDATE-NINETY-TRLR THRU 2425-EXIT.
  9814
  9815     IF MSTR-KEY-CHANGED
  9816         PERFORM 2030-KEY-UPDATE THRU 2030-EXIT
  9817        ELSE
  9818         PERFORM 2020-NORMAL-UPDATE THRU 2020-EXIT.
  9819
  9820     IF TRLR-UPDATE-REQUIRED
  9821         PERFORM 2300-UPDATE-TRLR THRU 2300-EXIT.
  9822
  9823 2000-CHECK-CERT.
  9824     IF NOT CERT-UPDATES
  9825         GO TO 2000-EXIT.
  9826
  9827     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
  9828     MOVE PI-CARRIER             TO CERT-CARRIER.
  9829     MOVE PI-GROUPING            TO CERT-GROUP.
  9830     MOVE PI-STATE               TO CERT-STATE.
  9831     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
  9832     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
  9833     MOVE PI-CERT-NO             TO CERT-CERT.
  9834
  9835     IF CERT-ALT-KEY-CHANGED
  9836         PERFORM 2050-KEY-UPDATE THRU 2050-EXIT
  9837     ELSE
  9838         PERFORM 2040-NORMAL-UPDATE THRU 2040-EXIT.
  9839
  9840 2000-EXIT.
  9841     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 182
* EL131.cbl
  9843 2010-RELEASE-REC.
  9844
  9845* EXEC CICS UNLOCK
  9846*         DATASET  (CLMS-FILE-ID)
  9847*    END-EXEC
  9848*    MOVE '&*                    #   #00009184' TO DFHEIV0
  9849     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9850     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9851     MOVE X'2020233030303039313834' TO DFHEIV0(25:11)
  9852     CALL 'kxdfhei1' USING DFHEIV0,
  9853           CLMS-FILE-ID,
  9854           DFHEIV99
  9855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9856
  9857     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9858     MOVE 'X'                    TO ERROR-SWITCH.
  9859
  9860 2010-EXIT.
  9861     EXIT.
  9862
  9863 2020-NORMAL-UPDATE.
  9864     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9865
  9866     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9867
  9868     IF WS-OPEN-CLOSE-SW = 'Y'
  9869       PERFORM  7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9870       IF PI-REC-FOUND-SW = 'Y'
  9871         IF CL-ACTIVITY-CODE = 09
  9872           NEXT SENTENCE
  9873         ELSE
  9874           IF WS-RESET-SW = 'Y'
  9875             IF CL-CLAIM-STATUS = 'C'
  9876               MOVE 07               TO  CL-ACTIVITY-CODE
  9877               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9878               MOVE 'CLOS'           TO  CL-ACTIVITY-MAINT-TYPE
  9879             ELSE
  9880               MOVE 08               TO  CL-ACTIVITY-CODE
  9881               MOVE SAVE-BIN-DATE    TO  CL-ACTIVITY-MAINT-DT
  9882               MOVE 'OPEN'           TO  CL-ACTIVITY-MAINT-TYPE.
  9883
  9884     IF PI-COMPANY-ID = 'CID' or 'AHL'
  9885         MOVE 'Y'                TO CL-YESNOSW
  9886     END-IF.
  9887
  9888     if pi-company-id = 'DCC'
  9889        perform 1620-VERIFY-ACCT THRU 1620-EXIT
  9890        perform 2120-check-pdef  thru 2120-exit
  9891     end-if
  9892
  9893* EXEC CICS HANDLE CONDITION
  9894*         DUPKEY   (2020-EXIT)
  9895*    END-EXEC.
  9896*    MOVE '"$$                   ! + #00009223' TO DFHEIV0
  9897     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9898     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9899     MOVE X'2B20233030303039323233' TO DFHEIV0(25:11)
  9900     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 183
* EL131.cbl
  9901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9902
  9903
  9904
  9905* EXEC CICS REWRITE
  9906*         DATASET   (CLMS-FILE-ID)
  9907*         FROM      (CLAIM-MASTER)
  9908*    END-EXEC.
  9909     MOVE LENGTH OF
  9910      CLAIM-MASTER
  9911       TO DFHEIV11
  9912*    MOVE '&& L                  %   #00009227' TO DFHEIV0
  9913     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9914     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9915     MOVE X'2020233030303039323237' TO DFHEIV0(25:11)
  9916     CALL 'kxdfhei1' USING DFHEIV0,
  9917           CLMS-FILE-ID,
  9918           CLAIM-MASTER,
  9919           DFHEIV11,
  9920           DFHEIV99
  9921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9922
  9923
  9924 2020-EXIT.
  9925     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 184
* EL131.cbl
  9927 2030-KEY-UPDATE.
  9928     MOVE CLAIM-MASTER           TO JP-RECORD-AREA.
  9929
  9930
  9931* EXEC CICS DELETE
  9932*        DATASET  (CLMS-FILE-ID)
  9933*    END-EXEC.
  9934*    MOVE '&(                    &   #00009238' TO DFHEIV0
  9935     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  9936     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9937     MOVE X'2020233030303039323338' TO DFHEIV0(25:11)
  9938     CALL 'kxdfhei1' USING DFHEIV0,
  9939           CLMS-FILE-ID,
  9940           DFHEIV99,
  9941           DFHEIV99,
  9942           DFHEIV99,
  9943           DFHEIV99
  9944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9945
  9946
  9947
  9948* EXEC CICS GETMAIN
  9949*         SET      (ADDRESS OF CLAIM-MASTER)
  9950*         LENGTH   (MSTR-LENGTH)
  9951*         INITIMG  (GETMAIN-SPACE)
  9952*    END-EXEC.
  9953*    MOVE ',"IL                  $   #00009242' TO DFHEIV0
  9954     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9955     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9956     MOVE X'2020233030303039323432' TO DFHEIV0(25:11)
  9957     CALL 'kxdfhei1' USING DFHEIV0,
  9958           DFHEIV20,
  9959           MSTR-LENGTH,
  9960           GETMAIN-SPACE
  9961     SET ADDRESS OF CLAIM-MASTER TO
  9962         DFHEIV20
  9963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9964
  9965
  9966     MOVE JP-RECORD-AREA         TO CLAIM-MASTER.
  9967
  9968     PERFORM 2600-CREATE-MAINT-NOTE THRU 2600-EXIT.
  9969
  9970     PERFORM 2100-MOVE-MSTR THRU 2100-EXIT.
  9971
  9972     IF WS-OPEN-CLOSE-SW = 'Y'
  9973       PERFORM 7800-CHECK-AUTO-ACTIVITY THRU 7800-EXIT
  9974         IF PI-REC-FOUND-SW = 'Y'
  9975           IF CL-ACTIVITY-CODE = 09
  9976             NEXT SENTENCE
  9977           ELSE
  9978             IF WS-RESET-SW = 'Y'
  9979               IF CL-CLAIM-STATUS = 'C'
  9980                 MOVE 07             TO  CL-ACTIVITY-CODE
  9981                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
  9982                 MOVE 'CLOS'         TO  CL-ACTIVITY-MAINT-TYPE
  9983               ELSE
  9984                 MOVE 08             TO  CL-ACTIVITY-CODE
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 185
* EL131.cbl
  9985                 MOVE SAVE-BIN-DATE  TO  CL-ACTIVITY-MAINT-DT
  9986                 MOVE 'OPEN'         TO  CL-ACTIVITY-MAINT-TYPE.
  9987
  9988
  9989* EXEC CICS HANDLE CONDITION
  9990*         DUPKEY    (2030-EXIT)
  9991*    END-EXEC.
  9992*    MOVE '"$$                   ! , #00009270' TO DFHEIV0
  9993     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  9994     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9995     MOVE X'2C20233030303039323730' TO DFHEIV0(25:11)
  9996     CALL 'kxdfhei1' USING DFHEIV0
  9997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9998
  9999
 10000** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10001*    MOVE CL-CERT-NO             TO CL-CCN-A5.
 10002
 10003     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 10004         MOVE 'Y'                TO CL-YESNOSW
 10005     END-IF.
 10006
 10007
 10008* EXEC CICS WRITE
 10009*         DATASET   (CLMS-FILE-ID)
 10010*         RIDFLD    (MSTR-KEY)
 10011*         FROM      (CLAIM-MASTER)
 10012*    END-EXEC.
 10013     MOVE LENGTH OF
 10014      CLAIM-MASTER
 10015       TO DFHEIV11
 10016*    MOVE '&$ L                  ''   #00009281' TO DFHEIV0
 10017     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10018     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10019     MOVE X'2020233030303039323831' TO DFHEIV0(25:11)
 10020     CALL 'kxdfhei1' USING DFHEIV0,
 10021           CLMS-FILE-ID,
 10022           CLAIM-MASTER,
 10023           DFHEIV11,
 10024           MSTR-KEY,
 10025           DFHEIV99,
 10026           DFHEIV99
 10027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10028
 10029
 10030 2030-EXIT.
 10031     EXIT.
 10032
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 186
* EL131.cbl
 10034 2040-NORMAL-UPDATE.
 10035
 10036* EXEC CICS READ UPDATE
 10037*         DATASET  (CERT-FILE-ID)
 10038*         RIDFLD   (CERT-KEY)
 10039*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10040*    END-EXEC.
 10041*    MOVE '&"S        EU         (   #00009292' TO DFHEIV0
 10042     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10043     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10044     MOVE X'2020233030303039323932' TO DFHEIV0(25:11)
 10045     CALL 'kxdfhei1' USING DFHEIV0,
 10046           CERT-FILE-ID,
 10047           DFHEIV20,
 10048           DFHEIV99,
 10049           CERT-KEY,
 10050           DFHEIV99,
 10051           DFHEIV99,
 10052           DFHEIV99
 10053     SET ADDRESS OF CERTIFICATE-MASTER TO
 10054         DFHEIV20
 10055     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10056
 10057
 10058     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10059
 10060
 10061* EXEC CICS HANDLE CONDITION
 10062*         DUPKEY   (2040-EXIT)
 10063*    END-EXEC.
 10064*    MOVE '"$$                   ! - #00009300' TO DFHEIV0
 10065     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10066     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10067     MOVE X'2D20233030303039333030' TO DFHEIV0(25:11)
 10068     CALL 'kxdfhei1' USING DFHEIV0
 10069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10070
 10071
 10072
 10073* EXEC CICS REWRITE
 10074*         DATASET  (CERT-FILE-ID)
 10075*         FROM     (CERTIFICATE-MASTER)
 10076*    END-EXEC.
 10077     MOVE LENGTH OF
 10078      CERTIFICATE-MASTER
 10079       TO DFHEIV11
 10080*    MOVE '&& L                  %   #00009304' TO DFHEIV0
 10081     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10082     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10083     MOVE X'2020233030303039333034' TO DFHEIV0(25:11)
 10084     CALL 'kxdfhei1' USING DFHEIV0,
 10085           CERT-FILE-ID,
 10086           CERTIFICATE-MASTER,
 10087           DFHEIV11,
 10088           DFHEIV99
 10089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10090
 10091
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 187
* EL131.cbl
 10092 2040-EXIT.
 10093     EXIT.
 10094
 10095 2050-KEY-UPDATE.
 10096
 10097* EXEC CICS READ UPDATE
 10098*         DATASET  (CERT-FILE-ID)
 10099*         RIDFLD   (CERT-KEY)
 10100*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10101*    END-EXEC.
 10102*    MOVE '&"S        EU         (   #00009313' TO DFHEIV0
 10103     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10104     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10105     MOVE X'2020233030303039333133' TO DFHEIV0(25:11)
 10106     CALL 'kxdfhei1' USING DFHEIV0,
 10107           CERT-FILE-ID,
 10108           DFHEIV20,
 10109           DFHEIV99,
 10110           CERT-KEY,
 10111           DFHEIV99,
 10112           DFHEIV99,
 10113           DFHEIV99
 10114     SET ADDRESS OF CERTIFICATE-MASTER TO
 10115         DFHEIV20
 10116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10117
 10118
 10119     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 10120
 10121
 10122* EXEC CICS DELETE
 10123*         DATASET   (CERT-FILE-ID)
 10124*    END-EXEC.
 10125*    MOVE '&(                    &   #00009321' TO DFHEIV0
 10126     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10127     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10128     MOVE X'2020233030303039333231' TO DFHEIV0(25:11)
 10129     CALL 'kxdfhei1' USING DFHEIV0,
 10130           CERT-FILE-ID,
 10131           DFHEIV99,
 10132           DFHEIV99,
 10133           DFHEIV99,
 10134           DFHEIV99
 10135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10136
 10137
 10138
 10139* EXEC CICS GETMAIN
 10140*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10141*         LENGTH    (CERT-LENGTH)
 10142*         INITIMG   (GETMAIN-SPACE)
 10143*    END-EXEC.
 10144*    MOVE ',"IL                  $   #00009325' TO DFHEIV0
 10145     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10146     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10147     MOVE X'2020233030303039333235' TO DFHEIV0(25:11)
 10148     CALL 'kxdfhei1' USING DFHEIV0,
 10149           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 188
* EL131.cbl
 10150           CERT-LENGTH,
 10151           GETMAIN-SPACE
 10152     SET ADDRESS OF CERTIFICATE-MASTER TO
 10153         DFHEIV20
 10154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10155
 10156
 10157     MOVE JP-RECORD-AREA         TO CERTIFICATE-MASTER.
 10158
 10159     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10160
 10161
 10162* EXEC CICS HANDLE CONDITION
 10163*         DUPKEY (2050-EXIT)
 10164*    END-EXEC.
 10165*    MOVE '"$$                   ! . #00009335' TO DFHEIV0
 10166     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10167     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10168     MOVE X'2E20233030303039333335' TO DFHEIV0(25:11)
 10169     CALL 'kxdfhei1' USING DFHEIV0
 10170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10171
 10172
 10173
 10174* EXEC CICS WRITE
 10175*         DATASET  (CERT-FILE-ID)
 10176*         RIDFLD   (CERT-KEY)
 10177*         FROM     (CERTIFICATE-MASTER)
 10178*    END-EXEC.
 10179     MOVE LENGTH OF
 10180      CERTIFICATE-MASTER
 10181       TO DFHEIV11
 10182*    MOVE '&$ L                  ''   #00009339' TO DFHEIV0
 10183     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10184     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10185     MOVE X'2020233030303039333339' TO DFHEIV0(25:11)
 10186     CALL 'kxdfhei1' USING DFHEIV0,
 10187           CERT-FILE-ID,
 10188           CERTIFICATE-MASTER,
 10189           DFHEIV11,
 10190           CERT-KEY,
 10191           DFHEIV99,
 10192           DFHEIV99
 10193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10194
 10195
 10196 2050-EXIT.
 10197     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 189
* EL131.cbl
 10199 2060-CHANGE-CERT.
 10200     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10201     MOVE PI-CARRIER             TO CERT-CARRIER.
 10202     MOVE PI-GROUPING            TO CERT-GROUP.
 10203     MOVE PI-STATE               TO CERT-STATE.
 10204     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10205     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10206     MOVE PI-CERT-NO             TO CERT-CERT.
 10207     IF CERTEFFI GREATER THAN LOW-VALUES
 10208         MOVE HOLD-EFF           TO CERT-DATE.
 10209     IF CERTACTI GREATER THAN LOW-VALUES
 10210         MOVE CERTACTI           TO CERT-ACCOUNT.
 10211     IF CERTSTI GREATER THAN LOW-VALUES
 10212         MOVE CERTSTI            TO CERT-STATE.
 10213     IF CERTCARI GREATER THAN LOW-VALUES
 10214         MOVE CERTCARI           TO CERT-CARRIER.
 10215     IF CERTGRPI GREATER THAN LOW-VALUES
 10216         MOVE CERTGRPI           TO CERT-GROUP.
 10217     IF CERTI GREATER THAN LOW-VALUES
 10218         MOVE CERTI              TO CERT-CERT-PRIME.
 10219     IF SUFXI GREATER THAN LOW-VALUES
 10220         MOVE SUFXI              TO CERT-CERT-SUFX.
 10221
 10222
 10223* EXEC CICS HANDLE CONDITION
 10224*         NOTFND   (2060-CERT-NOTFND)
 10225*    END-EXEC.
 10226*    MOVE '"$I                   ! / #00009371' TO DFHEIV0
 10227     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10228     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10229     MOVE X'2F20233030303039333731' TO DFHEIV0(25:11)
 10230     CALL 'kxdfhei1' USING DFHEIV0
 10231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10232
 10233
 10234
 10235* EXEC CICS READ UPDATE
 10236*         DATASET  (CERT-FILE-ID)
 10237*         RIDFLD   (CERT-KEY)
 10238*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10239*    END-EXEC.
 10240*    MOVE '&"S        EU         (   #00009375' TO DFHEIV0
 10241     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10242     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10243     MOVE X'2020233030303039333735' TO DFHEIV0(25:11)
 10244     CALL 'kxdfhei1' USING DFHEIV0,
 10245           CERT-FILE-ID,
 10246           DFHEIV20,
 10247           DFHEIV99,
 10248           CERT-KEY,
 10249           DFHEIV99,
 10250           DFHEIV99,
 10251           DFHEIV99
 10252     SET ADDRESS OF CERTIFICATE-MASTER TO
 10253         DFHEIV20
 10254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10255
 10256
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 190
* EL131.cbl
 10257     ADD 1                       TO CM-CLAIM-ATTACHED-COUNT.
 10258
 10259     IF CM-CLAIM-INTERFACE-SW = SPACES
 10260        MOVE '1'   TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10261
 10262
 10263* EXEC CICS HANDLE CONDITION
 10264*         DUPKEY   (2060-DUPKEY)
 10265*    END-EXEC.
 10266*    MOVE '"$$                   ! 0 #00009386' TO DFHEIV0
 10267     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10268     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10269     MOVE X'3020233030303039333836' TO DFHEIV0(25:11)
 10270     CALL 'kxdfhei1' USING DFHEIV0
 10271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10272
 10273
 10274
 10275* EXEC CICS REWRITE
 10276*         DATASET  (CERT-FILE-ID)
 10277*         FROM     (CERTIFICATE-MASTER)
 10278*    END-EXEC.
 10279     MOVE LENGTH OF
 10280      CERTIFICATE-MASTER
 10281       TO DFHEIV11
 10282*    MOVE '&& L                  %   #00009390' TO DFHEIV0
 10283     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10284     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10285     MOVE X'2020233030303039333930' TO DFHEIV0(25:11)
 10286     CALL 'kxdfhei1' USING DFHEIV0,
 10287           CERT-FILE-ID,
 10288           CERTIFICATE-MASTER,
 10289           DFHEIV11,
 10290           DFHEIV99
 10291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10292
 10293
 10294 2060-DUPKEY.
 10295
 10296     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10297
 10298 2060-CHANGE-TRLR-ACTQ.
 10299     IF SCREEN-ERROR
 10300         GO TO 2060-EXIT.
 10301
 10302     IF CERTI    GREATER LOW-VALUES OR
 10303        SUFXI    GREATER LOW-VALUES OR
 10304        CERTCARI GREATER LOW-VALUES
 10305         PERFORM 2400-UPDATE-TRLR THRU 2400-EXIT
 10306         PERFORM 2430-UPDATE-ACTQ THRU 2430-EXIT.
 10307
 10308     MOVE SPACES                 TO CERT-KEY-SWITCH
 10309                                    CERT-SWITCH
 10310                                    TRLR-SWITCH
 10311                                    NINETY-TRLR-SWITCH.
 10312     MOVE 'X' TO MSTR-KEY-SWITCH MSTR-SWITCH.
 10313     GO TO 2060-EXIT.
 10314
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 191
* EL131.cbl
 10315 2060-CERT-NOTFND.
 10316     PERFORM 2070-CHECK-OLD THRU 2070-EXIT.
 10317
 10318     IF WS-REC-FOUND-SW = 'N'
 10319         MOVE ER-0206            TO  EMI-ERROR
 10320         MOVE -1                 TO  MAINTL
 10321         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10322
 10323* EXEC CICS UNLOCK
 10324*            DATASET   (CLMS-FILE-ID)
 10325*        END-EXEC
 10326*    MOVE '&*                    #   #00009423' TO DFHEIV0
 10327     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10328     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10329     MOVE X'2020233030303039343233' TO DFHEIV0(25:11)
 10330     CALL 'kxdfhei1' USING DFHEIV0,
 10331           CLMS-FILE-ID,
 10332           DFHEIV99
 10333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10334         GO TO 8110-SEND-DATA.
 10335
 10336     PERFORM 2080-CREATE-CERT THRU 2080-EXIT.
 10337
 10338     GO TO 2060-CHANGE-TRLR-ACTQ.
 10339
 10340 2060-EXIT.
 10341     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 192
* EL131.cbl
 10343 2070-CHECK-OLD.
 10344
 10345
 10346* EXEC CICS HANDLE CONDITION
 10347*        NOTFND   (2070-NOT-FOUND)
 10348*    END-EXEC.
 10349*    MOVE '"$I                   ! 1 #00009437' TO DFHEIV0
 10350     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10351     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10352     MOVE X'3120233030303039343337' TO DFHEIV0(25:11)
 10353     CALL 'kxdfhei1' USING DFHEIV0
 10354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10355
 10356
 10357     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 10358     MOVE PI-CARRIER             TO CERT-CARRIER.
 10359     MOVE PI-GROUPING            TO CERT-GROUP.
 10360     MOVE PI-STATE               TO CERT-STATE.
 10361     MOVE PI-ACCOUNT             TO CERT-ACCOUNT.
 10362     MOVE PI-CERT-EFF-DT         TO CERT-DATE.
 10363     MOVE PI-CERT-NO             TO CERT-CERT.
 10364
 10365
 10366* EXEC CICS READ UPDATE
 10367*         DATASET  (CERT-FILE-ID)
 10368*         RIDFLD   (CERT-KEY)
 10369*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 10370*    END-EXEC.
 10371*    MOVE '&"S        EU         (   #00009449' TO DFHEIV0
 10372     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10373     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10374     MOVE X'2020233030303039343439' TO DFHEIV0(25:11)
 10375     CALL 'kxdfhei1' USING DFHEIV0,
 10376           CERT-FILE-ID,
 10377           DFHEIV20,
 10378           DFHEIV99,
 10379           CERT-KEY,
 10380           DFHEIV99,
 10381           DFHEIV99,
 10382           DFHEIV99
 10383     SET ADDRESS OF CERTIFICATE-MASTER TO
 10384         DFHEIV20
 10385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10386
 10387
 10388     MOVE 'Y'                    TO WS-REC-FOUND-SW.
 10389     MOVE CERTIFICATE-MASTER     TO SAVE-RECORD.
 10390     SUBTRACT 1                  FROM CM-CLAIM-ATTACHED-COUNT.
 10391
 10392     IF CM-CLAIM-ATTACHED-COUNT LESS THAN ZERO
 10393         MOVE ZERO               TO CM-CLAIM-ATTACHED-COUNT.
 10394
 10395     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10396       AND
 10397        CERT-WAS-CREATED-FOR-CLAIM
 10398         MOVE CERTIFICATE-MASTER TO JP-RECORD-AREA
 10399
 10400* EXEC CICS DELETE
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 193
* EL131.cbl
 10401*             DATASET   (CERT-FILE-ID)
 10402*        END-EXEC
 10403*    MOVE '&(                    &   #00009466' TO DFHEIV0
 10404     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10405     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10406     MOVE X'2020233030303039343636' TO DFHEIV0(25:11)
 10407     CALL 'kxdfhei1' USING DFHEIV0,
 10408           CERT-FILE-ID,
 10409           DFHEIV99,
 10410           DFHEIV99,
 10411           DFHEIV99,
 10412           DFHEIV99
 10413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10414         GO TO 2070-EXIT.
 10415
 10416     IF CM-CLAIM-ATTACHED-COUNT = ZERO
 10417         MOVE SPACE TO CM-CLAIM-INTERFACE-SW PI-CERT-SWITCH.
 10418
 10419
 10420* EXEC CICS HANDLE CONDITION
 10421*         DUPKEY   (2070-EXIT)
 10422*    END-EXEC.
 10423*    MOVE '"$$                   ! 2 #00009474' TO DFHEIV0
 10424     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10425     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10426     MOVE X'3220233030303039343734' TO DFHEIV0(25:11)
 10427     CALL 'kxdfhei1' USING DFHEIV0
 10428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10429
 10430
 10431
 10432* EXEC CICS REWRITE
 10433*         DATASET  (CERT-FILE-ID)
 10434*         FROM     (CERTIFICATE-MASTER)
 10435*    END-EXEC.
 10436     MOVE LENGTH OF
 10437      CERTIFICATE-MASTER
 10438       TO DFHEIV11
 10439*    MOVE '&& L                  %   #00009478' TO DFHEIV0
 10440     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10441     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10442     MOVE X'2020233030303039343738' TO DFHEIV0(25:11)
 10443     CALL 'kxdfhei1' USING DFHEIV0,
 10444           CERT-FILE-ID,
 10445           CERTIFICATE-MASTER,
 10446           DFHEIV11,
 10447           DFHEIV99
 10448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10449
 10450
 10451     GO TO 2070-EXIT.
 10452
 10453 2070-NOT-FOUND.
 10454     MOVE 'N'                        TO  WS-REC-FOUND-SW.
 10455
 10456 2070-EXIT.
 10457     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 194
* EL131.cbl
 10459 2080-CREATE-CERT.
 10460
 10461* EXEC CICS GETMAIN
 10462*         SET       (ADDRESS OF CERTIFICATE-MASTER)
 10463*         LENGTH    (CERT-LENGTH)
 10464*         INITIMG   (GETMAIN-SPACE)
 10465*    END-EXEC.
 10466*    MOVE ',"IL                  $   #00009492' TO DFHEIV0
 10467     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10468     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10469     MOVE X'2020233030303039343932' TO DFHEIV0(25:11)
 10470     CALL 'kxdfhei1' USING DFHEIV0,
 10471           DFHEIV20,
 10472           CERT-LENGTH,
 10473           GETMAIN-SPACE
 10474     SET ADDRESS OF CERTIFICATE-MASTER TO
 10475         DFHEIV20
 10476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10477
 10478
 10479     MOVE SAVE-RECORD            TO CERTIFICATE-MASTER.
 10480
 10481     IF CERTEFFI GREATER THAN LOW-VALUES
 10482         MOVE HOLD-EFF           TO CERT-DATE CM-CERT-EFF-DT
 10483                                    DC-BIN-DATE-1
 10484         MOVE '6'                TO DC-OPTION-CODE
 10485         MOVE +1                 TO DC-ELAPSED-MONTHS
 10486         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 10487         IF NO-CONVERSION-ERROR
 10488             MOVE DC-BIN-DATE-2  TO CM-LOAN-1ST-PMT-DT.
 10489
 10490     IF CERTACTI GREATER THAN LOW-VALUES
 10491         MOVE CERTACTI           TO CERT-ACCOUNT CM-ACCOUNT.
 10492     IF CERTSTI GREATER THAN LOW-VALUES
 10493         MOVE CERTSTI            TO CERT-STATE CM-STATE.
 10494     IF CERTCARI GREATER THAN LOW-VALUES
 10495         MOVE CERTCARI           TO CERT-CARRIER CM-CARRIER.
 10496     IF CERTGRPI GREATER THAN LOW-VALUES
 10497         MOVE CERTGRPI           TO CERT-GROUP CM-GROUPING.
 10498     IF CERTI GREATER THAN LOW-VALUES
 10499         MOVE CERTI              TO CERT-CERT-PRIME
 10500                                    CM-CERT-PRIME
 10501         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10502
 10503     IF SUFXI GREATER THAN LOW-VALUES
 10504         MOVE SUFXI              TO CERT-CERT-SUFX
 10505                                    CM-CERT-SFX
 10506         MOVE CM-CERT-NO         TO CM-CERT-NO-A4.
 10507
 10508     PERFORM 2200-MOVE-CERT THRU 2200-EXIT.
 10509
 10510     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10511
 10512     MOVE SPACES                 TO CM-ENTRY-BATCH
 10513                                    CM-LF-EXIT-BATCH
 10514                                    CM-AH-EXIT-BATCH
 10515                                    CM-CREDIT-INTERFACE-SW-1
 10516                                    CM-CREDIT-INTERFACE-SW-2.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 195
* EL131.cbl
 10517
 10518     IF CM-LF-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10519                               '9' OR 'D' OR 'V'
 10520         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 10521
 10522     IF CM-AH-CURRENT-STATUS = '2' OR '3' OR '4' OR '5' OR
 10523                               '9' OR 'D' OR 'V'
 10524         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 10525
 10526     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 10527                                    CL-CERT-ORIGIN PI-CERT-SWITCH.
 10528     MOVE 1                      TO CM-CLAIM-ATTACHED-COUNT.
 10529
 10530
 10531* EXEC CICS HANDLE CONDITION
 10532*         DUPKEY (2080-EXIT)
 10533*    END-EXEC.
 10534*    MOVE '"$$                   ! 3 #00009549' TO DFHEIV0
 10535     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10537     MOVE X'3320233030303039353439' TO DFHEIV0(25:11)
 10538     CALL 'kxdfhei1' USING DFHEIV0
 10539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10540
 10541
 10542
 10543* EXEC CICS WRITE
 10544*         DATASET  (CERT-FILE-ID)
 10545*         RIDFLD   (CERT-KEY)
 10546*         FROM     (CERTIFICATE-MASTER)
 10547*    END-EXEC.
 10548     MOVE LENGTH OF
 10549      CERTIFICATE-MASTER
 10550       TO DFHEIV11
 10551*    MOVE '&$ L                  ''   #00009553' TO DFHEIV0
 10552     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10553     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10554     MOVE X'2020233030303039353533' TO DFHEIV0(25:11)
 10555     CALL 'kxdfhei1' USING DFHEIV0,
 10556           CERT-FILE-ID,
 10557           CERTIFICATE-MASTER,
 10558           DFHEIV11,
 10559           CERT-KEY,
 10560           DFHEIV99,
 10561           DFHEIV99
 10562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10563
 10564
 10565 2080-EXIT.
 10566     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 196
* EL131.cbl
 10568 2100-MOVE-MSTR.
 10569     IF TYPEI GREATER THAN LOW-VALUES
 10570         MOVE TYPEI              TO CL-CLAIM-TYPE.
 10571
 10572     IF STATUSI = LOW-VALUES
 10573         GO TO 2100-NO-STATUS-CHANGE.
 10574
 10575     IF STATUSI = 'OPEN' OR 'O'
 10576         IF CL-CLAIM-STATUS = 'O'
 10577             MOVE SPACES         TO TRLR-SWITCH
 10578                 GO TO 2100-NO-STATUS-CHANGE.
 10579
 10580     IF STATUSI = 'CLOSED' OR 'C'
 10581         IF CL-CLAIM-STATUS = 'C'
 10582             MOVE SPACES         TO TRLR-SWITCH
 10583                 GO TO 2100-NO-STATUS-CHANGE.
 10584
 10585     IF PI-COMPANY-ID = 'DMD'
 10586        IF STATUSI = 'OPEN' OR 'O'
 10587           IF CL-LAST-CLOSE-REASON = 'C' OR 'E'
 10588              MOVE ZERO       TO STATUSL
 10589              MOVE LOW-VALUES TO STATUSI
 10590              GO TO 2100-NO-STATUS-CHANGE.
 10591
 10592     IF PI-COMPANY-ID = 'DMD'
 10593         PERFORM 8000-CREATE-DMO-REC THRU 8000-EXIT.
 10594
 10595     MOVE STATUSI                TO CL-CLAIM-STATUS.
 10596
 10597 2100-NO-STATUS-CHANGE.
 10598
 10599     IF CCNOI GREATER THAN LOW-VALUES
 10600         MOVE CCNOI              TO CL-CCN.
 10601
 10602     IF PROCI GREATER THAN LOW-VALUES
 10603         MOVE PROCI              TO CL-PROCESSOR-ID.
 10604
 10605     if accswi > low-values
 10606        and accswi = 'Y' OR 'N'
 10607        move accswi              to cl-accident-claim-sw
 10608     end-if
 10609     IF SEXI GREATER THAN LOW-VALUES
 10610         MOVE SEXI               TO CL-INSURED-SEX-CD.
 10611
 10612     IF BIRTHI GREATER THAN LOW-VALUES
 10613         MOVE HOLD-BIRTH         TO CL-INSURED-BIRTH-DT.
 10614
 10615     IF SOCIALI GREATER THAN LOW-VALUES
 10616       AND
 10617        SOCIALI = SPACES
 10618         MOVE CL-CERT-STATE      TO CL-SSN-STATE
 10619         MOVE CL-CERT-ACCOUNT-PRIME   TO CL-SSN-ACCOUNT
 10620         MOVE CL-INSURED-LAST-NAME   TO CL-SSN-LN3
 10621     ELSE
 10622         IF SOCIALI GREATER THAN LOW-VALUES
 10623             MOVE SOCIALI        TO CL-SOC-SEC-NO.
 10624
 10625     IF OCCI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 197
* EL131.cbl
 10626         MOVE OCCI               TO CL-INSURED-OCC-CD.
 10627
 10628     IF BENEL GREATER THAN ZERO
 10629         MOVE BENEI              TO CL-BENEFICIARY.
 10630
 10631     IF DIAGI GREATER THAN LOW-VALUES
 10632         MOVE DIAGI              TO WS-DIAGNOSIS.
 10633
 10634     IF PREMTYPI GREATER THAN LOW-VALUES
 10635         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE.
 10636
 10637     IF CAUSEI GREATER THAN LOW-VALUES
 10638         MOVE CAUSEI             TO CL-CAUSE-CD.
 10639
 10640     IF ENDI GREATER THAN LOW-VALUES
 10641         MOVE HOLD-END           TO CL-EST-END-OF-DISAB-DT.
 10642
 10643     IF PDTHRUI GREATER THAN LOW-VALUES
 10644        MOVE HOLD-PDTHRU         TO CL-PAID-THRU-DT.
 10645
 10646     IF PDAMTL GREATER THAN +0
 10647        MOVE HOLD-PDAMT          TO CL-TOTAL-PAID-AMT.
 10648
 10649     IF NODAYSI GREATER THAN LOW-VALUES
 10650        MOVE HOLD-NODAYS         TO CL-NO-OF-DAYS-PAID.
 10651
 10652     IF NOPMTSI GREATER THAN LOW-VALUES
 10653        MOVE HOLD-NOPMTS         TO CL-NO-OF-PMTS-MADE.
 10654
 10655     IF FORMTYPI GREATER THAN LOW-VALUES
 10656        MOVE FORMTYPI            TO CL-PROG-FORM-TYPE.
 10657
 10658     IF INCI GREATER THAN LOW-VALUES
 10659        MOVE HOLD-INCUR          TO CL-INCURRED-DT.
 10660
 10661     IF REPI GREATER THAN LOW-VALUES
 10662        MOVE HOLD-REPORTED       TO CL-REPORTED-DT.
 10663
 10664     IF ADDONDTI GREATER THAN LOW-VALUES
 10665        MOVE HOLD-ADDON          TO CL-LAST-ADD-ON-DT.
 10666
 10667     IF PRICDI GREATER THAN LOW-VALUES
 10668         MOVE PRICDI             TO CL-PRIORITY-CD.
 10669
 10670     IF CRITPTL > ZEROS
 10671        MOVE CRITPTI             TO CL-CRIT-PER-RECURRENT
 10672     END-IF
 10673
 10674     IF RTWMOSL > ZEROS
 10675        MOVE RTWMOSI             TO CL-CRIT-PER-RTW-MOS
 10676     END-IF
 10677     IF FILETOI GREATER THAN LOW-VALUES
 10678         MOVE FILETOI            TO CL-FILE-LOCATION.
 10679
 10680     IF SUPVI GREATER THAN LOW-VALUES
 10681         MOVE SUPVI              TO CL-SUPV-ATTN-CD.
 10682
 10683     IF MLNAMEI GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 198
* EL131.cbl
 10684         MOVE MLNAMEI            TO CL-INSURED-LAST-NAME.
 10685
 10686     IF MFNAMEI GREATER THAN LOW-VALUES
 10687         MOVE MFNAMEI            TO CL-INSURED-1ST-NAME.
 10688
 10689     IF MMINITI GREATER THAN LOW-VALUES
 10690         MOVE MMINITI            TO CL-INSURED-MID-INIT.
 10691
 10692     IF CERTEFFI GREATER THAN LOW-VALUES
 10693         MOVE HOLD-EFF           TO CL-CERT-EFF-DT.
 10694
 10695     IF CERTACTI GREATER THAN LOW-VALUES
 10696         MOVE CERTACTI           TO CL-CERT-ACCOUNT.
 10697
 10698     IF CERTSTI GREATER THAN LOW-VALUES
 10699         MOVE CERTSTI            TO CL-CERT-STATE.
 10700
 10701     IF CERTCARI GREATER THAN LOW-VALUES
 10702         MOVE CERTCARI           TO CL-CERT-CARRIER CARRIER-CODE
 10703                                    CL-CARRIER.
 10704
 10705     IF CERTGRPI GREATER THAN LOW-VALUES
 10706         MOVE CERTGRPI           TO CL-CERT-GROUPING.
 10707
 10708     IF CERTI GREATER THAN LOW-VALUES
 10709         MOVE CERTI              TO CERT-NO-PRIME.
 10710
 10711     IF SUFXI GREATER THAN LOW-VALUES
 10712         MOVE SUFXI              TO CERT-NO-SUFX.
 10713
 10714     MOVE CERT-NO                TO CL-CERT-NO
 10715                                    CL-CERT-NO-A4.
 10716
 10717     IF PI-COMPANY-ID = 'FLA'
 10718          NEXT SENTENCE
 10719     ELSE
 10720         MOVE SAVE-BIN-DATE      TO CL-LAST-MAINT-DT
 10721         MOVE PI-PROCESSOR-ID    TO CL-LAST-MAINT-USER
 10722         MOVE EIBTIME            TO CL-LAST-MAINT-HHMMSS
 10723         MOVE '3'                TO CL-LAST-MAINT-TYPE.
 10724
 10725     IF TRLR-UPDATE-REQUIRED
 10726        MOVE CL-CONTROL-PRIMARY TO TRLR-KEY
 10727        MOVE ZEROS              TO TRLR-SEQ-NO
 10728
 10729* EXEC CICS READ
 10730*            DATASET   (TRLR-FILE-ID)
 10731*            RIDFLD    (TRLR-KEY)
 10732*            SET       (ADDRESS OF ACTIVITY-TRAILERS)
 10733*       END-EXEC
 10734*    MOVE '&"S        E          (   #00009722' TO DFHEIV0
 10735     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10736     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10737     MOVE X'2020233030303039373232' TO DFHEIV0(25:11)
 10738     CALL 'kxdfhei1' USING DFHEIV0,
 10739           TRLR-FILE-ID,
 10740           DFHEIV20,
 10741           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 199
* EL131.cbl
 10742           TRLR-KEY,
 10743           DFHEIV99,
 10744           DFHEIV99,
 10745           DFHEIV99
 10746     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10747         DFHEIV20
 10748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10749        IF AT-TRAILER-TYPE = '1'
 10750           MOVE +1 TO MISC-SUB
 10751           PERFORM 2100-BUMP-OPEN-CLOSE-HIST UNTIL
 10752           MISC-SUB GREATER THAN +6 OR
 10753           AT-OPEN-CLOSE-TYPE (MISC-SUB) = SPACES
 10754           IF MISC-SUB GREATER THAN +1
 10755              SUBTRACT +1 FROM MISC-SUB
 10756              IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 10757                 GO TO 2100-BYPASS-LAST-UPDATE.
 10758
 10759     IF TRLR-UPDATE-REQUIRED AND
 10760        CLAIM-IS-OPEN
 10761         MOVE SAVE-BIN-DATE      TO CL-LAST-REOPEN-DT
 10762     ELSE
 10763         IF TRLR-UPDATE-REQUIRED AND
 10764            CLAIM-IS-CLOSED
 10765             MOVE SAVE-BIN-DATE  TO CL-LAST-CLOSE-DT
 10766             MOVE '4'            TO CL-LAST-CLOSE-REASON.
 10767
 10768 2100-BYPASS-LAST-UPDATE.
 10769     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10770     MOVE EMI-FATAL-CTR          TO CL-FATAL-ERROR-CNT.
 10771
 10772     GO TO 2100-EXIT.
 10773
 10774 2100-BUMP-OPEN-CLOSE-HIST.
 10775     ADD +1                      TO MISC-SUB.
 10776
 10777 2100-EXIT.
 10778     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 200
* EL131.cbl
 10780 2120-check-pdef.
 10781
 10782
 10783     move +0                     to s1
 10784     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
 10785     move spaces                 to ws-dcc-error-line
 10786     PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
 10787     IF ERPDEF-FOUND
 10788        perform 2130-check-trlr  thru 2130-exit
 10789        move +1                  to s1
 10790*       if cl-accident-claim-sw = ' '
 10791*          move er-1655             to ws-error-no (s1)
 10792*          add +1 to s1
 10793*       end-if
 10794        MOVE CL-CERT-EFF-DT      TO DC-BIN-DATE-1
 10795        MOVE cl-incurred-dt      TO DC-BIN-DATE-2
 10796        MOVE '1'                 TO DC-OPTION-CODE
 10797        MOVE +0                  TO DC-ELAPSED-MONTHS
 10798                                    DC-ELAPSED-DAYS
 10799        PERFORM 9800-CONVERT-DATE
 10800                                 THRU 9800-EXIT
 10801        IF NO-CONVERSION-ERROR
 10802           MOVE DC-ELAPSED-MONTHS
 10803                                 TO WS-MONTHS-BETWEEN
 10804           IF DC-ELAPSED-DAYS > 1
 10805              ADD 1 TO WS-MONTHS-BETWEEN
 10806           END-IF
 10807        ELSE
 10808           MOVE ZEROS            TO WS-MONTHS-BETWEEN
 10809        END-IF
 10810        IF (WS-EXCL-PERIOD = ZEROS)
 10811           OR (WS-MONTHS-BETWEEN = ZEROS)
 10812           CONTINUE
 10813        ELSE
 10814           IF WS-MONTHS-BETWEEN  <= WS-EXCL-PERIOD
 10815              MOVE ER-1651       TO ws-error-no (s1)
 10816              add +1             to s1
 10817           END-IF
 10818        END-IF
 10819        IF (WS-COV-ENDS = ZEROS)
 10820           OR (WS-MONTHS-BETWEEN = ZEROS)
 10821           CONTINUE
 10822        ELSE
 10823           IF WS-MONTHS-BETWEEN > WS-COV-ENDS
 10824              MOVE -1            TO MAINTL
 10825              MOVE ER-1653       TO ws-error-no (s1)
 10826              add +1 to s1
 10827           END-IF
 10828        END-IF
 10829        IF (WS-ACC-PERIOD = ZEROS)
 10830           OR (WS-MONTHS-BETWEEN = ZEROS)
 10831           CONTINUE
 10832        ELSE
 10833           IF (WS-MONTHS-BETWEEN <= WS-ACC-PERIOD)
 10834              and (cl-accident-claim-sw = ' ')
 10835              move er-1655       to ws-error-no (s1)
 10836              add +1             to s1
 10837           end-if
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 201
* EL131.cbl
 10838           IF WS-MONTHS-BETWEEN <= WS-ACC-PERIOD
 10839              if cl-accident-claim-sw not = 'Y'
 10840                 MOVE ER-1652    TO ws-error-no (s1)
 10841              else
 10842                 move er-1662    to ws-error-no (s1)
 10843              end-if
 10844              MOVE -1            TO MAINTL
 10845              add +1             to s1
 10846           END-IF
 10847        END-IF
 10848        if cl-claim-type  = 'I'
 10849           move er-1661          to ws-error-no (s1)
 10850           add +1                to s1
 10851        end-if
 10852        perform 2130-check-trlr  thru 2130-exit
 10853     END-IF
 10854
 10855     .
 10856 2120-exit.
 10857     exit.
 10858
 10859 2130-check-trlr.
 10860
 10861     evaluate true
 10862        when s1 = +0
 10863           move cl-control-primary
 10864                                 to trlr-key
 10865           MOVE +95              TO TRLR-SEQ-NO
 10866
 10867* EXEC CICS READ
 10868*             update
 10869*             DATASET  ('ELTRLR')
 10870*             SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10871*             RIDFLD   (TRLR-KEY)
 10872*             RESP     (WS-RESPONSE)
 10873*          END-EXEC
 10874     MOVE 'ELTRLR' TO DFHEIV1
 10875*    MOVE '&"S        EU         (  N#00009844' TO DFHEIV0
 10876     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10877     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10878     MOVE X'204E233030303039383434' TO DFHEIV0(25:11)
 10879     CALL 'kxdfhei1' USING DFHEIV0,
 10880           DFHEIV1,
 10881           DFHEIV20,
 10882           DFHEIV99,
 10883           TRLR-KEY,
 10884           DFHEIV99,
 10885           DFHEIV99,
 10886           DFHEIV99
 10887     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10888         DFHEIV20
 10889     MOVE EIBRESP  TO WS-RESPONSE
 10890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10891           if ws-resp-normal
 10892              move spaces        to at-info-line-1
 10893           end-if
 10894        when s1 = +1
 10895           if ws-resp-normal
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 202
* EL131.cbl
 10896
 10897* exec cics rewrite
 10898*                dataset   ('ELTRLR')
 10899*                from      (activity-trailers)
 10900*             end-exec
 10901     MOVE LENGTH OF
 10902      activity-trailers
 10903       TO DFHEIV11
 10904     MOVE 'ELTRLR' TO DFHEIV1
 10905*    MOVE '&& L                  %   #00009856' TO DFHEIV0
 10906     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10907     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10908     MOVE X'2020233030303039383536' TO DFHEIV0(25:11)
 10909     CALL 'kxdfhei1' USING DFHEIV0,
 10910           DFHEIV1,
 10911           activity-trailers,
 10912           DFHEIV11,
 10913           DFHEIV99
 10914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10915           end-if
 10916        when s1 > +1
 10917           if ws-resp-normal
 10918              move ws-dcc-error-line
 10919                                 to at-info-line-1
 10920
 10921* exec cics rewrite
 10922*                dataset   ('ELTRLR')
 10923*                from      (activity-trailers)
 10924*             end-exec
 10925     MOVE LENGTH OF
 10926      activity-trailers
 10927       TO DFHEIV11
 10928     MOVE 'ELTRLR' TO DFHEIV1
 10929*    MOVE '&& L                  %   #00009865' TO DFHEIV0
 10930     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10931     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10932     MOVE X'2020233030303039383635' TO DFHEIV0(25:11)
 10933     CALL 'kxdfhei1' USING DFHEIV0,
 10934           DFHEIV1,
 10935           activity-trailers,
 10936           DFHEIV11,
 10937           DFHEIV99
 10938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10939           else
 10940
 10941* EXEC CICS GETMAIN
 10942*                SET      (ADDRESS OF ACTIVITY-TRAILERS)
 10943*                LENGTH   (TRLR-LENGTH)
 10944*                INITIMG  (GETMAIN-SPACE)
 10945*             END-EXEC
 10946*    MOVE ',"IL                  $   #00009870' TO DFHEIV0
 10947     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10948     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10949     MOVE X'2020233030303039383730' TO DFHEIV0(25:11)
 10950     CALL 'kxdfhei1' USING DFHEIV0,
 10951           DFHEIV20,
 10952           TRLR-LENGTH,
 10953           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 203
* EL131.cbl
 10954     SET ADDRESS OF ACTIVITY-TRAILERS TO
 10955         DFHEIV20
 10956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10957              move 'AT'          to at-record-id
 10958              move cl-control-primary
 10959                                 to at-control-primary
 10960              move +95           to at-sequence-no
 10961              move '6'           to at-trailer-type
 10962              move ws-dcc-error-line
 10963                                 to at-info-line-1
 10964              move 'E'           to at-info-trailer-type
 10965              move save-bin-date to at-recorded-dt
 10966                                    at-gen-info-last-maint-dt
 10967              move pi-processor-id
 10968                                 to at-recorded-by
 10969                                    at-gen-info-last-updated-by
 10970              move eibtime       to at-last-maint-hhmmss
 10971
 10972* exec cics write
 10973*                dataset   ('ELTRLR')
 10974*                from      (activity-trailers)
 10975*                ridfld    (trlr-key)
 10976*             end-exec
 10977     MOVE LENGTH OF
 10978      activity-trailers
 10979       TO DFHEIV11
 10980     MOVE 'ELTRLR' TO DFHEIV1
 10981*    MOVE '&$ L                  ''   #00009889' TO DFHEIV0
 10982     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10983     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10984     MOVE X'2020233030303039383839' TO DFHEIV0(25:11)
 10985     CALL 'kxdfhei1' USING DFHEIV0,
 10986           DFHEIV1,
 10987           activity-trailers,
 10988           DFHEIV11,
 10989           trlr-key,
 10990           DFHEIV99,
 10991           DFHEIV99
 10992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10993              perform varying s1 from +1 by +1 until
 10994                 ws-error-no (s1) = spaces
 10995                 move ws-error-no (s1)
 10996                                 to emi-error
 10997                 PERFORM 9900-ERROR-FORMAT
 10998                                 THRU 9900-EXIT
 10999              end-perform
 11000           end-if
 11001     end-evaluate
 11002
 11003     .
 11004 2130-exit.
 11005     exit.
 11006 2200-MOVE-CERT.
 11007     IF CRTLNMEI GREATER THAN LOW-VALUES
 11008         MOVE CRTLNMEI           TO CM-INSURED-LAST-NAME.
 11009
 11010     IF CRTFNMEI GREATER THAN LOW-VALUES
 11011         MOVE CRTFNMEI           TO CM-INSURED-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 204
* EL131.cbl
 11012         MOVE CM-INSURED-1ST-INIT TO CM-INSURED-INITIAL1.
 11013
 11014     IF CRTINITI GREATER THAN LOW-VALUES
 11015         MOVE CRTINITI           TO CM-INSURED-INITIAL2.
 11016
 11017     IF CM-INSURED-INITIALS = SPACES
 11018         MOVE '**'               TO CM-INSURED-INITIALS.
 11019
 11020     IF ISSAGEI GREATER THAN LOW-VALUES
 11021         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE.
 11022
 11023     IF JNTFNMEI GREATER THAN LOW-VALUES
 11024         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME.
 11025
 11026     IF JNTLNMEI GREATER THAN LOW-VALUES
 11027         MOVE JNTLNMEI           TO CM-JT-LAST-NAME.
 11028
 11029     IF JNTINITI GREATER THAN LOW-VALUES
 11030         MOVE JNTINITI           TO CM-JT-INITIAL.
 11031
 11032     IF JNTAGEI GREATER THAN LOW-VALUES
 11033         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE.
 11034
 11035     IF ADDONDTI GREATER THAN LOW-VALUES
 11036        MOVE HOLD-ADDON          TO CM-LAST-ADD-ON-DT.
 11037
 11038     IF LCVCDI GREATER THAN LOW-VALUES
 11039        IF LCVCDI = SPACES OR ZEROS
 11040           MOVE ZEROS            TO CM-LF-BENEFIT-CD
 11041        ELSE
 11042           MOVE LCVCDI           TO CM-LF-BENEFIT-CD.
 11043
 11044     IF LCVOTRMI GREATER THAN LOW-VALUES
 11045         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM.
 11046
 11047     IF LCVRATEL GREATER THAN +0
 11048         MOVE HOLD-LF-RATE       TO CM-LF-PREMIUM-RATE.
 11049
 11050     IF LCVBENEL GREATER THAN +0
 11051         MOVE HOLD-LF-CV-BEN     TO CM-LF-BENEFIT-AMT.
 11052
 11053     IF LCVFORMI GREATER THAN LOW-VALUES
 11054         MOVE LCVFORMI           TO CM-POLICY-FORM-NO.
 11055
 11056     IF LCVCNDTI = LOW-VALUES
 11057        GO TO 2210-SET-STATUS.
 11058
 11059     IF HOLD-LF-CV-CAN NOT = LOW-VALUES
 11060        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 11061        MOVE HOLD-LF-CV-CAN      TO CM-LF-CANCEL-DT
 11062        GO TO 2210-SET-STATUS.
 11063
 11064     IF CM-LF-CURRENT-STATUS = '7'
 11065        MOVE CM-LF-STATUS-AT-DEATH   TO CM-LF-CURRENT-STATUS
 11066        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 11067        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11068                                    CM-LF-DEATH-DT
 11069        GO TO 2210-SET-STATUS.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 205
* EL131.cbl
 11070
 11071     IF CM-LF-CURRENT-STATUS = '8'
 11072        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 11073        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 11074                                    CM-LF-CANCEL-DT.
 11075
 11076 2210-SET-STATUS.
 11077
 11078     IF CM-LF-CURRENT-STATUS = SPACES
 11079         MOVE '1'                TO CM-LF-CURRENT-STATUS.
 11080
 11081     IF CM-LF-ORIG-TERM GREATER THAN ZERO
 11082         MOVE '6'                TO DC-OPTION-CODE
 11083         MOVE CM-LF-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11084         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11085         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11086         IF NO-CONVERSION-ERROR
 11087             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT
 11088         ELSE
 11089             MOVE LOW-VALUES     TO CM-LF-LOAN-EXPIRE-DT
 11090     ELSE
 11091         MOVE LOW-VALUES         TO CM-LF-LOAN-EXPIRE-DT.
 11092
 11093 2215-PROCESS-AH-SIDE.
 11094
 11095     IF ACVCDI GREATER THAN LOW-VALUES
 11096        IF ACVCDI = SPACES OR ZEROS
 11097           MOVE ZEROS            TO CM-AH-BENEFIT-CD
 11098        ELSE
 11099           MOVE ACVCDI           TO CM-AH-BENEFIT-CD.
 11100
 11101     IF ACVOTRMI GREATER THAN LOW-VALUES
 11102         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM.
 11103
 11104     IF ACVRATEL GREATER THAN +0
 11105         MOVE HOLD-AH-RATE       TO CM-AH-PREMIUM-RATE.
 11106
 11107     IF ACVBENEL GREATER THAN +0
 11108         MOVE HOLD-AH-CV-BEN     TO CM-AH-BENEFIT-AMT
 11109                                    PI-PAYMENT-AMT.
 11110
 11111     IF ACVFORMI GREATER THAN LOW-VALUES
 11112         MOVE ACVFORMI           TO CM-POLICY-FORM-NO.
 11113
 11114     IF ACVCNDTI = LOW-VALUES
 11115        GO TO 2220-SET-STATUS.
 11116
 11117     IF HOLD-AH-CV-CAN NOT = LOW-VALUES
 11118        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 11119        MOVE HOLD-AH-CV-CAN      TO CM-AH-CANCEL-DT
 11120        GO TO 2220-SET-STATUS.
 11121
 11122     IF CM-AH-CURRENT-STATUS = '6'
 11123        MOVE CM-AH-STATUS-AT-SETTLEMENT
 11124                                 TO CM-AH-CURRENT-STATUS
 11125        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 11126        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11127                                    CM-AH-SETTLEMENT-DT
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 206
* EL131.cbl
 11128        GO TO 2220-SET-STATUS.
 11129
 11130     IF CM-AH-CURRENT-STATUS = '8'
 11131        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 11132        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 11133                                    CM-AH-CANCEL-DT.
 11134
 11135 2220-SET-STATUS.
 11136     IF CM-AH-CURRENT-STATUS = SPACES
 11137         MOVE '1'                TO CM-AH-CURRENT-STATUS.
 11138
 11139     IF CM-AH-ORIG-TERM GREATER THAN ZERO
 11140         MOVE '6'                TO DC-OPTION-CODE
 11141         MOVE CM-AH-ORIG-TERM    TO DC-ELAPSED-MONTHS
 11142         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 11143         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 11144         IF NO-CONVERSION-ERROR
 11145             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT
 11146         ELSE
 11147             MOVE LOW-VALUES     TO CM-AH-LOAN-EXPIRE-DT
 11148     ELSE
 11149         MOVE LOW-VALUES         TO CM-AH-LOAN-EXPIRE-DT.
 11150
 11151 2225-FINISH-CERT.
 11152     IF APRL GREATER THAN +0
 11153         MOVE HOLD-APR           TO CM-LOAN-APR.
 11154
 11155     IF PMTFREQI GREATER THAN LOW-VALUES
 11156         MOVE PMTFREQI           TO CM-PAY-FREQUENCY.
 11157
 11158     IF INDGRPI GREATER THAN LOW-VALUES
 11159         MOVE INDGRPI            TO CM-IND-GRP-TYPE.
 11160
 11161     IF LOANNOI GREATER THAN LOW-VALUES
 11162        MOVE LOANNOI             TO CM-LOAN-NUMBER.
 11163
 11164     IF LOANBALL GREATER THAN +0
 11165        MOVE HOLD-LOANBAL        TO CM-LOAN-BALANCE.
 11166
 11167     IF PREMTYPI GREATER THAN LOW-VALUES
 11168         MOVE PREMTYPI           TO CM-PREMIUM-TYPE.
 11169
 11170     IF REINCDI GREATER THAN LOW-VALUES
 11171         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 11172                                    WS-REIN-1
 11173                                    WS-REIN-2
 11174                                    WS-REIN-3
 11175         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE.
 11176
 11177     MOVE LOW-VALUES             TO CM-AH-PAID-THRU-DT.
 11178
 11179     MOVE ZEROS                  TO CM-LOAN-TERM
 11180                                    CM-LIFE-COMM-PCT
 11181                                    CM-AH-COMM-PCT.
 11182
 11183*    IF PI-COMPANY-ID = 'CRI' OR 'PEM' OR 'NCL'
 11184*      IF CM-PREMIUM-TYPE NOT = '1'  AND
 11185*         PI-NO-PMTS = ZEROS
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 207
* EL131.cbl
 11186*          IF LOANBALL GREATER THAN +0          OR
 11187*             ACVBENEL GREATER THAN +0          OR
 11188*             APRL     GREATER THAN +0          OR
 11189*             LCVRATEL GREATER THAN +0          OR
 11190*             ACVRATEL GREATER THAN +0
 11191*               PERFORM 6000-CALCULATE-CERT-TERM THRU 6000-EXIT.
 11192
 11193 2200-EXIT.
 11194     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 208
* EL131.cbl
 11196 2300-UPDATE-TRLR.
 11197     MOVE ZERO                   TO TRLR-SEQ-NO.
 11198
 11199* EXEC CICS READ UPDATE
 11200*         DATASET  (TRLR-FILE-ID)
 11201*         RIDFLD   (TRLR-KEY)
 11202*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 11203*    END-EXEC.
 11204*    MOVE '&"S        EU         (   #00010099' TO DFHEIV0
 11205     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11206     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11207     MOVE X'2020233030303130303939' TO DFHEIV0(25:11)
 11208     CALL 'kxdfhei1' USING DFHEIV0,
 11209           TRLR-FILE-ID,
 11210           DFHEIV20,
 11211           DFHEIV99,
 11212           TRLR-KEY,
 11213           DFHEIV99,
 11214           DFHEIV99,
 11215           DFHEIV99
 11216     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11217         DFHEIV20
 11218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11219
 11220
 11221     MOVE ZERO                   TO COUNT-2.
 11222
 11223     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11224         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11225
 11226     IF NOT UPDATE-MADE
 11227         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11228
 11229
 11230* EXEC CICS REWRITE
 11231*         DATASET  (TRLR-FILE-ID)
 11232*         FROM     (ACTIVITY-TRAILERS)
 11233*    END-EXEC.
 11234     MOVE LENGTH OF
 11235      ACTIVITY-TRAILERS
 11236       TO DFHEIV11
 11237*    MOVE '&& L                  %   #00010113' TO DFHEIV0
 11238     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11239     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11240     MOVE X'2020233030303130313133' TO DFHEIV0(25:11)
 11241     CALL 'kxdfhei1' USING DFHEIV0,
 11242           TRLR-FILE-ID,
 11243           ACTIVITY-TRAILERS,
 11244           DFHEIV11,
 11245           DFHEIV99
 11246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11247
 11248
 11249 2300-EXIT.
 11250     EXIT.
 11251
 11252 2310-INS-STATUS.
 11253     ADD 1                       TO COUNT-2.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 209
* EL131.cbl
 11254     IF AT-OPEN-CLOSE-TYPE (COUNT-2) = SPACE
 11255         PERFORM 2330-ADD-UPDATE THRU 2330-EXIT
 11256         MOVE 'Y'                TO TRLR-SWITCH.
 11257
 11258 2310-EXIT.
 11259     EXIT.
 11260
 11261 2320-SHIFT-STATUS.
 11262     IF AT-OPEN-CLOSE-TYPE (6) = STATUSI
 11263        MOVE 6                   TO COUNT-2
 11264        GO TO 2320-EXIT.
 11265
 11266     MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1).
 11267     MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2).
 11268     MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3).
 11269     MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4).
 11270     MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5).
 11271     MOVE 6       TO COUNT-2.
 11272     PERFORM 2330-ADD-UPDATE THRU 2330-EXIT.
 11273
 11274 2320-EXIT.
 11275     EXIT.
 11276
 11277 2330-ADD-UPDATE.
 11278
 11279     IF COUNT-2 GREATER THAN 1
 11280        COMPUTE MISC-SUB = (COUNT-2 - 1)
 11281        IF AT-OPEN-CLOSE-TYPE (MISC-SUB) = STATUSI
 11282           GO TO 2330-EXIT.
 11283
 11284     MOVE SAVE-BIN-DATE         TO AT-OPEN-CLOSE-DATE (COUNT-2)
 11285                                   AT-RESERVES-LAST-MAINT-DT
 11286
 11287     MOVE PI-PROCESSOR-ID       TO AT-RESERVES-LAST-UPDATED-BY
 11288     MOVE EIBTIME               TO AT-LAST-MAINT-HHMMSS
 11289     MOVE STATUSI               TO AT-OPEN-CLOSE-TYPE (COUNT-2)
 11290     MOVE 'ALTER'               TO AT-OPEN-CLOSE-REASON (COUNT-2).
 11291
 11292 2330-EXIT.
 11293     EXIT.
 11294
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 210
* EL131.cbl
 11296 2400-UPDATE-TRLR.
 11297
 11298* EXEC CICS HANDLE CONDITION
 11299*         NOTFND    (2400-TRLR-NOTFND)
 11300*         ENDFILE   (2410-EXIT)
 11301*    END-EXEC.
 11302*    MOVE '"$I''                  ! 4 #00010166' TO DFHEIV0
 11303     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11304     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11305     MOVE X'3420233030303130313636' TO DFHEIV0(25:11)
 11306     CALL 'kxdfhei1' USING DFHEIV0
 11307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11308
 11309
 11310
 11311* EXEC CICS STARTBR
 11312*        DATASET (TRLR-FILE-ID)
 11313*        RIDFLD  (TRLR-KEY)
 11314*    END-EXEC.
 11315     MOVE 0
 11316       TO DFHEIV11
 11317*    MOVE '&,         G          &   #00010171' TO DFHEIV0
 11318     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11319     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11320     MOVE X'2020233030303130313731' TO DFHEIV0(25:11)
 11321     CALL 'kxdfhei1' USING DFHEIV0,
 11322           TRLR-FILE-ID,
 11323           TRLR-KEY,
 11324           DFHEIV99,
 11325           DFHEIV11,
 11326           DFHEIV99
 11327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11328
 11329
 11330
 11331* EXEC CICS GETMAIN
 11332*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11333*         LENGTH    (TRLR-LENGTH)
 11334*         INITIMG   (GETMAIN-SPACE)
 11335*    END-EXEC.
 11336*    MOVE ',"IL                  $   #00010176' TO DFHEIV0
 11337     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11338     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11339     MOVE X'2020233030303130313736' TO DFHEIV0(25:11)
 11340     CALL 'kxdfhei1' USING DFHEIV0,
 11341           DFHEIV20,
 11342           TRLR-LENGTH,
 11343           GETMAIN-SPACE
 11344     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11345         DFHEIV20
 11346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11347
 11348
 11349     PERFORM 2410-CHANGE-TRLR THRU 2410-EXIT.
 11350
 11351
 11352* EXEC CICS ENDBR
 11353*        DATASET (TRLR-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 211
* EL131.cbl
 11354*    END-EXEC.
 11355     MOVE 0
 11356       TO DFHEIV11
 11357*    MOVE '&2                    $   #00010184' TO DFHEIV0
 11358     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11359     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11360     MOVE X'2020233030303130313834' TO DFHEIV0(25:11)
 11361     CALL 'kxdfhei1' USING DFHEIV0,
 11362           TRLR-FILE-ID,
 11363           DFHEIV11,
 11364           DFHEIV99
 11365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11366
 11367
 11368     GO TO 2400-EXIT.
 11369
 11370 2400-TRLR-NOTFND.
 11371     MOVE ER-0205                TO EMI-ERROR.
 11372     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11373     MOVE 'X'                    TO ERROR-SWITCH.
 11374
 11375 2400-EXIT.
 11376     EXIT.
 11377
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 212
* EL131.cbl
 11379 2410-CHANGE-TRLR.
 11380
 11381* EXEC CICS READNEXT
 11382*        DATASET (TRLR-FILE-ID)
 11383*        RIDFLD  (TRLR-KEY)
 11384*        INTO    (ACTIVITY-TRAILERS)
 11385*    END-EXEC.
 11386     MOVE LENGTH OF
 11387      ACTIVITY-TRAILERS
 11388       TO DFHEIV12
 11389     MOVE 0
 11390       TO DFHEIV11
 11391*    MOVE '&.IL                  )   #00010200' TO DFHEIV0
 11392     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11393     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11394     MOVE X'2020233030303130323030' TO DFHEIV0(25:11)
 11395     CALL 'kxdfhei1' USING DFHEIV0,
 11396           TRLR-FILE-ID,
 11397           ACTIVITY-TRAILERS,
 11398           DFHEIV12,
 11399           TRLR-KEY,
 11400           DFHEIV99,
 11401           DFHEIV11,
 11402           DFHEIV99,
 11403           DFHEIV99
 11404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11405
 11406
 11407     IF AT-CONTROL-PRIMARY = WS-LAST-TRLR-KEY
 11408        GO TO 2410-CHANGE-TRLR.
 11409
 11410     MOVE AT-CONTROL-PRIMARY     TO WS-LAST-TRLR-KEY
 11411                                    CHECK-KEY.
 11412
 11413     IF CHECK-KEY NOT = MSTR-KEY
 11414         GO TO 2410-EXIT.
 11415
 11416
 11417* EXEC CICS ENDBR
 11418*        DATASET (TRLR-FILE-ID)
 11419*    END-EXEC.
 11420     MOVE 0
 11421       TO DFHEIV11
 11422*    MOVE '&2                    $   #00010215' TO DFHEIV0
 11423     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11424     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11425     MOVE X'2020233030303130323135' TO DFHEIV0(25:11)
 11426     CALL 'kxdfhei1' USING DFHEIV0,
 11427           TRLR-FILE-ID,
 11428           DFHEIV11,
 11429           DFHEIV99
 11430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11431
 11432
 11433
 11434* EXEC CICS READ UPDATE
 11435*        DATASET (TRLR-FILE-ID)
 11436*        RIDFLD  (TRLR-KEY)
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 213
* EL131.cbl
 11437*        INTO    (ACTIVITY-TRAILERS)
 11438*    END-EXEC.
 11439     MOVE LENGTH OF
 11440      ACTIVITY-TRAILERS
 11441       TO DFHEIV11
 11442*    MOVE '&"IL       EU         (   #00010219' TO DFHEIV0
 11443     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11444     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11445     MOVE X'2020233030303130323139' TO DFHEIV0(25:11)
 11446     CALL 'kxdfhei1' USING DFHEIV0,
 11447           TRLR-FILE-ID,
 11448           ACTIVITY-TRAILERS,
 11449           DFHEIV11,
 11450           TRLR-KEY,
 11451           DFHEIV99,
 11452           DFHEIV99,
 11453           DFHEIV99
 11454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11455
 11456
 11457
 11458* EXEC CICS DELETE
 11459*        DATASET (TRLR-FILE-ID)
 11460*    END-EXEC.
 11461*    MOVE '&(                    &   #00010225' TO DFHEIV0
 11462     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11463     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11464     MOVE X'2020233030303130323235' TO DFHEIV0(25:11)
 11465     CALL 'kxdfhei1' USING DFHEIV0,
 11466           TRLR-FILE-ID,
 11467           DFHEIV99,
 11468           DFHEIV99,
 11469           DFHEIV99,
 11470           DFHEIV99
 11471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11472
 11473
 11474     IF AT-SEQUENCE-NO = ZERO AND
 11475        TRLR-UPDATE-REQUIRED
 11476         PERFORM 2420-UPDATE-TRLR THRU 2420-EXIT.
 11477
 11478     IF CERTI GREATER THAN LOW-VALUES
 11479        MOVE CERTI               TO AT-CERT-PRIME.
 11480
 11481     IF SUFXI GREATER THAN LOW-VALUES
 11482        MOVE SUFXI               TO AT-CERT-SFX.
 11483
 11484     IF CERTCARI GREATER THAN LOW-VALUES
 11485        MOVE CERTCARI            TO AT-CARRIER.
 11486
 11487     IF PAYMENT-TR
 11488        IF AT-CHECK-QUE-CONTROL NOT = ZEROS
 11489           AND AT-CHECK-QUE-CONTROL NOT = 99999999
 11490              PERFORM 2460-UPDATE-CHECKQ THRU 2460-EXIT.
 11491
 11492     IF CORRESPONDENCE-TR
 11493        AND AT-LETTER-ARCHIVE-NO NOT = ZEROS
 11494           PERFORM 2475-UPDATE-LETTER THRU 2475-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 214
* EL131.cbl
 11495
 11496
 11497* EXEC CICS WRITE
 11498*         DATASET  (TRLR-FILE-ID)
 11499*         RIDFLD   (AT-CONTROL-PRIMARY)
 11500*         FROM     (ACTIVITY-TRAILERS)
 11501*    END-EXEC.
 11502     MOVE LENGTH OF
 11503      ACTIVITY-TRAILERS
 11504       TO DFHEIV11
 11505*    MOVE '&$ L                  ''   #00010251' TO DFHEIV0
 11506     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11507     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11508     MOVE X'2020233030303130323531' TO DFHEIV0(25:11)
 11509     CALL 'kxdfhei1' USING DFHEIV0,
 11510           TRLR-FILE-ID,
 11511           ACTIVITY-TRAILERS,
 11512           DFHEIV11,
 11513           AT-CONTROL-PRIMARY,
 11514           DFHEIV99,
 11515           DFHEIV99
 11516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11517
 11518
 11519
 11520* EXEC CICS STARTBR
 11521*         DATASET  (TRLR-FILE-ID)
 11522*         RIDFLD   (TRLR-KEY)
 11523*    END-EXEC.
 11524     MOVE 0
 11525       TO DFHEIV11
 11526*    MOVE '&,         G          &   #00010257' TO DFHEIV0
 11527     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11528     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11529     MOVE X'2020233030303130323537' TO DFHEIV0(25:11)
 11530     CALL 'kxdfhei1' USING DFHEIV0,
 11531           TRLR-FILE-ID,
 11532           TRLR-KEY,
 11533           DFHEIV99,
 11534           DFHEIV11,
 11535           DFHEIV99
 11536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11537
 11538
 11539     GO TO 2410-CHANGE-TRLR.
 11540
 11541 2410-EXIT.
 11542     EXIT.
 11543
 11544 2420-UPDATE-TRLR.
 11545     MOVE ZERO TO COUNT-2.
 11546     PERFORM 2310-INS-STATUS THRU 2310-EXIT
 11547         UNTIL UPDATE-MADE OR COUNT-2 GREATER THAN 6.
 11548
 11549     IF NOT UPDATE-MADE
 11550         PERFORM 2320-SHIFT-STATUS THRU 2320-EXIT.
 11551
 11552 2420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 215
* EL131.cbl
 11553     EXIT.
 11554
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 216
* EL131.cbl
 11556 2425-UPDATE-NINETY-TRLR.
 11557
 11558     MOVE +90                    TO TRLR-SEQ-NO.
 11559
 11560
 11561* EXEC CICS HANDLE CONDITION
 11562*         NOTFND    (2425-NINETY-NOTFND)
 11563*         ENDFILE   (2425-NINETY-NOTFND)
 11564*    END-EXEC.
 11565*    MOVE '"$I''                  ! 5 #00010283' TO DFHEIV0
 11566     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11567     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11568     MOVE X'3520233030303130323833' TO DFHEIV0(25:11)
 11569     CALL 'kxdfhei1' USING DFHEIV0
 11570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11571
 11572
 11573
 11574* EXEC CICS READ UPDATE
 11575*        DATASET (TRLR-FILE-ID)
 11576*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 11577*        RIDFLD  (TRLR-KEY)
 11578*    END-EXEC.
 11579*    MOVE '&"S        EU         (   #00010288' TO DFHEIV0
 11580     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11581     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11582     MOVE X'2020233030303130323838' TO DFHEIV0(25:11)
 11583     CALL 'kxdfhei1' USING DFHEIV0,
 11584           TRLR-FILE-ID,
 11585           DFHEIV20,
 11586           DFHEIV99,
 11587           TRLR-KEY,
 11588           DFHEIV99,
 11589           DFHEIV99,
 11590           DFHEIV99
 11591     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11592         DFHEIV20
 11593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11594
 11595
 11596     MOVE AT-INFO-LINE-1        TO WS-DIAGNOSIS.
 11597
 11598     MOVE DIAGI                 TO AT-INFO-LINE-1.
 11599
 11600
 11601* EXEC CICS REWRITE
 11602*        DATASET (TRLR-FILE-ID)
 11603*        FROM    (ACTIVITY-TRAILERS)
 11604*    END-EXEC.
 11605     MOVE LENGTH OF
 11606      ACTIVITY-TRAILERS
 11607       TO DFHEIV11
 11608*    MOVE '&& L                  %   #00010298' TO DFHEIV0
 11609     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11610     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11611     MOVE X'2020233030303130323938' TO DFHEIV0(25:11)
 11612     CALL 'kxdfhei1' USING DFHEIV0,
 11613           TRLR-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 217
* EL131.cbl
 11614           ACTIVITY-TRAILERS,
 11615           DFHEIV11,
 11616           DFHEIV99
 11617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11618
 11619
 11620     IF DIAGI NOT = WS-DIAGNOSIS
 11621         MOVE 'DIAGNOSIS'          TO SPLIT-INFO-DESC
 11622         MOVE WS-DIAGNOSIS         TO SPLIT-INFO-OLD
 11623         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 11624
 11625     GO TO 2425-EXIT.
 11626
 11627 2425-NINETY-NOTFND.
 11628
 11629
 11630* EXEC CICS GETMAIN
 11631*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 11632*         LENGTH    (TRLR-LENGTH)
 11633*         INITIMG   (GETMAIN-SPACE)
 11634*    END-EXEC.
 11635*    MOVE ',"IL                  $   #00010312' TO DFHEIV0
 11636     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11637     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11638     MOVE X'2020233030303130333132' TO DFHEIV0(25:11)
 11639     CALL 'kxdfhei1' USING DFHEIV0,
 11640           DFHEIV20,
 11641           TRLR-LENGTH,
 11642           GETMAIN-SPACE
 11643     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11644         DFHEIV20
 11645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11646
 11647
 11648     MOVE +90                  TO TRLR-SEQ-NO.
 11649     MOVE TRLR-KEY             TO AT-CONTROL-PRIMARY.
 11650
 11651     MOVE 'AT'                 TO AT-RECORD-ID
 11652     MOVE '6'                  TO AT-TRAILER-TYPE
 11653     MOVE SAVE-BIN-DATE        TO AT-RECORDED-DT
 11654                                  AT-GEN-INFO-LAST-MAINT-DT
 11655     MOVE PI-PROCESSOR-ID      TO AT-RECORDED-BY
 11656                                  AT-GEN-INFO-LAST-UPDATED-BY
 11657     MOVE EIBTIME              TO AT-LAST-MAINT-HHMMSS
 11658     MOVE DIAGI                TO AT-INFO-LINE-1.
 11659
 11660
 11661* EXEC CICS WRITE
 11662*        DATASET (TRLR-FILE-ID)
 11663*        FROM    (ACTIVITY-TRAILERS)
 11664*        RIDFLD  (TRLR-KEY)
 11665*    END-EXEC.
 11666     MOVE LENGTH OF
 11667      ACTIVITY-TRAILERS
 11668       TO DFHEIV11
 11669*    MOVE '&$ L                  ''   #00010330' TO DFHEIV0
 11670     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11671     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 218
* EL131.cbl
 11672     MOVE X'2020233030303130333330' TO DFHEIV0(25:11)
 11673     CALL 'kxdfhei1' USING DFHEIV0,
 11674           TRLR-FILE-ID,
 11675           ACTIVITY-TRAILERS,
 11676           DFHEIV11,
 11677           TRLR-KEY,
 11678           DFHEIV99,
 11679           DFHEIV99
 11680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11681
 11682
 11683 2425-EXIT.
 11684     EXIT.
 11685
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 219
* EL131.cbl
 11687 2430-UPDATE-ACTQ.
 11688
 11689* EXEC CICS HANDLE CONDITION
 11690*         NOTFND    (2430-EXIT)
 11691*         ENDFILE   (2440-EXIT)
 11692*    END-EXEC.
 11693*    MOVE '"$I''                  ! 6 #00010341' TO DFHEIV0
 11694     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11695     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11696     MOVE X'3620233030303130333431' TO DFHEIV0(25:11)
 11697     CALL 'kxdfhei1' USING DFHEIV0
 11698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11699
 11700
 11701
 11702* EXEC CICS STARTBR
 11703*         DATASET  (ACTQ-FILE-ID)
 11704*         RIDFLD   (ACTQ-KEY)
 11705*    END-EXEC.
 11706     MOVE 0
 11707       TO DFHEIV11
 11708*    MOVE '&,         G          &   #00010346' TO DFHEIV0
 11709     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11710     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11711     MOVE X'2020233030303130333436' TO DFHEIV0(25:11)
 11712     CALL 'kxdfhei1' USING DFHEIV0,
 11713           ACTQ-FILE-ID,
 11714           ACTQ-KEY,
 11715           DFHEIV99,
 11716           DFHEIV11,
 11717           DFHEIV99
 11718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11719
 11720
 11721
 11722* EXEC CICS GETMAIN
 11723*         SET      (ADDRESS OF ACTIVITY-QUE)
 11724*         LENGTH   (ACTQ-LENGTH)
 11725*         INITIMG  (GETMAIN-SPACE)
 11726*    END-EXEC.
 11727*    MOVE ',"IL                  $   #00010351' TO DFHEIV0
 11728     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11729     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11730     MOVE X'2020233030303130333531' TO DFHEIV0(25:11)
 11731     CALL 'kxdfhei1' USING DFHEIV0,
 11732           DFHEIV20,
 11733           ACTQ-LENGTH,
 11734           GETMAIN-SPACE
 11735     SET ADDRESS OF ACTIVITY-QUE TO
 11736         DFHEIV20
 11737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11738
 11739
 11740     PERFORM 2440-CHANGE-ACTQ THRU 2440-EXIT.
 11741
 11742 2430-EXIT.
 11743     EXIT.
 11744
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 220
* EL131.cbl
 11745 2440-CHANGE-ACTQ.
 11746
 11747
 11748* EXEC CICS READNEXT
 11749*         DATASET  (ACTQ-FILE-ID)
 11750*         RIDFLD   (ACTQ-KEY)
 11751*         INTO     (ACTIVITY-QUE)
 11752*    END-EXEC.
 11753     MOVE LENGTH OF
 11754      ACTIVITY-QUE
 11755       TO DFHEIV12
 11756     MOVE 0
 11757       TO DFHEIV11
 11758*    MOVE '&.IL                  )   #00010364' TO DFHEIV0
 11759     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11760     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11761     MOVE X'2020233030303130333634' TO DFHEIV0(25:11)
 11762     CALL 'kxdfhei1' USING DFHEIV0,
 11763           ACTQ-FILE-ID,
 11764           ACTIVITY-QUE,
 11765           DFHEIV12,
 11766           ACTQ-KEY,
 11767           DFHEIV99,
 11768           DFHEIV11,
 11769           DFHEIV99,
 11770           DFHEIV99
 11771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11772
 11773
 11774
 11775* EXEC CICS ENDBR
 11776*         DATASET (ACTQ-FILE-ID)
 11777*    END-EXEC.
 11778     MOVE 0
 11779       TO DFHEIV11
 11780*    MOVE '&2                    $   #00010370' TO DFHEIV0
 11781     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11782     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11783     MOVE X'2020233030303130333730' TO DFHEIV0(25:11)
 11784     CALL 'kxdfhei1' USING DFHEIV0,
 11785           ACTQ-FILE-ID,
 11786           DFHEIV11,
 11787           DFHEIV99
 11788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11789
 11790
 11791     IF ACTQ-KEY NOT = MSTR-KEY
 11792         GO TO 2440-EXIT.
 11793
 11794
 11795* EXEC CICS READ UPDATE
 11796*         DATASET  (ACTQ-FILE-ID)
 11797*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11798*         SET      (ADDRESS OF ACTIVITY-QUE)
 11799*    END-EXEC.
 11800*    MOVE '&"S        EU         (   #00010377' TO DFHEIV0
 11801     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11802     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 221
* EL131.cbl
 11803     MOVE X'2020233030303130333737' TO DFHEIV0(25:11)
 11804     CALL 'kxdfhei1' USING DFHEIV0,
 11805           ACTQ-FILE-ID,
 11806           DFHEIV20,
 11807           DFHEIV99,
 11808           AQ-CONTROL-PRIMARY,
 11809           DFHEIV99,
 11810           DFHEIV99,
 11811           DFHEIV99
 11812     SET ADDRESS OF ACTIVITY-QUE TO
 11813         DFHEIV20
 11814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11815
 11816
 11817     MOVE ACTIVITY-QUE           TO JP-RECORD-AREA
 11818
 11819
 11820* EXEC CICS DELETE
 11821*         DATASET (ACTQ-FILE-ID)
 11822*    END-EXEC.
 11823*    MOVE '&(                    &   #00010385' TO DFHEIV0
 11824     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11825     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11826     MOVE X'2020233030303130333835' TO DFHEIV0(25:11)
 11827     CALL 'kxdfhei1' USING DFHEIV0,
 11828           ACTQ-FILE-ID,
 11829           DFHEIV99,
 11830           DFHEIV99,
 11831           DFHEIV99,
 11832           DFHEIV99
 11833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11834
 11835
 11836     MOVE JP-RECORD-AREA         TO ACTIVITY-QUE.
 11837     IF CERTI GREATER THAN LOW-VALUES
 11838        MOVE CERTI               TO AQ-CERT-PRIME.
 11839     IF SUFXI GREATER THAN LOW-VALUES
 11840        MOVE SUFXI               TO AQ-CERT-SFX.
 11841     IF CERTCARI GREATER THAN LOW-VALUES
 11842        MOVE CERTCARI            TO AQ-CARRIER.
 11843
 11844
 11845* EXEC CICS HANDLE CONDITION
 11846*         DUPREC   (2440-EXIT)
 11847*    END-EXEC.
 11848*    MOVE '"$%                   ! 7 #00010397' TO DFHEIV0
 11849     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 11850     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11851     MOVE X'3720233030303130333937' TO DFHEIV0(25:11)
 11852     CALL 'kxdfhei1' USING DFHEIV0
 11853     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11854
 11855
 11856
 11857* EXEC CICS WRITE
 11858*         DATASET  (ACTQ-FILE-ID)
 11859*         RIDFLD   (AQ-CONTROL-PRIMARY)
 11860*         FROM     (ACTIVITY-QUE)
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 222
* EL131.cbl
 11861*    END-EXEC.
 11862     MOVE LENGTH OF
 11863      ACTIVITY-QUE
 11864       TO DFHEIV11
 11865*    MOVE '&$ L                  ''   #00010401' TO DFHEIV0
 11866     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11867     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11868     MOVE X'2020233030303130343031' TO DFHEIV0(25:11)
 11869     CALL 'kxdfhei1' USING DFHEIV0,
 11870           ACTQ-FILE-ID,
 11871           ACTIVITY-QUE,
 11872           DFHEIV11,
 11873           AQ-CONTROL-PRIMARY,
 11874           DFHEIV99,
 11875           DFHEIV99
 11876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11877
 11878
 11879 2440-EXIT.
 11880     EXIT.
 11881
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 223
* EL131.cbl
 11883 2460-UPDATE-CHECKQ.
 11884
 11885* EXEC CICS HANDLE CONDITION
 11886*         NOTFND   (2460-EXIT)
 11887*    END-EXEC.
 11888*    MOVE '"$I                   ! 8 #00010412' TO DFHEIV0
 11889     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11890     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11891     MOVE X'3820233030303130343132' TO DFHEIV0(25:11)
 11892     CALL 'kxdfhei1' USING DFHEIV0
 11893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11894
 11895
 11896     MOVE AT-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NO.
 11897     MOVE AT-CHECK-QUE-SEQUENCE  TO CHKQ-SEQ-NO.
 11898     MOVE PI-COMPANY-CD          TO CHKQ-COMPANY-CODE.
 11899
 11900
 11901* EXEC CICS READ UPDATE
 11902*         DATASET   (CHKQ-FILE-ID)
 11903*         RIDFLD    (CHKQ-KEY)
 11904*         SET       (ADDRESS OF CHECK-QUE)
 11905*    END-EXEC.
 11906*    MOVE '&"S        EU         (   #00010420' TO DFHEIV0
 11907     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11908     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11909     MOVE X'2020233030303130343230' TO DFHEIV0(25:11)
 11910     CALL 'kxdfhei1' USING DFHEIV0,
 11911           CHKQ-FILE-ID,
 11912           DFHEIV20,
 11913           DFHEIV99,
 11914           CHKQ-KEY,
 11915           DFHEIV99,
 11916           DFHEIV99,
 11917           DFHEIV99
 11918     SET ADDRESS OF CHECK-QUE TO
 11919         DFHEIV20
 11920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11921
 11922
 11923     IF CERTI GREATER THAN LOW-VALUES
 11924        MOVE CERTI               TO CQ-CERT-PRIME.
 11925     IF SUFXI GREATER THAN LOW-VALUES
 11926        MOVE SUFXI               TO CQ-CERT-SFX.
 11927     IF CERTCARI GREATER THAN LOW-VALUES
 11928        MOVE CERTCARI            TO CQ-CARRIER.
 11929
 11930
 11931* EXEC CICS REWRITE
 11932*         DATASET  (CHKQ-FILE-ID)
 11933*         FROM     (CHECK-QUE)
 11934*    END-EXEC.
 11935     MOVE LENGTH OF
 11936      CHECK-QUE
 11937       TO DFHEIV11
 11938*    MOVE '&& L                  %   #00010433' TO DFHEIV0
 11939     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11940     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 224
* EL131.cbl
 11941     MOVE X'2020233030303130343333' TO DFHEIV0(25:11)
 11942     CALL 'kxdfhei1' USING DFHEIV0,
 11943           CHKQ-FILE-ID,
 11944           CHECK-QUE,
 11945           DFHEIV11,
 11946           DFHEIV99
 11947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11948
 11949
 11950 2460-EXIT.
 11951     EXIT.
 11952
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 225
* EL131.cbl
 11954 2475-UPDATE-LETTER.
 11955
 11956* EXEC CICS HANDLE CONDITION
 11957*         NOTFND   (2475-EXIT)
 11958*    END-EXEC.
 11959*    MOVE '"$I                   ! 9 #00010443' TO DFHEIV0
 11960     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11961     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11962     MOVE X'3920233030303130343433' TO DFHEIV0(25:11)
 11963     CALL 'kxdfhei1' USING DFHEIV0
 11964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11965
 11966
 11967     MOVE AT-LETTER-ARCHIVE-NO   TO ARCH-ARCHIVE-NO.
 11968     MOVE '1'                    TO ARCH-RECORD-TYPE.
 11969     MOVE ZEROS                  TO ARCH-SEQ-NO.
 11970     MOVE PI-COMPANY-CD          TO ARCH-COMPANY-CODE.
 11971
 11972
 11973* EXEC CICS READ UPDATE
 11974*         DATASET   (ARCH-FILE-ID)
 11975*         RIDFLD    (ARCH-KEY)
 11976*         SET       (ADDRESS OF LETTER-ARCHIVE)
 11977*    END-EXEC.
 11978*    MOVE '&"S        EU         (   #00010452' TO DFHEIV0
 11979     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11980     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11981     MOVE X'2020233030303130343532' TO DFHEIV0(25:11)
 11982     CALL 'kxdfhei1' USING DFHEIV0,
 11983           ARCH-FILE-ID,
 11984           DFHEIV20,
 11985           DFHEIV99,
 11986           ARCH-KEY,
 11987           DFHEIV99,
 11988           DFHEIV99,
 11989           DFHEIV99
 11990     SET ADDRESS OF LETTER-ARCHIVE TO
 11991         DFHEIV20
 11992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11993
 11994
 11995* COMPARE LETTER HEADER INFORMATION TO ASSURE THAT IT BELONGS
 11996* TO THIS MASTER-KEY INFORMATION.
 11997
 11998     IF LA-CARRIER  = CARRIER-CODE AND
 11999        LA-CLAIM-NO = CLAIM-NO     AND
 12000        LA-CERT-NO  = CERT-NO
 12001        NEXT SENTENCE
 12002     ELSE
 12003        GO TO 2475-UNLOCK.
 12004
 12005     IF CERTI GREATER THAN LOW-VALUES
 12006        MOVE CERTI               TO LA-CERT-PRIME.
 12007     IF SUFXI GREATER THAN LOW-VALUES
 12008        MOVE SUFXI               TO LA-CERT-SFX.
 12009     IF CERTCARI GREATER THAN LOW-VALUES
 12010        MOVE CERTCARI            TO LA-CARRIER.
 12011
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 226
* EL131.cbl
 12012
 12013* EXEC CICS REWRITE
 12014*         DATASET  (ARCH-FILE-ID)
 12015*         FROM     (LETTER-ARCHIVE)
 12016*    END-EXEC.
 12017     MOVE LENGTH OF
 12018      LETTER-ARCHIVE
 12019       TO DFHEIV11
 12020*    MOVE '&& L                  %   #00010475' TO DFHEIV0
 12021     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12022     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12023     MOVE X'2020233030303130343735' TO DFHEIV0(25:11)
 12024     CALL 'kxdfhei1' USING DFHEIV0,
 12025           ARCH-FILE-ID,
 12026           LETTER-ARCHIVE,
 12027           DFHEIV11,
 12028           DFHEIV99
 12029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12030
 12031
 12032     GO TO 2475-EXIT.
 12033
 12034 2475-UNLOCK.
 12035
 12036* EXEC CICS UNLOCK
 12037*         DATASET  (ARCH-FILE-ID)
 12038*    END-EXEC.
 12039*    MOVE '&*                    #   #00010483' TO DFHEIV0
 12040     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12041     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12042     MOVE X'2020233030303130343833' TO DFHEIV0(25:11)
 12043     CALL 'kxdfhei1' USING DFHEIV0,
 12044           ARCH-FILE-ID,
 12045           DFHEIV99
 12046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12047
 12048
 12049 2475-EXIT.
 12050     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 227
* EL131.cbl
 12052 2600-CREATE-MAINT-NOTE.
 12053     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 12054     MOVE '1'                    TO CNTL-REC-TYPE.
 12055     MOVE SPACES                 TO CNTL-PROC-ID.
 12056     MOVE ZERO                   TO CNTL-SEQ-NO.
 12057
 12058
 12059* EXEC CICS READ
 12060*         SET        (ADDRESS OF CONTROL-FILE)
 12061*         DATASET    ('ELCNTL')
 12062*         RIDFLD     (CNTL-KEY)
 12063*    END-EXEC.
 12064     MOVE 'ELCNTL' TO DFHEIV1
 12065*    MOVE '&"S        E          (   #00010496' TO DFHEIV0
 12066     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12067     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12068     MOVE X'2020233030303130343936' TO DFHEIV0(25:11)
 12069     CALL 'kxdfhei1' USING DFHEIV0,
 12070           DFHEIV1,
 12071           DFHEIV20,
 12072           DFHEIV99,
 12073           CNTL-KEY,
 12074           DFHEIV99,
 12075           DFHEIV99,
 12076           DFHEIV99
 12077     SET ADDRESS OF CONTROL-FILE TO
 12078         DFHEIV20
 12079     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12080
 12081
 12082     IF CO-NO-USE-AUDIT-CHANGES
 12083         GO TO 2600-EXIT.
 12084
 12085     IF PROCL GREATER ZERO
 12086     IF PROCI NOT = LOW-VALUES
 12087     IF PROCI NOT = CL-PROCESSOR-ID
 12088         MOVE 'PROCESSOR'          TO SPLIT-INFO-DESC
 12089         MOVE CL-PROCESSOR-ID      TO SPLIT-INFO-OLD
 12090         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12091
 12092     IF SEXL GREATER ZERO
 12093     IF SEXI NOT = LOW-VALUES
 12094     IF SEXI NOT = CL-INSURED-SEX-CD
 12095         MOVE 'SEX'                TO SPLIT-INFO-DESC
 12096         MOVE CL-INSURED-SEX-CD    TO SPLIT-INFO-OLD
 12097         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12098
 12099     IF BIRTHL GREATER ZERO
 12100     IF HOLD-BIRTH NOT = LOW-VALUES
 12101     IF HOLD-BIRTH NOT = CL-INSURED-BIRTH-DT
 12102         MOVE 'BIRTH'              TO SPLIT-INFO-DESC
 12103         MOVE CL-INSURED-BIRTH-DT  TO DC-BIN-DATE-1
 12104         MOVE SPACES               TO DC-OPTION-CODE
 12105         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12106         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12107         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12108
 12109     IF SOCIALL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 228
* EL131.cbl
 12110     IF SOCIALI NOT = LOW-VALUES
 12111     IF SOCIALI NOT = CL-SOC-SEC-NO
 12112         MOVE 'SOC SEC NO'         TO SPLIT-INFO-DESC
 12113         MOVE CL-SOC-SEC-NO        TO SPLIT-INFO-OLD
 12114         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12115
 12116     IF OCCL GREATER ZERO
 12117     IF OCCI NOT = LOW-VALUES
 12118     IF OCCI NOT = CL-INSURED-OCC-CD
 12119         MOVE 'OCCUPATION'         TO SPLIT-INFO-DESC
 12120         MOVE CL-INSURED-OCC-CD    TO SPLIT-INFO-OLD
 12121         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12122
 12123     IF BENEL GREATER ZERO
 12124     IF BENEI NOT = LOW-VALUES
 12125     IF BENEI NOT = CL-BENEFICIARY
 12126         MOVE 'BENEFICIARY'        TO SPLIT-INFO-DESC
 12127         MOVE CL-BENEFICIARY      TO SPLIT-INFO-OLD
 12128         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12129
 12130     IF PREMTYPL GREATER ZERO
 12131     IF PREMTYPI NOT = LOW-VALUES
 12132     IF PREMTYPI NOT = CL-CLAIM-PREM-TYPE
 12133         MOVE 'PREM TYPE'          TO SPLIT-INFO-DESC
 12134         MOVE CL-CLAIM-PREM-TYPE   TO SPLIT-INFO-OLD
 12135         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12136
 12137     IF CAUSEL GREATER ZERO
 12138     IF CAUSEI NOT = LOW-VALUES
 12139     IF CAUSEI NOT = CL-CAUSE-CD
 12140         MOVE 'CAUSE CD'           TO SPLIT-INFO-DESC
 12141         MOVE CL-CAUSE-CD          TO SPLIT-INFO-OLD
 12142         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12143
 12144     IF ENDL GREATER ZERO
 12145     IF HOLD-END NOT = LOW-VALUES
 12146     IF HOLD-END NOT = CL-EST-END-OF-DISAB-DT
 12147         MOVE 'END DT'             TO SPLIT-INFO-DESC
 12148         MOVE CL-EST-END-OF-DISAB-DT
 12149                                   TO DC-BIN-DATE-1
 12150         MOVE SPACES               TO DC-OPTION-CODE
 12151         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12152         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12153         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12154
 12155     IF PDTHRUL GREATER ZERO
 12156     IF HOLD-PDTHRU NOT = LOW-VALUES
 12157     IF HOLD-PDTHRU NOT = CL-PAID-THRU-DT
 12158         MOVE 'PAID THRU'          TO SPLIT-INFO-DESC
 12159         MOVE CL-PAID-THRU-DT      TO DC-BIN-DATE-1
 12160         MOVE SPACES               TO DC-OPTION-CODE
 12161         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12162         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12163         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12164
 12165     IF PDAMTL GREATER ZERO
 12166     IF HOLD-PDAMT NOT = ZEROS
 12167     IF HOLD-PDAMT NOT = CL-TOTAL-PAID-AMT
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 229
* EL131.cbl
 12168         MOVE 'PAID AMOUNT'        TO SPLIT-INFO-DESC
 12169         MOVE CL-TOTAL-PAID-AMT    TO WS-EDIT-AMT
 12170         MOVE WS-EDIT-AMT          TO SPLIT-INFO-OLD
 12171         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12172
 12173     IF NODAYSL GREATER ZERO
 12174     IF HOLD-NODAYS NOT = ZEROS
 12175     IF HOLD-NODAYS NOT = CL-NO-OF-DAYS-PAID
 12176         MOVE 'DAYS PAID'          TO SPLIT-INFO-DESC
 12177         MOVE CL-NO-OF-DAYS-PAID   TO WS-EDIT-NUMBER
 12178         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12179         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12180
 12181     IF NOPMTSL GREATER ZERO
 12182     IF HOLD-NOPMTS NOT = ZEROS
 12183     IF HOLD-NOPMTS NOT = CL-NO-OF-PMTS-MADE
 12184         MOVE 'PMTS MADE'          TO SPLIT-INFO-DESC
 12185         MOVE CL-NO-OF-PMTS-MADE   TO WS-EDIT-NUMBER
 12186         MOVE WS-EDIT-NUMBER       TO SPLIT-INFO-OLD
 12187         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12188
 12189     IF FORMTYPL GREATER ZERO
 12190     IF FORMTYPI NOT = LOW-VALUES
 12191     IF FORMTYPI NOT = CL-PROG-FORM-TYPE
 12192         MOVE 'FORM TYPE'          TO SPLIT-INFO-DESC
 12193         MOVE CL-PROG-FORM-TYPE    TO SPLIT-INFO-OLD
 12194         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12195
 12196     IF REPL GREATER ZERO
 12197     IF HOLD-REPORTED NOT = LOW-VALUES
 12198     IF HOLD-REPORTED NOT = CL-REPORTED-DT
 12199         MOVE 'REPORTED DT'        TO SPLIT-INFO-DESC
 12200         MOVE CL-REPORTED-DT       TO DC-BIN-DATE-1
 12201         MOVE SPACES               TO DC-OPTION-CODE
 12202         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12203         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12204         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12205
 12206     IF ADDONDTL GREATER ZERO
 12207     IF HOLD-ADDON NOT = LOW-VALUES
 12208     IF HOLD-ADDON NOT = CL-LAST-ADD-ON-DT
 12209         MOVE 'ADD ON DT'          TO SPLIT-INFO-DESC
 12210         MOVE CL-LAST-ADD-ON-DT    TO DC-BIN-DATE-1
 12211         MOVE SPACES               TO DC-OPTION-CODE
 12212         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12213         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12214         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12215
 12216     IF PRICDL GREATER ZERO
 12217     IF PRICDI NOT = LOW-VALUES
 12218     IF PRICDI NOT = CL-PRIORITY-CD
 12219         MOVE 'PRIORITY CODE'      TO SPLIT-INFO-DESC
 12220         MOVE CL-PRIORITY-CD       TO SPLIT-INFO-OLD
 12221         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12222
 12223     IF FILETOL GREATER ZERO
 12224     IF FILETOI NOT = LOW-VALUES
 12225     IF FILETOI NOT = CL-FILE-LOCATION
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 230
* EL131.cbl
 12226         MOVE 'FILE TO'            TO SPLIT-INFO-DESC
 12227         MOVE CL-FILE-LOCATION     TO SPLIT-INFO-OLD
 12228         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12229
 12230     IF SUPVL GREATER ZERO
 12231     IF SUPVI NOT = LOW-VALUES
 12232     IF SUPVI NOT = CL-SUPV-ATTN-CD
 12233         MOVE 'SUPV (Y/N)'         TO SPLIT-INFO-DESC
 12234         MOVE CL-SUPV-ATTN-CD      TO SPLIT-INFO-OLD
 12235         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12236     IF (CRITPTL > ZERO)
 12237        AND (CRITPTI NOT = LOW-VALUES)
 12238        AND (CRITPTI NOT = CL-CRIT-PER-RECURRENT)
 12239        MOVE 'CRIT PER RECURR'   TO SPLIT-INFO-DESC
 12240        MOVE CL-CRIT-PER-RECURRENT
 12241                                 TO SPLIT-INFO-OLD
 12242        PERFORM 2650-WRITE-MAINT-NOTE
 12243                                 THRU 2650-EXIT
 12244     END-IF
 12245
 12246     IF (RTWMOSL > ZERO)
 12247        AND (RTWMOSI NOT = LOW-VALUES)
 12248        AND (RTWMOSI NOT = CL-CRIT-PER-RTW-MOS)
 12249        MOVE 'CRIT PER RTW MO'   TO SPLIT-INFO-DESC
 12250        MOVE CL-CRIT-PER-RTW-MOS TO SPLIT-INFO-OLD
 12251        PERFORM 2650-WRITE-MAINT-NOTE
 12252                                 THRU 2650-EXIT
 12253     END-IF
 12254     IF MLNAMEL GREATER ZERO
 12255     IF MLNAMEI NOT = LOW-VALUES
 12256     IF MLNAMEI NOT = CL-INSURED-LAST-NAME
 12257         MOVE 'INS LAST NAME'      TO SPLIT-INFO-DESC
 12258         MOVE CL-INSURED-LAST-NAME TO SPLIT-INFO-OLD
 12259         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12260
 12261     IF MFNAMEL GREATER ZERO
 12262     IF MFNAMEI NOT = LOW-VALUES
 12263     IF MFNAMEI NOT = CL-INSURED-1ST-NAME
 12264         MOVE 'INS 1ST NAME'       TO SPLIT-INFO-DESC
 12265         MOVE CL-INSURED-1ST-NAME  TO SPLIT-INFO-OLD
 12266         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12267
 12268     IF MMINITL GREATER ZERO
 12269     IF MMINITI NOT = LOW-VALUES
 12270     IF MMINITI NOT = CL-INSURED-MID-INIT
 12271         MOVE 'INS MID INITL'      TO SPLIT-INFO-DESC
 12272         MOVE CL-INSURED-MID-INIT  TO SPLIT-INFO-OLD
 12273         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12274
 12275     IF CERTEFFL GREATER ZERO
 12276     IF HOLD-EFF NOT = LOW-VALUES
 12277     IF HOLD-EFF NOT = CL-CERT-EFF-DT
 12278         MOVE 'CERT EFF DT'        TO SPLIT-INFO-DESC
 12279         MOVE CL-CERT-EFF-DT       TO DC-BIN-DATE-1
 12280         MOVE SPACES               TO DC-OPTION-CODE
 12281         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 12282         MOVE DC-GREG-DATE-1-EDIT  TO SPLIT-INFO-OLD
 12283         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 231
* EL131.cbl
 12284
 12285     IF CERTACTL GREATER ZERO
 12286     IF CERTACTI NOT = LOW-VALUES
 12287     IF CERTACTI NOT = CL-CERT-ACCOUNT
 12288         MOVE 'CERT ACCOUNT'       TO SPLIT-INFO-DESC
 12289         MOVE CL-CERT-ACCOUNT      TO SPLIT-INFO-OLD
 12290         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12291
 12292     IF CERTSTL GREATER ZERO
 12293     IF CERTSTI NOT = LOW-VALUES
 12294     IF CERTSTI NOT = CL-CERT-STATE
 12295         MOVE 'CERT STATE'         TO SPLIT-INFO-DESC
 12296         MOVE CL-CERT-STATE        TO SPLIT-INFO-OLD
 12297         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12298
 12299     IF CERTCARL GREATER ZERO
 12300     IF CERTCARI NOT = LOW-VALUES
 12301     IF CERTCARI NOT = CL-CERT-CARRIER
 12302         MOVE 'CERT CARRIER'       TO SPLIT-INFO-DESC
 12303         MOVE CL-CERT-CARRIER      TO SPLIT-INFO-OLD
 12304         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12305
 12306     IF CERTGRPL GREATER ZERO
 12307     IF CERTGRPI NOT = LOW-VALUES
 12308     IF CERTGRPI NOT = CL-CERT-GROUPING
 12309         MOVE 'CERT GROUPING'      TO SPLIT-INFO-DESC
 12310         MOVE CL-CERT-GROUPING     TO SPLIT-INFO-OLD
 12311         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12312
 12313     IF CERTL GREATER ZERO OR
 12314        SUFXL GREATER ZERO
 12315     IF (CERTI NOT = LOW-VALUES AND
 12316                     CL-CERT-PRIME)
 12317                OR
 12318        (SUFXI NOT = LOW-VALUES AND
 12319                     CL-CERT-SFX)
 12320         MOVE 'CERT NO'            TO SPLIT-INFO-DESC
 12321         MOVE CL-CERT-NO           TO SPLIT-INFO-OLD
 12322         PERFORM 2650-WRITE-MAINT-NOTE THRU 2650-EXIT.
 12323
 12324 2600-EXIT.
 12325      EXIT.
 12326
 12327 2650-WRITE-MAINT-NOTE.
 12328
 12329* EXEC CICS GETMAIN
 12330*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12331*         LENGTH   (TRLR-LENGTH)
 12332*         INITIMG  (GETMAIN-SPACE)
 12333*    END-EXEC.
 12334*    MOVE ',"IL                  $   #00010748' TO DFHEIV0
 12335     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12336     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12337     MOVE X'2020233030303130373438' TO DFHEIV0(25:11)
 12338     CALL 'kxdfhei1' USING DFHEIV0,
 12339           DFHEIV20,
 12340           TRLR-LENGTH,
 12341           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 232
* EL131.cbl
 12342     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12343         DFHEIV20
 12344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12345
 12346
 12347
 12348* EXEC CICS HANDLE CONDITION
 12349*         DUPREC   (2650-EXIT)
 12350*    END-EXEC.
 12351*    MOVE '"$%                   ! : #00010754' TO DFHEIV0
 12352     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 12353     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12354     MOVE X'3A20233030303130373534' TO DFHEIV0(25:11)
 12355     CALL 'kxdfhei1' USING DFHEIV0
 12356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12357
 12358
 12359     MOVE SPACES             TO ACTIVITY-TRAILERS.
 12360
 12361     IF CERTL GREATER ZERO
 12362         MOVE CERTI          TO CL-CERT-PRIME.
 12363
 12364     IF SUFXL GREATER ZERO
 12365         MOVE SUFXI          TO CL-CERT-SFX.
 12366
 12367     MOVE CL-CONTROL-PRIMARY TO AT-CONTROL-PRIMARY.
 12368
 12369     SUBTRACT 1 FROM  CL-TRAILER-SEQ-CNT.
 12370     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO.
 12371
 12372     MOVE 'AT'               TO AT-RECORD-ID.
 12373
 12374     MOVE '6'                TO AT-TRAILER-TYPE.
 12375     MOVE SAVE-BIN-DATE      TO AT-RECORDED-DT
 12376                                AT-GEN-INFO-LAST-MAINT-DT.
 12377     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 12378                                AT-GEN-INFO-LAST-UPDATED-BY.
 12379     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS.
 12380     MOVE SPLIT-INFO-LINE-1  TO AT-INFO-LINE-1.
 12381     MOVE 'M'                TO AT-INFO-TRAILER-TYPE.
 12382
 12383
 12384* EXEC CICS WRITE
 12385*         DATASET  (TRLR-FILE-ID)
 12386*         RIDFLD   (AT-CONTROL-PRIMARY)
 12387*         FROM     (ACTIVITY-TRAILERS)
 12388*    END-EXEC.
 12389     MOVE LENGTH OF
 12390      ACTIVITY-TRAILERS
 12391       TO DFHEIV11
 12392*    MOVE '&$ L                  ''   #00010782' TO DFHEIV0
 12393     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12394     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12395     MOVE X'2020233030303130373832' TO DFHEIV0(25:11)
 12396     CALL 'kxdfhei1' USING DFHEIV0,
 12397           TRLR-FILE-ID,
 12398           ACTIVITY-TRAILERS,
 12399           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 233
* EL131.cbl
 12400           AT-CONTROL-PRIMARY,
 12401           DFHEIV99,
 12402           DFHEIV99
 12403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12404
 12405
 12406 2650-EXIT.
 12407      EXIT.
 12408
 12409 2800-CHECK-AUTO-PAY.
 12410
 12411     MOVE PI-COMPANY-CD      TO TRLR-COMPANY-CD.
 12412     MOVE PI-CARRIER         TO TRLR-CARRIER.
 12413     MOVE PI-CLAIM-NO        TO TRLR-CLAIM-NO.
 12414     MOVE PI-CERT-NO         TO TRLR-CERT-NO.
 12415     MOVE PI-AUTO-PAY-SEQ    TO TRLR-SEQ-NO.
 12416
 12417
 12418* EXEC CICS HANDLE CONDITION
 12419*         NOTFND    (2800-EXIT)
 12420*         ENDFILE   (2800-EXIT)
 12421*    END-EXEC.
 12422*    MOVE '"$I''                  ! ; #00010799' TO DFHEIV0
 12423     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12424     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12425     MOVE X'3B20233030303130373939' TO DFHEIV0(25:11)
 12426     CALL 'kxdfhei1' USING DFHEIV0
 12427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12428
 12429
 12430
 12431* EXEC CICS READ
 12432*        DATASET (TRLR-FILE-ID)
 12433*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
 12434*        RIDFLD  (TRLR-KEY)
 12435*    END-EXEC.
 12436*    MOVE '&"S        E          (   #00010804' TO DFHEIV0
 12437     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12438     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12439     MOVE X'2020233030303130383034' TO DFHEIV0(25:11)
 12440     CALL 'kxdfhei1' USING DFHEIV0,
 12441           TRLR-FILE-ID,
 12442           DFHEIV20,
 12443           DFHEIV99,
 12444           TRLR-KEY,
 12445           DFHEIV99,
 12446           DFHEIV99,
 12447           DFHEIV99
 12448     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12449         DFHEIV20
 12450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12451
 12452
 12453     IF BENEFICIARY-PAID-AUTO
 12454         MOVE 'Y'              TO AUTO-PAY-TO-BENE
 12455     END-IF.
 12456
 12457 2800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 234
* EL131.cbl
 12458      EXIT.
 12459
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 235
* EL131.cbl
 12461 3000-DELETE-CLAIM.
 12462     IF  NOT MODIFY-CAP
 12463         MOVE ER-0070            TO EMI-ERROR
 12464         MOVE -1                 TO MAINTL
 12465         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12466         GO TO 8110-SEND-DATA.
 12467
 12468
 12469* EXEC CICS READ
 12470*         SET      (ADDRESS OF CLAIM-MASTER)
 12471*         DATASET  (CLMS-FILE-ID)
 12472*         RIDFLD   (MSTR-KEY)
 12473*    END-EXEC.
 12474*    MOVE '&"S        E          (   #00010825' TO DFHEIV0
 12475     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12476     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12477     MOVE X'2020233030303130383235' TO DFHEIV0(25:11)
 12478     CALL 'kxdfhei1' USING DFHEIV0,
 12479           CLMS-FILE-ID,
 12480           DFHEIV20,
 12481           DFHEIV99,
 12482           MSTR-KEY,
 12483           DFHEIV99,
 12484           DFHEIV99,
 12485           DFHEIV99
 12486     SET ADDRESS OF CLAIM-MASTER TO
 12487         DFHEIV20
 12488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12489
 12490
 12491     IF CL-1ST-TRL-AVAIL
 12492         PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT
 12493     ELSE
 12494        MOVE MSTR-KEY            TO TRLR-MAIN-KEY
 12495        MOVE 0                   TO TRLR-SEQ-NO
 12496
 12497* EXEC CICS STARTBR
 12498*            DATASET (TRLR-FILE-ID)
 12499*            RIDFLD  (TRLR-KEY)
 12500*        END-EXEC
 12501     MOVE 0
 12502       TO DFHEIV11
 12503*    MOVE '&,         G          &   #00010836' TO DFHEIV0
 12504     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12505     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12506     MOVE X'2020233030303130383336' TO DFHEIV0(25:11)
 12507     CALL 'kxdfhei1' USING DFHEIV0,
 12508           TRLR-FILE-ID,
 12509           TRLR-KEY,
 12510           DFHEIV99,
 12511           DFHEIV11,
 12512           DFHEIV99
 12513     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12514         PERFORM 3060-READ-TRLR THRU 3060-EXIT
 12515
 12516* EXEC CICS ENDBR
 12517*            DATASET (TRLR-FILE-ID)
 12518*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 236
* EL131.cbl
 12519     MOVE 0
 12520       TO DFHEIV11
 12521*    MOVE '&2                    $   #00010841' TO DFHEIV0
 12522     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12523     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12524     MOVE X'2020233030303130383431' TO DFHEIV0(25:11)
 12525     CALL 'kxdfhei1' USING DFHEIV0,
 12526           TRLR-FILE-ID,
 12527           DFHEIV11,
 12528           DFHEIV99
 12529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12530        IF SCREEN-ERROR
 12531            MOVE ER-0208         TO EMI-ERROR
 12532            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12533            MOVE -1              TO MAINTL
 12534            GO TO 8110-SEND-DATA
 12535        ELSE
 12536            PERFORM 3010-DEL-MSTR-TRLR THRU 3010-EXIT.
 12537
 12538     IF SCREEN-ERROR
 12539         MOVE -1                 TO MAINTL
 12540         GO TO 8110-SEND-DATA.
 12541
 12542     MOVE -1                     TO ONE-OR-MIN1.
 12543     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 12544
 12545     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 12546         MOVE CL-CONTROL-PRIMARY TO MSTR-KEY
 12547                                    WS-SAVE-CLAIM-KEY
 12548         MOVE +1                 TO ONE-OR-MIN1
 12549         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT.
 12550
 12551     MOVE 'D'                    TO PI-CLAIM-DELETED-SWITCH.
 12552
 12553     MOVE LOW-VALUES             TO EL131AO.
 12554     MOVE ER-0000                TO EMI-ERROR.
 12555     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12556     MOVE 'X'                    TO PI-RETURN-CD-1.
 12557     MOVE -1                     TO MAINTL.
 12558     GO TO 8100-SEND-MAP.
 12559
 12560 3010-DEL-MSTR-TRLR.
 12561
 12562* EXEC CICS READ UPDATE
 12563*         SET       (ADDRESS OF CLAIM-MASTER)
 12564*         DATASET   (CLMS-FILE-ID)
 12565*         RIDFLD    (MSTR-KEY)
 12566*    END-EXEC.
 12567*    MOVE '&"S        EU         (   #00010875' TO DFHEIV0
 12568     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12569     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12570     MOVE X'2020233030303130383735' TO DFHEIV0(25:11)
 12571     CALL 'kxdfhei1' USING DFHEIV0,
 12572           CLMS-FILE-ID,
 12573           DFHEIV20,
 12574           DFHEIV99,
 12575           MSTR-KEY,
 12576           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 237
* EL131.cbl
 12577           DFHEIV99,
 12578           DFHEIV99
 12579     SET ADDRESS OF CLAIM-MASTER TO
 12580         DFHEIV20
 12581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12582
 12583
 12584     if (cl-priority-cd = '8')
 12585        and (pi-processor-id not = 'PEMA' and 'JMS '
 12586             AND 'AMWA')
 12587        MOVE ER-8003             TO EMI-ERROR
 12588        PERFORM 9900-ERROR-FORMAT
 12589                                 THRU 9900-EXIT
 12590        MOVE -1                  TO MAINTL
 12591        GO TO 8110-SEND-DATA
 12592     end-if
 12593
 12594     MOVE MSTR-KEY               TO TRLR-MAIN-KEY ACTQ-KEY.
 12595     MOVE ZERO                   TO TRLR-SEQ-NO.
 12596
 12597
 12598* EXEC CICS HANDLE CONDITION
 12599*         NOTFND    (3010-DEL-ACTQ)
 12600*         ENDFILE   (3040-EXIT)
 12601*    END-EXEC.
 12602*    MOVE '"$I''                  ! < #00010894' TO DFHEIV0
 12603     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12604     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12605     MOVE X'3C20233030303130383934' TO DFHEIV0(25:11)
 12606     CALL 'kxdfhei1' USING DFHEIV0
 12607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12608
 12609
 12610     PERFORM 3040-DELETE-TRLR THRU 3040-EXIT.
 12611
 12612 3010-DEL-ACTQ.
 12613
 12614
 12615* EXEC CICS HANDLE CONDITION
 12616*         NOTFND    (3010-NO-ACTIVITY)
 12617*         ENDFILE   (3050-EXIT)
 12618*    END-EXEC.
 12619*    MOVE '"$I''                  ! = #00010903' TO DFHEIV0
 12620     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 12621     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12622     MOVE X'3D20233030303130393033' TO DFHEIV0(25:11)
 12623     CALL 'kxdfhei1' USING DFHEIV0
 12624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12625
 12626
 12627
 12628* EXEC CICS STARTBR
 12629*         DATASET  (ACTQ-FILE-ID)
 12630*         RIDFLD   (ACTQ-KEY)
 12631*    END-EXEC.
 12632     MOVE 0
 12633       TO DFHEIV11
 12634*    MOVE '&,         G          &   #00010908' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 238
* EL131.cbl
 12635     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12636     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12637     MOVE X'2020233030303130393038' TO DFHEIV0(25:11)
 12638     CALL 'kxdfhei1' USING DFHEIV0,
 12639           ACTQ-FILE-ID,
 12640           ACTQ-KEY,
 12641           DFHEIV99,
 12642           DFHEIV11,
 12643           DFHEIV99
 12644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12645
 12646
 12647
 12648* EXEC CICS GETMAIN
 12649*         SET      (ADDRESS OF ACTIVITY-QUE)
 12650*         LENGTH   (ACTQ-LENGTH)
 12651*         INITIMG  (GETMAIN-SPACE)
 12652*    END-EXEC.
 12653*    MOVE ',"IL                  $   #00010913' TO DFHEIV0
 12654     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12655     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12656     MOVE X'2020233030303130393133' TO DFHEIV0(25:11)
 12657     CALL 'kxdfhei1' USING DFHEIV0,
 12658           DFHEIV20,
 12659           ACTQ-LENGTH,
 12660           GETMAIN-SPACE
 12661     SET ADDRESS OF ACTIVITY-QUE TO
 12662         DFHEIV20
 12663     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12664
 12665
 12666     PERFORM 3050-DELETE-ACTQ THRU 3050-EXIT.
 12667
 12668
 12669* EXEC CICS ENDBR
 12670*         DATASET (ACTQ-FILE-ID)
 12671*    END-EXEC.
 12672     MOVE 0
 12673       TO DFHEIV11
 12674*    MOVE '&2                    $   #00010921' TO DFHEIV0
 12675     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12676     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12677     MOVE X'2020233030303130393231' TO DFHEIV0(25:11)
 12678     CALL 'kxdfhei1' USING DFHEIV0,
 12679           ACTQ-FILE-ID,
 12680           DFHEIV11,
 12681           DFHEIV99
 12682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12683
 12684
 12685 3010-NO-ACTIVITY.
 12686
 12687
 12688* EXEC CICS HANDLE CONDITION
 12689*        NOTFND   (3010-CERT-NOT-FOUND)
 12690*    END-EXEC.
 12691*    MOVE '"$I                   ! > #00010927' TO DFHEIV0
 12692     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 239
* EL131.cbl
 12693     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12694     MOVE X'3E20233030303130393237' TO DFHEIV0(25:11)
 12695     CALL 'kxdfhei1' USING DFHEIV0
 12696     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12697
 12698
 12699     MOVE CL-COMPANY-CD          TO CERT-COMPANY-CODE.
 12700     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12701     MOVE CL-CERT-GROUPING       TO CERT-GROUP.
 12702     MOVE CL-CERT-STATE          TO CERT-STATE.
 12703     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12704     MOVE CL-CERT-EFF-DT         TO CERT-DATE.
 12705     MOVE CL-CERT-NO             TO CERT-CERT.
 12706
 12707
 12708* EXEC CICS READ
 12709*        DATASET   (CERT-FILE-ID)
 12710*        RIDFLD    (CERT-KEY)
 12711*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 12712*    END-EXEC.
 12713*    MOVE '&"S        E          (   #00010939' TO DFHEIV0
 12714     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12715     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12716     MOVE X'2020233030303130393339' TO DFHEIV0(25:11)
 12717     CALL 'kxdfhei1' USING DFHEIV0,
 12718           CERT-FILE-ID,
 12719           DFHEIV20,
 12720           DFHEIV99,
 12721           CERT-KEY,
 12722           DFHEIV99,
 12723           DFHEIV99,
 12724           DFHEIV99
 12725     SET ADDRESS OF CERTIFICATE-MASTER TO
 12726         DFHEIV20
 12727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12728
 12729
 12730     IF CERT-WAS-CREATED AND CM-CLAIM-ATTACHED-COUNT = 1
 12731       AND PI-COMPANY-ID NOT EQUAL 'AHL'
 12732         PERFORM 3030-DELETE-CERT THRU 3030-EXIT
 12733     ELSE
 12734         PERFORM 3020-UPDATE-CERT THRU 3020-EXIT.
 12735
 12736  3010-UPDATE-CERT-TRLR.
 12737
 12738      MOVE CERT-KEY              TO ELCRTT-KEY
 12739      MOVE 'B'                   TO CTRLR-REC-TYPE
 12740
 12741* EXEC CICS READ
 12742*        UPDATE
 12743*        DATASET   ('ELCRTT')
 12744*        RIDFLD    (ELCRTT-KEY)
 12745*        INTO      (CERTIFICATE-TRAILERS)
 12746*        RESP      (WS-RESPONSE)
 12747*     END-EXEC
 12748     MOVE LENGTH OF
 12749      CERTIFICATE-TRAILERS
 12750       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 240
* EL131.cbl
 12751     MOVE 'ELCRTT' TO DFHEIV1
 12752*    MOVE '&"IL       EU         (  N#00010955' TO DFHEIV0
 12753     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12754     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12755     MOVE X'204E233030303130393535' TO DFHEIV0(25:11)
 12756     CALL 'kxdfhei1' USING DFHEIV0,
 12757           DFHEIV1,
 12758           CERTIFICATE-TRAILERS,
 12759           DFHEIV11,
 12760           ELCRTT-KEY,
 12761           DFHEIV99,
 12762           DFHEIV99,
 12763           DFHEIV99
 12764     MOVE EIBRESP  TO WS-RESPONSE
 12765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12766      IF WS-RESP-NORMAL
 12767*    if cl-insured-claim = 'S'
 12768*       move +2 to s1
 12769*    else
 12770*       MOVE +1 to s1
 12771*    end-if
 12772
 12773     move +1 to s1
 12774     evaluate cl-claim-type
 12775        when 'A'
 12776           move +1 to s2
 12777        when 'I'
 12778           move +2 to s2
 12779        when 'G'
 12780           move +3 to s2
 12781        when 'L'
 12782           move +4 to s2
 12783        when 'P'
 12784           move +5 to s2
 12785     end-evaluate
 12786     SUBTRACT +1 FROM CS-NO-OF-CLAIMS (S1 S2)
 12787     IF CS-NO-OF-CLAIMS (S1 S2) < ZEROS
 12788        MOVE ZEROS               TO CS-NO-OF-CLAIMS (S1 S2)
 12789     END-IF
 12790     if cs-no-of-claims (s1 s2) = zeros
 12791        move spaces              to cs-claim-type (s1 s2)
 12792     end-if
 12793
 12794
 12795* EXEC CICS REWRITE
 12796*       DATASET   ('ELCRTT')
 12797*       FROM      (CERTIFICATE-TRAILERS)
 12798*    END-EXEC
 12799     MOVE LENGTH OF
 12800      CERTIFICATE-TRAILERS
 12801       TO DFHEIV11
 12802     MOVE 'ELCRTT' TO DFHEIV1
 12803*    MOVE '&& L                  %   #00010990' TO DFHEIV0
 12804     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12805     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12806     MOVE X'2020233030303130393930' TO DFHEIV0(25:11)
 12807     CALL 'kxdfhei1' USING DFHEIV0,
 12808           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 241
* EL131.cbl
 12809           CERTIFICATE-TRAILERS,
 12810           DFHEIV11,
 12811           DFHEIV99
 12812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12813     .
 12814 3010-CERT-NOT-FOUND.
 12815
 12816
 12817* EXEC CICS DELETE
 12818*        DATASET  (CLMS-FILE-ID)
 12819*    END-EXEC.
 12820*    MOVE '&(                    &   #00010997' TO DFHEIV0
 12821     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12822     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12823     MOVE X'2020233030303130393937' TO DFHEIV0(25:11)
 12824     CALL 'kxdfhei1' USING DFHEIV0,
 12825           CLMS-FILE-ID,
 12826           DFHEIV99,
 12827           DFHEIV99,
 12828           DFHEIV99,
 12829           DFHEIV99
 12830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12831
 12832
 12833 3010-EXIT.
 12834      EXIT.
 12835
 12836 3020-UPDATE-CERT.
 12837
 12838* EXEC CICS READ UPDATE
 12839*         DATASET  (CERT-FILE-ID)
 12840*         RIDFLD   (CERT-KEY)
 12841*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12842*    END-EXEC.
 12843*    MOVE '&"S        EU         (   #00011005' TO DFHEIV0
 12844     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12845     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12846     MOVE X'2020233030303131303035' TO DFHEIV0(25:11)
 12847     CALL 'kxdfhei1' USING DFHEIV0,
 12848           CERT-FILE-ID,
 12849           DFHEIV20,
 12850           DFHEIV99,
 12851           CERT-KEY,
 12852           DFHEIV99,
 12853           DFHEIV99,
 12854           DFHEIV99
 12855     SET ADDRESS OF CERTIFICATE-MASTER TO
 12856         DFHEIV20
 12857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12858
 12859
 12860     SUBTRACT 1       FROM CM-CLAIM-ATTACHED-COUNT.
 12861
 12862
 12863* EXEC CICS HANDLE CONDITION
 12864*         DUPKEY   (3020-EXIT)
 12865*    END-EXEC.
 12866*    MOVE '"$$                   ! ? #00011013' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 242
* EL131.cbl
 12867     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12868     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12869     MOVE X'3F20233030303131303133' TO DFHEIV0(25:11)
 12870     CALL 'kxdfhei1' USING DFHEIV0
 12871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12872
 12873
 12874
 12875* EXEC CICS REWRITE
 12876*         DATASET  (CERT-FILE-ID)
 12877*         FROM     (CERTIFICATE-MASTER)
 12878*    END-EXEC.
 12879     MOVE LENGTH OF
 12880      CERTIFICATE-MASTER
 12881       TO DFHEIV11
 12882*    MOVE '&& L                  %   #00011017' TO DFHEIV0
 12883     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12884     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12885     MOVE X'2020233030303131303137' TO DFHEIV0(25:11)
 12886     CALL 'kxdfhei1' USING DFHEIV0,
 12887           CERT-FILE-ID,
 12888           CERTIFICATE-MASTER,
 12889           DFHEIV11,
 12890           DFHEIV99
 12891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12892
 12893
 12894 3020-EXIT.
 12895     EXIT.
 12896
 12897 3030-DELETE-CERT.
 12898
 12899* EXEC CICS READ UPDATE
 12900*         DATASET  (CERT-FILE-ID)
 12901*         RIDFLD   (CERT-KEY)
 12902*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 12903*    END-EXEC.
 12904*    MOVE '&"S        EU         (   #00011026' TO DFHEIV0
 12905     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12906     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12907     MOVE X'2020233030303131303236' TO DFHEIV0(25:11)
 12908     CALL 'kxdfhei1' USING DFHEIV0,
 12909           CERT-FILE-ID,
 12910           DFHEIV20,
 12911           DFHEIV99,
 12912           CERT-KEY,
 12913           DFHEIV99,
 12914           DFHEIV99,
 12915           DFHEIV99
 12916     SET ADDRESS OF CERTIFICATE-MASTER TO
 12917         DFHEIV20
 12918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12919
 12920
 12921
 12922* EXEC CICS DELETE
 12923*         DATASET   (CERT-FILE-ID)
 12924*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 243
* EL131.cbl
 12925*    MOVE '&(                    &   #00011032' TO DFHEIV0
 12926     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12927     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12928     MOVE X'2020233030303131303332' TO DFHEIV0(25:11)
 12929     CALL 'kxdfhei1' USING DFHEIV0,
 12930           CERT-FILE-ID,
 12931           DFHEIV99,
 12932           DFHEIV99,
 12933           DFHEIV99,
 12934           DFHEIV99
 12935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12936
 12937
 12938 3030-EXIT.
 12939     EXIT.
 12940
 12941 3040-DELETE-TRLR.
 12942
 12943* EXEC CICS READ
 12944*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12945*         DATASET  (TRLR-FILE-ID)
 12946*         RIDFLD   (TRLR-KEY)
 12947*         GTEQ
 12948*    END-EXEC.
 12949*    MOVE '&"S        G          (   #00011040' TO DFHEIV0
 12950     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12951     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12952     MOVE X'2020233030303131303430' TO DFHEIV0(25:11)
 12953     CALL 'kxdfhei1' USING DFHEIV0,
 12954           TRLR-FILE-ID,
 12955           DFHEIV20,
 12956           DFHEIV99,
 12957           TRLR-KEY,
 12958           DFHEIV99,
 12959           DFHEIV99,
 12960           DFHEIV99
 12961     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12962         DFHEIV20
 12963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12964
 12965
 12966     IF PI-COMPANY-CD = AT-COMPANY-CD
 12967        MOVE AT-CONTROL-PRIMARY  TO TRLR-KEY
 12968        IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 12969           GO TO 3040-EXIT
 12970        ELSE
 12971           NEXT SENTENCE
 12972     ELSE
 12973        GO TO 3040-EXIT.
 12974
 12975
 12976* EXEC CICS DELETE
 12977*         DATASET  (TRLR-FILE-ID)
 12978*         RIDFLD   (TRLR-KEY)
 12979*    END-EXEC.
 12980*    MOVE '&(  R                 &   #00011056' TO DFHEIV0
 12981     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12982     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 244
* EL131.cbl
 12983     MOVE X'2020233030303131303536' TO DFHEIV0(25:11)
 12984     CALL 'kxdfhei1' USING DFHEIV0,
 12985           TRLR-FILE-ID,
 12986           TRLR-KEY,
 12987           DFHEIV99,
 12988           DFHEIV99,
 12989           DFHEIV99
 12990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12991
 12992
 12993     GO TO 3040-DELETE-TRLR.
 12994
 12995 3040-EXIT.
 12996     EXIT.
 12997
 12998 3050-DELETE-ACTQ.
 12999
 13000* EXEC CICS READNEXT
 13001*         DATASET  (ACTQ-FILE-ID)
 13002*         RIDFLD   (ACTQ-KEY)
 13003*         INTO     (ACTIVITY-QUE)
 13004*    END-EXEC.
 13005     MOVE LENGTH OF
 13006      ACTIVITY-QUE
 13007       TO DFHEIV12
 13008     MOVE 0
 13009       TO DFHEIV11
 13010*    MOVE '&.IL                  )   #00011067' TO DFHEIV0
 13011     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13012     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13013     MOVE X'2020233030303131303637' TO DFHEIV0(25:11)
 13014     CALL 'kxdfhei1' USING DFHEIV0,
 13015           ACTQ-FILE-ID,
 13016           ACTIVITY-QUE,
 13017           DFHEIV12,
 13018           ACTQ-KEY,
 13019           DFHEIV99,
 13020           DFHEIV11,
 13021           DFHEIV99,
 13022           DFHEIV99
 13023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13024
 13025
 13026     IF ACTQ-KEY GREATER THAN CL-CONTROL-PRIMARY
 13027         GO TO 3050-EXIT.
 13028
 13029
 13030* EXEC CICS ENDBR
 13031*         DATASET  (ACTQ-FILE-ID)
 13032*    END-EXEC.
 13033     MOVE 0
 13034       TO DFHEIV11
 13035*    MOVE '&2                    $   #00011076' TO DFHEIV0
 13036     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13037     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13038     MOVE X'2020233030303131303736' TO DFHEIV0(25:11)
 13039     CALL 'kxdfhei1' USING DFHEIV0,
 13040           ACTQ-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 245
* EL131.cbl
 13041           DFHEIV11,
 13042           DFHEIV99
 13043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13044
 13045
 13046
 13047* EXEC CICS DELETE
 13048*         DATASET   (ACTQ-FILE-ID)
 13049*         RIDFLD    (ACTQ-KEY)
 13050*    END-EXEC.
 13051*    MOVE '&(  R                 &   #00011080' TO DFHEIV0
 13052     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 13053     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13054     MOVE X'2020233030303131303830' TO DFHEIV0(25:11)
 13055     CALL 'kxdfhei1' USING DFHEIV0,
 13056           ACTQ-FILE-ID,
 13057           ACTQ-KEY,
 13058           DFHEIV99,
 13059           DFHEIV99,
 13060           DFHEIV99
 13061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13062
 13063
 13064
 13065* EXEC CICS STARTBR
 13066*         DATASET   (ACTQ-FILE-ID)
 13067*         RIDFLD    (ACTQ-KEY)
 13068*    END-EXEC.
 13069     MOVE 0
 13070       TO DFHEIV11
 13071*    MOVE '&,         G          &   #00011085' TO DFHEIV0
 13072     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13073     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13074     MOVE X'2020233030303131303835' TO DFHEIV0(25:11)
 13075     CALL 'kxdfhei1' USING DFHEIV0,
 13076           ACTQ-FILE-ID,
 13077           ACTQ-KEY,
 13078           DFHEIV99,
 13079           DFHEIV11,
 13080           DFHEIV99
 13081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13082
 13083
 13084     GO TO 3050-DELETE-ACTQ.
 13085
 13086 3050-EXIT.
 13087     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 246
* EL131.cbl
 13089 3060-READ-TRLR.
 13090
 13091* EXEC CICS HANDLE CONDITION
 13092*         NOTFND    (3060-EXIT)
 13093*         ENDFILE   (3060-EXIT)
 13094*    END-EXEC.
 13095*    MOVE '"$I''                  ! @ #00011096' TO DFHEIV0
 13096     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 13097     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13098     MOVE X'4020233030303131303936' TO DFHEIV0(25:11)
 13099     CALL 'kxdfhei1' USING DFHEIV0
 13100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13101
 13102
 13103 3060-LOOP.
 13104
 13105* EXEC CICS READNEXT
 13106*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13107*         DATASET  (TRLR-FILE-ID)
 13108*         RIDFLD   (TRLR-KEY)
 13109*    END-EXEC.
 13110     MOVE 0
 13111       TO DFHEIV11
 13112*    MOVE '&.S                   )   #00011102' TO DFHEIV0
 13113     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13114     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13115     MOVE X'2020233030303131313032' TO DFHEIV0(25:11)
 13116     CALL 'kxdfhei1' USING DFHEIV0,
 13117           TRLR-FILE-ID,
 13118           DFHEIV20,
 13119           DFHEIV99,
 13120           TRLR-KEY,
 13121           DFHEIV99,
 13122           DFHEIV11,
 13123           DFHEIV99,
 13124           DFHEIV99
 13125     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13126         DFHEIV20
 13127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13128
 13129
 13130     IF TRLR-MAIN-KEY GREATER THAN CL-CONTROL-PRIMARY
 13131         GO TO 3060-EXIT.
 13132
 13133     IF FORM-CONTROL-TR
 13134         IF AT-RECORDED-DT = SAVE-BIN-DATE
 13135             NEXT SENTENCE
 13136         ELSE
 13137             MOVE 'X'            TO ERROR-SWITCH
 13138             GO TO 3060-EXIT
 13139     ELSE
 13140         IF PAYMENT-TR OR CORRESPONDENCE-TR
 13141            MOVE 'X'                 TO ERROR-SWITCH
 13142            GO TO 3060-EXIT.
 13143
 13144     GO TO 3060-LOOP.
 13145
 13146 3060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 247
* EL131.cbl
 13147     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 248
* EL131.cbl
 13149 3997-GET-ERPDEF.
 13150
 13151     move cl-company-cd          to cert-company-code
 13152     move cl-cert-key-data       to cert-key (2:21)
 13153     move cl-cert-no             to cert-cert
 13154
 13155
 13156* EXEC CICS READ
 13157*        DATASET   (CERT-FILE-ID)
 13158*        RIDFLD    (CERT-KEY)
 13159*        SET       (ADDRESS OF CERTIFICATE-MASTER)
 13160*        resp      (ws-response)
 13161*    END-EXEC
 13162*    MOVE '&"S        E          (  N#00011133' TO DFHEIV0
 13163     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13164     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13165     MOVE X'204E233030303131313333' TO DFHEIV0(25:11)
 13166     CALL 'kxdfhei1' USING DFHEIV0,
 13167           CERT-FILE-ID,
 13168           DFHEIV20,
 13169           DFHEIV99,
 13170           CERT-KEY,
 13171           DFHEIV99,
 13172           DFHEIV99,
 13173           DFHEIV99
 13174     SET ADDRESS OF CERTIFICATE-MASTER TO
 13175         DFHEIV20
 13176     MOVE EIBRESP  TO ws-response
 13177     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13178
 13179     MOVE SPACES                 TO WS-CRIT-PER-RECURRENT
 13180                                    WS-ERPDEF-SW
 13181     MOVE ZEROS                  TO WS-CRITICAL-PERIOD
 13182                                    WS-CRIT-PER-RTW-MOS
 13183
 13184     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
 13185     MOVE CM-STATE               TO ERPDEF-STATE
 13186     MOVE am-dcc-product-code    TO ERPDEF-PROD-CD
 13187     MOVE 'A'                    TO ERPDEF-BEN-TYPE
 13188     MOVE CM-AH-BENEFIT-CD       TO ERPDEF-BEN-CODE
 13189     MOVE CM-CERT-EFF-DT         TO ERPDEF-EXP-DT
 13190     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
 13191
 13192
 13193* EXEC CICS STARTBR
 13194*        DATASET  ('ERPDEF')
 13195*        RIDFLD   (ERPDEF-KEY)
 13196*        GTEQ
 13197*        RESP     (WS-RESPONSE)
 13198*    END-EXEC
 13199     MOVE 'ERPDEF' TO DFHEIV1
 13200     MOVE 0
 13201       TO DFHEIV11
 13202*    MOVE '&,         G          &  N#00011153' TO DFHEIV0
 13203     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13204     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13205     MOVE X'204E233030303131313533' TO DFHEIV0(25:11)
 13206     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 249
* EL131.cbl
 13207           DFHEIV1,
 13208           ERPDEF-KEY,
 13209           DFHEIV99,
 13210           DFHEIV11,
 13211           DFHEIV99
 13212     MOVE EIBRESP  TO WS-RESPONSE
 13213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13214
 13215     IF WS-RESP-NORMAL
 13216
 13217* EXEC CICS READNEXT
 13218*          DATASET  ('ERPDEF')
 13219*          INTO     (PRODUCT-MASTER)
 13220*          RIDFLD   (ERPDEF-KEY)
 13221*          RESP     (WS-RESPONSE)
 13222*       END-EXEC
 13223     MOVE LENGTH OF
 13224      PRODUCT-MASTER
 13225       TO DFHEIV12
 13226     MOVE 'ERPDEF' TO DFHEIV1
 13227     MOVE 0
 13228       TO DFHEIV11
 13229*    MOVE '&.IL                  )  N#00011161' TO DFHEIV0
 13230     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 13231     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13232     MOVE X'204E233030303131313631' TO DFHEIV0(25:11)
 13233     CALL 'kxdfhei1' USING DFHEIV0,
 13234           DFHEIV1,
 13235           PRODUCT-MASTER,
 13236           DFHEIV12,
 13237           ERPDEF-KEY,
 13238           DFHEIV99,
 13239           DFHEIV11,
 13240           DFHEIV99,
 13241           DFHEIV99
 13242     MOVE EIBRESP  TO WS-RESPONSE
 13243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13244        IF WS-RESP-NORMAL
 13245           IF (ERPDEF-KEY-SAVE (1:16) =
 13246              PD-CONTROL-PRIMARY (1:16))
 13247              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 13248              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 13249                 (A1 > +8)
 13250                 OR (PD-PROD-CODE (A1) = cl-claim-type)
 13251              END-PERFORM
 13252              IF A1 < +9
 13253                 SET ERPDEF-FOUND TO TRUE
 13254                 MOVE PD-CRIT-PERIOD (A1)
 13255                              TO WS-CRITICAL-PERIOD
 13256                 MOVE PD-REC-CRIT-PERIOD (A1)
 13257                              TO WS-CRIT-PER-RECURRENT
 13258                 IF PD-RTW-MOS (A1) NUMERIC
 13259                    MOVE PD-RTW-MOS (A1)
 13260                              TO WS-CRIT-PER-RTW-MOS
 13261                 ELSE
 13262                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 13263                 END-IF
 13264                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 250
* EL131.cbl
 13265                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 13266                                 TO WS-EXCL-PERIOD
 13267                 END-IF
 13268                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
 13269                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 13270                                 TO WS-COV-ENDS
 13271                 END-IF
 13272                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 13273                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 13274                                 TO WS-ACC-PERIOD
 13275                 END-IF
 13276              END-IF
 13277           END-IF
 13278        END-IF
 13279     END-IF
 13280
 13281     .
 13282 3997-EXIT.
 13283     EXIT.
 13284 4000-FORCE-ERRORS.
 13285     IF PI-RETURN-CD-1 = 'X'
 13286         MOVE ER-0311            TO EMI-ERROR
 13287         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13288         MOVE -1                 TO MAINTL
 13289         GO TO 8110-SEND-DATA.
 13290
 13291     IF NOT FORCE-CAP
 13292         MOVE ER-0416            TO EMI-ERROR
 13293         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13294         MOVE -1                 TO MAINTL
 13295         GO TO 8110-SEND-DATA.
 13296
 13297     MOVE 'F'                    TO EMI-ACTION-SWITCH.
 13298     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
 13299     IF EMI-FATAL-CTR GREATER THAN ZERO
 13300         GO TO 4000-FATAL-ERRORS.
 13301
 13302     PERFORM 2000-UPDATE-CLAIM THRU 2000-EXIT.
 13303
 13304     IF EMI-FATAL-CTR GREATER THAN ZERO
 13305         GO TO 4000-FATAL-ERRORS.
 13306
 13307     PERFORM 5000-BUILD-MAP THRU 5000-EXIT.
 13308
 13309     IF EMI-FATAL-CTR GREATER THAN ZERO
 13310         GO TO 4000-FATAL-ERRORS.
 13311
 13312     MOVE SPACE                  TO EMI-ACTION-SWITCH MAINTO.
 13313     MOVE AL-UANOF               TO CERTA.
 13314     MOVE ER-0000 TO EMI-ERROR.
 13315     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13316
 13317 4000-FATAL-ERRORS.
 13318     MOVE -1                     TO MAINTL.
 13319     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 251
* EL131.cbl
 13321 5000-BUILD-MAP.
 13322     IF PI-RETURN-CD-1 = SPACE
 13323         PERFORM 5010-RESET-PI-AREA THRU 5010-EXIT.
 13324
 13325     MOVE SPACE                  TO PI-RETURN-CD-1.
 13326
 13327     MOVE LOW-VALUES             TO EL131AI.
 13328
 13329     MOVE PI-COMPANY-CD          TO COMPANY-CODE.
 13330     MOVE PI-CARRIER             TO CARRIER-CODE.
 13331     MOVE PI-CLAIM-NO            TO CLAIM-NO.
 13332     MOVE PI-CERT-NO             TO CERT-NO.
 13333
 13334 5000-READ-CLAIM-MASTER.
 13335
 13336
 13337* EXEC CICS READ
 13338*         SET      (ADDRESS OF CLAIM-MASTER)
 13339*         DATASET  (CLMS-FILE-ID)
 13340*         RIDFLD   (MSTR-KEY)
 13341*    END-EXEC.
 13342*    MOVE '&"S        E          (   #00011259' TO DFHEIV0
 13343     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13344     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13345     MOVE X'2020233030303131323539' TO DFHEIV0(25:11)
 13346     CALL 'kxdfhei1' USING DFHEIV0,
 13347           CLMS-FILE-ID,
 13348           DFHEIV20,
 13349           DFHEIV99,
 13350           MSTR-KEY,
 13351           DFHEIV99,
 13352           DFHEIV99,
 13353           DFHEIV99
 13354     SET ADDRESS OF CLAIM-MASTER TO
 13355         DFHEIV20
 13356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13357
 13358
 13359     PERFORM 5020-MOVE-MSTR THRU 5020-EXIT.
 13360
 13361 5000-READ-DIAGNOSIS-TRAILER.
 13362
 13363
 13364* EXEC CICS HANDLE CONDITION
 13365*         NOTFND (5000-TRLR-NOT-FOUND)
 13366*    END-EXEC.
 13367*    MOVE '"$I                   ! A #00011269' TO DFHEIV0
 13368     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13370     MOVE X'4120233030303131323639' TO DFHEIV0(25:11)
 13371     CALL 'kxdfhei1' USING DFHEIV0
 13372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13373
 13374
 13375     MOVE MSTR-KEY               TO TRLR-KEY.
 13376     MOVE NINETY                 TO TRLR-SEQ-NO.
 13377
 13378
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 252
* EL131.cbl
 13379* EXEC CICS READ
 13380*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13381*         DATASET  (TRLR-FILE-ID)
 13382*         RIDFLD   (TRLR-KEY)
 13383*    END-EXEC.
 13384*    MOVE '&"S        E          (   #00011276' TO DFHEIV0
 13385     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13386     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13387     MOVE X'2020233030303131323736' TO DFHEIV0(25:11)
 13388     CALL 'kxdfhei1' USING DFHEIV0,
 13389           TRLR-FILE-ID,
 13390           DFHEIV20,
 13391           DFHEIV99,
 13392           TRLR-KEY,
 13393           DFHEIV99,
 13394           DFHEIV99,
 13395           DFHEIV99
 13396     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13397         DFHEIV20
 13398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13399
 13400
 13401     MOVE AT-INFO-LINE-1         TO DIAGO.
 13402
 13403 5000-READ-CERTIFICATE-MASTER.
 13404
 13405     MOVE PI-COMPANY-CD          TO CERT-COMPANY-CODE.
 13406     MOVE CL-CERT-CARRIER        TO CERT-CARRIER
 13407     MOVE CL-CERT-GROUPING       TO CERT-GROUP PI-GROUPING.
 13408     MOVE CL-CERT-STATE          TO CERT-STATE PI-STATE.
 13409     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT PI-ACCOUNT.
 13410     MOVE CL-CERT-NO             TO CERT-CERT PI-CERT-NO.
 13411     MOVE CL-CERT-EFF-DT         TO CERT-DATE PI-CERT-EFF-DT.
 13412
 13413
 13414* EXEC CICS HANDLE CONDITION
 13415*         NOTFND (5000-CERT-NOT-FOUND)
 13416*    END-EXEC.
 13417*    MOVE '"$I                   ! B #00011294' TO DFHEIV0
 13418     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13419     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13420     MOVE X'4220233030303131323934' TO DFHEIV0(25:11)
 13421     CALL 'kxdfhei1' USING DFHEIV0
 13422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13423
 13424
 13425
 13426* EXEC CICS READ
 13427*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 13428*         DATASET  (CERT-FILE-ID)
 13429*         RIDFLD   (CERT-KEY)
 13430*    END-EXEC.
 13431*    MOVE '&"S        E          (   #00011298' TO DFHEIV0
 13432     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13433     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13434     MOVE X'2020233030303131323938' TO DFHEIV0(25:11)
 13435     CALL 'kxdfhei1' USING DFHEIV0,
 13436           CERT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 253
* EL131.cbl
 13437           DFHEIV20,
 13438           DFHEIV99,
 13439           CERT-KEY,
 13440           DFHEIV99,
 13441           DFHEIV99,
 13442           DFHEIV99
 13443     SET ADDRESS OF CERTIFICATE-MASTER TO
 13444         DFHEIV20
 13445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13446
 13447
 13448     PERFORM 5030-MOVE-CERT THRU 5030-EXIT.
 13449     PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT.
 13450
 13451     GO TO 5000-EXIT.
 13452
 13453 5000-TRLR-NOT-FOUND.
 13454     MOVE ER-7687                TO EMI-ERROR.
 13455     MOVE -1                     TO DIAGL.
 13456     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13457     GO TO 5000-EXIT.
 13458
 13459 5000-CERT-NOT-FOUND.
 13460     MOVE ER-0206                TO EMI-ERROR.
 13461     MOVE -1                     TO CERTL.
 13462     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13463
 13464 5000-EXIT.
 13465     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 254
* EL131.cbl
 13467 5010-RESET-PI-AREA.
 13468     IF CERTI GREATER THAN LOW-VALUES
 13469         MOVE CERTI              TO PI-CERT-PRIME.
 13470
 13471     IF SUFXI GREATER THAN LOW-VALUES
 13472         MOVE SUFXI              TO PI-CERT-SFX.
 13473
 13474     IF CERTEFFI GREATER THAN LOW-VALUES
 13475         MOVE HOLD-EFF           TO PI-CERT-EFF-DT.
 13476
 13477     IF CERTACTI GREATER THAN LOW-VALUES
 13478         MOVE CERTACTI           TO PI-ACCOUNT.
 13479
 13480     IF CERTSTI GREATER THAN LOW-VALUES
 13481         MOVE CERTSTI            TO PI-STATE.
 13482
 13483     IF CERTCARI GREATER THAN LOW-VALUES
 13484         MOVE CERTCARI           TO PI-CARRIER.
 13485
 13486     IF CERTGRPI GREATER THAN LOW-VALUES
 13487         MOVE CERTGRPI           TO PI-GROUPING.
 13488
 13489 5010-EXIT.
 13490     EXIT.
 13491
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 255
* EL131.cbl
 13493 5020-MOVE-MSTR.
 13494
 13495     MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU.
 13496     MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU.
 13497     MOVE WS-CLAIM-SEQU          TO SEQUO.
 13498     MOVE AL-SABON               TO SEQUA.
 13499     MOVE CL-CLAIM-NO            TO CLAIMO PI-CLAIM-NO.
 13500     MOVE CL-CLAIM-TYPE          TO TYPEO
 13501                                    pi-claim-type
 13502
 13503     IF CL-TOTAL-PAID-AMT  = +0 AND
 13504        CL-LAST-PMT-AMT    = +0 AND
 13505        CL-NO-OF-PMTS-MADE = +0
 13506          MOVE AL-UANON          TO TYPEA.
 13507
 13508     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 13509     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 13510     MOVE CL-CERT-PRIME          TO CERTO.
 13511     MOVE CL-CERT-SFX            TO SUFXO.
 13512     MOVE CL-CERT-CARRIER        TO CARRO.
 13513
 13514     IF CL-CLAIM-STATUS = 'C'
 13515         MOVE 'CLOSED'           TO STATUSO
 13516     ELSE
 13517         MOVE 'OPEN  '           TO STATUSO.
 13518
 13519     move cl-accident-claim-sw   to accswo
 13520     MOVE CL-PROCESSOR-ID        TO PROCO.
 13521
 13522     MOVE CL-FILE-ESTABLISHED-BY TO AUIDO.
 13523     MOVE CL-CCN                 TO CCNOO.
 13524
 13525     MOVE CL-INSURED-LAST-NAME   TO MLNAMEO.
 13526     MOVE CL-INSURED-1ST-NAME    TO MFNAMEO.
 13527     MOVE CL-INSURED-MID-INIT    TO MMINITO.
 13528     MOVE CL-INSURED-SEX-CD      TO SEXO.
 13529
 13530     IF CL-INSURED-BIRTH-DT GREATER THAN LOW-VALUES
 13531         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 13532         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13533         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13534         MOVE DC-GREG-DATE-1-EDIT TO BIRTHO
 13535     ELSE
 13536         MOVE SPACES             TO BIRTHO.
 13537
 13538     IF CL-SSN-STATE   = CL-CERT-STATE  AND
 13539        CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME
 13540         NEXT SENTENCE
 13541       ELSE
 13542         MOVE CL-SOC-SEC-NO      TO SOCIALO.
 13543
 13544     IF PI-COMPANY-ID = 'DMD'
 13545       IF CL-CERT-PRIME (4:1) = 'U' OR 'F'
 13546          IF SOCIALO = SPACES OR LOW-VALUES
 13547            MOVE ER-0885         TO EMI-ERROR
 13548            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13549
 13550     MOVE CL-INSURED-OCC-CD      TO OCCO.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 256
* EL131.cbl
 13551     MOVE CL-CAUSE-CD            TO CAUSEO.
 13552
 13553     IF CL-EST-END-OF-DISAB-DT GREATER THAN LOW-VALUES
 13554         MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 13555         MOVE SPACES                 TO DC-OPTION-CODE
 13556         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13557         MOVE DC-GREG-DATE-1-EDIT TO ENDO
 13558     ELSE
 13559         MOVE SPACES             TO ENDO.
 13560
 13561     IF CL-PAID-THRU-DT GREATER THAN LOW-VALUES
 13562        MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 13563        MOVE SPACES             TO DC-OPTION-CODE
 13564        PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13565        MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 13566        IF PI-USES-PAID-TO
 13567           MOVE CL-PAID-THRU-DT    TO DC-BIN-DATE-1
 13568           MOVE '6'                TO DC-OPTION-CODE
 13569           MOVE +1                 TO DC-ELAPSED-DAYS
 13570           MOVE +0                 TO DC-ELAPSED-MONTHS
 13571           PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13572           MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 13573        ELSE
 13574           NEXT SENTENCE
 13575     ELSE
 13576        MOVE SPACES             TO PDTHRUO.
 13577
 13578     MOVE CL-TOTAL-PAID-AMT      TO PDAMTO.
 13579     MOVE CL-NO-OF-DAYS-PAID     TO NODAYSO.
 13580     MOVE CL-NO-OF-PMTS-MADE     TO NOPMTSO.
 13581     MOVE CL-PROG-FORM-TYPE      TO FORMTYPO.
 13582
 13583     IF MODIFY-CAP
 13584        MOVE AL-UNNOF            TO PDAMTA
 13585                                    NODAYSA
 13586                                    NOPMTSA
 13587        MOVE AL-UANOF            TO PDTHRUA.
 13588
 13589     IF CL-INCURRED-DT GREATER THAN LOW-VALUES
 13590         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13591         MOVE SPACES             TO DC-OPTION-CODE
 13592         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13593         MOVE DC-GREG-DATE-1-EDIT TO INCO
 13594     ELSE
 13595         MOVE SPACES             TO INCO.
 13596
 13597     IF CL-NO-OF-PMTS-MADE = ZEROS
 13598        MOVE AL-UANOF            TO INCA.
 13599
 13600     MOVE CL-NO-OF-PMTS-MADE     TO PI-NO-PMTS.
 13601
 13602     IF CL-REPORTED-DT GREATER THAN LOW-VALUES
 13603         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 13604         MOVE SPACES             TO DC-OPTION-CODE
 13605         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13606         MOVE DC-GREG-DATE-1-EDIT TO REPO
 13607     ELSE
 13608         MOVE SPACES             TO REPO.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 257
* EL131.cbl
 13609
 13610     IF CL-FILE-ESTABLISH-DT GREATER THAN LOW-VALUES
 13611         MOVE CL-FILE-ESTABLISH-DT TO DC-BIN-DATE-1
 13612         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13613         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13614         MOVE DC-GREG-DATE-1-EDIT TO ESTO
 13615     ELSE
 13616         MOVE SPACES             TO ESTO.
 13617
 13618     IF CL-LAST-MAINT-DT GREATER THAN LOW-VALUES
 13619         MOVE CL-LAST-MAINT-DT   TO DC-BIN-DATE-1
 13620         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13621         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13622         MOVE DC-GREG-DATE-1-EDIT TO MNTDTO
 13623     ELSE
 13624         MOVE SPACES             TO MNTDTO.
 13625
 13626
 13627     IF CL-LAST-MAINT-TYPE = SPACE
 13628         MOVE 'SET-UP'           TO MNTTYPEO
 13629     ELSE
 13630     IF CL-LAST-MAINT-TYPE = '1'
 13631         MOVE 'PAYMNT'           TO MNTTYPEO
 13632     ELSE
 13633     IF CL-LAST-MAINT-TYPE = '2'
 13634         MOVE 'LETTER'           TO MNTTYPEO
 13635     ELSE
 13636     IF CL-LAST-MAINT-TYPE = '3'
 13637         MOVE 'UPDATE'           TO MNTTYPEO
 13638     ELSE
 13639     IF CL-LAST-MAINT-TYPE = '4'
 13640         MOVE 'RESTOR'           TO MNTTYPEO
 13641     ELSE
 13642     IF CL-LAST-MAINT-TYPE = '5'
 13643         MOVE 'INC DT'           TO MNTTYPEO
 13644     ELSE
 13645     IF CL-LAST-MAINT-TYPE = '6'
 13646         MOVE ' CONV'            TO MNTTYPEO
 13647     ELSE
 13648     IF CL-LAST-MAINT-TYPE = 'C'
 13649         MOVE 'CHGBEN'           TO MNTTYPEO
 13650     ELSE
 13651     IF CL-LAST-MAINT-TYPE = 'E'
 13652         MOVE 'ERRCOR'           TO MNTTYPEO
 13653     ELSE
 13654         MOVE SPACES             TO MNTTYPEO.
 13655
 13656     MOVE CL-BENEFICIARY         TO BENEO.
 13657     MOVE CL-FILE-LOCATION       TO FILETOO.
 13658     IF CL-CRITICAL-PERIOD NOT NUMERIC
 13659        MOVE ZEROS               TO CL-CRITICAL-PERIOD
 13660     END-IF
 13661     MOVE CL-CRITICAL-PERIOD     TO CRITPO
 13662     MOVE CL-CRIT-PER-RECURRENT
 13663                                 TO CRITPTO
 13664     IF CL-CRIT-PER-RTW-MOS NOT NUMERIC
 13665        MOVE ZEROS               TO CL-CRIT-PER-RTW-MOS
 13666     END-IF
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 258
* EL131.cbl
 13667     MOVE CL-CRIT-PER-RTW-MOS    TO RTWMOSO
 13668     MOVE CL-PRIORITY-CD         TO PRICDO.
 13669     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 13670     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 13671     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 13672     MOVE CL-AUTO-PAY-SEQ        TO PI-AUTO-PAY-SEQ.
 13673
 13674 5020-EXIT.
 13675     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 259
* EL131.cbl
 13677 5030-MOVE-CERT.
 13678
 13679     IF CM-CERT-EFF-DT GREATER THAN LOW-VALUES
 13680         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 13681         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 13682         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13683         MOVE DC-GREG-DATE-1-EDIT    TO CERTEFFO HOLD-DATE
 13684       ELSE
 13685         MOVE SPACES             TO CERTEFFO
 13686         MOVE ZERO               TO HOLD-DATE.
 13687
 13688     MOVE CM-ACCOUNT             TO CERTACTO.
 13689     MOVE CM-STATE               TO CERTSTO PI-STATE.
 13690     MOVE CM-GROUPING            TO CERTGRPO.
 13691     MOVE CM-CARRIER             TO CERTCARO.
 13692     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 13693     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 13694     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 13695     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 13696     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 13697     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 13698     MOVE CM-JT-INITIAL          TO JNTINITO.
 13699     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 13700
 13701*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 13702     MOVE PI-COMPANY-ID          TO CNTL-CO-ID.
 13703     MOVE '3'                    TO CNTL-REC-TYPE.
 13704     MOVE SPACES                 TO CNTL-STATE-ACCESS.
 13705     MOVE CM-STATE               TO CNTL-STATE-NUMBER.
 13706     MOVE ZERO                   TO CNTL-SEQ-NO.
 13707
 13708
 13709* EXEC CICS READ
 13710*         SET        (ADDRESS OF CONTROL-FILE)
 13711*         DATASET    ('ELCNTL')
 13712*         RIDFLD     (CNTL-KEY)
 13713*         RESP       (WS-RESPONSE)
 13714*    END-EXEC.
 13715     MOVE 'ELCNTL' TO DFHEIV1
 13716*    MOVE '&"S        E          (  N#00011564' TO DFHEIV0
 13717     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13718     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13719     MOVE X'204E233030303131353634' TO DFHEIV0(25:11)
 13720     CALL 'kxdfhei1' USING DFHEIV0,
 13721           DFHEIV1,
 13722           DFHEIV20,
 13723           DFHEIV99,
 13724           CNTL-KEY,
 13725           DFHEIV99,
 13726           DFHEIV99,
 13727           DFHEIV99
 13728     SET ADDRESS OF CONTROL-FILE TO
 13729         DFHEIV20
 13730     MOVE EIBRESP  TO WS-RESPONSE
 13731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13732
 13733
 13734     IF WS-RESP-NOTFND
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 260
* EL131.cbl
 13735        MOVE ZERO                TO CP-FREE-LOOK
 13736     ELSE
 13737        MOVE CF-ST-FREE-LOOK-PERIOD
 13738                                 TO CP-FREE-LOOK.
 13739
 13740     IF CM-LF-BENEFIT-CD = '00'
 13741        GO TO 5030-MOVE-CERT-AH.
 13742
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 261
* EL131.cbl
 13744     MOVE EIBDATE                TO DC-JULIAN-YYDDD
 13745     MOVE '5'                    TO DC-OPTION-CODE
 13746     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13747     MOVE DC-BIN-DATE-1          TO WS-BIN-CURRENT-DT.
 13748     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 13749     MOVE CM-LF-BENEFIT-CD       TO LCVCDO HOLD-BENEFIT.
 13750     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO  CP-ORIGINAL-TERM.
 13751     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 13752     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13753     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT
 13754     MOVE '4'                    TO CP-REM-TERM-METHOD
 13755     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 13756     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13757     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 13758
 13759     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 13760     IF CM-LF-PREMIUM-RATE NUMERIC
 13761         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 13762     ELSE
 13763         MOVE ZEROS              TO LCVRATEO.
 13764
 13765     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 13766         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT.
 13767
 13768     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
 13769
 13770     MOVE CM-POLICY-FORM-NO      TO LCVFORMO.
 13771
 13772     IF CM-LF-CURRENT-STATUS = '8'
 13773        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 13774            MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 13775            MOVE ' '             TO DC-OPTION-CODE
 13776            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13777            IF NOT DATE-CONVERSION-ERROR
 13778                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 13779
 13780     IF CM-LF-CURRENT-STATUS = '7'
 13781        IF CM-LF-DEATH-DT NOT = LOW-VALUES
 13782            MOVE CM-LF-DEATH-DT  TO DC-BIN-DATE-1
 13783            MOVE ' '             TO DC-OPTION-CODE
 13784            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13785            IF NOT DATE-CONVERSION-ERROR
 13786                MOVE DC-GREG-DATE-1-EDIT     TO LCVCNDTO.
 13787
 13788     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 13789         MOVE ' '                TO DC-OPTION-CODE
 13790         MOVE CM-LF-DEATH-EXIT-DT TO DC-BIN-DATE-1
 13791         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13792         IF NOT DATE-CONVERSION-ERROR
 13793             MOVE DC-GREG-DATE-1-EDIT TO HOLD-DATE
 13794             MOVE HOLD-MONTH     TO WORK-MONTH
 13795             MOVE HOLD-YEAR      TO WORK-YEAR
 13796             MOVE WORK-DATE-MY   TO LCVEXITO.
 13797
 13798     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 13799        IF CP-REMAINING-TERM-3 = ZEROS
 13800           MOVE 'EXPIRED'        TO LCVSTATO
 13801        ELSE
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 262
* EL131.cbl
 13802           MOVE 'ACTIVE'         TO LCVSTATO.
 13803
 13804     IF CM-LF-CURRENT-STATUS = '2'
 13805        MOVE 'PEND   '           TO LCVSTATO.
 13806     IF CM-LF-CURRENT-STATUS = '3'
 13807        MOVE 'RESTORE'           TO LCVSTATO.
 13808     IF CM-LF-CURRENT-STATUS = '5'
 13809        MOVE 'REISSUE'           TO LCVSTATO.
 13810     IF CM-LF-CURRENT-STATUS = '6'
 13811        MOVE 'LMP DIS'           TO LCVSTATO.
 13812     IF CM-LF-CURRENT-STATUS = '7'
 13813        MOVE 'DEATH  '           TO LCVSTATO.
 13814     IF CM-LF-CURRENT-STATUS = '8'
 13815        MOVE 'CANCEL '           TO LCVSTATO.
 13816     IF CM-LF-CURRENT-STATUS = '9'
 13817        MOVE 'RE-ONLY'           TO LCVSTATO.
 13818     IF CM-LF-CURRENT-STATUS = 'V'
 13819        MOVE 'VOID   '           TO LCVSTATO.
 13820     IF CM-LF-CURRENT-STATUS = 'D'
 13821        MOVE 'DECLINE'           TO LCVSTATO.
 13822
 13823     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 13824     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 13825     MOVE '4'                    TO BEN-REC-TYPE.
 13826     MOVE CM-LF-BENEFIT-CD       TO BEN-ACC-CD.
 13827     MOVE ZERO                   TO BEN-SEQ-NO.
 13828
 13829
 13830* EXEC CICS READ GTEQ
 13831*         DATASET  (CNTL-FILE-ID)
 13832*         RIDFLD   (BENEFIT-KEY)
 13833*         SET      (ADDRESS OF CONTROL-FILE)
 13834*    END-EXEC.
 13835*    MOVE '&"S        G          (   #00011666' TO DFHEIV0
 13836     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13837     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13838     MOVE X'2020233030303131363636' TO DFHEIV0(25:11)
 13839     CALL 'kxdfhei1' USING DFHEIV0,
 13840           CNTL-FILE-ID,
 13841           DFHEIV20,
 13842           DFHEIV99,
 13843           BENEFIT-KEY,
 13844           DFHEIV99,
 13845           DFHEIV99,
 13846           DFHEIV99
 13847     SET ADDRESS OF CONTROL-FILE TO
 13848         DFHEIV20
 13849     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13850
 13851
 13852     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 13853        CF-RECORD-TYPE NOT = '4'
 13854         MOVE ER-0240            TO EMI-ERROR
 13855         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13856         GO TO 5030-MOVE-CERT-FINISH.
 13857
 13858     MOVE ZERO                   TO COUNT-2.
 13859     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 263
* EL131.cbl
 13860
 13861     IF SCREEN-ERROR
 13862         MOVE ER-0282            TO EMI-ERROR
 13863         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13864        ELSE
 13865         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO LCVKINDO.
 13866
 13867 5030-MOVE-CERT-AH.
 13868
 13869     IF CM-LF-BENEFIT-CD = '00'
 13870         IF CM-AH-BENEFIT-CD = '00'
 13871             GO TO 5030-MOVE-CERT-FINISH.
 13872
 13873     IF CM-AH-BENEFIT-CD = '00'
 13874        MOVE SPACES             TO ACVKINDO
 13875        COMPUTE PI-PAYMENT-AMT =
 13876                    CM-LF-BENEFIT-AMT / CM-LF-ORIG-TERM
 13877        GO TO 5030-MOVE-CERT-FINISH.
 13878
 13879     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 13880     MOVE CM-AH-BENEFIT-CD       TO ACVCDO HOLD-BENEFIT.
 13881     MOVE DC-GREG-DATE-1-EDIT    TO HOLD-DATE.
 13882     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO CP-ORIGINAL-TERM.
 13883     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
 13884     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 13885     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 13886     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 13887
 13888**DMD **********************************************
 13889     IF PI-COMPANY-ID = 'DMD'
 13890         COMPUTE WS-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 13891                                   CM-PMT-EXTENSION-DAYS
 13892         COMPUTE WS-REM-TERM-IN-DAYS = WS-TERM-IN-DAYS -
 13893                                      CL-NO-OF-DAYS-PAID
 13894         DIVIDE WS-REM-TERM-IN-DAYS BY +30
 13895             GIVING WS-REM-MOS REMAINDER WS-REM-DAYS
 13896         MOVE WS-REM-MOS         TO ACVRTRMO
 13897                                    CP-REMAINING-TERM-3
 13898*        MOVE WS-REM-DAYS        TO DAYSPO
 13899         GO TO 5030-SKIP-RTRM.
 13900**DMD **********************************************
 13901
 13902     MOVE '4'                    TO CP-REM-TERM-METHOD.
 13903     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 13904     PERFORM 9700-LINK-RTRM-FILE-ID THRU 9700-EXIT.
 13905     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 13906
 13907 5030-SKIP-RTRM.
 13908     IF CM-AH-PREMIUM-RATE NUMERIC
 13909         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 13910     ELSE
 13911         MOVE ZEROS              TO ACVRATEO.
 13912
 13913     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO  PI-PAYMENT-AMT.
 13914     MOVE CM-POLICY-FORM-NO      TO ACVFORMO.
 13915
 13916     IF CM-AH-CURRENT-STATUS = '8'
 13917        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 264
* EL131.cbl
 13918            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 13919            MOVE ' '             TO DC-OPTION-CODE
 13920            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13921            IF NOT DATE-CONVERSION-ERROR
 13922                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13923
 13924     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 13925        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 13926            MOVE CM-AH-SETTLEMENT-DT         TO DC-BIN-DATE-1
 13927            MOVE ' '             TO DC-OPTION-CODE
 13928            PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13929            IF NOT DATE-CONVERSION-ERROR
 13930                MOVE DC-GREG-DATE-1-EDIT     TO ACVCNDTO.
 13931
 13932     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 13933        IF CP-REMAINING-TERM-3 = ZEROS
 13934           MOVE 'EXPIRED'        TO ACVSTATO
 13935        ELSE
 13936           MOVE 'ACTIVE'         TO ACVSTATO.
 13937
 13938     IF CM-AH-CURRENT-STATUS = '2'
 13939        MOVE 'PEND   '           TO ACVSTATO.
 13940     IF CM-AH-CURRENT-STATUS = '3'
 13941        MOVE 'RESTORE'           TO ACVSTATO.
 13942     IF CM-AH-CURRENT-STATUS = '5'
 13943        MOVE 'REISSUE'           TO ACVSTATO.
 13944     IF CM-AH-CURRENT-STATUS = '6'
 13945        MOVE 'LMP DIS'           TO ACVSTATO.
 13946     IF CM-AH-CURRENT-STATUS = '7'
 13947        MOVE 'DEATH  '           TO ACVSTATO.
 13948     IF CM-AH-CURRENT-STATUS = '8'
 13949        MOVE 'CANCEL '           TO ACVSTATO.
 13950     IF CM-AH-CURRENT-STATUS = '9'
 13951        MOVE 'RE-ONLY'           TO ACVSTATO.
 13952     IF CM-AH-CURRENT-STATUS = 'V'
 13953        MOVE 'VOID   '           TO ACVSTATO.
 13954     IF CM-AH-CURRENT-STATUS = '9'
 13955        MOVE 'DECLINE'           TO ACVSTATO.
 13956
 13957     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 13958         MOVE ' '                TO DC-OPTION-CODE
 13959         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 13960         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 13961         IF NOT DATE-CONVERSION-ERROR
 13962             MOVE DC-GREG-DATE-1-EDIT     TO HOLD-DATE
 13963             MOVE HOLD-MONTH     TO WORK-MONTH
 13964             MOVE HOLD-YEAR      TO WORK-YEAR
 13965             MOVE WORK-DATE-MY   TO ACVEXITO.
 13966
 13967     MOVE SPACES                 TO BENEFIT-KEY ERROR-SWITCH.
 13968
 13969     MOVE PI-COMPANY-ID          TO BEN-CO-ID.
 13970     MOVE '5'                    TO BEN-REC-TYPE.
 13971     MOVE CM-AH-BENEFIT-CD       TO BEN-ACC-CD.
 13972     MOVE ZERO                   TO BEN-SEQ-NO.
 13973
 13974
 13975* EXEC CICS READ GTEQ
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 265
* EL131.cbl
 13976*         DATASET  (CNTL-FILE-ID)
 13977*         RIDFLD   (BENEFIT-KEY)
 13978*         SET      (ADDRESS OF CONTROL-FILE)
 13979*    END-EXEC.
 13980*    MOVE '&"S        G          (   #00011794' TO DFHEIV0
 13981     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13982     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13983     MOVE X'2020233030303131373934' TO DFHEIV0(25:11)
 13984     CALL 'kxdfhei1' USING DFHEIV0,
 13985           CNTL-FILE-ID,
 13986           DFHEIV20,
 13987           DFHEIV99,
 13988           BENEFIT-KEY,
 13989           DFHEIV99,
 13990           DFHEIV99,
 13991           DFHEIV99
 13992     SET ADDRESS OF CONTROL-FILE TO
 13993         DFHEIV20
 13994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13995
 13996
 13997     IF CF-COMPANY-ID NOT = PI-COMPANY-ID OR
 13998        CF-RECORD-TYPE NOT = '5'
 13999         MOVE ER-0250            TO EMI-ERROR
 14000         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14001         GO TO 5030-MOVE-CERT-FINISH.
 14002
 14003     MOVE ZERO                   TO COUNT-2.
 14004     PERFORM 5040-FIND-BENEFIT THRU 5060-EXIT.
 14005
 14006     IF SCREEN-ERROR
 14007         MOVE ER-0283            TO EMI-ERROR
 14008         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14009       ELSE
 14010         MOVE CF-BENEFIT-ALPHA (COUNT-2) TO ACVKINDO.
 14011
 14012 5030-MOVE-CERT-FINISH.
 14013
 14014     MOVE CM-LOAN-APR            TO APRO.
 14015     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 14016     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 14017     MOVE CM-PREMIUM-TYPE        TO PREMTYPO  PI-PREM-TYPE.
 14018     MOVE CM-LOAN-NUMBER         TO LOANNOO
 14019     MOVE CM-LOAN-BALANCE        TO LOANBALO.
 14020     MOVE CM-SPECIAL-REIN-CODE   TO REINCDO.
 14021
 14022     IF CM-LAST-ADD-ON-DT NOT = SPACES  AND  ZEROS
 14023         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 14024         MOVE SPACES             TO DC-OPTION-CODE DC-ERROR-CODE
 14025         PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14026         MOVE DC-GREG-DATE-1-EDIT  TO ADDONDTO
 14027     ELSE
 14028         MOVE SPACES               TO ADDONDTO.
 14029
 14030     MOVE CM-CLAIM-INTERFACE-SW  TO PI-CERT-SWITCH.
 14031
 14032 5030-EXIT.
 14033     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 266
* EL131.cbl
 14035 5040-FIND-BENEFIT.
 14036     ADD 1                       TO COUNT-2.
 14037     IF COUNT-2 GREATER THAN 8
 14038         GO TO 5050-BENEFIT-NOTFND.
 14039
 14040     IF CF-BENEFIT-CODE (COUNT-2) = HOLD-BENEFIT
 14041         GO TO 5060-EXIT.
 14042
 14043     IF CF-BENEFIT-CODE (COUNT-2) GREATER THAN HOLD-BENEFIT
 14044         GO TO 5050-BENEFIT-NOTFND.
 14045
 14046     GO TO 5040-FIND-BENEFIT.
 14047
 14048 5050-BENEFIT-NOTFND.
 14049     MOVE 'X'                    TO ERROR-SWITCH.
 14050
 14051 5060-EXIT.
 14052     EXIT.
 14053
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 267
* EL131.cbl
 14055 6000-CALCULATE-CERT-TERM.
 14056
 14057     IF CM-LF-PREMIUM-RATE NOT NUMERIC
 14058         MOVE ZEROS              TO CM-LF-PREMIUM-RATE.
 14059     IF CM-AH-PREMIUM-RATE NOT NUMERIC
 14060         MOVE ZEROS              TO CM-AH-PREMIUM-RATE.
 14061     IF CM-LOAN-APR NOT NUMERIC
 14062         MOVE ZEROS              TO CM-LOAN-APR.
 14063
 14064*    IF WS-CALC-METHOD  = 'G'
 14065         PERFORM 6100-CALC-GROSS-TERM THRU 6200-EXIT
 14066*     ELSE
 14067*        PERFORM 6500-CALC-NET-TERM   THRU 6700-EXIT.
 14068
 14069     IF N GREATER 120
 14070         MOVE 120                TO N.
 14071
 14072     MOVE '6'                    TO DC-OPTION-CODE.
 14073     MOVE N                      TO DC-ELAPSED-MONTHS.
 14074     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14075     PERFORM 9800-CONVERT-DATE THRU 9800-EXIT.
 14076
 14077     IF CM-LF-BENEFIT-CD NOT = ZERO
 14078         MOVE N                  TO CM-LF-ORIG-TERM
 14079         COMPUTE CM-LF-BENEFIT-AMT = PI-PAYMENT-AMT * N
 14080         IF NO-CONVERSION-ERROR
 14081             MOVE DC-BIN-DATE-2  TO CM-LF-LOAN-EXPIRE-DT.
 14082
 14083     IF CM-AH-BENEFIT-CD NOT = ZERO
 14084         MOVE N                  TO CM-AH-ORIG-TERM
 14085         IF NO-CONVERSION-ERROR
 14086             MOVE DC-BIN-DATE-2  TO CM-AH-LOAN-EXPIRE-DT.
 14087
 14088 6000-EXIT.
 14089      EXIT.
 14090
 14091 6100-CALC-GROSS-TERM.
 14092     MOVE CM-LOAN-BALANCE         TO L.
 14093     MOVE PI-PAYMENT-AMT          TO M.
 14094
 14095     COMPUTE N = L / M.
 14096     IF N LESS 1
 14097         MOVE 1  TO N.
 14098
 14099     IF CM-LF-BENEFIT-CD NOT = ZERO
 14100         COMPUTE WS-LF-RATE = CM-LF-PREMIUM-RATE / +1000
 14101     ELSE
 14102         MOVE ZEROS               TO WS-LF-RATE.
 14103
 14104     IF CM-AH-BENEFIT-CD NOT = ZERO
 14105         COMPUTE WS-AH-RATE = CM-AH-PREMIUM-RATE / +1000
 14106     ELSE
 14107         MOVE ZEROS               TO WS-AH-RATE.
 14108
 14109     COMPUTE I = CM-LOAN-APR / +1200.
 14110
 14111 6105-LOOP.
 14112     IF N GREATER 240
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 268
* EL131.cbl
 14113         GO TO 6200-EXIT.
 14114     PERFORM 6210-CALC-LEFT-RIGHTONE THRU 6220-EXIT.
 14115     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 14116         ADD 1 TO N
 14117         GO TO 6105-LOOP.
 14118
 14119 6200-EXIT.
 14120      EXIT.
 14121
 14122 6210-CALC-LEFT-RIGHTONE.
 14123      MOVE L         TO LEFT-TOT-1.
 14124      SUBTRACT 1 FROM N.
 14125      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 14126      PERFORM 6350-CALC-IA-N THRU 6400-EXIT.
 14127      ADD 1 TO N.
 14128 6211-CALC-TERM1.
 14129      MOVE N         TO TERM1.
 14130      MULTIPLY M BY TERM1.
 14131 6212-LOOP.
 14132      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 14133      ADD 1 TO A-N.
 14134      MULTIPLY A-N BY TERM1.
 14135      SUBTRACT 1 FROM A-N.
 14136      ADD TERM1 TO LEFT-TOT-1.
 14137 6213-CALC-TERM2.
 14138      MOVE M         TO TERM2.
 14139      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
 14140      MULTIPLY IA-N BY TERM2.
 14141      SUBTRACT TERM2 FROM LEFT-TOT-1.
 14142 6215-CALC-RIGHTONE.
 14143      MOVE M         TO RIGHT-TOT-1.
 14144      PERFORM 6300-CALC-A-N THRU 6300-EXIT.
 14145      MULTIPLY A-N BY RIGHT-TOT-1.
 14146 6220-EXIT.
 14147      EXIT.
 14148
 14149 6300-CALC-A-N.
 14150     IF N LESS 1
 14151         MOVE 0     TO A-N
 14152         GO TO 6300-EXIT.
 14153     IF I = 0
 14154         MOVE .00001 TO I.
 14155     ADD 1 TO I.
 14156     DIVIDE I INTO 1 GIVING V.
 14157     SUBTRACT 1 FROM I.
 14158     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 14159     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 14160     DIVIDE I INTO TERM3 GIVING A-N.
 14161 6300-EXIT.
 14162      EXIT.
 14163
 14164 6350-CALC-IA-N.
 14165     IF N LESS 1
 14166         MOVE 0      TO IA-N
 14167         GO TO 6400-EXIT.
 14168     ADD 1 TO N.
 14169     PERFORM 6450-CALC-V-EX-N THRU 6490-EXIT.
 14170     SUBTRACT 1 FROM N.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 269
* EL131.cbl
 14171     MULTIPLY N BY V-EX-N GIVING TERM3.
 14172     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 14173     SUBTRACT V FROM 1 GIVING TERM4.
 14174     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 14175 6400-EXIT.
 14176      EXIT.
 14177
 14178 6450-CALC-V-EX-N.
 14179     IF N LESS 1
 14180         MOVE 1    TO V-EX-N
 14181         GO TO 6490-EXIT.
 14182     MOVE N        TO NV-STORE.
 14183     IF V-EX-ONETIME = 1  OR
 14184        V NOT = V-EXPONENT (1)
 14185          PERFORM 6470-BUILD-V-EX-TABLE THRU 6480-EXIT.
 14186 6460-LOOP.
 14187     IF N GREATER 248
 14188         MOVE 248 TO N.
 14189     IF N = 1
 14190         MOVE V               TO V-EX-N
 14191      ELSE
 14192         MOVE V-EXPONENT (N)  TO V-EX-N.
 14193     GO TO 6490-EXIT.
 14194
 14195 6470-BUILD-V-EX-TABLE.
 14196     MOVE 2      TO N.
 14197     MOVE V      TO V-EXPONENT (1)
 14198                    V-EX-N.
 14199 6471-LOOP.
 14200     MULTIPLY V BY V-EX-N.
 14201     MOVE V-EX-N   TO V-EXPONENT (N).
 14202     ADD 1 TO N.
 14203     IF N LESS 248
 14204         GO TO 6471-LOOP.
 14205     MOVE NV-STORE     TO N.
 14206     MOVE 0            TO V-EX-ONETIME.
 14207 6480-EXIT.
 14208      EXIT.
 14209
 14210 6490-EXIT.
 14211      EXIT.
 14212
 14213 6500-CALC-NET-TERM.
 14214     MOVE CM-LOAN-BALANCE         TO L.
 14215     MOVE PI-PAYMENT-AMT          TO M.
 14216
 14217     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 14218     IF WS-REMAIN GREATER ZERO
 14219         ADD 1 TO N.
 14220     IF N = 0
 14221         MOVE 1 TO N.
 14222
 14223 6700-EXIT.
 14224      EXIT.
 14225
 14226 6999-CALC-TERM-EXIT.
 14227     EXIT.
 14228
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 270
* EL131.cbl
 14230 7000-RESET-ATTRIBUTE.
 14231
 14232     MOVE AL-UANON               TO CERTEFFA  CERTACTA
 14233                                    CERTSTA   CERTCARA
 14234                                    CERTGRPA.
 14235     MOVE -1                     TO CERTCARL.
 14236
 14237 7000-EXIT.
 14238     EXIT.
 14239
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 271
* EL131.cbl
 14241 7600-BROWSE-CLAIM.
 14242
 14243
 14244* EXEC CICS READ
 14245*        DATASET(CLMS-FILE-ID)
 14246*        SET    (ADDRESS OF CLAIM-MASTER)
 14247*        RIDFLD (MSTR-KEY)
 14248*        GENERIC
 14249*        EQUAL
 14250*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14251*    END-EXEC.
 14252*    MOVE '&"S  KG    E          (   #00012046' TO DFHEIV0
 14253     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14254     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14255     MOVE X'2020233030303132303436' TO DFHEIV0(25:11)
 14256     CALL 'kxdfhei1' USING DFHEIV0,
 14257           CLMS-FILE-ID,
 14258           DFHEIV20,
 14259           DFHEIV99,
 14260           MSTR-KEY,
 14261           ELMSTR-GENERIC-LENGTH,
 14262           DFHEIV99,
 14263           DFHEIV99
 14264     SET ADDRESS OF CLAIM-MASTER TO
 14265         DFHEIV20
 14266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14267
 14268
 14269     MOVE CL-CONTROL-PRIMARY     TO MSTR-KEY.
 14270
 14271     if cl-assoc-cert-total = 0
 14272        move 1 to cl-assoc-cert-total
 14273     end-if
 14274     IF CL-ASSOC-CERT-SEQU = 0
 14275        MOVE 1 TO CL-ASSOC-CERT-SEQU
 14276     END-IF
 14277
 14278     IF CL-ASSOC-CERT-TOTAL = 1
 14279         MOVE AL-SADOF           TO BCERT1A
 14280                                    BSUFX1A
 14281                                    BCERT2A
 14282                                    BSUFX2A
 14283                                    BCERT3A
 14284                                    BSUFX3A
 14285                                    BCERT4A
 14286                                    BSUFX4A
 14287                                    BCERT5A
 14288                                    BSUFX5A
 14289                                    PCERTNOA
 14290                                    PSUFXA
 14291                                    LABEL1A
 14292                                    LABEL2A
 14293         GO TO 7699-EXIT.
 14294
 14295 7610-BROWSE-CLAIM-LOOP.
 14296
 14297     MOVE LOW-VALUES             TO BCERT1O
 14298                                    BSUFX1O
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 272
* EL131.cbl
 14299                                    BCERT2O
 14300                                    BSUFX2O
 14301                                    BCERT3O
 14302                                    BSUFX3O
 14303                                    BCERT4O
 14304                                    BSUFX4O
 14305                                    BCERT5O
 14306                                    BSUFX5O.
 14307
 14308
 14309* EXEC CICS HANDLE CONDITION
 14310*        ENDFILE  (7630-END-BROWSE)
 14311*    END-EXEC.
 14312*    MOVE '"$''                   ! C #00012094' TO DFHEIV0
 14313     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14314     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14315     MOVE X'4320233030303132303934' TO DFHEIV0(25:11)
 14316     CALL 'kxdfhei1' USING DFHEIV0
 14317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14318
 14319
 14320
 14321* EXEC CICS STARTBR
 14322*        DATASET    (CLMS-FILE-ID)
 14323*        RIDFLD     (MSTR-KEY)
 14324*    END-EXEC.
 14325     MOVE 0
 14326       TO DFHEIV11
 14327*    MOVE '&,         G          &   #00012098' TO DFHEIV0
 14328     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14329     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14330     MOVE X'2020233030303132303938' TO DFHEIV0(25:11)
 14331     CALL 'kxdfhei1' USING DFHEIV0,
 14332           CLMS-FILE-ID,
 14333           MSTR-KEY,
 14334           DFHEIV99,
 14335           DFHEIV11,
 14336           DFHEIV99
 14337     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14338
 14339
 14340     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 14341
 14342 7620-READ-CLAIM-LOOP.
 14343
 14344
 14345* EXEC CICS READNEXT
 14346*        DATASET   (CLMS-FILE-ID)
 14347*        SET       (ADDRESS OF CLAIM-MASTER)
 14348*        RIDFLD    (MSTR-KEY)
 14349*    END-EXEC.
 14350     MOVE 0
 14351       TO DFHEIV11
 14352*    MOVE '&.S                   )   #00012107' TO DFHEIV0
 14353     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14354     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14355     MOVE X'2020233030303132313037' TO DFHEIV0(25:11)
 14356     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 273
* EL131.cbl
 14357           CLMS-FILE-ID,
 14358           DFHEIV20,
 14359           DFHEIV99,
 14360           MSTR-KEY,
 14361           DFHEIV99,
 14362           DFHEIV11,
 14363           DFHEIV99,
 14364           DFHEIV99
 14365     SET ADDRESS OF CLAIM-MASTER TO
 14366         DFHEIV20
 14367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14368
 14369
 14370     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD   OR
 14371        CL-CARRIER     NOT = CARRI           OR
 14372        CL-CLAIM-NO    NOT = CLAIMI
 14373        GO TO 7630-END-BROWSE.
 14374
 14375     IF WS-ASSOCIATED-CERTS = 1
 14376         MOVE CL-CERT-PRIME      TO BCERT1O
 14377         MOVE CL-CERT-SFX        TO BSUFX1O.
 14378
 14379     IF WS-ASSOCIATED-CERTS = 2
 14380         MOVE CL-CERT-PRIME      TO BCERT2O
 14381         MOVE CL-CERT-SFX        TO BSUFX2O.
 14382
 14383     IF WS-ASSOCIATED-CERTS = 3
 14384         MOVE CL-CERT-PRIME      TO BCERT3O
 14385         MOVE CL-CERT-SFX        TO BSUFX3O.
 14386
 14387     IF WS-ASSOCIATED-CERTS = 4
 14388         MOVE CL-CERT-PRIME      TO BCERT4O
 14389         MOVE CL-CERT-SFX        TO BSUFX4O.
 14390
 14391     IF WS-ASSOCIATED-CERTS = 5
 14392         MOVE CL-CERT-PRIME      TO BCERT5O
 14393         MOVE CL-CERT-SFX        TO BSUFX5O
 14394     ELSE
 14395         ADD +1                  TO WS-ASSOCIATED-CERTS
 14396         GO TO 7620-READ-CLAIM-LOOP.
 14397
 14398 7630-END-BROWSE.
 14399
 14400
 14401* EXEC CICS ENDBR
 14402*        DATASET   (CLMS-FILE-ID)
 14403*    END-EXEC.
 14404     MOVE 0
 14405       TO DFHEIV11
 14406*    MOVE '&2                    $   #00012143' TO DFHEIV0
 14407     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14408     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14409     MOVE X'2020233030303132313433' TO DFHEIV0(25:11)
 14410     CALL 'kxdfhei1' USING DFHEIV0,
 14411           CLMS-FILE-ID,
 14412           DFHEIV11,
 14413           DFHEIV99
 14414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 274
* EL131.cbl
 14415
 14416
 14417 7640-HIGHLIGHT-CERT-DISPLAYED.
 14418
 14419     MOVE AL-SANON               TO BCERT1A
 14420                                    BSUFX1A
 14421                                    BCERT2A
 14422                                    BSUFX2A
 14423                                    BCERT3A
 14424                                    BSUFX3A
 14425                                    BCERT4A
 14426                                    BSUFX4A
 14427                                    BCERT5A
 14428                                    BSUFX5A.
 14429
 14430     IF BCERT1O = CERTI AND
 14431        BSUFX1O = SUFXI
 14432            MOVE AL-SABON        TO BCERT1A
 14433                                    BSUFX1A.
 14434
 14435     IF BCERT2O = CERTI AND
 14436        BSUFX2O = SUFXI
 14437            MOVE AL-SABON        TO BCERT2A
 14438                                    BSUFX2A.
 14439
 14440     IF BCERT3O = CERTI AND
 14441        BSUFX3O = SUFXI
 14442            MOVE AL-SABON        TO BCERT3A
 14443                                    BSUFX3A.
 14444
 14445     IF BCERT4O = CERTI AND
 14446        BSUFX4O = SUFXI
 14447            MOVE AL-SABON        TO BCERT4A
 14448                                    BSUFX4A.
 14449
 14450     IF BCERT5O = CERTI AND
 14451        BSUFX5O = SUFXI
 14452            MOVE AL-SABON        TO BCERT5A
 14453                                    BSUFX5A.
 14454
 14455 7699-EXIT.
 14456     EXIT.
 14457
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 275
* EL131.cbl
 14459 7700-CHECK-SEQUENCE.
 14460
 14461
 14462* EXEC CICS HANDLE CONDITION
 14463*        ENDFILE  (7799-EXIT)
 14464*        NOTFND   (7799-EXIT)
 14465*    END-EXEC.
 14466*    MOVE '"$''I                  ! D #00012191' TO DFHEIV0
 14467     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 14468     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14469     MOVE X'4420233030303132313931' TO DFHEIV0(25:11)
 14470     CALL 'kxdfhei1' USING DFHEIV0
 14471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14472
 14473
 14474
 14475* EXEC CICS READ
 14476*        DATASET(CLMS-FILE-ID)
 14477*        SET    (ADDRESS OF CLAIM-MASTER)
 14478*        RIDFLD (MSTR-KEY)
 14479*        GENERIC
 14480*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 14481*    END-EXEC.
 14482*    MOVE '&"S  KG    E          (   #00012196' TO DFHEIV0
 14483     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 14484     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14485     MOVE X'2020233030303132313936' TO DFHEIV0(25:11)
 14486     CALL 'kxdfhei1' USING DFHEIV0,
 14487           CLMS-FILE-ID,
 14488           DFHEIV20,
 14489           DFHEIV99,
 14490           MSTR-KEY,
 14491           ELMSTR-GENERIC-LENGTH,
 14492           DFHEIV99,
 14493           DFHEIV99
 14494     SET ADDRESS OF CLAIM-MASTER TO
 14495         DFHEIV20
 14496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14497
 14498
 14499     COMPUTE WS-ASSOC-CERT-TOTAL =
 14500             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 14501
 14502     GO TO 7799-EXIT.
 14503
 14504 7710-RESEQUENCE-CLAIMS.
 14505
 14506
 14507* EXEC CICS HANDLE CONDITION
 14508*        ENDFILE  (7799-EXIT)
 14509*    END-EXEC.
 14510*    MOVE '"$''                   ! E #00012211' TO DFHEIV0
 14511     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 14512     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14513     MOVE X'4520233030303132323131' TO DFHEIV0(25:11)
 14514     CALL 'kxdfhei1' USING DFHEIV0
 14515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14516
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 276
* EL131.cbl
 14517
 14518
 14519* EXEC CICS STARTBR
 14520*        DATASET(CLMS-FILE-ID)
 14521*        RIDFLD (MSTR-KEY)
 14522*    END-EXEC.
 14523     MOVE 0
 14524       TO DFHEIV11
 14525*    MOVE '&,         G          &   #00012215' TO DFHEIV0
 14526     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14527     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14528     MOVE X'2020233030303132323135' TO DFHEIV0(25:11)
 14529     CALL 'kxdfhei1' USING DFHEIV0,
 14530           CLMS-FILE-ID,
 14531           MSTR-KEY,
 14532           DFHEIV99,
 14533           DFHEIV11,
 14534           DFHEIV99
 14535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14536
 14537
 14538     COMPUTE WS-ASSOC-CERT-SEQU =
 14539             WS-ASSOC-CERT-SEQU + 1.
 14540
 14541     COMPUTE WS-READNEXT-SWITCH =
 14542             WS-READNEXT-SWITCH + 1.
 14543
 14544 7720-READ-CLAIM-LOOP.
 14545
 14546
 14547* EXEC CICS READNEXT
 14548*        DATASET(CLMS-FILE-ID)
 14549*        SET    (ADDRESS OF CLAIM-MASTER)
 14550*        RIDFLD (MSTR-KEY)
 14551*    END-EXEC.
 14552     MOVE 0
 14553       TO DFHEIV11
 14554*    MOVE '&.S                   )   #00012228' TO DFHEIV0
 14555     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14556     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14557     MOVE X'2020233030303132323238' TO DFHEIV0(25:11)
 14558     CALL 'kxdfhei1' USING DFHEIV0,
 14559           CLMS-FILE-ID,
 14560           DFHEIV20,
 14561           DFHEIV99,
 14562           MSTR-KEY,
 14563           DFHEIV99,
 14564           DFHEIV11,
 14565           DFHEIV99,
 14566           DFHEIV99
 14567     SET ADDRESS OF CLAIM-MASTER TO
 14568         DFHEIV20
 14569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14570
 14571
 14572     IF WS-READNEXT-SWITCH = 1
 14573         ADD 1                   TO WS-READNEXT-SWITCH
 14574         GO TO 7720-READ-CLAIM-LOOP.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 277
* EL131.cbl
 14575
 14576 7730-END-BROWSE.
 14577
 14578
 14579* EXEC CICS ENDBR
 14580*        DATASET(CLMS-FILE-ID)
 14581*    END-EXEC.
 14582     MOVE 0
 14583       TO DFHEIV11
 14584*    MOVE '&2                    $   #00012240' TO DFHEIV0
 14585     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14586     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14587     MOVE X'2020233030303132323430' TO DFHEIV0(25:11)
 14588     CALL 'kxdfhei1' USING DFHEIV0,
 14589           CLMS-FILE-ID,
 14590           DFHEIV11,
 14591           DFHEIV99
 14592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14593
 14594
 14595 7740-READ-CLAIM-UPDATE.
 14596
 14597     IF CL-COMPANY-CD  NOT = WS-SAVE-COMPANY-CD  OR
 14598        CL-CARRIER     NOT = WS-SAVE-CARRIER     OR
 14599        CL-CLAIM-NO    NOT = WS-SAVE-CLAIM-NO
 14600        GO TO 7799-EXIT
 14601     ELSE
 14602        MOVE ZERO                TO WS-READNEXT-SWITCH.
 14603
 14604
 14605* EXEC CICS READ
 14606*        DATASET(CLMS-FILE-ID)
 14607*        SET    (ADDRESS OF CLAIM-MASTER)
 14608*        RIDFLD (MSTR-KEY)
 14609*        UPDATE
 14610*    END-EXEC.
 14611*    MOVE '&"S        EU         (   #00012253' TO DFHEIV0
 14612     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14613     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14614     MOVE X'2020233030303132323533' TO DFHEIV0(25:11)
 14615     CALL 'kxdfhei1' USING DFHEIV0,
 14616           CLMS-FILE-ID,
 14617           DFHEIV20,
 14618           DFHEIV99,
 14619           MSTR-KEY,
 14620           DFHEIV99,
 14621           DFHEIV99,
 14622           DFHEIV99
 14623     SET ADDRESS OF CLAIM-MASTER TO
 14624         DFHEIV20
 14625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14626
 14627
 14628     if (cl-priority-cd = '8')
 14629        and (pi-processor-id not = 'PEMA' and 'JMS '
 14630             AND 'AMWA')
 14631        MOVE ER-8003             TO EMI-ERROR
 14632        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 278
* EL131.cbl
 14633                                 THRU 9900-EXIT
 14634        MOVE -1                  TO MAINTL
 14635        GO TO 8110-SEND-DATA
 14636     end-if
 14637
 14638     IF PI-COMPANY-ID = 'CID' or 'AHL'
 14639         MOVE 'Y'                TO CL-YESNOSW
 14640     END-IF.
 14641
 14642     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 14643     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 14644
 14645
 14646* EXEC CICS REWRITE
 14647*         DATASET(CLMS-FILE-ID)
 14648*         FROM   (CLAIM-MASTER)
 14649*    END-EXEC.
 14650     MOVE LENGTH OF
 14651      CLAIM-MASTER
 14652       TO DFHEIV11
 14653*    MOVE '&& L                  %   #00012277' TO DFHEIV0
 14654     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14655     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14656     MOVE X'2020233030303132323737' TO DFHEIV0(25:11)
 14657     CALL 'kxdfhei1' USING DFHEIV0,
 14658           CLMS-FILE-ID,
 14659           CLAIM-MASTER,
 14660           DFHEIV11,
 14661           DFHEIV99
 14662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14663
 14664
 14665     GO TO 7710-RESEQUENCE-CLAIMS.
 14666
 14667 7799-EXIT.
 14668     EXIT.
 14669
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 279
* EL131.cbl
 14671 7800-CHECK-AUTO-ACTIVITY.
 14672
 14673
 14674* EXEC CICS HANDLE CONDITION
 14675*        NOTFND   (7800-NOT-FOUND)
 14676*    END-EXEC.
 14677*    MOVE '"$I                   ! F #00012290' TO DFHEIV0
 14678     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14679     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14680     MOVE X'4620233030303132323930' TO DFHEIV0(25:11)
 14681     CALL 'kxdfhei1' USING DFHEIV0
 14682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14683
 14684
 14685     MOVE PI-COMPANY-ID              TO  CNTL-CO-ID.
 14686     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14687     MOVE SPACES                     TO  CNTL-PROC-ID.
 14688     MOVE +0                         TO  CNTL-SEQ-NO.
 14689
 14690
 14691* EXEC CICS READ
 14692*        DATASET   (CNTL-FILE-ID)
 14693*        RIDFLD    (CNTL-KEY)
 14694*        SET       (ADDRESS OF CONTROL-FILE)
 14695*    END-EXEC.
 14696*    MOVE '&"S        E          (   #00012299' TO DFHEIV0
 14697     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14698     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14699     MOVE X'2020233030303132323939' TO DFHEIV0(25:11)
 14700     CALL 'kxdfhei1' USING DFHEIV0,
 14701           CNTL-FILE-ID,
 14702           DFHEIV20,
 14703           DFHEIV99,
 14704           CNTL-KEY,
 14705           DFHEIV99,
 14706           DFHEIV99,
 14707           DFHEIV99
 14708     SET ADDRESS OF CONTROL-FILE TO
 14709         DFHEIV20
 14710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14711
 14712
 14713     IF CL-ACTIVITY-CODE IS NOT NUMERIC
 14714         MOVE ZEROS                  TO  CL-ACTIVITY-CODE.
 14715
 14716     IF CL-ACTIVITY-CODE NOT = ZEROS
 14717         MOVE CL-ACTIVITY-CODE                 TO  MISC-SUB
 14718         IF MISC-SUB IS GREATER THAN +9
 14719             SUBTRACT +9 FROM MISC-SUB
 14720             MOVE CF-USER-RESET-SW (MISC-SUB)  TO  WS-RESET-SW
 14721         ELSE
 14722             MOVE CF-SYS-RESET-SW  (MISC-SUB)  TO  WS-RESET-SW
 14723     ELSE
 14724         MOVE 'Y'                              TO  WS-RESET-SW.
 14725
 14726     IF STATUSI = 'C' OR 'CLOSED'
 14727         IF CF-SYS-ACTIVE-SW (7) = ' ' OR 'N'
 14728             MOVE 'N'                TO  PI-REC-FOUND-SW
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 280
* EL131.cbl
 14729                                         PI-LETTER-SW
 14730             GO TO 7800-EXIT.
 14731
 14732     IF STATUSI = 'C' OR 'CLOSED'
 14733         IF CF-SYS-LETTER-ID (7) = SPACES OR LOW-VALUES
 14734             MOVE 'N'                TO  PI-LETTER-SW
 14735         ELSE
 14736             MOVE 'Y'                TO  PI-LETTER-SW.
 14737
 14738     IF STATUSI = 'O' OR 'OPEN'
 14739         IF CF-SYS-ACTIVE-SW (8) = ' ' OR 'N'
 14740             MOVE 'N'                TO  PI-REC-FOUND-SW
 14741                                         PI-LETTER-SW
 14742             GO TO 7800-EXIT.
 14743
 14744     IF STATUSI = 'O' OR 'OPEN'
 14745         IF CF-SYS-LETTER-ID (8) = SPACES OR LOW-VALUES
 14746             MOVE 'N'                TO  PI-LETTER-SW
 14747         ELSE
 14748             MOVE 'Y'                TO  PI-LETTER-SW.
 14749
 14750     MOVE 'Y'                        TO  PI-REC-FOUND-SW.
 14751     GO TO 7800-EXIT.
 14752
 14753 7800-NOT-FOUND.
 14754
 14755     MOVE 'N'                        TO  PI-REC-FOUND-SW
 14756                                         PI-LETTER-SW.
 14757
 14758 7800-EXIT.
 14759     EXIT.
 14760
 14761 7850-AUTO-LETTER-WRITER.
 14762
 14763     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 14764     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 14765
 14766     IF STATUSI = 'C' OR 'CLOSED'
 14767         MOVE CF-SYS-LETTER-ID (7)   TO  W-1523-FORM-NUMBER
 14768     ELSE
 14769         MOVE CF-SYS-LETTER-ID (8)   TO  W-1523-FORM-NUMBER.
 14770
 14771     IF STATUSI = 'C' OR 'CLOSED'
 14772         IF CF-SYS-RESEND-DAYS (7) NOT = ZEROS
 14773             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14774             MOVE '6'                TO  DC-OPTION-CODE
 14775             MOVE CF-SYS-RESEND-DAYS (7) TO  DC-ELAPSED-DAYS
 14776             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14777             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14778             IF NO-CONVERSION-ERROR
 14779                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 14780             ELSE
 14781                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 14782
 14783     IF STATUSI = 'C' OR 'CLOSED'
 14784         IF CF-SYS-FOLLOW-UP-DAYS (7) NOT = ZEROS
 14785             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14786             MOVE '6'                TO  DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 281
* EL131.cbl
 14787             MOVE CF-SYS-FOLLOW-UP-DAYS (7) TO  DC-ELAPSED-DAYS
 14788             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14789             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14790             IF NO-CONVERSION-ERROR
 14791                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 14792             ELSE
 14793                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 14794
 14795     IF STATUSI = 'O' OR 'OPEN'
 14796         IF CF-SYS-RESEND-DAYS (8) NOT = ZEROS
 14797             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14798             MOVE '6'                TO  DC-OPTION-CODE
 14799             MOVE CF-SYS-RESEND-DAYS (8) TO  DC-ELAPSED-DAYS
 14800             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14801             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14802             IF NO-CONVERSION-ERROR
 14803                 MOVE DC-BIN-DATE-2  TO  W-1523-RESEND-DATE
 14804             ELSE
 14805                 MOVE LOW-VALUES     TO  W-1523-RESEND-DATE.
 14806
 14807     IF STATUSI = 'O' OR 'OPEN'
 14808         IF CF-SYS-FOLLOW-UP-DAYS (8) NOT = ZEROS
 14809             MOVE SAVE-BIN-DATE      TO  DC-BIN-DATE-1
 14810             MOVE '6'                TO  DC-OPTION-CODE
 14811             MOVE CF-SYS-FOLLOW-UP-DAYS (8) TO  DC-ELAPSED-DAYS
 14812             MOVE +0                 TO  DC-ELAPSED-MONTHS
 14813             PERFORM 9800-CONVERT-DATE THRU 9800-EXIT
 14814             IF NO-CONVERSION-ERROR
 14815                 MOVE DC-BIN-DATE-2  TO  W-1523-FOLLOW-UP-DATE
 14816             ELSE
 14817                 MOVE LOW-VALUES     TO  W-1523-FOLLOW-UP-DATE.
 14818
 14819
 14820* EXEC CICS LINK
 14821*        PROGRAM    (LINK-1523)
 14822*        COMMAREA   (W-1523-LINKDATA)
 14823*        LENGTH     (W-1523-COMM-LENGTH)
 14824*    END-EXEC.
 14825*    MOVE '."C                   (   #00012411' TO DFHEIV0
 14826     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14827     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14828     MOVE X'2020233030303132343131' TO DFHEIV0(25:11)
 14829     CALL 'kxdfhei1' USING DFHEIV0,
 14830           LINK-1523,
 14831           W-1523-LINKDATA,
 14832           W-1523-COMM-LENGTH,
 14833           DFHEIV99,
 14834           DFHEIV99,
 14835           DFHEIV99,
 14836           DFHEIV99
 14837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14838
 14839
 14840     IF W-1523-ERROR-CODE = ZEROS
 14841         GO TO 7850-EXIT.
 14842
 14843     IF W-1523-FATAL-ERROR
 14844         MOVE ER-0802                TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 282
* EL131.cbl
 14845         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14846
 14847     IF W-1523-ERROR-CODE = 0191
 14848         MOVE ER-0803                TO  EMI-ERROR
 14849         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14850
 14851 7850-EXIT.
 14852     EXIT.
 14853
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 283
* EL131.cbl
 14855 8000-CREATE-DMO-REC.
 14856     MOVE PI-COMPANY-CD          TO NOTE-COMP-CD.
 14857     MOVE CL-CERT-KEY-DATA       TO NOTE-CERT-KEY.
 14858     MOVE CL-CERT-NO             TO NOTE-CERT-NO.
 14859
 14860
 14861* EXEC CICS HANDLE CONDITION
 14862*         NOTFND   (8000-NOTE-NOT-FOUND)
 14863*    END-EXEC.
 14864*    MOVE '"$I                   ! G #00012437' TO DFHEIV0
 14865     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14866     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14867     MOVE X'4720233030303132343337' TO DFHEIV0(25:11)
 14868     CALL 'kxdfhei1' USING DFHEIV0
 14869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14870
 14871
 14872
 14873* EXEC CICS READ
 14874*         DATASET(NOTE-FILE-ID)
 14875*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14876*         RIDFLD (NOTE-KEY)
 14877*    END-EXEC.
 14878*    MOVE '&"S        E          (   #00012441' TO DFHEIV0
 14879     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14880     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14881     MOVE X'2020233030303132343431' TO DFHEIV0(25:11)
 14882     CALL 'kxdfhei1' USING DFHEIV0,
 14883           NOTE-FILE-ID,
 14884           DFHEIV20,
 14885           DFHEIV99,
 14886           NOTE-KEY,
 14887           DFHEIV99,
 14888           DFHEIV99,
 14889           DFHEIV99
 14890     SET ADDRESS OF CERTIFICATE-NOTE TO
 14891         DFHEIV20
 14892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14893
 14894
 14895     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14896     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14897     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14898
 14899     IF CL-CERT-GROUPING (5:2) = SPACES OR ZEROS
 14900         MOVE 'CC'               TO DCT-PRODUCT-CODE
 14901     ELSE
 14902         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14903
 14904     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14905     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14906
 14907
 14908* EXEC CICS LINK
 14909*        PROGRAM    ('DLO006')
 14910*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14911*        LENGTH     (WS-DCT-LENGTH)
 14912*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 284
* EL131.cbl
 14913     MOVE 'DLO006' TO DFHEIV1
 14914*    MOVE '."C                   (   #00012459' TO DFHEIV0
 14915     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14916     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14917     MOVE X'2020233030303132343539' TO DFHEIV0(25:11)
 14918     CALL 'kxdfhei1' USING DFHEIV0,
 14919           DFHEIV1,
 14920           DCT-COMMUNICATION-AREA,
 14921           WS-DCT-LENGTH,
 14922           DFHEIV99,
 14923           DFHEIV99,
 14924           DFHEIV99,
 14925           DFHEIV99
 14926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14927
 14928
 14929     IF  DCT-RETURN-CODE = 'OK'
 14930         GO TO 8000-CONT.
 14931
 14932     IF DCT-RETURN-CODE = '01' OR '02'
 14933         GO TO 8000-EXIT.
 14934
 14935     IF DCT-RETURN-CODE = '03'
 14936         MOVE ER-0951            TO EMI-ERROR
 14937         MOVE -1                 TO MAINTL
 14938         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14939         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14940         GO TO 8110-SEND-DATA.
 14941
 14942     IF DCT-RETURN-CODE = '04'
 14943         MOVE ER-0946            TO EMI-ERROR
 14944         MOVE -1                 TO MAINTL
 14945         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14946         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14947         GO TO 8110-SEND-DATA.
 14948
 14949     IF DCT-RETURN-CODE = '05'
 14950         MOVE ER-0947            TO EMI-ERROR
 14951         MOVE -1                 TO MAINTL
 14952         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14953         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14954         GO TO 8110-SEND-DATA.
 14955
 14956     IF DCT-RETURN-CODE = '06'
 14957         MOVE ER-0921            TO EMI-ERROR
 14958         MOVE -1                 TO MAINTL
 14959         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14960         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14961         GO TO 8110-SEND-DATA.
 14962
 14963     IF DCT-RETURN-CODE = '07'
 14964         MOVE ER-0919            TO EMI-ERROR
 14965         MOVE -1                 TO MAINTL
 14966         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14967         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14968         GO TO 8110-SEND-DATA.
 14969
 14970     IF DCT-RETURN-CODE = '08'
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 285
* EL131.cbl
 14971         MOVE ER-0948            TO EMI-ERROR
 14972         MOVE -1                 TO MAINTL
 14973         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14974         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14975         GO TO 8110-SEND-DATA.
 14976
 14977     IF DCT-RETURN-CODE = 'N1'
 14978         MOVE ER-0950            TO EMI-ERROR
 14979         MOVE -1                 TO MAINTL
 14980         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14981         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14982         GO TO 8110-SEND-DATA.
 14983
 14984     IF DCT-RETURN-CODE = 'E1'
 14985         MOVE ER-0974            TO EMI-ERROR
 14986         MOVE -1                 TO MAINTL
 14987         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14988         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14989         GO TO 8110-SEND-DATA.
 14990
 14991     IF DCT-RETURN-CODE = 'E2'
 14992         MOVE ER-0975            TO EMI-ERROR
 14993         MOVE -1                 TO MAINTL
 14994         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14995         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 14996         GO TO 8110-SEND-DATA.
 14997
 14998     IF DCT-RETURN-CODE NOT = 'OK'
 14999         MOVE ER-0949            TO EMI-ERROR
 15000         MOVE -1                 TO MAINTL
 15001         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15002         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15003         GO TO 8110-SEND-DATA.
 15004
 15005 8000-CONT.
 15006
 15007     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 15008     MOVE 'CS'                   TO DM-RECORD-TYPE.
 15009     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 15010     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 15011     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 15012     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 15013     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 15014     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 15015
 15016     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 15017     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 15018     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 15019     PERFORM 8050-FORMAT-LAST-NAME-1ST THRU 8050-EXIT.
 15020     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 15021
 15022     IF STATUSI = 'OPEN' OR 'O'
 15023         MOVE 'R'                TO DM-STAT-CHANGE-TYPE
 15024      ELSE
 15025         MOVE 'C'                TO DM-STAT-CHANGE-TYPE.
 15026
 15027     IF STATUSI = 'OPEN' OR 'O'
 15028        IF CL-NO-OF-PMTS-MADE = 0
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 286
* EL131.cbl
 15029         MOVE '1'                TO DM-CLAIM-STATUS
 15030      ELSE
 15031         MOVE '2'                TO DM-CLAIM-STATUS.
 15032
 15033     IF STATUSI = 'CLOSED' OR 'C'
 15034        IF NOT FINAL-PAID
 15035         MOVE '3'                TO DM-CLAIM-STATUS
 15036      ELSE
 15037         MOVE '4'                TO DM-CLAIM-STATUS.
 15038
 15039     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 15040
 15041
 15042* EXEC CICS LINK
 15043*        PROGRAM    ('DLO025')
 15044*        COMMAREA   (DMO-COMMUNICATION-AREA)
 15045*        LENGTH     (WS-DMO-LENGTH)
 15046*    END-EXEC.
 15047     MOVE 'DLO025' TO DFHEIV1
 15048*    MOVE '."C                   (   #00012577' TO DFHEIV0
 15049     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15050     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15051     MOVE X'2020233030303132353737' TO DFHEIV0(25:11)
 15052     CALL 'kxdfhei1' USING DFHEIV0,
 15053           DFHEIV1,
 15054           DMO-COMMUNICATION-AREA,
 15055           WS-DMO-LENGTH,
 15056           DFHEIV99,
 15057           DFHEIV99,
 15058           DFHEIV99,
 15059           DFHEIV99
 15060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15061
 15062
 15063     IF  DM-RETURN-CODE = 'OK'
 15064         GO TO 8000-EXIT.
 15065
 15066     IF DM-RETURN-CODE = '01'
 15067         MOVE ER-8051            TO EMI-ERROR
 15068         MOVE -1                 TO MAINTL
 15069         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15070         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15071         GO TO 8110-SEND-DATA.
 15072
 15073     IF DM-RETURN-CODE = '02'
 15074         MOVE ER-8052            TO EMI-ERROR
 15075         MOVE -1                 TO MAINTL
 15076         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15077         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15078         GO TO 8110-SEND-DATA.
 15079
 15080     IF DM-RETURN-CODE = '03'
 15081         MOVE ER-8053            TO EMI-ERROR
 15082         MOVE -1                 TO MAINTL
 15083         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15084         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15085         GO TO 8110-SEND-DATA.
 15086
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 287
* EL131.cbl
 15087     IF DM-RETURN-CODE = '04'
 15088         MOVE ER-8054            TO EMI-ERROR
 15089         MOVE -1                 TO MAINTL
 15090         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15091         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15092         GO TO 8110-SEND-DATA.
 15093
 15094     IF DM-RETURN-CODE = '05'
 15095         MOVE ER-8055            TO EMI-ERROR
 15096         MOVE -1                 TO MAINTL
 15097         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15098         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15099         GO TO 8110-SEND-DATA.
 15100
 15101     IF DM-RETURN-CODE = '06'
 15102         MOVE ER-8056            TO EMI-ERROR
 15103         MOVE -1                 TO MAINTL
 15104         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15105         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15106         GO TO 8110-SEND-DATA.
 15107
 15108     IF DM-RETURN-CODE = '07'
 15109         MOVE ER-8057            TO EMI-ERROR
 15110         MOVE -1                 TO MAINTL
 15111         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15112         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15113         GO TO 8110-SEND-DATA.
 15114
 15115     IF DM-RETURN-CODE = '08'
 15116         MOVE ER-8058            TO EMI-ERROR
 15117         MOVE -1                 TO MAINTL
 15118         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15119         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15120         GO TO 8110-SEND-DATA.
 15121
 15122     IF DM-RETURN-CODE = '09'
 15123         MOVE ER-8059            TO EMI-ERROR
 15124         MOVE -1                 TO MAINTL
 15125         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15126         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15127         GO TO 8110-SEND-DATA.
 15128
 15129     IF DM-RETURN-CODE = '10'
 15130         MOVE ER-8060            TO EMI-ERROR
 15131         MOVE -1                 TO MAINTL
 15132         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15133         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15134         GO TO 8110-SEND-DATA.
 15135
 15136     IF DM-RETURN-CODE = '11'
 15137         MOVE ER-8061            TO EMI-ERROR
 15138         MOVE -1                 TO MAINTL
 15139         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15140         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15141         GO TO 8110-SEND-DATA.
 15142
 15143     IF DM-RETURN-CODE = '12'
 15144         MOVE ER-8062            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 288
* EL131.cbl
 15145         MOVE -1                 TO MAINTL
 15146         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15147         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15148         GO TO 8110-SEND-DATA.
 15149
 15150     IF DM-RETURN-CODE = '13'
 15151         MOVE ER-8063            TO EMI-ERROR
 15152         MOVE -1                 TO MAINTL
 15153         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15154         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15155         GO TO 8110-SEND-DATA.
 15156
 15157     IF DM-RETURN-CODE = '14'
 15158         MOVE ER-8064            TO EMI-ERROR
 15159         MOVE -1                 TO MAINTL
 15160         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15161         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15162         GO TO 8110-SEND-DATA.
 15163
 15164     IF DM-RETURN-CODE = '15'
 15165         MOVE ER-8065            TO EMI-ERROR
 15166         MOVE -1                 TO MAINTL
 15167         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15168         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15169         GO TO 8110-SEND-DATA.
 15170
 15171     IF DM-RETURN-CODE = '16'
 15172         MOVE ER-8154            TO EMI-ERROR
 15173         MOVE -1                 TO MAINTL
 15174         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15175         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15176         GO TO 8110-SEND-DATA.
 15177
 15178     IF DM-RETURN-CODE = '17'
 15179         MOVE ER-8155            TO EMI-ERROR
 15180         MOVE -1                 TO MAINTL
 15181         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15182         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15183         GO TO 8110-SEND-DATA.
 15184
 15185     IF DM-RETURN-CODE = 'N1'
 15186         MOVE ER-8152            TO EMI-ERROR
 15187         MOVE -1                 TO MAINTL
 15188         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15189         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15190         GO TO 8110-SEND-DATA.
 15191
 15192     IF DM-RETURN-CODE = 'E1'
 15193         MOVE ER-8153            TO EMI-ERROR
 15194         MOVE -1                 TO MAINTL
 15195         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15196         PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT
 15197         GO TO 8110-SEND-DATA.
 15198
 15199     MOVE ER-8066                TO EMI-ERROR.
 15200     MOVE -1                     TO MAINTL.
 15201     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15202     PERFORM 8070-UNLOCK-CLAIM-MSTR THRU 8070-EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 289
* EL131.cbl
 15203     GO TO 8110-SEND-DATA.
 15204
 15205 8000-NOTE-NOT-FOUND.
 15206
 15207* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 15208*    MOVE '6"R                   !   #00012726' TO DFHEIV0
 15209     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15210     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15211     MOVE X'2020233030303132373236' TO DFHEIV0(25:11)
 15212     CALL 'kxdfhei1' USING DFHEIV0
 15213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15214
 15215     MOVE ER-0954                TO EMI-ERROR.
 15216     MOVE -1                     TO MAINTL.
 15217     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15218     GO TO 8110-SEND-DATA.
 15219
 15220 8000-EXIT.
 15221     EXIT.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 290
* EL131.cbl
 15223 8050-FORMAT-LAST-NAME-1ST.
 15224*****************************************************************
 15225*             M O V E   N A M E   R O U T I N E                 *
 15226*                                                               *
 15227*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15228*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15229*     FIELDS IN THE FOLLOWING WORKING-STORAGE FIELDS.           *
 15230*                                                               *
 15231*                  FIELD               VALUE                    *
 15232*                  -----               -----                    *
 15233*           W-NAME-LAST    (CL15)      SMITH                    *
 15234*           W-NAME-FIRST   (CL15)      JOHN                     *
 15235*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15236*                                                               *
 15237*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK WILL CONTAIN       *
 15238*                SMITH, JOHN ALLEN                              *
 15239*                     OR                                        *
 15240*                SMITH, JOHN A.                                 *
 15241*                                                               *
 15242*     TO USE THIS ROUTINE YOU NEED THE WORKING-STORAGE          *
 15243*     COPYBOOK, ELCNWA.                                         *
 15244*****************************************************************.
 15245
 15246     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15247     MOVE ZERO                   TO WS-NAME-SW.
 15248     SET NWA-INDEX               TO +1.
 15249
 15250     IF W-NAME-LAST   = SPACES  AND
 15251        W-NAME-MIDDLE = SPACES
 15252          MOVE +1                TO WS-NAME-SW.
 15253
 15254     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15255     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15256
 15257     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15258     PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15259
 15260     SET NWA-INDEX UP BY +1.
 15261
 15262     IF W-NAME-MIDDLE NOT = SPACES
 15263         IF W-NAME-MIDDLE-2 = SPACES
 15264             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15265             SET NWA-INDEX UP BY +1
 15266             MOVE '.'            TO WS-NW (NWA-INDEX)
 15267             SET NWA-INDEX UP BY +2
 15268         ELSE
 15269             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15270             PERFORM 8060-MOVE-NAME THRU 8060-EXIT.
 15271
 15272 8050-EXIT.
 15273     EXIT.
 15274
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 291
* EL131.cbl
 15276 8060-MOVE-NAME.
 15277     IF WS-NAME-SW GREATER THAN +1
 15278         GO TO 8060-EXIT.
 15279
 15280     IF WS-NAME-WORK2 = SPACES
 15281         GO TO 8060-EXIT.
 15282
 15283     SET NWA-INDEX2            TO +1.
 15284     SET NWA-INDEX3            TO +2.
 15285
 15286 8060-MOVE-NAME-CYCLE.
 15287     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15288
 15289     IF NWA-INDEX LESS THAN +30
 15290         SET NWA-INDEX UP BY +1
 15291     ELSE
 15292         ADD +2 TO  WS-NAME-SW
 15293         GO TO 8060-EXIT.
 15294
 15295     IF NWA-INDEX2 LESS THAN +20
 15296         SET NWA-INDEX3 UP BY +1
 15297         SET NWA-INDEX2 UP BY +1.
 15298
 15299     IF WS-NW2 (NWA-INDEX2) = SPACES  AND
 15300        WS-NW2 (NWA-INDEX3) = SPACES
 15301         IF WS-NAME-SW = ZERO
 15302             MOVE ','            TO WS-NW (NWA-INDEX)
 15303             SET NWA-INDEX UP BY +2
 15304             MOVE +1             TO WS-NAME-SW
 15305             GO TO 8060-EXIT
 15306         ELSE
 15307             GO TO 8060-EXIT.
 15308
 15309     GO TO 8060-MOVE-NAME-CYCLE.
 15310
 15311 8060-EXIT.
 15312     EXIT.
 15313
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 292
* EL131.cbl
 15315
 15316 8070-UNLOCK-CLAIM-MSTR.
 15317
 15318* EXEC CICS UNLOCK
 15319*        DATASET   (CLMS-FILE-ID)
 15320*    END-EXEC.
 15321*    MOVE '&*                    #   #00012829' TO DFHEIV0
 15322     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 15323     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15324     MOVE X'2020233030303132383239' TO DFHEIV0(25:11)
 15325     CALL 'kxdfhei1' USING DFHEIV0,
 15326           CLMS-FILE-ID,
 15327           DFHEIV99
 15328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15329
 15330
 15331 8070-EXIT.
 15332      EXIT.
 15333
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 293
* EL131.cbl
 15335 8100-SEND-MAP.
 15336     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 15337
 15338     IF NOT PI-NO-CARRIER-SECURITY
 15339        MOVE AL-SANOF            TO CERTCARA.
 15340     IF NOT PI-NO-ACCOUNT-SECURITY
 15341        MOVE AL-SANOF            TO CERTACTA.
 15342
 15343     IF PI-PROCESSOR-ID = 'LGXX'
 15344        MOVE AL-UANON            TO CCNOA.
 15345
 15346     IF PI-COMPANY-ID = 'DMD'
 15347        NEXT SENTENCE
 15348     ELSE
 15349        MOVE AL-SADOF            TO PFKEY6A.
 15350
 15351     IF PI-USES-PAID-TO
 15352        MOVE 'PAID TO  :' TO PTHRHDGO.
 15353
 15354
 15355* EXEC CICS SEND
 15356*         MAP     ('EL131A')
 15357*         MAPSET  ('EL131S')
 15358*         ERASE
 15359*         FREEKB
 15360*         CURSOR
 15361*    END-EXEC.
 15362     MOVE 'EL131A' TO DFHEIV1
 15363     MOVE -1
 15364       TO DFHEIV11
 15365     MOVE 'EL131S' TO DFHEIV2
 15366*    MOVE '8$     CT  E F  H     ,   #00012856' TO DFHEIV0
 15367     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15368     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 15369     MOVE X'2020233030303132383536' TO DFHEIV0(25:11)
 15370     CALL 'kxdfhei1' USING DFHEIV0,
 15371           DFHEIV1,
 15372           EL131AO,
 15373           DFHEIV99,
 15374           DFHEIV2,
 15375           DFHEIV99,
 15376           DFHEIV99,
 15377           DFHEIV99,
 15378           DFHEIV11,
 15379           DFHEIV99,
 15380           DFHEIV99,
 15381           DFHEIV99
 15382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15383
 15384
 15385     GO TO 9000-RETURN-TRANS.
 15386
 15387 8110-SEND-DATA.
 15388     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
 15389
 15390     IF PI-USES-PAID-TO
 15391        MOVE 'PAID TO  :' TO PTHRHDGO.
 15392
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 294
* EL131.cbl
 15393     IF PI-PROCESSOR-ID = 'LGXX'
 15394        MOVE AL-UANON            TO CCNOA.
 15395
 15396     IF PI-COMPANY-ID = 'DMD'
 15397        NEXT SENTENCE
 15398     ELSE
 15399        MOVE AL-SADOF            TO PFKEY6A.
 15400
 15401
 15402* EXEC CICS SEND
 15403*         MAP      ('EL131A')
 15404*         MAPSET   ('EL131S')
 15405*         DATAONLY
 15406*         FREEKB
 15407*         CURSOR
 15408*    END-EXEC.
 15409     MOVE 'EL131A' TO DFHEIV1
 15410     MOVE -1
 15411       TO DFHEIV11
 15412     MOVE 'EL131S' TO DFHEIV2
 15413*    MOVE '8$D    CT    F  H     ,   #00012880' TO DFHEIV0
 15414     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15415     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
 15416     MOVE X'2020233030303132383830' TO DFHEIV0(25:11)
 15417     CALL 'kxdfhei1' USING DFHEIV0,
 15418           DFHEIV1,
 15419           EL131AO,
 15420           DFHEIV99,
 15421           DFHEIV2,
 15422           DFHEIV99,
 15423           DFHEIV99,
 15424           DFHEIV99,
 15425           DFHEIV11,
 15426           DFHEIV99,
 15427           DFHEIV99,
 15428           DFHEIV99
 15429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15430
 15431
 15432     GO TO 9000-RETURN-TRANS.
 15433
 15434 8120-FORMAT-TIME-DATE.
 15435     perform 8140-check-for-prev-errors
 15436                                 thru 8140-exit
 15437     IF SKIP-ATTRIBUTE = 'Y'
 15438        MOVE SPACES              TO SKIP-ATTRIBUTE
 15439        MOVE ER-0598             TO EMI-ERROR
 15440        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15441        GO TO 8125-SKIP-ATTRIBUTE.
 15442
 15443*     IF PI-COMPANY-ID = 'DMD'
 15444      IF PI-PROCESSOR-ID <> 'EMER'
 15445         MOVE AL-PANOF           TO CERTEFFA  CERTACTA  CERTSTA
 15446                                    CERTCARA  CERTGRPA CERTA SUFXA
 15447
 15448     MOVE AL-PANOF               TO CRTLNMEA  CRTFNMEA  CRTINITA
 15449                                    ISSAGEA   JNTLNMEA  JNTFNMEA
 15450                                    JNTINITA  JNTAGEA   APRA
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 295
* EL131.cbl
 15451                                    LCVCDA    LCVOTRMA  LCVRTRMA
 15452                                    LCVBENEA  LCVFORMA  LCVCNDTA
 15453                                    LCVEXITA  LCVSTATA  LCVKINDA
 15454                                    ACVCDA    ACVOTRMA  ACVRTRMA
 15455                                    ACVBENEA  ACVFORMA  ACVCNDTA
 15456                                    ACVEXITA  ACVSTATA  ACVKINDA
 15457                                    PMTFREQA  INDGRPA   PREMTYPA
 15458                                    REINCDA   LCVRATEA  ACVRATEA
 15459                                    ADDONDTA.
 15460
 15461*    IF PI-PROCESSOR-ID NOT = 'LGXX'
 15462*       IF PI-COMPANY-ID = 'DMD'
 15463*          MOVE AL-SANOF         TO TYPEA     CERTA     CERTSTA
 15464*                                   SUFXA
 15465*                                   PDAMTA    NODAYSA   NOPMTSA
 15466*                                   INCA      OCCA
 15467*          IF NOT SYSTEM-MODIFY-CAP
 15468*              MOVE AL-SANOF         TO PDTHRUA.
 15469
 15470     IF PI-COMPANY-ID NOT = 'CRI' AND 'PEM' AND 'NCL'
 15471         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15472
 15473 8125-SKIP-ATTRIBUTE.
 15474
 15475     MOVE SAVE-DATE              TO DATEO.
 15476
 15477* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
 15478*    END-EXEC
 15479*    MOVE '0"A                   "   #00012932' TO DFHEIV0
 15480     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
 15481     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
 15482     MOVE X'2020233030303132393332' TO DFHEIV0(25:11)
 15483     CALL 'kxdfhei1' USING DFHEIV0,
 15484           LCP-CICS-TIME
 15485     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15486
 15487* EXEC CICS FORMATTIME
 15488*              ABSTIME(LCP-CICS-TIME)
 15489*              TIME(LCP-TIME-OF-DAY-XX)
 15490*    END-EXEC
 15491*    MOVE 'j$(     (             #   #00012934' TO DFHEIV0
 15492     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
 15493     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15494     MOVE X'2020233030303132393334' TO DFHEIV0(25:11)
 15495     CALL 'kxdfhei1' USING DFHEIV0,
 15496           LCP-CICS-TIME,
 15497           LCP-TIME-OF-DAY-XX
 15498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15499     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
 15500     MOVE UN-HOURS               TO FOR-HOURS.
 15501     MOVE UN-MINUTES             TO FOR-MINUTES.
 15502     MOVE TIME-OUT               TO TIMEO.
 15503     MOVE PI-COMPANY-ID          TO COMPO.
 15504     MOVE PI-PROCESSOR-ID        TO USERIDO.
 15505     MOVE MAP-ID                 TO PI-CURRENT-SCREEN-NO.
 15506     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15507     MOVE EMI-MESSAGE-AREA (1)   TO MSG1O.
 15508     MOVE EMI-MESSAGE-AREA (2)   TO MSG2O.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 296
* EL131.cbl
 15509
 15510 8130-EXIT.
 15511     EXIT.
 15512
 15513 8140-check-for-prev-errors.
 15514
 15515     MOVE PI-COMPANY-CD          TO trlr-company-cd
 15516     MOVE PI-CARRIER             TO trlr-carrier
 15517     MOVE PI-CLAIM-NO            TO trlr-claim-no
 15518     MOVE PI-CERT-NO             TO trlr-cert-no
 15519     MOVE +95                    TO TRLR-SEQ-NO
 15520
 15521
 15522* EXEC CICS READ
 15523*       DATASET  ('ELTRLR')
 15524*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15525*       RIDFLD   (TRLR-KEY)
 15526*       RESP     (WS-RESPONSE)
 15527*    END-EXEC
 15528     MOVE 'ELTRLR' TO DFHEIV1
 15529*    MOVE '&"S        E          (  N#00012960' TO DFHEIV0
 15530     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15531     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15532     MOVE X'204E233030303132393630' TO DFHEIV0(25:11)
 15533     CALL 'kxdfhei1' USING DFHEIV0,
 15534           DFHEIV1,
 15535           DFHEIV20,
 15536           DFHEIV99,
 15537           TRLR-KEY,
 15538           DFHEIV99,
 15539           DFHEIV99,
 15540           DFHEIV99
 15541     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15542         DFHEIV20
 15543     MOVE EIBRESP  TO WS-RESPONSE
 15544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15545
 15546     if ws-resp-normal
 15547        perform varying s1 from +1 by +1 until
 15548           at-note-error-no (s1) = spaces
 15549           if at-note-error-no (s1) = '1652'
 15550              continue
 15551           else
 15552              move at-note-error-no (s1)
 15553                                 to emi-error
 15554              move -1 to maintl
 15555              if at-note-error-no (s1) = '1653'
 15556                 evaluate true
 15557                    when pi-claim-type = 'L'
 15558                       move '  LF  '
 15559                        to emi-claim-type
 15560                    when pi-claim-type = 'I'
 15561                       move '  IU  '
 15562                        to emi-claim-type
 15563                    when other
 15564                       move '  AH  '
 15565                        to emi-claim-type
 15566                 end-evaluate
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 297
* EL131.cbl
 15567              end-if
 15568              PERFORM 9900-ERROR-FORMAT
 15569                                 THRU 9900-EXIT
 15570           end-if
 15571*          if at-note-error-no (s1) = '1653'
 15572*             perform varying emi-sub from 1 by 1 until
 15573*                emi-sub > 3
 15574*                if emi-error-number (emi-sub) = '1653'
 15575*                   evaluate true
 15576*                      when pi-claim-type = 'L'
 15577*                         move '  LF  '
 15578*                          to emi-claim-type
 15579*                      when pi-claim-type = 'I'
 15580*                         move '  IU  '
 15581*                          to emi-claim-type
 15582*                      when other
 15583*                         move '  AH  '
 15584*                          to emi-claim-type
 15585*                   end-evaluate
 15586*                end-if
 15587*             end-perform
 15588*          end-if
 15589        end-perform
 15590     else
 15591        display ' resp not normal ' ws-response ' '
 15592        trlr-key (2:19)
 15593     end-if
 15594
 15595     .
 15596 8140-exit.
 15597     exit.
 15598 8150-ENTERED-CLAIM-NOTFOUND.
 15599
 15600     MOVE ER-0204                TO EMI-ERROR.
 15601     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15602     MOVE -1                     TO MAINTL.
 15603     GO TO 8100-SEND-MAP.
 15604
 15605 8200-RETURN-PRIOR.
 15606     MOVE SPACE                  TO PI-RETURN-CD-1.
 15607     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
 15608     GO TO 9200-XCTL.
 15609
 15610 8300-GET-HELP.
 15611     MOVE XCTL-EL010             TO CALL-PGM.
 15612     GO TO 9200-XCTL.
 15613
 15614 8400-RETURN-MASTER.
 15615     MOVE SPACE                  TO PI-RETURN-CD-1.
 15616     MOVE XCTL-EL126             TO CALL-PGM.
 15617     GO TO 9200-XCTL.
 15618
 15619 8500-TRLR-MNT.
 15620     IF PI-RETURN-CD-1 = 'X'
 15621         MOVE ER-0311            TO EMI-ERROR
 15622         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15623         MOVE -1                 TO MAINTL
 15624         GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 298
* EL131.cbl
 15625
 15626
 15627* EXEC CICS WRITEQ TS
 15628*         QUEUE     (PI-KEY)
 15629*         FROM      (PROGRAM-INTERFACE-BLOCK)
 15630*         LENGTH    (PI-COMM-LENGTH)
 15631*    END-EXEC.
 15632*    MOVE '*"                    ''   #00013047' TO DFHEIV0
 15633     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 15634     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15635     MOVE X'2020233030303133303437' TO DFHEIV0(25:11)
 15636     CALL 'kxdfhei1' USING DFHEIV0,
 15637           PI-KEY,
 15638           PROGRAM-INTERFACE-BLOCK,
 15639           PI-COMM-LENGTH,
 15640           DFHEIV99,
 15641           DFHEIV99,
 15642           DFHEIV99
 15643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15644
 15645
 15646     MOVE XCTL-EL142             TO CALL-PGM.
 15647     GO TO 9200-XCTL.
 15648
 15649 8600-ADDR-MNT.
 15650     IF PI-RETURN-CD-1 = 'X'
 15651         MOVE ER-0311            TO EMI-ERROR
 15652         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15653         MOVE -1                 TO MAINTL
 15654         GO TO 8110-SEND-DATA.
 15655
 15656
 15657* EXEC CICS WRITEQ TS
 15658*         QUEUE     (PI-KEY)
 15659*         FROM      (PROGRAM-INTERFACE-BLOCK)
 15660*         LENGTH    (PI-COMM-LENGTH)
 15661*    END-EXEC.
 15662*    MOVE '*"                    ''   #00013063' TO DFHEIV0
 15663     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 15664     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15665     MOVE X'2020233030303133303633' TO DFHEIV0(25:11)
 15666     CALL 'kxdfhei1' USING DFHEIV0,
 15667           PI-KEY,
 15668           PROGRAM-INTERFACE-BLOCK,
 15669           PI-COMM-LENGTH,
 15670           DFHEIV99,
 15671           DFHEIV99,
 15672           DFHEIV99
 15673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15674
 15675
 15676     MOVE XCTL-EL141             TO CALL-PGM.
 15677     GO TO 9200-XCTL.
 15678
 15679 8700-CERT-MNT.
 15680     IF PI-RETURN-CD-1 = 'X'
 15681         MOVE ER-7690            TO EMI-ERROR
 15682         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 299
* EL131.cbl
 15683         MOVE -1                 TO MAINTL
 15684         GO TO 8110-SEND-DATA.
 15685
 15686
 15687* EXEC CICS WRITEQ TS
 15688*         QUEUE     (PI-KEY)
 15689*         FROM      (PROGRAM-INTERFACE-BLOCK)
 15690*         LENGTH    (PI-COMM-LENGTH)
 15691*    END-EXEC.
 15692*    MOVE '*"                    ''   #00013079' TO DFHEIV0
 15693     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 15694     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15695     MOVE X'2020233030303133303739' TO DFHEIV0(25:11)
 15696     CALL 'kxdfhei1' USING DFHEIV0,
 15697           PI-KEY,
 15698           PROGRAM-INTERFACE-BLOCK,
 15699           PI-COMM-LENGTH,
 15700           DFHEIV99,
 15701           DFHEIV99,
 15702           DFHEIV99
 15703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15704
 15705
 15706     MOVE XCTL-EL1273            TO CALL-PGM.
 15707     GO TO 9200-XCTL.
 15708
 15709 8750-DMD-CLM-FIX.
 15710
 15711* EXEC CICS WRITEQ TS
 15712*         QUEUE     (PI-KEY)
 15713*         FROM      (PROGRAM-INTERFACE-BLOCK)
 15714*         LENGTH    (PI-COMM-LENGTH)
 15715*    END-EXEC.
 15716*    MOVE '*"                    ''   #00013089' TO DFHEIV0
 15717     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
 15718     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15719     MOVE X'2020233030303133303839' TO DFHEIV0(25:11)
 15720     CALL 'kxdfhei1' USING DFHEIV0,
 15721           PI-KEY,
 15722           PROGRAM-INTERFACE-BLOCK,
 15723           PI-COMM-LENGTH,
 15724           DFHEIV99,
 15725           DFHEIV99,
 15726           DFHEIV99
 15727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15728
 15729
 15730     MOVE XCTL-EL400DMD          TO CALL-PGM.
 15731     GO TO 9200-XCTL.
 15732
 15733 8800-UNAUTHORIZED-ACCESS.
 15734     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 15735     GO TO 8990-SEND-TEXT.
 15736
 15737 8810-PF23-ENTERED.
 15738     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 15739     MOVE XCTL-EL005             TO CALL-PGM.
 15740     GO TO 9200-XCTL.
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 300
* EL131.cbl
 15741
 15742 8820-XCTL-ERROR.
 15743
 15744* EXEC CICS HANDLE CONDITION
 15745*        PGMIDERR (8990-SEND-TEXT)
 15746*    END-EXEC.
 15747*    MOVE '"$L                   ! H #00013108' TO DFHEIV0
 15748     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 15749     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15750     MOVE X'4820233030303133313038' TO DFHEIV0(25:11)
 15751     CALL 'kxdfhei1' USING DFHEIV0
 15752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15753
 15754
 15755     MOVE SPACE                 TO PI-ENTRY-CD-1.
 15756     MOVE CALL-PGM              TO PI-CALLING-PROGRAM  LOGOFF-PGM
 15757     MOVE PGMIDERR-MSG          TO LOGOFF-FILL.
 15758     MOVE XCTL-EL005            TO CALL-PGM.
 15759     GO TO 9200-XCTL.
 15760
 15761 8990-SEND-TEXT.
 15762
 15763* EXEC CICS SEND TEXT
 15764*         FROM      (LOGOFF-TEXT)
 15765*         LENGTH    (LOGOFF-LENGTH)
 15766*         ERASE
 15767*         FREEKB
 15768*    END-EXEC.
 15769*    MOVE '8&      T  E F  H   F -   #00013119' TO DFHEIV0
 15770     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 15771     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 15772     MOVE X'2020233030303133313139' TO DFHEIV0(25:11)
 15773     CALL 'kxdfhei1' USING DFHEIV0,
 15774           LOGOFF-TEXT,
 15775           LOGOFF-LENGTH,
 15776           DFHEIV99,
 15777           DFHEIV99,
 15778           DFHEIV99,
 15779           DFHEIV99,
 15780           DFHEIV99,
 15781           DFHEIV99,
 15782           DFHEIV99,
 15783           DFHEIV99,
 15784           DFHEIV99,
 15785           DFHEIV99
 15786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15787
 15788
 15789     GO TO 9100-RETURN-CICS.
 15790
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 301
* EL131.cbl
 15792 9000-RETURN-TRANS.
 15793
 15794* EXEC CICS RETURN
 15795*         TRANSID   (TRANS-ID)
 15796*         COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 15797*         LENGTH    (PI-COMM-LENGTH)
 15798*    END-EXEC.
 15799*    MOVE '.(CT                  ''   #00013130' TO DFHEIV0
 15800     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 15801     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15802     MOVE X'2020233030303133313330' TO DFHEIV0(25:11)
 15803     CALL 'kxdfhei1' USING DFHEIV0,
 15804           TRANS-ID,
 15805           PROGRAM-INTERFACE-BLOCK,
 15806           PI-COMM-LENGTH,
 15807           DFHEIV99,
 15808           DFHEIV99,
 15809           DFHEIV99
 15810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15811
 15812
 15813
 15814* GOBACK.
 15815     MOVE '9%                    "   ' TO DFHEIV0
 15816     MOVE 'EL131' TO DFHEIV1
 15817     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15818     GOBACK.
 15819
 15820 9100-RETURN-CICS.
 15821
 15822* EXEC CICS RETURN
 15823*    END-EXEC.
 15824*    MOVE '.(                    ''   #00013139' TO DFHEIV0
 15825     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15826     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15827     MOVE X'2020233030303133313339' TO DFHEIV0(25:11)
 15828     CALL 'kxdfhei1' USING DFHEIV0,
 15829           DFHEIV99,
 15830           DFHEIV99,
 15831           DFHEIV99,
 15832           DFHEIV99,
 15833           DFHEIV99,
 15834           DFHEIV99
 15835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15836
 15837
 15838
 15839* GOBACK.
 15840     MOVE '9%                    "   ' TO DFHEIV0
 15841     MOVE 'EL131' TO DFHEIV1
 15842     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15843     GOBACK.
 15844
 15845 9200-XCTL.
 15846
 15847* EXEC CICS XCTL
 15848*         PROGRAM    (CALL-PGM)
 15849*         COMMAREA   (PROGRAM-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 302
* EL131.cbl
 15850*         LENGTH     (PI-COMM-LENGTH)
 15851*    END-EXEC.
 15852*    MOVE '.$C                   %   #00013145' TO DFHEIV0
 15853     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 15854     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15855     MOVE X'2020233030303133313435' TO DFHEIV0(25:11)
 15856     CALL 'kxdfhei1' USING DFHEIV0,
 15857           CALL-PGM,
 15858           PROGRAM-INTERFACE-BLOCK,
 15859           PI-COMM-LENGTH,
 15860           DFHEIV99
 15861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15862
 15863
 15864 9700-LINK-RTRM-FILE-ID.
 15865
 15866* EXEC CICS LINK
 15867*        PROGRAM  (RTRM-FILE-ID)
 15868*        COMMAREA (CALCULATION-PASS-AREA)
 15869*        LENGTH   (CP-COMM-LENGTH)
 15870*    END-EXEC.
 15871*    MOVE '."C                   (   #00013152' TO DFHEIV0
 15872     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15873     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15874     MOVE X'2020233030303133313532' TO DFHEIV0(25:11)
 15875     CALL 'kxdfhei1' USING DFHEIV0,
 15876           RTRM-FILE-ID,
 15877           CALCULATION-PASS-AREA,
 15878           CP-COMM-LENGTH,
 15879           DFHEIV99,
 15880           DFHEIV99,
 15881           DFHEIV99,
 15882           DFHEIV99
 15883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15884
 15885
 15886 9700-EXIT.
 15887      EXIT.
 15888
 15889 9800-CONVERT-DATE.
 15890     MOVE SPACES TO DC-ERROR-CODE.
 15891
 15892* EXEC CICS LINK
 15893*         PROGRAM    (DATE-CONV)
 15894*         COMMAREA   (DATE-CONVERSION-DATA)
 15895*         LENGTH     (DC-COMM-LENGTH)
 15896*    END-EXEC.
 15897*    MOVE '."C                   (   #00013163' TO DFHEIV0
 15898     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15899     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15900     MOVE X'2020233030303133313633' TO DFHEIV0(25:11)
 15901     CALL 'kxdfhei1' USING DFHEIV0,
 15902           DATE-CONV,
 15903           DATE-CONVERSION-DATA,
 15904           DC-COMM-LENGTH,
 15905           DFHEIV99,
 15906           DFHEIV99,
 15907           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 303
* EL131.cbl
 15908           DFHEIV99
 15909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15910
 15911
 15912 9800-EXIT.
 15913     EXIT.
 15914
 15915 9900-ERROR-FORMAT.
 15916
 15917* EXEC CICS LINK
 15918*         PROGRAM    (XCTL-EL001)
 15919*         COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 15920*         LENGTH     (EMI-COMM-LENGTH)
 15921*    END-EXEC.
 15922*    MOVE '."C                   (   #00013173' TO DFHEIV0
 15923     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15924     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15925     MOVE X'2020233030303133313733' TO DFHEIV0(25:11)
 15926     CALL 'kxdfhei1' USING DFHEIV0,
 15927           XCTL-EL001,
 15928           ERROR-MESSAGE-INTERFACE-BLOCK,
 15929           EMI-COMM-LENGTH,
 15930           DFHEIV99,
 15931           DFHEIV99,
 15932           DFHEIV99,
 15933           DFHEIV99
 15934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15935
 15936
 15937 9900-EXIT.
 15938     EXIT.
 15939
 15940 9990-ABEND.
 15941     MOVE DFHEIBLK               TO EMI-LINE1.
 15942
 15943* EXEC CICS LINK
 15944*         PROGRAM   (XCTL-EL004)
 15945*         COMMAREA  (EMI-LINE1)
 15946*         LENGTH    (72)
 15947*     END-EXEC.
 15948     MOVE 72
 15949       TO DFHEIV11
 15950*    MOVE '."C                   (   #00013184' TO DFHEIV0
 15951     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15953     MOVE X'2020233030303133313834' TO DFHEIV0(25:11)
 15954     CALL 'kxdfhei1' USING DFHEIV0,
 15955           XCTL-EL004,
 15956           EMI-LINE1,
 15957           DFHEIV11,
 15958           DFHEIV99,
 15959           DFHEIV99,
 15960           DFHEIV99,
 15961           DFHEIV99
 15962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15963
 15964
 15965     MOVE -1                     TO  MAINTL
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 304
* EL131.cbl
 15966
 15967     GO TO 8110-SEND-DATA.
 15968
 15969 9995-SECURITY-VIOLATION.
 15970*           COPY ELCSCTP.
 15971******************************************************************
 15972*                                                                *
 15973*                            ELCSCTP                             *
 15974*                            VMOD=2.001                          *
 15975*                                                                *
 15976*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 15977******************************************************************
 15978
 15979
 15980     MOVE EIBDATE          TO SM-JUL-DATE.
 15981     MOVE EIBTRMID         TO SM-TERMID.
 15982     MOVE THIS-PGM         TO SM-PGM.
 15983     MOVE EIBTIME          TO TIME-IN.
 15984     MOVE TIME-OUT         TO SM-TIME.
 15985     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 15986
 15987
 15988* EXEC CICS LINK
 15989*         PROGRAM  ('EL003')
 15990*         COMMAREA (SECURITY-MESSAGE)
 15991*         LENGTH   (80)
 15992*    END-EXEC.
 15993     MOVE 'EL003' TO DFHEIV1
 15994     MOVE 80
 15995       TO DFHEIV11
 15996*    MOVE '."C                   (   #00013212' TO DFHEIV0
 15997     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15998     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15999     MOVE X'2020233030303133323132' TO DFHEIV0(25:11)
 16000     CALL 'kxdfhei1' USING DFHEIV0,
 16001           DFHEIV1,
 16002           SECURITY-MESSAGE,
 16003           DFHEIV11,
 16004           DFHEIV99,
 16005           DFHEIV99,
 16006           DFHEIV99,
 16007           DFHEIV99
 16008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16009
 16010
 16011******************************************************************
 16012
 16013
 16014
 16015 9999-DFHBACK SECTION.
 16016     MOVE '9%                    "   ' TO DFHEIV0
 16017     MOVE 'EL131' TO DFHEIV1
 16018     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16019     GOBACK.
 16020 9999-DFHEXIT.
 16021     IF DFHEIGDJ EQUAL 0001
 16022         NEXT SENTENCE
 16023     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 305
* EL131.cbl
 16024         GO TO 8820-XCTL-ERROR,
 16025               8150-ENTERED-CLAIM-NOTFOUND,
 16026               9990-ABEND
 16027         DEPENDING ON DFHEIGDI
 16028     ELSE IF DFHEIGDJ EQUAL 3
 16029         GO TO 0130-TS-ERROR,
 16030               0130-TS-ERROR
 16031         DEPENDING ON DFHEIGDI
 16032     ELSE IF DFHEIGDJ EQUAL 4
 16033         GO TO 0600-CONTINUE-NAME-UPDATE
 16034         DEPENDING ON DFHEIGDI
 16035     ELSE IF DFHEIGDJ EQUAL 5
 16036         GO TO 1004-BENE-NOT-FOUND
 16037         DEPENDING ON DFHEIGDI
 16038     ELSE IF DFHEIGDJ EQUAL 6
 16039         GO TO 1120-CNTL-NOTFND
 16040         DEPENDING ON DFHEIGDI
 16041     ELSE IF DFHEIGDJ EQUAL 7
 16042         GO TO 1150-NOTOPEN-ERROR,
 16043               1150-EXIT
 16044         DEPENDING ON DFHEIGDI
 16045     ELSE IF DFHEIGDJ EQUAL 8
 16046         GO TO 1490-STATE-NOTFND
 16047         DEPENDING ON DFHEIGDI
 16048     ELSE IF DFHEIGDJ EQUAL 9
 16049         GO TO 1500-CARR-NOTFND
 16050         DEPENDING ON DFHEIGDI
 16051     ELSE IF DFHEIGDJ EQUAL 10
 16052         GO TO 1620-ACCT-NOTFND
 16053         DEPENDING ON DFHEIGDI
 16054     ELSE IF DFHEIGDJ EQUAL 11
 16055         GO TO 2020-EXIT
 16056         DEPENDING ON DFHEIGDI
 16057     ELSE IF DFHEIGDJ EQUAL 12
 16058         GO TO 2030-EXIT
 16059         DEPENDING ON DFHEIGDI
 16060     ELSE IF DFHEIGDJ EQUAL 13
 16061         GO TO 2040-EXIT
 16062         DEPENDING ON DFHEIGDI
 16063     ELSE IF DFHEIGDJ EQUAL 14
 16064         GO TO 2050-EXIT
 16065         DEPENDING ON DFHEIGDI
 16066     ELSE IF DFHEIGDJ EQUAL 15
 16067         GO TO 2060-CERT-NOTFND
 16068         DEPENDING ON DFHEIGDI
 16069     ELSE IF DFHEIGDJ EQUAL 16
 16070         GO TO 2060-DUPKEY
 16071         DEPENDING ON DFHEIGDI
 16072     ELSE IF DFHEIGDJ EQUAL 17
 16073         GO TO 2070-NOT-FOUND
 16074         DEPENDING ON DFHEIGDI
 16075     ELSE IF DFHEIGDJ EQUAL 18
 16076         GO TO 2070-EXIT
 16077         DEPENDING ON DFHEIGDI
 16078     ELSE IF DFHEIGDJ EQUAL 19
 16079         GO TO 2080-EXIT
 16080         DEPENDING ON DFHEIGDI
 16081     ELSE IF DFHEIGDJ EQUAL 20
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 306
* EL131.cbl
 16082         GO TO 2400-TRLR-NOTFND,
 16083               2410-EXIT
 16084         DEPENDING ON DFHEIGDI
 16085     ELSE IF DFHEIGDJ EQUAL 21
 16086         GO TO 2425-NINETY-NOTFND,
 16087               2425-NINETY-NOTFND
 16088         DEPENDING ON DFHEIGDI
 16089     ELSE IF DFHEIGDJ EQUAL 22
 16090         GO TO 2430-EXIT,
 16091               2440-EXIT
 16092         DEPENDING ON DFHEIGDI
 16093     ELSE IF DFHEIGDJ EQUAL 23
 16094         GO TO 2440-EXIT
 16095         DEPENDING ON DFHEIGDI
 16096     ELSE IF DFHEIGDJ EQUAL 24
 16097         GO TO 2460-EXIT
 16098         DEPENDING ON DFHEIGDI
 16099     ELSE IF DFHEIGDJ EQUAL 25
 16100         GO TO 2475-EXIT
 16101         DEPENDING ON DFHEIGDI
 16102     ELSE IF DFHEIGDJ EQUAL 26
 16103         GO TO 2650-EXIT
 16104         DEPENDING ON DFHEIGDI
 16105     ELSE IF DFHEIGDJ EQUAL 27
 16106         GO TO 2800-EXIT,
 16107               2800-EXIT
 16108         DEPENDING ON DFHEIGDI
 16109     ELSE IF DFHEIGDJ EQUAL 28
 16110         GO TO 3010-DEL-ACTQ,
 16111               3040-EXIT
 16112         DEPENDING ON DFHEIGDI
 16113     ELSE IF DFHEIGDJ EQUAL 29
 16114         GO TO 3010-NO-ACTIVITY,
 16115               3050-EXIT
 16116         DEPENDING ON DFHEIGDI
 16117     ELSE IF DFHEIGDJ EQUAL 30
 16118         GO TO 3010-CERT-NOT-FOUND
 16119         DEPENDING ON DFHEIGDI
 16120     ELSE IF DFHEIGDJ EQUAL 31
 16121         GO TO 3020-EXIT
 16122         DEPENDING ON DFHEIGDI
 16123     ELSE IF DFHEIGDJ EQUAL 32
 16124         GO TO 3060-EXIT,
 16125               3060-EXIT
 16126         DEPENDING ON DFHEIGDI
 16127     ELSE IF DFHEIGDJ EQUAL 33
 16128         GO TO 5000-TRLR-NOT-FOUND
 16129         DEPENDING ON DFHEIGDI
 16130     ELSE IF DFHEIGDJ EQUAL 34
 16131         GO TO 5000-CERT-NOT-FOUND
 16132         DEPENDING ON DFHEIGDI
 16133     ELSE IF DFHEIGDJ EQUAL 35
 16134         GO TO 7630-END-BROWSE
 16135         DEPENDING ON DFHEIGDI
 16136     ELSE IF DFHEIGDJ EQUAL 36
 16137         GO TO 7799-EXIT,
 16138               7799-EXIT
 16139         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 16-Jul-13 11:36 Page 307
* EL131.cbl
 16140     ELSE IF DFHEIGDJ EQUAL 37
 16141         GO TO 7799-EXIT
 16142         DEPENDING ON DFHEIGDI
 16143     ELSE IF DFHEIGDJ EQUAL 38
 16144         GO TO 7800-NOT-FOUND
 16145         DEPENDING ON DFHEIGDI
 16146     ELSE IF DFHEIGDJ EQUAL 39
 16147         GO TO 8000-NOTE-NOT-FOUND
 16148         DEPENDING ON DFHEIGDI
 16149     ELSE IF DFHEIGDJ EQUAL 40
 16150         GO TO 8990-SEND-TEXT
 16151         DEPENDING ON DFHEIGDI.
 16152     MOVE '9%                    "   ' TO DFHEIV0
 16153     MOVE 'EL131' TO DFHEIV1
 16154     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16155     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       13132     Code:       54388
