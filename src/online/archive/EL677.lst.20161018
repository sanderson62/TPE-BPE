* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.
     3
     4 PROGRAM-ID.                 EL677.
     5*
     6*AUTHOR.     CSO
     7*            OMAHA, NEBRASKA.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   2
* EL677.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*                                                                *
    17*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    32* 021714  CR2014021700001  PEMA  ADD TEST DB FOR OTHER THAN cid1p
    33* 030414  IR2014030400001  PEMA  CHG PYAJ VOID TRANS TO R AND +
    34* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    35* 091615  CR2015082000001  PEMA  ADD TOTAL ENDT PROCESSING
    36******************************************************************
    37 ENVIRONMENT DIVISION.
    38
    39 DATA DIVISION.
    40 WORKING-STORAGE SECTION.
    41 01  DFH-START PIC X(04).
    42 77  FILLER  PIC X(32)  VALUE '********************************'.
    43 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    44 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    45 77  s1                          pic s999 comp-3 value +0.
    46 77  s2                          pic s999 comp-3 value +0.
    47 77  ws-tot-lf-prem              pic s9(7)v99 comp-3 value +0.
    48 77  ws-tot-iss-prem             pic s9(7)v99 comp-3 value +0.
    49 77  ws-tot-iss-comm             pic s9(7)v99 comp-3 value +0.
    50 77  ws-tot-ref-comm             pic s9(7)v99 comp-3 value +0.
    51 77  ws-browse-sw                pic x value spaces.
    52     88  i-say-when                 value 'Y'.
    53 77  ws-delete-sw                pic x value ' '.
    54     88  row-deleted                 value 'Y'.
    55 77  ws-sql-code                 pic s9(7) value zeros.
    56 77  ws-dis-sql-code             pic -9999999 value zeros.
    57 77  ws-match-sw                 pic x  value ' '.
    58     88  found-a-match             value 'Y'.
    59 77  ws-commit-sw                pic x value ' '.
    60     88  tbl-commited                value 'Y'.
    61 01  P pointer.
    62 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    63 01  var-ptr pointer.
    64 01  env-var-len                 pic 9(4)  binary.
    65 01  rc                          pic 9(9)  binary.
    66
    67 01  WS-KIXSYS.
    68     05  WS-KIX-FIL1             PIC X(10).
    69     05  WS-KIX-APPS             PIC X(10).
    70     05  WS-KIX-ENV              PIC X(10).
    71     05  WS-KIX-MYENV            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   3
* EL677.cbl
    72     05  WS-KIX-SYS              PIC X(10).
*   73 EXEC SQL
*   74    INCLUDE SQLDA
*   75 END-EXEC
    76 01 SQLDA sync.
    77    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    78    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    79    05 SQLN                  PIC S9(4) COMP-5 value 0.
    80    05 SQLD                  PIC S9(4) COMP-5 value 0.
    81    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    82       10 SQLTYPE            PIC S9(4) COMP-5.
    83       10 SQLLEN             PIC S9(4) COMP-5.
    84$IF P64 SET
    85X      *> For 64-bit environments, ensure that SQLDATA is
    86X      *> aligned on an 8-byte boundary.
    87X      10 FILLER             PIC S9(9) COMP-5.
    88$END
    89       10 SQLDATA            USAGE POINTER.
    90       10 SQLIND             USAGE POINTER.
    91       10 SQLNAME.
    92          15 SQLNAMEL        PIC S9(4) COMP-5.
    93          15 SQLNAMEC        PIC X(30).
    94
    95* Values for SQLTYPE
    96
    97 78  ESQL-DATE-CHAR              VALUE 384.
    98 78  ESQL-DATE-CHAR-NULL         VALUE 385.
    99 78  ESQL-DATE-REC               VALUE 386.
   100 78  ESQL-DATE-REC-NULL          VALUE 387.
   101 78  ESQL-TIME-CHAR              VALUE 388.
   102 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   103 78  ESQL-TIME-REC               VALUE 390.
   104 78  ESQL-TIME-REC-NULL          VALUE 391.
   105 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   106 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   107 78  ESQL-TIMESTAMP-REC          VALUE 394.
   108 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   109 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   110 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   111 78  ESQL-TS-OFFSET-REC          VALUE 398.
   112 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   113 78  ESQL-LONGVARBINARY          VALUE 404.
   114 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   115 78  ESQL-LONGVARCHAR            VALUE 408.
   116 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   117 78  ESQL-BINARY                 VALUE 444.
   118 78  ESQL-BINARY-NULL            VALUE 445.
   119 78  ESQL-VARBINARY              VALUE 446.
   120 78  ESQL-VARBINARY-NULL         VALUE 447.
   121 78  ESQL-VARCHAR                VALUE 448.
   122 78  ESQL-VARCHAR-NULL           VALUE 449.
   123
   124 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   125 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   126
   127 78  ESQL-CHAR                   VALUE 452.
   128 78  ESQL-CHAR-NULL              VALUE 453.
   129
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   4
* EL677.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   131 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   132
   133 78  ESQL-DOUBLE                 VALUE 480.
   134 78  ESQL-DOUBLE-NULL            VALUE 481.
   135 78  ESQL-REAL                   VALUE 482.
   136 78  ESQL-REAL-NULL              VALUE 483.
   137 78  ESQL-DECIMAL                VALUE 484.
   138 78  ESQL-DECIMAL-NULL           VALUE 485.
   139 78  ESQL-INTEGER                VALUE 496.
   140 78  ESQL-INTEGER-NULL           VALUE 497.
   141 78  ESQL-SMALLINT               VALUE 500.
   142 78  ESQL-SMALLINT-NULL          VALUE 501.
   143 78  ESQL-TINYINT                VALUE 502.
   144 78  ESQL-TINYINT-NULL           VALUE 503.
*  145 EXEC SQL
*  146    INCLUDE SQLCA
*  147 END-EXEC
   148 01 SQLCA.
   149     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   150     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   151     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   152     05  SQLERRM.
   153         49  SQLERRML    PIC S9(4) COMP-5.
   154         49  SQLERRMC    PIC X(70).
   155     05  SQLERRP         PIC X(8).
   156     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   157     05  SQLWARN.
   158         10  SQLWARN0    PIC X.
   159         10  SQLWARN1    PIC X.
   160         10  SQLWARN2    PIC X.
   161         10  SQLWARN3    PIC X.
   162         10  SQLWARN4    PIC X.
   163         10  SQLWARN5    PIC X.
   164         10  SQLWARN6    PIC X.
   165         10  SQLWARN7    PIC X.
   166     05  SQLEXT.
   167         10  SQLWARN8    PIC X.
   168         10  SQLWARN9    PIC X.
   169         10  SQLWARN10   PIC X.
   170         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   171     05  SQLSTATE    PIC X(5).
   172 EXEC SQL
   173    BEGIN DECLARE SECTION
   174 END-EXEC
   175 01  ws-paid-bank-work-area.
   176     05  ws-pb-compid            pic x(9).
   177     05  ws-pb-check-no          pic x(10).
   178     05  ws-pb-bad-check-no      pic x(10).
   179     05  ws-check-amount         pic x(10).
   180 01  Paid-Bank-Info.
   181     05  pb-check-no             pic 9(10).
   182     05  pb-tran-type            pic x.
   183     05  pb-bank-acct-desc       pic x(50).
   184     05  pb-amount               pic x(12).
   185     05  pb-paid-date            pic x(25).
   186 01  ws-key-stuff.
   187     05  ws-compid               pic xxx.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   5
* EL677.cbl
   188     05  ws-carrier              pic x.
   189     05  ws-grouping             pic x(6).
   190     05  ws-state                pic xx.
   191     05  ws-account              pic x(10).
   192     05  ws-eff-date             pic x(10).
   193     05  ws-certificate          pic x(10).
   194     05  ws-cert-sfx             pic x.
   195     05  ws-seq-no               pic 999.
   196     05  ws-type                 pic x.
   197     05  ws-check-sub-type       pic x.
   198 01  sqlcmd                      pic x(1024).
   199 01  WS-MOE-DATE                 pic x(10).
   200 01  svr                         pic x(32).
   201 01  usr                         pic x(32).
   202 01  pass                        pic x(32).
   203 01  usr-pass                    pic x(64).
   204 01  ws-disp-code                pic s9(11).
   205***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   206***                                                            ***
   207***  These indicators are used to determine if a variable      ***
   208***  is passed nulls from sql. The indicator will be -1        ***
   209***  if the value on sql is nulls and +0 if the value is       ***
   210***  something other than nulls. Here is an example on how     ***
   211***  to use the indicator variables.                           ***
   212***                                                            ***
   213***     EXEC SQL                                               ***
   214***        fetch checkapp into                                 ***
   215***           :db-app-status :nu-app-status,                   ***
   216***           :db-app-by     :nu-app-by,                       ***
   217***           :db-app-date   :nu-app-date,                     ***
   218***           :db-app-batch  :nu-app-batch                     ***
   219***     END-EXEC                                               ***
   220***                                                            ***
   221***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   222 01  indicator-vaiables-for-nulls.
   223     05  nu-app-status           pic s9(4) comp value +0.
   224     05  nu-app-by               pic s9(4) comp value +0.
   225     05  nu-app-date             pic s9(4) comp value +0.
   226     05  nu-app-batch            pic s9(4) comp value +0.
   227     05  nu-fincar               pic s9(4) comp value +0.
   228 01  daily-check-request-rec.
   229     05  db-compid               pic xxx.
   230     05  db-carrier              pic x.
   231     05  db-grouping             pic x(6).
   232     05  db-state                pic xx.
   233     05  db-account              pic x(10).
   234     05  db-effdate              pic x(10).
   235     05  db-certificate          pic x(10).
   236     05  db-cert-sfx             pic x.
   237     05  db-seq-no               pic 999.
   238     05  db-type                 pic x.
   239     05  db-amount-n             pic 9(7).99.
   240     05  db-amount redefines db-amount-n
   241                                 pic x(10).
   242     05  db-checkno              pic x(15).
   243     05  db-checkdate            pic x(10).
   244     05  db-checkstatus          pic 9(5).
   245     05  db-releasebatch         pic 9(5).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   6
* EL677.cbl
   246     05  db-releasedt            pic x(10).
   247     05  db-releaseby            pic x(4).
   248     05  db-payeename1           pic x(30).
   249     05  db-payeename2           pic x(30).
   250     05  db-payeeaddr1           pic x(30).
   251     05  db-payeeaddr2           pic x(30).
   252     05  db-payeecity            pic x(30).
   253     05  db-payeest              pic xx.
   254     05  db-payeezip             pic x(10).
   255     05  db-fincar               pic x.
   256     05  db-fingrp               pic x(6).
   257     05  db-finresp              pic x(10).
   258     05  db-finacct              pic x(10).
   259     05  db-preparer             pic x(4).
   260     05  db-app-status           pic x(9).
   261     05  dp-app-status-n redefines db-app-status
   262                                 pic 9(9).
   263     05  db-app-by               pic x(20).
   264     05  db-app-date             pic x(30).
   265     05  db-app-batch            pic x(10).
   266     05  db-return-to            pic x(30).
   267     05  db-insured-name         pic x(30).
   268     05  db-check-sub-type       pic x.
   269 EXEC SQL
   270    END DECLARE SECTION
   271 END-EXEC
   272*                            COPY ELCSCTM.
   273******************************************************************
   274*                                                                *
   275*                                                                *
   276*                            ELCSCTM                             *
   277*                            VMOD=2.001                          *
   278*                                                                *
   279*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   280*                                                                *
   281******************************************************************
   282 01  SECURITY-MESSAGE.
   283     12  FILLER                          PIC X(30)
   284            VALUE '** LOGIC SECURITY VIOLATION -'.
   285     12  SM-READ                         PIC X(6).
   286     12  FILLER                          PIC X(5)
   287            VALUE ' PGM='.
   288     12  SM-PGM                          PIC X(6).
   289     12  FILLER                          PIC X(5)
   290            VALUE ' OPR='.
   291     12  SM-PROCESSOR-ID                 PIC X(4).
   292     12  FILLER                          PIC X(6)
   293            VALUE ' TERM='.
   294     12  SM-TERMID                       PIC X(4).
   295     12  FILLER                          PIC XX   VALUE SPACE.
   296     12  SM-JUL-DATE                     PIC 9(5).
   297     12  FILLER                          PIC X    VALUE SPACE.
   298     12  SM-TIME                         PIC 99.99.
   299
   300*                            COPY ELCSCRTY.
   301******************************************************************
   302*                                                                *
   303*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   7
* EL677.cbl
   304*                            ELCSCRTY                            *
   305*                            VMOD=2.001                          *
   306*                                                                *
   307*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   308*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   309*        SAVED IN PI-SECURITY-ADDRESS.                           *
   310*                                                                *
   311******************************************************************
   312 01  SECURITY-CONTROL.
   313     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   314     12  FILLER                       PIC XX    VALUE 'SC'.
   315     12  SC-CREDIT-CODES.
   316         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   317             20  SC-CREDIT-DISPLAY    PIC X.
   318             20  SC-CREDIT-UPDATE     PIC X.
   319     12  SC-CLAIMS-CODES.
   320         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   321             20  SC-CLAIMS-DISPLAY    PIC X.
   322             20  SC-CLAIMS-UPDATE     PIC X.
   323 01  ws-dummy-erchek             pic x(600).
   324 01  filler.
   325     05  WS-CHECK-AMT-TMP        PIC Z(7).99.
   326     05  WS-CHECK-AMT-TMPX REDEFINES
   327         WS-CHECK-AMT-TMP        PIC X(10).
   328     05  ws-ind                     pic s9(4) comp value +0.
   329     05  ws-ind-red redefines ws-ind pic xx.
   330     05  ws-display-ind             pic s9(7) value zeros.
   331 01  ws-compare-erchek-key          pic x(33) value low-values.
   332 01  ws-eracct-sw                   pic x value ' '.
   333     88  eracct-found                 value 'Y'.
   334 01  ws-eracct-start-sw             pic x value ' '.
   335     88  eracct-start                 value 'Y'.
   336 01  WS-MISC-AREA.
   337     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   338     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
   339     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   340
   341 01  ws-work-amt-alpha           pic x(10).
   342 01  ws-work-amt-num redefines ws-work-amt-alpha
   343                                 pic 9(8)v99.
   344 01  ws-user-defined.
   345     05  ws-user-reason         pic xxx.
   346     05  ws-user-cert-no        pic x(11).
   347     05  ws-user-name           pic x(28).
   348 01  ws-hold-eracct-record       pic x(2000)  value spaces.
   349 01  STANDARD-AREAS.
   350     12  ws-connect-sw               pic x  value ' '.
   351         88  connected-to-db             value 'Y'.
   352     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   353     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   354     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
   355     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   356     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   357     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
   358     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
   359     12  EL6318-TRANS-ID             PIC X(4)    VALUE 'EXBE'.
   360     12  EL1273-TRANS-ID             PIC X(4)    VALUE 'EXX3'.
   361     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   8
* EL677.cbl
   362     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   363     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   364     12  TIME-OUT-R  REDEFINES TIME-IN.
   365         16  FILLER                  PIC X.
   366         16  TIME-OUT                PIC 99V99.
   367         16  FILLER                  PIC XX.
   368     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   369     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   370     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   371     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   372     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   373     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   374     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   375     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   376     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   377     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   378     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   379     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   380     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   381     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   382     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   383     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   384     12  ERPNDM-FILE-ID              PIC X(8)    VALUE 'ERPNDM'.
   385     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   386     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   387     12  WS-KEY-LENGTH               PIC S9(4)   VALUE +28   COMP.
   388     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   389     12  QID.
   390         16  QID-TERM                PIC X(4)    VALUE SPACES.
   391         16  FILLER                  PIC X(4)    VALUE '677A'.
   392
   393 01  WORK-AREAS.
   394     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   395     12  WS-AM-WK REDEFINES WS-AM-WORK.
   396         16  WS-AM-NUM               PIC S9(7)V99.
   397         16  WS-AM-SIGN              PIC X.
   398     12  WS-CHECK-WORK.
   399         16  FILLER                  PIC X        VALUE SPACE.
   400         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
   401     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   402     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   403     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   404     12  WS-AMT-PAID                 PIC S9(7)V99 VALUE +0.
   405     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   406     12  WS-SV-CARRIER               PIC X       VALUE SPACES.
   407     12  WS-SV-GROUPING              PIC X(6)    VALUE SPACES.
   408     12  WS-SV-STATE                 PIC XX      VALUE SPACES.
   409     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   410     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   411     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   412         WS-DT-DEEDIT-FIELD.
   413         16  FILLER                  PIC X(4).
   414         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   415     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
   416     12  WS-DEEDIT-FIELD-V0          REDEFINES
   417         WS-DEEDIT-FIELD-A           PIC S9(15).
   418
   419     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page   9
* EL677.cbl
   420     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   421         88 WS-CERT-FOUND                        VALUE 'Y'.
   422         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   423     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
   424         88 WS-PNDB-FOUND                        VALUE 'Y'.
   425         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
   426     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   427         88  WS-PROCESS-CERT                     VALUE 'Y'.
   428     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   429         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
   430     12  WS-PY-ENTRY-COMMENT.
   431         16  WS-PY-CURRENT-DATE      PIC X(6)    VALUE SPACES.
   432         16  FILLER                  PIC X(13)   VALUE
   433            ' MISC. CHECK '.
   434         16  WS-PY-CURRENT-CERT      PIC X(10)   VALUE SPACES.
   435         16  WS-PY-CURRENT-SUFFIX    PIC X       VALUE SPACE.
   436     12  WS-PY-REF-COMMENT.
   437         16  WS-PY-REF-DATE          PIC X(6)    VALUE SPACES.
   438         16  FILLER                  PIC X(13)   VALUE
   439            ' REFUND PYMT '.
   440         16  WS-PY-REF-CERT          PIC X(10)   VALUE SPACES.
   441         16  WS-PY-REF-SUFFIX        PIC X       VALUE SPACE.
   442     12  WS-PY-END-COMMENT.
   443         16  WS-PY-END-DATE          PIC X(6)    VALUE SPACES.
   444         16  FILLER                  PIC X(13)   VALUE
   445            ' ENDORSEMENT '.
   446         16  WS-PY-END-CERT          PIC X(10)   VALUE SPACES.
   447         16  WS-PY-END-SUFFIX        PIC X       VALUE SPACE.
   448     12  WS-PY-DED-COMMENT.
   449         16  WS-PY-DED-DATE          PIC X(6)    VALUE SPACES.
   450         16  FILLER                  PIC X(13)   VALUE
   451            ' STAT DEDUCT '.
   452         16  WS-PY-DED-CERT          PIC X(10)   VALUE SPACES.
   453         16  WS-PY-DED-SUFFIX        PIC X       VALUE SPACE.
   454     12  WS-PY-ADDL-COMMENT.
   455         16  WS-PY-ADDL-DATE         PIC X(6)    VALUE SPACES.
   456         16  FILLER                  PIC X(13)   VALUE
   457            ' ADDL CHARGE '.
   458         16  WS-PY-ADDL-CERT         PIC X(10)   VALUE SPACES.
   459         16  WS-PY-ADDL-SUFFIX       PIC X       VALUE SPACE.
   460     12  WS-PY-REVERSAL-COMMENT.
   461         16  WS-PY-REVERSAL-DATE     PIC X(6)    VALUE SPACES.
   462         16  WS-PY-REVERSAL-TYPE     PIC X(13)   VALUE
   463            ' VOID REFUND '.
   464         16  WS-PY-REVERSAL-CERT     PIC X(10)   VALUE SPACES.
   465         16  WS-PY-REVERSAL-SUFFIX   PIC X       VALUE SPACE.
   466     12  WS-TMS-ENTRY-COMMENT.
   467         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   468         16  FILLER                  PIC XX      VALUE SPACES.
   469         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
   470     12  WS-ZIP-CODE.
   471         16  WS-ZIP-PRIME.
   472             20  WS-ZIP-PRI-1ST      PIC X.
   473                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   474             20  FILLER              PIC X(4).
   475         16  WS-ZIP-PLUS4            PIC X(4).
   476     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   477         16  WS-CAN-POST1-1          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  10
* EL677.cbl
   478         16  WS-CAN-POST1-2.
   479             20  WS-CAN-POST-4TH     PIC X.
   480             20  FILLER              PIC XX.
   481         16  FILLER                  PIC XXX.
   482     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
   483         16  WS-CAN-POST2-1          PIC XXX.
   484         16  FILLER                  PIC X.
   485         16  WS-CAN-POST2-2          PIC XXX.
   486         16  FILLER                  PIC XX.
   487
   488*                                    COPY ELCNWA.
   489*****************************************************************
   490*                                                               *
   491*                                                               *
   492*                            ELCNWA.                            *
   493*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   494*                            VMOD=2.003                         *
   495*                                                               *
   496*            M O V E   N A M E   W O R K   A R E A.             *
   497*                                                               *
   498*****************************************************************.
   499
   500 01  WS-NAME-WORK-AREA.
   501     05  WS-INSURED-LAST-NAME        PIC X(15).
   502     05  WS-INSURED-1ST-NAME         PIC X(12).
   503     05  WS-INSURED-MID-INIT         PIC X.
   504
   505     05  WS-NAME-WORK.
   506         10  WS-NW                   PIC X
   507             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   508
   509     05  WS-NAME-WORK2.
   510         10  WS-NW2                  PIC X
   511             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   512                                        NWA-INDEX0.
   513
   514     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   515                                     COMP-3.
   516
   517 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   518     88  RESP-NORMAL                    VALUE +0.
   519     88  resp-file-notfnd               value +12.
   520     88  RESP-NOTFND                    VALUE +13.
   521     88  resp-duprec                    value +14.
   522     88  resp-dupkey                    value +15.
   523     88  resp-invreq                    value +16.
   524     88  RESP-NOTOPEN                   VALUE +19.
   525     88  RESP-ENDFILE                   VALUE +20.
   526     88  resp-lengtherr                 value +22.
   527 01  ACCESS-KEYS.
   528     12  ELCNTL-KEY.
   529         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   530         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   531         16 ELCNTL-ACCESS.
   532             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   533             20  FILLER              PIC X       VALUE SPACES.
   534             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   535         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  11
* EL677.cbl
   536
   537     12  ELCNTL-RECORD-LENGTH        PIC S9(4)   VALUE +750  COMP.
   538
   539     12  ERACCT-KEY.
   540         16  ERACCT-CO               PIC X       VALUE SPACES.
   541         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
   542         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   543         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   544         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   545         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   546         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   547
   548     12  SAVE-ERACCT-KEY.
   549         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   550         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   551         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   552         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   553         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   554         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   555         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   556
   557     12  ERACCT-RECORD-LENGTH        PIC S9(4)   VALUE +2000 COMP.
   558
   559     12  ERCOMP-KEY.
   560         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   561         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   562         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   563         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   564         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   565         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   566
   567     12  ERCOMP-LENGTH               PIC S9(4)   VALUE +700  COMP.
   568
   569     12  ELCERT-KEY.
   570         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   571         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   572         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   573         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   574         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   575         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   576         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   577         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   578
   579     12  ELCERT-RECORD-LENGTH        PIC S9(4)   VALUE +450  COMP.
   580
   581     12  ERPNDB-PRIMARY-KEY.
   582         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   583         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   584         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   585         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   586
   587     12  ERPNDB-ALT-KEY.
   588         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   589         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
   590         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
   591         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
   592         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   593         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  12
* EL677.cbl
   594         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   595         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   596         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   597         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
   598
   599     12  ERPNDB-RECORD-LENGTH        PIC S9(4)   VALUE +585  COMP.
   600
   601     12  ERPNDM-PRIMARY-KEY.
   602         16 ERPNDM-COMPANY-CD        PIC X       VALUE SPACES.
   603         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   604         16 ERPNDM-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   605         16 ERPNDM-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   606
   607     12  ERPNDM-RECORD-LENGTH        PIC S9(4)   VALUE +250  COMP.
   608
   609     12  ERCHEK-KEY.
   610         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   611         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   612         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   613         16  CHEK-STATE              PIC XX      VALUE SPACES.
   614         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   615         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   616         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   617         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   618         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   619
   620     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   621     12  ERPYAJ-KEY.
   622         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   623         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
   624         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   625         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   626         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   627         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   628         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   629
   630     12  ERPYAJ-RECORD-LENGTH        PIC S9(4)   VALUE +200  COMP.
   631
   632 01  ERROR-NUMBERS.
   633     12  ER-0000                     PIC X(4)    VALUE '0000'.
   634     12  ER-0004                     PIC X(4)    VALUE '0004'.
   635     12  ER-0008                     PIC X(4)    VALUE '0008'.
   636     12  ER-0013                     PIC X(4)    VALUE '0013'.
   637     12  ER-0022                     PIC X(4)    VALUE '0022'.
   638     12  ER-0023                     PIC X(4)    VALUE '0023'.
   639     12  ER-0026                     PIC X(4)    VALUE '0026'.
   640     12  ER-0029                     PIC X(4)    VALUE '0029'.
   641     12  ER-0070                     PIC X(4)    VALUE '0070'.
   642     12  ER-0194                     PIC X(4)    VALUE '0194'.
   643     12  ER-0195                     PIC X(4)    VALUE '0195'.
   644     12  ER-0196                     PIC X(4)    VALUE '0196'.
   645     12  ER-0197                     PIC X(4)    VALUE '0197'.
   646     12  ER-0203                     PIC X(4)    VALUE '0203'.
   647     12  ER-0215                     PIC X(4)    VALUE '0215'.
   648     12  ER-0216                     PIC X(4)    VALUE '0216'.
   649     12  ER-0433                     PIC X(4)    VALUE '0433'.
   650     12  ER-0565                     PIC X(4)    VALUE '0565'.
   651     12  ER-1159                     PIC X(4)    VALUE '1159'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  13
* EL677.cbl
   652     12  ER-1162                     PIC X(4)    VALUE '1162'.
   653     12  ER-2056                     PIC X(4)    VALUE '2056'.
   654     12  ER-2208                     PIC X(4)    VALUE '2208'.
   655     12  ER-2209                     PIC X(4)    VALUE '2209'.
   656     12  ER-2210                     PIC X(4)    VALUE '2210'.
   657     12  ER-2230                     PIC X(4)    VALUE '2230'.
   658     12  ER-2237                     PIC X(4)    VALUE '2237'.
   659     12  ER-2238                     PIC X(4)    VALUE '2238'.
   660     12  ER-2294                     PIC X(4)    VALUE '2294'.
   661     12  ER-2394                     PIC X(4)    VALUE '2394'.
   662     12  ER-2438                     PIC X(4)    VALUE '2438'.
   663     12  ER-2439                     PIC X(4)    VALUE '2439'.
   664     12  ER-2583                     PIC X(4)    VALUE '2583'.
   665     12  ER-2600                     PIC X(4)    VALUE '2600'.
   666     12  ER-2726                     PIC X(4)    VALUE '2726'.
   667     12  ER-2905                     PIC X(4)    VALUE '2905'.
   668     12  ER-2906                     PIC X(4)    VALUE '2906'.
   669     12  ER-2907                     PIC X(4)    VALUE '2907'.
   670     12  ER-2908                     PIC X(4)    VALUE '2908'.
   671     12  ER-2909                     PIC X(4)    VALUE '2909'.
   672     12  ER-3044                     PIC X(4)    VALUE '3044'.
   673     12  ER-3046                     PIC X(4)    VALUE '3046'.
   674     12  ER-3047                     PIC X(4)    VALUE '3047'.
   675     12  ER-3445                     PIC X(4)    VALUE '3445'.
   676     12  er-3450                     pic x(4)    value '3450'.
   677     12  er-3451                     pic x(4)    value '3451'.
   678     12  er-3452                     pic x(4)    value '3452'.
   679     12  er-3453                     pic x(4)    value '3453'.
   680     12  er-3454                     pic x(4)    value '3454'.
   681     12  er-3455                     pic x(4)    value '3455'.
   682     12  er-3459                     pic x(4)    value '3459'.
   683     12  ER-7389                     PIC X(4)    VALUE '7389'.
   684*                                    COPY ELCLOGOF.
   685******************************************************************
   686*                                                                *
   687*                                                                *
   688*                            ELCLOGOF.                           *
   689*                            VMOD=2.001                          *
   690*                                                                *
   691*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   692*                                                                *
   693******************************************************************
   694 01  CLASIC-LOGOFF.
   695     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   696     12  LOGOFF-TEXT.
   697         16  FILLER          PIC X(5)    VALUE SPACES.
   698         16  LOGOFF-MSG.
   699             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   700             20  FILLER      PIC X       VALUE SPACES.
   701             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   702         16  FILLER          PIC X(80)
   703           VALUE '* YOU ARE NOW LOGGED OFF'.
   704         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   705         16  FILLER          PIC X       VALUE QUOTE.
   706         16  LOGOFF-SYS-MSG  PIC X(17)
   707           VALUE 'S CLAS-IC SYSTEM '.
   708     12  TEXT-MESSAGES.
   709         16  UNACCESS-MSG    PIC X(29)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  14
* EL677.cbl
   710             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   711         16  PGMIDERR-MSG    PIC X(17)
   712             VALUE 'PROGRAM NOT FOUND'.
   713*                                    COPY ELCDATE.
   714******************************************************************
   715*                                                                *
   716*                                                                *
   717*                            ELCDATE.                            *
   718*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   719*                            VMOD=2.003
   720*                                                                *
   721*                                                                *
   722*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   723*                 LENGTH = 200                                   *
   724******************************************************************
   725
   726 01  DATE-CONVERSION-DATA.
   727     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   728     12  DC-OPTION-CODE                PIC X.
   729         88  BIN-TO-GREG                VALUE ' '.
   730         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   731         88  EDIT-GREG-TO-BIN           VALUE '2'.
   732         88  YMD-GREG-TO-BIN            VALUE '3'.
   733         88  MDY-GREG-TO-BIN            VALUE '4'.
   734         88  JULIAN-TO-BIN              VALUE '5'.
   735         88  BIN-PLUS-ELAPSED           VALUE '6'.
   736         88  FIND-CENTURY               VALUE '7'.
   737         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   738         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   739         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   740         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   741         88  JULIAN-TO-BIN-3            VALUE 'C'.
   742         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   743         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   744         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   745         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   746         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   747         88  CHECK-LEAP-YEAR            VALUE 'H'.
   748         88  BIN-3-TO-GREG              VALUE 'I'.
   749         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   750         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   751         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   752         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   753         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   754         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   755         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   756         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   757         88  THREE-CHARACTER-BIN
   758                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   759         88  GREGORIAN-TO-BIN
   760                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   761         88  BIN-TO-GREGORIAN
   762                  VALUES ' ' '1' 'I' '8' 'G'.
   763         88  JULIAN-TO-BINARY
   764                  VALUES '5' 'C' 'E' 'F'.
   765     12  DC-ERROR-CODE                 PIC X.
   766         88  NO-CONVERSION-ERROR        VALUE ' '.
   767         88  DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  15
* EL677.cbl
   768                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   769         88  DATE-IS-ZERO               VALUE '1'.
   770         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   771         88  DATE-IS-INVALID            VALUE '3'.
   772         88  DATE1-GREATER-DATE2        VALUE '4'.
   773         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   774         88  DATE-INVALID-OPTION        VALUE '9'.
   775         88  INVALID-CENTURY            VALUE 'A'.
   776         88  ONLY-CENTURY               VALUE 'B'.
   777         88  ONLY-LEAP-YEAR             VALUE 'C'.
   778         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   779     12  DC-END-OF-MONTH               PIC X.
   780         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   781     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   782         88  USE-NORMAL-PROCESS         VALUE ' '.
   783         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   784         88  ADJUST-UP-100-YRS          VALUE '2'.
   785     12  FILLER                        PIC X.
   786     12  DC-CONVERSION-DATES.
   787         16  DC-BIN-DATE-1             PIC XX.
   788         16  DC-BIN-DATE-2             PIC XX.
   789         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   790         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   791                       DC-GREG-DATE-1-EDIT.
   792             20  DC-EDIT1-MONTH        PIC 99.
   793             20  SLASH1-1              PIC X.
   794             20  DC-EDIT1-DAY          PIC 99.
   795             20  SLASH1-2              PIC X.
   796             20  DC-EDIT1-YEAR         PIC 99.
   797         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   798         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   799                     DC-GREG-DATE-2-EDIT.
   800             20  DC-EDIT2-MONTH        PIC 99.
   801             20  SLASH2-1              PIC X.
   802             20  DC-EDIT2-DAY          PIC 99.
   803             20  SLASH2-2              PIC X.
   804             20  DC-EDIT2-YEAR         PIC 99.
   805         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   806         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   807                     DC-GREG-DATE-1-YMD.
   808             20  DC-YMD-YEAR           PIC 99.
   809             20  DC-YMD-MONTH          PIC 99.
   810             20  DC-YMD-DAY            PIC 99.
   811         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   812         16  DC-GREG-DATE-1-MDY-R REDEFINES
   813                      DC-GREG-DATE-1-MDY.
   814             20  DC-MDY-MONTH          PIC 99.
   815             20  DC-MDY-DAY            PIC 99.
   816             20  DC-MDY-YEAR           PIC 99.
   817         16  DC-GREG-DATE-1-ALPHA.
   818             20  DC-ALPHA-MONTH        PIC X(10).
   819             20  DC-ALPHA-DAY          PIC 99.
   820             20  FILLER                PIC XX.
   821             20  DC-ALPHA-CENTURY.
   822                 24 DC-ALPHA-CEN-N     PIC 99.
   823             20  DC-ALPHA-YEAR         PIC 99.
   824         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   825         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  16
* EL677.cbl
   826         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   827         16  DC-JULIAN-DATE            PIC 9(05).
   828         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   829                                       PIC 9(05).
   830         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   831             20  DC-JULIAN-YEAR        PIC 99.
   832             20  DC-JULIAN-DAYS        PIC 999.
   833         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   834         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   835         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   836     12  DATE-CONVERSION-VARIBLES.
   837         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   838         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   839             20  FILLER                PIC 9(3).
   840             20  HOLD-CEN-1-CCYY.
   841                 24  HOLD-CEN-1-CC     PIC 99.
   842                 24  HOLD-CEN-1-YY     PIC 99.
   843             20  HOLD-CEN-1-MO         PIC 99.
   844             20  HOLD-CEN-1-DA         PIC 99.
   845         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   846             20  HOLD-CEN-1-R-MO       PIC 99.
   847             20  HOLD-CEN-1-R-DA       PIC 99.
   848             20  HOLD-CEN-1-R-CCYY.
   849                 24  HOLD-CEN-1-R-CC   PIC 99.
   850                 24  HOLD-CEN-1-R-YY   PIC 99.
   851             20  FILLER                PIC 9(3).
   852         16  HOLD-CENTURY-1-X.
   853             20  FILLER                PIC X(3)  VALUE SPACES.
   854             20  HOLD-CEN-1-X-CCYY.
   855                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   856                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   857             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   858             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   859         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   860             20  HOLD-CEN-1-R-X-MO     PIC XX.
   861             20  HOLD-CEN-1-R-X-DA     PIC XX.
   862             20  HOLD-CEN-1-R-X-CCYY.
   863                 24  HOLD-CEN-1-R-X-CC PIC XX.
   864                 24  HOLD-CEN-1-R-X-YY PIC XX.
   865             20  FILLER                PIC XXX.
   866         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   867         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   868         16  DC-JULIAN-DATE-1          PIC 9(07).
   869         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   870             20  DC-JULIAN-1-CCYY.
   871                 24  DC-JULIAN-1-CC    PIC 99.
   872                 24  DC-JULIAN-1-YR    PIC 99.
   873             20  DC-JULIAN-DA-1        PIC 999.
   874         16  DC-JULIAN-DATE-2          PIC 9(07).
   875         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   876             20  DC-JULIAN-2-CCYY.
   877                 24  DC-JULIAN-2-CC    PIC 99.
   878                 24  DC-JULIAN-2-YR    PIC 99.
   879             20  DC-JULIAN-DA-2        PIC 999.
   880         16  DC-GREG-DATE-A-EDIT.
   881             20  DC-EDITA-MONTH        PIC 99.
   882             20  SLASHA-1              PIC X VALUE '/'.
   883             20  DC-EDITA-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  17
* EL677.cbl
   884             20  SLASHA-2              PIC X VALUE '/'.
   885             20  DC-EDITA-CCYY.
   886                 24  DC-EDITA-CENT     PIC 99.
   887                 24  DC-EDITA-YEAR     PIC 99.
   888         16  DC-GREG-DATE-B-EDIT.
   889             20  DC-EDITB-MONTH        PIC 99.
   890             20  SLASHB-1              PIC X VALUE '/'.
   891             20  DC-EDITB-DAY          PIC 99.
   892             20  SLASHB-2              PIC X VALUE '/'.
   893             20  DC-EDITB-CCYY.
   894                 24  DC-EDITB-CENT     PIC 99.
   895                 24  DC-EDITB-YEAR     PIC 99.
   896         16  DC-GREG-DATE-CYMD         PIC 9(08).
   897         16  DC-GREG-DATE-CYMD-R REDEFINES
   898                              DC-GREG-DATE-CYMD.
   899             20  DC-CYMD-CEN           PIC 99.
   900             20  DC-CYMD-YEAR          PIC 99.
   901             20  DC-CYMD-MONTH         PIC 99.
   902             20  DC-CYMD-DAY           PIC 99.
   903         16  DC-GREG-DATE-MDCY         PIC 9(08).
   904         16  DC-GREG-DATE-MDCY-R REDEFINES
   905                              DC-GREG-DATE-MDCY.
   906             20  DC-MDCY-MONTH         PIC 99.
   907             20  DC-MDCY-DAY           PIC 99.
   908             20  DC-MDCY-CEN           PIC 99.
   909             20  DC-MDCY-YEAR          PIC 99.
   910    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   911        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   912    12  DC-EL310-DATE                  PIC X(21).
   913    12  FILLER                         PIC X(28).
   914*                                    COPY ELCATTR.
   915******************************************************************
   916*                                                                *
   917*                            ELCATTR.                            *
   918*                            VMOD=2.001                          *
   919*                                                                *
   920*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   921*                                                                *
   922*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   923*                                                                *
   924*                   POS 1   P=PROTECTED                          *
   925*                           U=UNPROTECTED                        *
   926*                           S=ASKIP                              *
   927*                   POS 2   A=ALPHA/NUMERIC                      *
   928*                           N=NUMERIC                            *
   929*                   POS 3   N=NORMAL                             *
   930*                           B=BRIGHT                             *
   931*                           D=DARK                               *
   932*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   933*                           OF=MODIFIED DATA TAG OFF             *
   934*                                                                *
   935*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   936******************************************************************
   937 01  ATTRIBUTE-LIST.
   938     12  AL-PABOF            PIC X       VALUE 'Y'.
   939     12  AL-PABON            PIC X       VALUE 'Z'.
   940     12  AL-PADOF            PIC X       VALUE '%'.
   941     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  18
* EL677.cbl
   942     12  AL-PANOF            PIC X       VALUE '-'.
   943     12  AL-PANON            PIC X       VALUE '/'.
   944     12  AL-SABOF            PIC X       VALUE '8'.
   945     12  AL-SABON            PIC X       VALUE '9'.
   946     12  AL-SADOF            PIC X       VALUE '@'.
   947     12  AL-SADON            PIC X       VALUE QUOTE.
   948     12  AL-SANOF            PIC X       VALUE '0'.
   949     12  AL-SANON            PIC X       VALUE '1'.
   950     12  AL-UABOF            PIC X       VALUE 'H'.
   951     12  AL-UABON            PIC X       VALUE 'I'.
   952     12  AL-UADOF            PIC X       VALUE '<'.
   953     12  AL-UADON            PIC X       VALUE '('.
   954     12  AL-UANOF            PIC X       VALUE ' '.
   955     12  AL-UANON            PIC X       VALUE 'A'.
   956     12  AL-UNBOF            PIC X       VALUE 'Q'.
   957     12  AL-UNBON            PIC X       VALUE 'R'.
   958     12  AL-UNDOF            PIC X       VALUE '*'.
   959     12  AL-UNDON            PIC X       VALUE ')'.
   960     12  AL-UNNOF            PIC X       VALUE '&'.
   961     12  AL-UNNON            PIC X       VALUE 'J'.
   962*                                    COPY ELCEMIB.
   963******************************************************************
   964*                                                                *
   965*                                                                *
   966*                            ELCEMIB.                            *
   967*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   968*                            VMOD=2.005                          *
   969*                                                                *
   970*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   971*                                                                *
   972******************************************************************
   973 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   974     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   975     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   976     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   977     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   978     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   979     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   980     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   981     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   982     12  EMI-SWITCH1             PIC X        VALUE '1'.
   983         88  EMI-NO-ERRORS                    VALUE '1'.
   984         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   985         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   986     12  EMI-SWITCH2             PIC X        VALUE '1'.
   987         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   988     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   989         88  EMI-AREA1-EMPTY                  VALUE '1'.
   990         88  EMI-AREA1-FULL                   VALUE '2'.
   991     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   992         88  EMI-AREA2-EMPTY                  VALUE '1'.
   993         88  EMI-AREA2-FULL                   VALUE '2'.
   994     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   995         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   996         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   997         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   998         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   999         88  EMI-BYPASS-FATALS                VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  19
* EL677.cbl
  1000     12  EMI-ERROR-LINES.
  1001         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1002         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1003         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1004         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1005             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1006                 24  EMI-ERR-NUM         PIC X(4).
  1007                 24  EMI-FILLER          PIC X.
  1008                 24  EMI-SEV             PIC X.
  1009                 24  FILLER              PIC X.
  1010             20  FILLER                  PIC X(02).
  1011     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1012         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1013             20  EMI-ERROR-NUMBER    PIC X(4).
  1014             20  EMI-FILL            PIC X.
  1015             20  EMI-SEVERITY        PIC X.
  1016             20  FILLER              PIC X.
  1017             20  EMI-ERROR-TEXT.
  1018                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1019                 24  FILLER          PIC X(55).
  1020     12  EMI-SEVERITY-SAVE           PIC X.
  1021         88  EMI-NOTE                    VALUE 'N'.
  1022         88  EMI-WARNING                 VALUE 'W'.
  1023         88  EMI-FORCABLE                VALUE 'F'.
  1024         88  EMI-FATAL                   VALUE 'X'.
  1025     12  EMI-MESSAGE-FLAG            PIC X.
  1026         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1027         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1028     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1029     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1030         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1031         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1032         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1033     12  emi-claim-no                pic x(7).
  1034     12  emi-claim-type              pic x(6).
  1035     12  FILLER                      PIC X(124)  VALUE SPACES.
  1036     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1037     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1038     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1039     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1040*                                    COPY ELCINTF.
  1041******************************************************************
  1042*                                                                *
  1043*                                                                *
  1044*                            ELCINTF.                            *
  1045*                            VMOD=2.017                          *
  1046*                                                                *
  1047*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1048*                                                                *
  1049*       LENGTH = 1024                                            *
  1050*                                                                *
  1051******************************************************************
  1052*                   C H A N G E   L O G
  1053*
  1054* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1055*-----------------------------------------------------------------
  1056*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1057* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  20
* EL677.cbl
  1058*-----------------------------------------------------------------
  1059* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1060******************************************************************
  1061 01  PROGRAM-INTERFACE-BLOCK.
  1062     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1063     12  PI-CALLING-PROGRAM              PIC X(8).
  1064     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1065     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1066     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1067     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1068     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1069     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1070     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1071     12  PI-COMPANY-ID                   PIC XXX.
  1072     12  PI-COMPANY-CD                   PIC X.
  1073
  1074     12  PI-COMPANY-PASSWORD             PIC X(8).
  1075
  1076     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1077
  1078     12  PI-CONTROL-IN-PROGRESS.
  1079         16  PI-CARRIER                  PIC X.
  1080         16  PI-GROUPING                 PIC X(6).
  1081         16  PI-STATE                    PIC XX.
  1082         16  PI-ACCOUNT                  PIC X(10).
  1083         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1084                                         PIC X(10).
  1085         16  PI-CLAIM-CERT-GRP.
  1086             20  PI-CLAIM-NO             PIC X(7).
  1087             20  PI-CERT-NO.
  1088                 25  PI-CERT-PRIME       PIC X(10).
  1089                 25  PI-CERT-SFX         PIC X.
  1090             20  PI-CERT-EFF-DT          PIC XX.
  1091         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1092             20  PI-PLAN-CODE            PIC X(2).
  1093             20  PI-REVISION-NUMBER      PIC X(3).
  1094             20  PI-PLAN-EFF-DT          PIC X(2).
  1095             20  PI-PLAN-EXP-DT          PIC X(2).
  1096             20  FILLER                  PIC X(11).
  1097         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1098             20  PI-OE-REFERENCE-1.
  1099                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1100                 25  PI-OE-REF-1-SUFF    PIC XX.
  1101
  1102     12  PI-SESSION-IN-PROGRESS          PIC X.
  1103         88  CLAIM-SESSION                   VALUE '1'.
  1104         88  CREDIT-SESSION                  VALUE '2'.
  1105         88  WARRANTY-SESSION                VALUE '3'.
  1106         88  MORTGAGE-SESSION                VALUE '4'.
  1107         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1108
  1109
  1110*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1111
  1112     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1113     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1114
  1115     12  PI-CREDIT-USER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  21
* EL677.cbl
  1116         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1117         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1118
  1119     12  PI-CLAIM-USER                   PIC X.
  1120         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1121         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1122
  1123     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1124         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1125         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1126         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1127         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1128         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1129
  1130     12  PI-PROCESSOR-ID                 PIC X(4).
  1131
  1132     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1133
  1134     12  PI-MEMBER-CAPTION               PIC X(10).
  1135
  1136     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1137         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1138
  1139     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1140     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1141     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1142     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1143
  1144     12  PI-AH-OVERRIDE-L1               PIC X.
  1145     12  PI-AH-OVERRIDE-L2               PIC XX.
  1146     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1147     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1148
  1149     12  PI-NEW-SYSTEM                   PIC X(2).
  1150
  1151     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1152     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1153         88  PI-USES-PAID-TO                 VALUE '1'.
  1154     12  PI-CRDTCRD-SYSTEM.
  1155         16  PI-CRDTCRD-USER             PIC X.
  1156             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1157             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1158         16  PI-CC-MONTH-END-DT          PIC XX.
  1159     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1160
  1161     12  PI-OE-REFERENCE-2.
  1162         16  PI-OE-REF-2-PRIME           PIC X(10).
  1163         16  PI-OE-REF-2-SUFF            PIC X.
  1164
  1165     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1166
  1167     12  PI-LANGUAGE-TYPE                PIC X.
  1168             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1169             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1170             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1171
  1172     12  PI-POLICY-LINKAGE-IND           PIC X.
  1173         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  22
* EL677.cbl
  1174         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1175                                                   LOW-VALUES.
  1176
  1177     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1178     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1179         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1180         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1181
  1182     12  PI-PROCESSOR-CSR-IND            PIC X.
  1183         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1184         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1185
  1186     12  FILLER                          PIC X(3).
  1187
  1188     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1189
  1190     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1191         PI-SYSTEM-LEVEL.
  1192
  1193         16  PI-ENTRY-CODES.
  1194             20  PI-ENTRY-CD-1           PIC X.
  1195             20  PI-ENTRY-CD-2           PIC X.
  1196
  1197         16  PI-RETURN-CODES.
  1198             20  PI-RETURN-CD-1          PIC X.
  1199             20  PI-RETURN-CD-2          PIC X.
  1200
  1201         16  PI-UPDATE-STATUS-SAVE.
  1202             20  PI-UPDATE-BY            PIC X(4).
  1203             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1204
  1205         16  PI-LOWER-CASE-LETTERS       PIC X.
  1206             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1207
  1208*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1209*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1210*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1211
  1212         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1213             88  ST-ACCNT-CNTL               VALUE ' '.
  1214             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1215             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1216             88  ACCNT-CNTL                  VALUE '3'.
  1217             88  CARR-ACCNT-CNTL             VALUE '4'.
  1218
  1219         16  PI-PROCESSOR-CAP-LIST.
  1220             20  PI-SYSTEM-CONTROLS.
  1221                24 PI-SYSTEM-DISPLAY     PIC X.
  1222                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1223                24 PI-SYSTEM-MODIFY      PIC X.
  1224                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1225             20  FILLER                  PIC XX.
  1226             20  PI-DISPLAY-CAP          PIC X.
  1227                 88  DISPLAY-CAP             VALUE 'Y'.
  1228             20  PI-MODIFY-CAP           PIC X.
  1229                 88  MODIFY-CAP              VALUE 'Y'.
  1230             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1231                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  23
* EL677.cbl
  1232             20  PI-FORCE-CAP            PIC X.
  1233                 88  FORCE-CAP               VALUE 'Y'.
  1234
  1235         16  PI-PROGRAM-CONTROLS.
  1236             20  PI-PGM-PRINT-OPT        PIC X.
  1237             20  PI-PGM-FORMAT-OPT       PIC X.
  1238             20  PI-PGM-PROCESS-OPT      PIC X.
  1239             20  PI-PGM-TOTALS-OPT       PIC X.
  1240
  1241         16  PI-HELP-INTERFACE.
  1242             20  PI-LAST-ERROR-NO        PIC X(4).
  1243             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1244
  1245         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1246             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1247
  1248         16  PI-CR-CONTROL-IN-PROGRESS.
  1249             20  PI-CR-CARRIER           PIC X.
  1250             20  PI-CR-GROUPING          PIC X(6).
  1251             20  PI-CR-STATE             PIC XX.
  1252             20  PI-CR-ACCOUNT           PIC X(10).
  1253             20  PI-CR-FIN-RESP          PIC X(10).
  1254             20  PI-CR-TYPE              PIC X.
  1255
  1256         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1257
  1258         16  PI-CR-MONTH-END-DT          PIC XX.
  1259
  1260         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1261             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1262             88  PI-ZERO-CARRIER             VALUE '1'.
  1263             88  PI-ZERO-GROUPING            VALUE '2'.
  1264             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1265
  1266         16  PI-CARRIER-SECURITY         PIC X.
  1267             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1268
  1269         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1270             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1271             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1272
  1273         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1274             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1275                                         INDEXED BY PI-ACCESS-NDX
  1276                                         PIC X.
  1277
  1278         16  PI-GA-BILLING-CONTROL       PIC X.
  1279             88  PI-GA-BILLING               VALUE '1'.
  1280
  1281         16  PI-MAIL-PROCESSING          PIC X.
  1282             88  PI-MAIL-YES                 VALUE 'Y'.
  1283
  1284         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1285
  1286         16  PI-AR-SYSTEM.
  1287             20  PI-AR-PROCESSING-CNTL   PIC X.
  1288                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1289             20  PI-AR-SUMMARY-CODE      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  24
* EL677.cbl
  1290             20  PI-AR-MONTH-END-DT      PIC XX.
  1291
  1292         16  PI-MP-SYSTEM.
  1293             20  PI-MORTGAGE-USER            PIC X.
  1294                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1295                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1296             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1297                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1298                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1299                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1300                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1301                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1302             20  PI-MP-MONTH-END-DT          PIC XX.
  1303             20  PI-MP-REFERENCE-NO.
  1304                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1305                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1306
  1307         16  PI-LABEL-CONTROL            PIC X(01).
  1308             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1309             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1310
  1311         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1312             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1313
  1314         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1315             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1316             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1317
  1318         16  FILLER                      PIC X(14).
  1319
  1320     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1321******************************************************************
  1322     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1323         16  PI-EOF-SW               PIC X.
  1324             88  PI-FILE-EOF                     VALUE 'Y'.
  1325         16  PI-PREV-MAINT           PIC X.
  1326         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1327         16  PI-ERCHEK-KEY.
  1328             20  PI-CHEK-COMP-CD     PIC X.
  1329             20  PI-CHEK-CARRIER     PIC X.
  1330             20  PI-CHEK-GROUPING    PIC X(6).
  1331             20  PI-CHEK-STATE       PIC XX.
  1332             20  PI-CHEK-ACCOUNT     PIC X(10).
  1333             20  PI-CHEK-EFF-DT      PIC XX.
  1334             20  PI-CHEK-CERT-NO     PIC X(10).
  1335             20  PI-CHEK-SUF-NO      PIC X.
  1336             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1337         16  PI-ACCOUNT-ADDRESS.
  1338             20  PI-AM-NAME          PIC X(30).
  1339             20  PI-AM-ADDRS         PIC X(30).
  1340             20  PI-AM-CITY-st.
  1341                 24  pi-am-city      PIC X(28).
  1342                 24  pi-am-st        pic xx.
  1343             20  PI-AM-ZIP-CODE.
  1344                 24  PI-AM-ZIP-PRIME PIC X(5).
  1345                 24  PI-AM-ZIP-PLUS4 PIC X(4).
  1346         16  PI-PROCESS-CERT-SW          PIC X.
  1347             88  PI-PROCESS-CERT                     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  25
* EL677.cbl
  1348         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1349             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1350         16  PI-PAYTO1                   PIC X(30).
  1351         16  PI-REFERENCE                PIC X(12).
  1352         16  PI-CANC-DT                  PIC XX.
  1353         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
  1354         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
  1355         16  PI-INSURED-NAME             PIC X(28).
  1356         16  PI-PFKEY                    PIC XXX.
  1357             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1358             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1359         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1360         16  PI-TYPE                     PIC X.
  1361         16  pi-prev-paid                pic s9(7)v99 comp-3.
  1362         16  pi-refund-on-pending-rec    pic s9(7)v99 comp-3.
  1363         16  pi-ue-comm                  pic s9(7)v99 comp-3.
  1364         16  pi-chek-rec-cnt             pic s999 comp-3.
  1365         16  pi-am-csr                   pic x(4).
  1366         16  pi-return-to                pic x(30).
  1367         16  pi-prev-ded-comm            pic x.
  1368         16  pi-table-name               pic x(30).
  1369         16  pi-check-cashed             pic x.
  1370         16  pi-endt-prm-diff            pic s9(7)v99 comp-3.
  1371         16  pi-endt-com-diff            pic s9(5)v99 comp-3.
  1372         16  pi-check-type               pic x.
  1373             88  ws-corr-check              value 'C'.
  1374             88  ws-ref-check               value 'R'.
  1375         16  pi-check-cut                pic x.
  1376         16  FILLER                      PIC X(311). *> wass 322
  1377*                                    COPY ELCAID.
  1378******************************************************************
  1379*                                                                *
  1380*                            ELCAID.                             *
  1381*                            VMOD=2.001                          *
  1382*                                                                *
  1383*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1384*                                                                *
  1385*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1386*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1387******************************************************************
  1388
  1389 01  DFHAID.
  1390   02  DFHNULL   PIC  X  VALUE  ' '.
  1391   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1392   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1393   02  DFHPEN    PIC  X  VALUE  '='.
  1394   02  DFHOPID   PIC  X  VALUE  'W'.
  1395   02  DFHPA1    PIC  X  VALUE  '%'.
  1396   02  DFHPA2    PIC  X  VALUE  '>'.
  1397   02  DFHPA3    PIC  X  VALUE  ','.
  1398   02  DFHPF1    PIC  X  VALUE  '1'.
  1399   02  DFHPF2    PIC  X  VALUE  '2'.
  1400   02  DFHPF3    PIC  X  VALUE  '3'.
  1401   02  DFHPF4    PIC  X  VALUE  '4'.
  1402   02  DFHPF5    PIC  X  VALUE  '5'.
  1403   02  DFHPF6    PIC  X  VALUE  '6'.
  1404   02  DFHPF7    PIC  X  VALUE  '7'.
  1405   02  DFHPF8    PIC  X  VALUE  '8'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  26
* EL677.cbl
  1406   02  DFHPF9    PIC  X  VALUE  '9'.
  1407   02  DFHPF10   PIC  X  VALUE  ':'.
  1408   02  DFHPF11   PIC  X  VALUE  '#'.
  1409   02  DFHPF12   PIC  X  VALUE  '@'.
  1410   02  DFHPF13   PIC  X  VALUE  'A'.
  1411   02  DFHPF14   PIC  X  VALUE  'B'.
  1412   02  DFHPF15   PIC  X  VALUE  'C'.
  1413   02  DFHPF16   PIC  X  VALUE  'D'.
  1414   02  DFHPF17   PIC  X  VALUE  'E'.
  1415   02  DFHPF18   PIC  X  VALUE  'F'.
  1416   02  DFHPF19   PIC  X  VALUE  'G'.
  1417   02  DFHPF20   PIC  X  VALUE  'H'.
  1418   02  DFHPF21   PIC  X  VALUE  'I'.
  1419*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1420   02  DFHPF22   PIC  X  VALUE  '['.
  1421   02  DFHPF23   PIC  X  VALUE  '.'.
  1422   02  DFHPF24   PIC  X  VALUE  '<'.
  1423   02  DFHMSRE   PIC  X  VALUE  'X'.
  1424   02  DFHSTRF   PIC  X  VALUE  'h'.
  1425   02  DFHTRIG   PIC  X  VALUE  '"'.
  1426 01  FILLER    REDEFINES DFHAID.
  1427     12  FILLER                      PIC X(8).
  1428     12  PF-VALUES                   PIC X       OCCURS 24.
  1429     12  FILLER                      PIC X(3).
  1430*                                    COPY EL677S.
  1431 01  EL677AI.
  1432     05  FILLER            PIC  X(0012).
  1433*    -------------------------------
  1434     05  DATEL PIC S9(0004) COMP.
  1435     05  DATEF PIC  X(0001).
  1436     05  FILLER REDEFINES DATEF.
  1437         10  DATEA PIC  X(0001).
  1438     05  DATEI PIC  X(0008).
  1439*    -------------------------------
  1440     05  TIMEL PIC S9(0004) COMP.
  1441     05  TIMEF PIC  X(0001).
  1442     05  FILLER REDEFINES TIMEF.
  1443         10  TIMEA PIC  X(0001).
  1444     05  TIMEI PIC  X(0005).
  1445*    -------------------------------
  1446     05  MAINTL PIC S9(0004) COMP.
  1447     05  MAINTF PIC  X(0001).
  1448     05  FILLER REDEFINES MAINTF.
  1449         10  MAINTA PIC  X(0001).
  1450     05  MAINTI PIC  X(0001).
  1451*    -------------------------------
  1452     05  DMAINT1L PIC S9(0004) COMP.
  1453     05  DMAINT1F PIC  X(0001).
  1454     05  FILLER REDEFINES DMAINT1F.
  1455         10  DMAINT1A PIC  X(0001).
  1456     05  DMAINT1I PIC  X(0009).
  1457*    -------------------------------
  1458     05  DMAINT2L PIC S9(0004) COMP.
  1459     05  DMAINT2F PIC  X(0001).
  1460     05  FILLER REDEFINES DMAINT2F.
  1461         10  DMAINT2A PIC  X(0001).
  1462     05  DMAINT2I PIC  X(0029).
  1463*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  27
* EL677.cbl
  1464     05  CARRIERL PIC S9(0004) COMP.
  1465     05  CARRIERF PIC  X(0001).
  1466     05  FILLER REDEFINES CARRIERF.
  1467         10  CARRIERA PIC  X(0001).
  1468     05  CARRIERI PIC  X(0001).
  1469*    -------------------------------
  1470     05  GROUPL PIC S9(0004) COMP.
  1471     05  GROUPF PIC  X(0001).
  1472     05  FILLER REDEFINES GROUPF.
  1473         10  GROUPA PIC  X(0001).
  1474     05  GROUPI PIC  X(0006).
  1475*    -------------------------------
  1476     05  STATEL PIC S9(0004) COMP.
  1477     05  STATEF PIC  X(0001).
  1478     05  FILLER REDEFINES STATEF.
  1479         10  STATEA PIC  X(0001).
  1480     05  STATEI PIC  X(0002).
  1481*    -------------------------------
  1482     05  ACCTL PIC S9(0004) COMP.
  1483     05  ACCTF PIC  X(0001).
  1484     05  FILLER REDEFINES ACCTF.
  1485         10  ACCTA PIC  X(0001).
  1486     05  ACCTI PIC  X(0010).
  1487*    -------------------------------
  1488     05  EFFDTL PIC S9(0004) COMP.
  1489     05  EFFDTF PIC  X(0001).
  1490     05  FILLER REDEFINES EFFDTF.
  1491         10  EFFDTA PIC  X(0001).
  1492     05  EFFDTI PIC  X(0008).
  1493*    -------------------------------
  1494     05  CERTNOL PIC S9(0004) COMP.
  1495     05  CERTNOF PIC  X(0001).
  1496     05  FILLER REDEFINES CERTNOF.
  1497         10  CERTNOA PIC  X(0001).
  1498     05  CERTNOI PIC  X(0010).
  1499*    -------------------------------
  1500     05  SFXL PIC S9(0004) COMP.
  1501     05  SFXF PIC  X(0001).
  1502     05  FILLER REDEFINES SFXF.
  1503         10  SFXA PIC  X(0001).
  1504     05  SFXI PIC  X(0001).
  1505*    -------------------------------
  1506     05  SEQL PIC S9(0004) COMP.
  1507     05  SEQF PIC  X(0001).
  1508     05  FILLER REDEFINES SEQF.
  1509         10  SEQA PIC  X(0001).
  1510     05  SEQI PIC  99.
  1511*    -------------------------------
  1512     05  PAYTO1L PIC S9(0004) COMP.
  1513     05  PAYTO1F PIC  X(0001).
  1514     05  FILLER REDEFINES PAYTO1F.
  1515         10  PAYTO1A PIC  X(0001).
  1516     05  PAYTO1I PIC  X(0030).
  1517*    -------------------------------
  1518     05  CREATEDL PIC S9(0004) COMP.
  1519     05  CREATEDF PIC  X(0001).
  1520     05  FILLER REDEFINES CREATEDF.
  1521         10  CREATEDA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  28
* EL677.cbl
  1522     05  CREATEDI PIC  X(0008).
  1523*    -------------------------------
  1524     05  CBYL PIC S9(0004) COMP.
  1525     05  CBYF PIC  X(0001).
  1526     05  FILLER REDEFINES CBYF.
  1527         10  CBYA PIC  X(0001).
  1528     05  CBYI PIC  X(0004).
  1529*    -------------------------------
  1530     05  PAYTO2L PIC S9(0004) COMP.
  1531     05  PAYTO2F PIC  X(0001).
  1532     05  FILLER REDEFINES PAYTO2F.
  1533         10  PAYTO2A PIC  X(0001).
  1534     05  PAYTO2I PIC  X(0030).
  1535*    -------------------------------
  1536     05  PAYEEL PIC S9(0004) COMP.
  1537     05  PAYEEF PIC  X(0001).
  1538     05  FILLER REDEFINES PAYEEF.
  1539         10  PAYEEA PIC  X(0001).
  1540     05  PAYEEI PIC  X(0006).
  1541*    -------------------------------
  1542     05  APVSTATL PIC S9(0004) COMP.
  1543     05  APVSTATF PIC  X(0001).
  1544     05  FILLER REDEFINES APVSTATF.
  1545         10  APVSTATA PIC  X(0001).
  1546     05  APVSTATI PIC  X(0009).
  1547*    -------------------------------
  1548     05  PAYAD1L PIC S9(0004) COMP.
  1549     05  PAYAD1F PIC  X(0001).
  1550     05  FILLER REDEFINES PAYAD1F.
  1551         10  PAYAD1A PIC  X(0001).
  1552     05  PAYAD1I PIC  X(0030).
  1553*    -------------------------------
  1554     05  APVDTL PIC S9(0004) COMP.
  1555     05  APVDTF PIC  X(0001).
  1556     05  FILLER REDEFINES APVDTF.
  1557         10  APVDTA PIC  X(0001).
  1558     05  APVDTI PIC  X(0008).
  1559*    -------------------------------
  1560     05  APVBYL PIC S9(0004) COMP.
  1561     05  APVBYF PIC  X(0001).
  1562     05  FILLER REDEFINES APVBYF.
  1563         10  APVBYA PIC  X(0001).
  1564     05  APVBYI PIC  X(0004).
  1565*    -------------------------------
  1566     05  PAYAD2L PIC S9(0004) COMP.
  1567     05  PAYAD2F PIC  X(0001).
  1568     05  FILLER REDEFINES PAYAD2F.
  1569         10  PAYAD2A PIC  X(0001).
  1570     05  PAYAD2I PIC  X(0030).
  1571*    -------------------------------
  1572     05  VOIDEDL PIC S9(0004) COMP.
  1573     05  VOIDEDF PIC  X(0001).
  1574     05  FILLER REDEFINES VOIDEDF.
  1575         10  VOIDEDA PIC  X(0001).
  1576     05  VOIDEDI PIC  X(0008).
  1577*    -------------------------------
  1578     05  VBYL PIC S9(0004) COMP.
  1579     05  VBYF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  29
* EL677.cbl
  1580     05  FILLER REDEFINES VBYF.
  1581         10  VBYA PIC  X(0001).
  1582     05  VBYI PIC  X(0004).
  1583*    -------------------------------
  1584     05  PAYCTYL PIC S9(0004) COMP.
  1585     05  PAYCTYF PIC  X(0001).
  1586     05  FILLER REDEFINES PAYCTYF.
  1587         10  PAYCTYA PIC  X(0001).
  1588     05  PAYCTYI PIC  X(0028).
  1589*    -------------------------------
  1590     05  PAYSTL PIC S9(0004) COMP.
  1591     05  PAYSTF PIC  X(0001).
  1592     05  FILLER REDEFINES PAYSTF.
  1593         10  PAYSTA PIC  X(0001).
  1594     05  PAYSTI PIC  X(0002).
  1595*    -------------------------------
  1596     05  PRINTEDL PIC S9(0004) COMP.
  1597     05  PRINTEDF PIC  X(0001).
  1598     05  FILLER REDEFINES PRINTEDF.
  1599         10  PRINTEDA PIC  X(0001).
  1600     05  PRINTEDI PIC  X(0008).
  1601*    -------------------------------
  1602     05  PTOZIPL PIC S9(0004) COMP.
  1603     05  PTOZIPF PIC  X(0001).
  1604     05  FILLER REDEFINES PTOZIPF.
  1605         10  PTOZIPA PIC  X(0001).
  1606     05  PTOZIPI PIC  X(0009).
  1607*    -------------------------------
  1608     05  DEDCYNL PIC S9(0004) COMP.
  1609     05  DEDCYNF PIC  X(0001).
  1610     05  FILLER REDEFINES DEDCYNF.
  1611         10  DEDCYNA PIC  X(0001).
  1612     05  DEDCYNI PIC  X(0001).
  1613*    -------------------------------
  1614     05  CASHEDL PIC S9(0004) COMP.
  1615     05  CASHEDF PIC  X(0001).
  1616     05  FILLER REDEFINES CASHEDF.
  1617         10  CASHEDA PIC  X(0001).
  1618     05  CASHEDI PIC  X(0008).
  1619*    -------------------------------
  1620     05  RETTOL PIC S9(0004) COMP.
  1621     05  RETTOF PIC  X(0001).
  1622     05  FILLER REDEFINES RETTOF.
  1623         10  RETTOA PIC  X(0001).
  1624     05  RETTOI PIC  X(0030).
  1625*    -------------------------------
  1626     05  DPREML PIC S9(0004) COMP.
  1627     05  DPREMF PIC  X(0001).
  1628     05  FILLER REDEFINES DPREMF.
  1629         10  DPREMA PIC  X(0001).
  1630     05  DPREMI PIC  X(0005).
  1631*    -------------------------------
  1632     05  PREML PIC S9(0004) COMP.
  1633     05  PREMF PIC  X(0001).
  1634     05  FILLER REDEFINES PREMF.
  1635         10  PREMA PIC  X(0001).
  1636     05  PREMI PIC  X(0008).
  1637*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  30
* EL677.cbl
  1638     05  DCOMML PIC S9(0004) COMP.
  1639     05  DCOMMF PIC  X(0001).
  1640     05  FILLER REDEFINES DCOMMF.
  1641         10  DCOMMA PIC  X(0001).
  1642     05  DCOMMI PIC  X(0005).
  1643*    -------------------------------
  1644     05  ISSCOMML PIC S9(0004) COMP.
  1645     05  ISSCOMMF PIC  X(0001).
  1646     05  FILLER REDEFINES ISSCOMMF.
  1647         10  ISSCOMMA PIC  X(0001).
  1648     05  ISSCOMMI PIC  X(0008).
  1649*    -------------------------------
  1650     05  DREFL PIC S9(0004) COMP.
  1651     05  DREFF PIC  X(0001).
  1652     05  FILLER REDEFINES DREFF.
  1653         10  DREFA PIC  X(0001).
  1654     05  DREFI PIC  X(0004).
  1655*    -------------------------------
  1656     05  REFL PIC S9(0004) COMP.
  1657     05  REFF PIC  X(0001).
  1658     05  FILLER REDEFINES REFF.
  1659         10  REFA PIC  X(0001).
  1660     05  REFI PIC  X(0008).
  1661*    -------------------------------
  1662     05  DUECOMML PIC S9(0004) COMP.
  1663     05  DUECOMMF PIC  X(0001).
  1664     05  FILLER REDEFINES DUECOMMF.
  1665         10  DUECOMMA PIC  X(0001).
  1666     05  DUECOMMI PIC  X(0007).
  1667*    -------------------------------
  1668     05  UECOMML PIC S9(0004) COMP.
  1669     05  UECOMMF PIC  X(0001).
  1670     05  FILLER REDEFINES UECOMMF.
  1671         10  UECOMMA PIC  X(0001).
  1672     05  UECOMMI PIC  X(0008).
  1673*    -------------------------------
  1674     05  DPREPDL PIC S9(0004) COMP.
  1675     05  DPREPDF PIC  X(0001).
  1676     05  FILLER REDEFINES DPREPDF.
  1677         10  DPREPDA PIC  X(0001).
  1678     05  DPREPDI PIC  X(0006).
  1679*    -------------------------------
  1680     05  PREPDL PIC S9(0004) COMP.
  1681     05  PREPDF PIC  X(0001).
  1682     05  FILLER REDEFINES PREPDF.
  1683         10  PREPDA PIC  X(0001).
  1684     05  PREPDI PIC  X(0008).
  1685*    -------------------------------
  1686     05  AMOUNTL PIC S9(0004) COMP.
  1687     05  AMOUNTF PIC  X(0001).
  1688     05  FILLER REDEFINES AMOUNTF.
  1689         10  AMOUNTA PIC  X(0001).
  1690     05  AMOUNTI PIC  S9(9)V99.
  1691*    -------------------------------
  1692     05  CHECKL PIC S9(0004) COMP.
  1693     05  CHECKF PIC  X(0001).
  1694     05  FILLER REDEFINES CHECKF.
  1695         10  CHECKA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  31
* EL677.cbl
  1696     05  CHECKI PIC  X(0007).
  1697*    -------------------------------
  1698     05  TYPEL PIC S9(0004) COMP.
  1699     05  TYPEF PIC  X(0001).
  1700     05  FILLER REDEFINES TYPEF.
  1701         10  TYPEA PIC  X(0001).
  1702     05  TYPEI PIC  X(0001).
  1703*    -------------------------------
  1704     05  REASONL PIC S9(0004) COMP.
  1705     05  REASONF PIC  X(0001).
  1706     05  FILLER REDEFINES REASONF.
  1707         10  REASONA PIC  X(0001).
  1708     05  REASONI PIC  X(0025).
  1709*    -------------------------------
  1710     05  VREASONL PIC S9(0004) COMP.
  1711     05  VREASONF PIC  X(0001).
  1712     05  FILLER REDEFINES VREASONF.
  1713         10  VREASONA PIC  X(0001).
  1714     05  VREASONI PIC  X(0024).
  1715*    -------------------------------
  1716     05  STUBL PIC S9(0004) COMP.
  1717     05  STUBF PIC  X(0001).
  1718     05  FILLER REDEFINES STUBF.
  1719         10  STUBA PIC  X(0001).
  1720     05  STUBI PIC  X(0030).
  1721*    -------------------------------
  1722     05  TEXT1L PIC S9(0004) COMP.
  1723     05  TEXT1F PIC  X(0001).
  1724     05  FILLER REDEFINES TEXT1F.
  1725         10  TEXT1A PIC  X(0001).
  1726     05  TEXT1I PIC  X(0050).
  1727*    -------------------------------
  1728     05  TEXT2L PIC S9(0004) COMP.
  1729     05  TEXT2F PIC  X(0001).
  1730     05  FILLER REDEFINES TEXT2F.
  1731         10  TEXT2A PIC  X(0001).
  1732     05  TEXT2I PIC  X(0050).
  1733*    -------------------------------
  1734     05  TEXT3L PIC S9(0004) COMP.
  1735     05  TEXT3F PIC  X(0001).
  1736     05  FILLER REDEFINES TEXT3F.
  1737         10  TEXT3A PIC  X(0001).
  1738     05  TEXT3I PIC  X(0040).
  1739*    -------------------------------
  1740     05  ERRMSG1L PIC S9(0004) COMP.
  1741     05  ERRMSG1F PIC  X(0001).
  1742     05  FILLER REDEFINES ERRMSG1F.
  1743         10  ERRMSG1A PIC  X(0001).
  1744     05  ERRMSG1I PIC  X(0079).
  1745*    -------------------------------
  1746     05  ERRMSG2L PIC S9(0004) COMP.
  1747     05  ERRMSG2F PIC  X(0001).
  1748     05  FILLER REDEFINES ERRMSG2F.
  1749         10  ERRMSG2A PIC  X(0001).
  1750     05  ERRMSG2I PIC  X(0079).
  1751*    -------------------------------
  1752     05  PFENTERL PIC S9(0004) COMP.
  1753     05  PFENTERF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  32
* EL677.cbl
  1754     05  FILLER REDEFINES PFENTERF.
  1755         10  PFENTERA PIC  X(0001).
  1756     05  PFENTERI PIC  9(2).
  1757*    -------------------------------
  1758     05  PF357L PIC S9(0004) COMP.
  1759     05  PF357F PIC  X(0001).
  1760     05  FILLER REDEFINES PF357F.
  1761         10  PF357A PIC  X(0001).
  1762     05  PF357I PIC  X(0050).
  1763*    -------------------------------
  1764     05  PF46L PIC S9(0004) COMP.
  1765     05  PF46F PIC  X(0001).
  1766     05  FILLER REDEFINES PF46F.
  1767         10  PF46A PIC  X(0001).
  1768     05  PF46I PIC  X(0033).
  1769 01  EL677AO REDEFINES EL677AI.
  1770     05  FILLER            PIC  X(0012).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  DATEO PIC  X(0008).
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  TIMEO PIC  99.99.
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  MAINTO PIC  X(0001).
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  DMAINT1O PIC  X(0009).
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  DMAINT2O PIC  X(0029).
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  CARRIERO PIC  X(0001).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  GROUPO PIC  X(0006).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
  1794     05  STATEO PIC  X(0002).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  ACCTO PIC  X(0010).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  EFFDTO PIC  99B99B99.
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  CERTNOO PIC  X(0010).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  SFXO PIC  X(0001).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  SEQO PIC  99.
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  33
* EL677.cbl
  1812     05  PAYTO1O PIC  X(0030).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  CREATEDO PIC  X(0008).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  CBYO PIC  X(0004).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  PAYTO2O PIC  X(0030).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  PAYEEO PIC  X(0006).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  APVSTATO PIC  X(0009).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  PAYAD1O PIC  X(0030).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  APVDTO PIC  X(0008).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  APVBYO PIC  X(0004).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  PAYAD2O PIC  X(0030).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  VOIDEDO PIC  X(0008).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  VBYO PIC  X(0004).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  PAYCTYO PIC  X(0028).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  PAYSTO PIC  X(0002).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  PRINTEDO PIC  99B99B99.
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  PTOZIPO PIC  X(0009).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  DEDCYNO PIC  X(0001).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  CASHEDO PIC  X(0008).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  RETTOO PIC  X(0030).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  DPREMO PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  34
* EL677.cbl
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  PREMO PIC  Z(5).99.
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  DCOMMO PIC  X(0005).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  ISSCOMMO PIC  Z(5).99.
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  DREFO PIC  X(0004).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  REFO PIC  Z(5).99.
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  DUECOMMO PIC  X(0007).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  UECOMMO PIC  Z(5).99.
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  DPREPDO PIC  X(0006).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  PREPDO PIC  Z(5).99.
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  AMOUNTO PIC  Z(7).ZZ-.
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  CHECKO PIC  X(0007).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  TYPEO PIC  X(0001).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  REASONO PIC  X(0025).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  VREASONO PIC  X(0024).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  STUBO PIC  X(0030).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  TEXT1O PIC  X(0050).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  TEXT2O PIC  X(0050).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  TEXT3O PIC  X(0040).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  ERRMSG1O PIC  X(0079).
  1927*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  35
* EL677.cbl
  1928     05  FILLER            PIC  X(0003).
  1929     05  ERRMSG2O PIC  X(0079).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  PFENTERO PIC  99.
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  PF357O PIC  X(0050).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  PF46O PIC  X(0033).
  1939*    -------------------------------
  1940****************************************************************
  1941*
  1942* Copyright (c) 2007 by Clerity Solutions, Inc.
  1943* All rights reserved.
  1944*
  1945****************************************************************
  1946 01  DFHEIV.
  1947   02  DFHEIV0               PIC X(35).
  1948   02  DFHEIV1               PIC X(08).
  1949   02  DFHEIV2               PIC X(08).
  1950   02  DFHEIV3               PIC X(08).
  1951   02  DFHEIV4               PIC X(06).
  1952   02  DFHEIV5               PIC X(04).
  1953   02  DFHEIV6               PIC X(04).
  1954   02  DFHEIV7               PIC X(02).
  1955   02  DFHEIV8               PIC X(02).
  1956   02  DFHEIV9               PIC X(01).
  1957   02  DFHEIV10              PIC S9(7) COMP-3.
  1958   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1959   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1960   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1961   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1962   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1963   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1964   02  DFHEIV17              PIC X(04).
  1965   02  DFHEIV18              PIC X(04).
  1966   02  DFHEIV19              PIC X(04).
  1967   02  DFHEIV20              USAGE IS POINTER.
  1968   02  DFHEIV21              USAGE IS POINTER.
  1969   02  DFHEIV22              USAGE IS POINTER.
  1970   02  DFHEIV23              USAGE IS POINTER.
  1971   02  DFHEIV24              USAGE IS POINTER.
  1972   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1973   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1974   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1975   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1976   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1977   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1978   02  FILLER                PIC X(02).
  1979   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1980   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1981   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1982   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1983   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1984 LINKAGE  SECTION.
  1985*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  36
* EL677.cbl
  1986*                                                               *
  1987* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1988* All rights reserved.                                          *
  1989*                                                               *
  1990*****************************************************************
  1991 01  dfheiblk.
  1992     02  eibtime          pic s9(7) comp-3.
  1993     02  eibdate          pic s9(7) comp-3.
  1994     02  eibtrnid         pic x(4).
  1995     02  eibtaskn         pic s9(7) comp-3.
  1996     02  eibtrmid         pic x(4).
  1997     02  dfheigdi         pic s9(4) comp.
  1998     02  eibcposn         pic s9(4) comp.
  1999     02  eibcalen         pic s9(4) comp.
  2000     02  eibaid           pic x(1).
  2001     02  eibfiller1       pic x(1).
  2002     02  eibfn            pic x(2).
  2003     02  eibfiller2       pic x(2).
  2004     02  eibrcode         pic x(6).
  2005     02  eibfiller3       pic x(2).
  2006     02  eibds            pic x(8).
  2007     02  eibreqid         pic x(8).
  2008     02  eibrsrce         pic x(8).
  2009     02  eibsync          pic x(1).
  2010     02  eibfree          pic x(1).
  2011     02  eibrecv          pic x(1).
  2012     02  eibsend          pic x(1).
  2013     02  eibatt           pic x(1).
  2014     02  eibeoc           pic x(1).
  2015     02  eibfmh           pic x(1).
  2016     02  eibcompl         pic x(1).
  2017     02  eibsig           pic x(1).
  2018     02  eibconf          pic x(1).
  2019     02  eiberr           pic x(1).
  2020     02  eibrldbk         pic x(1).
  2021     02  eiberrcd         pic x(4).
  2022     02  eibsynrb         pic x(1).
  2023     02  eibnodat         pic x(1).
  2024     02  eibfiller5       pic x(2).
  2025     02  eibresp          pic 9(09) comp.
  2026     02  eibresp2         pic 9(09) comp.
  2027     02  dfheigdj         pic s9(4) comp.
  2028     02  dfheigdk         pic s9(4) comp.
  2029 01  DFHCOMMAREA.
  2030     05  filler                  PIC X(1024).
  2031 01  var  pic x(30).
  2032*                                    COPY ELCCNTL.
  2033******************************************************************
  2034*                                                                *
  2035*                                                                *
  2036*                            ELCCNTL.                            *
  2037*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2038*                            VMOD=2.059                          *
  2039*                                                                *
  2040*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2041*                                                                *
  2042*   FILE TYPE = VSAM,KSDS                                        *
  2043*   RECORD SIZE = 750  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  37
* EL677.cbl
  2044*                                                                *
  2045*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2046*       ALTERNATE INDEX = NONE                                   *
  2047*                                                                *
  2048*   LOG = YES                                                    *
  2049*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2050******************************************************************
  2051*                   C H A N G E   L O G
  2052*
  2053* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2054*-----------------------------------------------------------------
  2055*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2056* EFFECTIVE    NUMBER
  2057*-----------------------------------------------------------------
  2058* 082503                   PEMA  ADD BENEFIT GROUP
  2059* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2060* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2061* 092705    2005050300006  PEMA  ADD SPP LEASES
  2062* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2063* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2064* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2065* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2066* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2067* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2068* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2069* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2070* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2071* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2072******************************************************************
  2073*
  2074 01  CONTROL-FILE.
  2075     12  CF-RECORD-ID                       PIC XX.
  2076         88  VALID-CF-ID                        VALUE 'CF'.
  2077
  2078     12  CF-CONTROL-PRIMARY.
  2079         16  CF-COMPANY-ID                  PIC XXX.
  2080         16  CF-RECORD-TYPE                 PIC X.
  2081             88  CF-COMPANY-MASTER              VALUE '1'.
  2082             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2083             88  CF-STATE-MASTER                VALUE '3'.
  2084             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2085             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2086             88  CF-CARRIER-MASTER              VALUE '6'.
  2087             88  CF-MORTALITY-MASTER            VALUE '7'.
  2088             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2089             88  CF-TERMINAL-MASTER             VALUE '9'.
  2090             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2091             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2092             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2093             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2094             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2095             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2096             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2097             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2098             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2099         16  CF-ACCESS-CD-GENL              PIC X(4).
  2100         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2101             20  CF-PROCESSOR               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  38
* EL677.cbl
  2102         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2103             20  CF-STATE-CODE              PIC XX.
  2104             20  FILLER                     PIC XX.
  2105         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2106             20  FILLER                     PIC XX.
  2107             20  CF-HI-BEN-IN-REC           PIC XX.
  2108         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2109             20  FILLER                     PIC XXX.
  2110             20  CF-CARRIER-CNTL            PIC X.
  2111         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2112             20  FILLER                     PIC XX.
  2113             20  CF-HI-TYPE-IN-REC          PIC 99.
  2114         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2115             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2116                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2117             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2118             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2119         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2120             20  FILLER                     PIC X.
  2121             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2122         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2123             20  FILLER                     PIC XX.
  2124             20  CF-MORTGAGE-PLAN           PIC XX.
  2125         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2126
  2127     12  CF-LAST-MAINT-DT                   PIC XX.
  2128     12  CF-LAST-MAINT-BY                   PIC X(4).
  2129     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2130
  2131     12  CF-RECORD-BODY                     PIC X(728).
  2132
  2133
  2134****************************************************************
  2135*             COMPANY MASTER RECORD                            *
  2136****************************************************************
  2137
  2138     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2139         16  CF-COMPANY-ADDRESS.
  2140             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2141             20  CF-CL-IN-CARE-OF           PIC X(30).
  2142             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2143             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2144             20  CF-CL-CITY-STATE           PIC X(30).
  2145             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2146             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2147         16  CF-COMPANY-CD                  PIC X.
  2148         16  CF-COMPANY-PASSWORD            PIC X(8).
  2149         16  CF-SECURITY-OPTION             PIC X.
  2150             88  ALL-SECURITY                   VALUE '1'.
  2151             88  COMPANY-VERIFY                 VALUE '2'.
  2152             88  PROCESSOR-VERIFY               VALUE '3'.
  2153             88  NO-SECURITY                    VALUE '4'.
  2154             88  ALL-BUT-TERM                   VALUE '5'.
  2155         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2156             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2157         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2158             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2159         16  CF-INFORCE-LOCATION            PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  39
* EL677.cbl
  2160             88  CERTS-ARE-ONLINE               VALUE '1'.
  2161             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2162             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2163         16  CF-LOWER-CASE-LETTERS          PIC X.
  2164         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2165             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2166             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2167             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2168             88  CF-ACCNT-CNTL                  VALUE '3'.
  2169             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2170
  2171         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2172         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2173
  2174         16  CF-LGX-CREDIT-USER             PIC X.
  2175             88  CO-IS-NOT-USER                 VALUE 'N'.
  2176             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2177
  2178         16 CF-CREDIT-CALC-CODES.
  2179             20  CF-CR-REM-TERM-CALC PIC X.
  2180               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2181               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2182               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2183               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2184               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2185               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2186               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2187             20  CF-CR-R78-METHOD           PIC X.
  2188               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2189               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2190
  2191         16  CF-CLAIM-CONTROL-COUNTS.
  2192             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2193                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2194
  2195             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2196                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2197
  2198             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2199                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2200
  2201             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2202                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2203
  2204         16  CF-CURRENT-MONTH-END           PIC XX.
  2205
  2206         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2207             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2208             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2209             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2210             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2211                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2212                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2213             20  CF-CO-PREM-REJECT-SW       PIC X.
  2214                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2215                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2216             20  CF-CO-REF-REJECT-SW        PIC X.
  2217                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  40
* EL677.cbl
  2218                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2219
  2220         16  CF-CO-REPORTING-DT             PIC XX.
  2221         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2222         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2223           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2224           88  CF-CO-MONTH-END                  VALUE '1'.
  2225
  2226         16  CF-LGX-CLAIM-USER              PIC X.
  2227             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2228             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2229
  2230         16  CF-CREDIT-EDIT-CONTROLS.
  2231             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2232             20  CF-MIN-AGE                 PIC 99.
  2233             20  CF-DEFAULT-AGE             PIC 99.
  2234             20  CF-MIN-TERM                PIC S999      COMP-3.
  2235             20  CF-MAX-TERM                PIC S999      COMP-3.
  2236             20  CF-DEFAULT-SEX             PIC X.
  2237             20  CF-JOINT-AGE-INPUT         PIC X.
  2238                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2239             20  CF-BIRTH-DATE-INPUT        PIC X.
  2240                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2241             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2242                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2243                 88  CF-ZERO-CARRIER            VALUE '1'.
  2244                 88  CF-ZERO-GROUPING           VALUE '2'.
  2245                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2246             20  CF-EDIT-SW                 PIC X.
  2247                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2248             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2249             20  CF-CR-PR-METHOD            PIC X.
  2250               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2251               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2252             20  FILLER                     PIC X.
  2253
  2254         16  CF-CREDIT-MISC-CONTROLS.
  2255             20  CF-REIN-TABLE-SW           PIC X.
  2256                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2257             20  CF-COMP-TABLE-SW           PIC X.
  2258                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2259             20  CF-EXPERIENCE-RETENTION-AGE
  2260                                            PIC S9        COMP-3.
  2261             20  CF-CONVERSION-DT           PIC XX.
  2262             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2263             20  CF-RUN-FREQUENCY-SW        PIC X.
  2264                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2265                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2266
  2267             20  CF-CR-CHECK-NO-CONTROL.
  2268                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2269                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2270                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2271                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2272                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2273                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2274
  2275                 24  CF-CR-CHECK-COUNT       REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  41
* EL677.cbl
  2276                     CF-CR-CHECK-COUNTER      PIC X(4).
  2277
  2278                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2279                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2280
  2281                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2282                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2283                 24  CF-MAIL-PROCESSING       PIC X.
  2284                     88  MAIL-PROCESSING          VALUE 'Y'.
  2285
  2286         16  CF-MISC-SYSTEM-CONTROL.
  2287             20  CF-SYSTEM-C                 PIC X.
  2288                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2289             20  CF-SYSTEM-D                 PIC X.
  2290                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2291             20  CF-SOC-SEC-NO-SW            PIC X.
  2292                 88  SOC-SEC-NO-USED             VALUE '1'.
  2293             20  CF-MEMBER-NO-SW             PIC X.
  2294                 88  MEMBER-NO-USED              VALUE '1'.
  2295             20  CF-TAX-ID-NUMBER            PIC X(11).
  2296             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2297             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2298                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2299                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2300                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2301                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2302             20  CF-SYSTEM-E                 PIC X.
  2303                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2304
  2305         16  CF-LGX-LIFE-USER               PIC X.
  2306             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2307             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2308
  2309         16  CF-CR-MONTH-END-DT             PIC XX.
  2310
  2311         16  CF-FILE-MAINT-DATES.
  2312             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2313                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2314             20  CF-LAST-BATCH       REDEFINES
  2315                 CF-LAST-BATCH-NO               PIC X(4).
  2316             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2317             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2318             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2319             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2320             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2321             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2322             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2323             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2324             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2325             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2326
  2327         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2328         16  FILLER                         PIC X.
  2329
  2330         16  CF-ALT-MORT-CODE               PIC X(4).
  2331         16  CF-MEMBER-CAPTION              PIC X(10).
  2332
  2333         16  CF-LIFE-ACCESS-CONTROL         PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  42
* EL677.cbl
  2334             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2335             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2336             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2337             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2338             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2339
  2340         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2341
  2342         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2343         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2344         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2345         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2346
  2347         16  CF-AH-OVERRIDE-L1              PIC X.
  2348         16  CF-AH-OVERRIDE-L2              PIC XX.
  2349         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2350         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2351
  2352         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2353         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2354
  2355         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2356         16  CF-AR-LAST-EL860-DT            PIC XX.
  2357         16  CF-MP-MONTH-END-DT             PIC XX.
  2358
  2359         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2360         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2361             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2362
  2363         16  CF-AR-MONTH-END-DT             PIC XX.
  2364
  2365         16  CF-CRDTCRD-USER                PIC X.
  2366             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2367             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2368
  2369         16  CF-CC-MONTH-END-DT             PIC XX.
  2370
  2371         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2372
  2373         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2374             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2375             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2376             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2377         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2378         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2379         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2380         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2381             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2382             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2383         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2384         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2385         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2386             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2387         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2388
  2389         16  CF-CL-ZIP-CODE.
  2390             20  CF-CL-ZIP-PRIME.
  2391                 24  CF-CL-ZIP-1ST          PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  43
* EL677.cbl
  2392                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2393                 24  FILLER                 PIC X(4).
  2394             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2395         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2396             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2397             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2398             20  FILLER                     PIC XXX.
  2399
  2400         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2401         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2402         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2403         16  CF-CO-OPTION-START-DATE        PIC XX.
  2404         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2405           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2406                                                      '3' '4'.
  2407           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2408           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2409           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2410           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2411           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2412           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2413
  2414         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2415
  2416         16  CF-PAYMENT-APPROVAL-LEVELS.
  2417             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2418             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2419             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2420             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2421             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2422             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2423
  2424         16  CF-END-USER-REPORTING-USER     PIC X.
  2425             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2426             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2427
  2428         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2429             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2430             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2431
  2432         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2433
  2434         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2435         16  FILLER                         PIC X.
  2436
  2437         16  CF-CREDIT-ARCHIVE-CNTL.
  2438             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2439             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2440             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2441
  2442         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2443
  2444         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2445             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2446             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2447
  2448         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2449             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  44
* EL677.cbl
  2450             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2451
  2452         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2453
  2454         16  CF-CO-ACH-ID-CODE              PIC  X.
  2455             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2456             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2457             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2458         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2459         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2460         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2461         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2462         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2463         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2464         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2465         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2466         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2467                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2468         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2469                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2470
  2471         16  CF-CO-OVER-SHORT.
  2472             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2473             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2474
  2475*         16  FILLER                         PIC X(102).
  2476         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2477             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2478             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2479
  2480         16  CF-AH-APPROVAL-DAYS.
  2481             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2482             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2483             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2484             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2485
  2486         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2487
  2488         16  CF-APPROV-LEV-5.
  2489             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2490             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2491             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2492
  2493         16  FILLER                         PIC X(68).
  2494****************************************************************
  2495*             PROCESSOR/USER RECORD                            *
  2496****************************************************************
  2497
  2498     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2499         16  CF-PROCESSOR-NAME              PIC X(30).
  2500         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2501         16  CF-PROCESSOR-TITLE             PIC X(26).
  2502         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2503                 88  MESSAGE-YES                VALUE 'Y'.
  2504                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2505
  2506*****************************************************
  2507****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  45
* EL677.cbl
  2508****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2509****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2510****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2511*****************************************************
  2512
  2513         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2514             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2515             20  CF-APPLICATION-FORCE       PIC X.
  2516             20  CF-INDIVIDUAL-APP.
  2517                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2518                     28  CF-BROWSE-APP      PIC X.
  2519                     28  CF-UPDATE-APP      PIC X.
  2520
  2521         16  CF-CURRENT-TERM-ON             PIC X(4).
  2522         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2523             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2524             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2525             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2526             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2527             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2528             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2529             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2530         16  CF-PROCESSOR-CARRIER           PIC X.
  2531             88  NO-CARRIER-SECURITY            VALUE ' '.
  2532         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2533             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2534         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2535             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2536         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2537             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2538
  2539         16  CF-PROC-SYS-ACCESS-SW.
  2540             20  CF-PROC-CREDIT-CLAIMS-SW.
  2541                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2542                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2543                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2544                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2545             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2546                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2547                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2548             20  CF-PROC-LIFE-GNRLDGR-SW.
  2549                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2550                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2551                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2552                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2553             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2554                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2555                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2556         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2557             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2558             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2559         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2560
  2561         16  CF-APPROVAL-LEVEL                  PIC X.
  2562             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2563             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2564             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2565             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  46
* EL677.cbl
  2566             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2567
  2568         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2569
  2570         16  CF-LANGUAGE-TYPE                   PIC X.
  2571             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2572             88  CF-LANG-IS-FR                      VALUE 'F'.
  2573
  2574         16  CF-CSR-IND                         PIC X.
  2575         16  FILLER                             PIC X(239).
  2576
  2577****************************************************************
  2578*             PROCESSOR/REMINDERS RECORD                       *
  2579****************************************************************
  2580
  2581     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2582         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2583             20  CF-START-REMIND-DT         PIC XX.
  2584             20  CF-END-REMIND-DT           PIC XX.
  2585             20  CF-REMINDER-TEXT           PIC X(50).
  2586         16  FILLER                         PIC X(296).
  2587
  2588
  2589****************************************************************
  2590*             STATE MASTER RECORD                              *
  2591****************************************************************
  2592
  2593     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2594         16  CF-STATE-ABBREVIATION          PIC XX.
  2595         16  CF-STATE-NAME                  PIC X(25).
  2596         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2597         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2598             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2599             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2600             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2601             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2602                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2603                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2604             20  CF-ST-PREM-REJECT-SW       PIC X.
  2605                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2606                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2607             20  CF-ST-REF-REJECT-SW        PIC X.
  2608                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2609                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2610         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2611         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2612         16  CF-ST-REFUND-RULES.
  2613             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2614             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2615             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2616         16  CF-ST-FST-PMT-EXTENSION.
  2617             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2618             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2619                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2620                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2621                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2622                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2623         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  47
* EL677.cbl
  2624             20  CF-ST-CALL-UNEARNED        PIC X.
  2625             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2626             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2627         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2628             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2629             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2630         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2631         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2632         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2633         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2634         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2635         16  FILLER                         PIC X.
  2636         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2637             20  CF-ST-BENEFIT-CD           PIC XX.
  2638             20  CF-ST-BENEFIT-KIND         PIC X.
  2639                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2640                 88  CF-ST-AH-KIND              VALUE 'A'.
  2641             20  CF-ST-REM-TERM-CALC        PIC X.
  2642                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2643                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2644                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2645                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2646                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2647                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2648                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2649                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2650
  2651             20  CF-ST-REFUND-CALC          PIC X.
  2652                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2653                 88  ST-REFD-BY-R78             VALUE '1'.
  2654                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2655                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2656                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2657                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2658                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2659                 88  ST-REFD-UTAH               VALUE '7'.
  2660                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2661                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2662                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2663
  2664             20  CF-ST-EARNING-CALC         PIC X.
  2665                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2666                 88  ST-EARN-BY-R78             VALUE '1'.
  2667                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2668                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2669                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2670                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2671                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2672                 88  ST-EARN-MEAN               VALUE '8'.
  2673                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2674
  2675             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2676                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2677                 88  ST-OVRD-BY-R78             VALUE '1'.
  2678                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2679                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2680                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2681                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  48
* EL677.cbl
  2682                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2683                 88  ST-OVRD-MEAN               VALUE '8'.
  2684                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2685             20  cf-st-extra-periods        pic 9.
  2686*            20  FILLER                     PIC X.
  2687
  2688         16  CF-ST-COMMISSION-CAPS.
  2689             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2690             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2691             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2692             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2693         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2694                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2695
  2696         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2697
  2698         16  CF-ST-STATUTORY-INTEREST.
  2699             20  CF-ST-STAT-DATE-FROM       PIC X.
  2700                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2701                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2702             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2703             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2704             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2705             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2706             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2707
  2708         16  CF-ST-OVER-SHORT.
  2709             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2710             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2711
  2712         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2713
  2714         16  CF-ST-RT-CALC                  PIC X.
  2715
  2716         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2717         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2718         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2719         16  CF-ST-RF-LR-CALC               PIC X.
  2720         16  CF-ST-RF-LL-CALC               PIC X.
  2721         16  CF-ST-RF-LN-CALC               PIC X.
  2722         16  CF-ST-RF-AH-CALC               PIC X.
  2723         16  CF-ST-RF-CP-CALC               PIC X.
  2724*        16  FILLER                         PIC X(206).
  2725*CIDMOD         16  FILLER                         PIC X(192).
  2726         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2727             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2728         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2729         16  CF-ST-VFY-2ND-BENE             PIC X.
  2730         16  CF-ST-CAUSAL-STATE             PIC X.
  2731         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2732         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2733         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2734             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2735         16  CF-ST-NET-ONLY-STATE           PIC X.
  2736             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2737         16  FILLER                         PIC X(181).
  2738
  2739****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  49
* EL677.cbl
  2740*             BENEFIT MASTER RECORD                            *
  2741****************************************************************
  2742
  2743     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2744         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2745             20  CF-BENEFIT-CODE            PIC XX.
  2746             20  CF-BENEFIT-NUMERIC  REDEFINES
  2747                 CF-BENEFIT-CODE            PIC XX.
  2748             20  CF-BENEFIT-ALPHA           PIC XXX.
  2749             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2750             20  CF-BENEFIT-COMMENT         PIC X(10).
  2751
  2752             20  CF-LF-COVERAGE-TYPE        PIC X.
  2753                 88  CF-REDUCING                VALUE 'R'.
  2754                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2755
  2756             20  CF-SPECIAL-CALC-CD         PIC X.
  2757                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2758                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2759                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2760                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2761                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2762                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2763                 88  CF-FARM-PLAN               VALUE 'F'.
  2764                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2765                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2766                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2767                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2768                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2769                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2770                 88  CF-PRUDENTIAL              VALUE 'P'.
  2771                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2772                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2773                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2774                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2775                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2776                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2777
  2778             20  CF-JOINT-INDICATOR         PIC X.
  2779                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2780
  2781*            20  FILLER                     PIC X(12).
  2782             20  cf-maximum-benefits        pic s999 comp-3.
  2783             20  FILLER                     PIC X(09).
  2784             20  CF-BENEFIT-CATEGORY        PIC X.
  2785             20  CF-LOAN-TYPE               PIC X(8).
  2786
  2787             20  CF-CO-REM-TERM-CALC        PIC X.
  2788                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2789                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2790                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2791                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2792                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2793
  2794             20  CF-CO-EARNINGS-CALC        PIC X.
  2795                 88  CO-EARN-BY-R78             VALUE '1'.
  2796                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2797                 88  CO-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  50
* EL677.cbl
  2798                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2799                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2800                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2801                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2802                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2803
  2804             20  CF-CO-REFUND-CALC          PIC X.
  2805                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2806                 88  CO-REFD-BY-R78             VALUE '1'.
  2807                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2808                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2809                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2810                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2811                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2812                 88  CO-REFD-MEAN               VALUE '8'.
  2813                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2814                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2815                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2816
  2817             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2818                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2819                 88  CO-OVRD-BY-R78             VALUE '1'.
  2820                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2821                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2822                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2823                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2824                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2825                 88  CO-OVRD-MEAN               VALUE '8'.
  2826                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2827
  2828             20  CF-CO-BEN-I-G-CD           PIC X.
  2829                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2830                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2831                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2832
  2833         16  FILLER                         PIC X(304).
  2834
  2835
  2836****************************************************************
  2837*             CARRIER MASTER RECORD                            *
  2838****************************************************************
  2839
  2840     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2841         16  CF-ADDRESS-DATA.
  2842             20  CF-MAIL-TO-NAME            PIC X(30).
  2843             20  CF-IN-CARE-OF              PIC X(30).
  2844             20  CF-ADDRESS-LINE-1          PIC X(30).
  2845             20  CF-ADDRESS-LINE-2          PIC X(30).
  2846             20  CF-CITY-STATE              PIC X(30).
  2847             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2848             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2849
  2850         16  CF-CLAIM-NO-CONTROL.
  2851             20  CF-CLAIM-NO-METHOD         PIC X.
  2852                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2853                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2854                 88  CLAIM-NO-SEQ               VALUE '3'.
  2855                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  51
* EL677.cbl
  2856             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2857                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2858                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2859                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2860
  2861         16  CF-CHECK-NO-CONTROL.
  2862             20  CF-CHECK-NO-METHOD         PIC X.
  2863                 88  CHECK-NO-MANUAL            VALUE '1'.
  2864                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2865                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2866                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2867             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2868                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2869
  2870         16  CF-DOMICILE-STATE              PIC XX.
  2871
  2872         16  CF-EXPENSE-CONTROLS.
  2873             20  CF-EXPENSE-METHOD          PIC X.
  2874                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2875                 88  DOLLARS-PER-PMT            VALUE '2'.
  2876                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2877                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2878             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2879             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2880
  2881         16  CF-CORRESPONDENCE-CONTROL.
  2882             20  CF-LETTER-RESEND-OPT       PIC X.
  2883                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2884                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2885             20  FILLER                     PIC X(4).
  2886
  2887         16  CF-RESERVE-CONTROLS.
  2888             20  CF-MANUAL-SW               PIC X.
  2889                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2890             20  CF-FUTURE-SW               PIC X.
  2891                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2892             20  CF-PTC-SW                  PIC X.
  2893                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2894             20  CF-IBNR-SW                 PIC X.
  2895                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2896             20  CF-PTC-LF-SW               PIC X.
  2897                 88  CF-LF-PTC-USED             VALUE '1'.
  2898             20  CF-CDT-ACCESS-METHOD       PIC X.
  2899                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2900                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2901                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2902             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2903
  2904         16  CF-CLAIM-CALC-METHOD           PIC X.
  2905             88  360-PLUS-MONTHS                VALUE '1'.
  2906             88  365-PLUS-MONTHS                VALUE '2'.
  2907             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2908             88  360-DAILY                      VALUE '4'.
  2909             88  365-DAILY                      VALUE '5'.
  2910
  2911         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2912         16  FILLER                         PIC X(11).
  2913
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  52
* EL677.cbl
  2914         16  CF-LIMIT-AMOUNTS.
  2915             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2916             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2917             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2918             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2919             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2920             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2921             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2922             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2923             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2924             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2925
  2926         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2927         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2928         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2929
  2930         16  CF-ZIP-CODE.
  2931             20  CF-ZIP-PRIME.
  2932                 24  CF-ZIP-1ST             PIC X.
  2933                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2934                 24  FILLER                 PIC X(4).
  2935             20  CF-ZIP-PLUS4               PIC X(4).
  2936         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2937             20  CF-CAN-POSTAL-1            PIC XXX.
  2938             20  CF-CAN-POSTAL-2            PIC XXX.
  2939             20  FILLER                     PIC XXX.
  2940
  2941         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2942         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2943         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2944
  2945         16  CF-RATING-SWITCH               PIC X.
  2946             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2947             88  CF-NO-RATING                   VALUE 'N'.
  2948
  2949         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2950
  2951         16  CF-CARRIER-OVER-SHORT.
  2952             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2953             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2954
  2955         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2956         16  CF-SECPAY-SWITCH               PIC X.
  2957             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2958             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2959         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2960         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2961         16  FILLER                         PIC X(444).
  2962*        16  FILLER                         PIC X(452).
  2963
  2964
  2965****************************************************************
  2966*             MORTALITY MASTER RECORD                          *
  2967****************************************************************
  2968
  2969     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2970         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2971                                INDEXED BY CF-MORT-NDX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  53
* EL677.cbl
  2972             20  CF-MORT-TABLE              PIC X(5).
  2973             20  CF-MORT-TABLE-TYPE         PIC X.
  2974                 88  CF-MORT-JOINT              VALUE 'J'.
  2975                 88  CF-MORT-SINGLE             VALUE 'S'.
  2976                 88  CF-MORT-COMBINED           VALUE 'C'.
  2977                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2978                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2979             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2980             20  CF-MORT-AGE-METHOD         PIC XX.
  2981                 88  CF-AGE-LAST                VALUE 'AL'.
  2982                 88  CF-AGE-NEAR                VALUE 'AN'.
  2983             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2984             20  CF-MORT-ADJUSTMENT-DIRECTION
  2985                                            PIC X.
  2986                 88  CF-MINUS                   VALUE '-'.
  2987                 88  CF-PLUS                    VALUE '+'.
  2988             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2989             20  CF-MORT-JOINT-CODE         PIC X.
  2990                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2991             20  CF-MORT-PC-Q               PIC X.
  2992                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2993             20  CF-MORT-TABLE-CODE         PIC X(4).
  2994             20  CF-MORT-COMMENTS           PIC X(15).
  2995             20  FILLER                     PIC X(14).
  2996
  2997         16  FILLER                         PIC X(251).
  2998
  2999
  3000****************************************************************
  3001*             BUSSINESS TYPE MASTER RECORD                     *
  3002****************************************************************
  3003
  3004     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3005* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3006* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3007* AND RECORD 05 IS TYPES 81-99
  3008         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3009             20  CF-BUSINESS-TITLE          PIC  X(19).
  3010             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3011                                            PIC S9V9(4) COMP-3.
  3012             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3013             20  FILLER                     PIC  X.
  3014         16  FILLER                         PIC  X(248).
  3015
  3016
  3017****************************************************************
  3018*             TERMINAL MASTER RECORD                           *
  3019****************************************************************
  3020
  3021     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3022
  3023         16  CF-COMPANY-TERMINALS.
  3024             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3025                                  PIC X(4).
  3026         16  FILLER               PIC X(248).
  3027
  3028
  3029****************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  54
* EL677.cbl
  3030*             LIFE EDIT MASTER RECORD                          *
  3031****************************************************************
  3032
  3033     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3034         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3035             20  CF-LIFE-CODE-IN            PIC XX.
  3036             20  CF-LIFE-CODE-OUT           PIC XX.
  3037         16  FILLER                         PIC X(248).
  3038
  3039
  3040****************************************************************
  3041*             AH EDIT MASTER RECORD                            *
  3042****************************************************************
  3043
  3044     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3045         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3046             20  CF-AH-CODE-IN              PIC XXX.
  3047             20  CF-AH-CODE-OUT             PIC XX.
  3048         16  FILLER                         PIC X(248).
  3049
  3050
  3051****************************************************************
  3052*             CREDIBILITY TABLES                               *
  3053****************************************************************
  3054
  3055     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3056         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3057                             INDEXED BY CF-CRDB-NDX.
  3058             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3059             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3060             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3061         16  FILLER                         PIC  X(332).
  3062
  3063
  3064****************************************************************
  3065*             REPORT CUSTOMIZATION RECORD                      *
  3066****************************************************************
  3067
  3068     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3069         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3070             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3071             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3072             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3073**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3074****       A T-TRANSFER.                                   ****
  3075             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3076
  3077         16  FILLER                         PIC XX.
  3078
  3079         16  CF-CARRIER-CNTL-OPT.
  3080             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3081                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3082                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3083             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3084                                            PIC X.
  3085         16  CF-GROUP-CNTL-OPT.
  3086             20  CF-GROUP-OPT-SEQ           PIC 9.
  3087                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  55
* EL677.cbl
  3088                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3089             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3090                                            PIC X(6).
  3091         16  CF-STATE-CNTL-OPT.
  3092             20  CF-STATE-OPT-SEQ           PIC 9.
  3093                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3094                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3095             20  CF-STATE-SELECT OCCURS 3 TIMES
  3096                                            PIC XX.
  3097         16  CF-ACCOUNT-CNTL-OPT.
  3098             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3099                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3100                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3101             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3102                                            PIC X(10).
  3103         16  CF-BUS-TYP-CNTL-OPT.
  3104             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3105                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3106                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3107             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3108                                            PIC XX.
  3109         16  CF-LF-TYP-CNTL-OPT.
  3110             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3111                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3112                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3113             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3114                                            PIC XX.
  3115         16  CF-AH-TYP-CNTL-OPT.
  3116             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3117                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3118                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3119             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3120                                            PIC XX.
  3121         16  CF-REPTCD1-CNTL-OPT.
  3122             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3123                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3124                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3125             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3126                                            PIC X(10).
  3127         16  CF-REPTCD2-CNTL-OPT.
  3128             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3129                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3130                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3131             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3132                                            PIC X(10).
  3133         16  CF-USER1-CNTL-OPT.
  3134             20  CF-USER1-OPT-SEQ           PIC 9.
  3135                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3136                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3137             20  CF-USER1-SELECT OCCURS 3 TIMES
  3138                                            PIC X(10).
  3139         16  CF-USER2-CNTL-OPT.
  3140             20  CF-USER2-OPT-SEQ           PIC 9.
  3141                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3142                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3143             20  CF-USER2-SELECT OCCURS 3 TIMES
  3144                                            PIC X(10).
  3145         16  CF-USER3-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  56
* EL677.cbl
  3146             20  CF-USER3-OPT-SEQ           PIC 9.
  3147                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3148                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3149             20  CF-USER3-SELECT OCCURS 3 TIMES
  3150                                            PIC X(10).
  3151         16  CF-USER4-CNTL-OPT.
  3152             20  CF-USER4-OPT-SEQ           PIC 9.
  3153                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3154                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3155             20  CF-USER4-SELECT OCCURS 3 TIMES
  3156                                            PIC X(10).
  3157         16  CF-USER5-CNTL-OPT.
  3158             20  CF-USER5-OPT-SEQ           PIC 9.
  3159                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3160                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3161             20  CF-USER5-SELECT OCCURS 3 TIMES
  3162                                            PIC X(10).
  3163         16  CF-REINS-CNTL-OPT.
  3164             20  CF-REINS-OPT-SEQ           PIC 9.
  3165                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3166                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3167             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3168                 24  CF-REINS-PRIME         PIC XXX.
  3169                 24  CF-REINS-SUB           PIC XXX.
  3170
  3171         16  CF-AGENT-CNTL-OPT.
  3172             20  CF-AGENT-OPT-SEQ           PIC 9.
  3173                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3174                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3175             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3176                                            PIC X(10).
  3177
  3178         16  FILLER                         PIC X(43).
  3179
  3180         16  CF-LOSS-RATIO-SELECT.
  3181             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3182             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3183         16  CF-ENTRY-DATE-SELECT.
  3184             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3185             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3186         16  CF-EFFECTIVE-DATE-SELECT.
  3187             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3188             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3189
  3190         16  CF-EXCEPTION-LIST-IND          PIC X.
  3191             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3192
  3193         16  FILLER                         PIC X(318).
  3194
  3195****************************************************************
  3196*                  EXCEPTION REPORTING RECORD                  *
  3197****************************************************************
  3198
  3199     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3200         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3201             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3202
  3203         16  CF-COMBINED-LIFE-AH-OPT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  57
* EL677.cbl
  3204             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3205             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3206             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3207             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3208
  3209         16  CF-LIFE-OPT.
  3210             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3211             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3212             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3213             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3214             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3215             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3216             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3217             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3218             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3219             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3220
  3221         16  CF-AH-OPT.
  3222             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3223             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3224             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3225             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3226             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3227             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3228             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3229             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3230             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3231             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3232
  3233         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3234             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3235             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3236             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3237
  3238         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3239
  3240         16  FILLER                         PIC X(673).
  3241
  3242
  3243****************************************************************
  3244*             MORTGAGE SYSTEM PLAN RECORD                      *
  3245****************************************************************
  3246
  3247     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3248         16  CF-PLAN-TYPE                   PIC X.
  3249             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3250             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3251             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3252         16  CF-PLAN-ABBREV                 PIC XXX.
  3253         16  CF-PLAN-DESCRIPT               PIC X(10).
  3254         16  CF-PLAN-NOTES                  PIC X(20).
  3255         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3256         16  CF-PLAN-UNDERWRITING.
  3257             20  CF-PLAN-TERM-DATA.
  3258                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3259                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3260             20  CF-PLAN-AGE-DATA.
  3261                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  58
* EL677.cbl
  3262                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3263                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3264             20  CF-PLAN-BENEFIT-DATA.
  3265                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3266                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3267                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3268                                            PIC S9(7)V99  COMP-3.
  3269         16  CF-PLAN-POLICY-FORMS.
  3270             20  CF-POLICY-FORM             PIC X(12).
  3271             20  CF-MASTER-APPLICATION      PIC X(12).
  3272             20  CF-MASTER-POLICY           PIC X(12).
  3273         16  CF-PLAN-RATING.
  3274             20  CF-RATE-CODE               PIC X(5).
  3275             20  CF-SEX-RATING              PIC X.
  3276                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3277                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3278             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3279             20  CF-SUB-STD-TYPE            PIC X.
  3280                 88  CF-PCT-OF-PREM            VALUE '1'.
  3281                 88  CF-PCT-OF-BENE            VALUE '2'.
  3282         16  CF-PLAN-PREM-TOLERANCES.
  3283             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3284             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3285         16  CF-PLAN-PYMT-TOLERANCES.
  3286             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3287             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3288         16  CF-PLAN-MISC-DATA.
  3289             20  FILLER                     PIC X.
  3290             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3291             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3292         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3293         16  CF-PLAN-IND-GRP                PIC X.
  3294             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3295                                                     '1'.
  3296             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3297                                                     '2'.
  3298         16  CF-MIB-SEARCH-SW               PIC X.
  3299             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3300             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3301             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3302             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3303         16  CF-ALPHA-SEARCH-SW             PIC X.
  3304             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3305             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3306             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3307             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3308             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3309             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3310             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3311             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3312             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3313             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3314                                                     'A' 'B' 'C'
  3315                                                     'X' 'Y' 'Z'.
  3316         16  CF-EFF-DT-RULE-SW              PIC X.
  3317             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3318             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3319             88  CF-EFF-DT-QTR                 VALUE 'Q'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  59
* EL677.cbl
  3320             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3321             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3322         16  FILLER                         PIC X(4).
  3323         16  CF-HEALTH-QUESTIONS            PIC X.
  3324             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3325         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3326         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3327         16  CF-PLAN-SNGL-JNT               PIC X.
  3328             88  CF-COMBINED-PLAN              VALUE 'C'.
  3329             88  CF-JNT-PLAN                   VALUE 'J'.
  3330             88  CF-SNGL-PLAN                  VALUE 'S'.
  3331         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3332         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3333         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3334         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3335         16  CF-RERATE-CNTL                 PIC  X.
  3336             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3337             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3338             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3339             88  CF-AUTO-RECALC                 VALUE '4'.
  3340         16  CF-BENEFIT-TYPE                PIC  X.
  3341             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3342             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3343         16  CF-POLICY-FEE                  PIC S999V99
  3344                                                    COMP-3.
  3345         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3346         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3347         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3348         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3349         16  FILLER                         PIC  X(32).
  3350         16  CF-TERMINATION-FORM            PIC  X(04).
  3351         16  FILLER                         PIC  X(08).
  3352         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3353                                                       COMP-3.
  3354         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3355         16  CF-ISSUE-LETTER                PIC  X(4).
  3356         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3357         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3358             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3359             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3360         16  CF-MP-REFUND-CALC              PIC X.
  3361             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3362             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3363             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3364             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3365             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3366             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3367             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3368             88  CF-MP-REFD-MEAN                VALUE '8'.
  3369         16  CF-ALT-RATE-CODE               PIC  X(5).
  3370
  3371
  3372         16  FILLER                         PIC X(498).
  3373****************************************************************
  3374*             MORTGAGE COMPANY MASTER RECORD                   *
  3375****************************************************************
  3376
  3377     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  60
* EL677.cbl
  3378         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3379         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3380             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3381             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3382             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3383             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3384             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3385
  3386         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3387         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3388         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3389         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3390         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3391
  3392         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3393             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3394         16  CF-MP-RECON-USE-IND            PIC X(1).
  3395             88  CF-MP-USE-RECON             VALUE 'Y'.
  3396         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3397             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3398         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3399             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3400             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3401         16  FILLER                         PIC X(1).
  3402         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3403             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3404         16  CF-MORTG-MIB-VERSION           PIC X.
  3405             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3406             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3407             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3408         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3409             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3410                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3411             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3412                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3413             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3414                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3415             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3416                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3417             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3418                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3419             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3420                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3421         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3422         16  FILLER                         PIC X(7).
  3423         16  CF-MORTG-DESTINATION-SYMBOL.
  3424             20  CF-MORTG-MIB-COMM          PIC X(5).
  3425             20  CF-MORTG-MIB-TERM          PIC X(5).
  3426         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3427             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3428         16  FILLER                         PIC X(03).
  3429         16  CF-MP-CHECK-NO-CONTROL.
  3430             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3431                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3432                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3433                                                ' ' LOW-VALUES.
  3434                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3435                                               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  61
* EL677.cbl
  3436         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3437         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3438         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3439             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3440                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3441             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3442                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3443             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3444                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3445             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3446                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3447             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3448                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3449             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3450                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3451         16  CF-MORTG-BILLING-AREA.
  3452             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3453                                            PIC X.
  3454         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3455         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3456         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3457         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3458             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3459             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3460         16  FILLER                         PIC X.
  3461         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3462             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3463             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3464         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3465         16  FILLER                         PIC X(8).
  3466         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3467         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3468         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3469         16  CF-ACH-COMPANY-ID.
  3470             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3471                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3472                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3473                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3474             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3475         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3476             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3477         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3478             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3479             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3480         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3481         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3482         16  FILLER                         PIC X(536).
  3483
  3484****************************************************************
  3485*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3486****************************************************************
  3487
  3488     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3489         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3490             20  CF-FEMALE-HEIGHT.
  3491                 24  CF-FEMALE-FT           PIC 99.
  3492                 24  CF-FEMALE-IN           PIC 99.
  3493             20  CF-FEMALE-MIN-WT           PIC 999.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  62
* EL677.cbl
  3494             20  CF-FEMALE-MAX-WT           PIC 999.
  3495         16  FILLER                         PIC X(428).
  3496
  3497     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3498         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3499             20  CF-MALE-HEIGHT.
  3500                 24  CF-MALE-FT             PIC 99.
  3501                 24  CF-MALE-IN             PIC 99.
  3502             20  CF-MALE-MIN-WT             PIC 999.
  3503             20  CF-MALE-MAX-WT             PIC 999.
  3504         16  FILLER                         PIC X(428).
  3505******************************************************************
  3506*             AUTOMATIC ACTIVITY RECORD                          *
  3507******************************************************************
  3508     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3509         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3510             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3511             20  CF-SYS-LETTER-ID           PIC X(04).
  3512             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3513             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3514             20  CF-SYS-RESET-SW            PIC X(01).
  3515             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3516             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3517
  3518         16  FILLER                         PIC X(50).
  3519
  3520         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3521             20  CF-USER-ACTIVE-SW          PIC X(01).
  3522             20  CF-USER-LETTER-ID          PIC X(04).
  3523             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3524             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3525             20  CF-USER-RESET-SW           PIC X(01).
  3526             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3527             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3528             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3529
  3530         16  FILLER                         PIC X(246).
  3531*                                    COPY ERCCHEK.
  3532******************************************************************
  3533*                                                                *
  3534*                                                                *
  3535*                            ERCCHEK                             *
  3536*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3537*                            VMOD=2.008                          *
  3538*                                                                *
  3539*   FILE DESCRIPTION = CHECK RECORDS                             *
  3540*                                                                *
  3541*   FILE TYPE = VSAM,KSDS                                        *
  3542*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3543*                                                                *
  3544*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3545*       ALTERNATE INDEX = NONE                                   *
  3546*                                                                *
  3547*   LOG = YES                                                    *
  3548*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3549******************************************************************
  3550*                   C H A N G E   L O G
  3551*
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  63
* EL677.cbl
  3552* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3553*-----------------------------------------------------------------
  3554*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3555* EFFECTIVE    NUMBER
  3556*-----------------------------------------------------------------
  3557* 021414    2003053000001  PEMA  changes for auto chk request
  3558******************************************************************
  3559 01  CHECK-RECORDS.
  3560     12  CH-RECORD-ID                      PIC XX.
  3561         88  VALID-CH-ID                      VALUE 'CH'.
  3562
  3563     12  CH-CONTROL-PRIMARY.
  3564         16  CH-COMPANY-CD                 PIC X.
  3565         16  CH-CARRIER                    PIC X.
  3566         16  CH-GROUPING                   PIC X(6).
  3567         16  CH-STATE                      PIC XX.
  3568         16  CH-ACCOUNT                    PIC X(10).
  3569         16  CH-CERT-EFF-DT                PIC XX.
  3570         16  CH-CERT-NO.
  3571             20  CH-CERT-PRIME             PIC X(10).
  3572             20  CH-CERT-SFX               PIC X.
  3573         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3574
  3575     12  CH-RECORDED-DT                    PIC XX.
  3576     12  CH-RECORDED-BY                    PIC X(4).
  3577     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3578
  3579     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3580     12  CH-CHECK-NO                       PIC X(7).
  3581     12  CH-REASON-FOR-CHECK               PIC X(25).
  3582     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3583     12  FILLER                            PIC X.
  3584
  3585     12  CH-PAYEE-INFO.
  3586         16  CH-PAYEE-NAME-1               PIC X(30).
  3587         16  CH-PAYEE-NAME-2               PIC X(30).
  3588         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3589         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3590         16  CH-PAYEE-CITY-ST.
  3591             20  CH-PAYEE-CITY             PIC X(28).
  3592             20  CH-PAYEE-STATE            PIC XX.
  3593         16  CH-PAYEE-ZIP-CODE.
  3594             20  CH-PAYEE-ZIP.
  3595                 24  CH-ZIP-PRI-1ST        PIC X.
  3596                     88  CH-CANADIAN-POST-CODE
  3597                                           VALUES 'A' THRU 'Z'.
  3598                 24  FILLER                PIC X(4).
  3599             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3600         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3601             20  CH-CAN-POSTAL-1           PIC XXX.
  3602             20  CH-CAN-POSTAL-2           PIC XXX.
  3603             20  FILLER                    PIC XXX.
  3604
  3605     12  CH-CHECK-STUB-TEXT.
  3606         16  CH-STUB-LINE-1                PIC X(30).
  3607         16  CH-TEXT-LINE-1                PIC X(50).
  3608         16  CH-TEXT-LINE-2                PIC X(50).
  3609         16  CH-TEXT-LINE-3                PIC X(40).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  64
* EL677.cbl
  3610     12  CH-RETURN-TO                      PIC X(30).
  3611
  3612     12  CH-COMPENSATION-CONTROL.
  3613         16  CH-COMP-CARRIER               PIC X.
  3614         16  CH-COMP-GROUPING              PIC X(6).
  3615         16  CH-COMP-FIN-RESP              PIC X(10).
  3616         16  CH-COMP-ACCOUNT               PIC X(10).
  3617
  3618     12  CH-CREDIT-SELECT-DT               PIC XX.
  3619     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3620     12  CH-PAYEE-CODE                     PIC X(6).
  3621
  3622     12  CH-VOID-DATA.
  3623         20  CH-VOID-DT                    PIC XX.
  3624         20  CH-VOID-BY                    PIC X(4).
  3625         20  CH-VOID-REASON                PIC X(25).
  3626
  3627     12  CH-APPROVAL-DATA.
  3628         20  CH-APPROVAL-DT                PIC XX.
  3629         20  CH-APPROVAL-STATUS            PIC X.
  3630             88  CH-IN-LIMBO                  VALUE ' '.
  3631             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  3632             88  CH-APPROVED                  VALUE 'A'.
  3633             88  CH-DENIED                    VALUE 'D'.
  3634         20  CH-APPROVED-BY                PIC XXXX.
  3635     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3636             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3637     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3638
  3639     12  ch-released-dt                    pic xx.
  3640     12  ch-check-cashed-dt                pic xx.
  3641     12  FILLER                            PIC X.
  3642*    12  CH-CHECK-REFERENCE                PIC X(12).
  3643     12  CH-CHECK-ORIGIN-SW                PIC X.
  3644             88  CH-REFUND-CHECK              VALUE 'R'.
  3645             88  CH-MAINT-CHECK               VALUE 'M'.
  3646
  3647     12  CH-CANC-DT                        PIC XX.
  3648     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3649     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3650
  3651     12  CH-INSURED-NAME                   PIC X(28).
  3652
  3653     12  ch-released-by                    pic x(4).
  3654     12  ch-csr                            pic x(4).
  3655     12  ch-deduct-commission              pic x.
  3656         88  ch-deduct-comm                  value 'Y'.
  3657         88  ch-do-not-deduct-comm           value 'N'.
  3658
  3659     12  FILLER                            PIC X(11).
  3660*    12  CH-LETTER-TABLE.
  3661*        16  CH-LETTERS OCCURS 3 TIMES
  3662*                       INDEXED BY CH-LT-NDX
  3663*                                          PIC X(04).
  3664
  3665     12  FILLER                            PIC X(07).
  3666
  3667*                                    COPY ERCACCT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  65
* EL677.cbl
  3668******************************************************************
  3669*                                                                *
  3670*                                                                *
  3671*                            ERCACCT                             *
  3672*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3673*                            VMOD=2.031                          *
  3674*                                                                *
  3675*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3676*                                                                *
  3677*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3678*   VSAM ACCOUNT MASTER FILES.                                   *
  3679*                                                                *
  3680*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3681*                                                                *
  3682*   FILE TYPE = VSAM,KSDS                                        *
  3683*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3684*                                                                *
  3685*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3686*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3687*                                                                *
  3688*   LOG = NO                                                     *
  3689*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3690*                                                                *
  3691*                                                                *
  3692******************************************************************
  3693*                   C H A N G E   L O G
  3694*
  3695* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3696*-----------------------------------------------------------------
  3697*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3698* EFFECTIVE    NUMBER
  3699*-----------------------------------------------------------------
  3700* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3701* 092705    2005050300006  PEMA  ADD SPP LEASES
  3702* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3703* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3704* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3705* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3706* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3707******************************************************************
  3708
  3709 01  ACCOUNT-MASTER.
  3710     12  AM-RECORD-ID                      PIC XX.
  3711         88  VALID-AM-ID                      VALUE 'AM'.
  3712
  3713     12  AM-CONTROL-PRIMARY.
  3714         16  AM-COMPANY-CD                 PIC X.
  3715         16  AM-MSTR-CNTRL.
  3716             20  AM-CONTROL-A.
  3717                 24  AM-CARRIER            PIC X.
  3718                 24  AM-GROUPING.
  3719                     28 AM-GROUPING-PREFIX PIC XXX.
  3720                     28 AM-GROUPING-PRIME  PIC XXX.
  3721                 24  AM-STATE              PIC XX.
  3722                 24  AM-ACCOUNT.
  3723                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3724                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3725             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  66
* EL677.cbl
  3726                                           PIC X(19).
  3727             20  AM-CNTRL-B.
  3728                 24  AM-EXPIRATION-DT      PIC XX.
  3729                 24  FILLER                PIC X(4).
  3730             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3731                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3732
  3733     12  AM-CONTROL-BY-VAR-GRP.
  3734         16  AM-COMPANY-CD-A1              PIC X.
  3735         16  AM-VG-CARRIER                 PIC X.
  3736         16  AM-VG-GROUPING                PIC X(6).
  3737         16  AM-VG-STATE                   PIC XX.
  3738         16  AM-VG-ACCOUNT                 PIC X(10).
  3739         16  AM-VG-DATE.
  3740             20  AM-VG-EXPIRATION-DT       PIC XX.
  3741             20  FILLER                    PIC X(4).
  3742         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3743                                           PIC 9(11)      COMP-3.
  3744     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3745         16  FILLER                        PIC X(10).
  3746         16  AM-VG-KEY3.
  3747             20  AM-VG3-ACCOUNT            PIC X(10).
  3748             20  AM-VG3-EXP-DT             PIC XX.
  3749         16  FILLER                        PIC X(4).
  3750     12  AM-MAINT-INFORMATION.
  3751         16  AM-LAST-MAINT-DT              PIC XX.
  3752         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3753         16  AM-LAST-MAINT-USER            PIC X(4).
  3754         16  FILLER                        PIC XX.
  3755
  3756     12  AM-EFFECTIVE-DT                   PIC XX.
  3757     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3758
  3759     12  AM-PREV-DATES  COMP-3.
  3760         16  AM-PREV-EXP-DT                PIC 9(11).
  3761         16  AM-PREV-EFF-DT                PIC 9(11).
  3762
  3763     12  AM-REPORT-CODE-1                  PIC X(10).
  3764     12  AM-REPORT-CODE-2                  PIC X(10).
  3765
  3766     12  AM-CITY-CODE                      PIC X(4).
  3767     12  AM-COUNTY-PARISH                  PIC X(6).
  3768
  3769     12  AM-NAME                           PIC X(30).
  3770     12  AM-PERSON                         PIC X(30).
  3771     12  AM-ADDRS                          PIC X(30).
  3772     12  AM-CITY.
  3773         16  AM-ADDR-CITY                  PIC X(28).
  3774         16  AM-ADDR-STATE                 PIC XX.
  3775     12  AM-ZIP.
  3776         16  AM-ZIP-PRIME.
  3777             20  AM-ZIP-PRI-1ST            PIC X.
  3778                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3779             20  FILLER                    PIC X(4).
  3780         16  AM-ZIP-PLUS4                  PIC X(4).
  3781     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3782         16  AM-CAN-POSTAL-1               PIC XXX.
  3783         16  AM-CAN-POSTAL-2               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  67
* EL677.cbl
  3784         16  FILLER                        PIC XXX.
  3785     12  AM-TEL-NO.
  3786         16  AM-AREA-CODE                  PIC 999.
  3787         16  AM-TEL-PRE                    PIC 999.
  3788         16  AM-TEL-NBR                    PIC 9(4).
  3789     12  AM-TEL-LOC                        PIC X.
  3790         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3791         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3792
  3793     12  AM-COMM-STRUCTURE.
  3794         16  AM-DEFN-1.
  3795             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3796                 24  AM-AGT.
  3797                     28  AM-AGT-PREFIX     PIC X(4).
  3798                     28  AM-AGT-PRIME      PIC X(6).
  3799                 24  AM-COM-TYP            PIC X.
  3800                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3801                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3802                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3803                 24  AM-RECALC-LV-INDIC    PIC X.
  3804                 24  AM-RETRO-LV-INDIC     PIC X.
  3805                 24  AM-GL-CODES           PIC X.
  3806                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3807                 24  FILLER                PIC X(01).
  3808         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3809             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3810                 24  FILLER                PIC X(11).
  3811                 24  AM-L-COMA             PIC XXX.
  3812                 24  AM-J-COMA             PIC XXX.
  3813                 24  AM-A-COMA             PIC XXX.
  3814                 24  FILLER                PIC X(6).
  3815
  3816     12  AM-COMM-CHANGE-STATUS             PIC X.
  3817         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3818
  3819     12  AM-CSR-CODE                       PIC X(4).
  3820
  3821     12  AM-BILLING-STATUS                 PIC X.
  3822         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3823         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3824     12  AM-AUTO-REFUND-SW                 PIC X.
  3825         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3826         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3827     12  AM-GPCD                           PIC 99.
  3828     12  AM-IG                             PIC X.
  3829         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3830         88  AM-HAS-GROUP                     VALUE '2'.
  3831     12  AM-STATUS                         PIC X.
  3832         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3833         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3834         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3835         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3836         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3837         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3838     12  AM-REMIT-TO                       PIC 99.
  3839     12  AM-ID-NO                          PIC X(11).
  3840
  3841     12  AM-CAL-TABLE                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  68
* EL677.cbl
  3842     12  AM-LF-DEVIATION                   PIC XXX.
  3843     12  AM-AH-DEVIATION                   PIC XXX.
  3844     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3845     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3846     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3847     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3848     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3849     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3850
  3851     12  AM-USER-FIELDS.
  3852         16  AM-FLD-1                      PIC XX.
  3853         16  AM-FLD-2                      PIC XX.
  3854         16  AM-FLD-3                      PIC XX.
  3855         16  AM-FLD-4                      PIC XX.
  3856         16  AM-FLD-5                      PIC XX.
  3857
  3858     12  AM-1ST-PROD-DATE.
  3859         16  AM-1ST-PROD-YR                PIC XX.
  3860         16  AM-1ST-PROD-MO                PIC XX.
  3861         16  AM-1ST-PROD-DA                PIC XX.
  3862     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3863     12  AM-CERTS-PURGED-DATE.
  3864         16  AM-PUR-YR                     PIC XX.
  3865         16  AM-PUR-MO                     PIC XX.
  3866         16  AM-PUR-DA                     PIC XX.
  3867     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3868     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3869     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3870     12  AM-INACTIVE-DATE.
  3871         16  AM-INA-MO                     PIC 99.
  3872         16  AM-INA-DA                     PIC 99.
  3873         16  AM-INA-YR                     PIC 99.
  3874     12  AM-AR-HI-CERT-DATE                PIC XX.
  3875
  3876     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3877     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3878
  3879     12  AM-OB-PAYMENT-MODE                PIC X.
  3880         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3881         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3882         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3883         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3884
  3885     12  AM-AH-ONLY-INDICATOR              PIC X.
  3886         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3887         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3888
  3889     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3890
  3891     12  AM-OVER-SHORT.
  3892         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3893         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3894
  3895     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3896     12  AM-DCC-CLP-STATE                  PIC XX.
  3897
  3898     12  AM-RECALC-COMM                    PIC X.
  3899     12  AM-RECALC-REIN                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  69
* EL677.cbl
  3900
  3901     12  AM-REI-TABLE                      PIC XXX.
  3902     12  AM-REI-ET-LF                      PIC X.
  3903     12  AM-REI-ET-AH                      PIC X.
  3904     12  AM-REI-PE-LF                      PIC X.
  3905     12  AM-REI-PE-AH                      PIC X.
  3906     12  AM-REI-PRT-ST                     PIC X.
  3907     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3908     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3909     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3910     12  AM-REI-GROUP-A                    PIC X(6).
  3911     12  AM-REI-MORT                       PIC X(4).
  3912     12  AM-REI-PRT-OW                     PIC X.
  3913     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3914     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3915     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3916     12  AM-REI-GROUP-B                    PIC X(6).
  3917
  3918     12  AM-TRUST-TYPE                     PIC X(2).
  3919
  3920     12  AM-EMPLOYER-STMT-USED             PIC X.
  3921     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3922
  3923     12  AM-STD-AH-TYPE                    PIC XX.
  3924     12  AM-EARN-METHODS.
  3925         16  AM-EARN-METHOD-R              PIC X.
  3926             88 AM-REF-RL-R78                 VALUE 'R'.
  3927             88 AM-REF-RL-PR                  VALUE 'P'.
  3928             88 AM-REF-RL-MEAN                VALUE 'M'.
  3929             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3930         16  AM-EARN-METHOD-L              PIC X.
  3931             88 AM-REF-LL-R78                 VALUE 'R'.
  3932             88 AM-REF-LL-PR                  VALUE 'P'.
  3933             88 AM-REF-LL-MEAN                VALUE 'M'.
  3934             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3935         16  AM-EARN-METHOD-A              PIC X.
  3936             88 AM-REF-AH-R78                 VALUE 'R'.
  3937             88 AM-REF-AH-PR                  VALUE 'P'.
  3938             88 AM-REF-AH-MEAN                VALUE 'M'.
  3939             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3940             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3941             88 AM-REF-AH-NET                 VALUE 'N'.
  3942
  3943     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3944     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3945     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3946
  3947     12  AM-RET-Y-N                        PIC X.
  3948     12  AM-RET-P-E                        PIC X.
  3949     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3950     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3951     12  AM-RET-GRP                        PIC X(6).
  3952     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3953         16  AM-POOL-PRIME                 PIC XXX.
  3954         16  AM-POOL-SUB                   PIC XXX.
  3955     12  AM-RETRO-EARNINGS.
  3956         16  AM-RET-EARN-R                 PIC X.
  3957         16  AM-RET-EARN-L                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  70
* EL677.cbl
  3958         16  AM-RET-EARN-A                 PIC X.
  3959     12  AM-RET-ST-TAX-USE                 PIC X.
  3960         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3961         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3962     12  AM-RETRO-BEG-EARNINGS.
  3963         16  AM-RET-BEG-EARN-R             PIC X.
  3964         16  AM-RET-BEG-EARN-L             PIC X.
  3965         16  AM-RET-BEG-EARN-A             PIC X.
  3966     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3967     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3968
  3969     12  AM-USER-SELECT-OPTIONS.
  3970         16  AM-USER-SELECT-1              PIC X(10).
  3971         16  AM-USER-SELECT-2              PIC X(10).
  3972         16  AM-USER-SELECT-3              PIC X(10).
  3973         16  AM-USER-SELECT-4              PIC X(10).
  3974         16  AM-USER-SELECT-5              PIC X(10).
  3975
  3976     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3977
  3978     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3979
  3980     12  AM-RPT045A-SWITCH                 PIC X.
  3981         88  RPT045A-OFF                   VALUE 'N'.
  3982
  3983     12  AM-INSURANCE-LIMITS.
  3984         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  3985         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  3986
  3987     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  3988         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  3989
  3990     12  AM-DISMBR-COVERAGE-SW             PIC X.
  3991         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  3992         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  3993
  3994     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  3995
  3996     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  3997     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  3998     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  3999     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4000     12  AM-DCC-UEF-STATE                  PIC XX.
  4001     12  FILLER                            PIC XXX.
  4002     12  AM-REPORT-CODE-3                  PIC X(10).
  4003*    12  FILLER                            PIC X(22).
  4004
  4005     12  AM-RESERVE-DATE.
  4006         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4007         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4008         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4009
  4010     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4011     12  AM-NOTIFICATION-TYPES.
  4012         16  AM-NOTIF-OF-LETTERS           PIC X.
  4013         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4014         16  AM-NOTIF-OF-REPORTS           PIC X.
  4015         16  AM-NOTIF-OF-STATUS            PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  71
* EL677.cbl
  4016
  4017     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4018         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4019         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4020         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4021         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4022
  4023     12  AM-BENEFIT-CONTROLS.
  4024         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4025             20  AM-BENEFIT-CODE           PIC XX.
  4026             20  AM-BENEFIT-TYPE           PIC X.
  4027             20  AM-BENEFIT-REVISION       PIC XXX.
  4028             20  AM-BENEFIT-REM-TERM       PIC X.
  4029             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4030             20  FILLER                    PIC XX.
  4031         16  FILLER                        PIC X(80).
  4032
  4033     12  AM-TRANSFER-DATA.
  4034         16  AM-TRANSFERRED-FROM.
  4035             20  AM-TRNFROM-CARRIER        PIC X.
  4036             20  AM-TRNFROM-GROUPING.
  4037                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4038                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4039             20  AM-TRNFROM-STATE          PIC XX.
  4040             20  AM-TRNFROM-ACCOUNT.
  4041                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4042                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4043             20  AM-TRNFROM-DTE            PIC XX.
  4044         16  AM-TRANSFERRED-TO.
  4045             20  AM-TRNTO-CARRIER          PIC X.
  4046             20  AM-TRNTO-GROUPING.
  4047                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4048                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4049             20  AM-TRNTO-STATE            PIC XX.
  4050             20  AM-TRNTO-ACCOUNT.
  4051                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4052                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4053             20  AM-TRNTO-DTE              PIC XX.
  4054         16  FILLER                        PIC X(10).
  4055
  4056     12  AM-SAVED-REMIT-TO                 PIC 99.
  4057
  4058     12  AM-COMM-STRUCTURE-SAVED.
  4059         16  AM-DEFN-1-SAVED.
  4060             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4061                 24  AM-AGT-SV             PIC X(10).
  4062                 24  AM-COM-TYP-SV         PIC X.
  4063                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4064                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4065                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4066                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4067                 24  FILLER                PIC X.
  4068                 24  AM-GL-CODES-SV        PIC X.
  4069                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4070                 24  FILLER                PIC X.
  4071         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4072             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4073                 24  FILLER                PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  72
* EL677.cbl
  4074                 24  AM-L-COMA-SV          PIC XXX.
  4075                 24  AM-J-COMA-SV          PIC XXX.
  4076                 24  AM-A-COMA-SV          PIC XXX.
  4077                 24  FILLER                PIC X(6).
  4078
  4079     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4080         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4081            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4082            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4083            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4084
  4085     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4086     12  FILLER                            PIC X(120).
  4087
  4088     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4089         16  AM-CONTROL-NAME               PIC X(30).
  4090         16  AM-EXECUTIVE-ONE.
  4091             20  AM-EXEC1-NAME             PIC X(15).
  4092             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4093                                                          COMP-3.
  4094             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4095                                                          COMP-3.
  4096         16  AM-EXECUTIVE-TWO.
  4097             20  AM-EXEC2-NAME             PIC X(15).
  4098             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4099                                                          COMP-3.
  4100             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4101                                                          COMP-3.
  4102
  4103     12  AM-RETRO-ADDITIONAL-DATA.
  4104         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4105         16  AM-RETRO-PREM-P-E             PIC X.
  4106         16  AM-RETRO-CLMS-P-I             PIC X.
  4107         16  AM-RETRO-RET-BRACKET-LF.
  4108             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4109                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4110                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4111             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4112                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4113                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4114             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4115                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4116                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4117         16  AM-RETRO-RET-BRACKET-AH.
  4118             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4119                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4120                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4121                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4122             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4123                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4124                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4125             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4126                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4127                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4128
  4129     12  AM-COMMENTS.
  4130         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4131
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  73
* EL677.cbl
  4132     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4133         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4134         16  AM-FLI-BILLING-CODE           PIC X.
  4135         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4136         16  AM-FLI-UNITED-IDENT           PIC X.
  4137         16  AM-FLI-INTEREST-LOST-DATA.
  4138             20  AM-FLI-BANK-NO            PIC X(5).
  4139             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4140             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4141             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4142         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4143             20  AM-FLI-AGT                PIC X(9).
  4144             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4145             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4146         16  FILLER                        PIC X(102).
  4147
  4148     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4149         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4150             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4151             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4152             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4153             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4154             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4155         16  FILLER                          PIC X(10).
  4156******************************************************************
  4157*                                    COPY ERCCOMP.
  4158******************************************************************
  4159*                                                                *
  4160*                                                                *
  4161*                            ERCCOMP                             *
  4162*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4163*                            VMOD=2.019                          *
  4164*                                                                *
  4165*   ONLINE CREDIT SYSTEM                                         *
  4166*                                                                *
  4167*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4168*                                                                *
  4169*   FILE TYPE = VSAM,KSDS                                        *
  4170*   RECORD SIZE = 700   RECFORM = FIXED                          *
  4171*                                                                *
  4172*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4173*       ALTERNATE PATH = NONE                                    *
  4174*                                                                *
  4175*   LOG = NO                                                     *
  4176*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4177*                                                                *
  4178******************************************************************
  4179*                   C H A N G E   L O G
  4180*
  4181* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4182*-----------------------------------------------------------------
  4183*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4184* EFFECTIVE    NUMBER
  4185*-----------------------------------------------------------------
  4186* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4187* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4188* 092205    2005050300006  PEMA  ADD LEASE FEE
  4189* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  74
* EL677.cbl
  4190* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4191* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4192* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4193* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4194* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4195******************************************************************
  4196
  4197 01  COMPENSATION-MASTER.
  4198     12  CO-RECORD-ID                          PIC XX.
  4199         88  VALID-CO-ID                          VALUE 'CO'.
  4200
  4201     12  CO-CONTROL-PRIMARY.
  4202         16  CO-COMPANY-CD                     PIC X.
  4203         16  CO-CONTROL.
  4204             20  CO-CTL-1.
  4205                 24  CO-CARR-GROUP.
  4206                     28  CO-CARRIER            PIC X.
  4207                     28  CO-GROUPING.
  4208                         32  CO-GROUP-PREFIX   PIC XXX.
  4209                         32  CO-GROUP-PRIME    PIC XXX.
  4210                 24  CO-RESP-NO.
  4211                     28  CO-RESP-PREFIX        PIC X(4).
  4212                     28  CO-RESP-PRIME         PIC X(6).
  4213             20  CO-CTL-2.
  4214                 24  CO-ACCOUNT.
  4215                     28  CO-ACCT-PREFIX        PIC X(4).
  4216                     28  CO-ACCT-PRIME         PIC X(6).
  4217         16  CO-TYPE                           PIC X.
  4218             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4219             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4220             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4221
  4222     12  CO-MAINT-INFORMATION.
  4223         16  CO-LAST-MAINT-DT                  PIC XX.
  4224         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4225         16  CO-LAST-MAINT-USER                PIC X(4).
  4226     12  FILLER                                PIC XX.
  4227     12  CO-STMT-TYPE                          PIC XXX.
  4228     12  CO-COMP-TYPE                          PIC X.
  4229         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4230     12  CO-STMT-OWNER                         PIC X(4).
  4231     12  CO-BALANCE-CONTROL                    PIC X.
  4232         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4233         88  CO-NO-BALANCE                        VALUE 'N'.
  4234
  4235     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4236         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4237         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4238         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4239
  4240     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4241         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4242         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4243
  4244     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4245     12  CO-GA-DIRECT-DEP                      PIC X.
  4246     12  CO-FUTURE-SPACE                       PIC X.
  4247         88  CO-FUTURE-NOT-USED                   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  75
* EL677.cbl
  4248
  4249     12  CO-ACCT-NAME                          PIC X(30).
  4250     12  CO-MAIL-NAME                          PIC X(30).
  4251     12  CO-ADDR-1                             PIC X(30).
  4252     12  CO-ADDR-2                             PIC X(30).
  4253     12  CO-ADDR-3.
  4254         16  CO-ADDR-CITY                      PIC X(27).
  4255         16  CO-ADDR-STATE                     PIC XX.
  4256     12  CO-CSO-1099                           PIC X.
  4257     12  CO-ZIP.
  4258         16  CO-ZIP-PRIME.
  4259             20  CO-ZIP-PRI-1ST                PIC X.
  4260                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4261             20  FILLER                        PIC X(4).
  4262         16  CO-ZIP-PLUS4                      PIC X(4).
  4263     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4264         16  CO-CAN-POSTAL-1                   PIC XXX.
  4265         16  CO-CAN-POSTAL-2                   PIC XXX.
  4266         16  FILLER                            PIC XXX.
  4267     12  CO-SOC-SEC                            PIC X(13).
  4268     12  CO-TELEPHONE.
  4269         16  CO-AREA-CODE                      PIC XXX.
  4270         16  CO-PREFIX                         PIC XXX.
  4271         16  CO-PHONE                          PIC X(4).
  4272
  4273     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4274
  4275     12  CO-AR-BAL-LEVEL                       PIC X.
  4276         88  CO-AR-REF-LVL                        VALUE '1'.
  4277         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4278         88  CO-AR-BILL-LVL                       VALUE '2'.
  4279         88  CO-AR-AGT-LVL                        VALUE '3'.
  4280         88  CO-AR-FR-LVL                         VALUE '4'.
  4281
  4282     12  CO-AR-NORMAL-PRINT                    PIC X.
  4283         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4284         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4285
  4286     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  4287
  4288     12  CO-AR-REPORTING                       PIC X.
  4289         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4290         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4291
  4292     12  CO-AR-PULL-CHECK                      PIC X.
  4293         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4294         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4295
  4296     12  CO-AR-BALANCE-PRINT                   PIC X.
  4297         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4298
  4299     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4300         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4301         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4302         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4303
  4304     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4305
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  76
* EL677.cbl
  4306     12  CO-USER-CODE                          PIC X.
  4307     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4308
  4309******************************************************************
  4310*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4311*    THE LAST MONTH END RUN.
  4312******************************************************************
  4313
  4314     12  CO-LAST-ACTIVITY-DATE.
  4315         16  CO-ACT-YEAR                       PIC 99.
  4316         16  CO-ACT-MONTH                      PIC 99.
  4317         16  CO-ACT-DAY                        PIC 99.
  4318
  4319     12  CO-LAST-STMT-DT.
  4320         16  CO-LAST-STMT-YEAR                 PIC 99.
  4321         16  CO-LAST-STMT-MONTH                PIC 99.
  4322         16  CO-LAST-STMT-DAY                  PIC 99.
  4323
  4324     12  CO-MO-END-TOTALS.
  4325         16  CO-MONTHLY-TOTALS.
  4326             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4327             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4328             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4329             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4330             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4331
  4332         16  CO-AGING-TOTALS.
  4333             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4334             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4335             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4336             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4337
  4338         16  CO-YTD-TOTALS.
  4339             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4340             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4341
  4342         16  CO-OVER-UNDER-TOTALS.
  4343             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4344             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4345
  4346     12  CO-MISCELLANEOUS-TOTALS.
  4347         16  CO-FICA-TOTALS.
  4348             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4349             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4350
  4351         16  CO-CLAIM-TOTALS.
  4352             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4353             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4354
  4355******************************************************************
  4356*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4357*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4358******************************************************************
  4359
  4360     12  CO-CURRENT-TOTALS.
  4361         16  CO-CURRENT-LAST-STMT-DT.
  4362             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4363             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  77
* EL677.cbl
  4364             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4365
  4366         16  CO-CURRENT-MONTHLY-TOTALS.
  4367             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4368             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4369             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4370             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4371             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4372
  4373         16  CO-CURRENT-AGING-TOTALS.
  4374             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4375             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4376             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4377             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4378
  4379         16  CO-CURRENT-YTD-TOTALS.
  4380             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4381             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4382
  4383     12  CO-PAID-COMM-TOTALS.
  4384         16  CO-YTD-PAID-COMMS.
  4385             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4386             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4387
  4388     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4389         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4390         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4391
  4392     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4393         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4394         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4395         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4396         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4397         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4398         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4399         88  CO-FINAL-LETTER                  VALUE 'F'.
  4400         88  CO-RECONCILING                   VALUE 'R'.
  4401         88  CO-PHONE-CALL                    VALUE 'P'.
  4402         88  CO-LEGAL                         VALUE 'L'.
  4403         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4404         88  CO-WRITE-OFF                     VALUE 'W'.
  4405         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4406
  4407     12  CO-CSR-CODE                       PIC X(4).
  4408
  4409     12  CO-GA-STATUS-INFO.
  4410         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4411         16  CO-GA-TERMINATION-DT          PIC XX.
  4412         16  CO-GA-STATUS-CODE             PIC X.
  4413             88  CO-GA-ACTIVE                 VALUE 'A'.
  4414             88  CO-GA-INACTIVE               VALUE 'I'.
  4415             88  CO-GA-PENDING                VALUE 'P'.
  4416         16  CO-GA-COMMENTS.
  4417             20  CO-GA-COMMENT-1           PIC X(40).
  4418             20  CO-GA-COMMENT-2           PIC X(40).
  4419             20  CO-GA-COMMENT-3           PIC X(40).
  4420             20  CO-GA-COMMENT-4           PIC X(40).
  4421
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  78
* EL677.cbl
  4422     12  CO-RPTCD2                         PIC X(10).
  4423     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4424         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4425         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4426
  4427     12  CO-TYPE-AGENT                     PIC X(01).
  4428         88  CO-CORPORATION                   VALUE 'C'.
  4429         88  CO-PARTNERSHIP                   VALUE 'P'.
  4430         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4431         88  CO-TRUST                         VALUE 'T'.
  4432         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4433
  4434     12  CO-FAXNO.
  4435         16  CO-FAX-AREA-CODE                  PIC XXX.
  4436         16  CO-FAX-PREFIX                     PIC XXX.
  4437         16  CO-FAX-PHONE                      PIC X(4).
  4438
  4439     12  CO-BANK-INFORMATION.
  4440         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4441         16  CO-BANK-TRANSIT-NON REDEFINES
  4442             CO-BANK-TRANSIT-NO                PIC 9(8).
  4443
  4444         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4445     12  CO-MISC-DEDUCT-INFO REDEFINES
  4446                  CO-BANK-INFORMATION.
  4447         16  CO-MD-GL-ACCT                     PIC X(10).
  4448         16  CO-MD-DIV                         PIC XX.
  4449         16  CO-MD-CENTER                      PIC X(4).
  4450         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4451         16  CO-CREATE-AP-CHECK                PIC X.
  4452         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4453         16  FILLER                            PIC XXX.
  4454     12  CO-ACH-STATUS                         PIC X.
  4455         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4456         88  CO-ACH-PENDING                        VALUE 'P'.
  4457
  4458     12  CO-BILL-SW                            PIC X.
  4459     12  CO-CONTROL-NAME                       PIC X(30).
  4460     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  4461     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4462     12  CO-CLP-STATE                          PIC XX.
  4463     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4464     12  CO-SPP-REFUND-EDIT                    PIC X.
  4465
  4466******************************************************************
  4467*                                    COPY ELCCERT.
  4468******************************************************************
  4469*                                                                *
  4470*                            ELCCERT.                            *
  4471*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4472*                            VMOD=2.013                          *
  4473*                                                                *
  4474*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4475*                                                                *
  4476*   FILE TYPE = VSAM,KSDS                                        *
  4477*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4478*                                                                *
  4479*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  79
* EL677.cbl
  4480*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4481*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4482*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4483*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4484*                                                                *
  4485*   LOG = YES                                                    *
  4486*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4487******************************************************************
  4488*                   C H A N G E   L O G
  4489*
  4490* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4491*-----------------------------------------------------------------
  4492*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4493* EFFECTIVE    NUMBER
  4494*-----------------------------------------------------------------
  4495* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4496* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4497* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4498* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4499* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4500* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4501* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4502* 032612  CR2011110200001  PEMA  AHL CHANGES
  4503* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4504******************************************************************
  4505
  4506 01  CERTIFICATE-MASTER.
  4507     12  CM-RECORD-ID                      PIC XX.
  4508         88  VALID-CM-ID                      VALUE 'CM'.
  4509
  4510     12  CM-CONTROL-PRIMARY.
  4511         16  CM-COMPANY-CD                 PIC X.
  4512         16  CM-CARRIER                    PIC X.
  4513         16  CM-GROUPING.
  4514             20  CM-GROUPING-PREFIX        PIC X(3).
  4515             20  CM-GROUPING-PRIME         PIC X(3).
  4516         16  CM-STATE                      PIC XX.
  4517         16  CM-ACCOUNT.
  4518             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4519             20  CM-ACCOUNT-PRIME          PIC X(6).
  4520         16  CM-CERT-EFF-DT                PIC XX.
  4521         16  CM-CERT-NO.
  4522             20  CM-CERT-PRIME             PIC X(10).
  4523             20  CM-CERT-SFX               PIC X.
  4524
  4525     12  CM-CONTROL-BY-NAME.
  4526         16  CM-COMPANY-CD-A1              PIC X.
  4527         16  CM-INSURED-LAST-NAME          PIC X(15).
  4528         16  CM-INSURED-INITIALS.
  4529             20  CM-INSURED-INITIAL1       PIC X.
  4530             20  CM-INSURED-INITIAL2       PIC X.
  4531
  4532     12  CM-CONTROL-BY-SSN.
  4533         16  CM-COMPANY-CD-A2              PIC X.
  4534         16  CM-SOC-SEC-NO.
  4535             20  CM-SSN-STATE              PIC XX.
  4536             20  CM-SSN-ACCOUNT            PIC X(6).
  4537             20  CM-SSN-LN3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  80
* EL677.cbl
  4538                 25  CM-INSURED-INITIALS-A2.
  4539                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4540                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4541                 25 CM-PART-LAST-NAME-A2         PIC X.
  4542
  4543     12  CM-CONTROL-BY-CERT-NO.
  4544         16  CM-COMPANY-CD-A4              PIC X.
  4545         16  CM-CERT-NO-A4                 PIC X(11).
  4546
  4547     12  CM-CONTROL-BY-MEMB.
  4548         16  CM-COMPANY-CD-A5              PIC X.
  4549         16  CM-MEMBER-NO.
  4550             20  CM-MEMB-STATE             PIC XX.
  4551             20  CM-MEMB-ACCOUNT           PIC X(6).
  4552             20  CM-MEMB-LN4.
  4553                 25  CM-INSURED-INITIALS-A5.
  4554                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4555                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4556                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4557
  4558     12  CM-INSURED-PROFILE-DATA.
  4559         16  CM-INSURED-FIRST-NAME.
  4560             20  CM-INSURED-1ST-INIT       PIC X.
  4561             20  FILLER                    PIC X(9).
  4562         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4563         16  CM-INSURED-SEX                PIC X.
  4564             88  CM-SEX-MALE                  VALUE 'M'.
  4565             88  CM-SEX-FEMAL                 VALUE 'F'.
  4566         16  CM-INSURED-JOINT-AGE          PIC 99.
  4567         16  CM-JOINT-INSURED-NAME.
  4568             20  CM-JT-LAST-NAME           PIC X(15).
  4569             20  CM-JT-FIRST-NAME.
  4570                 24  CM-JT-1ST-INIT        PIC X.
  4571                 24  FILLER                PIC X(9).
  4572             20  CM-JT-INITIAL             PIC X.
  4573
  4574     12  CM-LIFE-DATA.
  4575         16  CM-LF-BENEFIT-CD              PIC XX.
  4576         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4577         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4578         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4579         16  CM-LF-DEV-CODE                PIC XXX.
  4580         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4581         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4582         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4583         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4584         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4585         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4586         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4587         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4588         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4589         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4590         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4591         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4592         16  cm-temp-epiq                  pic xx.
  4593             88  EPIQ-CLASS                  value 'EQ'.
  4594*        16  FILLER                        PIC XX.
  4595
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  81
* EL677.cbl
  4596     12  CM-AH-DATA.
  4597         16  CM-AH-BENEFIT-CD              PIC XX.
  4598         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4599         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4600         16  CM-AH-DEV-CODE                PIC XXX.
  4601         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4602         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4603         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4604         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4605         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4606         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4607         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4608         16  CM-AH-PAID-THRU-DT            PIC XX.
  4609             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4610         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4611         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4612         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4613         16  FILLER                        PIC X.
  4614
  4615     12  CM-LOAN-INFORMATION.
  4616         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4617         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4618                                           PIC S9(5)V99  COMP-3.
  4619         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4620         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4621         16  CM-PAY-FREQUENCY              PIC S99.
  4622         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4623         16  CM-RATE-CLASS                 PIC XX.
  4624         16  CM-BENEFICIARY                PIC X(25).
  4625         16  CM-POLICY-FORM-NO             PIC X(12).
  4626         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4627         16  CM-LAST-ADD-ON-DT             PIC XX.
  4628         16  CM-DEDUCTIBLE-AMOUNTS.
  4629             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4630             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4631         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4632             20  CM-RESIDENT-STATE         PIC XX.
  4633             20  CM-RATE-CODE              PIC X(4).
  4634             20  FILLER                    PIC XX.
  4635         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4636             20  CM-LOAN-OFFICER           PIC X(5).
  4637             20  FILLER                    PIC XXX.
  4638         16  CM-CSR-CODE                   PIC XXX.
  4639         16  CM-UNDERWRITING-CODE          PIC X.
  4640             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4641         16  CM-POST-CARD-IND              PIC X.
  4642         16  CM-NH-INTERFACE-SW            PIC X.
  4643         16  CM-PREMIUM-TYPE               PIC X.
  4644             88  CM-SING-PRM                  VALUE '1'.
  4645             88  CM-O-B-COVERAGE              VALUE '2'.
  4646             88  CM-OPEN-END                  VALUE '3'.
  4647         16  CM-IND-GRP-TYPE               PIC X.
  4648             88  CM-INDIVIDUAL                VALUE 'I'.
  4649             88  CM-GROUP                     VALUE 'G'.
  4650         16  CM-SKIP-CODE                  PIC X.
  4651             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4652             88  SKIP-JULY                    VALUE '1'.
  4653             88  SKIP-AUGUST                  VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  82
* EL677.cbl
  4654             88  SKIP-SEPTEMBER               VALUE '3'.
  4655             88  SKIP-JULY-AUG                VALUE '4'.
  4656             88  SKIP-AUG-SEPT                VALUE '5'.
  4657             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4658             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4659             88  SKIP-JUNE                    VALUE '8'.
  4660             88  SKIP-JUNE-JULY               VALUE '9'.
  4661             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4662             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4663         16  CM-PAYMENT-MODE               PIC X.
  4664             88  PAY-MONTHLY                  VALUE SPACE.
  4665             88  PAY-WEEKLY                   VALUE '1'.
  4666             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4667             88  PAY-BI-WEEKLY                VALUE '3'.
  4668             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4669         16  CM-LOAN-NUMBER                PIC X(8).
  4670         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4671         16  CM-OLD-LOF                    PIC XXX.
  4672*        16  CM-LOAN-OFFICER               PIC XXX.
  4673         16  CM-REIN-TABLE                 PIC XXX.
  4674         16  CM-SPECIAL-REIN-CODE          PIC X.
  4675         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4676         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4677         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4678
  4679     12  CM-STATUS-DATA.
  4680         16  CM-ENTRY-STATUS               PIC X.
  4681         16  CM-ENTRY-DT                   PIC XX.
  4682
  4683         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4684         16  CM-LF-CANCEL-DT               PIC XX.
  4685         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4686
  4687         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4688         16  CM-LF-DEATH-DT                PIC XX.
  4689         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4690
  4691         16  CM-LF-CURRENT-STATUS          PIC X.
  4692             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4693                                                'M' '4' '5' '9'.
  4694             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4695             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4696             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4697             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4698             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4699             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4700             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4701             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4702             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4703             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4704             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4705             88  CM-LF-DECLINED               VALUE 'D'.
  4706             88  CM-LF-VOIDED                 VALUE 'V'.
  4707
  4708         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4709         16  CM-AH-CANCEL-DT               PIC XX.
  4710         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4711
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  83
* EL677.cbl
  4712         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4713         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4714         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4715
  4716         16  CM-AH-CURRENT-STATUS          PIC X.
  4717             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4718                                                'M' '4' '5' '9'.
  4719             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4720             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4721             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4722             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4723             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4724             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4725             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4726             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4727             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4728             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4729             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4730             88  CM-AH-DECLINED               VALUE 'D'.
  4731             88  CM-AH-VOIDED                 VALUE 'V'.
  4732
  4733         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4734             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4735             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4736             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4737         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4738
  4739         16  CM-ENTRY-BATCH                PIC X(6).
  4740         16  CM-LF-EXIT-BATCH              PIC X(6).
  4741         16  CM-AH-EXIT-BATCH              PIC X(6).
  4742         16  CM-LAST-MONTH-END             PIC XX.
  4743
  4744     12  CM-NOTE-SW                        PIC X.
  4745         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4746         88  CERT-NOTES-PRESENT               VALUE '1'.
  4747         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4748         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4749         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4750         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4751         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4752         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4753     12  CM-COMP-EXCP-SW                   PIC X.
  4754         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4755         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4756     12  CM-INSURED-ADDRESS-SW             PIC X.
  4757         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4758         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4759
  4760*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4761     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4762     12  FILLER                            PIC X.
  4763
  4764*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4765     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4766     12  FILLER                            PIC X.
  4767*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4768     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4769
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  84
* EL677.cbl
  4770     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4771         88  CERT-ADDED-BATCH                 VALUE ' '.
  4772         88  CERT-ADDED-ONLINE                VALUE '1'.
  4773         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4774         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4775         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4776     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4777         88  CERT-AS-LOADED                   VALUE ' '.
  4778         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4779         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4780         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4781         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4782         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4783         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4784         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4785
  4786     12  CM-ACCOUNT-COMM-PCTS.
  4787         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4788         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4789
  4790     12  CM-USER-FIELD                     PIC X.
  4791     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4792     12  CM-CLP-STATE                      PIC XX.
  4793     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4794     12  CM-USER-RESERVED                  PIC XXX.
  4795     12  FILLER REDEFINES CM-USER-RESERVED.
  4796         16  CM-AH-CLASS-CD                PIC XX.
  4797         16  F                             PIC X.
  4798******************************************************************
  4799*                                    COPY ERCPNDB.
  4800******************************************************************
  4801*                                                                *
  4802*                                                                *
  4803*                            ERCPNDB.                            *
  4804*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4805*                            VMOD=2.025                          *
  4806*                                                                *
  4807*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4808*                                                                *
  4809******************************************************************
  4810*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4811*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4812******************************************************************
  4813*                                                                *
  4814*                                                                *
  4815*   FILE TYPE = VSAM,KSDS                                        *
  4816*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4817*                                                                *
  4818*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4819*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4820*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4821*                                                 RKP=13,LEN=36  *
  4822*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4823*                                      AND CHG-SEQ.)             *
  4824*                                                RKP=49,LEN=11   *
  4825*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4826*                                      AND CHG-SEQ.)             *
  4827*                                                RKP=60,LEN=15   *
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  85
* EL677.cbl
  4828*                                                                *
  4829*   LOG = NO                                                     *
  4830*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4831******************************************************************
  4832******************************************************************
  4833*                   C H A N G E   L O G
  4834*
  4835* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4836*-----------------------------------------------------------------
  4837*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4838* EFFECTIVE    NUMBER
  4839*-----------------------------------------------------------------
  4840* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4841* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4842* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4843* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4844* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4845* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4846* 032306                   PEMA  ADD BOW LOAN NUMBER
  4847* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4848* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4849* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4850* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4851* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4852* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4853* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4854* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4855* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4856******************************************************************
  4857
  4858 01  PENDING-BUSINESS.
  4859     12  PB-RECORD-ID                     PIC XX.
  4860         88  VALID-PB-ID                        VALUE 'PB'.
  4861
  4862     12  PB-CONTROL-PRIMARY.
  4863         16  PB-COMPANY-CD                PIC X.
  4864         16  PB-ENTRY-BATCH               PIC X(6).
  4865         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4866         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4867
  4868     12  PB-CONTROL-BY-ACCOUNT.
  4869         16  PB-COMPANY-CD-A1             PIC X.
  4870         16  PB-CARRIER                   PIC X.
  4871         16  PB-GROUPING.
  4872             20  PB-GROUPING-PREFIX       PIC XXX.
  4873             20  PB-GROUPING-PRIME        PIC XXX.
  4874         16  PB-STATE                     PIC XX.
  4875         16  PB-ACCOUNT.
  4876             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4877             20  PB-ACCOUNT-PRIME         PIC X(6).
  4878         16  PB-CERT-EFF-DT               PIC XX.
  4879         16  PB-CERT-NO.
  4880             20  PB-CERT-PRIME            PIC X(10).
  4881             20  PB-CERT-SFX              PIC X.
  4882         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4883
  4884         16  PB-RECORD-TYPE               PIC X.
  4885             88  PB-MAILING-DATA                VALUE '0'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  86
* EL677.cbl
  4886             88  PB-ISSUE                       VALUE '1'.
  4887             88  PB-CANCELLATION                VALUE '2'.
  4888             88  PB-BATCH-TRAILER               VALUE '9'.
  4889
  4890     12  PB-CONTROL-BY-ORIG-BATCH.
  4891         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4892         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4893         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4894         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4895
  4896     12  PB-CONTROL-BY-CSR.
  4897         16  PB-CSR-COMPANY-CD            PIC X.
  4898         16  PB-CSR-ID                    PIC X(4).
  4899         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4900         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4901         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4902******************************************************************
  4903*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4904******************************************************************
  4905
  4906     12  PB-LAST-MAINT-DT                 PIC XX.
  4907     12  PB-LAST-MAINT-BY                 PIC X(4).
  4908     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4909
  4910     12  PB-RECORD-BODY                   PIC X(375).
  4911
  4912     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4913         16  PB-CERT-ORIGIN               PIC X.
  4914             88  CLASIC-CREATED-CERT         VALUE '1'.
  4915         16  PB-I-NAME.
  4916             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4917             20  PB-I-INSURED-FIRST-NAME.
  4918                 24  PB-I-INSURED-1ST-INIT PIC X.
  4919                 24  FILLER                PIC X(9).
  4920             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4921         16  PB-I-AGE                     PIC S99   COMP-3.
  4922         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4923         16  PB-I-BIRTHDAY                PIC XX.
  4924         16  PB-I-INSURED-SEX             PIC X.
  4925             88  PB-SEX-MALE     VALUE 'M'.
  4926             88  PB-SEX-FEMALE   VALUE 'F'.
  4927
  4928         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4929         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4930         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4931         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4932         16  PB-I-SKIP-CODE               PIC X.
  4933             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4934             88  PB-SKIP-JULY              VALUE '1'.
  4935             88  PB-SKIP-AUGUST            VALUE '2'.
  4936             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4937             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4938             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4939             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4940             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4941             88  PB-SKIP-JUNE              VALUE '8'.
  4942             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4943             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  87
* EL677.cbl
  4944             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4945         16  PB-I-TERM-TYPE               PIC X.
  4946             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4947             88  PB-PAID-WEEKLY            VALUE 'W'.
  4948             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4949             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4950             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4951         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4952         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4953         16  PB-I-DATA-ENTRY-SW           PIC X.
  4954             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4955             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4956             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4957             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4958         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4959         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4960*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4961         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4962         16  FILLER                       PIC X.
  4963
  4964         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4965             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4966             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4967                                                   '90' THRU '99'.
  4968         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4969                                          PIC XX.
  4970         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4971         16  PB-I-AMOUNT-FINANCED REDEFINES
  4972                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4973         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4974         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4975                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4976         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4977         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4978         16  PB-I-CLP-AMOUNT REDEFINES
  4979                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4980         16  PB-I-LF-CALC-FLAG            PIC X.
  4981             88 PB-COMP-LF-PREM               VALUE '?'.
  4982         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4983         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4984         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4985         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4986         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4987         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4988         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4989         16  PB-I-LF-ABBR                 PIC XXX.
  4990         16  PB-I-LF-INPUT-CD             PIC XX.
  4991
  4992         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4993             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4994             88  PB-INVALID-AH               VALUE '  ' '00'
  4995                                                   '90' THRU '99'.
  4996         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4997         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4998         16  PB-I-AH-CALC-FLAG            PIC X.
  4999             88 PB-COMP-AH-PREM                  VALUE '?'.
  5000         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5001         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  88
* EL677.cbl
  5002         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5003         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5004         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5005         16  PB-I-AH-ABBR                 PIC XXX.
  5006         16  PB-I-AH-INPUT-CD             PIC XXX.
  5007
  5008         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5009         16  PB-I-REIN-TABLE              PIC XXX.
  5010         16  PB-I-BUSINESS-TYPE           PIC 99.
  5011         16  PB-I-INDV-GRP-CD             PIC X.
  5012         16  PB-I-MORT-CODE.
  5013             20  PB-I-TABLE               PIC X.
  5014             20  PB-I-INTEREST            PIC XX.
  5015             20  PB-I-MORT-TYP            PIC X.
  5016         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5017         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5018         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5019         16  PB-I-INDV-GRP-OVRD           PIC X.
  5020         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5021         16  PB-I-SIG-SW                  PIC X.
  5022             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5023         16  PB-I-RATE-CLASS              PIC XX.
  5024         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5025         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5026         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5027         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5028         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5029         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5030         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5031         16  PB-I-BENEFIT-TYPE            PIC XXX.
  5032         16  PB-I-OB-FLAG                 PIC X.
  5033             88  PB-I-OB                      VALUE 'B'.
  5034             88  PB-I-SUMMARY                 VALUE 'Z'.
  5035         16  PB-I-ENTRY-STATUS            PIC X.
  5036             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5037                                              'M' '5' '9' '2'.
  5038             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5039             88  PB-I-POLICY-PENDING          VALUE '2'.
  5040             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5041             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5042             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  5043             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5044             88  PB-I-REIN-ONLY               VALUE '9'.
  5045             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5046             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5047             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5048             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5049         16  PB-I-INT-CODE                PIC X.
  5050             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5051             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5052         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5053         16  PB-I-SOC-SEC-NO              PIC X(11).
  5054         16  PB-I-MEMBER-NO               PIC X(12).
  5055         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5056*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5057         16  PB-I-OLD-LOF                 PIC XXX.
  5058         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5059         16  PB-I-AH-EXPIRE-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  89
* EL677.cbl
  5060         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5061         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5062         16  PB-I-LIFE-INDICATOR          PIC X.
  5063             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5064         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5065         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5066                                          PIC S9(5)V99    COMP-3.
  5067         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5068             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5069             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5070         16  PB-I-1ST-PMT-DT              PIC XX.
  5071         16  PB-I-JOINT-INSURED.
  5072             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5073             20 PB-I-JOINT-FIRST-NAME.
  5074                24  PB-I-JOINT-FIRST-INIT PIC X.
  5075                24  FILLER                PIC X(9).
  5076             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5077*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5078         16  PB-I-BENEFICIARY-NAME.
  5079             20  PB-I-BANK-NUMBER         PIC X(10).
  5080             20  FILLER                   PIC X(15).
  5081         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5082         16  PB-I-REFERENCE               PIC X(12).
  5083         16  FILLER REDEFINES PB-I-REFERENCE.
  5084             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5085             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5086             20  PB-I-CLP-STATE           PIC XX.
  5087         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5088             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5089             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5090             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  5091         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5092         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5093         16  PB-I-RESIDENT-STATE          PIC XX.
  5094         16  PB-I-RATE-CODE               PIC X(4).
  5095         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5096         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5097         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5098         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5099         16  PB-I-BANK-NOCHRGB            PIC 99.
  5100         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5101         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5102
  5103     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5104         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5105             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5106         16  PB-C-CANCEL-ORIGIN           PIC X.
  5107             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5108         16  PB-C-LF-CANCEL-DT            PIC XX.
  5109         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5110         16  PB-C-LF-CALC-REQ             PIC X.
  5111             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5112         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5113         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5114         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5115             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5116         16  PB-C-AH-CANCEL-DT            PIC XX.
  5117         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  90
* EL677.cbl
  5118         16  PB-C-AH-CALC-REQ             PIC X.
  5119             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5120         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5121         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5122         16  PB-C-LAST-NAME               PIC X(15).
  5123         16  PB-C-REFUND-SW               PIC X.
  5124             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5125             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5126         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5127         16  PB-C-PAYEE-CODE              PIC X(6).
  5128         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5129         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5130         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5131         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5132         16  PB-C-REFERENCE               PIC X(12).
  5133         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5134         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5135         16  PB-C-POST-CARD-IND           PIC X.
  5136         16  PB-C-CANCEL-REASON           PIC X.
  5137         16  PB-C-REF-INTERFACE-SW        PIC X.
  5138         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5139         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  5140         16  FILLER                       PIC X(01).
  5141*        16  FILLER                       PIC X(18).
  5142         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5143*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5144         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  5145         16  PB-CANCELED-CERT-DATA.
  5146             20  PB-CI-INSURED-NAME.
  5147                 24  PB-CI-LAST-NAME      PIC X(15).
  5148                 24  PB-CI-INITIALS       PIC XX.
  5149             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5150             20  PB-CI-INSURED-SEX        PIC X.
  5151             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5152             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5153             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  5154             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5155             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5156             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5157             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5158             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5159             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5160             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5161             20  PB-CI-RATE-CLASS         PIC XX.
  5162             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5163             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5164             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5165             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5166             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  5167             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5168             20  PB-CI-LF-ABBR            PIC X(3).
  5169             20  PB-CI-AH-ABBR            PIC X(3).
  5170             20  PB-CI-OB-FLAG            PIC X.
  5171                 88  PB-CI-OB                VALUE 'B'.
  5172             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5173                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5174                                           'M' '4' '5' '9' '2'.
  5175                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  91
* EL677.cbl
  5176                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5177                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5178                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5179                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5180                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  5181                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5182                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5183                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5184                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5185                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5186                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5187                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5188             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5189                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5190                                           'M' '4' '5' '9' '2'.
  5191                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5192                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5193                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5194                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5195                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5196                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  5197                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5198                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5199                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5200                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5201                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5202                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5203                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5204             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5205             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5206             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5207             20  PB-CI-MEMBER-NO          PIC X(12).
  5208             20  PB-CI-INT-CODE           PIC X.
  5209                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5210                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5211             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  5212             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5213             20  PB-CI-COMP-EXCP-SW       PIC X.
  5214                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5215                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5216             20  PB-CI-ENTRY-STATUS       PIC X.
  5217             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5218             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5219             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5220             20  PB-CI-DEATH-DT           PIC XX.
  5221             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5222             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5223             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5224             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5225             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5226             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5227             20  PB-CI-ENTRY-DT              PIC XX.
  5228             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5229             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5230             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5231             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5232             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5233             20  PB-CI-OLD-LOF               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  92
* EL677.cbl
  5234*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5235             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5236             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5237             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5238             20  PB-CI-INDV-GRP-CD           PIC X.
  5239             20  PB-CI-BENEFICIARY-NAME.
  5240                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5241                 24  FILLER                  PIC X(15).
  5242             20  PB-CI-NOTE-SW               PIC X.
  5243             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5244             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5245             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5246             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5247             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5248             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5249             20  PB-CI-FIRST-NAME            PIC X(10).
  5250             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5251
  5252         16  FILLER                       PIC X(13).
  5253*032306  16  FILLER                       PIC X(27).
  5254*        16  FILLER                       PIC X(46).
  5255
  5256     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5257         16  FILLER                       PIC X(10).
  5258         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5259         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5260         16  PB-M-INSURED-MID-INIT        PIC X.
  5261         16  PB-M-INSURED-AGE             PIC 99.
  5262         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5263         16  PB-M-INSURED-SEX             PIC X.
  5264         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5265         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5266         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5267         16  PB-M-INSURED-CITY-STATE.
  5268             20  PB-M-INSURED-CITY        PIC X(28).
  5269             20  PB-M-INSURED-STATE       PIC XX.
  5270         16  PB-M-INSURED-ZIP-CODE.
  5271             20  PB-M-INSURED-ZIP-PRIME.
  5272                 24  PB-M-INSURED-ZIP-1   PIC X.
  5273                     88  PB-M-CANADIAN-POST-CODE
  5274                                             VALUE 'A' THRU 'Z'.
  5275                 24  FILLER               PIC X(4).
  5276             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5277         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5278                                        PB-M-INSURED-ZIP-CODE.
  5279             20  PM-M-INS-CAN-POST1       PIC XXX.
  5280             20  PM-M-INS-CAN-POST2       PIC XXX.
  5281             20  FILLER                   PIC XXX.
  5282         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5283         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5284         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5285         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5286         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5287         16  PB-M-CRED-BENE-CITYST.
  5288             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5289             20  PB-M-CRED-BENE-STATE     PIC XX.
  5290         16  FILLER                       PIC X(92).
  5291
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  93
* EL677.cbl
  5292     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5293         16  FILLER                       PIC X(10).
  5294         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5295         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5296         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5297         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5298         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5299         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5300         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5301         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5302         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5303         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5304         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5305         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5306         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5307         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5308         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5309         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5310         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5311         16  PB-ACCOUNT-NAME              PIC X(30).
  5312         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5313         16  PB-REFERENCE                 PIC X(12).
  5314         16  PB-B-RECEIVED-DT             PIC XX.
  5315         16  FILLER                       PIC X(234).
  5316
  5317     12  PB-RECORD-STATUS.
  5318         16  PB-CREDIT-SELECT-DT          PIC XX.
  5319         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5320         16  PB-BILLED-DT                 PIC XX.
  5321         16  PB-BILLING-STATUS            PIC X.
  5322             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5323             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5324             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5325         16  PB-RECORD-BILL               PIC X.
  5326             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5327             88  PB-RECORD-RETURNED           VALUE 'R'.
  5328             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5329             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5330             88  PB-OVERRIDE-AH               VALUE 'A'.
  5331             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5332         16  PB-BATCH-ENTRY               PIC X.
  5333             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5334             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5335             88  PB-REISSUED-CERT             VALUE 'E'.
  5336             88  PB-CASH-CERT                 VALUE 'C'.
  5337             88  PB-MONTHLY-CERT              VALUE 'M'.
  5338             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5339             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5340             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5341         16  PB-FORCE-CODE                PIC X.
  5342             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5343             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5344             88  PB-CANCEL-FORCE              VALUE '8'.
  5345             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5346             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5347             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5348             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5349             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  94
* EL677.cbl
  5350             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5351             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5352         16  PB-FATAL-FLAG                PIC X.
  5353             88  PB-FATAL-ERRORS              VALUE 'X'.
  5354         16  PB-FORCE-ER-CD               PIC X.
  5355             88  PB-FORCE-ERRORS              VALUE 'F'.
  5356             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5357         16  PB-WARN-ER-CD                PIC X.
  5358             88  PB-WARNING-ERRORS            VALUE 'W'.
  5359         16  FILLER                       PIC X.
  5360         16  PB-OUT-BAL-CD                PIC X.
  5361             88  PB-OUT-OF-BAL                VALUE 'O'.
  5362         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5363         16  PB-AH-OVERRIDE-L1            PIC X.
  5364         16  PB-INPUT-DT                  PIC XX.
  5365         16  PB-INPUT-BY                  PIC X(4).
  5366         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5367         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5368         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5369         16  PB-LF-EARNING-METHOD         PIC X.
  5370         16  PB-AH-EARNING-METHOD         PIC X.
  5371         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5372         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5373         16  PB-REIN-CD                   PIC XXX.
  5374         16  PB-LF-REFUND-TYPE            PIC X.
  5375         16  PB-AH-REFUND-TYPE            PIC X.
  5376         16  PB-ACCT-EFF-DT               PIC XX.
  5377         16  PB-ACCT-EXP-DT               PIC XX.
  5378         16  PB-COMPANY-ID                PIC X(3).
  5379         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5380         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5381         16  PB-SV-CARRIER                PIC X.
  5382         16  PB-SV-GROUPING               PIC X(6).
  5383         16  PB-SV-STATE                  PIC XX.
  5384         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  5385         16  PB-GA-BILLING-INFO.
  5386             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5387                                          PIC XX.
  5388         16  PB-SV-REMIT-TO  REDEFINES
  5389             PB-GA-BILLING-INFO           PIC X(10).
  5390         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5391         16  PB-I-LOAN-OFFICER            PIC X(5).
  5392         16  PB-I-VIN                     PIC X(17).
  5393
  5394         16  FILLER                       PIC X(04).
  5395         16  IMNET-BYPASS-SW              PIC X.
  5396
  5397******************************************************************
  5398*                COMMON EDIT ERRORS                              *
  5399******************************************************************
  5400
  5401     12  PB-COMMON-ERRORS.
  5402         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5403                                           PIC S9(4)     COMP.
  5404
  5405******************************************************************
  5406*                                    COPY ERCPNDM.
  5407******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  95
* EL677.cbl
  5408*                                                                *
  5409*                                                                *
  5410*                            ERCPNDM                             *
  5411*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5412*                            VMOD=2.003                          *
  5413*                                                                *
  5414*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5415*                                                                *
  5416*   FILE TYPE = VSAM,KSDS                                        *
  5417*   RECORD SIZE = 374   RECFORM = FIX                            *
  5418*                                                                *
  5419*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5420*   ALTERNATE PATH    = NOT USED                                 *
  5421*                                                                *
  5422*   LOG = YES                                                    *
  5423*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5424******************************************************************
  5425*                   C H A N G E   L O G
  5426*
  5427* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5428*-----------------------------------------------------------------
  5429*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5430* EFFECTIVE    NUMBER
  5431*-----------------------------------------------------------------
  5432* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5433* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5434* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5435******************************************************************
  5436
  5437 01  PENDING-MAILING-DATA.
  5438     12  PM-RECORD-ID                      PIC XX.
  5439         88  VALID-MA-ID                       VALUE 'PM'.
  5440
  5441     12  PM-CONTROL-PRIMARY.
  5442         16  PM-COMPANY-CD                 PIC X.
  5443         16  PM-ENTRY-BATCH                PIC X(6).
  5444         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5445         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5446
  5447     12  FILLER                            PIC X(14).
  5448
  5449     12  PM-ACCESS-CONTROL.
  5450         16  PM-SOURCE-SYSTEM              PIC XX.
  5451             88  PM-FROM-CREDIT                VALUE 'CR'.
  5452             88  PM-FROM-VSI                   VALUE 'VS'.
  5453             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5454             88  PM-FROM-OTHER                 VALUE 'OT'.
  5455         16  PM-RECORD-ADD-DT              PIC XX.
  5456         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5457         16  PM-LAST-MAINT-DT              PIC XX.
  5458         16  PM-LAST-MAINT-BY              PIC XXXX.
  5459         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5460
  5461     12  PM-PROFILE-INFO.
  5462         16  PM-QUALIFY-CODE-1             PIC XX.
  5463         16  PM-QUALIFY-CODE-2             PIC XX.
  5464         16  PM-QUALIFY-CODE-3             PIC XX.
  5465         16  PM-QUALIFY-CODE-4             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  96
* EL677.cbl
  5466         16  PM-QUALIFY-CODE-5             PIC XX.
  5467
  5468         16  PM-INSURED-LAST-NAME          PIC X(15).
  5469         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5470         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5471         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5472         16  PM-INSURED-BIRTH-DT           PIC XX.
  5473         16  PM-INSURED-SEX                PIC X.
  5474             88  PM-SEX-MALE                   VALUE 'M'.
  5475             88  PM-SEX-FEMALE                 VALUE 'F'.
  5476         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5477
  5478         16  PM-ADDRESS-CORRECTED          PIC X.
  5479         16  PM-JOINT-BIRTH-DT             PIC XX.
  5480*        16  FILLER                        PIC X(12).
  5481
  5482         16  PM-ADDRESS-LINE-1             PIC X(30).
  5483         16  PM-ADDRESS-LINE-2             PIC X(30).
  5484         16  PM-CITY-STATE.
  5485             20  PM-CITY                   PIC X(28).
  5486             20  PM-STATE                  PIC XX.
  5487         16  PM-ZIP.
  5488             20  PM-ZIP-CODE.
  5489                 24  PM-ZIP-1              PIC X.
  5490                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5491                 24  FILLER                PIC X(4).
  5492             20  PM-ZIP-PLUS4              PIC X(4).
  5493         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5494             20  PM-CAN-POST1              PIC XXX.
  5495             20  PM-CAN-POST2              PIC XXX.
  5496             20  FILLER                    PIC XXX.
  5497
  5498         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5499
  5500         16  FILLER                        PIC X(03).
  5501
  5502     12  PM-CRED-BENE-INFO.
  5503         16  PM-CRED-BENE-NAME             PIC X(25).
  5504         16  PM-CRED-BENE-ADDR             PIC X(30).
  5505         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5506         16  PM-CRED-BENE-CTYST.
  5507             20  PM-CRED-BENE-CITY         PIC X(28).
  5508             20  PM-CRED-BENE-STATE        PIC XX.
  5509         16  PM-CRED-BENE-ZIP.
  5510             20  PM-CB-ZIP-CODE.
  5511                 24  PM-CB-ZIP-1           PIC X.
  5512                     88  PM-CB-CANADIAN-POST-CODE
  5513                                  VALUE 'A' THRU 'Z'.
  5514                 24  FILLER                PIC X(4).
  5515             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5516         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5517             20  PM-CB-CAN-POST1           PIC XXX.
  5518             20  PM-CB-CAN-POST2           PIC XXX.
  5519             20  FILLER                    PIC XXX.
  5520     12  PM-POST-CARD-MAIL-DATA.
  5521         16  PM-MAIL-DATA OCCURS 7.
  5522             20  PM-MAIL-TYPE              PIC X.
  5523                 88  PM-12MO-MAILING           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  97
* EL677.cbl
  5524                 88  PM-EXP-MAILING            VALUE '2'.
  5525             20  PM-MAIL-STATUS            PIC X.
  5526                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5527                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5528                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5529             20  PM-MAIL-DATE              PIC XX.
  5530     12  FILLER                            PIC XX.
  5531     12  FILLER                            PIC X(12).
  5532*    12  FILLER                            PIC X(30).
  5533
  5534******************************************************************
  5535*                                    COPY ERCMAIL.
  5536******************************************************************
  5537*                                                                *
  5538*                                                                *
  5539*                            ERCMAIL                             *
  5540*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5541*                            VMOD=2.003                          *
  5542*                                                                *
  5543*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5544*                                                                *
  5545*   FILE TYPE = VSAM,KSDS                                        *
  5546*   RECORD SIZE = 374   RECFORM = FIX                            *
  5547*                                                                *
  5548*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5549*   ALTERNATE PATH    = NOT USED                                 *
  5550*                                                                *
  5551*   LOG = YES                                                    *
  5552*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5553******************************************************************
  5554*                   C H A N G E   L O G
  5555*
  5556* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5557*-----------------------------------------------------------------
  5558*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5559* EFFECTIVE    NUMBER
  5560*-----------------------------------------------------------------
  5561* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5562* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5563* 111108                   PEMA  ADD CRED BENE ADDR2
  5564******************************************************************
  5565
  5566 01  MAILING-DATA.
  5567     12  MA-RECORD-ID                      PIC XX.
  5568         88  VALID-MA-ID                       VALUE 'MA'.
  5569
  5570     12  MA-CONTROL-PRIMARY.
  5571         16  MA-COMPANY-CD                 PIC X.
  5572         16  MA-CARRIER                    PIC X.
  5573         16  MA-GROUPING.
  5574             20  MA-GROUPING-PREFIX        PIC XXX.
  5575             20  MA-GROUPING-PRIME         PIC XXX.
  5576         16  MA-STATE                      PIC XX.
  5577         16  MA-ACCOUNT.
  5578             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5579             20  MA-ACCOUNT-PRIME          PIC X(6).
  5580         16  MA-CERT-EFF-DT                PIC XX.
  5581         16  MA-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  98
* EL677.cbl
  5582             20  MA-CERT-PRIME             PIC X(10).
  5583             20  MA-CERT-SFX               PIC X.
  5584
  5585     12  FILLER                            PIC XX.
  5586
  5587     12  MA-ACCESS-CONTROL.
  5588         16  MA-SOURCE-SYSTEM              PIC XX.
  5589             88  MA-FROM-CREDIT                VALUE 'CR'.
  5590             88  MA-FROM-VSI                   VALUE 'VS'.
  5591             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5592             88  MA-FROM-OTHER                 VALUE 'OT'.
  5593         16  MA-RECORD-ADD-DT              PIC XX.
  5594         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5595         16  MA-LAST-MAINT-DT              PIC XX.
  5596         16  MA-LAST-MAINT-BY              PIC XXXX.
  5597         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5598
  5599     12  MA-PROFILE-INFO.
  5600         16  MA-QUALIFY-CODE-1             PIC XX.
  5601         16  MA-QUALIFY-CODE-2             PIC XX.
  5602         16  MA-QUALIFY-CODE-3             PIC XX.
  5603         16  MA-QUALIFY-CODE-4             PIC XX.
  5604         16  MA-QUALIFY-CODE-5             PIC XX.
  5605
  5606         16  MA-INSURED-LAST-NAME          PIC X(15).
  5607         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5608         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5609         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5610         16  MA-INSURED-BIRTH-DT           PIC XX.
  5611         16  MA-INSURED-SEX                PIC X.
  5612             88  MA-SEX-MALE                   VALUE 'M'.
  5613             88  MA-SEX-FEMALE                 VALUE 'F'.
  5614         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5615
  5616         16  MA-ADDRESS-CORRECTED          PIC X.
  5617         16  MA-JOINT-BIRTH-DT             PIC XX.
  5618*        16  FILLER                        PIC X(12).
  5619
  5620         16  MA-ADDRESS-LINE-1             PIC X(30).
  5621         16  MA-ADDRESS-LINE-2             PIC X(30).
  5622         16  MA-CITY-STATE.
  5623             20  MA-CITY                   PIC X(28).
  5624             20  MA-ADDR-STATE             PIC XX.
  5625         16  MA-ZIP.
  5626             20  MA-ZIP-CODE.
  5627                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5628                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5629                 24  FILLER                PIC X(4).
  5630             20  MA-ZIP-PLUS4              PIC X(4).
  5631         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5632             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5633             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5634             20  FILLER                    PIC X(3).
  5635
  5636         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5637
  5638         16  FILLER                        PIC XXX.
  5639*        16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page  99
* EL677.cbl
  5640
  5641     12  MA-CRED-BENE-INFO.
  5642         16  MA-CRED-BENE-NAME                 PIC X(25).
  5643         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5644         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5645         16  MA-CRED-BENE-CTYST.
  5646             20  MA-CRED-BENE-CITY             PIC X(28).
  5647             20  MA-CRED-BENE-STATE            PIC XX.
  5648         16  MA-CRED-BENE-ZIP.
  5649             20  MA-CB-ZIP-CODE.
  5650                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5651                     88  MA-CB-CANADIAN-POST-CODE
  5652                                           VALUE 'A' THRU 'Z'.
  5653                 24  FILLER                    PIC X(4).
  5654             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5655         16  MA-CB-CANADIAN-POSTAL-CODE
  5656                            REDEFINES MA-CRED-BENE-ZIP.
  5657             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5658             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5659             20  FILLER                        PIC X(3).
  5660     12  MA-POST-CARD-MAIL-DATA.
  5661         16  MA-MAIL-DATA OCCURS 7.
  5662             20  MA-MAIL-TYPE              PIC X.
  5663                 88  MA-12MO-MAILING           VALUE '1'.
  5664                 88  MA-EXP-MAILING            VALUE '2'.
  5665             20  MA-MAIL-STATUS            PIC X.
  5666                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5667                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5668                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5669             20  MA-MAIL-DATE              PIC XX.
  5670     12  FILLER                            PIC XX.
  5671     12  FILLER                            PIC XX.
  5672*    12  FILLER                            PIC X(30).
  5673******************************************************************
  5674*                                    COPY ERCPYAJ.
  5675******************************************************************
  5676*                                                                *
  5677*                            ERCPYAJ                             *
  5678*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5679*                            VMOD=2.015                          *
  5680*                                                                *
  5681*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5682*                                                                *
  5683*                                                                *
  5684*   FILE TYPE = VSAM,KSDS                                        *
  5685*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5686*                                                                *
  5687*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5688*       ALTERNATE PATHS = NONE                                   *
  5689*                                                                *
  5690*   LOG = YES                                                    *
  5691*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5692******************************************************************
  5693******************************************************************
  5694*                   C H A N G E   L O G
  5695*
  5696* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5697*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 100
* EL677.cbl
  5698*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5699* EFFECTIVE    NUMBER
  5700*-----------------------------------------------------------------
  5701* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5702* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5703******************************************************************
  5704
  5705 01  PENDING-PAY-ADJ.
  5706     12  PY-RECORD-ID                     PIC XX.
  5707         88  VALID-PY-ID                        VALUE 'PY'.
  5708
  5709     12  PY-CONTROL-PRIMARY.
  5710         16  PY-COMPANY-CD                PIC X.
  5711         16  PY-CARRIER                   PIC X.
  5712         16  PY-GROUPING                  PIC X(6).
  5713         16  PY-FIN-RESP                  PIC X(10).
  5714         16  PY-ACCOUNT                   PIC X(10).
  5715         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5716                                          PIC X(10).
  5717         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  5718         16  PY-RECORD-TYPE               PIC X.
  5719             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5720             88  PY-DEPOSIT                   VALUE 'D'.
  5721             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5722             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5723             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5724             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5725             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5726             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5727             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5728             88  PY-FICA-ENTRY                VALUE 'F'.
  5729             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  5730             88  PY-POLICY-FEE                VALUE 'W'.
  5731             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  5732
  5733     12  PY-PYMT-TYPE                     PIC X.
  5734             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5735             88  PY-REINS-PYMT                VALUE 'R'.
  5736             88  PY-EXP-PYMT                  VALUE 'E'.
  5737
  5738     12  PY-BIL-INV                       PIC X(6).
  5739     12  PY-REF-NO                        PIC X(12).
  5740
  5741     12  PY-LAST-MAINT-DT                 PIC XX.
  5742     12  PY-LAST-MAINT-BY                 PIC X(4).
  5743     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5744
  5745     12  PY-PYADJ-RECORD.
  5746         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  5747         16  PY-ENTRY-COMMENT             PIC X(30).
  5748         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5749             20  PY-GL-ACCOUNT            PIC X(10).
  5750             20  PY-GL-STATE              PIC X(02).
  5751             20  PY-GL-CANC-SW            PIC X(01).
  5752                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5753                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5754             20  PY-GL-COMMENT            PIC X(10).
  5755             20  FILLER      REDEFINES PY-GL-COMMENT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 101
* EL677.cbl
  5756                 24  PY-GL-CHECK-NO       PIC 9(06).
  5757                 24  FILLER               PIC X(04).
  5758             20  FILLER                   PIC X(07).
  5759         16  PY-SAVE-ACCOUNT              PIC X(10).
  5760         16  PY-SAVE-TYPE                 PIC X(01).
  5761
  5762         16  PY-LETTERS.
  5763             20  PY-LETTER OCCURS 3 TIMES
  5764                           INDEXED BY PY-LET-NDX
  5765                                          PIC X(04).
  5766
  5767         16  PY-ERCOMP-TYPE               PIC X.
  5768             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5769             88  PY-GA-TYPE                   VALUE 'G'.
  5770             88  PY-BANK-TYPE                 VALUE 'B'.
  5771         16  FILLER                       PIC X(05).
  5772
  5773     12  PY-RECORD-STATUS.
  5774         16  PY-CREDIT-SELECT-DT          PIC XX.
  5775         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  5776         16  PY-BILLED-DATE               PIC XX.
  5777         16  PY-REPORTED-DT               PIC XX.
  5778         16  PY-PMT-APPLIED               PIC X.
  5779             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5780             88  PY-GA-PMT                    VALUE 'G'.
  5781             88  PY-OVWRITE-PMT               VALUE 'O'.
  5782             88  PY-NON-AR-PMT                VALUE 'N'.
  5783         16  FILLER                       PIC X(5).
  5784         16  PY-INPUT-DT                  PIC XX.
  5785         16  PY-CHECK-NUMBER              PIC X(6).
  5786         16  PY-VOID-SW                   PIC X.
  5787             88  PY-CHECK-VOIDED              VALUE 'V'.
  5788         16  PY-CHECK-ORIGIN-SW           PIC X.
  5789             88  PY-BILLING-CHECK             VALUE 'B'.
  5790             88  PY-REFUND-CHECK              VALUE 'R'.
  5791             88  PY-GA-CHECK                  VALUE 'G'.
  5792             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5793             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5794         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5795         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5796         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5797         16  PY-BILL-FLAG                 PIC X.
  5798             88  PY-BILLED                    VALUE 'B'.
  5799         16  PY-AR-FLAG                   PIC X.
  5800             88  PY-AR-CYCLE                  VALUE 'C'.
  5801             88  PY-AR-MONTH-END              VALUE 'M'.
  5802         16  PY-AR-DATE                   PIC XX.
  5803
  5804     12  PY-GL-CODES.
  5805         16  PY-GL-DB                     PIC X(14).
  5806         16  PY-GL-CR                     PIC X(14).
  5807         16  PY-GL-FLAG                   PIC X.
  5808         16  PY-GL-DATE                   PIC XX.
  5809
  5810     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5811     12  FILLER                           PIC X(3).
  5812******************************************************************
  5813 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CONTROL-FILE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 102
* EL677.cbl
  5814                          CHECK-RECORDS ACCOUNT-MASTER
  5815                          COMPENSATION-MASTER
  5816                          CERTIFICATE-MASTER PENDING-BUSINESS
  5817                          PENDING-MAILING-DATA MAILING-DATA
  5818                          PENDING-PAY-ADJ.
  5819 0000-DFHEXIT SECTION.
  5820     MOVE '9#                    $   ' TO DFHEIV0.
  5821     MOVE 'EL677' TO DFHEIV1.
  5822     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5823
  5824     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5825     MOVE '5'                    TO  DC-OPTION-CODE.
  5826     PERFORM 8500-DATE-CONVERT.
  5827     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5828     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5829     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5830
  5831     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5832
  5833     IF PI-AMOUNT NOT NUMERIC
  5834         MOVE ZEROS              TO  PI-AMOUNT.
  5835
  5836     IF EIBCALEN = 0
  5837         GO TO 8800-UNAUTHORIZED-ACCESS.
  5838     set P to address of KIXSYS
  5839     CALL "getenv" using by value P returning var-ptr
  5840     if var-ptr = null then
  5841        display ' kixsys not set '
  5842     else
  5843        set address of var to var-ptr
  5844        move 0 to env-var-len
  5845        inspect var tallying env-var-len
  5846          for characters before X'00'
  5847        unstring var (1:env-var-len) delimited by '/'
  5848           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  5849              WS-KIX-SYS
  5850        end-unstring
  5851     end-if
  5852     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5853     MOVE 2                      TO  EMI-SWITCH2.
  5854     MOVE EIBTRMID               TO  QID-TERM.
  5855
  5856     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5857         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5858
  5859     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5860         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5861             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5862             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  5863             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5864             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5865             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5866             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5867             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5868             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5869         ELSE
  5870             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5871             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 103
* EL677.cbl
  5872             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5873             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5874             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5875             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5876             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5877             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5878
  5879     MOVE LOW-VALUES             TO  EL677AI.
  5880
  5881     if eibtrnid not = trans-id
  5882        evaluate true
  5883           when pi-return-to-program = 'EL6315'
  5884              move pi-company-cd to pi-chek-comp-cd
  5885              move pi-carrier    to pi-chek-carrier
  5886              move pi-grouping   to pi-chek-grouping
  5887              move pi-state      to pi-chek-state
  5888              move pi-account    to pi-chek-account
  5889              move pi-cert-eff-dt to pi-chek-eff-dt
  5890              move pi-cert-prime to pi-chek-cert-no
  5891              move pi-cert-sfx   to pi-chek-suf-no
  5892              move +1            to pi-chek-sequence
  5893              move 'C'           to pi-check-type *> Correction
  5894              move 'S'           to mainti
  5895              move +1            to maintl
  5896              move al-uanon      to mainta
  5897              move dfhenter      to eibaid
  5898              go to 5000-browse-file
  5899           when pi-return-to-program = 'EL6318'
  5900              move 'C'           to pi-check-type *> Correction
  5901           when other
  5902              move 'R'           to pi-check-type *> Refund
  5903        end-evaluate
  5904     end-if
  5905     IF EIBTRNID NOT = TRANS-ID
  5906         move pi-processor-id    to pi-return-to
  5907         move +1                 to dedcynl
  5908         move 'N'                to dedcyno
  5909         move al-uanon           to dedcyna
  5910         move dfhpf7             to eibaid
  5911         perform 6800-browse-previous-chek-recs *> totals up prev
  5912                                 thru 6800-exit
  5913         perform 5600-get-erpndb thru 5600-exit *> calc refund on
  5914                                                *> pending record
  5915         IF PI-TO-EL677-FROM-EL1273
  5916             MOVE 'S'            TO MAINTI
  5917             MOVE 1              TO MAINTL
  5918             MOVE AL-UABON       TO MAINTA
  5919             MOVE DFHENTER       TO EIBAID
  5920             GO TO 5000-BROWSE-FILE.
  5921
  5922     IF EIBTRNID NOT = TRANS-ID
  5923        IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5924           PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5925           PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5926           IF PI-PROCESS-BENEFICIARY
  5927              GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5928           ELSE
  5929              GO TO 6300-BUILD-CERT-SCREEN
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 104
* EL677.cbl
  5930           end-if
  5931        ELSE
  5932           IF EIBTRNID NOT = EL6311-TRANS-ID and el6318-trans-id
  5933              GO TO 8100-SEND-INITIAL-MAP
  5934           ELSE
  5935              PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5936              IF PI-PROCESS-BENEFICIARY
  5937                 GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5938              ELSE
  5939                 GO TO 6300-BUILD-CERT-SCREEN
  5940              end-if
  5941           end-if
  5942        end-if
  5943      end-if
  5944
  5945     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5946                                     PI-CHEK-COMP-CD.
  5947
  5948
  5949* EXEC CICS HANDLE CONDITION
  5950*        PGMIDERR  (9600-PGMID-ERROR)
  5951*        ERROR     (9990-ABEND)
  5952*    END-EXEC.
  5953*    MOVE '"$L.                  ! " #00005851' TO DFHEIV0
  5954     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5955     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5956     MOVE X'2220233030303035383531' TO DFHEIV0(25:11)
  5957     CALL 'kxdfhei1' USING DFHEIV0
  5958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5959
  5960
  5961     IF EIBAID = DFHCLEAR
  5962         GO TO 9400-CLEAR.
  5963
  5964     IF PI-PROCESSOR-ID = 'LGXX'
  5965         GO TO 0200-RECEIVE.
  5966
  5967
  5968* EXEC CICS READQ TS
  5969*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5970*        INTO   (SECURITY-CONTROL)
  5971*        LENGTH (SC-COMM-LENGTH)
  5972*        ITEM   (SC-ITEM)
  5973*    END-EXEC.
  5974*    MOVE '*$II   L              ''   #00005862' TO DFHEIV0
  5975     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5976     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5977     MOVE X'2020233030303035383632' TO DFHEIV0(25:11)
  5978     CALL 'kxdfhei1' USING DFHEIV0,
  5979           PI-SECURITY-TEMP-STORE-ID,
  5980           SECURITY-CONTROL,
  5981           SC-COMM-LENGTH,
  5982           SC-ITEM,
  5983           DFHEIV99,
  5984           DFHEIV99
  5985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5986
  5987
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 105
* EL677.cbl
  5988     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
  5989     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  5990
  5991     IF NOT DISPLAY-CAP
  5992         MOVE 'READ'          TO SM-READ
  5993         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  5994         MOVE ER-0070         TO  EMI-ERROR
  5995         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5996         GO TO 8100-SEND-INITIAL-MAP.
  5997
  5998 0200-RECEIVE.
  5999     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6000         MOVE ER-1159            TO  EMI-ERROR
  6001         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6002         MOVE -1                 TO  PFENTERL
  6003         GO TO 8200-SEND-DATAONLY.
  6004
  6005
  6006* EXEC CICS HANDLE CONDITION
  6007*        MAPFAIL (8100-SEND-INITIAL-MAP)
  6008*    END-EXEC.
  6009*    MOVE '"$?                   ! # #00005886' TO DFHEIV0
  6010     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  6011     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6012     MOVE X'2320233030303035383836' TO DFHEIV0(25:11)
  6013     CALL 'kxdfhei1' USING DFHEIV0
  6014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6015
  6016
  6017
  6018* EXEC CICS RECEIVE
  6019*        MAP      (EL677A)
  6020*        MAPSET   (MAPSET-NAME)
  6021*        INTO     (EL677AI)
  6022*    END-EXEC.
  6023     MOVE LENGTH OF
  6024      EL677AI
  6025       TO DFHEIV11
  6026*    MOVE '8"T I  L              ''   #00005890' TO DFHEIV0
  6027     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6028     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6029     MOVE X'2020233030303035383930' TO DFHEIV0(25:11)
  6030     CALL 'kxdfhei1' USING DFHEIV0,
  6031           EL677A,
  6032           EL677AI,
  6033           DFHEIV11,
  6034           MAPSET-NAME,
  6035           DFHEIV99,
  6036           DFHEIV99
  6037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6038
  6039
  6040     IF PFENTERL GREATER ZERO
  6041         IF EIBAID NOT = DFHENTER
  6042             MOVE ER-0004        TO  EMI-ERROR
  6043             MOVE AL-UNBOF       TO  PFENTERA
  6044             MOVE -1             TO  PFENTERL
  6045             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 106
* EL677.cbl
  6046             GO TO 8200-SEND-DATAONLY
  6047         ELSE
  6048             IF (PFENTERI NUMERIC) AND
  6049                (PFENTERI GREATER 0 AND LESS 25)
  6050                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  6051             ELSE
  6052                 MOVE ER-0029    TO  EMI-ERROR
  6053                 MOVE AL-UNBOF   TO  PFENTERA
  6054                 MOVE -1         TO  PFENTERL
  6055                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6056                 GO TO 8200-SEND-DATAONLY.
  6057 0300-CHECK-PFKEYS.
  6058     IF EIBAID = DFHPF23
  6059         GO TO 8810-PF23.
  6060
  6061     IF EIBAID = DFHPF24
  6062         GO TO 9200-RETURN-MAIN-MENU.
  6063
  6064     IF EIBAID = DFHPF12
  6065         GO TO 9500-PF12.
  6066
  6067     IF EIBAID = DFHPF1 OR DFHPF2
  6068         GO TO 5000-BROWSE-FILE.
  6069
  6070     if PI-TO-EL677-FROM-EL1273
  6071        and (eibaid not = dfhenter)
  6072        go to 0320-input-error
  6073     end-if
  6074     IF EIBAID = DFHPF3
  6075         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6076         MOVE 'PF3'              TO  PI-PFKEY
  6077         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6078         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  6079             GO TO 9400-CLEAR
  6080         ELSE
  6081             MOVE XCTL-1273      TO  PGM-NAME
  6082             GO TO 9300-XCTL.
  6083
  6084     IF EIBAID = DFHPF4
  6085         IF NOT FORCE-CAP
  6086             MOVE ER-0433        TO EMI-ERROR
  6087             MOVE -1             TO PFENTERL
  6088             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6089             GO TO 8200-SEND-DATAONLY.
  6090
  6091     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
  6092                             DFHPF5 OR DFHPF6 or dfhpf7
  6093         GO TO 1000-EDIT-DATA.
  6094
  6095*    IF EIBAID = DFHPF7
  6096*        PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6097*        PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6098*        MOVE XCTL-114           TO  PGM-NAME
  6099*        GO TO 9300-XCTL.
  6100
  6101 0320-INPUT-ERROR.
  6102     MOVE ER-0029                TO  EMI-ERROR.
  6103     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 107
* EL677.cbl
  6104     MOVE -1                     TO  PFENTERL.
  6105     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 108
* EL677.cbl
  6107
  6108 1000-EDIT-DATA.
  6109     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D'
  6110         MOVE AL-UANON           TO MAINTA
  6111         IF MAINTI = 'C' OR 'V'
  6112             IF PI-PREV-MAINT = 'S'  OR  'C'
  6113                 NEXT SENTENCE
  6114             ELSE
  6115                 MOVE ER-2056    TO  EMI-ERROR
  6116                 MOVE -1         TO  MAINTL
  6117                 MOVE AL-UABON   TO  MAINTA
  6118                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6119                 GO TO 1100-EDIT-COMPLETE
  6120         ELSE
  6121             NEXT SENTENCE
  6122     ELSE
  6123         IF EIBAID = DFHPF5 OR DFHPF6 or dfhpf7
  6124            NEXT SENTENCE
  6125         ELSE
  6126            MOVE ER-0023            TO  EMI-ERROR
  6127            MOVE -1                 TO  MAINTL
  6128            MOVE AL-UABON           TO  MAINTA
  6129            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6130
  6131     IF MODIFY-CAP
  6132         NEXT SENTENCE
  6133       ELSE
  6134         IF MAINTI NOT = 'S'
  6135            MOVE 'UPDATE'       TO SM-READ
  6136            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6137            MOVE ER-0070        TO EMI-ERROR
  6138            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6139            GO TO 8100-SEND-INITIAL-MAP.
  6140
  6141     if (pi-return-to-program = 'EL1273')
  6142        and (MAINTI not = 'S' and 'V')
  6143        move 'S'                 to mainti
  6144        move +1                  to maintl
  6145        move al-uanon            to mainta
  6146     end-if
  6147     IF CARRIERI NOT = LOW-VALUES
  6148         MOVE AL-UANON           TO  CARRIERA
  6149         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  6150         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  6151                                     PI-CARRIER
  6152     ELSE
  6153         MOVE -1                 TO  CARRIERL
  6154         MOVE AL-UABON           TO  CARRIERA
  6155         MOVE ER-0194            TO  EMI-ERROR
  6156         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6157
  6158     IF GROUPI NOT = LOW-VALUES
  6159         MOVE AL-UANON           TO  GROUPA
  6160         MOVE GROUPI             TO  PI-CHEK-GROUPING
  6161                                     PI-GROUPING
  6162     ELSE
  6163         MOVE -1                 TO  GROUPL
  6164         MOVE AL-UABON           TO  GROUPA
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 109
* EL677.cbl
  6165         MOVE ER-0195            TO  EMI-ERROR
  6166         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6167
  6168     IF STATEI NOT = LOW-VALUES
  6169         MOVE AL-UANON           TO  STATEA
  6170         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
  6171         MOVE STATEI             TO  PI-CHEK-STATE
  6172                                     PI-STATE
  6173     ELSE
  6174         MOVE -1                 TO  STATEL
  6175         MOVE AL-UABON           TO  STATEA
  6176         MOVE ER-0196            TO  EMI-ERROR
  6177         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6178
  6179     IF EFFDTL GREATER ZERO
  6180         MOVE EFFDTI             TO  WS-DT-DEEDIT-FIELD
  6181         PERFORM 8700-DEEDIT
  6182         IF WS-DEEDIT-FIELD-DATE-OUT IS NUMERIC
  6183             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EFFDTO
  6184             INSPECT EFFDTI CONVERTING SPACES TO '/'
  6185             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  6186             MOVE '4'                TO  DC-OPTION-CODE
  6187             PERFORM 8500-DATE-CONVERT
  6188             IF DC-ERROR-CODE NOT = SPACES
  6189                 MOVE ER-0215        TO  EMI-ERROR
  6190                 PERFORM 9900-ERROR-FORMAT
  6191                 MOVE -1             TO  EFFDTL
  6192                 MOVE AL-UABON       TO  EFFDTA
  6193               ELSE
  6194                 MOVE AL-UANON       TO  EFFDTA
  6195                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  6196                                         PI-CERT-EFF-DT
  6197           ELSE
  6198             MOVE ER-0215        TO  EMI-ERROR
  6199             PERFORM 9900-ERROR-FORMAT
  6200             MOVE -1             TO  EFFDTL
  6201             MOVE AL-UABON       TO  EFFDTA
  6202       ELSE
  6203         MOVE ER-0216            TO  EMI-ERROR
  6204         PERFORM 9900-ERROR-FORMAT
  6205         MOVE -1                 TO  EFFDTL
  6206         MOVE AL-UABOF           TO  EFFDTA.
  6207
  6208     IF ACCTI NOT = LOW-VALUES
  6209         MOVE AL-UANON           TO  ACCTA
  6210         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  6211         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  6212                                     PI-ACCOUNT
  6213     ELSE
  6214         MOVE -1                 TO  ACCTL
  6215         MOVE AL-UABON           TO  ACCTA
  6216         MOVE ER-0197            TO  EMI-ERROR
  6217         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6218
  6219     IF CERTNOI NOT = LOW-VALUES
  6220         MOVE AL-UANON           TO  CERTNOA
  6221         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6222                                     PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 110
* EL677.cbl
  6223     ELSE
  6224         MOVE -1                 TO  CERTNOL
  6225         MOVE AL-UABON           TO  CERTNOA
  6226         MOVE ER-0203            TO  EMI-ERROR
  6227         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6228
  6229     IF SFXI  = LOW-VALUES
  6230         MOVE SPACE              TO  SFXI.
  6231
  6232     MOVE AL-UANON               TO  SFXA.
  6233
  6234     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6235                                     PI-CERT-SFX.
  6236     IF SEQI = LOW-VALUES
  6237         MOVE +1                 TO  SEQI.
  6238
  6239     MOVE AL-UNNON               TO  SEQA.
  6240     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6241
  6242     IF PAYTO1L > 0
  6243         MOVE PAYTO1I            TO  PI-PAYTO1
  6244     ELSE
  6245         MOVE SPACES             TO  PI-PAYTO1.
  6246
  6247     IF AMOUNTL > 0
  6248
  6249* EXEC CICS BIF DEEDIT
  6250*            FIELD   (AMOUNTI)
  6251*            LENGTH  (11)
  6252*        END-EXEC
  6253     MOVE 11
  6254       TO DFHEIV11
  6255*    MOVE '@"L                   #   #00006104' TO DFHEIV0
  6256     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6257     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6258     MOVE X'2020233030303036313034' TO DFHEIV0(25:11)
  6259     CALL 'kxdfhei1' USING DFHEIV0,
  6260           AMOUNTI,
  6261           DFHEIV11
  6262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6263         MOVE AMOUNTI            TO  PI-AMOUNT
  6264     ELSE
  6265         MOVE ZEROS              TO  PI-AMOUNT.
  6266
  6267     IF TYPEL > 0
  6268         MOVE TYPEI              TO  PI-TYPE
  6269     ELSE
  6270         MOVE SPACE              TO  PI-TYPE.
  6271
  6272*    IF REFL > 0
  6273*        MOVE REFI               TO  PI-REFERENCE
  6274*    ELSE
  6275*        MOVE SPACES             TO  PI-REFERENCE.
  6276     if rettol not = zeros
  6277        move rettoi              to pi-return-to
  6278        MOVE AL-UANON            TO  RETTOA
  6279     end-if
  6280     if dedcynl not = zeros
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 111
* EL677.cbl
  6281        if dedcyni = 'Y' OR 'N'
  6282           continue
  6283        else
  6284           move er-3451          to emi-error
  6285           move -1               to dedcynl
  6286           move al-uabon         to dedcyna
  6287           perform 9900-error-format
  6288                                 thru 9900-exit
  6289        end-if
  6290     end-if
  6291
  6292     if mainti = 'V'
  6293        if (vreasonl > zeros)
  6294           and (vreasoni (1:2) not = spaces)
  6295           continue
  6296        else
  6297           move er-3454          to emi-error
  6298           move -1               to vreasonl
  6299           move al-uabon         to vreasona
  6300           perform 9900-error-format
  6301                                 thru 9900-exit
  6302        end-if
  6303     end-if
  6304     if (mainti = 'A')
  6305        and (pi-prev-paid > zeros)
  6306        and (pi-check-type = 'C')
  6307        move er-3459             to emi-error
  6308        move -1                  to maintl
  6309        move al-uabon            to mainta
  6310        perform 9900-error-format
  6311                                 thru 9900-exit
  6312     end-if
  6313     if mainti = 'A'
  6314        continue
  6315     else
  6316        IF MAINTI = 'S'
  6317           or pi-prev-maint = 'S'
  6318           GO TO 1100-EDIT-COMPLETE
  6319        end-if
  6320     end-if
  6321     IF EIBAID = DFHPF5
  6322        IF EMI-ERROR = ZEROS
  6323          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6324        ELSE
  6325          GO TO 1100-EDIT-COMPLETE.
  6326
  6327     IF EIBAID = DFHPF6
  6328        IF EMI-ERROR = ZEROS
  6329           GO TO 6300-BUILD-CERT-SCREEN
  6330         ELSE
  6331           GO TO 1100-EDIT-COMPLETE.
  6332
  6333     IF EIBAID = DFHPF7
  6334        IF EMI-ERROR = ZEROS
  6335           GO TO 6600-build-beneficiary-screen
  6336         ELSE
  6337           GO TO 1100-EDIT-COMPLETE.
  6338
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 112
* EL677.cbl
  6339*    if mainti = 'V'
  6340*       if (vreasonl > zeros)
  6341*          and (vreasoni (1:2) not = spaces)
  6342*          continue
  6343*       else
  6344*          move er-3454          to emi-error
  6345*          move -1               to vreasonl
  6346*          move al-uabon         to vreasona
  6347*          perform 9900-error-format
  6348*                                thru 9900-exit
  6349*       end-if
  6350*    end-if
  6351     IF MAINTI = 'A'
  6352        if (payto1i not = spaces and low-values)
  6353           and (payad1i not = spaces and low-values)
  6354           and (payctyi not = spaces and low-values)
  6355           and (paysti not = spaces and low-values)
  6356           and (ptozipi not = spaces and low-values)
  6357           continue
  6358        else
  6359           MOVE -1               TO PAYTO1L
  6360           MOVE ER-2907          TO EMI-ERROR
  6361           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6362        end-if
  6363     end-if
  6364
  6365     IF MAINTI = 'A'
  6366         IF EIBAID NOT = DFHPF4
  6367             MOVE DFHENTER       TO  EIBAID
  6368             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6369
  6370     IF MAINTI = 'S' OR 'V'
  6371         GO TO 1100-EDIT-COMPLETE.
  6372
  6373     IF PRINTEDL GREATER THAN +0
  6374         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6375         PERFORM 8700-DEEDIT
  6376         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6377             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6378             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6379             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
  6380             MOVE '4'                TO  DC-OPTION-CODE
  6381             PERFORM 8500-DATE-CONVERT
  6382             IF DC-ERROR-CODE NOT = SPACES
  6383                 MOVE ER-3046        TO  EMI-ERROR
  6384                 PERFORM 9900-ERROR-FORMAT
  6385                 MOVE -1             TO  PRINTEDL
  6386                 MOVE AL-UABON       TO  PRINTEDA
  6387                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6388             ELSE
  6389                 MOVE AL-UANON       TO  PRINTEDA
  6390                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6391         ELSE
  6392             MOVE ER-3046        TO  EMI-ERROR
  6393             PERFORM 9900-ERROR-FORMAT
  6394             MOVE -1             TO  PRINTEDL
  6395             MOVE AL-UABON       TO  PRINTEDA
  6396             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 113
* EL677.cbl
  6397
  6398     IF AMOUNTL = ZEROS
  6399         GO TO 1050-CK-AMT.
  6400
  6401
  6402* EXEC CICS BIF DEEDIT
  6403*        FIELD   (AMOUNTI)
  6404*        LENGTH  (11)
  6405*    END-EXEC.
  6406     MOVE 11
  6407       TO DFHEIV11
  6408*    MOVE '@"L                   #   #00006246' TO DFHEIV0
  6409     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6410     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6411     MOVE X'2020233030303036323436' TO DFHEIV0(25:11)
  6412     CALL 'kxdfhei1' USING DFHEIV0,
  6413           AMOUNTI,
  6414           DFHEIV11
  6415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6416
  6417
  6418     IF AMOUNTI NOT NUMERIC     OR
  6419        AMOUNTI LESS THAN ZERO  OR
  6420       (AMOUNTI = ZEROS  AND
  6421               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6422          MOVE ER-1159            TO  EMI-ERROR
  6423          MOVE -1                 TO  AMOUNTL
  6424          MOVE AL-UNBON           TO  AMOUNTA
  6425          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6426          GO TO 1100-EDIT-COMPLETE.
  6427
  6428     MOVE AMOUNTI                TO  WS-AM-WORK.
  6429
  6430     IF WS-AM-SIGN = SPACES
  6431         MOVE WS-AM-NUM          TO  WS-AMT
  6432         ADD 0                   TO  WS-AMT
  6433       ELSE
  6434         MOVE AMOUNTI            TO  WS-AMT
  6435         ADD 0                   TO  WS-AMT.
  6436
  6437      MOVE WS-AMT                TO  AMOUNTO.
  6438      MOVE AL-UNNON              TO  AMOUNTA.
  6439
  6440 1050-CK-AMT.
  6441     IF AMOUNTL = ZEROS AND
  6442        MAINTI  = 'A'
  6443         MOVE ER-1159            TO  EMI-ERROR
  6444         MOVE -1                 TO  AMOUNTL
  6445         MOVE AL-UNBON           TO  AMOUNTA
  6446         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6447
  6448*    MOVE AL-UANON              TO  TYPEA.
  6449
  6450     IF TYPEL GREATER THAN ZEROS
  6451         IF TYPEI = 'R' OR 'M' OR 'E' or 'C'
  6452             NEXT SENTENCE
  6453         ELSE
  6454             MOVE ER-3044    TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 114
* EL677.cbl
  6455             MOVE -1         TO  TYPEL
  6456             MOVE AL-PABON   TO  TYPEA
  6457             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6458     ELSE
  6459         IF MAINTI  = 'A'
  6460             MOVE ER-3044    TO  EMI-ERROR
  6461             MOVE -1         TO  TYPEL
  6462             MOVE AL-PABON   TO  TYPEA
  6463             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6464
  6465
  6466 1100-EDIT-COMPLETE.
  6467
  6468     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6469       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6470        EIBAID NOT = DFHPF4)
  6471         GO TO 8200-SEND-DATAONLY.
  6472
  6473     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6474
  6475     IF MAINTI = 'A'
  6476         GO TO 2000-ADD-RECORD.
  6477
  6478*    IF MAINTI = 'C' OR 'V'
  6479     IF MAINTI = 'V'
  6480         GO TO 3000-CHANGE-RECORD.
  6481
  6482     IF MAINTI = 'S' or 'C'
  6483         GO TO 5000-BROWSE-FILE.
  6484
  6485     if mainti = 'D'
  6486        go to 3400-delete-record
  6487     end-if
  6488     .
  6489 1200-VERIFY-CARRIER-ID.
  6490     MOVE SPACES                 TO ELCNTL-KEY.
  6491     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6492     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6493     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6494     MOVE +0                     TO ELCNTL-SEQ.
  6495
  6496
  6497* EXEC CICS HANDLE CONDITION
  6498*        NOTFND   (1290-NO-CARRIER)
  6499*    END-EXEC.
  6500*    MOVE '"$I                   ! $ #00006329' TO DFHEIV0
  6501     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6502     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6503     MOVE X'2420233030303036333239' TO DFHEIV0(25:11)
  6504     CALL 'kxdfhei1' USING DFHEIV0
  6505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6506
  6507
  6508
  6509* EXEC CICS READ
  6510*        DATASET   (ELCNTL-FILE-ID)
  6511*        SET       (ADDRESS OF CONTROL-FILE)
  6512*        RIDFLD    (ELCNTL-KEY)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 115
* EL677.cbl
  6513*    END-EXEC.
  6514*    MOVE '&"S        E          (   #00006333' TO DFHEIV0
  6515     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6516     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6517     MOVE X'2020233030303036333333' TO DFHEIV0(25:11)
  6518     CALL 'kxdfhei1' USING DFHEIV0,
  6519           ELCNTL-FILE-ID,
  6520           DFHEIV20,
  6521           DFHEIV99,
  6522           ELCNTL-KEY,
  6523           DFHEIV99,
  6524           DFHEIV99,
  6525           DFHEIV99
  6526     SET ADDRESS OF CONTROL-FILE TO
  6527         DFHEIV20
  6528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6529
  6530
  6531     GO TO 1200-EXIT.
  6532
  6533 1290-NO-CARRIER.
  6534     MOVE ER-2208                TO EMI-ERROR.
  6535     MOVE -1                     TO CARRIERL.
  6536     MOVE AL-UABON               TO CARRIERA.
  6537     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6538
  6539 1200-EXIT.
  6540      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 116
* EL677.cbl
  6542 1300-VERIFY-STATE-ID.
  6543     MOVE SPACES                 TO ELCNTL-KEY.
  6544     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6545     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6546     MOVE STATEI                 TO ELCNTL-STATE.
  6547     MOVE +0                     TO ELCNTL-SEQ.
  6548
  6549
  6550* EXEC CICS HANDLE CONDITION
  6551*        NOTFND   (1380-NO-STATE)
  6552*    END-EXEC.
  6553*    MOVE '"$I                   ! % #00006357' TO DFHEIV0
  6554     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6555     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6556     MOVE X'2520233030303036333537' TO DFHEIV0(25:11)
  6557     CALL 'kxdfhei1' USING DFHEIV0
  6558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6559
  6560
  6561
  6562* EXEC CICS READ
  6563*        DATASET   (ELCNTL-FILE-ID)
  6564*        SET       (ADDRESS OF CONTROL-FILE)
  6565*        RIDFLD    (ELCNTL-KEY)
  6566*    END-EXEC.
  6567*    MOVE '&"S        E          (   #00006361' TO DFHEIV0
  6568     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6569     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6570     MOVE X'2020233030303036333631' TO DFHEIV0(25:11)
  6571     CALL 'kxdfhei1' USING DFHEIV0,
  6572           ELCNTL-FILE-ID,
  6573           DFHEIV20,
  6574           DFHEIV99,
  6575           ELCNTL-KEY,
  6576           DFHEIV99,
  6577           DFHEIV99,
  6578           DFHEIV99
  6579     SET ADDRESS OF CONTROL-FILE TO
  6580         DFHEIV20
  6581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6582
  6583
  6584     GO TO 1390-EXIT.
  6585
  6586 1380-NO-STATE.
  6587     MOVE ER-2209                TO EMI-ERROR.
  6588     MOVE -1                     TO STATEL.
  6589     MOVE AL-UABON               TO STATEA.
  6590     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6591
  6592 1390-EXIT.
  6593      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 117
* EL677.cbl
  6595
  6596 1400-VERIFY-ACCOUNT.
  6597     IF EIBAID = DFHPF5
  6598         GO TO 1410-BUILD-ACCOUNT-KEY.
  6599
  6600     IF MAINTL GREATER +0
  6601         NEXT SENTENCE
  6602       ELSE
  6603         GO TO 1490-EXIT.
  6604
  6605*    IF MAINTI = 'A' OR 'C' OR 'V'
  6606     IF MAINTI = 'A' OR 'V'
  6607         NEXT SENTENCE
  6608       ELSE
  6609         GO TO 1490-EXIT.
  6610
  6611 1410-BUILD-ACCOUNT-KEY.
  6612     MOVE CARRIERI               TO ERACCT-CARRIER.
  6613     MOVE GROUPI                 TO ERACCT-GROUPING
  6614     MOVE STATEI                 TO ERACCT-STATE.
  6615     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6616     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6617
  6618     MOVE '2'                    TO DC-OPTION-CODE.
  6619     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6620
  6621     PERFORM 8500-DATE-CONVERT.
  6622     IF DATE-CONVERSION-ERROR
  6623        GO TO 1480-ACCOUNT-INVALID.
  6624
  6625     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6626    .
  6627 1420-get-eracct.
  6628     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6629
  6630
  6631* EXEC CICS HANDLE CONDITION
  6632*        NOTFND   (1480-ACCOUNT-INVALID)
  6633*        ENDFILE  (1480-ACCOUNT-INVALID)
  6634*    END-EXEC.
  6635*    MOVE '"$I''                  ! & #00006413' TO DFHEIV0
  6636     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6637     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6638     MOVE X'2620233030303036343133' TO DFHEIV0(25:11)
  6639     CALL 'kxdfhei1' USING DFHEIV0
  6640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6641
  6642
  6643
  6644* EXEC CICS STARTBR
  6645*        DATASET   (ERACCT-FILE-ID)
  6646*        RIDFLD    (ERACCT-KEY)
  6647*    END-EXEC.
  6648     MOVE 0
  6649       TO DFHEIV11
  6650*    MOVE '&,         G          &   #00006418' TO DFHEIV0
  6651     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6652     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 118
* EL677.cbl
  6653     MOVE X'2020233030303036343138' TO DFHEIV0(25:11)
  6654     CALL 'kxdfhei1' USING DFHEIV0,
  6655           ERACCT-FILE-ID,
  6656           ERACCT-KEY,
  6657           DFHEIV99,
  6658           DFHEIV11,
  6659           DFHEIV99
  6660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6661
  6662
  6663     set eracct-start to true
  6664     .
  6665 1420-READNEXT-ACCOUNT-MASTER.
  6666
  6667* EXEC CICS READNEXT
  6668*        DATASET   (ERACCT-FILE-ID)
  6669*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6670*        RIDFLD    (ERACCT-KEY)
  6671*    END-EXEC.
  6672     MOVE 0
  6673       TO DFHEIV11
  6674*    MOVE '&.S                   )   #00006426' TO DFHEIV0
  6675     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6676     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6677     MOVE X'2020233030303036343236' TO DFHEIV0(25:11)
  6678     CALL 'kxdfhei1' USING DFHEIV0,
  6679           ERACCT-FILE-ID,
  6680           DFHEIV20,
  6681           DFHEIV99,
  6682           ERACCT-KEY,
  6683           DFHEIV99,
  6684           DFHEIV11,
  6685           DFHEIV99,
  6686           DFHEIV99
  6687     SET ADDRESS OF ACCOUNT-MASTER TO
  6688         DFHEIV20
  6689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6690
  6691
  6692*    IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6693*       SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6694*       SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6695*       SV-ACCT-STATE    NOT = AM-STATE        OR
  6696*       SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6697*         GO TO 1480-ACCOUNT-INVALID.
  6698*
  6699*    IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6700*        GO TO 1480-ACCOUNT-INVALID.
  6701*
  6702*    IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6703*        GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6704
  6705     evaluate true
  6706        when (save-eracct-key (1:20) not =
  6707           am-control-primary (1:20))
  6708           and (not eracct-found)
  6709           go to 1480-account-invalid
  6710        when (save-eracct-key (1:20) not =
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 119
* EL677.cbl
  6711           am-control-primary (1:20))
  6712           and (eracct-found)
  6713           move ws-hold-eracct-record
  6714                                 to account-master
  6715        when (sv-acct-exp-date < am-effective-dt)
  6716           and (not eracct-found)
  6717           go to 1480-account-invalid
  6718        when sv-acct-exp-date >= am-expiration-dt
  6719           go to 1420-readnext-account-master
  6720        when am-expiration-dt = high-values
  6721           continue
  6722        when other
  6723           set eracct-found to true
  6724           move account-master   to ws-hold-eracct-record
  6725           go to 1420-readnext-account-master
  6726     end-evaluate
  6727     if eracct-start
  6728
  6729* exec cics endbr
  6730*          dataset  (eracct-file-id)
  6731*       end-exec
  6732     MOVE 0
  6733       TO DFHEIV11
  6734*    MOVE '&2                    $   #00006468' TO DFHEIV0
  6735     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6736     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6737     MOVE X'2020233030303036343638' TO DFHEIV0(25:11)
  6738     CALL 'kxdfhei1' USING DFHEIV0,
  6739           eracct-file-id,
  6740           DFHEIV11,
  6741           DFHEIV99
  6742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6743     end-if
  6744*    if am-expiration-dt = high-values
  6745*       continue
  6746*    else
  6747*       move account-master      to ws-hold-eracct-record
  6748*       go to 1420-readnext-account-master
  6749*    end-if
  6750     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6751     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6752     MOVE AM-STATE               TO PI-CR-STATE.
  6753     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6754
  6755     MOVE AM-NAME                TO PI-AM-NAME.
  6756     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6757     MOVE AM-CITY                TO PI-AM-CITY-st
  6758     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6759     move am-csr-code            to pi-am-csr
  6760
  6761     MOVE +0                     TO WS-SUB.
  6762
  6763 1430-FIND-ACC-AGT.
  6764     ADD +1                      TO WS-SUB.
  6765
  6766     IF  WS-SUB GREATER +10
  6767         GO TO 1480-ACCOUNT-INVALID.
  6768
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 120
* EL677.cbl
  6769     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F')
  6770         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6771       ELSE
  6772         GO TO 1430-FIND-ACC-AGT.
  6773
  6774     MOVE AL-UANON               TO CARRIERA
  6775                                    GROUPA
  6776                                    STATEA.
  6777
  6778     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6779
  6780     GO TO 1490-EXIT.
  6781
  6782 1480-ACCOUNT-INVALID.
  6783     MOVE -1                     TO CARRIERL
  6784     MOVE AL-UANON               TO CARRIERA
  6785                                    GROUPA
  6786                                    STATEA
  6787                                    ACCTA.
  6788     MOVE ER-2210                TO EMI-ERROR.
  6789     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6790     GO TO 8200-SEND-DATAONLY.
  6791
  6792 1490-EXIT.
  6793      EXIT.
  6794
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 121
* EL677.cbl
  6796 1500-VERIFY-PENDING-BUS-REC.
  6797     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6798     if ws-corr-check
  6799        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW
  6800        go to 1590-exit
  6801     end-if
  6802
  6803* EXEC CICS HANDLE CONDITION
  6804*        NOTFND   (1590-EXIT)
  6805*    END-EXEC.
  6806*    MOVE '"$I                   ! '' #00006530' TO DFHEIV0
  6807     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6808     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6809     MOVE X'2720233030303036353330' TO DFHEIV0(25:11)
  6810     CALL 'kxdfhei1' USING DFHEIV0
  6811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6812
  6813
  6814
  6815     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6816     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6817     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6818     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6819     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6820     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6821     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6822     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6823     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6824     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6825
  6826     IF ST-ACCNT-CNTL  OR
  6827        ACCNT-CNTL
  6828          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6829
  6830     IF ST-ACCNT-CNTL      OR
  6831        CARR-ST-ACCNT-CNTL OR
  6832        ACCNT-CNTL         OR
  6833        CARR-ACCNT-CNTL
  6834          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6835
  6836     IF ACCNT-CNTL OR
  6837        CARR-ACCNT-CNTL
  6838          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6839
  6840
  6841* EXEC CICS READ
  6842*         DATASET   (ERPNDB-ALT-FILE-ID)
  6843*         SET       (ADDRESS OF PENDING-BUSINESS)
  6844*         RIDFLD    (ERPNDB-ALT-KEY)
  6845*     END-EXEC.
  6846*    MOVE '&"S        E          (   #00006560' TO DFHEIV0
  6847     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6848     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6849     MOVE X'2020233030303036353630' TO DFHEIV0(25:11)
  6850     CALL 'kxdfhei1' USING DFHEIV0,
  6851           ERPNDB-ALT-FILE-ID,
  6852           DFHEIV20,
  6853           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 122
* EL677.cbl
  6854           ERPNDB-ALT-KEY,
  6855           DFHEIV99,
  6856           DFHEIV99,
  6857           DFHEIV99
  6858     SET ADDRESS OF PENDING-BUSINESS TO
  6859         DFHEIV20
  6860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6861
  6862
  6863     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6864
  6865     IF PB-C-PAYEE-CODE GREATER SPACES
  6866        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6867
  6868     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6869*    MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6870
  6871     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6872     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6873
  6874     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6875         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6876     ELSE
  6877         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6878
  6879     IF MAINTI = 'A' OR 'C'
  6880       IF PB-C-REFUND-CREATED
  6881           MOVE -1               TO  MAINTL
  6882           MOVE ER-3445          TO  EMI-ERROR
  6883           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6884
  6885 1590-EXIT.
  6886      EXIT.
  6887
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 123
* EL677.cbl
  6889 2000-ADD-RECORD.
  6890
  6891* EXEC CICS GETMAIN
  6892*        SET      (ADDRESS OF CHECK-RECORDS)
  6893*        LENGTH   (600)
  6894*        INITIMG  (GETMAIN-SPACE)
  6895*    END-EXEC.
  6896     MOVE 600
  6897       TO DFHEIV11
  6898*    MOVE ',"IL                  $   #00006593' TO DFHEIV0
  6899     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6900     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6901     MOVE X'2020233030303036353933' TO DFHEIV0(25:11)
  6902     CALL 'kxdfhei1' USING DFHEIV0,
  6903           DFHEIV20,
  6904           DFHEIV11,
  6905           GETMAIN-SPACE
  6906     SET ADDRESS OF CHECK-RECORDS TO
  6907         DFHEIV20
  6908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6909
  6910
  6911     MOVE 'CH'                   TO CH-RECORD-ID.
  6912     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6913     MOVE CARRIERI               TO CH-CARRIER.
  6914     MOVE GROUPI                 TO CH-GROUPING.
  6915     MOVE STATEI                 TO CH-STATE.
  6916     MOVE ACCTI                  TO CH-ACCOUNT.
  6917
  6918     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6919     MOVE '2'                    TO DC-OPTION-CODE.
  6920     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6921     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6922
  6923     MOVE CERTNOI                TO CH-CERT-PRIME.
  6924     MOVE SFXI                   TO CH-CERT-SFX.
  6925
  6926     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6927
  6928     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY
  6929                                    ch-released-by
  6930     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6931
  6932     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6933     MOVE '5'                    TO DC-OPTION-CODE.
  6934     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6935     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT
  6936                                    ch-released-dt
  6937
  6938     move 'P'                    to ch-approval-status
  6939
  6940     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6941                                    CH-VOID-DT
  6942                                    CH-CREDIT-ACCEPT-DT
  6943                                    CH-CANC-DT
  6944                                    ch-approval-dt
  6945                                    ch-check-cashed-dt
  6946     MOVE ZEROS                  TO CH-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 124
* EL677.cbl
  6947                                    CH-AH-REFUND
  6948*                                   CH-DEDUCT-WITHHELD
  6949*                                   CH-ADDITIONAL-CHARGE.
  6950
  6951     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  6952
  6953     if pi-prev-paid not numeric
  6954        move zeros               to pi-prev-paid
  6955     end-if
  6956     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6957       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6958        EIBAID NOT = DFHPF4)
  6959         GO TO 8200-SEND-DATAONLY.
  6960
  6961     add ch-amount-paid to pi-prev-paid
  6962     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  6963     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  6964     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  6965     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  6966     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  6967     move pi-am-csr              to ch-csr
  6968     .
  6969 2100-WRITE-RECORD.
  6970
  6971* exec cics read
  6972*       dataset    (erchek-file-id)
  6973*       into       (ws-dummy-erchek)
  6974*       ridfld     (ch-control-primary)
  6975*       resp       (ws-response)
  6976*    end-exec
  6977     MOVE LENGTH OF
  6978      ws-dummy-erchek
  6979       TO DFHEIV11
  6980*    MOVE '&"IL       E          (  N#00006658' TO DFHEIV0
  6981     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6982     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6983     MOVE X'204E233030303036363538' TO DFHEIV0(25:11)
  6984     CALL 'kxdfhei1' USING DFHEIV0,
  6985           erchek-file-id,
  6986           ws-dummy-erchek,
  6987           DFHEIV11,
  6988           ch-control-primary,
  6989           DFHEIV99,
  6990           DFHEIV99,
  6991           DFHEIV99
  6992     MOVE EIBRESP  TO ws-response
  6993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6994     if RESP-NOTFND
  6995        continue
  6996     else
  6997        add +1 to ch-sequence-no
  6998        add 1 to seqi
  6999        go to 2100-write-record
  7000     end-if
  7001     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
  7002
  7003* EXEC CICS HANDLE CONDITION
  7004*        DUPREC (2200-DUPREC)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 125
* EL677.cbl
  7005*    END-EXEC.
  7006*    MOVE '"$%                   ! ( #00006672' TO DFHEIV0
  7007     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7009     MOVE X'2820233030303036363732' TO DFHEIV0(25:11)
  7010     CALL 'kxdfhei1' USING DFHEIV0
  7011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7012
  7013
  7014     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  7015     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  7016                                    CH-CHECK-QUE-SEQUENCE
  7017
  7018
  7019* EXEC CICS WRITE
  7020*        DATASET  (ERCHEK-FILE-ID)
  7021*        FROM     (CHECK-RECORDS)
  7022*        RIDFLD   (CH-CONTROL-PRIMARY)
  7023*        resp     (ws-response)
  7024*    END-EXEC.
  7025     MOVE LENGTH OF
  7026      CHECK-RECORDS
  7027       TO DFHEIV11
  7028*    MOVE '&$ L                  ''  N#00006680' TO DFHEIV0
  7029     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7030     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7031     MOVE X'204E233030303036363830' TO DFHEIV0(25:11)
  7032     CALL 'kxdfhei1' USING DFHEIV0,
  7033           ERCHEK-FILE-ID,
  7034           CHECK-RECORDS,
  7035           DFHEIV11,
  7036           CH-CONTROL-PRIMARY,
  7037           DFHEIV99,
  7038           DFHEIV99
  7039     MOVE EIBRESP  TO ws-response
  7040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7041
  7042     if resp-normal and pi-check-type = 'C'
  7043        move 'Y'                 to pi-check-cut
  7044     end-if
  7045     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  7046             ERCHEK-RECORD-LENGTH + 23.
  7047
  7048     if pi-check-type not = 'C'
  7049        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7050                                 THRU 6200-EXIT
  7051        if resp-normal
  7052           MOVE 'Y'              TO PB-C-REFUND-SW
  7053           add +1 to pi-chek-rec-cnt
  7054           perform 6210-rewrite-pndb
  7055                                 thru 6210-exit
  7056*          PERFORM 2700-WRITE-SQL THRU 2700-EXIT
  7057        end-if
  7058     end-if
  7059*    PERFORM 2500-WRITE-PAY-ADJ  THRU  2590-EXIT.
  7060
  7061     IF EMI-NO-ERRORS
  7062         MOVE ER-0000            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 126
* EL677.cbl
  7063     ELSE
  7064         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7065            EIBAID = DFHPF4
  7066             MOVE ER-2600        TO EMI-ERROR.
  7067
  7068     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7069
  7070     MOVE LOW-VALUES             TO EL677AI.
  7071
  7072     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7073     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7074     MOVE PI-CHEK-STATE          TO STATEO.
  7075     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7076
  7077     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7078     MOVE SPACE                  TO DC-OPTION-CODE.
  7079     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7080     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7081
  7082     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7083     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7084     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7085
  7086     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7087                                    ACCTA     EFFDTA  CERTNOA
  7088                                    SFXA.
  7089     MOVE AL-UNNON               TO SEQA.
  7090     go to 5000-browse-file
  7091     GO TO 8100-SEND-INITIAL-MAP.
  7092
  7093 2200-DUPREC.
  7094     ADD +1 TO CH-SEQUENCE-NO.
  7095     MOVE CH-SEQUENCE-NO         TO SEQO
  7096                                    PI-CHEK-SEQUENCE
  7097                                    CHEK-RECORD-SEQ.
  7098     GO TO 2100-WRITE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 127
* EL677.cbl
  7100
  7101 2500-WRITE-PAY-ADJ.
  7102
  7103     PERFORM 2600-READ-CONTROL-FILE THRU 2600-EXIT.
  7104
  7105     IF CH-AMOUNT-PAID = ZEROS
  7106         GO TO 2510-CONTINUE.
  7107     PERFORM 2550-BUILD-ERPYAJ-RECORD THRU 2559-BUILD-EXIT.
  7108     PERFORM 2570-WRITE-ERPYAJ-RECORD THRU 2579-WRITE-EXIT.
  7109
  7110 2510-CONTINUE.
  7111
  7112     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  7113         GO TO 2580-HANDLE-ELCNTL-FILE.
  7114
  7115 2550-BUILD-ERPYAJ-RECORD.
  7116
  7117
  7118* EXEC CICS GETMAIN
  7119*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7120*        LENGTH  (200)
  7121*        INITIMG (GETMAIN-SPACE)
  7122*    END-EXEC.
  7123     MOVE 200
  7124       TO DFHEIV11
  7125*    MOVE ',"IL                  $   #00006761' TO DFHEIV0
  7126     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7127     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7128     MOVE X'2020233030303036373631' TO DFHEIV0(25:11)
  7129     CALL 'kxdfhei1' USING DFHEIV0,
  7130           DFHEIV20,
  7131           DFHEIV11,
  7132           GETMAIN-SPACE
  7133     SET ADDRESS OF PENDING-PAY-ADJ TO
  7134         DFHEIV20
  7135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7136
  7137
  7138     MOVE SPACES                 TO PENDING-PAY-ADJ.
  7139     MOVE 'PY'                   TO PY-RECORD-ID.
  7140     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7141
  7142     MOVE CARRIERI               TO PY-CARRIER.
  7143     IF PI-ZERO-CARRIER  OR
  7144        PI-ZERO-CAR-GROUP
  7145         MOVE ZERO               TO PY-CARRIER.
  7146
  7147     MOVE GROUPI                 TO PY-GROUPING.
  7148     IF PI-ZERO-GROUPING  OR
  7149        PI-ZERO-CAR-GROUP
  7150         MOVE ZERO               TO PY-GROUPING.
  7151
  7152     MOVE PI-CR-FIN-RESP         TO PY-FIN-RESP.
  7153     MOVE PI-CR-ACCOUNT          TO PY-ACCOUNT.
  7154     MOVE 'C'                    TO PY-RECORD-TYPE.
  7155     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7156
  7157     MOVE SAVE-CURRENT-DATE-MDY  TO WS-PY-CURRENT-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 128
* EL677.cbl
  7158                                    WS-PY-REF-DATE
  7159                                    WS-PY-END-DATE
  7160                                    WS-PY-DED-DATE
  7161                                    WS-PY-ADDL-DATE.
  7162     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7163     MOVE CERTNOI                TO WS-PY-CURRENT-CERT
  7164                                    WS-PY-REF-CERT
  7165                                    WS-PY-END-CERT
  7166                                    WS-PY-DED-CERT
  7167                                    WS-PY-ADDL-CERT
  7168                                    WS-TMS-PY-CERT.
  7169     IF SFXI NOT = LOW-VALUES
  7170         MOVE SFXI               TO WS-PY-CURRENT-SUFFIX
  7171                                    WS-PY-REF-SUFFIX
  7172                                    WS-PY-END-SUFFIX
  7173                                    WS-PY-DED-SUFFIX
  7174                                    WS-PY-ADDL-SUFFIX
  7175     ELSE
  7176         MOVE SPACE              TO WS-PY-CURRENT-SUFFIX
  7177                                    WS-PY-REF-SUFFIX
  7178                                    WS-PY-END-SUFFIX
  7179                                    WS-PY-DED-SUFFIX
  7180                                    WS-PY-ADDL-SUFFIX.
  7181
  7182     IF PI-COMPANY-ID EQUAL 'TMS' OR 'LGX'
  7183         MOVE WS-TMS-ENTRY-COMMENT
  7184                                 TO PY-ENTRY-COMMENT
  7185     ELSE
  7186         IF TYPEI EQUAL 'R'
  7187             MOVE WS-PY-REF-COMMENT
  7188                                 TO PY-ENTRY-COMMENT
  7189         ELSE
  7190             IF TYPEI EQUAL 'E'
  7191                 MOVE WS-PY-END-COMMENT
  7192                                 TO PY-ENTRY-COMMENT
  7193             ELSE
  7194                 MOVE WS-PY-ENTRY-COMMENT
  7195                                 TO PY-ENTRY-COMMENT.
  7196
  7197     MOVE CH-AMOUNT-PAID         TO PY-ENTRY-AMT.
  7198
  7199     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7200     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7201     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7202                                    PY-INPUT-DT.
  7203*    MOVE +0                     TO PY-CHECK-QUE-CONTROL
  7204*                                   PY-CHECK-QUE-SEQUENCE.
  7205     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7206                                    PY-REPORTED-DT
  7207                                    PY-CHECK-WRITTEN-DT
  7208                                    PY-BILLED-DATE
  7209                                    PY-AR-DATE
  7210                                    PY-GL-DATE.
  7211     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7212     MOVE TYPEI                  TO PY-CHECK-ORIGIN-SW.
  7213*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7214
  7215     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 129
* EL677.cbl
  7216         MOVE 'B'                TO PY-PYMT-TYPE
  7217         MOVE 'A'                TO PY-PMT-APPLIED.
  7218
  7219 2559-BUILD-EXIT.
  7220     EXIT.
  7221
  7222 2570-WRITE-ERPYAJ-RECORD.
  7223
  7224
  7225* EXEC CICS HANDLE CONDITION
  7226*        DUPREC (2577-DUPREC)
  7227*    END-EXEC.
  7228*    MOVE '"$%                   ! ) #00006853' TO DFHEIV0
  7229     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7230     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7231     MOVE X'2920233030303036383533' TO DFHEIV0(25:11)
  7232     CALL 'kxdfhei1' USING DFHEIV0
  7233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7234
  7235
  7236
  7237* EXEC CICS WRITE
  7238*        DATASET (ERPYAJ-FILE-ID)
  7239*        FROM    (PENDING-PAY-ADJ)
  7240*        RIDFLD  (PY-CONTROL-PRIMARY)
  7241*    END-EXEC.
  7242     MOVE LENGTH OF
  7243      PENDING-PAY-ADJ
  7244       TO DFHEIV11
  7245*    MOVE '&$ L                  ''   #00006857' TO DFHEIV0
  7246     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7247     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7248     MOVE X'2020233030303036383537' TO DFHEIV0(25:11)
  7249     CALL 'kxdfhei1' USING DFHEIV0,
  7250           ERPYAJ-FILE-ID,
  7251           PENDING-PAY-ADJ,
  7252           DFHEIV11,
  7253           PY-CONTROL-PRIMARY,
  7254           DFHEIV99,
  7255           DFHEIV99
  7256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7257
  7258
  7259     GO TO 2579-WRITE-EXIT.
  7260
  7261 2577-DUPREC.
  7262     ADD +1 TO PY-FILE-SEQ-NO.
  7263
  7264     GO TO 2570-WRITE-ERPYAJ-RECORD.
  7265
  7266 2579-WRITE-EXIT.
  7267     EXIT.
  7268
  7269 2580-HANDLE-ELCNTL-FILE.
  7270
  7271     IF CR-CHECK-NO-AUTO-SEQ
  7272         PERFORM 2650-REWRITE-CONTROL-FILE THRU 2650-EXIT
  7273     ELSE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 130
* EL677.cbl
  7274
  7275* EXEC CICS UNLOCK
  7276*            DATASET (ELCNTL-FILE-ID)
  7277*        END-EXEC.
  7278*    MOVE '&*                    #   #00006878' TO DFHEIV0
  7279     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7280     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7281     MOVE X'2020233030303036383738' TO DFHEIV0(25:11)
  7282     CALL 'kxdfhei1' USING DFHEIV0,
  7283           ELCNTL-FILE-ID,
  7284           DFHEIV99
  7285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7286
  7287
  7288 2590-EXIT.
  7289      EXIT.
  7290
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 131
* EL677.cbl
  7292
  7293 2600-READ-CONTROL-FILE.
  7294     MOVE SPACES                 TO ELCNTL-KEY.
  7295     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  7296     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7297     MOVE +0                     TO ELCNTL-SEQ.
  7298
  7299
  7300* EXEC CICS HANDLE CONDITION
  7301*        NOTFND   (2600-NO-CO-MASTER)
  7302*    END-EXEC.
  7303*    MOVE '"$I                   ! * #00006893' TO DFHEIV0
  7304     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7305     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7306     MOVE X'2A20233030303036383933' TO DFHEIV0(25:11)
  7307     CALL 'kxdfhei1' USING DFHEIV0
  7308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7309
  7310
  7311
  7312* EXEC CICS READ
  7313*        DATASET   (ELCNTL-FILE-ID)
  7314*        SET       (ADDRESS OF CONTROL-FILE)
  7315*        RIDFLD    (ELCNTL-KEY)
  7316*    END-EXEC.
  7317*    MOVE '&"S        E          (   #00006897' TO DFHEIV0
  7318     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7319     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7320     MOVE X'2020233030303036383937' TO DFHEIV0(25:11)
  7321     CALL 'kxdfhei1' USING DFHEIV0,
  7322           ELCNTL-FILE-ID,
  7323           DFHEIV20,
  7324           DFHEIV99,
  7325           ELCNTL-KEY,
  7326           DFHEIV99,
  7327           DFHEIV99,
  7328           DFHEIV99
  7329     SET ADDRESS OF CONTROL-FILE TO
  7330         DFHEIV20
  7331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7332
  7333
  7334     GO TO 2600-EXIT
  7335
  7336     .
  7337 2600-NO-CO-MASTER.
  7338     MOVE ER-0022                TO  EMI-ERROR.
  7339     MOVE -1                     TO  CARRIERL.
  7340     MOVE AL-UABON               TO  CARRIERA.
  7341     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7342
  7343 2600-EXIT.
  7344      EXIT.
  7345
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 132
* EL677.cbl
  7347 2650-REWRITE-CONTROL-FILE.
  7348
  7349* EXEC CICS READ
  7350*        DATASET   (ELCNTL-FILE-ID)
  7351*        SET       (ADDRESS OF CONTROL-FILE)
  7352*        RIDFLD    (ELCNTL-KEY)
  7353*        UPDATE
  7354*    END-EXEC.
  7355*    MOVE '&"S        EU         (   #00006917' TO DFHEIV0
  7356     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7357     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7358     MOVE X'2020233030303036393137' TO DFHEIV0(25:11)
  7359     CALL 'kxdfhei1' USING DFHEIV0,
  7360           ELCNTL-FILE-ID,
  7361           DFHEIV20,
  7362           DFHEIV99,
  7363           ELCNTL-KEY,
  7364           DFHEIV99,
  7365           DFHEIV99,
  7366           DFHEIV99
  7367     SET ADDRESS OF CONTROL-FILE TO
  7368         DFHEIV20
  7369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7370
  7371
  7372
  7373* EXEC CICS REWRITE
  7374*         DATASET (ELCNTL-FILE-ID)
  7375*         FROM    (CONTROL-FILE)
  7376*     END-EXEC.
  7377     MOVE LENGTH OF
  7378      CONTROL-FILE
  7379       TO DFHEIV11
  7380*    MOVE '&& L                  %   #00006924' TO DFHEIV0
  7381     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7382     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7383     MOVE X'2020233030303036393234' TO DFHEIV0(25:11)
  7384     CALL 'kxdfhei1' USING DFHEIV0,
  7385           ELCNTL-FILE-ID,
  7386           CONTROL-FILE,
  7387           DFHEIV11,
  7388           DFHEIV99
  7389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7390
  7391
  7392 2650-EXIT.
  7393      EXIT.
  7394 2700-WRITE-SQL.
  7395     perform 2710-build-rec      thru 2710-exit
  7396     perform 2720-insert-row     thru 2720-exit
  7397     perform 4300-FINISH-UP-DB   thru 4300-exit
  7398     .
  7399 2700-EXIT.
  7400     EXIT.
  7401 2710-BUILD-REC.
  7402     move spaces                 to daily-check-request-rec
  7403     move pi-company-id          to db-compid
  7404     move ch-carrier             to db-carrier
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 133
* EL677.cbl
  7405                                    db-fincar
  7406     move ch-grouping            to db-grouping
  7407                                    db-fingrp
  7408     move ch-state               to db-state
  7409     move ch-account             to db-account
  7410     move ch-cert-eff-dt         to dc-bin-date-1
  7411     move ' '                    to dc-option-code
  7412     perform 8500-date-convert   thru 8500-exit
  7413     if no-conversion-error
  7414        move dc-greg-date-a-edit to db-effdate
  7415     else
  7416        move spaces              to db-effdate
  7417     end-if
  7418     move ch-cert-prime          to db-certificate
  7419     move ch-cert-sfx            to db-cert-sfx
  7420     move ch-sequence-no         to db-seq-no
  7421     move '1'                    to db-type
  7422                                    db-check-sub-type
  7423     if pi-check-type = 'C'
  7424        move '2'                 to db-check-sub-type
  7425     end-if
  7426     move ch-amount-paid         to db-amount-n
  7427     move zeros                  to db-checkstatus
  7428     move ch-check-que-control   to db-releasebatch
  7429     move save-bin-date          to dc-bin-date-1
  7430     move ' '                    to dc-option-code
  7431     perform 8500-date-convert   thru 8500-exit
  7432     if no-conversion-error
  7433        move dc-greg-date-a-edit to db-releasedt
  7434     else
  7435        move spaces              to db-releasedt
  7436     end-if
  7437     move pi-processor-id        to db-releaseby
  7438     move ch-payee-name-1        to db-payeename1
  7439     move ch-payee-name-2        to db-payeename2
  7440     move ch-payee-address-1     to db-payeeaddr1
  7441     move ch-payee-address-2     to db-payeeaddr2
  7442     move ch-payee-city          to db-payeecity
  7443     move ch-payee-state         to db-payeest
  7444     move ch-payee-zip-code      to db-payeezip
  7445     move ch-comp-fin-resp       to db-finresp
  7446     move ch-comp-account        to db-finacct
  7447     move ch-recorded-by         to db-preparer
  7448     move ch-return-to           to db-return-to
  7449     move pi-table-name          to db-insured-name
  7450     .
  7451 2710-EXIT.
  7452     EXIT.
  7453 2720-INSERT-ROW.
  7454     if not connected-to-db
  7455        perform 4100-CONNECT-TO-DB
  7456                                 thru 4100-exit
  7457     end-if
  7458     EXEC SQL
  7459        INSERT into ChkApp_Check (
  7460           Company,
  7461           CertCarrier,
  7462           CertGroup,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 134
* EL677.cbl
  7463           CertState,
  7464           CertAccount,
  7465           CertEffDate,
  7466           CertNumber,
  7467           CertNumberSuf,
  7468           CheckSeqNbr,
  7469           CheckType,
  7470           CheckAmount,
  7471           ReleaseBatchNbr,
  7472           ReleaseDate,
  7473           ReleasedBy,
  7474           PayeeName1,
  7475           PayeeName2,
  7476           PayeeAddress1,
  7477           PayeeAddress2,
  7478           PayeeCity,
  7479           PayeeState,
  7480           PayeeZip,
  7481           CompCarrier,
  7482           CompGroup,
  7483           CompFinResp,
  7484           CompAccount,
  7485           Preparer,
  7486           ReturnTo,
  7487           InsuredName,
  7488           CheckSubType)
  7489         VALUES (
  7490           :DB-CompId,
  7491           :DB-Carrier,
  7492           :DB-Grouping,
  7493           :DB-State,
  7494           :DB-Account,
  7495           :DB-EffDate,
  7496           :DB-Certificate,
  7497           :db-cert-sfx,
  7498           :DB-Seq-No,
  7499           :DB-Type,
  7500           :db-amount,
  7501           :db-releasebatch,
  7502           :db-releasedt,
  7503           :db-releaseby,
  7504           :db-payeename1,
  7505           :db-payeename2,
  7506           :db-payeeaddr1,
  7507           :db-payeeaddr2,
  7508           :db-payeecity,
  7509           :db-payeest,
  7510           :db-payeezip,
  7511           :db-fincar,
  7512           :db-fingrp,
  7513           :db-finresp,
  7514           :db-finacct,
  7515           :db-preparer,
  7516           :db-return-to,
  7517           :db-insured-name,
  7518           :db-check-sub-type)
  7519     END-EXEC
  7520     if sqlcode = -2601
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 135
* EL677.cbl
  7521        add +1                   to ch-sequence-no
  7522        move ch-sequence-no      to DB-Seq-No
  7523        go to 2720-insert-row
  7524     end-if
  7525     if sqlcode not = 0
  7526        display "Error: cannot insert row "
  7527        display ' sql return code ' sqlcode
  7528        move sqlcode to ws-sql-code
  7529        move ws-sql-code to ws-dis-sql-code
  7530        display ' dis sql code ' ws-dis-sql-code
  7531        display ' sql err mess    ' sqlerrmc
  7532        move sqlcode to ws-sql-code
  7533        move ws-sql-code to ws-dis-sql-code
  7534        string ws-dis-sql-code ' ' sqlerrmc (1:50)
  7535           into EMI-MESSAGE-AREA (1)
  7536        end-string
  7537        display ' msga1 ' emi-message-area (1)
  7538        perform 4300-FINISH-UP-DB thru 4300-exit
  7539        go to 8200-send-dataonly
  7540*       goback
  7541     end-if
  7542     .
  7543 2720-EXIT.
  7544     EXIT.
  7545 3000-CHANGE-RECORD.
  7546
  7547* EXEC CICS HANDLE CONDITION
  7548*        NOTFND (3900-RECORD-NOTFND)
  7549*    END-EXEC.
  7550*    MOVE '"$I                   ! + #00007083' TO DFHEIV0
  7551     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7553     MOVE X'2B20233030303037303833' TO DFHEIV0(25:11)
  7554     CALL 'kxdfhei1' USING DFHEIV0
  7555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7556
  7557
  7558
  7559* EXEC CICS READ
  7560*        DATASET  (ERCHEK-FILE-ID)
  7561*        SET      (ADDRESS OF CHECK-RECORDS)
  7562*        RIDFLD   (PI-ERCHEK-KEY)
  7563*        UPDATE
  7564*    END-EXEC.
  7565*    MOVE '&"S        EU         (   #00007087' TO DFHEIV0
  7566     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7567     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7568     MOVE X'2020233030303037303837' TO DFHEIV0(25:11)
  7569     CALL 'kxdfhei1' USING DFHEIV0,
  7570           ERCHEK-FILE-ID,
  7571           DFHEIV20,
  7572           DFHEIV99,
  7573           PI-ERCHEK-KEY,
  7574           DFHEIV99,
  7575           DFHEIV99,
  7576           DFHEIV99
  7577     SET ADDRESS OF CHECK-RECORDS TO
  7578         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 136
* EL677.cbl
  7579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7580
  7581
  7582     IF CH-LF-REFUND NOT NUMERIC
  7583         MOVE ZEROS              TO CH-LF-REFUND.
  7584     IF CH-AH-REFUND NOT NUMERIC
  7585         MOVE ZEROS              TO CH-AH-REFUND.
  7586*    IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7587*        MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7588*    IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7589*        MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7590
  7591     IF VREASONL NOT = ZEROS
  7592         MOVE VREASONI           TO  CH-VOID-REASON.
  7593
  7594     IF MAINTI = 'V'
  7595        GO TO 3050-void-processing
  7596     end-if
  7597
  7598     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7599
  7600     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7601
  7602     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7603       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7604        EIBAID NOT = DFHPF4)
  7605         GO TO 8200-SEND-DATAONLY.
  7606     go to 3100-rewrite-record
  7607     .
  7608 3050-void-processing.
  7609     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7610     if sqlcode = 0
  7611        perform 4200-get-tbl-row thru 4200-exit
  7612        if sqlcode = 0
  7613           if nu-app-date = -1
  7614              move -1            to maintl
  7615              move er-3453       to emi-error
  7616              move al-uabon      to mainta
  7617              perform 9900-error-format
  7618                                 thru 9900-exit
  7619              perform 4300-FINISH-UP-DB thru 4300-exit
  7620              go to 8200-send-dataonly
  7621           end-if
  7622        end-if
  7623        if connected-to-db
  7624           perform 4300-FINISH-UP-DB thru 4300-exit
  7625        end-if
  7626     end-if
  7627     if (ch-check-written-dt = low-values)
  7628        or (ch-check-no = spaces)
  7629        move -1                  to maintl
  7630        move er-3455             to emi-error
  7631        move al-uabon            to mainta
  7632        perform 9900-error-format
  7633                                 thru 9900-exit
  7634        perform 4300-FINISH-UP-DB thru 4300-exit
  7635        go to 8200-send-dataonly
  7636     end-if
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 137
* EL677.cbl
  7637     .
  7638 3100-REWRITE-RECORD.
  7639     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7640
  7641     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7642     MOVE '5'                    TO DC-OPTION-CODE.
  7643     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7644
  7645     IF MAINTI = 'C'
  7646       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7647     end-if
  7648*      IF MANUAL-CHECK-WRITTEN
  7649*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT.
  7650
  7651     IF MAINTI = 'V'
  7652        IF (CH-VOID-DT = LOW-VALUES)
  7653           and (pi-check-cashed = spaces)
  7654           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7655           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7656*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT
  7657           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7658           if pi-chek-rec-cnt = +1
  7659              PERFORM 6200-UPDATE-PENDING-BUS-REC
  7660                                 THRU 6200-EXIT
  7661              if resp-normal
  7662                 MOVE ' '        TO PB-C-REFUND-SW
  7663                 perform 6210-rewrite-pndb
  7664                                 thru 6210-exit
  7665              end-if
  7666           end-if
  7667        ELSE
  7668           MOVE -1               TO MAINTL
  7669           MOVE ER-2583          TO EMI-ERROR
  7670           MOVE AL-UABON         TO MAINTA
  7671           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7672           GO TO 8200-SEND-DATAONLY
  7673        end-if
  7674     end-if
  7675
  7676     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7677
  7678
  7679* EXEC CICS REWRITE
  7680*        DATASET  (ERCHEK-FILE-ID)
  7681*        FROM     (CHECK-RECORDS)
  7682*    END-EXEC.
  7683     MOVE LENGTH OF
  7684      CHECK-RECORDS
  7685       TO DFHEIV11
  7686*    MOVE '&& L                  %   #00007190' TO DFHEIV0
  7687     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7688     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7689     MOVE X'2020233030303037313930' TO DFHEIV0(25:11)
  7690     CALL 'kxdfhei1' USING DFHEIV0,
  7691           ERCHEK-FILE-ID,
  7692           CHECK-RECORDS,
  7693           DFHEIV11,
  7694           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 138
* EL677.cbl
  7695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7696
  7697
  7698     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
  7699        (MAINTI EQUAL 'C')          AND
  7700        (PI-PAYTO1 NOT EQUAL PAYTO1I)
  7701            PERFORM 3300-UPDATE-ERPYAJ THRU 3390-EXIT.
  7702
  7703     IF EMI-NO-ERRORS
  7704         MOVE ER-0000            TO EMI-ERROR
  7705     ELSE
  7706         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7707            EIBAID = DFHPF4
  7708             MOVE ER-2600        TO EMI-ERROR.
  7709
  7710     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7711
  7712     MOVE LOW-VALUES             TO EL677AI.
  7713
  7714     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7715     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7716     MOVE PI-CHEK-STATE          TO STATEO.
  7717     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7718
  7719     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7720     MOVE SPACE                  TO DC-OPTION-CODE.
  7721     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7722     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7723
  7724     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7725     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7726     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7727
  7728     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7729                                     ACCTA   EFFDTA
  7730                                    CERTNOA   SFXA.
  7731
  7732     MOVE AL-UNNON               TO SEQA.
  7733     go to 5000-browse-file
  7734*    GO TO 8100-SEND-INITIAL-MAP.
  7735
  7736     .
  7737 3200-PAY-ADJS-REVERSAL.
  7738
  7739     IF CH-AMOUNT-PAID NOT = ZEROS
  7740         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7741         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7742
  7743     GO TO 3290-EXIT
  7744     .
  7745 3250-BUILD-ERPYAJ-REVERSAL.
  7746
  7747
  7748* EXEC CICS GETMAIN
  7749*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7750*        LENGTH  (200)
  7751*        INITIMG (GETMAIN-SPACE)
  7752*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 139
* EL677.cbl
  7753     MOVE 200
  7754       TO DFHEIV11
  7755*    MOVE ',"IL                  $   #00007244' TO DFHEIV0
  7756     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7757     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7758     MOVE X'2020233030303037323434' TO DFHEIV0(25:11)
  7759     CALL 'kxdfhei1' USING DFHEIV0,
  7760           DFHEIV20,
  7761           DFHEIV11,
  7762           GETMAIN-SPACE
  7763     SET ADDRESS OF PENDING-PAY-ADJ TO
  7764         DFHEIV20
  7765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7766
  7767
  7768     MOVE 'PY'                   TO PY-RECORD-ID.
  7769     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7770
  7771     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7772     IF PI-ZERO-CARRIER  OR
  7773        PI-ZERO-CAR-GROUP
  7774         MOVE ZERO               TO PY-CARRIER.
  7775
  7776     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7777     IF PI-ZERO-GROUPING  OR
  7778        PI-ZERO-CAR-GROUP
  7779         MOVE ZERO               TO PY-GROUPING.
  7780
  7781     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7782     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7783     MOVE 'R'                    TO PY-RECORD-TYPE.
  7784     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7785     move '1825011300'           to py-gl-account
  7786     move 'VOID REFCK'           TO py-gl-comment
  7787     move ch-amount-paid         to py-entry-amt
  7788*    COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7789
  7790     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7791     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7792
  7793     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7794     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7795     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7796                                    PY-INPUT-DT.
  7797*    MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7798*                                   PY-CHECK-QUE-SEQUENCE.
  7799     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7800                                    PY-BILLED-DATE
  7801                                    PY-REPORTED-DT
  7802                                    PY-CHECK-WRITTEN-DT
  7803                                    PY-AR-DATE
  7804                                    PY-GL-DATE.
  7805     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7806     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7807*    MOVE 'V'                    TO PY-VOID-SW.
  7808*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7809
  7810     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 140
* EL677.cbl
  7811         MOVE 'B'                TO PY-PYMT-TYPE
  7812         MOVE 'A'                TO PY-PMT-APPLIED.
  7813
  7814 3259-BUILD-EXIT.
  7815     EXIT.
  7816
  7817 3280-WRITE-ERPYAJ-REVERSAL.
  7818
  7819
  7820* EXEC CICS HANDLE CONDITION
  7821*        DUPREC (3287-DUPREC)
  7822*    END-EXEC.
  7823*    MOVE '"$%                   ! , #00007301' TO DFHEIV0
  7824     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7825     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7826     MOVE X'2C20233030303037333031' TO DFHEIV0(25:11)
  7827     CALL 'kxdfhei1' USING DFHEIV0
  7828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7829
  7830
  7831
  7832* EXEC CICS WRITE
  7833*        DATASET (ERPYAJ-FILE-ID)
  7834*        FROM    (PENDING-PAY-ADJ)
  7835*        RIDFLD  (PY-CONTROL-PRIMARY)
  7836*    END-EXEC.
  7837     MOVE LENGTH OF
  7838      PENDING-PAY-ADJ
  7839       TO DFHEIV11
  7840*    MOVE '&$ L                  ''   #00007305' TO DFHEIV0
  7841     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7842     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7843     MOVE X'2020233030303037333035' TO DFHEIV0(25:11)
  7844     CALL 'kxdfhei1' USING DFHEIV0,
  7845           ERPYAJ-FILE-ID,
  7846           PENDING-PAY-ADJ,
  7847           DFHEIV11,
  7848           PY-CONTROL-PRIMARY,
  7849           DFHEIV99,
  7850           DFHEIV99
  7851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7852
  7853
  7854     GO TO 3289-WRITE-EXIT.
  7855
  7856 3287-DUPREC.
  7857     ADD +1 TO PY-FILE-SEQ-NO.
  7858
  7859     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7860
  7861 3289-WRITE-EXIT.
  7862     EXIT.
  7863
  7864 3290-EXIT.
  7865      EXIT.
  7866
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 141
* EL677.cbl
  7868 3300-UPDATE-ERPYAJ.
  7869
  7870
  7871* EXEC CICS GETMAIN
  7872*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7873*        LENGTH  (200)
  7874*        INITIMG (GETMAIN-SPACE)
  7875*    END-EXEC.
  7876     MOVE 200
  7877       TO DFHEIV11
  7878*    MOVE ',"IL                  $   #00007327' TO DFHEIV0
  7879     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7880     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7881     MOVE X'2020233030303037333237' TO DFHEIV0(25:11)
  7882     CALL 'kxdfhei1' USING DFHEIV0,
  7883           DFHEIV20,
  7884           DFHEIV11,
  7885           GETMAIN-SPACE
  7886     SET ADDRESS OF PENDING-PAY-ADJ TO
  7887         DFHEIV20
  7888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7889
  7890
  7891     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7892     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7893     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7894     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7895     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7896     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7897     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7898
  7899
  7900* EXEC CICS HANDLE CONDITION
  7901*        NOTFND   (3390-EXIT)
  7902*        ENDFILE  (3390-EXIT)
  7903*    END-EXEC.
  7904*    MOVE '"$I''                  ! - #00007341' TO DFHEIV0
  7905     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7906     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7907     MOVE X'2D20233030303037333431' TO DFHEIV0(25:11)
  7908     CALL 'kxdfhei1' USING DFHEIV0
  7909     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7910
  7911
  7912 3320-READNEXT-ERPYAJ.
  7913
  7914
  7915* EXEC CICS READ
  7916*        DATASET  (ERPYAJ-FILE-ID)
  7917*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7918*        RIDFLD   (ERPYAJ-KEY)
  7919*        GTEQ
  7920*    END-EXEC.
  7921*    MOVE '&"S        G          (   #00007348' TO DFHEIV0
  7922     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7923     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7924     MOVE X'2020233030303037333438' TO DFHEIV0(25:11)
  7925     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 142
* EL677.cbl
  7926           ERPYAJ-FILE-ID,
  7927           DFHEIV20,
  7928           DFHEIV99,
  7929           ERPYAJ-KEY,
  7930           DFHEIV99,
  7931           DFHEIV99,
  7932           DFHEIV99
  7933     SET ADDRESS OF PENDING-PAY-ADJ TO
  7934         DFHEIV20
  7935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7936
  7937
  7938     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7939
  7940     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7941        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7942        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7943        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7944        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7945        (PY-RECORD-TYPE   NOT = 'C')
  7946          GO TO 3390-EXIT.
  7947
  7948     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7949         ADD +1 TO PYAJ-FILE-SEQ-NO
  7950         GO TO 3320-READNEXT-ERPYAJ.
  7951
  7952
  7953* EXEC CICS READ UPDATE
  7954*        DATASET   (ERPYAJ-FILE-ID)
  7955*        RIDFLD    (ERPYAJ-KEY)
  7956*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  7957*    END-EXEC.
  7958*    MOVE '&"S        EU         (   #00007369' TO DFHEIV0
  7959     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7960     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7961     MOVE X'2020233030303037333639' TO DFHEIV0(25:11)
  7962     CALL 'kxdfhei1' USING DFHEIV0,
  7963           ERPYAJ-FILE-ID,
  7964           DFHEIV20,
  7965           DFHEIV99,
  7966           ERPYAJ-KEY,
  7967           DFHEIV99,
  7968           DFHEIV99,
  7969           DFHEIV99
  7970     SET ADDRESS OF PENDING-PAY-ADJ TO
  7971         DFHEIV20
  7972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7973
  7974
  7975     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7976     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  7977
  7978     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  7979
  7980     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7981     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7982     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7983
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 143
* EL677.cbl
  7984
  7985* EXEC CICS REWRITE
  7986*        DATASET  (ERPYAJ-FILE-ID)
  7987*        FROM     (PENDING-PAY-ADJ)
  7988*    END-EXEC.
  7989     MOVE LENGTH OF
  7990      PENDING-PAY-ADJ
  7991       TO DFHEIV11
  7992*    MOVE '&& L                  %   #00007384' TO DFHEIV0
  7993     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7994     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7995     MOVE X'2020233030303037333834' TO DFHEIV0(25:11)
  7996     CALL 'kxdfhei1' USING DFHEIV0,
  7997           ERPYAJ-FILE-ID,
  7998           PENDING-PAY-ADJ,
  7999           DFHEIV11,
  8000           DFHEIV99
  8001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8002
  8003
  8004 3390-EXIT.
  8005      EXIT.
  8006
  8007 3400-delete-record.
  8008
  8009* EXEC CICS READ
  8010*        DATASET  (ERCHEK-FILE-ID)
  8011*        SET      (ADDRESS OF CHECK-RECORDS)
  8012*        RIDFLD   (PI-ERCHEK-KEY)
  8013*        UPDATE
  8014*        resp     (ws-response)
  8015*    END-EXEC
  8016*    MOVE '&"S        EU         (  N#00007393' TO DFHEIV0
  8017     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8018     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8019     MOVE X'204E233030303037333933' TO DFHEIV0(25:11)
  8020     CALL 'kxdfhei1' USING DFHEIV0,
  8021           ERCHEK-FILE-ID,
  8022           DFHEIV20,
  8023           DFHEIV99,
  8024           PI-ERCHEK-KEY,
  8025           DFHEIV99,
  8026           DFHEIV99,
  8027           DFHEIV99
  8028     SET ADDRESS OF CHECK-RECORDS TO
  8029         DFHEIV20
  8030     MOVE EIBRESP  TO ws-response
  8031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8032     if (ch-in-limbo or ch-approv-pending)
  8033        and (ch-void-dt = low-values)
  8034        and (ch-check-written-dt = low-values)
  8035        and (ch-credit-accept-dt = low-values)
  8036        perform 3500-check-tbl   thru 3500-exit
  8037        if (row-deleted and tbl-commited)
  8038           or (emi-error = er-3450)
  8039
  8040* exec cics delete
  8041*             dataset   (erchek-file-id)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 144
* EL677.cbl
  8042*          end-exec
  8043*    MOVE '&(                    &   #00007407' TO DFHEIV0
  8044     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8045     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8046     MOVE X'2020233030303037343037' TO DFHEIV0(25:11)
  8047     CALL 'kxdfhei1' USING DFHEIV0,
  8048           erchek-file-id,
  8049           DFHEIV99,
  8050           DFHEIV99,
  8051           DFHEIV99,
  8052           DFHEIV99
  8053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8054        end-if
  8055     else
  8056        move -1               to maintl
  8057        move er-3452          to emi-error
  8058        move al-uabon         to mainta
  8059        perform 9900-error-format
  8060                                 thru 9900-exit
  8061        go to 8200-send-dataonly
  8062     end-if
  8063     if pi-chek-rec-cnt = +1
  8064        PERFORM 6200-UPDATE-PENDING-BUS-REC
  8065                                 THRU 6200-EXIT
  8066        if resp-normal
  8067           MOVE ' '              TO PB-C-REFUND-SW
  8068           perform 6210-rewrite-pndb
  8069                                 thru 6210-exit
  8070        end-if
  8071     end-if
  8072     MOVE ER-0000            TO EMI-ERROR
  8073     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8074     MOVE LOW-VALUES             TO EL677AI.
  8075     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  8076     MOVE PI-CHEK-GROUPING       TO GROUPO.
  8077     MOVE PI-CHEK-STATE          TO STATEO.
  8078     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  8079     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  8080     MOVE SPACE                  TO DC-OPTION-CODE.
  8081     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8082     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  8083     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  8084     MOVE PI-CHEK-SUF-NO         TO SFXO.
  8085     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  8086     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8087                                    ACCTA   EFFDTA
  8088                                    CERTNOA   SFXA.
  8089     MOVE AL-UNNON               TO SEQA.
  8090     GO TO 8100-SEND-INITIAL-MAP
  8091     .
  8092 3400-exit.
  8093     exit.
  8094 3500-check-tbl.
  8095     perform 4100-CONNECT-TO-DB  thru 4100-exit
  8096*    if sqlcode = 0
  8097*       perform 4150-open-cursor    thru 4150-exit
  8098*    end-if
  8099     if sqlcode = 0
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 145
* EL677.cbl
  8100        perform 4200-get-tbl-row thru 4200-exit
  8101     end-if
  8102      if sqlcode = 0
  8103         if (nu-app-date = -1)
  8104            or (db-app-status = '2')
  8105            perform 4250-delete-row thru 4250-exit
  8106         else
  8107           MOVE ER-3452            TO  EMI-ERROR
  8108           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8109           MOVE -1                 TO  PFENTERL
  8110           GO TO 8200-SEND-DATAONLY
  8111        end-if
  8112      else
  8113         MOVE ER-3450            TO  EMI-ERROR
  8114         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8115         MOVE -1                 TO  PFENTERL
  8116*        GO TO 8200-SEND-DATAONLY
  8117      end-if
  8118     if connected-to-db
  8119        perform 4300-FINISH-UP-DB thru 4300-exit
  8120     end-if
  8121     .
  8122 3500-exit.
  8123     exit.
  8124 3700-UPDATE-ERCHKQ.
  8125*    MOVE CH-COMPANY-CD          TO CHKQ-COMPANY-CD.
  8126*    MOVE CH-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NUMBER.
  8127*    MOVE CH-CHECK-QUE-SEQUENCE  TO CHKQ-SEQUENCE-NUMBER.
  8128*
  8129*    EXEC CICS HANDLE CONDITION
  8130*        NOTFND (3780-CHECK-NOTFND)
  8131*    END-EXEC.
  8132*
  8133*    EXEC CICS READ
  8134*        DATASET  (ERCHKQ-FILE-ID)
  8135*        SET      (ADDRESS OF CHECK-QUE)
  8136*        RIDFLD   (ERCHKQ-KEY)
  8137*        UPDATE
  8138*    END-EXEC.
  8139*
  8140*    IF MAINTI = 'C'
  8141*        IF MANUAL-CHECK-WRITTEN
  8142*            MOVE 'M'                 TO CQ-ENTRY-TYPE
  8143*            MOVE +1                  TO CQ-TIMES-PRINTED
  8144*            MOVE CH-CHECK-NO         TO CQ-CHECK-NUMBER
  8145*            MOVE CH-AMOUNT-PAID      TO CQ-CHECK-AMOUNT
  8146*            MOVE CH-CHECK-WRITTEN-DT TO CQ-CHECK-WRITTEN-DT.
  8147*
  8148*    IF MAINTI = 'V'
  8149*        MOVE 'V'                TO CQ-ENTRY-TYPE
  8150*                                   CQ-VOID-INDICATOR
  8151*        MOVE CH-VOID-DT         TO CQ-CHECK-VOIDED-DT.
  8152*
  8153*    MOVE CH-CHECK-REFERENCE     TO PI-REFERENCE.
  8154*
  8155*    EXEC CICS REWRITE
  8156*        DATASET  (ERCHKQ-FILE-ID)
  8157*        FROM     (CHECK-QUE)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 146
* EL677.cbl
  8158*    END-EXEC.
  8159*
  8160*    GO TO 3790-EXIT.
  8161*
  8162*3780-CHECK-NOTFND.
  8163*    MOVE ER-2905                TO EMI-ERROR.
  8164*    MOVE -1                     TO CARRIERL
  8165*    MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8166*                                   ACCTA     EFFDTA  CERTNOA
  8167*                                   SFXA      SEQA.
  8168*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8169     .
  8170 3790-EXIT.
  8171      EXIT.
  8172
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 147
* EL677.cbl
  8174
  8175 3900-RECORD-NOTFND.
  8176     MOVE ER-2908                TO EMI-ERROR.
  8177     MOVE -1                     TO CARRIERL
  8178     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8179                                    ACCTA     EFFDTA  CERTNOA
  8180                                    SFXA      SEQA.
  8181     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8182     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 148
* EL677.cbl
  8184 4000-ADD-CHANGE.
  8185     IF PAYTO1L NOT = ZEROS
  8186        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  8187     END-IF
  8188
  8189     IF PAYTO2L NOT = ZEROS
  8190         MOVE PAYTO2I            TO CH-PAYEE-NAME-2.
  8191
  8192     IF PAYAD1L NOT = ZEROS
  8193         MOVE PAYAD1I            TO CH-PAYEE-ADDRESS-1.
  8194
  8195     IF PAYAD2L NOT = ZEROS
  8196         MOVE PAYAD2I            TO CH-PAYEE-ADDRESS-2.
  8197
  8198     IF PAYctyL NOT = ZEROS
  8199         MOVE payctyi            TO CH-PAYEE-CITY.
  8200
  8201     IF PAYstL NOT = ZEROS
  8202         MOVE paysti            TO CH-PAYEE-state.
  8203
  8204     IF PAYEEI GREATER SPACES
  8205        MOVE PAYEEI              TO CH-PAYEE-CODE.
  8206
  8207     IF PTOZIPL  =  ZEROS
  8208         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  8209         GO TO 4000-CK-REST.
  8210
  8211     MOVE PTOZIPI                TO WS-ZIP-CODE.
  8212
  8213     IF NOT WS-CANADIAN-POST-CODE
  8214         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  8215         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  8216         GO TO 4000-CK-REST.
  8217
  8218     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  8219     IF WS-CAN-POST-4TH = SPACE OR '-'
  8220         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  8221         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  8222     ELSE
  8223         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  8224         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  8225
  8226 4000-CK-REST.
  8227
  8228     IF RETTOL NOT = ZEROS
  8229        MOVE RETTOI TO CH-RETURN-TO.
  8230     if dedcynl not = zeros
  8231        move dedcyni             to ch-deduct-commission
  8232     end-if
  8233     if dedcynl not = zeros
  8234        if (dedcyni = 'Y')
  8235           or (pi-prev-ded-comm = 'Y')
  8236           compute ws-amt =
  8237              pi-refund-on-pending-rec -
  8238                 pi-prev-paid - pi-ue-comm
  8239        else
  8240           if dedcyni = 'N'
  8241              compute ws-amt =
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 149
* EL677.cbl
  8242                 pi-refund-on-pending-rec -
  8243                    pi-prev-paid
  8244           end-if
  8245        end-if
  8246     end-if
  8247     if pi-check-type = 'C'
  8248        compute ws-amt =
  8249           pi-endt-prm-diff - pi-prev-paid
  8250        if (dedcyni = 'Y')
  8251           or (pi-prev-ded-comm = 'Y')
  8252           compute ws-amt =
  8253              ws-amt - pi-ue-comm
  8254        end-if
  8255        if ws-amt <= zeros
  8256           move pi-endt-prm-diff to ws-amt
  8257        end-if
  8258     end-if
  8259     IF AMOUNTL NOT = ZEROS
  8260         MOVE WS-AMT             TO CH-AMOUNT-PAID
  8261         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  8262
  8263     IF CHECKL NOT = ZEROS
  8264         MOVE CHECKI             TO CH-CHECK-NO.
  8265
  8266     IF REASONL NOT = ZEROS
  8267         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  8268
  8269*    IF DEDAMTL NOT = ZEROS
  8270*        MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  8271*                                   DEDAMTO.
  8272
  8273*    IF ADDLCHGL NOT = ZEROS
  8274*        MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  8275*                                   ADDLCHGO.
  8276
  8277     IF STUBL NOT = ZEROS
  8278         MOVE STUBI              TO CH-STUB-LINE-1.
  8279
  8280     IF TEXT1L NOT = ZEROS
  8281         MOVE TEXT1I             TO CH-TEXT-LINE-1.
  8282
  8283     IF TEXT2L NOT = ZEROS
  8284         MOVE TEXT2I             TO CH-TEXT-LINE-2.
  8285
  8286     IF TEXT3L NOT = ZEROS
  8287         MOVE TEXT3I             TO CH-TEXT-LINE-3.
  8288
  8289     IF TYPEL NOT = ZEROS
  8290         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  8291
  8292*    MOVE LETTER1I               TO CH-LETTERS (1).
  8293*    MOVE LETTER2I               TO CH-LETTERS (2).
  8294*    MOVE LETTER3I               TO CH-LETTERS (3).
  8295
  8296*    MOVE SPACES                 TO CH-CHECK-REFERENCE.
  8297     IF CH-CHECK-ORIGIN-SW = 'R'
  8298         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  8299*        MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 150
* EL677.cbl
  8300         MOVE PI-CANC-DT             TO CH-CANC-DT
  8301         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  8302         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  8303     end-if
  8304     MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  8305*    IF PI-AR-PROCESSING AND
  8306*       REFL NOT = ZERO
  8307*        MOVE REFI                   TO CH-CHECK-REFERENCE.
  8308
  8309 4000-EXIT.
  8310      EXIT.
  8311 4100-CONNECT-TO-DB.
  8312     move 'NTSQLTST2_Logic'      to svr
  8313     move 'sa'                   to usr
  8314     move 'sql2008r2'            to pass
  8315
  8316     if ws-kix-myenv = 'cid1p'
  8317        move 'NTCSO2_ChkApprv'   to svr
  8318        move 'sa'                to usr
  8319        move 'ntcso2'            to pass
  8320     end-if
  8321     string
  8322         usr delimited space
  8323         "." delimited size
  8324         pass delimited space into usr-pass
  8325     end-string
  8326     EXEC SQL
  8327        CONNECT TO :svr USER :usr-pass
  8328     END-EXEC
  8329     if sqlcode not = 0
  8330        display "Error: cannot connect "
  8331        display sqlcode
  8332        display sqlerrmc
  8333     end-if
  8334     set connected-to-db to true
  8335     .
  8336 4100-EXIT.
  8337     EXIT.
  8338 4150-open-cursor.
  8339     move pi-company-id          to ws-compid
  8340     move ch-carrier             to ws-carrier
  8341     move ch-grouping            to ws-grouping
  8342     move ch-state               to ws-state
  8343     move ch-account             to ws-account
  8344     move ch-cert-eff-dt         to dc-bin-date-1
  8345     move ' '                    to dc-option-code
  8346     perform 8500-date-convert   thru 8500-exit
  8347     if no-conversion-error
  8348        move dc-greg-date-a-edit to ws-eff-date
  8349     end-if
  8350     move ch-cert-prime          to ws-certificate
  8351     move ch-cert-sfx            to ws-cert-sfx
  8352     move ch-sequence-no         to ws-seq-no
  8353     move '1'                    to ws-type
  8354                                    ws-check-sub-type
  8355     if pi-check-type = 'C'
  8356        move '2'                 to ws-check-sub-type
  8357     end-if
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 151
* EL677.cbl
  8358     EXEC SQL
  8359        DECLARE
  8360           checkapp cursor for
  8361        SELECT
  8362           ApprovalStatus,
  8363           MaintainedBy,
  8364           MaintainedDate,
  8365           ApprovalBatch
  8366        FROM
  8367           ChkApp_Check
  8368        WHERE
  8369           Company           = :ws-compid
  8370           and CertCarrier   = :ws-carrier
  8371           and CertGroup     = :ws-grouping
  8372           and CertState     = :ws-state
  8373           and CertAccount   = :ws-account
  8374           and CertEffDate   = :ws-eff-date
  8375           and CertNumber    = :ws-certificate
  8376           and CertNumberSuf = :ws-cert-sfx
  8377           and CheckSeqNbr   = :ws-seq-no
  8378           and CheckType     = :ws-type
  8379           and CheckSubType  = :ws-check-sub-type
  8380     END-EXEC
  8381     if sqlcode not = 0
  8382        display "Error: cannot declare cursor "
  8383        display ' sql retrun code ' sqlcode
  8384        display ' sql err mess    ' sqlerrmc
  8385        go to 4150-exit
  8386     end-if
  8387     EXEC SQL
  8388        open checkapp
  8389     END-EXEC
  8390     if sqlcode not = 0
  8391        display "Error: cannot open cursor "
  8392        display ' sql retrun code ' sqlcode
  8393        display ' sql err mess    ' sqlerrmc
  8394     end-if
  8395     .
  8396 4150-exit.
  8397     exit.
  8398 4200-get-tbl-row.
  8399***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8400***                                                            ***
  8401***  I'm only expecting one row so no cursor is declared       ***
  8402***                                                            ***
  8403***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8404     move pi-company-id          to ws-compid
  8405     move ch-carrier             to ws-carrier
  8406     move ch-grouping            to ws-grouping
  8407     move ch-state               to ws-state
  8408     move ch-account             to ws-account
  8409     move ch-cert-eff-dt         to dc-bin-date-1
  8410     move ' '                    to dc-option-code
  8411     perform 8500-date-convert   thru 8500-exit
  8412     if no-conversion-error
  8413        move dc-greg-date-a-edit to ws-eff-date
  8414     end-if
  8415     move ch-cert-prime          to ws-certificate
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 152
* EL677.cbl
  8416     move ch-cert-sfx            to ws-cert-sfx
  8417     move ch-sequence-no         to ws-seq-no
  8418     move '1'                    to ws-type
  8419                                    ws-check-sub-type
  8420     if pi-check-type = 'C'
  8421        move '2'                 to ws-check-sub-type
  8422     end-if
  8423     exec sql
  8424        SELECT
  8425           ApprovalStatus,
  8426           MaintainedBy,
  8427           MaintainedDate,
  8428           ApprovalBatch
  8429        INTO
  8430           :db-app-status :nu-app-status,
  8431           :db-app-by :nu-app-by,
  8432           :db-app-date :nu-app-date,
  8433           :db-app-batch :nu-app-batch
  8434        FROM
  8435           ChkApp_Check
  8436        WHERE
  8437           Company           = :ws-compid
  8438           and CertCarrier   = :ws-carrier
  8439           and CertGroup     = :ws-grouping
  8440           and CertState     = :ws-state
  8441           and CertAccount   = :ws-account
  8442           and CertEffDate   = :ws-eff-date
  8443           and CertNumber    = :ws-certificate
  8444           and CertNumberSuf = :ws-cert-sfx
  8445           and CheckSeqNbr   = :ws-seq-no
  8446           and CheckType     = :ws-type
  8447           and CheckSubType  = :ws-check-sub-type
  8448     end-exec
  8449     if sqlcode not = 0
  8450        display "Error: cannot read row "
  8451        display ' sql return code ' sqlcode
  8452        display ' sql err mess    ' sqlerrmc
  8453        go to 4200-exit
  8454     end-if
  8455*    display ' status ' db-app-status
  8456*    display ' by     ' db-app-by
  8457*    display ' date   ' db-app-date
  8458*    display ' batch  ' db-app-batch
  8459*    if nu-app-date = -1
  8460*       display ' approval date is low-values '
  8461*    else
  8462*       display ' approval date is NOT low values '
  8463*    end-if
  8464     .
  8465 4200-exit.
  8466     exit.
  8467 4250-delete-row.
  8468     EXEC SQL
  8469        DELETE
  8470           from ChkApp_Check
  8471        WHERE
  8472           Company           = :ws-compid
  8473           and CertCarrier   = :ws-carrier
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 153
* EL677.cbl
  8474           and CertGroup     = :ws-grouping
  8475           and CertState     = :ws-state
  8476           and CertAccount   = :ws-account
  8477           and CertEffDate   = :ws-eff-date
  8478           and CertNumber    = :ws-certificate
  8479           and CertNumberSuf = :ws-cert-sfx
  8480           and CheckSeqNbr   = :ws-seq-no
  8481           and CheckType     = :ws-type
  8482           and CheckSubType  = :ws-check-sub-type
  8483     END-EXEC
  8484     if sqlcode not = 0
  8485        display "Error: cannot delete row  "
  8486        display ' sql retrun code ' sqlcode
  8487        display ' sql err mess    ' sqlerrmc
  8488        go to 4250-exit
  8489     end-if
  8490     set row-deleted         to true
  8491     EXEC SQL
  8492         commit transaction
  8493     END-EXEC
  8494     if sqlcode not = 0
  8495        display "Error: commit "
  8496        display ' sql return code ' sqlcode
  8497        display ' sql err mess    ' sqlerrmc
  8498        go to 4250-exit
  8499     end-if
  8500     set tbl-commited to true
  8501     .
  8502 4250-exit.
  8503     exit.
  8504 4300-FINISH-UP-DB.
  8505     EXEC SQL
  8506         commit work release
  8507     END-EXEC
  8508     if sqlcode not = 0
  8509        display "Error: commit release "
  8510        display ' sql return code ' sqlcode
  8511        display ' sql err mess    ' sqlerrmc
  8512     end-if
  8513     .
  8514 4300-EXIT.
  8515     EXIT.
  8516 5000-BROWSE-FILE.
  8517
  8518* EXEC CICS HANDLE CONDITION
  8519*        NOTFND   (5560-END-OF-FILE)
  8520*        ENDFILE  (5560-END-OF-FILE)
  8521*    END-EXEC.
  8522*    MOVE '"$I''                  ! . #00007873' TO DFHEIV0
  8523     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8524     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8525     MOVE X'2E20233030303037383733' TO DFHEIV0(25:11)
  8526     CALL 'kxdfhei1' USING DFHEIV0
  8527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8528
  8529
  8530     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  8531
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 154
* EL677.cbl
  8532     IF SEQI = LOW-VALUES
  8533         MOVE +1                 TO CHEK-RECORD-SEQ.
  8534
  8535     IF EIBAID = DFHPF2
  8536         GO TO 5100-BROWSE-BKWD.
  8537
  8538 5010-READ-LOOP.
  8539     IF EIBAID = DFHPF1
  8540         ADD +1                  TO CHEK-RECORD-SEQ.
  8541
  8542
  8543* EXEC CICS READ
  8544*        DATASET  (ERCHEK-FILE-ID)
  8545*        SET      (ADDRESS OF CHECK-RECORDS)
  8546*        RIDFLD   (ERCHEK-KEY)
  8547*        GTEQ
  8548*    END-EXEC.
  8549*    MOVE '&"S        G          (   #00007890' TO DFHEIV0
  8550     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8551     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8552     MOVE X'2020233030303037383930' TO DFHEIV0(25:11)
  8553     CALL 'kxdfhei1' USING DFHEIV0,
  8554           ERCHEK-FILE-ID,
  8555           DFHEIV20,
  8556           DFHEIV99,
  8557           ERCHEK-KEY,
  8558           DFHEIV99,
  8559           DFHEIV99,
  8560           DFHEIV99
  8561     SET ADDRESS OF CHECK-RECORDS TO
  8562         DFHEIV20
  8563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8564
  8565
  8566     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8567         IF EIBAID = DFHENTER
  8568             GO TO 5550-NO-RECORD
  8569         ELSE
  8570             GO TO 5560-END-OF-FILE.
  8571
  8572        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8573           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8574           PI-CHEK-STATE      = CH-STATE       AND
  8575           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8576           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8577           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8578           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8579              GO TO 5500-FORMAT-SCREEN
  8580            ELSE
  8581              IF EIBAID = DFHPF1
  8582                  GO TO 5560-END-OF-FILE
  8583                ELSE
  8584                  GO TO 5550-NO-RECORD.
  8585
  8586     IF EIBAID = DFHENTER
  8587        IF CHEK-CARRIER    = CH-CARRIER     AND
  8588           CHEK-GROUPING   = CH-GROUPING    AND
  8589           CHEK-STATE      = CH-STATE       AND
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 155
* EL677.cbl
  8590           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8591           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8592           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8593           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8594           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8595              GO TO 5500-FORMAT-SCREEN
  8596        ELSE
  8597              GO TO 5550-NO-RECORD.
  8598
  8599     GO TO 5500-FORMAT-SCREEN.
  8600
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 156
* EL677.cbl
  8602
  8603 5100-BROWSE-BKWD.
  8604
  8605* EXEC CICS STARTBR
  8606*        DATASET  (ERCHEK-FILE-ID)
  8607*        RIDFLD   (ERCHEK-KEY)
  8608*    END-EXEC.
  8609     MOVE 0
  8610       TO DFHEIV11
  8611*    MOVE '&,         G          &   #00007935' TO DFHEIV0
  8612     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8613     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8614     MOVE X'2020233030303037393335' TO DFHEIV0(25:11)
  8615     CALL 'kxdfhei1' USING DFHEIV0,
  8616           ERCHEK-FILE-ID,
  8617           ERCHEK-KEY,
  8618           DFHEIV99,
  8619           DFHEIV11,
  8620           DFHEIV99
  8621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8622
  8623
  8624
  8625* EXEC CICS READPREV
  8626*        DATASET  (ERCHEK-FILE-ID)
  8627*        SET      (ADDRESS OF CHECK-RECORDS)
  8628*        RIDFLD   (ERCHEK-KEY)
  8629*    END-EXEC.
  8630     MOVE 0
  8631       TO DFHEIV11
  8632*    MOVE '&0S                   )   #00007940' TO DFHEIV0
  8633     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8634     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8635     MOVE X'2020233030303037393430' TO DFHEIV0(25:11)
  8636     CALL 'kxdfhei1' USING DFHEIV0,
  8637           ERCHEK-FILE-ID,
  8638           DFHEIV20,
  8639           DFHEIV99,
  8640           ERCHEK-KEY,
  8641           DFHEIV99,
  8642           DFHEIV11,
  8643           DFHEIV99,
  8644           DFHEIV99
  8645     SET ADDRESS OF CHECK-RECORDS TO
  8646         DFHEIV20
  8647     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8648
  8649
  8650 5110-READ-LOOP.
  8651     IF PI-FILE-EOF
  8652         MOVE SPACE              TO PI-EOF-SW
  8653     ELSE
  8654
  8655* EXEC CICS READPREV
  8656*            DATASET  (ERCHEK-FILE-ID)
  8657*            SET      (ADDRESS OF CHECK-RECORDS)
  8658*            RIDFLD   (ERCHEK-KEY)
  8659*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 157
* EL677.cbl
  8660     MOVE 0
  8661       TO DFHEIV11
  8662*    MOVE '&0S                   )   #00007950' TO DFHEIV0
  8663     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8664     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8665     MOVE X'2020233030303037393530' TO DFHEIV0(25:11)
  8666     CALL 'kxdfhei1' USING DFHEIV0,
  8667           ERCHEK-FILE-ID,
  8668           DFHEIV20,
  8669           DFHEIV99,
  8670           ERCHEK-KEY,
  8671           DFHEIV99,
  8672           DFHEIV11,
  8673           DFHEIV99,
  8674           DFHEIV99
  8675     SET ADDRESS OF CHECK-RECORDS TO
  8676         DFHEIV20
  8677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8678
  8679
  8680     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8681         GO TO 5560-END-OF-FILE.
  8682
  8683        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8684           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8685           PI-CHEK-STATE      = CH-STATE       AND
  8686           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8687           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8688           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8689           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8690              GO TO 5500-FORMAT-SCREEN
  8691            ELSE
  8692              GO TO 5560-END-OF-FILE.
  8693
  8694     GO TO 5500-FORMAT-SCREEN.
  8695
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 158
* EL677.cbl
  8697*                          COPY ELCNPD.
  8698*****************************************************************
  8699*                                                               *
  8700*                                                               *
  8701*                            ELCNPD                             *
  8702*                            VMOD=2.001                         *
  8703*****************************************************************
  8704
  8705 5200-MOVE-NAME.
  8706*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8707*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8708*            BLANKS.                                            *
  8709*                                                               *
  8710*                  FIELD               VALUE                    *
  8711*                                                               *
  8712*                LAST NAME (CL15)      SMITH                    *
  8713*                1ST NAME  (CL12)      JOHN                     *
  8714*                MID NAME  (CL1)       A                        *
  8715*                                                               *
  8716*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8717*         *                                                     *
  8718*         *              JOHN A. SMITH                          *
  8719*         *                                                     *
  8720*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8721*         *  STORAGE COPYBOOK:                                  *
  8722*         *                                                     *
  8723*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8724*         *******************************************************.
  8725
  8726     MOVE SPACES                 TO  WS-NAME-WORK
  8727                                     WS-NAME-WORK2.
  8728     MOVE ZERO                   TO  WS-NAME-SW.
  8729     SET NWA-INDEX TO +1.
  8730
  8731     IF WS-INSURED-1ST-NAME = SPACES  AND
  8732        WS-INSURED-MID-INIT = SPACES
  8733         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8734         GO TO 5200-EXIT.
  8735
  8736     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8737     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8738
  8739     SET NWA-INDEX UP BY +1
  8740     IF WS-INSURED-MID-INIT NOT = SPACES
  8741        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8742        SET NWA-INDEX UP BY +1
  8743        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8744        SET NWA-INDEX UP BY +2.
  8745
  8746     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8747     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8748
  8749
  8750 5200-EXIT.
  8751     EXIT.
  8752
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 159
* EL677.cbl
  8754 5300-MOVE-NAME SECTION.
  8755     IF WS-NAME-SW GREATER THAN +1
  8756         GO TO 5390-EXIT.
  8757
  8758     IF WS-NAME-WORK2 = SPACES
  8759         GO TO 5390-EXIT.
  8760
  8761     SET NWA-INDEX2 TO +1.
  8762     SET NWA-INDEX3 TO +2.
  8763
  8764 5310-MOVE-NAME.
  8765     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8766
  8767     IF NWA-INDEX LESS THAN +30
  8768        SET NWA-INDEX UP BY +1
  8769     ELSE
  8770        ADD +2  TO  WS-NAME-SW
  8771        GO TO 5390-EXIT.
  8772
  8773     IF NWA-INDEX2 LESS THAN +20
  8774         SET NWA-INDEX2 UP BY +1
  8775         SET NWA-INDEX3 UP BY +1.
  8776
  8777     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8778        WS-NW2 (NWA-INDEX3) = SPACES
  8779        GO TO 5390-EXIT.
  8780
  8781     GO TO 5310-MOVE-NAME.
  8782
  8783 5390-EXIT.
  8784     EXIT.
  8785
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 160
* EL677.cbl
  8788 5500-FORMAT-SCREEN.
  8789     MOVE LOW-VALUES             TO  EL677AI.
  8790     MOVE 'S'                    TO  MAINTI   PI-PREV-MAINT.
  8791     MOVE +1                     TO  MAINTL.
  8792     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8793     MOVE CH-CARRIER             TO  CARRIERO.
  8794     MOVE CH-GROUPING            TO  GROUPO.
  8795     MOVE CH-STATE               TO  STATEO.
  8796     MOVE CH-ACCOUNT             TO  ACCTO.
  8797
  8798     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8799     MOVE SPACE                  TO  DC-OPTION-CODE.
  8800     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8801     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8802
  8803     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8804     MOVE CH-CERT-SFX            TO  SFXO.
  8805     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8806
  8807     MOVE AL-UANON               TO  CARRIERA
  8808                                     GROUPA
  8809                                     STATEA
  8810                                     ACCTA
  8811                                     EFFDTA
  8812                                     CERTNOA
  8813                                     SFXA.
  8814     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8815
  8816     if ch-approval-dt not = low-values
  8817        move ch-approval-dt      to dc-bin-date-1
  8818        move ' '                 to dc-option-code
  8819        perform 8500-date-convert thru 8500-exit
  8820        move dc-greg-date-1-edit to apvdto
  8821     end-if
  8822     evaluate ch-approval-status
  8823        when '2'
  8824           move 'PENDING '       TO APVSTATO
  8825        when 'P'
  8826           move 'PENDING '       TO APVSTATO
  8827        when 'A'
  8828           move 'APPROVED'       to apvstato
  8829        when 'D'
  8830           move 'DENIED'         to apvstato
  8831     end-evaluate
  8832     move ch-approved-by         to apvbyo
  8833*    IF PI-COMPANY-ID = 'TMS'
  8834*        MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8835*        MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8836*    ELSE
  8837         MOVE CH-PAYEE-NAME-1    TO  PAYTO1O
  8838         MOVE CH-PAYEE-NAME-2    TO  PAYTO2O.
  8839
  8840     MOVE CH-PAYEE-ADDRESS-1     TO  PAYAD1O.
  8841     MOVE CH-PAYEE-ADDRESS-2     TO  PAYAD2O.
  8842     move ch-payee-city          to payctyo
  8843     move ch-payee-state         to paysto
  8844     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8845
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 161
* EL677.cbl
  8846     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8847         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8848         MOVE AL-UANON           TO  PTOZIPA.
  8849
  8850     MOVE CH-RETURN-TO           TO  RETTOO
  8851*    if ch-check-cashed-dt not = spaces and low-values
  8852*       move ch-check-cashed-dt  to dc-bin-date-1
  8853*       MOVE SPACE               TO  DC-OPTION-CODE
  8854*       PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8855*       MOVE DC-GREG-DATE-1-EDIT TO  CASHEDO
  8856*    end-if
  8857     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8858     MOVE SPACE                  TO  DC-OPTION-CODE.
  8859     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8860     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8861
  8862     MOVE CH-RECORDED-BY         TO  CBYO.
  8863
  8864     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8865         NEXT SENTENCE
  8866     ELSE
  8867         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8868         MOVE SPACE                  TO  DC-OPTION-CODE
  8869         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8870         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8871         MOVE CH-VOID-BY             TO  VBYO.
  8872
  8873     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8874         NEXT SENTENCE
  8875     ELSE
  8876         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8877         MOVE SPACE                  TO  DC-OPTION-CODE
  8878         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8879         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8880
  8881     MOVE CH-AMOUNT-PAID         TO  AMOUNTO.
  8882     MOVE AL-SANOF               TO  AMOUNTA.
  8883     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8884     MOVE AL-SANOF               TO  TYPEA.
  8885     MOVE CH-CHECK-NO            TO  CHECKO.
  8886     move ch-deduct-commission   to dedcyno
  8887     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8888     MOVE CH-VOID-REASON         TO  VREASONO.
  8889
  8890     MOVE CH-STUB-LINE-1         TO  STUBO.
  8891     MOVE CH-TEXT-LINE-1         TO  TEXT1O.
  8892     MOVE CH-TEXT-LINE-2         TO  TEXT2O.
  8893     MOVE CH-TEXT-LINE-3         TO  TEXT3O.
  8894     IF CH-LF-REFUND NOT NUMERIC
  8895         MOVE ZEROS              TO CH-LF-REFUND.
  8896     IF CH-AH-REFUND NOT NUMERIC
  8897         MOVE ZEROS              TO CH-AH-REFUND.
  8898     if (ch-check-no not = spaces and low-values)
  8899        and (ch-check-written-dt not = low-values)
  8900        perform 5800-fetch-check-cashed-dt
  8901                                 thru 5800-exit
  8902     end-if
  8903     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 162
* EL677.cbl
  8904        CH-VOID-DT          GREATER LOW-VALUES
  8905        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8906                                     STUBA     TEXT1A   TEXT2A
  8907                                     TEXT3A    PAYTO1A  SFXA
  8908                                     PAYTO2A   PAYAD1A  PAYctyA
  8909                                     paysta    RETTOA   PAYAD2A
  8910                                     PTOZIPA
  8911                                     PRINTEDA
  8912     ELSE
  8913        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8914                                     ACCTA     EFFDTA   CERTNOA
  8915                                     CHECKA    REASONA  VREASONA
  8916                                     STUBA     TEXT1A   TEXT2A
  8917                                     TEXT3A    PAYTO1A  SFXA
  8918                                     PAYTO2A   PAYAD1A  PAYctyA
  8919                                     paysta    RETTOA   PAYAD2A
  8920                                     PRINTEDA.
  8921
  8922     MOVE AL-UNNON               TO SEQA.
  8923     perform 5600-get-erpndb     thru 5600-exit
  8924     perform 5700-get-elcert     thru 5700-exit
  8925*    move pi-prev-paid           to prepdo
  8926     move al-sadof               to drefa
  8927*    if WS-PNDB-FOUND
  8928*       compute refo = pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8929*    end-if
  8930     if WS-CERT-FOUND
  8931        compute ws-tot-lf-prem = cm-lf-premium-amt +
  8932           cm-lf-alt-premium-amt
  8933        compute ws-tot-iss-prem  =
  8934           cm-ah-premium-amt + ws-tot-lf-prem
  8935        compute ws-tot-iss-comm =
  8936           (ws-tot-lf-prem * cm-life-comm-pct) +
  8937           (cm-ah-premium-amt * cm-ah-comm-pct)
  8938        compute ws-tot-ref-comm =
  8939           (pi-lf-refund * cm-life-comm-pct) +
  8940           (pi-ah-refund * cm-ah-comm-pct)
  8941        move ws-tot-iss-prem     to premo
  8942        move ws-tot-iss-comm     to isscommo
  8943*       move ws-tot-ref-comm     to uecommo
  8944     end-if
  8945     if PI-TO-EL677-FROM-EL1273
  8946        move zeros               to premo
  8947                                    isscommo
  8948                                    uecommo
  8949                                    prepdo
  8950                                    refo
  8951     end-if
  8952     GO TO 8100-SEND-INITIAL-MAP
  8953     .
  8954 5550-NO-RECORD.
  8955     MOVE ER-1162                TO  EMI-ERROR.
  8956     MOVE -1                     TO  CARRIERL.
  8957     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  8958                                     ACCTA     EFFDTA  CERTNOA
  8959                                     SFXA      SEQA.
  8960     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8961
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 163
* EL677.cbl
  8962     IF (NOT PI-TO-EL677-FROM-EL1273)
  8963        and (pi-return-to-program not = 'EL6315')
  8964         GO TO 8200-SEND-DATAONLY.
  8965
  8966     MOVE CHEK-CARRIER           TO  CARRIERO.
  8967     MOVE CHEK-GROUPING          TO  GROUPO.
  8968     MOVE CHEK-STATE             TO  STATEO.
  8969     MOVE CHEK-ACCOUNT           TO  ACCTO.
  8970
  8971     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  8972     MOVE SPACE                  TO  DC-OPTION-CODE.
  8973     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8974     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8975
  8976     MOVE CHEK-CERT-NO           TO  CERTNOO.
  8977     MOVE CHEK-SUF-NO            TO  SFXO.
  8978     GO TO 8100-SEND-INITIAL-MAP.
  8979
  8980 5560-END-OF-FILE.
  8981     IF EIBAID = DFHPF1
  8982         MOVE 'Y'                TO  PI-EOF-SW
  8983         MOVE ER-2237            TO  EMI-ERROR
  8984     ELSE
  8985     IF EIBAID = DFHENTER
  8986        GO TO 5550-NO-RECORD
  8987     ELSE
  8988*        MOVE SPACES             TO  PI-ERCHEK-KEY
  8989         MOVE ER-2238            TO  EMI-ERROR.
  8990
  8991     MOVE -1                     TO  MAINTL.
  8992     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8993     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 164
* EL677.cbl
  8995 5600-get-erpndb.
  8996     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  8997     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  8998     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  8999     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  9000     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  9001     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  9002     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  9003     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  9004     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  9005     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  9006     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  9007     IF ST-ACCNT-CNTL  OR
  9008        ACCNT-CNTL
  9009          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9010     IF ST-ACCNT-CNTL      OR
  9011        CARR-ST-ACCNT-CNTL OR
  9012        ACCNT-CNTL         OR
  9013        CARR-ACCNT-CNTL
  9014          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9015     IF ACCNT-CNTL OR
  9016        CARR-ACCNT-CNTL
  9017          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9018
  9019* EXEC CICS READ
  9020*         DATASET   (ERPNDB-ALT-FILE-ID)
  9021*         SET       (ADDRESS OF PENDING-BUSINESS)
  9022*         RIDFLD    (ERPNDB-ALT-KEY)
  9023*         resp      (ws-response)
  9024*    END-EXEC
  9025*    MOVE '&"S        E          (  N#00008294' TO DFHEIV0
  9026     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9027     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9028     MOVE X'204E233030303038323934' TO DFHEIV0(25:11)
  9029     CALL 'kxdfhei1' USING DFHEIV0,
  9030           ERPNDB-ALT-FILE-ID,
  9031           DFHEIV20,
  9032           DFHEIV99,
  9033           ERPNDB-ALT-KEY,
  9034           DFHEIV99,
  9035           DFHEIV99,
  9036           DFHEIV99
  9037     SET ADDRESS OF PENDING-BUSINESS TO
  9038         DFHEIV20
  9039     MOVE EIBRESP  TO ws-response
  9040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9041     if resp-normal
  9042        MOVE 'Y'                 TO WS-PNDB-FOUND-SW
  9043        compute pi-refund-on-pending-rec =
  9044           pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  9045     end-if
  9046     .
  9047 5600-exit.
  9048     exit.
  9049 5700-get-elcert.
  9050     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9051     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9052     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 165
* EL677.cbl
  9053     MOVE PI-STATE               TO  ELCERT-STATE.
  9054     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9055     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9056     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9057     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9058     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9059
  9060* EXEC CICS READ
  9061*         DATASET   (ELCERT-FILE-ID)
  9062*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9063*         RIDFLD    (ELCERT-KEY)
  9064*         resp      (ws-response)
  9065*    END-EXEC
  9066*    MOVE '&"S        E          (  N#00008318' TO DFHEIV0
  9067     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9068     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9069     MOVE X'204E233030303038333138' TO DFHEIV0(25:11)
  9070     CALL 'kxdfhei1' USING DFHEIV0,
  9071           ELCERT-FILE-ID,
  9072           DFHEIV20,
  9073           DFHEIV99,
  9074           ELCERT-KEY,
  9075           DFHEIV99,
  9076           DFHEIV99,
  9077           DFHEIV99
  9078     SET ADDRESS OF CERTIFICATE-MASTER TO
  9079         DFHEIV20
  9080     MOVE EIBRESP  TO ws-response
  9081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9082     if resp-normal
  9083        MOVE 'Y'                 TO WS-CERT-FOUND-SW
  9084     end-if
  9085     .
  9086 5700-exit.
  9087     exit.
  9088 5800-fetch-check-cashed-dt.
  9089     move ' '                    to ws-connect-sw
  9090                                    ws-match-sw
  9091                                    pi-check-cashed
  9092     move 'NTCSO2_PdBnkInfo'     to svr
  9093     move 'sa'                   to usr
  9094     move 'ntcso2'               to pass
  9095     string
  9096         usr delimited space
  9097         "." delimited size
  9098         pass delimited space into usr-pass
  9099     end-string
  9100     EXEC SQL
  9101        CONNECT TO :svr USER :usr-pass
  9102     END-EXEC
  9103     if sqlcode not = 0
  9104        display "Error: cannot connect to pdbnkinfo "
  9105        display sqlcode
  9106        display sqlerrmc
  9107        go to 5800-exit
  9108     end-if
  9109     set connected-to-db to true
  9110     if pi-company-id = 'CID'
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 166
* EL677.cbl
  9111        move 'CSO - AP%'         to ws-pb-compid
  9112     else
  9113        move 'AHL - AP%'         to ws-pb-compid
  9114     end-if
  9115     move '000'                  to ws-pb-check-no (1:3)
  9116     move ch-check-no            to ws-pb-check-no (4:7)
  9117     move spaces                 to ws-pb-bad-check-no
  9118     perform varying s1 from +1 by +1 until
  9119        (s1 > +10)
  9120        or (ws-pb-check-no (s1:1) not = '0')
  9121     end-perform
  9122     if s1 < +11
  9123        move ws-pb-check-no (s1:11 - s1)
  9124                            to ws-pb-bad-check-no (1: 11 - s1)
  9125     end-if
  9126*    display ' compid **' ws-pb-compid '**'
  9127*    display ' ckno  **' ws-pb-check-no '**'
  9128     MOVE ch-AMOUNT-PAID      TO WS-CHECK-AMT-TMP
  9129     MOVE WS-CHECK-AMT-TMPX   TO WS-CHECK-AMOUNT
  9130     MOVE SPACES              TO pb-paid-date
  9131
  9132     EXEC SQL
  9133        CALL pbi_GetCashDate_by_TransactionNbr
  9134           @compid          = :ws-pb-compid,
  9135           @checkno         = :ws-pb-check-no,
  9136           @badcheckno      = :ws-pb-bad-check-no,
  9137           @checkamount     = :ws-check-amount,
  9138           @checkcasheddate = :pb-paid-date OUT
  9139     END-EXEC
  9140     if sqlcode not = 0
  9141        display "Error: cannot run stor proc  "
  9142        move sqlcode            to ws-sql-code
  9143        move ws-sql-code to ws-dis-sql-code
  9144        display ' dis sql code ' ws-dis-sql-code
  9145        display ' sql return code ' sqlcode
  9146        display ' sql err mess    ' sqlerrmc
  9147        go to 5800-disconnect
  9148     end-if
  9149***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9150***                                                            ***
  9151***  The following code works just as well as the above        ***
  9152***  stored procedure and just as fast.                        ***
  9153***  Originally, I had declared a cursor and fetched through   ***
  9154***  the record set to find the correct check and that REALLY  ***
  9155***  slowed the response down to ~ 3/4 second.                 ***
  9156***                                                            ***
  9157***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9158*     EXEC SQL
  9159*        SELECT
  9160*           PaidDate
  9161*        INTO
  9162*           :pb-paid-date
  9163*        FROM
  9164*           dbo.cso_pbi_TransactionLookup
  9165*        WHERE
  9166*           (BankAcctDescr like :ws-pb-compid)
  9167*           and (Amount = :ws-check-amount)
  9168*           and ((transactionNbr = :ws-pb-check-no)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 167
* EL677.cbl
  9169*                  or
  9170*               (transactionnbr = :ws-pb-bad-check-no))
  9171**          and (CAST(TransactionNbr AS INT) =
  9172**             :ws-pb-check-no-num)
  9173**          and (right('00000' + rtrim(TransactionNbr),10)
  9174**             = :ws-pb-check-no)
  9175**          and (TransactionNbr  = :ws-pb-check-no)
  9176*     END-EXEC
  9177*    display ' chkno  ' pb-check-no
  9178*    display ' desc   ' pb-bank-acct-desc
  9179*    display ' trn typ' pb-tran-type
  9180*    display ' amt   *' pb-amount '**'
  9181*    display ' pd dte ' pb-paid-date
  9182     string pb-paid-date (7:4)
  9183            pb-paid-date (1:2)
  9184            pb-paid-date (4:2)
  9185        delimited by size into dc-greg-date-cymd-r
  9186     end-string
  9187     move 'L'                    to dc-option-code
  9188     perform 8500-date-convert   thru 8500-exit
  9189     if no-conversion-error
  9190*       move dc-bin-date-1       to ws-bin-cashed-dt
  9191        move dc-greg-date-1-edit to cashedo
  9192        move 'Y' to pi-check-cashed
  9193     else
  9194        display ' error cvtdte cash dt ' pb-paid-date ' '
  9195           dc-error-code
  9196     end-if
  9197     .
  9198 5800-disconnect.
  9199     EXEC SQL
  9200        DISCONNECT ALL
  9201     END-EXEC
  9202     if sqlcode not = 0
  9203        display "Error: cannot disconnect pdbnk "
  9204        display ' sql return code ' sqlcode
  9205        display ' sql err mess    ' sqlerrmc
  9206     end-if
  9207     .
  9208 5800-exit.
  9209     exit.
  9210 6000-VERIFY-COMP-MASTER.
  9211
  9212* EXEC CICS HANDLE CONDITION
  9213*        NOTFND   (6070-NO-COMP-MSTR)
  9214*    END-EXEC.
  9215*    MOVE '"$I                   ! / #00008453' TO DFHEIV0
  9216     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9217     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9218     MOVE X'2F20233030303038343533' TO DFHEIV0(25:11)
  9219     CALL 'kxdfhei1' USING DFHEIV0
  9220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9221
  9222
  9223     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  9224
  9225     IF NOT PI-ZERO-CARRIER AND
  9226        NOT PI-ZERO-CAR-GROUP
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 168
* EL677.cbl
  9227         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  9228     ELSE
  9229         MOVE ZEROS              TO  ERCOMP-CARRIER.
  9230
  9231     IF NOT PI-ZERO-GROUPING  AND
  9232        NOT PI-ZERO-CAR-GROUP
  9233         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
  9234     ELSE
  9235         MOVE ZEROS              TO  ERCOMP-GROUPING.
  9236
  9237     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  9238     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  9239     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  9240
  9241
  9242* EXEC CICS READ
  9243*         DATASET   (ERCOMP-FILE-ID)
  9244*         SET       (ADDRESS OF COMPENSATION-MASTER)
  9245*         RIDFLD    (ERCOMP-KEY)
  9246*     END-EXEC.
  9247*    MOVE '&"S        E          (   #00008475' TO DFHEIV0
  9248     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9249     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9250     MOVE X'2020233030303038343735' TO DFHEIV0(25:11)
  9251     CALL 'kxdfhei1' USING DFHEIV0,
  9252           ERCOMP-FILE-ID,
  9253           DFHEIV20,
  9254           DFHEIV99,
  9255           ERCOMP-KEY,
  9256           DFHEIV99,
  9257           DFHEIV99,
  9258           DFHEIV99
  9259     SET ADDRESS OF COMPENSATION-MASTER TO
  9260         DFHEIV20
  9261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9262
  9263
  9264     GO TO 6090-EXIT.
  9265
  9266 6070-NO-COMP-MSTR.
  9267     MOVE -1                     TO  CARRIERL.
  9268     MOVE ER-2230                TO  EMI-ERROR.
  9269     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9270     GO TO 8200-SEND-DATAONLY.
  9271
  9272 6090-EXIT.
  9273      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 169
* EL677.cbl
  9275 6100-VERIFY-CERTIFICATE.
  9276
  9277* EXEC CICS HANDLE CONDITION
  9278*        NOTFND   (6170-NO-CERTIFICATE)
  9279*    END-EXEC.
  9280*    MOVE '"$I                   ! 0 #00008493' TO DFHEIV0
  9281     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9283     MOVE X'3020233030303038343933' TO DFHEIV0(25:11)
  9284     CALL 'kxdfhei1' USING DFHEIV0
  9285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9286
  9287
  9288     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9289     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9290     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  9291     MOVE PI-STATE               TO  ELCERT-STATE.
  9292     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9293     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9294     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9295     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9296
  9297     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9298
  9299     MOVE SPACES                 TO  PI-REFERENCE
  9300*                                    PI-INSURED-NAME.
  9301     MOVE LOW-VALUES             TO  PI-CANC-DT.
  9302     MOVE ZEROS                  TO  PI-LF-REFUND
  9303                                     PI-AH-REFUND.
  9304
  9305
  9306* EXEC CICS READ
  9307*         DATASET   (ELCERT-FILE-ID)
  9308*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9309*         RIDFLD    (ELCERT-KEY)
  9310*     END-EXEC.
  9311*    MOVE '&"S        E          (   #00008514' TO DFHEIV0
  9312     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9313     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9314     MOVE X'2020233030303038353134' TO DFHEIV0(25:11)
  9315     CALL 'kxdfhei1' USING DFHEIV0,
  9316           ELCERT-FILE-ID,
  9317           DFHEIV20,
  9318           DFHEIV99,
  9319           ELCERT-KEY,
  9320           DFHEIV99,
  9321           DFHEIV99,
  9322           DFHEIV99
  9323     SET ADDRESS OF CERTIFICATE-MASTER TO
  9324         DFHEIV20
  9325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9326
  9327
  9328     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  9329
  9330     MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  9331     MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  9332     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 170
* EL677.cbl
  9333         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  9334     ELSE
  9335         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9336             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  9337*    MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  9338
  9339     GO TO 6190-EXIT.
  9340
  9341 6170-NO-CERTIFICATE.
  9342     MOVE -1                     TO  CARRIERL.
  9343     MOVE ER-2726                TO  EMI-ERROR.
  9344     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9345
  9346 6190-EXIT.
  9347      EXIT.
  9348
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 171
* EL677.cbl
  9350 6200-UPDATE-PENDING-BUS-REC.
  9351     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  9352     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  9353     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  9354     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  9355     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  9356     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  9357     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  9358     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  9359     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  9360     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  9361
  9362     IF ST-ACCNT-CNTL  OR
  9363        ACCNT-CNTL
  9364          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9365
  9366     IF ST-ACCNT-CNTL      OR
  9367        CARR-ST-ACCNT-CNTL OR
  9368        ACCNT-CNTL         OR
  9369        CARR-ACCNT-CNTL
  9370          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9371
  9372     IF ACCNT-CNTL OR
  9373        CARR-ACCNT-CNTL
  9374          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9375
  9376
  9377* EXEC CICS READ
  9378*         DATASET   (ERPNDB-ALT-FILE-ID)
  9379*         SET       (ADDRESS OF PENDING-BUSINESS)
  9380*         RIDFLD    (ERPNDB-ALT-KEY)
  9381*         resp      (ws-response)
  9382*     END-EXEC.
  9383*    MOVE '&"S        E          (  N#00008568' TO DFHEIV0
  9384     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9385     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9386     MOVE X'204E233030303038353638' TO DFHEIV0(25:11)
  9387     CALL 'kxdfhei1' USING DFHEIV0,
  9388           ERPNDB-ALT-FILE-ID,
  9389           DFHEIV20,
  9390           DFHEIV99,
  9391           ERPNDB-ALT-KEY,
  9392           DFHEIV99,
  9393           DFHEIV99,
  9394           DFHEIV99
  9395     SET ADDRESS OF PENDING-BUSINESS TO
  9396         DFHEIV20
  9397     MOVE EIBRESP  TO ws-response
  9398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9399
  9400
  9401     if not resp-normal
  9402        go to 6200-exit
  9403     end-if
  9404     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  9405
  9406
  9407* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 172
* EL677.cbl
  9408*         DATASET   (ERPNDB-FILE-ID)
  9409*         SET       (ADDRESS OF PENDING-BUSINESS)
  9410*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  9411*         UPDATE
  9412*         resp      (ws-response)
  9413*     END-EXEC.
  9414*    MOVE '&"S        EU         (  N#00008580' TO DFHEIV0
  9415     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9416     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9417     MOVE X'204E233030303038353830' TO DFHEIV0(25:11)
  9418     CALL 'kxdfhei1' USING DFHEIV0,
  9419           ERPNDB-FILE-ID,
  9420           DFHEIV20,
  9421           DFHEIV99,
  9422           ERPNDB-PRIMARY-KEY,
  9423           DFHEIV99,
  9424           DFHEIV99,
  9425           DFHEIV99
  9426     SET ADDRESS OF PENDING-BUSINESS TO
  9427         DFHEIV20
  9428     MOVE EIBRESP  TO ws-response
  9429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9430
  9431
  9432 6200-EXIT.
  9433      EXIT.
  9434 6210-rewrite-pndb.
  9435
  9436* EXEC CICS REWRITE
  9437*        DATASET  (ERPNDB-FILE-ID)
  9438*        FROM     (PENDING-BUSINESS)
  9439*    END-EXEC
  9440     MOVE LENGTH OF
  9441      PENDING-BUSINESS
  9442       TO DFHEIV11
  9443*    MOVE '&& L                  %   #00008591' TO DFHEIV0
  9444     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9445     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9446     MOVE X'2020233030303038353931' TO DFHEIV0(25:11)
  9447     CALL 'kxdfhei1' USING DFHEIV0,
  9448           ERPNDB-FILE-ID,
  9449           PENDING-BUSINESS,
  9450           DFHEIV11,
  9451           DFHEIV99
  9452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9453     .
  9454 6210-exit.
  9455     exit.
  9456 6300-BUILD-CERT-SCREEN.
  9457     perform 6700-build-common   thru 6700-exit
  9458     if ws-refund-amount = zeros
  9459        move pi-company-cd       to pi-chek-comp-cd
  9460        move pi-carrier          to pi-chek-carrier
  9461        move pi-grouping         to pi-chek-grouping
  9462        move pi-state            to pi-chek-state
  9463        move pi-account          to pi-chek-account
  9464        move pi-cert-eff-dt      to pi-chek-eff-dt
  9465        move pi-cert-prime       to pi-chek-cert-no
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 173
* EL677.cbl
  9466        move pi-cert-sfx         to pi-chek-suf-no
  9467        move +1                  to pi-chek-sequence
  9468             MOVE 'S'            TO MAINTI
  9469             MOVE 1              TO MAINTL
  9470             MOVE AL-UABON       TO MAINTA
  9471             MOVE DFHENTER       TO EIBAID
  9472        go to 5000-browse-file
  9473     end-if
  9474     IF WS-CERT-NOT-FOUND
  9475         GO TO 8100-SEND-INITIAL-MAP.
  9476
  9477*    IF WS-PNDB-FOUND
  9478*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9479*                                   PB-C-AH-CANCEL-AMT
  9480*        MOVE 'R'                TO  TYPEO
  9481*        IF PI-AR-PROCESSING
  9482*            MOVE AL-UANON       TO  REFA
  9483*            MOVE PB-C-REFERENCE TO  REFO
  9484*        END-IF
  9485*    ELSE
  9486*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9487*                                   CM-AH-ITD-CANCEL-AMT.
  9488     MOVE WS-REFUND-AMOUNT        TO AMOUNTO
  9489     MOVE pi-check-type           TO TYPEO
  9490
  9491     IF PI-COMPANY-ID = 'TMS'
  9492         MOVE WS-NAME-WORK         TO PAYTO1I
  9493                                      PI-PAYTO1
  9494         MOVE AL-UANON             TO PAYTO1A
  9495     ELSE
  9496         MOVE WS-NAME-WORK         TO PAYTO1I
  9497                                      PI-PAYTO1
  9498         MOVE AL-UANON             TO PAYTO1A.
  9499
  9500*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9501*    MOVE AL-UANON                 TO PAYTO1AA.
  9502     move 'N'                    to dedcyni
  9503     move al-uanon               to dedcyna
  9504     move 'INS'                  to payeeo
  9505     move al-panon               to payeea
  9506     IF PI-MAIL-YES
  9507         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  9508
  9509     GO TO 8100-SEND-INITIAL-MAP.
  9510
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 174
* EL677.cbl
  9512
  9513 6400-MAILING-ADDRESS.
  9514
  9515* EXEC CICS HANDLE CONDITION
  9516*        NOTFND   (6470-NO-ADDRESS)
  9517*    END-EXEC.
  9518*    MOVE '"$I                   ! 1 #00008656' TO DFHEIV0
  9519     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9520     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9521     MOVE X'3120233030303038363536' TO DFHEIV0(25:11)
  9522     CALL 'kxdfhei1' USING DFHEIV0
  9523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9524
  9525
  9526
  9527* EXEC CICS READ
  9528*        DATASET   (ERMAIL-FILE-ID)
  9529*        SET       (ADDRESS OF MAILING-DATA)
  9530*        RIDFLD    (ELCERT-KEY)
  9531*    END-EXEC.
  9532*    MOVE '&"S        E          (   #00008660' TO DFHEIV0
  9533     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9534     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9535     MOVE X'2020233030303038363630' TO DFHEIV0(25:11)
  9536     CALL 'kxdfhei1' USING DFHEIV0,
  9537           ERMAIL-FILE-ID,
  9538           DFHEIV20,
  9539           DFHEIV99,
  9540           ELCERT-KEY,
  9541           DFHEIV99,
  9542           DFHEIV99,
  9543           DFHEIV99
  9544     SET ADDRESS OF MAILING-DATA TO
  9545         DFHEIV20
  9546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9547
  9548
  9549     MOVE MA-ADDRESS-LINE-1      TO PAYAD1I.
  9550     MOVE MA-ADDRESS-LINE-2      TO PAYAD2I.
  9551     move ma-city                to payctyi
  9552     move ma-addr-state          to paysti
  9553     MOVE MA-ZIP                 TO PTOZIPI.
  9554     MOVE AL-UANON               TO PAYAD1A
  9555                                    PAYAD2A
  9556                                    PAYctyA
  9557                                    paysta
  9558                                    PTOZIPA.
  9559
  9560     GO TO 6490-EXIT.
  9561
  9562 6470-NO-ADDRESS.
  9563     MOVE -1                     TO  PAYAD1L.
  9564     MOVE ER-2394                TO  EMI-ERROR.
  9565     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9566
  9567 6490-EXIT.
  9568      EXIT.
  9569
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 175
* EL677.cbl
  9571
  9572 6500-BUILD-ACCOUNT-SCREEN.
  9573     perform 6700-build-common   thru 6700-exit
  9574     MOVE WS-REFUND-AMOUNT       TO AMOUNTO
  9575     MOVE PI-AM-NAME             TO PAYTO1I
  9576     MOVE SPACES                 TO PAYTO2I
  9577     MOVE PI-AM-ADDRS            TO PAYAD1I.
  9578     MOVE PI-AM-CITY             TO PAYCTYI
  9579     move pi-am-st               to paysti
  9580     MOVE PI-AM-ZIP-CODE         TO PTOZIPI
  9581     move 'ACCT'                 to payeeo
  9582     move al-panon               to payeea
  9583     MOVE AL-UANON               TO PAYTO1A
  9584                                    PAYTO2A
  9585                                    PAYAD1A
  9586                                    PAYCTYA
  9587                                    paysta
  9588                                    PTOZIPA.
  9589     GO TO 8100-SEND-INITIAL-MAP
  9590     .
  9591 6600-BUILD-BENEFICIARY-SCREEN.
  9592     perform 6700-build-common   thru 6700-exit
  9593     IF WS-CERT-NOT-FOUND
  9594         GO TO 8100-SEND-INITIAL-MAP.
  9595
  9596*    IF WS-PNDB-FOUND
  9597*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9598*                                   PB-C-AH-CANCEL-AMT
  9599*        MOVE 'R'                TO  TYPEO
  9600*        IF PI-AR-PROCESSING
  9601*            MOVE AL-UANON       TO  REFA
  9602*            MOVE PB-C-REFERENCE TO  REFO
  9603*        END-IF
  9604*    ELSE
  9605*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9606*                                   CM-AH-ITD-CANCEL-AMT.
  9607
  9608     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  9609     MOVE pi-check-type           TO  TYPEO.
  9610
  9611     IF PI-COMPANY-ID = 'TMS'
  9612         MOVE WS-NAME-WORK         TO PAYTO1I
  9613                                      PI-PAYTO1
  9614         MOVE AL-UANON             TO PAYTO1A
  9615     ELSE
  9616         MOVE WS-NAME-WORK         TO PAYTO1I
  9617                                      PI-PAYTO1
  9618         MOVE AL-UANON             TO PAYTO1A.
  9619
  9620*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9621*    MOVE AL-UANON                 TO PAYTO1AA.
  9622
  9623     move 'N'                    to dedcyni
  9624     move al-uanon               to dedcyna
  9625     move 'BENE'                 to payeeo
  9626     move al-panon               to payeea
  9627     IF PI-MAIL-YES
  9628         PERFORM 6620-MAILING-ADDRESS THRU 6690-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 176
* EL677.cbl
  9629
  9630     GO TO 8100-SEND-INITIAL-MAP.
  9631
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 177
* EL677.cbl
  9633
  9634 6620-MAILING-ADDRESS.
  9635
  9636* EXEC CICS HANDLE CONDITION
  9637*        NOTFND   (6670-NO-beneficiary)
  9638*    END-EXEC.
  9639*    MOVE '"$I                   ! 2 #00008752' TO DFHEIV0
  9640     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9641     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9642     MOVE X'3220233030303038373532' TO DFHEIV0(25:11)
  9643     CALL 'kxdfhei1' USING DFHEIV0
  9644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9645
  9646
  9647
  9648* EXEC CICS READ
  9649*        DATASET   (ERMAIL-FILE-ID)
  9650*        SET       (ADDRESS OF MAILING-DATA)
  9651*        RIDFLD    (ELCERT-KEY)
  9652*    END-EXEC.
  9653*    MOVE '&"S        E          (   #00008756' TO DFHEIV0
  9654     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9655     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9656     MOVE X'2020233030303038373536' TO DFHEIV0(25:11)
  9657     CALL 'kxdfhei1' USING DFHEIV0,
  9658           ERMAIL-FILE-ID,
  9659           DFHEIV20,
  9660           DFHEIV99,
  9661           ELCERT-KEY,
  9662           DFHEIV99,
  9663           DFHEIV99,
  9664           DFHEIV99
  9665     SET ADDRESS OF MAILING-DATA TO
  9666         DFHEIV20
  9667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9668
  9669
  9670     move spaces                 to payto2i
  9671     move ma-cred-bene-name      to payto1i
  9672     MOVE MA-cred-bene-addr      TO PAYad1I.
  9673     MOVE MA-cred-bene-addr2     TO PAYad2I.
  9674     move ma-cred-bene-city      to payctyi
  9675     move ma-cred-bene-state     to paysti
  9676     MOVE MA-cred-bene-zip       TO PTOZIPI.
  9677     MOVE AL-UANON               TO payto1a
  9678                                    PAYTO2A
  9679                                    PAYad1A
  9680                                    payad2a
  9681                                    PAYctyA
  9682                                    paysta
  9683                                    PTOZIPA.
  9684
  9685     GO TO 6690-EXIT.
  9686
  9687 6670-NO-BENEFICIARY.
  9688     MOVE -1                     TO  PAYTO1L.
  9689     MOVE ER-2394                TO  EMI-ERROR.
  9690     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 178
* EL677.cbl
  9691
  9692 6690-EXIT.
  9693      EXIT.
  9694 6700-build-common.
  9695     if not eracct-found
  9696        move pi-company-cd       to eracct-co
  9697        move pi-carrier          to eracct-carrier
  9698        move pi-grouping         to eracct-grouping
  9699        move pi-state            to eracct-state
  9700        move pi-account          to eracct-account
  9701        move pi-cert-eff-dt      to eracct-exp-date
  9702        perform 1420-get-eracct  thru 1490-exit
  9703     end-if
  9704*    if WS-PNDB-NOT-FOUND
  9705*       perform 5600-get-erpndb thru 5600-exit
  9706*    end-if
  9707     MOVE LOW-VALUES             TO  EL677AI.
  9708     MOVE 'A'                    TO  MAINTI.
  9709     MOVE AL-UANON               TO  MAINTA.
  9710     MOVE +1                     TO  MAINTL.
  9711     MOVE PI-CARRIER             TO  CARRIERO.
  9712     MOVE PI-GROUPING            TO  GROUPO.
  9713     MOVE PI-STATE               TO  STATEO.
  9714     MOVE PI-ACCOUNT             TO  ACCTO.
  9715     MOVE PI-CERT-PRIME          TO  CERTNOO.
  9716     MOVE PI-CERT-SFX            TO  SFXO.
  9717     MOVE PI-AMOUNT              TO  AMOUNTO.
  9718*    MOVE PI-TYPE                TO  TYPEO.
  9719     move pi-check-type          to  typeo
  9720     move pi-return-to           to  rettoo
  9721*    MOVE PI-REFERENCE           TO  REFO.
  9722     MOVE PI-PAYTO1              TO  PAYTO1O.
  9723     MOVE AL-UANON               TO  CARRIERA
  9724                                     GROUPA
  9725                                     STATEA
  9726                                     ACCTA
  9727                                     CERTNOA
  9728                                     SFXA
  9729                                     PAYTO1A
  9730                                     PAYTO2A
  9731*                                    AMOUNTA
  9732*                                    TYPEA
  9733                                     rettoa.
  9734     move al-panon               to typea
  9735     move al-panon               to amounta
  9736     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  9737     MOVE ' '                    TO  DC-OPTION-CODE.
  9738     PERFORM 8500-DATE-CONVERT.
  9739     IF NO-CONVERSION-ERROR
  9740         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  9741         MOVE AL-UANON            TO  EFFDTA
  9742         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  9743         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  9744     ELSE
  9745         GO TO 8200-SEND-DATAONLY.
  9746     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9747         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
  9748         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 179
* EL677.cbl
  9749     ELSE
  9750         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9751         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9752     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9753     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9754     move spaces to pi-insured-name
  9755     string cm-insured-last-name ' '
  9756            cm-insured-first-name delimited by '  '
  9757        into pi-insured-name
  9758     end-string
  9759     move spaces                 to pi-table-name
  9760     string cm-insured-last-name ', '
  9761            cm-insured-first-name ' '
  9762            cm-insured-initial2
  9763        delimited by '  '
  9764        into
  9765           pi-table-name
  9766     end-string
  9767*    MOVE WS-NAME-WORK           TO PI-INSURED-NAME.
  9768     if eibaid = dfhpf5
  9769        move 'Y'                 to dedcyni
  9770        move al-uanon            to dedcyna
  9771     end-if
  9772    compute ws-tot-lf-prem = cm-lf-premium-amt +
  9773       cm-lf-alt-premium-amt
  9774    compute ws-tot-iss-prem  =
  9775       cm-ah-premium-amt + ws-tot-lf-prem
  9776    compute ws-tot-iss-comm =
  9777       (ws-tot-lf-prem * cm-life-comm-pct) +
  9778       (cm-ah-premium-amt * cm-ah-comm-pct)
  9779    compute ws-tot-ref-comm =
  9780       (pi-lf-refund * cm-life-comm-pct) +
  9781       (pi-ah-refund * cm-ah-comm-pct)
  9782     move ws-tot-iss-prem        to premo
  9783     move ws-tot-iss-comm        to isscommo
  9784     move al-sadof               to drefa
  9785                                    refa
  9786*    compute refo = pi-lf-refund + pi-ah-refund
  9787     move pi-prev-paid            to prepdo
  9788     move ws-tot-ref-comm         to uecommo
  9789                                     pi-ue-comm
  9790     compute ws-refund-amount = pi-refund-on-pending-rec -
  9791        pi-prev-paid
  9792     if (dedcyni = 'Y')
  9793        or (pi-prev-ded-comm = 'Y')
  9794        compute ws-refund-amount = ws-refund-amount -
  9795           ws-tot-ref-comm
  9796     end-if
  9797     if pi-check-type = 'C'
  9798*       move pi-endt-prm-diff    to refo
  9799        move pi-endt-com-diff    to uecommo
  9800                                    pi-ue-comm
  9801        compute ws-refund-amount =
  9802           pi-endt-prm-diff - pi-prev-paid
  9803        if (dedcyni = 'Y')
  9804           or (pi-prev-ded-comm = 'Y')
  9805           compute ws-refund-amount = ws-refund-amount -
  9806              pi-endt-com-diff
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 180
* EL677.cbl
  9807        end-if
  9808        if ws-refund-amount <= zeros
  9809           move pi-endt-prm-diff to ws-refund-amount
  9810        end-if
  9811     end-if
  9812     if not WS-CERT-NOT-FOUND
  9813        string
  9814           pi-cert-prime         ' : '
  9815           cm-insured-last-name  ', '
  9816           cm-insured-first-name ' : '
  9817           pi-account            ' : '
  9818           pi-am-csr delimited by '  ' into text1o
  9819        end-string
  9820        move al-uanon            to text1a
  9821        MOVE 'REF'               TO WS-USER-REASON
  9822        if pi-check-type = 'C'
  9823           move 'COR'            to ws-user-reason
  9824        end-if
  9825        MOVE pi-cert-no          TO WS-USER-CERT-NO
  9826        inspect ws-user-cert-no replacing leading zeros
  9827           by spaces
  9828        move pi-insured-name     to ws-user-name
  9829        perform varying s1 from +1 by +1 until
  9830           (s1 > +11)
  9831           or (ws-user-cert-no (s1:1)) <> ' '
  9832        end-perform
  9833        string ws-user-reason  ' ' delimited by size
  9834               ws-user-cert-no (s1:11 - s1 + 1) ' '
  9835                  delimited by size
  9836               cm-insured-last-name ' '
  9837               cm-insured-first-name delimited by '  '
  9838           into stubo
  9839        end-string
  9840        move al-uanon            to stuba
  9841     end-if
  9842     .
  9843 6700-exit.
  9844     exit.
  9845 6800-browse-previous-chek-recs.
  9846***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9847***                                                            ***
  9848**** this should be the first time through, we need to gather  ***
  9849**** all the erchek records for this pending record, add the   ***
  9850**** amounts and make sure this check request will not exceed  ***
  9851**** the collected premium                                     ***
  9852***                                                            ***
  9853***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9854     move zeros                  to pi-prev-paid
  9855                                    ws-browse-sw
  9856                                    pi-chek-rec-cnt
  9857     move spaces                 to pi-prev-ded-comm
  9858     move pi-company-cd          to chek-company-cd
  9859     move pi-carrier             to chek-carrier
  9860     move pi-grouping            to chek-grouping
  9861     move pi-state               to chek-state
  9862     move pi-account             to chek-account
  9863     move pi-cert-prime          to chek-cert-no
  9864     move pi-cert-sfx            to chek-suf-no
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 181
* EL677.cbl
  9865     move pi-cert-eff-dt         to chek-eff-dt
  9866     move +0                     to chek-record-seq
  9867     move erchek-key             to ws-compare-erchek-key
  9868
  9869* EXEC CICS STARTBR
  9870*       DATASET  (ERCHEK-FILE-ID)
  9871*       RIDFLD   (ERCHEK-KEY)
  9872*       resp     (ws-response)
  9873*    END-EXEC
  9874     MOVE 0
  9875       TO DFHEIV11
  9876*    MOVE '&,         G          &  N#00008960' TO DFHEIV0
  9877     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9878     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9879     MOVE X'204E233030303038393630' TO DFHEIV0(25:11)
  9880     CALL 'kxdfhei1' USING DFHEIV0,
  9881           ERCHEK-FILE-ID,
  9882           ERCHEK-KEY,
  9883           DFHEIV99,
  9884           DFHEIV11,
  9885           DFHEIV99
  9886     MOVE EIBRESP  TO ws-response
  9887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9888     if not resp-normal
  9889        go to 6800-exit
  9890     end-if
  9891     perform until i-say-when
  9892
  9893* EXEC CICS READNEXT
  9894*          DATASET   (ERCHEK-FILE-ID)
  9895*          SET       (ADDRESS OF CHECK-RECORDS)
  9896*          RIDFLD    (ERCHEK-KEY)
  9897*          resp      (ws-response)
  9898*       END-EXEC
  9899     MOVE 0
  9900       TO DFHEIV11
  9901*    MOVE '&.S                   )  N#00008969' TO DFHEIV0
  9902     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9903     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9904     MOVE X'204E233030303038393639' TO DFHEIV0(25:11)
  9905     CALL 'kxdfhei1' USING DFHEIV0,
  9906           ERCHEK-FILE-ID,
  9907           DFHEIV20,
  9908           DFHEIV99,
  9909           ERCHEK-KEY,
  9910           DFHEIV99,
  9911           DFHEIV11,
  9912           DFHEIV99,
  9913           DFHEIV99
  9914     SET ADDRESS OF CHECK-RECORDS TO
  9915         DFHEIV20
  9916     MOVE EIBRESP  TO ws-response
  9917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9918        if resp-normal
  9919           and erchek-key (1:33) = ws-compare-erchek-key
  9920           if (ch-void-dt = low-values)
  9921              and (not ch-denied)
  9922              if pi-check-type = 'R'
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 182
* EL677.cbl
  9923                 and ch-check-origin-sw = 'C'
  9924                 continue
  9925              else
  9926                 compute pi-prev-paid = pi-prev-paid +
  9927                    ch-amount-paid
  9928                 add +1 to pi-chek-rec-cnt
  9929                 move ch-deduct-commission
  9930                                 to pi-prev-ded-comm
  9931              end-if
  9932           end-if
  9933        else
  9934           set i-say-when to true
  9935        end-if
  9936     end-perform
  9937     .
  9938 6800-exit.
  9939     exit.
  9940 7000-SET-PI-AREA.
  9941     MOVE CARRIERI               TO  PI-CARRIER
  9942                                     PI-CHEK-CARRIER.
  9943     MOVE GROUPI                 TO  PI-GROUPING
  9944                                     PI-CHEK-GROUPING.
  9945     MOVE STATEI                 TO  PI-STATE
  9946                                     PI-CHEK-STATE.
  9947     MOVE ACCTI                  TO  PI-ACCOUNT
  9948                                     PI-CHEK-ACCOUNT.
  9949     MOVE CERTNOI                TO  PI-CERT-PRIME
  9950                                     PI-CHEK-CERT-NO.
  9951     IF SFXI NOT = LOW-VALUES
  9952         MOVE SFXI               TO  PI-CERT-SFX
  9953                                     PI-CHEK-SUF-NO
  9954     ELSE
  9955         MOVE SPACE              TO  PI-CERT-SFX
  9956                                     PI-CHEK-SUF-NO.
  9957
  9958     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
  9959     MOVE '2'                    TO  DC-OPTION-CODE.
  9960     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9961     IF DATE-CONVERSION-ERROR
  9962         MOVE ER-0215            TO  EMI-ERROR
  9963         MOVE -1                 TO  EFFDTL
  9964         MOVE AL-UNBON           TO  EFFDTA
  9965         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9966         GO TO 8200-SEND-DATAONLY
  9967     ELSE
  9968         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
  9969                                     PI-CHEK-EFF-DT.
  9970
  9971 7090-EXIT.
  9972      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 183
* EL677.cbl
  9974 7100-CREATE-TEMP-STORAGE.
  9975     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
  9976
  9977
  9978* EXEC CICS WRITEQ TS
  9979*        QUEUE   (QID)
  9980*        FROM    (PROGRAM-INTERFACE-BLOCK)
  9981*        LENGTH  (PI-COMM-LENGTH)
  9982*    END-EXEC.
  9983*    MOVE '*"                    ''   #00009034' TO DFHEIV0
  9984     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  9985     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9986     MOVE X'2020233030303039303334' TO DFHEIV0(25:11)
  9987     CALL 'kxdfhei1' USING DFHEIV0,
  9988           QID,
  9989           PROGRAM-INTERFACE-BLOCK,
  9990           PI-COMM-LENGTH,
  9991           DFHEIV99,
  9992           DFHEIV99,
  9993           DFHEIV99
  9994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9995
  9996
  9997 7100-EXIT.
  9998      EXIT.
  9999
 10000 7200-RECOVER-TEMP-STORAGE.
 10001
 10002* EXEC CICS READQ TS
 10003*        QUEUE   (QID)
 10004*        INTO    (PROGRAM-INTERFACE-BLOCK)
 10005*        LENGTH  (PI-COMM-LENGTH)
 10006*    END-EXEC.
 10007*    MOVE '*$I    L              ''   #00009044' TO DFHEIV0
 10008     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
 10009     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10010     MOVE X'2020233030303039303434' TO DFHEIV0(25:11)
 10011     CALL 'kxdfhei1' USING DFHEIV0,
 10012           QID,
 10013           PROGRAM-INTERFACE-BLOCK,
 10014           PI-COMM-LENGTH,
 10015           DFHEIV99,
 10016           DFHEIV99,
 10017           DFHEIV99
 10018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10019
 10020
 10021     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
 10022
 10023 7200-EXIT.
 10024      EXIT.
 10025
 10026 7300-DELETE-TEMP-STORAGE.
 10027
 10028* EXEC CICS HANDLE CONDITION
 10029*        QIDERR  (7300-EXIT)
 10030*    END-EXEC.
 10031*    MOVE '"$N                   ! 3 #00009056' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 184
* EL677.cbl
 10032     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 10033     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10034     MOVE X'3320233030303039303536' TO DFHEIV0(25:11)
 10035     CALL 'kxdfhei1' USING DFHEIV0
 10036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10037
 10038
 10039
 10040* EXEC CICS DELETEQ TS
 10041*        QUEUE  (QID)
 10042*    END-EXEC.
 10043*    MOVE '*&                    #   #00009060' TO DFHEIV0
 10044     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 10045     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10046     MOVE X'2020233030303039303630' TO DFHEIV0(25:11)
 10047     CALL 'kxdfhei1' USING DFHEIV0,
 10048           QID,
 10049           DFHEIV99
 10050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10051
 10052
 10053 7300-EXIT.
 10054      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 185
* EL677.cbl
 10056 8035-LETR-NOT-OPEN.
 10057
 10058     MOVE ER-0013                TO EMI-ERROR.
 10059*    MOVE -1                     TO LETTER1L
 10060     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10061     GO TO 8200-SEND-DATAONLY.
 10062
 10063 8035-EXIT.
 10064     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 186
* EL677.cbl
 10066 8100-SEND-INITIAL-MAP.
 10067     MOVE SAVE-DATE              TO  DATEO.
 10068     MOVE EIBTIME                TO  TIME-IN.
 10069     MOVE TIME-OUT               TO  TIMEO.
 10070     MOVE -1                     TO  MAINTL
 10071     move al-uanon               to mainta
 10072     if PI-TO-EL677-FROM-EL1273
 10073        move al-sadof            to pf357a
 10074                                    pf46a
 10075                                    dprema
 10076                                    dcomma
 10077                                    drefa
 10078                                    duecomma
 10079                                    dprepda
 10080                                    prema
 10081                                    isscomma
 10082                                    refa
 10083                                    uecomma
 10084                                    prepda
 10085                                    dmaint2a
 10086        move ', VOID(V)'         to dmaint1o
 10087     end-if
 10088     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10089     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10090
 10091
 10092* EXEC CICS SEND
 10093*        MAP      (EL677A)
 10094*        MAPSET   (MAPSET-NAME)
 10095*        FROM     (EL677AO)
 10096*        ERASE
 10097*        CURSOR
 10098*    END-EXEC.
 10099     MOVE LENGTH OF
 10100      EL677AO
 10101       TO DFHEIV12
 10102     MOVE -1
 10103       TO DFHEIV11
 10104*    MOVE '8$     CT  E    H L F ,   #00009102' TO DFHEIV0
 10105     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10106     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10107     MOVE X'2020233030303039313032' TO DFHEIV0(25:11)
 10108     CALL 'kxdfhei1' USING DFHEIV0,
 10109           EL677A,
 10110           EL677AO,
 10111           DFHEIV12,
 10112           MAPSET-NAME,
 10113           DFHEIV99,
 10114           DFHEIV99,
 10115           DFHEIV99,
 10116           DFHEIV11,
 10117           DFHEIV99,
 10118           DFHEIV99,
 10119           DFHEIV99
 10120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10121
 10122
 10123     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 187
* EL677.cbl
 10125 8200-SEND-DATAONLY.
 10126     if connected-to-db
 10127        perform 4300-FINISH-UP-DB thru 4300-exit
 10128     end-if
 10129     MOVE SAVE-DATE              TO  DATEO.
 10130     MOVE EIBTIME                TO  TIME-IN.
 10131     MOVE TIME-OUT               TO  TIMEO.
 10132     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10133     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10134
 10135
 10136* EXEC CICS SEND
 10137*        MAP     (EL677A)
 10138*        MAPSET  (MAPSET-NAME)
 10139*        FROM    (EL677AO)
 10140*        DATAONLY
 10141*        CURSOR
 10142*    END-EXEC.
 10143     MOVE LENGTH OF
 10144      EL677AO
 10145       TO DFHEIV12
 10146     MOVE -1
 10147       TO DFHEIV11
 10148*    MOVE '8$D    CT       H L F ,   #00009122' TO DFHEIV0
 10149     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10150     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10151     MOVE X'2020233030303039313232' TO DFHEIV0(25:11)
 10152     CALL 'kxdfhei1' USING DFHEIV0,
 10153           EL677A,
 10154           EL677AO,
 10155           DFHEIV12,
 10156           MAPSET-NAME,
 10157           DFHEIV99,
 10158           DFHEIV99,
 10159           DFHEIV99,
 10160           DFHEIV11,
 10161           DFHEIV99,
 10162           DFHEIV99,
 10163           DFHEIV99
 10164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10165
 10166
 10167     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 188
* EL677.cbl
 10169 8300-SEND-TEXT.
 10170
 10171* EXEC CICS SEND TEXT
 10172*        FROM     (LOGOFF-TEXT)
 10173*        LENGTH   (LOGOFF-LENGTH)
 10174*        ERASE
 10175*        FREEKB
 10176*    END-EXEC.
 10177*    MOVE '8&      T  E F  H   F -   #00009133' TO DFHEIV0
 10178     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10179     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10180     MOVE X'2020233030303039313333' TO DFHEIV0(25:11)
 10181     CALL 'kxdfhei1' USING DFHEIV0,
 10182           LOGOFF-TEXT,
 10183           LOGOFF-LENGTH,
 10184           DFHEIV99,
 10185           DFHEIV99,
 10186           DFHEIV99,
 10187           DFHEIV99,
 10188           DFHEIV99,
 10189           DFHEIV99,
 10190           DFHEIV99,
 10191           DFHEIV99,
 10192           DFHEIV99,
 10193           DFHEIV99
 10194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10195
 10196
 10197
 10198* EXEC CICS RETURN
 10199*    END-EXEC.
 10200*    MOVE '.(                    ''   #00009140' TO DFHEIV0
 10201     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10202     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10203     MOVE X'2020233030303039313430' TO DFHEIV0(25:11)
 10204     CALL 'kxdfhei1' USING DFHEIV0,
 10205           DFHEIV99,
 10206           DFHEIV99,
 10207           DFHEIV99,
 10208           DFHEIV99,
 10209           DFHEIV99,
 10210           DFHEIV99
 10211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10212
 10213
 10214 8500-DATE-CONVERT.
 10215     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10216
 10217
 10218* EXEC CICS LINK
 10219*        PROGRAM    (PGM-NAME)
 10220*        COMMAREA   (DATE-CONVERSION-DATA)
 10221*        LENGTH     (DC-COMM-LENGTH)
 10222*    END-EXEC.
 10223*    MOVE '."C                   (   #00009146' TO DFHEIV0
 10224     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10225     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10226     MOVE X'2020233030303039313436' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 189
* EL677.cbl
 10227     CALL 'kxdfhei1' USING DFHEIV0,
 10228           PGM-NAME,
 10229           DATE-CONVERSION-DATA,
 10230           DC-COMM-LENGTH,
 10231           DFHEIV99,
 10232           DFHEIV99,
 10233           DFHEIV99,
 10234           DFHEIV99
 10235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10236
 10237
 10238 8500-EXIT.
 10239      EXIT.
 10240
 10241 8600-DEEDIT.
 10242
 10243* EXEC CICS BIF DEEDIT
 10244*        FIELD   (WS-DEEDIT-FIELD)
 10245*        LENGTH  (10)
 10246*    END-EXEC.
 10247     MOVE 10
 10248       TO DFHEIV11
 10249*    MOVE '@"L                   #   #00009156' TO DFHEIV0
 10250     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10251     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10252     MOVE X'2020233030303039313536' TO DFHEIV0(25:11)
 10253     CALL 'kxdfhei1' USING DFHEIV0,
 10254           WS-DEEDIT-FIELD,
 10255           DFHEIV11
 10256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10257
 10258
 10259 8600-EXIT.
 10260      EXIT.
 10261
 10262 8700-DEEDIT.
 10263
 10264* EXEC CICS BIF DEEDIT
 10265*        FIELD   (WS-DT-DEEDIT-FIELD)
 10266*        LENGTH  (10)
 10267*    END-EXEC.
 10268     MOVE 10
 10269       TO DFHEIV11
 10270*    MOVE '@"L                   #   #00009165' TO DFHEIV0
 10271     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10272     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10273     MOVE X'2020233030303039313635' TO DFHEIV0(25:11)
 10274     CALL 'kxdfhei1' USING DFHEIV0,
 10275           WS-DT-DEEDIT-FIELD,
 10276           DFHEIV11
 10277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10278
 10279
 10280 8700-EXIT.
 10281      EXIT.
 10282
 10283 8800-UNAUTHORIZED-ACCESS.
 10284     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 190
* EL677.cbl
 10285     GO TO 8300-SEND-TEXT.
 10286
 10287 8810-PF23.
 10288     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10289     MOVE XCTL-005               TO  PGM-NAME.
 10290     GO TO 9300-XCTL.
 10291
 10292
 10293 9100-RETURN-TRAN.
 10294     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10295     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10296
 10297* EXEC CICS RETURN
 10298*        TRANSID  (TRANS-ID)
 10299*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 10300*        LENGTH   (PI-COMM-LENGTH)
 10301*    END-EXEC.
 10302*    MOVE '.(CT                  ''   #00009186' TO DFHEIV0
 10303     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10304     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10305     MOVE X'2020233030303039313836' TO DFHEIV0(25:11)
 10306     CALL 'kxdfhei1' USING DFHEIV0,
 10307           TRANS-ID,
 10308           PROGRAM-INTERFACE-BLOCK,
 10309           PI-COMM-LENGTH,
 10310           DFHEIV99,
 10311           DFHEIV99,
 10312           DFHEIV99
 10313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10314
 10315
 10316
 10317* GOBACK.
 10318     MOVE '9%                    "   ' TO DFHEIV0
 10319     MOVE 'EL677' TO DFHEIV1
 10320     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10321     GOBACK.
 10322
 10323 9200-RETURN-MAIN-MENU.
 10324     MOVE XCTL-626               TO  PGM-NAME.
 10325     GO TO 9300-XCTL.
 10326
 10327 9300-XCTL.
 10328
 10329* EXEC CICS XCTL
 10330*        PROGRAM    (PGM-NAME)
 10331*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10332*        LENGTH     (PI-COMM-LENGTH)
 10333*    END-EXEC.
 10334*    MOVE '.$C                   %   #00009199' TO DFHEIV0
 10335     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10336     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10337     MOVE X'2020233030303039313939' TO DFHEIV0(25:11)
 10338     CALL 'kxdfhei1' USING DFHEIV0,
 10339           PGM-NAME,
 10340           PROGRAM-INTERFACE-BLOCK,
 10341           PI-COMM-LENGTH,
 10342           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 191
* EL677.cbl
 10343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10344
 10345
 10346 9400-CLEAR.
 10347     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10348     MOVE SPACES                 TO  PI-PFKEY.
 10349     GO TO 9300-XCTL.
 10350
 10351 9500-PF12.
 10352     MOVE XCTL-010               TO  PGM-NAME.
 10353     GO TO 9300-XCTL.
 10354
 10355 9600-PGMID-ERROR.
 10356
 10357* EXEC CICS HANDLE CONDITION
 10358*        PGMIDERR    (8300-SEND-TEXT)
 10359*    END-EXEC.
 10360*    MOVE '"$L                   ! 4 #00009215' TO DFHEIV0
 10361     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10362     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10363     MOVE X'3420233030303039323135' TO DFHEIV0(25:11)
 10364     CALL 'kxdfhei1' USING DFHEIV0
 10365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10366
 10367
 10368     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10369     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10370     MOVE XCTL-005               TO  PGM-NAME.
 10371     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10372     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10373
 10374     GO TO 9300-XCTL.
 10375
 10376 9900-ERROR-FORMAT.
 10377     IF NOT EMI-ERRORS-COMPLETE
 10378         MOVE LINK-001           TO  PGM-NAME
 10379
 10380* EXEC CICS LINK
 10381*            PROGRAM    (PGM-NAME)
 10382*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10383*            LENGTH     (EMI-COMM-LENGTH)
 10384*        END-EXEC.
 10385*    MOVE '."C                   (   #00009230' TO DFHEIV0
 10386     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10387     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10388     MOVE X'2020233030303039323330' TO DFHEIV0(25:11)
 10389     CALL 'kxdfhei1' USING DFHEIV0,
 10390           PGM-NAME,
 10391           ERROR-MESSAGE-INTERFACE-BLOCK,
 10392           EMI-COMM-LENGTH,
 10393           DFHEIV99,
 10394           DFHEIV99,
 10395           DFHEIV99,
 10396           DFHEIV99
 10397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10398
 10399
 10400 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 192
* EL677.cbl
 10401      EXIT.
 10402
 10403 9990-ABEND.
 10404     MOVE LINK-004               TO  PGM-NAME.
 10405     MOVE DFHEIBLK               TO  EMI-LINE1.
 10406
 10407* EXEC CICS LINK
 10408*        PROGRAM   (PGM-NAME)
 10409*        COMMAREA  (EMI-LINE1)
 10410*        LENGTH    (72)
 10411*    END-EXEC.
 10412     MOVE 72
 10413       TO DFHEIV11
 10414*    MOVE '."C                   (   #00009242' TO DFHEIV0
 10415     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10416     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10417     MOVE X'2020233030303039323432' TO DFHEIV0(25:11)
 10418     CALL 'kxdfhei1' USING DFHEIV0,
 10419           PGM-NAME,
 10420           EMI-LINE1,
 10421           DFHEIV11,
 10422           DFHEIV99,
 10423           DFHEIV99,
 10424           DFHEIV99,
 10425           DFHEIV99
 10426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10427
 10428
 10429     GO TO 8200-SEND-DATAONLY.
 10430
 10431 9995-SECURITY-VIOLATION.
 10432*                            COPY ELCSCTP.
 10433******************************************************************
 10434*                                                                *
 10435*                            ELCSCTP                             *
 10436*                            VMOD=2.001                          *
 10437*                                                                *
 10438*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10439******************************************************************
 10440
 10441
 10442     MOVE EIBDATE          TO SM-JUL-DATE.
 10443     MOVE EIBTRMID         TO SM-TERMID.
 10444     MOVE THIS-PGM         TO SM-PGM.
 10445     MOVE EIBTIME          TO TIME-IN.
 10446     MOVE TIME-OUT         TO SM-TIME.
 10447     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10448
 10449
 10450* EXEC CICS LINK
 10451*         PROGRAM  ('EL003')
 10452*         COMMAREA (SECURITY-MESSAGE)
 10453*         LENGTH   (80)
 10454*    END-EXEC.
 10455     MOVE 'EL003' TO DFHEIV1
 10456     MOVE 80
 10457       TO DFHEIV11
 10458*    MOVE '."C                   (   #00009268' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 193
* EL677.cbl
 10459     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10460     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10461     MOVE X'2020233030303039323638' TO DFHEIV0(25:11)
 10462     CALL 'kxdfhei1' USING DFHEIV0,
 10463           DFHEIV1,
 10464           SECURITY-MESSAGE,
 10465           DFHEIV11,
 10466           DFHEIV99,
 10467           DFHEIV99,
 10468           DFHEIV99,
 10469           DFHEIV99
 10470     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10471
 10472
 10473******************************************************************
 10474
 10475
 10476 9995-EXIT.
 10477     EXIT.
 10478
 10479
 10480 9999-DFHBACK SECTION.
 10481     MOVE '9%                    "   ' TO DFHEIV0
 10482     MOVE 'EL677' TO DFHEIV1
 10483     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10484     GOBACK.
 10485 9999-DFHEXIT.
 10486     IF DFHEIGDJ EQUAL 0001
 10487         NEXT SENTENCE
 10488     ELSE IF DFHEIGDJ EQUAL 2
 10489         GO TO 9600-PGMID-ERROR,
 10490               9990-ABEND
 10491         DEPENDING ON DFHEIGDI
 10492     ELSE IF DFHEIGDJ EQUAL 3
 10493         GO TO 8100-SEND-INITIAL-MAP
 10494         DEPENDING ON DFHEIGDI
 10495     ELSE IF DFHEIGDJ EQUAL 4
 10496         GO TO 1290-NO-CARRIER
 10497         DEPENDING ON DFHEIGDI
 10498     ELSE IF DFHEIGDJ EQUAL 5
 10499         GO TO 1380-NO-STATE
 10500         DEPENDING ON DFHEIGDI
 10501     ELSE IF DFHEIGDJ EQUAL 6
 10502         GO TO 1480-ACCOUNT-INVALID,
 10503               1480-ACCOUNT-INVALID
 10504         DEPENDING ON DFHEIGDI
 10505     ELSE IF DFHEIGDJ EQUAL 7
 10506         GO TO 1590-EXIT
 10507         DEPENDING ON DFHEIGDI
 10508     ELSE IF DFHEIGDJ EQUAL 8
 10509         GO TO 2200-DUPREC
 10510         DEPENDING ON DFHEIGDI
 10511     ELSE IF DFHEIGDJ EQUAL 9
 10512         GO TO 2577-DUPREC
 10513         DEPENDING ON DFHEIGDI
 10514     ELSE IF DFHEIGDJ EQUAL 10
 10515         GO TO 2600-NO-CO-MASTER
 10516         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 26-Jan-16 15:18 Page 194
* EL677.cbl
 10517     ELSE IF DFHEIGDJ EQUAL 11
 10518         GO TO 3900-RECORD-NOTFND
 10519         DEPENDING ON DFHEIGDI
 10520     ELSE IF DFHEIGDJ EQUAL 12
 10521         GO TO 3287-DUPREC
 10522         DEPENDING ON DFHEIGDI
 10523     ELSE IF DFHEIGDJ EQUAL 13
 10524         GO TO 3390-EXIT,
 10525               3390-EXIT
 10526         DEPENDING ON DFHEIGDI
 10527     ELSE IF DFHEIGDJ EQUAL 14
 10528         GO TO 5560-END-OF-FILE,
 10529               5560-END-OF-FILE
 10530         DEPENDING ON DFHEIGDI
 10531     ELSE IF DFHEIGDJ EQUAL 15
 10532         GO TO 6070-NO-COMP-MSTR
 10533         DEPENDING ON DFHEIGDI
 10534     ELSE IF DFHEIGDJ EQUAL 16
 10535         GO TO 6170-NO-CERTIFICATE
 10536         DEPENDING ON DFHEIGDI
 10537     ELSE IF DFHEIGDJ EQUAL 17
 10538         GO TO 6470-NO-ADDRESS
 10539         DEPENDING ON DFHEIGDI
 10540     ELSE IF DFHEIGDJ EQUAL 18
 10541         GO TO 6670-NO-beneficiary
 10542         DEPENDING ON DFHEIGDI
 10543     ELSE IF DFHEIGDJ EQUAL 19
 10544         GO TO 7300-EXIT
 10545         DEPENDING ON DFHEIGDI
 10546     ELSE IF DFHEIGDJ EQUAL 20
 10547         GO TO 8300-SEND-TEXT
 10548         DEPENDING ON DFHEIGDI.
 10549     MOVE '9%                    "   ' TO DFHEIV0
 10550     MOVE 'EL677' TO DFHEIV1
 10551     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10552     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      142324     Code:       39532
