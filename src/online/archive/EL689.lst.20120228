* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page   1
* EL689.cbl
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INT"EL689.int" INTDATE"ANSI" INTLEVEL"2"
*          IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT KEYCHECK
*          KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL689.lst" LISTPATH""
*          LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME NOMAXERROR
*          METHODDEFAULT"REFERENCE" MF"13" MFCOMMENT NOMOVELENCHECK NOMS NOMVS
*          NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR NONEWBASENAME NONLS
*          NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE NOOLDBLANKLINE NOOLDCOPY
*          NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO NOOLDSTRMIX OOCTRL
*          "-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT"" NOOSVS NOOUTDD
*          NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST NOPREPROCESS
*          NOPRINT-EXT NOPROFILE NOPROGID-COMMENT NOPROGID-INT-NAME
*          NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL QUALPROC NOQUERY NOQUOTE
*          NORAWLIST NORDW RECMODE"F" NOREENTRANT NOREF NOREFNO REMAINDER"1"
*          REPORT-LINE"256" RESEQ NORETRYLOCK REWRITE-LS NORM RTNCODE-SIZE"4"
*          NORWHARDPAGE NOSAA SEG NOSEQCHK SEQUENTIAL"RECORD" NOSERIAL SETTING
*          "LINE" NOSHAREOUTDD NOSHOW-DIR SIGN"ASCII" NOSIGNFIXUP SORTTYPE
*          "DFSORT" SOURCEFORMAT"FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE
*          STDERR STICKY-LINKAGE"2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1"
*          SYMBSTART"1" SYSPUNCH"132" TERMPAGE TIME NOTRACE NOTRUNC
*          NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC"10" UNICODE"NATIVE" NOVERBOSE
*          VSC2"4" WARNING"1" NOWB NOWB2 NOWB3 WEBSERVER"CGI" NOWRITELOCK
*          NOWRITETHRU NOXOPEN NOXREF NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL689 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:10:07.
     7*                            VMOD=2.037
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11*DATE-COMPILED.
    12*REMARKS.    TRANSACTION - EXH3 - CREDIT LETTER WRITER.
    13*
    14******************************************************************
    15
    16* W-FILE-USED REFERENCE LIST:
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page   2
* EL689.cbl
    17* (1)  ELCNTL - COMPANY
    18* (2)  ELCNTL - LIFE BENEFIT
    19* (3)  ELCNTL - A&H BENEFIT
    20* (4)  ELCNTL - CARRIER
    21* (5)  MAIL
    22* (6)  ERACCT
    23* (7)  USED FOR SYSTEM VARIABLES ?
    24* (8)  ELCERT
    25* (9)  PENDING BUSINESS
    26* (10) COMPENSATION
    27* (11) ELCNTL - PROCESSOR DATA ?
    28* (12) ERCHEK
    29* (13) ERPYAJ
    30* (14) NOT USED
    31* (15) NOT USED
    32* (16) NOT USED
    33* (17) NOT USED
    34* (18) NOT USED
    35* (19) NOT USED
    36* (20) NOT USED
    37*
    38******************************************************************
    39*                   C H A N G E   L O G
    40*
    41* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    42*-----------------------------------------------------------------
    43*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    44* EFFECTIVE    NUMBER
    45*-----------------------------------------------------------------
    46* 101501    2001100100006  SMVA  ADD USERID to screen header
    47*                                ADJUSTED REDEFINES EL689AI FILLER
    48* 031504    2004020600009  SMVA  PULL MOST CURRENT ACCT ADDRESS
    49* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    50* 100705    2004072800003  PEMA  ADD NEW VARIABLES
    51* 072308    2008062700001  PEMA  ADD NEW VARIABLES
    52* 092908    2008013100006  PEMA  MOVE VAR 154
    53* 102408  CR2008091000001  PEMA  MOVE PNDB VARS TO CERT VARS
    54* 051209  CR2009021700003  PEMA  ADD CRED BENE VARIABLES
    55* 051209  CR2009042700002  PEMA  ADD ERACCT ACCT NUMBER VARIABLE
    56* 022510  IR2009062300003  PEMA  ADD ENDFILE TEST TO ERACCT READ
    57* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    58* 041811  CR2011010400001  PEMA  DISABLE PF8 FOR CERTAIN USERS
    59* 042011  CR2011010400001  PEMA  FIX CRED BENE ADDRESS LINES
    60* 061411  CR2011061300001  PEMA  ADD ALWA TO PF8 DISABLE LIST
    61* 092911  IR2011092900001  AJRA  CLEAR LABEL LINES BEFORE CRED BEN
    62******************************************************************
    63
    64 DATA DIVISION.
    65 WORKING-STORAGE SECTION.
    66 01  DFH-START PIC X(04).
    67 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    68 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    69                                   USAGE POINTER.
    70 77  FILLER  PIC X(32) VALUE '********************************'.
    71 77  FILLER  PIC X(32) VALUE '*    EL689 WORKING STORAGE     *'.
    72 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page   3
* EL689.cbl
    74
    75 01  W-WORK-AREAS.
    76     12  FILLER                  PIC  X(18)
    77                                      VALUE 'PROGRAM WORK AREA:'.
    78
    79     12  W-ASKTIME-CTR           PIC S9(04)  COMP   VALUE +0.
    80     12  W-CWA-NDX               PIC S9(04)  COMP   VALUE +0.
    81     12  W-DISPLAY-NDX           PIC S9(04)  COMP   VALUE +0.
    82     12  W-FIRST-BAD-VARIABLE    PIC S9(04)  COMP   VALUE +0.
    83     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
    84     12  W-NDX2                  PIC S9(04)  COMP   VALUE +0.
    85     12  W-SEQ-CTR               PIC S9(04)  COMP   VALUE +0.
    86     12  W-TS-ITEM               PIC S9(04)  COMP   VALUE +0.
    87     12  W-TOTAL-LINE-LENGTH     PIC S9(04)  COMP   VALUE +0.
    88     12  W-WORK-NDX              PIC S9(04)  COMP   VALUE +0.
    89
    90     12  W-ADJUST-SHORT          PIC S9(03) VALUE +0   COMP-3.
    91     12  W-DIFFERENCE            PIC S9(07)V9(02)
    92                                            VALUE +0   COMP-3.
    93     12  W-INITIAL-COLUMN        PIC S9(03) VALUE +0   COMP-3.
    94     12  W-LAST-COLUMN           PIC S9(03) VALUE +70 COMP-3.
    95     12  W-LAST-SQUEEZED-SPACE   PIC S9(03) VALUE +0   COMP-3.
    96     12  W-LAST-TX-SPACE         PIC S9(03) VALUE +0   COMP-3.
    97     12  W-LAST-WC-SPACE         PIC S9(03) VALUE +0   COMP-3.
    98     12  W-LINE-COUNT            PIC S9(03) VALUE +0   COMP-3.
    99     12  W-LINE-INDENT-1         PIC  9(02) VALUE 0    COMP-3.
   100     12  W-LINE-INDENT-2         PIC  9(02) VALUE 0    COMP-3.
   101     12  W-LINE-INDENT-3         PIC  9(02) VALUE 0    COMP-3.
   102     12  W-LINE-INDENT-4         PIC  9(02) VALUE 0    COMP-3.
   103     12  W-LINE-INDENT-5         PIC  9(02) VALUE 0    COMP-3.
   104     12  W-MAX-LINES-PER-PAGE    PIC  9(02) VALUE 56   COMP-3.
   105     12  W-NEXT-INDENT           PIC  9(02) VALUE 0    COMP-3.
   106     12  W-PAGE                  PIC S9(02) VALUE +0   COMP-3.
   107     12  W-PAGE-LINE             PIC S9(03) VALUE +0   COMP-3.
   108     12  W-PARAGRAPH-INDENT      PIC  9(02) VALUE 0    COMP-3.
   109     12  W-ROLL-COUNTER          PIC S9(03) VALUE +0   COMP-3.
   110     12  W-START-COLUMN          PIC S9(03) VALUE +1   COMP-3.
   111     12  W-TEMP-CURRENT-LINE     PIC S9(03) VALUE +0   COMP-3.
   112     12  W-TOO-FAR               PIC S9(03) VALUE +71 COMP-3.
   113     12  W-TOP-MARGIN            PIC  9(02) VALUE 0    COMP-3.
   114     12  W-TOTAL-TX-LINES        PIC S9(03) VALUE +0   COMP-3.
   115     12  W-TS-GROUP-WORK         PIC  9(05) VALUE 0    COMP-3.
   116     12  W-WORK-INDENT           PIC  9(02) VALUE 0    COMP-3.
   117     12  W-WORK-AMOUNT           PIC S9(09)V9(02)
   118                                            VALUE +0   COMP-3.
   119
   120     12  W-DATA-SOURCE           PIC  9(01) VALUE 0.
   121     12  W-LABEL-SOURCE          PIC  9(01) value 0.
   122         88  W-LABEL-SOURCE-VALID           VALUE 1 THRU 7.
   123     12  W-LABEL-JOINT-NAME      PIC  X(30) VALUE SPACES.
   124     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   125     12  W-NUMB-LABEL-LINES      PIC  9(01) VALUE 0.
   126     12  W-PRINT-CONTROL         PIC  9(02) VALUE 0.
   127     12  W-SAVE-REVISION         PIC  9(03) value 0.
   128     12  W-DISPLAY-3             PIC  9(03) value 0.
   129     12  W-DISPLAY-8             PIC  9(08) value 0.
   130     12  W-DISPLAY-7             PIC  9(07) value 0.
   131     12  W-EDIT-2-5-S            PIC  Z9.9(05).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page   4
* EL689.cbl
   132     12  W-EDIT-3-0              PIC  ZZ9.
   133     12  W-EDIT-7-2              PIC  $$,$$$,$$9.99.
   134     12  W-EDIT-7-2-NEGATIVE     PIC  $$,$$$,$$9.99-.
   135     12  W-EDIT-9-2              PIC  $$$$,$$$,$$9.99.
   136     12  W-EDIT-12-2             PIC  $$$$,$$$,$$$,$$9.99.
   137
   138     12  WS-ACCT-PKEY-MATCH-SW   PIC  X(01) VALUE SPACE.
   139         88  PRIOR-MATCH-ACCT-PKEY          VALUE 'Y'.
   140
   141     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   142     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   143                                 PIC  X(08).
   144     12  W-COMP-WORK-AREA.
   145         16  W-CWA-CHAR OCCURS 10 TIMES
   146                                 PIC  X(01).
   147     12  W-INCOMING-ARCHIVE      PIC  X(08).
   148     12  W-INCOMING-ARCH-NO REDEFINES W-INCOMING-ARCHIVE
   149                                 PIC  9(08).
   150
   151     12  W-BATCH-BREAKDOWN.
   152         16  W-BATCH-CONTROL     PIC S9(08) COMP.
   153         16  W-BATCH-SEQ         PIC S9(04) COMP.
   154     12  W-BEN-HOLD              PIC  X(02).
   155     12  W-BENEFIT-WORK          PIC  X(03).
   156     12  W-BEN-R REDEFINES W-BENEFIT-WORK.
   157         16  W-ELIM-DAYS         PIC  X(02).
   158         16  FILLER              PIC  X(01).
   159     12  W-CALL-PGM              PIC  X(08).
   160     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   161
   162     12  FILLER                  PIC  X(09) VALUE 'LINE CNTL'.
   163     12  W-LINE-CONTROL-RECORD.
   164         16  W-LC-LINE-WIDTH     PIC  9(02).
   165         16  FILLER              PIC  X(01).
   166         16  W-LC-PARAGRAPH-INDENT
   167                                 PIC  9(02).
   168         16  FILLER              PIC  X(01).
   169         16  W-LC-MAX-LINES-PER-PAGE
   170                                 PIC  9(02).
   171         16  FILLER              PIC  X(01).
   172         16  W-LC-LINE-ADJUST    PIC  9(02).
   173         16  FILLER              PIC  X(01).
   174         16  W-LC-LINE-INDENT-1  PIC  9(02).
   175         16  FILLER              PIC  X(01).
   176         16  W-LC-LINE-INDENT-2  PIC  9(02).
   177         16  FILLER              PIC  X(01).
   178         16  W-LC-LINE-INDENT-3  PIC  9(02).
   179         16  FILLER              PIC  X(01).
   180         16  W-LC-LINE-INDENT-4  PIC  9(02).
   181         16  FILLER              PIC  X(01).
   182         16  W-LC-LINE-INDENT-5  PIC  9(02).
   183         16  FILLER              PIC  X(01).
   184         16  W-LC-TOP-MARGIN     PIC  9(02).
   185         16  FILLER              PIC  X(01).
   186         16  W-LC-CASE-IND       PIC  X(01).
   187             88  W-LC-USE-BOTH-CASES        VALUE 'Y'.
   188         16  FILLER              PIC  X(01).
   189         16  W-LC-PAGE-IND       PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page   5
* EL689.cbl
   190             88  W-LC-CREATE-PAGES          VALUE 'Y'.
   191     12  W-DATE-WORK             PIC  9(07).
   192     12  W-DT-REDEF REDEFINES W-DATE-WORK.
   193         16  FILLER              PIC  X(02).
   194         16  W-DT-WORK           PIC  9(05).
   195
   196     12  W-DEEDIT-FIELD          PIC  X(15).
   197     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   198
   199     12  W-EDIT-DATE-1.
   200         16  W-ED1-MM            PIC  X(02).
   201         16  FILLER              PIC  X(01) VALUE '/'.
   202         16  W-ED1-DD            PIC  X(02).
   203         16  FILLER              PIC  X(01) VALUE '/'.
   204         16  W-ED1-YY            PIC  X(02).
   205
   206     12  W-EDIT-DATE-2.
   207         16  W-ED2-DD            PIC  X(02).
   208         16  FILLER              PIC  X(01) VALUE '/'.
   209         16  W-ED2-MM            PIC  X(02).
   210         16  FILLER              PIC  X(01) VALUE '/'.
   211         16  W-ED2-YY            PIC  X(02).
   212
   213     12  W-LABEL-HOLD-AREA.
   214         16  W-LABEL-LINES OCCURS 6 TIMES.
   215             20  W-LABEL-ZIP.
   216                 24  W-LABEL-1ST-ZIP  PIC  X(05).
   217                 24  W-LABEL-DASH     PIC  X(01).
   218                 24  W-LABEL-2ND-ZIP  PIC  X(04).
   219             20  W-LAB-CAN-POSTAL-CODES REDEFINES W-LABEL-ZIP.
   220                 24  W-LAB-CAN-POSTAL-CD-1
   221                                      PIC  X(03).
   222                 24  W-LAB-CAN-DASH   PIC  X(01).
   223                 24  W-LAB-CAN-POSTAL-CD-2
   224                                      PIC  X(03).
   225                 24  W-LAB-CAN-FILLER PIC  X(03).
   226             20  FILLER               PIC  X(10).
   227             20  W-LAST-ZIP.
   228                 24  W-LAST-1ST-ZIP   PIC  X(05).
   229                 24  W-LABEL-DASH-LAST
   230                                      PIC  X(01).
   231                 24  W-LAST-2ND-ZIP   PIC  X(04).
   232             20  W-LAST-CAN-POSTAL-CODES REDEFINES W-LAST-ZIP.
   233                 24  W-LAST-CAN-POSTAL-CD-1
   234                                      PIC  X(03).
   235                 24  W-LAST-CAN-DASH  PIC  X(01).
   236                 24  W-LAST-CAN-POSTAL-CD-2
   237                                      PIC  X(03).
   238                 24  W-LAST-CAN-FILLER
   239                                      PIC  X(03).
   240
   241     12  W-LAST-CHAR             PIC  X(01).
   242         88  W-LAST-CHAR-PUNC    VALUE '-' '/'.
   243     12  W-LAST-SQ-CHAR          PIC  X(01).
   244
   245     12  W-LINE-NUM.
   246         16  W-LINE1             PIC  X(01).
   247         16  W-LINE23            PIC  9(02).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page   6
* EL689.cbl
   248     12  W-LIN-NUM REDEFINES W-LINE-NUM
   249                                 PIC  9(03).
   250
   251     12  W-NAME-LAST             PIC  X(15).
   252     12  W-NAME-FIRST.
   253         16  W-NAME-FIRST-INIT   PIC  X(01).
   254         16  W-NAME-FIRST-REMAIN PIC  X(14).
   255     12  W-NAME-MIDDLE.
   256         16  FILLER              PIC  X(01).
   257         16  W-NAME-MIDDLE-2     PIC  X(01).
   258         16  FILLER              PIC  X(13).
   259
   260     12  W-PAGE-PRT.
   261         16  FILLER              PIC  X(34) VALUE SPACES.
   262         16  W-PAGE-NUMBER       PIC  Z9.
   263         16  FILLER              PIC  X(01) VALUE '.'.
   264         16  FILLER              PIC  X(33) VALUE SPACES.
   265
   266     12  W-PHONE-IN              PIC  9(11) VALUE ZEROS.
   267     12  W-PHONE-IN-R   REDEFINES W-PHONE-IN.
   268         16  FILLER              PIC  9(01).
   269         16  W-PHI-AREA          PIC  9(03).
   270         16  W-PHI-PFX           PIC  9(03).
   271         16  W-PHI-SFX           PIC  9(04).
   272     12  W-PHONE-OUT.
   273         16  W-PO-AREA           PIC  X(03).
   274         16  FILLER              PIC  X(01) VALUE '-'.
   275         16  W-PO-PFX            PIC  X(03).
   276         16  FILLER              PIC  X(01) VALUE '-'.
   277         16  W-PO-SFX            PIC  X(04).
   278
   279     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   280     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   281     12  W-SAVE-PLAN             PIC  X(02) VALUE SPACES.
   282
   283     12  W-SINGLE-LINE           PIC  X(70).
   284     12  W-SINGLE-LINE-BY REDEFINES W-SINGLE-LINE.
   285         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY NDX1 NDX2 NDXA
   286                                 PIC  X(01).
   287
   288     12  W-SQUEEZED-LINE.
   289         16  W-SQ-CHAR OCCURS 70 TIMES
   290                       INDEXED BY W-SQ-NDX
   291                                 PIC  X(01).
   292
   293     12  W-TIME-IN               PIC S9(07).
   294     12  W-TIME-OUT-R REDEFINES W-TIME-IN.
   295         16  FILLER              PIC  X(01).
   296         16  W-TIME-OUT          PIC  99V9(02).
   297         16  FILLER              PIC  X(02).
   298
   299     12  W-TS-NAME-TEXT.
   300         16  W-TS-ID-TEXT        PIC  X(04) VALUE '104A'.
   301         16  W-TS-ID-TIME
   302             REDEFINES W-TS-ID-TEXT
   303                                 PIC S9(07) COMP-3.
   304         16  W-TS-TERM-TEXT.
   305             20 W-TS-TERM-PREFIX PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page   7
* EL689.cbl
   306             20 FILLER           PIC  X(02).
   307     12  W-TS-NAME-SCREEN.
   308         16  FILLER              PIC  X(04) VALUE '689X'.
   309         16  W-TS-TERM-SCREEN    PIC  X(04).
   310
   311     12  W-WORK-LINE.
   312         16  W-WORK-CHAR OCCURS 70 TIMES
   313                       INDEXED BY W-WC-NDX
   314                                  W-WC-NDX2
   315                                  W-WC-NDX3
   316                                 PIC  X(01).
   317
   318     12  W-WORK-ZIP-NUMERIC      PIC  9(09).
   319     12  W-WORK-ZIP REDEFINES W-WORK-ZIP-NUMERIC.
   320         16  W-WORK-ZIP5         PIC  X(05).
   321         16  W-WORK-ZIP4         PIC  X(04).
   322     12  W-CANADIAN-POSTAL-CODES REDEFINES W-WORK-ZIP-NUMERIC.
   323         16  W-CAN-POSTAL-CD-1.
   324             20  FILLER          PIC  X(01).
   325                 88 W-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   326             20  FILLER          PIC  X(02).
   327         16  W-CAN-POSTAL-CD-2   PIC  X(03).
   328         16  W-FILLER            PIC  X(03).
   329
   330     12  W-Z-CONTROL-DATA.
   331         16  W-NUMBER-OF-COPIES  PIC  9.
   332         16  FILLER              PIC  X.
   333         16  W-DAYS-TO-FOLLOW-UP PIC  999.
   334         16  FILLER              PIC  X.
   335         16  W-DAYS-TO-RESEND    PIC  999.
   336         16  FILLER              PIC  X.
   337         16  W-FORM-TO-RESEND    PIC  X(4).
   338         16  FILLER              PIC  X.
   339         16  W-PROMPT-LETTER     PIC  X.
   340         16  FILLER              PIC  X.
   341         16  W-ENCLOSURE-CODE    PIC  XXX.
   342         16  F                   PIC  X.
   343         16  W-AUTO-CLOSE-IND    PIC  X.
   344         16  F                   PIC  X.
   345         16  W-LETTER-TO-BENE    PIC  X.
   346*        16  W-PRINT-RESTRICTED-IND
   347*                                PIC  X(01).
   348*            88  W-PRINT-RESTRICTED-TO-CNTL VALUE 'C'.
   349*            88  W-PRINT-RESTRICTED-TO-FORM VALUE 'F'.
   350*            88  W-PRINT-RESTRICTED-TO-PROC VALUE 'P'.
   351*            88  W-PRINT-RESTRICTED         VALUE 'C' 'F' 'P'.
   352*        16  FILLER              PIC X.
   353*        16  W-RESEND-LETR-1     PIC X(4).
   354*        16  FILLER              PIC X.
   355*        16  W-RESEND-LETR-2     PIC X(4).
   356*        16  FILLER              PIC X.
   357*        16  W-RESEND-LETR-3     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page   8
* EL689.cbl
   359 01  W-SWITCH-INDICATORS-AREA.
   360     12  FILLER                  PIC  X(16)
   361                                      VALUE 'PROGRAM SWITCHS:'.
   362     12  W-ADDRESS-ONLY-SW       PIC  X(01) VALUE ' '.
   363         88  W-ADDRESS-ONLY      VALUE 'Y'.
   364         88  W-FULL-DATA         VALUE ' '.
   365     12  W-ACCT-BROWSE-STARTED-SW
   366                                 PIC  X(01) VALUE 'N'.
   367         88  W-ACCT-BROWSE-STARTED          VALUE 'Y'.
   368     12  W-ARCT-BROWSE-STARTED   PIC  X(01) VALUE 'N'.
   369     12  W-CERT-FOUND-SW         PIC  X(01) VALUE 'N'.
   370         88  W-CERT-FOUND                   VALUE 'Y'.
   371     12  W-CHARACTER-TYPE        PIC  X(01).
   372         88  W-END-OF-SENTENCE   VALUE '.' '?' '!'.
   373         88  W-PUNCTUATION       VALUE '.' '?' '!' ',' ';'.
   374         88  W-SPACE             VALUE ' '.
   375     12  W-COMP-BROWSE-SW        PIC  X(01) VALUE 'N'.
   376         88  W-COMP-BROWSE-STARTED          VALUE 'Y'.
   377     12  W-DATA-SHRINK-IND       PIC  X(01) VALUE SPACES.
   378         88  W-DATA-SHRINKING    VALUE 'Y'.
   379     12  W-END-OF-SENTENCE-IND   PIC  X(01) VALUE SPACES.
   380         88  W-END-OF-SENTENCE-WORKING      VALUE 'Y'.
   381     12  W-FIRST-BAD-VARIABLE-IND
   382                                 PIC  X(01) VALUE SPACES.
   383         88  W-FIRST-BAD-VARIABLE-FOUND     VALUE 'Y'.
   384     12  W-FIRST-CHAR-FOUND-IND  PIC  X(01) VALUE SPACES.
   385         88  W-FIRST-CHAR-FOUND             VALUE 'Y'.
   386         88  W-FIRST-CHAR-NOT-FOUND         VALUE SPACES.
   387     12  W-FORM-CHANGED-IND      PIC  X(01) VALUE SPACES.
   388         88  W-FORM-CHANGED                 VALUE 'Y'.
   389     12  W-FORM-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   390         88  W-FORM-SQUEEZE-ON              VALUE 'Y'.
   391         88  W-FORM-SQUEEZE-OFF             VALUE ' '.
   392     12  W-HOLD-IND              PIC  X(01) VALUE SPACES.
   393         88  W-HOLD-ON                      VALUE 'Y'.
   394         88  W-HOLD-OFF                     VALUE ' '.
   395     12  W-INDIVIDUAL-DATA-SW    PIC  X(01) VALUE ' '.
   396         88  W-INDIVIDUAL-DATA-COMPLETED    VALUE 'Y'.
   397         88  W-INDIV-DATA-NOT-COMPLETED     VALUE ' '.
   398     12  W-KEY-FIELDS-CHANGED-IND
   399                                 PIC  X(01) VALUE ' '.
   400         88  W-KEY-FIELDS-CHANGED           VALUE 'Y'.
   401         88  W-KEY-FIELDS-NOT-CHANGED       VALUE ' '.
   402     12  W-LAST-ONE              PIC  X(01) VALUE HIGH-VALUES.
   403         88  W-LAST-ONE-A-SPACE  VALUE ' '.
   404     12  W-LINE-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   405         88  W-NEW-PARAGRAPH                VALUE 'P' 'Q' 'R' 'S'
   406                                                   'T' 'U'.
   407         88  W-CONTINUE-PARAGRAPH           VALUE 'C' 'D' 'E' 'F'
   408                                                   'G' 'H'.
   409         88  W-FORM-CONTROL-LINE            VALUE 'K'.
   410         88  W-DO-NOT-ADJUST                VALUE 'N'.
   411         88  W-ADJUST-TO-LINE-LENGTH        VALUE 'A'.
   412         88  W-AS-IS                        VALUE 'A' 'N'.
   413         88  W-CONTINUE-PREVIOUS-PROCESS    VALUE ' ' '1' '2' '3'
   414                                                   '4' '5'.
   415
   416     12  W-PNDB-FOUND-SW         PIC  X(01) VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page   9
* EL689.cbl
   417         88  W-PNDB-FOUND                   VALUE 'Y'.
   418     12  W-REMAINING-VAR-SW      PIC  X(01) VALUE SPACES.
   419         88  W-REMAINING-VAR-FOUND          VALUE 'Y'.
   420     12  W-REVERSE-DATE-SW       PIC  X(01) VALUE SPACES.
   421         88  W-REVERSE-DATE                 VALUE 'Y'.
   422     12  W-TEXT-BROWSED-SW       PIC  X(01) VALUE 'N'.
   423         88  W-TEXT-BROWSE-STARTED          VALUE 'Y'.
   424         88  W-TEXT-BROWSE-NOT-STARTED      VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  10
* EL689.cbl
   426 01  WS-SAVE-AREA.
   427     12  WS-SAV-AM-DEFN-1.
   428         16  WS-SAV-AM-AGT-COMMS OCCURS 10 TIMES.
   429             20  WS-SAV-AM-AGT             PIC  X(10).
   430             20  WS-SAV-AM-COM-TYP         PIC  X(01).
   431             20  FILLER                    PIC  X(15).
   432     12  WS-SAV-AM-REMIT-TO                PIC  9(02).
   433     12  WS-SAV-AM-CSR-CODE                PIC  X(04).
   434     12  WS-SAV-AM-CARRIER                 PIC  X(01).
   435     12  WS-SAV-AM-ACCOUNT                 PIC  X(10).
   436     12  WS-SAV-AM-CONTROL-NAME            PIC  X(30).
   437     12  WS-SAV-AM-NAME                    PIC  X(30).
   438     12  WS-SAV-AM-PERSON                  PIC  X(30).
   439     12  WS-SAV-AM-ADDRS                   PIC  X(30).
   440     12  WS-SAV-AM-CITY                    PIC  X(30).
   441     12  WS-SAV-AM-ERACCT-ACCOUNT          PIC  X(10).
   442     12  WS-SAV-AM-ZIP.
   443         16  WS-SAV-AM-ZIP-PRIME.
   444             20  WS-SAV-AM-ZIP-PRI-1ST     PIC  X(01).
   445                 88  SAVE-AM-CANADIAN-POST-CODE       VALUE
   446                     'A' THRU 'Z'.
   447             20  FILLER                    PIC  X(04).
   448         16  FILLER                        PIC  X(04).
   449     12  WS-SAV-AM-CANADIAN-POSTAL-CODE REDEFINES
   450                        WS-SAV-AM-ZIP      PIC  X(09).
   451     12  WS-SAV-AM-TEL-NO.
   452         16  WS-SAV-AM-AREA-CODE           PIC 9(03).
   453         16  WS-SAV-AM-TEL-PRE             PIC 9(03).
   454         16  WS-SAV-AM-TEL-NBR             PIC 9(04).
   455 01  W-KEY-AREAS.
   456     12  FILLER                    PIC  X(13)
   457                                      VALUE 'PROGRAM KEYS:'.
   458
   459     12  W-ACCT-SAVE-KEY           PIC  X(20).
   460     12  W-ACCT-KEY.
   461         16  W-ACCT-PARTIAL-KEY.
   462             20  W-ACCT-COMPANY-CD PIC  X(01).
   463             20  W-ACCT-CARRIER    PIC  X(01).
   464             20  W-ACCT-GROUPING   PIC  X(06).
   465             20  W-ACCT-STATE      PIC  X(02).
   466             20  W-ACCT-ACCOUNT    PIC  X(10).
   467         16  W-ACCT-EXP-DT         PIC  X(02).
   468
   469     12  W-ARCH-SAVE-KEY         PIC  X(05).
   470     12  W-ARCH-KEY.
   471         16  W-ARCH-PARTIAL-KEY.
   472             20  W-ARCH-COMPANY-CD
   473                                 PIC  X(01).
   474             20  W-ARCH-NUMBER   PIC S9(08)      COMP.
   475         16  W-ARCH-SEQ-NO       PIC S9(04)      COMP VALUE +0.
   476
   477     12  W-ARCT-KEY.
   478         16  W-ARCT-PARTIAL-KEY.
   479             20  W-ARCT-COMPANY-CD
   480                                 PIC  X(01).
   481             20  W-ARCT-NUMBER   PIC S9(08)      COMP.
   482         16  W-ARCT-REC-TYPE     PIC  X(01).
   483         16  W-ARCT-SEQ-NO       PIC S9(04)      COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  11
* EL689.cbl
   484
   485     12  W-CERT-KEY.
   486         16  W-CERT-COMPANY-CD   PIC  X(01).
   487         16  W-CERT-CARRIER      PIC  X(01).
   488         16  W-CERT-GROUPING     PIC  X(06).
   489         16  W-CERT-STATE        PIC  X(02).
   490         16  W-CERT-ACCOUNT      PIC  X(10).
   491         16  W-CERT-EFF-DT       PIC  X(02).
   492         16  W-CERT-CERT-NO.
   493             20  W-CERT-CERT-PRIME
   494                                 PIC  X(10).
   495             20  W-CERT-CERT-SFX PIC  X(01).
   496
   497     12  W-CHEK-KEY.
   498         16  W-CHEK-COMPANY-CD   PIC  X(01).
   499         16  W-CHEK-CARRIER      PIC  X(01).
   500         16  W-CHEK-GROUPING     PIC  X(06).
   501         16  W-CHEK-STATE        PIC  X(02).
   502         16  W-CHEK-ACCOUNT      PIC  X(10).
   503         16  W-CHEK-EFF-DT       PIC  X(02).
   504         16  W-CHEK-CERT-NO.
   505             20  W-CHEK-CERT-PRIME
   506                                 PIC  X(10).
   507             20  W-CHEK-CERT-SFX PIC  X(01).
   508         16  W-CHEK-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   509
   510     12  W-CNTL-KEY.
   511         16  W-CNTL-COMPANY-ID   PIC  X(03).
   512         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   513         16  W-CNTL-GENL.
   514             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   515             20  W-CNTL-GEN2.
   516                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   517                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   518         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   519
   520     12  W-COMP-SAVE-KEY         PIC  X(29).
   521     12  W-COMP-KEY.
   522         16  W-COMP-COMPANY-CD   PIC  X(01).
   523         16  W-COMP-CARRIER      PIC  X(01).
   524         16  W-COMP-GROUPING     PIC  X(06).
   525         16  W-COMP-RESP-PERSON.
   526             20  W-COMP-RP-CHAR OCCURS 10 TIMES
   527                                INDEXED BY W-COMP-NDX
   528                                 PIC  X(01).
   529         16  W-COMP-ACCOUNT      PIC  X(10).
   530         16  W-COMP-TYPE         PIC  X(01).
   531
   532     12  W-DELETE-KEY.
   533         16  W-DELETE-PARTIAL-KEY.
   534             20  W-DELETE-COMPANY-CD
   535                                 PIC  X(01).
   536             20  W-DELETE-NUMBER PIC S9(08)      COMP.
   537         16  W-DELETE-RECORD-TYPE
   538                                 PIC  X(01).
   539         16  W-DELETE-SEQ        PIC S9(04)      COMP VALUE +0.
   540
   541     12  W-MAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  12
* EL689.cbl
   542         16  W-MAIL-COMPANY-CD   PIC  X(01).
   543         16  W-MAIL-CARRIER      PIC  X(01).
   544         16  W-MAIL-GROUPING     PIC  X(06).
   545         16  W-MAIL-STATE        PIC  X(02).
   546         16  W-MAIL-ACCOUNT      PIC  X(10).
   547         16  W-MAIL-EFF-DT       PIC  X(02).
   548         16  W-MAIL-CERT-NO.
   549             20  W-MAIL-CERT-PRIME
   550                                 PIC  X(10).
   551             20  W-MAIL-CERT-SFX PIC  X(01).
   552
   553     12  W-PNDB-KEY.
   554         16  W-PNDB-COMPANY-CD   PIC  X(01).
   555         16  W-PNDB-ENTRY        PIC  X(06).
   556         16  W-PNDB-SEQ-NO       PIC S9(04)  COMP.
   557         16  W-PNDB-CHG-SEQ-NO   PIC S9(04)  COMP.
   558
   559     12  W-PNDB2-KEY.
   560         16  W-PNDB2-COMPANY-CD  PIC  X(01).
   561         16  W-PNDB2-CARRIER     PIC  X(01).
   562         16  W-PNDB2-GROUPING    PIC  X(06).
   563         16  W-PNDB2-STATE       PIC  X(02).
   564         16  W-PNDB2-ACCOUNT     PIC  X(10).
   565         16  W-PNDB2-EFF-DT      PIC  X(02).
   566         16  W-PNDB2-CERT-NO.
   567             20  W-PNDB2-CERT-PRIME
   568                                 PIC  X(10).
   569             20  W-PNDB2-CERT-SFX
   570                                 PIC  X(01).
   571         16  W-PNDB2-ALT-CHG-SEQ-NO
   572                                 PIC S9(04)  COMP.
   573         16  W-PNDB2-TYPE        PIC  X(01).
   574
   575     12  W-PYAJ-KEY.
   576         16  W-PYAJ-COMPANY-CD   PIC  X(01).
   577         16  W-PYAJ-CARRIER      PIC  X(01).
   578         16  W-PYAJ-GROUPING     PIC  X(06).
   579         16  W-PYAJ-FIN-RESP     PIC  X(10).
   580         16  W-PYAJ-ACCOUNT      PIC  X(10).
   581         16  W-PYAJ-FILE-SEQ-NO  PIC S9(08)    COMP.
   582         16  W-PYAJ-RECORD-TYPE  PIC  X(01).
   583
   584     12  W-SC-QUID-KEY.
   585         16  W-SC-QUID-TERMINAL  PIC  X(04).
   586         16  W-SC-QUID-SYSTEM    PIC  X(04).
   587
   588     12  W-TEXT-SAVE-KEY         PIC  X(05).
   589     12  W-TEXT-KEY.
   590         16  W-TEXT-PARTIAL-KEY.
   591             20  W-TEXT-COMPANY-CD
   592                                 PIC  X(01).
   593             20  W-TEXT-LETTER   PIC  X(04).
   594         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
   595         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
   596
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  13
* EL689.cbl
   598 01  FILLER                      PIC  X(22)
   599                                 VALUE 'INTERFACE AREA STARTS:'.
   600*    COPY ELCINTF.
   601******************************************************************
   602*                                                                *
   603*                                                                *
   604*                            ELCINTF.                            *
   605*                            VMOD=2.017                          *
   606*                                                                *
   607*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   608*                                                                *
   609*       LENGTH = 1024                                            *
   610*                                                                *
   611******************************************************************
   612 01  PROGRAM-INTERFACE-BLOCK.
   613     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   614     12  PI-CALLING-PROGRAM              PIC X(8).
   615     12  PI-SAVED-PROGRAM-1              PIC X(8).
   616     12  PI-SAVED-PROGRAM-2              PIC X(8).
   617     12  PI-SAVED-PROGRAM-3              PIC X(8).
   618     12  PI-SAVED-PROGRAM-4              PIC X(8).
   619     12  PI-SAVED-PROGRAM-5              PIC X(8).
   620     12  PI-SAVED-PROGRAM-6              PIC X(8).
   621     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   622     12  PI-COMPANY-ID                   PIC XXX.
   623     12  PI-COMPANY-CD                   PIC X.
   624
   625     12  PI-COMPANY-PASSWORD             PIC X(8).
   626
   627     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   628
   629     12  PI-CONTROL-IN-PROGRESS.
   630         16  PI-CARRIER                  PIC X.
   631         16  PI-GROUPING                 PIC X(6).
   632         16  PI-STATE                    PIC XX.
   633         16  PI-ACCOUNT                  PIC X(10).
   634         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   635                                         PIC X(10).
   636         16  PI-CLAIM-CERT-GRP.
   637             20  PI-CLAIM-NO             PIC X(7).
   638             20  PI-CERT-NO.
   639                 25  PI-CERT-PRIME       PIC X(10).
   640                 25  PI-CERT-SFX         PIC X.
   641             20  PI-CERT-EFF-DT          PIC XX.
   642         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   643             20  PI-PLAN-CODE            PIC X(2).
   644             20  PI-REVISION-NUMBER      PIC X(3).
   645             20  PI-PLAN-EFF-DT          PIC X(2).
   646             20  PI-PLAN-EXP-DT          PIC X(2).
   647             20  FILLER                  PIC X(11).
   648         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   649             20  PI-OE-REFERENCE-1.
   650                 25  PI-OE-REF-1-PRIME   PIC X(18).
   651                 25  PI-OE-REF-1-SUFF    PIC XX.
   652
   653     12  PI-SESSION-IN-PROGRESS          PIC X.
   654         88  CLAIM-SESSION                   VALUE '1'.
   655         88  CREDIT-SESSION                  VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  14
* EL689.cbl
   656         88  WARRANTY-SESSION                VALUE '3'.
   657         88  MORTGAGE-SESSION                VALUE '4'.
   658         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   659
   660
   661*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   662
   663     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   664     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   665
   666     12  PI-CREDIT-USER                  PIC X.
   667         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   668         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   669
   670     12  PI-CLAIM-USER                   PIC X.
   671         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   672         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   673
   674     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   675         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   676         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   677         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   678         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   679         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   680
   681     12  PI-PROCESSOR-ID                 PIC X(4).
   682
   683     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   684
   685     12  PI-MEMBER-CAPTION               PIC X(10).
   686
   687     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   688         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   689
   690     12  PI-LIFE-OVERRIDE-L1             PIC X.
   691     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   692     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   693     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   694
   695     12  PI-AH-OVERRIDE-L1               PIC X.
   696     12  PI-AH-OVERRIDE-L2               PIC XX.
   697     12  PI-AH-OVERRIDE-L6               PIC X(6).
   698     12  PI-AH-OVERRIDE-L12              PIC X(12).
   699
   700     12  PI-NEW-SYSTEM                   PIC X(2).
   701
   702     12  PI-PRIMARY-CERT-NO              PIC X(11).
   703     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   704         88  PI-USES-PAID-TO                 VALUE '1'.
   705     12  PI-CRDTCRD-SYSTEM.
   706         16  PI-CRDTCRD-USER             PIC X.
   707             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   708             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   709         16  PI-CC-MONTH-END-DT          PIC XX.
   710     12  PI-PROCESSOR-PRINTER            PIC X(4).
   711
   712     12  PI-OE-REFERENCE-2.
   713         16  PI-OE-REF-2-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  15
* EL689.cbl
   714         16  PI-OE-REF-2-SUFF            PIC X.
   715
   716     12  PI-REM-TRM-CALC-OPTION          PIC X.
   717
   718     12  PI-LANGUAGE-TYPE                PIC X.
   719             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   720             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   721             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   722
   723     12  PI-POLICY-LINKAGE-IND           PIC X.
   724         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   725         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   726                                                   LOW-VALUES.
   727
   728     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   729     12  PI-CLAIM-PW-SESSION             PIC X(1).
   730         88  PI-CLAIM-CREDIT                 VALUE '1'.
   731         88  PI-CLAIM-CONVEN                 VALUE '2'.
   732     12  FILLER                          PIC X(4).
   733
   734     12  PI-SYSTEM-LEVEL                 PIC X(145).
   735
   736     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   737         PI-SYSTEM-LEVEL.
   738
   739         16  PI-ENTRY-CODES.
   740             20  PI-ENTRY-CD-1           PIC X.
   741             20  PI-ENTRY-CD-2           PIC X.
   742
   743         16  PI-RETURN-CODES.
   744             20  PI-RETURN-CD-1          PIC X.
   745             20  PI-RETURN-CD-2          PIC X.
   746
   747         16  PI-UPDATE-STATUS-SAVE.
   748             20  PI-UPDATE-BY            PIC X(4).
   749             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   750
   751         16  PI-LOWER-CASE-LETTERS       PIC X.
   752             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   753
   754*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   755*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   756*            88  CARRIER-CLM-CNTL            VALUE '2'.
   757
   758         16  PI-CERT-ACCESS-CONTROL      PIC X.
   759             88  ST-ACCNT-CNTL               VALUE ' '.
   760             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   761             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   762             88  ACCNT-CNTL                  VALUE '3'.
   763             88  CARR-ACCNT-CNTL             VALUE '4'.
   764
   765         16  PI-PROCESSOR-CAP-LIST.
   766             20  PI-SYSTEM-CONTROLS.
   767                24 PI-SYSTEM-DISPLAY     PIC X.
   768                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   769                24 PI-SYSTEM-MODIFY      PIC X.
   770                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   771             20  FILLER                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  16
* EL689.cbl
   772             20  PI-DISPLAY-CAP          PIC X.
   773                 88  DISPLAY-CAP             VALUE 'Y'.
   774             20  PI-MODIFY-CAP           PIC X.
   775                 88  MODIFY-CAP              VALUE 'Y'.
   776             20  PI-MSG-AT-LOGON-CAP     PIC X.
   777                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   778             20  PI-FORCE-CAP            PIC X.
   779                 88  FORCE-CAP               VALUE 'Y'.
   780
   781         16  PI-PROGRAM-CONTROLS.
   782             20  PI-PGM-PRINT-OPT        PIC X.
   783             20  PI-PGM-FORMAT-OPT       PIC X.
   784             20  PI-PGM-PROCESS-OPT      PIC X.
   785             20  PI-PGM-TOTALS-OPT       PIC X.
   786
   787         16  PI-HELP-INTERFACE.
   788             20  PI-LAST-ERROR-NO        PIC X(4).
   789             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   790
   791         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   792             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   793
   794         16  PI-CR-CONTROL-IN-PROGRESS.
   795             20  PI-CR-CARRIER           PIC X.
   796             20  PI-CR-GROUPING          PIC X(6).
   797             20  PI-CR-STATE             PIC XX.
   798             20  PI-CR-ACCOUNT           PIC X(10).
   799             20  PI-CR-FIN-RESP          PIC X(10).
   800             20  PI-CR-TYPE              PIC X.
   801
   802         16  PI-CR-BATCH-NUMBER          PIC X(6).
   803
   804         16  PI-CR-MONTH-END-DT          PIC XX.
   805
   806         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   807             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   808             88  PI-ZERO-CARRIER             VALUE '1'.
   809             88  PI-ZERO-GROUPING            VALUE '2'.
   810             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   811
   812         16  PI-CARRIER-SECURITY         PIC X.
   813             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   814
   815         16  PI-ACCOUNT-SECURITY         PIC X(10).
   816             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   817             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   818
   819         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   820             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   821                                         INDEXED BY PI-ACCESS-NDX
   822                                         PIC X.
   823
   824         16  PI-GA-BILLING-CONTROL       PIC X.
   825             88  PI-GA-BILLING               VALUE '1'.
   826
   827         16  PI-MAIL-PROCESSING          PIC X.
   828             88  PI-MAIL-YES                 VALUE 'Y'.
   829
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  17
* EL689.cbl
   830         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   831
   832         16  PI-AR-SYSTEM.
   833             20  PI-AR-PROCESSING-CNTL   PIC X.
   834                 88  PI-AR-PROCESSING        VALUE 'Y'.
   835             20  PI-AR-SUMMARY-CODE      PIC X(6).
   836             20  PI-AR-MONTH-END-DT      PIC XX.
   837
   838         16  PI-MP-SYSTEM.
   839             20  PI-MORTGAGE-USER            PIC X.
   840                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   841                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   842             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   843                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   844                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   845                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   846                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   847                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   848             20  PI-MP-MONTH-END-DT          PIC XX.
   849             20  PI-MP-REFERENCE-NO.
   850                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   851                 24  PI-MP-REFERENCE-SFX     PIC XX.
   852
   853         16  PI-LABEL-CONTROL            PIC X(01).
   854             88  PI-CREATE-LABELS                    VALUE 'Y'.
   855             88  PI-BYPASS-LABELS                    VALUE 'N'.
   856
   857         16  PI-BILL-GROUPING-CODE       PIC X(01).
   858             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   859
   860         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   861             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   862             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   863
   864         16  FILLER                      PIC X(14).
   865
   866     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   867******************************************************************
   868     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   869*    COPY ELC1042.
   870******************************************************************
   871*                                                                *
   872*                                                                *
   873*                           ELC1042                              *
   874*                            VMOD=2.002                          *
   875*                                                                *
   876*    NOTE                                                        *
   877*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   878*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   879*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   880*        TO THESE PROGRAMS.                                      *
   881*                                                                *
   882*    NOTE                                                        *
   883*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   884*        USE ONLY!                                               *
   885*                                                                *
   886******************************************************************
   887
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  18
* EL689.cbl
   888         16  PI-1042-WA.
   889             20  PI-ACTION       PIC  X(01).
   890                 88 PI-SHOW-MODE           VALUE '1'.
   891                 88 PI-CLEAR-MODE          VALUE '2'.
   892                 88 PI-CREATE-MODE         VALUE '3'.
   893             20  PI-COMM-CONTROL PIC  X(12).
   894             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   895             20  PI-EOF-SW       PIC  X(01).
   896                 88  PI-FILE-EOF           VALUE 'Y'.
   897             20  PI-FILETYP      PIC  X(01).
   898             20  PI-FORM-SQUEEZE-CONTROL
   899                                 PIC  X(01).
   900                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   901                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   902             20  PI-LAST-CONTROL PIC  X(12).
   903             20  PI-TEMP-STOR-ITEMS
   904                                 PIC S9(04) COMP.
   905             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   906             20  PI-UPDATE-SW    PIC  9(01).
   907                 88 ANY-UPDATES            VALUE 1.
   908             20  PI-104-SCREEN-SENT-IND
   909                                 PIC  X(01).
   910                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   911                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   912             20  PI-1042-SCREEN-SENT-IND
   913                                 PIC  X(01).
   914                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   915                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   916             20  PI-1042-ARCHIVE-IND
   917                                 PIC  X(01).
   918                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   919             20  FILLER          PIC  X(29).
   920*    COPY ELC689PI.
   921******************************************************************
   922*                                                                *
   923*                            ELC689PI                            *
   924*                            VMOD=2.003                          *
   925*                                                                *
   926*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   927*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
   928*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   929*                                                                *
   930*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   931*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   932*    BETWEEN PROGRAMS.                                           *
   933*                                                                *
   934*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   935*                                                                *
   936*               EL631 - EL689  - EL6891 - EL6892                 *
   937*                                                                *
   938******************************************************************
   939*                   C H A N G E   L O G
   940*
   941* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   942*-----------------------------------------------------------------
   943*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   944* EFFECTIVE    NUMBER
   945*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  19
* EL689.cbl
   946* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
   947* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
   948* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   949******************************************************************
   950
   951
   952         16  PI-689-WORK-AREA.
   953             20  PI-689-ALT-PRINTER-ID
   954                                 PIC  X(04).
   955             20  PI-689-ARCHIVE-NUMBER
   956                                 PIC  9(08).
   957             20  PI-689-ARCHIVE-SW
   958                                 PIC  X(01).
   959                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
   960             20  PI-689-DATA-SOURCE
   961                                 PIC  X(01).
   962                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
   963                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
   964                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
   965                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
   966                 88  PI-689-SRC-CHECKS         VALUE '5'.
   967             20  PI-689-ERROR-IND
   968                                 PIC  X(01).
   969                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
   970             20  PI-689-ERROR    PIC  9(04).
   971                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
   972                 88  PI-689-FATAL-ERROR
   973                     VALUES 0004 0006 0008 0013 0023 0029 0033
   974                            0042 0047 0051 0066 0067 0070
   975                            0168 0169 0174 0175 0176 0177 0179
   976                            0180 0181 0182 0184 0185 0189 0190
   977                            0191
   978                            0215 0279 0280
   979                            0412 0413 0454
   980                            0533 0537
   981                            2055 2114 2208 2209 2216 2232 2369
   982                            2398 2433 2908 2999
   983                            3000 3770 3771 3775
   984                            7250 7365 7367 7368 7369 7370 7371
   985                            7272 7373 7374 7376 7377 7378 7379
   986                            7381 7388 7390 7393 7395 7396 7398
   987                            9095 9096 9281 9298 9299 9320 9327
   988                            9426 9427.
   989                 88  PI-689-STOP-ERROR
   990                     VALUES 0004 0008 0013 0023 0029 0033
   991                            0042 0047 0066 0067 0070
   992                            0168 0169 0174 0175 0176 0177
   993                            0181 0182 0184 0185 0189 0190
   994                            0279 0280
   995                            0412 0413 0454
   996                            2055 2208 2209 2216 2232
   997                            2398 2999
   998                            3000 3770 3771 3775
   999                            7250 7365 7369 7370 7371
  1000                            7272 7373 7374 7376 7377 7378 7379
  1001                            7381 7388 7390 7393 7396 7398
  1002                            9095 9096 9299 9320 9426.
  1003             20  PI-689-FOLLOW-UP-DATE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  20
* EL689.cbl
  1004                                 PIC  X(02).
  1005             20  PI-689-FORM-NUMBER
  1006                                 PIC  X(04).
  1007             20  PI-689-LABEL-SOURCE
  1008                                 PIC X(01).
  1009                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1010                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1011                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1012                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1013                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1014                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1015                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1016             20  PI-689-NUMBER-COPIES
  1017                                 PIC  9(01).
  1018             20  PI-689-NUMBER-LABEL-LINES
  1019                                 PIC  9(01).
  1020             20  PI-689-NUMBER-TEXT-RECORDS
  1021                                 PIC  9(03).
  1022             20  PI-689-PRINT-ORDER-SW
  1023                                 PIC  X(01).
  1024                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1025                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1026                 88  PI-689-PRINT-LATER     VALUE '3'.
  1027                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1028             20  PI-689-PRINT-RESTRICTION
  1029                                 PIC  X(01).
  1030                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1031                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1032                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1033             20  PI-689-PRINT-SW PIC  X(01).
  1034                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1035             20  PI-689-RESEND-DATE-1
  1036                                 PIC  X(02).
  1037             20  PI-689-RESEND-LETR-1
  1038                                 PIC X(4).
  1039             20  PI-689-TEMP-STOR-ID
  1040                                 PIC  X(08).
  1041             20  PI-689-USE-SCREEN-IND
  1042                                 PIC  X(01).
  1043                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1044             20  PI-689-ARCH-POINTER
  1045                                 PIC S9(08) COMP.
  1046                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  1047             20  PI-689-ARCT-POINTER
  1048                                 PIC S9(08) COMP.
  1049                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1050             20  PI-689-VARIABLE-DATA-GRP.
  1051                 24  PI-689-VARIABLE-DATA-1
  1052                                 PIC  X(30).
  1053                 24  PI-689-VARIABLE-DATA-2
  1054                                 PIC  X(30).
  1055                 24  PI-689-VARIABLE-DATA-3
  1056                                 PIC  X(30).
  1057                 24  PI-689-VARIABLE-DATA-4
  1058                                 PIC  X(30).
  1059
  1060         16  PI-689-KEY-DATA-FIELDS.
  1061             20  PI-689-ACCOUNT  PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  21
* EL689.cbl
  1062             20  PI-689-CARRIER  PIC  X(01).
  1063             20  PI-689-CERT-NO.
  1064                 24  PI-689-CERT-PRIME
  1065                                 PIC  X(10).
  1066                 24  PI-689-CERT-SFX
  1067                                 PIC  X(01).
  1068             20  PI-689-CHG-SEQ-NO
  1069                                 PIC S9(04)    COMP.
  1070             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1071                                 PIC  X(02).
  1072             20  PI-689-ENTRY-BATCH
  1073                                 PIC  X(06).
  1074             20  PI-689-EFF-DATE PIC  X(02).
  1075             20  PI-689-EXP-DATE PIC  X(02).
  1076             20  PI-689-GROUPING PIC  X(06).
  1077             20  PI-689-RESP-PERSON
  1078                                 PIC  X(10).
  1079             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1080             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1081                                 PIC  X(04).
  1082             20  PI-689-STATE    PIC  X(02).
  1083             20  PI-689-TYPE     PIC  X(01).
  1084             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1085             20  PI-689-ALT-SEQ-NO
  1086                                 PIC S9(04)    COMP.
  1087         16  PI-689-DATE-EDIT    PIC  X(08).
  1088         16  PI-689-FOLLOW-UP-EDIT
  1089                                 PIC  X(08).
  1090         16  PI-689-RESEND1-EDIT PIC  X(08).
  1091         16  PI-689-SEQ-EDIT     PIC  X(08).
  1092         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1093         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1094             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1095         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1096         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1097         16  FILLER              PIC X(264).
  1098*        16  FILLER                        PIC X(276).
  1099*        16  FILLER                        PIC X(280).
  1100
  1101 01  FILLER                      PIC  X(20)
  1102                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  22
* EL689.cbl
  1104 01  FILLER                      PIC  X(16)
  1105                        VALUE 'MAP AREA STARTS:'.
  1106*    COPY EL689S.
  1107 01  EL689AI.
  1108     05  FILLER            PIC  X(0012).
  1109*    -------------------------------
  1110     05  RUNDTEL PIC S9(0004) COMP.
  1111     05  RUNDTEF PIC  X(0001).
  1112     05  FILLER REDEFINES RUNDTEF.
  1113         10  RUNDTEA PIC  X(0001).
  1114     05  RUNDTEI PIC  X(0008).
  1115*    -------------------------------
  1116     05  RUNTIMEL PIC S9(0004) COMP.
  1117     05  RUNTIMEF PIC  X(0001).
  1118     05  FILLER REDEFINES RUNTIMEF.
  1119         10  RUNTIMEA PIC  X(0001).
  1120     05  RUNTIMEI PIC  X(0005).
  1121*    -------------------------------
  1122     05  COMPANYL PIC S9(0004) COMP.
  1123     05  COMPANYF PIC  X(0001).
  1124     05  FILLER REDEFINES COMPANYF.
  1125         10  COMPANYA PIC  X(0001).
  1126     05  COMPANYI PIC  X(0003).
  1127*    -------------------------------
  1128     05  USERIDL PIC S9(0004) COMP.
  1129     05  USERIDF PIC  X(0001).
  1130     05  FILLER REDEFINES USERIDF.
  1131         10  USERIDA PIC  X(0001).
  1132     05  USERIDI PIC  X(0004).
  1133*    -------------------------------
  1134     05  MAINTL PIC S9(0004) COMP.
  1135     05  MAINTF PIC  X(0001).
  1136     05  FILLER REDEFINES MAINTF.
  1137         10  MAINTA PIC  X(0001).
  1138     05  MAINTI PIC  X(0001).
  1139*    -------------------------------
  1140     05  FORML PIC S9(0004) COMP.
  1141     05  FORMF PIC  X(0001).
  1142     05  FILLER REDEFINES FORMF.
  1143         10  FORMA PIC  X(0001).
  1144     05  FORMI PIC  X(0004).
  1145*    -------------------------------
  1146     05  ARCHNUML PIC S9(0004) COMP.
  1147     05  ARCHNUMF PIC  X(0001).
  1148     05  FILLER REDEFINES ARCHNUMF.
  1149         10  ARCHNUMA PIC  X(0001).
  1150     05  ARCHNUMI PIC  99999999.
  1151*    -------------------------------
  1152     05  PRTRESTL PIC S9(0004) COMP.
  1153     05  PRTRESTF PIC  X(0001).
  1154     05  FILLER REDEFINES PRTRESTF.
  1155         10  PRTRESTA PIC  X(0001).
  1156     05  PRTRESTI PIC  X(0001).
  1157*    -------------------------------
  1158     05  FOLLOWL PIC S9(0004) COMP.
  1159     05  FOLLOWF PIC  X(0001).
  1160     05  FILLER REDEFINES FOLLOWF.
  1161         10  FOLLOWA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  23
* EL689.cbl
  1162     05  FOLLOWI PIC  X(0008).
  1163*    -------------------------------
  1164     05  RESEND1L PIC S9(0004) COMP.
  1165     05  RESEND1F PIC  X(0001).
  1166     05  FILLER REDEFINES RESEND1F.
  1167         10  RESEND1A PIC  X(0001).
  1168     05  RESEND1I PIC  X(0008).
  1169*    -------------------------------
  1170     05  ADDRSL PIC S9(0004) COMP.
  1171     05  ADDRSF PIC  X(0001).
  1172     05  FILLER REDEFINES ADDRSF.
  1173         10  ADDRSA PIC  X(0001).
  1174     05  ADDRSI PIC  X(0001).
  1175*    -------------------------------
  1176     05  PRINTERL PIC S9(0004) COMP.
  1177     05  PRINTERF PIC  X(0001).
  1178     05  FILLER REDEFINES PRINTERF.
  1179         10  PRINTERA PIC  X(0001).
  1180     05  PRINTERI PIC  X(0004).
  1181*    -------------------------------
  1182     05  COPIESL PIC S9(0004) COMP.
  1183     05  COPIESF PIC  X(0001).
  1184     05  FILLER REDEFINES COPIESF.
  1185         10  COPIESA PIC  X(0001).
  1186     05  COPIESI PIC  X(0001).
  1187*    -------------------------------
  1188     05  DATASORL PIC S9(0004) COMP.
  1189     05  DATASORF PIC  X(0001).
  1190     05  FILLER REDEFINES DATASORF.
  1191         10  DATASORA PIC  X(0001).
  1192     05  DATASORI PIC  X(0001).
  1193*    -------------------------------
  1194     05  ADDRLBLL PIC S9(0004) COMP.
  1195     05  ADDRLBLF PIC  X(0001).
  1196     05  FILLER REDEFINES ADDRLBLF.
  1197         10  ADDRLBLA PIC  X(0001).
  1198     05  ADDRLBLI PIC  X(0001).
  1199*    -------------------------------
  1200     05  CARRIERL PIC S9(0004) COMP.
  1201     05  CARRIERF PIC  X(0001).
  1202     05  FILLER REDEFINES CARRIERF.
  1203         10  CARRIERA PIC  X(0001).
  1204     05  CARRIERI PIC  X(0001).
  1205*    -------------------------------
  1206     05  GROUPL PIC S9(0004) COMP.
  1207     05  GROUPF PIC  X(0001).
  1208     05  FILLER REDEFINES GROUPF.
  1209         10  GROUPA PIC  X(0001).
  1210     05  GROUPI PIC  X(0006).
  1211*    -------------------------------
  1212     05  STATEL PIC S9(0004) COMP.
  1213     05  STATEF PIC  X(0001).
  1214     05  FILLER REDEFINES STATEF.
  1215         10  STATEA PIC  X(0001).
  1216     05  STATEI PIC  X(0002).
  1217*    -------------------------------
  1218     05  ACCTL PIC S9(0004) COMP.
  1219     05  ACCTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  24
* EL689.cbl
  1220     05  FILLER REDEFINES ACCTF.
  1221         10  ACCTA PIC  X(0001).
  1222     05  ACCTI PIC  X(0010).
  1223*    -------------------------------
  1224     05  CERTL PIC S9(0004) COMP.
  1225     05  CERTF PIC  X(0001).
  1226     05  FILLER REDEFINES CERTF.
  1227         10  CERTA PIC  X(0001).
  1228     05  CERTI PIC  X(0010).
  1229*    -------------------------------
  1230     05  SFXL PIC S9(0004) COMP.
  1231     05  SFXF PIC  X(0001).
  1232     05  FILLER REDEFINES SFXF.
  1233         10  SFXA PIC  X(0001).
  1234     05  SFXI PIC  X(0001).
  1235*    -------------------------------
  1236     05  TYPEL PIC S9(0004) COMP.
  1237     05  TYPEF PIC  X(0001).
  1238     05  FILLER REDEFINES TYPEF.
  1239         10  TYPEA PIC  X(0001).
  1240     05  TYPEI PIC  X(0001).
  1241*    -------------------------------
  1242     05  DATEL PIC S9(0004) COMP.
  1243     05  DATEF PIC  X(0001).
  1244     05  FILLER REDEFINES DATEF.
  1245         10  DATEA PIC  X(0001).
  1246     05  DATEI PIC  X(0008).
  1247*    -------------------------------
  1248     05  RPERSONL PIC S9(0004) COMP.
  1249     05  RPERSONF PIC  X(0001).
  1250     05  FILLER REDEFINES RPERSONF.
  1251         10  RPERSONA PIC  X(0001).
  1252     05  RPERSONI PIC  X(0010).
  1253*    -------------------------------
  1254     05  BENTRYL PIC S9(0004) COMP.
  1255     05  BENTRYF PIC  X(0001).
  1256     05  FILLER REDEFINES BENTRYF.
  1257         10  BENTRYA PIC  X(0001).
  1258     05  BENTRYI PIC  X(0006).
  1259*    -------------------------------
  1260     05  SEQL PIC S9(0004) COMP.
  1261     05  SEQF PIC  X(0001).
  1262     05  FILLER REDEFINES SEQF.
  1263         10  SEQA PIC  X(0001).
  1264     05  SEQI PIC  X(0008).
  1265*    -------------------------------
  1266     05  BCSEQL PIC S9(0004) COMP.
  1267     05  BCSEQF PIC  X(0001).
  1268     05  FILLER REDEFINES BCSEQF.
  1269         10  BCSEQA PIC  X(0001).
  1270     05  BCSEQI PIC  X(0004).
  1271*    -------------------------------
  1272     05  L1L PIC S9(0004) COMP.
  1273     05  L1F PIC  X(0001).
  1274     05  FILLER REDEFINES L1F.
  1275         10  L1A PIC  X(0001).
  1276     05  L1I PIC  X(0003).
  1277*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  25
* EL689.cbl
  1278     05  TEXT1L PIC S9(0004) COMP.
  1279     05  TEXT1F PIC  X(0001).
  1280     05  FILLER REDEFINES TEXT1F.
  1281         10  TEXT1A PIC  X(0001).
  1282     05  TEXT1I PIC  X(0070).
  1283*    -------------------------------
  1284     05  L2L PIC S9(0004) COMP.
  1285     05  L2F PIC  X(0001).
  1286     05  FILLER REDEFINES L2F.
  1287         10  L2A PIC  X(0001).
  1288     05  L2I PIC  X(0003).
  1289*    -------------------------------
  1290     05  TEXT2L PIC S9(0004) COMP.
  1291     05  TEXT2F PIC  X(0001).
  1292     05  FILLER REDEFINES TEXT2F.
  1293         10  TEXT2A PIC  X(0001).
  1294     05  TEXT2I PIC  X(0070).
  1295*    -------------------------------
  1296     05  L3L PIC S9(0004) COMP.
  1297     05  L3F PIC  X(0001).
  1298     05  FILLER REDEFINES L3F.
  1299         10  L3A PIC  X(0001).
  1300     05  L3I PIC  X(0003).
  1301*    -------------------------------
  1302     05  TEXT3L PIC S9(0004) COMP.
  1303     05  TEXT3F PIC  X(0001).
  1304     05  FILLER REDEFINES TEXT3F.
  1305         10  TEXT3A PIC  X(0001).
  1306     05  TEXT3I PIC  X(0070).
  1307*    -------------------------------
  1308     05  L4L PIC S9(0004) COMP.
  1309     05  L4F PIC  X(0001).
  1310     05  FILLER REDEFINES L4F.
  1311         10  L4A PIC  X(0001).
  1312     05  L4I PIC  X(0003).
  1313*    -------------------------------
  1314     05  TEXT4L PIC S9(0004) COMP.
  1315     05  TEXT4F PIC  X(0001).
  1316     05  FILLER REDEFINES TEXT4F.
  1317         10  TEXT4A PIC  X(0001).
  1318     05  TEXT4I PIC  X(0070).
  1319*    -------------------------------
  1320     05  L5L PIC S9(0004) COMP.
  1321     05  L5F PIC  X(0001).
  1322     05  FILLER REDEFINES L5F.
  1323         10  L5A PIC  X(0001).
  1324     05  L5I PIC  X(0003).
  1325*    -------------------------------
  1326     05  TEXT5L PIC S9(0004) COMP.
  1327     05  TEXT5F PIC  X(0001).
  1328     05  FILLER REDEFINES TEXT5F.
  1329         10  TEXT5A PIC  X(0001).
  1330     05  TEXT5I PIC  X(0070).
  1331*    -------------------------------
  1332     05  L6L PIC S9(0004) COMP.
  1333     05  L6F PIC  X(0001).
  1334     05  FILLER REDEFINES L6F.
  1335         10  L6A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  26
* EL689.cbl
  1336     05  L6I PIC  X(0003).
  1337*    -------------------------------
  1338     05  TEXT6L PIC S9(0004) COMP.
  1339     05  TEXT6F PIC  X(0001).
  1340     05  FILLER REDEFINES TEXT6F.
  1341         10  TEXT6A PIC  X(0001).
  1342     05  TEXT6I PIC  X(0070).
  1343*    -------------------------------
  1344     05  L7L PIC S9(0004) COMP.
  1345     05  L7F PIC  X(0001).
  1346     05  FILLER REDEFINES L7F.
  1347         10  L7A PIC  X(0001).
  1348     05  L7I PIC  X(0003).
  1349*    -------------------------------
  1350     05  TEXT7L PIC S9(0004) COMP.
  1351     05  TEXT7F PIC  X(0001).
  1352     05  FILLER REDEFINES TEXT7F.
  1353         10  TEXT7A PIC  X(0001).
  1354     05  TEXT7I PIC  X(0070).
  1355*    -------------------------------
  1356     05  L8L PIC S9(0004) COMP.
  1357     05  L8F PIC  X(0001).
  1358     05  FILLER REDEFINES L8F.
  1359         10  L8A PIC  X(0001).
  1360     05  L8I PIC  X(0003).
  1361*    -------------------------------
  1362     05  TEXT8L PIC S9(0004) COMP.
  1363     05  TEXT8F PIC  X(0001).
  1364     05  FILLER REDEFINES TEXT8F.
  1365         10  TEXT8A PIC  X(0001).
  1366     05  TEXT8I PIC  X(0070).
  1367*    -------------------------------
  1368     05  L9L PIC S9(0004) COMP.
  1369     05  L9F PIC  X(0001).
  1370     05  FILLER REDEFINES L9F.
  1371         10  L9A PIC  X(0001).
  1372     05  L9I PIC  X(0003).
  1373*    -------------------------------
  1374     05  TEXT9L PIC S9(0004) COMP.
  1375     05  TEXT9F PIC  X(0001).
  1376     05  FILLER REDEFINES TEXT9F.
  1377         10  TEXT9A PIC  X(0001).
  1378     05  TEXT9I PIC  X(0070).
  1379*    -------------------------------
  1380     05  L10L PIC S9(0004) COMP.
  1381     05  L10F PIC  X(0001).
  1382     05  FILLER REDEFINES L10F.
  1383         10  L10A PIC  X(0001).
  1384     05  L10I PIC  X(0003).
  1385*    -------------------------------
  1386     05  TEXT10L PIC S9(0004) COMP.
  1387     05  TEXT10F PIC  X(0001).
  1388     05  FILLER REDEFINES TEXT10F.
  1389         10  TEXT10A PIC  X(0001).
  1390     05  TEXT10I PIC  X(0070).
  1391*    -------------------------------
  1392     05  L11L PIC S9(0004) COMP.
  1393     05  L11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  27
* EL689.cbl
  1394     05  FILLER REDEFINES L11F.
  1395         10  L11A PIC  X(0001).
  1396     05  L11I PIC  X(0003).
  1397*    -------------------------------
  1398     05  TEXT11L PIC S9(0004) COMP.
  1399     05  TEXT11F PIC  X(0001).
  1400     05  FILLER REDEFINES TEXT11F.
  1401         10  TEXT11A PIC  X(0001).
  1402     05  TEXT11I PIC  X(0070).
  1403*    -------------------------------
  1404     05  L12L PIC S9(0004) COMP.
  1405     05  L12F PIC  X(0001).
  1406     05  FILLER REDEFINES L12F.
  1407         10  L12A PIC  X(0001).
  1408     05  L12I PIC  X(0003).
  1409*    -------------------------------
  1410     05  TEXT12L PIC S9(0004) COMP.
  1411     05  TEXT12F PIC  X(0001).
  1412     05  FILLER REDEFINES TEXT12F.
  1413         10  TEXT12A PIC  X(0001).
  1414     05  TEXT12I PIC  X(0070).
  1415*    -------------------------------
  1416     05  ERRMSGL PIC S9(0004) COMP.
  1417     05  ERRMSGF PIC  X(0001).
  1418     05  FILLER REDEFINES ERRMSGF.
  1419         10  ERRMSGA PIC  X(0001).
  1420     05  ERRMSGI PIC  X(0079).
  1421*    -------------------------------
  1422     05  ENTERPFL PIC S9(0004) COMP.
  1423     05  ENTERPFF PIC  X(0001).
  1424     05  FILLER REDEFINES ENTERPFF.
  1425         10  ENTERPFA PIC  X(0001).
  1426     05  ENTERPFI PIC  99.
  1427*    -------------------------------
  1428     05  PF8HDL PIC S9(0004) COMP.
  1429     05  PF8HDF PIC  X(0001).
  1430     05  FILLER REDEFINES PF8HDF.
  1431         10  PF8HDA PIC  X(0001).
  1432     05  PF8HDI PIC  X(0022).
  1433 01  EL689AO REDEFINES EL689AI.
  1434     05  FILLER            PIC  X(0012).
  1435*    -------------------------------
  1436     05  FILLER            PIC  X(0003).
  1437     05  RUNDTEO PIC  X(0008).
  1438*    -------------------------------
  1439     05  FILLER            PIC  X(0003).
  1440     05  RUNTIMEO PIC  99.99.
  1441*    -------------------------------
  1442     05  FILLER            PIC  X(0003).
  1443     05  COMPANYO PIC  X(0003).
  1444*    -------------------------------
  1445     05  FILLER            PIC  X(0003).
  1446     05  USERIDO PIC  X(0004).
  1447*    -------------------------------
  1448     05  FILLER            PIC  X(0003).
  1449     05  MAINTO PIC  X(0001).
  1450*    -------------------------------
  1451     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  28
* EL689.cbl
  1452     05  FORMO PIC  X(0004).
  1453*    -------------------------------
  1454     05  FILLER            PIC  X(0003).
  1455     05  ARCHNUMO PIC  ZZZZZZZ9.
  1456*    -------------------------------
  1457     05  FILLER            PIC  X(0003).
  1458     05  PRTRESTO PIC  X(0001).
  1459*    -------------------------------
  1460     05  FILLER            PIC  X(0003).
  1461     05  FOLLOWO PIC  X(0008).
  1462*    -------------------------------
  1463     05  FILLER            PIC  X(0003).
  1464     05  RESEND1O PIC  X(0008).
  1465*    -------------------------------
  1466     05  FILLER            PIC  X(0003).
  1467     05  ADDRSO PIC  X(0001).
  1468*    -------------------------------
  1469     05  FILLER            PIC  X(0003).
  1470     05  PRINTERO PIC  X(0004).
  1471*    -------------------------------
  1472     05  FILLER            PIC  X(0003).
  1473     05  COPIESO PIC  X(0001).
  1474*    -------------------------------
  1475     05  FILLER            PIC  X(0003).
  1476     05  DATASORO PIC  X(0001).
  1477*    -------------------------------
  1478     05  FILLER            PIC  X(0003).
  1479     05  ADDRLBLO PIC  X(0001).
  1480*    -------------------------------
  1481     05  FILLER            PIC  X(0003).
  1482     05  CARRIERO PIC  X(0001).
  1483*    -------------------------------
  1484     05  FILLER            PIC  X(0003).
  1485     05  GROUPO PIC  X(0006).
  1486*    -------------------------------
  1487     05  FILLER            PIC  X(0003).
  1488     05  STATEO PIC  X(0002).
  1489*    -------------------------------
  1490     05  FILLER            PIC  X(0003).
  1491     05  ACCTO PIC  X(0010).
  1492*    -------------------------------
  1493     05  FILLER            PIC  X(0003).
  1494     05  CERTO PIC  X(0010).
  1495*    -------------------------------
  1496     05  FILLER            PIC  X(0003).
  1497     05  SFXO PIC  X(0001).
  1498*    -------------------------------
  1499     05  FILLER            PIC  X(0003).
  1500     05  TYPEO PIC  X(0001).
  1501*    -------------------------------
  1502     05  FILLER            PIC  X(0003).
  1503     05  DATEO PIC  X(0008).
  1504*    -------------------------------
  1505     05  FILLER            PIC  X(0003).
  1506     05  RPERSONO PIC  X(0010).
  1507*    -------------------------------
  1508     05  FILLER            PIC  X(0003).
  1509     05  BENTRYO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  29
* EL689.cbl
  1510*    -------------------------------
  1511     05  FILLER            PIC  X(0003).
  1512     05  SEQO PIC  X(0008).
  1513*    -------------------------------
  1514     05  FILLER            PIC  X(0003).
  1515     05  BCSEQO PIC  X(0004).
  1516*    -------------------------------
  1517     05  FILLER            PIC  X(0003).
  1518     05  L1O PIC  X(0003).
  1519*    -------------------------------
  1520     05  FILLER            PIC  X(0003).
  1521     05  TEXT1O PIC  X(0070).
  1522*    -------------------------------
  1523     05  FILLER            PIC  X(0003).
  1524     05  L2O PIC  X(0003).
  1525*    -------------------------------
  1526     05  FILLER            PIC  X(0003).
  1527     05  TEXT2O PIC  X(0070).
  1528*    -------------------------------
  1529     05  FILLER            PIC  X(0003).
  1530     05  L3O PIC  X(0003).
  1531*    -------------------------------
  1532     05  FILLER            PIC  X(0003).
  1533     05  TEXT3O PIC  X(0070).
  1534*    -------------------------------
  1535     05  FILLER            PIC  X(0003).
  1536     05  L4O PIC  X(0003).
  1537*    -------------------------------
  1538     05  FILLER            PIC  X(0003).
  1539     05  TEXT4O PIC  X(0070).
  1540*    -------------------------------
  1541     05  FILLER            PIC  X(0003).
  1542     05  L5O PIC  X(0003).
  1543*    -------------------------------
  1544     05  FILLER            PIC  X(0003).
  1545     05  TEXT5O PIC  X(0070).
  1546*    -------------------------------
  1547     05  FILLER            PIC  X(0003).
  1548     05  L6O PIC  X(0003).
  1549*    -------------------------------
  1550     05  FILLER            PIC  X(0003).
  1551     05  TEXT6O PIC  X(0070).
  1552*    -------------------------------
  1553     05  FILLER            PIC  X(0003).
  1554     05  L7O PIC  X(0003).
  1555*    -------------------------------
  1556     05  FILLER            PIC  X(0003).
  1557     05  TEXT7O PIC  X(0070).
  1558*    -------------------------------
  1559     05  FILLER            PIC  X(0003).
  1560     05  L8O PIC  X(0003).
  1561*    -------------------------------
  1562     05  FILLER            PIC  X(0003).
  1563     05  TEXT8O PIC  X(0070).
  1564*    -------------------------------
  1565     05  FILLER            PIC  X(0003).
  1566     05  L9O PIC  X(0003).
  1567*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  30
* EL689.cbl
  1568     05  FILLER            PIC  X(0003).
  1569     05  TEXT9O PIC  X(0070).
  1570*    -------------------------------
  1571     05  FILLER            PIC  X(0003).
  1572     05  L10O PIC  X(0003).
  1573*    -------------------------------
  1574     05  FILLER            PIC  X(0003).
  1575     05  TEXT10O PIC  X(0070).
  1576*    -------------------------------
  1577     05  FILLER            PIC  X(0003).
  1578     05  L11O PIC  X(0003).
  1579*    -------------------------------
  1580     05  FILLER            PIC  X(0003).
  1581     05  TEXT11O PIC  X(0070).
  1582*    -------------------------------
  1583     05  FILLER            PIC  X(0003).
  1584     05  L12O PIC  X(0003).
  1585*    -------------------------------
  1586     05  FILLER            PIC  X(0003).
  1587     05  TEXT12O PIC  X(0070).
  1588*    -------------------------------
  1589     05  FILLER            PIC  X(0003).
  1590     05  ERRMSGO PIC  X(0079).
  1591*    -------------------------------
  1592     05  FILLER            PIC  X(0003).
  1593     05  ENTERPFO PIC  X(0002).
  1594*    -------------------------------
  1595     05  FILLER            PIC  X(0003).
  1596     05  PF8HDO PIC  X(0022).
  1597*    -------------------------------
  1598 01  W-MAP-REDEF REDEFINES EL689AI.
  1599     12  FILLER                  PIC X(218).
  1600*    12  FILLER                  PIC X(240).
  1601     12  EL689RI.
  1602         16  W-TEXT-LINES OCCURS 12 TIMES INDEXED BY W-SC-NDX.
  1603             20  W-SC-LINEL      PIC S9(04) COMP.
  1604             20  W-SC-LINEA      PIC  X(01).
  1605             20  W-SC-LINE       PIC  X(03).
  1606             20  W-SC-TEXTL      PIC S9(04) COMP.
  1607             20  W-SC-TEXTA      PIC  X(01).
  1608             20  W-SC-TEXT       PIC  X(70).
  1609*    12  FILLER                  PIC  X(87).
  1610     12  FILLER                  PIC  X(112).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  31
* EL689.cbl
  1612 01  W-CONSTANT-AREA.
  1613     12  FILLER                  PIC  X(18)
  1614                                 VALUE 'PROGRAM CONSTANTS:'.
  1615     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
  1616     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
  1617     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
  1618     12  W-MAX-LINES             PIC S9(03) VALUE +300 COMP-3.
  1619     12  W-NUM-LINES-PER-SCREEN  PIC  9(02)        VALUE 12.
  1620     12  W-TS-NUM-REC-IN-GROUP   PIC  9(02)        VALUE 50.
  1621     12  W-TS-LENGTH             PIC S9(04)  COMP  VALUE +3650.
  1622     12  W-TS-MAP-LENGTH         PIC S9(04)  COMP  VALUE +1260.
  1623     12  W-ZEROS                 PIC S9(03) VALUE +000 COMP-3.
  1624
  1625     12  W-ACCT-FILE-ID          PIC  X(08) VALUE 'ERACCT'.
  1626     12  W-ACCT2-FILE-ID         PIC  X(08) VALUE 'ERACCT2'.
  1627     12  W-ARCH-FILE-ID          PIC  X(08) VALUE 'ERARCH'.
  1628     12  W-ARCH2-FILE-ID         PIC  X(08) VALUE 'ERARCH2'.
  1629     12  W-ARCH3-FILE-ID         PIC  X(08) VALUE 'ERARCH3'.
  1630     12  W-ARCH4-FILE-ID         PIC  X(08) VALUE 'ERARCH4'.
  1631     12  W-ARCH5-FILE-ID         PIC  X(08) VALUE 'ERARCH5'.
  1632     12  W-ARCT-FILE-ID          PIC  X(08) VALUE 'ERARCT'.
  1633     12  W-CERT-FILE-ID          PIC  X(08) VALUE 'ELCERT'.
  1634     12  W-CHEK-FILE-ID          PIC  X(08) VALUE 'ERCHEK'.
  1635     12  W-CNTL-FILE-ID          PIC  X(08) VALUE 'ELCNTL'.
  1636     12  W-COMP-FILE-ID          PIC  X(08) VALUE 'ERCOMP'.
  1637     12  W-GETMAIN-SPACE         PIC  X(01) VALUE SPACE.
  1638     12  W-LGXX-ID               PIC  X(04) VALUE 'LGXX'.
  1639     12  W-LINK-001              PIC  X(05) VALUE 'EL001'.
  1640     12  W-LINK-004              PIC  X(05) VALUE 'EL004'.
  1641     12  W-LINK-ELDATCV          PIC  X(07) VALUE 'ELDATCV'.
  1642     12  W-LOWER-CASE            PIC  X(26)
  1643         VALUE 'abcdefghijklmnopqrstuvwxyz'.
  1644     12  W-MAIL-FILE-ID          PIC  X(08) VALUE 'ERMAIL'.
  1645     12  W-MAP.
  1646         16  W-MAP-PREFIX        PIC  X(02) VALUE 'EL'.
  1647         16  W-MAP-NUM           PIC  X(04) VALUE '689A'.
  1648         16  W-MAP-FILLER        PIC  X(02) VALUE SPACES.
  1649     12  W-MAPSET                PIC  X(08) VALUE 'EL689S'.
  1650     12  W-PGM-EL1042            PIC  X(08) VALUE 'EL1042'.
  1651     12  W-PGM-EL690             PIC  X(08) VALUE 'EL690'.
  1652     12  W-PGM-EL626             PIC  X(08) VALUE 'EL626'.
  1653     12  W-PNDB-FILE-ID          PIC  X(08) VALUE 'ERPNDB'.
  1654     12  W-PRINT-TRANS           PIC  X(04) VALUE 'EXH5'.
  1655     12  W-PYAJ-FILE-ID          PIC  X(08) VALUE 'ERPYAJ'.
  1656
  1657     12  W-TEXT-FILE-ID          PIC  X(08) VALUE 'ELLETR'.
  1658     12  W-THIS-PGM              PIC  X(08) VALUE 'EL689'.
  1659     12  W-TOP-FORM              PIC  X(70)
  1660                              VALUE '*****TOP OF FORM *****'.
  1661     12  W-TRANSACTION           PIC  X(04) VALUE 'EXH3'.
  1662     12  W-UPPER-CASE            PIC  X(26)
  1663         VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
  1664     12  W-XCTL-005              PIC  X(05) VALUE 'EL005'.
  1665     12  W-XCTL-010              PIC  X(05) VALUE 'EL010'.
  1666     12  W-XCTL-626              PIC  X(05) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  32
* EL689.cbl
  1668 01  W-VARIABLE-PROCESS-CNTLS.
  1669     12  FILLER                  PIC  X(26)
  1670                        VALUE 'VARIABLE WORK AREA STARTS:'.
  1671     12  W-NUM-OF-VARIABLES      PIC S9(03) VALUE +189 COMP-3.
  1672     12  W-VAR-HOLD.
  1673         16  W-V1                PIC  X(01).
  1674         16  W-V2                PIC  X(01).
  1675         16  W-V3                PIC  X(01).
  1676     12  FILLER REDEFINES W-VAR-HOLD.
  1677         16  W-VAR-RELATIVE-NUM  PIC  9(03).
  1678     12  W-FIELD-SQUEEZE-IND     PIC  X(01).
  1679         88  W-SQUEEZE-FIELD          VALUE '#'.
  1680
  1681 01  W-SUPPORTED-VARIABLES.
  1682
  1683*****************COMPANY VARIABLES - ELCNTL ********************
  1684*****COMPANY NAME
  1685     12  FILLER                  PIC  X(03) VALUE '001'.
  1686     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1687     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1688     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1689     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1690
  1691*****FULL COMPANY ADDRESS
  1692     12  FILLER                  PIC  X(03) VALUE '002'.
  1693     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1694     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1695     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1696     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1697
  1698     12  FILLER                  PIC  X(03) VALUE '003'.
  1699     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1700     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1701     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1702     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1703
  1704     12  FILLER                  PIC  X(03) VALUE '004'.
  1705     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1706     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1707     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1708     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1709
  1710     12  FILLER                  PIC  X(03) VALUE '005'.
  1711     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1712     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1713     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1714     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1715
  1716     12  FILLER                  PIC  X(03) VALUE '006'.
  1717     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1718     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1719     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1720     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1721
  1722*****REMAINING 4 ARE NOT CURRENTLY USED
  1723     12  FILLER                  PIC  X(03) VALUE '007'.
  1724     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1725     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  33
* EL689.cbl
  1726     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1727     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1728
  1729     12  FILLER                  PIC  X(03) VALUE '008'.
  1730     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1731     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1732     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1733     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1734
  1735     12  FILLER                  PIC  X(03) VALUE '009'.
  1736     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1737     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1738     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1739     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1740
  1741     12  FILLER                  PIC  X(03) VALUE '010'.
  1742     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1743     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1744     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1745     12  FILLER                  PIC S9(04) COMP VALUE +01.
  1746
  1747************ LIFE BENEFIT VARIABLES - ELCNTL *******************
  1748*****LIFE BENEFIT DESCRIPTION
  1749     12  FILLER                  PIC  X(03) VALUE '011'.
  1750     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1751     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1752     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1753     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1754
  1755*****REMAINING 3 ARE NOT CURRENTLY USED
  1756     12  FILLER                  PIC  X(03) VALUE '012'.
  1757     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1758     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1759     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1760     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1761
  1762     12  FILLER                  PIC  X(03) VALUE '013'.
  1763     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1764     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1765     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1766     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1767
  1768     12  FILLER                  PIC  X(03) VALUE '014'.
  1769     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1770     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1771     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1772     12  FILLER                  PIC S9(04) COMP VALUE +02.
  1773
  1774************* A&H BENEFIT VARIABLES - ELCNTL *******************
  1775*****AH BENEFIT DESCRIPTION
  1776     12  FILLER                  PIC  X(03) VALUE '015'.
  1777     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1778     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1779     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1780     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1781
  1782*****ELIMINATION PERIOD
  1783     12  FILLER                  PIC  X(03) VALUE '016'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  34
* EL689.cbl
  1784     12  FILLER                  PIC S9(04) COMP VALUE +2.
  1785     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1786     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1787     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1788
  1789*****REMAINING 3 ARE NOT CURRENTLY USED
  1790     12  FILLER                  PIC  X(03) VALUE '017'.
  1791     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1792     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1793     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1794     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1795
  1796     12  FILLER                  PIC  X(03) VALUE '018'.
  1797     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1798     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1799     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1800     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1801
  1802     12  FILLER                  PIC  X(03) VALUE '019'.
  1803     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1804     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1805     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1806     12  FILLER                  PIC S9(04) COMP VALUE +03.
  1807
  1808*****************CARRIER VARIABLES - ELCNTL ********************
  1809*****CARRIER NAME
  1810     12  FILLER                  PIC  X(03) VALUE '020'.
  1811     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1812     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1813     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1814     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1815
  1816*****FULL CARRIER ADDRESS
  1817     12  FILLER                  PIC  X(03) VALUE '021'.
  1818     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1819     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1820     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1821     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1822
  1823     12  FILLER                  PIC  X(03) VALUE '022'.
  1824     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1825     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1826     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1827     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1828
  1829     12  FILLER                  PIC  X(03) VALUE '023'.
  1830     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1831     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1832     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1833     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1834
  1835     12  FILLER                  PIC  X(03) VALUE '024'.
  1836     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1837     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1838     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1839     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1840
  1841     12  FILLER                  PIC  X(03) VALUE '025'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  35
* EL689.cbl
  1842     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1843     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1844     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1845     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1846
  1847*****CARRIER PHONE NUMBER
  1848     12  FILLER                  PIC  X(03) VALUE '026'.
  1849     12  FILLER                  PIC S9(04) COMP VALUE +12.
  1850     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1851     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1852     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1853
  1854*****REMAINING 4 ARE NOT CURRENTLY USED
  1855     12  FILLER                  PIC  X(03) VALUE '027'.
  1856     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1857     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1858     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1859     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1860
  1861     12  FILLER                  PIC  X(03) VALUE '028'.
  1862     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1863     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1864     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1865     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1866
  1867     12  FILLER                  PIC  X(03) VALUE '029'.
  1868     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1869     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1870     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1871     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1872
  1873     12  FILLER                  PIC  X(03) VALUE '030'.
  1874     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1875     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1876     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1877     12  FILLER                  PIC S9(04) COMP VALUE +04.
  1878
  1879***************** MAIL VARIABLES - ELMAIL **********************
  1880*****FULL MAIL ADDRESS
  1881     12  FILLER                  PIC  X(03) VALUE '031'.
  1882     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1883     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1884     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1885     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1886
  1887     12  FILLER                  PIC  X(03) VALUE '032'.
  1888     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1889     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1890     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1891     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1892
  1893     12  FILLER                  PIC  X(03) VALUE '033'.
  1894     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1895     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1896     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1897     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1898
  1899     12  FILLER                  PIC  X(03) VALUE '034'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  36
* EL689.cbl
  1900     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1901     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1902     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1903     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1904
  1905     12  FILLER                  PIC  X(03) VALUE '035'.
  1906     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1907     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1908     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1909     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1910
  1911     12  FILLER                  PIC  X(03) VALUE '036'.
  1912     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1913     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1914     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1915     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1916**** CRED BENE NAME FROM ERMAIL
  1917     12  FILLER                  PIC  X(03) VALUE '037'.
  1918     12  FILLER                  PIC S9(04) COMP VALUE +25.
  1919     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1920     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1921     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1922*****REMAINING 2 ARE NOT CURRENTLY USED
  1923     12  FILLER                  PIC  X(03) VALUE '038'.
  1924     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1925     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1926     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1927     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1928
  1929     12  FILLER                  PIC  X(03) VALUE '039'.
  1930     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1931     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1932     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1933     12  FILLER                  PIC S9(04) COMP VALUE +05.
  1934
  1935*************** ACCOUNT VARIABLES - ERACCT *********************
  1936*****ACCOUNT NAME
  1937     12  FILLER                  PIC  X(03) VALUE '040'.
  1938     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1939     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1940     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1941     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1942
  1943*****FULL ACCOUNT ADDRESS
  1944     12  FILLER                  PIC  X(03) VALUE '041'.
  1945     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1946     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1947     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1948     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1949
  1950     12  FILLER                  PIC  X(03) VALUE '042'.
  1951     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1952     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1953     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1954     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1955
  1956     12  FILLER                  PIC  X(03) VALUE '043'.
  1957     12  FILLER                  PIC S9(04) COMP VALUE +30.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  37
* EL689.cbl
  1958     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1959     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1960     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1961
  1962     12  FILLER                  PIC  X(03) VALUE '044'.
  1963     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1964     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1965     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1966     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1967
  1968     12  FILLER                  PIC  X(03) VALUE '045'.
  1969     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1970     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1971     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  1972     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1973
  1974*****ACCOUNT PHONE NUMBER
  1975     12  FILLER                  PIC  X(03) VALUE '046'.
  1976     12  FILLER                  PIC S9(04) COMP VALUE +12.
  1977     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1978     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1979     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1980
  1981*****ACCOUNT CONTROL NAME AM-CONTROL-NAME
  1982     12  FILLER                  PIC  X(03) VALUE '047'.
  1983     12  FILLER                  PIC S9(04) COMP VALUE +30.
  1984     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1985     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1986     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1987
  1988****ACCOUNT CSR CODE
  1989     12  FILLER                  PIC  X(03) VALUE '048'.
  1990     12  FILLER                  PIC S9(04) COMP VALUE +4..
  1991     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1992     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1993     12  FILLER                  PIC S9(04) COMP VALUE +06.
  1994****ACCOUNT ACCOUNT NUMBER
  1995     12  FILLER                  PIC  X(03) VALUE '049'.
  1996     12  FILLER                  PIC S9(04) COMP VALUE +10.
  1997     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  1998     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  1999     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2000
  2001**** CRED BENE ADDRESS LINE 1 ERMAIL
  2002     12  FILLER                  PIC  X(03) VALUE '050'.
  2003     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2004     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2005     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2006     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2007
  2008**** CRED BENE ADDRESS LINE 2 ERMAIL
  2009     12  FILLER                  PIC  X(03) VALUE '051'.
  2010     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2011     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2012     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2013     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2014
  2015**** CRED BENE CITY STATE   ERMAIL
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  38
* EL689.cbl
  2016     12  FILLER                  PIC  X(03) VALUE '052'.
  2017     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2018     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2019     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2020     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2021
  2022**** CRED BENE ZIP  1 ERMAIL
  2023     12  FILLER                  PIC  X(03) VALUE '053'.
  2024     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2025     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2026     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2027     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2028
  2029*****REMAINING 6 ARE NOT CURRENTLY USED
  2030     12  FILLER                  PIC  X(03) VALUE '054'.
  2031     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2032     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2033     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2034     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2035
  2036     12  FILLER                  PIC  X(03) VALUE '055'.
  2037     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2038     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2039     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2040     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2041
  2042     12  FILLER                  PIC  X(03) VALUE '056'.
  2043     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2044     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2045     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2046     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2047
  2048     12  FILLER                  PIC  X(03) VALUE '057'.
  2049     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2050     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2051     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2052     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2053
  2054     12  FILLER                  PIC  X(03) VALUE '058'.
  2055     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2056     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2057     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2058     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2059
  2060     12  FILLER                  PIC  X(03) VALUE '059'.
  2061     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2062     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2063     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2064     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2065
  2066*************** NON FILE VARIABLES *****************************
  2067*****CURRENT DATE
  2068     12  FILLER                  PIC  X(03) VALUE '060'.
  2069     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2070     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2071     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2072     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2073
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  39
* EL689.cbl
  2074*****FULL CURRENT DATE
  2075     12  FILLER                  PIC  X(03) VALUE '061'.
  2076     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2077     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2078     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2079     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2080
  2081*****FORM
  2082     12  FILLER                  PIC  X(03) VALUE '062'.
  2083     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2084     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2085     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2086     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2087
  2088*****VARIABLE 1
  2089     12  FILLER                  PIC  X(03) VALUE '063'.
  2090     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2091     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2092     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2093     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2094
  2095*****VARIABLE 2
  2096     12  FILLER                  PIC  X(03) VALUE '064'.
  2097     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2098     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2099     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2100     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2101
  2102*****VARIABLE 3
  2103     12  FILLER                  PIC  X(03) VALUE '065'.
  2104     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2105     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2106     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2107     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2108
  2109*****VARIABLE 4
  2110     12  FILLER                  PIC  X(03) VALUE '066'.
  2111     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2112     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2113     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2114     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2115
  2116*****REMAINING 3 ARE NOT CURRENTLY USED
  2117     12  FILLER                  PIC  X(03) VALUE '067'.
  2118     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2119     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2120     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2121     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2122
  2123     12  FILLER                  PIC  X(03) VALUE '068'.
  2124     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2125     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2126     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2127     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2128
  2129     12  FILLER                  PIC  X(03) VALUE '069'.
  2130     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2131     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  40
* EL689.cbl
  2132     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2133     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2134
  2135************** CERTIFICATE VARIABLES - ELCERT *****************
  2136*****CARRIER CODE IN CERT
  2137     12  FILLER                  PIC  X(03) VALUE '070'.
  2138     12  FILLER                  PIC S9(04) COMP VALUE +1.
  2139     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2140     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2141     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2142
  2143*****GROUPING CODE IN CERT
  2144     12  FILLER                  PIC  X(03) VALUE '071'.
  2145     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2146     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2147     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2148     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2149
  2150*****ACCOUNT NUMBER IN CERT
  2151     12  FILLER                  PIC  X(03) VALUE '072'.
  2152     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2153     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2154     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2155     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2156
  2157*****CERTIFICATE NUMBER
  2158     12  FILLER                  PIC  X(03) VALUE '073'.
  2159     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2160     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2161     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2162     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2163
  2164*****CERT EFFECTIVE DATE
  2165     12  FILLER                  PIC  X(03) VALUE '074'.
  2166     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2167     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2168     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2169     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2170
  2171*****CERT EXPIRATION DATE (LIFE)
  2172     12  FILLER                  PIC  X(03) VALUE '075'.
  2173     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2174     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2175     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2176     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2177
  2178*****CERT EXPIRATION DATE (AH)
  2179     12  FILLER                  PIC  X(03) VALUE '076'.
  2180     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2181     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2182     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2183     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2184
  2185*****LIFE TERM
  2186     12  FILLER                  PIC  X(03) VALUE '077'.
  2187     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2188     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2189     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  41
* EL689.cbl
  2190     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2191
  2192*****AH  TERM
  2193     12  FILLER                  PIC  X(03) VALUE '078'.
  2194     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2195     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2196     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2197     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2198
  2199*****LIFE COVERAGE AMOUNT
  2200     12  FILLER                  PIC  X(03) VALUE '079'.
  2201     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2202     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2203     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2204     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2205
  2206*****AH MONTHLY BENEFIT
  2207     12  FILLER                  PIC  X(03) VALUE '080'.
  2208     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2209     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2210     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2211     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2212
  2213*****LIFE CANCEL DATE
  2214     12  FILLER                  PIC  X(03) VALUE '081'.
  2215     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2216     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2217     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2218     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2219
  2220*****AH CANCEL DATE
  2221     12  FILLER                  PIC  X(03) VALUE '082'.
  2222     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2223     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2224     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2225     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2226
  2227*****LIFE COVERAGE FORM NUMBER
  2228     12  FILLER                  PIC  X(03) VALUE '083'.
  2229     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2230     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2231     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2232     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2233
  2234*****UNUSED
  2235     12  FILLER                  PIC  X(03) VALUE '084'.
  2236     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2237     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2238     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2239     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2240
  2241*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
  2242     12  FILLER                  PIC  X(03) VALUE '085'.
  2243     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2244     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2245     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2246     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2247
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  42
* EL689.cbl
  2248*****LOAN NUMBER
  2249     12  FILLER                  PIC  X(03) VALUE '086'.
  2250     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2251     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2252     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2253     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2254
  2255*****LOAN BALANCE
  2256     12  FILLER                  PIC  X(03) VALUE '087'.
  2257     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2258     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2259     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2260     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2261
  2262*****MEMBER NUMBER
  2263     12  FILLER                  PIC  X(03) VALUE '088'.
  2264     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2265     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2266     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2267     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2268
  2269*****INSURED SOC SEC NUMBER
  2270     12  FILLER                  PIC  X(03) VALUE '089'.
  2271     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2272     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2273     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2274     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2275
  2276*****INSURED INITIALS & LAST NAME (CERTIFICATE)
  2277     12  FILLER                  PIC  X(03) VALUE '090'.
  2278     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2279     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2280     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2281     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2282
  2283*****INSURED FIRST NAME (CERTIFICATE)
  2284     12  FILLER                  PIC  X(03) VALUE '091'.
  2285     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2286     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2287     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2288     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2289
  2290*****INSURED MIDDLE INITIAL (CERTIFICATE)
  2291     12  FILLER                  PIC  X(03) VALUE '092'.
  2292     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2293     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2294     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2295     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2296
  2297*****ORIG TERM * MON BEN
  2298     12  FILLER                  PIC  X(03) VALUE '093'.
  2299     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2300     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2301     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2302     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2303
  2304*****INSURED'S NAME (LAST, FIRST, INIT)
  2305     12  FILLER                  PIC  X(03) VALUE '094'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  43
* EL689.cbl
  2306     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2307     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2308     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2309     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2310
  2311*****INSURED'S NAME (FIRST, INIT, LAST)
  2312     12  FILLER                  PIC  X(03) VALUE  '095'.
  2313     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2314     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2315     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2316     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2317
  2318*****TITLE (MR/MS)
  2319     12  FILLER                  PIC  X(03) VALUE '096'.
  2320     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2321     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2322     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2323     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2324
  2325*****LIFE PREMIUM (CERTIFICATE)
  2326     12  FILLER                  PIC  X(03) VALUE '097'.
  2327     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2328     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2329     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2330     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2331
  2332*****A/H PREMIUM (CERTIFICATE)
  2333     12  FILLER                  PIC  X(03) VALUE '098'.
  2334     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2335     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2336     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2337     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2338
  2339*****JOINT'S INITIALS & LAST NAME (CERTIFICATE)
  2340     12  FILLER                  PIC  X(03) VALUE '099'.
  2341     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2342     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2343     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2344     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2345
  2346*****JOINT'S FIRST NAME (CERTIFICATE)
  2347     12  FILLER                  PIC  X(03) VALUE '100'.
  2348     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2349     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2350     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2351     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2352
  2353*****JOINT'S MIDDLE INITIAL (CERTIFICATE)
  2354     12  FILLER                  PIC  X(03) VALUE '101'.
  2355     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2356     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2357     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2358     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2359
  2360*****JOINT'S NAME (LAST, FIRST, INIT)
  2361     12  FILLER                  PIC  X(03) VALUE '102'.
  2362     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2363     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  44
* EL689.cbl
  2364     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2365     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2366
  2367*****JOINT'S NAME (FIRST, INIT, LAST)
  2368     12  FILLER                  PIC  X(03) VALUE '103'.
  2369     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2370     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2371     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2372     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2373
  2374*****INSURED'S FIRST AND LAST NAME
  2375     12  FILLER                  PIC  X(03) VALUE '104'.
  2376     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2377     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2378     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2379     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2380
  2381*****JOINT'S FIRST AND LAST NAME
  2382     12  FILLER                  PIC  X(03) VALUE '105'.
  2383     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2384     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2385     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2386     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2387
  2388*****ENTERED LIFE REFUND (CERT)
  2389     12  FILLER                  PIC  X(03) VALUE '106'.
  2390     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2391     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2392     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2393     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2394
  2395*****ENTERED A/H REFUND (CERT)
  2396     12  FILLER                  PIC  X(03) VALUE '107'.
  2397     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2398     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2399     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2400     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2401
  2402*****INSURED'S LAST NAME
  2403     12  FILLER                  PIC  X(03) VALUE '108'.
  2404     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2405     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2406     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2407     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2408
  2409*****BENEFICIARY
  2410     12  FILLER                  PIC  X(03) VALUE  '109'.
  2411     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2412     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2413     12  FILLER                  PIC  X(01) VALUE 'Y'.
  2414     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2415
  2416************** PENDING VARIABLES - ERPNDB *********************
  2417*****INSURED DATE OF BIRTH
  2418     12  FILLER                  PIC  X(03) VALUE '110'.
  2419     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2420     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2421     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  45
* EL689.cbl
  2422     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2423
  2424*****ENTERED LIFE PREMIUM (PENDING)
  2425     12  FILLER                  PIC  X(03) VALUE '111'.
  2426     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2427     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2428     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2429     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2430
  2431*****ENTERED A/H PREMIUM (PENDING)
  2432     12  FILLER                  PIC  X(03) VALUE '112'.
  2433     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2434     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2435     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2436     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2437
  2438*****CALCULATED LIFE PREMIUM (PENDING)
  2439     12  FILLER                  PIC  X(03) VALUE '113'.
  2440     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2441     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2442     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2443     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2444
  2445*****CALCULATED A/H PREMIUM (PENDING)
  2446     12  FILLER                  PIC  X(03) VALUE '114'.
  2447     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2448     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2449     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2450     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2451
  2452*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
  2453     12  FILLER                  PIC  X(03) VALUE '115'.
  2454     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2455     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2456     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2457     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2458
  2459*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
  2460     12  FILLER                  PIC  X(03) VALUE '116'.
  2461     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2462     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2463     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2464     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2465
  2466*****PRIOR CANCEL DATE
  2467     12  FILLER                  PIC  X(03) VALUE '117'.
  2468     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2469     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2470     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2471     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2472
  2473*****ENTERED LIFE REFUND (PENDING)
  2474     12  FILLER                  PIC  X(03) VALUE '118'.
  2475     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2476     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2477     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2478     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2479
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  46
* EL689.cbl
  2480*****ENTERED A/H REFUND (PENDING)
  2481     12  FILLER                  PIC  X(03) VALUE '119'.
  2482     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2483     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2484     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2485     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2486
  2487*****CALCULATED LIFE REFUND (PENDING)
  2488     12  FILLER                  PIC  X(03) VALUE '120'.
  2489     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2490     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2491     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2492     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2493
  2494*****CALCULATED A/H REFUND (PENDING)
  2495     12  FILLER                  PIC  X(03) VALUE '121'.
  2496     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2497     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2498     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2499     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2500
  2501*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
  2502     12  FILLER                  PIC  X(03) VALUE '122'.
  2503     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2504     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2505     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2506     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2507
  2508*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
  2509     12  FILLER                  PIC  X(03) VALUE '123'.
  2510     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2511     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2512     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2513     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2514
  2515*****INSUREDS AGE
  2516     12  FILLER                  PIC  X(03) VALUE '124'.
  2517     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2518     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2519     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2520     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2521
  2522*****LIFE BENEFIT (PENDING)
  2523     12  FILLER                  PIC  X(03) VALUE '125'.
  2524     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2525     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2526     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2527     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2528
  2529*****A/H BENEFIT (PENDING)
  2530     12  FILLER                  PIC  X(03) VALUE '126'.
  2531     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2532     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2533     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2534     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2535
  2536*****LIFE RATE
  2537     12  FILLER                  PIC  X(03) VALUE '127'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  47
* EL689.cbl
  2538     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2539     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2540     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2541     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2542
  2543*****A/H RATE
  2544     12  FILLER                  PIC  X(03) VALUE '128'.
  2545     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2546     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2547     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2548     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2549
  2550*****TERM (PENDING)
  2551     12  FILLER                  PIC  X(03) VALUE '129'.
  2552     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2553     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2554     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2555     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2556
  2557*****BATCH NUMBER
  2558     12  FILLER                  PIC  X(03) VALUE '130'.
  2559     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2560     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2561     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2562     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2563
  2564*****TOTAL OF LIFE AND A&H REFUND
  2565     12  FILLER                  PIC  X(03) VALUE '131'.
  2566     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2567     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2568     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2569     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2570
  2571*****NH INTEREST ON REFUNDS
  2572     12  FILLER                  PIC  X(03) VALUE '132'.
  2573     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2574     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2575     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2576     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2577*****GREATER OF THE LIFE AND AH CANCEL DATE
  2578     12  FILLER                  PIC  X(03) VALUE '133'.
  2579     12  FILLER                  PIC S9(04) COMP VALUE +8.
  2580     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2581     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2582     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2583
  2584*****THE NEXT 6 NOT CURRENTLY USED
  2585     12  FILLER                  PIC  X(03) VALUE '134'.
  2586     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2587     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2588     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2589     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2590
  2591     12  FILLER                  PIC  X(03) VALUE '135'.
  2592     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2593     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2594     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2595     12  FILLER                  PIC S9(04) COMP VALUE +09.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  48
* EL689.cbl
  2596
  2597     12  FILLER                  PIC  X(03) VALUE '136'.
  2598     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2599     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2600     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2601     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2602
  2603     12  FILLER                  PIC  X(03) VALUE '137'.
  2604     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2605     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2606     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2607     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2608
  2609     12  FILLER                  PIC  X(03) VALUE '138'.
  2610     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2611     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2612     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2613     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2614
  2615     12  FILLER                  PIC  X(03) VALUE '139'.
  2616     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2617     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2618     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2619     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2620
  2621************** COMPENSATION VARIABLES - ERCOMP ****************
  2622*****COMPENSATION ACCT NAME
  2623     12  FILLER                  PIC  X(03) VALUE '140'.
  2624     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2625     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2626     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2627     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2628
  2629*****FULL COMPENSATION ADDRESS TYPE 'A'
  2630     12  FILLER                  PIC  X(03) VALUE '141'.
  2631     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2632     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2633     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2634     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2635
  2636     12  FILLER                  PIC  X(03) VALUE '142'.
  2637     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2638     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2639     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2640     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2641
  2642     12  FILLER                  PIC  X(03) VALUE '143'.
  2643     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2644     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2645     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2646     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2647
  2648     12  FILLER                  PIC  X(03) VALUE '144'.
  2649     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2650     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2651     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2652     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2653
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  49
* EL689.cbl
  2654     12  FILLER                  PIC  X(03) VALUE '145'.
  2655     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2656     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2657     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2658     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2659
  2660     12  FILLER                  PIC  X(03) VALUE '146'.
  2661     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2662     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2663     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2664     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2665
  2666*****COMPENSATION PHONE NUMBER
  2667     12  FILLER                  PIC  X(03) VALUE '147'.
  2668     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2669     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2670     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2671     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2672
  2673*****COMPENSATION CSR NAME
  2674     12  FILLER                  PIC  X(03) VALUE '148'.
  2675     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2676     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2677     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2678     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2679
  2680*****COMPENSATION LAST STATEMENT DATE
  2681     12  FILLER                  PIC  X(03) VALUE '149'.
  2682     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2683     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2684     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2685     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2686
  2687*****COMPENSATION ENDING BALANCE
  2688     12  FILLER                  PIC  X(03) VALUE '150'.
  2689     12  FILLER                  PIC S9(04) COMP VALUE +14.
  2690     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2691     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2692     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2693
  2694******************  PROCESSOR DATA - ELCNTL (2) ****************
  2695*****EXECUTING PROCESSOR NAME
  2696     12  FILLER                  PIC  X(03) VALUE '151'.
  2697     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2698     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2699     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2700     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2701
  2702*****PROCESSOR TITLE
  2703     12  FILLER                  PIC  X(03) VALUE '152'.
  2704     12  FILLER                  PIC S9(04) COMP VALUE +26.
  2705     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2706     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2707     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2708
  2709*****PROCESSOR
  2710     12  FILLER                  PIC  X(03) VALUE '153'.
  2711     12  FILLER                  PIC S9(04) COMP VALUE +04.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  50
* EL689.cbl
  2712     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2713     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2714     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2715
  2716*****CSR TITLE
  2717     12  FILLER                  PIC  X(03) VALUE '154'.
  2718     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2719     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2720     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2721     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2722*****REMAINING 2 ARE NOT CURRENTLY USED
  2723     12  FILLER                  PIC  X(03) VALUE '155'.
  2724     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2725     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2726     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2727     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2728
  2729     12  FILLER                  PIC  X(03) VALUE '156'.
  2730     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2731     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2732     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2733     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2734
  2735******************  CHECK DATA - ERCHEK    *********************
  2736*****CHECK AMOUNT
  2737     12  FILLER                  PIC  X(03) VALUE '157'.
  2738     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2739     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2740     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2741     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2742
  2743*****CHECK NUMBER
  2744     12  FILLER                  PIC  X(03) VALUE '158'.
  2745     12  FILLER                  PIC S9(04) COMP VALUE +7.
  2746     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2747     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2748     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2749
  2750*****PAYEE 1 NAME
  2751     12  FILLER                  PIC  X(03) VALUE '159'.
  2752     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2753     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2754     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2755     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2756
  2757*****PAYEE 2 NAME
  2758     12  FILLER                  PIC  X(03) VALUE '160'.
  2759     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2760     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2761     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2762     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2763
  2764*****ADDRSS 1
  2765     12  FILLER                  PIC  X(03) VALUE '161'.
  2766     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2767     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2768     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2769     12  FILLER                  PIC S9(04) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  51
* EL689.cbl
  2770
  2771*****ADDRESS 2
  2772     12  FILLER                  PIC  X(03) VALUE '162'.
  2773     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2774     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2775     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2776     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2777
  2778*****PAYEE CITY STATE
  2779     12  FILLER                  PIC  X(03) VALUE '163'.
  2780     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2781     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2782     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2783     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2784
  2785*****ZIP CODE
  2786     12  FILLER                  PIC  X(03) VALUE '164'.
  2787     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2788     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2789     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2790     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2791
  2792*****CHECK CONTROL
  2793     12  FILLER                  PIC  X(03) VALUE '165'.
  2794     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2795     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2796     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2797     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2798
  2799*****REASON FOR CHECK
  2800     12  FILLER                  PIC  X(03) VALUE '166'.
  2801     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2802     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2803     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2804     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2805
  2806*****REMAINING 3 ARE NOT CURRENTLY USED
  2807     12  FILLER                  PIC  X(03) VALUE '167'.
  2808     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2809     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2810     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2811     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2812
  2813     12  FILLER                  PIC  X(03) VALUE '168'.
  2814     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2815     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2816     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2817     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2818
  2819     12  FILLER                  PIC  X(03) VALUE '169'.
  2820     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2821     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2822     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2823     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2824
  2825
  2826*********** PAYMENT AND ADJUSTMENT DATA - ERPYAJ  **************
  2827*****CHECK AMOUNT - PYAJ
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  52
* EL689.cbl
  2828     12  FILLER                  PIC  X(03) VALUE '170'.
  2829     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2830     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2831     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2832     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2833
  2834*****CHECK NUMBER - PYAJ
  2835     12  FILLER                  PIC  X(03) VALUE '171'.
  2836     12  FILLER                  PIC S9(04) COMP VALUE +7.
  2837     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2838     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2839     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2840
  2841*****CHECK CONTROL - PYAJ
  2842     12  FILLER                  PIC  X(03) VALUE '172'.
  2843     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2844     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2845     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2846     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2847
  2848***** COMMENT - PYAJ
  2849     12  FILLER                  PIC  X(03) VALUE '173'.
  2850     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2851     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2852     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2853     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2854
  2855*****NEW FIELDS.
  2856*****COMPENSATION FULL ADDRESS TYPE 'G'
  2857     12  FILLER                  PIC  X(03) VALUE '174'.
  2858     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2859     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2860     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2861     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2862
  2863     12  FILLER                  PIC  X(03) VALUE '175'.
  2864     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2865     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2866     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2867     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2868
  2869     12  FILLER                  PIC  X(03) VALUE '176'.
  2870     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2871     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2872     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2873     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2874
  2875     12  FILLER                  PIC  X(03) VALUE '177'.
  2876     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2877     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2878     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2879     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2880
  2881     12  FILLER                  PIC  X(03) VALUE '178'.
  2882     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2883     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2884     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2885     12  FILLER                  PIC S9(04) COMP VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  53
* EL689.cbl
  2886
  2887     12  FILLER                  PIC  X(03) VALUE '179'.
  2888     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2889     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2890     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2891     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2892
  2893*****COMPENSATION FINANCIAL RESPONSIBLE NO.
  2894     12  FILLER                  PIC  X(03) VALUE '180'.
  2895     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2896     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2897     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2898     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2899**** COMPENSATION BILLING SWITCH
  2900     12  FILLER                  PIC XXX    VALUE '181'.
  2901     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  2902     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  2903     12  FILLER                  PIC X      VALUE ALL 'N'.
  2904     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  2905*****COMPENSATION FAX NUMBER
  2906     12  FILLER                  PIC  X(03) VALUE '182'.
  2907     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2908     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2909     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2910     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2911**** COMPENSATION STATUS
  2912     12  FILLER                  PIC XXX    VALUE '183'.
  2913     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  2914     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  2915     12  FILLER                  PIC X      VALUE ALL 'N'.
  2916     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  2917***** THE VARS 184 - 189 WILL TYPICALLY BE USED FOR DCC BANKS
  2918*****COMPENSATION FULL ADDRESS TYPE 'B'
  2919     12  FILLER                  PIC  X(03) VALUE '184'.
  2920     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2921     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2922     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2923     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2924
  2925     12  FILLER                  PIC  X(03) VALUE '185'.
  2926     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2927     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2928     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2929     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2930
  2931     12  FILLER                  PIC  X(03) VALUE '186'.
  2932     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2933     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2934     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2935     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2936
  2937     12  FILLER                  PIC  X(03) VALUE '187'.
  2938     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2939     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2940     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2941     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2942
  2943     12  FILLER                  PIC  X(03) VALUE '188'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  54
* EL689.cbl
  2944     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2945     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2946     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2947     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2948
  2949     12  FILLER                  PIC  X(03) VALUE '189'.
  2950     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2951     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2952     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2953     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2954
  2955
  2956 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
  2957*    12  W-VARIABLE-GRP OCCURS 180 TIMES
  2958     12  W-VARIABLE-GRP OCCURS 189 TIMES
  2959                        INDEXED BY W-VG-NDX.
  2960         16  W-VARIABLE-ID         PIC  X(03).
  2961         16  W-VARIABLE-SIZE       PIC S9(04) COMP.
  2962         16  W-VG-TEXT.
  2963             20  W-VAR-CHAR
  2964                        OCCURS 30 TIMES
  2965                        INDEXED BY W-VC-NDX
  2966                                   PIC  X(01).
  2967         16  W-VARIABLE-UPLOW-IND  PIC  X(01).
  2968             88  W-USE-UPPER-AND-LOWER-CASE VALUE 'Y'.
  2969
  2970         16  W-VARIABLE-SOURCE   PIC S9(04) COMP.
  2971
  2972 01  W-VAR-END                   PIC  X(23)
  2973                        VALUE ':VARIABLE WORK AREA END'.
  2974
  2975 01  W-PROGRAM-TABLE-AREA.
  2976     12  FILLER                  PIC  X(15)
  2977                                 VALUE 'PROGRAM TABLES:'.
  2978
  2979     12  W-RECORD-TABLE              VALUE SPACES.
  2980         16  W-RC-GRP OCCURS 500 TIMES
  2981                       INDEXED BY W-RG-NDX
  2982                                  W-RG-NDX1.
  2983             20  W-RC-TEXT.
  2984                 24  W-RC-CHAR OCCURS 70 TIMES
  2985                                INDEXED BY W-RC-NDX
  2986                                           W-RC-NDX1
  2987                                 PIC  X(01).
  2988             20  W-RC-PC         PIC  9(02).
  2989             20  W-RC-SC         PIC  X(01).
  2990
  2991     12  FILLER REDEFINES W-RECORD-TABLE.
  2992         16  W-REC-CHAR OCCURS 36500 TIMES
  2993                        INDEXED BY W-RVS-NDX
  2994                                   W-RVS-NDX2
  2995                                 PIC  X(01).
  2996     12  FILLER REDEFINES W-RECORD-TABLE.
  2997         16  W-TS-GROUP OCCURS 10 TIMES
  2998                        INDEXED BY W-TS-NDX
  2999                                 PIC X(3650).
  3000
  3001     12  FILLER                  PIC  X(11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  55
* EL689.cbl
  3002                                 VALUE 'TEXT TABLE:'.
  3003     12  W-TX-TABLE                  VALUE SPACES.
  3004         16  W-TX-GRP OCCURS 500 TIMES
  3005                       INDEXED BY W-TG-NDX
  3006                                  W-TG-NDX2.
  3007             20  W-TX-TEXT.
  3008                 24  W-TX-CHAR OCCURS 70 TIMES
  3009                                    INDEXED BY W-TX-NDX
  3010                                               W-TX-NDX1
  3011                                               W-TX-NDX2
  3012                                 PIC  X(01).
  3013             20  W-TX-PC         PIC  9(02).
  3014             20  W-TX-SC         PIC  X(01).
  3015
  3016     12  FILLER                  PIC  X(11)
  3017                                 VALUE 'FILE TABLE:'.
  3018     12  W-FILE-TABLE                VALUE SPACES.
  3019         16  W-FILE-USE-IND OCCURS 20 TIMES
  3020                       INDEXED BY W-FILE-NDX
  3021                                 PIC  X(01).
  3022             88  W-FILE-NOT-USED     VALUE SPACE.
  3023             88  W-FILE-USED         VALUE 'Y'.
  3024
  3025     12  FILLER                  PIC  X(14)
  3026                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  56
* EL689.cbl
  3028 01  ERROR-MESSAGES.
  3029     12  ER-0000                 PIC  X(04) VALUE '0000'.
  3030     12  ER-0004                 PIC  X(04) VALUE '0004'.
  3031     12  ER-0006                 PIC  X(04) VALUE '0006'.
  3032     12  ER-0008                 PIC  X(04) VALUE '0008'.
  3033     12  ER-0013                 PIC  X(04) VALUE '0013'.
  3034     12  ER-0023                 PIC  X(04) VALUE '0023'.
  3035     12  ER-0029                 PIC  X(04) VALUE '0029'.
  3036     12  ER-0033                 PIC  X(04) VALUE '0033'.
  3037     12  ER-0042                 PIC  X(04) VALUE '0042'.
  3038     12  ER-0047                 PIC  X(04) VALUE '0047'.
  3039     12  ER-0051                 PIC  X(04) VALUE '0051'.
  3040     12  ER-0066                 PIC  X(04) VALUE '0066'.
  3041     12  ER-0067                 PIC  X(04) VALUE '0067'.
  3042     12  ER-0070                 PIC  X(04) VALUE '0070'.
  3043     12  ER-0168                 PIC  X(04) VALUE '0168'.
  3044     12  ER-0169                 PIC  X(04) VALUE '0169'.
  3045     12  ER-0174                 PIC  X(04) VALUE '0174'.
  3046     12  ER-0175                 PIC  X(04) VALUE '0175'.
  3047     12  ER-0176                 PIC  X(04) VALUE '0176'.
  3048     12  ER-0177                 PIC  X(04) VALUE '0177'.
  3049     12  ER-0179                 PIC  X(04) VALUE '0179'.
  3050     12  ER-0180                 PIC  X(04) VALUE '0180'.
  3051     12  ER-0181                 PIC  X(04) VALUE '0181'.
  3052     12  ER-0182                 PIC  X(04) VALUE '0182'.
  3053     12  ER-0184                 PIC  X(04) VALUE '0184'.
  3054     12  ER-0185                 PIC  X(04) VALUE '0185'.
  3055     12  ER-0187                 PIC  X(04) VALUE '0187'.
  3056     12  ER-0188                 PIC  X(04) VALUE '0188'.
  3057     12  ER-0189                 PIC  X(04) VALUE '0189'.
  3058     12  ER-0190                 PIC  X(04) VALUE '0190'.
  3059     12  ER-0191                 PIC  X(04) VALUE '0191'.
  3060     12  ER-0215                 PIC  X(04) VALUE '0215'.
  3061     12  ER-0279                 PIC  X(04) VALUE '0279'.
  3062     12  ER-0280                 PIC  X(04) VALUE '0280'.
  3063     12  ER-0412                 PIC  X(04) VALUE '0412'.
  3064     12  ER-0413                 PIC  X(04) VALUE '0413'.
  3065     12  ER-0454                 PIC  X(04) VALUE '0454'.
  3066     12  ER-0533                 PIC  X(04) VALUE '0533'.
  3067     12  ER-0537                 PIC  X(04) VALUE '0537'.
  3068     12  ER-2055                 PIC  X(04) VALUE '2055'.
  3069     12  ER-2114                 PIC  X(04) VALUE '2114'.
  3070     12  ER-2208                 PIC  X(04) VALUE '2208'.
  3071     12  ER-2209                 PIC  X(04) VALUE '2209'.
  3072     12  ER-2216                 PIC  X(04) VALUE '2216'.
  3073     12  ER-2232                 PIC  X(04) VALUE '2232'.
  3074     12  ER-2369                 PIC  X(04) VALUE '2369'.
  3075     12  ER-2398                 PIC  X(04) VALUE '2398'.
  3076     12  ER-2433                 PIC  X(04) VALUE '2433'.
  3077     12  ER-2908                 PIC  X(04) VALUE '2908'.
  3078     12  ER-2999                 PIC  X(04) VALUE '2999'.
  3079     12  ER-3000                 PIC  X(04) VALUE '3000'.
  3080     12  ER-3770                 PIC  X(04) VALUE '3770'.
  3081     12  ER-3771                 PIC  X(04) VALUE '3771'.
  3082     12  ER-3775                 PIC  X(04) VALUE '3775'.
  3083     12  ER-3783                 PIC  X(04) VALUE '3783'.
  3084     12  ER-7243                 PIC  X(04) VALUE '7243'.
  3085     12  ER-7245                 PIC  X(04) VALUE '7245'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  57
* EL689.cbl
  3086     12  ER-7246                 PIC  X(04) VALUE '7246'.
  3087     12  ER-7247                 PIC  X(04) VALUE '7247'.
  3088     12  ER-7250                 PIC  X(04) VALUE '7250'.
  3089     12  ER-7365                 PIC  X(04) VALUE '7365'.
  3090     12  ER-7367                 PIC  X(04) VALUE '7367'.
  3091     12  ER-7368                 PIC  X(04) VALUE '7368'.
  3092     12  ER-7369                 PIC  X(04) VALUE '7369'.
  3093     12  ER-7370                 PIC  X(04) VALUE '7370'.
  3094     12  ER-7371                 PIC  X(04) VALUE '7371'.
  3095     12  ER-7372                 PIC  X(04) VALUE '7372'.
  3096     12  ER-7373                 PIC  X(04) VALUE '7373'.
  3097     12  ER-7374                 PIC  X(04) VALUE '7374'.
  3098     12  ER-7376                 PIC  X(04) VALUE '7376'.
  3099     12  ER-7377                 PIC  X(04) VALUE '7377'.
  3100     12  ER-7378                 PIC  X(04) VALUE '7378'.
  3101     12  ER-7379                 PIC  X(04) VALUE '7379'.
  3102     12  ER-7381                 PIC  X(04) VALUE '7381'.
  3103     12  ER-7388                 PIC  X(04) VALUE '7388'.
  3104     12  ER-7390                 PIC  X(04) VALUE '7390'.
  3105     12  ER-7393                 PIC  X(04) VALUE '7393'.
  3106     12  ER-7395                 PIC  X(04) VALUE '7395'.
  3107     12  ER-7396                 PIC  X(04) VALUE '7396'.
  3108     12  ER-7398                 PIC  X(04) VALUE '7398'.
  3109     12  ER-8965                 PIC  X(04) VALUE '8965'.
  3110     12  ER-9095                 PIC  X(04) VALUE '9095'.
  3111     12  ER-9097                 PIC  X(04) VALUE '9097'.
  3112     12  ER-9281                 PIC  X(04) VALUE '9281'.
  3113     12  ER-9283                 PIC  X(04) VALUE '9283'.
  3114     12  ER-9298                 PIC  X(04) VALUE '9298'.
  3115     12  ER-9299                 PIC  X(04) VALUE '9299'.
  3116     12  ER-9320                 PIC  X(04) VALUE '9320'.
  3117     12  ER-9327                 PIC  X(04) VALUE '9327'.
  3118     12  ER-9426                 PIC  X(04) VALUE '9426'.
  3119     12  ER-9427                 PIC  X(04) VALUE '9427'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  58
* EL689.cbl
  3121*    COPY ELCAID.
  3122******************************************************************
  3123*                                                                *
  3124*                            ELCAID.                             *
  3125*                            VMOD=2.001                          *
  3126*                                                                *
  3127*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3128*                                                                *
  3129*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3130*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3131******************************************************************
  3132
  3133 01  DFHAID.
  3134   02  DFHNULL   PIC  X  VALUE  ' '.
  3135   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3136   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3137   02  DFHPEN    PIC  X  VALUE  '='.
  3138   02  DFHOPID   PIC  X  VALUE  'W'.
  3139   02  DFHPA1    PIC  X  VALUE  '%'.
  3140   02  DFHPA2    PIC  X  VALUE  '>'.
  3141   02  DFHPA3    PIC  X  VALUE  ','.
  3142   02  DFHPF1    PIC  X  VALUE  '1'.
  3143   02  DFHPF2    PIC  X  VALUE  '2'.
  3144   02  DFHPF3    PIC  X  VALUE  '3'.
  3145   02  DFHPF4    PIC  X  VALUE  '4'.
  3146   02  DFHPF5    PIC  X  VALUE  '5'.
  3147   02  DFHPF6    PIC  X  VALUE  '6'.
  3148   02  DFHPF7    PIC  X  VALUE  '7'.
  3149   02  DFHPF8    PIC  X  VALUE  '8'.
  3150   02  DFHPF9    PIC  X  VALUE  '9'.
  3151   02  DFHPF10   PIC  X  VALUE  ':'.
  3152   02  DFHPF11   PIC  X  VALUE  '#'.
  3153   02  DFHPF12   PIC  X  VALUE  '@'.
  3154   02  DFHPF13   PIC  X  VALUE  'A'.
  3155   02  DFHPF14   PIC  X  VALUE  'B'.
  3156   02  DFHPF15   PIC  X  VALUE  'C'.
  3157   02  DFHPF16   PIC  X  VALUE  'D'.
  3158   02  DFHPF17   PIC  X  VALUE  'E'.
  3159   02  DFHPF18   PIC  X  VALUE  'F'.
  3160   02  DFHPF19   PIC  X  VALUE  'G'.
  3161   02  DFHPF20   PIC  X  VALUE  'H'.
  3162   02  DFHPF21   PIC  X  VALUE  'I'.
  3163*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3164   02  DFHPF22   PIC  X  VALUE  '['.
  3165   02  DFHPF23   PIC  X  VALUE  '.'.
  3166   02  DFHPF24   PIC  X  VALUE  '<'.
  3167   02  DFHMSRE   PIC  X  VALUE  'X'.
  3168   02  DFHSTRF   PIC  X  VALUE  'h'.
  3169   02  DFHTRIG   PIC  X  VALUE  '"'.
  3170 01  FILLER    REDEFINES DFHAID.
  3171     12  FILLER                  PIC  X(08).
  3172     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  59
* EL689.cbl
  3174*    COPY ELCATTR.
  3175******************************************************************
  3176*                                                                *
  3177*                            ELCATTR.                            *
  3178*                            VMOD=2.001                          *
  3179*                                                                *
  3180*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  3181*                                                                *
  3182*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  3183*                                                                *
  3184*                   POS 1   P=PROTECTED                          *
  3185*                           U=UNPROTECTED                        *
  3186*                           S=ASKIP                              *
  3187*                   POS 2   A=ALPHA/NUMERIC                      *
  3188*                           N=NUMERIC                            *
  3189*                   POS 3   N=NORMAL                             *
  3190*                           B=BRIGHT                             *
  3191*                           D=DARK                               *
  3192*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  3193*                           OF=MODIFIED DATA TAG OFF             *
  3194*                                                                *
  3195*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  3196******************************************************************
  3197 01  ATTRIBUTE-LIST.
  3198     12  AL-PABOF            PIC X       VALUE 'Y'.
  3199     12  AL-PABON            PIC X       VALUE 'Z'.
  3200     12  AL-PADOF            PIC X       VALUE '%'.
  3201     12  AL-PADON            PIC X       VALUE '_'.
  3202     12  AL-PANOF            PIC X       VALUE '-'.
  3203     12  AL-PANON            PIC X       VALUE '/'.
  3204     12  AL-SABOF            PIC X       VALUE '8'.
  3205     12  AL-SABON            PIC X       VALUE '9'.
  3206     12  AL-SADOF            PIC X       VALUE '@'.
  3207     12  AL-SADON            PIC X       VALUE QUOTE.
  3208     12  AL-SANOF            PIC X       VALUE '0'.
  3209     12  AL-SANON            PIC X       VALUE '1'.
  3210     12  AL-UABOF            PIC X       VALUE 'H'.
  3211     12  AL-UABON            PIC X       VALUE 'I'.
  3212     12  AL-UADOF            PIC X       VALUE '<'.
  3213     12  AL-UADON            PIC X       VALUE '('.
  3214     12  AL-UANOF            PIC X       VALUE ' '.
  3215     12  AL-UANON            PIC X       VALUE 'A'.
  3216     12  AL-UNBOF            PIC X       VALUE 'Q'.
  3217     12  AL-UNBON            PIC X       VALUE 'R'.
  3218     12  AL-UNDOF            PIC X       VALUE '*'.
  3219     12  AL-UNDON            PIC X       VALUE ')'.
  3220     12  AL-UNNOF            PIC X       VALUE '&'.
  3221     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  60
* EL689.cbl
  3223*    COPY ELCDATE.
  3224******************************************************************
  3225*                                                                *
  3226*                                                                *
  3227*                            ELCDATE.                            *
  3228*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3229*                            VMOD=2.003
  3230*                                                                *
  3231*                                                                *
  3232*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3233*                 LENGTH = 200                                   *
  3234******************************************************************
  3235
  3236 01  DATE-CONVERSION-DATA.
  3237     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3238     12  DC-OPTION-CODE                PIC X.
  3239         88  BIN-TO-GREG                VALUE ' '.
  3240         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3241         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3242         88  YMD-GREG-TO-BIN            VALUE '3'.
  3243         88  MDY-GREG-TO-BIN            VALUE '4'.
  3244         88  JULIAN-TO-BIN              VALUE '5'.
  3245         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3246         88  FIND-CENTURY               VALUE '7'.
  3247         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3248         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3249         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3250         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3251         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3252         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3253         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3254         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3255         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3256         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3257         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3258         88  BIN-3-TO-GREG              VALUE 'I'.
  3259         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3260         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3261         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3262         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3263         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3264         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3265         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3266         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3267         88  THREE-CHARACTER-BIN
  3268                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3269         88  GREGORIAN-TO-BIN
  3270                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3271         88  BIN-TO-GREGORIAN
  3272                  VALUES ' ' '1' 'I' '8' 'G'.
  3273         88  JULIAN-TO-BINARY
  3274                  VALUES '5' 'C' 'E' 'F'.
  3275     12  DC-ERROR-CODE                 PIC X.
  3276         88  NO-CONVERSION-ERROR        VALUE ' '.
  3277         88  DATE-CONVERSION-ERROR
  3278                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3279         88  DATE-IS-ZERO               VALUE '1'.
  3280         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  61
* EL689.cbl
  3281         88  DATE-IS-INVALID            VALUE '3'.
  3282         88  DATE1-GREATER-DATE2        VALUE '4'.
  3283         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3284         88  DATE-INVALID-OPTION        VALUE '9'.
  3285         88  INVALID-CENTURY            VALUE 'A'.
  3286         88  ONLY-CENTURY               VALUE 'B'.
  3287         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3288         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3289     12  DC-END-OF-MONTH               PIC X.
  3290         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3291     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3292         88  USE-NORMAL-PROCESS         VALUE ' '.
  3293         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3294         88  ADJUST-UP-100-YRS          VALUE '2'.
  3295     12  FILLER                        PIC X.
  3296     12  DC-CONVERSION-DATES.
  3297         16  DC-BIN-DATE-1             PIC XX.
  3298         16  DC-BIN-DATE-2             PIC XX.
  3299         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3300         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3301                       DC-GREG-DATE-1-EDIT.
  3302             20  DC-EDIT1-MONTH        PIC 99.
  3303             20  SLASH1-1              PIC X.
  3304             20  DC-EDIT1-DAY          PIC 99.
  3305             20  SLASH1-2              PIC X.
  3306             20  DC-EDIT1-YEAR         PIC 99.
  3307         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3308         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3309                     DC-GREG-DATE-2-EDIT.
  3310             20  DC-EDIT2-MONTH        PIC 99.
  3311             20  SLASH2-1              PIC X.
  3312             20  DC-EDIT2-DAY          PIC 99.
  3313             20  SLASH2-2              PIC X.
  3314             20  DC-EDIT2-YEAR         PIC 99.
  3315         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3316         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3317                     DC-GREG-DATE-1-YMD.
  3318             20  DC-YMD-YEAR           PIC 99.
  3319             20  DC-YMD-MONTH          PIC 99.
  3320             20  DC-YMD-DAY            PIC 99.
  3321         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3322         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3323                      DC-GREG-DATE-1-MDY.
  3324             20  DC-MDY-MONTH          PIC 99.
  3325             20  DC-MDY-DAY            PIC 99.
  3326             20  DC-MDY-YEAR           PIC 99.
  3327         16  DC-GREG-DATE-1-ALPHA.
  3328             20  DC-ALPHA-MONTH        PIC X(10).
  3329             20  DC-ALPHA-DAY          PIC 99.
  3330             20  FILLER                PIC XX.
  3331             20  DC-ALPHA-CENTURY.
  3332                 24 DC-ALPHA-CEN-N     PIC 99.
  3333             20  DC-ALPHA-YEAR         PIC 99.
  3334         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3335         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3336         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3337         16  DC-JULIAN-DATE            PIC 9(05).
  3338         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  62
* EL689.cbl
  3339                                       PIC 9(05).
  3340         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3341             20  DC-JULIAN-YEAR        PIC 99.
  3342             20  DC-JULIAN-DAYS        PIC 999.
  3343         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3344         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3345         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3346     12  DATE-CONVERSION-VARIBLES.
  3347         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3348         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3349             20  FILLER                PIC 9(3).
  3350             20  HOLD-CEN-1-CCYY.
  3351                 24  HOLD-CEN-1-CC     PIC 99.
  3352                 24  HOLD-CEN-1-YY     PIC 99.
  3353             20  HOLD-CEN-1-MO         PIC 99.
  3354             20  HOLD-CEN-1-DA         PIC 99.
  3355         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3356             20  HOLD-CEN-1-R-MO       PIC 99.
  3357             20  HOLD-CEN-1-R-DA       PIC 99.
  3358             20  HOLD-CEN-1-R-CCYY.
  3359                 24  HOLD-CEN-1-R-CC   PIC 99.
  3360                 24  HOLD-CEN-1-R-YY   PIC 99.
  3361             20  FILLER                PIC 9(3).
  3362         16  HOLD-CENTURY-1-X.
  3363             20  FILLER                PIC X(3)  VALUE SPACES.
  3364             20  HOLD-CEN-1-X-CCYY.
  3365                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3366                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3367             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3368             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3369         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3370             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3371             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3372             20  HOLD-CEN-1-R-X-CCYY.
  3373                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3374                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3375             20  FILLER                PIC XXX.
  3376         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3377         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3378         16  DC-JULIAN-DATE-1          PIC 9(07).
  3379         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3380             20  DC-JULIAN-1-CCYY.
  3381                 24  DC-JULIAN-1-CC    PIC 99.
  3382                 24  DC-JULIAN-1-YR    PIC 99.
  3383             20  DC-JULIAN-DA-1        PIC 999.
  3384         16  DC-JULIAN-DATE-2          PIC 9(07).
  3385         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3386             20  DC-JULIAN-2-CCYY.
  3387                 24  DC-JULIAN-2-CC    PIC 99.
  3388                 24  DC-JULIAN-2-YR    PIC 99.
  3389             20  DC-JULIAN-DA-2        PIC 999.
  3390         16  DC-GREG-DATE-A-EDIT.
  3391             20  DC-EDITA-MONTH        PIC 99.
  3392             20  SLASHA-1              PIC X VALUE '/'.
  3393             20  DC-EDITA-DAY          PIC 99.
  3394             20  SLASHA-2              PIC X VALUE '/'.
  3395             20  DC-EDITA-CCYY.
  3396                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  63
* EL689.cbl
  3397                 24  DC-EDITA-YEAR     PIC 99.
  3398         16  DC-GREG-DATE-B-EDIT.
  3399             20  DC-EDITB-MONTH        PIC 99.
  3400             20  SLASHB-1              PIC X VALUE '/'.
  3401             20  DC-EDITB-DAY          PIC 99.
  3402             20  SLASHB-2              PIC X VALUE '/'.
  3403             20  DC-EDITB-CCYY.
  3404                 24  DC-EDITB-CENT     PIC 99.
  3405                 24  DC-EDITB-YEAR     PIC 99.
  3406         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3407         16  DC-GREG-DATE-CYMD-R REDEFINES
  3408                              DC-GREG-DATE-CYMD.
  3409             20  DC-CYMD-CEN           PIC 99.
  3410             20  DC-CYMD-YEAR          PIC 99.
  3411             20  DC-CYMD-MONTH         PIC 99.
  3412             20  DC-CYMD-DAY           PIC 99.
  3413         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3414         16  DC-GREG-DATE-MDCY-R REDEFINES
  3415                              DC-GREG-DATE-MDCY.
  3416             20  DC-MDCY-MONTH         PIC 99.
  3417             20  DC-MDCY-DAY           PIC 99.
  3418             20  DC-MDCY-CEN           PIC 99.
  3419             20  DC-MDCY-YEAR          PIC 99.
  3420    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3421        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3422    12  DC-EL310-DATE                  PIC X(21).
  3423    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  64
* EL689.cbl
  3425*    COPY ELCNWA.
  3426*****************************************************************
  3427*                                                               *
  3428*                                                               *
  3429*                            ELCNWA.                            *
  3430*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3431*                            VMOD=2.003                         *
  3432*                                                               *
  3433*            M O V E   N A M E   W O R K   A R E A.             *
  3434*                                                               *
  3435*****************************************************************.
  3436
  3437 01  WS-NAME-WORK-AREA.
  3438     05  WS-INSURED-LAST-NAME        PIC X(15).
  3439     05  WS-INSURED-1ST-NAME         PIC X(12).
  3440     05  WS-INSURED-MID-INIT         PIC X.
  3441
  3442     05  WS-NAME-WORK.
  3443         10  WS-NW                   PIC X
  3444             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  3445
  3446     05  WS-NAME-WORK2.
  3447         10  WS-NW2                  PIC X
  3448             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  3449                                        NWA-INDEX0.
  3450
  3451     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  3452                                     COMP-3.
  3453
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  65
* EL689.cbl
  3455*    COPY ELCEMIB.
  3456******************************************************************
  3457*                                                                *
  3458*                                                                *
  3459*                            ELCEMIB.                            *
  3460*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3461*                            VMOD=2.005                          *
  3462*                                                                *
  3463*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  3464*                                                                *
  3465******************************************************************
  3466 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  3467     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  3468     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  3469     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  3470     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  3471     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  3472     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  3473     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  3474     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  3475     12  EMI-SWITCH1             PIC X        VALUE '1'.
  3476         88  EMI-NO-ERRORS                    VALUE '1'.
  3477         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  3478         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3479     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3480         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3481     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3482         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3483         88  EMI-AREA1-FULL                   VALUE '2'.
  3484     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3485         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3486         88  EMI-AREA2-FULL                   VALUE '2'.
  3487     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3488         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3489         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3490         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3491         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3492         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3493     12  EMI-ERROR-LINES.
  3494         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3495         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3496         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3497         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3498             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3499                 24  EMI-ERR-NUM         PIC X(4).
  3500                 24  EMI-FILLER          PIC X.
  3501                 24  EMI-SEV             PIC X.
  3502                 24  FILLER              PIC X.
  3503             20  FILLER                  PIC X(02).
  3504     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3505         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3506             20  EMI-ERROR-NUMBER    PIC X(4).
  3507             20  EMI-FILL            PIC X.
  3508             20  EMI-SEVERITY        PIC X.
  3509             20  FILLER              PIC X.
  3510             20  EMI-ERROR-TEXT.
  3511                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3512                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  66
* EL689.cbl
  3513     12  EMI-SEVERITY-SAVE           PIC X.
  3514         88  EMI-NOTE                    VALUE 'N'.
  3515         88  EMI-WARNING                 VALUE 'W'.
  3516         88  EMI-FORCABLE                VALUE 'F'.
  3517         88  EMI-FATAL                   VALUE 'X'.
  3518     12  EMI-MESSAGE-FLAG            PIC X.
  3519         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3520         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3521     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3522     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3523         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3524         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3525         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3526     12  FILLER                      PIC X(137)  VALUE SPACES.
  3527     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3528     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3529     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3530     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  3531 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  67
* EL689.cbl
  3533*    COPY ELCLOGOF.
  3534******************************************************************
  3535*                                                                *
  3536*                                                                *
  3537*                            ELCLOGOF.                           *
  3538*                            VMOD=2.001                          *
  3539*                                                                *
  3540*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  3541*                                                                *
  3542******************************************************************
  3543 01  CLASIC-LOGOFF.
  3544     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  3545     12  LOGOFF-TEXT.
  3546         16  FILLER          PIC X(5)    VALUE SPACES.
  3547         16  LOGOFF-MSG.
  3548             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  3549             20  FILLER      PIC X       VALUE SPACES.
  3550             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  3551         16  FILLER          PIC X(80)
  3552           VALUE '* YOU ARE NOW LOGGED OFF'.
  3553         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  3554         16  FILLER          PIC X       VALUE QUOTE.
  3555         16  LOGOFF-SYS-MSG  PIC X(17)
  3556           VALUE 'S CLAS-IC SYSTEM '.
  3557     12  TEXT-MESSAGES.
  3558         16  UNACCESS-MSG    PIC X(29)
  3559             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  3560         16  PGMIDERR-MSG    PIC X(17)
  3561             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  68
* EL689.cbl
  3563*    COPY ELCSCTM.
  3564******************************************************************
  3565*                                                                *
  3566*                                                                *
  3567*                            ELCSCTM                             *
  3568*                            VMOD=2.001                          *
  3569*                                                                *
  3570*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  3571*                                                                *
  3572******************************************************************
  3573 01  SECURITY-MESSAGE.
  3574     12  FILLER                          PIC X(30)
  3575            VALUE '** LOGIC SECURITY VIOLATION -'.
  3576     12  SM-READ                         PIC X(6).
  3577     12  FILLER                          PIC X(5)
  3578            VALUE ' PGM='.
  3579     12  SM-PGM                          PIC X(6).
  3580     12  FILLER                          PIC X(5)
  3581            VALUE ' OPR='.
  3582     12  SM-PROCESSOR-ID                 PIC X(4).
  3583     12  FILLER                          PIC X(6)
  3584            VALUE ' TERM='.
  3585     12  SM-TERMID                       PIC X(4).
  3586     12  FILLER                          PIC XX   VALUE SPACE.
  3587     12  SM-JUL-DATE                     PIC 9(5).
  3588     12  FILLER                          PIC X    VALUE SPACE.
  3589     12  SM-TIME                         PIC 99.99.
  3590
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  69
* EL689.cbl
  3592*    COPY ELCSCRTY.
  3593******************************************************************
  3594*                                                                *
  3595*                                                                *
  3596*                            ELCSCRTY                            *
  3597*                            VMOD=2.001                          *
  3598*                                                                *
  3599*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  3600*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  3601*        SAVED IN PI-SECURITY-ADDRESS.                           *
  3602*                                                                *
  3603******************************************************************
  3604 01  SECURITY-CONTROL.
  3605     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  3606     12  FILLER                       PIC XX    VALUE 'SC'.
  3607     12  SC-CREDIT-CODES.
  3608         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  3609             20  SC-CREDIT-DISPLAY    PIC X.
  3610             20  SC-CREDIT-UPDATE     PIC X.
  3611     12  SC-CLAIMS-CODES.
  3612         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  3613             20  SC-CLAIMS-DISPLAY    PIC X.
  3614             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  70
* EL689.cbl
  3616
  3617 01  W-TS-WORK-AREA              PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  71
* EL689.cbl
  3619****************************************************************
  3620*
  3621* Copyright (c) 2007 by Clerity Solutions, Inc.
  3622* All rights reserved.
  3623*
  3624****************************************************************
  3625 01  DFHEIV.
  3626   02  DFHEIV0               PIC X(35).
  3627   02  DFHEIV1               PIC X(08).
  3628   02  DFHEIV2               PIC X(08).
  3629   02  DFHEIV3               PIC X(08).
  3630   02  DFHEIV4               PIC X(06).
  3631   02  DFHEIV5               PIC X(04).
  3632   02  DFHEIV6               PIC X(04).
  3633   02  DFHEIV7               PIC X(02).
  3634   02  DFHEIV8               PIC X(02).
  3635   02  DFHEIV9               PIC X(01).
  3636   02  DFHEIV10              PIC S9(7) COMP-3.
  3637   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3638   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3639   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3640   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3641   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3642   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3643   02  DFHEIV17              PIC X(04).
  3644   02  DFHEIV18              PIC X(04).
  3645   02  DFHEIV19              PIC X(04).
  3646   02  DFHEIV20              USAGE IS POINTER.
  3647   02  DFHEIV21              USAGE IS POINTER.
  3648   02  DFHEIV22              USAGE IS POINTER.
  3649   02  DFHEIV23              USAGE IS POINTER.
  3650   02  DFHEIV24              USAGE IS POINTER.
  3651   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3652   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3653   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3654   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3655   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3656   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3657   02  FILLER                PIC X(02).
  3658   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3659   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3660   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3661   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3662   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3663 LINKAGE  SECTION.
  3664*****************************************************************
  3665*                                                               *
  3666* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3667* All rights reserved.                                          *
  3668*                                                               *
  3669*****************************************************************
  3670 01  dfheiblk.
  3671     02  eibtime          pic s9(7) comp-3.
  3672     02  eibdate          pic s9(7) comp-3.
  3673     02  eibtrnid         pic x(4).
  3674     02  eibtaskn         pic s9(7) comp-3.
  3675     02  eibtrmid         pic x(4).
  3676     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  72
* EL689.cbl
  3677     02  eibcposn         pic s9(4) comp.
  3678     02  eibcalen         pic s9(4) comp.
  3679     02  eibaid           pic x(1).
  3680     02  eibfiller1       pic x(1).
  3681     02  eibfn            pic x(2).
  3682     02  eibfiller2       pic x(2).
  3683     02  eibrcode         pic x(6).
  3684     02  eibfiller3       pic x(2).
  3685     02  eibds            pic x(8).
  3686     02  eibreqid         pic x(8).
  3687     02  eibrsrce         pic x(8).
  3688     02  eibsync          pic x(1).
  3689     02  eibfree          pic x(1).
  3690     02  eibrecv          pic x(1).
  3691     02  eibsend          pic x(1).
  3692     02  eibatt           pic x(1).
  3693     02  eibeoc           pic x(1).
  3694     02  eibfmh           pic x(1).
  3695     02  eibcompl         pic x(1).
  3696     02  eibsig           pic x(1).
  3697     02  eibconf          pic x(1).
  3698     02  eiberr           pic x(1).
  3699     02  eibrldbk         pic x(1).
  3700     02  eiberrcd         pic x(4).
  3701     02  eibsynrb         pic x(1).
  3702     02  eibnodat         pic x(1).
  3703     02  eibfiller5       pic x(2).
  3704     02  eibresp          pic 9(09) comp.
  3705     02  eibresp2         pic 9(09) comp.
  3706     02  dfheigdj         pic s9(4) comp.
  3707     02  dfheigdk         pic s9(4) comp.
  3708 01  DFHCOMMAREA                 PIC X(1024).
  3709
  3710*    COPY ERCACCT.
  3711******************************************************************
  3712*                                                                *
  3713*                                                                *
  3714*                            ERCACCT                             *
  3715*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3716*                            VMOD=2.031                          *
  3717*                                                                *
  3718*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3719*                                                                *
  3720*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3721*   VSAM ACCOUNT MASTER FILES.                                   *
  3722*                                                                *
  3723*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3724*                                                                *
  3725*   FILE TYPE = VSAM,KSDS                                        *
  3726*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3727*                                                                *
  3728*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3729*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3730*                                                                *
  3731*   LOG = NO                                                     *
  3732*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3733*                                                                *
  3734*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  73
* EL689.cbl
  3735******************************************************************
  3736*                   C H A N G E   L O G
  3737*
  3738* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3739*-----------------------------------------------------------------
  3740*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3741* EFFECTIVE    NUMBER
  3742*-----------------------------------------------------------------
  3743* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3744* 092705    2005050300006  PEMA  ADD SPP LEASES
  3745* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3746* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3747* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3748* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3749******************************************************************
  3750
  3751 01  ACCOUNT-MASTER.
  3752     12  AM-RECORD-ID                      PIC XX.
  3753         88  VALID-AM-ID                      VALUE 'AM'.
  3754
  3755     12  AM-CONTROL-PRIMARY.
  3756         16  AM-COMPANY-CD                 PIC X.
  3757         16  AM-MSTR-CNTRL.
  3758             20  AM-CONTROL-A.
  3759                 24  AM-CARRIER            PIC X.
  3760                 24  AM-GROUPING.
  3761                     28 AM-GROUPING-PREFIX PIC XXX.
  3762                     28 AM-GROUPING-PRIME  PIC XXX.
  3763                 24  AM-STATE              PIC XX.
  3764                 24  AM-ACCOUNT.
  3765                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3766                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3767             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3768                                           PIC X(19).
  3769             20  AM-CNTRL-B.
  3770                 24  AM-EXPIRATION-DT      PIC XX.
  3771                 24  FILLER                PIC X(4).
  3772             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3773                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3774
  3775     12  AM-CONTROL-BY-VAR-GRP.
  3776         16  AM-COMPANY-CD-A1              PIC X.
  3777         16  AM-VG-CARRIER                 PIC X.
  3778         16  AM-VG-GROUPING                PIC X(6).
  3779         16  AM-VG-STATE                   PIC XX.
  3780         16  AM-VG-ACCOUNT                 PIC X(10).
  3781         16  AM-VG-DATE.
  3782             20  AM-VG-EXPIRATION-DT       PIC XX.
  3783             20  FILLER                    PIC X(4).
  3784         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3785                                           PIC 9(11)      COMP-3.
  3786     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3787         16  FILLER                        PIC X(10).
  3788         16  AM-VG-KEY3.
  3789             20  AM-VG3-ACCOUNT            PIC X(10).
  3790             20  AM-VG3-EXP-DT             PIC XX.
  3791         16  FILLER                        PIC X(4).
  3792     12  AM-MAINT-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  74
* EL689.cbl
  3793         16  AM-LAST-MAINT-DT              PIC XX.
  3794         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3795         16  AM-LAST-MAINT-USER            PIC X(4).
  3796         16  FILLER                        PIC XX.
  3797
  3798     12  AM-EFFECTIVE-DT                   PIC XX.
  3799     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3800
  3801     12  AM-PREV-DATES  COMP-3.
  3802         16  AM-PREV-EXP-DT                PIC 9(11).
  3803         16  AM-PREV-EFF-DT                PIC 9(11).
  3804
  3805     12  AM-REPORT-CODE-1                  PIC X(10).
  3806     12  AM-REPORT-CODE-2                  PIC X(10).
  3807
  3808     12  AM-CITY-CODE                      PIC X(4).
  3809     12  AM-COUNTY-PARISH                  PIC X(6).
  3810
  3811     12  AM-NAME                           PIC X(30).
  3812     12  AM-PERSON                         PIC X(30).
  3813     12  AM-ADDRS                          PIC X(30).
  3814     12  AM-CITY.
  3815         16  AM-ADDR-CITY                  PIC X(28).
  3816         16  AM-ADDR-STATE                 PIC XX.
  3817     12  AM-ZIP.
  3818         16  AM-ZIP-PRIME.
  3819             20  AM-ZIP-PRI-1ST            PIC X.
  3820                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3821             20  FILLER                    PIC X(4).
  3822         16  AM-ZIP-PLUS4                  PIC X(4).
  3823     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3824         16  AM-CAN-POSTAL-1               PIC XXX.
  3825         16  AM-CAN-POSTAL-2               PIC XXX.
  3826         16  FILLER                        PIC XXX.
  3827     12  AM-TEL-NO.
  3828         16  AM-AREA-CODE                  PIC 999.
  3829         16  AM-TEL-PRE                    PIC 999.
  3830         16  AM-TEL-NBR                    PIC 9(4).
  3831     12  AM-TEL-LOC                        PIC X.
  3832         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3833         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3834
  3835     12  AM-COMM-STRUCTURE.
  3836         16  AM-DEFN-1.
  3837             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3838                 24  AM-AGT.
  3839                     28  AM-AGT-PREFIX     PIC X(4).
  3840                     28  AM-AGT-PRIME      PIC X(6).
  3841                 24  AM-COM-TYP            PIC X.
  3842                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3843                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3844                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3845                 24  AM-RECALC-LV-INDIC    PIC X.
  3846                 24  AM-RETRO-LV-INDIC     PIC X.
  3847                 24  AM-GL-CODES           PIC X.
  3848                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3849                 24  FILLER                PIC X(01).
  3850         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  75
* EL689.cbl
  3851             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3852                 24  FILLER                PIC X(11).
  3853                 24  AM-L-COMA             PIC XXX.
  3854                 24  AM-J-COMA             PIC XXX.
  3855                 24  AM-A-COMA             PIC XXX.
  3856                 24  FILLER                PIC X(6).
  3857
  3858     12  AM-COMM-CHANGE-STATUS             PIC X.
  3859         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3860
  3861     12  AM-CSR-CODE                       PIC X(4).
  3862
  3863     12  AM-BILLING-STATUS                 PIC X.
  3864         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3865         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3866     12  AM-AUTO-REFUND-SW                 PIC X.
  3867         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3868         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  3869     12  AM-GPCD                           PIC 99.
  3870     12  AM-IG                             PIC X.
  3871         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3872         88  AM-HAS-GROUP                     VALUE '2'.
  3873     12  AM-STATUS                         PIC X.
  3874         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3875         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3876         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3877         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3878         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3879         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3880     12  AM-REMIT-TO                       PIC 99.
  3881     12  AM-ID-NO                          PIC X(11).
  3882
  3883     12  AM-CAL-TABLE                      PIC XX.
  3884     12  AM-LF-DEVIATION                   PIC XXX.
  3885     12  AM-AH-DEVIATION                   PIC XXX.
  3886     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3887     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3888     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3889     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3890     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3891     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3892
  3893     12  AM-USER-FIELDS.
  3894         16  AM-FLD-1                      PIC XX.
  3895         16  AM-FLD-2                      PIC XX.
  3896         16  AM-FLD-3                      PIC XX.
  3897         16  AM-FLD-4                      PIC XX.
  3898         16  AM-FLD-5                      PIC XX.
  3899
  3900     12  AM-1ST-PROD-DATE.
  3901         16  AM-1ST-PROD-YR                PIC XX.
  3902         16  AM-1ST-PROD-MO                PIC XX.
  3903         16  AM-1ST-PROD-DA                PIC XX.
  3904     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3905     12  AM-CERTS-PURGED-DATE.
  3906         16  AM-PUR-YR                     PIC XX.
  3907         16  AM-PUR-MO                     PIC XX.
  3908         16  AM-PUR-DA                     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  76
* EL689.cbl
  3909     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3910     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3911     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3912     12  AM-INACTIVE-DATE.
  3913         16  AM-INA-MO                     PIC 99.
  3914         16  AM-INA-DA                     PIC 99.
  3915         16  AM-INA-YR                     PIC 99.
  3916     12  AM-AR-HI-CERT-DATE                PIC XX.
  3917
  3918     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3919     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3920
  3921     12  AM-OB-PAYMENT-MODE                PIC X.
  3922         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  3923         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3924         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3925         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3926
  3927     12  AM-AH-ONLY-INDICATOR              PIC X.
  3928         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3929         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3930
  3931     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3932
  3933     12  AM-OVER-SHORT.
  3934         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3935         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3936
  3937     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3938     12  AM-DCC-CLP-STATE                  PIC XX.
  3939
  3940     12  AM-RECALC-COMM                    PIC X.
  3941     12  AM-RECALC-REIN                    PIC X.
  3942
  3943     12  AM-REI-TABLE                      PIC XXX.
  3944     12  AM-REI-ET-LF                      PIC X.
  3945     12  AM-REI-ET-AH                      PIC X.
  3946     12  AM-REI-PE-LF                      PIC X.
  3947     12  AM-REI-PE-AH                      PIC X.
  3948     12  AM-REI-PRT-ST                     PIC X.
  3949     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3950     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3951     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3952     12  AM-REI-GROUP-A                    PIC X(6).
  3953     12  AM-REI-MORT                       PIC X(4).
  3954     12  AM-REI-PRT-OW                     PIC X.
  3955     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3956     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3957     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3958     12  AM-REI-GROUP-B                    PIC X(6).
  3959
  3960     12  AM-TRUST-TYPE                     PIC X(2).
  3961
  3962     12  AM-EMPLOYER-STMT-USED             PIC X.
  3963     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3964
  3965     12  AM-STD-AH-TYPE                    PIC XX.
  3966     12  AM-EARN-METHODS.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  77
* EL689.cbl
  3967         16  AM-EARN-METHOD-R              PIC X.
  3968             88 AM-REF-RL-R78                 VALUE 'R'.
  3969             88 AM-REF-RL-PR                  VALUE 'P'.
  3970             88 AM-REF-RL-MEAN                VALUE 'M'.
  3971             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3972         16  AM-EARN-METHOD-L              PIC X.
  3973             88 AM-REF-LL-R78                 VALUE 'R'.
  3974             88 AM-REF-LL-PR                  VALUE 'P'.
  3975             88 AM-REF-LL-MEAN                VALUE 'M'.
  3976             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3977         16  AM-EARN-METHOD-A              PIC X.
  3978             88 AM-REF-AH-R78                 VALUE 'R'.
  3979             88 AM-REF-AH-PR                  VALUE 'P'.
  3980             88 AM-REF-AH-MEAN                VALUE 'M'.
  3981             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3982             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3983             88 AM-REF-AH-NET                 VALUE 'N'.
  3984
  3985     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3986     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3987     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3988
  3989     12  AM-RET-Y-N                        PIC X.
  3990     12  AM-RET-P-E                        PIC X.
  3991     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3992     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3993     12  AM-RET-GRP                        PIC X(6).
  3994     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3995         16  AM-POOL-PRIME                 PIC XXX.
  3996         16  AM-POOL-SUB                   PIC XXX.
  3997     12  AM-RETRO-EARNINGS.
  3998         16  AM-RET-EARN-R                 PIC X.
  3999         16  AM-RET-EARN-L                 PIC X.
  4000         16  AM-RET-EARN-A                 PIC X.
  4001     12  AM-RET-ST-TAX-USE                 PIC X.
  4002         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4003         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4004     12  AM-RETRO-BEG-EARNINGS.
  4005         16  AM-RET-BEG-EARN-R             PIC X.
  4006         16  AM-RET-BEG-EARN-L             PIC X.
  4007         16  AM-RET-BEG-EARN-A             PIC X.
  4008     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  4009     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4010
  4011     12  AM-USER-SELECT-OPTIONS.
  4012         16  AM-USER-SELECT-1              PIC X(10).
  4013         16  AM-USER-SELECT-2              PIC X(10).
  4014         16  AM-USER-SELECT-3              PIC X(10).
  4015         16  AM-USER-SELECT-4              PIC X(10).
  4016         16  AM-USER-SELECT-5              PIC X(10).
  4017
  4018     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4019
  4020     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4021
  4022     12  AM-RPT045A-SWITCH                 PIC X.
  4023         88  RPT045A-OFF                   VALUE 'N'.
  4024
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  78
* EL689.cbl
  4025     12  AM-INSURANCE-LIMITS.
  4026         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4027         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4028
  4029     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4030         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4031
  4032     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4033         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4034         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4035
  4036     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4037
  4038     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4039     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4040     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4041     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4042     12  FILLER                            PIC X(5).
  4043     12  AM-REPORT-CODE-3                  PIC X(10).
  4044*    12  FILLER                            PIC X(22).
  4045
  4046     12  AM-RESERVE-DATE.
  4047         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4048         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4049         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4050
  4051     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4052     12  AM-NOTIFICATION-TYPES.
  4053         16  AM-NOTIF-OF-LETTERS           PIC X.
  4054         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4055         16  AM-NOTIF-OF-REPORTS           PIC X.
  4056         16  AM-NOTIF-OF-STATUS            PIC X.
  4057
  4058     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4059         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4060         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4061         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4062         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4063
  4064     12  AM-BENEFIT-CONTROLS.
  4065         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4066             20  AM-BENEFIT-CODE           PIC XX.
  4067             20  AM-BENEFIT-TYPE           PIC X.
  4068             20  AM-BENEFIT-REVISION       PIC XXX.
  4069             20  AM-BENEFIT-REM-TERM       PIC X.
  4070             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4071             20  FILLER                    PIC XX.
  4072         16  FILLER                        PIC X(80).
  4073
  4074     12  AM-TRANSFER-DATA.
  4075         16  AM-TRANSFERRED-FROM.
  4076             20  AM-TRNFROM-CARRIER        PIC X.
  4077             20  AM-TRNFROM-GROUPING.
  4078                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4079                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4080             20  AM-TRNFROM-STATE          PIC XX.
  4081             20  AM-TRNFROM-ACCOUNT.
  4082                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  79
* EL689.cbl
  4083                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4084             20  AM-TRNFROM-DTE            PIC XX.
  4085         16  AM-TRANSFERRED-TO.
  4086             20  AM-TRNTO-CARRIER          PIC X.
  4087             20  AM-TRNTO-GROUPING.
  4088                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4089                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4090             20  AM-TRNTO-STATE            PIC XX.
  4091             20  AM-TRNTO-ACCOUNT.
  4092                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4093                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4094             20  AM-TRNTO-DTE              PIC XX.
  4095         16  FILLER                        PIC X(10).
  4096
  4097     12  AM-SAVED-REMIT-TO                 PIC 99.
  4098
  4099     12  AM-COMM-STRUCTURE-SAVED.
  4100         16  AM-DEFN-1-SAVED.
  4101             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4102                 24  AM-AGT-SV             PIC X(10).
  4103                 24  AM-COM-TYP-SV         PIC X.
  4104                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4105                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4106                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4107                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4108                 24  FILLER                PIC X.
  4109                 24  AM-GL-CODES-SV        PIC X.
  4110                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4111                 24  FILLER                PIC X.
  4112         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4113             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4114                 24  FILLER                PIC X(11).
  4115                 24  AM-L-COMA-SV          PIC XXX.
  4116                 24  AM-J-COMA-SV          PIC XXX.
  4117                 24  AM-A-COMA-SV          PIC XXX.
  4118                 24  FILLER                PIC X(6).
  4119
  4120     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4121         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4122            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4123            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4124            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4125
  4126     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4127     12  FILLER                            PIC X(120).
  4128
  4129     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4130         16  AM-CONTROL-NAME               PIC X(30).
  4131         16  AM-EXECUTIVE-ONE.
  4132             20  AM-EXEC1-NAME             PIC X(15).
  4133             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4134                                                          COMP-3.
  4135             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4136                                                          COMP-3.
  4137         16  AM-EXECUTIVE-TWO.
  4138             20  AM-EXEC2-NAME             PIC X(15).
  4139             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4140                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  80
* EL689.cbl
  4141             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4142                                                          COMP-3.
  4143
  4144     12  AM-RETRO-ADDITIONAL-DATA.
  4145         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4146         16  AM-RETRO-PREM-P-E             PIC X.
  4147         16  AM-RETRO-CLMS-P-I             PIC X.
  4148         16  AM-RETRO-RET-BRACKET-LF.
  4149             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4150                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4151                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4152             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4153                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4154                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4155             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4156                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4157                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4158         16  AM-RETRO-RET-BRACKET-AH.
  4159             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4160                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4161                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4162                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4163             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4164                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4165                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4166             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4167                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4168                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4169
  4170     12  AM-COMMENTS.
  4171         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4172
  4173     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4174         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4175         16  AM-FLI-BILLING-CODE           PIC X.
  4176         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4177         16  AM-FLI-UNITED-IDENT           PIC X.
  4178         16  AM-FLI-INTEREST-LOST-DATA.
  4179             20  AM-FLI-BANK-NO            PIC X(5).
  4180             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4181             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4182             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4183         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4184             20  AM-FLI-AGT                PIC X(9).
  4185             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4186             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4187         16  FILLER                        PIC X(102).
  4188
  4189     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4190         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4191             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4192             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4193             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4194             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4195             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4196         16  FILLER                          PIC X(10).
  4197******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  81
* EL689.cbl
  4199*    COPY ERCARCH.
  4200******************************************************************
  4201*                                                                *
  4202*                            ERCARCH.                            *
  4203*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4204*                            VMOD=2.002                          *
  4205*                                                                *
  4206*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4207*                                                                *
  4208*   FILE TYPE = VSAM,KSDS                                        *
  4209*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4210*                                                                *
  4211*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4212*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4213*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4214*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4215*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4216*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4217*                                                                *
  4218*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4219******************************************************************
  4220*                   C H A N G E   L O G
  4221*
  4222* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4223*-----------------------------------------------------------------
  4224*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4225* EFFECTIVE    NUMBER
  4226*-----------------------------------------------------------------
  4227* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4228******************************************************************
  4229 01  LETTER-ARCHIVE.
  4230     12  LA-RECORD-ID                PIC  X(02).
  4231         88  LA-VALID-ID                VALUE 'LA'.
  4232
  4233     12  LA-CONTROL-PRIMARY.
  4234         16  LA-COMPANY-CD           PIC  X(01).
  4235         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4236
  4237     12  LA-CONTROL-BY-CERT-RESP.
  4238         16  LA-COMPANY-CD-A2        PIC  X(01).
  4239         16  LA-CERT-NO-A2.
  4240             20  LA-CERT-PRIME-A2    PIC  X(10).
  4241             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4242         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4243             20  LA-RESP-PERSON-A2   PIC  X(10).
  4244             20  LA-TYPE-A2          PIC  X(01).
  4245         16  LA-CARRIER-A2           PIC  X(01).
  4246         16  LA-GROUPING-A2          PIC  X(06).
  4247         16  LA-STATE-A2             PIC  X(02).
  4248         16  LA-ACCOUNT-A2           PIC  X(10).
  4249         16  LA-EFFECT-DATE-A2       PIC  X(02).
  4250         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4251
  4252     12  LA-CONTROL-BY-FORM.
  4253         16  LA-COMPANY-CD-A3        PIC  X(01).
  4254         16  LA-FORM-A3              PIC  X(04).
  4255         16  LA-CARRIER-A3           PIC  X(01).
  4256         16  LA-GROUPING-A3          PIC  X(06).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  82
* EL689.cbl
  4257         16  LA-STATE-A3             PIC  X(02).
  4258         16  LA-ACCOUNT-A3           PIC  X(10).
  4259         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4260
  4261     12  LA-CONTROL-BY-PROCESSOR.
  4262         16  LA-COMPANY-CD-A4        PIC  X(01).
  4263         16  LA-PROCESSOR-CD         PIC  X(04).
  4264         16  LA-CARRIER-A4           PIC  X(01).
  4265         16  LA-GROUPING-A4          PIC  X(06).
  4266         16  LA-STATE-A4             PIC  X(02).
  4267         16  LA-ACCOUNT-A4           PIC  X(10).
  4268         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4269
  4270     12  LA-CONTROL-BY-KEY-FIELDS.
  4271         16  LA-COMPANY-CD-A5        PIC  X(01).
  4272         16  LA-CARRIER-A5           PIC  X(01).
  4273         16  LA-GROUPING-A5          PIC  X(06).
  4274         16  LA-STATE-A5             PIC  X(02).
  4275         16  LA-ACCOUNT-A5           PIC  X(10).
  4276         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4277
  4278     12  LA-CONTROL-BY-GROUP-CODE.
  4279         16  LA-COMPANY-CD-A6        PIC  X(01).
  4280         16  LA-ENTRY-A6.
  4281             20  LA-FILLER           PIC  X(02).
  4282             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4283         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4284
  4285     12  FILLER                      PIC  X(09).
  4286
  4287     12  LA-HEADER-RECORD.
  4288         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4289         16  LA-CREATION-DATE        PIC  X(02).
  4290         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4291         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4292         16  LA-NO-OF-COPIES         PIC S9(01).
  4293         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4294         16  LA-REPLY-DATE           PIC  X(02).
  4295         16  LA-RESEND-DATES.
  4296             20  LA-RESEND-DATE      PIC  X(02).
  4297             20  LA-SENT-DATE        PIC  X(02).
  4298             20  FILLER              PIC  X(08).
  4299         16  LA-SOURCE-INFORMATION.
  4300             20  LA-DATA-SOURCE      PIC  X(01).
  4301             20  LA-ADDR-SOURCE      PIC  X(01).
  4302         16  LA-STATUS               PIC  X(01).
  4303             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4304             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4305             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  4306             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4307             88  LA-STATUS-PURGED         VALUE 'P'.
  4308             88  LA-STATUS-VOIDED         VALUE 'V'.
  4309         16  LA-LAST-RESENT-PRINT-DATE
  4310                                     PIC  X(02).
  4311         16  LA-PRINT-RESTRICTION    PIC  X(01).
  4312             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4313                                          VALUE 'C'.
  4314             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  83
* EL689.cbl
  4315                                          VALUE 'F'.
  4316             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4317                                          VALUE 'P'.
  4318         16  LA-PURGED-DATE          PIC  X(02).
  4319         16  LA-VOIDED-DATE          PIC  X(02).
  4320         16  LA-RESEND-LETR          PIC  X(4).
  4321         16  FILLER                  PIC  X(08).
  4322*        16  LA-RESEND-LETR-2        PIC  X(4).
  4323*        16  LA-RESEND-LETR-3        PIC  X(4).
  4324         16  FILLER                  PIC  X(59).
  4325*        16  FILLER                  PIC  X(71).
  4326
  4327******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  84
* EL689.cbl
  4329*    COPY ERCARCT.
  4330******************************************************************
  4331*                                                                *
  4332*                            ERCARCT.                            *
  4333*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4334*                            VMOD=2.002                          *
  4335*                                                                *
  4336*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  4337*                                                                *
  4338*   FILE TYPE = VSAM,KSDS                                        *
  4339*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  4340*                                                                *
  4341*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  4342*                                                                *
  4343*   LOG = NO                                                     *
  4344*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4345******************************************************************
  4346 01  LETTER-ARCHIVE-TEXT.
  4347     12  LT-RECORD-ID                PIC  X(02).
  4348         88  LT-VALID-ID                VALUE 'LA'.
  4349
  4350     12  LT-CONTROL-PRIMARY.
  4351         16  LT-COMPANY-CD           PIC  X(01).
  4352         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  4353         16  LT-RECORD-TYPE          PIC  X(01).
  4354             88  LT-ADDRESS-DATA        VALUE '1'.
  4355             88  LT-TEXT-DATA           VALUE '2'.
  4356         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  4357
  4358     12  FILLER                      PIC  X(28).
  4359     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  4360
  4361     12  LT-TEXT-RECORD.
  4362         16  LT-LETTER-TEXT OCCURS 20 TIMES
  4363                            INDEXED BY LT-NDX.
  4364             20  LT-TEXT-LINE        PIC  X(70).
  4365             20  LT-SKIP-CONTROL     PIC  X(02).
  4366                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  4367                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  4368             20  FILLER              PIC  X(08).
  4369
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  85
* EL689.cbl
  4371*    COPY ELCCERT.
  4372******************************************************************
  4373*                                                                *
  4374*                            ELCCERT.                            *
  4375*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4376*                            VMOD=2.013                          *
  4377*                                                                *
  4378*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4379*                                                                *
  4380*   FILE TYPE = VSAM,KSDS                                        *
  4381*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4382*                                                                *
  4383*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4384*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4385*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4386*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4387*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4388*                                                                *
  4389*   LOG = YES                                                    *
  4390*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4391******************************************************************
  4392*                   C H A N G E   L O G
  4393*
  4394* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4395*-----------------------------------------------------------------
  4396*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4397* EFFECTIVE    NUMBER
  4398*-----------------------------------------------------------------
  4399* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4400* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4401* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4402* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4403* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4404* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4405* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4406******************************************************************
  4407
  4408 01  CERTIFICATE-MASTER.
  4409     12  CM-RECORD-ID                      PIC XX.
  4410         88  VALID-CM-ID                      VALUE 'CM'.
  4411
  4412     12  CM-CONTROL-PRIMARY.
  4413         16  CM-COMPANY-CD                 PIC X.
  4414         16  CM-CARRIER                    PIC X.
  4415         16  CM-GROUPING.
  4416             20  CM-GROUPING-PREFIX        PIC X(3).
  4417             20  CM-GROUPING-PRIME         PIC X(3).
  4418         16  CM-STATE                      PIC XX.
  4419         16  CM-ACCOUNT.
  4420             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4421             20  CM-ACCOUNT-PRIME          PIC X(6).
  4422         16  CM-CERT-EFF-DT                PIC XX.
  4423         16  CM-CERT-NO.
  4424             20  CM-CERT-PRIME             PIC X(10).
  4425             20  CM-CERT-SFX               PIC X.
  4426
  4427     12  CM-CONTROL-BY-NAME.
  4428         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  86
* EL689.cbl
  4429         16  CM-INSURED-LAST-NAME          PIC X(15).
  4430         16  CM-INSURED-INITIALS.
  4431             20  CM-INSURED-INITIAL1       PIC X.
  4432             20  CM-INSURED-INITIAL2       PIC X.
  4433
  4434     12  CM-CONTROL-BY-SSN.
  4435         16  CM-COMPANY-CD-A2              PIC X.
  4436         16  CM-SOC-SEC-NO.
  4437             20  CM-SSN-STATE              PIC XX.
  4438             20  CM-SSN-ACCOUNT            PIC X(6).
  4439             20  CM-SSN-LN3.
  4440                 25  CM-INSURED-INITIALS-A2.
  4441                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4442                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4443                 25 CM-PART-LAST-NAME-A2         PIC X.
  4444
  4445     12  CM-CONTROL-BY-CERT-NO.
  4446         16  CM-COMPANY-CD-A4              PIC X.
  4447         16  CM-CERT-NO-A4                 PIC X(11).
  4448
  4449     12  CM-CONTROL-BY-MEMB.
  4450         16  CM-COMPANY-CD-A5              PIC X.
  4451         16  CM-MEMBER-NO.
  4452             20  CM-MEMB-STATE             PIC XX.
  4453             20  CM-MEMB-ACCOUNT           PIC X(6).
  4454             20  CM-MEMB-LN4.
  4455                 25  CM-INSURED-INITIALS-A5.
  4456                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4457                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4458                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4459
  4460     12  CM-INSURED-PROFILE-DATA.
  4461         16  CM-INSURED-FIRST-NAME.
  4462             20  CM-INSURED-1ST-INIT       PIC X.
  4463             20  FILLER                    PIC X(9).
  4464         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4465         16  CM-INSURED-SEX                PIC X.
  4466             88  CM-SEX-MALE                  VALUE 'M'.
  4467             88  CM-SEX-FEMAL                 VALUE 'F'.
  4468         16  CM-INSURED-JOINT-AGE          PIC 99.
  4469         16  CM-JOINT-INSURED-NAME.
  4470             20  CM-JT-LAST-NAME           PIC X(15).
  4471             20  CM-JT-FIRST-NAME.
  4472                 24  CM-JT-1ST-INIT        PIC X.
  4473                 24  FILLER                PIC X(9).
  4474             20  CM-JT-INITIAL             PIC X.
  4475
  4476     12  CM-LIFE-DATA.
  4477         16  CM-LF-BENEFIT-CD              PIC XX.
  4478         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4479         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4480         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4481         16  CM-LF-DEV-CODE                PIC XXX.
  4482         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4483         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4484         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4485         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4486         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  87
* EL689.cbl
  4487         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4488         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4489         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4490         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4491         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4492         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4493         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4494         16  FILLER                        PIC XX.
  4495
  4496     12  CM-AH-DATA.
  4497         16  CM-AH-BENEFIT-CD              PIC XX.
  4498         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4499         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4500         16  CM-AH-DEV-CODE                PIC XXX.
  4501         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4502         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4503         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4504         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4505         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4506         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4507         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4508         16  CM-AH-PAID-THRU-DT            PIC XX.
  4509             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4510         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4511         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4512         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4513         16  FILLER                        PIC X.
  4514
  4515     12  CM-LOAN-INFORMATION.
  4516         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4517         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4518                                           PIC S9(5)V99  COMP-3.
  4519         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4520         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4521         16  CM-PAY-FREQUENCY              PIC S99.
  4522         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4523         16  CM-RATE-CLASS                 PIC XX.
  4524         16  CM-BENEFICIARY                PIC X(25).
  4525         16  CM-POLICY-FORM-NO             PIC X(12).
  4526         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4527         16  CM-LAST-ADD-ON-DT             PIC XX.
  4528         16  CM-DEDUCTIBLE-AMOUNTS.
  4529             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4530             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4531         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4532             20  CM-RESIDENT-STATE         PIC XX.
  4533             20  CM-RATE-CODE              PIC X(4).
  4534             20  FILLER                    PIC XX.
  4535         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4536             20  CM-LOAN-OFFICER           PIC X(5).
  4537             20  FILLER                    PIC XXX.
  4538         16  CM-CSR-CODE                   PIC XXX.
  4539         16  CM-UNDERWRITING-CODE          PIC X.
  4540             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4541         16  CM-POST-CARD-IND              PIC X.
  4542         16  CM-NH-INTERFACE-SW            PIC X.
  4543         16  CM-PREMIUM-TYPE               PIC X.
  4544             88  CM-SING-PRM                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  88
* EL689.cbl
  4545             88  CM-O-B-COVERAGE              VALUE '2'.
  4546             88  CM-OPEN-END                  VALUE '3'.
  4547         16  CM-IND-GRP-TYPE               PIC X.
  4548             88  CM-INDIVIDUAL                VALUE 'I'.
  4549             88  CM-GROUP                     VALUE 'G'.
  4550         16  CM-SKIP-CODE                  PIC X.
  4551             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4552             88  SKIP-JULY                    VALUE '1'.
  4553             88  SKIP-AUGUST                  VALUE '2'.
  4554             88  SKIP-SEPTEMBER               VALUE '3'.
  4555             88  SKIP-JULY-AUG                VALUE '4'.
  4556             88  SKIP-AUG-SEPT                VALUE '5'.
  4557             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4558             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4559             88  SKIP-JUNE                    VALUE '8'.
  4560             88  SKIP-JUNE-JULY               VALUE '9'.
  4561             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4562             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4563         16  CM-PAYMENT-MODE               PIC X.
  4564             88  PAY-MONTHLY                  VALUE SPACE.
  4565             88  PAY-WEEKLY                   VALUE '1'.
  4566             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4567             88  PAY-BI-WEEKLY                VALUE '3'.
  4568             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4569         16  CM-LOAN-NUMBER                PIC X(8).
  4570         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4571         16  CM-OLD-LOF                    PIC XXX.
  4572*        16  CM-LOAN-OFFICER               PIC XXX.
  4573         16  CM-REIN-TABLE                 PIC XXX.
  4574         16  CM-SPECIAL-REIN-CODE          PIC X.
  4575         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4576         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4577         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4578
  4579     12  CM-STATUS-DATA.
  4580         16  CM-ENTRY-STATUS               PIC X.
  4581         16  CM-ENTRY-DT                   PIC XX.
  4582
  4583         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4584         16  CM-LF-CANCEL-DT               PIC XX.
  4585         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4586
  4587         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4588         16  CM-LF-DEATH-DT                PIC XX.
  4589         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4590
  4591         16  CM-LF-CURRENT-STATUS          PIC X.
  4592             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4593                                                'M' '4' '5' '9'.
  4594             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4595             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4596             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4597             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4598             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4599             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4600             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4601             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4602             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  89
* EL689.cbl
  4603             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4604             88  CM-LF-DECLINED               VALUE 'D'.
  4605             88  CM-LF-VOIDED                 VALUE 'V'.
  4606
  4607         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4608         16  CM-AH-CANCEL-DT               PIC XX.
  4609         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4610
  4611         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4612         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4613         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4614
  4615         16  CM-AH-CURRENT-STATUS          PIC X.
  4616             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4617                                                'M' '4' '5' '9'.
  4618             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4619             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4620             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4621             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4622             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4623             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4624             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4625             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4626             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4627             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4628             88  CM-AH-DECLINED               VALUE 'D'.
  4629             88  CM-AH-VOIDED                 VALUE 'V'.
  4630
  4631         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4632             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4633             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4634             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4635         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4636
  4637         16  CM-ENTRY-BATCH                PIC X(6).
  4638         16  CM-LF-EXIT-BATCH              PIC X(6).
  4639         16  CM-AH-EXIT-BATCH              PIC X(6).
  4640         16  CM-LAST-MONTH-END             PIC XX.
  4641
  4642     12  CM-NOTE-SW                        PIC X.
  4643         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4644         88  CERT-NOTES-PRESENT               VALUE '1'.
  4645         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4646         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4647         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4648         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4649         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4650         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4651     12  CM-COMP-EXCP-SW                   PIC X.
  4652         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4653         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4654     12  CM-INSURED-ADDRESS-SW             PIC X.
  4655         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4656         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4657
  4658*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4659     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4660     12  FILLER                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  90
* EL689.cbl
  4661
  4662*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4663     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4664     12  FILLER                            PIC X.
  4665*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4666     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4667
  4668     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4669         88  CERT-ADDED-BATCH                 VALUE ' '.
  4670         88  CERT-ADDED-ONLINE                VALUE '1'.
  4671         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4672         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4673         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4674     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4675         88  CERT-AS-LOADED                   VALUE ' '.
  4676         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4677         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4678         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4679         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4680         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4681         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4682         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4683
  4684     12  CM-ACCOUNT-COMM-PCTS.
  4685         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4686         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4687
  4688     12  CM-USER-FIELD                     PIC X.
  4689     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4690     12  CM-CLP-STATE                      PIC XX.
  4691     12  CM-USER-RESERVED                  PIC XXX.
  4692******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  91
* EL689.cbl
  4694*    COPY ERCCHEK.
  4695******************************************************************
  4696*                                                                *
  4697*                                                                *
  4698*                            ERCCHEK                             *
  4699*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4700*                            VMOD=2.008                          *
  4701*                                                                *
  4702*   FILE DESCRIPTION = CHECK RECORDS                             *
  4703*                                                                *
  4704*   FILE TYPE = VSAM,KSDS                                        *
  4705*   RECORD SIZE = 600    RECFORM = FIXED                         *
  4706*                                                                *
  4707*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  4708*       ALTERNATE INDEX = NONE                                   *
  4709*                                                                *
  4710*   LOG = YES                                                    *
  4711*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4712******************************************************************
  4713 01  CHECK-RECORDS.
  4714     12  CH-RECORD-ID                      PIC XX.
  4715         88  VALID-CH-ID                      VALUE 'CH'.
  4716
  4717     12  CH-CONTROL-PRIMARY.
  4718         16  CH-COMPANY-CD                 PIC X.
  4719         16  CH-CARRIER                    PIC X.
  4720         16  CH-GROUPING                   PIC X(6).
  4721         16  CH-STATE                      PIC XX.
  4722         16  CH-ACCOUNT                    PIC X(10).
  4723         16  CH-CERT-EFF-DT                PIC XX.
  4724         16  CH-CERT-NO.
  4725             20  CH-CERT-PRIME             PIC X(10).
  4726             20  CH-CERT-SFX               PIC X.
  4727         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  4728
  4729     12  CH-RECORDED-DT                    PIC XX.
  4730     12  CH-RECORDED-BY                    PIC X(4).
  4731     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  4732
  4733     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  4734     12  CH-CHECK-NO                       PIC X(7).
  4735     12  CH-REASON-FOR-CHECK               PIC X(25).
  4736     12  CH-CHECK-WRITTEN-DT               PIC XX.
  4737     12  CH-OFFLINE-CHECK-IND              PIC X.
  4738         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  4739
  4740     12  CH-PAYEE-INFO.
  4741         16  CH-PAYEE-NAME-1               PIC X(30).
  4742         16  CH-PAYEE-NAME-2               PIC X(30).
  4743         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  4744         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  4745         16  CH-PAYEE-CITY-ST              PIC X(30).
  4746         16  CH-PAYEE-ZIP-CODE.
  4747             20  CH-PAYEE-ZIP.
  4748                 24  CH-ZIP-PRI-1ST        PIC X.
  4749                     88  CH-CANADIAN-POST-CODE
  4750                                           VALUES 'A' THRU 'Z'.
  4751                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  92
* EL689.cbl
  4752             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  4753         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  4754             20  CH-CAN-POSTAL-1           PIC XXX.
  4755             20  CH-CAN-POSTAL-2           PIC XXX.
  4756             20  FILLER                    PIC XXX.
  4757
  4758     12  CH-CHECK-STUB-TEXT.
  4759         16  CH-STUB-LINE-1                PIC X(50).
  4760         16  CH-STUB-LINE-2                PIC X(50).
  4761         16  CH-STUB-LINE-3                PIC X(50).
  4762         16  FILLER.
  4763           18  CH-STUB-LINE-4              PIC X(20).
  4764           18  CH-LIENHOLDER-NAME          PIC X(30).
  4765
  4766     12  CH-COMPENSATION-CONTROL.
  4767         16  CH-COMP-CARRIER               PIC X.
  4768         16  CH-COMP-GROUPING              PIC X(6).
  4769         16  CH-COMP-FIN-RESP              PIC X(10).
  4770         16  CH-COMP-ACCOUNT               PIC X(10).
  4771
  4772     12  CH-CREDIT-SELECT-DT               PIC XX.
  4773     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  4774     12  CH-PAYEE-CODE                     PIC X(6).
  4775
  4776     12  CH-VOID-DATA.
  4777         20  CH-VOID-DT                    PIC XX.
  4778         20  CH-VOID-BY                    PIC X(4).
  4779         20  CH-VOID-REASON                PIC X(25).
  4780
  4781     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  4782             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  4783     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  4784
  4785     12  CH-CHECK-REFERENCE                PIC X(12).
  4786     12  CH-CHECK-ORIGIN-SW                PIC X.
  4787             88  CH-REFUND-CHECK              VALUE 'R'.
  4788             88  CH-MAINT-CHECK               VALUE 'M'.
  4789
  4790     12  CH-CANC-DT                        PIC XX.
  4791     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  4792     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  4793
  4794     12  CH-INSURED-NAME                   PIC X(28).
  4795
  4796     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  4797     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  4798
  4799     12  CH-LETTER-TABLE.
  4800         16  CH-LETTERS OCCURS 3 TIMES
  4801                        INDEXED BY CH-LT-NDX
  4802                                           PIC X(04).
  4803
  4804     12  FILLER                            PIC X(07).
  4805
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  93
* EL689.cbl
  4807*    COPY ELCCNTL.
  4808******************************************************************
  4809*                                                                *
  4810*                                                                *
  4811*                            ELCCNTL.                            *
  4812*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4813*                            VMOD=2.059                          *
  4814*                                                                *
  4815*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4816*                                                                *
  4817*   FILE TYPE = VSAM,KSDS                                        *
  4818*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4819*                                                                *
  4820*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4821*       ALTERNATE INDEX = NONE                                   *
  4822*                                                                *
  4823*   LOG = YES                                                    *
  4824*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4825******************************************************************
  4826*                   C H A N G E   L O G
  4827*
  4828* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4829*-----------------------------------------------------------------
  4830*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4831* EFFECTIVE    NUMBER
  4832*-----------------------------------------------------------------
  4833* 082503                   PEMA  ADD BENEFIT GROUP
  4834* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4835* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4836* 092705    2005050300006  PEMA  ADD SPP LEASES
  4837* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4838* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4839* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4840* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4841* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4842******************************************************************
  4843*
  4844 01  CONTROL-FILE.
  4845     12  CF-RECORD-ID                       PIC XX.
  4846         88  VALID-CF-ID                        VALUE 'CF'.
  4847
  4848     12  CF-CONTROL-PRIMARY.
  4849         16  CF-COMPANY-ID                  PIC XXX.
  4850         16  CF-RECORD-TYPE                 PIC X.
  4851             88  CF-COMPANY-MASTER              VALUE '1'.
  4852             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4853             88  CF-STATE-MASTER                VALUE '3'.
  4854             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4855             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4856             88  CF-CARRIER-MASTER              VALUE '6'.
  4857             88  CF-MORTALITY-MASTER            VALUE '7'.
  4858             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4859             88  CF-TERMINAL-MASTER             VALUE '9'.
  4860             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4861             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4862             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4863             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4864             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  94
* EL689.cbl
  4865             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4866             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4867             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4868             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4869         16  CF-ACCESS-CD-GENL              PIC X(4).
  4870         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4871             20  CF-PROCESSOR               PIC X(4).
  4872         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4873             20  CF-STATE-CODE              PIC XX.
  4874             20  FILLER                     PIC XX.
  4875         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4876             20  FILLER                     PIC XX.
  4877             20  CF-HI-BEN-IN-REC           PIC XX.
  4878         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4879             20  FILLER                     PIC XXX.
  4880             20  CF-CARRIER-CNTL            PIC X.
  4881         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4882             20  FILLER                     PIC XX.
  4883             20  CF-HI-TYPE-IN-REC          PIC 99.
  4884         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4885             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4886                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4887             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4888             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4889         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4890             20  FILLER                     PIC X.
  4891             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4892         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4893             20  FILLER                     PIC XX.
  4894             20  CF-MORTGAGE-PLAN           PIC XX.
  4895         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4896
  4897     12  CF-LAST-MAINT-DT                   PIC XX.
  4898     12  CF-LAST-MAINT-BY                   PIC X(4).
  4899     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4900
  4901     12  CF-RECORD-BODY                     PIC X(728).
  4902
  4903
  4904****************************************************************
  4905*             COMPANY MASTER RECORD                            *
  4906****************************************************************
  4907
  4908     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4909         16  CF-COMPANY-ADDRESS.
  4910             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4911             20  CF-CL-IN-CARE-OF           PIC X(30).
  4912             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4913             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4914             20  CF-CL-CITY-STATE           PIC X(30).
  4915             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4916             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4917         16  CF-COMPANY-CD                  PIC X.
  4918         16  CF-COMPANY-PASSWORD            PIC X(8).
  4919         16  CF-SECURITY-OPTION             PIC X.
  4920             88  ALL-SECURITY                   VALUE '1'.
  4921             88  COMPANY-VERIFY                 VALUE '2'.
  4922             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  95
* EL689.cbl
  4923             88  NO-SECURITY                    VALUE '4'.
  4924             88  ALL-BUT-TERM                   VALUE '5'.
  4925         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4926             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4927         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4928             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4929         16  CF-INFORCE-LOCATION            PIC X.
  4930             88  CERTS-ARE-ONLINE               VALUE '1'.
  4931             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4932             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4933         16  CF-LOWER-CASE-LETTERS          PIC X.
  4934         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4935             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4936             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4937             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4938             88  CF-ACCNT-CNTL                  VALUE '3'.
  4939             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4940
  4941         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4942         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4943
  4944         16  CF-LGX-CREDIT-USER             PIC X.
  4945             88  CO-IS-NOT-USER                 VALUE 'N'.
  4946             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4947
  4948         16 CF-CREDIT-CALC-CODES.
  4949             20  CF-CR-REM-TERM-CALC PIC X.
  4950               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4951               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4952               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4953               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4954               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4955               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4956               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4957             20  CF-CR-R78-METHOD           PIC X.
  4958               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4959               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4960
  4961         16  CF-CLAIM-CONTROL-COUNTS.
  4962             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4963                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4964
  4965             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4966                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4967
  4968             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4969                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4970
  4971             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4972                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4973
  4974         16  CF-CURRENT-MONTH-END           PIC XX.
  4975
  4976         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4977             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4978             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4979             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4980             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  96
* EL689.cbl
  4981                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4982                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4983             20  CF-CO-PREM-REJECT-SW       PIC X.
  4984                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4985                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4986             20  CF-CO-REF-REJECT-SW        PIC X.
  4987                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4988                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4989
  4990         16  CF-CO-REPORTING-DT             PIC XX.
  4991         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4992         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4993           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4994           88  CF-CO-MONTH-END                  VALUE '1'.
  4995
  4996         16  CF-LGX-CLAIM-USER              PIC X.
  4997             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4998             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4999
  5000         16  CF-CREDIT-EDIT-CONTROLS.
  5001             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5002             20  CF-MIN-AGE                 PIC 99.
  5003             20  CF-DEFAULT-AGE             PIC 99.
  5004             20  CF-MIN-TERM                PIC S999      COMP-3.
  5005             20  CF-MAX-TERM                PIC S999      COMP-3.
  5006             20  CF-DEFAULT-SEX             PIC X.
  5007             20  CF-JOINT-AGE-INPUT         PIC X.
  5008                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5009             20  CF-BIRTH-DATE-INPUT        PIC X.
  5010                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5011             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5012                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5013                 88  CF-ZERO-CARRIER            VALUE '1'.
  5014                 88  CF-ZERO-GROUPING           VALUE '2'.
  5015                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5016             20  CF-EDIT-SW                 PIC X.
  5017                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5018             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5019             20  CF-CR-PR-METHOD            PIC X.
  5020               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5021               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5022             20  FILLER                     PIC X.
  5023
  5024         16  CF-CREDIT-MISC-CONTROLS.
  5025             20  CF-REIN-TABLE-SW           PIC X.
  5026                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5027             20  CF-COMP-TABLE-SW           PIC X.
  5028                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5029             20  CF-EXPERIENCE-RETENTION-AGE
  5030                                            PIC S9        COMP-3.
  5031             20  CF-CONVERSION-DT           PIC XX.
  5032             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  5033             20  CF-RUN-FREQUENCY-SW        PIC X.
  5034                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5035                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5036
  5037             20  CF-CR-CHECK-NO-CONTROL.
  5038                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  97
* EL689.cbl
  5039                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5040                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5041                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5042                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5043                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5044
  5045                 24  CF-CR-CHECK-COUNT       REDEFINES
  5046                     CF-CR-CHECK-COUNTER      PIC X(4).
  5047
  5048                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5049                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5050
  5051                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5052                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5053                 24  CF-MAIL-PROCESSING       PIC X.
  5054                     88  MAIL-PROCESSING          VALUE 'Y'.
  5055
  5056         16  CF-MISC-SYSTEM-CONTROL.
  5057             20  CF-SYSTEM-C                 PIC X.
  5058                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5059             20  CF-SYSTEM-D                 PIC X.
  5060                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5061             20  CF-SOC-SEC-NO-SW            PIC X.
  5062                 88  SOC-SEC-NO-USED             VALUE '1'.
  5063             20  CF-MEMBER-NO-SW             PIC X.
  5064                 88  MEMBER-NO-USED              VALUE '1'.
  5065             20  CF-TAX-ID-NUMBER            PIC X(11).
  5066             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5067             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5068                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5069                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5070                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5071                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5072             20  CF-SYSTEM-E                 PIC X.
  5073                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5074
  5075         16  CF-LGX-LIFE-USER               PIC X.
  5076             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5077             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5078
  5079         16  CF-CR-MONTH-END-DT             PIC XX.
  5080
  5081         16  CF-FILE-MAINT-DATES.
  5082             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5083                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5084             20  CF-LAST-BATCH       REDEFINES
  5085                 CF-LAST-BATCH-NO               PIC X(4).
  5086             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5087             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5088             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5089             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5090             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  5091             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5092             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5093             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5094             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5095             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5096
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  98
* EL689.cbl
  5097         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5098         16  FILLER                         PIC X.
  5099
  5100         16  CF-ALT-MORT-CODE               PIC X(4).
  5101         16  CF-MEMBER-CAPTION              PIC X(10).
  5102
  5103         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5104             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5105             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5106             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5107             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5108             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5109
  5110         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5111
  5112         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5113         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5114         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5115         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5116
  5117         16  CF-AH-OVERRIDE-L1              PIC X.
  5118         16  CF-AH-OVERRIDE-L2              PIC XX.
  5119         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5120         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5121
  5122         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5123         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5124
  5125         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5126         16  CF-AR-LAST-EL860-DT            PIC XX.
  5127         16  CF-MP-MONTH-END-DT             PIC XX.
  5128
  5129         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5130         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5131             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5132
  5133         16  CF-AR-MONTH-END-DT             PIC XX.
  5134
  5135         16  CF-CRDTCRD-USER                PIC X.
  5136             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5137             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5138
  5139         16  CF-CC-MONTH-END-DT             PIC XX.
  5140
  5141         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5142
  5143         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5144             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5145             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5146             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5147         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5148         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  5149         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5150         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5151             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5152             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5153         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5154         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page  99
* EL689.cbl
  5155         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5156             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5157         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5158
  5159         16  CF-CL-ZIP-CODE.
  5160             20  CF-CL-ZIP-PRIME.
  5161                 24  CF-CL-ZIP-1ST          PIC X.
  5162                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5163                 24  FILLER                 PIC X(4).
  5164             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5165         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5166             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5167             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5168             20  FILLER                     PIC XXX.
  5169
  5170         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5171         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5172         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5173         16  CF-CO-OPTION-START-DATE        PIC XX.
  5174         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5175           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5176                                                      '3' '4'.
  5177           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5178           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5179           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5180           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5181           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5182           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5183
  5184         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5185
  5186         16  CF-PAYMENT-APPROVAL-LEVELS.
  5187             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5188             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5189             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5190             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5191             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5192             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5193
  5194         16  CF-END-USER-REPORTING-USER     PIC X.
  5195             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5196             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5197
  5198         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5199             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5200             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5201
  5202         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5203
  5204         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5205         16  FILLER                         PIC X.
  5206
  5207         16  CF-CREDIT-ARCHIVE-CNTL.
  5208             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5209             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5210             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5211
  5212         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 100
* EL689.cbl
  5213
  5214         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5215             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5216             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5217
  5218         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5219             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5220             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5221
  5222         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5223
  5224         16  CF-CO-ACH-ID-CODE              PIC  X.
  5225             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5226             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5227             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5228         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5229         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5230         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5231         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5232         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5233         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5234         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5235         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5236         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5237                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5238         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5239                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5240
  5241         16  CF-CO-OVER-SHORT.
  5242             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5243             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5244
  5245*         16  FILLER                         PIC X(102).
  5246         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5247             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5248             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5249
  5250         16  CF-AH-APPROVAL-DAYS.
  5251             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5252             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5253             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5254             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5255
  5256         16  FILLER                         PIC X(82).
  5257****************************************************************
  5258*             PROCESSOR/USER RECORD                            *
  5259****************************************************************
  5260
  5261     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5262         16  CF-PROCESSOR-NAME              PIC X(30).
  5263         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5264         16  CF-PROCESSOR-TITLE             PIC X(26).
  5265         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5266                 88  MESSAGE-YES                VALUE 'Y'.
  5267                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5268
  5269*****************************************************
  5270****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 101
* EL689.cbl
  5271****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5272****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5273****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5274*****************************************************
  5275
  5276         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5277             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5278             20  CF-APPLICATION-FORCE       PIC X.
  5279             20  CF-INDIVIDUAL-APP.
  5280                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5281                     28  CF-BROWSE-APP      PIC X.
  5282                     28  CF-UPDATE-APP      PIC X.
  5283
  5284         16  CF-CURRENT-TERM-ON             PIC X(4).
  5285         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5286             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5287             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5288             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5289             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5290             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5291             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5292             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5293         16  CF-PROCESSOR-CARRIER           PIC X.
  5294             88  NO-CARRIER-SECURITY            VALUE ' '.
  5295         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5296             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5297         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5298             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5299         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5300             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5301
  5302         16  CF-PROC-SYS-ACCESS-SW.
  5303             20  CF-PROC-CREDIT-CLAIMS-SW.
  5304                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5305                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5306                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5307                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5308             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5309                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5310                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5311             20  CF-PROC-LIFE-GNRLDGR-SW.
  5312                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5313                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5314                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5315                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  5316             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5317                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5318                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5319         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5320             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5321             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5322         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5323
  5324         16  CF-APPROVAL-LEVEL                  PIC X.
  5325             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5326             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5327             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5328             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 102
* EL689.cbl
  5329
  5330         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5331
  5332         16  CF-LANGUAGE-TYPE                   PIC X.
  5333             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5334             88  CF-LANG-IS-FR                      VALUE 'F'.
  5335         16  FILLER                             PIC  X(240).
  5336
  5337****************************************************************
  5338*             PROCESSOR/REMINDERS RECORD                       *
  5339****************************************************************
  5340
  5341     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5342         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5343             20  CF-START-REMIND-DT         PIC XX.
  5344             20  CF-END-REMIND-DT           PIC XX.
  5345             20  CF-REMINDER-TEXT           PIC X(50).
  5346         16  FILLER                         PIC X(296).
  5347
  5348
  5349****************************************************************
  5350*             STATE MASTER RECORD                              *
  5351****************************************************************
  5352
  5353     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5354         16  CF-STATE-ABBREVIATION          PIC XX.
  5355         16  CF-STATE-NAME                  PIC X(25).
  5356         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5357         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5358             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5359             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5360             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5361             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5362                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5363                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5364             20  CF-ST-PREM-REJECT-SW       PIC X.
  5365                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5366                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5367             20  CF-ST-REF-REJECT-SW        PIC X.
  5368                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5369                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5370         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  5371         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5372         16  CF-ST-REFUND-RULES.
  5373             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5374             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5375             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5376         16  CF-ST-FST-PMT-EXTENSION.
  5377             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5378             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5379                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5380                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5381                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5382                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5383         16  CF-ST-STATE-CALL.
  5384             20  CF-ST-CALL-UNEARNED        PIC X.
  5385             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5386             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 103
* EL689.cbl
  5387         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5388             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5389             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5390         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5391         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5392         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5393         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5394         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5395         16  FILLER                         PIC X.
  5396         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5397             20  CF-ST-BENEFIT-CD           PIC XX.
  5398             20  CF-ST-BENEFIT-KIND         PIC X.
  5399                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5400                 88  CF-ST-AH-KIND              VALUE 'A'.
  5401             20  CF-ST-REM-TERM-CALC        PIC X.
  5402                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5403                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5404                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5405                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5406                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5407                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5408                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5409                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5410
  5411             20  CF-ST-REFUND-CALC          PIC X.
  5412                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5413                 88  ST-REFD-BY-R78             VALUE '1'.
  5414                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5415                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5416                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5417                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5418                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5419                 88  ST-REFD-UTAH               VALUE '7'.
  5420                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5421                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5422                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5423
  5424             20  CF-ST-EARNING-CALC         PIC X.
  5425                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5426                 88  ST-EARN-BY-R78             VALUE '1'.
  5427                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5428                 88  ST-EARN-AS-CALIF           VALUE '3'.
  5429                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5430                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5431                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5432                 88  ST-EARN-MEAN               VALUE '8'.
  5433                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5434
  5435             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5436                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5437                 88  ST-OVRD-BY-R78             VALUE '1'.
  5438                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5439                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5440                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5441                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5442                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5443                 88  ST-OVRD-MEAN               VALUE '8'.
  5444                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 104
* EL689.cbl
  5445             20  FILLER                     PIC X.
  5446
  5447         16  CF-ST-COMMISSION-CAPS.
  5448             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5449             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5450             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5451             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5452         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5453                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5454
  5455         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5456
  5457         16  CF-ST-STATUTORY-INTEREST.
  5458             20  CF-ST-STAT-DATE-FROM       PIC X.
  5459                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5460                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5461             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5462             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5463             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5464             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5465             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5466
  5467         16  CF-ST-OVER-SHORT.
  5468             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5469             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5470
  5471         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5472
  5473         16  CF-ST-RT-CALC                  PIC X.
  5474
  5475         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5476         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5477         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5478         16  CF-ST-RF-LR-CALC               PIC X.
  5479         16  CF-ST-RF-LL-CALC               PIC X.
  5480         16  CF-ST-RF-LN-CALC               PIC X.
  5481         16  CF-ST-RF-AH-CALC               PIC X.
  5482         16  CF-ST-RF-CP-CALC               PIC X.
  5483*        16  FILLER                         PIC X(206).
  5484*CIDMOD         16  FILLER                         PIC X(192).
  5485         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5486             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5487         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5488         16  CF-ST-VFY-2ND-BENE             PIC X.
  5489         16  FILLER                         PIC X(186).
  5490
  5491****************************************************************
  5492*             BENEFIT MASTER RECORD                            *
  5493****************************************************************
  5494
  5495     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5496         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  5497             20  CF-BENEFIT-CODE            PIC XX.
  5498             20  CF-BENEFIT-NUMERIC  REDEFINES
  5499                 CF-BENEFIT-CODE            PIC XX.
  5500             20  CF-BENEFIT-ALPHA           PIC XXX.
  5501             20  CF-BENEFIT-DESCRIP         PIC X(10).
  5502             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 105
* EL689.cbl
  5503
  5504             20  CF-LF-COVERAGE-TYPE        PIC X.
  5505                 88  CF-REDUCING                VALUE 'R'.
  5506                 88  CF-LEVEL                   VALUE 'L' 'P'.
  5507
  5508             20  CF-SPECIAL-CALC-CD         PIC X.
  5509                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  5510                 88  CF-NP-0-MO-INT             VALUE 'A'.
  5511                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  5512                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  5513                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  5514                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  5515                 88  CF-FARM-PLAN               VALUE 'F'.
  5516                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  5517                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  5518                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  5519                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  5520                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  5521                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  5522                 88  CF-PRUDENTIAL              VALUE 'P'.
  5523                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  5524                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  5525                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  5526                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  5527                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  5528                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  5529
  5530             20  CF-JOINT-INDICATOR         PIC X.
  5531                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  5532
  5533*            20  FILLER                     PIC X(12).
  5534             20  FILLER                     PIC X(11).
  5535             20  CF-BENEFIT-CATEGORY        PIC X.
  5536             20  CF-LOAN-TYPE               PIC X(8).
  5537
  5538             20  CF-CO-REM-TERM-CALC        PIC X.
  5539                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  5540                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  5541                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  5542                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  5543                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  5544
  5545             20  CF-CO-EARNINGS-CALC        PIC X.
  5546                 88  CO-EARN-BY-R78             VALUE '1'.
  5547                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  5548                 88  CO-EARN-AS-CALIF           VALUE '3'.
  5549                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  5550                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  5551                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  5552                 88  CO-EARN-AS-MEAN            VALUE '8'.
  5553                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  5554
  5555             20  CF-CO-REFUND-CALC          PIC X.
  5556                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  5557                 88  CO-REFD-BY-R78             VALUE '1'.
  5558                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  5559                 88  CO-REFD-AS-CALIF           VALUE '3'.
  5560                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 106
* EL689.cbl
  5561                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  5562                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  5563                 88  CO-REFD-MEAN               VALUE '8'.
  5564                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  5565                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  5566                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  5567
  5568             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  5569                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  5570                 88  CO-OVRD-BY-R78             VALUE '1'.
  5571                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  5572                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  5573                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  5574                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  5575                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  5576                 88  CO-OVRD-MEAN               VALUE '8'.
  5577                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  5578
  5579             20  CF-CO-BEN-I-G-CD           PIC X.
  5580                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  5581                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  5582                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  5583
  5584         16  FILLER                         PIC X(304).
  5585
  5586
  5587****************************************************************
  5588*             CARRIER MASTER RECORD                            *
  5589****************************************************************
  5590
  5591     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5592         16  CF-ADDRESS-DATA.
  5593             20  CF-MAIL-TO-NAME            PIC X(30).
  5594             20  CF-IN-CARE-OF              PIC X(30).
  5595             20  CF-ADDRESS-LINE-1          PIC X(30).
  5596             20  CF-ADDRESS-LINE-2          PIC X(30).
  5597             20  CF-CITY-STATE              PIC X(30).
  5598             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  5599             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  5600
  5601         16  CF-CLAIM-NO-CONTROL.
  5602             20  CF-CLAIM-NO-METHOD         PIC X.
  5603                 88  CLAIM-NO-MANUAL            VALUE '1'.
  5604                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  5605                 88  CLAIM-NO-SEQ               VALUE '3'.
  5606                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  5607             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  5608                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  5609                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  5610                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  5611
  5612         16  CF-CHECK-NO-CONTROL.
  5613             20  CF-CHECK-NO-METHOD         PIC X.
  5614                 88  CHECK-NO-MANUAL            VALUE '1'.
  5615                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  5616                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  5617                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  5618             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 107
* EL689.cbl
  5619                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  5620
  5621         16  CF-DOMICILE-STATE              PIC XX.
  5622
  5623         16  CF-EXPENSE-CONTROLS.
  5624             20  CF-EXPENSE-METHOD          PIC X.
  5625                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  5626                 88  DOLLARS-PER-PMT            VALUE '2'.
  5627                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  5628                 88  DOLLARS-PER-MONTH          VALUE '4'.
  5629             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  5630             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  5631
  5632         16  CF-CORRESPONDENCE-CONTROL.
  5633             20  CF-LETTER-RESEND-OPT       PIC X.
  5634                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  5635                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  5636             20  FILLER                     PIC X(4).
  5637
  5638         16  CF-RESERVE-CONTROLS.
  5639             20  CF-MANUAL-SW               PIC X.
  5640                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  5641             20  CF-FUTURE-SW               PIC X.
  5642                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  5643             20  CF-PTC-SW                  PIC X.
  5644                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  5645             20  CF-IBNR-SW                 PIC X.
  5646                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  5647             20  CF-PTC-LF-SW               PIC X.
  5648                 88  CF-LF-PTC-USED             VALUE '1'.
  5649             20  CF-CDT-ACCESS-METHOD       PIC X.
  5650                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  5651                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  5652                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  5653             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  5654
  5655         16  CF-CLAIM-CALC-METHOD           PIC X.
  5656             88  360-PLUS-MONTHS                VALUE '1'.
  5657             88  365-PLUS-MONTHS                VALUE '2'.
  5658             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  5659             88  360-DAILY                      VALUE '4'.
  5660             88  365-DAILY                      VALUE '5'.
  5661
  5662         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  5663         16  FILLER                         PIC X(11).
  5664
  5665         16  CF-LIMIT-AMOUNTS.
  5666             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  5667             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  5668             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  5669             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  5670             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  5671             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  5672             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  5673             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  5674             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  5675             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  5676
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 108
* EL689.cbl
  5677         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  5678         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  5679         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  5680
  5681         16  CF-ZIP-CODE.
  5682             20  CF-ZIP-PRIME.
  5683                 24  CF-ZIP-1ST             PIC X.
  5684                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5685                 24  FILLER                 PIC X(4).
  5686             20  CF-ZIP-PLUS4               PIC X(4).
  5687         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  5688             20  CF-CAN-POSTAL-1            PIC XXX.
  5689             20  CF-CAN-POSTAL-2            PIC XXX.
  5690             20  FILLER                     PIC XXX.
  5691
  5692         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  5693         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  5694         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  5695
  5696         16  CF-RATING-SWITCH               PIC X.
  5697             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  5698             88  CF-NO-RATING                   VALUE 'N'.
  5699
  5700         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5701
  5702         16  CF-CARRIER-OVER-SHORT.
  5703             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5704             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5705
  5706         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5707         16  CF-SECPAY-SWITCH               PIC X.
  5708             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5709             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5710         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  5711         16  FILLER                         PIC X(448).
  5712*        16  FILLER                         PIC X(452).
  5713
  5714
  5715****************************************************************
  5716*             MORTALITY MASTER RECORD                          *
  5717****************************************************************
  5718
  5719     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5720         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5721                                INDEXED BY CF-MORT-NDX.
  5722             20  CF-MORT-TABLE              PIC X(5).
  5723             20  CF-MORT-TABLE-TYPE         PIC X.
  5724                 88  CF-MORT-JOINT              VALUE 'J'.
  5725                 88  CF-MORT-SINGLE             VALUE 'S'.
  5726                 88  CF-MORT-COMBINED           VALUE 'C'.
  5727                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5728                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5729             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5730             20  CF-MORT-AGE-METHOD         PIC XX.
  5731                 88  CF-AGE-LAST                VALUE 'AL'.
  5732                 88  CF-AGE-NEAR                VALUE 'AN'.
  5733             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5734             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 109
* EL689.cbl
  5735                                            PIC X.
  5736                 88  CF-MINUS                   VALUE '-'.
  5737                 88  CF-PLUS                    VALUE '+'.
  5738             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5739             20  CF-MORT-JOINT-CODE         PIC X.
  5740                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5741             20  CF-MORT-PC-Q               PIC X.
  5742                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5743             20  CF-MORT-TABLE-CODE         PIC X(4).
  5744             20  CF-MORT-COMMENTS           PIC X(15).
  5745             20  FILLER                     PIC X(14).
  5746
  5747         16  FILLER                         PIC X(251).
  5748
  5749
  5750****************************************************************
  5751*             BUSSINESS TYPE MASTER RECORD                     *
  5752****************************************************************
  5753
  5754     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5755* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5756* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5757* AND RECORD 05 IS TYPES 81-99
  5758         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5759             20  CF-BUSINESS-TITLE          PIC  X(19).
  5760             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5761                                            PIC S9V9(4) COMP-3.
  5762             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5763             20  FILLER                     PIC  X.
  5764         16  FILLER                         PIC  X(248).
  5765
  5766
  5767****************************************************************
  5768*             TERMINAL MASTER RECORD                           *
  5769****************************************************************
  5770
  5771     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5772
  5773         16  CF-COMPANY-TERMINALS.
  5774             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5775                                  PIC X(4).
  5776         16  FILLER               PIC X(248).
  5777
  5778
  5779****************************************************************
  5780*             LIFE EDIT MASTER RECORD                          *
  5781****************************************************************
  5782
  5783     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5784         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5785             20  CF-LIFE-CODE-IN            PIC XX.
  5786             20  CF-LIFE-CODE-OUT           PIC XX.
  5787         16  FILLER                         PIC X(248).
  5788
  5789
  5790****************************************************************
  5791*             AH EDIT MASTER RECORD                            *
  5792****************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 110
* EL689.cbl
  5793
  5794     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5795         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5796             20  CF-AH-CODE-IN              PIC XXX.
  5797             20  CF-AH-CODE-OUT             PIC XX.
  5798         16  FILLER                         PIC X(248).
  5799
  5800
  5801****************************************************************
  5802*             CREDIBILITY TABLES                               *
  5803****************************************************************
  5804
  5805     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5806         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5807                             INDEXED BY CF-CRDB-NDX.
  5808             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5809             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5810             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5811         16  FILLER                         PIC  X(332).
  5812
  5813
  5814****************************************************************
  5815*             REPORT CUSTOMIZATION RECORD                      *
  5816****************************************************************
  5817
  5818     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5819         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5820             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5821             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5822             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5823**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5824****       A T-TRANSFER.                                   ****
  5825             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  5826
  5827         16  FILLER                         PIC XX.
  5828
  5829         16  CF-CARRIER-CNTL-OPT.
  5830             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5831                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5832                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5833             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5834                                            PIC X.
  5835         16  CF-GROUP-CNTL-OPT.
  5836             20  CF-GROUP-OPT-SEQ           PIC 9.
  5837                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5838                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5839             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5840                                            PIC X(6).
  5841         16  CF-STATE-CNTL-OPT.
  5842             20  CF-STATE-OPT-SEQ           PIC 9.
  5843                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5844                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5845             20  CF-STATE-SELECT OCCURS 3 TIMES
  5846                                            PIC XX.
  5847         16  CF-ACCOUNT-CNTL-OPT.
  5848             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5849                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5850                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 111
* EL689.cbl
  5851             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5852                                            PIC X(10).
  5853         16  CF-BUS-TYP-CNTL-OPT.
  5854             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5855                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5856                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5857             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5858                                            PIC XX.
  5859         16  CF-LF-TYP-CNTL-OPT.
  5860             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5861                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5862                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5863             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5864                                            PIC XX.
  5865         16  CF-AH-TYP-CNTL-OPT.
  5866             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5867                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5868                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5869             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5870                                            PIC XX.
  5871         16  CF-REPTCD1-CNTL-OPT.
  5872             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5873                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5874                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5875             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5876                                            PIC X(10).
  5877         16  CF-REPTCD2-CNTL-OPT.
  5878             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5879                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5880                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5881             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5882                                            PIC X(10).
  5883         16  CF-USER1-CNTL-OPT.
  5884             20  CF-USER1-OPT-SEQ           PIC 9.
  5885                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5886                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5887             20  CF-USER1-SELECT OCCURS 3 TIMES
  5888                                            PIC X(10).
  5889         16  CF-USER2-CNTL-OPT.
  5890             20  CF-USER2-OPT-SEQ           PIC 9.
  5891                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5892                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5893             20  CF-USER2-SELECT OCCURS 3 TIMES
  5894                                            PIC X(10).
  5895         16  CF-USER3-CNTL-OPT.
  5896             20  CF-USER3-OPT-SEQ           PIC 9.
  5897                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5898                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5899             20  CF-USER3-SELECT OCCURS 3 TIMES
  5900                                            PIC X(10).
  5901         16  CF-USER4-CNTL-OPT.
  5902             20  CF-USER4-OPT-SEQ           PIC 9.
  5903                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5904                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5905             20  CF-USER4-SELECT OCCURS 3 TIMES
  5906                                            PIC X(10).
  5907         16  CF-USER5-CNTL-OPT.
  5908             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 112
* EL689.cbl
  5909                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5910                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5911             20  CF-USER5-SELECT OCCURS 3 TIMES
  5912                                            PIC X(10).
  5913         16  CF-REINS-CNTL-OPT.
  5914             20  CF-REINS-OPT-SEQ           PIC 9.
  5915                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5916                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5917             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5918                 24  CF-REINS-PRIME         PIC XXX.
  5919                 24  CF-REINS-SUB           PIC XXX.
  5920
  5921         16  CF-AGENT-CNTL-OPT.
  5922             20  CF-AGENT-OPT-SEQ           PIC 9.
  5923                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5924                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5925             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5926                                            PIC X(10).
  5927
  5928         16  FILLER                         PIC X(43).
  5929
  5930         16  CF-LOSS-RATIO-SELECT.
  5931             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5932             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5933         16  CF-ENTRY-DATE-SELECT.
  5934             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5935             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5936         16  CF-EFFECTIVE-DATE-SELECT.
  5937             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5938             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5939
  5940         16  CF-EXCEPTION-LIST-IND          PIC X.
  5941             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  5942
  5943         16  FILLER                         PIC X(318).
  5944
  5945****************************************************************
  5946*                  EXCEPTION REPORTING RECORD                  *
  5947****************************************************************
  5948
  5949     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5950         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5951             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5952
  5953         16  CF-COMBINED-LIFE-AH-OPT.
  5954             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5955             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5956             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5957             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5958
  5959         16  CF-LIFE-OPT.
  5960             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5961             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5962             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5963             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5964             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5965             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5966             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 113
* EL689.cbl
  5967             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5968             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5969             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5970
  5971         16  CF-AH-OPT.
  5972             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5973             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5974             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5975             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5976             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5977             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5978             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5979             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5980             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5981             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5982
  5983         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5984             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5985             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5986             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5987
  5988         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5989
  5990         16  FILLER                         PIC X(673).
  5991
  5992
  5993****************************************************************
  5994*             MORTGAGE SYSTEM PLAN RECORD                      *
  5995****************************************************************
  5996
  5997     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5998         16  CF-PLAN-TYPE                   PIC X.
  5999             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6000             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6001             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6002         16  CF-PLAN-ABBREV                 PIC XXX.
  6003         16  CF-PLAN-DESCRIPT               PIC X(10).
  6004         16  CF-PLAN-NOTES                  PIC X(20).
  6005         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6006         16  CF-PLAN-UNDERWRITING.
  6007             20  CF-PLAN-TERM-DATA.
  6008                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6009                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6010             20  CF-PLAN-AGE-DATA.
  6011                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6012                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6013                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6014             20  CF-PLAN-BENEFIT-DATA.
  6015                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6016                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6017                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6018                                            PIC S9(7)V99  COMP-3.
  6019         16  CF-PLAN-POLICY-FORMS.
  6020             20  CF-POLICY-FORM             PIC X(12).
  6021             20  CF-MASTER-APPLICATION      PIC X(12).
  6022             20  CF-MASTER-POLICY           PIC X(12).
  6023         16  CF-PLAN-RATING.
  6024             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 114
* EL689.cbl
  6025             20  CF-SEX-RATING              PIC X.
  6026                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6027                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6028             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6029             20  CF-SUB-STD-TYPE            PIC X.
  6030                 88  CF-PCT-OF-PREM            VALUE '1'.
  6031                 88  CF-PCT-OF-BENE            VALUE '2'.
  6032         16  CF-PLAN-PREM-TOLERANCES.
  6033             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6034             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6035         16  CF-PLAN-PYMT-TOLERANCES.
  6036             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6037             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6038         16  CF-PLAN-MISC-DATA.
  6039             20  FILLER                     PIC X.
  6040             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6041             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6042         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6043         16  CF-PLAN-IND-GRP                PIC X.
  6044             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6045                                                     '1'.
  6046             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6047                                                     '2'.
  6048         16  CF-MIB-SEARCH-SW               PIC X.
  6049             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6050             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6051             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6052             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6053         16  CF-ALPHA-SEARCH-SW             PIC X.
  6054             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6055             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6056             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6057             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6058             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6059             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6060             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6061             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6062             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6063             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6064                                                     'A' 'B' 'C'
  6065                                                     'X' 'Y' 'Z'.
  6066         16  CF-EFF-DT-RULE-SW              PIC X.
  6067             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6068             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6069             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6070             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6071             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6072         16  FILLER                         PIC X(4).
  6073         16  CF-HEALTH-QUESTIONS            PIC X.
  6074             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6075         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6076         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6077         16  CF-PLAN-SNGL-JNT               PIC X.
  6078             88  CF-COMBINED-PLAN              VALUE 'C'.
  6079             88  CF-JNT-PLAN                   VALUE 'J'.
  6080             88  CF-SNGL-PLAN                  VALUE 'S'.
  6081         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6082         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 115
* EL689.cbl
  6083         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6084         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6085         16  CF-RERATE-CNTL                 PIC  X.
  6086             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6087             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6088             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6089             88  CF-AUTO-RECALC                 VALUE '4'.
  6090         16  CF-BENEFIT-TYPE                PIC  X.
  6091             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6092             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6093         16  CF-POLICY-FEE                  PIC S999V99
  6094                                                    COMP-3.
  6095         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6096         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6097         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6098         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6099         16  FILLER                         PIC  X(32).
  6100         16  CF-TERMINATION-FORM            PIC  X(04).
  6101         16  FILLER                         PIC  X(08).
  6102         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6103                                                       COMP-3.
  6104         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6105         16  CF-ISSUE-LETTER                PIC  X(4).
  6106         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6107         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6108             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6109             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6110         16  CF-MP-REFUND-CALC              PIC X.
  6111             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6112             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6113             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6114             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6115             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6116             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6117             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6118             88  CF-MP-REFD-MEAN                VALUE '8'.
  6119         16  CF-ALT-RATE-CODE               PIC  X(5).
  6120
  6121
  6122         16  FILLER                         PIC X(498).
  6123****************************************************************
  6124*             MORTGAGE COMPANY MASTER RECORD                   *
  6125****************************************************************
  6126
  6127     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6128         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6129         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6130             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6131             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6132             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6133             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6134             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6135
  6136         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6137         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6138         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6139         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6140         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 116
* EL689.cbl
  6141
  6142         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6143             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6144         16  CF-MP-RECON-USE-IND            PIC X(1).
  6145             88  CF-MP-USE-RECON             VALUE 'Y'.
  6146         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6147             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6148         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6149             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6150             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6151         16  FILLER                         PIC X(1).
  6152         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6153             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6154         16  CF-MORTG-MIB-VERSION           PIC X.
  6155             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6156             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6157             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6158         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6159             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  6160                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6161             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6162                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6163             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6164                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6165             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6166                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6167             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6168                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6169             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6170                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6171         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6172         16  FILLER                         PIC X(7).
  6173         16  CF-MORTG-DESTINATION-SYMBOL.
  6174             20  CF-MORTG-MIB-COMM          PIC X(5).
  6175             20  CF-MORTG-MIB-TERM          PIC X(5).
  6176         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6177             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6178         16  FILLER                         PIC X(03).
  6179         16  CF-MP-CHECK-NO-CONTROL.
  6180             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6181                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6182                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6183                                                ' ' LOW-VALUES.
  6184                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6185                                               VALUE '3'.
  6186         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6187         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6188         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6189             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6190                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6191             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6192                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6193             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6194                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6195             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6196                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6197             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6198                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 117
* EL689.cbl
  6199             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6200                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6201         16  CF-MORTG-BILLING-AREA.
  6202             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6203                                            PIC X.
  6204         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6205         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6206         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6207         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6208             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6209             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6210         16  FILLER                         PIC X.
  6211         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6212             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6213             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6214         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6215         16  FILLER                         PIC X(8).
  6216         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6217         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  6218         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6219         16  CF-ACH-COMPANY-ID.
  6220             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6221                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6222                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6223                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6224             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6225         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6226             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6227         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6228             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6229             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6230         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6231         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6232         16  FILLER                         PIC X(536).
  6233
  6234****************************************************************
  6235*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6236****************************************************************
  6237
  6238     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6239         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6240             20  CF-FEMALE-HEIGHT.
  6241                 24  CF-FEMALE-FT           PIC 99.
  6242                 24  CF-FEMALE-IN           PIC 99.
  6243             20  CF-FEMALE-MIN-WT           PIC 999.
  6244             20  CF-FEMALE-MAX-WT           PIC 999.
  6245         16  FILLER                         PIC X(428).
  6246
  6247     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6248         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6249             20  CF-MALE-HEIGHT.
  6250                 24  CF-MALE-FT             PIC 99.
  6251                 24  CF-MALE-IN             PIC 99.
  6252             20  CF-MALE-MIN-WT             PIC 999.
  6253             20  CF-MALE-MAX-WT             PIC 999.
  6254         16  FILLER                         PIC X(428).
  6255******************************************************************
  6256*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 118
* EL689.cbl
  6257******************************************************************
  6258     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6259         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6260             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6261             20  CF-SYS-LETTER-ID           PIC X(04).
  6262             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6263             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6264             20  CF-SYS-RESET-SW            PIC X(01).
  6265             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6266             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6267
  6268         16  FILLER                         PIC X(50).
  6269
  6270         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6271             20  CF-USER-ACTIVE-SW          PIC X(01).
  6272             20  CF-USER-LETTER-ID          PIC X(04).
  6273             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6274             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6275             20  CF-USER-RESET-SW           PIC X(01).
  6276             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6277             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6278             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6279
  6280         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 119
* EL689.cbl
  6282*    COPY ERCCOMP.
  6283******************************************************************
  6284*                                                                *
  6285*                                                                *
  6286*                            ERCCOMP                             *
  6287*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6288*                            VMOD=2.019                          *
  6289*                                                                *
  6290*   ONLINE CREDIT SYSTEM                                         *
  6291*                                                                *
  6292*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6293*                                                                *
  6294*   FILE TYPE = VSAM,KSDS                                        *
  6295*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6296*                                                                *
  6297*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6298*       ALTERNATE PATH = NONE                                    *
  6299*                                                                *
  6300*   LOG = NO                                                     *
  6301*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6302*                                                                *
  6303******************************************************************
  6304*                   C H A N G E   L O G
  6305*
  6306* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6307*-----------------------------------------------------------------
  6308*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6309* EFFECTIVE    NUMBER
  6310*-----------------------------------------------------------------
  6311* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6312* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6313* 092205    2005050300006  PEMA  ADD LEASE FEE
  6314* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6315* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6316* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6317* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6318* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6319******************************************************************
  6320
  6321 01  COMPENSATION-MASTER.
  6322     12  CO-RECORD-ID                          PIC XX.
  6323         88  VALID-CO-ID                          VALUE 'CO'.
  6324
  6325     12  CO-CONTROL-PRIMARY.
  6326         16  CO-COMPANY-CD                     PIC X.
  6327         16  CO-CONTROL.
  6328             20  CO-CTL-1.
  6329                 24  CO-CARR-GROUP.
  6330                     28  CO-CARRIER            PIC X.
  6331                     28  CO-GROUPING.
  6332                         32  CO-GROUP-PREFIX   PIC XXX.
  6333                         32  CO-GROUP-PRIME    PIC XXX.
  6334                 24  CO-RESP-NO.
  6335                     28  CO-RESP-PREFIX        PIC X(4).
  6336                     28  CO-RESP-PRIME         PIC X(6).
  6337             20  CO-CTL-2.
  6338                 24  CO-ACCOUNT.
  6339                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 120
* EL689.cbl
  6340                     28  CO-ACCT-PRIME         PIC X(6).
  6341         16  CO-TYPE                           PIC X.
  6342             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6343             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6344             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6345
  6346     12  CO-MAINT-INFORMATION.
  6347         16  CO-LAST-MAINT-DT                  PIC XX.
  6348         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6349         16  CO-LAST-MAINT-USER                PIC X(4).
  6350     12  FILLER                                PIC XX.
  6351     12  CO-STMT-TYPE                          PIC XXX.
  6352     12  CO-COMP-TYPE                          PIC X.
  6353         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6354     12  CO-STMT-OWNER                         PIC X(4).
  6355     12  CO-BALANCE-CONTROL                    PIC X.
  6356         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6357         88  CO-NO-BALANCE                        VALUE 'N'.
  6358
  6359     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6360         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6361         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6362         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6363
  6364     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6365         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6366         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6367
  6368     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6369     12  CO-GA-DIRECT-DEP                      PIC X.
  6370     12  CO-FUTURE-SPACE                       PIC X.
  6371         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6372
  6373     12  CO-ACCT-NAME                          PIC X(30).
  6374     12  CO-MAIL-NAME                          PIC X(30).
  6375     12  CO-ADDR-1                             PIC X(30).
  6376     12  CO-ADDR-2                             PIC X(30).
  6377     12  CO-ADDR-3.
  6378         16  CO-ADDR-CITY                      PIC X(27).
  6379         16  CO-ADDR-STATE                     PIC XX.
  6380     12  CO-CSO-1099                           PIC X.
  6381     12  CO-ZIP.
  6382         16  CO-ZIP-PRIME.
  6383             20  CO-ZIP-PRI-1ST                PIC X.
  6384                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6385             20  FILLER                        PIC X(4).
  6386         16  CO-ZIP-PLUS4                      PIC X(4).
  6387     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6388         16  CO-CAN-POSTAL-1                   PIC XXX.
  6389         16  CO-CAN-POSTAL-2                   PIC XXX.
  6390         16  FILLER                            PIC XXX.
  6391     12  CO-SOC-SEC                            PIC X(13).
  6392     12  CO-TELEPHONE.
  6393         16  CO-AREA-CODE                      PIC XXX.
  6394         16  CO-PREFIX                         PIC XXX.
  6395         16  CO-PHONE                          PIC X(4).
  6396
  6397     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 121
* EL689.cbl
  6398
  6399     12  CO-AR-BAL-LEVEL                       PIC X.
  6400         88  CO-AR-REF-LVL                        VALUE '1'.
  6401         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6402         88  CO-AR-BILL-LVL                       VALUE '2'.
  6403         88  CO-AR-AGT-LVL                        VALUE '3'.
  6404         88  CO-AR-FR-LVL                         VALUE '4'.
  6405
  6406     12  CO-AR-NORMAL-PRINT                    PIC X.
  6407         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6408         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6409
  6410     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6411
  6412     12  CO-AR-REPORTING                       PIC X.
  6413         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6414         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6415
  6416     12  CO-AR-PULL-CHECK                      PIC X.
  6417         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6418         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6419
  6420     12  CO-AR-BALANCE-PRINT                   PIC X.
  6421         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6422
  6423     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6424         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6425         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6426         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6427
  6428     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6429
  6430     12  CO-USER-CODE                          PIC X.
  6431     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6432
  6433******************************************************************
  6434*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6435*    THE LAST MONTH END RUN.
  6436******************************************************************
  6437
  6438     12  CO-LAST-ACTIVITY-DATE.
  6439         16  CO-ACT-YEAR                       PIC 99.
  6440         16  CO-ACT-MONTH                      PIC 99.
  6441         16  CO-ACT-DAY                        PIC 99.
  6442
  6443     12  CO-LAST-STMT-DT.
  6444         16  CO-LAST-STMT-YEAR                 PIC 99.
  6445         16  CO-LAST-STMT-MONTH                PIC 99.
  6446         16  CO-LAST-STMT-DAY                  PIC 99.
  6447
  6448     12  CO-MO-END-TOTALS.
  6449         16  CO-MONTHLY-TOTALS.
  6450             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6451             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6452             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6453             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6454             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  6455
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 122
* EL689.cbl
  6456         16  CO-AGING-TOTALS.
  6457             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6458             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6459             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6460             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6461
  6462         16  CO-YTD-TOTALS.
  6463             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6464             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6465
  6466         16  CO-OVER-UNDER-TOTALS.
  6467             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6468             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6469
  6470     12  CO-MISCELLANEOUS-TOTALS.
  6471         16  CO-FICA-TOTALS.
  6472             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6473             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6474
  6475         16  CO-CLAIM-TOTALS.
  6476             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  6477             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  6478
  6479******************************************************************
  6480*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  6481*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  6482******************************************************************
  6483
  6484     12  CO-CURRENT-TOTALS.
  6485         16  CO-CURRENT-LAST-STMT-DT.
  6486             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  6487             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  6488             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  6489
  6490         16  CO-CURRENT-MONTHLY-TOTALS.
  6491             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  6492             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  6493             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  6494             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  6495             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  6496
  6497         16  CO-CURRENT-AGING-TOTALS.
  6498             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  6499             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  6500             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  6501             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  6502
  6503         16  CO-CURRENT-YTD-TOTALS.
  6504             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  6505             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  6506
  6507     12  CO-PAID-COMM-TOTALS.
  6508         16  CO-YTD-PAID-COMMS.
  6509             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  6510             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  6511
  6512     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  6513         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 123
* EL689.cbl
  6514         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  6515
  6516     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  6517         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  6518         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  6519         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  6520         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  6521         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  6522         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  6523         88  CO-FINAL-LETTER                  VALUE 'F'.
  6524         88  CO-RECONCILING                   VALUE 'R'.
  6525         88  CO-PHONE-CALL                    VALUE 'P'.
  6526         88  CO-LEGAL                         VALUE 'L'.
  6527         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  6528         88  CO-WRITE-OFF                     VALUE 'W'.
  6529         88  CO-NO-ACTION                     VALUE 'N' ' '.
  6530
  6531     12  CO-CSR-CODE                       PIC X(4).
  6532
  6533     12  CO-GA-STATUS-INFO.
  6534         16  CO-GA-EFFECTIVE-DT            PIC XX.
  6535         16  CO-GA-TERMINATION-DT          PIC XX.
  6536         16  CO-GA-STATUS-CODE             PIC X.
  6537             88  CO-GA-ACTIVE                 VALUE 'A'.
  6538             88  CO-GA-INACTIVE               VALUE 'I'.
  6539             88  CO-GA-PENDING                VALUE 'P'.
  6540         16  CO-GA-COMMENTS.
  6541             20  CO-GA-COMMENT-1           PIC X(40).
  6542             20  CO-GA-COMMENT-2           PIC X(40).
  6543             20  CO-GA-COMMENT-3           PIC X(40).
  6544             20  CO-GA-COMMENT-4           PIC X(40).
  6545
  6546     12  CO-RPTCD2                         PIC X(10).
  6547
  6548     12  CO-TYPE-AGENT                     PIC X(01).
  6549         88  CO-CORPORATION                   VALUE 'C'.
  6550         88  CO-PARTNERSHIP                   VALUE 'P'.
  6551         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  6552         88  CO-TRUST                         VALUE 'T'.
  6553         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  6554
  6555     12  CO-FAXNO.
  6556         16  CO-FAX-AREA-CODE                  PIC XXX.
  6557         16  CO-FAX-PREFIX                     PIC XXX.
  6558         16  CO-FAX-PHONE                      PIC X(4).
  6559
  6560     12  CO-BANK-INFORMATION.
  6561         16  CO-BANK-TRANSIT-NO                PIC X(8).
  6562         16  CO-BANK-TRANSIT-NON REDEFINES
  6563             CO-BANK-TRANSIT-NO                PIC 9(8).
  6564
  6565         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  6566     12  CO-MISC-DEDUCT-INFO REDEFINES
  6567                  CO-BANK-INFORMATION.
  6568         16  CO-MD-GL-ACCT                     PIC X(10).
  6569         16  CO-MD-DIV                         PIC XX.
  6570         16  CO-MD-CENTER                      PIC X(4).
  6571         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 124
* EL689.cbl
  6572         16  CO-CREATE-AP-CHECK                PIC X.
  6573         16  CO-DELIVER-CK-TO-MEL              PIC X.
  6574         16  FILLER                            PIC XXX.
  6575     12  CO-ACH-STATUS                         PIC X.
  6576         88  CO-ACH-ACTIVE                         VALUE 'A'.
  6577         88  CO-ACH-PENDING                        VALUE 'P'.
  6578
  6579     12  CO-BILL-SW                            PIC X.
  6580     12  CO-CONTROL-NAME                       PIC X(30).
  6581     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  6582     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  6583     12  CO-CLP-STATE                          PIC XX.
  6584     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  6585     12  CO-SPP-REFUND-EDIT                    PIC X.
  6586
  6587******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 125
* EL689.cbl
  6589*    COPY ERCMAIL.
  6590******************************************************************
  6591*                                                                *
  6592*                                                                *
  6593*                            ERCMAIL                             *
  6594*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6595*                            VMOD=2.003                          *
  6596*                                                                *
  6597*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6598*                                                                *
  6599*   FILE TYPE = VSAM,KSDS                                        *
  6600*   RECORD SIZE = 374   RECFORM = FIX                            *
  6601*                                                                *
  6602*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6603*   ALTERNATE PATH    = NOT USED                                 *
  6604*                                                                *
  6605*   LOG = YES                                                    *
  6606*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6607******************************************************************
  6608*                   C H A N G E   L O G
  6609*
  6610* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6611*-----------------------------------------------------------------
  6612*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6613* EFFECTIVE    NUMBER
  6614*-----------------------------------------------------------------
  6615* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6616* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6617* 111108                   PEMA  ADD CRED BENE ADDR2
  6618******************************************************************
  6619
  6620 01  MAILING-DATA.
  6621     12  MA-RECORD-ID                      PIC XX.
  6622         88  VALID-MA-ID                       VALUE 'MA'.
  6623
  6624     12  MA-CONTROL-PRIMARY.
  6625         16  MA-COMPANY-CD                 PIC X.
  6626         16  MA-CARRIER                    PIC X.
  6627         16  MA-GROUPING.
  6628             20  MA-GROUPING-PREFIX        PIC XXX.
  6629             20  MA-GROUPING-PRIME         PIC XXX.
  6630         16  MA-STATE                      PIC XX.
  6631         16  MA-ACCOUNT.
  6632             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6633             20  MA-ACCOUNT-PRIME          PIC X(6).
  6634         16  MA-CERT-EFF-DT                PIC XX.
  6635         16  MA-CERT-NO.
  6636             20  MA-CERT-PRIME             PIC X(10).
  6637             20  MA-CERT-SFX               PIC X.
  6638
  6639     12  FILLER                            PIC XX.
  6640
  6641     12  MA-ACCESS-CONTROL.
  6642         16  MA-SOURCE-SYSTEM              PIC XX.
  6643             88  MA-FROM-CREDIT                VALUE 'CR'.
  6644             88  MA-FROM-VSI                   VALUE 'VS'.
  6645             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6646             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 126
* EL689.cbl
  6647         16  MA-RECORD-ADD-DT              PIC XX.
  6648         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6649         16  MA-LAST-MAINT-DT              PIC XX.
  6650         16  MA-LAST-MAINT-BY              PIC XXXX.
  6651         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6652
  6653     12  MA-PROFILE-INFO.
  6654         16  MA-QUALIFY-CODE-1             PIC XX.
  6655         16  MA-QUALIFY-CODE-2             PIC XX.
  6656         16  MA-QUALIFY-CODE-3             PIC XX.
  6657         16  MA-QUALIFY-CODE-4             PIC XX.
  6658         16  MA-QUALIFY-CODE-5             PIC XX.
  6659
  6660         16  MA-INSURED-LAST-NAME          PIC X(15).
  6661         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6662         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6663         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6664         16  MA-INSURED-BIRTH-DT           PIC XX.
  6665         16  MA-INSURED-SEX                PIC X.
  6666             88  MA-SEX-MALE                   VALUE 'M'.
  6667             88  MA-SEX-FEMALE                 VALUE 'F'.
  6668         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6669
  6670         16  MA-ADDRESS-CORRECTED          PIC X.
  6671         16  MA-JOINT-BIRTH-DT             PIC XX.
  6672*        16  FILLER                        PIC X(12).
  6673
  6674         16  MA-ADDRESS-LINE-1             PIC X(30).
  6675         16  MA-ADDRESS-LINE-2             PIC X(30).
  6676         16  MA-CITY-STATE.
  6677             20  MA-CITY                   PIC X(28).
  6678             20  MA-ADDR-STATE             PIC XX.
  6679         16  MA-ZIP.
  6680             20  MA-ZIP-CODE.
  6681                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6682                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6683                 24  FILLER                PIC X(4).
  6684             20  MA-ZIP-PLUS4              PIC X(4).
  6685         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6686             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6687             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6688             20  FILLER                    PIC X(3).
  6689
  6690         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6691
  6692         16  FILLER                        PIC XXX.
  6693*        16  FILLER                        PIC X(10).
  6694
  6695     12  MA-CRED-BENE-INFO.
  6696         16  MA-CRED-BENE-NAME                 PIC X(25).
  6697         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6698         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6699         16  MA-CRED-BENE-CTYST.
  6700             20  MA-CRED-BENE-CITY             PIC X(28).
  6701             20  MA-CRED-BENE-STATE            PIC XX.
  6702         16  MA-CRED-BENE-ZIP.
  6703             20  MA-CB-ZIP-CODE.
  6704                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 127
* EL689.cbl
  6705                     88  MA-CB-CANADIAN-POST-CODE
  6706                                           VALUE 'A' THRU 'Z'.
  6707                 24  FILLER                    PIC X(4).
  6708             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6709         16  MA-CB-CANADIAN-POSTAL-CODE
  6710                            REDEFINES MA-CRED-BENE-ZIP.
  6711             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6712             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6713             20  FILLER                        PIC X(3).
  6714     12  MA-POST-CARD-MAIL-DATA.
  6715         16  MA-MAIL-DATA OCCURS 7.
  6716             20  MA-MAIL-TYPE              PIC X.
  6717                 88  MA-12MO-MAILING           VALUE '1'.
  6718                 88  MA-EXP-MAILING            VALUE '2'.
  6719             20  MA-MAIL-STATUS            PIC X.
  6720                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6721                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6722                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6723             20  MA-MAIL-DATE              PIC XX.
  6724     12  FILLER                            PIC XX.
  6725     12  FILLER                            PIC XX.
  6726*    12  FILLER                            PIC X(30).
  6727******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 128
* EL689.cbl
  6729*    COPY ERCPNDB.
  6730******************************************************************
  6731*                                                                *
  6732*                                                                *
  6733*                            ERCPNDB.                            *
  6734*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6735*                            VMOD=2.025                          *
  6736*                                                                *
  6737*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  6738*                                                                *
  6739******************************************************************
  6740*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  6741*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  6742******************************************************************
  6743*                                                                *
  6744*                                                                *
  6745*   FILE TYPE = VSAM,KSDS                                        *
  6746*   RECORD SIZE = 585  RECFORM = FIXED                           *
  6747*                                                                *
  6748*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  6749*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  6750*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  6751*                                                 RKP=13,LEN=36  *
  6752*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  6753*                                      AND CHG-SEQ.)             *
  6754*                                                RKP=49,LEN=11   *
  6755*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  6756*                                      AND CHG-SEQ.)             *
  6757*                                                RKP=60,LEN=15   *
  6758*                                                                *
  6759*   LOG = NO                                                     *
  6760*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6761******************************************************************
  6762******************************************************************
  6763*                   C H A N G E   L O G
  6764*
  6765* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6766*-----------------------------------------------------------------
  6767*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6768* EFFECTIVE    NUMBER
  6769*-----------------------------------------------------------------
  6770* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6771* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6772* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  6773* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6774* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  6775* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6776* 032306                   PEMA  ADD BOW LOAN NUMBER
  6777* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  6778* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  6779* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6780* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6781* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  6782* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  6783* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6784* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  6785******************************************************************
  6786
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 129
* EL689.cbl
  6787 01  PENDING-BUSINESS.
  6788     12  PB-RECORD-ID                     PIC XX.
  6789         88  VALID-PB-ID                        VALUE 'PB'.
  6790
  6791     12  PB-CONTROL-PRIMARY.
  6792         16  PB-COMPANY-CD                PIC X.
  6793         16  PB-ENTRY-BATCH               PIC X(6).
  6794         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  6795         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  6796
  6797     12  PB-CONTROL-BY-ACCOUNT.
  6798         16  PB-COMPANY-CD-A1             PIC X.
  6799         16  PB-CARRIER                   PIC X.
  6800         16  PB-GROUPING.
  6801             20  PB-GROUPING-PREFIX       PIC XXX.
  6802             20  PB-GROUPING-PRIME        PIC XXX.
  6803         16  PB-STATE                     PIC XX.
  6804         16  PB-ACCOUNT.
  6805             20  PB-ACCOUNT-PREFIX        PIC X(4).
  6806             20  PB-ACCOUNT-PRIME         PIC X(6).
  6807         16  PB-CERT-EFF-DT               PIC XX.
  6808         16  PB-CERT-NO.
  6809             20  PB-CERT-PRIME            PIC X(10).
  6810             20  PB-CERT-SFX              PIC X.
  6811         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  6812
  6813         16  PB-RECORD-TYPE               PIC X.
  6814             88  PB-MAILING-DATA                VALUE '0'.
  6815             88  PB-ISSUE                       VALUE '1'.
  6816             88  PB-CANCELLATION                VALUE '2'.
  6817             88  PB-BATCH-TRAILER               VALUE '9'.
  6818
  6819     12  PB-CONTROL-BY-ORIG-BATCH.
  6820         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  6821         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  6822         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  6823         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  6824
  6825     12  PB-CONTROL-BY-CSR.
  6826         16  PB-CSR-COMPANY-CD            PIC X.
  6827         16  PB-CSR-ID                    PIC X(4).
  6828         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  6829         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  6830         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  6831******************************************************************
  6832*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  6833******************************************************************
  6834
  6835     12  PB-LAST-MAINT-DT                 PIC XX.
  6836     12  PB-LAST-MAINT-BY                 PIC X(4).
  6837     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  6838
  6839     12  PB-RECORD-BODY                   PIC X(375).
  6840
  6841     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  6842         16  PB-CERT-ORIGIN               PIC X.
  6843             88  CLASIC-CREATED-CERT         VALUE '1'.
  6844         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 130
* EL689.cbl
  6845             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  6846             20  PB-I-INSURED-FIRST-NAME.
  6847                 24  PB-I-INSURED-1ST-INIT PIC X.
  6848                 24  FILLER                PIC X(9).
  6849             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  6850         16  PB-I-AGE                     PIC S99   COMP-3.
  6851         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  6852         16  PB-I-BIRTHDAY                PIC XX.
  6853         16  PB-I-INSURED-SEX             PIC X.
  6854             88  PB-SEX-MALE     VALUE 'M'.
  6855             88  PB-SEX-FEMALE   VALUE 'F'.
  6856
  6857         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  6858         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  6859         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  6860         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  6861         16  PB-I-SKIP-CODE               PIC X.
  6862             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  6863             88  PB-SKIP-JULY              VALUE '1'.
  6864             88  PB-SKIP-AUGUST            VALUE '2'.
  6865             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  6866             88  PB-SKIP-JULY-AUG          VALUE '4'.
  6867             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  6868             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  6869             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  6870             88  PB-SKIP-JUNE              VALUE '8'.
  6871             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  6872             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6873             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6874         16  PB-I-TERM-TYPE               PIC X.
  6875             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6876             88  PB-PAID-WEEKLY            VALUE 'W'.
  6877             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6878             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6879             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6880         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6881         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6882         16  PB-I-DATA-ENTRY-SW           PIC X.
  6883             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6884             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6885             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6886             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6887         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6888         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6889*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6890         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6891         16  FILLER                       PIC X.
  6892
  6893         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6894             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6895             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6896                                                   '90' THRU '99'.
  6897         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6898                                          PIC XX.
  6899         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6900         16  PB-I-AMOUNT-FINANCED REDEFINES
  6901                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6902         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 131
* EL689.cbl
  6903         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6904                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6905         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6906         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6907         16  PB-I-CLP-AMOUNT REDEFINES
  6908                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6909         16  PB-I-LF-CALC-FLAG            PIC X.
  6910             88 PB-COMP-LF-PREM               VALUE '?'.
  6911         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6912         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6913         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  6914         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6915         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6916         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6917         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6918         16  PB-I-LF-ABBR                 PIC XXX.
  6919         16  PB-I-LF-INPUT-CD             PIC XX.
  6920
  6921         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6922             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6923             88  PB-INVALID-AH               VALUE '  ' '00'
  6924                                                   '90' THRU '99'.
  6925         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6926         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6927         16  PB-I-AH-CALC-FLAG            PIC X.
  6928             88 PB-COMP-AH-PREM                  VALUE '?'.
  6929         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6930         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6931         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  6932         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6933         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6934         16  PB-I-AH-ABBR                 PIC XXX.
  6935         16  PB-I-AH-INPUT-CD             PIC XXX.
  6936
  6937         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6938         16  PB-I-REIN-TABLE              PIC XXX.
  6939         16  PB-I-BUSINESS-TYPE           PIC 99.
  6940         16  PB-I-INDV-GRP-CD             PIC X.
  6941         16  PB-I-MORT-CODE.
  6942             20  PB-I-TABLE               PIC X.
  6943             20  PB-I-INTEREST            PIC XX.
  6944             20  PB-I-MORT-TYP            PIC X.
  6945         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6946         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6947         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6948         16  PB-I-INDV-GRP-OVRD           PIC X.
  6949         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6950         16  PB-I-SIG-SW                  PIC X.
  6951             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6952         16  PB-I-RATE-CLASS              PIC XX.
  6953         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6954         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6955         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6956         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6957         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6958         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6959         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6960         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 132
* EL689.cbl
  6961         16  PB-I-OB-FLAG                 PIC X.
  6962             88  PB-I-OB                      VALUE 'B'.
  6963             88  PB-I-SUMMARY                 VALUE 'Z'.
  6964         16  PB-I-ENTRY-STATUS            PIC X.
  6965             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6966                                              'M' '5' '9' '2'.
  6967             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6968             88  PB-I-POLICY-PENDING          VALUE '2'.
  6969             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6970             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6971             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6972             88  PB-I-REIN-ONLY               VALUE '9'.
  6973             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6974             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6975             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6976             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6977         16  PB-I-INT-CODE                PIC X.
  6978             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6979             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6980         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6981         16  PB-I-SOC-SEC-NO              PIC X(11).
  6982         16  PB-I-MEMBER-NO               PIC X(12).
  6983         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6984*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6985         16  PB-I-OLD-LOF                 PIC XXX.
  6986         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6987         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6988         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6989         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6990         16  PB-I-LIFE-INDICATOR          PIC X.
  6991             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6992         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6993         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6994                                          PIC S9(5)V99    COMP-3.
  6995         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6996             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6997             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6998         16  PB-I-1ST-PMT-DT              PIC XX.
  6999         16  PB-I-JOINT-INSURED.
  7000             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  7001             20 PB-I-JOINT-FIRST-NAME.
  7002                24  PB-I-JOINT-FIRST-INIT PIC X.
  7003                24  FILLER                PIC X(9).
  7004             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  7005*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  7006         16  PB-I-BENEFICIARY-NAME.
  7007             20  PB-I-BANK-NUMBER         PIC X(10).
  7008             20  FILLER                   PIC X(15).
  7009         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  7010         16  PB-I-REFERENCE               PIC X(12).
  7011         16  FILLER REDEFINES PB-I-REFERENCE.
  7012             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  7013             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  7014             20  PB-I-CLP-STATE           PIC XX.
  7015         16  PB-I-UNDERWRITING-STATUS     PIC X.
  7016             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  7017             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  7018             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 133
* EL689.cbl
  7019         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  7020         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  7021         16  PB-I-RESIDENT-STATE          PIC XX.
  7022         16  PB-I-RATE-CODE               PIC X(4).
  7023         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  7024         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7025         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7026         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  7027         16  PB-I-BANK-NOCHRGB            PIC 99.
  7028         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  7029         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  7030
  7031     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  7032         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  7033             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  7034         16  PB-C-CANCEL-ORIGIN           PIC X.
  7035             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  7036         16  PB-C-LF-CANCEL-DT            PIC XX.
  7037         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7038         16  PB-C-LF-CALC-REQ             PIC X.
  7039             88 PB-COMP-LF-CANCEL            VALUE '?'.
  7040         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  7041         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  7042         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  7043             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  7044         16  PB-C-AH-CANCEL-DT            PIC XX.
  7045         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7046         16  PB-C-AH-CALC-REQ             PIC X.
  7047             88 PB-COMP-AH-CANCEL            VALUE '?'.
  7048         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  7049         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  7050         16  PB-C-LAST-NAME               PIC X(15).
  7051         16  PB-C-REFUND-SW               PIC X.
  7052             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  7053             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  7054         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  7055         16  PB-C-PAYEE-CODE              PIC X(6).
  7056         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  7057         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  7058         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  7059         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  7060         16  PB-C-REFERENCE               PIC X(12).
  7061         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7062         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7063         16  PB-C-POST-CARD-IND           PIC X.
  7064         16  PB-C-CANCEL-REASON           PIC X.
  7065         16  PB-C-REF-INTERFACE-SW        PIC X.
  7066         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  7067         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  7068         16  FILLER                       PIC X(01).
  7069*        16  FILLER                       PIC X(18).
  7070         16  PB-C-POLICY-FORM-NO          PIC X(12).
  7071*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  7072         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  7073         16  PB-CANCELED-CERT-DATA.
  7074             20  PB-CI-INSURED-NAME.
  7075                 24  PB-CI-LAST-NAME      PIC X(15).
  7076                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 134
* EL689.cbl
  7077             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  7078             20  PB-CI-INSURED-SEX        PIC X.
  7079             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  7080             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  7081             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  7082             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  7083             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7084             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  7085             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  7086             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  7087             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  7088             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7089             20  PB-CI-RATE-CLASS         PIC XX.
  7090             20  PB-CI-RATE-DEV-LF        PIC XXX.
  7091             20  PB-CI-RATE-DEV-AH        PIC XXX.
  7092             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  7093             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  7094             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  7095             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  7096             20  PB-CI-LF-ABBR            PIC X(3).
  7097             20  PB-CI-AH-ABBR            PIC X(3).
  7098             20  PB-CI-OB-FLAG            PIC X.
  7099                 88  PB-CI-OB                VALUE 'B'.
  7100             20  PB-CI-LF-POLICY-STATUS   PIC X.
  7101                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  7102                                           'M' '4' '5' '9' '2'.
  7103                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  7104                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  7105                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  7106                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  7107                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  7108                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  7109                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  7110                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  7111                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  7112                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  7113                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  7114                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  7115             20  PB-CI-AH-POLICY-STATUS   PIC X.
  7116                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  7117                                           'M' '4' '5' '9' '2'.
  7118                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  7119                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  7120                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  7121                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  7122                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  7123                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  7124                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  7125                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  7126                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  7127                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  7128                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  7129                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  7130             20  PB-CI-PAY-FREQUENCY      PIC 99.
  7131             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  7132             20  PB-CI-SOC-SEC-NO         PIC X(11).
  7133             20  PB-CI-MEMBER-NO          PIC X(12).
  7134             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 135
* EL689.cbl
  7135                 88  PB-CI-ADD-ON                  VALUE 'A'.
  7136                 88  PB-CI-SIMPLE                  VALUE 'S'.
  7137             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  7138             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  7139             20  PB-CI-COMP-EXCP-SW       PIC X.
  7140                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  7141                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  7142             20  PB-CI-ENTRY-STATUS       PIC X.
  7143             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  7144             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  7145             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  7146             20  PB-CI-DEATH-DT           PIC XX.
  7147             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  7148             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  7149             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7150             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7151             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  7152             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  7153             20  PB-CI-ENTRY-DT              PIC XX.
  7154             20  PB-CI-ENTRY-BATCH           PIC X(6).
  7155             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  7156             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  7157             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  7158             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  7159             20  PB-CI-OLD-LOF               PIC XXX.
  7160*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  7161             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  7162             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  7163             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  7164             20  PB-CI-INDV-GRP-CD           PIC X.
  7165             20  PB-CI-BENEFICIARY-NAME.
  7166                 24  PB-CI-BANK-NUMBER       PIC X(10).
  7167                 24  FILLER                  PIC X(15).
  7168             20  PB-CI-NOTE-SW               PIC X.
  7169             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  7170             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  7171             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  7172             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  7173             20  PB-CI-LOAN-OFFICER          PIC X(5).
  7174             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  7175             20  PB-CI-FIRST-NAME            PIC X(10).
  7176             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  7177
  7178         16  FILLER                       PIC X(13).
  7179*032306  16  FILLER                       PIC X(27).
  7180*        16  FILLER                       PIC X(46).
  7181
  7182     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  7183         16  FILLER                       PIC X(10).
  7184         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  7185         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  7186         16  PB-M-INSURED-MID-INIT        PIC X.
  7187         16  PB-M-INSURED-AGE             PIC 99.
  7188         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  7189         16  PB-M-INSURED-SEX             PIC X.
  7190         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  7191         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  7192         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 136
* EL689.cbl
  7193         16  PB-M-INSURED-CITY-STATE.
  7194             20  PB-M-INSURED-CITY        PIC X(28).
  7195             20  PB-M-INSURED-STATE       PIC XX.
  7196         16  PB-M-INSURED-ZIP-CODE.
  7197             20  PB-M-INSURED-ZIP-PRIME.
  7198                 24  PB-M-INSURED-ZIP-1   PIC X.
  7199                     88  PB-M-CANADIAN-POST-CODE
  7200                                             VALUE 'A' THRU 'Z'.
  7201                 24  FILLER               PIC X(4).
  7202             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  7203         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  7204                                        PB-M-INSURED-ZIP-CODE.
  7205             20  PM-M-INS-CAN-POST1       PIC XXX.
  7206             20  PM-M-INS-CAN-POST2       PIC XXX.
  7207             20  FILLER                   PIC XXX.
  7208         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  7209         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  7210         16  PB-M-CRED-BENE-NAME          PIC X(30).
  7211         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  7212         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  7213         16  PB-M-CRED-BENE-CITYST.
  7214             20  PB-M-CRED-BENE-CITY      PIC X(28).
  7215             20  PB-M-CRED-BENE-STATE     PIC XX.
  7216         16  FILLER                       PIC X(92).
  7217
  7218     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  7219         16  FILLER                       PIC X(10).
  7220         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7221         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7222         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7223         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7224         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7225         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7226         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7227         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7228         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7229         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7230         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7231         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7232         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  7233         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  7234         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  7235         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  7236         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  7237         16  PB-ACCOUNT-NAME              PIC X(30).
  7238         16  PB-PREM-REF-RPT-FLAG         PIC X.
  7239         16  PB-REFERENCE                 PIC X(12).
  7240         16  PB-B-RECEIVED-DT             PIC XX.
  7241         16  FILLER                       PIC X(234).
  7242
  7243     12  PB-RECORD-STATUS.
  7244         16  PB-CREDIT-SELECT-DT          PIC XX.
  7245         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  7246         16  PB-BILLED-DT                 PIC XX.
  7247         16  PB-BILLING-STATUS            PIC X.
  7248             88  PB-ENTRY-REVERSED            VALUE 'R'.
  7249             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  7250             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 137
* EL689.cbl
  7251         16  PB-RECORD-BILL               PIC X.
  7252             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  7253             88  PB-RECORD-RETURNED           VALUE 'R'.
  7254             88  PB-RECORD-ENDORSED           VALUE 'E'.
  7255             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  7256             88  PB-OVERRIDE-AH               VALUE 'A'.
  7257             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  7258         16  PB-BATCH-ENTRY               PIC X.
  7259             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  7260             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  7261             88  PB-REISSUED-CERT             VALUE 'E'.
  7262             88  PB-MONTHLY-CERT              VALUE 'M'.
  7263             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  7264             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  7265             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  7266         16  PB-FORCE-CODE                PIC X.
  7267             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  7268             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  7269             88  PB-CANCEL-FORCE              VALUE '8'.
  7270             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  7271             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  7272             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  7273             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  7274             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  7275             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  7276             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  7277         16  PB-FATAL-FLAG                PIC X.
  7278             88  PB-FATAL-ERRORS              VALUE 'X'.
  7279         16  PB-FORCE-ER-CD               PIC X.
  7280             88  PB-FORCE-ERRORS              VALUE 'F'.
  7281             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  7282         16  PB-WARN-ER-CD                PIC X.
  7283             88  PB-WARNING-ERRORS            VALUE 'W'.
  7284         16  FILLER                       PIC X.
  7285         16  PB-OUT-BAL-CD                PIC X.
  7286             88  PB-OUT-OF-BAL                VALUE 'O'.
  7287         16  PB-LIFE-OVERRIDE-L1          PIC X.
  7288         16  PB-AH-OVERRIDE-L1            PIC X.
  7289         16  PB-INPUT-DT                  PIC XX.
  7290         16  PB-INPUT-BY                  PIC X(4).
  7291         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  7292         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  7293         16  PB-TOLERANCE-REJECT-SW       PIC X.
  7294         16  PB-LF-EARNING-METHOD         PIC X.
  7295         16  PB-AH-EARNING-METHOD         PIC X.
  7296         16  PB-LF-TERM-CALC-METHOD       PIC X.
  7297         16  PB-AH-TERM-CALC-METHOD       PIC X.
  7298         16  PB-REIN-CD                   PIC XXX.
  7299         16  PB-LF-REFUND-TYPE            PIC X.
  7300         16  PB-AH-REFUND-TYPE            PIC X.
  7301         16  PB-ACCT-EFF-DT               PIC XX.
  7302         16  PB-ACCT-EXP-DT               PIC XX.
  7303         16  PB-COMPANY-ID                PIC X(3).
  7304         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7305         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7306         16  PB-SV-CARRIER                PIC X.
  7307         16  PB-SV-GROUPING               PIC X(6).
  7308         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 138
* EL689.cbl
  7309         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  7310         16  PB-GA-BILLING-INFO.
  7311             20  PB-GA-BILL-DT OCCURS 5 TIMES
  7312                                          PIC XX.
  7313         16  PB-SV-REMIT-TO  REDEFINES
  7314             PB-GA-BILLING-INFO           PIC X(10).
  7315         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  7316         16  PB-I-LOAN-OFFICER            PIC X(5).
  7317         16  PB-I-VIN                     PIC X(17).
  7318
  7319         16  FILLER                       PIC X(04).
  7320         16  IMNET-BYPASS-SW              PIC X.
  7321
  7322******************************************************************
  7323*                COMMON EDIT ERRORS                              *
  7324******************************************************************
  7325
  7326     12  PB-COMMON-ERRORS.
  7327         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  7328                                           PIC S9(4)     COMP.
  7329
  7330******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 139
* EL689.cbl
  7332*    COPY ERCPYAJ.
  7333******************************************************************
  7334*                                                                *
  7335*                            ERCPYAJ                             *
  7336*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7337*                            VMOD=2.015                          *
  7338*                                                                *
  7339*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7340*                                                                *
  7341*                                                                *
  7342*   FILE TYPE = VSAM,KSDS                                        *
  7343*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7344*                                                                *
  7345*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7346*       ALTERNATE PATHS = NONE                                   *
  7347*                                                                *
  7348*   LOG = YES                                                    *
  7349*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7350******************************************************************
  7351******************************************************************
  7352*                   C H A N G E   L O G
  7353*
  7354* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7355*-----------------------------------------------------------------
  7356*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7357* EFFECTIVE    NUMBER
  7358*-----------------------------------------------------------------
  7359* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7360* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7361******************************************************************
  7362
  7363 01  PENDING-PAY-ADJ.
  7364     12  PY-RECORD-ID                     PIC XX.
  7365         88  VALID-PY-ID                        VALUE 'PY'.
  7366
  7367     12  PY-CONTROL-PRIMARY.
  7368         16  PY-COMPANY-CD                PIC X.
  7369         16  PY-CARRIER                   PIC X.
  7370         16  PY-GROUPING                  PIC X(6).
  7371         16  PY-FIN-RESP                  PIC X(10).
  7372         16  PY-ACCOUNT                   PIC X(10).
  7373         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7374                                          PIC X(10).
  7375         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7376         16  PY-RECORD-TYPE               PIC X.
  7377             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7378             88  PY-DEPOSIT                   VALUE 'D'.
  7379             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7380             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7381             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7382             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7383             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7384             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7385             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7386             88  PY-FICA-ENTRY                VALUE 'F'.
  7387             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7388             88  PY-POLICY-FEE                VALUE 'W'.
  7389             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 140
* EL689.cbl
  7390
  7391     12  PY-PYMT-TYPE                     PIC X.
  7392             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7393             88  PY-REINS-PYMT                VALUE 'R'.
  7394             88  PY-EXP-PYMT                  VALUE 'E'.
  7395
  7396     12  PY-BIL-INV                       PIC X(6).
  7397     12  PY-REF-NO                        PIC X(12).
  7398
  7399     12  PY-LAST-MAINT-DT                 PIC XX.
  7400     12  PY-LAST-MAINT-BY                 PIC X(4).
  7401     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7402
  7403     12  PY-PYADJ-RECORD.
  7404         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7405         16  PY-ENTRY-COMMENT             PIC X(30).
  7406         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7407             20  PY-GL-ACCOUNT            PIC X(10).
  7408             20  PY-GL-STATE              PIC X(02).
  7409             20  PY-GL-CANC-SW            PIC X(01).
  7410                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7411                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7412             20  PY-GL-COMMENT            PIC X(10).
  7413             20  FILLER      REDEFINES PY-GL-COMMENT.
  7414                 24  PY-GL-CHECK-NO       PIC 9(06).
  7415                 24  FILLER               PIC X(04).
  7416             20  FILLER                   PIC X(07).
  7417         16  PY-SAVE-ACCOUNT              PIC X(10).
  7418         16  PY-SAVE-TYPE                 PIC X(01).
  7419
  7420         16  PY-LETTERS.
  7421             20  PY-LETTER OCCURS 3 TIMES
  7422                           INDEXED BY PY-LET-NDX
  7423                                          PIC X(04).
  7424
  7425         16  PY-ERCOMP-TYPE               PIC X.
  7426             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7427             88  PY-GA-TYPE                   VALUE 'G'.
  7428             88  PY-BANK-TYPE                 VALUE 'B'.
  7429         16  FILLER                       PIC X(05).
  7430
  7431     12  PY-RECORD-STATUS.
  7432         16  PY-CREDIT-SELECT-DT          PIC XX.
  7433         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7434         16  PY-BILLED-DATE               PIC XX.
  7435         16  PY-REPORTED-DT               PIC XX.
  7436         16  PY-PMT-APPLIED               PIC X.
  7437             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7438             88  PY-GA-PMT                    VALUE 'G'.
  7439             88  PY-OVWRITE-PMT               VALUE 'O'.
  7440             88  PY-NON-AR-PMT                VALUE 'N'.
  7441         16  FILLER                       PIC X(5).
  7442         16  PY-INPUT-DT                  PIC XX.
  7443         16  PY-CHECK-NUMBER              PIC X(6).
  7444         16  PY-VOID-SW                   PIC X.
  7445             88  PY-CHECK-VOIDED              VALUE 'V'.
  7446         16  PY-CHECK-ORIGIN-SW           PIC X.
  7447             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 141
* EL689.cbl
  7448             88  PY-REFUND-CHECK              VALUE 'R'.
  7449             88  PY-GA-CHECK                  VALUE 'G'.
  7450             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7451             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7452         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7453         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7454         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7455         16  PY-BILL-FLAG                 PIC X.
  7456             88  PY-BILLED                    VALUE 'B'.
  7457         16  PY-AR-FLAG                   PIC X.
  7458             88  PY-AR-CYCLE                  VALUE 'C'.
  7459             88  PY-AR-MONTH-END              VALUE 'M'.
  7460         16  PY-AR-DATE                   PIC XX.
  7461
  7462     12  PY-GL-CODES.
  7463         16  PY-GL-DB                     PIC X(14).
  7464         16  PY-GL-CR                     PIC X(14).
  7465         16  PY-GL-FLAG                   PIC X.
  7466         16  PY-GL-DATE                   PIC XX.
  7467
  7468     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7469     12  FILLER                           PIC X(3).
  7470******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 142
* EL689.cbl
  7472*    COPY ELCTEXT.
  7473******************************************************************
  7474*                                                                *
  7475*                                                                *
  7476*                            ELCTEXT.                            *
  7477*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7478*                            VMOD=2.008                          *
  7479*                                                                *
  7480*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  7481*                                     FORM LETTERS,              *
  7482*                                     CERT FORM DISPLAY.
  7483*                                                                *
  7484*   FILE TYPE = VSAM,KSDS                                        *
  7485*   RECORD SIZE = 100   RECFORM = FIXED                          *
  7486*                                                                *
  7487*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  7488*       ALTERNATE INDEX = NONE                                   *
  7489*                                                                *
  7490*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  7491*       ALTERNATE INDEX = NONE                                   *
  7492*                                                                *
  7493*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  7494*       ALTERNATE INDEX = NONE                                   *
  7495*                                                                *
  7496*   LOG = NO                                                     *
  7497*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7498******************************************************************
  7499 01  TEXT-FILES.
  7500     12  TEXT-FILE-ID                PIC XX.
  7501         88  FORMS-FILE-TEXT            VALUE 'TF'.
  7502         88  LETTER-FILE-TEXT           VALUE 'TL'.
  7503         88  HELP-FILE-TEXT             VALUE 'TH'.
  7504
  7505     12  TX-CONTROL-PRIMARY.
  7506         16  TX-COMPANY-CD           PIC X.
  7507             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  7508         16  TX-ACCESS-CD-GENL       PIC X(12).
  7509
  7510         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7511             20  TX-LETTER-NO        PIC X(4).
  7512             20  FILLER              PIC X(8).
  7513
  7514         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7515             20  TX-FORM-NO          PIC X(12).
  7516
  7517         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  7518             20  TX-HELP-TYPE        PIC X.
  7519                 88  HELP-FOR-GENERAL   VALUE ' '.
  7520                 88  HELP-BY-SCREEN     VALUE 'S'.
  7521                 88  HELP-BY-ERROR      VALUE 'E'.
  7522             20  TX-SCREEN-OR-ERROR  PIC X(4).
  7523                 88  GENERAL-INFO-HELP  VALUE '0000'.
  7524             20  TX-HELP-FOR-COMPANY  PIC XXX.
  7525                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  7526             20  FILLER              PIC X(4).
  7527
  7528         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  7529
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 143
* EL689.cbl
  7530     12  TX-PROCESS-CONTROL          PIC XX.
  7531         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  7532
  7533     12  TX-TEXT-LINE                PIC X(70).
  7534
  7535     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  7536         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  7537         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  7538         88  TX-VALID-FORM-SQUEEZE-VALUE
  7539                                        VALUE 'Y' ' '.
  7540
  7541     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  7542         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  7543         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  7544         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  7545         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  7546         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  7547         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  7548         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  7549                                              'K' 'N' ' '
  7550                                              'Z'.
  7551
  7552     12  TX-ARCHIVE-SW               PIC X.
  7553         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  7554         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  7555         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  7556
  7557     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  7558     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  7559
  7560     12  TX-BSR-CODE                 PIC X.
  7561         88  TX-BSR-LETTER              VALUE 'B'.
  7562         88  TX-NON-BSR-LETTER          VALUE ' '.
  7563
  7564     12  FILLER                      PIC X.
  7565*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 144
* EL689.cbl
  7567 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  7568                          LETTER-ARCHIVE LETTER-ARCHIVE-TEXT
  7569                          CERTIFICATE-MASTER CHECK-RECORDS
  7570                          CONTROL-FILE COMPENSATION-MASTER
  7571                          MAILING-DATA PENDING-BUSINESS
  7572                          PENDING-PAY-ADJ TEXT-FILES.
  7573 0000-DFHEXIT SECTION.
  7574     MOVE '9#                    $   ' TO DFHEIV0.
  7575     MOVE 'EL689' TO DFHEIV1.
  7576     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7577     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7578
  7579     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7580     MOVE '5'                    TO DC-OPTION-CODE.
  7581     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  7582     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  7583     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  7584                                    W-CURRENT-SAVE.
  7585
  7586     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  7587     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  7588                                 TO EMI-SAVE-AREA.
  7589
  7590     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  7591                                    W-TS-TERM-SCREEN.
  7592
  7593     IF  EIBCALEN EQUAL 0
  7594         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  7595         GO TO 8300-SEND-TEXT
  7596     END-IF.
  7597
  7598     IF  PI-689-CREATE-NO-SCREENS
  7599         GO TO 0600-BYPASS-SCREEN-CNTL
  7600     END-IF.
  7601
  7602     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  7603         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  7604             MOVE PI-SAVED-PROGRAM-5
  7605                                 TO PI-SAVED-PROGRAM-6
  7606             MOVE PI-SAVED-PROGRAM-4
  7607                                 TO PI-SAVED-PROGRAM-5
  7608             MOVE PI-SAVED-PROGRAM-3
  7609                                 TO PI-SAVED-PROGRAM-4
  7610             MOVE PI-SAVED-PROGRAM-2
  7611                                 TO PI-SAVED-PROGRAM-3
  7612             MOVE PI-SAVED-PROGRAM-1
  7613                                 TO PI-SAVED-PROGRAM-2
  7614             MOVE PI-RETURN-TO-PROGRAM
  7615                                 TO PI-SAVED-PROGRAM-1
  7616             MOVE PI-CALLING-PROGRAM
  7617                                 TO PI-RETURN-TO-PROGRAM
  7618             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  7619             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  7620             MOVE LOW-VALUES     TO EL689AO
  7621             PERFORM 9905-INITIALIZE-SECURITY THRU 9905-EXIT
  7622             IF PI-689-ARCHIVE-NUMBER NOT NUMERIC
  7623                MOVE ZEROS       TO PI-689-ARCHIVE-NUMBEr
  7624             END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 145
* EL689.cbl
  7625             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  7626                     AND
  7627                 PI-689-KEY-DATA-FIELDS GREATER THAN LOW-VALUES
  7628                 GO TO 0400-EL6311-INCOMING
  7629             ELSE
  7630                 MOVE PI-689-ARCHIVE-NUMBER
  7631                                 TO W-INCOMING-ARCHIVE
  7632                 MOVE LOW-VALUES TO PI-1042-WA
  7633                                    PI-689-WORK-AREA
  7634                 MOVE ZEROS      TO PI-CURRENT-LINE
  7635                                    PI-TEMP-STOR-ITEMS
  7636                                    PI-TOTAL-LINES
  7637                                    PI-UPDATE-SW
  7638                                    PI-689-NUMBER-LABEL-LINES
  7639                                    PI-689-NUMBER-TEXT-RECORDS
  7640                                    PI-689-ERROR
  7641                 MOVE SPACES     TO PI-689-PRINT-SW
  7642                                    PI-689-ALT-PRINTER-ID
  7643                                    PI-689-LBL-OVERRIDE
  7644                                    PI-COMM-CONTROL
  7645                                    PI-689-FORM-NUMBER
  7646                                    PI-689-TEMP-STOR-ID
  7647                                    PI-689-LABEL-SOURCE
  7648                                    PI-689-USE-SCREEN-IND
  7649                 MOVE '2'        TO PI-ACTION
  7650                 MOVE -1         TO MAINTL
  7651                 MOVE PI-LOWER-CASE-LETTERS
  7652                                 TO W-LC-CASE-IND
  7653                 IF  W-INCOMING-ARCHIVE NUMERIC
  7654                         AND
  7655                     W-INCOMING-ARCH-NO GREATER THAN ZEROS
  7656                     MOVE 'S'    TO MAINTI
  7657                     MOVE +1     TO MAINTL
  7658                     MOVE AL-UANON
  7659                                 TO MAINTA
  7660                     MOVE W-INCOMING-ARCH-NO
  7661                                 TO ARCHNUMI
  7662                     MOVE +8     TO ARCHNUML
  7663                     MOVE AL-UNNON
  7664                                 TO ARCHNUMA
  7665                     GO TO 1000-SHOW
  7666                 ELSE
  7667                     GO TO 0450-SPECIAL-INPUT-PROCESS
  7668                 END-IF
  7669             END-IF
  7670         ELSE
  7671             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  7672             MOVE PI-RETURN-TO-PROGRAM
  7673                                     TO PI-CALLING-PROGRAM
  7674             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  7675             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  7676             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  7677             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  7678             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  7679             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  7680             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  7681             PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  7682             MOVE LOW-VALUES         TO EL689AO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 146
* EL689.cbl
  7683             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  7684             SET W-RG-NDX            TO PI-CURRENT-LINE
  7685             PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  7686                 VARYING
  7687                     W-SC-NDX FROM 1 BY 1
  7688                 UNTIL
  7689                     W-SC-NDX GREATER THAN
  7690                     W-NUM-LINES-PER-SCREEN
  7691             MOVE PI-689-ALT-PRINTER-ID
  7692                                     TO PRINTERO
  7693             MOVE AL-UANON           TO PRINTERA
  7694             MOVE -1                 TO PRINTERL
  7695             GO TO 8100-SEND-INITIAL-MAP
  7696         END-IF
  7697     END-IF.
  7698
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 147
* EL689.cbl
  7700 0200-RECEIVE.
  7701
  7702     MOVE PI-689-FATAL-CTR       TO EMI-FATAL-CTR
  7703     MOVE PI-689-FORCABLE-CTR    TO EMI-FORCABLE-CTR
  7704     IF  EMI-FATAL-CTR GREATER THAN ZEROS
  7705             OR
  7706         EMI-FORCABLE-CTR GREATER THAN ZEROS
  7707         MOVE 'Y'                TO W-HOLD-IND.
  7708
  7709     MOVE W-TRANSACTION          TO EIBTRNID.
  7710     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  7711     MOVE ZEROS                  TO W-LAST-ERROR.
  7712     MOVE LOW-VALUES             TO EL689AI.
  7713     MOVE '104A'                 TO W-TS-ID-TEXT.
  7714     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  7715                                    W-TS-TERM-SCREEN.
  7716
  7717
  7718* EXEC CICS HANDLE AID
  7719*        CLEAR    (9300-DFHCLEAR)
  7720*        PA1      (9200-PA)
  7721*        PA2      (9200-PA)
  7722*        PA3      (9200-PA)
  7723*    END-EXEC.
  7724*    MOVE '"&=!"#               V! " #00007713' TO DFHEIV0
  7725     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  7726     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  7727     MOVE X'2220233030303037373133' TO DFHEIV0(25:11)
  7728     CALL 'kxdfhei1' USING DFHEIV0
  7729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7730
  7731
  7732
  7733* EXEC CICS HANDLE CONDITION
  7734*        PGMIDERR (9700-PGMID-ERROR)
  7735*        ERROR    (9800-ABEND)
  7736*        MAPFAIL  (0325-MAPFAIL)
  7737*    END-EXEC.
  7738*    MOVE '"$L.?                 ! # #00007720' TO DFHEIV0
  7739     MOVE X'22244C2E3F20202020202020' TO DFHEIV0(1:12)
  7740     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7741     MOVE X'2320233030303037373230' TO DFHEIV0(25:11)
  7742     CALL 'kxdfhei1' USING DFHEIV0
  7743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7744
  7745
  7746
  7747* EXEC CICS SYNCPOINT
  7748*    END-EXEC.
  7749*    MOVE '6"                    !   #00007726' TO DFHEIV0
  7750     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7752     MOVE X'2020233030303037373236' TO DFHEIV0(25:11)
  7753     CALL 'kxdfhei1' USING DFHEIV0
  7754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7755
  7756
  7757     IF PI-LOWER-CASE-LETTERS = 'Y'
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 148
* EL689.cbl
  7758*    IF  W-LC-USE-BOTH-CASES
  7759
  7760* EXEC CICS RECEIVE
  7761*            MAP      (W-MAP)
  7762*            MAPSET   (W-MAPSET)
  7763*            INTO     (EL689AI)
  7764*            ASIS
  7765*        END-EXEC
  7766     MOVE LENGTH OF
  7767      EL689AI
  7768       TO DFHEIV11
  7769*    MOVE '8"TAI  L              ''   #00007731' TO DFHEIV0
  7770     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  7771     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7772     MOVE X'2020233030303037373331' TO DFHEIV0(25:11)
  7773     CALL 'kxdfhei1' USING DFHEIV0,
  7774           W-MAP,
  7775           EL689AI,
  7776           DFHEIV11,
  7777           W-MAPSET,
  7778           DFHEIV99,
  7779           DFHEIV99
  7780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7781     ELSE
  7782
  7783* EXEC CICS RECEIVE
  7784*            MAP      (W-MAP)
  7785*            MAPSET   (W-MAPSET)
  7786*            INTO     (EL689AI)
  7787*        END-EXEC.
  7788     MOVE LENGTH OF
  7789      EL689AI
  7790       TO DFHEIV11
  7791*    MOVE '8"T I  L              ''   #00007738' TO DFHEIV0
  7792     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7793     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7794     MOVE X'2020233030303037373338' TO DFHEIV0(25:11)
  7795     CALL 'kxdfhei1' USING DFHEIV0,
  7796           W-MAP,
  7797           EL689AI,
  7798           DFHEIV11,
  7799           W-MAPSET,
  7800           DFHEIV99,
  7801           DFHEIV99
  7802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7803
  7804
  7805     IF  NOT DISPLAY-CAP
  7806         MOVE 'READ'             TO SM-READ
  7807         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  7808         MOVE ER-9097            TO EMI-ERROR
  7809         MOVE -1                 TO MAINTL
  7810         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7811         GO TO 8100-SEND-INITIAL-MAP.
  7812
  7813     INSPECT MAINTI CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
  7814
  7815     IF  ENTERPFL EQUAL 0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 149
* EL689.cbl
  7816         GO TO 0300-CHECK-PFKEYS.
  7817
  7818     IF  EIBAID NOT EQUAL DFHENTER
  7819         MOVE ER-0004            TO EMI-ERROR
  7820         GO TO 0320-INPUT-ERROR.
  7821
  7822     IF  ENTERPFI NUMERIC
  7823             AND
  7824         ENTERPFI GREATER THAN 0
  7825             AND
  7826         ENTERPFI LESS THAN 25
  7827         MOVE PF-VALUES (ENTERPFI)
  7828                                 TO EIBAID
  7829     ELSE
  7830         MOVE ER-0029            TO EMI-ERROR
  7831         GO TO 0320-INPUT-ERROR.
  7832
  7833 0300-CHECK-PFKEYS.
  7834
  7835     IF  EIBAID EQUAL DFHPF23
  7836         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  7837         MOVE ZEROS              TO PI-TOTAL-LINES
  7838                                    PI-CURRENT-LINE
  7839         MOVE EIBAID             TO PI-ENTRY-CD-1
  7840         MOVE W-XCTL-005         TO W-CALL-PGM
  7841         GO TO 9400-XCTL.
  7842
  7843     IF  EIBAID EQUAL DFHPF24
  7844         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  7845         MOVE ZEROS              TO PI-TOTAL-LINES
  7846                                    PI-CURRENT-LINE
  7847         MOVE W-XCTL-626         TO W-CALL-PGM
  7848         GO TO 9400-XCTL.
  7849
  7850     MOVE SPACES                 TO W-KEY-FIELDS-CHANGED-IND
  7851                                    W-FORM-CHANGED-IND.
  7852
  7853     IF  PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  7854             OR
  7855         PI-SHOW-MODE
  7856         NEXT SENTENCE
  7857     ELSE
  7858         IF  PI-689-FORM-NUMBER GREATER THAN SPACES
  7859                 AND
  7860             FORML NOT EQUAL ZEROS
  7861                 AND
  7862             PI-689-FORM-NUMBER NOT EQUAL FORMI
  7863             MOVE FORMI          TO PI-689-FORM-NUMBER
  7864             MOVE LOW-VALUES     TO EL689AI
  7865                                    PI-1042-WA
  7866                                    PI-689-FOLLOW-UP-DATE
  7867                                    PI-689-PRINT-RESTRICTION
  7868                                    PI-689-RESEND-DATE-1
  7869                                    PI-689-RESEND1-EDIT
  7870                                    PI-689-FOLLOW-UP-DATE
  7871                                    PI-689-FOLLOW-UP-EDIT
  7872                                    PI-689-ERROR-IND
  7873             MOVE ZEROS          TO PI-689-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 150
* EL689.cbl
  7874                                    PI-689-NUMBER-COPIES
  7875                                    PI-689-NUMBER-LABEL-LINES
  7876                                    PI-689-NUMBER-TEXT-RECORDS
  7877                                    PI-CURRENT-LINE
  7878                                    PI-TEMP-STOR-ITEMS
  7879                                    PI-TOTAL-LINES
  7880                                    PI-UPDATE-SW
  7881             MOVE SPACES         TO PI-689-PRINT-SW
  7882                                    PI-689-ALT-PRINTER-ID
  7883                                    PI-COMM-CONTROL
  7884                                    PI-689-TEMP-STOR-ID
  7885                                    PI-689-USE-SCREEN-IND
  7886                                    PI-689-RESEND-LETR-1
  7887             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  7888             MOVE DFHENTER       TO EIBAID
  7889             MOVE 'Y'            TO W-FORM-CHANGED-IND
  7890             GO TO 0330-FUNCTION-CHECK
  7891         ELSE
  7892             IF  PI-689-DATA-SOURCE NOT EQUAL DATASORI
  7893                     OR
  7894                 (PI-689-LABEL-SOURCE NOT EQUAL ADDRSI
  7895                         AND
  7896                     (PI-689-LABEL-SOURCE NOT EQUAL SPACES
  7897                             OR
  7898                         ADDRSI NOT EQUAL LOW-VALUES))
  7899                     OR
  7900                 PI-689-CARRIER NOT EQUAL CARRIERI
  7901                     OR
  7902                 PI-689-GROUPING NOT EQUAL GROUPI
  7903                     OR
  7904                 PI-689-STATE NOT EQUAL STATEI
  7905                     OR
  7906                 PI-689-ACCOUNT NOT EQUAL ACCTI
  7907                     OR
  7908                 PI-689-CERT-PRIME NOT EQUAL CERTI
  7909                     OR
  7910                 PI-689-CERT-SFX NOT EQUAL SFXI
  7911                     OR
  7912                 PI-689-TYPE NOT EQUAL TYPEI
  7913                     OR
  7914                 PI-689-DATE-EDIT NOT EQUAL DATEI
  7915                     OR
  7916                 PI-689-RESP-PERSON NOT EQUAL RPERSONI
  7917                     OR
  7918                 PI-689-SEQ-EDIT NOT EQUAL SEQI
  7919                     OR
  7920                 PI-689-ENTRY-BATCH NOT EQUAL BENTRYI
  7921                     OR
  7922                 PI-689-BCSEQ-EDIT NOT EQUAL BCSEQI
  7923                 MOVE 'Y'        TO W-KEY-FIELDS-CHANGED-IND
  7924                 MOVE DFHENTER   TO EIBAID
  7925                 GO TO 0330-FUNCTION-CHECK.
  7926
  7927     IF  EIBAID EQUAL DFHPF1
  7928         MOVE +7                 TO W-ROLL-COUNTER
  7929         GO TO 4000-ROLL-PAGE.
  7930
  7931     IF  EIBAID EQUAL DFHPF2
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 151
* EL689.cbl
  7932         MOVE -7                 TO W-ROLL-COUNTER
  7933         GO TO 4000-ROLL-PAGE.
  7934
  7935     IF  EIBAID EQUAL DFHPF3
  7936         IF  W-HOLD-ON
  7937             MOVE ER-7245        TO EMI-ERROR
  7938             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7939             MOVE -1             TO MAINTL
  7940             MOVE AL-UABON       TO MAINTA
  7941             GO TO 8200-SEND-DATAONLY
  7942         ELSE
  7943             GO TO 0330-FUNCTION-CHECK.
  7944     IF (EIBAID = DFHPF8)
  7945        AND (PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR
  7946          'CAGB' OR 'DLVA' OR 'ECCA' OR 'KRHA' OR 'ALWA')
  7947        MOVE ER-0029             TO EMI-ERROR
  7948        GO TO 0320-INPUT-ERROR
  7949     END-IF
  7950     IF EIBAID = DFHPF4 OR DFHPF8
  7951         IF  W-HOLD-ON
  7952             MOVE ER-7245        TO EMI-ERROR
  7953             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7954             MOVE -1             TO MAINTL
  7955             MOVE AL-UABON       TO MAINTA
  7956             GO TO 8200-SEND-DATAONLY
  7957         ELSE
  7958             GO TO 0330-FUNCTION-CHECK.
  7959
  7960     IF  EIBAID = DFHPF5
  7961         COMPUTE W-ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  7962         GO TO 4000-ROLL-PAGE.
  7963
  7964     IF  EIBAID = DFHPF6
  7965         MOVE PI-TOTAL-LINES     TO W-ROLL-COUNTER
  7966         GO TO 4000-ROLL-PAGE.
  7967
  7968     IF  EIBAID EQUAL DFHPF7
  7969         IF  W-HOLD-ON
  7970             MOVE ER-7245        TO EMI-ERROR
  7971             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7972             MOVE -1             TO MAINTL
  7973             MOVE AL-UABON       TO MAINTA
  7974             GO TO 8200-SEND-DATAONLY
  7975         ELSE
  7976             GO TO 0330-FUNCTION-CHECK.
  7977
  7978     IF  EIBAID EQUAL DFHENTER
  7979         GO TO 0330-FUNCTION-CHECK.
  7980
  7981     MOVE ER-0029                TO EMI-ERROR.
  7982
  7983 0320-INPUT-ERROR.
  7984
  7985     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7986
  7987     IF  ENTERPFL EQUAL 0
  7988         MOVE -1                 TO MAINTL
  7989         MOVE AL-UABON           TO MAINTA
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 152
* EL689.cbl
  7990     ELSE
  7991         MOVE AL-UNBON           TO ENTERPFA
  7992         MOVE -1                 TO ENTERPFL.
  7993
  7994     GO TO 8200-SEND-DATAONLY.
  7995
  7996 0325-MAPFAIL.
  7997***********************************************************
  7998*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  7999*      LETTERS ON A 3275 PRINTER.                         *
  8000***********************************************************
  8001
  8002     PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8003
  8004     SET W-RG-NDX                TO PI-CURRENT-LINE.
  8005     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8006             VARYING
  8007         W-SC-NDX FROM 1 BY 1
  8008             UNTIL
  8009         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  8010
  8011     MOVE -1                     TO MAINTL.
  8012     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 153
* EL689.cbl
  8014 0330-FUNCTION-CHECK.
  8015
  8016     IF  MAINTI EQUAL 'S'
  8017         IF EIBAID = DFHPF4 OR DFHPF8
  8018             GO TO 7900-PRINT-LETTER-NOW
  8019         ELSE
  8020             GO TO 1000-SHOW.
  8021
  8022     IF  NOT MODIFY-CAP
  8023         MOVE 'UPDATE'           TO SM-READ
  8024         PERFORM 9995-SECURITY-VIOLATION
  8025         MOVE ER-0070            TO EMI-ERROR
  8026         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8027         MOVE -1                 TO MAINTL
  8028         GO TO 8100-SEND-INITIAL-MAP.
  8029
  8030     IF  W-FORM-CHANGED
  8031             OR
  8032         W-KEY-FIELDS-CHANGED
  8033         GO TO 0330-EDIT.
  8034
  8035     IF  EIBAID EQUAL DFHPF3
  8036         IF  PI-NO-CARRIER-SECURITY
  8037                 AND
  8038             PI-NO-ACCOUNT-SECURITY
  8039             GO TO 5000-EDIT-MODE.
  8040
  8041     IF  EIBAID EQUAL DFHPF7
  8042         IF  PI-NO-CARRIER-SECURITY
  8043                 AND
  8044             PI-NO-ACCOUNT-SECURITY
  8045             GO TO 5400-LETTER-RELEASE
  8046         ELSE
  8047             IF  PI-689-PRINT-PERFORMED
  8048                 GO TO 5400-LETTER-RELEASE
  8049             ELSE
  8050                 MOVE AL-UNBON TO ENTERPFA
  8051                 MOVE -1       TO ENTERPFL
  8052                 MOVE ER-2398  TO EMI-ERROR
  8053                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8054                 GO TO 8200-SEND-DATAONLY.
  8055
  8056     IF  EIBAID = DFHPF4 OR DFHPF8
  8057         GO TO 7900-PRINT-LETTER-NOW.
  8058
  8059 0330-EDIT.
  8060
  8061     IF  W-SC-TEXTL (1) NOT EQUAL ZEROS
  8062             OR
  8063         W-SC-TEXTL (2) NOT EQUAL ZEROS
  8064             OR
  8065         W-SC-TEXTL (3) NOT EQUAL ZEROS
  8066             OR
  8067         W-SC-TEXTL (4) NOT EQUAL ZEROS
  8068             OR
  8069         W-SC-TEXTL (5) NOT EQUAL ZEROS
  8070             OR
  8071         W-SC-TEXTL (6) NOT EQUAL ZEROS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 154
* EL689.cbl
  8072             OR
  8073         W-SC-TEXTL (7) NOT EQUAL ZEROS
  8074             OR
  8075         W-SC-TEXTL (8) NOT EQUAL ZEROS
  8076             OR
  8077         W-SC-TEXTL (9) NOT EQUAL ZEROS
  8078             OR
  8079         W-SC-TEXTL (10) NOT EQUAL ZEROS
  8080             OR
  8081         W-SC-TEXTL (11) NOT EQUAL ZEROS
  8082         IF  W-KEY-FIELDS-CHANGED
  8083                 OR
  8084             W-FORM-CHANGED
  8085             MOVE ER-7250        TO EMI-ERROR
  8086             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8087             MOVE -1             TO MAINTL
  8088             MOVE AL-UABON       TO MAINTA
  8089         ELSE
  8090             PERFORM 4100-SET-NDX THRU 4100-EXIT
  8091             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
  8092                     VARYING
  8093                 W-SC-NDX FROM 1 BY 1
  8094                     UNTIL
  8095                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
  8096             MOVE ER-7398        TO EMI-ERROR
  8097             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8098             MOVE -1             TO MAINTL
  8099             MOVE AL-UABON       TO MAINTA
  8100             GO TO 8200-SEND-DATAONLY.
  8101
  8102     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  8103
  8104     IF  W-KEY-FIELDS-CHANGED
  8105             OR
  8106         PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8107         PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8108         IF  MAINTI EQUAL 'C'
  8109             GO TO 2000-CREATE
  8110         ELSE
  8111             NEXT SENTENCE
  8112     ELSE
  8113         IF  W-FORM-CHANGED
  8114             PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  8115             IF  MAINTI EQUAL 'C'
  8116                 GO TO 2000-CREATE
  8117             ELSE
  8118                 NEXT SENTENCE
  8119         ELSE
  8120             MOVE -1             TO MAINTL
  8121             GO TO 8200-SEND-DATAONLY.
  8122
  8123     MOVE ER-0023                TO EMI-ERROR.
  8124     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8125     MOVE -1                     TO MAINTL.
  8126     MOVE AL-UABON               TO MAINTA.
  8127     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 155
* EL689.cbl
  8129 0350-EDIT-ROUTINE.
  8130
  8131     IF  MAINTI EQUAL 'C'
  8132             AND
  8133         FORML EQUAL ZEROS
  8134         MOVE -1                 TO FORML
  8135         MOVE ER-0177            TO EMI-ERROR
  8136         MOVE AL-UABON           TO FORMA
  8137         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8138
  8139     IF  PRTRESTL NOT EQUAL ZEROS
  8140         PERFORM 0360-EDIT-PRINT-RESTRICTIONS THRU 0360-EXIT.
  8141
  8142     IF  FOLLOWL NOT EQUAL ZEROS
  8143         MOVE FOLLOWI            TO W-DEEDIT-FIELD
  8144         PERFORM 8600-DEEDIT
  8145         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8146         MOVE '4'                TO DC-OPTION-CODE
  8147         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8148         IF  DATE-CONVERSION-ERROR
  8149             MOVE ER-0182        TO EMI-ERROR
  8150             MOVE -1             TO FOLLOWL
  8151             MOVE AL-UABON       TO FOLLOWA
  8152             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8153         ELSE
  8154             MOVE DC-GREG-DATE-1-EDIT
  8155                                 TO FOLLOWO
  8156                                    PI-689-FOLLOW-UP-EDIT
  8157             MOVE AL-UANON       TO FOLLOWA
  8158             MOVE DC-BIN-DATE-1  TO PI-689-FOLLOW-UP-DATE
  8159     ELSE
  8160         MOVE LOW-VALUES         TO PI-689-FOLLOW-UP-DATE.
  8161
  8162     IF  PI-689-FOLLOW-UP-DATE NOT EQUAL LOW-VALUES
  8163         IF  PI-689-FOLLOW-UP-DATE NOT GREATER THAN
  8164                 W-SAVE-BIN-DATE
  8165             MOVE ER-0533        TO EMI-ERROR
  8166             MOVE AL-UABON       TO FOLLOWA
  8167             MOVE -1             TO FOLLOWL
  8168             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8169
  8170     IF  RESEND1L NOT EQUAL ZEROS
  8171         MOVE RESEND1I           TO W-DEEDIT-FIELD
  8172         PERFORM 8600-DEEDIT
  8173         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  8174         MOVE '4'                TO DC-OPTION-CODE
  8175         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8176         IF  DATE-CONVERSION-ERROR
  8177             MOVE ER-0185        TO EMI-ERROR
  8178             MOVE -1             TO RESEND1L
  8179             MOVE AL-UABON       TO RESEND1A
  8180             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8181         ELSE
  8182             MOVE DC-GREG-DATE-1-EDIT
  8183                                 TO RESEND1O
  8184                                    PI-689-RESEND1-EDIT
  8185             MOVE AL-UANON       TO RESEND1A
  8186             MOVE DC-BIN-DATE-1  TO PI-689-RESEND-DATE-1
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 156
* EL689.cbl
  8187     ELSE
  8188         MOVE LOW-VALUES         TO PI-689-RESEND-DATE-1.
  8189
  8190     IF  PI-689-RESEND-DATE-1 NOT EQUAL LOW-VALUES
  8191         IF  PI-689-RESEND-DATE-1 NOT GREATER THAN
  8192                 W-SAVE-BIN-DATE
  8193             MOVE ER-0537        TO EMI-ERROR
  8194             MOVE AL-UABON       TO RESEND1A
  8195             MOVE -1             TO RESEND1L
  8196             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8197
  8198     IF NOT PI-CREATE-LABELS
  8199         MOVE PI-LABEL-CONTROL   TO ADDRLBLI
  8200         MOVE AL-PANON           TO ADDRLBLA
  8201         GO TO 0350-BYPASS-OVERRIDE.
  8202
  8203     IF  ADDRLBLL GREATER THAN ZEROS
  8204          INSPECT ADDRLBLI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8205          IF ADDRLBLI = 'N' OR 'Y'
  8206              MOVE ADDRLBLI      TO PI-689-LBL-OVERRIDE
  8207              MOVE AL-UANON      TO ADDRLBLA
  8208          ELSE
  8209             MOVE ER-3783        TO EMI-ERROR
  8210             MOVE -1             TO ADDRLBLL
  8211             MOVE AL-UABON       TO ADDRLBLA
  8212             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8213
  8214 0350-BYPASS-OVERRIDE.
  8215
  8216     IF  PI-BYPASS-LABELS
  8217             OR
  8218         FORMI EQUAL '9999'
  8219             OR
  8220         PI-689-LABELS-OVERRIDEN
  8221         MOVE SPACES             TO PI-689-LABEL-SOURCE
  8222         MOVE LOW-VALUES         TO ADDRSI
  8223         MOVE AL-UANOF           TO ADDRSA
  8224         MOVE ZEROS              TO ADDRSL
  8225     ELSE
  8226         IF  ADDRSL GREATER THAN ZEROS
  8227             MOVE ADDRSI         TO W-LABEL-SOURCE
  8228             IF  W-LABEL-SOURCE-VALID
  8229                 MOVE ADDRSI     TO PI-689-LABEL-SOURCE
  8230             ELSE
  8231                 MOVE -1         TO ADDRSL
  8232                 MOVE ER-0176    TO EMI-ERROR
  8233                 MOVE AL-UABON   TO ADDRSA
  8234                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8235         ELSE
  8236             IF  MAINTI EQUAL 'C'
  8237                 MOVE -1         TO ADDRSL
  8238                 MOVE ER-0176    TO EMI-ERROR
  8239                 MOVE AL-UABON   TO ADDRSA
  8240                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8241
  8242     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  8243     IF  PRINTERL GREATER ZERO
  8244         INSPECT PRINTERI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 157
* EL689.cbl
  8245         MOVE AL-UANON           TO PRINTERA
  8246         MOVE PRINTERI           TO PI-689-ALT-PRINTER-ID
  8247                                    PI-ALT-DMD-PRT-ID
  8248     ELSE
  8249         IF  PI-NO-CARRIER-SECURITY
  8250                 AND
  8251             PI-NO-ACCOUNT-SECURITY
  8252             IF  PI-PROCESSOR-PRINTER GREATER THAN SPACES
  8253                 MOVE PI-PROCESSOR-PRINTER
  8254                                 TO PI-689-ALT-PRINTER-ID
  8255                                    PRINTERI
  8256                 MOVE AL-UABON   TO PRINTERA
  8257             ELSE
  8258                 MOVE PI-COMPANY-ID
  8259                                 TO W-CNTL-COMPANY-ID
  8260                 MOVE '1'        TO W-CNTL-RECORD-TYPE
  8261                 MOVE SPACES     TO W-CNTL-GENL
  8262                 MOVE ZEROS      TO W-CNTL-SEQ-NO
  8263
  8264* EXEC CICS HANDLE CONDITION
  8265*                     NOTOPEN    (8040-CNTL-NOT-OPEN)
  8266*                     NOTFND     (7945-NOT-FOUND)
  8267*                END-EXEC
  8268*    MOVE '"$JI                  ! $ #00008202' TO DFHEIV0
  8269     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  8270     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8271     MOVE X'2420233030303038323032' TO DFHEIV0(25:11)
  8272     CALL 'kxdfhei1' USING DFHEIV0
  8273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8274
  8275* EXEC CICS READ
  8276*                     DATASET    (W-CNTL-FILE-ID)
  8277*                     SET        (ADDRESS OF CONTROL-FILE)
  8278*                     RIDFLD     (W-CNTL-KEY)
  8279*                END-EXEC
  8280*    MOVE '&"S        E          (   #00008206' TO DFHEIV0
  8281     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8282     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8283     MOVE X'2020233030303038323036' TO DFHEIV0(25:11)
  8284     CALL 'kxdfhei1' USING DFHEIV0,
  8285           W-CNTL-FILE-ID,
  8286           DFHEIV20,
  8287           DFHEIV99,
  8288           W-CNTL-KEY,
  8289           DFHEIV99,
  8290           DFHEIV99,
  8291           DFHEIV99
  8292     SET ADDRESS OF CONTROL-FILE TO
  8293         DFHEIV20
  8294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8295                 MOVE CF-FORMS-PRINTER-ID
  8296                                 TO PI-689-ALT-PRINTER-ID
  8297                                    PRINTERI
  8298                                    W-TS-TERM-TEXT
  8299                 MOVE AL-UABON   TO PRINTERA
  8300         ELSE
  8301             MOVE AL-UABON       TO PRINTERA
  8302             MOVE -1             TO PRINTERL
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 158
* EL689.cbl
  8303             MOVE ER-9283        TO EMI-ERROR
  8304             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8305
  8306     IF  COPIESL NOT EQUAL ZEROS
  8307         IF  COPIESI NOT NUMERIC
  8308                 OR
  8309             COPIESI EQUAL '0'
  8310             MOVE ER-0184        TO EMI-ERROR
  8311             MOVE -1             TO COPIESL
  8312             MOVE AL-UABON       TO COPIESA
  8313             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8314         ELSE
  8315             MOVE COPIESI        TO PI-689-NUMBER-COPIES
  8316             MOVE AL-UANON       TO COPIESA
  8317     ELSE
  8318         IF FORMI EQUAL '9999'
  8319             MOVE 1              TO PI-689-NUMBER-COPIES
  8320                                    COPIESL
  8321                                    COPIESO.
  8322
  8323     IF  FORML NOT EQUAL ZEROS
  8324         INSPECT FORMI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  8325         MOVE FORMI              TO PI-689-FORM-NUMBER.
  8326
  8327     MOVE SPACES                 TO W-HOLD-IND.
  8328
  8329     IF  NOT EMI-NO-ERRORS
  8330         IF  EMI-ERROR EQUAL ER-7250
  8331             GO TO 0350-EXIT
  8332         ELSE
  8333            MOVE -1             TO MAINTL
  8334            GO TO 8200-SEND-DATAONLY.
  8335
  8336 0350-EXIT.
  8337      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 159
* EL689.cbl
  8339 0360-EDIT-PRINT-RESTRICTIONS.
  8340
  8341     INSPECT PRTRESTI CONVERTING W-LOWER-CASE
  8342                                 TO W-UPPER-CASE.
  8343
  8344     IF  (PI-689-PRINT-RESTRICTION EQUAL ' ' OR 'F'
  8345                                      OR 'P' OR LOW-VALUES)
  8346             AND
  8347         PRTRESTI EQUAL 'C'
  8348             AND
  8349         PI-689-CONTROL NOT GREATER THAN ZEROS
  8350         MOVE ER-7243            TO EMI-ERROR
  8351         MOVE -1                 TO PRTRESTL
  8352         MOVE AL-UABON           TO PRTRESTA
  8353         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8354         GO TO 0360-EXIT.
  8355
  8356     IF  PRTRESTL NOT EQUAL ZEROS
  8357         IF PRTRESTI = 'C' OR 'F' OR 'P'
  8358             MOVE PRTRESTI       TO PI-689-PRINT-RESTRICTION
  8359             MOVE AL-UANON       TO PRTRESTA
  8360         ELSE
  8361             IF  PRTRESTI EQUAL ' '
  8362                 MOVE SPACES     TO PI-689-PRINT-RESTRICTION
  8363                 MOVE AL-UANON   TO PRTRESTA
  8364             ELSE
  8365                 MOVE ER-7393    TO EMI-ERROR
  8366                 MOVE -1         TO PRTRESTL
  8367                 MOVE AL-UABON   TO PRTRESTA
  8368                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8369
  8370     IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
  8371             AND
  8372         W-HOLD-ON
  8373             AND
  8374         PI-689-CONTROL NOT GREATER THAN ZEROS
  8375         MOVE ER-7243            TO EMI-ERROR
  8376         MOVE -1                 TO PRTRESTL
  8377         MOVE AL-UABON           TO PRTRESTA
  8378         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8379
  8380 0360-EXIT.
  8381      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 160
* EL689.cbl
  8383 0400-EL6311-INCOMING.
  8384
  8385     MOVE ZEROS                  TO PI-CURRENT-LINE
  8386                                    PI-TEMP-STOR-ITEMS
  8387                                    PI-TOTAL-LINES
  8388                                    PI-UPDATE-SW
  8389                                    PI-689-NUMBER-LABEL-LINES
  8390                                    PI-689-ERROR
  8391                                    PI-689-NUMBER-TEXT-RECORDS.
  8392     MOVE SPACES                 TO PI-689-PRINT-SW
  8393                                    PI-689-ALT-PRINTER-ID
  8394                                    PI-COMM-CONTROL
  8395                                    PI-689-FORM-NUMBER
  8396                                    PI-689-TEMP-STOR-ID
  8397                                    PI-689-LABEL-SOURCE
  8398                                    PI-689-USE-SCREEN-IND.
  8399
  8400     IF PI-CREATE-LABELS
  8401         MOVE  AL-UANON          TO ADDRLBLA
  8402         MOVE  +1                TO ADDRLBLL.
  8403
  8404     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  8405                                    PI-689-LBL-OVERRIDE.
  8406
  8407     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  8408     MOVE '2'                    TO PI-ACTION.
  8409     MOVE -1                     TO MAINTL.
  8410
  8411     IF  PI-689-CARRIER NOT EQUAL LOW-VALUES
  8412         MOVE AL-UANON           TO CARRIERA
  8413         MOVE +1                 TO CARRIERL
  8414         MOVE PI-689-CARRIER     TO CARRIERI.
  8415
  8416     IF  PI-689-GROUPING NOT EQUAL LOW-VALUES
  8417         MOVE +6                 TO GROUPL
  8418         MOVE AL-UANON           TO GROUPA
  8419         MOVE PI-689-GROUPING    TO GROUPI.
  8420
  8421     IF  PI-689-STATE NOT EQUAL LOW-VALUES
  8422         MOVE +2                 TO STATEL
  8423         MOVE AL-UANON           TO STATEA
  8424         MOVE PI-689-STATE       TO STATEI.
  8425
  8426     IF  PI-689-ACCOUNT NOT EQUAL LOW-VALUES
  8427         MOVE +10                TO ACCTL
  8428         MOVE AL-UANON           TO ACCTA
  8429         MOVE PI-689-ACCOUNT     TO ACCTI.
  8430
  8431     IF  PI-689-CERT-PRIME NOT EQUAL LOW-VALUES
  8432         MOVE +10                TO CERTL
  8433         MOVE AL-UANON           TO CERTA
  8434         MOVE PI-689-CERT-PRIME  TO CERTI.
  8435
  8436     IF  PI-689-CERT-SFX NOT EQUAL LOW-VALUES
  8437         MOVE +1                 TO SFXL
  8438         MOVE AL-UANON           TO SFXA
  8439         MOVE PI-689-CERT-SFX    TO SFXI.
  8440
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 161
* EL689.cbl
  8441     IF  PI-689-ENTRY-BATCH NOT EQUAL LOW-VALUES
  8442         MOVE +6                 TO BENTRYL
  8443         MOVE AL-UANON           TO BENTRYA
  8444         MOVE PI-689-ENTRY-BATCH TO BENTRYI.
  8445
  8446     MOVE +4                     TO BCSEQL.
  8447     MOVE AL-UANON               TO BCSEQA.
  8448     MOVE PI-689-CHG-SEQ-NO      TO BCSEQI.
  8449
  8450     IF  PI-689-SEQ-NO NOT EQUAL ZEROS
  8451         MOVE +8                 TO SEQL
  8452         MOVE AL-UANON           TO SEQA
  8453         MOVE PI-689-SEQ-NO      TO SEQI.
  8454
  8455     IF  PI-689-EFF-DATE NOT EQUAL LOW-VALUES
  8456         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  8457         MOVE ' '                TO DC-OPTION-CODE
  8458         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8459         MOVE +8                 TO DATEL
  8460         MOVE DC-GREG-DATE-1-EDIT
  8461                                 TO DATEI
  8462         MOVE AL-UANON           TO DATEA.
  8463
  8464     MOVE -1                     TO MAINTL.
  8465     MOVE '4'                    TO DATASORI
  8466                                    PI-689-DATA-SOURCE.
  8467     MOVE +1                     TO DATASORL.
  8468     MOVE AL-UANON               TO DATASORA.
  8469
  8470     GO TO 8100-SEND-INITIAL-MAP.
  8471
  8472 0400-EXIT.
  8473      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 162
* EL689.cbl
  8475 0450-SPECIAL-INPUT-PROCESS.
  8476
  8477     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  8478             AND
  8479         PI-CARRIER GREATER THAN LOW-VALUES
  8480         MOVE '1'                TO DATASORI
  8481                                    PI-689-DATA-SOURCE
  8482         MOVE PI-CARRIER         TO CARRIERI
  8483         MOVE PI-GROUPING        TO GROUPI
  8484         MOVE PI-STATE           TO STATEI
  8485         MOVE PI-ACCOUNT         TO ACCTI
  8486         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  8487         MOVE ' '                TO DC-OPTION-CODE
  8488         PERFORM 9500-LINK-DATE-CONVERT
  8489             THRU 9500-EXIT
  8490         MOVE DC-GREG-DATE-1-EDIT
  8491                                 TO DATEI
  8492         MOVE AL-UANON           TO ACCTA
  8493                                    CARRIERA
  8494                                    DATEA
  8495                                    DATASORA
  8496                                    GROUPA
  8497                                    STATEA
  8498         MOVE +1                 TO CARRIERL
  8499                                    DATASORL
  8500         MOVE -1                 TO MAINTL
  8501         MOVE +6                 TO GROUPL
  8502         MOVE +2                 TO STATEL
  8503         MOVE +8                 TO DATEL
  8504         MOVE +10                TO ACCTL
  8505     ELSE
  8506         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  8507                 AND
  8508             PI-CARRIER GREATER THAN LOW-VALUES
  8509             MOVE '3'            TO DATASORI
  8510                                    PI-689-DATA-SOURCE
  8511             MOVE PI-CR-CARRIER  TO CARRIERI
  8512             MOVE PI-CR-GROUPING TO GROUPI
  8513             MOVE PI-CR-ACCOUNT  TO ACCTI
  8514             MOVE PI-CR-FIN-RESP TO RPERSONI
  8515             MOVE PI-CR-TYPE     TO TYPEI
  8516             MOVE AL-UANON       TO CARRIERA
  8517                                    GROUPA
  8518                                    ACCTA
  8519                                    DATASORA
  8520                                    RPERSONA
  8521                                    TYPEA
  8522             MOVE +1             TO CARRIERL
  8523                                    DATASORL
  8524                                    TYPEL
  8525             MOVE -1             TO MAINTL
  8526             MOVE +6             TO GROUPL
  8527             MOVE +10            TO ACCTL
  8528                                    RPERSONL
  8529         ELSE
  8530             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  8531                     AND
  8532                 PI-CARRIER GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 163
* EL689.cbl
  8533                 MOVE '2'        TO DATASORI
  8534                                    PI-689-DATA-SOURCE
  8535                 MOVE PI-CARRIER TO CARRIERI
  8536                 MOVE PI-GROUPING
  8537                                 TO GROUPI
  8538                 MOVE PI-STATE   TO STATEI
  8539                 MOVE PI-ACCOUNT TO ACCTI
  8540                 MOVE PI-CERT-PRIME
  8541                                 TO CERTI
  8542                 MOVE PI-CERT-SFX
  8543                                 TO SFXI
  8544                 MOVE PI-CERT-EFF-DT
  8545                                 TO DC-BIN-DATE-1
  8546                 MOVE ' '        TO DC-OPTION-CODE
  8547                 PERFORM 9500-LINK-DATE-CONVERT
  8548                     THRU 9500-EXIT
  8549                 MOVE DC-GREG-DATE-1-EDIT
  8550                                 TO DATEI
  8551                 MOVE AL-UANON   TO CARRIERA
  8552                                    GROUPA
  8553                                    STATEA
  8554                                    ACCTA
  8555                                    CERTA
  8556                                    SFXA
  8557                                    DATEA
  8558                                    ADDRSA
  8559                                    DATASORA
  8560                 MOVE +1         TO CARRIERL
  8561                                    SFXL
  8562                                    DATASORL
  8563                                    ADDRSL
  8564                 MOVE -1         TO MAINTL
  8565                 MOVE +6         TO GROUPL
  8566                 MOVE +2         TO STATEL
  8567                 MOVE +8         TO DATEL
  8568                 MOVE +10        TO ACCTL
  8569                                    CERTL.
  8570
  8571     IF PI-CREATE-LABELS
  8572         MOVE  AL-UANON          TO ADDRLBLA
  8573         MOVE  +1                TO ADDRLBLL.
  8574
  8575     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  8576                                    PI-689-LBL-OVERRIDE.
  8577
  8578     MOVE LOW-VALUES             TO PI-689-KEY-DATA-FIELDS.
  8579     GO TO 8100-SEND-INITIAL-MAP.
  8580
  8581 0450-EXIT.
  8582      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 164
* EL689.cbl
  8584 0600-BYPASS-SCREEN-CNTL.
  8585***************************************************************
  8586*     THIS ROUTINE WILL PROCESS A NEW LETTER REQUIREMENT      *
  8587*     WITH THE INFORMATION FOUND IN THE PI AREA WITHOUT       *
  8588*     PERFORMING ANY SCREEN IO.                               *
  8589***************************************************************
  8590
  8591
  8592* EXEC CICS HANDLE CONDITION
  8593*        PGMIDERR (9700-PGMID-ERROR)
  8594*        MAPFAIL  (0325-MAPFAIL)
  8595*        ERROR    (9800-ABEND)
  8596*    END-EXEC.
  8597*    MOVE '"$L?.                 ! % #00008507' TO DFHEIV0
  8598     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  8599     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8600     MOVE X'2520233030303038353037' TO DFHEIV0(25:11)
  8601     CALL 'kxdfhei1' USING DFHEIV0
  8602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8603
  8604
  8605     MOVE LOW-VALUES             TO EL689AI.
  8606
  8607     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM
  8608
  8609     MOVE PI-689-FORM-NUMBER     TO FORMI.
  8610     MOVE +4                     TO FORML.
  8611
  8612     IF  PI-689-NUMBER-COPIES GREATER THAN ZERO
  8613         MOVE PI-689-NUMBER-COPIES
  8614                                 TO COPIESI
  8615         MOVE +1                 TO COPIESL.
  8616
  8617     MOVE PI-689-LABEL-SOURCE    TO ADDRSI.
  8618     MOVE +1                     TO ADDRSL.
  8619     MOVE PI-689-DATA-SOURCE     TO DATASORI.
  8620     MOVE +1                     TO DATASORL.
  8621
  8622     IF  PI-689-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  8623         MOVE PI-689-PRINT-RESTRICTION
  8624                                 TO PRTRESTI
  8625         MOVE +1                 TO PRTRESTL.
  8626
  8627     MOVE SPACES                 TO PI-689-PRINT-SW
  8628                                    PI-689-LBL-OVERRIDE.
  8629     MOVE ZEROS                  TO PI-TOTAL-LINES
  8630                                    PI-CURRENT-LINE
  8631                                    PI-TEMP-STOR-ITEMS
  8632                                    PI-UPDATE-SW
  8633                                    PI-689-ERROR
  8634                                    PI-689-NUMBER-LABEL-LINES
  8635                                    PI-689-NUMBER-TEXT-RECORDS.
  8636
  8637     IF  PI-689-ALT-PRINTER-ID NOT EQUAL LOW-VALUES
  8638         MOVE +4                 TO PRINTERL
  8639         MOVE PI-689-ALT-PRINTER-ID
  8640                                 TO PRINTERI PI-ALT-DMD-PRT-ID.
  8641
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 165
* EL689.cbl
  8642     MOVE SPACES                 TO PI-689-ALT-PRINTER-ID.
  8643
  8644     IF  PI-689-SOURCE-VARIABLE
  8645         PERFORM 0700-GET-VARIABLE-LABEL THRU 0700-EXIT.
  8646
  8647     MOVE SPACES                 TO W-CNTL-KEY
  8648     MOVE LOW-VALUES             TO W-ACCT-KEY
  8649                                    W-CERT-KEY
  8650                                    W-CHEK-KEY
  8651                                    W-COMP-KEY
  8652                                    W-MAIL-KEY
  8653                                    W-PNDB-KEY
  8654                                    W-PNDB2-KEY
  8655                                    W-PYAJ-KEY.
  8656
  8657     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  8658     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  8659                                    W-CERT-COMPANY-CD
  8660                                    W-CHEK-COMPANY-CD
  8661                                    W-COMP-COMPANY-CD
  8662                                    W-MAIL-COMPANY-CD
  8663                                    W-PNDB-COMPANY-CD
  8664                                    W-PNDB2-COMPANY-CD
  8665                                    W-PYAJ-COMPANY-CD.
  8666
  8667     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
  8668         MOVE PI-689-CARRIER     TO W-ACCT-CARRIER
  8669                                    W-CERT-CARRIER
  8670                                    W-MAIL-CARRIER
  8671                                    W-CERT-CARRIER
  8672                                    W-COMP-CARRIER
  8673                                    W-CHEK-CARRIER
  8674                                    W-PNDB2-CARRIER
  8675                                    W-PYAJ-CARRIER.
  8676
  8677     IF  PI-689-GROUPING GREATER THAN LOW-VALUES
  8678         MOVE PI-689-GROUPING    TO W-ACCT-GROUPING
  8679                                    W-CERT-GROUPING
  8680                                    W-CHEK-GROUPING
  8681                                    W-COMP-GROUPING
  8682                                    W-MAIL-GROUPING
  8683                                    W-PNDB2-GROUPING
  8684                                    W-PYAJ-GROUPING.
  8685
  8686     IF  PI-689-STATE GREATER THAN LOW-VALUES
  8687         MOVE PI-689-STATE       TO W-ACCT-STATE
  8688                                    W-CERT-STATE
  8689                                    W-CHEK-STATE
  8690                                    W-MAIL-STATE
  8691                                    W-PNDB2-STATE.
  8692
  8693     IF  PI-689-ACCOUNT GREATER THAN LOW-VALUES
  8694         IF PI-689-DATA-SOURCE = '3' OR '6'
  8695             MOVE PI-689-ACCOUNT TO W-COMP-ACCOUNT
  8696                                    W-PYAJ-ACCOUNT
  8697         ELSE
  8698             MOVE PI-689-ACCOUNT TO W-ACCT-ACCOUNT
  8699                                    W-CERT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 166
* EL689.cbl
  8700                                    W-CHEK-ACCOUNT
  8701                                    W-MAIL-ACCOUNT
  8702                                    W-PNDB2-ACCOUNT.
  8703
  8704     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  8705         MOVE PI-689-EFF-DATE    TO W-CERT-EFF-DT
  8706                                    W-CHEK-EFF-DT
  8707                                    W-MAIL-EFF-DT
  8708                                    W-PNDB2-EFF-DT.
  8709
  8710     IF  PI-689-CERT-PRIME GREATER THAN LOW-VALUES
  8711         MOVE PI-689-CERT-PRIME  TO W-CERT-CERT-PRIME
  8712                                    W-CHEK-CERT-PRIME
  8713                                    W-MAIL-CERT-PRIME
  8714                                    W-PNDB2-CERT-PRIME
  8715
  8716         IF  PI-689-CERT-SFX GREATER THAN LOW-VALUES
  8717             MOVE PI-689-CERT-SFX
  8718                                 TO W-CERT-CERT-SFX
  8719                                    W-CHEK-CERT-SFX
  8720                                    W-MAIL-CERT-SFX
  8721                                    W-PNDB2-CERT-SFX
  8722         ELSE
  8723             MOVE SPACES         TO W-CERT-CERT-SFX
  8724                                    W-CHEK-CERT-SFX
  8725                                    W-MAIL-CERT-SFX
  8726                                    W-PNDB2-CERT-SFX.
  8727
  8728     IF  PI-689-RESP-PERSON GREATER THAN LOW-VALUES
  8729         IF PI-689-DATA-SOURCE = '3' OR '6'
  8730             MOVE PI-689-RESP-PERSON
  8731                                 TO W-COMP-RESP-PERSON
  8732                                    W-PYAJ-FIN-RESP.
  8733
  8734     IF  PI-689-TYPE GREATER THAN LOW-VALUES
  8735         IF PI-689-DATA-SOURCE = '3' OR '6'
  8736             MOVE PI-689-TYPE    TO W-COMP-TYPE
  8737                                    W-PYAJ-RECORD-TYPE
  8738         ELSE
  8739             MOVE PI-689-TYPE    TO W-PNDB2-TYPE.
  8740
  8741     IF  PI-689-SEQ-NO GREATER THAN ZEROS
  8742         MOVE PI-689-SEQ-NO      TO W-PNDB-SEQ-NO
  8743                                    W-PYAJ-FILE-SEQ-NO
  8744                                    W-CHEK-SEQ-NO.
  8745
  8746     IF  PI-689-CHG-SEQ-NO GREATER THAN ZEROS
  8747         MOVE PI-689-CHG-SEQ-NO  TO W-PNDB-CHG-SEQ-NO
  8748                                    W-PNDB2-ALT-CHG-SEQ-NO.
  8749
  8750     IF  PI-689-ENTRY-BATCH GREATER THAN LOW-VALUES
  8751         MOVE PI-689-ENTRY-BATCH TO W-PNDB-ENTRY.
  8752
  8753     IF  PI-689-NO-ERRORS-DETECTED
  8754         PERFORM 2000-CREATE THRU 2000-EXIT
  8755         IF  NOT PI-689-FATAL-ERROR
  8756                 AND
  8757             NOT PI-689-ERR-DETECTED-PREV
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 167
* EL689.cbl
  8758             IF  PI-689-PRINT-ONLY
  8759                 PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  8760             ELSE
  8761                 IF  PI-689-PRINT-FIRST
  8762                     PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  8763                     IF  NOT PI-689-FATAL-ERROR
  8764                         IF  PI-689-ARCHIVE-LETTER
  8765                             PERFORM 5400-LETTER-RELEASE
  8766                                 THRU 5400-EXIT
  8767                         ELSE
  8768                             MOVE ER-7390
  8769                                 TO PI-689-ERROR
  8770                     ELSE
  8771                         NEXT SENTENCE
  8772                 ELSE
  8773                     IF  NOT PI-689-ARCHIVE-LETTER
  8774                         MOVE ER-7390
  8775                                 TO PI-689-ERROR
  8776                     ELSE
  8777                         PERFORM 5400-LETTER-RELEASE
  8778                             THRU 5400-EXIT
  8779                         IF  NOT PI-689-FATAL-ERROR
  8780                             IF  PI-689-PRINT-SECOND
  8781                                 PERFORM 7900-PRINT-LETTER-NOW
  8782                                     THRU 7900-EXIT.
  8783
  8784 0600-EXIT.
  8785     EXIT.
  8786
  8787 0620-RETURN-TO-CALLER.
  8788
  8789     MOVE PROGRAM-INTERFACE-BLOCK
  8790                                 TO DFHCOMMAREA.
  8791
  8792* EXEC CICS RETURN
  8793*    END-EXEC.
  8794*    MOVE '.(                    &   #00008699' TO DFHEIV0
  8795     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8796     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8797     MOVE X'2020233030303038363939' TO DFHEIV0(25:11)
  8798     CALL 'kxdfhei1' USING DFHEIV0,
  8799           DFHEIV99,
  8800           DFHEIV99,
  8801           DFHEIV99,
  8802           DFHEIV99,
  8803           DFHEIV99
  8804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8805
  8806
  8807 0700-GET-VARIABLE-LABEL.
  8808
  8809     IF  PI-689-VARIABLE-DATA-1 NOT GREATER THAN SPACES
  8810         MOVE '(VARIABLE NOT PROVIDED)'
  8811                                 TO W-RC-TEXT (1)
  8812                                    W-VG-TEXT (48)
  8813         GO TO 0700-EXIT.
  8814
  8815     MOVE PI-689-VARIABLE-DATA-1 TO W-RC-TEXT (1)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 168
* EL689.cbl
  8816                                    W-VG-TEXT (48).
  8817     MOVE PI-689-VARIABLE-DATA-2 TO W-RC-TEXT (2)
  8818                                    W-VG-TEXT (49).
  8819     MOVE PI-689-VARIABLE-DATA-3 TO W-RC-TEXT (3)
  8820                                    W-VG-TEXT (50).
  8821     MOVE PI-689-VARIABLE-DATA-4 TO W-RC-TEXT (4)
  8822                                    W-VG-TEXT (51).
  8823     SET W-RG-NDX                TO +5.
  8824
  8825 0700-EXIT.
  8826     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 169
* EL689.cbl
  8828 0800-EDIT-KEY-FIELDS.
  8829***************************************************************
  8830*     THIS ROUTINE WILL DECIDE WHAT FIELDS ARE NECESSARY      *
  8831*     FROM THE DATA SOURCE FIELD.  IF A NECESSARY FIELD       *
  8832*     IS NOT PROVIDED AN ERROR WILL PREVENT FURTHER           *
  8833*     PROCESSING.                                             *
  8834***************************************************************
  8835     MOVE SPACES                 TO W-CNTL-KEY
  8836     MOVE LOW-VALUES             TO W-ACCT-KEY
  8837                                    W-CERT-KEY
  8838                                    W-CHEK-KEY
  8839                                    W-COMP-KEY
  8840                                    W-MAIL-KEY
  8841                                    W-PNDB-KEY
  8842                                    W-PNDB2-KEY
  8843                                    W-PYAJ-KEY.
  8844
  8845     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  8846     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  8847                                    W-CERT-COMPANY-CD
  8848                                    W-CHEK-COMPANY-CD
  8849                                    W-COMP-COMPANY-CD
  8850                                    W-MAIL-COMPANY-CD
  8851                                    W-PNDB-COMPANY-CD
  8852                                    W-PNDB2-COMPANY-CD
  8853                                    W-PYAJ-COMPANY-CD.
  8854
  8855     PERFORM 0900-EDIT-CARRIER THRU 0900-EXIT.
  8856     PERFORM 0905-EDIT-GROUPING THRU 0905-EXIT.
  8857     PERFORM 0910-EDIT-STATE THRU 0910-EXIT.
  8858     PERFORM 0915-EDIT-ACCOUNT THRU 0915-EXIT.
  8859     PERFORM 0920-EDIT-EXP-DATE THRU 0920-EXIT.
  8860     PERFORM 0925-EDIT-EFF-DATE THRU 0925-EXIT.
  8861     PERFORM 0930-EDIT-CERTIFICATE THRU 0930-EXIT.
  8862     PERFORM 0935-EDIT-RESP-PERSON THRU 0935-EXIT.
  8863     PERFORM 0940-EDIT-ACCOUNT THRU 0940-EXIT.
  8864     PERFORM 0945-EDIT-TYPE THRU 0945-EXIT.
  8865     PERFORM 0950-EDIT-ENTRY THRU 0950-EXIT.
  8866     PERFORM 0955-EDIT-SEQUENCE THRU 0955-EXIT.
  8867     PERFORM 0960-EDIT-BATCH-SEQ THRU 0960-EXIT.
  8868     PERFORM 0965-EDIT-TYPE THRU 0965-EXIT.
  8869
  8870     IF  DATASORI NUMERIC
  8871         MOVE DATASORI           TO W-DATA-SOURCE
  8872                                    PI-689-DATA-SOURCE
  8873         GO TO 0800-SOURCE-ACCOUNT
  8874               0800-SOURCE-CERTIFICATE
  8875               0800-SOURCE-COMPENSATION
  8876               0800-SOURCE-PENDING
  8877               0800-SOURCE-CHEK
  8878               0800-SOURCE-PAYMENTS-ADJS
  8879                                 DEPENDING ON W-DATA-SOURCE.
  8880
  8881     IF  FORMI NOT EQUAL '9999'
  8882         MOVE ER-7365            TO EMI-ERROR
  8883         MOVE -1                 TO MAINTL
  8884         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8885         GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 170
* EL689.cbl
  8886
  8887     ELSE
  8888         GO TO 0800-EXIT.
  8889
  8890 0800-SOURCE-ACCOUNT.
  8891
  8892     IF  W-ACCT-COMPANY-CD EQUAL LOW-VALUES
  8893             OR
  8894         W-ACCT-CARRIER EQUAL LOW-VALUES
  8895             OR
  8896         W-ACCT-GROUPING EQUAL LOW-VALUES
  8897             OR
  8898         W-ACCT-STATE EQUAL LOW-VALUES
  8899             OR
  8900         W-ACCT-ACCOUNT EQUAL LOW-VALUES
  8901             OR
  8902         W-ACCT-EXP-DT EQUAL LOW-VALUES
  8903         MOVE ER-7376            TO EMI-ERROR
  8904         MOVE -1                 TO MAINTL
  8905         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8906
  8907     GO TO 0800-ERROR-TEST.
  8908
  8909 0800-SOURCE-CERTIFICATE.
  8910
  8911     IF  W-CERT-COMPANY-CD EQUAL LOW-VALUES
  8912             OR
  8913         W-CERT-CARRIER EQUAL LOW-VALUES
  8914             OR
  8915         W-CERT-GROUPING EQUAL LOW-VALUES
  8916             OR
  8917         W-CERT-STATE EQUAL LOW-VALUES
  8918             OR
  8919         W-CERT-ACCOUNT EQUAL LOW-VALUES
  8920             OR
  8921         W-CERT-EFF-DT EQUAL LOW-VALUES
  8922             OR
  8923         W-CERT-CERT-NO EQUAL LOW-VALUES
  8924         MOVE ER-7377            TO EMI-ERROR
  8925         MOVE -1                 TO MAINTL
  8926         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8927
  8928     GO TO 0800-ERROR-TEST.
  8929
  8930 0800-SOURCE-COMPENSATION.
  8931
  8932     IF  W-COMP-COMPANY-CD EQUAL LOW-VALUES
  8933             OR
  8934         W-COMP-CARRIER EQUAL LOW-VALUES
  8935             OR
  8936         W-COMP-GROUPING EQUAL LOW-VALUES
  8937             OR
  8938         W-COMP-RESP-PERSON EQUAL LOW-VALUES
  8939             OR
  8940         W-COMP-TYPE EQUAL LOW-VALUES
  8941             OR
  8942         (W-COMP-TYPE EQUAL 'A'
  8943                 AND
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 171
* EL689.cbl
  8944             W-COMP-ACCOUNT EQUAL LOW-VALUES)
  8945         MOVE ER-7378            TO EMI-ERROR
  8946         MOVE -1                 TO MAINTL
  8947         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8948
  8949     GO TO 0800-ERROR-TEST.
  8950
  8951 0800-SOURCE-PENDING.
  8952
  8953     IF  BENTRYL EQUAL ZEROS
  8954         IF  W-PNDB2-COMPANY-CD EQUAL LOW-VALUES
  8955                 OR
  8956             W-PNDB2-CARRIER EQUAL LOW-VALUES
  8957                 OR
  8958             W-PNDB2-GROUPING EQUAL LOW-VALUES
  8959                 OR
  8960             W-PNDB2-STATE EQUAL LOW-VALUES
  8961                 OR
  8962             W-PNDB2-ACCOUNT EQUAL LOW-VALUES
  8963                 OR
  8964             W-PNDB2-EFF-DT EQUAL LOW-VALUES
  8965                 OR
  8966             W-PNDB2-CERT-NO EQUAL LOW-VALUES
  8967                 OR
  8968             W-PNDB2-TYPE EQUAL LOW-VALUES
  8969                 OR
  8970             W-PNDB2-ALT-CHG-SEQ-NO NOT = ZEROS
  8971             MOVE ER-7379        TO EMI-ERROR
  8972             MOVE -1             TO MAINTL
  8973             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8974         ELSE
  8975             NEXT SENTENCE
  8976     ELSE
  8977         IF  W-PNDB-COMPANY-CD EQUAL LOW-VALUES
  8978                 OR
  8979             W-PNDB-ENTRY EQUAL LOW-VALUES
  8980                 OR
  8981             W-PNDB-SEQ-NO EQUAL ZEROS
  8982             MOVE ER-7379        TO EMI-ERROR
  8983             MOVE -1             TO MAINTL
  8984             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8985
  8986     GO TO 0800-ERROR-TEST.
  8987
  8988 0800-SOURCE-CHEK.
  8989
  8990     IF  W-CHEK-COMPANY-CD EQUAL LOW-VALUES
  8991             OR
  8992         W-CHEK-CARRIER EQUAL LOW-VALUES
  8993             OR
  8994         W-CHEK-GROUPING EQUAL LOW-VALUES
  8995             OR
  8996         W-CHEK-STATE EQUAL LOW-VALUES
  8997             OR
  8998         W-CHEK-ACCOUNT EQUAL LOW-VALUES
  8999             OR
  9000         W-CHEK-EFF-DT EQUAL LOW-VALUES
  9001             OR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 172
* EL689.cbl
  9002         W-CHEK-CERT-NO EQUAL LOW-VALUES
  9003         MOVE ER-7381            TO EMI-ERROR
  9004         MOVE -1                 TO MAINTL
  9005         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9006
  9007     GO TO 0800-ERROR-TEST.
  9008
  9009 0800-SOURCE-PAYMENTS-ADJS.
  9010
  9011     IF  W-PYAJ-COMPANY-CD EQUAL LOW-VALUES
  9012             OR
  9013         W-PYAJ-CARRIER EQUAL LOW-VALUES
  9014             OR
  9015         W-PYAJ-GROUPING EQUAL LOW-VALUES
  9016             OR
  9017         W-PYAJ-FIN-RESP EQUAL LOW-VALUES
  9018             OR
  9019         W-PYAJ-ACCOUNT EQUAL LOW-VALUES
  9020             OR
  9021         W-PYAJ-RECORD-TYPE EQUAL LOW-VALUES
  9022         MOVE ER-7396            TO EMI-ERROR
  9023         MOVE -1                 TO MAINTL
  9024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9025
  9026     GO TO 0800-ERROR-TEST.
  9027
  9028 0800-ERROR-TEST.
  9029
  9030     IF  NOT EMI-NO-ERRORS
  9031         IF  EMI-ERROR EQUAL ER-7250
  9032             GO TO 0800-EXIT
  9033         ELSE
  9034             GO TO 8200-SEND-DATAONLY.
  9035
  9036 0800-EXIT.
  9037     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 173
* EL689.cbl
  9039 0900-EDIT-CARRIER.
  9040
  9041     IF  CARRIERL EQUAL ZEROES
  9042         MOVE LOW-VALUES         TO PI-689-CARRIER
  9043                                    W-ACCT-CARRIER
  9044                                    W-CERT-CARRIER
  9045                                    W-COMP-CARRIER
  9046                                    W-CHEK-CARRIER
  9047                                    W-MAIL-CARRIER
  9048                                    W-PNDB2-CARRIER
  9049                                    W-PYAJ-CARRIER
  9050     ELSE
  9051         PERFORM 0990-CARRIER-VALIDITY-CHECK THRU 0990-EXIT.
  9052
  9053 0900-EXIT.
  9054     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 174
* EL689.cbl
  9056 0905-EDIT-GROUPING.
  9057
  9058     IF  GROUPL EQUAL ZEROES
  9059         MOVE LOW-VALUES         TO PI-689-GROUPING
  9060                                    W-ACCT-GROUPING
  9061                                    W-CERT-GROUPING
  9062                                    W-CHEK-GROUPING
  9063                                    W-COMP-GROUPING
  9064                                    W-MAIL-GROUPING
  9065                                    W-PNDB2-GROUPING
  9066                                    W-PYAJ-GROUPING
  9067     ELSE
  9068         MOVE AL-UANON           TO GROUPA
  9069         MOVE GROUPI             TO PI-689-GROUPING
  9070                                    W-ACCT-GROUPING
  9071                                    W-CERT-GROUPING
  9072                                    W-CHEK-GROUPING
  9073                                    W-COMP-GROUPING
  9074                                    W-MAIL-GROUPING
  9075                                    W-PNDB2-GROUPING
  9076                                    W-PYAJ-GROUPING.
  9077
  9078 0905-EXIT.
  9079     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 175
* EL689.cbl
  9081 0910-EDIT-STATE.
  9082
  9083     IF  STATEL EQUAL ZEROES
  9084         MOVE LOW-VALUES         TO PI-689-STATE
  9085                                    W-ACCT-STATE
  9086                                    W-CERT-STATE
  9087                                    W-CHEK-STATE
  9088                                    W-MAIL-STATE
  9089                                    W-PNDB2-STATE
  9090     ELSE
  9091         PERFORM 0994-STATE-VALIDITY-CHECK THRU 0994-EXIT.
  9092
  9093 0910-EXIT.
  9094     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 176
* EL689.cbl
  9096 0915-EDIT-ACCOUNT.
  9097
  9098     IF  ACCTL EQUAL ZEROES
  9099         MOVE LOW-VALUES         TO PI-689-ACCOUNT
  9100                                    W-ACCT-ACCOUNT
  9101                                    W-CERT-ACCOUNT
  9102                                    W-CHEK-ACCOUNT
  9103                                    W-COMP-ACCOUNT
  9104                                    W-MAIL-ACCOUNT
  9105                                    W-PNDB2-ACCOUNT
  9106                                    W-PYAJ-ACCOUNT
  9107     ELSE
  9108         MOVE AL-UANON           TO ACCTA
  9109         MOVE ACCTI              TO PI-689-ACCOUNT
  9110                                    W-ACCT-ACCOUNT
  9111                                    W-CERT-ACCOUNT
  9112                                    W-CHEK-ACCOUNT
  9113                                    W-COMP-ACCOUNT
  9114                                    W-MAIL-ACCOUNT
  9115                                    W-PYAJ-ACCOUNT
  9116                                    W-PNDB2-ACCOUNT.
  9117
  9118 0915-EXIT.
  9119     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 177
* EL689.cbl
  9121 0920-EDIT-EXP-DATE.
  9122
  9123     IF  DATEL NOT EQUAL ZEROS
  9124         IF  DATEI EQUAL '99/99/99' OR '999999'
  9125             MOVE '99/99/99'     TO DATEO
  9126                                    PI-689-DATE-EDIT
  9127             MOVE AL-UANON       TO DATEA
  9128             MOVE HIGH-VALUES    TO PI-689-EXP-DATE
  9129                                    W-ACCT-EXP-DT
  9130         ELSE
  9131             MOVE DATEI          TO W-DEEDIT-FIELD
  9132             PERFORM 8600-DEEDIT
  9133             MOVE W-DEEDIT-FIELD-V0
  9134                                 TO DC-GREG-DATE-1-MDY
  9135             MOVE '4'            TO DC-OPTION-CODE
  9136             PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9137             IF  DATE-CONVERSION-ERROR
  9138                 MOVE ER-0454    TO EMI-ERROR
  9139                 MOVE -1         TO DATEL
  9140                 MOVE AL-UABON   TO DATEA
  9141                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9142             ELSE
  9143                 MOVE DC-GREG-DATE-1-EDIT
  9144                                 TO DATEO
  9145                                    PI-689-DATE-EDIT
  9146                 MOVE AL-UANON   TO DATEA
  9147                 MOVE DC-BIN-DATE-1
  9148                                 TO PI-689-EXP-DATE
  9149                                    W-ACCT-EXP-DT
  9150     ELSE
  9151         MOVE LOW-VALUES         TO PI-689-EXP-DATE
  9152                                    W-ACCT-EXP-DT
  9153                                    PI-689-DATE-EDIT.
  9154
  9155 0920-EXIT.
  9156     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 178
* EL689.cbl
  9158 0925-EDIT-EFF-DATE.
  9159
  9160     IF  CERTL EQUAL ZERO
  9161             AND
  9162         DATASORI NOT EQUAL '2'
  9163         GO TO 0925-EXIT.
  9164
  9165     IF  DATEL NOT EQUAL ZEROS
  9166         MOVE DATEI              TO W-DEEDIT-FIELD
  9167         PERFORM 8600-DEEDIT
  9168         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9169         MOVE '4'                TO DC-OPTION-CODE
  9170         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9171
  9172         IF  DATE-CONVERSION-ERROR
  9173             MOVE ER-0215        TO EMI-ERROR
  9174             MOVE -1             TO DATEL
  9175             MOVE AL-UABON       TO DATEA
  9176             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9177         ELSE
  9178             MOVE DC-GREG-DATE-1-EDIT
  9179                                 TO DATEO
  9180                                    PI-689-DATE-EDIT
  9181             MOVE AL-UANON       TO DATEA
  9182             MOVE DC-BIN-DATE-1  TO PI-689-EFF-DATE
  9183                                    W-CERT-EFF-DT
  9184                                    W-CHEK-EFF-DT
  9185                                    W-MAIL-EFF-DT
  9186                                    W-PNDB2-EFF-DT
  9187     ELSE
  9188         MOVE LOW-VALUES         TO PI-689-EFF-DATE
  9189                                    W-PNDB2-EFF-DT
  9190                                    W-CHEK-EFF-DT
  9191                                    W-MAIL-EFF-DT
  9192                                    W-CERT-EFF-DT
  9193                                    PI-689-DATE-EDIT.
  9194
  9195 0925-EXIT.
  9196     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 179
* EL689.cbl
  9198 0930-EDIT-CERTIFICATE.
  9199
  9200     IF  CERTL EQUAL ZEROES
  9201         MOVE LOW-VALUES         TO PI-689-CERT-PRIME
  9202                                    W-CERT-CERT-PRIME
  9203                                    W-CHEK-CERT-PRIME
  9204                                    W-MAIL-CERT-PRIME
  9205                                    W-PNDB2-CERT-PRIME
  9206                                    PI-689-CERT-SFX
  9207                                    W-CERT-CERT-SFX
  9208                                    W-CHEK-CERT-SFX
  9209                                    W-MAIL-CERT-SFX
  9210                                    W-PNDB2-CERT-SFX
  9211     ELSE
  9212         MOVE AL-UANON           TO CERTA
  9213         MOVE CERTI              TO PI-689-CERT-PRIME
  9214                                    W-CERT-CERT-PRIME
  9215                                    W-CHEK-CERT-PRIME
  9216                                    W-MAIL-CERT-PRIME
  9217                                    W-PNDB2-CERT-PRIME
  9218         IF  SFXL EQUAL ZEROES
  9219                 OR
  9220             SFXI EQUAL LOW-VALUES
  9221             MOVE SPACES         TO PI-689-CERT-SFX
  9222                                    W-CERT-CERT-SFX
  9223                                    W-CHEK-CERT-SFX
  9224                                    W-MAIL-CERT-SFX
  9225                                    W-PNDB2-CERT-SFX
  9226         ELSE
  9227             MOVE AL-UANON       TO SFXA
  9228             MOVE SFXI           TO PI-689-CERT-SFX
  9229                                    W-CERT-CERT-SFX
  9230                                    W-CHEK-CERT-SFX
  9231                                    W-MAIL-CERT-SFX
  9232                                    W-PNDB2-CERT-SFX.
  9233
  9234 0930-EXIT.
  9235     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 180
* EL689.cbl
  9237 0935-EDIT-RESP-PERSON.
  9238
  9239     IF  RPERSONL EQUAL ZEROES
  9240         MOVE LOW-VALUES         TO PI-689-RESP-PERSON
  9241                                    W-COMP-RESP-PERSON
  9242                                    W-PYAJ-FIN-RESP
  9243     ELSE
  9244         MOVE AL-UANON           TO RPERSONA
  9245         MOVE RPERSONI           TO PI-689-RESP-PERSON
  9246                                    W-PYAJ-FIN-RESP
  9247                                    W-COMP-RESP-PERSON.
  9248
  9249 0935-EXIT.
  9250     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 181
* EL689.cbl
  9252 0940-EDIT-ACCOUNT.
  9253
  9254     IF  ACCTL EQUAL ZEROES
  9255         MOVE LOW-VALUES         TO PI-689-ACCOUNT
  9256                                    W-COMP-ACCOUNT
  9257                                    W-PYAJ-ACCOUNT
  9258     ELSE
  9259         MOVE AL-UANON           TO ACCTA
  9260         MOVE ACCTI              TO PI-689-ACCOUNT
  9261                                    W-PYAJ-ACCOUNT
  9262                                    W-COMP-ACCOUNT.
  9263
  9264 0940-EXIT.
  9265     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 182
* EL689.cbl
  9267 0945-EDIT-TYPE.
  9268
  9269     IF  TYPEL EQUAL ZEROES
  9270         MOVE LOW-VALUES         TO PI-689-TYPE
  9271                                    W-COMP-TYPE
  9272                                    W-PYAJ-RECORD-TYPE
  9273     ELSE
  9274         INSPECT TYPEI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9275         IF TYPEI = 'C' OR 'G' OR 'A'
  9276             MOVE AL-UANON       TO TYPEA
  9277             MOVE TYPEI          TO PI-689-TYPE
  9278                                    W-COMP-TYPE
  9279                                    W-PYAJ-RECORD-TYPE
  9280         ELSE
  9281             MOVE ER-7368        TO EMI-ERROR
  9282             MOVE -1             TO TYPEL
  9283             MOVE AL-UABON       TO TYPEA
  9284             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9285
  9286 0945-EXIT.
  9287     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 183
* EL689.cbl
  9289 0950-EDIT-ENTRY.
  9290
  9291     IF  BENTRYL EQUAL ZEROES
  9292         MOVE LOW-VALUES         TO PI-689-ENTRY-BATCH
  9293                                    W-PNDB-ENTRY
  9294     ELSE
  9295         MOVE AL-UANON           TO BENTRYA
  9296         MOVE BENTRYI            TO PI-689-ENTRY-BATCH
  9297                                    W-PNDB-ENTRY.
  9298
  9299 0950-EXIT.
  9300     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 184
* EL689.cbl
  9302 0955-EDIT-SEQUENCE.
  9303
  9304     IF  SEQL NOT EQUAL ZEROS
  9305         IF  SEQI NOT NUMERIC
  9306                 OR
  9307             SEQI EQUAL '0'
  9308             MOVE ER-7367        TO EMI-ERROR
  9309             MOVE -1             TO SEQL
  9310             MOVE AL-UABON       TO SEQA
  9311             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9312         ELSE
  9313             MOVE AL-UANON       TO SEQA
  9314             MOVE SEQI           TO PI-689-SEQ-NO
  9315                                    W-CHEK-SEQ-NO
  9316                                    W-PYAJ-FILE-SEQ-NO
  9317                                    W-PNDB-SEQ-NO
  9318                                    PI-689-SEQ-EDIT
  9319     ELSE
  9320         MOVE LOW-VALUES         TO PI-689-SEQ-EDIT.
  9321
  9322 0955-EXIT.
  9323     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 185
* EL689.cbl
  9325 0960-EDIT-BATCH-SEQ.
  9326
  9327     IF  BCSEQL NOT EQUAL ZEROS
  9328         IF  BCSEQI NOT NUMERIC
  9329             MOVE ER-7368        TO EMI-ERROR
  9330             MOVE -1             TO BCSEQL
  9331             MOVE AL-UABON       TO BCSEQA
  9332             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9333         ELSE
  9334             MOVE AL-UANON       TO BCSEQA
  9335             MOVE BCSEQI         TO PI-689-CHG-SEQ-NO
  9336                                    W-PNDB-CHG-SEQ-NO
  9337                                    W-PNDB2-ALT-CHG-SEQ-NO
  9338                                    PI-689-BCSEQ-EDIT
  9339     ELSE
  9340         MOVE LOW-VALUES         TO PI-689-BCSEQ-EDIT.
  9341
  9342 0960-EXIT.
  9343     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 186
* EL689.cbl
  9345 0965-EDIT-TYPE.
  9346
  9347     IF  TYPEL EQUAL ZEROES
  9348         MOVE LOW-VALUES         TO PI-689-TYPE
  9349                                    W-PNDB2-TYPE
  9350     ELSE
  9351         IF  DATASORI NOT EQUAL '4'
  9352             GO TO 0965-EXIT
  9353         ELSE
  9354             IF TYPEI = '0' OR '1' OR '2' OR '3'
  9355                 MOVE AL-UANON   TO TYPEA
  9356                 MOVE TYPEI      TO PI-689-TYPE
  9357                                    W-PNDB2-TYPE
  9358             ELSE
  9359                 MOVE ER-7370    TO EMI-ERROR
  9360                 MOVE -1         TO TYPEL
  9361                 MOVE AL-UABON   TO TYPEA
  9362                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9363
  9364 0965-EXIT.
  9365     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 187
* EL689.cbl
  9367 0990-CARRIER-VALIDITY-CHECK.
  9368
  9369     IF  CARRIERI EQUAL SPACES
  9370         GO TO 0990-EXIT.
  9371
  9372     MOVE SPACES                 TO W-CNTL-KEY.
  9373     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9374     MOVE '6'                    TO W-CNTL-RECORD-TYPE.
  9375     MOVE CARRIERI               TO W-CNTL-GEN4.
  9376     MOVE +0                     TO W-CNTL-SEQ-NO.
  9377
  9378
  9379* EXEC CICS HANDLE CONDITION
  9380*        NOTFND  (0990-CARRIER-NOT-FOUND)
  9381*        NOTOPEN (8040-CNTL-NOT-OPEN)
  9382*    END-EXEC.
  9383*    MOVE '"$IJ                  ! & #00009273' TO DFHEIV0
  9384     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9386     MOVE X'2620233030303039323733' TO DFHEIV0(25:11)
  9387     CALL 'kxdfhei1' USING DFHEIV0
  9388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9389
  9390
  9391
  9392* EXEC CICS READ
  9393*        DATASET (W-CNTL-FILE-ID)
  9394*        SET     (ADDRESS OF CONTROL-FILE)
  9395*        RIDFLD  (W-CNTL-KEY)
  9396*    END-EXEC.
  9397*    MOVE '&"S        E          (   #00009278' TO DFHEIV0
  9398     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9399     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9400     MOVE X'2020233030303039323738' TO DFHEIV0(25:11)
  9401     CALL 'kxdfhei1' USING DFHEIV0,
  9402           W-CNTL-FILE-ID,
  9403           DFHEIV20,
  9404           DFHEIV99,
  9405           W-CNTL-KEY,
  9406           DFHEIV99,
  9407           DFHEIV99,
  9408           DFHEIV99
  9409     SET ADDRESS OF CONTROL-FILE TO
  9410         DFHEIV20
  9411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9412
  9413
  9414     IF  PI-NO-CARRIER-SECURITY
  9415             OR
  9416         PI-CARRIER-SECURITY EQUAL CARRIERI
  9417         MOVE AL-UANON           TO CARRIERA
  9418         MOVE CARRIERI           TO PI-689-CARRIER
  9419                                    W-ACCT-CARRIER
  9420                                    W-CERT-CARRIER
  9421                                    W-CHEK-CARRIER
  9422                                    W-COMP-CARRIER
  9423                                    W-MAIL-CARRIER
  9424                                    W-PNDB2-CARRIER
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 188
* EL689.cbl
  9425                                    W-PYAJ-CARRIER
  9426     ELSE
  9427         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  9428         MOVE ER-9095            TO EMI-ERROR
  9429         MOVE -1                 TO MAINTL
  9430         MOVE AL-UANON           TO MAINTA
  9431         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9432
  9433     GO TO 0990-EXIT.
  9434
  9435 0990-CARRIER-NOT-FOUND.
  9436
  9437     MOVE -1                     TO CARRIERL.
  9438     MOVE AL-UABON               TO CARRIERA.
  9439     MOVE ER-2208                TO EMI-ERROR.
  9440     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9441
  9442 0990-EXIT.
  9443     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 189
* EL689.cbl
  9445 0994-STATE-VALIDITY-CHECK.
  9446
  9447     IF  STATEI EQUAL SPACES
  9448         GO TO 0994-EXIT.
  9449
  9450     MOVE SPACES                 TO W-CNTL-KEY.
  9451     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9452     MOVE '3'                    TO W-CNTL-RECORD-TYPE.
  9453     MOVE STATEI                 TO W-CNTL-GEN1.
  9454     MOVE +0                     TO W-CNTL-SEQ-NO.
  9455
  9456
  9457* EXEC CICS HANDLE CONDITION
  9458*        NOTFND  (0994-STATE-NOT-FOUND)
  9459*        NOTOPEN (8040-CNTL-NOT-OPEN)
  9460*    END-EXEC.
  9461*    MOVE '"$IJ                  ! '' #00009326' TO DFHEIV0
  9462     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  9463     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9464     MOVE X'2720233030303039333236' TO DFHEIV0(25:11)
  9465     CALL 'kxdfhei1' USING DFHEIV0
  9466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9467
  9468
  9469
  9470* EXEC CICS READ
  9471*        DATASET (W-CNTL-FILE-ID)
  9472*        SET     (ADDRESS OF CONTROL-FILE)
  9473*        RIDFLD  (W-CNTL-KEY)
  9474*    END-EXEC.
  9475*    MOVE '&"S        E          (   #00009331' TO DFHEIV0
  9476     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9477     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9478     MOVE X'2020233030303039333331' TO DFHEIV0(25:11)
  9479     CALL 'kxdfhei1' USING DFHEIV0,
  9480           W-CNTL-FILE-ID,
  9481           DFHEIV20,
  9482           DFHEIV99,
  9483           W-CNTL-KEY,
  9484           DFHEIV99,
  9485           DFHEIV99,
  9486           DFHEIV99
  9487     SET ADDRESS OF CONTROL-FILE TO
  9488         DFHEIV20
  9489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9490
  9491
  9492     MOVE AL-UANON               TO STATEA.
  9493     MOVE STATEI                 TO PI-689-STATE
  9494                                    W-ACCT-STATE
  9495                                    W-CERT-STATE
  9496                                    W-CHEK-STATE
  9497                                    W-MAIL-STATE
  9498                                    W-PNDB2-STATE.
  9499
  9500     GO TO 0994-EXIT.
  9501
  9502 0994-STATE-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 190
* EL689.cbl
  9503
  9504     MOVE -1                     TO STATEL.
  9505     MOVE AL-UABON               TO STATEA.
  9506     MOVE ER-2209                TO EMI-ERROR.
  9507     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9508
  9509 0994-EXIT.
  9510     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 191
* EL689.cbl
  9512 1000-SHOW.
  9513***************************************************************
  9514*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
  9515*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN.  IF THE       *
  9516*     HEADER RECORD IS FOUND THE TEXT IS THEN READ AND        *
  9517*     WILL BE INSERTED INTO THE W-TS-TABLE AND DISPLAYED.     *
  9518***************************************************************
  9519
  9520     MOVE SPACES                 TO W-RECORD-TABLE.
  9521
  9522     IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
  9523          MOVE PI-689-LBL-OVERRIDE
  9524                                 TO ADDRLBLI
  9525          MOVE +1                TO ADDRLBLL
  9526          MOVE AL-UANON          TO ADDRLBLA
  9527     ELSE
  9528          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
  9529          MOVE +1                TO ADDRLBLL
  9530          MOVE AL-UANON          TO ADDRLBLA.
  9531
  9532     IF  ARCHNUML EQUAL ZEROS
  9533         MOVE -1                 TO ARCHNUML
  9534         MOVE AL-UNBON           TO ARCHNUMA
  9535         MOVE ER-0174            TO EMI-ERROR
  9536         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9537         GO TO 8200-SEND-DATAONLY.
  9538
  9539     IF  ARCHNUMI NOT NUMERIC
  9540         MOVE -1                 TO ARCHNUML
  9541         MOVE AL-UNBON           TO ARCHNUMA
  9542         MOVE ER-0175            TO EMI-ERROR
  9543         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9544         GO TO 8200-SEND-DATAONLY.
  9545
  9546     IF  PI-SHOW-MODE
  9547
  9548         IF  PI-689-ARCHIVE-NUMBER EQUAL ARCHNUMI
  9549             MOVE -1             TO MAINTL
  9550             GO TO 8200-SEND-DATAONLY
  9551         ELSE
  9552             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT.
  9553
  9554     MOVE +0                     TO W-ARCH-SEQ-NO
  9555                                    W-ARCT-SEQ-NO.
  9556     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
  9557                                    W-ARCT-COMPANY-CD.
  9558     MOVE ARCHNUMI               TO W-ARCH-NUMBER
  9559                                    W-ARCT-NUMBER
  9560                                    PI-689-ARCHIVE-NUMBER.
  9561     MOVE ' '                    TO W-ARCT-REC-TYPE.
  9562     MOVE '1'                    TO PI-ACTION.
  9563     MOVE SPACES                 TO PI-689-PRINT-SW
  9564                                    PI-689-FORM-NUMBER
  9565                                    W-DELETE-KEY.
  9566     SET W-RG-NDX                TO W-ZEROS.
  9567
  9568
  9569* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 192
* EL689.cbl
  9570*         NOTOPEN    (8010-ARCH-NOT-OPEN)
  9571*         NOTFND     (1070-ARCH-NOT-FOUND)
  9572*         ENDFILE    (1070-ARCH-NOT-FOUND)
  9573*    END-EXEC.
  9574*    MOVE '"$JI''                 ! ( #00009413' TO DFHEIV0
  9575     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  9576     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9577     MOVE X'2820233030303039343133' TO DFHEIV0(25:11)
  9578     CALL 'kxdfhei1' USING DFHEIV0
  9579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9580
  9581
  9582
  9583* EXEC CICS READ
  9584*        DATASET (W-ARCH-FILE-ID)
  9585*        SET     (ADDRESS OF LETTER-ARCHIVE)
  9586*        RIDFLD  (W-ARCH-KEY)
  9587*    END-EXEC.
  9588*    MOVE '&"S        E          (   #00009419' TO DFHEIV0
  9589     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9590     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9591     MOVE X'2020233030303039343139' TO DFHEIV0(25:11)
  9592     CALL 'kxdfhei1' USING DFHEIV0,
  9593           W-ARCH-FILE-ID,
  9594           DFHEIV20,
  9595           DFHEIV99,
  9596           W-ARCH-KEY,
  9597           DFHEIV99,
  9598           DFHEIV99,
  9599           DFHEIV99
  9600     SET ADDRESS OF LETTER-ARCHIVE TO
  9601         DFHEIV20
  9602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9603
  9604
  9605     PERFORM 1040-FORMAT-HEADER-DATA THRU 1040-EXIT.
  9606
  9607
  9608* EXEC CICS HANDLE CONDITION
  9609*         NOTOPEN    (8015-ARCT-NOT-OPEN)
  9610*         NOTFND     (1020-ARCT-ENDBR)
  9611*         ENDFILE    (1020-ARCT-ENDBR)
  9612*    END-EXEC.
  9613*    MOVE '"$JI''                 ! ) #00009427' TO DFHEIV0
  9614     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  9615     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9616     MOVE X'2920233030303039343237' TO DFHEIV0(25:11)
  9617     CALL 'kxdfhei1' USING DFHEIV0
  9618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9619
  9620
  9621 1005-START-BROWSE.
  9622
  9623
  9624* EXEC CICS STARTBR
  9625*         DATASET    (W-ARCT-FILE-ID)
  9626*         RIDFLD     (W-ARCT-KEY)
  9627*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 193
* EL689.cbl
  9628*    END-EXEC.
  9629     MOVE 0
  9630       TO DFHEIV11
  9631*    MOVE '&,         G          &   #00009435' TO DFHEIV0
  9632     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9633     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9634     MOVE X'2020233030303039343335' TO DFHEIV0(25:11)
  9635     CALL 'kxdfhei1' USING DFHEIV0,
  9636           W-ARCT-FILE-ID,
  9637           W-ARCT-KEY,
  9638           DFHEIV99,
  9639           DFHEIV11,
  9640           DFHEIV99
  9641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9642
  9643
  9644     MOVE 'Y'                    TO W-ARCT-BROWSE-STARTED.
  9645
  9646 1010-READ-NEXT.
  9647
  9648
  9649* EXEC CICS READNEXT
  9650*         SET       (ADDRESS OF LETTER-ARCHIVE-TEXT)
  9651*         DATASET   (W-ARCT-FILE-ID)
  9652*         RIDFLD    (W-ARCT-KEY)
  9653*    END-EXEC.
  9654     MOVE 0
  9655       TO DFHEIV11
  9656*    MOVE '&.S                   )   #00009445' TO DFHEIV0
  9657     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9658     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9659     MOVE X'2020233030303039343435' TO DFHEIV0(25:11)
  9660     CALL 'kxdfhei1' USING DFHEIV0,
  9661           W-ARCT-FILE-ID,
  9662           DFHEIV20,
  9663           DFHEIV99,
  9664           W-ARCT-KEY,
  9665           DFHEIV99,
  9666           DFHEIV11,
  9667           DFHEIV99,
  9668           DFHEIV99
  9669     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  9670         DFHEIV20
  9671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9672
  9673
  9674     IF  W-ARCH-PARTIAL-KEY EQUAL W-ARCT-PARTIAL-KEY
  9675         IF  LT-ADDRESS-DATA
  9676             IF  PI-CREATE-LABELS  AND
  9677                 NOT PI-689-LABELS-OVERRIDEN
  9678                 PERFORM 1050-MOVE-LABELS THRU 1050-EXIT
  9679                         VARYING
  9680                     LT-NDX FROM 1 BY 1
  9681                         UNTIL
  9682                     LT-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
  9683                 GO TO 1010-READ-NEXT
  9684             ELSE
  9685                 MOVE LT-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 194
* EL689.cbl
  9686                                 TO W-DELETE-KEY
  9687                 GO TO 1010-READ-NEXT
  9688         ELSE
  9689             PERFORM 1030-TEXT-BUILD THRU 1030-EXIT
  9690                     VARYING
  9691                 LT-NDX FROM 1 BY 1
  9692                     UNTIL
  9693                 LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD
  9694                     OR
  9695                 LT-NDX GREATER THAN +20
  9696             GO TO 1010-READ-NEXT.
  9697
  9698 1020-ARCT-ENDBR.
  9699
  9700     IF  W-ARCT-BROWSE-STARTED EQUAL 'Y'
  9701
  9702* EXEC CICS ENDBR
  9703*             DATASET   (W-ARCT-FILE-ID)
  9704*        END-EXEC.
  9705     MOVE 0
  9706       TO DFHEIV11
  9707*    MOVE '&2                    $   #00009478' TO DFHEIV0
  9708     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9709     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9710     MOVE X'2020233030303039343738' TO DFHEIV0(25:11)
  9711     CALL 'kxdfhei1' USING DFHEIV0,
  9712           W-ARCT-FILE-ID,
  9713           DFHEIV11,
  9714           DFHEIV99
  9715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9716
  9717
  9718     IF  W-RG-NDX EQUAL ZEROS
  9719         GO TO 1080-ARCHIVE-TEXT-NOT-FOUND.
  9720
  9721     IF  PI-689-NUMBER-LABEL-LINES GREATER THAN +0
  9722             AND
  9723         PI-BYPASS-LABELS
  9724         MOVE W-DELETE-KEY       TO W-ARCT-KEY
  9725         PERFORM 1060-DELETE-ADDRESS-RECORD THRU 1060-EXIT
  9726         MOVE +0                 TO PI-689-NUMBER-LABEL-LINES.
  9727
  9728     SET PI-TOTAL-LINES          TO W-RG-NDX.
  9729     MOVE 1                      TO PI-CURRENT-LINE.
  9730     SET W-RG-NDX                TO +1.
  9731
  9732     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  9733             VARYING
  9734         W-SC-NDX FROM 1 BY 1
  9735             UNTIL
  9736         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  9737
  9738     MOVE -1                     TO MAINTL.
  9739     GO TO 8100-SEND-INITIAL-MAP.
  9740
  9741 1020-EXIT.
  9742     EXIT.
  9743
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 195
* EL689.cbl
  9744 1030-TEXT-BUILD.
  9745
  9746     SET W-RG-NDX UP BY 1.
  9747     MOVE LT-SKIP-CONTROL (LT-NDX)
  9748                                 TO W-PRINT-CONTROL.
  9749
  9750     IF  W-PRINT-CONTROL EQUAL 99
  9751         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
  9752         SET W-RG-NDX UP BY 1
  9753     ELSE
  9754         SET W-RG-NDX UP BY W-PRINT-CONTROL.
  9755
  9756     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
  9757     MOVE LT-SKIP-CONTROL (LT-NDX)
  9758                                 TO W-RC-PC (W-RG-NDX).
  9759     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
  9760
  9761 1030-EXIT.
  9762     EXIT.
  9763
  9764 1040-FORMAT-HEADER-DATA.
  9765
  9766     MOVE LA-ACCOUNT-A2          TO ACCTO.
  9767     MOVE LA-ADDR-SOURCE         TO ADDRSO.
  9768     MOVE LA-CARRIER-A2          TO CARRIERO.
  9769     MOVE LA-CERT-NO-A2          TO CERTO.
  9770     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
  9771     MOVE LA-DATA-SOURCE         TO DATASORO.
  9772
  9773     IF  LA-EFFECT-DATE-A2 EQUAL LOW-VALUES
  9774         MOVE ZEROES             TO DATEO
  9775
  9776     ELSE
  9777         MOVE LA-EFFECT-DATE-A2  TO DC-BIN-DATE-1
  9778         MOVE ' '                TO DC-OPTION-CODE
  9779         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9780         MOVE DC-GREG-DATE-1-EDIT
  9781                                 TO DATEO.
  9782
  9783     IF  LA-FOLLOW-UP-DATE EQUAL LOW-VALUES
  9784         MOVE ZEROES             TO FOLLOWO
  9785     ELSE
  9786         MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
  9787         MOVE ' '                TO DC-OPTION-CODE
  9788         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9789         MOVE DC-GREG-DATE-1-EDIT
  9790                                 TO FOLLOWO.
  9791
  9792     MOVE LA-FORM-A3             TO FORMO.
  9793     MOVE LA-GROUPING-A2         TO GROUPO.
  9794     MOVE LA-NO-OF-COPIES        TO COPIESO
  9795                                    PI-689-NUMBER-COPIES.
  9796
  9797     IF LA-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  9798         MOVE LA-PRINT-RESTRICTION
  9799                                 TO PRTRESTO
  9800     ELSE
  9801         MOVE SPACES             TO PRTRESTO.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 196
* EL689.cbl
  9802
  9803     IF  LA-RESEND-DATE = LOW-VALUES
  9804         MOVE ZEROES             TO RESEND1O
  9805     ELSE
  9806         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
  9807         MOVE ' '                TO DC-OPTION-CODE
  9808         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9809         MOVE DC-GREG-DATE-1-EDIT
  9810                                 TO RESEND1O.
  9811
  9812     MOVE LA-STATE-A2            TO STATEO.
  9813
  9814     MOVE LA-NUMBER-LABEL-LINES  TO PI-689-NUMBER-LABEL-LINES.
  9815
  9816 1040-EXIT.
  9817     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 197
* EL689.cbl
  9819 1050-MOVE-LABELS.
  9820
  9821     SET W-RG-NDX                TO LT-NDX.
  9822     MOVE ZEROS                  TO W-RC-PC (W-RG-NDX).
  9823     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
  9824     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
  9825
  9826 1050-EXIT.
  9827     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 198
* EL689.cbl
  9829 1060-DELETE-ADDRESS-RECORD.
  9830
  9831
  9832* EXEC CICS DELETE
  9833*        DATASET (W-ARCT-FILE-ID)
  9834*        RIDFLD  (W-DELETE-KEY)
  9835*    END-EXEC.
  9836*    MOVE '&(  R                 &   #00009595' TO DFHEIV0
  9837     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  9838     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9839     MOVE X'2020233030303039353935' TO DFHEIV0(25:11)
  9840     CALL 'kxdfhei1' USING DFHEIV0,
  9841           W-ARCT-FILE-ID,
  9842           W-DELETE-KEY,
  9843           DFHEIV99,
  9844           DFHEIV99,
  9845           DFHEIV99
  9846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9847
  9848
  9849
  9850* EXEC CICS READ
  9851*        DATASET (W-ARCH-FILE-ID)
  9852*        SET     (ADDRESS OF LETTER-ARCHIVE)
  9853*        RIDFLD  (W-ARCH-KEY)
  9854*        UPDATE
  9855*    END-EXEC.
  9856*    MOVE '&"S        EU         (   #00009600' TO DFHEIV0
  9857     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9858     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9859     MOVE X'2020233030303039363030' TO DFHEIV0(25:11)
  9860     CALL 'kxdfhei1' USING DFHEIV0,
  9861           W-ARCH-FILE-ID,
  9862           DFHEIV20,
  9863           DFHEIV99,
  9864           W-ARCH-KEY,
  9865           DFHEIV99,
  9866           DFHEIV99,
  9867           DFHEIV99
  9868     SET ADDRESS OF LETTER-ARCHIVE TO
  9869         DFHEIV20
  9870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9871
  9872
  9873     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES.
  9874
  9875
  9876* EXEC CICS REWRITE
  9877*         FROM      (LETTER-ARCHIVE)
  9878*         DATASET   (W-ARCH-FILE-ID)
  9879*    END-EXEC.
  9880     MOVE LENGTH OF
  9881      LETTER-ARCHIVE
  9882       TO DFHEIV11
  9883*    MOVE '&& L                  %   #00009609' TO DFHEIV0
  9884     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9885     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9886     MOVE X'2020233030303039363039' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 199
* EL689.cbl
  9887     CALL 'kxdfhei1' USING DFHEIV0,
  9888           W-ARCH-FILE-ID,
  9889           LETTER-ARCHIVE,
  9890           DFHEIV11,
  9891           DFHEIV99
  9892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9893
  9894
  9895 1060-EXIT.
  9896     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 200
* EL689.cbl
  9898 1070-ARCH-NOT-FOUND.
  9899
  9900     MOVE ER-7371                TO EMI-ERROR.
  9901     MOVE -1                     TO ARCHNUML.
  9902     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9903     GO TO 8100-SEND-INITIAL-MAP.
  9904
  9905 1080-ARCHIVE-TEXT-NOT-FOUND.
  9906
  9907     MOVE ER-7372                TO EMI-ERROR.
  9908     MOVE -1                     TO ARCHNUML.
  9909     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9910     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 201
* EL689.cbl
  9912 2000-CREATE.
  9913***************************************************************
  9914*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
  9915*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
  9916*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
  9917*    WILL BE DISPLAYED ON THE SCREEN.                         *
  9918*                                                             *
  9919***************************************************************
  9920
  9921***************************************************************
  9922*    CHECK TO SEE IF IT IS THE SAME REQUEST OR NOT.           *
  9923*    IF IT IS A NEW REQUEST AND A LETTER WAS PRINTED          *
  9924*    THEN FORCE AN ERROR.                                     *
  9925***************************************************************
  9926
  9927     IF  PI-689-CREATE-NO-SCREENS
  9928         GO TO 2000-GET-TEXT.
  9929
  9930     IF  PI-CREATE-MODE
  9931         IF  PI-689-PRINT-PERFORMED
  9932                 AND
  9933             FORMI NOT EQUAL 9999
  9934             MOVE ER-0279    TO EMI-ERROR
  9935             MOVE -1         TO MAINTL
  9936             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9937             GO TO 8200-SEND-DATAONLY.
  9938
  9939     IF  ARCHNUML GREATER THAN ZEROS
  9940         MOVE ER-9320            TO EMI-ERROR
  9941         MOVE -1                 TO ARCHNUML
  9942         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9943         GO TO 8200-SEND-DATAONLY.
  9944
  9945***************************************************************
  9946*    IF  A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE     *
  9947*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
  9948***************************************************************
  9949
  9950     IF  FORMI EQUAL '9999'
  9951         MOVE 16                 TO PI-TOTAL-LINES
  9952         MOVE 1                  TO PI-CURRENT-LINE
  9953         MOVE SPACES             TO W-FILE-TABLE
  9954                                    W-LINE-CONTROL-RECORD
  9955                                    W-RECORD-TABLE
  9956                                    W-SINGLE-LINE
  9957                                    W-SQUEEZED-LINE
  9958                                    W-TS-WORK-AREA
  9959                                    W-TX-TABLE
  9960         PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
  9961         MOVE '3'                TO PI-ACTION
  9962         MOVE FORMI              TO PI-689-FORM-NUMBER
  9963                                    PI-COMM-CONTROL
  9964         MOVE ZEROS              TO PI-UPDATE-SW
  9965         MOVE W-PGM-EL1042       TO W-CALL-PGM
  9966         GO TO 9400-XCTL.
  9967
  9968 2000-GET-TEXT.
  9969
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 202
* EL689.cbl
  9970     MOVE SPACES                 TO W-FILE-TABLE
  9971                                    W-LINE-CONTROL-RECORD
  9972                                    W-RECORD-TABLE
  9973                                    W-SINGLE-LINE
  9974                                    W-SQUEEZED-LINE
  9975                                    W-TS-WORK-AREA
  9976                                    W-TX-TABLE.
  9977     SET W-TG-NDX                TO +1
  9978     MOVE ZEROS                  TO W-INITIAL-COLUMN
  9979                                    W-LINE-COUNT
  9980                                    W-LINE-INDENT-1
  9981                                    W-LINE-INDENT-2
  9982                                    W-LINE-INDENT-3
  9983                                    W-LINE-INDENT-4
  9984                                    W-LINE-INDENT-5
  9985                                    W-PAGE
  9986                                    W-PARAGRAPH-INDENT
  9987                                    W-TOP-MARGIN
  9988                                    W-WORK-INDENT.
  9989     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  9990     MOVE +70                    TO W-LAST-COLUMN.
  9991     MOVE +56                    TO W-MAX-LINES-PER-PAGE.
  9992     MOVE +1                     TO W-START-COLUMN.
  9993     MOVE +71                    TO W-TOO-FAR.
  9994
  9995     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
  9996     MOVE FORMI                  TO W-TEXT-LETTER.
  9997     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
  9998     MOVE 'N'                    TO W-TEXT-BROWSED-SW.
  9999
 10000
 10001* EXEC CICS HANDLE CONDITION
 10002*         NOTFND     (2001-NOT-FOUND)
 10003*         ENDFILE    (2001-NOT-FOUND)
 10004*         NOTOPEN    (8050-TEXT-NOT-OPEN)
 10005*    END-EXEC.
 10006*    MOVE '"$I''J                 ! * #00009719' TO DFHEIV0
 10007     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 10008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10009     MOVE X'2A20233030303039373139' TO DFHEIV0(25:11)
 10010     CALL 'kxdfhei1' USING DFHEIV0
 10011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10012
 10013
 10014
 10015* EXEC CICS STARTBR
 10016*         DATASET    (W-TEXT-FILE-ID)
 10017*         RIDFLD     (W-TEXT-KEY)
 10018*         GTEQ
 10019*    END-EXEC.
 10020     MOVE 0
 10021       TO DFHEIV11
 10022*    MOVE '&,         G          &   #00009725' TO DFHEIV0
 10023     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10024     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10025     MOVE X'2020233030303039373235' TO DFHEIV0(25:11)
 10026     CALL 'kxdfhei1' USING DFHEIV0,
 10027           W-TEXT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 203
* EL689.cbl
 10028           W-TEXT-KEY,
 10029           DFHEIV99,
 10030           DFHEIV11,
 10031           DFHEIV99
 10032     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10033
 10034
 10035
 10036* EXEC CICS HANDLE CONDITION
 10037*         ENDFILE    (2000-ENDBR)
 10038*    END-EXEC.
 10039*    MOVE '"$''                   ! + #00009731' TO DFHEIV0
 10040     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 10041     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10042     MOVE X'2B20233030303039373331' TO DFHEIV0(25:11)
 10043     CALL 'kxdfhei1' USING DFHEIV0
 10044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10045
 10046
 10047 2000-READ-NEXT.
 10048
 10049     IF  W-TG-NDX GREATER THAN W-MAX-LINES
 10050         MOVE ER-0051            TO EMI-ERROR
 10051         MOVE -1                 TO MAINTL
 10052         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10053         GO TO 2000-ENDBR.
 10054
 10055
 10056* EXEC CICS READNEXT
 10057*         DATASET    (W-TEXT-FILE-ID)
 10058*         SET        (ADDRESS OF TEXT-FILES)
 10059*         RIDFLD     (W-TEXT-KEY)
 10060*    END-EXEC.
 10061     MOVE 0
 10062       TO DFHEIV11
 10063*    MOVE '&.S                   )   #00009743' TO DFHEIV0
 10064     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10065     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10066     MOVE X'2020233030303039373433' TO DFHEIV0(25:11)
 10067     CALL 'kxdfhei1' USING DFHEIV0,
 10068           W-TEXT-FILE-ID,
 10069           DFHEIV20,
 10070           DFHEIV99,
 10071           W-TEXT-KEY,
 10072           DFHEIV99,
 10073           DFHEIV11,
 10074           DFHEIV99,
 10075           DFHEIV99
 10076     SET ADDRESS OF TEXT-FILES TO
 10077         DFHEIV20
 10078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10079
 10080
 10081     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
 10082         GO TO 2000-ENDBR.
 10083
 10084     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
 10085
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 204
* EL689.cbl
 10086     MOVE TX-FORM-SQUEEZE-CONTROL
 10087                                 TO W-FORM-SQUEEZE-IND.
 10088
 10089     IF  PI-689-ARCHIVE-SW NOT GREATER THAN SPACES
 10090         MOVE TX-ARCHIVE-SW      TO PI-689-ARCHIVE-SW.
 10091
 10092     IF  TX-FORM-CONTROL-LINE
 10093         PERFORM 2100-PROCESS-FORM-CONTROL-LINE THRU 2100-EXIT
 10094         GO TO 2000-READ-NEXT.
 10095
 10096     IF  TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
 10097         PERFORM 2150-PROCESS-Z-CONTROLS THRU 2150-EXIT
 10098         GO TO 2000-READ-NEXT.
 10099
 10100     MOVE TX-TEXT-LINE           TO W-TX-TEXT (W-TG-NDX).
 10101     MOVE TX-PROCESS-CONTROL     TO W-TX-PC (W-TG-NDX).
 10102     PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT.
 10103     MOVE TX-LINE-SQUEEZE-CONTROL
 10104                                 TO W-TX-SC (W-TG-NDX).
 10105
 10106     SET W-TG-NDX UP BY 1.
 10107     GO TO 2000-READ-NEXT.
 10108
 10109 2000-ENDBR.
 10110
 10111
 10112* EXEC CICS ENDBR
 10113*        DATASET     (W-TEXT-FILE-ID)
 10114*    END-EXEC.
 10115     MOVE 0
 10116       TO DFHEIV11
 10117*    MOVE '&2                    $   #00009779' TO DFHEIV0
 10118     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 10119     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10120     MOVE X'2020233030303039373739' TO DFHEIV0(25:11)
 10121     CALL 'kxdfhei1' USING DFHEIV0,
 10122           W-TEXT-FILE-ID,
 10123           DFHEIV11,
 10124           DFHEIV99
 10125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10126
 10127
 10128     IF  W-TEXT-BROWSE-NOT-STARTED
 10129         MOVE ER-0006            TO EMI-ERROR
 10130         MOVE -1                 TO FORML
 10131         MOVE AL-UABON           TO FORMA
 10132         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10133         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10134
 10135     SET  W-TOTAL-TX-LINES       TO W-TG-NDX.
 10136     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
 10137     MOVE 1                      TO PI-CURRENT-LINE.
 10138
 10139     IF  COPIESL NOT GREATER THAN ZEROS
 10140         MOVE +1                 TO COPIESI
 10141                                    PI-689-NUMBER-COPIES
 10142         MOVE +1                 TO COPIESL
 10143         MOVE AL-UNNON           TO COPIESA.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 205
* EL689.cbl
 10144
 10145***************************************************************
 10146*    IF IT IS A FORM WITH VARIABLES, THEN RESOLVE ALL OF      *
 10147*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
 10148***************************************************************
 10149
 10150     PERFORM 6000-RESOLVE-VARIABLES THRU 6000-EXIT.
 10151
 10152     IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
 10153         IF  PI-689-CONTROL NOT GREATER THAN ZEROS
 10154             MOVE ER-7243        TO EMI-ERROR
 10155             MOVE -1             TO PRTRESTL
 10156             MOVE AL-UABON       TO PRTRESTA
 10157             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10158
 10159     IF  PI-CREATE-LABELS AND
 10160         NOT  PI-689-LABELS-OVERRIDEN
 10161         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 10162         SET W-RG-NDX UP BY +1
 10163     ELSE
 10164         SET W-RG-NDX            TO +1.
 10165
 10166     MOVE W-TOP-FORM             TO W-RC-TEXT (W-RG-NDX).
 10167     SET W-RG-NDX UP BY W-TOP-MARGIN.
 10168
 10169     PERFORM 7400-CREATE-LETTER THRU 7400-EXIT.
 10170
 10171     SET PI-TOTAL-LINES          TO W-RG-NDX.
 10172
 10173     IF  W-FIRST-BAD-VARIABLE-FOUND
 10174         SET W-RG-NDX            TO W-FIRST-BAD-VARIABLE
 10175         MOVE W-FIRST-BAD-VARIABLE
 10176                                 TO PI-CURRENT-LINE
 10177     ELSE
 10178         SET W-RG-NDX            TO 1.
 10179
 10180     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10181             VARYING
 10182         W-SC-NDX FROM 1 BY 1
 10183             UNTIL
 10184         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 10185     IF  PI-689-CREATE-NO-SCREENS
 10186         GO TO 2000-EXIT
 10187     ELSE
 10188         IF  W-FORM-CHANGED
 10189             MOVE '3'            TO PI-ACTION
 10190             MOVE -1             TO MAINTL
 10191             GO TO 8100-SEND-INITIAL-MAP
 10192         ELSE
 10193             MOVE '3'            TO PI-ACTION
 10194             MOVE -1             TO MAINTL
 10195             GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10196
 10197 2000-EXIT.
 10198     EXIT.
 10199
 10200 2001-NOT-FOUND.
 10201
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 206
* EL689.cbl
 10202     MOVE ER-0006                TO EMI-ERROR.
 10203     MOVE -1                     TO FORML.
 10204     MOVE AL-UABON               TO FORMA.
 10205     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10206     GO TO 8350-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 207
* EL689.cbl
 10208 2100-PROCESS-FORM-CONTROL-LINE.
 10209
 10210     MOVE TX-TEXT-LINE           TO W-LINE-CONTROL-RECORD.
 10211
 10212     IF  W-LC-LINE-WIDTH NUMERIC
 10213             AND
 10214         W-LC-LINE-WIDTH GREATER THAN ZEROS
 10215         COMPUTE W-INITIAL-COLUMN
 10216             = (70 - W-LC-LINE-WIDTH) / 2
 10217         COMPUTE W-START-COLUMN = W-INITIAL-COLUMN + 1
 10218         COMPUTE W-LAST-COLUMN ROUNDED
 10219             = W-INITIAL-COLUMN + W-LC-LINE-WIDTH
 10220         COMPUTE W-TOO-FAR = W-LAST-COLUMN + 1
 10221     ELSE
 10222         MOVE 70                 TO W-LC-LINE-WIDTH.
 10223
 10224     IF  W-LC-PARAGRAPH-INDENT NUMERIC
 10225             AND
 10226         W-LC-PARAGRAPH-INDENT GREATER THAN ZEROS
 10227         MOVE W-LC-PARAGRAPH-INDENT
 10228                                 TO W-PARAGRAPH-INDENT.
 10229
 10230     IF  W-LC-MAX-LINES-PER-PAGE NUMERIC
 10231             AND
 10232         W-LC-MAX-LINES-PER-PAGE GREATER THAN ZEROS
 10233         MOVE W-LC-MAX-LINES-PER-PAGE
 10234                                 TO W-MAX-LINES-PER-PAGE.
 10235
 10236     IF  W-LC-LINE-ADJUST NUMERIC
 10237             AND
 10238         W-LC-LINE-ADJUST GREATER THAN ZEROS
 10239         COMPUTE W-TOTAL-LINE-LENGTH
 10240             = W-LC-LINE-WIDTH + (W-LC-LINE-ADJUST * 2)
 10241         IF  W-TOTAL-LINE-LENGTH LESS THAN +71
 10242             ADD W-LC-LINE-ADJUST
 10243                                 TO W-INITIAL-COLUMN
 10244                                    W-LAST-COLUMN
 10245                                    W-START-COLUMN
 10246                                    W-TOO-FAR.
 10247
 10248     IF  W-LC-LINE-INDENT-1 NUMERIC
 10249             AND
 10250         W-LC-LINE-INDENT-1 LESS THAN W-LC-LINE-WIDTH
 10251         MOVE W-LC-LINE-INDENT-1 TO W-LINE-INDENT-1
 10252     ELSE
 10253         MOVE +0                 TO W-LINE-INDENT-1.
 10254
 10255     IF  W-LC-LINE-INDENT-2 NUMERIC
 10256             AND
 10257         W-LC-LINE-INDENT-2 LESS THAN W-LC-LINE-WIDTH
 10258         MOVE W-LC-LINE-INDENT-2 TO W-LINE-INDENT-2
 10259     ELSE
 10260         MOVE +0                 TO W-LINE-INDENT-2.
 10261
 10262     IF  W-LC-LINE-INDENT-3 NUMERIC
 10263             AND
 10264         W-LC-LINE-INDENT-3 LESS THAN W-LC-LINE-WIDTH
 10265         MOVE W-LC-LINE-INDENT-3 TO W-LINE-INDENT-3
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 208
* EL689.cbl
 10266     ELSE
 10267         MOVE +0                 TO W-LINE-INDENT-3.
 10268
 10269     IF  W-LC-LINE-INDENT-4 NUMERIC
 10270             AND
 10271         W-LC-LINE-INDENT-4 LESS THAN W-LC-LINE-WIDTH
 10272         MOVE W-LC-LINE-INDENT-4 TO W-LINE-INDENT-4
 10273     ELSE
 10274         MOVE +0                 TO W-LINE-INDENT-4.
 10275
 10276     IF  W-LC-LINE-INDENT-5 NUMERIC
 10277             AND
 10278         W-LC-LINE-INDENT-5 LESS THAN W-LC-LINE-WIDTH
 10279         MOVE W-LC-LINE-INDENT-5 TO W-LINE-INDENT-5
 10280
 10281     ELSE
 10282         MOVE +0                 TO W-LINE-INDENT-5.
 10283
 10284     IF  W-LC-TOP-MARGIN NUMERIC
 10285         MOVE W-LC-TOP-MARGIN    TO W-TOP-MARGIN
 10286     ELSE
 10287         MOVE +0                 TO W-TOP-MARGIN.
 10288
 10289     IF W-LC-CASE-IND = 'Y' OR 'N'
 10290         NEXT SENTENCE
 10291     ELSE
 10292         MOVE PI-LOWER-CASE-LETTERS
 10293                                 TO W-LC-CASE-IND.
 10294
 10295 2100-EXIT.
 10296     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 209
* EL689.cbl
 10298 2150-PROCESS-Z-CONTROLS.
 10299
 10300     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
 10301
 10302     IF PI-689-RESEND-DATE-1 = LOW-VALUES
 10303        IF W-DAYS-TO-RESEND NUMERIC
 10304           IF W-DAYS-TO-RESEND > ZEROS
 10305              MOVE '6'           TO DC-OPTION-CODE
 10306              MOVE W-SAVE-BIN-DATE
 10307                                 TO DC-BIN-DATE-1
 10308              MOVE ZEROS         TO DC-ELAPSED-MONTHS
 10309              MOVE W-DAYS-TO-RESEND
 10310                                 TO DC-ELAPSED-DAYS
 10311              PERFORM 9500-LINK-DATE-CONVERT
 10312                                 THRU 9500-EXIT
 10313              IF NO-CONVERSION-ERROR
 10314                 MOVE DC-BIN-DATE-2
 10315                                 TO PI-689-RESEND-DATE-1
 10316                 MOVE DC-GREG-DATE-1-EDIT
 10317                                 TO RESEND1O
 10318                                    PI-689-RESEND1-EDIT
 10319                 MOVE AL-UANON
 10320                                 TO RESEND1A
 10321                 MOVE +8         TO RESEND1L
 10322              ELSE
 10323                 MOVE ER-3770
 10324                                 TO EMI-ERROR
 10325                 MOVE -1         TO MAINTL
 10326                 PERFORM 9900-ERROR-FORMAT
 10327                                 THRU 9900-EXIT
 10328                 GO TO 8200-SEND-DATAONLY
 10329              END-IF
 10330           END-IF
 10331        END-IF
 10332     END-IF
 10333     IF W-FORM-TO-RESEND NOT = SPACES AND ZEROS
 10334        MOVE W-FORM-TO-RESEND    TO PI-689-RESEND-LETR-1
 10335     END-IF
 10336     IF  PI-689-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10337         IF  W-DAYS-TO-FOLLOW-UP NUMERIC
 10338             IF  W-DAYS-TO-FOLLOW-UP GREATER THAN ZEROS
 10339                 MOVE '6'        TO DC-OPTION-CODE
 10340                 MOVE W-SAVE-BIN-DATE
 10341                                 TO DC-BIN-DATE-1
 10342                 MOVE ZEROS      TO DC-ELAPSED-MONTHS
 10343                 MOVE W-DAYS-TO-FOLLOW-UP
 10344                                 TO DC-ELAPSED-DAYS
 10345                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10346                 IF  NO-CONVERSION-ERROR
 10347                     MOVE DC-BIN-DATE-2
 10348                                 TO PI-689-FOLLOW-UP-DATE
 10349                     MOVE DC-GREG-DATE-1-EDIT
 10350                                 TO FOLLOWO
 10351                     MOVE AL-UANON
 10352                                 TO FOLLOWA
 10353                     MOVE +8     TO FOLLOWL
 10354                 ELSE
 10355                     MOVE ER-3771
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 210
* EL689.cbl
 10356                                 TO EMI-ERROR
 10357                     MOVE -1     TO MAINTL
 10358                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10359                     GO TO 8200-SEND-DATAONLY.
 10360
 10361     IF  COPIESI NOT NUMERIC
 10362             OR
 10363         COPIESI NOT GREATER THAN ZEROS
 10364         IF  W-NUMBER-OF-COPIES NUMERIC
 10365             IF  W-NUMBER-OF-COPIES GREATER THAN ZEROS
 10366                 MOVE W-NUMBER-OF-COPIES
 10367                                 TO COPIESI
 10368                                    PI-689-NUMBER-COPIES
 10369                 MOVE AL-UNNON   TO COPIESA
 10370                 MOVE +1         TO COPIESL
 10371             ELSE
 10372                 MOVE +1         TO COPIESI
 10373                                    PI-689-NUMBER-COPIES
 10374                 MOVE AL-UNNON   TO COPIESA
 10375                 MOVE +1         TO COPIESL
 10376         ELSE
 10377             MOVE +1             TO COPIESI
 10378                                    PI-689-NUMBER-COPIES
 10379             MOVE AL-UNNON       TO COPIESA
 10380             MOVE +1             TO COPIESL.
 10381
 10382*    IF  PI-689-PRINT-RESTRICTION NOT = 'C' AND 'F' AND 'P' AND
 10383*                                       SPACES
 10384*        IF  W-PRINT-RESTRICTED
 10385*            MOVE W-PRINT-RESTRICTED-IND
 10386*                                TO PRTRESTI
 10387*                                   PI-689-PRINT-RESTRICTION
 10388*            MOVE AL-UANON       TO PRTRESTA
 10389*            MOVE +1             TO PRTRESTL.
 10390     .
 10391 2150-EXIT.
 10392     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 211
* EL689.cbl
 10394 2200-CHECK-FOR-VARIABLE.
 10395
 10396     IF  W-TX-TEXT (W-TG-NDX) EQUAL SPACES
 10397         GO TO 2200-EXIT.
 10398
 10399     SET W-TX-NDX                TO +1.
 10400
 10401 2200-CONTINUE.
 10402
 10403     SEARCH W-TX-CHAR
 10404         VARYING
 10405             W-TX-NDX
 10406         AT END
 10407             GO TO 2200-EXIT
 10408         WHEN
 10409             W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 10410             NEXT SENTENCE.
 10411
 10412     SET W-TX-NDX UP BY +1.
 10413
 10414     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 10415         PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
 10416         GO TO 2200-CONTINUE.
 10417
 10418 2200-EXIT.
 10419     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 212
* EL689.cbl
 10421 2220-BUILD-VARIABLE-NUMBER.
 10422
 10423     SET W-TX-NDX UP BY +1.
 10424     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V1.
 10425     SET W-TX-NDX UP BY +1.
 10426     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V2.
 10427     SET W-TX-NDX UP BY +1.
 10428     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V3.
 10429
 10430     IF  W-VAR-RELATIVE-NUM NUMERIC
 10431         SET W-FILE-NDX TO W-VARIABLE-SOURCE (W-VAR-RELATIVE-NUM)
 10432         MOVE 'Y' TO W-FILE-USE-IND (W-FILE-NDX).
 10433
 10434 2220-EXIT.
 10435     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 213
* EL689.cbl
 10437 4000-ROLL-PAGE.
 10438
 10439     IF  ENTERPFL NOT EQUAL ZEROS
 10440         MOVE -1                 TO ENTERPFL
 10441     ELSE
 10442         MOVE -1                 TO MAINTL.
 10443
 10444     IF  PI-TOTAL-LINES EQUAL 0
 10445         MOVE ER-0047            TO EMI-ERROR
 10446         MOVE -1                 TO MAINTL
 10447         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10448         GO TO 8200-SEND-DATAONLY.
 10449
 10450     COMPUTE W-TEMP-CURRENT-LINE EQUAL
 10451         PI-CURRENT-LINE + W-ROLL-COUNTER.
 10452
 10453     IF  W-TEMP-CURRENT-LINE NEGATIVE
 10454             OR
 10455         W-TEMP-CURRENT-LINE EQUAL ZEROS
 10456         MOVE ER-0067            TO EMI-ERROR
 10457         MOVE -1                 TO MAINTL
 10458         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10459         MOVE 1                  TO W-TEMP-CURRENT-LINE.
 10460
 10461     IF  W-TEMP-CURRENT-LINE GREATER THAN PI-TOTAL-LINES
 10462             AND
 10463         (EIBAID EQUAL DFHPF1 OR DFHPF6)
 10464         MOVE ER-0066            TO EMI-ERROR
 10465         MOVE -1                 TO MAINTL
 10466         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10467         COMPUTE W-TEMP-CURRENT-LINE
 10468             = PI-TOTAL-LINES + 1 - W-NUM-LINES-PER-SCREEN
 10469         IF  W-TEMP-CURRENT-LINE NEGATIVE
 10470                 OR
 10471             W-TEMP-CURRENT-LINE = ZEROS
 10472             MOVE 1 TO W-TEMP-CURRENT-LINE.
 10473
 10474     IF  EMI-ERROR NOT EQUAL ER-0191
 10475             AND
 10476         MAINTI NOT EQUAL 'S'
 10477         PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
 10478         PERFORM 4100-SET-NDX THRU 4100-EXIT
 10479         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 10480                 VARYING
 10481             W-SC-NDX FROM 1 BY 1
 10482                 UNTIL
 10483             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10484
 10485     IF  EMI-ERROR EQUAL ER-0066 OR ER-0067 OR ER-0000 OR
 10486                         ER-0191
 10487         NEXT SENTENCE
 10488     ELSE
 10489         GO TO 8200-SEND-DATAONLY.
 10490
 10491     MOVE W-TEMP-CURRENT-LINE    TO PI-CURRENT-LINE
 10492     SET W-RG-NDX                TO PI-CURRENT-LINE
 10493     MOVE LOW-VALUES             TO EL689RI
 10494*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 214
* EL689.cbl
 10495     PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
 10496     SET W-RG-NDX                TO PI-CURRENT-LINE
 10497     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10498             VARYING
 10499         W-SC-NDX FROM 1 BY 1
 10500             UNTIL
 10501         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 10502
 10503     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 215
* EL689.cbl
 10505 4100-SET-NDX.
 10506
 10507     IF  PI-CURRENT-LINE EQUAL 0
 10508         SET W-RG-NDX            TO 1
 10509     ELSE
 10510         SET W-RG-NDX            TO PI-CURRENT-LINE.
 10511
 10512 4100-EXIT.
 10513      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 216
* EL689.cbl
 10515 4200-UPDATE-TABLE-FROM-SCREEN.
 10516
 10517     IF  W-SC-TEXTL (W-SC-NDX) NOT EQUAL ZEROS
 10518         MOVE ZEROS              TO W-SC-TEXTL (W-SC-NDX)
 10519         IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 10520             IF  PI-TOTAL-LINES EQUAL W-MAX-LINES
 10521                 MOVE ER-0051    TO EMI-ERROR
 10522                 MOVE -1         TO MAINTL
 10523                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10524                 GO TO 8200-SEND-DATAONLY
 10525             ELSE
 10526                 MOVE W-SC-TEXT (W-SC-NDX)
 10527                                 TO W-RC-TEXT (W-RG-NDX)
 10528                 ADD 1           TO PI-TOTAL-LINES
 10529         ELSE
 10530             MOVE W-SC-TEXT (W-SC-NDX)
 10531                                 TO W-RC-TEXT (W-RG-NDX).
 10532
 10533     SET W-RG-NDX UP BY 1.
 10534
 10535 4200-EXIT.
 10536      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 217
* EL689.cbl
 10538 5000-EDIT-MODE.
 10539***************************************************************
 10540*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
 10541*    AND THE W-TS-TABLE OF LETTER TEXT.  IT WILL THEN         *
 10542*    TRANSFER TO THE W-TEXT-EDITOR PROGRAM.                   *
 10543***************************************************************
 10544
 10545     IF  PI-SHOW-MODE
 10546         MOVE ER-0188            TO EMI-ERROR
 10547         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10548         MOVE -1                 TO MAINTL
 10549         MOVE AL-UABON           TO MAINTA
 10550         GO TO 8200-SEND-DATAONLY.
 10551
 10552     IF  PI-CURRENT-LINE EQUAL ZEROS
 10553         MOVE ER-0187            TO EMI-ERROR
 10554         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10555         MOVE -1                 TO MAINTL
 10556         GO TO 8200-SEND-DATAONLY.
 10557
 10558     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 10559     PERFORM 4100-SET-NDX THRU 4100-EXIT.
 10560     PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 10561             VARYING
 10562         W-SC-NDX FROM 1 BY 1
 10563             UNTIL
 10564         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10565
 10566     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 10567
 10568     MOVE PI-689-FORM-NUMBER     TO PI-COMM-CONTROL.
 10569     MOVE ZEROS                  TO PI-UPDATE-SW.
 10570     MOVE '1'                    TO PI-ENTRY-CD-1.
 10571     MOVE W-PGM-EL1042           TO W-CALL-PGM.
 10572     GO TO 9400-XCTL.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 218
* EL689.cbl
 10574 5400-LETTER-RELEASE.
 10575***************************************************************
 10576*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
 10577*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS IN       *
 10578*    THE ARCHIVE FILE.                                        *
 10579*    THE FUNCTIONS BELOW WILL BE PERFORMED.                   *
 10580*        1. CHECK SECURITY.                                   *
 10581*        2. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS.        *
 10582*        3. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
 10583*        4. WRITE THE NEW ARCHIVE RECORDS FROM W-TS-TABLE.    *
 10584*        5. RESET INSURED'S CONTROL FIELDS AND RETURN THE     *
 10585*           ARCHIVE NUMBER USED  TO FILE THE RECORDS.         *
 10586***************************************************************
 10587
 10588     IF  NOT MODIFY-CAP
 10589         MOVE ER-0070            TO EMI-ERROR
 10590         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10591         MOVE -1                 TO MAINTL
 10592         GO TO 8200-SEND-DATAONLY.
 10593
 10594     IF  PI-SHOW-MODE
 10595         MOVE ER-0188            TO EMI-ERROR
 10596         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10597         MOVE -1                 TO MAINTL
 10598         MOVE AL-UABON           TO MAINTA
 10599         GO TO 8200-SEND-DATAONLY.
 10600
 10601     IF  ARCHNUML GREATER THAN ZEROS
 10602         MOVE ER-9320            TO EMI-ERROR
 10603         MOVE -1                 TO ARCHNUML
 10604         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10605         GO TO 8200-SEND-DATAONLY.
 10606
 10607     IF  PI-CURRENT-LINE EQUAL ZEROS
 10608         MOVE ER-0187            TO EMI-ERROR
 10609         MOVE -1                 TO MAINTL
 10610         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10611         GO TO 8200-SEND-DATAONLY.
 10612
 10613     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 10614     IF  NOT PI-689-CREATE-NO-SCREENS
 10615         PERFORM 4100-SET-NDX THRU 4100-EXIT
 10616         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 10617                 VARYING
 10618             W-SC-NDX FROM 1 BY 1
 10619                 UNTIL
 10620             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 10621         IF  EMI-FATAL-CTR GREATER THAN ZEROS
 10622                 OR
 10623             PI-689-FATAL-ERROR
 10624             GO TO 8200-SEND-DATAONLY.
 10625
 10626     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 10627     PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 10628             VARYING
 10629         W-RVS-NDX FROM +1 BY +1
 10630             UNTIL
 10631         W-RVS-NDX > +36500
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 219
* EL689.cbl
 10632             OR
 10633         W-REMAINING-VAR-FOUND.
 10634
 10635     IF  NOT PI-689-CREATE-NO-SCREENS
 10636         IF  W-REMAINING-VAR-FOUND
 10637             GO TO 4000-ROLL-PAGE.
 10638
 10639     MOVE SPACES                 TO W-CNTL-KEY.
 10640     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10641     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 10642     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 10643
 10644
 10645* EXEC CICS HANDLE CONDITION
 10646*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 10647*         NOTFND     (5470-CNTL-NOT-FOUND)
 10648*    END-EXEC.
 10649*    MOVE '"$JI                  ! , #00010299' TO DFHEIV0
 10650     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 10651     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10652     MOVE X'2C20233030303130323939' TO DFHEIV0(25:11)
 10653     CALL 'kxdfhei1' USING DFHEIV0
 10654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10655
 10656
 10657
 10658* EXEC CICS READ
 10659*         DATASET    (W-CNTL-FILE-ID)
 10660*         SET        (ADDRESS OF CONTROL-FILE)
 10661*         RIDFLD     (W-CNTL-KEY)
 10662*         UPDATE
 10663*    END-EXEC.
 10664*    MOVE '&"S        EU         (   #00010304' TO DFHEIV0
 10665     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10666     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10667     MOVE X'2020233030303130333034' TO DFHEIV0(25:11)
 10668     CALL 'kxdfhei1' USING DFHEIV0,
 10669           W-CNTL-FILE-ID,
 10670           DFHEIV20,
 10671           DFHEIV99,
 10672           W-CNTL-KEY,
 10673           DFHEIV99,
 10674           DFHEIV99,
 10675           DFHEIV99
 10676     SET ADDRESS OF CONTROL-FILE TO
 10677         DFHEIV20
 10678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10679
 10680
 10681     IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
 10682         MOVE ZEROS              TO CF-CREDIT-LAST-ARCH-NUM
 10683                                    CF-CREDIT-START-ARCH-NUM.
 10684
 10685     ADD 1                       TO CF-CREDIT-LAST-ARCH-NUM.
 10686     MOVE CF-CREDIT-LAST-ARCH-NUM
 10687                                 TO W-ARCH-NUMBER
 10688                                    W-ARCT-NUMBER.
 10689
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 220
* EL689.cbl
 10690
 10691* EXEC CICS REWRITE
 10692*         FROM      (CONTROL-FILE)
 10693*         DATASET   (W-CNTL-FILE-ID)
 10694*    END-EXEC
 10695     MOVE LENGTH OF
 10696      CONTROL-FILE
 10697       TO DFHEIV11
 10698*    MOVE '&& L                  %   #00010320' TO DFHEIV0
 10699     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10700     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10701     MOVE X'2020233030303130333230' TO DFHEIV0(25:11)
 10702     CALL 'kxdfhei1' USING DFHEIV0,
 10703           W-CNTL-FILE-ID,
 10704           CONTROL-FILE,
 10705           DFHEIV11,
 10706           DFHEIV99
 10707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10708
 10709
 10710* EXEC CICS HANDLE CONDITION
 10711*         NOTOPEN   (8010-ARCH-NOT-OPEN)
 10712*    END-EXEC.
 10713*    MOVE '"$J                   ! - #00010325' TO DFHEIV0
 10714     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
 10715     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10716     MOVE X'2D20233030303130333235' TO DFHEIV0(25:11)
 10717     CALL 'kxdfhei1' USING DFHEIV0
 10718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10719
 10720
 10721     IF  PI-689-CREATE-NO-SCREENS
 10722         IF  PI-689-GET-ARCH-MAIN
 10723
 10724* EXEC CICS GETMAIN
 10725*                 SET      (ADDRESS OF LETTER-ARCHIVE)
 10726*                 LENGTH   (W-ARCH-LENGTH)
 10727*            END-EXEC
 10728*    MOVE '," L                  $   #00010331' TO DFHEIV0
 10729     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10730     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10731     MOVE X'2020233030303130333331' TO DFHEIV0(25:11)
 10732     CALL 'kxdfhei1' USING DFHEIV0,
 10733           DFHEIV20,
 10734           W-ARCH-LENGTH,
 10735           DFHEIV99
 10736     SET ADDRESS OF LETTER-ARCHIVE TO
 10737         DFHEIV20
 10738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10739             SET LCP-WS-ADDR-PNTR TO ADDRESS OF LETTER-ARCHIVE
 10740             MOVE LCP-WS-ADDR-COMP TO PI-689-ARCH-POINTER
 10741         ELSE
 10742             MOVE PI-689-ARCH-POINTER
 10743                                 TO LCP-WS-ADDR-COMP
 10744             SET ADDRESS OF LETTER-ARCHIVE TO LCP-WS-ADDR-PNTR
 10745     ELSE
 10746
 10747* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 221
* EL689.cbl
 10748*             SET      (ADDRESS OF LETTER-ARCHIVE)
 10749*             LENGTH   (W-ARCH-LENGTH)
 10750*        END-EXEC.
 10751*    MOVE '," L                  $   #00010342' TO DFHEIV0
 10752     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10753     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10754     MOVE X'2020233030303130333432' TO DFHEIV0(25:11)
 10755     CALL 'kxdfhei1' USING DFHEIV0,
 10756           DFHEIV20,
 10757           W-ARCH-LENGTH,
 10758           DFHEIV99
 10759     SET ADDRESS OF LETTER-ARCHIVE TO
 10760         DFHEIV20
 10761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10762
 10763
 10764     MOVE SPACES                 TO LETTER-ARCHIVE.
 10765     MOVE 'LA'                   TO LA-RECORD-ID.
 10766     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
 10767                                    LA-ARCHIVE-NO-A2
 10768                                    LA-ARCHIVE-NO-A3
 10769                                    LA-ARCHIVE-NO-A4
 10770                                    LA-ARCHIVE-NO-A5
 10771                                    LA-ARCHIVE-NO-A6
 10772                                    PI-689-ARCHIVE-NUMBER.
 10773     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 10774                                    LA-COMPANY-CD-A2
 10775                                    LA-COMPANY-CD-A3
 10776                                    LA-COMPANY-CD-A4
 10777                                    LA-COMPANY-CD-A5
 10778                                    LA-COMPANY-CD-A6.
 10779     MOVE PI-689-CARRIER         TO LA-CARRIER-A2
 10780                                    LA-CARRIER-A3
 10781                                    LA-CARRIER-A4
 10782                                    LA-CARRIER-A5.
 10783     MOVE PI-689-EFF-DATE        TO LA-EFFECT-DATE-A2.
 10784     MOVE PI-689-GROUPING        TO LA-GROUPING-A2
 10785                                    LA-GROUPING-A3
 10786                                    LA-GROUPING-A4
 10787                                    LA-GROUPING-A5.
 10788     MOVE PI-689-ACCOUNT         TO LA-ACCOUNT-A2
 10789                                    LA-ACCOUNT-A3
 10790                                    LA-ACCOUNT-A4
 10791                                    LA-ACCOUNT-A5.
 10792     MOVE PI-689-STATE           TO LA-STATE-A2
 10793                                    LA-STATE-A3
 10794                                    LA-STATE-A4
 10795                                    LA-STATE-A5.
 10796
 10797     IF  PI-689-DATA-SOURCE EQUAL '3'
 10798             AND
 10799         PI-689-RESP-PERSON GREATER THAN SPACES
 10800         MOVE PI-689-RESP-PERSON
 10801                                 TO LA-RESP-PERSON-A2
 10802         MOVE PI-689-TYPE        TO LA-TYPE-A2
 10803     ELSE
 10804         IF  PI-689-CERT-PRIME GREATER THAN SPACES
 10805             MOVE PI-689-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 222
* EL689.cbl
 10806                                 TO LA-CERT-PRIME-A2
 10807             MOVE PI-689-CERT-SFX
 10808                                 TO LA-CERT-SUFFIX-A2
 10809         ELSE
 10810             MOVE LOW-VALUE      TO LA-RESP-PERSON-A2
 10811                                    LA-TYPE-A2.
 10812
 10813     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 10814         MOVE PI-689-ENTRY-BATCH TO LA-ENTRY-A6
 10815         IF  PI-689-CONTROL GREATER THAN ZEROS
 10816                 AND
 10817             PI-689-PRINT-RESTRICTION EQUAL 'C'
 10818             MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 10819             MOVE 'CK'           TO LA-FILLER
 10820         ELSE
 10821             NEXT SENTENCE
 10822     ELSE
 10823         IF  PI-689-CONTROL GREATER THAN ZEROS
 10824             MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 10825             MOVE 'CK'           TO LA-FILLER
 10826         ELSE
 10827             MOVE LOW-VALUES     TO LA-ENTRY-A6.
 10828
 10829     MOVE ZEROS                  TO W-SEQ-CTR.
 10830
 10831     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
 10832
 10833     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
 10834                                    LA-INITIAL-PRINT-DATE
 10835                                    LA-SENT-DATE
 10836                                    LA-REPLY-DATE.
 10837     MOVE 'A'                    TO LA-STATUS.
 10838
 10839     IF  PI-689-NUMBER-COPIES NOT NUMERIC
 10840             OR
 10841         PI-689-NUMBER-COPIES EQUAL ZEROS
 10842         MOVE  1                 TO LA-NO-OF-COPIES
 10843     ELSE
 10844         MOVE PI-689-NUMBER-COPIES
 10845                                 TO LA-NO-OF-COPIES.
 10846
 10847     MOVE PI-689-FORM-NUMBER     TO LA-FORM-A3.
 10848     MOVE PI-689-FOLLOW-UP-DATE  TO LA-FOLLOW-UP-DATE.
 10849     MOVE PI-689-PRINT-RESTRICTION
 10850                                 TO LA-PRINT-RESTRICTION
 10851     MOVE PI-689-LABEL-SOURCE    TO LA-ADDR-SOURCE.
 10852     MOVE PI-689-DATA-SOURCE     TO LA-DATA-SOURCE.
 10853     MOVE PI-689-RESEND-DATE-1   TO LA-RESEND-DATE
 10854     MOVE PI-689-RESEND-LETR-1   TO LA-RESEND-LETR
 10855     MOVE W-CURRENT-SAVE         TO LA-CREATION-DATE.
 10856
 10857     IF  PI-689-PRINT-PERFORMED
 10858         MOVE SPACES             TO PI-689-PRINT-SW
 10859         MOVE W-CURRENT-SAVE     TO LA-INITIAL-PRINT-DATE
 10860         IF  LA-RESEND-DATE = LOW-VALUES
 10861             MOVE 'C'            TO LA-STATUS.
 10862
 10863     MOVE PI-689-NUMBER-LABEL-LINES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 223
* EL689.cbl
 10864                                 TO LA-NUMBER-LABEL-LINES.
 10865     MOVE ZEROS                  TO PI-689-NUMBER-TEXT-RECORDS.
 10866
 10867     PERFORM 5410-CREATE-TEXT-RECORDS THRU 5410-EXIT.
 10868
 10869     MOVE PI-689-NUMBER-TEXT-RECORDS
 10870                                 TO LA-NO-OF-TEXT-RECORDS.
 10871
 10872
 10873* EXEC CICS HANDLE CONDITION
 10874*        DUPREC    (5460-DUPLICATE-ARCHIVE-RCD)
 10875*    END-EXEC.
 10876*    MOVE '"$%                   ! . #00010455' TO DFHEIV0
 10877     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10879     MOVE X'2E20233030303130343535' TO DFHEIV0(25:11)
 10880     CALL 'kxdfhei1' USING DFHEIV0
 10881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10882
 10883
 10884     PERFORM 5650-WRITE-ARCHIVE THRU 5650-EXIT.
 10885
 10886     IF  PI-689-CREATE-NO-SCREENS
 10887         GO TO 5400-END.
 10888
 10889     MOVE ER-0280                TO EMI-ERROR.
 10890     MOVE -1                     TO MAINTL.
 10891     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10892     MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 10893     MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1).
 10894
 10895 5400-END.
 10896
 10897     MOVE '2'                    TO PI-ACTION.
 10898     MOVE ZEROS                  TO PI-TOTAL-LINES
 10899                                    PI-CURRENT-LINE.
 10900     MOVE SPACES                 TO PI-689-PRINT-SW
 10901                                    PI-689-FORM-NUMBER.
 10902
 10903     IF  PI-689-CREATE-NO-SCREENS
 10904         GO TO 5400-EXIT
 10905     ELSE
 10906         MOVE LOW-VALUES         TO EL689AI
 10907         MOVE -1                 TO MAINTL
 10908         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 10909
 10910 5400-EXIT.
 10911     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 224
* EL689.cbl
 10913 5410-CREATE-TEXT-RECORDS.
 10914
 10915
 10916* EXEC CICS HANDLE CONDITION
 10917*         NOTOPEN   (8015-ARCT-NOT-OPEN)
 10918*         DUPREC    (5465-DUPLICATE-ARCH-TEXT)
 10919*    END-EXEC.
 10920*    MOVE '"$J%                  ! / #00010490' TO DFHEIV0
 10921     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 10922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10923     MOVE X'2F20233030303130343930' TO DFHEIV0(25:11)
 10924     CALL 'kxdfhei1' USING DFHEIV0
 10925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10926
 10927
 10928     IF  PI-689-CREATE-NO-SCREENS
 10929         IF  PI-689-GET-ARCT-MAIN
 10930
 10931* EXEC CICS GETMAIN
 10932*                 SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10933*                 LENGTH   (W-ARCT-LENGTH)
 10934*            END-EXEC
 10935*    MOVE '," L                  $   #00010497' TO DFHEIV0
 10936     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10937     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10938     MOVE X'2020233030303130343937' TO DFHEIV0(25:11)
 10939     CALL 'kxdfhei1' USING DFHEIV0,
 10940           DFHEIV20,
 10941           W-ARCT-LENGTH,
 10942           DFHEIV99
 10943     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
 10944         DFHEIV20
 10945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10946             SET LCP-WS-ADDR-PNTR TO ADDRESS OF
 10947                                     LETTER-ARCHIVE-TEXT
 10948             MOVE LCP-WS-ADDR-COMP
 10949                                 TO PI-689-ARCT-POINTER
 10950         ELSE
 10951             MOVE PI-689-ARCT-POINTER
 10952                                 TO LCP-WS-ADDR-COMP
 10953             SET ADDRESS OF LETTER-ARCHIVE-TEXT
 10954                                 TO LCP-WS-ADDR-PNTR
 10955     ELSE
 10956
 10957* EXEC CICS GETMAIN
 10958*             SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10959*             LENGTH   (W-ARCT-LENGTH)
 10960*        END-EXEC.
 10961*    MOVE '," L                  $   #00010511' TO DFHEIV0
 10962     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10963     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10964     MOVE X'2020233030303130353131' TO DFHEIV0(25:11)
 10965     CALL 'kxdfhei1' USING DFHEIV0,
 10966           DFHEIV20,
 10967           W-ARCT-LENGTH,
 10968           DFHEIV99
 10969     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
 10970         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 225
* EL689.cbl
 10971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10972
 10973
 10974     PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 10975
 10976     MOVE ZEROS                  TO W-SEQ-CTR
 10977
 10978     IF  PI-CREATE-LABELS AND
 10979         NOT PI-689-LABELS-OVERRIDEN
 10980         MOVE '1'                TO LT-RECORD-TYPE
 10981         MOVE +0                 TO LT-LINE-SEQ-NO
 10982         PERFORM 5600-FORMAT-ADDRESS-LINE THRU 5600-EXIT
 10983                 VARYING
 10984             W-RG-NDX FROM 1 BY 1
 10985                 UNTIL
 10986             W-RG-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 10987         PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 10988         PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT
 10989     ELSE
 10990         SET W-RG-NDX            TO +1.
 10991
 10992     SET LT-NDX                  TO W-ZEROS.
 10993
 10994     PERFORM 5500-FORMAT-TEXT THRU 5500-EXIT
 10995             VARYING
 10996         W-RG-NDX FROM W-RG-NDX BY +1
 10997             UNTIL
 10998         W-RG-NDX GREATER THAN PI-TOTAL-LINES.
 10999
 11000 5410-EXIT.
 11001     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 226
* EL689.cbl
 11003 5415-INITIALIZE-TEXT.
 11004
 11005     MOVE SPACES                 TO LETTER-ARCHIVE-TEXT.
 11006     MOVE 'LT'                   TO LT-RECORD-ID.
 11007
 11008     MOVE LA-ARCHIVE-NO          TO LT-ARCHIVE-NO.
 11009     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
 11010
 11011     MOVE ZEROS                  TO LT-LINE-SEQ-NO
 11012                                    LT-NUM-LINES-ON-RECORD.
 11013
 11014 5415-EXIT.
 11015     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 227
* EL689.cbl
 11017 5460-DUPLICATE-ARCHIVE-RCD.
 11018
 11019     IF  NOT PI-689-CREATE-NO-SCREENS
 11020
 11021* EXEC CICS SYNCPOINT ROLLBACK
 11022*        END-EXEC.
 11023*    MOVE '6"R                   !   #00010562' TO DFHEIV0
 11024     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11025     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11026     MOVE X'2020233030303130353632' TO DFHEIV0(25:11)
 11027     CALL 'kxdfhei1' USING DFHEIV0
 11028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11029
 11030
 11031     MOVE ER-9426                TO EMI-ERROR.
 11032     MOVE -1                     TO MAINTL.
 11033     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11034     GO TO 8200-SEND-DATAONLY.
 11035
 11036 5465-DUPLICATE-ARCH-TEXT.
 11037
 11038     IF  NOT PI-689-CREATE-NO-SCREENS
 11039
 11040* EXEC CICS SYNCPOINT ROLLBACK
 11041*        END-EXEC.
 11042*    MOVE '6"R                   !   #00010573' TO DFHEIV0
 11043     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11044     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11045     MOVE X'2020233030303130353733' TO DFHEIV0(25:11)
 11046     CALL 'kxdfhei1' USING DFHEIV0
 11047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11048
 11049
 11050     MOVE ER-7369                TO EMI-ERROR.
 11051     MOVE -1                     TO MAINTL.
 11052     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11053     GO TO 8200-SEND-DATAONLY.
 11054
 11055 5470-CNTL-NOT-FOUND.
 11056
 11057     MOVE ER-9299                TO EMI-ERROR.
 11058     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11059     MOVE -1                     TO MAINTL.
 11060     MOVE AL-UANON               TO MAINTA.
 11061     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 228
* EL689.cbl
 11063 5500-FORMAT-TEXT.
 11064
 11065     SET LT-NDX UP BY +1.
 11066
 11067     IF  W-RC-TEXT (W-RG-NDX) EQUAL W-TOP-FORM
 11068         SET W-RG-NDX UP BY 1
 11069         MOVE 99                 TO LT-SKIP-CONTROL (LT-NDX)
 11070         MOVE W-RC-TEXT (W-RG-NDX)
 11071                                 TO LT-TEXT-LINE (LT-NDX)
 11072     ELSE
 11073         IF  W-RC-TEXT (W-RG-NDX) EQUAL SPACES
 11074             MOVE ZEROS          TO W-PRINT-CONTROL
 11075             PERFORM 5505-FIND-USED-LINE THRU 5505-EXIT
 11076                     VARYING
 11077                 W-RG-NDX FROM W-RG-NDX BY 1
 11078                     UNTIL
 11079                 W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11080                     OR
 11081                 W-RC-TEXT (W-RG-NDX) GREATER THAN SPACES
 11082             IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11083                 GO TO 5500-WRITE-TEST
 11084             ELSE
 11085                 MOVE W-PRINT-CONTROL
 11086                                 TO LT-SKIP-CONTROL (LT-NDX)
 11087                 MOVE W-RC-TEXT (W-RG-NDX)
 11088                                 TO LT-TEXT-LINE (LT-NDX)
 11089         ELSE
 11090             MOVE W-RC-TEXT (W-RG-NDX)
 11091                                 TO LT-TEXT-LINE (LT-NDX)
 11092             MOVE ZEROS          TO W-PRINT-CONTROL.
 11093
 11094     ADD +1                      TO LT-NUM-LINES-ON-RECORD.
 11095
 11096 5500-WRITE-TEST.
 11097
 11098     IF  W-RG-NDX NOT LESS THAN PI-TOTAL-LINES
 11099         IF  LT-TEXT-RECORD NOT EQUAL SPACES
 11100             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 11101             MOVE '2'            TO LT-RECORD-TYPE
 11102             ADD +1              TO W-SEQ-CTR
 11103             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 11104             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11105         ELSE
 11106             NEXT SENTENCE
 11107     ELSE
 11108         IF  LT-NDX EQUAL +20
 11109             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 11110             MOVE '2'            TO LT-RECORD-TYPE
 11111             ADD +1              TO W-SEQ-CTR
 11112             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 11113             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 11114             SET LT-NDX          TO W-ZEROS
 11115             PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 11116
 11117 5500-EXIT.
 11118      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 229
* EL689.cbl
 11120 5505-FIND-USED-LINE.
 11121
 11122     ADD +1                      TO W-PRINT-CONTROL.
 11123
 11124 5505-EXIT.
 11125      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 230
* EL689.cbl
 11127 5600-FORMAT-ADDRESS-LINE.
 11128
 11129     SET LT-NDX                  TO W-RG-NDX.
 11130     MOVE W-RC-TEXT (W-RG-NDX)   TO LT-TEXT-LINE (LT-NDX).
 11131
 11132 5600-EXIT.
 11133     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 231
* EL689.cbl
 11135 5650-WRITE-ARCHIVE.
 11136
 11137
 11138* EXEC CICS WRITE
 11139*         DATASET   (W-ARCH-FILE-ID)
 11140*         FROM      (LETTER-ARCHIVE)
 11141*         RIDFLD    (LA-CONTROL-PRIMARY)
 11142*    END-EXEC.
 11143     MOVE LENGTH OF
 11144      LETTER-ARCHIVE
 11145       TO DFHEIV11
 11146*    MOVE '&$ L                  ''   #00010663' TO DFHEIV0
 11147     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11148     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11149     MOVE X'2020233030303130363633' TO DFHEIV0(25:11)
 11150     CALL 'kxdfhei1' USING DFHEIV0,
 11151           W-ARCH-FILE-ID,
 11152           LETTER-ARCHIVE,
 11153           DFHEIV11,
 11154           LA-CONTROL-PRIMARY,
 11155           DFHEIV99,
 11156           DFHEIV99
 11157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11158
 11159
 11160 5650-EXIT.
 11161     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 232
* EL689.cbl
 11163 5655-WRITE-ARCHIVE-TEXT.
 11164
 11165
 11166* EXEC CICS WRITE
 11167*         DATASET   (W-ARCT-FILE-ID)
 11168*         FROM      (LETTER-ARCHIVE-TEXT)
 11169*         RIDFLD    (LT-CONTROL-PRIMARY)
 11170*    END-EXEC.
 11171     MOVE LENGTH OF
 11172      LETTER-ARCHIVE-TEXT
 11173       TO DFHEIV11
 11174*    MOVE '&$ L                  ''   #00010674' TO DFHEIV0
 11175     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11176     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11177     MOVE X'2020233030303130363734' TO DFHEIV0(25:11)
 11178     CALL 'kxdfhei1' USING DFHEIV0,
 11179           W-ARCT-FILE-ID,
 11180           LETTER-ARCHIVE-TEXT,
 11181           DFHEIV11,
 11182           LT-CONTROL-PRIMARY,
 11183           DFHEIV99,
 11184           DFHEIV99
 11185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11186
 11187
 11188 5655-EXIT.
 11189     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 233
* EL689.cbl
 11191 6000-RESOLVE-VARIABLES.
 11192***************************************************************
 11193*    THIS ROUTINE WILL FORMAT THE SYSTEM DEFINED SYMBOLS      *
 11194*    WITH DATA PERTAINING TO THE FORM WITH VARIABLES.         *
 11195*    THIS ROUTINE IS PERFORM THRU 6000-EXIT IN ORDER TO       *
 11196*    RESOLVE ALL OF THE SYMBOLS.                              *
 11197*                                                             *
 11198***************************************************************
 11199
 11200     PERFORM 6200-GET-COMPANY-DATA THRU 6200-EXIT.
 11201     PERFORM 6250-GET-CNTL2-DATA THRU 6250-EXIT.
 11202     PERFORM 6400-GET-PENDING-DATA THRU 6400-EXIT.
 11203     PERFORM 6450-GET-CERT-DATA THRU 6450-EXIT.
 11204     PERFORM 6500-GET-ACCOUNT-DATA THRU 6500-EXIT
 11205*    PERFORM 6350-GET-CSR-DATA   THRU 6350-EXIT
 11206     PERFORM 6600-GET-COMPENSATION-DATA THRU 6600-EXIT.
 11207     PERFORM 6700-GET-MAIL-DATA THRU 6700-EXIT.
 11208     PERFORM 6300-GET-CARRIER-DATA THRU 6300-EXIT.
 11209     PERFORM 6750-GET-LIFE-BENEFIT-DATA THRU 6750-EXIT.
 11210     PERFORM 6800-GET-A-H-BENEFIT-DATA THRU 6800-EXIT.
 11211     PERFORM 6850-GET-CHECK-DATA THRU 6850-EXIT.
 11212     PERFORM 6900-GET-PYAJ-DATA THRU 6900-EXIT.
 11213     PERFORM 6950-MOVE-SYSTEM-DATA THRU 6950-EXIT.
 11214
 11215     MOVE SPACES                 TO W-REVERSE-DATE-SW.
 11216
 11217 6000-EXIT.
 11218     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 234
* EL689.cbl
 11220 6200-GET-COMPANY-DATA.
 11221
 11222     IF  ADDRSI EQUAL '3'
 11223             AND
 11224         PI-CREATE-LABELS
 11225             AND
 11226         NOT PI-689-LABELS-OVERRIDEN
 11227         NEXT SENTENCE
 11228     ELSE
 11229         IF  W-FILE-NOT-USED (1)
 11230             GO TO 6200-EXIT.
 11231
 11232     MOVE SPACES                 TO W-CNTL-KEY.
 11233     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11234     MOVE +0                     TO W-CNTL-SEQ-NO.
 11235     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11236
 11237
 11238* EXEC CICS HANDLE CONDITION
 11239*         NOTOPEN   (8040-CNTL-NOT-OPEN)
 11240*         NOTFND    (6200-CNTL1-NOT-FOUND)
 11241*    END-EXEC.
 11242*    MOVE '"$JI                  ! 0 #00010729' TO DFHEIV0
 11243     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11244     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11245     MOVE X'3020233030303130373239' TO DFHEIV0(25:11)
 11246     CALL 'kxdfhei1' USING DFHEIV0
 11247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11248
 11249
 11250
 11251* EXEC CICS READ
 11252*         DATASET   (W-CNTL-FILE-ID)
 11253*         SET       (ADDRESS OF CONTROL-FILE)
 11254*         RIDFLD    (W-CNTL-KEY)
 11255*    END-EXEC.
 11256*    MOVE '&"S        E          (   #00010734' TO DFHEIV0
 11257     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11258     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11259     MOVE X'2020233030303130373334' TO DFHEIV0(25:11)
 11260     CALL 'kxdfhei1' USING DFHEIV0,
 11261           W-CNTL-FILE-ID,
 11262           DFHEIV20,
 11263           DFHEIV99,
 11264           W-CNTL-KEY,
 11265           DFHEIV99,
 11266           DFHEIV99,
 11267           DFHEIV99
 11268     SET ADDRESS OF CONTROL-FILE TO
 11269         DFHEIV20
 11270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11271
 11272
 11273     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 11274     MOVE CF-CL-MAIL-TO-NAME     TO W-LABEL-LINES (1)
 11275                                    W-VG-TEXT (25).
 11276     MOVE CF-CL-IN-CARE-OF       TO W-LABEL-LINES (2).
 11277     MOVE CF-CL-ADDR-LINE-1      TO W-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 235
* EL689.cbl
 11278     MOVE CF-CL-ADDR-LINE-2      TO W-LABEL-LINES (4).
 11279     MOVE CF-CL-CITY-STATE       TO W-LABEL-LINES (5).
 11280
 11281     IF  CF-CL-CAN-POST-CODE
 11282         MOVE CF-CL-CANADIAN-POSTAL-CODE
 11283                                 TO W-CANADIAN-POSTAL-CODES
 11284         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 11285         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 11286         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 11287                                    W-LAB-CAN-FILLER (6)
 11288         GO TO 6200-CONTINUE.
 11289
 11290     IF CF-CL-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 11291         MOVE CF-CL-ZIP-CODE     TO W-WORK-ZIP
 11292         MOVE SPACES             TO W-LABEL-ZIP (6)
 11293         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 11294
 11295         IF  W-WORK-ZIP4 GREATER THAN '0000'
 11296             MOVE '-'            TO W-LABEL-DASH (6)
 11297             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 11298             GO TO 6200-CONTINUE
 11299         ELSE
 11300             MOVE SPACES         TO W-LABEL-DASH (6)
 11301                                    W-LABEL-2ND-ZIP (6)
 11302             GO TO 6200-CONTINUE.
 11303
 11304     IF  CF-CL-ZIP-CODE-NUM NOT NUMERIC
 11305         GO TO 6200-CONTINUE.
 11306
 11307     MOVE CF-CL-ZIP-CODE-NUM     TO W-WORK-ZIP-NUMERIC.
 11308
 11309     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 11310         COMPUTE W-WORK-ZIP-NUMERIC
 11311             = W-WORK-ZIP-NUMERIC * 10000.
 11312
 11313     MOVE SPACES                 TO W-LABEL-ZIP (6).
 11314     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 11315
 11316     IF  W-WORK-ZIP4 GREATER THAN '0000'
 11317         MOVE '-'                TO W-LABEL-DASH (6)
 11318         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 11319         GO TO 6200-CONTINUE
 11320     ELSE
 11321         MOVE SPACES             TO W-LABEL-DASH (6)
 11322                                    W-LABEL-2ND-ZIP (6)
 11323         GO TO 6200-CONTINUE.
 11324
 11325 6200-CONTINUE.
 11326
 11327     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 11328
 11329     IF  ADDRSI EQUAL '3'
 11330             AND
 11331         PI-CREATE-LABELS
 11332             AND
 11333         NOT PI-689-LABELS-OVERRIDEN
 11334         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (1)
 11335         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (2)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 236
* EL689.cbl
 11336         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (3)
 11337         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (04)
 11338         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (5)
 11339         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (6)
 11340         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 11341         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11342         SET W-RG-NDX UP BY +1
 11343     ELSE
 11344         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (1)
 11345         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (2)
 11346         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (3)
 11347         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (4)
 11348         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (5)
 11349         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (6).
 11350
 11351     GO TO 6200-EXIT.
 11352
 11353 6200-CNTL1-NOT-FOUND.
 11354
 11355     MOVE ER-9299                TO EMI-ERROR.
 11356     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11357     MOVE -1                     TO ADDRSL.
 11358     MOVE AL-UANON               TO ADDRSA.
 11359     GO TO 8200-SEND-DATAONLY.
 11360
 11361 6200-EXIT.
 11362     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 237
* EL689.cbl
 11364 6250-GET-CNTL2-DATA.
 11365
 11366     IF  PI-PROCESSOR-ID EQUAL W-LGXX-ID
 11367         GO TO 6250-EXIT.
 11368
 11369     IF  W-FILE-NOT-USED (11)
 11370         GO TO 6250-EXIT.
 11371
 11372     MOVE SPACES                 TO W-CNTL-KEY.
 11373     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11374     MOVE +0                     TO W-CNTL-SEQ-NO.
 11375     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 11376     MOVE PI-PROCESSOR-ID        TO W-CNTL-GENL.
 11377
 11378
 11379* EXEC CICS HANDLE CONDITION
 11380*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11381*         NOTFND     (6250-CNTL2-NOT-FOUND)
 11382*    END-EXEC.
 11383*    MOVE '"$JI                  ! 1 #00010845' TO DFHEIV0
 11384     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11386     MOVE X'3120233030303130383435' TO DFHEIV0(25:11)
 11387     CALL 'kxdfhei1' USING DFHEIV0
 11388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11389
 11390
 11391
 11392* EXEC CICS READ
 11393*         DATASET    (W-CNTL-FILE-ID)
 11394*         SET        (ADDRESS OF CONTROL-FILE)
 11395*         RIDFLD     (W-CNTL-KEY)
 11396*    END-EXEC.
 11397*    MOVE '&"S        E          (   #00010850' TO DFHEIV0
 11398     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11399     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11400     MOVE X'2020233030303130383530' TO DFHEIV0(25:11)
 11401     CALL 'kxdfhei1' USING DFHEIV0,
 11402           W-CNTL-FILE-ID,
 11403           DFHEIV20,
 11404           DFHEIV99,
 11405           W-CNTL-KEY,
 11406           DFHEIV99,
 11407           DFHEIV99,
 11408           DFHEIV99
 11409     SET ADDRESS OF CONTROL-FILE TO
 11410         DFHEIV20
 11411     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11412
 11413
 11414     MOVE CF-PROCESSOR           TO W-VG-TEXT (153).
 11415     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (151).
 11416     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (152).
 11417     GO TO 6250-EXIT.
 11418
 11419 6250-CNTL2-NOT-FOUND.
 11420
 11421     MOVE ER-9299                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 238
* EL689.cbl
 11422     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11423     MOVE -1                     TO MAINTL.
 11424     MOVE AL-UANON               TO MAINTA.
 11425     GO TO 8200-SEND-DATAONLY.
 11426
 11427 6250-EXIT.
 11428     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 239
* EL689.cbl
 11430 6300-GET-CARRIER-DATA.
 11431
 11432     IF  ADDRSI EQUAL '2'
 11433             AND
 11434         PI-CREATE-LABELS
 11435             AND
 11436         NOT PI-689-LABELS-OVERRIDEN
 11437         NEXT SENTENCE
 11438     ELSE
 11439         IF  W-FILE-NOT-USED (4)
 11440             GO TO 6300-EXIT.
 11441
 11442     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
 11443         MOVE SPACES             TO W-CNTL-KEY
 11444         MOVE PI-COMPANY-ID      TO W-CNTL-COMPANY-ID
 11445         MOVE +0                 TO W-CNTL-SEQ-NO
 11446         MOVE '6'                TO W-CNTL-RECORD-TYPE
 11447         MOVE PI-689-CARRIER     TO W-CNTL-GEN4
 11448     ELSE
 11449         MOVE ER-9327            TO EMI-ERROR
 11450         MOVE -1                 TO CARRIERL
 11451         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11452         GO TO 6300-EXIT.
 11453
 11454
 11455* EXEC CICS HANDLE CONDITION
 11456*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11457*         NOTFND     (6300-CNTL6-NOT-FOUND)
 11458*    END-EXEC.
 11459*    MOVE '"$JI                  ! 2 #00010896' TO DFHEIV0
 11460     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11462     MOVE X'3220233030303130383936' TO DFHEIV0(25:11)
 11463     CALL 'kxdfhei1' USING DFHEIV0
 11464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11465
 11466
 11467
 11468* EXEC CICS READ
 11469*         DATASET    (W-CNTL-FILE-ID)
 11470*         SET        (ADDRESS OF CONTROL-FILE)
 11471*         RIDFLD     (W-CNTL-KEY)
 11472*    END-EXEC.
 11473*    MOVE '&"S        E          (   #00010901' TO DFHEIV0
 11474     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11475     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11476     MOVE X'2020233030303130393031' TO DFHEIV0(25:11)
 11477     CALL 'kxdfhei1' USING DFHEIV0,
 11478           W-CNTL-FILE-ID,
 11479           DFHEIV20,
 11480           DFHEIV99,
 11481           W-CNTL-KEY,
 11482           DFHEIV99,
 11483           DFHEIV99,
 11484           DFHEIV99
 11485     SET ADDRESS OF CONTROL-FILE TO
 11486         DFHEIV20
 11487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 240
* EL689.cbl
 11488
 11489
 11490     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 11491     MOVE CF-MAIL-TO-NAME        TO W-LABEL-LINES (1).
 11492     MOVE CF-IN-CARE-OF          TO W-LABEL-LINES (2).
 11493     MOVE CF-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 11494     MOVE CF-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 11495     MOVE CF-CITY-STATE          TO W-LABEL-LINES (5).
 11496
 11497     IF  CF-CANADIAN-POST-CODE
 11498         MOVE CF-CANADIAN-POSTAL-CODE
 11499                                 TO W-CANADIAN-POSTAL-CODES
 11500         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 11501         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 11502         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 11503                                    W-LAB-CAN-FILLER (6)
 11504         GO TO 6300-CONTINUE.
 11505
 11506     IF CF-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 11507         MOVE CF-ZIP-CODE        TO W-WORK-ZIP
 11508         MOVE SPACES             TO W-LABEL-ZIP (6)
 11509         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 11510         IF  W-WORK-ZIP4 GREATER THAN '0000'
 11511             MOVE '-'            TO W-LABEL-DASH (6)
 11512             MOVE W-WORK-ZIP4
 11513                                 TO W-LABEL-2ND-ZIP (6)
 11514             GO TO 6300-CONTINUE
 11515         ELSE
 11516             MOVE SPACES         TO W-LABEL-DASH (6)
 11517                                    W-LABEL-2ND-ZIP (6)
 11518             GO TO 6300-CONTINUE.
 11519
 11520     IF  CF-ZIP-CODE-NUM NOT NUMERIC
 11521         GO TO 6300-CONTINUE.
 11522
 11523     MOVE CF-ZIP-CODE-NUM TO W-WORK-ZIP-NUMERIC.
 11524
 11525     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 11526         COMPUTE W-WORK-ZIP-NUMERIC
 11527             = W-WORK-ZIP-NUMERIC * 10000.
 11528
 11529     MOVE SPACES                 TO W-LABEL-ZIP (6).
 11530     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 11531
 11532     IF  W-WORK-ZIP4 GREATER THAN '0000'
 11533         MOVE '-'                TO W-LABEL-DASH (6)
 11534         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 11535         GO TO 6300-CONTINUE
 11536     ELSE
 11537         MOVE SPACES             TO W-LABEL-DASH (6)
 11538                                    W-LABEL-2ND-ZIP (6)
 11539         GO TO 6300-CONTINUE.
 11540
 11541 6300-CONTINUE.
 11542
 11543     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 11544
 11545     IF  ADDRSI EQUAL '2'
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 241
* EL689.cbl
 11546             AND
 11547         PI-CREATE-LABELS
 11548             AND
 11549         NOT PI-689-LABELS-OVERRIDEN
 11550         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (20)
 11551         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (21)
 11552         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (22)
 11553         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (23)
 11554         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (24)
 11555         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (25)
 11556         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 11557         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11558         SET W-RG-NDX UP BY +1
 11559     ELSE
 11560         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (20)
 11561         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (21)
 11562         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (22)
 11563         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (23)
 11564         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (24)
 11565         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (25).
 11566
 11567     IF  W-FULL-DATA
 11568         MOVE ZEROS              TO W-PHONE-IN
 11569         MOVE CF-PHONE-NO        TO W-PHONE-IN
 11570         MOVE W-PHI-AREA         TO W-PO-AREA
 11571         MOVE W-PHI-PFX          TO W-PO-PFX
 11572         MOVE W-PHI-SFX          TO W-PO-SFX
 11573         MOVE W-PHONE-OUT        TO W-VG-TEXT (26).
 11574
 11575     GO TO 6300-EXIT.
 11576
 11577 6300-CNTL6-NOT-FOUND.
 11578
 11579     MOVE ER-9298                TO EMI-ERROR.
 11580     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11581     MOVE -1                     TO ADDRSL.
 11582     MOVE AL-UANON               TO ADDRSA.
 11583     GO TO 8200-SEND-DATAONLY.
 11584
 11585 6300-EXIT.
 11586     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 242
* EL689.cbl
 11588 6350-GET-CSR-DATA.
 11589     IF W-VG-TEXT (148) (1:4) = '****' OR SPACES
 11590        GO TO 6350-EXIT
 11591     END-IF
 11592*    IF W-FILE-NOT-USED (11)
 11593*       GO TO 6350-EXIT
 11594*    END-IF
 11595     MOVE SPACES                 TO W-CNTL-KEY
 11596     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
 11597     MOVE +0                     TO W-CNTL-SEQ-NO
 11598     MOVE '2'                    TO W-CNTL-RECORD-TYPE
 11599     MOVE CO-CSR-CODE            TO W-CNTL-GENL
 11600
 11601* EXEC CICS HANDLE CONDITION
 11602*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11603*         NOTFND     (6350-CNTL2-NOT-FOUND)
 11604*    END-EXEC
 11605*    MOVE '"$JI                  ! 3 #00011017' TO DFHEIV0
 11606     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11607     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11608     MOVE X'3320233030303131303137' TO DFHEIV0(25:11)
 11609     CALL 'kxdfhei1' USING DFHEIV0
 11610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11611
 11612* EXEC CICS READ
 11613*         DATASET    (W-CNTL-FILE-ID)
 11614*         SET        (ADDRESS OF CONTROL-FILE)
 11615*         RIDFLD     (W-CNTL-KEY)
 11616*    END-EXEC
 11617*    MOVE '&"S        E          (   #00011021' TO DFHEIV0
 11618     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11619     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11620     MOVE X'2020233030303131303231' TO DFHEIV0(25:11)
 11621     CALL 'kxdfhei1' USING DFHEIV0,
 11622           W-CNTL-FILE-ID,
 11623           DFHEIV20,
 11624           DFHEIV99,
 11625           W-CNTL-KEY,
 11626           DFHEIV99,
 11627           DFHEIV99,
 11628           DFHEIV99
 11629     SET ADDRESS OF CONTROL-FILE TO
 11630         DFHEIV20
 11631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11632     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 11633     GO TO 6350-EXIT
 11634     .
 11635 6350-CNTL2-NOT-FOUND.
 11636     MOVE ER-9299                TO EMI-ERROR.
 11637     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11638     MOVE -1                     TO MAINTL.
 11639     MOVE AL-UANON               TO MAINTA.
 11640     GO TO 8200-SEND-DATAONLY.
 11641 6350-EXIT.
 11642     EXIT.
 11643 6400-GET-PENDING-DATA.
 11644
 11645     IF (ADDRSI EQUAL '7')
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 243
* EL689.cbl
 11646        AND (PI-CREATE-LABELS)
 11647        AND (NOT PI-689-LABELS-OVERRIDEN)
 11648        CONTINUE
 11649     ELSE
 11650        IF PI-689-DATA-SOURCE = '4'
 11651           CONTINUE
 11652        ELSE
 11653           IF W-FILE-NOT-USED (9)
 11654              GO TO 6400-EXIT
 11655           END-IF
 11656        END-IF
 11657     END-IF
 11658     IF  W-PNDB-ENTRY EQUAL LOW-VALUES
 11659         MOVE ER-9327            TO EMI-ERROR
 11660         MOVE -1                 TO MAINTL
 11661         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11662         GO TO 6400-EXIT.
 11663
 11664 6400-READ-PNDB-ONLY.
 11665
 11666
 11667* EXEC CICS HANDLE CONDITION
 11668*         NOTOPEN (8060-PNDB-NOT-OPEN)
 11669*         NOTFND  (8070-PNDB-NOT-FOUND)
 11670*    END-EXEC.
 11671*    MOVE '"$JI                  ! 4 #00011060' TO DFHEIV0
 11672     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11673     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11674     MOVE X'3420233030303131303630' TO DFHEIV0(25:11)
 11675     CALL 'kxdfhei1' USING DFHEIV0
 11676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11677
 11678
 11679
 11680* EXEC CICS READ
 11681*         DATASET (W-PNDB-FILE-ID)
 11682*         SET     (ADDRESS OF PENDING-BUSINESS)
 11683*         RIDFLD  (W-PNDB-KEY)
 11684*    END-EXEC.
 11685*    MOVE '&"S        E          (   #00011065' TO DFHEIV0
 11686     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11687     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11688     MOVE X'2020233030303131303635' TO DFHEIV0(25:11)
 11689     CALL 'kxdfhei1' USING DFHEIV0,
 11690           W-PNDB-FILE-ID,
 11691           DFHEIV20,
 11692           DFHEIV99,
 11693           W-PNDB-KEY,
 11694           DFHEIV99,
 11695           DFHEIV99,
 11696           DFHEIV99
 11697     SET ADDRESS OF PENDING-BUSINESS TO
 11698         DFHEIV20
 11699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11700
 11701
 11702     MOVE 'Y'                    TO W-PNDB-FOUND-SW.
 11703
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 244
* EL689.cbl
 11704     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 11705         MOVE PB-SV-CARRIER      TO PB-CARRIER
 11706                                    PI-689-CARRIER
 11707         MOVE PB-SV-GROUPING     TO PB-GROUPING
 11708                                    PI-689-GROUPING
 11709         MOVE PB-SV-STATE        TO PB-STATE
 11710                                    PI-689-STATE
 11711         MOVE PB-CONTROL-BY-ACCOUNT
 11712                                 TO W-CERT-KEY
 11713                                    W-MAIL-KEY
 11714                                    W-ACCT-KEY
 11715         MOVE PB-ACCOUNT         TO PI-689-ACCOUNT
 11716         MOVE PB-CERT-EFF-DT     TO PI-689-EFF-DATE
 11717         MOVE PB-CERT-NO         TO PI-689-CERT-NO.
 11718
 11719 6400-ONLY-STOP.
 11720
 11721     MOVE PB-ENTRY-BATCH         TO W-VG-TEXT (130).
 11722
 11723     IF  NOT PB-ISSUE
 11724         GO TO 6400-CANCEL.
 11725
 11726     MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1.
 11727     MOVE SPACES                 TO DC-OPTION-CODE.
 11728     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 11729
 11730     IF  NO-CONVERSION-ERROR
 11731         MOVE DC-GREG-DATE-1-EDIT
 11732                                 TO W-VG-TEXT (110).
 11733
 11734     MOVE PB-I-AGE               TO W-EDIT-3-0.
 11735     MOVE W-EDIT-3-0             TO W-VG-TEXT (124).
 11736     MOVE PB-I-LF-PREMIUM-AMT    TO W-EDIT-7-2.
 11737     MOVE W-EDIT-7-2             TO W-VG-TEXT (111).
 11738     MOVE PB-I-AH-PREMIUM-AMT    TO W-EDIT-7-2.
 11739     MOVE W-EDIT-7-2             TO W-VG-TEXT (112).
 11740     MOVE PB-I-LF-PREM-CALC      TO W-EDIT-7-2.
 11741     MOVE W-EDIT-7-2             TO W-VG-TEXT (113).
 11742     MOVE PB-I-AH-PREM-CALC      TO W-EDIT-7-2.
 11743     MOVE W-EDIT-7-2             TO W-VG-TEXT (114).
 11744     MOVE PB-I-LF-BENEFIT-AMT    TO W-EDIT-9-2.
 11745     MOVE W-EDIT-9-2             TO W-VG-TEXT (125).
 11746     MOVE PB-I-AH-BENEFIT-AMT    TO W-EDIT-7-2.
 11747     MOVE W-EDIT-7-2             TO W-VG-TEXT (126).
 11748     MOVE PB-I-LF-RATE           TO W-EDIT-2-5-S.
 11749     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (127).
 11750     MOVE PB-I-AH-RATE           TO W-EDIT-2-5-S.
 11751     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (128).
 11752     MOVE PB-I-LOAN-TERM         TO W-EDIT-3-0.
 11753     MOVE W-EDIT-3-0             TO W-VG-TEXT (129).
 11754
 11755     COMPUTE W-DIFFERENCE
 11756         = PB-I-LF-PREM-CALC - PB-I-LF-PREMIUM-AMT.
 11757
 11758     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 11759     MOVE W-EDIT-7-2             TO W-VG-TEXT (115).
 11760
 11761     COMPUTE W-DIFFERENCE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 245
* EL689.cbl
 11762         = PB-I-AH-PREM-CALC - PB-I-AH-PREMIUM-AMT.
 11763
 11764     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 11765     MOVE W-EDIT-7-2             TO W-VG-TEXT (116).
 11766
 11767 6400-CANCEL.
 11768
 11769     IF  NOT PB-CANCELLATION
 11770         GO TO 6400-EXIT.
 11771
 11772     MOVE PB-CI-AH-PRIOR-CANCEL-DT
 11773                                 TO DC-BIN-DATE-1.
 11774     MOVE SPACES                 TO DC-OPTION-CODE.
 11775     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 11776
 11777     IF  NO-CONVERSION-ERROR
 11778         MOVE DC-GREG-DATE-1-EDIT
 11779                                 TO W-VG-TEXT (117).
 11780
 11781     MOVE PB-C-LF-CANCEL-AMT     TO W-EDIT-7-2.
 11782     MOVE W-EDIT-7-2             TO W-VG-TEXT (118).
 11783     MOVE PB-C-AH-CANCEL-AMT     TO W-EDIT-7-2.
 11784     MOVE W-EDIT-7-2             TO W-VG-TEXT (119).
 11785     MOVE PB-C-LF-REF-CALC       TO W-EDIT-7-2.
 11786     MOVE W-EDIT-7-2             TO W-VG-TEXT (120).
 11787     MOVE PB-C-AH-REF-CALC       TO W-EDIT-7-2.
 11788     MOVE W-EDIT-7-2             TO W-VG-TEXT (121).
 11789     COMPUTE W-EDIT-7-2 = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
 11790     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 11791
 11792     IF PB-C-NH-INT-ON-REFS NOT NUMERIC
 11793        MOVE ZEROS               TO PB-C-NH-INT-ON-REFS
 11794     END-IF
 11795     MOVE PB-C-NH-INT-ON-REFS    TO W-EDIT-7-2
 11796     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 11797     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 11798     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-1
 11799        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 11800     END-IF
 11801     MOVE SPACES                 TO DC-OPTION-CODE
 11802     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 11803
 11804     IF NO-CONVERSION-ERROR
 11805        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 11806     END-IF
 11807
 11808     COMPUTE W-DIFFERENCE = PB-C-LF-REF-CALC
 11809                           - PB-C-LF-CANCEL-AMT.
 11810
 11811     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 11812     MOVE W-EDIT-7-2             TO W-VG-TEXT (122).
 11813
 11814     COMPUTE W-DIFFERENCE = PB-C-AH-REF-CALC
 11815                           - PB-C-AH-CANCEL-AMT.
 11816
 11817     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 11818     MOVE W-EDIT-7-2             TO W-VG-TEXT (123).
 11819
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 246
* EL689.cbl
 11820 6400-EXIT.
 11821     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 247
* EL689.cbl
 11823 6450-GET-CERT-DATA.
 11824     IF  W-FILE-NOT-USED (8)
 11825         GO TO 6450-EXIT.
 11826
 11827     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 11828         MOVE ER-9327            TO EMI-ERROR
 11829         MOVE -1                 TO MAINTL
 11830         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11831         GO TO 6450-EXIT.
 11832
 11833 6450-READ-CERT-ONLY.
 11834
 11835
 11836* EXEC CICS HANDLE CONDITION
 11837*         NOTOPEN (8030-CERT-NOT-OPEN)
 11838*         NOTFND  (8035-CERT-NOT-FOUND)
 11839*    END-EXEC.
 11840*    MOVE '"$JI                  ! 5 #00011204' TO DFHEIV0
 11841     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 11842     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11843     MOVE X'3520233030303131323034' TO DFHEIV0(25:11)
 11844     CALL 'kxdfhei1' USING DFHEIV0
 11845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11846
 11847
 11848
 11849* EXEC CICS READ
 11850*         DATASET (W-CERT-FILE-ID)
 11851*         SET     (ADDRESS OF CERTIFICATE-MASTER)
 11852*         RIDFLD  (W-CERT-KEY)
 11853*    END-EXEC.
 11854*    MOVE '&"S        E          (   #00011209' TO DFHEIV0
 11855     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11856     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11857     MOVE X'2020233030303131323039' TO DFHEIV0(25:11)
 11858     CALL 'kxdfhei1' USING DFHEIV0,
 11859           W-CERT-FILE-ID,
 11860           DFHEIV20,
 11861           DFHEIV99,
 11862           W-CERT-KEY,
 11863           DFHEIV99,
 11864           DFHEIV99,
 11865           DFHEIV99
 11866     SET ADDRESS OF CERTIFICATE-MASTER TO
 11867         DFHEIV20
 11868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11869
 11870
 11871     MOVE 'Y'                    TO W-CERT-FOUND-SW.
 11872
 11873 6450-ONLY-STOP.
 11874
 11875     MOVE CM-INSURED-LAST-NAME   TO W-VG-TEXT (108).
 11876
 11877     MOVE CM-BENEFICIARY         TO W-VG-TEXT (109).
 11878
 11879     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 11880     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 248
* EL689.cbl
 11881     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 11882     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11883     MOVE WS-NAME-WORK           TO W-VG-TEXT (95).
 11884
 11885     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 11886     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 11887     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 11888     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 11889     MOVE WS-NAME-WORK           TO W-VG-TEXT (94).
 11890
 11891     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 11892     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 11893     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 11894     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 11895     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11896     MOVE WS-NAME-WORK           TO W-VG-TEXT (90).
 11897
 11898     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 11899     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 11900     MOVE SPACES                 TO W-NAME-MIDDLE.
 11901     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11902     MOVE WS-NAME-WORK           TO W-VG-TEXT (104).
 11903
 11904     MOVE CM-INSURED-FIRST-NAME  TO W-VG-TEXT (91).
 11905     MOVE CM-INSURED-INITIAL2    TO W-VG-TEXT (92).
 11906
 11907     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 11908     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 11909     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 11910     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11911     MOVE WS-NAME-WORK           TO W-VG-TEXT (103)
 11912                                    W-LABEL-JOINT-NAME.
 11913
 11914     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 11915     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 11916     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 11917     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 11918     MOVE WS-NAME-WORK           TO W-VG-TEXT (102).
 11919
 11920     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 11921     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 11922     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 11923     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 11924     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11925     MOVE WS-NAME-WORK           TO W-VG-TEXT (99).
 11926
 11927     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 11928     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 11929     MOVE SPACES                 TO W-NAME-MIDDLE.
 11930     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 11931     MOVE WS-NAME-WORK           TO W-VG-TEXT (105).
 11932
 11933     MOVE CM-JT-FIRST-NAME       TO W-VG-TEXT (100).
 11934     MOVE CM-JT-INITIAL          TO W-VG-TEXT (101).
 11935
 11936     COMPUTE W-WORK-AMOUNT
 11937         = CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT.
 11938     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 249
* EL689.cbl
 11939     MOVE W-EDIT-9-2             TO W-VG-TEXT (97).
 11940     MOVE CM-AH-PREMIUM-AMT      TO W-EDIT-7-2.
 11941     MOVE W-EDIT-7-2             TO W-VG-TEXT (98).
 11942
 11943     IF  CM-SEX-FEMAL
 11944         MOVE 'MS.'              TO W-VG-TEXT (96)
 11945
 11946     ELSE
 11947         MOVE 'MR.'              TO W-VG-TEXT (96).
 11948
 11949     MOVE CM-CARRIER OF CERTIFICATE-MASTER
 11950                                 TO W-VG-TEXT (70).
 11951     MOVE CM-GROUPING            TO W-VG-TEXT (71).
 11952     MOVE CM-ACCOUNT             TO W-VG-TEXT (72).
 11953     MOVE CM-CERT-NO             TO W-VG-TEXT (73).
 11954     MOVE CM-INSURED-ISSUE-AGE   TO W-DISPLAY-3.
 11955     MOVE W-DISPLAY-3            TO W-VG-TEXT (83).
 11956     MOVE CM-LOAN-NUMBER         TO W-VG-TEXT (86).
 11957     MOVE CM-LOAN-BALANCE        TO W-EDIT-7-2.
 11958     MOVE W-EDIT-7-2             TO W-VG-TEXT (87).
 11959     MOVE CM-MEMBER-NO           TO W-VG-TEXT (88).
 11960     MOVE CM-SOC-SEC-NO          TO W-VG-TEXT (89).
 11961     MOVE CM-POLICY-FORM-NO      TO W-VG-TEXT (83).
 11962     MOVE CM-LF-ORIG-TERM        TO W-EDIT-3-0.
 11963     MOVE W-EDIT-3-0             TO W-VG-TEXT (77).
 11964     MOVE CM-LF-BENEFIT-AMT      TO W-EDIT-9-2.
 11965     MOVE W-EDIT-9-2             TO W-VG-TEXT (79).
 11966     MOVE CM-AH-ORIG-TERM        TO W-EDIT-3-0.
 11967     MOVE W-EDIT-3-0             TO W-VG-TEXT (78).
 11968     MOVE CM-AH-BENEFIT-AMT      TO W-EDIT-7-2.
 11969     MOVE W-EDIT-7-2             TO W-VG-TEXT (80).
 11970     MOVE CM-AH-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 11971     MOVE W-EDIT-7-2             TO W-VG-TEXT (107).
 11972     MOVE CM-LF-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 11973     MOVE W-EDIT-7-2             TO W-VG-TEXT (106).
 11974     IF PI-689-DATA-SOURCE NOT = '4'
 11975     COMPUTE W-EDIT-7-2 = CM-LF-ITD-CANCEL-AMT
 11976        + CM-AH-ITD-CANCEL-AMT
 11977     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 11978     IF CM-NH-INT-ON-REFS NOT NUMERIC
 11979        MOVE ZEROS               TO CM-NH-INT-ON-REFS
 11980     END-IF
 11981     MOVE CM-NH-INT-ON-REFS      TO W-EDIT-7-2
 11982     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 11983     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
 11984     IF CM-AH-CANCEL-DT > DC-BIN-DATE-1
 11985        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
 11986     END-IF
 11987     MOVE SPACES                 TO DC-OPTION-CODE
 11988     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 11989
 11990     IF NO-CONVERSION-ERROR
 11991        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 11992     END-IF
 11993     END-IF
 11994     COMPUTE W-WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 11995     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
 11996     MOVE W-EDIT-9-2             TO W-VG-TEXT (93).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 250
* EL689.cbl
 11997
 11998     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1.
 11999     MOVE SPACES                 TO DC-OPTION-CODE.
 12000     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12001
 12002     IF  NO-CONVERSION-ERROR
 12003         MOVE DC-GREG-DATE-1-EDIT
 12004                                 TO W-VG-TEXT (81).
 12005
 12006     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1.
 12007     MOVE SPACES                 TO DC-OPTION-CODE.
 12008     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12009
 12010     IF  NO-CONVERSION-ERROR
 12011         MOVE DC-GREG-DATE-1-EDIT
 12012                                 TO W-VG-TEXT (82).
 12013
 12014     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12015     MOVE SPACES                 TO DC-OPTION-CODE.
 12016     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12017
 12018     IF  NO-CONVERSION-ERROR
 12019         MOVE DC-GREG-DATE-1-EDIT
 12020                                 TO W-VG-TEXT (74).
 12021
 12022     MOVE CM-LF-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 12023
 12024     IF  CM-PMT-EXTENSION-DAYS NUMERIC
 12025         MOVE CM-PMT-EXTENSION-DAYS
 12026                                 TO DC-ELAPSED-DAYS
 12027     ELSE
 12028         MOVE ZEROS              TO DC-ELAPSED-DAYS.
 12029
 12030     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12031     MOVE '6'                    TO DC-OPTION-CODE.
 12032     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12033
 12034     IF  NO-CONVERSION-ERROR
 12035         MOVE DC-GREG-DATE-1-EDIT
 12036                                 TO W-VG-TEXT (75).
 12037
 12038     MOVE CM-AH-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 12039     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 12040     MOVE '6'                    TO DC-OPTION-CODE.
 12041     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12042
 12043     IF  NO-CONVERSION-ERROR
 12044         MOVE DC-GREG-DATE-1-EDIT
 12045                                 TO W-VG-TEXT (76).
 12046
 12047 6450-EXIT.
 12048     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 251
* EL689.cbl
 12050 6500-GET-ACCOUNT-DATA.
 12051
 12052     IF  ADDRSI EQUAL '1'
 12053             AND
 12054         PI-CREATE-LABELS
 12055             AND
 12056         NOT PI-689-LABELS-OVERRIDEN
 12057         NEXT SENTENCE
 12058     ELSE
 12059         IF  W-FILE-NOT-USED (6)
 12060             GO TO 6500-EXIT
 12061         END-IF
 12062     END-IF.
 12063
 12064 6500-READ-ACCT-ONLY.
 12065
 12066     IF  W-ACCT-ACCOUNT EQUAL LOW-VALUES
 12067         MOVE ER-9327            TO EMI-ERROR
 12068         MOVE -1                 TO MAINTL
 12069         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12070         GO TO 6500-EXIT.
 12071
 12072
 12073* EXEC CICS HANDLE CONDITION
 12074*         NOTOPEN    (8020-ACCT-NOT-OPEN)
 12075*         NOTFND     (6500-ACCT-NOT-FOUND)
 12076*         ENDFILE    (6500-ONLY-STOP)
 12077*    END-EXEC.
 12078*    MOVE '"$JI''                 ! 6 #00011416' TO DFHEIV0
 12079     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 12080     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12081     MOVE X'3620233030303131343136' TO DFHEIV0(25:11)
 12082     CALL 'kxdfhei1' USING DFHEIV0
 12083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12084
 12085
 12086
 12087* EXEC CICS STARTBR
 12088*         RIDFLD     (W-ACCT-KEY)
 12089*         DATASET    (W-ACCT-FILE-ID)
 12090*         KEYLENGTH  (20)
 12091*         GENERIC
 12092*    END-EXEC.
 12093     MOVE 20
 12094       TO DFHEIV11
 12095     MOVE 0
 12096       TO DFHEIV12
 12097*    MOVE '&,   KG    G          &   #00011422' TO DFHEIV0
 12098     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 12099     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12100     MOVE X'2020233030303131343232' TO DFHEIV0(25:11)
 12101     CALL 'kxdfhei1' USING DFHEIV0,
 12102           W-ACCT-FILE-ID,
 12103           W-ACCT-KEY,
 12104           DFHEIV11,
 12105           DFHEIV12,
 12106           DFHEIV99
 12107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 252
* EL689.cbl
 12108
 12109
 12110     MOVE W-ACCT-PARTIAL-KEY     TO W-ACCT-SAVE-KEY.
 12111     MOVE 'Y'                    TO W-ACCT-BROWSE-STARTED-SW.
 12112
 12113 6500-READNEXT.
 12114
 12115
 12116* EXEC CICS READNEXT
 12117*         DATASET    (W-ACCT-FILE-ID)
 12118*         SET        (ADDRESS OF ACCOUNT-MASTER)
 12119*         RIDFLD     (W-ACCT-KEY)
 12120*    END-EXEC.
 12121     MOVE 0
 12122       TO DFHEIV11
 12123*    MOVE '&.S                   )   #00011434' TO DFHEIV0
 12124     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12125     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12126     MOVE X'2020233030303131343334' TO DFHEIV0(25:11)
 12127     CALL 'kxdfhei1' USING DFHEIV0,
 12128           W-ACCT-FILE-ID,
 12129           DFHEIV20,
 12130           DFHEIV99,
 12131           W-ACCT-KEY,
 12132           DFHEIV99,
 12133           DFHEIV11,
 12134           DFHEIV99,
 12135           DFHEIV99
 12136     SET ADDRESS OF ACCOUNT-MASTER TO
 12137         DFHEIV20
 12138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12139
 12140
 12141     IF  W-ACCT-PARTIAL-KEY NOT EQUAL W-ACCT-SAVE-KEY
 12142         IF  PRIOR-MATCH-ACCT-PKEY
 12143             CONTINUE
 12144*            GO TO 6500-ONLY-STOP
 12145         ELSE
 12146             IF  W-FILE-NOT-USED (6)
 12147                 PERFORM 6500-ENDBR
 12148                 GO TO 6500-EXIT
 12149             ELSE
 12150                 GO TO 6500-ACCT-NOT-FOUND
 12151             END-IF
 12152         END-IF
 12153     ELSE
 12154         SET PRIOR-MATCH-ACCT-PKEY TO TRUE
 12155         MOVE AM-CARRIER           TO WS-SAV-AM-CARRIER
 12156         MOVE AM-ACCOUNT           TO WS-SAV-AM-ACCOUNT
 12157         MOVE AM-DEFN-1            TO WS-SAV-AM-DEFN-1
 12158         MOVE AM-REMIT-TO          TO WS-SAV-AM-REMIT-TO
 12159         MOVE AM-NAME              TO WS-SAV-AM-NAME
 12160         MOVE AM-PERSON            TO WS-SAV-AM-PERSON
 12161         MOVE AM-ADDRS             TO WS-SAV-AM-ADDRS
 12162         MOVE SPACES               TO WS-SAV-AM-CITY
 12163*        MOVE AM-CITY              TO WS-SAV-AM-CITY
 12164         STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 12165            DELIMITED BY '  ' INTO WS-SAV-AM-CITY
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 253
* EL689.cbl
 12166         END-STRING
 12167         MOVE AM-ZIP               TO WS-SAV-AM-ZIP
 12168         MOVE AM-TEL-NO            TO WS-SAV-AM-TEL-NO
 12169         MOVE AM-CONTROL-NAME      TO WS-SAV-AM-CONTROL-NAME
 12170         MOVE AM-CSR-CODE          TO WS-SAV-AM-CSR-CODE
 12171         MOVE AM-ACCOUNT           TO WS-SAV-AM-ERACCT-ACCOUNT
 12172         GO TO 6500-READNEXT
 12173     END-IF
 12174     .
 12175 6500-ONLY-STOP.
 12176
 12177     IF  NOT PI-NO-CARRIER-SECURITY
 12178             AND
 12179         PI-CARRIER-SECURITY NOT = WS-SAV-AM-CARRIER
 12180         MOVE -1                 TO CARRIERL
 12181         MOVE AL-UANON           TO CARRIERA
 12182         MOVE ER-9095            TO EMI-ERROR
 12183         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12184         PERFORM 6500-ENDBR
 12185         GO TO 8200-SEND-DATAONLY.
 12186
 12187     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12188     MOVE WS-SAV-AM-NAME         TO W-LABEL-LINES (1).
 12189     MOVE WS-SAV-AM-PERSON       TO W-LABEL-LINES (2).
 12190     MOVE WS-SAV-AM-ADDRS        TO W-LABEL-LINES (3).
 12191     MOVE WS-SAV-AM-CITY         TO W-LABEL-LINES (4).
 12192
 12193     MOVE WS-SAV-AM-ZIP          TO W-WORK-ZIP.
 12194     MOVE SPACES                 TO W-LABEL-ZIP (5).
 12195
 12196     IF  SAVE-AM-CANADIAN-POST-CODE
 12197         MOVE WS-SAV-AM-CANADIAN-POSTAL-CODE
 12198                                 TO W-CANADIAN-POSTAL-CODES
 12199         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 12200         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 12201         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 12202                                    W-LAB-CAN-FILLER (5)
 12203     ELSE
 12204         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 12205
 12206         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12207             MOVE '-'            TO W-LABEL-DASH (5)
 12208             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 12209         ELSE
 12210             MOVE SPACES         TO W-LABEL-DASH (5)
 12211                                    W-LABEL-2ND-ZIP (5).
 12212
 12213     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12214
 12215     IF  ADDRSI EQUAL '1'
 12216             AND
 12217         PI-CREATE-LABELS
 12218             AND
 12219         NOT PI-689-LABELS-OVERRIDEN
 12220         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 12221                                    W-VG-TEXT (40)
 12222         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 12223                                    W-VG-TEXT (41)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 254
* EL689.cbl
 12224         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 12225                                    W-VG-TEXT (42)
 12226         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 12227                                    W-VG-TEXT (43)
 12228         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 12229                                    W-VG-TEXT (44)
 12230         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 12231                                    W-VG-TEXT (45)
 12232         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12233         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12234         SET W-RG-NDX UP BY +1
 12235     ELSE
 12236         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (40)
 12237         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (41)
 12238         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (42)
 12239         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (43)
 12240         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (44)
 12241         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (45).
 12242
 12243     IF  WS-SAV-AM-TEL-NO NOT NUMERIC
 12244             OR
 12245         WS-SAV-AM-TEL-NO EQUAL ZEROS
 12246         MOVE SPACES             TO W-VG-TEXT (46)
 12247     ELSE
 12248         MOVE ZEROS                  TO W-PHONE-IN
 12249         MOVE WS-SAV-AM-AREA-CODE    TO W-PO-AREA
 12250         MOVE WS-SAV-AM-TEL-PRE      TO W-PO-PFX
 12251         MOVE WS-SAV-AM-TEL-NBR      TO W-PO-SFX
 12252         MOVE W-PHONE-OUT            TO W-VG-TEXT (46).
 12253
 12254     IF WS-SAV-AM-CONTROL-NAME (1:1) NOT = LOW-VALUES
 12255        MOVE WS-SAV-AM-CONTROL-NAME  TO W-VG-TEXT (47)
 12256     ELSE
 12257        MOVE SPACES                   TO W-VG-TEXT (47)
 12258     END-IF.
 12259     MOVE WS-SAV-AM-CSR-CODE     TO W-VG-TEXT (48)
 12260     MOVE WS-SAV-AM-ERACCT-ACCOUNT
 12261                                 TO W-VG-TEXT (49)
 12262
 12263     MOVE WS-SAV-AM-ACCOUNT      TO W-VG-TEXT (72)
 12264     PERFORM 6500-ENDBR.
 12265
 12266     GO TO 6500-EXIT.
 12267
 12268 6500-ENDBR.
 12269
 12270     IF  W-ACCT-BROWSE-STARTED
 12271         MOVE 'N'                TO W-ACCT-BROWSE-STARTED-SW
 12272
 12273* EXEC CICS ENDBR
 12274*            DATASET (W-ACCT-FILE-ID)
 12275*        END-EXEC
 12276     MOVE 0
 12277       TO DFHEIV11
 12278*    MOVE '&2                    $   #00011571' TO DFHEIV0
 12279     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12280     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12281     MOVE X'2020233030303131353731' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 255
* EL689.cbl
 12282     CALL 'kxdfhei1' USING DFHEIV0,
 12283           W-ACCT-FILE-ID,
 12284           DFHEIV11,
 12285           DFHEIV99
 12286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12287     END-IF.
 12288
 12289 6500-ACCT-NOT-FOUND.
 12290
 12291     PERFORM 6500-ENDBR.
 12292
 12293     IF  DATASORI NOT EQUAL '1'
 12294         MOVE ER-0179            TO EMI-ERROR
 12295         GO TO 6500-EXIT.
 12296
 12297     MOVE ER-0179                TO EMI-ERROR.
 12298     MOVE -1                     TO MAINTL.
 12299     MOVE AL-UNBON               TO MAINTA.
 12300     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12301     GO TO 8200-SEND-DATAONLY.
 12302
 12303 6500-EXIT.
 12304     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 256
* EL689.cbl
 12306 6600-GET-COMPENSATION-DATA.
 12307
 12308     IF  ADDRSI EQUAL '4'
 12309             AND
 12310         PI-CREATE-LABELS
 12311             AND
 12312         NOT PI-689-LABELS-OVERRIDEN
 12313         NEXT SENTENCE
 12314     ELSE
 12315         IF  W-FILE-NOT-USED (10)
 12316             GO TO 6600-EXIT.
 12317
 12318     IF  W-COMP-RESP-PERSON GREATER THAN LOW-VALUES
 12319         MOVE W-COMP-KEY         TO W-COMP-SAVE-KEY
 12320         GO TO 6600-START.
 12321
 12322     IF  PI-ZERO-CARRIER
 12323             OR
 12324         PI-ZERO-CAR-GROUP
 12325         MOVE ZEROS              TO W-COMP-CARRIER.
 12326
 12327     IF  PI-ZERO-GROUPING
 12328             OR
 12329         PI-ZERO-CAR-GROUP
 12330         MOVE ZEROS              TO W-COMP-GROUPING.
 12331
 12332     IF  W-FILE-NOT-USED (6)
 12333         PERFORM 6500-READ-ACCT-ONLY THRU 6500-READNEXT
 12334         IF  EMI-ERROR EQUAL ER-0179
 12335             MOVE ER-9327        TO EMI-ERROR
 12336             MOVE -1             TO MAINTL
 12337             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12338             GO TO 6600-EXIT.
 12339
 12340     MOVE  'A'                   TO W-COMP-TYPE.
 12341
 12342     IF  WS-SAV-AM-REMIT-TO GREATER THAN ZEROS
 12343         MOVE WS-SAV-AM-AGT (WS-SAV-AM-REMIT-TO)
 12344                                 TO W-COMP-RESP-PERSON
 12345     ELSE
 12346         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 12347
 12348     PERFORM VARYING W-NDX FROM +1 BY +1 UNTIL
 12349        (W-NDX > +10)
 12350            OR
 12351         (WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F')
 12352     END-PERFORM
 12353
 12354     IF  WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'S' OR 'F'
 12355         MOVE WS-SAV-AM-AGT (W-NDX)  TO W-COMP-ACCOUNT
 12356     ELSE
 12357         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 12358
 12359     PERFORM 6500-ENDBR.
 12360     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 12361
 12362     IF  W-COMP-RESP-PERSON EQUAL LOW-VALUES
 12363         MOVE ER-9327            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 257
* EL689.cbl
 12364         MOVE -1                 TO MAINTL
 12365         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12366         GO TO 6600-EXIT.
 12367
 12368 6600-START.
 12369
 12370
 12371* EXEC CICS HANDLE CONDITION
 12372*         NOTOPEN (8080-COMP-NOT-OPEN)
 12373*         NOTFND  (6600-COMP-NOT-FOUND)
 12374*    END-EXEC.
 12375*    MOVE '"$JI                  ! 7 #00011657' TO DFHEIV0
 12376     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12377     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12378     MOVE X'3720233030303131363537' TO DFHEIV0(25:11)
 12379     CALL 'kxdfhei1' USING DFHEIV0
 12380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12381
 12382
 12383
 12384* EXEC CICS STARTBR
 12385*         RIDFLD  (W-COMP-KEY)
 12386*         DATASET (W-COMP-FILE-ID)
 12387*    END-EXEC.
 12388     MOVE 0
 12389       TO DFHEIV11
 12390*    MOVE '&,         G          &   #00011662' TO DFHEIV0
 12391     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12392     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12393     MOVE X'2020233030303131363632' TO DFHEIV0(25:11)
 12394     CALL 'kxdfhei1' USING DFHEIV0,
 12395           W-COMP-FILE-ID,
 12396           W-COMP-KEY,
 12397           DFHEIV99,
 12398           DFHEIV11,
 12399           DFHEIV99
 12400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12401
 12402
 12403     MOVE 'Y'                    TO W-COMP-BROWSE-SW.
 12404
 12405 6600-READNEXT.
 12406
 12407
 12408* EXEC CICS READNEXT
 12409*         DATASET (W-COMP-FILE-ID)
 12410*         SET     (ADDRESS OF COMPENSATION-MASTER)
 12411*         RIDFLD  (W-COMP-KEY)
 12412*    END-EXEC.
 12413     MOVE 0
 12414       TO DFHEIV11
 12415*    MOVE '&.S                   )   #00011671' TO DFHEIV0
 12416     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12417     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12418     MOVE X'2020233030303131363731' TO DFHEIV0(25:11)
 12419     CALL 'kxdfhei1' USING DFHEIV0,
 12420           W-COMP-FILE-ID,
 12421           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 258
* EL689.cbl
 12422           DFHEIV99,
 12423           W-COMP-KEY,
 12424           DFHEIV99,
 12425           DFHEIV11,
 12426           DFHEIV99,
 12427           DFHEIV99
 12428     SET ADDRESS OF COMPENSATION-MASTER TO
 12429         DFHEIV20
 12430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12431
 12432
 12433     IF CO-CONTROL-PRIMARY
 12434           NOT = W-COMP-SAVE-KEY
 12435        GO TO 6600-COMP-NOT-FOUND.
 12436
 12437     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12438     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1)
 12439                                    W-VG-TEXT (140).
 12440     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 12441     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 12442     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 12443*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 12444     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 12445        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12446     END-STRING
 12447
 12448     MOVE CO-ZIP                 TO W-WORK-ZIP.
 12449
 12450     IF  CO-CANADIAN-POST-CODE
 12451         MOVE CO-CANADIAN-POSTAL-CODE
 12452                                 TO W-CANADIAN-POSTAL-CODES
 12453         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12454         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12455         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12456                                    W-LAB-CAN-FILLER (6)
 12457     ELSE
 12458         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12459
 12460         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12461             MOVE '-'            TO W-LABEL-DASH (6)
 12462             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12463         ELSE
 12464             MOVE SPACES         TO W-LABEL-DASH (6)
 12465                                    W-LABEL-2ND-ZIP (6).
 12466
 12467     IF  CO-TELEPHONE NOT NUMERIC
 12468             OR
 12469         CO-TELEPHONE = ZEROS
 12470         MOVE SPACES             TO W-VG-TEXT (147)
 12471     ELSE
 12472         MOVE ZEROS              TO W-PHONE-IN
 12473         MOVE CO-AREA-CODE       TO W-PO-AREA
 12474         MOVE CO-PREFIX          TO W-PO-PFX
 12475         MOVE CO-PHONE           TO W-PO-SFX
 12476         MOVE W-PHONE-OUT        TO W-VG-TEXT (147).
 12477
 12478     IF (CO-FAXNO NOT NUMERIC)
 12479        OR (CO-FAXNO = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 259
* EL689.cbl
 12480        MOVE SPACES              TO W-VG-TEXT (182)
 12481     ELSE
 12482        MOVE ZEROS               TO W-PHONE-IN
 12483        MOVE CO-FAX-AREA-CODE    TO W-PO-AREA
 12484        MOVE CO-FAX-PREFIX       TO W-PO-PFX
 12485        MOVE CO-FAX-PHONE        TO W-PO-SFX
 12486        MOVE W-PHONE-OUT         TO W-VG-TEXT (182)
 12487     END-IF
 12488     IF CO-GA-STATUS-CODE NOT = 'A' AND 'I' AND 'P'
 12489        MOVE SPACES              TO W-VG-TEXT (183)
 12490     ELSE
 12491        EVALUATE CO-GA-STATUS-CODE
 12492           WHEN 'A'
 12493              MOVE 'ACTIVE'      TO W-VG-TEXT (183)
 12494           WHEN 'I'
 12495              MOVE 'INACTIVE'    TO W-VG-TEXT (183)
 12496           WHEN 'P'
 12497              MOVE 'PENDING'     TO W-VG-TEXT (183)
 12498        END-EVALUATE
 12499     END-IF
 12500     IF CO-BILL-SW NOT = 'B' AND 'R' AND 'T' AND 'S'
 12501        MOVE SPACES              TO W-VG-TEXT (181)
 12502     ELSE
 12503        EVALUATE CO-BILL-SW
 12504           WHEN 'B'
 12505              MOVE 'BILLED'      TO W-VG-TEXT (181)
 12506           WHEN 'R'
 12507              MOVE 'REMIT'       TO W-VG-TEXT (181)
 12508           WHEN 'T'
 12509              MOVE 'T'           TO W-VG-TEXT (181)
 12510           WHEN 'S'
 12511              MOVE 'S'           TO W-VG-TEXT (181)
 12512        END-EVALUATE
 12513     END-IF
 12514     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12515
 12516     IF  ADDRSI EQUAL '4'
 12517             AND
 12518         PI-CREATE-LABELS
 12519             AND
 12520         NOT PI-689-LABELS-OVERRIDEN
 12521         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 12522                                    W-VG-TEXT (141)
 12523         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 12524                                    W-VG-TEXT (142)
 12525         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 12526                                    W-VG-TEXT (143)
 12527         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 12528                                    W-VG-TEXT (144)
 12529         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 12530                                    W-VG-TEXT (145)
 12531         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 12532                                    W-VG-TEXT (146)
 12533         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12534         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 12535         SET W-RG-NDX UP BY +1
 12536     ELSE
 12537         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (141)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 260
* EL689.cbl
 12538         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (142)
 12539         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (143)
 12540         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (144)
 12541         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (145)
 12542         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (146).
 12543
 12544     PERFORM 6630-GET-CSR-NAME THRU 6630-EXIT.
 12545
 12546     MOVE CO-RESP-NO             TO W-VG-TEXT (180).
 12547     MOVE CO-END-BAL             TO W-EDIT-7-2-NEGATIVE.
 12548     MOVE W-EDIT-7-2-NEGATIVE    TO W-VG-TEXT (150).
 12549
 12550     MOVE CO-LAST-STMT-DT        TO DC-GREG-DATE-1-YMD.
 12551     MOVE '3'                    TO DC-OPTION-CODE.
 12552     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 12553
 12554     IF  NO-CONVERSION-ERROR
 12555         MOVE DC-GREG-DATE-1-ALPHA
 12556                                 TO W-VG-TEXT (149).
 12557
 12558     PERFORM 6620-GET-G-DATA THRU 6620-EXIT.
 12559     PERFORM 6626-GET-B-DATA     THRU 6626-EXIT
 12560
 12561     PERFORM 6600-ENDBR.
 12562     GO TO 6600-EXIT.
 12563
 12564 6600-ENDBR.
 12565
 12566     IF  W-COMP-BROWSE-STARTED
 12567         MOVE 'N'                      TO W-COMP-BROWSE-SW
 12568
 12569* EXEC CICS ENDBR
 12570*             DATASET(W-COMP-FILE-ID)
 12571*        END-EXEC.
 12572     MOVE 0
 12573       TO DFHEIV11
 12574*    MOVE '&2                    $   #00011812' TO DFHEIV0
 12575     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 12576     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12577     MOVE X'2020233030303131383132' TO DFHEIV0(25:11)
 12578     CALL 'kxdfhei1' USING DFHEIV0,
 12579           W-COMP-FILE-ID,
 12580           DFHEIV11,
 12581           DFHEIV99
 12582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12583
 12584
 12585 6600-COMP-NOT-FOUND.
 12586
 12587     PERFORM 6600-ENDBR.
 12588
 12589     IF ADDRSL GREATER ZERO
 12590         IF ADDRSI = '4'
 12591            IF PI-689-TYPE EQUAL LOW-VALUES OR SPACES
 12592                MOVE ER-7378                TO EMI-ERROR
 12593                MOVE -1                     TO TYPEL
 12594                MOVE AL-UNBON               TO TYPEA
 12595                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 261
* EL689.cbl
 12596                GO TO 8200-SEND-DATAONLY
 12597            ELSE
 12598                MOVE ER-2114                TO EMI-ERROR
 12599                MOVE -1                     TO ADDRSL
 12600                MOVE AL-UNBON               TO ADDRSA
 12601                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12602                GO TO 8200-SEND-DATAONLY.
 12603
 12604 6600-EXIT.
 12605     EXIT.
 12606 6620-GET-G-DATA.
 12607
 12608     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY.
 12609
 12610     IF  CO-RPTCD2 GREATER THAN SPACES
 12611         MOVE SPACES             TO W-COMP-RESP-PERSON
 12612         MOVE CO-RPTCD2          TO W-COMP-WORK-AREA
 12613         MOVE +10                TO W-CWA-NDX
 12614         PERFORM 6622-FIND-LAST-NON-SPACE
 12615         SET W-COMP-NDX          TO +10
 12616         PERFORM 6625-FILL-IN-RESP-PERSON.
 12617         INSPECT W-COMP-RESP-PERSON CONVERTING SPACES TO ZEROS.
 12618
 12619     MOVE LOW-VALUES             TO W-COMP-ACCOUNT.
 12620     MOVE 'G'                    TO W-COMP-TYPE.
 12621     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 12622
 12623
 12624* EXEC CICS RESETBR
 12625*         RIDFLD  (W-COMP-KEY)
 12626*         DATASET (W-COMP-FILE-ID)
 12627*    END-EXEC.
 12628     MOVE 0
 12629       TO DFHEIV11
 12630*    MOVE '&4         G          &   #00011854' TO DFHEIV0
 12631     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 12632     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12633     MOVE X'2020233030303131383534' TO DFHEIV0(25:11)
 12634     CALL 'kxdfhei1' USING DFHEIV0,
 12635           W-COMP-FILE-ID,
 12636           W-COMP-KEY,
 12637           DFHEIV99,
 12638           DFHEIV11,
 12639           DFHEIV99
 12640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12641
 12642
 12643
 12644* EXEC CICS READNEXT
 12645*         DATASET (W-COMP-FILE-ID)
 12646*         SET     (ADDRESS OF COMPENSATION-MASTER)
 12647*         RIDFLD  (W-COMP-KEY)
 12648*    END-EXEC.
 12649     MOVE 0
 12650       TO DFHEIV11
 12651*    MOVE '&.S                   )   #00011859' TO DFHEIV0
 12652     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12653     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 262
* EL689.cbl
 12654     MOVE X'2020233030303131383539' TO DFHEIV0(25:11)
 12655     CALL 'kxdfhei1' USING DFHEIV0,
 12656           W-COMP-FILE-ID,
 12657           DFHEIV20,
 12658           DFHEIV99,
 12659           W-COMP-KEY,
 12660           DFHEIV99,
 12661           DFHEIV11,
 12662           DFHEIV99,
 12663           DFHEIV99
 12664     SET ADDRESS OF COMPENSATION-MASTER TO
 12665         DFHEIV20
 12666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12667
 12668
 12669     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 12670         GO TO 6620-EXIT.
 12671
 12672     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12673     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 12674     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 12675     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 12676     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 12677*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 12678     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 12679        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12680     END-STRING
 12681
 12682     MOVE CO-ZIP                 TO W-WORK-ZIP.
 12683
 12684     IF  CO-CANADIAN-POST-CODE
 12685         MOVE CO-CANADIAN-POSTAL-CODE
 12686                                 TO W-CANADIAN-POSTAL-CODES
 12687         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12688         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12689         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12690                                    W-LAB-CAN-FILLER (6)
 12691     ELSE
 12692         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12693         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12694             MOVE '-'            TO W-LABEL-DASH (6)
 12695             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12696         ELSE
 12697             MOVE SPACES         TO W-LABEL-DASH (6)
 12698                                    W-LABEL-2ND-ZIP (6).
 12699
 12700     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12701
 12702     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (174).
 12703     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (175).
 12704     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (176).
 12705     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (177).
 12706     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (178).
 12707     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (179).
 12708
 12709 6620-EXIT.
 12710     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 263
* EL689.cbl
 12712 6622-FIND-LAST-NON-SPACE.
 12713
 12714     IF  W-CWA-CHAR (W-CWA-NDX) EQUAL SPACES
 12715         SUBTRACT +1 FROM W-CWA-NDX
 12716         GO TO 6622-FIND-LAST-NON-SPACE.
 12717
 12718 6622-EXIT.
 12719     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 264
* EL689.cbl
 12721 6625-FILL-IN-RESP-PERSON.
 12722
 12723     MOVE W-CWA-CHAR (W-CWA-NDX) TO W-COMP-RP-CHAR (W-COMP-NDX)
 12724     SET W-COMP-NDX DOWN BY +1.
 12725     SUBTRACT +1 FROM W-CWA-NDX.
 12726
 12727     IF  W-CWA-NDX GREATER THAN ZEROS
 12728         GO TO 6625-FILL-IN-RESP-PERSON.
 12729
 12730 6625-EXIT.
 12731     EXIT.
 12732 6626-GET-B-DATA.
 12733     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY
 12734     IF W-FILE-USED (8)
 12735        PERFORM 6450-READ-CERT-ONLY
 12736        IF W-CERT-FOUND
 12737           MOVE CM-BENEFICIARY (1:10)
 12738                                 TO W-COMP-RESP-PERSON
 12739        ELSE
 12740           MOVE SPACES           TO W-COMP-RESP-PERSON
 12741           GO TO 6626-EXIT
 12742        END-IF
 12743     ELSE
 12744        MOVE CM-BENEFICIARY (1:10)
 12745                                 TO W-COMP-RESP-PERSON
 12746     END-IF
 12747     MOVE LOW-VALUES             TO W-COMP-ACCOUNT
 12748     MOVE 'B'                    TO W-COMP-TYPE
 12749     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY
 12750
 12751
 12752* EXEC CICS RESETBR
 12753*         RIDFLD  (W-COMP-KEY)
 12754*         DATASET (W-COMP-FILE-ID)
 12755*    END-EXEC.
 12756     MOVE 0
 12757       TO DFHEIV11
 12758*    MOVE '&4         G          &   #00011947' TO DFHEIV0
 12759     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 12760     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12761     MOVE X'2020233030303131393437' TO DFHEIV0(25:11)
 12762     CALL 'kxdfhei1' USING DFHEIV0,
 12763           W-COMP-FILE-ID,
 12764           W-COMP-KEY,
 12765           DFHEIV99,
 12766           DFHEIV11,
 12767           DFHEIV99
 12768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12769
 12770
 12771
 12772* EXEC CICS READNEXT
 12773*         DATASET (W-COMP-FILE-ID)
 12774*         SET     (ADDRESS OF COMPENSATION-MASTER)
 12775*         RIDFLD  (W-COMP-KEY)
 12776*    END-EXEC.
 12777     MOVE 0
 12778       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 265
* EL689.cbl
 12779*    MOVE '&.S                   )   #00011952' TO DFHEIV0
 12780     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 12781     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12782     MOVE X'2020233030303131393532' TO DFHEIV0(25:11)
 12783     CALL 'kxdfhei1' USING DFHEIV0,
 12784           W-COMP-FILE-ID,
 12785           DFHEIV20,
 12786           DFHEIV99,
 12787           W-COMP-KEY,
 12788           DFHEIV99,
 12789           DFHEIV11,
 12790           DFHEIV99,
 12791           DFHEIV99
 12792     SET ADDRESS OF COMPENSATION-MASTER TO
 12793         DFHEIV20
 12794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12795
 12796
 12797     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 12798         GO TO 6626-EXIT.
 12799
 12800     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12801     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 12802     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 12803     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 12804     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 12805*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 12806     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 12807        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12808     END-STRING
 12809
 12810     MOVE CO-ZIP                 TO W-WORK-ZIP.
 12811
 12812     IF  CO-CANADIAN-POST-CODE
 12813         MOVE CO-CANADIAN-POSTAL-CODE
 12814                                 TO W-CANADIAN-POSTAL-CODES
 12815         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12816         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12817         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12818                                    W-LAB-CAN-FILLER (6)
 12819     ELSE
 12820         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12821         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12822             MOVE '-'            TO W-LABEL-DASH (6)
 12823             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12824         ELSE
 12825             MOVE SPACES         TO W-LABEL-DASH (6)
 12826                                    W-LABEL-2ND-ZIP (6).
 12827
 12828     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12829
 12830     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (184).
 12831     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (185).
 12832     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (186).
 12833     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (187).
 12834     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (188).
 12835     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (189).
 12836
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 266
* EL689.cbl
 12837 6626-EXIT.
 12838     EXIT.
 12839 6630-GET-CSR-NAME.
 12840
 12841     MOVE SPACES                 TO W-CNTL-KEY.
 12842     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12843     MOVE +0                     TO W-CNTL-SEQ-NO.
 12844     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 12845     MOVE CO-CSR-CODE            TO W-CNTL-GENL.
 12846
 12847
 12848* EXEC CICS HANDLE CONDITION
 12849*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 12850*         NOTFND     (6630-CNTL2-NOT-FOUND)
 12851*    END-EXEC.
 12852*    MOVE '"$JI                  ! 8 #00012008' TO DFHEIV0
 12853     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12854     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12855     MOVE X'3820233030303132303038' TO DFHEIV0(25:11)
 12856     CALL 'kxdfhei1' USING DFHEIV0
 12857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12858
 12859
 12860
 12861* EXEC CICS READ
 12862*         DATASET    (W-CNTL-FILE-ID)
 12863*         SET        (ADDRESS OF CONTROL-FILE)
 12864*         RIDFLD     (W-CNTL-KEY)
 12865*    END-EXEC.
 12866*    MOVE '&"S        E          (   #00012013' TO DFHEIV0
 12867     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12868     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12869     MOVE X'2020233030303132303133' TO DFHEIV0(25:11)
 12870     CALL 'kxdfhei1' USING DFHEIV0,
 12871           W-CNTL-FILE-ID,
 12872           DFHEIV20,
 12873           DFHEIV99,
 12874           W-CNTL-KEY,
 12875           DFHEIV99,
 12876           DFHEIV99,
 12877           DFHEIV99
 12878     SET ADDRESS OF CONTROL-FILE TO
 12879         DFHEIV20
 12880     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12881
 12882
 12883     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (148).
 12884     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 12885     GO TO 6630-EXIT.
 12886
 12887 6630-CNTL2-NOT-FOUND.
 12888
 12889*    MOVE ER-8965                TO EMI-ERROR.
 12890*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12891*    MOVE -1                     TO MAINTL.
 12892*    MOVE AL-UANON               TO MAINTA.
 12893*    GO TO 8200-SEND-DATAONLY
 12894     .
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 267
* EL689.cbl
 12895 6630-EXIT.
 12896     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 268
* EL689.cbl
 12898 6700-GET-MAIL-DATA.
 12899
 12900     IF  ADDRSI EQUAL '5'
 12901             AND
 12902         PI-CREATE-LABELS
 12903             AND
 12904         NOT PI-689-LABELS-OVERRIDEN
 12905         NEXT SENTENCE
 12906     ELSE
 12907         IF  W-FILE-NOT-USED (5)
 12908             GO TO 6700-EXIT.
 12909
 12910     IF  W-MAIL-CERT-NO EQUAL LOW-VALUES
 12911         MOVE ER-9327            TO EMI-ERROR
 12912         MOVE -1                 TO MAINTL
 12913         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12914         GO TO 6700-EXIT.
 12915
 12916
 12917* EXEC CICS HANDLE CONDITION
 12918*         NOTOPEN (8090-MAIL-NOT-OPEN)
 12919*         NOTFND  (6700-MAIL-NOT-FOUND)
 12920*    END-EXEC.
 12921*    MOVE '"$JI                  ! 9 #00012052' TO DFHEIV0
 12922     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12923     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12924     MOVE X'3920233030303132303532' TO DFHEIV0(25:11)
 12925     CALL 'kxdfhei1' USING DFHEIV0
 12926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12927
 12928
 12929
 12930* EXEC CICS READ
 12931*         DATASET(W-MAIL-FILE-ID)
 12932*         SET    (ADDRESS OF MAILING-DATA)
 12933*         RIDFLD (W-MAIL-KEY)
 12934*    END-EXEC.
 12935*    MOVE '&"S        E          (   #00012057' TO DFHEIV0
 12936     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12937     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12938     MOVE X'2020233030303132303537' TO DFHEIV0(25:11)
 12939     CALL 'kxdfhei1' USING DFHEIV0,
 12940           W-MAIL-FILE-ID,
 12941           DFHEIV20,
 12942           DFHEIV99,
 12943           W-MAIL-KEY,
 12944           DFHEIV99,
 12945           DFHEIV99,
 12946           DFHEIV99
 12947     SET ADDRESS OF MAILING-DATA TO
 12948         DFHEIV20
 12949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12950
 12951
 12952     MOVE MA-INSURED-LAST-NAME   TO W-NAME-LAST.
 12953     MOVE MA-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 12954     MOVE MA-INSURED-MIDDLE-INIT TO W-NAME-MIDDLE.
 12955     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 269
* EL689.cbl
 12956
 12957     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12958     MOVE WS-NAME-WORK           TO W-LABEL-LINES (1).
 12959     MOVE W-LABEL-JOINT-NAME     TO W-LABEL-LINES (2).
 12960     MOVE MA-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 12961     MOVE MA-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 12962*    MOVE MA-CITY-STATE          TO W-LABEL-LINES (5).
 12963     STRING MA-CITY ' ' MA-ADDR-STATE
 12964        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 12965     END-STRING
 12966
 12967     MOVE MA-ZIP                 TO W-WORK-ZIP.
 12968     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12969
 12970     IF  MA-CANADIAN-POST-CODE
 12971         MOVE MA-CANADIAN-POSTAL-CODE
 12972                                 TO W-CANADIAN-POSTAL-CODES
 12973         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12974         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12975         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12976                                    W-LAB-CAN-FILLER (6)
 12977     ELSE
 12978         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12979         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12980             MOVE '-'            TO W-LABEL-DASH (6)
 12981             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12982         ELSE
 12983             MOVE SPACES         TO W-LABEL-DASH (6)
 12984                                    W-LABEL-2ND-ZIP (6).
 12985
 12986     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12987
 12988     IF  ADDRSI EQUAL '5'
 12989             AND
 12990         PI-CREATE-LABELS
 12991             AND
 12992         NOT PI-689-LABELS-OVERRIDEN
 12993         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 12994                                    W-VG-TEXT (31)
 12995         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 12996                                    W-VG-TEXT (32)
 12997         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 12998                                    W-VG-TEXT (33)
 12999         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13000                                    W-VG-TEXT (34)
 13001         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13002                                    W-VG-TEXT (35)
 13003         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13004                                    W-VG-TEXT (36)
 13005         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13006         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13007         SET W-RG-NDX UP BY +1
 13008     ELSE
 13009         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (31)
 13010         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (32)
 13011         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (33)
 13012         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (34)
 13013         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (35)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 270
* EL689.cbl
 13014         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (36).
 13015     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13016     MOVE MA-CRED-BENE-NAME      TO W-LABEL-LINES (1)
 13017     MOVE MA-CRED-BENE-ADDR      TO W-LABEL-LINES (2)
 13018     MOVE MA-CRED-BENE-ADDR2     TO W-LABEL-LINES (3)
 13019     STRING MA-CRED-BENE-CITY ' ' MA-CRED-BENE-STATE
 13020        DELIMITED BY '  ' INTO W-LABEL-LINES (4)
 13021     END-STRING
 13022
 13023     MOVE MA-CRED-BENE-ZIP       TO W-WORK-ZIP
 13024     MOVE SPACES                 TO W-LABEL-ZIP (5)
 13025
 13026     IF  MA-CB-CANADIAN-POST-CODE
 13027         MOVE MA-CB-CANADIAN-POSTAL-CODE
 13028                                 TO W-CANADIAN-POSTAL-CODES
 13029         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 13030         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 13031         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 13032                                    W-LAB-CAN-FILLER (5)
 13033     ELSE
 13034         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 13035         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13036             MOVE '-'            TO W-LABEL-DASH (5)
 13037             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 13038         ELSE
 13039             MOVE SPACES         TO W-LABEL-DASH (5)
 13040                                    W-LABEL-2ND-ZIP (5)
 13041         END-IF
 13042     END-IF
 13043     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT
 13044     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (37)
 13045     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (50)
 13046     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (51)
 13047     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (52)
 13048     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (53)
 13049     GO TO 6700-EXIT.
 13050
 13051 6700-MAIL-NOT-FOUND.
 13052
 13053     IF  ADDRSL GREATER ZERO
 13054         IF ADDRSI = '5'
 13055            MOVE ER-3000         TO EMI-ERROR
 13056            MOVE -1              TO ADDRSL
 13057            MOVE AL-UNBON        TO ADDRSA
 13058            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13059            GO TO 8200-SEND-DATAONLY.
 13060
 13061 6700-EXIT.
 13062     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 271
* EL689.cbl
 13064 6750-GET-LIFE-BENEFIT-DATA.
 13065
 13066     IF  W-FILE-NOT-USED (2)
 13067         GO TO 6750-EXIT.
 13068
 13069     MOVE SPACES                 TO W-CNTL-GEN2.
 13070
 13071     IF  DATASORI EQUAL '2'
 13072         IF  W-FILE-NOT-USED (8)
 13073             PERFORM 6450-READ-CERT-ONLY
 13074             IF  W-CERT-FOUND
 13075                 MOVE CM-LF-BENEFIT-CD
 13076                                 TO W-BEN-HOLD
 13077                                    W-CNTL-GEN2
 13078             ELSE
 13079                 NEXT SENTENCE
 13080         ELSE
 13081             MOVE CM-LF-BENEFIT-CD
 13082                                 TO W-BEN-HOLD
 13083                                    W-CNTL-GEN2
 13084     ELSE
 13085         IF  DATASORI EQUAL '4'
 13086             IF  W-FILE-NOT-USED (9)
 13087                 PERFORM 6400-READ-PNDB-ONLY
 13088                 IF  W-PNDB-FOUND
 13089                     IF  PI-689-TYPE = '1'
 13090                         MOVE PB-I-LF-BENEFIT-CD
 13091                                 TO W-BEN-HOLD
 13092                                    W-CNTL-GEN2
 13093                     ELSE
 13094                         MOVE PB-CI-LF-BENEFIT-CD
 13095                                 TO W-BEN-HOLD
 13096                                    W-CNTL-GEN2
 13097             ELSE
 13098                 NEXT SENTENCE
 13099         ELSE
 13100             IF  W-FILE-USED (8)
 13101                 MOVE CM-LF-BENEFIT-CD
 13102                                 TO W-BEN-HOLD
 13103                                    W-CNTL-GEN2
 13104             ELSE
 13105                 IF  W-FILE-USED (9)
 13106                     IF  PI-689-TYPE = '1'
 13107                         MOVE PB-I-LF-BENEFIT-CD
 13108                                 TO W-BEN-HOLD
 13109                                    W-CNTL-GEN2
 13110                     ELSE
 13111                         MOVE PB-CI-LF-BENEFIT-CD
 13112                                 TO W-BEN-HOLD
 13113                                    W-CNTL-GEN2.
 13114
 13115     IF  W-CNTL-GEN2 EQUAL SPACES
 13116         MOVE ER-9327            TO EMI-ERROR
 13117         MOVE -1                 TO MAINTL
 13118         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13119         GO TO 6750-EXIT.
 13120
 13121     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 272
* EL689.cbl
 13122     MOVE '4'                    TO W-CNTL-RECORD-TYPE.
 13123     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 13124
 13125
 13126* EXEC CICS HANDLE CONDITION
 13127*         NOTOPEN (8040-CNTL-NOT-OPEN)
 13128*         NOTFND  (6750-EXIT)
 13129*    END-EXEC.
 13130*    MOVE '"$JI                  ! : #00012236' TO DFHEIV0
 13131     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13132     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13133     MOVE X'3A20233030303132323336' TO DFHEIV0(25:11)
 13134     CALL 'kxdfhei1' USING DFHEIV0
 13135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13136
 13137
 13138
 13139* EXEC CICS READ
 13140*         DATASET (W-CNTL-FILE-ID)
 13141*         SET     (ADDRESS OF CONTROL-FILE)
 13142*         GTEQ
 13143*         RIDFLD  (W-CNTL-KEY)
 13144*    END-EXEC.
 13145*    MOVE '&"S        G          (   #00012241' TO DFHEIV0
 13146     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13147     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13148     MOVE X'2020233030303132323431' TO DFHEIV0(25:11)
 13149     CALL 'kxdfhei1' USING DFHEIV0,
 13150           W-CNTL-FILE-ID,
 13151           DFHEIV20,
 13152           DFHEIV99,
 13153           W-CNTL-KEY,
 13154           DFHEIV99,
 13155           DFHEIV99,
 13156           DFHEIV99
 13157     SET ADDRESS OF CONTROL-FILE TO
 13158         DFHEIV20
 13159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13160
 13161
 13162     MOVE 1                      TO W-NDX.
 13163
 13164 6750-LOOP.
 13165
 13166     IF  W-NDX = 9
 13167         GO TO 6750-EXIT.
 13168
 13169     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 13170         ADD 1                   TO W-NDX
 13171         GO TO 6750-LOOP.
 13172
 13173     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 13174         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 13175                                 TO W-VG-TEXT (11).
 13176
 13177 6750-EXIT.
 13178     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 273
* EL689.cbl
 13180 6800-GET-A-H-BENEFIT-DATA.
 13181
 13182     IF  W-FILE-NOT-USED (3)
 13183         GO TO 6800-EXIT.
 13184
 13185     MOVE SPACES                 TO W-CNTL-GEN2.
 13186
 13187     IF  DATASORI EQUAL '2'
 13188         IF  W-FILE-NOT-USED (8)
 13189             PERFORM 6450-READ-CERT-ONLY
 13190             IF  W-CERT-FOUND
 13191                 MOVE CM-AH-BENEFIT-CD
 13192                                 TO W-BEN-HOLD
 13193                                    W-CNTL-GEN2
 13194             ELSE
 13195                 NEXT SENTENCE
 13196         ELSE
 13197             MOVE CM-AH-BENEFIT-CD
 13198                                 TO W-BEN-HOLD
 13199                                    W-CNTL-GEN2
 13200     ELSE
 13201         IF  DATASORI EQUAL '4'
 13202             IF  W-FILE-NOT-USED (9)
 13203                 PERFORM 6400-READ-PNDB-ONLY
 13204                 IF  W-PNDB-FOUND
 13205                     IF  PI-689-TYPE = '1'
 13206                         MOVE PB-I-AH-BENEFIT-CD
 13207                                 TO W-BEN-HOLD
 13208                                    W-CNTL-GEN2
 13209                     ELSE
 13210                         MOVE PB-CI-AH-BENEFIT-CD
 13211                                 TO W-BEN-HOLD
 13212                                    W-CNTL-GEN2
 13213             ELSE
 13214                 NEXT SENTENCE
 13215         ELSE
 13216             IF  W-FILE-USED (8)
 13217                 MOVE CM-AH-BENEFIT-CD
 13218                                 TO W-BEN-HOLD
 13219                                    W-CNTL-GEN2
 13220             ELSE
 13221                 IF  W-FILE-USED (9)
 13222                     IF  PI-689-TYPE = '1'
 13223                         MOVE PB-I-AH-BENEFIT-CD
 13224                                 TO W-BEN-HOLD
 13225                                    W-CNTL-GEN2
 13226                     ELSE
 13227                         MOVE PB-CI-AH-BENEFIT-CD
 13228                                 TO W-BEN-HOLD
 13229                                    W-CNTL-GEN2.
 13230
 13231     IF  W-CNTL-GEN2 EQUAL SPACES
 13232         MOVE ER-9327            TO EMI-ERROR
 13233         MOVE -1                 TO MAINTL
 13234         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13235         GO TO 6800-EXIT.
 13236
 13237     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 274
* EL689.cbl
 13238     MOVE '5'                    TO W-CNTL-RECORD-TYPE.
 13239     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 13240
 13241
 13242* EXEC CICS HANDLE CONDITION
 13243*         NOTOPEN (8040-CNTL-NOT-OPEN)
 13244*         NOTFND  (6800-EXIT)
 13245*    END-EXEC.
 13246*    MOVE '"$JI                  ! ; #00012327' TO DFHEIV0
 13247     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13248     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13249     MOVE X'3B20233030303132333237' TO DFHEIV0(25:11)
 13250     CALL 'kxdfhei1' USING DFHEIV0
 13251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13252
 13253
 13254
 13255* EXEC CICS READ
 13256*         DATASET (W-CNTL-FILE-ID)
 13257*         SET     (ADDRESS OF CONTROL-FILE)
 13258*         RIDFLD  (W-CNTL-KEY)
 13259*         GTEQ
 13260*    END-EXEC.
 13261*    MOVE '&"S        G          (   #00012332' TO DFHEIV0
 13262     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13263     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13264     MOVE X'2020233030303132333332' TO DFHEIV0(25:11)
 13265     CALL 'kxdfhei1' USING DFHEIV0,
 13266           W-CNTL-FILE-ID,
 13267           DFHEIV20,
 13268           DFHEIV99,
 13269           W-CNTL-KEY,
 13270           DFHEIV99,
 13271           DFHEIV99,
 13272           DFHEIV99
 13273     SET ADDRESS OF CONTROL-FILE TO
 13274         DFHEIV20
 13275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13276
 13277
 13278     MOVE 1                      TO W-NDX.
 13279
 13280 6800-LOOP-AH.
 13281
 13282     IF  W-NDX = 9
 13283         GO TO 6800-EXIT.
 13284
 13285     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 13286         ADD 1                   TO W-NDX
 13287         GO TO 6800-LOOP-AH.
 13288
 13289     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 13290         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 13291                                 TO W-VG-TEXT (15)
 13292         MOVE CF-BENEFIT-ALPHA (W-NDX)
 13293                                 TO W-BENEFIT-WORK
 13294         MOVE W-ELIM-DAYS        TO W-VG-TEXT (16).
 13295
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 275
* EL689.cbl
 13296 6800-EXIT.
 13297     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 276
* EL689.cbl
 13299 6850-GET-CHECK-DATA.
 13300
 13301     IF  ADDRSI EQUAL '6'
 13302             AND
 13303         PI-CREATE-LABELS
 13304             AND
 13305         NOT PI-689-LABELS-OVERRIDEN
 13306         NEXT SENTENCE
 13307     ELSE
 13308         IF  W-FILE-NOT-USED (12)
 13309             GO TO 6850-EXIT.
 13310
 13311     IF  W-CHEK-CERT-NO EQUAL LOW-VALUES
 13312         MOVE ER-9327            TO EMI-ERROR
 13313         MOVE -1                 TO MAINTL
 13314         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13315         GO TO 6850-EXIT.
 13316
 13317
 13318* EXEC CICS HANDLE CONDITION
 13319*         NOTOPEN (8045-CHEK-NOT-OPEN)
 13320*         NOTFND  (6850-CHEK-NOT-FOUND)
 13321*    END-EXEC.
 13322*    MOVE '"$JI                  ! < #00012378' TO DFHEIV0
 13323     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13324     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13325     MOVE X'3C20233030303132333738' TO DFHEIV0(25:11)
 13326     CALL 'kxdfhei1' USING DFHEIV0
 13327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13328
 13329
 13330
 13331* EXEC CICS READ
 13332*         DATASET (W-CHEK-FILE-ID)
 13333*         SET     (ADDRESS OF CHECK-RECORDS)
 13334*         RIDFLD  (W-CHEK-KEY)
 13335*    END-EXEC.
 13336*    MOVE '&"S        E          (   #00012383' TO DFHEIV0
 13337     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13338     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13339     MOVE X'2020233030303132333833' TO DFHEIV0(25:11)
 13340     CALL 'kxdfhei1' USING DFHEIV0,
 13341           W-CHEK-FILE-ID,
 13342           DFHEIV20,
 13343           DFHEIV99,
 13344           W-CHEK-KEY,
 13345           DFHEIV99,
 13346           DFHEIV99,
 13347           DFHEIV99
 13348     SET ADDRESS OF CHECK-RECORDS TO
 13349         DFHEIV20
 13350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13351
 13352
 13353     MOVE CH-CHECK-NO            TO W-VG-TEXT (158).
 13354     MOVE CH-AMOUNT-PAID         TO W-EDIT-7-2.
 13355     MOVE W-EDIT-7-2             TO W-VG-TEXT (157).
 13356     MOVE CH-CHECK-QUE-CONTROL   TO W-DISPLAY-8
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 277
* EL689.cbl
 13357                                    PI-689-CONTROL.
 13358     MOVE W-DISPLAY-8            TO W-VG-TEXT (165).
 13359     MOVE CH-REASON-FOR-CHECK    TO W-VG-TEXT (166).
 13360
 13361     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13362     MOVE CH-PAYEE-NAME-1        TO W-LABEL-LINES (1).
 13363     MOVE CH-PAYEE-NAME-2        TO W-LABEL-LINES (2).
 13364     MOVE CH-PAYEE-ADDRESS-1     TO W-LABEL-LINES (3).
 13365     MOVE CH-PAYEE-ADDRESS-2     TO W-LABEL-LINES (4).
 13366     MOVE CH-PAYEE-CITY-ST       TO W-LABEL-LINES (5).
 13367
 13368     MOVE CH-PAYEE-ZIP           TO W-WORK-ZIP.
 13369     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13370
 13371     IF  CH-CANADIAN-POST-CODE
 13372         MOVE CH-CANADIAN-POSTAL-CODE
 13373                                 TO W-CANADIAN-POSTAL-CODES
 13374         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13375         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13376         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13377                                    W-LAB-CAN-FILLER (6)
 13378     ELSE
 13379         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13380         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13381             MOVE '-'            TO W-LABEL-DASH (6)
 13382             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 13383         ELSE
 13384             MOVE SPACES         TO W-LABEL-DASH (6)
 13385                                    W-LABEL-2ND-ZIP (6).
 13386
 13387     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13388
 13389     IF  ADDRSI EQUAL '6'
 13390             AND
 13391         PI-CREATE-LABELS
 13392             AND
 13393         NOT PI-689-LABELS-OVERRIDEN
 13394         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13395                                    W-VG-TEXT (159)
 13396         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13397                                    W-VG-TEXT (160)
 13398         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13399                                    W-VG-TEXT (161)
 13400         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13401                                    W-VG-TEXT (162)
 13402         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13403                                    W-VG-TEXT (163)
 13404         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13405                                    W-VG-TEXT (164)
 13406         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13407         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13408         SET W-RG-NDX UP BY +1
 13409     ELSE
 13410         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (159)
 13411         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (160)
 13412         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (161)
 13413         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (162)
 13414         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (163)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 278
* EL689.cbl
 13415         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (164).
 13416
 13417     GO TO 6850-EXIT.
 13418
 13419 6850-CHEK-NOT-FOUND.
 13420
 13421     IF  ADDRSL GREATER ZERO
 13422         IF ADDRSI = '6'
 13423            MOVE ER-2908         TO EMI-ERROR
 13424            MOVE -1              TO ADDRSL
 13425            MOVE AL-UNBON        TO ADDRSA
 13426            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13427            GO TO 8200-SEND-DATAONLY.
 13428
 13429 6850-EXIT.
 13430     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 279
* EL689.cbl
 13432 6900-GET-PYAJ-DATA.
 13433
 13434     IF  W-FILE-NOT-USED (13)
 13435         GO TO 6900-EXIT.
 13436
 13437     IF  W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 13438         MOVE ER-9327            TO EMI-ERROR
 13439         MOVE -1                 TO MAINTL
 13440         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13441         GO TO 6900-EXIT.
 13442
 13443
 13444* EXEC CICS HANDLE CONDITION
 13445*         NOTOPEN (8085-PYAJ-NOT-OPEN)
 13446*         NOTFND  (6900-PYAJ-NOT-FOUND)
 13447*    END-EXEC.
 13448*    MOVE '"$JI                  ! = #00012479' TO DFHEIV0
 13449     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13450     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13451     MOVE X'3D20233030303132343739' TO DFHEIV0(25:11)
 13452     CALL 'kxdfhei1' USING DFHEIV0
 13453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13454
 13455
 13456 6900-READ-NEXT.
 13457
 13458
 13459* EXEC CICS READ
 13460*         DATASET (W-PYAJ-FILE-ID)
 13461*         SET     (ADDRESS OF PENDING-PAY-ADJ)
 13462*         RIDFLD  (W-PYAJ-KEY)
 13463*         GTEQ
 13464*    END-EXEC.
 13465*    MOVE '&"S        G          (   #00012486' TO DFHEIV0
 13466     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 13467     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13468     MOVE X'2020233030303132343836' TO DFHEIV0(25:11)
 13469     CALL 'kxdfhei1' USING DFHEIV0,
 13470           W-PYAJ-FILE-ID,
 13471           DFHEIV20,
 13472           DFHEIV99,
 13473           W-PYAJ-KEY,
 13474           DFHEIV99,
 13475           DFHEIV99,
 13476           DFHEIV99
 13477     SET ADDRESS OF PENDING-PAY-ADJ TO
 13478         DFHEIV20
 13479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13480
 13481
 13482     IF  PY-COMPANY-CD NOT EQUAL W-PYAJ-COMPANY-CD
 13483             OR
 13484         PY-CARRIER NOT EQUAL W-PYAJ-CARRIER
 13485             OR
 13486         PY-GROUPING NOT EQUAL W-PYAJ-GROUPING
 13487             OR
 13488         PY-FIN-RESP NOT EQUAL W-PYAJ-FIN-RESP
 13489             OR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 280
* EL689.cbl
 13490         PY-ACCOUNT NOT EQUAL W-PYAJ-ACCOUNT
 13491         GO TO 6900-PYAJ-NOT-FOUND.
 13492
 13493     IF  PI-689-SEQ-NO GREATER THAN ZEROS
 13494             AND
 13495         PY-FILE-SEQ-NO NOT EQUAL PI-689-SEQ-NO
 13496         GO TO 6900-PYAJ-NOT-FOUND.
 13497
 13498     IF  PY-RECORD-TYPE NOT EQUAL W-PYAJ-RECORD-TYPE
 13499         MOVE PY-CONTROL-PRIMARY TO W-PYAJ-KEY
 13500         ADD +1                  TO W-PYAJ-FILE-SEQ-NO
 13501         GO TO 6900-READ-NEXT.
 13502
 13503     MOVE PY-CHECK-NUMBER        TO W-DISPLAY-7.
 13504     MOVE W-DISPLAY-7            TO W-VG-TEXT (171).
 13505
 13506     MOVE PY-ENTRY-AMT           TO W-EDIT-7-2.
 13507     MOVE W-EDIT-7-2             TO W-VG-TEXT (170).
 13508
 13509     MOVE PY-CHECK-QUE-CONTROL   TO W-DISPLAY-8
 13510                                    PI-689-CONTROL.
 13511     MOVE W-DISPLAY-8            TO W-VG-TEXT (172).
 13512     MOVE PY-ENTRY-COMMENT       TO W-VG-TEXT (173).
 13513
 13514     GO TO 6900-EXIT.
 13515
 13516 6900-PYAJ-NOT-FOUND.
 13517
 13518     MOVE ER-7395                TO EMI-ERROR
 13519     MOVE -1                     TO DATASORL
 13520     MOVE AL-UNBON               TO DATASORA
 13521     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13522     GO TO 8200-SEND-DATAONLY.
 13523
 13524 6900-EXIT.
 13525     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 281
* EL689.cbl
 13527 6950-MOVE-SYSTEM-DATA.
 13528
 13529     IF  W-FILE-NOT-USED (7)
 13530         GO TO 6950-EXIT.
 13531
 13532     MOVE EIBDATE                TO W-DATE-WORK.
 13533     MOVE W-DT-WORK              TO DC-JULIAN-YYDDD.
 13534     MOVE '5'                    TO DC-OPTION-CODE.
 13535     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13536     MOVE DC-GREG-DATE-1-EDIT    TO W-VG-TEXT (60).
 13537     MOVE DC-GREG-DATE-1-ALPHA   TO W-VG-TEXT (61).
 13538
 13539     MOVE FORMI                  TO W-VG-TEXT (62).
 13540
 13541     IF  PI-689-VARIABLE-DATA-1 GREATER THAN SPACES
 13542         MOVE PI-689-VARIABLE-DATA-1
 13543                                 TO W-VG-TEXT (63)
 13544         MOVE PI-689-VARIABLE-DATA-2
 13545                                 TO W-VG-TEXT (64)
 13546         MOVE PI-689-VARIABLE-DATA-3
 13547                                 TO W-VG-TEXT (65)
 13548         MOVE PI-689-VARIABLE-DATA-4
 13549                                 TO W-VG-TEXT (66)
 13550     ELSE
 13551         MOVE '(VARIABLE NOT PROVIDED)'
 13552                                 TO W-VG-TEXT (63).
 13553
 13554 6950-EXIT.
 13555     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 282
* EL689.cbl
 13557 7000-FORMAT-SCREEN.
 13558
 13559     IF  MAINTI EQUAL 'S'
 13560             OR
 13561         PI-SHOW-MODE
 13562         MOVE AL-PANOF           TO W-SC-TEXTA (W-SC-NDX)
 13563     ELSE
 13564         MOVE AL-UANOF           TO W-SC-TEXTA (W-SC-NDX).
 13565
 13566     IF  W-RG-NDX NOT GREATER THAN PI-689-NUMBER-LABEL-LINES
 13567         SET W-LINE23            TO W-RG-NDX
 13568         MOVE 'A'                TO W-LINE1
 13569     ELSE
 13570         SET W-LIN-NUM           TO W-RG-NDX
 13571         COMPUTE W-LIN-NUM
 13572             = W-LIN-NUM - PI-689-NUMBER-LABEL-LINES - 1.
 13573
 13574     MOVE W-LINE-NUM             TO W-SC-LINE (W-SC-NDX).
 13575     MOVE W-RC-TEXT (W-RG-NDX)   TO W-SC-TEXT (W-SC-NDX).
 13576     SET W-RG-NDX UP BY 1.
 13577
 13578 7000-EXIT.
 13579      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 283
* EL689.cbl
 13581 7100-FORMAT-LAST-NAME-1ST.
 13582*****************************************************************
 13583*             M O V E   N A M E   R O U T I N E                 *
 13584*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 13585*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 13586*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 13587*                  FIELD                   VALUE                *
 13588*           W-NAME-LAST    (CL15)      SMITH                    *
 13589*           W-NAME-FIRST   (CL15)      JOHN                     *
 13590*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 13591*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 13592*     CONTAIN                                                   *
 13593*                SMITH, JOHN ALLEN                              *
 13594*     OR                                                        *
 13595*                SMITH, JOHN A.                                 *
 13596*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 13597*     COPYBOOK, ELCNWA.                                         *
 13598*****************************************************************.
 13599
 13600     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 13601     MOVE ZERO                   TO WS-NAME-SW.
 13602     SET NWA-INDEX               TO +1.
 13603
 13604     IF  W-NAME-LAST EQUAL SPACES
 13605             AND
 13606         W-NAME-MIDDLE EQUAL SPACES
 13607         MOVE +1                 TO WS-NAME-SW.
 13608
 13609     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 13610     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 13611
 13612     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 13613     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 13614
 13615     SET NWA-INDEX UP BY +1.
 13616
 13617     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 13618         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 13619             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 13620             SET NWA-INDEX UP BY +1
 13621             MOVE '.'            TO WS-NW (NWA-INDEX)
 13622             SET NWA-INDEX UP BY +2
 13623         ELSE
 13624             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 13625             PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 13626
 13627 7100-EXIT.
 13628     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 284
* EL689.cbl
 13630 7110-MOVE-NAME.
 13631
 13632     IF  WS-NAME-SW GREATER THAN +1
 13633         GO TO 7110-EXIT.
 13634
 13635     IF  WS-NAME-WORK2 = SPACES
 13636         GO TO 7110-EXIT.
 13637
 13638     SET NWA-INDEX2            TO +1.
 13639     SET NWA-INDEX3            TO +2.
 13640
 13641 7110-MOVE-NAME-CYCLE.
 13642
 13643     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 13644
 13645     IF  NWA-INDEX LESS THAN +30
 13646         SET NWA-INDEX UP BY +1
 13647     ELSE
 13648         ADD +2                TO WS-NAME-SW
 13649         GO TO 7110-EXIT.
 13650
 13651     IF  NWA-INDEX2 LESS THAN +20
 13652         SET NWA-INDEX3 UP BY +1
 13653         SET NWA-INDEX2 UP BY +1.
 13654
 13655     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 13656             AND
 13657         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 13658         IF  WS-NAME-SW EQUAL ZERO
 13659             MOVE ','            TO WS-NW (NWA-INDEX)
 13660             SET NWA-INDEX UP BY +2
 13661             MOVE +1             TO WS-NAME-SW
 13662             GO TO 7110-EXIT
 13663         ELSE
 13664             GO TO 7110-EXIT.
 13665
 13666     GO TO 7110-MOVE-NAME-CYCLE.
 13667
 13668 7110-EXIT.
 13669     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 285
* EL689.cbl
 13671 7200-FORMAT-NAME-STRAIGHT.
 13672*****************************************************************
 13673*           M O V E   N A M E   R O U T I N E                   *
 13674*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 13675*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 13676*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 13677*                  FIELD                   VALUE                *
 13678*           W-NAME-LAST    (CL15)      SMITH                    *
 13679*           W-NAME-FIRST   (CL15)      JOHN                     *
 13680*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 13681*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 13682*     CONTAIN                                                   *
 13683*              JOHN A. SMITH                                    *
 13684*     OR                                                        *
 13685*              JOHN ALLEN SMITH                                 *
 13686*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 13687*     COPYBOOK, ELCNWA.                                         *
 13688*****************************************************************
 13689
 13690     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 13691     MOVE ZERO                   TO WS-NAME-SW.
 13692     SET NWA-INDEX               TO +1.
 13693
 13694     IF  W-NAME-FIRST EQUAL SPACES
 13695             AND
 13696         W-NAME-MIDDLE EQUAL SPACES
 13697         MOVE W-NAME-LAST        TO WS-NAME-WORK
 13698         GO TO 7200-EXIT.
 13699
 13700     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 13701     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 13702
 13703     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 13704         SET NWA-INDEX UP BY +1
 13705
 13706         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 13707             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 13708             SET NWA-INDEX UP BY +1
 13709             MOVE '.'            TO WS-NW (NWA-INDEX)
 13710             SET NWA-INDEX UP BY +1
 13711
 13712         ELSE
 13713             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 13714             PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 13715
 13716     SET NWA-INDEX UP BY +1
 13717     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 13718     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 13719
 13720 7200-EXIT.
 13721     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 286
* EL689.cbl
 13723 7290-MOVE-NAME.
 13724
 13725     IF  WS-NAME-SW GREATER THAN +1
 13726         GO TO 7290-EXIT.
 13727
 13728     IF  WS-NAME-WORK2 EQUAL SPACES
 13729         GO TO 7290-EXIT.
 13730
 13731     SET NWA-INDEX2            TO +1.
 13732     SET NWA-INDEX3            TO +2.
 13733
 13734 7290-MOVE-NAME-CYCLE.
 13735
 13736     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 13737
 13738     IF  NWA-INDEX LESS THAN +30
 13739         SET NWA-INDEX UP BY +1
 13740     ELSE
 13741         ADD +2                TO WS-NAME-SW
 13742         GO TO 7290-EXIT.
 13743
 13744     IF  NWA-INDEX2 LESS THAN +20
 13745         SET NWA-INDEX2 UP BY +1
 13746         SET NWA-INDEX3 UP BY +1.
 13747
 13748     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 13749             AND
 13750         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 13751         GO TO 7290-EXIT.
 13752
 13753     GO TO 7290-MOVE-NAME-CYCLE.
 13754
 13755 7290-EXIT.
 13756     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 287
* EL689.cbl
 13758 7300-LABEL-MOVE.
 13759
 13760     IF  W-LABEL-HOLD-AREA = SPACES
 13761         MOVE +0                 TO W-NUMB-LABEL-LINES
 13762         GO TO 7300-EXIT.
 13763
 13764     IF  W-LABEL-LINES (1) = SPACES
 13765         MOVE W-LABEL-LINES (2)  TO W-LABEL-LINES (1)
 13766         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 13767         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 13768         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 13769         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13770         MOVE SPACES             TO W-LABEL-LINES (6)
 13771         GO TO 7300-LABEL-MOVE.
 13772
 13773     IF  W-LABEL-LINES (2) = SPACES
 13774             AND
 13775         W-LABEL-LINES (3) = SPACES
 13776             AND
 13777         W-LABEL-LINES (4) = SPACES
 13778             AND
 13779         W-LABEL-LINES (5) = SPACES
 13780             AND
 13781         W-LABEL-LINES (6) = SPACES
 13782         MOVE 1                  TO W-NDX
 13783                                    W-NUMB-LABEL-LINES
 13784         GO TO 7300-EXIT.
 13785
 13786 7300-TRY-2.
 13787
 13788     IF  W-LABEL-LINES (2) = SPACES
 13789         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 13790         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 13791         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 13792         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13793         MOVE SPACES             TO W-LABEL-LINES (6)
 13794         GO TO 7300-TRY-2.
 13795
 13796     IF  W-LABEL-LINES (3) = SPACES
 13797             AND
 13798         W-LABEL-LINES (4) = SPACES
 13799             AND
 13800         W-LABEL-LINES (5) = SPACES
 13801             AND
 13802         W-LABEL-LINES (6) = SPACES
 13803         MOVE 2                  TO W-NDX
 13804         GO TO 7300-MOVE-ZIP.
 13805
 13806 7300-TRY-3.
 13807
 13808     IF  W-LABEL-LINES (3) = SPACES
 13809         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 13810         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 13811         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13812         MOVE SPACES             TO W-LABEL-LINES (6)
 13813         GO TO 7300-TRY-3.
 13814
 13815     IF  W-LABEL-LINES (4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 288
* EL689.cbl
 13816             AND
 13817         W-LABEL-LINES (5) = SPACES
 13818             AND
 13819         W-LABEL-LINES (6) = SPACES
 13820         MOVE 3                   TO W-NDX
 13821         GO TO 7300-MOVE-ZIP.
 13822
 13823 7300-TRY-4.
 13824
 13825     IF  W-LABEL-LINES (4) = SPACES
 13826         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 13827         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13828         MOVE SPACES             TO W-LABEL-LINES (6)
 13829         GO TO 7300-TRY-4.
 13830
 13831     IF  W-LABEL-LINES (5) = SPACES
 13832             AND
 13833         W-LABEL-LINES (6) = SPACES
 13834         MOVE 4                  TO W-NDX
 13835         GO TO 7300-MOVE-ZIP.
 13836
 13837 7300-TRY-5.
 13838
 13839     IF  W-LABEL-LINES (5) = SPACES
 13840         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 13841         MOVE SPACES             TO W-LABEL-LINES (6)
 13842         GO TO 7300-TRY-5
 13843     ELSE
 13844         IF  W-LABEL-LINES (6) = SPACES
 13845             MOVE 5              TO W-NDX
 13846             GO TO 7300-MOVE-ZIP
 13847         ELSE
 13848             MOVE 6              TO W-NDX.
 13849
 13850 7300-MOVE-ZIP.
 13851
 13852     COMPUTE W-NDX2 = W-NDX - 1.
 13853
 13854     IF  W-LAST-ZIP (W-NDX2) = SPACES
 13855*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 13856
 13857         IF  W-LABEL-1ST-ZIP (W-NDX) NUMERIC
 13858                 MOVE W-LABEL-ZIP (W-NDX)
 13859                                 TO W-LAST-ZIP (W-NDX2)
 13860                 MOVE SPACES     TO W-LABEL-LINES (W-NDX)
 13861                 MOVE W-NDX2     TO W-NUMB-LABEL-LINES
 13862                 GO TO 7300-EXIT.
 13863
 13864     MOVE W-NDX                  TO W-NUMB-LABEL-LINES.
 13865
 13866 7300-EXIT.
 13867     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 289
* EL689.cbl
 13869 7400-CREATE-LETTER.
 13870****************************************************************
 13871*    THIS AREA CONTROLS THE PROCESSING OF INDIVIDUAL INPUT     *
 13872*    RECORDS.                                                  *
 13873****************************************************************
 13874
 13875     SET W-SQ-NDX                TO W-START-COLUMN.
 13876     MOVE SPACES                 TO W-SQUEEZED-LINE
 13877                                    W-WORK-LINE.
 13878     MOVE W-START-COLUMN         TO W-LAST-SQUEEZED-SPACE
 13879     MOVE +1                     TO W-LAST-WC-SPACE.
 13880     MOVE HIGH-VALUES            TO W-LAST-SQ-CHAR.
 13881
 13882     SET W-TG-NDX                TO +1.
 13883
 13884     PERFORM 7410-TEXT-LINE-PROCESS THRU 7410-EXIT
 13885            VARYING
 13886         W-TG-NDX FROM W-TG-NDX BY +1
 13887            UNTIL
 13888         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
 13889
 13890     IF  W-FORM-SQUEEZE-ON
 13891             AND
 13892         W-SQUEEZED-LINE GREATER THAN SPACES
 13893         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT.
 13894
 13895     PERFORM 7640-PAGING THRU 7640-EXIT.
 13896
 13897 7400-EXIT.
 13898     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 290
* EL689.cbl
 13900 7410-TEXT-LINE-PROCESS.
 13901***************************************************************
 13902*    THIS ROUTINE SEARCHES THE TEXT WORK AREA FOR ANY         *
 13903*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 13904*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 13905*    DATA THAT WAS GENERATED PREVIOUSLY.  WHILE PERFORMING    *
 13906*    THIS FUNCTION THE ROUTINE MOVES EACH CHARACTER OR ITS    *
 13907*    VARIABLE REPLACEMENT TO A WORK LINE.                     *
 13908***************************************************************
 13909
 13910
 13911     SET W-WC-NDX                TO W-ZEROS.
 13912     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 13913
 13914     MOVE W-TX-SC (W-TG-NDX)     TO W-LINE-SQUEEZE-IND.
 13915
 13916     PERFORM 7420-TEXT-CHAR-PROCESS THRU 7420-EXIT
 13917             VARYING
 13918         W-TX-NDX FROM +1 BY +1
 13919             UNTIL
 13920         W-TX-NDX GREATER THAN +70.
 13921
 13922****************************************************************
 13923*    IF SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS    *
 13924*    EACH LINE OF TEXT IS PROCESSED ACCORDING TO THE INDICATED *
 13925*    LINE SQUEEZE CONTROL.                                     *
 13926****************************************************************
 13927     IF  W-FORM-SQUEEZE-ON
 13928
 13929         IF  W-WORK-LINE GREATER THAN SPACES
 13930                 OR
 13931             W-AS-IS
 13932             PERFORM 7450-SQUEEZING THRU 7450-EXIT
 13933
 13934         ELSE
 13935             NEXT SENTENCE
 13936****************************************************************
 13937*    IF NO SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS *
 13938*    EACH LINE OF TEXT IS PRINT AS IS EXCEPT FOR VARIABLES     *
 13939****************************************************************
 13940     ELSE
 13941         IF  W-WORK-LINE GREATER THAN SPACES
 13942             MOVE W-TX-PC (W-TG-NDX)
 13943                                 TO W-PRINT-CONTROL
 13944             MOVE W-WORK-LINE    TO W-SQUEEZED-LINE
 13945             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 13946             MOVE SPACES         TO W-WORK-LINE.
 13947
 13948 7410-EXIT.
 13949     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 291
* EL689.cbl
 13951 7420-TEXT-CHAR-PROCESS.
 13952****************************************************************
 13953*    LOOKING FOR VARIABLE INDICATORS (**XXX) THIS SECTION      *
 13954*    CONTROLS THE CONVERSION OF THESE INDICATORS INTO THEIR    *
 13955*    ACTUAL VALUES.  IT MOVES THESE REPLACEMENTS AND THE       *
 13956*    REMAINING CHARACTERS TO THE WORK LINE.                    *
 13957****************************************************************
 13958
 13959     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 13960             AND
 13961         W-LAST-CHAR EQUAL '@'
 13962         PERFORM 7430-PROCESS-VARIABLE THRU 7430-EXIT.
 13963
 13964     SET W-WC-NDX UP BY +1.
 13965
 13966     IF  W-WC-NDX GREATER THAN +70
 13967         IF  W-FORM-SQUEEZE-ON
 13968                 AND
 13969             NOT W-AS-IS
 13970             PERFORM 7440-BACK-TO-NEAREST-WORD THRU 7440-EXIT
 13971                     VARYING
 13972                 W-WC-NDX FROM W-LAST-WC-SPACE BY +1
 13973                     UNTIL
 13974                 W-WC-NDX EQUAL +71
 13975             SET W-TX-NDX        TO W-LAST-TX-SPACE
 13976
 13977             IF  W-WORK-LINE GREATER THAN SPACES
 13978                 PERFORM 7450-SQUEEZING THRU 7450-EXIT
 13979                 MOVE SPACES     TO W-WORK-LINE
 13980                                    W-LINE-SQUEEZE-IND
 13981                 SET W-WC-NDX    TO +1
 13982             ELSE
 13983                 SET W-WC-NDX    TO +1
 13984         ELSE
 13985             PERFORM 7460-REMAIN-CHAR-CHECK THRU 7460-EXIT.
 13986
 13987     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 13988                                 TO W-CHARACTER-TYPE.
 13989
 13990     SET W-WC-NDX2               TO W-WC-NDX.
 13991     SET W-WC-NDX2 DOWN BY +1.
 13992
 13993     IF  W-PUNCTUATION
 13994             AND
 13995         W-WC-NDX2 GREATER THAN W-ZEROS
 13996             AND
 13997         W-WORK-CHAR (W-WC-NDX2) EQUAL SPACES
 13998         SET W-WC-NDX DOWN BY +1.
 13999
 14000     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14001                                 TO W-LAST-CHAR
 14002                                    W-WORK-CHAR (W-WC-NDX).
 14003
 14004     IF  W-LAST-CHAR EQUAL SPACES
 14005         SET W-LAST-WC-SPACE     TO W-WC-NDX
 14006         SET W-LAST-TX-SPACE     TO W-TX-NDX.
 14007
 14008 7420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 292
* EL689.cbl
 14009     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 293
* EL689.cbl
 14011 7430-PROCESS-VARIABLE.
 14012******************************************************************
 14013*    THIS SECTION CHECKS ON ALL '@@XXX' FORMATED CHARACTER       *
 14014*    GROUPS.  IF IN PROPER FORMAT, EACH GROUP IS REPLACED WITH   *
 14015*    ITS CORRESPONDING VALUES.                                   *
 14016******************************************************************
 14017
 14018     SET W-TX-NDX UP BY +1.
 14019
 14020     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14021         MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14022                                 TO W-V1
 14023         SET W-TX-NDX UP BY +1
 14024
 14025         IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14026             MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14027                                 TO W-V2
 14028             SET W-TX-NDX UP BY +1
 14029             IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 14030                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14031                                 TO W-V3
 14032                 SET W-TX-NDX UP BY +1
 14033                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 14034                                 TO W-FIELD-SQUEEZE-IND
 14035                 GO TO 7430-CONTINUE
 14036             ELSE
 14037                 SET W-TX-NDX DOWN BY +3
 14038                 MOVE ER-0180    TO EMI-ERROR
 14039                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14040                 MOVE -1         TO MAINTL
 14041                 MOVE HIGH-VALUES
 14042                                 TO W-LAST-CHAR
 14043         ELSE
 14044             SET W-TX-NDX DOWN BY +2
 14045             MOVE ER-0180        TO EMI-ERROR
 14046             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14047             MOVE -1             TO MAINTL
 14048             MOVE HIGH-VALUES    TO W-LAST-CHAR
 14049     ELSE
 14050         SET W-TX-NDX DOWN BY +1
 14051         MOVE ER-7246            TO EMI-ERROR
 14052         MOVE -1                 TO MAINTL
 14053         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14054         MOVE HIGH-VALUES        TO W-LAST-CHAR.
 14055
 14056****************************************************************
 14057*    WHEN THE PROPER FORM IS NOT FOUND THE CHARACTERS INVOLVED *
 14058*    ARE TRANSFERRED INTACT AND A NOTE MADE INDICATING THIS    *
 14059*    ACTION.                                                   *
 14060****************************************************************
 14061
 14062     IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14063         MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 14064         GO TO 7430-EXIT
 14065     ELSE
 14066         GO TO 7430-EXIT.
 14067
 14068 7430-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 294
* EL689.cbl
 14069
 14070     IF  W-VAR-RELATIVE-NUM LESS THAN 001
 14071             OR
 14072         W-VAR-RELATIVE-NUM GREATER THAN W-NUM-OF-VARIABLES
 14073         SET W-TX-NDX DOWN BY +4
 14074         MOVE ER-0180            TO EMI-ERROR
 14075         MOVE -1                 TO MAINTL
 14076         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14077         MOVE HIGH-VALUES        TO W-LAST-CHAR
 14078         IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14079             MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 14080             GO TO 7430-EXIT
 14081         ELSE
 14082             GO TO 7430-EXIT.
 14083
 14084     SET W-VG-NDX                TO W-VAR-RELATIVE-NUM.
 14085
 14086     SET W-WC-NDX DOWN BY +1.
 14087
 14088     IF  (W-FORM-SQUEEZE-OFF
 14089                 AND
 14090             NOT W-SQUEEZE-FIELD)
 14091             OR
 14092         (W-FORM-SQUEEZE-ON
 14093                 AND
 14094             W-AS-IS)
 14095         PERFORM 7435-MOVE-VARIABLE-DIRECT THRU 7435-EXIT
 14096                 VARYING
 14097             W-VC-NDX FROM +1 BY +1
 14098                 UNTIL
 14099             W-VC-NDX GREATER THAN
 14100                 W-VARIABLE-SIZE (W-VG-NDX)
 14101
 14102         IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +5
 14103             SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 14104             SET W-TX-NDX DOWN BY +5
 14105             IF  W-TX-NDX GREATER THAN +70
 14106                 SET W-TX-NDX    TO +70
 14107                 GO TO 7430-EXIT
 14108             ELSE
 14109                 GO TO 7430-EXIT
 14110         ELSE
 14111             COMPUTE W-ADJUST-SHORT
 14112                 = 5 - W-VARIABLE-SIZE (W-VG-NDX)
 14113             SET W-WC-NDX UP BY W-ADJUST-SHORT
 14114             GO TO 7430-EXIT.
 14115
 14116     IF  W-SQUEEZE-FIELD
 14117         SET W-TX-NDX UP BY +1.
 14118
 14119     MOVE SPACES                 TO W-FIRST-CHAR-FOUND-IND.
 14120
 14121     PERFORM 7470-MOVE-CHAR THRU 7470-EXIT
 14122             VARYING
 14123         W-VC-NDX FROM +1 BY +1
 14124             UNTIL
 14125         W-VC-NDX GREATER THAN
 14126             W-VARIABLE-SIZE (W-VG-NDX).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 295
* EL689.cbl
 14127
 14128     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 14129
 14130     IF  W-FORM-SQUEEZE-ON
 14131         GO TO 7430-EXIT.
 14132
 14133     IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +6
 14134         SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 14135         SET W-TX-NDX DOWN BY +6
 14136         IF  W-TX-NDX GREATER THAN +70
 14137             SET W-TX-NDX        TO +70.
 14138
 14139     IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 14140         SET W-WC-NDX DOWN BY +1.
 14141
 14142 7430-EXIT.
 14143     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 296
* EL689.cbl
 14145 7435-MOVE-VARIABLE-DIRECT.
 14146
 14147     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 14148             AND
 14149         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 14150             AND
 14151         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 14152             AND
 14153         (W-VC-NDX GREATER THAN +1
 14154                 AND
 14155             W-LAST-CHAR NOT EQUAL SPACE
 14156                 AND
 14157             NOT W-LAST-CHAR-PUNC)
 14158         IF  W-LC-USE-BOTH-CASES
 14159             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14160                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 14161         ELSE
 14162             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14163                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 14164
 14165     SET W-WC-NDX UP BY +1.
 14166     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14167                                 TO W-WORK-CHAR (W-WC-NDX)
 14168                                    W-LAST-CHAR.
 14169
 14170 7435-EXIT.
 14171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 297
* EL689.cbl
 14173 7437-FIND-NEXT-CHARACTER.
 14174*DELIBERATELY LEFT BLANK.
 14175 7437-EXIT.
 14176     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 298
* EL689.cbl
 14178 7440-BACK-TO-NEAREST-WORD.
 14179
 14180     MOVE SPACES                 TO W-WORK-CHAR (W-WC-NDX).
 14181
 14182 7440-EXIT.
 14183     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 299
* EL689.cbl
 14185 7450-SQUEEZING.
 14186
 14187     IF  W-NEW-PARAGRAPH
 14188         PERFORM 7600-SET-PARA-INDENT THRU 7600-EXIT
 14189         MOVE SPACES             TO W-LINE-SQUEEZE-IND
 14190         IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14191             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14192             MOVE W-TX-PC (W-TG-NDX)
 14193                                 TO W-PRINT-CONTROL
 14194             MOVE SPACES         TO W-SQUEEZED-LINE
 14195             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 14196             SET W-SQ-NDX UP BY W-WORK-INDENT
 14197         ELSE
 14198             MOVE W-TX-PC (W-TG-NDX)
 14199                                 TO W-PRINT-CONTROL
 14200             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 14201             SET W-SQ-NDX UP BY W-WORK-INDENT
 14202     ELSE
 14203         IF  W-DO-NOT-ADJUST
 14204             MOVE SPACES         TO W-LINE-SQUEEZE-IND
 14205             IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14206                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14207                 MOVE W-WORK-LINE
 14208                                 TO W-SQUEEZED-LINE
 14209                 MOVE W-TX-PC (W-TG-NDX)
 14210                                 TO W-PRINT-CONTROL
 14211                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14212                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 14213                 MOVE SPACES     TO W-SQUEEZED-LINE
 14214                 GO TO 7450-EXIT
 14215             ELSE
 14216                 MOVE W-WORK-LINE
 14217                                 TO W-SQUEEZED-LINE
 14218                 MOVE W-TX-PC (W-TG-NDX)
 14219                                 TO W-PRINT-CONTROL
 14220                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14221                 MOVE SPACES     TO W-SQUEEZED-LINE
 14222                                    W-WORK-LINE
 14223                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 14224                 GO TO 7450-EXIT
 14225         ELSE
 14226             IF  W-ADJUST-TO-LINE-LENGTH
 14227                 MOVE SPACES     TO W-LINE-SQUEEZE-IND
 14228
 14229                 IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14230                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14231                     SET W-SQ-NDX
 14232                                 TO W-INITIAL-COLUMN
 14233                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 14234                             VARYING
 14235                         W-WC-NDX FROM 1 BY 1
 14236                             UNTIL
 14237                         W-SQ-NDX EQUAL W-TOO-FAR
 14238                     MOVE W-TX-PC (W-TG-NDX)
 14239                                 TO W-PRINT-CONTROL
 14240                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14241                     SET W-SQ-NDX
 14242                                 TO W-INITIAL-COLUMN
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 300
* EL689.cbl
 14243                     MOVE SPACES TO W-SQUEEZED-LINE
 14244                                    W-WORK-LINE
 14245                     GO TO 7450-EXIT
 14246                 ELSE
 14247                     SET W-SQ-NDX
 14248                                 TO W-INITIAL-COLUMN
 14249                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 14250                             VARYING
 14251                         W-WC-NDX FROM 1 BY 1
 14252                             UNTIL
 14253                         W-SQ-NDX EQUAL W-TOO-FAR
 14254                     MOVE W-TX-PC (W-TG-NDX)
 14255                                 TO W-PRINT-CONTROL
 14256                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14257                     MOVE SPACES TO W-SQUEEZED-LINE
 14258                                    W-WORK-LINE
 14259                     SET W-SQ-NDX
 14260                                 TO W-INITIAL-COLUMN
 14261                     GO TO 7450-EXIT
 14262             ELSE
 14263                 IF  W-CONTINUE-PARAGRAPH
 14264                     IF  W-SQUEEZED-LINE GREATER THAN SPACES
 14265                         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14266                         PERFORM 7610-SET-CONP-INDENT
 14267                             THRU 7610-EXIT
 14268                         MOVE SPACES
 14269                                 TO W-LINE-SQUEEZE-IND
 14270                         MOVE W-TX-PC (W-TG-NDX)
 14271                                 TO W-PRINT-CONTROL
 14272                         MOVE SPACES
 14273                                 TO W-SQUEEZED-LINE
 14274                         SET W-SQ-NDX
 14275                                 TO W-INITIAL-COLUMN
 14276                         SET W-SQ-NDX UP BY W-WORK-INDENT
 14277                     ELSE
 14278                         PERFORM 7610-SET-CONP-INDENT
 14279                             THRU 7610-EXIT
 14280                         MOVE SPACES
 14281                                 TO W-LINE-SQUEEZE-IND
 14282                         MOVE W-TX-PC (W-TG-NDX)
 14283                                 TO W-PRINT-CONTROL
 14284                         MOVE SPACES
 14285                                 TO W-SQUEEZED-LINE
 14286                         SET W-SQ-NDX
 14287                                 TO W-INITIAL-COLUMN
 14288                         SET W-SQ-NDX UP BY W-WORK-INDENT.
 14289
 14290
 14291     PERFORM 7480-UPDATE-SQUEEZED-LINE THRU 7480-EXIT
 14292             VARYING
 14293         W-WC-NDX FROM +1 BY +1
 14294             UNTIL
 14295         W-WC-NDX GREATER THAN +70.
 14296
 14297 7450-EXIT.
 14298     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 301
* EL689.cbl
 14300 7460-REMAIN-CHAR-CHECK.
 14301
 14302     IF  W-TX-NDX EQUAL W-WC-NDX
 14303         MOVE W-TX-PC (W-TG-NDX)
 14304                                 TO W-PRINT-CONTROL
 14305         MOVE W-WORK-LINE        TO W-SQUEEZED-LINE
 14306         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14307         MOVE SPACES             TO W-WORK-LINE
 14308         SET W-WC-NDX            TO +1
 14309     ELSE
 14310         SET W-TX-NDX1           TO W-TX-NDX
 14311         SEARCH W-TX-CHAR
 14312             VARYING W-TX-NDX1
 14313             AT END
 14314                 MOVE W-TX-PC (W-TG-NDX)
 14315                                 TO W-PRINT-CONTROL
 14316                 MOVE W-WORK-LINE
 14317                                 TO W-SQUEEZED-LINE
 14318                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14319                 MOVE SPACES     TO W-WORK-LINE
 14320                 SET W-WC-NDX    TO +1
 14321                 SET W-TX-NDX    TO +1
 14322                 SET W-TG-NDX UP BY +1
 14323             WHEN
 14324                 W-TX-CHAR (W-TG-NDX W-TX-NDX1) NOT EQUAL SPACES
 14325                 MOVE ER-9427    TO EMI-ERROR
 14326                 MOVE -1         TO MAINTL
 14327                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14328                 MOVE W-TX-PC (W-TG-NDX)
 14329                                 TO W-PRINT-CONTROL
 14330                 MOVE W-WORK-LINE
 14331                                 TO W-SQUEEZED-LINE
 14332                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14333                 MOVE SPACES     TO W-WORK-LINE
 14334                 SET W-WC-NDX    TO +1.
 14335
 14336 7460-EXIT.
 14337     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 302
* EL689.cbl
 14339 7470-MOVE-CHAR.
 14340
 14341     IF  W-FIRST-CHAR-NOT-FOUND
 14342             AND
 14343         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 14344         MOVE SPACES             TO W-LAST-CHAR
 14345         GO TO 7470-EXIT.
 14346
 14347     MOVE 'Y'                    TO W-FIRST-CHAR-FOUND-IND.
 14348
 14349     IF  W-SQUEEZE-FIELD
 14350             AND
 14351         W-LAST-CHAR EQUAL SPACES
 14352             AND
 14353         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 14354         GO TO 7470-EXIT.
 14355
 14356     SET W-WC-NDX UP BY +1.
 14357
 14358     IF  W-WC-NDX GREATER THAN +70
 14359         IF  W-FORM-SQUEEZE-ON
 14360             GO TO 7470-EXIT
 14361         ELSE
 14362             MOVE ER-9427        TO EMI-ERROR
 14363             MOVE -1             TO MAINTL
 14364             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14365             GO TO 7470-EXIT.
 14366
 14367     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 14368             AND
 14369         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 14370             AND
 14371         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 14372             AND
 14373         (W-VC-NDX GREATER THAN +1
 14374                 AND
 14375             W-LAST-CHAR NOT EQUAL SPACE
 14376                 AND
 14377             NOT W-LAST-CHAR-PUNC)
 14378         IF  W-LC-USE-BOTH-CASES
 14379             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14380                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 14381         ELSE
 14382             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14383                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 14384
 14385     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 14386                                 TO W-WORK-CHAR (W-WC-NDX)
 14387                                    W-LAST-CHAR.
 14388
 14389     IF  W-LAST-CHAR EQUAL SPACES
 14390         SET W-LAST-WC-SPACE     TO W-WC-NDX.
 14391
 14392 7470-EXIT.
 14393     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 303
* EL689.cbl
 14395 7480-UPDATE-SQUEEZED-LINE.
 14396****************************************************************
 14397*    THIS SECTION CONTROLS THE MOVEMENT FROM THE WORK LINE TO *
 14398*    THE SQUEEZED LINE.  DURING THIS PROCESS ALL EXTRA SPACES  *
 14399*    (DEFINED AS TWO OR MORE SPACES NOT FOLLOWING A END OF     *
 14400*    SENTENCE INDICATOR) ARE REMOVED.  IF THE LAST CHARACTER   *
 14401*    IS NOT A SPACE OR PUNCTUATION MARK AN UNFINISHED WORD IS  *
 14402*    ASSUMED.  EVERYTHING TO THE PREVIOUS SPACE IS REMOVED     *
 14403****************************************************************
 14404
 14405     SET W-SQ-NDX UP BY +1.
 14406
 14407     IF  W-SQ-NDX GREATER THAN W-LAST-COLUMN
 14408         MOVE W-SQ-CHAR (W-LAST-COLUMN)
 14409                                 TO W-CHARACTER-TYPE
 14410         IF  W-PUNCTUATION
 14411                 OR
 14412             W-SPACE
 14413             PERFORM 7485-FIND-NEXT-CHARACTER THRU 7485-EXIT
 14414             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14415             MOVE SPACES         TO W-SQUEEZED-LINE
 14416             SET W-SQ-NDX        TO W-START-COLUMN
 14417             SET W-SQ-NDX UP BY W-NEXT-INDENT
 14418             SET W-LAST-SQUEEZED-SPACE
 14419                                 TO W-SQ-NDX
 14420         ELSE
 14421             PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 14422             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 14423             MOVE SPACES         TO W-SQUEEZED-LINE
 14424             SET W-SQ-NDX        TO W-START-COLUMN
 14425             SET W-SQ-NDX UP BY W-NEXT-INDENT
 14426             SET W-LAST-SQUEEZED-SPACE
 14427                                 TO W-SQ-NDX.
 14428
 14429     IF  W-WC-NDX GREATER THAN +70
 14430         GO TO 7480-EXIT.
 14431
 14432     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 14433
 14434     IF  W-END-OF-SENTENCE
 14435         MOVE 'Y'                TO W-END-OF-SENTENCE-IND
 14436         SET W-WORK-NDX          TO W-SQ-NDX
 14437         COMPUTE W-DISPLAY-NDX = W-WORK-NDX - 1
 14438         IF  W-DISPLAY-NDX EQUAL W-LAST-SQUEEZED-SPACE
 14439             SET W-SQ-NDX        TO W-LAST-SQUEEZED-SPACE
 14440         ELSE
 14441             NEXT SENTENCE
 14442     ELSE
 14443         IF  W-PUNCTUATION
 14444                 AND
 14445             W-LAST-SQ-CHAR EQUAL SPACES
 14446             SET W-SQ-NDX DOWN BY +1
 14447             MOVE SPACES         TO W-END-OF-SENTENCE-IND
 14448         ELSE
 14449             IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 14450                 IF  W-LAST-SQ-CHAR EQUAL SPACES
 14451                     IF  W-END-OF-SENTENCE-WORKING
 14452                         MOVE SPACES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 304
* EL689.cbl
 14453                                 TO W-END-OF-SENTENCE-IND
 14454                         SET W-LAST-SQUEEZED-SPACE
 14455                                 TO W-SQ-NDX
 14456                     ELSE
 14457                         SET W-SQ-NDX DOWN BY +1
 14458                         GO TO 7480-EXIT
 14459                 ELSE
 14460                     SET W-LAST-SQUEEZED-SPACE
 14461                                 TO W-SQ-NDX
 14462             ELSE
 14463                 MOVE SPACES     TO W-END-OF-SENTENCE-IND.
 14464
 14465     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX)
 14466                                    W-LAST-SQ-CHAR.
 14467
 14468     IF  W-WC-NDX EQUAL +70
 14469             AND
 14470         W-WORK-CHAR (W-WC-NDX) GREATER THAN SPACES
 14471             AND
 14472         W-SQ-NDX NOT EQUAL W-LAST-COLUMN
 14473         SET W-SQ-NDX UP BY +1
 14474         SET W-LAST-SQUEEZED-SPACE
 14475                                 TO W-SQ-NDX
 14476         MOVE SPACES             TO W-SQ-CHAR (W-SQ-NDX)
 14477                                    W-LAST-SQ-CHAR.
 14478
 14479 7480-EXIT.
 14480     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 305
* EL689.cbl
 14482 7485-FIND-NEXT-CHARACTER.
 14483
 14484     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 14485
 14486     IF  W-PUNCTUATION
 14487         PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 14488     ELSE
 14489         SET W-WC-NDX            TO W-WC-NDX
 14490         SEARCH W-WORK-CHAR
 14491             VARYING W-WC-NDX
 14492             AT END
 14493                 GO TO 7485-EXIT
 14494             WHEN
 14495                 W-WORK-CHAR (W-WC-NDX) NOT EQUAL SPACES
 14496                 GO TO 7485-EXIT.
 14497
 14498 7485-EXIT.
 14499     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 306
* EL689.cbl
 14501 7490-REMOVE-LAST-WORD.
 14502
 14503*********  NOTE: W-WORK-LINE ALWAYS STARTS WITH A FULL WORD*******
 14504     IF  W-WC-NDX EQUAL +1
 14505         GO TO 7490-EXIT.
 14506
 14507     ADD +1                      TO W-LAST-SQUEEZED-SPACE.
 14508
 14509     PERFORM 7500-CLEAR-SQUEEZED-EXCESS THRU 7500-EXIT
 14510             VARYING
 14511         W-SQ-NDX FROM W-LAST-SQUEEZED-SPACE BY +1
 14512             UNTIL
 14513         W-SQ-NDX EQUAL W-TOO-FAR.
 14514
 14515     SET W-WORK-NDX              TO W-WC-NDX.
 14516     COMPUTE W-LAST-WC-SPACE
 14517         = W-WORK-NDX - W-TOO-FAR + W-LAST-SQUEEZED-SPACE.
 14518     SET W-WC-NDX                TO W-LAST-WC-SPACE.
 14519
 14520 7490-EXIT.
 14521     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 307
* EL689.cbl
 14523 7500-CLEAR-SQUEEZED-EXCESS.
 14524
 14525     MOVE SPACES                 TO W-SQ-CHAR (W-SQ-NDX).
 14526
 14527 7500-EXIT.
 14528     EXIT.
 14529
 14530 7505-MOVE-STRAIGHT.
 14531
 14532     SET W-SQ-NDX UP BY +1.
 14533
 14534     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX).
 14535
 14536 7505-EXIT.
 14537     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 308
* EL689.cbl
 14539 7510-MOVE-TO-TABLE.
 14540
 14541     IF  W-PRINT-CONTROL NOT NUMERIC
 14542         MOVE 00                 TO W-PRINT-CONTROL
 14543         ADD +1                  TO W-LINE-COUNT
 14544     ELSE
 14545         IF  W-PRINT-CONTROL EQUAL 99
 14546             PERFORM 7640-PAGING THRU 7640-EXIT
 14547             MOVE 00             TO W-PRINT-CONTROL
 14548             SET W-RG-NDX UP BY +1
 14549             MOVE W-TOP-FORM     TO W-RC-TEXT (W-RG-NDX)
 14550             MOVE +1             TO W-LINE-COUNT
 14551             SET W-RG-NDX UP BY W-TOP-MARGIN
 14552         ELSE
 14553             COMPUTE W-LINE-COUNT
 14554                 = W-LINE-COUNT + W-PRINT-CONTROL + 1.
 14555
 14556     IF  W-LINE-COUNT GREATER THAN W-MAX-LINES-PER-PAGE
 14557         PERFORM 7640-PAGING THRU 7640-EXIT
 14558         MOVE 00                 TO W-PRINT-CONTROL
 14559         SET W-RG-NDX UP BY +1
 14560         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 14561         SET W-RG-NDX UP BY W-TOP-MARGIN
 14562         MOVE +1                 TO W-LINE-COUNT.
 14563
 14564     SET W-RG-NDX UP BY W-PRINT-CONTROL.
 14565     SET W-RG-NDX UP BY +1.
 14566     MOVE W-SQUEEZED-LINE        TO W-RC-TEXT (W-RG-NDX).
 14567     MOVE 00                     TO W-PRINT-CONTROL.
 14568
 14569     IF  W-FIRST-BAD-VARIABLE-FOUND
 14570             AND
 14571         W-FIRST-BAD-VARIABLE EQUAL ZEROS
 14572         SET W-FIRST-BAD-VARIABLE
 14573                                 TO W-RG-NDX.
 14574
 14575 7510-EXIT.
 14576     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 309
* EL689.cbl
 14578 7600-SET-PARA-INDENT.
 14579
 14580     IF  W-LINE-SQUEEZE-IND EQUAL 'P'
 14581         MOVE W-PARAGRAPH-INDENT TO W-WORK-INDENT
 14582     ELSE
 14583     IF  W-LINE-SQUEEZE-IND EQUAL 'Q'
 14584         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 14585         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14586     ELSE
 14587     IF  W-LINE-SQUEEZE-IND EQUAL 'R'
 14588         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 14589         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14590     ELSE
 14591     IF  W-LINE-SQUEEZE-IND EQUAL 'S'
 14592         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 14593         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14594     ELSE
 14595     IF  W-LINE-SQUEEZE-IND EQUAL 'T'
 14596         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 14597         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 14598     ELSE
 14599     IF  W-LINE-SQUEEZE-IND EQUAL 'U'
 14600         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT
 14601         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT.
 14602
 14603     SET W-TG-NDX2               TO W-TG-NDX.
 14604     SET W-TG-NDX2 UP BY +1.
 14605
 14606     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 14607         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 14608     ELSE
 14609         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 14610
 14611 7600-EXIT.
 14612     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 310
* EL689.cbl
 14614 7610-SET-CONP-INDENT.
 14615
 14616     IF  W-LINE-SQUEEZE-IND EQUAL 'C'
 14617         MOVE +0                 TO W-WORK-INDENT
 14618     ELSE
 14619     IF  W-LINE-SQUEEZE-IND EQUAL 'D'
 14620         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 14621     ELSE
 14622     IF  W-LINE-SQUEEZE-IND EQUAL 'E'
 14623         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 14624     ELSE
 14625     IF  W-LINE-SQUEEZE-IND EQUAL 'F'
 14626         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 14627     ELSE
 14628     IF  W-LINE-SQUEEZE-IND EQUAL 'G'
 14629         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 14630     ELSE
 14631     IF  W-LINE-SQUEEZE-IND EQUAL 'H'
 14632         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT.
 14633
 14634     SET W-TG-NDX2               TO W-TG-NDX.
 14635     SET W-TG-NDX2 UP BY +1.
 14636
 14637     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 14638         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 14639     ELSE
 14640         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 14641
 14642 7610-EXIT.
 14643     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 311
* EL689.cbl
 14645 7630-NEXT-LINE.
 14646
 14647     IF  W-TX-SC (W-TG-NDX2) EQUAL ' '
 14648         MOVE ZEROS              TO W-NEXT-INDENT
 14649     ELSE
 14650     IF  W-TX-SC (W-TG-NDX2) EQUAL '1'
 14651         MOVE W-LINE-INDENT-1    TO W-NEXT-INDENT
 14652     ELSE
 14653     IF  W-TX-SC (W-TG-NDX2) EQUAL '2'
 14654         MOVE W-LINE-INDENT-2    TO W-NEXT-INDENT
 14655     ELSE
 14656     IF  W-TX-SC (W-TG-NDX2) EQUAL '3'
 14657         MOVE W-LINE-INDENT-3    TO W-NEXT-INDENT
 14658     ELSE
 14659     IF  W-TX-SC (W-TG-NDX2) EQUAL '4'
 14660         MOVE W-LINE-INDENT-4    TO W-NEXT-INDENT
 14661     ELSE
 14662     IF  W-TX-SC (W-TG-NDX2) EQUAL '5'
 14663         MOVE W-LINE-INDENT-5    TO W-NEXT-INDENT
 14664     ELSE
 14665         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 14666         SUBTRACT W-PARAGRAPH-INDENT
 14667                                  FROM W-NEXT-INDENT.
 14668
 14669 7630-EXIT.
 14670     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 312
* EL689.cbl
 14672 7640-PAGING.
 14673
 14674     IF  NOT W-LC-CREATE-PAGES
 14675         GO TO 7640-EXIT.
 14676
 14677     IF  W-LINE-COUNT GREATER ZEROS
 14678             AND
 14679         W-RG-NDX GREATER THAN +1
 14680         ADD +1                  TO W-PAGE
 14681         MOVE W-PAGE             TO W-PAGE-NUMBER
 14682         COMPUTE W-PAGE-LINE
 14683             = W-MAX-LINES-PER-PAGE - W-LINE-COUNT + 3
 14684         IF  W-PAGE-LINE GREATER THAN +2
 14685             SET W-RG-NDX UP BY W-PAGE-LINE
 14686             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX)
 14687         ELSE
 14688             SET W-RG-NDX UP BY +2
 14689             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX).
 14690
 14691 7640-EXIT.
 14692     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 313
* EL689.cbl
 14694 7700-READ-TEXT-TS.
 14695**************************************************************
 14696*  THIS PARAGRAPH READS THE TEMPORARY STORAGE RECORDS THAT   *
 14697*  CONTAIN THE TEXT THAT IS PAST BETWEEN EL689, EL6892       *
 14698*  AND EL1042.                                               *
 14699**************************************************************
 14700
 14701
 14702* EXEC CICS HANDLE CONDITION
 14703*         QIDERR     (7700-TS-ERROR)
 14704*         ITEMERR    (7700-TS-ERROR)
 14705*    END-EXEC.
 14706*    MOVE '"$N<                  ! > #00013712' TO DFHEIV0
 14707     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 14708     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14709     MOVE X'3E20233030303133373132' TO DFHEIV0(25:11)
 14710     CALL 'kxdfhei1' USING DFHEIV0
 14711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14712
 14713
 14714     SET W-TS-NDX                TO 1.
 14715     MOVE 1                      TO W-TS-ITEM.
 14716
 14717 7700-LOOP.
 14718
 14719     IF  W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS
 14720         IF  PI-TEMP-STOR-ITEMS GREATER THAN ZEROS
 14721             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 14722             GO TO 7700-EXIT
 14723         ELSE
 14724             GO TO 7700-EXIT.
 14725
 14726
 14727* EXEC CICS READQ TS
 14728*         INTO     (W-TS-WORK-AREA)
 14729*         QUEUE    (W-TS-NAME-TEXT)
 14730*         LENGTH   (W-TS-LENGTH)
 14731*         ITEM     (W-TS-ITEM)
 14732*    END-EXEC.
 14733*    MOVE '*$II   L              ''   #00013729' TO DFHEIV0
 14734     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 14735     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14736     MOVE X'2020233030303133373239' TO DFHEIV0(25:11)
 14737     CALL 'kxdfhei1' USING DFHEIV0,
 14738           W-TS-NAME-TEXT,
 14739           W-TS-WORK-AREA,
 14740           W-TS-LENGTH,
 14741           W-TS-ITEM,
 14742           DFHEIV99,
 14743           DFHEIV99
 14744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14745
 14746
 14747     MOVE W-TS-WORK-AREA         TO W-TS-GROUP (W-TS-NDX).
 14748     SET W-TS-NDX UP BY 1.
 14749     ADD 1                       TO W-TS-ITEM.
 14750     GO TO 7700-LOOP.
 14751
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 314
* EL689.cbl
 14752 7700-TS-ERROR.
 14753
 14754     IF  EIBTRNID = W-TRANSACTION OR 'EX14'
 14755         MOVE ER-0033            TO EMI-ERROR
 14756         MOVE -1                 TO MAINTL
 14757         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14758         GO TO 8200-SEND-DATAONLY.
 14759
 14760 7700-EXIT.
 14761      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 315
* EL689.cbl
 14763 7740-RESTORE-SCREEN.
 14764
 14765     MOVE 'C'                    TO MAINTI.
 14766     MOVE +1                     TO MAINTL.
 14767     MOVE AL-UANON               TO MAINTA.
 14768
 14769     MOVE PI-689-FORM-NUMBER     TO FORMI.
 14770     MOVE +4                     TO FORML.
 14771     MOVE AL-UANON               TO FORMA.
 14772
 14773     IF  PI-689-PRINT-RESTRICTION GREATER THAN SPACES
 14774         MOVE PI-689-PRINT-RESTRICTION
 14775                                 TO PRTRESTL
 14776         MOVE +1                 TO PRTRESTL
 14777         MOVE AL-UANON           TO PRTRESTA.
 14778
 14779     IF  PI-689-FOLLOW-UP-EDIT GREATER THAN SPACES
 14780         MOVE PI-689-FOLLOW-UP-EDIT
 14781                                 TO FOLLOWI
 14782         MOVE +8                 TO FOLLOWL
 14783         MOVE AL-UANON           TO FOLLOWA.
 14784
 14785     IF  PI-689-RESEND1-EDIT GREATER THAN SPACES
 14786         MOVE PI-689-RESEND1-EDIT
 14787                                 TO RESEND1I
 14788         MOVE +8                 TO RESEND1L
 14789         MOVE AL-UANON           TO RESEND1A.
 14790     IF  PI-689-ALT-PRINTER-ID GREATER THAN SPACES
 14791         MOVE PI-689-ALT-PRINTER-ID
 14792                                 TO PRINTERI
 14793         MOVE +1                 TO PRINTERL
 14794         MOVE AL-UANON           TO PRINTERA.
 14795
 14796     IF  PI-BYPASS-LABELS
 14797          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 14798          MOVE +1                TO ADDRLBLL
 14799          MOVE AL-UANON          TO ADDRLBLA
 14800     ELSE
 14801          IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 14802               MOVE PI-689-LBL-OVERRIDE
 14803                                 TO ADDRLBLI
 14804               MOVE +1           TO ADDRLBLL
 14805               MOVE AL-UANON     TO ADDRLBLA.
 14806
 14807     IF  PI-689-NUMBER-COPIES GREATER THAN ZEROS
 14808         MOVE PI-689-NUMBER-COPIES   TO COPIESI
 14809         MOVE +1                     TO COPIESL
 14810         MOVE AL-UNNON               TO COPIESA.
 14811
 14812     IF  PI-689-LABEL-SOURCE GREATER THAN SPACES
 14813         MOVE PI-689-LABEL-SOURCE
 14814                                 TO ADDRSI
 14815         MOVE +1                 TO ADDRSL
 14816         MOVE AL-UANON           TO ADDRSA.
 14817
 14818     MOVE PI-689-DATA-SOURCE     TO DATASORI.
 14819     MOVE +1                     TO DATASORL.
 14820     MOVE AL-UANON               TO DATASORA.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 316
* EL689.cbl
 14821
 14822     IF  PI-689-CARRIER GREATER THAN SPACES
 14823         MOVE PI-689-CARRIER     TO CARRIERI
 14824         MOVE +1                 TO CARRIERL
 14825         MOVE AL-UANON           TO CARRIERA.
 14826
 14827     IF  PI-689-GROUPING GREATER THAN SPACES
 14828         MOVE PI-689-GROUPING    TO GROUPI
 14829         MOVE +6                 TO GROUPL
 14830         MOVE AL-UANON           TO GROUPA.
 14831
 14832     IF  PI-689-STATE GREATER THAN SPACES
 14833         MOVE PI-689-STATE       TO STATEI
 14834         MOVE +2                 TO STATEL
 14835         MOVE AL-UANON           TO STATEA.
 14836
 14837     IF  PI-689-ACCOUNT GREATER THAN SPACES
 14838         MOVE PI-689-ACCOUNT     TO ACCTI
 14839         MOVE +10                TO ACCTL
 14840         MOVE AL-UANON           TO ACCTA.
 14841
 14842     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 14843         MOVE PI-689-CERT-PRIME  TO CERTI
 14844         MOVE +10                TO CERTL
 14845         MOVE AL-UANON           TO CERTA.
 14846
 14847     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 14848         MOVE PI-689-CERT-SFX    TO SFXI
 14849         MOVE +1                 TO SFXL
 14850         MOVE AL-UANON           TO SFXA.
 14851
 14852     IF  PI-689-TYPE GREATER THAN SPACES
 14853         MOVE PI-689-TYPE        TO TYPEI
 14854         MOVE +1                 TO TYPEL
 14855         MOVE AL-UANON           TO TYPEA.
 14856
 14857     IF  PI-689-RESP-PERSON GREATER THAN SPACES
 14858         MOVE PI-689-RESP-PERSON TO RPERSONI
 14859         MOVE +10                TO RPERSONL
 14860         MOVE AL-UANON           TO RPERSONA.
 14861
 14862     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 14863         MOVE PI-689-ENTRY-BATCH TO BENTRYI
 14864         MOVE +6                 TO BENTRYL
 14865         MOVE AL-UANON           TO BENTRYA.
 14866
 14867     IF  PI-689-SEQ-EDIT GREATER THAN SPACES
 14868         MOVE PI-689-SEQ-EDIT    TO SEQI
 14869         MOVE +8                 TO SEQL
 14870         MOVE AL-UNNON           TO SEQA.
 14871
 14872     IF  PI-689-BCSEQ-EDIT GREATER THAN SPACES
 14873         MOVE PI-689-BCSEQ-EDIT  TO BCSEQI
 14874         MOVE +4                 TO BCSEQL
 14875         MOVE AL-UNNON           TO BCSEQA.
 14876
 14877     IF  PI-689-DATE-EDIT GREATER THAN SPACES
 14878         MOVE PI-689-DATE-EDIT   TO DATEI
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 317
* EL689.cbl
 14879         MOVE +8                 TO DATEL
 14880         MOVE AL-UNNON           TO DATEA.
 14881
 14882 7749-EXIT.
 14883     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 318
* EL689.cbl
 14885 7760-PUT-TEMP-STORAGE.
 14886**************************************************************
 14887*  THIS PARAGRAPH WRITES THE TEMPORARY STORAGE RECORDS THAT  *
 14888*  WILL CONTAIN THE CONTENTS OF THE TEXT TABLE FOR USE BY    *
 14889*  EL1042 AND EL6892.                                        *
 14890**************************************************************
 14891
 14892     SET W-TS-NDX                TO 1.
 14893     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 14894
 14895     MOVE -1                     TO MAINTL.
 14896     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 14897             VARYING
 14898         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 14899             UNTIL
 14900         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 14901
 14902 7760-EXIT.
 14903      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 319
* EL689.cbl
 14905 7780-DELETE-TEMP-STOR-TEXT.
 14906
 14907
 14908* EXEC CICS HANDLE CONDITION
 14909*         QIDERR      (7780-EXIT)
 14910*    END-EXEC.
 14911*    MOVE '"$N                   ! ? #00013896' TO DFHEIV0
 14912     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 14913     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14914     MOVE X'3F20233030303133383936' TO DFHEIV0(25:11)
 14915     CALL 'kxdfhei1' USING DFHEIV0
 14916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14917
 14918
 14919
 14920* EXEC CICS DELETEQ TS
 14921*         QUEUE       (W-TS-NAME-TEXT)
 14922*    END-EXEC.
 14923*    MOVE '*&                    #   #00013900' TO DFHEIV0
 14924     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 14925     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14926     MOVE X'2020233030303133393030' TO DFHEIV0(25:11)
 14927     CALL 'kxdfhei1' USING DFHEIV0,
 14928           W-TS-NAME-TEXT,
 14929           DFHEIV99
 14930     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14931
 14932
 14933 7780-EXIT.
 14934     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 320
* EL689.cbl
 14936 7840-WRITE-TS.
 14937
 14938     MOVE W-TS-GROUP (W-TS-NDX)  TO W-TS-WORK-AREA.
 14939     SET W-TS-NDX UP BY 1.
 14940     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 14941
 14942
 14943* EXEC CICS WRITEQ TS
 14944*         FROM    (W-TS-WORK-AREA)
 14945*         QUEUE   (W-TS-NAME-TEXT)
 14946*         LENGTH  (W-TS-LENGTH)
 14947*         ITEM    (PI-TEMP-STOR-ITEMS)
 14948*    END-EXEC.
 14949*    MOVE '*" I                  ''   #00013913' TO DFHEIV0
 14950     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 14951     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14952     MOVE X'2020233030303133393133' TO DFHEIV0(25:11)
 14953     CALL 'kxdfhei1' USING DFHEIV0,
 14954           W-TS-NAME-TEXT,
 14955           W-TS-WORK-AREA,
 14956           W-TS-LENGTH,
 14957           PI-TEMP-STOR-ITEMS,
 14958           DFHEIV99,
 14959           DFHEIV99
 14960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14961
 14962
 14963 7840-EXIT.
 14964     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 321
* EL689.cbl
 14966 7900-PRINT-LETTER-NOW.
 14967***************************************************************
 14968*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 14969*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 14970*     THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS.          *
 14971*     THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE.       *
 14972*     THE LETTER IS SAVED IN TEMP-STORAGE AND A START IS      *
 14973*     ISSUED FOR THE PRINT TRANSACTION.                       *
 14974***************************************************************
 14975
 14976     IF (EIBAID = DFHPF4 OR DFHPF8)
 14977             AND
 14978         PI-SHOW-MODE
 14979         IF  PRINTERL GREATER ZERO
 14980             INSPECT PRINTERI CONVERTING W-LOWER-CASE TO
 14981                                                     W-UPPER-CASE
 14982             MOVE PRINTERI       TO PI-689-ALT-PRINTER-ID
 14983                                    PI-ALT-DMD-PRT-ID.
 14984
 14985     IF  EIBAID EQUAL DFHPF8
 14986             AND
 14987         PI-SHOW-MODE
 14988             AND
 14989         LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
 14990         MOVE ER-7247            TO EMI-ERROR
 14991         MOVE -1                 TO MAINTL
 14992         MOVE AL-UABON           TO MAINTA
 14993         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14994         GO TO 8200-SEND-DATAONLY.
 14995
 14996     IF  PI-TOTAL-LINES EQUAL 0
 14997         MOVE ER-0187            TO EMI-ERROR
 14998         MOVE -1                 TO MAINTL
 14999         MOVE AL-UABON           TO MAINTA
 15000         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15001         GO TO 8200-SEND-DATAONLY.
 15002
 15003     IF  EMI-ERROR NOT EQUAL ER-0191
 15004         IF  PI-689-CREATE-NO-SCREENS
 15005                 OR
 15006             (EIBAID = DFHPF4 OR DFHPF8)
 15007             SET W-RG-NDX        TO +1
 15008         ELSE
 15009             PERFORM 4100-SET-NDX THRU 4100-EXIT
 15010             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 15011                     VARYING
 15012                 W-SC-NDX FROM 1 BY 1
 15013                     UNTIL
 15014                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 15015
 15016     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 15017
 15018     IF EIBAID NOT = DFHPF4 AND DFHPF8
 15019         PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 15020                 VARYING
 15021             W-RVS-NDX FROM +1 BY +1
 15022                 UNTIL
 15023             W-RVS-NDX GREATER THAN +36500
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 322
* EL689.cbl
 15024                 OR
 15025             W-REMAINING-VAR-FOUND
 15026         IF  W-REMAINING-VAR-FOUND
 15027             GO TO 4000-ROLL-PAGE.
 15028
 15029     IF EIBAID = DFHPF4 OR DFHPF8
 15030        PERFORM 7700-READ-TEXT-TS
 15031                                 THRU 7700-EXIT
 15032         PERFORM 4100-SET-NDX THRU 4100-EXIT
 15033         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 15034                 VARYING
 15035             W-SC-NDX FROM 1 BY 1
 15036                 UNTIL
 15037             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 15038        PERFORM 7760-PUT-TEMP-STORAGE
 15039                                 THRU 7760-EXIT
 15040     END-IF
 15041     IF PI-689-ALT-PRINTER-ID NOT = SPACES AND LOW-VALUES
 15042         MOVE PI-689-ALT-PRINTER-ID
 15043                                 TO W-TS-TERM-TEXT
 15044     ELSE
 15045         IF PI-PROCESSOR-PRINTER NOT = SPACES AND LOW-VALUES
 15046             MOVE PI-PROCESSOR-PRINTER
 15047                                 TO W-TS-TERM-TEXT
 15048         ELSE
 15049             MOVE PI-COMPANY-ID  TO W-CNTL-COMPANY-ID
 15050             MOVE '1'            TO W-CNTL-RECORD-TYPE
 15051             MOVE SPACES         TO W-CNTL-GENL
 15052             MOVE ZEROS          TO W-CNTL-SEQ-NO
 15053
 15054* EXEC CICS HANDLE CONDITION
 15055*                 NOTOPEN    (8040-CNTL-NOT-OPEN)
 15056*                 NOTFND     (7945-NOT-FOUND)
 15057*            END-EXEC
 15058*    MOVE '"$JI                  ! @ #00014010' TO DFHEIV0
 15059     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 15060     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15061     MOVE X'4020233030303134303130' TO DFHEIV0(25:11)
 15062     CALL 'kxdfhei1' USING DFHEIV0
 15063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15064
 15065* EXEC CICS READ
 15066*                 DATASET    (W-CNTL-FILE-ID)
 15067*                 SET        (ADDRESS OF CONTROL-FILE)
 15068*                 RIDFLD     (W-CNTL-KEY)
 15069*            END-EXEC
 15070*    MOVE '&"S        E          (   #00014014' TO DFHEIV0
 15071     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15072     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15073     MOVE X'2020233030303134303134' TO DFHEIV0(25:11)
 15074     CALL 'kxdfhei1' USING DFHEIV0,
 15075           W-CNTL-FILE-ID,
 15076           DFHEIV20,
 15077           DFHEIV99,
 15078           W-CNTL-KEY,
 15079           DFHEIV99,
 15080           DFHEIV99,
 15081           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 323
* EL689.cbl
 15082     SET ADDRESS OF CONTROL-FILE TO
 15083         DFHEIV20
 15084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15085             MOVE CF-FORMS-PRINTER-ID
 15086                                 TO W-TS-TERM-TEXT.
 15087
 15088***********************************************************
 15089*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 15090*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 15091***********************************************************
 15092
 15093     SET W-TS-NDX                TO 1.
 15094     MOVE EIBTIME                TO W-TS-ID-TIME.
 15095     MOVE W-TS-NAME-TEXT         TO PI-689-TEMP-STOR-ID.
 15096     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 15097
 15098     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 15099             VARYING
 15100         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 15101             UNTIL
 15102         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 15103
 15104     IF  EIBAID EQUAL DFHPF8
 15105         MOVE '1'                TO PI-689-PRINT-SW
 15106     ELSE
 15107         MOVE SPACES             TO PI-689-PRINT-SW.
 15108
 15109
 15110* EXEC CICS HANDLE CONDITION
 15111*         TERMIDERR  (7935-TERM-ERROR)
 15112*         TRANSIDERR (7940-TRAN-ERROR)
 15113*    END-EXEC.
 15114*    MOVE '"$[\                  ! A #00014043' TO DFHEIV0
 15115     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 15116     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15117     MOVE X'4120233030303134303433' TO DFHEIV0(25:11)
 15118     CALL 'kxdfhei1' USING DFHEIV0
 15119     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15120
 15121
 15122
 15123* EXEC CICS START
 15124*             INTERVAL    (0)
 15125*             TRANSID     (W-PRINT-TRANS)
 15126*             FROM        (PROGRAM-INTERFACE-BLOCK)
 15127*             LENGTH      (PI-COMM-LENGTH)
 15128*             TERMID      (W-TS-TERM-TEXT)
 15129*    END-EXEC.
 15130     MOVE 0 TO DFHEIV10
 15131*    MOVE '0(ILFT                0   #00014048' TO DFHEIV0
 15132     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 15133     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
 15134     MOVE X'2020233030303134303438' TO DFHEIV0(25:11)
 15135     CALL 'kxdfhei1' USING DFHEIV0,
 15136           DFHEIV10,
 15137           W-PRINT-TRANS,
 15138           DFHEIV99,
 15139           PROGRAM-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 324
* EL689.cbl
 15140           PI-COMM-LENGTH,
 15141           W-TS-TERM-TEXT,
 15142           DFHEIV99,
 15143           DFHEIV99,
 15144           DFHEIV99,
 15145           DFHEIV99,
 15146           DFHEIV99,
 15147           DFHEIV99,
 15148           DFHEIV99,
 15149           DFHEIV99,
 15150           DFHEIV99
 15151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15152
 15153
 15154
 15155* EXEC CICS SYNCPOINT
 15156*    END-EXEC.
 15157*    MOVE '6"                    !   #00014056' TO DFHEIV0
 15158     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
 15159     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15160     MOVE X'2020233030303134303536' TO DFHEIV0(25:11)
 15161     CALL 'kxdfhei1' USING DFHEIV0
 15162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15163
 15164
 15165     IF  PI-689-CREATE-NO-SCREENS
 15166         GO TO 7900-EXIT.
 15167
 15168     IF  EIBAID EQUAL DFHPF8
 15169             AND
 15170         PI-SHOW-MODE
 15171             AND
 15172         LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
 15173         PERFORM 7920-UPDATE-INITIAL-PRINT THRU 7920-EXIT.
 15174
 15175     MOVE ER-0189                TO EMI-ERROR.
 15176     MOVE -1                     TO MAINTL.
 15177
 15178     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 15179     MOVE -1                     TO MAINTL
 15180     MOVE AL-UABON               TO MAINTA
 15181     MOVE '104A'                 TO W-TS-ID-TEXT
 15182     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 15183                                    W-TS-TERM-SCREEN
 15184     GO TO 8200-SEND-DATAONLY.
 15185
 15186 7900-EXIT.
 15187     EXIT.
 15188
 15189 7915-SEARCH-REMAINING-VARS.
 15190
 15191     IF  W-REC-CHAR (W-RVS-NDX) EQUAL '@'
 15192         SET W-RVS-NDX2          TO W-RVS-NDX
 15193         SET W-RVS-NDX2 UP BY +1
 15194         IF  W-REC-CHAR (W-RVS-NDX2) EQUAL '@'
 15195             SET W-RVS-NDX2 UP BY +1
 15196             IF  W-REC-CHAR (W-RVS-NDX2) NUMERIC
 15197                 SET PI-CURRENT-LINE  TO W-RVS-NDX
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 325
* EL689.cbl
 15198                 COMPUTE PI-CURRENT-LINE
 15199                     = PI-CURRENT-LINE / 73
 15200                 MOVE 'Y'        TO W-REMAINING-VAR-SW
 15201                 MOVE +0         TO W-ROLL-COUNTER
 15202                 MOVE ER-0191    TO EMI-ERROR
 15203                 MOVE -1         TO MAINTL
 15204                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15205
 15206 7915-EXIT.
 15207     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 326
* EL689.cbl
 15209 7920-UPDATE-INITIAL-PRINT.
 15210
 15211
 15212* EXEC CICS HANDLE CONDITION
 15213*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 15214*         NOTFND     (1070-ARCH-NOT-FOUND)
 15215*         ENDFILE    (1070-ARCH-NOT-FOUND)
 15216*    END-EXEC.
 15217*    MOVE '"$JI''                 ! B #00014105' TO DFHEIV0
 15218     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 15219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15220     MOVE X'4220233030303134313035' TO DFHEIV0(25:11)
 15221     CALL 'kxdfhei1' USING DFHEIV0
 15222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15223
 15224     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
 15225     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 15226
 15227* EXEC CICS READ
 15228*        DATASET (W-ARCH-FILE-ID)
 15229*        SET     (ADDRESS OF LETTER-ARCHIVE)
 15230*        RIDFLD  (W-ARCH-PARTIAL-KEY)
 15231*        UPDATE
 15232*    END-EXEC.
 15233*    MOVE '&"S        EU         (   #00014112' TO DFHEIV0
 15234     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15235     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15236     MOVE X'2020233030303134313132' TO DFHEIV0(25:11)
 15237     CALL 'kxdfhei1' USING DFHEIV0,
 15238           W-ARCH-FILE-ID,
 15239           DFHEIV20,
 15240           DFHEIV99,
 15241           W-ARCH-PARTIAL-KEY,
 15242           DFHEIV99,
 15243           DFHEIV99,
 15244           DFHEIV99
 15245     SET ADDRESS OF LETTER-ARCHIVE TO
 15246         DFHEIV20
 15247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15248
 15249
 15250     MOVE W-SAVE-BIN-DATE        TO LA-INITIAL-PRINT-DATE.
 15251
 15252     IF  LA-RESEND-DATE = LOW-VALUES
 15253         MOVE 'C'                TO LA-STATUS.
 15254
 15255
 15256* EXEC CICS REWRITE
 15257*         FROM      (LETTER-ARCHIVE)
 15258*         DATASET   (W-ARCH-FILE-ID)
 15259*    END-EXEC.
 15260     MOVE LENGTH OF
 15261      LETTER-ARCHIVE
 15262       TO DFHEIV11
 15263*    MOVE '&& L                  %   #00014124' TO DFHEIV0
 15264     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15265     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15266     MOVE X'2020233030303134313234' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 327
* EL689.cbl
 15267     CALL 'kxdfhei1' USING DFHEIV0,
 15268           W-ARCH-FILE-ID,
 15269           LETTER-ARCHIVE,
 15270           DFHEIV11,
 15271           DFHEIV99
 15272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15273
 15274
 15275 7920-EXIT.
 15276     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 328
* EL689.cbl
 15278 7935-TERM-ERROR.
 15279
 15280     MOVE ER-0412                TO EMI-ERROR.
 15281     MOVE SPACES                 TO PI-689-PRINT-SW.
 15282     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15283     MOVE -1                     TO MAINTL.
 15284     GO TO 8200-SEND-DATAONLY.
 15285
 15286 7940-TRAN-ERROR.
 15287
 15288     MOVE ER-0413                TO EMI-ERROR.
 15289     MOVE SPACES                 TO PI-689-PRINT-SW.
 15290     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15291     MOVE -1                     TO MAINTL.
 15292     GO TO 8200-SEND-DATAONLY.
 15293
 15294 7945-NOT-FOUND.
 15295
 15296     MOVE ER-0190                TO EMI-ERROR.
 15297     MOVE -1                     TO MAINTL.
 15298     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15299     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 329
* EL689.cbl
 15301 8010-ARCH-NOT-OPEN.
 15302
 15303     MOVE ER-7388                TO EMI-ERROR.
 15304     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15305     MOVE -1                     TO MAINTL.
 15306     GO TO 8200-SEND-DATAONLY.
 15307
 15308 8015-ARCT-NOT-OPEN.
 15309
 15310     MOVE ER-7373                TO EMI-ERROR.
 15311     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15312     MOVE -1                     TO MAINTL.
 15313     GO TO 8200-SEND-DATAONLY.
 15314
 15315 8020-ACCT-NOT-OPEN.
 15316
 15317     MOVE ER-0168 TO EMI-ERROR
 15318     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15319     MOVE -1                     TO MAINTL.
 15320     GO TO 8200-SEND-DATAONLY.
 15321
 15322 8030-CERT-NOT-OPEN.
 15323
 15324     MOVE ER-0169 TO EMI-ERROR.
 15325     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15326     MOVE -1                     TO MAINTL.
 15327     GO TO 8200-SEND-DATAONLY.
 15328
 15329 8035-CERT-NOT-FOUND.
 15330
 15331     MOVE ER-2369 TO EMI-ERROR.
 15332     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15333     MOVE -1                     TO MAINTL.
 15334     GO TO 8200-SEND-DATAONLY.
 15335
 15336 8040-CNTL-NOT-OPEN.
 15337
 15338     MOVE ER-0042                TO EMI-ERROR.
 15339     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15340     MOVE -1                     TO MAINTL.
 15341     GO TO 8200-SEND-DATAONLY.
 15342
 15343 8045-CHEK-NOT-OPEN.
 15344
 15345     MOVE ER-3775                TO EMI-ERROR.
 15346     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15347     MOVE -1                     TO MAINTL.
 15348     GO TO 8200-SEND-DATAONLY.
 15349
 15350 8050-TEXT-NOT-OPEN.
 15351
 15352     MOVE ER-0013                TO EMI-ERROR.
 15353     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15354     MOVE -1                     TO MAINTL.
 15355     GO TO 8200-SEND-DATAONLY.
 15356
 15357 8060-PNDB-NOT-OPEN.
 15358
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 330
* EL689.cbl
 15359     MOVE ER-2216 TO EMI-ERROR.
 15360     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15361     MOVE -1                     TO MAINTL.
 15362     GO TO 8200-SEND-DATAONLY.
 15363
 15364 8070-PNDB-NOT-FOUND.
 15365
 15366     MOVE ER-7374 TO EMI-ERROR.
 15367     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15368     MOVE -1                     TO MAINTL.
 15369     GO TO 8200-SEND-DATAONLY.
 15370
 15371 8080-COMP-NOT-OPEN.
 15372
 15373     MOVE ER-2055 TO EMI-ERROR
 15374     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15375     MOVE -1                     TO MAINTL.
 15376     GO TO 8200-SEND-DATAONLY.
 15377
 15378 8085-PYAJ-NOT-OPEN.
 15379
 15380     MOVE ER-2232 TO EMI-ERROR
 15381     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15382     MOVE -1                     TO MAINTL.
 15383     GO TO 8200-SEND-DATAONLY.
 15384
 15385 8090-MAIL-NOT-OPEN.
 15386
 15387     MOVE ER-2999                TO EMI-ERROR.
 15388     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15389     MOVE -1                     TO MAINTL.
 15390     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 331
* EL689.cbl
 15392 8100-SEND-INITIAL-MAP.
 15393
 15394     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 15395     IF  PI-689-CREATE-NO-SCREENS
 15396         MOVE '9999'             TO PI-689-ERROR
 15397         GO TO 0620-RETURN-TO-CALLER.
 15398
 15399     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 15400
 15401     IF  NOT EMI-NO-ERRORS
 15402         MOVE EMI-MESSAGE-AREA (1)
 15403                                 TO ERRMSGO
 15404     ELSE
 15405         MOVE SPACES             TO ERRMSGO.
 15406     IF PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR 'CAGB'
 15407        OR 'DLVA' OR 'ECCA' OR 'KRHA'
 15408        MOVE AL-SADOF            TO PF8HDA
 15409     END-IF
 15410     IF NOT PI-CREATE-LABELS
 15411         MOVE AL-PANON           TO ADDRLBLA.
 15412
 15413
 15414* EXEC CICS SEND
 15415*        MAP    (W-MAP)
 15416*        MAPSET (W-MAPSET)
 15417*        FROM   (EL689AO)
 15418*        ERASE
 15419*        CURSOR
 15420*    END-EXEC.
 15421     MOVE LENGTH OF
 15422      EL689AO
 15423       TO DFHEIV12
 15424     MOVE -1
 15425       TO DFHEIV11
 15426*    MOVE '8$     CT  E    H L F ,   #00014267' TO DFHEIV0
 15427     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 15428     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15429     MOVE X'2020233030303134323637' TO DFHEIV0(25:11)
 15430     CALL 'kxdfhei1' USING DFHEIV0,
 15431           W-MAP,
 15432           EL689AO,
 15433           DFHEIV12,
 15434           W-MAPSET,
 15435           DFHEIV99,
 15436           DFHEIV99,
 15437           DFHEIV99,
 15438           DFHEIV11,
 15439           DFHEIV99,
 15440           DFHEIV99,
 15441           DFHEIV99
 15442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15443
 15444
 15445     GO TO 9000-RETURN-TRANS.
 15446
 15447 8100-EXIT.
 15448     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 332
* EL689.cbl
 15450 8200-SEND-DATAONLY.
 15451
 15452     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 15453     IF  PI-689-CREATE-NO-SCREENS
 15454         MOVE '9999'             TO PI-689-ERROR
 15455         GO TO 0620-RETURN-TO-CALLER.
 15456
 15457     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 15458
 15459     IF  NOT EMI-NO-ERRORS
 15460         MOVE EMI-MESSAGE-AREA (1)
 15461                                 TO ERRMSGO
 15462     ELSE
 15463         MOVE SPACES             TO ERRMSGO.
 15464
 15465
 15466* EXEC CICS SEND
 15467*        MAP    (W-MAP)
 15468*        MAPSET (W-MAPSET)
 15469*        FROM   (EL689AO)
 15470*        DATAONLY
 15471*        CURSOR
 15472*    END-EXEC.
 15473     MOVE LENGTH OF
 15474      EL689AO
 15475       TO DFHEIV12
 15476     MOVE -1
 15477       TO DFHEIV11
 15478*    MOVE '8$D    CT       H L F ,   #00014295' TO DFHEIV0
 15479     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 15480     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15481     MOVE X'2020233030303134323935' TO DFHEIV0(25:11)
 15482     CALL 'kxdfhei1' USING DFHEIV0,
 15483           W-MAP,
 15484           EL689AO,
 15485           DFHEIV12,
 15486           W-MAPSET,
 15487           DFHEIV99,
 15488           DFHEIV99,
 15489           DFHEIV99,
 15490           DFHEIV11,
 15491           DFHEIV99,
 15492           DFHEIV99,
 15493           DFHEIV99
 15494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15495
 15496
 15497     GO TO 9000-RETURN-TRANS.
 15498
 15499 8200-EXIT.
 15500     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 333
* EL689.cbl
 15502 8300-SEND-TEXT.
 15503
 15504     IF  PI-689-CREATE-NO-SCREENS
 15505         MOVE '9999'             TO PI-689-ERROR
 15506         GO TO 0620-RETURN-TO-CALLER.
 15507
 15508
 15509* EXEC CICS SEND TEXT
 15510*        FROM    (LOGOFF-TEXT)
 15511*        LENGTH  (LOGOFF-LENGTH)
 15512*        ERASE
 15513*        FREEKB
 15514*    END-EXEC.
 15515*    MOVE '8&      T  E F  H   F -   #00014314' TO DFHEIV0
 15516     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 15517     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 15518     MOVE X'2020233030303134333134' TO DFHEIV0(25:11)
 15519     CALL 'kxdfhei1' USING DFHEIV0,
 15520           LOGOFF-TEXT,
 15521           LOGOFF-LENGTH,
 15522           DFHEIV99,
 15523           DFHEIV99,
 15524           DFHEIV99,
 15525           DFHEIV99,
 15526           DFHEIV99,
 15527           DFHEIV99,
 15528           DFHEIV99,
 15529           DFHEIV99,
 15530           DFHEIV99,
 15531           DFHEIV99
 15532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15533
 15534
 15535     GO TO 9000-RETURN-TRANS.
 15536
 15537 8300-EXIT.
 15538     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 334
* EL689.cbl
 15540 8350-SEND-DATAONLY-ERASEAUP.
 15541
 15542     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 15543     PERFORM 7760-PUT-TEMP-STORAGE
 15544                                 THRU 7760-EXIT
 15545     IF  PI-689-CREATE-NO-SCREENS
 15546         MOVE '9999'             TO PI-689-ERROR
 15547         GO TO 0620-RETURN-TO-CALLER.
 15548
 15549     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 15550
 15551     IF  NOT EMI-NO-ERRORS
 15552         MOVE EMI-MESSAGE-AREA (1)
 15553                                 TO ERRMSGO
 15554     ELSE
 15555         MOVE SPACES             TO ERRMSGO.
 15556
 15557
 15558* EXEC CICS SEND
 15559*        MAP      (W-MAP)
 15560*        MAPSET   (W-MAPSET)
 15561*        FROM     (EL689AO)
 15562*        DATAONLY
 15563*        ERASEAUP
 15564*        CURSOR
 15565*    END-EXEC.
 15566     MOVE LENGTH OF
 15567      EL689AO
 15568       TO DFHEIV12
 15569     MOVE -1
 15570       TO DFHEIV11
 15571*    MOVE '8$D    CT  A    H L F ,   #00014343' TO DFHEIV0
 15572     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 15573     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 15574     MOVE X'2020233030303134333433' TO DFHEIV0(25:11)
 15575     CALL 'kxdfhei1' USING DFHEIV0,
 15576           W-MAP,
 15577           EL689AO,
 15578           DFHEIV12,
 15579           W-MAPSET,
 15580           DFHEIV99,
 15581           DFHEIV99,
 15582           DFHEIV99,
 15583           DFHEIV11,
 15584           DFHEIV99,
 15585           DFHEIV99,
 15586           DFHEIV99
 15587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15588
 15589
 15590     GO TO 9000-RETURN-TRANS.
 15591
 15592 8350-EXIT.
 15593     EXIT.
 15594
 15595 8600-DEEDIT.
 15596
 15597
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 335
* EL689.cbl
 15598* EXEC CICS BIF DEEDIT
 15599*         FIELD    (W-DEEDIT-FIELD)
 15600*         LENGTH   (15)
 15601*    END-EXEC.
 15602     MOVE 15
 15603       TO DFHEIV11
 15604*    MOVE '@"L                   #   #00014359' TO DFHEIV0
 15605     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 15606     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 15607     MOVE X'2020233030303134333539' TO DFHEIV0(25:11)
 15608     CALL 'kxdfhei1' USING DFHEIV0,
 15609           W-DEEDIT-FIELD,
 15610           DFHEIV11
 15611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15612
 15613
 15614 8600-EXIT.
 15615     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 336
* EL689.cbl
 15617 9000-RETURN-TRANS.
 15618
 15619     MOVE EMI-FATAL-CTR      TO PI-689-FATAL-CTR
 15620     MOVE EMI-FORCABLE-CTR   TO PI-689-FORCABLE-CTR
 15621     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 15622     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
 15623
 15624* EXEC CICS RETURN
 15625*        TRANSID    (W-TRANSACTION)
 15626*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 15627*        LENGTH     (PI-COMM-LENGTH)
 15628*    END-EXEC.
 15629*    MOVE '.(CT                  &   #00014373' TO DFHEIV0
 15630     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 15631     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15632     MOVE X'2020233030303134333733' TO DFHEIV0(25:11)
 15633     CALL 'kxdfhei1' USING DFHEIV0,
 15634           W-TRANSACTION,
 15635           PROGRAM-INTERFACE-BLOCK,
 15636           PI-COMM-LENGTH,
 15637           DFHEIV99,
 15638           DFHEIV99
 15639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15640
 15641*    MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 15642*    MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 15643*    GO TO 0200-RECEIVE.
 15644
 15645 9000-EXIT.
 15646     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 337
* EL689.cbl
 15648 9200-PA.
 15649
 15650     MOVE ER-0008                TO EMI-ERROR.
 15651     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15652     MOVE -1                     TO MAINTL.
 15653     GO TO 8200-SEND-DATAONLY.
 15654
 15655 9200-EXIT.
 15656     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 338
* EL689.cbl
 15658 9300-DFHCLEAR.
 15659
 15660     IF PI-RETURN-TO-PROGRAM = 'EL689' OR 'EL690'
 15661         MOVE '2'                TO PI-ACTION.
 15662
 15663     IF  PI-CLEAR-MODE
 15664         MOVE PI-RETURN-TO-PROGRAM
 15665                                 TO W-CALL-PGM
 15666         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 15667         GO TO 9400-XCTL
 15668     ELSE
 15669         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 15670         MOVE LOW-VALUES         TO EL689AO
 15671                                    PI-1042-WA
 15672                                    PI-689-WORK-AREA
 15673         MOVE ZEROS              TO PI-CURRENT-LINE
 15674                                    PI-TEMP-STOR-ITEMS
 15675                                    PI-TOTAL-LINES
 15676                                    PI-UPDATE-SW
 15677                                    PI-689-NUMBER-LABEL-LINES
 15678         MOVE SPACES             TO PI-689-PRINT-SW
 15679                                    PI-689-ALT-PRINTER-ID
 15680                                    PI-COMM-CONTROL
 15681                                    PI-689-FORM-NUMBER
 15682                                    PI-689-TEMP-STOR-ID
 15683                                    PI-689-LABEL-SOURCE
 15684                                    PI-689-USE-SCREEN-IND
 15685         MOVE '2'                TO PI-ACTION
 15686         MOVE -1                 TO MAINTL
 15687         GO TO 8100-SEND-INITIAL-MAP.
 15688
 15689 9300-EXIT.
 15690     EXIT.
 15691
 15692 9400-XCTL.
 15693
 15694
 15695* EXEC CICS XCTL
 15696*        PROGRAM  (W-CALL-PGM)
 15697*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 15698*        LENGTH   (PI-COMM-LENGTH)
 15699*    END-EXEC.
 15700*    MOVE '.$C                   $   #00014431' TO DFHEIV0
 15701     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 15702     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15703     MOVE X'2020233030303134343331' TO DFHEIV0(25:11)
 15704     CALL 'kxdfhei1' USING DFHEIV0,
 15705           W-CALL-PGM,
 15706           PROGRAM-INTERFACE-BLOCK,
 15707           PI-COMM-LENGTH
 15708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15709
 15710
 15711 9400-EXIT.
 15712     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 339
* EL689.cbl
 15714 9500-LINK-DATE-CONVERT.
 15715
 15716     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
 15717             AND
 15718         DC-OPTION-CODE EQUAL ' '
 15719         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
 15720         GO TO 9500-EXIT.
 15721
 15722
 15723* EXEC CICS LINK
 15724*        PROGRAM    ('ELDATCV')
 15725*        COMMAREA   (DATE-CONVERSION-DATA)
 15726*        LENGTH     (DC-COMM-LENGTH)
 15727*    END-EXEC.
 15728     MOVE 'ELDATCV' TO DFHEIV1
 15729*    MOVE '."C                   ''   #00014448' TO DFHEIV0
 15730     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15731     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15732     MOVE X'2020233030303134343438' TO DFHEIV0(25:11)
 15733     CALL 'kxdfhei1' USING DFHEIV0,
 15734           DFHEIV1,
 15735           DATE-CONVERSION-DATA,
 15736           DC-COMM-LENGTH,
 15737           DFHEIV99,
 15738           DFHEIV99,
 15739           DFHEIV99
 15740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15741
 15742
 15743     IF  NO-CONVERSION-ERROR
 15744             AND
 15745         PI-COMPANY-ID EQUAL 'AUK'
 15746             AND
 15747         W-REVERSE-DATE
 15748         MOVE DC-GREG-DATE-1-EDIT
 15749                                 TO W-EDIT-DATE-1
 15750         MOVE W-ED1-MM           TO W-ED2-MM
 15751         MOVE W-ED1-DD           TO W-ED2-DD
 15752         MOVE W-ED1-YY           TO W-ED2-YY
 15753         MOVE W-EDIT-DATE-2      TO DC-GREG-DATE-1-EDIT.
 15754
 15755 9500-EXIT.
 15756     EXIT.
 15757
 15758 9600-FORMAT-DATE-TIME.
 15759
 15760     MOVE W-SAVE-DATE            TO RUNDTEO.
 15761     MOVE EIBTIME                TO W-TIME-IN.
 15762     MOVE W-TIME-OUT             TO RUNTIMEO.
 15763     MOVE PI-COMPANY-ID          TO COMPANYO.
 15764     MOVE PI-PROCESSOR-ID        TO USERIDO.
 15765     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 15766
 15767 9600-EXIT.
 15768     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 340
* EL689.cbl
 15770 9700-PGMID-ERROR.
 15771
 15772     IF  PI-689-CREATE-NO-SCREENS
 15773         MOVE '9999'             TO PI-689-ERROR
 15774         GO TO 0620-RETURN-TO-CALLER.
 15775
 15776
 15777* EXEC CICS  HANDLE CONDITION
 15778*        PGMIDERR  (8300-SEND-TEXT)
 15779*    END-EXEC.
 15780*    MOVE '"$L                   ! C #00014487' TO DFHEIV0
 15781     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 15782     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15783     MOVE X'4320233030303134343837' TO DFHEIV0(25:11)
 15784     CALL 'kxdfhei1' USING DFHEIV0
 15785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15786
 15787
 15788     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
 15789     MOVE ' '                    TO PI-ENTRY-CD-1.
 15790     MOVE W-XCTL-005             TO W-CALL-PGM
 15791                                    LOGOFF-PGM.
 15792     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 15793
 15794     PERFORM 9400-XCTL THRU 9400-EXIT.
 15795
 15796 9700-EXIT.
 15797     EXIT.
 15798
 15799 9800-ABEND.
 15800
 15801     IF  PI-689-CREATE-NO-SCREENS
 15802         MOVE '9999'             TO PI-689-ERROR
 15803         GO TO 0620-RETURN-TO-CALLER.
 15804
 15805     MOVE W-LINK-004             TO W-CALL-PGM.
 15806     MOVE DFHEIBLK               TO EMI-LINE1
 15807
 15808
 15809* EXEC CICS  LINK
 15810*        PROGRAM   (W-CALL-PGM)
 15811*        COMMAREA  (EMI-LINE1)
 15812*        LENGTH    (72)
 15813*    END-EXEC.
 15814     MOVE 72
 15815       TO DFHEIV11
 15816*    MOVE '."C                   ''   #00014511' TO DFHEIV0
 15817     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15818     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15819     MOVE X'2020233030303134353131' TO DFHEIV0(25:11)
 15820     CALL 'kxdfhei1' USING DFHEIV0,
 15821           W-CALL-PGM,
 15822           EMI-LINE1,
 15823           DFHEIV11,
 15824           DFHEIV99,
 15825           DFHEIV99,
 15826           DFHEIV99
 15827     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 341
* EL689.cbl
 15828
 15829
 15830     GO TO 8200-SEND-DATAONLY.
 15831
 15832 9800-EXIT.
 15833     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 342
* EL689.cbl
 15835 9900-ERROR-FORMAT.
 15836
 15837     IF  PI-689-CREATE-NO-SCREENS
 15838         MOVE EMI-ERROR          TO PI-689-ERROR
 15839         IF  PI-689-FATAL-ERROR
 15840             GO TO 0620-RETURN-TO-CALLER
 15841         ELSE
 15842             GO TO 9900-EXIT.
 15843
 15844     IF  EMI-ERROR EQUAL ER-9097
 15845         NEXT SENTENCE
 15846     ELSE
 15847         IF  EMI-ERRORS-COMPLETE
 15848                 OR
 15849             EMI-ERROR EQUAL W-LAST-ERROR
 15850             GO TO 9900-EXIT.
 15851
 15852     MOVE W-LINK-001             TO W-CALL-PGM.
 15853
 15854
 15855* EXEC CICS LINK
 15856*        PROGRAM    (W-CALL-PGM)
 15857*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 15858*        LENGTH     (EMI-COMM-LENGTH)
 15859*    END-EXEC.
 15860*    MOVE '."C                   ''   #00014541' TO DFHEIV0
 15861     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15862     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15863     MOVE X'2020233030303134353431' TO DFHEIV0(25:11)
 15864     CALL 'kxdfhei1' USING DFHEIV0,
 15865           W-CALL-PGM,
 15866           ERROR-MESSAGE-INTERFACE-BLOCK,
 15867           EMI-COMM-LENGTH,
 15868           DFHEIV99,
 15869           DFHEIV99,
 15870           DFHEIV99
 15871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15872
 15873
 15874     IF  EMI-SEVERITY (2) EQUAL 'X'
 15875             AND
 15876         EMI-SEVERITY (1) NOT EQUAL 'X'
 15877         MOVE EMI-MESSAGE-AREA (2)
 15878                                 TO EMI-MESSAGE-AREA (1).
 15879
 15880     MOVE EMI-ERROR              TO W-LAST-ERROR.
 15881
 15882 9900-EXIT.
 15883     EXIT.
 15884
 15885 9905-INITIALIZE-SECURITY.
 15886******************************************************************
 15887*                                                                *
 15888*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
 15889*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
 15890*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
 15891*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
 15892*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 343
* EL689.cbl
 15893*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
 15894*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
 15895*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
 15896*                                                                *
 15897*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
 15898*       IS ALSO PROVIDED BY THIS LOGIC.                          *
 15899*                                                                *
 15900******************************************************************
 15901
 15902     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
 15903         MOVE 'Y'                TO PI-DISPLAY-CAP
 15904                                    PI-MODIFY-CAP
 15905     ELSE
 15906
 15907* EXEC CICS READQ TS
 15908*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
 15909*            INTO   (SECURITY-CONTROL)
 15910*            LENGTH (SC-COMM-LENGTH)
 15911*            ITEM   (1)
 15912*        END-EXEC
 15913     MOVE 1
 15914       TO DFHEIV11
 15915*    MOVE '*$II   L              ''   #00014579' TO DFHEIV0
 15916     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 15917     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15918     MOVE X'2020233030303134353739' TO DFHEIV0(25:11)
 15919     CALL 'kxdfhei1' USING DFHEIV0,
 15920           PI-SECURITY-TEMP-STORE-ID,
 15921           SECURITY-CONTROL,
 15922           SC-COMM-LENGTH,
 15923           DFHEIV11,
 15924           DFHEIV99,
 15925           DFHEIV99
 15926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15927         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
 15928                                 TO PI-DISPLAY-CAP
 15929         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
 15930                                 TO PI-MODIFY-CAP.
 15931
 15932 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 344
* EL689.cbl
 15934 9995-SECURITY-VIOLATION.
 15935
 15936     MOVE EIBDATE                TO SM-JUL-DATE.
 15937     MOVE EIBTRMID               TO SM-TERMID.
 15938     MOVE W-THIS-PGM             TO SM-PGM.
 15939     MOVE EIBTIME                TO W-TIME-IN.
 15940     MOVE W-TIME-OUT             TO SM-TIME.
 15941     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
 15942
 15943
 15944* EXEC CICS LINK
 15945*         PROGRAM  ('EL003')
 15946*         COMMAREA (SECURITY-MESSAGE)
 15947*         LENGTH   (80)
 15948*    END-EXEC.
 15949     MOVE 'EL003' TO DFHEIV1
 15950     MOVE 80
 15951       TO DFHEIV11
 15952*    MOVE '."C                   ''   #00014601' TO DFHEIV0
 15953     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 15954     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15955     MOVE X'2020233030303134363031' TO DFHEIV0(25:11)
 15956     CALL 'kxdfhei1' USING DFHEIV0,
 15957           DFHEIV1,
 15958           SECURITY-MESSAGE,
 15959           DFHEIV11,
 15960           DFHEIV99,
 15961           DFHEIV99,
 15962           DFHEIV99
 15963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15964
 15965
 15966 9995-EXIT.
 15967     EXIT.
 15968
 15969 9999-GOBACK.
 15970
 15971
 15972* GOBACK.
 15973     MOVE '9%                    "   ' TO DFHEIV0
 15974     MOVE 'EL689' TO DFHEIV1
 15975     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15976     GOBACK.
 15977
 15978 9999-EXIT.
 15979     EXIT.
 15980
 15981 9999-DFHBACK SECTION.
 15982     MOVE '9%                    "   ' TO DFHEIV0
 15983     MOVE 'EL689' TO DFHEIV1
 15984     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 15985     GOBACK.
 15986 9999-DFHEXIT.
 15987     IF DFHEIGDJ EQUAL 0001
 15988         NEXT SENTENCE
 15989     ELSE IF DFHEIGDJ EQUAL 2
 15990         GO TO 9300-DFHCLEAR,
 15991               9200-PA,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 345
* EL689.cbl
 15992               9200-PA,
 15993               9200-PA
 15994         DEPENDING ON DFHEIGDI
 15995     ELSE IF DFHEIGDJ EQUAL 3
 15996         GO TO 9700-PGMID-ERROR,
 15997               9800-ABEND,
 15998               0325-MAPFAIL
 15999         DEPENDING ON DFHEIGDI
 16000     ELSE IF DFHEIGDJ EQUAL 4
 16001         GO TO 8040-CNTL-NOT-OPEN,
 16002               7945-NOT-FOUND
 16003         DEPENDING ON DFHEIGDI
 16004     ELSE IF DFHEIGDJ EQUAL 5
 16005         GO TO 9700-PGMID-ERROR,
 16006               0325-MAPFAIL,
 16007               9800-ABEND
 16008         DEPENDING ON DFHEIGDI
 16009     ELSE IF DFHEIGDJ EQUAL 6
 16010         GO TO 0990-CARRIER-NOT-FOUND,
 16011               8040-CNTL-NOT-OPEN
 16012         DEPENDING ON DFHEIGDI
 16013     ELSE IF DFHEIGDJ EQUAL 7
 16014         GO TO 0994-STATE-NOT-FOUND,
 16015               8040-CNTL-NOT-OPEN
 16016         DEPENDING ON DFHEIGDI
 16017     ELSE IF DFHEIGDJ EQUAL 8
 16018         GO TO 8010-ARCH-NOT-OPEN,
 16019               1070-ARCH-NOT-FOUND,
 16020               1070-ARCH-NOT-FOUND
 16021         DEPENDING ON DFHEIGDI
 16022     ELSE IF DFHEIGDJ EQUAL 9
 16023         GO TO 8015-ARCT-NOT-OPEN,
 16024               1020-ARCT-ENDBR,
 16025               1020-ARCT-ENDBR
 16026         DEPENDING ON DFHEIGDI
 16027     ELSE IF DFHEIGDJ EQUAL 10
 16028         GO TO 2001-NOT-FOUND,
 16029               2001-NOT-FOUND,
 16030               8050-TEXT-NOT-OPEN
 16031         DEPENDING ON DFHEIGDI
 16032     ELSE IF DFHEIGDJ EQUAL 11
 16033         GO TO 2000-ENDBR
 16034         DEPENDING ON DFHEIGDI
 16035     ELSE IF DFHEIGDJ EQUAL 12
 16036         GO TO 8040-CNTL-NOT-OPEN,
 16037               5470-CNTL-NOT-FOUND
 16038         DEPENDING ON DFHEIGDI
 16039     ELSE IF DFHEIGDJ EQUAL 13
 16040         GO TO 8010-ARCH-NOT-OPEN
 16041         DEPENDING ON DFHEIGDI
 16042     ELSE IF DFHEIGDJ EQUAL 14
 16043         GO TO 5460-DUPLICATE-ARCHIVE-RCD
 16044         DEPENDING ON DFHEIGDI
 16045     ELSE IF DFHEIGDJ EQUAL 15
 16046         GO TO 8015-ARCT-NOT-OPEN,
 16047               5465-DUPLICATE-ARCH-TEXT
 16048         DEPENDING ON DFHEIGDI
 16049     ELSE IF DFHEIGDJ EQUAL 16
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 346
* EL689.cbl
 16050         GO TO 8040-CNTL-NOT-OPEN,
 16051               6200-CNTL1-NOT-FOUND
 16052         DEPENDING ON DFHEIGDI
 16053     ELSE IF DFHEIGDJ EQUAL 17
 16054         GO TO 8040-CNTL-NOT-OPEN,
 16055               6250-CNTL2-NOT-FOUND
 16056         DEPENDING ON DFHEIGDI
 16057     ELSE IF DFHEIGDJ EQUAL 18
 16058         GO TO 8040-CNTL-NOT-OPEN,
 16059               6300-CNTL6-NOT-FOUND
 16060         DEPENDING ON DFHEIGDI
 16061     ELSE IF DFHEIGDJ EQUAL 19
 16062         GO TO 8040-CNTL-NOT-OPEN,
 16063               6350-CNTL2-NOT-FOUND
 16064         DEPENDING ON DFHEIGDI
 16065     ELSE IF DFHEIGDJ EQUAL 20
 16066         GO TO 8060-PNDB-NOT-OPEN,
 16067               8070-PNDB-NOT-FOUND
 16068         DEPENDING ON DFHEIGDI
 16069     ELSE IF DFHEIGDJ EQUAL 21
 16070         GO TO 8030-CERT-NOT-OPEN,
 16071               8035-CERT-NOT-FOUND
 16072         DEPENDING ON DFHEIGDI
 16073     ELSE IF DFHEIGDJ EQUAL 22
 16074         GO TO 8020-ACCT-NOT-OPEN,
 16075               6500-ACCT-NOT-FOUND,
 16076               6500-ONLY-STOP
 16077         DEPENDING ON DFHEIGDI
 16078     ELSE IF DFHEIGDJ EQUAL 23
 16079         GO TO 8080-COMP-NOT-OPEN,
 16080               6600-COMP-NOT-FOUND
 16081         DEPENDING ON DFHEIGDI
 16082     ELSE IF DFHEIGDJ EQUAL 24
 16083         GO TO 8040-CNTL-NOT-OPEN,
 16084               6630-CNTL2-NOT-FOUND
 16085         DEPENDING ON DFHEIGDI
 16086     ELSE IF DFHEIGDJ EQUAL 25
 16087         GO TO 8090-MAIL-NOT-OPEN,
 16088               6700-MAIL-NOT-FOUND
 16089         DEPENDING ON DFHEIGDI
 16090     ELSE IF DFHEIGDJ EQUAL 26
 16091         GO TO 8040-CNTL-NOT-OPEN,
 16092               6750-EXIT
 16093         DEPENDING ON DFHEIGDI
 16094     ELSE IF DFHEIGDJ EQUAL 27
 16095         GO TO 8040-CNTL-NOT-OPEN,
 16096               6800-EXIT
 16097         DEPENDING ON DFHEIGDI
 16098     ELSE IF DFHEIGDJ EQUAL 28
 16099         GO TO 8045-CHEK-NOT-OPEN,
 16100               6850-CHEK-NOT-FOUND
 16101         DEPENDING ON DFHEIGDI
 16102     ELSE IF DFHEIGDJ EQUAL 29
 16103         GO TO 8085-PYAJ-NOT-OPEN,
 16104               6900-PYAJ-NOT-FOUND
 16105         DEPENDING ON DFHEIGDI
 16106     ELSE IF DFHEIGDJ EQUAL 30
 16107         GO TO 7700-TS-ERROR,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-11 13:02 Page 347
* EL689.cbl
 16108               7700-TS-ERROR
 16109         DEPENDING ON DFHEIGDI
 16110     ELSE IF DFHEIGDJ EQUAL 31
 16111         GO TO 7780-EXIT
 16112         DEPENDING ON DFHEIGDI
 16113     ELSE IF DFHEIGDJ EQUAL 32
 16114         GO TO 8040-CNTL-NOT-OPEN,
 16115               7945-NOT-FOUND
 16116         DEPENDING ON DFHEIGDI
 16117     ELSE IF DFHEIGDJ EQUAL 33
 16118         GO TO 7935-TERM-ERROR,
 16119               7940-TRAN-ERROR
 16120         DEPENDING ON DFHEIGDI
 16121     ELSE IF DFHEIGDJ EQUAL 34
 16122         GO TO 8010-ARCH-NOT-OPEN,
 16123               1070-ARCH-NOT-FOUND,
 16124               1070-ARCH-NOT-FOUND
 16125         DEPENDING ON DFHEIGDI
 16126     ELSE IF DFHEIGDJ EQUAL 35
 16127         GO TO 8300-SEND-TEXT
 16128         DEPENDING ON DFHEIGDI.
 16129     MOVE '9%                    "   ' TO DFHEIV0
 16130     MOVE 'EL689' TO DFHEIV1
 16131     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16132     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) 1984-2009 Micro Focus (IP) Limited.      URN RXCTI/AA0/00000Q
*                                                        REF GNR-015065002AD
* Total Messages:     0
* Data:       91956     Code:       60532
