* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62******************************************************************
    63
    64 ENVIRONMENT DIVISION.
    65
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page   3
* EL6311.cbl
    67 DATA DIVISION.
    68 WORKING-STORAGE SECTION.
    69 01  DFH-START PIC X(04).
    70 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    71 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    72 77  FILLER  PIC X(32)  VALUE '********************************'.
    73 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    74 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    75 77  A1                          PIC S999 COMP-3 VALUE +0.
    76 77  N1                          PIC S999 COMP-3 VALUE +0.
    77 77  N2                          PIC S999 COMP-3 VALUE +0.
    78 77  N3                          PIC S999 COMP-3 VALUE +0.
    79 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    80 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
    81 77  WS-REVERSE-SW               PIC X VALUE 'N'.
    82     88  REVERSAL                    VALUE 'Y'.
    83 77  WS-NOTE-SW                  PIC X  VALUE ' '.
    84 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
    85 77  WS-END                      PIC S999 COMP-3 VALUE +0.
    86 77  WS-TALLY                    PIC 99  VALUE ZEROS.
    87 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
    88     88  ERMAIL-FOUND                 VALUE 'Y'.
    89 77  A2                          PIC S9(5) COMP-3 VALUE +0.
    90 77  M1                          PIC S9(5) COMP-3 VALUE +0.
    91 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    92
    93*    COPY ELCSCTM.
    94******************************************************************
    95*                                                                *
    96*                                                                *
    97*                            ELCSCTM                             *
    98*                            VMOD=2.001                          *
    99*                                                                *
   100*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   101*                                                                *
   102******************************************************************
   103 01  SECURITY-MESSAGE.
   104     12  FILLER                          PIC X(30)
   105            VALUE '** LOGIC SECURITY VIOLATION -'.
   106     12  SM-READ                         PIC X(6).
   107     12  FILLER                          PIC X(5)
   108            VALUE ' PGM='.
   109     12  SM-PGM                          PIC X(6).
   110     12  FILLER                          PIC X(5)
   111            VALUE ' OPR='.
   112     12  SM-PROCESSOR-ID                 PIC X(4).
   113     12  FILLER                          PIC X(6)
   114            VALUE ' TERM='.
   115     12  SM-TERMID                       PIC X(4).
   116     12  FILLER                          PIC XX   VALUE SPACE.
   117     12  SM-JUL-DATE                     PIC 9(5).
   118     12  FILLER                          PIC X    VALUE SPACE.
   119     12  SM-TIME                         PIC 99.99.
   120
   121
   122*    COPY ELCSCRTY.
   123******************************************************************
   124*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page   4
* EL6311.cbl
   125*                                                                *
   126*                            ELCSCRTY                            *
   127*                            VMOD=2.001                          *
   128*                                                                *
   129*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   130*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   131*        SAVED IN PI-SECURITY-ADDRESS.                           *
   132*                                                                *
   133******************************************************************
   134 01  SECURITY-CONTROL.
   135     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   136     12  FILLER                       PIC XX    VALUE 'SC'.
   137     12  SC-CREDIT-CODES.
   138         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   139             20  SC-CREDIT-DISPLAY    PIC X.
   140             20  SC-CREDIT-UPDATE     PIC X.
   141     12  SC-CLAIMS-CODES.
   142         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   143             20  SC-CLAIMS-DISPLAY    PIC X.
   144             20  SC-CLAIMS-UPDATE     PIC X.
   145
   146 01  WS-VA-NO-COMM-MESS.
   147     12  FILLER                  PIC X(41) VALUE
   148        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   149 01  WS-OC-MESSAGE.
   150     12  FILLER                  PIC X(43) VALUE
   151        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   152     12  WS-OC-DIS-AMT           PIC -----9.99.
   153     12  FILLER                  PIC X(4) VALUE ' ON '.
   154     12  WS-OC-DATE              PIC X(10).
   155 01  WS-DATE-AREA.
   156     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   157     12  WS-CURRENT-DT.
   158         16  FILLER              PIC X(6)    VALUE SPACES.
   159         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   160     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   161     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   162     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   163
   164 01  STANDARD-AREAS.
   165     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   166     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   167     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   168     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   169     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   170     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   171     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   172     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   173     12  PGM-NAME                PIC X(8).
   174     12  TIME-IN                 PIC S9(7).
   175     12  TIME-OUT-R  REDEFINES TIME-IN.
   176         16  FILLER              PIC X.
   177         16  TIME-OUT            PIC 99V99.
   178         16  FILLER              PIC XX.
   179     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   180     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   181     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   182     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page   5
* EL6311.cbl
   183     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   184     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   185     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   186     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   187     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   188     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   189     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   190     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   191     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   192     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   193     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   194     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   195     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   196     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   197     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   198     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   199     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   200     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   201     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   202     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   203     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   204     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   205     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   206     12  FILE-ID                 PIC X(8).
   207     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   208     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   209     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   210     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   211     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   212     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   213     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
   214     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   215     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   216     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   217     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   218     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   219     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   220     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   221
   222 01  WS-PASS-AREA.
   223     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   224     05  WS-PASS-VADS-REC    PIC X(350).
   225*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   226*                                COPY ELCZREC.
   227******************************************************************
   228*                                                                *
   229*                                                                *
   230*                            ELCZREC.                            *
   231*                                                                *
   232*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   233*                                                                *
   234******************************************************************
   235*-----------------------------------------------------------------
   236*                   C H A N G E   L O G
   237*
   238* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   239*-----------------------------------------------------------------
   240*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page   6
* EL6311.cbl
   241* EFFECTIVE    NUMBER
   242*-----------------------------------------------------------------
   243* 122011    2011022800001  AJRA  NEW FILE
   244* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   245*-----------------------------------------------------------------
   246 01  W-Z-CONTROL-DATA.
   247     05  W-NUMBER-OF-COPIES      PIC  9.
   248     05  FILLER                  PIC  X.
   249     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   250     05  FILLER                  PIC  X.
   251     05  W-DAYS-TO-RESEND        PIC  999.
   252     05  FILLER                  PIC  X.
   253     05  W-FORM-TO-RESEND        PIC  X(4).
   254     05  FILLER                  PIC  X.
   255     05  W-PROMPT-LETTER         PIC  X.
   256     05  FILLER                  PIC  X.
   257     05  W-ENCLOSURE-CD          PIC  XXX.
   258     05  FILLER                  PIC  X.
   259     05  W-AUTO-CLOSE-IND        PIC  X.
   260     05  FILLER                  PIC  X.
   261     05  W-LETTER-TO-BENE        PIC  X.
   262     05  FILLER                  PIC  X.
   263     05  W-LETTER-TO-ACCT        PIC  X.
   264     05  FILLER                  PIC  X.
   265     05  W-LETTER-TYPE           PIC  X.
   266     05  FILLER                  PIC  X.
   267     05  W-PRINT-CERTIFICATE     PIC  X.
   268     05  FILLER                  PIC  X.
   269     05  W-REFUND-REQUIRED       PIC  X.
   270     05  FILLER                  PIC  X.
   271     05  W-ONBASE-CODE           PIC  XX.
   272     05  FILLER                  PIC  X.
   273     05  W-ACCT-SUMM             PIC  X.
   274     05  FILLER                  PIC  X.
   275     05  W-CSO-SUMM              PIC  X.
   276     05  FILLER                  PIC  X(31).
   277******************************************************************
   278*                                                                *
   279*              A C C E S S   K E Y S                             *
   280*                                                                *
   281******************************************************************
   282
   283 01  ACCESS-KEYS.
   284     12  ERPYAJ-KEY.
   285         16  ERPYAJ-COMPANY-CD       PIC X.
   286         16  ERPYAJ-CARRIER          PIC X.
   287         16  ERPYAJ-GROUPING         PIC X(6).
   288         16  ERPYAJ-FIN-RESP         PIC X(10).
   289         16  ERPYAJ-ACCOUNT          PIC X(10).
   290         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   291         16  ERPYAJ-TYPE             PIC X.
   292     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   293     12  ELCERT-KEY.
   294         16  ELCERT-COMPANY-CD       PIC X.
   295         16  ELCERT-CARRIER          PIC X.
   296         16  ELCERT-GROUPING         PIC X(6).
   297         16  ELCERT-STATE            PIC XX.
   298         16  ELCERT-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page   7
* EL6311.cbl
   299         16  ELCERT-CERT-EFF-DT      PIC XX.
   300         16  ELCERT-CERT-NO.
   301             20  ELCERT-CERT-PRIME   PIC X(10).
   302             20  ELCERT-CERT-SFX     PIC X.
   303
   304     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   305     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   306     12  ELCRTO-KEY.
   307         16  ELCRTO-COMPANY-CD       PIC X.
   308         16  ELCRTO-CARRIER          PIC X.
   309         16  ELCRTO-GROUPING         PIC X(6).
   310         16  ELCRTO-STATE            PIC XX.
   311         16  ELCRTO-ACCOUNT          PIC X(10).
   312         16  ELCRTO-CERT-EFF-DT      PIC XX.
   313         16  ELCRTO-CERT-NO.
   314             20  ELCRTO-CERT-PRIME   PIC X(10).
   315             20  ELCRTO-CERT-SFX     PIC X.
   316         16  ELCRTO-RECORD-TYPE      PIC X.
   317         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   318     12  ERPNDB-KEY.
   319         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   320         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   321         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   322         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   323             ERPNDB-BATCH-SEQ-NO     PIC XX.
   324         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   325
   326     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   327     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   328     12  ELLETR-KEY.
   329         16  LETR-COMPANY-CD     PIC X.
   330         16  LETR-LETTER-ID      PIC X(4).
   331         16  LETR-FILLER         PIC X(8).
   332         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   333     12  ERPNDM-KEY.
   334         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   335         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   336         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   337         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   338
   339*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   340     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   341*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   342     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   343
   344     12  ERPNDB-ALT-KEY.
   345         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   346         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   347         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   348         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   349         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   350         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   351         16  ERPNDB-CERT-NO.
   352             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   353             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   354         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   355         16  ERPNDB-RECORD-TYPE      PIC X.
   356
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page   8
* EL6311.cbl
   357      12  ERPNDB-CSR-KEY.
   358          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   359          20  ERPNDB-CSR-ID                PIC X(4).
   360          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   361          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   362          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   363
   364     12  ERNOTE-KEY.
   365         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   366         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   367         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   368         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   369         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   370         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   371         16  ERNOTE-CERT-NO.
   372             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   373             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   374
   375     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   376     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   377
   378     12  ERCNOT-KEY.
   379         16  ERCNOT-PART-KEY.
   380             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   381             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   382             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   383             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   384             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   385             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   386             20  ERCNOT-CERT-NO.
   387                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   388                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   389         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   390         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   391
   392     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   393     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   394
   395     12  ERMAIL-KEY.
   396         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   397         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   398         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   399         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   400         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   401         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   402         16  ERMAIL-CERT-NO.
   403             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   404             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   405
   406     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   407     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   408
   409     12  ERRQST-KEY.
   410         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   411         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   412
   413     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   414     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page   9
* EL6311.cbl
   415
   416     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   417
   418     12  ERLOFC-KEY.
   419         16  ERLOFC-COMPANY-CD          PIC  X.
   420         16  ERLOFC-CARRIER             PIC  X.
   421         16  ERLOFC-GROUPING            PIC  X(6).
   422         16  ERLOFC-STATE               PIC  XX.
   423         16  ERLOFC-ACCOUNT             PIC  X(10).
   424         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   425*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   426
   427     12  ERACCT-KEY.
   428         16  ERACCT-COMPANY-CD          PIC  X.
   429         16  ERACCT-CARRIER             PIC  X.
   430         16  ERACCT-GROUPING            PIC  X(6).
   431         16  ERACCT-STATE               PIC  XX.
   432         16  ERACCT-ACCOUNT             PIC  X(10).
   433         16  ERACCT-EXP-DT.
   434             20  ERACCT-DT              PIC  XX.
   435             20  ERACCT-FILL            PIC  X(4).
   436
   437     12  ERENDT-KEY.
   438         16  ENDT-COMPANY-CD       PIC X.
   439         16  ENDT-CARRIER          PIC X.
   440         16  ENDT-GROUPING         PIC X(6).
   441         16  ENDT-STATE            PIC XX.
   442         16  ENDT-ACCOUNT          PIC X(10).
   443         16  ENDT-CERT-EFF-DT      PIC XX.
   444         16  ENDT-CERT-PRIME       PIC X(10).
   445         16  ENDT-CERT-SFX         PIC X.
   446         16  ENDT-RECORD-TYPE      PIC X.
   447         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   448
   449 01  WS-ELMSTR-WORK.
   450     12  ELMSTR-KEY.
   451         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   452         16  MSTR-CERT-NO.
   453             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   454             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   455     12  W-CLAIM-KEY.
   456         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   457         16  W-CL-CERT-NO.
   458             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   459             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   460      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   461 01  CANCEL-GEN-PASS-AREA.
   462     05  CG-OPTION-CODE          PIC X.
   463         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   464         88  CG-FLAT-CANCEL        VALUE '1'.
   465         88  CG-CANCEL             VALUE '2'.
   466         88  CG-CANCEL-REISSUE     VALUE '3'.
   467     05  CG-ERROR-CODE           PIC 99.
   468         88  CG-SUCCESS            VALUE 00.
   469         88  CG-DATE-ERROR         VALUE 01.
   470         88  CG-CERT-NOT-FOUND     VALUE 02.
   471         88  CG-AMOUNT-ERROR       VALUE 04.
   472         88  CG-OPTION-ERROR       VALUE 05.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  10
* EL6311.cbl
   473         88  CG-PREV-CAN           VALUE 06.
   474         88  CG-INVALID-DATA       VALUE 07.
   475         88  CG-NO-ACCT-MSTR       VALUE 08.
   476         88  CG-SFX-A-EXIST        VALUE 09.
   477         88  CG-MISC-ERROR         VALUE 99.
   478     05  CG-COMPANY-ID           PIC XXX.
   479     05  CG-PROC-ID              PIC XXXX.
   480     05  CG-CURRENT-DT           PIC XX.
   481     05  CG-MONTH-END-DT         PIC XX.
   482     05  CG-CERT-KEY.
   483         10  CG-CERT-COMPANY-CD  PIC X.
   484         10  CG-CERT-CARRIER     PIC X.
   485         10  CG-CERT-GROUP       PIC X(6).
   486         10  CG-CERT-STATE       PIC XX.
   487         10  CG-CERT-ACCOUNT     PIC X(10).
   488         10  CG-CERT-EFF-DT      PIC XX.
   489         10  CG-CERT-CERT-NO     PIC X(11).
   490     05  CG-LF-CAN-DATA.
   491         10  CG-LF-CAN-DT        PIC XX.
   492         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   493     05  CG-AH-CAN-DATA.
   494         10  CG-AH-CAN-DT        PIC XX.
   495         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   496     05  CG-CERT-PROFILE-DATA.
   497         10  CG-INS-LNAME        PIC X(15).
   498         10  CG-INS-FNAME        PIC X(10).
   499         10  CG-INS-MID-INIT     PIC X.
   500         10  CG-INS-AGE          PIC 99.
   501         10  CG-JNT-LNAME        PIC X(15).
   502         10  CG-JNT-FNAME        PIC X(10).
   503         10  CG-JNT-MID-INIT     PIC X.
   504         10  CG-JNT-AGE          PIC 99.
   505     05  CG-LF-ISS-DATA.
   506         10  CG-LF-BENCD         PIC XX.
   507         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   508         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   509     05  CG-AH-ISS-DATA.
   510         10  CG-AH-BENCD         PIC XX.
   511         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   512     05  CG-BATCH-NO             PIC X(6).
   513     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   514     05  FILLER                  PIC X(306).
   515******************************************************************
   516*                                                                *
   517*            G E N E R A L   W O R K   A R E A                   *
   518*                                                                *
   519******************************************************************
   520
   521 01  WORK-AREA.
   522     12  WS-RESPONSE             PIC S9(8)   COMP.
   523         88  RESP-NORMAL                  VALUE +00.
   524         88  RESP-NOTFND                  VALUE +13.
   525         88  RESP-DUPREC                  VALUE +14.
   526         88  RESP-DUPKEY                  VALUE +15.
   527         88  RESP-NOTOPEN                 VALUE +19.
   528         88  RESP-ENDFILE                 VALUE +20.
   529     12  DEEDIT-FIELD            PIC X(15).
   530     12  FILLER          REDEFINES DEEDIT-FIELD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  11
* EL6311.cbl
   531         16  FILLER              PIC X(4).
   532         16  DEEDIT-FIELD-X11    PIC X(11).
   533     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   534                                 PIC S9(15).
   535     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
   536                                 PIC S9(13)V99.
   537     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   538                                 PIC S9(11)V9999.
   539     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   540     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   541     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   542         16  WS-CALC-TERM-WHOLE  PIC S999.
   543         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   544
   545     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   546     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   547         16  WS-HR-MINS          PIC 99V99.
   548         16  FILLER              PIC XX.
   549
   550     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   551     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   552
   553     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   554     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   555
   556     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   557     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   558     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   559     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   560     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   561     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   562     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   563
   564     12  QID.
   565         16  QID-TERM            PIC X(4).
   566         16  FILLER              PIC X(4)    VALUE '607B'.
   567
   568     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   569         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   570
   571     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   572         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   573
   574     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   575         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'.
   576
   577     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   578
   579     12  WS-NUMERIC-SW           PIC X.
   580        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   581
   582     12  WS-EDIT-CSO-FIELD.
   583         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   584                                 PIC X.
   585
   586     12  WS-SAVE-INPUT-FIELDS.
   587         16  WS-BAGE             PIC 99       VALUE ZERO.
   588*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  12
* EL6311.cbl
   589         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   590         16  FILLER REDEFINES WS-BAPR.
   591             20  WS-APR-WHOLE-NUM    PIC 99.
   592             20  WS-APR-DEC          PIC 9999.
   593         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   594         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   595
   596         16  WS-B-COVERAGE OCCURS 2 TIMES.
   597             20  WS-TERM-IN-DAYS-SW  PIC X.
   598                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   599             20  WS-BTERM        PIC 999       COMP-3.
   600             20  WS-BALT-TERM    PIC 999       COMP-3.
   601             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   602             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   603             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   604             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   605             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   606             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   607
   608         16  WS-C-FIELDS COMP-3.
   609             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   610             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   611             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   612
   613         16  WS-D-FIELDS COMP-3.
   614             20  WS-DRISS        PIC S9(5)    VALUE +0.
   615             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   616             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   617             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   618             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   619             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   620
   621     12  WS-SAVE-BIRTH-DATE.
   622         16  FILLER              PIC X(4)   VALUE SPACES.
   623         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   624
   625     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   626     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   627     12  FILLER REDEFINES WS-WORK-BIN-RED.
   628         16  FILLER              PIC X(02).
   629         16  WS-WORK-BIN-DT      PIC X(02).
   630     12  WS-SW-1                 PIC X     VALUE SPACE.
   631     12  WS-SW-2                 PIC X     VALUE SPACE.
   632     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   633         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   634     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   635         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   636
   637     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   638     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   639     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   640     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   641     12  WS-CONVERTED-CANCEL-DATES.
   642         16  WS-CONVERTED-CANDT1                  PIC XX.
   643         16  WS-CONVERTED-CANDT2                  PIC XX.
   644
   645     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   646
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  13
* EL6311.cbl
   647     12  WS-REC-FOUND-SW         PIC X.
   648         88  RECORD-NOT-FOUND    VALUE 'N'.
   649
   650     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
   651         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   652         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   653
   654     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   655         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   656         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   657
   658     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   659         88  BROWSE-STARTED      VALUE 'Y'.
   660
   661     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   662         88  FIRST-TIME          VALUE 'Y'.
   663
   664     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   665         88  FIRST-ENTRY         VALUE 'Y'.
   666
   667     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   668         88  REC-BILLED          VALUE 'Y'.
   669
   670     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   671         88  NO-CURSOR-SET       VALUE +0.
   672         88  CURSOR-SET          VALUE +1.
   673
   674     12  WS-ERR-SW               PIC X.
   675         88  STD-ERRORS          VALUE 'S'.
   676         88  TRN-ERRORS          VALUE 'T'.
   677
   678     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   679         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   680
   681     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   682         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   683
   684     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   685         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   686
   687     12  WS-ERR-CODE.
   688         16  FILLER              PIC 99.
   689         16  WS-ERROR-SUB        PIC 99.
   690
   691     12  WS-DATE-WORK.
   692         16  WS-WORK-MM          PIC XX.
   693         16  WS-WORK-DD          PIC XX.
   694         16  WS-WORK-YY          PIC XX.
   695
   696     12  WS-MM-YY.
   697         16  WS-MM               PIC XX.
   698         16  FILLER              PIC X     VALUE '/'.
   699         16  WS-YY               PIC XX.
   700
   701     12  WS-CERT-EFF-DT          PIC XX.
   702
   703     12  WS-MEMBER-NO            PIC X(12).
   704     12  FILLER  REDEFINES  WS-MEMBER-NO.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  14
* EL6311.cbl
   705         16  WS-MEMBER-NO-1-8    PIC 9(8).
   706         16  FILLER              PIC X(4).
   707
   708     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
   709
   710     12  WS-ERPNDB-ALT-KEY.
   711         16  WS-PB-COMPANY-CD-A1         PIC X.
   712         16  WS-PB-CARRIER               PIC X.
   713         16  WS-PB-GROUPING              PIC X(6).
   714         16  WS-PB-STATE                 PIC XX.
   715         16  WS-PB-ACCOUNT               PIC X(10).
   716         16  WS-PB-CERT-EFF-DT           PIC XX.
   717         16  WS-PB-CERT-NO.
   718             20  WS-PB-CERT-PRIME        PIC X(10).
   719             20  WS-PB-CERT-SFX          PIC X.
   720         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   721         16  WS-PB-RECORD-TYPE           PIC X.
   722
   723     12  WS-SHOW-SAVE-AREAS.
   724         16  WS-NEW-CERT-NO.
   725             20  WS-NEW-PRIME    PIC X(10).
   726             20  WS-NEW-SUFFIX   PIC X.
   727         16  WS-NEW-CERT-EFF-DT  PIC XX.
   728         16  WS-NEW-RECORD-TYPE  PIC X.
   729         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   730             88   SHOW-RECORD            VALUE 'Y'.
   731
   732     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   733
   734     12  WS-BATCH-NO.
   735         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   736         16  FILLER              PIC X(5) VALUE SPACES.
   737
   738     12  WS-FIRST-NAME.
   739         16  WS-1ST-INIT         PIC X.
   740         16  FILLER              PIC X(9).
   741
   742     12  WS-INITIALS.
   743         16  WS-INITIAL-1        PIC X.
   744         16  WS-INITIAL-2        PIC X.
   745
   746     12  WS-C-HDG.
   747         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   748         16  FILLER              PIC X(4) VALUE '-REF'.
   749
   750     12  WS-D-PREM-HDG.
   751         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   752         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   753
   754     12  WS-D-REFUND-HDG.
   755         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   756         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   757
   758     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   759
   760     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   761     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   762     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  15
* EL6311.cbl
   763     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   764     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   765     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   766     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
   767
   768     12  WS-01-CANCEL-ERR        PIC X(25)
   769         VALUE 'CANCEL DATE ERROR'.
   770     12  WS-02-CANCEL-ERR        PIC X(25)
   771         VALUE 'CERT NOT FOUND'.
   772     12  WS-04-CANCEL-ERR        PIC X(25)
   773         VALUE 'CANCEL AMOUNT ERROR'.
   774     12  WS-05-CANCEL-ERR        PIC X(25)
   775         VALUE 'CANCEL OPTION ERROR'.
   776     12  WS-06-CANCEL-ERR        PIC X(25)
   777         VALUE 'PREVIOUSLY CANCELLED'.
   778     12  WS-07-CANCEL-ERR        PIC X(25)
   779         VALUE 'INVALID DATA'.
   780     12  WS-08-CANCEL-ERR        PIC X(25)
   781         VALUE 'NO ACCOUNT MASTER'.
   782     12  WS-09-CANCEL-ERR        PIC X(25)
   783         VALUE 'SUFFIX ALREADY EXISTS'.
   784     12  WS-99-CANCEL-ERR        PIC X(25)
   785         VALUE 'MISC CANCEL ERROR'.
   786
   787     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   788     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   789
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  16
* EL6311.cbl
   791
   792******************************************************************
   793*                                                                *
   794*                 B A T C H   T O T A L S                        *
   795*                                                                *
   796******************************************************************
   797
   798     12  WS-BATCH-RECORD.
   799         16  FILLER                       PIC X(10).
   800         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   801         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   802         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   803         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   804         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   805         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   806         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   807         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   808         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   809         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   810         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   811         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   812         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   813         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   814         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   815         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   816         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   817         16  WS-ACCOUNT-NAME              PIC X(30).
   818         16  FILLER                       PIC X.
   819         16  WS-REFERENCE                 PIC X(12).
   820         16  FILLER                       PIC X(197).
   821
   822     12  WS-BATCH-TOTALS.
   823         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   824         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   825         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   826         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   827         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   828         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   829         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   830         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   831         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   832         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   833         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   834         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   835         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   836         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   837         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   838         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   839         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   840         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   841         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   842
   843     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   844
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  17
* EL6311.cbl
   846
   847******************************************************************
   848*                                                                *
   849*                E R R O R   M E S S A G E S                     *
   850*                                                                *
   851******************************************************************
   852
   853 01  ERROR-MESSAGES.
   854     12  ER-0004                 PIC  9(4) VALUE 0004.
   855     12  ER-0008                 PIC  9(4) VALUE 0008.
   856     12  ER-0023                 PIC  9(4) VALUE 0023.
   857     12  ER-0029                 PIC  9(4) VALUE 0029.
   858     12  ER-0033                 PIC  9(4) VALUE 0033.
   859     12  ER-0070                 PIC  9(4) VALUE 0070.
   860     12  ER-0220                 PIC  9(4) VALUE 0220.
   861     12  ER-0248                 PIC  9(4) VALUE 0248.
   862     12  ER-0280                 PIC  9(4) VALUE 0280.
   863     12  ER-0348                 PIC  9(4) VALUE 0348.
   864     12  ER-0582                 PIC  9(4) VALUE 0582.
   865     12  ER-0877                 PIC  9(4) VALUE 0877.
   866     12  ER-1236                 PIC  9(4) VALUE 1236.
   867     12  ER-1570                 PIC  9(4) VALUE 1570.
   868     12  ER-1575                 PIC  9(4) VALUE 1575.
   869     12  ER-1609                 PIC  9(4) VALUE 1609.
   870     12  ER-1819                 PIC  9(4) VALUE 1819.
   871     12  ER-2129                 PIC  9(4) VALUE 2129.
   872     12  ER-2188                 PIC  9(4) VALUE 2188.
   873     12  ER-2192                 PIC  9(4) VALUE 2192.
   874     12  ER-2196                 PIC  9(4) VALUE 2196.
   875     12  ER-2197                 PIC  9(4) VALUE 2197.
   876     12  ER-2198                 PIC  9(4) VALUE 2198.
   877     12  ER-2200                 PIC  9(4) VALUE 2200.
   878     12  ER-2212                 PIC  9(4) VALUE 2212.
   879     12  ER-2218                 PIC  9(4) VALUE 2218.
   880     12  ER-2220                 PIC  9(4) VALUE 2220.
   881     12  ER-2222                 PIC  9(4) VALUE 2222.
   882     12  ER-2223                 PIC  9(4) VALUE 2223.
   883     12  ER-2224                 PIC  9(4) VALUE 2224.
   884     12  ER-2225                 PIC  9(4) VALUE 2225.
   885     12  ER-2226                 PIC  9(4) VALUE 2226.
   886     12  ER-2227                 PIC  9(4) VALUE 2227.
   887     12  ER-2228                 PIC  9(4) VALUE 2228.
   888     12  ER-2240                 PIC  9(4) VALUE 2240.
   889     12  ER-2241                 PIC  9(4) VALUE 2241.
   890     12  ER-2242                 PIC  9(4) VALUE 2242.
   891     12  ER-2243                 PIC  9(4) VALUE 2243.
   892     12  ER-2244                 PIC  9(4) VALUE 2244.
   893     12  ER-2245                 PIC  9(4) VALUE 2245.
   894     12  ER-2246                 PIC  9(4) VALUE 2246.
   895     12  ER-2247                 PIC  9(4) VALUE 2247.
   896     12  ER-2251                 PIC  9(4) VALUE 2251.
   897     12  ER-2252                 PIC  9(4) VALUE 2252.
   898     12  ER-2253                 PIC  9(4) VALUE 2253.
   899     12  ER-2254                 PIC  9(4) VALUE 2254.
   900     12  ER-2255                 PIC  9(4) VALUE 2255.
   901     12  ER-2256                 PIC  9(4) VALUE 2256.
   902     12  ER-2257                 PIC  9(4) VALUE 2257.
   903     12  ER-2258                 PIC  9(4) VALUE 2258.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  18
* EL6311.cbl
   904     12  ER-2259                 PIC  9(4) VALUE 2259.
   905     12  ER-2260                 PIC  9(4) VALUE 2260.
   906     12  ER-2261                 PIC  9(4) VALUE 2261.
   907     12  ER-2287                 PIC  9(4) VALUE 2287.
   908     12  ER-2336                 PIC  9(4) VALUE 2336.
   909     12  ER-2337                 PIC  9(4) VALUE 2337.
   910     12  ER-2437                 PIC  9(4) VALUE 2437.
   911     12  ER-2471                 PIC  9(4) VALUE 2471.
   912     12  ER-2530                 PIC  9(4) VALUE 2530.
   913     12  ER-2531                 PIC  9(4) VALUE 2531.
   914     12  ER-2532                 PIC  9(4) VALUE 2532.
   915     12  ER-2533                 PIC  9(4) VALUE 2533.
   916     12  ER-2547                 PIC  9(4) VALUE 2547.
   917     12  ER-2591                 PIC  9(4) VALUE 2591.
   918     12  ER-2592                 PIC  9(4) VALUE 2592.
   919     12  ER-2593                 PIC  9(4) VALUE 2593.
   920     12  ER-2600                 PIC  9(4) VALUE 2600.
   921     12  ER-2601                 PIC  9(4) VALUE 2601.
   922     12  ER-2604                 PIC  9(4) VALUE 2604.
   923     12  ER-2605                 PIC  9(4) VALUE 2605.
   924     12  ER-2606                 PIC  9(4) VALUE 2606.
   925     12  ER-2607                 PIC  9(4) VALUE 2607.
   926     12  ER-2622                 PIC  9(4) VALUE 2622.
   927     12  ER-2625                 PIC  9(4) VALUE 2625.
   928     12  ER-2626                 PIC  9(4) VALUE 2626.
   929     12  ER-2627                 PIC  9(4) VALUE 2627.
   930     12  ER-2628                 PIC  9(4) VALUE 2628.
   931     12  ER-2629                 PIC  9(4) VALUE 2629.
   932     12  ER-2630                 PIC  9(4) VALUE 2630.
   933     12  ER-2631                 PIC  9(4) VALUE 2631.
   934     12  ER-2632                 PIC  9(4) VALUE 2632.
   935     12  ER-2633                 PIC  9(4) VALUE 2633.
   936     12  ER-2634                 PIC  9(4) VALUE 2634.
   937     12  ER-2635                 PIC  9(4) VALUE 2635.
   938     12  ER-2636                 PIC  9(4) VALUE 2636.
   939     12  ER-2639                 PIC  9(4) VALUE 2639.
   940     12  ER-2640                 PIC  9(4) VALUE 2640.
   941     12  ER-2647                 PIC  9(4) VALUE 2647.
   942     12  ER-2648                 PIC  9(4) VALUE 2648.
   943     12  ER-2649                 PIC  9(4) VALUE 2649.
   944     12  ER-2650                 PIC  9(4) VALUE 2650.
   945     12  ER-2653                 PIC  9(4) VALUE 2653.
   946     12  ER-2654                 PIC  9(4) VALUE 2654.
   947     12  ER-2655                 PIC  9(4) VALUE 2655.
   948     12  ER-2656                 PIC  9(4) VALUE 2656.
   949     12  ER-2657                 PIC  9(4) VALUE 2657.
   950     12  ER-2660                 PIC  9(4) VALUE 2660.
   951     12  ER-2662                 PIC  9(4) VALUE 2662.
   952     12  ER-2663                 PIC  9(4) VALUE 2663.
   953     12  ER-2664                 PIC  9(4) VALUE 2664.
   954     12  ER-2667                 PIC  9(4) VALUE 2667.
   955     12  ER-2668                 PIC  9(4) VALUE 2668.
   956     12  ER-2669                 PIC  9(4) VALUE 2669.
   957     12  ER-2670                 PIC  9(4) VALUE 2670.
   958     12  ER-2671                 PIC  9(4) VALUE 2671.
   959     12  ER-2672                 PIC  9(4) VALUE 2672.
   960     12  ER-2673                 PIC  9(4) VALUE 2673.
   961     12  ER-2677                 PIC  9(4) VALUE 2677.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  19
* EL6311.cbl
   962     12  ER-2678                 PIC  9(4) VALUE 2678.
   963     12  ER-2679                 PIC  9(4) VALUE 2679.
   964     12  ER-2680                 PIC  9(4) VALUE 2680.
   965     12  ER-2681                 PIC  9(4) VALUE 2681.
   966     12  ER-2682                 PIC  9(4) VALUE 2682.
   967     12  ER-2683                 PIC  9(4) VALUE 2683.
   968     12  ER-2684                 PIC  9(4) VALUE 2684.
   969     12  ER-2686                 PIC  9(4) VALUE 2686.
   970     12  ER-2689                 PIC  9(4) VALUE 2689.
   971     12  ER-2690                 PIC  9(4) VALUE 2690.
   972     12  ER-2693                 PIC  9(4) VALUE 2693.
   973     12  ER-2695                 PIC  9(4) VALUE 2695.
   974     12  ER-2701                 PIC  9(4) VALUE 2701.
   975     12  ER-2720                 PIC  9(4) VALUE 2720.
   976     12  ER-2709                 PIC  9(4) VALUE 2709.
   977     12  ER-2704                 PIC  9(4) VALUE 2704.
   978     12  ER-2725                 PIC  9(4) VALUE 2725.
   979     12  ER-2726                 PIC  9(4) VALUE 2726.
   980     12  ER-2728                 PIC  9(4) VALUE 2728.
   981     12  ER-2729                 PIC  9(4) VALUE 2729.
   982     12  ER-2731                 PIC  9(4) VALUE 2731.
   983     12  ER-2732                 PIC  9(4) VALUE 2732.
   984     12  ER-2733                 PIC  9(4) VALUE 2733.
   985     12  ER-2735                 PIC  9(4) VALUE 2735.
   986     12  ER-2738                 PIC  9(4) VALUE 2738.
   987     12  ER-2742                 PIC  9(4) VALUE 2742.
   988     12  ER-2743                 PIC  9(4) VALUE 2743.
   989     12  ER-2744                 PIC  9(4) VALUE 2744.
   990     12  ER-2747                 PIC  9(4) VALUE 2747.
   991     12  ER-2749                 PIC  9(4) VALUE 2749.
   992     12  ER-2753                 PIC  9(4) VALUE 2753.
   993     12  ER-2755                 PIC  9(4) VALUE 2755.
   994     12  ER-2757                 PIC  9(4) VALUE 2757.
   995     12  ER-2771                 PIC  9(4) VALUE 2771.
   996     12  ER-2774                 PIC  9(4) VALUE 2774.
   997     12  ER-2775                 PIC  9(4) VALUE 2775.
   998     12  ER-2776                 PIC  9(4) VALUE 2776.
   999     12  ER-2777                 PIC  9(4) VALUE 2777.
  1000     12  ER-2794                 PIC  9(4) VALUE 2794.
  1001     12  ER-2799                 PIC  9(4) VALUE 2799.
  1002     12  ER-2900                 PIC  9(4) VALUE 2900.
  1003     12  ER-2902                 PIC  9(4) VALUE 2902.
  1004     12  ER-2945                 PIC  9(4) VALUE 2945.
  1005     12  ER-3000                 PIC  9(4) VALUE 3000.
  1006     12  ER-3006                 PIC  9(4) VALUE 3006.
  1007     12  ER-3224                 PIC  9(4) VALUE 3224.
  1008     12  ER-3831                 PIC  9(4) VALUE 3831.
  1009     12  ER-3834                 PIC  9(4) VALUE 3834.
  1010     12  ER-3835                 PIC  9(4) VALUE 3835.
  1011     12  ER-4005                 PIC  9(4) VALUE 4005.
  1012     12  ER-7401                 PIC  9(4) VALUE 7401.
  1013     12  ER-7402                 PIC  9(4) VALUE 7402.
  1014     12  ER-7403                 PIC  9(4) VALUE 7403.
  1015     12  ER-7404                 PIC  9(4) VALUE 7404.
  1016     12  ER-7423                 PIC  9(4) VALUE 7423.
  1017     12  ER-7424                 PIC  9(4) VALUE 7424.
  1018     12  ER-7433                 PIC  9(4) VALUE 7433.
  1019     12  ER-7450                 PIC  9(4) VALUE 7450.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  20
* EL6311.cbl
  1020     12  ER-7451                 PIC  9(4) VALUE 7451.
  1021     12  ER-7530                 PIC  9(4) VALUE 7530.
  1022     12  ER-7573                 PIC  9(4) VALUE 7573.
  1023     12  ER-7631                 PIC  9(4) VALUE 7631.
  1024     12  ER-7632                 PIC  9(4) VALUE 7632.
  1025     12  ER-7633                 PIC  9(4) VALUE 7633.
  1026     12  ER-7537                 PIC  9(4) VALUE 7537.
  1027     12  ER-7538                 PIC  9(4) VALUE 7538.
  1028     12  ER-7574                 PIC  9(4) VALUE 7574.
  1029     12  ER-7997                 PIC  9(4) VALUE 7997.
  1030     12  ER-7998                 PIC  9(4) VALUE 7998.
  1031     12  ER-8148                 PIC  9(4) VALUE 8148.
  1032     12  ER-9841                 PIC  9(4) VALUE 9841.
  1033
  1034*                                COPY ELCTEXT.
  1035******************************************************************
  1036*                                                                *
  1037*                                                                *
  1038*                            ELCTEXT.                            *
  1039*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1040*                            VMOD=2.008                          *
  1041*                                                                *
  1042*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1043*                                     FORM LETTERS,              *
  1044*                                     CERT FORM DISPLAY.
  1045*                                                                *
  1046*   FILE TYPE = VSAM,KSDS                                        *
  1047*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1048*                                                                *
  1049*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1050*       ALTERNATE INDEX = NONE                                   *
  1051*                                                                *
  1052*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1053*       ALTERNATE INDEX = NONE                                   *
  1054*                                                                *
  1055*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1056*       ALTERNATE INDEX = NONE                                   *
  1057*                                                                *
  1058*   LOG = NO                                                     *
  1059*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1060******************************************************************
  1061 01  TEXT-FILES.
  1062     12  TEXT-FILE-ID                PIC XX.
  1063         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1064         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1065         88  HELP-FILE-TEXT             VALUE 'TH'.
  1066
  1067     12  TX-CONTROL-PRIMARY.
  1068         16  TX-COMPANY-CD           PIC X.
  1069             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1070         16  TX-ACCESS-CD-GENL       PIC X(12).
  1071
  1072         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1073             20  TX-LETTER-NO        PIC X(4).
  1074             20  FILLER              PIC X(8).
  1075
  1076         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1077             20  TX-FORM-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  21
* EL6311.cbl
  1078
  1079         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1080             20  TX-HELP-TYPE        PIC X.
  1081                 88  HELP-FOR-GENERAL   VALUE ' '.
  1082                 88  HELP-BY-SCREEN     VALUE 'S'.
  1083                 88  HELP-BY-ERROR      VALUE 'E'.
  1084             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1085                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1086             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1087                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1088             20  FILLER              PIC X(4).
  1089
  1090         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1091
  1092     12  TX-PROCESS-CONTROL          PIC XX.
  1093         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1094
  1095     12  TX-TEXT-LINE                PIC X(70).
  1096
  1097     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1098         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1099         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1100         88  TX-VALID-FORM-SQUEEZE-VALUE
  1101                                        VALUE 'Y' ' '.
  1102
  1103     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1104         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1105         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1106         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1107         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1108         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1109         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1110         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1111                                              'K' 'N' ' '
  1112                                              'Z'.
  1113
  1114     12  TX-ARCHIVE-SW               PIC X.
  1115         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1116         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1117         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1118
  1119     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1120     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1121
  1122     12  TX-BSR-CODE                 PIC X.
  1123         88  TX-BSR-LETTER              VALUE 'B'.
  1124         88  TX-NON-BSR-LETTER          VALUE ' '.
  1125
  1126     12  FILLER                      PIC X.
  1127*****************************************************************
  1128*                                COPY ELCCRTO.
  1129******************************************************************
  1130*                                                                *
  1131*                            ELCCRTO.                            *
  1132*                                                                *
  1133*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1134*                                                                *
  1135*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  22
* EL6311.cbl
  1136*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1137*                                                                *
  1138*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1139*                                                                *
  1140*   LOG = YES                                                    *
  1141*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1142******************************************************************
  1143*                   C H A N G E   L O G
  1144*
  1145* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1146*-----------------------------------------------------------------
  1147*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1148* EFFECTIVE    NUMBER
  1149*-----------------------------------------------------------------
  1150* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1151* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1152* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1153******************************************************************
  1154 01  ORIGINAL-CERTIFICATE.
  1155     12  OC-RECORD-ID                      PIC XX.
  1156         88  VALID-OC-ID                      VALUE 'OC'.
  1157     12  OC-CONTROL-PRIMARY.
  1158         16  OC-COMPANY-CD                 PIC X.
  1159         16  OC-CARRIER                    PIC X.
  1160         16  OC-GROUPING                   PIC X(6).
  1161         16  OC-STATE                      PIC XX.
  1162         16  OC-ACCOUNT                    PIC X(10).
  1163         16  OC-CERT-EFF-DT                PIC XX.
  1164         16  OC-CERT-NO.
  1165             20  OC-CERT-PRIME             PIC X(10).
  1166             20  OC-CERT-SFX               PIC X.
  1167         16  OC-RECORD-TYPE                PIC X.
  1168         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1169     12  OC-LAST-MAINT-DT                  PIC XX.
  1170     12  OC-LAST-MAINT-BY                  PIC X(4).
  1171     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1172     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1173     12  FILLER                            PIC X(49).
  1174     12  OC-ORIG-REC.
  1175         16  OC-INS-LAST-NAME              PIC X(15).
  1176         16  OC-INS-FIRST-NAME             PIC X(10).
  1177         16  OC-INS-MIDDLE-INIT            PIC X.
  1178         16  OC-INS-AGE                    PIC S999     COMP-3.
  1179         16  OC-JNT-LAST-NAME              PIC X(15).
  1180         16  OC-JNT-FIRST-NAME             PIC X(10).
  1181         16  OC-JNT-MIDDLE-INIT            PIC X.
  1182         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1183         16  OC-LF-BENCD                   PIC XX.
  1184         16  OC-LF-TERM                    PIC S999      COMP-3.
  1185         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1186         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1187         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1188         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1189         16  OC-LF-EXP-DT                  PIC XX.
  1190         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1191         16  OC-LF-CANCEL-DT               PIC XX.
  1192         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1193         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  23
* EL6311.cbl
  1194         16  OC-AH-BENCD                   PIC XX.
  1195         16  OC-AH-TERM                    PIC S999      COMP-3.
  1196         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1197         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1198         16  OC-AH-EXP-DT                  PIC XX.
  1199         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1200         16  OC-AH-CP                      PIC 99.
  1201         16  OC-AH-CANCEL-DT               PIC XX.
  1202         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1203         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1204         16  OC-CRED-BENE-NAME             PIC X(25).
  1205         16  OC-1ST-PMT-DT                 PIC XX.
  1206         16  FILLER                        PIC X(215).
  1207
  1208     12  FILLER                            PIC X(50).
  1209******************************************************************
  1210*                                COPY ERCACCT.
  1211******************************************************************
  1212*                                                                *
  1213*                                                                *
  1214*                            ERCACCT                             *
  1215*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1216*                            VMOD=2.031                          *
  1217*                                                                *
  1218*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1219*                                                                *
  1220*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1221*   VSAM ACCOUNT MASTER FILES.                                   *
  1222*                                                                *
  1223*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1224*                                                                *
  1225*   FILE TYPE = VSAM,KSDS                                        *
  1226*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1227*                                                                *
  1228*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1229*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1230*                                                                *
  1231*   LOG = NO                                                     *
  1232*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1233*                                                                *
  1234*                                                                *
  1235******************************************************************
  1236*                   C H A N G E   L O G
  1237*
  1238* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1239*-----------------------------------------------------------------
  1240*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1241* EFFECTIVE    NUMBER
  1242*-----------------------------------------------------------------
  1243* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1244* 092705    2005050300006  PEMA  ADD SPP LEASES
  1245* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1246* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1247* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1248* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1249* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1250******************************************************************
  1251
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  24
* EL6311.cbl
  1252 01  ACCOUNT-MASTER.
  1253     12  AM-RECORD-ID                      PIC XX.
  1254         88  VALID-AM-ID                      VALUE 'AM'.
  1255
  1256     12  AM-CONTROL-PRIMARY.
  1257         16  AM-COMPANY-CD                 PIC X.
  1258         16  AM-MSTR-CNTRL.
  1259             20  AM-CONTROL-A.
  1260                 24  AM-CARRIER            PIC X.
  1261                 24  AM-GROUPING.
  1262                     28 AM-GROUPING-PREFIX PIC XXX.
  1263                     28 AM-GROUPING-PRIME  PIC XXX.
  1264                 24  AM-STATE              PIC XX.
  1265                 24  AM-ACCOUNT.
  1266                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1267                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1268             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1269                                           PIC X(19).
  1270             20  AM-CNTRL-B.
  1271                 24  AM-EXPIRATION-DT      PIC XX.
  1272                 24  FILLER                PIC X(4).
  1273             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1274                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1275
  1276     12  AM-CONTROL-BY-VAR-GRP.
  1277         16  AM-COMPANY-CD-A1              PIC X.
  1278         16  AM-VG-CARRIER                 PIC X.
  1279         16  AM-VG-GROUPING                PIC X(6).
  1280         16  AM-VG-STATE                   PIC XX.
  1281         16  AM-VG-ACCOUNT                 PIC X(10).
  1282         16  AM-VG-DATE.
  1283             20  AM-VG-EXPIRATION-DT       PIC XX.
  1284             20  FILLER                    PIC X(4).
  1285         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1286                                           PIC 9(11)      COMP-3.
  1287     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1288         16  FILLER                        PIC X(10).
  1289         16  AM-VG-KEY3.
  1290             20  AM-VG3-ACCOUNT            PIC X(10).
  1291             20  AM-VG3-EXP-DT             PIC XX.
  1292         16  FILLER                        PIC X(4).
  1293     12  AM-MAINT-INFORMATION.
  1294         16  AM-LAST-MAINT-DT              PIC XX.
  1295         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1296         16  AM-LAST-MAINT-USER            PIC X(4).
  1297         16  FILLER                        PIC XX.
  1298
  1299     12  AM-EFFECTIVE-DT                   PIC XX.
  1300     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1301
  1302     12  AM-PREV-DATES  COMP-3.
  1303         16  AM-PREV-EXP-DT                PIC 9(11).
  1304         16  AM-PREV-EFF-DT                PIC 9(11).
  1305
  1306     12  AM-REPORT-CODE-1                  PIC X(10).
  1307     12  AM-REPORT-CODE-2                  PIC X(10).
  1308
  1309     12  AM-CITY-CODE                      PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  25
* EL6311.cbl
  1310     12  AM-COUNTY-PARISH                  PIC X(6).
  1311
  1312     12  AM-NAME                           PIC X(30).
  1313     12  AM-PERSON                         PIC X(30).
  1314     12  AM-ADDRS                          PIC X(30).
  1315     12  AM-CITY.
  1316         16  AM-ADDR-CITY                  PIC X(28).
  1317         16  AM-ADDR-STATE                 PIC XX.
  1318     12  AM-ZIP.
  1319         16  AM-ZIP-PRIME.
  1320             20  AM-ZIP-PRI-1ST            PIC X.
  1321                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1322             20  FILLER                    PIC X(4).
  1323         16  AM-ZIP-PLUS4                  PIC X(4).
  1324     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1325         16  AM-CAN-POSTAL-1               PIC XXX.
  1326         16  AM-CAN-POSTAL-2               PIC XXX.
  1327         16  FILLER                        PIC XXX.
  1328     12  AM-TEL-NO.
  1329         16  AM-AREA-CODE                  PIC 999.
  1330         16  AM-TEL-PRE                    PIC 999.
  1331         16  AM-TEL-NBR                    PIC 9(4).
  1332     12  AM-TEL-LOC                        PIC X.
  1333         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1334         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1335
  1336     12  AM-COMM-STRUCTURE.
  1337         16  AM-DEFN-1.
  1338             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1339                 24  AM-AGT.
  1340                     28  AM-AGT-PREFIX     PIC X(4).
  1341                     28  AM-AGT-PRIME      PIC X(6).
  1342                 24  AM-COM-TYP            PIC X.
  1343                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1344                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1345                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1346                 24  AM-RECALC-LV-INDIC    PIC X.
  1347                 24  AM-RETRO-LV-INDIC     PIC X.
  1348                 24  AM-GL-CODES           PIC X.
  1349                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1350                 24  FILLER                PIC X(01).
  1351         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1352             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1353                 24  FILLER                PIC X(11).
  1354                 24  AM-L-COMA             PIC XXX.
  1355                 24  AM-J-COMA             PIC XXX.
  1356                 24  AM-A-COMA             PIC XXX.
  1357                 24  FILLER                PIC X(6).
  1358
  1359     12  AM-COMM-CHANGE-STATUS             PIC X.
  1360         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1361
  1362     12  AM-CSR-CODE                       PIC X(4).
  1363
  1364     12  AM-BILLING-STATUS                 PIC X.
  1365         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1366         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1367     12  AM-AUTO-REFUND-SW                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  26
* EL6311.cbl
  1368         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1369         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1370     12  AM-GPCD                           PIC 99.
  1371     12  AM-IG                             PIC X.
  1372         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1373         88  AM-HAS-GROUP                     VALUE '2'.
  1374     12  AM-STATUS                         PIC X.
  1375         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1376         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1377         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1378         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1379         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1380         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1381     12  AM-REMIT-TO                       PIC 99.
  1382     12  AM-ID-NO                          PIC X(11).
  1383
  1384     12  AM-CAL-TABLE                      PIC XX.
  1385     12  AM-LF-DEVIATION                   PIC XXX.
  1386     12  AM-AH-DEVIATION                   PIC XXX.
  1387     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1388     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1389     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1390     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1391     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1392     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1393
  1394     12  AM-USER-FIELDS.
  1395         16  AM-FLD-1                      PIC XX.
  1396         16  AM-FLD-2                      PIC XX.
  1397         16  AM-FLD-3                      PIC XX.
  1398         16  AM-FLD-4                      PIC XX.
  1399         16  AM-FLD-5                      PIC XX.
  1400
  1401     12  AM-1ST-PROD-DATE.
  1402         16  AM-1ST-PROD-YR                PIC XX.
  1403         16  AM-1ST-PROD-MO                PIC XX.
  1404         16  AM-1ST-PROD-DA                PIC XX.
  1405     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1406     12  AM-CERTS-PURGED-DATE.
  1407         16  AM-PUR-YR                     PIC XX.
  1408         16  AM-PUR-MO                     PIC XX.
  1409         16  AM-PUR-DA                     PIC XX.
  1410     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1411     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1412     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1413     12  AM-INACTIVE-DATE.
  1414         16  AM-INA-MO                     PIC 99.
  1415         16  AM-INA-DA                     PIC 99.
  1416         16  AM-INA-YR                     PIC 99.
  1417     12  AM-AR-HI-CERT-DATE                PIC XX.
  1418
  1419     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1420     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1421
  1422     12  AM-OB-PAYMENT-MODE                PIC X.
  1423         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1424         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1425         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  27
* EL6311.cbl
  1426         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1427
  1428     12  AM-AH-ONLY-INDICATOR              PIC X.
  1429         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1430         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1431
  1432     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1433
  1434     12  AM-OVER-SHORT.
  1435         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1436         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1437
  1438     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1439     12  AM-DCC-CLP-STATE                  PIC XX.
  1440
  1441     12  AM-RECALC-COMM                    PIC X.
  1442     12  AM-RECALC-REIN                    PIC X.
  1443
  1444     12  AM-REI-TABLE                      PIC XXX.
  1445     12  AM-REI-ET-LF                      PIC X.
  1446     12  AM-REI-ET-AH                      PIC X.
  1447     12  AM-REI-PE-LF                      PIC X.
  1448     12  AM-REI-PE-AH                      PIC X.
  1449     12  AM-REI-PRT-ST                     PIC X.
  1450     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1451     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1452     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1453     12  AM-REI-GROUP-A                    PIC X(6).
  1454     12  AM-REI-MORT                       PIC X(4).
  1455     12  AM-REI-PRT-OW                     PIC X.
  1456     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1457     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1458     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1459     12  AM-REI-GROUP-B                    PIC X(6).
  1460
  1461     12  AM-TRUST-TYPE                     PIC X(2).
  1462
  1463     12  AM-EMPLOYER-STMT-USED             PIC X.
  1464     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1465
  1466     12  AM-STD-AH-TYPE                    PIC XX.
  1467     12  AM-EARN-METHODS.
  1468         16  AM-EARN-METHOD-R              PIC X.
  1469             88 AM-REF-RL-R78                 VALUE 'R'.
  1470             88 AM-REF-RL-PR                  VALUE 'P'.
  1471             88 AM-REF-RL-MEAN                VALUE 'M'.
  1472             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1473         16  AM-EARN-METHOD-L              PIC X.
  1474             88 AM-REF-LL-R78                 VALUE 'R'.
  1475             88 AM-REF-LL-PR                  VALUE 'P'.
  1476             88 AM-REF-LL-MEAN                VALUE 'M'.
  1477             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1478         16  AM-EARN-METHOD-A              PIC X.
  1479             88 AM-REF-AH-R78                 VALUE 'R'.
  1480             88 AM-REF-AH-PR                  VALUE 'P'.
  1481             88 AM-REF-AH-MEAN                VALUE 'M'.
  1482             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1483             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  28
* EL6311.cbl
  1484             88 AM-REF-AH-NET                 VALUE 'N'.
  1485
  1486     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1487     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1488     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1489
  1490     12  AM-RET-Y-N                        PIC X.
  1491     12  AM-RET-P-E                        PIC X.
  1492     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1493     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1494     12  AM-RET-GRP                        PIC X(6).
  1495     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1496         16  AM-POOL-PRIME                 PIC XXX.
  1497         16  AM-POOL-SUB                   PIC XXX.
  1498     12  AM-RETRO-EARNINGS.
  1499         16  AM-RET-EARN-R                 PIC X.
  1500         16  AM-RET-EARN-L                 PIC X.
  1501         16  AM-RET-EARN-A                 PIC X.
  1502     12  AM-RET-ST-TAX-USE                 PIC X.
  1503         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1504         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1505     12  AM-RETRO-BEG-EARNINGS.
  1506         16  AM-RET-BEG-EARN-R             PIC X.
  1507         16  AM-RET-BEG-EARN-L             PIC X.
  1508         16  AM-RET-BEG-EARN-A             PIC X.
  1509     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1510     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1511
  1512     12  AM-USER-SELECT-OPTIONS.
  1513         16  AM-USER-SELECT-1              PIC X(10).
  1514         16  AM-USER-SELECT-2              PIC X(10).
  1515         16  AM-USER-SELECT-3              PIC X(10).
  1516         16  AM-USER-SELECT-4              PIC X(10).
  1517         16  AM-USER-SELECT-5              PIC X(10).
  1518
  1519     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1520
  1521     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1522
  1523     12  AM-RPT045A-SWITCH                 PIC X.
  1524         88  RPT045A-OFF                   VALUE 'N'.
  1525
  1526     12  AM-INSURANCE-LIMITS.
  1527         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1528         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1529
  1530     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1531         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1532
  1533     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1534         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1535         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1536
  1537     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1538
  1539     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1540     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1541     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  29
* EL6311.cbl
  1542     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1543     12  AM-DCC-UEF-STATE                  PIC XX.
  1544     12  FILLER                            PIC XXX.
  1545     12  AM-REPORT-CODE-3                  PIC X(10).
  1546*    12  FILLER                            PIC X(22).
  1547
  1548     12  AM-RESERVE-DATE.
  1549         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1550         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1551         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1552
  1553     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1554     12  AM-NOTIFICATION-TYPES.
  1555         16  AM-NOTIF-OF-LETTERS           PIC X.
  1556         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1557         16  AM-NOTIF-OF-REPORTS           PIC X.
  1558         16  AM-NOTIF-OF-STATUS            PIC X.
  1559
  1560     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1561         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1562         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1563         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1564         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1565
  1566     12  AM-BENEFIT-CONTROLS.
  1567         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1568             20  AM-BENEFIT-CODE           PIC XX.
  1569             20  AM-BENEFIT-TYPE           PIC X.
  1570             20  AM-BENEFIT-REVISION       PIC XXX.
  1571             20  AM-BENEFIT-REM-TERM       PIC X.
  1572             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1573             20  FILLER                    PIC XX.
  1574         16  FILLER                        PIC X(80).
  1575
  1576     12  AM-TRANSFER-DATA.
  1577         16  AM-TRANSFERRED-FROM.
  1578             20  AM-TRNFROM-CARRIER        PIC X.
  1579             20  AM-TRNFROM-GROUPING.
  1580                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1581                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1582             20  AM-TRNFROM-STATE          PIC XX.
  1583             20  AM-TRNFROM-ACCOUNT.
  1584                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1585                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1586             20  AM-TRNFROM-DTE            PIC XX.
  1587         16  AM-TRANSFERRED-TO.
  1588             20  AM-TRNTO-CARRIER          PIC X.
  1589             20  AM-TRNTO-GROUPING.
  1590                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1591                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1592             20  AM-TRNTO-STATE            PIC XX.
  1593             20  AM-TRNTO-ACCOUNT.
  1594                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1595                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1596             20  AM-TRNTO-DTE              PIC XX.
  1597         16  FILLER                        PIC X(10).
  1598
  1599     12  AM-SAVED-REMIT-TO                 PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  30
* EL6311.cbl
  1600
  1601     12  AM-COMM-STRUCTURE-SAVED.
  1602         16  AM-DEFN-1-SAVED.
  1603             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1604                 24  AM-AGT-SV             PIC X(10).
  1605                 24  AM-COM-TYP-SV         PIC X.
  1606                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1607                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1608                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1609                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1610                 24  FILLER                PIC X.
  1611                 24  AM-GL-CODES-SV        PIC X.
  1612                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1613                 24  FILLER                PIC X.
  1614         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1615             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1616                 24  FILLER                PIC X(11).
  1617                 24  AM-L-COMA-SV          PIC XXX.
  1618                 24  AM-J-COMA-SV          PIC XXX.
  1619                 24  AM-A-COMA-SV          PIC XXX.
  1620                 24  FILLER                PIC X(6).
  1621
  1622     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1623         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1624            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1625            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1626            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1627
  1628     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1629     12  FILLER                            PIC X(120).
  1630
  1631     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1632         16  AM-CONTROL-NAME               PIC X(30).
  1633         16  AM-EXECUTIVE-ONE.
  1634             20  AM-EXEC1-NAME             PIC X(15).
  1635             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1636                                                          COMP-3.
  1637             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1638                                                          COMP-3.
  1639         16  AM-EXECUTIVE-TWO.
  1640             20  AM-EXEC2-NAME             PIC X(15).
  1641             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1642                                                          COMP-3.
  1643             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1644                                                          COMP-3.
  1645
  1646     12  AM-RETRO-ADDITIONAL-DATA.
  1647         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1648         16  AM-RETRO-PREM-P-E             PIC X.
  1649         16  AM-RETRO-CLMS-P-I             PIC X.
  1650         16  AM-RETRO-RET-BRACKET-LF.
  1651             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1652                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1653                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1654             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1655                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1656                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1657             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  31
* EL6311.cbl
  1658                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1659                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1660         16  AM-RETRO-RET-BRACKET-AH.
  1661             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1662                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1663                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1664                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1665             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1666                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1667                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1668             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1669                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1670                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1671
  1672     12  AM-COMMENTS.
  1673         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1674
  1675     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1676         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1677         16  AM-FLI-BILLING-CODE           PIC X.
  1678         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1679         16  AM-FLI-UNITED-IDENT           PIC X.
  1680         16  AM-FLI-INTEREST-LOST-DATA.
  1681             20  AM-FLI-BANK-NO            PIC X(5).
  1682             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1683             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1684             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1685         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1686             20  AM-FLI-AGT                PIC X(9).
  1687             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1688             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1689         16  FILLER                        PIC X(102).
  1690
  1691     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1692         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1693             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1694             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1695             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1696             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1697             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1698         16  FILLER                          PIC X(10).
  1699******************************************************************
  1700*                                COPY ELCVADS.
  1701******************************************************************
  1702*                                                                *
  1703*                                                                *
  1704*                            ELCVADS.                            *
  1705*                                                                *
  1706*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1707*   ELVADS                  LENGTH = 350                         *
  1708******************************************************************
  1709******************************************************************
  1710*                   C H A N G E   L O G
  1711*
  1712* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1713*-----------------------------------------------------------------
  1714*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1715* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  32
* EL6311.cbl
  1716*-----------------------------------------------------------------
  1717* 100111    2011022800001  AJRA  NAPERSOFT
  1718******************************************************************
  1719
  1720 01  VIRGINIA-DISCLOSURE.
  1721     12  VD-COMPANY-CD              PIC X.
  1722     12  VD-CARRIER                 PIC X.
  1723     12  VD-GROUPING.
  1724         20  VD-GROUPING-PREFIX     PIC XXX.
  1725         20  VD-GROUPING-PRIME      PIC XXX.
  1726     12  VD-STATE                   PIC XX.
  1727     12  VD-ACCOUNT.
  1728         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1729         20  VD-ACCOUNT-PRIME       PIC X(6).
  1730     12  VD-CERT-EFF-DT             PIC XX.
  1731     12  VD-CERT-NO.
  1732         20  VD-CERT-PRIME          PIC X(10).
  1733         20  VD-CERT-SFX            PIC X.
  1734     12  VD-ENTRY-BATCH             PIC X(6).
  1735     12  VD-CSR-ID                  PIC X(4).
  1736     12  VD-NAME.
  1737         20  VD-INSURED-LAST-NAME   PIC X(15).
  1738         20  VD-INSURED-FIRST-NAME.
  1739             24  VD-INSURED-1ST-INIT PIC X.
  1740             24  FILLER             PIC X(9).
  1741         20  VD-INSURED-MIDDLE-INIT PIC X.
  1742     12  VD-JOINT-INSURED.
  1743         20 VD-JOINT-LAST-NAME      PIC X(15).
  1744         20 VD-JOINT-FIRST-NAME.
  1745            24  VD-JOINT-FIRST-INIT PIC X.
  1746            24  FILLER              PIC X(9).
  1747         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1748     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1749     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1750     12  VD-INSURED-CITY-STATE.
  1751         20  VD-INSURED-CITY        PIC X(28).
  1752         20  VD-INSURED-STATE       PIC XX.
  1753     12  VD-INSURED-ZIP-CODE.
  1754         20  VD-INSURED-ZIP-PRIME.
  1755             24  VD-INSURED-ZIP-1   PIC X.
  1756                 88  VD-CANADIAN-POST-CODE
  1757                                       VALUE 'A' THRU 'Z'.
  1758             24  FILLER             PIC X(4).
  1759         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1760     12  VD-BENEFICIARY-NAME        PIC X(30).
  1761     12  VD-ACCOUNT-NAME            PIC X(30).
  1762     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1763     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1764     12  VD-1ST-PMT-DT              PIC XX.
  1765     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1766         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1767         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1768                                             '90' THRU '99'.
  1769     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1770                                    PIC XX.
  1771     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1772     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1773     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  33
* EL6311.cbl
  1774     12  VD-LF-TERM                 PIC S999   COMP-3.
  1775     12  VD-AH-BENEFIT-CD           PIC XX.
  1776         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1777         88  VD-INVALID-AH             VALUE '  ' '00'
  1778                                             '90' THRU '99'.
  1779     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1780     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1781     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1782     12  VD-AH-TERM                 PIC S999   COMP-3.
  1783     12  VD-LETTER-ID               PIC X(4).
  1784     12  VD-PROC-ID                 PIC X(4).
  1785     12  VD-COMP-ID                 PIC X(3).
  1786     12  VD-CURRENT-DATE            PIC XX.
  1787     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1788     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1789     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  34
* EL6311.cbl
  1791*    COPY ELCDATE.
  1792******************************************************************
  1793*                                                                *
  1794*                                                                *
  1795*                            ELCDATE.                            *
  1796*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1797*                            VMOD=2.003
  1798*                                                                *
  1799*                                                                *
  1800*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1801*                 LENGTH = 200                                   *
  1802******************************************************************
  1803
  1804 01  DATE-CONVERSION-DATA.
  1805     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1806     12  DC-OPTION-CODE                PIC X.
  1807         88  BIN-TO-GREG                VALUE ' '.
  1808         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1809         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1810         88  YMD-GREG-TO-BIN            VALUE '3'.
  1811         88  MDY-GREG-TO-BIN            VALUE '4'.
  1812         88  JULIAN-TO-BIN              VALUE '5'.
  1813         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1814         88  FIND-CENTURY               VALUE '7'.
  1815         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1816         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1817         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1818         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1819         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1820         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1821         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1822         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1823         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1824         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1825         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1826         88  BIN-3-TO-GREG              VALUE 'I'.
  1827         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1828         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1829         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1830         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1831         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1832         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1833         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1834         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1835         88  THREE-CHARACTER-BIN
  1836                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1837         88  GREGORIAN-TO-BIN
  1838                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1839         88  BIN-TO-GREGORIAN
  1840                  VALUES ' ' '1' 'I' '8' 'G'.
  1841         88  JULIAN-TO-BINARY
  1842                  VALUES '5' 'C' 'E' 'F'.
  1843     12  DC-ERROR-CODE                 PIC X.
  1844         88  NO-CONVERSION-ERROR        VALUE ' '.
  1845         88  DATE-CONVERSION-ERROR
  1846                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1847         88  DATE-IS-ZERO               VALUE '1'.
  1848         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  35
* EL6311.cbl
  1849         88  DATE-IS-INVALID            VALUE '3'.
  1850         88  DATE1-GREATER-DATE2        VALUE '4'.
  1851         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1852         88  DATE-INVALID-OPTION        VALUE '9'.
  1853         88  INVALID-CENTURY            VALUE 'A'.
  1854         88  ONLY-CENTURY               VALUE 'B'.
  1855         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1856         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1857     12  DC-END-OF-MONTH               PIC X.
  1858         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1859     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1860         88  USE-NORMAL-PROCESS         VALUE ' '.
  1861         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1862         88  ADJUST-UP-100-YRS          VALUE '2'.
  1863     12  FILLER                        PIC X.
  1864     12  DC-CONVERSION-DATES.
  1865         16  DC-BIN-DATE-1             PIC XX.
  1866         16  DC-BIN-DATE-2             PIC XX.
  1867         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1868         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1869                       DC-GREG-DATE-1-EDIT.
  1870             20  DC-EDIT1-MONTH        PIC 99.
  1871             20  SLASH1-1              PIC X.
  1872             20  DC-EDIT1-DAY          PIC 99.
  1873             20  SLASH1-2              PIC X.
  1874             20  DC-EDIT1-YEAR         PIC 99.
  1875         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1876         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1877                     DC-GREG-DATE-2-EDIT.
  1878             20  DC-EDIT2-MONTH        PIC 99.
  1879             20  SLASH2-1              PIC X.
  1880             20  DC-EDIT2-DAY          PIC 99.
  1881             20  SLASH2-2              PIC X.
  1882             20  DC-EDIT2-YEAR         PIC 99.
  1883         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1884         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1885                     DC-GREG-DATE-1-YMD.
  1886             20  DC-YMD-YEAR           PIC 99.
  1887             20  DC-YMD-MONTH          PIC 99.
  1888             20  DC-YMD-DAY            PIC 99.
  1889         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1890         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1891                      DC-GREG-DATE-1-MDY.
  1892             20  DC-MDY-MONTH          PIC 99.
  1893             20  DC-MDY-DAY            PIC 99.
  1894             20  DC-MDY-YEAR           PIC 99.
  1895         16  DC-GREG-DATE-1-ALPHA.
  1896             20  DC-ALPHA-MONTH        PIC X(10).
  1897             20  DC-ALPHA-DAY          PIC 99.
  1898             20  FILLER                PIC XX.
  1899             20  DC-ALPHA-CENTURY.
  1900                 24 DC-ALPHA-CEN-N     PIC 99.
  1901             20  DC-ALPHA-YEAR         PIC 99.
  1902         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1903         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1904         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1905         16  DC-JULIAN-DATE            PIC 9(05).
  1906         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  36
* EL6311.cbl
  1907                                       PIC 9(05).
  1908         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1909             20  DC-JULIAN-YEAR        PIC 99.
  1910             20  DC-JULIAN-DAYS        PIC 999.
  1911         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1912         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1913         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1914     12  DATE-CONVERSION-VARIBLES.
  1915         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1916         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1917             20  FILLER                PIC 9(3).
  1918             20  HOLD-CEN-1-CCYY.
  1919                 24  HOLD-CEN-1-CC     PIC 99.
  1920                 24  HOLD-CEN-1-YY     PIC 99.
  1921             20  HOLD-CEN-1-MO         PIC 99.
  1922             20  HOLD-CEN-1-DA         PIC 99.
  1923         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1924             20  HOLD-CEN-1-R-MO       PIC 99.
  1925             20  HOLD-CEN-1-R-DA       PIC 99.
  1926             20  HOLD-CEN-1-R-CCYY.
  1927                 24  HOLD-CEN-1-R-CC   PIC 99.
  1928                 24  HOLD-CEN-1-R-YY   PIC 99.
  1929             20  FILLER                PIC 9(3).
  1930         16  HOLD-CENTURY-1-X.
  1931             20  FILLER                PIC X(3)  VALUE SPACES.
  1932             20  HOLD-CEN-1-X-CCYY.
  1933                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1934                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1935             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1936             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1937         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1938             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1939             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1940             20  HOLD-CEN-1-R-X-CCYY.
  1941                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1942                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1943             20  FILLER                PIC XXX.
  1944         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1945         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1946         16  DC-JULIAN-DATE-1          PIC 9(07).
  1947         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1948             20  DC-JULIAN-1-CCYY.
  1949                 24  DC-JULIAN-1-CC    PIC 99.
  1950                 24  DC-JULIAN-1-YR    PIC 99.
  1951             20  DC-JULIAN-DA-1        PIC 999.
  1952         16  DC-JULIAN-DATE-2          PIC 9(07).
  1953         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1954             20  DC-JULIAN-2-CCYY.
  1955                 24  DC-JULIAN-2-CC    PIC 99.
  1956                 24  DC-JULIAN-2-YR    PIC 99.
  1957             20  DC-JULIAN-DA-2        PIC 999.
  1958         16  DC-GREG-DATE-A-EDIT.
  1959             20  DC-EDITA-MONTH        PIC 99.
  1960             20  SLASHA-1              PIC X VALUE '/'.
  1961             20  DC-EDITA-DAY          PIC 99.
  1962             20  SLASHA-2              PIC X VALUE '/'.
  1963             20  DC-EDITA-CCYY.
  1964                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  37
* EL6311.cbl
  1965                 24  DC-EDITA-YEAR     PIC 99.
  1966         16  DC-GREG-DATE-B-EDIT.
  1967             20  DC-EDITB-MONTH        PIC 99.
  1968             20  SLASHB-1              PIC X VALUE '/'.
  1969             20  DC-EDITB-DAY          PIC 99.
  1970             20  SLASHB-2              PIC X VALUE '/'.
  1971             20  DC-EDITB-CCYY.
  1972                 24  DC-EDITB-CENT     PIC 99.
  1973                 24  DC-EDITB-YEAR     PIC 99.
  1974         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1975         16  DC-GREG-DATE-CYMD-R REDEFINES
  1976                              DC-GREG-DATE-CYMD.
  1977             20  DC-CYMD-CEN           PIC 99.
  1978             20  DC-CYMD-YEAR          PIC 99.
  1979             20  DC-CYMD-MONTH         PIC 99.
  1980             20  DC-CYMD-DAY           PIC 99.
  1981         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1982         16  DC-GREG-DATE-MDCY-R REDEFINES
  1983                              DC-GREG-DATE-MDCY.
  1984             20  DC-MDCY-MONTH         PIC 99.
  1985             20  DC-MDCY-DAY           PIC 99.
  1986             20  DC-MDCY-CEN           PIC 99.
  1987             20  DC-MDCY-YEAR          PIC 99.
  1988    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1989        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1990    12  DC-EL310-DATE                  PIC X(21).
  1991    12  FILLER                         PIC X(28).
  1992
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  38
* EL6311.cbl
  1994*    COPY ELCLOGOF.
  1995******************************************************************
  1996*                                                                *
  1997*                                                                *
  1998*                            ELCLOGOF.                           *
  1999*                            VMOD=2.001                          *
  2000*                                                                *
  2001*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2002*                                                                *
  2003******************************************************************
  2004 01  CLASIC-LOGOFF.
  2005     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2006     12  LOGOFF-TEXT.
  2007         16  FILLER          PIC X(5)    VALUE SPACES.
  2008         16  LOGOFF-MSG.
  2009             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2010             20  FILLER      PIC X       VALUE SPACES.
  2011             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2012         16  FILLER          PIC X(80)
  2013           VALUE '* YOU ARE NOW LOGGED OFF'.
  2014         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2015         16  FILLER          PIC X       VALUE QUOTE.
  2016         16  LOGOFF-SYS-MSG  PIC X(17)
  2017           VALUE 'S CLAS-IC SYSTEM '.
  2018     12  TEXT-MESSAGES.
  2019         16  UNACCESS-MSG    PIC X(29)
  2020             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2021         16  PGMIDERR-MSG    PIC X(17)
  2022             VALUE 'PROGRAM NOT FOUND'.
  2023
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  39
* EL6311.cbl
  2025*    COPY ELCATTR.
  2026******************************************************************
  2027*                                                                *
  2028*                            ELCATTR.                            *
  2029*                            VMOD=2.001                          *
  2030*                                                                *
  2031*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2032*                                                                *
  2033*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2034*                                                                *
  2035*                   POS 1   P=PROTECTED                          *
  2036*                           U=UNPROTECTED                        *
  2037*                           S=ASKIP                              *
  2038*                   POS 2   A=ALPHA/NUMERIC                      *
  2039*                           N=NUMERIC                            *
  2040*                   POS 3   N=NORMAL                             *
  2041*                           B=BRIGHT                             *
  2042*                           D=DARK                               *
  2043*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2044*                           OF=MODIFIED DATA TAG OFF             *
  2045*                                                                *
  2046*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2047******************************************************************
  2048 01  ATTRIBUTE-LIST.
  2049     12  AL-PABOF            PIC X       VALUE 'Y'.
  2050     12  AL-PABON            PIC X       VALUE 'Z'.
  2051     12  AL-PADOF            PIC X       VALUE '%'.
  2052     12  AL-PADON            PIC X       VALUE '_'.
  2053     12  AL-PANOF            PIC X       VALUE '-'.
  2054     12  AL-PANON            PIC X       VALUE '/'.
  2055     12  AL-SABOF            PIC X       VALUE '8'.
  2056     12  AL-SABON            PIC X       VALUE '9'.
  2057     12  AL-SADOF            PIC X       VALUE '@'.
  2058     12  AL-SADON            PIC X       VALUE QUOTE.
  2059     12  AL-SANOF            PIC X       VALUE '0'.
  2060     12  AL-SANON            PIC X       VALUE '1'.
  2061     12  AL-UABOF            PIC X       VALUE 'H'.
  2062     12  AL-UABON            PIC X       VALUE 'I'.
  2063     12  AL-UADOF            PIC X       VALUE '<'.
  2064     12  AL-UADON            PIC X       VALUE '('.
  2065     12  AL-UANOF            PIC X       VALUE ' '.
  2066     12  AL-UANON            PIC X       VALUE 'A'.
  2067     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2068     12  AL-UNBON            PIC X       VALUE 'R'.
  2069     12  AL-UNDOF            PIC X       VALUE '*'.
  2070     12  AL-UNDON            PIC X       VALUE ')'.
  2071     12  AL-UNNOF            PIC X       VALUE '&'.
  2072     12  AL-UNNON            PIC X       VALUE 'J'.
  2073
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  40
* EL6311.cbl
  2075*    COPY ELCEMIB.
  2076******************************************************************
  2077*                                                                *
  2078*                                                                *
  2079*                            ELCEMIB.                            *
  2080*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2081*                            VMOD=2.005                          *
  2082*                                                                *
  2083*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2084*                                                                *
  2085******************************************************************
  2086 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2087     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2088     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2089     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2090     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2091     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2092     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2093     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2094     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2095     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2096         88  EMI-NO-ERRORS                    VALUE '1'.
  2097         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2098         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2099     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2100         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2101     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2102         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2103         88  EMI-AREA1-FULL                   VALUE '2'.
  2104     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2105         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2106         88  EMI-AREA2-FULL                   VALUE '2'.
  2107     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2108         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2109         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2110         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2111         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2112         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2113     12  EMI-ERROR-LINES.
  2114         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2115         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2116         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2117         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2118             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2119                 24  EMI-ERR-NUM         PIC X(4).
  2120                 24  EMI-FILLER          PIC X.
  2121                 24  EMI-SEV             PIC X.
  2122                 24  FILLER              PIC X.
  2123             20  FILLER                  PIC X(02).
  2124     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2125         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2126             20  EMI-ERROR-NUMBER    PIC X(4).
  2127             20  EMI-FILL            PIC X.
  2128             20  EMI-SEVERITY        PIC X.
  2129             20  FILLER              PIC X.
  2130             20  EMI-ERROR-TEXT.
  2131                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2132                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  41
* EL6311.cbl
  2133     12  EMI-SEVERITY-SAVE           PIC X.
  2134         88  EMI-NOTE                    VALUE 'N'.
  2135         88  EMI-WARNING                 VALUE 'W'.
  2136         88  EMI-FORCABLE                VALUE 'F'.
  2137         88  EMI-FATAL                   VALUE 'X'.
  2138     12  EMI-MESSAGE-FLAG            PIC X.
  2139         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2140         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2141     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2142     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2143         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2144         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2145         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2146     12  FILLER                      PIC X(137)  VALUE SPACES.
  2147     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2148     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2149     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2150     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2151
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  42
* EL6311.cbl
  2153*    COPY ELCINTF.
  2154******************************************************************
  2155*                                                                *
  2156*                                                                *
  2157*                            ELCINTF.                            *
  2158*                            VMOD=2.017                          *
  2159*                                                                *
  2160*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2161*                                                                *
  2162*       LENGTH = 1024                                            *
  2163*                                                                *
  2164******************************************************************
  2165*                   C H A N G E   L O G
  2166*
  2167* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2168*-----------------------------------------------------------------
  2169*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2170* EFFECTIVE    NUMBER
  2171*-----------------------------------------------------------------
  2172* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2173******************************************************************
  2174 01  PROGRAM-INTERFACE-BLOCK.
  2175     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2176     12  PI-CALLING-PROGRAM              PIC X(8).
  2177     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2178     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2179     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2180     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2181     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2182     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2183     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2184     12  PI-COMPANY-ID                   PIC XXX.
  2185     12  PI-COMPANY-CD                   PIC X.
  2186
  2187     12  PI-COMPANY-PASSWORD             PIC X(8).
  2188
  2189     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2190
  2191     12  PI-CONTROL-IN-PROGRESS.
  2192         16  PI-CARRIER                  PIC X.
  2193         16  PI-GROUPING                 PIC X(6).
  2194         16  PI-STATE                    PIC XX.
  2195         16  PI-ACCOUNT                  PIC X(10).
  2196         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2197                                         PIC X(10).
  2198         16  PI-CLAIM-CERT-GRP.
  2199             20  PI-CLAIM-NO             PIC X(7).
  2200             20  PI-CERT-NO.
  2201                 25  PI-CERT-PRIME       PIC X(10).
  2202                 25  PI-CERT-SFX         PIC X.
  2203             20  PI-CERT-EFF-DT          PIC XX.
  2204         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2205             20  PI-PLAN-CODE            PIC X(2).
  2206             20  PI-REVISION-NUMBER      PIC X(3).
  2207             20  PI-PLAN-EFF-DT          PIC X(2).
  2208             20  PI-PLAN-EXP-DT          PIC X(2).
  2209             20  FILLER                  PIC X(11).
  2210         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  43
* EL6311.cbl
  2211             20  PI-OE-REFERENCE-1.
  2212                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2213                 25  PI-OE-REF-1-SUFF    PIC XX.
  2214
  2215     12  PI-SESSION-IN-PROGRESS          PIC X.
  2216         88  CLAIM-SESSION                   VALUE '1'.
  2217         88  CREDIT-SESSION                  VALUE '2'.
  2218         88  WARRANTY-SESSION                VALUE '3'.
  2219         88  MORTGAGE-SESSION                VALUE '4'.
  2220         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2221
  2222
  2223*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2224
  2225     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2226     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2227
  2228     12  PI-CREDIT-USER                  PIC X.
  2229         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2230         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2231
  2232     12  PI-CLAIM-USER                   PIC X.
  2233         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2234         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2235
  2236     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2237         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2238         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2239         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2240         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2241         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2242
  2243     12  PI-PROCESSOR-ID                 PIC X(4).
  2244
  2245     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2246
  2247     12  PI-MEMBER-CAPTION               PIC X(10).
  2248
  2249     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2250         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2251
  2252     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2253     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2254     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2255     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2256
  2257     12  PI-AH-OVERRIDE-L1               PIC X.
  2258     12  PI-AH-OVERRIDE-L2               PIC XX.
  2259     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2260     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2261
  2262     12  PI-NEW-SYSTEM                   PIC X(2).
  2263
  2264     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2265     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2266         88  PI-USES-PAID-TO                 VALUE '1'.
  2267     12  PI-CRDTCRD-SYSTEM.
  2268         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  44
* EL6311.cbl
  2269             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2270             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2271         16  PI-CC-MONTH-END-DT          PIC XX.
  2272     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2273
  2274     12  PI-OE-REFERENCE-2.
  2275         16  PI-OE-REF-2-PRIME           PIC X(10).
  2276         16  PI-OE-REF-2-SUFF            PIC X.
  2277
  2278     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2279
  2280     12  PI-LANGUAGE-TYPE                PIC X.
  2281             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2282             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2283             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2284
  2285     12  PI-POLICY-LINKAGE-IND           PIC X.
  2286         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2287         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2288                                                   LOW-VALUES.
  2289
  2290     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2291     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2292         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2293         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2294
  2295     12  PI-PROCESSOR-CSR-IND            PIC X.
  2296         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2297         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2298
  2299     12  FILLER                          PIC X(3).
  2300
  2301     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2302
  2303     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2304         PI-SYSTEM-LEVEL.
  2305
  2306         16  PI-ENTRY-CODES.
  2307             20  PI-ENTRY-CD-1           PIC X.
  2308             20  PI-ENTRY-CD-2           PIC X.
  2309
  2310         16  PI-RETURN-CODES.
  2311             20  PI-RETURN-CD-1          PIC X.
  2312             20  PI-RETURN-CD-2          PIC X.
  2313
  2314         16  PI-UPDATE-STATUS-SAVE.
  2315             20  PI-UPDATE-BY            PIC X(4).
  2316             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2317
  2318         16  PI-LOWER-CASE-LETTERS       PIC X.
  2319             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2320
  2321*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2322*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2323*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2324
  2325         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2326             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  45
* EL6311.cbl
  2327             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2328             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2329             88  ACCNT-CNTL                  VALUE '3'.
  2330             88  CARR-ACCNT-CNTL             VALUE '4'.
  2331
  2332         16  PI-PROCESSOR-CAP-LIST.
  2333             20  PI-SYSTEM-CONTROLS.
  2334                24 PI-SYSTEM-DISPLAY     PIC X.
  2335                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2336                24 PI-SYSTEM-MODIFY      PIC X.
  2337                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2338             20  FILLER                  PIC XX.
  2339             20  PI-DISPLAY-CAP          PIC X.
  2340                 88  DISPLAY-CAP             VALUE 'Y'.
  2341             20  PI-MODIFY-CAP           PIC X.
  2342                 88  MODIFY-CAP              VALUE 'Y'.
  2343             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2344                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2345             20  PI-FORCE-CAP            PIC X.
  2346                 88  FORCE-CAP               VALUE 'Y'.
  2347
  2348         16  PI-PROGRAM-CONTROLS.
  2349             20  PI-PGM-PRINT-OPT        PIC X.
  2350             20  PI-PGM-FORMAT-OPT       PIC X.
  2351             20  PI-PGM-PROCESS-OPT      PIC X.
  2352             20  PI-PGM-TOTALS-OPT       PIC X.
  2353
  2354         16  PI-HELP-INTERFACE.
  2355             20  PI-LAST-ERROR-NO        PIC X(4).
  2356             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2357
  2358         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2359             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2360
  2361         16  PI-CR-CONTROL-IN-PROGRESS.
  2362             20  PI-CR-CARRIER           PIC X.
  2363             20  PI-CR-GROUPING          PIC X(6).
  2364             20  PI-CR-STATE             PIC XX.
  2365             20  PI-CR-ACCOUNT           PIC X(10).
  2366             20  PI-CR-FIN-RESP          PIC X(10).
  2367             20  PI-CR-TYPE              PIC X.
  2368
  2369         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2370
  2371         16  PI-CR-MONTH-END-DT          PIC XX.
  2372
  2373         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2374             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2375             88  PI-ZERO-CARRIER             VALUE '1'.
  2376             88  PI-ZERO-GROUPING            VALUE '2'.
  2377             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2378
  2379         16  PI-CARRIER-SECURITY         PIC X.
  2380             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2381
  2382         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2383             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2384             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  46
* EL6311.cbl
  2385
  2386         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2387             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2388                                         INDEXED BY PI-ACCESS-NDX
  2389                                         PIC X.
  2390
  2391         16  PI-GA-BILLING-CONTROL       PIC X.
  2392             88  PI-GA-BILLING               VALUE '1'.
  2393
  2394         16  PI-MAIL-PROCESSING          PIC X.
  2395             88  PI-MAIL-YES                 VALUE 'Y'.
  2396
  2397         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2398
  2399         16  PI-AR-SYSTEM.
  2400             20  PI-AR-PROCESSING-CNTL   PIC X.
  2401                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2402             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2403             20  PI-AR-MONTH-END-DT      PIC XX.
  2404
  2405         16  PI-MP-SYSTEM.
  2406             20  PI-MORTGAGE-USER            PIC X.
  2407                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2408                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2409             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2410                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2411                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2412                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2413                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2414                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2415             20  PI-MP-MONTH-END-DT          PIC XX.
  2416             20  PI-MP-REFERENCE-NO.
  2417                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2418                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2419
  2420         16  PI-LABEL-CONTROL            PIC X(01).
  2421             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2422             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2423
  2424         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2425             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2426
  2427         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2428             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2429             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2430
  2431         16  FILLER                      PIC X(14).
  2432
  2433     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2434******************************************************************
  2435
  2436     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2437*    COPY ELC631PI.
  2438******************************************************************
  2439*                                                                *
  2440*                                                                *
  2441*                            ELC631PI                            *
  2442*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  47
* EL6311.cbl
  2443*                                                                *
  2444*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2445*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2446*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2447*                                                                *
  2448*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2449*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2450*    BETWEEN PROGRAMS.                                           *
  2451*                                                                *
  2452*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2453*                                                                *
  2454*               EL631 - EL6311 - EL6312 - EL6313                 *
  2455*                                                                *
  2456******************************************************************
  2457
  2458         16  PI-631-DATA.
  2459             20  PI-ERPNDB-KEY.
  2460                 24  PI-PB-COMPANY-CD     PIC X.
  2461                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2462                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2463                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2464
  2465             20  PI-ERPNDB-ALT-KEY.
  2466                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2467                 24  PI-PB-CARRIER        PIC X.
  2468                 24  PI-PB-GROUPING       PIC X(6).
  2469                 24  PI-PB-STATE          PIC XX.
  2470                 24  PI-PB-ACCOUNT        PIC X(10).
  2471                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2472                 24  PI-PB-CERT-NO.
  2473                     28  PI-PB-CERT-PRIME PIC X(10).
  2474                     28  PI-PB-CERT-SFX   PIC X.
  2475                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2476                 24  PI-PB-RECORD-TYPE    PIC X.
  2477
  2478             20  PI-ERPNDB-CSR-KEY.
  2479                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2480                 24  PI-PB-CSR-ID             PIC X(4).
  2481                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2482                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2483                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2484
  2485             20  PI-BROWSE-TYPE               PIC X.
  2486                 88  PI-FILE-BROWSE             VALUE ' '.
  2487                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2488                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2489                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2490                 88  PI-CSR-BROWSE              VALUE '4'.
  2491
  2492             20  PI-MAINT-FUNCTION            PIC X.
  2493                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2494                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2495                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2496                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2497                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2498                 88  PI-PF5-FUNCTION            VALUE '5'.
  2499                 88  PI-PF6-FUNCTION            VALUE '6'.
  2500
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  48
* EL6311.cbl
  2501             20  PI-FILE-SWITCHES.
  2502                 24  PI-ALL-ISSUES-SW         PIC X.
  2503                     88  ALL-ISSUES             VALUE 'Y'.
  2504                 24  PI-ALL-CANCELS-SW        PIC X.
  2505                     88  ALL-CANCELS            VALUE 'Y'.
  2506                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2507                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2508                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2509                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2510                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2511                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2512                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2513                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2514                 24  PI-HOLD-REC-SW           PIC X.
  2515                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2516                 24  PI-CHANGE-REC-SW         PIC X.
  2517                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2518                 24  PI-CHK-REQ-REC-SW        PIC X.
  2519                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2520                 24  PI-ISSUE-WARNING-SW      PIC X.
  2521                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2522                 24  PI-CANCEL-WARNING-SW     PIC X.
  2523                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2524             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2525                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2526             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2527                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2528
  2529             20  PI-MAP-NAME                  PIC X(8).
  2530
  2531             20  PI-CURSOR                    PIC S9(4) COMP.
  2532
  2533             20  PI-PREV-ALT-KEY              PIC X(36).
  2534             20  PI-PREV-CSR-KEY              PIC X(15).
  2535             20  PI-PREV-KEY.
  2536                 24  PI-PREV-COMPANY-CD       PIC X.
  2537                 24  PI-PREV-BATCH            PIC X(6).
  2538                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2539                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2540             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2541             20  PI-BROWSE-SW                 PIC X.
  2542                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2543                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2544             20  PI-SV-CARRIER                PIC X.
  2545             20  PI-SV-GROUPING               PIC X(6).
  2546             20  PI-SV-STATE                  PIC XX.
  2547             20  PI-EDIT-SW                   PIC X.
  2548             20  PI-DISPLAY-SW                PIC XX.
  2549                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
  2550                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2551             20  PI-CRITERIA-DATA             PIC X(350).
  2552             20  PI-BMODE                     PIC X.
  2553             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2554             20  PI-BPMTS                     PIC S999     COMP-3.
  2555             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2556             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2557             20  PI-CSR-SESSION-SW            PIC X.
  2558                 88  CSR-EDIT-SESSION           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  49
* EL6311.cbl
  2559             20  PI-ERRORS-SW                 PIC X.
  2560                 88  FATAL-ERRORS               VALUE 'X'.
  2561*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2562             20  FILLER                       PIC X(5).
  2563
  2564        16  FILLER             PIC X(94).
  2565
  2566 01  W-LETTER-COMMUNICATION-AREAS.
  2567*    COPY ELC1042.
  2568******************************************************************
  2569*                                                                *
  2570*                                                                *
  2571*                           ELC1042                              *
  2572*                            VMOD=2.002                          *
  2573*                                                                *
  2574*    NOTE                                                        *
  2575*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2576*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2577*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2578*        TO THESE PROGRAMS.                                      *
  2579*                                                                *
  2580*    NOTE                                                        *
  2581*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2582*        USE ONLY!                                               *
  2583*                                                                *
  2584******************************************************************
  2585
  2586         16  PI-1042-WA.
  2587             20  PI-ACTION       PIC  X(01).
  2588                 88 PI-SHOW-MODE           VALUE '1'.
  2589                 88 PI-CLEAR-MODE          VALUE '2'.
  2590                 88 PI-CREATE-MODE         VALUE '3'.
  2591             20  PI-COMM-CONTROL PIC  X(12).
  2592             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2593             20  PI-EOF-SW       PIC  X(01).
  2594                 88  PI-FILE-EOF           VALUE 'Y'.
  2595             20  PI-FILETYP      PIC  X(01).
  2596             20  PI-FORM-SQUEEZE-CONTROL
  2597                                 PIC  X(01).
  2598                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2599                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2600             20  PI-LAST-CONTROL PIC  X(12).
  2601             20  PI-TEMP-STOR-ITEMS
  2602                                 PIC S9(04) COMP.
  2603             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2604             20  PI-UPDATE-SW    PIC  9(01).
  2605                 88 ANY-UPDATES            VALUE 1.
  2606             20  PI-104-SCREEN-SENT-IND
  2607                                 PIC  X(01).
  2608                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2609                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2610             20  PI-1042-SCREEN-SENT-IND
  2611                                 PIC  X(01).
  2612                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2613                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2614             20  PI-1042-ARCHIVE-IND
  2615                                 PIC  X(01).
  2616                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  50
* EL6311.cbl
  2617             20  FILLER          PIC  X(29).
  2618*    COPY ELC689PI.
  2619******************************************************************
  2620*                                                                *
  2621*                            ELC689PI                            *
  2622*                            VMOD=2.003                          *
  2623*                                                                *
  2624*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2625*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2626*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2627*                                                                *
  2628*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2629*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2630*    BETWEEN PROGRAMS.                                           *
  2631*                                                                *
  2632*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2633*                                                                *
  2634*               EL631 - EL689  - EL6891 - EL6892                 *
  2635*                                                                *
  2636******************************************************************
  2637*                   C H A N G E   L O G
  2638*
  2639* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2640*-----------------------------------------------------------------
  2641*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2642* EFFECTIVE    NUMBER
  2643*-----------------------------------------------------------------
  2644* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2645* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2646* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2647******************************************************************
  2648
  2649
  2650         16  PI-689-WORK-AREA.
  2651             20  PI-689-ALT-PRINTER-ID
  2652                                 PIC  X(04).
  2653             20  PI-689-ARCHIVE-NUMBER
  2654                                 PIC  9(08).
  2655             20  PI-689-ARCHIVE-SW
  2656                                 PIC  X(01).
  2657                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2658             20  PI-689-DATA-SOURCE
  2659                                 PIC  X(01).
  2660                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2661                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2662                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2663                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  2664                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2665             20  PI-689-ERROR-IND
  2666                                 PIC  X(01).
  2667                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2668             20  PI-689-ERROR    PIC  9(04).
  2669                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2670                 88  PI-689-FATAL-ERROR
  2671                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2672                            0042 0047 0051 0066 0067 0070
  2673                            0168 0169 0174 0175 0176 0177 0179
  2674                            0180 0181 0182 0184 0185 0189 0190
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  51
* EL6311.cbl
  2675                            0191
  2676                            0215 0279 0280
  2677                            0412 0413 0454
  2678                            0533 0537
  2679                            2055 2114 2208 2209 2216 2232 2369
  2680                            2398 2433 2908 2999
  2681                            3000 3770 3771 3775
  2682                            7250 7365 7367 7368 7369 7370 7371
  2683                            7272 7373 7374 7376 7377 7378 7379
  2684                            7381 7388 7390 7393 7395 7396 7398
  2685                            9095 9096 9281 9298 9299 9320 9327
  2686                            9426 9427.
  2687                 88  PI-689-STOP-ERROR
  2688                     VALUES 0004 0008 0013 0023 0029 0033
  2689                            0042 0047 0066 0067 0070
  2690                            0168 0169 0174 0175 0176 0177
  2691                            0181 0182 0184 0185 0189 0190
  2692                            0279 0280
  2693                            0412 0413 0454
  2694                            2055 2208 2209 2216 2232
  2695                            2398 2999
  2696                            3000 3770 3771 3775
  2697                            7250 7365 7369 7370 7371
  2698                            7272 7373 7374 7376 7377 7378 7379
  2699                            7381 7388 7390 7393 7396 7398
  2700                            9095 9096 9299 9320 9426.
  2701             20  PI-689-FOLLOW-UP-DATE
  2702                                 PIC  X(02).
  2703             20  PI-689-FORM-NUMBER
  2704                                 PIC  X(04).
  2705             20  PI-689-LABEL-SOURCE
  2706                                 PIC X(01).
  2707                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2708                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2709                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2710                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2711                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2712                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2713                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2714             20  PI-689-NUMBER-COPIES
  2715                                 PIC  9(01).
  2716             20  PI-689-NUMBER-LABEL-LINES
  2717                                 PIC  9(01).
  2718             20  PI-689-NUMBER-TEXT-RECORDS
  2719                                 PIC  9(03).
  2720             20  PI-689-PRINT-ORDER-SW
  2721                                 PIC  X(01).
  2722                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2723                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2724                 88  PI-689-PRINT-LATER     VALUE '3'.
  2725                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2726             20  PI-689-PRINT-RESTRICTION
  2727                                 PIC  X(01).
  2728                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2729                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2730                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2731             20  PI-689-PRINT-SW PIC  X(01).
  2732                 88  PI-689-PRINT-PERFORMED VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  52
* EL6311.cbl
  2733             20  PI-689-RESEND-DATE-1
  2734                                 PIC  X(02).
  2735             20  PI-689-RESEND-LETR-1
  2736                                 PIC X(4).
  2737             20  PI-689-TEMP-STOR-ID
  2738                                 PIC  X(08).
  2739             20  PI-689-USE-SCREEN-IND
  2740                                 PIC  X(01).
  2741                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2742             20  PI-689-ARCH-POINTER
  2743                                 PIC S9(08) COMP.
  2744                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2745             20  PI-689-ARCT-POINTER
  2746                                 PIC S9(08) COMP.
  2747                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2748             20  PI-689-VARIABLE-DATA-GRP.
  2749                 24  PI-689-VARIABLE-DATA-1
  2750                                 PIC  X(30).
  2751                 24  PI-689-VARIABLE-DATA-2
  2752                                 PIC  X(30).
  2753                 24  PI-689-VARIABLE-DATA-3
  2754                                 PIC  X(30).
  2755                 24  PI-689-VARIABLE-DATA-4
  2756                                 PIC  X(30).
  2757
  2758         16  PI-689-KEY-DATA-FIELDS.
  2759             20  PI-689-ACCOUNT  PIC  X(10).
  2760             20  PI-689-CARRIER  PIC  X(01).
  2761             20  PI-689-CERT-NO.
  2762                 24  PI-689-CERT-PRIME
  2763                                 PIC  X(10).
  2764                 24  PI-689-CERT-SFX
  2765                                 PIC  X(01).
  2766             20  PI-689-CHG-SEQ-NO
  2767                                 PIC S9(04)    COMP.
  2768             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2769                                 PIC  X(02).
  2770             20  PI-689-ENTRY-BATCH
  2771                                 PIC  X(06).
  2772             20  PI-689-EFF-DATE PIC  X(02).
  2773             20  PI-689-EXP-DATE PIC  X(02).
  2774             20  PI-689-GROUPING PIC  X(06).
  2775             20  PI-689-RESP-PERSON
  2776                                 PIC  X(10).
  2777             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2778             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2779                                 PIC  X(04).
  2780             20  PI-689-STATE    PIC  X(02).
  2781             20  PI-689-TYPE     PIC  X(01).
  2782             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2783             20  PI-689-ALT-SEQ-NO
  2784                                 PIC S9(04)    COMP.
  2785         16  PI-689-DATE-EDIT    PIC  X(08).
  2786         16  PI-689-FOLLOW-UP-EDIT
  2787                                 PIC  X(08).
  2788         16  PI-689-RESEND1-EDIT PIC  X(08).
  2789         16  PI-689-SEQ-EDIT     PIC  X(08).
  2790         16  PI-689-BCSEQ-EDIT   PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  53
* EL6311.cbl
  2791         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2792             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2793         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2794         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  54
* EL6311.cbl
  2796
  2797 01  WS-EL6315-PASS-AREA.
  2798        16  PI-6315-ISS-CAN-SW      PIC X.
  2799        16  FILLER                  PIC X(120).
  2800        16  PI-RES-REF-CLM-TYPE     PIC X.
  2801        16  FILLER                  PIC X.
  2802        16  PI-6315-PASS-AREA.
  2803            20 FILLER               PIC X(236).
  2804            20 PI-6315-FINALIZED    PIC X.
  2805            20 FILLER               PIC X(280).
  2806
  2807 01  WS-EL6316-PASS-AREA.
  2808        16  PI-ISS-CAN-SW           PIC X.
  2809        16  FILLER                  PIC X(121).
  2810        16  PI-CLM-RESC-IND         PIC X.
  2811        16  PI-6316-PASS-AREA.
  2812            20 FILLER               PIC X(236).
  2813            20 PI-6316-FINALIZED    PIC X.
  2814            20 FILLER               PIC X(280).
  2815
  2816******************************************************************
  2817*                                                                *
  2818*         P A S S   A R E A   F O R   E D I T                    *
  2819*                                                                *
  2820******************************************************************
  2821
  2822 01  PASSED-RECORD.
  2823     12  RECORD-SAVE                  PIC X(585).
  2824* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2825*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2826*                    BY  WK-CURRENT-DATE.
  2827******************************************************************
  2828*                                                                *
  2829*                                                                *
  2830*                             ELC50W1                            *
  2831*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2832*                            VMOD=2.004                          *
  2833*                                                                *
  2834*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2835*                                                                *
  2836*                                                                *
  2837******************************************************************
  2838
  2839     12  WK-WORK-AREA.
  2840         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2841         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2842         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2843         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2844         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2845         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2846         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2847         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2848         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2849         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2850         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2851         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2852         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2853         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  55
* EL6311.cbl
  2854         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2855         16  WK-CREDIT-EDIT-CONTROLS.
  2856             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2857             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2858             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2859             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2860             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2861             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2862         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2863         16  WK-SAVE-REIN-DATA.
  2864             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2865             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2866             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2867         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2868             88  ENTRY-FROM-EL6311       VALUE '6'.
  2869         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2870         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2871     12  WK-RECORD-ADDRESSES.
  2872         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2873         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2874         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2875         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2876         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2877         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2878         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2879         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2880     12  WK-OVER-SHORT-AREA.
  2881         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  2882         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  2883         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  2884             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  2885         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  56
* EL6311.cbl
  2887
  2888*    COPY ELCEDITC.
  2889******************************************************************
  2890*                                                                *
  2891*                                                                *
  2892*                            ELCEDITC                            *
  2893*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2894*                            VMOD=2.012                          *
  2895*                                                                *
  2896*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  2897*                     EL6313, EL050 AND EL517.                   *
  2898*                                                                *
  2899******************************************************************
  2900******************************************************************
  2901*                   C H A N G E   L O G
  2902*
  2903* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2904*-----------------------------------------------------------------
  2905*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2906* EFFECTIVE    NUMBER
  2907*-----------------------------------------------------------------
  2908* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2909******************************************************************
  2910
  2911     12  EDIT-CRITERIA-DATA.
  2912         16  EC-CO-MONTH-END-DT       PIC XX.
  2913         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  2914         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  2915         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  2916         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  2917         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  2918         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  2919         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  2920         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  2921         16  EC-CO-REM-TERM-CALC      PIC X.
  2922               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  2923               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  2924               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  2925               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  2926
  2927         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  2928               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  2929               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  2930               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  2931               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  2932               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  2933               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  2934               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  2935               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  2936               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  2937               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  2938
  2939         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  2940               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  2941               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  2942               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  2943               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  2944               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  57
* EL6311.cbl
  2945               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  2946               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  2947               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  2948
  2949         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  2950                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  2951                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  2952
  2953         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  2954                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  2955                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  2956                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  2957                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  2958                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  2959                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  2960                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  2961                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  2962
  2963         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  2964               88  EC-BR-REDUCING                   VALUE 'R'.
  2965               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  2966
  2967         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  2968         16  EC-BR-LF-DESC             PIC X(10).
  2969         16  EC-BR-AH-DESC             PIC X(10).
  2970         16  EC-BR-LF-COMMENT          PIC X(10).
  2971         16  EC-BR-AH-COMMENT          PIC X(10).
  2972
  2973         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  2974               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  2975               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  2976               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  2977               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  2978
  2979         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  2980               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  2981               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  2982               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  2983               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  2984
  2985         16  EC-BR-LF-REFUND-CALC      PIC X.
  2986                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  2987                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  2988                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  2989                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  2990                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  2991                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  2992                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  2993
  2994         16  EC-BR-AH-REFUND-CALC      PIC X.
  2995                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  2996                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  2997                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  2998                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  2999                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3000                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3001                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3002                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  58
* EL6311.cbl
  3003
  3004         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3005                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3006                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3007                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3008
  3009         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3010                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3011                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3012                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3013
  3014         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3015         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3016         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3017         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3018
  3019         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3020         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3021                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3022                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3023                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3024                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3025
  3026         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3027               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3028               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3029               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3030               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3031               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3032
  3033         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3034               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3035               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3036               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3037               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3038               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3039
  3040         16  EC-ST-LF-REFUND-CALC      PIC X.
  3041                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3042                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3043                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3044                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3045                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3046                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3047                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3048                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3049
  3050         16  EC-ST-AH-REFUND-CALC      PIC X.
  3051                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3052                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3053                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3054                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3055                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3056                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3057                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3058                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3059
  3060         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  59
* EL6311.cbl
  3061         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3062         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3063         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3064         16  EC-AM-EXPIRATION-DT       PIC XX.
  3065         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3066         16  EC-AM-CLASS-CD            PIC XX.
  3067         16  EC-AM-LF-DEVIATION        PIC XXX.
  3068         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3069         16  EC-AM-AH-DEVIATION        PIC XXX.
  3070         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3071         16  EC-AM-PHONE-NO            PIC X(10).
  3072
  3073         16  EC-AM-LF-REFUND-CALC      PIC X.
  3074                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3075                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3076                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3077                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3078                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3079                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3080                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3081
  3082         16  EC-AM-AH-REFUND-CALC      PIC X.
  3083                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3084                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3085                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3086                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3087                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3088                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3089                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3090
  3091         16  EC-AM-BEN-I-G-CD          PIC X.
  3092                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3093                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3094                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3095
  3096         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3097         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3098         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3099         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3100         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3101         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3102         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3103         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3104         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3105
  3106         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3107         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3108         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3109         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3110         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3111         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3112         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3113         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3114         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3115         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3116         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3117         16  EC-RT-LF-NSP-ST           PIC XX.
  3118         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  60
* EL6311.cbl
  3119         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3120         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3121
  3122         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3123             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3124                                             'M' '5' '9' '2'.
  3125             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3126             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3127             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3128             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3129             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3130             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3131             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3132             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3133             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3134             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3135
  3136         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3137             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3138                                             'M' '5' '9' '2'.
  3139             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3140             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3141             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3142             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3143             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3144             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3145             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3146             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3147             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3148             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3149
  3150         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3151         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3152         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3153         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3154         16  EC-CM-DEATH-DT            PIC XX.
  3155
  3156*DMD CUSTOM CODING FIELDS BELOW
  3157*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3158         16  EC-BR-DMD-RATING-SW       PIC X.
  3159                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3160                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3161                 88  NO-DMD-RATING               VALUE 'N'.
  3162
  3163         16  EC-NEW-CERT               PIC X(11).
  3164         16  EC-NEW-STATE              PIC XX.
  3165         16  FILLER                    PIC X.
  3166*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3167         16  OVER-SHORT-EDIT-FIELDS.
  3168             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3169             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3170             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3171             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3172             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3173             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3174             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3175             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3176             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  61
* EL6311.cbl
  3177         16  FILLER                    PIC X(71).
  3178
  3179******************************************************************
  3180
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  62
* EL6311.cbl
  3182
  3183*    COPY ELCJPFX.
  3184******************************************************************
  3185*                                                                *
  3186*                                                                *
  3187*                            ELCJPFX.                            *
  3188*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3189*                            VMOD=2.002                          *
  3190*                                                                *
  3191*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3192*                                                                *
  3193*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3194*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3195*        ELCNTL - CONTROL FILE                                   *
  3196*        ELMSTR - CLAIM MASTERS                                  *
  3197*        ELTRLR - ACTIVITY TRAILERS                              *
  3198*        ELCHKQ - CHECK QUE                                      *
  3199******************************************************************
  3200 01  JOURNAL-RECORD.
  3201     12  JP-USER-ID                  PIC X(4).
  3202     12  JP-FILE-ID                  PIC X(8).
  3203     12  JP-PROGRAM-ID               PIC X(8).
  3204     12  JP-RECORD-TYPE              PIC X.
  3205         88 JP-ADD              VALUE 'A'.
  3206         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3207         88 JP-AFTER-CHANGE     VALUE 'C'.
  3208         88 JP-DELETE           VALUE 'D'.
  3209         88 JP-GENERIC-DELETE   VALUE 'G'.
  3210         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3211         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3212     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3213     12  JP-RECORD-AREA
  3214
  3215
  3216                             PIC X(608).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  63
* EL6311.cbl
  3218*    COPY ELCAID.
  3219******************************************************************
  3220*                                                                *
  3221*                            ELCAID.                             *
  3222*                            VMOD=2.001                          *
  3223*                                                                *
  3224*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3225*                                                                *
  3226*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3227*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3228******************************************************************
  3229
  3230 01  DFHAID.
  3231   02  DFHNULL   PIC  X  VALUE  ' '.
  3232   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3233   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3234   02  DFHPEN    PIC  X  VALUE  '='.
  3235   02  DFHOPID   PIC  X  VALUE  'W'.
  3236   02  DFHPA1    PIC  X  VALUE  '%'.
  3237   02  DFHPA2    PIC  X  VALUE  '>'.
  3238   02  DFHPA3    PIC  X  VALUE  ','.
  3239   02  DFHPF1    PIC  X  VALUE  '1'.
  3240   02  DFHPF2    PIC  X  VALUE  '2'.
  3241   02  DFHPF3    PIC  X  VALUE  '3'.
  3242   02  DFHPF4    PIC  X  VALUE  '4'.
  3243   02  DFHPF5    PIC  X  VALUE  '5'.
  3244   02  DFHPF6    PIC  X  VALUE  '6'.
  3245   02  DFHPF7    PIC  X  VALUE  '7'.
  3246   02  DFHPF8    PIC  X  VALUE  '8'.
  3247   02  DFHPF9    PIC  X  VALUE  '9'.
  3248   02  DFHPF10   PIC  X  VALUE  ':'.
  3249   02  DFHPF11   PIC  X  VALUE  '#'.
  3250   02  DFHPF12   PIC  X  VALUE  '@'.
  3251   02  DFHPF13   PIC  X  VALUE  'A'.
  3252   02  DFHPF14   PIC  X  VALUE  'B'.
  3253   02  DFHPF15   PIC  X  VALUE  'C'.
  3254   02  DFHPF16   PIC  X  VALUE  'D'.
  3255   02  DFHPF17   PIC  X  VALUE  'E'.
  3256   02  DFHPF18   PIC  X  VALUE  'F'.
  3257   02  DFHPF19   PIC  X  VALUE  'G'.
  3258   02  DFHPF20   PIC  X  VALUE  'H'.
  3259   02  DFHPF21   PIC  X  VALUE  'I'.
  3260*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3261   02  DFHPF22   PIC  X  VALUE  '['.
  3262   02  DFHPF23   PIC  X  VALUE  '.'.
  3263   02  DFHPF24   PIC  X  VALUE  '<'.
  3264   02  DFHMSRE   PIC  X  VALUE  'X'.
  3265   02  DFHSTRF   PIC  X  VALUE  'h'.
  3266   02  DFHTRIG   PIC  X  VALUE  '"'.
  3267
  3268 01  FILLER    REDEFINES DFHAID.
  3269     12  FILLER              PIC X(8).
  3270     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3271
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  64
* EL6311.cbl
  3273*    COPY EL6311S.
  3274 01  EL631BI.
  3275     05  FILLER            PIC  X(0012).
  3276*    -------------------------------
  3277     05  BDATEL PIC S9(0004) COMP.
  3278     05  BDATEF PIC  X(0001).
  3279     05  FILLER REDEFINES BDATEF.
  3280         10  BDATEA PIC  X(0001).
  3281     05  BDATEI PIC  X(0008).
  3282*    -------------------------------
  3283     05  BTIMEL PIC S9(0004) COMP.
  3284     05  BTIMEF PIC  X(0001).
  3285     05  FILLER REDEFINES BTIMEF.
  3286         10  BTIMEA PIC  X(0001).
  3287     05  BTIMEI PIC  X(0005).
  3288*    -------------------------------
  3289     05  BHEADL PIC S9(0004) COMP.
  3290     05  BHEADF PIC  X(0001).
  3291     05  FILLER REDEFINES BHEADF.
  3292         10  BHEADA PIC  X(0001).
  3293     05  BHEADI PIC  X(0038).
  3294*    -------------------------------
  3295     05  BNCERTLL PIC S9(0004) COMP.
  3296     05  BNCERTLF PIC  X(0001).
  3297     05  FILLER REDEFINES BNCERTLF.
  3298         10  BNCERTLA PIC  X(0001).
  3299     05  BNCERTLI PIC  X(0008).
  3300*    -------------------------------
  3301     05  BNCERTL PIC S9(0004) COMP.
  3302     05  BNCERTF PIC  X(0001).
  3303     05  FILLER REDEFINES BNCERTF.
  3304         10  BNCERTA PIC  X(0001).
  3305     05  BNCERTI PIC  X(0011).
  3306*    -------------------------------
  3307     05  BNSTATLL PIC S9(0004) COMP.
  3308     05  BNSTATLF PIC  X(0001).
  3309     05  FILLER REDEFINES BNSTATLF.
  3310         10  BNSTATLA PIC  X(0001).
  3311     05  BNSTATLI PIC  X(0009).
  3312*    -------------------------------
  3313     05  BNSTATL PIC S9(0004) COMP.
  3314     05  BNSTATF PIC  X(0001).
  3315     05  FILLER REDEFINES BNSTATF.
  3316         10  BNSTATA PIC  X(0001).
  3317     05  BNSTATI PIC  X(0002).
  3318*    -------------------------------
  3319     05  BCHGTL PIC S9(0004) COMP.
  3320     05  BCHGTF PIC  X(0001).
  3321     05  FILLER REDEFINES BCHGTF.
  3322         10  BCHGTA PIC  X(0001).
  3323     05  BCHGTI PIC  X(0004).
  3324*    -------------------------------
  3325     05  BCHGL PIC S9(0004) COMP.
  3326     05  BCHGF PIC  X(0001).
  3327     05  FILLER REDEFINES BCHGF.
  3328         10  BCHGA PIC  X(0001).
  3329     05  BCHGI PIC  X(0004).
  3330*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  65
* EL6311.cbl
  3331     05  BMAINTL PIC S9(0004) COMP.
  3332     05  BMAINTF PIC  X(0001).
  3333     05  FILLER REDEFINES BMAINTF.
  3334         10  BMAINTA PIC  X(0001).
  3335     05  BMAINTI PIC  X(0001).
  3336*    -------------------------------
  3337     05  BMANTBYL PIC S9(0004) COMP.
  3338     05  BMANTBYF PIC  X(0001).
  3339     05  FILLER REDEFINES BMANTBYF.
  3340         10  BMANTBYA PIC  X(0001).
  3341     05  BMANTBYI PIC  X(0004).
  3342*    -------------------------------
  3343     05  BCHGHDGL PIC S9(0004) COMP.
  3344     05  BCHGHDGF PIC  X(0001).
  3345     05  FILLER REDEFINES BCHGHDGF.
  3346         10  BCHGHDGA PIC  X(0001).
  3347     05  BCHGHDGI PIC  X(0003).
  3348*    -------------------------------
  3349     05  BMANTDTL PIC S9(0004) COMP.
  3350     05  BMANTDTF PIC  X(0001).
  3351     05  FILLER REDEFINES BMANTDTF.
  3352         10  BMANTDTA PIC  X(0001).
  3353     05  BMANTDTI PIC  X(0008).
  3354*    -------------------------------
  3355     05  BMANTATL PIC S9(0004) COMP.
  3356     05  BMANTATF PIC  X(0001).
  3357     05  FILLER REDEFINES BMANTATF.
  3358         10  BMANTATA PIC  X(0001).
  3359     05  BMANTATI PIC  X(0005).
  3360*    -------------------------------
  3361     05  BCSRL PIC S9(0004) COMP.
  3362     05  BCSRF PIC  X(0001).
  3363     05  FILLER REDEFINES BCSRF.
  3364         10  BCSRA PIC  X(0001).
  3365     05  BCSRI PIC  X(0004).
  3366*    -------------------------------
  3367     05  BBATCHL PIC S9(0004) COMP.
  3368     05  BBATCHF PIC  X(0001).
  3369     05  FILLER REDEFINES BBATCHF.
  3370         10  BBATCHA PIC  X(0001).
  3371     05  BBATCHI PIC  X(0006).
  3372*    -------------------------------
  3373     05  BSEQL PIC S9(0004) COMP.
  3374     05  BSEQF PIC  X(0001).
  3375     05  FILLER REDEFINES BSEQF.
  3376         10  BSEQA PIC  X(0001).
  3377     05  BSEQI PIC  X(0004).
  3378*    -------------------------------
  3379     05  BMOENDTL PIC S9(0004) COMP.
  3380     05  BMOENDTF PIC  X(0001).
  3381     05  FILLER REDEFINES BMOENDTF.
  3382         10  BMOENDTA PIC  X(0001).
  3383     05  BMOENDTI PIC  X(0008).
  3384*    -------------------------------
  3385     05  BCARRL PIC S9(0004) COMP.
  3386     05  BCARRF PIC  X(0001).
  3387     05  FILLER REDEFINES BCARRF.
  3388         10  BCARRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  66
* EL6311.cbl
  3389     05  BCARRI PIC  X(0001).
  3390*    -------------------------------
  3391     05  BGROUPL PIC S9(0004) COMP.
  3392     05  BGROUPF PIC  X(0001).
  3393     05  FILLER REDEFINES BGROUPF.
  3394         10  BGROUPA PIC  X(0001).
  3395     05  BGROUPI PIC  X(0006).
  3396*    -------------------------------
  3397     05  BSTATEL PIC S9(0004) COMP.
  3398     05  BSTATEF PIC  X(0001).
  3399     05  FILLER REDEFINES BSTATEF.
  3400         10  BSTATEA PIC  X(0001).
  3401     05  BSTATEI PIC  X(0002).
  3402*    -------------------------------
  3403     05  BACCTL PIC S9(0004) COMP.
  3404     05  BACCTF PIC  X(0001).
  3405     05  FILLER REDEFINES BACCTF.
  3406         10  BACCTA PIC  X(0001).
  3407     05  BACCTI PIC  X(0010).
  3408*    -------------------------------
  3409     05  BVINHL PIC S9(0004) COMP.
  3410     05  BVINHF PIC  X(0001).
  3411     05  FILLER REDEFINES BVINHF.
  3412         10  BVINHA PIC  X(0001).
  3413     05  BVINHI PIC  X(0004).
  3414*    -------------------------------
  3415     05  BVINL PIC S9(0004) COMP.
  3416     05  BVINF PIC  X(0001).
  3417     05  FILLER REDEFINES BVINF.
  3418         10  BVINA PIC  X(0001).
  3419     05  BVINI PIC  X(0017).
  3420*    -------------------------------
  3421     05  BREFHDGL PIC S9(0004) COMP.
  3422     05  BREFHDGF PIC  X(0001).
  3423     05  FILLER REDEFINES BREFHDGF.
  3424         10  BREFHDGA PIC  X(0001).
  3425     05  BREFHDGI PIC  X(0004).
  3426*    -------------------------------
  3427     05  BREFL PIC S9(0004) COMP.
  3428     05  BREFF PIC  X(0001).
  3429     05  FILLER REDEFINES BREFF.
  3430         10  BREFA PIC  X(0001).
  3431     05  BREFI PIC  X(0012).
  3432*    -------------------------------
  3433     05  BCERTNOL PIC S9(0004) COMP.
  3434     05  BCERTNOF PIC  X(0001).
  3435     05  FILLER REDEFINES BCERTNOF.
  3436         10  BCERTNOA PIC  X(0001).
  3437     05  BCERTNOI PIC  X(0010).
  3438*    -------------------------------
  3439     05  BSUFIXL PIC S9(0004) COMP.
  3440     05  BSUFIXF PIC  X(0001).
  3441     05  FILLER REDEFINES BSUFIXF.
  3442         10  BSUFIXA PIC  X(0001).
  3443     05  BSUFIXI PIC  X(0001).
  3444*    -------------------------------
  3445     05  BEFFDTL PIC S9(0004) COMP.
  3446     05  BEFFDTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  67
* EL6311.cbl
  3447     05  FILLER REDEFINES BEFFDTF.
  3448         10  BEFFDTA PIC  X(0001).
  3449     05  BEFFDTI PIC  X(0008).
  3450*    -------------------------------
  3451     05  BLSTNML PIC S9(0004) COMP.
  3452     05  BLSTNMF PIC  X(0001).
  3453     05  FILLER REDEFINES BLSTNMF.
  3454         10  BLSTNMA PIC  X(0001).
  3455     05  BLSTNMI PIC  X(0015).
  3456*    -------------------------------
  3457     05  B1STNML PIC S9(0004) COMP.
  3458     05  B1STNMF PIC  X(0001).
  3459     05  FILLER REDEFINES B1STNMF.
  3460         10  B1STNMA PIC  X(0001).
  3461     05  B1STNMI PIC  X(0010).
  3462*    -------------------------------
  3463     05  BINITL PIC S9(0004) COMP.
  3464     05  BINITF PIC  X(0001).
  3465     05  FILLER REDEFINES BINITF.
  3466         10  BINITA PIC  X(0001).
  3467     05  BINITI PIC  X(0001).
  3468*    -------------------------------
  3469     05  BSEXL PIC S9(0004) COMP.
  3470     05  BSEXF PIC  X(0001).
  3471     05  FILLER REDEFINES BSEXF.
  3472         10  BSEXA PIC  X(0001).
  3473     05  BSEXI PIC  X(0001).
  3474*    -------------------------------
  3475     05  BAGEL PIC S9(0004) COMP.
  3476     05  BAGEF PIC  X(0001).
  3477     05  FILLER REDEFINES BAGEF.
  3478         10  BAGEA PIC  X(0001).
  3479     05  BAGEI PIC  X(0002).
  3480*    -------------------------------
  3481     05  BBIRTHL PIC S9(0004) COMP.
  3482     05  BBIRTHF PIC  X(0001).
  3483     05  FILLER REDEFINES BBIRTHF.
  3484         10  BBIRTHA PIC  X(0001).
  3485     05  BBIRTHI PIC  X(0008).
  3486*    -------------------------------
  3487     05  B1STPMTL PIC S9(0004) COMP.
  3488     05  B1STPMTF PIC  X(0001).
  3489     05  FILLER REDEFINES B1STPMTF.
  3490         10  B1STPMTA PIC  X(0001).
  3491     05  B1STPMTI PIC  X(0008).
  3492*    -------------------------------
  3493     05  BDAYSL PIC S9(0004) COMP.
  3494     05  BDAYSF PIC  X(0001).
  3495     05  FILLER REDEFINES BDAYSF.
  3496         10  BDAYSA PIC  X(0001).
  3497     05  BDAYSI PIC  X(0003).
  3498*    -------------------------------
  3499     05  BLNTRML PIC S9(0004) COMP.
  3500     05  BLNTRMF PIC  X(0001).
  3501     05  FILLER REDEFINES BLNTRMF.
  3502         10  BLNTRMA PIC  X(0001).
  3503     05  BLNTRMI PIC  X(0003).
  3504*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  68
* EL6311.cbl
  3505     05  BLNOFCRL PIC S9(0004) COMP.
  3506     05  BLNOFCRF PIC  X(0001).
  3507     05  FILLER REDEFINES BLNOFCRF.
  3508         10  BLNOFCRA PIC  X(0001).
  3509     05  BLNOFCRI PIC  X(0005).
  3510*    -------------------------------
  3511     05  BMODEL PIC S9(0004) COMP.
  3512     05  BMODEF PIC  X(0001).
  3513     05  FILLER REDEFINES BMODEF.
  3514         10  BMODEA PIC  X(0001).
  3515     05  BMODEI PIC  X(0001).
  3516*    -------------------------------
  3517     05  BFREQL PIC S9(0004) COMP.
  3518     05  BFREQF PIC  X(0001).
  3519     05  FILLER REDEFINES BFREQF.
  3520         10  BFREQA PIC  X(0001).
  3521     05  BFREQI PIC  X(0002).
  3522*    -------------------------------
  3523     05  BPMTSL PIC S9(0004) COMP.
  3524     05  BPMTSF PIC  X(0001).
  3525     05  FILLER REDEFINES BPMTSF.
  3526         10  BPMTSA PIC  X(0001).
  3527     05  BPMTSI PIC  999.
  3528*    -------------------------------
  3529     05  BPMTAMTL PIC S9(0004) COMP.
  3530     05  BPMTAMTF PIC  X(0001).
  3531     05  FILLER REDEFINES BPMTAMTF.
  3532         10  BPMTAMTA PIC  X(0001).
  3533     05  BPMTAMTI PIC  9(7)V99.
  3534*    -------------------------------
  3535     05  BAPRL PIC S9(0004) COMP.
  3536     05  BAPRF PIC  X(0001).
  3537     05  FILLER REDEFINES BAPRF.
  3538         10  BAPRA PIC  X(0001).
  3539     05  BAPRI PIC  X(7).
  3540*    -------------------------------
  3541     05  BLIVESL PIC S9(0004) COMP.
  3542     05  BLIVESF PIC  X(0001).
  3543     05  FILLER REDEFINES BLIVESF.
  3544         10  BLIVESA PIC  X(0001).
  3545     05  BLIVESI PIC  X(0009).
  3546*    -------------------------------
  3547     05  BMEMCAPL PIC S9(0004) COMP.
  3548     05  BMEMCAPF PIC  X(0001).
  3549     05  FILLER REDEFINES BMEMCAPF.
  3550         10  BMEMCAPA PIC  X(0001).
  3551     05  BMEMCAPI PIC  X(0011).
  3552*    -------------------------------
  3553     05  BORIGHDL PIC S9(0004) COMP.
  3554     05  BORIGHDF PIC  X(0001).
  3555     05  FILLER REDEFINES BORIGHDF.
  3556         10  BORIGHDA PIC  X(0001).
  3557     05  BORIGHDI PIC  X(0009).
  3558*    -------------------------------
  3559     05  DMDBILL PIC S9(0004) COMP.
  3560     05  DMDBILF PIC  X(0001).
  3561     05  FILLER REDEFINES DMDBILF.
  3562         10  DMDBILA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  69
* EL6311.cbl
  3563     05  DMDBILI PIC  X(0006).
  3564*    -------------------------------
  3565     05  BFORCEL PIC S9(0004) COMP.
  3566     05  BFORCEF PIC  X(0001).
  3567     05  FILLER REDEFINES BFORCEF.
  3568         10  BFORCEA PIC  X(0001).
  3569     05  BFORCEI PIC  X(0001).
  3570*    -------------------------------
  3571     05  BENTRYL PIC S9(0004) COMP.
  3572     05  BENTRYF PIC  X(0001).
  3573     05  FILLER REDEFINES BENTRYF.
  3574         10  BENTRYA PIC  X(0001).
  3575     05  BENTRYI PIC  X(0001).
  3576*    -------------------------------
  3577     05  BREINL PIC S9(0004) COMP.
  3578     05  BREINF PIC  X(0001).
  3579     05  FILLER REDEFINES BREINF.
  3580         10  BREINA PIC  X(0001).
  3581     05  BREINI PIC  X(0001).
  3582*    -------------------------------
  3583     05  BBILCDL PIC S9(0004) COMP.
  3584     05  BBILCDF PIC  X(0001).
  3585     05  FILLER REDEFINES BBILCDF.
  3586         10  BBILCDA PIC  X(0001).
  3587     05  BBILCDI PIC  X(0001).
  3588*    -------------------------------
  3589     05  BUNWRITL PIC S9(0004) COMP.
  3590     05  BUNWRITF PIC  X(0001).
  3591     05  FILLER REDEFINES BUNWRITF.
  3592         10  BUNWRITA PIC  X(0001).
  3593     05  BUNWRITI PIC  X(0001).
  3594*    -------------------------------
  3595     05  BSKPCDL PIC S9(0004) COMP.
  3596     05  BSKPCDF PIC  X(0001).
  3597     05  FILLER REDEFINES BSKPCDF.
  3598         10  BSKPCDA PIC  X(0001).
  3599     05  BSKPCDI PIC  X(0001).
  3600*    -------------------------------
  3601     05  BINDGRPL PIC S9(0004) COMP.
  3602     05  BINDGRPF PIC  X(0001).
  3603     05  FILLER REDEFINES BINDGRPF.
  3604         10  BINDGRPA PIC  X(0001).
  3605     05  BINDGRPI PIC  X(0001).
  3606*    -------------------------------
  3607     05  BSIGL PIC S9(0004) COMP.
  3608     05  BSIGF PIC  X(0001).
  3609     05  FILLER REDEFINES BSIGF.
  3610         10  BSIGA PIC  X(0001).
  3611     05  BSIGI PIC  X(0001).
  3612*    -------------------------------
  3613     05  BRTCLSL PIC S9(0004) COMP.
  3614     05  BRTCLSF PIC  X(0001).
  3615     05  FILLER REDEFINES BRTCLSF.
  3616         10  BRTCLSA PIC  X(0001).
  3617     05  BRTCLSI PIC  X(0002).
  3618*    -------------------------------
  3619     05  BCHGCNTL PIC S9(0004) COMP.
  3620     05  BCHGCNTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  70
* EL6311.cbl
  3621     05  FILLER REDEFINES BCHGCNTF.
  3622         10  BCHGCNTA PIC  X(0001).
  3623     05  BCHGCNTI PIC  X(0003).
  3624*    -------------------------------
  3625     05  BMEMBERL PIC S9(0004) COMP.
  3626     05  BMEMBERF PIC  X(0001).
  3627     05  FILLER REDEFINES BMEMBERF.
  3628         10  BMEMBERA PIC  X(0001).
  3629     05  BMEMBERI PIC  X(0012).
  3630*    -------------------------------
  3631     05  BORGNOL PIC S9(0004) COMP.
  3632     05  BORGNOF PIC  X(0001).
  3633     05  FILLER REDEFINES BORGNOF.
  3634         10  BORGNOA PIC  X(0001).
  3635     05  BORGNOI PIC  X(0006).
  3636*    -------------------------------
  3637     05  BORGSEQL PIC S9(0004) COMP.
  3638     05  BORGSEQF PIC  X(0001).
  3639     05  FILLER REDEFINES BORGSEQF.
  3640         10  BORGSEQA PIC  X(0001).
  3641     05  BORGSEQI PIC  X(0004).
  3642*    -------------------------------
  3643     05  BBILLEDL PIC S9(0004) COMP.
  3644     05  BBILLEDF PIC  X(0001).
  3645     05  FILLER REDEFINES BBILLEDF.
  3646         10  BBILLEDA PIC  X(0001).
  3647     05  BBILLEDI PIC  9(9).
  3648*    -------------------------------
  3649     05  BKIND1L PIC S9(0004) COMP.
  3650     05  BKIND1F PIC  X(0001).
  3651     05  FILLER REDEFINES BKIND1F.
  3652         10  BKIND1A PIC  X(0001).
  3653     05  BKIND1I PIC  X(0002).
  3654*    -------------------------------
  3655     05  BTYPE1L PIC S9(0004) COMP.
  3656     05  BTYPE1F PIC  X(0001).
  3657     05  FILLER REDEFINES BTYPE1F.
  3658         10  BTYPE1A PIC  X(0001).
  3659     05  BTYPE1I PIC  X(0003).
  3660*    -------------------------------
  3661     05  BTERM1L PIC S9(0004) COMP.
  3662     05  BTERM1F PIC  X(0001).
  3663     05  FILLER REDEFINES BTERM1F.
  3664         10  BTERM1A PIC  X(0001).
  3665     05  BTERM1I PIC  X(0003).
  3666*    -------------------------------
  3667     05  BBEN1L PIC S9(0004) COMP.
  3668     05  BBEN1F PIC  X(0001).
  3669     05  FILLER REDEFINES BBEN1F.
  3670         10  BBEN1A PIC  X(0001).
  3671     05  BBEN1I PIC  X(0012).
  3672*    -------------------------------
  3673     05  BPREM1L PIC S9(0004) COMP.
  3674     05  BPREM1F PIC  X(0001).
  3675     05  FILLER REDEFINES BPREM1F.
  3676         10  BPREM1A PIC  X(0001).
  3677     05  BPREM1I PIC  X(0011).
  3678*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  71
* EL6311.cbl
  3679     05  BEXPIR1L PIC S9(0004) COMP.
  3680     05  BEXPIR1F PIC  X(0001).
  3681     05  FILLER REDEFINES BEXPIR1F.
  3682         10  BEXPIR1A PIC  X(0001).
  3683     05  BEXPIR1I PIC  X(0008).
  3684*    -------------------------------
  3685     05  BCP1L PIC S9(0004) COMP.
  3686     05  BCP1F PIC  X(0001).
  3687     05  FILLER REDEFINES BCP1F.
  3688         10  BCP1A PIC  X(0001).
  3689     05  BCP1I PIC  X(0002).
  3690*    -------------------------------
  3691     05  BALTBN1L PIC S9(0004) COMP.
  3692     05  BALTBN1F PIC  X(0001).
  3693     05  FILLER REDEFINES BALTBN1F.
  3694         10  BALTBN1A PIC  X(0001).
  3695     05  BALTBN1I PIC  X(0012).
  3696*    -------------------------------
  3697     05  BALTPR1L PIC S9(0004) COMP.
  3698     05  BALTPR1F PIC  X(0001).
  3699     05  FILLER REDEFINES BALTPR1F.
  3700         10  BALTPR1A PIC  X(0001).
  3701     05  BALTPR1I PIC  X(0011).
  3702*    -------------------------------
  3703     05  BBNCD1L PIC S9(0004) COMP.
  3704     05  BBNCD1F PIC  X(0001).
  3705     05  FILLER REDEFINES BBNCD1F.
  3706         10  BBNCD1A PIC  X(0001).
  3707     05  BBNCD1I PIC  X(0003).
  3708*    -------------------------------
  3709     05  BCPRM1L PIC S9(0004) COMP.
  3710     05  BCPRM1F PIC  X(0001).
  3711     05  FILLER REDEFINES BCPRM1F.
  3712         10  BCPRM1A PIC  X(0001).
  3713     05  BCPRM1I PIC  X(0011).
  3714*    -------------------------------
  3715     05  BCAPRM1L PIC S9(0004) COMP.
  3716     05  BCAPRM1F PIC  X(0001).
  3717     05  FILLER REDEFINES BCAPRM1F.
  3718         10  BCAPRM1A PIC  X(0001).
  3719     05  BCAPRM1I PIC  X(0011).
  3720*    -------------------------------
  3721     05  BENABR1L PIC S9(0004) COMP.
  3722     05  BENABR1F PIC  X(0001).
  3723     05  FILLER REDEFINES BENABR1F.
  3724         10  BENABR1A PIC  X(0001).
  3725     05  BENABR1I PIC  X(0005).
  3726*    -------------------------------
  3727     05  BDIFF1L PIC S9(0004) COMP.
  3728     05  BDIFF1F PIC  X(0001).
  3729     05  FILLER REDEFINES BDIFF1F.
  3730         10  BDIFF1A PIC  X(0001).
  3731     05  BDIFF1I PIC  X(0011).
  3732*    -------------------------------
  3733     05  BBILIT1L PIC S9(0004) COMP.
  3734     05  BBILIT1F PIC  X(0001).
  3735     05  FILLER REDEFINES BBILIT1F.
  3736         10  BBILIT1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  72
* EL6311.cbl
  3737     05  BBILIT1I PIC  X(0008).
  3738*    -------------------------------
  3739     05  BADIFF1L PIC S9(0004) COMP.
  3740     05  BADIFF1F PIC  X(0001).
  3741     05  FILLER REDEFINES BADIFF1F.
  3742         10  BADIFF1A PIC  X(0001).
  3743     05  BADIFF1I PIC  X(0011).
  3744*    -------------------------------
  3745     05  BKIND2L PIC S9(0004) COMP.
  3746     05  BKIND2F PIC  X(0001).
  3747     05  FILLER REDEFINES BKIND2F.
  3748         10  BKIND2A PIC  X(0001).
  3749     05  BKIND2I PIC  X(0002).
  3750*    -------------------------------
  3751     05  BTYPE2L PIC S9(0004) COMP.
  3752     05  BTYPE2F PIC  X(0001).
  3753     05  FILLER REDEFINES BTYPE2F.
  3754         10  BTYPE2A PIC  X(0001).
  3755     05  BTYPE2I PIC  X(0003).
  3756*    -------------------------------
  3757     05  BTERM2L PIC S9(0004) COMP.
  3758     05  BTERM2F PIC  X(0001).
  3759     05  FILLER REDEFINES BTERM2F.
  3760         10  BTERM2A PIC  X(0001).
  3761     05  BTERM2I PIC  X(0003).
  3762*    -------------------------------
  3763     05  BBEN2L PIC S9(0004) COMP.
  3764     05  BBEN2F PIC  X(0001).
  3765     05  FILLER REDEFINES BBEN2F.
  3766         10  BBEN2A PIC  X(0001).
  3767     05  BBEN2I PIC  X(0012).
  3768*    -------------------------------
  3769     05  BPREM2L PIC S9(0004) COMP.
  3770     05  BPREM2F PIC  X(0001).
  3771     05  FILLER REDEFINES BPREM2F.
  3772         10  BPREM2A PIC  X(0001).
  3773     05  BPREM2I PIC  X(0011).
  3774*    -------------------------------
  3775     05  BEXPIR2L PIC S9(0004) COMP.
  3776     05  BEXPIR2F PIC  X(0001).
  3777     05  FILLER REDEFINES BEXPIR2F.
  3778         10  BEXPIR2A PIC  X(0001).
  3779     05  BEXPIR2I PIC  X(0008).
  3780*    -------------------------------
  3781     05  BCP2L PIC S9(0004) COMP.
  3782     05  BCP2F PIC  X(0001).
  3783     05  FILLER REDEFINES BCP2F.
  3784         10  BCP2A PIC  X(0001).
  3785     05  BCP2I PIC  X(0002).
  3786*    -------------------------------
  3787     05  BALTBN2L PIC S9(0004) COMP.
  3788     05  BALTBN2F PIC  X(0001).
  3789     05  FILLER REDEFINES BALTBN2F.
  3790         10  BALTBN2A PIC  X(0001).
  3791     05  BALTBN2I PIC  X(0012).
  3792*    -------------------------------
  3793     05  BALTPR2L PIC S9(0004) COMP.
  3794     05  BALTPR2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  73
* EL6311.cbl
  3795     05  FILLER REDEFINES BALTPR2F.
  3796         10  BALTPR2A PIC  X(0001).
  3797     05  BALTPR2I PIC  X(0011).
  3798*    -------------------------------
  3799     05  BBNCD2L PIC S9(0004) COMP.
  3800     05  BBNCD2F PIC  X(0001).
  3801     05  FILLER REDEFINES BBNCD2F.
  3802         10  BBNCD2A PIC  X(0001).
  3803     05  BBNCD2I PIC  X(0003).
  3804*    -------------------------------
  3805     05  BCPRM2L PIC S9(0004) COMP.
  3806     05  BCPRM2F PIC  X(0001).
  3807     05  FILLER REDEFINES BCPRM2F.
  3808         10  BCPRM2A PIC  X(0001).
  3809     05  BCPRM2I PIC  X(0011).
  3810*    -------------------------------
  3811     05  BCAPRM2L PIC S9(0004) COMP.
  3812     05  BCAPRM2F PIC  X(0001).
  3813     05  FILLER REDEFINES BCAPRM2F.
  3814         10  BCAPRM2A PIC  X(0001).
  3815     05  BCAPRM2I PIC  X(0011).
  3816*    -------------------------------
  3817     05  BENABR2L PIC S9(0004) COMP.
  3818     05  BENABR2F PIC  X(0001).
  3819     05  FILLER REDEFINES BENABR2F.
  3820         10  BENABR2A PIC  X(0001).
  3821     05  BENABR2I PIC  X(0005).
  3822*    -------------------------------
  3823     05  BDIFF2L PIC S9(0004) COMP.
  3824     05  BDIFF2F PIC  X(0001).
  3825     05  FILLER REDEFINES BDIFF2F.
  3826         10  BDIFF2A PIC  X(0001).
  3827     05  BDIFF2I PIC  X(0011).
  3828*    -------------------------------
  3829     05  BBILIT2L PIC S9(0004) COMP.
  3830     05  BBILIT2F PIC  X(0001).
  3831     05  FILLER REDEFINES BBILIT2F.
  3832         10  BBILIT2A PIC  X(0001).
  3833     05  BBILIT2I PIC  X(0008).
  3834*    -------------------------------
  3835     05  BADIFF2L PIC S9(0004) COMP.
  3836     05  BADIFF2F PIC  X(0001).
  3837     05  FILLER REDEFINES BADIFF2F.
  3838         10  BADIFF2A PIC  X(0001).
  3839     05  BADIFF2I PIC  X(0011).
  3840*    -------------------------------
  3841     05  BERMSG1L PIC S9(0004) COMP.
  3842     05  BERMSG1F PIC  X(0001).
  3843     05  FILLER REDEFINES BERMSG1F.
  3844         10  BERMSG1A PIC  X(0001).
  3845     05  BERMSG1I PIC  X(0078).
  3846*    -------------------------------
  3847     05  BERMSG2L PIC S9(0004) COMP.
  3848     05  BERMSG2F PIC  X(0001).
  3849     05  FILLER REDEFINES BERMSG2F.
  3850         10  BERMSG2A PIC  X(0001).
  3851     05  BERMSG2I PIC  X(0078).
  3852*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  74
* EL6311.cbl
  3853     05  BERMSG3L PIC S9(0004) COMP.
  3854     05  BERMSG3F PIC  X(0001).
  3855     05  FILLER REDEFINES BERMSG3F.
  3856         10  BERMSG3A PIC  X(0001).
  3857     05  BERMSG3I PIC  X(0078).
  3858*    -------------------------------
  3859     05  BPFENTRL PIC S9(0004) COMP.
  3860     05  BPFENTRF PIC  X(0001).
  3861     05  FILLER REDEFINES BPFENTRF.
  3862         10  BPFENTRA PIC  X(0001).
  3863     05  BPFENTRI PIC  9(2).
  3864*    -------------------------------
  3865     05  BPF5HDRL PIC S9(0004) COMP.
  3866     05  BPF5HDRF PIC  X(0001).
  3867     05  FILLER REDEFINES BPF5HDRF.
  3868         10  BPF5HDRA PIC  X(0001).
  3869     05  BPF5HDRI PIC  X(0005).
  3870*    -------------------------------
  3871     05  BPF4HDRL PIC S9(0004) COMP.
  3872     05  BPF4HDRF PIC  X(0001).
  3873     05  FILLER REDEFINES BPF4HDRF.
  3874         10  BPF4HDRA PIC  X(0001).
  3875     05  BPF4HDRI PIC  X(0013).
  3876*    -------------------------------
  3877     05  BF15HDRL PIC S9(0004) COMP.
  3878     05  BF15HDRF PIC  X(0001).
  3879     05  FILLER REDEFINES BF15HDRF.
  3880         10  BF15HDRA PIC  X(0001).
  3881     05  BF15HDRI PIC  X(0010).
  3882 01  EL631BO REDEFINES EL631BI.
  3883     05  FILLER            PIC  X(0012).
  3884*    -------------------------------
  3885     05  FILLER            PIC  X(0003).
  3886     05  BDATEO PIC  X(0008).
  3887*    -------------------------------
  3888     05  FILLER            PIC  X(0003).
  3889     05  BTIMEO PIC  99.99.
  3890*    -------------------------------
  3891     05  FILLER            PIC  X(0003).
  3892     05  BHEADO PIC  X(0038).
  3893*    -------------------------------
  3894     05  FILLER            PIC  X(0003).
  3895     05  BNCERTLO PIC  X(0008).
  3896*    -------------------------------
  3897     05  FILLER            PIC  X(0003).
  3898     05  BNCERTO PIC  X(0011).
  3899*    -------------------------------
  3900     05  FILLER            PIC  X(0003).
  3901     05  BNSTATLO PIC  X(0009).
  3902*    -------------------------------
  3903     05  FILLER            PIC  X(0003).
  3904     05  BNSTATO PIC  X(0002).
  3905*    -------------------------------
  3906     05  FILLER            PIC  X(0003).
  3907     05  BCHGTO PIC  X(0004).
  3908*    -------------------------------
  3909     05  FILLER            PIC  X(0003).
  3910     05  BCHGO PIC  ZZZ9.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  75
* EL6311.cbl
  3911*    -------------------------------
  3912     05  FILLER            PIC  X(0003).
  3913     05  BMAINTO PIC  X(0001).
  3914*    -------------------------------
  3915     05  FILLER            PIC  X(0003).
  3916     05  BMANTBYO PIC  X(0004).
  3917*    -------------------------------
  3918     05  FILLER            PIC  X(0003).
  3919     05  BCHGHDGO PIC  X(0003).
  3920*    -------------------------------
  3921     05  FILLER            PIC  X(0003).
  3922     05  BMANTDTO PIC  X(0008).
  3923*    -------------------------------
  3924     05  FILLER            PIC  X(0003).
  3925     05  BMANTATO PIC  99.99.
  3926*    -------------------------------
  3927     05  FILLER            PIC  X(0003).
  3928     05  BCSRO PIC  X(0004).
  3929*    -------------------------------
  3930     05  FILLER            PIC  X(0003).
  3931     05  BBATCHO PIC  X(0006).
  3932*    -------------------------------
  3933     05  FILLER            PIC  X(0003).
  3934     05  BSEQO PIC  X(0004).
  3935*    -------------------------------
  3936     05  FILLER            PIC  X(0003).
  3937     05  BMOENDTO PIC  X(0008).
  3938*    -------------------------------
  3939     05  FILLER            PIC  X(0003).
  3940     05  BCARRO PIC  X(0001).
  3941*    -------------------------------
  3942     05  FILLER            PIC  X(0003).
  3943     05  BGROUPO PIC  X(0006).
  3944*    -------------------------------
  3945     05  FILLER            PIC  X(0003).
  3946     05  BSTATEO PIC  X(0002).
  3947*    -------------------------------
  3948     05  FILLER            PIC  X(0003).
  3949     05  BACCTO PIC  X(0010).
  3950*    -------------------------------
  3951     05  FILLER            PIC  X(0003).
  3952     05  BVINHO PIC  X(0004).
  3953*    -------------------------------
  3954     05  FILLER            PIC  X(0003).
  3955     05  BVINO PIC  X(0017).
  3956*    -------------------------------
  3957     05  FILLER            PIC  X(0003).
  3958     05  BREFHDGO PIC  X(0004).
  3959*    -------------------------------
  3960     05  FILLER            PIC  X(0003).
  3961     05  BREFO PIC  X(0012).
  3962*    -------------------------------
  3963     05  FILLER            PIC  X(0003).
  3964     05  BCERTNOO PIC  X(0010).
  3965*    -------------------------------
  3966     05  FILLER            PIC  X(0003).
  3967     05  BSUFIXO PIC  X(0001).
  3968*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  76
* EL6311.cbl
  3969     05  FILLER            PIC  X(0003).
  3970     05  BEFFDTO PIC  X(0008).
  3971*    -------------------------------
  3972     05  FILLER            PIC  X(0003).
  3973     05  BLSTNMO PIC  X(0015).
  3974*    -------------------------------
  3975     05  FILLER            PIC  X(0003).
  3976     05  B1STNMO PIC  X(0010).
  3977*    -------------------------------
  3978     05  FILLER            PIC  X(0003).
  3979     05  BINITO PIC  X(0001).
  3980*    -------------------------------
  3981     05  FILLER            PIC  X(0003).
  3982     05  BSEXO PIC  X(0001).
  3983*    -------------------------------
  3984     05  FILLER            PIC  X(0003).
  3985     05  BAGEO PIC  X(0002).
  3986*    -------------------------------
  3987     05  FILLER            PIC  X(0003).
  3988     05  BBIRTHO PIC  X(0008).
  3989*    -------------------------------
  3990     05  FILLER            PIC  X(0003).
  3991     05  B1STPMTO PIC  X(0008).
  3992*    -------------------------------
  3993     05  FILLER            PIC  X(0003).
  3994     05  BDAYSO PIC  X(0003).
  3995*    -------------------------------
  3996     05  FILLER            PIC  X(0003).
  3997     05  BLNTRMO PIC  X(0003).
  3998*    -------------------------------
  3999     05  FILLER            PIC  X(0003).
  4000     05  BLNOFCRO PIC  X(0005).
  4001*    -------------------------------
  4002     05  FILLER            PIC  X(0003).
  4003     05  BMODEO PIC  X(0001).
  4004*    -------------------------------
  4005     05  FILLER            PIC  X(0003).
  4006     05  BFREQO PIC  X(0002).
  4007*    -------------------------------
  4008     05  FILLER            PIC  X(0003).
  4009     05  BPMTSO PIC  X(0003).
  4010*    -------------------------------
  4011     05  FILLER            PIC  X(0003).
  4012     05  BPMTAMTO PIC  ZZZZZ9.99.
  4013*    -------------------------------
  4014     05  FILLER            PIC  X(0003).
  4015     05  BAPRO PIC  99.9999.
  4016*    -------------------------------
  4017     05  FILLER            PIC  X(0003).
  4018     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4019*    -------------------------------
  4020     05  FILLER            PIC  X(0003).
  4021     05  BMEMCAPO PIC  X(0011).
  4022*    -------------------------------
  4023     05  FILLER            PIC  X(0003).
  4024     05  BORIGHDO PIC  X(0009).
  4025*    -------------------------------
  4026     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  77
* EL6311.cbl
  4027     05  DMDBILO PIC  X(0006).
  4028*    -------------------------------
  4029     05  FILLER            PIC  X(0003).
  4030     05  BFORCEO PIC  X(0001).
  4031*    -------------------------------
  4032     05  FILLER            PIC  X(0003).
  4033     05  BENTRYO PIC  X(0001).
  4034*    -------------------------------
  4035     05  FILLER            PIC  X(0003).
  4036     05  BREINO PIC  X(0001).
  4037*    -------------------------------
  4038     05  FILLER            PIC  X(0003).
  4039     05  BBILCDO PIC  X(0001).
  4040*    -------------------------------
  4041     05  FILLER            PIC  X(0003).
  4042     05  BUNWRITO PIC  X(0001).
  4043*    -------------------------------
  4044     05  FILLER            PIC  X(0003).
  4045     05  BSKPCDO PIC  X(0001).
  4046*    -------------------------------
  4047     05  FILLER            PIC  X(0003).
  4048     05  BINDGRPO PIC  X(0001).
  4049*    -------------------------------
  4050     05  FILLER            PIC  X(0003).
  4051     05  BSIGO PIC  X(0001).
  4052*    -------------------------------
  4053     05  FILLER            PIC  X(0003).
  4054     05  BRTCLSO PIC  X(0002).
  4055*    -------------------------------
  4056     05  FILLER            PIC  X(0003).
  4057     05  BCHGCNTO PIC  X(0003).
  4058*    -------------------------------
  4059     05  FILLER            PIC  X(0003).
  4060     05  BMEMBERO PIC  X(0012).
  4061*    -------------------------------
  4062     05  FILLER            PIC  X(0003).
  4063     05  BORGNOO PIC  X(0006).
  4064*    -------------------------------
  4065     05  FILLER            PIC  X(0003).
  4066     05  BORGSEQO PIC  X(0004).
  4067*    -------------------------------
  4068     05  FILLER            PIC  X(0003).
  4069     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4070*    -------------------------------
  4071     05  FILLER            PIC  X(0003).
  4072     05  BKIND1O PIC  X(0002).
  4073*    -------------------------------
  4074     05  FILLER            PIC  X(0003).
  4075     05  BTYPE1O PIC  X(0003).
  4076*    -------------------------------
  4077     05  FILLER            PIC  X(0003).
  4078     05  BTERM1O PIC  X(0003).
  4079*    -------------------------------
  4080     05  FILLER            PIC  X(0003).
  4081     05  BBEN1O PIC  X(0012).
  4082*    -------------------------------
  4083     05  FILLER            PIC  X(0003).
  4084     05  BPREM1O PIC  X(0011).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  78
* EL6311.cbl
  4085*    -------------------------------
  4086     05  FILLER            PIC  X(0003).
  4087     05  BEXPIR1O PIC  X(0008).
  4088*    -------------------------------
  4089     05  FILLER            PIC  X(0003).
  4090     05  BCP1O PIC  X(0002).
  4091*    -------------------------------
  4092     05  FILLER            PIC  X(0003).
  4093     05  BALTBN1O PIC  X(0012).
  4094*    -------------------------------
  4095     05  FILLER            PIC  X(0003).
  4096     05  BALTPR1O PIC  X(0011).
  4097*    -------------------------------
  4098     05  FILLER            PIC  X(0003).
  4099     05  BBNCD1O PIC  X(0003).
  4100*    -------------------------------
  4101     05  FILLER            PIC  X(0003).
  4102     05  BCPRM1O PIC  X(0011).
  4103*    -------------------------------
  4104     05  FILLER            PIC  X(0003).
  4105     05  BCAPRM1O PIC  X(0011).
  4106*    -------------------------------
  4107     05  FILLER            PIC  X(0003).
  4108     05  BENABR1O PIC  X(0005).
  4109*    -------------------------------
  4110     05  FILLER            PIC  X(0003).
  4111     05  BDIFF1O PIC  X(0011).
  4112*    -------------------------------
  4113     05  FILLER            PIC  X(0003).
  4114     05  BBILIT1O PIC  X(0008).
  4115*    -------------------------------
  4116     05  FILLER            PIC  X(0003).
  4117     05  BADIFF1O PIC  X(0011).
  4118*    -------------------------------
  4119     05  FILLER            PIC  X(0003).
  4120     05  BKIND2O PIC  X(0002).
  4121*    -------------------------------
  4122     05  FILLER            PIC  X(0003).
  4123     05  BTYPE2O PIC  X(0003).
  4124*    -------------------------------
  4125     05  FILLER            PIC  X(0003).
  4126     05  BTERM2O PIC  X(0003).
  4127*    -------------------------------
  4128     05  FILLER            PIC  X(0003).
  4129     05  BBEN2O PIC  X(0012).
  4130*    -------------------------------
  4131     05  FILLER            PIC  X(0003).
  4132     05  BPREM2O PIC  X(0011).
  4133*    -------------------------------
  4134     05  FILLER            PIC  X(0003).
  4135     05  BEXPIR2O PIC  X(0008).
  4136*    -------------------------------
  4137     05  FILLER            PIC  X(0003).
  4138     05  BCP2O PIC  X(0002).
  4139*    -------------------------------
  4140     05  FILLER            PIC  X(0003).
  4141     05  BALTBN2O PIC  X(0012).
  4142*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  79
* EL6311.cbl
  4143     05  FILLER            PIC  X(0003).
  4144     05  BALTPR2O PIC  X(0011).
  4145*    -------------------------------
  4146     05  FILLER            PIC  X(0003).
  4147     05  BBNCD2O PIC  X(0003).
  4148*    -------------------------------
  4149     05  FILLER            PIC  X(0003).
  4150     05  BCPRM2O PIC  X(0011).
  4151*    -------------------------------
  4152     05  FILLER            PIC  X(0003).
  4153     05  BCAPRM2O PIC  X(0011).
  4154*    -------------------------------
  4155     05  FILLER            PIC  X(0003).
  4156     05  BENABR2O PIC  X(0005).
  4157*    -------------------------------
  4158     05  FILLER            PIC  X(0003).
  4159     05  BDIFF2O PIC  X(0011).
  4160*    -------------------------------
  4161     05  FILLER            PIC  X(0003).
  4162     05  BBILIT2O PIC  X(0008).
  4163*    -------------------------------
  4164     05  FILLER            PIC  X(0003).
  4165     05  BADIFF2O PIC  X(0011).
  4166*    -------------------------------
  4167     05  FILLER            PIC  X(0003).
  4168     05  BERMSG1O PIC  X(0078).
  4169*    -------------------------------
  4170     05  FILLER            PIC  X(0003).
  4171     05  BERMSG2O PIC  X(0078).
  4172*    -------------------------------
  4173     05  FILLER            PIC  X(0003).
  4174     05  BERMSG3O PIC  X(0078).
  4175*    -------------------------------
  4176     05  FILLER            PIC  X(0003).
  4177     05  BPFENTRO PIC  X(0002).
  4178*    -------------------------------
  4179     05  FILLER            PIC  X(0003).
  4180     05  BPF5HDRO PIC  X(0005).
  4181*    -------------------------------
  4182     05  FILLER            PIC  X(0003).
  4183     05  BPF4HDRO PIC  X(0013).
  4184*    -------------------------------
  4185     05  FILLER            PIC  X(0003).
  4186     05  BF15HDRO PIC  X(0010).
  4187*    -------------------------------
  4188 01  EL631CI REDEFINES EL631BI.
  4189     05  FILLER            PIC  X(0012).
  4190*    -------------------------------
  4191     05  CDATEL PIC S9(0004) COMP.
  4192     05  CDATEF PIC  X(0001).
  4193     05  FILLER REDEFINES CDATEF.
  4194         10  CDATEA PIC  X(0001).
  4195     05  CDATEI PIC  X(0008).
  4196*    -------------------------------
  4197     05  CTIMEL PIC S9(0004) COMP.
  4198     05  CTIMEF PIC  X(0001).
  4199     05  FILLER REDEFINES CTIMEF.
  4200         10  CTIMEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  80
* EL6311.cbl
  4201     05  CTIMEI PIC  X(0005).
  4202*    -------------------------------
  4203     05  CHEADL PIC S9(0004) COMP.
  4204     05  CHEADF PIC  X(0001).
  4205     05  FILLER REDEFINES CHEADF.
  4206         10  CHEADA PIC  X(0001).
  4207     05  CHEADI PIC  X(0038).
  4208*    -------------------------------
  4209     05  CCHGTL PIC S9(0004) COMP.
  4210     05  CCHGTF PIC  X(0001).
  4211     05  FILLER REDEFINES CCHGTF.
  4212         10  CCHGTA PIC  X(0001).
  4213     05  CCHGTI PIC  X(0004).
  4214*    -------------------------------
  4215     05  CCHGL PIC S9(0004) COMP.
  4216     05  CCHGF PIC  X(0001).
  4217     05  FILLER REDEFINES CCHGF.
  4218         10  CCHGA PIC  X(0001).
  4219     05  CCHGI PIC  X(0004).
  4220*    -------------------------------
  4221     05  CMAINTL PIC S9(0004) COMP.
  4222     05  CMAINTF PIC  X(0001).
  4223     05  FILLER REDEFINES CMAINTF.
  4224         10  CMAINTA PIC  X(0001).
  4225     05  CMAINTI PIC  X(0001).
  4226*    -------------------------------
  4227     05  CMANTBYL PIC S9(0004) COMP.
  4228     05  CMANTBYF PIC  X(0001).
  4229     05  FILLER REDEFINES CMANTBYF.
  4230         10  CMANTBYA PIC  X(0001).
  4231     05  CMANTBYI PIC  X(0004).
  4232*    -------------------------------
  4233     05  CCHGHDGL PIC S9(0004) COMP.
  4234     05  CCHGHDGF PIC  X(0001).
  4235     05  FILLER REDEFINES CCHGHDGF.
  4236         10  CCHGHDGA PIC  X(0001).
  4237     05  CCHGHDGI PIC  X(0003).
  4238*    -------------------------------
  4239     05  CMANTDTL PIC S9(0004) COMP.
  4240     05  CMANTDTF PIC  X(0001).
  4241     05  FILLER REDEFINES CMANTDTF.
  4242         10  CMANTDTA PIC  X(0001).
  4243     05  CMANTDTI PIC  X(0008).
  4244*    -------------------------------
  4245     05  CMANTATL PIC S9(0004) COMP.
  4246     05  CMANTATF PIC  X(0001).
  4247     05  FILLER REDEFINES CMANTATF.
  4248         10  CMANTATA PIC  X(0001).
  4249     05  CMANTATI PIC  X(0005).
  4250*    -------------------------------
  4251     05  CCSRL PIC S9(0004) COMP.
  4252     05  CCSRF PIC  X(0001).
  4253     05  FILLER REDEFINES CCSRF.
  4254         10  CCSRA PIC  X(0001).
  4255     05  CCSRI PIC  X(0004).
  4256*    -------------------------------
  4257     05  CBATCHL PIC S9(0004) COMP.
  4258     05  CBATCHF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  81
* EL6311.cbl
  4259     05  FILLER REDEFINES CBATCHF.
  4260         10  CBATCHA PIC  X(0001).
  4261     05  CBATCHI PIC  X(0006).
  4262*    -------------------------------
  4263     05  CSEQL PIC S9(0004) COMP.
  4264     05  CSEQF PIC  X(0001).
  4265     05  FILLER REDEFINES CSEQF.
  4266         10  CSEQA PIC  X(0001).
  4267     05  CSEQI PIC  X(0004).
  4268*    -------------------------------
  4269     05  CMOENDTL PIC S9(0004) COMP.
  4270     05  CMOENDTF PIC  X(0001).
  4271     05  FILLER REDEFINES CMOENDTF.
  4272         10  CMOENDTA PIC  X(0001).
  4273     05  CMOENDTI PIC  X(0008).
  4274*    -------------------------------
  4275     05  CCARRL PIC S9(0004) COMP.
  4276     05  CCARRF PIC  X(0001).
  4277     05  FILLER REDEFINES CCARRF.
  4278         10  CCARRA PIC  X(0001).
  4279     05  CCARRI PIC  X(0001).
  4280*    -------------------------------
  4281     05  CGROUPL PIC S9(0004) COMP.
  4282     05  CGROUPF PIC  X(0001).
  4283     05  FILLER REDEFINES CGROUPF.
  4284         10  CGROUPA PIC  X(0001).
  4285     05  CGROUPI PIC  X(0006).
  4286*    -------------------------------
  4287     05  CSTATEL PIC S9(0004) COMP.
  4288     05  CSTATEF PIC  X(0001).
  4289     05  FILLER REDEFINES CSTATEF.
  4290         10  CSTATEA PIC  X(0001).
  4291     05  CSTATEI PIC  X(0002).
  4292*    -------------------------------
  4293     05  CACCTL PIC S9(0004) COMP.
  4294     05  CACCTF PIC  X(0001).
  4295     05  FILLER REDEFINES CACCTF.
  4296         10  CACCTA PIC  X(0001).
  4297     05  CACCTI PIC  X(0010).
  4298*    -------------------------------
  4299     05  CORIGHDL PIC S9(0004) COMP.
  4300     05  CORIGHDF PIC  X(0001).
  4301     05  FILLER REDEFINES CORIGHDF.
  4302         10  CORIGHDA PIC  X(0001).
  4303     05  CORIGHDI PIC  X(0011).
  4304*    -------------------------------
  4305     05  CORGNOL PIC S9(0004) COMP.
  4306     05  CORGNOF PIC  X(0001).
  4307     05  FILLER REDEFINES CORGNOF.
  4308         10  CORGNOA PIC  X(0001).
  4309     05  CORGNOI PIC  X(0006).
  4310*    -------------------------------
  4311     05  CORGSEQL PIC S9(0004) COMP.
  4312     05  CORGSEQF PIC  X(0001).
  4313     05  FILLER REDEFINES CORGSEQF.
  4314         10  CORGSEQA PIC  X(0001).
  4315     05  CORGSEQI PIC  X(0004).
  4316*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  82
* EL6311.cbl
  4317     05  CREFHDGL PIC S9(0004) COMP.
  4318     05  CREFHDGF PIC  X(0001).
  4319     05  FILLER REDEFINES CREFHDGF.
  4320         10  CREFHDGA PIC  X(0001).
  4321     05  CREFHDGI PIC  X(0010).
  4322*    -------------------------------
  4323     05  CREFL PIC S9(0004) COMP.
  4324     05  CREFF PIC  X(0001).
  4325     05  FILLER REDEFINES CREFF.
  4326         10  CREFA PIC  X(0001).
  4327     05  CREFI PIC  X(0012).
  4328*    -------------------------------
  4329     05  CNHINTL PIC S9(0004) COMP.
  4330     05  CNHINTF PIC  X(0001).
  4331     05  FILLER REDEFINES CNHINTF.
  4332         10  CNHINTA PIC  X(0001).
  4333     05  CNHINTI PIC  9(7)V99.
  4334*    -------------------------------
  4335     05  CCERTNOL PIC S9(0004) COMP.
  4336     05  CCERTNOF PIC  X(0001).
  4337     05  FILLER REDEFINES CCERTNOF.
  4338         10  CCERTNOA PIC  X(0001).
  4339     05  CCERTNOI PIC  X(0010).
  4340*    -------------------------------
  4341     05  CSUFIXL PIC S9(0004) COMP.
  4342     05  CSUFIXF PIC  X(0001).
  4343     05  FILLER REDEFINES CSUFIXF.
  4344         10  CSUFIXA PIC  X(0001).
  4345     05  CSUFIXI PIC  X(0001).
  4346*    -------------------------------
  4347     05  CEFFDTL PIC S9(0004) COMP.
  4348     05  CEFFDTF PIC  X(0001).
  4349     05  FILLER REDEFINES CEFFDTF.
  4350         10  CEFFDTA PIC  X(0001).
  4351     05  CEFFDTI PIC  X(0008).
  4352*    -------------------------------
  4353     05  CLSTNML PIC S9(0004) COMP.
  4354     05  CLSTNMF PIC  X(0001).
  4355     05  FILLER REDEFINES CLSTNMF.
  4356         10  CLSTNMA PIC  X(0001).
  4357     05  CLSTNMI PIC  X(0015).
  4358*    -------------------------------
  4359     05  CPCYNL PIC S9(0004) COMP.
  4360     05  CPCYNF PIC  X(0001).
  4361     05  FILLER REDEFINES CPCYNF.
  4362         10  CPCYNA PIC  X(0001).
  4363     05  CPCYNI PIC  X(0001).
  4364*    -------------------------------
  4365     05  CINAMEL PIC S9(0004) COMP.
  4366     05  CINAMEF PIC  X(0001).
  4367     05  FILLER REDEFINES CINAMEF.
  4368         10  CINAMEA PIC  X(0001).
  4369     05  CINAMEI PIC  X(0015).
  4370*    -------------------------------
  4371     05  CINITSL PIC S9(0004) COMP.
  4372     05  CINITSF PIC  X(0001).
  4373     05  FILLER REDEFINES CINITSF.
  4374         10  CINITSA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  83
* EL6311.cbl
  4375     05  CINITSI PIC  X(0010).
  4376*    -------------------------------
  4377     05  CCANREAL PIC S9(0004) COMP.
  4378     05  CCANREAF PIC  X(0001).
  4379     05  FILLER REDEFINES CCANREAF.
  4380         10  CCANREAA PIC  X(0001).
  4381     05  CCANREAI PIC  X(0001).
  4382*    -------------------------------
  4383     05  CKIND1L PIC S9(0004) COMP.
  4384     05  CKIND1F PIC  X(0001).
  4385     05  FILLER REDEFINES CKIND1F.
  4386         10  CKIND1A PIC  X(0001).
  4387     05  CKIND1I PIC  X(0002).
  4388*    -------------------------------
  4389     05  CCANDT1L PIC S9(0004) COMP.
  4390     05  CCANDT1F PIC  X(0001).
  4391     05  FILLER REDEFINES CCANDT1F.
  4392         10  CCANDT1A PIC  X(0001).
  4393     05  CCANDT1I PIC  X(0008).
  4394*    -------------------------------
  4395     05  CREFND1L PIC S9(0004) COMP.
  4396     05  CREFND1F PIC  X(0001).
  4397     05  FILLER REDEFINES CREFND1F.
  4398         10  CREFND1A PIC  X(0001).
  4399     05  CREFND1I PIC  S9(9)V99.
  4400*    -------------------------------
  4401     05  CMTHD1L PIC S9(0004) COMP.
  4402     05  CMTHD1F PIC  X(0001).
  4403     05  FILLER REDEFINES CMTHD1F.
  4404         10  CMTHD1A PIC  X(0001).
  4405     05  CMTHD1I PIC  X(0001).
  4406*    -------------------------------
  4407     05  CKIND2L PIC S9(0004) COMP.
  4408     05  CKIND2F PIC  X(0001).
  4409     05  FILLER REDEFINES CKIND2F.
  4410         10  CKIND2A PIC  X(0001).
  4411     05  CKIND2I PIC  X(0002).
  4412*    -------------------------------
  4413     05  CCANDT2L PIC S9(0004) COMP.
  4414     05  CCANDT2F PIC  X(0001).
  4415     05  FILLER REDEFINES CCANDT2F.
  4416         10  CCANDT2A PIC  X(0001).
  4417     05  CCANDT2I PIC  X(0008).
  4418*    -------------------------------
  4419     05  CREFND2L PIC S9(0004) COMP.
  4420     05  CREFND2F PIC  X(0001).
  4421     05  FILLER REDEFINES CREFND2F.
  4422         10  CREFND2A PIC  X(0001).
  4423     05  CREFND2I PIC  S9(9)V99.
  4424*    -------------------------------
  4425     05  CMTHD2L PIC S9(0004) COMP.
  4426     05  CMTHD2F PIC  X(0001).
  4427     05  FILLER REDEFINES CMTHD2F.
  4428         10  CMTHD2A PIC  X(0001).
  4429     05  CMTHD2I PIC  X(0001).
  4430*    -------------------------------
  4431     05  CLIVESL PIC S9(0004) COMP.
  4432     05  CLIVESF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  84
* EL6311.cbl
  4433     05  FILLER REDEFINES CLIVESF.
  4434         10  CLIVESA PIC  X(0001).
  4435     05  CLIVESI PIC  X(0003).
  4436*    -------------------------------
  4437     05  CFORCEL PIC S9(0004) COMP.
  4438     05  CFORCEF PIC  X(0001).
  4439     05  FILLER REDEFINES CFORCEF.
  4440         10  CFORCEA PIC  X(0001).
  4441     05  CFORCEI PIC  X(0001).
  4442*    -------------------------------
  4443     05  CBILCDL PIC S9(0004) COMP.
  4444     05  CBILCDF PIC  X(0001).
  4445     05  FILLER REDEFINES CBILCDF.
  4446         10  CBILCDA PIC  X(0001).
  4447     05  CBILCDI PIC  X(0001).
  4448*    -------------------------------
  4449     05  CCRFND1L PIC S9(0004) COMP.
  4450     05  CCRFND1F PIC  X(0001).
  4451     05  FILLER REDEFINES CCRFND1F.
  4452         10  CCRFND1A PIC  X(0001).
  4453     05  CCRFND1I PIC  X(0011).
  4454*    -------------------------------
  4455     05  CCRFND2L PIC S9(0004) COMP.
  4456     05  CCRFND2F PIC  X(0001).
  4457     05  FILLER REDEFINES CCRFND2F.
  4458         10  CCRFND2A PIC  X(0001).
  4459     05  CCRFND2I PIC  X(0011).
  4460*    -------------------------------
  4461     05  CBILIT1L PIC S9(0004) COMP.
  4462     05  CBILIT1F PIC  X(0001).
  4463     05  FILLER REDEFINES CBILIT1F.
  4464         10  CBILIT1A PIC  X(0001).
  4465     05  CBILIT1I PIC  X(0008).
  4466*    -------------------------------
  4467     05  CDRFND1L PIC S9(0004) COMP.
  4468     05  CDRFND1F PIC  X(0001).
  4469     05  FILLER REDEFINES CDRFND1F.
  4470         10  CDRFND1A PIC  X(0001).
  4471     05  CDRFND1I PIC  X(0011).
  4472*    -------------------------------
  4473     05  CBILIT2L PIC S9(0004) COMP.
  4474     05  CBILIT2F PIC  X(0001).
  4475     05  FILLER REDEFINES CBILIT2F.
  4476         10  CBILIT2A PIC  X(0001).
  4477     05  CBILIT2I PIC  X(0008).
  4478*    -------------------------------
  4479     05  CDRFND2L PIC S9(0004) COMP.
  4480     05  CDRFND2F PIC  X(0001).
  4481     05  FILLER REDEFINES CDRFND2F.
  4482         10  CDRFND2A PIC  X(0001).
  4483     05  CDRFND2I PIC  X(0011).
  4484*    -------------------------------
  4485     05  CCANTXTL PIC S9(0004) COMP.
  4486     05  CCANTXTF PIC  X(0001).
  4487     05  FILLER REDEFINES CCANTXTF.
  4488         10  CCANTXTA PIC  X(0001).
  4489     05  CCANTXTI PIC  X(0005).
  4490*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  85
* EL6311.cbl
  4491     05  CCANFEEL PIC S9(0004) COMP.
  4492     05  CCANFEEF PIC  X(0001).
  4493     05  FILLER REDEFINES CCANFEEF.
  4494         10  CCANFEEA PIC  X(0001).
  4495     05  CCANFEEI PIC  X(0002).
  4496*    -------------------------------
  4497     05  CTERM1L PIC S9(0004) COMP.
  4498     05  CTERM1F PIC  X(0001).
  4499     05  FILLER REDEFINES CTERM1F.
  4500         10  CTERM1A PIC  X(0001).
  4501     05  CTERM1I PIC  X(0003).
  4502*    -------------------------------
  4503     05  CRTERM1L PIC S9(0004) COMP.
  4504     05  CRTERM1F PIC  X(0001).
  4505     05  FILLER REDEFINES CRTERM1F.
  4506         10  CRTERM1A PIC  X(0001).
  4507     05  CRTERM1I PIC  X(0003).
  4508*    -------------------------------
  4509     05  CPREM1L PIC S9(0004) COMP.
  4510     05  CPREM1F PIC  X(0001).
  4511     05  FILLER REDEFINES CPREM1F.
  4512         10  CPREM1A PIC  X(0001).
  4513     05  CPREM1I PIC  X(0011).
  4514*    -------------------------------
  4515     05  CTERM2L PIC S9(0004) COMP.
  4516     05  CTERM2F PIC  X(0001).
  4517     05  FILLER REDEFINES CTERM2F.
  4518         10  CTERM2A PIC  X(0001).
  4519     05  CTERM2I PIC  X(0003).
  4520*    -------------------------------
  4521     05  CRTERM2L PIC S9(0004) COMP.
  4522     05  CRTERM2F PIC  X(0001).
  4523     05  FILLER REDEFINES CRTERM2F.
  4524         10  CRTERM2A PIC  X(0001).
  4525     05  CRTERM2I PIC  X(0003).
  4526*    -------------------------------
  4527     05  CPREM2L PIC S9(0004) COMP.
  4528     05  CPREM2F PIC  X(0001).
  4529     05  FILLER REDEFINES CPREM2F.
  4530         10  CPREM2A PIC  X(0001).
  4531     05  CPREM2I PIC  X(0011).
  4532*    -------------------------------
  4533     05  CENTRDTL PIC S9(0004) COMP.
  4534     05  CENTRDTF PIC  X(0001).
  4535     05  FILLER REDEFINES CENTRDTF.
  4536         10  CENTRDTA PIC  X(0001).
  4537     05  CENTRDTI PIC  X(0008).
  4538*    -------------------------------
  4539     05  CPAYEEL PIC S9(0004) COMP.
  4540     05  CPAYEEF PIC  X(0001).
  4541     05  FILLER REDEFINES CPAYEEF.
  4542         10  CPAYEEA PIC  X(0001).
  4543     05  CPAYEEI PIC  X(0006).
  4544*    -------------------------------
  4545     05  CRFNDSWL PIC S9(0004) COMP.
  4546     05  CRFNDSWF PIC  X(0001).
  4547     05  FILLER REDEFINES CRFNDSWF.
  4548         10  CRFNDSWA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  86
* EL6311.cbl
  4549     05  CRFNDSWI PIC  X(0003).
  4550*    -------------------------------
  4551     05  CLFHDGL PIC S9(0004) COMP.
  4552     05  CLFHDGF PIC  X(0001).
  4553     05  FILLER REDEFINES CLFHDGF.
  4554         10  CLFHDGA PIC  X(0001).
  4555     05  CLFHDGI PIC  X(0006).
  4556*    -------------------------------
  4557     05  CAHHDGL PIC S9(0004) COMP.
  4558     05  CAHHDGF PIC  X(0001).
  4559     05  FILLER REDEFINES CAHHDGF.
  4560         10  CAHHDGA PIC  X(0001).
  4561     05  CAHHDGI PIC  X(0006).
  4562*    -------------------------------
  4563     05  CENTDTL PIC S9(0004) COMP.
  4564     05  CENTDTF PIC  X(0001).
  4565     05  FILLER REDEFINES CENTDTF.
  4566         10  CENTDTA PIC  X(0001).
  4567     05  CENTDTI PIC  X(0008).
  4568*    -------------------------------
  4569     05  CENTBYL PIC S9(0004) COMP.
  4570     05  CENTBYF PIC  X(0001).
  4571     05  FILLER REDEFINES CENTBYF.
  4572         10  CENTBYA PIC  X(0001).
  4573     05  CENTBYI PIC  X(0004).
  4574*    -------------------------------
  4575     05  CCHGCNTL PIC S9(0004) COMP.
  4576     05  CCHGCNTF PIC  X(0001).
  4577     05  FILLER REDEFINES CCHGCNTF.
  4578         10  CCHGCNTA PIC  X(0001).
  4579     05  CCHGCNTI PIC  X(0003).
  4580*    -------------------------------
  4581     05  CLFREFNL PIC S9(0004) COMP.
  4582     05  CLFREFNF PIC  X(0001).
  4583     05  FILLER REDEFINES CLFREFNF.
  4584         10  CLFREFNA PIC  X(0001).
  4585     05  CLFREFNI PIC  X(0006).
  4586*    -------------------------------
  4587     05  CAHREFNL PIC S9(0004) COMP.
  4588     05  CAHREFNF PIC  X(0001).
  4589     05  FILLER REDEFINES CAHREFNF.
  4590         10  CAHREFNA PIC  X(0001).
  4591     05  CAHREFNI PIC  X(0006).
  4592*    -------------------------------
  4593     05  CREINCDL PIC S9(0004) COMP.
  4594     05  CREINCDF PIC  X(0001).
  4595     05  FILLER REDEFINES CREINCDF.
  4596         10  CREINCDA PIC  X(0001).
  4597     05  CREINCDI PIC  X(0003).
  4598*    -------------------------------
  4599     05  CAEFFDTL PIC S9(0004) COMP.
  4600     05  CAEFFDTF PIC  X(0001).
  4601     05  FILLER REDEFINES CAEFFDTF.
  4602         10  CAEFFDTA PIC  X(0001).
  4603     05  CAEFFDTI PIC  X(0008).
  4604*    -------------------------------
  4605     05  CAEXPDTL PIC S9(0004) COMP.
  4606     05  CAEXPDTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  87
* EL6311.cbl
  4607     05  FILLER REDEFINES CAEXPDTF.
  4608         10  CAEXPDTA PIC  X(0001).
  4609     05  CAEXPDTI PIC  X(0008).
  4610*    -------------------------------
  4611     05  COMMLFL PIC S9(0004) COMP.
  4612     05  COMMLFF PIC  X(0001).
  4613     05  FILLER REDEFINES COMMLFF.
  4614         10  COMMLFA PIC  X(0001).
  4615     05  COMMLFI PIC  X(0006).
  4616*    -------------------------------
  4617     05  COMMAHL PIC S9(0004) COMP.
  4618     05  COMMAHF PIC  X(0001).
  4619     05  FILLER REDEFINES COMMAHF.
  4620         10  COMMAHA PIC  X(0001).
  4621     05  COMMAHI PIC  X(0006).
  4622*    -------------------------------
  4623     05  CERMSG1L PIC S9(0004) COMP.
  4624     05  CERMSG1F PIC  X(0001).
  4625     05  FILLER REDEFINES CERMSG1F.
  4626         10  CERMSG1A PIC  X(0001).
  4627     05  CERMSG1I PIC  X(0078).
  4628*    -------------------------------
  4629     05  CERMSG2L PIC S9(0004) COMP.
  4630     05  CERMSG2F PIC  X(0001).
  4631     05  FILLER REDEFINES CERMSG2F.
  4632         10  CERMSG2A PIC  X(0001).
  4633     05  CERMSG2I PIC  X(0078).
  4634*    -------------------------------
  4635     05  CERMSG3L PIC S9(0004) COMP.
  4636     05  CERMSG3F PIC  X(0001).
  4637     05  FILLER REDEFINES CERMSG3F.
  4638         10  CERMSG3A PIC  X(0001).
  4639     05  CERMSG3I PIC  X(0078).
  4640*    -------------------------------
  4641     05  CPFENTRL PIC S9(0004) COMP.
  4642     05  CPFENTRF PIC  X(0001).
  4643     05  FILLER REDEFINES CPFENTRF.
  4644         10  CPFENTRA PIC  X(0001).
  4645     05  CPFENTRI PIC  9(2).
  4646*    -------------------------------
  4647     05  CPF5HDRL PIC S9(0004) COMP.
  4648     05  CPF5HDRF PIC  X(0001).
  4649     05  FILLER REDEFINES CPF5HDRF.
  4650         10  CPF5HDRA PIC  X(0001).
  4651     05  CPF5HDRI PIC  X(0005).
  4652*    -------------------------------
  4653     05  CPF4HDRL PIC S9(0004) COMP.
  4654     05  CPF4HDRF PIC  X(0001).
  4655     05  FILLER REDEFINES CPF4HDRF.
  4656         10  CPF4HDRA PIC  X(0001).
  4657     05  CPF4HDRI PIC  X(0013).
  4658*    -------------------------------
  4659     05  CF15HDRL PIC S9(0004) COMP.
  4660     05  CF15HDRF PIC  X(0001).
  4661     05  FILLER REDEFINES CF15HDRF.
  4662         10  CF15HDRA PIC  X(0001).
  4663     05  CF15HDRI PIC  X(0022).
  4664 01  EL631CO REDEFINES EL631BI.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  88
* EL6311.cbl
  4665     05  FILLER            PIC  X(0012).
  4666*    -------------------------------
  4667     05  FILLER            PIC  X(0003).
  4668     05  CDATEO PIC  X(0008).
  4669*    -------------------------------
  4670     05  FILLER            PIC  X(0003).
  4671     05  CTIMEO PIC  99.99.
  4672*    -------------------------------
  4673     05  FILLER            PIC  X(0003).
  4674     05  CHEADO PIC  X(0038).
  4675*    -------------------------------
  4676     05  FILLER            PIC  X(0003).
  4677     05  CCHGTO PIC  X(0004).
  4678*    -------------------------------
  4679     05  FILLER            PIC  X(0003).
  4680     05  CCHGO PIC  ZZZ9.
  4681*    -------------------------------
  4682     05  FILLER            PIC  X(0003).
  4683     05  CMAINTO PIC  X(0001).
  4684*    -------------------------------
  4685     05  FILLER            PIC  X(0003).
  4686     05  CMANTBYO PIC  X(0004).
  4687*    -------------------------------
  4688     05  FILLER            PIC  X(0003).
  4689     05  CCHGHDGO PIC  X(0003).
  4690*    -------------------------------
  4691     05  FILLER            PIC  X(0003).
  4692     05  CMANTDTO PIC  X(0008).
  4693*    -------------------------------
  4694     05  FILLER            PIC  X(0003).
  4695     05  CMANTATO PIC  99.99.
  4696*    -------------------------------
  4697     05  FILLER            PIC  X(0003).
  4698     05  CCSRO PIC  X(0004).
  4699*    -------------------------------
  4700     05  FILLER            PIC  X(0003).
  4701     05  CBATCHO PIC  X(0006).
  4702*    -------------------------------
  4703     05  FILLER            PIC  X(0003).
  4704     05  CSEQO PIC  X(0004).
  4705*    -------------------------------
  4706     05  FILLER            PIC  X(0003).
  4707     05  CMOENDTO PIC  X(0008).
  4708*    -------------------------------
  4709     05  FILLER            PIC  X(0003).
  4710     05  CCARRO PIC  X(0001).
  4711*    -------------------------------
  4712     05  FILLER            PIC  X(0003).
  4713     05  CGROUPO PIC  X(0006).
  4714*    -------------------------------
  4715     05  FILLER            PIC  X(0003).
  4716     05  CSTATEO PIC  X(0002).
  4717*    -------------------------------
  4718     05  FILLER            PIC  X(0003).
  4719     05  CACCTO PIC  X(0010).
  4720*    -------------------------------
  4721     05  FILLER            PIC  X(0003).
  4722     05  CORIGHDO PIC  X(0011).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  89
* EL6311.cbl
  4723*    -------------------------------
  4724     05  FILLER            PIC  X(0003).
  4725     05  CORGNOO PIC  X(0006).
  4726*    -------------------------------
  4727     05  FILLER            PIC  X(0003).
  4728     05  CORGSEQO PIC  X(0004).
  4729*    -------------------------------
  4730     05  FILLER            PIC  X(0003).
  4731     05  CREFHDGO PIC  X(0010).
  4732*    -------------------------------
  4733     05  FILLER            PIC  X(0003).
  4734     05  CREFO PIC  X(0012).
  4735*    -------------------------------
  4736     05  FILLER            PIC  X(0003).
  4737     05  CNHINTO PIC  999999.99.
  4738*    -------------------------------
  4739     05  FILLER            PIC  X(0003).
  4740     05  CCERTNOO PIC  X(0010).
  4741*    -------------------------------
  4742     05  FILLER            PIC  X(0003).
  4743     05  CSUFIXO PIC  X(0001).
  4744*    -------------------------------
  4745     05  FILLER            PIC  X(0003).
  4746     05  CEFFDTO PIC  X(0008).
  4747*    -------------------------------
  4748     05  FILLER            PIC  X(0003).
  4749     05  CLSTNMO PIC  X(0015).
  4750*    -------------------------------
  4751     05  FILLER            PIC  X(0003).
  4752     05  CPCYNO PIC  X(0001).
  4753*    -------------------------------
  4754     05  FILLER            PIC  X(0003).
  4755     05  CINAMEO PIC  X(0015).
  4756*    -------------------------------
  4757     05  FILLER            PIC  X(0003).
  4758     05  CINITSO PIC  X(0010).
  4759*    -------------------------------
  4760     05  FILLER            PIC  X(0003).
  4761     05  CCANREAO PIC  X(0001).
  4762*    -------------------------------
  4763     05  FILLER            PIC  X(0003).
  4764     05  CKIND1O PIC  X(0002).
  4765*    -------------------------------
  4766     05  FILLER            PIC  X(0003).
  4767     05  CCANDT1O PIC  X(0008).
  4768*    -------------------------------
  4769     05  FILLER            PIC  X(0003).
  4770     05  CREFND1O PIC  Z(7).99-.
  4771*    -------------------------------
  4772     05  FILLER            PIC  X(0003).
  4773     05  CMTHD1O PIC  X(0001).
  4774*    -------------------------------
  4775     05  FILLER            PIC  X(0003).
  4776     05  CKIND2O PIC  X(0002).
  4777*    -------------------------------
  4778     05  FILLER            PIC  X(0003).
  4779     05  CCANDT2O PIC  X(0008).
  4780*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  90
* EL6311.cbl
  4781     05  FILLER            PIC  X(0003).
  4782     05  CREFND2O PIC  Z(7).99-.
  4783*    -------------------------------
  4784     05  FILLER            PIC  X(0003).
  4785     05  CMTHD2O PIC  X(0001).
  4786*    -------------------------------
  4787     05  FILLER            PIC  X(0003).
  4788     05  CLIVESO PIC  X(0003).
  4789*    -------------------------------
  4790     05  FILLER            PIC  X(0003).
  4791     05  CFORCEO PIC  X(0001).
  4792*    -------------------------------
  4793     05  FILLER            PIC  X(0003).
  4794     05  CBILCDO PIC  X(0001).
  4795*    -------------------------------
  4796     05  FILLER            PIC  X(0003).
  4797     05  CCRFND1O PIC  Z(7).99-.
  4798*    -------------------------------
  4799     05  FILLER            PIC  X(0003).
  4800     05  CCRFND2O PIC  Z(7).99-.
  4801*    -------------------------------
  4802     05  FILLER            PIC  X(0003).
  4803     05  CBILIT1O PIC  X(0008).
  4804*    -------------------------------
  4805     05  FILLER            PIC  X(0003).
  4806     05  CDRFND1O PIC  Z(7).99-.
  4807*    -------------------------------
  4808     05  FILLER            PIC  X(0003).
  4809     05  CBILIT2O PIC  X(0008).
  4810*    -------------------------------
  4811     05  FILLER            PIC  X(0003).
  4812     05  CDRFND2O PIC  Z(7).99-.
  4813*    -------------------------------
  4814     05  FILLER            PIC  X(0003).
  4815     05  CCANTXTO PIC  X(0005).
  4816*    -------------------------------
  4817     05  FILLER            PIC  X(0003).
  4818     05  CCANFEEO PIC  Z9.
  4819*    -------------------------------
  4820     05  FILLER            PIC  X(0003).
  4821     05  CTERM1O PIC  ZZ9.
  4822*    -------------------------------
  4823     05  FILLER            PIC  X(0003).
  4824     05  CRTERM1O PIC  ZZ9.
  4825*    -------------------------------
  4826     05  FILLER            PIC  X(0003).
  4827     05  CPREM1O PIC  ZZZZZZ9.99-.
  4828*    -------------------------------
  4829     05  FILLER            PIC  X(0003).
  4830     05  CTERM2O PIC  ZZ9.
  4831*    -------------------------------
  4832     05  FILLER            PIC  X(0003).
  4833     05  CRTERM2O PIC  ZZ9.
  4834*    -------------------------------
  4835     05  FILLER            PIC  X(0003).
  4836     05  CPREM2O PIC  ZZZZZZ9.99-.
  4837*    -------------------------------
  4838     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  91
* EL6311.cbl
  4839     05  CENTRDTO PIC  X(0008).
  4840*    -------------------------------
  4841     05  FILLER            PIC  X(0003).
  4842     05  CPAYEEO PIC  X(0006).
  4843*    -------------------------------
  4844     05  FILLER            PIC  X(0003).
  4845     05  CRFNDSWO PIC  X(0003).
  4846*    -------------------------------
  4847     05  FILLER            PIC  X(0003).
  4848     05  CLFHDGO PIC  X(0006).
  4849*    -------------------------------
  4850     05  FILLER            PIC  X(0003).
  4851     05  CAHHDGO PIC  X(0006).
  4852*    -------------------------------
  4853     05  FILLER            PIC  X(0003).
  4854     05  CENTDTO PIC  X(0008).
  4855*    -------------------------------
  4856     05  FILLER            PIC  X(0003).
  4857     05  CENTBYO PIC  X(0004).
  4858*    -------------------------------
  4859     05  FILLER            PIC  X(0003).
  4860     05  CCHGCNTO PIC  X(0003).
  4861*    -------------------------------
  4862     05  FILLER            PIC  X(0003).
  4863     05  CLFREFNO PIC  X(0006).
  4864*    -------------------------------
  4865     05  FILLER            PIC  X(0003).
  4866     05  CAHREFNO PIC  X(0006).
  4867*    -------------------------------
  4868     05  FILLER            PIC  X(0003).
  4869     05  CREINCDO PIC  X(0003).
  4870*    -------------------------------
  4871     05  FILLER            PIC  X(0003).
  4872     05  CAEFFDTO PIC  X(0008).
  4873*    -------------------------------
  4874     05  FILLER            PIC  X(0003).
  4875     05  CAEXPDTO PIC  X(0008).
  4876*    -------------------------------
  4877     05  FILLER            PIC  X(0003).
  4878     05  COMMLFO PIC  .99999.
  4879*    -------------------------------
  4880     05  FILLER            PIC  X(0003).
  4881     05  COMMAHO PIC  .99999.
  4882*    -------------------------------
  4883     05  FILLER            PIC  X(0003).
  4884     05  CERMSG1O PIC  X(0078).
  4885*    -------------------------------
  4886     05  FILLER            PIC  X(0003).
  4887     05  CERMSG2O PIC  X(0078).
  4888*    -------------------------------
  4889     05  FILLER            PIC  X(0003).
  4890     05  CERMSG3O PIC  X(0078).
  4891*    -------------------------------
  4892     05  FILLER            PIC  X(0003).
  4893     05  CPFENTRO PIC  X(0002).
  4894*    -------------------------------
  4895     05  FILLER            PIC  X(0003).
  4896     05  CPF5HDRO PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  92
* EL6311.cbl
  4897*    -------------------------------
  4898     05  FILLER            PIC  X(0003).
  4899     05  CPF4HDRO PIC  X(0013).
  4900*    -------------------------------
  4901     05  FILLER            PIC  X(0003).
  4902     05  CF15HDRO PIC  X(0022).
  4903*    -------------------------------
  4904 01  EL631DI REDEFINES EL631BI.
  4905     05  FILLER            PIC  X(0012).
  4906*    -------------------------------
  4907     05  DDATEL PIC S9(0004) COMP.
  4908     05  DDATEF PIC  X(0001).
  4909     05  FILLER REDEFINES DDATEF.
  4910         10  DDATEA PIC  X(0001).
  4911     05  DDATEI PIC  X(0008).
  4912*    -------------------------------
  4913     05  DTIMEL PIC S9(0004) COMP.
  4914     05  DTIMEF PIC  X(0001).
  4915     05  FILLER REDEFINES DTIMEF.
  4916         10  DTIMEA PIC  X(0001).
  4917     05  DTIMEI PIC  X(0005).
  4918*    -------------------------------
  4919     05  DHEADL PIC S9(0004) COMP.
  4920     05  DHEADF PIC  X(0001).
  4921     05  FILLER REDEFINES DHEADF.
  4922         10  DHEADA PIC  X(0001).
  4923     05  DHEADI PIC  X(0038).
  4924*    -------------------------------
  4925     05  DLDATEL PIC S9(0004) COMP.
  4926     05  DLDATEF PIC  X(0001).
  4927     05  FILLER REDEFINES DLDATEF.
  4928         10  DLDATEA PIC  X(0001).
  4929     05  DLDATEI PIC  X(0010).
  4930*    -------------------------------
  4931     05  DBATCHL PIC S9(0004) COMP.
  4932     05  DBATCHF PIC  X(0001).
  4933     05  FILLER REDEFINES DBATCHF.
  4934         10  DBATCHA PIC  X(0001).
  4935     05  DBATCHI PIC  X(0011).
  4936*    -------------------------------
  4937     05  DACCTNML PIC S9(0004) COMP.
  4938     05  DACCTNMF PIC  X(0001).
  4939     05  FILLER REDEFINES DACCTNMF.
  4940         10  DACCTNMA PIC  X(0001).
  4941     05  DACCTNMI PIC  X(0030).
  4942*    -------------------------------
  4943     05  DPROCDTL PIC S9(0004) COMP.
  4944     05  DPROCDTF PIC  X(0001).
  4945     05  FILLER REDEFINES DPROCDTF.
  4946         10  DPROCDTA PIC  X(0001).
  4947     05  DPROCDTI PIC  X(0008).
  4948*    -------------------------------
  4949     05  DINPUTL PIC S9(0004) COMP.
  4950     05  DINPUTF PIC  X(0001).
  4951     05  FILLER REDEFINES DINPUTF.
  4952         10  DINPUTA PIC  X(0001).
  4953     05  DINPUTI PIC  X(0008).
  4954*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  93
* EL6311.cbl
  4955     05  DMAINDTL PIC S9(0004) COMP.
  4956     05  DMAINDTF PIC  X(0001).
  4957     05  FILLER REDEFINES DMAINDTF.
  4958         10  DMAINDTA PIC  X(0001).
  4959     05  DMAINDTI PIC  X(0008).
  4960*    -------------------------------
  4961     05  DCARRL PIC S9(0004) COMP.
  4962     05  DCARRF PIC  X(0001).
  4963     05  FILLER REDEFINES DCARRF.
  4964         10  DCARRA PIC  X(0001).
  4965     05  DCARRI PIC  X(0001).
  4966*    -------------------------------
  4967     05  DGROUPL PIC S9(0004) COMP.
  4968     05  DGROUPF PIC  X(0001).
  4969     05  FILLER REDEFINES DGROUPF.
  4970         10  DGROUPA PIC  X(0001).
  4971     05  DGROUPI PIC  X(0006).
  4972*    -------------------------------
  4973     05  DSTATEL PIC S9(0004) COMP.
  4974     05  DSTATEF PIC  X(0001).
  4975     05  FILLER REDEFINES DSTATEF.
  4976         10  DSTATEA PIC  X(0001).
  4977     05  DSTATEI PIC  X(0002).
  4978*    -------------------------------
  4979     05  DACCTL PIC S9(0004) COMP.
  4980     05  DACCTF PIC  X(0001).
  4981     05  FILLER REDEFINES DACCTF.
  4982         10  DACCTA PIC  X(0001).
  4983     05  DACCTI PIC  X(0010).
  4984*    -------------------------------
  4985     05  DRECVDTL PIC S9(0004) COMP.
  4986     05  DRECVDTF PIC  X(0001).
  4987     05  FILLER REDEFINES DRECVDTF.
  4988         10  DRECVDTA PIC  X(0001).
  4989     05  DRECVDTI PIC  X(0008).
  4990*    -------------------------------
  4991     05  DCSRL PIC S9(0004) COMP.
  4992     05  DCSRF PIC  X(0001).
  4993     05  FILLER REDEFINES DCSRF.
  4994         10  DCSRA PIC  X(0001).
  4995     05  DCSRI PIC  X(0004).
  4996*    -------------------------------
  4997     05  DREFHDGL PIC S9(0004) COMP.
  4998     05  DREFHDGF PIC  X(0001).
  4999     05  FILLER REDEFINES DREFHDGF.
  5000         10  DREFHDGA PIC  X(0001).
  5001     05  DREFHDGI PIC  X(0010).
  5002*    -------------------------------
  5003     05  DREFL PIC S9(0004) COMP.
  5004     05  DREFF PIC  X(0001).
  5005     05  FILLER REDEFINES DREFF.
  5006         10  DREFA PIC  X(0001).
  5007     05  DREFI PIC  X(0012).
  5008*    -------------------------------
  5009     05  DLFPHDGL PIC S9(0004) COMP.
  5010     05  DLFPHDGF PIC  X(0001).
  5011     05  FILLER REDEFINES DLFPHDGF.
  5012         10  DLFPHDGA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  94
* EL6311.cbl
  5013     05  DLFPHDGI PIC  X(0010).
  5014*    -------------------------------
  5015     05  DAHPHDGL PIC S9(0004) COMP.
  5016     05  DAHPHDGF PIC  X(0001).
  5017     05  FILLER REDEFINES DAHPHDGF.
  5018         10  DAHPHDGA PIC  X(0001).
  5019     05  DAHPHDGI PIC  X(0010).
  5020*    -------------------------------
  5021     05  DLFRHDGL PIC S9(0004) COMP.
  5022     05  DLFRHDGF PIC  X(0001).
  5023     05  FILLER REDEFINES DLFRHDGF.
  5024         10  DLFRHDGA PIC  X(0001).
  5025     05  DLFRHDGI PIC  X(0009).
  5026*    -------------------------------
  5027     05  DAHRHDGL PIC S9(0004) COMP.
  5028     05  DAHRHDGF PIC  X(0001).
  5029     05  FILLER REDEFINES DAHRHDGF.
  5030         10  DAHRHDGA PIC  X(0001).
  5031     05  DAHRHDGI PIC  X(0009).
  5032*    -------------------------------
  5033     05  DRISSL PIC S9(0004) COMP.
  5034     05  DRISSF PIC  X(0001).
  5035     05  FILLER REDEFINES DRISSF.
  5036         10  DRISSA PIC  X(0001).
  5037     05  DRISSI PIC  X(0005).
  5038*    -------------------------------
  5039     05  DRLFPRML PIC S9(0004) COMP.
  5040     05  DRLFPRMF PIC  X(0001).
  5041     05  FILLER REDEFINES DRLFPRMF.
  5042         10  DRLFPRMA PIC  X(0001).
  5043     05  DRLFPRMI PIC  S9(9)V99.
  5044*    -------------------------------
  5045     05  DRAHPRML PIC S9(0004) COMP.
  5046     05  DRAHPRMF PIC  X(0001).
  5047     05  FILLER REDEFINES DRAHPRMF.
  5048         10  DRAHPRMA PIC  X(0001).
  5049     05  DRAHPRMI PIC  S9(9)V99.
  5050*    -------------------------------
  5051     05  DRCANCL PIC S9(0004) COMP.
  5052     05  DRCANCF PIC  X(0001).
  5053     05  FILLER REDEFINES DRCANCF.
  5054         10  DRCANCA PIC  X(0001).
  5055     05  DRCANCI PIC  X(0005).
  5056*    -------------------------------
  5057     05  DRLFRFDL PIC S9(0004) COMP.
  5058     05  DRLFRFDF PIC  X(0001).
  5059     05  FILLER REDEFINES DRLFRFDF.
  5060         10  DRLFRFDA PIC  X(0001).
  5061     05  DRLFRFDI PIC  S9(9)V99.
  5062*    -------------------------------
  5063     05  DRAHRFDL PIC S9(0004) COMP.
  5064     05  DRAHRFDF PIC  X(0001).
  5065     05  FILLER REDEFINES DRAHRFDF.
  5066         10  DRAHRFDA PIC  X(0001).
  5067     05  DRAHRFDI PIC  S9(9)V99.
  5068*    -------------------------------
  5069     05  DEISSL PIC S9(0004) COMP.
  5070     05  DEISSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  95
* EL6311.cbl
  5071     05  FILLER REDEFINES DEISSF.
  5072         10  DEISSA PIC  X(0001).
  5073     05  DEISSI PIC  X(0005).
  5074*    -------------------------------
  5075     05  DELFPRML PIC S9(0004) COMP.
  5076     05  DELFPRMF PIC  X(0001).
  5077     05  FILLER REDEFINES DELFPRMF.
  5078         10  DELFPRMA PIC  X(0001).
  5079     05  DELFPRMI PIC  X(0011).
  5080*    -------------------------------
  5081     05  DEAHPRML PIC S9(0004) COMP.
  5082     05  DEAHPRMF PIC  X(0001).
  5083     05  FILLER REDEFINES DEAHPRMF.
  5084         10  DEAHPRMA PIC  X(0001).
  5085     05  DEAHPRMI PIC  X(0011).
  5086*    -------------------------------
  5087     05  DECANCL PIC S9(0004) COMP.
  5088     05  DECANCF PIC  X(0001).
  5089     05  FILLER REDEFINES DECANCF.
  5090         10  DECANCA PIC  X(0001).
  5091     05  DECANCI PIC  X(0005).
  5092*    -------------------------------
  5093     05  DELFRFDL PIC S9(0004) COMP.
  5094     05  DELFRFDF PIC  X(0001).
  5095     05  FILLER REDEFINES DELFRFDF.
  5096         10  DELFRFDA PIC  X(0001).
  5097     05  DELFRFDI PIC  X(0011).
  5098*    -------------------------------
  5099     05  DEAHRFDL PIC S9(0004) COMP.
  5100     05  DEAHRFDF PIC  X(0001).
  5101     05  FILLER REDEFINES DEAHRFDF.
  5102         10  DEAHRFDA PIC  X(0001).
  5103     05  DEAHRFDI PIC  X(0011).
  5104*    -------------------------------
  5105     05  DCISSL PIC S9(0004) COMP.
  5106     05  DCISSF PIC  X(0001).
  5107     05  FILLER REDEFINES DCISSF.
  5108         10  DCISSA PIC  X(0001).
  5109     05  DCISSI PIC  X(0005).
  5110*    -------------------------------
  5111     05  DCLFPRML PIC S9(0004) COMP.
  5112     05  DCLFPRMF PIC  X(0001).
  5113     05  FILLER REDEFINES DCLFPRMF.
  5114         10  DCLFPRMA PIC  X(0001).
  5115     05  DCLFPRMI PIC  X(0011).
  5116*    -------------------------------
  5117     05  DCAHPRML PIC S9(0004) COMP.
  5118     05  DCAHPRMF PIC  X(0001).
  5119     05  FILLER REDEFINES DCAHPRMF.
  5120         10  DCAHPRMA PIC  X(0001).
  5121     05  DCAHPRMI PIC  X(0011).
  5122*    -------------------------------
  5123     05  DCCANCL PIC S9(0004) COMP.
  5124     05  DCCANCF PIC  X(0001).
  5125     05  FILLER REDEFINES DCCANCF.
  5126         10  DCCANCA PIC  X(0001).
  5127     05  DCCANCI PIC  X(0005).
  5128*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  96
* EL6311.cbl
  5129     05  DCLFRFDL PIC S9(0004) COMP.
  5130     05  DCLFRFDF PIC  X(0001).
  5131     05  FILLER REDEFINES DCLFRFDF.
  5132         10  DCLFRFDA PIC  X(0001).
  5133     05  DCLFRFDI PIC  X(0011).
  5134*    -------------------------------
  5135     05  DCAHRFDL PIC S9(0004) COMP.
  5136     05  DCAHRFDF PIC  X(0001).
  5137     05  FILLER REDEFINES DCAHRFDF.
  5138         10  DCAHRFDA PIC  X(0001).
  5139     05  DCAHRFDI PIC  X(0011).
  5140*    -------------------------------
  5141     05  DOISSL PIC S9(0004) COMP.
  5142     05  DOISSF PIC  X(0001).
  5143     05  FILLER REDEFINES DOISSF.
  5144         10  DOISSA PIC  X(0001).
  5145     05  DOISSI PIC  X(0005).
  5146*    -------------------------------
  5147     05  DOLFPRML PIC S9(0004) COMP.
  5148     05  DOLFPRMF PIC  X(0001).
  5149     05  FILLER REDEFINES DOLFPRMF.
  5150         10  DOLFPRMA PIC  X(0001).
  5151     05  DOLFPRMI PIC  X(0011).
  5152*    -------------------------------
  5153     05  DOAHPRML PIC S9(0004) COMP.
  5154     05  DOAHPRMF PIC  X(0001).
  5155     05  FILLER REDEFINES DOAHPRMF.
  5156         10  DOAHPRMA PIC  X(0001).
  5157     05  DOAHPRMI PIC  X(0011).
  5158*    -------------------------------
  5159     05  DOCANCL PIC S9(0004) COMP.
  5160     05  DOCANCF PIC  X(0001).
  5161     05  FILLER REDEFINES DOCANCF.
  5162         10  DOCANCA PIC  X(0001).
  5163     05  DOCANCI PIC  X(0005).
  5164*    -------------------------------
  5165     05  DOLFRFDL PIC S9(0004) COMP.
  5166     05  DOLFRFDF PIC  X(0001).
  5167     05  FILLER REDEFINES DOLFRFDF.
  5168         10  DOLFRFDA PIC  X(0001).
  5169     05  DOLFRFDI PIC  X(0011).
  5170*    -------------------------------
  5171     05  DOAHRFDL PIC S9(0004) COMP.
  5172     05  DOAHRFDF PIC  X(0001).
  5173     05  FILLER REDEFINES DOAHRFDF.
  5174         10  DOAHRFDA PIC  X(0001).
  5175     05  DOAHRFDI PIC  X(0011).
  5176*    -------------------------------
  5177     05  DITOTALL PIC S9(0004) COMP.
  5178     05  DITOTALF PIC  X(0001).
  5179     05  FILLER REDEFINES DITOTALF.
  5180         10  DITOTALA PIC  X(0001).
  5181     05  DITOTALI PIC  X(0005).
  5182*    -------------------------------
  5183     05  DIFATALL PIC S9(0004) COMP.
  5184     05  DIFATALF PIC  X(0001).
  5185     05  FILLER REDEFINES DIFATALF.
  5186         10  DIFATALA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  97
* EL6311.cbl
  5187     05  DIFATALI PIC  X(0005).
  5188*    -------------------------------
  5189     05  DIFORCEL PIC S9(0004) COMP.
  5190     05  DIFORCEF PIC  X(0001).
  5191     05  FILLER REDEFINES DIFORCEF.
  5192         10  DIFORCEA PIC  X(0001).
  5193     05  DIFORCEI PIC  X(0005).
  5194*    -------------------------------
  5195     05  DIHOLDL PIC S9(0004) COMP.
  5196     05  DIHOLDF PIC  X(0001).
  5197     05  FILLER REDEFINES DIHOLDF.
  5198         10  DIHOLDA PIC  X(0001).
  5199     05  DIHOLDI PIC  X(0005).
  5200*    -------------------------------
  5201     05  DIAVAILL PIC S9(0004) COMP.
  5202     05  DIAVAILF PIC  X(0001).
  5203     05  FILLER REDEFINES DIAVAILF.
  5204         10  DIAVAILA PIC  X(0001).
  5205     05  DIAVAILI PIC  X(0005).
  5206*    -------------------------------
  5207     05  DIGPREML PIC S9(0004) COMP.
  5208     05  DIGPREMF PIC  X(0001).
  5209     05  FILLER REDEFINES DIGPREMF.
  5210         10  DIGPREMA PIC  X(0001).
  5211     05  DIGPREMI PIC  X(0011).
  5212*    -------------------------------
  5213     05  DIBPREML PIC S9(0004) COMP.
  5214     05  DIBPREMF PIC  X(0001).
  5215     05  FILLER REDEFINES DIBPREMF.
  5216         10  DIBPREMA PIC  X(0001).
  5217     05  DIBPREMI PIC  X(0011).
  5218*    -------------------------------
  5219     05  DCTOTALL PIC S9(0004) COMP.
  5220     05  DCTOTALF PIC  X(0001).
  5221     05  FILLER REDEFINES DCTOTALF.
  5222         10  DCTOTALA PIC  X(0001).
  5223     05  DCTOTALI PIC  X(0005).
  5224*    -------------------------------
  5225     05  DCFATALL PIC S9(0004) COMP.
  5226     05  DCFATALF PIC  X(0001).
  5227     05  FILLER REDEFINES DCFATALF.
  5228         10  DCFATALA PIC  X(0001).
  5229     05  DCFATALI PIC  X(0005).
  5230*    -------------------------------
  5231     05  DCFORCEL PIC S9(0004) COMP.
  5232     05  DCFORCEF PIC  X(0001).
  5233     05  FILLER REDEFINES DCFORCEF.
  5234         10  DCFORCEA PIC  X(0001).
  5235     05  DCFORCEI PIC  X(0005).
  5236*    -------------------------------
  5237     05  DCHOLDL PIC S9(0004) COMP.
  5238     05  DCHOLDF PIC  X(0001).
  5239     05  FILLER REDEFINES DCHOLDF.
  5240         10  DCHOLDA PIC  X(0001).
  5241     05  DCHOLDI PIC  X(0005).
  5242*    -------------------------------
  5243     05  DCAVAILL PIC S9(0004) COMP.
  5244     05  DCAVAILF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  98
* EL6311.cbl
  5245     05  FILLER REDEFINES DCAVAILF.
  5246         10  DCAVAILA PIC  X(0001).
  5247     05  DCAVAILI PIC  X(0005).
  5248*    -------------------------------
  5249     05  DCGPREML PIC S9(0004) COMP.
  5250     05  DCGPREMF PIC  X(0001).
  5251     05  FILLER REDEFINES DCGPREMF.
  5252         10  DCGPREMA PIC  X(0001).
  5253     05  DCGPREMI PIC  X(0011).
  5254*    -------------------------------
  5255     05  DCBPREML PIC S9(0004) COMP.
  5256     05  DCBPREMF PIC  X(0001).
  5257     05  FILLER REDEFINES DCBPREMF.
  5258         10  DCBPREMA PIC  X(0001).
  5259     05  DCBPREMI PIC  X(0011).
  5260*    -------------------------------
  5261     05  DNTOTALL PIC S9(0004) COMP.
  5262     05  DNTOTALF PIC  X(0001).
  5263     05  FILLER REDEFINES DNTOTALF.
  5264         10  DNTOTALA PIC  X(0001).
  5265     05  DNTOTALI PIC  X(0005).
  5266*    -------------------------------
  5267     05  DNFATALL PIC S9(0004) COMP.
  5268     05  DNFATALF PIC  X(0001).
  5269     05  FILLER REDEFINES DNFATALF.
  5270         10  DNFATALA PIC  X(0001).
  5271     05  DNFATALI PIC  X(0005).
  5272*    -------------------------------
  5273     05  DNFORCEL PIC S9(0004) COMP.
  5274     05  DNFORCEF PIC  X(0001).
  5275     05  FILLER REDEFINES DNFORCEF.
  5276         10  DNFORCEA PIC  X(0001).
  5277     05  DNFORCEI PIC  X(0005).
  5278*    -------------------------------
  5279     05  DNHOLDL PIC S9(0004) COMP.
  5280     05  DNHOLDF PIC  X(0001).
  5281     05  FILLER REDEFINES DNHOLDF.
  5282         10  DNHOLDA PIC  X(0001).
  5283     05  DNHOLDI PIC  X(0005).
  5284*    -------------------------------
  5285     05  DNAVAILL PIC S9(0004) COMP.
  5286     05  DNAVAILF PIC  X(0001).
  5287     05  FILLER REDEFINES DNAVAILF.
  5288         10  DNAVAILA PIC  X(0001).
  5289     05  DNAVAILI PIC  X(0005).
  5290*    -------------------------------
  5291     05  DNGPREML PIC S9(0004) COMP.
  5292     05  DNGPREMF PIC  X(0001).
  5293     05  FILLER REDEFINES DNGPREMF.
  5294         10  DNGPREMA PIC  X(0001).
  5295     05  DNGPREMI PIC  X(0011).
  5296*    -------------------------------
  5297     05  DNBPREML PIC S9(0004) COMP.
  5298     05  DNBPREMF PIC  X(0001).
  5299     05  FILLER REDEFINES DNBPREMF.
  5300         10  DNBPREMA PIC  X(0001).
  5301     05  DNBPREMI PIC  X(0011).
  5302*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page  99
* EL6311.cbl
  5303     05  DERMSGL PIC S9(0004) COMP.
  5304     05  DERMSGF PIC  X(0001).
  5305     05  FILLER REDEFINES DERMSGF.
  5306         10  DERMSGA PIC  X(0001).
  5307     05  DERMSGI PIC  X(0075).
  5308*    -------------------------------
  5309     05  DPFENTRL PIC S9(0004) COMP.
  5310     05  DPFENTRF PIC  X(0001).
  5311     05  FILLER REDEFINES DPFENTRF.
  5312         10  DPFENTRA PIC  X(0001).
  5313     05  DPFENTRI PIC  9(2).
  5314 01  EL631DO REDEFINES EL631BI.
  5315     05  FILLER            PIC  X(0012).
  5316*    -------------------------------
  5317     05  FILLER            PIC  X(0003).
  5318     05  DDATEO PIC  X(0008).
  5319*    -------------------------------
  5320     05  FILLER            PIC  X(0003).
  5321     05  DTIMEO PIC  99.99.
  5322*    -------------------------------
  5323     05  FILLER            PIC  X(0003).
  5324     05  DHEADO PIC  X(0038).
  5325*    -------------------------------
  5326     05  FILLER            PIC  X(0003).
  5327     05  DLDATEO PIC  X(0010).
  5328*    -------------------------------
  5329     05  FILLER            PIC  X(0003).
  5330     05  DBATCHO PIC  X(0011).
  5331*    -------------------------------
  5332     05  FILLER            PIC  X(0003).
  5333     05  DACCTNMO PIC  X(0030).
  5334*    -------------------------------
  5335     05  FILLER            PIC  X(0003).
  5336     05  DPROCDTO PIC  X(0008).
  5337*    -------------------------------
  5338     05  FILLER            PIC  X(0003).
  5339     05  DINPUTO PIC  X(0008).
  5340*    -------------------------------
  5341     05  FILLER            PIC  X(0003).
  5342     05  DMAINDTO PIC  X(0008).
  5343*    -------------------------------
  5344     05  FILLER            PIC  X(0003).
  5345     05  DCARRO PIC  X(0001).
  5346*    -------------------------------
  5347     05  FILLER            PIC  X(0003).
  5348     05  DGROUPO PIC  X(0006).
  5349*    -------------------------------
  5350     05  FILLER            PIC  X(0003).
  5351     05  DSTATEO PIC  X(0002).
  5352*    -------------------------------
  5353     05  FILLER            PIC  X(0003).
  5354     05  DACCTO PIC  X(0010).
  5355*    -------------------------------
  5356     05  FILLER            PIC  X(0003).
  5357     05  DRECVDTO PIC  X(0008).
  5358*    -------------------------------
  5359     05  FILLER            PIC  X(0003).
  5360     05  DCSRO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 100
* EL6311.cbl
  5361*    -------------------------------
  5362     05  FILLER            PIC  X(0003).
  5363     05  DREFHDGO PIC  X(0010).
  5364*    -------------------------------
  5365     05  FILLER            PIC  X(0003).
  5366     05  DREFO PIC  X(0012).
  5367*    -------------------------------
  5368     05  FILLER            PIC  X(0003).
  5369     05  DLFPHDGO PIC  X(0010).
  5370*    -------------------------------
  5371     05  FILLER            PIC  X(0003).
  5372     05  DAHPHDGO PIC  X(0010).
  5373*    -------------------------------
  5374     05  FILLER            PIC  X(0003).
  5375     05  DLFRHDGO PIC  X(0009).
  5376*    -------------------------------
  5377     05  FILLER            PIC  X(0003).
  5378     05  DAHRHDGO PIC  X(0009).
  5379*    -------------------------------
  5380     05  FILLER            PIC  X(0003).
  5381     05  DRISSO PIC  ZZ99-.
  5382*    -------------------------------
  5383     05  FILLER            PIC  X(0003).
  5384     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5385*    -------------------------------
  5386     05  FILLER            PIC  X(0003).
  5387     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5388*    -------------------------------
  5389     05  FILLER            PIC  X(0003).
  5390     05  DRCANCO PIC  ZZ99-.
  5391*    -------------------------------
  5392     05  FILLER            PIC  X(0003).
  5393     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5394*    -------------------------------
  5395     05  FILLER            PIC  X(0003).
  5396     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5397*    -------------------------------
  5398     05  FILLER            PIC  X(0003).
  5399     05  DEISSO PIC  ZZ99-.
  5400*    -------------------------------
  5401     05  FILLER            PIC  X(0003).
  5402     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5403*    -------------------------------
  5404     05  FILLER            PIC  X(0003).
  5405     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5406*    -------------------------------
  5407     05  FILLER            PIC  X(0003).
  5408     05  DECANCO PIC  ZZ99-.
  5409*    -------------------------------
  5410     05  FILLER            PIC  X(0003).
  5411     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5412*    -------------------------------
  5413     05  FILLER            PIC  X(0003).
  5414     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5415*    -------------------------------
  5416     05  FILLER            PIC  X(0003).
  5417     05  DCISSO PIC  ZZ99-.
  5418*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 101
* EL6311.cbl
  5419     05  FILLER            PIC  X(0003).
  5420     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5421*    -------------------------------
  5422     05  FILLER            PIC  X(0003).
  5423     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5424*    -------------------------------
  5425     05  FILLER            PIC  X(0003).
  5426     05  DCCANCO PIC  ZZ99-.
  5427*    -------------------------------
  5428     05  FILLER            PIC  X(0003).
  5429     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5430*    -------------------------------
  5431     05  FILLER            PIC  X(0003).
  5432     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5433*    -------------------------------
  5434     05  FILLER            PIC  X(0003).
  5435     05  DOISSO PIC  ZZ99-.
  5436*    -------------------------------
  5437     05  FILLER            PIC  X(0003).
  5438     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5439*    -------------------------------
  5440     05  FILLER            PIC  X(0003).
  5441     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5442*    -------------------------------
  5443     05  FILLER            PIC  X(0003).
  5444     05  DOCANCO PIC  ZZ99-.
  5445*    -------------------------------
  5446     05  FILLER            PIC  X(0003).
  5447     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5448*    -------------------------------
  5449     05  FILLER            PIC  X(0003).
  5450     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5451*    -------------------------------
  5452     05  FILLER            PIC  X(0003).
  5453     05  DITOTALO PIC  ZZZ99.
  5454*    -------------------------------
  5455     05  FILLER            PIC  X(0003).
  5456     05  DIFATALO PIC  ZZZ99.
  5457*    -------------------------------
  5458     05  FILLER            PIC  X(0003).
  5459     05  DIFORCEO PIC  ZZZ99.
  5460*    -------------------------------
  5461     05  FILLER            PIC  X(0003).
  5462     05  DIHOLDO PIC  ZZZ99.
  5463*    -------------------------------
  5464     05  FILLER            PIC  X(0003).
  5465     05  DIAVAILO PIC  ZZZ99.
  5466*    -------------------------------
  5467     05  FILLER            PIC  X(0003).
  5468     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5469*    -------------------------------
  5470     05  FILLER            PIC  X(0003).
  5471     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5472*    -------------------------------
  5473     05  FILLER            PIC  X(0003).
  5474     05  DCTOTALO PIC  ZZZ99.
  5475*    -------------------------------
  5476     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 102
* EL6311.cbl
  5477     05  DCFATALO PIC  ZZZ99.
  5478*    -------------------------------
  5479     05  FILLER            PIC  X(0003).
  5480     05  DCFORCEO PIC  ZZZ99.
  5481*    -------------------------------
  5482     05  FILLER            PIC  X(0003).
  5483     05  DCHOLDO PIC  ZZZ99.
  5484*    -------------------------------
  5485     05  FILLER            PIC  X(0003).
  5486     05  DCAVAILO PIC  ZZZ99.
  5487*    -------------------------------
  5488     05  FILLER            PIC  X(0003).
  5489     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5490*    -------------------------------
  5491     05  FILLER            PIC  X(0003).
  5492     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5493*    -------------------------------
  5494     05  FILLER            PIC  X(0003).
  5495     05  DNTOTALO PIC  ---99.
  5496*    -------------------------------
  5497     05  FILLER            PIC  X(0003).
  5498     05  DNFATALO PIC  ---99.
  5499*    -------------------------------
  5500     05  FILLER            PIC  X(0003).
  5501     05  DNFORCEO PIC  ---99.
  5502*    -------------------------------
  5503     05  FILLER            PIC  X(0003).
  5504     05  DNHOLDO PIC  ---99.
  5505*    -------------------------------
  5506     05  FILLER            PIC  X(0003).
  5507     05  DNAVAILO PIC  ---99.
  5508*    -------------------------------
  5509     05  FILLER            PIC  X(0003).
  5510     05  DNGPREMO PIC  -------9.99.
  5511*    -------------------------------
  5512     05  FILLER            PIC  X(0003).
  5513     05  DNBPREMO PIC  -------9.99.
  5514*    -------------------------------
  5515     05  FILLER            PIC  X(0003).
  5516     05  DERMSGO PIC  X(0075).
  5517*    -------------------------------
  5518     05  FILLER            PIC  X(0003).
  5519     05  DPFENTRO PIC  X(0002).
  5520*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 103
* EL6311.cbl
  5522 01  MAP-B REDEFINES EL631BI.
  5523     12  FILLER                  PIC X(562).
  5524*    12  FILLER                  PIC X(512).
  5525*    12  FILLER                  PIC X(510).
  5526     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5527         16  BKIND-LEN               PIC S9(4)  COMP.
  5528         16  BKIND-ATTRB             PIC X.
  5529         16  BKIND                   PIC XX.
  5530         16  BTYPE-LEN               PIC S9(4)  COMP.
  5531         16  BTYPE-ATTRB             PIC X.
  5532         16  BTYPE                   PIC X(3).
  5533         16  BTERM-LEN               PIC S9(4)  COMP.
  5534         16  BTERM-ATTRB             PIC X.
  5535         16  BTERMI                  PIC 999.
  5536         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5537         16  BBEN-LEN                PIC S9(4)  COMP.
  5538         16  BBEN-ATTRB              PIC X.
  5539         16  BBENI                   PIC 9(10)V99.
  5540*        16  BBENI                   PIC 9(12).
  5541         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5542         16  BPREM-LEN               PIC S9(4)  COMP.
  5543         16  BPREM-ATTRB             PIC X.
  5544         16  BPREMI                  PIC S9(9)V99.
  5545*        16  BPREMI                  PIC 9(11).
  5546         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5547         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5548         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5549         16  BEXPIRE-ATTRB           PIC X.
  5550         16  BEXPIRE                 PIC X(8).
  5551         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5552         16  BCRIT-PERD-ATTRB        PIC X.
  5553         16  BCRIT-PERDI             PIC 99.
  5554         16  BCRIT-PERDO REDEFINES
  5555                         BCRIT-PERDI PIC ZZ.
  5556         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5557         16  BALT-BEN-ATTRB          PIC X.
  5558         16  BALT-BENI               PIC 9(10)V99.
  5559*        16  BALT-BENI               PIC 9(12).
  5560         16  BALT-BENO REDEFINES
  5561                           BALT-BENI PIC Z(9).ZZ.
  5562         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5563         16  BALT-PREM-ATTRB         PIC X.
  5564         16  BALT-PREMI              PIC 9(9)V99.
  5565*        16  BALT-PREMI              PIC 9(11).
  5566         16  BALT-PREMO REDEFINES
  5567                          BALT-PREMI PIC Z(7).ZZ-.
  5568         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5569         16  BBEN-CD-ATTRB           PIC X.
  5570         16  BBEN-CD                 PIC XXX.
  5571         16  BCPREM-LEN              PIC S9(4)  COMP.
  5572         16  BCPREM-ATTRB            PIC X.
  5573         16  BCPREMI                 PIC S9(9)V99.
  5574*        16  BCPREMI                 PIC X(11).
  5575         16  BCPREMO REDEFINES BCPREMI
  5576                                     PIC Z(7).99-.
  5577         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5578         16  BCALT-PREM-ATTRB        PIC X.
  5579         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 104
* EL6311.cbl
  5580         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5581         16  BBEN-ABBR-ATTRB         PIC X.
  5582         16  BBEN-ABBR               PIC X(5).
  5583         16  BDIFF-LEN               PIC S9(4)  COMP.
  5584         16  BDIFF-ATTRB             PIC X.
  5585         16  BDIFFO                  PIC Z(7).99-.
  5586         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5587         16  BBILL-LIT-ATTRB         PIC X.
  5588         16  BBILL-LIT               PIC X(8).
  5589         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5590         16  BDALT-PREM-ATTRB        PIC X.
  5591         16  BDALT-PREM              PIC Z(7).99-.
  5592
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 105
* EL6311.cbl
  5594
  5595****************************************************************
  5596*
  5597* Copyright (c) 2007 by Clerity Solutions, Inc.
  5598* All rights reserved.
  5599*
  5600****************************************************************
  5601 01  DFHEIV.
  5602   02  DFHEIV0               PIC X(35).
  5603   02  DFHEIV1               PIC X(08).
  5604   02  DFHEIV2               PIC X(08).
  5605   02  DFHEIV3               PIC X(08).
  5606   02  DFHEIV4               PIC X(06).
  5607   02  DFHEIV5               PIC X(04).
  5608   02  DFHEIV6               PIC X(04).
  5609   02  DFHEIV7               PIC X(02).
  5610   02  DFHEIV8               PIC X(02).
  5611   02  DFHEIV9               PIC X(01).
  5612   02  DFHEIV10              PIC S9(7) COMP-3.
  5613   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5614   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5615   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5616   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5617   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5618   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5619   02  DFHEIV17              PIC X(04).
  5620   02  DFHEIV18              PIC X(04).
  5621   02  DFHEIV19              PIC X(04).
  5622   02  DFHEIV20              USAGE IS POINTER.
  5623   02  DFHEIV21              USAGE IS POINTER.
  5624   02  DFHEIV22              USAGE IS POINTER.
  5625   02  DFHEIV23              USAGE IS POINTER.
  5626   02  DFHEIV24              USAGE IS POINTER.
  5627   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5628   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5629   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5630   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5631   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5632   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5633   02  FILLER                PIC X(02).
  5634   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5635   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5636   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5637   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5638   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5639 LINKAGE  SECTION.
  5640*****************************************************************
  5641*                                                               *
  5642* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  5643* All rights reserved.                                          *
  5644*                                                               *
  5645*****************************************************************
  5646 01  dfheiblk.
  5647     02  eibtime          pic s9(7) comp-3.
  5648     02  eibdate          pic s9(7) comp-3.
  5649     02  eibtrnid         pic x(4).
  5650     02  eibtaskn         pic s9(7) comp-3.
  5651     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 106
* EL6311.cbl
  5652     02  dfheigdi         pic s9(4) comp.
  5653     02  eibcposn         pic s9(4) comp.
  5654     02  eibcalen         pic s9(4) comp.
  5655     02  eibaid           pic x(1).
  5656     02  eibfiller1       pic x(1).
  5657     02  eibfn            pic x(2).
  5658     02  eibfiller2       pic x(2).
  5659     02  eibrcode         pic x(6).
  5660     02  eibfiller3       pic x(2).
  5661     02  eibds            pic x(8).
  5662     02  eibreqid         pic x(8).
  5663     02  eibrsrce         pic x(8).
  5664     02  eibsync          pic x(1).
  5665     02  eibfree          pic x(1).
  5666     02  eibrecv          pic x(1).
  5667     02  eibsend          pic x(1).
  5668     02  eibatt           pic x(1).
  5669     02  eibeoc           pic x(1).
  5670     02  eibfmh           pic x(1).
  5671     02  eibcompl         pic x(1).
  5672     02  eibsig           pic x(1).
  5673     02  eibconf          pic x(1).
  5674     02  eiberr           pic x(1).
  5675     02  eibrldbk         pic x(1).
  5676     02  eiberrcd         pic x(4).
  5677     02  eibsynrb         pic x(1).
  5678     02  eibnodat         pic x(1).
  5679     02  eibfiller5       pic x(2).
  5680     02  eibresp          pic 9(09) comp.
  5681     02  eibresp2         pic 9(09) comp.
  5682     02  dfheigdj         pic s9(4) comp.
  5683     02  dfheigdk         pic s9(4) comp.
  5684 01  DFHCOMMAREA                 PIC X(1300).
  5685
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 107
* EL6311.cbl
  5687*    COPY ERCPNDB.
  5688******************************************************************
  5689*                                                                *
  5690*                                                                *
  5691*                            ERCPNDB.                            *
  5692*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5693*                            VMOD=2.025                          *
  5694*                                                                *
  5695*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5696*                                                                *
  5697******************************************************************
  5698*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5699*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5700******************************************************************
  5701*                                                                *
  5702*                                                                *
  5703*   FILE TYPE = VSAM,KSDS                                        *
  5704*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5705*                                                                *
  5706*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5707*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5708*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5709*                                                 RKP=13,LEN=36  *
  5710*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5711*                                      AND CHG-SEQ.)             *
  5712*                                                RKP=49,LEN=11   *
  5713*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5714*                                      AND CHG-SEQ.)             *
  5715*                                                RKP=60,LEN=15   *
  5716*                                                                *
  5717*   LOG = NO                                                     *
  5718*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5719******************************************************************
  5720******************************************************************
  5721*                   C H A N G E   L O G
  5722*
  5723* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5724*-----------------------------------------------------------------
  5725*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5726* EFFECTIVE    NUMBER
  5727*-----------------------------------------------------------------
  5728* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5729* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5730* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5731* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5732* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5733* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5734* 032306                   PEMA  ADD BOW LOAN NUMBER
  5735* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5736* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5737* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5738* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5739* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5740* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5741* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5742* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5743******************************************************************
  5744
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 108
* EL6311.cbl
  5745 01  PENDING-BUSINESS.
  5746     12  PB-RECORD-ID                     PIC XX.
  5747         88  VALID-PB-ID                        VALUE 'PB'.
  5748
  5749     12  PB-CONTROL-PRIMARY.
  5750         16  PB-COMPANY-CD                PIC X.
  5751         16  PB-ENTRY-BATCH               PIC X(6).
  5752         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5753         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5754
  5755     12  PB-CONTROL-BY-ACCOUNT.
  5756         16  PB-COMPANY-CD-A1             PIC X.
  5757         16  PB-CARRIER                   PIC X.
  5758         16  PB-GROUPING.
  5759             20  PB-GROUPING-PREFIX       PIC XXX.
  5760             20  PB-GROUPING-PRIME        PIC XXX.
  5761         16  PB-STATE                     PIC XX.
  5762         16  PB-ACCOUNT.
  5763             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5764             20  PB-ACCOUNT-PRIME         PIC X(6).
  5765         16  PB-CERT-EFF-DT               PIC XX.
  5766         16  PB-CERT-NO.
  5767             20  PB-CERT-PRIME            PIC X(10).
  5768             20  PB-CERT-SFX              PIC X.
  5769         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5770
  5771         16  PB-RECORD-TYPE               PIC X.
  5772             88  PB-MAILING-DATA                VALUE '0'.
  5773             88  PB-ISSUE                       VALUE '1'.
  5774             88  PB-CANCELLATION                VALUE '2'.
  5775             88  PB-BATCH-TRAILER               VALUE '9'.
  5776
  5777     12  PB-CONTROL-BY-ORIG-BATCH.
  5778         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5779         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5780         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5781         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5782
  5783     12  PB-CONTROL-BY-CSR.
  5784         16  PB-CSR-COMPANY-CD            PIC X.
  5785         16  PB-CSR-ID                    PIC X(4).
  5786         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5787         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5788         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5789******************************************************************
  5790*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5791******************************************************************
  5792
  5793     12  PB-LAST-MAINT-DT                 PIC XX.
  5794     12  PB-LAST-MAINT-BY                 PIC X(4).
  5795     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5796
  5797     12  PB-RECORD-BODY                   PIC X(375).
  5798
  5799     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5800         16  PB-CERT-ORIGIN               PIC X.
  5801             88  CLASIC-CREATED-CERT         VALUE '1'.
  5802         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 109
* EL6311.cbl
  5803             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5804             20  PB-I-INSURED-FIRST-NAME.
  5805                 24  PB-I-INSURED-1ST-INIT PIC X.
  5806                 24  FILLER                PIC X(9).
  5807             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5808         16  PB-I-AGE                     PIC S99   COMP-3.
  5809         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5810         16  PB-I-BIRTHDAY                PIC XX.
  5811         16  PB-I-INSURED-SEX             PIC X.
  5812             88  PB-SEX-MALE     VALUE 'M'.
  5813             88  PB-SEX-FEMALE   VALUE 'F'.
  5814
  5815         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  5816         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5817         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5818         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5819         16  PB-I-SKIP-CODE               PIC X.
  5820             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5821             88  PB-SKIP-JULY              VALUE '1'.
  5822             88  PB-SKIP-AUGUST            VALUE '2'.
  5823             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5824             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5825             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5826             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5827             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5828             88  PB-SKIP-JUNE              VALUE '8'.
  5829             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5830             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  5831             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  5832         16  PB-I-TERM-TYPE               PIC X.
  5833             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  5834             88  PB-PAID-WEEKLY            VALUE 'W'.
  5835             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  5836             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  5837             88  PB-PAID-13-YEARLY         VALUE 'T'.
  5838         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  5839         16  PB-I-POLICY-FORM-NO          PIC X(12).
  5840         16  PB-I-DATA-ENTRY-SW           PIC X.
  5841             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  5842             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  5843             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  5844             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  5845         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  5846         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  5847*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  5848         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  5849         16  FILLER                       PIC X.
  5850
  5851         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  5852             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  5853             88  PB-INVALID-LIFE             VALUE '  ' '00'
  5854                                                   '90' THRU '99'.
  5855         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  5856                                          PIC XX.
  5857         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  5858         16  PB-I-AMOUNT-FINANCED REDEFINES
  5859                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  5860         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 110
* EL6311.cbl
  5861         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  5862                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  5863         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5864         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5865         16  PB-I-CLP-AMOUNT REDEFINES
  5866                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  5867         16  PB-I-LF-CALC-FLAG            PIC X.
  5868             88 PB-COMP-LF-PREM               VALUE '?'.
  5869         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5870         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5871         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5872         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5873         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5874         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5875         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5876         16  PB-I-LF-ABBR                 PIC XXX.
  5877         16  PB-I-LF-INPUT-CD             PIC XX.
  5878
  5879         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5880             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5881             88  PB-INVALID-AH               VALUE '  ' '00'
  5882                                                   '90' THRU '99'.
  5883         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5884         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5885         16  PB-I-AH-CALC-FLAG            PIC X.
  5886             88 PB-COMP-AH-PREM                  VALUE '?'.
  5887         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5888         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5889         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5890         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5891         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5892         16  PB-I-AH-ABBR                 PIC XXX.
  5893         16  PB-I-AH-INPUT-CD             PIC XXX.
  5894
  5895         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5896         16  PB-I-REIN-TABLE              PIC XXX.
  5897         16  PB-I-BUSINESS-TYPE           PIC 99.
  5898         16  PB-I-INDV-GRP-CD             PIC X.
  5899         16  PB-I-MORT-CODE.
  5900             20  PB-I-TABLE               PIC X.
  5901             20  PB-I-INTEREST            PIC XX.
  5902             20  PB-I-MORT-TYP            PIC X.
  5903         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5904         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5905         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5906         16  PB-I-INDV-GRP-OVRD           PIC X.
  5907         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5908         16  PB-I-SIG-SW                  PIC X.
  5909             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5910         16  PB-I-RATE-CLASS              PIC XX.
  5911         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5912         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5913         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5914         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5915         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5916         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5917         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5918         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 111
* EL6311.cbl
  5919         16  PB-I-OB-FLAG                 PIC X.
  5920             88  PB-I-OB                      VALUE 'B'.
  5921             88  PB-I-SUMMARY                 VALUE 'Z'.
  5922         16  PB-I-ENTRY-STATUS            PIC X.
  5923             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5924                                              'M' '5' '9' '2'.
  5925             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5926             88  PB-I-POLICY-PENDING          VALUE '2'.
  5927             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5928             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5929             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5930             88  PB-I-REIN-ONLY               VALUE '9'.
  5931             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5932             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5933             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5934             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5935         16  PB-I-INT-CODE                PIC X.
  5936             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5937             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5938         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5939         16  PB-I-SOC-SEC-NO              PIC X(11).
  5940         16  PB-I-MEMBER-NO               PIC X(12).
  5941         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5942*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5943         16  PB-I-OLD-LOF                 PIC XXX.
  5944         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5945         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5946         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5947         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5948         16  PB-I-LIFE-INDICATOR          PIC X.
  5949             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5950         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5951         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5952                                          PIC S9(5)V99    COMP-3.
  5953         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5954             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5955             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5956         16  PB-I-1ST-PMT-DT              PIC XX.
  5957         16  PB-I-JOINT-INSURED.
  5958             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5959             20 PB-I-JOINT-FIRST-NAME.
  5960                24  PB-I-JOINT-FIRST-INIT PIC X.
  5961                24  FILLER                PIC X(9).
  5962             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5963*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5964         16  PB-I-BENEFICIARY-NAME.
  5965             20  PB-I-BANK-NUMBER         PIC X(10).
  5966             20  FILLER                   PIC X(15).
  5967         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5968         16  PB-I-REFERENCE               PIC X(12).
  5969         16  FILLER REDEFINES PB-I-REFERENCE.
  5970             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5971             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5972             20  PB-I-CLP-STATE           PIC XX.
  5973         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5974             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5975             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5976             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 112
* EL6311.cbl
  5977         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5978         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5979         16  PB-I-RESIDENT-STATE          PIC XX.
  5980         16  PB-I-RATE-CODE               PIC X(4).
  5981         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  5982         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5983         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5984         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5985         16  PB-I-BANK-NOCHRGB            PIC 99.
  5986         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5987         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5988
  5989     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5990         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5991             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5992         16  PB-C-CANCEL-ORIGIN           PIC X.
  5993             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5994         16  PB-C-LF-CANCEL-DT            PIC XX.
  5995         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5996         16  PB-C-LF-CALC-REQ             PIC X.
  5997             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5998         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5999         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6000         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6001             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6002         16  PB-C-AH-CANCEL-DT            PIC XX.
  6003         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6004         16  PB-C-AH-CALC-REQ             PIC X.
  6005             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6006         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6007         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6008         16  PB-C-LAST-NAME               PIC X(15).
  6009         16  PB-C-REFUND-SW               PIC X.
  6010             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6011             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6012         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6013         16  PB-C-PAYEE-CODE              PIC X(6).
  6014         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6015         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6016         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6017         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6018         16  PB-C-REFERENCE               PIC X(12).
  6019         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6020         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6021         16  PB-C-POST-CARD-IND           PIC X.
  6022         16  PB-C-CANCEL-REASON           PIC X.
  6023         16  PB-C-REF-INTERFACE-SW        PIC X.
  6024         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6025         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6026         16  FILLER                       PIC X(01).
  6027*        16  FILLER                       PIC X(18).
  6028         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6029*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6030         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6031         16  PB-CANCELED-CERT-DATA.
  6032             20  PB-CI-INSURED-NAME.
  6033                 24  PB-CI-LAST-NAME      PIC X(15).
  6034                 24  PB-CI-INITIALS       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 113
* EL6311.cbl
  6035             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6036             20  PB-CI-INSURED-SEX        PIC X.
  6037             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6038             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6039             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6040             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6041             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6042             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6043             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6044             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6045             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6046             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6047             20  PB-CI-RATE-CLASS         PIC XX.
  6048             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6049             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6050             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6051             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6052             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6053             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6054             20  PB-CI-LF-ABBR            PIC X(3).
  6055             20  PB-CI-AH-ABBR            PIC X(3).
  6056             20  PB-CI-OB-FLAG            PIC X.
  6057                 88  PB-CI-OB                VALUE 'B'.
  6058             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6059                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6060                                           'M' '4' '5' '9' '2'.
  6061                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6062                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6063                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6064                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6065                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6066                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6067                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6068                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6069                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6070                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6071                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6072                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6073             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6074                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6075                                           'M' '4' '5' '9' '2'.
  6076                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6077                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6078                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6079                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6080                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6081                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6082                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6083                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6084                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6085                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6086                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6087                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6088             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6089             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6090             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6091             20  PB-CI-MEMBER-NO          PIC X(12).
  6092             20  PB-CI-INT-CODE           PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 114
* EL6311.cbl
  6093                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6094                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6095             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6096             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6097             20  PB-CI-COMP-EXCP-SW       PIC X.
  6098                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6099                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6100             20  PB-CI-ENTRY-STATUS       PIC X.
  6101             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6102             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  6103             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6104             20  PB-CI-DEATH-DT           PIC XX.
  6105             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6106             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6107             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6108             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6109             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6110             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6111             20  PB-CI-ENTRY-DT              PIC XX.
  6112             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6113             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6114             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6115             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6116             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6117             20  PB-CI-OLD-LOF               PIC XXX.
  6118*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6119             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6120             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6121             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6122             20  PB-CI-INDV-GRP-CD           PIC X.
  6123             20  PB-CI-BENEFICIARY-NAME.
  6124                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6125                 24  FILLER                  PIC X(15).
  6126             20  PB-CI-NOTE-SW               PIC X.
  6127             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6128             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6129             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6130             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6131             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6132             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6133             20  PB-CI-FIRST-NAME            PIC X(10).
  6134             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6135
  6136         16  FILLER                       PIC X(13).
  6137*032306  16  FILLER                       PIC X(27).
  6138*        16  FILLER                       PIC X(46).
  6139
  6140     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6141         16  FILLER                       PIC X(10).
  6142         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6143         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6144         16  PB-M-INSURED-MID-INIT        PIC X.
  6145         16  PB-M-INSURED-AGE             PIC 99.
  6146         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6147         16  PB-M-INSURED-SEX             PIC X.
  6148         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6149         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6150         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 115
* EL6311.cbl
  6151         16  PB-M-INSURED-CITY-STATE.
  6152             20  PB-M-INSURED-CITY        PIC X(28).
  6153             20  PB-M-INSURED-STATE       PIC XX.
  6154         16  PB-M-INSURED-ZIP-CODE.
  6155             20  PB-M-INSURED-ZIP-PRIME.
  6156                 24  PB-M-INSURED-ZIP-1   PIC X.
  6157                     88  PB-M-CANADIAN-POST-CODE
  6158                                             VALUE 'A' THRU 'Z'.
  6159                 24  FILLER               PIC X(4).
  6160             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  6161         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6162                                        PB-M-INSURED-ZIP-CODE.
  6163             20  PM-M-INS-CAN-POST1       PIC XXX.
  6164             20  PM-M-INS-CAN-POST2       PIC XXX.
  6165             20  FILLER                   PIC XXX.
  6166         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6167         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6168         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6169         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6170         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6171         16  PB-M-CRED-BENE-CITYST.
  6172             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6173             20  PB-M-CRED-BENE-STATE     PIC XX.
  6174         16  FILLER                       PIC X(92).
  6175
  6176     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6177         16  FILLER                       PIC X(10).
  6178         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6179         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6180         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6181         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6182         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6183         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6184         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6185         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6186         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6187         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6188         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6189         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6190         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6191         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6192         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6193         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6194         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6195         16  PB-ACCOUNT-NAME              PIC X(30).
  6196         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6197         16  PB-REFERENCE                 PIC X(12).
  6198         16  PB-B-RECEIVED-DT             PIC XX.
  6199         16  FILLER                       PIC X(234).
  6200
  6201     12  PB-RECORD-STATUS.
  6202         16  PB-CREDIT-SELECT-DT          PIC XX.
  6203         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6204         16  PB-BILLED-DT                 PIC XX.
  6205         16  PB-BILLING-STATUS            PIC X.
  6206             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6207             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6208             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 116
* EL6311.cbl
  6209         16  PB-RECORD-BILL               PIC X.
  6210             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6211             88  PB-RECORD-RETURNED           VALUE 'R'.
  6212             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6213             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6214             88  PB-OVERRIDE-AH               VALUE 'A'.
  6215             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6216         16  PB-BATCH-ENTRY               PIC X.
  6217             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6218             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  6219             88  PB-REISSUED-CERT             VALUE 'E'.
  6220             88  PB-MONTHLY-CERT              VALUE 'M'.
  6221             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6222             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6223             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6224         16  PB-FORCE-CODE                PIC X.
  6225             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6226             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6227             88  PB-CANCEL-FORCE              VALUE '8'.
  6228             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6229             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6230             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6231             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6232             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6233             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6234             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6235         16  PB-FATAL-FLAG                PIC X.
  6236             88  PB-FATAL-ERRORS              VALUE 'X'.
  6237         16  PB-FORCE-ER-CD               PIC X.
  6238             88  PB-FORCE-ERRORS              VALUE 'F'.
  6239             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6240         16  PB-WARN-ER-CD                PIC X.
  6241             88  PB-WARNING-ERRORS            VALUE 'W'.
  6242         16  FILLER                       PIC X.
  6243         16  PB-OUT-BAL-CD                PIC X.
  6244             88  PB-OUT-OF-BAL                VALUE 'O'.
  6245         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6246         16  PB-AH-OVERRIDE-L1            PIC X.
  6247         16  PB-INPUT-DT                  PIC XX.
  6248         16  PB-INPUT-BY                  PIC X(4).
  6249         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6250         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6251         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6252         16  PB-LF-EARNING-METHOD         PIC X.
  6253         16  PB-AH-EARNING-METHOD         PIC X.
  6254         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6255         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6256         16  PB-REIN-CD                   PIC XXX.
  6257         16  PB-LF-REFUND-TYPE            PIC X.
  6258         16  PB-AH-REFUND-TYPE            PIC X.
  6259         16  PB-ACCT-EFF-DT               PIC XX.
  6260         16  PB-ACCT-EXP-DT               PIC XX.
  6261         16  PB-COMPANY-ID                PIC X(3).
  6262         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6263         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6264         16  PB-SV-CARRIER                PIC X.
  6265         16  PB-SV-GROUPING               PIC X(6).
  6266         16  PB-SV-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 117
* EL6311.cbl
  6267         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6268         16  PB-GA-BILLING-INFO.
  6269             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6270                                          PIC XX.
  6271         16  PB-SV-REMIT-TO  REDEFINES
  6272             PB-GA-BILLING-INFO           PIC X(10).
  6273         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6274         16  PB-I-LOAN-OFFICER            PIC X(5).
  6275         16  PB-I-VIN                     PIC X(17).
  6276
  6277         16  FILLER                       PIC X(04).
  6278         16  IMNET-BYPASS-SW              PIC X.
  6279
  6280******************************************************************
  6281*                COMMON EDIT ERRORS                              *
  6282******************************************************************
  6283
  6284     12  PB-COMMON-ERRORS.
  6285         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6286                                           PIC S9(4)     COMP.
  6287
  6288******************************************************************
  6289
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 118
* EL6311.cbl
  6291*    COPY ELCCERT.
  6292******************************************************************
  6293*                                                                *
  6294*                            ELCCERT.                            *
  6295*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6296*                            VMOD=2.013                          *
  6297*                                                                *
  6298*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6299*                                                                *
  6300*   FILE TYPE = VSAM,KSDS                                        *
  6301*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6302*                                                                *
  6303*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6304*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6305*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6306*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6307*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6308*                                                                *
  6309*   LOG = YES                                                    *
  6310*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6311******************************************************************
  6312*                   C H A N G E   L O G
  6313*
  6314* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6315*-----------------------------------------------------------------
  6316*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6317* EFFECTIVE    NUMBER
  6318*-----------------------------------------------------------------
  6319* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6320* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6321* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6322* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6323* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6324* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6325* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6326* 032612  CR2011110200001  PEMA  AHL CHANGES
  6327******************************************************************
  6328
  6329 01  CERTIFICATE-MASTER.
  6330     12  CM-RECORD-ID                      PIC XX.
  6331         88  VALID-CM-ID                      VALUE 'CM'.
  6332
  6333     12  CM-CONTROL-PRIMARY.
  6334         16  CM-COMPANY-CD                 PIC X.
  6335         16  CM-CARRIER                    PIC X.
  6336         16  CM-GROUPING.
  6337             20  CM-GROUPING-PREFIX        PIC X(3).
  6338             20  CM-GROUPING-PRIME         PIC X(3).
  6339         16  CM-STATE                      PIC XX.
  6340         16  CM-ACCOUNT.
  6341             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6342             20  CM-ACCOUNT-PRIME          PIC X(6).
  6343         16  CM-CERT-EFF-DT                PIC XX.
  6344         16  CM-CERT-NO.
  6345             20  CM-CERT-PRIME             PIC X(10).
  6346             20  CM-CERT-SFX               PIC X.
  6347
  6348     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 119
* EL6311.cbl
  6349         16  CM-COMPANY-CD-A1              PIC X.
  6350         16  CM-INSURED-LAST-NAME          PIC X(15).
  6351         16  CM-INSURED-INITIALS.
  6352             20  CM-INSURED-INITIAL1       PIC X.
  6353             20  CM-INSURED-INITIAL2       PIC X.
  6354
  6355     12  CM-CONTROL-BY-SSN.
  6356         16  CM-COMPANY-CD-A2              PIC X.
  6357         16  CM-SOC-SEC-NO.
  6358             20  CM-SSN-STATE              PIC XX.
  6359             20  CM-SSN-ACCOUNT            PIC X(6).
  6360             20  CM-SSN-LN3.
  6361                 25  CM-INSURED-INITIALS-A2.
  6362                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6363                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6364                 25 CM-PART-LAST-NAME-A2         PIC X.
  6365
  6366     12  CM-CONTROL-BY-CERT-NO.
  6367         16  CM-COMPANY-CD-A4              PIC X.
  6368         16  CM-CERT-NO-A4                 PIC X(11).
  6369
  6370     12  CM-CONTROL-BY-MEMB.
  6371         16  CM-COMPANY-CD-A5              PIC X.
  6372         16  CM-MEMBER-NO.
  6373             20  CM-MEMB-STATE             PIC XX.
  6374             20  CM-MEMB-ACCOUNT           PIC X(6).
  6375             20  CM-MEMB-LN4.
  6376                 25  CM-INSURED-INITIALS-A5.
  6377                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6378                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6379                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6380
  6381     12  CM-INSURED-PROFILE-DATA.
  6382         16  CM-INSURED-FIRST-NAME.
  6383             20  CM-INSURED-1ST-INIT       PIC X.
  6384             20  FILLER                    PIC X(9).
  6385         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6386         16  CM-INSURED-SEX                PIC X.
  6387             88  CM-SEX-MALE                  VALUE 'M'.
  6388             88  CM-SEX-FEMAL                 VALUE 'F'.
  6389         16  CM-INSURED-JOINT-AGE          PIC 99.
  6390         16  CM-JOINT-INSURED-NAME.
  6391             20  CM-JT-LAST-NAME           PIC X(15).
  6392             20  CM-JT-FIRST-NAME.
  6393                 24  CM-JT-1ST-INIT        PIC X.
  6394                 24  FILLER                PIC X(9).
  6395             20  CM-JT-INITIAL             PIC X.
  6396
  6397     12  CM-LIFE-DATA.
  6398         16  CM-LF-BENEFIT-CD              PIC XX.
  6399         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6400         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6401         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6402         16  CM-LF-DEV-CODE                PIC XXX.
  6403         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6404         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6405         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6406         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 120
* EL6311.cbl
  6407         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6408         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6409         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6410         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6411         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6412         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6413         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6414         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6415         16  FILLER                        PIC XX.
  6416
  6417     12  CM-AH-DATA.
  6418         16  CM-AH-BENEFIT-CD              PIC XX.
  6419         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6420         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6421         16  CM-AH-DEV-CODE                PIC XXX.
  6422         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6423         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6424         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6425         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6426         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6427         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6428         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6429         16  CM-AH-PAID-THRU-DT            PIC XX.
  6430             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6431         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6432         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6433         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6434         16  FILLER                        PIC X.
  6435
  6436     12  CM-LOAN-INFORMATION.
  6437         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6438         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6439                                           PIC S9(5)V99  COMP-3.
  6440         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6441         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6442         16  CM-PAY-FREQUENCY              PIC S99.
  6443         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6444         16  CM-RATE-CLASS                 PIC XX.
  6445         16  CM-BENEFICIARY                PIC X(25).
  6446         16  CM-POLICY-FORM-NO             PIC X(12).
  6447         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6448         16  CM-LAST-ADD-ON-DT             PIC XX.
  6449         16  CM-DEDUCTIBLE-AMOUNTS.
  6450             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6451             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6452         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6453             20  CM-RESIDENT-STATE         PIC XX.
  6454             20  CM-RATE-CODE              PIC X(4).
  6455             20  FILLER                    PIC XX.
  6456         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6457             20  CM-LOAN-OFFICER           PIC X(5).
  6458             20  FILLER                    PIC XXX.
  6459         16  CM-CSR-CODE                   PIC XXX.
  6460         16  CM-UNDERWRITING-CODE          PIC X.
  6461             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6462         16  CM-POST-CARD-IND              PIC X.
  6463         16  CM-NH-INTERFACE-SW            PIC X.
  6464         16  CM-PREMIUM-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 121
* EL6311.cbl
  6465             88  CM-SING-PRM                  VALUE '1'.
  6466             88  CM-O-B-COVERAGE              VALUE '2'.
  6467             88  CM-OPEN-END                  VALUE '3'.
  6468         16  CM-IND-GRP-TYPE               PIC X.
  6469             88  CM-INDIVIDUAL                VALUE 'I'.
  6470             88  CM-GROUP                     VALUE 'G'.
  6471         16  CM-SKIP-CODE                  PIC X.
  6472             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6473             88  SKIP-JULY                    VALUE '1'.
  6474             88  SKIP-AUGUST                  VALUE '2'.
  6475             88  SKIP-SEPTEMBER               VALUE '3'.
  6476             88  SKIP-JULY-AUG                VALUE '4'.
  6477             88  SKIP-AUG-SEPT                VALUE '5'.
  6478             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6479             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6480             88  SKIP-JUNE                    VALUE '8'.
  6481             88  SKIP-JUNE-JULY               VALUE '9'.
  6482             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6483             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6484         16  CM-PAYMENT-MODE               PIC X.
  6485             88  PAY-MONTHLY                  VALUE SPACE.
  6486             88  PAY-WEEKLY                   VALUE '1'.
  6487             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6488             88  PAY-BI-WEEKLY                VALUE '3'.
  6489             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6490         16  CM-LOAN-NUMBER                PIC X(8).
  6491         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6492         16  CM-OLD-LOF                    PIC XXX.
  6493*        16  CM-LOAN-OFFICER               PIC XXX.
  6494         16  CM-REIN-TABLE                 PIC XXX.
  6495         16  CM-SPECIAL-REIN-CODE          PIC X.
  6496         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6497         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6498         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6499
  6500     12  CM-STATUS-DATA.
  6501         16  CM-ENTRY-STATUS               PIC X.
  6502         16  CM-ENTRY-DT                   PIC XX.
  6503
  6504         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  6505         16  CM-LF-CANCEL-DT               PIC XX.
  6506         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6507
  6508         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6509         16  CM-LF-DEATH-DT                PIC XX.
  6510         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6511
  6512         16  CM-LF-CURRENT-STATUS          PIC X.
  6513             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6514                                                'M' '4' '5' '9'.
  6515             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6516             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6517             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6518             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6519             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6520             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6521             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6522             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 122
* EL6311.cbl
  6523             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6524             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6525             88  CM-LF-DECLINED               VALUE 'D'.
  6526             88  CM-LF-VOIDED                 VALUE 'V'.
  6527
  6528         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6529         16  CM-AH-CANCEL-DT               PIC XX.
  6530         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6531
  6532         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6533         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6534         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6535
  6536         16  CM-AH-CURRENT-STATUS          PIC X.
  6537             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6538                                                'M' '4' '5' '9'.
  6539             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6540             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6541             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6542             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6543             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6544             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6545             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6546             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6547             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6548             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6549             88  CM-AH-DECLINED               VALUE 'D'.
  6550             88  CM-AH-VOIDED                 VALUE 'V'.
  6551
  6552         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6553             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6554             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6555             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6556         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6557
  6558         16  CM-ENTRY-BATCH                PIC X(6).
  6559         16  CM-LF-EXIT-BATCH              PIC X(6).
  6560         16  CM-AH-EXIT-BATCH              PIC X(6).
  6561         16  CM-LAST-MONTH-END             PIC XX.
  6562
  6563     12  CM-NOTE-SW                        PIC X.
  6564         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6565         88  CERT-NOTES-PRESENT               VALUE '1'.
  6566         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6567         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6568         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6569         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6570         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6571         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6572     12  CM-COMP-EXCP-SW                   PIC X.
  6573         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6574         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6575     12  CM-INSURED-ADDRESS-SW             PIC X.
  6576         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6577         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6578
  6579*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6580     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 123
* EL6311.cbl
  6581     12  FILLER                            PIC X.
  6582
  6583*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6584     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6585     12  FILLER                            PIC X.
  6586*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6587     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6588
  6589     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6590         88  CERT-ADDED-BATCH                 VALUE ' '.
  6591         88  CERT-ADDED-ONLINE                VALUE '1'.
  6592         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6593         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6594         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6595     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6596         88  CERT-AS-LOADED                   VALUE ' '.
  6597         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6598         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6599         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6600         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6601         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6602         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6603         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6604
  6605     12  CM-ACCOUNT-COMM-PCTS.
  6606         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6607         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6608
  6609     12  CM-USER-FIELD                     PIC X.
  6610     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6611     12  CM-CLP-STATE                      PIC XX.
  6612     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6613     12  CM-USER-RESERVED                  PIC XXX.
  6614     12  FILLER REDEFINES CM-USER-RESERVED.
  6615         16  CM-AH-CLASS-CD                PIC XX.
  6616         16  F                             PIC X.
  6617******************************************************************
  6618
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 124
* EL6311.cbl
  6620*    COPY ERCNOTE.
  6621******************************************************************
  6622*                                                                *
  6623*                                                                *
  6624*                            ERCNOTE                             *
  6625*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6626*                            VMOD=2.003                          *
  6627*                                                                *
  6628*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6629*                                                                *
  6630*        FILE TYPE= VSAM,KSDS                                    *
  6631*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6632*                                                                *
  6633*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6634*                                                                *
  6635*        LOG = YES                                               *
  6636*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6637*                                                                *
  6638******************************************************************
  6639*                   C H A N G E   L O G
  6640*
  6641* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6642*-----------------------------------------------------------------
  6643*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6644* EFFECTIVE    NUMBER
  6645*-----------------------------------------------------------------
  6646* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6647*                                FILE WILL CONTAIN BILLING NOTES O
  6648******************************************************************
  6649
  6650 01  CERTIFICATE-NOTE.
  6651     12  CN-RECORD-ID                PIC  XX.
  6652         88  VALID-CN-ID                  VALUE 'CN'.
  6653
  6654     12  CN-CONTROL-PRIMARY.
  6655         16  CN-COMPANY-CD           PIC X.
  6656         16  CN-CARRIER              PIC X.
  6657         16  CN-GROUPING.
  6658             20 CN-GROUPING-PREFIX   PIC XXX.
  6659             20 CN-GROUPING-PRIME    PIC XXX.
  6660         16  CN-STATE                PIC XX.
  6661         16  CN-ACCOUNT.
  6662             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6663             20 CN-ACCOUNT-PRIME     PIC X(6).
  6664         16  CN-CERT-EFF-DT          PIC XX.
  6665         16  CN-CERT-NO.
  6666             20  CN-CERT-PRIME       PIC X(10).
  6667             20  CN-CERT-SFX         PIC X.
  6668
  6669     12  CN-BILLING-START-LINE-NO    PIC 99.
  6670     12  CN-BILLING-END-LINE-NO      PIC 99.
  6671
  6672     12  CN-LINES.
  6673         16  CN-LINE OCCURS 10       PIC X(77).
  6674
  6675     12  CN-LAST-MAINT-DT            PIC XX.
  6676     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6677     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 125
* EL6311.cbl
  6678     12  FILLER                      PIC X(6).
  6679******************************************************************
  6680
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 126
* EL6311.cbl
  6682*    COPY ERCPNDM.
  6683******************************************************************
  6684*                                                                *
  6685*                                                                *
  6686*                            ERCPNDM                             *
  6687*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6688*                            VMOD=2.003                          *
  6689*                                                                *
  6690*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6691*                                                                *
  6692*   FILE TYPE = VSAM,KSDS                                        *
  6693*   RECORD SIZE = 374   RECFORM = FIX                            *
  6694*                                                                *
  6695*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6696*   ALTERNATE PATH    = NOT USED                                 *
  6697*                                                                *
  6698*   LOG = YES                                                    *
  6699*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6700******************************************************************
  6701*                   C H A N G E   L O G
  6702*
  6703* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6704*-----------------------------------------------------------------
  6705*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6706* EFFECTIVE    NUMBER
  6707*-----------------------------------------------------------------
  6708* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6709* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6710* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6711******************************************************************
  6712
  6713 01  PENDING-MAILING-DATA.
  6714     12  PM-RECORD-ID                      PIC XX.
  6715         88  VALID-MA-ID                       VALUE 'PM'.
  6716
  6717     12  PM-CONTROL-PRIMARY.
  6718         16  PM-COMPANY-CD                 PIC X.
  6719         16  PM-ENTRY-BATCH                PIC X(6).
  6720         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6721         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6722
  6723     12  FILLER                            PIC X(14).
  6724
  6725     12  PM-ACCESS-CONTROL.
  6726         16  PM-SOURCE-SYSTEM              PIC XX.
  6727             88  PM-FROM-CREDIT                VALUE 'CR'.
  6728             88  PM-FROM-VSI                   VALUE 'VS'.
  6729             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6730             88  PM-FROM-OTHER                 VALUE 'OT'.
  6731         16  PM-RECORD-ADD-DT              PIC XX.
  6732         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6733         16  PM-LAST-MAINT-DT              PIC XX.
  6734         16  PM-LAST-MAINT-BY              PIC XXXX.
  6735         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6736
  6737     12  PM-PROFILE-INFO.
  6738         16  PM-QUALIFY-CODE-1             PIC XX.
  6739         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 127
* EL6311.cbl
  6740         16  PM-QUALIFY-CODE-3             PIC XX.
  6741         16  PM-QUALIFY-CODE-4             PIC XX.
  6742         16  PM-QUALIFY-CODE-5             PIC XX.
  6743
  6744         16  PM-INSURED-LAST-NAME          PIC X(15).
  6745         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6746         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6747         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6748         16  PM-INSURED-BIRTH-DT           PIC XX.
  6749         16  PM-INSURED-SEX                PIC X.
  6750             88  PM-SEX-MALE                   VALUE 'M'.
  6751             88  PM-SEX-FEMALE                 VALUE 'F'.
  6752         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6753
  6754         16  PM-ADDRESS-CORRECTED          PIC X.
  6755         16  PM-JOINT-BIRTH-DT             PIC XX.
  6756*        16  FILLER                        PIC X(12).
  6757
  6758         16  PM-ADDRESS-LINE-1             PIC X(30).
  6759         16  PM-ADDRESS-LINE-2             PIC X(30).
  6760         16  PM-CITY-STATE.
  6761             20  PM-CITY                   PIC X(28).
  6762             20  PM-STATE                  PIC XX.
  6763         16  PM-ZIP.
  6764             20  PM-ZIP-CODE.
  6765                 24  PM-ZIP-1              PIC X.
  6766                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6767                 24  FILLER                PIC X(4).
  6768             20  PM-ZIP-PLUS4              PIC X(4).
  6769         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6770             20  PM-CAN-POST1              PIC XXX.
  6771             20  PM-CAN-POST2              PIC XXX.
  6772             20  FILLER                    PIC XXX.
  6773
  6774         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6775
  6776         16  FILLER                        PIC X(03).
  6777
  6778     12  PM-CRED-BENE-INFO.
  6779         16  PM-CRED-BENE-NAME             PIC X(25).
  6780         16  PM-CRED-BENE-ADDR             PIC X(30).
  6781         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6782         16  PM-CRED-BENE-CTYST.
  6783             20  PM-CRED-BENE-CITY         PIC X(28).
  6784             20  PM-CRED-BENE-STATE        PIC XX.
  6785         16  PM-CRED-BENE-ZIP.
  6786             20  PM-CB-ZIP-CODE.
  6787                 24  PM-CB-ZIP-1           PIC X.
  6788                     88  PM-CB-CANADIAN-POST-CODE
  6789                                  VALUE 'A' THRU 'Z'.
  6790                 24  FILLER                PIC X(4).
  6791             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6792         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6793             20  PM-CB-CAN-POST1           PIC XXX.
  6794             20  PM-CB-CAN-POST2           PIC XXX.
  6795             20  FILLER                    PIC XXX.
  6796     12  PM-POST-CARD-MAIL-DATA.
  6797         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 128
* EL6311.cbl
  6798             20  PM-MAIL-TYPE              PIC X.
  6799                 88  PM-12MO-MAILING           VALUE '1'.
  6800                 88  PM-EXP-MAILING            VALUE '2'.
  6801             20  PM-MAIL-STATUS            PIC X.
  6802                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6803                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6804                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6805             20  PM-MAIL-DATE              PIC XX.
  6806     12  FILLER                            PIC XX.
  6807     12  FILLER                            PIC X(12).
  6808*    12  FILLER                            PIC X(30).
  6809
  6810******************************************************************
  6811
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 129
* EL6311.cbl
  6813*    COPY ERCMAIL.
  6814******************************************************************
  6815*                                                                *
  6816*                                                                *
  6817*                            ERCMAIL                             *
  6818*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6819*                            VMOD=2.003                          *
  6820*                                                                *
  6821*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6822*                                                                *
  6823*   FILE TYPE = VSAM,KSDS                                        *
  6824*   RECORD SIZE = 374   RECFORM = FIX                            *
  6825*                                                                *
  6826*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6827*   ALTERNATE PATH    = NOT USED                                 *
  6828*                                                                *
  6829*   LOG = YES                                                    *
  6830*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6831******************************************************************
  6832*                   C H A N G E   L O G
  6833*
  6834* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6835*-----------------------------------------------------------------
  6836*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6837* EFFECTIVE    NUMBER
  6838*-----------------------------------------------------------------
  6839* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6840* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6841* 111108                   PEMA  ADD CRED BENE ADDR2
  6842******************************************************************
  6843
  6844 01  MAILING-DATA.
  6845     12  MA-RECORD-ID                      PIC XX.
  6846         88  VALID-MA-ID                       VALUE 'MA'.
  6847
  6848     12  MA-CONTROL-PRIMARY.
  6849         16  MA-COMPANY-CD                 PIC X.
  6850         16  MA-CARRIER                    PIC X.
  6851         16  MA-GROUPING.
  6852             20  MA-GROUPING-PREFIX        PIC XXX.
  6853             20  MA-GROUPING-PRIME         PIC XXX.
  6854         16  MA-STATE                      PIC XX.
  6855         16  MA-ACCOUNT.
  6856             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6857             20  MA-ACCOUNT-PRIME          PIC X(6).
  6858         16  MA-CERT-EFF-DT                PIC XX.
  6859         16  MA-CERT-NO.
  6860             20  MA-CERT-PRIME             PIC X(10).
  6861             20  MA-CERT-SFX               PIC X.
  6862
  6863     12  FILLER                            PIC XX.
  6864
  6865     12  MA-ACCESS-CONTROL.
  6866         16  MA-SOURCE-SYSTEM              PIC XX.
  6867             88  MA-FROM-CREDIT                VALUE 'CR'.
  6868             88  MA-FROM-VSI                   VALUE 'VS'.
  6869             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6870             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 130
* EL6311.cbl
  6871         16  MA-RECORD-ADD-DT              PIC XX.
  6872         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6873         16  MA-LAST-MAINT-DT              PIC XX.
  6874         16  MA-LAST-MAINT-BY              PIC XXXX.
  6875         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6876
  6877     12  MA-PROFILE-INFO.
  6878         16  MA-QUALIFY-CODE-1             PIC XX.
  6879         16  MA-QUALIFY-CODE-2             PIC XX.
  6880         16  MA-QUALIFY-CODE-3             PIC XX.
  6881         16  MA-QUALIFY-CODE-4             PIC XX.
  6882         16  MA-QUALIFY-CODE-5             PIC XX.
  6883
  6884         16  MA-INSURED-LAST-NAME          PIC X(15).
  6885         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6886         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6887         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6888         16  MA-INSURED-BIRTH-DT           PIC XX.
  6889         16  MA-INSURED-SEX                PIC X.
  6890             88  MA-SEX-MALE                   VALUE 'M'.
  6891             88  MA-SEX-FEMALE                 VALUE 'F'.
  6892         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6893
  6894         16  MA-ADDRESS-CORRECTED          PIC X.
  6895         16  MA-JOINT-BIRTH-DT             PIC XX.
  6896*        16  FILLER                        PIC X(12).
  6897
  6898         16  MA-ADDRESS-LINE-1             PIC X(30).
  6899         16  MA-ADDRESS-LINE-2             PIC X(30).
  6900         16  MA-CITY-STATE.
  6901             20  MA-CITY                   PIC X(28).
  6902             20  MA-ADDR-STATE             PIC XX.
  6903         16  MA-ZIP.
  6904             20  MA-ZIP-CODE.
  6905                 24  MA-ZIP-CODE-1ST       PIC X(1).
  6906                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6907                 24  FILLER                PIC X(4).
  6908             20  MA-ZIP-PLUS4              PIC X(4).
  6909         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  6910             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  6911             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  6912             20  FILLER                    PIC X(3).
  6913
  6914         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  6915
  6916         16  FILLER                        PIC XXX.
  6917*        16  FILLER                        PIC X(10).
  6918
  6919     12  MA-CRED-BENE-INFO.
  6920         16  MA-CRED-BENE-NAME                 PIC X(25).
  6921         16  MA-CRED-BENE-ADDR                 PIC X(30).
  6922         16  MA-CRED-BENE-ADDR2                PIC X(30).
  6923         16  MA-CRED-BENE-CTYST.
  6924             20  MA-CRED-BENE-CITY             PIC X(28).
  6925             20  MA-CRED-BENE-STATE            PIC XX.
  6926         16  MA-CRED-BENE-ZIP.
  6927             20  MA-CB-ZIP-CODE.
  6928                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 131
* EL6311.cbl
  6929                     88  MA-CB-CANADIAN-POST-CODE
  6930                                           VALUE 'A' THRU 'Z'.
  6931                 24  FILLER                    PIC X(4).
  6932             20  MA-CB-ZIP-PLUS4               PIC X(4).
  6933         16  MA-CB-CANADIAN-POSTAL-CODE
  6934                            REDEFINES MA-CRED-BENE-ZIP.
  6935             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  6936             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  6937             20  FILLER                        PIC X(3).
  6938     12  MA-POST-CARD-MAIL-DATA.
  6939         16  MA-MAIL-DATA OCCURS 7.
  6940             20  MA-MAIL-TYPE              PIC X.
  6941                 88  MA-12MO-MAILING           VALUE '1'.
  6942                 88  MA-EXP-MAILING            VALUE '2'.
  6943             20  MA-MAIL-STATUS            PIC X.
  6944                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  6945                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  6946                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  6947             20  MA-MAIL-DATE              PIC XX.
  6948     12  FILLER                            PIC XX.
  6949     12  FILLER                            PIC XX.
  6950*    12  FILLER                            PIC X(30).
  6951******************************************************************
  6952
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 132
* EL6311.cbl
  6954*    COPY ERCRQST.
  6955******************************************************************
  6956*                                                                *
  6957*                                                                *
  6958*                            ERCRQST.                            *
  6959*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6960*                            VMOD=2.002                          *
  6961*                                                                *
  6962*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  6963*                                                                *
  6964*   FILE TYPE = VSAM,KSDS                                        *
  6965*   RECORD SIZE = 200  RECFORM = FIXED                           *
  6966*                                                                *
  6967*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  6968*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  6969*                                   ACCOUNT, REF, BATCH)         *
  6970*                                                RKP=9, LEN=38   *
  6971*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  6972*                                   ACCOUNT, REF, BATCH)         *
  6973*                                                RKP=47, LEN=46  *
  6974*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  6975*                                   BATCH)                       *
  6976*                                                RKP=93, LEN=24  *
  6977*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  6978*                                   REF, BATCH)                  *
  6979*                                                RKP=117, LEN=35 *
  6980*   LOG = NO                                                     *
  6981*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6982******************************************************************
  6983
  6984 01  AR-REQUEST-RECORD.
  6985     12  RQ-RECORD-ID                     PIC XX.
  6986         88  VALID-RQ-ID                        VALUE 'RQ'.
  6987
  6988     12  RQ-CONTROL-PRIMARY.
  6989         16  RQ-COMPANY-CD                PIC X.
  6990         16  RQ-ENTRY-BATCH               PIC X(6).
  6991
  6992     12  RQ-CONTROL-BY-ACCT-REF.
  6993         16  RQ-COMPANY-CD-A1             PIC X.
  6994         16  RQ-CARRIER-A1                PIC X.
  6995         16  RQ-GROUPING-A1               PIC X(6).
  6996         16  RQ-STATE-A1                  PIC XX.
  6997         16  RQ-ACCOUNT-A1                PIC X(10).
  6998         16  RQ-REFERENCE-A1              PIC X(12).
  6999         16  RQ-BATCH-A1                  PIC X(6).
  7000
  7001     12  RQ-CONTROL-BY-FIN-RESP.
  7002         16  RQ-COMPANY-CD-A2             PIC X.
  7003         16  RQ-CARRIER-A2                PIC X.
  7004         16  RQ-GROUPING-A2               PIC X(6).
  7005         16  RQ-FIN-RESP-A2               PIC X(10).
  7006         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7007         16  RQ-REFERENCE-A2              PIC X(12).
  7008         16  RQ-BATCH-A2                  PIC X(6).
  7009
  7010     12  RQ-CONTROL-BY-ACCT-AGENT.
  7011         16  RQ-COMPANY-CD-A3             PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 133
* EL6311.cbl
  7012         16  RQ-CARRIER-A3                PIC X.
  7013         16  RQ-GROUPING-A3               PIC X(6).
  7014         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7015         16  RQ-BATCH-A3                  PIC X(6).
  7016
  7017     12  RQ-CONTROL-BY-SUMMARY.
  7018         16  RQ-COMPANY-CD-A4             PIC X.
  7019         16  RQ-SUMMARY-CODE              PIC X(6).
  7020         16  RQ-ACCOUNT-A4                PIC X(10).
  7021         16  RQ-REFERENCE-A4              PIC X(12).
  7022         16  RQ-BATCH-A4                  PIC X(6).
  7023
  7024     12  RQ-REQUEST-METHOD                PIC X.
  7025         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7026         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7027         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7028         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7029     12  FILLER                           PIC X.
  7030     12  RQ-STATUS                        PIC X.
  7031         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7032         88  RQ-RESUBMIT                      VALUE 'R'.
  7033     12  RQ-PROCESSOR-ID                  PIC X(4).
  7034     12  RQ-ENTRY-DT                      PIC XX.
  7035     12  RQ-MO-END-DT                     PIC XX.
  7036     12  RQ-REQUEST-DT                    PIC XX.
  7037     12  RQ-STMT-DT                       PIC XX.
  7038     12  RQ-REVERSAL-DT                   PIC XX.
  7039     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7040     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7041
  7042     12  FILLER                           PIC X(27).
  7043
  7044******************************************************************
  7045
  7046
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 134
* EL6311.cbl
  7048*    COPY ERCLOFC.
  7049******************************************************************
  7050*                                                                *
  7051*                                                                *
  7052*                            ERCLOFC                             *
  7053*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7054*                            VMOD=2.003                          *
  7055*                                                                *
  7056*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7057*                                                                *
  7058*   FILE TYPE = VSAM,KSDS                                        *
  7059*   RECORD SIZE = 670   RECFORM = FIX                            *
  7060*                                                                *
  7061*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7062*                                                                *
  7063*   LOG = YES                                                    *
  7064*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7065*                                                                *
  7066******************************************************************
  7067
  7068 01  LOAN-OFFICER-MASTER.
  7069     12  LO-RECORD-ID                PIC XX.
  7070         88  VALID-LO-ID                VALUE 'LO'.
  7071
  7072     12  LO-CONTROL-PRIMARY.
  7073         16  LO-COMPANY-CD           PIC X.
  7074         16  LO-CARRIER              PIC X.
  7075         16  LO-GROUPING.
  7076             20  LO-GROUPING-PREFIX  PIC XXX.
  7077             20  LO-GROUPING-PRIME   PIC XXX.
  7078         16  LO-STATE                PIC XX.
  7079         16  LO-ACCOUNT.
  7080             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7081             20  LO-ACCOUNT-PRIME    PIC X(6).
  7082         16  LO-OFFICER-CODE         PIC X(5).
  7083
  7084     12  LO-OFFICER-NAME             PIC X(30).
  7085
  7086     12  LO-LAST-MAINT-DT            PIC XX.
  7087     12  LO-LAST-USER                PIC X(4).
  7088     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7089
  7090     12  LO-COMP-CONTROL             PIC X.
  7091             88  LO-SHOW-COMP           VALUE 'Y'.
  7092             88  LO-SUPPRESS-COMP       VALUE 'N'.
  7093     12  LO-DETAIL-CONTROL           PIC X.
  7094             88  LO-PRINT-DETAIL        VALUE 'D'.
  7095             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7096
  7097     12  LO-SV-CARRIER               PIC X.
  7098     12  LO-SV-GROUPING              PIC X(6).
  7099     12  LO-SV-STATE                 PIC XX.
  7100
  7101     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7102     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7103
  7104     12  LO-OFFICER-INFO.
  7105         16  FILLER OCCURS 12 TIMES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 135
* EL6311.cbl
  7106             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7107             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7108             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7109             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7110             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7111             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7112             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7113             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7114     12  FILLER                      PIC X(198).
  7115******************************************************************
  7116
  7117*    COPY ERCPYAJ.
  7118******************************************************************
  7119*                                                                *
  7120*                            ERCPYAJ                             *
  7121*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7122*                            VMOD=2.015                          *
  7123*                                                                *
  7124*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7125*                                                                *
  7126*                                                                *
  7127*   FILE TYPE = VSAM,KSDS                                        *
  7128*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7129*                                                                *
  7130*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7131*       ALTERNATE PATHS = NONE                                   *
  7132*                                                                *
  7133*   LOG = YES                                                    *
  7134*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7135******************************************************************
  7136******************************************************************
  7137*                   C H A N G E   L O G
  7138*
  7139* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7140*-----------------------------------------------------------------
  7141*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7142* EFFECTIVE    NUMBER
  7143*-----------------------------------------------------------------
  7144* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7145* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7146******************************************************************
  7147
  7148 01  PENDING-PAY-ADJ.
  7149     12  PY-RECORD-ID                     PIC XX.
  7150         88  VALID-PY-ID                        VALUE 'PY'.
  7151
  7152     12  PY-CONTROL-PRIMARY.
  7153         16  PY-COMPANY-CD                PIC X.
  7154         16  PY-CARRIER                   PIC X.
  7155         16  PY-GROUPING                  PIC X(6).
  7156         16  PY-FIN-RESP                  PIC X(10).
  7157         16  PY-ACCOUNT                   PIC X(10).
  7158         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7159                                          PIC X(10).
  7160         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7161         16  PY-RECORD-TYPE               PIC X.
  7162             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7163             88  PY-DEPOSIT                   VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 136
* EL6311.cbl
  7164             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7165             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7166             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7167             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7168             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7169             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7170             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7171             88  PY-FICA-ENTRY                VALUE 'F'.
  7172             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7173             88  PY-POLICY-FEE                VALUE 'W'.
  7174             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7175
  7176     12  PY-PYMT-TYPE                     PIC X.
  7177             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7178             88  PY-REINS-PYMT                VALUE 'R'.
  7179             88  PY-EXP-PYMT                  VALUE 'E'.
  7180
  7181     12  PY-BIL-INV                       PIC X(6).
  7182     12  PY-REF-NO                        PIC X(12).
  7183
  7184     12  PY-LAST-MAINT-DT                 PIC XX.
  7185     12  PY-LAST-MAINT-BY                 PIC X(4).
  7186     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7187
  7188     12  PY-PYADJ-RECORD.
  7189         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7190         16  PY-ENTRY-COMMENT             PIC X(30).
  7191         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7192             20  PY-GL-ACCOUNT            PIC X(10).
  7193             20  PY-GL-STATE              PIC X(02).
  7194             20  PY-GL-CANC-SW            PIC X(01).
  7195                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7196                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7197             20  PY-GL-COMMENT            PIC X(10).
  7198             20  FILLER      REDEFINES PY-GL-COMMENT.
  7199                 24  PY-GL-CHECK-NO       PIC 9(06).
  7200                 24  FILLER               PIC X(04).
  7201             20  FILLER                   PIC X(07).
  7202         16  PY-SAVE-ACCOUNT              PIC X(10).
  7203         16  PY-SAVE-TYPE                 PIC X(01).
  7204
  7205         16  PY-LETTERS.
  7206             20  PY-LETTER OCCURS 3 TIMES
  7207                           INDEXED BY PY-LET-NDX
  7208                                          PIC X(04).
  7209
  7210         16  PY-ERCOMP-TYPE               PIC X.
  7211             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7212             88  PY-GA-TYPE                   VALUE 'G'.
  7213             88  PY-BANK-TYPE                 VALUE 'B'.
  7214         16  FILLER                       PIC X(05).
  7215
  7216     12  PY-RECORD-STATUS.
  7217         16  PY-CREDIT-SELECT-DT          PIC XX.
  7218         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7219         16  PY-BILLED-DATE               PIC XX.
  7220         16  PY-REPORTED-DT               PIC XX.
  7221         16  PY-PMT-APPLIED               PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 137
* EL6311.cbl
  7222             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7223             88  PY-GA-PMT                    VALUE 'G'.
  7224             88  PY-OVWRITE-PMT               VALUE 'O'.
  7225             88  PY-NON-AR-PMT                VALUE 'N'.
  7226         16  FILLER                       PIC X(5).
  7227         16  PY-INPUT-DT                  PIC XX.
  7228         16  PY-CHECK-NUMBER              PIC X(6).
  7229         16  PY-VOID-SW                   PIC X.
  7230             88  PY-CHECK-VOIDED              VALUE 'V'.
  7231         16  PY-CHECK-ORIGIN-SW           PIC X.
  7232             88  PY-BILLING-CHECK             VALUE 'B'.
  7233             88  PY-REFUND-CHECK              VALUE 'R'.
  7234             88  PY-GA-CHECK                  VALUE 'G'.
  7235             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7236             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7237         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7238         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7239         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7240         16  PY-BILL-FLAG                 PIC X.
  7241             88  PY-BILLED                    VALUE 'B'.
  7242         16  PY-AR-FLAG                   PIC X.
  7243             88  PY-AR-CYCLE                  VALUE 'C'.
  7244             88  PY-AR-MONTH-END              VALUE 'M'.
  7245         16  PY-AR-DATE                   PIC XX.
  7246
  7247     12  PY-GL-CODES.
  7248         16  PY-GL-DB                     PIC X(14).
  7249         16  PY-GL-CR                     PIC X(14).
  7250         16  PY-GL-FLAG                   PIC X.
  7251         16  PY-GL-DATE                   PIC XX.
  7252
  7253     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7254     12  FILLER                           PIC X(3).
  7255******************************************************************
  7256
  7257*    COPY ERCCNOT.
  7258******************************************************************
  7259*                                                                *
  7260*                            ERCCNOT                             *
  7261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7262*                            VMOD=2.003                          *
  7263*                                                                *
  7264*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7265*                                                                *
  7266*        FILE TYPE= VSAM,KSDS                                    *
  7267*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7268*                                                                *
  7269*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7270*                                                                *
  7271*        LOG = YES                                               *
  7272*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7273*                                                                *
  7274******************************************************************
  7275*                   C H A N G E   L O G
  7276*
  7277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7278*-----------------------------------------------------------------
  7279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 138
* EL6311.cbl
  7280* EFFECTIVE    NUMBER
  7281*-----------------------------------------------------------------
  7282* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7283******************************************************************
  7284
  7285 01  CERT-NOTE-FILE.
  7286     12  CZ-RECORD-ID                PIC  XX.
  7287         88  VALID-CZ-ID                  VALUE 'CZ'.
  7288
  7289     12  CZ-CONTROL-PRIMARY.
  7290         16  CZ-COMPANY-CD           PIC X.
  7291         16  CZ-CARRIER              PIC X.
  7292         16  CZ-GROUPING.
  7293             20 CZ-GROUPING-PREFIX   PIC XXX.
  7294             20 CZ-GROUPING-PRIME    PIC XXX.
  7295         16  CZ-STATE                PIC XX.
  7296         16  CZ-ACCOUNT.
  7297             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7298             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7299         16  CZ-CERT-EFF-DT          PIC XX.
  7300         16  CZ-CERT-NO.
  7301             20  CZ-CERT-PRIME       PIC X(10).
  7302             20  CZ-CERT-SFX         PIC X.
  7303         16  CZ-RECORD-TYPE          PIC X.
  7304             88  CERT-NOTE           VALUE '1'.
  7305             88  CLAIM-CERT-NOTE     VALUE '2'.
  7306         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7307
  7308     12  CZ-LAST-MAINT-DT            PIC XX.
  7309     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7310     12  CZ-LAST-MAINT-USER          PIC X(4).
  7311
  7312     12  CZ-NOTE-INFORMATION.
  7313         16  CZ-NOTE                 PIC X(63).
  7314         16  FILLER                  PIC X(39).
  7315******************************************************************
  7316
  7317*    COPY ELCMSTR.
  7318******************************************************************
  7319*                                                                *
  7320*                            ELCMSTR.                            *
  7321*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7322*                            VMOD=2.012                          *
  7323*                                                                *
  7324*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7325*                                                                *
  7326*   FILE TYPE = VSAM,KSDS                                        *
  7327*   RECORD SIZE = 350  RECFORM = FIXED                           *
  7328*                                                                *
  7329*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7330*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7331*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7332*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7333*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7334*                                                 RKP=75,LEN=21  *
  7335*                                                                *
  7336*   **** NOTE ****                                               *
  7337*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 139
* EL6311.cbl
  7338*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7339*                                                                *
  7340*   LOG = YES                                                    *
  7341*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7342******************************************************************
  7343*                   C H A N G E   L O G
  7344*
  7345* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7346*-----------------------------------------------------------------
  7347*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7348* EFFECTIVE    NUMBER
  7349*-----------------------------------------------------------------
  7350* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7351* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7352******************************************************************
  7353 01  CLAIM-MASTER.
  7354     12  CL-RECORD-ID                PIC XX.
  7355         88  VALID-CL-ID         VALUE 'CL'.
  7356
  7357     12  CL-CONTROL-PRIMARY.
  7358         16  CL-COMPANY-CD           PIC X.
  7359         16  CL-CARRIER              PIC X.
  7360         16  CL-CLAIM-NO             PIC X(7).
  7361         16  CL-CERT-NO.
  7362             20  CL-CERT-PRIME       PIC X(10).
  7363             20  CL-CERT-SFX         PIC X.
  7364
  7365     12  CL-CONTROL-BY-NAME.
  7366         16  CL-COMPANY-CD-A1        PIC X.
  7367         16  CL-INSURED-LAST-NAME    PIC X(15).
  7368         16  CL-INSURED-NAME.
  7369             20  CL-INSURED-1ST-NAME PIC X(12).
  7370             20  CL-INSURED-MID-INIT PIC X.
  7371
  7372     12  CL-CONTROL-BY-SSN.
  7373         16  CL-COMPANY-CD-A2        PIC X.
  7374         16  CL-SOC-SEC-NO.
  7375             20  CL-SSN-STATE        PIC XX.
  7376             20  CL-SSN-ACCOUNT      PIC X(6).
  7377             20  CL-SSN-LN3          PIC X(3).
  7378
  7379     12  CL-CONTROL-BY-CERT-NO.
  7380         16  CL-COMPANY-CD-A4        PIC X.
  7381         16  CL-CERT-NO-A4.
  7382             20  CL-CERT-A4-PRIME    PIC X(10).
  7383             20  CL-CERT-A4-SFX      PIC X.
  7384
  7385     12  CL-CONTROL-BY-CCN.
  7386         16  CL-COMPANY-CD-A5        PIC X.
  7387         16  CL-CCN-A5.
  7388             20  CL-CCN.
  7389                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7390                 24  CL-CCN-PRIME-A5 PIC X(12).
  7391             20  CL-CCN-FILLER-A5    PIC X(4).
  7392
  7393     12  CL-INSURED-PROFILE-DATA.
  7394         16  CL-INSURED-BIRTH-DT     PIC XX.
  7395         16  CL-INSURED-SEX-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 140
* EL6311.cbl
  7396             88  INSURED-IS-MALE        VALUE 'M'.
  7397             88  INSURED-IS-FEMALE      VALUE 'F'.
  7398             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7399         16  CL-INSURED-OCC-CD       PIC X(6).
  7400         16  FILLER                  PIC X(5).
  7401
  7402     12  CL-PROCESSING-INFO.
  7403         16  CL-PROCESSOR-ID         PIC X(4).
  7404         16  CL-CLAIM-STATUS         PIC X.
  7405             88  CLAIM-IS-OPEN          VALUE 'O'.
  7406             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7407         16  CL-CLAIM-TYPE           PIC X.
  7408*            88  AH-CLAIM               VALUE 'A'.
  7409*            88  LIFE-CLAIM             VALUE 'L'.
  7410*            88  PROPERTY-CLAIM         VALUE 'P'.
  7411*            88  IUI-CLAIM              VALUE 'I'.
  7412*            88  GAP-CLAIM              VALUE 'G'.
  7413         16  CL-CLAIM-PREM-TYPE      PIC X.
  7414             88  SINGLE-PREMIUM         VALUE '1'.
  7415             88  O-B-COVERAGE           VALUE '2'.
  7416             88  OPEN-END-COVERAGE      VALUE '3'.
  7417         16  CL-INCURRED-DT          PIC XX.
  7418         16  CL-REPORTED-DT          PIC XX.
  7419         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7420         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7421         16  CL-LAST-PMT-DT          PIC XX.
  7422         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7423         16  CL-PAID-THRU-DT         PIC XX.
  7424         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7425         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7426         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7427         16  CL-PMT-CALC-METHOD      PIC X.
  7428             88  CL-360-DAY-YR          VALUE '1'.
  7429             88  CL-365-DAY-YR          VALUE '2'.
  7430             88  CL-FULL-MONTHS         VALUE '3'.
  7431         16  CL-CAUSE-CD             PIC X(6).
  7432
  7433         16  CL-PRIME-CERT-NO.
  7434             20  CL-PRIME-CERT-PRIME PIC X(10).
  7435             20  CL-PRIME-CERT-SFX   PIC X.
  7436
  7437         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7438             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7439             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  7440
  7441         16  CL-MICROFILM-NO         PIC X(10).
  7442         16  CL-PROG-FORM-TYPE       PIC X.
  7443         16  CL-LAST-ADD-ON-DT       PIC XX.
  7444
  7445         16  CL-LAST-REOPEN-DT       PIC XX.
  7446         16  CL-LAST-CLOSE-DT        PIC XX.
  7447         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7448             88  FINAL-PAID             VALUE '1'.
  7449             88  CLAIM-DENIED           VALUE '2'.
  7450             88  AUTO-CLOSE             VALUE '3'.
  7451             88  MANUAL-CLOSE           VALUE '4'.
  7452             88  BENEFITS-CHANGED       VALUE 'C'.
  7453             88  SETUP-ERRORS           VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 141
* EL6311.cbl
  7454         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7455         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7456         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7457             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7458         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7459         16  FILLER                  PIC X.
  7460
  7461     12  CL-CERTIFICATE-DATA.
  7462         16  CL-CERT-ORIGIN          PIC X.
  7463             88  CERT-WAS-ONLINE        VALUE '1'.
  7464             88  CERT-WAS-CREATED       VALUE '2'.
  7465             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7466         16  CL-CERT-KEY-DATA.
  7467             20  CL-CERT-CARRIER     PIC X.
  7468             20  CL-CERT-GROUPING    PIC X(6).
  7469             20  CL-CERT-STATE       PIC XX.
  7470             20  CL-CERT-ACCOUNT.
  7471                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7472                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7473             20  CL-CERT-EFF-DT      PIC XX.
  7474
  7475     12  CL-STATUS-CONTROLS.
  7476         16  CL-PRIORITY-CD          PIC X.
  7477             88  CONFIDENTIAL-DATA      VALUE '8'.
  7478             88  HIGHEST-PRIORITY       VALUE '9'.
  7479         16  CL-SUPV-ATTN-CD         PIC X.
  7480             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7481             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7482         16  CL-PURGED-DT            PIC XX.
  7483         16  CL-RESTORED-DT          PIC XX.
  7484         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7485         16  CL-NEXT-RESEND-DT       PIC XX.
  7486         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7487         16  FILLER                  PIC XX.
  7488         16  CL-LAST-MAINT-DT        PIC XX.
  7489         16  CL-LAST-MAINT-USER      PIC X(4).
  7490         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7491         16  CL-LAST-MAINT-TYPE      PIC X.
  7492             88  CLAIM-SET-UP           VALUE ' '.
  7493             88  PAYMENT-MADE           VALUE '1'.
  7494             88  LETTER-SENT            VALUE '2'.
  7495             88  MASTER-WAS-ALTERED     VALUE '3'.
  7496             88  MASTER-WAS-RESTORED    VALUE '4'.
  7497             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7498             88  FILE-CONVERTED         VALUE '6'.
  7499             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7500             88  ERROR-CORRECTION       VALUE 'E'.
  7501         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7502         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7503         16  CL-BENEFICIARY          PIC X(10).
  7504         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7505         16  CL-DENIAL-TYPE          PIC X.
  7506             88  CL-TYPE-DENIAL          VALUE '1'.
  7507             88  CL-TYPE-RESCISSION      VALUE '2'.
  7508             88  CL-TYPE-REFORMATION     VALUE '3'.
  7509             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7510             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7511         16  FILLER                  PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 142
* EL6311.cbl
  7512
  7513     12  CL-TRAILER-CONTROLS.
  7514         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7515             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7516             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7517             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7518         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7519         16  FILLER                  PIC XX.
  7520         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7521         16  CL-ADDRESS-TRAILER-CNT.
  7522             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7523                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7524             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7525                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7526             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7527                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7528             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7529                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7530             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7531                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7532             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7533                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7534             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7535                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7536
  7537     12  CL-CV-REFERENCE-NO.
  7538         16  CL-CV-REFNO-PRIME       PIC X(18).
  7539         16  CL-CV-REFNO-SFX         PIC XX.
  7540
  7541     12  CL-FILE-LOCATION            PIC X(4).
  7542
  7543     12  CL-PROCESS-ERRORS.
  7544         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7545             88  NO-FATAL-ERRORS        VALUE ZERO.
  7546         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7547             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7548
  7549     12  CL-PRODUCT-CD               PIC X.
  7550
  7551     12  CL-CURRENT-KEY-DATA.
  7552         16  CL-CURRENT-CARRIER      PIC X.
  7553         16  CL-CURRENT-GROUPING     PIC X(6).
  7554         16  CL-CURRENT-STATE        PIC XX.
  7555         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7556
  7557     12  CL-ASSOCIATES               PIC X.
  7558         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7559         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7560         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7561         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7562
  7563     12  CL-ACTIVITY-CODE            PIC 99.
  7564     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7565     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7566
  7567     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7568     12  CL-LAG-REPORT-CODE          PIC 9.
  7569     12  CL-LOAN-TYPE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 143
* EL6311.cbl
  7570     12  CL-LEGAL-STATE              PIC XX.
  7571
  7572*    12  FILLER                      PIC X(5).
  7573     12  CL-YESNOSW                  PIC X.
  7574     12  FILLER                      PIC X(4).
  7575
  7576*    COPY ERCENDT.
  7577******************************************************************
  7578*                                                                *
  7579*                                                                *
  7580*                            ERCENDT.                            *
  7581*                            VMOD=2.001                          *
  7582*                                                                *
  7583*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7584*                                                                *
  7585*   FILE TYPE = VSAM,KSDS                                        *
  7586*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7587*                                                                *
  7588*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7589*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7590*                                                                *
  7591*   LOG = NO                                                     *
  7592*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7593******************************************************************
  7594*-----------------------------------------------------------------
  7595*                   C H A N G E   L O G
  7596*
  7597* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7598*-----------------------------------------------------------------
  7599*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7600* EFFECTIVE    NUMBER
  7601*-----------------------------------------------------------------
  7602* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7603*                                WITH OPEN CLAIMS
  7604* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7605* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7606*-----------------------------------------------------------------
  7607 01  ENDORSEMENT-RECORD.
  7608     12  EN-RECORD-ID                PIC XX.
  7609         88  VALID-EN-ID                VALUE 'EN'.
  7610     12  EN-CONTROL-PRIMARY.
  7611         16  EN-COMPANY-CD           PIC X.
  7612         16  EN-CARRIER              PIC X.
  7613         16  EN-GROUPING             PIC X(6).
  7614         16  EN-STATE                PIC XX.
  7615         16  EN-ACCOUNT              PIC X(10).
  7616         16  EN-CERT-EFF-DT          PIC XX.
  7617         16  EN-CERT-NO.
  7618             20  EN-CERT-PRIME       PIC X(10).
  7619             20  EN-CERT-SFX         PIC X.
  7620         16  EN-REC-TYPE             PIC X.
  7621             88  EN-ISSUE               VALUE 'I'.
  7622             88  EN-CANCELLATION        VALUE 'C'.
  7623         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7624     12  EN-CONTROL-BY-ARCH-NO.
  7625         16  EN-COMPANY-CD-A1              PIC X.
  7626         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7627     12  EN-LAST-MAINT-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 144
* EL6311.cbl
  7628     12  EN-LAST-MAINT-BY            PIC X(4).
  7629     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7630     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7631     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7632         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7633         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7634         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7635         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7636         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7637         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7638         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7639         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7640         16  EN-LF-ORIG-BENCD        PIC XX.
  7641         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7642         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7643         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7644         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7645         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7646         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7647*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7648         16  EN-ORIG-CRED-BENE       PIC X(25).
  7649         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7650         16  FILLER                  PIC X.
  7651         16  EN-AH-ORIG-BENCD        PIC XX.
  7652         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7653         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7654         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7655         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7656*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7657*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  7658         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7659         16  F                       PIC X(09).
  7660         16  EN-AH-ORIG-CP           PIC 99.
  7661         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7662         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7663         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7664         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7665         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7666         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7667         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7668         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7669         16  EN-LF-NEW-BENCD         PIC XX.
  7670         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7671         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7672         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7673         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7674         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7675         16  EN-LF-NEW-EXP-DT        PIC XX.
  7676         16  EN-NEW-CRED-BENE        PIC X(25).
  7677         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7678         16  FILLER                  PIC X.
  7679         16  EN-AH-NEW-BENCD         PIC XX.
  7680         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7681         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7682         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7683         16  EN-AH-NEW-EXP-DT        PIC XX.
  7684*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7685*        16  EN-AH-NEW-WAIT-PER      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 145
* EL6311.cbl
  7686*        16  F                       PIC X(12).
  7687         16  EN-AH-NEW-CP            PIC 99.
  7688         16  EN-SIG-SW               PIC X.
  7689         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7690         16  FILLER                  PIC X(37).
  7691     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7692         16  EN-LF-ORIG-REF-DT       PIC XX.
  7693         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7694         16  EN-AH-ORIG-REF-DT       PIC XX.
  7695         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7696         16  EN-LF-NEW-REF-DT        PIC XX.
  7697         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7698         16  EN-AH-NEW-REF-DT        PIC XX.
  7699         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7700         16  EN-FLAG-CERT            PIC X.
  7701         16  EN-INS-LAST-NAME        PIC X(15).
  7702         16  EN-INS-FIRST-NAME       PIC X(10).
  7703         16  EN-INS-MIDDLE-INIT      PIC X.
  7704         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7705         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7706         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7707         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7708         16  FILLER                  PIC X(262).
  7709     12  EN-MONEY-SW             PIC X.
  7710     12  EN-HEALTH-APP           PIC X.
  7711     12  EN-VOUCHER-SW           PIC X.
  7712     12  EN-PAYEE                PIC X(14).
  7713     12  EN-INPUT-DT             PIC XX.
  7714     12  EN-PROCESS-DT           PIC XX.
  7715     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7716     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7717     12  EN-REASON-CODES.
  7718         16  F OCCURS 12.
  7719             20  EN-REASON-CODE  PIC X(4).
  7720     12  EN-TEMPLATE-USED        PIC X(8).
  7721     12  EN-DOCU-TYPE            PIC X.
  7722         88  EN-VERI-DOCU          VALUE 'V'.
  7723         88  EN-GCE-DOCU           VALUE 'G'.
  7724         88  EN-CANC-DOCU          VALUE 'C'.
  7725     12  EN-COMMENTS1            PIC X(13).
  7726     12  EN-COMMENTS2            PIC X(70).
  7727     12  EN-COMM-CHGBK           PIC X.
  7728         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7729         88  EN-CHG-ACCT           VALUE 'Y'.
  7730     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7731     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7732     12  EN-BATCH-NUMBER         PIC X(6).
  7733     12  EN-ACCT-SUMM            PIC X.
  7734     12  EN-CSO-SUMM             PIC X.
  7735     12  FILLER                  PIC X(13).
  7736******************************************************************
  7737
  7738 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  7739                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  7740                          PENDING-MAILING-DATA MAILING-DATA
  7741                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  7742                          PENDING-PAY-ADJ CERT-NOTE-FILE
  7743                          CLAIM-MASTER ENDORSEMENT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 146
* EL6311.cbl
  7744 0000-DFHEXIT SECTION.
  7745     MOVE '9#                    $   ' TO DFHEIV0.
  7746     MOVE 'EL6311' TO DFHEIV1.
  7747     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7748
  7749     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  7750     MOVE EIBTRMID               TO QID-TERM.
  7751     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  7752     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7753     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7754     MOVE 2                      TO EMI-SWITCH2.
  7755
  7756     IF EIBCALEN = 0
  7757         GO TO 8800-UNAUTHORIZED-ACCESS.
  7758
  7759     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  7760     MOVE '5'                   TO DC-OPTION-CODE.
  7761     PERFORM 9700-DATE-LINK.
  7762     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  7763     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  7764
  7765     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  7766     MOVE SPACE                  TO DC-OPTION-CODE.
  7767     PERFORM 9700-DATE-LINK.
  7768     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  7769     MOVE LOW-VALUES             TO EL631BI.
  7770
  7771
  7772* EXEC CICS HANDLE CONDITION
  7773*        PGMIDERR  (9600-PGMID-ERROR)
  7774*        ERROR     (9990-ABEND)
  7775*        INVREQ    (9990-ABEND)
  7776*        QIDERR    (0010-MAIN-LOGIC)
  7777*    END-EXEC.
  7778*    MOVE '"$L.8N                ! " #00007767' TO DFHEIV0
  7779     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  7780     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7781     MOVE X'2220233030303037373637' TO DFHEIV0(25:11)
  7782     CALL 'kxdfhei1' USING DFHEIV0
  7783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7784
  7785
  7786     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7787         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7788             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7789             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  7790             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7791             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7792             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7793             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7794             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7795             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7796
  7797             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  7798                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  7799
  7800             ELSE
  7801                 NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 147
* EL6311.cbl
  7802
  7803         ELSE
  7804             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  7805             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7806             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7807             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7808             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7809             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7810             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7811             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7812             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7813             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  7814             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  7815             GO TO 3900-RE-DISPLAY-RECORD
  7816     ELSE
  7817         GO TO 0020-MAIN-LOGIC.
  7818
  7819 0010-MAIN-LOGIC.
  7820     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  7821                                    WS-FIRST-ENTRY-SW.
  7822
  7823     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  7824
  7825     MOVE LOW-VALUES             TO EC-NEW-CERT
  7826                                    EC-NEW-STATE.
  7827
  7828     IF PI-DISPLAY-ORIGINAL-BATCH
  7829         NEXT SENTENCE
  7830     ELSE
  7831         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  7832             GO TO 5000-BROWSE-BATCH-HEADERS.
  7833
  7834     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  7835         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  7836
  7837     IF PI-CSR-BROWSE
  7838        GO TO 4200-BROWSE-CSR-FORWARD.
  7839
  7840     IF PI-FILE-BROWSE
  7841         GO TO 4300-BROWSE-FILE-FORWARD.
  7842
  7843     GO TO 4000-BROWSE-DETAIL-FORWARD.
  7844
  7845 0020-MAIN-LOGIC.
  7846     IF EIBAID = DFHCLEAR
  7847         GO TO 9400-CLEAR.
  7848
  7849     MOVE LOW-VALUES             TO EC-NEW-CERT
  7850                                    EC-NEW-STATE.
  7851
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 148
* EL6311.cbl
  7853
  7854******************************************************************
  7855*                                                                *
  7856*              R E C E I V E   M A P                             *
  7857*                                                                *
  7858******************************************************************
  7859
  7860 0200-RECEIVE.
  7861     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7862         MOVE ER-0008            TO EMI-ERROR
  7863         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7864         IF PI-MAP-NAME = EL631B
  7865             MOVE -1                 TO BMAINTL
  7866             GO TO 8200-SEND-DATAONLY
  7867         ELSE
  7868             IF PI-MAP-NAME = EL631C
  7869                 MOVE -1                 TO CMAINTL
  7870                 GO TO 8200-SEND-DATAONLY
  7871             ELSE
  7872                 IF PI-MAP-NAME = EL631D
  7873                     MOVE -1                 TO DPFENTRL
  7874                     GO TO 8200-SEND-DATAONLY.
  7875
  7876
  7877* EXEC CICS RECEIVE
  7878*        MAP      (PI-MAP-NAME)
  7879*        MAPSET   (MAPSET-EL6311S)
  7880*        INTO     (EL631BI)
  7881*    END-EXEC.
  7882     MOVE LENGTH OF
  7883      EL631BI
  7884       TO DFHEIV11
  7885*    MOVE '8"T I  L              ''   #00007864' TO DFHEIV0
  7886     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7887     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7888     MOVE X'2020233030303037383634' TO DFHEIV0(25:11)
  7889     CALL 'kxdfhei1' USING DFHEIV0,
  7890           PI-MAP-NAME,
  7891           EL631BI,
  7892           DFHEIV11,
  7893           MAPSET-EL6311S,
  7894           DFHEIV99,
  7895           DFHEIV99
  7896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7897
  7898
  7899******************************************************************
  7900*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  7901******************************************************************
  7902
  7903     IF BTYPE-LEN (1) EQUAL +3
  7904        IF BTYPE (1) EQUAL ALL ' '
  7905            MOVE 'Y' TO WS-REMOVE-LF-SW.
  7906
  7907     IF BTYPE-LEN (2) EQUAL +3
  7908        IF BTYPE (2) EQUAL ALL ' '
  7909            MOVE 'Y' TO WS-REMOVE-AH-SW.
  7910
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 149
* EL6311.cbl
  7911     INSPECT EL631BI CONVERTING '_' TO ' '.
  7912
  7913     IF PI-MAP-NAME = EL631B
  7914         IF BPFENTRL GREATER THAN ZEROS
  7915             IF EIBAID NOT = DFHENTER
  7916                 MOVE ER-0004       TO EMI-ERROR
  7917                 MOVE -1            TO BPFENTRL
  7918                 MOVE AL-UNBOF      TO BPFENTRA
  7919                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7920                 GO TO 8200-SEND-DATAONLY
  7921             ELSE
  7922                 IF BPFENTRI NUMERIC AND
  7923                   (BPFENTRI GREATER 0 AND LESS 25)
  7924                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  7925                 ELSE
  7926                     MOVE ER-0029  TO EMI-ERROR
  7927                     MOVE AL-UNBON TO BPFENTRA
  7928                     MOVE -1       TO BPFENTRL
  7929                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7930                     GO TO 8200-SEND-DATAONLY
  7931         ELSE
  7932             NEXT SENTENCE
  7933     ELSE
  7934         IF PI-MAP-NAME = EL631C
  7935            IF CPFENTRL GREATER THAN ZEROS
  7936                IF EIBAID NOT = DFHENTER
  7937                 MOVE ER-0004         TO EMI-ERROR
  7938                 MOVE -1              TO CPFENTRL
  7939                 MOVE AL-UNBOF        TO CPFENTRA
  7940                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7941                 GO TO 8200-SEND-DATAONLY
  7942             ELSE
  7943                 IF CPFENTRI NUMERIC AND
  7944                   (CPFENTRI GREATER 0 AND LESS 25)
  7945                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  7946                 ELSE
  7947                     MOVE ER-0029      TO EMI-ERROR
  7948                     MOVE AL-UNBON     TO CPFENTRA
  7949                     MOVE -1           TO CPFENTRL
  7950                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7951                     GO TO 8200-SEND-DATAONLY
  7952         ELSE
  7953             NEXT SENTENCE
  7954     ELSE
  7955     IF PI-MAP-NAME = EL631D
  7956         IF DPFENTRL GREATER THAN ZEROS
  7957             IF EIBAID NOT = DFHENTER
  7958                 MOVE ER-0004         TO EMI-ERROR
  7959                 MOVE -1              TO DPFENTRL
  7960                 MOVE AL-UNBOF        TO DPFENTRA
  7961                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7962                 GO TO 8200-SEND-DATAONLY
  7963             ELSE
  7964                 IF DPFENTRI NUMERIC AND
  7965                   (DPFENTRI GREATER 0 AND LESS 25)
  7966                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  7967                 ELSE
  7968                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 150
* EL6311.cbl
  7969                     MOVE AL-UNBON     TO DPFENTRA
  7970                     MOVE -1           TO DPFENTRL
  7971                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7972                     GO TO 8200-SEND-DATAONLY.
  7973
  7974     IF EIBAID = DFHPF23
  7975         GO TO 8810-PF23.
  7976
  7977     IF EIBAID = DFHPF24
  7978         GO TO 9200-RETURN-MAIN-MENU.
  7979
  7980     IF EIBAID = DFHPF12
  7981         GO TO 9500-PF12.
  7982
  7983     IF PI-MAP-NAME = EL631B
  7984        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  7985
  7986     IF PI-MAP-NAME = EL631C
  7987        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  7988
  7989     IF PI-MAP-NAME = EL631D
  7990        GO TO 0500-CHECK-BATCH-PF-KEYS.
  7991
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 151
* EL6311.cbl
  7993
  7994******************************************************************
  7995*                                                                *
  7996*      ISSUE SCREEN PF KEY CHECKING                              *
  7997*                                                                *
  7998******************************************************************
  7999
  8000******************************************************************
  8001*                                                                *
  8002*      PF KEY FUNCTIONS:                                         *
  8003*                                                                *
  8004*      PF1  = BROWSE FORWARD                                     *
  8005*      PF2  = BROWSE BACKWARD                                    *
  8006*      PF3  = CERTIFICATE LOOKUP                                 *
  8007*      PF4  = DISPLAY BATCH HEADER                               *
  8008*      PF5  = ADD ISSUE  SCREEN                                  *
  8009*      PF6  = ADD CANCEL SCREEN                                  *
  8010*      PF7  = CERTIFICATE DISPLAY                                *
  8011*      PF8  = CERTIFICATE NOTES                                  *
  8012*      PF9  = EDIT CONTROL                                       *
  8013*      PF10 = DISPLAY LETTER SCREEN                              *
  8014*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8015*      PF12 = HELP SCREEN                                        *
  8016*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8017*      PF14 = ACCOUNT MASTER                                     *
  8018*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8019*      PF16 = DISPLAY LETTER REVIEW                              *
  8020*                                                                *
  8021******************************************************************
  8022
  8023 0300-CHECK-ISSUE-PF-KEYS.
  8024     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8025        MOVE ER-2337            TO EMI-ERROR
  8026        MOVE -1                  TO BMAINTL
  8027        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8028        GO TO 8200-SEND-DATAONLY.
  8029
  8030     IF EIBAID = DFHPF1
  8031        MOVE '0'                TO PI-EDIT-SW
  8032        IF PI-PRIMARY-BROWSE
  8033           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8034        ELSE
  8035           IF PI-PRIMARY-WITH-SELECT
  8036              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8037           ELSE
  8038              IF PI-FILE-BROWSE
  8039                 GO TO 4300-BROWSE-FILE-FORWARD
  8040              ELSE
  8041                 IF PI-CSR-BROWSE
  8042                    GO TO 4200-BROWSE-CSR-FORWARD
  8043                 ELSE
  8044                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8045
  8046     IF EIBAID = DFHPF2
  8047        MOVE '0'                TO PI-EDIT-SW
  8048        IF PI-PRIMARY-BROWSE
  8049           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8050        ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 152
* EL6311.cbl
  8051           IF PI-PRIMARY-WITH-SELECT
  8052              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8053           ELSE
  8054              IF PI-FILE-BROWSE
  8055                 GO TO 4800-BROWSE-FILE-BACKWARD
  8056              ELSE
  8057                 IF PI-CSR-BROWSE
  8058                    GO TO 4900-BROWSE-CSR-BACKWARD
  8059                 ELSE
  8060                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8061
  8062     IF EIBAID = DFHPF3
  8063        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8064        MOVE XCTL-EL127         TO PGM-NAME
  8065        GO TO 9300-XCTL.
  8066
  8067     IF (EIBAID = DFHPF15 OR DFHPF6)
  8068        AND (CSR-EDIT-SESSION)
  8069*       AND (FATAL-OR-UNFORCED)
  8070        AND (FATAL-ERRORS)
  8071        MOVE ER-1819             TO EMI-ERROR
  8072        MOVE -1                  TO BMAINTL
  8073        MOVE AL-UANON            TO BMAINTA
  8074        PERFORM 9900-ERROR-FORMAT
  8075                                 THRU 9900-EXIT
  8076        GO TO 8200-SEND-DATAONLY
  8077     END-IF
  8078     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8079      OR (EIBAID = DFHPF10)
  8080        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8081        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8082        IF (RESP-NORMAL)
  8083           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8084              AM-CONTROL-PRIMARY (1:20))
  8085            IF AM-NAME NOT GREATER THAN SPACES OR
  8086               AM-ADDRS NOT GREATER THAN SPACES  OR
  8087               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8088               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8089               AM-ZIP NOT GREATER THAN SPACES
  8090               MOVE ER-3834             TO EMI-ERROR
  8091               MOVE -1                  TO BMAINTL
  8092               MOVE AL-UANON            TO BMAINTA
  8093               PERFORM 9900-ERROR-FORMAT
  8094                                 THRU 9900-EXIT
  8095               GO TO 8200-SEND-DATAONLY
  8096            END-IF
  8097        ELSE
  8098           MOVE ER-1609             TO EMI-ERROR
  8099           MOVE -1                  TO BMAINTL
  8100           MOVE AL-UANON            TO BMAINTA
  8101           PERFORM 9900-ERROR-FORMAT
  8102                                THRU 9900-EXIT
  8103           GO TO 8200-SEND-DATAONLY
  8104        END-IF
  8105
  8106        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8107        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8108        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 153
* EL6311.cbl
  8109            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8110               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8111               MA-CITY NOT GREATER THAN SPACES OR
  8112               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8113               MA-ZIP-CODE NOT GREATER THAN SPACES
  8114               MOVE ER-3835             TO EMI-ERROR
  8115               MOVE -1                  TO BMAINTL
  8116               MOVE AL-UANON            TO BMAINTA
  8117               PERFORM 9900-ERROR-FORMAT
  8118                                 THRU 9900-EXIT
  8119               GO TO 8200-SEND-DATAONLY
  8120            END-IF
  8121        ELSE
  8122           MOVE ER-3000             TO EMI-ERROR
  8123           MOVE -1                  TO BMAINTL
  8124           MOVE AL-UANON            TO BMAINTA
  8125           PERFORM 9900-ERROR-FORMAT
  8126                                THRU 9900-EXIT
  8127           GO TO 8200-SEND-DATAONLY
  8128        END-IF
  8129
  8130     END-IF
  8131     IF (EIBAID = DFHPF15)
  8132        AND (CSR-EDIT-SESSION)
  8133        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8134        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8135        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8136        MOVE PI-SV-STATE         TO PI-STATE
  8137        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8138        MOVE BCERTNOI            TO PI-CERT-PRIME
  8139        MOVE BSUFIXI             TO PI-CERT-SFX
  8140        MOVE BEFFDTI             TO DEEDIT-FIELD
  8141        PERFORM 8600-DEEDIT
  8142        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8143        MOVE '4'                 TO DC-OPTION-CODE
  8144        PERFORM 9700-DATE-LINK
  8145        IF DATE-CONVERSION-ERROR
  8146           MOVE ER-0348          TO EMI-ERROR
  8147           MOVE -1               TO BEFFDTL
  8148           MOVE AL-UABON         TO BEFFDTA
  8149           PERFORM 9900-ERROR-FORMAT
  8150                                 THRU 9900-EXIT
  8151           GO TO 8200-SEND-DATAONLY
  8152        ELSE
  8153           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8154           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8155           MOVE XCTL-EL6315      TO PGM-NAME
  8156           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8157           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8158           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8159           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8160           GO TO 9300-XCTL
  8161        END-IF
  8162     END-IF
  8163
  8164     IF EIBAID = DFHPF4
  8165        MOVE '0'                TO PI-EDIT-SW
  8166        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 154
* EL6311.cbl
  8167           NEXT SENTENCE
  8168        ELSE
  8169           GO TO 7200-DISPLAY-BATCHES.
  8170
  8171     IF EIBAID = DFHPF5
  8172        MOVE ER-0029                TO EMI-ERROR
  8173        MOVE -1                     TO BPFENTRL
  8174        MOVE AL-UNBON               TO BPFENTRA
  8175        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8176        GO TO 8200-SEND-DATAONLY.
  8177*        MOVE '0'                TO PI-EDIT-SW
  8178*        IF PI-DISPLAY-ORIGINAL-BATCH
  8179*           NEXT SENTENCE
  8180*        ELSE
  8181*           MOVE EL631B              TO PI-MAP-NAME
  8182*           MOVE LOW-VALUES          TO EL631BI
  8183*           MOVE 'A'                 TO BMAINTO
  8184*           MOVE AL-UANON            TO BMAINTA
  8185*           MOVE -1                  TO BMAINTL
  8186*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8187*           GO TO 8100-SEND-INITIAL-MAP.
  8188
  8189     IF EIBAID = DFHPF6
  8190        IF NOT CSR-EDIT-SESSION
  8191           MOVE ER-0029                TO EMI-ERROR
  8192           MOVE -1                     TO BPFENTRL
  8193           MOVE AL-UNBON               TO BPFENTRA
  8194           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8195           GO TO 8200-SEND-DATAONLY
  8196*           MOVE '0'              TO PI-EDIT-SW
  8197*           IF PI-DISPLAY-ORIGINAL-BATCH
  8198*              NEXT SENTENCE
  8199*           ELSE
  8200*              MOVE EL631C        TO PI-MAP-NAME
  8201*              MOVE LOW-VALUES    TO EL631CI
  8202*              MOVE 'A'           TO CMAINTO
  8203*              MOVE AL-UANON      TO CMAINTA
  8204*              MOVE -1            TO CMAINTL
  8205*              MOVE '6'           TO PI-MAINT-FUNCTION
  8206*              GO TO 8100-SEND-INITIAL-MAP
  8207*           END-IF
  8208        ELSE
  8209           PERFORM 5100-PROCESS-POL-RESC
  8210                                 THRU 5100-EXIT
  8211           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8212           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8213                                    PI-PREV-SEQ-NO
  8214           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8215*                                    WS-CANCEL-LETTER-SW
  8216                                    PI-ALL-ISSUES-SW
  8217                                    PI-ALL-CANCELS-SW
  8218           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8219        END-IF
  8220     END-IF
  8221     IF EIBAID = DFHPF7
  8222        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8223        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8224        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 155
* EL6311.cbl
  8225        MOVE PI-SV-STATE            TO PI-STATE
  8226        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8227        MOVE BCERTNOI               TO PI-CERT-PRIME
  8228        MOVE BSUFIXI                TO PI-CERT-SFX
  8229        MOVE BEFFDTI                TO DEEDIT-FIELD
  8230        PERFORM 8600-DEEDIT
  8231        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8232        MOVE '4'                    TO DC-OPTION-CODE
  8233        PERFORM 9700-DATE-LINK
  8234        IF DATE-CONVERSION-ERROR
  8235           MOVE ER-0348            TO EMI-ERROR
  8236           MOVE -1                  TO BEFFDTL
  8237           MOVE AL-UABON            TO BEFFDTA
  8238           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8239           GO TO 8200-SEND-DATAONLY
  8240        ELSE
  8241           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8242           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8243           MOVE XCTL-EL1273        TO PGM-NAME
  8244           GO TO 9300-XCTL.
  8245
  8246     IF EIBAID = DFHPF8
  8247        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8248        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8249        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8250        MOVE PI-SV-STATE            TO PI-STATE
  8251        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8252        MOVE BCERTNOI               TO PI-CERT-PRIME
  8253        MOVE BSUFIXI                TO PI-CERT-SFX
  8254        MOVE BEFFDTI                TO DEEDIT-FIELD
  8255        PERFORM 8600-DEEDIT
  8256        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8257        MOVE '4'                    TO DC-OPTION-CODE
  8258        PERFORM 9700-DATE-LINK
  8259        IF DATE-CONVERSION-ERROR
  8260           MOVE ER-0348            TO EMI-ERROR
  8261           MOVE -1                  TO BEFFDTL
  8262           MOVE AL-UABON            TO BEFFDTA
  8263           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8264           GO TO 8200-SEND-DATAONLY
  8265        ELSE
  8266           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8267           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8268           IF PI-COMPANY-ID = 'DMD'
  8269               MOVE XCTL-EL401DMD      TO PGM-NAME
  8270             ELSE
  8271               MOVE XCTL-EL1279        TO PGM-NAME
  8272           END-IF
  8273           GO TO 9300-XCTL.
  8274
  8275     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8276        MOVE XCTL-EL6312         TO PGM-NAME
  8277
  8278* EXEC CICS XCTL
  8279*           PROGRAM   (PGM-NAME)
  8280*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8281*           LENGTH    (WS-COMM-LENGTH)
  8282*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 156
* EL6311.cbl
  8283*    MOVE '.$C                   %   #00008248' TO DFHEIV0
  8284     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8285     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8286     MOVE X'2020233030303038323438' TO DFHEIV0(25:11)
  8287     CALL 'kxdfhei1' USING DFHEIV0,
  8288           PGM-NAME,
  8289           PROGRAM-INTERFACE-BLOCK,
  8290           WS-COMM-LENGTH,
  8291           DFHEIV99
  8292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8293     ELSE
  8294        MOVE '0'                 TO  PI-EDIT-SW.
  8295
  8296     IF  EIBAID = DFHPF10
  8297         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8298         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8299         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8300                                    PI-1042-WA
  8301         MOVE 4                  TO PI-689-DATA-SOURCE
  8302         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8303         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8304         MOVE PI-SV-STATE        TO PI-689-STATE
  8305         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8306         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8307         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8308         MOVE PI-PB-ALT-CHG-SEQ-NO
  8309                                 TO PI-689-ALT-SEQ-NO
  8310         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8311         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8312         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8313         MOVE +0                 TO PI-689-CONTROL
  8314         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8315                                    PI-689-EXP-DATE
  8316                                    PI-689-RESP-PERSON
  8317                                    PI-689-TYPE
  8318                                    PI-689-FOLLOW-UP-EDIT
  8319                                    PI-689-RESEND1-EDIT
  8320                                    PI-689-SEQ-EDIT
  8321                                    PI-689-BCSEQ-EDIT
  8322                                    PI-689-LBL-OVERRIDE
  8323         MOVE W-LETTER-COMMUNICATION-AREAS
  8324                                 TO PI-PROGRAM-WORK-AREA
  8325         MOVE XCTL-EL689         TO PGM-NAME
  8326         GO TO 9300-XCTL.
  8327
  8328     IF  EIBAID = DFHPF16
  8329         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8330         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8331         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8332                                    PI-1042-WA
  8333         MOVE 4                  TO PI-689-DATA-SOURCE
  8334         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8335         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8336         MOVE PI-SV-STATE        TO PI-689-STATE
  8337         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8338         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8339         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8340         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 157
* EL6311.cbl
  8341                                 TO PI-689-ALT-SEQ-NO
  8342         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8343         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8344         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8345         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8346         MOVE W-LETTER-COMMUNICATION-AREAS
  8347                                 TO PI-PROGRAM-WORK-AREA
  8348         MOVE XCTL-EL690         TO PGM-NAME
  8349         GO TO 9300-XCTL.
  8350
  8351     IF EIBAID = DFHPF13
  8352         MOVE XCTL-EL6313        TO PGM-NAME
  8353         GO TO 9300-XCTL.
  8354
  8355     IF EIBAID = DFHPF17
  8356        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8357        IF (PB-I-LOAN-APR > ZEROS)
  8358           AND (PB-I-BENEFICIARY-NAME NOT
  8359              = SPACES AND LOW-VALUES)
  8360
  8361           MOVE LINK-ELVADS          TO PGM-NAME
  8362
  8363* EXEC CICS LINK
  8364*              PROGRAM    (PGM-NAME)
  8365*              COMMAREA   (WS-PASS-AREA)
  8366*              LENGTH     (WS-PASS-AREA-LENGTH)
  8367*          END-EXEC
  8368*    MOVE '."C                   (   #00008322' TO DFHEIV0
  8369     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8370     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8371     MOVE X'2020233030303038333232' TO DFHEIV0(25:11)
  8372     CALL 'kxdfhei1' USING DFHEIV0,
  8373           PGM-NAME,
  8374           WS-PASS-AREA,
  8375           WS-PASS-AREA-LENGTH,
  8376           DFHEIV99,
  8377           DFHEIV99,
  8378           DFHEIV99,
  8379           DFHEIV99
  8380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8381
  8382           MOVE 0000             TO EMI-ERROR
  8383           MOVE -1               TO BMAINTL
  8384           PERFORM 9900-ERROR-FORMAT
  8385                                 THRU 9900-EXIT
  8386           GO TO 8200-SEND-DATAONLY
  8387        ELSE
  8388           MOVE ER-0877            TO EMI-ERROR
  8389           MOVE -1                  TO BEFFDTL
  8390           MOVE AL-UABON            TO BEFFDTA
  8391           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8392           GO TO 8200-SEND-DATAONLY
  8393        END-IF
  8394     END-IF
  8395     IF EIBAID = DFHPF14
  8396        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8397        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8398        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 158
* EL6311.cbl
  8399        MOVE PI-SV-STATE            TO PI-CR-STATE
  8400        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8401        MOVE SPACE                  TO PI-EDIT-SW
  8402        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8403        MOVE XCTL-EL650             TO PGM-NAME
  8404        GO TO 9300-XCTL.
  8405
  8406     IF EIBAID = DFHPF15
  8407        IF PI-COMPANY-ID  =  'HER'
  8408            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8409            MOVE XCTL-EL680         TO PGM-NAME
  8410            GO TO 9300-XCTL.
  8411
  8412     IF EIBAID = DFHENTER OR DFHPF11
  8413        GO TO 1000-ISSUE-MAINLINE.
  8414
  8415     MOVE ER-0029                TO EMI-ERROR
  8416     MOVE -1                     TO BPFENTRL
  8417     MOVE AL-UNBON               TO BPFENTRA
  8418     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8419     GO TO 8200-SEND-DATAONLY.
  8420
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 159
* EL6311.cbl
  8422
  8423******************************************************************
  8424*                                                                *
  8425*      CANCEL SCREEN PF KEY CHECKING                             *
  8426*                                                                *
  8427******************************************************************
  8428
  8429******************************************************************
  8430*                                                                *
  8431*      PF KEY FUNCTIONS:                                         *
  8432*                                                                *
  8433*      PF1  = BROWSE FORWARD                                     *
  8434*      PF2  = BROWSE BACKWARD                                    *
  8435*      PF3  = CERTIFICATE LOOKUP                                 *
  8436*      PF4  = DISPLAY BATCH HEADER                               *
  8437*      PF5  = ADD ISSUE SCREEN                                   *
  8438*      PF6  = ADD CANCEL SCREEN                                  *
  8439*      PF7  = CERTIFICATE DISPLAY                                *
  8440*      PF8  = CERTIFICATE NOTES                                  *
  8441*      PF9  = EDIT CONTROL                                       *
  8442*      PF10 = DISPLAY LETTER SCREEN                              *
  8443*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8444*      PF12 = DISPLAY HELP SCREEN                                *
  8445*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8446*      PF14 = ACCOUNT MASTER                                     *
  8447*      PF16 = LETTER REVIEW                                      *
  8448*                                                                *
  8449******************************************************************
  8450
  8451 0400-CHECK-CANCEL-PF-KEYS.
  8452     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8453        MOVE ER-2337             TO EMI-ERROR
  8454        MOVE -1                  TO CMAINTL
  8455        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8456        GO TO 8200-SEND-DATAONLY.
  8457
  8458     IF EIBAID = DFHPF1
  8459        MOVE '0'                TO PI-EDIT-SW
  8460        IF PI-PRIMARY-BROWSE
  8461           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8462        ELSE
  8463           IF PI-PRIMARY-WITH-SELECT
  8464              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8465           ELSE
  8466              IF PI-FILE-BROWSE
  8467                 GO TO 4300-BROWSE-FILE-FORWARD
  8468              ELSE
  8469                 IF PI-CSR-BROWSE
  8470                    GO TO 4200-BROWSE-CSR-FORWARD
  8471                 ELSE
  8472                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8473
  8474     IF EIBAID = DFHPF2
  8475        MOVE '0'                TO PI-EDIT-SW
  8476        IF PI-PRIMARY-BROWSE
  8477           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8478        ELSE
  8479           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 160
* EL6311.cbl
  8480              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8481           ELSE
  8482              IF PI-FILE-BROWSE
  8483                 GO TO 4800-BROWSE-FILE-BACKWARD
  8484              ELSE
  8485                 IF PI-CSR-BROWSE
  8486                    GO TO 4900-BROWSE-CSR-BACKWARD
  8487                 ELSE
  8488                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8489
  8490     IF EIBAID = DFHPF3
  8491        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8492        MOVE XCTL-EL127         TO PGM-NAME
  8493        GO TO 9300-XCTL.
  8494
  8495     IF (EIBAID = DFHPF15 OR DFHPF17)
  8496        AND (CSR-EDIT-SESSION)
  8497*       AND (FATAL-OR-UNFORCED)
  8498        AND (FATAL-ERRORS)
  8499        MOVE ER-1819             TO EMI-ERROR
  8500        MOVE -1                  TO CMAINTL
  8501        MOVE AL-UANON            TO CMAINTA
  8502        PERFORM 9900-ERROR-FORMAT
  8503                                 THRU 9900-EXIT
  8504        GO TO 8200-SEND-DATAONLY
  8505     END-IF
  8506     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8507       AND (CSR-EDIT-SESSION)
  8508        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8509        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8510        IF (RESP-NORMAL)
  8511           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8512              AM-CONTROL-PRIMARY (1:20))
  8513            IF AM-NAME NOT GREATER THAN SPACES OR
  8514               AM-ADDRS NOT GREATER THAN SPACES  OR
  8515               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8516               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8517               AM-ZIP NOT GREATER THAN SPACES
  8518               MOVE ER-3834             TO EMI-ERROR
  8519               MOVE -1                  TO BMAINTL
  8520               MOVE AL-UANON            TO BMAINTA
  8521               PERFORM 9900-ERROR-FORMAT
  8522                                 THRU 9900-EXIT
  8523               GO TO 8200-SEND-DATAONLY
  8524            END-IF
  8525        ELSE
  8526           MOVE ER-1609             TO EMI-ERROR
  8527           MOVE -1                  TO BMAINTL
  8528           MOVE AL-UANON            TO BMAINTA
  8529           PERFORM 9900-ERROR-FORMAT
  8530                                THRU 9900-EXIT
  8531           GO TO 8200-SEND-DATAONLY
  8532        END-IF
  8533
  8534        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8535        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8536        IF (ERMAIL-FOUND)
  8537            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 161
* EL6311.cbl
  8538               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8539               MA-CITY NOT GREATER THAN SPACES OR
  8540               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8541               MA-ZIP-CODE NOT GREATER THAN SPACES
  8542               MOVE ER-3835             TO EMI-ERROR
  8543               MOVE -1                  TO BMAINTL
  8544               MOVE AL-UANON            TO BMAINTA
  8545               PERFORM 9900-ERROR-FORMAT
  8546                                 THRU 9900-EXIT
  8547               GO TO 8200-SEND-DATAONLY
  8548            END-IF
  8549        ELSE
  8550           MOVE ER-3000             TO EMI-ERROR
  8551           MOVE -1                  TO BMAINTL
  8552           MOVE AL-UANON            TO BMAINTA
  8553           PERFORM 9900-ERROR-FORMAT
  8554                                THRU 9900-EXIT
  8555           GO TO 8200-SEND-DATAONLY
  8556        END-IF
  8557
  8558     END-IF
  8559     IF (EIBAID = DFHPF15 OR DFHPF17)
  8560        AND (CSR-EDIT-SESSION)
  8561        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8562        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8563        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8564        MOVE PI-SV-STATE         TO PI-STATE
  8565        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8566        MOVE CCERTNOI            TO PI-CERT-PRIME
  8567        MOVE CSUFIXI             TO PI-CERT-SFX
  8568        MOVE CEFFDTI             TO DEEDIT-FIELD
  8569        PERFORM 8600-DEEDIT
  8570        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8571        MOVE '4'                 TO DC-OPTION-CODE
  8572        PERFORM 9700-DATE-LINK
  8573        IF DATE-CONVERSION-ERROR
  8574           MOVE ER-0348          TO EMI-ERROR
  8575           MOVE -1               TO CEFFDTL
  8576           MOVE AL-UABON         TO CEFFDTA
  8577           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8578           GO TO 8200-SEND-DATAONLY
  8579        ELSE
  8580           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8581           PERFORM 6000-CREATE-TEMP-STORAGE
  8582                                 THRU 6000-EXIT
  8583           IF EIBAID = DFHPF17
  8584               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  8585                                  THRU 6400-EXIT
  8586               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  8587                                 '2' AND '3' AND '4'
  8588                  MOVE ER-3831     TO  EMI-ERROR
  8589                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8590                  GO TO 8200-SEND-DATAONLY
  8591               END-IF
  8592               MOVE 'Y'          TO PI-CLM-RESC-IND
  8593           ELSE
  8594               MOVE 'N'          TO PI-CLM-RESC-IND
  8595           END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 162
* EL6311.cbl
  8596           MOVE XCTL-EL6316      TO PGM-NAME
  8597           MOVE '2'              TO PI-ISS-CAN-SW
  8598           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  8599           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8600           GO TO 9300-XCTL
  8601        END-IF
  8602     END-IF
  8603
  8604     IF EIBAID = DFHPF4
  8605        MOVE '0'                TO PI-EDIT-SW
  8606        IF PI-DISPLAY-ORIGINAL-BATCH
  8607           NEXT SENTENCE
  8608        ELSE
  8609           GO TO 7200-DISPLAY-BATCHES.
  8610
  8611     IF EIBAID = DFHPF5
  8612        MOVE ER-0029                TO EMI-ERROR
  8613        MOVE -1                     TO BPFENTRL
  8614        MOVE AL-UNBON               TO BPFENTRA
  8615        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8616        GO TO 8200-SEND-DATAONLY.
  8617*        MOVE '0'                TO PI-EDIT-SW
  8618*        IF PI-DISPLAY-ORIGINAL-BATCH
  8619*           NEXT SENTENCE
  8620*        ELSE
  8621*           MOVE EL631B              TO PI-MAP-NAME
  8622*           MOVE LOW-VALUES          TO EL631BI
  8623*           MOVE 'A'                 TO BMAINTO
  8624*           MOVE AL-UANON            TO BMAINTA
  8625*           MOVE -1                  TO BMAINTL
  8626*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8627*           GO TO 8100-SEND-INITIAL-MAP.
  8628
  8629     IF EIBAID = DFHPF6
  8630        MOVE ER-0029                TO EMI-ERROR
  8631        MOVE -1                     TO BPFENTRL
  8632        MOVE AL-UNBON               TO BPFENTRA
  8633        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8634        GO TO 8200-SEND-DATAONLY.
  8635*        MOVE '0'                TO PI-EDIT-SW
  8636*        IF PI-DISPLAY-ORIGINAL-BATCH
  8637*           NEXT SENTENCE
  8638*        ELSE
  8639*           MOVE EL631C              TO PI-MAP-NAME
  8640*           MOVE LOW-VALUES          TO EL631CI
  8641*           MOVE 'A'                 TO CMAINTO
  8642*           MOVE AL-UANON            TO CMAINTA
  8643*           MOVE -1                  TO CMAINTL
  8644*           MOVE '6'                 TO PI-MAINT-FUNCTION
  8645*           GO TO 8100-SEND-INITIAL-MAP.
  8646
  8647     IF EIBAID = DFHPF7
  8648        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8649        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8650        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8651        MOVE PI-SV-STATE            TO PI-STATE
  8652        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8653        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 163
* EL6311.cbl
  8654        MOVE CSUFIXI                TO PI-CERT-SFX
  8655        MOVE CEFFDTI                TO DEEDIT-FIELD
  8656        PERFORM 8600-DEEDIT
  8657        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8658        MOVE '4'                    TO DC-OPTION-CODE
  8659        PERFORM 9700-DATE-LINK
  8660        IF DATE-CONVERSION-ERROR
  8661           MOVE ER-0348            TO EMI-ERROR
  8662           MOVE -1                  TO BEFFDTL
  8663           MOVE AL-UABON            TO BEFFDTA
  8664           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8665           GO TO 8200-SEND-DATAONLY
  8666        ELSE
  8667           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8668           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8669           MOVE XCTL-EL1273        TO PGM-NAME
  8670           GO TO 9300-XCTL.
  8671
  8672     IF EIBAID = DFHPF8
  8673        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8674        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8675        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8676        MOVE PI-SV-STATE            TO PI-STATE
  8677        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8678        MOVE CCERTNOI               TO PI-CERT-PRIME
  8679        MOVE CSUFIXI                TO PI-CERT-SFX
  8680        MOVE CEFFDTI                TO DEEDIT-FIELD
  8681        PERFORM 8600-DEEDIT
  8682        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8683        MOVE '4'                    TO DC-OPTION-CODE
  8684        PERFORM 9700-DATE-LINK
  8685        IF DATE-CONVERSION-ERROR
  8686           MOVE ER-0348             TO EMI-ERROR
  8687           MOVE -1                  TO BEFFDTL
  8688           MOVE AL-UABON            TO BEFFDTA
  8689           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8690           GO TO 8200-SEND-DATAONLY
  8691        ELSE
  8692           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8693           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8694           IF PI-COMPANY-ID = 'DMD'
  8695               MOVE XCTL-EL401DMD      TO PGM-NAME
  8696             ELSE
  8697               MOVE XCTL-EL1279        TO PGM-NAME
  8698           END-IF
  8699           GO TO 9300-XCTL.
  8700
  8701     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8702        MOVE XCTL-EL6312     TO PGM-NAME
  8703
  8704* EXEC CICS XCTL
  8705*           PROGRAM  (PGM-NAME)
  8706*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  8707*           LENGTH   (WS-COMM-LENGTH)
  8708*       END-EXEC
  8709*    MOVE '.$C                   %   #00008649' TO DFHEIV0
  8710     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8711     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 164
* EL6311.cbl
  8712     MOVE X'2020233030303038363439' TO DFHEIV0(25:11)
  8713     CALL 'kxdfhei1' USING DFHEIV0,
  8714           PGM-NAME,
  8715           PROGRAM-INTERFACE-BLOCK,
  8716           WS-COMM-LENGTH,
  8717           DFHEIV99
  8718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8719     ELSE
  8720        MOVE '0'                 TO  PI-EDIT-SW.
  8721
  8722     IF EIBAID = DFHPF10
  8723         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8724         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  8725         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8726         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8727                                    PI-1042-WA
  8728         MOVE 4                  TO PI-689-DATA-SOURCE
  8729         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8730         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8731         MOVE PI-SV-STATE        TO PI-689-STATE
  8732         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8733         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8734         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8735         MOVE PI-PB-ALT-CHG-SEQ-NO
  8736                                 TO PI-689-ALT-SEQ-NO
  8737         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8738         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8739         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8740         MOVE +0                 TO PI-689-CONTROL
  8741         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8742                                    PI-689-EXP-DATE
  8743                                    PI-689-RESP-PERSON
  8744                                    PI-689-TYPE
  8745                                    PI-689-FOLLOW-UP-EDIT
  8746                                    PI-689-RESEND1-EDIT
  8747                                    PI-689-SEQ-EDIT
  8748                                    PI-689-BCSEQ-EDIT
  8749                                    PI-689-LBL-OVERRIDE
  8750         MOVE W-LETTER-COMMUNICATION-AREAS
  8751                                 TO PI-PROGRAM-WORK-AREA
  8752         MOVE XCTL-EL689         TO PGM-NAME
  8753         GO TO 9300-XCTL.
  8754
  8755     IF  EIBAID = DFHPF16
  8756         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8757         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8758         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8759                                    PI-1042-WA
  8760         MOVE 4                  TO PI-689-DATA-SOURCE
  8761         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8762         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8763         MOVE PI-SV-STATE        TO PI-689-STATE
  8764         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8765         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8766         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8767         MOVE PI-PB-ALT-CHG-SEQ-NO
  8768                                 TO PI-689-ALT-SEQ-NO
  8769         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 165
* EL6311.cbl
  8770         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8771         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8772         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8773         MOVE W-LETTER-COMMUNICATION-AREAS
  8774                                 TO PI-PROGRAM-WORK-AREA
  8775         MOVE XCTL-EL690         TO PGM-NAME
  8776         GO TO 9300-XCTL.
  8777
  8778     IF EIBAID = DFHPF13
  8779        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8780        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8781        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8782        MOVE PI-SV-STATE            TO PI-STATE
  8783        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8784        MOVE CCERTNOI               TO PI-CERT-PRIME
  8785        MOVE CSUFIXI                TO PI-CERT-SFX
  8786        MOVE CEFFDTI                TO DEEDIT-FIELD
  8787        PERFORM 8600-DEEDIT
  8788        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8789        MOVE '4'                    TO DC-OPTION-CODE
  8790        PERFORM 9700-DATE-LINK
  8791        IF DATE-CONVERSION-ERROR
  8792           MOVE ER-0348            TO EMI-ERROR
  8793           MOVE -1                  TO CEFFDTL
  8794           MOVE AL-UABON            TO CEFFDTA
  8795           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8796           GO TO 8200-SEND-DATAONLY
  8797        ELSE
  8798           MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  8799           MOVE AL-UANON            TO CEFFDTA
  8800           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8801           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8802           MOVE XCTL-EL677         TO PGM-NAME
  8803           GO TO 9300-XCTL.
  8804
  8805     IF EIBAID = DFHPF14
  8806        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8807        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8808        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8809        MOVE PI-SV-STATE            TO PI-CR-STATE
  8810        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8811        MOVE SPACE                  TO PI-EDIT-SW
  8812        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8813        MOVE XCTL-EL650             TO PGM-NAME
  8814        GO TO 9300-XCTL.
  8815
  8816     IF EIBAID = DFHENTER OR DFHPF11
  8817        GO TO 2000-CANCEL-MAINLINE.
  8818
  8819     MOVE ER-0029                TO EMI-ERROR.
  8820     MOVE -1                     TO CPFENTRL.
  8821     MOVE AL-UNBON               TO CPFENTRA.
  8822     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8823     GO TO 8200-SEND-DATAONLY.
  8824
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 166
* EL6311.cbl
  8826
  8827******************************************************************
  8828*                                                                *
  8829*      BATCH SCREEN PF KEY CHECKING                              *
  8830*                                                                *
  8831******************************************************************
  8832
  8833******************************************************************
  8834*                                                                *
  8835*      PF KEY FUNCTIONS:                                         *
  8836*                                                                *
  8837*      PF1 = BROWSE FORWARD                                      *
  8838*      PF2 = BROWSE BACKWARD                                     *
  8839*      PF3 = DISPLAY PREMIUM TOTALS                              *
  8840*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  8841*                                                                *
  8842*                                                                *
  8843******************************************************************
  8844
  8845 0500-CHECK-BATCH-PF-KEYS.
  8846     IF EIBAID = DFHPF1
  8847        MOVE '0'                TO PI-EDIT-SW
  8848        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  8849           GO TO 5000-BROWSE-BATCH-HEADERS
  8850        ELSE
  8851           IF PI-GOOD-BROWSE
  8852              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8853                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  8854              ELSE
  8855                 IF PI-FILE-BROWSE
  8856                    GO TO 4300-BROWSE-FILE-FORWARD
  8857                 ELSE
  8858                    IF PI-CSR-BROWSE
  8859                       GO TO 4200-BROWSE-CSR-FORWARD
  8860                    ELSE
  8861                       GO TO 4000-BROWSE-DETAIL-FORWARD
  8862           ELSE
  8863              GO TO 0800-BROWSE-ERROR.
  8864
  8865     IF EIBAID = DFHPF2
  8866        MOVE '0'                TO PI-EDIT-SW
  8867        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  8868           GO TO 5500-BROWSE-BATCH-BACKWARD
  8869        ELSE
  8870           IF PI-GOOD-BROWSE
  8871              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8872                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8873              ELSE
  8874                 IF PI-FILE-BROWSE
  8875                    GO TO 4800-BROWSE-FILE-BACKWARD
  8876                 ELSE
  8877                    IF PI-CSR-BROWSE
  8878                       GO TO 4900-BROWSE-CSR-BACKWARD
  8879                    ELSE
  8880                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  8881           ELSE
  8882              GO TO 0800-BROWSE-ERROR.
  8883
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 167
* EL6311.cbl
  8884     IF EIBAID = DFHPF3
  8885        GO TO 3000-BATCH-MAINLINE.
  8886
  8887     IF  EIBAID = DFHPF4
  8888        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8889        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  8890        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8891        MOVE PI-SV-STATE            TO PI-CR-STATE
  8892        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8893                                       PI-CR-FIN-RESP
  8894        MOVE 'A'                    TO PI-CR-TYPE
  8895        MOVE SPACE                  TO PI-EDIT-SW
  8896        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8897        MOVE XCTL-EL640             TO PGM-NAME
  8898        GO TO 9300-XCTL.
  8899
  8900     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  8901       AND
  8902        (EIBAID = DFHENTER)
  8903           GO TO 3500-EDIT-BATCH-DATA.
  8904
  8905     IF EIBAID = DFHENTER
  8906        GO TO 3500-EDIT-BATCH-DATA.
  8907
  8908     MOVE ER-0029             TO EMI-ERROR.
  8909     MOVE -1                  TO DPFENTRL.
  8910     MOVE AL-UNBON            TO DPFENTRA.
  8911     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8912     GO TO 8200-SEND-DATAONLY.
  8913
  8914 0800-BROWSE-ERROR.
  8915     MOVE ER-2258                TO EMI-ERROR.
  8916     MOVE -1                     TO DPFENTRL.
  8917     MOVE AL-UNBON               TO DPFENTRA.
  8918     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8919     GO TO 8200-SEND-DATAONLY.
  8920
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 168
* EL6311.cbl
  8922
  8923******************************************************************
  8924*                                                                *
  8925*                I S S U E   M A I N L I N E                     *
  8926*                                                                *
  8927******************************************************************
  8928
  8929 1000-ISSUE-MAINLINE.
  8930     IF PI-DISPLAY-ORIGINAL-BATCH
  8931        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  8932           MOVE ER-0023             TO EMI-ERROR
  8933           MOVE -1                  TO BMAINTL
  8934           MOVE AL-UABON            TO BMAINTA
  8935           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8936           GO TO 8200-SEND-DATAONLY
  8937        ELSE
  8938           NEXT SENTENCE
  8939     ELSE
  8940        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  8941           MOVE ER-0023             TO EMI-ERROR
  8942           MOVE -1                  TO BMAINTL
  8943           MOVE AL-UABON            TO BMAINTA
  8944           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8945           GO TO 8200-SEND-DATAONLY.
  8946
  8947     IF BMAINTI = 'S'
  8948        GO TO 1100-SHOW-REQUEST.
  8949
  8950     IF NOT MODIFY-CAP
  8951         MOVE 'UPDATE'       TO SM-READ
  8952         PERFORM 9995-SECURITY-VIOLATION
  8953         MOVE ER-0070        TO EMI-ERROR
  8954         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8955         GO TO 8100-SEND-INITIAL-MAP.
  8956
  8957     IF BMAINTL GREATER THAN ZEROS
  8958        IF PI-PF5-FUNCTION
  8959           IF BMAINTI NOT = 'A'
  8960              MOVE AL-UABON  TO BMAINTA
  8961              MOVE -1        TO BMAINTL
  8962              MOVE ER-2260   TO EMI-ERROR
  8963              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8964              GO TO 8200-SEND-DATAONLY.
  8965
  8966     IF BCERTNOL = ZEROS
  8967       AND (BMAINTI = 'C' OR 'K' OR 'D')
  8968         NEXT SENTENCE
  8969     ELSE
  8970         IF BCERTNOL NOT = ZEROS
  8971             MOVE AL-UANON       TO BCERTNOA
  8972         ELSE
  8973             MOVE -1             TO BCERTNOL
  8974             MOVE  1             TO SET-CURSOR-SW
  8975             MOVE ER-2218        TO EMI-ERROR
  8976             MOVE AL-UABON       TO BCERTNOA
  8977             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8978
  8979     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 169
* EL6311.cbl
  8980         MOVE AL-UANON       TO BSUFIXA
  8981     ELSE
  8982         MOVE AL-SANOF       TO BSUFIXA.
  8983
  8984     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  8985        NEXT SENTENCE
  8986     ELSE
  8987        IF BEFFDTL NOT = ZEROS
  8988           MOVE AL-UNNON             TO BEFFDTA
  8989           MOVE BEFFDTI              TO DEEDIT-FIELD
  8990           PERFORM 8600-DEEDIT
  8991           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  8992           MOVE 4                    TO DC-OPTION-CODE
  8993           PERFORM 9700-DATE-LINK
  8994           IF NO-CONVERSION-ERROR
  8995              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  8996              ELSE
  8997              MOVE -1                TO BEFFDTL
  8998              MOVE  1                TO SET-CURSOR-SW
  8999              MOVE ER-2226           TO EMI-ERROR
  9000              MOVE AL-UNBON          TO BEFFDTA
  9001              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9002           ELSE
  9003              MOVE -1                TO BEFFDTL
  9004              MOVE  1                TO SET-CURSOR-SW
  9005              MOVE ER-2220           TO EMI-ERROR
  9006              MOVE AL-UNBON          TO BEFFDTA
  9007              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9008
  9009     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9010
  9011     IF BCERTNOL NOT = ZEROS
  9012        MOVE BCERTNOI                TO WS-NEW-PRIME
  9013     ELSE
  9014        MOVE SPACES                  TO WS-NEW-PRIME.
  9015
  9016     IF BSUFIXL NOT = ZEROS
  9017        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9018     ELSE
  9019        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9020
  9021     IF BEFFDTL NOT = ZEROS
  9022        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9023     ELSE
  9024        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9025
  9026     IF BMAINTI = 'A' OR 'K' OR 'S'
  9027        NEXT SENTENCE
  9028     ELSE
  9029        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9030        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9031           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9032           WS-PB-RECORD-TYPE NOT = '1'
  9033           IF BMAINTI = 'C'
  9034               MOVE ER-2287          TO EMI-ERROR
  9035               MOVE -1               TO BCERTNOL
  9036               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9037               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 170
* EL6311.cbl
  9038               GO TO 8200-SEND-DATAONLY
  9039             ELSE
  9040               MOVE ER-2260          TO EMI-ERROR
  9041               MOVE -1               TO BCERTNOL
  9042               MOVE AL-UABON         TO BCERTNOA
  9043               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9044               GO TO 8200-SEND-DATAONLY.
  9045
  9046     IF BMAINTI = 'D'
  9047         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9048
  9049*    IF BMICRNOL  NOT =  ZEROS
  9050*        IF BMICRNOI  NUMERIC
  9051*            MOVE AL-UNNON       TO  BMICRNOA
  9052*        ELSE
  9053*            MOVE -1             TO  BMICRNOL
  9054*            MOVE 1              TO  SET-CURSOR-SW
  9055*            MOVE AL-UNBON       TO  BMICRNOA
  9056*            MOVE ER-2701        TO  EMI-ERROR
  9057*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9058     IF BVINL NOT = ZEROS
  9059        MOVE AL-UANON            TO BVINA
  9060     END-IF
  9061     IF B1STNML NOT = ZEROS
  9062         MOVE AL-UANON                TO B1STNMA.
  9063
  9064     IF BINITL  NOT = ZEROS
  9065        MOVE AL-UANON                TO BINITA.
  9066
  9067     IF BSEXL NOT = ZEROS
  9068        IF BSEXI = 'M' OR 'F'
  9069           MOVE AL-UANON             TO BSEXA
  9070        ELSE
  9071           MOVE -1               TO BSEXL
  9072           MOVE ER-2629          TO EMI-ERROR
  9073           MOVE AL-UABON         TO BSEXA
  9074           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9075
  9076     IF BAGEL NOT = ZEROS
  9077         IF BAGEI NUMERIC
  9078             MOVE BAGEI              TO WS-BAGE
  9079             MOVE AL-UNNON           TO BAGEA
  9080         ELSE
  9081             MOVE -1                 TO BAGEL
  9082             MOVE  1                 TO SET-CURSOR-SW
  9083             MOVE ER-2223            TO EMI-ERROR
  9084             MOVE AL-UNBON           TO BAGEA
  9085             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9086
  9087     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9088
  9089     IF (BBIRTHL GREATER THAN +0) AND
  9090        (BBIRTHI NOT EQUAL SPACES)
  9091        NEXT SENTENCE
  9092     ELSE
  9093        GO TO 1010-CHECK-AGE.
  9094
  9095     MOVE BBIRTHI                TO DEEDIT-FIELD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 171
* EL6311.cbl
  9096     PERFORM 8600-DEEDIT.
  9097     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9098     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9099     MOVE AL-UNNON               TO BBIRTHA.
  9100     MOVE '4'                    TO DC-OPTION-CODE.
  9101     PERFORM 9700-DATE-LINK.
  9102     IF DATE-CONVERSION-ERROR
  9103        MOVE -1                  TO BBIRTHL
  9104        MOVE  1                  TO SET-CURSOR-SW
  9105        MOVE ER-2228             TO EMI-ERROR
  9106        MOVE AL-UNBON            TO BBIRTHA
  9107        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9108        GO TO 1010-CHECK-AGE.
  9109
  9110     IF (NO-CONVERSION-ERROR) AND
  9111        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9112        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9113        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9114        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9115                                    WS-CONVERTED-BIRTH
  9116        MOVE AL-UANON            TO BBIRTHA
  9117     ELSE
  9118        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9119        MOVE AL-UANON            TO BBIRTHA.
  9120
  9121 1010-CHECK-AGE.
  9122
  9123*    IF BAGEL = ZERO
  9124*       IF BBIRTHL GREATER THAN ZERO
  9125*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9126
  9127     IF B1STPMTL NOT = ZEROS
  9128        IF B1STPMTI = SPACES
  9129           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9130        ELSE
  9131           MOVE B1STPMTI             TO DEEDIT-FIELD
  9132           PERFORM 8600-DEEDIT
  9133           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9134           MOVE AL-UNNON             TO B1STPMTA
  9135           MOVE 4                    TO DC-OPTION-CODE
  9136           PERFORM 9700-DATE-LINK
  9137           IF NO-CONVERSION-ERROR
  9138              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9139              MOVE AL-UANON          TO B1STPMTA
  9140           ELSE
  9141              MOVE -1                TO B1STPMTL
  9142              MOVE  1                TO SET-CURSOR-SW
  9143              MOVE ER-2200           TO EMI-ERROR
  9144              MOVE AL-UNBON          TO B1STPMTA
  9145              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9146
  9147     IF BDAYSL NOT = ZEROS
  9148         IF BDAYSI NUMERIC
  9149             MOVE AL-UNNON           TO BDAYSA
  9150         ELSE
  9151             MOVE -1                 TO BDAYSL
  9152             MOVE ER-2530            TO EMI-ERROR
  9153             MOVE AL-UNBON           TO BDAYSA
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 172
* EL6311.cbl
  9154             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9155
  9156     IF BLNTRML NOT = ZEROS
  9157         IF BLNTRMI NUMERIC
  9158             MOVE AL-UNNON       TO BLNTRMA
  9159         ELSE
  9160             MOVE -1             TO BLNTRML
  9161             MOVE ER-2533        TO EMI-ERROR
  9162             MOVE AL-UNBON       TO BLNTRMA
  9163             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9164
  9165**   IF PI-COMPANY-ID = 'DMD'
  9166     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9167        NEXT SENTENCE
  9168     ELSE
  9169         IF BLNOFCRL NOT = ZEROS
  9170            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9171            IF LOAN-OFFICER-FOUND
  9172                MOVE AL-UANON        TO BLNOFCRA
  9173             ELSE
  9174                 MOVE SPACE          TO WS-LOAN-OFFICER
  9175                 MOVE -1             TO BLNOFCRL
  9176                 MOVE  1             TO SET-CURSOR-SW
  9177                 MOVE ER-3006        TO EMI-ERROR
  9178                 MOVE AL-UNBON       TO BLNOFCRA
  9179                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9180
  9181     IF BFREQL NOT = ZEROS
  9182         IF BFREQI NUMERIC
  9183             MOVE AL-UNNON       TO BFREQA
  9184         ELSE
  9185             MOVE -1             TO BFREQL
  9186             MOVE  1             TO SET-CURSOR-SW
  9187             MOVE ER-2223        TO EMI-ERROR
  9188             MOVE AL-UNBON       TO BFREQA
  9189             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9190
  9191     IF BMODEL NOT = ZEROS
  9192         MOVE BMODEI             TO WS-MODE-CODE
  9193                                    PI-BMODE
  9194         IF WS-MODE-CODE-VALID
  9195             MOVE AL-UANON       TO BMODEA
  9196         ELSE
  9197             MOVE -1             TO BMODEL
  9198             MOVE ER-2591        TO EMI-ERROR
  9199             MOVE AL-UABON       TO BMODEA
  9200             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9201
  9202     IF BPMTSL NOT = ZEROS
  9203         IF BPMTSI NUMERIC
  9204             MOVE AL-UNNON           TO BPMTSA
  9205             MOVE BPMTSI             TO PI-BPMTS
  9206         ELSE
  9207             MOVE -1                 TO BPMTSL
  9208             MOVE ER-2592            TO EMI-ERROR
  9209             MOVE AL-UNBON           TO BPMTSA
  9210             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9211
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 173
* EL6311.cbl
  9212     IF BPMTAMTL NOT = ZEROS
  9213
  9214* EXEC CICS BIF DEEDIT
  9215*            FIELD  (BPMTAMTI)
  9216*            LENGTH (9)
  9217*       END-EXEC
  9218     MOVE 9
  9219       TO DFHEIV11
  9220*    MOVE '@"L                   #   #00009148' TO DFHEIV0
  9221     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9222     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9223     MOVE X'2020233030303039313438' TO DFHEIV0(25:11)
  9224     CALL 'kxdfhei1' USING DFHEIV0,
  9225           BPMTAMTI,
  9226           DFHEIV11
  9227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9228        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9229*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9230*        PERFORM 8600-DEEDIT
  9231*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9232
  9233*    IF BAPRL NOT = ZEROS
  9234*        EXEC CICS BIF DEEDIT
  9235*            FIELD  (BAPRI)
  9236*            LENGTH (7)
  9237*        END-EXEC
  9238*        MOVE BAPRI              TO WS-BAPR.
  9239
  9240     IF BAPRL > 0
  9241        MOVE +0                  TO  WS-BAPR
  9242        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9243           (WS-SUB > 7)
  9244           OR (BAPRI (WS-SUB:1) NUMERIC)
  9245           OR (BAPRI (WS-SUB:1) = '.')
  9246        END-PERFORM
  9247        IF WS-SUB > 7
  9248           MOVE ER-2471       TO EMI-ERROR
  9249           MOVE -1            TO BAPRL
  9250           MOVE AL-UNBON      TO BAPRA
  9251           PERFORM 9900-ERROR-FORMAT
  9252                                 THRU 9900-EXIT
  9253        ELSE
  9254           IF BAPRI (WS-SUB:1) NUMERIC
  9255              MOVE WS-SUB           TO WS-BEG
  9256              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9257                 (WS-SUB > 7)
  9258                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9259              END-PERFORM
  9260              COMPUTE WS-END = WS-SUB - WS-BEG
  9261              MOVE BAPRI (WS-BEG:WS-END)
  9262                                 TO WS-APR-WHOLE-NUM
  9263           END-IF
  9264           IF BAPRI (WS-SUB:1) = '.'
  9265              COMPUTE WS-BEG = WS-SUB + 1
  9266              IF (WS-BEG < 8)
  9267                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9268                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9269                    (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 174
* EL6311.cbl
  9270                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9271                 END-PERFORM
  9272                 COMPUTE WS-END = WS-SUB - WS-BEG
  9273                 MOVE BAPRI (WS-BEG:WS-END)
  9274                                 TO WS-APR-DEC (1:WS-END)
  9275              END-IF
  9276           END-IF
  9277           MOVE AL-UNNON      TO BAPRA
  9278           MOVE WS-BAPR       TO BAPRO
  9279        END-IF
  9280     END-IF
  9281*     IF BAPRL NOT = ZEROS
  9282*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9283*        PERFORM 8600-DEEDIT
  9284*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9285
  9286     IF BLIVESL NOT = ZEROS
  9287        MOVE BLIVESI             TO DEEDIT-FIELD
  9288        PERFORM 8600-DEEDIT
  9289        IF DEEDIT-FIELD-V0 NUMERIC
  9290           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9291           MOVE AL-UNNON         TO BLIVESA
  9292        ELSE
  9293           MOVE -1               TO BLIVESL
  9294           MOVE AL-UNBON         TO BLIVESA
  9295           MOVE ER-2223          TO EMI-ERROR
  9296           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9297
  9298*DMD CUSTOM CODING*************START
  9299*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9300     IF PI-COMPANY-ID NOT = 'DMD'
  9301         MOVE ZEROS               TO BBILLEDL
  9302         GO TO 1010-EDIT-CONT.
  9303
  9304     IF BBILLEDL NOT = ZEROS
  9305        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9306        MOVE 'Y'                 TO WS-NUMERIC-SW
  9307        MOVE +1                  TO WS-CSO-SUB
  9308        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9309        IF CSO-NUMERIC-FIELD
  9310
  9311* EXEC CICS BIF DEEDIT
  9312*              FIELD  (BBILLEDI)
  9313*              LENGTH (9)
  9314*          END-EXEC
  9315     MOVE 9
  9316       TO DFHEIV11
  9317*    MOVE '@"L                   #   #00009234' TO DFHEIV0
  9318     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9319     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9320     MOVE X'2020233030303039323334' TO DFHEIV0(25:11)
  9321     CALL 'kxdfhei1' USING DFHEIV0,
  9322           BBILLEDI,
  9323           DFHEIV11
  9324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9325           MOVE BBILLEDI         TO WS-BILLED
  9326           MOVE AL-UNNON         TO BBILLEDA
  9327        ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 175
* EL6311.cbl
  9328           MOVE -1               TO BBILLEDL
  9329           MOVE AL-UNBON         TO BBILLEDA
  9330           MOVE ER-2547          TO EMI-ERROR
  9331           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9332     ELSE
  9333        IF BMAINTI EQUAL 'A'
  9334           MOVE -1               TO BBILLEDL
  9335           MOVE AL-UNBON         TO BBILLEDA
  9336           MOVE ER-8148          TO EMI-ERROR
  9337           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9338
  9339 1010-EDIT-CONT.
  9340
  9341     IF BFORCEL  NOT = ZEROS
  9342         IF FORCE-CAP
  9343            MOVE AL-UANON            TO BFORCEA
  9344         ELSE
  9345            MOVE ER-2945             TO EMI-ERROR
  9346            MOVE AL-UABON            TO BFORCEA
  9347            MOVE -1                  TO BFORCEL
  9348            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9349
  9350     IF BENTRYL NOT = ZEROS
  9351        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9352                         'D' AND 'V' AND 'U' AND 'M'
  9353           MOVE ER-2224              TO EMI-ERROR
  9354           MOVE AL-UABON             TO BENTRYA
  9355           MOVE -1                   TO BENTRYL
  9356           MOVE  1                   TO SET-CURSOR-SW
  9357           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9358        ELSE
  9359           MOVE AL-UANON             TO BENTRYA.
  9360
  9361     IF BUNWRITL NOT = ZEROS
  9362        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9363           MOVE ER-7574              TO EMI-ERROR
  9364           MOVE AL-UABON             TO BUNWRITA
  9365           MOVE -1                   TO BUNWRITL
  9366           MOVE  1                   TO SET-CURSOR-SW
  9367           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9368        ELSE
  9369           MOVE AL-UANON             TO BUNWRITA.
  9370
  9371     IF BREINL  NOT = ZEROS
  9372         MOVE AL-UANON               TO BREINA.
  9373
  9374     IF BBILCDL NOT = ZEROS
  9375        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9376                             AND 'A' AND 'B' AND 'E'
  9377           MOVE ER-2225              TO EMI-ERROR
  9378           MOVE AL-UABON             TO BBILCDA
  9379           MOVE -1                   TO BBILCDL
  9380           MOVE  1                   TO SET-CURSOR-SW
  9381           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9382        ELSE
  9383           MOVE AL-UANON             TO BBILCDA.
  9384
  9385     IF BSKPCDL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 176
* EL6311.cbl
  9386         MOVE AL-UANON               TO BSKPCDA.
  9387
  9388     IF BINDGRPL NOT = ZEROS
  9389         MOVE AL-UANON               TO BINDGRPA.
  9390
  9391     IF BSIGL   NOT = ZEROS
  9392         MOVE AL-UANON               TO BSIGA.
  9393
  9394     IF BRTCLSL NOT = ZEROS
  9395         MOVE AL-UANON               TO BRTCLSA.
  9396
  9397     IF BMEMBERL NOT = ZEROS
  9398         MOVE AL-UANON               TO BMEMBERA.
  9399
  9400     MOVE +0                         TO WS-SUB1.
  9401
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 177
* EL6311.cbl
  9403
  9404******************************************************************
  9405*                                                                *
  9406*           E D I T   I S S U E   C O V E R A G E S              *
  9407*                                                                *
  9408******************************************************************
  9409
  9410 1020-EDIT-COVERAGES.
  9411     ADD +1                      TO WS-SUB1.
  9412
  9413     IF WS-SUB1 GREATER +2
  9414        GO TO 1025-EDIT-COMPLETE.
  9415
  9416     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9417       IF (BMODEL   GREATER ZERO  OR
  9418            BPMTSL   GREATER ZERO  OR
  9419            BPMTAMTL GREATER ZERO)
  9420          AND
  9421            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9422               GO TO 1021-CONT-EDIT.
  9423
  9424     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9425        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9426        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9427        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9428        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9429        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9430        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9431        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9432        NEXT SENTENCE
  9433         ELSE
  9434            GO TO 1020-EDIT-COVERAGES.
  9435
  9436 1021-CONT-EDIT.
  9437
  9438     IF BMAINTI = 'A'
  9439        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9440           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9441        ELSE
  9442           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9443           MOVE ER-7404          TO EMI-ERROR
  9444           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9445           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9446     ELSE
  9447        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9448           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9449
  9450     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9451        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9452        PERFORM 8600-DEEDIT
  9453        IF DEEDIT-FIELD-V0 NUMERIC
  9454           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9455        ELSE
  9456           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9457
  9458     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9459*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
  9460        IF BMODEL  GREATER THAN ZEROS  AND
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 178
* EL6311.cbl
  9461           BPMTSL  GREATER THAN ZEROS
  9462           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9463
  9464     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9465         IF BMODEL   GREATER THAN ZEROS  OR
  9466            BPMTSL   GREATER THAN ZEROS  OR
  9467            BPMTAMTL GREATER THAN ZEROS
  9468             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9469
  9470     IF BMAINTI = ('C' OR 'K')
  9471        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9472           NEXT SENTENCE
  9473        ELSE
  9474           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9475           PERFORM 8600-DEEDIT
  9476           IF DEEDIT-FIELD-V0 NUMERIC
  9477              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9478              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9479                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9480              ELSE
  9481                    MOVE ER-2241      TO EMI-ERROR
  9482                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9483                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9484                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9485           ELSE
  9486              MOVE ER-2223          TO EMI-ERROR
  9487              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9488              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9489              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9490     ELSE
  9491        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9492            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9493            PERFORM 8600-DEEDIT
  9494            IF DEEDIT-FIELD-V0      NUMERIC
  9495               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9496                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9497                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9498               ELSE
  9499                  MOVE ER-2241         TO EMI-ERROR
  9500                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9501                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9502                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9503            ELSE
  9504              MOVE ER-2223             TO EMI-ERROR
  9505              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9506              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
  9507              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9508        ELSE
  9509            MOVE ER-2240               TO EMI-ERROR
  9510            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  9511            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9512*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9513*        IF BMODEL  GREATER THAN ZEROS  AND
  9514*           BPMTSL  GREATER THAN ZEROS
  9515*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9516
  9517     IF BBEN-LEN (WS-SUB1) = ZEROS
  9518        AND BMAINTI = ('C' OR 'K')
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 179
* EL6311.cbl
  9519           NEXT SENTENCE
  9520     ELSE
  9521        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  9522           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  9523
  9524* EXEC CICS BIF DEEDIT
  9525*              FIELD  (BBENI (WS-SUB1))
  9526*              LENGTH (12)
  9527*          END-EXEC
  9528     MOVE 12
  9529       TO DFHEIV11
  9530*    MOVE '@"L                   #   #00009436' TO DFHEIV0
  9531     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9532     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9533     MOVE X'2020233030303039343336' TO DFHEIV0(25:11)
  9534     CALL 'kxdfhei1' USING DFHEIV0,
  9535           BBENI(WS-SUB1),
  9536           DFHEIV11
  9537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9538           IF BBENI (WS-SUB1)  NUMERIC
  9539              IF BBENI (WS-SUB1) GREATER THAN ZEROS
  9540                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
  9541*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  9542*          PERFORM 8600-DEEDIT
  9543*          IF DEEDIT-FIELD-V2  NUMERIC
  9544*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9545*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  9546              ELSE
  9547                 MOVE ER-7632    TO EMI-ERROR
  9548                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9549                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9550                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9551           ELSE
  9552              MOVE ER-2223         TO EMI-ERROR
  9553              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  9554              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  9555              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9556        ELSE
  9557           MOVE ER-7632    TO EMI-ERROR
  9558           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  9559           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
  9560           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9561
  9562     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
  9563        AND (BMAINTI = ('C' OR 'K'))
  9564        CONTINUE
  9565     ELSE
  9566        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  9567           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  9568           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
  9569              FOR ALL '.'
  9570           IF WS-TALLY > 1
  9571              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9572                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
  9573              END-PERFORM
  9574              IF A1 < 9
  9575                 ADD 3 TO A1
  9576                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 180
* EL6311.cbl
  9577              END-IF
  9578           ELSE
  9579              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
  9580                (A1 > 11)
  9581                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
  9582                  LOW-VALUES OR SPACES)
  9583              END-PERFORM
  9584              IF A1 > 1 AND < 12
  9585                 MOVE SPACES
  9586                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
  9587              END-IF
  9588           END-IF
  9589
  9590* EXEC CICS BIF DEEDIT
  9591*              FIELD  (BPREMI (WS-SUB1))
  9592*              LENGTH (11)
  9593*          END-EXEC
  9594     MOVE 11
  9595       TO DFHEIV11
  9596*    MOVE '@"L                   #   #00009491' TO DFHEIV0
  9597     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9598     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9599     MOVE X'2020233030303039343931' TO DFHEIV0(25:11)
  9600     CALL 'kxdfhei1' USING DFHEIV0,
  9601           BPREMI(WS-SUB1),
  9602           DFHEIV11
  9603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9604           IF BPREMI (WS-SUB1) NUMERIC
  9605              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
  9606                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
  9607*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  9608*          PERFORM 8600-DEEDIT
  9609*          IF DEEDIT-FIELD-V2  NUMERIC
  9610*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  9611*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  9612              ELSE
  9613                 IF PI-COMPANY-ID NOT = 'DCC'
  9614                    MOVE ER-7633    TO EMI-ERROR
  9615                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
  9616                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  9617                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9618                 END-IF
  9619              END-IF
  9620           ELSE
  9621              MOVE ER-2223         TO EMI-ERROR
  9622              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9623              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9624              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9625           END-IF
  9626        ELSE
  9627           IF PI-COMPANY-ID NOT = 'DCC'
  9628              MOVE ER-7633         TO EMI-ERROR
  9629              MOVE -1              TO BPREM-LEN   (WS-SUB1)
  9630              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
  9631              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9632           END-IF
  9633        END-IF
  9634     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 181
* EL6311.cbl
  9635
  9636     IF BCPREM-LEN   (WS-SUB1) = ZEROS
  9637        NEXT SENTENCE
  9638     ELSE
  9639        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
  9640
  9641* EXEC CICS BIF DEEDIT
  9642*           FIELD  (BCPREMI (WS-SUB1))
  9643*           LENGTH (11)
  9644*       END-EXEC
  9645     MOVE 11
  9646       TO DFHEIV11
  9647*    MOVE '@"L                   #   #00009531' TO DFHEIV0
  9648     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9649     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9650     MOVE X'2020233030303039353331' TO DFHEIV0(25:11)
  9651     CALL 'kxdfhei1' USING DFHEIV0,
  9652           BCPREMI(WS-SUB1),
  9653           DFHEIV11
  9654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9655        IF BCPREMI (WS-SUB1) NUMERIC
  9656           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
  9657*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
  9658*       PERFORM 8600-DEEDIT
  9659*       IF DEEDIT-FIELD-V2  NUMERIC
  9660*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
  9661        ELSE
  9662           MOVE ER-2223         TO EMI-ERROR
  9663           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
  9664           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
  9665           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9666
  9667     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9668        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  9669        PERFORM 8600-DEEDIT
  9670        IF DEEDIT-FIELD-V0 NUMERIC
  9671           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  9672           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9673         ELSE
  9674           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  9675           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  9676           MOVE ER-2223              TO EMI-ERROR
  9677           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9678
  9679     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
  9680        IF BEXPIRE   (WS-SUB1) = SPACES
  9681           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  9682        ELSE
  9683           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
  9684           PERFORM 8600-DEEDIT
  9685           IF DEEDIT-FIELD-V0        NUMERIC
  9686              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
  9687              MOVE 4                TO DC-OPTION-CODE
  9688              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9689              PERFORM 9700-DATE-LINK
  9690              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
  9691                                                        (WS-SUB1)
  9692              IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 182
* EL6311.cbl
  9693                 NEXT SENTENCE
  9694              ELSE
  9695                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  9696                 MOVE ER-2531    TO EMI-ERROR
  9697                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  9698                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9699           ELSE
  9700             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  9701             MOVE ER-2532        TO EMI-ERROR
  9702             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  9703             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9704
  9705     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
  9706        NEXT SENTENCE
  9707     ELSE
  9708
  9709* EXEC CICS BIF DEEDIT
  9710*           FIELD  (BALT-BENI (WS-SUB1))
  9711*           LENGTH (12)
  9712*       END-EXEC
  9713     MOVE 12
  9714       TO DFHEIV11
  9715*    MOVE '@"L                   #   #00009588' TO DFHEIV0
  9716     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9717     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9718     MOVE X'2020233030303039353838' TO DFHEIV0(25:11)
  9719     CALL 'kxdfhei1' USING DFHEIV0,
  9720           BALT-BENI(WS-SUB1),
  9721           DFHEIV11
  9722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9723        IF BALT-BENI (WS-SUB1) NUMERIC
  9724           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
  9725*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
  9726*       PERFORM 8600-DEEDIT
  9727*       IF DEEDIT-FIELD-V0 NUMERIC
  9728*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
  9729        ELSE
  9730           MOVE ER-2223         TO EMI-ERROR
  9731           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
  9732           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
  9733           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9734
  9735     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
  9736        NEXT SENTENCE
  9737     ELSE
  9738
  9739* EXEC CICS BIF DEEDIT
  9740*           FIELD  (BALT-PREMI (WS-SUB1))
  9741*           LENGTH (11)
  9742*       END-EXEC
  9743     MOVE 11
  9744       TO DFHEIV11
  9745*    MOVE '@"L                   #   #00009607' TO DFHEIV0
  9746     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9747     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9748     MOVE X'2020233030303039363037' TO DFHEIV0(25:11)
  9749     CALL 'kxdfhei1' USING DFHEIV0,
  9750           BALT-PREMI(WS-SUB1),
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 183
* EL6311.cbl
  9751           DFHEIV11
  9752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9753        IF BALT-PREMI (WS-SUB1) NUMERIC
  9754           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
  9755*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
  9756*       PERFORM 8600-DEEDIT
  9757*       IF DEEDIT-FIELD-V0 NUMERIC
  9758*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
  9759        ELSE
  9760           MOVE ER-2223         TO EMI-ERROR
  9761           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
  9762           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
  9763           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9764
  9765      GO TO 1020-EDIT-COVERAGES.
  9766
  9767 1025-EDIT-COMPLETE.
  9768     IF PI-COMPANY-ID  =  'DMD'
  9769        MOVE LOW-VALUES             TO BNCERTI
  9770                                       BNSTATI.
  9771
  9772     IF EMI-ERROR = ZEROS
  9773         NEXT SENTENCE
  9774     ELSE
  9775         GO TO 8200-SEND-DATAONLY.
  9776
  9777     IF BMAINTI = 'A'
  9778         GO TO 1200-ADD-ISSUE-ROUTINE.
  9779
  9780     IF BMAINTI = 'C'
  9781         GO TO 1300-CHANGE-ISSUE-ROUTINE.
  9782
  9783     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
  9784
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 184
* EL6311.cbl
  9786
  9787 1030-EDIT-FOR-NUMERICS.
  9788     IF WS-CSO-SUB EQUAL 10
  9789        GO TO 1030-EDIT-EXIT.
  9790
  9791     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
  9792        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
  9793        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
  9794           ADD +1               TO WS-CSO-SUB
  9795           GO TO 1030-EDIT-FOR-NUMERICS.
  9796
  9797     MOVE 'N'                   TO WS-NUMERIC-SW.
  9798
  9799 1030-EDIT-EXIT.
  9800******************************************************************
  9801*                                                                *
  9802*                 C A L C U L A T E   A G E                      *
  9803*                                                                *
  9804******************************************************************
  9805
  9806
  9807 1095-CALC-AGE.
  9808
  9809     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
  9810     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
  9811     MOVE 1                  TO DC-OPTION-CODE.
  9812     PERFORM 9700-DATE-LINK
  9813     IF NO-CONVERSION-ERROR
  9814         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
  9815         MOVE WS-BAGE            TO BAGEI
  9816         MOVE +2                 TO BAGEL
  9817         MOVE AL-UNNON TO BAGEA.
  9818
  9819 1099-EXIT.
  9820     EXIT.
  9821
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 185
* EL6311.cbl
  9823
  9824******************************************************************
  9825*                                                                *
  9826*                   S H O W   I S S U E                          *
  9827*                                                                *
  9828******************************************************************
  9829
  9830 1100-SHOW-REQUEST.
  9831     MOVE 'S'                    TO PI-MAINT-FUNCTION.
  9832
  9833     IF BCERTNOL = ZEROS AND
  9834        BEFFDTL  = ZEROS
  9835        MOVE -1                  TO BMAINTL
  9836        GO TO 8200-SEND-DATAONLY.
  9837
  9838     MOVE BCERTNOI               TO WS-NEW-PRIME.
  9839
  9840     IF BSUFIXL NOT = ZEROS
  9841        MOVE BSUFIXI             TO WS-NEW-SUFFIX
  9842     ELSE
  9843        MOVE SPACE               TO WS-NEW-SUFFIX.
  9844
  9845     MOVE BEFFDTI                TO DEEDIT-FIELD.
  9846     PERFORM 8600-DEEDIT.
  9847     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9848     MOVE '4'                    TO DC-OPTION-CODE.
  9849     PERFORM 9700-DATE-LINK.
  9850     IF DATE-CONVERSION-ERROR
  9851        MOVE ER-0348             TO EMI-ERROR
  9852        MOVE -1                  TO BEFFDTL
  9853        MOVE AL-UABON            TO BEFFDTA
  9854        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9855        GO TO 8200-SEND-DATAONLY
  9856     ELSE
  9857        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
  9858        MOVE AL-UANON            TO BEFFDTA
  9859        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
  9860
  9861     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9862
  9863     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
  9864        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
  9865          MOVE 'Y'                    TO WS-SHOW-SW
  9866          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9867             GO TO 4100-BROWSE-PRIMARY-FORWARD
  9868           ELSE
  9869             IF PI-FILE-BROWSE
  9870                GO TO 4300-BROWSE-FILE-FORWARD
  9871              ELSE
  9872                IF PI-CSR-BROWSE
  9873                   GO TO 4200-BROWSE-CSR-FORWARD
  9874                ELSE
  9875                   GO TO 4000-BROWSE-DETAIL-FORWARD
  9876        ELSE
  9877           GO TO 3900-RE-DISPLAY-RECORD.
  9878
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 186
* EL6311.cbl
  9880
  9881******************************************************************
  9882*                                                                *
  9883*            A D D   I S S U E   R O U T I N E                   *
  9884*                                                                *
  9885******************************************************************
  9886
  9887***************************************************************
  9888*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
  9889*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
  9890*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
  9891*     4. LINK TO THE EDIT ROUTINE.                            *
  9892*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
  9893*     6. WRITE THE NEW ISSUE RECORD.                          *
  9894*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
  9895*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
  9896*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
  9897*        ELSE                                                 *
  9898*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
  9899***************************************************************
  9900
  9901 1200-ADD-ISSUE-ROUTINE.
  9902     MOVE 'A'                    TO PI-MAINT-FUNCTION.
  9903
  9904
  9905* EXEC CICS GETMAIN
  9906*        SET     (ADDRESS OF PENDING-BUSINESS)
  9907*        LENGTH  (ERPNDB-RECORD-LENGTH)
  9908*    END-EXEC.
  9909*    MOVE '," L                  $   #00009762' TO DFHEIV0
  9910     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9911     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9912     MOVE X'2020233030303039373632' TO DFHEIV0(25:11)
  9913     CALL 'kxdfhei1' USING DFHEIV0,
  9914           DFHEIV20,
  9915           ERPNDB-RECORD-LENGTH,
  9916           DFHEIV99
  9917     SET ADDRESS OF PENDING-BUSINESS TO
  9918         DFHEIV20
  9919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9920
  9921
  9922
  9923* EXEC CICS HANDLE CONDITION
  9924*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
  9925*    END-EXEC.
  9926*    MOVE '"$I                   ! # #00009767' TO DFHEIV0
  9927     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9928     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9929     MOVE X'2320233030303039373637' TO DFHEIV0(25:11)
  9930     CALL 'kxdfhei1' USING DFHEIV0
  9931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9932
  9933
  9934     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
  9935     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
  9936     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
  9937
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 187
* EL6311.cbl
  9938
  9939* EXEC CICS READ
  9940*        INTO    (PENDING-BUSINESS)
  9941*        DATASET (FILE-ID-ERPNDB)
  9942*        RIDFLD  (ERPNDB-KEY)
  9943*    END-EXEC.
  9944     MOVE LENGTH OF
  9945      PENDING-BUSINESS
  9946       TO DFHEIV11
  9947*    MOVE '&"IL       E          (   #00009775' TO DFHEIV0
  9948     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  9949     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9950     MOVE X'2020233030303039373735' TO DFHEIV0(25:11)
  9951     CALL 'kxdfhei1' USING DFHEIV0,
  9952           FILE-ID-ERPNDB,
  9953           PENDING-BUSINESS,
  9954           DFHEIV11,
  9955           ERPNDB-KEY,
  9956           DFHEIV99,
  9957           DFHEIV99,
  9958           DFHEIV99
  9959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9960
  9961
  9962     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
  9963
  9964     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
  9965     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
  9966     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
  9967     MOVE SPACES                 TO PENDING-BUSINESS.
  9968     MOVE 'PB'                   TO PB-RECORD-ID.
  9969     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
  9970     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
  9971     MOVE SPACES                 TO PB-CERT-SFX.
  9972     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
  9973     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
  9974                                    PB-ALT-CHG-SEQ-NO.
  9975
  9976     MOVE BCERTNOI               TO PB-CERT-PRIME.
  9977     MOVE '1'                    TO PB-RECORD-TYPE.
  9978
  9979     IF BSUFIXL NOT = ZEROS
  9980        MOVE BSUFIXI             TO PB-CERT-SFX.
  9981
  9982     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
  9983
  9984     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
  9985     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
  9986
  9987     MOVE ZEROS                  TO PB-I-LOAN-TERM
  9988                                    PB-I-LF-PREM-CALC
  9989                                    PB-I-LF-ALT-PREM-CALC
  9990                                    PB-I-LF-RATE
  9991                                    PB-I-LF-ALT-RATE
  9992                                    PB-I-LF-REI-RATE
  9993                                    PB-I-LF-ALT-REI-RATE
  9994                                    PB-I-RATE-DEV-PCT-LF
  9995                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 188
* EL6311.cbl
  9996                                    PB-I-AH-RATE
  9997                                    PB-I-AH-REI-RATE
  9998                                    PB-I-AH-RATE-TRM
  9999                                    PB-I-RATE-DEV-PCT-AH
 10000                                    PB-I-BUSINESS-TYPE
 10001                                    PB-I-LIFE-COMMISSION
 10002                                    PB-I-JOINT-COMMISSION
 10003                                    PB-I-JOINT-AGE
 10004                                    PB-I-AH-COMMISSION
 10005                                    PB-I-CURR-SEQ
 10006                                    PB-CHG-COUNT
 10007                                    PB-LF-BILLED-AMTS
 10008                                    PB-AH-BILLED-AMTS
 10009                                    PB-CALC-TOLERANCE
 10010                                    PB-I-EXTENTION-DAYS
 10011*                                   PB-I-MICROFILM-NO
 10012                                    PB-I-TERM-IN-DAYS.
 10013
 10014     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10015                                    PB-I-LF-EXPIRE-DT
 10016                                    PB-I-AH-EXPIRE-DT
 10017                                    PB-BILLED-DT
 10018                                    PB-ACCT-EFF-DT
 10019                                    PB-ACCT-EXP-DT
 10020                                    PB-I-1ST-PMT-DT.
 10021
 10022     MOVE 'X'                    TO PB-FATAL-FLAG.
 10023
 10024     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10025
 10026     IF BLSTNML GREATER THAN ZEROS
 10027         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10028
 10029*    IF BMICRNOL  GREATER  ZEROS
 10030*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10031*    ELSE
 10032*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10033     IF BVINL > ZEROS
 10034        MOVE BVINI               TO PB-I-VIN
 10035     END-IF
 10036     IF B1STNML GREATER THAN ZEROS
 10037         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10038
 10039     IF BINITL  GREATER THAN ZEROS
 10040         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10041
 10042     IF BBIRTHL GREATER THAN ZERO
 10043         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10044     ELSE
 10045         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10046
 10047     IF B1STPMTL GREATER THAN ZERO
 10048         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10049     ELSE
 10050         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10051
 10052     IF BAGEL    GREATER THAN ZEROS
 10053         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 189
* EL6311.cbl
 10054        ELSE
 10055         MOVE ZEROS              TO PB-I-AGE.
 10056
 10057     IF BSEXL    GREATER THAN ZEROS
 10058         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10059
 10060     IF BTERM-LEN (1) GREATER THAN ZEROS
 10061        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10062     ELSE
 10063        MOVE ZEROS               TO PB-I-LF-TERM.
 10064
 10065     IF BTERM-LEN (2) GREATER THAN ZEROS
 10066        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10067     ELSE
 10068        MOVE ZEROS               TO PB-I-AH-TERM.
 10069
 10070     IF BLNTRML       GREATER THAN ZEROS
 10071         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10072        ELSE
 10073         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10074
 10075     IF BFREQL        GREATER THAN ZEROS
 10076         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10077        ELSE
 10078         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10079
 10080     IF BSKPCDL       GREATER THAN ZEROS
 10081         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10082
 10083     IF BMODEL        GREATER THAN ZEROS
 10084         MOVE BMODEI             TO PB-I-TERM-TYPE
 10085                                    PI-BMODE.
 10086
 10087     IF BPMTSL        GREATER THAN ZEROS
 10088         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10089                                    PI-BPMTS
 10090        ELSE
 10091         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10092                                    PI-BPMTS.
 10093
 10094     IF BPMTAMTL      GREATER THAN ZEROS
 10095         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10096        ELSE
 10097         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10098
 10099     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10100        IF BTYPE  (1)   NOT = ZEROS
 10101           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10102                                    PI-BTYPE (1)
 10103           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10104           MOVE SPACES           TO PB-I-LF-ABBR
 10105        ELSE
 10106           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10107                                    PB-I-LF-ABBR
 10108           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10109     ELSE
 10110        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10111                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 190
* EL6311.cbl
 10112        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10113
 10114     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10115         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10116     ELSE
 10117         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10118
 10119     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10120         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10121     ELSE
 10122         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10123
 10124     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10125         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10126            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10127            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10128         ELSE
 10129            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10130            MOVE '?'             TO PB-I-LF-CALC-FLAG
 10131     ELSE
 10132         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10133
 10134     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10135         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10136
 10137     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10138         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10139         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10140     ELSE
 10141         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10142
 10143     IF  BALT-PREM-LEN     (2) > ZEROS
 10144         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10145     ELSE
 10146         MOVE ZEROS            TO PB-I-TOT-FEES.
 10147
 10148     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10149        IF BTYPE      (2)   NOT = ZEROS
 10150           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10151                                  PI-BTYPE (2)
 10152           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10153           MOVE SPACES         TO PB-I-AH-ABBR
 10154        ELSE
 10155           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10156                                  PB-I-AH-ABBR
 10157           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10158     ELSE
 10159        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10160                                  PB-I-AH-ABBR
 10161        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10162
 10163     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10164         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10165     ELSE
 10166         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10167
 10168     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10169         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 191
* EL6311.cbl
 10170            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10171            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10172         ELSE
 10173            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10174            MOVE '?'             TO PB-I-AH-CALC-FLAG
 10175     ELSE
 10176         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10177
 10178     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10179         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10180
 10181     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10182        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10183     ELSE
 10184        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10185
 10186     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10187        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10188     ELSE
 10189        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10190
 10191     IF BINDGRPL  GREATER THAN ZEROS
 10192         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10193
 10194     IF BRTCLSL   GREATER THAN ZEROS
 10195         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10196
 10197     IF BSIGL     GREATER THAN ZEROS
 10198         MOVE BSIGI              TO PB-I-SIG-SW.
 10199
 10200     IF BAPRL     GREATER THAN ZEROS
 10201         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10202     ELSE
 10203         MOVE ZEROS              TO PB-I-LOAN-APR.
 10204
 10205     IF BMEMBERL  GREATER THAN ZEROS
 10206         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10207
 10208     IF BLNOFCRL  GREATER THAN ZEROS
 10209         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10210
 10211     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10212        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10213     ELSE
 10214        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10215
 10216     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10217        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10218     ELSE
 10219        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10220
 10221     IF BDAYSL   GREATER THAN ZEROS
 10222        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10223                                    PB-I-EXTENTION-DAYS
 10224     ELSE
 10225        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10226                                    PB-I-EXTENTION-DAYS.
 10227
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 192
* EL6311.cbl
 10228     IF BDAYSL GREATER THAN ZEROS
 10229        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10230
 10231     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10232        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10233           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10234
 10235     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10236        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10237           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10238
 10239     IF B1STPMTL GREATER THAN ZEROS
 10240        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10241
 10242     IF PB-EXT-DAYS-PROCESSING
 10243        IF PB-I-EXTENTION-DAYS = ZEROS
 10244           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10245
 10246     IF PB-EXPIRE-DT-PROCESSING
 10247        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10248           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10249             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10250
 10251     IF PB-1ST-PMT-DT-PROCESSING
 10252        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10253           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10254
 10255     IF BREINL GREATER THAN ZEROS
 10256        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10257
 10258     IF BENTRYL NOT = ZEROS
 10259        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10260        IF PI-COMPANY-ID = 'CID'
 10261           AND (PB-BATCH-ENTRY = 'P')
 10262           AND (PB-STATE = 'VA')
 10263           PERFORM 1500-UPDATE-ERNOTE
 10264                                 THRU 1500-EXIT
 10265        END-IF
 10266     END-IF
 10267     IF BUNWRITL NOT = ZEROS
 10268        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10269
 10270     IF BFORCEL NOT = ZEROS
 10271        MOVE BFORCEI             TO PB-FORCE-CODE.
 10272
 10273     IF BBILCDL NOT = ZEROS
 10274        MOVE BBILCDI             TO PB-RECORD-BILL.
 10275
 10276     IF BLIVESL GREATER THAN ZEROS
 10277        MOVE WS-BLIVES           TO PB-I-LIVES
 10278     ELSE
 10279        MOVE ZEROS               TO PB-I-LIVES.
 10280
 10281     IF BBILLEDL GREATER THAN ZEROS
 10282        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10283     ELSE
 10284        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10285
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 193
* EL6311.cbl
 10286*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10287
 10288 1260-WRITE-PB-RECORD.
 10289     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10290                                    PB-INPUT-BY.
 10291     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10292     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10293                                    PB-INPUT-DT.
 10294
 10295     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10296     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10297                                    PB-CONTROL-BY-ORIG-BATCH.
 10298
 10299
 10300     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10301     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10302     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10303     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10304     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10305
 10306     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10307
 10308     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10309
 10310     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10311     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10312     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10313
 10314     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10315     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10316
 10317 1275-WRITE-PENDING-BUSINESS.
 10318     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10319     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10320     MOVE 'A'                    TO JP-RECORD-TYPE.
 10321     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10322
 10323
 10324* EXEC CICS HANDLE CONDITION
 10325*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10326*    END-EXEC.
 10327*    MOVE '"$%                   ! $ #00010142' TO DFHEIV0
 10328     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10330     MOVE X'2420233030303130313432' TO DFHEIV0(25:11)
 10331     CALL 'kxdfhei1' USING DFHEIV0
 10332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10333
 10334
 10335
 10336* EXEC CICS WRITE
 10337*        DATASET (FILE-ID-ERPNDB)
 10338*        FROM    (PENDING-BUSINESS)
 10339*        RIDFLD  (PB-CONTROL-PRIMARY)
 10340*    END-EXEC.
 10341     MOVE LENGTH OF
 10342      PENDING-BUSINESS
 10343       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 194
* EL6311.cbl
 10344*    MOVE '&$ L                  ''   #00010146' TO DFHEIV0
 10345     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10346     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10347     MOVE X'2020233030303130313436' TO DFHEIV0(25:11)
 10348     CALL 'kxdfhei1' USING DFHEIV0,
 10349           FILE-ID-ERPNDB,
 10350           PENDING-BUSINESS,
 10351           DFHEIV11,
 10352           PB-CONTROL-PRIMARY,
 10353           DFHEIV99,
 10354           DFHEIV99
 10355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10356
 10357
 10358     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10359
 10360     PERFORM 8400-LOG-JOURNAL-RECORD.
 10361
 10362******************************************************************
 10363*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10364******************************************************************
 10365     display ' made it to add orig cert '
 10366     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10367     MOVE ' '                    TO WS-ERMAIL-SW
 10368
 10369* EXEC CICS READ
 10370*       DATASET   (FILE-ID-ERMAIL)
 10371*       SET       (ADDRESS OF MAILING-DATA)
 10372*       RIDFLD    (ERMAIL-KEY)
 10373*       RESP      (WS-RESPONSE)
 10374*    END-EXEC
 10375*    MOVE '&"S        E          (  N#00010162' TO DFHEIV0
 10376     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10377     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10378     MOVE X'204E233030303130313632' TO DFHEIV0(25:11)
 10379     CALL 'kxdfhei1' USING DFHEIV0,
 10380           FILE-ID-ERMAIL,
 10381           DFHEIV20,
 10382           DFHEIV99,
 10383           ERMAIL-KEY,
 10384           DFHEIV99,
 10385           DFHEIV99,
 10386           DFHEIV99
 10387     SET ADDRESS OF MAILING-DATA TO
 10388         DFHEIV20
 10389     MOVE EIBRESP  TO WS-RESPONSE
 10390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10391     IF RESP-NORMAL
 10392        SET ERMAIL-FOUND TO TRUE
 10393     END-IF
 10394     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10395     MOVE 'OC'                   TO OC-RECORD-ID
 10396     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10397                                 TO OC-CONTROL-PRIMARY (1:33)
 10398     MOVE 'I'                    TO OC-RECORD-TYPE
 10399     MOVE +4096                  TO OC-KEY-SEQ-NO
 10400     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10401     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 195
* EL6311.cbl
 10402     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10403     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10404     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10405     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10406     MOVE PB-I-AGE               TO OC-INS-AGE
 10407     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10408     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10409     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10410     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10411     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10412     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10413     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10414     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10415     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10416     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10417     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10418     IF PB-I-JOINT-COMMISSION > +0
 10419         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10420     ELSE
 10421         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10422     END-IF
 10423     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10424     MOVE +0                     TO OC-LF-CANCEL-AMT
 10425                                    OC-LF-ITD-CANCEL-AMT
 10426     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10427     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10428     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10429     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10430     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10431     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10432     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10433     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10434     MOVE +0                     TO OC-AH-CANCEL-AMT
 10435                                    OC-AH-ITD-CANCEL-AMT
 10436     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10437     IF ERMAIL-FOUND
 10438        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10439     END-IF
 10440     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10441     .
 10442 1275-WRITE-ELCRTO.
 10443
 10444* EXEC CICS WRITE
 10445*       DATASET   ('ELCRTO')
 10446*       FROM      (ORIGINAL-CERTIFICATE)
 10447*       RIDFLD    (OC-CONTROL-PRIMARY)
 10448*       RESP      (WS-RESPONSE)
 10449*    END-EXEC
 10450     MOVE LENGTH OF
 10451      ORIGINAL-CERTIFICATE
 10452       TO DFHEIV11
 10453     MOVE 'ELCRTO' TO DFHEIV1
 10454*    MOVE '&$ L                  ''  N#00010220' TO DFHEIV0
 10455     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10456     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10457     MOVE X'204E233030303130323230' TO DFHEIV0(25:11)
 10458     CALL 'kxdfhei1' USING DFHEIV0,
 10459           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 196
* EL6311.cbl
 10460           ORIGINAL-CERTIFICATE,
 10461           DFHEIV11,
 10462           OC-CONTROL-PRIMARY,
 10463           DFHEIV99,
 10464           DFHEIV99
 10465     MOVE EIBRESP  TO WS-RESPONSE
 10466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10467     display ' just wrote 1275 ' ws-response
 10468     IF RESP-DUPKEY
 10469        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10470        GO TO 1275-WRITE-ELCRTO
 10471     ELSE
 10472        IF NOT RESP-NORMAL
 10473           MOVE -1               TO BMAINTL
 10474           MOVE ER-7450          TO EMI-ERROR
 10475           PERFORM 9900-ERROR-FORMAT
 10476                                 THRU 9900-EXIT
 10477           GO TO 8200-SEND-DATAONLY
 10478        END-IF
 10479     END-IF
 10480******************************************************************
 10481*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10482******************************************************************
 10483
 10484
 10485* EXEC CICS READ
 10486*        INTO    (PENDING-BUSINESS)
 10487*        DATASET (FILE-ID-ERPNDB)
 10488*        RIDFLD  (ERPNDB-KEY)
 10489*        UPDATE
 10490*    END-EXEC.
 10491     MOVE LENGTH OF
 10492      PENDING-BUSINESS
 10493       TO DFHEIV11
 10494*    MOVE '&"IL       EU         (   #00010243' TO DFHEIV0
 10495     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10496     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10497     MOVE X'2020233030303130323433' TO DFHEIV0(25:11)
 10498     CALL 'kxdfhei1' USING DFHEIV0,
 10499           FILE-ID-ERPNDB,
 10500           PENDING-BUSINESS,
 10501           DFHEIV11,
 10502           ERPNDB-KEY,
 10503           DFHEIV99,
 10504           DFHEIV99,
 10505           DFHEIV99
 10506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10507
 10508
 10509     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10510     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10511     MOVE 'B'                    TO JP-RECORD-TYPE.
 10512     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10513
 10514     PERFORM 8400-LOG-JOURNAL-RECORD.
 10515
 10516     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 10517
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 197
* EL6311.cbl
 10518
 10519* EXEC CICS REWRITE
 10520*        DATASET (FILE-ID-ERPNDB)
 10521*        FROM    (PENDING-BUSINESS)
 10522*    END-EXEC.
 10523     MOVE LENGTH OF
 10524      PENDING-BUSINESS
 10525       TO DFHEIV11
 10526*    MOVE '&& L                  %   #00010259' TO DFHEIV0
 10527     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10528     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10529     MOVE X'2020233030303130323539' TO DFHEIV0(25:11)
 10530     CALL 'kxdfhei1' USING DFHEIV0,
 10531           FILE-ID-ERPNDB,
 10532           PENDING-BUSINESS,
 10533           DFHEIV11,
 10534           DFHEIV99
 10535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10536
 10537
 10538     MOVE 'C'                    TO JP-RECORD-TYPE.
 10539     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10540
 10541     PERFORM 8400-LOG-JOURNAL-RECORD.
 10542
 10543     IF WS-ERRORS-PRESENT
 10544         GO TO 3900-RE-DISPLAY-RECORD.
 10545
 10546     MOVE ZEROS                  TO EMI-ERROR.
 10547     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10548     MOVE LOW-VALUES             TO EL631BI.
 10549     MOVE  -1                    TO BMAINTL.
 10550     GO TO 8100-SEND-INITIAL-MAP.
 10551
 10552 1280-BATCH-HDR-NOT-FOUND.
 10553     MOVE -1                     TO BMAINTL.
 10554     MOVE ER-7450                TO EMI-ERROR.
 10555     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10556     GO TO 8200-SEND-DATAONLY.
 10557
 10558 1290-DUPLICATE-ALT-INDEX.
 10559
 10560******************************************************************
 10561*                                                                *
 10562*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 10563*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 10564*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 10565*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 10566*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 10567*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 10568*                                                                *
 10569******************************************************************
 10570
 10571     IF LCP-ONCTR-01 =  0
 10572         ADD 1 TO LCP-ONCTR-01
 10573        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 10574
 10575     ADD +1                      TO WS-SEQ-NO-COUNTER.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 198
* EL6311.cbl
 10576
 10577     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 10578         NEXT SENTENCE
 10579     ELSE
 10580         ADD +1 TO PB-BATCH-SEQ-NO
 10581                   PB-CSR-BATCH-SEQ-NO
 10582         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 10583         GO TO 1275-WRITE-PENDING-BUSINESS.
 10584
 10585     MOVE -1                     TO BCERTNOL.
 10586     MOVE AL-UABON               TO BCERTNOA.
 10587     MOVE AL-UNBON               TO BEFFDTA.
 10588
 10589     MOVE 1                      TO EMI-SUB
 10590                                    EMI-SWITCH1
 10591                                    EMI-SWITCH-AREA-1
 10592                                    EMI-SWITCH-AREA-2.
 10593
 10594     MOVE SPACES                 TO EMI-ERROR-LINES.
 10595
 10596
 10597* EXEC CICS SYNCPOINT ROLLBACK
 10598*    END-EXEC.
 10599*    MOVE '6"R                   !   #00010322' TO DFHEIV0
 10600     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 10601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10602     MOVE X'2020233030303130333232' TO DFHEIV0(25:11)
 10603     CALL 'kxdfhei1' USING DFHEIV0
 10604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10605
 10606
 10607     MOVE ER-2247                TO EMI-ERROR.
 10608     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10609     GO TO 8200-SEND-DATAONLY.
 10610
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 199
* EL6311.cbl
 10612
 10613******************************************************************
 10614*                                                                *
 10615*          C H A N G E   I S S U E   R O U T I N E               *
 10616*                                                                *
 10617******************************************************************
 10618
 10619***************************************************************
 10620*                                                             *
 10621*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 10622*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10623*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 10624*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 10625*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 10626*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 10627*     5. LINK TO THE EDIT ROUTINE.                            *
 10628*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10629*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 10630*              THE EDIT ROUTINE.                              *
 10631*     7. REWRITE THE NEW ISSUE                                *
 10632*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10633*                                                             *
 10634***************************************************************
 10635
 10636 1300-CHANGE-ISSUE-ROUTINE.
 10637     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 10638
 10639     IF BCHGL NOT = ZEROS
 10640        MOVE ER-2196             TO EMI-ERROR
 10641        MOVE AL-UABON            TO BMAINTA
 10642        MOVE -1                  TO BMAINTL
 10643        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10644        GO TO 8200-SEND-DATAONLY.
 10645
 10646     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10647
 10648     IF BSUFIXL NOT = ZEROS
 10649        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10650     ELSE
 10651        MOVE SPACE               TO WS-NEW-SUFFIX.
 10652
 10653     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10654     PERFORM 8600-DEEDIT.
 10655     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10656     MOVE '4'                    TO DC-OPTION-CODE.
 10657     PERFORM 9700-DATE-LINK.
 10658     IF DATE-CONVERSION-ERROR
 10659        MOVE ER-0348             TO EMI-ERROR
 10660        MOVE -1                  TO BEFFDTL
 10661        MOVE AL-UABON            TO BEFFDTA
 10662        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10663        GO TO 8200-SEND-DATAONLY
 10664     ELSE
 10665        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10666        MOVE AL-UANON            TO BEFFDTA
 10667        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10668
 10669 1325-PROCESS-ISSUE-CHANGES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 200
* EL6311.cbl
 10670
 10671* EXEC CICS HANDLE CONDITION
 10672*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 10673*    END-EXEC.
 10674*    MOVE '"$I                   ! % #00010388' TO DFHEIV0
 10675     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10676     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10677     MOVE X'2520233030303130333838' TO DFHEIV0(25:11)
 10678     CALL 'kxdfhei1' USING DFHEIV0
 10679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10680
 10681
 10682     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 10683     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 10684     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 10685
 10686
 10687* EXEC CICS GETMAIN
 10688*        SET      (ADDRESS OF PENDING-BUSINESS)
 10689*        LENGTH   (ERPNDB-RECORD-LENGTH)
 10690*        INITIMG  (GETMAIN-SPACE)
 10691*     END-EXEC.
 10692*    MOVE ',"IL                  $   #00010396' TO DFHEIV0
 10693     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 10694     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10695     MOVE X'2020233030303130333936' TO DFHEIV0(25:11)
 10696     CALL 'kxdfhei1' USING DFHEIV0,
 10697           DFHEIV20,
 10698           ERPNDB-RECORD-LENGTH,
 10699           GETMAIN-SPACE
 10700     SET ADDRESS OF PENDING-BUSINESS TO
 10701         DFHEIV20
 10702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10703
 10704
 10705
 10706* EXEC CICS READ
 10707*        INTO    (PENDING-BUSINESS)
 10708*        DATASET (FILE-ID-ERPNDB)
 10709*        RIDFLD  (ERPNDB-KEY)
 10710*    END-EXEC.
 10711     MOVE LENGTH OF
 10712      PENDING-BUSINESS
 10713       TO DFHEIV11
 10714*    MOVE '&"IL       E          (   #00010402' TO DFHEIV0
 10715     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10716     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10717     MOVE X'2020233030303130343032' TO DFHEIV0(25:11)
 10718     CALL 'kxdfhei1' USING DFHEIV0,
 10719           FILE-ID-ERPNDB,
 10720           PENDING-BUSINESS,
 10721           DFHEIV11,
 10722           ERPNDB-KEY,
 10723           DFHEIV99,
 10724           DFHEIV99,
 10725           DFHEIV99
 10726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10727
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 201
* EL6311.cbl
 10728
 10729     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10730
 10731
 10732* EXEC CICS HANDLE CONDITION
 10733*         NOTFND     (1385-REC-NOT-FOUND)
 10734*    END-EXEC.
 10735*    MOVE '"$I                   ! & #00010410' TO DFHEIV0
 10736     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10737     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10738     MOVE X'2620233030303130343130' TO DFHEIV0(25:11)
 10739     CALL 'kxdfhei1' USING DFHEIV0
 10740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10741
 10742
 10743**********************************************************
 10744*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 10745*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 10746**********************************************************
 10747
 10748
 10749* EXEC CICS READ
 10750*        DATASET (FILE-ID-ERPNDB)
 10751*        INTO    (PENDING-BUSINESS)
 10752*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10753*    END-EXEC.
 10754     MOVE LENGTH OF
 10755      PENDING-BUSINESS
 10756       TO DFHEIV11
 10757*    MOVE '&"IL       E          (   #00010419' TO DFHEIV0
 10758     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10759     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10760     MOVE X'2020233030303130343139' TO DFHEIV0(25:11)
 10761     CALL 'kxdfhei1' USING DFHEIV0,
 10762           FILE-ID-ERPNDB,
 10763           PENDING-BUSINESS,
 10764           DFHEIV11,
 10765           PI-PREV-CONTROL-PRIMARY,
 10766           DFHEIV99,
 10767           DFHEIV99,
 10768           DFHEIV99
 10769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10770
 10771
 10772********** DO NOT ALLOW CHANGES IF THRU A/R
 10773     IF BMAINTI = 'C'
 10774         IF PB-EL860-INTERNAL-PROCESS
 10775             MOVE ER-4005          TO EMI-ERROR
 10776             MOVE -1               TO BMAINTL
 10777             MOVE AL-UABON         TO BMAINTA
 10778             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10779             GO TO 8200-SEND-DATAONLY.
 10780**********
 10781
 10782     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 10783        MOVE -1                 TO BMAINTL
 10784        MOVE ER-2197            TO EMI-ERROR
 10785        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 202
* EL6311.cbl
 10786        GO TO 8200-SEND-DATAONLY.
 10787
 10788     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 10789        MOVE ER-2196             TO EMI-ERROR
 10790        MOVE AL-UABON            TO BMAINTA
 10791        MOVE -1                  TO BMAINTL
 10792        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10793        GO TO 8200-SEND-DATAONLY.
 10794
 10795     MOVE ZEROS                  TO WS-SEQ-SAVE.
 10796
 10797     IF PB-BILLED-DT = LOW-VALUES AND
 10798        PB-CHG-COUNT = ZEROS
 10799        NEXT SENTENCE
 10800     ELSE
 10801        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 10802            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 10803           OR
 10804           (BPREM-LEN (2) GREATER THAN ZEROS AND
 10805            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 10806           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 10807
 10808
 10809* EXEC CICS READ
 10810*        DATASET (FILE-ID-ERPNDB)
 10811*        INTO    (PENDING-BUSINESS)
 10812*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 10813*        UPDATE
 10814*    END-EXEC.
 10815     MOVE LENGTH OF
 10816      PENDING-BUSINESS
 10817       TO DFHEIV11
 10818*    MOVE '&"IL       EU         (   #00010461' TO DFHEIV0
 10819     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10820     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10821     MOVE X'2020233030303130343631' TO DFHEIV0(25:11)
 10822     CALL 'kxdfhei1' USING DFHEIV0,
 10823           FILE-ID-ERPNDB,
 10824           PENDING-BUSINESS,
 10825           DFHEIV11,
 10826           PI-PREV-CONTROL-PRIMARY,
 10827           DFHEIV99,
 10828           DFHEIV99,
 10829           DFHEIV99
 10830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10831
 10832
 10833     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10834     MOVE 'B'                    TO JP-RECORD-TYPE
 10835     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10836     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10837
 10838     PERFORM 8400-LOG-JOURNAL-RECORD.
 10839
 10840     IF PB-BILLED-DT NOT = LOW-VALUES OR
 10841        PB-CHG-COUNT NOT = ZEROS
 10842        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 10843            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 203
* EL6311.cbl
 10844           OR
 10845           (BPREM-LEN (2) GREATER THAN ZEROS AND
 10846            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 10847            MOVE LOW-VALUES             TO PB-BILLED-DT
 10848            ADD +1                      TO PB-CHG-COUNT.
 10849
 10850     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 10851     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10852     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 10853     MOVE '5'                    TO DC-OPTION-CODE.
 10854     PERFORM 9700-DATE-LINK
 10855     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 10856
 10857*    IF BMICRNOL  GREATER  ZEROS
 10858*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 10859
 10860     IF BVINL > ZEROS
 10861        MOVE BVINI               TO PB-I-VIN
 10862     END-IF
 10863     IF (BFORCEL NOT = ZEROS)
 10864        AND (PB-COMPANY-ID = 'DCC')
 10865        AND (BFORCEI = ' ')
 10866        AND (PB-FORCE-CODE = 'O')
 10867        COMPUTE PB-I-AH-PREMIUM-AMT =
 10868           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 10869        PERFORM 1800-REMOVE-CERT-NOTES
 10870                                 THRU 1800-EXIT
 10871        PERFORM 1900-DELETE-ERPYAJ
 10872                                 THRU 1900-EXIT
 10873        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 10874     END-IF
 10875     IF (BFORCEL NOT = ZEROS)
 10876        AND (PB-COMPANY-ID = 'DCC')
 10877        AND (BFORCEI = 'O')
 10878        AND (PB-FORCE-CODE NOT = 'O')
 10879        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 10880           PB-I-AH-PREM-CALC
 10881        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 10882        MOVE SPACE               TO DC-OPTION-CODE
 10883        PERFORM 9700-DATE-LINK
 10884        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 10885        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 10886        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 10887        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 10888        PERFORM 1500-UPDATE-ERNOTE
 10889                                 THRU 1500-EXIT
 10890        PERFORM 1600-UPDATE-ERPYAJ
 10891                                 THRU 1600-EXIT
 10892     END-IF
 10893     IF BLSTNML  GREATER THAN ZEROS
 10894         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10895
 10896     IF B1STNML  GREATER THAN ZEROS
 10897         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10898
 10899     IF BINITL   GREATER THAN ZEROS
 10900         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10901
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 204
* EL6311.cbl
 10902     IF BBIRTHL  GREATER THAN ZERO
 10903         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 10904
 10905     IF B1STPMTL GREATER THAN ZERO
 10906         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 10907
 10908     IF BAGEL    GREATER THAN ZEROS
 10909         MOVE BAGEI              TO PB-I-AGE.
 10910
 10911     IF BSEXL    GREATER THAN ZEROS
 10912         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10913
 10914     IF BTERM-LEN (1)   GREATER THAN ZEROS
 10915        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 10916
 10917     IF BTERM-LEN (2)   GREATER THAN ZEROS
 10918        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 10919
 10920     IF BLNTRML  GREATER THAN ZEROS
 10921         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 10922
 10923     IF BFREQL   GREATER THAN ZEROS
 10924         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 10925
 10926     IF BSKPCDL  GREATER THAN ZEROS
 10927         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10928
 10929     IF BMODEL   GREATER THAN ZEROS
 10930         MOVE BMODEI             TO PB-I-TERM-TYPE
 10931                                    PI-BMODE.
 10932
 10933     IF BPMTSL   GREATER THAN ZEROS
 10934         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10935                                    PI-BPMTS.
 10936
 10937     IF BPMTAMTL GREATER THAN ZEROS
 10938         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 10939
 10940     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10941         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 10942
 10943     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10944         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 10945
 10946     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 10947
 10948     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10949         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10950            SUBTRACT PB-I-LF-PREMIUM-AMT
 10951                     FROM WS-B-LF-ISS-PRM-ENTERED
 10952            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10953            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10954            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 10955         ELSE
 10956            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10957            MOVE '?'             TO PB-I-LF-CALC-FLAG.
 10958
 10959     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 205
* EL6311.cbl
 10960            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 10961                     FROM WS-B-LF-ISS-PRM-ENTERED
 10962         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10963         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 10964
 10965     IF  BALT-PREM-LEN     (2)  > ZEROS
 10966         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 10967
 10968     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 10969         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 10970
 10971     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10972         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10973            SUBTRACT PB-I-AH-PREMIUM-AMT
 10974                     FROM WS-B-AH-ISS-PRM-ENTERED
 10975            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10976            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10977            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 10978         ELSE
 10979            MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10980            MOVE '?'             TO PB-I-AH-CALC-FLAG.
 10981
 10982     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10983        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 10984
 10985     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10986        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 10987
 10988     IF BINDGRPL            GREATER THAN ZEROS
 10989         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10990
 10991     IF BRTCLSL             GREATER THAN ZEROS
 10992         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10993
 10994     IF BSIGL               GREATER THAN ZEROS
 10995         MOVE BSIGI              TO PB-I-SIG-SW.
 10996
 10997     IF BAPRL               GREATER THAN ZEROS
 10998         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 10999
 11000     IF BMEMBERL            GREATER THAN ZEROS
 11001         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11002
 11003     IF BLNOFCRL            GREATER THAN ZEROS
 11004         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11005
 11006     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11007        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11008
 11009     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11010        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11011
 11012     IF BDAYSL              GREATER THAN ZEROS
 11013        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11014                                    PB-I-EXTENTION-DAYS.
 11015
 11016     IF BDAYSL GREATER THAN ZEROS
 11017        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 206
* EL6311.cbl
 11018
 11019     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11020        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11021           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11022
 11023     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11024        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11025           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11026
 11027     IF B1STPMTL GREATER THAN ZEROS
 11028        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11029
 11030     IF PB-EXT-DAYS-PROCESSING
 11031        IF PB-I-EXTENTION-DAYS = ZEROS
 11032           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11033
 11034     IF PB-EXPIRE-DT-PROCESSING
 11035        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11036           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11037             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11038
 11039     IF PB-1ST-PMT-DT-PROCESSING
 11040        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11041           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11042
 11043     IF BREINL GREATER THAN ZEROS
 11044        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11045
 11046     IF BFORCEL NOT = ZEROS
 11047        MOVE BFORCEI             TO PB-FORCE-CODE.
 11048     IF (BENTRYL NOT = ZEROS)
 11049        AND (PB-COMPANY-ID = 'CID')
 11050        AND (PB-STATE = 'VA')
 11051        AND (BENTRYI NOT = 'P')
 11052        AND (PB-BATCH-ENTRY = 'P')
 11053        PERFORM 1800-REMOVE-CERT-NOTES
 11054                                 THRU 1800-EXIT
 11055     END-IF
 11056     IF BENTRYL NOT = ZEROS
 11057        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11058        IF PI-COMPANY-ID = 'CID'
 11059           AND (PB-BATCH-ENTRY = 'P')
 11060           AND (PB-STATE = 'VA')
 11061           PERFORM 1500-UPDATE-ERNOTE
 11062                                 THRU 1500-EXIT
 11063        END-IF
 11064     END-IF
 11065
 11066     IF BUNWRITL NOT = ZEROS
 11067        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11068
 11069     IF BBILCDL NOT = ZEROS
 11070        MOVE BBILCDI             TO PB-RECORD-BILL.
 11071
 11072     IF BLIVESL GREATER THAN ZEROS
 11073        MOVE WS-BLIVES           TO PB-I-LIVES.
 11074
 11075
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 207
* EL6311.cbl
 11076*DMD CUSTOM CODING*************START
 11077     IF PI-COMPANY-ID NOT = 'DMD'
 11078         MOVE ZEROS               TO BBILLEDL.
 11079*DMD CUSTOM CODING*************END
 11080
 11081     IF BBILLEDL GREATER THAN ZEROS
 11082        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11083
 11084
 11085*****************************************************************
 11086*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11087*****************************************************************
 11088
 11089     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11090        IF BTYPE  (1)   = ZEROS OR SPACES
 11091           IF REMOVE-LF-COVERAGE
 11092               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11093                                        PI-BTYPE (1)
 11094               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11095                                        WS-B-LF-ISS-PRM-ENTERED
 11096               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11097                                        WS-B-LF-ISS-PRM-ENTERED
 11098               SUBTRACT PB-I-LF-PREM-CALC FROM
 11099                                        WS-B-LF-ISS-PRM-COMPUTED
 11100               MOVE ZEROS            TO PB-I-LF-TERM
 11101                                        PB-I-LF-BENEFIT-AMT
 11102                                        PB-I-LF-PREMIUM-AMT
 11103                                        PB-I-LF-BENEFIT-CD
 11104                                        PB-I-LF-PREM-CALC
 11105                                        PB-I-LF-CRIT-PER
 11106                                        PB-I-LF-ALT-BENEFIT-AMT
 11107                                        PB-I-LF-ALT-PREMIUM-AMT
 11108               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11109           ELSE
 11110               NEXT SENTENCE
 11111        ELSE
 11112           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11113                                    PI-BTYPE (1).
 11114     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11115        IF BTYPE  (2)   = ZEROS OR SPACES
 11116           IF  REMOVE-AH-COVERAGE
 11117               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11118                                        PI-BTYPE (2)
 11119               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11120                                        WS-B-AH-ISS-PRM-ENTERED
 11121               SUBTRACT PB-I-AH-PREM-CALC FROM
 11122                                        WS-B-AH-ISS-PRM-COMPUTED
 11123               MOVE ZEROS            TO PB-I-AH-TERM
 11124                                        PB-I-AH-BENEFIT-AMT
 11125                                        PB-I-AH-PREMIUM-AMT
 11126                                        PB-I-AH-BENEFIT-CD
 11127                                        PB-I-AH-PREM-CALC
 11128                                        PB-I-AH-CRIT-PER
 11129               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11130           ELSE
 11131               NEXT SENTENCE
 11132        ELSE
 11133           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 208
* EL6311.cbl
 11134                                    PI-BTYPE (2).
 11135 1360-REWRITE-PB-RECORD.
 11136     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11137
 11138     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11139     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11140
 11141     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11142
 11143     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11144     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11145
 11146     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11147         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11148
 11149     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11150         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11151
 11152     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11153
 11154     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11155
 11156     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11157
 11158     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11159     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11160     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11161
 11162     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11163     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11164
 11165 1375-REWRITE-PB-RECORD.
 11166     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11167     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11168     MOVE 'C'                    TO JP-RECORD-TYPE.
 11169     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11170
 11171
 11172* EXEC CICS REWRITE
 11173*        DATASET (FILE-ID-ERPNDB)
 11174*        FROM    (PENDING-BUSINESS)
 11175*    END-EXEC.
 11176     MOVE LENGTH OF
 11177      PENDING-BUSINESS
 11178       TO DFHEIV11
 11179*    MOVE '&& L                  %   #00010806' TO DFHEIV0
 11180     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11181     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11182     MOVE X'2020233030303130383036' TO DFHEIV0(25:11)
 11183     CALL 'kxdfhei1' USING DFHEIV0,
 11184           FILE-ID-ERPNDB,
 11185           PENDING-BUSINESS,
 11186           DFHEIV11,
 11187           DFHEIV99
 11188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11189
 11190
 11191     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 209
* EL6311.cbl
 11192******************************************************************
 11193*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11194******************************************************************
 11195     display ' made it to update orig cert '
 11196     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11197     MOVE ' '                    TO WS-ERMAIL-SW
 11198
 11199* EXEC CICS READ
 11200*       DATASET   (FILE-ID-ERMAIL)
 11201*       SET       (ADDRESS OF MAILING-DATA)
 11202*       RIDFLD    (ERMAIL-KEY)
 11203*       RESP      (WS-RESPONSE)
 11204*    END-EXEC
 11205*    MOVE '&"S        E          (  N#00010818' TO DFHEIV0
 11206     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11207     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11208     MOVE X'204E233030303130383138' TO DFHEIV0(25:11)
 11209     CALL 'kxdfhei1' USING DFHEIV0,
 11210           FILE-ID-ERMAIL,
 11211           DFHEIV20,
 11212           DFHEIV99,
 11213           ERMAIL-KEY,
 11214           DFHEIV99,
 11215           DFHEIV99,
 11216           DFHEIV99
 11217     SET ADDRESS OF MAILING-DATA TO
 11218         DFHEIV20
 11219     MOVE EIBRESP  TO WS-RESPONSE
 11220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11221     IF RESP-NORMAL
 11222        SET ERMAIL-FOUND TO TRUE
 11223     END-IF
 11224     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11225                                 TO ELCRTO-KEY
 11226     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11227     MOVE +0                     TO ELCRTO-SEQ-NO
 11228
 11229* EXEC CICS READ
 11230*       DATASET   ('ELCRTO')
 11231*       INTO      (ORIGINAL-CERTIFICATE)
 11232*       RIDFLD    (ELCRTO-KEY)
 11233*       GTEQ
 11234*       RESP      (WS-RESPONSE)
 11235*    END-EXEC
 11236     MOVE LENGTH OF
 11237      ORIGINAL-CERTIFICATE
 11238       TO DFHEIV11
 11239     MOVE 'ELCRTO' TO DFHEIV1
 11240*    MOVE '&"IL       G          (  N#00010831' TO DFHEIV0
 11241     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11242     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11243     MOVE X'204E233030303130383331' TO DFHEIV0(25:11)
 11244     CALL 'kxdfhei1' USING DFHEIV0,
 11245           DFHEIV1,
 11246           ORIGINAL-CERTIFICATE,
 11247           DFHEIV11,
 11248           ELCRTO-KEY,
 11249           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 210
* EL6311.cbl
 11250           DFHEIV99,
 11251           DFHEIV99
 11252     MOVE EIBRESP  TO WS-RESPONSE
 11253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11254     display ' just read gteq ' ws-response
 11255     IF RESP-NORMAL
 11256        AND (OC-CONTROL-PRIMARY (1:33) =
 11257                 PB-CONTROL-BY-ACCOUNT (1:33))
 11258        AND (OC-RECORD-TYPE = 'I')
 11259        display ' resp norm, key =, type i '
 11260        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11261           display ' end proc blank '
 11262           display ' csr edit session ' PI-CSR-SESSION-SW
 11263           IF NOT CSR-EDIT-SESSION
 11264
 11265* EXEC CICS READ
 11266*                DATASET   ('ELCRTO')
 11267*                INTO      (ORIGINAL-CERTIFICATE)
 11268*                RIDFLD    (OC-CONTROL-PRIMARY)
 11269*                UPDATE
 11270*                RESP      (WS-RESPONSE)
 11271*             END-EXEC
 11272     MOVE LENGTH OF
 11273      ORIGINAL-CERTIFICATE
 11274       TO DFHEIV11
 11275     MOVE 'ELCRTO' TO DFHEIV1
 11276*    MOVE '&"IL       EU         (  N#00010848' TO DFHEIV0
 11277     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11278     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11279     MOVE X'204E233030303130383438' TO DFHEIV0(25:11)
 11280     CALL 'kxdfhei1' USING DFHEIV0,
 11281           DFHEIV1,
 11282           ORIGINAL-CERTIFICATE,
 11283           DFHEIV11,
 11284           OC-CONTROL-PRIMARY,
 11285           DFHEIV99,
 11286           DFHEIV99,
 11287           DFHEIV99
 11288     MOVE EIBRESP  TO WS-RESPONSE
 11289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11290              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11291              IF RESP-NORMAL
 11292                 display ' good read upd '
 11293                 MOVE PB-I-INSURED-LAST-NAME TO
 11294                         OC-INS-LAST-NAME
 11295                 MOVE PB-I-INSURED-FIRST-NAME TO
 11296                         OC-INS-FIRST-NAME
 11297                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11298                         OC-INS-MIDDLE-INIT
 11299                 MOVE PB-I-AGE         TO OC-INS-AGE
 11300                 MOVE PB-I-JOINT-LAST-NAME   TO
 11301                         OC-JNT-LAST-NAME
 11302                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11303                         OC-JNT-FIRST-NAME
 11304                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11305                         OC-JNT-MIDDLE-INIT
 11306                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11307                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 211
* EL6311.cbl
 11308                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11309                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11310                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11311                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11312                         OC-LF-ALT-BEN-AMT
 11313                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
 11314                         OC-LF-ALT-PRM-AMT
 11315                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11316                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11317                 MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11318                 MOVE +0               TO OC-LF-CANCEL-AMT
 11319                                          OC-LF-ITD-CANCEL-AMT
 11320                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11321                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11322                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11323                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11324                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11325                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11326                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11327                 MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11328                 MOVE +0               TO OC-AH-CANCEL-AMT
 11329                                          OC-AH-ITD-CANCEL-AMT
 11330                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11331                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 11332                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11333                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11334                 IF ERMAIL-FOUND
 11335                    MOVE MA-CRED-BENE-NAME
 11336                                 TO OC-CRED-BENE-NAME
 11337                 END-IF
 11338
 11339* EXEC CICS REWRITE
 11340*                   DATASET   ('ELCRTO')
 11341*                   FROM      (ORIGINAL-CERTIFICATE)
 11342*                   RESP      (WS-RESPONSE)
 11343*                END-EXEC
 11344     MOVE LENGTH OF
 11345      ORIGINAL-CERTIFICATE
 11346       TO DFHEIV11
 11347     MOVE 'ELCRTO' TO DFHEIV1
 11348*    MOVE '&& L                  %  N#00010903' TO DFHEIV0
 11349     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11350     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11351     MOVE X'204E233030303130393033' TO DFHEIV0(25:11)
 11352     CALL 'kxdfhei1' USING DFHEIV0,
 11353           DFHEIV1,
 11354           ORIGINAL-CERTIFICATE,
 11355           DFHEIV11,
 11356           DFHEIV99
 11357     MOVE EIBRESP  TO WS-RESPONSE
 11358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11359                 display ' just rewrote ' ws-response
 11360              END-IF
 11361           END-IF
 11362        ELSE
 11363           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 11364           MOVE 'OC'             TO OC-RECORD-ID
 11365           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 212
* EL6311.cbl
 11366           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 11367           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 11368           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11369           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11370           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11371           MOVE PB-I-AGE         TO OC-INS-AGE
 11372           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11373           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11374           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11375           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11376           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11377           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11378           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11379           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11380           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11381           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11382           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11383           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11384           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 11385           MOVE +0               TO OC-LF-CANCEL-AMT
 11386                                    OC-LF-ITD-CANCEL-AMT
 11387           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11388           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11389           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11390           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11391           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11392           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 11393           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 11394           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 11395           MOVE +0               TO OC-AH-CANCEL-AMT
 11396                                    OC-AH-ITD-CANCEL-AMT
 11397           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 11398           IF ERMAIL-FOUND
 11399              MOVE MA-CRED-BENE-NAME
 11400                                 TO OC-CRED-BENE-NAME
 11401           END-IF
 11402           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 11403
 11404* EXEC CICS WRITE
 11405*             DATASET   ('ELCRTO')
 11406*             FROM      (ORIGINAL-CERTIFICATE)
 11407*             RIDFLD    (OC-CONTROL-PRIMARY)
 11408*             RESP      (WS-RESPONSE)
 11409*          END-EXEC
 11410     MOVE LENGTH OF
 11411      ORIGINAL-CERTIFICATE
 11412       TO DFHEIV11
 11413     MOVE 'ELCRTO' TO DFHEIV1
 11414*    MOVE '&$ L                  ''  N#00010952' TO DFHEIV0
 11415     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11416     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11417     MOVE X'204E233030303130393532' TO DFHEIV0(25:11)
 11418     CALL 'kxdfhei1' USING DFHEIV0,
 11419           DFHEIV1,
 11420           ORIGINAL-CERTIFICATE,
 11421           DFHEIV11,
 11422           OC-CONTROL-PRIMARY,
 11423           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 213
* EL6311.cbl
 11424           DFHEIV99
 11425     MOVE EIBRESP  TO WS-RESPONSE
 11426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11427        END-IF
 11428     ELSE
 11429        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 11430        MOVE 'OC'                TO OC-RECORD-ID
 11431        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11432                                 TO OC-CONTROL-PRIMARY (1:33)
 11433        MOVE 'I'                 TO OC-RECORD-TYPE
 11434        MOVE +4096               TO OC-KEY-SEQ-NO
 11435        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 11436        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 11437        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 11438        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 11439        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 11440        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 11441        MOVE PB-I-AGE            TO OC-INS-AGE
 11442        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 11443        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 11444        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 11445        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 11446        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 11447        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 11448        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11449        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11450        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 11451        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 11452        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 11453        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11454        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 11455        MOVE +0                  TO OC-LF-CANCEL-AMT
 11456                                    OC-LF-ITD-CANCEL-AMT
 11457        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 11458        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 11459        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11460        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11461        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 11462        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 11463        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 11464        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 11465        MOVE +0                  TO OC-AH-CANCEL-AMT
 11466                                    OC-AH-ITD-CANCEL-AMT
 11467        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 11468        IF ERMAIL-FOUND
 11469           MOVE MA-CRED-BENE-NAME
 11470                                 TO OC-CRED-BENE-NAME
 11471        END-IF
 11472        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 11473
 11474* EXEC CICS WRITE
 11475*          DATASET   ('ELCRTO')
 11476*          FROM      (ORIGINAL-CERTIFICATE)
 11477*          RIDFLD    (OC-CONTROL-PRIMARY)
 11478*          RESP      (WS-RESPONSE)
 11479*       END-EXEC
 11480     MOVE LENGTH OF
 11481      ORIGINAL-CERTIFICATE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 214
* EL6311.cbl
 11482       TO DFHEIV11
 11483     MOVE 'ELCRTO' TO DFHEIV1
 11484*    MOVE '&$ L                  ''  N#00011004' TO DFHEIV0
 11485     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11486     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11487     MOVE X'204E233030303131303034' TO DFHEIV0(25:11)
 11488     CALL 'kxdfhei1' USING DFHEIV0,
 11489           DFHEIV1,
 11490           ORIGINAL-CERTIFICATE,
 11491           DFHEIV11,
 11492           OC-CONTROL-PRIMARY,
 11493           DFHEIV99,
 11494           DFHEIV99
 11495     MOVE EIBRESP  TO WS-RESPONSE
 11496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11497     END-IF
 11498******************************************************************
 11499*       U P D A T E   T H E   B A T C H   H E A D E R            *
 11500******************************************************************
 11501
 11502     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 11503     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11504
 11505
 11506* EXEC CICS READ
 11507*        INTO    (PENDING-BUSINESS)
 11508*        DATASET (FILE-ID-ERPNDB)
 11509*        RIDFLD  (ERPNDB-KEY)
 11510*        UPDATE
 11511*    END-EXEC.
 11512     MOVE LENGTH OF
 11513      PENDING-BUSINESS
 11514       TO DFHEIV11
 11515*    MOVE '&"IL       EU         (   #00011018' TO DFHEIV0
 11516     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11517     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11518     MOVE X'2020233030303131303138' TO DFHEIV0(25:11)
 11519     CALL 'kxdfhei1' USING DFHEIV0,
 11520           FILE-ID-ERPNDB,
 11521           PENDING-BUSINESS,
 11522           DFHEIV11,
 11523           ERPNDB-KEY,
 11524           DFHEIV99,
 11525           DFHEIV99,
 11526           DFHEIV99
 11527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11528
 11529
 11530     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 11531     MOVE 'B'                    TO JP-RECORD-TYPE.
 11532     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11533
 11534     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11535
 11536     PERFORM 8400-LOG-JOURNAL-RECORD.
 11537
 11538     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 11539
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 215
* EL6311.cbl
 11540     MOVE 'C'                    TO JP-RECORD-TYPE.
 11541     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11542
 11543
 11544* EXEC CICS REWRITE
 11545*        DATASET    (FILE-ID-ERPNDB)
 11546*        FROM       (PENDING-BUSINESS)
 11547*    END-EXEC.
 11548     MOVE LENGTH OF
 11549      PENDING-BUSINESS
 11550       TO DFHEIV11
 11551*    MOVE '&& L                  %   #00011038' TO DFHEIV0
 11552     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11553     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11554     MOVE X'2020233030303131303338' TO DFHEIV0(25:11)
 11555     CALL 'kxdfhei1' USING DFHEIV0,
 11556           FILE-ID-ERPNDB,
 11557           PENDING-BUSINESS,
 11558           DFHEIV11,
 11559           DFHEIV99
 11560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11561
 11562
 11563     PERFORM 8400-LOG-JOURNAL-RECORD.
 11564
 11565     IF WS-ERRORS-PRESENT
 11566        GO TO 3900-RE-DISPLAY-RECORD.
 11567
 11568     MOVE ZEROS                  TO EMI-ERROR.
 11569     MOVE -1                     TO BMAINTL.
 11570     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11571     GO TO 3900-RE-DISPLAY-RECORD.
 11572
 11573 1380-BATCH-HDR-NOT-FOUND.
 11574     MOVE -1                     TO BMAINTL.
 11575     MOVE ER-7450                TO EMI-ERROR.
 11576     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11577     GO TO 8200-SEND-DATAONLY.
 11578
 11579 1385-REC-NOT-FOUND.
 11580     MOVE -1                     TO BMAINTL.
 11581     MOVE ER-7451                TO EMI-ERROR.
 11582     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11583     GO TO 8200-SEND-DATAONLY.
 11584
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 216
* EL6311.cbl
 11586
 11587 1390-UPDATE-ERPNDM.
 11588
 11589
 11590* EXEC CICS HANDLE CONDITION
 11591*        NOTFND (1399-EXIT)
 11592*    END-EXEC.
 11593*    MOVE '"$I                   ! '' #00011069' TO DFHEIV0
 11594     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11595     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11596     MOVE X'2720233030303131303639' TO DFHEIV0(25:11)
 11597     CALL 'kxdfhei1' USING DFHEIV0
 11598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11599
 11600
 11601     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 11602
 11603
 11604* EXEC CICS READ
 11605*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 11606*        DATASET (FILE-ID-ERPNDM)
 11607*        RIDFLD  (ERPNDM-KEY)
 11608*        UPDATE
 11609*    END-EXEC.
 11610*    MOVE '&"S        EU         (   #00011075' TO DFHEIV0
 11611     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11612     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11613     MOVE X'2020233030303131303735' TO DFHEIV0(25:11)
 11614     CALL 'kxdfhei1' USING DFHEIV0,
 11615           FILE-ID-ERPNDM,
 11616           DFHEIV20,
 11617           DFHEIV99,
 11618           ERPNDM-KEY,
 11619           DFHEIV99,
 11620           DFHEIV99,
 11621           DFHEIV99
 11622     SET ADDRESS OF PENDING-MAILING-DATA TO
 11623         DFHEIV20
 11624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11625
 11626
 11627     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 11628     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 11629     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 11630
 11631     IF BLSTNML GREATER THAN ZEROS
 11632         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 11633
 11634     IF B1STNML GREATER  THAN ZEROS
 11635         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
 11636
 11637     IF BINITL GREATER THAN ZEROS
 11638         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 11639
 11640     IF BAGEL GREATER THAN ZEROS
 11641         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 11642
 11643     IF BBIRTHL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 217
* EL6311.cbl
 11644         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 11645
 11646     IF BSEXL GREATER THAN ZEROS
 11647         MOVE  BSEXI             TO PM-INSURED-SEX.
 11648
 11649
 11650* EXEC CICS REWRITE
 11651*        DATASET (FILE-ID-ERPNDM)
 11652*        FROM    (PENDING-MAILING-DATA)
 11653*    END-EXEC.
 11654     MOVE LENGTH OF
 11655      PENDING-MAILING-DATA
 11656       TO DFHEIV11
 11657*    MOVE '&& L                  %   #00011104' TO DFHEIV0
 11658     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11659     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11660     MOVE X'2020233030303131313034' TO DFHEIV0(25:11)
 11661     CALL 'kxdfhei1' USING DFHEIV0,
 11662           FILE-ID-ERPNDM,
 11663           PENDING-MAILING-DATA,
 11664           DFHEIV11,
 11665           DFHEIV99
 11666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11667
 11668
 11669 1399-EXIT.
 11670     EXIT.
 11671
 11672******************************************************************
 11673*                                                                *
 11674*          D E L E T E   I S S U E   R O U T I N E               *
 11675*                                                                *
 11676******************************************************************
 11677
 11678 1400-DELETE-ISSUE-ROUTINE.
 11679     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 11680
 11681     IF BCHGL NOT = ZEROS
 11682        MOVE ER-2196             TO EMI-ERROR
 11683        MOVE AL-UABON            TO BMAINTA
 11684        MOVE -1                  TO BMAINTL
 11685        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11686        GO TO 8200-SEND-DATAONLY.
 11687
 11688
 11689* EXEC CICS HANDLE CONDITION
 11690*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 11691*    END-EXEC.
 11692*    MOVE '"$I                   ! ( #00011128' TO DFHEIV0
 11693     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11695     MOVE X'2820233030303131313238' TO DFHEIV0(25:11)
 11696     CALL 'kxdfhei1' USING DFHEIV0
 11697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11698
 11699
 11700     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11701     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 218
* EL6311.cbl
 11702     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 11703
 11704
 11705* EXEC CICS READ
 11706*        SET     (ADDRESS OF PENDING-BUSINESS)
 11707*        DATASET (FILE-ID-ERPNDB)
 11708*        RIDFLD  (ERPNDB-KEY)
 11709*    END-EXEC.
 11710*    MOVE '&"S        E          (   #00011136' TO DFHEIV0
 11711     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11712     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11713     MOVE X'2020233030303131313336' TO DFHEIV0(25:11)
 11714     CALL 'kxdfhei1' USING DFHEIV0,
 11715           FILE-ID-ERPNDB,
 11716           DFHEIV20,
 11717           DFHEIV99,
 11718           ERPNDB-KEY,
 11719           DFHEIV99,
 11720           DFHEIV99,
 11721           DFHEIV99
 11722     SET ADDRESS OF PENDING-BUSINESS TO
 11723         DFHEIV20
 11724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11725
 11726
 11727     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11728
 11729     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11730
 11731     IF BSUFIXL NOT = ZEROS
 11732        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11733     ELSE
 11734        MOVE SPACE               TO WS-NEW-SUFFIX.
 11735
 11736     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11737     PERFORM 8600-DEEDIT.
 11738     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11739     MOVE '4'                    TO DC-OPTION-CODE.
 11740     PERFORM 9700-DATE-LINK.
 11741     IF DATE-CONVERSION-ERROR
 11742        MOVE ER-0348             TO EMI-ERROR
 11743        MOVE -1                  TO BEFFDTL
 11744        MOVE AL-UABON            TO BEFFDTA
 11745        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11746        GO TO 8200-SEND-DATAONLY
 11747     ELSE
 11748        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11749        MOVE AL-UANON            TO BEFFDTA
 11750        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11751
 11752
 11753* EXEC CICS HANDLE CONDITION
 11754*         NOTFND    (1490-RECORD-NOT-FOUND)
 11755*    END-EXEC.
 11756*    MOVE '"$I                   ! ) #00011167' TO DFHEIV0
 11757     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11758     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11759     MOVE X'2920233030303131313637' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 219
* EL6311.cbl
 11760     CALL 'kxdfhei1' USING DFHEIV0
 11761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11762
 11763
 11764
 11765* EXEC CICS READ
 11766*        SET     (ADDRESS OF PENDING-BUSINESS)
 11767*        DATASET (FILE-ID-ERPNDB)
 11768*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11769*        UPDATE
 11770*    END-EXEC.
 11771*    MOVE '&"S        EU         (   #00011171' TO DFHEIV0
 11772     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11773     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11774     MOVE X'2020233030303131313731' TO DFHEIV0(25:11)
 11775     CALL 'kxdfhei1' USING DFHEIV0,
 11776           FILE-ID-ERPNDB,
 11777           DFHEIV20,
 11778           DFHEIV99,
 11779           PI-PREV-CONTROL-PRIMARY,
 11780           DFHEIV99,
 11781           DFHEIV99,
 11782           DFHEIV99
 11783     SET ADDRESS OF PENDING-BUSINESS TO
 11784         DFHEIV20
 11785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11786
 11787
 11788     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11789        MOVE -1                 TO BMAINTL
 11790        MOVE ER-2197            TO EMI-ERROR
 11791        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11792        GO TO 8200-SEND-DATAONLY.
 11793
 11794     IF PB-BILLED-DT NOT = LOW-VALUES
 11795        MOVE -1                 TO BMAINTL
 11796        MOVE ER-2129            TO EMI-ERROR
 11797        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11798        GO TO 8200-SEND-DATAONLY.
 11799
 11800     IF PB-CHG-COUNT NOT = ZEROS
 11801        MOVE ER-2336            TO EMI-ERROR
 11802        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11803        MOVE AL-UABON            TO BMAINTA
 11804        MOVE -1                  TO BMAINTL
 11805        GO TO 8200-SEND-DATAONLY.
 11806
 11807     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 11808        PB-CHG-COUNT NOT = ZEROS
 11809        MOVE ER-2196             TO EMI-ERROR
 11810        MOVE AL-UABON            TO BMAINTA
 11811        MOVE -1                  TO BMAINTL
 11812        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11813        GO TO 8200-SEND-DATAONLY.
 11814******************************************************************
 11815*                                                                *
 11816*       DELETE ORIGINAL CERTIFICATE INFO                         *
 11817*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 220
* EL6311.cbl
 11818******************************************************************
 11819     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 11820     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11821     MOVE +0                     TO ELCRTO-SEQ-NO
 11822
 11823* EXEC CICS READ
 11824*       DATASET   ('ELCRTO')
 11825*       INTO      (ORIGINAL-CERTIFICATE)
 11826*       RIDFLD    (ELCRTO-KEY)
 11827*       GTEQ
 11828*       RESP      (WS-RESPONSE)
 11829*    END-EXEC
 11830     MOVE LENGTH OF
 11831      ORIGINAL-CERTIFICATE
 11832       TO DFHEIV11
 11833     MOVE 'ELCRTO' TO DFHEIV1
 11834*    MOVE '&"IL       G          (  N#00011212' TO DFHEIV0
 11835     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11836     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11837     MOVE X'204E233030303131323132' TO DFHEIV0(25:11)
 11838     CALL 'kxdfhei1' USING DFHEIV0,
 11839           DFHEIV1,
 11840           ORIGINAL-CERTIFICATE,
 11841           DFHEIV11,
 11842           ELCRTO-KEY,
 11843           DFHEIV99,
 11844           DFHEIV99,
 11845           DFHEIV99
 11846     MOVE EIBRESP  TO WS-RESPONSE
 11847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11848     IF RESP-NORMAL
 11849        AND (OC-CONTROL-PRIMARY (1:33) =
 11850                 PB-CONTROL-BY-ACCOUNT (1:33))
 11851        AND (OC-RECORD-TYPE = 'I')
 11852
 11853* EXEC CICS READ
 11854*          DATASET   ('ELCRTO')
 11855*          INTO      (ORIGINAL-CERTIFICATE)
 11856*          RIDFLD    (ELCRTO-KEY)
 11857*          UPDATE
 11858*          RESP      (WS-RESPONSE)
 11859*       END-EXEC
 11860     MOVE LENGTH OF
 11861      ORIGINAL-CERTIFICATE
 11862       TO DFHEIV11
 11863     MOVE 'ELCRTO' TO DFHEIV1
 11864*    MOVE '&"IL       EU         (  N#00011223' TO DFHEIV0
 11865     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11866     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11867     MOVE X'204E233030303131323233' TO DFHEIV0(25:11)
 11868     CALL 'kxdfhei1' USING DFHEIV0,
 11869           DFHEIV1,
 11870           ORIGINAL-CERTIFICATE,
 11871           DFHEIV11,
 11872           ELCRTO-KEY,
 11873           DFHEIV99,
 11874           DFHEIV99,
 11875           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 221
* EL6311.cbl
 11876     MOVE EIBRESP  TO WS-RESPONSE
 11877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11878        IF RESP-NORMAL
 11879
 11880* EXEC CICS DELETE
 11881*             DATASET   ('ELCRTO')
 11882*          END-EXEC
 11883     MOVE 'ELCRTO' TO DFHEIV1
 11884*    MOVE '&(                    &   #00011231' TO DFHEIV0
 11885     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11886     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11887     MOVE X'2020233030303131323331' TO DFHEIV0(25:11)
 11888     CALL 'kxdfhei1' USING DFHEIV0,
 11889           DFHEIV1,
 11890           DFHEIV99,
 11891           DFHEIV99,
 11892           DFHEIV99,
 11893           DFHEIV99
 11894     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11895        END-IF
 11896     END-IF
 11897******************************************************************
 11898*                                                                *
 11899*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 11900*                                                                *
 11901******************************************************************
 11902
 11903* EXEC CICS HANDLE CONDITION
 11904*        NOTFND    (1405-DELETE-CERTIFICATE)
 11905*    END-EXEC.
 11906*    MOVE '"$I                   ! * #00011241' TO DFHEIV0
 11907     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11908     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11909     MOVE X'2A20233030303131323431' TO DFHEIV0(25:11)
 11910     CALL 'kxdfhei1' USING DFHEIV0
 11911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11912
 11913
 11914
 11915* EXEC CICS READ
 11916*        EQUAL
 11917*        DATASET   (FILE-ID-ERPNDM)
 11918*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 11919*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 11920*        UPDATE
 11921*    END-EXEC.
 11922*    MOVE '&"S        EU         (   #00011245' TO DFHEIV0
 11923     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11924     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11925     MOVE X'2020233030303131323435' TO DFHEIV0(25:11)
 11926     CALL 'kxdfhei1' USING DFHEIV0,
 11927           FILE-ID-ERPNDM,
 11928           DFHEIV20,
 11929           DFHEIV99,
 11930           PI-PREV-CONTROL-PRIMARY,
 11931           DFHEIV99,
 11932           DFHEIV99,
 11933           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 222
* EL6311.cbl
 11934     SET ADDRESS OF PENDING-MAILING-DATA TO
 11935         DFHEIV20
 11936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11937
 11938
 11939     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 11940     MOVE 'D'                    TO  JP-RECORD-TYPE.
 11941     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 11942
 11943     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11944
 11945
 11946* EXEC CICS DELETE
 11947*        DATASET   (FILE-ID-ERPNDM)
 11948*    END-EXEC.
 11949*    MOVE '&(                    &   #00011259' TO DFHEIV0
 11950     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 11951     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11952     MOVE X'2020233030303131323539' TO DFHEIV0(25:11)
 11953     CALL 'kxdfhei1' USING DFHEIV0,
 11954           FILE-ID-ERPNDM,
 11955           DFHEIV99,
 11956           DFHEIV99,
 11957           DFHEIV99,
 11958           DFHEIV99
 11959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11960
 11961
 11962******************************************************************
 11963*                PROCESS   CERTIFICATE                           *
 11964******************************************************************
 11965
 11966 1405-DELETE-CERTIFICATE.
 11967
 11968* EXEC CICS HANDLE CONDITION
 11969*         NOTFND  (1420-CONTINUE-DELETE)
 11970*    END-EXEC.
 11971*    MOVE '"$I                   ! + #00011268' TO DFHEIV0
 11972     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11973     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11974     MOVE X'2B20233030303131323638' TO DFHEIV0(25:11)
 11975     CALL 'kxdfhei1' USING DFHEIV0
 11976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11977
 11978
 11979     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 11980     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 11981     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 11982     MOVE PB-SV-STATE            TO ELCERT-STATE.
 11983
 11984
 11985* EXEC CICS READ
 11986*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 11987*        DATASET (FILE-ID-ELCERT)
 11988*        RIDFLD  (ELCERT-KEY)
 11989*        UPDATE
 11990*    END-EXEC.
 11991*    MOVE '&"S        EU         (   #00011277' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 223
* EL6311.cbl
 11992     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11993     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11994     MOVE X'2020233030303131323737' TO DFHEIV0(25:11)
 11995     CALL 'kxdfhei1' USING DFHEIV0,
 11996           FILE-ID-ELCERT,
 11997           DFHEIV20,
 11998           DFHEIV99,
 11999           ELCERT-KEY,
 12000           DFHEIV99,
 12001           DFHEIV99,
 12002           DFHEIV99
 12003     SET ADDRESS OF CERTIFICATE-MASTER TO
 12004         DFHEIV20
 12005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12006
 12007
 12008     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12009
 12010     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12011     MOVE 'B'                    TO JP-RECORD-TYPE
 12012     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12013
 12014     PERFORM 8400-LOG-JOURNAL-RECORD.
 12015
 12016     IF CERT-NOTES-ARE-NOT-PRESENT
 12017        MOVE ' '                 TO WS-CERT-NOTE-SW
 12018     ELSE
 12019        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12020
 12021     IF INSURED-ADDR-PRESENT
 12022        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12023
 12024******************************************************************
 12025******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12026******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12027******************************************************************
 12028******************************************************************
 12029
 12030     IF CERT-ADDED-BATCH AND
 12031        (NOT NO-CLAIM-ATTACHED
 12032         OR
 12033         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12034        GO TO 1410-REWRITE-CERT.
 12035
 12036******************************************************************
 12037******************************************************************
 12038
 12039     IF CERT-ADDED-BATCH  AND
 12040        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12041        GO TO 1410-REWRITE-CERT.
 12042
 12043     IF NO-CLAIM-ATTACHED
 12044        NEXT SENTENCE
 12045     ELSE
 12046        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12047        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12048        GO TO 1410-REWRITE-CERT.
 12049
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 224
* EL6311.cbl
 12050     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12051     MOVE 'D'                      TO JP-RECORD-TYPE.
 12052     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12053
 12054
 12055* EXEC CICS DELETE
 12056*         DATASET    (FILE-ID-ELCERT)
 12057*    END-EXEC.
 12058*    MOVE '&(                    &   #00011330' TO DFHEIV0
 12059     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12060     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12061     MOVE X'2020233030303131333330' TO DFHEIV0(25:11)
 12062     CALL 'kxdfhei1' USING DFHEIV0,
 12063           FILE-ID-ELCERT,
 12064           DFHEIV99,
 12065           DFHEIV99,
 12066           DFHEIV99,
 12067           DFHEIV99
 12068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12069
 12070
 12071     PERFORM 8400-LOG-JOURNAL-RECORD.
 12072
 12073******************************************************************
 12074*                                                                *
 12075*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12076*                                                                *
 12077******************************************************************
 12078
 12079     IF  CERT-NOTES-ARE-PRESENT
 12080         NEXT SENTENCE
 12081     ELSE
 12082         GO TO 1407-DELETE-MAILING.
 12083
 12084
 12085* EXEC CICS HANDLE CONDITION
 12086*         NOTFND  (1406-DELETE-ERNOTE)
 12087*    END-EXEC.
 12088*    MOVE '"$I                   ! , #00011347' TO DFHEIV0
 12089     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12090     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12091     MOVE X'2C20233030303131333437' TO DFHEIV0(25:11)
 12092     CALL 'kxdfhei1' USING DFHEIV0
 12093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12094
 12095
 12096     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12097     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12098     MOVE 0                     TO ERCNOT-SEQUENCE.
 12099
 12100 1406-DELETE-ERCNOT-LOOP.
 12101
 12102
 12103* EXEC CICS READ
 12104*        GTEQ
 12105*        DATASET   (FILE-ID-ERCNOT)
 12106*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12107*        RIDFLD    (ERCNOT-KEY)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 225
* EL6311.cbl
 12108*    END-EXEC.
 12109*    MOVE '&"S        G          (   #00011357' TO DFHEIV0
 12110     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12111     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12112     MOVE X'2020233030303131333537' TO DFHEIV0(25:11)
 12113     CALL 'kxdfhei1' USING DFHEIV0,
 12114           FILE-ID-ERCNOT,
 12115           DFHEIV20,
 12116           DFHEIV99,
 12117           ERCNOT-KEY,
 12118           DFHEIV99,
 12119           DFHEIV99,
 12120           DFHEIV99
 12121     SET ADDRESS OF CERT-NOTE-FILE TO
 12122         DFHEIV20
 12123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12124
 12125
 12126     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12127     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12128         GO TO 1406-DELETE-ERNOTE
 12129     END-IF.
 12130
 12131     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12132     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12133     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12134
 12135     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12136
 12137
 12138* EXEC CICS DELETE
 12139*        DATASET   (FILE-ID-ERCNOT)
 12140*        RIDFLD    (ERCNOT-KEY)
 12141*        END-EXEC.
 12142*    MOVE '&(  R                 &   #00011375' TO DFHEIV0
 12143     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12144     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12145     MOVE X'2020233030303131333735' TO DFHEIV0(25:11)
 12146     CALL 'kxdfhei1' USING DFHEIV0,
 12147           FILE-ID-ERCNOT,
 12148           ERCNOT-KEY,
 12149           DFHEIV99,
 12150           DFHEIV99,
 12151           DFHEIV99
 12152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12153
 12154
 12155     PERFORM 8400-LOG-JOURNAL-RECORD.
 12156
 12157     GO TO 1406-DELETE-ERCNOT-LOOP.
 12158
 12159 1406-DELETE-ERNOTE.
 12160
 12161
 12162* EXEC CICS HANDLE CONDITION
 12163*         NOTFND  (1407-DELETE-MAILING)
 12164*    END-EXEC.
 12165*    MOVE '"$I                   ! - #00011386' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 226
* EL6311.cbl
 12166     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12167     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12168     MOVE X'2D20233030303131333836' TO DFHEIV0(25:11)
 12169     CALL 'kxdfhei1' USING DFHEIV0
 12170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12171
 12172
 12173
 12174* EXEC CICS READ
 12175*        EQUAL
 12176*        DATASET   (FILE-ID-ERNOTE)
 12177*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 12178*        RIDFLD    (ELCERT-KEY)
 12179*        UPDATE
 12180*    END-EXEC.
 12181*    MOVE '&"S        EU         (   #00011390' TO DFHEIV0
 12182     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12183     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12184     MOVE X'2020233030303131333930' TO DFHEIV0(25:11)
 12185     CALL 'kxdfhei1' USING DFHEIV0,
 12186           FILE-ID-ERNOTE,
 12187           DFHEIV20,
 12188           DFHEIV99,
 12189           ELCERT-KEY,
 12190           DFHEIV99,
 12191           DFHEIV99,
 12192           DFHEIV99
 12193     SET ADDRESS OF CERTIFICATE-NOTE TO
 12194         DFHEIV20
 12195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12196
 12197
 12198     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
 12199     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12200     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 12201
 12202     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12203
 12204
 12205* EXEC CICS DELETE
 12206*        DATASET   (FILE-ID-ERNOTE)
 12207*        END-EXEC.
 12208*    MOVE '&(                    &   #00011404' TO DFHEIV0
 12209     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12210     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12211     MOVE X'2020233030303131343034' TO DFHEIV0(25:11)
 12212     CALL 'kxdfhei1' USING DFHEIV0,
 12213           FILE-ID-ERNOTE,
 12214           DFHEIV99,
 12215           DFHEIV99,
 12216           DFHEIV99,
 12217           DFHEIV99
 12218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12219
 12220
 12221     PERFORM 8400-LOG-JOURNAL-RECORD.
 12222
 12223******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 227
* EL6311.cbl
 12224*                                                                *
 12225*                DELETE MAILING ADDRESS RECORDS                  *
 12226*                                                                *
 12227******************************************************************
 12228
 12229 1407-DELETE-MAILING.
 12230     IF CERT-ADDRESS-PRESENT
 12231        NEXT SENTENCE
 12232     ELSE
 12233        GO TO 1420-CONTINUE-DELETE.
 12234
 12235
 12236* EXEC CICS HANDLE CONDITION
 12237*         NOTFND  (1420-CONTINUE-DELETE)
 12238*    END-EXEC.
 12239*    MOVE '"$I                   ! . #00011422' TO DFHEIV0
 12240     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12242     MOVE X'2E20233030303131343232' TO DFHEIV0(25:11)
 12243     CALL 'kxdfhei1' USING DFHEIV0
 12244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12245
 12246
 12247
 12248* EXEC CICS READ
 12249*        EQUAL
 12250*        DATASET   (FILE-ID-ERMAIL)
 12251*        SET       (ADDRESS OF MAILING-DATA)
 12252*        RIDFLD    (ELCERT-KEY)
 12253*        UPDATE
 12254*    END-EXEC.
 12255*    MOVE '&"S        EU         (   #00011426' TO DFHEIV0
 12256     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12257     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12258     MOVE X'2020233030303131343236' TO DFHEIV0(25:11)
 12259     CALL 'kxdfhei1' USING DFHEIV0,
 12260           FILE-ID-ERMAIL,
 12261           DFHEIV20,
 12262           DFHEIV99,
 12263           ELCERT-KEY,
 12264           DFHEIV99,
 12265           DFHEIV99,
 12266           DFHEIV99
 12267     SET ADDRESS OF MAILING-DATA TO
 12268         DFHEIV20
 12269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12270
 12271
 12272     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 12273     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12274     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 12275
 12276     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12277
 12278
 12279* EXEC CICS DELETE
 12280*        DATASET   (FILE-ID-ERMAIL)
 12281*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 228
* EL6311.cbl
 12282*    MOVE '&(                    &   #00011440' TO DFHEIV0
 12283     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12284     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12285     MOVE X'2020233030303131343430' TO DFHEIV0(25:11)
 12286     CALL 'kxdfhei1' USING DFHEIV0,
 12287           FILE-ID-ERMAIL,
 12288           DFHEIV99,
 12289           DFHEIV99,
 12290           DFHEIV99,
 12291           DFHEIV99
 12292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12293
 12294
 12295     GO TO 1420-CONTINUE-DELETE.
 12296
 12297 1410-REWRITE-CERT.
 12298     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12299     MOVE 'C'                      TO JP-RECORD-TYPE.
 12300     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12301     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12302
 12303
 12304* EXEC CICS REWRITE
 12305*         DATASET    (FILE-ID-ELCERT)
 12306*         FROM       (CERTIFICATE-MASTER)
 12307*         END-EXEC.
 12308     MOVE LENGTH OF
 12309      CERTIFICATE-MASTER
 12310       TO DFHEIV11
 12311*    MOVE '&& L                  %   #00011452' TO DFHEIV0
 12312     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12313     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12314     MOVE X'2020233030303131343532' TO DFHEIV0(25:11)
 12315     CALL 'kxdfhei1' USING DFHEIV0,
 12316           FILE-ID-ELCERT,
 12317           CERTIFICATE-MASTER,
 12318           DFHEIV11,
 12319           DFHEIV99
 12320     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12321
 12322
 12323     PERFORM 8400-LOG-JOURNAL-RECORD.
 12324
 12325 1420-CONTINUE-DELETE.
 12326     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 12327     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 12328
 12329     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 12330     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 12331
 12332     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 12333
 12334 1450-DELETE-PB-RECORD.
 12335     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 12336     MOVE 'D'                      TO JP-RECORD-TYPE
 12337     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 12338
 12339
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 229
* EL6311.cbl
 12340* EXEC CICS DELETE
 12341*        DATASET    (FILE-ID-ERPNDB)
 12342*    END-EXEC.
 12343*    MOVE '&(                    &   #00011473' TO DFHEIV0
 12344     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12345     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12346     MOVE X'2020233030303131343733' TO DFHEIV0(25:11)
 12347     CALL 'kxdfhei1' USING DFHEIV0,
 12348           FILE-ID-ERPNDB,
 12349           DFHEIV99,
 12350           DFHEIV99,
 12351           DFHEIV99,
 12352           DFHEIV99
 12353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12354
 12355
 12356     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12357
 12358     PERFORM 8400-LOG-JOURNAL-RECORD.
 12359
 12360     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12361     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12362     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12363
 12364
 12365* EXEC CICS HANDLE CONDITION
 12366*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12367*    END-EXEC.
 12368*    MOVE '"$I                   ! / #00011485' TO DFHEIV0
 12369     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12370     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12371     MOVE X'2F20233030303131343835' TO DFHEIV0(25:11)
 12372     CALL 'kxdfhei1' USING DFHEIV0
 12373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12374
 12375
 12376
 12377* EXEC CICS READ
 12378*        SET     (ADDRESS OF PENDING-BUSINESS)
 12379*        DATASET (FILE-ID-ERPNDB)
 12380*        RIDFLD  (ERPNDB-KEY)
 12381*        UPDATE
 12382*    END-EXEC.
 12383*    MOVE '&"S        EU         (   #00011489' TO DFHEIV0
 12384     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12385     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12386     MOVE X'2020233030303131343839' TO DFHEIV0(25:11)
 12387     CALL 'kxdfhei1' USING DFHEIV0,
 12388           FILE-ID-ERPNDB,
 12389           DFHEIV20,
 12390           DFHEIV99,
 12391           ERPNDB-KEY,
 12392           DFHEIV99,
 12393           DFHEIV99,
 12394           DFHEIV99
 12395     SET ADDRESS OF PENDING-BUSINESS TO
 12396         DFHEIV20
 12397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 230
* EL6311.cbl
 12398
 12399
 12400     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12401
 12402     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 12403
 12404     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12405        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12406        MOVE 'D'                   TO JP-RECORD-TYPE
 12407        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 12408
 12409* EXEC CICS DELETE
 12410*            DATASET    (FILE-ID-ERPNDB)
 12411*       END-EXEC
 12412*    MOVE '&(                    &   #00011504' TO DFHEIV0
 12413     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12414     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12415     MOVE X'2020233030303131353034' TO DFHEIV0(25:11)
 12416     CALL 'kxdfhei1' USING DFHEIV0,
 12417           FILE-ID-ERPNDB,
 12418           DFHEIV99,
 12419           DFHEIV99,
 12420           DFHEIV99,
 12421           DFHEIV99
 12422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12423        PERFORM 8400-LOG-JOURNAL-RECORD
 12424     ELSE
 12425        MOVE 'B'                 TO JP-RECORD-TYPE
 12426        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12427        PERFORM 8400-LOG-JOURNAL-RECORD
 12428        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 12429        MOVE 'C'                 TO JP-RECORD-TYPE
 12430        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 12431
 12432* EXEC CICS REWRITE
 12433*            DATASET    (FILE-ID-ERPNDB)
 12434*            FROM       (PENDING-BUSINESS)
 12435*       END-EXEC
 12436     MOVE LENGTH OF
 12437      PENDING-BUSINESS
 12438       TO DFHEIV11
 12439*    MOVE '&& L                  %   #00011515' TO DFHEIV0
 12440     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12441     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12442     MOVE X'2020233030303131353135' TO DFHEIV0(25:11)
 12443     CALL 'kxdfhei1' USING DFHEIV0,
 12444           FILE-ID-ERPNDB,
 12445           PENDING-BUSINESS,
 12446           DFHEIV11,
 12447           DFHEIV99
 12448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12449        PERFORM 8400-LOG-JOURNAL-RECORD.
 12450
 12451******************************************************************
 12452*                                                                *
 12453*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 12454*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 12455*                                                                *
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 231
* EL6311.cbl
 12456******************************************************************
 12457
 12458     IF NOT PI-AR-PROCESSING
 12459        GO TO 1475-DELETE-FINISHED.
 12460
 12461     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 12462        WS-B-CANCEL-CNT-ENTERED = ZEROS
 12463        NEXT SENTENCE
 12464     ELSE
 12465        GO TO 1475-DELETE-FINISHED.
 12466
 12467
 12468* EXEC CICS HANDLE CONDITION
 12469*         NOTFND    (1475-DELETE-FINISHED)
 12470*         END-EXEC.
 12471*    MOVE '"$I                   ! 0 #00011537' TO DFHEIV0
 12472     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12474     MOVE X'3020233030303131353337' TO DFHEIV0(25:11)
 12475     CALL 'kxdfhei1' USING DFHEIV0
 12476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12477
 12478
 12479     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 12480     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 12481
 12482
 12483* EXEC CICS READ
 12484*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 12485*        DATASET (FILE-ID-ERRQST)
 12486*        RIDFLD  (ERRQST-KEY)
 12487*        UPDATE
 12488*    END-EXEC.
 12489*    MOVE '&"S        EU         (   #00011544' TO DFHEIV0
 12490     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12491     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12492     MOVE X'2020233030303131353434' TO DFHEIV0(25:11)
 12493     CALL 'kxdfhei1' USING DFHEIV0,
 12494           FILE-ID-ERRQST,
 12495           DFHEIV20,
 12496           DFHEIV99,
 12497           ERRQST-KEY,
 12498           DFHEIV99,
 12499           DFHEIV99,
 12500           DFHEIV99
 12501     SET ADDRESS OF AR-REQUEST-RECORD TO
 12502         DFHEIV20
 12503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12504
 12505
 12506     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 12507
 12508     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 12509
 12510     MOVE 'D'                      TO JP-RECORD-TYPE.
 12511     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 12512
 12513
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 232
* EL6311.cbl
 12514* EXEC CICS DELETE
 12515*         DATASET    (FILE-ID-ERRQST)
 12516*    END-EXEC.
 12517*    MOVE '&(                    &   #00011558' TO DFHEIV0
 12518     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12519     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12520     MOVE X'2020233030303131353538' TO DFHEIV0(25:11)
 12521     CALL 'kxdfhei1' USING DFHEIV0,
 12522           FILE-ID-ERRQST,
 12523           DFHEIV99,
 12524           DFHEIV99,
 12525           DFHEIV99,
 12526           DFHEIV99
 12527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12528
 12529
 12530     PERFORM 8400-LOG-JOURNAL-RECORD.
 12531
 12532 1475-DELETE-FINISHED.
 12533     MOVE ZEROS                  TO EMI-ERROR.
 12534     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12535     MOVE LOW-VALUES             TO EL631BI.
 12536     MOVE -1                     TO BMAINTL.
 12537     GO TO 8100-SEND-INITIAL-MAP.
 12538
 12539 1480-BATCH-HDR-NOT-FOUND.
 12540     MOVE -1                     TO BMAINTL.
 12541     MOVE ER-7450                TO EMI-ERROR.
 12542     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12543     GO TO 8200-SEND-DATAONLY.
 12544
 12545 1490-RECORD-NOT-FOUND.
 12546     MOVE -1                     TO BMAINTL.
 12547     MOVE ER-7451                TO EMI-ERROR.
 12548     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12549     GO TO 8200-SEND-DATAONLY.
 12550
 12551******************************************************************
 12552*            O V E R   C H A R G E   P R O C E S S I N G         *
 12553******************************************************************
 12554 1500-UPDATE-ERNOTE.
 12555     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 12556     MOVE 'A'                    TO WS-NOTE-SW
 12557     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 12558     .
 12559 1500-EXIT.
 12560     EXIT.
 12561 1510-ADD-ERNOTE-REC.
 12562
 12563* EXEC CICS GETMAIN
 12564*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 12565*        LENGTH  (ERNOTE-RECORD-LENGTH)
 12566*        INITIMG (GETMAIN-SPACE)
 12567*    END-EXEC
 12568*    MOVE ',"IL                  $   #00011594' TO DFHEIV0
 12569     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12570     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12571     MOVE X'2020233030303131353934' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 233
* EL6311.cbl
 12572     CALL 'kxdfhei1' USING DFHEIV0,
 12573           DFHEIV20,
 12574           ERNOTE-RECORD-LENGTH,
 12575           GETMAIN-SPACE
 12576     SET ADDRESS OF CERTIFICATE-NOTE TO
 12577         DFHEIV20
 12578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12579     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12580                                 TO ERNOTE-KEY
 12581
 12582* EXEC CICS READ
 12583*       DATASET    (FILE-ID-ERNOTE)
 12584*       RIDFLD     (ERNOTE-KEY)
 12585*       INTO       (CERTIFICATE-NOTE)
 12586*       RESP       (WS-RESPONSE)
 12587*       UPDATE
 12588*    END-EXEC
 12589     MOVE LENGTH OF
 12590      CERTIFICATE-NOTE
 12591       TO DFHEIV11
 12592*    MOVE '&"IL       EU         (  N#00011601' TO DFHEIV0
 12593     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12594     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12595     MOVE X'204E233030303131363031' TO DFHEIV0(25:11)
 12596     CALL 'kxdfhei1' USING DFHEIV0,
 12597           FILE-ID-ERNOTE,
 12598           CERTIFICATE-NOTE,
 12599           DFHEIV11,
 12600           ERNOTE-KEY,
 12601           DFHEIV99,
 12602           DFHEIV99,
 12603           DFHEIV99
 12604     MOVE EIBRESP  TO WS-RESPONSE
 12605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12606     IF RESP-NORMAL
 12607        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 12608           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 12609        END-IF
 12610        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 12611           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 12612        END-IF
 12613        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 12614           (N1 > +10)
 12615           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 12616           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 12617        END-PERFORM
 12618        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 12619          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 12620
 12621* EXEC CICS UNLOCK
 12622*            DATASET    (FILE-ID-ERNOTE)
 12623*          END-EXEC
 12624*    MOVE '&*                    #   #00011622' TO DFHEIV0
 12625     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12626     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12627     MOVE X'2020233030303131363232' TO DFHEIV0(25:11)
 12628     CALL 'kxdfhei1' USING DFHEIV0,
 12629           FILE-ID-ERNOTE,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 234
* EL6311.cbl
 12630           DFHEIV99
 12631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12632        ELSE
 12633          PERFORM VARYING N1 FROM +1 BY +1
 12634           UNTIL (N1 > +10)
 12635           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 12636          END-PERFORM
 12637          IF (N1 < +11)
 12638            IF N1 >= CN-BILLING-START-LINE-NO AND
 12639              N1 <= CN-BILLING-END-LINE-NO
 12640              IF PI-COMPANY-ID = 'DCC'
 12641                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 12642              ELSE
 12643                 MOVE WS-VA-NO-COMM-MESS
 12644                                    TO CN-LINE (N1)
 12645              END-IF
 12646            ELSE
 12647              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 12648               (N1 = (CN-BILLING-END-LINE-NO + +1))
 12649                IF PI-COMPANY-ID = 'DCC'
 12650                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 12651                ELSE
 12652                  MOVE WS-VA-NO-COMM-MESS
 12653                                    TO CN-LINE (N1)
 12654                END-IF
 12655                MOVE N1             TO CN-BILLING-END-LINE-NO
 12656              ELSE
 12657                IF (CN-BILLING-END-LINE-NO = ZEROS)
 12658                  IF PI-COMPANY-ID = 'DCC'
 12659                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 12660                  ELSE
 12661                     MOVE WS-VA-NO-COMM-MESS
 12662                                    TO CN-LINE (N1)
 12663                  END-IF
 12664                  MOVE N1            TO CN-BILLING-END-LINE-NO
 12665                                      CN-BILLING-START-LINE-NO
 12666                ELSE
 12667                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 12668                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 12669                     IF PI-COMPANY-ID = 'DCC'
 12670                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 12671                     ELSE
 12672                       MOVE WS-VA-NO-COMM-MESS
 12673                                    TO CN-LINE (N1)
 12674                     END-IF
 12675                     MOVE N1         TO CN-BILLING-START-LINE-NO
 12676                  ELSE
 12677                     PERFORM 1700-SQUEEZE-IT-IN
 12678                                 THRU 1700-EXIT
 12679                  END-IF
 12680                END-IF
 12681              END-IF
 12682            END-IF
 12683            MOVE 'E631'              TO CN-LAST-MAINT-USER
 12684            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 12685            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12686
 12687* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 235
* EL6311.cbl
 12688*              DATASET    (FILE-ID-ERNOTE)
 12689*              FROM       (CERTIFICATE-NOTE)
 12690*              RESP       (WS-RESPONSE)
 12691*           END-EXEC
 12692     MOVE LENGTH OF
 12693      CERTIFICATE-NOTE
 12694       TO DFHEIV11
 12695*    MOVE '&& L                  %  N#00011679' TO DFHEIV0
 12696     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12697     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12698     MOVE X'204E233030303131363739' TO DFHEIV0(25:11)
 12699     CALL 'kxdfhei1' USING DFHEIV0,
 12700           FILE-ID-ERNOTE,
 12701           CERTIFICATE-NOTE,
 12702           DFHEIV11,
 12703           DFHEIV99
 12704     MOVE EIBRESP  TO WS-RESPONSE
 12705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12706          END-IF
 12707        END-IF
 12708     ELSE
 12709        MOVE SPACES              TO CERTIFICATE-NOTE
 12710        MOVE 'CN'                TO CN-RECORD-ID
 12711        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12712                                 TO CN-CONTROL-PRIMARY
 12713                                    ERNOTE-KEY
 12714        MOVE 01                  TO CN-BILLING-START-LINE-NO
 12715                                    CN-BILLING-END-LINE-NO
 12716        IF PI-COMPANY-ID = 'DCC'
 12717           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 12718        ELSE
 12719           MOVE WS-VA-NO-COMM-MESS
 12720                                 TO CN-LINE (1)
 12721        END-IF
 12722        MOVE 'E631'              TO CN-LAST-MAINT-USER
 12723        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 12724        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12725
 12726* EXEC CICS WRITE
 12727*          DATASET    (FILE-ID-ERNOTE)
 12728*          FROM       (CERTIFICATE-NOTE)
 12729*          RIDFLD     (ERNOTE-KEY)
 12730*          RESP       (WS-RESPONSE)
 12731*       END-EXEC
 12732     MOVE LENGTH OF
 12733      CERTIFICATE-NOTE
 12734       TO DFHEIV11
 12735*    MOVE '&$ L                  ''  N#00011703' TO DFHEIV0
 12736     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12737     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12738     MOVE X'204E233030303131373033' TO DFHEIV0(25:11)
 12739     CALL 'kxdfhei1' USING DFHEIV0,
 12740           FILE-ID-ERNOTE,
 12741           CERTIFICATE-NOTE,
 12742           DFHEIV11,
 12743           ERNOTE-KEY,
 12744           DFHEIV99,
 12745           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 236
* EL6311.cbl
 12746     MOVE EIBRESP  TO WS-RESPONSE
 12747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12748     END-IF
 12749     .
 12750 1510-EXIT.
 12751     EXIT.
 12752 1520-UPDATE-ELCERT.
 12753     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12754                                 TO ELCERT-KEY
 12755
 12756* EXEC CICS READ
 12757*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12758*        DATASET (FILE-ID-ELCERT)
 12759*        RIDFLD  (ELCERT-KEY)
 12760*        UPDATE
 12761*        RESP    (WS-RESPONSE)
 12762*    END-EXEC
 12763*    MOVE '&"S        EU         (  N#00011716' TO DFHEIV0
 12764     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12765     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12766     MOVE X'204E233030303131373136' TO DFHEIV0(25:11)
 12767     CALL 'kxdfhei1' USING DFHEIV0,
 12768           FILE-ID-ELCERT,
 12769           DFHEIV20,
 12770           DFHEIV99,
 12771           ELCERT-KEY,
 12772           DFHEIV99,
 12773           DFHEIV99,
 12774           DFHEIV99
 12775     SET ADDRESS OF CERTIFICATE-MASTER TO
 12776         DFHEIV20
 12777     MOVE EIBRESP  TO WS-RESPONSE
 12778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12779     IF RESP-NORMAL
 12780        IF WS-NOTE-SW = 'A'
 12781           IF CM-NOTE-SW = ' '
 12782              MOVE '2'             TO CM-NOTE-SW
 12783           ELSE
 12784             IF CM-NOTE-SW = '1'
 12785                MOVE '3'           TO CM-NOTE-SW
 12786             ELSE
 12787               IF CM-NOTE-SW = '4'
 12788                  MOVE '6'         TO CM-NOTE-SW
 12789               ELSE
 12790                 IF CM-NOTE-SW = '5'
 12791                    MOVE '7'       TO CM-NOTE-SW
 12792                 END-IF
 12793               END-IF
 12794             END-IF
 12795           END-IF
 12796        ELSE
 12797           IF CM-NOTE-SW = '2'
 12798              MOVE ' '             TO CM-NOTE-SW
 12799           ELSE
 12800             IF CM-NOTE-SW = '3'
 12801                MOVE '1'           TO CM-NOTE-SW
 12802             ELSE
 12803               IF CM-NOTE-SW = '6'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 237
* EL6311.cbl
 12804                  MOVE '4'         TO CM-NOTE-SW
 12805               ELSE
 12806                 IF CM-NOTE-SW = '7'
 12807                    MOVE '5'       TO CM-NOTE-SW
 12808                 END-IF
 12809               END-IF
 12810             END-IF
 12811           END-IF
 12812        END-IF
 12813
 12814* EXEC CICS REWRITE
 12815*          DATASET    (FILE-ID-ELCERT)
 12816*          FROM       (CERTIFICATE-MASTER)
 12817*          RESP       (WS-RESPONSE)
 12818*       END-EXEC
 12819     MOVE LENGTH OF
 12820      CERTIFICATE-MASTER
 12821       TO DFHEIV11
 12822*    MOVE '&& L                  %  N#00011757' TO DFHEIV0
 12823     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12824     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12825     MOVE X'204E233030303131373537' TO DFHEIV0(25:11)
 12826     CALL 'kxdfhei1' USING DFHEIV0,
 12827           FILE-ID-ELCERT,
 12828           CERTIFICATE-MASTER,
 12829           DFHEIV11,
 12830           DFHEIV99
 12831     MOVE EIBRESP  TO WS-RESPONSE
 12832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12833        IF RESP-NORMAL
 12834           CONTINUE
 12835        ELSE
 12836           MOVE WS-RESPONSE TO EMI-ERROR
 12837           PERFORM 9900-ERROR-FORMAT
 12838                                 THRU 9900-EXIT
 12839           GO TO 8200-SEND-DATAONLY
 12840        END-IF
 12841     ELSE
 12842        MOVE -1                  TO BMAINTL
 12843        MOVE 0249                TO EMI-ERROR
 12844        PERFORM 9900-ERROR-FORMAT
 12845                                 THRU 9900-EXIT
 12846        GO TO 8200-SEND-DATAONLY
 12847     END-IF
 12848     .
 12849 1520-EXIT.
 12850     EXIT.
 12851 1600-UPDATE-ERPYAJ.
 12852     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 12853                                 THRU 1610-EXIT
 12854     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 12855                                 THRU 1620-EXIT
 12856     .
 12857 1600-EXIT.
 12858     EXIT.
 12859 1610-ADD-ERPYAJ-BANK-REC.
 12860
 12861* EXEC CICS GETMAIN
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 238
* EL6311.cbl
 12862*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 12863*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 12864*        INITIMG (GETMAIN-SPACE)
 12865*    END-EXEC
 12866*    MOVE ',"IL                  $   #00011789' TO DFHEIV0
 12867     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12868     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12869     MOVE X'2020233030303131373839' TO DFHEIV0(25:11)
 12870     CALL 'kxdfhei1' USING DFHEIV0,
 12871           DFHEIV20,
 12872           ERPYAJ-RECORD-LENGTH,
 12873           GETMAIN-SPACE
 12874     SET ADDRESS OF PENDING-PAY-ADJ TO
 12875         DFHEIV20
 12876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12877     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 12878     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 12879     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 12880     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 12881     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 12882     MOVE +10                    TO ERPYAJ-SEQ-NO
 12883     MOVE 'R'                    TO ERPYAJ-TYPE
 12884     IF REVERSAL
 12885        MOVE 'C'                 TO ERPYAJ-TYPE
 12886     END-IF
 12887     MOVE SPACES                 TO PENDING-PAY-ADJ
 12888     MOVE 'PY'                   TO PY-RECORD-ID
 12889     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 12890     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 12891     IF REVERSAL
 12892        MOVE PB-I-DCC-OVER-CHG-AMT
 12893                                 TO PY-ENTRY-AMT
 12894     END-IF
 12895     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 12896                                    PY-INPUT-DT
 12897*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 12898*                                   PY-INPUT-DT
 12899     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 12900     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 12901     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 12902     MOVE 'B'                    TO PY-ERCOMP-TYPE
 12903     IF PB-CARRIER = '2'
 12904        MOVE '2725040330'        TO PY-GL-ACCOUNT
 12905     ELSE
 12906        MOVE '2725040130'        TO PY-GL-ACCOUNT
 12907     END-IF
 12908     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 12909                                    PY-BILLED-DATE
 12910                                    PY-AR-DATE
 12911                                    PY-REPORTED-DT
 12912                                    PY-CHECK-WRITTEN-DT
 12913     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 12914                                    PY-CHECK-QUE-SEQUENCE
 12915     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 12916     PERFORM WITH TEST AFTER
 12917        UNTIL (NOT RESP-DUPKEY)
 12918           AND (NOT RESP-DUPREC)
 12919
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 239
* EL6311.cbl
 12920* EXEC CICS WRITE
 12921*          DATASET    (FILE-ID-ERPYAJ)
 12922*          FROM       (PENDING-PAY-ADJ)
 12923*          RIDFLD     (ERPYAJ-KEY)
 12924*          RESP       (WS-RESPONSE)
 12925*       END-EXEC
 12926     MOVE LENGTH OF
 12927      PENDING-PAY-ADJ
 12928       TO DFHEIV11
 12929*    MOVE '&$ L                  ''  N#00011836' TO DFHEIV0
 12930     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12931     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12932     MOVE X'204E233030303131383336' TO DFHEIV0(25:11)
 12933     CALL 'kxdfhei1' USING DFHEIV0,
 12934           FILE-ID-ERPYAJ,
 12935           PENDING-PAY-ADJ,
 12936           DFHEIV11,
 12937           ERPYAJ-KEY,
 12938           DFHEIV99,
 12939           DFHEIV99
 12940     MOVE EIBRESP  TO WS-RESPONSE
 12941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12942        IF RESP-DUPKEY OR RESP-DUPREC
 12943           ADD +1                TO ERPYAJ-SEQ-NO
 12944           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 12945        END-IF
 12946     END-PERFORM
 12947     .
 12948 1610-EXIT.
 12949     EXIT.
 12950 1620-ADD-ERPYAJ-DLR-REC.
 12951     MOVE 'C'                    TO ERPYAJ-TYPE
 12952     IF REVERSAL
 12953        MOVE 'R'                 TO ERPYAJ-TYPE
 12954     END-IF
 12955     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 12956                                    ERPYAJ-ACCOUNT
 12957     ADD +1                      TO ERPYAJ-SEQ-NO
 12958     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 12959     MOVE 'A'                    TO PY-ERCOMP-TYPE
 12960     IF PB-CARRIER = '2'
 12961        MOVE '2725040330'        TO PY-GL-ACCOUNT
 12962     ELSE
 12963        MOVE '2725040130'        TO PY-GL-ACCOUNT
 12964     END-IF
 12965     PERFORM WITH TEST AFTER
 12966        UNTIL (NOT RESP-DUPKEY)
 12967           AND (NOT RESP-DUPREC)
 12968
 12969* EXEC CICS WRITE
 12970*          DATASET    (FILE-ID-ERPYAJ)
 12971*          FROM       (PENDING-PAY-ADJ)
 12972*          RIDFLD     (ERPYAJ-KEY)
 12973*          RESP       (WS-RESPONSE)
 12974*       END-EXEC
 12975     MOVE LENGTH OF
 12976      PENDING-PAY-ADJ
 12977       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 240
* EL6311.cbl
 12978*    MOVE '&$ L                  ''  N#00011868' TO DFHEIV0
 12979     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12980     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12981     MOVE X'204E233030303131383638' TO DFHEIV0(25:11)
 12982     CALL 'kxdfhei1' USING DFHEIV0,
 12983           FILE-ID-ERPYAJ,
 12984           PENDING-PAY-ADJ,
 12985           DFHEIV11,
 12986           ERPYAJ-KEY,
 12987           DFHEIV99,
 12988           DFHEIV99
 12989     MOVE EIBRESP  TO WS-RESPONSE
 12990     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12991        IF RESP-DUPKEY OR RESP-DUPREC
 12992           ADD +1                TO ERPYAJ-SEQ-NO
 12993           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 12994        END-IF
 12995     END-PERFORM
 12996     .
 12997 1620-EXIT.
 12998     EXIT.
 12999 1700-SQUEEZE-IT-IN.
 13000     IF (N1 > CN-BILLING-END-LINE-NO)
 13001        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13002           N1 = +1
 13003           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13004           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13005              IF PI-COMPANY-ID = 'DCC'
 13006                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13007              ELSE
 13008                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13009              END-IF
 13010              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
 13011              MOVE +2 TO N1
 13012           END-IF
 13013        END-PERFORM
 13014     ELSE
 13015        IF (N1 < CN-BILLING-START-LINE-NO)
 13016           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13017              N1 = +10
 13018              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13019              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13020                 IF PI-COMPANY-ID = 'DCC'
 13021                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13022                 ELSE
 13023                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13024                 END-IF
 13025                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13026                 MOVE +9 TO N1
 13027              END-IF
 13028           END-PERFORM
 13029        END-IF
 13030     END-IF
 13031     .
 13032 1700-EXIT.
 13033     EXIT.
 13034 1800-REMOVE-CERT-NOTES.
 13035     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 241
* EL6311.cbl
 13036                                 TO ERNOTE-KEY
 13037
 13038* EXEC CICS READ
 13039*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13040*       DATASET    (FILE-ID-ERNOTE)
 13041*       RIDFLD     (ERNOTE-KEY)
 13042*       RESP       (WS-RESPONSE)
 13043*       UPDATE
 13044*    END-EXEC
 13045*    MOVE '&"S        EU         (  N#00011920' TO DFHEIV0
 13046     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13047     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13048     MOVE X'204E233030303131393230' TO DFHEIV0(25:11)
 13049     CALL 'kxdfhei1' USING DFHEIV0,
 13050           FILE-ID-ERNOTE,
 13051           DFHEIV20,
 13052           DFHEIV99,
 13053           ERNOTE-KEY,
 13054           DFHEIV99,
 13055           DFHEIV99,
 13056           DFHEIV99
 13057     SET ADDRESS OF CERTIFICATE-NOTE TO
 13058         DFHEIV20
 13059     MOVE EIBRESP  TO WS-RESPONSE
 13060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13061     IF RESP-NORMAL
 13062        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13063           (N1 > +10)
 13064           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13065           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13066        END-PERFORM
 13067        IF N1 < +11
 13068           MOVE SPACES              TO CN-LINE (N1)
 13069           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13070              N1 <= CN-BILLING-END-LINE-NO
 13071              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13072              IF CN-BILLING-END-LINE-NO <
 13073                               CN-BILLING-START-LINE-NO
 13074                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13075                                     CN-BILLING-START-LINE-NO
 13076              END-IF
 13077              PERFORM 1820-SQUEEZE-ERNOTE
 13078                                  THRU 1820-EXIT
 13079           END-IF
 13080           IF CN-LINES = SPACES
 13081
 13082* EXEC CICS DELETE
 13083*                DATASET    (FILE-ID-ERNOTE)
 13084*                RESP       (WS-RESPONSE)
 13085*             END-EXEC
 13086*    MOVE '&(                    &  N#00011947' TO DFHEIV0
 13087     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13088     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13089     MOVE X'204E233030303131393437' TO DFHEIV0(25:11)
 13090     CALL 'kxdfhei1' USING DFHEIV0,
 13091           FILE-ID-ERNOTE,
 13092           DFHEIV99,
 13093           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 242
* EL6311.cbl
 13094           DFHEIV99,
 13095           DFHEIV99
 13096     MOVE EIBRESP  TO WS-RESPONSE
 13097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13098              IF RESP-NORMAL
 13099                 MOVE 'D'        TO WS-NOTE-SW
 13100                 PERFORM 1520-UPDATE-ELCERT
 13101                                 THRU 1520-EXIT
 13102              END-IF
 13103           ELSE
 13104
 13105* EXEC CICS REWRITE
 13106*                DATASET    (FILE-ID-ERNOTE)
 13107*                FROM       (CERTIFICATE-NOTE)
 13108*                RESP       (WS-RESPONSE)
 13109*             END-EXEC
 13110     MOVE LENGTH OF
 13111      CERTIFICATE-NOTE
 13112       TO DFHEIV11
 13113*    MOVE '&& L                  %  N#00011957' TO DFHEIV0
 13114     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13115     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13116     MOVE X'204E233030303131393537' TO DFHEIV0(25:11)
 13117     CALL 'kxdfhei1' USING DFHEIV0,
 13118           FILE-ID-ERNOTE,
 13119           CERTIFICATE-NOTE,
 13120           DFHEIV11,
 13121           DFHEIV99
 13122     MOVE EIBRESP  TO WS-RESPONSE
 13123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13124           END-IF
 13125        END-IF
 13126     END-IF
 13127     .
 13128 1800-EXIT.
 13129     EXIT.
 13130 1820-SQUEEZE-ERNOTE.
 13131     MOVE CN-BILLING-START-LINE-NO TO N2
 13132     IF N2 = 0
 13133         MOVE +1                 TO N2
 13134     END-IF
 13135     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13136        (N1 > +9)
 13137        IF CN-LINE (N1) = SPACES
 13138           MOVE CN-LINE (N1 + +1)
 13139                                 TO CN-LINE (N1)
 13140           MOVE SPACES           TO CN-LINE (N1 + +1)
 13141        END-IF
 13142     END-PERFORM
 13143     .
 13144 1820-EXIT.
 13145     EXIT.
 13146 1900-DELETE-ERPYAJ.
 13147     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13148     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13149     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13150     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13151     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 243
* EL6311.cbl
 13152     MOVE +10                    TO ERPYAJ-SEQ-NO
 13153     MOVE 'R'                    TO ERPYAJ-TYPE
 13154     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13155
 13156* EXEC CICS STARTBR
 13157*       DATASET    (FILE-ID-ERPYAJ)
 13158*       RIDFLD     (ERPYAJ-KEY)
 13159*       RESP       (WS-RESPONSE)
 13160*    END-EXEC
 13161     MOVE 0
 13162       TO DFHEIV11
 13163*    MOVE '&,         G          &  N#00011993' TO DFHEIV0
 13164     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13165     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13166     MOVE X'204E233030303131393933' TO DFHEIV0(25:11)
 13167     CALL 'kxdfhei1' USING DFHEIV0,
 13168           FILE-ID-ERPYAJ,
 13169           ERPYAJ-KEY,
 13170           DFHEIV99,
 13171           DFHEIV11,
 13172           DFHEIV99
 13173     MOVE EIBRESP  TO WS-RESPONSE
 13174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13175     IF RESP-NORMAL
 13176        CONTINUE
 13177     ELSE
 13178        GO TO 1900-GET-DEALER
 13179     END-IF
 13180     .
 13181 1900-READNEXT-ERPYAJ-B.
 13182*  GET THE BANK ERPYAJ RECORD
 13183
 13184* EXEC CICS READNEXT
 13185*       DATASET    (FILE-ID-ERPYAJ)
 13186*       RIDFLD     (ERPYAJ-KEY)
 13187*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 13188*       RESP       (WS-RESPONSE)
 13189*    END-EXEC
 13190     MOVE 0
 13191       TO DFHEIV11
 13192*    MOVE '&.S                   )  N#00012006' TO DFHEIV0
 13193     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13194     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13195     MOVE X'204E233030303132303036' TO DFHEIV0(25:11)
 13196     CALL 'kxdfhei1' USING DFHEIV0,
 13197           FILE-ID-ERPYAJ,
 13198           DFHEIV20,
 13199           DFHEIV99,
 13200           ERPYAJ-KEY,
 13201           DFHEIV99,
 13202           DFHEIV11,
 13203           DFHEIV99,
 13204           DFHEIV99
 13205     SET ADDRESS OF PENDING-PAY-ADJ TO
 13206         DFHEIV20
 13207     MOVE EIBRESP  TO WS-RESPONSE
 13208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13209     IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 244
* EL6311.cbl
 13210        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13211           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13212              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13213                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13214
 13215* EXEC CICS READ
 13216*                   DATASET    (FILE-ID-ERPYAJ)
 13217*                   RIDFLD     (ERPYAJ-KEY)
 13218*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13219*                   RESP       (WS-RESPONSE)
 13220*                   UPDATE
 13221*                END-EXEC
 13222*    MOVE '&"S        EU         (  N#00012017' TO DFHEIV0
 13223     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13224     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13225     MOVE X'204E233030303132303137' TO DFHEIV0(25:11)
 13226     CALL 'kxdfhei1' USING DFHEIV0,
 13227           FILE-ID-ERPYAJ,
 13228           DFHEIV20,
 13229           DFHEIV99,
 13230           ERPYAJ-KEY,
 13231           DFHEIV99,
 13232           DFHEIV99,
 13233           DFHEIV99
 13234     SET ADDRESS OF PENDING-PAY-ADJ TO
 13235         DFHEIV20
 13236     MOVE EIBRESP  TO WS-RESPONSE
 13237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13238                 IF RESP-NORMAL
 13239
 13240* EXEC CICS DELETE
 13241*                      DATASET   (FILE-ID-ERPYAJ)
 13242*                      RESP      (WS-RESPONSE)
 13243*                   END-EXEC
 13244*    MOVE '&(                    &  N#00012025' TO DFHEIV0
 13245     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13246     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13247     MOVE X'204E233030303132303235' TO DFHEIV0(25:11)
 13248     CALL 'kxdfhei1' USING DFHEIV0,
 13249           FILE-ID-ERPYAJ,
 13250           DFHEIV99,
 13251           DFHEIV99,
 13252           DFHEIV99,
 13253           DFHEIV99
 13254     MOVE EIBRESP  TO WS-RESPONSE
 13255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13256                 END-IF
 13257              ELSE
 13258                 SET REVERSAL    TO TRUE
 13259                 PERFORM 1600-UPDATE-ERPYAJ
 13260                                 THRU 1600-EXIT
 13261                 GO TO 1900-EXIT
 13262              END-IF
 13263           ELSE
 13264              GO TO 1900-READNEXT-ERPYAJ-B
 13265           END-IF
 13266        END-IF
 13267
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 245
* EL6311.cbl
 13268* EXEC CICS ENDBR
 13269*          DATASET   (FILE-ID-ERPYAJ)
 13270*       END-EXEC
 13271     MOVE 0
 13272       TO DFHEIV11
 13273*    MOVE '&2                    $   #00012040' TO DFHEIV0
 13274     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13275     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13276     MOVE X'2020233030303132303430' TO DFHEIV0(25:11)
 13277     CALL 'kxdfhei1' USING DFHEIV0,
 13278           FILE-ID-ERPYAJ,
 13279           DFHEIV11,
 13280           DFHEIV99
 13281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13282     END-IF
 13283     .
 13284 1900-GET-DEALER.
 13285     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13286     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13287     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13288     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13289     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 13290     MOVE +10                    TO ERPYAJ-SEQ-NO
 13291     MOVE 'C'                    TO ERPYAJ-TYPE
 13292     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13293
 13294* EXEC CICS STARTBR
 13295*       DATASET    (FILE-ID-ERPYAJ)
 13296*       RIDFLD     (ERPYAJ-KEY)
 13297*       RESP       (WS-RESPONSE)
 13298*    END-EXEC
 13299     MOVE 0
 13300       TO DFHEIV11
 13301*    MOVE '&,         G          &  N#00012054' TO DFHEIV0
 13302     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 13303     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13304     MOVE X'204E233030303132303534' TO DFHEIV0(25:11)
 13305     CALL 'kxdfhei1' USING DFHEIV0,
 13306           FILE-ID-ERPYAJ,
 13307           ERPYAJ-KEY,
 13308           DFHEIV99,
 13309           DFHEIV11,
 13310           DFHEIV99
 13311     MOVE EIBRESP  TO WS-RESPONSE
 13312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13313     IF RESP-NORMAL
 13314        CONTINUE
 13315     ELSE
 13316        GO TO 1900-EXIT
 13317     END-IF
 13318     .
 13319 1900-READNEXT-ERPYAJ-D.
 13320*  GET THE DEALER ERPYAJ RECORD
 13321
 13322* EXEC CICS READNEXT
 13323*       DATASET    (FILE-ID-ERPYAJ)
 13324*       RIDFLD     (ERPYAJ-KEY)
 13325*       SET        (ADDRESS OF PENDING-PAY-ADJ)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 246
* EL6311.cbl
 13326*       RESP       (WS-RESPONSE)
 13327*    END-EXEC
 13328     MOVE 0
 13329       TO DFHEIV11
 13330*    MOVE '&.S                   )  N#00012067' TO DFHEIV0
 13331     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13332     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13333     MOVE X'204E233030303132303637' TO DFHEIV0(25:11)
 13334     CALL 'kxdfhei1' USING DFHEIV0,
 13335           FILE-ID-ERPYAJ,
 13336           DFHEIV20,
 13337           DFHEIV99,
 13338           ERPYAJ-KEY,
 13339           DFHEIV99,
 13340           DFHEIV11,
 13341           DFHEIV99,
 13342           DFHEIV99
 13343     SET ADDRESS OF PENDING-PAY-ADJ TO
 13344         DFHEIV20
 13345     MOVE EIBRESP  TO WS-RESPONSE
 13346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13347     IF RESP-NORMAL
 13348        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 13349           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 13350              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 13351                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 13352
 13353* EXEC CICS READ
 13354*                   DATASET    (FILE-ID-ERPYAJ)
 13355*                   RIDFLD     (ERPYAJ-KEY)
 13356*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 13357*                   RESP       (WS-RESPONSE)
 13358*                   UPDATE
 13359*                END-EXEC
 13360*    MOVE '&"S        EU         (  N#00012078' TO DFHEIV0
 13361     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13362     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13363     MOVE X'204E233030303132303738' TO DFHEIV0(25:11)
 13364     CALL 'kxdfhei1' USING DFHEIV0,
 13365           FILE-ID-ERPYAJ,
 13366           DFHEIV20,
 13367           DFHEIV99,
 13368           ERPYAJ-KEY,
 13369           DFHEIV99,
 13370           DFHEIV99,
 13371           DFHEIV99
 13372     SET ADDRESS OF PENDING-PAY-ADJ TO
 13373         DFHEIV20
 13374     MOVE EIBRESP  TO WS-RESPONSE
 13375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13376                 IF RESP-NORMAL
 13377
 13378* EXEC CICS DELETE
 13379*                      DATASET   (FILE-ID-ERPYAJ)
 13380*                      RESP      (WS-RESPONSE)
 13381*                   END-EXEC
 13382*    MOVE '&(                    &  N#00012086' TO DFHEIV0
 13383     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 247
* EL6311.cbl
 13384     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13385     MOVE X'204E233030303132303836' TO DFHEIV0(25:11)
 13386     CALL 'kxdfhei1' USING DFHEIV0,
 13387           FILE-ID-ERPYAJ,
 13388           DFHEIV99,
 13389           DFHEIV99,
 13390           DFHEIV99,
 13391           DFHEIV99
 13392     MOVE EIBRESP  TO WS-RESPONSE
 13393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13394                 END-IF
 13395              ELSE
 13396                 SET REVERSAL    TO TRUE
 13397              END-IF
 13398           ELSE
 13399              GO TO 1900-READNEXT-ERPYAJ-D
 13400           END-IF
 13401        END-IF
 13402
 13403* EXEC CICS ENDBR
 13404*          DATASET   (FILE-ID-ERPYAJ)
 13405*       END-EXEC
 13406     MOVE 0
 13407       TO DFHEIV11
 13408*    MOVE '&2                    $   #00012098' TO DFHEIV0
 13409     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13410     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13411     MOVE X'2020233030303132303938' TO DFHEIV0(25:11)
 13412     CALL 'kxdfhei1' USING DFHEIV0,
 13413           FILE-ID-ERPYAJ,
 13414           DFHEIV11,
 13415           DFHEIV99
 13416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13417     END-IF
 13418     .
 13419 1900-EXIT.
 13420     EXIT.
 13421******************************************************************
 13422*            C A N C E L   M A I N L I N E                       *
 13423******************************************************************
 13424
 13425 2000-CANCEL-MAINLINE.
 13426     IF PI-DISPLAY-ORIGINAL-BATCH
 13427        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 13428           MOVE ER-0023             TO EMI-ERROR
 13429           MOVE -1                  TO CMAINTL
 13430           MOVE AL-UABON            TO CMAINTA
 13431           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13432           GO TO 8200-SEND-DATAONLY
 13433        ELSE
 13434           NEXT SENTENCE
 13435     ELSE
 13436        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 13437           MOVE ER-0023             TO EMI-ERROR
 13438           MOVE -1                  TO CMAINTL
 13439           MOVE AL-UABON            TO CMAINTA
 13440           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13441           GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 248
* EL6311.cbl
 13442
 13443     IF CMAINTI = 'S'
 13444        GO TO 2100-SHOW-REQUEST.
 13445
 13446     IF NOT MODIFY-CAP
 13447         MOVE 'UPDATE'       TO SM-READ
 13448         PERFORM 9995-SECURITY-VIOLATION
 13449         MOVE ER-0070        TO EMI-ERROR
 13450         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13451         GO TO 8100-SEND-INITIAL-MAP.
 13452
 13453     IF CMAINTL GREATER THAN ZEROS
 13454        IF PI-PF6-FUNCTION
 13455           IF CMAINTI NOT = 'A'
 13456              MOVE AL-UABON  TO CMAINTA
 13457              MOVE -1        TO CMAINTL
 13458              MOVE ER-2260   TO EMI-ERROR
 13459              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13460              GO TO 8200-SEND-DATAONLY.
 13461
 13462     IF CCERTNOL = ZEROS
 13463       AND (CMAINTI = 'C' OR 'K' OR 'D')
 13464         NEXT SENTENCE
 13465     ELSE
 13466         IF CCERTNOL NOT = ZEROS
 13467             MOVE AL-UANON       TO CCERTNOA
 13468         ELSE
 13469             MOVE -1             TO CCERTNOL
 13470             MOVE  1             TO SET-CURSOR-SW
 13471             MOVE ER-2218       TO EMI-ERROR
 13472             MOVE AL-UABON       TO CCERTNOA
 13473             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13474
 13475     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 13476        NEXT SENTENCE
 13477     ELSE
 13478        IF CEFFDTL NOT = ZEROS
 13479           MOVE AL-UNNON         TO CEFFDTA
 13480           MOVE CEFFDTI TO DEEDIT-FIELD
 13481           PERFORM 8600-DEEDIT
 13482           MOVE 4                TO DC-OPTION-CODE
 13483           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13484           PERFORM 9700-DATE-LINK
 13485           IF NO-CONVERSION-ERROR
 13486              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 13487              ELSE
 13488              MOVE -1            TO CEFFDTL
 13489              MOVE  1            TO SET-CURSOR-SW
 13490              MOVE ER-2226      TO EMI-ERROR
 13491              MOVE AL-UNBON      TO CEFFDTA
 13492              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13493          ELSE
 13494          MOVE -1                 TO CEFFDTL
 13495          MOVE  1                 TO SET-CURSOR-SW
 13496          MOVE ER-2220            TO EMI-ERROR
 13497          MOVE AL-UNBON           TO CEFFDTA
 13498          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13499
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 249
* EL6311.cbl
 13500     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 13501
 13502     IF CCERTNOL NOT = ZEROS
 13503        MOVE CCERTNOI                TO WS-NEW-PRIME
 13504     ELSE
 13505        MOVE SPACES                  TO WS-NEW-PRIME.
 13506
 13507     IF CSUFIXL NOT = ZEROS
 13508        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 13509     ELSE
 13510        MOVE SPACE                   TO WS-NEW-SUFFIX.
 13511
 13512     IF CEFFDTL NOT = ZEROS
 13513        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 13514     ELSE
 13515        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 13516
 13517     IF CMAINTI = 'A' OR 'K' OR 'S'
 13518        NEXT SENTENCE
 13519     ELSE
 13520        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 13521        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 13522           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 13523           WS-PB-RECORD-TYPE NOT = '2'
 13524           IF CMAINTI = 'C'
 13525              MOVE ER-2287          TO EMI-ERROR
 13526              MOVE -1               TO CCERTNOL
 13527              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 13528              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13529              GO TO 8200-SEND-DATAONLY
 13530             ELSE
 13531              MOVE ER-2260          TO EMI-ERROR
 13532              MOVE -1               TO CCERTNOL
 13533              MOVE AL-UABON         TO CCERTNOA
 13534              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13535              GO TO 8200-SEND-DATAONLY.
 13536
 13537     IF CMAINTI = 'D'
 13538        GO TO 2400-DELETE-CANCEL-ROUTINE.
 13539
 13540     IF CLSTNML GREATER THAN ZEROS
 13541         MOVE AL-UANON           TO CLSTNMA.
 13542
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 250
* EL6311.cbl
 13544
 13545******************************************************************
 13546*                                                                *
 13547*           E D I T   C A N C E L   C O V E R A G E S            *
 13548*                                                                *
 13549******************************************************************
 13550
 13551 2015-EDIT-COVERAGES.
 13552     IF CCANDT1L      GREATER THAN ZEROS OR
 13553        CREFND1L      GREATER THAN ZEROS OR
 13554        CCANDT2L      GREATER THAN ZEROS OR
 13555        CREFND2L      GREATER THAN ZEROS OR
 13556        CMTHD1L       GREATER THAN ZEROS OR
 13557        CMTHD2L       GREATER THAN ZEROS OR
 13558        CLIVESL       GREATER THAN ZEROS OR
 13559        CPAYEEL       GREATER THAN ZEROS OR
 13560        CFORCEL       GREATER THAN ZEROS OR
 13561        CBILCDL       GREATER THAN ZEROS OR
 13562        CCANREAL      GREATER THAN ZEROS
 13563            NEXT SENTENCE
 13564         ELSE
 13565            GO TO 2030-EDIT-COMPLETE.
 13566
 13567     IF CCANDT1L = ZEROS
 13568        AND (CMAINTI = 'C' OR 'K')
 13569        NEXT SENTENCE
 13570     ELSE
 13571        IF CCANDT1L      GREATER THAN ZEROS
 13572            MOVE AL-UNNON            TO CCANDT1A
 13573            IF CCANDT1I = SPACES
 13574               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 13575            ELSE
 13576               MOVE CCANDT1I            TO DEEDIT-FIELD
 13577               PERFORM 8600-DEEDIT
 13578               IF DEEDIT-FIELD-V0   NUMERIC
 13579                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13580                  MOVE 4                TO DC-OPTION-CODE
 13581                  PERFORM 9700-DATE-LINK
 13582                  IF NO-CONVERSION-ERROR
 13583                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 13584                  ELSE
 13585                      MOVE -1        TO CCANDT1L
 13586                      MOVE ER-2227   TO EMI-ERROR
 13587                      MOVE AL-UNBON  TO CCANDT1A
 13588                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13589               ELSE
 13590                  MOVE -1         TO CCANDT1L
 13591                  MOVE ER-2223    TO EMI-ERROR
 13592                  MOVE AL-UNBON   TO CCANDT1A
 13593                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13594        ELSE
 13595            IF CREFND1L GREATER THAN ZEROS
 13596               MOVE -1             TO CCANDT1L
 13597               MOVE ER-2222        TO EMI-ERROR
 13598               MOVE AL-UNBOF       TO CCANDT1A
 13599               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13600
 13601     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 251
* EL6311.cbl
 13602        AND (CMAINTI = 'C' OR 'K')
 13603         NEXT SENTENCE
 13604     ELSE
 13605         IF CREFND1L NOT = ZEROS
 13606            MOVE AL-UNNON        TO CREFND1A
 13607
 13608* EXEC CICS BIF DEEDIT
 13609*               FIELD  (CREFND1I)
 13610*               LENGTH (11)
 13611*           END-EXEC
 13612     MOVE 11
 13613       TO DFHEIV11
 13614*    MOVE '@"L                   #   #00012291' TO DFHEIV0
 13615     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13616     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13617     MOVE X'2020233030303132323931' TO DFHEIV0(25:11)
 13618     CALL 'kxdfhei1' USING DFHEIV0,
 13619           CREFND1I,
 13620           DFHEIV11
 13621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13622            MOVE CREFND1I        TO WS-CREFND1
 13623*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 13624*           PERFORM 8600-DEEDIT
 13625*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 13626            IF WS-CREFND1  = ZEROS
 13627               AND CMAINTI = 'A'
 13628             MOVE ER-2437        TO EMI-ERROR
 13629             MOVE -1             TO CREFND1L
 13630             MOVE AL-UNBON       TO CREFND1A
 13631             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13632
 13633     IF CCANREAL > +0
 13634        MOVE AL-UANON            TO CCANREAA
 13635        IF CCANREAI = 'R' OR ' '
 13636           CONTINUE
 13637        ELSE
 13638           MOVE ER-9841        TO EMI-ERROR
 13639           MOVE -1             TO CCANREAL
 13640           MOVE AL-UABON       TO CCANREAA
 13641           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13642        END-IF
 13643     END-IF
 13644     IF CMTHD1L EQUAL +0
 13645        NEXT SENTENCE
 13646     ELSE
 13647        IF CMTHD1L NOT = +0
 13648           MOVE AL-UNNON        TO CMTHD1A
 13649           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 13650                         OR '5' OR '6' OR '8' OR '9'
 13651                         OR 'R' OR ' '
 13652              NEXT SENTENCE
 13653           ELSE
 13654              MOVE ER-0582        TO EMI-ERROR
 13655              MOVE -1             TO CMTHD1L
 13656              MOVE AL-UNBON       TO CMTHD1A
 13657              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13658
 13659     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 252
* EL6311.cbl
 13660        AND (CMAINTI = 'C' OR 'K')
 13661         NEXT SENTENCE
 13662     ELSE
 13663         IF CCANDT2L  GREATER THAN ZEROS
 13664             MOVE AL-UNNON       TO CCANDT2A
 13665             IF CCANDT2I = SPACES
 13666                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 13667             ELSE
 13668                MOVE CCANDT2I       TO DEEDIT-FIELD
 13669                PERFORM 8600-DEEDIT
 13670                IF DEEDIT-FIELD-V0   NUMERIC
 13671                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 13672                   MOVE 4                TO DC-OPTION-CODE
 13673                   PERFORM 9700-DATE-LINK
 13674                   IF NO-CONVERSION-ERROR
 13675                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 13676                   ELSE
 13677                      MOVE -1       TO CCANDT2L
 13678                      MOVE ER-2227  TO EMI-ERROR
 13679                      MOVE AL-UNBON TO CCANDT2A
 13680                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13681                ELSE
 13682                   MOVE -1         TO CCANDT2L
 13683                   MOVE ER-2223    TO EMI-ERROR
 13684                   MOVE AL-UNBON   TO CCANDT2A
 13685                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13686         ELSE
 13687            IF CREFND2L GREATER THAN ZEROS
 13688               MOVE -1             TO CCANDT2L
 13689               MOVE ER-2222        TO EMI-ERROR
 13690               MOVE AL-UNBOF       TO CCANDT2A
 13691               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13692
 13693     IF CREFND2L = ZEROS
 13694        AND (CMAINTI = 'C' OR 'K')
 13695         NEXT SENTENCE
 13696     ELSE
 13697         IF CREFND2L NOT = ZEROS
 13698            MOVE AL-UNNON        TO CREFND2A
 13699
 13700* EXEC CICS BIF DEEDIT
 13701*               FIELD  (CREFND2I)
 13702*               LENGTH (11)
 13703*           END-EXEC
 13704     MOVE 11
 13705       TO DFHEIV11
 13706*    MOVE '@"L                   #   #00012372' TO DFHEIV0
 13707     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13708     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13709     MOVE X'2020233030303132333732' TO DFHEIV0(25:11)
 13710     CALL 'kxdfhei1' USING DFHEIV0,
 13711           CREFND2I,
 13712           DFHEIV11
 13713     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13714            MOVE CREFND2I        TO WS-CREFND2
 13715*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 13716*           PERFORM 8600-DEEDIT
 13717*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 253
* EL6311.cbl
 13718            IF WS-CREFND2  = ZEROS
 13719               AND CMAINTI = 'A'
 13720             MOVE ER-2437        TO EMI-ERROR
 13721             MOVE -1             TO CREFND2L
 13722             MOVE AL-UNBON       TO CREFND2A
 13723             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13724
 13725     IF CMTHD2L EQUAL +0
 13726        NEXT SENTENCE
 13727     ELSE
 13728        IF CMTHD2L NOT = +0
 13729           MOVE AL-UNNON        TO CMTHD2A
 13730           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 13731                         OR '5' OR '6' OR '8' OR '9'
 13732                         OR ' ' OR 'R'
 13733              NEXT SENTENCE
 13734           ELSE
 13735              MOVE ER-0582        TO EMI-ERROR
 13736              MOVE -1             TO CMTHD2L
 13737              MOVE AL-UNBON       TO CMTHD2A
 13738              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13739
 13740     IF CLIVESL GREATER THAN ZEROS
 13741         MOVE CLIVESI            TO DEEDIT-FIELD
 13742         PERFORM 8600-DEEDIT
 13743         IF DEEDIT-FIELD-V0 NUMERIC
 13744             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 13745             MOVE AL-UNNON       TO CLIVESA
 13746         ELSE
 13747             MOVE -1             TO CLIVESL
 13748             MOVE AL-UNBON       TO CLIVESA
 13749             MOVE ER-2223        TO EMI-ERROR
 13750             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13751
 13752     IF CFORCEL  NOT = ZEROS
 13753         IF FORCE-CAP
 13754            MOVE AL-UANON            TO CFORCEA
 13755         ELSE
 13756            MOVE ER-2945             TO EMI-ERROR
 13757            MOVE AL-UABON            TO CFORCEA
 13758            MOVE -1                  TO CFORCEL
 13759            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13760
 13761     IF CPAYEEL GREATER THAN ZEROS
 13762        MOVE AL-UANON            TO CPAYEEA.
 13763
 13764     IF CBILCDL NOT = ZEROS
 13765        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 13766                             AND 'A' AND 'B' AND 'E'
 13767           MOVE ER-2225              TO EMI-ERROR
 13768           MOVE AL-UABON             TO CBILCDA
 13769           MOVE -1                   TO CBILCDL
 13770           MOVE  1                   TO SET-CURSOR-SW
 13771           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13772        ELSE
 13773           MOVE AL-UANON             TO CBILCDA.
 13774
 13775 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 254
* EL6311.cbl
 13776     IF EMI-ERROR = ZEROS
 13777         NEXT SENTENCE
 13778     ELSE
 13779         GO TO 8200-SEND-DATAONLY.
 13780
 13781     IF CMAINTI = 'A'
 13782        GO TO 2200-ADD-CANCEL-ROUTINE.
 13783
 13784     IF CMAINTI = 'C'
 13785        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 13786
 13787     GO TO 2900-REWRITE-CAN-CERT-KEY.
 13788
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 255
* EL6311.cbl
 13790
 13791******************************************************************
 13792*                                                                *
 13793*                   S H O W   C A N C E L                        *
 13794*                                                                *
 13795******************************************************************
 13796
 13797 2100-SHOW-REQUEST.
 13798     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 13799
 13800     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 13801        MOVE -1                  TO CMAINTL
 13802        GO TO 8200-SEND-DATAONLY.
 13803
 13804     MOVE CCERTNOI            TO WS-NEW-PRIME.
 13805
 13806     IF CSUFIXL NOT = ZEROS
 13807        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 13808       ELSE
 13809        MOVE SPACE            TO WS-NEW-SUFFIX.
 13810
 13811     MOVE CEFFDTI                TO DEEDIT-FIELD.
 13812     PERFORM 8600-DEEDIT.
 13813     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 13814     MOVE '4'                    TO DC-OPTION-CODE.
 13815     PERFORM 9700-DATE-LINK.
 13816     IF DATE-CONVERSION-ERROR
 13817        MOVE ER-0348             TO EMI-ERROR
 13818        MOVE -1                  TO CEFFDTL
 13819        MOVE AL-UABON            TO CEFFDTA
 13820        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13821        GO TO 8200-SEND-DATAONLY
 13822     ELSE
 13823        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 13824        MOVE AL-UANON            TO CEFFDTA
 13825        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 13826
 13827     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 13828
 13829     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 13830        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 13831        MOVE 'Y'                    TO WS-SHOW-SW
 13832        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 13833           GO TO 4100-BROWSE-PRIMARY-FORWARD
 13834        ELSE
 13835           IF PI-FILE-BROWSE
 13836              GO TO 4300-BROWSE-FILE-FORWARD
 13837           ELSE
 13838              IF PI-CSR-BROWSE
 13839                 GO TO 4200-BROWSE-CSR-FORWARD
 13840              ELSE
 13841                 GO TO 4000-BROWSE-DETAIL-FORWARD
 13842     ELSE
 13843        GO TO 3900-RE-DISPLAY-RECORD.
 13844
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 256
* EL6311.cbl
 13846
 13847
 13848******************************************************************
 13849*                                                                *
 13850*            A D D   C A N C E L   R O U T I N E                 *
 13851*                                                                *
 13852******************************************************************
 13853
 13854 2200-ADD-CANCEL-ROUTINE.
 13855     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 13856
 13857
 13858* EXEC CICS GETMAIN
 13859*        SET     (ADDRESS OF PENDING-BUSINESS)
 13860*        LENGTH  (ERPNDB-RECORD-LENGTH)
 13861*    END-EXEC.
 13862*    MOVE '," L                  $   #00012519' TO DFHEIV0
 13863     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 13864     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13865     MOVE X'2020233030303132353139' TO DFHEIV0(25:11)
 13866     CALL 'kxdfhei1' USING DFHEIV0,
 13867           DFHEIV20,
 13868           ERPNDB-RECORD-LENGTH,
 13869           DFHEIV99
 13870     SET ADDRESS OF PENDING-BUSINESS TO
 13871         DFHEIV20
 13872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13873
 13874
 13875
 13876* EXEC CICS HANDLE CONDITION
 13877*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 13878*    END-EXEC.
 13879*    MOVE '"$I                   ! 1 #00012524' TO DFHEIV0
 13880     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13881     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13882     MOVE X'3120233030303132353234' TO DFHEIV0(25:11)
 13883     CALL 'kxdfhei1' USING DFHEIV0
 13884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13885
 13886
 13887     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 13888     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13889     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13890
 13891
 13892* EXEC CICS READ
 13893*        INTO    (PENDING-BUSINESS)
 13894*        DATASET (FILE-ID-ERPNDB)
 13895*        RIDFLD  (ERPNDB-KEY)
 13896*    END-EXEC.
 13897     MOVE LENGTH OF
 13898      PENDING-BUSINESS
 13899       TO DFHEIV11
 13900*    MOVE '&"IL       E          (   #00012532' TO DFHEIV0
 13901     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13902     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13903     MOVE X'2020233030303132353332' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 257
* EL6311.cbl
 13904     CALL 'kxdfhei1' USING DFHEIV0,
 13905           FILE-ID-ERPNDB,
 13906           PENDING-BUSINESS,
 13907           DFHEIV11,
 13908           ERPNDB-KEY,
 13909           DFHEIV99,
 13910           DFHEIV99,
 13911           DFHEIV99
 13912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13913
 13914
 13915     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 13916
 13917     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 13918     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 13919     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 13920     MOVE SPACES                 TO PENDING-BUSINESS.
 13921     MOVE 'PB'                   TO PB-RECORD-ID.
 13922     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 13923     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 13924     MOVE SPACES                 TO PB-CERT-SFX.
 13925     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 13926     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 13927                                    PB-ALT-CHG-SEQ-NO.
 13928
 13929     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 13930     MOVE CCERTNOI               TO PB-CERT-PRIME.
 13931     MOVE '2'                    TO PB-RECORD-TYPE.
 13932
 13933     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 13934     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 13935
 13936
 13937     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 13938                                    PB-ALT-CHG-SEQ-NO
 13939                                    PB-C-LF-REF-CALC
 13940                                    PB-C-AH-REF-CALC
 13941                                    PB-C-LF-RFND-CLP
 13942                                    PB-C-AH-RFND-CLP
 13943                                    PB-CI-INSURED-AGE
 13944                                    PB-CI-LF-TERM
 13945                                    PB-CI-AH-TERM
 13946                                    PB-CI-LF-BENEFIT-CD
 13947                                    PB-CI-LF-BENEFIT-AMT
 13948                                    PB-CI-LF-ALT-BENEFIT-AMT
 13949                                    PB-CI-LF-PREMIUM-AMT
 13950                                    PB-CI-LF-ALT-PREMIUM-AMT
 13951                                    PB-CI-AH-BENEFIT-CD
 13952                                    PB-CI-AH-BENEFIT-AMT
 13953                                    PB-CI-AH-PREMIUM-AMT
 13954                                    PB-CI-PAY-FREQUENCY
 13955                                    PB-CI-LOAN-APR
 13956                                    PB-CI-LOAN-TERM
 13957                                    PB-CI-LIFE-COMMISSION
 13958                                    PB-CI-AH-COMMISSION
 13959                                    PB-CI-CURR-SEQ
 13960                                    PB-CI-AH-CANCEL-AMT
 13961                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 258
* EL6311.cbl
 13962                                    PB-CI-RATE-DEV-PCT-LF
 13963                                    PB-CI-RATE-DEV-PCT-AH
 13964                                    PB-CI-EXTENTION-DAYS
 13965                                    PB-CI-TERM-IN-DAYS
 13966                                    PB-CI-LIVES
 13967                                    PB-CI-LF-CRIT-PER
 13968                                    PB-CI-AH-CRIT-PER
 13969                                    PB-C-LF-REM-TERM
 13970                                    PB-C-AH-REM-TERM
 13971                                    PB-CHG-COUNT
 13972                                    PB-LF-BILLED-AMTS
 13973                                    PB-AH-BILLED-AMTS
 13974                                    PB-C-NH-INT-ON-REFS
 13975*                                   PB-C-MICROFILM-NO
 13976                                    PB-CALC-TOLERANCE.
 13977
 13978     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 13979                                    PB-CI-AH-SETTLEMENT-DT
 13980                                    PB-CI-DEATH-DT
 13981                                    PB-CI-LF-PRIOR-CANCEL-DT
 13982                                    PB-CI-AH-PRIOR-CANCEL-DT
 13983                                    PB-CI-ENTRY-DT
 13984                                    PB-CI-LF-EXPIRE-DT
 13985                                    PB-CI-AH-EXPIRE-DT
 13986                                    PB-CI-LOAN-1ST-PMT-DT
 13987                                    PB-C-LF-CANCEL-DT
 13988                                    PB-C-AH-CANCEL-DT
 13989                                    PB-CREDIT-ACCEPT-DT
 13990                                    PB-BILLED-DT
 13991                                    PB-ACCT-EFF-DT
 13992                                    PB-ACCT-EXP-DT.
 13993
 13994     MOVE 'X'                    TO PB-FATAL-FLAG.
 13995
 13996     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 13997
 13998     IF CSUFIXL     GREATER THAN ZEROS
 13999        MOVE CSUFIXI             TO PB-CERT-SFX.
 14000
 14001*    IF CMICRNOL  GREATER  ZEROS
 14002*        IF CMICRNOI  NUMERIC
 14003*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14004*            MOVE AL-UNNON       TO  CMICRNOA
 14005*        ELSE
 14006*            MOVE -1             TO  CMICRNOL
 14007*            MOVE AL-UNBON       TO  CMICRNOA
 14008*            MOVE ER-2701        TO  EMI-ERROR
 14009*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14010
 14011     IF CLSTNML     GREATER THAN ZEROS
 14012        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14013
 14014     IF CCANREAL > ZEROS
 14015        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14016     END-IF
 14017     IF CPCYNL > ZEROS
 14018        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14019     END-IF
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 259
* EL6311.cbl
 14020     IF CCANDT1L    GREATER THAN ZEROS
 14021        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14022
 14023     IF CCANDT2L    GREATER THAN ZEROS
 14024        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14025
 14026     IF CMTHD1L    GREATER THAN +0
 14027        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14028
 14029     IF CMTHD2L    GREATER THAN +0
 14030        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14031
 14032     IF CREFND1L    GREATER THAN ZEROS
 14033        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14034        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14035     ELSE
 14036        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14037
 14038     IF CREFND2L    GREATER THAN ZEROS
 14039        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14040        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14041     ELSE
 14042        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14043
 14044     IF CLIVESL     GREATER THAN ZEROS
 14045        MOVE WS-CLIVES           TO PB-C-LIVES
 14046     ELSE
 14047        MOVE ZEROS               TO PB-C-LIVES.
 14048
 14049     IF CPAYEEL     GREATER THAN ZEROS
 14050        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14051
 14052     IF CFORCEL     GREATER THAN ZEROS
 14053        MOVE CFORCEI             TO PB-FORCE-CODE.
 14054
 14055     IF CBILCDL     GREATER THAN ZEROS
 14056        MOVE CBILCDI             TO PB-RECORD-BILL.
 14057
 14058*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14059
 14060 2260-WRITE-PB-RECORD.
 14061     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14062                                    PB-INPUT-BY.
 14063     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14064     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14065                                    PB-INPUT-DT.
 14066
 14067     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14068     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14069                                    PB-CONTROL-BY-ORIG-BATCH.
 14070
 14071     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14072     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14073     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14074     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14075     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14076
 14077     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 260
* EL6311.cbl
 14078
 14079     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14080
 14081     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14082     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14083     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14084
 14085     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14086     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14087
 14088 2275-WRITE-PENDING-BUSINESS.
 14089     MOVE 'A'                    TO JP-RECORD-TYPE.
 14090     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14091     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14092     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14093
 14094
 14095* EXEC CICS HANDLE CONDITION
 14096*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14097*    END-EXEC.
 14098*    MOVE '"$%                   ! 2 #00012717' TO DFHEIV0
 14099     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14101     MOVE X'3220233030303132373137' TO DFHEIV0(25:11)
 14102     CALL 'kxdfhei1' USING DFHEIV0
 14103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14104
 14105
 14106
 14107* EXEC CICS WRITE
 14108*        DATASET (FILE-ID-ERPNDB)
 14109*        FROM    (PENDING-BUSINESS)
 14110*        RIDFLD  (PB-CONTROL-PRIMARY)
 14111*    END-EXEC.
 14112     MOVE LENGTH OF
 14113      PENDING-BUSINESS
 14114       TO DFHEIV11
 14115*    MOVE '&$ L                  ''   #00012721' TO DFHEIV0
 14116     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14117     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14118     MOVE X'2020233030303132373231' TO DFHEIV0(25:11)
 14119     CALL 'kxdfhei1' USING DFHEIV0,
 14120           FILE-ID-ERPNDB,
 14121           PENDING-BUSINESS,
 14122           DFHEIV11,
 14123           PB-CONTROL-PRIMARY,
 14124           DFHEIV99,
 14125           DFHEIV99
 14126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14127
 14128
 14129     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14130
 14131     PERFORM 8400-LOG-JOURNAL-RECORD.
 14132
 14133******************************************************************
 14134*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14135******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 261
* EL6311.cbl
 14136
 14137     display ' made it to add orig CANCEL cert '
 14138     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14139     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14140     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14141     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14142
 14143
 14144* EXEC CICS READ
 14145*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14146*        DATASET (FILE-ID-ELCERT)
 14147*        RIDFLD  (ELCERT-KEY)
 14148*        RESP    (WS-RESPONSE)
 14149*    END-EXEC.
 14150*    MOVE '&"S        E          (  N#00012741' TO DFHEIV0
 14151     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14152     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14153     MOVE X'204E233030303132373431' TO DFHEIV0(25:11)
 14154     CALL 'kxdfhei1' USING DFHEIV0,
 14155           FILE-ID-ELCERT,
 14156           DFHEIV20,
 14157           DFHEIV99,
 14158           ELCERT-KEY,
 14159           DFHEIV99,
 14160           DFHEIV99,
 14161           DFHEIV99
 14162     SET ADDRESS OF CERTIFICATE-MASTER TO
 14163         DFHEIV20
 14164     MOVE EIBRESP  TO WS-RESPONSE
 14165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14166
 14167
 14168     IF NOT RESP-NORMAL
 14169        GO TO 2276-BYPASS-CRTO
 14170     END-IF
 14171
 14172     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14173     MOVE ' '                    TO WS-ERMAIL-SW
 14174
 14175
 14176* EXEC CICS READ
 14177*       DATASET   (FILE-ID-ERMAIL)
 14178*       SET       (ADDRESS OF MAILING-DATA)
 14179*       RIDFLD    (ERMAIL-KEY)
 14180*       RESP      (WS-RESPONSE)
 14181*    END-EXEC
 14182*    MOVE '&"S        E          (  N#00012755' TO DFHEIV0
 14183     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14184     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14185     MOVE X'204E233030303132373535' TO DFHEIV0(25:11)
 14186     CALL 'kxdfhei1' USING DFHEIV0,
 14187           FILE-ID-ERMAIL,
 14188           DFHEIV20,
 14189           DFHEIV99,
 14190           ERMAIL-KEY,
 14191           DFHEIV99,
 14192           DFHEIV99,
 14193           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 262
* EL6311.cbl
 14194     SET ADDRESS OF MAILING-DATA TO
 14195         DFHEIV20
 14196     MOVE EIBRESP  TO WS-RESPONSE
 14197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14198
 14199     IF RESP-NORMAL
 14200        SET ERMAIL-FOUND TO TRUE
 14201     END-IF
 14202
 14203     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 14204     MOVE 'OC'                   TO OC-RECORD-ID
 14205     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14206                                 TO OC-CONTROL-PRIMARY (1:33)
 14207     MOVE 'I'                    TO OC-RECORD-TYPE
 14208     MOVE +4096                  TO OC-KEY-SEQ-NO
 14209     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 14210     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 14211     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 14212
 14213     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 14214     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 14215     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 14216     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 14217     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 14218     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 14219     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 14220     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 14221     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 14222     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 14223     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 14224     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 14225     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 14226     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 14227     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 14228     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 14229     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 14230     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 14231     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 14232     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 14233     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 14234     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 14235     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 14236     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 14237     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 14238     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 14239     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 14240     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 14241     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 14242     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 14243
 14244     IF ERMAIL-FOUND
 14245        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 14246     END-IF
 14247     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 14248     .
 14249 2275-WRITE-ELCRTO.
 14250
 14251
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 263
* EL6311.cbl
 14252* EXEC CICS WRITE
 14253*       DATASET   ('ELCRTO')
 14254*       FROM      (ORIGINAL-CERTIFICATE)
 14255*       RIDFLD    (OC-CONTROL-PRIMARY)
 14256*       RESP      (WS-RESPONSE)
 14257*    END-EXEC
 14258     MOVE LENGTH OF
 14259      ORIGINAL-CERTIFICATE
 14260       TO DFHEIV11
 14261     MOVE 'ELCRTO' TO DFHEIV1
 14262*    MOVE '&$ L                  ''  N#00012814' TO DFHEIV0
 14263     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14264     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14265     MOVE X'204E233030303132383134' TO DFHEIV0(25:11)
 14266     CALL 'kxdfhei1' USING DFHEIV0,
 14267           DFHEIV1,
 14268           ORIGINAL-CERTIFICATE,
 14269           DFHEIV11,
 14270           OC-CONTROL-PRIMARY,
 14271           DFHEIV99,
 14272           DFHEIV99
 14273     MOVE EIBRESP  TO WS-RESPONSE
 14274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14275
 14276     display ' just wrote 2275 ' ws-response
 14277     IF RESP-DUPKEY
 14278        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 14279        GO TO 2275-WRITE-ELCRTO
 14280     ELSE
 14281        IF NOT RESP-NORMAL
 14282           MOVE -1               TO BMAINTL
 14283           MOVE ER-7450          TO EMI-ERROR
 14284           PERFORM 9900-ERROR-FORMAT
 14285                                 THRU 9900-EXIT
 14286           GO TO 8200-SEND-DATAONLY
 14287        END-IF
 14288     END-IF.
 14289
 14290 2276-BYPASS-CRTO.
 14291******************************************************************
 14292*       U P D A T E   T H E   B A T C H   H E A D E R            *
 14293******************************************************************
 14294
 14295
 14296* EXEC CICS READ
 14297*        INTO    (PENDING-BUSINESS)
 14298*        DATASET (FILE-ID-ERPNDB)
 14299*        RIDFLD  (ERPNDB-KEY)
 14300*        UPDATE
 14301*    END-EXEC.
 14302     MOVE LENGTH OF
 14303      PENDING-BUSINESS
 14304       TO DFHEIV11
 14305*    MOVE '&"IL       EU         (   #00012840' TO DFHEIV0
 14306     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14307     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14308     MOVE X'2020233030303132383430' TO DFHEIV0(25:11)
 14309     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 264
* EL6311.cbl
 14310           FILE-ID-ERPNDB,
 14311           PENDING-BUSINESS,
 14312           DFHEIV11,
 14313           ERPNDB-KEY,
 14314           DFHEIV99,
 14315           DFHEIV99,
 14316           DFHEIV99
 14317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14318
 14319
 14320     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14321     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14322     MOVE 'B'                    TO JP-RECORD-TYPE.
 14323     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14324
 14325     PERFORM 8400-LOG-JOURNAL-RECORD.
 14326
 14327     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 14328
 14329
 14330* EXEC CICS REWRITE
 14331*        DATASET (FILE-ID-ERPNDB)
 14332*        FROM    (PENDING-BUSINESS)
 14333*    END-EXEC.
 14334     MOVE LENGTH OF
 14335      PENDING-BUSINESS
 14336       TO DFHEIV11
 14337*    MOVE '&& L                  %   #00012856' TO DFHEIV0
 14338     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14339     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14340     MOVE X'2020233030303132383536' TO DFHEIV0(25:11)
 14341     CALL 'kxdfhei1' USING DFHEIV0,
 14342           FILE-ID-ERPNDB,
 14343           PENDING-BUSINESS,
 14344           DFHEIV11,
 14345           DFHEIV99
 14346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14347
 14348
 14349     MOVE 'C'                    TO JP-RECORD-TYPE.
 14350     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14351
 14352     PERFORM 8400-LOG-JOURNAL-RECORD.
 14353
 14354     IF WS-ERRORS-PRESENT
 14355        GO TO 3900-RE-DISPLAY-RECORD.
 14356
 14357     MOVE ZEROS                  TO EMI-ERROR.
 14358     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14359     MOVE LOW-VALUES             TO EL631CI.
 14360     MOVE  -1                    TO CMAINTL.
 14361     GO TO 8100-SEND-INITIAL-MAP.
 14362
 14363 2280-BATCH-HDR-NOT-FOUND.
 14364     MOVE -1                     TO BMAINTL.
 14365     MOVE ER-7450                TO EMI-ERROR.
 14366     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14367     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 265
* EL6311.cbl
 14368
 14369 2290-DUPLICATE-ALT-INDEX.
 14370
 14371******************************************************************
 14372*                                                                *
 14373*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 14374*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 14375*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 14376*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 14377*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 14378*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 14379*                                                                *
 14380******************************************************************
 14381
 14382     IF LCP-ONCTR-02 =  0
 14383         ADD 1 TO LCP-ONCTR-02
 14384        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 14385
 14386     ADD +1                      TO WS-SEQ-NO-COUNTER.
 14387
 14388     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 14389         NEXT SENTENCE
 14390     ELSE
 14391         ADD +1 TO PB-BATCH-SEQ-NO
 14392                   PB-CSR-BATCH-SEQ-NO
 14393         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 14394         GO TO 2275-WRITE-PENDING-BUSINESS.
 14395
 14396     MOVE -1                     TO CCERTNOL.
 14397     MOVE AL-UABON               TO CCERTNOA.
 14398     MOVE AL-UNBON               TO CEFFDTA.
 14399
 14400     MOVE 1                      TO EMI-SUB
 14401                                    EMI-SWITCH1
 14402                                    EMI-SWITCH-AREA-1
 14403                                    EMI-SWITCH-AREA-2.
 14404
 14405     MOVE SPACES                 TO EMI-ERROR-LINES.
 14406
 14407
 14408* EXEC CICS SYNCPOINT ROLLBACK
 14409*    END-EXEC.
 14410*    MOVE '6"R                   !   #00012919' TO DFHEIV0
 14411     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14412     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14413     MOVE X'2020233030303132393139' TO DFHEIV0(25:11)
 14414     CALL 'kxdfhei1' USING DFHEIV0
 14415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14416
 14417
 14418     MOVE ER-2247                TO EMI-ERROR.
 14419     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14420     GO TO 8200-SEND-DATAONLY.
 14421
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 266
* EL6311.cbl
 14423
 14424******************************************************************
 14425*                                                                *
 14426*          C H A N G E   C A N C E L   R O U T I N E             *
 14427*                                                                *
 14428******************************************************************
 14429
 14430***************************************************************
 14431*                                                             *
 14432*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 14433*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 14434*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 14435*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 14436*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 14437*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 14438*     5. LINK TO THE EDIT ROUTINE.                            *
 14439*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 14440*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 14441*              THE EDIT ROUTINE.                              *
 14442*     7. REWRITE THE NEW ISSUE                                *
 14443*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 14444*                                                             *
 14445***************************************************************
 14446 2300-CHANGE-CANCEL-ROUTINE.
 14447     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 14448
 14449     IF CCHGL NOT = ZEROS
 14450        MOVE ER-2196             TO EMI-ERROR
 14451        MOVE AL-UABON            TO CMAINTA
 14452        MOVE -1                  TO CMAINTL
 14453        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14454        GO TO 8200-SEND-DATAONLY.
 14455
 14456     MOVE CCERTNOI               TO WS-NEW-PRIME.
 14457
 14458     IF CSUFIXL NOT = ZEROS
 14459        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 14460     ELSE
 14461        MOVE SPACE               TO WS-NEW-SUFFIX.
 14462
 14463     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14464     PERFORM 8600-DEEDIT.
 14465     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14466     MOVE '4'                    TO DC-OPTION-CODE.
 14467
 14468     PERFORM 9700-DATE-LINK.
 14469
 14470     IF DATE-CONVERSION-ERROR
 14471        MOVE ER-0348             TO EMI-ERROR
 14472        MOVE -1                  TO CEFFDTL
 14473        MOVE AL-UABON            TO CEFFDTA
 14474        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14475        GO TO 8200-SEND-DATAONLY
 14476     ELSE
 14477        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14478        MOVE AL-UANON            TO CEFFDTA
 14479        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14480
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 267
* EL6311.cbl
 14481 2325-PROCESS-CANCEL-CHANGES.
 14482
 14483* EXEC CICS HANDLE CONDITION
 14484*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 14485*    END-EXEC.
 14486*    MOVE '"$I                   ! 3 #00012986' TO DFHEIV0
 14487     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14488     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14489     MOVE X'3320233030303132393836' TO DFHEIV0(25:11)
 14490     CALL 'kxdfhei1' USING DFHEIV0
 14491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14492
 14493
 14494     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 14495     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14496     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14497
 14498
 14499* EXEC CICS GETMAIN
 14500*        SET      (ADDRESS OF PENDING-BUSINESS)
 14501*        LENGTH   (ERPNDB-RECORD-LENGTH)
 14502*        INITIMG  (GETMAIN-SPACE)
 14503*     END-EXEC.
 14504*    MOVE ',"IL                  $   #00012994' TO DFHEIV0
 14505     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14506     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14507     MOVE X'2020233030303132393934' TO DFHEIV0(25:11)
 14508     CALL 'kxdfhei1' USING DFHEIV0,
 14509           DFHEIV20,
 14510           ERPNDB-RECORD-LENGTH,
 14511           GETMAIN-SPACE
 14512     SET ADDRESS OF PENDING-BUSINESS TO
 14513         DFHEIV20
 14514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14515
 14516
 14517
 14518* EXEC CICS READ
 14519*        INTO    (PENDING-BUSINESS)
 14520*        DATASET (FILE-ID-ERPNDB)
 14521*        RIDFLD  (ERPNDB-KEY)
 14522*    END-EXEC.
 14523     MOVE LENGTH OF
 14524      PENDING-BUSINESS
 14525       TO DFHEIV11
 14526*    MOVE '&"IL       E          (   #00013000' TO DFHEIV0
 14527     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14528     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14529     MOVE X'2020233030303133303030' TO DFHEIV0(25:11)
 14530     CALL 'kxdfhei1' USING DFHEIV0,
 14531           FILE-ID-ERPNDB,
 14532           PENDING-BUSINESS,
 14533           DFHEIV11,
 14534           ERPNDB-KEY,
 14535           DFHEIV99,
 14536           DFHEIV99,
 14537           DFHEIV99
 14538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 268
* EL6311.cbl
 14539
 14540
 14541     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14542
 14543
 14544* EXEC CICS HANDLE CONDITION
 14545*         NOTFND     (2385-REC-NOT-FOUND)
 14546*    END-EXEC.
 14547*    MOVE '"$I                   ! 4 #00013008' TO DFHEIV0
 14548     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14549     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14550     MOVE X'3420233030303133303038' TO DFHEIV0(25:11)
 14551     CALL 'kxdfhei1' USING DFHEIV0
 14552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14553
 14554
 14555**********************************************************
 14556*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 14557*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 14558**********************************************************
 14559
 14560
 14561* EXEC CICS READ
 14562*        DATASET (FILE-ID-ERPNDB)
 14563*        INTO    (PENDING-BUSINESS)
 14564*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 14565*    END-EXEC.
 14566     MOVE LENGTH OF
 14567      PENDING-BUSINESS
 14568       TO DFHEIV11
 14569*    MOVE '&"IL       E          (   #00013017' TO DFHEIV0
 14570     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14571     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14572     MOVE X'2020233030303133303137' TO DFHEIV0(25:11)
 14573     CALL 'kxdfhei1' USING DFHEIV0,
 14574           FILE-ID-ERPNDB,
 14575           PENDING-BUSINESS,
 14576           DFHEIV11,
 14577           PI-PREV-CONTROL-PRIMARY,
 14578           DFHEIV99,
 14579           DFHEIV99,
 14580           DFHEIV99
 14581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14582
 14583
 14584********** DO NOT ALLOW CHANGES IF THRU A/R
 14585     IF BMAINTI = 'C'
 14586         IF PB-EL860-INTERNAL-PROCESS
 14587             MOVE ER-4005          TO EMI-ERROR
 14588             MOVE -1               TO BMAINTL
 14589             MOVE AL-UABON         TO BMAINTA
 14590             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14591             GO TO 8200-SEND-DATAONLY.
 14592**********
 14593
 14594     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 14595        MOVE -1                 TO CMAINTL
 14596        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 269
* EL6311.cbl
 14597        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14598        GO TO 8200-SEND-DATAONLY.
 14599
 14600     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 14601        MOVE ER-2196             TO EMI-ERROR
 14602        MOVE AL-UABON            TO CMAINTA
 14603        MOVE -1                  TO CMAINTL
 14604        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14605        GO TO 8200-SEND-DATAONLY.
 14606     MOVE ZEROS                  TO WS-SEQ-SAVE.
 14607
 14608     IF PB-BILLED-DT = LOW-VALUES AND
 14609        PB-CHG-COUNT = ZEROS
 14610        NEXT SENTENCE
 14611     ELSE
 14612        IF (CREFND1L GREATER THAN ZEROS AND
 14613            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 14614           OR
 14615           (CREFND2L GREATER THAN ZEROS AND
 14616            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 14617           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 14618
 14619
 14620* EXEC CICS READ
 14621*        DATASET (FILE-ID-ERPNDB)
 14622*        INTO    (PENDING-BUSINESS)
 14623*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 14624*        UPDATE
 14625*    END-EXEC.
 14626     MOVE LENGTH OF
 14627      PENDING-BUSINESS
 14628       TO DFHEIV11
 14629*    MOVE '&"IL       EU         (   #00013058' TO DFHEIV0
 14630     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14631     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14632     MOVE X'2020233030303133303538' TO DFHEIV0(25:11)
 14633     CALL 'kxdfhei1' USING DFHEIV0,
 14634           FILE-ID-ERPNDB,
 14635           PENDING-BUSINESS,
 14636           DFHEIV11,
 14637           PI-PREV-CONTROL-PRIMARY,
 14638           DFHEIV99,
 14639           DFHEIV99,
 14640           DFHEIV99
 14641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14642
 14643
 14644     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14645     MOVE 'B'                    TO JP-RECORD-TYPE
 14646     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14647     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14648
 14649     PERFORM 8400-LOG-JOURNAL-RECORD.
 14650
 14651     IF PB-BILLED-DT NOT = LOW-VALUES OR
 14652          PB-CHG-COUNT NOT = ZEROS
 14653        IF (CREFND1L GREATER THAN ZEROS AND
 14654            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 270
* EL6311.cbl
 14655           OR
 14656           (CREFND2L GREATER THAN ZEROS AND
 14657            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 14658            ADD +1                      TO PB-CHG-COUNT
 14659            MOVE LOW-VALUES             TO PB-BILLED-DT.
 14660
 14661*    IF CMICRNOL  GREATER  ZEROS
 14662*        IF CMICRNOI  NUMERIC
 14663*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14664*            MOVE AL-UNNON       TO  CMICRNOA
 14665*        ELSE
 14666*            MOVE -1             TO  CMICRNOL
 14667*            MOVE AL-UNBON       TO  CMICRNOA
 14668*            MOVE ER-2701        TO  EMI-ERROR
 14669*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14670
 14671     IF CSUFIXL GREATER THAN ZEROS
 14672        MOVE CSUFIXI             TO PB-CERT-SFX.
 14673
 14674     IF CLSTNML GREATER THAN ZEROS
 14675         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 14676
 14677     IF CCANREAL > ZEROS
 14678        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14679     END-IF
 14680     IF CPCYNL > ZEROS
 14681        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14682     END-IF
 14683     IF CCANDT1L    GREATER THAN ZEROS
 14684        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14685
 14686     IF CCANDT2L    GREATER THAN ZEROS
 14687        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14688
 14689     IF CMTHD1L    GREATER THAN +0
 14690        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14691
 14692     IF CMTHD2L    GREATER THAN +0
 14693        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14694
 14695     IF CREFND1L    GREATER THAN ZEROS
 14696        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 14697        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14698        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14699        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 14700
 14701     IF CREFND2L    GREATER THAN ZEROS
 14702        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 14703        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14704        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14705        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 14706
 14707     IF CLIVESL     GREATER THAN ZEROS
 14708        MOVE WS-CLIVES           TO PB-C-LIVES.
 14709
 14710     IF CPAYEEL     GREATER THAN ZEROS
 14711        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14712
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 271
* EL6311.cbl
 14713     IF CFORCEL     GREATER THAN ZEROS
 14714        MOVE CFORCEI             TO PB-FORCE-CODE.
 14715
 14716     IF CBILCDL     GREATER THAN ZEROS
 14717        MOVE CBILCDI             TO PB-RECORD-BILL.
 14718
 14719 2360-REWRITE-PB-RECORD.
 14720     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 14721     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14722     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 14723     MOVE 'C'                    TO JP-RECORD-TYPE.
 14724     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14725     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14726     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14727
 14728     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14729
 14730     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 14731     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 14732
 14733     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 14734
 14735     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14736
 14737     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14738     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14739     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14740
 14741     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14742     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14743
 14744 2375-REWRITE-PENDING-BUSINESS.
 14745     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14746     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14747     MOVE 'C'                    TO JP-RECORD-TYPE.
 14748     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14749
 14750
 14751* EXEC CICS REWRITE
 14752*        DATASET (FILE-ID-ERPNDB)
 14753*        FROM    (PENDING-BUSINESS)
 14754*    END-EXEC.
 14755     MOVE LENGTH OF
 14756      PENDING-BUSINESS
 14757       TO DFHEIV11
 14758*    MOVE '&& L                  %   #00013171' TO DFHEIV0
 14759     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14760     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14761     MOVE X'2020233030303133313731' TO DFHEIV0(25:11)
 14762     CALL 'kxdfhei1' USING DFHEIV0,
 14763           FILE-ID-ERPNDB,
 14764           PENDING-BUSINESS,
 14765           DFHEIV11,
 14766           DFHEIV99
 14767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14768
 14769
 14770     PERFORM 8400-LOG-JOURNAL-RECORD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 272
* EL6311.cbl
 14771
 14772******************************************************************
 14773*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 14774******************************************************************
 14775
 14776     display ' made it to update orig cancel cert '
 14777
 14778     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14779     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14780     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14781     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14782
 14783
 14784* EXEC CICS READ
 14785*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14786*        DATASET (FILE-ID-ELCERT)
 14787*        RIDFLD  (ELCERT-KEY)
 14788*        RESP    (WS-RESPONSE)
 14789*    END-EXEC.
 14790*    MOVE '&"S        E          (  N#00013189' TO DFHEIV0
 14791     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14792     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14793     MOVE X'204E233030303133313839' TO DFHEIV0(25:11)
 14794     CALL 'kxdfhei1' USING DFHEIV0,
 14795           FILE-ID-ELCERT,
 14796           DFHEIV20,
 14797           DFHEIV99,
 14798           ELCERT-KEY,
 14799           DFHEIV99,
 14800           DFHEIV99,
 14801           DFHEIV99
 14802     SET ADDRESS OF CERTIFICATE-MASTER TO
 14803         DFHEIV20
 14804     MOVE EIBRESP  TO WS-RESPONSE
 14805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14806
 14807
 14808     IF NOT RESP-NORMAL
 14809        GO TO 2376-BYPASS-CRTO
 14810     END-IF
 14811
 14812
 14813     MOVE ELCERT-KEY             TO ERMAIL-KEY
 14814     MOVE ' '                    TO WS-ERMAIL-SW
 14815
 14816
 14817* EXEC CICS READ
 14818*       DATASET   (FILE-ID-ERMAIL)
 14819*       SET       (ADDRESS OF MAILING-DATA)
 14820*       RIDFLD    (ERMAIL-KEY)
 14821*       RESP      (WS-RESPONSE)
 14822*    END-EXEC
 14823*    MOVE '&"S        E          (  N#00013204' TO DFHEIV0
 14824     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14825     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14826     MOVE X'204E233030303133323034' TO DFHEIV0(25:11)
 14827     CALL 'kxdfhei1' USING DFHEIV0,
 14828           FILE-ID-ERMAIL,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 273
* EL6311.cbl
 14829           DFHEIV20,
 14830           DFHEIV99,
 14831           ERMAIL-KEY,
 14832           DFHEIV99,
 14833           DFHEIV99,
 14834           DFHEIV99
 14835     SET ADDRESS OF MAILING-DATA TO
 14836         DFHEIV20
 14837     MOVE EIBRESP  TO WS-RESPONSE
 14838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14839
 14840     IF RESP-NORMAL
 14841        SET ERMAIL-FOUND TO TRUE
 14842     END-IF
 14843
 14844     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 14845                                 TO ELCRTO-KEY
 14846     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 14847     MOVE +0                     TO ELCRTO-SEQ-NO
 14848
 14849
 14850* EXEC CICS READ
 14851*       DATASET   ('ELCRTO')
 14852*       INTO      (ORIGINAL-CERTIFICATE)
 14853*       RIDFLD    (ELCRTO-KEY)
 14854*       GTEQ
 14855*       RESP      (WS-RESPONSE)
 14856*    END-EXEC
 14857     MOVE LENGTH OF
 14858      ORIGINAL-CERTIFICATE
 14859       TO DFHEIV11
 14860     MOVE 'ELCRTO' TO DFHEIV1
 14861*    MOVE '&"IL       G          (  N#00013220' TO DFHEIV0
 14862     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 14863     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14864     MOVE X'204E233030303133323230' TO DFHEIV0(25:11)
 14865     CALL 'kxdfhei1' USING DFHEIV0,
 14866           DFHEIV1,
 14867           ORIGINAL-CERTIFICATE,
 14868           DFHEIV11,
 14869           ELCRTO-KEY,
 14870           DFHEIV99,
 14871           DFHEIV99,
 14872           DFHEIV99
 14873     MOVE EIBRESP  TO WS-RESPONSE
 14874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14875
 14876     display ' just read gteq ' ws-response
 14877     IF RESP-NORMAL
 14878        AND (OC-CONTROL-PRIMARY (1:33) =
 14879                 PB-CONTROL-BY-ACCOUNT (1:33))
 14880        AND (OC-RECORD-TYPE = 'I')
 14881        display ' resp norm, key =, type i '
 14882        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 14883           display ' end proc blank '
 14884           display ' csr edit session ' PI-CSR-SESSION-SW
 14885           IF NOT CSR-EDIT-SESSION
 14886
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 274
* EL6311.cbl
 14887* EXEC CICS READ
 14888*                DATASET   ('ELCRTO')
 14889*                INTO      (ORIGINAL-CERTIFICATE)
 14890*                RIDFLD    (OC-CONTROL-PRIMARY)
 14891*                UPDATE
 14892*                RESP      (WS-RESPONSE)
 14893*             END-EXEC
 14894     MOVE LENGTH OF
 14895      ORIGINAL-CERTIFICATE
 14896       TO DFHEIV11
 14897     MOVE 'ELCRTO' TO DFHEIV1
 14898*    MOVE '&"IL       EU         (  N#00013238' TO DFHEIV0
 14899     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14900     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14901     MOVE X'204E233030303133323338' TO DFHEIV0(25:11)
 14902     CALL 'kxdfhei1' USING DFHEIV0,
 14903           DFHEIV1,
 14904           ORIGINAL-CERTIFICATE,
 14905           DFHEIV11,
 14906           OC-CONTROL-PRIMARY,
 14907           DFHEIV99,
 14908           DFHEIV99,
 14909           DFHEIV99
 14910     MOVE EIBRESP  TO WS-RESPONSE
 14911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14912              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 14913              IF RESP-NORMAL
 14914                 display ' good read upd '
 14915                 MOVE CM-INSURED-LAST-NAME   TO
 14916                         OC-INS-LAST-NAME
 14917                 MOVE CM-INSURED-FIRST-NAME  TO
 14918                         OC-INS-FIRST-NAME
 14919                 MOVE CM-INSURED-INITIAL2    TO
 14920                         OC-INS-MIDDLE-INIT
 14921                 MOVE CM-INSURED-ISSUE-AGE   TO
 14922                         OC-INS-AGE
 14923                 MOVE CM-JT-LAST-NAME        TO
 14924                         OC-JNT-LAST-NAME
 14925                 MOVE CM-JT-FIRST-NAME       TO
 14926                         OC-JNT-FIRST-NAME
 14927                 MOVE CM-JT-INITIAL          TO
 14928                         OC-JNT-MIDDLE-INIT
 14929                 MOVE CM-INSURED-JOINT-AGE   TO
 14930                         OC-JNT-AGE
 14931                 MOVE CM-LF-BENEFIT-CD       TO
 14932                         OC-LF-BENCD
 14933                 MOVE CM-LF-ORIG-TERM        TO
 14934                         OC-LF-TERM
 14935                 MOVE CM-LF-BENEFIT-AMT      TO
 14936                         OC-LF-BEN-AMT
 14937                 MOVE CM-LF-PREMIUM-AMT      TO
 14938                         OC-LF-PRM-AMT
 14939                 MOVE CM-LF-ALT-BENEFIT-AMT  TO
 14940                         OC-LF-ALT-BEN-AMT
 14941                 MOVE CM-LF-ALT-PREMIUM-AMT  TO
 14942                         OC-LF-ALT-PRM-AMT
 14943                 MOVE CM-LF-LOAN-EXPIRE-DT   TO
 14944                         OC-LF-EXP-DT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 275
* EL6311.cbl
 14945                 MOVE CM-LIFE-COMM-PCT       TO
 14946                         OC-LF-COMM-PCT
 14947                 MOVE PB-C-LF-CANCEL-DT      TO
 14948                         OC-LF-CANCEL-DT
 14949                 MOVE PB-C-LF-CANCEL-AMT     TO
 14950                         OC-LF-CANCEL-AMT
 14951                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 14952                         OC-LF-ITD-CANCEL-AMT
 14953                 MOVE CM-AH-BENEFIT-CD       TO
 14954                         OC-AH-BENCD
 14955                 MOVE CM-AH-ORIG-TERM        TO
 14956                         OC-AH-TERM
 14957                 MOVE CM-AH-BENEFIT-AMT      TO
 14958                         OC-AH-BEN-AMT
 14959                 MOVE CM-AH-PREMIUM-AMT      TO
 14960                         OC-AH-PRM-AMT
 14961                 MOVE CM-AH-LOAN-EXPIRE-DT   TO
 14962                         OC-AH-EXP-DT
 14963                 MOVE CM-AH-COMM-PCT         TO
 14964                         OC-AH-COMM-PCT
 14965                 MOVE CM-AH-CRITICAL-PERIOD  TO
 14966                         OC-AH-CP
 14967                 MOVE PB-C-AH-CANCEL-DT      TO
 14968                         OC-AH-CANCEL-DT
 14969                 MOVE PB-C-AH-CANCEL-AMT     TO
 14970                         OC-AH-CANCEL-AMT
 14971                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 14972                         OC-AH-ITD-CANCEL-AMT
 14973                 MOVE CM-LOAN-1ST-PMT-DT     TO
 14974                         OC-1ST-PMT-DT
 14975                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 14976                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 14977                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 14978                 IF ERMAIL-FOUND
 14979                    MOVE MA-CRED-BENE-NAME
 14980                                 TO OC-CRED-BENE-NAME
 14981                 END-IF
 14982
 14983* EXEC CICS REWRITE
 14984*                   DATASET   ('ELCRTO')
 14985*                   FROM      (ORIGINAL-CERTIFICATE)
 14986*                   RESP      (WS-RESPONSE)
 14987*                END-EXEC
 14988     MOVE LENGTH OF
 14989      ORIGINAL-CERTIFICATE
 14990       TO DFHEIV11
 14991     MOVE 'ELCRTO' TO DFHEIV1
 14992*    MOVE '&& L                  %  N#00013315' TO DFHEIV0
 14993     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14994     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14995     MOVE X'204E233030303133333135' TO DFHEIV0(25:11)
 14996     CALL 'kxdfhei1' USING DFHEIV0,
 14997           DFHEIV1,
 14998           ORIGINAL-CERTIFICATE,
 14999           DFHEIV11,
 15000           DFHEIV99
 15001     MOVE EIBRESP  TO WS-RESPONSE
 15002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 276
* EL6311.cbl
 15003                 display ' just rewrote ' ws-response
 15004              END-IF
 15005           END-IF
 15006        ELSE
 15007           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15008           MOVE 'OC'             TO OC-RECORD-ID
 15009           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15010           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15011           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15012           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15013           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15014           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15015           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15016           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15017           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15018           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15019           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15020           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15021           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15022           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15023           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15024           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15025           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15026           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15027           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15028           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15029           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15030           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15031           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15032           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15033           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15034           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15035           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15036           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15037           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15038           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15039           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15040           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15041           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15042           IF ERMAIL-FOUND
 15043              MOVE MA-CRED-BENE-NAME
 15044                                 TO OC-CRED-BENE-NAME
 15045           END-IF
 15046           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15047
 15048* EXEC CICS WRITE
 15049*             DATASET   ('ELCRTO')
 15050*             FROM      (ORIGINAL-CERTIFICATE)
 15051*             RIDFLD    (OC-CONTROL-PRIMARY)
 15052*             RESP      (WS-RESPONSE)
 15053*          END-EXEC
 15054     MOVE LENGTH OF
 15055      ORIGINAL-CERTIFICATE
 15056       TO DFHEIV11
 15057     MOVE 'ELCRTO' TO DFHEIV1
 15058*    MOVE '&$ L                  ''  N#00013364' TO DFHEIV0
 15059     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15060     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 277
* EL6311.cbl
 15061     MOVE X'204E233030303133333634' TO DFHEIV0(25:11)
 15062     CALL 'kxdfhei1' USING DFHEIV0,
 15063           DFHEIV1,
 15064           ORIGINAL-CERTIFICATE,
 15065           DFHEIV11,
 15066           OC-CONTROL-PRIMARY,
 15067           DFHEIV99,
 15068           DFHEIV99
 15069     MOVE EIBRESP  TO WS-RESPONSE
 15070     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15071        END-IF
 15072     ELSE
 15073        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 15074        MOVE 'OC'                TO OC-RECORD-ID
 15075        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15076                                 TO OC-CONTROL-PRIMARY (1:33)
 15077        MOVE 'I'                 TO OC-RECORD-TYPE
 15078        MOVE +4096               TO OC-KEY-SEQ-NO
 15079        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 15080        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 15081        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 15082        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15083        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15084        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15085        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15086        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15087        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15088        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15089        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15090        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15091        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15092        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15093        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15094        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15095        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15096        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15097        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15098        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15099        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15100        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15101        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15102        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15103        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15104        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15105        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15106        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15107        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15108        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15109        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15110        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15111        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15112        IF ERMAIL-FOUND
 15113           MOVE MA-CRED-BENE-NAME
 15114                                 TO OC-CRED-BENE-NAME
 15115        END-IF
 15116        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 15117
 15118
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 278
* EL6311.cbl
 15119* EXEC CICS WRITE
 15120*          DATASET   ('ELCRTO')
 15121*          FROM      (ORIGINAL-CERTIFICATE)
 15122*          RIDFLD    (OC-CONTROL-PRIMARY)
 15123*          RESP      (WS-RESPONSE)
 15124*       END-EXEC
 15125     MOVE LENGTH OF
 15126      ORIGINAL-CERTIFICATE
 15127       TO DFHEIV11
 15128     MOVE 'ELCRTO' TO DFHEIV1
 15129*    MOVE '&$ L                  ''  N#00013417' TO DFHEIV0
 15130     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15131     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15132     MOVE X'204E233030303133343137' TO DFHEIV0(25:11)
 15133     CALL 'kxdfhei1' USING DFHEIV0,
 15134           DFHEIV1,
 15135           ORIGINAL-CERTIFICATE,
 15136           DFHEIV11,
 15137           OC-CONTROL-PRIMARY,
 15138           DFHEIV99,
 15139           DFHEIV99
 15140     MOVE EIBRESP  TO WS-RESPONSE
 15141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15142     END-IF.
 15143
 15144 2376-BYPASS-CRTO.
 15145******************************************************************
 15146*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15147******************************************************************
 15148
 15149
 15150* EXEC CICS HANDLE CONDITION
 15151*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15152*    END-EXEC.
 15153*    MOVE '"$I                   ! 5 #00013430' TO DFHEIV0
 15154     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15155     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15156     MOVE X'3520233030303133343330' TO DFHEIV0(25:11)
 15157     CALL 'kxdfhei1' USING DFHEIV0
 15158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15159
 15160
 15161
 15162* EXEC CICS READ
 15163*        INTO    (PENDING-BUSINESS)
 15164*        DATASET (FILE-ID-ERPNDB)
 15165*        RIDFLD  (ERPNDB-KEY)
 15166*        UPDATE
 15167*    END-EXEC.
 15168     MOVE LENGTH OF
 15169      PENDING-BUSINESS
 15170       TO DFHEIV11
 15171*    MOVE '&"IL       EU         (   #00013434' TO DFHEIV0
 15172     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15173     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15174     MOVE X'2020233030303133343334' TO DFHEIV0(25:11)
 15175     CALL 'kxdfhei1' USING DFHEIV0,
 15176           FILE-ID-ERPNDB,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 279
* EL6311.cbl
 15177           PENDING-BUSINESS,
 15178           DFHEIV11,
 15179           ERPNDB-KEY,
 15180           DFHEIV99,
 15181           DFHEIV99,
 15182           DFHEIV99
 15183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15184
 15185
 15186     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15187     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15188     MOVE 'B'                    TO JP-RECORD-TYPE.
 15189     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15190
 15191     PERFORM 8400-LOG-JOURNAL-RECORD.
 15192
 15193     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15194
 15195
 15196* EXEC CICS REWRITE
 15197*        DATASET (FILE-ID-ERPNDB)
 15198*        FROM    (PENDING-BUSINESS)
 15199*    END-EXEC.
 15200     MOVE LENGTH OF
 15201      PENDING-BUSINESS
 15202       TO DFHEIV11
 15203*    MOVE '&& L                  %   #00013450' TO DFHEIV0
 15204     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15205     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15206     MOVE X'2020233030303133343530' TO DFHEIV0(25:11)
 15207     CALL 'kxdfhei1' USING DFHEIV0,
 15208           FILE-ID-ERPNDB,
 15209           PENDING-BUSINESS,
 15210           DFHEIV11,
 15211           DFHEIV99
 15212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15213
 15214
 15215     MOVE 'C'                    TO JP-RECORD-TYPE.
 15216     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15217
 15218     PERFORM 8400-LOG-JOURNAL-RECORD.
 15219
 15220     IF WS-ERRORS-PRESENT
 15221         GO TO 3900-RE-DISPLAY-RECORD.
 15222
 15223     MOVE ZEROS                  TO EMI-ERROR
 15224     MOVE -1                     TO CMAINTL
 15225     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15226     GO TO 3900-RE-DISPLAY-RECORD.
 15227
 15228 2380-BATCH-HDR-NOT-FOUND.
 15229     MOVE -1                     TO BMAINTL.
 15230     MOVE ER-7450                TO EMI-ERROR.
 15231     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15232     GO TO 8200-SEND-DATAONLY.
 15233
 15234 2385-REC-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 280
* EL6311.cbl
 15235     MOVE -1                     TO BMAINTL.
 15236     MOVE ER-7451                TO EMI-ERROR.
 15237     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15238     GO TO 8200-SEND-DATAONLY.
 15239
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 281
* EL6311.cbl
 15241
 15242******************************************************************
 15243*                                                                *
 15244*          D E L E T E   C A N C E L   R O U T I N E             *
 15245*                                                                *
 15246******************************************************************
 15247
 15248 2400-DELETE-CANCEL-ROUTINE.
 15249     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 15250
 15251     IF CCHGL NOT = ZEROS
 15252        MOVE ER-2196             TO EMI-ERROR
 15253        MOVE AL-UABON            TO CMAINTA
 15254        MOVE -1                  TO CMAINTL
 15255        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15256        GO TO 8200-SEND-DATAONLY.
 15257
 15258
 15259* EXEC CICS HANDLE CONDITION
 15260*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15261*    END-EXEC.
 15262*    MOVE '"$I                   ! 6 #00013498' TO DFHEIV0
 15263     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15264     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15265     MOVE X'3620233030303133343938' TO DFHEIV0(25:11)
 15266     CALL 'kxdfhei1' USING DFHEIV0
 15267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15268
 15269
 15270     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15271     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15272     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15273
 15274
 15275* EXEC CICS READ
 15276*        SET     (ADDRESS OF PENDING-BUSINESS)
 15277*        DATASET (FILE-ID-ERPNDB)
 15278*        RIDFLD  (ERPNDB-KEY)
 15279*    END-EXEC.
 15280*    MOVE '&"S        E          (   #00013506' TO DFHEIV0
 15281     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15282     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15283     MOVE X'2020233030303133353036' TO DFHEIV0(25:11)
 15284     CALL 'kxdfhei1' USING DFHEIV0,
 15285           FILE-ID-ERPNDB,
 15286           DFHEIV20,
 15287           DFHEIV99,
 15288           ERPNDB-KEY,
 15289           DFHEIV99,
 15290           DFHEIV99,
 15291           DFHEIV99
 15292     SET ADDRESS OF PENDING-BUSINESS TO
 15293         DFHEIV20
 15294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15295
 15296
 15297     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15298
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 282
* EL6311.cbl
 15299     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15300
 15301     IF CSUFIXL NOT = ZEROS
 15302        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15303     ELSE
 15304        MOVE SPACE               TO WS-NEW-SUFFIX.
 15305
 15306     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15307
 15308     PERFORM 8600-DEEDIT.
 15309     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15310     MOVE '4'                    TO DC-OPTION-CODE.
 15311     PERFORM 9700-DATE-LINK.
 15312
 15313     IF DATE-CONVERSION-ERROR
 15314        MOVE ER-0348             TO EMI-ERROR
 15315        MOVE -1                  TO CEFFDTL
 15316        MOVE AL-UABON            TO CEFFDTA
 15317        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15318        GO TO 8200-SEND-DATAONLY
 15319     ELSE
 15320        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15321        MOVE AL-UANON            TO CEFFDTA
 15322        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15323
 15324
 15325* EXEC CICS HANDLE CONDITION
 15326*         NOTFND    (2490-RECORD-NOT-FOUND)
 15327*    END-EXEC.
 15328*    MOVE '"$I                   ! 7 #00013539' TO DFHEIV0
 15329     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15330     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15331     MOVE X'3720233030303133353339' TO DFHEIV0(25:11)
 15332     CALL 'kxdfhei1' USING DFHEIV0
 15333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15334
 15335
 15336
 15337* EXEC CICS READ
 15338*        SET     (ADDRESS OF PENDING-BUSINESS)
 15339*        DATASET (FILE-ID-ERPNDB)
 15340*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15341*        UPDATE
 15342*    END-EXEC.
 15343*    MOVE '&"S        EU         (   #00013543' TO DFHEIV0
 15344     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15345     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15346     MOVE X'2020233030303133353433' TO DFHEIV0(25:11)
 15347     CALL 'kxdfhei1' USING DFHEIV0,
 15348           FILE-ID-ERPNDB,
 15349           DFHEIV20,
 15350           DFHEIV99,
 15351           PI-PREV-CONTROL-PRIMARY,
 15352           DFHEIV99,
 15353           DFHEIV99,
 15354           DFHEIV99
 15355     SET ADDRESS OF PENDING-BUSINESS TO
 15356         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 283
* EL6311.cbl
 15357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15358
 15359
 15360     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15361        MOVE -1                 TO CMAINTL
 15362        MOVE ER-2197            TO EMI-ERROR
 15363        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15364        GO TO 8200-SEND-DATAONLY.
 15365
 15366     IF PB-BILLED-DT NOT = LOW-VALUES
 15367        MOVE -1                 TO CMAINTL
 15368        MOVE ER-2129            TO EMI-ERROR
 15369        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15370        GO TO 8200-SEND-DATAONLY.
 15371
 15372     IF PB-CHG-COUNT NOT = ZEROS
 15373        MOVE ER-2336            TO EMI-ERROR
 15374        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15375        MOVE AL-UABON            TO CMAINTA
 15376        MOVE -1                  TO CMAINTL
 15377        GO TO 8200-SEND-DATAONLY.
 15378
 15379     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 15380        PB-CHG-COUNT NOT = ZEROS
 15381        MOVE ER-2196             TO EMI-ERROR
 15382        MOVE AL-UABON            TO CMAINTA
 15383        MOVE -1                  TO CMAINTL
 15384        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15385        GO TO 8200-SEND-DATAONLY.
 15386
 15387     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 15388        MOVE ER-2900 TO EMI-ERROR
 15389        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15390        MOVE AL-UABON         TO CMAINTA
 15391        MOVE -1               TO CMAINTL
 15392        GO TO 8200-SEND-DATAONLY.
 15393
 15394
 15395* EXEC CICS HANDLE CONDITION
 15396*         NOTFND  (2475-CONTINUE-DELETE)
 15397*    END-EXEC
 15398*    MOVE '"$I                   ! 8 #00013584' TO DFHEIV0
 15399     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15401     MOVE X'3820233030303133353834' TO DFHEIV0(25:11)
 15402     CALL 'kxdfhei1' USING DFHEIV0
 15403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15404
 15405     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15406     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15407     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15408     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15409
 15410
 15411* EXEC CICS READ
 15412*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15413*        DATASET (FILE-ID-ELCERT)
 15414*        RIDFLD  (ELCERT-KEY)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 284
* EL6311.cbl
 15415*        UPDATE
 15416*    END-EXEC.
 15417*    MOVE '&"S        EU         (   #00013593' TO DFHEIV0
 15418     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15419     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15420     MOVE X'2020233030303133353933' TO DFHEIV0(25:11)
 15421     CALL 'kxdfhei1' USING DFHEIV0,
 15422           FILE-ID-ELCERT,
 15423           DFHEIV20,
 15424           DFHEIV99,
 15425           ELCERT-KEY,
 15426           DFHEIV99,
 15427           DFHEIV99,
 15428           DFHEIV99
 15429     SET ADDRESS OF CERTIFICATE-MASTER TO
 15430         DFHEIV20
 15431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15432
 15433
 15434     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15435
 15436     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 15437     MOVE 'B'                    TO JP-RECORD-TYPE.
 15438     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 15439     PERFORM 8400-LOG-JOURNAL-RECORD.
 15440
 15441     IF PB-CI-LIVES NOT NUMERIC
 15442         MOVE ZERO                    TO PB-CI-LIVES.
 15443
 15444     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15445        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15446           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15447           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 15448           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 15449                                            CM-LF-CANCEL-DT
 15450           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 15451        ELSE
 15452           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15453           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 15454           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 15455           MOVE PB-CI-LIVES              TO CM-LIVES.
 15456
 15457     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 15458        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 15459           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15460               MOVE CM-LF-STATUS-AT-CANCEL
 15461                                        TO CM-LF-CURRENT-STATUS
 15462               MOVE SPACE
 15463                                        TO CM-LF-STATUS-AT-CANCEL
 15464           ELSE
 15465               MOVE PB-CI-LF-POLICY-STATUS
 15466                                        TO CM-LF-CURRENT-STATUS
 15467        ELSE
 15468           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 15469
 15470
 15471     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15472        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 285
* EL6311.cbl
 15473           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15474           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 15475           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 15476                                            CM-AH-CANCEL-DT
 15477           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 15478        ELSE
 15479           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 15480           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 15481           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 15482           MOVE PB-CI-LIVES              TO CM-LIVES.
 15483
 15484     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 15485        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 15486           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 15487               MOVE CM-AH-STATUS-AT-CANCEL
 15488                                        TO CM-AH-CURRENT-STATUS
 15489               MOVE SPACE
 15490                                        TO CM-AH-STATUS-AT-CANCEL
 15491           ELSE
 15492               MOVE PB-CI-AH-POLICY-STATUS
 15493                                        TO CM-AH-CURRENT-STATUS
 15494        ELSE
 15495           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 15496
 15497 2450-REWRITE-CERT.
 15498     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 15499     MOVE 'C'                      TO JP-RECORD-TYPE.
 15500     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 15501
 15502
 15503* EXEC CICS REWRITE
 15504*        DATASET  (FILE-ID-ELCERT)
 15505*        FROM     (CERTIFICATE-MASTER)
 15506*    END-EXEC.
 15507     MOVE LENGTH OF
 15508      CERTIFICATE-MASTER
 15509       TO DFHEIV11
 15510*    MOVE '&& L                  %   #00013668' TO DFHEIV0
 15511     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15512     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15513     MOVE X'2020233030303133363638' TO DFHEIV0(25:11)
 15514     CALL 'kxdfhei1' USING DFHEIV0,
 15515           FILE-ID-ELCERT,
 15516           CERTIFICATE-MASTER,
 15517           DFHEIV11,
 15518           DFHEIV99
 15519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15520
 15521
 15522     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 15523
 15524     PERFORM 8400-LOG-JOURNAL-RECORD.
 15525
 15526 2475-CONTINUE-DELETE.
 15527     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 15528     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 15529
 15530     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 286
* EL6311.cbl
 15531     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 15532
 15533     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 15534
 15535     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 15536     MOVE 'D'                    TO JP-RECORD-TYPE
 15537     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15538
 15539
 15540* EXEC CICS DELETE
 15541*        DATASET    (FILE-ID-ERPNDB)
 15542*    END-EXEC.
 15543*    MOVE '&(                    &   #00013690' TO DFHEIV0
 15544     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15545     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15546     MOVE X'2020233030303133363930' TO DFHEIV0(25:11)
 15547     CALL 'kxdfhei1' USING DFHEIV0,
 15548           FILE-ID-ERPNDB,
 15549           DFHEIV99,
 15550           DFHEIV99,
 15551           DFHEIV99,
 15552           DFHEIV99
 15553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15554
 15555
 15556     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15557
 15558     PERFORM 8400-LOG-JOURNAL-RECORD.
 15559
 15560     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15561     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15562
 15563
 15564* EXEC CICS HANDLE CONDITION
 15565*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 15566*    END-EXEC.
 15567*    MOVE '"$I                   ! 9 #00013701' TO DFHEIV0
 15568     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15570     MOVE X'3920233030303133373031' TO DFHEIV0(25:11)
 15571     CALL 'kxdfhei1' USING DFHEIV0
 15572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15573
 15574
 15575
 15576* EXEC CICS READ
 15577*        SET     (ADDRESS OF PENDING-BUSINESS)
 15578*        DATASET (FILE-ID-ERPNDB)
 15579*        RIDFLD  (ERPNDB-KEY)
 15580*        UPDATE
 15581*    END-EXEC.
 15582*    MOVE '&"S        EU         (   #00013705' TO DFHEIV0
 15583     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15584     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15585     MOVE X'2020233030303133373035' TO DFHEIV0(25:11)
 15586     CALL 'kxdfhei1' USING DFHEIV0,
 15587           FILE-ID-ERPNDB,
 15588           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 287
* EL6311.cbl
 15589           DFHEIV99,
 15590           ERPNDB-KEY,
 15591           DFHEIV99,
 15592           DFHEIV99,
 15593           DFHEIV99
 15594     SET ADDRESS OF PENDING-BUSINESS TO
 15595         DFHEIV20
 15596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15597
 15598
 15599     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 15600     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 15601
 15602     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 15603        WS-B-CANCEL-CNT-ENTERED = ZEROS
 15604        MOVE 'D'                 TO JP-RECORD-TYPE
 15605        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 15606
 15607* EXEC CICS DELETE
 15608*            DATASET    (FILE-ID-ERPNDB)
 15609*       END-EXEC
 15610*    MOVE '&(                    &   #00013719' TO DFHEIV0
 15611     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15612     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15613     MOVE X'2020233030303133373139' TO DFHEIV0(25:11)
 15614     CALL 'kxdfhei1' USING DFHEIV0,
 15615           FILE-ID-ERPNDB,
 15616           DFHEIV99,
 15617           DFHEIV99,
 15618           DFHEIV99,
 15619           DFHEIV99
 15620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15621        PERFORM 8400-LOG-JOURNAL-RECORD
 15622     ELSE
 15623        MOVE 'B'                 TO JP-RECORD-TYPE
 15624        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 15625        PERFORM 8400-LOG-JOURNAL-RECORD
 15626        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 15627        MOVE 'C'                 TO JP-RECORD-TYPE
 15628        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 15629
 15630* EXEC CICS REWRITE
 15631*            DATASET    (FILE-ID-ERPNDB)
 15632*            FROM       (PENDING-BUSINESS)
 15633*       END-EXEC
 15634     MOVE LENGTH OF
 15635      PENDING-BUSINESS
 15636       TO DFHEIV11
 15637*    MOVE '&& L                  %   #00013730' TO DFHEIV0
 15638     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15639     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15640     MOVE X'2020233030303133373330' TO DFHEIV0(25:11)
 15641     CALL 'kxdfhei1' USING DFHEIV0,
 15642           FILE-ID-ERPNDB,
 15643           PENDING-BUSINESS,
 15644           DFHEIV11,
 15645           DFHEIV99
 15646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 288
* EL6311.cbl
 15647        PERFORM 8400-LOG-JOURNAL-RECORD.
 15648
 15649******************************************************************
 15650*                                                                *
 15651*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 15652*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 15653*                                                                *
 15654******************************************************************
 15655
 15656     IF NOT PI-AR-PROCESSING
 15657        GO TO 2480-DELETE-FINISHED.
 15658
 15659     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 15660        WS-B-CANCEL-CNT-ENTERED = ZEROS
 15661        NEXT SENTENCE
 15662     ELSE
 15663        GO TO 2480-DELETE-FINISHED.
 15664
 15665
 15666* EXEC CICS HANDLE CONDITION
 15667*         NOTFND    (2480-DELETE-FINISHED)
 15668*    END-EXEC.
 15669*    MOVE '"$I                   ! : #00013752' TO DFHEIV0
 15670     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15671     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15672     MOVE X'3A20233030303133373532' TO DFHEIV0(25:11)
 15673     CALL 'kxdfhei1' USING DFHEIV0
 15674     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15675
 15676
 15677     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 15678     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 15679
 15680
 15681* EXEC CICS READ
 15682*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 15683*        DATASET (FILE-ID-ERRQST)
 15684*        RIDFLD  (ERRQST-KEY)
 15685*        UPDATE
 15686*    END-EXEC.
 15687*    MOVE '&"S        EU         (   #00013759' TO DFHEIV0
 15688     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15689     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15690     MOVE X'2020233030303133373539' TO DFHEIV0(25:11)
 15691     CALL 'kxdfhei1' USING DFHEIV0,
 15692           FILE-ID-ERRQST,
 15693           DFHEIV20,
 15694           DFHEIV99,
 15695           ERRQST-KEY,
 15696           DFHEIV99,
 15697           DFHEIV99,
 15698           DFHEIV99
 15699     SET ADDRESS OF AR-REQUEST-RECORD TO
 15700         DFHEIV20
 15701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15702
 15703
 15704     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 289
* EL6311.cbl
 15705
 15706     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 15707
 15708     MOVE 'D'                      TO JP-RECORD-TYPE.
 15709     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 15710
 15711
 15712* EXEC CICS DELETE
 15713*         DATASET    (FILE-ID-ERRQST)
 15714*    END-EXEC.
 15715*    MOVE '&(                    &   #00013773' TO DFHEIV0
 15716     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15717     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15718     MOVE X'2020233030303133373733' TO DFHEIV0(25:11)
 15719     CALL 'kxdfhei1' USING DFHEIV0,
 15720           FILE-ID-ERRQST,
 15721           DFHEIV99,
 15722           DFHEIV99,
 15723           DFHEIV99,
 15724           DFHEIV99
 15725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15726
 15727
 15728     PERFORM 8400-LOG-JOURNAL-RECORD.
 15729
 15730 2480-DELETE-FINISHED.
 15731     MOVE ZEROS                  TO EMI-ERROR.
 15732     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15733     MOVE LOW-VALUES             TO EL631CI.
 15734     MOVE -1                     TO CMAINTL.
 15735     GO TO 8100-SEND-INITIAL-MAP.
 15736
 15737 2485-BATCH-HDR-NOT-FOUND.
 15738     MOVE -1                     TO CMAINTL
 15739     MOVE AL-UABON               TO CMAINTA.
 15740     MOVE ER-7450                TO EMI-ERROR.
 15741     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15742     GO TO 8200-SEND-DATAONLY.
 15743
 15744 2490-RECORD-NOT-FOUND.
 15745     MOVE -1                     TO CMAINTL
 15746     MOVE AL-UABON               TO CMAINTA.
 15747     MOVE ER-7451                TO EMI-ERROR.
 15748     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15749     GO TO 8200-SEND-DATAONLY.
 15750
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 290
* EL6311.cbl
 15752
 15753***************************************************************
 15754*                                                             *
 15755*       B U I L D   C O R R E C T I O N   R E C O R D         *
 15756*                                                             *
 15757***************************************************************
 15758
 15759***************************************************************
 15760*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 15761*     AN ALREADY BILLED RECORD.                               *
 15762***************************************************************
 15763
 15764 2700-BUILD-CORRECTION-RECORD.
 15765     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15766     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15767     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 15768     MOVE '5'                    TO DC-OPTION-CODE.
 15769     PERFORM 9700-DATE-LINK.
 15770     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 15771
 15772     IF PB-CHG-COUNT = ZEROS
 15773        MOVE +1                  TO WS-SEQ-SAVE
 15774     ELSE
 15775        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 15776
 15777     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 15778     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 15779
 15780     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 15781
 15782     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 15783     MOVE 'A'                    TO JP-RECORD-TYPE.
 15784     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15785
 15786
 15787* EXEC CICS WRITE
 15788*        DATASET    (FILE-ID-ERPNDB)
 15789*        FROM       (PENDING-BUSINESS)
 15790*        RIDFLD     (PB-CONTROL-PRIMARY)
 15791*    END-EXEC.
 15792     MOVE LENGTH OF
 15793      PENDING-BUSINESS
 15794       TO DFHEIV11
 15795*    MOVE '&$ L                  ''   #00013835' TO DFHEIV0
 15796     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15797     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15798     MOVE X'2020233030303133383335' TO DFHEIV0(25:11)
 15799     CALL 'kxdfhei1' USING DFHEIV0,
 15800           FILE-ID-ERPNDB,
 15801           PENDING-BUSINESS,
 15802           DFHEIV11,
 15803           PB-CONTROL-PRIMARY,
 15804           DFHEIV99,
 15805           DFHEIV99
 15806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15807
 15808
 15809     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 291
* EL6311.cbl
 15810
 15811     PERFORM 8400-LOG-JOURNAL-RECORD.
 15812
 15813 2799-EXIT.
 15814      EXIT.
 15815
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 292
* EL6311.cbl
 15817
 15818******************************************************************
 15819*                                                                *
 15820*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 15821*                                                                *
 15822******************************************************************
 15823
 15824 2800-REWRITE-ISSUE-CERT-KEY.
 15825     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 15826
 15827     IF  BCERTNOL GREATER THAN ZEROS
 15828         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 15829
 15830     IF  BSUFIXL  GREATER THAN ZEROS
 15831         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 15832
 15833     IF  BEFFDTL  GREATER THAN ZEROS
 15834         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 15835
 15836 2810-READ-BY-ACCOUNT.
 15837
 15838* EXEC CICS HANDLE CONDITION
 15839*         NOTFND    (2820-PROCESS-REWRITE)
 15840*    END-EXEC.
 15841*    MOVE '"$I                   ! ; #00013869' TO DFHEIV0
 15842     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15844     MOVE X'3B20233030303133383639' TO DFHEIV0(25:11)
 15845     CALL 'kxdfhei1' USING DFHEIV0
 15846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15847
 15848
 15849
 15850* EXEC CICS READ
 15851*        SET     (ADDRESS OF PENDING-BUSINESS)
 15852*        DATASET (FILE-ID-ERPNDB2)
 15853*        RIDFLD  (ERPNDB-ALT-KEY)
 15854*    END-EXEC.
 15855*    MOVE '&"S        E          (   #00013873' TO DFHEIV0
 15856     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15857     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15858     MOVE X'2020233030303133383733' TO DFHEIV0(25:11)
 15859     CALL 'kxdfhei1' USING DFHEIV0,
 15860           FILE-ID-ERPNDB2,
 15861           DFHEIV20,
 15862           DFHEIV99,
 15863           ERPNDB-ALT-KEY,
 15864           DFHEIV99,
 15865           DFHEIV99,
 15866           DFHEIV99
 15867     SET ADDRESS OF PENDING-BUSINESS TO
 15868         DFHEIV20
 15869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15870
 15871
 15872     GO TO 2890-DUPLICATE-RECORD.
 15873
 15874  2820-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 293
* EL6311.cbl
 15875
 15876* EXEC CICS HANDLE CONDITION
 15877*         NOTFND    (2885-RECORD-MISSING)
 15878*    END-EXEC.
 15879*    MOVE '"$I                   ! < #00013882' TO DFHEIV0
 15880     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15881     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15882     MOVE X'3C20233030303133383832' TO DFHEIV0(25:11)
 15883     CALL 'kxdfhei1' USING DFHEIV0
 15884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15885
 15886
 15887     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15888
 15889
 15890* EXEC CICS READ
 15891*        SET     (ADDRESS OF PENDING-BUSINESS)
 15892*        DATASET (FILE-ID-ERPNDB)
 15893*        RIDFLD  (ERPNDB-KEY)
 15894*        UPDATE
 15895*    END-EXEC.
 15896*    MOVE '&"S        EU         (   #00013888' TO DFHEIV0
 15897     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15898     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15899     MOVE X'2020233030303133383838' TO DFHEIV0(25:11)
 15900     CALL 'kxdfhei1' USING DFHEIV0,
 15901           FILE-ID-ERPNDB,
 15902           DFHEIV20,
 15903           DFHEIV99,
 15904           ERPNDB-KEY,
 15905           DFHEIV99,
 15906           DFHEIV99,
 15907           DFHEIV99
 15908     SET ADDRESS OF PENDING-BUSINESS TO
 15909         DFHEIV20
 15910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15911
 15912
 15913     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15914     MOVE 'D'                    TO JP-RECORD-TYPE.
 15915     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15916     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15917
 15918     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15919
 15920     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15921     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15922     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15923
 15924
 15925* EXEC CICS DELETE
 15926*        DATASET    (FILE-ID-ERPNDB)
 15927*    END-EXEC.
 15928*    MOVE '&(                    &   #00013906' TO DFHEIV0
 15929     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 15930     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15931     MOVE X'2020233030303133393036' TO DFHEIV0(25:11)
 15932     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 294
* EL6311.cbl
 15933           FILE-ID-ERPNDB,
 15934           DFHEIV99,
 15935           DFHEIV99,
 15936           DFHEIV99,
 15937           DFHEIV99
 15938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15939
 15940
 15941     PERFORM 8400-LOG-JOURNAL-RECORD.
 15942
 15943
 15944* EXEC CICS GETMAIN
 15945*        SET      (ADDRESS OF PENDING-BUSINESS)
 15946*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15947*        INITIMG  (GETMAIN-SPACE)
 15948*    END-EXEC.
 15949*    MOVE ',"IL                  $   #00013912' TO DFHEIV0
 15950     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15951     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15952     MOVE X'2020233030303133393132' TO DFHEIV0(25:11)
 15953     CALL 'kxdfhei1' USING DFHEIV0,
 15954           DFHEIV20,
 15955           ERPNDB-RECORD-LENGTH,
 15956           GETMAIN-SPACE
 15957     SET ADDRESS OF PENDING-BUSINESS TO
 15958         DFHEIV20
 15959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15960
 15961
 15962     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 15963
 15964
 15965* EXEC CICS HANDLE CONDITION
 15966*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 15967*    END-EXEC.
 15968*    MOVE '"$I                   ! = #00013920' TO DFHEIV0
 15969     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15970     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15971     MOVE X'3D20233030303133393230' TO DFHEIV0(25:11)
 15972     CALL 'kxdfhei1' USING DFHEIV0
 15973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15974
 15975
 15976
 15977* EXEC CICS READ
 15978*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15979*        DATASET (FILE-ID-ELCERT)
 15980*        RIDFLD  (ELCERT-KEY)
 15981*        UPDATE
 15982*    END-EXEC.
 15983*    MOVE '&"S        EU         (   #00013924' TO DFHEIV0
 15984     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15985     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15986     MOVE X'2020233030303133393234' TO DFHEIV0(25:11)
 15987     CALL 'kxdfhei1' USING DFHEIV0,
 15988           FILE-ID-ELCERT,
 15989           DFHEIV20,
 15990           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 295
* EL6311.cbl
 15991           ELCERT-KEY,
 15992           DFHEIV99,
 15993           DFHEIV99,
 15994           DFHEIV99
 15995     SET ADDRESS OF CERTIFICATE-MASTER TO
 15996         DFHEIV20
 15997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15998
 15999
 16000     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 16001     MOVE 'B'                    TO JP-RECORD-TYPE
 16002     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16003     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16004
 16005     IF INSURED-ADDR-PRESENT
 16006        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 16007
 16008     IF CERT-NOTES-ARE-NOT-PRESENT
 16009        MOVE SPACE               TO WS-CERT-NOTE-SW
 16010     ELSE
 16011        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 16012
 16013     IF CERT-ADDED-BATCH      OR
 16014        CERT-AND-CLAIM-ONLINE OR
 16015        CERT-WAS-CREATED-FOR-CLAIM
 16016        NEXT SENTENCE
 16017     ELSE
 16018        GO TO 2825-DELETE-CERTIFICATE.
 16019
 16020     PERFORM 8400-LOG-JOURNAL-RECORD.
 16021
 16022*********************************************************
 16023** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 16024     IF CERT-ADDED-BATCH
 16025         GO TO 2822-REWRITE-ELCERT.
 16026*********************************************************
 16027
 16028     IF NO-CLAIM-ATTACHED
 16029        NEXT SENTENCE
 16030     ELSE
 16031        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 16032        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 16033
 16034 2822-REWRITE-ELCERT.
 16035     MOVE 'C'                    TO JP-RECORD-TYPE
 16036     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16037
 16038     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16039
 16040
 16041* EXEC CICS REWRITE
 16042*         DATASET    (FILE-ID-ELCERT)
 16043*         FROM       (CERTIFICATE-MASTER)
 16044*    END-EXEC.
 16045     MOVE LENGTH OF
 16046      CERTIFICATE-MASTER
 16047       TO DFHEIV11
 16048*    MOVE '&& L                  %   #00013971' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 296
* EL6311.cbl
 16049     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16050     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16051     MOVE X'2020233030303133393731' TO DFHEIV0(25:11)
 16052     CALL 'kxdfhei1' USING DFHEIV0,
 16053           FILE-ID-ELCERT,
 16054           CERTIFICATE-MASTER,
 16055           DFHEIV11,
 16056           DFHEIV99
 16057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16058
 16059
 16060     PERFORM 8400-LOG-JOURNAL-RECORD.
 16061
 16062     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16063
 16064 2825-DELETE-CERTIFICATE.
 16065     MOVE 'D'                      TO JP-RECORD-TYPE.
 16066     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16067
 16068     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16069
 16070
 16071* EXEC CICS DELETE
 16072*         DATASET    (FILE-ID-ELCERT)
 16073*    END-EXEC.
 16074*    MOVE '&(                    &   #00013986' TO DFHEIV0
 16075     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16076     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16077     MOVE X'2020233030303133393836' TO DFHEIV0(25:11)
 16078     CALL 'kxdfhei1' USING DFHEIV0,
 16079           FILE-ID-ELCERT,
 16080           DFHEIV99,
 16081           DFHEIV99,
 16082           DFHEIV99,
 16083           DFHEIV99
 16084     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16085
 16086
 16087     PERFORM 8400-LOG-JOURNAL-RECORD.
 16088
 16089******************************************************************
 16090*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 16091******************************************************************
 16092
 16093     IF CERT-NOTES-ARE-PRESENT
 16094        NEXT SENTENCE
 16095     ELSE
 16096        GO TO 2827-DELETE-MAILING.
 16097
 16098
 16099* EXEC CICS HANDLE CONDITION
 16100*         NOTFND  (2827-DELETE-MAILING)
 16101*    END-EXEC.
 16102*    MOVE '"$I                   ! > #00014001' TO DFHEIV0
 16103     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16104     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16105     MOVE X'3E20233030303134303031' TO DFHEIV0(25:11)
 16106     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 297
* EL6311.cbl
 16107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16108
 16109
 16110
 16111* EXEC CICS READ
 16112*        EQUAL
 16113*        DATASET   (FILE-ID-ERNOTE)
 16114*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 16115*        RIDFLD    (ELCERT-KEY)
 16116*        UPDATE
 16117*    END-EXEC.
 16118*    MOVE '&"S        EU         (   #00014005' TO DFHEIV0
 16119     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16120     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16121     MOVE X'2020233030303134303035' TO DFHEIV0(25:11)
 16122     CALL 'kxdfhei1' USING DFHEIV0,
 16123           FILE-ID-ERNOTE,
 16124           DFHEIV20,
 16125           DFHEIV99,
 16126           ELCERT-KEY,
 16127           DFHEIV99,
 16128           DFHEIV99,
 16129           DFHEIV99
 16130     SET ADDRESS OF CERTIFICATE-NOTE TO
 16131         DFHEIV20
 16132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16133
 16134
 16135     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 16136     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16137     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 16138
 16139     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16140
 16141
 16142* EXEC CICS DELETE
 16143*        DATASET   (FILE-ID-ERNOTE)
 16144*    END-EXEC.
 16145*    MOVE '&(                    &   #00014019' TO DFHEIV0
 16146     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16147     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16148     MOVE X'2020233030303134303139' TO DFHEIV0(25:11)
 16149     CALL 'kxdfhei1' USING DFHEIV0,
 16150           FILE-ID-ERNOTE,
 16151           DFHEIV99,
 16152           DFHEIV99,
 16153           DFHEIV99,
 16154           DFHEIV99
 16155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16156
 16157
 16158     PERFORM 8400-LOG-JOURNAL-RECORD.
 16159
 16160******************************************************************
 16161*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 16162******************************************************************
 16163
 16164 2827-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 298
* EL6311.cbl
 16165     IF CERT-ADDRESS-PRESENT
 16166        NEXT SENTENCE
 16167     ELSE
 16168        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 16169
 16170
 16171* EXEC CICS HANDLE CONDITION
 16172*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 16173*    END-EXEC.
 16174*    MOVE '"$I                   ! ? #00014035' TO DFHEIV0
 16175     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16176     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16177     MOVE X'3F20233030303134303335' TO DFHEIV0(25:11)
 16178     CALL 'kxdfhei1' USING DFHEIV0
 16179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16180
 16181
 16182     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 16183
 16184
 16185* EXEC CICS READ
 16186*        EQUAL
 16187*        DATASET   (FILE-ID-ERMAIL)
 16188*        SET       (ADDRESS OF MAILING-DATA)
 16189*        RIDFLD    (ERMAIL-KEY)
 16190*        UPDATE
 16191*    END-EXEC.
 16192*    MOVE '&"S        EU         (   #00014041' TO DFHEIV0
 16193     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16194     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16195     MOVE X'2020233030303134303431' TO DFHEIV0(25:11)
 16196     CALL 'kxdfhei1' USING DFHEIV0,
 16197           FILE-ID-ERMAIL,
 16198           DFHEIV20,
 16199           DFHEIV99,
 16200           ERMAIL-KEY,
 16201           DFHEIV99,
 16202           DFHEIV99,
 16203           DFHEIV99
 16204     SET ADDRESS OF MAILING-DATA TO
 16205         DFHEIV20
 16206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16207
 16208
 16209     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 16210     MOVE 'D'                    TO  JP-RECORD-TYPE.
 16211     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 16212
 16213     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 16214
 16215
 16216* EXEC CICS DELETE
 16217*        DATASET   (FILE-ID-ERMAIL)
 16218*    END-EXEC.
 16219*    MOVE '&(                    &   #00014055' TO DFHEIV0
 16220     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16221     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16222     MOVE X'2020233030303134303535' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 299
* EL6311.cbl
 16223     CALL 'kxdfhei1' USING DFHEIV0,
 16224           FILE-ID-ERMAIL,
 16225           DFHEIV99,
 16226           DFHEIV99,
 16227           DFHEIV99,
 16228           DFHEIV99
 16229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16230
 16231
 16232     PERFORM 8400-LOG-JOURNAL-RECORD.
 16233
 16234 2830-BUILD-NEW-ISSUE-RECORD.
 16235     MOVE SPACES                 TO ELCERT-KEY.
 16236
 16237     IF  BCERTNOL GREATER THAN ZEROS
 16238         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 16239
 16240     IF  BSUFIXL  GREATER THAN ZEROS
 16241         MOVE BSUFIXI            TO  PB-CERT-SFX.
 16242
 16243     IF BEFFDTL GREATER THAN ZEROS
 16244        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 16245
 16246 2870-WRITE-PENDING-BUSINESS.
 16247     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16248     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16249     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16250     MOVE '5'                    TO DC-OPTION-CODE.
 16251     PERFORM 9700-DATE-LINK.
 16252     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16253
 16254     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16255
 16256     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16257     MOVE 'A'                    TO JP-RECORD-TYPE.
 16258     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16259
 16260
 16261* EXEC CICS WRITE
 16262*        DATASET  (FILE-ID-ERPNDB)
 16263*        FROM     (PENDING-BUSINESS)
 16264*        RIDFLD   (PB-CONTROL-PRIMARY)
 16265*    END-EXEC.
 16266     MOVE LENGTH OF
 16267      PENDING-BUSINESS
 16268       TO DFHEIV11
 16269*    MOVE '&$ L                  ''   #00014087' TO DFHEIV0
 16270     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16271     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16272     MOVE X'2020233030303134303837' TO DFHEIV0(25:11)
 16273     CALL 'kxdfhei1' USING DFHEIV0,
 16274           FILE-ID-ERPNDB,
 16275           PENDING-BUSINESS,
 16276           DFHEIV11,
 16277           PB-CONTROL-PRIMARY,
 16278           DFHEIV99,
 16279           DFHEIV99
 16280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 300
* EL6311.cbl
 16281
 16282
 16283     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 16284
 16285     PERFORM 8400-LOG-JOURNAL-RECORD.
 16286
 16287     GO TO 1325-PROCESS-ISSUE-CHANGES.
 16288
 16289 2885-RECORD-MISSING.
 16290     MOVE -1                     TO BMAINTL
 16291     MOVE AL-UABON               TO BMAINTA
 16292     MOVE ER-2902                TO EMI-ERROR.
 16293     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16294     GO TO 8200-SEND-DATAONLY.
 16295
 16296 2890-DUPLICATE-RECORD.
 16297     MOVE -1                     TO BMAINTL.
 16298     MOVE AL-UABON               TO BCERTNOA.
 16299     MOVE AL-UNBON               TO BEFFDTA.
 16300     MOVE SPACE                  TO BMAINTI.
 16301
 16302     MOVE 1                      TO EMI-SUB
 16303                                    EMI-SWITCH1
 16304                                    EMI-SWITCH-AREA-1
 16305                                    EMI-SWITCH-AREA-2.
 16306
 16307     MOVE SPACES                 TO EMI-ERROR-LINES.
 16308
 16309
 16310* EXEC CICS SYNCPOINT ROLLBACK
 16311*    END-EXEC.
 16312*    MOVE '6"R                   !   #00014119' TO DFHEIV0
 16313     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16314     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16315     MOVE X'2020233030303134313139' TO DFHEIV0(25:11)
 16316     CALL 'kxdfhei1' USING DFHEIV0
 16317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16318
 16319
 16320     MOVE ER-2247                TO EMI-ERROR.
 16321     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 16322     GO TO 8200-SEND-DATAONLY.
 16323
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 301
* EL6311.cbl
 16325
 16326******************************************************************
 16327*                                                                *
 16328*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 16329*                                                                *
 16330******************************************************************
 16331
 16332 2900-REWRITE-CAN-CERT-KEY.
 16333     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 16334
 16335     IF  CCERTNOL GREATER THAN ZEROS
 16336         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 16337
 16338     IF  CSUFIXL  GREATER THAN ZEROS
 16339         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 16340
 16341     IF  CEFFDTL  GREATER THAN ZEROS
 16342         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 16343
 16344 2910-READ-BY-ACCOUNT.
 16345
 16346* EXEC CICS HANDLE CONDITION
 16347*         NOTFND    (2920-PROCESS-REWRITE)
 16348*    END-EXEC.
 16349*    MOVE '"$I                   ! @ #00014147' TO DFHEIV0
 16350     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16351     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16352     MOVE X'4020233030303134313437' TO DFHEIV0(25:11)
 16353     CALL 'kxdfhei1' USING DFHEIV0
 16354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16355
 16356
 16357
 16358* EXEC CICS READ
 16359*        SET     (ADDRESS OF PENDING-BUSINESS)
 16360*        DATASET (FILE-ID-ERPNDB2)
 16361*        RIDFLD  (ERPNDB-ALT-KEY)
 16362*    END-EXEC.
 16363*    MOVE '&"S        E          (   #00014151' TO DFHEIV0
 16364     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16365     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16366     MOVE X'2020233030303134313531' TO DFHEIV0(25:11)
 16367     CALL 'kxdfhei1' USING DFHEIV0,
 16368           FILE-ID-ERPNDB2,
 16369           DFHEIV20,
 16370           DFHEIV99,
 16371           ERPNDB-ALT-KEY,
 16372           DFHEIV99,
 16373           DFHEIV99,
 16374           DFHEIV99
 16375     SET ADDRESS OF PENDING-BUSINESS TO
 16376         DFHEIV20
 16377     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16378
 16379
 16380     GO TO 2990-DUPLICATE-RECORD.
 16381
 16382  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 302
* EL6311.cbl
 16383
 16384* EXEC CICS HANDLE CONDITION
 16385*         NOTFND    (2985-RECORD-MISSING)
 16386*    END-EXEC.
 16387*    MOVE '"$I                   ! A #00014160' TO DFHEIV0
 16388     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16389     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16390     MOVE X'4120233030303134313630' TO DFHEIV0(25:11)
 16391     CALL 'kxdfhei1' USING DFHEIV0
 16392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16393
 16394
 16395     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16396
 16397
 16398* EXEC CICS READ
 16399*        SET     (ADDRESS OF PENDING-BUSINESS)
 16400*        DATASET (FILE-ID-ERPNDB)
 16401*        RIDFLD  (ERPNDB-KEY)
 16402*        UPDATE
 16403*    END-EXEC.
 16404*    MOVE '&"S        EU         (   #00014166' TO DFHEIV0
 16405     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16406     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16407     MOVE X'2020233030303134313636' TO DFHEIV0(25:11)
 16408     CALL 'kxdfhei1' USING DFHEIV0,
 16409           FILE-ID-ERPNDB,
 16410           DFHEIV20,
 16411           DFHEIV99,
 16412           ERPNDB-KEY,
 16413           DFHEIV99,
 16414           DFHEIV99,
 16415           DFHEIV99
 16416     SET ADDRESS OF PENDING-BUSINESS TO
 16417         DFHEIV20
 16418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16419
 16420
 16421     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16422     MOVE 'D'                    TO JP-RECORD-TYPE.
 16423     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16424     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16425
 16426     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16427
 16428     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16429     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16430     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16431
 16432
 16433* EXEC CICS DELETE
 16434*        DATASET    (FILE-ID-ERPNDB)
 16435*    END-EXEC.
 16436*    MOVE '&(                    &   #00014184' TO DFHEIV0
 16437     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16438     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16439     MOVE X'2020233030303134313834' TO DFHEIV0(25:11)
 16440     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 303
* EL6311.cbl
 16441           FILE-ID-ERPNDB,
 16442           DFHEIV99,
 16443           DFHEIV99,
 16444           DFHEIV99,
 16445           DFHEIV99
 16446     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16447
 16448
 16449     PERFORM 8400-LOG-JOURNAL-RECORD.
 16450
 16451
 16452* EXEC CICS GETMAIN
 16453*        SET      (ADDRESS OF PENDING-BUSINESS)
 16454*        LENGTH   (ERPNDB-RECORD-LENGTH)
 16455*        INITIMG  (GETMAIN-SPACE)
 16456*    END-EXEC.
 16457*    MOVE ',"IL                  $   #00014190' TO DFHEIV0
 16458     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16459     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16460     MOVE X'2020233030303134313930' TO DFHEIV0(25:11)
 16461     CALL 'kxdfhei1' USING DFHEIV0,
 16462           DFHEIV20,
 16463           ERPNDB-RECORD-LENGTH,
 16464           GETMAIN-SPACE
 16465     SET ADDRESS OF PENDING-BUSINESS TO
 16466         DFHEIV20
 16467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16468
 16469
 16470     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 16471
 16472 2950-PROCESS-CANCELS.
 16473
 16474
 16475* EXEC CICS HANDLE CONDITION
 16476*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 16477*    END-EXEC.
 16478*    MOVE '"$I                   ! B #00014200' TO DFHEIV0
 16479     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16480     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16481     MOVE X'4220233030303134323030' TO DFHEIV0(25:11)
 16482     CALL 'kxdfhei1' USING DFHEIV0
 16483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16484
 16485
 16486
 16487* EXEC CICS READ
 16488*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16489*        DATASET (FILE-ID-ELCERT)
 16490*        RIDFLD  (ELCERT-KEY)
 16491*        UPDATE
 16492*    END-EXEC.
 16493*    MOVE '&"S        EU         (   #00014204' TO DFHEIV0
 16494     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16495     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16496     MOVE X'2020233030303134323034' TO DFHEIV0(25:11)
 16497     CALL 'kxdfhei1' USING DFHEIV0,
 16498           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 304
* EL6311.cbl
 16499           DFHEIV20,
 16500           DFHEIV99,
 16501           ELCERT-KEY,
 16502           DFHEIV99,
 16503           DFHEIV99,
 16504           DFHEIV99
 16505     SET ADDRESS OF CERTIFICATE-MASTER TO
 16506         DFHEIV20
 16507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16508
 16509
 16510     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16511
 16512     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16513     MOVE 'B'                      TO JP-RECORD-TYPE.
 16514     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16515     PERFORM 8400-LOG-JOURNAL-RECORD.
 16516
 16517     IF PB-CI-LIVES NOT NUMERIC
 16518         MOVE ZERO                    TO PB-CI-LIVES.
 16519
 16520     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16521        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16522        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16523        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16524                                         CM-LF-CANCEL-DT
 16525     ELSE
 16526        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16527        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16528        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16529        MOVE PB-CI-LIVES              TO CM-LIVES.
 16530
 16531     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16532        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16533            MOVE CM-LF-STATUS-AT-CANCEL
 16534                                     TO CM-LF-CURRENT-STATUS
 16535            MOVE SPACE
 16536                                     TO CM-LF-STATUS-AT-CANCEL
 16537        ELSE
 16538            MOVE PB-CI-LF-POLICY-STATUS
 16539                                     TO CM-LF-CURRENT-STATUS
 16540     ELSE
 16541        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16542
 16543     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16544        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16545        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16546        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16547                                         CM-AH-CANCEL-DT
 16548     ELSE
 16549        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 16550        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16551        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16552        MOVE PB-CI-LIVES              TO CM-LIVES.
 16553
 16554     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16555        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16556            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 305
* EL6311.cbl
 16557                                     TO CM-AH-CURRENT-STATUS
 16558            MOVE SPACE
 16559                                     TO CM-AH-STATUS-AT-CANCEL
 16560        ELSE
 16561            MOVE PB-CI-AH-POLICY-STATUS
 16562                                     TO CM-AH-CURRENT-STATUS
 16563     ELSE
 16564        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16565
 16566 2975-REWRITE-CERT.
 16567     MOVE 'C'                      TO JP-RECORD-TYPE.
 16568     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16569
 16570
 16571* EXEC CICS REWRITE
 16572*        DATASET    (FILE-ID-ELCERT)
 16573*        FROM       (CERTIFICATE-MASTER)
 16574*    END-EXEC.
 16575     MOVE LENGTH OF
 16576      CERTIFICATE-MASTER
 16577       TO DFHEIV11
 16578*    MOVE '&& L                  %   #00014271' TO DFHEIV0
 16579     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16580     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16581     MOVE X'2020233030303134323731' TO DFHEIV0(25:11)
 16582     CALL 'kxdfhei1' USING DFHEIV0,
 16583           FILE-ID-ELCERT,
 16584           CERTIFICATE-MASTER,
 16585           DFHEIV11,
 16586           DFHEIV99
 16587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16588
 16589
 16590     PERFORM 8400-LOG-JOURNAL-RECORD.
 16591
 16592 2960-BUILD-NEW-CANCEL-RECORD.
 16593     IF  CCERTNOL GREATER THAN ZEROS
 16594         MOVE CCERTNOI            TO PB-CERT-PRIME.
 16595
 16596     IF  CSUFIXL  GREATER THAN ZEROS
 16597         MOVE CSUFIXI             TO PB-CERT-SFX.
 16598
 16599     IF  CEFFDTL  GREATER  THAN ZEROS
 16600         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 16601
 16602 2970-WRITE-PENDING-BUSINESS.
 16603     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16604     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16605     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16606     MOVE '5'                    TO DC-OPTION-CODE.
 16607     PERFORM 9700-DATE-LINK.
 16608     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16609
 16610     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 16611
 16612     MOVE SPACES                 TO PB-CI-INSURED-NAME
 16613                                    PB-CI-INSURED-SEX
 16614                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 306
* EL6311.cbl
 16615                                    PB-CI-AH-BENEFIT-CD
 16616                                    PB-CI-RATE-CLASS
 16617                                    PB-CI-RATE-DEV-LF
 16618                                    PB-CI-RATE-DEV-AH
 16619                                    PB-CI-LF-ABBR
 16620                                    PB-CI-AH-ABBR
 16621                                    PB-CI-OB-FLAG
 16622                                    PB-CI-LF-POLICY-STATUS
 16623                                    PB-CI-AH-POLICY-STATUS
 16624                                    PB-CI-INDV-GRP-CD
 16625                                    PB-CI-BENEFICIARY-NAME
 16626                                    PB-CI-NOTE-SW
 16627                                    PB-CI-SOC-SEC-NO
 16628                                    PB-CI-MEMBER-NO
 16629                                    PB-CI-INT-CODE
 16630                                    PB-CI-COMP-EXCP-SW
 16631                                    PB-CI-ENTRY-STATUS
 16632                                    PB-CI-CREDIT-INTERFACE-SW-1
 16633                                    PB-CI-CREDIT-INTERFACE-SW-2
 16634                                    PB-CI-ENTRY-BATCH.
 16635
 16636     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 16637                                    PB-CI-AH-SETTLEMENT-DT
 16638                                    PB-CI-DEATH-DT
 16639                                    PB-CI-LF-PRIOR-CANCEL-DT
 16640                                    PB-CI-AH-PRIOR-CANCEL-DT
 16641                                    PB-CI-LOAN-1ST-PMT-DT
 16642                                    PB-CI-ENTRY-DT
 16643                                    PB-CI-LF-EXPIRE-DT
 16644                                    PB-CI-AH-EXPIRE-DT.
 16645
 16646     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 16647                                    PB-CI-LF-TERM
 16648                                    PB-CI-LF-BENEFIT-AMT
 16649                                    PB-CI-LF-ALT-BENEFIT-AMT
 16650                                    PB-CI-LF-PREMIUM-AMT
 16651                                    PB-CI-LF-ALT-PREMIUM-AMT
 16652                                    PB-CI-AH-TERM
 16653                                    PB-CI-AH-BENEFIT-AMT
 16654                                    PB-CI-AH-PREMIUM-AMT
 16655                                    PB-CI-RATE-DEV-PCT-LF
 16656                                    PB-CI-RATE-DEV-PCT-AH
 16657                                    PB-CI-LIFE-COMMISSION
 16658                                    PB-CI-AH-COMMISSION
 16659                                    PB-CI-PAY-FREQUENCY
 16660                                    PB-CI-LOAN-APR
 16661                                    PB-CI-LOAN-TERM
 16662                                    PB-CI-CURR-SEQ
 16663                                    PB-CI-AH-CANCEL-AMT
 16664                                    PB-CI-LF-CANCEL-AMT
 16665                                    PB-CI-EXTENTION-DAYS
 16666                                    PB-CI-TERM-IN-DAYS
 16667                                    PB-CI-LOAN-OFFICER
 16668                                    PB-CI-LIVES
 16669                                    PB-CI-LF-CRIT-PER
 16670                                    PB-CI-AH-CRIT-PER
 16671                                    PB-C-LF-REM-TERM
 16672                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 307
* EL6311.cbl
 16673
 16674     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16675     MOVE 'A'                    TO JP-RECORD-TYPE.
 16676     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16677
 16678
 16679* EXEC CICS HANDLE CONDITION
 16680*        DUPREC   (2990-DUPLICATE-RECORD)
 16681*    END-EXEC.
 16682*    MOVE '"$%                   ! C #00014364' TO DFHEIV0
 16683     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16684     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16685     MOVE X'4320233030303134333634' TO DFHEIV0(25:11)
 16686     CALL 'kxdfhei1' USING DFHEIV0
 16687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16688
 16689
 16690
 16691* EXEC CICS WRITE
 16692*        DATASET  (FILE-ID-ERPNDB)
 16693*        FROM     (PENDING-BUSINESS)
 16694*        RIDFLD   (PB-CONTROL-PRIMARY)
 16695*    END-EXEC.
 16696     MOVE LENGTH OF
 16697      PENDING-BUSINESS
 16698       TO DFHEIV11
 16699*    MOVE '&$ L                  ''   #00014368' TO DFHEIV0
 16700     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16701     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16702     MOVE X'2020233030303134333638' TO DFHEIV0(25:11)
 16703     CALL 'kxdfhei1' USING DFHEIV0,
 16704           FILE-ID-ERPNDB,
 16705           PENDING-BUSINESS,
 16706           DFHEIV11,
 16707           PB-CONTROL-PRIMARY,
 16708           DFHEIV99,
 16709           DFHEIV99
 16710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16711
 16712
 16713     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16714
 16715     PERFORM 8400-LOG-JOURNAL-RECORD.
 16716
 16717     GO TO 2325-PROCESS-CANCEL-CHANGES.
 16718
 16719 2985-RECORD-MISSING.
 16720     MOVE -1                     TO CMAINTL
 16721     MOVE AL-UABON               TO CMAINTA.
 16722
 16723     MOVE ER-2902                TO EMI-ERROR.
 16724     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16725     GO TO 8200-SEND-DATAONLY.
 16726
 16727 2990-DUPLICATE-RECORD.
 16728     MOVE SPACE                  TO CMAINTI.
 16729     MOVE -1                     TO CMAINTL.
 16730     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 308
* EL6311.cbl
 16731     MOVE AL-UNBON               TO CEFFDTA.
 16732
 16733     MOVE 1                      TO EMI-SUB
 16734                                    EMI-SWITCH1
 16735                                    EMI-SWITCH-AREA-1
 16736                                    EMI-SWITCH-AREA-2.
 16737     MOVE SPACES                 TO EMI-ERROR-LINES.
 16738
 16739
 16740* EXEC CICS SYNCPOINT ROLLBACK
 16741*    END-EXEC.
 16742*    MOVE '6"R                   !   #00014400' TO DFHEIV0
 16743     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16744     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16745     MOVE X'2020233030303134343030' TO DFHEIV0(25:11)
 16746     CALL 'kxdfhei1' USING DFHEIV0
 16747     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16748
 16749
 16750     MOVE ER-2247                TO EMI-ERROR.
 16751     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16752     GO TO 8200-SEND-DATAONLY.
 16753
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 309
* EL6311.cbl
 16755
 16756***************************************************************
 16757*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 16758*     PREMIUM FOR A SINGLE BATCH.                             *
 16759*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 16760***************************************************************
 16761
 16762 3000-BATCH-MAINLINE.
 16763     IF PI-PREV-KEY NOT = SPACES
 16764         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 16765     ELSE
 16766         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 16767
 16768     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 16769
 16770 3010-READNEXT.
 16771
 16772* EXEC CICS READ
 16773*         DATASET    (FILE-ID-ERPNDB)
 16774*         SET        (ADDRESS OF PENDING-BUSINESS)
 16775*         RIDFLD     (ERPNDB-KEY)
 16776*         GTEQ
 16777*    END-EXEC.
 16778*    MOVE '&"S        G          (   #00014424' TO DFHEIV0
 16779     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16780     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16781     MOVE X'2020233030303134343234' TO DFHEIV0(25:11)
 16782     CALL 'kxdfhei1' USING DFHEIV0,
 16783           FILE-ID-ERPNDB,
 16784           DFHEIV20,
 16785           DFHEIV99,
 16786           ERPNDB-KEY,
 16787           DFHEIV99,
 16788           DFHEIV99,
 16789           DFHEIV99
 16790     SET ADDRESS OF PENDING-BUSINESS TO
 16791         DFHEIV20
 16792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16793
 16794
 16795     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 16796        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 16797          GO TO 3030-END-BATCH.
 16798
 16799     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 16800
 16801     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16802        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16803          GO TO 3020-BUMP-SEQ.
 16804
 16805     IF PB-ISSUE
 16806        ADD +1                   TO WS-ISS-TOTAL-CNT
 16807        IF PB-FATAL-ERRORS
 16808           ADD +1                      TO WS-ISS-FATAL-CNT
 16809           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 16810           GO TO 3020-BUMP-SEQ
 16811        ELSE
 16812           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 310
* EL6311.cbl
 16813              ADD +1                      TO WS-ISS-FORCE-CNT
 16814              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 16815              GO TO 3020-BUMP-SEQ
 16816           ELSE
 16817              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 16818                 ADD +1                      TO WS-ISS-HOLD-CNT
 16819                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 16820                 GO TO 3020-BUMP-SEQ
 16821              ELSE
 16822                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 16823                     THRU  3299-EXIT
 16824                 GO TO 3020-BUMP-SEQ.
 16825
 16826     IF PB-CANCELLATION
 16827        ADD +1                   TO WS-CAN-TOTAL-CNT
 16828        IF PB-FATAL-ERRORS
 16829           ADD +1                 TO WS-CAN-FATAL-CNT
 16830           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 16831           GO TO 3020-BUMP-SEQ
 16832        ELSE
 16833           IF PB-UNFORCED-ERRORS
 16834              ADD +1                 TO WS-CAN-FORCE-CNT
 16835              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 16836              GO TO 3020-BUMP-SEQ
 16837           ELSE
 16838              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 16839                 ADD +1                 TO WS-CAN-HOLD-CNT
 16840                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 16841                 GO TO 3020-BUMP-SEQ
 16842              ELSE
 16843                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 16844                     THRU  3499-EXIT
 16845                 GO TO 3020-BUMP-SEQ.
 16846
 16847     IF PB-BATCH-TRAILER
 16848         GO TO 3030-END-BATCH.
 16849
 16850 3020-BUMP-SEQ.
 16851     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 16852     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16853     GO TO 3010-READNEXT.
 16854
 16855 3030-END-BATCH.
 16856     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 16857     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 16858     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 16859     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 16860
 16861     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 16862                                          - WS-ISS-FORCE-CNT
 16863                                          - WS-ISS-HOLD-CNT).
 16864
 16865     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 16866     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 16867
 16868     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 16869     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 16870     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 311
* EL6311.cbl
 16871     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 16872     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 16873                                          - WS-CAN-FORCE-CNT
 16874                                          - WS-CAN-HOLD-CNT).
 16875     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 16876     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 16877
 16878     COMPUTE WS-NET-TOTAL-CNT
 16879         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 16880     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 16881     COMPUTE WS-NET-FATAL-CNT
 16882         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 16883     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 16884     COMPUTE WS-NET-FORCE-CNT
 16885         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 16886     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 16887     COMPUTE WS-NET-HOLD-CNT
 16888         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 16889     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 16890
 16891     COMPUTE WS-NET-AVAIL-CNT
 16892          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 16893                              - WS-ISS-FORCE-CNT
 16894                              - WS-ISS-HOLD-CNT)
 16895          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 16896                              - WS-CAN-FORCE-CNT
 16897                              - WS-CAN-HOLD-CNT).
 16898     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 16899
 16900     COMPUTE WS-NET-GOOD-PREM
 16901         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 16902     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 16903     COMPUTE WS-NET-BAD-PREM
 16904         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 16905     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 16906
 16907     MOVE 0000                   TO EMI-ERROR.
 16908     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16909     MOVE -1                     TO DPFENTRL.
 16910     GO TO 8200-SEND-DATAONLY.
 16911
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 312
* EL6311.cbl
 16913
 16914******************************************************************
 16915*                                                                *
 16916*           A D D    B A D   I S S U E   P R E M I U M           *
 16917*                                                                *
 16918******************************************************************
 16919
 16920 3100-ADD-BAD-ISSUE-PREM.
 16921     IF PB-OVERRIDE-LIFE
 16922       OR PB-OVERRIDE-BOTH
 16923           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 16924           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 16925       ELSE
 16926           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 16927           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 16928
 16929     IF PB-OVERRIDE-AH
 16930       OR PB-OVERRIDE-BOTH
 16931           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 16932       ELSE
 16933           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 16934
 16935 3199-EXIT.
 16936     EXIT.
 16937
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 313
* EL6311.cbl
 16939
 16940******************************************************************
 16941*                                                                *
 16942*       A D D   G O O D   I S S U E   P R E M I U M              *
 16943*                                                                *
 16944******************************************************************
 16945
 16946 3200-ADD-GOOD-ISSUE-PREM.
 16947     IF PB-OVERRIDE-LIFE
 16948       OR PB-OVERRIDE-BOTH
 16949           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 16950           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 16951       ELSE
 16952           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 16953           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 16954
 16955     IF PB-OVERRIDE-AH
 16956       OR PB-OVERRIDE-BOTH
 16957           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 16958       ELSE
 16959           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 16960
 16961 3299-EXIT.
 16962     EXIT.
 16963
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 314
* EL6311.cbl
 16965
 16966
 16967******************************************************************
 16968*                                                                *
 16969*        A D D   B A D   C A N C E L   P R E M I U M             *
 16970*                                                                *
 16971******************************************************************
 16972
 16973 3300-ADD-BAD-CANCEL-PREM.
 16974     IF PB-OVERRIDE-LIFE
 16975       OR PB-OVERRIDE-BOTH
 16976           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 16977       ELSE
 16978           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 16979
 16980     IF PB-OVERRIDE-AH
 16981       OR PB-OVERRIDE-BOTH
 16982           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 16983       ELSE
 16984           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 16985
 16986 3399-EXIT.
 16987     EXIT.
 16988
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 315
* EL6311.cbl
 16990
 16991******************************************************************
 16992*                                                                *
 16993*       A D D   G O O D   C A N C E L   P R E M I U M            *
 16994*                                                                *
 16995******************************************************************
 16996
 16997 3400-ADD-GOOD-CANCEL-PREM.
 16998     IF PB-OVERRIDE-LIFE
 16999       OR PB-OVERRIDE-BOTH
 17000           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 17001       ELSE
 17002           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17003
 17004     IF PB-OVERRIDE-AH
 17005       OR PB-OVERRIDE-BOTH
 17006           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 17007       ELSE
 17008           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 17009
 17010 3499-EXIT.
 17011     EXIT.
 17012
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 316
* EL6311.cbl
 17014
 17015******************************************************************
 17016*                                                                *
 17017*           E D I T   B A T C H   D A T A                        *
 17018*                                                                *
 17019******************************************************************
 17020
 17021 3500-EDIT-BATCH-DATA.
 17022     IF PI-PREV-KEY NOT = SPACES
 17023        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 17024     ELSE
 17025        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 17026
 17027     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 17028     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 17029
 17030
 17031* EXEC CICS HANDLE CONDITION
 17032*         NOTFND      (3590-NOT-FOUND)
 17033*    END-EXEC.
 17034*    MOVE '"$I                   ! D #00014666' TO DFHEIV0
 17035     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17036     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17037     MOVE X'4420233030303134363636' TO DFHEIV0(25:11)
 17038     CALL 'kxdfhei1' USING DFHEIV0
 17039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17040
 17041
 17042     IF DRISSL   GREATER THAN ZEROS OR
 17043        DRISSL   GREATER THAN ZEROS OR
 17044        DRLFPRML GREATER THAN ZEROS OR
 17045        DRAHPRML GREATER THAN ZEROS OR
 17046        DRCANCL  GREATER THAN ZEROS OR
 17047        DRLFRFDL GREATER THAN ZEROS OR
 17048        DRAHRFDL GREATER THAN ZEROS
 17049              NEXT SENTENCE
 17050          ELSE
 17051              MOVE ER-3224    TO EMI-ERROR
 17052              MOVE -1         TO DPFENTRL
 17053              MOVE AL-UNBON   TO DPFENTRA
 17054              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17055              GO TO 8200-SEND-DATAONLY.
 17056
 17057     IF NOT MODIFY-CAP
 17058         MOVE 'UPDATE'       TO SM-READ
 17059         PERFORM 9995-SECURITY-VIOLATION
 17060         MOVE ER-0070        TO EMI-ERROR
 17061         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17062         GO TO 8100-SEND-INITIAL-MAP.
 17063
 17064        IF DRISSL GREATER THAN ZEROS
 17065           MOVE AL-UNNON         TO DRISSA
 17066           MOVE DRISSI           TO DEEDIT-FIELD
 17067           PERFORM 8600-DEEDIT
 17068           IF DEEDIT-FIELD-V0  NUMERIC
 17069              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 17070           ELSE
 17071              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 317
* EL6311.cbl
 17072              MOVE -1         TO DRISSL
 17073              MOVE AL-UNBON   TO DRISSA
 17074              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17075
 17076        IF DRLFPRML GREATER THAN ZEROS
 17077           MOVE AL-UNNON         TO DRLFPRMA
 17078
 17079* EXEC CICS BIF DEEDIT
 17080*              FIELD  (DRLFPRMI)
 17081*              LENGTH (11)
 17082*          END-EXEC
 17083     MOVE 11
 17084       TO DFHEIV11
 17085*    MOVE '@"L                   #   #00014706' TO DFHEIV0
 17086     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17087     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17088     MOVE X'2020233030303134373036' TO DFHEIV0(25:11)
 17089     CALL 'kxdfhei1' USING DFHEIV0,
 17090           DRLFPRMI,
 17091           DFHEIV11
 17092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17093           IF DRLFPRMI NUMERIC
 17094              MOVE DRLFPRMI   TO WS-DRLFPRM
 17095*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 17096*          PERFORM 8600-DEEDIT
 17097*          IF DEEDIT-FIELD-V2  NUMERIC
 17098*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 17099           ELSE
 17100              MOVE ER-2223    TO EMI-ERROR
 17101              MOVE -1         TO DRLFPRML
 17102              MOVE AL-UNBON   TO DRLFPRMA
 17103              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17104
 17105        IF DRAHPRML GREATER THAN ZEROS
 17106           MOVE AL-UNNON         TO DRAHPRMA
 17107
 17108* EXEC CICS BIF DEEDIT
 17109*              FIELD  (DRAHPRMI)
 17110*              LENGTH (11)
 17111*          END-EXEC
 17112     MOVE 11
 17113       TO DFHEIV11
 17114*    MOVE '@"L                   #   #00014724' TO DFHEIV0
 17115     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17116     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17117     MOVE X'2020233030303134373234' TO DFHEIV0(25:11)
 17118     CALL 'kxdfhei1' USING DFHEIV0,
 17119           DRAHPRMI,
 17120           DFHEIV11
 17121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17122           IF DRAHPRMI NUMERIC
 17123              MOVE DRAHPRMI   TO WS-DRAHPRM
 17124*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 17125*          PERFORM 8600-DEEDIT
 17126*          IF DEEDIT-FIELD-V2  NUMERIC
 17127*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 17128           ELSE
 17129              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 318
* EL6311.cbl
 17130              MOVE -1         TO DRAHPRML
 17131              MOVE AL-UNBON   TO DRAHPRMA
 17132              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17133
 17134        IF DRCANCL GREATER THAN ZEROS
 17135           MOVE AL-UNNON         TO DRCANCA
 17136           MOVE DRCANCI          TO DEEDIT-FIELD
 17137           PERFORM 8600-DEEDIT
 17138           IF DEEDIT-FIELD-V0  NUMERIC
 17139              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 17140           ELSE
 17141              MOVE ER-2223    TO EMI-ERROR
 17142              MOVE -1         TO DRCANCL
 17143              MOVE AL-UNBON   TO DRCANCL
 17144              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17145
 17146        IF DRLFRFDL GREATER THAN ZEROS
 17147           MOVE AL-UNNON         TO DRLFRFDA
 17148
 17149* EXEC CICS BIF DEEDIT
 17150*              FIELD  (DRLFRFDI)
 17151*              LENGTH (11)
 17152*          END-EXEC
 17153     MOVE 11
 17154       TO DFHEIV11
 17155*    MOVE '@"L                   #   #00014754' TO DFHEIV0
 17156     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17157     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17158     MOVE X'2020233030303134373534' TO DFHEIV0(25:11)
 17159     CALL 'kxdfhei1' USING DFHEIV0,
 17160           DRLFRFDI,
 17161           DFHEIV11
 17162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17163           IF DRLFRFDI NUMERIC
 17164              MOVE DRLFRFDI   TO WS-DRLFRFD
 17165*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 17166*          PERFORM 8600-DEEDIT
 17167*          IF DEEDIT-FIELD-V2  NUMERIC
 17168*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 17169           ELSE
 17170              MOVE ER-2223    TO EMI-ERROR
 17171              MOVE -1         TO DRLFRFDL
 17172              MOVE AL-UNBON   TO DRLFRFDA
 17173              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17174
 17175        IF DRAHRFDL GREATER THAN ZEROS
 17176           MOVE AL-UNNON         TO DRAHRFDA
 17177
 17178* EXEC CICS BIF DEEDIT
 17179*              FIELD  (DRAHRFDI)
 17180*              LENGTH (11)
 17181*          END-EXEC
 17182     MOVE 11
 17183       TO DFHEIV11
 17184*    MOVE '@"L                   #   #00014772' TO DFHEIV0
 17185     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17186     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17187     MOVE X'2020233030303134373732' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 319
* EL6311.cbl
 17188     CALL 'kxdfhei1' USING DFHEIV0,
 17189           DRAHRFDI,
 17190           DFHEIV11
 17191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17192           IF DRAHRFDI NUMERIC
 17193              MOVE DRAHRFDI   TO WS-DRAHRFD
 17194*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 17195*          PERFORM 8600-DEEDIT
 17196*          IF DEEDIT-FIELD-V2  NUMERIC
 17197*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 17198           ELSE
 17199              MOVE ER-2223    TO EMI-ERROR
 17200              MOVE -1         TO DRAHRFDL
 17201              MOVE AL-UNBON   TO DRAHRFDA
 17202              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17203
 17204     IF EMI-ERROR = ZEROS
 17205        GO 3600-UPDATE-BATCH-HEADER.
 17206
 17207     GO TO 8200-SEND-DATAONLY.
 17208
 17209 3590-NOT-FOUND.
 17210     MOVE ER-2192                TO EMI-ERROR.
 17211     MOVE -1                     TO DPFENTRL.
 17212     MOVE AL-UNBON               TO DPFENTRA.
 17213     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17214     GO TO 8200-SEND-DATAONLY.
 17215
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 320
* EL6311.cbl
 17217
 17218******************************************************************
 17219*                                                                *
 17220*           U P D A T E   B A T C H   H E A D E R                *
 17221*                                                                *
 17222******************************************************************
 17223
 17224 3600-UPDATE-BATCH-HEADER.
 17225
 17226* EXEC CICS HANDLE CONDITION
 17227*         NOTFND      (3690-NOT-FOUND)
 17228*    END-EXEC.
 17229*    MOVE '"$I                   ! E #00014809' TO DFHEIV0
 17230     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17231     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17232     MOVE X'4520233030303134383039' TO DFHEIV0(25:11)
 17233     CALL 'kxdfhei1' USING DFHEIV0
 17234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17235
 17236
 17237
 17238* EXEC CICS READ
 17239*        DATASET (FILE-ID-ERPNDB)
 17240*        RIDFLD  (ERPNDB-KEY)
 17241*        SET     (ADDRESS OF PENDING-BUSINESS)
 17242*        UPDATE
 17243*    END-EXEC.
 17244*    MOVE '&"S        EU         (   #00014813' TO DFHEIV0
 17245     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17246     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17247     MOVE X'2020233030303134383133' TO DFHEIV0(25:11)
 17248     CALL 'kxdfhei1' USING DFHEIV0,
 17249           FILE-ID-ERPNDB,
 17250           DFHEIV20,
 17251           DFHEIV99,
 17252           ERPNDB-KEY,
 17253           DFHEIV99,
 17254           DFHEIV99,
 17255           DFHEIV99
 17256     SET ADDRESS OF PENDING-BUSINESS TO
 17257         DFHEIV20
 17258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17259
 17260
 17261     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17262     MOVE 'B'                    TO JP-RECORD-TYPE.
 17263     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17264
 17265     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17266
 17267     PERFORM 8400-LOG-JOURNAL-RECORD.
 17268
 17269     IF DRISSL GREATER THAN ZEROS
 17270        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 17271
 17272     IF DRCANCL GREATER THAN ZEROS
 17273        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 17274
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 321
* EL6311.cbl
 17275
 17276     IF DRLFPRML GREATER THAN ZEROS
 17277        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 17278
 17279     IF DRAHPRML GREATER THAN ZEROS
 17280        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 17281
 17282     IF DRLFRFDL GREATER THAN ZEROS
 17283        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 17284
 17285     IF DRAHRFDL GREATER THAN ZEROS
 17286        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 17287
 17288 3670-REWRITE-BATCH-HEADER.
 17289     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 17290        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 17291        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 17292        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 17293        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 17294        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 17295        MOVE SPACE               TO PB-OUT-BAL-CD
 17296     ELSE
 17297        MOVE 'O'                 TO PB-OUT-BAL-CD.
 17298
 17299     MOVE 'C'                    TO JP-RECORD-TYPE.
 17300     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17301
 17302
 17303* EXEC CICS REWRITE
 17304*         DATASET      (FILE-ID-ERPNDB)
 17305*         FROM         (PENDING-BUSINESS)
 17306*    END-EXEC.
 17307     MOVE LENGTH OF
 17308      PENDING-BUSINESS
 17309       TO DFHEIV11
 17310*    MOVE '&& L                  %   #00014861' TO DFHEIV0
 17311     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17312     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17313     MOVE X'2020233030303134383631' TO DFHEIV0(25:11)
 17314     CALL 'kxdfhei1' USING DFHEIV0,
 17315           FILE-ID-ERPNDB,
 17316           PENDING-BUSINESS,
 17317           DFHEIV11,
 17318           DFHEIV99
 17319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17320
 17321
 17322     PERFORM 8400-LOG-JOURNAL-RECORD.
 17323
 17324     GO TO 7200-DISPLAY-BATCHES.
 17325
 17326 3690-NOT-FOUND.
 17327     MOVE ER-2192                TO EMI-ERROR.
 17328     MOVE -1                     TO DPFENTRL.
 17329     MOVE AL-UNBON               TO DPFENTRA.
 17330     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17331     GO TO 8200-SEND-DATAONLY.
 17332
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 322
* EL6311.cbl
 17334
 17335******************************************************************
 17336*                                                                *
 17337*           R E - D I S P L A Y   R E C O R D                    *
 17338*                                                                *
 17339******************************************************************
 17340
 17341 3900-RE-DISPLAY-RECORD.
 17342
 17343* EXEC CICS HANDLE CONDITION
 17344*         NOTFND   (3990-NOT-FOUND)
 17345*    END-EXEC.
 17346*    MOVE '"$I                   ! F #00014886' TO DFHEIV0
 17347     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17348     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17349     MOVE X'4620233030303134383836' TO DFHEIV0(25:11)
 17350     CALL 'kxdfhei1' USING DFHEIV0
 17351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17352
 17353
 17354     IF PI-DISPLAY-ORIGINAL-BATCH
 17355         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 17356     ELSE
 17357         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 17358
 17359
 17360* EXEC CICS READ
 17361*         DATASET   (FILE-ID)
 17362*         RIDFLD    (PI-PREV-KEY)
 17363*         SET       (ADDRESS OF PENDING-BUSINESS)
 17364*    END-EXEC.
 17365*    MOVE '&"S        E          (   #00014895' TO DFHEIV0
 17366     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17367     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17368     MOVE X'2020233030303134383935' TO DFHEIV0(25:11)
 17369     CALL 'kxdfhei1' USING DFHEIV0,
 17370           FILE-ID,
 17371           DFHEIV20,
 17372           DFHEIV99,
 17373           PI-PREV-KEY,
 17374           DFHEIV99,
 17375           DFHEIV99,
 17376           DFHEIV99
 17377     SET ADDRESS OF PENDING-BUSINESS TO
 17378         DFHEIV20
 17379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17380
 17381
 17382     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 17383
 17384     IF PB-ISSUE
 17385         GO TO 7000-DISPLAY-ISSUES.
 17386
 17387     IF PB-CANCELLATION
 17388         GO TO 7100-DISPLAY-CANCELS.
 17389
 17390     IF PB-BATCH-TRAILER
 17391         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 323
* EL6311.cbl
 17392
 17393 3990-NOT-FOUND.
 17394     MOVE LOW-VALUES             TO EL631BI.
 17395
 17396     IF PI-MAP-NAME = EL631B
 17397         MOVE -1                  TO BMAINTL
 17398     ELSE
 17399         MOVE -1                  TO CMAINTL.
 17400
 17401     GO TO 8100-SEND-INITIAL-MAP.
 17402
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 324
* EL6311.cbl
 17404
 17405***************************************************************
 17406*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 17407*                                                             *
 17408*      1. START BROWSE WITH                                   *
 17409*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 17410*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 17411*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 17412*                                                             *
 17413*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 17414*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 17415*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 17416*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 17417*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 17418*               AND IS IT TO BE DISPLAYED.                    *
 17419*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 17420*               DISPLAYED.                                    *
 17421*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 17422*               DISPLAYED.                                    *
 17423*                                                             *
 17424*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 17425*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 17426***************************************************************
 17427
 17428 4000-BROWSE-DETAIL-FORWARD.
 17429     IF FIRST-TIME
 17430        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 17431     ELSE
 17432        IF SHOW-RECORD
 17433           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 17434           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 17435           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 17436           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 17437           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 17438        ELSE
 17439           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 17440
 17441
 17442* EXEC CICS HANDLE CONDITION
 17443*         NOTFND   (4050-END-RECORDS)
 17444*         ENDFILE  (4050-END-RECORDS)
 17445*    END-EXEC.
 17446*    MOVE '"$I''                  ! G #00014960' TO DFHEIV0
 17447     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 17448     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17449     MOVE X'4720233030303134393630' TO DFHEIV0(25:11)
 17450     CALL 'kxdfhei1' USING DFHEIV0
 17451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17452
 17453
 17454
 17455* EXEC CICS STARTBR
 17456*         DATASET   (FILE-ID-ERPNDB2)
 17457*         RIDFLD    (ERPNDB-ALT-KEY)
 17458*    END-EXEC.
 17459     MOVE 0
 17460       TO DFHEIV11
 17461*    MOVE '&,         G          &   #00014965' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 325
* EL6311.cbl
 17462     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 17463     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17464     MOVE X'2020233030303134393635' TO DFHEIV0(25:11)
 17465     CALL 'kxdfhei1' USING DFHEIV0,
 17466           FILE-ID-ERPNDB2,
 17467           ERPNDB-ALT-KEY,
 17468           DFHEIV99,
 17469           DFHEIV11,
 17470           DFHEIV99
 17471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17472
 17473
 17474     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 17475
 17476     IF FIRST-TIME OR SHOW-RECORD
 17477        MOVE SPACE               TO WS-FIRST-TIME-SW
 17478        GO TO 4005-READ-NEXT-RECORD.
 17479
 17480
 17481* EXEC CICS READNEXT
 17482*         DATASET    (FILE-ID-ERPNDB2)
 17483*         SET        (ADDRESS OF PENDING-BUSINESS)
 17484*         RIDFLD     (ERPNDB-ALT-KEY)
 17485*    END-EXEC.
 17486     MOVE 0
 17487       TO DFHEIV11
 17488*    MOVE '&.S                   )   #00014976' TO DFHEIV0
 17489     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17490     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17491     MOVE X'2020233030303134393736' TO DFHEIV0(25:11)
 17492     CALL 'kxdfhei1' USING DFHEIV0,
 17493           FILE-ID-ERPNDB2,
 17494           DFHEIV20,
 17495           DFHEIV99,
 17496           ERPNDB-ALT-KEY,
 17497           DFHEIV99,
 17498           DFHEIV11,
 17499           DFHEIV99,
 17500           DFHEIV99
 17501     SET ADDRESS OF PENDING-BUSINESS TO
 17502         DFHEIV20
 17503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17504
 17505
 17506 4005-READ-NEXT-RECORD.
 17507
 17508* EXEC CICS READNEXT
 17509*         DATASET    (FILE-ID-ERPNDB2)
 17510*         SET        (ADDRESS OF PENDING-BUSINESS)
 17511*         RIDFLD     (ERPNDB-ALT-KEY)
 17512*    END-EXEC.
 17513     MOVE 0
 17514       TO DFHEIV11
 17515*    MOVE '&.S                   )   #00014983' TO DFHEIV0
 17516     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 17517     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 17518     MOVE X'2020233030303134393833' TO DFHEIV0(25:11)
 17519     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 326
* EL6311.cbl
 17520           FILE-ID-ERPNDB2,
 17521           DFHEIV20,
 17522           DFHEIV99,
 17523           ERPNDB-ALT-KEY,
 17524           DFHEIV99,
 17525           DFHEIV11,
 17526           DFHEIV99,
 17527           DFHEIV99
 17528     SET ADDRESS OF PENDING-BUSINESS TO
 17529         DFHEIV20
 17530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17531
 17532
 17533     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17534
 17535     IF WS-BATCH-PREFIX = '#CL'
 17536        GO TO 4005-READ-NEXT-RECORD.
 17537
 17538     IF SHOW-RECORD
 17539        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 17540           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 17541           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 17542           PB-STATE         NOT = PI-PB-STATE          OR
 17543           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 17544           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 17545           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 17546           GO TO 4050-END-RECORDS
 17547        ELSE
 17548           GO TO 4010-CHECK-REC-TYPE.
 17549
 17550     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 17551        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 17552        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 17553        PB-STATE            NOT = PI-PB-STATE          OR
 17554        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 17555        GO TO 4050-END-RECORDS.
 17556
 17557     IF PB-BATCH-TRAILER
 17558        GO TO 4005-READ-NEXT-RECORD.
 17559
 17560     IF PI-PB-CERT-NO NOT = LOW-VALUES
 17561        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 17562           GO TO 4005-READ-NEXT-RECORD
 17563        ELSE
 17564           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 17565              GO TO 4010-CHECK-REC-TYPE
 17566           ELSE
 17567              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 17568                 GO TO 4010-CHECK-REC-TYPE
 17569              ELSE
 17570                 GO TO 4005-READ-NEXT-RECORD.
 17571
 17572     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 17573        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 17574           GO TO 4005-READ-NEXT-RECORD.
 17575
 17576 4010-CHECK-REC-TYPE.
 17577     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 327
* EL6311.cbl
 17578         IF  PB-CARRIER = PI-CARRIER-SECURITY
 17579             NEXT SENTENCE
 17580         ELSE
 17581             GO TO 4005-READ-NEXT-RECORD.
 17582
 17583     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 17584         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 17585             NEXT SENTENCE
 17586        ELSE
 17587             GO TO 4005-READ-NEXT-RECORD.
 17588
 17589     IF NOT DISPLAY-CHANGE-RECORDS AND
 17590            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 17591        GO TO 4005-READ-NEXT-RECORD.
 17592
 17593     IF DISPLAY-HOLD-RECORDS AND
 17594        NOT PB-RECORD-ON-HOLD
 17595          GO TO 4005-READ-NEXT-RECORD.
 17596
 17597     IF PB-ISSUE
 17598        IF DISPLAY-CHK-REQ-RECORDS
 17599            GO TO 4005-READ-NEXT-RECORD.
 17600
 17601     IF PB-ISSUE
 17602        IF ISSUE-WITH-WARNING
 17603           IF PB-WARNING-ERRORS
 17604              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 17605                  GO TO 4005-READ-NEXT-RECORD
 17606              ELSE
 17607                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17608                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17609                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17610                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17611                 MOVE PB-SV-STATE            TO PI-SV-STATE
 17612                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17613                 GO TO 7000-DISPLAY-ISSUES
 17614           ELSE
 17615              GO TO 4005-READ-NEXT-RECORD.
 17616
 17617     IF PB-ISSUE
 17618        IF (ISSUES-IN-ERROR AND
 17619            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 17620            ALL-ISSUES
 17621            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17622            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17623            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17624            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17625            MOVE PB-SV-STATE            TO PI-SV-STATE
 17626            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17627            GO TO 7000-DISPLAY-ISSUES
 17628        ELSE
 17629            GO TO 4005-READ-NEXT-RECORD.
 17630
 17631     IF PB-CANCELLATION
 17632        IF DISPLAY-CHK-REQ-RECORDS
 17633           IF PB-C-REFUND-REQUESTED
 17634              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17635              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 328
* EL6311.cbl
 17636              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17637              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17638              MOVE PB-SV-STATE            TO PI-SV-STATE
 17639              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17640              GO TO 7100-DISPLAY-CANCELS
 17641           ELSE
 17642               GO TO 4005-READ-NEXT-RECORD.
 17643
 17644     IF PB-CANCELLATION
 17645        IF CANCEL-WITH-WARNING
 17646           IF PB-WARNING-ERRORS
 17647              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 17648                  GO TO 4005-READ-NEXT-RECORD
 17649              ELSE
 17650                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17651                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17652                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17653                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17654                 MOVE PB-SV-STATE            TO PI-SV-STATE
 17655                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17656                 GO TO 7100-DISPLAY-CANCELS
 17657           ELSE
 17658              GO TO 4005-READ-NEXT-RECORD.
 17659
 17660     IF PB-CANCELLATION
 17661        IF (CANCEL-IN-ERROR  AND
 17662            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 17663            ALL-CANCELS
 17664            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17665            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17666            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17667            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17668            MOVE PB-SV-STATE            TO PI-SV-STATE
 17669            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17670            GO TO 7100-DISPLAY-CANCELS.
 17671
 17672     GO TO 4005-READ-NEXT-RECORD.
 17673
 17674 4050-END-RECORDS.
 17675******************************************************************
 17676*                                                                *
 17677*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 17678*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 17679*         PROGRAM.                                               *
 17680*                                                                *
 17681******************************************************************
 17682
 17683     IF BROWSE-STARTED
 17684        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 17685
 17686* EXEC CICS ENDBR
 17687*            DATASET  (FILE-ID-ERPNDB2)
 17688*       END-EXEC.
 17689     MOVE 0
 17690       TO DFHEIV11
 17691*    MOVE '&2                    $   #00015141' TO DFHEIV0
 17692     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 17693     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 329
* EL6311.cbl
 17694     MOVE X'2020233030303135313431' TO DFHEIV0(25:11)
 17695     CALL 'kxdfhei1' USING DFHEIV0,
 17696           FILE-ID-ERPNDB2,
 17697           DFHEIV11,
 17698           DFHEIV99
 17699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17700
 17701
 17702     IF  EIBTRNID NOT = TRANS-EXB1
 17703         IF PENDING-BUS-RECS-FOUND
 17704             NEXT SENTENCE
 17705           ELSE
 17706             MOVE '9'            TO PI-BROWSE-SW
 17707             GO TO 9400-CLEAR.
 17708
 17709     IF SHOW-RECORD
 17710        MOVE ER-2253            TO EMI-ERROR
 17711       ELSE
 17712        MOVE ER-2254            TO EMI-ERROR.
 17713
 17714     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17715
 17716     IF PI-MAP-NAME = SPACES
 17717        MOVE -1                  TO DPFENTRL
 17718        MOVE EL631D               TO PI-MAP-NAME
 17719        GO TO 8100-SEND-INITIAL-MAP.
 17720
 17721     IF PI-MAP-NAME = EL631B
 17722        MOVE -1                  TO BMAINTL
 17723     ELSE
 17724        IF PI-MAP-NAME = EL631C
 17725           MOVE -1               TO CMAINTL
 17726        ELSE
 17727           MOVE -1               TO DPFENTRL.
 17728
 17729     GO TO 8200-SEND-DATAONLY.
 17730
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 330
* EL6311.cbl
 17732
 17733***************************************************************
 17734*                                                             *
 17735*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 17736*                                                             *
 17737*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 17738*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 17739*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 17740*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 17741*                                                             *
 17742*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 17743*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 17744*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 17745*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 17746*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 17747*                AND IS IT TO BE DISPLAYED.                   *
 17748*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 17749*                DISPLAYED.                                   *
 17750*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 17751*                DISPLAYED.                                   *
 17752*                                                             *
 17753*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 17754*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 17755*                                                             *
 17756*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 17757*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 17758*                THEY ARE NOT TO BE DISPLAYED.                *
 17759*                                                             *
 17760***************************************************************
 17761
 17762 4100-BROWSE-PRIMARY-FORWARD.
 17763     IF FIRST-TIME  OR SHOW-RECORD
 17764        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 17765        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 17766        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 17767     ELSE
 17768        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 17769        IF ERPNDB-BATCH-SEQ-NO = +9999
 17770           GO TO 4150-END-BATCH
 17771        ELSE
 17772           IF DISPLAY-CHANGE-RECORDS
 17773              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 17774           ELSE
 17775              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 17776              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 17777
 17778     IF FIRST-TIME
 17779         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 17780            PI-PB-BATCH-SEQ-NO NOT = ZERO
 17781              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 17782
 17783
 17784* EXEC CICS HANDLE CONDITION
 17785*         ENDFILE  (4150-END-BATCH)
 17786*    END-EXEC.
 17787*    MOVE '"$''                   ! H #00015226' TO DFHEIV0
 17788     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 17789     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 331
* EL6311.cbl
 17790     MOVE X'4820233030303135323236' TO DFHEIV0(25:11)
 17791     CALL 'kxdfhei1' USING DFHEIV0
 17792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17793
 17794
 17795 4105-READ-NEXT.
 17796
 17797* EXEC CICS HANDLE CONDITION
 17798*         NOTFND    (4150-END-BATCH)
 17799*    END-EXEC.
 17800*    MOVE '"$I                   ! I #00015231' TO DFHEIV0
 17801     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17802     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17803     MOVE X'4920233030303135323331' TO DFHEIV0(25:11)
 17804     CALL 'kxdfhei1' USING DFHEIV0
 17805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17806
 17807
 17808     MOVE SPACES                 TO WS-REC-FOUND-SW.
 17809
 17810     IF PI-DISPLAY-ORIGINAL-BATCH
 17811        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 17812     ELSE
 17813        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 17814
 17815
 17816* EXEC CICS READ
 17817*         DATASET   (FILE-ID)
 17818*         SET       (ADDRESS OF PENDING-BUSINESS)
 17819*         RIDFLD    (ERPNDB-KEY)
 17820*         GTEQ
 17821*    END-EXEC.
 17822*    MOVE '&"S        G          (   #00015242' TO DFHEIV0
 17823     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 17824     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17825     MOVE X'2020233030303135323432' TO DFHEIV0(25:11)
 17826     CALL 'kxdfhei1' USING DFHEIV0,
 17827           FILE-ID,
 17828           DFHEIV20,
 17829           DFHEIV99,
 17830           ERPNDB-KEY,
 17831           DFHEIV99,
 17832           DFHEIV99,
 17833           DFHEIV99
 17834     SET ADDRESS OF PENDING-BUSINESS TO
 17835         DFHEIV20
 17836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17837
 17838
 17839     IF PI-DISPLAY-ORIGINAL-BATCH
 17840        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 17841           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 17842           GO TO 4150-END-BATCH
 17843        ELSE
 17844           IF PB-BATCH-TRAILER
 17845              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 17846              GO TO 4105-READ-NEXT
 17847           ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 332
* EL6311.cbl
 17848              NEXT SENTENCE
 17849     ELSE
 17850        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 17851           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 17852           GO TO 4150-END-BATCH.
 17853
 17854     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 17855
 17856     IF WS-BATCH-PREFIX = '#CL'
 17857         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 17858         GO TO 4105-READ-NEXT.
 17859
 17860     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 17861     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 17862     MOVE PB-STATE               TO PI-PB-STATE.
 17863     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 17864
 17865     IF PB-BATCH-TRAILER
 17866        IF SHOW-RECORD
 17867           GO TO 4150-END-BATCH
 17868        ELSE
 17869           MOVE ER-2251         TO EMI-ERROR
 17870           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 17871           MOVE 1               TO PI-BROWSE-TYPE
 17872           GO TO 7200-DISPLAY-BATCHES.
 17873
 17874     IF SHOW-RECORD
 17875           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 17876              GO TO 4110-BUMP-SEQ
 17877           ELSE
 17878              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 17879                 GO TO 4110-BUMP-SEQ
 17880              ELSE
 17881                 GO TO 4107-CHECK-REC-TYPE.
 17882
 17883     IF NOT  PI-PRIMARY-WITH-SELECT
 17884        GO TO 4107-CHECK-REC-TYPE.
 17885
 17886     IF PI-PB-CERT-NO NOT = LOW-VALUES
 17887        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 17888           GO TO 4110-BUMP-SEQ
 17889        ELSE
 17890           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 17891              GO TO 4107-CHECK-REC-TYPE
 17892           ELSE
 17893              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 17894                 GO TO 4107-CHECK-REC-TYPE
 17895              ELSE
 17896                 GO TO 4110-BUMP-SEQ.
 17897
 17898     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 17899        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 17900           GO TO 4110-BUMP-SEQ.
 17901
 17902 4107-CHECK-REC-TYPE.
 17903     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 17904         IF  PB-CARRIER = PI-CARRIER-SECURITY
 17905             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 333
* EL6311.cbl
 17906           ELSE
 17907             GO TO 4110-BUMP-SEQ.
 17908
 17909     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 17910         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 17911             NEXT SENTENCE
 17912           ELSE
 17913             GO TO 4110-BUMP-SEQ.
 17914
 17915     IF NOT DISPLAY-CHANGE-RECORDS AND
 17916        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 17917           GO TO 4110-BUMP-SEQ.
 17918
 17919     IF DISPLAY-HOLD-RECORDS AND
 17920        NOT PB-RECORD-ON-HOLD
 17921          GO TO 4110-BUMP-SEQ.
 17922
 17923     IF PB-ISSUE
 17924        IF DISPLAY-CHK-REQ-RECORDS
 17925            GO TO 4110-BUMP-SEQ.
 17926
 17927     IF PB-ISSUE
 17928        IF ISSUE-WITH-WARNING
 17929           IF PB-WARNING-ERRORS
 17930              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 17931                  GO TO 4110-BUMP-SEQ
 17932              ELSE
 17933                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17934                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17935                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17936                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17937                 MOVE PB-SV-STATE            TO PI-SV-STATE
 17938                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17939                 GO TO 7000-DISPLAY-ISSUES
 17940        ELSE
 17941            GO TO 4110-BUMP-SEQ.
 17942
 17943     IF PB-ISSUE
 17944        IF (ISSUES-IN-ERROR AND
 17945            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 17946            ALL-ISSUES
 17947            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17948            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17949            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17950            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17951            MOVE PB-SV-STATE            TO PI-SV-STATE
 17952            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17953            GO TO 7000-DISPLAY-ISSUES
 17954        ELSE
 17955            GO TO 4110-BUMP-SEQ.
 17956
 17957     IF PB-CANCELLATION
 17958        IF DISPLAY-CHK-REQ-RECORDS
 17959           IF PB-C-REFUND-REQUESTED
 17960              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17961              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17962              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17963              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 334
* EL6311.cbl
 17964              MOVE PB-SV-STATE            TO PI-SV-STATE
 17965              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17966              GO TO 7100-DISPLAY-CANCELS
 17967           ELSE
 17968              GO TO 4110-BUMP-SEQ.
 17969
 17970     IF PB-CANCELLATION
 17971        IF CANCEL-WITH-WARNING
 17972           IF PB-WARNING-ERRORS
 17973              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 17974                  GO TO 4110-BUMP-SEQ
 17975              ELSE
 17976                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17977                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17978                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17979                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17980                 MOVE PB-SV-STATE            TO PI-SV-STATE
 17981                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 17982                 GO TO 7100-DISPLAY-CANCELS
 17983           ELSE
 17984              GO TO 4110-BUMP-SEQ.
 17985
 17986     IF PB-CANCELLATION
 17987        IF (CANCEL-IN-ERROR  AND
 17988            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 17989            ALL-CANCELS
 17990            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 17991            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 17992            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 17993            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 17994            MOVE PB-SV-STATE            TO PI-SV-STATE
 17995            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 17996            GO TO 7100-DISPLAY-CANCELS.
 17997
 17998 4110-BUMP-SEQ.
 17999     IF NOT DISPLAY-CHANGE-RECORDS
 18000        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18001        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18002     ELSE
 18003        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18004           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18005           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18006        ELSE
 18007           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18008           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 18009
 18010     GO TO 4105-READ-NEXT.
 18011
 18012 4150-END-BATCH.
 18013******************************************************************
 18014*                                                                *
 18015*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18016*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 18017*         PROGRAM.                                               *
 18018*                                                                *
 18019******************************************************************
 18020
 18021     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 335
* EL6311.cbl
 18022         IF PENDING-BUS-RECS-FOUND
 18023             NEXT SENTENCE
 18024           ELSE
 18025             MOVE '9'            TO PI-BROWSE-SW
 18026             GO TO 9400-CLEAR.
 18027
 18028     IF SHOW-RECORD
 18029        MOVE ER-2253             TO EMI-ERROR
 18030     ELSE
 18031        MOVE ER-2251             TO EMI-ERROR.
 18032
 18033     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18034
 18035     IF PI-MAP-NAME = SPACES
 18036        MOVE -1                  TO BMAINTL
 18037        MOVE EL631B              TO PI-MAP-NAME
 18038        GO TO 8100-SEND-INITIAL-MAP.
 18039
 18040     IF PI-MAP-NAME = EL631B
 18041        MOVE -1                  TO BMAINTL
 18042     ELSE
 18043        IF PI-MAP-NAME = EL631C
 18044           MOVE -1               TO CMAINTL
 18045        ELSE
 18046           MOVE -1               TO DPFENTRL.
 18047
 18048     GO TO 8200-SEND-DATAONLY.
 18049
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 336
* EL6311.cbl
 18051
 18052***************************************************************
 18053*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 18054*                                                             *
 18055*      1. START BROWSE WITH                                   *
 18056*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18057*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18058*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18059*                                                             *
 18060*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18061*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18062*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18063*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18064*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18065*               AND IS IT TO BE DISPLAYED.                    *
 18066*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18067*               DISPLAYED.                                    *
 18068*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18069*               DISPLAYED.                                    *
 18070*                                                             *
 18071*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18072*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18073***************************************************************
 18074
 18075 4200-BROWSE-CSR-FORWARD.
 18076
 18077     IF FIRST-TIME
 18078        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 18079     ELSE
 18080        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 18081
 18082
 18083* EXEC CICS HANDLE CONDITION
 18084*         NOTFND   (4250-END-RECORDS)
 18085*         ENDFILE  (4250-END-RECORDS)
 18086*    END-EXEC.
 18087*    MOVE '"$I''                  ! J #00015492' TO DFHEIV0
 18088     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18089     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18090     MOVE X'4A20233030303135343932' TO DFHEIV0(25:11)
 18091     CALL 'kxdfhei1' USING DFHEIV0
 18092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18093
 18094
 18095
 18096* EXEC CICS STARTBR
 18097*         DATASET   (FILE-ID-ERPNDB4)
 18098*         RIDFLD    (ERPNDB-CSR-KEY)
 18099*    END-EXEC.
 18100     MOVE 0
 18101       TO DFHEIV11
 18102*    MOVE '&,         G          &   #00015497' TO DFHEIV0
 18103     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18104     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18105     MOVE X'2020233030303135343937' TO DFHEIV0(25:11)
 18106     CALL 'kxdfhei1' USING DFHEIV0,
 18107           FILE-ID-ERPNDB4,
 18108           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 337
* EL6311.cbl
 18109           DFHEIV99,
 18110           DFHEIV11,
 18111           DFHEIV99
 18112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18113
 18114
 18115     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18116
 18117     IF FIRST-TIME
 18118        MOVE SPACE               TO WS-FIRST-TIME-SW
 18119        GO TO 4205-READ-NEXT-RECORD.
 18120
 18121
 18122* EXEC CICS READNEXT
 18123*         DATASET    (FILE-ID-ERPNDB4)
 18124*         SET        (ADDRESS OF PENDING-BUSINESS)
 18125*         RIDFLD     (ERPNDB-CSR-KEY)
 18126*    END-EXEC.
 18127     MOVE 0
 18128       TO DFHEIV11
 18129*    MOVE '&.S                   )   #00015508' TO DFHEIV0
 18130     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18131     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18132     MOVE X'2020233030303135353038' TO DFHEIV0(25:11)
 18133     CALL 'kxdfhei1' USING DFHEIV0,
 18134           FILE-ID-ERPNDB4,
 18135           DFHEIV20,
 18136           DFHEIV99,
 18137           ERPNDB-CSR-KEY,
 18138           DFHEIV99,
 18139           DFHEIV11,
 18140           DFHEIV99,
 18141           DFHEIV99
 18142     SET ADDRESS OF PENDING-BUSINESS TO
 18143         DFHEIV20
 18144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18145
 18146
 18147 4205-READ-NEXT-RECORD.
 18148
 18149
 18150* EXEC CICS READNEXT
 18151*         DATASET    (FILE-ID-ERPNDB4)
 18152*         SET        (ADDRESS OF PENDING-BUSINESS)
 18153*         RIDFLD     (ERPNDB-CSR-KEY)
 18154*    END-EXEC.
 18155     MOVE 0
 18156       TO DFHEIV11
 18157*    MOVE '&.S                   )   #00015516' TO DFHEIV0
 18158     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18159     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18160     MOVE X'2020233030303135353136' TO DFHEIV0(25:11)
 18161     CALL 'kxdfhei1' USING DFHEIV0,
 18162           FILE-ID-ERPNDB4,
 18163           DFHEIV20,
 18164           DFHEIV99,
 18165           ERPNDB-CSR-KEY,
 18166           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 338
* EL6311.cbl
 18167           DFHEIV11,
 18168           DFHEIV99,
 18169           DFHEIV99
 18170     SET ADDRESS OF PENDING-BUSINESS TO
 18171         DFHEIV20
 18172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18173
 18174
 18175     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18176
 18177     IF WS-BATCH-PREFIX = '#CL'
 18178        GO TO 4205-READ-NEXT-RECORD.
 18179
 18180     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 18181        PB-CSR-ID           NOT = PI-PB-CSR-ID
 18182        GO TO 4250-END-RECORDS.
 18183
 18184     IF PB-BATCH-TRAILER
 18185        GO TO 4205-READ-NEXT-RECORD.
 18186
 18187     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18188        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18189           GO TO 4205-READ-NEXT-RECORD
 18190        ELSE
 18191           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18192              GO TO 4210-CHECK-REC-TYPE
 18193           ELSE
 18194              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18195                 GO TO 4210-CHECK-REC-TYPE
 18196              ELSE
 18197                 GO TO 4205-READ-NEXT-RECORD.
 18198
 18199     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18200        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18201           GO TO 4205-READ-NEXT-RECORD.
 18202
 18203 4210-CHECK-REC-TYPE.
 18204     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18205         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18206             NEXT SENTENCE
 18207         ELSE
 18208             GO TO 4205-READ-NEXT-RECORD.
 18209
 18210     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18211         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18212             NEXT SENTENCE
 18213        ELSE
 18214             GO TO 4205-READ-NEXT-RECORD.
 18215
 18216     IF NOT DISPLAY-CHANGE-RECORDS AND
 18217            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18218        GO TO 4205-READ-NEXT-RECORD.
 18219
 18220     IF DISPLAY-HOLD-RECORDS AND
 18221        NOT PB-RECORD-ON-HOLD
 18222          GO TO 4205-READ-NEXT-RECORD.
 18223
 18224     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 339
* EL6311.cbl
 18225        IF DISPLAY-CHK-REQ-RECORDS
 18226            GO TO 4205-READ-NEXT-RECORD.
 18227
 18228     IF PB-ISSUE
 18229        IF ISSUE-WITH-WARNING
 18230           IF PB-WARNING-ERRORS
 18231              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18232                  GO TO 4205-READ-NEXT-RECORD
 18233              ELSE
 18234                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18235                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18236                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18237                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18238                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18239                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18240                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18241                 GO TO 7000-DISPLAY-ISSUES
 18242           ELSE
 18243              GO TO 4205-READ-NEXT-RECORD.
 18244
 18245     IF PB-ISSUE
 18246        IF (ISSUES-IN-ERROR AND
 18247            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18248            ALL-ISSUES
 18249            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18250            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18251            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18252            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18253            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18254            MOVE PB-SV-STATE            TO PI-SV-STATE
 18255            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18256            GO TO 7000-DISPLAY-ISSUES
 18257        ELSE
 18258            GO TO 4205-READ-NEXT-RECORD.
 18259
 18260     IF PB-CANCELLATION
 18261        IF DISPLAY-CHK-REQ-RECORDS
 18262           IF PB-C-REFUND-REQUESTED
 18263              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18264              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18265              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18266              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18267              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18268              MOVE PB-SV-STATE            TO PI-SV-STATE
 18269              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18270              GO TO 7100-DISPLAY-CANCELS
 18271           ELSE
 18272               GO TO 4205-READ-NEXT-RECORD.
 18273
 18274     IF PB-CANCELLATION
 18275        IF CANCEL-WITH-WARNING
 18276           IF PB-WARNING-ERRORS
 18277              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18278                  GO TO 4205-READ-NEXT-RECORD
 18279              ELSE
 18280                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18281                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18282                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 340
* EL6311.cbl
 18283                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18284                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18285                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18286                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18287                 GO TO 7100-DISPLAY-CANCELS
 18288           ELSE
 18289              GO TO 4205-READ-NEXT-RECORD.
 18290
 18291     IF PB-CANCELLATION
 18292        IF (CANCEL-IN-ERROR  AND
 18293            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18294            ALL-CANCELS
 18295            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18296            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 18297            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18298            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18299            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18300            MOVE PB-SV-STATE            TO PI-SV-STATE
 18301            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18302            GO TO 7100-DISPLAY-CANCELS.
 18303
 18304     GO TO 4205-READ-NEXT-RECORD.
 18305
 18306 4250-END-RECORDS.
 18307******************************************************************
 18308*                                                                *
 18309*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18310*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18311*         PROGRAM.                                               *
 18312*                                                                *
 18313******************************************************************
 18314
 18315     IF BROWSE-STARTED
 18316        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18317
 18318* EXEC CICS ENDBR
 18319*            DATASET  (FILE-ID-ERPNDB4)
 18320*       END-EXEC.
 18321     MOVE 0
 18322       TO DFHEIV11
 18323*    MOVE '&2                    $   #00015664' TO DFHEIV0
 18324     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18325     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18326     MOVE X'2020233030303135363634' TO DFHEIV0(25:11)
 18327     CALL 'kxdfhei1' USING DFHEIV0,
 18328           FILE-ID-ERPNDB4,
 18329           DFHEIV11,
 18330           DFHEIV99
 18331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18332
 18333
 18334     IF  EIBTRNID NOT = TRANS-EXB1
 18335         IF PENDING-BUS-RECS-FOUND
 18336             NEXT SENTENCE
 18337           ELSE
 18338             MOVE '9'            TO PI-BROWSE-SW
 18339             GO TO 9400-CLEAR.
 18340
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 341
* EL6311.cbl
 18341     IF SHOW-RECORD
 18342        MOVE ER-2253            TO EMI-ERROR
 18343       ELSE
 18344        MOVE ER-2254            TO EMI-ERROR.
 18345
 18346     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18347
 18348     IF PI-MAP-NAME = SPACES
 18349        MOVE -1                  TO DPFENTRL
 18350        MOVE EL631D               TO PI-MAP-NAME
 18351        GO TO 8100-SEND-INITIAL-MAP.
 18352
 18353     IF PI-MAP-NAME = EL631B
 18354        MOVE -1                  TO BMAINTL
 18355     ELSE
 18356        IF PI-MAP-NAME = EL631C
 18357           MOVE -1               TO CMAINTL
 18358        ELSE
 18359           MOVE -1               TO DPFENTRL.
 18360
 18361     GO TO 8200-SEND-DATAONLY.
 18362
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 342
* EL6311.cbl
 18364
 18365***************************************************************
 18366*                                                             *
 18367*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 18368*                                                             *
 18369*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 18370*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18371*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18372*                                                             *
 18373*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18374*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18375*          A. IS IT WITHIN THE SAME COMPANY                   *
 18376*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18377*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18378*                AND IS IT TO BE DISPLAYED.                   *
 18379*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18380*                DISPLAYED.                                   *
 18381*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18382*                DISPLAYED.                                   *
 18383*                                                             *
 18384*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18385*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18386*                                                             *
 18387*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18388*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18389*                THEY ARE NOT TO BE DISPLAYED.                *
 18390*                                                             *
 18391***************************************************************
 18392
 18393 4300-BROWSE-FILE-FORWARD.
 18394     IF FIRST-TIME OR SHOW-RECORD
 18395        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 18396        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 18397        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 18398     ELSE
 18399        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18400        IF ERPNDB-BATCH-SEQ-NO = +9999
 18401           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 18402        ELSE
 18403           IF DISPLAY-CHANGE-RECORDS
 18404              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18405           ELSE
 18406              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18407              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18408
 18409
 18410* EXEC CICS HANDLE CONDITION
 18411*         ENDFILE  (4350-END-BATCH)
 18412*         NOTFND   (4350-END-BATCH)
 18413*    END-EXEC.
 18414*    MOVE '"$''I                  ! K #00015743' TO DFHEIV0
 18415     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18417     MOVE X'4B20233030303135373433' TO DFHEIV0(25:11)
 18418     CALL 'kxdfhei1' USING DFHEIV0
 18419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18420
 18421
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 343
* EL6311.cbl
 18422 4305-READ-NEXT.
 18423     IF PI-DISPLAY-ORIGINAL-BATCH
 18424        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18425     ELSE
 18426        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18427
 18428
 18429* EXEC CICS READ
 18430*         DATASET   (FILE-ID)
 18431*         SET       (ADDRESS OF PENDING-BUSINESS)
 18432*         RIDFLD    (ERPNDB-KEY)
 18433*         GTEQ
 18434*    END-EXEC.
 18435*    MOVE '&"S        G          (   #00015754' TO DFHEIV0
 18436     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18437     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18438     MOVE X'2020233030303135373534' TO DFHEIV0(25:11)
 18439     CALL 'kxdfhei1' USING DFHEIV0,
 18440           FILE-ID,
 18441           DFHEIV20,
 18442           DFHEIV99,
 18443           ERPNDB-KEY,
 18444           DFHEIV99,
 18445           DFHEIV99,
 18446           DFHEIV99
 18447     SET ADDRESS OF PENDING-BUSINESS TO
 18448         DFHEIV20
 18449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18450
 18451
 18452     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 18453        GO TO 4350-END-BATCH.
 18454
 18455     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 18456                                    WS-BATCH-NO.
 18457
 18458     IF  WS-BATCH-PREFIX = '#CL'
 18459         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 18460         GO TO 4305-READ-NEXT.
 18461
 18462     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 18463     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 18464     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 18465     MOVE PB-STATE               TO PI-PB-STATE.
 18466     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 18467
 18468     IF PB-BATCH-TRAILER
 18469        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 18470        GO TO 4305-READ-NEXT.
 18471
 18472     IF SHOW-RECORD
 18473           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 18474              GO TO 4310-BUMP-SEQ
 18475           ELSE
 18476              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18477                 GO TO 4310-BUMP-SEQ
 18478              ELSE
 18479                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 344
* EL6311.cbl
 18480
 18481     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18482        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18483           GO TO 4310-BUMP-SEQ
 18484        ELSE
 18485           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18486              GO TO 4307-CHECK-REC-TYPE
 18487           ELSE
 18488              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18489                 GO TO 4307-CHECK-REC-TYPE
 18490              ELSE
 18491                 GO TO 4310-BUMP-SEQ.
 18492
 18493     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18494        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18495           GO TO 4310-BUMP-SEQ.
 18496
 18497 4307-CHECK-REC-TYPE.
 18498     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18499         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18500             NEXT SENTENCE
 18501         ELSE
 18502             GO TO 4310-BUMP-SEQ.
 18503
 18504     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18505         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18506             NEXT SENTENCE
 18507        ELSE
 18508             GO TO 4310-BUMP-SEQ.
 18509
 18510     IF NOT DISPLAY-CHANGE-RECORDS AND
 18511            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18512        GO TO 4310-BUMP-SEQ.
 18513
 18514     IF DISPLAY-HOLD-RECORDS AND
 18515        NOT PB-RECORD-ON-HOLD
 18516          GO TO 4310-BUMP-SEQ.
 18517
 18518     IF PB-ISSUE
 18519        IF DISPLAY-CHK-REQ-RECORDS
 18520           GO TO 4310-BUMP-SEQ.
 18521
 18522     IF PB-ISSUE
 18523        IF ISSUE-WITH-WARNING
 18524           IF PB-WARNING-ERRORS
 18525              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18526                  GO TO 4310-BUMP-SEQ
 18527              ELSE
 18528                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18529                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18530                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18531                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18532                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18533                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18534                 GO TO 7000-DISPLAY-ISSUES
 18535           ELSE
 18536              GO TO 4310-BUMP-SEQ.
 18537
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 345
* EL6311.cbl
 18538     IF PB-ISSUE
 18539        IF (ISSUES-IN-ERROR AND
 18540            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18541            ALL-ISSUES
 18542            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18543            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18544            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18545            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18546            MOVE PB-SV-STATE            TO PI-SV-STATE
 18547            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18548            GO TO 7000-DISPLAY-ISSUES
 18549        ELSE
 18550            GO TO 4310-BUMP-SEQ.
 18551
 18552     IF PB-CANCELLATION
 18553        IF DISPLAY-CHK-REQ-RECORDS
 18554           IF PB-C-REFUND-REQUESTED
 18555              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18556              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18557              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18558              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18559              MOVE PB-SV-STATE            TO PI-SV-STATE
 18560              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18561              GO TO 7100-DISPLAY-CANCELS
 18562           ELSE
 18563              GO TO 4310-BUMP-SEQ.
 18564
 18565     IF PB-CANCELLATION
 18566        IF CANCEL-WITH-WARNING
 18567           IF PB-WARNING-ERRORS
 18568              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18569                  GO TO 4310-BUMP-SEQ
 18570              ELSE
 18571                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18572                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18573                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18574                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18575                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18576                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18577                 GO TO 7100-DISPLAY-CANCELS
 18578           ELSE
 18579              GO TO 4310-BUMP-SEQ.
 18580
 18581     IF PB-CANCELLATION
 18582        IF (CANCEL-IN-ERROR  AND
 18583            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18584            ALL-CANCELS
 18585            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18586            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18587            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18588            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18589            MOVE PB-SV-STATE            TO PI-SV-STATE
 18590            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18591            GO TO 7100-DISPLAY-CANCELS.
 18592
 18593 4310-BUMP-SEQ.
 18594     IF NOT DISPLAY-CHANGE-RECORDS
 18595        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 346
* EL6311.cbl
 18596        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 18597     ELSE
 18598        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 18599           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 18600           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 18601        ELSE
 18602           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 18603           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 18604
 18605     GO TO 4305-READ-NEXT.
 18606
 18607 4350-END-BATCH.
 18608
 18609******************************************************************
 18610*                                                                *
 18611*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18612*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 18613*         PROGRAM.                                               *
 18614*                                                                *
 18615******************************************************************
 18616
 18617     IF  EIBTRNID NOT = TRANS-EXB1
 18618         IF PENDING-BUS-RECS-FOUND
 18619             NEXT SENTENCE
 18620           ELSE
 18621             MOVE '9'            TO PI-BROWSE-SW
 18622             GO TO 9400-CLEAR.
 18623
 18624     IF SHOW-RECORD
 18625        MOVE ER-2253            TO EMI-ERROR
 18626     ELSE
 18627        MOVE ER-2251            TO EMI-ERROR.
 18628
 18629     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18630
 18631     IF PI-MAP-NAME = SPACES
 18632        MOVE -1                  TO BMAINTL
 18633        MOVE EL631B               TO PI-MAP-NAME
 18634        GO TO 8100-SEND-INITIAL-MAP.
 18635
 18636     IF PI-MAP-NAME = EL631B
 18637        MOVE -1                  TO BMAINTL
 18638     ELSE
 18639        IF PI-MAP-NAME = EL631C
 18640           MOVE -1               TO CMAINTL
 18641        ELSE
 18642           MOVE -1               TO DPFENTRL.
 18643
 18644     GO TO 8200-SEND-DATAONLY.
 18645
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 347
* EL6311.cbl
 18647
 18648******************************************************************
 18649*                                                                *
 18650*        B R O W S E   D E T A I L   B A C K W A R D             *
 18651*                                                                *
 18652******************************************************************
 18653
 18654 4500-BROWSE-DETAIL-BACKWARD.
 18655
 18656     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 18657
 18658
 18659* EXEC CICS HANDLE CONDITION
 18660*         NOTFND   (4570-NOT-FOUND)
 18661*         ENDFILE  (4550-END-RECORDS)
 18662*    END-EXEC
 18663*    MOVE '"$I''                  ! L #00015967' TO DFHEIV0
 18664     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18666     MOVE X'4C20233030303135393637' TO DFHEIV0(25:11)
 18667     CALL 'kxdfhei1' USING DFHEIV0
 18668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18669
 18670
 18671* EXEC CICS STARTBR
 18672*         DATASET   (FILE-ID-ERPNDB2)
 18673*         RIDFLD    (ERPNDB-ALT-KEY)
 18674*    END-EXEC.
 18675     MOVE 0
 18676       TO DFHEIV11
 18677*    MOVE '&,         G          &   #00015972' TO DFHEIV0
 18678     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18679     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18680     MOVE X'2020233030303135393732' TO DFHEIV0(25:11)
 18681     CALL 'kxdfhei1' USING DFHEIV0,
 18682           FILE-ID-ERPNDB2,
 18683           ERPNDB-ALT-KEY,
 18684           DFHEIV99,
 18685           DFHEIV11,
 18686           DFHEIV99
 18687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18688
 18689
 18690     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 18691                                    WS-FIRST-TIME-SW.
 18692
 18693 4505-READ-PREV-RECORD.
 18694
 18695* EXEC CICS READPREV
 18696*         DATASET    (FILE-ID-ERPNDB2)
 18697*         SET        (ADDRESS OF PENDING-BUSINESS)
 18698*         RIDFLD     (ERPNDB-ALT-KEY)
 18699*    END-EXEC.
 18700     MOVE 0
 18701       TO DFHEIV11
 18702*    MOVE '&0S                   )   #00015981' TO DFHEIV0
 18703     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 18704     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 348
* EL6311.cbl
 18705     MOVE X'2020233030303135393831' TO DFHEIV0(25:11)
 18706     CALL 'kxdfhei1' USING DFHEIV0,
 18707           FILE-ID-ERPNDB2,
 18708           DFHEIV20,
 18709           DFHEIV99,
 18710           ERPNDB-ALT-KEY,
 18711           DFHEIV99,
 18712           DFHEIV11,
 18713           DFHEIV99,
 18714           DFHEIV99
 18715     SET ADDRESS OF PENDING-BUSINESS TO
 18716         DFHEIV20
 18717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18718
 18719
 18720     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18721
 18722     IF WS-BATCH-PREFIX = '#CL'
 18723         GO TO 4505-READ-PREV-RECORD.
 18724
 18725     IF FIRST-TIME
 18726         MOVE SPACE               TO WS-FIRST-TIME-SW
 18727         GO TO 4505-READ-PREV-RECORD.
 18728
 18729     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 18730        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 18731        PB-GROUPING      NOT = PI-PB-GROUPING OR
 18732        PB-STATE         NOT = PI-PB-STATE    OR
 18733        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 18734          GO TO 4550-END-RECORDS.
 18735
 18736
 18737     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 18738
 18739     IF PB-BATCH-TRAILER
 18740        GO TO 4505-READ-PREV-RECORD.
 18741
 18742     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18743
 18744     IF  WS-BATCH-PREFIX = '#CL'
 18745         GO TO 4505-READ-PREV-RECORD.
 18746
 18747     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18748        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18749           GO TO 4505-READ-PREV-RECORD
 18750        ELSE
 18751           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18752              GO TO 4510-CHECK-REC-TYPE
 18753           ELSE
 18754              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18755                 GO TO 4510-CHECK-REC-TYPE
 18756              ELSE
 18757                 GO TO 4505-READ-PREV-RECORD.
 18758
 18759     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18760        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18761           GO TO 4505-READ-PREV-RECORD.
 18762
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 349
* EL6311.cbl
 18763 4510-CHECK-REC-TYPE.
 18764     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 18765         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18766             NEXT SENTENCE
 18767         ELSE
 18768             GO TO 4505-READ-PREV-RECORD.
 18769
 18770     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18771         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18772             NEXT SENTENCE
 18773        ELSE
 18774             GO TO 4505-READ-PREV-RECORD.
 18775
 18776     IF NOT DISPLAY-CHANGE-RECORDS AND
 18777            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18778        GO TO 4505-READ-PREV-RECORD.
 18779
 18780     IF DISPLAY-HOLD-RECORDS AND
 18781        NOT PB-RECORD-ON-HOLD
 18782          GO TO 4505-READ-PREV-RECORD.
 18783
 18784     IF PB-ISSUE
 18785        IF DISPLAY-CHK-REQ-RECORDS
 18786           GO TO 4505-READ-PREV-RECORD.
 18787
 18788     IF PB-ISSUE
 18789        IF ISSUE-WITH-WARNING
 18790           IF PB-WARNING-ERRORS
 18791              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18792                  GO TO 4505-READ-PREV-RECORD
 18793              ELSE
 18794                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18795                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18796                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18797                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18798                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18799                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18800                 GO TO 7000-DISPLAY-ISSUES
 18801           ELSE
 18802              GO TO 4505-READ-PREV-RECORD.
 18803
 18804     IF PB-ISSUE
 18805        IF (ISSUES-IN-ERROR AND
 18806            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18807            ALL-ISSUES
 18808            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18809            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18810            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18811            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18812            MOVE PB-SV-STATE            TO PI-SV-STATE
 18813            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18814            GO TO 7000-DISPLAY-ISSUES
 18815        ELSE
 18816            GO TO 4505-READ-PREV-RECORD.
 18817
 18818     IF PB-CANCELLATION
 18819        IF DISPLAY-CHK-REQ-RECORDS
 18820           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 350
* EL6311.cbl
 18821              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18822              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18823              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18824              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18825              MOVE PB-SV-STATE            TO PI-SV-STATE
 18826              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18827              GO TO 7100-DISPLAY-CANCELS
 18828           ELSE
 18829              GO TO 4505-READ-PREV-RECORD.
 18830
 18831     IF PB-CANCELLATION
 18832        IF CANCEL-WITH-WARNING
 18833           IF PB-WARNING-ERRORS
 18834              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18835                  GO TO 4505-READ-PREV-RECORD
 18836              ELSE
 18837                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18838                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18839                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18840                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18841                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18842                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18843                 GO TO 7100-DISPLAY-CANCELS
 18844           ELSE
 18845              GO TO 4505-READ-PREV-RECORD.
 18846
 18847     IF PB-CANCELLATION
 18848        IF (CANCEL-IN-ERROR  AND
 18849            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18850            ALL-CANCELS
 18851            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18852            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18853            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18854            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18855            MOVE PB-SV-STATE            TO PI-SV-STATE
 18856            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18857            GO TO 7100-DISPLAY-CANCELS.
 18858
 18859     GO TO 4505-READ-PREV-RECORD.
 18860
 18861 4550-END-RECORDS.
 18862     IF PI-MAP-NAME = EL631B
 18863        MOVE -1                  TO BMAINTL
 18864     ELSE
 18865        IF PI-MAP-NAME = EL631C
 18866           MOVE -1               TO CMAINTL
 18867        ELSE
 18868           MOVE -1               TO DPFENTRL.
 18869
 18870     MOVE ER-2255               TO EMI-ERROR.
 18871     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18872     GO TO 8200-SEND-DATAONLY.
 18873
 18874 4570-NOT-FOUND.
 18875
 18876******************************************************************
 18877*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 18878******************************************************************
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 351
* EL6311.cbl
 18879
 18880
 18881* EXEC CICS RESETBR
 18882*         DATASET    (FILE-ID-ERPNDB2)
 18883*         RIDFLD     (ERPNDB-ALT-KEY)
 18884*    END-EXEC.
 18885     MOVE 0
 18886       TO DFHEIV11
 18887*    MOVE '&4         G          &   #00016147' TO DFHEIV0
 18888     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 18889     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18890     MOVE X'2020233030303136313437' TO DFHEIV0(25:11)
 18891     CALL 'kxdfhei1' USING DFHEIV0,
 18892           FILE-ID-ERPNDB2,
 18893           ERPNDB-ALT-KEY,
 18894           DFHEIV99,
 18895           DFHEIV11,
 18896           DFHEIV99
 18897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18898
 18899
 18900
 18901* EXEC CICS READNEXT
 18902*         DATASET    (FILE-ID-ERPNDB2)
 18903*         SET        (ADDRESS OF PENDING-BUSINESS)
 18904*         RIDFLD     (ERPNDB-ALT-KEY)
 18905*    END-EXEC.
 18906     MOVE 0
 18907       TO DFHEIV11
 18908*    MOVE '&.S                   )   #00016152' TO DFHEIV0
 18909     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18910     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18911     MOVE X'2020233030303136313532' TO DFHEIV0(25:11)
 18912     CALL 'kxdfhei1' USING DFHEIV0,
 18913           FILE-ID-ERPNDB2,
 18914           DFHEIV20,
 18915           DFHEIV99,
 18916           ERPNDB-ALT-KEY,
 18917           DFHEIV99,
 18918           DFHEIV11,
 18919           DFHEIV99,
 18920           DFHEIV99
 18921     SET ADDRESS OF PENDING-BUSINESS TO
 18922         DFHEIV20
 18923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18924
 18925
 18926
 18927* EXEC CICS READPREV
 18928*         DATASET    (FILE-ID-ERPNDB2)
 18929*         SET        (ADDRESS OF PENDING-BUSINESS)
 18930*         RIDFLD     (ERPNDB-ALT-KEY)
 18931*    END-EXEC.
 18932     MOVE 0
 18933       TO DFHEIV11
 18934*    MOVE '&0S                   )   #00016158' TO DFHEIV0
 18935     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 18936     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 352
* EL6311.cbl
 18937     MOVE X'2020233030303136313538' TO DFHEIV0(25:11)
 18938     CALL 'kxdfhei1' USING DFHEIV0,
 18939           FILE-ID-ERPNDB2,
 18940           DFHEIV20,
 18941           DFHEIV99,
 18942           ERPNDB-ALT-KEY,
 18943           DFHEIV99,
 18944           DFHEIV11,
 18945           DFHEIV99,
 18946           DFHEIV99
 18947     SET ADDRESS OF PENDING-BUSINESS TO
 18948         DFHEIV20
 18949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18950
 18951
 18952 4580-READ-PREV-RECORD.
 18953
 18954* EXEC CICS READPREV
 18955*         DATASET    (FILE-ID-ERPNDB2)
 18956*         SET        (ADDRESS OF PENDING-BUSINESS)
 18957*         RIDFLD     (ERPNDB-ALT-KEY)
 18958*    END-EXEC.
 18959     MOVE 0
 18960       TO DFHEIV11
 18961*    MOVE '&0S                   )   #00016165' TO DFHEIV0
 18962     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 18963     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18964     MOVE X'2020233030303136313635' TO DFHEIV0(25:11)
 18965     CALL 'kxdfhei1' USING DFHEIV0,
 18966           FILE-ID-ERPNDB2,
 18967           DFHEIV20,
 18968           DFHEIV99,
 18969           ERPNDB-ALT-KEY,
 18970           DFHEIV99,
 18971           DFHEIV11,
 18972           DFHEIV99,
 18973           DFHEIV99
 18974     SET ADDRESS OF PENDING-BUSINESS TO
 18975         DFHEIV20
 18976     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18977
 18978
 18979     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18980
 18981     IF WS-BATCH-PREFIX = '#CL'
 18982        GO TO 4580-READ-PREV-RECORD.
 18983
 18984     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 18985     GO TO 4505-READ-PREV-RECORD.
 18986
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 353
* EL6311.cbl
 18988
 18989******************************************************************
 18990*                                                                *
 18991*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 18992*                                                                *
 18993******************************************************************
 18994
 18995 4600-BROWSE-PRIMARY-BACKWARD.
 18996        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 18997
 18998     IF ERPNDB-BATCH-SEQ-NO = +9999
 18999        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 19000
 19001        IF ERPNDB-BATCH-SEQ-NO = +0000
 19002           GO TO 4650-END-BATCH
 19003        ELSE
 19004           IF PI-MAP-NAME NOT = EL631D
 19005              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19006                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 19007              ELSE
 19008                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 19009                 IF DISPLAY-CHANGE-RECORDS
 19010                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 19011                 ELSE
 19012                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19013
 19014
 19015* EXEC CICS HANDLE CONDITION
 19016*         NOTFND    (4680-NOT-FOUND)
 19017*         ENDFILE   (4680-NOT-FOUND)
 19018*    END-EXEC.
 19019*    MOVE '"$I''                  ! M #00016206' TO DFHEIV0
 19020     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19021     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19022     MOVE X'4D20233030303136323036' TO DFHEIV0(25:11)
 19023     CALL 'kxdfhei1' USING DFHEIV0
 19024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19025
 19026
 19027 4605-READ-NEXT.
 19028     IF ERPNDB-BATCH-SEQ-NO = +0000
 19029        GO TO 4650-END-BATCH.
 19030
 19031     IF PI-DISPLAY-ORIGINAL-BATCH
 19032        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19033     ELSE
 19034        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19035
 19036
 19037* EXEC CICS READ
 19038*         DATASET   (FILE-ID)
 19039*         SET       (ADDRESS OF PENDING-BUSINESS)
 19040*         RIDFLD    (ERPNDB-KEY)
 19041*    END-EXEC.
 19042*    MOVE '&"S        E          (   #00016220' TO DFHEIV0
 19043     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19044     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19045     MOVE X'2020233030303136323230' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 354
* EL6311.cbl
 19046     CALL 'kxdfhei1' USING DFHEIV0,
 19047           FILE-ID,
 19048           DFHEIV20,
 19049           DFHEIV99,
 19050           ERPNDB-KEY,
 19051           DFHEIV99,
 19052           DFHEIV99,
 19053           DFHEIV99
 19054     SET ADDRESS OF PENDING-BUSINESS TO
 19055         DFHEIV20
 19056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19057
 19058
 19059     IF NOT  PI-PRIMARY-WITH-SELECT
 19060        GO TO 4607-CHECK-REC-TYPE.
 19061
 19062     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19063
 19064     IF  WS-BATCH-PREFIX = '#CL'
 19065         GO TO 4610-BUMP-SEQ.
 19066
 19067     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19068        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19069           GO TO 4610-BUMP-SEQ
 19070        ELSE
 19071           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19072              GO TO 4607-CHECK-REC-TYPE
 19073           ELSE
 19074              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19075                 GO TO 4607-CHECK-REC-TYPE
 19076              ELSE
 19077                 GO TO 4610-BUMP-SEQ.
 19078
 19079     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19080        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19081           GO TO 4610-BUMP-SEQ.
 19082
 19083 4607-CHECK-REC-TYPE.
 19084     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19085         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19086             NEXT SENTENCE
 19087         ELSE
 19088             GO TO 4610-BUMP-SEQ.
 19089
 19090     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19091         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19092             NEXT SENTENCE
 19093        ELSE
 19094             GO TO 4610-BUMP-SEQ.
 19095
 19096     IF NOT DISPLAY-CHANGE-RECORDS AND
 19097            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19098        GO TO 4610-BUMP-SEQ.
 19099
 19100     IF DISPLAY-HOLD-RECORDS AND
 19101        NOT PB-RECORD-ON-HOLD
 19102          GO TO 4610-BUMP-SEQ.
 19103
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 355
* EL6311.cbl
 19104     IF PB-ISSUE
 19105        IF DISPLAY-CHK-REQ-RECORDS
 19106           GO TO 4610-BUMP-SEQ.
 19107
 19108     IF PB-ISSUE
 19109        IF ISSUE-WITH-WARNING
 19110           IF PB-WARNING-ERRORS
 19111              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19112                  GO TO 4610-BUMP-SEQ
 19113              ELSE
 19114                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19115                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19116                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19117                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19118                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19119                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19120                 GO TO 7000-DISPLAY-ISSUES
 19121           ELSE
 19122              GO TO 4610-BUMP-SEQ.
 19123
 19124     IF PB-ISSUE
 19125        IF (ISSUES-IN-ERROR AND
 19126            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19127            ALL-ISSUES
 19128            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19129            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19130            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19131            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19132            MOVE PB-SV-STATE            TO PI-SV-STATE
 19133            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19134            GO TO 7000-DISPLAY-ISSUES
 19135        ELSE
 19136            GO TO 4610-BUMP-SEQ.
 19137
 19138     IF PB-CANCELLATION
 19139        IF DISPLAY-CHK-REQ-RECORDS
 19140           IF PB-C-REFUND-REQUESTED
 19141              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19142              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19143              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19144              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19145              MOVE PB-SV-STATE            TO PI-SV-STATE
 19146              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19147              GO TO 7100-DISPLAY-CANCELS
 19148           ELSE
 19149              GO TO 4610-BUMP-SEQ.
 19150
 19151     IF PB-CANCELLATION
 19152        IF CANCEL-WITH-WARNING
 19153           IF PB-WARNING-ERRORS
 19154              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19155                  GO TO 4610-BUMP-SEQ
 19156              ELSE
 19157                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19158                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19159                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19160                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19161                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 356
* EL6311.cbl
 19162                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19163                 GO TO 7100-DISPLAY-CANCELS
 19164           ELSE
 19165              GO TO 4610-BUMP-SEQ.
 19166
 19167     IF PB-CANCELLATION
 19168        IF (CANCEL-IN-ERROR  AND
 19169            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19170            ALL-CANCELS
 19171            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19172            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19173            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19174            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19175            MOVE PB-SV-STATE            TO PI-SV-STATE
 19176            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19177            GO TO 7100-DISPLAY-CANCELS.
 19178
 19179 4610-BUMP-SEQ.
 19180     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 19181        GO TO 4650-END-BATCH.
 19182
 19183     IF DISPLAY-CHANGE-RECORDS
 19184        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19185           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 19186        ELSE
 19187           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19188           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19189        ELSE
 19190           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19191           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 19192
 19193        GO TO 4605-READ-NEXT.
 19194
 19195 4650-END-BATCH.
 19196     IF PI-MAP-NAME = EL631B
 19197        MOVE -1                  TO BMAINTL
 19198     ELSE
 19199        IF PI-MAP-NAME = EL631C
 19200           MOVE -1               TO CMAINTL
 19201        ELSE
 19202           MOVE -1               TO DPFENTRL.
 19203
 19204     MOVE ER-2252               TO EMI-ERROR.
 19205     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19206     GO TO 8200-SEND-DATAONLY.
 19207
 19208 4680-NOT-FOUND.
 19209     IF DISPLAY-CHANGE-RECORDS
 19210        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19211           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 19212        ELSE
 19213           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 19214           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 19215     ELSE
 19216        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 19217
 19218     GO TO 4605-READ-NEXT.
 19219
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 357
* EL6311.cbl
 19221
 19222******************************************************************
 19223*                                                                *
 19224*        B R O W S E   F I L E   B A C K W A R D S               *
 19225*                                                                *
 19226******************************************************************
 19227
 19228 4800-BROWSE-FILE-BACKWARD.
 19229
 19230* EXEC CICS HANDLE CONDITION
 19231*         NOTFND   (4860-NOT-FOUND)
 19232*         ENDFILE  (4850-END-RECORDS)
 19233*    END-EXEC.
 19234*    MOVE '"$I''                  ! N #00016396' TO DFHEIV0
 19235     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19236     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19237     MOVE X'4E20233030303136333936' TO DFHEIV0(25:11)
 19238     CALL 'kxdfhei1' USING DFHEIV0
 19239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19240
 19241
 19242     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 19243
 19244     IF PI-DISPLAY-ORIGINAL-BATCH
 19245        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19246     ELSE
 19247        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19248
 19249
 19250* EXEC CICS STARTBR
 19251*         DATASET   (FILE-ID)
 19252*         RIDFLD    (ERPNDB-KEY)
 19253*    END-EXEC.
 19254     MOVE 0
 19255       TO DFHEIV11
 19256*    MOVE '&,         G          &   #00016408' TO DFHEIV0
 19257     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19258     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19259     MOVE X'2020233030303136343038' TO DFHEIV0(25:11)
 19260     CALL 'kxdfhei1' USING DFHEIV0,
 19261           FILE-ID,
 19262           ERPNDB-KEY,
 19263           DFHEIV99,
 19264           DFHEIV11,
 19265           DFHEIV99
 19266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19267
 19268
 19269     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19270
 19271
 19272* EXEC CICS READPREV
 19273*         DATASET    (FILE-ID-ERPNDB)
 19274*         SET        (ADDRESS OF PENDING-BUSINESS)
 19275*         RIDFLD     (ERPNDB-KEY)
 19276*    END-EXEC.
 19277     MOVE 0
 19278       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 358
* EL6311.cbl
 19279*    MOVE '&0S                   )   #00016415' TO DFHEIV0
 19280     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19281     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19282     MOVE X'2020233030303136343135' TO DFHEIV0(25:11)
 19283     CALL 'kxdfhei1' USING DFHEIV0,
 19284           FILE-ID-ERPNDB,
 19285           DFHEIV20,
 19286           DFHEIV99,
 19287           ERPNDB-KEY,
 19288           DFHEIV99,
 19289           DFHEIV11,
 19290           DFHEIV99,
 19291           DFHEIV99
 19292     SET ADDRESS OF PENDING-BUSINESS TO
 19293         DFHEIV20
 19294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19295
 19296
 19297 4810-READ-PREV-RECORD.
 19298
 19299* EXEC CICS READPREV
 19300*         DATASET    (FILE-ID-ERPNDB)
 19301*         SET        (ADDRESS OF PENDING-BUSINESS)
 19302*         RIDFLD     (ERPNDB-KEY)
 19303*    END-EXEC.
 19304     MOVE 0
 19305       TO DFHEIV11
 19306*    MOVE '&0S                   )   #00016422' TO DFHEIV0
 19307     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19308     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19309     MOVE X'2020233030303136343232' TO DFHEIV0(25:11)
 19310     CALL 'kxdfhei1' USING DFHEIV0,
 19311           FILE-ID-ERPNDB,
 19312           DFHEIV20,
 19313           DFHEIV99,
 19314           ERPNDB-KEY,
 19315           DFHEIV99,
 19316           DFHEIV11,
 19317           DFHEIV99,
 19318           DFHEIV99
 19319     SET ADDRESS OF PENDING-BUSINESS TO
 19320         DFHEIV20
 19321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19322
 19323
 19324     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 19325        GO TO 4850-END-RECORDS.
 19326
 19327     IF PB-BATCH-TRAILER
 19328        GO TO 4810-READ-PREV-RECORD.
 19329
 19330     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19331
 19332     IF  WS-BATCH-PREFIX = '#CL'
 19333         GO TO 4810-READ-PREV-RECORD.
 19334
 19335     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19336        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 359
* EL6311.cbl
 19337           GO TO 4810-READ-PREV-RECORD
 19338        ELSE
 19339           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19340              GO TO 4820-CHECK-REC-TYPE
 19341           ELSE
 19342              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19343                 GO TO 4820-CHECK-REC-TYPE
 19344              ELSE
 19345                 GO TO 4810-READ-PREV-RECORD.
 19346
 19347     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19348        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19349           GO TO 4810-READ-PREV-RECORD.
 19350
 19351 4820-CHECK-REC-TYPE.
 19352     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19353         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19354             NEXT SENTENCE
 19355         ELSE
 19356             GO TO 4810-READ-PREV-RECORD.
 19357
 19358     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19359         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19360             NEXT SENTENCE
 19361        ELSE
 19362             GO TO 4810-READ-PREV-RECORD.
 19363
 19364     IF NOT DISPLAY-CHANGE-RECORDS AND
 19365            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19366        GO TO 4810-READ-PREV-RECORD.
 19367
 19368     IF DISPLAY-HOLD-RECORDS AND
 19369        NOT PB-RECORD-ON-HOLD
 19370          GO TO 4810-READ-PREV-RECORD.
 19371
 19372     IF PB-ISSUE
 19373        IF DISPLAY-CHK-REQ-RECORDS
 19374           GO TO 4810-READ-PREV-RECORD.
 19375
 19376     IF PB-ISSUE
 19377        IF ISSUE-WITH-WARNING
 19378           IF PB-WARNING-ERRORS
 19379              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19380                  GO TO 4810-READ-PREV-RECORD
 19381              ELSE
 19382                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19383                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19384                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19385                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19386                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19387                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19388                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19389                 GO TO 7000-DISPLAY-ISSUES
 19390           ELSE
 19391              GO TO 4810-READ-PREV-RECORD.
 19392
 19393     IF PB-ISSUE
 19394        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 360
* EL6311.cbl
 19395            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19396            ALL-ISSUES
 19397            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19398            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19399            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19400            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19401            MOVE PB-SV-STATE            TO PI-SV-STATE
 19402            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19403            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19404            GO TO 7000-DISPLAY-ISSUES
 19405        ELSE
 19406            GO TO 4810-READ-PREV-RECORD.
 19407
 19408     IF PB-CANCELLATION
 19409        IF DISPLAY-CHK-REQ-RECORDS
 19410           IF PB-C-REFUND-REQUESTED
 19411              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19412              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19413              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19414              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19415              MOVE PB-SV-STATE            TO PI-SV-STATE
 19416              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19417              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19418              GO TO 7100-DISPLAY-CANCELS
 19419           ELSE
 19420              GO TO 4810-READ-PREV-RECORD.
 19421
 19422     IF PB-CANCELLATION
 19423        IF CANCEL-WITH-WARNING
 19424           IF PB-WARNING-ERRORS
 19425              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19426                  GO TO 4810-READ-PREV-RECORD
 19427              ELSE
 19428                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19429                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19430                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19431                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19432                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19433                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19434                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19435                 GO TO 7100-DISPLAY-CANCELS
 19436           ELSE
 19437              GO TO 4810-READ-PREV-RECORD.
 19438
 19439     IF PB-CANCELLATION
 19440        IF (CANCEL-IN-ERROR  AND
 19441            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19442            ALL-CANCELS
 19443            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19444            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19445            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19446            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19447            MOVE PB-SV-STATE            TO PI-SV-STATE
 19448            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19449            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19450            GO TO 7100-DISPLAY-CANCELS.
 19451
 19452     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 361
* EL6311.cbl
 19453
 19454 4850-END-RECORDS.
 19455     MOVE ER-2252                TO EMI-ERROR.
 19456     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19457
 19458     IF PI-MAP-NAME = EL631B
 19459        MOVE -1                  TO BPFENTRL
 19460     ELSE
 19461        MOVE -1                  TO CPFENTRL.
 19462
 19463     GO TO 8200-SEND-DATAONLY.
 19464
 19465 4860-NOT-FOUND.
 19466
 19467******************************************************************
 19468*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 19469******************************************************************
 19470
 19471
 19472* EXEC CICS RESETBR
 19473*         DATASET    (FILE-ID-ERPNDB)
 19474*         RIDFLD     (ERPNDB-KEY)
 19475*     END-EXEC.
 19476     MOVE 0
 19477       TO DFHEIV11
 19478*    MOVE '&4         G          &   #00016575' TO DFHEIV0
 19479     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19480     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19481     MOVE X'2020233030303136353735' TO DFHEIV0(25:11)
 19482     CALL 'kxdfhei1' USING DFHEIV0,
 19483           FILE-ID-ERPNDB,
 19484           ERPNDB-KEY,
 19485           DFHEIV99,
 19486           DFHEIV11,
 19487           DFHEIV99
 19488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19489
 19490
 19491
 19492* EXEC CICS READNEXT
 19493*         DATASET    (FILE-ID-ERPNDB)
 19494*         SET        (ADDRESS OF PENDING-BUSINESS)
 19495*         RIDFLD     (ERPNDB-KEY)
 19496*    END-EXEC.
 19497     MOVE 0
 19498       TO DFHEIV11
 19499*    MOVE '&.S                   )   #00016580' TO DFHEIV0
 19500     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19501     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19502     MOVE X'2020233030303136353830' TO DFHEIV0(25:11)
 19503     CALL 'kxdfhei1' USING DFHEIV0,
 19504           FILE-ID-ERPNDB,
 19505           DFHEIV20,
 19506           DFHEIV99,
 19507           ERPNDB-KEY,
 19508           DFHEIV99,
 19509           DFHEIV11,
 19510           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 362
* EL6311.cbl
 19511           DFHEIV99
 19512     SET ADDRESS OF PENDING-BUSINESS TO
 19513         DFHEIV20
 19514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19515
 19516
 19517
 19518* EXEC CICS READPREV
 19519*         DATASET    (FILE-ID-ERPNDB)
 19520*         SET        (ADDRESS OF PENDING-BUSINESS)
 19521*         RIDFLD     (ERPNDB-KEY)
 19522*    END-EXEC.
 19523     MOVE 0
 19524       TO DFHEIV11
 19525*    MOVE '&0S                   )   #00016586' TO DFHEIV0
 19526     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19527     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19528     MOVE X'2020233030303136353836' TO DFHEIV0(25:11)
 19529     CALL 'kxdfhei1' USING DFHEIV0,
 19530           FILE-ID-ERPNDB,
 19531           DFHEIV20,
 19532           DFHEIV99,
 19533           ERPNDB-KEY,
 19534           DFHEIV99,
 19535           DFHEIV11,
 19536           DFHEIV99,
 19537           DFHEIV99
 19538     SET ADDRESS OF PENDING-BUSINESS TO
 19539         DFHEIV20
 19540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19541
 19542
 19543     GO TO 4810-READ-PREV-RECORD.
 19544
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 363
* EL6311.cbl
 19546
 19547******************************************************************
 19548*                                                                *
 19549*           B R O W S E   C S R   B A C K W A R D                *
 19550*                                                                *
 19551******************************************************************
 19552
 19553 4900-BROWSE-CSR-BACKWARD.
 19554
 19555     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19556
 19557
 19558* EXEC CICS HANDLE CONDITION
 19559*         NOTFND   (4970-NOT-FOUND)
 19560*         ENDFILE  (4950-END-RECORDS)
 19561*    END-EXEC
 19562*    MOVE '"$I''                  ! O #00016606' TO DFHEIV0
 19563     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19565     MOVE X'4F20233030303136363036' TO DFHEIV0(25:11)
 19566     CALL 'kxdfhei1' USING DFHEIV0
 19567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19568
 19569
 19570* EXEC CICS STARTBR
 19571*         DATASET   (FILE-ID-ERPNDB4)
 19572*         RIDFLD    (ERPNDB-CSR-KEY)
 19573*    END-EXEC.
 19574     MOVE 0
 19575       TO DFHEIV11
 19576*    MOVE '&,         G          &   #00016611' TO DFHEIV0
 19577     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19578     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19579     MOVE X'2020233030303136363131' TO DFHEIV0(25:11)
 19580     CALL 'kxdfhei1' USING DFHEIV0,
 19581           FILE-ID-ERPNDB4,
 19582           ERPNDB-CSR-KEY,
 19583           DFHEIV99,
 19584           DFHEIV11,
 19585           DFHEIV99
 19586     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19587
 19588
 19589     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19590                                    WS-FIRST-TIME-SW.
 19591
 19592 4905-READ-PREV-RECORD.
 19593
 19594* EXEC CICS READPREV
 19595*         DATASET    (FILE-ID-ERPNDB4)
 19596*         SET        (ADDRESS OF PENDING-BUSINESS)
 19597*         RIDFLD     (ERPNDB-CSR-KEY)
 19598*    END-EXEC.
 19599     MOVE 0
 19600       TO DFHEIV11
 19601*    MOVE '&0S                   )   #00016620' TO DFHEIV0
 19602     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19603     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 364
* EL6311.cbl
 19604     MOVE X'2020233030303136363230' TO DFHEIV0(25:11)
 19605     CALL 'kxdfhei1' USING DFHEIV0,
 19606           FILE-ID-ERPNDB4,
 19607           DFHEIV20,
 19608           DFHEIV99,
 19609           ERPNDB-CSR-KEY,
 19610           DFHEIV99,
 19611           DFHEIV11,
 19612           DFHEIV99,
 19613           DFHEIV99
 19614     SET ADDRESS OF PENDING-BUSINESS TO
 19615         DFHEIV20
 19616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19617
 19618
 19619     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19620
 19621     IF WS-BATCH-PREFIX = '#CL'
 19622         GO TO 4905-READ-PREV-RECORD.
 19623
 19624     IF FIRST-TIME
 19625         MOVE SPACE               TO WS-FIRST-TIME-SW
 19626         GO TO 4905-READ-PREV-RECORD.
 19627
 19628     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19629        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19630        GO TO 4950-END-RECORDS.
 19631
 19632     IF PB-BATCH-TRAILER
 19633        GO TO 4905-READ-PREV-RECORD.
 19634
 19635     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19636
 19637     IF  WS-BATCH-PREFIX = '#CL'
 19638         GO TO 4905-READ-PREV-RECORD.
 19639
 19640     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19641        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19642           GO TO 4905-READ-PREV-RECORD
 19643        ELSE
 19644           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19645              GO TO 4910-CHECK-REC-TYPE
 19646           ELSE
 19647              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19648                 GO TO 4910-CHECK-REC-TYPE
 19649              ELSE
 19650                 GO TO 4905-READ-PREV-RECORD.
 19651
 19652     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19653        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19654           GO TO 4905-READ-PREV-RECORD.
 19655
 19656 4910-CHECK-REC-TYPE.
 19657     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19658         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19659             NEXT SENTENCE
 19660         ELSE
 19661             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 365
* EL6311.cbl
 19662
 19663     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19664         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19665             NEXT SENTENCE
 19666        ELSE
 19667             GO TO 4905-READ-PREV-RECORD.
 19668
 19669     IF NOT DISPLAY-CHANGE-RECORDS AND
 19670            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19671        GO TO 4905-READ-PREV-RECORD.
 19672
 19673     IF DISPLAY-HOLD-RECORDS AND
 19674        NOT PB-RECORD-ON-HOLD
 19675          GO TO 4905-READ-PREV-RECORD.
 19676
 19677     IF PB-ISSUE
 19678        IF DISPLAY-CHK-REQ-RECORDS
 19679           GO TO 4905-READ-PREV-RECORD.
 19680
 19681     IF PB-ISSUE
 19682        IF ISSUE-WITH-WARNING
 19683           IF PB-WARNING-ERRORS
 19684              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19685                  GO TO 4505-READ-PREV-RECORD
 19686              ELSE
 19687                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19688                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19689                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19690                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19691                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19692                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19693                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19694                 GO TO 7000-DISPLAY-ISSUES
 19695           ELSE
 19696              GO TO 4905-READ-PREV-RECORD.
 19697
 19698     IF PB-ISSUE
 19699        IF (ISSUES-IN-ERROR AND
 19700            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19701            ALL-ISSUES
 19702            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19703            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19704            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19705            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19706            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19707            MOVE PB-SV-STATE            TO PI-SV-STATE
 19708            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19709            GO TO 7000-DISPLAY-ISSUES
 19710        ELSE
 19711            GO TO 4905-READ-PREV-RECORD.
 19712
 19713     IF PB-CANCELLATION
 19714        IF DISPLAY-CHK-REQ-RECORDS
 19715           IF PB-C-REFUND-REQUESTED
 19716              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19717              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19718              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19719              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 366
* EL6311.cbl
 19720              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19721              MOVE PB-SV-STATE            TO PI-SV-STATE
 19722              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19723              GO TO 7100-DISPLAY-CANCELS
 19724           ELSE
 19725              GO TO 4905-READ-PREV-RECORD.
 19726
 19727     IF PB-CANCELLATION
 19728        IF CANCEL-WITH-WARNING
 19729           IF PB-WARNING-ERRORS
 19730              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19731                  GO TO 4505-READ-PREV-RECORD
 19732              ELSE
 19733                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19734                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19735                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19736                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19737                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19738                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19739                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19740                 GO TO 7100-DISPLAY-CANCELS
 19741           ELSE
 19742              GO TO 4905-READ-PREV-RECORD.
 19743
 19744     IF PB-CANCELLATION
 19745        IF (CANCEL-IN-ERROR  AND
 19746            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19747            ALL-CANCELS
 19748            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19749            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19750            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19751            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19752            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19753            MOVE PB-SV-STATE            TO PI-SV-STATE
 19754            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19755            GO TO 7100-DISPLAY-CANCELS.
 19756
 19757     GO TO 4905-READ-PREV-RECORD.
 19758
 19759 4950-END-RECORDS.
 19760     IF PI-MAP-NAME = EL631B
 19761        MOVE -1                  TO BMAINTL
 19762     ELSE
 19763        IF PI-MAP-NAME = EL631C
 19764           MOVE -1               TO CMAINTL
 19765        ELSE
 19766           MOVE -1               TO DPFENTRL.
 19767
 19768     MOVE ER-2255               TO EMI-ERROR.
 19769     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19770     GO TO 8200-SEND-DATAONLY.
 19771
 19772 4970-NOT-FOUND.
 19773
 19774******************************************************************
 19775*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 19776******************************************************************
 19777
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 367
* EL6311.cbl
 19778
 19779* EXEC CICS RESETBR
 19780*         DATASET    (FILE-ID-ERPNDB4)
 19781*         RIDFLD     (ERPNDB-CSR-KEY)
 19782*    END-EXEC.
 19783     MOVE 0
 19784       TO DFHEIV11
 19785*    MOVE '&4         G          &   #00016785' TO DFHEIV0
 19786     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 19787     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19788     MOVE X'2020233030303136373835' TO DFHEIV0(25:11)
 19789     CALL 'kxdfhei1' USING DFHEIV0,
 19790           FILE-ID-ERPNDB4,
 19791           ERPNDB-CSR-KEY,
 19792           DFHEIV99,
 19793           DFHEIV11,
 19794           DFHEIV99
 19795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19796
 19797
 19798
 19799* EXEC CICS READNEXT
 19800*         DATASET    (FILE-ID-ERPNDB4)
 19801*         SET        (ADDRESS OF PENDING-BUSINESS)
 19802*         RIDFLD     (ERPNDB-CSR-KEY)
 19803*    END-EXEC.
 19804     MOVE 0
 19805       TO DFHEIV11
 19806*    MOVE '&.S                   )   #00016790' TO DFHEIV0
 19807     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19808     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19809     MOVE X'2020233030303136373930' TO DFHEIV0(25:11)
 19810     CALL 'kxdfhei1' USING DFHEIV0,
 19811           FILE-ID-ERPNDB4,
 19812           DFHEIV20,
 19813           DFHEIV99,
 19814           ERPNDB-CSR-KEY,
 19815           DFHEIV99,
 19816           DFHEIV11,
 19817           DFHEIV99,
 19818           DFHEIV99
 19819     SET ADDRESS OF PENDING-BUSINESS TO
 19820         DFHEIV20
 19821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19822
 19823
 19824
 19825* EXEC CICS READPREV
 19826*         DATASET    (FILE-ID-ERPNDB4)
 19827*         SET        (ADDRESS OF PENDING-BUSINESS)
 19828*         RIDFLD     (ERPNDB-CSR-KEY)
 19829*    END-EXEC.
 19830     MOVE 0
 19831       TO DFHEIV11
 19832*    MOVE '&0S                   )   #00016796' TO DFHEIV0
 19833     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19834     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19835     MOVE X'2020233030303136373936' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 368
* EL6311.cbl
 19836     CALL 'kxdfhei1' USING DFHEIV0,
 19837           FILE-ID-ERPNDB4,
 19838           DFHEIV20,
 19839           DFHEIV99,
 19840           ERPNDB-CSR-KEY,
 19841           DFHEIV99,
 19842           DFHEIV11,
 19843           DFHEIV99,
 19844           DFHEIV99
 19845     SET ADDRESS OF PENDING-BUSINESS TO
 19846         DFHEIV20
 19847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19848
 19849
 19850 4980-READ-PREV-RECORD.
 19851
 19852* EXEC CICS READPREV
 19853*         DATASET    (FILE-ID-ERPNDB4)
 19854*         SET        (ADDRESS OF PENDING-BUSINESS)
 19855*         RIDFLD     (ERPNDB-CSR-KEY)
 19856*    END-EXEC.
 19857     MOVE 0
 19858       TO DFHEIV11
 19859*    MOVE '&0S                   )   #00016803' TO DFHEIV0
 19860     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19861     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19862     MOVE X'2020233030303136383033' TO DFHEIV0(25:11)
 19863     CALL 'kxdfhei1' USING DFHEIV0,
 19864           FILE-ID-ERPNDB4,
 19865           DFHEIV20,
 19866           DFHEIV99,
 19867           ERPNDB-CSR-KEY,
 19868           DFHEIV99,
 19869           DFHEIV11,
 19870           DFHEIV99,
 19871           DFHEIV99
 19872     SET ADDRESS OF PENDING-BUSINESS TO
 19873         DFHEIV20
 19874     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19875
 19876
 19877     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19878
 19879     IF WS-BATCH-PREFIX = '#CL'
 19880        GO TO 4980-READ-PREV-RECORD.
 19881
 19882     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 19883     GO TO 4905-READ-PREV-RECORD.
 19884
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 369
* EL6311.cbl
 19886
 19887
 19888******************************************************************
 19889*                                                                *
 19890*        B R O W S E   B A T C H   H E A D E R S                 *
 19891*                                                                *
 19892******************************************************************
 19893
 19894 5000-BROWSE-BATCH-HEADERS.
 19895
 19896     IF EIBTRNID NOT = TRANS-EXB1
 19897        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19898        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 19899        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19900        GO TO 5010-READ-NEXT-RECORD.
 19901
 19902     IF EIBAID = DFHPF4
 19903        MOVE '0'                TO PI-EDIT-SW
 19904        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19905        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 19906        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19907        GO TO 5010-READ-NEXT-RECORD.
 19908
 19909     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 19910     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 19911     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 19912
 19913
 19914* EXEC CICS HANDLE CONDITION
 19915*         ENDFILE  (5050-NOT-FOUND)
 19916*    END-EXEC.
 19917*    MOVE '"$''                   ! P #00016845' TO DFHEIV0
 19918     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 19919     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19920     MOVE X'5020233030303136383435' TO DFHEIV0(25:11)
 19921     CALL 'kxdfhei1' USING DFHEIV0
 19922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19923
 19924
 19925 5010-READ-NEXT-RECORD.
 19926
 19927* EXEC CICS HANDLE CONDITION
 19928*         NOTFND    (5050-NOT-FOUND)
 19929*    END-EXEC.
 19930*    MOVE '"$I                   ! Q #00016850' TO DFHEIV0
 19931     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19932     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19933     MOVE X'5120233030303136383530' TO DFHEIV0(25:11)
 19934     CALL 'kxdfhei1' USING DFHEIV0
 19935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19936
 19937
 19938
 19939* EXEC CICS READ
 19940*         DATASET   (FILE-ID-ERPNDB)
 19941*         SET       (ADDRESS OF PENDING-BUSINESS)
 19942*         RIDFLD    (ERPNDB-KEY)
 19943*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 370
* EL6311.cbl
 19944*    END-EXEC.
 19945*    MOVE '&"S        G          (   #00016854' TO DFHEIV0
 19946     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19947     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19948     MOVE X'2020233030303136383534' TO DFHEIV0(25:11)
 19949     CALL 'kxdfhei1' USING DFHEIV0,
 19950           FILE-ID-ERPNDB,
 19951           DFHEIV20,
 19952           DFHEIV99,
 19953           ERPNDB-KEY,
 19954           DFHEIV99,
 19955           DFHEIV99,
 19956           DFHEIV99
 19957     SET ADDRESS OF PENDING-BUSINESS TO
 19958         DFHEIV20
 19959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19960
 19961
 19962     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19963         GO TO 5050-NOT-FOUND.
 19964
 19965     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19966
 19967     IF WS-BATCH-PREFIX = '#CL'
 19968         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 19969         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19970         GO TO 5010-READ-NEXT-RECORD.
 19971
 19972     IF NOT PB-BATCH-TRAILER
 19973         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 19974         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 19975         GO TO 5010-READ-NEXT-RECORD.
 19976
 19977     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19978         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19979             NEXT SENTENCE
 19980         ELSE
 19981             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 19982             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19983             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 19984             GO TO 5010-READ-NEXT-RECORD.
 19985
 19986     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19987         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19988             NEXT SENTENCE
 19989        ELSE
 19990             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19991             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 19992             GO TO 5010-READ-NEXT-RECORD.
 19993
 19994     IF EIBAID = DFHPF4
 19995        MOVE '0'                TO PI-EDIT-SW
 19996        GO TO 7200-DISPLAY-BATCHES.
 19997
 19998     IF PI-CSR-BROWSE
 19999        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20000           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 20001           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 371
* EL6311.cbl
 20002           GO TO 5010-READ-NEXT-RECORD.
 20003
 20004     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20005       IF PI-PB-CARRIER    = SPACES AND
 20006          PI-PB-GROUPING   = SPACES AND
 20007          PI-PB-STATE      = SPACES AND
 20008          PI-PB-ACCOUNT    = SPACES
 20009            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20010            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20011            GO TO 7200-DISPLAY-BATCHES
 20012         ELSE
 20013           IF PI-PB-CARRIER    = PB-CARRIER  AND
 20014              PI-PB-GROUPING   = PB-GROUPING AND
 20015              PI-PB-STATE      = PB-STATE    AND
 20016              PI-PB-ACCOUNT    = PB-ACCOUNT
 20017              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 20018              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20019              GO TO 7200-DISPLAY-BATCHES.
 20020
 20021     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 20022     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 20023
 20024
 20025* EXEC CICS HANDLE CONDITION
 20026*         NOTFND    (5050-NOT-FOUND)
 20027*    END-EXEC.
 20028*    MOVE '"$I                   ! R #00016923' TO DFHEIV0
 20029     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 20030     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20031     MOVE X'5220233030303136393233' TO DFHEIV0(25:11)
 20032     CALL 'kxdfhei1' USING DFHEIV0
 20033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20034
 20035
 20036
 20037* EXEC CICS READ
 20038*         DATASET   (FILE-ID-ERPNDB)
 20039*         SET       (ADDRESS OF PENDING-BUSINESS)
 20040*         RIDFLD    (ERPNDB-KEY)
 20041*         GTEQ
 20042*    END-EXEC.
 20043*    MOVE '&"S        G          (   #00016927' TO DFHEIV0
 20044     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 20045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20046     MOVE X'2020233030303136393237' TO DFHEIV0(25:11)
 20047     CALL 'kxdfhei1' USING DFHEIV0,
 20048           FILE-ID-ERPNDB,
 20049           DFHEIV20,
 20050           DFHEIV99,
 20051           ERPNDB-KEY,
 20052           DFHEIV99,
 20053           DFHEIV99,
 20054           DFHEIV99
 20055     SET ADDRESS OF PENDING-BUSINESS TO
 20056         DFHEIV20
 20057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20058
 20059
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 372
* EL6311.cbl
 20060     GO TO 5010-READ-NEXT-RECORD.
 20061
 20062 5050-NOT-FOUND.
 20063
 20064******************************************************************
 20065*                                                                *
 20066*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 20067*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 20068*         PROGRAM.                                               *
 20069*                                                                *
 20070******************************************************************
 20071
 20072     IF EIBTRNID NOT = TRANS-EXB1
 20073        IF PENDING-BUS-RECS-FOUND
 20074            NEXT SENTENCE
 20075          ELSE
 20076            MOVE '9'            TO PI-BROWSE-SW
 20077            GO TO 9400-CLEAR.
 20078
 20079     MOVE ER-2256                TO EMI-ERROR.
 20080     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20081
 20082     IF PI-MAP-NAME = SPACES
 20083        MOVE EL631D              TO PI-MAP-NAME
 20084        MOVE -1                  TO DPFENTRL
 20085        GO TO 8100-SEND-INITIAL-MAP.
 20086
 20087     IF PI-MAP-NAME = EL631B
 20088        MOVE -1                  TO BMAINTL
 20089     ELSE
 20090        IF PI-MAP-NAME = EL631C
 20091           MOVE -1               TO CMAINTL
 20092        ELSE
 20093           MOVE -1               TO DPFENTRL
 20094           GO TO 8200-SEND-DATAONLY.
 20095
 20096     GO TO 8100-SEND-INITIAL-MAP.
 20097
 20098     .
 20099 5100-PROCESS-POL-RESC.
 20100     MOVE ZEROS                  TO CG-LF-BENCD
 20101                                    CG-AH-BENCD
 20102                                    CG-LF-CAN-AMT
 20103                                    CG-AH-CAN-AMT
 20104     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20105                                    CG-AH-CAN-DT
 20106     MOVE SPACES                 TO CG-BATCH-NO
 20107     MOVE '4'                    TO CG-OPTION-CODE
 20108     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 20109     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 20110     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 20111     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 20112     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 20113     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 20114     MOVE PI-SV-STATE            TO CG-CERT-STATE
 20115     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 20116     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 20117     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 373
* EL6311.cbl
 20118     MOVE PI-PREV-ALT-KEY (1:33)
 20119                                 TO CG-CERT-KEY
 20120     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 20121     MOVE ZEROS                  TO CG-LF-CAN-AMT
 20122                                    CG-AH-CAN-AMT
 20123     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 20124                                    CG-AH-CAN-DT
 20125     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 20126     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 20127      display 'about to cancel ' cg-cert-key
 20128
 20129* EXEC CICS LINK
 20130*        PROGRAM  ('ELCANC')
 20131*        COMMAREA (CANCEL-GEN-PASS-AREA)
 20132*    END-EXEC
 20133     MOVE LENGTH OF
 20134      CANCEL-GEN-PASS-AREA
 20135       TO DFHEIV11
 20136     MOVE 'ELCANC' TO DFHEIV1
 20137*    MOVE '."C                   (   #00017002' TO DFHEIV0
 20138     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20139     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20140     MOVE X'2020233030303137303032' TO DFHEIV0(25:11)
 20141     CALL 'kxdfhei1' USING DFHEIV0,
 20142           DFHEIV1,
 20143           CANCEL-GEN-PASS-AREA,
 20144           DFHEIV11,
 20145           DFHEIV99,
 20146           DFHEIV99,
 20147           DFHEIV99,
 20148           DFHEIV99
 20149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20150     IF CG-SUCCESS
 20151        CONTINUE
 20152     ELSE
 20153        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 20154        MOVE '3'                 TO EMI-SWITCH1
 20155        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 20156        EVALUATE TRUE
 20157           WHEN CG-DATE-ERROR
 20158             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20159           WHEN CG-CERT-NOT-FOUND
 20160             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20161           WHEN CG-AMOUNT-ERROR
 20162             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20163           WHEN CG-OPTION-ERROR
 20164             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20165           WHEN CG-PREV-CAN
 20166             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20167           WHEN CG-INVALID-DATA
 20168             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20169           WHEN CG-NO-ACCT-MSTR
 20170             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20171           WHEN CG-SFX-A-EXIST
 20172             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20173           WHEN CG-MISC-ERROR
 20174             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 20175           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 374
* EL6311.cbl
 20176             MOVE ' ERROR - ELCANC - RETURN '
 20177                                 TO EMI-ERROR-TEXT (1) (12:25)
 20178        END-EVALUATE
 20179        GO TO 8200-SEND-DATAONLY
 20180     END-IF
 20181     .
 20182 5100-EXIT.
 20183     EXIT.
 20184
 20185******************************************************************
 20186*                                                                *
 20187*        B R O W S E   B A T C H   B A C K W A R D S             *
 20188*                                                                *
 20189******************************************************************
 20190
 20191 5500-BROWSE-BATCH-BACKWARD.
 20192
 20193* EXEC CICS HANDLE CONDITION
 20194*         NOTFND   (5550-END-RECORDS)
 20195*         ENDFILE  (5550-END-RECORDS)
 20196*    END-EXEC.
 20197*    MOVE '"$I''                  ! S #00017048' TO DFHEIV0
 20198     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20199     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20200     MOVE X'5320233030303137303438' TO DFHEIV0(25:11)
 20201     CALL 'kxdfhei1' USING DFHEIV0
 20202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20203
 20204
 20205 5505-START-BROWSE.
 20206     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20207     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 20208     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 20209
 20210
 20211* EXEC CICS STARTBR
 20212*         DATASET   (FILE-ID-ERPNDB)
 20213*         RIDFLD    (ERPNDB-ALT-KEY)
 20214*    END-EXEC.
 20215     MOVE 0
 20216       TO DFHEIV11
 20217*    MOVE '&,         G          &   #00017058' TO DFHEIV0
 20218     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20219     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20220     MOVE X'2020233030303137303538' TO DFHEIV0(25:11)
 20221     CALL 'kxdfhei1' USING DFHEIV0,
 20222           FILE-ID-ERPNDB,
 20223           ERPNDB-ALT-KEY,
 20224           DFHEIV99,
 20225           DFHEIV11,
 20226           DFHEIV99
 20227     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20228
 20229
 20230     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20231
 20232
 20233* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 375
* EL6311.cbl
 20234*         DATASET    (FILE-ID-ERPNDB)
 20235*         SET        (ADDRESS OF PENDING-BUSINESS)
 20236*         RIDFLD     (ERPNDB-KEY)
 20237*    END-EXEC.
 20238     MOVE 0
 20239       TO DFHEIV11
 20240*    MOVE '&.S                   )   #00017065' TO DFHEIV0
 20241     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20242     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20243     MOVE X'2020233030303137303635' TO DFHEIV0(25:11)
 20244     CALL 'kxdfhei1' USING DFHEIV0,
 20245           FILE-ID-ERPNDB,
 20246           DFHEIV20,
 20247           DFHEIV99,
 20248           ERPNDB-KEY,
 20249           DFHEIV99,
 20250           DFHEIV11,
 20251           DFHEIV99,
 20252           DFHEIV99
 20253     SET ADDRESS OF PENDING-BUSINESS TO
 20254         DFHEIV20
 20255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20256
 20257
 20258
 20259* EXEC CICS READPREV
 20260*         DATASET    (FILE-ID-ERPNDB)
 20261*         SET        (ADDRESS OF PENDING-BUSINESS)
 20262*         RIDFLD     (ERPNDB-KEY)
 20263*    END-EXEC.
 20264     MOVE 0
 20265       TO DFHEIV11
 20266*    MOVE '&0S                   )   #00017071' TO DFHEIV0
 20267     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20268     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20269     MOVE X'2020233030303137303731' TO DFHEIV0(25:11)
 20270     CALL 'kxdfhei1' USING DFHEIV0,
 20271           FILE-ID-ERPNDB,
 20272           DFHEIV20,
 20273           DFHEIV99,
 20274           ERPNDB-KEY,
 20275           DFHEIV99,
 20276           DFHEIV11,
 20277           DFHEIV99,
 20278           DFHEIV99
 20279     SET ADDRESS OF PENDING-BUSINESS TO
 20280         DFHEIV20
 20281     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20282
 20283
 20284
 20285* EXEC CICS READPREV
 20286*         DATASET    (FILE-ID-ERPNDB)
 20287*         SET        (ADDRESS OF PENDING-BUSINESS)
 20288*         RIDFLD     (ERPNDB-KEY)
 20289*    END-EXEC.
 20290     MOVE 0
 20291       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 376
* EL6311.cbl
 20292*    MOVE '&0S                   )   #00017077' TO DFHEIV0
 20293     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20294     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20295     MOVE X'2020233030303137303737' TO DFHEIV0(25:11)
 20296     CALL 'kxdfhei1' USING DFHEIV0,
 20297           FILE-ID-ERPNDB,
 20298           DFHEIV20,
 20299           DFHEIV99,
 20300           ERPNDB-KEY,
 20301           DFHEIV99,
 20302           DFHEIV11,
 20303           DFHEIV99,
 20304           DFHEIV99
 20305     SET ADDRESS OF PENDING-BUSINESS TO
 20306         DFHEIV20
 20307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20308
 20309
 20310     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20311        GO TO 5550-END-RECORDS.
 20312
 20313     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 20314
 20315     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20316
 20317     IF  WS-BATCH-PREFIX = '#CL'
 20318             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20319
 20320* EXEC CICS ENDBR
 20321*                 DATASET  (FILE-ID-ERPNDB)
 20322*            END-EXEC
 20323     MOVE 0
 20324       TO DFHEIV11
 20325*    MOVE '&2                    $   #00017092' TO DFHEIV0
 20326     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20327     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20328     MOVE X'2020233030303137303932' TO DFHEIV0(25:11)
 20329     CALL 'kxdfhei1' USING DFHEIV0,
 20330           FILE-ID-ERPNDB,
 20331           DFHEIV11,
 20332           DFHEIV99
 20333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20334         GO TO 5505-START-BROWSE.
 20335
 20336     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20337         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20338             NEXT SENTENCE
 20339         ELSE
 20340             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20341
 20342* EXEC CICS ENDBR
 20343*                 DATASET  (FILE-ID-ERPNDB)
 20344*            END-EXEC
 20345     MOVE 0
 20346       TO DFHEIV11
 20347*    MOVE '&2                    $   #00017102' TO DFHEIV0
 20348     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20349     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 377
* EL6311.cbl
 20350     MOVE X'2020233030303137313032' TO DFHEIV0(25:11)
 20351     CALL 'kxdfhei1' USING DFHEIV0,
 20352           FILE-ID-ERPNDB,
 20353           DFHEIV11,
 20354           DFHEIV99
 20355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20356             GO TO 5505-START-BROWSE.
 20357
 20358
 20359     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20360         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20361             NEXT SENTENCE
 20362        ELSE
 20363             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20364
 20365* EXEC CICS ENDBR
 20366*                 DATASET  (FILE-ID-ERPNDB)
 20367*            END-EXEC
 20368     MOVE 0
 20369       TO DFHEIV11
 20370*    MOVE '&2                    $   #00017113' TO DFHEIV0
 20371     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20372     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20373     MOVE X'2020233030303137313133' TO DFHEIV0(25:11)
 20374     CALL 'kxdfhei1' USING DFHEIV0,
 20375           FILE-ID-ERPNDB,
 20376           DFHEIV11,
 20377           DFHEIV99
 20378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20379             GO TO 5505-START-BROWSE.
 20380
 20381     IF NOT PB-BATCH-TRAILER
 20382        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 20383
 20384* EXEC CICS ENDBR
 20385*            DATASET  (FILE-ID-ERPNDB)
 20386*       END-EXEC
 20387     MOVE 0
 20388       TO DFHEIV11
 20389*    MOVE '&2                    $   #00017120' TO DFHEIV0
 20390     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20391     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20392     MOVE X'2020233030303137313230' TO DFHEIV0(25:11)
 20393     CALL 'kxdfhei1' USING DFHEIV0,
 20394           FILE-ID-ERPNDB,
 20395           DFHEIV11,
 20396           DFHEIV99
 20397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20398        GO TO 5505-START-BROWSE.
 20399
 20400     IF PI-CSR-BROWSE
 20401        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 20402           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 20403
 20404* EXEC CICS ENDBR
 20405*               DATASET  (FILE-ID-ERPNDB)
 20406*          END-EXEC
 20407     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 378
* EL6311.cbl
 20408       TO DFHEIV11
 20409*    MOVE '&2                    $   #00017128' TO DFHEIV0
 20410     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20411     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20412     MOVE X'2020233030303137313238' TO DFHEIV0(25:11)
 20413     CALL 'kxdfhei1' USING DFHEIV0,
 20414           FILE-ID-ERPNDB,
 20415           DFHEIV11,
 20416           DFHEIV99
 20417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20418           GO TO 5505-START-BROWSE.
 20419
 20420     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 20421        IF PI-PB-CARRIER    = SPACES AND
 20422           PI-PB-GROUPING   = SPACES AND
 20423           PI-PB-STATE      = SPACES AND
 20424           PI-PB-ACCOUNT    = SPACES
 20425             GO TO 7200-DISPLAY-BATCHES
 20426          ELSE
 20427            IF PI-PB-CARRIER    = PB-CARRIER  AND
 20428               PI-PB-GROUPING   = PB-GROUPING AND
 20429               PI-PB-STATE      = PB-STATE    AND
 20430               PI-PB-ACCOUNT    = PB-ACCOUNT
 20431                 GO TO 7200-DISPLAY-BATCHES.
 20432
 20433     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 20434
 20435
 20436* EXEC CICS ENDBR
 20437*         DATASET  (FILE-ID-ERPNDB)
 20438*    END-EXEC.
 20439     MOVE 0
 20440       TO DFHEIV11
 20441*    MOVE '&2                    $   #00017148' TO DFHEIV0
 20442     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 20443     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20444     MOVE X'2020233030303137313438' TO DFHEIV0(25:11)
 20445     CALL 'kxdfhei1' USING DFHEIV0,
 20446           FILE-ID-ERPNDB,
 20447           DFHEIV11,
 20448           DFHEIV99
 20449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20450
 20451
 20452     GO TO 5505-START-BROWSE.
 20453
 20454 5550-END-RECORDS.
 20455     MOVE ER-2257                TO EMI-ERROR.
 20456     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20457     MOVE -1                     TO DPFENTRL.
 20458
 20459     GO TO 8200-SEND-DATAONLY.
 20460
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 379
* EL6311.cbl
 20462
 20463******************************************************************
 20464*                                                                *
 20465*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 20466*                                                                *
 20467******************************************************************
 20468
 20469 6000-CREATE-TEMP-STORAGE.
 20470
 20471
 20472* EXEC CICS HANDLE CONDITION
 20473*        QIDERR  (6050-QID-ERROR)
 20474*    END-EXEC.
 20475*    MOVE '"$N                   ! T #00017171' TO DFHEIV0
 20476     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20477     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20478     MOVE X'5420233030303137313731' TO DFHEIV0(25:11)
 20479     CALL 'kxdfhei1' USING DFHEIV0
 20480     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20481
 20482
 20483
 20484* EXEC CICS WRITEQ TS
 20485*        QUEUE    (QID)
 20486*        FROM     (PROGRAM-INTERFACE-BLOCK)
 20487*        LENGTH   (WS-COMM-LENGTH)
 20488*        ITEM     (W-ONE)
 20489*    END-EXEC.
 20490*    MOVE '*" I                  ''   #00017175' TO DFHEIV0
 20491     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
 20492     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20493     MOVE X'2020233030303137313735' TO DFHEIV0(25:11)
 20494     CALL 'kxdfhei1' USING DFHEIV0,
 20495           QID,
 20496           PROGRAM-INTERFACE-BLOCK,
 20497           WS-COMM-LENGTH,
 20498           W-ONE,
 20499           DFHEIV99,
 20500           DFHEIV99
 20501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20502
 20503
 20504 6000-EXIT.
 20505      EXIT.
 20506
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 380
* EL6311.cbl
 20508
 20509******************************************************************
 20510*                                                                *
 20511*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 20512*                                                                *
 20513******************************************************************
 20514
 20515 6050-RECOVER-TEMP-STORAGE.
 20516     IF PGM-NAME = XCTL-EL6312
 20517        GO TO 6050-EXIT.
 20518
 20519     IF PGM-NAME = XCTL-EL6313
 20520        GO TO 6050-EXIT.
 20521
 20522     IF PGM-NAME = XCTL-EL6315
 20523         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 20524     END-IF
 20525
 20526     IF PGM-NAME = XCTL-EL6316
 20527         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 20528     END-IF
 20529
 20530
 20531* EXEC CICS HANDLE CONDITION
 20532*        QIDERR  (6050-QID-ERROR)
 20533*    END-EXEC.
 20534*    MOVE '"$N                   ! U #00017208' TO DFHEIV0
 20535     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 20536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20537     MOVE X'5520233030303137323038' TO DFHEIV0(25:11)
 20538     CALL 'kxdfhei1' USING DFHEIV0
 20539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20540
 20541
 20542
 20543* EXEC CICS READQ TS
 20544*         QUEUE   (QID)
 20545*         INTO    (PROGRAM-INTERFACE-BLOCK)
 20546*         LENGTH  (WS-COMM-LENGTH)
 20547*         ITEM    (W-ONE)
 20548*     END-EXEC.
 20549*    MOVE '*$II   L              ''   #00017212' TO DFHEIV0
 20550     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 20551     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20552     MOVE X'2020233030303137323132' TO DFHEIV0(25:11)
 20553     CALL 'kxdfhei1' USING DFHEIV0,
 20554           QID,
 20555           PROGRAM-INTERFACE-BLOCK,
 20556           WS-COMM-LENGTH,
 20557           W-ONE,
 20558           DFHEIV99,
 20559           DFHEIV99
 20560     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20561
 20562
 20563 6050-DELETE-TEMP-STORAGE.
 20564
 20565
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 381
* EL6311.cbl
 20566* EXEC CICS DELETEQ TS
 20567*        QUEUE   (QID)
 20568*    END-EXEC.
 20569*    MOVE '*&                    #   #00017221' TO DFHEIV0
 20570     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 20571     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 20572     MOVE X'2020233030303137323231' TO DFHEIV0(25:11)
 20573     CALL 'kxdfhei1' USING DFHEIV0,
 20574           QID,
 20575           DFHEIV99
 20576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20577
 20578
 20579     GO TO 6050-EXIT.
 20580
 20581 6050-QID-ERROR.
 20582     MOVE ER-0033                TO EMI-ERROR
 20583     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20584
 20585 6050-EXIT.
 20586      EXIT.
 20587
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 382
* EL6311.cbl
 20589
 20590******************************************************************
 20591*                                                                *
 20592*            T E R M   C O N V E R S I O N                       *
 20593*                                                                *
 20594******************************************************************
 20595
 20596 6100-TERM-CONVERSION.
 20597
 20598     IF PI-BPMTS = ZERO
 20599         GO TO 6199-EXIT.
 20600
 20601     IF PI-BMODE = ' ' OR 'M'
 20602         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 20603         GO TO 6105-ROUND-TERM.
 20604
 20605     IF PI-BMODE = 'S'
 20606         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 20607         GO TO 6105-ROUND-TERM.
 20608
 20609     IF PI-BMODE = 'W'
 20610         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 20611         GO TO 6105-ROUND-TERM.
 20612
 20613     IF PI-BMODE = 'B'
 20614         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 20615         GO TO 6105-ROUND-TERM.
 20616
 20617     IF PI-BMODE = 'T'
 20618         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 20619
 20620 6105-ROUND-TERM.
 20621
 20622     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 20623         ADD +1                  TO WS-CALC-TERM-WHOLE
 20624         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 20625
 20626     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 20627         GO TO 6125-COMPUTE-TERM-BENEFIT.
 20628
 20629     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 20630         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 20631                                      WS-BTERM    (WS-SUB1)
 20632         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 20633
 20634     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 20635         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 20636             MOVE -1               TO BMODEL
 20637             MOVE ER-2593          TO EMI-ERROR
 20638             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 20639             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20640
 20641 6124-CHECK-BENEFIT.
 20642
 20643     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 20644        GO TO 6126-COMPUTE-BENEFIT.
 20645
 20646     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 383
* EL6311.cbl
 20647
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 384
* EL6311.cbl
 20649******************************************************************
 20650**         COMPUTE TERM AND BENEFIT
 20651******************************************************************
 20652 6125-COMPUTE-TERM-BENEFIT.
 20653
 20654     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 20655        PI-BPMTAMT = ZERO
 20656         GO TO 6199-EXIT.
 20657
 20658     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 20659                                     WS-BTERM  (WS-SUB1).
 20660     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 20661
 20662 6126-COMPUTE-BENEFIT.
 20663
 20664     IF PI-BMODE = 'M' OR  ' '
 20665         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 20666
 20667     IF PI-BMODE = 'W'
 20668         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 20669
 20670     IF PI-BMODE = 'S'
 20671         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 20672
 20673     IF PI-BMODE = 'B'
 20674         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 20675
 20676     IF PI-BMODE = 'T'
 20677         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 20678
 20679     IF WS-SUB1 = +1
 20680        COMPUTE WS-BBEN (WS-SUB1) =
 20681                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 20682
 20683     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 20684     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 20685     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 20686
 20687 6199-EXIT.
 20688     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 385
* EL6311.cbl
 20690
 20691******************************************************************
 20692*                                                                *
 20693*             D I S P L A Y   I S S U E S                        *
 20694*                                                                *
 20695******************************************************************
 20696
 20697 6200-CREATE-VADS.
 20698     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 20699     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 20700     MOVE SPACES                 TO WS-PASS-VADS-REC
 20701
 20702* EXEC CICS GETMAIN
 20703*       SET      (ADDRESS OF PENDING-BUSINESS)
 20704*       LENGTH   (ERPNDB-RECORD-LENGTH)
 20705*       INITIMG  (GETMAIN-SPACE)
 20706*       RESP     (WS-RESPONSE)
 20707*    END-EXEC
 20708*    MOVE ',"IL                  $  N#00017347' TO DFHEIV0
 20709     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20710     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20711     MOVE X'204E233030303137333437' TO DFHEIV0(25:11)
 20712     CALL 'kxdfhei1' USING DFHEIV0,
 20713           DFHEIV20,
 20714           ERPNDB-RECORD-LENGTH,
 20715           GETMAIN-SPACE
 20716     SET ADDRESS OF PENDING-BUSINESS TO
 20717         DFHEIV20
 20718     MOVE EIBRESP  TO WS-RESPONSE
 20719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20720
 20721* EXEC CICS READ
 20722*       INTO    (PENDING-BUSINESS)
 20723*       DATASET (FILE-ID-ERPNDB)
 20724*       RIDFLD  (ERPNDB-KEY)
 20725*       RESP    (WS-RESPONSE)
 20726*    END-EXEC
 20727     MOVE LENGTH OF
 20728      PENDING-BUSINESS
 20729       TO DFHEIV11
 20730*    MOVE '&"IL       E          (  N#00017353' TO DFHEIV0
 20731     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20732     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20733     MOVE X'204E233030303137333533' TO DFHEIV0(25:11)
 20734     CALL 'kxdfhei1' USING DFHEIV0,
 20735           FILE-ID-ERPNDB,
 20736           PENDING-BUSINESS,
 20737           DFHEIV11,
 20738           ERPNDB-KEY,
 20739           DFHEIV99,
 20740           DFHEIV99,
 20741           DFHEIV99
 20742     MOVE EIBRESP  TO WS-RESPONSE
 20743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20744     IF RESP-NORMAL
 20745        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 20746        IF (RESP-NORMAL)
 20747           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 386
* EL6311.cbl
 20748              AM-CONTROL-PRIMARY (1:20))
 20749           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 20750        ELSE
 20751           MOVE 'ACCOUNT NOT FOUND'
 20752                                 TO VD-ACCOUNT-NAME
 20753        END-IF
 20754        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 20755                                    TO M1
 20756        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 20757        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 20758           (A2 > M1)
 20759           OR (WS-WORK-FIELD (A2:1) = '*')
 20760           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 20761           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 20762        END-PERFORM
 20763        IF A2 > M1
 20764           CONTINUE
 20765        ELSE
 20766           MOVE WS-WORK-FIELD (1:A2 - 1)
 20767                                    TO VD-ACCOUNT-NAME
 20768        END-IF
 20769        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 20770        MOVE PB-CARRIER          TO VD-CARRIER
 20771        MOVE PB-GROUPING         TO VD-GROUPING
 20772        MOVE PB-STATE            TO VD-STATE
 20773        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 20774        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 20775        MOVE PB-CERT-NO          TO VD-CERT-NO
 20776        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 20777        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 20778        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 20779        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 20780        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 20781        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 20782        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 20783        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 20784        MOVE PB-CSR-ID           TO VD-CSR-ID
 20785        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 20786        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 20787        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 20788        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 20789        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 20790        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 20791        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 20792        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 20793        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 20794        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 20795        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 20796        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 20797        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 20798     END-IF
 20799     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 20800
 20801
 20802* EXEC CICS GETMAIN
 20803*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 20804*       LENGTH   (ERPNDM-RECORD-LENGTH)
 20805*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 387
* EL6311.cbl
 20806*       RESP     (WS-RESPONSE)
 20807*    END-EXEC
 20808*    MOVE ',"IL                  $  N#00017416' TO DFHEIV0
 20809     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20810     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20811     MOVE X'204E233030303137343136' TO DFHEIV0(25:11)
 20812     CALL 'kxdfhei1' USING DFHEIV0,
 20813           DFHEIV20,
 20814           ERPNDM-RECORD-LENGTH,
 20815           GETMAIN-SPACE
 20816     SET ADDRESS OF PENDING-MAILING-DATA TO
 20817         DFHEIV20
 20818     MOVE EIBRESP  TO WS-RESPONSE
 20819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20820
 20821
 20822* EXEC CICS READ
 20823*       INTO    (PENDING-MAILING-DATA)
 20824*       DATASET (FILE-ID-ERPNDM)
 20825*       RIDFLD  (ERPNDM-KEY)
 20826*       RESP    (WS-RESPONSE)
 20827*    END-EXEC
 20828     MOVE LENGTH OF
 20829      PENDING-MAILING-DATA
 20830       TO DFHEIV11
 20831*    MOVE '&"IL       E          (  N#00017423' TO DFHEIV0
 20832     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 20833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20834     MOVE X'204E233030303137343233' TO DFHEIV0(25:11)
 20835     CALL 'kxdfhei1' USING DFHEIV0,
 20836           FILE-ID-ERPNDM,
 20837           PENDING-MAILING-DATA,
 20838           DFHEIV11,
 20839           ERPNDM-KEY,
 20840           DFHEIV99,
 20841           DFHEIV99,
 20842           DFHEIV99
 20843     MOVE EIBRESP  TO WS-RESPONSE
 20844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20845
 20846     IF RESP-NORMAL
 20847        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 20848        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 20849        MOVE PM-CITY              TO VD-INSURED-CITY
 20850        MOVE PM-STATE             TO VD-INSURED-STATE
 20851        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 20852     END-IF
 20853
 20854     MOVE 'VAC1'                  TO VD-LETTER-ID
 20855     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 20856     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 20857     MOVE EIBTIME                 TO VD-CURRENT-TIME
 20858     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 20859     MOVE +0                      TO VD-ARCHIVE-NO
 20860     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 20861     .
 20862 6200-EXIT.
 20863     EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 388
* EL6311.cbl
 20864 6210-READ-ERACCT.
 20865     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 20866     MOVE LOW-VALUES             TO ERACCT-FILL
 20867
 20868* EXEC CICS READ
 20869*         DATASET   ('ERACCT')
 20870*         INTO      (ACCOUNT-MASTER)
 20871*         RIDFLD    (ERACCT-KEY)
 20872*         GTEQ
 20873*         RESP      (WS-RESPONSE)
 20874*    END-EXEC
 20875     MOVE LENGTH OF
 20876      ACCOUNT-MASTER
 20877       TO DFHEIV11
 20878     MOVE 'ERACCT' TO DFHEIV1
 20879*    MOVE '&"IL       G          (  N#00017451' TO DFHEIV0
 20880     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 20881     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20882     MOVE X'204E233030303137343531' TO DFHEIV0(25:11)
 20883     CALL 'kxdfhei1' USING DFHEIV0,
 20884           DFHEIV1,
 20885           ACCOUNT-MASTER,
 20886           DFHEIV11,
 20887           ERACCT-KEY,
 20888           DFHEIV99,
 20889           DFHEIV99,
 20890           DFHEIV99
 20891     MOVE EIBRESP  TO WS-RESPONSE
 20892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20893     .
 20894 6210-EXIT.
 20895     EXIT.
 20896
 20897 6220-READ-ERMAIL.
 20898
 20899     MOVE ELCERT-KEY             TO ERMAIL-KEY
 20900     MOVE ' '                    TO WS-ERMAIL-SW
 20901
 20902
 20903* EXEC CICS READ
 20904*       DATASET   (FILE-ID-ERMAIL)
 20905*       SET       (ADDRESS OF MAILING-DATA)
 20906*       RIDFLD    (ERMAIL-KEY)
 20907*       RESP      (WS-RESPONSE)
 20908*    END-EXEC
 20909*    MOVE '&"S        E          (  N#00017467' TO DFHEIV0
 20910     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20911     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20912     MOVE X'204E233030303137343637' TO DFHEIV0(25:11)
 20913     CALL 'kxdfhei1' USING DFHEIV0,
 20914           FILE-ID-ERMAIL,
 20915           DFHEIV20,
 20916           DFHEIV99,
 20917           ERMAIL-KEY,
 20918           DFHEIV99,
 20919           DFHEIV99,
 20920           DFHEIV99
 20921     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 389
* EL6311.cbl
 20922         DFHEIV20
 20923     MOVE EIBRESP  TO WS-RESPONSE
 20924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20925
 20926     IF RESP-NORMAL
 20927        SET ERMAIL-FOUND TO TRUE
 20928     END-IF
 20929     .
 20930 6220-EXIT.
 20931     EXIT.
 20932
 20933 6400-CHECK-FOR-RES-REF-CLAIM.
 20934     display 'made it to 6400- for ' pi-cert-no
 20935     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 20936
 20937     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 20938                                    W-CL-COMP-CD.
 20939     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 20940                                    W-CL-CERT-NO.
 20941     MOVE SPACES                 TO MSTR-CERT-SFX.
 20942
 20943
 20944* EXEC CICS HANDLE CONDITION
 20945*        NOTFND  (6400-CONTINUE)
 20946*        ENDFILE (6400-CONTINUE)
 20947*    END-EXEC.
 20948*    MOVE '"$I''                  ! V #00017491' TO DFHEIV0
 20949     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20950     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20951     MOVE X'5620233030303137343931' TO DFHEIV0(25:11)
 20952     CALL 'kxdfhei1' USING DFHEIV0
 20953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20954
 20955
 20956
 20957* EXEC CICS IGNORE CONDITION
 20958*        DUPKEY
 20959*    END-EXEC.
 20960*    MOVE '"*$                   !   #00017496' TO DFHEIV0
 20961     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 20962     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20963     MOVE X'2020233030303137343936' TO DFHEIV0(25:11)
 20964     CALL 'kxdfhei1' USING DFHEIV0
 20965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20966
 20967
 20968
 20969* EXEC CICS STARTBR
 20970*        DATASET   (CLMS-ID)
 20971*        RIDFLD    (ELMSTR-KEY)
 20972*        GENERIC   EQUAL
 20973*        KEYLENGTH (ELMSTR-LENGTH)
 20974*    END-EXEC.
 20975     MOVE 0
 20976       TO DFHEIV11
 20977*    MOVE '&,   KG    E          &   #00017500' TO DFHEIV0
 20978     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 20979     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 390
* EL6311.cbl
 20980     MOVE X'2020233030303137353030' TO DFHEIV0(25:11)
 20981     CALL 'kxdfhei1' USING DFHEIV0,
 20982           CLMS-ID,
 20983           ELMSTR-KEY,
 20984           ELMSTR-LENGTH,
 20985           DFHEIV11,
 20986           DFHEIV99
 20987     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20988
 20989
 20990     display 'browse started'
 20991     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20992
 20993 6400-NEXT-CLAIM.
 20994
 20995
 20996* EXEC CICS READNEXT
 20997*        DATASET   (CLMS-ID)
 20998*        RIDFLD    (ELMSTR-KEY)
 20999*        SET       (ADDRESS OF CLAIM-MASTER)
 21000*    END-EXEC.
 21001     MOVE 0
 21002       TO DFHEIV11
 21003*    MOVE '&.S                   )   #00017512' TO DFHEIV0
 21004     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21005     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21006     MOVE X'2020233030303137353132' TO DFHEIV0(25:11)
 21007     CALL 'kxdfhei1' USING DFHEIV0,
 21008           CLMS-ID,
 21009           DFHEIV20,
 21010           DFHEIV99,
 21011           ELMSTR-KEY,
 21012           DFHEIV99,
 21013           DFHEIV11,
 21014           DFHEIV99,
 21015           DFHEIV99
 21016     SET ADDRESS OF CLAIM-MASTER TO
 21017         DFHEIV20
 21018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21019
 21020
 21021     display 'read claim for ' mstr-cert-no
 21022     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 21023        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 21024         GO TO 6400-CONTINUE
 21025     END-IF.
 21026
 21027     IF PI-CARRIER     NOT = CL-CARRIER        OR
 21028        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 21029        PI-STATE       NOT = CL-CERT-STATE     OR
 21030        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 21031        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 21032         GO TO 6400-NEXT-CLAIM
 21033     END-IF.
 21034
 21035     display 'found claim ' cl-claim-no
 21036        ' with denial type ' cl-denial-type
 21037     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 391
* EL6311.cbl
 21038         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 21039         GO TO 6400-CONTINUE
 21040     END-IF.
 21041
 21042     GO TO 6400-NEXT-CLAIM.
 21043
 21044 6400-CONTINUE.
 21045
 21046     IF WS-BROWSE-STARTED-SW = 'Y'
 21047
 21048* EXEC CICS ENDBR
 21049*            DATASET   (CLMS-ID)
 21050*        END-EXEC
 21051     MOVE 0
 21052       TO DFHEIV11
 21053*    MOVE '&2                    $   #00017544' TO DFHEIV0
 21054     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21055     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21056     MOVE X'2020233030303137353434' TO DFHEIV0(25:11)
 21057     CALL 'kxdfhei1' USING DFHEIV0,
 21058           CLMS-ID,
 21059           DFHEIV11,
 21060           DFHEIV99
 21061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21062         MOVE 'N' TO WS-BROWSE-STARTED-SW
 21063     END-IF.
 21064
 21065 6400-EXIT.
 21066     EXIT.
 21067
 21068 7000-DISPLAY-ISSUES.
 21069
 21070     IF PI-DISPLAY-ORIGINAL-BATCH
 21071        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21072        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21073     ELSE
 21074        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21075
 21076     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21077
 21078     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21079     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21080
 21081     MOVE LOW-VALUES                 TO EL631BI.
 21082     MOVE ZEROS                      TO PI-BPMTAMT
 21083                                        PI-BPMTS.
 21084     MOVE SPACE                      TO PI-BMODE
 21085                                        PI-BTYPE (1)
 21086                                        PI-BTYPE (2).
 21087     MOVE EL631B                     TO PI-MAP-NAME.
 21088     MOVE 'Y'                        TO PI-BROWSE-SW.
 21089     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 21090                                        PI-HIGH-SEQ-NO.
 21091
 21092     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21093        MOVE AL-SABOF                TO BCHGTA
 21094        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 21095        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 392
* EL6311.cbl
 21096     ELSE
 21097        MOVE AL-SADOF                TO BCHGTA
 21098                                        BCHGA
 21099        MOVE PB-CHG-COUNT            TO BCHGO.
 21100
 21101     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 21102     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 21103     MOVE WS-HR-MINS                 TO BMANTATO.
 21104
 21105     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21106        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 21107        MOVE SPACE                   TO DC-OPTION-CODE
 21108        PERFORM 9700-DATE-LINK
 21109        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21110        MOVE 'INACTIVE'              TO BMOENDTO
 21111     ELSE
 21112        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 21113        MOVE SPACE                   TO DC-OPTION-CODE
 21114        PERFORM 9700-DATE-LINK
 21115        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 21116        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 21117        MOVE SPACE                   TO DC-OPTION-CODE
 21118        PERFORM 9700-DATE-LINK
 21119        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 21120
 21121*    MOVE PB-I-REFERENCE             TO BREFO.
 21122
 21123*    IF PI-COMPANY-ID EQUAL 'HER'
 21124*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 21125*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 21126*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 21127*                MOVE WS-MEMBER-NO-1-8
 21128*                                TO  BMICRNOO.
 21129
 21130*    IF PB-I-MICROFILM-NO  IS NUMERIC
 21131*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 21132*            MOVE PB-I-MICROFILM-NO
 21133*                                TO  BMICRNOO.
 21134     IF PB-I-VIN NOT = SPACES
 21135        MOVE PB-I-VIN            TO BVINO
 21136     END-IF
 21137
 21138     MOVE PB-CERT-PRIME              TO BCERTNOO.
 21139     MOVE PB-CERT-SFX                TO BSUFIXO.
 21140     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21141     MOVE SPACE                      TO DC-OPTION-CODE.
 21142     PERFORM 9700-DATE-LINK.
 21143     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 21144
 21145     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 21146     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 21147     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 21148     MOVE PB-I-INSURED-SEX           TO BSEXO
 21149
 21150     IF PB-I-AGE NOT = ZEROS
 21151         MOVE PB-I-AGE               TO BAGEO.
 21152
 21153     IF PB-I-BIRTHDAY NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 393
* EL6311.cbl
 21154         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 21155         MOVE SPACE                  TO DC-OPTION-CODE
 21156         PERFORM 9700-DATE-LINK
 21157         IF NO-CONVERSION-ERROR
 21158            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 21159
 21160     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 21161         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 21162         MOVE SPACE                  TO DC-OPTION-CODE
 21163         PERFORM 9700-DATE-LINK
 21164         IF NO-CONVERSION-ERROR
 21165            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 21166
 21167     IF PB-I-EXTENTION-DAYS NUMERIC
 21168        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 21169           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 21170        ELSE
 21171           IF PB-I-TERM-IN-DAYS NUMERIC
 21172              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 21173                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 21174
 21175     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 21176        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 21177
 21178     MOVE PB-FORCE-CODE              TO BFORCEO.
 21179     MOVE PB-I-TERM-TYPE             TO BMODEO
 21180                                        PI-BMODE.
 21181
 21182     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 21183        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 21184
 21185     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 21186         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 21187                                        PI-BPMTS.
 21188
 21189     IF PB-I-PAYMENT-AMOUNT NUMERIC
 21190         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 21191           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 21192                                        PI-BPMTAMT.
 21193
 21194     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 21195     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 21196     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 21197     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 21198     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
 21199     MOVE PB-I-SIG-SW                TO BSIGO.
 21200     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 21201     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 21202     MOVE PB-RECORD-BILL             TO BBILCDO.
 21203     MOVE PB-FORCE-CODE              TO BFORCEO.
 21204
 21205     IF (PB-I-LIVES NUMERIC)
 21206        AND (PB-I-LIVES > ZEROS)
 21207        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21208        IF (RESP-NORMAL)
 21209           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 21210           CONTINUE
 21211        ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 394
* EL6311.cbl
 21212           MOVE PB-I-LIVES       TO BLIVESO
 21213        END-IF
 21214     END-IF
 21215
 21216     IF PB-I-NUM-BILLED NUMERIC AND
 21217        PB-I-NUM-BILLED GREATER THAN ZEROS
 21218        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 21219*    ELSE
 21220*       MOVE ZEROS                   TO BBILLEDO.
 21221
 21222     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 21223
 21224     IF PB-I-LOAN-APR NOT = ZEROS
 21225        MOVE PB-I-LOAN-APR           TO BAPRO.
 21226
 21227     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 21228        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 21229
 21230     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 21231        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 21232           MOVE AL-SANOF                TO BORIGHDA
 21233           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 21234           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 21235
 21236     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 21237
 21238     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 21239        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 21240
 21241     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 21242        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 21243                                        PI-BTYPE (1).
 21244
 21245     IF PB-I-LF-TERM     GREATER THAN ZEROS
 21246        MOVE PB-I-LF-TERM            TO BTERMO (1).
 21247
 21248     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 21249        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 21250
 21251     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 21252        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 21253
 21254     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 21255        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 21256
 21257     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21258        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 21259
 21260     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 21261         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 21262         MOVE SPACE                  TO DC-OPTION-CODE
 21263         PERFORM 9700-DATE-LINK
 21264         IF NO-CONVERSION-ERROR
 21265            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 21266
 21267     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21268        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 21269        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 395
* EL6311.cbl
 21270        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 21271        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 21272                 GIVING BDIFFO (1)
 21273     ELSE
 21274        MOVE SPACES                  TO BBEN-CD     (1)
 21275                                        BBEN-ABBR   (1).
 21276
 21277     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 21278        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 21279        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 21280                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 21281
 21282     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21283       IF PB-RECORD-ON-HOLD
 21284          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 21285
 21286     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21287       IF PB-RECORD-RETURNED
 21288          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 21289
 21290     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 21291        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21292             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 21293
 21294     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 21295
 21296     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 21297        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 21298
 21299     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 21300        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 21301                                        PI-BTYPE (2).
 21302
 21303     IF PB-I-AH-TERM     GREATER THAN ZEROS
 21304        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 21305
 21306     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 21307        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 21308
 21309     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 21310        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 21311
 21312     IF PB-I-TOT-FEES NOT NUMERIC
 21313        MOVE ZEROS               TO PB-I-TOT-FEES
 21314     END-IF
 21315     IF PB-I-TOT-FEES > ZEROS
 21316        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 21317
 21318     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 21319         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 21320         MOVE SPACE                  TO DC-OPTION-CODE
 21321         PERFORM 9700-DATE-LINK
 21322         IF NO-CONVERSION-ERROR
 21323            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 21324
 21325     IF PB-I-TOT-FEES > ZEROS
 21326        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 21327        SUBTRACT PB-I-TOT-FEES FROM
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 396
* EL6311.cbl
 21328                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 21329
 21330     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21331        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 21332        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 21333        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 21334        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 21335                 GIVING BDIFFO (2)
 21336     ELSE
 21337        MOVE SPACES                  TO BBEN-CD     (2)
 21338                                        BBEN-ABBR   (2).
 21339
 21340     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21341       IF PB-RECORD-ON-HOLD
 21342          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 21343
 21344     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21345       IF PB-RECORD-RETURNED
 21346          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 21347
 21348     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 21349        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21350             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 21351
 21352     MOVE PB-CSR-ID                  TO BCSRO.
 21353
 21354     IF PI-COMPANY-ID  =  'DMD'
 21355        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 21356            NEXT SENTENCE
 21357        ELSE
 21358            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 21359               MOVE 'NEW CERT'       TO BNCERTLI
 21360               MOVE EC-NEW-CERT      TO BNCERTO.
 21361
 21362     IF PI-COMPANY-ID  =  'DMD'
 21363        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 21364            NEXT SENTENCE
 21365        ELSE
 21366           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 21367               MOVE 'NEW STATE'      TO BNSTATLI
 21368               MOVE EC-NEW-STATE     TO BNSTATO.
 21369
 21370 7000-CONTINUE.
 21371     MOVE 'C'                        TO BMAINTI.
 21372     MOVE AL-UANON                   TO BMAINTA.
 21373
 21374     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 21375        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 21376
 21377     IF PI-6315-FINALIZED = 'Y'   AND
 21378        PB-UNFORCED-ERRORS
 21379          MOVE -1                TO BFORCEL
 21380          MOVE  1                TO SET-CURSOR-SW
 21381     END-IF
 21382
 21383     IF NO-CURSOR-SET
 21384        MOVE -1                      TO BMAINTL.
 21385
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 397
* EL6311.cbl
 21386     GO TO 8100-SEND-INITIAL-MAP.
 21387
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 398
* EL6311.cbl
 21389
 21390******************************************************************
 21391*                                                                *
 21392*             D I S P L A Y   C A N C E L S                      *
 21393*                                                                *
 21394******************************************************************
 21395
 21396 7100-DISPLAY-CANCELS.
 21397     IF PI-DISPLAY-ORIGINAL-BATCH
 21398        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 21399        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 21400     ELSE
 21401        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 21402
 21403     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 21404
 21405     MOVE 'Y'                        TO WS-DISPLAY-SW.
 21406     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 21407
 21408     MOVE LOW-VALUES                 TO EL631CI.
 21409     MOVE EL631C                     TO PI-MAP-NAME.
 21410     MOVE 'Y'                        TO PI-BROWSE-SW.
 21411     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 21412                                        PI-HIGH-SEQ-NO.
 21413
 21414     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 21415        MOVE AL-SABOF                TO CCHGTA
 21416        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 21417        MOVE AL-SANON                TO CCHGA
 21418      ELSE
 21419        MOVE AL-SADOF                TO CCHGTA
 21420                                        CCHGA
 21421        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 21422
 21423*    MOVE PB-C-REFERENCE             TO CREFO.
 21424
 21425*    IF PB-C-MICROFILM-NO IS NUMERIC
 21426*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 21427*          MOVE PB-C-MICROFILM-NO
 21428*                                TO CMICRNOO
 21429*          MOVE AL-UNNON         TO CMICRNOA
 21430*       END-IF
 21431*    END-IF
 21432     IF PB-C-NH-INT-ON-REFS NUMERIC
 21433        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 21434           MOVE PB-C-NH-INT-ON-REFS
 21435                                 TO CNHINTO
 21436           MOVE AL-SANOF         TO CNHINTA
 21437        END-IF
 21438     END-IF
 21439     MOVE PB-CERT-PRIME              TO CCERTNOO.
 21440     MOVE PB-CERT-SFX                TO CSUFIXO.
 21441     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 21442     MOVE SPACE                      TO DC-OPTION-CODE.
 21443     PERFORM 9700-DATE-LINK.
 21444     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 21445
 21446     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 399
* EL6311.cbl
 21447        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 21448        MOVE SPACE                   TO DC-OPTION-CODE
 21449        PERFORM 9700-DATE-LINK
 21450        IF NO-CONVERSION-ERROR
 21451           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 21452
 21453     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 21454        NEXT SENTENCE
 21455     ELSE
 21456        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 21457
 21458     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 21459        NEXT SENTENCE
 21460     ELSE
 21461        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 21462
 21463     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 21464        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 21465        MOVE SPACE                   TO DC-OPTION-CODE
 21466        PERFORM 9700-DATE-LINK
 21467        IF NO-CONVERSION-ERROR
 21468           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 21469
 21470     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21471         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 21472
 21473     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21474         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 21475
 21476     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 21477        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 21478        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 21479                 GIVING CDRFND1O.
 21480
 21481     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 21482        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 21483        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 21484                 GIVING CDRFND2O.
 21485
 21486     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21487       IF PB-RECORD-ON-HOLD
 21488          MOVE 'ON HOLD'             TO CBILIT1O.
 21489
 21490     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21491       IF PB-RECORD-RETURNED
 21492          MOVE 'RETURNED'            TO CBILIT1O.
 21493
 21494     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 21495        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 21496             MOVE 'OVERRIDE'         TO CBILIT1O.
 21497
 21498     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21499       IF PB-RECORD-ON-HOLD
 21500          MOVE 'ON HOLD'             TO CBILIT2O.
 21501
 21502     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21503       IF PB-RECORD-RETURNED
 21504          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 400
* EL6311.cbl
 21505
 21506     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 21507        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 21508             MOVE 'OVERRIDE'         TO CBILIT2O.
 21509
 21510     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 21511     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 21512     IF PB-C-POST-CARD-IND = 'Y'
 21513        MOVE 'Y'                     TO CPCYNO
 21514     ELSE
 21515        MOVE 'N'                     TO CPCYNO
 21516     END-IF
 21517     MOVE PB-FORCE-CODE              TO CFORCEO.
 21518     MOVE PB-RECORD-BILL             TO CBILCDO.
 21519     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 21520     MOVE SPACES                     TO CINITSO.
 21521     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 21522         MOVE PB-CI-FIRST-NAME       TO CINITSO
 21523     ELSE
 21524         MOVE PB-CI-INITIALS         TO CINITSO
 21525     END-IF.
 21526
 21527     IF PB-CI-CANCEL-FEE NUMERIC
 21528        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 21529        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 21530     ELSE
 21531        MOVE ZEROES                  TO W-CANCEL-FEE.
 21532
 21533     MOVE W-CANCEL-FEE               TO CCANFEEO.
 21534
 21535     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 21536        ADD PB-CI-LF-PREMIUM-AMT
 21537             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 21538
 21539     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 21540        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 21541
 21542     MOVE PB-CI-LF-TERM              TO CTERM1O.
 21543     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 21544     MOVE PB-CI-AH-TERM              TO CTERM2O.
 21545     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 21546
 21547     IF PB-C-LIVES NUMERIC
 21548        MOVE PB-C-LIVES              TO CLIVESO.
 21549
 21550     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 21551        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 21552
 21553     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 21554        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 21555        MOVE SPACE                   TO DC-OPTION-CODE
 21556        PERFORM 9700-DATE-LINK
 21557        IF NO-CONVERSION-ERROR
 21558           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 21559
 21560     IF  PB-C-REFUND-CREATED
 21561         MOVE 'YES'                  TO CRFNDSWO
 21562     ELSE
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 401
* EL6311.cbl
 21563         IF PB-C-REFUND-REQUESTED
 21564            MOVE 'REQ'               TO CRFNDSWO
 21565         ELSE
 21566            MOVE 'NO'                TO CRFNDSWO.
 21567
 21568     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 21569     MOVE SPACE                      TO DC-OPTION-CODE.
 21570     PERFORM 9700-DATE-LINK.
 21571     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 21572     MOVE PB-INPUT-BY                TO CENTBYO.
 21573
 21574     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21575        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 21576        MOVE SPACE                   TO DC-OPTION-CODE
 21577        PERFORM 9700-DATE-LINK
 21578        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 21579        MOVE 'INACTIVE'              TO CMOENDTO
 21580     ELSE
 21581        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 21582        MOVE SPACE                   TO DC-OPTION-CODE
 21583        PERFORM 9700-DATE-LINK
 21584        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 21585        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 21586        MOVE SPACE                   TO DC-OPTION-CODE
 21587        PERFORM 9700-DATE-LINK
 21588        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 21589
 21590     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 21591
 21592     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 21593     MOVE WS-HR-MINS                 TO CMANTATO.
 21594
 21595     EVALUATE PB-LF-REFUND-TYPE
 21596        WHEN '1'
 21597           MOVE 'RULE78'            TO CLFREFNO
 21598        WHEN '2'
 21599           MOVE 'PRORAT'            TO CLFREFNO
 21600        WHEN '3'
 21601           MOVE 'CALIF'             TO CLFREFNO
 21602        WHEN '4'
 21603           MOVE 'IRREG'             TO CLFREFNO
 21604        WHEN '5'
 21605           MOVE 'NETPAY'            TO CLFREFNO
 21606        WHEN '6'
 21607           MOVE 'ATCP'              TO CLFREFNO
 21608        WHEN '7'
 21609           MOVE 'UTAH'              TO CLFREFNO
 21610        WHEN '8'
 21611           MOVE 'MEAN'              TO CLFREFNO
 21612        WHEN '9'
 21613           MOVE 'SUM '              TO CLFREFNO
 21614        WHEN 'B'
 21615           MOVE 'BALN'              TO CLFREFNO
 21616     END-EVALUATE.
 21617
 21618     EVALUATE TRUE
 21619        WHEN PB-AH-REFUND-TYPE =  '1'
 21620           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 402
* EL6311.cbl
 21621        WHEN PB-AH-REFUND-TYPE =  '2'
 21622           MOVE 'PRORAT'            TO CAHREFNO
 21623        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 21624           MOVE 'CALIF'             TO CAHREFNO
 21625        WHEN PB-AH-REFUND-TYPE =  '4'
 21626           MOVE 'IRREG'             TO CAHREFNO
 21627        WHEN PB-AH-REFUND-TYPE =  '5'
 21628           MOVE 'NETPAY'            TO CAHREFNO
 21629        WHEN PB-AH-REFUND-TYPE =  '6'
 21630           MOVE 'ATCP'              TO CAHREFNO
 21631        WHEN PB-AH-REFUND-TYPE =  '7'
 21632           MOVE 'UTAH'              TO CAHREFNO
 21633        WHEN PB-AH-REFUND-TYPE =  '8'
 21634           MOVE 'MEAN'              TO CAHREFNO
 21635        WHEN PB-AH-REFUND-TYPE =  '9'
 21636           MOVE 'SUM '              TO CAHREFNO
 21637        WHEN PB-AH-REFUND-TYPE =  'B'
 21638           MOVE 'BALN'              TO CAHREFNO
 21639     END-EVALUATE.
 21640
 21641     MOVE PB-REIN-CD                 TO CREINCDO.
 21642
 21643     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 21644        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 21645        MOVE SPACE                   TO DC-OPTION-CODE
 21646        PERFORM 9700-DATE-LINK
 21647        IF NO-CONVERSION-ERROR
 21648           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 21649
 21650     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 21651        MOVE 999999                  TO WS-EXP-DT-EDIT
 21652        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 21653        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 21654     ELSE
 21655        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 21656           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 21657           MOVE SPACE                   TO DC-OPTION-CODE
 21658           PERFORM 9700-DATE-LINK
 21659           IF NO-CONVERSION-ERROR
 21660              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 21661
 21662     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 21663        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 21664           MOVE AL-SANOF                TO CORIGHDA
 21665           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 21666           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 21667
 21668     MOVE PB-CSR-ID              TO CCSRO.
 21669
 21670     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 21671     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 21672
 21673     MOVE 'C'                    TO CMAINTI.
 21674     MOVE AL-UANON               TO CMAINTA.
 21675
 21676     IF PI-6316-FINALIZED = 'Y'  AND
 21677        PB-UNFORCED-ERRORS
 21678          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 403
* EL6311.cbl
 21679          MOVE  1                TO SET-CURSOR-SW
 21680     END-IF
 21681
 21682     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 21683        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 21684
 21685     IF NO-CURSOR-SET
 21686        MOVE -1                  TO CMAINTL.
 21687
 21688     GO TO 8100-SEND-INITIAL-MAP.
 21689
 21690
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 404
* EL6311.cbl
 21692***************************************************************
 21693*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 21694*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 21695***************************************************************
 21696
 21697 7200-DISPLAY-BATCHES.
 21698     MOVE EL631D                 TO PI-MAP-NAME.
 21699     MOVE LOW-VALUES             TO EL631DI.
 21700
 21701     MOVE 'Y'                    TO WS-DISPLAY-SW.
 21702
 21703
 21704* EXEC CICS HANDLE CONDITION
 21705*         NOTFND   (3690-NOT-FOUND)
 21706*    END-EXEC.
 21707*    MOVE '"$I                   ! W #00018188' TO DFHEIV0
 21708     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21709     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21710     MOVE X'5720233030303138313838' TO DFHEIV0(25:11)
 21711     CALL 'kxdfhei1' USING DFHEIV0
 21712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21713
 21714
 21715     IF PI-DISPLAY-SCREEN
 21716        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21717     ELSE
 21718        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 21719
 21720     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 21721     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 21722
 21723
 21724* EXEC CICS READ
 21725*         DATASET   (FILE-ID-ERPNDB)
 21726*         RIDFLD    (ERPNDB-KEY)
 21727*         SET       (ADDRESS OF PENDING-BUSINESS)
 21728*    END-EXEC.
 21729*    MOVE '&"S        E          (   #00018200' TO DFHEIV0
 21730     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 21731     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21732     MOVE X'2020233030303138323030' TO DFHEIV0(25:11)
 21733     CALL 'kxdfhei1' USING DFHEIV0,
 21734           FILE-ID-ERPNDB,
 21735           DFHEIV20,
 21736           DFHEIV99,
 21737           ERPNDB-KEY,
 21738           DFHEIV99,
 21739           DFHEIV99,
 21740           DFHEIV99
 21741     SET ADDRESS OF PENDING-BUSINESS TO
 21742         DFHEIV20
 21743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21744
 21745
 21746     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 21747     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21748     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 21749     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 405
* EL6311.cbl
 21750     MOVE PB-SV-STATE            TO PI-SV-STATE.
 21751
 21752     MOVE EL631D                 TO PI-MAP-NAME.
 21753     MOVE LOW-VALUES             TO EL631DI.
 21754     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 21755
 21756*    IF PI-AR-PROCESSING
 21757*       MOVE PB-REFERENCE        TO DREFO.
 21758
 21759     MOVE PB-CSR-ID              TO DCSRO.
 21760
 21761     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 21762        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 21763        MOVE SPACE               TO DC-OPTION-CODE
 21764        PERFORM 9700-DATE-LINK
 21765        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 21766        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 21767        MOVE 'INACTIVE'          TO DLDATEO
 21768     ELSE
 21769        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 21770        MOVE SPACE               TO DC-OPTION-CODE
 21771        PERFORM 9700-DATE-LINK
 21772        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 21773
 21774     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 21775     MOVE SPACE                  TO DC-OPTION-CODE.
 21776     PERFORM 9700-DATE-LINK.
 21777     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 21778
 21779     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 21780        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 21781     ELSE
 21782        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 21783        MOVE SPACE               TO DC-OPTION-CODE
 21784        PERFORM 9700-DATE-LINK
 21785        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 21786
 21787     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 21788     MOVE SPACE                  TO DC-OPTION-CODE.
 21789     PERFORM 9700-DATE-LINK.
 21790     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 21791
 21792     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 21793     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 21794
 21795     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 21796        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 21797                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 21798
 21799     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 21800     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 21801     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 21802
 21803     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 21804        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 21805                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 21806
 21807     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 406
* EL6311.cbl
 21808     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 21809     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 21810
 21811     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 21812        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 21813                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 21814
 21815     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 21816     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 21817
 21818     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 21819        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 21820                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 21821
 21822     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 21823     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 21824     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 21825
 21826     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 21827        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 21828                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 21829
 21830     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 21831     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 21832     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 21833
 21834     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 21835        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 21836                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 21837
 21838     MOVE -1                     TO DPFENTRL.
 21839     GO TO 8100-SEND-INITIAL-MAP.
 21840
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 407
* EL6311.cbl
 21842
 21843***************************************************************
 21844*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 21845*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 21846*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 21847*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 21848*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 21849*     ARE THEN SET ACCORDINGLY.                               *
 21850*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 21851*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 21852*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 21853***************************************************************
 21854
 21855******************************************************************
 21856*                                                                *
 21857*            E R R O R   A N A L Y S I S                         *
 21858*                                                                *
 21859******************************************************************
 21860
 21861******************************************************************
 21862*                                                                *
 21863*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 21864*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 21865*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 21866*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 21867*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 21868*                                                                *
 21869*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 21870*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 21871*                                                                *
 21872******************************************************************
 21873
 21874 7300-FORMAT-ERRORS.
 21875     MOVE ' '                    TO PI-ERRORS-SW
 21876     IF PB-COMMON-ERRORS = LOW-VALUES
 21877        IF PB-FATAL-ERRORS
 21878           MOVE ER-2695          TO EMI-ERROR
 21879           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21880           GO TO 7399-EXIT.
 21881
 21882     MOVE +0                     TO WS-SUB4.
 21883
 21884 7310-ERROR-LOOP.
 21885
 21886     ADD +1                      TO WS-SUB4.
 21887
 21888     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 21889        GO TO 7350-SET-ERROR-FLAGS.
 21890
 21891     IF PI-COMPANY-ID = 'UCL'
 21892         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 21893             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 21894             MOVE ' '                   TO DC-OPTION-CODE
 21895             PERFORM 9700-DATE-LINK
 21896             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 21897
 21898     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 21899     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 408
* EL6311.cbl
 21900     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 21901
 21902     GO TO 7310-ERROR-LOOP.
 21903
 21904
 21905 7350-SET-ERROR-FLAGS.
 21906
 21907     IF EMI-FATAL-CTR NOT = ZEROS
 21908        display 'fatal error counter = ' emi-fatal-ctr
 21909        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 21910        MOVE 'X'                 TO PB-FATAL-FLAG
 21911                                    PI-ERRORS-SW
 21912        GO TO 7355-SET-ERROR-FLAGS.
 21913
 21914     IF EMI-FORCABLE-CTR NOT = ZEROS
 21915        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 21916        IF PB-ISSUE
 21917           IF PB-ISSUE-FORCE
 21918              MOVE 'F'           TO PB-FORCE-ER-CD
 21919              MOVE ER-2600       TO EMI-ERROR
 21920              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21921             ELSE
 21922              MOVE 'X'           TO PB-FORCE-ER-CD
 21923*                                   PI-ERRORS-SW
 21924          ELSE
 21925           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 21926              MOVE 'F'           TO PB-FORCE-ER-CD
 21927              MOVE ER-2600       TO EMI-ERROR
 21928              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21929             ELSE
 21930              MOVE 'X'           TO PB-FORCE-ER-CD.
 21931*                                   PI-ERRORS-SW.
 21932
 21933     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 21934     IF PB-ISSUE
 21935         MOVE 'I'                TO ENDT-RECORD-TYPE
 21936     ELSE
 21937         MOVE 'C'                TO ENDT-RECORD-TYPE
 21938     END-IF
 21939     MOVE +0                     TO ENDT-SEQ-NO
 21940
 21941
 21942* EXEC CICS READ
 21943*        DATASET   (FILE-ID-ERENDT)
 21944*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 21945*        RIDFLD    (ERENDT-KEY)
 21946*        RESP      (WS-RESPONSE)
 21947*        GTEQ
 21948*    END-EXEC
 21949*    MOVE '&"S        G          (  N#00018401' TO DFHEIV0
 21950     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21951     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21952     MOVE X'204E233030303138343031' TO DFHEIV0(25:11)
 21953     CALL 'kxdfhei1' USING DFHEIV0,
 21954           FILE-ID-ERENDT,
 21955           DFHEIV20,
 21956           DFHEIV99,
 21957           ERENDT-KEY,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 409
* EL6311.cbl
 21958           DFHEIV99,
 21959           DFHEIV99,
 21960           DFHEIV99
 21961     SET ADDRESS OF ENDORSEMENT-RECORD TO
 21962         DFHEIV20
 21963     MOVE EIBRESP  TO WS-RESPONSE
 21964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21965
 21966     IF RESP-NORMAL
 21967        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 21968        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 21969            MOVE ER-0280          TO EMI-ERROR
 21970            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 21971            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 21972            EVALUATE TRUE
 21973              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 21974                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 21975              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 21976                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 21977              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 21978                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 21979            END-EVALUATE
 21980        END-IF
 21981     END-IF
 21982
 21983
 21984
 21985     IF FIRST-ENTRY OR
 21986        EIBAID = DFHPF1 OR DFHPF2
 21987        MOVE '0'                TO PI-EDIT-SW
 21988        GO TO 7399-EXIT.
 21989
 21990 7355-SET-ERROR-FLAGS.
 21991
 21992     IF EMI-WARNING-CTR NOT = ZEROS
 21993        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 21994        MOVE 'W'                 TO PB-WARN-ER-CD.
 21995
 21996     IF PB-UNFORCED-ERRORS OR
 21997        PB-FATAL-ERRORS    OR
 21998        PB-RECORD-ON-HOLD  OR
 21999        PB-RECORD-RETURNED OR
 22000        PB-CANCELLATION
 22001          NEXT SENTENCE
 22002        ELSE
 22003          GO TO 7399-EXIT.
 22004
 22005
 22006* EXEC CICS  HANDLE CONDITION
 22007*           NOTFND   (7399-EXIT)
 22008*    END-EXEC.
 22009*    MOVE '"$I                   ! X #00018448' TO DFHEIV0
 22010     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22011     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22012     MOVE X'5820233030303138343438' TO DFHEIV0(25:11)
 22013     CALL 'kxdfhei1' USING DFHEIV0
 22014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22015
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 410
* EL6311.cbl
 22016
 22017     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 22018     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 22019     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 22020     MOVE PB-SV-STATE            TO ELCERT-STATE.
 22021
 22022
 22023* EXEC CICS READ
 22024*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 22025*        DATASET (FILE-ID-ELCERT)
 22026*        RIDFLD  (ELCERT-KEY)
 22027*        UPDATE
 22028*    END-EXEC.
 22029*    MOVE '&"S        EU         (   #00018457' TO DFHEIV0
 22030     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22031     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 22032     MOVE X'2020233030303138343537' TO DFHEIV0(25:11)
 22033     CALL 'kxdfhei1' USING DFHEIV0,
 22034           FILE-ID-ELCERT,
 22035           DFHEIV20,
 22036           DFHEIV99,
 22037           ELCERT-KEY,
 22038           DFHEIV99,
 22039           DFHEIV99,
 22040           DFHEIV99
 22041     SET ADDRESS OF CERTIFICATE-MASTER TO
 22042         DFHEIV20
 22043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22044
 22045
 22046
 22047     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 22048     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 22049
 22050     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 22051        GO TO 7360-REWRITE-CERT-MASTER.
 22052
 22053     IF PB-ISSUE
 22054        IF PB-RECORD-RETURNED
 22055            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 22056            GO TO 7360-REWRITE-CERT-MASTER
 22057        ELSE
 22058            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 22059            GO TO 7360-REWRITE-CERT-MASTER.
 22060
 22061     IF PB-RECORD-RETURNED
 22062         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 22063         GO TO 7360-REWRITE-CERT-MASTER.
 22064
 22065     IF PB-C-LF-CANCEL-VOIDED
 22066        IF (PB-UNFORCED-ERRORS OR
 22067            PB-FATAL-ERRORS    OR
 22068            PB-RECORD-ON-HOLD)
 22069            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 22070            GO TO 7360-REWRITE-CERT-MASTER
 22071        ELSE
 22072            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 22073            GO TO 7360-REWRITE-CERT-MASTER.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 411
* EL6311.cbl
 22074
 22075     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 22076                            OR PB-RECORD-ON-HOLD)
 22077        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 22078     ELSE
 22079        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 22080
 22081 7360-REWRITE-CERT-MASTER.
 22082
 22083     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 22084        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 22085
 22086* EXEC CICS UNLOCK
 22087*            DATASET    (FILE-ID-ELCERT)
 22088*       END-EXEC
 22089*    MOVE '&*                    #   #00018503' TO DFHEIV0
 22090     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 22091     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 22092     MOVE X'2020233030303138353033' TO DFHEIV0(25:11)
 22093     CALL 'kxdfhei1' USING DFHEIV0,
 22094           FILE-ID-ELCERT,
 22095           DFHEIV99
 22096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22097        GO TO 7399-EXIT.
 22098
 22099
 22100* EXEC CICS REWRITE
 22101*         DATASET    (FILE-ID-ELCERT)
 22102*         FROM       (CERTIFICATE-MASTER)
 22103*    END-EXEC.
 22104     MOVE LENGTH OF
 22105      CERTIFICATE-MASTER
 22106       TO DFHEIV11
 22107*    MOVE '&& L                  %   #00018508' TO DFHEIV0
 22108     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 22109     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 22110     MOVE X'2020233030303138353038' TO DFHEIV0(25:11)
 22111     CALL 'kxdfhei1' USING DFHEIV0,
 22112           FILE-ID-ELCERT,
 22113           CERTIFICATE-MASTER,
 22114           DFHEIV11,
 22115           DFHEIV99
 22116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22117
 22118
 22119 7399-EXIT.
 22120      EXIT.
 22121
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 412
* EL6311.cbl
 22123
 22124*************************************************************
 22125*                                                           *
 22126*              S E T   A T T R I B U T E S                  *
 22127*                                                           *
 22128*************************************************************
 22129
 22130 7400-SET-ATTRIBUTES.
 22131
 22132     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 22133        GO TO 7499-EXIT.
 22134
 22135**2601**
 22136
 22137     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 22138        IF PB-ISSUE
 22139           MOVE AL-UABON         TO BEFFDTA
 22140           GO TO 7499-EXIT
 22141         ELSE
 22142           MOVE AL-UABON         TO CEFFDTA
 22143           GO TO 7499-EXIT.
 22144
 22145**2604**
 22146
 22147     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 22148        IF PB-ISSUE
 22149           MOVE AL-UABON         TO BTYPE1A
 22150           MOVE -1               TO BTYPE1L
 22151           MOVE  1               TO SET-CURSOR-SW
 22152           GO TO 7499-EXIT.
 22153
 22154**2605**
 22155
 22156     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 22157        IF PB-ISSUE
 22158           MOVE AL-UABON         TO BTYPE2A
 22159           MOVE -1               TO BTYPE2L
 22160           MOVE  1               TO SET-CURSOR-SW
 22161           GO TO 7499-EXIT.
 22162
 22163**2606**
 22164
 22165     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 22166        IF PB-ISSUE
 22167           MOVE AL-UABON         TO BSIGA
 22168           MOVE -1               TO BSIGL
 22169           MOVE  1               TO SET-CURSOR-SW
 22170           GO TO 7499-EXIT.
 22171
 22172**2607**
 22173
 22174     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22175        IF PB-ISSUE
 22176           MOVE AL-UABON         TO BSIGA
 22177           MOVE -1               TO BSIGL
 22178           MOVE  1               TO SET-CURSOR-SW
 22179           GO TO 7499-EXIT.
 22180
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 413
* EL6311.cbl
 22181**2615**
 22182
 22183     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 22184        IF PB-ISSUE
 22185           MOVE AL-UABOF         TO BREINA
 22186           MOVE -1               TO BREINL
 22187           GO TO 7499-EXIT.
 22188
 22189**2622**
 22190
 22191     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 22192        IF PB-ISSUE
 22193           MOVE AL-UABON         TO BEFFDTA
 22194           GO TO 7499-EXIT
 22195        ELSE
 22196           MOVE AL-UABON         TO CEFFDTA
 22197           GO TO 7499-EXIT.
 22198
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 414
* EL6311.cbl
 22200
 22201*************************************************************
 22202*                                                           *
 22203*              I S S U E   E R R O R S                      *
 22204*                                                           *
 22205*************************************************************
 22206
 22207 7420-ISSUE-ERRORS.
 22208
 22209**2626**
 22210
 22211     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 22212        MOVE AL-UABON            TO BCERTNOA
 22213        GO TO 7499-EXIT.
 22214
 22215**2627**
 22216
 22217     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 22218        MOVE AL-UNBON            TO BAGEA
 22219        MOVE -1                  TO BAGEL
 22220        MOVE  1                  TO SET-CURSOR-SW
 22221        GO TO 7499-EXIT.
 22222
 22223**2628**
 22224
 22225     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 22226        MOVE AL-UNBON            TO BAGEA
 22227        MOVE -1                  TO BAGEL
 22228        MOVE  1                  TO SET-CURSOR-SW
 22229        GO TO 7499-EXIT.
 22230
 22231**2629**
 22232
 22233     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 22234        MOVE AL-UABON            TO BSEXA
 22235        MOVE -1                  TO BSEXL
 22236        MOVE  1                  TO SET-CURSOR-SW
 22237        GO TO 7499-EXIT.
 22238
 22239**2630**
 22240
 22241     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 22242        MOVE -1                  TO BTYPE1L
 22243        MOVE  1                  TO SET-CURSOR-SW
 22244        GO TO 7499-EXIT.
 22245
 22246**2631**
 22247
 22248     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 22249        MOVE -1                  TO BTYPE1L
 22250        MOVE  1                  TO SET-CURSOR-SW
 22251        GO TO 7499-EXIT.
 22252
 22253**2632**
 22254
 22255     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 22256        MOVE AL-UNBON            TO BBEN1A
 22257        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 415
* EL6311.cbl
 22258        MOVE  1                  TO SET-CURSOR-SW
 22259        GO TO 7499-EXIT.
 22260
 22261**2633**
 22262
 22263     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 22264        MOVE AL-UNBON            TO BPREM1A
 22265        MOVE -1                  TO BPREM1L
 22266        MOVE  1                  TO SET-CURSOR-SW
 22267        GO TO 7499-EXIT.
 22268
 22269**2634**
 22270
 22271     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 22272        MOVE -1                  TO BTYPE2L
 22273        MOVE  1                  TO SET-CURSOR-SW
 22274        GO TO 7499-EXIT.
 22275
 22276**2635**
 22277
 22278     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 22279        MOVE AL-UNBON            TO BBEN2A
 22280        MOVE -1                  TO BBEN2L
 22281        MOVE  1                  TO SET-CURSOR-SW
 22282        GO TO 7499-EXIT.
 22283
 22284**2636**
 22285
 22286     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 22287        MOVE AL-UNBON            TO BPREM2A
 22288        MOVE -1                  TO BPREM2L
 22289        MOVE  1                  TO SET-CURSOR-SW
 22290        GO TO 7499-EXIT.
 22291
 22292**2639**
 22293
 22294     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 22295        MOVE AL-UNBON            TO BBEN1A
 22296        MOVE -1                  TO BBEN1L
 22297        MOVE  1                  TO SET-CURSOR-SW
 22298        GO TO 7499-EXIT.
 22299
 22300**2640**
 22301
 22302     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 22303        MOVE AL-UNBON            TO BBEN2A
 22304        MOVE -1                  TO BBEN2L
 22305        MOVE  1                  TO SET-CURSOR-SW
 22306        GO TO 7499-EXIT.
 22307
 22308**2647**
 22309
 22310     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 22311        MOVE AL-UNBON            TO BTERM1A
 22312        MOVE -1                  TO BTERM1L
 22313        MOVE  1                  TO SET-CURSOR-SW
 22314        GO TO 7499-EXIT.
 22315
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 416
* EL6311.cbl
 22316**2648**
 22317
 22318     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 22319        MOVE AL-UNBON            TO BLNTRMA
 22320        MOVE -1                  TO BLNTRML
 22321        MOVE  1                  TO SET-CURSOR-SW
 22322        GO TO 7499-EXIT.
 22323
 22324**2649**
 22325
 22326     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22327        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22328            MOVE AL-UNBON            TO BPREM1A
 22329            MOVE -1                  TO BPREM1L
 22330            MOVE  1                  TO SET-CURSOR-SW
 22331            GO TO 7499-EXIT
 22332     ELSE
 22333        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 22334           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22335            MOVE AL-UNBON            TO BPREM2A
 22336            MOVE -1                  TO BPREM2L
 22337            MOVE  1                  TO SET-CURSOR-SW
 22338            GO TO 7499-EXIT.
 22339
 22340**2650**
 22341
 22342     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22343        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22344            MOVE AL-UNBON        TO BPREM1A
 22345            MOVE -1              TO BPREM1L
 22346            MOVE  1              TO SET-CURSOR-SW
 22347            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22348                MOVE AL-UNBON        TO BPREM2A
 22349                MOVE -1              TO BPREM2L
 22350                MOVE  1              TO SET-CURSOR-SW
 22351                GO TO 7499-EXIT
 22352            ELSE
 22353                GO TO 7499-EXIT
 22354        ELSE
 22355            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22356                MOVE AL-UNBON        TO BPREM2A
 22357                MOVE -1              TO BPREM2L
 22358                MOVE  1              TO SET-CURSOR-SW
 22359                GO TO 7499-EXIT
 22360            ELSE
 22361                GO TO 7499-EXIT.
 22362
 22363**2651**
 22364
 22365     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 22366        MOVE AL-UABON            TO BSIGA
 22367        MOVE -1                  TO BSIGL
 22368        MOVE  1                  TO SET-CURSOR-SW
 22369        GO TO 7499-EXIT.
 22370
 22371**2653**
 22372
 22373     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 417
* EL6311.cbl
 22374        MOVE AL-UABON            TO BFREQA
 22375        MOVE -1                  TO BFREQL
 22376        MOVE  1                  TO SET-CURSOR-SW
 22377        GO TO 7499-EXIT.
 22378
 22379**2654**
 22380
 22381     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 22382        MOVE AL-UABON            TO BFREQA
 22383        MOVE -1                  TO BFREQL
 22384        MOVE  1                  TO SET-CURSOR-SW
 22385        GO TO 7499-EXIT.
 22386
 22387**2655**
 22388
 22389     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 22390        MOVE AL-UABON            TO BFREQA
 22391        MOVE -1                  TO BFREQL
 22392        MOVE  1                  TO SET-CURSOR-SW
 22393        GO TO 7499-EXIT.
 22394
 22395**2656**
 22396
 22397     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 22398        MOVE AL-UNBON            TO BAPRA
 22399        MOVE -1                  TO BAPRL
 22400        MOVE  1                  TO SET-CURSOR-SW
 22401        GO TO 7499-EXIT.
 22402
 22403**2657**
 22404
 22405     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22406        MOVE AL-UNBON            TO BAPRA
 22407        MOVE -1                  TO BAPRL
 22408        MOVE  1                  TO SET-CURSOR-SW
 22409        GO TO 7499-EXIT.
 22410
 22411**2658**
 22412
 22413     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 22414        MOVE AL-UNBON            TO BTERM2A
 22415        MOVE -1                  TO BTERM2L
 22416        MOVE  1                  TO SET-CURSOR-SW
 22417        GO TO 7499-EXIT.
 22418
 22419**2660**
 22420
 22421     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 22422        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 22423        MOVE -1                  TO BLSTNML
 22424        MOVE  1                  TO SET-CURSOR-SW
 22425        GO TO 7499-EXIT.
 22426
 22427
 22428**2662**
 22429
 22430     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 22431        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 418
* EL6311.cbl
 22432        MOVE -1                  TO BAGEL
 22433        MOVE  1                  TO SET-CURSOR-SW
 22434        GO TO 7499-EXIT.
 22435
 22436**2663**
 22437
 22438     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 22439        MOVE AL-UNBON            TO BAGEA
 22440        MOVE -1                  TO BAGEL
 22441        MOVE  1                  TO SET-CURSOR-SW
 22442        GO TO 7499-EXIT.
 22443
 22444**2664**
 22445
 22446     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 22447        MOVE AL-UABON            TO BREINA
 22448        MOVE -1                  TO BREINL
 22449        MOVE  1                  TO SET-CURSOR-SW
 22450        GO TO 7499-EXIT.
 22451
 22452**2667**
 22453
 22454     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 22455        MOVE AL-UNBON            TO BBEN2A
 22456        MOVE -1                  TO BBEN2L
 22457        MOVE  1                  TO SET-CURSOR-SW
 22458        GO TO 7499-EXIT.
 22459
 22460**2668**
 22461
 22462     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 22463        MOVE AL-UABON            TO BEFFDTA
 22464        GO TO 7499-EXIT.
 22465
 22466**2669**
 22467
 22468     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 22469        MOVE AL-UNBON            TO BAGEA
 22470        MOVE -1                  TO BAGEL
 22471        MOVE  1                  TO SET-CURSOR-SW
 22472        GO TO 7499-EXIT.
 22473
 22474**2670**
 22475
 22476     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 22477        MOVE AL-UABON            TO BFORCEA
 22478        MOVE -1                  TO BFORCEL
 22479        MOVE  1                  TO SET-CURSOR-SW
 22480        GO TO 7499-EXIT.
 22481
 22482**2671**
 22483
 22484     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 22485        MOVE AL-UABON            TO BEFFDTA
 22486        GO TO 7499-EXIT.
 22487
 22488**2672**
 22489
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 419
* EL6311.cbl
 22490     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 22491        MOVE AL-UABON            TO BEFFDTA
 22492        GO TO 7499-EXIT.
 22493
 22494**2673**
 22495
 22496     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22497        MOVE AL-UABON            TO BEFFDTA
 22498        GO TO 7499-EXIT.
 22499
 22500**2674**
 22501
 22502     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 22503        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 22504        MOVE -1                  TO BTYPE1L
 22505        MOVE  1                  TO SET-CURSOR-SW
 22506        GO TO 7499-EXIT.
 22507
 22508**2677**
 22509
 22510     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 22511        MOVE AL-UNBON            TO BTERM1A
 22512        MOVE -1                  TO BTERM1L
 22513        MOVE  1                  TO SET-CURSOR-SW
 22514        GO TO 7499-EXIT.
 22515
 22516**2678**
 22517
 22518     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 22519        MOVE AL-UNBON            TO BTERM2A
 22520        MOVE -1                  TO BTERM2L
 22521        MOVE  1                  TO SET-CURSOR-SW
 22522        GO TO 7499-EXIT.
 22523
 22524**2679**
 22525
 22526     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 22527        MOVE AL-UABON            TO BTYPE1A
 22528        MOVE -1                  TO BTYPE1L
 22529        MOVE  1                  TO SET-CURSOR-SW
 22530        GO TO 7499-EXIT.
 22531
 22532**2680**
 22533
 22534     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 22535        MOVE AL-UABOF            TO B1STPMTA
 22536        MOVE -1                  TO B1STPMTL
 22537        MOVE  1                  TO SET-CURSOR-SW
 22538        GO TO 7499-EXIT.
 22539
 22540**2681**
 22541
 22542     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 22543        MOVE AL-UABON            TO BDAYSA
 22544        MOVE -1                  TO BDAYSL
 22545        MOVE  1                  TO SET-CURSOR-SW
 22546        GO TO 7499-EXIT.
 22547
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 420
* EL6311.cbl
 22548**2682**
 22549
 22550     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 22551        MOVE AL-UABON            TO BTERM1A
 22552        MOVE -1                  TO BTERM1L
 22553        MOVE  1                  TO SET-CURSOR-SW
 22554        GO TO 7499-EXIT.
 22555
 22556**2683**
 22557
 22558     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 22559        MOVE AL-UABON            TO BSKPCDA
 22560        MOVE -1                  TO BSKPCDL
 22561        MOVE  1                  TO SET-CURSOR-SW
 22562        GO TO 7499-EXIT.
 22563
 22564**2684**
 22565
 22566     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 22567        MOVE AL-UABON            TO BTYPE2A
 22568        MOVE -1                  TO BTYPE2L
 22569        MOVE  1                  TO SET-CURSOR-SW
 22570        GO TO 7499-EXIT.
 22571
 22572**2686**
 22573
 22574     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 22575        MOVE AL-UABON            TO BTYPE2A
 22576        MOVE -1                  TO BTYPE2L
 22577        MOVE  1                  TO SET-CURSOR-SW
 22578        GO TO 7499-EXIT.
 22579
 22580**2689**
 22581
 22582     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 22583        MOVE AL-UABON            TO BSIGA
 22584        MOVE -1                  TO BSIGL
 22585        MOVE  1                  TO SET-CURSOR-SW
 22586        GO TO 7499-EXIT.
 22587
 22588**2690**
 22589
 22590     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 22591        MOVE AL-UABOF            TO BLNOFCRA
 22592        MOVE -1                  TO BLNOFCRL
 22593        MOVE  1                  TO SET-CURSOR-SW
 22594        GO TO 7499-EXIT.
 22595
 22596**2693**
 22597
 22598     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 22599        MOVE AL-UABOF            TO BLNOFCRA
 22600        MOVE AL-UNBON            TO BBEN1A
 22601        MOVE -1                  TO BBEN1L
 22602        MOVE  1                  TO SET-CURSOR-SW
 22603        GO TO 7499-EXIT.
 22604
 22605**2720**
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 421
* EL6311.cbl
 22606
 22607     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 22608        MOVE AL-UNBON            TO BBEN1A
 22609        MOVE -1                  TO BBEN1L
 22610        MOVE  1                  TO SET-CURSOR-SW
 22611        GO TO 7499-EXIT.
 22612
 22613**2709**
 22614
 22615*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 22616*       MOVE AL-UNBON            TO BBEN1A
 22617*       MOVE -1                  TO BBEN1L
 22618*       MOVE  1                  TO SET-CURSOR-SW
 22619*       GO TO 7499-EXIT.
 22620
 22621*************************************************************
 22622*                                                           *
 22623*            C A N C E L   E R R O R S                      *
 22624*                                                           *
 22625*************************************************************
 22626
 22627**2726**
 22628
 22629     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 22630        MOVE AL-UABON            TO CCERTNOA
 22631        GO TO 7499-EXIT.
 22632
 22633**2728**
 22634
 22635     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 22636        MOVE AL-UABON            TO CCERTNOA
 22637        GO TO 7499-EXIT.
 22638
 22639**2729**
 22640
 22641     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 22642        MOVE AL-UABON            TO CCERTNOA
 22643        GO TO 7499-EXIT.
 22644
 22645**2730**
 22646
 22647     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 22648        MOVE AL-UABON            TO CCERTNOA
 22649        GO TO 7499-EXIT.
 22650
 22651**2731**
 22652
 22653     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 22654        MOVE AL-UABON            TO CCANDT1A
 22655        MOVE -1                  TO CCANDT1L
 22656        MOVE  1                  TO SET-CURSOR-SW
 22657        GO TO 7499-EXIT.
 22658
 22659**2732**
 22660
 22661     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
 22662        MOVE AL-UABON            TO CCANDT1A
 22663        MOVE -1                  TO CCANDT1L
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 422
* EL6311.cbl
 22664        MOVE  1                  TO SET-CURSOR-SW
 22665        GO TO 7499-EXIT.
 22666
 22667**2733**
 22668
 22669     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 22670        MOVE AL-UABON            TO CCANDT1A
 22671        MOVE -1                  TO CCANDT1L
 22672        MOVE  1                  TO SET-CURSOR-SW
 22673        GO TO 7499-EXIT.
 22674
 22675**2734**
 22676
 22677     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 22678        MOVE AL-UNBON            TO CREFND1A
 22679        MOVE -1                  TO CREFND1L
 22680        MOVE  1                  TO SET-CURSOR-SW
 22681        GO TO 7499-EXIT.
 22682
 22683**2735**
 22684
 22685     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 22686        MOVE AL-UABON            TO CCANDT2A
 22687        MOVE -1                  TO CCANDT2L
 22688        MOVE  1                  TO SET-CURSOR-SW
 22689        GO TO 7499-EXIT.
 22690
 22691**2736**
 22692
 22693     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 22694        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 22695            MOVE AL-UNBON        TO CREFND1A
 22696            MOVE -1              TO CREFND1L
 22697            MOVE  1              TO SET-CURSOR-SW
 22698            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 22699                MOVE AL-UNBON        TO CREFND2A
 22700                MOVE -1              TO CREFND2L
 22701                MOVE  1              TO SET-CURSOR-SW
 22702                GO TO 7499-EXIT
 22703            ELSE
 22704                GO TO 7499-EXIT
 22705        ELSE
 22706            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 22707                MOVE AL-UNBON        TO CREFND2A
 22708                MOVE -1              TO CREFND2L
 22709                MOVE  1              TO SET-CURSOR-SW
 22710                GO TO 7499-EXIT
 22711            ELSE
 22712                GO TO 7499-EXIT.
 22713
 22714**2738**
 22715
 22716     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 22717        MOVE -1                  TO CREFND2L
 22718        MOVE  1                  TO SET-CURSOR-SW
 22719        GO TO 7499-EXIT.
 22720
 22721**2739**
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 423
* EL6311.cbl
 22722
 22723     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 22724        MOVE -1                  TO CREFND1L
 22725        MOVE  1                  TO SET-CURSOR-SW
 22726        GO TO 7499-EXIT.
 22727
 22728**2741**
 22729
 22730     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 22731        MOVE -1                  TO CREFND1L
 22732        MOVE  1                  TO SET-CURSOR-SW
 22733        GO TO 7499-EXIT.
 22734
 22735**2743**
 22736
 22737     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 22738        MOVE AL-UNBON            TO CCANDT1A
 22739        MOVE -1                  TO CCANDT1L
 22740        MOVE  1                  TO SET-CURSOR-SW
 22741        GO TO 7499-EXIT.
 22742
 22743**2744**
 22744
 22745     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 22746        MOVE AL-UNBON            TO CCANDT2A
 22747        MOVE -1                  TO CCANDT2L
 22748        MOVE  1                  TO SET-CURSOR-SW
 22749        GO TO 7499-EXIT.
 22750
 22751**2747**
 22752
 22753     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 22754        MOVE AL-UABON            TO CLSTNMA
 22755        MOVE -1                  TO CLSTNML
 22756        MOVE  1                  TO SET-CURSOR-SW
 22757        GO TO 7499-EXIT.
 22758
 22759**2749**
 22760
 22761     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 22762        MOVE AL-UABON            TO CFORCEA
 22763        MOVE -1                  TO CFORCEL
 22764        MOVE  1                  TO SET-CURSOR-SW
 22765        GO TO 7499-EXIT.
 22766
 22767**2753**
 22768
 22769     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 22770        MOVE AL-UNBON            TO CCANDT1A
 22771        MOVE -1                  TO CCANDT1L
 22772        MOVE  1                  TO SET-CURSOR-SW
 22773        GO TO 7499-EXIT.
 22774
 22775**2755**
 22776
 22777     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
 22778        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 22779            MOVE AL-UNBON        TO CREFND1A
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 424
* EL6311.cbl
 22780            MOVE -1              TO CREFND1L
 22781            MOVE  1              TO SET-CURSOR-SW
 22782            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 22783                MOVE AL-UNBON        TO CREFND2A
 22784                MOVE -1              TO CREFND2L
 22785                MOVE  1              TO SET-CURSOR-SW
 22786                GO TO 7499-EXIT
 22787            ELSE
 22788                GO TO 7499-EXIT
 22789        ELSE
 22790            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 22791                MOVE AL-UNBON        TO CREFND2A
 22792                MOVE -1              TO CREFND2L
 22793                MOVE  1              TO SET-CURSOR-SW
 22794            ELSE
 22795                GO TO 7499-EXIT.
 22796
 22797**2757**
 22798
 22799     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 22800        MOVE AL-UNBON            TO CLIVESA
 22801        MOVE -1                  TO CLIVESL
 22802        MOVE  1                  TO SET-CURSOR-SW
 22803        GO TO 7499-EXIT.
 22804
 22805**2771**
 22806
 22807     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 22808        MOVE AL-UABON            TO CCANDT2A
 22809        MOVE -1                  TO CCANDT2L
 22810        MOVE  1                  TO SET-CURSOR-SW
 22811        GO TO 7499-EXIT.
 22812
 22813**2774**
 22814
 22815     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 22816        MOVE AL-UABON            TO CCANDT1A
 22817        MOVE -1                  TO CCANDT1L
 22818        MOVE  1                  TO SET-CURSOR-SW
 22819        GO TO 7499-EXIT.
 22820
 22821**2775**
 22822
 22823     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 22824        MOVE AL-UABON            TO CCANDT2A
 22825        MOVE -1                  TO CCANDT2L
 22826        MOVE  1                  TO SET-CURSOR-SW
 22827        GO TO 7499-EXIT.
 22828
 22829**2776**
 22830
 22831     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 22832        MOVE AL-UABON            TO CCANDT1A
 22833        MOVE -1                  TO CCANDT1L
 22834        MOVE  1                  TO SET-CURSOR-SW
 22835        GO TO 7499-EXIT.
 22836
 22837
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 425
* EL6311.cbl
 22838**2777**
 22839
 22840     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 22841        MOVE AL-UABON            TO CCANDT2A
 22842        MOVE -1                  TO CCANDT2L
 22843        MOVE  1                  TO SET-CURSOR-SW
 22844        GO TO 7499-EXIT.
 22845
 22846**2794**
 22847
 22848     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 22849        MOVE AL-UABON            TO CFORCEA
 22850        MOVE -1                  TO CFORCEL
 22851        MOVE  1                  TO SET-CURSOR-SW
 22852        GO TO 7499-EXIT.
 22853
 22854**2799**
 22855
 22856     IF PI-COMPANY-ID = 'UCL'
 22857         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 22858             MOVE AL-UNBON            TO BEFFDTA
 22859             MOVE -1                  TO BEFFDTL
 22860             MOVE  1                  TO SET-CURSOR-SW
 22861             GO TO 7499-EXIT.
 22862
 22863 7499-EXIT.
 22864      EXIT.
 22865
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 426
* EL6311.cbl
 22867
 22868 7500-READ-ERLOFC.
 22869     MOVE SPACES                 TO  WS-LOAN-OFFICER
 22870                                     ERLOFC-KEY.
 22871
 22872     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 22873
 22874     IF ST-ACCNT-CNTL
 22875         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 22876
 22877     IF CARR-GROUP-ST-ACCNT-CNTL
 22878         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 22879         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 22880         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 22881
 22882     IF CARR-ST-ACCNT-CNTL
 22883         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 22884         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 22885
 22886     IF CARR-ACCNT-CNTL
 22887         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 22888
 22889     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 22890
 22891     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 22892
 22893
 22894* EXEC CICS HANDLE CONDITION
 22895*        NOTFND   (7550-OFFICER-NOTFND)
 22896*    END-EXEC.
 22897*    MOVE '"$I                   ! Y #00019287' TO DFHEIV0
 22898     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22899     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22900     MOVE X'5920233030303139323837' TO DFHEIV0(25:11)
 22901     CALL 'kxdfhei1' USING DFHEIV0
 22902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22903
 22904
 22905
 22906* EXEC CICS READ
 22907*        DATASET   (FILE-ID-ERLOFC)
 22908*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 22909*        RIDFLD    (ERLOFC-KEY)
 22910*        EQUAL
 22911*    END-EXEC.
 22912*    MOVE '&"S        E          (   #00019291' TO DFHEIV0
 22913     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22914     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22915     MOVE X'2020233030303139323931' TO DFHEIV0(25:11)
 22916     CALL 'kxdfhei1' USING DFHEIV0,
 22917           FILE-ID-ERLOFC,
 22918           DFHEIV20,
 22919           DFHEIV99,
 22920           ERLOFC-KEY,
 22921           DFHEIV99,
 22922           DFHEIV99,
 22923           DFHEIV99
 22924     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 427
* EL6311.cbl
 22925         DFHEIV20
 22926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22927
 22928
 22929     GO TO 7599-EXIT.
 22930
 22931 7550-OFFICER-NOTFND.
 22932     MOVE 'X'                    TO WS-LOAN-OFFICER.
 22933
 22934 7599-EXIT.
 22935      EXIT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 428
* EL6311.cbl
 22937******************************************************************
 22938*                                                                *
 22939*            S  E N D    I N I T I A L   M A P                   *
 22940*                                                                *
 22941******************************************************************
 22942
 22943 8100-SEND-INITIAL-MAP.
 22944     MOVE EIBTIME                TO TIME-IN.
 22945
 22946     IF EIBAID = DFHPF11
 22947        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 22948        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 22949
 22950
 22951     IF PI-COMPANY-ID = CLIENT-GIC
 22952        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 22953                                       BCPREM-ATTRB (2).
 22954
 22955     IF PI-COMPANY-ID = (CLIENT-MIC OR
 22956                         CLIENT-PEM OR
 22957                         CLIENT-CSO)
 22958        AND PI-DISPLAY-ORIGINAL-BATCH
 22959          IF PI-MAP-NAME = EL631B
 22960             MOVE AL-SADOF               TO BPF5HDRA
 22961                                            BPF4HDRA
 22962          ELSE
 22963             IF PI-MAP-NAME = EL631C
 22964                MOVE AL-SADOF            TO CPF5HDRA
 22965                                            CPF4HDRA.
 22966
 22967     IF PI-MAP-NAME = EL631B
 22968        MOVE AL-SADOF               TO BPF5HDRA
 22969     ELSE
 22970        MOVE AL-SADOF               TO CPF5HDRA
 22971     END-IF
 22972
 22973*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 22974     IF PI-MAP-NAME = EL631B
 22975          IF PI-COMPANY-ID NOT = 'DMD'
 22976             MOVE AL-SANOF            TO BBILLEDA
 22977             MOVE AL-SADOF            TO DMDBILA.
 22978*DMD CUSTOM CODING*************END
 22979
 22980     IF PI-PROCESSOR-ID = 'LGXX'
 22981        IF PI-MAP-NAME = EL631B
 22982           MOVE AL-SABOF                    TO BREFHDGA
 22983           MOVE AL-SANOF                    TO BREFA
 22984        ELSE
 22985           IF PI-MAP-NAME = EL631C
 22986              MOVE AL-SABOF                 TO CREFHDGA
 22987              MOVE AL-SANOF                 TO CREFA.
 22988
 22989*******      ONLY SHOW CANCEL FEE FOR CLIENT ACE ON EL631C *******
 22990     IF PI-COMPANY-ID = (CLIENT-ACE OR CLIENT-LGX)
 22991        NEXT SENTENCE
 22992     ELSE
 22993        IF PI-MAP-NAME = EL631C
 22994           MOVE AL-SADOF            TO CCANTXTA
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 429
* EL6311.cbl
 22995                                       CCANFEEA.
 22996
 22997     IF PI-MAP-NAME = EL631D
 22998        IF PI-AR-PROCESSING
 22999           MOVE AL-SANOF            TO DREFHDGA
 23000        ELSE
 23001           MOVE AL-SADOF            TO DREFHDGA.
 23002
 23003     IF (PI-COMPANY-ID NOT = 'DCC')
 23004        AND (PI-MAP-NAME = EL631B)
 23005        MOVE AL-SADOF            TO BVINHA
 23006                                    BVINA
 23007     END-IF
 23008     IF PI-MAP-NAME = EL631B
 23009        IF CSR-EDIT-SESSION
 23010           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23011                                 TO BHEADO
 23012           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 23013        ELSE
 23014           MOVE AL-SADOF         TO BF15HDRA
 23015           MOVE '4=B-HDR      '  TO BPF4HDRO
 23016        END-IF
 23017        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23018        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 23019        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 23020        MOVE WS-CURRENT-DT          TO BDATEO
 23021        MOVE TIME-OUT               TO BTIMEO
 23022        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23023        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23024        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23025        IF   WS-DISPLAY-SCREEN
 23026             MOVE PB-ENTRY-BATCH    TO BBATCHO
 23027             MOVE PB-SV-CARRIER     TO BCARRO
 23028             MOVE PB-SV-GROUPING    TO BGROUPO
 23029             MOVE PB-SV-STATE       TO BSTATEO
 23030             MOVE PB-ACCOUNT        TO BACCTO
 23031        ELSE
 23032             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 23033     ELSE
 23034        IF PI-MAP-NAME = EL631C
 23035           MOVE '4=B-HDR      '     TO CPF4HDRO
 23036           IF CSR-EDIT-SESSION
 23037              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23038                                 TO CHEADO
 23039           ELSE
 23040              MOVE AL-SADOF      TO CF15HDRA
 23041           END-IF
 23042           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 23043           MOVE WS-CURRENT-DT          TO CDATEO
 23044           MOVE TIME-OUT               TO CTIMEO
 23045           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 23046           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 23047           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 23048           MOVE WS-C-HDG               TO CLFHDGO
 23049           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 23050           MOVE WS-C-HDG               TO CAHHDGO
 23051           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23052           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 430
* EL6311.cbl
 23053           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23054           IF   WS-DISPLAY-SCREEN
 23055                MOVE PB-ENTRY-BATCH    TO CBATCHO
 23056                MOVE PB-SV-CARRIER     TO CCARRO
 23057                MOVE PB-SV-GROUPING    TO CGROUPO
 23058                MOVE PB-SV-STATE       TO CSTATEO
 23059                MOVE PB-ACCOUNT        TO CACCTO
 23060           ELSE
 23061                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 23062        ELSE
 23063           MOVE WS-CURRENT-DT          TO DDATEO
 23064           MOVE TIME-OUT               TO DTIMEO
 23065           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 23066                                          WS-REFUND-HDG-OVERRIDE
 23067           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 23068           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 23069           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 23070                                          WS-REFUND-HDG-OVERRIDE
 23071           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 23072           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 23073           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 23074           IF CSR-EDIT-SESSION
 23075              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 23076                                 TO DHEADO
 23077           END-IF
 23078           IF  WS-DISPLAY-SCREEN
 23079               MOVE PB-ENTRY-BATCH     TO DBATCHO
 23080               MOVE PB-CARRIER         TO DCARRO
 23081               MOVE PB-GROUPING        TO DGROUPO
 23082               MOVE PB-STATE           TO DSTATEO
 23083               MOVE PB-ACCOUNT         TO DACCTO
 23084               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 23085           ELSE
 23086               MOVE EL631D             TO PI-MAP-NAME
 23087               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 23088               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 23089
 23090     MOVE SPACE                        TO WS-DISPLAY-SW.
 23091
 23092
 23093* EXEC CICS SEND
 23094*        MAP      (PI-MAP-NAME)
 23095*        MAPSET   (MAPSET-EL6311S)
 23096*        FROM     (EL631BI)
 23097*        ERASE
 23098*        CURSOR
 23099*    END-EXEC.
 23100     MOVE LENGTH OF
 23101      EL631BI
 23102       TO DFHEIV12
 23103     MOVE -1
 23104       TO DFHEIV11
 23105*    MOVE '8$     CT  E    H L F ,   #00019461' TO DFHEIV0
 23106     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 23107     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23108     MOVE X'2020233030303139343631' TO DFHEIV0(25:11)
 23109     CALL 'kxdfhei1' USING DFHEIV0,
 23110           PI-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 431
* EL6311.cbl
 23111           EL631BI,
 23112           DFHEIV12,
 23113           MAPSET-EL6311S,
 23114           DFHEIV99,
 23115           DFHEIV99,
 23116           DFHEIV99,
 23117           DFHEIV11,
 23118           DFHEIV99,
 23119           DFHEIV99,
 23120           DFHEIV99
 23121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23122
 23123
 23124     GO TO 9100-RETURN-TRAN.
 23125
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 432
* EL6311.cbl
 23127
 23128******************************************************************
 23129*                                                                *
 23130*              S E N D    D A T A O N L Y                        *
 23131*                                                                *
 23132******************************************************************
 23133
 23134 8200-SEND-DATAONLY.
 23135     MOVE EIBTIME                TO TIME-IN.
 23136
 23137     IF PI-COMPANY-ID = CLIENT-GIC
 23138        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 23139                                       BCPREM-ATTRB (2).
 23140
 23141     IF PI-MAP-NAME = EL631B
 23142        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 23143        MOVE WS-CURRENT-DT          TO BDATEO
 23144        MOVE TIME-OUT               TO BTIMEO
 23145        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 23146        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 23147        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 23148        MOVE SPACES                 TO BPFENTRO
 23149        MOVE AL-UANOF               TO BPFENTRA
 23150
 23151*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 23152        IF PI-COMPANY-ID NOT = 'DMD'
 23153             MOVE AL-SANOF            TO BBILLEDA
 23154             MOVE AL-SADOF            TO DMDBILA
 23155         ELSE
 23156            NEXT SENTENCE
 23157*DMD CUSTOM CODING*************END
 23158     ELSE
 23159        IF PI-MAP-NAME = EL631C
 23160           MOVE WS-CURRENT-DT          TO CDATEO
 23161           MOVE TIME-OUT               TO CTIMEO
 23162           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 23163           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 23164           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 23165           MOVE SPACES                 TO CPFENTRO
 23166           MOVE AL-UANOF               TO CPFENTRA
 23167        ELSE
 23168           MOVE WS-CURRENT-DT          TO DDATEO
 23169           MOVE TIME-OUT               TO DTIMEO
 23170           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 23171
 23172
 23173* EXEC CICS SEND
 23174*        MAP      (PI-MAP-NAME)
 23175*        MAPSET   (MAPSET-EL6311S)
 23176*        FROM     (EL631BI)
 23177*        DATAONLY
 23178*        CURSOR
 23179*    END-EXEC.
 23180     MOVE LENGTH OF
 23181      EL631BI
 23182       TO DFHEIV12
 23183     MOVE -1
 23184       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 433
* EL6311.cbl
 23185*    MOVE '8$D    CT       H L F ,   #00019517' TO DFHEIV0
 23186     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 23187     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 23188     MOVE X'2020233030303139353137' TO DFHEIV0(25:11)
 23189     CALL 'kxdfhei1' USING DFHEIV0,
 23190           PI-MAP-NAME,
 23191           EL631BI,
 23192           DFHEIV12,
 23193           MAPSET-EL6311S,
 23194           DFHEIV99,
 23195           DFHEIV99,
 23196           DFHEIV99,
 23197           DFHEIV11,
 23198           DFHEIV99,
 23199           DFHEIV99,
 23200           DFHEIV99
 23201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23202
 23203
 23204     GO TO 9100-RETURN-TRAN.
 23205
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 434
* EL6311.cbl
 23207
 23208******************************************************************
 23209*                                                                *
 23210*           U T I L I T Y   R O U T I N E S                      *
 23211*                                                                *
 23212******************************************************************
 23213
 23214 8300-SEND-TEXT.
 23215
 23216* EXEC CICS SEND TEXT
 23217*        FROM     (LOGOFF-TEXT)
 23218*        LENGTH   (LOGOFF-LENGTH)
 23219*        ERASE
 23220*        FREEKB
 23221*    END-EXEC.
 23222*    MOVE '8&      T  E F  H   F -   #00019536' TO DFHEIV0
 23223     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 23224     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 23225     MOVE X'2020233030303139353336' TO DFHEIV0(25:11)
 23226     CALL 'kxdfhei1' USING DFHEIV0,
 23227           LOGOFF-TEXT,
 23228           LOGOFF-LENGTH,
 23229           DFHEIV99,
 23230           DFHEIV99,
 23231           DFHEIV99,
 23232           DFHEIV99,
 23233           DFHEIV99,
 23234           DFHEIV99,
 23235           DFHEIV99,
 23236           DFHEIV99,
 23237           DFHEIV99,
 23238           DFHEIV99
 23239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23240
 23241
 23242
 23243* EXEC CICS RETURN
 23244*    END-EXEC.
 23245*    MOVE '.(                    ''   #00019543' TO DFHEIV0
 23246     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 23247     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23248     MOVE X'2020233030303139353433' TO DFHEIV0(25:11)
 23249     CALL 'kxdfhei1' USING DFHEIV0,
 23250           DFHEIV99,
 23251           DFHEIV99,
 23252           DFHEIV99,
 23253           DFHEIV99,
 23254           DFHEIV99,
 23255           DFHEIV99
 23256     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23257
 23258
 23259 8400-LOG-JOURNAL-RECORD.
 23260     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 23261     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 23262
 23263*    EXEC CICS JOURNAL
 23264*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 435
* EL6311.cbl
 23265*        JTYPEID     ('EL')
 23266*        FROM        (JOURNAL-RECORD)
 23267*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 23268*    END-EXEC.
 23269
 23270 8600-DEEDIT.
 23271
 23272* EXEC CICS BIF DEEDIT
 23273*         FIELD   (DEEDIT-FIELD)
 23274*         LENGTH  (15)
 23275*    END-EXEC.
 23276     MOVE 15
 23277       TO DFHEIV11
 23278*    MOVE '@"L                   #   #00019558' TO DFHEIV0
 23279     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 23280     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23281     MOVE X'2020233030303139353538' TO DFHEIV0(25:11)
 23282     CALL 'kxdfhei1' USING DFHEIV0,
 23283           DEEDIT-FIELD,
 23284           DFHEIV11
 23285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23286
 23287
 23288 8800-UNAUTHORIZED-ACCESS.
 23289     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 23290     GO TO 8300-SEND-TEXT.
 23291
 23292 8810-PF23.
 23293     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 23294     MOVE XCTL-EL005             TO PGM-NAME.
 23295     GO TO 9300-XCTL.
 23296
 23297 9100-RETURN-TRAN.
 23298     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 23299
 23300     IF  PI-MAP-NAME =  EL631B
 23301         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 23302
 23303     IF  PI-MAP-NAME =  EL631C
 23304         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 23305
 23306     IF  PI-MAP-NAME =  EL631D
 23307         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 23308
 23309
 23310* EXEC CICS RETURN
 23311*        TRANSID    (TRANS-EXB1)
 23312*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23313*        LENGTH     (1300)
 23314*    END-EXEC.
 23315     MOVE 1300
 23316       TO DFHEIV11
 23317*    MOVE '.(CT                  ''   #00019584' TO DFHEIV0
 23318     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 23319     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 23320     MOVE X'2020233030303139353834' TO DFHEIV0(25:11)
 23321     CALL 'kxdfhei1' USING DFHEIV0,
 23322           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 436
* EL6311.cbl
 23323           PROGRAM-INTERFACE-BLOCK,
 23324           DFHEIV11,
 23325           DFHEIV99,
 23326           DFHEIV99,
 23327           DFHEIV99
 23328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23329
 23330
 23331 9200-RETURN-MAIN-MENU.
 23332     MOVE XCTL-EL626             TO PGM-NAME.
 23333     GO TO 9300-XCTL.
 23334
 23335 9300-XCTL.
 23336
 23337* EXEC CICS XCTL
 23338*        PROGRAM    (PGM-NAME)
 23339*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 23340*        LENGTH     (PI-COMM-LENGTH)
 23341*    END-EXEC.
 23342*    MOVE '.$C                   %   #00019595' TO DFHEIV0
 23343     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 23344     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23345     MOVE X'2020233030303139353935' TO DFHEIV0(25:11)
 23346     CALL 'kxdfhei1' USING DFHEIV0,
 23347           PGM-NAME,
 23348           PROGRAM-INTERFACE-BLOCK,
 23349           PI-COMM-LENGTH,
 23350           DFHEIV99
 23351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23352
 23353
 23354 9400-CLEAR.
 23355     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 23356     GO TO 9300-XCTL.
 23357
 23358 9500-PF12.
 23359     MOVE XCTL-EL010             TO PGM-NAME.
 23360     GO TO 9300-XCTL.
 23361
 23362 9600-PGMID-ERROR.
 23363
 23364* EXEC CICS HANDLE CONDITION
 23365*        PGMIDERR    (8300-SEND-TEXT)
 23366*    END-EXEC.
 23367*    MOVE '"$L                   ! Z #00019610' TO DFHEIV0
 23368     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 23369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23370     MOVE X'5A20233030303139363130' TO DFHEIV0(25:11)
 23371     CALL 'kxdfhei1' USING DFHEIV0
 23372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23373
 23374
 23375     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 23376     MOVE ' '                    TO PI-ENTRY-CD-1.
 23377     MOVE XCTL-EL005             TO PGM-NAME.
 23378     MOVE PGM-NAME               TO LOGOFF-PGM.
 23379     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 23380     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 437
* EL6311.cbl
 23381
 23382 9700-DATE-LINK.
 23383     MOVE LINK-ELDATCV           TO PGM-NAME.
 23384
 23385* EXEC CICS LINK
 23386*        PROGRAM    (PGM-NAME)
 23387*        COMMAREA   (DATE-CONVERSION-DATA)
 23388*        LENGTH     (DC-COMM-LENGTH)
 23389*    END-EXEC.
 23390*    MOVE '."C                   (   #00019623' TO DFHEIV0
 23391     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23392     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23393     MOVE X'2020233030303139363233' TO DFHEIV0(25:11)
 23394     CALL 'kxdfhei1' USING DFHEIV0,
 23395           PGM-NAME,
 23396           DATE-CONVERSION-DATA,
 23397           DC-COMM-LENGTH,
 23398           DFHEIV99,
 23399           DFHEIV99,
 23400           DFHEIV99,
 23401           DFHEIV99
 23402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23403
 23404
 23405 9800-LINK-PENDING-EDIT.
 23406     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 23407     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 23408
 23409     MOVE LINK-EL050             TO PGM-NAME
 23410     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 23411     MOVE ZEROS                  TO WK-CO-MAX-CAP
 23412                                    WK-CO-TOL-CLAIM
 23413                                    WK-CO-TOL-PREM
 23414                                    WK-CO-TOL-REFUND
 23415                                    WK-CO-TOL-PREM-PCT
 23416                                    WK-CO-TOL-REFUND-PCT
 23417                                    WK-REFUND-OVS-AMT
 23418                                    WK-REFUND-OVS-PCT
 23419                                    WK-ACCT-ADDR
 23420                                    WK-LIFE-EDIT-ADDR
 23421                                    WK-AH-EDIT-ADDR
 23422                                    WK-LIFE-BEN-ADDR
 23423                                    WK-AH-BEN-ADDR
 23424                                    WK-STATE-ADDR
 23425                                    WK-PLAN-ADDR
 23426                                    WK-FORM-ADDR
 23427     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 23428
 23429     MOVE '6'                    TO WK-ENTRY-SW.
 23430
 23431     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 23432
 23433     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 23434                                    EC-AM-EXPIRATION-DT
 23435                                    EC-AM-EFFECTIVE-DT
 23436                                    EC-CM-LF-CANCEL-DT
 23437                                    EC-CM-AH-CANCEL-DT
 23438                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 438
* EL6311.cbl
 23439
 23440     MOVE ZEROS                  TO EC-CO-TOL-PREM
 23441                                    EC-CO-TOL-REFUND
 23442                                    EC-CO-MIN-AGE
 23443                                    EC-CO-MIN-PREMIUM
 23444                                    EC-CO-MIN-TERM
 23445                                    EC-CO-MAX-TERM
 23446                                    EC-ST-TOL-PREM
 23447                                    EC-ST-TOL-REFUND
 23448                                    EC-AM-LF-TOL-PREM
 23449                                    EC-AM-AH-TOL-PREM
 23450                                    EC-AM-LF-MAX-ATT-AGE
 23451                                    EC-AM-LF-MAX-AGE
 23452                                    EC-AM-LF-MAX-TERM
 23453                                    EC-AM-LF-MAX-TOT-BEN
 23454                                    EC-AM-AH-MAX-ATT-AGE
 23455                                    EC-AM-AH-MAX-AGE
 23456                                    EC-AM-AH-MAX-TERM
 23457                                    EC-AM-AH-MAX-TOT-BEN
 23458                                    EC-AM-AH-MAX-MON-BEN
 23459                                    EC-RT-LF-MAX-ATT-AGE
 23460                                    EC-RT-LF-MAX-AGE
 23461                                    EC-RT-LF-MAX-TERM
 23462                                    EC-RT-LF-MAX-TOT-BEN
 23463                                    EC-RT-AH-MAX-ATT-AGE
 23464                                    EC-RT-AH-MAX-AGE
 23465                                    EC-RT-AH-MAX-TERM
 23466                                    EC-RT-AH-MAX-TOT-BEN
 23467                                    EC-RT-AH-MAX-MON-BEN
 23468                                    EC-RT-AH-RATE
 23469                                    EC-RT-LF-RATE
 23470                                    EC-RT-LF-NSP-RATE
 23471                                    EC-RT-AH-NSP-RATE
 23472                                    EC-CM-LF-PRIOR-REFUND
 23473                                    EC-CM-AH-PRIOR-REFUND.
 23474
 23475     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 23476                                    EC-ST-TOL-PREM-PCT
 23477                                    EC-AM-LF-TOL-REFUND
 23478                                    EC-AM-LF-DEV-PERCENT
 23479                                    EC-CO-TOL-REFUND-PCT
 23480                                    EC-ST-TOL-REFUND-PCT
 23481                                    EC-AM-AH-TOL-REFUND
 23482                                    EC-AM-AH-DEV-PERCENT.
 23483
 23484
 23485* EXEC CICS LINK
 23486*         PROGRAM   (PGM-NAME)
 23487*         COMMAREA  (PASSED-RECORD)
 23488*         LENGTH    (WS-EDIT-PASS-LENGTH)
 23489*    END-EXEC.
 23490*    MOVE '."C                   (   #00019708' TO DFHEIV0
 23491     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23492     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23493     MOVE X'2020233030303139373038' TO DFHEIV0(25:11)
 23494     CALL 'kxdfhei1' USING DFHEIV0,
 23495           PGM-NAME,
 23496           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 439
* EL6311.cbl
 23497           WS-EDIT-PASS-LENGTH,
 23498           DFHEIV99,
 23499           DFHEIV99,
 23500           DFHEIV99,
 23501           DFHEIV99
 23502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23503
 23504
 23505     MOVE '1'                    TO PI-EDIT-SW.
 23506     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 23507
 23508     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 23509
 23510     IF PI-COMPANY-ID = 'UCL'
 23511         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 23512
 23513     IF VALID-PB-ID
 23514        GO TO 9800-EXIT.
 23515
 23516     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 23517
 23518     IF PI-MAP-NAME = EL631B
 23519        MOVE -1                  TO BMAINTL
 23520       ELSE
 23521        MOVE -1                  TO CMAINTL.
 23522
 23523     GO TO 8200-SEND-DATAONLY.
 23524
 23525 9800-EXIT.
 23526      EXIT.
 23527
 23528 9900-ERROR-FORMAT.
 23529
 23530     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 23531
 23532     IF NOT EMI-ERRORS-COMPLETE
 23533         MOVE LINK-EL001         TO PGM-NAME
 23534
 23535* EXEC CICS LINK
 23536*            PROGRAM    (PGM-NAME)
 23537*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 23538*            LENGTH     (EMI-COMM-LENGTH)
 23539*        END-EXEC.
 23540*    MOVE '."C                   (   #00019743' TO DFHEIV0
 23541     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23542     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23543     MOVE X'2020233030303139373433' TO DFHEIV0(25:11)
 23544     CALL 'kxdfhei1' USING DFHEIV0,
 23545           PGM-NAME,
 23546           ERROR-MESSAGE-INTERFACE-BLOCK,
 23547           EMI-COMM-LENGTH,
 23548           DFHEIV99,
 23549           DFHEIV99,
 23550           DFHEIV99,
 23551           DFHEIV99
 23552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23553
 23554
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 440
* EL6311.cbl
 23555 9900-EXIT.
 23556     EXIT.
 23557
 23558 9990-ABEND.
 23559     MOVE LINK-EL004             TO PGM-NAME.
 23560     MOVE DFHEIBLK               TO EMI-LINE1.
 23561
 23562* EXEC CICS LINK
 23563*        PROGRAM   (PGM-NAME)
 23564*        COMMAREA  (EMI-LINE1)
 23565*        LENGTH    (72)
 23566*    END-EXEC.
 23567     MOVE 72
 23568       TO DFHEIV11
 23569*    MOVE '."C                   (   #00019755' TO DFHEIV0
 23570     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23571     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23572     MOVE X'2020233030303139373535' TO DFHEIV0(25:11)
 23573     CALL 'kxdfhei1' USING DFHEIV0,
 23574           PGM-NAME,
 23575           EMI-LINE1,
 23576           DFHEIV11,
 23577           DFHEIV99,
 23578           DFHEIV99,
 23579           DFHEIV99,
 23580           DFHEIV99
 23581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23582
 23583
 23584     IF PI-MAP-NAME = EL631B
 23585        MOVE -1                  TO BMAINTL
 23586       ELSE
 23587        MOVE -1                  TO CMAINTL.
 23588
 23589     IF EIBTRNID NOT = TRANS-EXB1
 23590        GO TO 8100-SEND-INITIAL-MAP
 23591       ELSE
 23592        GO TO 8200-SEND-DATAONLY.
 23593
 23594 9995-SECURITY-VIOLATION.
 23595*                            COPY ELCSCTP.
 23596******************************************************************
 23597*                                                                *
 23598*                            ELCSCTP                             *
 23599*                            VMOD=2.001                          *
 23600*                                                                *
 23601*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 23602******************************************************************
 23603
 23604
 23605     MOVE EIBDATE          TO SM-JUL-DATE.
 23606     MOVE EIBTRMID         TO SM-TERMID.
 23607     MOVE THIS-PGM         TO SM-PGM.
 23608     MOVE EIBTIME          TO TIME-IN.
 23609     MOVE TIME-OUT         TO SM-TIME.
 23610     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 23611
 23612
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 441
* EL6311.cbl
 23613* EXEC CICS LINK
 23614*         PROGRAM  ('EL003')
 23615*         COMMAREA (SECURITY-MESSAGE)
 23616*         LENGTH   (80)
 23617*    END-EXEC.
 23618     MOVE 'EL003' TO DFHEIV1
 23619     MOVE 80
 23620       TO DFHEIV11
 23621*    MOVE '."C                   (   #00019789' TO DFHEIV0
 23622     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 23623     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23624     MOVE X'2020233030303139373839' TO DFHEIV0(25:11)
 23625     CALL 'kxdfhei1' USING DFHEIV0,
 23626           DFHEIV1,
 23627           SECURITY-MESSAGE,
 23628           DFHEIV11,
 23629           DFHEIV99,
 23630           DFHEIV99,
 23631           DFHEIV99,
 23632           DFHEIV99
 23633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23634
 23635
 23636******************************************************************
 23637
 23638
 23639 9999-DFHBACK SECTION.
 23640     MOVE '9%                    "   ' TO DFHEIV0
 23641     MOVE 'EL6311' TO DFHEIV1
 23642     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23643     GOBACK.
 23644 9999-DFHEXIT.
 23645     IF DFHEIGDJ EQUAL 0001
 23646         NEXT SENTENCE
 23647     ELSE IF DFHEIGDJ EQUAL 2
 23648         GO TO 9600-PGMID-ERROR,
 23649               9990-ABEND,
 23650               9990-ABEND,
 23651               0010-MAIN-LOGIC
 23652         DEPENDING ON DFHEIGDI
 23653     ELSE IF DFHEIGDJ EQUAL 3
 23654         GO TO 1280-BATCH-HDR-NOT-FOUND
 23655         DEPENDING ON DFHEIGDI
 23656     ELSE IF DFHEIGDJ EQUAL 4
 23657         GO TO 1290-DUPLICATE-ALT-INDEX
 23658         DEPENDING ON DFHEIGDI
 23659     ELSE IF DFHEIGDJ EQUAL 5
 23660         GO TO 1380-BATCH-HDR-NOT-FOUND
 23661         DEPENDING ON DFHEIGDI
 23662     ELSE IF DFHEIGDJ EQUAL 6
 23663         GO TO 1385-REC-NOT-FOUND
 23664         DEPENDING ON DFHEIGDI
 23665     ELSE IF DFHEIGDJ EQUAL 7
 23666         GO TO 1399-EXIT
 23667         DEPENDING ON DFHEIGDI
 23668     ELSE IF DFHEIGDJ EQUAL 8
 23669         GO TO 1480-BATCH-HDR-NOT-FOUND
 23670         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 442
* EL6311.cbl
 23671     ELSE IF DFHEIGDJ EQUAL 9
 23672         GO TO 1490-RECORD-NOT-FOUND
 23673         DEPENDING ON DFHEIGDI
 23674     ELSE IF DFHEIGDJ EQUAL 10
 23675         GO TO 1405-DELETE-CERTIFICATE
 23676         DEPENDING ON DFHEIGDI
 23677     ELSE IF DFHEIGDJ EQUAL 11
 23678         GO TO 1420-CONTINUE-DELETE
 23679         DEPENDING ON DFHEIGDI
 23680     ELSE IF DFHEIGDJ EQUAL 12
 23681         GO TO 1406-DELETE-ERNOTE
 23682         DEPENDING ON DFHEIGDI
 23683     ELSE IF DFHEIGDJ EQUAL 13
 23684         GO TO 1407-DELETE-MAILING
 23685         DEPENDING ON DFHEIGDI
 23686     ELSE IF DFHEIGDJ EQUAL 14
 23687         GO TO 1420-CONTINUE-DELETE
 23688         DEPENDING ON DFHEIGDI
 23689     ELSE IF DFHEIGDJ EQUAL 15
 23690         GO TO 1480-BATCH-HDR-NOT-FOUND
 23691         DEPENDING ON DFHEIGDI
 23692     ELSE IF DFHEIGDJ EQUAL 16
 23693         GO TO 1475-DELETE-FINISHED
 23694         DEPENDING ON DFHEIGDI
 23695     ELSE IF DFHEIGDJ EQUAL 17
 23696         GO TO 2280-BATCH-HDR-NOT-FOUND
 23697         DEPENDING ON DFHEIGDI
 23698     ELSE IF DFHEIGDJ EQUAL 18
 23699         GO TO 2290-DUPLICATE-ALT-INDEX
 23700         DEPENDING ON DFHEIGDI
 23701     ELSE IF DFHEIGDJ EQUAL 19
 23702         GO TO 2380-BATCH-HDR-NOT-FOUND
 23703         DEPENDING ON DFHEIGDI
 23704     ELSE IF DFHEIGDJ EQUAL 20
 23705         GO TO 2385-REC-NOT-FOUND
 23706         DEPENDING ON DFHEIGDI
 23707     ELSE IF DFHEIGDJ EQUAL 21
 23708         GO TO 2380-BATCH-HDR-NOT-FOUND
 23709         DEPENDING ON DFHEIGDI
 23710     ELSE IF DFHEIGDJ EQUAL 22
 23711         GO TO 2485-BATCH-HDR-NOT-FOUND
 23712         DEPENDING ON DFHEIGDI
 23713     ELSE IF DFHEIGDJ EQUAL 23
 23714         GO TO 2490-RECORD-NOT-FOUND
 23715         DEPENDING ON DFHEIGDI
 23716     ELSE IF DFHEIGDJ EQUAL 24
 23717         GO TO 2475-CONTINUE-DELETE
 23718         DEPENDING ON DFHEIGDI
 23719     ELSE IF DFHEIGDJ EQUAL 25
 23720         GO TO 2485-BATCH-HDR-NOT-FOUND
 23721         DEPENDING ON DFHEIGDI
 23722     ELSE IF DFHEIGDJ EQUAL 26
 23723         GO TO 2480-DELETE-FINISHED
 23724         DEPENDING ON DFHEIGDI
 23725     ELSE IF DFHEIGDJ EQUAL 27
 23726         GO TO 2820-PROCESS-REWRITE
 23727         DEPENDING ON DFHEIGDI
 23728     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 443
* EL6311.cbl
 23729         GO TO 2885-RECORD-MISSING
 23730         DEPENDING ON DFHEIGDI
 23731     ELSE IF DFHEIGDJ EQUAL 29
 23732         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 23733         DEPENDING ON DFHEIGDI
 23734     ELSE IF DFHEIGDJ EQUAL 30
 23735         GO TO 2827-DELETE-MAILING
 23736         DEPENDING ON DFHEIGDI
 23737     ELSE IF DFHEIGDJ EQUAL 31
 23738         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 23739         DEPENDING ON DFHEIGDI
 23740     ELSE IF DFHEIGDJ EQUAL 32
 23741         GO TO 2920-PROCESS-REWRITE
 23742         DEPENDING ON DFHEIGDI
 23743     ELSE IF DFHEIGDJ EQUAL 33
 23744         GO TO 2985-RECORD-MISSING
 23745         DEPENDING ON DFHEIGDI
 23746     ELSE IF DFHEIGDJ EQUAL 34
 23747         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 23748         DEPENDING ON DFHEIGDI
 23749     ELSE IF DFHEIGDJ EQUAL 35
 23750         GO TO 2990-DUPLICATE-RECORD
 23751         DEPENDING ON DFHEIGDI
 23752     ELSE IF DFHEIGDJ EQUAL 36
 23753         GO TO 3590-NOT-FOUND
 23754         DEPENDING ON DFHEIGDI
 23755     ELSE IF DFHEIGDJ EQUAL 37
 23756         GO TO 3690-NOT-FOUND
 23757         DEPENDING ON DFHEIGDI
 23758     ELSE IF DFHEIGDJ EQUAL 38
 23759         GO TO 3990-NOT-FOUND
 23760         DEPENDING ON DFHEIGDI
 23761     ELSE IF DFHEIGDJ EQUAL 39
 23762         GO TO 4050-END-RECORDS,
 23763               4050-END-RECORDS
 23764         DEPENDING ON DFHEIGDI
 23765     ELSE IF DFHEIGDJ EQUAL 40
 23766         GO TO 4150-END-BATCH
 23767         DEPENDING ON DFHEIGDI
 23768     ELSE IF DFHEIGDJ EQUAL 41
 23769         GO TO 4150-END-BATCH
 23770         DEPENDING ON DFHEIGDI
 23771     ELSE IF DFHEIGDJ EQUAL 42
 23772         GO TO 4250-END-RECORDS,
 23773               4250-END-RECORDS
 23774         DEPENDING ON DFHEIGDI
 23775     ELSE IF DFHEIGDJ EQUAL 43
 23776         GO TO 4350-END-BATCH,
 23777               4350-END-BATCH
 23778         DEPENDING ON DFHEIGDI
 23779     ELSE IF DFHEIGDJ EQUAL 44
 23780         GO TO 4570-NOT-FOUND,
 23781               4550-END-RECORDS
 23782         DEPENDING ON DFHEIGDI
 23783     ELSE IF DFHEIGDJ EQUAL 45
 23784         GO TO 4680-NOT-FOUND,
 23785               4680-NOT-FOUND
 23786         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 08-Dec-12 12:03 Page 444
* EL6311.cbl
 23787     ELSE IF DFHEIGDJ EQUAL 46
 23788         GO TO 4860-NOT-FOUND,
 23789               4850-END-RECORDS
 23790         DEPENDING ON DFHEIGDI
 23791     ELSE IF DFHEIGDJ EQUAL 47
 23792         GO TO 4970-NOT-FOUND,
 23793               4950-END-RECORDS
 23794         DEPENDING ON DFHEIGDI
 23795     ELSE IF DFHEIGDJ EQUAL 48
 23796         GO TO 5050-NOT-FOUND
 23797         DEPENDING ON DFHEIGDI
 23798     ELSE IF DFHEIGDJ EQUAL 49
 23799         GO TO 5050-NOT-FOUND
 23800         DEPENDING ON DFHEIGDI
 23801     ELSE IF DFHEIGDJ EQUAL 50
 23802         GO TO 5050-NOT-FOUND
 23803         DEPENDING ON DFHEIGDI
 23804     ELSE IF DFHEIGDJ EQUAL 51
 23805         GO TO 5550-END-RECORDS,
 23806               5550-END-RECORDS
 23807         DEPENDING ON DFHEIGDI
 23808     ELSE IF DFHEIGDJ EQUAL 52
 23809         GO TO 6050-QID-ERROR
 23810         DEPENDING ON DFHEIGDI
 23811     ELSE IF DFHEIGDJ EQUAL 53
 23812         GO TO 6050-QID-ERROR
 23813         DEPENDING ON DFHEIGDI
 23814     ELSE IF DFHEIGDJ EQUAL 54
 23815         GO TO 6400-CONTINUE,
 23816               6400-CONTINUE
 23817         DEPENDING ON DFHEIGDI
 23818     ELSE IF DFHEIGDJ EQUAL 55
 23819         GO TO 3690-NOT-FOUND
 23820         DEPENDING ON DFHEIGDI
 23821     ELSE IF DFHEIGDJ EQUAL 56
 23822         GO TO 7399-EXIT
 23823         DEPENDING ON DFHEIGDI
 23824     ELSE IF DFHEIGDJ EQUAL 57
 23825         GO TO 7550-OFFICER-NOTFND
 23826         DEPENDING ON DFHEIGDI
 23827     ELSE IF DFHEIGDJ EQUAL 58
 23828         GO TO 8300-SEND-TEXT
 23829         DEPENDING ON DFHEIGDI.
 23830     MOVE '9%                    "   ' TO DFHEIV0
 23831     MOVE 'EL6311' TO DFHEIV1
 23832     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 23833     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       14668     Code:       94777
