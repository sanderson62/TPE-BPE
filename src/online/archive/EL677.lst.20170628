* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   1
* EL677.cbl
* Options: int("EL677.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL677.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL677.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL677.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.
     3
     4 PROGRAM-ID.                 EL677.
     5*
     6*AUTHOR.     CSO
     7*            OMAHA, NEBRASKA.
     8
     9*DATE-COMPILED.
    10
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   2
* EL677.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*                                                                *
    17*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXF3 - CHECK MAINTENANCE
    23******************************************************************
    24*                   C H A N G E   L O G
    25*
    26* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    27*-----------------------------------------------------------------
    28*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    29* EFFECTIVE    NUMBER
    30*-----------------------------------------------------------------
    31* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    32* 021714  CR2014021700001  PEMA  ADD TEST DB FOR OTHER THAN cid1p
    33* 030414  IR2014030400001  PEMA  CHG PYAJ VOID TRANS TO R AND +
    34* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    35* 091615  CR2015082000001  PEMA  ADD TOTAL ENDT PROCESSING
    36* 020317  IR2016110900001  PEMA  FIXED MISC PROBLEMS
    37******************************************************************
    38 ENVIRONMENT DIVISION.
    39
    40 DATA DIVISION.
    41 WORKING-STORAGE SECTION.
    42 01  DFH-START PIC X(04).
    43 77  FILLER  PIC X(32)  VALUE '********************************'.
    44 77  FILLER  PIC X(32)  VALUE '*    EL677 WORKING STORAGE     *'.
    45 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    46 77  s1                          pic s999 comp-3 value +0.
    47 77  s2                          pic s999 comp-3 value +0.
    48 77  ws-display-amt              pic 9(9).99-.
    49 77  ws-tot-lf-prem              pic s9(7)v99 comp-3 value +0.
    50 77  ws-tot-iss-prem             pic s9(7)v99 comp-3 value +0.
    51 77  ws-tot-iss-comm             pic s9(7)v99 comp-3 value +0.
    52 77  ws-tot-ref-comm             pic s9(7)v99 comp-3 value +0.
    53 77  ws-browse-sw                pic x value spaces.
    54     88  i-say-when                 value 'Y'.
    55 77  ws-delete-sw                pic x value ' '.
    56     88  row-deleted                 value 'Y'.
    57 77  ws-sql-code                 pic s9(7) value zeros.
    58 77  ws-dis-sql-code             pic -9999999 value zeros.
    59 77  ws-match-sw                 pic x  value ' '.
    60     88  found-a-match             value 'Y'.
    61 77  ws-commit-sw                pic x value ' '.
    62     88  tbl-commited                value 'Y'.
    63 01  P pointer.
    64 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    65 01  var-ptr pointer.
    66 01  env-var-len                 pic 9(4)  binary.
    67 01  rc                          pic 9(9)  binary.
    68
    69 01  WS-KIXSYS.
    70     05  WS-KIX-FIL1             PIC X(10).
    71     05  WS-KIX-APPS             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   3
* EL677.cbl
    72     05  WS-KIX-ENV              PIC X(10).
    73     05  WS-KIX-MYENV            PIC X(10).
    74     05  WS-KIX-SYS              PIC X(10).
*   75 EXEC SQL
*   76    INCLUDE SQLDA
*   77 END-EXEC
    78 01 SQLDA sync.
    79    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    80    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    81    05 SQLN                  PIC S9(4) COMP-5 value 0.
    82    05 SQLD                  PIC S9(4) COMP-5 value 0.
    83    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
    84       10 SQLTYPE            PIC S9(4) COMP-5.
    85       10 SQLLEN             PIC S9(4) COMP-5.
    86$IF P64 SET
    87X      *> For 64-bit environments, ensure that SQLDATA is
    88X      *> aligned on an 8-byte boundary.
    89X      10 FILLER             PIC S9(9) COMP-5.
    90$END
    91       10 SQLDATA            USAGE POINTER.
    92       10 SQLIND             USAGE POINTER.
    93       10 SQLNAME.
    94          15 SQLNAMEL        PIC S9(4) COMP-5.
    95          15 SQLNAMEC        PIC X(30).
    96
    97* Values for SQLTYPE
    98
    99 78  ESQL-DATE-CHAR              VALUE 384.
   100 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   101 78  ESQL-DATE-REC               VALUE 386.
   102 78  ESQL-DATE-REC-NULL          VALUE 387.
   103 78  ESQL-TIME-CHAR              VALUE 388.
   104 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   105 78  ESQL-TIME-REC               VALUE 390.
   106 78  ESQL-TIME-REC-NULL          VALUE 391.
   107 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   108 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   109 78  ESQL-TIMESTAMP-REC          VALUE 394.
   110 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   111 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   112 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   113 78  ESQL-TS-OFFSET-REC          VALUE 398.
   114 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   115 78  ESQL-LONGVARBINARY          VALUE 404.
   116 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   117 78  ESQL-LONGVARCHAR            VALUE 408.
   118 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   119 78  ESQL-BINARY                 VALUE 444.
   120 78  ESQL-BINARY-NULL            VALUE 445.
   121 78  ESQL-VARBINARY              VALUE 446.
   122 78  ESQL-VARBINARY-NULL         VALUE 447.
   123 78  ESQL-VARCHAR                VALUE 448.
   124 78  ESQL-VARCHAR-NULL           VALUE 449.
   125
   126 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   127 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   128
   129 78  ESQL-CHAR                   VALUE 452.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   4
* EL677.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-CHAR-NULL              VALUE 453.
   131
   132 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   133 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   134
   135 78  ESQL-DOUBLE                 VALUE 480.
   136 78  ESQL-DOUBLE-NULL            VALUE 481.
   137 78  ESQL-REAL                   VALUE 482.
   138 78  ESQL-REAL-NULL              VALUE 483.
   139 78  ESQL-DECIMAL                VALUE 484.
   140 78  ESQL-DECIMAL-NULL           VALUE 485.
   141 78  ESQL-INTEGER                VALUE 496.
   142 78  ESQL-INTEGER-NULL           VALUE 497.
   143 78  ESQL-SMALLINT               VALUE 500.
   144 78  ESQL-SMALLINT-NULL          VALUE 501.
   145 78  ESQL-TINYINT                VALUE 502.
   146 78  ESQL-TINYINT-NULL           VALUE 503.
*  147 EXEC SQL
*  148    INCLUDE SQLCA
*  149 END-EXEC
   150 01 SQLCA.
   151     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   152     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   153     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   154     05  SQLERRM.
   155         49  SQLERRML    PIC S9(4) COMP-5.
   156         49  SQLERRMC    PIC X(70).
   157     05  SQLERRP         PIC X(8).
   158     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   159     05  SQLWARN.
   160         10  SQLWARN0    PIC X.
   161         10  SQLWARN1    PIC X.
   162         10  SQLWARN2    PIC X.
   163         10  SQLWARN3    PIC X.
   164         10  SQLWARN4    PIC X.
   165         10  SQLWARN5    PIC X.
   166         10  SQLWARN6    PIC X.
   167         10  SQLWARN7    PIC X.
   168     05  SQLEXT.
   169         10  SQLWARN8    PIC X.
   170         10  SQLWARN9    PIC X.
   171         10  SQLWARN10   PIC X.
   172         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   173     05  SQLSTATE    PIC X(5).
   174 EXEC SQL
   175    BEGIN DECLARE SECTION
   176 END-EXEC
   177 01  ws-paid-bank-work-area.
   178     05  ws-pb-compid            pic x(9).
   179     05  ws-pb-check-no          pic x(10).
   180     05  ws-pb-bad-check-no      pic x(10).
   181     05  ws-check-amount         pic x(10).
   182 01  Paid-Bank-Info.
   183     05  pb-check-no             pic 9(10).
   184     05  pb-tran-type            pic x.
   185     05  pb-bank-acct-desc       pic x(50).
   186     05  pb-amount               pic x(12).
   187     05  pb-paid-date            pic x(25).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   5
* EL677.cbl
   188 01  ws-key-stuff.
   189     05  ws-compid               pic xxx.
   190     05  ws-carrier              pic x.
   191     05  ws-grouping             pic x(6).
   192     05  ws-state                pic xx.
   193     05  ws-account              pic x(10).
   194     05  ws-eff-date             pic x(10).
   195     05  ws-certificate          pic x(10).
   196     05  ws-cert-sfx             pic x.
   197     05  ws-seq-no               pic 999.
   198     05  ws-type                 pic x.
   199     05  ws-check-sub-type       pic x.
   200 01  sqlcmd                      pic x(1024).
   201 01  WS-MOE-DATE                 pic x(10).
   202 01  svr                         pic x(32).
   203 01  usr                         pic x(32).
   204 01  pass                        pic x(32).
   205 01  usr-pass                    pic x(64).
   206 01  ws-disp-code                pic s9(11).
   207***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
   208***                                                            ***
   209***  These indicators are used to determine if a variable      ***
   210***  is passed nulls from sql. The indicator will be -1        ***
   211***  if the value on sql is nulls and +0 if the value is       ***
   212***  something other than nulls. Here is an example on how     ***
   213***  to use the indicator variables.                           ***
   214***                                                            ***
   215***     EXEC SQL                                               ***
   216***        fetch checkapp into                                 ***
   217***           :db-app-status :nu-app-status,                   ***
   218***           :db-app-by     :nu-app-by,                       ***
   219***           :db-app-date   :nu-app-date,                     ***
   220***           :db-app-batch  :nu-app-batch                     ***
   221***     END-EXEC                                               ***
   222***                                                            ***
   223***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
   224 01  indicator-vaiables-for-nulls.
   225     05  nu-app-status           pic s9(4) comp value +0.
   226     05  nu-app-by               pic s9(4) comp value +0.
   227     05  nu-app-date             pic s9(4) comp value +0.
   228     05  nu-app-batch            pic s9(4) comp value +0.
   229     05  nu-fincar               pic s9(4) comp value +0.
   230 01  daily-check-request-rec.
   231     05  db-compid               pic xxx.
   232     05  db-carrier              pic x.
   233     05  db-grouping             pic x(6).
   234     05  db-state                pic xx.
   235     05  db-account              pic x(10).
   236     05  db-effdate              pic x(10).
   237     05  db-certificate          pic x(10).
   238     05  db-cert-sfx             pic x.
   239     05  db-seq-no               pic 999.
   240     05  db-type                 pic x.
   241     05  db-amount-n             pic 9(7).99.
   242     05  db-amount redefines db-amount-n
   243                                 pic x(10).
   244     05  db-checkno              pic x(15).
   245     05  db-checkdate            pic x(10).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   6
* EL677.cbl
   246     05  db-checkstatus          pic 9(5).
   247     05  db-releasebatch         pic 9(5).
   248     05  db-releasedt            pic x(10).
   249     05  db-releaseby            pic x(4).
   250     05  db-payeename1           pic x(30).
   251     05  db-payeename2           pic x(30).
   252     05  db-payeeaddr1           pic x(30).
   253     05  db-payeeaddr2           pic x(30).
   254     05  db-payeecity            pic x(30).
   255     05  db-payeest              pic xx.
   256     05  db-payeezip             pic x(10).
   257     05  db-fincar               pic x.
   258     05  db-fingrp               pic x(6).
   259     05  db-finresp              pic x(10).
   260     05  db-finacct              pic x(10).
   261     05  db-preparer             pic x(4).
   262     05  db-app-status           pic x(9).
   263     05  dp-app-status-n redefines db-app-status
   264                                 pic 9(9).
   265     05  db-app-by               pic x(20).
   266     05  db-app-date             pic x(30).
   267     05  db-app-batch            pic x(10).
   268     05  db-return-to            pic x(30).
   269     05  db-insured-name         pic x(30).
   270     05  db-check-sub-type       pic x.
   271 EXEC SQL
   272    END DECLARE SECTION
   273 END-EXEC
   274*                            COPY ELCSCTM.
   275******************************************************************
   276*                                                                *
   277*                                                                *
   278*                            ELCSCTM                             *
   279*                            VMOD=2.001                          *
   280*                                                                *
   281*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   282*                                                                *
   283******************************************************************
   284 01  SECURITY-MESSAGE.
   285     12  FILLER                          PIC X(30)
   286            VALUE '** LOGIC SECURITY VIOLATION -'.
   287     12  SM-READ                         PIC X(6).
   288     12  FILLER                          PIC X(5)
   289            VALUE ' PGM='.
   290     12  SM-PGM                          PIC X(6).
   291     12  FILLER                          PIC X(5)
   292            VALUE ' OPR='.
   293     12  SM-PROCESSOR-ID                 PIC X(4).
   294     12  FILLER                          PIC X(6)
   295            VALUE ' TERM='.
   296     12  SM-TERMID                       PIC X(4).
   297     12  FILLER                          PIC XX   VALUE SPACE.
   298     12  SM-JUL-DATE                     PIC 9(5).
   299     12  FILLER                          PIC X    VALUE SPACE.
   300     12  SM-TIME                         PIC 99.99.
   301
   302*                            COPY ELCSCRTY.
   303******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   7
* EL677.cbl
   304*                                                                *
   305*                                                                *
   306*                            ELCSCRTY                            *
   307*                            VMOD=2.001                          *
   308*                                                                *
   309*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   310*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   311*        SAVED IN PI-SECURITY-ADDRESS.                           *
   312*                                                                *
   313******************************************************************
   314 01  SECURITY-CONTROL.
   315     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   316     12  FILLER                       PIC XX    VALUE 'SC'.
   317     12  SC-CREDIT-CODES.
   318         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   319             20  SC-CREDIT-DISPLAY    PIC X.
   320             20  SC-CREDIT-UPDATE     PIC X.
   321     12  SC-CLAIMS-CODES.
   322         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   323             20  SC-CLAIMS-DISPLAY    PIC X.
   324             20  SC-CLAIMS-UPDATE     PIC X.
   325 01  ws-dummy-erchek             pic x(600).
   326 01  filler.
   327     05  WS-CHECK-AMT-TMP        PIC Z(7).99.
   328     05  WS-CHECK-AMT-TMPX REDEFINES
   329         WS-CHECK-AMT-TMP        PIC X(10).
   330     05  ws-ind                     pic s9(4) comp value +0.
   331     05  ws-ind-red redefines ws-ind pic xx.
   332     05  ws-display-ind             pic s9(7) value zeros.
   333 01  ws-compare-erchek-key          pic x(33) value low-values.
   334 01  ws-eracct-sw                   pic x value ' '.
   335     88  eracct-found                 value 'Y'.
   336 01  ws-eracct-start-sw             pic x value ' '.
   337     88  eracct-start                 value 'Y'.
   338 01  WS-MISC-AREA.
   339     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   340     05  SAVE-CURRENT-DATE-MDY       PIC X(6)    VALUE SPACES.
   341     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   342
   343 01  ws-work-amt-alpha           pic x(10).
   344 01  ws-work-amt-num redefines ws-work-amt-alpha
   345                                 pic 9(8)v99.
   346 01  ws-user-defined.
   347     05  ws-user-reason         pic xxx.
   348     05  ws-user-cert-no        pic x(11).
   349     05  ws-user-name           pic x(28).
   350 01  ws-hold-eracct-record       pic x(2000)  value spaces.
   351 01  STANDARD-AREAS.
   352     12  ws-connect-sw               pic x  value ' '.
   353         88  connected-to-db             value 'Y'.
   354     12  SC-ITEM                     PIC S9(4) COMP VALUE +1.
   355     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   356     12  EL677A                      PIC X(8)    VALUE 'EL677A'.
   357     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL677S'.
   358     12  SCREEN-NUMBER               PIC X(4)    VALUE '677A'.
   359     12  TRANS-ID                    PIC X(4)    VALUE 'EXF3'.
   360     12  EL6311-TRANS-ID             PIC X(4)    VALUE 'EXB1'.
   361     12  EL6318-TRANS-ID             PIC X(4)    VALUE 'EXBE'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   8
* EL677.cbl
   362     12  EL1273-TRANS-ID             PIC X(4)    VALUE 'EXX3'.
   363     12  THIS-PGM                    PIC X(8)    VALUE 'EL677'.
   364     12  PGM-NAME                    PIC X(8)   VALUE SPACES.
   365     12  TIME-IN                     PIC S9(7)  VALUE ZEROS.
   366     12  TIME-OUT-R  REDEFINES TIME-IN.
   367         16  FILLER                  PIC X.
   368         16  TIME-OUT                PIC 99V99.
   369         16  FILLER                  PIC XX.
   370     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   371     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   372     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   373     12  XCTL-1273                   PIC X(8)    VALUE 'EL1273'.
   374     12  XCTL-114                    PIC X(8)    VALUE 'EL114'.
   375     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   376     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   377     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   378     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
   379     12  ERACCT-FILE-ID              PIC X(8)    VALUE 'ERACCT'.
   380     12  ERCOMP-FILE-ID              PIC X(8)    VALUE 'ERCOMP'.
   381     12  ERCHEK-FILE-ID              PIC X(8)    VALUE 'ERCHEK'.
   382     12  ERPNDB-FILE-ID              PIC X(8)    VALUE 'ERPNDB'.
   383     12  ERPNDB-ALT-FILE-ID          PIC X(8)    VALUE 'ERPNDB2'.
   384     12  ELCERT-FILE-ID              PIC X(8)    VALUE 'ELCERT'.
   385     12  ERMAIL-FILE-ID              PIC X(8)    VALUE 'ERMAIL'.
   386     12  ERPNDM-FILE-ID              PIC X(8)    VALUE 'ERPNDM'.
   387     12  ERPYAJ-FILE-ID              PIC X(8)    VALUE 'ERPYAJ'.
   388     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +0    COMP.
   389     12  WS-KEY-LENGTH               PIC S9(4)   VALUE +28   COMP.
   390     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
   391     12  QID.
   392         16  QID-TERM                PIC X(4)    VALUE SPACES.
   393         16  FILLER                  PIC X(4)    VALUE '677A'.
   394
   395 01  WORK-AREAS.
   396     12  WS-AM-WORK                  PIC S9(8)V99 VALUE +0.
   397     12  WS-AM-WK REDEFINES WS-AM-WORK.
   398         16  WS-AM-NUM               PIC S9(7)V99.
   399         16  WS-AM-SIGN              PIC X.
   400     12  WS-CHECK-WORK.
   401         16  FILLER                  PIC X        VALUE SPACE.
   402         16  WS-CHECK-NO             PIC X(6)     VALUE SPACES.
   403     12  WS-CHK-PRINT-DT             PIC XX       VALUE LOW-VALUE.
   404     12  WS-SV-AMOUNT-PAID           PIC S9(7)V99 VALUE +0.
   405     12  WS-AMT                      PIC S9(7)V99 VALUE +0.
   406     12  WS-AMT-PAID                 PIC S9(7)V99 VALUE +0.
   407     12  WS-REFUND-AMOUNT            PIC S9(7)V99 VALUE +0.
   408     12  WS-SV-CARRIER               PIC X       VALUE SPACES.
   409     12  WS-SV-GROUPING              PIC X(6)    VALUE SPACES.
   410     12  WS-SV-STATE                 PIC XX      VALUE SPACES.
   411     12  WS-DEEDIT-FIELD             PIC S9(9)V99 VALUE +0.
   412     12  WS-DT-DEEDIT-FIELD          PIC X(10)   VALUE ZERO.
   413     12  WS-DEEDIT-FIELD-DATE        REDEFINES
   414         WS-DT-DEEDIT-FIELD.
   415         16  FILLER                  PIC X(4).
   416         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   417     12  WS-DEEDIT-FIELD-A           PIC X(15)   VALUE ZERO.
   418     12  WS-DEEDIT-FIELD-V0          REDEFINES
   419         WS-DEEDIT-FIELD-A           PIC S9(15).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page   9
* EL677.cbl
   420
   421     12  WS-SUB                      PIC S9(4)   VALUE ZERO  COMP.
   422     12  WS-CERT-FOUND-SW            PIC X       VALUE 'N'.
   423         88 WS-CERT-FOUND                        VALUE 'Y'.
   424         88 WS-CERT-NOT-FOUND                    VALUE 'N'.
   425     12  WS-PNDB-FOUND-SW            PIC X       VALUE 'N'.
   426         88 WS-PNDB-FOUND                        VALUE 'Y'.
   427         88 WS-PNDB-NOT-FOUND                    VALUE 'N'.
   428     12  WS-PROCESS-CERT-SW          PIC X       VALUE SPACE.
   429         88  WS-PROCESS-CERT                     VALUE 'Y'.
   430     12  WS-PROCESS-BENEFICIARY-SW   PIC X       VALUE SPACE.
   431         88  WS-PROCESS-BENEFICIARY              VALUE 'Y'.
   432     12  WS-PY-ENTRY-COMMENT.
   433         16  WS-PY-CURRENT-DATE      PIC X(6)    VALUE SPACES.
   434         16  FILLER                  PIC X(13)   VALUE
   435            ' MISC. CHECK '.
   436         16  WS-PY-CURRENT-CERT      PIC X(10)   VALUE SPACES.
   437         16  WS-PY-CURRENT-SUFFIX    PIC X       VALUE SPACE.
   438     12  WS-PY-REF-COMMENT.
   439         16  WS-PY-REF-DATE          PIC X(6)    VALUE SPACES.
   440         16  FILLER                  PIC X(13)   VALUE
   441            ' REFUND PYMT '.
   442         16  WS-PY-REF-CERT          PIC X(10)   VALUE SPACES.
   443         16  WS-PY-REF-SUFFIX        PIC X       VALUE SPACE.
   444     12  WS-PY-END-COMMENT.
   445         16  WS-PY-END-DATE          PIC X(6)    VALUE SPACES.
   446         16  FILLER                  PIC X(13)   VALUE
   447            ' ENDORSEMENT '.
   448         16  WS-PY-END-CERT          PIC X(10)   VALUE SPACES.
   449         16  WS-PY-END-SUFFIX        PIC X       VALUE SPACE.
   450     12  WS-PY-DED-COMMENT.
   451         16  WS-PY-DED-DATE          PIC X(6)    VALUE SPACES.
   452         16  FILLER                  PIC X(13)   VALUE
   453            ' STAT DEDUCT '.
   454         16  WS-PY-DED-CERT          PIC X(10)   VALUE SPACES.
   455         16  WS-PY-DED-SUFFIX        PIC X       VALUE SPACE.
   456     12  WS-PY-ADDL-COMMENT.
   457         16  WS-PY-ADDL-DATE         PIC X(6)    VALUE SPACES.
   458         16  FILLER                  PIC X(13)   VALUE
   459            ' ADDL CHARGE '.
   460         16  WS-PY-ADDL-CERT         PIC X(10)   VALUE SPACES.
   461         16  WS-PY-ADDL-SUFFIX       PIC X       VALUE SPACE.
   462     12  WS-PY-REVERSAL-COMMENT.
   463         16  WS-PY-REVERSAL-DATE     PIC X(6)    VALUE SPACES.
   464         16  WS-PY-REVERSAL-TYPE     PIC X(13)   VALUE
   465            ' VOID REFUND '.
   466         16  WS-PY-REVERSAL-CERT     PIC X(10)   VALUE SPACES.
   467         16  WS-PY-REVERSAL-SUFFIX   PIC X       VALUE SPACE.
   468     12  WS-TMS-ENTRY-COMMENT.
   469         16  WS-TMS-PY-CERT          PIC X(10)   VALUE SPACES.
   470         16  FILLER                  PIC XX      VALUE SPACES.
   471         16  WS-TMS-PY-PAYEE         PIC X(18)   VALUE SPACES.
   472     12  WS-ZIP-CODE.
   473         16  WS-ZIP-PRIME.
   474             20  WS-ZIP-PRI-1ST      PIC X.
   475                 88  WS-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   476             20  FILLER              PIC X(4).
   477         16  WS-ZIP-PLUS4            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  10
* EL677.cbl
   478     12  WS-CANADIAN-POST-CODE1  REDEFINES  WS-ZIP-CODE.
   479         16  WS-CAN-POST1-1          PIC XXX.
   480         16  WS-CAN-POST1-2.
   481             20  WS-CAN-POST-4TH     PIC X.
   482             20  FILLER              PIC XX.
   483         16  FILLER                  PIC XXX.
   484     12  WS-CANADIAN-POST-CODE2  REDEFINES  WS-ZIP-CODE.
   485         16  WS-CAN-POST2-1          PIC XXX.
   486         16  FILLER                  PIC X.
   487         16  WS-CAN-POST2-2          PIC XXX.
   488         16  FILLER                  PIC XX.
   489
   490*                                    COPY ELCNWA.
   491*****************************************************************
   492*                                                               *
   493*                                                               *
   494*                            ELCNWA.                            *
   495*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   496*                            VMOD=2.003                         *
   497*                                                               *
   498*            M O V E   N A M E   W O R K   A R E A.             *
   499*                                                               *
   500*****************************************************************.
   501
   502 01  WS-NAME-WORK-AREA.
   503     05  WS-INSURED-LAST-NAME        PIC X(15).
   504     05  WS-INSURED-1ST-NAME         PIC X(12).
   505     05  WS-INSURED-MID-INIT         PIC X.
   506
   507     05  WS-NAME-WORK.
   508         10  WS-NW                   PIC X
   509             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   510
   511     05  WS-NAME-WORK2.
   512         10  WS-NW2                  PIC X
   513             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   514                                        NWA-INDEX0.
   515
   516     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   517                                     COMP-3.
   518
   519 01  WS-RESPONSE                 PIC S9(8) COMP VALUE +0.
   520     88  RESP-NORMAL                    VALUE +0.
   521     88  resp-file-notfnd               value +12.
   522     88  RESP-NOTFND                    VALUE +13.
   523     88  resp-duprec                    value +14.
   524     88  resp-dupkey                    value +15.
   525     88  resp-invreq                    value +16.
   526     88  RESP-NOTOPEN                   VALUE +19.
   527     88  RESP-ENDFILE                   VALUE +20.
   528     88  resp-lengtherr                 value +22.
   529 01  ACCESS-KEYS.
   530     12  ELCNTL-KEY.
   531         16 ELCNTL-COMP-ID           PIC XXX     VALUE SPACES.
   532         16 ELCNTL-REC-TYPE          PIC X       VALUE SPACES.
   533         16 ELCNTL-ACCESS.
   534             20 ELCNTL-STATE         PIC XX      VALUE SPACES.
   535             20  FILLER              PIC X       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  11
* EL677.cbl
   536             20 ELCNTL-CARRIER       PIC X       VALUE SPACES.
   537         16 ELCNTL-SEQ               PIC S9(4)   VALUE +0    COMP.
   538
   539     12  ELCNTL-RECORD-LENGTH        PIC S9(4)   VALUE +750  COMP.
   540
   541     12  ERACCT-KEY.
   542         16  ERACCT-CO               PIC X       VALUE SPACES.
   543         16  ERACCT-CARRIER          PIC X       VALUE SPACES.
   544         16  ERACCT-GROUPING         PIC X(6)    VALUE SPACES.
   545         16  ERACCT-STATE            PIC XX      VALUE SPACES.
   546         16  ERACCT-ACCOUNT          PIC X(10)   VALUE SPACES.
   547         16  ERACCT-EXP-DATE         PIC XX      VALUE SPACES.
   548         16  ERACCT-EXP-DATE-FILLER  PIC X(4)    VALUE SPACES.
   549
   550     12  SAVE-ERACCT-KEY.
   551         16  SV-ACCT-CO              PIC X       VALUE SPACES.
   552         16  SV-ACCT-CARRIER         PIC X       VALUE SPACES.
   553         16  SV-ACCT-GROUPING        PIC X(6)    VALUE SPACES.
   554         16  SV-ACCT-STATE           PIC XX      VALUE SPACES.
   555         16  SV-ACCT-ACCOUNT         PIC X(10)   VALUE SPACES.
   556         16  SV-ACCT-EXP-DATE        PIC XX      VALUE SPACES.
   557         16  SV-ACCT-EXP-DATE-FILLER PIC X(4)    VALUE SPACES.
   558
   559     12  ERACCT-RECORD-LENGTH        PIC S9(4)   VALUE +2000 COMP.
   560
   561     12  ERCOMP-KEY.
   562         16  ERCOMP-COMP-CD          PIC X       VALUE SPACE.
   563         16  ERCOMP-CARRIER          PIC X       VALUE SPACES.
   564         16  ERCOMP-GROUPING         PIC X(6)    VALUE SPACES.
   565         16  ERCOMP-FIN-RESP         PIC X(10)   VALUE SPACES.
   566         16  ERCOMP-ACCOUNT          PIC X(10)   VALUE SPACES.
   567         16  ERCOMP-RECORD-TYPE      PIC X       VALUE SPACES.
   568
   569     12  ERCOMP-LENGTH               PIC S9(4)   VALUE +700  COMP.
   570
   571     12  ELCERT-KEY.
   572         16 ELCERT-COMPANY-CD        PIC X       VALUE SPACES.
   573         16 ELCERT-CARRIER           PIC X       VALUE SPACES.
   574         16 ELCERT-GROUPING          PIC X(6)    VALUE SPACES.
   575         16 ELCERT-STATE             PIC XX      VALUE SPACES.
   576         16 ELCERT-ACCOUNT           PIC X(10)   VALUE SPACES.
   577         16 ELCERT-CERT-EFF-DT       PIC XX      VALUE SPACES.
   578         16 ELCERT-CERT-PRIME        PIC X(10)   VALUE SPACES.
   579         16 ELCERT-CERT-SFX          PIC X       VALUE SPACES.
   580
   581     12  ELCERT-RECORD-LENGTH        PIC S9(4)   VALUE +450  COMP.
   582
   583     12  ERPNDB-PRIMARY-KEY.
   584         16 ERPNDB-COMPANY-CD        PIC X       VALUE SPACES.
   585         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   586         16 ERPNDB-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   587         16 ERPNDB-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   588
   589     12  ERPNDB-ALT-KEY.
   590         16 ERPNDB-ALT-COMPANY-CD    PIC X       VALUE SPACES.
   591         16 ERPNDB-ALT-CARRIER       PIC X       VALUE SPACES.
   592         16 ERPNDB-ALT-GROUPING      PIC X(6)    VALUE SPACES.
   593         16 ERPNDB-ALT-STATE         PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  12
* EL677.cbl
   594         16 ERPNDB-ALT-ACCOUNT       PIC X(10)   VALUE SPACES.
   595         16 ERPNDB-ALT-CERT-EFF-DT   PIC XX      VALUE SPACES.
   596         16 ERPNDB-ALT-CERT-PRIME    PIC X(10)   VALUE SPACES.
   597         16 ERPNDB-ALT-CERT-SFX      PIC X       VALUE SPACES.
   598         16 ERPNDB-ALT-CH-SEQ-NO     PIC S9(4)   VALUE +0    COMP.
   599         16 ERPNDB-ALT-RECORD-TYPE   PIC X       VALUE SPACE.
   600
   601     12  ERPNDB-RECORD-LENGTH        PIC S9(4)   VALUE +585  COMP.
   602
   603     12  ERPNDM-PRIMARY-KEY.
   604         16 ERPNDM-COMPANY-CD        PIC X       VALUE SPACES.
   605         16 ERPNDB-ENTRY-BATCH       PIC X(6)    VALUE SPACES.
   606         16 ERPNDM-BATCH-SEQ-NO      PIC S9(4)   VALUE +0    COMP.
   607         16 ERPNDM-BATCH-CHG-SEQ-NO  PIC S9(4)   VALUE +0    COMP.
   608
   609     12  ERPNDM-RECORD-LENGTH        PIC S9(4)   VALUE +250  COMP.
   610
   611     12  ERCHEK-KEY.
   612         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   613         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   614         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   615         16  CHEK-STATE              PIC XX      VALUE SPACES.
   616         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   617         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   618         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   619         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   620         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   621
   622     12  ERCHEK-RECORD-LENGTH        PIC S9(4)   VALUE +600  COMP.
   623     12  ERPYAJ-KEY.
   624         16 PYAJ-COMPANY-CD          PIC X       VALUE LOW-VALUES.
   625         16 PYAJ-CARRIER             PIC X       VALUE SPACE.
   626         16 PYAJ-GROUPING            PIC X(06)   VALUE SPACES.
   627         16 PYAJ-FIN-RESP            PIC X(10)   VALUE SPACES.
   628         16 PYAJ-ACCOUNT             PIC X(10)   VALUE SPACES.
   629         16 PYAJ-FILE-SEQ-NO         PIC S9(8)   VALUE +0  COMP.
   630         16 PYAJ-RECORD-TYPE         PIC X       VALUE SPACE.
   631
   632     12  ERPYAJ-RECORD-LENGTH        PIC S9(4)   VALUE +200  COMP.
   633
   634 01  ERROR-NUMBERS.
   635     12  ER-0000                     PIC X(4)    VALUE '0000'.
   636     12  ER-0004                     PIC X(4)    VALUE '0004'.
   637     12  ER-0008                     PIC X(4)    VALUE '0008'.
   638     12  ER-0013                     PIC X(4)    VALUE '0013'.
   639     12  ER-0022                     PIC X(4)    VALUE '0022'.
   640     12  ER-0023                     PIC X(4)    VALUE '0023'.
   641     12  ER-0026                     PIC X(4)    VALUE '0026'.
   642     12  ER-0029                     PIC X(4)    VALUE '0029'.
   643     12  ER-0070                     PIC X(4)    VALUE '0070'.
   644     12  ER-0194                     PIC X(4)    VALUE '0194'.
   645     12  ER-0195                     PIC X(4)    VALUE '0195'.
   646     12  ER-0196                     PIC X(4)    VALUE '0196'.
   647     12  ER-0197                     PIC X(4)    VALUE '0197'.
   648     12  ER-0203                     PIC X(4)    VALUE '0203'.
   649     12  ER-0215                     PIC X(4)    VALUE '0215'.
   650     12  ER-0216                     PIC X(4)    VALUE '0216'.
   651     12  ER-0433                     PIC X(4)    VALUE '0433'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  13
* EL677.cbl
   652     12  ER-0565                     PIC X(4)    VALUE '0565'.
   653     12  ER-1159                     PIC X(4)    VALUE '1159'.
   654     12  ER-1162                     PIC X(4)    VALUE '1162'.
   655     12  ER-2056                     PIC X(4)    VALUE '2056'.
   656     12  ER-2208                     PIC X(4)    VALUE '2208'.
   657     12  ER-2209                     PIC X(4)    VALUE '2209'.
   658     12  ER-2210                     PIC X(4)    VALUE '2210'.
   659     12  ER-2230                     PIC X(4)    VALUE '2230'.
   660     12  ER-2237                     PIC X(4)    VALUE '2237'.
   661     12  ER-2238                     PIC X(4)    VALUE '2238'.
   662     12  ER-2294                     PIC X(4)    VALUE '2294'.
   663     12  ER-2394                     PIC X(4)    VALUE '2394'.
   664     12  ER-2438                     PIC X(4)    VALUE '2438'.
   665     12  ER-2439                     PIC X(4)    VALUE '2439'.
   666     12  ER-2583                     PIC X(4)    VALUE '2583'.
   667     12  ER-2600                     PIC X(4)    VALUE '2600'.
   668     12  ER-2726                     PIC X(4)    VALUE '2726'.
   669     12  ER-2905                     PIC X(4)    VALUE '2905'.
   670     12  ER-2906                     PIC X(4)    VALUE '2906'.
   671     12  ER-2907                     PIC X(4)    VALUE '2907'.
   672     12  ER-2908                     PIC X(4)    VALUE '2908'.
   673     12  ER-2909                     PIC X(4)    VALUE '2909'.
   674     12  ER-3044                     PIC X(4)    VALUE '3044'.
   675     12  ER-3046                     PIC X(4)    VALUE '3046'.
   676     12  ER-3047                     PIC X(4)    VALUE '3047'.
   677     12  ER-3445                     PIC X(4)    VALUE '3445'.
   678     12  er-3450                     pic x(4)    value '3450'.
   679     12  er-3451                     pic x(4)    value '3451'.
   680     12  er-3452                     pic x(4)    value '3452'.
   681     12  er-3453                     pic x(4)    value '3453'.
   682     12  er-3454                     pic x(4)    value '3454'.
   683     12  er-3455                     pic x(4)    value '3455'.
   684     12  er-3459                     pic x(4)    value '3459'.
   685     12  ER-7389                     PIC X(4)    VALUE '7389'.
   686     12  er-9999                     pic x(4)    value '9999'.
   687*                                    COPY ELCLOGOF.
   688******************************************************************
   689*                                                                *
   690*                                                                *
   691*                            ELCLOGOF.                           *
   692*                            VMOD=2.001                          *
   693*                                                                *
   694*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   695*                                                                *
   696******************************************************************
   697 01  CLASIC-LOGOFF.
   698     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   699     12  LOGOFF-TEXT.
   700         16  FILLER          PIC X(5)    VALUE SPACES.
   701         16  LOGOFF-MSG.
   702             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   703             20  FILLER      PIC X       VALUE SPACES.
   704             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   705         16  FILLER          PIC X(80)
   706           VALUE '* YOU ARE NOW LOGGED OFF'.
   707         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   708         16  FILLER          PIC X       VALUE QUOTE.
   709         16  LOGOFF-SYS-MSG  PIC X(17)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  14
* EL677.cbl
   710           VALUE 'S CLAS-IC SYSTEM '.
   711     12  TEXT-MESSAGES.
   712         16  UNACCESS-MSG    PIC X(29)
   713             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   714         16  PGMIDERR-MSG    PIC X(17)
   715             VALUE 'PROGRAM NOT FOUND'.
   716*                                    COPY ELCDATE.
   717******************************************************************
   718*                                                                *
   719*                                                                *
   720*                            ELCDATE.                            *
   721*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   722*                            VMOD=2.003
   723*                                                                *
   724*                                                                *
   725*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   726*                 LENGTH = 200                                   *
   727******************************************************************
   728
   729 01  DATE-CONVERSION-DATA.
   730     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   731     12  DC-OPTION-CODE                PIC X.
   732         88  BIN-TO-GREG                VALUE ' '.
   733         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   734         88  EDIT-GREG-TO-BIN           VALUE '2'.
   735         88  YMD-GREG-TO-BIN            VALUE '3'.
   736         88  MDY-GREG-TO-BIN            VALUE '4'.
   737         88  JULIAN-TO-BIN              VALUE '5'.
   738         88  BIN-PLUS-ELAPSED           VALUE '6'.
   739         88  FIND-CENTURY               VALUE '7'.
   740         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   741         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   742         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   743         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   744         88  JULIAN-TO-BIN-3            VALUE 'C'.
   745         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   746         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   747         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   748         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   749         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   750         88  CHECK-LEAP-YEAR            VALUE 'H'.
   751         88  BIN-3-TO-GREG              VALUE 'I'.
   752         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   753         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   754         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   755         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   756         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   757         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   758         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   759         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   760         88  THREE-CHARACTER-BIN
   761                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   762         88  GREGORIAN-TO-BIN
   763                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   764         88  BIN-TO-GREGORIAN
   765                  VALUES ' ' '1' 'I' '8' 'G'.
   766         88  JULIAN-TO-BINARY
   767                  VALUES '5' 'C' 'E' 'F'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  15
* EL677.cbl
   768     12  DC-ERROR-CODE                 PIC X.
   769         88  NO-CONVERSION-ERROR        VALUE ' '.
   770         88  DATE-CONVERSION-ERROR
   771                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   772         88  DATE-IS-ZERO               VALUE '1'.
   773         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   774         88  DATE-IS-INVALID            VALUE '3'.
   775         88  DATE1-GREATER-DATE2        VALUE '4'.
   776         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   777         88  DATE-INVALID-OPTION        VALUE '9'.
   778         88  INVALID-CENTURY            VALUE 'A'.
   779         88  ONLY-CENTURY               VALUE 'B'.
   780         88  ONLY-LEAP-YEAR             VALUE 'C'.
   781         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   782     12  DC-END-OF-MONTH               PIC X.
   783         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   784     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   785         88  USE-NORMAL-PROCESS         VALUE ' '.
   786         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   787         88  ADJUST-UP-100-YRS          VALUE '2'.
   788     12  FILLER                        PIC X.
   789     12  DC-CONVERSION-DATES.
   790         16  DC-BIN-DATE-1             PIC XX.
   791         16  DC-BIN-DATE-2             PIC XX.
   792         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   793         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   794                       DC-GREG-DATE-1-EDIT.
   795             20  DC-EDIT1-MONTH        PIC 99.
   796             20  SLASH1-1              PIC X.
   797             20  DC-EDIT1-DAY          PIC 99.
   798             20  SLASH1-2              PIC X.
   799             20  DC-EDIT1-YEAR         PIC 99.
   800         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   801         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   802                     DC-GREG-DATE-2-EDIT.
   803             20  DC-EDIT2-MONTH        PIC 99.
   804             20  SLASH2-1              PIC X.
   805             20  DC-EDIT2-DAY          PIC 99.
   806             20  SLASH2-2              PIC X.
   807             20  DC-EDIT2-YEAR         PIC 99.
   808         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   809         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   810                     DC-GREG-DATE-1-YMD.
   811             20  DC-YMD-YEAR           PIC 99.
   812             20  DC-YMD-MONTH          PIC 99.
   813             20  DC-YMD-DAY            PIC 99.
   814         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   815         16  DC-GREG-DATE-1-MDY-R REDEFINES
   816                      DC-GREG-DATE-1-MDY.
   817             20  DC-MDY-MONTH          PIC 99.
   818             20  DC-MDY-DAY            PIC 99.
   819             20  DC-MDY-YEAR           PIC 99.
   820         16  DC-GREG-DATE-1-ALPHA.
   821             20  DC-ALPHA-MONTH        PIC X(10).
   822             20  DC-ALPHA-DAY          PIC 99.
   823             20  FILLER                PIC XX.
   824             20  DC-ALPHA-CENTURY.
   825                 24 DC-ALPHA-CEN-N     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  16
* EL677.cbl
   826             20  DC-ALPHA-YEAR         PIC 99.
   827         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   828         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   829         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   830         16  DC-JULIAN-DATE            PIC 9(05).
   831         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   832                                       PIC 9(05).
   833         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   834             20  DC-JULIAN-YEAR        PIC 99.
   835             20  DC-JULIAN-DAYS        PIC 999.
   836         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   837         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   838         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   839     12  DATE-CONVERSION-VARIBLES.
   840         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   841         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   842             20  FILLER                PIC 9(3).
   843             20  HOLD-CEN-1-CCYY.
   844                 24  HOLD-CEN-1-CC     PIC 99.
   845                 24  HOLD-CEN-1-YY     PIC 99.
   846             20  HOLD-CEN-1-MO         PIC 99.
   847             20  HOLD-CEN-1-DA         PIC 99.
   848         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   849             20  HOLD-CEN-1-R-MO       PIC 99.
   850             20  HOLD-CEN-1-R-DA       PIC 99.
   851             20  HOLD-CEN-1-R-CCYY.
   852                 24  HOLD-CEN-1-R-CC   PIC 99.
   853                 24  HOLD-CEN-1-R-YY   PIC 99.
   854             20  FILLER                PIC 9(3).
   855         16  HOLD-CENTURY-1-X.
   856             20  FILLER                PIC X(3)  VALUE SPACES.
   857             20  HOLD-CEN-1-X-CCYY.
   858                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   859                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   860             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   861             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   862         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   863             20  HOLD-CEN-1-R-X-MO     PIC XX.
   864             20  HOLD-CEN-1-R-X-DA     PIC XX.
   865             20  HOLD-CEN-1-R-X-CCYY.
   866                 24  HOLD-CEN-1-R-X-CC PIC XX.
   867                 24  HOLD-CEN-1-R-X-YY PIC XX.
   868             20  FILLER                PIC XXX.
   869         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   870         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   871         16  DC-JULIAN-DATE-1          PIC 9(07).
   872         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   873             20  DC-JULIAN-1-CCYY.
   874                 24  DC-JULIAN-1-CC    PIC 99.
   875                 24  DC-JULIAN-1-YR    PIC 99.
   876             20  DC-JULIAN-DA-1        PIC 999.
   877         16  DC-JULIAN-DATE-2          PIC 9(07).
   878         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   879             20  DC-JULIAN-2-CCYY.
   880                 24  DC-JULIAN-2-CC    PIC 99.
   881                 24  DC-JULIAN-2-YR    PIC 99.
   882             20  DC-JULIAN-DA-2        PIC 999.
   883         16  DC-GREG-DATE-A-EDIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  17
* EL677.cbl
   884             20  DC-EDITA-MONTH        PIC 99.
   885             20  SLASHA-1              PIC X VALUE '/'.
   886             20  DC-EDITA-DAY          PIC 99.
   887             20  SLASHA-2              PIC X VALUE '/'.
   888             20  DC-EDITA-CCYY.
   889                 24  DC-EDITA-CENT     PIC 99.
   890                 24  DC-EDITA-YEAR     PIC 99.
   891         16  DC-GREG-DATE-B-EDIT.
   892             20  DC-EDITB-MONTH        PIC 99.
   893             20  SLASHB-1              PIC X VALUE '/'.
   894             20  DC-EDITB-DAY          PIC 99.
   895             20  SLASHB-2              PIC X VALUE '/'.
   896             20  DC-EDITB-CCYY.
   897                 24  DC-EDITB-CENT     PIC 99.
   898                 24  DC-EDITB-YEAR     PIC 99.
   899         16  DC-GREG-DATE-CYMD         PIC 9(08).
   900         16  DC-GREG-DATE-CYMD-R REDEFINES
   901                              DC-GREG-DATE-CYMD.
   902             20  DC-CYMD-CEN           PIC 99.
   903             20  DC-CYMD-YEAR          PIC 99.
   904             20  DC-CYMD-MONTH         PIC 99.
   905             20  DC-CYMD-DAY           PIC 99.
   906         16  DC-GREG-DATE-MDCY         PIC 9(08).
   907         16  DC-GREG-DATE-MDCY-R REDEFINES
   908                              DC-GREG-DATE-MDCY.
   909             20  DC-MDCY-MONTH         PIC 99.
   910             20  DC-MDCY-DAY           PIC 99.
   911             20  DC-MDCY-CEN           PIC 99.
   912             20  DC-MDCY-YEAR          PIC 99.
   913    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   914        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   915    12  DC-EL310-DATE                  PIC X(21).
   916    12  FILLER                         PIC X(28).
   917*                                    COPY ELCATTR.
   918******************************************************************
   919*                                                                *
   920*                            ELCATTR.                            *
   921*                            VMOD=2.001                          *
   922*                                                                *
   923*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   924*                                                                *
   925*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   926*                                                                *
   927*                   POS 1   P=PROTECTED                          *
   928*                           U=UNPROTECTED                        *
   929*                           S=ASKIP                              *
   930*                   POS 2   A=ALPHA/NUMERIC                      *
   931*                           N=NUMERIC                            *
   932*                   POS 3   N=NORMAL                             *
   933*                           B=BRIGHT                             *
   934*                           D=DARK                               *
   935*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   936*                           OF=MODIFIED DATA TAG OFF             *
   937*                                                                *
   938*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   939******************************************************************
   940 01  ATTRIBUTE-LIST.
   941     12  AL-PABOF            PIC X       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  18
* EL677.cbl
   942     12  AL-PABON            PIC X       VALUE 'Z'.
   943     12  AL-PADOF            PIC X       VALUE '%'.
   944     12  AL-PADON            PIC X       VALUE '_'.
   945     12  AL-PANOF            PIC X       VALUE '-'.
   946     12  AL-PANON            PIC X       VALUE '/'.
   947     12  AL-SABOF            PIC X       VALUE '8'.
   948     12  AL-SABON            PIC X       VALUE '9'.
   949     12  AL-SADOF            PIC X       VALUE '@'.
   950     12  AL-SADON            PIC X       VALUE QUOTE.
   951     12  AL-SANOF            PIC X       VALUE '0'.
   952     12  AL-SANON            PIC X       VALUE '1'.
   953     12  AL-UABOF            PIC X       VALUE 'H'.
   954     12  AL-UABON            PIC X       VALUE 'I'.
   955     12  AL-UADOF            PIC X       VALUE '<'.
   956     12  AL-UADON            PIC X       VALUE '('.
   957     12  AL-UANOF            PIC X       VALUE ' '.
   958     12  AL-UANON            PIC X       VALUE 'A'.
   959     12  AL-UNBOF            PIC X       VALUE 'Q'.
   960     12  AL-UNBON            PIC X       VALUE 'R'.
   961     12  AL-UNDOF            PIC X       VALUE '*'.
   962     12  AL-UNDON            PIC X       VALUE ')'.
   963     12  AL-UNNOF            PIC X       VALUE '&'.
   964     12  AL-UNNON            PIC X       VALUE 'J'.
   965*                                    COPY ELCEMIB.
   966******************************************************************
   967*                                                                *
   968*                                                                *
   969*                            ELCEMIB.                            *
   970*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   971*                            VMOD=2.005                          *
   972*                                                                *
   973*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   974*                                                                *
   975******************************************************************
   976 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   977     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   978     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   979     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   980     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   981     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   982     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   983     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   984     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   985     12  EMI-SWITCH1             PIC X        VALUE '1'.
   986         88  EMI-NO-ERRORS                    VALUE '1'.
   987         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   988         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   989     12  EMI-SWITCH2             PIC X        VALUE '1'.
   990         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   991     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   992         88  EMI-AREA1-EMPTY                  VALUE '1'.
   993         88  EMI-AREA1-FULL                   VALUE '2'.
   994     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   995         88  EMI-AREA2-EMPTY                  VALUE '1'.
   996         88  EMI-AREA2-FULL                   VALUE '2'.
   997     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   998         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   999         88  EMI-BYPASS-NOTES                 VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  19
* EL677.cbl
  1000         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1001         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1002         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1003     12  EMI-ERROR-LINES.
  1004         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1005         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1006         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1007         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1008             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1009                 24  EMI-ERR-NUM         PIC X(4).
  1010                 24  EMI-FILLER          PIC X.
  1011                 24  EMI-SEV             PIC X.
  1012                 24  FILLER              PIC X.
  1013             20  FILLER                  PIC X(02).
  1014     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1015         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1016             20  EMI-ERROR-NUMBER    PIC X(4).
  1017             20  EMI-FILL            PIC X.
  1018             20  EMI-SEVERITY        PIC X.
  1019             20  FILLER              PIC X.
  1020             20  EMI-ERROR-TEXT.
  1021                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1022                 24  FILLER          PIC X(55).
  1023     12  EMI-SEVERITY-SAVE           PIC X.
  1024         88  EMI-NOTE                    VALUE 'N'.
  1025         88  EMI-WARNING                 VALUE 'W'.
  1026         88  EMI-FORCABLE                VALUE 'F'.
  1027         88  EMI-FATAL                   VALUE 'X'.
  1028     12  EMI-MESSAGE-FLAG            PIC X.
  1029         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1030         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1031     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1032     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1033         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1034         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1035         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1036     12  emi-claim-no                pic x(7).
  1037     12  emi-claim-type              pic x(6).
  1038     12  FILLER                      PIC X(124)  VALUE SPACES.
  1039     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1040     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1041     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1042     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1043*                                    COPY ELCINTF.
  1044******************************************************************
  1045*                                                                *
  1046*                                                                *
  1047*                            ELCINTF.                            *
  1048*                            VMOD=2.017                          *
  1049*                                                                *
  1050*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1051*                                                                *
  1052*       LENGTH = 1024                                            *
  1053*                                                                *
  1054******************************************************************
  1055*                   C H A N G E   L O G
  1056*
  1057* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  20
* EL677.cbl
  1058*-----------------------------------------------------------------
  1059*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1060* EFFECTIVE    NUMBER
  1061*-----------------------------------------------------------------
  1062* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1063******************************************************************
  1064 01  PROGRAM-INTERFACE-BLOCK.
  1065     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1066     12  PI-CALLING-PROGRAM              PIC X(8).
  1067     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1068     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1069     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1070     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1071     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1072     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1073     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1074     12  PI-COMPANY-ID                   PIC XXX.
  1075     12  PI-COMPANY-CD                   PIC X.
  1076
  1077     12  PI-COMPANY-PASSWORD             PIC X(8).
  1078
  1079     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1080
  1081     12  PI-CONTROL-IN-PROGRESS.
  1082         16  PI-CARRIER                  PIC X.
  1083         16  PI-GROUPING                 PIC X(6).
  1084         16  PI-STATE                    PIC XX.
  1085         16  PI-ACCOUNT                  PIC X(10).
  1086         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1087                                         PIC X(10).
  1088         16  PI-CLAIM-CERT-GRP.
  1089             20  PI-CLAIM-NO             PIC X(7).
  1090             20  PI-CERT-NO.
  1091                 25  PI-CERT-PRIME       PIC X(10).
  1092                 25  PI-CERT-SFX         PIC X.
  1093             20  PI-CERT-EFF-DT          PIC XX.
  1094         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1095             20  PI-PLAN-CODE            PIC X(2).
  1096             20  PI-REVISION-NUMBER      PIC X(3).
  1097             20  PI-PLAN-EFF-DT          PIC X(2).
  1098             20  PI-PLAN-EXP-DT          PIC X(2).
  1099             20  FILLER                  PIC X(11).
  1100         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1101             20  PI-OE-REFERENCE-1.
  1102                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1103                 25  PI-OE-REF-1-SUFF    PIC XX.
  1104
  1105     12  PI-SESSION-IN-PROGRESS          PIC X.
  1106         88  CLAIM-SESSION                   VALUE '1'.
  1107         88  CREDIT-SESSION                  VALUE '2'.
  1108         88  WARRANTY-SESSION                VALUE '3'.
  1109         88  MORTGAGE-SESSION                VALUE '4'.
  1110         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1111
  1112
  1113*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1114
  1115     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  21
* EL677.cbl
  1116     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1117
  1118     12  PI-CREDIT-USER                  PIC X.
  1119         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1120         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1121
  1122     12  PI-CLAIM-USER                   PIC X.
  1123         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1124         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1125
  1126     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1127         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1128         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1129         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1130         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1131         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1132
  1133     12  PI-PROCESSOR-ID                 PIC X(4).
  1134
  1135     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1136
  1137     12  PI-MEMBER-CAPTION               PIC X(10).
  1138
  1139     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1140         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1141
  1142     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1143     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1144     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1145     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1146
  1147     12  PI-AH-OVERRIDE-L1               PIC X.
  1148     12  PI-AH-OVERRIDE-L2               PIC XX.
  1149     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1150     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1151
  1152     12  PI-NEW-SYSTEM                   PIC X(2).
  1153
  1154     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1155     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1156         88  PI-USES-PAID-TO                 VALUE '1'.
  1157     12  PI-CRDTCRD-SYSTEM.
  1158         16  PI-CRDTCRD-USER             PIC X.
  1159             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1160             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1161         16  PI-CC-MONTH-END-DT          PIC XX.
  1162     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1163
  1164     12  PI-OE-REFERENCE-2.
  1165         16  PI-OE-REF-2-PRIME           PIC X(10).
  1166         16  PI-OE-REF-2-SUFF            PIC X.
  1167
  1168     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1169
  1170     12  PI-LANGUAGE-TYPE                PIC X.
  1171             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1172             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1173             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  22
* EL677.cbl
  1174
  1175     12  PI-POLICY-LINKAGE-IND           PIC X.
  1176         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1177         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1178                                                   LOW-VALUES.
  1179
  1180     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1181     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1182         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1183         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1184
  1185     12  PI-PROCESSOR-CSR-IND            PIC X.
  1186         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1187         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1188
  1189     12  FILLER                          PIC X(3).
  1190
  1191     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1192
  1193     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1194         PI-SYSTEM-LEVEL.
  1195
  1196         16  PI-ENTRY-CODES.
  1197             20  PI-ENTRY-CD-1           PIC X.
  1198             20  PI-ENTRY-CD-2           PIC X.
  1199
  1200         16  PI-RETURN-CODES.
  1201             20  PI-RETURN-CD-1          PIC X.
  1202             20  PI-RETURN-CD-2          PIC X.
  1203
  1204         16  PI-UPDATE-STATUS-SAVE.
  1205             20  PI-UPDATE-BY            PIC X(4).
  1206             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1207
  1208         16  PI-LOWER-CASE-LETTERS       PIC X.
  1209             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1210
  1211*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1212*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1213*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1214
  1215         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1216             88  ST-ACCNT-CNTL               VALUE ' '.
  1217             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1218             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1219             88  ACCNT-CNTL                  VALUE '3'.
  1220             88  CARR-ACCNT-CNTL             VALUE '4'.
  1221
  1222         16  PI-PROCESSOR-CAP-LIST.
  1223             20  PI-SYSTEM-CONTROLS.
  1224                24 PI-SYSTEM-DISPLAY     PIC X.
  1225                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1226                24 PI-SYSTEM-MODIFY      PIC X.
  1227                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1228             20  FILLER                  PIC XX.
  1229             20  PI-DISPLAY-CAP          PIC X.
  1230                 88  DISPLAY-CAP             VALUE 'Y'.
  1231             20  PI-MODIFY-CAP           PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  23
* EL677.cbl
  1232                 88  MODIFY-CAP              VALUE 'Y'.
  1233             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1234                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1235             20  PI-FORCE-CAP            PIC X.
  1236                 88  FORCE-CAP               VALUE 'Y'.
  1237
  1238         16  PI-PROGRAM-CONTROLS.
  1239             20  PI-PGM-PRINT-OPT        PIC X.
  1240             20  PI-PGM-FORMAT-OPT       PIC X.
  1241             20  PI-PGM-PROCESS-OPT      PIC X.
  1242             20  PI-PGM-TOTALS-OPT       PIC X.
  1243
  1244         16  PI-HELP-INTERFACE.
  1245             20  PI-LAST-ERROR-NO        PIC X(4).
  1246             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1247
  1248         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1249             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1250
  1251         16  PI-CR-CONTROL-IN-PROGRESS.
  1252             20  PI-CR-CARRIER           PIC X.
  1253             20  PI-CR-GROUPING          PIC X(6).
  1254             20  PI-CR-STATE             PIC XX.
  1255             20  PI-CR-ACCOUNT           PIC X(10).
  1256             20  PI-CR-FIN-RESP          PIC X(10).
  1257             20  PI-CR-TYPE              PIC X.
  1258
  1259         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1260
  1261         16  PI-CR-MONTH-END-DT          PIC XX.
  1262
  1263         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1264             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1265             88  PI-ZERO-CARRIER             VALUE '1'.
  1266             88  PI-ZERO-GROUPING            VALUE '2'.
  1267             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1268
  1269         16  PI-CARRIER-SECURITY         PIC X.
  1270             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1271
  1272         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1273             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1274             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1275
  1276         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1277             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1278                                         INDEXED BY PI-ACCESS-NDX
  1279                                         PIC X.
  1280
  1281         16  PI-GA-BILLING-CONTROL       PIC X.
  1282             88  PI-GA-BILLING               VALUE '1'.
  1283
  1284         16  PI-MAIL-PROCESSING          PIC X.
  1285             88  PI-MAIL-YES                 VALUE 'Y'.
  1286
  1287         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1288
  1289         16  PI-AR-SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  24
* EL677.cbl
  1290             20  PI-AR-PROCESSING-CNTL   PIC X.
  1291                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1292             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1293             20  PI-AR-MONTH-END-DT      PIC XX.
  1294
  1295         16  PI-MP-SYSTEM.
  1296             20  PI-MORTGAGE-USER            PIC X.
  1297                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1298                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1299             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1300                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1301                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1302                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1303                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1304                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1305             20  PI-MP-MONTH-END-DT          PIC XX.
  1306             20  PI-MP-REFERENCE-NO.
  1307                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1308                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1309
  1310         16  PI-LABEL-CONTROL            PIC X(01).
  1311             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1312             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1313
  1314         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1315             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1316
  1317         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1318             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1319             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1320
  1321         16  FILLER                      PIC X(14).
  1322
  1323     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1324******************************************************************
  1325     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1326         16  PI-EOF-SW               PIC X.
  1327             88  PI-FILE-EOF                     VALUE 'Y'.
  1328         16  PI-PREV-MAINT           PIC X.
  1329         16  PI-WORK-SEQ-NO          PIC S9(9)   COMP-3.
  1330         16  PI-ERCHEK-KEY.
  1331             20  PI-CHEK-COMP-CD     PIC X.
  1332             20  PI-CHEK-CARRIER     PIC X.
  1333             20  PI-CHEK-GROUPING    PIC X(6).
  1334             20  PI-CHEK-STATE       PIC XX.
  1335             20  PI-CHEK-ACCOUNT     PIC X(10).
  1336             20  PI-CHEK-EFF-DT      PIC XX.
  1337             20  PI-CHEK-CERT-NO     PIC X(10).
  1338             20  PI-CHEK-SUF-NO      PIC X.
  1339             20  PI-CHEK-SEQUENCE    PIC S9(4)  COMP.
  1340         16  PI-ACCOUNT-ADDRESS.
  1341             20  PI-AM-NAME          PIC X(30).
  1342             20  PI-AM-ADDRS         PIC X(30).
  1343             20  PI-AM-CITY-st.
  1344                 24  pi-am-city      PIC X(28).
  1345                 24  pi-am-st        pic xx.
  1346             20  PI-AM-ZIP-CODE.
  1347                 24  PI-AM-ZIP-PRIME PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  25
* EL677.cbl
  1348                 24  PI-AM-ZIP-PLUS4 PIC X(4).
  1349         16  PI-PROCESS-CERT-SW          PIC X.
  1350             88  PI-PROCESS-CERT                     VALUE 'Y'.
  1351         16  PI-PROCESS-BENEFICIARY-SW   PIC X.
  1352             88  PI-PROCESS-BENEFICIARY              VALUE 'Y'.
  1353         16  PI-PAYTO1                   PIC X(30).
  1354         16  PI-REFERENCE                PIC X(12).
  1355         16  PI-CANC-DT                  PIC XX.
  1356         16  PI-LF-REFUND                PIC S9(7)V99  COMP-3.
  1357         16  PI-AH-REFUND                PIC S9(7)V99  COMP-3.
  1358         16  PI-INSURED-NAME             PIC X(28).
  1359         16  PI-PFKEY                    PIC XXX.
  1360             88  PI-TO-EL1273-FROM-EL677        VALUE 'PF3'.
  1361             88  PI-TO-EL677-FROM-EL1273        VALUE 'PF8'.
  1362         16  PI-AMOUNT                   PIC S9(9)V99  COMP-3.
  1363         16  PI-TYPE                     PIC X.
  1364         16  pi-prev-paid                pic s9(7)v99 comp-3.
  1365         16  pi-refund-on-pending-rec    pic s9(7)v99 comp-3.
  1366         16  pi-ue-comm                  pic s9(7)v99 comp-3.
  1367         16  pi-chek-rec-cnt             pic s999 comp-3.
  1368         16  pi-am-csr                   pic x(4).
  1369         16  pi-return-to                pic x(30).
  1370         16  pi-prev-ded-comm            pic x.
  1371         16  pi-table-name               pic x(30).
  1372         16  pi-check-cashed             pic x.
  1373         16  pi-endt-prm-diff            pic s9(7)v99 comp-3.
  1374         16  pi-endt-com-diff            pic s9(5)v99 comp-3.
  1375         16  pi-check-type               pic x.
  1376             88  pi-corr-check              value 'C'.
  1377             88  pi-ref-check               value 'R'.
  1378         16  pi-check-cut                pic x.
  1379         16  pi-prev-paid-this-month     pic s9(7)v99 comp-3.
  1380         16  pi-previous-deduct-comm     pic x.
  1381         16  FILLER                      PIC X(305). *> wass 311
  1382*                                    COPY ELCAID.
  1383******************************************************************
  1384*                                                                *
  1385*                            ELCAID.                             *
  1386*                            VMOD=2.001                          *
  1387*                                                                *
  1388*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1389*                                                                *
  1390*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1391*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1392******************************************************************
  1393
  1394 01  DFHAID.
  1395   02  DFHNULL   PIC  X  VALUE  ' '.
  1396   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1397   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1398   02  DFHPEN    PIC  X  VALUE  '='.
  1399   02  DFHOPID   PIC  X  VALUE  'W'.
  1400   02  DFHPA1    PIC  X  VALUE  '%'.
  1401   02  DFHPA2    PIC  X  VALUE  '>'.
  1402   02  DFHPA3    PIC  X  VALUE  ','.
  1403   02  DFHPF1    PIC  X  VALUE  '1'.
  1404   02  DFHPF2    PIC  X  VALUE  '2'.
  1405   02  DFHPF3    PIC  X  VALUE  '3'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  26
* EL677.cbl
  1406   02  DFHPF4    PIC  X  VALUE  '4'.
  1407   02  DFHPF5    PIC  X  VALUE  '5'.
  1408   02  DFHPF6    PIC  X  VALUE  '6'.
  1409   02  DFHPF7    PIC  X  VALUE  '7'.
  1410   02  DFHPF8    PIC  X  VALUE  '8'.
  1411   02  DFHPF9    PIC  X  VALUE  '9'.
  1412   02  DFHPF10   PIC  X  VALUE  ':'.
  1413   02  DFHPF11   PIC  X  VALUE  '#'.
  1414   02  DFHPF12   PIC  X  VALUE  '@'.
  1415   02  DFHPF13   PIC  X  VALUE  'A'.
  1416   02  DFHPF14   PIC  X  VALUE  'B'.
  1417   02  DFHPF15   PIC  X  VALUE  'C'.
  1418   02  DFHPF16   PIC  X  VALUE  'D'.
  1419   02  DFHPF17   PIC  X  VALUE  'E'.
  1420   02  DFHPF18   PIC  X  VALUE  'F'.
  1421   02  DFHPF19   PIC  X  VALUE  'G'.
  1422   02  DFHPF20   PIC  X  VALUE  'H'.
  1423   02  DFHPF21   PIC  X  VALUE  'I'.
  1424*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1425   02  DFHPF22   PIC  X  VALUE  '['.
  1426   02  DFHPF23   PIC  X  VALUE  '.'.
  1427   02  DFHPF24   PIC  X  VALUE  '<'.
  1428   02  DFHMSRE   PIC  X  VALUE  'X'.
  1429   02  DFHSTRF   PIC  X  VALUE  'h'.
  1430   02  DFHTRIG   PIC  X  VALUE  '"'.
  1431 01  FILLER    REDEFINES DFHAID.
  1432     12  FILLER                      PIC X(8).
  1433     12  PF-VALUES                   PIC X       OCCURS 24.
  1434     12  FILLER                      PIC X(3).
  1435*                                    COPY EL677S.
  1436 01  EL677AI.
  1437     05  FILLER            PIC  X(0012).
  1438*    -------------------------------
  1439     05  DATEL PIC S9(0004) COMP.
  1440     05  DATEF PIC  X(0001).
  1441     05  FILLER REDEFINES DATEF.
  1442         10  DATEA PIC  X(0001).
  1443     05  DATEI PIC  X(0008).
  1444*    -------------------------------
  1445     05  TIMEL PIC S9(0004) COMP.
  1446     05  TIMEF PIC  X(0001).
  1447     05  FILLER REDEFINES TIMEF.
  1448         10  TIMEA PIC  X(0001).
  1449     05  TIMEI PIC  X(0005).
  1450*    -------------------------------
  1451     05  MAINTL PIC S9(0004) COMP.
  1452     05  MAINTF PIC  X(0001).
  1453     05  FILLER REDEFINES MAINTF.
  1454         10  MAINTA PIC  X(0001).
  1455     05  MAINTI PIC  X(0001).
  1456*    -------------------------------
  1457     05  DMAINT1L PIC S9(0004) COMP.
  1458     05  DMAINT1F PIC  X(0001).
  1459     05  FILLER REDEFINES DMAINT1F.
  1460         10  DMAINT1A PIC  X(0001).
  1461     05  DMAINT1I PIC  X(0009).
  1462*    -------------------------------
  1463     05  DMAINT2L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  27
* EL677.cbl
  1464     05  DMAINT2F PIC  X(0001).
  1465     05  FILLER REDEFINES DMAINT2F.
  1466         10  DMAINT2A PIC  X(0001).
  1467     05  DMAINT2I PIC  X(0029).
  1468*    -------------------------------
  1469     05  CARRIERL PIC S9(0004) COMP.
  1470     05  CARRIERF PIC  X(0001).
  1471     05  FILLER REDEFINES CARRIERF.
  1472         10  CARRIERA PIC  X(0001).
  1473     05  CARRIERI PIC  X(0001).
  1474*    -------------------------------
  1475     05  GROUPL PIC S9(0004) COMP.
  1476     05  GROUPF PIC  X(0001).
  1477     05  FILLER REDEFINES GROUPF.
  1478         10  GROUPA PIC  X(0001).
  1479     05  GROUPI PIC  X(0006).
  1480*    -------------------------------
  1481     05  STATEL PIC S9(0004) COMP.
  1482     05  STATEF PIC  X(0001).
  1483     05  FILLER REDEFINES STATEF.
  1484         10  STATEA PIC  X(0001).
  1485     05  STATEI PIC  X(0002).
  1486*    -------------------------------
  1487     05  ACCTL PIC S9(0004) COMP.
  1488     05  ACCTF PIC  X(0001).
  1489     05  FILLER REDEFINES ACCTF.
  1490         10  ACCTA PIC  X(0001).
  1491     05  ACCTI PIC  X(0010).
  1492*    -------------------------------
  1493     05  EFFDTL PIC S9(0004) COMP.
  1494     05  EFFDTF PIC  X(0001).
  1495     05  FILLER REDEFINES EFFDTF.
  1496         10  EFFDTA PIC  X(0001).
  1497     05  EFFDTI PIC  X(0008).
  1498*    -------------------------------
  1499     05  CERTNOL PIC S9(0004) COMP.
  1500     05  CERTNOF PIC  X(0001).
  1501     05  FILLER REDEFINES CERTNOF.
  1502         10  CERTNOA PIC  X(0001).
  1503     05  CERTNOI PIC  X(0010).
  1504*    -------------------------------
  1505     05  SFXL PIC S9(0004) COMP.
  1506     05  SFXF PIC  X(0001).
  1507     05  FILLER REDEFINES SFXF.
  1508         10  SFXA PIC  X(0001).
  1509     05  SFXI PIC  X(0001).
  1510*    -------------------------------
  1511     05  SEQL PIC S9(0004) COMP.
  1512     05  SEQF PIC  X(0001).
  1513     05  FILLER REDEFINES SEQF.
  1514         10  SEQA PIC  X(0001).
  1515     05  SEQI PIC  99.
  1516*    -------------------------------
  1517     05  PAYTO1L PIC S9(0004) COMP.
  1518     05  PAYTO1F PIC  X(0001).
  1519     05  FILLER REDEFINES PAYTO1F.
  1520         10  PAYTO1A PIC  X(0001).
  1521     05  PAYTO1I PIC  X(0030).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  28
* EL677.cbl
  1522*    -------------------------------
  1523     05  CREATEDL PIC S9(0004) COMP.
  1524     05  CREATEDF PIC  X(0001).
  1525     05  FILLER REDEFINES CREATEDF.
  1526         10  CREATEDA PIC  X(0001).
  1527     05  CREATEDI PIC  X(0008).
  1528*    -------------------------------
  1529     05  CBYL PIC S9(0004) COMP.
  1530     05  CBYF PIC  X(0001).
  1531     05  FILLER REDEFINES CBYF.
  1532         10  CBYA PIC  X(0001).
  1533     05  CBYI PIC  X(0004).
  1534*    -------------------------------
  1535     05  PAYTO2L PIC S9(0004) COMP.
  1536     05  PAYTO2F PIC  X(0001).
  1537     05  FILLER REDEFINES PAYTO2F.
  1538         10  PAYTO2A PIC  X(0001).
  1539     05  PAYTO2I PIC  X(0030).
  1540*    -------------------------------
  1541     05  PAYEEL PIC S9(0004) COMP.
  1542     05  PAYEEF PIC  X(0001).
  1543     05  FILLER REDEFINES PAYEEF.
  1544         10  PAYEEA PIC  X(0001).
  1545     05  PAYEEI PIC  X(0006).
  1546*    -------------------------------
  1547     05  APVSTATL PIC S9(0004) COMP.
  1548     05  APVSTATF PIC  X(0001).
  1549     05  FILLER REDEFINES APVSTATF.
  1550         10  APVSTATA PIC  X(0001).
  1551     05  APVSTATI PIC  X(0009).
  1552*    -------------------------------
  1553     05  PAYAD1L PIC S9(0004) COMP.
  1554     05  PAYAD1F PIC  X(0001).
  1555     05  FILLER REDEFINES PAYAD1F.
  1556         10  PAYAD1A PIC  X(0001).
  1557     05  PAYAD1I PIC  X(0030).
  1558*    -------------------------------
  1559     05  APVDTL PIC S9(0004) COMP.
  1560     05  APVDTF PIC  X(0001).
  1561     05  FILLER REDEFINES APVDTF.
  1562         10  APVDTA PIC  X(0001).
  1563     05  APVDTI PIC  X(0008).
  1564*    -------------------------------
  1565     05  APVBYL PIC S9(0004) COMP.
  1566     05  APVBYF PIC  X(0001).
  1567     05  FILLER REDEFINES APVBYF.
  1568         10  APVBYA PIC  X(0001).
  1569     05  APVBYI PIC  X(0004).
  1570*    -------------------------------
  1571     05  PAYAD2L PIC S9(0004) COMP.
  1572     05  PAYAD2F PIC  X(0001).
  1573     05  FILLER REDEFINES PAYAD2F.
  1574         10  PAYAD2A PIC  X(0001).
  1575     05  PAYAD2I PIC  X(0030).
  1576*    -------------------------------
  1577     05  VOIDEDL PIC S9(0004) COMP.
  1578     05  VOIDEDF PIC  X(0001).
  1579     05  FILLER REDEFINES VOIDEDF.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  29
* EL677.cbl
  1580         10  VOIDEDA PIC  X(0001).
  1581     05  VOIDEDI PIC  X(0008).
  1582*    -------------------------------
  1583     05  VBYL PIC S9(0004) COMP.
  1584     05  VBYF PIC  X(0001).
  1585     05  FILLER REDEFINES VBYF.
  1586         10  VBYA PIC  X(0001).
  1587     05  VBYI PIC  X(0004).
  1588*    -------------------------------
  1589     05  PAYCTYL PIC S9(0004) COMP.
  1590     05  PAYCTYF PIC  X(0001).
  1591     05  FILLER REDEFINES PAYCTYF.
  1592         10  PAYCTYA PIC  X(0001).
  1593     05  PAYCTYI PIC  X(0028).
  1594*    -------------------------------
  1595     05  PAYSTL PIC S9(0004) COMP.
  1596     05  PAYSTF PIC  X(0001).
  1597     05  FILLER REDEFINES PAYSTF.
  1598         10  PAYSTA PIC  X(0001).
  1599     05  PAYSTI PIC  X(0002).
  1600*    -------------------------------
  1601     05  PRINTEDL PIC S9(0004) COMP.
  1602     05  PRINTEDF PIC  X(0001).
  1603     05  FILLER REDEFINES PRINTEDF.
  1604         10  PRINTEDA PIC  X(0001).
  1605     05  PRINTEDI PIC  X(0008).
  1606*    -------------------------------
  1607     05  PTOZIPL PIC S9(0004) COMP.
  1608     05  PTOZIPF PIC  X(0001).
  1609     05  FILLER REDEFINES PTOZIPF.
  1610         10  PTOZIPA PIC  X(0001).
  1611     05  PTOZIPI PIC  X(0009).
  1612*    -------------------------------
  1613     05  DEDCYNL PIC S9(0004) COMP.
  1614     05  DEDCYNF PIC  X(0001).
  1615     05  FILLER REDEFINES DEDCYNF.
  1616         10  DEDCYNA PIC  X(0001).
  1617     05  DEDCYNI PIC  X(0001).
  1618*    -------------------------------
  1619     05  CASHEDL PIC S9(0004) COMP.
  1620     05  CASHEDF PIC  X(0001).
  1621     05  FILLER REDEFINES CASHEDF.
  1622         10  CASHEDA PIC  X(0001).
  1623     05  CASHEDI PIC  X(0008).
  1624*    -------------------------------
  1625     05  RETTOL PIC S9(0004) COMP.
  1626     05  RETTOF PIC  X(0001).
  1627     05  FILLER REDEFINES RETTOF.
  1628         10  RETTOA PIC  X(0001).
  1629     05  RETTOI PIC  X(0030).
  1630*    -------------------------------
  1631     05  DPREML PIC S9(0004) COMP.
  1632     05  DPREMF PIC  X(0001).
  1633     05  FILLER REDEFINES DPREMF.
  1634         10  DPREMA PIC  X(0001).
  1635     05  DPREMI PIC  X(0005).
  1636*    -------------------------------
  1637     05  PREML PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  30
* EL677.cbl
  1638     05  PREMF PIC  X(0001).
  1639     05  FILLER REDEFINES PREMF.
  1640         10  PREMA PIC  X(0001).
  1641     05  PREMI PIC  X(0008).
  1642*    -------------------------------
  1643     05  DCOMML PIC S9(0004) COMP.
  1644     05  DCOMMF PIC  X(0001).
  1645     05  FILLER REDEFINES DCOMMF.
  1646         10  DCOMMA PIC  X(0001).
  1647     05  DCOMMI PIC  X(0005).
  1648*    -------------------------------
  1649     05  ISSCOMML PIC S9(0004) COMP.
  1650     05  ISSCOMMF PIC  X(0001).
  1651     05  FILLER REDEFINES ISSCOMMF.
  1652         10  ISSCOMMA PIC  X(0001).
  1653     05  ISSCOMMI PIC  X(0008).
  1654*    -------------------------------
  1655     05  DREFL PIC S9(0004) COMP.
  1656     05  DREFF PIC  X(0001).
  1657     05  FILLER REDEFINES DREFF.
  1658         10  DREFA PIC  X(0001).
  1659     05  DREFI PIC  X(0004).
  1660*    -------------------------------
  1661     05  REFL PIC S9(0004) COMP.
  1662     05  REFF PIC  X(0001).
  1663     05  FILLER REDEFINES REFF.
  1664         10  REFA PIC  X(0001).
  1665     05  REFI PIC  X(0008).
  1666*    -------------------------------
  1667     05  DUECOMML PIC S9(0004) COMP.
  1668     05  DUECOMMF PIC  X(0001).
  1669     05  FILLER REDEFINES DUECOMMF.
  1670         10  DUECOMMA PIC  X(0001).
  1671     05  DUECOMMI PIC  X(0007).
  1672*    -------------------------------
  1673     05  UECOMML PIC S9(0004) COMP.
  1674     05  UECOMMF PIC  X(0001).
  1675     05  FILLER REDEFINES UECOMMF.
  1676         10  UECOMMA PIC  X(0001).
  1677     05  UECOMMI PIC  X(0008).
  1678*    -------------------------------
  1679     05  DPREPDL PIC S9(0004) COMP.
  1680     05  DPREPDF PIC  X(0001).
  1681     05  FILLER REDEFINES DPREPDF.
  1682         10  DPREPDA PIC  X(0001).
  1683     05  DPREPDI PIC  X(0006).
  1684*    -------------------------------
  1685     05  PREPDL PIC S9(0004) COMP.
  1686     05  PREPDF PIC  X(0001).
  1687     05  FILLER REDEFINES PREPDF.
  1688         10  PREPDA PIC  X(0001).
  1689     05  PREPDI PIC  X(0008).
  1690*    -------------------------------
  1691     05  AMOUNTL PIC S9(0004) COMP.
  1692     05  AMOUNTF PIC  X(0001).
  1693     05  FILLER REDEFINES AMOUNTF.
  1694         10  AMOUNTA PIC  X(0001).
  1695     05  AMOUNTI PIC  S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  31
* EL677.cbl
  1696*    -------------------------------
  1697     05  CHECKL PIC S9(0004) COMP.
  1698     05  CHECKF PIC  X(0001).
  1699     05  FILLER REDEFINES CHECKF.
  1700         10  CHECKA PIC  X(0001).
  1701     05  CHECKI PIC  X(0007).
  1702*    -------------------------------
  1703     05  TYPEL PIC S9(0004) COMP.
  1704     05  TYPEF PIC  X(0001).
  1705     05  FILLER REDEFINES TYPEF.
  1706         10  TYPEA PIC  X(0001).
  1707     05  TYPEI PIC  X(0001).
  1708*    -------------------------------
  1709     05  REASONL PIC S9(0004) COMP.
  1710     05  REASONF PIC  X(0001).
  1711     05  FILLER REDEFINES REASONF.
  1712         10  REASONA PIC  X(0001).
  1713     05  REASONI PIC  X(0025).
  1714*    -------------------------------
  1715     05  VREASONL PIC S9(0004) COMP.
  1716     05  VREASONF PIC  X(0001).
  1717     05  FILLER REDEFINES VREASONF.
  1718         10  VREASONA PIC  X(0001).
  1719     05  VREASONI PIC  X(0024).
  1720*    -------------------------------
  1721     05  STUBL PIC S9(0004) COMP.
  1722     05  STUBF PIC  X(0001).
  1723     05  FILLER REDEFINES STUBF.
  1724         10  STUBA PIC  X(0001).
  1725     05  STUBI PIC  X(0030).
  1726*    -------------------------------
  1727     05  TEXT1L PIC S9(0004) COMP.
  1728     05  TEXT1F PIC  X(0001).
  1729     05  FILLER REDEFINES TEXT1F.
  1730         10  TEXT1A PIC  X(0001).
  1731     05  TEXT1I PIC  X(0050).
  1732*    -------------------------------
  1733     05  TEXT2L PIC S9(0004) COMP.
  1734     05  TEXT2F PIC  X(0001).
  1735     05  FILLER REDEFINES TEXT2F.
  1736         10  TEXT2A PIC  X(0001).
  1737     05  TEXT2I PIC  X(0050).
  1738*    -------------------------------
  1739     05  TEXT3L PIC S9(0004) COMP.
  1740     05  TEXT3F PIC  X(0001).
  1741     05  FILLER REDEFINES TEXT3F.
  1742         10  TEXT3A PIC  X(0001).
  1743     05  TEXT3I PIC  X(0040).
  1744*    -------------------------------
  1745     05  ERRMSG1L PIC S9(0004) COMP.
  1746     05  ERRMSG1F PIC  X(0001).
  1747     05  FILLER REDEFINES ERRMSG1F.
  1748         10  ERRMSG1A PIC  X(0001).
  1749     05  ERRMSG1I PIC  X(0079).
  1750*    -------------------------------
  1751     05  ERRMSG2L PIC S9(0004) COMP.
  1752     05  ERRMSG2F PIC  X(0001).
  1753     05  FILLER REDEFINES ERRMSG2F.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  32
* EL677.cbl
  1754         10  ERRMSG2A PIC  X(0001).
  1755     05  ERRMSG2I PIC  X(0079).
  1756*    -------------------------------
  1757     05  PFENTERL PIC S9(0004) COMP.
  1758     05  PFENTERF PIC  X(0001).
  1759     05  FILLER REDEFINES PFENTERF.
  1760         10  PFENTERA PIC  X(0001).
  1761     05  PFENTERI PIC  9(2).
  1762*    -------------------------------
  1763     05  PF357L PIC S9(0004) COMP.
  1764     05  PF357F PIC  X(0001).
  1765     05  FILLER REDEFINES PF357F.
  1766         10  PF357A PIC  X(0001).
  1767     05  PF357I PIC  X(0050).
  1768*    -------------------------------
  1769     05  PF46L PIC S9(0004) COMP.
  1770     05  PF46F PIC  X(0001).
  1771     05  FILLER REDEFINES PF46F.
  1772         10  PF46A PIC  X(0001).
  1773     05  PF46I PIC  X(0033).
  1774 01  EL677AO REDEFINES EL677AI.
  1775     05  FILLER            PIC  X(0012).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  DATEO PIC  X(0008).
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  TIMEO PIC  99.99.
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  MAINTO PIC  X(0001).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  DMAINT1O PIC  X(0009).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  DMAINT2O PIC  X(0029).
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  CARRIERO PIC  X(0001).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  GROUPO PIC  X(0006).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  STATEO PIC  X(0002).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  ACCTO PIC  X(0010).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  EFFDTO PIC  99B99B99.
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  CERTNOO PIC  X(0010).
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  SFXO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  33
* EL677.cbl
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  SEQO PIC  99.
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  PAYTO1O PIC  X(0030).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  CREATEDO PIC  X(0008).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  CBYO PIC  X(0004).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  PAYTO2O PIC  X(0030).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  PAYEEO PIC  X(0006).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  APVSTATO PIC  X(0009).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  PAYAD1O PIC  X(0030).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  APVDTO PIC  X(0008).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  APVBYO PIC  X(0004).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  PAYAD2O PIC  X(0030).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  VOIDEDO PIC  X(0008).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  VBYO PIC  X(0004).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  PAYCTYO PIC  X(0028).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  PAYSTO PIC  X(0002).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  PRINTEDO PIC  99B99B99.
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  PTOZIPO PIC  X(0009).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  DEDCYNO PIC  X(0001).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  CASHEDO PIC  X(0008).
  1869*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  34
* EL677.cbl
  1870     05  FILLER            PIC  X(0003).
  1871     05  RETTOO PIC  X(0030).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  DPREMO PIC  X(0005).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  PREMO PIC  Z(5).99.
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  DCOMMO PIC  X(0005).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  ISSCOMMO PIC  Z(5).99.
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  DREFO PIC  X(0004).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  REFO PIC  Z(5).99.
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  DUECOMMO PIC  X(0007).
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  UECOMMO PIC  Z(5).99.
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  DPREPDO PIC  X(0006).
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  PREPDO PIC  Z(5).99.
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  AMOUNTO PIC  Z(7).ZZ-.
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  CHECKO PIC  X(0007).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  TYPEO PIC  X(0001).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  REASONO PIC  X(0025).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  VREASONO PIC  X(0024).
  1917*    -------------------------------
  1918     05  FILLER            PIC  X(0003).
  1919     05  STUBO PIC  X(0030).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  TEXT1O PIC  X(0050).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  TEXT2O PIC  X(0050).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  35
* EL677.cbl
  1928     05  TEXT3O PIC  X(0040).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  ERRMSG1O PIC  X(0079).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  ERRMSG2O PIC  X(0079).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  PFENTERO PIC  99.
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  PF357O PIC  X(0050).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  PF46O PIC  X(0033).
  1944*    -------------------------------
  1945****************************************************************
  1946*
  1947* Copyright (c) 2007-2013 Dell Inc.
  1948* All rights reserved.
  1949*
  1950****************************************************************
  1951 01  DFHEIV.
  1952   02  DFHEIV0               PIC X(35).
  1953   02  DFHEIV1               PIC X(08).
  1954   02  DFHEIV2               PIC X(08).
  1955   02  DFHEIV3               PIC X(08).
  1956   02  DFHEIV4               PIC X(06).
  1957   02  DFHEIV5               PIC X(04).
  1958   02  DFHEIV6               PIC X(04).
  1959   02  DFHEIV7               PIC X(02).
  1960   02  DFHEIV8               PIC X(02).
  1961   02  DFHEIV9               PIC X(01).
  1962   02  DFHEIV10              PIC S9(7) COMP-3.
  1963   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1964   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1965   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1966   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1967   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1968   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1969   02  DFHEIV17              PIC X(04).
  1970   02  DFHEIV18              PIC X(04).
  1971   02  DFHEIV19              PIC X(04).
  1972   02  DFHEIV20              USAGE IS POINTER.
  1973   02  DFHEIV21              USAGE IS POINTER.
  1974   02  DFHEIV22              USAGE IS POINTER.
  1975   02  DFHEIV23              USAGE IS POINTER.
  1976   02  DFHEIV24              USAGE IS POINTER.
  1977   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1978   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1979   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1980   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1981   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1982   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1983   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1984   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1985   02  DFHEIV33              PIC S9(4) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  36
* EL677.cbl
  1986   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1987   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1988   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1989   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1990   02  FILLER                PIC X(02).
  1991   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1992   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1993   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1994   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1995   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1996   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1997   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1998 LINKAGE  SECTION.
  1999*****************************************************************
  2000*                                                               *
  2001* Copyright (c) 2007-2013 Dell Inc.                             *
  2002* All rights reserved.                                          *
  2003*                                                               *
  2004*****************************************************************
  2005 01  dfheiblk.
  2006     02  eibtime          pic s9(7) comp-3.
  2007     02  eibdate          pic s9(7) comp-3.
  2008     02  eibtrnid         pic x(4).
  2009     02  eibtaskn         pic s9(7) comp-3.
  2010     02  eibtrmid         pic x(4).
  2011     02  dfheigdi         pic s9(4) comp.
  2012     02  eibcposn         pic s9(4) comp.
  2013     02  eibcalen         pic s9(4) comp.
  2014     02  eibaid           pic x(1).
  2015     02  eibfiller1       pic x(1).
  2016     02  eibfn            pic x(2).
  2017     02  eibfiller2       pic x(2).
  2018     02  eibrcode         pic x(6).
  2019     02  eibfiller3       pic x(2).
  2020     02  eibds            pic x(8).
  2021     02  eibreqid         pic x(8).
  2022     02  eibrsrce         pic x(8).
  2023     02  eibsync          pic x(1).
  2024     02  eibfree          pic x(1).
  2025     02  eibrecv          pic x(1).
  2026     02  eibsend          pic x(1).
  2027     02  eibatt           pic x(1).
  2028     02  eibeoc           pic x(1).
  2029     02  eibfmh           pic x(1).
  2030     02  eibcompl         pic x(1).
  2031     02  eibsig           pic x(1).
  2032     02  eibconf          pic x(1).
  2033     02  eiberr           pic x(1).
  2034     02  eibrldbk         pic x(1).
  2035     02  eiberrcd         pic x(4).
  2036     02  eibsynrb         pic x(1).
  2037     02  eibnodat         pic x(1).
  2038     02  eibfiller5       pic x(2).
  2039     02  eibresp          pic s9(8) comp.
  2040     02  eibresp2         pic s9(8) comp.
  2041     02  dfheigdj         pic s9(4) comp.
  2042     02  dfheigdk         pic s9(4) comp.
  2043 01  DFHCOMMAREA.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  37
* EL677.cbl
  2044     05  filler                  PIC X(1024).
  2045 01  var  pic x(30).
  2046*                                    COPY ELCCNTL.
  2047******************************************************************
  2048*                                                                *
  2049*                                                                *
  2050*                            ELCCNTL.                            *
  2051*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2052*                            VMOD=2.059                          *
  2053*                                                                *
  2054*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2055*                                                                *
  2056*   FILE TYPE = VSAM,KSDS                                        *
  2057*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2058*                                                                *
  2059*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2060*       ALTERNATE INDEX = NONE                                   *
  2061*                                                                *
  2062*   LOG = YES                                                    *
  2063*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2064******************************************************************
  2065*                   C H A N G E   L O G
  2066*
  2067* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2068*-----------------------------------------------------------------
  2069*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2070* EFFECTIVE    NUMBER
  2071*-----------------------------------------------------------------
  2072* 082503                   PEMA  ADD BENEFIT GROUP
  2073* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2074* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2075* 092705    2005050300006  PEMA  ADD SPP LEASES
  2076* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2077* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2078* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2079* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2080* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2081* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2082* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2083* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2084* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2085* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2086******************************************************************
  2087*
  2088 01  CONTROL-FILE.
  2089     12  CF-RECORD-ID                       PIC XX.
  2090         88  VALID-CF-ID                        VALUE 'CF'.
  2091
  2092     12  CF-CONTROL-PRIMARY.
  2093         16  CF-COMPANY-ID                  PIC XXX.
  2094         16  CF-RECORD-TYPE                 PIC X.
  2095             88  CF-COMPANY-MASTER              VALUE '1'.
  2096             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2097             88  CF-STATE-MASTER                VALUE '3'.
  2098             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2099             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2100             88  CF-CARRIER-MASTER              VALUE '6'.
  2101             88  CF-MORTALITY-MASTER            VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  38
* EL677.cbl
  2102             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2103             88  CF-TERMINAL-MASTER             VALUE '9'.
  2104             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2105             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2106             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2107             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2108             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2109             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2110             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2111             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2112             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2113         16  CF-ACCESS-CD-GENL              PIC X(4).
  2114         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2115             20  CF-PROCESSOR               PIC X(4).
  2116         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2117             20  CF-STATE-CODE              PIC XX.
  2118             20  FILLER                     PIC XX.
  2119         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2120             20  FILLER                     PIC XX.
  2121             20  CF-HI-BEN-IN-REC           PIC XX.
  2122         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2123             20  FILLER                     PIC XXX.
  2124             20  CF-CARRIER-CNTL            PIC X.
  2125         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2126             20  FILLER                     PIC XX.
  2127             20  CF-HI-TYPE-IN-REC          PIC 99.
  2128         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2129             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2130                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2131             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2132             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2133         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2134             20  FILLER                     PIC X.
  2135             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2136         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2137             20  FILLER                     PIC XX.
  2138             20  CF-MORTGAGE-PLAN           PIC XX.
  2139         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2140
  2141     12  CF-LAST-MAINT-DT                   PIC XX.
  2142     12  CF-LAST-MAINT-BY                   PIC X(4).
  2143     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2144
  2145     12  CF-RECORD-BODY                     PIC X(728).
  2146
  2147
  2148****************************************************************
  2149*             COMPANY MASTER RECORD                            *
  2150****************************************************************
  2151
  2152     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2153         16  CF-COMPANY-ADDRESS.
  2154             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2155             20  CF-CL-IN-CARE-OF           PIC X(30).
  2156             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2157             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2158             20  CF-CL-CITY-STATE           PIC X(30).
  2159             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  39
* EL677.cbl
  2160             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2161         16  CF-COMPANY-CD                  PIC X.
  2162         16  CF-COMPANY-PASSWORD            PIC X(8).
  2163         16  CF-SECURITY-OPTION             PIC X.
  2164             88  ALL-SECURITY                   VALUE '1'.
  2165             88  COMPANY-VERIFY                 VALUE '2'.
  2166             88  PROCESSOR-VERIFY               VALUE '3'.
  2167             88  NO-SECURITY                    VALUE '4'.
  2168             88  ALL-BUT-TERM                   VALUE '5'.
  2169         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2170             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2171         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2172             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2173         16  CF-INFORCE-LOCATION            PIC X.
  2174             88  CERTS-ARE-ONLINE               VALUE '1'.
  2175             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2176             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2177         16  CF-LOWER-CASE-LETTERS          PIC X.
  2178         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2179             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2180             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2181             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2182             88  CF-ACCNT-CNTL                  VALUE '3'.
  2183             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2184
  2185         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2186         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2187
  2188         16  CF-LGX-CREDIT-USER             PIC X.
  2189             88  CO-IS-NOT-USER                 VALUE 'N'.
  2190             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2191
  2192         16 CF-CREDIT-CALC-CODES.
  2193             20  CF-CR-REM-TERM-CALC PIC X.
  2194               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2195               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2196               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2197               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2198               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2199               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2200               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2201             20  CF-CR-R78-METHOD           PIC X.
  2202               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2203               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2204
  2205         16  CF-CLAIM-CONTROL-COUNTS.
  2206             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2207                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2208
  2209             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2210                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2211
  2212             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2213                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2214
  2215             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2216                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2217
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  40
* EL677.cbl
  2218         16  CF-CURRENT-MONTH-END           PIC XX.
  2219
  2220         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2221             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2222             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2223             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2224             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2225                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2226                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2227             20  CF-CO-PREM-REJECT-SW       PIC X.
  2228                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2229                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2230             20  CF-CO-REF-REJECT-SW        PIC X.
  2231                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2232                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2233
  2234         16  CF-CO-REPORTING-DT             PIC XX.
  2235         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2236         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2237           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2238           88  CF-CO-MONTH-END                  VALUE '1'.
  2239
  2240         16  CF-LGX-CLAIM-USER              PIC X.
  2241             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2242             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2243
  2244         16  CF-CREDIT-EDIT-CONTROLS.
  2245             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2246             20  CF-MIN-AGE                 PIC 99.
  2247             20  CF-DEFAULT-AGE             PIC 99.
  2248             20  CF-MIN-TERM                PIC S999      COMP-3.
  2249             20  CF-MAX-TERM                PIC S999      COMP-3.
  2250             20  CF-DEFAULT-SEX             PIC X.
  2251             20  CF-JOINT-AGE-INPUT         PIC X.
  2252                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2253             20  CF-BIRTH-DATE-INPUT        PIC X.
  2254                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2255             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2256                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2257                 88  CF-ZERO-CARRIER            VALUE '1'.
  2258                 88  CF-ZERO-GROUPING           VALUE '2'.
  2259                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2260             20  CF-EDIT-SW                 PIC X.
  2261                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2262             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2263             20  CF-CR-PR-METHOD            PIC X.
  2264               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2265               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2266             20  FILLER                     PIC X.
  2267
  2268         16  CF-CREDIT-MISC-CONTROLS.
  2269             20  CF-REIN-TABLE-SW           PIC X.
  2270                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2271             20  CF-COMP-TABLE-SW           PIC X.
  2272                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2273             20  CF-EXPERIENCE-RETENTION-AGE
  2274                                            PIC S9        COMP-3.
  2275             20  CF-CONVERSION-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  41
* EL677.cbl
  2276             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2277             20  CF-RUN-FREQUENCY-SW        PIC X.
  2278                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2279                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2280
  2281             20  CF-CR-CHECK-NO-CONTROL.
  2282                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2283                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2284                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2285                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2286                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2287                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2288
  2289                 24  CF-CR-CHECK-COUNT       REDEFINES
  2290                     CF-CR-CHECK-COUNTER      PIC X(4).
  2291
  2292                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2293                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2294
  2295                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2296                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2297                 24  CF-MAIL-PROCESSING       PIC X.
  2298                     88  MAIL-PROCESSING          VALUE 'Y'.
  2299
  2300         16  CF-MISC-SYSTEM-CONTROL.
  2301             20  CF-SYSTEM-C                 PIC X.
  2302                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2303             20  CF-SYSTEM-D                 PIC X.
  2304                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2305             20  CF-SOC-SEC-NO-SW            PIC X.
  2306                 88  SOC-SEC-NO-USED             VALUE '1'.
  2307             20  CF-MEMBER-NO-SW             PIC X.
  2308                 88  MEMBER-NO-USED              VALUE '1'.
  2309             20  CF-TAX-ID-NUMBER            PIC X(11).
  2310             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2311             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2312                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2313                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2314                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2315                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2316             20  CF-SYSTEM-E                 PIC X.
  2317                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2318
  2319         16  CF-LGX-LIFE-USER               PIC X.
  2320             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2321             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2322
  2323         16  CF-CR-MONTH-END-DT             PIC XX.
  2324
  2325         16  CF-FILE-MAINT-DATES.
  2326             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2327                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2328             20  CF-LAST-BATCH       REDEFINES
  2329                 CF-LAST-BATCH-NO               PIC X(4).
  2330             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2331             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2332             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2333             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  42
* EL677.cbl
  2334             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2335             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2336             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2337             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2338             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2339             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2340
  2341         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2342         16  FILLER                         PIC X.
  2343
  2344         16  CF-ALT-MORT-CODE               PIC X(4).
  2345         16  CF-MEMBER-CAPTION              PIC X(10).
  2346
  2347         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2348             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2349             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2350             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2351             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2352             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2353
  2354         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2355
  2356         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2357         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2358         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2359         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2360
  2361         16  CF-AH-OVERRIDE-L1              PIC X.
  2362         16  CF-AH-OVERRIDE-L2              PIC XX.
  2363         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2364         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2365
  2366         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2367         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2368
  2369         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2370         16  CF-AR-LAST-EL860-DT            PIC XX.
  2371         16  CF-MP-MONTH-END-DT             PIC XX.
  2372
  2373         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2374         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2375             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2376
  2377         16  CF-AR-MONTH-END-DT             PIC XX.
  2378
  2379         16  CF-CRDTCRD-USER                PIC X.
  2380             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2381             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2382
  2383         16  CF-CC-MONTH-END-DT             PIC XX.
  2384
  2385         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2386
  2387         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2388             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2389             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2390             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2391         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  43
* EL677.cbl
  2392         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2393         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2394         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2395             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2396             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2397         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2398         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2399         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2400             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2401         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2402
  2403         16  CF-CL-ZIP-CODE.
  2404             20  CF-CL-ZIP-PRIME.
  2405                 24  CF-CL-ZIP-1ST          PIC X.
  2406                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2407                 24  FILLER                 PIC X(4).
  2408             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2409         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2410             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2411             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2412             20  FILLER                     PIC XXX.
  2413
  2414         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2415         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2416         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2417         16  CF-CO-OPTION-START-DATE        PIC XX.
  2418         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2419           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2420                                                      '3' '4'.
  2421           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2422           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2423           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2424           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2425           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2426           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2427
  2428         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2429
  2430         16  CF-PAYMENT-APPROVAL-LEVELS.
  2431             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2432             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2433             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2434             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2435             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2436             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2437
  2438         16  CF-END-USER-REPORTING-USER     PIC X.
  2439             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2440             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2441
  2442         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2443             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2444             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2445
  2446         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2447
  2448         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2449         16  FILLER                         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  44
* EL677.cbl
  2450
  2451         16  CF-CREDIT-ARCHIVE-CNTL.
  2452             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2453             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2454             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2455
  2456         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2457
  2458         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2459             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2460             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2461
  2462         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2463             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2464             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2465
  2466         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2467
  2468         16  CF-CO-ACH-ID-CODE              PIC  X.
  2469             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2470             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2471             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2472         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2473         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2474         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2475         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2476         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2477         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2478         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2479         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2480         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2481                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2482         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2483                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2484
  2485         16  CF-CO-OVER-SHORT.
  2486             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2487             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2488
  2489*         16  FILLER                         PIC X(102).
  2490         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2491             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2492             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2493
  2494         16  CF-AH-APPROVAL-DAYS.
  2495             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2496             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2497             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2498             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2499
  2500         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2501
  2502         16  CF-APPROV-LEV-5.
  2503             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2504             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2505             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2506
  2507         16  FILLER                         PIC X(68).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  45
* EL677.cbl
  2508****************************************************************
  2509*             PROCESSOR/USER RECORD                            *
  2510****************************************************************
  2511
  2512     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2513         16  CF-PROCESSOR-NAME              PIC X(30).
  2514         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2515         16  CF-PROCESSOR-TITLE             PIC X(26).
  2516         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2517                 88  MESSAGE-YES                VALUE 'Y'.
  2518                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2519
  2520*****************************************************
  2521****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2522****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2523****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2524****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2525*****************************************************
  2526
  2527         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2528             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2529             20  CF-APPLICATION-FORCE       PIC X.
  2530             20  CF-INDIVIDUAL-APP.
  2531                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2532                     28  CF-BROWSE-APP      PIC X.
  2533                     28  CF-UPDATE-APP      PIC X.
  2534
  2535         16  CF-CURRENT-TERM-ON             PIC X(4).
  2536         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2537             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2538             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2539             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2540             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2541             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2542             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2543             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2544         16  CF-PROCESSOR-CARRIER           PIC X.
  2545             88  NO-CARRIER-SECURITY            VALUE ' '.
  2546         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2547             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2548         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2549             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2550         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2551             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2552
  2553         16  CF-PROC-SYS-ACCESS-SW.
  2554             20  CF-PROC-CREDIT-CLAIMS-SW.
  2555                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2556                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2557                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2558                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2559             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2560                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2561                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2562             20  CF-PROC-LIFE-GNRLDGR-SW.
  2563                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2564                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2565                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  46
* EL677.cbl
  2566                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2567             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2568                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2569                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2570         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2571             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2572             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2573         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2574
  2575         16  CF-APPROVAL-LEVEL                  PIC X.
  2576             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2577             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2578             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2579             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2580             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2581
  2582         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2583
  2584         16  CF-LANGUAGE-TYPE                   PIC X.
  2585             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2586             88  CF-LANG-IS-FR                      VALUE 'F'.
  2587
  2588         16  CF-CSR-IND                         PIC X.
  2589         16  FILLER                             PIC X(239).
  2590
  2591****************************************************************
  2592*             PROCESSOR/REMINDERS RECORD                       *
  2593****************************************************************
  2594
  2595     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2596         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2597             20  CF-START-REMIND-DT         PIC XX.
  2598             20  CF-END-REMIND-DT           PIC XX.
  2599             20  CF-REMINDER-TEXT           PIC X(50).
  2600         16  FILLER                         PIC X(296).
  2601
  2602
  2603****************************************************************
  2604*             STATE MASTER RECORD                              *
  2605****************************************************************
  2606
  2607     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2608         16  CF-STATE-ABBREVIATION          PIC XX.
  2609         16  CF-STATE-NAME                  PIC X(25).
  2610         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2611         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2612             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2613             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2614             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2615             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2616                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2617                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2618             20  CF-ST-PREM-REJECT-SW       PIC X.
  2619                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2620                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2621             20  CF-ST-REF-REJECT-SW        PIC X.
  2622                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2623                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  47
* EL677.cbl
  2624         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2625         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2626         16  CF-ST-REFUND-RULES.
  2627             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2628             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2629             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2630         16  CF-ST-FST-PMT-EXTENSION.
  2631             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2632             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2633                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2634                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2635                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2636                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2637         16  CF-ST-STATE-CALL.
  2638             20  CF-ST-CALL-UNEARNED        PIC X.
  2639             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2640             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2641         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2642             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2643             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2644         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2645         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2646         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2647         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2648         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2649         16  FILLER                         PIC X.
  2650         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2651             20  CF-ST-BENEFIT-CD           PIC XX.
  2652             20  CF-ST-BENEFIT-KIND         PIC X.
  2653                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2654                 88  CF-ST-AH-KIND              VALUE 'A'.
  2655             20  CF-ST-REM-TERM-CALC        PIC X.
  2656                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2657                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2658                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2659                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2660                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2661                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2662                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2663                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2664
  2665             20  CF-ST-REFUND-CALC          PIC X.
  2666                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2667                 88  ST-REFD-BY-R78             VALUE '1'.
  2668                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2669                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2670                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2671                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2672                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2673                 88  ST-REFD-UTAH               VALUE '7'.
  2674                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2675                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2676                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2677
  2678             20  CF-ST-EARNING-CALC         PIC X.
  2679                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2680                 88  ST-EARN-BY-R78             VALUE '1'.
  2681                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  48
* EL677.cbl
  2682                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2683                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2684                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2685                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2686                 88  ST-EARN-MEAN               VALUE '8'.
  2687                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2688
  2689             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2690                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2691                 88  ST-OVRD-BY-R78             VALUE '1'.
  2692                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2693                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2694                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2695                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2696                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2697                 88  ST-OVRD-MEAN               VALUE '8'.
  2698                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2699             20  cf-st-extra-periods        pic 9.
  2700*            20  FILLER                     PIC X.
  2701
  2702         16  CF-ST-COMMISSION-CAPS.
  2703             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2704             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2705             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2706             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2707         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2708                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2709
  2710         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2711
  2712         16  CF-ST-STATUTORY-INTEREST.
  2713             20  CF-ST-STAT-DATE-FROM       PIC X.
  2714                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2715                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2716             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2717             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2718             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2719             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2720             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2721
  2722         16  CF-ST-OVER-SHORT.
  2723             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2724             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2725
  2726         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2727
  2728         16  CF-ST-RT-CALC                  PIC X.
  2729
  2730         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2731         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2732         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2733         16  CF-ST-RF-LR-CALC               PIC X.
  2734         16  CF-ST-RF-LL-CALC               PIC X.
  2735         16  CF-ST-RF-LN-CALC               PIC X.
  2736         16  CF-ST-RF-AH-CALC               PIC X.
  2737         16  CF-ST-RF-CP-CALC               PIC X.
  2738*        16  FILLER                         PIC X(206).
  2739*CIDMOD         16  FILLER                         PIC X(192).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  49
* EL677.cbl
  2740         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2741             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2742         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2743         16  CF-ST-VFY-2ND-BENE             PIC X.
  2744         16  CF-ST-CAUSAL-STATE             PIC X.
  2745         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2746         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2747         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2748             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2749         16  CF-ST-NET-ONLY-STATE           PIC X.
  2750             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2751         16  FILLER                         PIC X(181).
  2752
  2753****************************************************************
  2754*             BENEFIT MASTER RECORD                            *
  2755****************************************************************
  2756
  2757     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2758         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2759             20  CF-BENEFIT-CODE            PIC XX.
  2760             20  CF-BENEFIT-NUMERIC  REDEFINES
  2761                 CF-BENEFIT-CODE            PIC XX.
  2762             20  CF-BENEFIT-ALPHA           PIC XXX.
  2763             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2764             20  CF-BENEFIT-COMMENT         PIC X(10).
  2765
  2766             20  CF-LF-COVERAGE-TYPE        PIC X.
  2767                 88  CF-REDUCING                VALUE 'R'.
  2768                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2769
  2770             20  CF-SPECIAL-CALC-CD         PIC X.
  2771                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2772                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2773                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2774                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2775                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2776                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2777                 88  CF-FARM-PLAN               VALUE 'F'.
  2778                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2779                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2780                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2781                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2782                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2783                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2784                 88  CF-PRUDENTIAL              VALUE 'P'.
  2785                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2786                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2787                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2788                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2789                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2790                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2791
  2792             20  CF-JOINT-INDICATOR         PIC X.
  2793                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2794
  2795*            20  FILLER                     PIC X(12).
  2796             20  cf-maximum-benefits        pic s999 comp-3.
  2797             20  FILLER                     PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  50
* EL677.cbl
  2798             20  CF-BENEFIT-CATEGORY        PIC X.
  2799             20  CF-LOAN-TYPE               PIC X(8).
  2800
  2801             20  CF-CO-REM-TERM-CALC        PIC X.
  2802                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2803                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2804                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2805                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2806                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2807
  2808             20  CF-CO-EARNINGS-CALC        PIC X.
  2809                 88  CO-EARN-BY-R78             VALUE '1'.
  2810                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2811                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2812                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2813                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2814                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2815                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2816                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2817
  2818             20  CF-CO-REFUND-CALC          PIC X.
  2819                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2820                 88  CO-REFD-BY-R78             VALUE '1'.
  2821                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2822                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2823                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2824                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2825                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2826                 88  CO-REFD-MEAN               VALUE '8'.
  2827                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2828                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2829                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2830
  2831             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2832                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2833                 88  CO-OVRD-BY-R78             VALUE '1'.
  2834                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2835                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2836                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2837                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2838                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2839                 88  CO-OVRD-MEAN               VALUE '8'.
  2840                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2841
  2842             20  CF-CO-BEN-I-G-CD           PIC X.
  2843                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2844                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2845                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2846
  2847         16  FILLER                         PIC X(304).
  2848
  2849
  2850****************************************************************
  2851*             CARRIER MASTER RECORD                            *
  2852****************************************************************
  2853
  2854     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2855         16  CF-ADDRESS-DATA.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  51
* EL677.cbl
  2856             20  CF-MAIL-TO-NAME            PIC X(30).
  2857             20  CF-IN-CARE-OF              PIC X(30).
  2858             20  CF-ADDRESS-LINE-1          PIC X(30).
  2859             20  CF-ADDRESS-LINE-2          PIC X(30).
  2860             20  CF-CITY-STATE              PIC X(30).
  2861             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2862             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2863
  2864         16  CF-CLAIM-NO-CONTROL.
  2865             20  CF-CLAIM-NO-METHOD         PIC X.
  2866                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2867                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2868                 88  CLAIM-NO-SEQ               VALUE '3'.
  2869                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2870             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2871                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2872                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2873                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2874
  2875         16  CF-CHECK-NO-CONTROL.
  2876             20  CF-CHECK-NO-METHOD         PIC X.
  2877                 88  CHECK-NO-MANUAL            VALUE '1'.
  2878                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2879                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2880                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2881             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2882                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2883
  2884         16  CF-DOMICILE-STATE              PIC XX.
  2885
  2886         16  CF-EXPENSE-CONTROLS.
  2887             20  CF-EXPENSE-METHOD          PIC X.
  2888                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2889                 88  DOLLARS-PER-PMT            VALUE '2'.
  2890                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2891                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2892             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2893             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2894
  2895         16  CF-CORRESPONDENCE-CONTROL.
  2896             20  CF-LETTER-RESEND-OPT       PIC X.
  2897                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2898                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2899             20  FILLER                     PIC X(4).
  2900
  2901         16  CF-RESERVE-CONTROLS.
  2902             20  CF-MANUAL-SW               PIC X.
  2903                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2904             20  CF-FUTURE-SW               PIC X.
  2905                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2906             20  CF-PTC-SW                  PIC X.
  2907                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2908             20  CF-IBNR-SW                 PIC X.
  2909                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2910             20  CF-PTC-LF-SW               PIC X.
  2911                 88  CF-LF-PTC-USED             VALUE '1'.
  2912             20  CF-CDT-ACCESS-METHOD       PIC X.
  2913                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  52
* EL677.cbl
  2914                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2915                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2916             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2917
  2918         16  CF-CLAIM-CALC-METHOD           PIC X.
  2919             88  360-PLUS-MONTHS                VALUE '1'.
  2920             88  365-PLUS-MONTHS                VALUE '2'.
  2921             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2922             88  360-DAILY                      VALUE '4'.
  2923             88  365-DAILY                      VALUE '5'.
  2924
  2925         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2926         16  FILLER                         PIC X(11).
  2927
  2928         16  CF-LIMIT-AMOUNTS.
  2929             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2930             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2931             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2932             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2933             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2934             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2935             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2936             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2937             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2938             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2939
  2940         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2941         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2942         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2943
  2944         16  CF-ZIP-CODE.
  2945             20  CF-ZIP-PRIME.
  2946                 24  CF-ZIP-1ST             PIC X.
  2947                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2948                 24  FILLER                 PIC X(4).
  2949             20  CF-ZIP-PLUS4               PIC X(4).
  2950         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2951             20  CF-CAN-POSTAL-1            PIC XXX.
  2952             20  CF-CAN-POSTAL-2            PIC XXX.
  2953             20  FILLER                     PIC XXX.
  2954
  2955         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2956         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2957         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2958
  2959         16  CF-RATING-SWITCH               PIC X.
  2960             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2961             88  CF-NO-RATING                   VALUE 'N'.
  2962
  2963         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2964
  2965         16  CF-CARRIER-OVER-SHORT.
  2966             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2967             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2968
  2969         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2970         16  CF-SECPAY-SWITCH               PIC X.
  2971             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  53
* EL677.cbl
  2972             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2973         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2974         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2975         16  FILLER                         PIC X(444).
  2976*        16  FILLER                         PIC X(452).
  2977
  2978
  2979****************************************************************
  2980*             MORTALITY MASTER RECORD                          *
  2981****************************************************************
  2982
  2983     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2984         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2985                                INDEXED BY CF-MORT-NDX.
  2986             20  CF-MORT-TABLE              PIC X(5).
  2987             20  CF-MORT-TABLE-TYPE         PIC X.
  2988                 88  CF-MORT-JOINT              VALUE 'J'.
  2989                 88  CF-MORT-SINGLE             VALUE 'S'.
  2990                 88  CF-MORT-COMBINED           VALUE 'C'.
  2991                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2992                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2993             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2994             20  CF-MORT-AGE-METHOD         PIC XX.
  2995                 88  CF-AGE-LAST                VALUE 'AL'.
  2996                 88  CF-AGE-NEAR                VALUE 'AN'.
  2997             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2998             20  CF-MORT-ADJUSTMENT-DIRECTION
  2999                                            PIC X.
  3000                 88  CF-MINUS                   VALUE '-'.
  3001                 88  CF-PLUS                    VALUE '+'.
  3002             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3003             20  CF-MORT-JOINT-CODE         PIC X.
  3004                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3005             20  CF-MORT-PC-Q               PIC X.
  3006                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3007             20  CF-MORT-TABLE-CODE         PIC X(4).
  3008             20  CF-MORT-COMMENTS           PIC X(15).
  3009             20  FILLER                     PIC X(14).
  3010
  3011         16  FILLER                         PIC X(251).
  3012
  3013
  3014****************************************************************
  3015*             BUSSINESS TYPE MASTER RECORD                     *
  3016****************************************************************
  3017
  3018     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3019* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3020* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3021* AND RECORD 05 IS TYPES 81-99
  3022         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3023             20  CF-BUSINESS-TITLE          PIC  X(19).
  3024             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3025                                            PIC S9V9(4) COMP-3.
  3026             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3027             20  FILLER                     PIC  X.
  3028         16  FILLER                         PIC  X(248).
  3029
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  54
* EL677.cbl
  3030
  3031****************************************************************
  3032*             TERMINAL MASTER RECORD                           *
  3033****************************************************************
  3034
  3035     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3036
  3037         16  CF-COMPANY-TERMINALS.
  3038             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3039                                  PIC X(4).
  3040         16  FILLER               PIC X(248).
  3041
  3042
  3043****************************************************************
  3044*             LIFE EDIT MASTER RECORD                          *
  3045****************************************************************
  3046
  3047     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3048         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3049             20  CF-LIFE-CODE-IN            PIC XX.
  3050             20  CF-LIFE-CODE-OUT           PIC XX.
  3051         16  FILLER                         PIC X(248).
  3052
  3053
  3054****************************************************************
  3055*             AH EDIT MASTER RECORD                            *
  3056****************************************************************
  3057
  3058     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3059         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3060             20  CF-AH-CODE-IN              PIC XXX.
  3061             20  CF-AH-CODE-OUT             PIC XX.
  3062         16  FILLER                         PIC X(248).
  3063
  3064
  3065****************************************************************
  3066*             CREDIBILITY TABLES                               *
  3067****************************************************************
  3068
  3069     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3070         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3071                             INDEXED BY CF-CRDB-NDX.
  3072             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3073             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3074             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3075         16  FILLER                         PIC  X(332).
  3076
  3077
  3078****************************************************************
  3079*             REPORT CUSTOMIZATION RECORD                      *
  3080****************************************************************
  3081
  3082     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3083         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3084             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3085             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3086             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3087**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  55
* EL677.cbl
  3088****       A T-TRANSFER.                                   ****
  3089             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3090
  3091         16  FILLER                         PIC XX.
  3092
  3093         16  CF-CARRIER-CNTL-OPT.
  3094             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3095                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3096                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3097             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3098                                            PIC X.
  3099         16  CF-GROUP-CNTL-OPT.
  3100             20  CF-GROUP-OPT-SEQ           PIC 9.
  3101                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3102                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3103             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3104                                            PIC X(6).
  3105         16  CF-STATE-CNTL-OPT.
  3106             20  CF-STATE-OPT-SEQ           PIC 9.
  3107                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3108                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3109             20  CF-STATE-SELECT OCCURS 3 TIMES
  3110                                            PIC XX.
  3111         16  CF-ACCOUNT-CNTL-OPT.
  3112             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3113                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3114                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3115             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3116                                            PIC X(10).
  3117         16  CF-BUS-TYP-CNTL-OPT.
  3118             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3119                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3120                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3121             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3122                                            PIC XX.
  3123         16  CF-LF-TYP-CNTL-OPT.
  3124             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3125                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3126                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3127             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3128                                            PIC XX.
  3129         16  CF-AH-TYP-CNTL-OPT.
  3130             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3131                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3132                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3133             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3134                                            PIC XX.
  3135         16  CF-REPTCD1-CNTL-OPT.
  3136             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3137                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3138                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3139             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3140                                            PIC X(10).
  3141         16  CF-REPTCD2-CNTL-OPT.
  3142             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3143                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3144                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3145             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  56
* EL677.cbl
  3146                                            PIC X(10).
  3147         16  CF-USER1-CNTL-OPT.
  3148             20  CF-USER1-OPT-SEQ           PIC 9.
  3149                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3150                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3151             20  CF-USER1-SELECT OCCURS 3 TIMES
  3152                                            PIC X(10).
  3153         16  CF-USER2-CNTL-OPT.
  3154             20  CF-USER2-OPT-SEQ           PIC 9.
  3155                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3156                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3157             20  CF-USER2-SELECT OCCURS 3 TIMES
  3158                                            PIC X(10).
  3159         16  CF-USER3-CNTL-OPT.
  3160             20  CF-USER3-OPT-SEQ           PIC 9.
  3161                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3162                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3163             20  CF-USER3-SELECT OCCURS 3 TIMES
  3164                                            PIC X(10).
  3165         16  CF-USER4-CNTL-OPT.
  3166             20  CF-USER4-OPT-SEQ           PIC 9.
  3167                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3168                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3169             20  CF-USER4-SELECT OCCURS 3 TIMES
  3170                                            PIC X(10).
  3171         16  CF-USER5-CNTL-OPT.
  3172             20  CF-USER5-OPT-SEQ           PIC 9.
  3173                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3174                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3175             20  CF-USER5-SELECT OCCURS 3 TIMES
  3176                                            PIC X(10).
  3177         16  CF-REINS-CNTL-OPT.
  3178             20  CF-REINS-OPT-SEQ           PIC 9.
  3179                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3180                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3181             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3182                 24  CF-REINS-PRIME         PIC XXX.
  3183                 24  CF-REINS-SUB           PIC XXX.
  3184
  3185         16  CF-AGENT-CNTL-OPT.
  3186             20  CF-AGENT-OPT-SEQ           PIC 9.
  3187                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3188                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3189             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3190                                            PIC X(10).
  3191
  3192         16  FILLER                         PIC X(43).
  3193
  3194         16  CF-LOSS-RATIO-SELECT.
  3195             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3196             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3197         16  CF-ENTRY-DATE-SELECT.
  3198             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3199             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3200         16  CF-EFFECTIVE-DATE-SELECT.
  3201             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3202             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3203
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  57
* EL677.cbl
  3204         16  CF-EXCEPTION-LIST-IND          PIC X.
  3205             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3206
  3207         16  FILLER                         PIC X(318).
  3208
  3209****************************************************************
  3210*                  EXCEPTION REPORTING RECORD                  *
  3211****************************************************************
  3212
  3213     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3214         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3215             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3216
  3217         16  CF-COMBINED-LIFE-AH-OPT.
  3218             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3219             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3220             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3221             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3222
  3223         16  CF-LIFE-OPT.
  3224             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3225             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3226             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3227             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3228             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3229             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3230             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3231             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3232             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3233             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3234
  3235         16  CF-AH-OPT.
  3236             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3237             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3238             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3239             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3240             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3241             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3242             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3243             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3244             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3245             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3246
  3247         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3248             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3249             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3250             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3251
  3252         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3253
  3254         16  FILLER                         PIC X(673).
  3255
  3256
  3257****************************************************************
  3258*             MORTGAGE SYSTEM PLAN RECORD                      *
  3259****************************************************************
  3260
  3261     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  58
* EL677.cbl
  3262         16  CF-PLAN-TYPE                   PIC X.
  3263             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3264             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3265             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3266         16  CF-PLAN-ABBREV                 PIC XXX.
  3267         16  CF-PLAN-DESCRIPT               PIC X(10).
  3268         16  CF-PLAN-NOTES                  PIC X(20).
  3269         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3270         16  CF-PLAN-UNDERWRITING.
  3271             20  CF-PLAN-TERM-DATA.
  3272                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3273                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3274             20  CF-PLAN-AGE-DATA.
  3275                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3276                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3277                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3278             20  CF-PLAN-BENEFIT-DATA.
  3279                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3280                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3281                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3282                                            PIC S9(7)V99  COMP-3.
  3283         16  CF-PLAN-POLICY-FORMS.
  3284             20  CF-POLICY-FORM             PIC X(12).
  3285             20  CF-MASTER-APPLICATION      PIC X(12).
  3286             20  CF-MASTER-POLICY           PIC X(12).
  3287         16  CF-PLAN-RATING.
  3288             20  CF-RATE-CODE               PIC X(5).
  3289             20  CF-SEX-RATING              PIC X.
  3290                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3291                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3292             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3293             20  CF-SUB-STD-TYPE            PIC X.
  3294                 88  CF-PCT-OF-PREM            VALUE '1'.
  3295                 88  CF-PCT-OF-BENE            VALUE '2'.
  3296         16  CF-PLAN-PREM-TOLERANCES.
  3297             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3298             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3299         16  CF-PLAN-PYMT-TOLERANCES.
  3300             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3301             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3302         16  CF-PLAN-MISC-DATA.
  3303             20  FILLER                     PIC X.
  3304             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3305             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3306         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3307         16  CF-PLAN-IND-GRP                PIC X.
  3308             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3309                                                     '1'.
  3310             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3311                                                     '2'.
  3312         16  CF-MIB-SEARCH-SW               PIC X.
  3313             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3314             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3315             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3316             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3317         16  CF-ALPHA-SEARCH-SW             PIC X.
  3318             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3319             88  CF-MIB-ALPHA-NONE             VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  59
* EL677.cbl
  3320             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3321             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3322             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3323             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3324             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3325             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3326             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3327             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3328                                                     'A' 'B' 'C'
  3329                                                     'X' 'Y' 'Z'.
  3330         16  CF-EFF-DT-RULE-SW              PIC X.
  3331             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3332             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3333             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3334             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3335             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3336         16  FILLER                         PIC X(4).
  3337         16  CF-HEALTH-QUESTIONS            PIC X.
  3338             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3339         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3340         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3341         16  CF-PLAN-SNGL-JNT               PIC X.
  3342             88  CF-COMBINED-PLAN              VALUE 'C'.
  3343             88  CF-JNT-PLAN                   VALUE 'J'.
  3344             88  CF-SNGL-PLAN                  VALUE 'S'.
  3345         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3346         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3347         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3348         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3349         16  CF-RERATE-CNTL                 PIC  X.
  3350             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3351             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3352             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3353             88  CF-AUTO-RECALC                 VALUE '4'.
  3354         16  CF-BENEFIT-TYPE                PIC  X.
  3355             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3356             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3357         16  CF-POLICY-FEE                  PIC S999V99
  3358                                                    COMP-3.
  3359         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3360         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3361         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3362         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3363         16  FILLER                         PIC  X(32).
  3364         16  CF-TERMINATION-FORM            PIC  X(04).
  3365         16  FILLER                         PIC  X(08).
  3366         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3367                                                       COMP-3.
  3368         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3369         16  CF-ISSUE-LETTER                PIC  X(4).
  3370         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3371         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3372             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3373             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3374         16  CF-MP-REFUND-CALC              PIC X.
  3375             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3376             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3377             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  60
* EL677.cbl
  3378             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3379             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3380             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3381             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3382             88  CF-MP-REFD-MEAN                VALUE '8'.
  3383         16  CF-ALT-RATE-CODE               PIC  X(5).
  3384
  3385
  3386         16  FILLER                         PIC X(498).
  3387****************************************************************
  3388*             MORTGAGE COMPANY MASTER RECORD                   *
  3389****************************************************************
  3390
  3391     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3392         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3393         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3394             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3395             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3396             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3397             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3398             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3399
  3400         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3401         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3402         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3403         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3404         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3405
  3406         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3407             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3408         16  CF-MP-RECON-USE-IND            PIC X(1).
  3409             88  CF-MP-USE-RECON             VALUE 'Y'.
  3410         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3411             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3412         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3413             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3414             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3415         16  FILLER                         PIC X(1).
  3416         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3417             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3418         16  CF-MORTG-MIB-VERSION           PIC X.
  3419             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3420             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3421             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3422         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3423             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3424                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3425             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3426                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3427             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3428                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3429             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3430                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3431             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3432                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3433             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3434                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3435         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  61
* EL677.cbl
  3436         16  FILLER                         PIC X(7).
  3437         16  CF-MORTG-DESTINATION-SYMBOL.
  3438             20  CF-MORTG-MIB-COMM          PIC X(5).
  3439             20  CF-MORTG-MIB-TERM          PIC X(5).
  3440         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3441             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3442         16  FILLER                         PIC X(03).
  3443         16  CF-MP-CHECK-NO-CONTROL.
  3444             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3445                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3446                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3447                                                ' ' LOW-VALUES.
  3448                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3449                                               VALUE '3'.
  3450         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3451         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3452         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3453             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3454                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3455             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3456                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3457             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3458                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3459             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3460                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3461             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3462                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3463             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3464                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3465         16  CF-MORTG-BILLING-AREA.
  3466             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3467                                            PIC X.
  3468         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3469         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3470         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3471         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3472             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3473             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3474         16  FILLER                         PIC X.
  3475         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3476             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3477             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3478         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3479         16  FILLER                         PIC X(8).
  3480         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3481         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3482         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3483         16  CF-ACH-COMPANY-ID.
  3484             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3485                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3486                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3487                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3488             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3489         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3490             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3491         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3492             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3493             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  62
* EL677.cbl
  3494         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3495         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3496         16  FILLER                         PIC X(536).
  3497
  3498****************************************************************
  3499*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3500****************************************************************
  3501
  3502     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3503         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3504             20  CF-FEMALE-HEIGHT.
  3505                 24  CF-FEMALE-FT           PIC 99.
  3506                 24  CF-FEMALE-IN           PIC 99.
  3507             20  CF-FEMALE-MIN-WT           PIC 999.
  3508             20  CF-FEMALE-MAX-WT           PIC 999.
  3509         16  FILLER                         PIC X(428).
  3510
  3511     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3512         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3513             20  CF-MALE-HEIGHT.
  3514                 24  CF-MALE-FT             PIC 99.
  3515                 24  CF-MALE-IN             PIC 99.
  3516             20  CF-MALE-MIN-WT             PIC 999.
  3517             20  CF-MALE-MAX-WT             PIC 999.
  3518         16  FILLER                         PIC X(428).
  3519******************************************************************
  3520*             AUTOMATIC ACTIVITY RECORD                          *
  3521******************************************************************
  3522     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3523         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3524             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3525             20  CF-SYS-LETTER-ID           PIC X(04).
  3526             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3527             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3528             20  CF-SYS-RESET-SW            PIC X(01).
  3529             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3530             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3531
  3532         16  FILLER                         PIC X(50).
  3533
  3534         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3535             20  CF-USER-ACTIVE-SW          PIC X(01).
  3536             20  CF-USER-LETTER-ID          PIC X(04).
  3537             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3538             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3539             20  CF-USER-RESET-SW           PIC X(01).
  3540             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3541             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3542             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3543
  3544         16  FILLER                         PIC X(246).
  3545*                                    COPY ERCCHEK.
  3546******************************************************************
  3547*                                                                *
  3548*                                                                *
  3549*                            ERCCHEK                             *
  3550*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3551*                            VMOD=2.008                          *
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  63
* EL677.cbl
  3552*                                                                *
  3553*   FILE DESCRIPTION = CHECK RECORDS                             *
  3554*                                                                *
  3555*   FILE TYPE = VSAM,KSDS                                        *
  3556*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3557*                                                                *
  3558*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3559*       ALTERNATE INDEX = NONE                                   *
  3560*                                                                *
  3561*   LOG = YES                                                    *
  3562*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3563******************************************************************
  3564*                   C H A N G E   L O G
  3565*
  3566* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3567*-----------------------------------------------------------------
  3568*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3569* EFFECTIVE    NUMBER
  3570*-----------------------------------------------------------------
  3571* 021414    2003053000001  PEMA  changes for auto chk request
  3572******************************************************************
  3573 01  CHECK-RECORDS.
  3574     12  CH-RECORD-ID                      PIC XX.
  3575         88  VALID-CH-ID                      VALUE 'CH'.
  3576
  3577     12  CH-CONTROL-PRIMARY.
  3578         16  CH-COMPANY-CD                 PIC X.
  3579         16  CH-CARRIER                    PIC X.
  3580         16  CH-GROUPING                   PIC X(6).
  3581         16  CH-STATE                      PIC XX.
  3582         16  CH-ACCOUNT                    PIC X(10).
  3583         16  CH-CERT-EFF-DT                PIC XX.
  3584         16  CH-CERT-NO.
  3585             20  CH-CERT-PRIME             PIC X(10).
  3586             20  CH-CERT-SFX               PIC X.
  3587         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3588
  3589     12  CH-RECORDED-DT                    PIC XX.
  3590     12  CH-RECORDED-BY                    PIC X(4).
  3591     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3592
  3593     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3594     12  CH-CHECK-NO                       PIC X(7).
  3595     12  CH-REASON-FOR-CHECK               PIC X(25).
  3596     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3597     12  FILLER                            PIC X.
  3598
  3599     12  CH-PAYEE-INFO.
  3600         16  CH-PAYEE-NAME-1               PIC X(30).
  3601         16  CH-PAYEE-NAME-2               PIC X(30).
  3602         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3603         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3604         16  CH-PAYEE-CITY-ST.
  3605             20  CH-PAYEE-CITY             PIC X(28).
  3606             20  CH-PAYEE-STATE            PIC XX.
  3607         16  CH-PAYEE-ZIP-CODE.
  3608             20  CH-PAYEE-ZIP.
  3609                 24  CH-ZIP-PRI-1ST        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  64
* EL677.cbl
  3610                     88  CH-CANADIAN-POST-CODE
  3611                                           VALUES 'A' THRU 'Z'.
  3612                 24  FILLER                PIC X(4).
  3613             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3614         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3615             20  CH-CAN-POSTAL-1           PIC XXX.
  3616             20  CH-CAN-POSTAL-2           PIC XXX.
  3617             20  FILLER                    PIC XXX.
  3618
  3619     12  CH-CHECK-STUB-TEXT.
  3620         16  CH-STUB-LINE-1                PIC X(30).
  3621         16  CH-TEXT-LINE-1                PIC X(50).
  3622         16  CH-TEXT-LINE-2                PIC X(50).
  3623         16  CH-TEXT-LINE-3                PIC X(40).
  3624     12  CH-RETURN-TO                      PIC X(30).
  3625
  3626     12  CH-COMPENSATION-CONTROL.
  3627         16  CH-COMP-CARRIER               PIC X.
  3628         16  CH-COMP-GROUPING              PIC X(6).
  3629         16  CH-COMP-FIN-RESP              PIC X(10).
  3630         16  CH-COMP-ACCOUNT               PIC X(10).
  3631
  3632     12  CH-CREDIT-SELECT-DT               PIC XX.
  3633     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3634     12  CH-PAYEE-CODE                     PIC X(6).
  3635
  3636     12  CH-VOID-DATA.
  3637         20  CH-VOID-DT                    PIC XX.
  3638         20  CH-VOID-BY                    PIC X(4).
  3639         20  CH-VOID-REASON                PIC X(25).
  3640
  3641     12  CH-APPROVAL-DATA.
  3642         20  CH-APPROVAL-DT                PIC XX.
  3643         20  CH-APPROVAL-STATUS            PIC X.
  3644             88  CH-IN-LIMBO                  VALUE ' '.
  3645             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  3646             88  CH-APPROVED                  VALUE 'A'.
  3647             88  CH-DENIED                    VALUE 'D'.
  3648         20  CH-APPROVED-BY                PIC XXXX.
  3649     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3650             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3651     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3652
  3653     12  ch-released-dt                    pic xx.
  3654     12  ch-check-cashed-dt                pic xx.
  3655     12  FILLER                            PIC X.
  3656*    12  CH-CHECK-REFERENCE                PIC X(12).
  3657     12  CH-CHECK-ORIGIN-SW                PIC X.
  3658             88  CH-REFUND-CHECK              VALUE 'R'.
  3659             88  CH-MAINT-CHECK               VALUE 'M'.
  3660
  3661     12  CH-CANC-DT                        PIC XX.
  3662     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3663     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3664
  3665     12  CH-INSURED-NAME                   PIC X(28).
  3666
  3667     12  ch-released-by                    pic x(4).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  65
* EL677.cbl
  3668     12  ch-csr                            pic x(4).
  3669     12  ch-deduct-commission              pic x.
  3670         88  ch-deduct-comm                  value 'Y'.
  3671         88  ch-do-not-deduct-comm           value 'N'.
  3672
  3673     12  FILLER                            PIC X(11).
  3674*    12  CH-LETTER-TABLE.
  3675*        16  CH-LETTERS OCCURS 3 TIMES
  3676*                       INDEXED BY CH-LT-NDX
  3677*                                          PIC X(04).
  3678
  3679     12  FILLER                            PIC X(07).
  3680
  3681*                                    COPY ERCACCT.
  3682******************************************************************
  3683*                                                                *
  3684*                                                                *
  3685*                            ERCACCT                             *
  3686*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3687*                            VMOD=2.031                          *
  3688*                                                                *
  3689*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  3690*                                                                *
  3691*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  3692*   VSAM ACCOUNT MASTER FILES.                                   *
  3693*                                                                *
  3694*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  3695*                                                                *
  3696*   FILE TYPE = VSAM,KSDS                                        *
  3697*   RECORD SIZE = 2000  RECFORM = FIX                            *
  3698*                                                                *
  3699*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  3700*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  3701*                                                                *
  3702*   LOG = NO                                                     *
  3703*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3704*                                                                *
  3705*                                                                *
  3706******************************************************************
  3707*                   C H A N G E   L O G
  3708*
  3709* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3710*-----------------------------------------------------------------
  3711*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3712* EFFECTIVE    NUMBER
  3713*-----------------------------------------------------------------
  3714* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  3715* 092705    2005050300006  PEMA  ADD SPP LEASES
  3716* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  3717* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3718* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  3719* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  3720* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  3721* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  3722******************************************************************
  3723
  3724 01  ACCOUNT-MASTER.
  3725     12  AM-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  66
* EL677.cbl
  3726         88  VALID-AM-ID                      VALUE 'AM'.
  3727
  3728     12  AM-CONTROL-PRIMARY.
  3729         16  AM-COMPANY-CD                 PIC X.
  3730         16  AM-MSTR-CNTRL.
  3731             20  AM-CONTROL-A.
  3732                 24  AM-CARRIER            PIC X.
  3733                 24  AM-GROUPING.
  3734                     28 AM-GROUPING-PREFIX PIC XXX.
  3735                     28 AM-GROUPING-PRIME  PIC XXX.
  3736                 24  AM-STATE              PIC XX.
  3737                 24  AM-ACCOUNT.
  3738                     28  AM-ACCOUNT-PREFIX PIC X(4).
  3739                     28  AM-ACCOUNT-PRIME  PIC X(6).
  3740             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  3741                                           PIC X(19).
  3742             20  AM-CNTRL-B.
  3743                 24  AM-EXPIRATION-DT      PIC XX.
  3744                 24  FILLER                PIC X(4).
  3745             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  3746                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  3747
  3748     12  AM-CONTROL-BY-VAR-GRP.
  3749         16  AM-COMPANY-CD-A1              PIC X.
  3750         16  AM-VG-CARRIER                 PIC X.
  3751         16  AM-VG-GROUPING                PIC X(6).
  3752         16  AM-VG-STATE                   PIC XX.
  3753         16  AM-VG-ACCOUNT                 PIC X(10).
  3754         16  AM-VG-DATE.
  3755             20  AM-VG-EXPIRATION-DT       PIC XX.
  3756             20  FILLER                    PIC X(4).
  3757         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  3758                                           PIC 9(11)      COMP-3.
  3759     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  3760         16  FILLER                        PIC X(10).
  3761         16  AM-VG-KEY3.
  3762             20  AM-VG3-ACCOUNT            PIC X(10).
  3763             20  AM-VG3-EXP-DT             PIC XX.
  3764         16  FILLER                        PIC X(4).
  3765     12  AM-MAINT-INFORMATION.
  3766         16  AM-LAST-MAINT-DT              PIC XX.
  3767         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  3768         16  AM-LAST-MAINT-USER            PIC X(4).
  3769         16  FILLER                        PIC XX.
  3770
  3771     12  AM-EFFECTIVE-DT                   PIC XX.
  3772     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  3773
  3774     12  AM-PREV-DATES  COMP-3.
  3775         16  AM-PREV-EXP-DT                PIC 9(11).
  3776         16  AM-PREV-EFF-DT                PIC 9(11).
  3777
  3778     12  AM-REPORT-CODE-1                  PIC X(10).
  3779     12  AM-REPORT-CODE-2                  PIC X(10).
  3780
  3781     12  AM-CITY-CODE                      PIC X(4).
  3782     12  AM-COUNTY-PARISH                  PIC X(6).
  3783
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  67
* EL677.cbl
  3784     12  AM-NAME                           PIC X(30).
  3785     12  AM-PERSON                         PIC X(30).
  3786     12  AM-ADDRS                          PIC X(30).
  3787     12  AM-CITY.
  3788         16  AM-ADDR-CITY                  PIC X(28).
  3789         16  AM-ADDR-STATE                 PIC XX.
  3790     12  AM-ZIP.
  3791         16  AM-ZIP-PRIME.
  3792             20  AM-ZIP-PRI-1ST            PIC X.
  3793                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  3794             20  FILLER                    PIC X(4).
  3795         16  AM-ZIP-PLUS4                  PIC X(4).
  3796     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  3797         16  AM-CAN-POSTAL-1               PIC XXX.
  3798         16  AM-CAN-POSTAL-2               PIC XXX.
  3799         16  FILLER                        PIC XXX.
  3800     12  AM-TEL-NO.
  3801         16  AM-AREA-CODE                  PIC 999.
  3802         16  AM-TEL-PRE                    PIC 999.
  3803         16  AM-TEL-NBR                    PIC 9(4).
  3804     12  AM-TEL-LOC                        PIC X.
  3805         88  AM-TEL-AT-HOME                   VALUE 'H'.
  3806         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  3807
  3808     12  AM-COMM-STRUCTURE.
  3809         16  AM-DEFN-1.
  3810             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  3811                 24  AM-AGT.
  3812                     28  AM-AGT-PREFIX     PIC X(4).
  3813                     28  AM-AGT-PRIME      PIC X(6).
  3814                 24  AM-COM-TYP            PIC X.
  3815                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  3816                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  3817                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  3818                 24  AM-RECALC-LV-INDIC    PIC X.
  3819                 24  AM-RETRO-LV-INDIC     PIC X.
  3820                 24  AM-GL-CODES           PIC X.
  3821                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  3822                 24  FILLER                PIC X(01).
  3823         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  3824             20  AM-COM-TBLS        OCCURS 10 TIMES.
  3825                 24  FILLER                PIC X(11).
  3826                 24  AM-L-COMA             PIC XXX.
  3827                 24  AM-J-COMA             PIC XXX.
  3828                 24  AM-A-COMA             PIC XXX.
  3829                 24  FILLER                PIC X(6).
  3830
  3831     12  AM-COMM-CHANGE-STATUS             PIC X.
  3832         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  3833
  3834     12  AM-CSR-CODE                       PIC X(4).
  3835
  3836     12  AM-BILLING-STATUS                 PIC X.
  3837         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  3838         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  3839     12  AM-AUTO-REFUND-SW                 PIC X.
  3840         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  3841         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  68
* EL677.cbl
  3842     12  AM-GPCD                           PIC 99.
  3843     12  AM-IG                             PIC X.
  3844         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  3845         88  AM-HAS-GROUP                     VALUE '2'.
  3846     12  AM-STATUS                         PIC X.
  3847         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  3848         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  3849         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  3850         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  3851         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  3852         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  3853         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  3854         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  3855         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  3856         88  AM-ACCOUNT-PENDING               VALUE '9'.
  3857     12  AM-REMIT-TO                       PIC 99.
  3858     12  AM-ID-NO                          PIC X(11).
  3859
  3860     12  AM-CAL-TABLE                      PIC XX.
  3861     12  AM-LF-DEVIATION                   PIC XXX.
  3862     12  AM-AH-DEVIATION                   PIC XXX.
  3863     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3864     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  3865     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  3866     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  3867     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3868     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  3869
  3870     12  AM-USER-FIELDS.
  3871         16  AM-FLD-1                      PIC XX.
  3872         16  AM-FLD-2                      PIC XX.
  3873         16  AM-FLD-3                      PIC XX.
  3874         16  AM-FLD-4                      PIC XX.
  3875         16  AM-FLD-5                      PIC XX.
  3876
  3877     12  AM-1ST-PROD-DATE.
  3878         16  AM-1ST-PROD-YR                PIC XX.
  3879         16  AM-1ST-PROD-MO                PIC XX.
  3880         16  AM-1ST-PROD-DA                PIC XX.
  3881     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  3882     12  AM-CERTS-PURGED-DATE.
  3883         16  AM-PUR-YR                     PIC XX.
  3884         16  AM-PUR-MO                     PIC XX.
  3885         16  AM-PUR-DA                     PIC XX.
  3886     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  3887     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  3888     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  3889     12  AM-INACTIVE-DATE.
  3890         16  AM-INA-MO                     PIC 99.
  3891         16  AM-INA-DA                     PIC 99.
  3892         16  AM-INA-YR                     PIC 99.
  3893     12  AM-AR-HI-CERT-DATE                PIC XX.
  3894
  3895     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3896     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  3897
  3898     12  AM-OB-PAYMENT-MODE                PIC X.
  3899         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  69
* EL677.cbl
  3900         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  3901         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  3902         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  3903
  3904     12  AM-AH-ONLY-INDICATOR              PIC X.
  3905         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  3906         88  AM-NO-AH-ONLY                    VALUE 'N'.
  3907
  3908     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  3909
  3910     12  AM-OVER-SHORT.
  3911         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  3912         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  3913
  3914     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  3915     12  AM-DCC-CLP-STATE                  PIC XX.
  3916
  3917     12  AM-RECALC-COMM                    PIC X.
  3918     12  AM-RECALC-REIN                    PIC X.
  3919
  3920     12  AM-REI-TABLE                      PIC XXX.
  3921     12  AM-REI-ET-LF                      PIC X.
  3922     12  AM-REI-ET-AH                      PIC X.
  3923     12  AM-REI-PE-LF                      PIC X.
  3924     12  AM-REI-PE-AH                      PIC X.
  3925     12  AM-REI-PRT-ST                     PIC X.
  3926     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  3927     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  3928     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  3929     12  AM-REI-GROUP-A                    PIC X(6).
  3930     12  AM-REI-MORT                       PIC X(4).
  3931     12  AM-REI-PRT-OW                     PIC X.
  3932     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  3933     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  3934     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  3935     12  AM-REI-GROUP-B                    PIC X(6).
  3936
  3937     12  AM-TRUST-TYPE                     PIC X(2).
  3938
  3939     12  AM-EMPLOYER-STMT-USED             PIC X.
  3940     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  3941
  3942     12  AM-STD-AH-TYPE                    PIC XX.
  3943     12  AM-EARN-METHODS.
  3944         16  AM-EARN-METHOD-R              PIC X.
  3945             88 AM-REF-RL-R78                 VALUE 'R'.
  3946             88 AM-REF-RL-PR                  VALUE 'P'.
  3947             88 AM-REF-RL-MEAN                VALUE 'M'.
  3948             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  3949         16  AM-EARN-METHOD-L              PIC X.
  3950             88 AM-REF-LL-R78                 VALUE 'R'.
  3951             88 AM-REF-LL-PR                  VALUE 'P'.
  3952             88 AM-REF-LL-MEAN                VALUE 'M'.
  3953             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  3954         16  AM-EARN-METHOD-A              PIC X.
  3955             88 AM-REF-AH-R78                 VALUE 'R'.
  3956             88 AM-REF-AH-PR                  VALUE 'P'.
  3957             88 AM-REF-AH-MEAN                VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  70
* EL677.cbl
  3958             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  3959             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  3960             88 AM-REF-AH-NET                 VALUE 'N'.
  3961
  3962     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  3963     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  3964     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  3965
  3966     12  AM-RET-Y-N                        PIC X.
  3967     12  AM-RET-P-E                        PIC X.
  3968     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  3969     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  3970     12  AM-RET-GRP                        PIC X(6).
  3971     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  3972         16  AM-POOL-PRIME                 PIC XXX.
  3973         16  AM-POOL-SUB                   PIC XXX.
  3974     12  AM-RETRO-EARNINGS.
  3975         16  AM-RET-EARN-R                 PIC X.
  3976         16  AM-RET-EARN-L                 PIC X.
  3977         16  AM-RET-EARN-A                 PIC X.
  3978     12  AM-RET-ST-TAX-USE                 PIC X.
  3979         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  3980         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  3981     12  AM-RETRO-BEG-EARNINGS.
  3982         16  AM-RET-BEG-EARN-R             PIC X.
  3983         16  AM-RET-BEG-EARN-L             PIC X.
  3984         16  AM-RET-BEG-EARN-A             PIC X.
  3985     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  3986     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  3987
  3988     12  AM-USER-SELECT-OPTIONS.
  3989         16  AM-USER-SELECT-1              PIC X(10).
  3990         16  AM-USER-SELECT-2              PIC X(10).
  3991         16  AM-USER-SELECT-3              PIC X(10).
  3992         16  AM-USER-SELECT-4              PIC X(10).
  3993         16  AM-USER-SELECT-5              PIC X(10).
  3994
  3995     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3996
  3997     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  3998
  3999     12  AM-RPT045A-SWITCH                 PIC X.
  4000         88  RPT045A-OFF                   VALUE 'N'.
  4001
  4002     12  AM-INSURANCE-LIMITS.
  4003         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4004         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4005
  4006     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4007         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4008
  4009     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4010         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4011         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4012
  4013     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4014
  4015     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  71
* EL677.cbl
  4016     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4017     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4018     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4019     12  AM-DCC-UEF-STATE                  PIC XX.
  4020     12  FILLER                            PIC XXX.
  4021     12  AM-REPORT-CODE-3                  PIC X(10).
  4022*    12  FILLER                            PIC X(22).
  4023
  4024     12  AM-RESERVE-DATE.
  4025         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4026         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4027         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4028
  4029     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4030     12  AM-NOTIFICATION-TYPES.
  4031         16  AM-NOTIF-OF-LETTERS           PIC X.
  4032         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4033         16  AM-NOTIF-OF-REPORTS           PIC X.
  4034         16  AM-NOTIF-OF-STATUS            PIC X.
  4035
  4036     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4037         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4038         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4039         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4040         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4041
  4042     12  AM-BENEFIT-CONTROLS.
  4043         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  4044             20  AM-BENEFIT-CODE           PIC XX.
  4045             20  AM-BENEFIT-TYPE           PIC X.
  4046             20  AM-BENEFIT-REVISION       PIC XXX.
  4047             20  AM-BENEFIT-REM-TERM       PIC X.
  4048             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4049             20  FILLER                    PIC XX.
  4050         16  FILLER                        PIC X(80).
  4051
  4052     12  AM-TRANSFER-DATA.
  4053         16  AM-TRANSFERRED-FROM.
  4054             20  AM-TRNFROM-CARRIER        PIC X.
  4055             20  AM-TRNFROM-GROUPING.
  4056                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4057                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4058             20  AM-TRNFROM-STATE          PIC XX.
  4059             20  AM-TRNFROM-ACCOUNT.
  4060                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4061                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4062             20  AM-TRNFROM-DTE            PIC XX.
  4063         16  AM-TRANSFERRED-TO.
  4064             20  AM-TRNTO-CARRIER          PIC X.
  4065             20  AM-TRNTO-GROUPING.
  4066                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4067                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4068             20  AM-TRNTO-STATE            PIC XX.
  4069             20  AM-TRNTO-ACCOUNT.
  4070                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4071                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4072             20  AM-TRNTO-DTE              PIC XX.
  4073         16  FILLER                        PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  72
* EL677.cbl
  4074
  4075     12  AM-SAVED-REMIT-TO                 PIC 99.
  4076
  4077     12  AM-COMM-STRUCTURE-SAVED.
  4078         16  AM-DEFN-1-SAVED.
  4079             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4080                 24  AM-AGT-SV             PIC X(10).
  4081                 24  AM-COM-TYP-SV         PIC X.
  4082                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4083                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4084                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4085                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4086                 24  FILLER                PIC X.
  4087                 24  AM-GL-CODES-SV        PIC X.
  4088                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4089                 24  FILLER                PIC X.
  4090         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4091             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4092                 24  FILLER                PIC X(11).
  4093                 24  AM-L-COMA-SV          PIC XXX.
  4094                 24  AM-J-COMA-SV          PIC XXX.
  4095                 24  AM-A-COMA-SV          PIC XXX.
  4096                 24  FILLER                PIC X(6).
  4097
  4098     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4099         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4100            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4101            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  4102            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4103
  4104     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4105     12  FILLER                            PIC X(120).
  4106
  4107     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4108         16  AM-CONTROL-NAME               PIC X(30).
  4109         16  AM-EXECUTIVE-ONE.
  4110             20  AM-EXEC1-NAME             PIC X(15).
  4111             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4112                                                          COMP-3.
  4113             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4114                                                          COMP-3.
  4115         16  AM-EXECUTIVE-TWO.
  4116             20  AM-EXEC2-NAME             PIC X(15).
  4117             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4118                                                          COMP-3.
  4119             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4120                                                          COMP-3.
  4121
  4122     12  AM-RETRO-ADDITIONAL-DATA.
  4123         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4124         16  AM-RETRO-PREM-P-E             PIC X.
  4125         16  AM-RETRO-CLMS-P-I             PIC X.
  4126         16  AM-RETRO-RET-BRACKET-LF.
  4127             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4128                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4129                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4130             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4131                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  73
* EL677.cbl
  4132                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4133             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4134                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4135                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4136         16  AM-RETRO-RET-BRACKET-AH.
  4137             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4138                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4139                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4140                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4141             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4142                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4143                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4144             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4145                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4146                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4147
  4148     12  AM-COMMENTS.
  4149         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4150
  4151     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4152         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4153         16  AM-FLI-BILLING-CODE           PIC X.
  4154         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4155         16  AM-FLI-UNITED-IDENT           PIC X.
  4156         16  AM-FLI-INTEREST-LOST-DATA.
  4157             20  AM-FLI-BANK-NO            PIC X(5).
  4158             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4159             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  4160             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4161         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4162             20  AM-FLI-AGT                PIC X(9).
  4163             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4164             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4165         16  FILLER                        PIC X(102).
  4166
  4167     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4168         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4169             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4170             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4171             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4172             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4173             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4174         16  FILLER                          PIC X(10).
  4175******************************************************************
  4176*                                    COPY ERCCOMP.
  4177******************************************************************
  4178*                                                                *
  4179*                                                                *
  4180*                            ERCCOMP                             *
  4181*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4182*                            VMOD=2.019                          *
  4183*                                                                *
  4184*   ONLINE CREDIT SYSTEM                                         *
  4185*                                                                *
  4186*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  4187*                                                                *
  4188*   FILE TYPE = VSAM,KSDS                                        *
  4189*   RECORD SIZE = 700   RECFORM = FIXED                          *
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  74
* EL677.cbl
  4190*                                                                *
  4191*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  4192*       ALTERNATE PATH = NONE                                    *
  4193*                                                                *
  4194*   LOG = NO                                                     *
  4195*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4196*                                                                *
  4197******************************************************************
  4198*                   C H A N G E   L O G
  4199*
  4200* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4201*-----------------------------------------------------------------
  4202*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4203* EFFECTIVE    NUMBER
  4204*-----------------------------------------------------------------
  4205* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4206* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  4207* 092205    2005050300006  PEMA  ADD LEASE FEE
  4208* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  4209* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  4210* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  4211* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4212* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  4213* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  4214******************************************************************
  4215
  4216 01  COMPENSATION-MASTER.
  4217     12  CO-RECORD-ID                          PIC XX.
  4218         88  VALID-CO-ID                          VALUE 'CO'.
  4219
  4220     12  CO-CONTROL-PRIMARY.
  4221         16  CO-COMPANY-CD                     PIC X.
  4222         16  CO-CONTROL.
  4223             20  CO-CTL-1.
  4224                 24  CO-CARR-GROUP.
  4225                     28  CO-CARRIER            PIC X.
  4226                     28  CO-GROUPING.
  4227                         32  CO-GROUP-PREFIX   PIC XXX.
  4228                         32  CO-GROUP-PRIME    PIC XXX.
  4229                 24  CO-RESP-NO.
  4230                     28  CO-RESP-PREFIX        PIC X(4).
  4231                     28  CO-RESP-PRIME         PIC X(6).
  4232             20  CO-CTL-2.
  4233                 24  CO-ACCOUNT.
  4234                     28  CO-ACCT-PREFIX        PIC X(4).
  4235                     28  CO-ACCT-PRIME         PIC X(6).
  4236         16  CO-TYPE                           PIC X.
  4237             88  CO-COMPANY-TYPE                  VALUE 'C'.
  4238             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  4239             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  4240
  4241     12  CO-MAINT-INFORMATION.
  4242         16  CO-LAST-MAINT-DT                  PIC XX.
  4243         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  4244         16  CO-LAST-MAINT-USER                PIC X(4).
  4245     12  FILLER                                PIC XX.
  4246     12  CO-STMT-TYPE                          PIC XXX.
  4247     12  CO-COMP-TYPE                          PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  75
* EL677.cbl
  4248         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  4249     12  CO-STMT-OWNER                         PIC X(4).
  4250     12  CO-BALANCE-CONTROL                    PIC X.
  4251         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  4252         88  CO-NO-BALANCE                        VALUE 'N'.
  4253
  4254     12  CO-INTERNAL-CONTROL-1                 PIC X.
  4255         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  4256         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  4257         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  4258
  4259     12  CO-INTERNAL-CONTROL-2                 PIC X.
  4260         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  4261         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  4262
  4263     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  4264     12  CO-GA-DIRECT-DEP                      PIC X.
  4265     12  CO-FUTURE-SPACE                       PIC X.
  4266         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  4267
  4268     12  CO-ACCT-NAME                          PIC X(30).
  4269     12  CO-MAIL-NAME                          PIC X(30).
  4270     12  CO-ADDR-1                             PIC X(30).
  4271     12  CO-ADDR-2                             PIC X(30).
  4272     12  CO-ADDR-3.
  4273         16  CO-ADDR-CITY                      PIC X(27).
  4274         16  CO-ADDR-STATE                     PIC XX.
  4275     12  CO-CSO-1099                           PIC X.
  4276     12  CO-ZIP.
  4277         16  CO-ZIP-PRIME.
  4278             20  CO-ZIP-PRI-1ST                PIC X.
  4279                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4280             20  FILLER                        PIC X(4).
  4281         16  CO-ZIP-PLUS4                      PIC X(4).
  4282     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  4283         16  CO-CAN-POSTAL-1                   PIC XXX.
  4284         16  CO-CAN-POSTAL-2                   PIC XXX.
  4285         16  FILLER                            PIC XXX.
  4286     12  CO-SOC-SEC                            PIC X(13).
  4287     12  CO-TELEPHONE.
  4288         16  CO-AREA-CODE                      PIC XXX.
  4289         16  CO-PREFIX                         PIC XXX.
  4290         16  CO-PHONE                          PIC X(4).
  4291
  4292     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  4293
  4294     12  CO-AR-BAL-LEVEL                       PIC X.
  4295         88  CO-AR-REF-LVL                        VALUE '1'.
  4296         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  4297         88  CO-AR-BILL-LVL                       VALUE '2'.
  4298         88  CO-AR-AGT-LVL                        VALUE '3'.
  4299         88  CO-AR-FR-LVL                         VALUE '4'.
  4300
  4301     12  CO-AR-NORMAL-PRINT                    PIC X.
  4302         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  4303         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  4304
  4305     12  CO-AR-SUMMARY-CODE                    PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  76
* EL677.cbl
  4306
  4307     12  CO-AR-REPORTING                       PIC X.
  4308         88  CO-AR-NET-REPORT                     VALUE 'N'.
  4309         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  4310
  4311     12  CO-AR-PULL-CHECK                      PIC X.
  4312         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  4313         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  4314
  4315     12  CO-AR-BALANCE-PRINT                   PIC X.
  4316         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  4317
  4318     12  CO-AR-LAST-RUN-CODE                   PIC X.
  4319         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  4320         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  4321         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  4322
  4323     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  4324
  4325     12  CO-USER-CODE                          PIC X.
  4326     12  CO-REPORT-GROUP-ID                    PIC X(12).
  4327
  4328******************************************************************
  4329*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  4330*    THE LAST MONTH END RUN.
  4331******************************************************************
  4332
  4333     12  CO-LAST-ACTIVITY-DATE.
  4334         16  CO-ACT-YEAR                       PIC 99.
  4335         16  CO-ACT-MONTH                      PIC 99.
  4336         16  CO-ACT-DAY                        PIC 99.
  4337
  4338     12  CO-LAST-STMT-DT.
  4339         16  CO-LAST-STMT-YEAR                 PIC 99.
  4340         16  CO-LAST-STMT-MONTH                PIC 99.
  4341         16  CO-LAST-STMT-DAY                  PIC 99.
  4342
  4343     12  CO-MO-END-TOTALS.
  4344         16  CO-MONTHLY-TOTALS.
  4345             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  4346             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  4347             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  4348             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  4349             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  4350
  4351         16  CO-AGING-TOTALS.
  4352             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  4353             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  4354             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  4355             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  4356
  4357         16  CO-YTD-TOTALS.
  4358             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  4359             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  4360
  4361         16  CO-OVER-UNDER-TOTALS.
  4362             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  4363             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  77
* EL677.cbl
  4364
  4365     12  CO-MISCELLANEOUS-TOTALS.
  4366         16  CO-FICA-TOTALS.
  4367             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  4368             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  4369
  4370         16  CO-CLAIM-TOTALS.
  4371             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  4372             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  4373
  4374******************************************************************
  4375*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  4376*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  4377******************************************************************
  4378
  4379     12  CO-CURRENT-TOTALS.
  4380         16  CO-CURRENT-LAST-STMT-DT.
  4381             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  4382             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  4383             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  4384
  4385         16  CO-CURRENT-MONTHLY-TOTALS.
  4386             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  4387             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  4388             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  4389             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  4390             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  4391
  4392         16  CO-CURRENT-AGING-TOTALS.
  4393             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  4394             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  4395             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  4396             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  4397
  4398         16  CO-CURRENT-YTD-TOTALS.
  4399             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  4400             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  4401
  4402     12  CO-PAID-COMM-TOTALS.
  4403         16  CO-YTD-PAID-COMMS.
  4404             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  4405             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  4406
  4407     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  4408         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  4409         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  4410
  4411     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  4412         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  4413         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  4414         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  4415         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  4416         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  4417         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  4418         88  CO-FINAL-LETTER                  VALUE 'F'.
  4419         88  CO-RECONCILING                   VALUE 'R'.
  4420         88  CO-PHONE-CALL                    VALUE 'P'.
  4421         88  CO-LEGAL                         VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  78
* EL677.cbl
  4422         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  4423         88  CO-WRITE-OFF                     VALUE 'W'.
  4424         88  CO-NO-ACTION                     VALUE 'N' ' '.
  4425
  4426     12  CO-CSR-CODE                       PIC X(4).
  4427
  4428     12  CO-GA-STATUS-INFO.
  4429         16  CO-GA-EFFECTIVE-DT            PIC XX.
  4430         16  CO-GA-TERMINATION-DT          PIC XX.
  4431         16  CO-GA-STATUS-CODE             PIC X.
  4432             88  CO-GA-ACTIVE                 VALUE 'A'.
  4433             88  CO-GA-INACTIVE               VALUE 'I'.
  4434             88  CO-GA-PENDING                VALUE 'P'.
  4435         16  CO-GA-COMMENTS.
  4436             20  CO-GA-COMMENT-1           PIC X(40).
  4437             20  CO-GA-COMMENT-2           PIC X(40).
  4438             20  CO-GA-COMMENT-3           PIC X(40).
  4439             20  CO-GA-COMMENT-4           PIC X(40).
  4440
  4441     12  CO-RPTCD2                         PIC X(10).
  4442     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  4443         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  4444         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  4445
  4446     12  CO-TYPE-AGENT                     PIC X(01).
  4447         88  CO-CORPORATION                   VALUE 'C'.
  4448         88  CO-PARTNERSHIP                   VALUE 'P'.
  4449         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  4450         88  CO-TRUST                         VALUE 'T'.
  4451         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  4452
  4453     12  CO-FAXNO.
  4454         16  CO-FAX-AREA-CODE                  PIC XXX.
  4455         16  CO-FAX-PREFIX                     PIC XXX.
  4456         16  CO-FAX-PHONE                      PIC X(4).
  4457
  4458     12  CO-BANK-INFORMATION.
  4459         16  CO-BANK-TRANSIT-NO                PIC X(8).
  4460         16  CO-BANK-TRANSIT-NON REDEFINES
  4461             CO-BANK-TRANSIT-NO                PIC 9(8).
  4462
  4463         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  4464     12  CO-MISC-DEDUCT-INFO REDEFINES
  4465                  CO-BANK-INFORMATION.
  4466         16  CO-MD-GL-ACCT                     PIC X(10).
  4467         16  CO-MD-DIV                         PIC XX.
  4468         16  CO-MD-CENTER                      PIC X(4).
  4469         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  4470         16  CO-CREATE-AP-CHECK                PIC X.
  4471         16  CO-DELIVER-CK-TO-MEL              PIC X.
  4472         16  FILLER                            PIC XXX.
  4473     12  CO-ACH-STATUS                         PIC X.
  4474         88  CO-ACH-ACTIVE                         VALUE 'A'.
  4475         88  CO-ACH-PENDING                        VALUE 'P'.
  4476
  4477     12  CO-BILL-SW                            PIC X.
  4478     12  CO-CONTROL-NAME                       PIC X(30).
  4479     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  79
* EL677.cbl
  4480     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  4481     12  CO-CLP-STATE                          PIC XX.
  4482     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  4483     12  CO-SPP-REFUND-EDIT                    PIC X.
  4484
  4485******************************************************************
  4486*                                    COPY ELCCERT.
  4487******************************************************************
  4488*                                                                *
  4489*                            ELCCERT.                            *
  4490*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4491*                            VMOD=2.013                          *
  4492*                                                                *
  4493*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4494*                                                                *
  4495*   FILE TYPE = VSAM,KSDS                                        *
  4496*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4497*                                                                *
  4498*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4499*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4500*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4501*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4502*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4503*                                                                *
  4504*   LOG = YES                                                    *
  4505*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4506******************************************************************
  4507*                   C H A N G E   L O G
  4508*
  4509* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4510*-----------------------------------------------------------------
  4511*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4512* EFFECTIVE    NUMBER
  4513*-----------------------------------------------------------------
  4514* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4515* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4516* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4517* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4518* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4519* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4520* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4521* 032612  CR2011110200001  PEMA  AHL CHANGES
  4522* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4523* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4524******************************************************************
  4525
  4526 01  CERTIFICATE-MASTER.
  4527     12  CM-RECORD-ID                      PIC XX.
  4528         88  VALID-CM-ID                      VALUE 'CM'.
  4529
  4530     12  CM-CONTROL-PRIMARY.
  4531         16  CM-COMPANY-CD                 PIC X.
  4532         16  CM-CARRIER                    PIC X.
  4533         16  CM-GROUPING.
  4534             20  CM-GROUPING-PREFIX        PIC X(3).
  4535             20  CM-GROUPING-PRIME         PIC X(3).
  4536         16  CM-STATE                      PIC XX.
  4537         16  CM-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  80
* EL677.cbl
  4538             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4539             20  CM-ACCOUNT-PRIME          PIC X(6).
  4540         16  CM-CERT-EFF-DT                PIC XX.
  4541         16  CM-CERT-NO.
  4542             20  CM-CERT-PRIME             PIC X(10).
  4543             20  CM-CERT-SFX               PIC X.
  4544
  4545     12  CM-CONTROL-BY-NAME.
  4546         16  CM-COMPANY-CD-A1              PIC X.
  4547         16  CM-INSURED-LAST-NAME          PIC X(15).
  4548         16  CM-INSURED-INITIALS.
  4549             20  CM-INSURED-INITIAL1       PIC X.
  4550             20  CM-INSURED-INITIAL2       PIC X.
  4551
  4552     12  CM-CONTROL-BY-SSN.
  4553         16  CM-COMPANY-CD-A2              PIC X.
  4554         16  CM-SOC-SEC-NO.
  4555             20  CM-SSN-STATE              PIC XX.
  4556             20  CM-SSN-ACCOUNT            PIC X(6).
  4557             20  CM-SSN-LN3.
  4558                 25  CM-INSURED-INITIALS-A2.
  4559                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4560                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4561                 25 CM-PART-LAST-NAME-A2         PIC X.
  4562
  4563     12  CM-CONTROL-BY-CERT-NO.
  4564         16  CM-COMPANY-CD-A4              PIC X.
  4565         16  CM-CERT-NO-A4                 PIC X(11).
  4566
  4567     12  CM-CONTROL-BY-MEMB.
  4568         16  CM-COMPANY-CD-A5              PIC X.
  4569         16  CM-MEMBER-NO.
  4570             20  CM-MEMB-STATE             PIC XX.
  4571             20  CM-MEMB-ACCOUNT           PIC X(6).
  4572             20  CM-MEMB-LN4.
  4573                 25  CM-INSURED-INITIALS-A5.
  4574                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4575                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4576                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4577
  4578     12  CM-INSURED-PROFILE-DATA.
  4579         16  CM-INSURED-FIRST-NAME.
  4580             20  CM-INSURED-1ST-INIT       PIC X.
  4581             20  FILLER                    PIC X(9).
  4582         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4583         16  CM-INSURED-SEX                PIC X.
  4584             88  CM-SEX-MALE                  VALUE 'M'.
  4585             88  CM-SEX-FEMAL                 VALUE 'F'.
  4586         16  CM-INSURED-JOINT-AGE          PIC 99.
  4587         16  CM-JOINT-INSURED-NAME.
  4588             20  CM-JT-LAST-NAME           PIC X(15).
  4589             20  CM-JT-FIRST-NAME.
  4590                 24  CM-JT-1ST-INIT        PIC X.
  4591                 24  FILLER                PIC X(9).
  4592             20  CM-JT-INITIAL             PIC X.
  4593
  4594     12  CM-LIFE-DATA.
  4595         16  CM-LF-BENEFIT-CD              PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  81
* EL677.cbl
  4596         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4597         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4598         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4599         16  CM-LF-DEV-CODE                PIC XXX.
  4600         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4601         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4602         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4603         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4604         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4605         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4606         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4607         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4608         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4609         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4610         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4611         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4612         16  cm-temp-epiq                  pic xx.
  4613             88  EPIQ-CLASS                  value 'EQ'.
  4614*        16  FILLER                        PIC XX.
  4615
  4616     12  CM-AH-DATA.
  4617         16  CM-AH-BENEFIT-CD              PIC XX.
  4618         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4619         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4620         16  CM-AH-DEV-CODE                PIC XXX.
  4621         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4622         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4623         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4624         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4625         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4626         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4627         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4628         16  CM-AH-PAID-THRU-DT            PIC XX.
  4629             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4630         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4631         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4632         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4633         16  FILLER                        PIC X.
  4634
  4635     12  CM-LOAN-INFORMATION.
  4636         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4637         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4638                                           PIC S9(5)V99  COMP-3.
  4639         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4640         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4641         16  CM-PAY-FREQUENCY              PIC S99.
  4642         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4643         16  CM-RATE-CLASS                 PIC XX.
  4644         16  CM-BENEFICIARY                PIC X(25).
  4645         16  CM-POLICY-FORM-NO             PIC X(12).
  4646         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4647         16  CM-LAST-ADD-ON-DT             PIC XX.
  4648         16  CM-DEDUCTIBLE-AMOUNTS.
  4649             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4650             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4651         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4652             20  CM-RESIDENT-STATE         PIC XX.
  4653             20  CM-RATE-CODE              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  82
* EL677.cbl
  4654             20  FILLER                    PIC XX.
  4655         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4656             20  CM-LOAN-OFFICER           PIC X(5).
  4657             20  FILLER                    PIC XXX.
  4658         16  CM-CSR-CODE                   PIC XXX.
  4659         16  CM-UNDERWRITING-CODE          PIC X.
  4660             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4661         16  CM-POST-CARD-IND              PIC X.
  4662         16  CM-NH-INTERFACE-SW            PIC X.
  4663         16  CM-PREMIUM-TYPE               PIC X.
  4664             88  CM-SING-PRM                  VALUE '1'.
  4665             88  CM-O-B-COVERAGE              VALUE '2'.
  4666             88  CM-OPEN-END                  VALUE '3'.
  4667         16  CM-IND-GRP-TYPE               PIC X.
  4668             88  CM-INDIVIDUAL                VALUE 'I'.
  4669             88  CM-GROUP                     VALUE 'G'.
  4670         16  CM-SKIP-CODE                  PIC X.
  4671             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4672             88  SKIP-JULY                    VALUE '1'.
  4673             88  SKIP-AUGUST                  VALUE '2'.
  4674             88  SKIP-SEPTEMBER               VALUE '3'.
  4675             88  SKIP-JULY-AUG                VALUE '4'.
  4676             88  SKIP-AUG-SEPT                VALUE '5'.
  4677             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4678             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4679             88  SKIP-JUNE                    VALUE '8'.
  4680             88  SKIP-JUNE-JULY               VALUE '9'.
  4681             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4682             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4683         16  CM-PAYMENT-MODE               PIC X.
  4684             88  PAY-MONTHLY                  VALUE SPACE.
  4685             88  PAY-WEEKLY                   VALUE '1'.
  4686             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4687             88  PAY-BI-WEEKLY                VALUE '3'.
  4688             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4689         16  CM-LOAN-NUMBER                PIC X(8).
  4690         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4691         16  CM-OLD-LOF                    PIC XXX.
  4692*        16  CM-LOAN-OFFICER               PIC XXX.
  4693         16  CM-REIN-TABLE                 PIC XXX.
  4694         16  CM-SPECIAL-REIN-CODE          PIC X.
  4695         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4696         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4697         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4698
  4699     12  CM-STATUS-DATA.
  4700         16  CM-ENTRY-STATUS               PIC X.
  4701         16  CM-ENTRY-DT                   PIC XX.
  4702
  4703         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4704         16  CM-LF-CANCEL-DT               PIC XX.
  4705         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4706
  4707         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4708         16  CM-LF-DEATH-DT                PIC XX.
  4709         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4710
  4711         16  CM-LF-CURRENT-STATUS          PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  83
* EL677.cbl
  4712             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4713                                                'M' '4' '5' '9'.
  4714             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4715             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4716             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4717             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4718             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4719             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4720             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4721             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4722             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4723             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4724             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4725             88  CM-LF-DECLINED               VALUE 'D'.
  4726             88  CM-LF-VOIDED                 VALUE 'V'.
  4727
  4728         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4729         16  CM-AH-CANCEL-DT               PIC XX.
  4730         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4731
  4732         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4733         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4734         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4735
  4736         16  CM-AH-CURRENT-STATUS          PIC X.
  4737             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4738                                                'M' '4' '5' '9'.
  4739             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4740             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4741             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4742             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4743             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4744             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4745             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4746             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4747             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4748             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4749             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4750             88  CM-AH-DECLINED               VALUE 'D'.
  4751             88  CM-AH-VOIDED                 VALUE 'V'.
  4752
  4753         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4754             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4755             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4756             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4757         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4758
  4759         16  CM-ENTRY-BATCH                PIC X(6).
  4760         16  CM-LF-EXIT-BATCH              PIC X(6).
  4761         16  CM-AH-EXIT-BATCH              PIC X(6).
  4762         16  CM-LAST-MONTH-END             PIC XX.
  4763
  4764     12  CM-NOTE-SW                        PIC X.
  4765         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4766         88  CERT-NOTES-PRESENT               VALUE '1'.
  4767         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4768         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4769         88  CLAIM-NOTES-PRESENT              VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  84
* EL677.cbl
  4770         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4771         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4772         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4773     12  CM-COMP-EXCP-SW                   PIC X.
  4774         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4775         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4776     12  CM-INSURED-ADDRESS-SW             PIC X.
  4777         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4778         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4779
  4780*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4781     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4782     12  FILLER                            PIC X.
  4783
  4784*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4785     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4786     12  FILLER                            PIC X.
  4787*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4788     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  4789
  4790     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4791         88  CERT-ADDED-BATCH                 VALUE ' '.
  4792         88  CERT-ADDED-ONLINE                VALUE '1'.
  4793         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4794         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4795         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4796     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4797         88  CERT-AS-LOADED                   VALUE ' '.
  4798         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4799         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4800         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4801         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4802         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4803         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4804         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4805
  4806     12  CM-ACCOUNT-COMM-PCTS.
  4807         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4808         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4809
  4810     12  CM-USER-FIELD                     PIC X.
  4811     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4812     12  CM-CLP-STATE                      PIC XX.
  4813     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4814     12  CM-USER-RESERVED                  PIC XXX.
  4815     12  FILLER REDEFINES CM-USER-RESERVED.
  4816         16  CM-AH-CLASS-CD                PIC XX.
  4817         16  F                             PIC X.
  4818******************************************************************
  4819*                                    COPY ERCPNDB.
  4820******************************************************************
  4821*                                                                *
  4822*                                                                *
  4823*                            ERCPNDB.                            *
  4824*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4825*                            VMOD=2.025                          *
  4826*                                                                *
  4827*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  85
* EL677.cbl
  4828*                                                                *
  4829******************************************************************
  4830*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4831*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4832******************************************************************
  4833*                                                                *
  4834*                                                                *
  4835*   FILE TYPE = VSAM,KSDS                                        *
  4836*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4837*                                                                *
  4838*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4839*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4840*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4841*                                                 RKP=13,LEN=36  *
  4842*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4843*                                      AND CHG-SEQ.)             *
  4844*                                                RKP=49,LEN=11   *
  4845*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4846*                                      AND CHG-SEQ.)             *
  4847*                                                RKP=60,LEN=15   *
  4848*                                                                *
  4849*   LOG = NO                                                     *
  4850*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4851******************************************************************
  4852******************************************************************
  4853*                   C H A N G E   L O G
  4854*
  4855* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4856*-----------------------------------------------------------------
  4857*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4858* EFFECTIVE    NUMBER
  4859*-----------------------------------------------------------------
  4860* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4861* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4862* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4863* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4864* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4865* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4866* 032306                   PEMA  ADD BOW LOAN NUMBER
  4867* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4868* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4869* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4870* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4871* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4872* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4873* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4874* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4875* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4876* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4877* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4878******************************************************************
  4879
  4880 01  PENDING-BUSINESS.
  4881     12  PB-RECORD-ID                     PIC XX.
  4882         88  VALID-PB-ID                        VALUE 'PB'.
  4883
  4884     12  PB-CONTROL-PRIMARY.
  4885         16  PB-COMPANY-CD                PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  86
* EL677.cbl
  4886         16  PB-ENTRY-BATCH               PIC X(6).
  4887         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4888         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4889
  4890     12  PB-CONTROL-BY-ACCOUNT.
  4891         16  PB-COMPANY-CD-A1             PIC X.
  4892         16  PB-CARRIER                   PIC X.
  4893         16  PB-GROUPING.
  4894             20  PB-GROUPING-PREFIX       PIC XXX.
  4895             20  PB-GROUPING-PRIME        PIC XXX.
  4896         16  PB-STATE                     PIC XX.
  4897         16  PB-ACCOUNT.
  4898             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4899             20  PB-ACCOUNT-PRIME         PIC X(6).
  4900         16  PB-CERT-EFF-DT               PIC XX.
  4901         16  PB-CERT-NO.
  4902             20  PB-CERT-PRIME            PIC X(10).
  4903             20  PB-CERT-SFX              PIC X.
  4904         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4905
  4906         16  PB-RECORD-TYPE               PIC X.
  4907             88  PB-MAILING-DATA                VALUE '0'.
  4908             88  PB-ISSUE                       VALUE '1'.
  4909             88  PB-CANCELLATION                VALUE '2'.
  4910             88  PB-BATCH-TRAILER               VALUE '9'.
  4911
  4912     12  PB-CONTROL-BY-ORIG-BATCH.
  4913         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4914         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4915         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4916         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4917
  4918     12  PB-CONTROL-BY-CSR.
  4919         16  PB-CSR-COMPANY-CD            PIC X.
  4920         16  PB-CSR-ID                    PIC X(4).
  4921         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4922         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4923         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4924******************************************************************
  4925*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4926******************************************************************
  4927
  4928     12  PB-LAST-MAINT-DT                 PIC XX.
  4929     12  PB-LAST-MAINT-BY                 PIC X(4).
  4930     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4931
  4932     12  PB-RECORD-BODY                   PIC X(375).
  4933
  4934     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4935         16  PB-CERT-ORIGIN               PIC X.
  4936             88  CLASIC-CREATED-CERT         VALUE '1'.
  4937         16  PB-I-NAME.
  4938             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4939             20  PB-I-INSURED-FIRST-NAME.
  4940                 24  PB-I-INSURED-1ST-INIT PIC X.
  4941                 24  FILLER                PIC X(9).
  4942             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4943         16  PB-I-AGE                     PIC S99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  87
* EL677.cbl
  4944         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4945         16  PB-I-BIRTHDAY                PIC XX.
  4946         16  PB-I-INSURED-SEX             PIC X.
  4947             88  PB-SEX-MALE     VALUE 'M'.
  4948             88  PB-SEX-FEMALE   VALUE 'F'.
  4949
  4950         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4951         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4952         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4953         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4954         16  PB-I-SKIP-CODE               PIC X.
  4955             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4956             88  PB-SKIP-JULY              VALUE '1'.
  4957             88  PB-SKIP-AUGUST            VALUE '2'.
  4958             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4959             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4960             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4961             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4962             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4963             88  PB-SKIP-JUNE              VALUE '8'.
  4964             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4965             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4966             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4967         16  PB-I-TERM-TYPE               PIC X.
  4968             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4969             88  PB-PAID-WEEKLY            VALUE 'W'.
  4970             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4971             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4972             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4973         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4974         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4975         16  PB-I-DATA-ENTRY-SW           PIC X.
  4976             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4977             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4978             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4979             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4980         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4981         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4982*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4983         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4984         16  FILLER                       PIC X.
  4985
  4986         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4987             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4988             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4989                                                   '90' THRU '99'.
  4990         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4991                                          PIC XX.
  4992         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4993         16  PB-I-AMOUNT-FINANCED REDEFINES
  4994                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4995         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4996         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4997                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4998         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4999         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  5000         16  PB-I-CLP-AMOUNT REDEFINES
  5001                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  88
* EL677.cbl
  5002         16  PB-I-LF-CALC-FLAG            PIC X.
  5003             88 PB-COMP-LF-PREM               VALUE '?'.
  5004         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  5005         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  5006         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  5007         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  5008         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  5009         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  5010         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  5011         16  PB-I-LF-ABBR                 PIC XXX.
  5012         16  PB-I-LF-INPUT-CD             PIC XX.
  5013
  5014         16  PB-I-AH-BENEFIT-CD           PIC XX.
  5015             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  5016             88  PB-INVALID-AH               VALUE '  ' '00'
  5017                                                   '90' THRU '99'.
  5018         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  5019         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  5020         16  PB-I-AH-CALC-FLAG            PIC X.
  5021             88 PB-COMP-AH-PREM                  VALUE '?'.
  5022         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  5023         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  5024         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  5025         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  5026         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  5027         16  PB-I-AH-ABBR                 PIC XXX.
  5028         16  PB-I-AH-INPUT-CD             PIC XXX.
  5029
  5030         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  5031         16  PB-I-REIN-TABLE              PIC XXX.
  5032         16  PB-I-BUSINESS-TYPE           PIC 99.
  5033         16  PB-I-INDV-GRP-CD             PIC X.
  5034         16  PB-I-MORT-CODE.
  5035             20  PB-I-TABLE               PIC X.
  5036             20  PB-I-INTEREST            PIC XX.
  5037             20  PB-I-MORT-TYP            PIC X.
  5038         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  5039         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  5040         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  5041         16  PB-I-INDV-GRP-OVRD           PIC X.
  5042         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  5043         16  PB-I-SIG-SW                  PIC X.
  5044             88  PB-POLICY-SIGNED             VALUE 'Y'.
  5045         16  PB-I-RATE-CLASS              PIC XX.
  5046         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  5047         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  5048         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  5049         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  5050         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  5051         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  5052         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  5053         16  PB-I-BENEFIT-TYPE            PIC XXX.
  5054         16  PB-I-OB-FLAG                 PIC X.
  5055             88  PB-I-OB                      VALUE 'B'.
  5056             88  PB-I-SUMMARY                 VALUE 'Z'.
  5057         16  PB-I-ENTRY-STATUS            PIC X.
  5058             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  5059                                              'M' '5' '9' '2'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  89
* EL677.cbl
  5060             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  5061             88  PB-I-POLICY-PENDING          VALUE '2'.
  5062             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  5063             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  5064             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  5065             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  5066             88  PB-I-REIN-ONLY               VALUE '9'.
  5067             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  5068             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  5069             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  5070             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  5071         16  PB-I-INT-CODE                PIC X.
  5072             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  5073             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  5074         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  5075         16  PB-I-SOC-SEC-NO              PIC X(11).
  5076         16  PB-I-MEMBER-NO               PIC X(12).
  5077         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  5078*        16  PB-I-LOAN-OFFICER            PIC XXX.
  5079         16  PB-I-OLD-LOF                 PIC XXX.
  5080         16  PB-I-LF-EXPIRE-DT            PIC XX.
  5081         16  PB-I-AH-EXPIRE-DT            PIC XX.
  5082         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  5083         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  5084         16  PB-I-LIFE-INDICATOR          PIC X.
  5085             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  5086         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  5087         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  5088                                          PIC S9(5)V99    COMP-3.
  5089         16  PB-I-MAIL-ADDRS-SW           PIC X.
  5090             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  5091             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  5092         16  PB-I-1ST-PMT-DT              PIC XX.
  5093         16  PB-I-JOINT-INSURED.
  5094             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  5095             20 PB-I-JOINT-FIRST-NAME.
  5096                24  PB-I-JOINT-FIRST-INIT PIC X.
  5097                24  FILLER                PIC X(9).
  5098             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  5099*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  5100         16  PB-I-BENEFICIARY-NAME.
  5101             20  PB-I-BANK-NUMBER         PIC X(10).
  5102             20  FILLER                   PIC X(15).
  5103         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  5104         16  PB-I-REFERENCE               PIC X(12).
  5105         16  FILLER REDEFINES PB-I-REFERENCE.
  5106             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  5107             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  5108             20  PB-I-CLP-STATE           PIC XX.
  5109         16  PB-I-UNDERWRITING-STATUS     PIC X.
  5110             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  5111             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  5112             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  5113         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  5114         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  5115         16  PB-I-RESIDENT-STATE          PIC XX.
  5116         16  PB-I-RATE-CODE               PIC X(4).
  5117         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  90
* EL677.cbl
  5118         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5119         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5120         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  5121         16  PB-I-BANK-NOCHRGB            PIC 99.
  5122         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  5123         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  5124
  5125     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  5126         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  5127             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  5128         16  PB-C-CANCEL-ORIGIN           PIC X.
  5129             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  5130         16  PB-C-LF-CANCEL-DT            PIC XX.
  5131         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5132         16  PB-C-LF-CALC-REQ             PIC X.
  5133             88 PB-COMP-LF-CANCEL            VALUE '?'.
  5134         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  5135         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  5136         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  5137             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  5138         16  PB-C-AH-CANCEL-DT            PIC XX.
  5139         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  5140         16  PB-C-AH-CALC-REQ             PIC X.
  5141             88 PB-COMP-AH-CANCEL            VALUE '?'.
  5142         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  5143         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  5144         16  PB-C-LAST-NAME               PIC X(15).
  5145         16  PB-C-REFUND-SW               PIC X.
  5146             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  5147             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  5148         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  5149         16  PB-C-PAYEE-CODE              PIC X(6).
  5150         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  5151         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  5152         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  5153         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  5154         16  PB-C-REFERENCE               PIC X(12).
  5155         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  5156         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  5157         16  PB-C-POST-CARD-IND           PIC X.
  5158         16  PB-C-CANCEL-REASON           PIC X.
  5159         16  PB-C-REF-INTERFACE-SW        PIC X.
  5160         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  5161         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  5162         16  FILLER                       PIC X(01).
  5163*        16  FILLER                       PIC X(18).
  5164         16  PB-C-POLICY-FORM-NO          PIC X(12).
  5165*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  5166         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  5167         16  PB-CANCELED-CERT-DATA.
  5168             20  PB-CI-INSURED-NAME.
  5169                 24  PB-CI-LAST-NAME      PIC X(15).
  5170                 24  PB-CI-INITIALS       PIC XX.
  5171             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  5172             20  PB-CI-INSURED-SEX        PIC X.
  5173             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  5174             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  5175             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  91
* EL677.cbl
  5176             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  5177             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5178             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  5179             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  5180             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  5181             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  5182             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  5183             20  PB-CI-RATE-CLASS         PIC XX.
  5184             20  PB-CI-RATE-DEV-LF        PIC XXX.
  5185             20  PB-CI-RATE-DEV-AH        PIC XXX.
  5186             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  5187             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  5188             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  5189             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  5190             20  PB-CI-LF-ABBR            PIC X(3).
  5191             20  PB-CI-AH-ABBR            PIC X(3).
  5192             20  PB-CI-OB-FLAG            PIC X.
  5193                 88  PB-CI-OB                VALUE 'B'.
  5194             20  PB-CI-LF-POLICY-STATUS   PIC X.
  5195                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  5196                                           'M' '4' '5' '9' '2'.
  5197                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  5198                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  5199                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  5200                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  5201                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  5202                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  5203                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5204                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  5205                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5206                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  5207                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  5208                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  5209                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  5210             20  PB-CI-AH-POLICY-STATUS   PIC X.
  5211                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  5212                                           'M' '4' '5' '9' '2'.
  5213                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  5214                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  5215                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  5216                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  5217                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  5218                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  5219                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5220                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  5221                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5222                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  5223                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  5224                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  5225                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  5226             20  PB-CI-PAY-FREQUENCY      PIC 99.
  5227             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  5228             20  PB-CI-SOC-SEC-NO         PIC X(11).
  5229             20  PB-CI-MEMBER-NO          PIC X(12).
  5230             20  PB-CI-INT-CODE           PIC X.
  5231                 88  PB-CI-ADD-ON                  VALUE 'A'.
  5232                 88  PB-CI-SIMPLE                  VALUE 'S'.
  5233             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  92
* EL677.cbl
  5234             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  5235             20  PB-CI-COMP-EXCP-SW       PIC X.
  5236                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  5237                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  5238             20  PB-CI-ENTRY-STATUS       PIC X.
  5239             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  5240             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  5241             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  5242             20  PB-CI-DEATH-DT           PIC XX.
  5243             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  5244             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  5245             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5246             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  5247             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  5248             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  5249             20  PB-CI-ENTRY-DT              PIC XX.
  5250             20  PB-CI-ENTRY-BATCH           PIC X(6).
  5251             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  5252             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  5253             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  5254             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  5255             20  PB-CI-OLD-LOF               PIC XXX.
  5256*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  5257             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  5258             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  5259             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  5260             20  PB-CI-INDV-GRP-CD           PIC X.
  5261             20  PB-CI-BENEFICIARY-NAME.
  5262                 24  PB-CI-BANK-NUMBER       PIC X(10).
  5263                 24  FILLER                  PIC X(15).
  5264             20  PB-CI-NOTE-SW               PIC X.
  5265             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  5266             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  5267             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  5268             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  5269             20  PB-CI-LOAN-OFFICER          PIC X(5).
  5270             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  5271             20  PB-CI-FIRST-NAME            PIC X(10).
  5272             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  5273
  5274         16  FILLER                       PIC X(13).
  5275*032306  16  FILLER                       PIC X(27).
  5276*        16  FILLER                       PIC X(46).
  5277
  5278     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  5279         16  FILLER                       PIC X(10).
  5280         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  5281         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  5282         16  PB-M-INSURED-MID-INIT        PIC X.
  5283         16  PB-M-INSURED-AGE             PIC 99.
  5284         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  5285         16  PB-M-INSURED-SEX             PIC X.
  5286         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  5287         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  5288         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  5289         16  PB-M-INSURED-CITY-STATE.
  5290             20  PB-M-INSURED-CITY        PIC X(28).
  5291             20  PB-M-INSURED-STATE       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  93
* EL677.cbl
  5292         16  PB-M-INSURED-ZIP-CODE.
  5293             20  PB-M-INSURED-ZIP-PRIME.
  5294                 24  PB-M-INSURED-ZIP-1   PIC X.
  5295                     88  PB-M-CANADIAN-POST-CODE
  5296                                             VALUE 'A' THRU 'Z'.
  5297                 24  FILLER               PIC X(4).
  5298             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  5299         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  5300                                        PB-M-INSURED-ZIP-CODE.
  5301             20  PM-M-INS-CAN-POST1       PIC XXX.
  5302             20  PM-M-INS-CAN-POST2       PIC XXX.
  5303             20  FILLER                   PIC XXX.
  5304         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  5305         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  5306         16  PB-M-CRED-BENE-NAME          PIC X(30).
  5307         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  5308         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  5309         16  PB-M-CRED-BENE-CITYST.
  5310             20  PB-M-CRED-BENE-CITY      PIC X(28).
  5311             20  PB-M-CRED-BENE-STATE     PIC XX.
  5312         16  FILLER                       PIC X(92).
  5313
  5314     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  5315         16  FILLER                       PIC X(10).
  5316         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5317         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5318         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5319         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5320         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5321         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5322         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5323         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5324         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5325         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  5326         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  5327         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  5328         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  5329         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  5330         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  5331         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  5332         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  5333         16  PB-ACCOUNT-NAME              PIC X(30).
  5334         16  PB-PREM-REF-RPT-FLAG         PIC X.
  5335         16  PB-REFERENCE                 PIC X(12).
  5336         16  PB-B-RECEIVED-DT             PIC XX.
  5337         16  FILLER                       PIC X(234).
  5338
  5339     12  PB-RECORD-STATUS.
  5340         16  PB-CREDIT-SELECT-DT          PIC XX.
  5341         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  5342         16  PB-BILLED-DT                 PIC XX.
  5343         16  PB-BILLING-STATUS            PIC X.
  5344             88  PB-ENTRY-REVERSED            VALUE 'R'.
  5345             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  5346             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  5347         16  PB-RECORD-BILL               PIC X.
  5348             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  5349             88  PB-RECORD-RETURNED           VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  94
* EL677.cbl
  5350             88  PB-RECORD-ENDORSED           VALUE 'E'.
  5351             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  5352             88  PB-OVERRIDE-AH               VALUE 'A'.
  5353             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  5354         16  PB-BATCH-ENTRY               PIC X.
  5355             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  5356             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  5357             88  PB-REISSUED-CERT             VALUE 'E'.
  5358             88  PB-CASH-CERT                 VALUE 'C'.
  5359             88  PB-MONTHLY-CERT              VALUE 'M'.
  5360             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  5361             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  5362             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  5363         16  PB-FORCE-CODE                PIC X.
  5364             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  5365             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  5366             88  PB-CANCEL-FORCE              VALUE '8'.
  5367             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  5368             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  5369             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  5370             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  5371             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  5372             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  5373             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  5374             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  5375         16  PB-FATAL-FLAG                PIC X.
  5376             88  PB-FATAL-ERRORS              VALUE 'X'.
  5377         16  PB-FORCE-ER-CD               PIC X.
  5378             88  PB-FORCE-ERRORS              VALUE 'F'.
  5379             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  5380         16  PB-WARN-ER-CD                PIC X.
  5381             88  PB-WARNING-ERRORS            VALUE 'W'.
  5382         16  FILLER                       PIC X.
  5383         16  PB-OUT-BAL-CD                PIC X.
  5384             88  PB-OUT-OF-BAL                VALUE 'O'.
  5385         16  PB-LIFE-OVERRIDE-L1          PIC X.
  5386         16  PB-AH-OVERRIDE-L1            PIC X.
  5387         16  PB-INPUT-DT                  PIC XX.
  5388         16  PB-INPUT-BY                  PIC X(4).
  5389         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  5390         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  5391         16  PB-TOLERANCE-REJECT-SW       PIC X.
  5392         16  PB-LF-EARNING-METHOD         PIC X.
  5393         16  PB-AH-EARNING-METHOD         PIC X.
  5394         16  PB-LF-TERM-CALC-METHOD       PIC X.
  5395         16  PB-AH-TERM-CALC-METHOD       PIC X.
  5396         16  PB-REIN-CD                   PIC XXX.
  5397         16  PB-LF-REFUND-TYPE            PIC X.
  5398         16  PB-AH-REFUND-TYPE            PIC X.
  5399         16  PB-ACCT-EFF-DT               PIC XX.
  5400         16  PB-ACCT-EXP-DT               PIC XX.
  5401         16  PB-COMPANY-ID                PIC X(3).
  5402         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5403         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  5404         16  PB-SV-CARRIER                PIC X.
  5405         16  PB-SV-GROUPING               PIC X(6).
  5406         16  PB-SV-STATE                  PIC XX.
  5407         16  PB-CONFIRMATION-REPT-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  95
* EL677.cbl
  5408         16  PB-GA-BILLING-INFO.
  5409             20  PB-GA-BILL-DT OCCURS 5 TIMES
  5410                                          PIC XX.
  5411         16  PB-SV-REMIT-TO  REDEFINES
  5412             PB-GA-BILLING-INFO           PIC X(10).
  5413         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  5414         16  PB-I-LOAN-OFFICER            PIC X(5).
  5415         16  PB-I-VIN                     PIC X(17).
  5416
  5417         16  FILLER                       PIC X(04).
  5418         16  IMNET-BYPASS-SW              PIC X.
  5419
  5420******************************************************************
  5421*                COMMON EDIT ERRORS                              *
  5422******************************************************************
  5423
  5424     12  PB-COMMON-ERRORS.
  5425         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  5426                                           PIC S9(4)     COMP.
  5427
  5428******************************************************************
  5429*                                    COPY ERCPNDM.
  5430******************************************************************
  5431*                                                                *
  5432*                                                                *
  5433*                            ERCPNDM                             *
  5434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5435*                            VMOD=2.003                          *
  5436*                                                                *
  5437*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5438*                                                                *
  5439*   FILE TYPE = VSAM,KSDS                                        *
  5440*   RECORD SIZE = 374   RECFORM = FIX                            *
  5441*                                                                *
  5442*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5443*   ALTERNATE PATH    = NOT USED                                 *
  5444*                                                                *
  5445*   LOG = YES                                                    *
  5446*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5447******************************************************************
  5448*                   C H A N G E   L O G
  5449*
  5450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5451*-----------------------------------------------------------------
  5452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5453* EFFECTIVE    NUMBER
  5454*-----------------------------------------------------------------
  5455* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5456* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5457* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5458******************************************************************
  5459
  5460 01  PENDING-MAILING-DATA.
  5461     12  PM-RECORD-ID                      PIC XX.
  5462         88  VALID-MA-ID                       VALUE 'PM'.
  5463
  5464     12  PM-CONTROL-PRIMARY.
  5465         16  PM-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  96
* EL677.cbl
  5466         16  PM-ENTRY-BATCH                PIC X(6).
  5467         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5468         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5469
  5470     12  FILLER                            PIC X(14).
  5471
  5472     12  PM-ACCESS-CONTROL.
  5473         16  PM-SOURCE-SYSTEM              PIC XX.
  5474             88  PM-FROM-CREDIT                VALUE 'CR'.
  5475             88  PM-FROM-VSI                   VALUE 'VS'.
  5476             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5477             88  PM-FROM-OTHER                 VALUE 'OT'.
  5478         16  PM-RECORD-ADD-DT              PIC XX.
  5479         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5480         16  PM-LAST-MAINT-DT              PIC XX.
  5481         16  PM-LAST-MAINT-BY              PIC XXXX.
  5482         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5483
  5484     12  PM-PROFILE-INFO.
  5485         16  PM-QUALIFY-CODE-1             PIC XX.
  5486         16  PM-QUALIFY-CODE-2             PIC XX.
  5487         16  PM-QUALIFY-CODE-3             PIC XX.
  5488         16  PM-QUALIFY-CODE-4             PIC XX.
  5489         16  PM-QUALIFY-CODE-5             PIC XX.
  5490
  5491         16  PM-INSURED-LAST-NAME          PIC X(15).
  5492         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5493         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5494         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5495         16  PM-INSURED-BIRTH-DT           PIC XX.
  5496         16  PM-INSURED-SEX                PIC X.
  5497             88  PM-SEX-MALE                   VALUE 'M'.
  5498             88  PM-SEX-FEMALE                 VALUE 'F'.
  5499         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5500
  5501         16  PM-ADDRESS-CORRECTED          PIC X.
  5502         16  PM-JOINT-BIRTH-DT             PIC XX.
  5503*        16  FILLER                        PIC X(12).
  5504
  5505         16  PM-ADDRESS-LINE-1             PIC X(30).
  5506         16  PM-ADDRESS-LINE-2             PIC X(30).
  5507         16  PM-CITY-STATE.
  5508             20  PM-CITY                   PIC X(28).
  5509             20  PM-STATE                  PIC XX.
  5510         16  PM-ZIP.
  5511             20  PM-ZIP-CODE.
  5512                 24  PM-ZIP-1              PIC X.
  5513                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5514                 24  FILLER                PIC X(4).
  5515             20  PM-ZIP-PLUS4              PIC X(4).
  5516         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5517             20  PM-CAN-POST1              PIC XXX.
  5518             20  PM-CAN-POST2              PIC XXX.
  5519             20  FILLER                    PIC XXX.
  5520
  5521         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5522
  5523         16  FILLER                        PIC X(03).
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  97
* EL677.cbl
  5524
  5525     12  PM-CRED-BENE-INFO.
  5526         16  PM-CRED-BENE-NAME             PIC X(25).
  5527         16  PM-CRED-BENE-ADDR             PIC X(30).
  5528         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5529         16  PM-CRED-BENE-CTYST.
  5530             20  PM-CRED-BENE-CITY         PIC X(28).
  5531             20  PM-CRED-BENE-STATE        PIC XX.
  5532         16  PM-CRED-BENE-ZIP.
  5533             20  PM-CB-ZIP-CODE.
  5534                 24  PM-CB-ZIP-1           PIC X.
  5535                     88  PM-CB-CANADIAN-POST-CODE
  5536                                  VALUE 'A' THRU 'Z'.
  5537                 24  FILLER                PIC X(4).
  5538             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5539         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5540             20  PM-CB-CAN-POST1           PIC XXX.
  5541             20  PM-CB-CAN-POST2           PIC XXX.
  5542             20  FILLER                    PIC XXX.
  5543     12  PM-POST-CARD-MAIL-DATA.
  5544         16  PM-MAIL-DATA OCCURS 7.
  5545             20  PM-MAIL-TYPE              PIC X.
  5546                 88  PM-12MO-MAILING           VALUE '1'.
  5547                 88  PM-EXP-MAILING            VALUE '2'.
  5548             20  PM-MAIL-STATUS            PIC X.
  5549                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5550                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5551                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5552             20  PM-MAIL-DATE              PIC XX.
  5553     12  FILLER                            PIC XX.
  5554     12  FILLER                            PIC X(12).
  5555*    12  FILLER                            PIC X(30).
  5556
  5557******************************************************************
  5558*                                    COPY ERCMAIL.
  5559******************************************************************
  5560*                                                                *
  5561*                                                                *
  5562*                            ERCMAIL                             *
  5563*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5564*                            VMOD=2.003                          *
  5565*                                                                *
  5566*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5567*                                                                *
  5568*   FILE TYPE = VSAM,KSDS                                        *
  5569*   RECORD SIZE = 374   RECFORM = FIX                            *
  5570*                                                                *
  5571*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5572*   ALTERNATE PATH    = NOT USED                                 *
  5573*                                                                *
  5574*   LOG = YES                                                    *
  5575*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5576******************************************************************
  5577*                   C H A N G E   L O G
  5578*
  5579* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5580*-----------------------------------------------------------------
  5581*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  98
* EL677.cbl
  5582* EFFECTIVE    NUMBER
  5583*-----------------------------------------------------------------
  5584* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5585* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5586* 111108                   PEMA  ADD CRED BENE ADDR2
  5587******************************************************************
  5588
  5589 01  MAILING-DATA.
  5590     12  MA-RECORD-ID                      PIC XX.
  5591         88  VALID-MA-ID                       VALUE 'MA'.
  5592
  5593     12  MA-CONTROL-PRIMARY.
  5594         16  MA-COMPANY-CD                 PIC X.
  5595         16  MA-CARRIER                    PIC X.
  5596         16  MA-GROUPING.
  5597             20  MA-GROUPING-PREFIX        PIC XXX.
  5598             20  MA-GROUPING-PRIME         PIC XXX.
  5599         16  MA-STATE                      PIC XX.
  5600         16  MA-ACCOUNT.
  5601             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5602             20  MA-ACCOUNT-PRIME          PIC X(6).
  5603         16  MA-CERT-EFF-DT                PIC XX.
  5604         16  MA-CERT-NO.
  5605             20  MA-CERT-PRIME             PIC X(10).
  5606             20  MA-CERT-SFX               PIC X.
  5607
  5608     12  FILLER                            PIC XX.
  5609
  5610     12  MA-ACCESS-CONTROL.
  5611         16  MA-SOURCE-SYSTEM              PIC XX.
  5612             88  MA-FROM-CREDIT                VALUE 'CR'.
  5613             88  MA-FROM-VSI                   VALUE 'VS'.
  5614             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5615             88  MA-FROM-OTHER                 VALUE 'OT'.
  5616         16  MA-RECORD-ADD-DT              PIC XX.
  5617         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5618         16  MA-LAST-MAINT-DT              PIC XX.
  5619         16  MA-LAST-MAINT-BY              PIC XXXX.
  5620         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5621
  5622     12  MA-PROFILE-INFO.
  5623         16  MA-QUALIFY-CODE-1             PIC XX.
  5624         16  MA-QUALIFY-CODE-2             PIC XX.
  5625         16  MA-QUALIFY-CODE-3             PIC XX.
  5626         16  MA-QUALIFY-CODE-4             PIC XX.
  5627         16  MA-QUALIFY-CODE-5             PIC XX.
  5628
  5629         16  MA-INSURED-LAST-NAME          PIC X(15).
  5630         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5631         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5632         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5633         16  MA-INSURED-BIRTH-DT           PIC XX.
  5634         16  MA-INSURED-SEX                PIC X.
  5635             88  MA-SEX-MALE                   VALUE 'M'.
  5636             88  MA-SEX-FEMALE                 VALUE 'F'.
  5637         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5638
  5639         16  MA-ADDRESS-CORRECTED          PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page  99
* EL677.cbl
  5640         16  MA-JOINT-BIRTH-DT             PIC XX.
  5641*        16  FILLER                        PIC X(12).
  5642
  5643         16  MA-ADDRESS-LINE-1             PIC X(30).
  5644         16  MA-ADDRESS-LINE-2             PIC X(30).
  5645         16  MA-CITY-STATE.
  5646             20  MA-CITY                   PIC X(28).
  5647             20  MA-ADDR-STATE             PIC XX.
  5648         16  MA-ZIP.
  5649             20  MA-ZIP-CODE.
  5650                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5651                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5652                 24  FILLER                PIC X(4).
  5653             20  MA-ZIP-PLUS4              PIC X(4).
  5654         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5655             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5656             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5657             20  FILLER                    PIC X(3).
  5658
  5659         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5660
  5661         16  FILLER                        PIC XXX.
  5662*        16  FILLER                        PIC X(10).
  5663
  5664     12  MA-CRED-BENE-INFO.
  5665         16  MA-CRED-BENE-NAME                 PIC X(25).
  5666         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5667         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5668         16  MA-CRED-BENE-CTYST.
  5669             20  MA-CRED-BENE-CITY             PIC X(28).
  5670             20  MA-CRED-BENE-STATE            PIC XX.
  5671         16  MA-CRED-BENE-ZIP.
  5672             20  MA-CB-ZIP-CODE.
  5673                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5674                     88  MA-CB-CANADIAN-POST-CODE
  5675                                           VALUE 'A' THRU 'Z'.
  5676                 24  FILLER                    PIC X(4).
  5677             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5678         16  MA-CB-CANADIAN-POSTAL-CODE
  5679                            REDEFINES MA-CRED-BENE-ZIP.
  5680             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5681             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5682             20  FILLER                        PIC X(3).
  5683     12  MA-POST-CARD-MAIL-DATA.
  5684         16  MA-MAIL-DATA OCCURS 7.
  5685             20  MA-MAIL-TYPE              PIC X.
  5686                 88  MA-12MO-MAILING           VALUE '1'.
  5687                 88  MA-EXP-MAILING            VALUE '2'.
  5688             20  MA-MAIL-STATUS            PIC X.
  5689                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5690                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5691                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5692             20  MA-MAIL-DATE              PIC XX.
  5693     12  FILLER                            PIC XX.
  5694     12  FILLER                            PIC XX.
  5695*    12  FILLER                            PIC X(30).
  5696******************************************************************
  5697*                                    COPY ERCPYAJ.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 100
* EL677.cbl
  5698******************************************************************
  5699*                                                                *
  5700*                            ERCPYAJ                             *
  5701*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5702*                            VMOD=2.015                          *
  5703*                                                                *
  5704*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  5705*                                                                *
  5706*                                                                *
  5707*   FILE TYPE = VSAM,KSDS                                        *
  5708*   RECORD SIZE = 200  RECFORM = FIXED                           *
  5709*                                                                *
  5710*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  5711*       ALTERNATE PATHS = NONE                                   *
  5712*                                                                *
  5713*   LOG = YES                                                    *
  5714*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5715******************************************************************
  5716******************************************************************
  5717*                   C H A N G E   L O G
  5718*
  5719* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5720*-----------------------------------------------------------------
  5721*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5722* EFFECTIVE    NUMBER
  5723*-----------------------------------------------------------------
  5724* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  5725* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  5726******************************************************************
  5727
  5728 01  PENDING-PAY-ADJ.
  5729     12  PY-RECORD-ID                     PIC XX.
  5730         88  VALID-PY-ID                        VALUE 'PY'.
  5731
  5732     12  PY-CONTROL-PRIMARY.
  5733         16  PY-COMPANY-CD                PIC X.
  5734         16  PY-CARRIER                   PIC X.
  5735         16  PY-GROUPING                  PIC X(6).
  5736         16  PY-FIN-RESP                  PIC X(10).
  5737         16  PY-ACCOUNT                   PIC X(10).
  5738         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  5739                                          PIC X(10).
  5740         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  5741         16  PY-RECORD-TYPE               PIC X.
  5742             88  PY-REMIT-RECEIVED            VALUE 'R'.
  5743             88  PY-DEPOSIT                   VALUE 'D'.
  5744             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  5745             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  5746             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  5747             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  5748             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  5749             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  5750             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  5751             88  PY-FICA-ENTRY                VALUE 'F'.
  5752             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  5753             88  PY-POLICY-FEE                VALUE 'W'.
  5754             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  5755
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 101
* EL677.cbl
  5756     12  PY-PYMT-TYPE                     PIC X.
  5757             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  5758             88  PY-REINS-PYMT                VALUE 'R'.
  5759             88  PY-EXP-PYMT                  VALUE 'E'.
  5760
  5761     12  PY-BIL-INV                       PIC X(6).
  5762     12  PY-REF-NO                        PIC X(12).
  5763
  5764     12  PY-LAST-MAINT-DT                 PIC XX.
  5765     12  PY-LAST-MAINT-BY                 PIC X(4).
  5766     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5767
  5768     12  PY-PYADJ-RECORD.
  5769         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  5770         16  PY-ENTRY-COMMENT             PIC X(30).
  5771         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  5772             20  PY-GL-ACCOUNT            PIC X(10).
  5773             20  PY-GL-STATE              PIC X(02).
  5774             20  PY-GL-CANC-SW            PIC X(01).
  5775                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  5776                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  5777             20  PY-GL-COMMENT            PIC X(10).
  5778             20  FILLER      REDEFINES PY-GL-COMMENT.
  5779                 24  PY-GL-CHECK-NO       PIC 9(06).
  5780                 24  FILLER               PIC X(04).
  5781             20  FILLER                   PIC X(07).
  5782         16  PY-SAVE-ACCOUNT              PIC X(10).
  5783         16  PY-SAVE-TYPE                 PIC X(01).
  5784
  5785         16  PY-LETTERS.
  5786             20  PY-LETTER OCCURS 3 TIMES
  5787                           INDEXED BY PY-LET-NDX
  5788                                          PIC X(04).
  5789
  5790         16  PY-ERCOMP-TYPE               PIC X.
  5791             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  5792             88  PY-GA-TYPE                   VALUE 'G'.
  5793             88  PY-BANK-TYPE                 VALUE 'B'.
  5794         16  FILLER                       PIC X(05).
  5795
  5796     12  PY-RECORD-STATUS.
  5797         16  PY-CREDIT-SELECT-DT          PIC XX.
  5798         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  5799         16  PY-BILLED-DATE               PIC XX.
  5800         16  PY-REPORTED-DT               PIC XX.
  5801         16  PY-PMT-APPLIED               PIC X.
  5802             88  PY-ACCOUNT-PMT               VALUE 'A'.
  5803             88  PY-GA-PMT                    VALUE 'G'.
  5804             88  PY-OVWRITE-PMT               VALUE 'O'.
  5805             88  PY-NON-AR-PMT                VALUE 'N'.
  5806         16  FILLER                       PIC X(5).
  5807         16  PY-INPUT-DT                  PIC XX.
  5808         16  PY-CHECK-NUMBER              PIC X(6).
  5809         16  PY-VOID-SW                   PIC X.
  5810             88  PY-CHECK-VOIDED              VALUE 'V'.
  5811         16  PY-CHECK-ORIGIN-SW           PIC X.
  5812             88  PY-BILLING-CHECK             VALUE 'B'.
  5813             88  PY-REFUND-CHECK              VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 102
* EL677.cbl
  5814             88  PY-GA-CHECK                  VALUE 'G'.
  5815             88  PY-CHECK-WRITTEN             VALUE 'W'.
  5816             88  PY-CHECK-REVERSAL            VALUE 'V'.
  5817         16  PY-CHECK-WRITTEN-DT          PIC XX.
  5818         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  5819         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  5820         16  PY-BILL-FLAG                 PIC X.
  5821             88  PY-BILLED                    VALUE 'B'.
  5822         16  PY-AR-FLAG                   PIC X.
  5823             88  PY-AR-CYCLE                  VALUE 'C'.
  5824             88  PY-AR-MONTH-END              VALUE 'M'.
  5825         16  PY-AR-DATE                   PIC XX.
  5826
  5827     12  PY-GL-CODES.
  5828         16  PY-GL-DB                     PIC X(14).
  5829         16  PY-GL-CR                     PIC X(14).
  5830         16  PY-GL-FLAG                   PIC X.
  5831         16  PY-GL-DATE                   PIC XX.
  5832
  5833     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  5834     12  FILLER                           PIC X(3).
  5835******************************************************************
  5836 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR CONTROL-FILE
  5837                          CHECK-RECORDS ACCOUNT-MASTER
  5838                          COMPENSATION-MASTER
  5839                          CERTIFICATE-MASTER PENDING-BUSINESS
  5840                          PENDING-MAILING-DATA MAILING-DATA
  5841                          PENDING-PAY-ADJ.
  5842 0000-DFHEXIT SECTION.
  5843     MOVE '9#                    $   ' TO DFHEIV0.
  5844     MOVE 'EL677' TO DFHEIV1.
  5845     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5846
  5847     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5848     MOVE '5'                    TO  DC-OPTION-CODE.
  5849     PERFORM 8500-DATE-CONVERT.
  5850     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  5851     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  5852     MOVE DC-GREG-DATE-1-MDY     TO  SAVE-CURRENT-DATE-MDY.
  5853
  5854     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  5855
  5856     IF PI-AMOUNT NOT NUMERIC
  5857         MOVE ZEROS              TO  PI-AMOUNT.
  5858
  5859     IF EIBCALEN = 0
  5860         GO TO 8800-UNAUTHORIZED-ACCESS.
  5861     set P to address of KIXSYS
  5862     CALL "getenv" using by value P returning var-ptr
  5863     if var-ptr = null then
  5864        display ' kixsys not set '
  5865     else
  5866        set address of var to var-ptr
  5867        move 0 to env-var-len
  5868        inspect var tallying env-var-len
  5869          for characters before X'00'
  5870        unstring var (1:env-var-len) delimited by '/'
  5871           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 103
* EL677.cbl
  5872              WS-KIX-SYS
  5873        end-unstring
  5874     end-if
  5875     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  5876     MOVE 2                      TO  EMI-SWITCH2.
  5877     MOVE EIBTRMID               TO  QID-TERM.
  5878
  5879     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  5880         MOVE PI-CALLING-PROGRAM TO  RETURNED-FROM.
  5881
  5882     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5883         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5884             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  5885             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  5886             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  5887             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  5888             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  5889             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  5890             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  5891             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  5892         ELSE
  5893             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  5894             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  5895             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  5896             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  5897             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  5898             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  5899             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  5900             MOVE SPACES               TO  PI-SAVED-PROGRAM-6.
  5901
  5902     MOVE LOW-VALUES             TO  EL677AI.
  5903
  5904     if eibtrnid not = trans-id
  5905        evaluate true
  5906           when pi-return-to-program = 'EL6315'
  5907              move pi-company-cd to pi-chek-comp-cd
  5908              move pi-carrier    to pi-chek-carrier
  5909              move pi-grouping   to pi-chek-grouping
  5910              move pi-state      to pi-chek-state
  5911              move pi-account    to pi-chek-account
  5912              move pi-cert-eff-dt to pi-chek-eff-dt
  5913              move pi-cert-prime to pi-chek-cert-no
  5914              move pi-cert-sfx   to pi-chek-suf-no
  5915              move +1            to pi-chek-sequence
  5916              move 'C'           to pi-check-type *> Correction
  5917              move 'S'           to mainti
  5918              move +1            to maintl
  5919              move al-uanon      to mainta
  5920              move dfhenter      to eibaid
  5921              go to 5000-browse-file
  5922           when pi-return-to-program = 'EL6318'
  5923              move 'C'           to pi-check-type *> Correction
  5924           when other
  5925              move 'R'           to pi-check-type *> Refund
  5926        end-evaluate
  5927     end-if
  5928     IF EIBTRNID NOT = TRANS-ID
  5929         move pi-processor-id    to pi-return-to
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 104
* EL677.cbl
  5930         move +1                 to dedcynl
  5931         move 'N'                to dedcyno
  5932         move al-uanon           to dedcyna
  5933         move dfhpf7             to eibaid
  5934         perform 6800-browse-previous-chek-recs *> totals up prev
  5935                                 thru 6800-exit
  5936         perform 5600-get-erpndb thru 5600-exit *> calc refund on
  5937                                                *> pending record
  5938         IF PI-TO-EL677-FROM-EL1273
  5939             MOVE 'S'            TO MAINTI
  5940             MOVE 1              TO MAINTL
  5941             MOVE AL-UABON       TO MAINTA
  5942             MOVE DFHENTER       TO EIBAID
  5943             GO TO 5000-BROWSE-FILE.
  5944
  5945     IF EIBTRNID NOT = TRANS-ID
  5946        IF RETURNED-FROM = XCTL-1273 OR XCTL-114
  5947           PERFORM 7200-RECOVER-TEMP-STORAGE THRU 7200-EXIT
  5948           PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5949           IF PI-PROCESS-BENEFICIARY
  5950              GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5951           ELSE
  5952              GO TO 6300-BUILD-CERT-SCREEN
  5953           end-if
  5954        ELSE
  5955           IF EIBTRNID NOT = EL6311-TRANS-ID and el6318-trans-id
  5956              GO TO 8100-SEND-INITIAL-MAP
  5957           ELSE
  5958              PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  5959              IF PI-PROCESS-BENEFICIARY
  5960                 GO TO 6600-BUILD-BENEFICIARY-SCREEN
  5961              ELSE
  5962                 GO TO 6300-BUILD-CERT-SCREEN
  5963              end-if
  5964           end-if
  5965        end-if
  5966      end-if
  5967
  5968     MOVE PI-COMPANY-CD          TO  CHEK-COMPANY-CD
  5969                                     PI-CHEK-COMP-CD.
  5970
  5971
  5972* EXEC CICS HANDLE CONDITION
  5973*        PGMIDERR  (9600-PGMID-ERROR)
  5974*        ERROR     (9990-ABEND)
  5975*    END-EXEC.
  5976*    MOVE '"$L.                  ! " #00005874' TO DFHEIV0
  5977     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5978     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5979     MOVE X'2220233030303035383734' TO DFHEIV0(25:11)
  5980     CALL 'kxdfhei1' USING DFHEIV0
  5981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5982
  5983
  5984     IF EIBAID = DFHCLEAR
  5985         GO TO 9400-CLEAR.
  5986
  5987     IF PI-PROCESSOR-ID = 'LGXX'
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 105
* EL677.cbl
  5988         GO TO 0200-RECEIVE.
  5989
  5990
  5991* EXEC CICS READQ TS
  5992*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  5993*        INTO   (SECURITY-CONTROL)
  5994*        LENGTH (SC-COMM-LENGTH)
  5995*        ITEM   (SC-ITEM)
  5996*    END-EXEC.
  5997*    MOVE '*$II   L              ''   #00005885' TO DFHEIV0
  5998     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5999     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6000     MOVE X'2020233030303035383835' TO DFHEIV0(25:11)
  6001     CALL 'kxdfhei1' USING DFHEIV0,
  6002           PI-SECURITY-TEMP-STORE-ID,
  6003           SECURITY-CONTROL,
  6004           SC-COMM-LENGTH,
  6005           SC-ITEM,
  6006           DFHEIV99,
  6007           DFHEIV99
  6008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6009
  6010
  6011     MOVE SC-CREDIT-DISPLAY (17)  TO PI-DISPLAY-CAP.
  6012     MOVE SC-CREDIT-UPDATE  (17)  TO PI-MODIFY-CAP.
  6013
  6014     IF NOT DISPLAY-CAP
  6015         MOVE 'READ'          TO SM-READ
  6016         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6017         MOVE ER-0070         TO  EMI-ERROR
  6018         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6019         GO TO 8100-SEND-INITIAL-MAP.
  6020
  6021 0200-RECEIVE.
  6022     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  6023         MOVE ER-1159            TO  EMI-ERROR
  6024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6025         MOVE -1                 TO  PFENTERL
  6026         GO TO 8200-SEND-DATAONLY.
  6027
  6028
  6029* EXEC CICS HANDLE CONDITION
  6030*        MAPFAIL (8100-SEND-INITIAL-MAP)
  6031*    END-EXEC.
  6032*    MOVE '"$?                   ! # #00005909' TO DFHEIV0
  6033     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  6034     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6035     MOVE X'2320233030303035393039' TO DFHEIV0(25:11)
  6036     CALL 'kxdfhei1' USING DFHEIV0
  6037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6038
  6039
  6040
  6041* EXEC CICS RECEIVE
  6042*        MAP      (EL677A)
  6043*        MAPSET   (MAPSET-NAME)
  6044*        INTO     (EL677AI)
  6045*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 106
* EL677.cbl
  6046     MOVE LENGTH OF
  6047      EL677AI
  6048       TO DFHEIV11
  6049*    MOVE '8"T I  L              ''   #00005913' TO DFHEIV0
  6050     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  6051     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6052     MOVE X'2020233030303035393133' TO DFHEIV0(25:11)
  6053     CALL 'kxdfhei1' USING DFHEIV0,
  6054           EL677A,
  6055           EL677AI,
  6056           DFHEIV11,
  6057           MAPSET-NAME,
  6058           DFHEIV99,
  6059           DFHEIV99
  6060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6061
  6062
  6063     IF PFENTERL GREATER ZERO
  6064         IF EIBAID NOT = DFHENTER
  6065             MOVE ER-0004        TO  EMI-ERROR
  6066             MOVE AL-UNBOF       TO  PFENTERA
  6067             MOVE -1             TO  PFENTERL
  6068             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6069             GO TO 8200-SEND-DATAONLY
  6070         ELSE
  6071             IF (PFENTERI NUMERIC) AND
  6072                (PFENTERI GREATER 0 AND LESS 25)
  6073                 MOVE PF-VALUES (PFENTERI)   TO  EIBAID
  6074             ELSE
  6075                 MOVE ER-0029    TO  EMI-ERROR
  6076                 MOVE AL-UNBOF   TO  PFENTERA
  6077                 MOVE -1         TO  PFENTERL
  6078                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6079                 GO TO 8200-SEND-DATAONLY.
  6080 0300-CHECK-PFKEYS.
  6081     IF EIBAID = DFHPF23
  6082         GO TO 8810-PF23.
  6083
  6084     IF EIBAID = DFHPF24
  6085         GO TO 9200-RETURN-MAIN-MENU.
  6086
  6087     IF EIBAID = DFHPF12
  6088         GO TO 9500-PF12.
  6089
  6090     IF EIBAID = DFHPF1 OR DFHPF2
  6091         GO TO 5000-BROWSE-FILE.
  6092
  6093     if PI-TO-EL677-FROM-EL1273
  6094        and (eibaid not = dfhenter)
  6095        go to 0320-input-error
  6096     end-if
  6097     IF EIBAID = DFHPF3
  6098         PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6099         MOVE 'PF3'              TO  PI-PFKEY
  6100         PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6101         IF PI-RETURN-TO-PROGRAM IS EQUAL TO 'EL1273  '
  6102             GO TO 9400-CLEAR
  6103         ELSE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 107
* EL677.cbl
  6104             MOVE XCTL-1273      TO  PGM-NAME
  6105             GO TO 9300-XCTL.
  6106
  6107     IF EIBAID = DFHPF4
  6108         IF NOT FORCE-CAP
  6109             MOVE ER-0433        TO EMI-ERROR
  6110             MOVE -1             TO PFENTERL
  6111             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6112             GO TO 8200-SEND-DATAONLY.
  6113
  6114     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2 OR DFHPF4 OR
  6115                             DFHPF5 OR DFHPF6 or dfhpf7
  6116         GO TO 1000-EDIT-DATA.
  6117
  6118*    IF EIBAID = DFHPF7
  6119*        PERFORM 7000-SET-PI-AREA         THRU 7090-EXIT
  6120*        PERFORM 7100-CREATE-TEMP-STORAGE THRU 7100-EXIT
  6121*        MOVE XCTL-114           TO  PGM-NAME
  6122*        GO TO 9300-XCTL.
  6123
  6124 0320-INPUT-ERROR.
  6125     MOVE ER-0029                TO  EMI-ERROR.
  6126     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6127     MOVE -1                     TO  PFENTERL.
  6128     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 108
* EL677.cbl
  6130
  6131 1000-EDIT-DATA.
  6132     IF MAINTI = 'S' OR 'C' OR 'A' OR 'V' OR 'D'
  6133         MOVE AL-UANON           TO MAINTA
  6134         IF MAINTI = 'C' OR 'V'
  6135             IF PI-PREV-MAINT = 'S'  OR  'C'
  6136                 NEXT SENTENCE
  6137             ELSE
  6138                 MOVE ER-2056    TO  EMI-ERROR
  6139                 MOVE -1         TO  MAINTL
  6140                 MOVE AL-UABON   TO  MAINTA
  6141                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6142                 GO TO 1100-EDIT-COMPLETE
  6143         ELSE
  6144             NEXT SENTENCE
  6145     ELSE
  6146         IF EIBAID = DFHPF5 OR DFHPF6 or dfhpf7
  6147            NEXT SENTENCE
  6148         ELSE
  6149            MOVE ER-0023            TO  EMI-ERROR
  6150            MOVE -1                 TO  MAINTL
  6151            MOVE AL-UABON           TO  MAINTA
  6152            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6153
  6154     IF MODIFY-CAP
  6155         NEXT SENTENCE
  6156       ELSE
  6157         IF MAINTI NOT = 'S'
  6158            MOVE 'UPDATE'       TO SM-READ
  6159            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  6160            MOVE ER-0070        TO EMI-ERROR
  6161            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6162            GO TO 8100-SEND-INITIAL-MAP.
  6163
  6164     if (pi-return-to-program = 'EL1273')
  6165        and (MAINTI not = 'S' and 'V')
  6166        move 'S'                 to mainti
  6167        move +1                  to maintl
  6168        move al-uanon            to mainta
  6169     end-if
  6170     IF CARRIERI NOT = LOW-VALUES
  6171         MOVE AL-UANON           TO  CARRIERA
  6172         PERFORM 1200-VERIFY-CARRIER-ID THRU 1200-EXIT
  6173         MOVE CARRIERI           TO  PI-CHEK-CARRIER
  6174                                     PI-CARRIER
  6175     ELSE
  6176         MOVE -1                 TO  CARRIERL
  6177         MOVE AL-UABON           TO  CARRIERA
  6178         MOVE ER-0194            TO  EMI-ERROR
  6179         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6180
  6181     IF GROUPI NOT = LOW-VALUES
  6182         MOVE AL-UANON           TO  GROUPA
  6183         MOVE GROUPI             TO  PI-CHEK-GROUPING
  6184                                     PI-GROUPING
  6185     ELSE
  6186         MOVE -1                 TO  GROUPL
  6187         MOVE AL-UABON           TO  GROUPA
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 109
* EL677.cbl
  6188         MOVE ER-0195            TO  EMI-ERROR
  6189         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6190
  6191     IF STATEI NOT = LOW-VALUES
  6192         MOVE AL-UANON           TO  STATEA
  6193         PERFORM 1300-VERIFY-STATE-ID THRU 1390-EXIT
  6194         MOVE STATEI             TO  PI-CHEK-STATE
  6195                                     PI-STATE
  6196     ELSE
  6197         MOVE -1                 TO  STATEL
  6198         MOVE AL-UABON           TO  STATEA
  6199         MOVE ER-0196            TO  EMI-ERROR
  6200         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6201
  6202     IF EFFDTL GREATER ZERO
  6203         MOVE EFFDTI             TO  WS-DT-DEEDIT-FIELD
  6204         PERFORM 8700-DEEDIT
  6205         IF WS-DEEDIT-FIELD-DATE-OUT IS NUMERIC
  6206             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EFFDTO
  6207             INSPECT EFFDTI CONVERTING SPACES TO '/'
  6208             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  6209             MOVE '4'                TO  DC-OPTION-CODE
  6210             PERFORM 8500-DATE-CONVERT
  6211             IF DC-ERROR-CODE NOT = SPACES
  6212                 MOVE ER-0215        TO  EMI-ERROR
  6213                 PERFORM 9900-ERROR-FORMAT
  6214                 MOVE -1             TO  EFFDTL
  6215                 MOVE AL-UABON       TO  EFFDTA
  6216               ELSE
  6217                 MOVE AL-UANON       TO  EFFDTA
  6218                 MOVE DC-BIN-DATE-1  TO  PI-CHEK-EFF-DT
  6219                                         PI-CERT-EFF-DT
  6220           ELSE
  6221             MOVE ER-0215        TO  EMI-ERROR
  6222             PERFORM 9900-ERROR-FORMAT
  6223             MOVE -1             TO  EFFDTL
  6224             MOVE AL-UABON       TO  EFFDTA
  6225       ELSE
  6226         MOVE ER-0216            TO  EMI-ERROR
  6227         PERFORM 9900-ERROR-FORMAT
  6228         MOVE -1                 TO  EFFDTL
  6229         MOVE AL-UABOF           TO  EFFDTA.
  6230
  6231     IF ACCTI NOT = LOW-VALUES
  6232         MOVE AL-UANON           TO  ACCTA
  6233         PERFORM 1400-VERIFY-ACCOUNT THRU 1490-EXIT
  6234         MOVE ACCTI              TO  PI-CHEK-ACCOUNT
  6235                                     PI-ACCOUNT
  6236     ELSE
  6237         MOVE -1                 TO  ACCTL
  6238         MOVE AL-UABON           TO  ACCTA
  6239         MOVE ER-0197            TO  EMI-ERROR
  6240         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6241
  6242     IF CERTNOI NOT = LOW-VALUES
  6243         MOVE AL-UANON           TO  CERTNOA
  6244         MOVE CERTNOI            TO  PI-CHEK-CERT-NO
  6245                                     PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 110
* EL677.cbl
  6246     ELSE
  6247         MOVE -1                 TO  CERTNOL
  6248         MOVE AL-UABON           TO  CERTNOA
  6249         MOVE ER-0203            TO  EMI-ERROR
  6250         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6251
  6252     IF SFXI  = LOW-VALUES
  6253         MOVE SPACE              TO  SFXI.
  6254
  6255     MOVE AL-UANON               TO  SFXA.
  6256
  6257     MOVE SFXI                   TO  PI-CHEK-SUF-NO
  6258                                     PI-CERT-SFX.
  6259     IF SEQI = LOW-VALUES
  6260         MOVE +1                 TO  SEQI.
  6261
  6262     MOVE AL-UNNON               TO  SEQA.
  6263     MOVE SEQI                   TO  PI-CHEK-SEQUENCE.
  6264
  6265     IF PAYTO1L > 0
  6266         MOVE PAYTO1I            TO  PI-PAYTO1
  6267     ELSE
  6268         MOVE SPACES             TO  PI-PAYTO1.
  6269
  6270     IF AMOUNTL > 0
  6271
  6272* EXEC CICS BIF DEEDIT
  6273*            FIELD   (AMOUNTI)
  6274*            LENGTH  (11)
  6275*        END-EXEC
  6276     MOVE 11
  6277       TO DFHEIV11
  6278*    MOVE '@"L                   #   #00006127' TO DFHEIV0
  6279     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6280     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6281     MOVE X'2020233030303036313237' TO DFHEIV0(25:11)
  6282     CALL 'kxdfhei1' USING DFHEIV0,
  6283           AMOUNTI,
  6284           DFHEIV11
  6285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6286         MOVE AMOUNTI            TO  PI-AMOUNT
  6287     ELSE
  6288         MOVE ZEROS              TO  PI-AMOUNT.
  6289
  6290     IF TYPEL > 0
  6291         MOVE TYPEI              TO  PI-TYPE
  6292     ELSE
  6293         MOVE SPACE              TO  PI-TYPE.
  6294
  6295*    IF REFL > 0
  6296*        MOVE REFI               TO  PI-REFERENCE
  6297*    ELSE
  6298*        MOVE SPACES             TO  PI-REFERENCE.
  6299     if rettol not = zeros
  6300        move rettoi              to pi-return-to
  6301        MOVE AL-UANON            TO  RETTOA
  6302     end-if
  6303     if dedcynl not = zeros
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 111
* EL677.cbl
  6304        if dedcyni = 'Y' OR 'N'
  6305           move al-uanon         to dedcyna
  6306           continue
  6307        else
  6308           move er-3451          to emi-error
  6309           move -1               to dedcynl
  6310           move al-uabon         to dedcyna
  6311           perform 9900-error-format
  6312                                 thru 9900-exit
  6313        end-if
  6314     end-if
  6315
  6316     if mainti = 'V'
  6317        if (vreasonl > zeros)
  6318           and (vreasoni (1:2) not = spaces)
  6319           continue
  6320        else
  6321           move er-3454          to emi-error
  6322           move -1               to vreasonl
  6323           move al-uabon         to vreasona
  6324           perform 9900-error-format
  6325                                 thru 9900-exit
  6326        end-if
  6327     end-if
  6328     if (mainti = 'A')
  6329        and (pi-prev-paid > zeros)
  6330        and (pi-check-type = 'C')
  6331        move er-3459             to emi-error
  6332        move -1                  to maintl
  6333        move al-uabon            to mainta
  6334        perform 9900-error-format
  6335                                 thru 9900-exit
  6336     end-if
  6337     if mainti = 'A'
  6338        continue
  6339     else
  6340        IF MAINTI = 'S'
  6341           or pi-prev-maint = 'S'
  6342           GO TO 1100-EDIT-COMPLETE
  6343        end-if
  6344     end-if
  6345     IF EIBAID = DFHPF5
  6346        IF EMI-ERROR = ZEROS
  6347          GO TO 6500-BUILD-ACCOUNT-SCREEN
  6348        ELSE
  6349          GO TO 1100-EDIT-COMPLETE.
  6350
  6351     IF EIBAID = DFHPF6
  6352        IF EMI-ERROR = ZEROS
  6353           GO TO 6300-BUILD-CERT-SCREEN
  6354         ELSE
  6355           GO TO 1100-EDIT-COMPLETE.
  6356
  6357     IF EIBAID = DFHPF7
  6358        IF EMI-ERROR = ZEROS
  6359           GO TO 6600-build-beneficiary-screen
  6360         ELSE
  6361           GO TO 1100-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 112
* EL677.cbl
  6362     if mainti = 'A'
  6363        if dedcynl not = zeros
  6364           if dedcyni <> pi-previous-deduct-comm
  6365              perform 6700-build-common
  6366                                 thru 6700-exit
  6367              MOVE WS-REFUND-AMOUNT
  6368                                 TO AMOUNTO
  6369              MOVE AL-UANON      TO PAYTO1A
  6370                                    PAYTO2A
  6371                                    PAYAD1A
  6372                                    PAYCTYA
  6373                                    paysta
  6374                                    PTOZIPA
  6375              GO TO 8100-send-initial-map
  6376           end-if
  6377        end-if
  6378     end-if
  6379*    if mainti = 'V'
  6380*       if (vreasonl > zeros)
  6381*          and (vreasoni (1:2) not = spaces)
  6382*          continue
  6383*       else
  6384*          move er-3454          to emi-error
  6385*          move -1               to vreasonl
  6386*          move al-uabon         to vreasona
  6387*          perform 9900-error-format
  6388*                                thru 9900-exit
  6389*       end-if
  6390*    end-if
  6391     IF MAINTI = 'A'
  6392        if (payto1i not = spaces and low-values)
  6393           and (payad1i not = spaces and low-values)
  6394           and (payctyi not = spaces and low-values)
  6395           and (paysti not = spaces and low-values)
  6396           and (ptozipi not = spaces and low-values)
  6397           continue
  6398        else
  6399           MOVE -1               TO PAYTO1L
  6400           MOVE ER-2907          TO EMI-ERROR
  6401           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6402        end-if
  6403     end-if
  6404
  6405     IF MAINTI = 'A'
  6406         IF EIBAID NOT = DFHPF4
  6407             MOVE DFHENTER       TO  EIBAID
  6408             PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  6409
  6410     IF MAINTI = 'S' OR 'V'
  6411         GO TO 1100-EDIT-COMPLETE.
  6412
  6413     IF PRINTEDL GREATER THAN +0
  6414         MOVE PRINTEDI           TO  WS-DEEDIT-FIELD-A
  6415         PERFORM 8700-DEEDIT
  6416         IF WS-DEEDIT-FIELD-V0 IS NUMERIC
  6417             MOVE WS-DEEDIT-FIELD-V0 TO  PRINTEDO
  6418             INSPECT PRINTEDI CONVERTING SPACES TO '/'
  6419             MOVE WS-DEEDIT-FIELD-V0 TO  DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 113
* EL677.cbl
  6420             MOVE '4'                TO  DC-OPTION-CODE
  6421             PERFORM 8500-DATE-CONVERT
  6422             IF DC-ERROR-CODE NOT = SPACES
  6423                 MOVE ER-3046        TO  EMI-ERROR
  6424                 PERFORM 9900-ERROR-FORMAT
  6425                 MOVE -1             TO  PRINTEDL
  6426                 MOVE AL-UABON       TO  PRINTEDA
  6427                 MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT
  6428             ELSE
  6429                 MOVE AL-UANON       TO  PRINTEDA
  6430                 MOVE DC-BIN-DATE-1  TO  WS-CHK-PRINT-DT
  6431         ELSE
  6432             MOVE ER-3046        TO  EMI-ERROR
  6433             PERFORM 9900-ERROR-FORMAT
  6434             MOVE -1             TO  PRINTEDL
  6435             MOVE AL-UABON       TO  PRINTEDA
  6436             MOVE LOW-VALUES     TO  WS-CHK-PRINT-DT.
  6437
  6438     IF AMOUNTL = ZEROS
  6439         GO TO 1050-CK-AMT.
  6440
  6441*    EXEC CICS BIF DEEDIT
  6442*        FIELD   (AMOUNTI)
  6443*        LENGTH  (11)
  6444*    END-EXEC.
  6445
  6446     IF AMOUNTI NOT NUMERIC     OR
  6447        AMOUNTI LESS THAN ZERO  OR
  6448       (AMOUNTI = ZEROS  AND
  6449               (PI-COMPANY-ID NOT = 'LAP' AND 'RMC'))
  6450          MOVE ER-1159            TO  EMI-ERROR
  6451          MOVE -1                 TO  AMOUNTL
  6452          MOVE AL-UNBON           TO  AMOUNTA
  6453          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6454          GO TO 1100-EDIT-COMPLETE.
  6455
  6456     MOVE AMOUNTI                TO  WS-AM-WORK.
  6457
  6458     IF WS-AM-SIGN = SPACES
  6459         MOVE WS-AM-NUM          TO  WS-AMT
  6460         ADD 0                   TO  WS-AMT
  6461       ELSE
  6462         MOVE AMOUNTI            TO  WS-AMT
  6463         ADD 0                   TO  WS-AMT.
  6464
  6465     IF MAINTI = 'A'
  6466        IF EIBAID = DFHENTER
  6467           if (ws-amt + pi-prev-paid) >
  6468              (cm-lf-premium-amt + cm-lf-alt-premium-amt +
  6469                 cm-ah-premium-amt)
  6470              move zeros to ws-amt
  6471           end-if
  6472        end-if
  6473     end-if
  6474      MOVE WS-AMT                TO  AMOUNTO.
  6475      MOVE AL-UNNON              TO  AMOUNTA.
  6476
  6477 1050-CK-AMT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 114
* EL677.cbl
  6478     IF AMOUNTL = ZEROS AND
  6479        MAINTI  = 'A'
  6480         MOVE ER-1159            TO  EMI-ERROR
  6481         MOVE -1                 TO  AMOUNTL
  6482         MOVE AL-UNBON           TO  AMOUNTA
  6483         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6484
  6485*    MOVE AL-UANON              TO  TYPEA.
  6486     if (amountl <> zeros)
  6487        if (ws-amt <= zeros)
  6488           and (pi-check-type <> 'C')
  6489           MOVE ER-9999          TO EMI-ERROR
  6490           MOVE -1               TO AMOUNTL
  6491           MOVE AL-UNBON         TO AMOUNTA
  6492           PERFORM 9900-ERROR-FORMAT
  6493                                 THRU 9900-EXIT
  6494        end-if
  6495     end-if
  6496     IF TYPEL GREATER THAN ZEROS
  6497         IF TYPEI = 'R' OR 'M' OR 'E' or 'C'
  6498             NEXT SENTENCE
  6499         ELSE
  6500             MOVE ER-3044    TO  EMI-ERROR
  6501             MOVE -1         TO  TYPEL
  6502             MOVE AL-PABON   TO  TYPEA
  6503             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6504     ELSE
  6505         IF MAINTI  = 'A'
  6506             MOVE ER-3044    TO  EMI-ERROR
  6507             MOVE -1         TO  TYPEL
  6508             MOVE AL-PABON   TO  TYPEA
  6509             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6510
  6511
  6512 1100-EDIT-COMPLETE.
  6513
  6514     IF EMI-FATAL-CTR GREATER THAN +0  OR
  6515       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  6516        EIBAID NOT = DFHPF4)
  6517         GO TO 8200-SEND-DATAONLY.
  6518
  6519     MOVE MAINTI                 TO  PI-PREV-MAINT.
  6520
  6521     IF MAINTI = 'A'
  6522         GO TO 2000-ADD-RECORD.
  6523
  6524*    IF MAINTI = 'C' OR 'V'
  6525     IF MAINTI = 'V'
  6526         GO TO 3000-CHANGE-RECORD.
  6527
  6528     IF MAINTI = 'S' or 'C'
  6529         GO TO 5000-BROWSE-FILE.
  6530
  6531     if mainti = 'D'
  6532        go to 3400-delete-record
  6533     end-if
  6534     .
  6535 1200-VERIFY-CARRIER-ID.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 115
* EL677.cbl
  6536     MOVE SPACES                 TO ELCNTL-KEY.
  6537     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6538     MOVE '6'                    TO ELCNTL-REC-TYPE.
  6539     MOVE CARRIERI               TO ELCNTL-CARRIER.
  6540     MOVE +0                     TO ELCNTL-SEQ.
  6541
  6542
  6543* EXEC CICS HANDLE CONDITION
  6544*        NOTFND   (1290-NO-CARRIER)
  6545*    END-EXEC.
  6546*    MOVE '"$I                   ! $ #00006387' TO DFHEIV0
  6547     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6548     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6549     MOVE X'2420233030303036333837' TO DFHEIV0(25:11)
  6550     CALL 'kxdfhei1' USING DFHEIV0
  6551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6552
  6553
  6554
  6555* EXEC CICS READ
  6556*        DATASET   (ELCNTL-FILE-ID)
  6557*        SET       (ADDRESS OF CONTROL-FILE)
  6558*        RIDFLD    (ELCNTL-KEY)
  6559*    END-EXEC.
  6560*    MOVE '&"S        E          (   #00006391' TO DFHEIV0
  6561     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6562     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6563     MOVE X'2020233030303036333931' TO DFHEIV0(25:11)
  6564     CALL 'kxdfhei1' USING DFHEIV0,
  6565           ELCNTL-FILE-ID,
  6566           DFHEIV20,
  6567           DFHEIV99,
  6568           ELCNTL-KEY,
  6569           DFHEIV99,
  6570           DFHEIV99,
  6571           DFHEIV99
  6572     SET ADDRESS OF CONTROL-FILE TO
  6573         DFHEIV20
  6574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6575
  6576
  6577     GO TO 1200-EXIT.
  6578
  6579 1290-NO-CARRIER.
  6580     MOVE ER-2208                TO EMI-ERROR.
  6581     MOVE -1                     TO CARRIERL.
  6582     MOVE AL-UABON               TO CARRIERA.
  6583     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6584
  6585 1200-EXIT.
  6586      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 116
* EL677.cbl
  6588 1300-VERIFY-STATE-ID.
  6589     MOVE SPACES                 TO ELCNTL-KEY.
  6590     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  6591     MOVE '3'                    TO ELCNTL-REC-TYPE.
  6592     MOVE STATEI                 TO ELCNTL-STATE.
  6593     MOVE +0                     TO ELCNTL-SEQ.
  6594
  6595
  6596* EXEC CICS HANDLE CONDITION
  6597*        NOTFND   (1380-NO-STATE)
  6598*    END-EXEC.
  6599*    MOVE '"$I                   ! % #00006415' TO DFHEIV0
  6600     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6602     MOVE X'2520233030303036343135' TO DFHEIV0(25:11)
  6603     CALL 'kxdfhei1' USING DFHEIV0
  6604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6605
  6606
  6607
  6608* EXEC CICS READ
  6609*        DATASET   (ELCNTL-FILE-ID)
  6610*        SET       (ADDRESS OF CONTROL-FILE)
  6611*        RIDFLD    (ELCNTL-KEY)
  6612*    END-EXEC.
  6613*    MOVE '&"S        E          (   #00006419' TO DFHEIV0
  6614     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6615     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6616     MOVE X'2020233030303036343139' TO DFHEIV0(25:11)
  6617     CALL 'kxdfhei1' USING DFHEIV0,
  6618           ELCNTL-FILE-ID,
  6619           DFHEIV20,
  6620           DFHEIV99,
  6621           ELCNTL-KEY,
  6622           DFHEIV99,
  6623           DFHEIV99,
  6624           DFHEIV99
  6625     SET ADDRESS OF CONTROL-FILE TO
  6626         DFHEIV20
  6627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6628
  6629
  6630     GO TO 1390-EXIT.
  6631
  6632 1380-NO-STATE.
  6633     MOVE ER-2209                TO EMI-ERROR.
  6634     MOVE -1                     TO STATEL.
  6635     MOVE AL-UABON               TO STATEA.
  6636     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6637
  6638 1390-EXIT.
  6639      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 117
* EL677.cbl
  6641
  6642 1400-VERIFY-ACCOUNT.
  6643     IF EIBAID = DFHPF5
  6644         GO TO 1410-BUILD-ACCOUNT-KEY.
  6645
  6646     IF MAINTL GREATER +0
  6647         NEXT SENTENCE
  6648       ELSE
  6649         GO TO 1490-EXIT.
  6650
  6651*    IF MAINTI = 'A' OR 'C' OR 'V'
  6652     IF MAINTI = 'A' OR 'V'
  6653         NEXT SENTENCE
  6654       ELSE
  6655         GO TO 1490-EXIT.
  6656
  6657 1410-BUILD-ACCOUNT-KEY.
  6658     MOVE CARRIERI               TO ERACCT-CARRIER.
  6659     MOVE GROUPI                 TO ERACCT-GROUPING
  6660     MOVE STATEI                 TO ERACCT-STATE.
  6661     MOVE ACCTI                  TO ERACCT-ACCOUNT.
  6662     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  6663
  6664     MOVE '2'                    TO DC-OPTION-CODE.
  6665     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6666
  6667     PERFORM 8500-DATE-CONVERT.
  6668     IF DATE-CONVERSION-ERROR
  6669        GO TO 1480-ACCOUNT-INVALID.
  6670
  6671     MOVE DC-BIN-DATE-1          TO ERACCT-EXP-DATE.
  6672    .
  6673 1420-get-eracct.
  6674     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  6675
  6676
  6677* EXEC CICS HANDLE CONDITION
  6678*        NOTFND   (1480-ACCOUNT-INVALID)
  6679*        ENDFILE  (1480-ACCOUNT-INVALID)
  6680*    END-EXEC.
  6681*    MOVE '"$I''                  ! & #00006471' TO DFHEIV0
  6682     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6683     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6684     MOVE X'2620233030303036343731' TO DFHEIV0(25:11)
  6685     CALL 'kxdfhei1' USING DFHEIV0
  6686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6687
  6688
  6689
  6690* EXEC CICS STARTBR
  6691*        DATASET   (ERACCT-FILE-ID)
  6692*        RIDFLD    (ERACCT-KEY)
  6693*    END-EXEC.
  6694     MOVE 0
  6695       TO DFHEIV11
  6696*    MOVE '&,         G          &   #00006476' TO DFHEIV0
  6697     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6698     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 118
* EL677.cbl
  6699     MOVE X'2020233030303036343736' TO DFHEIV0(25:11)
  6700     CALL 'kxdfhei1' USING DFHEIV0,
  6701           ERACCT-FILE-ID,
  6702           ERACCT-KEY,
  6703           DFHEIV99,
  6704           DFHEIV11,
  6705           DFHEIV99
  6706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6707
  6708
  6709     set eracct-start to true
  6710     .
  6711 1420-READNEXT-ACCOUNT-MASTER.
  6712
  6713* EXEC CICS READNEXT
  6714*        DATASET   (ERACCT-FILE-ID)
  6715*        SET       (ADDRESS OF ACCOUNT-MASTER)
  6716*        RIDFLD    (ERACCT-KEY)
  6717*    END-EXEC.
  6718     MOVE 0
  6719       TO DFHEIV11
  6720*    MOVE '&.S                   )   #00006484' TO DFHEIV0
  6721     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6722     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6723     MOVE X'2020233030303036343834' TO DFHEIV0(25:11)
  6724     CALL 'kxdfhei1' USING DFHEIV0,
  6725           ERACCT-FILE-ID,
  6726           DFHEIV20,
  6727           DFHEIV99,
  6728           ERACCT-KEY,
  6729           DFHEIV99,
  6730           DFHEIV11,
  6731           DFHEIV99,
  6732           DFHEIV99
  6733     SET ADDRESS OF ACCOUNT-MASTER TO
  6734         DFHEIV20
  6735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6736
  6737
  6738*    IF PI-COMPANY-CD    NOT = AM-COMPANY-CD   OR
  6739*       SV-ACCT-GROUPING NOT = AM-GROUPING     OR
  6740*       SV-ACCT-CARRIER  NOT = AM-CARRIER      OR
  6741*       SV-ACCT-STATE    NOT = AM-STATE        OR
  6742*       SV-ACCT-ACCOUNT  NOT = AM-ACCOUNT
  6743*         GO TO 1480-ACCOUNT-INVALID.
  6744*
  6745*    IF SV-ACCT-EXP-DATE LESS AM-EFFECTIVE-DT
  6746*        GO TO 1480-ACCOUNT-INVALID.
  6747*
  6748*    IF SV-ACCT-EXP-DATE NOT LESS AM-EXPIRATION-DT
  6749*        GO TO 1420-READNEXT-ACCOUNT-MASTER.
  6750
  6751     evaluate true
  6752        when (save-eracct-key (1:20) not =
  6753           am-control-primary (1:20))
  6754           and (not eracct-found)
  6755           go to 1480-account-invalid
  6756        when (save-eracct-key (1:20) not =
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 119
* EL677.cbl
  6757           am-control-primary (1:20))
  6758           and (eracct-found)
  6759           move ws-hold-eracct-record
  6760                                 to account-master
  6761        when (sv-acct-exp-date < am-effective-dt)
  6762           and (not eracct-found)
  6763           go to 1480-account-invalid
  6764        when sv-acct-exp-date >= am-expiration-dt
  6765           go to 1420-readnext-account-master
  6766        when am-expiration-dt = high-values
  6767           continue
  6768        when other
  6769           set eracct-found to true
  6770           move account-master   to ws-hold-eracct-record
  6771           go to 1420-readnext-account-master
  6772     end-evaluate
  6773     if eracct-start
  6774
  6775* exec cics endbr
  6776*          dataset  (eracct-file-id)
  6777*       end-exec
  6778     MOVE 0
  6779       TO DFHEIV11
  6780*    MOVE '&2                    $   #00006526' TO DFHEIV0
  6781     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6782     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6783     MOVE X'2020233030303036353236' TO DFHEIV0(25:11)
  6784     CALL 'kxdfhei1' USING DFHEIV0,
  6785           eracct-file-id,
  6786           DFHEIV11,
  6787           DFHEIV99
  6788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6789     end-if
  6790*    if am-expiration-dt = high-values
  6791*       continue
  6792*    else
  6793*       move account-master      to ws-hold-eracct-record
  6794*       go to 1420-readnext-account-master
  6795*    end-if
  6796     MOVE AM-CARRIER             TO PI-CR-CARRIER.
  6797     MOVE AM-GROUPING            TO PI-CR-GROUPING.
  6798     MOVE AM-STATE               TO PI-CR-STATE.
  6799     MOVE AM-AGT (AM-REMIT-TO)   TO PI-CR-FIN-RESP.
  6800
  6801     MOVE AM-NAME                TO PI-AM-NAME.
  6802     MOVE AM-ADDRS               TO PI-AM-ADDRS.
  6803     MOVE AM-CITY                TO PI-AM-CITY-st
  6804     MOVE AM-ZIP                 TO PI-AM-ZIP-CODE.
  6805     move am-csr-code            to pi-am-csr
  6806
  6807     MOVE +0                     TO WS-SUB.
  6808
  6809 1430-FIND-ACC-AGT.
  6810     ADD +1                      TO WS-SUB.
  6811
  6812     IF  WS-SUB GREATER +10
  6813         GO TO 1480-ACCOUNT-INVALID.
  6814
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 120
* EL677.cbl
  6815     IF (AM-COM-TYP (WS-SUB) = 'C' OR 'D' OR 'F')
  6816         MOVE AM-AGT (WS-SUB)    TO  PI-CR-ACCOUNT
  6817       ELSE
  6818         GO TO 1430-FIND-ACC-AGT.
  6819
  6820     MOVE AL-UANON               TO CARRIERA
  6821                                    GROUPA
  6822                                    STATEA.
  6823
  6824     PERFORM 6000-VERIFY-COMP-MASTER THRU 6090-EXIT.
  6825
  6826     GO TO 1490-EXIT.
  6827
  6828 1480-ACCOUNT-INVALID.
  6829     MOVE -1                     TO CARRIERL
  6830     MOVE AL-UANON               TO CARRIERA
  6831                                    GROUPA
  6832                                    STATEA
  6833                                    ACCTA.
  6834     MOVE ER-2210                TO EMI-ERROR.
  6835     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6836     GO TO 8200-SEND-DATAONLY.
  6837
  6838 1490-EXIT.
  6839      EXIT.
  6840
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 121
* EL677.cbl
  6842 1500-VERIFY-PENDING-BUS-REC.
  6843     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  6844     if pi-corr-check
  6845        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW
  6846        go to 1590-exit
  6847     end-if
  6848
  6849* EXEC CICS HANDLE CONDITION
  6850*        NOTFND   (1590-EXIT)
  6851*    END-EXEC.
  6852*    MOVE '"$I                   ! '' #00006588' TO DFHEIV0
  6853     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6854     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6855     MOVE X'2720233030303036353838' TO DFHEIV0(25:11)
  6856     CALL 'kxdfhei1' USING DFHEIV0
  6857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6858
  6859
  6860
  6861     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  6862     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  6863     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  6864     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  6865     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  6866     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  6867     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  6868     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  6869     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  6870     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  6871
  6872     IF ST-ACCNT-CNTL  OR
  6873        ACCNT-CNTL
  6874          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  6875
  6876     IF ST-ACCNT-CNTL      OR
  6877        CARR-ST-ACCNT-CNTL OR
  6878        ACCNT-CNTL         OR
  6879        CARR-ACCNT-CNTL
  6880          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  6881
  6882     IF ACCNT-CNTL OR
  6883        CARR-ACCNT-CNTL
  6884          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  6885
  6886
  6887* EXEC CICS READ
  6888*         DATASET   (ERPNDB-ALT-FILE-ID)
  6889*         SET       (ADDRESS OF PENDING-BUSINESS)
  6890*         RIDFLD    (ERPNDB-ALT-KEY)
  6891*     END-EXEC.
  6892*    MOVE '&"S        E          (   #00006618' TO DFHEIV0
  6893     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6894     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6895     MOVE X'2020233030303036363138' TO DFHEIV0(25:11)
  6896     CALL 'kxdfhei1' USING DFHEIV0,
  6897           ERPNDB-ALT-FILE-ID,
  6898           DFHEIV20,
  6899           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 122
* EL677.cbl
  6900           ERPNDB-ALT-KEY,
  6901           DFHEIV99,
  6902           DFHEIV99,
  6903           DFHEIV99
  6904     SET ADDRESS OF PENDING-BUSINESS TO
  6905         DFHEIV20
  6906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6907
  6908
  6909     MOVE 'Y'                    TO WS-PNDB-FOUND-SW.
  6910
  6911     IF PB-C-PAYEE-CODE GREATER SPACES
  6912        MOVE 'Y'                 TO PI-PROCESS-BENEFICIARY-SW.
  6913
  6914     MOVE PB-C-REFERENCE         TO PI-REFERENCE.
  6915*    MOVE PB-CI-INSURED-NAME     TO PI-INSURED-NAME.
  6916
  6917     MOVE PB-C-LF-CANCEL-AMT     TO  PI-LF-REFUND.
  6918     MOVE PB-C-AH-CANCEL-AMT     TO  PI-AH-REFUND.
  6919
  6920     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
  6921         MOVE PB-C-LF-CANCEL-DT  TO  PI-CANC-DT
  6922     ELSE
  6923         MOVE PB-C-AH-CANCEL-DT  TO  PI-CANC-DT.
  6924
  6925*    IF MAINTI = 'A' OR 'C'
  6926*      IF PB-C-REFUND-CREATED
  6927*          MOVE -1               TO  MAINTL
  6928*          MOVE ER-3445          TO  EMI-ERROR
  6929*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6930
  6931 1590-EXIT.
  6932      EXIT.
  6933
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 123
* EL677.cbl
  6935 2000-ADD-RECORD.
  6936
  6937* EXEC CICS GETMAIN
  6938*        SET      (ADDRESS OF CHECK-RECORDS)
  6939*        LENGTH   (600)
  6940*        INITIMG  (GETMAIN-SPACE)
  6941*    END-EXEC.
  6942     MOVE 600
  6943       TO DFHEIV11
  6944*    MOVE ',"IL                  $   #00006651' TO DFHEIV0
  6945     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6946     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6947     MOVE X'2020233030303036363531' TO DFHEIV0(25:11)
  6948     CALL 'kxdfhei1' USING DFHEIV0,
  6949           DFHEIV20,
  6950           DFHEIV11,
  6951           GETMAIN-SPACE
  6952     SET ADDRESS OF CHECK-RECORDS TO
  6953         DFHEIV20
  6954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6955
  6956
  6957     MOVE 'CH'                   TO CH-RECORD-ID.
  6958     MOVE PI-COMPANY-CD          TO CH-COMPANY-CD.
  6959     MOVE CARRIERI               TO CH-CARRIER.
  6960     MOVE GROUPI                 TO CH-GROUPING.
  6961     MOVE STATEI                 TO CH-STATE.
  6962     MOVE ACCTI                  TO CH-ACCOUNT.
  6963
  6964     MOVE EFFDTI                 TO DC-GREG-DATE-1-EDIT.
  6965     MOVE '2'                    TO DC-OPTION-CODE.
  6966     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6967     MOVE DC-BIN-DATE-1          TO CH-CERT-EFF-DT.
  6968
  6969     MOVE CERTNOI                TO CH-CERT-PRIME.
  6970     MOVE SFXI                   TO CH-CERT-SFX.
  6971
  6972     MOVE SEQI                   TO CH-SEQUENCE-NO.
  6973
  6974     MOVE PI-PROCESSOR-ID        TO CH-RECORDED-BY
  6975                                    ch-released-by
  6976     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  6977
  6978     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  6979     MOVE '5'                    TO DC-OPTION-CODE.
  6980     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  6981     MOVE DC-BIN-DATE-1          TO CH-RECORDED-DT
  6982                                    ch-released-dt
  6983
  6984     move 'P'                    to ch-approval-status
  6985
  6986     MOVE LOW-VALUES             TO CH-CHECK-WRITTEN-DT
  6987                                    CH-VOID-DT
  6988                                    CH-CREDIT-ACCEPT-DT
  6989                                    CH-CANC-DT
  6990                                    ch-approval-dt
  6991                                    ch-check-cashed-dt
  6992     MOVE ZEROS                  TO CH-LF-REFUND
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 124
* EL677.cbl
  6993                                    CH-AH-REFUND
  6994*                                   CH-DEDUCT-WITHHELD
  6995*                                   CH-ADDITIONAL-CHARGE.
  6996
  6997     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  6998
  6999     if pi-prev-paid not numeric
  7000        move zeros               to pi-prev-paid
  7001     end-if
  7002     if pi-prev-paid-this-month not numeric
  7003        move zeros               to pi-prev-paid-this-month
  7004     end-if
  7005     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7006       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7007        EIBAID NOT = DFHPF4)
  7008         GO TO 8200-SEND-DATAONLY.
  7009
  7010     add ch-amount-paid to pi-prev-paid
  7011     MOVE PI-CR-MONTH-END-DT     TO CH-CREDIT-SELECT-DT.
  7012     MOVE PI-CR-CARRIER          TO CH-COMP-CARRIER.
  7013     MOVE PI-CR-GROUPING         TO CH-COMP-GROUPING.
  7014     MOVE PI-CR-FIN-RESP         TO CH-COMP-FIN-RESP.
  7015     MOVE PI-CR-ACCOUNT          TO CH-COMP-ACCOUNT.
  7016     move pi-am-csr              to ch-csr
  7017     .
  7018 2100-WRITE-RECORD.
  7019
  7020* exec cics read
  7021*       dataset    (erchek-file-id)
  7022*       into       (ws-dummy-erchek)
  7023*       ridfld     (ch-control-primary)
  7024*       resp       (ws-response)
  7025*    end-exec
  7026     MOVE LENGTH OF
  7027      ws-dummy-erchek
  7028       TO DFHEIV11
  7029*    MOVE '&"IL       E          (  N#00006719' TO DFHEIV0
  7030     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7031     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7032     MOVE X'204E233030303036373139' TO DFHEIV0(25:11)
  7033     CALL 'kxdfhei1' USING DFHEIV0,
  7034           erchek-file-id,
  7035           ws-dummy-erchek,
  7036           DFHEIV11,
  7037           ch-control-primary,
  7038           DFHEIV99,
  7039           DFHEIV99,
  7040           DFHEIV99
  7041     MOVE EIBRESP  TO ws-response
  7042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7043     if RESP-NOTFND
  7044        continue
  7045     else
  7046        add +1 to ch-sequence-no
  7047        add 1 to seqi
  7048        go to 2100-write-record
  7049     end-if
  7050     PERFORM 2700-WRITE-SQL      THRU 2700-EXIT
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 125
* EL677.cbl
  7051
  7052* EXEC CICS HANDLE CONDITION
  7053*        DUPREC (2200-DUPREC)
  7054*    END-EXEC.
  7055*    MOVE '"$%                   ! ( #00006733' TO DFHEIV0
  7056     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7057     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7058     MOVE X'2820233030303036373333' TO DFHEIV0(25:11)
  7059     CALL 'kxdfhei1' USING DFHEIV0
  7060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7061
  7062
  7063     MOVE CH-CONTROL-PRIMARY     TO PI-ERCHEK-KEY.
  7064     MOVE ZEROS                  TO CH-CHECK-QUE-CONTROL
  7065                                    CH-CHECK-QUE-SEQUENCE
  7066
  7067
  7068* EXEC CICS WRITE
  7069*        DATASET  (ERCHEK-FILE-ID)
  7070*        FROM     (CHECK-RECORDS)
  7071*        RIDFLD   (CH-CONTROL-PRIMARY)
  7072*        resp     (ws-response)
  7073*    END-EXEC.
  7074     MOVE LENGTH OF
  7075      CHECK-RECORDS
  7076       TO DFHEIV11
  7077*    MOVE '&$ L                  ''  N#00006741' TO DFHEIV0
  7078     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7079     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7080     MOVE X'204E233030303036373431' TO DFHEIV0(25:11)
  7081     CALL 'kxdfhei1' USING DFHEIV0,
  7082           ERCHEK-FILE-ID,
  7083           CHECK-RECORDS,
  7084           DFHEIV11,
  7085           CH-CONTROL-PRIMARY,
  7086           DFHEIV99,
  7087           DFHEIV99
  7088     MOVE EIBRESP  TO ws-response
  7089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7090
  7091     if resp-normal and pi-check-type = 'C'
  7092        move 'Y'                 to pi-check-cut
  7093     end-if
  7094     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  7095             ERCHEK-RECORD-LENGTH + 23.
  7096
  7097     if pi-check-type not = 'C'
  7098        PERFORM 6200-UPDATE-PENDING-BUS-REC
  7099                                 THRU 6200-EXIT
  7100        if resp-normal
  7101           MOVE 'Y'              TO PB-C-REFUND-SW
  7102           add +1 to pi-chek-rec-cnt
  7103           perform 6210-rewrite-pndb
  7104                                 thru 6210-exit
  7105*          PERFORM 2700-WRITE-SQL THRU 2700-EXIT
  7106        end-if
  7107     end-if
  7108*    PERFORM 2500-WRITE-PAY-ADJ  THRU  2590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 126
* EL677.cbl
  7109
  7110     IF EMI-NO-ERRORS
  7111         MOVE ER-0000            TO EMI-ERROR
  7112     ELSE
  7113         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7114            EIBAID = DFHPF4
  7115             MOVE ER-2600        TO EMI-ERROR.
  7116
  7117     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7118
  7119     MOVE LOW-VALUES             TO EL677AI.
  7120
  7121     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7122     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7123     MOVE PI-CHEK-STATE          TO STATEO.
  7124     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7125
  7126     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7127     MOVE SPACE                  TO DC-OPTION-CODE.
  7128     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7129     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7130
  7131     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7132     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7133     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7134
  7135     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7136                                    ACCTA     EFFDTA  CERTNOA
  7137                                    SFXA.
  7138     MOVE AL-UNNON               TO SEQA.
  7139     go to 5000-browse-file
  7140     GO TO 8100-SEND-INITIAL-MAP.
  7141
  7142 2200-DUPREC.
  7143     ADD +1 TO CH-SEQUENCE-NO.
  7144     MOVE CH-SEQUENCE-NO         TO SEQO
  7145                                    PI-CHEK-SEQUENCE
  7146                                    CHEK-RECORD-SEQ.
  7147     GO TO 2100-WRITE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 127
* EL677.cbl
  7149
  7150 2500-WRITE-PAY-ADJ.
  7151
  7152     PERFORM 2600-READ-CONTROL-FILE THRU 2600-EXIT.
  7153
  7154     IF CH-AMOUNT-PAID = ZEROS
  7155         GO TO 2510-CONTINUE.
  7156     PERFORM 2550-BUILD-ERPYAJ-RECORD THRU 2559-BUILD-EXIT.
  7157     PERFORM 2570-WRITE-ERPYAJ-RECORD THRU 2579-WRITE-EXIT.
  7158
  7159 2510-CONTINUE.
  7160
  7161     IF PI-COMPANY-ID NOT = 'LAP'  AND  'RMC'
  7162         GO TO 2580-HANDLE-ELCNTL-FILE.
  7163
  7164 2550-BUILD-ERPYAJ-RECORD.
  7165
  7166
  7167* EXEC CICS GETMAIN
  7168*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7169*        LENGTH  (200)
  7170*        INITIMG (GETMAIN-SPACE)
  7171*    END-EXEC.
  7172     MOVE 200
  7173       TO DFHEIV11
  7174*    MOVE ',"IL                  $   #00006822' TO DFHEIV0
  7175     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7176     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7177     MOVE X'2020233030303036383232' TO DFHEIV0(25:11)
  7178     CALL 'kxdfhei1' USING DFHEIV0,
  7179           DFHEIV20,
  7180           DFHEIV11,
  7181           GETMAIN-SPACE
  7182     SET ADDRESS OF PENDING-PAY-ADJ TO
  7183         DFHEIV20
  7184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7185
  7186
  7187     MOVE SPACES                 TO PENDING-PAY-ADJ.
  7188     MOVE 'PY'                   TO PY-RECORD-ID.
  7189     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7190
  7191     MOVE CARRIERI               TO PY-CARRIER.
  7192     IF PI-ZERO-CARRIER  OR
  7193        PI-ZERO-CAR-GROUP
  7194         MOVE ZERO               TO PY-CARRIER.
  7195
  7196     MOVE GROUPI                 TO PY-GROUPING.
  7197     IF PI-ZERO-GROUPING  OR
  7198        PI-ZERO-CAR-GROUP
  7199         MOVE ZERO               TO PY-GROUPING.
  7200
  7201     MOVE PI-CR-FIN-RESP         TO PY-FIN-RESP.
  7202     MOVE PI-CR-ACCOUNT          TO PY-ACCOUNT.
  7203     MOVE 'C'                    TO PY-RECORD-TYPE.
  7204     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7205
  7206     MOVE SAVE-CURRENT-DATE-MDY  TO WS-PY-CURRENT-DATE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 128
* EL677.cbl
  7207                                    WS-PY-REF-DATE
  7208                                    WS-PY-END-DATE
  7209                                    WS-PY-DED-DATE
  7210                                    WS-PY-ADDL-DATE.
  7211     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  7212     MOVE CERTNOI                TO WS-PY-CURRENT-CERT
  7213                                    WS-PY-REF-CERT
  7214                                    WS-PY-END-CERT
  7215                                    WS-PY-DED-CERT
  7216                                    WS-PY-ADDL-CERT
  7217                                    WS-TMS-PY-CERT.
  7218     IF SFXI NOT = LOW-VALUES
  7219         MOVE SFXI               TO WS-PY-CURRENT-SUFFIX
  7220                                    WS-PY-REF-SUFFIX
  7221                                    WS-PY-END-SUFFIX
  7222                                    WS-PY-DED-SUFFIX
  7223                                    WS-PY-ADDL-SUFFIX
  7224     ELSE
  7225         MOVE SPACE              TO WS-PY-CURRENT-SUFFIX
  7226                                    WS-PY-REF-SUFFIX
  7227                                    WS-PY-END-SUFFIX
  7228                                    WS-PY-DED-SUFFIX
  7229                                    WS-PY-ADDL-SUFFIX.
  7230
  7231     IF PI-COMPANY-ID EQUAL 'TMS' OR 'LGX'
  7232         MOVE WS-TMS-ENTRY-COMMENT
  7233                                 TO PY-ENTRY-COMMENT
  7234     ELSE
  7235         IF TYPEI EQUAL 'R'
  7236             MOVE WS-PY-REF-COMMENT
  7237                                 TO PY-ENTRY-COMMENT
  7238         ELSE
  7239             IF TYPEI EQUAL 'E'
  7240                 MOVE WS-PY-END-COMMENT
  7241                                 TO PY-ENTRY-COMMENT
  7242             ELSE
  7243                 MOVE WS-PY-ENTRY-COMMENT
  7244                                 TO PY-ENTRY-COMMENT.
  7245
  7246     MOVE CH-AMOUNT-PAID         TO PY-ENTRY-AMT.
  7247
  7248     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7249     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7250     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7251                                    PY-INPUT-DT.
  7252*    MOVE +0                     TO PY-CHECK-QUE-CONTROL
  7253*                                   PY-CHECK-QUE-SEQUENCE.
  7254     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7255                                    PY-REPORTED-DT
  7256                                    PY-CHECK-WRITTEN-DT
  7257                                    PY-BILLED-DATE
  7258                                    PY-AR-DATE
  7259                                    PY-GL-DATE.
  7260     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7261     MOVE TYPEI                  TO PY-CHECK-ORIGIN-SW.
  7262*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7263
  7264     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 129
* EL677.cbl
  7265         MOVE 'B'                TO PY-PYMT-TYPE
  7266         MOVE 'A'                TO PY-PMT-APPLIED.
  7267
  7268 2559-BUILD-EXIT.
  7269     EXIT.
  7270
  7271 2570-WRITE-ERPYAJ-RECORD.
  7272
  7273
  7274* EXEC CICS HANDLE CONDITION
  7275*        DUPREC (2577-DUPREC)
  7276*    END-EXEC.
  7277*    MOVE '"$%                   ! ) #00006914' TO DFHEIV0
  7278     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7279     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7280     MOVE X'2920233030303036393134' TO DFHEIV0(25:11)
  7281     CALL 'kxdfhei1' USING DFHEIV0
  7282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7283
  7284
  7285
  7286* EXEC CICS WRITE
  7287*        DATASET (ERPYAJ-FILE-ID)
  7288*        FROM    (PENDING-PAY-ADJ)
  7289*        RIDFLD  (PY-CONTROL-PRIMARY)
  7290*    END-EXEC.
  7291     MOVE LENGTH OF
  7292      PENDING-PAY-ADJ
  7293       TO DFHEIV11
  7294*    MOVE '&$ L                  ''   #00006918' TO DFHEIV0
  7295     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7296     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7297     MOVE X'2020233030303036393138' TO DFHEIV0(25:11)
  7298     CALL 'kxdfhei1' USING DFHEIV0,
  7299           ERPYAJ-FILE-ID,
  7300           PENDING-PAY-ADJ,
  7301           DFHEIV11,
  7302           PY-CONTROL-PRIMARY,
  7303           DFHEIV99,
  7304           DFHEIV99
  7305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7306
  7307
  7308     GO TO 2579-WRITE-EXIT.
  7309
  7310 2577-DUPREC.
  7311     ADD +1 TO PY-FILE-SEQ-NO.
  7312
  7313     GO TO 2570-WRITE-ERPYAJ-RECORD.
  7314
  7315 2579-WRITE-EXIT.
  7316     EXIT.
  7317
  7318 2580-HANDLE-ELCNTL-FILE.
  7319
  7320     IF CR-CHECK-NO-AUTO-SEQ
  7321         PERFORM 2650-REWRITE-CONTROL-FILE THRU 2650-EXIT
  7322     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 130
* EL677.cbl
  7323
  7324* EXEC CICS UNLOCK
  7325*            DATASET (ELCNTL-FILE-ID)
  7326*        END-EXEC.
  7327*    MOVE '&*                    #   #00006939' TO DFHEIV0
  7328     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7329     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7330     MOVE X'2020233030303036393339' TO DFHEIV0(25:11)
  7331     CALL 'kxdfhei1' USING DFHEIV0,
  7332           ELCNTL-FILE-ID,
  7333           DFHEIV99
  7334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7335
  7336
  7337 2590-EXIT.
  7338      EXIT.
  7339
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 131
* EL677.cbl
  7341
  7342 2600-READ-CONTROL-FILE.
  7343     MOVE SPACES                 TO ELCNTL-KEY.
  7344     MOVE PI-COMPANY-ID          TO ELCNTL-COMP-ID.
  7345     MOVE '1'                    TO ELCNTL-REC-TYPE.
  7346     MOVE +0                     TO ELCNTL-SEQ.
  7347
  7348
  7349* EXEC CICS HANDLE CONDITION
  7350*        NOTFND   (2600-NO-CO-MASTER)
  7351*    END-EXEC.
  7352*    MOVE '"$I                   ! * #00006954' TO DFHEIV0
  7353     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7354     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7355     MOVE X'2A20233030303036393534' TO DFHEIV0(25:11)
  7356     CALL 'kxdfhei1' USING DFHEIV0
  7357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7358
  7359
  7360
  7361* EXEC CICS READ
  7362*        DATASET   (ELCNTL-FILE-ID)
  7363*        SET       (ADDRESS OF CONTROL-FILE)
  7364*        RIDFLD    (ELCNTL-KEY)
  7365*    END-EXEC.
  7366*    MOVE '&"S        E          (   #00006958' TO DFHEIV0
  7367     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7368     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7369     MOVE X'2020233030303036393538' TO DFHEIV0(25:11)
  7370     CALL 'kxdfhei1' USING DFHEIV0,
  7371           ELCNTL-FILE-ID,
  7372           DFHEIV20,
  7373           DFHEIV99,
  7374           ELCNTL-KEY,
  7375           DFHEIV99,
  7376           DFHEIV99,
  7377           DFHEIV99
  7378     SET ADDRESS OF CONTROL-FILE TO
  7379         DFHEIV20
  7380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7381
  7382
  7383     GO TO 2600-EXIT
  7384
  7385     .
  7386 2600-NO-CO-MASTER.
  7387     MOVE ER-0022                TO  EMI-ERROR.
  7388     MOVE -1                     TO  CARRIERL.
  7389     MOVE AL-UABON               TO  CARRIERA.
  7390     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7391
  7392 2600-EXIT.
  7393      EXIT.
  7394
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 132
* EL677.cbl
  7396 2650-REWRITE-CONTROL-FILE.
  7397
  7398* EXEC CICS READ
  7399*        DATASET   (ELCNTL-FILE-ID)
  7400*        SET       (ADDRESS OF CONTROL-FILE)
  7401*        RIDFLD    (ELCNTL-KEY)
  7402*        UPDATE
  7403*    END-EXEC.
  7404*    MOVE '&"S        EU         (   #00006978' TO DFHEIV0
  7405     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7406     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7407     MOVE X'2020233030303036393738' TO DFHEIV0(25:11)
  7408     CALL 'kxdfhei1' USING DFHEIV0,
  7409           ELCNTL-FILE-ID,
  7410           DFHEIV20,
  7411           DFHEIV99,
  7412           ELCNTL-KEY,
  7413           DFHEIV99,
  7414           DFHEIV99,
  7415           DFHEIV99
  7416     SET ADDRESS OF CONTROL-FILE TO
  7417         DFHEIV20
  7418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7419
  7420
  7421
  7422* EXEC CICS REWRITE
  7423*         DATASET (ELCNTL-FILE-ID)
  7424*         FROM    (CONTROL-FILE)
  7425*     END-EXEC.
  7426     MOVE LENGTH OF
  7427      CONTROL-FILE
  7428       TO DFHEIV11
  7429*    MOVE '&& L                  %   #00006985' TO DFHEIV0
  7430     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7431     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7432     MOVE X'2020233030303036393835' TO DFHEIV0(25:11)
  7433     CALL 'kxdfhei1' USING DFHEIV0,
  7434           ELCNTL-FILE-ID,
  7435           CONTROL-FILE,
  7436           DFHEIV11,
  7437           DFHEIV99
  7438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7439
  7440
  7441 2650-EXIT.
  7442      EXIT.
  7443 2700-WRITE-SQL.
  7444     perform 2710-build-rec      thru 2710-exit
  7445     perform 2720-insert-row     thru 2720-exit
  7446     perform 4300-FINISH-UP-DB   thru 4300-exit
  7447     .
  7448 2700-EXIT.
  7449     EXIT.
  7450 2710-BUILD-REC.
  7451     move spaces                 to daily-check-request-rec
  7452     move pi-company-id          to db-compid
  7453     move ch-carrier             to db-carrier
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 133
* EL677.cbl
  7454                                    db-fincar
  7455     move ch-grouping            to db-grouping
  7456                                    db-fingrp
  7457     move ch-state               to db-state
  7458     move ch-account             to db-account
  7459     move ch-cert-eff-dt         to dc-bin-date-1
  7460     move ' '                    to dc-option-code
  7461     perform 8500-date-convert   thru 8500-exit
  7462     if no-conversion-error
  7463        move dc-greg-date-a-edit to db-effdate
  7464     else
  7465        move spaces              to db-effdate
  7466     end-if
  7467     move ch-cert-prime          to db-certificate
  7468     move ch-cert-sfx            to db-cert-sfx
  7469     move ch-sequence-no         to db-seq-no
  7470     move '1'                    to db-type
  7471                                    db-check-sub-type
  7472     if pi-check-type = 'C'
  7473        move '2'                 to db-check-sub-type
  7474     end-if
  7475     move ch-amount-paid         to db-amount-n
  7476     move zeros                  to db-checkstatus
  7477     move ch-check-que-control   to db-releasebatch
  7478     move save-bin-date          to dc-bin-date-1
  7479     move ' '                    to dc-option-code
  7480     perform 8500-date-convert   thru 8500-exit
  7481     if no-conversion-error
  7482        move dc-greg-date-a-edit to db-releasedt
  7483     else
  7484        move spaces              to db-releasedt
  7485     end-if
  7486     move pi-processor-id        to db-releaseby
  7487     move ch-payee-name-1        to db-payeename1
  7488     move ch-payee-name-2        to db-payeename2
  7489     move ch-payee-address-1     to db-payeeaddr1
  7490     move ch-payee-address-2     to db-payeeaddr2
  7491     move ch-payee-city          to db-payeecity
  7492     move ch-payee-state         to db-payeest
  7493     move ch-payee-zip-code      to db-payeezip
  7494     move ch-comp-fin-resp       to db-finresp
  7495     move ch-comp-account        to db-finacct
  7496     move ch-recorded-by         to db-preparer
  7497     move ch-return-to           to db-return-to
  7498     move pi-table-name          to db-insured-name
  7499     .
  7500 2710-EXIT.
  7501     EXIT.
  7502 2720-INSERT-ROW.
  7503     if not connected-to-db
  7504        perform 4100-CONNECT-TO-DB
  7505                                 thru 4100-exit
  7506     end-if
  7507     EXEC SQL
  7508        INSERT into ChkApp_Check (
  7509           Company,
  7510           CertCarrier,
  7511           CertGroup,
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 134
* EL677.cbl
  7512           CertState,
  7513           CertAccount,
  7514           CertEffDate,
  7515           CertNumber,
  7516           CertNumberSuf,
  7517           CheckSeqNbr,
  7518           CheckType,
  7519           CheckAmount,
  7520           ReleaseBatchNbr,
  7521           ReleaseDate,
  7522           ReleasedBy,
  7523           PayeeName1,
  7524           PayeeName2,
  7525           PayeeAddress1,
  7526           PayeeAddress2,
  7527           PayeeCity,
  7528           PayeeState,
  7529           PayeeZip,
  7530           CompCarrier,
  7531           CompGroup,
  7532           CompFinResp,
  7533           CompAccount,
  7534           Preparer,
  7535           ReturnTo,
  7536           InsuredName,
  7537           CheckSubType)
  7538         VALUES (
  7539           :DB-CompId,
  7540           :DB-Carrier,
  7541           :DB-Grouping,
  7542           :DB-State,
  7543           :DB-Account,
  7544           :DB-EffDate,
  7545           :DB-Certificate,
  7546           :db-cert-sfx,
  7547           :DB-Seq-No,
  7548           :DB-Type,
  7549           :db-amount,
  7550           :db-releasebatch,
  7551           :db-releasedt,
  7552           :db-releaseby,
  7553           :db-payeename1,
  7554           :db-payeename2,
  7555           :db-payeeaddr1,
  7556           :db-payeeaddr2,
  7557           :db-payeecity,
  7558           :db-payeest,
  7559           :db-payeezip,
  7560           :db-fincar,
  7561           :db-fingrp,
  7562           :db-finresp,
  7563           :db-finacct,
  7564           :db-preparer,
  7565           :db-return-to,
  7566           :db-insured-name,
  7567           :db-check-sub-type)
  7568     END-EXEC
  7569     if sqlcode = -2601
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 135
* EL677.cbl
  7570        add +1                   to ch-sequence-no
  7571        move ch-sequence-no      to DB-Seq-No
  7572        go to 2720-insert-row
  7573     end-if
  7574     if sqlcode not = 0
  7575        display "Error: cannot insert row "
  7576        display ' sql return code ' sqlcode
  7577        move sqlcode to ws-sql-code
  7578        move ws-sql-code to ws-dis-sql-code
  7579        display ' dis sql code ' ws-dis-sql-code
  7580        display ' sql err mess    ' sqlerrmc
  7581        move sqlcode to ws-sql-code
  7582        move ws-sql-code to ws-dis-sql-code
  7583        string ws-dis-sql-code ' ' sqlerrmc (1:50)
  7584           into EMI-MESSAGE-AREA (1)
  7585        end-string
  7586        display ' msga1 ' emi-message-area (1)
  7587        perform 4300-FINISH-UP-DB thru 4300-exit
  7588        go to 8200-send-dataonly
  7589*       goback
  7590     end-if
  7591     .
  7592 2720-EXIT.
  7593     EXIT.
  7594 3000-CHANGE-RECORD.
  7595
  7596* EXEC CICS HANDLE CONDITION
  7597*        NOTFND (3900-RECORD-NOTFND)
  7598*    END-EXEC.
  7599*    MOVE '"$I                   ! + #00007144' TO DFHEIV0
  7600     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7601     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7602     MOVE X'2B20233030303037313434' TO DFHEIV0(25:11)
  7603     CALL 'kxdfhei1' USING DFHEIV0
  7604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7605
  7606
  7607
  7608* EXEC CICS READ
  7609*        DATASET  (ERCHEK-FILE-ID)
  7610*        SET      (ADDRESS OF CHECK-RECORDS)
  7611*        RIDFLD   (PI-ERCHEK-KEY)
  7612*        UPDATE
  7613*    END-EXEC.
  7614*    MOVE '&"S        EU         (   #00007148' TO DFHEIV0
  7615     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7616     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7617     MOVE X'2020233030303037313438' TO DFHEIV0(25:11)
  7618     CALL 'kxdfhei1' USING DFHEIV0,
  7619           ERCHEK-FILE-ID,
  7620           DFHEIV20,
  7621           DFHEIV99,
  7622           PI-ERCHEK-KEY,
  7623           DFHEIV99,
  7624           DFHEIV99,
  7625           DFHEIV99
  7626     SET ADDRESS OF CHECK-RECORDS TO
  7627         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 136
* EL677.cbl
  7628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7629
  7630
  7631     IF CH-LF-REFUND NOT NUMERIC
  7632         MOVE ZEROS              TO CH-LF-REFUND.
  7633     IF CH-AH-REFUND NOT NUMERIC
  7634         MOVE ZEROS              TO CH-AH-REFUND.
  7635*    IF CH-DEDUCT-WITHHELD NOT NUMERIC
  7636*        MOVE ZEROS              TO CH-DEDUCT-WITHHELD.
  7637*    IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  7638*        MOVE ZEROS              TO CH-ADDITIONAL-CHARGE.
  7639
  7640     IF VREASONL NOT = ZEROS
  7641         MOVE VREASONI           TO  CH-VOID-REASON.
  7642
  7643     IF MAINTI = 'V'
  7644        GO TO 3050-void-processing
  7645     end-if
  7646
  7647     PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT.
  7648
  7649     PERFORM 4000-ADD-CHANGE THRU 4000-EXIT.
  7650
  7651     IF EMI-FATAL-CTR GREATER THAN +0  OR
  7652       (EMI-FORCABLE-CTR GREATER THAN +0  AND
  7653        EIBAID NOT = DFHPF4)
  7654         GO TO 8200-SEND-DATAONLY.
  7655     go to 3100-rewrite-record
  7656     .
  7657 3050-void-processing.
  7658     perform 4100-CONNECT-TO-DB  thru 4100-exit
  7659     if sqlcode = 0
  7660        perform 4200-get-tbl-row thru 4200-exit
  7661        if sqlcode = 0
  7662           if nu-app-date = -1
  7663              move -1            to maintl
  7664              move er-3453       to emi-error
  7665              move al-uabon      to mainta
  7666              perform 9900-error-format
  7667                                 thru 9900-exit
  7668              perform 4300-FINISH-UP-DB thru 4300-exit
  7669              go to 8200-send-dataonly
  7670           end-if
  7671        end-if
  7672        if connected-to-db
  7673           perform 4300-FINISH-UP-DB thru 4300-exit
  7674        end-if
  7675     end-if
  7676     if (ch-check-written-dt = low-values)
  7677        or (ch-check-no = spaces)
  7678        move -1                  to maintl
  7679        move er-3455             to emi-error
  7680        move al-uabon            to mainta
  7681        perform 9900-error-format
  7682                                 thru 9900-exit
  7683        perform 4300-FINISH-UP-DB thru 4300-exit
  7684        go to 8200-send-dataonly
  7685     end-if
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 137
* EL677.cbl
  7686     .
  7687 3100-REWRITE-RECORD.
  7688     MOVE EIBTIME                TO CH-LAST-MAINT-HHMMSS.
  7689
  7690     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7691     MOVE '5'                    TO DC-OPTION-CODE.
  7692     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7693
  7694     IF MAINTI = 'C'
  7695       MOVE PI-PROCESSOR-ID      TO CH-RECORDED-BY
  7696     end-if
  7697*      IF MANUAL-CHECK-WRITTEN
  7698*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT.
  7699
  7700     IF MAINTI = 'V'
  7701        IF (CH-VOID-DT = LOW-VALUES)
  7702           and (pi-check-cashed = spaces)
  7703           MOVE PI-PROCESSOR-ID  TO CH-VOID-BY
  7704           MOVE DC-BIN-DATE-1    TO CH-VOID-DT
  7705*          PERFORM 3700-UPDATE-ERCHKQ          THRU 3790-EXIT
  7706           PERFORM 3200-PAY-ADJS-REVERSAL      THRU 3290-EXIT
  7707           if pi-chek-rec-cnt = +1
  7708              PERFORM 6200-UPDATE-PENDING-BUS-REC
  7709                                 THRU 6200-EXIT
  7710              if resp-normal
  7711                 MOVE ' '        TO PB-C-REFUND-SW
  7712                 perform 6210-rewrite-pndb
  7713                                 thru 6210-exit
  7714              end-if
  7715           end-if
  7716        ELSE
  7717           MOVE -1               TO MAINTL
  7718           MOVE ER-2583          TO EMI-ERROR
  7719           MOVE AL-UABON         TO MAINTA
  7720           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7721           GO TO 8200-SEND-DATAONLY
  7722        end-if
  7723     end-if
  7724
  7725     MOVE CH-AMOUNT-PAID         TO WS-SV-AMOUNT-PAID.
  7726
  7727
  7728* EXEC CICS REWRITE
  7729*        DATASET  (ERCHEK-FILE-ID)
  7730*        FROM     (CHECK-RECORDS)
  7731*    END-EXEC.
  7732     MOVE LENGTH OF
  7733      CHECK-RECORDS
  7734       TO DFHEIV11
  7735*    MOVE '&& L                  %   #00007251' TO DFHEIV0
  7736     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7737     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7738     MOVE X'2020233030303037323531' TO DFHEIV0(25:11)
  7739     CALL 'kxdfhei1' USING DFHEIV0,
  7740           ERCHEK-FILE-ID,
  7741           CHECK-RECORDS,
  7742           DFHEIV11,
  7743           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 138
* EL677.cbl
  7744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7745
  7746
  7747     IF (PI-COMPANY-ID EQUAL 'LGX' OR 'TMS') AND
  7748        (MAINTI EQUAL 'C')          AND
  7749        (PI-PAYTO1 NOT EQUAL PAYTO1I)
  7750            PERFORM 3300-UPDATE-ERPYAJ THRU 3390-EXIT.
  7751
  7752     IF EMI-NO-ERRORS
  7753         MOVE ER-0000            TO EMI-ERROR
  7754     ELSE
  7755         IF EMI-FORCABLE-CTR GREATER THAN +0  AND
  7756            EIBAID = DFHPF4
  7757             MOVE ER-2600        TO EMI-ERROR.
  7758
  7759     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7760
  7761     MOVE LOW-VALUES             TO EL677AI.
  7762
  7763     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  7764     MOVE PI-CHEK-GROUPING       TO GROUPO.
  7765     MOVE PI-CHEK-STATE          TO STATEO.
  7766     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  7767
  7768     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  7769     MOVE SPACE                  TO DC-OPTION-CODE.
  7770     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7771     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  7772
  7773     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  7774     MOVE PI-CHEK-SUF-NO         TO SFXO.
  7775     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  7776
  7777     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  7778                                     ACCTA   EFFDTA
  7779                                    CERTNOA   SFXA.
  7780
  7781     MOVE AL-UNNON               TO SEQA.
  7782     go to 5000-browse-file
  7783*    GO TO 8100-SEND-INITIAL-MAP.
  7784
  7785     .
  7786 3200-PAY-ADJS-REVERSAL.
  7787
  7788     IF CH-AMOUNT-PAID NOT = ZEROS
  7789         PERFORM 3250-BUILD-ERPYAJ-REVERSAL THRU 3259-BUILD-EXIT
  7790         PERFORM 3280-WRITE-ERPYAJ-REVERSAL THRU 3289-WRITE-EXIT.
  7791
  7792     GO TO 3290-EXIT
  7793     .
  7794 3250-BUILD-ERPYAJ-REVERSAL.
  7795
  7796
  7797* EXEC CICS GETMAIN
  7798*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7799*        LENGTH  (200)
  7800*        INITIMG (GETMAIN-SPACE)
  7801*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 139
* EL677.cbl
  7802     MOVE 200
  7803       TO DFHEIV11
  7804*    MOVE ',"IL                  $   #00007305' TO DFHEIV0
  7805     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7806     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7807     MOVE X'2020233030303037333035' TO DFHEIV0(25:11)
  7808     CALL 'kxdfhei1' USING DFHEIV0,
  7809           DFHEIV20,
  7810           DFHEIV11,
  7811           GETMAIN-SPACE
  7812     SET ADDRESS OF PENDING-PAY-ADJ TO
  7813         DFHEIV20
  7814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7815
  7816
  7817     MOVE 'PY'                   TO PY-RECORD-ID.
  7818     MOVE PI-COMPANY-CD          TO PY-COMPANY-CD.
  7819
  7820     MOVE CH-COMP-CARRIER        TO PY-CARRIER.
  7821     IF PI-ZERO-CARRIER  OR
  7822        PI-ZERO-CAR-GROUP
  7823         MOVE ZERO               TO PY-CARRIER.
  7824
  7825     MOVE CH-COMP-GROUPING       TO PY-GROUPING.
  7826     IF PI-ZERO-GROUPING  OR
  7827        PI-ZERO-CAR-GROUP
  7828         MOVE ZERO               TO PY-GROUPING.
  7829
  7830     MOVE CH-COMP-FIN-RESP       TO PY-FIN-RESP.
  7831     MOVE CH-COMP-ACCOUNT        TO PY-ACCOUNT.
  7832     MOVE 'R'                    TO PY-RECORD-TYPE.
  7833     MOVE EIBTIME                TO PY-FILE-SEQ-NO.
  7834     move '1825011300'           to py-gl-account
  7835     move 'VOID REFCK'           TO py-gl-comment
  7836     move ch-amount-paid         to py-entry-amt
  7837*    COMPUTE PY-ENTRY-AMT = CH-AMOUNT-PAID * -1.
  7838
  7839     MOVE CH-CHECK-NO            TO WS-CHECK-WORK
  7840     MOVE WS-CHECK-NO            TO PY-CHECK-NUMBER.
  7841
  7842     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  7843     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  7844     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  7845                                    PY-INPUT-DT.
  7846*    MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
  7847*                                   PY-CHECK-QUE-SEQUENCE.
  7848     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
  7849                                    PY-BILLED-DATE
  7850                                    PY-REPORTED-DT
  7851                                    PY-CHECK-WRITTEN-DT
  7852                                    PY-AR-DATE
  7853                                    PY-GL-DATE.
  7854     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  7855     MOVE CH-CHECK-ORIGIN-SW     TO PY-CHECK-ORIGIN-SW.
  7856*    MOVE 'V'                    TO PY-VOID-SW.
  7857*    MOVE CH-CHECK-REFERENCE     TO PY-REF-NO.
  7858
  7859     IF PI-AR-PROCESSING
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 140
* EL677.cbl
  7860         MOVE 'B'                TO PY-PYMT-TYPE
  7861         MOVE 'A'                TO PY-PMT-APPLIED.
  7862
  7863 3259-BUILD-EXIT.
  7864     EXIT.
  7865
  7866 3280-WRITE-ERPYAJ-REVERSAL.
  7867
  7868
  7869* EXEC CICS HANDLE CONDITION
  7870*        DUPREC (3287-DUPREC)
  7871*    END-EXEC.
  7872*    MOVE '"$%                   ! , #00007362' TO DFHEIV0
  7873     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7874     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7875     MOVE X'2C20233030303037333632' TO DFHEIV0(25:11)
  7876     CALL 'kxdfhei1' USING DFHEIV0
  7877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7878
  7879
  7880
  7881* EXEC CICS WRITE
  7882*        DATASET (ERPYAJ-FILE-ID)
  7883*        FROM    (PENDING-PAY-ADJ)
  7884*        RIDFLD  (PY-CONTROL-PRIMARY)
  7885*    END-EXEC.
  7886     MOVE LENGTH OF
  7887      PENDING-PAY-ADJ
  7888       TO DFHEIV11
  7889*    MOVE '&$ L                  ''   #00007366' TO DFHEIV0
  7890     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7891     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7892     MOVE X'2020233030303037333636' TO DFHEIV0(25:11)
  7893     CALL 'kxdfhei1' USING DFHEIV0,
  7894           ERPYAJ-FILE-ID,
  7895           PENDING-PAY-ADJ,
  7896           DFHEIV11,
  7897           PY-CONTROL-PRIMARY,
  7898           DFHEIV99,
  7899           DFHEIV99
  7900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7901
  7902
  7903     GO TO 3289-WRITE-EXIT.
  7904
  7905 3287-DUPREC.
  7906     ADD +1 TO PY-FILE-SEQ-NO.
  7907
  7908     GO TO 3280-WRITE-ERPYAJ-REVERSAL.
  7909
  7910 3289-WRITE-EXIT.
  7911     EXIT.
  7912
  7913 3290-EXIT.
  7914      EXIT.
  7915
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 141
* EL677.cbl
  7917 3300-UPDATE-ERPYAJ.
  7918
  7919
  7920* EXEC CICS GETMAIN
  7921*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  7922*        LENGTH  (200)
  7923*        INITIMG (GETMAIN-SPACE)
  7924*    END-EXEC.
  7925     MOVE 200
  7926       TO DFHEIV11
  7927*    MOVE ',"IL                  $   #00007388' TO DFHEIV0
  7928     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7929     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7930     MOVE X'2020233030303037333838' TO DFHEIV0(25:11)
  7931     CALL 'kxdfhei1' USING DFHEIV0,
  7932           DFHEIV20,
  7933           DFHEIV11,
  7934           GETMAIN-SPACE
  7935     SET ADDRESS OF PENDING-PAY-ADJ TO
  7936         DFHEIV20
  7937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7938
  7939
  7940     MOVE PI-COMPANY-CD          TO PYAJ-COMPANY-CD.
  7941     MOVE PI-CHEK-CARRIER        TO PYAJ-CARRIER.
  7942     MOVE PI-CHEK-GROUPING       TO PYAJ-GROUPING.
  7943     MOVE PI-CR-FIN-RESP         TO PYAJ-FIN-RESP.
  7944     MOVE PI-CR-ACCOUNT          TO PYAJ-ACCOUNT.
  7945     MOVE 'C'                    TO PYAJ-RECORD-TYPE.
  7946     MOVE ZEROS                  TO PYAJ-FILE-SEQ-NO.
  7947
  7948
  7949* EXEC CICS HANDLE CONDITION
  7950*        NOTFND   (3390-EXIT)
  7951*        ENDFILE  (3390-EXIT)
  7952*    END-EXEC.
  7953*    MOVE '"$I''                  ! - #00007402' TO DFHEIV0
  7954     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7955     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7956     MOVE X'2D20233030303037343032' TO DFHEIV0(25:11)
  7957     CALL 'kxdfhei1' USING DFHEIV0
  7958     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7959
  7960
  7961 3320-READNEXT-ERPYAJ.
  7962
  7963
  7964* EXEC CICS READ
  7965*        DATASET  (ERPYAJ-FILE-ID)
  7966*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  7967*        RIDFLD   (ERPYAJ-KEY)
  7968*        GTEQ
  7969*    END-EXEC.
  7970*    MOVE '&"S        G          (   #00007409' TO DFHEIV0
  7971     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7972     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7973     MOVE X'2020233030303037343039' TO DFHEIV0(25:11)
  7974     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 142
* EL677.cbl
  7975           ERPYAJ-FILE-ID,
  7976           DFHEIV20,
  7977           DFHEIV99,
  7978           ERPYAJ-KEY,
  7979           DFHEIV99,
  7980           DFHEIV99,
  7981           DFHEIV99
  7982     SET ADDRESS OF PENDING-PAY-ADJ TO
  7983         DFHEIV20
  7984     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7985
  7986
  7987     MOVE PY-CONTROL-PRIMARY TO ERPYAJ-KEY.
  7988
  7989     IF (PI-COMPANY-CD    NOT = PY-COMPANY-CD) OR
  7990        (PI-CHEK-CARRIER  NOT = PY-CARRIER)    OR
  7991        (PI-CHEK-GROUPING NOT = PY-GROUPING)   OR
  7992        (PI-CR-FIN-RESP   NOT = PY-FIN-RESP)   OR
  7993        (PI-CR-ACCOUNT    NOT = PY-ACCOUNT)    OR
  7994        (PY-RECORD-TYPE   NOT = 'C')
  7995          GO TO 3390-EXIT.
  7996
  7997     IF WS-SV-AMOUNT-PAID NOT EQUAL PY-ENTRY-AMT
  7998         ADD +1 TO PYAJ-FILE-SEQ-NO
  7999         GO TO 3320-READNEXT-ERPYAJ.
  8000
  8001
  8002* EXEC CICS READ UPDATE
  8003*        DATASET   (ERPYAJ-FILE-ID)
  8004*        RIDFLD    (ERPYAJ-KEY)
  8005*        SET       (ADDRESS OF PENDING-PAY-ADJ)
  8006*    END-EXEC.
  8007*    MOVE '&"S        EU         (   #00007430' TO DFHEIV0
  8008     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8009     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8010     MOVE X'2020233030303037343330' TO DFHEIV0(25:11)
  8011     CALL 'kxdfhei1' USING DFHEIV0,
  8012           ERPYAJ-FILE-ID,
  8013           DFHEIV20,
  8014           DFHEIV99,
  8015           ERPYAJ-KEY,
  8016           DFHEIV99,
  8017           DFHEIV99,
  8018           DFHEIV99
  8019     SET ADDRESS OF PENDING-PAY-ADJ TO
  8020         DFHEIV20
  8021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8022
  8023
  8024     MOVE PAYTO1I                TO WS-TMS-PY-PAYEE.
  8025     MOVE CERTNOI                TO WS-TMS-PY-CERT.
  8026
  8027     MOVE WS-TMS-ENTRY-COMMENT TO PY-ENTRY-COMMENT.
  8028
  8029     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  8030     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  8031     MOVE SAVE-BIN-DATE          TO PY-LAST-MAINT-DT
  8032
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 143
* EL677.cbl
  8033
  8034* EXEC CICS REWRITE
  8035*        DATASET  (ERPYAJ-FILE-ID)
  8036*        FROM     (PENDING-PAY-ADJ)
  8037*    END-EXEC.
  8038     MOVE LENGTH OF
  8039      PENDING-PAY-ADJ
  8040       TO DFHEIV11
  8041*    MOVE '&& L                  %   #00007445' TO DFHEIV0
  8042     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8043     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8044     MOVE X'2020233030303037343435' TO DFHEIV0(25:11)
  8045     CALL 'kxdfhei1' USING DFHEIV0,
  8046           ERPYAJ-FILE-ID,
  8047           PENDING-PAY-ADJ,
  8048           DFHEIV11,
  8049           DFHEIV99
  8050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8051
  8052
  8053 3390-EXIT.
  8054      EXIT.
  8055
  8056 3400-delete-record.
  8057
  8058* EXEC CICS READ
  8059*        DATASET  (ERCHEK-FILE-ID)
  8060*        SET      (ADDRESS OF CHECK-RECORDS)
  8061*        RIDFLD   (PI-ERCHEK-KEY)
  8062*        UPDATE
  8063*        resp     (ws-response)
  8064*    END-EXEC
  8065*    MOVE '&"S        EU         (  N#00007454' TO DFHEIV0
  8066     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8067     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8068     MOVE X'204E233030303037343534' TO DFHEIV0(25:11)
  8069     CALL 'kxdfhei1' USING DFHEIV0,
  8070           ERCHEK-FILE-ID,
  8071           DFHEIV20,
  8072           DFHEIV99,
  8073           PI-ERCHEK-KEY,
  8074           DFHEIV99,
  8075           DFHEIV99,
  8076           DFHEIV99
  8077     SET ADDRESS OF CHECK-RECORDS TO
  8078         DFHEIV20
  8079     MOVE EIBRESP  TO ws-response
  8080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8081     if (ch-in-limbo or ch-approv-pending)
  8082        and (ch-void-dt = low-values)
  8083        and (ch-check-written-dt = low-values)
  8084        and (ch-credit-accept-dt = low-values)
  8085        perform 3500-check-tbl   thru 3500-exit
  8086        if (row-deleted and tbl-commited)
  8087*          or (emi-error = er-3450)
  8088
  8089* exec cics delete
  8090*             dataset   (erchek-file-id)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 144
* EL677.cbl
  8091*          end-exec
  8092*    MOVE '&(                    &   #00007468' TO DFHEIV0
  8093     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8094     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8095     MOVE X'2020233030303037343638' TO DFHEIV0(25:11)
  8096     CALL 'kxdfhei1' USING DFHEIV0,
  8097           erchek-file-id,
  8098           DFHEIV99,
  8099           DFHEIV99,
  8100           DFHEIV99,
  8101           DFHEIV99
  8102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8103           move spaces to pi-check-cut
  8104        end-if
  8105     else
  8106        move -1               to maintl
  8107        move er-3452          to emi-error
  8108        move al-uabon         to mainta
  8109        perform 9900-error-format
  8110                                 thru 9900-exit
  8111        go to 8200-send-dataonly
  8112     end-if
  8113     if pi-chek-rec-cnt = +1
  8114        PERFORM 6200-UPDATE-PENDING-BUS-REC
  8115                                 THRU 6200-EXIT
  8116        if resp-normal
  8117           MOVE ' '              TO PB-C-REFUND-SW
  8118           perform 6210-rewrite-pndb
  8119                                 thru 6210-exit
  8120        end-if
  8121     end-if
  8122     MOVE ER-0000            TO EMI-ERROR
  8123     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8124     MOVE LOW-VALUES             TO EL677AI.
  8125     MOVE PI-CHEK-CARRIER        TO CARRIERO.
  8126     MOVE PI-CHEK-GROUPING       TO GROUPO.
  8127     MOVE PI-CHEK-STATE          TO STATEO.
  8128     MOVE PI-CHEK-ACCOUNT        TO ACCTO.
  8129     MOVE PI-CHEK-EFF-DT         TO DC-BIN-DATE-1.
  8130     MOVE SPACE                  TO DC-OPTION-CODE.
  8131     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8132     MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI.
  8133     MOVE PI-CHEK-CERT-NO        TO CERTNOO.
  8134     MOVE PI-CHEK-SUF-NO         TO SFXO.
  8135     MOVE PI-CHEK-SEQUENCE       TO SEQO.
  8136     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8137                                    ACCTA   EFFDTA
  8138                                    CERTNOA   SFXA.
  8139     MOVE AL-UNNON               TO SEQA.
  8140     GO TO 8100-SEND-INITIAL-MAP
  8141     .
  8142 3400-exit.
  8143     exit.
  8144 3500-check-tbl.
  8145     perform 4100-CONNECT-TO-DB  thru 4100-exit
  8146*    if sqlcode = 0
  8147*       perform 4150-open-cursor    thru 4150-exit
  8148*    end-if
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 145
* EL677.cbl
  8149     if sqlcode = 0
  8150        perform 4200-get-tbl-row thru 4200-exit
  8151     end-if
  8152      if sqlcode = 0
  8153         if (nu-app-date = -1)
  8154            or (db-app-status = '2')
  8155            perform 4250-delete-row thru 4250-exit
  8156         else
  8157           MOVE ER-3452            TO  EMI-ERROR
  8158           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8159           MOVE -1                 TO  PFENTERL
  8160           GO TO 8200-SEND-DATAONLY
  8161        end-if
  8162      else
  8163         MOVE ER-3450            TO  EMI-ERROR
  8164         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8165         MOVE -1                 TO  PFENTERL
  8166*        GO TO 8200-SEND-DATAONLY
  8167      end-if
  8168     if connected-to-db
  8169        perform 4300-FINISH-UP-DB thru 4300-exit
  8170     end-if
  8171     .
  8172 3500-exit.
  8173     exit.
  8174 3700-UPDATE-ERCHKQ.
  8175*    MOVE CH-COMPANY-CD          TO CHKQ-COMPANY-CD.
  8176*    MOVE CH-CHECK-QUE-CONTROL   TO CHKQ-CONTROL-NUMBER.
  8177*    MOVE CH-CHECK-QUE-SEQUENCE  TO CHKQ-SEQUENCE-NUMBER.
  8178*
  8179*    EXEC CICS HANDLE CONDITION
  8180*        NOTFND (3780-CHECK-NOTFND)
  8181*    END-EXEC.
  8182*
  8183*    EXEC CICS READ
  8184*        DATASET  (ERCHKQ-FILE-ID)
  8185*        SET      (ADDRESS OF CHECK-QUE)
  8186*        RIDFLD   (ERCHKQ-KEY)
  8187*        UPDATE
  8188*    END-EXEC.
  8189*
  8190*    IF MAINTI = 'C'
  8191*        IF MANUAL-CHECK-WRITTEN
  8192*            MOVE 'M'                 TO CQ-ENTRY-TYPE
  8193*            MOVE +1                  TO CQ-TIMES-PRINTED
  8194*            MOVE CH-CHECK-NO         TO CQ-CHECK-NUMBER
  8195*            MOVE CH-AMOUNT-PAID      TO CQ-CHECK-AMOUNT
  8196*            MOVE CH-CHECK-WRITTEN-DT TO CQ-CHECK-WRITTEN-DT.
  8197*
  8198*    IF MAINTI = 'V'
  8199*        MOVE 'V'                TO CQ-ENTRY-TYPE
  8200*                                   CQ-VOID-INDICATOR
  8201*        MOVE CH-VOID-DT         TO CQ-CHECK-VOIDED-DT.
  8202*
  8203*    MOVE CH-CHECK-REFERENCE     TO PI-REFERENCE.
  8204*
  8205*    EXEC CICS REWRITE
  8206*        DATASET  (ERCHKQ-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 146
* EL677.cbl
  8207*        FROM     (CHECK-QUE)
  8208*    END-EXEC.
  8209*
  8210*    GO TO 3790-EXIT.
  8211*
  8212*3780-CHECK-NOTFND.
  8213*    MOVE ER-2905                TO EMI-ERROR.
  8214*    MOVE -1                     TO CARRIERL
  8215*    MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8216*                                   ACCTA     EFFDTA  CERTNOA
  8217*                                   SFXA      SEQA.
  8218*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8219     .
  8220 3790-EXIT.
  8221      EXIT.
  8222
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 147
* EL677.cbl
  8224
  8225 3900-RECORD-NOTFND.
  8226     MOVE ER-2908                TO EMI-ERROR.
  8227     MOVE -1                     TO CARRIERL
  8228     MOVE AL-UANON               TO CARRIERA  GROUPA  STATEA
  8229                                    ACCTA     EFFDTA  CERTNOA
  8230                                    SFXA      SEQA.
  8231     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8232     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 148
* EL677.cbl
  8234 4000-ADD-CHANGE.
  8235     IF PAYTO1L NOT = ZEROS
  8236        MOVE PAYTO1I             TO CH-PAYEE-NAME-1
  8237     END-IF
  8238
  8239     IF PAYTO2L NOT = ZEROS
  8240         MOVE PAYTO2I            TO CH-PAYEE-NAME-2.
  8241
  8242     IF PAYAD1L NOT = ZEROS
  8243         MOVE PAYAD1I            TO CH-PAYEE-ADDRESS-1.
  8244
  8245     IF PAYAD2L NOT = ZEROS
  8246         MOVE PAYAD2I            TO CH-PAYEE-ADDRESS-2.
  8247
  8248     IF PAYctyL NOT = ZEROS
  8249         MOVE payctyi            TO CH-PAYEE-CITY.
  8250
  8251     IF PAYstL NOT = ZEROS
  8252         MOVE paysti            TO CH-PAYEE-state.
  8253
  8254     IF PAYEEI GREATER SPACES
  8255        MOVE PAYEEI              TO CH-PAYEE-CODE.
  8256
  8257     IF PTOZIPL  =  ZEROS
  8258         MOVE ZEROS              TO CH-PAYEE-ZIP-CODE
  8259         GO TO 4000-CK-REST.
  8260
  8261     MOVE PTOZIPI                TO WS-ZIP-CODE.
  8262
  8263     IF NOT WS-CANADIAN-POST-CODE
  8264         MOVE WS-ZIP-PRIME       TO CH-PAYEE-ZIP
  8265         MOVE WS-ZIP-PLUS4       TO CH-PAYEE-ZIP-EXT
  8266         GO TO 4000-CK-REST.
  8267
  8268     MOVE SPACES                 TO CH-CANADIAN-POSTAL-CODE.
  8269     IF WS-CAN-POST-4TH = SPACE OR '-'
  8270         MOVE WS-CAN-POST2-1     TO CH-CAN-POSTAL-1
  8271         MOVE WS-CAN-POST2-2     TO CH-CAN-POSTAL-2
  8272     ELSE
  8273         MOVE WS-CAN-POST1-1     TO CH-CAN-POSTAL-1
  8274         MOVE WS-CAN-POST1-2     TO CH-CAN-POSTAL-2.
  8275
  8276 4000-CK-REST.
  8277
  8278     IF RETTOL NOT = ZEROS
  8279        MOVE RETTOI TO CH-RETURN-TO.
  8280     if dedcynl not = zeros
  8281        move dedcyni             to ch-deduct-commission
  8282     end-if
  8283*    if dedcynl not = zeros
  8284*       if (dedcyni = 'Y')
  8285*          or (pi-prev-ded-comm = 'Y')
  8286*          compute ws-amt =
  8287*             pi-refund-on-pending-rec -
  8288*                pi-prev-paid - pi-ue-comm
  8289*       else
  8290*          if dedcyni = 'N'
  8291*             compute ws-amt =
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 149
* EL677.cbl
  8292*                pi-refund-on-pending-rec -
  8293*                   pi-prev-paid-this-month
  8294*          end-if
  8295*       end-if
  8296*    end-if
  8297     if pi-check-type = 'C'
  8298        compute ws-amt =
  8299           pi-endt-prm-diff - pi-prev-paid
  8300        if (dedcyni = 'Y')
  8301           or (pi-prev-ded-comm = 'Y')
  8302           compute ws-amt =
  8303              ws-amt - pi-ue-comm
  8304        end-if
  8305        if ws-amt <= zeros
  8306           move pi-endt-prm-diff to ws-amt
  8307        end-if
  8308     end-if
  8309     IF AMOUNTL NOT = ZEROS
  8310         MOVE WS-AMT             TO CH-AMOUNT-PAID
  8311         MOVE CH-AMOUNT-PAID     TO AMOUNTO.
  8312
  8313     IF CHECKL NOT = ZEROS
  8314         MOVE CHECKI             TO CH-CHECK-NO.
  8315
  8316     IF REASONL NOT = ZEROS
  8317         MOVE REASONI            TO CH-REASON-FOR-CHECK.
  8318
  8319*    IF DEDAMTL NOT = ZEROS
  8320*        MOVE WS-DED             TO CH-DEDUCT-WITHHELD
  8321*                                   DEDAMTO.
  8322
  8323*    IF ADDLCHGL NOT = ZEROS
  8324*        MOVE WS-ADDL            TO CH-ADDITIONAL-CHARGE
  8325*                                   ADDLCHGO.
  8326
  8327     IF STUBL NOT = ZEROS
  8328         MOVE STUBI              TO CH-STUB-LINE-1.
  8329
  8330     IF TEXT1L NOT = ZEROS
  8331         MOVE TEXT1I             TO CH-TEXT-LINE-1.
  8332
  8333     IF TEXT2L NOT = ZEROS
  8334         MOVE TEXT2I             TO CH-TEXT-LINE-2.
  8335
  8336     IF TEXT3L NOT = ZEROS
  8337         MOVE TEXT3I             TO CH-TEXT-LINE-3.
  8338
  8339     IF TYPEL NOT = ZEROS
  8340         MOVE TYPEI              TO CH-CHECK-ORIGIN-SW.
  8341
  8342*    MOVE LETTER1I               TO CH-LETTERS (1).
  8343*    MOVE LETTER2I               TO CH-LETTERS (2).
  8344*    MOVE LETTER3I               TO CH-LETTERS (3).
  8345
  8346*    MOVE SPACES                 TO CH-CHECK-REFERENCE.
  8347     IF CH-CHECK-ORIGIN-SW = 'R'
  8348         PERFORM 1500-VERIFY-PENDING-BUS-REC THRU 1590-EXIT
  8349*        MOVE PI-REFERENCE           TO CH-CHECK-REFERENCE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 150
* EL677.cbl
  8350         MOVE PI-CANC-DT             TO CH-CANC-DT
  8351         MOVE PI-LF-REFUND           TO CH-LF-REFUND
  8352         MOVE PI-AH-REFUND           TO CH-AH-REFUND
  8353     end-if
  8354     MOVE PI-INSURED-NAME        TO CH-INSURED-NAME.
  8355*    IF PI-AR-PROCESSING AND
  8356*       REFL NOT = ZERO
  8357*        MOVE REFI                   TO CH-CHECK-REFERENCE.
  8358
  8359 4000-EXIT.
  8360      EXIT.
  8361 4100-CONNECT-TO-DB.
  8362     move 'NTSQLTST2_Logic'      to svr
  8363     move 'sa'                   to usr
  8364     move 'sql2008r2'            to pass
  8365
  8366     if ws-kix-myenv = 'cid1p'
  8367        move 'NTCSO2_ChkApprv'   to svr
  8368        move 'sa'                to usr
  8369        move 'ntcso2'            to pass
  8370     end-if
  8371     string
  8372         usr delimited space
  8373         "." delimited size
  8374         pass delimited space into usr-pass
  8375     end-string
  8376     EXEC SQL
  8377        CONNECT TO :svr USER :usr-pass
  8378     END-EXEC
  8379     if sqlcode not = 0
  8380        display "Error: cannot connect "
  8381        display sqlcode
  8382        display sqlerrmc
  8383     end-if
  8384     set connected-to-db to true
  8385     .
  8386 4100-EXIT.
  8387     EXIT.
  8388 4150-open-cursor.
  8389     move pi-company-id          to ws-compid
  8390     move ch-carrier             to ws-carrier
  8391     move ch-grouping            to ws-grouping
  8392     move ch-state               to ws-state
  8393     move ch-account             to ws-account
  8394     move ch-cert-eff-dt         to dc-bin-date-1
  8395     move ' '                    to dc-option-code
  8396     perform 8500-date-convert   thru 8500-exit
  8397     if no-conversion-error
  8398        move dc-greg-date-a-edit to ws-eff-date
  8399     end-if
  8400     move ch-cert-prime          to ws-certificate
  8401     move ch-cert-sfx            to ws-cert-sfx
  8402     move ch-sequence-no         to ws-seq-no
  8403     move '1'                    to ws-type
  8404                                    ws-check-sub-type
  8405     if pi-check-type = 'C'
  8406        move '2'                 to ws-check-sub-type
  8407     end-if
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 151
* EL677.cbl
  8408     EXEC SQL
  8409        DECLARE
  8410           checkapp cursor for
  8411        SELECT
  8412           ApprovalStatus,
  8413           MaintainedBy,
  8414           MaintainedDate,
  8415           ApprovalBatch
  8416        FROM
  8417           ChkApp_Check
  8418        WHERE
  8419           Company           = :ws-compid
  8420           and CertCarrier   = :ws-carrier
  8421           and CertGroup     = :ws-grouping
  8422           and CertState     = :ws-state
  8423           and CertAccount   = :ws-account
  8424           and CertEffDate   = :ws-eff-date
  8425           and CertNumber    = :ws-certificate
  8426           and CertNumberSuf = :ws-cert-sfx
  8427           and CheckSeqNbr   = :ws-seq-no
  8428           and CheckType     = :ws-type
  8429           and CheckSubType  = :ws-check-sub-type
  8430     END-EXEC
  8431     if sqlcode not = 0
  8432        display "Error: cannot declare cursor "
  8433        display ' sql retrun code ' sqlcode
  8434        display ' sql err mess    ' sqlerrmc
  8435        go to 4150-exit
  8436     end-if
  8437     EXEC SQL
  8438        open checkapp
  8439     END-EXEC
  8440     if sqlcode not = 0
  8441        display "Error: cannot open cursor "
  8442        display ' sql retrun code ' sqlcode
  8443        display ' sql err mess    ' sqlerrmc
  8444     end-if
  8445     .
  8446 4150-exit.
  8447     exit.
  8448 4200-get-tbl-row.
  8449***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  8450***                                                            ***
  8451***  I'm only expecting one row so no cursor is declared       ***
  8452***                                                            ***
  8453***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  8454     move pi-company-id          to ws-compid
  8455     move ch-carrier             to ws-carrier
  8456     move ch-grouping            to ws-grouping
  8457     move ch-state               to ws-state
  8458     move ch-account             to ws-account
  8459     move ch-cert-eff-dt         to dc-bin-date-1
  8460     move ' '                    to dc-option-code
  8461     perform 8500-date-convert   thru 8500-exit
  8462     if no-conversion-error
  8463        move dc-greg-date-a-edit to ws-eff-date
  8464     end-if
  8465     move ch-cert-prime          to ws-certificate
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 152
* EL677.cbl
  8466     move ch-cert-sfx            to ws-cert-sfx
  8467     move ch-sequence-no         to ws-seq-no
  8468     move '1'                    to ws-type
  8469                                    ws-check-sub-type
  8470     if pi-check-type = 'C'
  8471        move '2'                 to ws-check-sub-type
  8472     end-if
  8473     exec sql
  8474        SELECT
  8475           ApprovalStatus,
  8476           MaintainedBy,
  8477           MaintainedDate,
  8478           ApprovalBatch
  8479        INTO
  8480           :db-app-status :nu-app-status,
  8481           :db-app-by :nu-app-by,
  8482           :db-app-date :nu-app-date,
  8483           :db-app-batch :nu-app-batch
  8484        FROM
  8485           ChkApp_Check
  8486        WHERE
  8487           Company           = :ws-compid
  8488           and CertCarrier   = :ws-carrier
  8489           and CertGroup     = :ws-grouping
  8490           and CertState     = :ws-state
  8491           and CertAccount   = :ws-account
  8492           and CertEffDate   = :ws-eff-date
  8493           and CertNumber    = :ws-certificate
  8494           and CertNumberSuf = :ws-cert-sfx
  8495           and CheckSeqNbr   = :ws-seq-no
  8496           and CheckType     = :ws-type
  8497           and CheckSubType  = :ws-check-sub-type
  8498     end-exec
  8499     if sqlcode not = 0
  8500        display "Error: cannot read row "
  8501        display ' sql return code ' sqlcode
  8502        display ' sql err mess    ' sqlerrmc
  8503        go to 4200-exit
  8504     end-if
  8505*    display ' status ' db-app-status
  8506*    display ' by     ' db-app-by
  8507*    display ' date   ' db-app-date
  8508*    display ' batch  ' db-app-batch
  8509*    if nu-app-date = -1
  8510*       display ' approval date is low-values '
  8511*    else
  8512*       display ' approval date is NOT low values '
  8513*    end-if
  8514     .
  8515 4200-exit.
  8516     exit.
  8517 4250-delete-row.
  8518     EXEC SQL
  8519        DELETE
  8520           from ChkApp_Check
  8521        WHERE
  8522           Company           = :ws-compid
  8523           and CertCarrier   = :ws-carrier
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 153
* EL677.cbl
  8524           and CertGroup     = :ws-grouping
  8525           and CertState     = :ws-state
  8526           and CertAccount   = :ws-account
  8527           and CertEffDate   = :ws-eff-date
  8528           and CertNumber    = :ws-certificate
  8529           and CertNumberSuf = :ws-cert-sfx
  8530           and CheckSeqNbr   = :ws-seq-no
  8531           and CheckType     = :ws-type
  8532           and CheckSubType  = :ws-check-sub-type
  8533     END-EXEC
  8534     if sqlcode not = 0
  8535        display "Error: cannot delete row  "
  8536        display ' sql retrun code ' sqlcode
  8537        display ' sql err mess    ' sqlerrmc
  8538        go to 4250-exit
  8539     end-if
  8540     set row-deleted         to true
  8541     EXEC SQL
  8542         commit transaction
  8543     END-EXEC
  8544     if sqlcode not = 0
  8545        display "Error: commit "
  8546        display ' sql return code ' sqlcode
  8547        display ' sql err mess    ' sqlerrmc
  8548        go to 4250-exit
  8549     end-if
  8550     set tbl-commited to true
  8551     .
  8552 4250-exit.
  8553     exit.
  8554 4300-FINISH-UP-DB.
  8555     EXEC SQL
  8556         commit work release
  8557     END-EXEC
  8558     if sqlcode not = 0
  8559        display "Error: commit release "
  8560        display ' sql return code ' sqlcode
  8561        display ' sql err mess    ' sqlerrmc
  8562     end-if
  8563     .
  8564 4300-EXIT.
  8565     EXIT.
  8566 5000-BROWSE-FILE.
  8567
  8568* EXEC CICS HANDLE CONDITION
  8569*        NOTFND   (5560-END-OF-FILE)
  8570*        ENDFILE  (5560-END-OF-FILE)
  8571*    END-EXEC.
  8572*    MOVE '"$I''                  ! . #00007935' TO DFHEIV0
  8573     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8575     MOVE X'2E20233030303037393335' TO DFHEIV0(25:11)
  8576     CALL 'kxdfhei1' USING DFHEIV0
  8577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8578
  8579
  8580     MOVE PI-ERCHEK-KEY          TO ERCHEK-KEY.
  8581
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 154
* EL677.cbl
  8582     IF SEQI = LOW-VALUES
  8583         MOVE +1                 TO CHEK-RECORD-SEQ.
  8584
  8585     IF EIBAID = DFHPF2
  8586         GO TO 5100-BROWSE-BKWD.
  8587
  8588 5010-READ-LOOP.
  8589     IF EIBAID = DFHPF1
  8590         ADD +1                  TO CHEK-RECORD-SEQ.
  8591
  8592
  8593* EXEC CICS READ
  8594*        DATASET  (ERCHEK-FILE-ID)
  8595*        SET      (ADDRESS OF CHECK-RECORDS)
  8596*        RIDFLD   (ERCHEK-KEY)
  8597*        GTEQ
  8598*    END-EXEC.
  8599*    MOVE '&"S        G          (   #00007952' TO DFHEIV0
  8600     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8601     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8602     MOVE X'2020233030303037393532' TO DFHEIV0(25:11)
  8603     CALL 'kxdfhei1' USING DFHEIV0,
  8604           ERCHEK-FILE-ID,
  8605           DFHEIV20,
  8606           DFHEIV99,
  8607           ERCHEK-KEY,
  8608           DFHEIV99,
  8609           DFHEIV99,
  8610           DFHEIV99
  8611     SET ADDRESS OF CHECK-RECORDS TO
  8612         DFHEIV20
  8613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8614
  8615
  8616     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8617         IF EIBAID = DFHENTER
  8618             GO TO 5550-NO-RECORD
  8619         ELSE
  8620             GO TO 5560-END-OF-FILE.
  8621
  8622        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8623           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8624           PI-CHEK-STATE      = CH-STATE       AND
  8625           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8626           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8627           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8628           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8629              GO TO 5500-FORMAT-SCREEN
  8630            ELSE
  8631              IF EIBAID = DFHPF1
  8632                  GO TO 5560-END-OF-FILE
  8633                ELSE
  8634                  GO TO 5550-NO-RECORD.
  8635
  8636     IF EIBAID = DFHENTER
  8637        IF CHEK-CARRIER    = CH-CARRIER     AND
  8638           CHEK-GROUPING   = CH-GROUPING    AND
  8639           CHEK-STATE      = CH-STATE       AND
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 155
* EL677.cbl
  8640           CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8641           CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8642           CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8643           CHEK-SUF-NO     = CH-CERT-SFX    AND
  8644           CHEK-RECORD-SEQ = CH-SEQUENCE-NO
  8645              GO TO 5500-FORMAT-SCREEN
  8646        ELSE
  8647              GO TO 5550-NO-RECORD.
  8648
  8649     GO TO 5500-FORMAT-SCREEN.
  8650
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 156
* EL677.cbl
  8652
  8653 5100-BROWSE-BKWD.
  8654
  8655* EXEC CICS STARTBR
  8656*        DATASET  (ERCHEK-FILE-ID)
  8657*        RIDFLD   (ERCHEK-KEY)
  8658*    END-EXEC.
  8659     MOVE 0
  8660       TO DFHEIV11
  8661*    MOVE '&,         G          &   #00007997' TO DFHEIV0
  8662     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8663     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8664     MOVE X'2020233030303037393937' TO DFHEIV0(25:11)
  8665     CALL 'kxdfhei1' USING DFHEIV0,
  8666           ERCHEK-FILE-ID,
  8667           ERCHEK-KEY,
  8668           DFHEIV99,
  8669           DFHEIV11,
  8670           DFHEIV99
  8671     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8672
  8673
  8674
  8675* EXEC CICS READPREV
  8676*        DATASET  (ERCHEK-FILE-ID)
  8677*        SET      (ADDRESS OF CHECK-RECORDS)
  8678*        RIDFLD   (ERCHEK-KEY)
  8679*    END-EXEC.
  8680     MOVE 0
  8681       TO DFHEIV11
  8682*    MOVE '&0S                   )   #00008002' TO DFHEIV0
  8683     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8684     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8685     MOVE X'2020233030303038303032' TO DFHEIV0(25:11)
  8686     CALL 'kxdfhei1' USING DFHEIV0,
  8687           ERCHEK-FILE-ID,
  8688           DFHEIV20,
  8689           DFHEIV99,
  8690           ERCHEK-KEY,
  8691           DFHEIV99,
  8692           DFHEIV11,
  8693           DFHEIV99,
  8694           DFHEIV99
  8695     SET ADDRESS OF CHECK-RECORDS TO
  8696         DFHEIV20
  8697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8698
  8699
  8700 5110-READ-LOOP.
  8701     IF PI-FILE-EOF
  8702         MOVE SPACE              TO PI-EOF-SW
  8703     ELSE
  8704
  8705* EXEC CICS READPREV
  8706*            DATASET  (ERCHEK-FILE-ID)
  8707*            SET      (ADDRESS OF CHECK-RECORDS)
  8708*            RIDFLD   (ERCHEK-KEY)
  8709*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 157
* EL677.cbl
  8710     MOVE 0
  8711       TO DFHEIV11
  8712*    MOVE '&0S                   )   #00008012' TO DFHEIV0
  8713     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8714     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8715     MOVE X'2020233030303038303132' TO DFHEIV0(25:11)
  8716     CALL 'kxdfhei1' USING DFHEIV0,
  8717           ERCHEK-FILE-ID,
  8718           DFHEIV20,
  8719           DFHEIV99,
  8720           ERCHEK-KEY,
  8721           DFHEIV99,
  8722           DFHEIV11,
  8723           DFHEIV99,
  8724           DFHEIV99
  8725     SET ADDRESS OF CHECK-RECORDS TO
  8726         DFHEIV20
  8727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8728
  8729
  8730     IF CH-COMPANY-CD NOT = PI-COMPANY-CD
  8731         GO TO 5560-END-OF-FILE.
  8732
  8733        IF PI-CHEK-CARRIER    = CH-CARRIER     AND
  8734           PI-CHEK-GROUPING   = CH-GROUPING    AND
  8735           PI-CHEK-STATE      = CH-STATE       AND
  8736           PI-CHEK-ACCOUNT    = CH-ACCOUNT     AND
  8737           PI-CHEK-EFF-DT     = CH-CERT-EFF-DT AND
  8738           PI-CHEK-CERT-NO    = CH-CERT-PRIME  AND
  8739           PI-CHEK-SUF-NO     = CH-CERT-SFX
  8740              GO TO 5500-FORMAT-SCREEN
  8741            ELSE
  8742              GO TO 5560-END-OF-FILE.
  8743
  8744     GO TO 5500-FORMAT-SCREEN.
  8745
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 158
* EL677.cbl
  8747*                          COPY ELCNPD.
  8748*****************************************************************
  8749*                                                               *
  8750*                                                               *
  8751*                            ELCNPD                             *
  8752*                            VMOD=2.001                         *
  8753*****************************************************************
  8754
  8755 5200-MOVE-NAME.
  8756*                THE FOLLOWING ROUTINE MOVES THE INSURRED'S     *
  8757*            NAME TO A WORK AREA WITH NO EMBEDDED               *
  8758*            BLANKS.                                            *
  8759*                                                               *
  8760*                  FIELD               VALUE                    *
  8761*                                                               *
  8762*                LAST NAME (CL15)      SMITH                    *
  8763*                1ST NAME  (CL12)      JOHN                     *
  8764*                MID NAME  (CL1)       A                        *
  8765*                                                               *
  8766*                AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30)  *
  8767*         *                                                     *
  8768*         *              JOHN A. SMITH                          *
  8769*         *                                                     *
  8770*         *      TO USE THIS ROUTINE YOU ALSO NEED A WORKING    *
  8771*         *  STORAGE COPYBOOK:                                  *
  8772*         *                                                     *
  8773*         *      01  WS-NAME-WORK-AREA COPY ELCNWA.             *
  8774*         *******************************************************.
  8775
  8776     MOVE SPACES                 TO  WS-NAME-WORK
  8777                                     WS-NAME-WORK2.
  8778     MOVE ZERO                   TO  WS-NAME-SW.
  8779     SET NWA-INDEX TO +1.
  8780
  8781     IF WS-INSURED-1ST-NAME = SPACES  AND
  8782        WS-INSURED-MID-INIT = SPACES
  8783         MOVE WS-INSURED-LAST-NAME TO WS-NAME-WORK
  8784         GO TO 5200-EXIT.
  8785
  8786     MOVE WS-INSURED-1ST-NAME    TO  WS-NAME-WORK2.
  8787     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8788
  8789     SET NWA-INDEX UP BY +1
  8790     IF WS-INSURED-MID-INIT NOT = SPACES
  8791        MOVE WS-INSURED-MID-INIT   TO  WS-NW (NWA-INDEX)
  8792        SET NWA-INDEX UP BY +1
  8793        MOVE '.'                   TO  WS-NW (NWA-INDEX)
  8794        SET NWA-INDEX UP BY +2.
  8795
  8796     MOVE WS-INSURED-LAST-NAME  TO  WS-NAME-WORK2.
  8797     PERFORM 5300-MOVE-NAME THRU 5390-EXIT.
  8798
  8799
  8800 5200-EXIT.
  8801     EXIT.
  8802
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 159
* EL677.cbl
  8804 5300-MOVE-NAME SECTION.
  8805     IF WS-NAME-SW GREATER THAN +1
  8806         GO TO 5390-EXIT.
  8807
  8808     IF WS-NAME-WORK2 = SPACES
  8809         GO TO 5390-EXIT.
  8810
  8811     SET NWA-INDEX2 TO +1.
  8812     SET NWA-INDEX3 TO +2.
  8813
  8814 5310-MOVE-NAME.
  8815     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
  8816
  8817     IF NWA-INDEX LESS THAN +30
  8818        SET NWA-INDEX UP BY +1
  8819     ELSE
  8820        ADD +2  TO  WS-NAME-SW
  8821        GO TO 5390-EXIT.
  8822
  8823     IF NWA-INDEX2 LESS THAN +20
  8824         SET NWA-INDEX2 UP BY +1
  8825         SET NWA-INDEX3 UP BY +1.
  8826
  8827     IF WS-NW2 (NWA-INDEX2) = SPACES AND
  8828        WS-NW2 (NWA-INDEX3) = SPACES
  8829        GO TO 5390-EXIT.
  8830
  8831     GO TO 5310-MOVE-NAME.
  8832
  8833 5390-EXIT.
  8834     EXIT.
  8835
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 160
* EL677.cbl
  8838 5500-FORMAT-SCREEN.
  8839     MOVE LOW-VALUES             TO  EL677AI.
  8840     MOVE 'S'                    TO  MAINTI   PI-PREV-MAINT.
  8841     MOVE +1                     TO  MAINTL.
  8842     MOVE CH-CONTROL-PRIMARY     TO  PI-ERCHEK-KEY.
  8843     MOVE CH-CARRIER             TO  CARRIERO.
  8844     MOVE CH-GROUPING            TO  GROUPO.
  8845     MOVE CH-STATE               TO  STATEO.
  8846     MOVE CH-ACCOUNT             TO  ACCTO.
  8847
  8848     MOVE CH-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8849     MOVE SPACE                  TO  DC-OPTION-CODE.
  8850     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8851     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  8852
  8853     MOVE CH-CERT-PRIME          TO  CERTNOO.
  8854     MOVE CH-CERT-SFX            TO  SFXO.
  8855     MOVE CH-SEQUENCE-NO         TO  SEQO.
  8856
  8857     MOVE AL-UANON               TO  CARRIERA
  8858                                     GROUPA
  8859                                     STATEA
  8860                                     ACCTA
  8861                                     EFFDTA
  8862                                     CERTNOA
  8863                                     SFXA.
  8864     MOVE CH-PAYEE-NAME-1         TO PI-PAYTO1.
  8865
  8866     if ch-approval-dt not = low-values
  8867        move ch-approval-dt      to dc-bin-date-1
  8868        move ' '                 to dc-option-code
  8869        perform 8500-date-convert thru 8500-exit
  8870        move dc-greg-date-1-edit to apvdto
  8871     end-if
  8872     evaluate ch-approval-status
  8873        when '2'
  8874           move 'PENDING '       TO APVSTATO
  8875        when 'P'
  8876           move 'PENDING '       TO APVSTATO
  8877        when 'A'
  8878           move 'APPROVED'       to apvstato
  8879        when 'D'
  8880           move 'DENIED'         to apvstato
  8881     end-evaluate
  8882     move ch-approved-by         to apvbyo
  8883*    IF PI-COMPANY-ID = 'TMS'
  8884*        MOVE CH-PAYEE-NAME-2    TO  PAYTO1O
  8885*        MOVE CH-LIENHOLDER-NAME TO  PAYTO1AO
  8886*    ELSE
  8887         MOVE CH-PAYEE-NAME-1    TO  PAYTO1O
  8888         MOVE CH-PAYEE-NAME-2    TO  PAYTO2O.
  8889
  8890     MOVE CH-PAYEE-ADDRESS-1     TO  PAYAD1O.
  8891     MOVE CH-PAYEE-ADDRESS-2     TO  PAYAD2O.
  8892     move ch-payee-city          to payctyo
  8893     move ch-payee-state         to paysto
  8894     MOVE CH-PAYEE-CODE          TO  PAYEEO.
  8895
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 161
* EL677.cbl
  8896     IF CH-PAYEE-ZIP-CODE NOT = ZEROS
  8897         MOVE CH-PAYEE-ZIP-CODE  TO  PTOZIPO
  8898         MOVE AL-UANON           TO  PTOZIPA.
  8899
  8900     MOVE CH-RETURN-TO           TO  RETTOO
  8901*    if ch-check-cashed-dt not = spaces and low-values
  8902*       move ch-check-cashed-dt  to dc-bin-date-1
  8903*       MOVE SPACE               TO  DC-OPTION-CODE
  8904*       PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8905*       MOVE DC-GREG-DATE-1-EDIT TO  CASHEDO
  8906*    end-if
  8907     MOVE CH-RECORDED-DT         TO  DC-BIN-DATE-1.
  8908     MOVE SPACE                  TO  DC-OPTION-CODE.
  8909     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  8910     MOVE DC-GREG-DATE-1-EDIT    TO  CREATEDO.
  8911
  8912     MOVE CH-RECORDED-BY         TO  CBYO.
  8913
  8914     IF CH-VOID-DT = SPACES OR LOW-VALUES OR ZEROS
  8915         NEXT SENTENCE
  8916     ELSE
  8917         MOVE CH-VOID-DT             TO  DC-BIN-DATE-1
  8918         MOVE SPACE                  TO  DC-OPTION-CODE
  8919         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8920         MOVE DC-GREG-DATE-1-EDIT    TO  VOIDEDO
  8921         MOVE CH-VOID-BY             TO  VBYO.
  8922
  8923     IF CH-CHECK-WRITTEN-DT = SPACES OR LOW-VALUES OR ZEROS
  8924         NEXT SENTENCE
  8925     ELSE
  8926         MOVE CH-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1
  8927         MOVE SPACE                  TO  DC-OPTION-CODE
  8928         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  8929         MOVE DC-GREG-DATE-1-EDIT    TO  PRINTEDI.
  8930
  8931     MOVE CH-AMOUNT-PAID         TO  AMOUNTO.
  8932     MOVE AL-SANOF               TO  AMOUNTA.
  8933     MOVE CH-CHECK-ORIGIN-SW     TO  TYPEI.
  8934     MOVE AL-SANOF               TO  TYPEA.
  8935     MOVE CH-CHECK-NO            TO  CHECKO.
  8936     move ch-deduct-commission   to dedcyno
  8937     MOVE CH-REASON-FOR-CHECK    TO  REASONO.
  8938     MOVE CH-VOID-REASON         TO  VREASONO.
  8939
  8940     MOVE CH-STUB-LINE-1         TO  STUBO.
  8941     MOVE CH-TEXT-LINE-1         TO  TEXT1O.
  8942     MOVE CH-TEXT-LINE-2         TO  TEXT2O.
  8943     MOVE CH-TEXT-LINE-3         TO  TEXT3O.
  8944     IF CH-LF-REFUND NOT NUMERIC
  8945         MOVE ZEROS              TO CH-LF-REFUND.
  8946     IF CH-AH-REFUND NOT NUMERIC
  8947         MOVE ZEROS              TO CH-AH-REFUND.
  8948     if (ch-check-no not = spaces and low-values)
  8949        and (ch-check-written-dt not = low-values)
  8950        perform 5800-fetch-check-cashed-dt
  8951                                 thru 5800-exit
  8952     end-if
  8953     IF CH-CHECK-WRITTEN-DT GREATER LOW-VALUES OR
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 162
* EL677.cbl
  8954        CH-VOID-DT          GREATER LOW-VALUES
  8955        MOVE AL-SANON            TO  CHECKA    REASONA  VREASONA
  8956                                     STUBA     TEXT1A   TEXT2A
  8957                                     TEXT3A    PAYTO1A  SFXA
  8958                                     PAYTO2A   PAYAD1A  PAYctyA
  8959                                     paysta    RETTOA   PAYAD2A
  8960                                     PTOZIPA
  8961                                     PRINTEDA
  8962     ELSE
  8963        MOVE AL-UANON            TO  CARRIERA  GROUPA   STATEA
  8964                                     ACCTA     EFFDTA   CERTNOA
  8965                                     CHECKA    REASONA  VREASONA
  8966                                     STUBA     TEXT1A   TEXT2A
  8967                                     TEXT3A    PAYTO1A  SFXA
  8968                                     PAYTO2A   PAYAD1A  PAYctyA
  8969                                     paysta    RETTOA   PAYAD2A
  8970                                     PRINTEDA.
  8971
  8972     MOVE AL-UNNON               TO SEQA.
  8973     perform 5600-get-erpndb     thru 5600-exit
  8974     perform 5700-get-elcert     thru 5700-exit
  8975*    move pi-prev-paid           to prepdo
  8976     move al-sadof               to drefa
  8977*    if WS-PNDB-FOUND
  8978*       compute refo = pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  8979*    end-if
  8980     if WS-CERT-FOUND
  8981        compute ws-tot-lf-prem = cm-lf-premium-amt +
  8982           cm-lf-alt-premium-amt
  8983        compute ws-tot-iss-prem  =
  8984           cm-ah-premium-amt + ws-tot-lf-prem
  8985        compute ws-tot-iss-comm =
  8986           (ws-tot-lf-prem * cm-life-comm-pct) +
  8987           (cm-ah-premium-amt * cm-ah-comm-pct)
  8988        compute ws-tot-ref-comm =
  8989           (pi-lf-refund * cm-life-comm-pct) +
  8990           (pi-ah-refund * cm-ah-comm-pct)
  8991        move ws-tot-iss-prem     to premo
  8992        move ws-tot-iss-comm     to isscommo
  8993*       move ws-tot-ref-comm     to uecommo
  8994     end-if
  8995     if PI-TO-EL677-FROM-EL1273
  8996        move zeros               to premo
  8997                                    isscommo
  8998                                    uecommo
  8999                                    prepdo
  9000                                    refo
  9001     end-if
  9002     GO TO 8100-SEND-INITIAL-MAP
  9003     .
  9004 5550-NO-RECORD.
  9005     MOVE ER-1162                TO  EMI-ERROR.
  9006     MOVE -1                     TO  CARRIERL.
  9007     MOVE AL-UABON               TO  CARRIERA  GROUPA  STATEA
  9008                                     ACCTA     EFFDTA  CERTNOA
  9009                                     SFXA      SEQA.
  9010     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9011
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 163
* EL677.cbl
  9012     IF (NOT PI-TO-EL677-FROM-EL1273)
  9013        and (pi-return-to-program not = 'EL6315')
  9014         GO TO 8200-SEND-DATAONLY.
  9015
  9016     MOVE CHEK-CARRIER           TO  CARRIERO.
  9017     MOVE CHEK-GROUPING          TO  GROUPO.
  9018     MOVE CHEK-STATE             TO  STATEO.
  9019     MOVE CHEK-ACCOUNT           TO  ACCTO.
  9020
  9021     MOVE CHEK-EFF-DT            TO  DC-BIN-DATE-1.
  9022     MOVE SPACE                  TO  DC-OPTION-CODE.
  9023     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  9024     MOVE DC-GREG-DATE-1-EDIT    TO  EFFDTI.
  9025
  9026     MOVE CHEK-CERT-NO           TO  CERTNOO.
  9027     MOVE CHEK-SUF-NO            TO  SFXO.
  9028     GO TO 8100-SEND-INITIAL-MAP.
  9029
  9030 5560-END-OF-FILE.
  9031     IF EIBAID = DFHPF1
  9032         MOVE 'Y'                TO  PI-EOF-SW
  9033         MOVE ER-2237            TO  EMI-ERROR
  9034     ELSE
  9035     IF EIBAID = DFHENTER
  9036        GO TO 5550-NO-RECORD
  9037     ELSE
  9038*        MOVE SPACES             TO  PI-ERCHEK-KEY
  9039         MOVE ER-2238            TO  EMI-ERROR.
  9040
  9041     MOVE -1                     TO  MAINTL.
  9042     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9043     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 164
* EL677.cbl
  9045 5600-get-erpndb.
  9046     MOVE 'N'                    TO WS-PNDB-FOUND-SW.
  9047     MOVE PI-COMPANY-CD          TO ERPNDB-ALT-COMPANY-CD.
  9048     MOVE PI-CARRIER             TO ERPNDB-ALT-CARRIER.
  9049     MOVE PI-GROUPING            TO ERPNDB-ALT-GROUPING.
  9050     MOVE PI-STATE               TO ERPNDB-ALT-STATE.
  9051     MOVE PI-ACCOUNT             TO ERPNDB-ALT-ACCOUNT.
  9052     MOVE PI-CERT-PRIME          TO ERPNDB-ALT-CERT-PRIME.
  9053     MOVE PI-CERT-SFX            TO ERPNDB-ALT-CERT-SFX.
  9054     MOVE PI-CERT-EFF-DT         TO ERPNDB-ALT-CERT-EFF-DT.
  9055     MOVE ZEROS                  TO ERPNDB-ALT-CH-SEQ-NO.
  9056     MOVE '2'                    TO ERPNDB-ALT-RECORD-TYPE.
  9057     IF ST-ACCNT-CNTL  OR
  9058        ACCNT-CNTL
  9059          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9060     IF ST-ACCNT-CNTL      OR
  9061        CARR-ST-ACCNT-CNTL OR
  9062        ACCNT-CNTL         OR
  9063        CARR-ACCNT-CNTL
  9064          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9065     IF ACCNT-CNTL OR
  9066        CARR-ACCNT-CNTL
  9067          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9068
  9069* EXEC CICS READ
  9070*         DATASET   (ERPNDB-ALT-FILE-ID)
  9071*         SET       (ADDRESS OF PENDING-BUSINESS)
  9072*         RIDFLD    (ERPNDB-ALT-KEY)
  9073*         resp      (ws-response)
  9074*    END-EXEC
  9075*    MOVE '&"S        E          (  N#00008356' TO DFHEIV0
  9076     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9077     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9078     MOVE X'204E233030303038333536' TO DFHEIV0(25:11)
  9079     CALL 'kxdfhei1' USING DFHEIV0,
  9080           ERPNDB-ALT-FILE-ID,
  9081           DFHEIV20,
  9082           DFHEIV99,
  9083           ERPNDB-ALT-KEY,
  9084           DFHEIV99,
  9085           DFHEIV99,
  9086           DFHEIV99
  9087     SET ADDRESS OF PENDING-BUSINESS TO
  9088         DFHEIV20
  9089     MOVE EIBRESP  TO ws-response
  9090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9091     if resp-normal
  9092        MOVE 'Y'                 TO WS-PNDB-FOUND-SW
  9093        compute pi-refund-on-pending-rec =
  9094           pb-c-lf-cancel-amt + pb-c-ah-cancel-amt
  9095     end-if
  9096     .
  9097 5600-exit.
  9098     exit.
  9099 5700-get-elcert.
  9100     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9101     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9102     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 165
* EL677.cbl
  9103     MOVE PI-STATE               TO  ELCERT-STATE.
  9104     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9105     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9106     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9107     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9108     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9109
  9110* EXEC CICS READ
  9111*         DATASET   (ELCERT-FILE-ID)
  9112*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9113*         RIDFLD    (ELCERT-KEY)
  9114*         resp      (ws-response)
  9115*    END-EXEC
  9116*    MOVE '&"S        E          (  N#00008380' TO DFHEIV0
  9117     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9118     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9119     MOVE X'204E233030303038333830' TO DFHEIV0(25:11)
  9120     CALL 'kxdfhei1' USING DFHEIV0,
  9121           ELCERT-FILE-ID,
  9122           DFHEIV20,
  9123           DFHEIV99,
  9124           ELCERT-KEY,
  9125           DFHEIV99,
  9126           DFHEIV99,
  9127           DFHEIV99
  9128     SET ADDRESS OF CERTIFICATE-MASTER TO
  9129         DFHEIV20
  9130     MOVE EIBRESP  TO ws-response
  9131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9132     if resp-normal
  9133        MOVE 'Y'                 TO WS-CERT-FOUND-SW
  9134     end-if
  9135     .
  9136 5700-exit.
  9137     exit.
  9138 5800-fetch-check-cashed-dt.
  9139     move ' '                    to ws-connect-sw
  9140                                    ws-match-sw
  9141                                    pi-check-cashed
  9142     move 'NTCSO2_PdBnkInfo'     to svr
  9143     move 'sa'                   to usr
  9144     move 'ntcso2'               to pass
  9145     string
  9146         usr delimited space
  9147         "." delimited size
  9148         pass delimited space into usr-pass
  9149     end-string
  9150     EXEC SQL
  9151        CONNECT TO :svr USER :usr-pass
  9152     END-EXEC
  9153     if sqlcode not = 0
  9154        display "Error: cannot connect to pdbnkinfo "
  9155        display sqlcode
  9156        display sqlerrmc
  9157        go to 5800-exit
  9158     end-if
  9159     set connected-to-db to true
  9160     if pi-company-id = 'CID'
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 166
* EL677.cbl
  9161        move 'CSO - AP%'         to ws-pb-compid
  9162     else
  9163        move 'AHL - AP%'         to ws-pb-compid
  9164     end-if
  9165     move '000'                  to ws-pb-check-no (1:3)
  9166     move ch-check-no            to ws-pb-check-no (4:7)
  9167     move spaces                 to ws-pb-bad-check-no
  9168     perform varying s1 from +1 by +1 until
  9169        (s1 > +10)
  9170        or (ws-pb-check-no (s1:1) not = '0')
  9171     end-perform
  9172     if s1 < +11
  9173        move ws-pb-check-no (s1:11 - s1)
  9174                            to ws-pb-bad-check-no (1: 11 - s1)
  9175     end-if
  9176*    display ' compid **' ws-pb-compid '**'
  9177*    display ' ckno  **' ws-pb-check-no '**'
  9178     MOVE ch-AMOUNT-PAID      TO WS-CHECK-AMT-TMP
  9179     MOVE WS-CHECK-AMT-TMPX   TO WS-CHECK-AMOUNT
  9180     MOVE SPACES              TO pb-paid-date
  9181
  9182     EXEC SQL
  9183        CALL pbi_GetCashDate_by_TransactionNbr
  9184           @compid          = :ws-pb-compid,
  9185           @checkno         = :ws-pb-check-no,
  9186           @badcheckno      = :ws-pb-bad-check-no,
  9187           @checkamount     = :ws-check-amount,
  9188           @checkcasheddate = :pb-paid-date OUT
  9189     END-EXEC
  9190     if sqlcode not = 0
  9191        display "Error: cannot run stor proc  "
  9192        move sqlcode            to ws-sql-code
  9193        move ws-sql-code to ws-dis-sql-code
  9194        display ' dis sql code ' ws-dis-sql-code
  9195        display ' sql return code ' sqlcode
  9196        display ' sql err mess    ' sqlerrmc
  9197        go to 5800-disconnect
  9198     end-if
  9199***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9200***                                                            ***
  9201***  The following code works just as well as the above        ***
  9202***  stored procedure and just as fast.                        ***
  9203***  Originally, I had declared a cursor and fetched through   ***
  9204***  the record set to find the correct check and that REALLY  ***
  9205***  slowed the response down to ~ 3/4 second.                 ***
  9206***                                                            ***
  9207***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9208*     EXEC SQL
  9209*        SELECT
  9210*           PaidDate
  9211*        INTO
  9212*           :pb-paid-date
  9213*        FROM
  9214*           dbo.cso_pbi_TransactionLookup
  9215*        WHERE
  9216*           (BankAcctDescr like :ws-pb-compid)
  9217*           and (Amount = :ws-check-amount)
  9218*           and ((transactionNbr = :ws-pb-check-no)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 167
* EL677.cbl
  9219*                  or
  9220*               (transactionnbr = :ws-pb-bad-check-no))
  9221**          and (CAST(TransactionNbr AS INT) =
  9222**             :ws-pb-check-no-num)
  9223**          and (right('00000' + rtrim(TransactionNbr),10)
  9224**             = :ws-pb-check-no)
  9225**          and (TransactionNbr  = :ws-pb-check-no)
  9226*     END-EXEC
  9227*    display ' chkno  ' pb-check-no
  9228*    display ' desc   ' pb-bank-acct-desc
  9229*    display ' trn typ' pb-tran-type
  9230*    display ' amt   *' pb-amount '**'
  9231*    display ' pd dte ' pb-paid-date
  9232     string pb-paid-date (1:4)
  9233            pb-paid-date (6:2)
  9234            pb-paid-date (9:2)
  9235        delimited by size into dc-greg-date-cymd-r
  9236     end-string
  9237     move 'L'                    to dc-option-code
  9238     perform 8500-date-convert   thru 8500-exit
  9239     if no-conversion-error
  9240*       move dc-bin-date-1       to ws-bin-cashed-dt
  9241        move dc-greg-date-1-edit to cashedo
  9242        move 'Y' to pi-check-cashed
  9243     else
  9244        display ' error cvtdte cash dt ' pb-paid-date ' '
  9245           dc-error-code
  9246     end-if
  9247     .
  9248 5800-disconnect.
  9249     EXEC SQL
  9250        DISCONNECT ALL
  9251     END-EXEC
  9252     if sqlcode not = 0
  9253        display "Error: cannot disconnect pdbnk "
  9254        display ' sql return code ' sqlcode
  9255        display ' sql err mess    ' sqlerrmc
  9256     end-if
  9257     .
  9258 5800-exit.
  9259     exit.
  9260 6000-VERIFY-COMP-MASTER.
  9261
  9262* EXEC CICS HANDLE CONDITION
  9263*        NOTFND   (6070-NO-COMP-MSTR)
  9264*    END-EXEC.
  9265*    MOVE '"$I                   ! / #00008515' TO DFHEIV0
  9266     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9267     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9268     MOVE X'2F20233030303038353135' TO DFHEIV0(25:11)
  9269     CALL 'kxdfhei1' USING DFHEIV0
  9270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9271
  9272
  9273     MOVE PI-COMPANY-CD          TO  ERCOMP-COMP-CD.
  9274
  9275     IF NOT PI-ZERO-CARRIER AND
  9276        NOT PI-ZERO-CAR-GROUP
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 168
* EL677.cbl
  9277         MOVE PI-CR-CARRIER      TO  ERCOMP-CARRIER
  9278     ELSE
  9279         MOVE ZEROS              TO  ERCOMP-CARRIER.
  9280
  9281     IF NOT PI-ZERO-GROUPING  AND
  9282        NOT PI-ZERO-CAR-GROUP
  9283         MOVE PI-CR-GROUPING     TO  ERCOMP-GROUPING
  9284     ELSE
  9285         MOVE ZEROS              TO  ERCOMP-GROUPING.
  9286
  9287     MOVE PI-CR-FIN-RESP         TO  ERCOMP-FIN-RESP.
  9288     MOVE PI-CR-ACCOUNT          TO  ERCOMP-ACCOUNT.
  9289     MOVE 'A'                    TO  ERCOMP-RECORD-TYPE.
  9290
  9291
  9292* EXEC CICS READ
  9293*         DATASET   (ERCOMP-FILE-ID)
  9294*         SET       (ADDRESS OF COMPENSATION-MASTER)
  9295*         RIDFLD    (ERCOMP-KEY)
  9296*     END-EXEC.
  9297*    MOVE '&"S        E          (   #00008537' TO DFHEIV0
  9298     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9299     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9300     MOVE X'2020233030303038353337' TO DFHEIV0(25:11)
  9301     CALL 'kxdfhei1' USING DFHEIV0,
  9302           ERCOMP-FILE-ID,
  9303           DFHEIV20,
  9304           DFHEIV99,
  9305           ERCOMP-KEY,
  9306           DFHEIV99,
  9307           DFHEIV99,
  9308           DFHEIV99
  9309     SET ADDRESS OF COMPENSATION-MASTER TO
  9310         DFHEIV20
  9311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9312
  9313
  9314     GO TO 6090-EXIT.
  9315
  9316 6070-NO-COMP-MSTR.
  9317     MOVE -1                     TO  CARRIERL.
  9318     MOVE ER-2230                TO  EMI-ERROR.
  9319     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9320     GO TO 8200-SEND-DATAONLY.
  9321
  9322 6090-EXIT.
  9323      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 169
* EL677.cbl
  9325 6100-VERIFY-CERTIFICATE.
  9326
  9327* EXEC CICS HANDLE CONDITION
  9328*        NOTFND   (6170-NO-CERTIFICATE)
  9329*    END-EXEC.
  9330*    MOVE '"$I                   ! 0 #00008555' TO DFHEIV0
  9331     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9332     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9333     MOVE X'3020233030303038353535' TO DFHEIV0(25:11)
  9334     CALL 'kxdfhei1' USING DFHEIV0
  9335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9336
  9337
  9338     MOVE PI-COMPANY-CD          TO  ELCERT-COMPANY-CD.
  9339     MOVE PI-CARRIER             TO  ELCERT-CARRIER.
  9340     MOVE PI-GROUPING            TO  ELCERT-GROUPING.
  9341     MOVE PI-STATE               TO  ELCERT-STATE.
  9342     MOVE PI-ACCOUNT             TO  ELCERT-ACCOUNT.
  9343     MOVE PI-CERT-PRIME          TO  ELCERT-CERT-PRIME.
  9344     MOVE PI-CERT-SFX            TO  ELCERT-CERT-SFX.
  9345     MOVE PI-CERT-EFF-DT         TO  ELCERT-CERT-EFF-DT.
  9346
  9347     MOVE 'N'                    TO  WS-CERT-FOUND-SW.
  9348
  9349     MOVE SPACES                 TO  PI-REFERENCE
  9350*                                    PI-INSURED-NAME.
  9351     MOVE LOW-VALUES             TO  PI-CANC-DT.
  9352*    MOVE ZEROS                  TO  PI-LF-REFUND
  9353*                                    PI-AH-REFUND.
  9354
  9355
  9356* EXEC CICS READ
  9357*         DATASET   (ELCERT-FILE-ID)
  9358*         SET       (ADDRESS OF CERTIFICATE-MASTER)
  9359*         RIDFLD    (ELCERT-KEY)
  9360*     END-EXEC.
  9361*    MOVE '&"S        E          (   #00008576' TO DFHEIV0
  9362     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9363     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9364     MOVE X'2020233030303038353736' TO DFHEIV0(25:11)
  9365     CALL 'kxdfhei1' USING DFHEIV0,
  9366           ELCERT-FILE-ID,
  9367           DFHEIV20,
  9368           DFHEIV99,
  9369           ELCERT-KEY,
  9370           DFHEIV99,
  9371           DFHEIV99,
  9372           DFHEIV99
  9373     SET ADDRESS OF CERTIFICATE-MASTER TO
  9374         DFHEIV20
  9375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9376
  9377
  9378     MOVE 'Y'                    TO  WS-CERT-FOUND-SW.
  9379
  9380*    MOVE CM-LF-ITD-CANCEL-AMT   TO  PI-LF-REFUND.
  9381*    MOVE CM-AH-ITD-CANCEL-AMT   TO  PI-AH-REFUND.
  9382     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 170
* EL677.cbl
  9383         MOVE CM-LF-CANCEL-DT    TO  PI-CANC-DT
  9384     ELSE
  9385         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  9386             MOVE CM-AH-CANCEL-DT TO PI-CANC-DT.
  9387*    MOVE CM-INSURED-LAST-NAME   TO  PI-INSURED-NAME.
  9388
  9389     GO TO 6190-EXIT.
  9390
  9391 6170-NO-CERTIFICATE.
  9392     MOVE -1                     TO  CARRIERL.
  9393     MOVE ER-2726                TO  EMI-ERROR.
  9394     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9395
  9396 6190-EXIT.
  9397      EXIT.
  9398
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 171
* EL677.cbl
  9400 6200-UPDATE-PENDING-BUS-REC.
  9401     MOVE PI-COMPANY-CD          TO  ERPNDB-ALT-COMPANY-CD.
  9402     MOVE PI-CARRIER             TO  ERPNDB-ALT-CARRIER.
  9403     MOVE PI-GROUPING            TO  ERPNDB-ALT-GROUPING.
  9404     MOVE PI-STATE               TO  ERPNDB-ALT-STATE.
  9405     MOVE PI-ACCOUNT             TO  ERPNDB-ALT-ACCOUNT.
  9406     MOVE PI-CERT-PRIME          TO  ERPNDB-ALT-CERT-PRIME.
  9407     MOVE PI-CERT-SFX            TO  ERPNDB-ALT-CERT-SFX.
  9408     MOVE PI-CERT-EFF-DT         TO  ERPNDB-ALT-CERT-EFF-DT.
  9409     MOVE ZEROS                  TO  ERPNDB-ALT-CH-SEQ-NO.
  9410     MOVE '2'                    TO  ERPNDB-ALT-RECORD-TYPE.
  9411
  9412     IF ST-ACCNT-CNTL  OR
  9413        ACCNT-CNTL
  9414          MOVE SPACES             TO  ERPNDB-ALT-CARRIER.
  9415
  9416     IF ST-ACCNT-CNTL      OR
  9417        CARR-ST-ACCNT-CNTL OR
  9418        ACCNT-CNTL         OR
  9419        CARR-ACCNT-CNTL
  9420          MOVE SPACES             TO  ERPNDB-ALT-GROUPING.
  9421
  9422     IF ACCNT-CNTL OR
  9423        CARR-ACCNT-CNTL
  9424          MOVE SPACES             TO  ERPNDB-ALT-STATE.
  9425
  9426
  9427* EXEC CICS READ
  9428*         DATASET   (ERPNDB-ALT-FILE-ID)
  9429*         SET       (ADDRESS OF PENDING-BUSINESS)
  9430*         RIDFLD    (ERPNDB-ALT-KEY)
  9431*         resp      (ws-response)
  9432*     END-EXEC.
  9433*    MOVE '&"S        E          (  N#00008630' TO DFHEIV0
  9434     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9435     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9436     MOVE X'204E233030303038363330' TO DFHEIV0(25:11)
  9437     CALL 'kxdfhei1' USING DFHEIV0,
  9438           ERPNDB-ALT-FILE-ID,
  9439           DFHEIV20,
  9440           DFHEIV99,
  9441           ERPNDB-ALT-KEY,
  9442           DFHEIV99,
  9443           DFHEIV99,
  9444           DFHEIV99
  9445     SET ADDRESS OF PENDING-BUSINESS TO
  9446         DFHEIV20
  9447     MOVE EIBRESP  TO ws-response
  9448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9449
  9450
  9451     if not resp-normal
  9452        go to 6200-exit
  9453     end-if
  9454     MOVE PB-CONTROL-PRIMARY     TO  ERPNDB-PRIMARY-KEY.
  9455
  9456
  9457* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 172
* EL677.cbl
  9458*         DATASET   (ERPNDB-FILE-ID)
  9459*         SET       (ADDRESS OF PENDING-BUSINESS)
  9460*         RIDFLD    (ERPNDB-PRIMARY-KEY)
  9461*         UPDATE
  9462*         resp      (ws-response)
  9463*     END-EXEC.
  9464*    MOVE '&"S        EU         (  N#00008642' TO DFHEIV0
  9465     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9466     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9467     MOVE X'204E233030303038363432' TO DFHEIV0(25:11)
  9468     CALL 'kxdfhei1' USING DFHEIV0,
  9469           ERPNDB-FILE-ID,
  9470           DFHEIV20,
  9471           DFHEIV99,
  9472           ERPNDB-PRIMARY-KEY,
  9473           DFHEIV99,
  9474           DFHEIV99,
  9475           DFHEIV99
  9476     SET ADDRESS OF PENDING-BUSINESS TO
  9477         DFHEIV20
  9478     MOVE EIBRESP  TO ws-response
  9479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9480
  9481
  9482 6200-EXIT.
  9483      EXIT.
  9484 6210-rewrite-pndb.
  9485
  9486* EXEC CICS REWRITE
  9487*        DATASET  (ERPNDB-FILE-ID)
  9488*        FROM     (PENDING-BUSINESS)
  9489*    END-EXEC
  9490     MOVE LENGTH OF
  9491      PENDING-BUSINESS
  9492       TO DFHEIV11
  9493*    MOVE '&& L                  %   #00008653' TO DFHEIV0
  9494     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9495     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9496     MOVE X'2020233030303038363533' TO DFHEIV0(25:11)
  9497     CALL 'kxdfhei1' USING DFHEIV0,
  9498           ERPNDB-FILE-ID,
  9499           PENDING-BUSINESS,
  9500           DFHEIV11,
  9501           DFHEIV99
  9502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9503     .
  9504 6210-exit.
  9505     exit.
  9506 6300-BUILD-CERT-SCREEN.
  9507*    move 'N'                    to dedcyni
  9508*                                   pi-prev-ded-comm
  9509     MOVE LOW-VALUES             TO  EL677AI.
  9510     perform 6700-build-common   thru 6700-exit
  9511     if ws-refund-amount = zeros
  9512        move pi-company-cd       to pi-chek-comp-cd
  9513        move pi-carrier          to pi-chek-carrier
  9514        move pi-grouping         to pi-chek-grouping
  9515        move pi-state            to pi-chek-state
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 173
* EL677.cbl
  9516        move pi-account          to pi-chek-account
  9517        move pi-cert-eff-dt      to pi-chek-eff-dt
  9518        move pi-cert-prime       to pi-chek-cert-no
  9519        move pi-cert-sfx         to pi-chek-suf-no
  9520        move +1                  to pi-chek-sequence
  9521             MOVE 'S'            TO MAINTI
  9522             MOVE 1              TO MAINTL
  9523             MOVE AL-UABON       TO MAINTA
  9524             MOVE DFHENTER       TO EIBAID
  9525        go to 5000-browse-file
  9526     end-if
  9527     IF WS-CERT-NOT-FOUND
  9528         GO TO 8100-SEND-INITIAL-MAP.
  9529
  9530*    IF WS-PNDB-FOUND
  9531*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9532*                                   PB-C-AH-CANCEL-AMT
  9533*        MOVE 'R'                TO  TYPEO
  9534*        IF PI-AR-PROCESSING
  9535*            MOVE AL-UANON       TO  REFA
  9536*            MOVE PB-C-REFERENCE TO  REFO
  9537*        END-IF
  9538*    ELSE
  9539*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9540*                                   CM-AH-ITD-CANCEL-AMT.
  9541     MOVE WS-REFUND-AMOUNT        TO AMOUNTO
  9542     MOVE pi-check-type           TO TYPEO
  9543
  9544     IF PI-COMPANY-ID = 'TMS'
  9545         MOVE WS-NAME-WORK         TO PAYTO1I
  9546                                      PI-PAYTO1
  9547         MOVE AL-UANON             TO PAYTO1A
  9548     ELSE
  9549         MOVE WS-NAME-WORK         TO PAYTO1I
  9550                                      PI-PAYTO1
  9551         MOVE AL-UANON             TO PAYTO1A.
  9552
  9553*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9554*    MOVE AL-UANON                 TO PAYTO1AA.
  9555     move 'N'                    to dedcyni
  9556     move al-uanon               to dedcyna
  9557     move 'INS'                  to payeeo
  9558     move al-panon               to payeea
  9559     IF PI-MAIL-YES
  9560         PERFORM 6400-MAILING-ADDRESS THRU 6490-EXIT.
  9561
  9562     GO TO 8100-SEND-INITIAL-MAP.
  9563
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 174
* EL677.cbl
  9565
  9566 6400-MAILING-ADDRESS.
  9567
  9568* EXEC CICS HANDLE CONDITION
  9569*        NOTFND   (6470-NO-ADDRESS)
  9570*    END-EXEC.
  9571*    MOVE '"$I                   ! 1 #00008721' TO DFHEIV0
  9572     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9573     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9574     MOVE X'3120233030303038373231' TO DFHEIV0(25:11)
  9575     CALL 'kxdfhei1' USING DFHEIV0
  9576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9577
  9578
  9579
  9580* EXEC CICS READ
  9581*        DATASET   (ERMAIL-FILE-ID)
  9582*        SET       (ADDRESS OF MAILING-DATA)
  9583*        RIDFLD    (ELCERT-KEY)
  9584*    END-EXEC.
  9585*    MOVE '&"S        E          (   #00008725' TO DFHEIV0
  9586     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9587     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9588     MOVE X'2020233030303038373235' TO DFHEIV0(25:11)
  9589     CALL 'kxdfhei1' USING DFHEIV0,
  9590           ERMAIL-FILE-ID,
  9591           DFHEIV20,
  9592           DFHEIV99,
  9593           ELCERT-KEY,
  9594           DFHEIV99,
  9595           DFHEIV99,
  9596           DFHEIV99
  9597     SET ADDRESS OF MAILING-DATA TO
  9598         DFHEIV20
  9599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9600
  9601
  9602     MOVE MA-ADDRESS-LINE-1      TO PAYAD1I.
  9603     MOVE MA-ADDRESS-LINE-2      TO PAYAD2I.
  9604     move ma-city                to payctyi
  9605     move ma-addr-state          to paysti
  9606     MOVE MA-ZIP                 TO PTOZIPI.
  9607     MOVE AL-UANON               TO PAYAD1A
  9608                                    PAYAD2A
  9609                                    PAYctyA
  9610                                    paysta
  9611                                    PTOZIPA.
  9612
  9613     GO TO 6490-EXIT.
  9614
  9615 6470-NO-ADDRESS.
  9616     MOVE -1                     TO  PAYAD1L.
  9617     MOVE ER-2394                TO  EMI-ERROR.
  9618     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9619
  9620 6490-EXIT.
  9621      EXIT.
  9622
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 175
* EL677.cbl
  9624
  9625 6500-BUILD-ACCOUNT-SCREEN.
  9626     MOVE LOW-VALUES             TO  EL677AI.
  9627     perform 6700-build-common   thru 6700-exit
  9628     MOVE WS-REFUND-AMOUNT       TO AMOUNTO
  9629     MOVE PI-AM-NAME             TO PAYTO1I
  9630     MOVE SPACES                 TO PAYTO2I
  9631     MOVE PI-AM-ADDRS            TO PAYAD1I.
  9632     MOVE PI-AM-CITY             TO PAYCTYI
  9633     move pi-am-st               to paysti
  9634     MOVE PI-AM-ZIP-CODE         TO PTOZIPI
  9635     move 'ACCT'                 to payeeo
  9636     move al-panon               to payeea
  9637     MOVE AL-UANON               TO PAYTO1A
  9638                                    PAYTO2A
  9639                                    PAYAD1A
  9640                                    PAYCTYA
  9641                                    paysta
  9642                                    PTOZIPA
  9643     GO TO 8100-SEND-INITIAL-MAP
  9644     .
  9645 6600-BUILD-BENEFICIARY-SCREEN.
  9646     MOVE LOW-VALUES             TO  EL677AI.
  9647     perform 6700-build-common   thru 6700-exit
  9648     IF WS-CERT-NOT-FOUND
  9649         GO TO 8100-SEND-INITIAL-MAP.
  9650
  9651*    IF WS-PNDB-FOUND
  9652*        COMPUTE WS-REFUND-AMOUNT = PB-C-LF-CANCEL-AMT +
  9653*                                   PB-C-AH-CANCEL-AMT
  9654*        MOVE 'R'                TO  TYPEO
  9655*        IF PI-AR-PROCESSING
  9656*            MOVE AL-UANON       TO  REFA
  9657*            MOVE PB-C-REFERENCE TO  REFO
  9658*        END-IF
  9659*    ELSE
  9660*        COMPUTE WS-REFUND-AMOUNT = CM-LF-ITD-CANCEL-AMT +
  9661*                                   CM-AH-ITD-CANCEL-AMT.
  9662
  9663     MOVE WS-REFUND-AMOUNT        TO  AMOUNTO.
  9664     MOVE pi-check-type           TO  TYPEO.
  9665
  9666     IF PI-COMPANY-ID = 'TMS'
  9667         MOVE WS-NAME-WORK         TO PAYTO1I
  9668                                      PI-PAYTO1
  9669         MOVE AL-UANON             TO PAYTO1A
  9670     ELSE
  9671         MOVE WS-NAME-WORK         TO PAYTO1I
  9672                                      PI-PAYTO1
  9673         MOVE AL-UANON             TO PAYTO1A.
  9674
  9675*    MOVE CM-BENEFICIARY           TO PAYTO1AI.
  9676*    MOVE AL-UANON                 TO PAYTO1AA.
  9677
  9678     move 'N'                    to dedcyni
  9679     move al-uanon               to dedcyna
  9680     move 'BENE'                 to payeeo
  9681     move al-panon               to payeea
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 176
* EL677.cbl
  9682     IF PI-MAIL-YES
  9683         PERFORM 6620-MAILING-ADDRESS THRU 6690-EXIT.
  9684
  9685     GO TO 8100-SEND-INITIAL-MAP.
  9686
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 177
* EL677.cbl
  9688
  9689 6620-MAILING-ADDRESS.
  9690
  9691* EXEC CICS HANDLE CONDITION
  9692*        NOTFND   (6670-NO-beneficiary)
  9693*    END-EXEC.
  9694*    MOVE '"$I                   ! 2 #00008819' TO DFHEIV0
  9695     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9696     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9697     MOVE X'3220233030303038383139' TO DFHEIV0(25:11)
  9698     CALL 'kxdfhei1' USING DFHEIV0
  9699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9700
  9701
  9702
  9703* EXEC CICS READ
  9704*        DATASET   (ERMAIL-FILE-ID)
  9705*        SET       (ADDRESS OF MAILING-DATA)
  9706*        RIDFLD    (ELCERT-KEY)
  9707*    END-EXEC.
  9708*    MOVE '&"S        E          (   #00008823' TO DFHEIV0
  9709     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9710     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9711     MOVE X'2020233030303038383233' TO DFHEIV0(25:11)
  9712     CALL 'kxdfhei1' USING DFHEIV0,
  9713           ERMAIL-FILE-ID,
  9714           DFHEIV20,
  9715           DFHEIV99,
  9716           ELCERT-KEY,
  9717           DFHEIV99,
  9718           DFHEIV99,
  9719           DFHEIV99
  9720     SET ADDRESS OF MAILING-DATA TO
  9721         DFHEIV20
  9722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9723
  9724
  9725     move spaces                 to payto2i
  9726     move ma-cred-bene-name      to payto1i
  9727     MOVE MA-cred-bene-addr      TO PAYad1I.
  9728     MOVE MA-cred-bene-addr2     TO PAYad2I.
  9729     move ma-cred-bene-city      to payctyi
  9730     move ma-cred-bene-state     to paysti
  9731     MOVE MA-cred-bene-zip       TO PTOZIPI.
  9732     MOVE AL-UANON               TO payto1a
  9733                                    PAYTO2A
  9734                                    PAYad1A
  9735                                    payad2a
  9736                                    PAYctyA
  9737                                    paysta
  9738                                    PTOZIPA.
  9739
  9740     GO TO 6690-EXIT.
  9741
  9742 6670-NO-BENEFICIARY.
  9743     MOVE -1                     TO  PAYTO1L.
  9744     MOVE ER-2394                TO  EMI-ERROR.
  9745     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 178
* EL677.cbl
  9746
  9747 6690-EXIT.
  9748      EXIT.
  9749 6700-build-common.
  9750     if not eracct-found
  9751        move pi-company-cd       to eracct-co
  9752        move pi-carrier          to eracct-carrier
  9753        move pi-grouping         to eracct-grouping
  9754        move pi-state            to eracct-state
  9755        move pi-account          to eracct-account
  9756        move pi-cert-eff-dt      to eracct-exp-date
  9757        perform 1420-get-eracct  thru 1490-exit
  9758     end-if
  9759*    if WS-PNDB-NOT-FOUND
  9760*       perform 5600-get-erpndb thru 5600-exit
  9761*    end-if
  9762*    MOVE LOW-VALUES             TO  EL677AI.
  9763     MOVE 'A'                    TO  MAINTI.
  9764     MOVE AL-UANON               TO  MAINTA.
  9765     MOVE +1                     TO  MAINTL.
  9766     MOVE PI-CARRIER             TO  CARRIERO.
  9767     MOVE PI-GROUPING            TO  GROUPO.
  9768     MOVE PI-STATE               TO  STATEO.
  9769     MOVE PI-ACCOUNT             TO  ACCTO.
  9770     MOVE PI-CERT-PRIME          TO  CERTNOO.
  9771     MOVE PI-CERT-SFX            TO  SFXO.
  9772     MOVE PI-AMOUNT              TO  AMOUNTO.
  9773*    MOVE PI-TYPE                TO  TYPEO.
  9774     move pi-check-type          to  typeo
  9775     move pi-return-to           to  rettoo
  9776*    MOVE PI-REFERENCE           TO  REFO.
  9777     MOVE PI-PAYTO1              TO  PAYTO1O.
  9778     MOVE AL-UANON               TO  CARRIERA
  9779                                     GROUPA
  9780                                     STATEA
  9781                                     ACCTA
  9782                                     CERTNOA
  9783                                     SFXA
  9784                                     PAYTO1A
  9785                                     PAYTO2A
  9786*                                    AMOUNTA
  9787*                                    TYPEA
  9788                                     rettoa
  9789                                     payeea.
  9790     move al-panon               to typea
  9791     move al-panon               to amounta
  9792     MOVE PI-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  9793     MOVE ' '                    TO  DC-OPTION-CODE.
  9794     PERFORM 8500-DATE-CONVERT.
  9795     IF NO-CONVERSION-ERROR
  9796         MOVE DC-GREG-DATE-1-EDIT TO  EFFDTI
  9797         MOVE AL-UANON            TO  EFFDTA
  9798         MOVE 'Y'                 TO  PI-PROCESS-CERT-SW
  9799         PERFORM 6100-VERIFY-CERTIFICATE THRU 6190-EXIT
  9800     ELSE
  9801         GO TO 8200-SEND-DATAONLY.
  9802     IF CM-INSURED-FIRST-NAME GREATER SPACES
  9803         MOVE CM-INSURED-FIRST-NAME  TO  WS-INSURED-1ST-NAME
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 179
* EL677.cbl
  9804         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT
  9805     ELSE
  9806         MOVE CM-INSURED-INITIAL1    TO  WS-INSURED-1ST-NAME
  9807         MOVE CM-INSURED-INITIAL2    TO  WS-INSURED-MID-INIT.
  9808     MOVE CM-INSURED-LAST-NAME       TO  WS-INSURED-LAST-NAME.
  9809     PERFORM 5200-MOVE-NAME THRU 5200-EXIT.
  9810     move spaces to pi-insured-name
  9811     string cm-insured-last-name ' '
  9812            cm-insured-first-name delimited by '  '
  9813        into pi-insured-name
  9814     end-string
  9815     move spaces                 to pi-table-name
  9816     string cm-insured-last-name ', '
  9817            cm-insured-first-name ' '
  9818            cm-insured-initial2
  9819        delimited by '  '
  9820        into
  9821           pi-table-name
  9822     end-string
  9823*    MOVE WS-NAME-WORK           TO PI-INSURED-NAME.
  9824     if eibaid = dfhpf5
  9825        move 'Y'                 to dedcyni
  9826        move al-uanon            to dedcyna
  9827     end-if
  9828    compute ws-tot-lf-prem = cm-lf-premium-amt +
  9829       cm-lf-alt-premium-amt
  9830    compute ws-tot-iss-prem  =
  9831       cm-ah-premium-amt + ws-tot-lf-prem
  9832    compute ws-tot-iss-comm =
  9833       (ws-tot-lf-prem * cm-life-comm-pct) +
  9834       (cm-ah-premium-amt * cm-ah-comm-pct)
  9835    compute ws-tot-ref-comm =
  9836       (pi-lf-refund * cm-life-comm-pct) +
  9837       (pi-ah-refund * cm-ah-comm-pct)
  9838     move ws-tot-iss-prem        to premo
  9839     move ws-tot-iss-comm        to isscommo
  9840     move al-sadof               to drefa
  9841                                    refa
  9842*    compute refo = pi-lf-refund + pi-ah-refund
  9843     move pi-prev-paid            to prepdo
  9844     move ws-tot-ref-comm         to uecommo
  9845                                     pi-ue-comm
  9846***  compute ws-refund-amount = pi-refund-on-pending-rec -
  9847***     pi-prev-paid
  9848     compute ws-refund-amount =
  9849        pi-refund-on-pending-rec - pi-prev-paid-this-month
  9850     if (pi-refund-on-pending-rec + pi-prev-paid) >
  9851        ws-tot-iss-prem
  9852        move zeros               to ws-refund-amount
  9853     end-if
  9854     if ((dedcyni = 'Y')
  9855        or (pi-prev-ded-comm = 'Y'))
  9856        and (ws-refund-amount >= ws-tot-ref-comm)
  9857        compute ws-refund-amount = ws-refund-amount -
  9858           ws-tot-ref-comm
  9859     end-if
  9860     if pi-check-type = 'C'
  9861*       move pi-endt-prm-diff    to refo
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 180
* EL677.cbl
  9862        move pi-endt-com-diff    to uecommo
  9863                                    pi-ue-comm
  9864        compute ws-refund-amount =
  9865           pi-endt-prm-diff - pi-prev-paid
  9866        if (dedcyni = 'Y')
  9867           or (pi-prev-ded-comm = 'Y')
  9868           compute ws-refund-amount = ws-refund-amount -
  9869              pi-endt-com-diff
  9870        end-if
  9871        if ws-refund-amount <= zeros
  9872           move pi-endt-prm-diff to ws-refund-amount
  9873        end-if
  9874     end-if
  9875     if not WS-CERT-NOT-FOUND
  9876        string
  9877           pi-cert-prime         ' : '
  9878           cm-insured-last-name  ', '
  9879           cm-insured-first-name ' : '
  9880           pi-account            ' : '
  9881           pi-am-csr delimited by '  ' into text1o
  9882        end-string
  9883        move al-uanon            to text1a
  9884        MOVE 'REF'               TO WS-USER-REASON
  9885        if pi-check-type = 'C'
  9886           move 'COR'            to ws-user-reason
  9887        end-if
  9888        MOVE pi-cert-no          TO WS-USER-CERT-NO
  9889        inspect ws-user-cert-no replacing leading zeros
  9890           by spaces
  9891        move pi-insured-name     to ws-user-name
  9892        perform varying s1 from +1 by +1 until
  9893           (s1 > +11)
  9894           or (ws-user-cert-no (s1:1)) <> ' '
  9895        end-perform
  9896        string ws-user-reason  ' ' delimited by size
  9897               ws-user-cert-no (s1:11 - s1 + 1) ' '
  9898                  delimited by size
  9899               cm-insured-last-name ' '
  9900               cm-insured-first-name delimited by '  '
  9901           into stubo
  9902        end-string
  9903        move al-uanon            to stuba
  9904     end-if
  9905     .
  9906 6700-exit.
  9907     exit.
  9908 6800-browse-previous-chek-recs.
  9909***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  9910***                                                            ***
  9911**** this should be the first time through, we need to gather  ***
  9912**** all the erchek records for this pending record, add the   ***
  9913**** amounts and make sure this check request will not exceed  ***
  9914**** the collected premium                                     ***
  9915***                                                            ***
  9916***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  9917     move zeros                  to pi-prev-paid
  9918                                    pi-prev-paid-this-month
  9919                                    ws-browse-sw
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 181
* EL677.cbl
  9920                                    pi-chek-rec-cnt
  9921     move spaces                 to pi-prev-ded-comm
  9922     move pi-company-cd          to chek-company-cd
  9923     move pi-carrier             to chek-carrier
  9924     move pi-grouping            to chek-grouping
  9925     move pi-state               to chek-state
  9926     move pi-account             to chek-account
  9927     move pi-cert-prime          to chek-cert-no
  9928     move pi-cert-sfx            to chek-suf-no
  9929     move pi-cert-eff-dt         to chek-eff-dt
  9930     move +0                     to chek-record-seq
  9931     move erchek-key             to ws-compare-erchek-key
  9932
  9933* EXEC CICS STARTBR
  9934*       DATASET  (ERCHEK-FILE-ID)
  9935*       RIDFLD   (ERCHEK-KEY)
  9936*       resp     (ws-response)
  9937*    END-EXEC
  9938     MOVE 0
  9939       TO DFHEIV11
  9940*    MOVE '&,         G          &  N#00009036' TO DFHEIV0
  9941     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9942     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9943     MOVE X'204E233030303039303336' TO DFHEIV0(25:11)
  9944     CALL 'kxdfhei1' USING DFHEIV0,
  9945           ERCHEK-FILE-ID,
  9946           ERCHEK-KEY,
  9947           DFHEIV99,
  9948           DFHEIV11,
  9949           DFHEIV99
  9950     MOVE EIBRESP  TO ws-response
  9951     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9952     if not resp-normal
  9953        go to 6800-exit
  9954     end-if
  9955     perform until i-say-when
  9956
  9957* EXEC CICS READNEXT
  9958*          DATASET   (ERCHEK-FILE-ID)
  9959*          SET       (ADDRESS OF CHECK-RECORDS)
  9960*          RIDFLD    (ERCHEK-KEY)
  9961*          resp      (ws-response)
  9962*       END-EXEC
  9963     MOVE 0
  9964       TO DFHEIV11
  9965*    MOVE '&.S                   )  N#00009045' TO DFHEIV0
  9966     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9967     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9968     MOVE X'204E233030303039303435' TO DFHEIV0(25:11)
  9969     CALL 'kxdfhei1' USING DFHEIV0,
  9970           ERCHEK-FILE-ID,
  9971           DFHEIV20,
  9972           DFHEIV99,
  9973           ERCHEK-KEY,
  9974           DFHEIV99,
  9975           DFHEIV11,
  9976           DFHEIV99,
  9977           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 182
* EL677.cbl
  9978     SET ADDRESS OF CHECK-RECORDS TO
  9979         DFHEIV20
  9980     MOVE EIBRESP  TO ws-response
  9981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9982        if resp-normal
  9983           and erchek-key (1:33) = ws-compare-erchek-key
  9984           if (ch-void-dt = low-values)
  9985              and (not ch-denied)
  9986              if pi-check-type = 'R'
  9987                 and ch-check-origin-sw = 'C'
  9988                 continue
  9989              else
  9990                 compute pi-prev-paid = pi-prev-paid +
  9991                    ch-amount-paid
  9992                 add +1 to pi-chek-rec-cnt
  9993                 move ch-deduct-commission
  9994                                 to pi-prev-ded-comm
  9995                 if ch-credit-select-dt = pi-cr-month-end-dt
  9996                    compute pi-prev-paid-this-month =
  9997                       pi-prev-paid-this-month + ch-amount-paid
  9998                 end-if
  9999              end-if
 10000           end-if
 10001        else
 10002           set i-say-when to true
 10003        end-if
 10004     end-perform
 10005     .
 10006 6800-exit.
 10007     exit.
 10008 7000-SET-PI-AREA.
 10009     MOVE CARRIERI               TO  PI-CARRIER
 10010                                     PI-CHEK-CARRIER.
 10011     MOVE GROUPI                 TO  PI-GROUPING
 10012                                     PI-CHEK-GROUPING.
 10013     MOVE STATEI                 TO  PI-STATE
 10014                                     PI-CHEK-STATE.
 10015     MOVE ACCTI                  TO  PI-ACCOUNT
 10016                                     PI-CHEK-ACCOUNT.
 10017     MOVE CERTNOI                TO  PI-CERT-PRIME
 10018                                     PI-CHEK-CERT-NO.
 10019     IF SFXI NOT = LOW-VALUES
 10020         MOVE SFXI               TO  PI-CERT-SFX
 10021                                     PI-CHEK-SUF-NO
 10022     ELSE
 10023         MOVE SPACE              TO  PI-CERT-SFX
 10024                                     PI-CHEK-SUF-NO.
 10025
 10026     MOVE EFFDTI                 TO  DC-GREG-DATE-1-EDIT.
 10027     MOVE '2'                    TO  DC-OPTION-CODE.
 10028     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10029     IF DATE-CONVERSION-ERROR
 10030         MOVE ER-0215            TO  EMI-ERROR
 10031         MOVE -1                 TO  EFFDTL
 10032         MOVE AL-UNBON           TO  EFFDTA
 10033         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10034         GO TO 8200-SEND-DATAONLY
 10035     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 183
* EL677.cbl
 10036         MOVE DC-BIN-DATE-1      TO  PI-CERT-EFF-DT
 10037                                     PI-CHEK-EFF-DT.
 10038
 10039 7090-EXIT.
 10040      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 184
* EL677.cbl
 10042 7100-CREATE-TEMP-STORAGE.
 10043     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
 10044
 10045
 10046* EXEC CICS WRITEQ TS
 10047*        QUEUE   (QID)
 10048*        FROM    (PROGRAM-INTERFACE-BLOCK)
 10049*        LENGTH  (PI-COMM-LENGTH)
 10050*    END-EXEC.
 10051*    MOVE '*"     L              ''   #00009114' TO DFHEIV0
 10052     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
 10053     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10054     MOVE X'2020233030303039313134' TO DFHEIV0(25:11)
 10055     CALL 'kxdfhei1' USING DFHEIV0,
 10056           QID,
 10057           PROGRAM-INTERFACE-BLOCK,
 10058           PI-COMM-LENGTH,
 10059           DFHEIV99,
 10060           DFHEIV99,
 10061           DFHEIV99
 10062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10063
 10064
 10065 7100-EXIT.
 10066      EXIT.
 10067
 10068 7200-RECOVER-TEMP-STORAGE.
 10069
 10070* EXEC CICS READQ TS
 10071*        QUEUE   (QID)
 10072*        INTO    (PROGRAM-INTERFACE-BLOCK)
 10073*        LENGTH  (PI-COMM-LENGTH)
 10074*    END-EXEC.
 10075*    MOVE '*$I    L              ''   #00009124' TO DFHEIV0
 10076     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
 10077     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10078     MOVE X'2020233030303039313234' TO DFHEIV0(25:11)
 10079     CALL 'kxdfhei1' USING DFHEIV0,
 10080           QID,
 10081           PROGRAM-INTERFACE-BLOCK,
 10082           PI-COMM-LENGTH,
 10083           DFHEIV99,
 10084           DFHEIV99,
 10085           DFHEIV99
 10086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10087
 10088
 10089     PERFORM 7300-DELETE-TEMP-STORAGE THRU 7300-EXIT.
 10090
 10091 7200-EXIT.
 10092      EXIT.
 10093
 10094 7300-DELETE-TEMP-STORAGE.
 10095
 10096* EXEC CICS HANDLE CONDITION
 10097*        QIDERR  (7300-EXIT)
 10098*    END-EXEC.
 10099*    MOVE '"$N                   ! 3 #00009136' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 185
* EL677.cbl
 10100     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 10101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10102     MOVE X'3320233030303039313336' TO DFHEIV0(25:11)
 10103     CALL 'kxdfhei1' USING DFHEIV0
 10104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10105
 10106
 10107
 10108* EXEC CICS DELETEQ TS
 10109*        QUEUE  (QID)
 10110*    END-EXEC.
 10111*    MOVE '*&                    #   #00009140' TO DFHEIV0
 10112     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 10113     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10114     MOVE X'2020233030303039313430' TO DFHEIV0(25:11)
 10115     CALL 'kxdfhei1' USING DFHEIV0,
 10116           QID,
 10117           DFHEIV99
 10118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10119
 10120
 10121 7300-EXIT.
 10122      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 186
* EL677.cbl
 10124 8035-LETR-NOT-OPEN.
 10125
 10126     MOVE ER-0013                TO EMI-ERROR.
 10127*    MOVE -1                     TO LETTER1L
 10128     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10129     GO TO 8200-SEND-DATAONLY.
 10130
 10131 8035-EXIT.
 10132     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 187
* EL677.cbl
 10134 8100-SEND-INITIAL-MAP.
 10135     MOVE SAVE-DATE              TO  DATEO.
 10136     MOVE EIBTIME                TO  TIME-IN.
 10137     MOVE TIME-OUT               TO  TIMEO.
 10138     MOVE -1                     TO  MAINTL
 10139     move al-uanon               to mainta
 10140     move dedcyni                to pi-previous-deduct-comm
 10141     if PI-TO-EL677-FROM-EL1273
 10142        move al-sadof            to pf357a
 10143                                    pf46a
 10144                                    dprema
 10145                                    dcomma
 10146                                    drefa
 10147                                    duecomma
 10148                                    dprepda
 10149                                    prema
 10150                                    isscomma
 10151                                    refa
 10152                                    uecomma
 10153                                    prepda
 10154                                    dmaint2a
 10155        move ', VOID(V)'         to dmaint1o
 10156     end-if
 10157     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10158     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10159
 10160
 10161* EXEC CICS SEND
 10162*        MAP      (EL677A)
 10163*        MAPSET   (MAPSET-NAME)
 10164*        FROM     (EL677AO)
 10165*        ERASE
 10166*        CURSOR
 10167*    END-EXEC.
 10168     MOVE LENGTH OF
 10169      EL677AO
 10170       TO DFHEIV12
 10171     MOVE -1
 10172       TO DFHEIV11
 10173*    MOVE '8$     CT  E    H L F ,   #00009183' TO DFHEIV0
 10174     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10175     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10176     MOVE X'2020233030303039313833' TO DFHEIV0(25:11)
 10177     CALL 'kxdfhei1' USING DFHEIV0,
 10178           EL677A,
 10179           EL677AO,
 10180           DFHEIV12,
 10181           MAPSET-NAME,
 10182           DFHEIV99,
 10183           DFHEIV99,
 10184           DFHEIV99,
 10185           DFHEIV11,
 10186           DFHEIV99,
 10187           DFHEIV99,
 10188           DFHEIV99
 10189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10190
 10191
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 188
* EL677.cbl
 10192     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 189
* EL677.cbl
 10194 8200-SEND-DATAONLY.
 10195     if connected-to-db
 10196        perform 4300-FINISH-UP-DB thru 4300-exit
 10197     end-if
 10198     MOVE SAVE-DATE              TO  DATEO.
 10199     MOVE EIBTIME                TO  TIME-IN.
 10200     MOVE TIME-OUT               TO  TIMEO.
 10201     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
 10202     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
 10203
 10204
 10205* EXEC CICS SEND
 10206*        MAP     (EL677A)
 10207*        MAPSET  (MAPSET-NAME)
 10208*        FROM    (EL677AO)
 10209*        DATAONLY
 10210*        CURSOR
 10211*    END-EXEC.
 10212     MOVE LENGTH OF
 10213      EL677AO
 10214       TO DFHEIV12
 10215     MOVE -1
 10216       TO DFHEIV11
 10217*    MOVE '8$D    CT       H L F ,   #00009203' TO DFHEIV0
 10218     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10219     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10220     MOVE X'2020233030303039323033' TO DFHEIV0(25:11)
 10221     CALL 'kxdfhei1' USING DFHEIV0,
 10222           EL677A,
 10223           EL677AO,
 10224           DFHEIV12,
 10225           MAPSET-NAME,
 10226           DFHEIV99,
 10227           DFHEIV99,
 10228           DFHEIV99,
 10229           DFHEIV11,
 10230           DFHEIV99,
 10231           DFHEIV99,
 10232           DFHEIV99
 10233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10234
 10235
 10236     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 190
* EL677.cbl
 10238 8300-SEND-TEXT.
 10239
 10240* EXEC CICS SEND TEXT
 10241*        FROM     (LOGOFF-TEXT)
 10242*        LENGTH   (LOGOFF-LENGTH)
 10243*        ERASE
 10244*        FREEKB
 10245*    END-EXEC.
 10246*    MOVE '8&      T  E F  H   F -   #00009214' TO DFHEIV0
 10247     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10248     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10249     MOVE X'2020233030303039323134' TO DFHEIV0(25:11)
 10250     CALL 'kxdfhei1' USING DFHEIV0,
 10251           LOGOFF-TEXT,
 10252           LOGOFF-LENGTH,
 10253           DFHEIV99,
 10254           DFHEIV99,
 10255           DFHEIV99,
 10256           DFHEIV99,
 10257           DFHEIV99,
 10258           DFHEIV99,
 10259           DFHEIV99,
 10260           DFHEIV99,
 10261           DFHEIV99,
 10262           DFHEIV99
 10263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10264
 10265
 10266
 10267* EXEC CICS RETURN
 10268*    END-EXEC.
 10269*    MOVE '.(                    ''   #00009221' TO DFHEIV0
 10270     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10271     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10272     MOVE X'2020233030303039323231' TO DFHEIV0(25:11)
 10273     CALL 'kxdfhei1' USING DFHEIV0,
 10274           DFHEIV99,
 10275           DFHEIV99,
 10276           DFHEIV99,
 10277           DFHEIV99,
 10278           DFHEIV99,
 10279           DFHEIV99
 10280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10281
 10282
 10283 8500-DATE-CONVERT.
 10284     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10285
 10286
 10287* EXEC CICS LINK
 10288*        PROGRAM    (PGM-NAME)
 10289*        COMMAREA   (DATE-CONVERSION-DATA)
 10290*        LENGTH     (DC-COMM-LENGTH)
 10291*    END-EXEC.
 10292*    MOVE '."C                   (   #00009227' TO DFHEIV0
 10293     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10294     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10295     MOVE X'2020233030303039323237' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 191
* EL677.cbl
 10296     CALL 'kxdfhei1' USING DFHEIV0,
 10297           PGM-NAME,
 10298           DATE-CONVERSION-DATA,
 10299           DC-COMM-LENGTH,
 10300           DFHEIV99,
 10301           DFHEIV99,
 10302           DFHEIV99,
 10303           DFHEIV99
 10304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10305
 10306
 10307 8500-EXIT.
 10308      EXIT.
 10309
 10310 8600-DEEDIT.
 10311
 10312* EXEC CICS BIF DEEDIT
 10313*        FIELD   (WS-DEEDIT-FIELD)
 10314*        LENGTH  (10)
 10315*    END-EXEC.
 10316     MOVE 10
 10317       TO DFHEIV11
 10318*    MOVE '@"L                   #   #00009237' TO DFHEIV0
 10319     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10320     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10321     MOVE X'2020233030303039323337' TO DFHEIV0(25:11)
 10322     CALL 'kxdfhei1' USING DFHEIV0,
 10323           WS-DEEDIT-FIELD,
 10324           DFHEIV11
 10325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10326
 10327
 10328 8600-EXIT.
 10329      EXIT.
 10330
 10331 8700-DEEDIT.
 10332
 10333* EXEC CICS BIF DEEDIT
 10334*        FIELD   (WS-DT-DEEDIT-FIELD)
 10335*        LENGTH  (10)
 10336*    END-EXEC.
 10337     MOVE 10
 10338       TO DFHEIV11
 10339*    MOVE '@"L                   #   #00009246' TO DFHEIV0
 10340     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10341     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10342     MOVE X'2020233030303039323436' TO DFHEIV0(25:11)
 10343     CALL 'kxdfhei1' USING DFHEIV0,
 10344           WS-DT-DEEDIT-FIELD,
 10345           DFHEIV11
 10346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10347
 10348
 10349 8700-EXIT.
 10350      EXIT.
 10351
 10352 8800-UNAUTHORIZED-ACCESS.
 10353     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 192
* EL677.cbl
 10354     GO TO 8300-SEND-TEXT.
 10355
 10356 8810-PF23.
 10357     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10358     MOVE XCTL-005               TO  PGM-NAME.
 10359     GO TO 9300-XCTL.
 10360
 10361
 10362 9100-RETURN-TRAN.
 10363     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10364     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10365
 10366* EXEC CICS RETURN
 10367*        TRANSID  (TRANS-ID)
 10368*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 10369*        LENGTH   (PI-COMM-LENGTH)
 10370*    END-EXEC.
 10371*    MOVE '.(CT                  ''   #00009267' TO DFHEIV0
 10372     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10373     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10374     MOVE X'2020233030303039323637' TO DFHEIV0(25:11)
 10375     CALL 'kxdfhei1' USING DFHEIV0,
 10376           TRANS-ID,
 10377           PROGRAM-INTERFACE-BLOCK,
 10378           PI-COMM-LENGTH,
 10379           DFHEIV99,
 10380           DFHEIV99,
 10381           DFHEIV99
 10382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10383
 10384
 10385
 10386* GOBACK.
 10387     MOVE '9%                    "   ' TO DFHEIV0
 10388     MOVE 'EL677' TO DFHEIV1
 10389     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10390     GOBACK.
 10391
 10392 9200-RETURN-MAIN-MENU.
 10393     MOVE XCTL-626               TO  PGM-NAME.
 10394     GO TO 9300-XCTL.
 10395
 10396 9300-XCTL.
 10397
 10398* EXEC CICS XCTL
 10399*        PROGRAM    (PGM-NAME)
 10400*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 10401*        LENGTH     (PI-COMM-LENGTH)
 10402*    END-EXEC.
 10403*    MOVE '.$C                   %   #00009280' TO DFHEIV0
 10404     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10405     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10406     MOVE X'2020233030303039323830' TO DFHEIV0(25:11)
 10407     CALL 'kxdfhei1' USING DFHEIV0,
 10408           PGM-NAME,
 10409           PROGRAM-INTERFACE-BLOCK,
 10410           PI-COMM-LENGTH,
 10411           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 193
* EL677.cbl
 10412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10413
 10414
 10415 9400-CLEAR.
 10416     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10417     MOVE SPACES                 TO  PI-PFKEY.
 10418     GO TO 9300-XCTL.
 10419
 10420 9500-PF12.
 10421     MOVE XCTL-010               TO  PGM-NAME.
 10422     GO TO 9300-XCTL.
 10423
 10424 9600-PGMID-ERROR.
 10425
 10426* EXEC CICS HANDLE CONDITION
 10427*        PGMIDERR    (8300-SEND-TEXT)
 10428*    END-EXEC.
 10429*    MOVE '"$L                   ! 4 #00009296' TO DFHEIV0
 10430     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10431     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10432     MOVE X'3420233030303039323936' TO DFHEIV0(25:11)
 10433     CALL 'kxdfhei1' USING DFHEIV0
 10434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10435
 10436
 10437     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10438     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10439     MOVE XCTL-005               TO  PGM-NAME.
 10440     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10441     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10442
 10443     GO TO 9300-XCTL.
 10444
 10445 9900-ERROR-FORMAT.
 10446     IF NOT EMI-ERRORS-COMPLETE
 10447         MOVE LINK-001           TO  PGM-NAME
 10448
 10449* EXEC CICS LINK
 10450*            PROGRAM    (PGM-NAME)
 10451*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 10452*            LENGTH     (EMI-COMM-LENGTH)
 10453*        END-EXEC.
 10454*    MOVE '."C                   (   #00009311' TO DFHEIV0
 10455     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10456     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10457     MOVE X'2020233030303039333131' TO DFHEIV0(25:11)
 10458     CALL 'kxdfhei1' USING DFHEIV0,
 10459           PGM-NAME,
 10460           ERROR-MESSAGE-INTERFACE-BLOCK,
 10461           EMI-COMM-LENGTH,
 10462           DFHEIV99,
 10463           DFHEIV99,
 10464           DFHEIV99,
 10465           DFHEIV99
 10466     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10467
 10468
 10469 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 194
* EL677.cbl
 10470      EXIT.
 10471
 10472 9990-ABEND.
 10473     MOVE LINK-004               TO  PGM-NAME.
 10474     MOVE DFHEIBLK               TO  EMI-LINE1.
 10475
 10476* EXEC CICS LINK
 10477*        PROGRAM   (PGM-NAME)
 10478*        COMMAREA  (EMI-LINE1)
 10479*        LENGTH    (72)
 10480*    END-EXEC.
 10481     MOVE 72
 10482       TO DFHEIV11
 10483*    MOVE '."C                   (   #00009323' TO DFHEIV0
 10484     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10485     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10486     MOVE X'2020233030303039333233' TO DFHEIV0(25:11)
 10487     CALL 'kxdfhei1' USING DFHEIV0,
 10488           PGM-NAME,
 10489           EMI-LINE1,
 10490           DFHEIV11,
 10491           DFHEIV99,
 10492           DFHEIV99,
 10493           DFHEIV99,
 10494           DFHEIV99
 10495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10496
 10497
 10498     GO TO 8200-SEND-DATAONLY.
 10499
 10500 9995-SECURITY-VIOLATION.
 10501*                            COPY ELCSCTP.
 10502******************************************************************
 10503*                                                                *
 10504*                            ELCSCTP                             *
 10505*                            VMOD=2.001                          *
 10506*                                                                *
 10507*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10508******************************************************************
 10509
 10510
 10511     MOVE EIBDATE          TO SM-JUL-DATE.
 10512     MOVE EIBTRMID         TO SM-TERMID.
 10513     MOVE THIS-PGM         TO SM-PGM.
 10514     MOVE EIBTIME          TO TIME-IN.
 10515     MOVE TIME-OUT         TO SM-TIME.
 10516     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10517
 10518
 10519* EXEC CICS LINK
 10520*         PROGRAM  ('EL003')
 10521*         COMMAREA (SECURITY-MESSAGE)
 10522*         LENGTH   (80)
 10523*    END-EXEC.
 10524     MOVE 'EL003' TO DFHEIV1
 10525     MOVE 80
 10526       TO DFHEIV11
 10527*    MOVE '."C                   (   #00009349' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 195
* EL677.cbl
 10528     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10529     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10530     MOVE X'2020233030303039333439' TO DFHEIV0(25:11)
 10531     CALL 'kxdfhei1' USING DFHEIV0,
 10532           DFHEIV1,
 10533           SECURITY-MESSAGE,
 10534           DFHEIV11,
 10535           DFHEIV99,
 10536           DFHEIV99,
 10537           DFHEIV99,
 10538           DFHEIV99
 10539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10540
 10541
 10542******************************************************************
 10543
 10544
 10545 9995-EXIT.
 10546     EXIT.
 10547
 10548
 10549 9999-DFHBACK SECTION.
 10550     MOVE '9%                    "   ' TO DFHEIV0
 10551     MOVE 'EL677' TO DFHEIV1
 10552     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10553     GOBACK.
 10554 9999-DFHEXIT.
 10555     IF DFHEIGDJ EQUAL 0001
 10556         NEXT SENTENCE
 10557     ELSE IF DFHEIGDJ EQUAL 2
 10558         GO TO 9600-PGMID-ERROR,
 10559               9990-ABEND
 10560         DEPENDING ON DFHEIGDI
 10561     ELSE IF DFHEIGDJ EQUAL 3
 10562         GO TO 8100-SEND-INITIAL-MAP
 10563         DEPENDING ON DFHEIGDI
 10564     ELSE IF DFHEIGDJ EQUAL 4
 10565         GO TO 1290-NO-CARRIER
 10566         DEPENDING ON DFHEIGDI
 10567     ELSE IF DFHEIGDJ EQUAL 5
 10568         GO TO 1380-NO-STATE
 10569         DEPENDING ON DFHEIGDI
 10570     ELSE IF DFHEIGDJ EQUAL 6
 10571         GO TO 1480-ACCOUNT-INVALID,
 10572               1480-ACCOUNT-INVALID
 10573         DEPENDING ON DFHEIGDI
 10574     ELSE IF DFHEIGDJ EQUAL 7
 10575         GO TO 1590-EXIT
 10576         DEPENDING ON DFHEIGDI
 10577     ELSE IF DFHEIGDJ EQUAL 8
 10578         GO TO 2200-DUPREC
 10579         DEPENDING ON DFHEIGDI
 10580     ELSE IF DFHEIGDJ EQUAL 9
 10581         GO TO 2577-DUPREC
 10582         DEPENDING ON DFHEIGDI
 10583     ELSE IF DFHEIGDJ EQUAL 10
 10584         GO TO 2600-NO-CO-MASTER
 10585         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 25-May-17 11:24 Page 196
* EL677.cbl
 10586     ELSE IF DFHEIGDJ EQUAL 11
 10587         GO TO 3900-RECORD-NOTFND
 10588         DEPENDING ON DFHEIGDI
 10589     ELSE IF DFHEIGDJ EQUAL 12
 10590         GO TO 3287-DUPREC
 10591         DEPENDING ON DFHEIGDI
 10592     ELSE IF DFHEIGDJ EQUAL 13
 10593         GO TO 3390-EXIT,
 10594               3390-EXIT
 10595         DEPENDING ON DFHEIGDI
 10596     ELSE IF DFHEIGDJ EQUAL 14
 10597         GO TO 5560-END-OF-FILE,
 10598               5560-END-OF-FILE
 10599         DEPENDING ON DFHEIGDI
 10600     ELSE IF DFHEIGDJ EQUAL 15
 10601         GO TO 6070-NO-COMP-MSTR
 10602         DEPENDING ON DFHEIGDI
 10603     ELSE IF DFHEIGDJ EQUAL 16
 10604         GO TO 6170-NO-CERTIFICATE
 10605         DEPENDING ON DFHEIGDI
 10606     ELSE IF DFHEIGDJ EQUAL 17
 10607         GO TO 6470-NO-ADDRESS
 10608         DEPENDING ON DFHEIGDI
 10609     ELSE IF DFHEIGDJ EQUAL 18
 10610         GO TO 6670-NO-beneficiary
 10611         DEPENDING ON DFHEIGDI
 10612     ELSE IF DFHEIGDJ EQUAL 19
 10613         GO TO 7300-EXIT
 10614         DEPENDING ON DFHEIGDI
 10615     ELSE IF DFHEIGDJ EQUAL 20
 10616         GO TO 8300-SEND-TEXT
 10617         DEPENDING ON DFHEIGDI.
 10618     MOVE '9%                    "   ' TO DFHEIV0
 10619     MOVE 'EL677' TO DFHEIV1
 10620     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10621     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      142876     Code:       39608
