* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page   1
* EL130.cbl
* Options: int("EL130.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL130.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL130.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL130.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL130 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/18/95 07:28:16.
     7*                            VMOD=2.055.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX19 - NEW CLAIM SETUP
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page   2
* EL130.cbl
    14*
    15******************************************************************
    16*                   C H A N G E   L O G
    17*
    18* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    19*-----------------------------------------------------------------
    20*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    21* EFFECTIVE    NUMBER
    22*-----------------------------------------------------------------
    23* 041002    2002040200004  SMVA  MAKE SURE CLAIM TYPE IS ALWAYS
    24*                               POPULATED -MOVE PI-LAST-CLAIM-TYPE
    25* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYP I
    26* 031405                   PEMA  ADD PROCESSING FOR NEW CLAM TYP G
    27* 050807    2007020800002  AJRA  AUTO POPULATE I1 ADDRESS FROM CER
    28* 071508    2008071000003  AJRA  ADD EDIT FOR SOC SEC NUMBER
    29* 012009    2007042600001  PEMA  RESTRICT CLAIM TYPE FOR CID
    30* 041309    2009031600001  AJRA  ADD VIN TO DIAG FOR BENE 55 AND 5
    31* 100809    2009081800004  AJRA  ADD MSG FOR BENE CD 2O - 2V
    32* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 020513  CR2011090100001  PEMA  FORCE ENTRY OF SEX CODE
    35* 020613    2012092400007  AJRA  ADD CAUSAL STATE MESSAGE
    36* 042413    2013042300001  AJRA  FIX SPECIAL MSG WHEN MULTIPLE CER
    37* 052113    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    38* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    39* 040814    2014030500002  AJRA  ADD ICD CODES
    40* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    41* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    42* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    43* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    44* 101917  CR2017083000003  TANA  ADD CONTRACT CONTESTABLE MSG
    45******************************************************************
    46
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page   3
* EL130.cbl
    48 ENVIRONMENT DIVISION.
    49 DATA DIVISION.
    50 WORKING-STORAGE SECTION.
    51 01  DFH-START PIC X(04).
    52 77  FILLER  PIC X(32)  VALUE '********************************'.
    53 77  FILLER  PIC X(32)  VALUE '*    EL130 WORKING STORAGE     *'.
    54 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.055 **********'.
    55 77  A1                          PIC S999 COMP-3 VALUE +0.
    56 77  E1                          PIC S999 COMP-3 VALUE +0.
    57 77  s1                          pic s999 comp-3 value +0.
    58 77  s2                          pic s999 comp-3 value +0.
    59 77  P1                          PIC S999 COMP-3 VALUE +0.
    60 77  P2                          PIC S999 COMP-3 VALUE +0.
    61 77  WS-CRIT-PER-RECURRENT       PIC 99    VALUE zeros.
    62 77  WS-MAX-BENEFITS             PIC 99    VALUE ZEROS.
    63 77  WS-CRIT-PER-RTW-MOS         PIC 99    VALUE ZEROS.
    64 77  WS-EXCL-PERIOD              PIC S999 COMP-3 VALUE +0.
    65 77  WS-COV-ENDS                 PIC S999 COMP-3 VALUE +0.
    66 77  WS-ACC-PERIOD               PIC S999 COMP-3 VALUE +0.
    67 77  WS-MONTHS-BETWEEN           PIC S999 COMP-3 VALUE +0.
    68 77  WS-ERPDEF-SW                PIC X     VALUE ' '.
    69     88  ERPDEF-FOUND                 VALUE 'Y'.
    70 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    71 77  WS-BENEFITS-PREV-PAID       PIC S9(4)V999 VALUE +0  COMP-3.
    72 77  ws-dcc-product-code         pic xxx value spaces.
    73 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    74 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    75 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    76 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    77 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    78 77  ws-zero-bens-avail          pic x value ' '.
    79*    COPY ELCSCTM.
    80******************************************************************
    81*                                                                *
    82*                                                                *
    83*                            ELCSCTM                             *
    84*                            VMOD=2.001                          *
    85*                                                                *
    86*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    87*                                                                *
    88******************************************************************
    89 01  SECURITY-MESSAGE.
    90     12  FILLER                          PIC X(30)
    91            VALUE '** LOGIC SECURITY VIOLATION -'.
    92     12  SM-READ                         PIC X(6).
    93     12  FILLER                          PIC X(5)
    94            VALUE ' PGM='.
    95     12  SM-PGM                          PIC X(6).
    96     12  FILLER                          PIC X(5)
    97            VALUE ' OPR='.
    98     12  SM-PROCESSOR-ID                 PIC X(4).
    99     12  FILLER                          PIC X(6)
   100            VALUE ' TERM='.
   101     12  SM-TERMID                       PIC X(4).
   102     12  FILLER                          PIC XX   VALUE SPACE.
   103     12  SM-JUL-DATE                     PIC 9(5).
   104     12  FILLER                          PIC X    VALUE SPACE.
   105     12  SM-TIME                         PIC 99.99.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page   4
* EL130.cbl
   106
   107
   108*    COPY ELCSCRTY.
   109******************************************************************
   110*                                                                *
   111*                                                                *
   112*                            ELCSCRTY                            *
   113*                            VMOD=2.001                          *
   114*                                                                *
   115*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   116*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   117*        SAVED IN PI-SECURITY-ADDRESS.                           *
   118*                                                                *
   119******************************************************************
   120 01  SECURITY-CONTROL.
   121     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   122     12  FILLER                       PIC XX    VALUE 'SC'.
   123     12  SC-CREDIT-CODES.
   124         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   125             20  SC-CREDIT-DISPLAY    PIC X.
   126             20  SC-CREDIT-UPDATE     PIC X.
   127     12  SC-CLAIMS-CODES.
   128         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   129             20  SC-CLAIMS-DISPLAY    PIC X.
   130             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page   5
* EL130.cbl
   132 01  WS-DATE-AREA.
   133     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   134     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   135     05  SAVE-SEND-DT        PIC XX      VALUE LOW-VALUES.
   136
   137 01  ws-dcc-error-line.
   138     05  filler occurs 15.
   139         10  ws-error-no        pic x(4).
   140 01  WS-CRI-SSN-WORK-AREA.
   141     05  WS-CRI-SOC-SEC-NO.
   142         10  WS-SS-REPT-CD       PIC X(5).
   143         10  WS-SS-LAST-NAME     PIC X(5).
   144         10  WS-SS-INITIAL       PIC X.
   145
   146     05  WS-CRI-REPORT-CODE.
   147         10  FILLER              PIC X(5).
   148         10  WS-CRI-RPT-CD-MOVE  PIC X(5).
   149
   150     05  WS-CRI-LAST-NAME.
   151         10  WS-CRI-NAME-MOVE    PIC X(5).
   152         10  FILLER              PIC X(10).
   153
   154 01  STANDARD-AREAS.
   155     12  SC-ITEM             PIC S9(4)   VALUE +0001      COMP.
   156     12  GETMAIN-SPACE       PIC X       VALUE SPACES.
   157     12  MAP-NAME            PIC X(8)    VALUE 'EL130A'.
   158     12  MAPSET-NAME         PIC X(8)    VALUE 'EL130S'.
   159     12  TRANS-ID            PIC X(4)    VALUE 'EX19'.
   160     12  START-TRANS-ID      PIC X(4)    VALUE 'EX58'.
   161     12  THIS-PGM            PIC X(8)    VALUE 'EL130'.
   162     12  PGM-NAME            PIC X(8).
   163     12  TIME-IN             PIC S9(7).
   164     12  TIME-OUT-R  REDEFINES TIME-IN.
   165         16  FILLER          PIC X.
   166         16  TIME-OUT        PIC 99V99.
   167         16  FILLER          PIC X(2).
   168     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   169     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   170     12  XCTL-114            PIC X(8)    VALUE 'EL114'.
   171     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   172     12  XCTL-127            PIC X(8)    VALUE 'EL127'.
   173     12  XCTL-727            PIC X(8)    VALUE 'EL727'.
   174     12  XCTL-131            PIC X(8)    VALUE 'EL131'.
   175     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   176     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   177     12  XCTL-150            PIC X(8)    VALUE 'EL150'.
   178     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   179     12  XCTL-650            PIC X(8)    VALUE 'EL650'.
   180     12  XCTL-659            PIC X(8)    VALUE 'EL659'.
   181     12  XCTL-6592           PIC X(8)    VALUE 'EL6592'.
   182     12  XCTL-725            PIC X(8)    VALUE 'EL725'.
   183     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   184     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   185     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   186     12  LINK-ELRTRM         PIC X(8)    VALUE 'ELRTRM'.
   187     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   188     12  ELCNTL-DSID         PIC X(8)    VALUE 'ELCNTL'.
   189     12  ELMSTR-DSID         PIC X(8)    VALUE 'ELMSTR'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page   6
* EL130.cbl
   190     12  ELMSTR5-DSID        PIC X(8)    VALUE 'ELMSTR5'.
   191     12  ELTRLR-DSID         PIC X(8)    VALUE 'ELTRLR'.
   192     12  ERACCT2-DSID        PIC X(8)    VALUE 'ERACCT2'.
   193     12  ELCERT-DSID         PIC X(8)    VALUE 'ELCERT'.
   194     12  ELCERT5-DSID        PIC X(8)    VALUE 'ELCERT5'.
   195     12  ELACTQ-DSID         PIC X(8)    VALUE 'ELACTQ'.
   196     12  ELARCH-DSID         PIC X(8)    VALUE 'ELARCH'.
   197     12  ELBENE-DSID         PIC X(8)    VALUE 'ELBENE'.
   198     12  ERREIN-DSID         PIC X(8)    VALUE 'ERREIN'.
   199     12  DLYACTV-DSID        PIC X(8)    VALUE 'DLYACTV'.
   200     12  ERMAIL-DSID         PIC X(8)    VALUE 'ERMAIL'.
   201     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   202     12  FILE-ID             PIC X(8).
   203     12  DLYACTV-LENGTH      PIC S9(04)    COMP     VALUE +25.
   204     12  ELACTQ-LENGTH       PIC S9(04)    COMP     VALUE +60.
   205     12  ELARCH-LENGTH       PIC S9(04)    COMP     VALUE +90.
   206     12  ELCERT-LENGTH       PIC S9(04)    COMP     VALUE +450.
   207     12  ELMSTR-LENGTH       PIC S9(04)    COMP     VALUE +350.
   208     12  ELTRLR-LENGTH       PIC S9(04)    COMP     VALUE +200.
   209     12  ELMSTR-GENERIC-LENGTH PIC S9(4)   VALUE +9      COMP.
   210     12  ERMAIL-LENGTH       PIC S9(04)    COMP     VALUE +374.
   211     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   212
   213 01  TERM-CALCULATION-WORK-AREA     COMP-3.
   214     12  M                   PIC S9(7)V99           VALUE ZEROS.
   215     12  L                   PIC S9(7)V99           VALUE ZEROS.
   216     12  N                   PIC S9(3)              VALUE ZEROS.
   217     12  N-STORE             PIC S9(3)              VALUE ZEROS.
   218     12  NV-STORE            PIC S9(3)              VALUE ZEROS.
   219     12  I                   PIC S99V9(5)           VALUE ZEROS.
   220     12  A-N                 PIC S9(7)V9(8)         VALUE ZEROS.
   221     12  IA-N                PIC S9(7)V9(8)         VALUE ZEROS.
   222     12  V                   PIC S9(3)V9(14)        VALUE ZEROS.
   223     12  R                   PIC S9(3)              VALUE ZEROS.
   224     12  M1                  PIC S9(7)V99           VALUE ZEROS.
   225     12  V-EX-N              PIC S9(3)V9(14)        VALUE ZEROS.
   226     12  TERM1               PIC S9(8)V9(9)         VALUE ZEROS.
   227     12  TERM2               PIC S9(8)V9(9)         VALUE ZEROS.
   228     12  TERM3               PIC S9(8)V9(9)         VALUE ZEROS.
   229     12  TERM4               PIC S9(3)V9(14)        VALUE ZEROS.
   230     12  LEFT-TOT-1          PIC S9(9)V9(8)         VALUE ZEROS.
   231     12  RIGHT-TOT-1         PIC S9(9)V9(8)         VALUE ZEROS.
   232     12  RIGHT-TOT-2         PIC S9(9)V9(8)         VALUE ZEROS.
   233
   234 01  TERM-CALC-WORK-AREA.
   235     12  WS-AH-RATE          PIC S999V9(5)          VALUE ZEROS.
   236     12  WS-LF-RATE          PIC S999V9(5)          VALUE ZEROS.
   237     12  WS-TERM             PIC S9(3)              VALUE ZEROS.
   238     12  WS-TERM-REM         PIC S9(3)V99           VALUE ZEROS.
   239     12  WS-REMAIN           PIC S99                VALUE ZEROS.
   240     12  V-EXPONENTS.
   241        14  V-EXPONENT       PIC S9(3)V9(14) COMP-3 OCCURS 250.
   242     12  V-EX-ONETIME        PIC 9                  VALUE 1.
   243
   244 01  MISC-WORK-AREAS.
   245     12  SAVE-BENEFICIARY    PIC X(10)   VALUE LOW-VALUES.
   246     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   247     12  CLAIM-SWITCH        PIC X       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page   7
* EL130.cbl
   248     12  QID.
   249         16  QID-TERM        PIC X(4).
   250         16  FILLER          PIC X(4)    VALUE '130A'.
   251     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   252     12  SAVE-AT-PRIMARY-KEY PIC X(22)   VALUE SPACES.
   253     12  WS-GROUP-NO.
   254         16  WS-GROUP-NO-1   PIC X(01)   VALUE SPACES.
   255         16  WS-GROUP-NO-2-6 PIC X(05)   VALUE SPACES.
   256
   257     12  WS-RESPONSE         PIC S9(8)   COMP.
   258         88  WS-RESP-NORMAL              VALUE +00.
   259         88  WS-RESP-ERROR               VALUE +01.
   260         88  WS-RESP-NOTFND              VALUE +13.
   261         88  WS-RESP-DUPKEY              VALUE +15.
   262         88  WS-RESP-NOTOPEN             VALUE +19.
   263         88  WS-RESP-ENDFILE             VALUE +20.
   264
   265***************************************************************
   266*                                                             *
   267*    QID-MAP-LENGTH MUST BE ADJUSTED EVERY TIME THAT ANY      *
   268*    FIELDS ARE ADDED, DELETED, OR THE SIZE OF ANY FIELD      *
   269*    CHANGES WITH IN MAP EL130A.                              *
   270*                                                             *
   271***************************************************************
   272
   273     12  QID-MAP-LENGTH            PIC S9(4) VALUE +1084 COMP.
   274     12  WS-SAVE-CLAIM-MASTER.
   275         16  FILLER                    PIC XX.
   276         16  WS-SAVE-CLAIM-KEY.
   277             20  WS-SAVE-COMPANY-CD    PIC X.
   278             20  WS-SAVE-CARRIER       PIC X.
   279             20  WS-SAVE-CLAIM-NO      PIC X(7).
   280             20  WS-SAVE-CERT-NO       PIC X(11).
   281         16  FILLER                    PIC X(328).
   282     12  SAVE-CURRENT-DATE         PIC XX.
   283     12  SAVE-CONTROL              PIC X(39).
   284     12  SAVE-ERACCT-KEY           PIC X(26).
   285     12  SAVE-COUNTER              PIC S9(8)   COMP.
   286     12  SAVE-METHOD               PIC X.
   287     12  SAVE-COMPANY-ID           PIC XXX.
   288     12  SAVE-COMPANY-CD           PIC X.
   289     12  SAVE-JOURNAL-FILE-ID      PIC S9(4)   COMP.
   290     12  SAVE-CREDIT-USER          PIC X.
   291     12  SAVE-CLAIM-USER           PIC X.
   292     12  SAVE-LIFE-OVERRIDE-L1     PIC X.
   293     12  SAVE-LIFE-OVERRIDE-L2     PIC XX.
   294     12  SAVE-LIFE-OVERRIDE-L6     PIC X(6).
   295     12  SAVE-LIFE-OVERRIDE-L12    PIC X(12).
   296     12  SAVE-AH-OVERRIDE-L1       PIC X.
   297     12  SAVE-AH-OVERRIDE-L2       PIC XX.
   298     12  SAVE-AH-OVERRIDE-L6       PIC X(6).
   299     12  SAVE-AH-OVERRIDE-L12      PIC X(12).
   300     12  FILLER                    PIC X.
   301*    12  SAVE-CLAIM-ACCESS-CONTROL PIC X.
   302     12  SAVE-CERT-ACCESS-CONTROL  PIC X.
   303     12  SAVE-CARRIER-CONTROL-LEVEL    PIC X.
   304     12  SAVE-EL127-TO-EL130-CNTRL.
   305         16  SAVE-CERT-SELECT-CNT    PIC S9(04) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page   8
* EL130.cbl
   306         16  SAVE-CERT-PROCESSED     PIC S9(04) COMP.
   307         16  SAVE-CERT-CONTROLS-EL127 OCCURS 5 TIMES.
   308             20  SAVE-EL127-CARRIER  PIC X.
   309             20  SAVE-EL127-GROUPING PIC X(6).
   310             20  SAVE-EL127-STATE    PIC X(2).
   311             20  SAVE-EL127-ACCOUNT  PIC X(10).
   312             20  SAVE-EL127-CERT-NO  PIC X(11).
   313             20  SAVE-EL127-EFF-DT   PIC XX.
   314     12  SAVE-EL659-TO-EL130-CNTRL.
   315         16  SAVE-EL659-CARRIER    PIC X.
   316         16  SAVE-EL659-GROUPING   PIC X(6).
   317         16  SAVE-EL659-STATE      PIC XX.
   318         16  SAVE-EL659-ACCOUNT    PIC X(10).
   319     12  DIVIDE-QUOT               PIC 999.
   320     12  DIVIDE-REM                PIC 999.
   321     12  WS-CURRENT-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   322     12  WS-ITD-ADDITIONAL-RESERVE PIC S9(5)V99 COMP-3.
   323     12  WS-ITD-PAID-EXPENSE       PIC S9(3)V99 COMP-3.
   324     12  WS-ITD-CHARGABLE-EXPENSE  PIC S9(5)V99 COMP-3.
   325     12  WS-INITIAL-MANUAL-RESERVE PIC S9(5)V99 COMP-3.
   326     12  WS-RESERVE-CONTROLS       PIC X(9).
   327     12  WS-EXPENSE-CONTROLS       PIC X(7).
   328     12  WS-REIN-TABLE.
   329         16  WS-REIN-1             PIC X            VALUE SPACE.
   330         16  WS-REIN-2             PIC X            VALUE SPACE.
   331         16  WS-REIN-3             PIC X            VALUE SPACE.
   332     12  WS-BENE-CALC-METHOD       PIC X.
   333     12  ws-lf-joint-indicator     pic x.
   334     12  ws-ah-joint-indicator     pic x.
   335     12  WS-EARNINGS-CALC          PIC X.
   336     12  WS-LF-EARNINGS-CALC       PIC X.
   337         88 TEX-REG                VALUE '4'.
   338         88 NET-PAY                VALUE '5'.
   339     12  WS-AH-EARNINGS-CALC       PIC X.
   340     12  WS-SPECIAL-CALC-CD        PIC X(01).
   341     12  WS-LF-SPECIAL-CALC-CD     PIC X(01).
   342     12  WS-AH-SPECIAL-CALC-CD     PIC X(01).
   343     12  WS-DIAGNOSIS-DESCRIPT     PIC X(60).
   344     12  WS-ICD-CODE-1             PIC X(8).
   345     12  WS-ICD-CODE-2             PIC X(8).
   346     12  WS-CLAIM-NUMBER.
   347         16  WS-CN-PREFIX.
   348             20  WS-CN-PRF-A PIC X.
   349             20  WS-CN-PRF-B PIC X.
   350         16  WS-CN-NUMBER    PIC 9(5).
   351     12  WS-CLAIM-NUMBER-R1 REDEFINES WS-CLAIM-NUMBER PIC 9(7).
   352     12  WS-CLAIM-SEQU.
   353         16  FILLER          PIC X    VALUE '('.
   354         16  WS-CURRENT-SEQU PIC Z9.
   355         16  FILLER          PIC X(4) VALUE ' OF '.
   356         16  WS-OF-SEQU      PIC Z9.
   357         16  FILLER          PIC X    VALUE ')'.
   358     12  DATE-WORK.
   359       14  FILLER                PIC XX.
   360       14  DATE-MM               PIC XX.
   361       14  DATE-DD               PIC XX.
   362       14  DATE-YY               PIC XX.
   363     12  CURR-DATE REDEFINES DATE-WORK.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page   9
* EL130.cbl
   364         16  CURR-MM.
   365           18  CURR-M1           PIC 9.
   366           18  CURR-M2           PIC 9.
   367         16  FILLER              PIC X(5).
   368         16  CURR-YEAR           PIC 9.
   369     12  NUM-WORK   REDEFINES DATE-WORK   PIC 9(8).
   370     12  SUB                     PIC 99.
   371     12  MY-DATE.
   372         16  MY-MM               PIC XX.
   373         16  FILLER              PIC X VALUE '/'.
   374         16  MY-YY               PIC XX.
   375
   376     12  WS-EDIT-BEN-CODE        PIC XX.
   377         88  INVALID-BENEFIT-CODE   VALUE '  ' '00'
   378                                          '90' THRU '99'.
   379
   380     12  WS-NUM-HOLD             PIC S9(4)     VALUE +0  COMP-3.
   381     12  WS-BEN-HOLD             PIC XX.
   382     12  WS-BEN-ALPHA-HOLD.
   383         15  WS-BEN-ALPHA-2      PIC XX.
   384         15  WS-BEN-ALPHA-1      PIC X.
   385     12  WS-FORM-HOLD            PIC X(12)  VALUE SPACES.
   386     12  WS-REC-TYPE             PIC X.
   387     12  HOLD-LOAN-BAL           PIC 9(7)V99   VALUE ZEROS.
   388     12  DEEDIT-FIELD            PIC 9(10)V99  VALUE ZEROS.
   389     12  ARCH-NUMBER             PIC S9(8)   COMP.
   390     12  WS-REIN-REC-FOUND-SW    PIC X(01)   VALUE ' '.
   391         88  REIN-REC-NOT-FOUND              VALUE 'N'.
   392         88  REIN-REC-FOUND                  VALUE 'Y'.
   393
   394     12  WS-REC-FOUND-SW         PIC X(01)   VALUE ' '.
   395     12  WS-LETTER-SW            PIC X(01)   VALUE 'N'.
   396
   397
   398 01  CSO-WORK-FIELDS.
   399     12  WS-BLANK            PIC X       VALUE ' '.
   400
   401     12  WS-MA-CONTROL-PRIMARY.
   402         16  WS-MA-COMPANY-CD        PIC  X.
   403         16  WS-MA-CARRIER           PIC  X.
   404         16  WS-MA-GROUPING          PIC  X(6).
   405         16  WS-MA-STATE             PIC  XX.
   406         16  WS-MA-ACCOUNT           PIC  X(10).
   407         16  WS-MA-CERT-EFF-DT       PIC  XX.
   408         16  WS-MA-CERT-NO.
   409             20  WS-MA-CERT-PRIME    PIC  X(10).
   410             20  WS-MA-CERT-SFX      PIC  X.
   411
   412     12  WS-INSURED-ADDR-CNT         PIC  S9(1) VALUE +0.
   413     12  WS-NO-INSURED-ADDRESS       PIC  X(01) VALUE 'N'.
   414     12  WS-SOC-SEC-NUMBER.
   415         16  WS-SOC-SEC-NO       PIC 9(9).
   416         16  WS-SOC-SEC-BLANK    PIC X(2).
   417     12  WS-SOC-SEC-REDEF REDEFINES WS-SOC-SEC-NUMBER.
   418         16  WS-SSN-1-3          PIC 9(3).
   419         16  WS-SSN-DASH1        PIC X(1).
   420         16  WS-SSN-4-5          PIC 9(2).
   421         16  WS-SSN-DASH2        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  10
* EL130.cbl
   422         16  WS-SSN-6-9          PIC 9(4).
   423
   424     12  WS-DIAG-VIN-MSG.
   425         16  FILLER          PIC X(11)
   426             VALUE 'VIN NUMBER '.
   427         16  WS-DIAG-VIN     PIC X(17).
   428
   429     12  WS-VERIFY-NOTE      PIC X(34)
   430         VALUE '2ND BENE SSN VERIFICATION REQUIRED'.
   431
   432     12  WS-CAUSAL-NOTE      PIC X(40)
   433         VALUE 'VERIFY IF DX RELATED TO PRIOR CONDITION '.
   434
   435     12  WS-VFY-SSN-NOTE     PIC X(25)
   436         VALUE 'SSN VERIFICATION REQUIRED'.
   437
   438 01  MAP-DATE-AREAS.
   439     12  WS-EFFDT            PIC XX      VALUE LOW-VALUES.
   440     12  WS-EXPIRE           PIC XX      VALUE LOW-VALUES.
   441     12  WS-ADD-ON-DT        PIC XX      VALUE LOW-VALUES.
   442     12  WS-BIRTHDT          PIC XX      VALUE LOW-VALUES.
   443     12  WS-INCUR            PIC XX      VALUE LOW-VALUES.
   444     12  WS-REPORT           PIC XX      VALUE LOW-VALUES.
   445     12  WS-ESTEND           PIC XX      VALUE LOW-VALUES.
   446     12  WS-ACVCNDT          PIC XX      VALUE LOW-VALUES.
   447     12  WS-LCVCNDT          PIC XX      VALUE LOW-VALUES.
   448     12  WS-TODAY-DT         PIC XX      VALUE LOW-VALUES.
   449     12  WS-ENTRYDT          PIC XX      VALUE LOW-VALUES.
   450     12  WS-MANRSV           PIC S9(6)V99  VALUE ZEROS COMP-3.
   451     12  WS-ACVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   452     12  WS-ACVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   453     12  WS-LCVRATE          PIC S9(4)V99  VALUE ZEROS COMP-3.
   454     12  WS-LCVBENE          PIC S9(9)V99  VALUE ZEROS COMP-3.
   455     12  WS-APR              PIC S999V9999 VALUE ZEROS COMP-3.
   456     12  WS-PMTFREQ          PIC 99        VALUE ZEROS COMP-3.
   457     12  WS-ASSOC-CERT-TOTAL PIC S99       VALUE ZEROS.
   458         88  NO-ASSOCIATED-CERTS           VALUE ZEROS.
   459     12  WS-ASSOC-CERT-SEQU  PIC S99       VALUE ZEROS.
   460     12  WS-READNEXT-SWITCH  PIC S99       VALUE +1.
   461     12  WS-ASSOCIATED-CERTS PIC S9        VALUE ZEROS COMP-3.
   462     12  ONE-OR-MIN1         PIC S9        VALUE +1    COMP-3.
   463
   464 01  ACCESS-KEYS.
   465     12  ELACTQ-KEY.
   466         16  ELACTQ-COMPANY-CD       PIC X.
   467         16  ELACTQ-CARRIER          PIC X.
   468         16  ELACTQ-CLAIM-NO         PIC X(7).
   469         16  ELACTQ-CERT-NO          PIC X(11).
   470     12  ELMSTR-KEY.
   471         16  MSTR-COMP-CD            PIC X.
   472         16  MSTR-CARRIER            PIC X.
   473         16  MSTR-CLAIM-NO           PIC X(7).
   474         16  MSTR-CERT-NO.
   475             20  MSTR-CERT-NO-PRIME  PIC X(10).
   476             20  MSTR-CERT-NO-SUFX   PIC X.
   477     12  SAVE-ELMSTR-KEY.
   478         16  SAVE-COMP-CD            PIC X.
   479         16  SAVE-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  11
* EL130.cbl
   480         16  SAVE-CLAIM-NO           PIC X(7).
   481         16  SAVE-CERT-NO.
   482             20  SAVE-CERT-NO-PRIME  PIC X(10).
   483             20  SAVE-CERT-NO-SUFX   PIC X.
   484     12  ELMSTR5-KEY.
   485         16  MSTR5-COMP-CD           PIC X.
   486         16  MSTR5-CERT-NO.
   487             20  MSTR5-CERT-NO-PRIME PIC X(10).
   488             20  MSTR5-CERT-NO-SUFX  PIC X.
   489     12  INCUR-DTE-DUPE-SW           PIC X VALUE 'N'.
   490         88  NO-CLAIMS-FOR-CERT            VALUE 'N'.
   491         88  INCURRED-DATE-MATCH           VALUE 'Y'.
   492         88  CLAIM-RECORD-FOUND            VALUE 'H'.
   493     12  ELCNTL-KEY.
   494         16  CNTL-COMP-ID    PIC X(3).
   495         16  CNTL-REC-TYPE   PIC X.
   496         16  CNTL-ACCESS.
   497             20  FILLER      PIC XX.
   498             20  CNTL-BENEFIT.
   499                 24  FILLER  PIC X.
   500                 24  CNTL-CARRIER PIC X.
   501         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
   502     12  ELCERT-KEY.
   503         16  CERT-COMP-CD    PIC X.
   504         16  CERT-CARRIER    PIC X.
   505         16  CERT-GROUPING   PIC X(6).
   506         16  CERT-STATE      PIC X(2).
   507         16  CERT-ACCOUNT.
   508             20  CERT-ACCOUNT-PREFIX PIC X(4).
   509             20  CERT-ACCOUNT-PRIME  PIC X(6).
   510         16  CERT-EFF-DT     PIC XX.
   511         16  CERT-CERT-NO.
   512             20  CERT-CERT-NO-PRIME  PIC X(10).
   513             20  CERT-CERT-NO-SUFX   PIC X.
   514     12  ELCERT-KEY-5.
   515         16  CERT-COMP-CD-5      PIC X.
   516         16  CERT-CERT-5.
   517             20  CERT-CERT-5-PRIME   PIC X(10).
   518             20  CERT-CERT-5-SUFX    PIC X.
   519     12  ERACCT-KEY.
   520         16  ACCT-COMP-CD    PIC X.
   521         16  ACCT-CARRIER    PIC X.
   522         16  ACCT-GROUPING   PIC X(6).
   523         16  ACCT-STATE      PIC X(2).
   524         16  ACCT-ACCOUNT    PIC X(10).
   525         16  ACCT-EXP-DT     PIC XX.
   526     12  ELTRLR-KEY.
   527         16  TRLR-COMP-CD    PIC X.
   528         16  TRLR-CARRIER    PIC X.
   529         16  TRLR-CLAIM-NO   PIC X(7).
   530         16  TRLR-CERT-NO.
   531             20  TRLR-CERT-NO-PRIME  PIC X(10).
   532             20  TRLR-CERT-NO-SUFX   PIC X.
   533         16  TRLR-SEQ-NO     PIC S9(4)   COMP.
   534         16  TRLR-TYPE       PIC X.
   535     12  ELBENE-KEY.
   536         16  BENE-COMP-CD    PIC X.
   537         16  BENE-RCD-TYPE   PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  12
* EL130.cbl
   538         16  BENE-CODE       PIC X(10).
   539     12  ERREIN-KEY.
   540         16  REIN-COMP-CD        PIC X(01).
   541         16  REIN-TYPE           PIC X(01).
   542         16  REIN-TABLE-CO.
   543             20  REIN-CODE-1     PIC X(01).
   544             20  REIN-CODE-2     PIC X(01).
   545             20  REIN-CODE-3     PIC X(01).
   546         16  FILLER              PIC X(03).
   547     12  ELCRTT-KEY.
   548         16  CTRLR-COMP-CD       PIC X.
   549         16  CTRLR-CARRIER       PIC X.
   550         16  CTRLR-GROUPING      PIC X(6).
   551         16  CTRLR-STATE         PIC X(2).
   552         16  CTRLR-ACCOUNT       PIC X(10).
   553         16  CTRLR-EFF-DT        PIC XX.
   554         16  CTRLR-CERT-NO       PIC X(11).
   555         16  CTRLR-REC-TYPE      PIC X.
   556 01  ws-acct-found-sw            pic x value ' '.
   557     88  acct-found                value 'Y'.
   558 01  ERPDEF-KEY-SAVE             PIC X(18).
   559 01  ERPDEF-KEY.
   560     12  ERPDEF-COMPANY-CD       PIC X.
   561     12  ERPDEF-STATE            PIC XX.
   562     12  ERPDEF-PROD-CD          PIC XXX.
   563     12  F                       PIC X(7).
   564     12  ERPDEF-BEN-TYPE         PIC X.
   565     12  ERPDEF-BEN-CODE         PIC XX.
   566     12  ERPDEF-EXP-DT           PIC XX.
   567 01  ERROR-MESSAGES.
   568     12  ER-0000                 PIC X(4)  VALUE '0000'.
   569     12  ER-0004                 PIC X(4)  VALUE '0004'.
   570     12  ER-0019                 PIC X(4)  VALUE '0019'.
   571     12  ER-0023                 PIC X(4)  VALUE '0023'.
   572     12  ER-0029                 PIC X(4)  VALUE '0029'.
   573     12  ER-0033                 PIC X(4)  VALUE '0033'.
   574     12  ER-0068                 PIC X(4)  VALUE '0068'.
   575     12  ER-0070                 PIC X(4)  VALUE '0070'.
   576     12  ER-0194                 PIC X(4)  VALUE '0194'.
   577     12  ER-0202                 PIC X(4)  VALUE '0202'.
   578     12  ER-0203                 PIC X(4)  VALUE '0203'.
   579     12  ER-0204                 PIC X(4)  VALUE '0204'.
   580     12  ER-0205                 PIC X(4)  VALUE '0205'.
   581     12  ER-0206                 PIC X(4)  VALUE '0206'.
   582     12  ER-0207                 PIC X(4)  VALUE '0207'.
   583     12  ER-0213                 PIC X(4)  VALUE '0213'.
   584     12  ER-0214                 PIC X(4)  VALUE '0214'.
   585     12  ER-0217                 PIC X(4)  VALUE '0217'.
   586     12  ER-0219                 PIC X(4)  VALUE '0219'.
   587     12  ER-0220                 PIC X(4)  VALUE '0220'.
   588     12  ER-0221                 PIC X(4)  VALUE '0221'.
   589     12  ER-0222                 PIC X(4)  VALUE '0222'.
   590     12  ER-0223                 PIC X(4)  VALUE '0223'.
   591     12  ER-0224                 PIC X(4)  VALUE '0224'.
   592     12  ER-0225                 PIC X(4)  VALUE '0225'.
   593     12  ER-0226                 PIC X(4)  VALUE '0226'.
   594     12  ER-0227                 PIC X(4)  VALUE '0227'.
   595     12  ER-0229                 PIC X(4)  VALUE '0229'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  13
* EL130.cbl
   596     12  ER-0230                 PIC X(4)  VALUE '0230'.
   597     12  ER-0231                 PIC X(4)  VALUE '0231'.
   598     12  ER-0232                 PIC X(4)  VALUE '0232'.
   599     12  ER-0233                 PIC X(4)  VALUE '0233'.
   600     12  ER-0234                 PIC X(4)  VALUE '0234'.
   601     12  ER-0235                 PIC X(4)  VALUE '0235'.
   602     12  ER-0236                 PIC X(4)  VALUE '0236'.
   603     12  ER-0237                 PIC X(4)  VALUE '0237'.
   604     12  ER-0238                 PIC X(4)  VALUE '0238'.
   605     12  ER-0239                 PIC X(4)  VALUE '0239'.
   606     12  ER-0240                 PIC X(4)  VALUE '0240'.
   607     12  ER-0241                 PIC X(4)  VALUE '0241'.
   608     12  ER-0243                 PIC X(4)  VALUE '0243'.
   609     12  ER-0244                 PIC X(4)  VALUE '0244'.
   610     12  ER-0245                 PIC X(4)  VALUE '0245'.
   611     12  ER-0246                 PIC X(4)  VALUE '0246'.
   612     12  ER-0247                 PIC X(4)  VALUE '0247'.
   613     12  ER-0248                 PIC X(4)  VALUE '0248'.
   614     12  ER-0250                 PIC X(4)  VALUE '0250'.
   615     12  ER-0251                 PIC X(4)  VALUE '0251'.
   616     12  ER-0252                 PIC X(4)  VALUE '0252'.
   617     12  ER-0253                 PIC X(4)  VALUE '0253'.
   618     12  ER-0254                 PIC X(4)  VALUE '0254'.
   619     12  ER-0257                 PIC X(4)  VALUE '0257'.
   620     12  ER-0258                 PIC X(4)  VALUE '0258'.
   621     12  ER-0260                 PIC X(4)  VALUE '0260'.
   622     12  ER-0261                 PIC X(4)  VALUE '0261'.
   623     12  ER-0263                 PIC X(4)  VALUE '0263'.
   624     12  ER-0264                 PIC X(4)  VALUE '0264'.
   625     12  ER-0265                 PIC X(4)  VALUE '0265'.
   626     12  ER-0266                 PIC X(4)  VALUE '0266'.
   627     12  ER-0267                 PIC X(4)  VALUE '0267'.
   628     12  ER-0334                 PIC X(4)  VALUE '0334'.
   629     12  ER-0337                 PIC X(4)  VALUE '0337'.
   630     12  ER-0412                 PIC X(4)  VALUE '0412'.
   631     12  ER-0413                 PIC X(4)  VALUE '0413'.
   632     12  ER-0428                 PIC X(4)  VALUE '0428'.
   633     12  ER-0429                 PIC X(4)  VALUE '0429'.
   634     12  ER-0430                 PIC X(4)  VALUE '0430'.
   635     12  ER-0433                 PIC X(4)  VALUE '0433'.
   636     12  ER-0434                 PIC X(4)  VALUE '0434'.
   637     12  ER-0458                 PIC X(4)  VALUE '0458'.
   638     12  ER-0489                 PIC X(4)  VALUE '0489'.
   639     12  ER-0509                 PIC X(4)  VALUE '0509'.
   640     12  ER-0510                 PIC X(4)  VALUE '0510'.
   641     12  ER-0511                 PIC X(4)  VALUE '0511'.
   642     12  ER-0512                 PIC X(4)  VALUE '0512'.
   643     12  ER-0516                 PIC X(4)  VALUE '0516'.
   644     12  ER-0517                 PIC X(4)  VALUE '0517'.
   645     12  ER-0518                 PIC X(4)  VALUE '0518'.
   646     12  ER-0519                 PIC X(4)  VALUE '0519'.
   647     12  ER-0520                 PIC X(4)  VALUE '0520'.
   648     12  ER-0521                 PIC X(4)  VALUE '0521'.
   649     12  ER-0522                 PIC X(4)  VALUE '0522'.
   650     12  ER-0523                 PIC X(4)  VALUE '0523'.
   651     12  ER-0544                 PIC X(4)  VALUE '0544'.
   652     12  ER-0546                 PIC X(4)  VALUE '0546'.
   653     12  ER-0558                 PIC X(4)  VALUE '0558'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  14
* EL130.cbl
   654     12  ER-0560                 PIC X(4)  VALUE '0560'.
   655     12  ER-0562                 PIC X(4)  VALUE '0562'.
   656     12  ER-0565                 PIC X(4)  VALUE '0565'.
   657     12  ER-0569                 PIC X(4)  VALUE '0569'.
   658     12  ER-0693                 PIC X(4)  VALUE '0693'.
   659     12  ER-0715                 PIC X(4)  VALUE '0715'.
   660     12  ER-0840                 PIC X(4)  VALUE '0840'.
   661     12  ER-0841                 PIC X(4)  VALUE '0841'.
   662     12  ER-0842                 PIC X(4)  VALUE '0842'.
   663     12  ER-0843                 PIC X(4)  VALUE '0843'.
   664     12  ER-0878                 PIC X(4)  VALUE '0878'.
   665     12  ER-0887                 PIC X(4)  VALUE '0887'.
   666     12  ER-0992                 PIC X(4)  VALUE '0992'.
   667     12  ER-1651                 PIC X(4)  VALUE '1651'.
   668     12  ER-1652                 PIC X(4)  VALUE '1652'.
   669     12  ER-1653                 PIC X(4)  VALUE '1653'.
   670     12  ER-1654                 PIC X(4)  VALUE '1654'.
   671     12  ER-1655                 PIC X(4)  VALUE '1655'.
   672     12  er-1659                 pic x(4)  value '1659'.
   673     12  er-1660                 pic x(4)  value '1660'.
   674     12  er-1661                 pic x(4)  value '1661'.
   675     12  er-1671                 pic x(4)  value '1671'.
   676     12  er-1672                 pic x(4)  value '1672'.
   677     12  er-1673                 pic x(4)  value '1673'.
   678     12  er-1675                 pic x(4)  value '1675'.
   679     12  er-1676                 pic x(4)  value '1676'.
   680     12  ER-1679                 PIC X(4)  VALUE '1679'.
   681     12  ER-2280                 PIC X(4)  VALUE '2280'.
   682     12  ER-2370                 PIC X(4)  VALUE '2370'.
   683     12  ER-2371                 PIC X(4)  VALUE '2371'.
   684     12  ER-2378                 PIC X(4)  VALUE '2378'.
   685     12  ER-2380                 PIC X(4)  VALUE '2380'.
   686     12  ER-2566                 PIC X(4)  VALUE '2566'.
   687     12  ER-2848                 PIC X(4)  VALUE '2848'.
   688     12  ER-3548                 PIC X(4)  VALUE '3548'.
   689     12  ER-7008                 PIC X(4)  VALUE '7008'.
   690     12  ER-7319                 PIC X(4)  VALUE '7319'.
   691     12  ER-7321                 PIC X(4)  VALUE '7321'.
   692     12  ER-7352                 PIC X(4)  VALUE '7352'.
   693     12  ER-7353                 PIC X(4)  VALUE '7353'.
   694     12  ER-7575                 PIC X(4)  VALUE '7575'.
   695     12  ER-7577                 PIC X(4)  VALUE '7577'.
   696     12  ER-7582                 PIC X(4)  VALUE '7582'.
   697     12  ER-7634                 PIC X(4)  VALUE '7634'.
   698     12  ER-7635                 PIC X(4)  VALUE '7635'.
   699     12  ER-7636                 PIC X(4)  VALUE '7636'.
   700     12  ER-7637                 PIC X(4)  VALUE '7637'.
   701     12  ER-7638                 PIC X(4)  VALUE '7638'.
   702     12  ER-7639                 PIC X(4)  VALUE '7639'.
   703     12  ER-7640                 PIC X(4)  VALUE '7640'.
   704     12  ER-7641                 PIC X(4)  VALUE '7641'.
   705     12  ER-7642                 PIC X(4)  VALUE '7642'.
   706     12  ER-7643                 PIC X(4)  VALUE '7643'.
   707     12  ER-7646                 PIC X(4)  VALUE '7646'.
   708     12  ER-7647                 PIC X(4)  VALUE '7647'.
   709     12  ER-7648                 PIC X(4)  VALUE '7648'.
   710     12  ER-7649                 PIC X(4)  VALUE '7649'.
   711     12  ER-7651                 PIC X(4)  VALUE '7651'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  15
* EL130.cbl
   712     12  ER-7670                 PIC X(4)  VALUE '7670'.
   713     12  ER-7671                 PIC X(4)  VALUE '7671'.
   714     12  ER-7686                 PIC X(4)  VALUE '7686'.
   715     12  ER-7688                 PIC X(4)  VALUE '7688'.
   716     12  ER-7689                 PIC X(4)  VALUE '7689'.
   717     12  ER-7691                 PIC X(4)  VALUE '7691'.
   718*    COPY ERCPDEF.
   719******************************************************************
   720*                                                                *
   721*                                                                *
   722*                            ERCPDEF.                            *
   723*                                                                *
   724*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
   725*                                                                *
   726*    FILE TYPE = VSAM,KSDS                                       *
   727*    RECORD SIZE = 1319 RECFORM = FIXED                          *
   728*                                                                *
   729*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
   730*                                                                *
   731*    LOG = YES                                                   *
   732*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   733******************************************************************
   734*                   C H A N G E   L O G
   735*
   736* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   737*-----------------------------------------------------------------
   738*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   739* EFFECTIVE    NUMBER
   740*-----------------------------------------------------------------
   741* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   742* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   743* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
   744******************************************************************
   745 01  PRODUCT-MASTER.
   746    12  PD-RECORD-ID                 PIC X(02).
   747        88  VALID-PD-ID                  VALUE 'PD'.
   748    12  PD-CONTROL-PRIMARY.
   749        16  PD-COMPANY-CD            PIC X.
   750        16  PD-STATE                 PIC XX.
   751        16  PD-PRODUCT-CD            PIC XXX.
   752        16  PD-FILLER                PIC X(7).
   753        16  PD-BEN-TYPE              PIC X.
   754        16  PD-BEN-CODE              PIC XX.
   755        16  PD-PROD-EXP-DT           PIC XX.
   756    12  FILLER                       PIC X(50).
   757    12  PD-PRODUCT-DATA OCCURS 8.
   758        16  PD-PROD-CODE             PIC X.
   759            88  PD-PROD-LIFE           VALUE 'L'.
   760            88  PD-PROD-PROP           VALUE 'P'.
   761            88  PD-PROD-AH             VALUE 'A'.
   762            88  PD-PROD-IU             VALUE 'I'.
   763            88  PD-PROD-GAP            VALUE 'G'.
   764            88  PD-PROD-FAML           VALUE 'F'.
   765        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
   766        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
   767        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
   768        16  PD-MAX-TERM              PIC S999        COMP-3.
   769        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  16
* EL130.cbl
   770        16  FILLER                   PIC X.
   771        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
   772        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
   773        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
   774        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
   775        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
   776        16  PD-REC-CRIT-PERIOD       PIC 99.
   777        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
   778            20  PD-RECURRING-YN      PIC X.
   779            20  FILLER               PIC X.
   780        16  PD-RTW-MOS               PIC 99.
   781        16  PD-MAX-EXTENSION         PIC 99.
   782        16  pd-ben-pct               pic sv999 comp-3.
   783*       16  FILLER                   PIC XX.
   784    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
   785    12  PD-TERM-LIMITS OCCURS 15.
   786        16  PD-LOW-TERM              PIC S999        COMP-3.
   787        16  PD-HI-TERM               PIC S999        COMP-3.
   788*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
   789    12  PD-LOAN-AMT-LIMITS OCCURS 15.
   790        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
   791        16  PD-HI-AMT                PIC S9(7)       COMP-3.
   792    12  PD-EARN-FACTORS.
   793        16  FILLER OCCURS 15.
   794            20  FILLER OCCURS 15.
   795                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
   796    12  PD-PRODUCT-DESC              PIC X(80).
   797    12  PD-TRUNCATED                 PIC X.
   798    12  FILLER                       PIC X(59).
   799    12  PD-MAINT-INFORMATION.
   800        16  PD-LAST-MAINT-DT         PIC X(02).
   801        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
   802        16  PD-LAST-MAINT-BY         PIC X(04).
   803*    COPY ELCLNKLT.
   804******************************************************************
   805*                                                                *
   806*                                                                *
   807*                           ELCLNKLT                             *
   808*                            VMOD=2.003                          *
   809*                                                                *
   810*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
   811*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
   812*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
   813*                                                                *
   814*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
   815*   COMPLETING THE REQUIRED FIELDS.                              *
   816*                                                                *
   817*   THE CALLING PROGRAM SHOULD CHECK:                            *
   818*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
   819*                              9999 INDICATES AN UNKNOWN ABEND   *
   820*                                   WAS DETECTED.                *
   821*                              ALL OTHER VALUES ARE NORMAL ERROR *
   822*                              CODES FOUND IN THE ERROR FILE.    *
   823******************************************************************
   824 01  W-1523-LINKDATA.
   825     12  W-1523-COMMON-PI-DATA.
   826         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
   827         16  FILLER              PIC  X(67).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  17
* EL130.cbl
   828         16  W-1523-COMPANY-CD   PIC  X(01).
   829         16  FILLER              PIC  X(10).
   830         16  W-1523-CONTROL-IN-PROGRESS.
   831             20  W-1523-CARRIER  PIC  X(01).
   832             20  W-1523-GROUPING PIC  X(06).
   833             20  W-1523-STATE    PIC  X(02).
   834             20  W-1523-ACCOUNT  PIC  X(10).
   835             20  W-1523-CLAIM-CERT-GRP.
   836                 24  W-1523-CLAIM-NO
   837                                 PIC  X(07).
   838                 24  W-1523-CERT-NO.
   839                     28  W-1523-CERT-PRIME
   840                                 PIC  X(10).
   841                     28  W-1523-CERT-SFX
   842                                 PIC  X(01).
   843                 24  W-1523-CERT-EFF-DT
   844                                 PIC  X(02).
   845         16  FILLER              PIC X(265).
   846
   847     12  W-1523-WORK-AREA.
   848         16  W-1523-FORM-NUMBER  PIC  X(04).
   849         16  W-1523-NUMBER-COPIES
   850                                 PIC  9(01).
   851         16  W-1523-ADDR-TYPE    PIC  X(02).
   852         16  W-1523-FOLLOW-UP-DATE
   853                                 PIC  X(02).
   854         16  W-1523-RESEND-DATE  PIC  X(02).
   855         16  W-1523-ERROR-CODE   PIC  9(04).
   856             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
   857             88  W-1523-FATAL-ERROR
   858                                    VALUES  0006 0013 0042
   859                                            0154 0168 0169
   860                                            0176 9999 0172
   861                                            0179 0186 0281
   862                                            0332 2055 3697
   863                                            3698 3699 3770
   864                                            3771 3772 7675
   865                                            9106 9808 9883
   866                                            9887.
   867             88  W-1523-STOP-ERRORS
   868                                    VALUES  0013 0042 0154
   869                                            0168 0169 0172
   870                                            0281 0332 2055
   871                                            3698 3699 7675
   872                                            9106 9808 9883
   873                                            9999.
   874         16  W-1523-REASON       PIC  X(70).
   875         16  W-1523-ARCHIVE-NUMBER
   876                                 PIC  9(08).
   877     12  W-1523-POINTER-AREA.
   878         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
   879         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
   880         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
   881         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
   882         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  18
* EL130.cbl
   884*    COPY ELCINTF.
   885******************************************************************
   886*                                                                *
   887*                                                                *
   888*                            ELCINTF.                            *
   889*                            VMOD=2.017                          *
   890*                                                                *
   891*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   892*                                                                *
   893*       LENGTH = 1024                                            *
   894*                                                                *
   895******************************************************************
   896*                   C H A N G E   L O G
   897*
   898* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   899*-----------------------------------------------------------------
   900*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   901* EFFECTIVE    NUMBER
   902*-----------------------------------------------------------------
   903* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   904******************************************************************
   905 01  PROGRAM-INTERFACE-BLOCK.
   906     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   907     12  PI-CALLING-PROGRAM              PIC X(8).
   908     12  PI-SAVED-PROGRAM-1              PIC X(8).
   909     12  PI-SAVED-PROGRAM-2              PIC X(8).
   910     12  PI-SAVED-PROGRAM-3              PIC X(8).
   911     12  PI-SAVED-PROGRAM-4              PIC X(8).
   912     12  PI-SAVED-PROGRAM-5              PIC X(8).
   913     12  PI-SAVED-PROGRAM-6              PIC X(8).
   914     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   915     12  PI-COMPANY-ID                   PIC XXX.
   916     12  PI-COMPANY-CD                   PIC X.
   917
   918     12  PI-COMPANY-PASSWORD             PIC X(8).
   919
   920     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   921
   922     12  PI-CONTROL-IN-PROGRESS.
   923         16  PI-CARRIER                  PIC X.
   924         16  PI-GROUPING                 PIC X(6).
   925         16  PI-STATE                    PIC XX.
   926         16  PI-ACCOUNT                  PIC X(10).
   927         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   928                                         PIC X(10).
   929         16  PI-CLAIM-CERT-GRP.
   930             20  PI-CLAIM-NO             PIC X(7).
   931             20  PI-CERT-NO.
   932                 25  PI-CERT-PRIME       PIC X(10).
   933                 25  PI-CERT-SFX         PIC X.
   934             20  PI-CERT-EFF-DT          PIC XX.
   935         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   936             20  PI-PLAN-CODE            PIC X(2).
   937             20  PI-REVISION-NUMBER      PIC X(3).
   938             20  PI-PLAN-EFF-DT          PIC X(2).
   939             20  PI-PLAN-EXP-DT          PIC X(2).
   940             20  FILLER                  PIC X(11).
   941         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  19
* EL130.cbl
   942             20  PI-OE-REFERENCE-1.
   943                 25  PI-OE-REF-1-PRIME   PIC X(18).
   944                 25  PI-OE-REF-1-SUFF    PIC XX.
   945
   946     12  PI-SESSION-IN-PROGRESS          PIC X.
   947         88  CLAIM-SESSION                   VALUE '1'.
   948         88  CREDIT-SESSION                  VALUE '2'.
   949         88  WARRANTY-SESSION                VALUE '3'.
   950         88  MORTGAGE-SESSION                VALUE '4'.
   951         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   952
   953
   954*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   955
   956     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   957     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   958
   959     12  PI-CREDIT-USER                  PIC X.
   960         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   961         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   962
   963     12  PI-CLAIM-USER                   PIC X.
   964         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   965         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   966
   967     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   968         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   969         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   970         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   971         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   972         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   973
   974     12  PI-PROCESSOR-ID                 PIC X(4).
   975
   976     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   977
   978     12  PI-MEMBER-CAPTION               PIC X(10).
   979
   980     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   981         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   982
   983     12  PI-LIFE-OVERRIDE-L1             PIC X.
   984     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   985     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   986     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   987
   988     12  PI-AH-OVERRIDE-L1               PIC X.
   989     12  PI-AH-OVERRIDE-L2               PIC XX.
   990     12  PI-AH-OVERRIDE-L6               PIC X(6).
   991     12  PI-AH-OVERRIDE-L12              PIC X(12).
   992
   993     12  PI-NEW-SYSTEM                   PIC X(2).
   994
   995     12  PI-PRIMARY-CERT-NO              PIC X(11).
   996     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   997         88  PI-USES-PAID-TO                 VALUE '1'.
   998     12  PI-CRDTCRD-SYSTEM.
   999         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  20
* EL130.cbl
  1000             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1001             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1002         16  PI-CC-MONTH-END-DT          PIC XX.
  1003     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1004
  1005     12  PI-OE-REFERENCE-2.
  1006         16  PI-OE-REF-2-PRIME           PIC X(10).
  1007         16  PI-OE-REF-2-SUFF            PIC X.
  1008
  1009     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1010
  1011     12  PI-LANGUAGE-TYPE                PIC X.
  1012             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1013             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1014             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1015
  1016     12  PI-POLICY-LINKAGE-IND           PIC X.
  1017         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1018         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1019                                                   LOW-VALUES.
  1020
  1021     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1022     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1023         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1024         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1025
  1026     12  PI-PROCESSOR-CSR-IND            PIC X.
  1027         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1028         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1029
  1030     12  FILLER                          PIC X(3).
  1031
  1032     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1033
  1034     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1035         PI-SYSTEM-LEVEL.
  1036
  1037         16  PI-ENTRY-CODES.
  1038             20  PI-ENTRY-CD-1           PIC X.
  1039             20  PI-ENTRY-CD-2           PIC X.
  1040
  1041         16  PI-RETURN-CODES.
  1042             20  PI-RETURN-CD-1          PIC X.
  1043             20  PI-RETURN-CD-2          PIC X.
  1044
  1045         16  PI-UPDATE-STATUS-SAVE.
  1046             20  PI-UPDATE-BY            PIC X(4).
  1047             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1048
  1049         16  PI-LOWER-CASE-LETTERS       PIC X.
  1050             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1051
  1052*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1053*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1054*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1055
  1056         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1057             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  21
* EL130.cbl
  1058             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1059             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1060             88  ACCNT-CNTL                  VALUE '3'.
  1061             88  CARR-ACCNT-CNTL             VALUE '4'.
  1062
  1063         16  PI-PROCESSOR-CAP-LIST.
  1064             20  PI-SYSTEM-CONTROLS.
  1065                24 PI-SYSTEM-DISPLAY     PIC X.
  1066                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1067                24 PI-SYSTEM-MODIFY      PIC X.
  1068                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1069             20  FILLER                  PIC XX.
  1070             20  PI-DISPLAY-CAP          PIC X.
  1071                 88  DISPLAY-CAP             VALUE 'Y'.
  1072             20  PI-MODIFY-CAP           PIC X.
  1073                 88  MODIFY-CAP              VALUE 'Y'.
  1074             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1075                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1076             20  PI-FORCE-CAP            PIC X.
  1077                 88  FORCE-CAP               VALUE 'Y'.
  1078
  1079         16  PI-PROGRAM-CONTROLS.
  1080             20  PI-PGM-PRINT-OPT        PIC X.
  1081             20  PI-PGM-FORMAT-OPT       PIC X.
  1082             20  PI-PGM-PROCESS-OPT      PIC X.
  1083             20  PI-PGM-TOTALS-OPT       PIC X.
  1084
  1085         16  PI-HELP-INTERFACE.
  1086             20  PI-LAST-ERROR-NO        PIC X(4).
  1087             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1088
  1089         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1090             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1091
  1092         16  PI-CR-CONTROL-IN-PROGRESS.
  1093             20  PI-CR-CARRIER           PIC X.
  1094             20  PI-CR-GROUPING          PIC X(6).
  1095             20  PI-CR-STATE             PIC XX.
  1096             20  PI-CR-ACCOUNT           PIC X(10).
  1097             20  PI-CR-FIN-RESP          PIC X(10).
  1098             20  PI-CR-TYPE              PIC X.
  1099
  1100         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1101
  1102         16  PI-CR-MONTH-END-DT          PIC XX.
  1103
  1104         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1105             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1106             88  PI-ZERO-CARRIER             VALUE '1'.
  1107             88  PI-ZERO-GROUPING            VALUE '2'.
  1108             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1109
  1110         16  PI-CARRIER-SECURITY         PIC X.
  1111             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1112
  1113         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1114             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1115             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  22
* EL130.cbl
  1116
  1117         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1118             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1119                                         INDEXED BY PI-ACCESS-NDX
  1120                                         PIC X.
  1121
  1122         16  PI-GA-BILLING-CONTROL       PIC X.
  1123             88  PI-GA-BILLING               VALUE '1'.
  1124
  1125         16  PI-MAIL-PROCESSING          PIC X.
  1126             88  PI-MAIL-YES                 VALUE 'Y'.
  1127
  1128         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1129
  1130         16  PI-AR-SYSTEM.
  1131             20  PI-AR-PROCESSING-CNTL   PIC X.
  1132                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1133             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1134             20  PI-AR-MONTH-END-DT      PIC XX.
  1135
  1136         16  PI-MP-SYSTEM.
  1137             20  PI-MORTGAGE-USER            PIC X.
  1138                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1139                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1140             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1141                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1142                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1143                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1144                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1145                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1146             20  PI-MP-MONTH-END-DT          PIC XX.
  1147             20  PI-MP-REFERENCE-NO.
  1148                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1149                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1150
  1151         16  PI-LABEL-CONTROL            PIC X(01).
  1152             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1153             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1154
  1155         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1156             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1157
  1158         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1159             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1160             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1161
  1162         16  FILLER                      PIC X(14).
  1163
  1164     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1165******************************************************************
  1166     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  1167         16  PI-MSTR-DT               PIC XX.
  1168         16  PI-MSTR-WHEN             PIC S9(6)   COMP-3.
  1169         16  PI-TRLR-DT               PIC XX.
  1170         16  PI-TRLR-WHEN             PIC S9(6)   COMP-3.
  1171         16  PI-LAST-CLAIM            PIC X(7).
  1172         16  PI-LAST-CARR             PIC X.
  1173         16  PI-LAST-CERT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  23
* EL130.cbl
  1174             20  PI-LAST-CERT-PRIME   PIC X(10).
  1175             20  PI-LAST-CERT-SUFX    PIC X.
  1176         16  PI-LAST-CLAIM-TYPE       PIC X.
  1177         16  PI-CURSOR                PIC S9(4)   COMP.
  1178         16  PI-SAVE-CERT.
  1179             20  PI-SAVE-CERT-PRIME   PIC X(10).
  1180             20  PI-SAVE-CERT-SUFX    PIC X.
  1181         16  PI-SAVE-EFFDT            PIC X(2).
  1182         16  PI-SAVE-ACCOUNT          PIC X(10).
  1183         16  PI-INCURR-SW             PIC X.
  1184         16  PI-PRT-OPT               PIC X.
  1185         16  PI-ALT-PRT               PIC X(4).
  1186         16  PI-CLAIM-DELETED-SWITCH  PIC X.
  1187             88  CLAIM-DELETED-BY-EL131   VALUE 'D'.
  1188         16  FILLER                   PIC X(272).
  1189         16  PI-EL127-TO-EL130-CNTRL.
  1190             20  PI-CERT-SELECT-CNT          PIC S9(04) COMP.
  1191             20  PI-CERT-PROCESSED           PIC S9(04) COMP.
  1192             20  PI-CERT-CONTROLS-EL127  OCCURS 5 TIMES.
  1193                 24  PI-EL127-CARRIER        PIC X.
  1194                 24  PI-EL127-GROUPING       PIC X(6).
  1195                 24  PI-EL127-STATE          PIC X(2).
  1196                 24  PI-EL127-ACCOUNT        PIC X(10).
  1197                 24  PI-EL127-CERT-NO.
  1198                     28  PI-EL127-CERT-PRIME PIC X(10).
  1199                     28  PI-EL127-CERT-SUFX  PIC X.
  1200                 24  PI-EL127-EFF-DT         PIC XX.
  1201*        16  FILLER                          PIC X(50).
  1202         16  FILLER                          PIC X(31).
  1203         16  PI-EL659-TO-EL130-CNTRL.
  1204             20  PI-EL659-CARRIER            PIC X.
  1205             20  PI-EL659-GROUPING           PIC X(6).
  1206             20  PI-EL659-STATE              PIC XX.
  1207             20  PI-EL659-ACCOUNT            PIC X(10).
  1208
  1209         16  FILLER                          PIC X(19).
  1210
  1211         16  PI-SAVE-INCUR-DT                PIC X(02).
  1212         16  PI-LETTER-ERROR-CODE            PIC 9(04).
  1213*         16  FILLER                          PIC X(65).
  1214         16  PI-ST-VFY-2ND-BENE              PIC X.
  1215         16  PI-ST-CAUSAL-STATE              PIC X.
  1216         16  pi-dcc-max-benefits             pic s999 comp-3.
  1217         16  pi-dcc-max-amt                  pic s9(9)v99 comp-3.
  1218         16  pi-emi-sub                      pic 99.
  1219         16  FILLER                          PIC X(53).
  1220
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  24
* EL130.cbl
  1222*    COPY EL130S.
  1223 01  EL130AI.
  1224     05  FILLER            PIC  X(0012).
  1225*    -------------------------------
  1226     05  RUNDTEL PIC S9(0004) COMP.
  1227     05  RUNDTEF PIC  X(0001).
  1228     05  FILLER REDEFINES RUNDTEF.
  1229         10  RUNDTEA PIC  X(0001).
  1230     05  RUNDTEI PIC  X(0008).
  1231*    -------------------------------
  1232     05  RUNTIMEL PIC S9(0004) COMP.
  1233     05  RUNTIMEF PIC  X(0001).
  1234     05  FILLER REDEFINES RUNTIMEF.
  1235         10  RUNTIMEA PIC  X(0001).
  1236     05  RUNTIMEI PIC  X(0005).
  1237*    -------------------------------
  1238     05  COMPL PIC S9(0004) COMP.
  1239     05  COMPF PIC  X(0001).
  1240     05  FILLER REDEFINES COMPF.
  1241         10  COMPA PIC  X(0001).
  1242     05  COMPI PIC  X(0003).
  1243*    -------------------------------
  1244     05  SEQUL PIC S9(0004) COMP.
  1245     05  SEQUF PIC  X(0001).
  1246     05  FILLER REDEFINES SEQUF.
  1247         10  SEQUA PIC  X(0001).
  1248     05  SEQUI PIC  X(0010).
  1249*    -------------------------------
  1250     05  MAINTL PIC S9(0004) COMP.
  1251     05  MAINTF PIC  X(0001).
  1252     05  FILLER REDEFINES MAINTF.
  1253         10  MAINTA PIC  X(0001).
  1254     05  MAINTI PIC  X(0001).
  1255*    -------------------------------
  1256     05  CLMNOL PIC S9(0004) COMP.
  1257     05  CLMNOF PIC  X(0001).
  1258     05  FILLER REDEFINES CLMNOF.
  1259         10  CLMNOA PIC  X(0001).
  1260     05  CLMNOI PIC  X(0007).
  1261*    -------------------------------
  1262     05  CLMCARRL PIC S9(0004) COMP.
  1263     05  CLMCARRF PIC  X(0001).
  1264     05  FILLER REDEFINES CLMCARRF.
  1265         10  CLMCARRA PIC  X(0001).
  1266     05  CLMCARRI PIC  X(0001).
  1267*    -------------------------------
  1268     05  CLMTYPEL PIC S9(0004) COMP.
  1269     05  CLMTYPEF PIC  X(0001).
  1270     05  FILLER REDEFINES CLMTYPEF.
  1271         10  CLMTYPEA PIC  X(0001).
  1272     05  CLMTYPEI PIC  X(0001).
  1273*    -------------------------------
  1274     05  CERTNOL PIC S9(0004) COMP.
  1275     05  CERTNOF PIC  X(0001).
  1276     05  FILLER REDEFINES CERTNOF.
  1277         10  CERTNOA PIC  X(0001).
  1278     05  CERTNOI PIC  X(0010).
  1279*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  25
* EL130.cbl
  1280     05  SUFXL PIC S9(0004) COMP.
  1281     05  SUFXF PIC  X(0001).
  1282     05  FILLER REDEFINES SUFXF.
  1283         10  SUFXA PIC  X(0001).
  1284     05  SUFXI PIC  X(0001).
  1285*    -------------------------------
  1286     05  PCERTNOL PIC S9(0004) COMP.
  1287     05  PCERTNOF PIC  X(0001).
  1288     05  FILLER REDEFINES PCERTNOF.
  1289         10  PCERTNOA PIC  X(0001).
  1290     05  PCERTNOI PIC  X(0010).
  1291*    -------------------------------
  1292     05  PSUFXL PIC S9(0004) COMP.
  1293     05  PSUFXF PIC  X(0001).
  1294     05  FILLER REDEFINES PSUFXF.
  1295         10  PSUFXA PIC  X(0001).
  1296     05  PSUFXI PIC  X(0001).
  1297*    -------------------------------
  1298     05  INCURL PIC S9(0004) COMP.
  1299     05  INCURF PIC  X(0001).
  1300     05  FILLER REDEFINES INCURF.
  1301         10  INCURA PIC  X(0001).
  1302     05  INCURI PIC  X(0008).
  1303*    -------------------------------
  1304     05  REPORTL PIC S9(0004) COMP.
  1305     05  REPORTF PIC  X(0001).
  1306     05  FILLER REDEFINES REPORTF.
  1307         10  REPORTA PIC  X(0001).
  1308     05  REPORTI PIC  X(0008).
  1309*    -------------------------------
  1310     05  ICD1L PIC S9(0004) COMP.
  1311     05  ICD1F PIC  X(0001).
  1312     05  FILLER REDEFINES ICD1F.
  1313         10  ICD1A PIC  X(0001).
  1314     05  ICD1I PIC  X(0008).
  1315*    -------------------------------
  1316     05  ICD2L PIC S9(0004) COMP.
  1317     05  ICD2F PIC  X(0001).
  1318     05  FILLER REDEFINES ICD2F.
  1319         10  ICD2A PIC  X(0001).
  1320     05  ICD2I PIC  X(0008).
  1321*    -------------------------------
  1322     05  DIAGL PIC S9(0004) COMP.
  1323     05  DIAGF PIC  X(0001).
  1324     05  FILLER REDEFINES DIAGF.
  1325         10  DIAGA PIC  X(0001).
  1326     05  DIAGI PIC  X(0060).
  1327*    -------------------------------
  1328     05  BENECDL PIC S9(0004) COMP.
  1329     05  BENECDF PIC  X(0001).
  1330     05  FILLER REDEFINES BENECDF.
  1331         10  BENECDA PIC  X(0001).
  1332     05  BENECDI PIC  X(0010).
  1333*    -------------------------------
  1334     05  BIRTHDTL PIC S9(0004) COMP.
  1335     05  BIRTHDTF PIC  X(0001).
  1336     05  FILLER REDEFINES BIRTHDTF.
  1337         10  BIRTHDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  26
* EL130.cbl
  1338     05  BIRTHDTI PIC  X(0008).
  1339*    -------------------------------
  1340     05  SSNL PIC S9(0004) COMP.
  1341     05  SSNF PIC  X(0001).
  1342     05  FILLER REDEFINES SSNF.
  1343         10  SSNA PIC  X(0001).
  1344     05  SSNI PIC  X(0011).
  1345*    -------------------------------
  1346     05  SEXL PIC S9(0004) COMP.
  1347     05  SEXF PIC  X(0001).
  1348     05  FILLER REDEFINES SEXF.
  1349         10  SEXA PIC  X(0001).
  1350     05  SEXI PIC  X(0001).
  1351*    -------------------------------
  1352     05  INSTYPEL PIC S9(0004) COMP.
  1353     05  INSTYPEF PIC  X(0001).
  1354     05  FILLER REDEFINES INSTYPEF.
  1355         10  INSTYPEA PIC  X(0001).
  1356     05  INSTYPEI PIC  X(0001).
  1357*    -------------------------------
  1358     05  LSTNMEL PIC S9(0004) COMP.
  1359     05  LSTNMEF PIC  X(0001).
  1360     05  FILLER REDEFINES LSTNMEF.
  1361         10  LSTNMEA PIC  X(0001).
  1362     05  LSTNMEI PIC  X(0015).
  1363*    -------------------------------
  1364     05  FSTNMEL PIC S9(0004) COMP.
  1365     05  FSTNMEF PIC  X(0001).
  1366     05  FILLER REDEFINES FSTNMEF.
  1367         10  FSTNMEA PIC  X(0001).
  1368     05  FSTNMEI PIC  X(0012).
  1369*    -------------------------------
  1370     05  INITL PIC S9(0004) COMP.
  1371     05  INITF PIC  X(0001).
  1372     05  FILLER REDEFINES INITF.
  1373         10  INITA PIC  X(0001).
  1374     05  INITI PIC  X(0001).
  1375*    -------------------------------
  1376     05  LOANNOL PIC S9(0004) COMP.
  1377     05  LOANNOF PIC  X(0001).
  1378     05  FILLER REDEFINES LOANNOF.
  1379         10  LOANNOA PIC  X(0001).
  1380     05  LOANNOI PIC  X(0008).
  1381*    -------------------------------
  1382     05  CRTLNMEL PIC S9(0004) COMP.
  1383     05  CRTLNMEF PIC  X(0001).
  1384     05  FILLER REDEFINES CRTLNMEF.
  1385         10  CRTLNMEA PIC  X(0001).
  1386     05  CRTLNMEI PIC  X(0015).
  1387*    -------------------------------
  1388     05  CRTFNMEL PIC S9(0004) COMP.
  1389     05  CRTFNMEF PIC  X(0001).
  1390     05  FILLER REDEFINES CRTFNMEF.
  1391         10  CRTFNMEA PIC  X(0001).
  1392     05  CRTFNMEI PIC  X(0012).
  1393*    -------------------------------
  1394     05  CRTINITL PIC S9(0004) COMP.
  1395     05  CRTINITF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  27
* EL130.cbl
  1396     05  FILLER REDEFINES CRTINITF.
  1397         10  CRTINITA PIC  X(0001).
  1398     05  CRTINITI PIC  X(0001).
  1399*    -------------------------------
  1400     05  LOANBALL PIC S9(0004) COMP.
  1401     05  LOANBALF PIC  X(0001).
  1402     05  FILLER REDEFINES LOANBALF.
  1403         10  LOANBALA PIC  X(0001).
  1404     05  LOANBALI PIC  9(7)V99.
  1405*    -------------------------------
  1406     05  MANRSVL PIC S9(0004) COMP.
  1407     05  MANRSVF PIC  X(0001).
  1408     05  FILLER REDEFINES MANRSVF.
  1409         10  MANRSVA PIC  X(0001).
  1410     05  MANRSVI PIC  9(7)V99.
  1411*    -------------------------------
  1412     05  SUPVL PIC S9(0004) COMP.
  1413     05  SUPVF PIC  X(0001).
  1414     05  FILLER REDEFINES SUPVF.
  1415         10  SUPVA PIC  X(0001).
  1416     05  SUPVI PIC  X(0001).
  1417*    -------------------------------
  1418     05  PRICDL PIC S9(0004) COMP.
  1419     05  PRICDF PIC  X(0001).
  1420     05  FILLER REDEFINES PRICDF.
  1421         10  PRICDA PIC  X(0001).
  1422     05  PRICDI PIC  X(0001).
  1423*    -------------------------------
  1424     05  PRODL PIC S9(0004) COMP.
  1425     05  PRODF PIC  X(0001).
  1426     05  FILLER REDEFINES PRODF.
  1427         10  PRODA PIC  X(0001).
  1428     05  PRODI PIC  X(0008).
  1429*    -------------------------------
  1430     05  PRODCDL PIC S9(0004) COMP.
  1431     05  PRODCDF PIC  X(0001).
  1432     05  FILLER REDEFINES PRODCDF.
  1433         10  PRODCDA PIC  X(0001).
  1434     05  PRODCDI PIC  X(0001).
  1435*    -------------------------------
  1436     05  FILETOL PIC S9(0004) COMP.
  1437     05  FILETOF PIC  X(0001).
  1438     05  FILLER REDEFINES FILETOF.
  1439         10  FILETOA PIC  X(0001).
  1440     05  FILETOI PIC  X(0004).
  1441*    -------------------------------
  1442     05  PROCCDL PIC S9(0004) COMP.
  1443     05  PROCCDF PIC  X(0001).
  1444     05  FILLER REDEFINES PROCCDF.
  1445         10  PROCCDA PIC  X(0001).
  1446     05  PROCCDI PIC  X(0004).
  1447*    -------------------------------
  1448     05  RELCLML PIC S9(0004) COMP.
  1449     05  RELCLMF PIC  X(0001).
  1450     05  FILLER REDEFINES RELCLMF.
  1451         10  RELCLMA PIC  X(0001).
  1452     05  RELCLMI PIC  X(0007).
  1453*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  28
* EL130.cbl
  1454     05  PRTOPTL PIC S9(0004) COMP.
  1455     05  PRTOPTF PIC  X(0001).
  1456     05  FILLER REDEFINES PRTOPTF.
  1457         10  PRTOPTA PIC  X(0001).
  1458     05  PRTOPTI PIC  X(0001).
  1459*    -------------------------------
  1460     05  ALTPRTL PIC S9(0004) COMP.
  1461     05  ALTPRTF PIC  X(0001).
  1462     05  FILLER REDEFINES ALTPRTF.
  1463         10  ALTPRTA PIC  X(0001).
  1464     05  ALTPRTI PIC  X(0004).
  1465*    -------------------------------
  1466     05  CERTMTL PIC S9(0004) COMP.
  1467     05  CERTMTF PIC  X(0001).
  1468     05  FILLER REDEFINES CERTMTF.
  1469         10  CERTMTA PIC  X(0001).
  1470     05  CERTMTI PIC  X(0001).
  1471*    -------------------------------
  1472     05  CRTCARRL PIC S9(0004) COMP.
  1473     05  CRTCARRF PIC  X(0001).
  1474     05  FILLER REDEFINES CRTCARRF.
  1475         10  CRTCARRA PIC  X(0001).
  1476     05  CRTCARRI PIC  X(0001).
  1477*    -------------------------------
  1478     05  GROUPL PIC S9(0004) COMP.
  1479     05  GROUPF PIC  X(0001).
  1480     05  FILLER REDEFINES GROUPF.
  1481         10  GROUPA PIC  X(0001).
  1482     05  GROUPI PIC  X(0006).
  1483*    -------------------------------
  1484     05  STATEL PIC S9(0004) COMP.
  1485     05  STATEF PIC  X(0001).
  1486     05  FILLER REDEFINES STATEF.
  1487         10  STATEA PIC  X(0001).
  1488     05  STATEI PIC  X(0002).
  1489*    -------------------------------
  1490     05  ACCOUNTL PIC S9(0004) COMP.
  1491     05  ACCOUNTF PIC  X(0001).
  1492     05  FILLER REDEFINES ACCOUNTF.
  1493         10  ACCOUNTA PIC  X(0001).
  1494     05  ACCOUNTI PIC  X(0010).
  1495*    -------------------------------
  1496     05  EFFDTL PIC S9(0004) COMP.
  1497     05  EFFDTF PIC  X(0001).
  1498     05  FILLER REDEFINES EFFDTF.
  1499         10  EFFDTA PIC  X(0001).
  1500     05  EFFDTI PIC  X(0008).
  1501*    -------------------------------
  1502     05  CRTSSNL PIC S9(0004) COMP.
  1503     05  CRTSSNF PIC  X(0001).
  1504     05  FILLER REDEFINES CRTSSNF.
  1505         10  CRTSSNA PIC  X(0001).
  1506     05  CRTSSNI PIC  X(0011).
  1507*    -------------------------------
  1508     05  MEMCAPL PIC S9(0004) COMP.
  1509     05  MEMCAPF PIC  X(0001).
  1510     05  FILLER REDEFINES MEMCAPF.
  1511         10  MEMCAPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  29
* EL130.cbl
  1512     05  MEMCAPI PIC  X(0010).
  1513*    -------------------------------
  1514     05  MEMBERL PIC S9(0004) COMP.
  1515     05  MEMBERF PIC  X(0001).
  1516     05  FILLER REDEFINES MEMBERF.
  1517         10  MEMBERA PIC  X(0001).
  1518     05  MEMBERI PIC  X(0012).
  1519*    -------------------------------
  1520     05  REINCDL PIC S9(0004) COMP.
  1521     05  REINCDF PIC  X(0001).
  1522     05  FILLER REDEFINES REINCDF.
  1523         10  REINCDA PIC  X(0001).
  1524     05  REINCDI PIC  X(0001).
  1525*    -------------------------------
  1526     05  ISSAGEL PIC S9(0004) COMP.
  1527     05  ISSAGEF PIC  X(0001).
  1528     05  FILLER REDEFINES ISSAGEF.
  1529         10  ISSAGEA PIC  X(0001).
  1530     05  ISSAGEI PIC  X(0002).
  1531*    -------------------------------
  1532     05  APRL PIC S9(0004) COMP.
  1533     05  APRF PIC  X(0001).
  1534     05  FILLER REDEFINES APRF.
  1535         10  APRA PIC  X(0001).
  1536     05  APRI PIC  9(4)V9(4).
  1537*    -------------------------------
  1538     05  PMTFREQL PIC S9(0004) COMP.
  1539     05  PMTFREQF PIC  X(0001).
  1540     05  FILLER REDEFINES PMTFREQF.
  1541         10  PMTFREQA PIC  X(0001).
  1542     05  PMTFREQI PIC  99.
  1543*    -------------------------------
  1544     05  INDGRPL PIC S9(0004) COMP.
  1545     05  INDGRPF PIC  X(0001).
  1546     05  FILLER REDEFINES INDGRPF.
  1547         10  INDGRPA PIC  X(0001).
  1548     05  INDGRPI PIC  X(0001).
  1549*    -------------------------------
  1550     05  PREMTYPL PIC S9(0004) COMP.
  1551     05  PREMTYPF PIC  X(0001).
  1552     05  FILLER REDEFINES PREMTYPF.
  1553         10  PREMTYPA PIC  X(0001).
  1554     05  PREMTYPI PIC  X(0001).
  1555*    -------------------------------
  1556     05  ADDONDTL PIC S9(0004) COMP.
  1557     05  ADDONDTF PIC  X(0001).
  1558     05  FILLER REDEFINES ADDONDTF.
  1559         10  ADDONDTA PIC  X(0001).
  1560     05  ADDONDTI PIC  X(0008).
  1561*    -------------------------------
  1562     05  JNTLNMEL PIC S9(0004) COMP.
  1563     05  JNTLNMEF PIC  X(0001).
  1564     05  FILLER REDEFINES JNTLNMEF.
  1565         10  JNTLNMEA PIC  X(0001).
  1566     05  JNTLNMEI PIC  X(0015).
  1567*    -------------------------------
  1568     05  JNTFNMEL PIC S9(0004) COMP.
  1569     05  JNTFNMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  30
* EL130.cbl
  1570     05  FILLER REDEFINES JNTFNMEF.
  1571         10  JNTFNMEA PIC  X(0001).
  1572     05  JNTFNMEI PIC  X(0002).
  1573*    -------------------------------
  1574     05  JNTINITL PIC S9(0004) COMP.
  1575     05  JNTINITF PIC  X(0001).
  1576     05  FILLER REDEFINES JNTINITF.
  1577         10  JNTINITA PIC  X(0001).
  1578     05  JNTINITI PIC  X(0001).
  1579*    -------------------------------
  1580     05  JNTAGEL PIC S9(0004) COMP.
  1581     05  JNTAGEF PIC  X(0001).
  1582     05  FILLER REDEFINES JNTAGEF.
  1583         10  JNTAGEA PIC  X(0001).
  1584     05  JNTAGEI PIC  X(0002).
  1585*    -------------------------------
  1586     05  LCVDSCRL PIC S9(0004) COMP.
  1587     05  LCVDSCRF PIC  X(0001).
  1588     05  FILLER REDEFINES LCVDSCRF.
  1589         10  LCVDSCRA PIC  X(0001).
  1590     05  LCVDSCRI PIC  X(0006).
  1591*    -------------------------------
  1592     05  LCVKINDL PIC S9(0004) COMP.
  1593     05  LCVKINDF PIC  X(0001).
  1594     05  FILLER REDEFINES LCVKINDF.
  1595         10  LCVKINDA PIC  X(0001).
  1596     05  LCVKINDI PIC  X(0003).
  1597*    -------------------------------
  1598     05  LCVCDL PIC S9(0004) COMP.
  1599     05  LCVCDF PIC  X(0001).
  1600     05  FILLER REDEFINES LCVCDF.
  1601         10  LCVCDA PIC  X(0001).
  1602     05  LCVCDI PIC  X(0002).
  1603*    -------------------------------
  1604     05  LCVOTRML PIC S9(0004) COMP.
  1605     05  LCVOTRMF PIC  X(0001).
  1606     05  FILLER REDEFINES LCVOTRMF.
  1607         10  LCVOTRMA PIC  X(0001).
  1608     05  LCVOTRMI PIC  999.
  1609*    -------------------------------
  1610     05  LCVRTRML PIC S9(0004) COMP.
  1611     05  LCVRTRMF PIC  X(0001).
  1612     05  FILLER REDEFINES LCVRTRMF.
  1613         10  LCVRTRMA PIC  X(0001).
  1614     05  LCVRTRMI PIC  X(0003).
  1615*    -------------------------------
  1616     05  LCVRATEL PIC S9(0004) COMP.
  1617     05  LCVRATEF PIC  X(0001).
  1618     05  FILLER REDEFINES LCVRATEF.
  1619         10  LCVRATEA PIC  X(0001).
  1620     05  LCVRATEI PIC  9999V99.
  1621*    -------------------------------
  1622     05  LCVBENEL PIC S9(0004) COMP.
  1623     05  LCVBENEF PIC  X(0001).
  1624     05  FILLER REDEFINES LCVBENEF.
  1625         10  LCVBENEA PIC  X(0001).
  1626     05  LCVBENEI PIC  9(9)V99.
  1627*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  31
* EL130.cbl
  1628     05  LCVFORML PIC S9(0004) COMP.
  1629     05  LCVFORMF PIC  X(0001).
  1630     05  FILLER REDEFINES LCVFORMF.
  1631         10  LCVFORMA PIC  X(0001).
  1632     05  LCVFORMI PIC  X(0012).
  1633*    -------------------------------
  1634     05  LCVCNDTL PIC S9(0004) COMP.
  1635     05  LCVCNDTF PIC  X(0001).
  1636     05  FILLER REDEFINES LCVCNDTF.
  1637         10  LCVCNDTA PIC  X(0001).
  1638     05  LCVCNDTI PIC  X(0008).
  1639*    -------------------------------
  1640     05  LCVEXITL PIC S9(0004) COMP.
  1641     05  LCVEXITF PIC  X(0001).
  1642     05  FILLER REDEFINES LCVEXITF.
  1643         10  LCVEXITA PIC  X(0001).
  1644     05  LCVEXITI PIC  X(0008).
  1645*    -------------------------------
  1646     05  LCVSTATL PIC S9(0004) COMP.
  1647     05  LCVSTATF PIC  X(0001).
  1648     05  FILLER REDEFINES LCVSTATF.
  1649         10  LCVSTATA PIC  X(0001).
  1650     05  LCVSTATI PIC  X(0006).
  1651*    -------------------------------
  1652     05  ACVDSCRL PIC S9(0004) COMP.
  1653     05  ACVDSCRF PIC  X(0001).
  1654     05  FILLER REDEFINES ACVDSCRF.
  1655         10  ACVDSCRA PIC  X(0001).
  1656     05  ACVDSCRI PIC  X(0006).
  1657*    -------------------------------
  1658     05  ACVKINDL PIC S9(0004) COMP.
  1659     05  ACVKINDF PIC  X(0001).
  1660     05  FILLER REDEFINES ACVKINDF.
  1661         10  ACVKINDA PIC  X(0001).
  1662     05  ACVKINDI PIC  X(0003).
  1663*    -------------------------------
  1664     05  ACVCDL PIC S9(0004) COMP.
  1665     05  ACVCDF PIC  X(0001).
  1666     05  FILLER REDEFINES ACVCDF.
  1667         10  ACVCDA PIC  X(0001).
  1668     05  ACVCDI PIC  X(0002).
  1669*    -------------------------------
  1670     05  ACVOTRML PIC S9(0004) COMP.
  1671     05  ACVOTRMF PIC  X(0001).
  1672     05  FILLER REDEFINES ACVOTRMF.
  1673         10  ACVOTRMA PIC  X(0001).
  1674     05  ACVOTRMI PIC  999.
  1675*    -------------------------------
  1676     05  ACVRTRML PIC S9(0004) COMP.
  1677     05  ACVRTRMF PIC  X(0001).
  1678     05  FILLER REDEFINES ACVRTRMF.
  1679         10  ACVRTRMA PIC  X(0001).
  1680     05  ACVRTRMI PIC  X(0003).
  1681*    -------------------------------
  1682     05  ACVRATEL PIC S9(0004) COMP.
  1683     05  ACVRATEF PIC  X(0001).
  1684     05  FILLER REDEFINES ACVRATEF.
  1685         10  ACVRATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  32
* EL130.cbl
  1686     05  ACVRATEI PIC  9999V99.
  1687*    -------------------------------
  1688     05  ACVBENEL PIC S9(0004) COMP.
  1689     05  ACVBENEF PIC  X(0001).
  1690     05  FILLER REDEFINES ACVBENEF.
  1691         10  ACVBENEA PIC  X(0001).
  1692     05  ACVBENEI PIC  9(9)V99.
  1693*    -------------------------------
  1694     05  ACVFORML PIC S9(0004) COMP.
  1695     05  ACVFORMF PIC  X(0001).
  1696     05  FILLER REDEFINES ACVFORMF.
  1697         10  ACVFORMA PIC  X(0001).
  1698     05  ACVFORMI PIC  X(0012).
  1699*    -------------------------------
  1700     05  ACVCNDTL PIC S9(0004) COMP.
  1701     05  ACVCNDTF PIC  X(0001).
  1702     05  FILLER REDEFINES ACVCNDTF.
  1703         10  ACVCNDTA PIC  X(0001).
  1704     05  ACVCNDTI PIC  X(0008).
  1705*    -------------------------------
  1706     05  ACVEXITL PIC S9(0004) COMP.
  1707     05  ACVEXITF PIC  X(0001).
  1708     05  FILLER REDEFINES ACVEXITF.
  1709         10  ACVEXITA PIC  X(0001).
  1710     05  ACVEXITI PIC  X(0008).
  1711*    -------------------------------
  1712     05  ACVSTATL PIC S9(0004) COMP.
  1713     05  ACVSTATF PIC  X(0001).
  1714     05  FILLER REDEFINES ACVSTATF.
  1715         10  ACVSTATA PIC  X(0001).
  1716     05  ACVSTATI PIC  X(0006).
  1717*    -------------------------------
  1718     05  ERRMSG1L PIC S9(0004) COMP.
  1719     05  ERRMSG1F PIC  X(0001).
  1720     05  FILLER REDEFINES ERRMSG1F.
  1721         10  ERRMSG1A PIC  X(0001).
  1722     05  ERRMSG1I PIC  X(0072).
  1723*    -------------------------------
  1724     05  ERRMSG2L PIC S9(0004) COMP.
  1725     05  ERRMSG2F PIC  X(0001).
  1726     05  FILLER REDEFINES ERRMSG2F.
  1727         10  ERRMSG2A PIC  X(0001).
  1728     05  ERRMSG2I PIC  X(0072).
  1729*    -------------------------------
  1730     05  BCERT1L PIC S9(0004) COMP.
  1731     05  BCERT1F PIC  X(0001).
  1732     05  FILLER REDEFINES BCERT1F.
  1733         10  BCERT1A PIC  X(0001).
  1734     05  BCERT1I PIC  X(0010).
  1735*    -------------------------------
  1736     05  BSUFX1L PIC S9(0004) COMP.
  1737     05  BSUFX1F PIC  X(0001).
  1738     05  FILLER REDEFINES BSUFX1F.
  1739         10  BSUFX1A PIC  X(0001).
  1740     05  BSUFX1I PIC  X(0001).
  1741*    -------------------------------
  1742     05  BCERT2L PIC S9(0004) COMP.
  1743     05  BCERT2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  33
* EL130.cbl
  1744     05  FILLER REDEFINES BCERT2F.
  1745         10  BCERT2A PIC  X(0001).
  1746     05  BCERT2I PIC  X(0010).
  1747*    -------------------------------
  1748     05  BSUFX2L PIC S9(0004) COMP.
  1749     05  BSUFX2F PIC  X(0001).
  1750     05  FILLER REDEFINES BSUFX2F.
  1751         10  BSUFX2A PIC  X(0001).
  1752     05  BSUFX2I PIC  X(0001).
  1753*    -------------------------------
  1754     05  BCERT3L PIC S9(0004) COMP.
  1755     05  BCERT3F PIC  X(0001).
  1756     05  FILLER REDEFINES BCERT3F.
  1757         10  BCERT3A PIC  X(0001).
  1758     05  BCERT3I PIC  X(0010).
  1759*    -------------------------------
  1760     05  BSUFX3L PIC S9(0004) COMP.
  1761     05  BSUFX3F PIC  X(0001).
  1762     05  FILLER REDEFINES BSUFX3F.
  1763         10  BSUFX3A PIC  X(0001).
  1764     05  BSUFX3I PIC  X(0001).
  1765*    -------------------------------
  1766     05  BCERT4L PIC S9(0004) COMP.
  1767     05  BCERT4F PIC  X(0001).
  1768     05  FILLER REDEFINES BCERT4F.
  1769         10  BCERT4A PIC  X(0001).
  1770     05  BCERT4I PIC  X(0010).
  1771*    -------------------------------
  1772     05  BSUFX4L PIC S9(0004) COMP.
  1773     05  BSUFX4F PIC  X(0001).
  1774     05  FILLER REDEFINES BSUFX4F.
  1775         10  BSUFX4A PIC  X(0001).
  1776     05  BSUFX4I PIC  X(0001).
  1777*    -------------------------------
  1778     05  BCERT5L PIC S9(0004) COMP.
  1779     05  BCERT5F PIC  X(0001).
  1780     05  FILLER REDEFINES BCERT5F.
  1781         10  BCERT5A PIC  X(0001).
  1782     05  BCERT5I PIC  X(0010).
  1783*    -------------------------------
  1784     05  BSUFX5L PIC S9(0004) COMP.
  1785     05  BSUFX5F PIC  X(0001).
  1786     05  FILLER REDEFINES BSUFX5F.
  1787         10  BSUFX5A PIC  X(0001).
  1788     05  BSUFX5I PIC  X(0001).
  1789*    -------------------------------
  1790     05  ENTERPFL PIC S9(0004) COMP.
  1791     05  ENTERPFF PIC  X(0001).
  1792     05  FILLER REDEFINES ENTERPFF.
  1793         10  ENTERPFA PIC  X(0001).
  1794     05  ENTERPFI PIC  99.
  1795*    -------------------------------
  1796     05  PF5L PIC S9(0004) COMP.
  1797     05  PF5F PIC  X(0001).
  1798     05  FILLER REDEFINES PF5F.
  1799         10  PF5A PIC  X(0001).
  1800     05  PF5I PIC  X(0013).
  1801 01  EL130AO REDEFINES EL130AI.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  34
* EL130.cbl
  1802     05  FILLER            PIC  X(0012).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  RUNDTEO PIC  X(0008).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  RUNTIMEO PIC  99.99.
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  COMPO PIC  X(0003).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  SEQUO PIC  X(0010).
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  MAINTO PIC  X(0001).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  CLMNOO PIC  X(0007).
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  CLMCARRO PIC  X(0001).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  CLMTYPEO PIC  X(0001).
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  CERTNOO PIC  X(0010).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  SUFXO PIC  X(0001).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  PCERTNOO PIC  X(0010).
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  PSUFXO PIC  X(0001).
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  INCURO PIC  X(0008).
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  REPORTO PIC  X(0008).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  ICD1O PIC  X(0008).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  ICD2O PIC  X(0008).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  DIAGO PIC  X(0060).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  BENECDO PIC  X(0010).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  BIRTHDTO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  35
* EL130.cbl
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  SSNO PIC  X(0011).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  SEXO PIC  X(0001).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  INSTYPEO PIC  X(0001).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  LSTNMEO PIC  X(0015).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  FSTNMEO PIC  X(0012).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  INITO PIC  X(0001).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  LOANNOO PIC  X(0008).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  CRTLNMEO PIC  X(0015).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  CRTFNMEO PIC  X(0012).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  CRTINITO PIC  X(0001).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  LOANBALO PIC  ZZZZZ9.99.
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  MANRSVO PIC  Z(5)9.99.
  1896*    -------------------------------
  1897     05  FILLER            PIC  X(0003).
  1898     05  SUPVO PIC  X(0001).
  1899*    -------------------------------
  1900     05  FILLER            PIC  X(0003).
  1901     05  PRICDO PIC  X(0001).
  1902*    -------------------------------
  1903     05  FILLER            PIC  X(0003).
  1904     05  PRODO PIC  X(0008).
  1905*    -------------------------------
  1906     05  FILLER            PIC  X(0003).
  1907     05  PRODCDO PIC  X(0001).
  1908*    -------------------------------
  1909     05  FILLER            PIC  X(0003).
  1910     05  FILETOO PIC  X(0004).
  1911*    -------------------------------
  1912     05  FILLER            PIC  X(0003).
  1913     05  PROCCDO PIC  X(0004).
  1914*    -------------------------------
  1915     05  FILLER            PIC  X(0003).
  1916     05  RELCLMO PIC  X(0007).
  1917*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  36
* EL130.cbl
  1918     05  FILLER            PIC  X(0003).
  1919     05  PRTOPTO PIC  X(0001).
  1920*    -------------------------------
  1921     05  FILLER            PIC  X(0003).
  1922     05  ALTPRTO PIC  X(0004).
  1923*    -------------------------------
  1924     05  FILLER            PIC  X(0003).
  1925     05  CERTMTO PIC  X(0001).
  1926*    -------------------------------
  1927     05  FILLER            PIC  X(0003).
  1928     05  CRTCARRO PIC  X(0001).
  1929*    -------------------------------
  1930     05  FILLER            PIC  X(0003).
  1931     05  GROUPO PIC  X(0006).
  1932*    -------------------------------
  1933     05  FILLER            PIC  X(0003).
  1934     05  STATEO PIC  X(0002).
  1935*    -------------------------------
  1936     05  FILLER            PIC  X(0003).
  1937     05  ACCOUNTO PIC  X(0010).
  1938*    -------------------------------
  1939     05  FILLER            PIC  X(0003).
  1940     05  EFFDTO PIC  X(0008).
  1941*    -------------------------------
  1942     05  FILLER            PIC  X(0003).
  1943     05  CRTSSNO PIC  X(0011).
  1944*    -------------------------------
  1945     05  FILLER            PIC  X(0003).
  1946     05  MEMCAPO PIC  X(0010).
  1947*    -------------------------------
  1948     05  FILLER            PIC  X(0003).
  1949     05  MEMBERO PIC  X(0012).
  1950*    -------------------------------
  1951     05  FILLER            PIC  X(0003).
  1952     05  REINCDO PIC  X(0001).
  1953*    -------------------------------
  1954     05  FILLER            PIC  X(0003).
  1955     05  ISSAGEO PIC  X(0002).
  1956*    -------------------------------
  1957     05  FILLER            PIC  X(0003).
  1958     05  APRO PIC  9(3).9(4).
  1959*    -------------------------------
  1960     05  FILLER            PIC  X(0003).
  1961     05  PMTFREQO PIC  99.
  1962*    -------------------------------
  1963     05  FILLER            PIC  X(0003).
  1964     05  INDGRPO PIC  X(0001).
  1965*    -------------------------------
  1966     05  FILLER            PIC  X(0003).
  1967     05  PREMTYPO PIC  X(0001).
  1968*    -------------------------------
  1969     05  FILLER            PIC  X(0003).
  1970     05  ADDONDTO PIC  X(0008).
  1971*    -------------------------------
  1972     05  FILLER            PIC  X(0003).
  1973     05  JNTLNMEO PIC  X(0015).
  1974*    -------------------------------
  1975     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  37
* EL130.cbl
  1976     05  JNTFNMEO PIC  X(0002).
  1977*    -------------------------------
  1978     05  FILLER            PIC  X(0003).
  1979     05  JNTINITO PIC  X(0001).
  1980*    -------------------------------
  1981     05  FILLER            PIC  X(0003).
  1982     05  JNTAGEO PIC  X(0002).
  1983*    -------------------------------
  1984     05  FILLER            PIC  X(0003).
  1985     05  LCVDSCRO PIC  X(0006).
  1986*    -------------------------------
  1987     05  FILLER            PIC  X(0003).
  1988     05  LCVKINDO PIC  X(0003).
  1989*    -------------------------------
  1990     05  FILLER            PIC  X(0003).
  1991     05  LCVCDO PIC  X(0002).
  1992*    -------------------------------
  1993     05  FILLER            PIC  X(0003).
  1994     05  LCVOTRMO PIC  999.
  1995*    -------------------------------
  1996     05  FILLER            PIC  X(0003).
  1997     05  LCVRTRMO PIC  ZZZ.
  1998*    -------------------------------
  1999     05  FILLER            PIC  X(0003).
  2000     05  LCVRATEO PIC  ZZZ.ZZ.
  2001*    -------------------------------
  2002     05  FILLER            PIC  X(0003).
  2003     05  LCVBENEO PIC  ZZZZZZZZ.ZZ.
  2004*    -------------------------------
  2005     05  FILLER            PIC  X(0003).
  2006     05  LCVFORMO PIC  X(0012).
  2007*    -------------------------------
  2008     05  FILLER            PIC  X(0003).
  2009     05  LCVCNDTO PIC  X(0008).
  2010*    -------------------------------
  2011     05  FILLER            PIC  X(0003).
  2012     05  LCVEXITO PIC  X(0008).
  2013*    -------------------------------
  2014     05  FILLER            PIC  X(0003).
  2015     05  LCVSTATO PIC  X(0006).
  2016*    -------------------------------
  2017     05  FILLER            PIC  X(0003).
  2018     05  ACVDSCRO PIC  X(0006).
  2019*    -------------------------------
  2020     05  FILLER            PIC  X(0003).
  2021     05  ACVKINDO PIC  X(0003).
  2022*    -------------------------------
  2023     05  FILLER            PIC  X(0003).
  2024     05  ACVCDO PIC  X(0002).
  2025*    -------------------------------
  2026     05  FILLER            PIC  X(0003).
  2027     05  ACVOTRMO PIC  999.
  2028*    -------------------------------
  2029     05  FILLER            PIC  X(0003).
  2030     05  ACVRTRMO PIC  ZZZ.
  2031*    -------------------------------
  2032     05  FILLER            PIC  X(0003).
  2033     05  ACVRATEO PIC  ZZZ.ZZ.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  38
* EL130.cbl
  2034*    -------------------------------
  2035     05  FILLER            PIC  X(0003).
  2036     05  ACVBENEO PIC  ZZZZZZZZ.ZZ.
  2037*    -------------------------------
  2038     05  FILLER            PIC  X(0003).
  2039     05  ACVFORMO PIC  X(0012).
  2040*    -------------------------------
  2041     05  FILLER            PIC  X(0003).
  2042     05  ACVCNDTO PIC  X(0008).
  2043*    -------------------------------
  2044     05  FILLER            PIC  X(0003).
  2045     05  ACVEXITO PIC  X(0008).
  2046*    -------------------------------
  2047     05  FILLER            PIC  X(0003).
  2048     05  ACVSTATO PIC  X(0006).
  2049*    -------------------------------
  2050     05  FILLER            PIC  X(0003).
  2051     05  ERRMSG1O PIC  X(0072).
  2052*    -------------------------------
  2053     05  FILLER            PIC  X(0003).
  2054     05  ERRMSG2O PIC  X(0072).
  2055*    -------------------------------
  2056     05  FILLER            PIC  X(0003).
  2057     05  BCERT1O PIC  X(0010).
  2058*    -------------------------------
  2059     05  FILLER            PIC  X(0003).
  2060     05  BSUFX1O PIC  X(0001).
  2061*    -------------------------------
  2062     05  FILLER            PIC  X(0003).
  2063     05  BCERT2O PIC  X(0010).
  2064*    -------------------------------
  2065     05  FILLER            PIC  X(0003).
  2066     05  BSUFX2O PIC  X(0001).
  2067*    -------------------------------
  2068     05  FILLER            PIC  X(0003).
  2069     05  BCERT3O PIC  X(0010).
  2070*    -------------------------------
  2071     05  FILLER            PIC  X(0003).
  2072     05  BSUFX3O PIC  X(0001).
  2073*    -------------------------------
  2074     05  FILLER            PIC  X(0003).
  2075     05  BCERT4O PIC  X(0010).
  2076*    -------------------------------
  2077     05  FILLER            PIC  X(0003).
  2078     05  BSUFX4O PIC  X(0001).
  2079*    -------------------------------
  2080     05  FILLER            PIC  X(0003).
  2081     05  BCERT5O PIC  X(0010).
  2082*    -------------------------------
  2083     05  FILLER            PIC  X(0003).
  2084     05  BSUFX5O PIC  X(0001).
  2085*    -------------------------------
  2086     05  FILLER            PIC  X(0003).
  2087     05  ENTERPFO PIC  X(0002).
  2088*    -------------------------------
  2089     05  FILLER            PIC  X(0003).
  2090     05  PF5O PIC  X(0013).
  2091*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  39
* EL130.cbl
  2093*    COPY ELCDATE.
  2094******************************************************************
  2095*                                                                *
  2096*                                                                *
  2097*                            ELCDATE.                            *
  2098*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2099*                            VMOD=2.003
  2100*                                                                *
  2101*                                                                *
  2102*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2103*                 LENGTH = 200                                   *
  2104******************************************************************
  2105
  2106 01  DATE-CONVERSION-DATA.
  2107     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2108     12  DC-OPTION-CODE                PIC X.
  2109         88  BIN-TO-GREG                VALUE ' '.
  2110         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2111         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2112         88  YMD-GREG-TO-BIN            VALUE '3'.
  2113         88  MDY-GREG-TO-BIN            VALUE '4'.
  2114         88  JULIAN-TO-BIN              VALUE '5'.
  2115         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2116         88  FIND-CENTURY               VALUE '7'.
  2117         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2118         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2119         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2120         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2121         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2122         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2123         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2124         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2125         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2126         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2127         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2128         88  BIN-3-TO-GREG              VALUE 'I'.
  2129         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2130         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2131         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2132         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2133         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2134         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2135         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2136         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2137         88  THREE-CHARACTER-BIN
  2138                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2139         88  GREGORIAN-TO-BIN
  2140                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2141         88  BIN-TO-GREGORIAN
  2142                  VALUES ' ' '1' 'I' '8' 'G'.
  2143         88  JULIAN-TO-BINARY
  2144                  VALUES '5' 'C' 'E' 'F'.
  2145     12  DC-ERROR-CODE                 PIC X.
  2146         88  NO-CONVERSION-ERROR        VALUE ' '.
  2147         88  DATE-CONVERSION-ERROR
  2148                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2149         88  DATE-IS-ZERO               VALUE '1'.
  2150         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  40
* EL130.cbl
  2151         88  DATE-IS-INVALID            VALUE '3'.
  2152         88  DATE1-GREATER-DATE2        VALUE '4'.
  2153         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2154         88  DATE-INVALID-OPTION        VALUE '9'.
  2155         88  INVALID-CENTURY            VALUE 'A'.
  2156         88  ONLY-CENTURY               VALUE 'B'.
  2157         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2158         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2159     12  DC-END-OF-MONTH               PIC X.
  2160         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2161     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2162         88  USE-NORMAL-PROCESS         VALUE ' '.
  2163         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2164         88  ADJUST-UP-100-YRS          VALUE '2'.
  2165     12  FILLER                        PIC X.
  2166     12  DC-CONVERSION-DATES.
  2167         16  DC-BIN-DATE-1             PIC XX.
  2168         16  DC-BIN-DATE-2             PIC XX.
  2169         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2170         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2171                       DC-GREG-DATE-1-EDIT.
  2172             20  DC-EDIT1-MONTH        PIC 99.
  2173             20  SLASH1-1              PIC X.
  2174             20  DC-EDIT1-DAY          PIC 99.
  2175             20  SLASH1-2              PIC X.
  2176             20  DC-EDIT1-YEAR         PIC 99.
  2177         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2178         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2179                     DC-GREG-DATE-2-EDIT.
  2180             20  DC-EDIT2-MONTH        PIC 99.
  2181             20  SLASH2-1              PIC X.
  2182             20  DC-EDIT2-DAY          PIC 99.
  2183             20  SLASH2-2              PIC X.
  2184             20  DC-EDIT2-YEAR         PIC 99.
  2185         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2186         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2187                     DC-GREG-DATE-1-YMD.
  2188             20  DC-YMD-YEAR           PIC 99.
  2189             20  DC-YMD-MONTH          PIC 99.
  2190             20  DC-YMD-DAY            PIC 99.
  2191         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2192         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2193                      DC-GREG-DATE-1-MDY.
  2194             20  DC-MDY-MONTH          PIC 99.
  2195             20  DC-MDY-DAY            PIC 99.
  2196             20  DC-MDY-YEAR           PIC 99.
  2197         16  DC-GREG-DATE-1-ALPHA.
  2198             20  DC-ALPHA-MONTH        PIC X(10).
  2199             20  DC-ALPHA-DAY          PIC 99.
  2200             20  FILLER                PIC XX.
  2201             20  DC-ALPHA-CENTURY.
  2202                 24 DC-ALPHA-CEN-N     PIC 99.
  2203             20  DC-ALPHA-YEAR         PIC 99.
  2204         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2205         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2206         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2207         16  DC-JULIAN-DATE            PIC 9(05).
  2208         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  41
* EL130.cbl
  2209                                       PIC 9(05).
  2210         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2211             20  DC-JULIAN-YEAR        PIC 99.
  2212             20  DC-JULIAN-DAYS        PIC 999.
  2213         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2214         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2215         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2216     12  DATE-CONVERSION-VARIBLES.
  2217         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2218         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2219             20  FILLER                PIC 9(3).
  2220             20  HOLD-CEN-1-CCYY.
  2221                 24  HOLD-CEN-1-CC     PIC 99.
  2222                 24  HOLD-CEN-1-YY     PIC 99.
  2223             20  HOLD-CEN-1-MO         PIC 99.
  2224             20  HOLD-CEN-1-DA         PIC 99.
  2225         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2226             20  HOLD-CEN-1-R-MO       PIC 99.
  2227             20  HOLD-CEN-1-R-DA       PIC 99.
  2228             20  HOLD-CEN-1-R-CCYY.
  2229                 24  HOLD-CEN-1-R-CC   PIC 99.
  2230                 24  HOLD-CEN-1-R-YY   PIC 99.
  2231             20  FILLER                PIC 9(3).
  2232         16  HOLD-CENTURY-1-X.
  2233             20  FILLER                PIC X(3)  VALUE SPACES.
  2234             20  HOLD-CEN-1-X-CCYY.
  2235                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2236                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2237             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2238             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2239         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2240             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2241             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2242             20  HOLD-CEN-1-R-X-CCYY.
  2243                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2244                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2245             20  FILLER                PIC XXX.
  2246         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2247         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2248         16  DC-JULIAN-DATE-1          PIC 9(07).
  2249         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2250             20  DC-JULIAN-1-CCYY.
  2251                 24  DC-JULIAN-1-CC    PIC 99.
  2252                 24  DC-JULIAN-1-YR    PIC 99.
  2253             20  DC-JULIAN-DA-1        PIC 999.
  2254         16  DC-JULIAN-DATE-2          PIC 9(07).
  2255         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2256             20  DC-JULIAN-2-CCYY.
  2257                 24  DC-JULIAN-2-CC    PIC 99.
  2258                 24  DC-JULIAN-2-YR    PIC 99.
  2259             20  DC-JULIAN-DA-2        PIC 999.
  2260         16  DC-GREG-DATE-A-EDIT.
  2261             20  DC-EDITA-MONTH        PIC 99.
  2262             20  SLASHA-1              PIC X VALUE '/'.
  2263             20  DC-EDITA-DAY          PIC 99.
  2264             20  SLASHA-2              PIC X VALUE '/'.
  2265             20  DC-EDITA-CCYY.
  2266                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  42
* EL130.cbl
  2267                 24  DC-EDITA-YEAR     PIC 99.
  2268         16  DC-GREG-DATE-B-EDIT.
  2269             20  DC-EDITB-MONTH        PIC 99.
  2270             20  SLASHB-1              PIC X VALUE '/'.
  2271             20  DC-EDITB-DAY          PIC 99.
  2272             20  SLASHB-2              PIC X VALUE '/'.
  2273             20  DC-EDITB-CCYY.
  2274                 24  DC-EDITB-CENT     PIC 99.
  2275                 24  DC-EDITB-YEAR     PIC 99.
  2276         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2277         16  DC-GREG-DATE-CYMD-R REDEFINES
  2278                              DC-GREG-DATE-CYMD.
  2279             20  DC-CYMD-CEN           PIC 99.
  2280             20  DC-CYMD-YEAR          PIC 99.
  2281             20  DC-CYMD-MONTH         PIC 99.
  2282             20  DC-CYMD-DAY           PIC 99.
  2283         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2284         16  DC-GREG-DATE-MDCY-R REDEFINES
  2285                              DC-GREG-DATE-MDCY.
  2286             20  DC-MDCY-MONTH         PIC 99.
  2287             20  DC-MDCY-DAY           PIC 99.
  2288             20  DC-MDCY-CEN           PIC 99.
  2289             20  DC-MDCY-YEAR          PIC 99.
  2290    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2291        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2292    12  DC-EL310-DATE                  PIC X(21).
  2293    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  43
* EL130.cbl
  2295*    COPY ELCCALC.
  2296******************************************************************
  2297*                                                                *
  2298*                           ELCCALC.                            *
  2299*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2300*                            VMOD=2.025                          *
  2301*                                                                *
  2302*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  2303*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  2304*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  2305*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  2306*                                                                *
  2307*  PASSED TO ELRTRM                                              *
  2308*  -----------------                                             *
  2309*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  2310*  ORIGINAL TERM                                                 *
  2311*  BEGINNING DATE                                                *
  2312*  ENDING DATE                                                   *
  2313*  COMPANY I.D.                                                  *
  2314*  ACCOUNT MASTER USER FIELD                                     *
  2315*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  2316*  FREE LOOK DAYS                                                *
  2317*                                                                *
  2318*  RETURNED FROM ELRTRM                                          *
  2319*  ---------------------                                         *
  2320*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  2321*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  2322*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  2323*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  2324*----------------------------------------------------------------*
  2325*  PASSED TO ELRAMT                                              *
  2326*  ----------------                                              *
  2327*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  2328*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2329*  ORIGINAL AMOUNT                                               *
  2330*  ALTERNATE BENEFIT (BALLON)                                    *
  2331*  A.P.R. - NET PAY ONLY                                         *
  2332*  METHOD
  2333*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  2334*  COMPANY I.D.                                                  *
  2335*  BENEFIT TYPE                                                  *
  2336*                                                                *
  2337*  RETURNED FROM ELRAMT                                          *
  2338*  --------------------                                          *
  2339*  REMAINING AMOUNT 1 - CURRENT                                  *
  2340*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  2341*  REMAINING AMOUNT FACTOR
  2342*----------------------------------------------------------------*
  2343*  PASSED TO ELRESV                                              *
  2344*  -----------------                                             *
  2345*  CERTIFICATE EFFECTIVE DATE                                    *
  2346*  VALUATION DATE                                                *
  2347*  PAID THRU DATE                                                *
  2348*  BENEFIT                                                       *
  2349*  INCURRED DATE                                                 *
  2350*  REPORTED DATE                                                 *
  2351*  ISSUE AGE                                                     *
  2352*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  44
* EL130.cbl
  2353*  CDT PERCENT                                                   *
  2354*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  2355* *CLAIM TYPE (LIFE, A/H)                                        *
  2356* *REMAINING BENEFIT (FROM ELRAMT)                               *
  2357* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  2358*                                                                *
  2359*  RETURNED FROM ELRESV                                          *
  2360*  --------------------                                          *
  2361*  CDT TABLE USED                                                *
  2362*  CDT FACTOR USED                                               *
  2363*  PAY TO CURRENT RESERVE                                        *
  2364*  I.B.N.R. - A/H ONLY                                           *
  2365*  FUTURE (ACCRUED) AH ONLY                                      *
  2366*----------------------------------------------------------------*
  2367*  PASSED TO ELRATE                                              *
  2368*  ----------------                                              *
  2369*  CERT ISSUE DATE                                               *
  2370*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2371*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2372*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  2373*  STATE CODE (CLIENT DEFINED)                                   *
  2374*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2375*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2376*  DEVIATION CODE                                                *
  2377*  ISSUE AGE                                                     *
  2378*  ORIGINAL BENEFIT AMOUNT                                       *
  2379*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2380*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  2381*  BENEFIT KIND (LIFE OR A/H)                                    *
  2382*  A.P.R.                                                        *
  2383*  METHOD
  2384*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2385*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2386*  COMPANY I.D. (3 CHARACTER)                                    *
  2387*  BENEFIT CODE                                                  *
  2388*  BENEFIT OVERRIDE CODE                                         *
  2389*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  2390*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  2391*  JOINT INDICATOR (CSL ONLY)                                    *
  2392*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  2393*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  2394*                                                                *
  2395*  RETURNED FROM ELRATE                                          *
  2396*  --------------------                                          *
  2397*  CALCULATED PREMIUM                                            *
  2398*  PREMIUM RATE                                                  *
  2399*  MORTALITY CODE                                                *
  2400*  MAX ATTAINED AGE                                              *
  2401*  MAX AGE                                                       *
  2402*  MAX TERM                                                      *
  2403*  MAX MONTHLY BENEFIT                                           *
  2404*  MAX TOTAL BENIFIT                                             *
  2405*  COMPOSITE RATE (OPEN-END ONLY)                                *
  2406*----------------------------------------------------------------*
  2407*  PASSED TO ELRFND                                              *
  2408*  ----------------                                              *
  2409*  CERT ISSUE DATE                                               *
  2410*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  45
* EL130.cbl
  2411*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2412*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2413*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  2414*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2415*  STATE CODE (CLIENT DEFINED)                                   *
  2416*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2417*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2418*  DEVIATION CODE                                                *
  2419*  ISSUE AGE                                                     *
  2420*  ORIGINAL BENEFIT AMOUNT                                       *
  2421*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  2422*  PROCESS TYPE (CANCEL)                                         *
  2423*  BENEFIT KIND (LIFE OR A/H)                                    *
  2424*  A.P.R.                                                        *
  2425*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  2426*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  2427*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2428*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2429*  COMPANY I.D. (3 CHARACTER)                                    *
  2430*  BENEFIT CODE                                                  *
  2431*  BENEFIT OVERRIDE CODE                                         *
  2432*                                                                *
  2433*  RETURNED FROM ELRFND                                          *
  2434*  --------------------                                          *
  2435*  CALCULATED REFUND                                             *
  2436*----------------------------------------------------------------*
  2437*  PASSED TO ELEARN                                              *
  2438*  ----------------                                              *
  2439*  CERT ISSUE DATE                                               *
  2440*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  2441*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  2442*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  2443*  STATE CODE (CLIENT DEFINED)                                   *
  2444*  STATE CODE (STANDARD P.O. ABBRV)                              *
  2445*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  2446*  DEVIATION CODE                                                *
  2447*  ISSUE AGE                                                     *
  2448*  ORIGINAL BENEFIT AMOUNT                                       *
  2449*  BENEFIT KIND (LIFE OR A/H)                                    *
  2450*  A.P.R.                                                        *
  2451*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  2452*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  2453*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  2454*  COMPANY I.D. (3 CHARACTER)                                    *
  2455*  BENEFIT CODE                                                  *
  2456*  BENEFIT OVERRIDE CODE                                         *
  2457*                                                                *
  2458*  RETURNED FROM ELEARN                                          *
  2459*  --------------------                                          *
  2460*  INDICATED  EARNINGS                                           *
  2461*----------------------------------------------------------------*
  2462*                 LENGTH = 450                                   *
  2463*                                                                *
  2464******************************************************************
  2465******************************************************************
  2466*                   C H A N G E   L O G
  2467*
  2468* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  46
* EL130.cbl
  2469*-----------------------------------------------------------------
  2470*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2471* EFFECTIVE    NUMBER
  2472*-----------------------------------------------------------------
  2473* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2474* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2475* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2476* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2477* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2478* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2479* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2480* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2481* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2482* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2483* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  2484******************************************************************
  2485
  2486 01  CALCULATION-PASS-AREA.
  2487     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  2488                                     COMP.
  2489
  2490     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  2491       88  NO-CP-ERROR                             VALUE ZERO.
  2492       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  2493                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  2494       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  2495       88  CP-ERROR-IN-DATES                       VALUE '2'.
  2496       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  2497       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  2498       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  2499       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  2500       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  2501       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  2502       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  2503       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  2504       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  2505       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  2506       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  2507       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  2508       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  2509       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  2510       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  2511
  2512     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  2513       88  NO-CP-ERROR-2                           VALUE ZERO.
  2514***********************  INPUT AREAS ****************************
  2515
  2516     12  CP-CALCULATION-AREA.
  2517         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  2518         16  CP-CERT-EFF-DT        PIC XX.
  2519         16  CP-VALUATION-DT       PIC XX.
  2520         16  CP-PAID-THRU-DT       PIC XX.
  2521         16  CP-BENEFIT-TYPE       PIC X.
  2522           88  CP-AH                               VALUE 'A' 'D'
  2523                                                   'I' 'U'.
  2524           88  CP-REDUCING-LIFE                    VALUE 'R'.
  2525           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  2526         16  CP-INCURRED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  47
* EL130.cbl
  2527         16  CP-REPORTED-DT        PIC XX.
  2528         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  2529         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  2530         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  2531                                     COMP-3.
  2532         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  2533                                     COMP-3.
  2534         16  CP-CDT-METHOD         PIC X.
  2535           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  2536           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  2537           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  2538         16  CP-CLAIM-TYPE         PIC X.
  2539           88  CP-AH-CLAIM                         VALUE 'A'.
  2540           88  CP-LIFE-CLAIM                       VALUE 'L'.
  2541         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  2542                                     COMP-3.
  2543         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  2544                                     COMP-3.
  2545         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  2546                                     COMP-3.
  2547         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  2548                                     COMP-3.
  2549         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2550                                     COMP-3.
  2551         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  2552                                     COMP-3.
  2553         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  2554                                     COMP-3.
  2555         16  CP-REM-TERM-METHOD    PIC X.
  2556           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  2557           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  2558           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  2559           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  2560           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  2561           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  2562           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  2563         16  CP-EARNING-METHOD     PIC X.
  2564           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  2565           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  2566           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  2567           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  2568           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  2569           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  2570           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  2571           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  2572           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  2573           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  2574           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2575           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2576           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2577           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2578         16  CP-PROCESS-TYPE       PIC X.
  2579           88  CP-CLAIM                            VALUE '1'.
  2580           88  CP-CANCEL                           VALUE '2'.
  2581           88  CP-ISSUE                            VALUE '3'.
  2582         16  CP-SPECIAL-CALC-CD    PIC X.
  2583           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  2584           88  CP-1-MTH-INTEREST               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  48
* EL130.cbl
  2585           88  CP-0-MTH-INTEREST               VALUE 'A'.
  2586           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  2587           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  2588           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  2589           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  2590           88  CP-FARM-PLAN                    VALUE 'F'.
  2591           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  2592           88  CP-2-MTH-INTEREST               VALUE 'I'.
  2593           88  CP-3-MTH-INTEREST               VALUE 'J'.
  2594           88  CP-4-MTH-INTEREST               VALUE 'K'.
  2595           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  2596           88  CP-MORTGAGE-REC                 VALUE 'M'.
  2597           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  2598           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  2599           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  2600           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  2601                                                     'W' 'X'.
  2602           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  2603           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  2604           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  2605           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  2606           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  2607           88  CP-SUMMARY-REC                  VALUE 'Z'.
  2608           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  2609           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  2610           88  CP-AD-D-BENEFIT                 VALUE '4'.
  2611           88  CP-CSL-METH-1                   VALUE '5'.
  2612           88  CP-CSL-METH-2                   VALUE '6'.
  2613           88  CP-CSL-METH-3                   VALUE '7'.
  2614           88  CP-CSL-METH-4                   VALUE '8'.
  2615
  2616         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  2617                                     COMP-3.
  2618         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  2619         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  2620         16  CP-STATE              PIC XX          VALUE SPACE.
  2621         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  2622         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  2623           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  2624               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  2625         16  CP-R78-OPTION         PIC X.
  2626           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  2627           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  2628
  2629         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  2630         16  CP-IBNR-RESERVE-SW    PIC X.
  2631         16  CP-CLAIM-STATUS       PIC X.
  2632         16  CP-RATE-FILE          PIC X.
  2633         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  2634                                     COMP-3.
  2635
  2636         16  CP-LIFE-OVERRIDE-CODE PIC X.
  2637         16  CP-AH-OVERRIDE-CODE   PIC X.
  2638
  2639         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  2640                                     COMP-3.
  2641         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2642                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  49
* EL130.cbl
  2643         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  2644                                     COMP-3.
  2645         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  2646                                     COMP-3.
  2647         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  2648                                     COMP-3.
  2649         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2650                                  PIC S9(7)V99 COMP-3.
  2651
  2652         16  CP-PAID-FROM-DATE     PIC X(02).
  2653         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  2654         16  CP-EXT-DAYS-CALC      PIC X.
  2655           88  CP-EXT-NO-CHG                   VALUE ' '.
  2656           88  CP-EXT-CHG-LF                   VALUE '1'.
  2657           88  CP-EXT-CHG-AH                   VALUE '2'.
  2658           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  2659         16  CP-DOMICILE-STATE     PIC XX.
  2660         16  CP-CARRIER            PIC X.
  2661         16  CP-REIN-FLAG          PIC X.
  2662         16  CP-REM-TRM-CALC-OPTION PIC X.
  2663           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  2664                      '2' '3' '4' '5'.
  2665           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  2666           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  2667           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  2668           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  2669           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  2670           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  2671           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  2672           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2673         16  CP-SIG-SWITCH         PIC X.
  2674         16  CP-RATING-METHOD      PIC X.
  2675           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  2676           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  2677           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  2678           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  2679           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  2680           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  2681           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  2682           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  2683           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  2684         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  2685                                     COMP-3.
  2686         16  CP-BEN-CATEGORY       PIC X.
  2687         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2688         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2689                                   PIC S99V9(5) COMP-3.
  2690         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2691         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2692                                   PIC S99V9(5) COMP-3.
  2693         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2694         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2695         16  CP-EXPIRE-DT          PIC XX.
  2696         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2697         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2698         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2699         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2700         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  50
* EL130.cbl
  2701             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  2702             88  CP-CALC-CLP              VALUE 'C'.
  2703         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2704         16  CP-CANCEL-REASON      PIC X.
  2705         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2706         16  CP-PMT-MODE           PIC X.
  2707         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2708         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2709         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2710         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2711         16  FILLER                PIC X.
  2712
  2713***************    OUTPUT FROM ELRESV   ************************
  2714
  2715         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  2716
  2717         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  2718                                     COMP-3.
  2719         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  2720                                     COMP-3.
  2721         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  2722                                     COMP-3.
  2723         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  2724                                     COMP-3.
  2725         16  FILLER                PIC X(09).
  2726***************    OUTPUT FROM ELRTRM   *************************
  2727
  2728         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  2729                                     COMP-3.
  2730         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  2731                                     COMP-3.
  2732         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  2733                                     COMP-3.
  2734         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  2735                                     COMP-3.
  2736         16  FILLER                PIC X(12).
  2737
  2738***************    OUTPUT FROM ELRAMT   *************************
  2739
  2740         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  2741                                     COMP-3.
  2742         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  2743                                     COMP-3.
  2744         16  FILLER                PIC X(12).
  2745
  2746***************    OUTPUT FROM ELRATE   *************************
  2747
  2748         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  2749                                     COMP-3.
  2750         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  2751                                     COMP-3.
  2752         16  CP-MORTALITY-CODE     PIC X(4).
  2753         16  CP-RATE-EDIT-FLAG     PIC X.
  2754             88  CP-RATES-NEED-APR                  VALUE '1'.
  2755         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  2756                                     COMP-3.
  2757         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  2758         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  51
* EL130.cbl
  2759         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  2760                                   PIC S9(7)V99 COMP-3.
  2761         16  FILLER                PIC X(07).
  2762
  2763***************    OUTPUT FROM ELRFND   *************************
  2764
  2765         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  2766                                     COMP-3.
  2767         16  CP-REFUND-TYPE-USED   PIC X.
  2768           88  CP-R-AS-R78                         VALUE '1'.
  2769           88  CP-R-AS-PRORATA                     VALUE '2'.
  2770           88  CP-R-AS-CALIF                       VALUE '3'.
  2771           88  CP-R-AS-TEXAS                       VALUE '4'.
  2772           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  2773           88  CP-R-AS-NET-PAY                     VALUE '5'.
  2774           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  2775           88  CP-R-AS-MEAN                        VALUE '8'.
  2776           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  2777           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2778           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2779           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2780           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2781           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2782         16  FILLER                PIC X(12).
  2783
  2784***************    OUTPUT FROM ELEARN   *************************
  2785
  2786         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  2787                                     COMP-3.
  2788         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  2789                                     COMP-3.
  2790         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  2791                                     COMP-3.
  2792         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  2793                                     COMP-3.
  2794         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  2795                                     COMP-3.
  2796         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  2797                                     COMP-3.
  2798         16  CP-EARNING-TYPE-USED  PIC X.
  2799           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  2800           88  CP-E-AS-R78                         VALUE '1'.
  2801           88  CP-E-AS-PRORATA                     VALUE '2'.
  2802           88  CP-E-AS-TEXAS                       VALUE '4'.
  2803           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  2804           88  CP-E-AS-NET-PAY                     VALUE '5'.
  2805           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  2806           88  CP-E-AS-MEAN                        VALUE '8'.
  2807           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  2808         16  FILLER                PIC X(12).
  2809
  2810***************    OUTPUT FROM ELPMNT   *************************
  2811
  2812         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  2813                                     COMP-3.
  2814         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  2815                                     COMP-3.
  2816         16  FILLER                PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  52
* EL130.cbl
  2817
  2818***************   MISC WORK AREAS    *****************************
  2819         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  2820                                     COMP-3.
  2821         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  2822                                     COMP-3.
  2823         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  2824                                     COMP-3.
  2825         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  2826                                     COMP-3.
  2827         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  2828                                     COMP-3.
  2829         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  2830                                     COMP-3.
  2831         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  2832             88  OPEN-RATE-FILE                   VALUE 'O'.
  2833             88  CLOSE-RATE-FILE                  VALUE 'C'.
  2834             88  IO-ERROR                         VALUE 'E'.
  2835
  2836         16  CP-FIRST-PAY-DATE     PIC XX.
  2837
  2838         16  CP-JOINT-INDICATOR    PIC X.
  2839
  2840         16  CP-RESERVE-REMAINING-TERM
  2841                                   PIC S9(4)V9    VALUE ZERO
  2842                                     COMP-3.
  2843
  2844         16  CP-INSURED-BIRTH-DT   PIC XX.
  2845
  2846         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  2847                                     COMP-3.
  2848
  2849         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  2850                                     COMP-3.
  2851
  2852         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  2853                                     COMP-3.
  2854
  2855         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  2856                                     COMP-3.
  2857
  2858         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  2859                                     COMP-3.
  2860
  2861         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  2862                                     COMP-3.
  2863
  2864         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  2865                                     COMP-3.
  2866
  2867         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  2868             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  2869
  2870         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  2871                                     COMP-3.
  2872         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2873                                     COMP-3.
  2874         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  53
* EL130.cbl
  2875         16  cp-extra-periods      pic 9 value zeros.
  2876         16  cp-net-only-state     pic x value spaces.
  2877         16  FILLER                PIC X(13).
  2878******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  54
* EL130.cbl
  2880*    COPY ELCLOGOF.
  2881******************************************************************
  2882*                                                                *
  2883*                                                                *
  2884*                            ELCLOGOF.                           *
  2885*                            VMOD=2.001                          *
  2886*                                                                *
  2887*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2888*                                                                *
  2889******************************************************************
  2890 01  CLASIC-LOGOFF.
  2891     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2892     12  LOGOFF-TEXT.
  2893         16  FILLER          PIC X(5)    VALUE SPACES.
  2894         16  LOGOFF-MSG.
  2895             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2896             20  FILLER      PIC X       VALUE SPACES.
  2897             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2898         16  FILLER          PIC X(80)
  2899           VALUE '* YOU ARE NOW LOGGED OFF'.
  2900         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2901         16  FILLER          PIC X       VALUE QUOTE.
  2902         16  LOGOFF-SYS-MSG  PIC X(17)
  2903           VALUE 'S CLAS-IC SYSTEM '.
  2904     12  TEXT-MESSAGES.
  2905         16  UNACCESS-MSG    PIC X(29)
  2906             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2907         16  PGMIDERR-MSG    PIC X(17)
  2908             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  55
* EL130.cbl
  2910*    COPY ELCATTR.
  2911******************************************************************
  2912*                                                                *
  2913*                            ELCATTR.                            *
  2914*                            VMOD=2.001                          *
  2915*                                                                *
  2916*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2917*                                                                *
  2918*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2919*                                                                *
  2920*                   POS 1   P=PROTECTED                          *
  2921*                           U=UNPROTECTED                        *
  2922*                           S=ASKIP                              *
  2923*                   POS 2   A=ALPHA/NUMERIC                      *
  2924*                           N=NUMERIC                            *
  2925*                   POS 3   N=NORMAL                             *
  2926*                           B=BRIGHT                             *
  2927*                           D=DARK                               *
  2928*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2929*                           OF=MODIFIED DATA TAG OFF             *
  2930*                                                                *
  2931*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2932******************************************************************
  2933 01  ATTRIBUTE-LIST.
  2934     12  AL-PABOF            PIC X       VALUE 'Y'.
  2935     12  AL-PABON            PIC X       VALUE 'Z'.
  2936     12  AL-PADOF            PIC X       VALUE '%'.
  2937     12  AL-PADON            PIC X       VALUE '_'.
  2938     12  AL-PANOF            PIC X       VALUE '-'.
  2939     12  AL-PANON            PIC X       VALUE '/'.
  2940     12  AL-SABOF            PIC X       VALUE '8'.
  2941     12  AL-SABON            PIC X       VALUE '9'.
  2942     12  AL-SADOF            PIC X       VALUE '@'.
  2943     12  AL-SADON            PIC X       VALUE QUOTE.
  2944     12  AL-SANOF            PIC X       VALUE '0'.
  2945     12  AL-SANON            PIC X       VALUE '1'.
  2946     12  AL-UABOF            PIC X       VALUE 'H'.
  2947     12  AL-UABON            PIC X       VALUE 'I'.
  2948     12  AL-UADOF            PIC X       VALUE '<'.
  2949     12  AL-UADON            PIC X       VALUE '('.
  2950     12  AL-UANOF            PIC X       VALUE ' '.
  2951     12  AL-UANON            PIC X       VALUE 'A'.
  2952     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2953     12  AL-UNBON            PIC X       VALUE 'R'.
  2954     12  AL-UNDOF            PIC X       VALUE '*'.
  2955     12  AL-UNDON            PIC X       VALUE ')'.
  2956     12  AL-UNNOF            PIC X       VALUE '&'.
  2957     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  56
* EL130.cbl
  2959*    COPY ELCEMIB.
  2960******************************************************************
  2961*                                                                *
  2962*                                                                *
  2963*                            ELCEMIB.                            *
  2964*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2965*                            VMOD=2.005                          *
  2966*                                                                *
  2967*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2968*                                                                *
  2969******************************************************************
  2970 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2971     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2972     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2973     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2974     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2975     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2976     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2977     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2978     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2979     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2980         88  EMI-NO-ERRORS                    VALUE '1'.
  2981         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2982         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2983     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2984         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2985     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2986         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2987         88  EMI-AREA1-FULL                   VALUE '2'.
  2988     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2989         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2990         88  EMI-AREA2-FULL                   VALUE '2'.
  2991     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2992         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2993         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2994         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2995         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2996         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2997     12  EMI-ERROR-LINES.
  2998         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2999         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3000         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3001         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3002             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3003                 24  EMI-ERR-NUM         PIC X(4).
  3004                 24  EMI-FILLER          PIC X.
  3005                 24  EMI-SEV             PIC X.
  3006                 24  FILLER              PIC X.
  3007             20  FILLER                  PIC X(02).
  3008     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3009         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3010             20  EMI-ERROR-NUMBER    PIC X(4).
  3011             20  EMI-FILL            PIC X.
  3012             20  EMI-SEVERITY        PIC X.
  3013             20  FILLER              PIC X.
  3014             20  EMI-ERROR-TEXT.
  3015                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3016                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  57
* EL130.cbl
  3017     12  EMI-SEVERITY-SAVE           PIC X.
  3018         88  EMI-NOTE                    VALUE 'N'.
  3019         88  EMI-WARNING                 VALUE 'W'.
  3020         88  EMI-FORCABLE                VALUE 'F'.
  3021         88  EMI-FATAL                   VALUE 'X'.
  3022     12  EMI-MESSAGE-FLAG            PIC X.
  3023         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3024         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3025     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3026     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3027         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3028         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3029         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3030     12  emi-claim-no                pic x(7).
  3031     12  emi-claim-type              pic x(6).
  3032     12  FILLER                      PIC X(124)  VALUE SPACES.
  3033     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3034     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3035     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3036     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  58
* EL130.cbl
  3038*    COPY ELCJPFX.
  3039******************************************************************
  3040*                                                                *
  3041*                                                                *
  3042*                            ELCJPFX.                            *
  3043*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3044*                            VMOD=2.002                          *
  3045*                                                                *
  3046*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3047*                                                                *
  3048*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3049*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3050*        ELCNTL - CONTROL FILE                                   *
  3051*        ELMSTR - CLAIM MASTERS                                  *
  3052*        ELTRLR - ACTIVITY TRAILERS                              *
  3053*        ELCHKQ - CHECK QUE                                      *
  3054******************************************************************
  3055 01  JOURNAL-RECORD.
  3056     12  jp-date                     pic s9(5) comp-3.
  3057     12  jp-time                     pic s9(7) comp-3.
  3058     12  JP-USER-ID                  PIC X(4).
  3059     12  JP-FILE-ID                  PIC X(8).
  3060     12  JP-PROGRAM-ID               PIC X(8).
  3061     12  JP-RECORD-TYPE              PIC X.
  3062         88 JP-ADD              VALUE 'A'.
  3063         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3064         88 JP-AFTER-CHANGE     VALUE 'C'.
  3065         88 JP-DELETE           VALUE 'D'.
  3066         88 JP-GENERIC-DELETE   VALUE 'G'.
  3067         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3068         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3069     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3070     12  JP-RECORD-AREA
  3071
  3072
  3073         PIC X(512).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  59
* EL130.cbl
  3075*    COPY ELCAID.
  3076******************************************************************
  3077*                                                                *
  3078*                            ELCAID.                             *
  3079*                            VMOD=2.001                          *
  3080*                                                                *
  3081*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3082*                                                                *
  3083*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3084*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3085******************************************************************
  3086
  3087 01  DFHAID.
  3088   02  DFHNULL   PIC  X  VALUE  ' '.
  3089   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3090   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3091   02  DFHPEN    PIC  X  VALUE  '='.
  3092   02  DFHOPID   PIC  X  VALUE  'W'.
  3093   02  DFHPA1    PIC  X  VALUE  '%'.
  3094   02  DFHPA2    PIC  X  VALUE  '>'.
  3095   02  DFHPA3    PIC  X  VALUE  ','.
  3096   02  DFHPF1    PIC  X  VALUE  '1'.
  3097   02  DFHPF2    PIC  X  VALUE  '2'.
  3098   02  DFHPF3    PIC  X  VALUE  '3'.
  3099   02  DFHPF4    PIC  X  VALUE  '4'.
  3100   02  DFHPF5    PIC  X  VALUE  '5'.
  3101   02  DFHPF6    PIC  X  VALUE  '6'.
  3102   02  DFHPF7    PIC  X  VALUE  '7'.
  3103   02  DFHPF8    PIC  X  VALUE  '8'.
  3104   02  DFHPF9    PIC  X  VALUE  '9'.
  3105   02  DFHPF10   PIC  X  VALUE  ':'.
  3106   02  DFHPF11   PIC  X  VALUE  '#'.
  3107   02  DFHPF12   PIC  X  VALUE  '@'.
  3108   02  DFHPF13   PIC  X  VALUE  'A'.
  3109   02  DFHPF14   PIC  X  VALUE  'B'.
  3110   02  DFHPF15   PIC  X  VALUE  'C'.
  3111   02  DFHPF16   PIC  X  VALUE  'D'.
  3112   02  DFHPF17   PIC  X  VALUE  'E'.
  3113   02  DFHPF18   PIC  X  VALUE  'F'.
  3114   02  DFHPF19   PIC  X  VALUE  'G'.
  3115   02  DFHPF20   PIC  X  VALUE  'H'.
  3116   02  DFHPF21   PIC  X  VALUE  'I'.
  3117*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3118   02  DFHPF22   PIC  X  VALUE  '['.
  3119   02  DFHPF23   PIC  X  VALUE  '.'.
  3120   02  DFHPF24   PIC  X  VALUE  '<'.
  3121   02  DFHMSRE   PIC  X  VALUE  'X'.
  3122   02  DFHSTRF   PIC  X  VALUE  'h'.
  3123   02  DFHTRIG   PIC  X  VALUE  '"'.
  3124
  3125 01  FILLER    REDEFINES DFHAID.
  3126     12  FILLER              PIC X(8).
  3127     12  PF-VALUES           PIC X       OCCURS 12.
  3128
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  60
* EL130.cbl
  3130****************************************************************
  3131*
  3132* Copyright (c) 2007-2013 Dell Inc.
  3133* All rights reserved.
  3134*
  3135****************************************************************
  3136 01  DFHEIV.
  3137   02  DFHEIV0               PIC X(35).
  3138   02  DFHEIV1               PIC X(08).
  3139   02  DFHEIV2               PIC X(08).
  3140   02  DFHEIV3               PIC X(08).
  3141   02  DFHEIV4               PIC X(06).
  3142   02  DFHEIV5               PIC X(04).
  3143   02  DFHEIV6               PIC X(04).
  3144   02  DFHEIV7               PIC X(02).
  3145   02  DFHEIV8               PIC X(02).
  3146   02  DFHEIV9               PIC X(01).
  3147   02  DFHEIV10              PIC S9(7) COMP-3.
  3148   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3149   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3150   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3151   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3152   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3153   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3154   02  DFHEIV17              PIC X(04).
  3155   02  DFHEIV18              PIC X(04).
  3156   02  DFHEIV19              PIC X(04).
  3157   02  DFHEIV20              USAGE IS POINTER.
  3158   02  DFHEIV21              USAGE IS POINTER.
  3159   02  DFHEIV22              USAGE IS POINTER.
  3160   02  DFHEIV23              USAGE IS POINTER.
  3161   02  DFHEIV24              USAGE IS POINTER.
  3162   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3163   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3164   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3165   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3166   02  DFHEIV29              PIC S9(9) COMP SYNC.
  3167   02  DFHEIV30              PIC S9(9) COMP SYNC.
  3168   02  DFHEIV31              PIC S9(9) COMP SYNC.
  3169   02  DFHEIV32              PIC S9(4) COMP SYNC.
  3170   02  DFHEIV33              PIC S9(4) COMP SYNC.
  3171   02  DFHEIV34              PIC S9(4) COMP SYNC.
  3172   02  DFHEIV35              PIC S9(4) COMP SYNC.
  3173   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3174   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3175   02  FILLER                PIC X(02).
  3176   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3177   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3178   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3179   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3180   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3181   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  3182   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  3183 LINKAGE  SECTION.
  3184*****************************************************************
  3185*                                                               *
  3186* Copyright (c) 2007-2013 Dell Inc.                             *
  3187* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  61
* EL130.cbl
  3188*                                                               *
  3189*****************************************************************
  3190 01  dfheiblk.
  3191     02  eibtime          pic s9(7) comp-3.
  3192     02  eibdate          pic s9(7) comp-3.
  3193     02  eibtrnid         pic x(4).
  3194     02  eibtaskn         pic s9(7) comp-3.
  3195     02  eibtrmid         pic x(4).
  3196     02  dfheigdi         pic s9(4) comp.
  3197     02  eibcposn         pic s9(4) comp.
  3198     02  eibcalen         pic s9(4) comp.
  3199     02  eibaid           pic x(1).
  3200     02  eibfiller1       pic x(1).
  3201     02  eibfn            pic x(2).
  3202     02  eibfiller2       pic x(2).
  3203     02  eibrcode         pic x(6).
  3204     02  eibfiller3       pic x(2).
  3205     02  eibds            pic x(8).
  3206     02  eibreqid         pic x(8).
  3207     02  eibrsrce         pic x(8).
  3208     02  eibsync          pic x(1).
  3209     02  eibfree          pic x(1).
  3210     02  eibrecv          pic x(1).
  3211     02  eibsend          pic x(1).
  3212     02  eibatt           pic x(1).
  3213     02  eibeoc           pic x(1).
  3214     02  eibfmh           pic x(1).
  3215     02  eibcompl         pic x(1).
  3216     02  eibsig           pic x(1).
  3217     02  eibconf          pic x(1).
  3218     02  eiberr           pic x(1).
  3219     02  eibrldbk         pic x(1).
  3220     02  eiberrcd         pic x(4).
  3221     02  eibsynrb         pic x(1).
  3222     02  eibnodat         pic x(1).
  3223     02  eibfiller5       pic x(2).
  3224     02  eibresp          pic s9(8) comp.
  3225     02  eibresp2         pic s9(8) comp.
  3226     02  dfheigdj         pic s9(4) comp.
  3227     02  dfheigdk         pic s9(4) comp.
  3228
  3229 01  DFHCOMMAREA             PIC X(1024).
  3230
  3231*01 PARMLIST .
  3232*    02  FILLER              PIC S9(8)   COMP.
  3233*    02  ELMSTR-POINTER      PIC S9(8)   COMP.
  3234*    02  ELCNTL-POINTER      PIC S9(8)   COMP.
  3235*    02  ELCERT-POINTER      PIC S9(8)   COMP.
  3236*    02  ERACCT-POINTER      PIC S9(8)   COMP.
  3237*    02  ELTRLR-POINTER      PIC S9(8)   COMP.
  3238*    02  ELBENE-POINTER      PIC S9(8)   COMP.
  3239*    02  ELACTQ-POINTER      PIC S9(8)   COMP.
  3240*    02  ELARCH-POINTER      PIC S9(8)   COMP.
  3241*    02  ERREIN-POINTER      PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  62
* EL130.cbl
  3243*    COPY ELCMSTR.
  3244******************************************************************
  3245*                                                                *
  3246*                            ELCMSTR.                            *
  3247*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3248*                            VMOD=2.012                          *
  3249*                                                                *
  3250*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3251*                                                                *
  3252*   FILE TYPE = VSAM,KSDS                                        *
  3253*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3254*                                                                *
  3255*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3256*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3257*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3258*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3259*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3260*                                                 RKP=75,LEN=21  *
  3261*                                                                *
  3262*   **** NOTE ****                                               *
  3263*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3264*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3265*                                                                *
  3266*   LOG = YES                                                    *
  3267*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3268******************************************************************
  3269*                   C H A N G E   L O G
  3270*
  3271* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3272*-----------------------------------------------------------------
  3273*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3274* EFFECTIVE    NUMBER
  3275*-----------------------------------------------------------------
  3276* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3277* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3278* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3279* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3280* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3281* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  3282******************************************************************
  3283 01  CLAIM-MASTER.
  3284     12  CL-RECORD-ID                PIC XX.
  3285         88  VALID-CL-ID         VALUE 'CL'.
  3286
  3287     12  CL-CONTROL-PRIMARY.
  3288         16  CL-COMPANY-CD           PIC X.
  3289         16  CL-CARRIER              PIC X.
  3290         16  CL-CLAIM-NO             PIC X(7).
  3291         16  CL-CERT-NO.
  3292             20  CL-CERT-PRIME       PIC X(10).
  3293             20  CL-CERT-SFX         PIC X.
  3294
  3295     12  CL-CONTROL-BY-NAME.
  3296         16  CL-COMPANY-CD-A1        PIC X.
  3297         16  CL-INSURED-LAST-NAME    PIC X(15).
  3298         16  CL-INSURED-NAME.
  3299             20  CL-INSURED-1ST-NAME PIC X(12).
  3300             20  CL-INSURED-MID-INIT PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  63
* EL130.cbl
  3301
  3302     12  CL-CONTROL-BY-SSN.
  3303         16  CL-COMPANY-CD-A2        PIC X.
  3304         16  CL-SOC-SEC-NO.
  3305             20  CL-SSN-STATE        PIC XX.
  3306             20  CL-SSN-ACCOUNT      PIC X(6).
  3307             20  CL-SSN-LN3          PIC X(3).
  3308
  3309     12  CL-CONTROL-BY-CERT-NO.
  3310         16  CL-COMPANY-CD-A4        PIC X.
  3311         16  CL-CERT-NO-A4.
  3312             20  CL-CERT-A4-PRIME    PIC X(10).
  3313             20  CL-CERT-A4-SFX      PIC X.
  3314
  3315     12  CL-CONTROL-BY-CCN.
  3316         16  CL-COMPANY-CD-A5        PIC X.
  3317         16  CL-CCN-A5.
  3318             20  CL-CCN.
  3319                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3320                 24  CL-CCN-PRIME-A5 PIC X(12).
  3321             20  CL-CCN-FILLER-A5    PIC X(4).
  3322
  3323     12  CL-INSURED-PROFILE-DATA.
  3324         16  CL-INSURED-BIRTH-DT     PIC XX.
  3325         16  CL-INSURED-SEX-CD       PIC X.
  3326             88  INSURED-IS-MALE        VALUE 'M'.
  3327             88  INSURED-IS-FEMALE      VALUE 'F'.
  3328             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3329         16  CL-INSURED-OCC-CD       PIC X(6).
  3330         16  FILLER                  PIC X(5).
  3331
  3332     12  CL-PROCESSING-INFO.
  3333         16  CL-PROCESSOR-ID         PIC X(4).
  3334         16  CL-CLAIM-STATUS         PIC X.
  3335             88  CLAIM-IS-OPEN          VALUE 'O'.
  3336             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3337         16  CL-CLAIM-TYPE           PIC X.
  3338*            88  AH-CLAIM               VALUE 'A'.
  3339*            88  LIFE-CLAIM             VALUE 'L'.
  3340*            88  PROPERTY-CLAIM         VALUE 'P'.
  3341*            88  IUI-CLAIM              VALUE 'I'.
  3342*            88  GAP-CLAIM              VALUE 'G'.
  3343*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3344         16  CL-CLAIM-PREM-TYPE      PIC X.
  3345             88  SINGLE-PREMIUM         VALUE '1'.
  3346             88  O-B-COVERAGE           VALUE '2'.
  3347             88  OPEN-END-COVERAGE      VALUE '3'.
  3348         16  CL-INCURRED-DT          PIC XX.
  3349         16  CL-REPORTED-DT          PIC XX.
  3350         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3351         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3352         16  CL-LAST-PMT-DT          PIC XX.
  3353         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3354         16  CL-PAID-THRU-DT         PIC XX.
  3355         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3356         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3357         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3358         16  CL-PMT-CALC-METHOD      PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  64
* EL130.cbl
  3359             88  CL-360-DAY-YR          VALUE '1'.
  3360             88  CL-365-DAY-YR          VALUE '2'.
  3361             88  CL-FULL-MONTHS         VALUE '3'.
  3362         16  CL-CAUSE-CD             PIC X(6).
  3363
  3364         16  CL-PRIME-CERT-NO.
  3365             20  CL-PRIME-CERT-PRIME PIC X(10).
  3366             20  CL-PRIME-CERT-SFX   PIC X.
  3367
  3368         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3369             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3370             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3371
  3372         16  CL-MICROFILM-NO         PIC X(10).
  3373         16  FILLER REDEFINES CL-MICROFILM-NO.
  3374             20  CL-BENEFIT-PERIOD   PIC 99.
  3375             20  FILLER              PIC X(8).
  3376         16  CL-PROG-FORM-TYPE       PIC X.
  3377         16  CL-LAST-ADD-ON-DT       PIC XX.
  3378
  3379         16  CL-LAST-REOPEN-DT       PIC XX.
  3380         16  CL-LAST-CLOSE-DT        PIC XX.
  3381         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3382             88  FINAL-PAID             VALUE '1'.
  3383             88  CLAIM-DENIED           VALUE '2'.
  3384             88  AUTO-CLOSE             VALUE '3'.
  3385             88  MANUAL-CLOSE           VALUE '4'.
  3386             88  BENEFITS-CHANGED       VALUE 'C'.
  3387             88  SETUP-ERRORS           VALUE 'E'.
  3388         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3389         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3390         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3391             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3392         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3393         16  FILLER                  PIC X.
  3394
  3395     12  CL-CERTIFICATE-DATA.
  3396         16  CL-CERT-ORIGIN          PIC X.
  3397             88  CERT-WAS-ONLINE        VALUE '1'.
  3398             88  CERT-WAS-CREATED       VALUE '2'.
  3399             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3400         16  CL-CERT-KEY-DATA.
  3401             20  CL-CERT-CARRIER     PIC X.
  3402             20  CL-CERT-GROUPING    PIC X(6).
  3403             20  CL-CERT-STATE       PIC XX.
  3404             20  CL-CERT-ACCOUNT.
  3405                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3406                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3407             20  CL-CERT-EFF-DT      PIC XX.
  3408
  3409     12  CL-STATUS-CONTROLS.
  3410         16  CL-PRIORITY-CD          PIC X.
  3411             88  CONFIDENTIAL-DATA      VALUE '8'.
  3412             88  HIGHEST-PRIORITY       VALUE '9'.
  3413         16  CL-SUPV-ATTN-CD         PIC X.
  3414             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3415             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3416         16  CL-PURGED-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  65
* EL130.cbl
  3417         16  CL-RESTORED-DT          PIC XX.
  3418         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3419         16  CL-NEXT-RESEND-DT       PIC XX.
  3420         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3421         16  CL-CRITICAL-PERIOD      PIC 99.
  3422*        16  FILLER                  PIC XX.
  3423         16  CL-LAST-MAINT-DT        PIC XX.
  3424         16  CL-LAST-MAINT-USER      PIC X(4).
  3425         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3426         16  CL-LAST-MAINT-TYPE      PIC X.
  3427             88  CLAIM-SET-UP           VALUE ' '.
  3428             88  PAYMENT-MADE           VALUE '1'.
  3429             88  LETTER-SENT            VALUE '2'.
  3430             88  MASTER-WAS-ALTERED     VALUE '3'.
  3431             88  MASTER-WAS-RESTORED    VALUE '4'.
  3432             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3433             88  FILE-CONVERTED         VALUE '6'.
  3434             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3435             88  ERROR-CORRECTION       VALUE 'E'.
  3436         16  CL-RELATED-CLAIM-NO     PIC X(7).
  3437         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  3438         16  CL-BENEFICIARY          PIC X(10).
  3439         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  3440         16  CL-DENIAL-TYPE          PIC X.
  3441             88  CL-TYPE-DENIAL          VALUE '1'.
  3442             88  CL-TYPE-RESCISSION      VALUE '2'.
  3443             88  CL-TYPE-REFORMATION     VALUE '3'.
  3444             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  3445             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  3446         16  CL-NO-OF-EXTENSIONS     PIC 99.
  3447         16  filler                  pic x(3).
  3448*        16  CL-CRIT-PER-RECURRENT   PIC X.
  3449*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  3450*        16  CL-RTW-DT               PIC XX.
  3451
  3452     12  CL-TRAILER-CONTROLS.
  3453         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  3454             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  3455             88  CL-LAST-TRL-AVAIL      VALUE +100.
  3456             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  3457         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  3458         16  FILLER                  PIC XX.
  3459         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  3460         16  CL-ADDRESS-TRAILER-CNT.
  3461             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  3462                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  3463             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  3464                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  3465             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  3466                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  3467             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  3468                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  3469             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  3470                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  3471             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  3472                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  3473             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  3474                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  66
* EL130.cbl
  3475
  3476     12  CL-CV-REFERENCE-NO.
  3477         16  CL-CV-REFNO-PRIME       PIC X(18).
  3478         16  CL-CV-REFNO-SFX         PIC XX.
  3479
  3480     12  CL-FILE-LOCATION            PIC X(4).
  3481
  3482     12  CL-PROCESS-ERRORS.
  3483         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  3484             88  NO-FATAL-ERRORS        VALUE ZERO.
  3485         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  3486             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  3487
  3488     12  CL-PRODUCT-CD               PIC X.
  3489
  3490     12  CL-CURRENT-KEY-DATA.
  3491         16  CL-CURRENT-CARRIER      PIC X.
  3492         16  CL-CURRENT-GROUPING     PIC X(6).
  3493         16  CL-CURRENT-STATE        PIC XX.
  3494         16  CL-CURRENT-ACCOUNT      PIC X(10).
  3495
  3496     12  CL-ASSOCIATES               PIC X.
  3497         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  3498         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  3499         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  3500         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  3501
  3502     12  CL-ACTIVITY-CODE            PIC 99.
  3503     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  3504     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  3505
  3506     12  CL-LAPSE-REPORT-CODE        PIC 9.
  3507     12  CL-LAG-REPORT-CODE          PIC 9.
  3508     12  CL-LOAN-TYPE                PIC XX.
  3509     12  CL-LEGAL-STATE              PIC XX.
  3510
  3511     12  CL-YESNOSW                  PIC X.
  3512     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  3513         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  3514         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  3515         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  3516     12  cl-insured-type             pic x.
  3517         88  cl-claim-on-primary         value 'P'.
  3518         88  cl-claim-on-co-borrower     value 'C'.
  3519     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  67
* EL130.cbl
  3521*    COPY ELCCNTL.
  3522******************************************************************
  3523*                                                                *
  3524*                                                                *
  3525*                            ELCCNTL.                            *
  3526*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3527*                            VMOD=2.059                          *
  3528*                                                                *
  3529*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3530*                                                                *
  3531*   FILE TYPE = VSAM,KSDS                                        *
  3532*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3533*                                                                *
  3534*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3535*       ALTERNATE INDEX = NONE                                   *
  3536*                                                                *
  3537*   LOG = YES                                                    *
  3538*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3539******************************************************************
  3540*                   C H A N G E   L O G
  3541*
  3542* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3543*-----------------------------------------------------------------
  3544*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3545* EFFECTIVE    NUMBER
  3546*-----------------------------------------------------------------
  3547* 082503                   PEMA  ADD BENEFIT GROUP
  3548* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3549* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3550* 092705    2005050300006  PEMA  ADD SPP LEASES
  3551* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3552* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3553* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3554* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3555* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  3556* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  3557* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  3558* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  3559* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  3560* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3561******************************************************************
  3562*
  3563 01  CONTROL-FILE.
  3564     12  CF-RECORD-ID                       PIC XX.
  3565         88  VALID-CF-ID                        VALUE 'CF'.
  3566
  3567     12  CF-CONTROL-PRIMARY.
  3568         16  CF-COMPANY-ID                  PIC XXX.
  3569         16  CF-RECORD-TYPE                 PIC X.
  3570             88  CF-COMPANY-MASTER              VALUE '1'.
  3571             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3572             88  CF-STATE-MASTER                VALUE '3'.
  3573             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3574             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3575             88  CF-CARRIER-MASTER              VALUE '6'.
  3576             88  CF-MORTALITY-MASTER            VALUE '7'.
  3577             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3578             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  68
* EL130.cbl
  3579             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3580             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3581             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3582             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3583             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  3584             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3585             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3586             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3587             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3588         16  CF-ACCESS-CD-GENL              PIC X(4).
  3589         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3590             20  CF-PROCESSOR               PIC X(4).
  3591         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3592             20  CF-STATE-CODE              PIC XX.
  3593             20  FILLER                     PIC XX.
  3594         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3595             20  FILLER                     PIC XX.
  3596             20  CF-HI-BEN-IN-REC           PIC XX.
  3597         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3598             20  FILLER                     PIC XXX.
  3599             20  CF-CARRIER-CNTL            PIC X.
  3600         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3601             20  FILLER                     PIC XX.
  3602             20  CF-HI-TYPE-IN-REC          PIC 99.
  3603         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3604             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3605                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3606             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3607             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3608         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3609             20  FILLER                     PIC X.
  3610             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3611         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3612             20  FILLER                     PIC XX.
  3613             20  CF-MORTGAGE-PLAN           PIC XX.
  3614         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3615
  3616     12  CF-LAST-MAINT-DT                   PIC XX.
  3617     12  CF-LAST-MAINT-BY                   PIC X(4).
  3618     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3619
  3620     12  CF-RECORD-BODY                     PIC X(728).
  3621
  3622
  3623****************************************************************
  3624*             COMPANY MASTER RECORD                            *
  3625****************************************************************
  3626
  3627     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3628         16  CF-COMPANY-ADDRESS.
  3629             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3630             20  CF-CL-IN-CARE-OF           PIC X(30).
  3631             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3632             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3633             20  CF-CL-CITY-STATE           PIC X(30).
  3634             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3635             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3636         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  69
* EL130.cbl
  3637         16  CF-COMPANY-PASSWORD            PIC X(8).
  3638         16  CF-SECURITY-OPTION             PIC X.
  3639             88  ALL-SECURITY                   VALUE '1'.
  3640             88  COMPANY-VERIFY                 VALUE '2'.
  3641             88  PROCESSOR-VERIFY               VALUE '3'.
  3642             88  NO-SECURITY                    VALUE '4'.
  3643             88  ALL-BUT-TERM                   VALUE '5'.
  3644         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3645             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3646         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3647             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3648         16  CF-INFORCE-LOCATION            PIC X.
  3649             88  CERTS-ARE-ONLINE               VALUE '1'.
  3650             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3651             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3652         16  CF-LOWER-CASE-LETTERS          PIC X.
  3653         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3654             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3655             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3656             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3657             88  CF-ACCNT-CNTL                  VALUE '3'.
  3658             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3659
  3660         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3661         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3662
  3663         16  CF-LGX-CREDIT-USER             PIC X.
  3664             88  CO-IS-NOT-USER                 VALUE 'N'.
  3665             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3666
  3667         16 CF-CREDIT-CALC-CODES.
  3668             20  CF-CR-REM-TERM-CALC PIC X.
  3669               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3670               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3671               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3672               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3673               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3674               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3675               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3676             20  CF-CR-R78-METHOD           PIC X.
  3677               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3678               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3679
  3680         16  CF-CLAIM-CONTROL-COUNTS.
  3681             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3682                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3683
  3684             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3685                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3686
  3687             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3688                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3689
  3690             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3691                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3692
  3693         16  CF-CURRENT-MONTH-END           PIC XX.
  3694
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  70
* EL130.cbl
  3695         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3696             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3697             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3698             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3699             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  3700                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3701                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3702             20  CF-CO-PREM-REJECT-SW       PIC X.
  3703                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3704                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3705             20  CF-CO-REF-REJECT-SW        PIC X.
  3706                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3707                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3708
  3709         16  CF-CO-REPORTING-DT             PIC XX.
  3710         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3711         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3712           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3713           88  CF-CO-MONTH-END                  VALUE '1'.
  3714
  3715         16  CF-LGX-CLAIM-USER              PIC X.
  3716             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3717             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3718
  3719         16  CF-CREDIT-EDIT-CONTROLS.
  3720             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3721             20  CF-MIN-AGE                 PIC 99.
  3722             20  CF-DEFAULT-AGE             PIC 99.
  3723             20  CF-MIN-TERM                PIC S999      COMP-3.
  3724             20  CF-MAX-TERM                PIC S999      COMP-3.
  3725             20  CF-DEFAULT-SEX             PIC X.
  3726             20  CF-JOINT-AGE-INPUT         PIC X.
  3727                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3728             20  CF-BIRTH-DATE-INPUT        PIC X.
  3729                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3730             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3731                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3732                 88  CF-ZERO-CARRIER            VALUE '1'.
  3733                 88  CF-ZERO-GROUPING           VALUE '2'.
  3734                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3735             20  CF-EDIT-SW                 PIC X.
  3736                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3737             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3738             20  CF-CR-PR-METHOD            PIC X.
  3739               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3740               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3741             20  FILLER                     PIC X.
  3742
  3743         16  CF-CREDIT-MISC-CONTROLS.
  3744             20  CF-REIN-TABLE-SW           PIC X.
  3745                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3746             20  CF-COMP-TABLE-SW           PIC X.
  3747                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3748             20  CF-EXPERIENCE-RETENTION-AGE
  3749                                            PIC S9        COMP-3.
  3750             20  CF-CONVERSION-DT           PIC XX.
  3751             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3752             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  71
* EL130.cbl
  3753                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3754                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3755
  3756             20  CF-CR-CHECK-NO-CONTROL.
  3757                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  3758                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3759                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3760                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3761                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3762                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3763
  3764                 24  CF-CR-CHECK-COUNT       REDEFINES
  3765                     CF-CR-CHECK-COUNTER      PIC X(4).
  3766
  3767                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3768                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3769
  3770                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3771                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3772                 24  CF-MAIL-PROCESSING       PIC X.
  3773                     88  MAIL-PROCESSING          VALUE 'Y'.
  3774
  3775         16  CF-MISC-SYSTEM-CONTROL.
  3776             20  CF-SYSTEM-C                 PIC X.
  3777                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3778             20  CF-SYSTEM-D                 PIC X.
  3779                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3780             20  CF-SOC-SEC-NO-SW            PIC X.
  3781                 88  SOC-SEC-NO-USED             VALUE '1'.
  3782             20  CF-MEMBER-NO-SW             PIC X.
  3783                 88  MEMBER-NO-USED              VALUE '1'.
  3784             20  CF-TAX-ID-NUMBER            PIC X(11).
  3785             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3786             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3787                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3788                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3789                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3790                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3791             20  CF-SYSTEM-E                 PIC X.
  3792                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3793
  3794         16  CF-LGX-LIFE-USER               PIC X.
  3795             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3796             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3797
  3798         16  CF-CR-MONTH-END-DT             PIC XX.
  3799
  3800         16  CF-FILE-MAINT-DATES.
  3801             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3802                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3803             20  CF-LAST-BATCH       REDEFINES
  3804                 CF-LAST-BATCH-NO               PIC X(4).
  3805             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3806             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3807             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3808             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3809             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3810             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  72
* EL130.cbl
  3811             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3812             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3813             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3814             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3815
  3816         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3817         16  FILLER                         PIC X.
  3818
  3819         16  CF-ALT-MORT-CODE               PIC X(4).
  3820         16  CF-MEMBER-CAPTION              PIC X(10).
  3821
  3822         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3823             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3824             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3825             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3826             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3827             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3828
  3829         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3830
  3831         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3832         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3833         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3834         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3835
  3836         16  CF-AH-OVERRIDE-L1              PIC X.
  3837         16  CF-AH-OVERRIDE-L2              PIC XX.
  3838         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3839         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3840
  3841         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3842         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3843
  3844         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3845         16  CF-AR-LAST-EL860-DT            PIC XX.
  3846         16  CF-MP-MONTH-END-DT             PIC XX.
  3847
  3848         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3849         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3850             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3851
  3852         16  CF-AR-MONTH-END-DT             PIC XX.
  3853
  3854         16  CF-CRDTCRD-USER                PIC X.
  3855             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3856             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3857
  3858         16  CF-CC-MONTH-END-DT             PIC XX.
  3859
  3860         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3861
  3862         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3863             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3864             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3865             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3866         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3867         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3868         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  73
* EL130.cbl
  3869         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3870             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3871             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3872         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3873         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3874         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3875             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3876         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3877
  3878         16  CF-CL-ZIP-CODE.
  3879             20  CF-CL-ZIP-PRIME.
  3880                 24  CF-CL-ZIP-1ST          PIC X.
  3881                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3882                 24  FILLER                 PIC X(4).
  3883             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3884         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3885             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3886             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3887             20  FILLER                     PIC XXX.
  3888
  3889         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3890         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3891         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3892         16  CF-CO-OPTION-START-DATE        PIC XX.
  3893         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3894           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3895                                                      '3' '4'.
  3896           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3897           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3898           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3899           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3900           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3901           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3902
  3903         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3904
  3905         16  CF-PAYMENT-APPROVAL-LEVELS.
  3906             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3907             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3908             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3909             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3910             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3911             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3912
  3913         16  CF-END-USER-REPORTING-USER     PIC X.
  3914             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3915             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3916
  3917         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3918             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3919             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3920
  3921         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3922
  3923         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3924         16  FILLER                         PIC X.
  3925
  3926         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  74
* EL130.cbl
  3927             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3928             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3929             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3930
  3931         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3932
  3933         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3934             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3935             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3936
  3937         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3938             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3939             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3940
  3941         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3942
  3943         16  CF-CO-ACH-ID-CODE              PIC  X.
  3944             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3945             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3946             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3947         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3948         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3949         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3950         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3951         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3952         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3953         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3954         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3955         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3956                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3957         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3958                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3959
  3960         16  CF-CO-OVER-SHORT.
  3961             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3962             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3963
  3964*         16  FILLER                         PIC X(102).
  3965         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3966             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3967             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3968
  3969         16  CF-AH-APPROVAL-DAYS.
  3970             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3971             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3972             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3973             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3974
  3975         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3976
  3977         16  CF-APPROV-LEV-5.
  3978             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3979             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3980             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3981
  3982         16  FILLER                         PIC X(68).
  3983****************************************************************
  3984*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  75
* EL130.cbl
  3985****************************************************************
  3986
  3987     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3988         16  CF-PROCESSOR-NAME              PIC X(30).
  3989         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3990         16  CF-PROCESSOR-TITLE             PIC X(26).
  3991         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3992                 88  MESSAGE-YES                VALUE 'Y'.
  3993                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3994
  3995*****************************************************
  3996****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3997****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3998****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3999****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4000*****************************************************
  4001
  4002         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4003             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4004             20  CF-APPLICATION-FORCE       PIC X.
  4005             20  CF-INDIVIDUAL-APP.
  4006                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4007                     28  CF-BROWSE-APP      PIC X.
  4008                     28  CF-UPDATE-APP      PIC X.
  4009
  4010         16  CF-CURRENT-TERM-ON             PIC X(4).
  4011         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4012             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4013             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4014             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4015             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4016             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4017             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4018             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4019         16  CF-PROCESSOR-CARRIER           PIC X.
  4020             88  NO-CARRIER-SECURITY            VALUE ' '.
  4021         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4022             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4023         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4024             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4025         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4026             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4027
  4028         16  CF-PROC-SYS-ACCESS-SW.
  4029             20  CF-PROC-CREDIT-CLAIMS-SW.
  4030                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4031                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4032                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4033                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4034             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4035                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4036                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4037             20  CF-PROC-LIFE-GNRLDGR-SW.
  4038                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4039                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4040                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4041                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4042             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  76
* EL130.cbl
  4043                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4044                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4045         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4046             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4047             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4048         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4049
  4050         16  CF-APPROVAL-LEVEL                  PIC X.
  4051             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4052             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4053             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4054             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4055             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4056
  4057         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4058
  4059         16  CF-LANGUAGE-TYPE                   PIC X.
  4060             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4061             88  CF-LANG-IS-FR                      VALUE 'F'.
  4062
  4063         16  CF-CSR-IND                         PIC X.
  4064         16  FILLER                             PIC X(239).
  4065
  4066****************************************************************
  4067*             PROCESSOR/REMINDERS RECORD                       *
  4068****************************************************************
  4069
  4070     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4071         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4072             20  CF-START-REMIND-DT         PIC XX.
  4073             20  CF-END-REMIND-DT           PIC XX.
  4074             20  CF-REMINDER-TEXT           PIC X(50).
  4075         16  FILLER                         PIC X(296).
  4076
  4077
  4078****************************************************************
  4079*             STATE MASTER RECORD                              *
  4080****************************************************************
  4081
  4082     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4083         16  CF-STATE-ABBREVIATION          PIC XX.
  4084         16  CF-STATE-NAME                  PIC X(25).
  4085         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4086         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4087             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4088             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4089             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4090             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4091                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4092                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4093             20  CF-ST-PREM-REJECT-SW       PIC X.
  4094                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4095                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4096             20  CF-ST-REF-REJECT-SW        PIC X.
  4097                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4098                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4099         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4100         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  77
* EL130.cbl
  4101         16  CF-ST-REFUND-RULES.
  4102             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4103             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4104             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4105         16  CF-ST-FST-PMT-EXTENSION.
  4106             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4107             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4108                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4109                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4110                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4111                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4112         16  CF-ST-STATE-CALL.
  4113             20  CF-ST-CALL-UNEARNED        PIC X.
  4114             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4115             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4116         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4117             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4118             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4119         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4120         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4121         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4122         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4123         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4124         16  FILLER                         PIC X.
  4125         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4126             20  CF-ST-BENEFIT-CD           PIC XX.
  4127             20  CF-ST-BENEFIT-KIND         PIC X.
  4128                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4129                 88  CF-ST-AH-KIND              VALUE 'A'.
  4130             20  CF-ST-REM-TERM-CALC        PIC X.
  4131                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4132                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4133                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4134                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4135                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4136                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4137                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4138                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4139
  4140             20  CF-ST-REFUND-CALC          PIC X.
  4141                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4142                 88  ST-REFD-BY-R78             VALUE '1'.
  4143                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4144                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4145                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4146                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4147                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4148                 88  ST-REFD-UTAH               VALUE '7'.
  4149                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4150                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4151                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4152
  4153             20  CF-ST-EARNING-CALC         PIC X.
  4154                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4155                 88  ST-EARN-BY-R78             VALUE '1'.
  4156                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4157                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4158                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  78
* EL130.cbl
  4159                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4160                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4161                 88  ST-EARN-MEAN               VALUE '8'.
  4162                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4163
  4164             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4165                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4166                 88  ST-OVRD-BY-R78             VALUE '1'.
  4167                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4168                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4169                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4170                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4171                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4172                 88  ST-OVRD-MEAN               VALUE '8'.
  4173                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4174             20  cf-st-extra-periods        pic 9.
  4175*            20  FILLER                     PIC X.
  4176
  4177         16  CF-ST-COMMISSION-CAPS.
  4178             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4179             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4180             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4181             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4182         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4183                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4184
  4185         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4186
  4187         16  CF-ST-STATUTORY-INTEREST.
  4188             20  CF-ST-STAT-DATE-FROM       PIC X.
  4189                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4190                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4191             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4192             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4193             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4194             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4195             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4196
  4197         16  CF-ST-OVER-SHORT.
  4198             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4199             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4200
  4201         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4202
  4203         16  CF-ST-RT-CALC                  PIC X.
  4204
  4205         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4206         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4207         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4208         16  CF-ST-RF-LR-CALC               PIC X.
  4209         16  CF-ST-RF-LL-CALC               PIC X.
  4210         16  CF-ST-RF-LN-CALC               PIC X.
  4211         16  CF-ST-RF-AH-CALC               PIC X.
  4212         16  CF-ST-RF-CP-CALC               PIC X.
  4213*        16  FILLER                         PIC X(206).
  4214*CIDMOD         16  FILLER                         PIC X(192).
  4215         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4216             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  79
* EL130.cbl
  4217         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4218         16  CF-ST-VFY-2ND-BENE             PIC X.
  4219         16  CF-ST-CAUSAL-STATE             PIC X.
  4220         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4221         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4222         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4223             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4224         16  CF-ST-NET-ONLY-STATE           PIC X.
  4225             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4226         16  FILLER                         PIC X(181).
  4227
  4228****************************************************************
  4229*             BENEFIT MASTER RECORD                            *
  4230****************************************************************
  4231
  4232     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4233         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4234             20  CF-BENEFIT-CODE            PIC XX.
  4235             20  CF-BENEFIT-NUMERIC  REDEFINES
  4236                 CF-BENEFIT-CODE            PIC XX.
  4237             20  CF-BENEFIT-ALPHA           PIC XXX.
  4238             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4239             20  CF-BENEFIT-COMMENT         PIC X(10).
  4240
  4241             20  CF-LF-COVERAGE-TYPE        PIC X.
  4242                 88  CF-REDUCING                VALUE 'R'.
  4243                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4244
  4245             20  CF-SPECIAL-CALC-CD         PIC X.
  4246                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4247                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4248                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4249                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4250                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4251                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4252                 88  CF-FARM-PLAN               VALUE 'F'.
  4253                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4254                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4255                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4256                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4257                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4258                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4259                 88  CF-PRUDENTIAL              VALUE 'P'.
  4260                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4261                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4262                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4263                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4264                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4265                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4266
  4267             20  CF-JOINT-INDICATOR         PIC X.
  4268                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4269
  4270*            20  FILLER                     PIC X(12).
  4271             20  cf-maximum-benefits        pic s999 comp-3.
  4272             20  FILLER                     PIC X(09).
  4273             20  CF-BENEFIT-CATEGORY        PIC X.
  4274             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  80
* EL130.cbl
  4275
  4276             20  CF-CO-REM-TERM-CALC        PIC X.
  4277                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4278                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4279                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4280                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4281                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4282
  4283             20  CF-CO-EARNINGS-CALC        PIC X.
  4284                 88  CO-EARN-BY-R78             VALUE '1'.
  4285                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4286                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4287                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4288                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4289                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4290                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4291                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4292
  4293             20  CF-CO-REFUND-CALC          PIC X.
  4294                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4295                 88  CO-REFD-BY-R78             VALUE '1'.
  4296                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4297                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4298                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4299                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4300                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4301                 88  CO-REFD-MEAN               VALUE '8'.
  4302                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4303                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4304                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4305
  4306             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4307                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4308                 88  CO-OVRD-BY-R78             VALUE '1'.
  4309                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4310                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4311                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4312                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4313                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4314                 88  CO-OVRD-MEAN               VALUE '8'.
  4315                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4316
  4317             20  CF-CO-BEN-I-G-CD           PIC X.
  4318                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4319                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4320                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4321
  4322         16  FILLER                         PIC X(304).
  4323
  4324
  4325****************************************************************
  4326*             CARRIER MASTER RECORD                            *
  4327****************************************************************
  4328
  4329     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4330         16  CF-ADDRESS-DATA.
  4331             20  CF-MAIL-TO-NAME            PIC X(30).
  4332             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  81
* EL130.cbl
  4333             20  CF-ADDRESS-LINE-1          PIC X(30).
  4334             20  CF-ADDRESS-LINE-2          PIC X(30).
  4335             20  CF-CITY-STATE              PIC X(30).
  4336             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4337             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4338
  4339         16  CF-CLAIM-NO-CONTROL.
  4340             20  CF-CLAIM-NO-METHOD         PIC X.
  4341                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4342                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4343                 88  CLAIM-NO-SEQ               VALUE '3'.
  4344                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4345             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4346                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4347                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4348                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4349
  4350         16  CF-CHECK-NO-CONTROL.
  4351             20  CF-CHECK-NO-METHOD         PIC X.
  4352                 88  CHECK-NO-MANUAL            VALUE '1'.
  4353                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4354                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4355                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4356             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4357                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4358
  4359         16  CF-DOMICILE-STATE              PIC XX.
  4360
  4361         16  CF-EXPENSE-CONTROLS.
  4362             20  CF-EXPENSE-METHOD          PIC X.
  4363                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4364                 88  DOLLARS-PER-PMT            VALUE '2'.
  4365                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4366                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4367             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4368             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4369
  4370         16  CF-CORRESPONDENCE-CONTROL.
  4371             20  CF-LETTER-RESEND-OPT       PIC X.
  4372                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4373                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4374             20  FILLER                     PIC X(4).
  4375
  4376         16  CF-RESERVE-CONTROLS.
  4377             20  CF-MANUAL-SW               PIC X.
  4378                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4379             20  CF-FUTURE-SW               PIC X.
  4380                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4381             20  CF-PTC-SW                  PIC X.
  4382                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4383             20  CF-IBNR-SW                 PIC X.
  4384                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4385             20  CF-PTC-LF-SW               PIC X.
  4386                 88  CF-LF-PTC-USED             VALUE '1'.
  4387             20  CF-CDT-ACCESS-METHOD       PIC X.
  4388                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4389                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4390                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  82
* EL130.cbl
  4391             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4392
  4393         16  CF-CLAIM-CALC-METHOD           PIC X.
  4394             88  360-PLUS-MONTHS                VALUE '1'.
  4395             88  365-PLUS-MONTHS                VALUE '2'.
  4396             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4397             88  360-DAILY                      VALUE '4'.
  4398             88  365-DAILY                      VALUE '5'.
  4399
  4400         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4401         16  FILLER                         PIC X(11).
  4402
  4403         16  CF-LIMIT-AMOUNTS.
  4404             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4405             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4406             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4407             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4408             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4409             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4410             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4411             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4412             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4413             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4414
  4415         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4416         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4417         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4418
  4419         16  CF-ZIP-CODE.
  4420             20  CF-ZIP-PRIME.
  4421                 24  CF-ZIP-1ST             PIC X.
  4422                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4423                 24  FILLER                 PIC X(4).
  4424             20  CF-ZIP-PLUS4               PIC X(4).
  4425         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4426             20  CF-CAN-POSTAL-1            PIC XXX.
  4427             20  CF-CAN-POSTAL-2            PIC XXX.
  4428             20  FILLER                     PIC XXX.
  4429
  4430         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4431         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4432         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4433
  4434         16  CF-RATING-SWITCH               PIC X.
  4435             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4436             88  CF-NO-RATING                   VALUE 'N'.
  4437
  4438         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4439
  4440         16  CF-CARRIER-OVER-SHORT.
  4441             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4442             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4443
  4444         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4445         16  CF-SECPAY-SWITCH               PIC X.
  4446             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4447             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4448         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  83
* EL130.cbl
  4449         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  4450         16  FILLER                         PIC X(444).
  4451*        16  FILLER                         PIC X(452).
  4452
  4453
  4454****************************************************************
  4455*             MORTALITY MASTER RECORD                          *
  4456****************************************************************
  4457
  4458     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4459         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4460                                INDEXED BY CF-MORT-NDX.
  4461             20  CF-MORT-TABLE              PIC X(5).
  4462             20  CF-MORT-TABLE-TYPE         PIC X.
  4463                 88  CF-MORT-JOINT              VALUE 'J'.
  4464                 88  CF-MORT-SINGLE             VALUE 'S'.
  4465                 88  CF-MORT-COMBINED           VALUE 'C'.
  4466                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4467                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4468             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4469             20  CF-MORT-AGE-METHOD         PIC XX.
  4470                 88  CF-AGE-LAST                VALUE 'AL'.
  4471                 88  CF-AGE-NEAR                VALUE 'AN'.
  4472             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4473             20  CF-MORT-ADJUSTMENT-DIRECTION
  4474                                            PIC X.
  4475                 88  CF-MINUS                   VALUE '-'.
  4476                 88  CF-PLUS                    VALUE '+'.
  4477             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4478             20  CF-MORT-JOINT-CODE         PIC X.
  4479                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4480             20  CF-MORT-PC-Q               PIC X.
  4481                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4482             20  CF-MORT-TABLE-CODE         PIC X(4).
  4483             20  CF-MORT-COMMENTS           PIC X(15).
  4484             20  FILLER                     PIC X(14).
  4485
  4486         16  FILLER                         PIC X(251).
  4487
  4488
  4489****************************************************************
  4490*             BUSSINESS TYPE MASTER RECORD                     *
  4491****************************************************************
  4492
  4493     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4494* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4495* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4496* AND RECORD 05 IS TYPES 81-99
  4497         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4498             20  CF-BUSINESS-TITLE          PIC  X(19).
  4499             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4500                                            PIC S9V9(4) COMP-3.
  4501             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4502             20  FILLER                     PIC  X.
  4503         16  FILLER                         PIC  X(248).
  4504
  4505
  4506****************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  84
* EL130.cbl
  4507*             TERMINAL MASTER RECORD                           *
  4508****************************************************************
  4509
  4510     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4511
  4512         16  CF-COMPANY-TERMINALS.
  4513             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4514                                  PIC X(4).
  4515         16  FILLER               PIC X(248).
  4516
  4517
  4518****************************************************************
  4519*             LIFE EDIT MASTER RECORD                          *
  4520****************************************************************
  4521
  4522     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4523         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4524             20  CF-LIFE-CODE-IN            PIC XX.
  4525             20  CF-LIFE-CODE-OUT           PIC XX.
  4526         16  FILLER                         PIC X(248).
  4527
  4528
  4529****************************************************************
  4530*             AH EDIT MASTER RECORD                            *
  4531****************************************************************
  4532
  4533     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4534         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4535             20  CF-AH-CODE-IN              PIC XXX.
  4536             20  CF-AH-CODE-OUT             PIC XX.
  4537         16  FILLER                         PIC X(248).
  4538
  4539
  4540****************************************************************
  4541*             CREDIBILITY TABLES                               *
  4542****************************************************************
  4543
  4544     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4545         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4546                             INDEXED BY CF-CRDB-NDX.
  4547             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4548             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4549             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4550         16  FILLER                         PIC  X(332).
  4551
  4552
  4553****************************************************************
  4554*             REPORT CUSTOMIZATION RECORD                      *
  4555****************************************************************
  4556
  4557     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4558         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4559             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4560             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4561             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4562**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4563****       A T-TRANSFER.                                   ****
  4564             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  85
* EL130.cbl
  4565
  4566         16  FILLER                         PIC XX.
  4567
  4568         16  CF-CARRIER-CNTL-OPT.
  4569             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4570                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4571                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4572             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4573                                            PIC X.
  4574         16  CF-GROUP-CNTL-OPT.
  4575             20  CF-GROUP-OPT-SEQ           PIC 9.
  4576                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4577                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4578             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4579                                            PIC X(6).
  4580         16  CF-STATE-CNTL-OPT.
  4581             20  CF-STATE-OPT-SEQ           PIC 9.
  4582                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4583                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4584             20  CF-STATE-SELECT OCCURS 3 TIMES
  4585                                            PIC XX.
  4586         16  CF-ACCOUNT-CNTL-OPT.
  4587             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4588                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4589                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4590             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  4591                                            PIC X(10).
  4592         16  CF-BUS-TYP-CNTL-OPT.
  4593             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4594                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4595                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4596             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4597                                            PIC XX.
  4598         16  CF-LF-TYP-CNTL-OPT.
  4599             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4600                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4601                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4602             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4603                                            PIC XX.
  4604         16  CF-AH-TYP-CNTL-OPT.
  4605             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4606                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4607                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4608             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4609                                            PIC XX.
  4610         16  CF-REPTCD1-CNTL-OPT.
  4611             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4612                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4613                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4614             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4615                                            PIC X(10).
  4616         16  CF-REPTCD2-CNTL-OPT.
  4617             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4618                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4619                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4620             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4621                                            PIC X(10).
  4622         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  86
* EL130.cbl
  4623             20  CF-USER1-OPT-SEQ           PIC 9.
  4624                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4625                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4626             20  CF-USER1-SELECT OCCURS 3 TIMES
  4627                                            PIC X(10).
  4628         16  CF-USER2-CNTL-OPT.
  4629             20  CF-USER2-OPT-SEQ           PIC 9.
  4630                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4631                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4632             20  CF-USER2-SELECT OCCURS 3 TIMES
  4633                                            PIC X(10).
  4634         16  CF-USER3-CNTL-OPT.
  4635             20  CF-USER3-OPT-SEQ           PIC 9.
  4636                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4637                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4638             20  CF-USER3-SELECT OCCURS 3 TIMES
  4639                                            PIC X(10).
  4640         16  CF-USER4-CNTL-OPT.
  4641             20  CF-USER4-OPT-SEQ           PIC 9.
  4642                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4643                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4644             20  CF-USER4-SELECT OCCURS 3 TIMES
  4645                                            PIC X(10).
  4646         16  CF-USER5-CNTL-OPT.
  4647             20  CF-USER5-OPT-SEQ           PIC 9.
  4648                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  4649                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4650             20  CF-USER5-SELECT OCCURS 3 TIMES
  4651                                            PIC X(10).
  4652         16  CF-REINS-CNTL-OPT.
  4653             20  CF-REINS-OPT-SEQ           PIC 9.
  4654                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4655                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4656             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4657                 24  CF-REINS-PRIME         PIC XXX.
  4658                 24  CF-REINS-SUB           PIC XXX.
  4659
  4660         16  CF-AGENT-CNTL-OPT.
  4661             20  CF-AGENT-OPT-SEQ           PIC 9.
  4662                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4663                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4664             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4665                                            PIC X(10).
  4666
  4667         16  FILLER                         PIC X(43).
  4668
  4669         16  CF-LOSS-RATIO-SELECT.
  4670             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4671             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4672         16  CF-ENTRY-DATE-SELECT.
  4673             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4674             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4675         16  CF-EFFECTIVE-DATE-SELECT.
  4676             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4677             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4678
  4679         16  CF-EXCEPTION-LIST-IND          PIC X.
  4680             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  87
* EL130.cbl
  4681
  4682         16  FILLER                         PIC X(318).
  4683
  4684****************************************************************
  4685*                  EXCEPTION REPORTING RECORD                  *
  4686****************************************************************
  4687
  4688     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4689         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4690             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4691
  4692         16  CF-COMBINED-LIFE-AH-OPT.
  4693             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4694             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4695             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4696             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4697
  4698         16  CF-LIFE-OPT.
  4699             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4700             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4701             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4702             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4703             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4704             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4705             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4706             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4707             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4708             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4709
  4710         16  CF-AH-OPT.
  4711             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4712             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4713             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4714             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4715             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4716             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4717             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4718             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4719             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4720             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4721
  4722         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4723             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4724             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4725             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4726
  4727         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4728
  4729         16  FILLER                         PIC X(673).
  4730
  4731
  4732****************************************************************
  4733*             MORTGAGE SYSTEM PLAN RECORD                      *
  4734****************************************************************
  4735
  4736     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4737         16  CF-PLAN-TYPE                   PIC X.
  4738             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  88
* EL130.cbl
  4739             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4740             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4741         16  CF-PLAN-ABBREV                 PIC XXX.
  4742         16  CF-PLAN-DESCRIPT               PIC X(10).
  4743         16  CF-PLAN-NOTES                  PIC X(20).
  4744         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4745         16  CF-PLAN-UNDERWRITING.
  4746             20  CF-PLAN-TERM-DATA.
  4747                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4748                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4749             20  CF-PLAN-AGE-DATA.
  4750                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4751                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4752                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4753             20  CF-PLAN-BENEFIT-DATA.
  4754                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4755                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4756                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4757                                            PIC S9(7)V99  COMP-3.
  4758         16  CF-PLAN-POLICY-FORMS.
  4759             20  CF-POLICY-FORM             PIC X(12).
  4760             20  CF-MASTER-APPLICATION      PIC X(12).
  4761             20  CF-MASTER-POLICY           PIC X(12).
  4762         16  CF-PLAN-RATING.
  4763             20  CF-RATE-CODE               PIC X(5).
  4764             20  CF-SEX-RATING              PIC X.
  4765                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4766                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4767             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4768             20  CF-SUB-STD-TYPE            PIC X.
  4769                 88  CF-PCT-OF-PREM            VALUE '1'.
  4770                 88  CF-PCT-OF-BENE            VALUE '2'.
  4771         16  CF-PLAN-PREM-TOLERANCES.
  4772             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4773             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4774         16  CF-PLAN-PYMT-TOLERANCES.
  4775             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4776             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4777         16  CF-PLAN-MISC-DATA.
  4778             20  FILLER                     PIC X.
  4779             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4780             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4781         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4782         16  CF-PLAN-IND-GRP                PIC X.
  4783             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4784                                                     '1'.
  4785             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4786                                                     '2'.
  4787         16  CF-MIB-SEARCH-SW               PIC X.
  4788             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4789             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4790             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4791             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4792         16  CF-ALPHA-SEARCH-SW             PIC X.
  4793             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4794             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4795             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4796             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  89
* EL130.cbl
  4797             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4798             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4799             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4800             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4801             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4802             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4803                                                     'A' 'B' 'C'
  4804                                                     'X' 'Y' 'Z'.
  4805         16  CF-EFF-DT-RULE-SW              PIC X.
  4806             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4807             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4808             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4809             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4810             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4811         16  FILLER                         PIC X(4).
  4812         16  CF-HEALTH-QUESTIONS            PIC X.
  4813             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4814         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4815         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4816         16  CF-PLAN-SNGL-JNT               PIC X.
  4817             88  CF-COMBINED-PLAN              VALUE 'C'.
  4818             88  CF-JNT-PLAN                   VALUE 'J'.
  4819             88  CF-SNGL-PLAN                  VALUE 'S'.
  4820         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4821         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4822         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4823         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4824         16  CF-RERATE-CNTL                 PIC  X.
  4825             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4826             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4827             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4828             88  CF-AUTO-RECALC                 VALUE '4'.
  4829         16  CF-BENEFIT-TYPE                PIC  X.
  4830             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4831             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4832         16  CF-POLICY-FEE                  PIC S999V99
  4833                                                    COMP-3.
  4834         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4835         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4836         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4837         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4838         16  FILLER                         PIC  X(32).
  4839         16  CF-TERMINATION-FORM            PIC  X(04).
  4840         16  FILLER                         PIC  X(08).
  4841         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4842                                                       COMP-3.
  4843         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4844         16  CF-ISSUE-LETTER                PIC  X(4).
  4845         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4846         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4847             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4848             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4849         16  CF-MP-REFUND-CALC              PIC X.
  4850             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4851             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4852             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4853             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4854             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  90
* EL130.cbl
  4855             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4856             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4857             88  CF-MP-REFD-MEAN                VALUE '8'.
  4858         16  CF-ALT-RATE-CODE               PIC  X(5).
  4859
  4860
  4861         16  FILLER                         PIC X(498).
  4862****************************************************************
  4863*             MORTGAGE COMPANY MASTER RECORD                   *
  4864****************************************************************
  4865
  4866     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4867         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4868         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4869             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4870             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4871             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4872             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4873             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4874
  4875         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4876         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4877         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4878         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4879         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4880
  4881         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4882             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4883         16  CF-MP-RECON-USE-IND            PIC X(1).
  4884             88  CF-MP-USE-RECON             VALUE 'Y'.
  4885         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4886             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4887         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4888             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4889             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4890         16  FILLER                         PIC X(1).
  4891         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4892             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4893         16  CF-MORTG-MIB-VERSION           PIC X.
  4894             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4895             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4896             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4897         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4898             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4899                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4900             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4901                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4902             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4903                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4904             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4905                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4906             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4907                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4908             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4909                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4910         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4911         16  FILLER                         PIC X(7).
  4912         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  91
* EL130.cbl
  4913             20  CF-MORTG-MIB-COMM          PIC X(5).
  4914             20  CF-MORTG-MIB-TERM          PIC X(5).
  4915         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4916             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4917         16  FILLER                         PIC X(03).
  4918         16  CF-MP-CHECK-NO-CONTROL.
  4919             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4920                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4921                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4922                                                ' ' LOW-VALUES.
  4923                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4924                                               VALUE '3'.
  4925         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4926         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4927         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4928             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4929                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4930             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4931                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4932             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4933                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4934             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4935                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4936             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4937                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4938             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4939                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4940         16  CF-MORTG-BILLING-AREA.
  4941             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4942                                            PIC X.
  4943         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4944         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4945         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4946         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4947             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4948             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4949         16  FILLER                         PIC X.
  4950         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4951             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4952             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4953         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4954         16  FILLER                         PIC X(8).
  4955         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4956         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4957         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4958         16  CF-ACH-COMPANY-ID.
  4959             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4960                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4961                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4962                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4963             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4964         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4965             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4966         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4967             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4968             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4969         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4970         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  92
* EL130.cbl
  4971         16  FILLER                         PIC X(536).
  4972
  4973****************************************************************
  4974*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4975****************************************************************
  4976
  4977     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4978         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4979             20  CF-FEMALE-HEIGHT.
  4980                 24  CF-FEMALE-FT           PIC 99.
  4981                 24  CF-FEMALE-IN           PIC 99.
  4982             20  CF-FEMALE-MIN-WT           PIC 999.
  4983             20  CF-FEMALE-MAX-WT           PIC 999.
  4984         16  FILLER                         PIC X(428).
  4985
  4986     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4987         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4988             20  CF-MALE-HEIGHT.
  4989                 24  CF-MALE-FT             PIC 99.
  4990                 24  CF-MALE-IN             PIC 99.
  4991             20  CF-MALE-MIN-WT             PIC 999.
  4992             20  CF-MALE-MAX-WT             PIC 999.
  4993         16  FILLER                         PIC X(428).
  4994******************************************************************
  4995*             AUTOMATIC ACTIVITY RECORD                          *
  4996******************************************************************
  4997     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4998         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4999             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5000             20  CF-SYS-LETTER-ID           PIC X(04).
  5001             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5002             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5003             20  CF-SYS-RESET-SW            PIC X(01).
  5004             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5005             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5006
  5007         16  FILLER                         PIC X(50).
  5008
  5009         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5010             20  CF-USER-ACTIVE-SW          PIC X(01).
  5011             20  CF-USER-LETTER-ID          PIC X(04).
  5012             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5013             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5014             20  CF-USER-RESET-SW           PIC X(01).
  5015             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5016             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5017             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5018
  5019         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  93
* EL130.cbl
  5021*    COPY ELCCERT.
  5022******************************************************************
  5023*                                                                *
  5024*                            ELCCERT.                            *
  5025*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5026*                            VMOD=2.013                          *
  5027*                                                                *
  5028*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5029*                                                                *
  5030*   FILE TYPE = VSAM,KSDS                                        *
  5031*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5032*                                                                *
  5033*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5034*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5035*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5036*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5037*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5038*                                                                *
  5039*   LOG = YES                                                    *
  5040*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5041******************************************************************
  5042*                   C H A N G E   L O G
  5043*
  5044* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5045*-----------------------------------------------------------------
  5046*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5047* EFFECTIVE    NUMBER
  5048*-----------------------------------------------------------------
  5049* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5050* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5051* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5052* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5053* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5054* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5055* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5056* 032612  CR2011110200001  PEMA  AHL CHANGES
  5057* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5058* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5059******************************************************************
  5060
  5061 01  CERTIFICATE-MASTER.
  5062     12  CM-RECORD-ID                      PIC XX.
  5063         88  VALID-CM-ID                      VALUE 'CM'.
  5064
  5065     12  CM-CONTROL-PRIMARY.
  5066         16  CM-COMPANY-CD                 PIC X.
  5067         16  CM-CARRIER                    PIC X.
  5068         16  CM-GROUPING.
  5069             20  CM-GROUPING-PREFIX        PIC X(3).
  5070             20  CM-GROUPING-PRIME         PIC X(3).
  5071         16  CM-STATE                      PIC XX.
  5072         16  CM-ACCOUNT.
  5073             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5074             20  CM-ACCOUNT-PRIME          PIC X(6).
  5075         16  CM-CERT-EFF-DT                PIC XX.
  5076         16  CM-CERT-NO.
  5077             20  CM-CERT-PRIME             PIC X(10).
  5078             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  94
* EL130.cbl
  5079
  5080     12  CM-CONTROL-BY-NAME.
  5081         16  CM-COMPANY-CD-A1              PIC X.
  5082         16  CM-INSURED-LAST-NAME          PIC X(15).
  5083         16  CM-INSURED-INITIALS.
  5084             20  CM-INSURED-INITIAL1       PIC X.
  5085             20  CM-INSURED-INITIAL2       PIC X.
  5086
  5087     12  CM-CONTROL-BY-SSN.
  5088         16  CM-COMPANY-CD-A2              PIC X.
  5089         16  CM-SOC-SEC-NO.
  5090             20  CM-SSN-STATE              PIC XX.
  5091             20  CM-SSN-ACCOUNT            PIC X(6).
  5092             20  CM-SSN-LN3.
  5093                 25  CM-INSURED-INITIALS-A2.
  5094                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5095                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5096                 25 CM-PART-LAST-NAME-A2         PIC X.
  5097
  5098     12  CM-CONTROL-BY-CERT-NO.
  5099         16  CM-COMPANY-CD-A4              PIC X.
  5100         16  CM-CERT-NO-A4                 PIC X(11).
  5101
  5102     12  CM-CONTROL-BY-MEMB.
  5103         16  CM-COMPANY-CD-A5              PIC X.
  5104         16  CM-MEMBER-NO.
  5105             20  CM-MEMB-STATE             PIC XX.
  5106             20  CM-MEMB-ACCOUNT           PIC X(6).
  5107             20  CM-MEMB-LN4.
  5108                 25  CM-INSURED-INITIALS-A5.
  5109                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5110                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5111                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5112
  5113     12  CM-INSURED-PROFILE-DATA.
  5114         16  CM-INSURED-FIRST-NAME.
  5115             20  CM-INSURED-1ST-INIT       PIC X.
  5116             20  FILLER                    PIC X(9).
  5117         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5118         16  CM-INSURED-SEX                PIC X.
  5119             88  CM-SEX-MALE                  VALUE 'M'.
  5120             88  CM-SEX-FEMAL                 VALUE 'F'.
  5121         16  CM-INSURED-JOINT-AGE          PIC 99.
  5122         16  CM-JOINT-INSURED-NAME.
  5123             20  CM-JT-LAST-NAME           PIC X(15).
  5124             20  CM-JT-FIRST-NAME.
  5125                 24  CM-JT-1ST-INIT        PIC X.
  5126                 24  FILLER                PIC X(9).
  5127             20  CM-JT-INITIAL             PIC X.
  5128
  5129     12  CM-LIFE-DATA.
  5130         16  CM-LF-BENEFIT-CD              PIC XX.
  5131         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5132         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5133         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5134         16  CM-LF-DEV-CODE                PIC XXX.
  5135         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5136         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  95
* EL130.cbl
  5137         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5138         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5139         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5140         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5141         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5142         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5143         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5144         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5145         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5146         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5147         16  cm-temp-epiq                  pic xx.
  5148             88  EPIQ-CLASS                  value 'EQ'.
  5149*        16  FILLER                        PIC XX.
  5150
  5151     12  CM-AH-DATA.
  5152         16  CM-AH-BENEFIT-CD              PIC XX.
  5153         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5154         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5155         16  CM-AH-DEV-CODE                PIC XXX.
  5156         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5157         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5158         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5159         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5160         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5161         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5162         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5163         16  CM-AH-PAID-THRU-DT            PIC XX.
  5164             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5165         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5166         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  5167         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5168         16  FILLER                        PIC X.
  5169
  5170     12  CM-LOAN-INFORMATION.
  5171         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5172         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5173                                           PIC S9(5)V99  COMP-3.
  5174         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5175         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5176         16  CM-PAY-FREQUENCY              PIC S99.
  5177         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5178         16  CM-RATE-CLASS                 PIC XX.
  5179         16  CM-BENEFICIARY                PIC X(25).
  5180         16  CM-POLICY-FORM-NO             PIC X(12).
  5181         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5182         16  CM-LAST-ADD-ON-DT             PIC XX.
  5183         16  CM-DEDUCTIBLE-AMOUNTS.
  5184             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5185             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5186         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5187             20  CM-RESIDENT-STATE         PIC XX.
  5188             20  CM-RATE-CODE              PIC X(4).
  5189             20  FILLER                    PIC XX.
  5190         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5191             20  CM-LOAN-OFFICER           PIC X(5).
  5192             20  FILLER                    PIC XXX.
  5193         16  CM-CSR-CODE                   PIC XXX.
  5194         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  96
* EL130.cbl
  5195             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5196         16  CM-POST-CARD-IND              PIC X.
  5197         16  CM-NH-INTERFACE-SW            PIC X.
  5198         16  CM-PREMIUM-TYPE               PIC X.
  5199             88  CM-SING-PRM                  VALUE '1'.
  5200             88  CM-O-B-COVERAGE              VALUE '2'.
  5201             88  CM-OPEN-END                  VALUE '3'.
  5202         16  CM-IND-GRP-TYPE               PIC X.
  5203             88  CM-INDIVIDUAL                VALUE 'I'.
  5204             88  CM-GROUP                     VALUE 'G'.
  5205         16  CM-SKIP-CODE                  PIC X.
  5206             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5207             88  SKIP-JULY                    VALUE '1'.
  5208             88  SKIP-AUGUST                  VALUE '2'.
  5209             88  SKIP-SEPTEMBER               VALUE '3'.
  5210             88  SKIP-JULY-AUG                VALUE '4'.
  5211             88  SKIP-AUG-SEPT                VALUE '5'.
  5212             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5213             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5214             88  SKIP-JUNE                    VALUE '8'.
  5215             88  SKIP-JUNE-JULY               VALUE '9'.
  5216             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5217             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5218         16  CM-PAYMENT-MODE               PIC X.
  5219             88  PAY-MONTHLY                  VALUE SPACE.
  5220             88  PAY-WEEKLY                   VALUE '1'.
  5221             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5222             88  PAY-BI-WEEKLY                VALUE '3'.
  5223             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5224         16  CM-LOAN-NUMBER                PIC X(8).
  5225         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5226         16  CM-OLD-LOF                    PIC XXX.
  5227*        16  CM-LOAN-OFFICER               PIC XXX.
  5228         16  CM-REIN-TABLE                 PIC XXX.
  5229         16  CM-SPECIAL-REIN-CODE          PIC X.
  5230         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5231         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5232         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5233
  5234     12  CM-STATUS-DATA.
  5235         16  CM-ENTRY-STATUS               PIC X.
  5236         16  CM-ENTRY-DT                   PIC XX.
  5237
  5238         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5239         16  CM-LF-CANCEL-DT               PIC XX.
  5240         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5241
  5242         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5243         16  CM-LF-DEATH-DT                PIC XX.
  5244         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5245
  5246         16  CM-LF-CURRENT-STATUS          PIC X.
  5247             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5248                                                'M' '4' '5' '9'.
  5249             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5250             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5251             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5252             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  97
* EL130.cbl
  5253             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5254             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5255             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5256             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5257             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5258             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5259             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5260             88  CM-LF-DECLINED               VALUE 'D'.
  5261             88  CM-LF-VOIDED                 VALUE 'V'.
  5262
  5263         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5264         16  CM-AH-CANCEL-DT               PIC XX.
  5265         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5266
  5267         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5268         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5269         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5270
  5271         16  CM-AH-CURRENT-STATUS          PIC X.
  5272             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5273                                                'M' '4' '5' '9'.
  5274             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5275             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5276             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5277             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5278             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5279             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5280             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5281             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5282             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5283             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5284             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5285             88  CM-AH-DECLINED               VALUE 'D'.
  5286             88  CM-AH-VOIDED                 VALUE 'V'.
  5287
  5288         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5289             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5290             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5291             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5292         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5293
  5294         16  CM-ENTRY-BATCH                PIC X(6).
  5295         16  CM-LF-EXIT-BATCH              PIC X(6).
  5296         16  CM-AH-EXIT-BATCH              PIC X(6).
  5297         16  CM-LAST-MONTH-END             PIC XX.
  5298
  5299     12  CM-NOTE-SW                        PIC X.
  5300         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5301         88  CERT-NOTES-PRESENT               VALUE '1'.
  5302         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5303         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5304         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5305         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5306         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5307         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5308     12  CM-COMP-EXCP-SW                   PIC X.
  5309         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5310         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  98
* EL130.cbl
  5311     12  CM-INSURED-ADDRESS-SW             PIC X.
  5312         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5313         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5314
  5315*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5316     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5317     12  FILLER                            PIC X.
  5318
  5319*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5320     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5321     12  FILLER                            PIC X.
  5322*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5323     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5324
  5325     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5326         88  CERT-ADDED-BATCH                 VALUE ' '.
  5327         88  CERT-ADDED-ONLINE                VALUE '1'.
  5328         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5329         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5330         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5331     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5332         88  CERT-AS-LOADED                   VALUE ' '.
  5333         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5334         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5335         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5336         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5337         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5338         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5339         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5340
  5341     12  CM-ACCOUNT-COMM-PCTS.
  5342         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5343         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5344
  5345     12  CM-USER-FIELD                     PIC X.
  5346     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5347     12  CM-CLP-STATE                      PIC XX.
  5348     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5349     12  CM-USER-RESERVED                  PIC XXX.
  5350     12  FILLER REDEFINES CM-USER-RESERVED.
  5351         16  CM-AH-CLASS-CD                PIC XX.
  5352         16  F                             PIC X.
  5353******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page  99
* EL130.cbl
  5355*    COPY ERCACCT.
  5356******************************************************************
  5357*                                                                *
  5358*                                                                *
  5359*                            ERCACCT                             *
  5360*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5361*                            VMOD=2.031                          *
  5362*                                                                *
  5363*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5364*                                                                *
  5365*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5366*   VSAM ACCOUNT MASTER FILES.                                   *
  5367*                                                                *
  5368*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5369*                                                                *
  5370*   FILE TYPE = VSAM,KSDS                                        *
  5371*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5372*                                                                *
  5373*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5374*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5375*                                                                *
  5376*   LOG = NO                                                     *
  5377*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5378*                                                                *
  5379*                                                                *
  5380******************************************************************
  5381*                   C H A N G E   L O G
  5382*
  5383* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5384*-----------------------------------------------------------------
  5385*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5386* EFFECTIVE    NUMBER
  5387*-----------------------------------------------------------------
  5388* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5389* 092705    2005050300006  PEMA  ADD SPP LEASES
  5390* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5391* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5392* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  5393* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  5394* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  5395* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  5396******************************************************************
  5397
  5398 01  ACCOUNT-MASTER.
  5399     12  AM-RECORD-ID                      PIC XX.
  5400         88  VALID-AM-ID                      VALUE 'AM'.
  5401
  5402     12  AM-CONTROL-PRIMARY.
  5403         16  AM-COMPANY-CD                 PIC X.
  5404         16  AM-MSTR-CNTRL.
  5405             20  AM-CONTROL-A.
  5406                 24  AM-CARRIER            PIC X.
  5407                 24  AM-GROUPING.
  5408                     28 AM-GROUPING-PREFIX PIC XXX.
  5409                     28 AM-GROUPING-PRIME  PIC XXX.
  5410                 24  AM-STATE              PIC XX.
  5411                 24  AM-ACCOUNT.
  5412                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 100
* EL130.cbl
  5413                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5414             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5415                                           PIC X(19).
  5416             20  AM-CNTRL-B.
  5417                 24  AM-EXPIRATION-DT      PIC XX.
  5418                 24  FILLER                PIC X(4).
  5419             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5420                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5421
  5422     12  AM-CONTROL-BY-VAR-GRP.
  5423         16  AM-COMPANY-CD-A1              PIC X.
  5424         16  AM-VG-CARRIER                 PIC X.
  5425         16  AM-VG-GROUPING                PIC X(6).
  5426         16  AM-VG-STATE                   PIC XX.
  5427         16  AM-VG-ACCOUNT                 PIC X(10).
  5428         16  AM-VG-DATE.
  5429             20  AM-VG-EXPIRATION-DT       PIC XX.
  5430             20  FILLER                    PIC X(4).
  5431         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5432                                           PIC 9(11)      COMP-3.
  5433     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  5434         16  FILLER                        PIC X(10).
  5435         16  AM-VG-KEY3.
  5436             20  AM-VG3-ACCOUNT            PIC X(10).
  5437             20  AM-VG3-EXP-DT             PIC XX.
  5438         16  FILLER                        PIC X(4).
  5439     12  AM-MAINT-INFORMATION.
  5440         16  AM-LAST-MAINT-DT              PIC XX.
  5441         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5442         16  AM-LAST-MAINT-USER            PIC X(4).
  5443         16  FILLER                        PIC XX.
  5444
  5445     12  AM-EFFECTIVE-DT                   PIC XX.
  5446     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5447
  5448     12  AM-PREV-DATES  COMP-3.
  5449         16  AM-PREV-EXP-DT                PIC 9(11).
  5450         16  AM-PREV-EFF-DT                PIC 9(11).
  5451
  5452     12  AM-REPORT-CODE-1                  PIC X(10).
  5453     12  AM-REPORT-CODE-2                  PIC X(10).
  5454
  5455     12  AM-CITY-CODE                      PIC X(4).
  5456     12  AM-COUNTY-PARISH                  PIC X(6).
  5457
  5458     12  AM-NAME                           PIC X(30).
  5459     12  AM-PERSON                         PIC X(30).
  5460     12  AM-ADDRS                          PIC X(30).
  5461     12  AM-CITY.
  5462         16  AM-ADDR-CITY                  PIC X(28).
  5463         16  AM-ADDR-STATE                 PIC XX.
  5464     12  AM-ZIP.
  5465         16  AM-ZIP-PRIME.
  5466             20  AM-ZIP-PRI-1ST            PIC X.
  5467                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5468             20  FILLER                    PIC X(4).
  5469         16  AM-ZIP-PLUS4                  PIC X(4).
  5470     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 101
* EL130.cbl
  5471         16  AM-CAN-POSTAL-1               PIC XXX.
  5472         16  AM-CAN-POSTAL-2               PIC XXX.
  5473         16  FILLER                        PIC XXX.
  5474     12  AM-TEL-NO.
  5475         16  AM-AREA-CODE                  PIC 999.
  5476         16  AM-TEL-PRE                    PIC 999.
  5477         16  AM-TEL-NBR                    PIC 9(4).
  5478     12  AM-TEL-LOC                        PIC X.
  5479         88  AM-TEL-AT-HOME                   VALUE 'H'.
  5480         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5481
  5482     12  AM-COMM-STRUCTURE.
  5483         16  AM-DEFN-1.
  5484             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5485                 24  AM-AGT.
  5486                     28  AM-AGT-PREFIX     PIC X(4).
  5487                     28  AM-AGT-PRIME      PIC X(6).
  5488                 24  AM-COM-TYP            PIC X.
  5489                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5490                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5491                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5492                 24  AM-RECALC-LV-INDIC    PIC X.
  5493                 24  AM-RETRO-LV-INDIC     PIC X.
  5494                 24  AM-GL-CODES           PIC X.
  5495                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5496                 24  FILLER                PIC X(01).
  5497         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5498             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5499                 24  FILLER                PIC X(11).
  5500                 24  AM-L-COMA             PIC XXX.
  5501                 24  AM-J-COMA             PIC XXX.
  5502                 24  AM-A-COMA             PIC XXX.
  5503                 24  FILLER                PIC X(6).
  5504
  5505     12  AM-COMM-CHANGE-STATUS             PIC X.
  5506         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5507
  5508     12  AM-CSR-CODE                       PIC X(4).
  5509
  5510     12  AM-BILLING-STATUS                 PIC X.
  5511         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5512         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5513     12  AM-AUTO-REFUND-SW                 PIC X.
  5514         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5515         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5516     12  AM-GPCD                           PIC 99.
  5517     12  AM-IG                             PIC X.
  5518         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5519         88  AM-HAS-GROUP                     VALUE '2'.
  5520     12  AM-STATUS                         PIC X.
  5521         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5522         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5523         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5524         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5525         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5526         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  5527         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  5528         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 102
* EL130.cbl
  5529         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  5530         88  AM-ACCOUNT-PENDING               VALUE '9'.
  5531     12  AM-REMIT-TO                       PIC 99.
  5532     12  AM-ID-NO                          PIC X(11).
  5533
  5534     12  AM-CAL-TABLE                      PIC XX.
  5535     12  AM-LF-DEVIATION                   PIC XXX.
  5536     12  AM-AH-DEVIATION                   PIC XXX.
  5537     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5538     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5539     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5540     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5541     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5542     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5543
  5544     12  AM-USER-FIELDS.
  5545         16  AM-FLD-1                      PIC XX.
  5546         16  AM-FLD-2                      PIC XX.
  5547         16  AM-FLD-3                      PIC XX.
  5548         16  AM-FLD-4                      PIC XX.
  5549         16  AM-FLD-5                      PIC XX.
  5550
  5551     12  AM-1ST-PROD-DATE.
  5552         16  AM-1ST-PROD-YR                PIC XX.
  5553         16  AM-1ST-PROD-MO                PIC XX.
  5554         16  AM-1ST-PROD-DA                PIC XX.
  5555     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5556     12  AM-CERTS-PURGED-DATE.
  5557         16  AM-PUR-YR                     PIC XX.
  5558         16  AM-PUR-MO                     PIC XX.
  5559         16  AM-PUR-DA                     PIC XX.
  5560     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5561     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5562     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5563     12  AM-INACTIVE-DATE.
  5564         16  AM-INA-MO                     PIC 99.
  5565         16  AM-INA-DA                     PIC 99.
  5566         16  AM-INA-YR                     PIC 99.
  5567     12  AM-AR-HI-CERT-DATE                PIC XX.
  5568
  5569     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5570     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5571
  5572     12  AM-OB-PAYMENT-MODE                PIC X.
  5573         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5574         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5575         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5576         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5577
  5578     12  AM-AH-ONLY-INDICATOR              PIC X.
  5579         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5580         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5581
  5582     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5583
  5584     12  AM-OVER-SHORT.
  5585         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5586         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 103
* EL130.cbl
  5587
  5588     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5589     12  AM-DCC-CLP-STATE                  PIC XX.
  5590
  5591     12  AM-RECALC-COMM                    PIC X.
  5592     12  AM-RECALC-REIN                    PIC X.
  5593
  5594     12  AM-REI-TABLE                      PIC XXX.
  5595     12  AM-REI-ET-LF                      PIC X.
  5596     12  AM-REI-ET-AH                      PIC X.
  5597     12  AM-REI-PE-LF                      PIC X.
  5598     12  AM-REI-PE-AH                      PIC X.
  5599     12  AM-REI-PRT-ST                     PIC X.
  5600     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  5601     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5602     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5603     12  AM-REI-GROUP-A                    PIC X(6).
  5604     12  AM-REI-MORT                       PIC X(4).
  5605     12  AM-REI-PRT-OW                     PIC X.
  5606     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5607     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5608     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5609     12  AM-REI-GROUP-B                    PIC X(6).
  5610
  5611     12  AM-TRUST-TYPE                     PIC X(2).
  5612
  5613     12  AM-EMPLOYER-STMT-USED             PIC X.
  5614     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5615
  5616     12  AM-STD-AH-TYPE                    PIC XX.
  5617     12  AM-EARN-METHODS.
  5618         16  AM-EARN-METHOD-R              PIC X.
  5619             88 AM-REF-RL-R78                 VALUE 'R'.
  5620             88 AM-REF-RL-PR                  VALUE 'P'.
  5621             88 AM-REF-RL-MEAN                VALUE 'M'.
  5622             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5623         16  AM-EARN-METHOD-L              PIC X.
  5624             88 AM-REF-LL-R78                 VALUE 'R'.
  5625             88 AM-REF-LL-PR                  VALUE 'P'.
  5626             88 AM-REF-LL-MEAN                VALUE 'M'.
  5627             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5628         16  AM-EARN-METHOD-A              PIC X.
  5629             88 AM-REF-AH-R78                 VALUE 'R'.
  5630             88 AM-REF-AH-PR                  VALUE 'P'.
  5631             88 AM-REF-AH-MEAN                VALUE 'M'.
  5632             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5633             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5634             88 AM-REF-AH-NET                 VALUE 'N'.
  5635
  5636     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5637     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5638     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5639
  5640     12  AM-RET-Y-N                        PIC X.
  5641     12  AM-RET-P-E                        PIC X.
  5642     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5643     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5644     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 104
* EL130.cbl
  5645     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5646         16  AM-POOL-PRIME                 PIC XXX.
  5647         16  AM-POOL-SUB                   PIC XXX.
  5648     12  AM-RETRO-EARNINGS.
  5649         16  AM-RET-EARN-R                 PIC X.
  5650         16  AM-RET-EARN-L                 PIC X.
  5651         16  AM-RET-EARN-A                 PIC X.
  5652     12  AM-RET-ST-TAX-USE                 PIC X.
  5653         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5654         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5655     12  AM-RETRO-BEG-EARNINGS.
  5656         16  AM-RET-BEG-EARN-R             PIC X.
  5657         16  AM-RET-BEG-EARN-L             PIC X.
  5658         16  AM-RET-BEG-EARN-A             PIC X.
  5659     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5660     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5661
  5662     12  AM-USER-SELECT-OPTIONS.
  5663         16  AM-USER-SELECT-1              PIC X(10).
  5664         16  AM-USER-SELECT-2              PIC X(10).
  5665         16  AM-USER-SELECT-3              PIC X(10).
  5666         16  AM-USER-SELECT-4              PIC X(10).
  5667         16  AM-USER-SELECT-5              PIC X(10).
  5668
  5669     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5670
  5671     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5672
  5673     12  AM-RPT045A-SWITCH                 PIC X.
  5674         88  RPT045A-OFF                   VALUE 'N'.
  5675
  5676     12  AM-INSURANCE-LIMITS.
  5677         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5678         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5679
  5680     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5681         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5682
  5683     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5684         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5685         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5686
  5687     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5688
  5689     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5690     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5691     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5692     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5693     12  AM-DCC-UEF-STATE                  PIC XX.
  5694     12  FILLER                            PIC XXX.
  5695     12  AM-REPORT-CODE-3                  PIC X(10).
  5696*    12  FILLER                            PIC X(22).
  5697
  5698     12  AM-RESERVE-DATE.
  5699         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5700         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5701         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5702
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 105
* EL130.cbl
  5703     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5704     12  AM-NOTIFICATION-TYPES.
  5705         16  AM-NOTIF-OF-LETTERS           PIC X.
  5706         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5707         16  AM-NOTIF-OF-REPORTS           PIC X.
  5708         16  AM-NOTIF-OF-STATUS            PIC X.
  5709
  5710     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5711         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5712         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5713         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5714         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5715
  5716     12  AM-BENEFIT-CONTROLS.
  5717         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  5718             20  AM-BENEFIT-CODE           PIC XX.
  5719             20  AM-BENEFIT-TYPE           PIC X.
  5720             20  AM-BENEFIT-REVISION       PIC XXX.
  5721             20  AM-BENEFIT-REM-TERM       PIC X.
  5722             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5723             20  FILLER                    PIC XX.
  5724         16  FILLER                        PIC X(80).
  5725
  5726     12  AM-TRANSFER-DATA.
  5727         16  AM-TRANSFERRED-FROM.
  5728             20  AM-TRNFROM-CARRIER        PIC X.
  5729             20  AM-TRNFROM-GROUPING.
  5730                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5731                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5732             20  AM-TRNFROM-STATE          PIC XX.
  5733             20  AM-TRNFROM-ACCOUNT.
  5734                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5735                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5736             20  AM-TRNFROM-DTE            PIC XX.
  5737         16  AM-TRANSFERRED-TO.
  5738             20  AM-TRNTO-CARRIER          PIC X.
  5739             20  AM-TRNTO-GROUPING.
  5740                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5741                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5742             20  AM-TRNTO-STATE            PIC XX.
  5743             20  AM-TRNTO-ACCOUNT.
  5744                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5745                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5746             20  AM-TRNTO-DTE              PIC XX.
  5747         16  FILLER                        PIC X(10).
  5748
  5749     12  AM-SAVED-REMIT-TO                 PIC 99.
  5750
  5751     12  AM-COMM-STRUCTURE-SAVED.
  5752         16  AM-DEFN-1-SAVED.
  5753             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5754                 24  AM-AGT-SV             PIC X(10).
  5755                 24  AM-COM-TYP-SV         PIC X.
  5756                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5757                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5758                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5759                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5760                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 106
* EL130.cbl
  5761                 24  AM-GL-CODES-SV        PIC X.
  5762                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5763                 24  FILLER                PIC X.
  5764         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5765             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5766                 24  FILLER                PIC X(11).
  5767                 24  AM-L-COMA-SV          PIC XXX.
  5768                 24  AM-J-COMA-SV          PIC XXX.
  5769                 24  AM-A-COMA-SV          PIC XXX.
  5770                 24  FILLER                PIC X(6).
  5771
  5772     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5773         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5774            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5775            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  5776            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5777
  5778     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5779     12  FILLER                            PIC X(120).
  5780
  5781     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5782         16  AM-CONTROL-NAME               PIC X(30).
  5783         16  AM-EXECUTIVE-ONE.
  5784             20  AM-EXEC1-NAME             PIC X(15).
  5785             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5786                                                          COMP-3.
  5787             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5788                                                          COMP-3.
  5789         16  AM-EXECUTIVE-TWO.
  5790             20  AM-EXEC2-NAME             PIC X(15).
  5791             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5792                                                          COMP-3.
  5793             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5794                                                          COMP-3.
  5795
  5796     12  AM-RETRO-ADDITIONAL-DATA.
  5797         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5798         16  AM-RETRO-PREM-P-E             PIC X.
  5799         16  AM-RETRO-CLMS-P-I             PIC X.
  5800         16  AM-RETRO-RET-BRACKET-LF.
  5801             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5802                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5803                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5804             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5805                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5806                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5807             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5808                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5809                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5810         16  AM-RETRO-RET-BRACKET-AH.
  5811             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5812                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5813                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5814                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5815             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5816                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5817                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5818             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 107
* EL130.cbl
  5819                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5820                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5821
  5822     12  AM-COMMENTS.
  5823         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5824
  5825     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5826         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5827         16  AM-FLI-BILLING-CODE           PIC X.
  5828         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5829         16  AM-FLI-UNITED-IDENT           PIC X.
  5830         16  AM-FLI-INTEREST-LOST-DATA.
  5831             20  AM-FLI-BANK-NO            PIC X(5).
  5832             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5833             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  5834             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5835         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5836             20  AM-FLI-AGT                PIC X(9).
  5837             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5838             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5839         16  FILLER                        PIC X(102).
  5840
  5841     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5842         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5843             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5844             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5845             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5846             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5847             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5848         16  FILLER                          PIC X(10).
  5849******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 108
* EL130.cbl
  5851*    COPY ELCTRLR.
  5852******************************************************************
  5853*                                                                *
  5854*                            ELCTRLR.                            *
  5855*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5856*                            VMOD=2.014                          *
  5857*                                                                *
  5858*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5859*                                                                *
  5860*   FILE TYPE = VSAM,KSDS                                        *
  5861*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5862*                                                                *
  5863*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5864*       ALTERNATE INDEX = NONE                                   *
  5865*                                                                *
  5866*   LOG = YES                                                    *
  5867*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5868******************************************************************
  5869*                   C H A N G E   L O G
  5870*
  5871* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5872*-----------------------------------------------------------------
  5873*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5874* EFFECTIVE    NUMBER
  5875*-----------------------------------------------------------------
  5876* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5877* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5878* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5879* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5880* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5881* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5882* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5883* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5884* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5885* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5886* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5887* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5888* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5889* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5890* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5891* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5892* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5893* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5894* 040814    2014030500002  AJRA  ADD ICD CODES
  5895* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5896* 013017  CR2016053100001  PEMA  ACH PROCESSING
  5897* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  5898******************************************************************
  5899 01  ACTIVITY-TRAILERS.
  5900     12  AT-RECORD-ID                    PIC XX.
  5901         88  VALID-AT-ID                       VALUE 'AT'.
  5902
  5903     12  AT-CONTROL-PRIMARY.
  5904         16  AT-COMPANY-CD               PIC X.
  5905         16  AT-CARRIER                  PIC X.
  5906         16  AT-CLAIM-NO                 PIC X(7).
  5907         16  AT-CERT-NO.
  5908             20  AT-CERT-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 109
* EL130.cbl
  5909             20  AT-CERT-SFX             PIC X.
  5910         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  5911             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5912             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5913             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5914             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5915             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5916             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5917             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5918             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5919             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5920             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5921             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5922             88  AT-BENEFICIARY-TRL           VALUE +91.
  5923             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5924             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5925             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5926             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5927
  5928     12  AT-TRAILER-TYPE                 PIC X.
  5929         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5930         88  PAYMENT-TR                       VALUE '2'.
  5931         88  AUTO-PAY-TR                      VALUE '3'.
  5932         88  CORRESPONDENCE-TR                VALUE '4'.
  5933         88  ADDRESS-TR                       VALUE '5'.
  5934         88  GENERAL-INFO-TR                  VALUE '6'.
  5935         88  AUTO-PROMPT-TR                   VALUE '7'.
  5936         88  DENIAL-TR                        VALUE '8'.
  5937         88  INCURRED-CHG-TR                  VALUE '9'.
  5938         88  FORM-CONTROL-TR                  VALUE 'A'.
  5939
  5940     12  AT-RECORDED-DT                  PIC XX.
  5941     12  AT-RECORDED-BY                  PIC X(4).
  5942     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  5943
  5944     12  AT-TRAILER-BODY                 PIC X(165).
  5945
  5946     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  5947         16  AT-RESERVE-CONTROLS.
  5948             20  AT-MANUAL-SW            PIC X.
  5949                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  5950             20  AT-FUTURE-SW            PIC X.
  5951                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  5952             20  AT-PTC-SW               PIC X.
  5953                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  5954             20  AT-IBNR-SW              PIC X.
  5955                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  5956             20  AT-PTC-LF-SW            PIC X.
  5957                 88  AT-LF-PTC-USED          VALUE '1'.
  5958             20  AT-CDT-ACCESS-METHOD    PIC X.
  5959                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  5960                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  5961                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  5962             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  5963         16  AT-LAST-COMPUTED-DT         PIC XX.
  5964         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  5965         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  5966         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 110
* EL130.cbl
  5967         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5968         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  5969         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  5970         16  AT-EXPENSE-CONTROLS.
  5971             20  AT-EXPENSE-METHOD       PIC X.
  5972                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  5973                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  5974                 88  PERCENT-OF-PMT           VALUE '3'.
  5975                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  5976             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  5977             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  5978         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  5979         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  5980
  5981         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  5982         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  5983
  5984*        16  FILLER                      PIC X(53).
  5985         16  FILLER                      PIC X(47).
  5986
  5987         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  5988         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  5989
  5990         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  5991             20  AT-OPEN-CLOSE-DATE      PIC XX.
  5992             20  AT-OPEN-CLOSE-TYPE      PIC X.
  5993*                    C = CLOSED
  5994*                    O = OPEN
  5995             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  5996*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  5997
  5998     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  5999         16  AT-PAYMENT-TYPE             PIC X.
  6000             88  PARTIAL-PAYMENT                VALUE '1'.
  6001             88  FINAL-PAYMENT                  VALUE '2'.
  6002             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6003             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6004             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6005             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6006             88  VOIDED-PAYMENT                 VALUE '9'.
  6007             88  TRANSFER                       VALUE 'T'.
  6008             88  LIFE-INTEREST                  VALUE 'I'.
  6009
  6010         16  AT-CLAIM-TYPE               PIC X.
  6011             88  PAID-FOR-AH                    VALUE 'A'.
  6012             88  PAID-FOR-LIFE                  VALUE 'L'.
  6013             88  PAID-FOR-IUI                   VALUE 'I'.
  6014             88  PAID-FOR-GAP                   VALUE 'G'.
  6015             88  PAID-FOR-FAM                   VALUE 'F'.
  6016         16  AT-CLAIM-PREM-TYPE          PIC X.
  6017             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6018             88  AT-O-B-COVERAGE                VALUE '2'.
  6019             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6020         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6021         16  AT-CHECK-NO                 PIC X(7).
  6022         16  AT-PAID-FROM-DT             PIC XX.
  6023         16  AT-PAID-THRU-DT             PIC XX.
  6024         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 111
* EL130.cbl
  6025         16  AT-ACH-PAYMENT              PIC X.
  6026*        16  FILLER                      PIC X.
  6027         16  AT-PAYEES-NAME              PIC X(30).
  6028         16  AT-PAYMENT-ORIGIN           PIC X.
  6029             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6030             88  ONLINE-AUTO-PMT                VALUE '2'.
  6031             88  OFFLINE-PMT                    VALUE '3'.
  6032         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6033         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6034         16  AT-VOID-DATA.
  6035             20  AT-VOID-DT              PIC XX.
  6036*00144       20  AT-VOID-REASON          PIC X(30).
  6037             20  AT-VOID-REASON          PIC X(26).
  6038         16  AT-PMT-APPROVED-BY          PIC X(04).
  6039         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6040         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6041         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6042                                         PIC S99V9(5)  COMP-3.
  6043         16  AT-CREDIT-INTERFACE.
  6044             20  AT-PMT-SELECT-DT        PIC XX.
  6045                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6046             20  AT-PMT-ACCEPT-DT        PIC XX.
  6047                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6048             20  AT-VOID-SELECT-DT       PIC XX.
  6049                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6050             20  AT-VOID-ACCEPT-DT       PIC XX.
  6051                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6052
  6053         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6054                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6055                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6056         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6057
  6058         16  AT-FORCE-CONTROL            PIC X.
  6059             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6060         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6061         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6062         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6063         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6064         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6065         16  AT-BENEFIT-TYPE             PIC X.
  6066
  6067         16  AT-EXPENSE-TYPE             PIC X.
  6068         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6069
  6070         16  AT-PAYEE-TYPE-CD.
  6071             20  AT-PAYEE-TYPE           PIC X.
  6072                 88  INSURED-PAID           VALUE 'I'.
  6073                 88  BENEFICIARY-PAID       VALUE 'B'.
  6074                 88  ACCOUNT-PAID           VALUE 'A'.
  6075                 88  OTHER-1-PAID           VALUE 'O'.
  6076                 88  OTHER-2-PAID           VALUE 'Q'.
  6077                 88  DOCTOR-PAID            VALUE 'P'.
  6078                 88  EMPLOYER-PAID          VALUE 'E'.
  6079             20  AT-PAYEE-SEQ            PIC X.
  6080
  6081         16  AT-CASH-PAYMENT             PIC X.
  6082         16  AT-GROUPED-PAYMENT          PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 112
* EL130.cbl
  6083         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6084         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6085         16  AT-APPROVED-LEVEL           PIC X.
  6086         16  AT-VOID-TYPE                PIC X.
  6087             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6088             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6089         16  AT-AIG-UNEMP-IND            PIC X.
  6090             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6091         16  AT-ASSOCIATES               PIC X.
  6092             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6093             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6094
  6095         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6096         16  AT-CV-PMT-CODE              PIC X.
  6097             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6098             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6099             88  FULL-ADD-PAYMENT           VALUE '3'.
  6100             88  HALF-ADD-PAYMENT           VALUE '4'.
  6101             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6102             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6103             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6104             88  ADDL-PAYMENT               VALUE '8'.
  6105
  6106         16  AT-EOB-CODE1                PIC XXX.
  6107         16  AT-EOB-CODE2                PIC XXX.
  6108         16  AT-EOB-CODE3                PIC XXX.
  6109         16  FILLER REDEFINES AT-EOB-CODE3.
  6110             20  AT-PRINT-CLM-FORM       PIC X.
  6111             20  AT-PRINT-SURVEY         PIC X.
  6112             20  AT-SPECIAL-RELEASE      PIC X.
  6113         16  AT-EOB-CODE4                PIC XXX.
  6114         16  FILLER REDEFINES AT-EOB-CODE4.
  6115             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6116             20  FILLER                  PIC X.
  6117         16  AT-EOB-CODE5                PIC XXX.
  6118         16  FILLER REDEFINES AT-EOB-CODE5.
  6119             20  AT-PMT-PROOF-DT         PIC XX.
  6120             20  FILLER                  PIC X.
  6121
  6122         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6123             88  AT-PRINT-EOB            VALUE 'Y'.
  6124
  6125         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6126         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6127
  6128     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6129         16  AT-SCHEDULE-START-DT        PIC XX.
  6130         16  AT-SCHEDULE-END-DT          PIC XX.
  6131         16  AT-TERMINATED-DT            PIC XX.
  6132         16  AT-LAST-PMT-TYPE            PIC X.
  6133             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6134             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6135         16  AT-FIRST-PMT-DATA.
  6136             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6137             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6138             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6139         16  AT-REGULAR-PMT-DATA.
  6140             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 113
* EL130.cbl
  6141             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6142             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6143         16  AT-AUTO-PAYEE-CD.
  6144             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6145                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6146                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6147                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6148                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6149                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6150             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6151         16  AT-AUTO-PAY-DAY             PIC 99.
  6152         16  AT-AUTO-CASH                PIC X.
  6153             88  AT-CASH                      VALUE 'Y'.
  6154             88  AT-NON-CASH                  VALUE 'N'.
  6155*        16  FILLER                      PIC X(129).
  6156         16  AT-AUTO-END-LETTER          PIC X(4).
  6157         16  FILLER                      PIC X(125).
  6158
  6159         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6160         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6161
  6162     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6163         16  AT-LETTER-SENT-DT           PIC XX.
  6164         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6165         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6166         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6167         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6168         16  AT-LETTER-ORIGIN            PIC X.
  6169             88  ONLINE-CREATION              VALUE '1' '3'.
  6170             88  OFFLINE-CREATION             VALUE '2' '4'.
  6171             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6172             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6173         16  AT-STD-LETTER-FORM          PIC X(4).
  6174         16  AT-REASON-TEXT              PIC X(70).
  6175         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6176         16  AT-ADDRESEE-TYPE            PIC X.
  6177              88  INSURED-ADDRESEE            VALUE 'I'.
  6178              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6179              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6180              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6181              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6182              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6183              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6184         16  AT-ADDRESSEE-NAME           PIC X(30).
  6185         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6186         16  AT-RESEND-PRINT-DATE        PIC XX.
  6187         16  AT-CORR-SOL-UNSOL           PIC X.
  6188         16  AT-LETTER-PURGED-DT         PIC XX.
  6189*
  6190*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6191*
  6192         16  AT-CSO-REDEFINITION.
  6193             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6194             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6195             20  AT-LETTER-TO-BENE       PIC X(1).
  6196             20  AT-STOP-LETTER-DT       PIC X(2).
  6197             20  AT-AUTH-RCVD            PIC X(1).
  6198             20  FILLER                  PIC X(18).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 114
* EL130.cbl
  6199*             20  FILLER                  PIC X(27).
  6200             20  AT-CSO-LETTER-STATUS    PIC X.
  6201                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6202                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  6203                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6204             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6205             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6206*
  6207*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6208*
  6209*        16  FILLER                      PIC X(26).
  6210*
  6211*        16  AT-DMD-BSR-CODE             PIC X.
  6212*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6213*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6214*
  6215*        16  AT-DMD-LETTER-STATUS        PIC X.
  6216*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6217*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6218*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6219*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6220*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6221
  6222         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6223         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6224
  6225     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6226         16  AT-ADDRESS-TYPE             PIC X.
  6227             88  INSURED-ADDRESS               VALUE 'I'.
  6228             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6229             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6230             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6231             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6232             88  OTHER-ADDRESS-1               VALUE 'O'.
  6233             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6234         16  AT-MAIL-TO-NAME             PIC X(30).
  6235         16  AT-ADDRESS-LINE-1           PIC X(30).
  6236         16  AT-ADDRESS-LINE-2           PIC X(30).
  6237         16  AT-CITY-STATE.
  6238             20  AT-CITY                 PIC X(28).
  6239             20  AT-STATE                PIC XX.
  6240         16  AT-ZIP.
  6241             20  AT-ZIP-CODE.
  6242                 24  AT-ZIP-1ST          PIC X.
  6243                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6244                 24  FILLER              PIC X(4).
  6245             20  AT-ZIP-PLUS4            PIC X(4).
  6246         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6247             20  AT-CAN-POSTAL-1         PIC XXX.
  6248             20  AT-CAN-POSTAL-2         PIC XXX.
  6249             20  FILLER                  PIC XXX.
  6250         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6251*         16  FILLER                      PIC X(23).
  6252         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6253         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6254         16  FILLER                      PIC X(13).
  6255         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6256         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 115
* EL130.cbl
  6257
  6258     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6259         16  AT-INFO-LINE-1              PIC X(60).
  6260         16  FILLER REDEFINES AT-INFO-LINE-1.
  6261             20  AT-NOTE-ERROR-NO OCCURS 15
  6262                                         PIC X(4).
  6263         16  AT-INFO-LINE-2              PIC X(60).
  6264         16  FILLER REDEFINES AT-INFO-LINE-2.
  6265             20  AT-ICD-CODE-1           PIC X(8).
  6266             20  AT-ICD-CODE-2           PIC X(8).
  6267             20  FILLER                  PIC X(44).
  6268         16  AT-INFO-TRAILER-TYPE        PIC X.
  6269             88  AT-ERRORS-NOTE          VALUE 'E'.
  6270             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6271             88  AT-CALL-NOTE            VALUE 'C'.
  6272             88  AT-MAINT-NOTE           VALUE 'M'.
  6273             88  AT-CERT-CHANGE          VALUE 'X'.
  6274             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6275             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6276             88  AT-CERT-CANCELLED       VALUE 'T'.
  6277         16  AT-CALL-TYPE                PIC X.
  6278             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6279             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6280         16  AT-NOTE-CONTINUATION        PIC X.
  6281             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6282         16  AT-EOB-CODES-EXIST          PIC X.
  6283             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6284         16  FILLER                      PIC X(35).
  6285         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6286         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6287
  6288     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6289         16  AT-PROMPT-LINE-1            PIC X(60).
  6290         16  AT-PROMPT-LINE-2            PIC X(60).
  6291         16  AT-PROMPT-START-DT          PIC XX.
  6292         16  AT-PROMPT-END-DT            PIC XX.
  6293         16  FILLER                      PIC X(35).
  6294         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6295         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6296
  6297     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6298         16  AT-DENIAL-INFO-1            PIC X(60).
  6299         16  AT-DENIAL-INFO-2            PIC X(60).
  6300         16  AT-DENIAL-DT                PIC XX.
  6301         16  AT-RETRACTION-DT            PIC XX.
  6302         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6303*         16  FILLER                      PIC X(31).
  6304         16  AT-DENIAL-PROOF-DT          PIC XX.
  6305         16  FILLER                      PIC X(29).
  6306         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6307         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6308
  6309     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6310         16  AT-OLD-INCURRED-DT          PIC XX.
  6311         16  AT-OLD-REPORTED-DT          PIC XX.
  6312         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6313         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6314         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 116
* EL130.cbl
  6315         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6316         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6317         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6318         16  FILLER                      PIC X(26).
  6319         16  AT-OLD-DIAG-CODE            PIC X(6).
  6320         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6321         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6322         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6323         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6324         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6325         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6326         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6327         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6328         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6329         16  FILLER                      PIC X(9).
  6330         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6331
  6332     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6333         16  AT-FORM-SEND-ON-DT          PIC XX.
  6334         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6335         16  AT-FORM-RE-SEND-DT          PIC XX.
  6336         16  AT-FORM-ANSWERED-DT         PIC XX.
  6337         16  AT-FORM-PRINTED-DT          PIC XX.
  6338         16  AT-FORM-REPRINT-DT          PIC XX.
  6339         16  AT-FORM-TYPE                PIC X.
  6340             88  INITIAL-FORM                  VALUE '1'.
  6341             88  PROGRESS-FORM                 VALUE '2'.
  6342         16  AT-INSTRUCT-LN-1            PIC X(28).
  6343         16  AT-INSTRUCT-LN-2            PIC X(28).
  6344         16  AT-INSTRUCT-LN-3            PIC X(28).
  6345         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6346         16  AT-FORM-ADDRESS             PIC X.
  6347             88  FORM-TO-INSURED              VALUE 'I'.
  6348             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6349             88  FORM-TO-OTHER-1              VALUE 'O'.
  6350             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6351         16  AT-RELATED-1.
  6352             20 AT-REL-CARR-1            PIC X.
  6353             20 AT-REL-CLAIM-1           PIC X(7).
  6354             20 AT-REL-CERT-1            PIC X(11).
  6355         16  AT-RELATED-2.
  6356             20 AT-REL-CARR-2            PIC X.
  6357             20 AT-REL-CLAIM-2           PIC X(7).
  6358             20 AT-REL-CERT-2            PIC X(11).
  6359         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6360         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6361         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6362         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6363         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6364         16  AT-STOP-FORM-DT             PIC X(2).
  6365
  6366         16  FILLER                      PIC X(09).
  6367         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6368         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6369******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 117
* EL130.cbl
  6371*    COPY ELCBENE.
  6372******************************************************************
  6373*                                                                *
  6374*                            ELCBENE.                            *
  6375*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6376*                            VMOD=2.006                          *
  6377*                                                                *
  6378*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  6379*                                                                *
  6380*   FILE TYPE = VSAM,KSDS                                        *
  6381*   RECORD SIZE = 500   RECFORM = FIX                            *
  6382*                                                                *
  6383*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  6384*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  6385*                                                                *
  6386*   LOG = YES                                                    *
  6387*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6388*                                                                *
  6389*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  6390******************************************************************
  6391*                   C H A N G E   L O G
  6392*
  6393* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6394*-----------------------------------------------------------------
  6395*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6396* EFFECTIVE    NUMBER
  6397*-----------------------------------------------------------------
  6398* 013017  CR2016053100001  PEMA  ACH PROCESSING
  6399* 082317  CR2017082100003  PEMA  Add sub type
  6400******************************************************************
  6401
  6402 01  BENEFICIARY-MASTER.
  6403     12  BE-RECORD-ID                PIC XX.
  6404         88  VALID-BE-ID                VALUE 'BE'.
  6405
  6406     12  BE-CONTROL-PRIMARY.
  6407         16  BE-COMPANY-CD           PIC X.
  6408         16  BE-RECORD-TYPE          PIC X.
  6409             88  BENEFICIARY-RECORD  VALUE 'B'.
  6410             88  ADJUSTOR-RECORD     VALUE 'A'.
  6411         16  BE-BENEFICIARY          PIC X(10).
  6412     12  BE-CONTROL-BY-NAME.
  6413         16  BE-COMPANY-CD-A1        PIC X.
  6414         16  BE-RECORD-TYPE-A1       PIC X.
  6415         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  6416         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  6417
  6418     12  BE-LAST-MAINT-DT            PIC XX.
  6419     12  BE-LAST-MAINT-BY            PIC X(4).
  6420     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  6421
  6422     12  BE-ADDRESS-DATA.
  6423         16  BE-MAIL-TO-NAME         PIC X(30).
  6424         16  BE-ADDRESS-LINE-1       PIC X(30).
  6425         16  BE-ADDRESS-LINE-2       PIC X(30).
  6426         16  BE-ADDRESS-LINE-3       PIC X(30).
  6427         16  BE-CITY-STATE.
  6428             20  BE-CITY             PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 118
* EL130.cbl
  6429             20  BE-STATE            PIC XX.
  6430         16  BE-ZIP-CODE.
  6431             20  BE-ZIP-PRIME.
  6432                 24  BE-ZIP-1ST      PIC X.
  6433                     88  BE-CANADIAN-POST-CODE
  6434                                         VALUE 'A' THRU 'Z'.
  6435                 24  FILLER          PIC X(4).
  6436             20  BE-ZIP-PLUS4        PIC X(4).
  6437         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  6438             20  BE-CAN-POSTAL-1     PIC XXX.
  6439             20  BE-CAN-POSTAL-2     PIC XXX.
  6440             20  FILLER              PIC XXX.
  6441         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  6442         16  BE-GROUP-CHECKS-Y-N     PIC X.
  6443
  6444******************************************************************
  6445*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  6446*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  6447******************************************************************
  6448     12  BE-CARRIER                  PIC X.
  6449
  6450     12  BE-ADDRESS-DATA2.
  6451         16  BE-MAIL-TO-NAME2        PIC X(30).
  6452         16  BE-ADDRESS-LINE-12      PIC X(30).
  6453         16  BE-ADDRESS-LINE-22      PIC X(30).
  6454         16  BE-ADDRESS-LINE-32      PIC X(30).
  6455         16  BE-CITY-STATE2.
  6456             20  BE-CITY2            PIC X(28).
  6457             20  BE-STATE2           PIC XX.
  6458         16  BE-ZIP-CODE2.
  6459             20  BE-ZIP-PRIME2.
  6460                 24  BE-ZIP-1ST2     PIC X.
  6461                     88  BE-CANADIAN-POST-CODE2
  6462                                         VALUE 'A' THRU 'Z'.
  6463                 24  FILLER          PIC X(4).
  6464             20  BE-ZIP-PLUS42       PIC X(4).
  6465         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  6466             20  BE-CAN-POSTAL-12    PIC XXX.
  6467             20  BE-CAN-POSTAL-22    PIC XXX.
  6468             20  FILLER              PIC XXX.
  6469         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  6470         16  BE-ACH-DATA.
  6471             20  BE-ACH-YES-OR-NO    PIC X.
  6472                 88  BE-ON-ACH       VALUE 'Y'.
  6473                 88  BE-NOT-ON-ACH   VALUE 'N' ' '.
  6474             20  BE-ACH-ABA-ROUTING-NUMBER
  6475                                     PIC X(15).
  6476             20  BE-ACH-BANK-ACCOUNT-NUMBER
  6477                                     PIC X(20).
  6478             20  BE-ACH-SUB-TYPE     PIC XX.
  6479             20  FILLER              PIC X(23).
  6480         16  BE-BILLING-STMT-DATA.
  6481*            20  BE-BSR              PIC X.
  6482*                88  BE-AUTOMATED-BSR      VALUE 'A'.
  6483*                88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  6484*            20  BE-BSR-FROM         PIC X(30).
  6485*            20  BE-BSR-DEPT         PIC X(30).
  6486             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 119
* EL130.cbl
  6487             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  6488             20  BE-OUTPUT-TYPE      PIC X.
  6489                 88  BE-FAX-OUTPUT         VALUE 'F'.
  6490                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  6491
  6492     12  FILLER                      PIC X(28).
  6493******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 120
* EL130.cbl
  6495*    COPY ELCDAR.
  6496******************************************************************
  6497*                                                                *
  6498*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  6499*   FILE TYPE = VSAM,KSDS                                        *
  6500*   RECORD SIZE = 25   RECFORM = FIXED                           *
  6501*   BASE CLUSTER = DLYACTV                                       *
  6502*   LOG = YES                                                    *
  6503*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  6504*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  6505*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  6506*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  6507*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  6508*               BY PROGRAM "LGINFCE".                            *
  6509*                                                                *
  6510******************************************************************
  6511 01  DAILY-ACTIVITY-RECORD.
  6512     05  DA-KEY.
  6513         10  DA-COMP-CD          PIC X.
  6514         10  DA-CARRIER          PIC X.
  6515         10  DA-CLAIM-NO         PIC X(7).
  6516         10  DA-CERT-NO.
  6517             15  DA-CERT-PRIME   PIC X(10).
  6518             15  DA-CERT-SFX     PIC X.
  6519     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  6520     05  DA-RECORD-TYPE          PIC X.
  6521     05  FILLER                  PIC X(2).
  6522******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 121
* EL130.cbl
  6524*    COPY ELCACTQ.
  6525******************************************************************
  6526*                                                                *
  6527*                            ELCACTQ.                            *
  6528*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6529*                            VMOD=2.004                          *
  6530*                                                                *
  6531*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6532*                                                                *
  6533*   FILE TYPE = VSAM,KSDS                                        *
  6534*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6535*                                                                *
  6536*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6537*       ALTERNATE INDEX = NONE                                   *
  6538*                                                                *
  6539*   LOG = YES                                                    *
  6540*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6541*                                                                *
  6542*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6543******************************************************************
  6544
  6545 01  ACTIVITY-QUE.
  6546     12  AQ-RECORD-ID                PIC XX.
  6547         88  VALID-AQ-ID                VALUE 'AQ'.
  6548
  6549     12  AQ-CONTROL-PRIMARY.
  6550         16  AQ-COMPANY-CD           PIC X.
  6551         16  AQ-CARRIER              PIC X.
  6552         16  AQ-CLAIM-NO             PIC X(7).
  6553         16  AQ-CERT-NO.
  6554             20  AQ-CERT-PRIME       PIC X(10).
  6555             20  AQ-CERT-SFX         PIC X.
  6556
  6557     12  AQ-PENDING-ACTIVITY-FLAGS.
  6558         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6559         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6560             88  PENDING-PAYMENTS       VALUE '1'.
  6561         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6562             88  PENDING-FULL-PRINT     VALUE '1'.
  6563             88  PENDING-PART-PRINT     VALUE '2'.
  6564         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6565             88  PENDING-LETTERS        VALUE '1'.
  6566         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6567             88  PENDING-RESTORE        VALUE 'C'.
  6568             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6569
  6570     12  FILLER                      PIC X(20).
  6571
  6572     12  AQ-RESEND-DATE              PIC XX.
  6573     12  AQ-FOLLOWUP-DATE            PIC XX.
  6574     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6575     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6576     12  AQ-AUTO-LETTER              PIC X(4).
  6577     12  FILLER                      PIC XX.
  6578     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6579*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 122
* EL130.cbl
  6581*    COPY ELCARCH.
  6582******************************************************************
  6583*                                                                *
  6584*                            ELCARCH.                            *
  6585*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6586*                            VMOD=2.007                          *
  6587*                                                                *
  6588*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  6589*                                                                *
  6590*   FILE TYPE = VSAM,KSDS                                        *
  6591*   RECORD SIZE = 090  RECFORM = FIXED                           *
  6592*                                                                *
  6593*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  6594*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  6595*                                                                *
  6596*   LOG = NO                                                     *
  6597*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6598*                                                                *
  6599*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  6600******************************************************************
  6601 01  LETTER-ARCHIVE.
  6602     12  LA-RECORD-ID                PIC XX.
  6603         88  VALID-LA-ID                VALUE 'LA'.
  6604
  6605     12  LA-CONTROL-PRIMARY.
  6606         16  LA-COMPANY-CD           PIC X.
  6607         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  6608         16  LA-RECORD-TYPE          PIC X.
  6609             88  LA-HEADER-DATA         VALUE '1'.
  6610             88  LA-ADDRESS-DATA        VALUE '2'.
  6611             88  LA-TEXT-DATA           VALUE '3'.
  6612             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  6613         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  6614
  6615     12  LA-CONTROL-BY-TYPE.
  6616         16  LA-COMPANY-CD-A1        PIC X.
  6617         16  LA-RECORD-TYPE-A1       PIC X.
  6618         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  6619         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  6620
  6621     12  LA-TEXT-RECORD.
  6622         16  LA-SKIP-CONTROL         PIC XX.
  6623             88  NO-LINES-SKIPPED       VALUE SPACES.
  6624             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  6625         16  LA-TEXT-LINE            PIC X(70).
  6626
  6627     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  6628         16  FILLER                  PIC XX.
  6629         16  LA-ADDRESS-LINE         PIC X(30).
  6630         16  FILLER                  PIC X(40).
  6631
  6632     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  6633         16  FILLER                  PIC XX.
  6634         16  LA-CARRIER              PIC X.
  6635         16  LA-CLAIM-NO             PIC X(7).
  6636         16  LA-CERT-NO.
  6637             20  LA-CERT-PRIME       PIC X(10).
  6638             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 123
* EL130.cbl
  6639         16  LA-NO-OF-COPIES         PIC S9.
  6640         16  LA-RESEND-DATE          PIC XX.
  6641         16  LA-PROCESSOR-CD         PIC X(4).
  6642         16  LA-CREATION-DT          PIC XX.
  6643         16  LA-INITIAL-PRINT-DATE   PIC XX.
  6644         16  LA-RESEND-PRINT-DATE    PIC XX.
  6645         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  6646         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  6647*
  6648* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  6649*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  6650*   I        20  LA-DMD-PROD-CODE        PIC XX.
  6651*   I        20  LA-DMD-RES-ST           PIC XX.
  6652*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  6653*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  6654*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  6655*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  6656*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  6657*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  6658*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  6659*   I        20  LA-DMD-UND-CODE         PIC XX.
  6660*   I        20  LA-DMD-BEN-CODE         PIC XX.
  6661*   V    16  FILLER                  PIC X(15).
  6662* -----
  6663*
  6664* REINSERTED  CSO  MODS
  6665*
  6666         16  FILLER.
  6667             20  FILLER                  PIC X(29).
  6668             20  LA-CSO-LETTER-STATUS    PIC X.
  6669                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  6670                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  6671                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  6672             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  6673             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  6674*
  6675
  6676     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  6677         16  FILLER                  PIC XX.
  6678         16  LA4-CARRIER             PIC X.
  6679         16  LA4-CLAIM-NO            PIC X(7).
  6680         16  LA4-CERT-NO.
  6681             20  LA4-CERT-PRIME      PIC X(10).
  6682             20  LA4-CERT-SFX        PIC X.
  6683         16  LA4-NO-OF-COPIES        PIC S9.
  6684         16  LA4-RESEND-DATE         PIC XX.
  6685         16  LA4-PROCESSOR-CD        PIC X(4).
  6686         16  LA4-CREATION-DT         PIC XX.
  6687         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  6688         16  LA4-RESEND-PRINT-DATE   PIC XX.
  6689         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  6690         16  LA4-FORM-TYPE           PIC X.
  6691             88  LA4-INITIAL-FORM    VALUE '1'.
  6692             88  LA4-PROGRESS-FORM   VALUE '2'.
  6693         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  6694         16  LA4-STATE               PIC X(02).
  6695         16  FILLER                  PIC X(31).
  6696******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 124
* EL130.cbl
  6698*    COPY ERCREIN.
  6699******************************************************************
  6700*                                                                *
  6701*                            ERCREIN                             *
  6702*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6703*                            VMOD=2.010                          *
  6704*                                                                *
  6705*   ONLINE CREDIT SYSTEM                                         *
  6706*                                                                *
  6707*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *
  6708*                                                                *
  6709*   FILE TYPE = VSAM,KSDS                                        *
  6710*   RECORD SIZE = 4000  RECFORM = FIXED                          *
  6711*                                                                *
  6712*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *
  6713*       ALTERNATE PATH = NONE                                    *
  6714*                                                                *
  6715*   LOG = NO                                                     *
  6716*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6717*                                                                *
  6718******************************************************************
  6719*                   C H A N G E   L O G
  6720*
  6721* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6722*-----------------------------------------------------------------
  6723*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6724* EFFECTIVE    NUMBER
  6725*-----------------------------------------------------------------
  6726* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
  6727* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
  6728******************************************************************
  6729 01  REINSURANCE-RECORD.
  6730     12  RE-RECORD-ID                      PIC XX.
  6731         88  VALID-RE-ID                      VALUE 'RE'.
  6732
  6733     12  RE-CONTROL-PRIMARY.
  6734         16  RE-COMPANY-CD                 PIC X.
  6735         16  RE-KEY.
  6736             20  RE-CODE                   PIC X.
  6737                 88  RE-TABLE-RECORD          VALUE 'A'.
  6738                 88  RE-COMPANY-RECORD        VALUE 'B'.
  6739             20  RE-TABLE                  PIC XXX.
  6740             20  FILLER                    PIC XXX.
  6741         16  RE-COMPANY-KEY REDEFINES RE-KEY.
  6742             20  FILLER                    PIC X.
  6743             20  RE-COMPANY.
  6744                 24  RE-COMP-PRIME         PIC XXX.
  6745                 24  RE-COMP-SUB           PIC XXX.
  6746
  6747     12  RE-MAINT-INFORMATION.
  6748         16  RE-LAST-MAINT-DT              PIC XX.
  6749         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6750         16  RE-LAST-MAINT-USER            PIC X(4).
  6751         16  FILLER                        PIC X(10).
  6752
  6753     12  RE-TABLE-DATA.
  6754         16  RE-100-COMP                   PIC 99.
  6755
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 125
* EL130.cbl
  6756         16  RE-COMP-INFO    OCCURS 30 TIMES.
  6757             20  RE-REI-COMP-NO.
  6758                 24  RE-REI-COMP           PIC XXX.
  6759                 24  RE-REI-COMP-SUB       PIC XXX.
  6760             20  RE-LF-QC                  PIC X.
  6761             20  RE-AH-QC                  PIC X.
  6762             20  RE-LO-DATE                PIC 9(11)     COMP-3.
  6763             20  RE-HI-DATE                PIC 9(11)     COMP-3.
  6764             20  RE-LFAGE-LO               PIC 99.
  6765             20  RE-LFAGE-HI               PIC 99.
  6766             20  RE-AHAGE-LO               PIC 99.
  6767             20  RE-AHAGE-HI               PIC 99.
  6768             20  RE-LFTRM-LO               PIC S999       COMP-3.
  6769             20  RE-LFTRM-HI               PIC S999       COMP-3.
  6770             20  RE-AHTRM-LO               PIC S999       COMP-3.
  6771             20  RE-AHTRM-HI               PIC S999       COMP-3.
  6772             20  RE-LF-PCT                 PIC S9V9999    COMP-3.
  6773             20  RE-AH-PCT                 PIC S9V9999    COMP-3.
  6774             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3.
  6775             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3.
  6776             20  RE-LF-LO                  PIC S9(9)V99   COMP-3.
  6777             20  RE-LF-HI                  PIC S9(9)V99   COMP-3.
  6778             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3.
  6779             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3.
  6780             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3.
  6781             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3.
  6782             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3.
  6783             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3.
  6784             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3.
  6785             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3.
  6786             20  RE-LF-BEN-CODE            PIC X.
  6787             20  RE-AH-BEN-CODE            PIC X.
  6788             20  RE-INTERACTIVE            PIC X.
  6789             20  RE-REMAINING              PIC X.
  6790             20  RE-LF-RUNOFF-SW           PIC X.
  6791             20  RE-AH-RUNOFF-SW           PIC X.
  6792             20  FILLER                    PIC X(19).
  6793
  6794         16  RE-COMP-INFO-END              PIC X(6).
  6795         16  RE-NSP-ST-CD-LF               PIC XX.
  6796         16  RE-NSP-ST-CD-AH               PIC XX.
  6797         16  RE-TABLE-CARRIER-SECURITY     PIC X.
  6798             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.
  6799
  6800         16  FILLER                        PIC X(27).
  6801
  6802     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.
  6803         16  RE-NAME                       PIC X(30).
  6804         16  RE-LF-PE                      PIC X.
  6805         16  RE-AH-PE                      PIC X.
  6806         16  RE-LF-FEE                     PIC S9V9999    COMP-3.
  6807         16  RE-AH-FEE                     PIC S9V9999    COMP-3.
  6808         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3.
  6809         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3.
  6810         16  RE-PRT-ST                     PIC X.
  6811         16  RE-PRT-OW                     PIC X.
  6812         16  RE-MORT-CODE                  PIC X(4).
  6813         16  RE-CLAIM-CODE                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 126
* EL130.cbl
  6814         16  RE-ZERO-LF-FEE                PIC X.
  6815         16  RE-ZERO-AH-FEE                PIC X.
  6816         16  RE-CEDE-NAME                  PIC X(30).
  6817         16  RE-LF-COMM                    PIC X.
  6818         16  RE-AH-COMM                    PIC X.
  6819         16  RE-LF-TAX                     PIC X.
  6820         16  RE-AH-TAX                     PIC X.
  6821         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.
  6822         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3.
  6823         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3.
  6824
  6825         16  RE-COMP-CARRIER-SECURITY      PIC X.
  6826             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.
  6827
  6828         16  RE-LF-CEDING-FEE-BRACKETS.
  6829             20  RE-LF-FEE-METHOD          PIC X.
  6830                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.
  6831                 88  RE-LF-FEE-METHOD-1          VALUE '1'.
  6832                 88  RE-LF-FEE-METHOD-2          VALUE '2'.
  6833                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.
  6834             20  RE-LF-FEE-BASIS           PIC X.
  6835                 88  RE-LF-GROSS-CEDED             VALUE '1'.
  6836                 88  RE-LF-NET-CEDED               VALUE '2'.
  6837                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.
  6838                 88  RE-LF-NET-WRITTEN             VALUE '4'.
  6839                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.
  6840                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.
  6841                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6842                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.
  6843             20  FILLER                    PIC XXX.
  6844             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.
  6845                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6846                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6847
  6848         16  RE-AH-CEDING-FEE-BRACKETS.
  6849             20  RE-AH-FEE-METHOD          PIC X.
  6850                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.
  6851                 88  RE-AH-FEE-METHOD-1          VALUE '1'.
  6852                 88  RE-AH-FEE-METHOD-2          VALUE '2'.
  6853                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.
  6854             20  RE-AH-FEE-BASIS           PIC X.
  6855                 88  RE-AH-GROSS-CEDED             VALUE '1'.
  6856                 88  RE-AH-NET-CEDED               VALUE '2'.
  6857                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.
  6858                 88  RE-AH-NET-WRITTEN             VALUE '4'.
  6859                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.
  6860                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.
  6861                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.
  6862                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.
  6863             20  FILLER                    PIC XXX.
  6864             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.
  6865                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3.
  6866                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3.
  6867
  6868         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.
  6869
  6870         16  RE-OLD-CEDING-STMT            PIC X.
  6871
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 127
* EL130.cbl
  6872         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3.
  6873         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3.
  6874         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6875         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3.
  6876         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3.
  6877         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3.
  6878         16  RE-REINS-GROUPING-CODE        PIC X(6).
  6879         16  RE-MORT-SW                    PIC X.
  6880         16  RE-CEDING-TYPE-FLAG           PIC X.
  6881             88  RE-NO-CESSION-TYPE                VALUE ' '.
  6882             88  RE-CEDED                          VALUE 'C'.
  6883             88  RE-ASSUMED                        VALUE 'A'.
  6884             88  RE-PHANTOM                        VALUE 'P'.
  6885
  6886         16  RE-CEDING-STMT-OPT-A          PIC X.
  6887             88  REPORT-A-WANTED    VALUE ' ' 'Y'.
  6888         16  RE-CEDING-STMT-OPT-B          PIC X.
  6889             88  REPORT-B-WANTED    VALUE ' ' 'Y'.
  6890         16  RE-CEDING-STMT-OPT-C          PIC X.
  6891             88  REPORT-C-WANTED    VALUE ' ' 'Y'.
  6892         16  RE-CEDING-STMT-OPT-D          PIC X.
  6893             88  REPORT-D-WANTED    VALUE ' ' 'Y'.
  6894         16  RE-CEDING-STMT-OPT-E          PIC X.
  6895             88  REPORT-E-WANTED    VALUE ' ' 'Y'.
  6896
  6897         16  RE-PRT-CRSV                   PIC X.
  6898
  6899         16  RE-GL-CENTER                  PIC X(4).
  6900
  6901         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.
  6902
  6903         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.
  6904
  6905         16  RE-EARN-STOP-CODE             PIC X.
  6906             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.
  6907             88  STOP-AH-EARNING    VALUE 'A' 'B'.
  6908
  6909         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
  6910             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
  6911
  6912         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
  6913         16  FILLER                        PIC X(2281).
  6914
  6915         16  RE-DESC OCCURS 18 TIMES       PIC X(79).
  6916
  6917******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 128
* EL130.cbl
  6919*    COPY ERCMAIL.
  6920******************************************************************
  6921*                                                                *
  6922*                                                                *
  6923*                            ERCMAIL                             *
  6924*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6925*                            VMOD=2.003                          *
  6926*                                                                *
  6927*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6928*                                                                *
  6929*   FILE TYPE = VSAM,KSDS                                        *
  6930*   RECORD SIZE = 374   RECFORM = FIX                            *
  6931*                                                                *
  6932*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6933*   ALTERNATE PATH    = NOT USED                                 *
  6934*                                                                *
  6935*   LOG = YES                                                    *
  6936*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6937******************************************************************
  6938*                   C H A N G E   L O G
  6939*
  6940* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6941*-----------------------------------------------------------------
  6942*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6943* EFFECTIVE    NUMBER
  6944*-----------------------------------------------------------------
  6945* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6946* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6947* 111108                   PEMA  ADD CRED BENE ADDR2
  6948******************************************************************
  6949
  6950 01  MAILING-DATA.
  6951     12  MA-RECORD-ID                      PIC XX.
  6952         88  VALID-MA-ID                       VALUE 'MA'.
  6953
  6954     12  MA-CONTROL-PRIMARY.
  6955         16  MA-COMPANY-CD                 PIC X.
  6956         16  MA-CARRIER                    PIC X.
  6957         16  MA-GROUPING.
  6958             20  MA-GROUPING-PREFIX        PIC XXX.
  6959             20  MA-GROUPING-PRIME         PIC XXX.
  6960         16  MA-STATE                      PIC XX.
  6961         16  MA-ACCOUNT.
  6962             20  MA-ACCOUNT-PREFIX         PIC X(4).
  6963             20  MA-ACCOUNT-PRIME          PIC X(6).
  6964         16  MA-CERT-EFF-DT                PIC XX.
  6965         16  MA-CERT-NO.
  6966             20  MA-CERT-PRIME             PIC X(10).
  6967             20  MA-CERT-SFX               PIC X.
  6968
  6969     12  FILLER                            PIC XX.
  6970
  6971     12  MA-ACCESS-CONTROL.
  6972         16  MA-SOURCE-SYSTEM              PIC XX.
  6973             88  MA-FROM-CREDIT                VALUE 'CR'.
  6974             88  MA-FROM-VSI                   VALUE 'VS'.
  6975             88  MA-FROM-WARRANTY              VALUE 'WA'.
  6976             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 129
* EL130.cbl
  6977         16  MA-RECORD-ADD-DT              PIC XX.
  6978         16  MA-RECORD-ADDED-BY            PIC XXXX.
  6979         16  MA-LAST-MAINT-DT              PIC XX.
  6980         16  MA-LAST-MAINT-BY              PIC XXXX.
  6981         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6982
  6983     12  MA-PROFILE-INFO.
  6984         16  MA-QUALIFY-CODE-1             PIC XX.
  6985         16  MA-QUALIFY-CODE-2             PIC XX.
  6986         16  MA-QUALIFY-CODE-3             PIC XX.
  6987         16  MA-QUALIFY-CODE-4             PIC XX.
  6988         16  MA-QUALIFY-CODE-5             PIC XX.
  6989
  6990         16  MA-INSURED-LAST-NAME          PIC X(15).
  6991         16  MA-INSURED-FIRST-NAME         PIC X(10).
  6992         16  MA-INSURED-MIDDLE-INIT        PIC X.
  6993         16  MA-INSURED-ISSUE-AGE          PIC 99.
  6994         16  MA-INSURED-BIRTH-DT           PIC XX.
  6995         16  MA-INSURED-SEX                PIC X.
  6996             88  MA-SEX-MALE                   VALUE 'M'.
  6997             88  MA-SEX-FEMALE                 VALUE 'F'.
  6998         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  6999
  7000         16  MA-ADDRESS-CORRECTED          PIC X.
  7001         16  MA-JOINT-BIRTH-DT             PIC XX.
  7002*        16  FILLER                        PIC X(12).
  7003
  7004         16  MA-ADDRESS-LINE-1             PIC X(30).
  7005         16  MA-ADDRESS-LINE-2             PIC X(30).
  7006         16  MA-CITY-STATE.
  7007             20  MA-CITY                   PIC X(28).
  7008             20  MA-ADDR-STATE             PIC XX.
  7009         16  MA-ZIP.
  7010             20  MA-ZIP-CODE.
  7011                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7012                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7013                 24  FILLER                PIC X(4).
  7014             20  MA-ZIP-PLUS4              PIC X(4).
  7015         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7016             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7017             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7018             20  FILLER                    PIC X(3).
  7019
  7020         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7021
  7022         16  FILLER                        PIC XXX.
  7023*        16  FILLER                        PIC X(10).
  7024
  7025     12  MA-CRED-BENE-INFO.
  7026         16  MA-CRED-BENE-NAME                 PIC X(25).
  7027         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7028         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7029         16  MA-CRED-BENE-CTYST.
  7030             20  MA-CRED-BENE-CITY             PIC X(28).
  7031             20  MA-CRED-BENE-STATE            PIC XX.
  7032         16  MA-CRED-BENE-ZIP.
  7033             20  MA-CB-ZIP-CODE.
  7034                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 130
* EL130.cbl
  7035                     88  MA-CB-CANADIAN-POST-CODE
  7036                                           VALUE 'A' THRU 'Z'.
  7037                 24  FILLER                    PIC X(4).
  7038             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7039         16  MA-CB-CANADIAN-POSTAL-CODE
  7040                            REDEFINES MA-CRED-BENE-ZIP.
  7041             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7042             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7043             20  FILLER                        PIC X(3).
  7044     12  MA-POST-CARD-MAIL-DATA.
  7045         16  MA-MAIL-DATA OCCURS 7.
  7046             20  MA-MAIL-TYPE              PIC X.
  7047                 88  MA-12MO-MAILING           VALUE '1'.
  7048                 88  MA-EXP-MAILING            VALUE '2'.
  7049             20  MA-MAIL-STATUS            PIC X.
  7050                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7051                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7052                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7053             20  MA-MAIL-DATE              PIC XX.
  7054     12  FILLER                            PIC XX.
  7055     12  FILLER                            PIC XX.
  7056*    12  FILLER                            PIC X(30).
  7057******************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 131
* EL130.cbl
  7059*    COPY ELCCRTT.
  7060******************************************************************
  7061*                                                                *
  7062*                            ELCCRTT.                            *
  7063*                                                                *
  7064*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7065*                                                                *
  7066*   FILE TYPE = VSAM,KSDS                                        *
  7067*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7068*                                                                *
  7069*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7070*                                                                *
  7071*   LOG = YES                                                    *
  7072*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7073******************************************************************
  7074*                   C H A N G E   L O G
  7075*
  7076* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7077*-----------------------------------------------------------------
  7078*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7079* EFFECTIVE    NUMBER
  7080*-----------------------------------------------------------------
  7081* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7082* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7083* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7084* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7085* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7086* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7087* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7088* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7089* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7090******************************************************************
  7091
  7092 01  CERTIFICATE-TRAILERS.
  7093     12  CS-RECORD-ID                      PIC XX.
  7094         88  VALID-CS-ID                      VALUE 'CS'.
  7095
  7096     12  CS-CONTROL-PRIMARY.
  7097         16  CS-COMPANY-CD                 PIC X.
  7098         16  CS-CARRIER                    PIC X.
  7099         16  CS-GROUPING                   PIC X(6).
  7100         16  CS-STATE                      PIC XX.
  7101         16  CS-ACCOUNT                    PIC X(10).
  7102         16  CS-CERT-EFF-DT                PIC XX.
  7103         16  CS-CERT-NO.
  7104             20  CS-CERT-PRIME             PIC X(10).
  7105             20  CS-CERT-SFX               PIC X.
  7106         16  CS-TRAILER-TYPE               PIC X.
  7107             88  COMM-TRLR           VALUE 'A'.
  7108             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7109             88  CERT-DATA-TRLR      VALUE 'C'.
  7110
  7111     12  CS-DATA-AREA                      PIC X(516).
  7112
  7113     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7114         16  CS-BANK-COMMISSION-AREA.
  7115             20  CS-BANK-COMMS       OCCURS 10.
  7116                 24  CS-AGT                PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 132
* EL130.cbl
  7117                 24  CS-COM-TYP            PIC X.
  7118                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7119                 24  CS-RECALC-LV-INDIC    PIC X.
  7120                 24  FILLER                PIC X(10).
  7121         16  FILLER                        PIC X(256).
  7122
  7123     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7124****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7125         16  CS-MB-CLAIM-DATA OCCURS 24.
  7126             20  CS-CLAIM-NO               PIC X(7).
  7127             20  CS-CLAIM-TYPE             PIC X.
  7128                 88  CS-AH-CLM               VALUE 'A'.
  7129                 88  CS-IU-CLM               VALUE 'I'.
  7130                 88  CS-GP-CLM               VALUE 'G'.
  7131                 88  CS-LF-CLM               VALUE 'L'.
  7132                 88  CS-PR-CLM               VALUE 'P'.
  7133                 88  CS-FL-CLM               VALUE 'F'.
  7134             20  CS-INSURED-TYPE           PIC X.
  7135                 88  CS-PRIM-INSURED          VALUE 'P'.
  7136                 88  CS-CO-BORROWER           VALUE 'C'.
  7137             20  CS-BENEFIT-PERIOD         PIC 99.
  7138             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  7139             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  7140             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  7141         16  FILLER                        PIC X(12).
  7142     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  7143         16  CS-VIN-NUMBER                 PIC X(17).
  7144         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  7145         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  7146         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  7147         16  cs-agent-name.
  7148             20  cs-agent-fname            pic x(20).
  7149             20  cs-agent-mi               pic x.
  7150             20  cs-agent-lname            pic x(25).
  7151         16  cs-license-no                 pic x(15).
  7152         16  cs-npn-number                 pic x(10).
  7153         16  cs-agent-edit-status          pic x.
  7154             88  cs-ae-refer-to-manager      value 'M'.
  7155             88  cs-ae-cover-sheet           value 'C'.
  7156             88  cs-ae-sig-form              value 'S'.
  7157             88  cs-ae-verified              value 'V'.
  7158             88  cs-unidentified-signature   value 'U'.
  7159             88  cs-cert-returned            value 'R'.
  7160             88  cs-accept-no-commission     value 'N'.
  7161         16  cs-year                       pic 9999.
  7162         16  cs-make                       pic x(20).
  7163         16  cs-model                      pic x(20).
  7164         16  cs-future                     pic x(20).
  7165         16  cs-vehicle-odometer           pic s9(7) comp-3.
  7166         16  FILLER                        PIC X(356). *> was 420
  7167*        16  FILLER                        PIC X(496).
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 133
* EL130.cbl
  7169
  7170 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  7171                          CONTROL-FILE CERTIFICATE-MASTER
  7172                          ACCOUNT-MASTER ACTIVITY-TRAILERS
  7173                          BENEFICIARY-MASTER
  7174                          DAILY-ACTIVITY-RECORD ACTIVITY-QUE
  7175                          LETTER-ARCHIVE REINSURANCE-RECORD
  7176                          MAILING-DATA CERTIFICATE-TRAILERS.
  7177 0000-DFHEXIT SECTION.
  7178     MOVE '9#                    $   ' TO DFHEIV0.
  7179     MOVE 'EL130' TO DFHEIV1.
  7180     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  7181     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  7182     MOVE '5'                    TO DC-OPTION-CODE.
  7183     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  7184     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  7185     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  7186
  7187     IF EIBCALEN = ZERO
  7188         GO TO 8800-UNAUTHORIZED-ACCESS
  7189     END-IF.
  7190
  7191     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  7192     MOVE EIBTRMID               TO QID-TERM.
  7193     MOVE +2                     TO EMI-NUMBER-OF-LINES
  7194     move spaces                 to emi-error-lines
  7195     MOVE '2'                    TO EMI-SWITCH2.
  7196     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  7197     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  7198
  7199
  7200* EXEC CICS HANDLE CONDITION
  7201*        QIDERR     (0100-TEST-ENTRY)
  7202*        MAPFAIL    (8100-SEND-INITIAL-MAP)
  7203*        PGMIDERR   (9600-PGMID-ERROR)
  7204*        TERMIDERR  (8820-TERM-ERROR)
  7205*        TRANSIDERR (8830-TRAN-ERROR)
  7206*        ERROR      (9990-ABEND)
  7207*    END-EXEC.
  7208*    MOVE '"$N?L[\.              ! " #00007195' TO DFHEIV0
  7209     MOVE X'22244E3F4C5B5C2E20202020' TO DFHEIV0(1:12)
  7210     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7211     MOVE X'2220233030303037313935' TO DFHEIV0(25:11)
  7212     CALL 'kxdfhei1' USING DFHEIV0
  7213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7214
  7215
  7216     IF PI-RETURN-TO-PROGRAM = THIS-PGM  OR
  7217        PI-CALLING-PROGRAM   = XCTL-6592
  7218         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM
  7219     ELSE
  7220         MOVE SPACES             TO RETURNED-FROM
  7221     END-IF.
  7222
  7223     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  7224         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  7225             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  7226             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 134
* EL130.cbl
  7227             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  7228             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  7229             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  7230             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  7231             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  7232             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  7233         ELSE
  7234             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  7235             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  7236             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  7237             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  7238             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  7239             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  7240             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  7241             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  7242         END-IF
  7243     END-IF.
  7244
  7245     IF EIBTRNID = TRANS-ID
  7246         IF EIBAID = DFHCLEAR
  7247             GO TO 9400-CLEAR
  7248         ELSE
  7249             GO TO 0200-RECEIVE
  7250         END-IF
  7251     END-IF.
  7252
  7253     IF RETURNED-FROM NOT = SPACES
  7254         GO TO 0600-RECOVER-TEMP-STORAGE
  7255     END-IF.
  7256
  7257     MOVE LOW-VALUES TO EL130AO.
  7258     move zeros to pi-dcc-max-amt
  7259                   pi-dcc-max-benefits
  7260
  7261
  7262
  7263* EXEC CICS DELETEQ TS
  7264*         QUEUE   (QID)
  7265*    END-EXEC.
  7266*    MOVE '*&                    #   #00007250' TO DFHEIV0
  7267     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7268     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7269     MOVE X'2020233030303037323530' TO DFHEIV0(25:11)
  7270     CALL 'kxdfhei1' USING DFHEIV0,
  7271           QID,
  7272           DFHEIV99
  7273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7274
  7275
  7276 0100-TEST-ENTRY.
  7277     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  7278         GO TO 0650-FROM-EL127
  7279     ELSE
  7280         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7281                                    PI-CERT-PROCESSED
  7282                                    PI-LETTER-ERROR-CODE
  7283     END-IF.
  7284
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 135
* EL130.cbl
  7285     IF PI-RETURN-TO-PROGRAM = XCTL-132
  7286         GO TO 0640-FROM-EL132
  7287     END-IF.
  7288
  7289     GO TO 8100-SEND-INITIAL-MAP.
  7290
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 136
* EL130.cbl
  7292 0200-RECEIVE.
  7293     MOVE LOW-VALUES             TO EL130AI.
  7294
  7295     IF PI-PROCESSOR-ID = 'LGXX'
  7296*        NEXT SENTENCE
  7297         CONTINUE
  7298     ELSE
  7299
  7300* EXEC CICS READQ TS
  7301*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  7302*            INTO    (SECURITY-CONTROL)
  7303*            LENGTH  (SC-COMM-LENGTH)
  7304*            ITEM    (SC-ITEM)
  7305*        END-EXEC
  7306*    MOVE '*$II   L              ''   #00007277' TO DFHEIV0
  7307     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  7308     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7309     MOVE X'2020233030303037323737' TO DFHEIV0(25:11)
  7310     CALL 'kxdfhei1' USING DFHEIV0,
  7311           PI-SECURITY-TEMP-STORE-ID,
  7312           SECURITY-CONTROL,
  7313           SC-COMM-LENGTH,
  7314           SC-ITEM,
  7315           DFHEIV99,
  7316           DFHEIV99
  7317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7318         MOVE SC-CLAIMS-DISPLAY (1)   TO  PI-DISPLAY-CAP
  7319         MOVE SC-CLAIMS-UPDATE  (1)   TO  PI-MODIFY-CAP
  7320         IF NOT DISPLAY-CAP
  7321             MOVE 'READ'              TO  SM-READ
  7322             PERFORM 9995-SECURITY-VIOLATION
  7323             MOVE ER-0070             TO  EMI-ERROR
  7324             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7325             GO TO 8100-SEND-INITIAL-MAP
  7326         END-IF
  7327     END-IF.
  7328
  7329     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  7330         MOVE ER-7008 TO EMI-ERROR
  7331         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7332         MOVE -1 TO MAINTL
  7333         GO TO 8200-SEND-DATAONLY
  7334     END-IF.
  7335
  7336
  7337
  7338* EXEC CICS RECEIVE
  7339*         MAP     (MAP-NAME)
  7340*         MAPSET  (MAPSET-NAME)
  7341*         INTO    (EL130AI)
  7342*    END-EXEC.
  7343     MOVE LENGTH OF
  7344      EL130AI
  7345       TO DFHEIV11
  7346*    MOVE '8"T I  L              ''   #00007302' TO DFHEIV0
  7347     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  7348     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7349     MOVE X'2020233030303037333032' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 137
* EL130.cbl
  7350     CALL 'kxdfhei1' USING DFHEIV0,
  7351           MAP-NAME,
  7352           EL130AI,
  7353           DFHEIV11,
  7354           MAPSET-NAME,
  7355           DFHEIV99,
  7356           DFHEIV99
  7357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7358
  7359
  7360     IF NOT PI-NO-CARRIER-SECURITY
  7361        MOVE +1                  TO CLMCARRL
  7362        MOVE PI-CARRIER-SECURITY TO CLMCARRI
  7363     END-IF.
  7364
  7365     IF ENTERPFL = ZERO
  7366         GO TO 0300-CHECK-PFKEYS
  7367     END-IF.
  7368
  7369     IF EIBAID NOT = DFHENTER
  7370         MOVE ER-0004            TO EMI-ERROR
  7371         GO TO 0320-INPUT-ERROR
  7372     END-IF.
  7373
  7374     IF (ENTERPFI NUMERIC) AND (ENTERPFI GREATER 0 AND LESS 25)
  7375         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  7376     ELSE
  7377         MOVE ER-0029            TO EMI-ERROR
  7378         GO TO 0320-INPUT-ERROR
  7379     END-IF.
  7380
  7381 0300-CHECK-PFKEYS.
  7382     IF EIBAID = DFHPF23
  7383         GO TO 8810-PF23
  7384     END-IF.
  7385
  7386     IF EIBAID = DFHPF24
  7387         GO TO 9200-RETURN-MAIN-MENU
  7388     END-IF.
  7389
  7390     IF EIBAID = DFHPF12
  7391         GO TO 9500-PF12
  7392     END-IF.
  7393
  7394     IF EIBAID = DFHPF3
  7395         MOVE SPACES              TO MAINTI
  7396         MOVE ZEROS               TO MAINTL
  7397         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7398         MOVE XCTL-127            TO PGM-NAME
  7399         GO TO 9300-XCTL
  7400     END-IF.
  7401
  7402     IF EIBAID = DFHPF4
  7403         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7404         MOVE XCTL-132            TO PGM-NAME
  7405         GO TO 9300-XCTL
  7406     END-IF.
  7407
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 138
* EL130.cbl
  7408     IF EIBAID = DFHPF13
  7409         IF PI-ACCESS-TO-BOTH-SYSTEMS
  7410             PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7411             MOVE PI-CARRIER          TO  PI-CR-CARRIER
  7412             MOVE PI-GROUPING         TO  PI-CR-GROUPING
  7413             MOVE PI-STATE            TO  PI-CR-STATE
  7414             MOVE PI-ACCOUNT          TO  PI-CR-ACCOUNT
  7415             MOVE XCTL-650            TO  PGM-NAME
  7416             GO TO 9300-XCTL
  7417         ELSE
  7418             MOVE -1                  TO  ENTERPFL
  7419             MOVE ER-2566             TO  EMI-ERROR
  7420             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7421             GO TO 8100-SEND-INITIAL-MAP
  7422         END-IF
  7423     END-IF.
  7424
  7425     IF EIBAID = DFHPF5
  7426         IF PI-CERT-PROCESSED LESS THAN PI-CERT-SELECT-CNT
  7427             ADD +1 TO PI-CERT-PROCESSED
  7428             GO TO 0650-FROM-EL127
  7429         ELSE
  7430             MOVE ER-7686         TO EMI-ERROR
  7431             GO TO 0320-INPUT-ERROR
  7432         END-IF
  7433     END-IF.
  7434
  7435     IF EIBAID = DFHPF7 OR DFHPF8 OR DFHPF9
  7436         GO TO 0800-TEST-PREVIOUS-CONTROL
  7437     END-IF.
  7438
  7439     IF PI-HAS-CLAS-IC-CRDTCRD
  7440         IF EIBAID = DFHPF10
  7441             MOVE XCTL-725          TO PGM-NAME
  7442             GO TO 9300-XCTL
  7443         END-IF
  7444     END-IF.
  7445
  7446     IF EIBAID = DFHPF14
  7447         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7448         MOVE SPACES              TO PI-EL659-TO-EL130-CNTRL
  7449         MOVE XCTL-659            TO PGM-NAME
  7450         GO TO 9300-XCTL
  7451     END-IF.
  7452
  7453     IF EIBAID = DFHPF15
  7454         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  7455         MOVE XCTL-114            TO PGM-NAME
  7456         GO TO 9300-XCTL
  7457     END-IF.
  7458
  7459*    IF EIBAID = DFHPF11
  7460*       GO TO 0600-RECOVER-TEMP-STORAGE
  7461*    END-IF
  7462     IF EIBAID = DFHENTER OR DFHPF6 OR DFHPF11
  7463         GO TO 0330-EDIT-DATA
  7464     END-IF.
  7465
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 139
* EL130.cbl
  7466     MOVE ER-0029                TO EMI-ERROR.
  7467
  7468 0320-INPUT-ERROR.
  7469     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7470
  7471     MOVE AL-UNBON               TO ENTERPFA.
  7472
  7473     IF ENTERPFL = ZERO
  7474         MOVE -1                 TO MAINTL
  7475     ELSE
  7476         MOVE -1                 TO ENTERPFL
  7477     END-IF.
  7478
  7479     GO TO 8200-SEND-DATAONLY.
  7480
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 140
* EL130.cbl
  7482 0330-EDIT-DATA.
  7483
  7484     IF MAINTI = 'S'
  7485         IF PRTOPTL GREATER THAN 0
  7486             IF PRTOPTI NOT = 'N' AND 'L'
  7487                 MOVE AL-UABON   TO  PRTOPTA
  7488                 MOVE -1         TO  PRTOPTL
  7489                 MOVE ER-0334    TO  EMI-ERROR
  7490                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7491                 GO TO 8200-SEND-DATAONLY
  7492             ELSE
  7493                 IF PRTOPTI = 'L'
  7494                     GO TO 0400-CREATE-ELACTQ
  7495                 ELSE
  7496                     GO TO 0480-PRINT-NOW
  7497                 END-IF
  7498             END-IF
  7499         ELSE
  7500             GO TO 1000-SHOW-CLAIM
  7501         END-IF
  7502     END-IF.
  7503
  7504     IF NOT MODIFY-CAP
  7505         MOVE 'UPDATE'       TO  SM-READ
  7506         PERFORM 9995-SECURITY-VIOLATION
  7507         MOVE ER-0070        TO  EMI-ERROR
  7508         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7509         GO TO 8100-SEND-INITIAL-MAP
  7510     END-IF.
  7511
  7512     IF MAINTI = 'D'
  7513         GO TO 2000-DELETE-CLAIM
  7514     END-IF.
  7515
  7516     IF MAINTI = 'A'
  7517         GO TO 3000-ADD-CLAIM
  7518     END-IF.
  7519
  7520     IF MAINTI = 'I'
  7521         GO TO 5000-INCURRED-CHANGE
  7522     END-IF.
  7523
  7524     MOVE ER-0023                TO EMI-ERROR.
  7525     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7526     MOVE -1                     TO MAINTL.
  7527     MOVE AL-UABON               TO MAINTA.
  7528
  7529     GO TO 8200-SEND-DATAONLY.
  7530
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 141
* EL130.cbl
  7532 0400-CREATE-ELACTQ.
  7533     IF CLMNOI   = PI-LAST-CLAIM      AND
  7534        CLMCARRI = PI-LAST-CARR       AND
  7535        CERTNOI  = PI-LAST-CERT-PRIME AND
  7536        SUFXI    = PI-LAST-CERT-SUFX
  7537         MOVE PI-LAST-CLAIM      TO PI-CLAIM-NO
  7538         MOVE PI-LAST-CARR       TO PI-CARRIER
  7539         MOVE PI-LAST-CERT       TO PI-CERT-NO
  7540     ELSE
  7541         MOVE ER-0207            TO EMI-ERROR
  7542         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7543         MOVE -1                 TO MAINTL
  7544         GO TO 8200-SEND-DATAONLY
  7545     END-IF.
  7546
  7547     IF (NOT PI-NO-CARRIER-SECURITY OR
  7548         NOT PI-NO-ACCOUNT-SECURITY)
  7549         MOVE AL-UABON      TO  PRTOPTA
  7550         MOVE -1            TO  PRTOPTL
  7551         MOVE ER-2378       TO  EMI-ERROR
  7552         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7553         GO TO 8200-SEND-DATAONLY
  7554     END-IF.
  7555
  7556     MOVE PI-COMPANY-CD      TO ELACTQ-COMPANY-CD.
  7557     MOVE PI-LAST-CARR       TO ELACTQ-CARRIER.
  7558     MOVE PI-LAST-CLAIM      TO ELACTQ-CLAIM-NO.
  7559     MOVE PI-LAST-CERT       TO ELACTQ-CERT-NO.
  7560
  7561
  7562
  7563* EXEC CICS HANDLE CONDITION
  7564*         NOTFND     (0450-ADD-ELACTQ-RECORD)
  7565*    END-EXEC.
  7566*    MOVE '"$I                   ! # #00007510' TO DFHEIV0
  7567     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7568     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7569     MOVE X'2320233030303037353130' TO DFHEIV0(25:11)
  7570     CALL 'kxdfhei1' USING DFHEIV0
  7571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7572
  7573
  7574
  7575
  7576* EXEC CICS READ
  7577*         UPDATE
  7578*         DATASET    (ELACTQ-DSID)
  7579*         SET        (ADDRESS OF ACTIVITY-QUE)
  7580*         RIDFLD     (ELACTQ-KEY)
  7581*    END-EXEC.
  7582*    MOVE '&"S        EU         (   #00007515' TO DFHEIV0
  7583     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7584     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7585     MOVE X'2020233030303037353135' TO DFHEIV0(25:11)
  7586     CALL 'kxdfhei1' USING DFHEIV0,
  7587           ELACTQ-DSID,
  7588           DFHEIV20,
  7589           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 142
* EL130.cbl
  7590           ELACTQ-KEY,
  7591           DFHEIV99,
  7592           DFHEIV99,
  7593           DFHEIV99
  7594     SET ADDRESS OF ACTIVITY-QUE TO
  7595         DFHEIV20
  7596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7597
  7598
  7599     MOVE '2'         TO AQ-PENDING-STATUS-FLAG.
  7600     MOVE +130        TO AQ-LAST-UPDATED-BY.
  7601
  7602
  7603
  7604* EXEC CICS REWRITE
  7605*         DATASET     (ELACTQ-DSID)
  7606*         FROM        (ACTIVITY-QUE)
  7607*    END-EXEC.
  7608     MOVE LENGTH OF
  7609      ACTIVITY-QUE
  7610       TO DFHEIV11
  7611*    MOVE '&& L                  %   #00007526' TO DFHEIV0
  7612     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7613     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7614     MOVE X'2020233030303037353236' TO DFHEIV0(25:11)
  7615     CALL 'kxdfhei1' USING DFHEIV0,
  7616           ELACTQ-DSID,
  7617           ACTIVITY-QUE,
  7618           DFHEIV11,
  7619           DFHEIV99
  7620     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7621
  7622
  7623     GO TO 0470-STATUS-FINISH.
  7624
  7625 0450-ADD-ELACTQ-RECORD.
  7626
  7627
  7628* EXEC CICS GETMAIN
  7629*        SET     (ADDRESS OF ACTIVITY-QUE)
  7630*        LENGTH  (ELACTQ-LENGTH)
  7631*        INITIMG (GETMAIN-SPACE)
  7632*    END-EXEC.
  7633*    MOVE ',"IL                  $   #00007535' TO DFHEIV0
  7634     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7635     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7636     MOVE X'2020233030303037353335' TO DFHEIV0(25:11)
  7637     CALL 'kxdfhei1' USING DFHEIV0,
  7638           DFHEIV20,
  7639           ELACTQ-LENGTH,
  7640           GETMAIN-SPACE
  7641     SET ADDRESS OF ACTIVITY-QUE TO
  7642         DFHEIV20
  7643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7644
  7645
  7646     MOVE 'AQ'              TO AQ-RECORD-ID.
  7647     MOVE ELACTQ-KEY        TO AQ-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 143
* EL130.cbl
  7648     MOVE +0                TO AQ-PAYMENT-COUNTER
  7649                               AQ-PMT-UNAPPROVED-COUNT.
  7650     MOVE LOW-VALUES        TO AQ-RESEND-DATE
  7651                               AQ-FOLLOWUP-DATE.
  7652     MOVE '2'               TO AQ-PENDING-STATUS-FLAG.
  7653     MOVE +130              TO AQ-LAST-UPDATED-BY.
  7654
  7655
  7656
  7657* EXEC CICS WRITE
  7658*         DATASET     (ELACTQ-DSID)
  7659*         FROM        (ACTIVITY-QUE)
  7660*         RIDFLD      (ELACTQ-KEY)
  7661*    END-EXEC.
  7662     MOVE LENGTH OF
  7663      ACTIVITY-QUE
  7664       TO DFHEIV11
  7665*    MOVE '&$ L                  ''   #00007551' TO DFHEIV0
  7666     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7667     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7668     MOVE X'2020233030303037353531' TO DFHEIV0(25:11)
  7669     CALL 'kxdfhei1' USING DFHEIV0,
  7670           ELACTQ-DSID,
  7671           ACTIVITY-QUE,
  7672           DFHEIV11,
  7673           ELACTQ-KEY,
  7674           DFHEIV99,
  7675           DFHEIV99
  7676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7677
  7678
  7679 0470-STATUS-FINISH.
  7680     MOVE AL-UANOF               TO  PRTOPTA
  7681                                     ALTPRTA.
  7682
  7683     MOVE SPACES                 TO  PRTOPTO
  7684                                     ALTPRTO.
  7685
  7686     MOVE ER-0000                TO EMI-ERROR.
  7687     MOVE -1                     TO MAINTL.
  7688     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7689     GO TO 8100-SEND-INITIAL-MAP.
  7690
  7691 0480-PRINT-NOW.
  7692
  7693
  7694* EXEC CICS HANDLE CONDITION
  7695*        TERMIDERR   (8820-TERM-ERROR)
  7696*        TRANSIDERR  (8830-TRAN-ERROR)
  7697*    END-EXEC.
  7698*    MOVE '"$[\                  ! $ #00007571' TO DFHEIV0
  7699     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  7700     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7701     MOVE X'2420233030303037353731' TO DFHEIV0(25:11)
  7702     CALL 'kxdfhei1' USING DFHEIV0
  7703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7704
  7705
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 144
* EL130.cbl
  7706     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  7707     MOVE '1'                    TO  CNTL-REC-TYPE.
  7708     MOVE SPACES                 TO  CNTL-ACCESS.
  7709     MOVE +0                     TO  CNTL-SEQ-NO.
  7710     MOVE 'CNTL'                 TO  FILE-SWITCH.
  7711
  7712     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
  7713
  7714     IF CF-FORMS-PRINTER-ID = SPACES
  7715         IF ALTPRTL NOT GREATER THAN 0
  7716             MOVE ER-0337        TO  EMI-ERROR
  7717             MOVE -1             TO  ALTPRTL
  7718             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7719             GO TO 8200-SEND-DATAONLY
  7720         END-IF
  7721     END-IF.
  7722
  7723     IF ALTPRTL GREATER THAN 0
  7724         MOVE ALTPRTI            TO  CF-FORMS-PRINTER-ID
  7725     END-IF.
  7726
  7727     MOVE PI-LAST-CLAIM          TO  PI-CLAIM-NO.
  7728     MOVE PI-LAST-CARR           TO  PI-CARRIER.
  7729     MOVE PI-LAST-CERT           TO  PI-CERT-NO.
  7730
  7731
  7732
  7733* EXEC CICS START
  7734*        TRANSID   (START-TRANS-ID)
  7735*        TERMID    (CF-FORMS-PRINTER-ID)
  7736*        FROM      (PROGRAM-INTERFACE-BLOCK)
  7737*        LENGTH    (PI-COMM-LENGTH)
  7738*    END-EXEC.
  7739*    MOVE '0( LFT                1   #00007602' TO DFHEIV0
  7740     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  7741     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  7742     MOVE X'2020233030303037363032' TO DFHEIV0(25:11)
  7743     CALL 'kxdfhei1' USING DFHEIV0,
  7744           DFHEIV99,
  7745           START-TRANS-ID,
  7746           DFHEIV99,
  7747           PROGRAM-INTERFACE-BLOCK,
  7748           PI-COMM-LENGTH,
  7749           CF-FORMS-PRINTER-ID,
  7750           DFHEIV99,
  7751           DFHEIV99,
  7752           DFHEIV99,
  7753           DFHEIV99,
  7754           DFHEIV99,
  7755           DFHEIV99,
  7756           DFHEIV99,
  7757           DFHEIV99,
  7758           DFHEIV99,
  7759           DFHEIV99
  7760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7761
  7762
  7763     MOVE AL-UANOF               TO  PRTOPTA
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 145
* EL130.cbl
  7764                                     ALTPRTA.
  7765
  7766     MOVE SPACES                 TO  PRTOPTO
  7767                                     ALTPRTO.
  7768
  7769     MOVE ER-0000                TO  EMI-ERROR.
  7770     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7771     MOVE -1                     TO  MAINTL.
  7772     GO TO 8100-SEND-INITIAL-MAP.
  7773
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 146
* EL130.cbl
  7775 0500-CREATE-TEMP-STORAGE.
  7776     MOVE EIBCPOSN               TO PI-CURSOR.
  7777
  7778    move emi-line1               to errmsg1o
  7779    move emi-line2               to errmsg2o
  7780    move emi-sub                 to pi-emi-sub
  7781
  7782
  7783* EXEC CICS WRITEQ TS
  7784*        QUEUE   (QID)
  7785*        FROM    (EL130AI)
  7786*        LENGTH  (QID-MAP-LENGTH)
  7787*    END-EXEC.
  7788*    MOVE '*"     L              ''   #00007628' TO DFHEIV0
  7789     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7790     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7791     MOVE X'2020233030303037363238' TO DFHEIV0(25:11)
  7792     CALL 'kxdfhei1' USING DFHEIV0,
  7793           QID,
  7794           EL130AI,
  7795           QID-MAP-LENGTH,
  7796           DFHEIV99,
  7797           DFHEIV99,
  7798           DFHEIV99
  7799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7800
  7801
  7802
  7803
  7804* EXEC CICS WRITEQ TS
  7805*        QUEUE    (QID)
  7806*        FROM     (PROGRAM-INTERFACE-BLOCK)
  7807*        LENGTH   (PI-COMM-LENGTH)
  7808*    END-EXEC.
  7809*    MOVE '*"     L              ''   #00007635' TO DFHEIV0
  7810     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7811     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7812     MOVE X'2020233030303037363335' TO DFHEIV0(25:11)
  7813     CALL 'kxdfhei1' USING DFHEIV0,
  7814           QID,
  7815           PROGRAM-INTERFACE-BLOCK,
  7816           PI-COMM-LENGTH,
  7817           DFHEIV99,
  7818           DFHEIV99,
  7819           DFHEIV99
  7820     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7821
  7822
  7823 0599-EXIT.
  7824      EXIT.
  7825
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 147
* EL130.cbl
  7827 0600-RECOVER-TEMP-STORAGE.
  7828     MOVE PI-CONTROL-IN-PROGRESS TO SAVE-CONTROL.
  7829     MOVE PI-EL127-TO-EL130-CNTRL
  7830                                 TO SAVE-EL127-TO-EL130-CNTRL.
  7831     MOVE PI-EL659-TO-EL130-CNTRL
  7832                                 TO SAVE-EL659-TO-EL130-CNTRL.
  7833     MOVE PI-COMPANY-ID          TO SAVE-COMPANY-ID.
  7834     MOVE PI-COMPANY-CD          TO SAVE-COMPANY-CD.
  7835     MOVE PI-JOURNAL-FILE-ID     TO SAVE-JOURNAL-FILE-ID.
  7836     MOVE PI-CREDIT-USER         TO SAVE-CREDIT-USER.
  7837     MOVE PI-CLAIM-USER          TO SAVE-CLAIM-USER.
  7838     MOVE PI-LIFE-OVERRIDE-L1    TO SAVE-LIFE-OVERRIDE-L1.
  7839     MOVE PI-LIFE-OVERRIDE-L2    TO SAVE-LIFE-OVERRIDE-L2.
  7840     MOVE PI-LIFE-OVERRIDE-L6    TO SAVE-LIFE-OVERRIDE-L6.
  7841     MOVE PI-LIFE-OVERRIDE-L12   TO SAVE-LIFE-OVERRIDE-L12.
  7842     MOVE PI-AH-OVERRIDE-L1      TO SAVE-AH-OVERRIDE-L1.
  7843     MOVE PI-AH-OVERRIDE-L2      TO SAVE-AH-OVERRIDE-L2.
  7844     MOVE PI-AH-OVERRIDE-L6      TO SAVE-AH-OVERRIDE-L6.
  7845     MOVE PI-AH-OVERRIDE-L12     TO SAVE-AH-OVERRIDE-L12.
  7846     MOVE PI-CERT-ACCESS-CONTROL TO SAVE-CERT-ACCESS-CONTROL.
  7847     MOVE PI-CARRIER-CONTROL-LEVEL  TO SAVE-CARRIER-CONTROL-LEVEL.
  7848     MOVE PI-PROGRAM-WORK-AREA (1:10)
  7849                                 TO SAVE-BENEFICIARY
  7850
  7851
  7852
  7853* EXEC CICS HANDLE CONDITION
  7854*        NOTFND  (0660-NOT-FOUND)
  7855*        QIDERR  (0670-QIDERR)
  7856*    END-EXEC.
  7857*    MOVE '"$IN                  ! % #00007670' TO DFHEIV0
  7858     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  7859     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7860     MOVE X'2520233030303037363730' TO DFHEIV0(25:11)
  7861     CALL 'kxdfhei1' USING DFHEIV0
  7862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7863
  7864
  7865
  7866
  7867* EXEC CICS READQ TS
  7868*        QUEUE    (QID)
  7869*        INTO     (EL130AI)
  7870*        LENGTH   (QID-MAP-LENGTH)
  7871*    END-EXEC.
  7872*    MOVE '*$I    L              ''   #00007676' TO DFHEIV0
  7873     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7874     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7875     MOVE X'2020233030303037363736' TO DFHEIV0(25:11)
  7876     CALL 'kxdfhei1' USING DFHEIV0,
  7877           QID,
  7878           EL130AI,
  7879           QID-MAP-LENGTH,
  7880           DFHEIV99,
  7881           DFHEIV99,
  7882           DFHEIV99
  7883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7884
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 148
* EL130.cbl
  7885
  7886     IF RETURNED-FROM = XCTL-131
  7887        IF CLAIM-DELETED-BY-EL131
  7888            MOVE LOW-VALUES      TO CERTNOI
  7889                                    SUFXI
  7890            MOVE ZEROS           TO CERTNOL
  7891                                    SUFXL
  7892         END-IF
  7893     END-IF.
  7894
  7895     IF RETURNED-FROM = XCTL-131
  7896         MOVE LOW-VALUES         TO PI-PROGRAM-WORK-AREA
  7897         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  7898                                    PI-CERT-PROCESSED
  7899     ELSE
  7900
  7901
  7902* EXEC CICS READQ TS
  7903*             QUEUE   (QID)
  7904*             INTO    (PROGRAM-INTERFACE-BLOCK)
  7905*             LENGTH  (PI-COMM-LENGTH)
  7906*        END-EXEC
  7907*    MOVE '*$I    L              ''   #00007697' TO DFHEIV0
  7908     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7909     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7910     MOVE X'2020233030303037363937' TO DFHEIV0(25:11)
  7911     CALL 'kxdfhei1' USING DFHEIV0,
  7912           QID,
  7913           PROGRAM-INTERFACE-BLOCK,
  7914           PI-COMM-LENGTH,
  7915           DFHEIV99,
  7916           DFHEIV99,
  7917           DFHEIV99
  7918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7919     END-IF.
  7920
  7921
  7922* EXEC CICS DELETEQ TS
  7923*        QUEUE   (QID)
  7924*    END-EXEC.
  7925*    MOVE '*&                    #   #00007704' TO DFHEIV0
  7926     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7927     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7928     MOVE X'2020233030303037373034' TO DFHEIV0(25:11)
  7929     CALL 'kxdfhei1' USING DFHEIV0,
  7930           QID,
  7931           DFHEIV99
  7932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7933
  7934
  7935     MOVE SAVE-CONTROL           TO PI-CONTROL-IN-PROGRESS.
  7936
  7937     IF RETURNED-FROM = XCTL-127 OR XCTL-132
  7938         MOVE SAVE-COMPANY-CD        TO PI-COMPANY-CD
  7939         MOVE SAVE-COMPANY-ID        TO PI-COMPANY-ID
  7940         MOVE SAVE-JOURNAL-FILE-ID   TO PI-JOURNAL-FILE-ID
  7941         MOVE SAVE-CREDIT-USER       TO PI-CREDIT-USER
  7942         MOVE SAVE-CLAIM-USER        TO PI-CLAIM-USER
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 149
* EL130.cbl
  7943         MOVE SAVE-LIFE-OVERRIDE-L1  TO PI-LIFE-OVERRIDE-L1
  7944         MOVE SAVE-LIFE-OVERRIDE-L2  TO PI-LIFE-OVERRIDE-L2
  7945         MOVE SAVE-LIFE-OVERRIDE-L6  TO PI-LIFE-OVERRIDE-L6
  7946         MOVE SAVE-LIFE-OVERRIDE-L12 TO PI-LIFE-OVERRIDE-L12
  7947         MOVE SAVE-AH-OVERRIDE-L1    TO PI-AH-OVERRIDE-L1
  7948         MOVE SAVE-AH-OVERRIDE-L2    TO PI-AH-OVERRIDE-L2
  7949         MOVE SAVE-AH-OVERRIDE-L6    TO PI-AH-OVERRIDE-L6
  7950         MOVE SAVE-AH-OVERRIDE-L12   TO PI-AH-OVERRIDE-L12
  7951         MOVE SAVE-CERT-ACCESS-CONTROL
  7952                                    TO PI-CERT-ACCESS-CONTROL
  7953         MOVE SAVE-CARRIER-CONTROL-LEVEL
  7954                                    TO PI-CARRIER-CONTROL-LEVEL
  7955     END-IF.
  7956
  7957*    IF EIBAID = DFHPF11
  7958*       move errmsg1i            to emi-line1
  7959*       move errmsg2i            to emi-line2
  7960*       move pi-emi-sub          to emi-sub
  7961*       go to 8200-SEND-DATAONLY
  7962*    end-if
  7963     IF RETURNED-FROM = XCTL-127
  7964         MOVE SAVE-EL127-TO-EL130-CNTRL
  7965                                 TO PI-EL127-TO-EL130-CNTRL
  7966     END-IF.
  7967
  7968     IF RETURNED-FROM = XCTL-6592
  7969        MOVE SAVE-EL659-TO-EL130-CNTRL
  7970                                 TO PI-EL659-TO-EL130-CNTRL
  7971     END-IF.
  7972
  7973     IF RETURNED-FROM = XCTL-114
  7974        IF SAVE-BENEFICIARY NOT = SPACES AND LOW-VALUES
  7975           MOVE SAVE-BENEFICIARY TO BENECDI
  7976           MOVE +10              TO BENECDL
  7977           MOVE -1               TO BIRTHDTL
  7978        END-IF
  7979     END-IF.
  7980     PERFORM 3993-MODIFY-SCREEN-ATTRB THRU 3993-EXIT.
  7981
  7982     IF MAINTL NOT = ZERO
  7983         MOVE AL-UANON           TO MAINTA
  7984     END-IF.
  7985
  7986     IF ENTERPFL NOT = ZERO
  7987         MOVE AL-UNNON           TO ENTERPFA
  7988     END-IF.
  7989
  7990     IF RETURNED-FROM = XCTL-127
  7991         GO TO 0650-FROM-EL127
  7992     END-IF.
  7993
  7994     IF RETURNED-FROM = XCTL-132
  7995         GO TO 0640-FROM-EL132
  7996     END-IF.
  7997
  7998     IF RETURNED-FROM = XCTL-650
  7999         MOVE AL-SABON           TO PF5A
  8000         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 150
* EL130.cbl
  8001     END-IF.
  8002
  8003     IF RETURNED-FROM = XCTL-6592
  8004         GO TO 0630-FROM-EL6592
  8005     END-IF.
  8006
  8007     IF MAINTI = 'S' OR 'I'
  8008        GO TO 1000-SHOW-CLAIM
  8009     END-IF.
  8010
  8011     GO TO 8100-SEND-INITIAL-MAP.
  8012
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 151
* EL130.cbl
  8014 0630-FROM-EL6592.
  8015     MOVE PI-EL659-CARRIER       TO CRTCARRO.
  8016     MOVE PI-EL659-GROUPING      TO GROUPO.
  8017     MOVE PI-EL659-STATE         TO STATEO.
  8018     MOVE PI-EL659-ACCOUNT       TO ACCOUNTO.
  8019
  8020     MOVE AL-UANON               TO CRTCARRA
  8021                                    GROUPA
  8022                                    STATEA
  8023                                    ACCOUNTA.
  8024     GO TO 8100-SEND-INITIAL-MAP.
  8025
  8026 0640-FROM-EL132.
  8027     IF PI-CLAIM-NO = SPACES
  8028         GO TO 0645-NO-CLAIM-SELECTED
  8029     END-IF.
  8030
  8031     MOVE LOW-VALUES             TO EL130AI.
  8032     MOVE 'MSTR'                 TO FILE-SWITCH.
  8033     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8034     MOVE PI-CARRIER             TO MSTR-CARRIER.
  8035     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO
  8036                                    CLMNOO.
  8037     MOVE AL-UANON               TO CLMNOA.
  8038     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  8039
  8040
  8041
  8042* EXEC CICS HANDLE CONDITION
  8043*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8044*    END-EXEC.
  8045*    MOVE '"$I                   ! & #00007814' TO DFHEIV0
  8046     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8047     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8048     MOVE X'2620233030303037383134' TO DFHEIV0(25:11)
  8049     CALL 'kxdfhei1' USING DFHEIV0
  8050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8051
  8052
  8053     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8054     MOVE 'X'                    TO CLAIM-SWITCH.
  8055     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8056     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8057     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8058     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8059     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8060     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8061
  8062     MOVE ER-0213                TO EMI-ERROR.
  8063     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8064     MOVE PI-CLAIM-NO            TO EMI-TEXT-VARIABLE (1).
  8065     GO TO 8100-SEND-INITIAL-MAP.
  8066
  8067 0645-NO-CLAIM-SELECTED.
  8068
  8069     IF MAINTI = 'S' OR 'I'
  8070        GO TO 1000-SHOW-CLAIM
  8071     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 152
* EL130.cbl
  8072
  8073     GO TO 8100-SEND-INITIAL-MAP.
  8074
  8075 0650-FROM-EL127.
  8076
  8077     IF PI-CERT-SELECT-CNT GREATER THAN +6
  8078         MOVE ZEROS              TO PI-CERT-SELECT-CNT
  8079                                    PI-CERT-PROCESSED
  8080     END-IF.
  8081
  8082     IF PI-RETURN-TO-PROGRAM = XCTL-727
  8083         MOVE +1                 TO PI-CERT-SELECT-CNT
  8084                                    PI-CERT-PROCESSED
  8085         MOVE PI-CARRIER         TO PI-EL127-CARRIER (1)
  8086         MOVE PI-GROUPING        TO PI-EL127-GROUPING (1)
  8087         MOVE PI-STATE           TO PI-EL127-STATE   (1)
  8088         MOVE PI-ACCOUNT         TO PI-EL127-ACCOUNT (1)
  8089         MOVE PI-CERT-EFF-DT     TO PI-EL127-EFF-DT  (1)
  8090         MOVE PI-CERT-NO         TO PI-EL127-CERT-NO (1)
  8091     END-IF.
  8092
  8093     IF PI-CERT-SELECT-CNT = ZERO
  8094         IF CERTNOI NOT = SPACES AND LOW-VALUES
  8095             MOVE CERTNOI        TO PI-CERT-NO
  8096             MOVE SUFXI          TO PI-CERT-SFX
  8097             GO TO 3000-READ-CERT
  8098         ELSE
  8099             GO TO 8100-SEND-INITIAL-MAP
  8100         END-IF
  8101     END-IF.
  8102
  8103     MOVE AL-SABON               TO PF5A.
  8104
  8105     IF PI-CERT-PROCESSED = 1
  8106         PERFORM 0680-PLUG-SELECTED-CERTS THRU 0680-EXIT
  8107     END-IF.
  8108
  8109     PERFORM 0690-HIGHLIGHT-CERTS    THRU 0690-EXIT.
  8110     PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT.
  8111
  8112     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  8113     MOVE PI-EL127-CARRIER (PI-CERT-PROCESSED)
  8114                                 TO CERT-CARRIER
  8115                                    PI-CARRIER.
  8116     MOVE PI-EL127-GROUPING(PI-CERT-PROCESSED)
  8117                                 TO CERT-GROUPING
  8118                                    PI-GROUPING.
  8119     MOVE PI-EL127-STATE   (PI-CERT-PROCESSED)
  8120                                 TO CERT-STATE
  8121                                    PI-STATE.
  8122     MOVE PI-EL127-ACCOUNT (PI-CERT-PROCESSED)
  8123                                 TO CERT-ACCOUNT
  8124                                    PI-ACCOUNT.
  8125     MOVE PI-EL127-EFF-DT  (PI-CERT-PROCESSED)
  8126                                 TO CERT-EFF-DT
  8127                                    PI-CERT-EFF-DT.
  8128     MOVE PI-EL127-CERT-NO (PI-CERT-PROCESSED)
  8129                                 TO CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 153
* EL130.cbl
  8130                                    PI-CERT-NO.
  8131
  8132     MOVE 'CERT'                 TO FILE-SWITCH.
  8133     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8134
  8135     MOVE CERT-CERT-NO           TO PI-SAVE-CERT.
  8136     MOVE CERT-ACCOUNT           TO PI-SAVE-ACCOUNT.
  8137     MOVE CERT-EFF-DT            TO PI-SAVE-EFFDT.
  8138
  8139     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  8140         MOVE PI-COMPANY-CD      TO MSTR5-COMP-CD
  8141         MOVE CERT-CERT-NO       TO MSTR5-CERT-NO
  8142         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  8143         IF INCURRED-DATE-MATCH
  8144             MOVE ER-7352        TO EMI-ERROR
  8145             MOVE -1             TO CERTNOL
  8146             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8147         ELSE
  8148             IF NO-CLAIMS-FOR-CERT
  8149                 MOVE ER-7353    TO EMI-ERROR
  8150                 MOVE -1         TO CERTNOL
  8151                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8152             ELSE
  8153                 MOVE ER-0558    TO EMI-ERROR
  8154                 MOVE -1         TO CERTNOL
  8155                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8156             END-IF
  8157         END-IF
  8158     END-IF.
  8159
  8160     MOVE SPACES                 TO PI-PRT-OPT
  8161                                    PI-ALT-PRT.
  8162
  8163     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8164
  8165     if (ws-lf-joint-indicator not = 'J')
  8166        and (ws-ah-joint-indicator not = 'J')
  8167        move 'P'                 to INSTYPEO
  8168        MOVE AL-UANON            TO INSTYPEA
  8169     end-if
  8170     IF LSTNMEL NOT GREATER ZERO
  8171        AND CRTLNMEI NOT = (SPACES AND LOW-VALUES)
  8172         MOVE CRTLNMEI           TO  LSTNMEO
  8173         MOVE CRTFNMEI           TO  FSTNMEO
  8174         MOVE CRTINITI           TO  INITO
  8175         MOVE AL-UANON           TO  LSTNMEA
  8176                                     FSTNMEA
  8177                                     INITA
  8178     END-IF.
  8179
  8180     IF SSNL GREATER ZERO
  8181         GO TO 0655-SKIP-SOCIAL-SECURITY
  8182     END-IF.
  8183
  8184     IF CRTSSNI = SPACES OR LOW-VALUES
  8185         GO TO 0655-SKIP-SOCIAL-SECURITY
  8186     END-IF.
  8187
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 154
* EL130.cbl
  8188     IF CM-SSN-STATE   = CM-STATE AND
  8189        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
  8190            GO TO 0655-SKIP-SOCIAL-SECURITY
  8191     END-IF.
  8192
  8193     MOVE CRTSSNI                TO SSNO
  8194     MOVE AL-UANON               TO SSNA.
  8195
  8196 0655-SKIP-SOCIAL-SECURITY.
  8197
  8198     IF CLMCARRL NOT = ZERO  AND
  8199        CLMCARRI NOT = CRTCARRI
  8200        MOVE ER-0562             TO EMI-ERROR
  8201        MOVE AL-UABON            TO CLMCARRA
  8202        MOVE -1                  TO CLMCARRL
  8203        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8204     END-IF.
  8205
  8206     IF CLMCARRL = ZERO
  8207        MOVE AL-UANON            TO CLMCARRA
  8208        MOVE CRTCARRI            TO CLMCARRI
  8209     END-IF.
  8210
  8211     MOVE 'A'                    TO MAINTO.
  8212     MOVE AL-UANON               TO MAINTA.
  8213
  8214     IF PI-RETURN-TO-PROGRAM = XCTL-127 OR XCTL-727
  8215        GO TO 8100-SEND-INITIAL-MAP
  8216     ELSE
  8217        GO TO 8150-SEND-MAP-CURSOR
  8218     END-IF.
  8219
  8220 0660-NOT-FOUND.
  8221     MOVE ER-0214                TO EMI-ERROR.
  8222     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8223     GO TO 8100-SEND-INITIAL-MAP.
  8224
  8225 0670-QIDERR.
  8226     MOVE ER-0033                TO EMI-ERROR.
  8227     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8228     GO TO 8100-SEND-INITIAL-MAP.
  8229
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 155
* EL130.cbl
  8231 0680-PLUG-SELECTED-CERTS.
  8232
  8233     MOVE AL-SANON               TO BCERT1A
  8234                                    BSUFX1A
  8235                                    BCERT2A
  8236                                    BSUFX2A
  8237                                    BCERT3A
  8238                                    BSUFX3A
  8239                                    BCERT4A
  8240                                    BSUFX4A
  8241                                    BCERT5A
  8242                                    BSUFX5A.
  8243
  8244     IF PCERTNOO = SPACES OR LOW-VALUES
  8245         MOVE PI-EL127-CERT-PRIME (1)
  8246                                 TO PCERTNOO
  8247         MOVE PI-EL127-CERT-SUFX  (1)
  8248                                 TO PSUFXO
  8249     END-IF.
  8250
  8251     MOVE PI-EL127-CERT-PRIME (1)
  8252                                 TO BCERT1O.
  8253     MOVE PI-EL127-CERT-SUFX  (1)
  8254                                 TO BSUFX1O.
  8255
  8256     IF PI-CERT-SELECT-CNT GREATER THAN 1
  8257         MOVE PI-EL127-CERT-PRIME (2)
  8258                                 TO BCERT2O
  8259         MOVE PI-EL127-CERT-SUFX  (2)
  8260                                 TO BSUFX2O
  8261     ELSE
  8262         MOVE LOW-VALUES         TO BCERT2O
  8263                                    BSUFX2O
  8264     END-IF.
  8265
  8266     IF PI-CERT-SELECT-CNT GREATER THAN 2
  8267         MOVE PI-EL127-CERT-PRIME (3)
  8268                                 TO BCERT3O
  8269         MOVE PI-EL127-CERT-SUFX  (3)
  8270                                 TO BSUFX3O
  8271     ELSE
  8272         MOVE LOW-VALUES         TO BCERT3O
  8273                                    BSUFX3O
  8274     END-IF.
  8275
  8276     IF PI-CERT-SELECT-CNT GREATER THAN 3
  8277         MOVE PI-EL127-CERT-PRIME (4)
  8278                                 TO BCERT4O
  8279         MOVE PI-EL127-CERT-SUFX  (4)
  8280                                 TO BSUFX4O
  8281     ELSE
  8282         MOVE LOW-VALUES         TO BCERT4O
  8283                                    BSUFX4O
  8284     END-IF.
  8285
  8286     IF PI-CERT-SELECT-CNT GREATER THAN 4
  8287         MOVE PI-EL127-CERT-PRIME (5)
  8288                                 TO BCERT5O
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 156
* EL130.cbl
  8289         MOVE PI-EL127-CERT-SUFX  (5)
  8290                                 TO BSUFX5O
  8291     ELSE
  8292         MOVE LOW-VALUES         TO BCERT5O
  8293                                    BSUFX5O
  8294     END-IF.
  8295
  8296 0680-EXIT.
  8297     EXIT.
  8298
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 157
* EL130.cbl
  8300 0690-HIGHLIGHT-CERTS.
  8301
  8302     MOVE AL-UANON               TO PCERTNOA
  8303                                    PSUFXA.
  8304
  8305     IF BCERT1O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8306        BSUFX1O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8307            MOVE AL-SABON        TO BCERT1A
  8308                                    BSUFX1A
  8309     ELSE
  8310         MOVE AL-SANON           TO BCERT1A
  8311                                    BSUFX1A
  8312     END-IF.
  8313
  8314     IF BCERT2O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8315        BSUFX2O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8316            MOVE AL-SABON        TO BCERT2A
  8317                                    BSUFX2A
  8318     ELSE
  8319         MOVE AL-SANON           TO BCERT2A
  8320                                    BSUFX2A
  8321     END-IF.
  8322
  8323     IF BCERT3O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8324        BSUFX3O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8325            MOVE AL-SABON        TO BCERT3A
  8326                                    BSUFX3A
  8327     ELSE
  8328         MOVE AL-SANON           TO BCERT3A
  8329                                    BSUFX3A
  8330     END-IF.
  8331
  8332     IF BCERT4O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8333        BSUFX4O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8334            MOVE AL-SABON        TO BCERT4A
  8335                                    BSUFX4A
  8336     ELSE
  8337         MOVE AL-SANON           TO BCERT4A
  8338                                    BSUFX4A
  8339     END-IF.
  8340
  8341     IF BCERT5O = PI-EL127-CERT-PRIME (PI-CERT-PROCESSED) AND
  8342        BSUFX5O = PI-EL127-CERT-SUFX  (PI-CERT-PROCESSED)
  8343            MOVE AL-SABON        TO BCERT5A
  8344                                    BSUFX5A
  8345     ELSE
  8346         MOVE AL-SANON           TO BCERT5A
  8347                                    BSUFX5A
  8348     END-IF.
  8349
  8350 0690-EXIT.
  8351     EXIT.
  8352
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 158
* EL130.cbl
  8354 0800-TEST-PREVIOUS-CONTROL.
  8355     IF CLMNOI   = PI-LAST-CLAIM       AND
  8356        CLMCARRI = PI-LAST-CARR        AND
  8357        CERTNOI  = PI-LAST-CERT-PRIME  AND
  8358        SUFXI    = PI-LAST-CERT-SUFX
  8359*        NEXT SENTENCE
  8360         CONTINUE
  8361     ELSE
  8362         MOVE ER-0207            TO EMI-ERROR
  8363         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8364         MOVE -1                 TO MAINTL
  8365         GO TO 8200-SEND-DATAONLY
  8366     END-IF.
  8367
  8368     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
  8369
  8370     MOVE PI-LAST-CLAIM          TO PI-CLAIM-NO.
  8371     MOVE PI-LAST-CARR           TO PI-CARRIER.
  8372     MOVE PI-LAST-CERT           TO PI-CERT-NO.
  8373
  8374     IF EIBAID = DFHPF7
  8375         MOVE XCTL-157           TO PGM-NAME
  8376     END-IF.
  8377
  8378     IF EIBAID = DFHPF8
  8379         MOVE XCTL-141           TO PGM-NAME
  8380     END-IF.
  8381
  8382     IF EIBAID = DFHPF9
  8383        MOVE SPACES              TO PI-SAVED-PROGRAM-1
  8384                                    PI-SAVED-PROGRAM-2
  8385                                    PI-SAVED-PROGRAM-3
  8386                                    PI-SAVED-PROGRAM-4
  8387                                    PI-SAVED-PROGRAM-5
  8388                                    PI-SAVED-PROGRAM-6
  8389        MOVE XCTL-126            TO PI-RETURN-TO-PROGRAM
  8390        MOVE XCTL-132            TO PI-CALLING-PROGRAM
  8391        MOVE XCTL-150            TO PGM-NAME
  8392     END-IF.
  8393
  8394     GO TO 9300-XCTL.
  8395
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 159
* EL130.cbl
  8397 1000-SHOW-CLAIM.
  8398
  8399     IF CLMNOL = ZERO
  8400         MOVE -1                 TO CLMNOL
  8401         MOVE AL-UABON           TO CLMNOA
  8402         MOVE ER-0202            TO EMI-ERROR
  8403         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8404     ELSE
  8405         MOVE AL-UANON           TO CLMNOA
  8406     END-IF.
  8407
  8408     IF PI-NO-CARRIER-SECURITY
  8409        IF CLMCARRL = ZERO
  8410             MOVE -1             TO CLMCARRL
  8411             MOVE AL-UABON       TO CLMCARRA
  8412             MOVE ER-0194        TO EMI-ERROR
  8413             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8414         ELSE
  8415             MOVE AL-UANON       TO CLMCARRA
  8416         END-IF
  8417     END-IF.
  8418
  8419     IF SUFXL = ZERO
  8420         MOVE SPACES             TO SUFXI
  8421         MOVE AL-UANON           TO SUFXA
  8422     ELSE
  8423         MOVE AL-UANON           TO SUFXA
  8424     END-IF.
  8425
  8426     IF NOT EMI-NO-ERRORS
  8427         GO TO 1050-SEND-CHECK
  8428     END-IF.
  8429
  8430
  8431
  8432* EXEC CICS HANDLE CONDITION
  8433*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8434*    END-EXEC.
  8435*    MOVE '"$I                   ! '' #00008196' TO DFHEIV0
  8436     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8437     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8438     MOVE X'2720233030303038313936' TO DFHEIV0(25:11)
  8439     CALL 'kxdfhei1' USING DFHEIV0
  8440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8441
  8442
  8443     MOVE 'MSTR'                 TO FILE-SWITCH
  8444     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8445
  8446     MOVE CLMCARRI               TO MSTR-CARRIER.
  8447     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8448
  8449     IF CERTNOL = ZERO     OR
  8450        CERTNOI = SPACES   OR
  8451        CERTNOI = LOW-VALUES
  8452         PERFORM 7600-BROWSE-CLAIM THRU 7699-EXIT
  8453         MOVE AL-SANON        TO CERTNOA
  8454                                 SUFXA
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 160
* EL130.cbl
  8455     ELSE
  8456         PERFORM 7610-BROWSE-CLAIM-LOOP THRU 7699-EXIT
  8457     END-IF.
  8458
  8459     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8460     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8461
  8462
  8463
  8464* EXEC CICS HANDLE CONDITION
  8465*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8466*    END-EXEC.
  8467*    MOVE '"$I                   ! ( #00008220' TO DFHEIV0
  8468     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8469     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8470     MOVE X'2820233030303038323230' TO DFHEIV0(25:11)
  8471     CALL 'kxdfhei1' USING DFHEIV0
  8472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8473
  8474
  8475     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  8476
  8477     IF NOT PI-NO-ACCOUNT-SECURITY
  8478         IF PI-ACCOUNT-SECURITY NOT = CL-CERT-ACCOUNT
  8479           MOVE ER-2371          TO EMI-ERROR
  8480           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8481           MOVE -1               TO MAINTL
  8482           GO TO 8200-SEND-DATAONLY
  8483         END-IF
  8484     END-IF.
  8485
  8486
  8487
  8488* EXEC CICS HANDLE CONDITION
  8489*        NOTFND   (1025-SHOW-RECORD-NOT-FOUND)
  8490*    END-EXEC.
  8491*    MOVE '"$I                   ! ) #00008236' TO DFHEIV0
  8492     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8493     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8494     MOVE X'2920233030303038323336' TO DFHEIV0(25:11)
  8495     CALL 'kxdfhei1' USING DFHEIV0
  8496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8497
  8498
  8499     MOVE 'Y'                    TO CLAIM-SWITCH.
  8500     PERFORM 7910-READ-NINETY THRU 7910-EXIT.
  8501     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
  8502     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
  8503     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
  8504     PERFORM 7910-READ-ACTV THRU 7910-EXIT.
  8505
  8506 1000-SHOW-END-OF-PERFORM.
  8507
  8508     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8509     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8510     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8511     MOVE CL-CERT-STATE          TO CERT-STATE.
  8512     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 161
* EL130.cbl
  8513     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8514     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8515
  8516     MOVE 'CERT'                 TO FILE-SWITCH.
  8517
  8518     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  8519
  8520     MOVE CL-LAST-MAINT-DT       TO PI-MSTR-DT.
  8521     MOVE CL-LAST-MAINT-HHMMSS   TO PI-MSTR-WHEN.
  8522     MOVE AT-RECORDED-DT         TO PI-TRLR-DT.
  8523     MOVE AT-LAST-MAINT-HHMMSS   TO PI-TRLR-WHEN.
  8524     MOVE CLMNOI                 TO PI-LAST-CLAIM.
  8525     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
  8526     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
  8527     MOVE CLMCARRI               TO PI-LAST-CARR.
  8528
  8529     PERFORM 7000-BUILD-OUTPUT-MAP THRU 7099-EXIT.
  8530
  8531     IF MAINTI = 'I'
  8532         MOVE AL-SANOF TO  FSTNMEA   INITA     SEXA
  8533                 BIRTHDTA  LSTNMEA   RELCLMA
  8534                 LOANNOA   LOANBALA  BENECDA
  8535         MOVE AL-SANON TO  SSNA
  8536         MOVE SPACES   TO  INCURI    REPORTI
  8537         MOVE 'Y'      TO PI-INCURR-SW
  8538         MOVE ER-0522  TO EMI-ERROR
  8539         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8540     ELSE
  8541         MOVE ' '      TO PI-INCURR-SW
  8542     END-IF.
  8543
  8544     MOVE -1                     TO MAINTL.
  8545     MOVE MSTR-CARRIER           TO PI-CARRIER.
  8546     MOVE CERT-GROUPING          TO PI-GROUPING.
  8547     MOVE CERT-STATE             TO PI-STATE.
  8548     MOVE CERT-ACCOUNT           TO PI-ACCOUNT.
  8549     MOVE MSTR-CLAIM-NO          TO PI-CLAIM-NO.
  8550     MOVE MSTR-CERT-NO           TO PI-CERT-NO.
  8551     MOVE CERT-EFF-DT            TO PI-CERT-EFF-DT.
  8552
  8553     IF RETURNED-FROM NOT = SPACES
  8554         GO TO 8100-SEND-INITIAL-MAP
  8555     ELSE
  8556         GO TO 8200-SEND-DATAONLY
  8557     END-IF.
  8558
  8559 1025-SHOW-RECORD-NOT-FOUND.
  8560
  8561     IF FILE-SWITCH = 'MSTR'
  8562         MOVE ER-0204            TO EMI-ERROR
  8563     ELSE
  8564         IF FILE-SWITCH = 'TRLR'
  8565             MOVE ER-0205        TO EMI-ERROR
  8566         ELSE
  8567             MOVE ER-0206        TO EMI-ERROR
  8568         END-IF
  8569     END-IF.
  8570
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 162
* EL130.cbl
  8571     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8572
  8573 1050-SEND-CHECK.
  8574
  8575     IF RETURNED-FROM NOT = SPACES
  8576         GO TO 8100-SEND-INITIAL-MAP
  8577     ELSE
  8578         MOVE -1                 TO MAINTL
  8579         GO TO 8200-SEND-DATAONLY
  8580     END-IF.
  8581
  8582 2000-DELETE-CLAIM.
  8583     IF NOT MODIFY-CAP
  8584         MOVE ER-0070            TO EMI-ERROR
  8585         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8586         MOVE -1                 TO MAINTL
  8587         GO TO 8200-SEND-DATAONLY
  8588     END-IF.
  8589
  8590     IF CLMNOI   NOT = PI-LAST-CLAIM       OR
  8591        CLMCARRI NOT = PI-LAST-CARR        OR
  8592        CERTNOI  NOT = PI-LAST-CERT-PRIME  OR
  8593        SUFXI    NOT = PI-LAST-CERT-SUFX
  8594         MOVE ER-0207            TO EMI-ERROR
  8595         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8596         MOVE -1                 TO MAINTL
  8597         GO TO 8200-SEND-DATAONLY
  8598     END-IF.
  8599
  8600
  8601
  8602* EXEC CICS HANDLE CONDITION
  8603*        NOTFND   (2050-DELETE-NOT-FOUND)
  8604*    END-EXEC.
  8605*    MOVE '"$I                   ! * #00008342' TO DFHEIV0
  8606     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8607     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8608     MOVE X'2A20233030303038333432' TO DFHEIV0(25:11)
  8609     CALL 'kxdfhei1' USING DFHEIV0
  8610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8611
  8612
  8613     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  8614
  8615     MOVE CLMCARRI               TO MSTR-CARRIER.
  8616     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  8617     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  8618     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  8619
  8620     MOVE 'MSTR'                 TO FILE-SWITCH.
  8621     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
  8622
  8623     MOVE 'Y'                    TO CLAIM-SWITCH.
  8624
  8625     IF PI-MSTR-DT   NOT = CL-LAST-MAINT-DT  OR
  8626        PI-MSTR-WHEN NOT = CL-LAST-MAINT-HHMMSS
  8627         MOVE ER-0068        TO EMI-ERROR
  8628         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 163
* EL130.cbl
  8629         MOVE -1             TO MAINTL
  8630         GO TO 8200-SEND-DATAONLY
  8631     END-IF.
  8632
  8633     IF CL-TRAILER-SEQ-CNT NOT = 4095
  8634         MOVE ER-0569            TO EMI-ERROR
  8635         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8636         MOVE -1                 TO MAINTL
  8637         GO TO 8200-SEND-DATAONLY
  8638     END-IF.
  8639
  8640     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
  8641         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
  8642     END-IF.
  8643
  8644     IF CL-PURGED-DT NOT = LOW-VALUES
  8645         MOVE ER-7691            TO EMI-ERROR
  8646         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8647         MOVE -1                 TO MAINTL
  8648         GO TO 8200-SEND-DATAONLY
  8649     END-IF.
  8650
  8651     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
  8652     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
  8653     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
  8654     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
  8655     MOVE +0                     TO TRLR-SEQ-NO.
  8656     MOVE '1'                    TO TRLR-TYPE.
  8657
  8658     MOVE 'TRLR'                 TO FILE-SWITCH.
  8659
  8660
  8661
  8662* EXEC CICS READ
  8663*        UPDATE
  8664*        DATASET  (ELTRLR-DSID)
  8665*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8666*        RIDFLD   (ELTRLR-KEY)
  8667*    END-EXEC.
  8668*    MOVE '&"S        EU         (   #00008394' TO DFHEIV0
  8669     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8670     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8671     MOVE X'2020233030303038333934' TO DFHEIV0(25:11)
  8672     CALL 'kxdfhei1' USING DFHEIV0,
  8673           ELTRLR-DSID,
  8674           DFHEIV20,
  8675           DFHEIV99,
  8676           ELTRLR-KEY,
  8677           DFHEIV99,
  8678           DFHEIV99,
  8679           DFHEIV99
  8680     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8681         DFHEIV20
  8682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8683
  8684
  8685     IF PI-TRLR-DT   NOT = AT-RECORDED-DT  OR
  8686        PI-TRLR-WHEN NOT = AT-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 164
* EL130.cbl
  8687         MOVE ER-0068        TO EMI-ERROR
  8688         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8689         MOVE -1             TO MAINTL
  8690         GO TO 8200-SEND-DATAONLY
  8691     END-IF.
  8692
  8693
  8694
  8695* EXEC CICS DELETE
  8696*        DATASET   (ELTRLR-DSID)
  8697*    END-EXEC.
  8698*    MOVE '&(                    &   #00008410' TO DFHEIV0
  8699     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8700     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8701     MOVE X'2020233030303038343130' TO DFHEIV0(25:11)
  8702     CALL 'kxdfhei1' USING DFHEIV0,
  8703           ELTRLR-DSID,
  8704           DFHEIV99,
  8705           DFHEIV99,
  8706           DFHEIV99,
  8707           DFHEIV99
  8708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8709
  8710
  8711     MOVE +90                    TO TRLR-SEQ-NO.
  8712     MOVE '6'                    TO TRLR-TYPE.
  8713
  8714
  8715
  8716* EXEC CICS READ
  8717*        UPDATE
  8718*        DATASET  (ELTRLR-DSID)
  8719*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8720*        RIDFLD   (ELTRLR-KEY)
  8721*    END-EXEC.
  8722*    MOVE '&"S        EU         (   #00008418' TO DFHEIV0
  8723     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8724     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8725     MOVE X'2020233030303038343138' TO DFHEIV0(25:11)
  8726     CALL 'kxdfhei1' USING DFHEIV0,
  8727           ELTRLR-DSID,
  8728           DFHEIV20,
  8729           DFHEIV99,
  8730           ELTRLR-KEY,
  8731           DFHEIV99,
  8732           DFHEIV99,
  8733           DFHEIV99
  8734     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8735         DFHEIV20
  8736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8737
  8738
  8739
  8740
  8741* EXEC CICS DELETE
  8742*        DATASET   (ELTRLR-DSID)
  8743*    END-EXEC.
  8744*    MOVE '&(                    &   #00008426' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 165
* EL130.cbl
  8745     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8746     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8747     MOVE X'2020233030303038343236' TO DFHEIV0(25:11)
  8748     CALL 'kxdfhei1' USING DFHEIV0,
  8749           ELTRLR-DSID,
  8750           DFHEIV99,
  8751           DFHEIV99,
  8752           DFHEIV99,
  8753           DFHEIV99
  8754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8755
  8756
  8757     MOVE +91                    TO TRLR-SEQ-NO.
  8758     MOVE '6'                    TO TRLR-TYPE.
  8759
  8760
  8761
  8762* EXEC CICS READ
  8763*        UPDATE
  8764*        DATASET  (ELTRLR-DSID)
  8765*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  8766*        RIDFLD   (ELTRLR-KEY)
  8767*        RESP     (WS-RESPONSE)
  8768*    END-EXEC
  8769*    MOVE '&"S        EU         (  N#00008434' TO DFHEIV0
  8770     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8771     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8772     MOVE X'204E233030303038343334' TO DFHEIV0(25:11)
  8773     CALL 'kxdfhei1' USING DFHEIV0,
  8774           ELTRLR-DSID,
  8775           DFHEIV20,
  8776           DFHEIV99,
  8777           ELTRLR-KEY,
  8778           DFHEIV99,
  8779           DFHEIV99,
  8780           DFHEIV99
  8781     SET ADDRESS OF ACTIVITY-TRAILERS TO
  8782         DFHEIV20
  8783     MOVE EIBRESP  TO WS-RESPONSE
  8784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8785
  8786     IF WS-RESP-NORMAL
  8787
  8788* EXEC CICS DELETE
  8789*          DATASET   (ELTRLR-DSID)
  8790*       END-EXEC
  8791*    MOVE '&(                    &   #00008443' TO DFHEIV0
  8792     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8793     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8794     MOVE X'2020233030303038343433' TO DFHEIV0(25:11)
  8795     CALL 'kxdfhei1' USING DFHEIV0,
  8796           ELTRLR-DSID,
  8797           DFHEIV99,
  8798           DFHEIV99,
  8799           DFHEIV99,
  8800           DFHEIV99
  8801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8802     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 166
* EL130.cbl
  8803
  8804     MOVE MSTR-COMP-CD           TO CERT-COMP-CD.
  8805     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  8806     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  8807     MOVE CL-CERT-STATE          TO CERT-STATE.
  8808     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  8809     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  8810     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  8811
  8812     MOVE 'CERT'                 TO FILE-SWITCH.
  8813
  8814     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  8815
  8816     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT GIVING WS-NUM-HOLD.
  8817
  8818     IF WS-NUM-HOLD NOT = +0
  8819         GO TO 2005-REWRITE-CERT
  8820     END-IF.
  8821
  8822     IF NOT CERT-WAS-CREATED
  8823         MOVE SPACE              TO CM-CLAIM-INTERFACE-SW
  8824         GO TO 2005-REWRITE-CERT
  8825     END-IF.
  8826
  8827
  8828
  8829* EXEC CICS DELETE
  8830*        DATASET   (ELCERT-DSID)
  8831*    END-EXEC.
  8832*    MOVE '&(                    &   #00008472' TO DFHEIV0
  8833     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8834     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8835     MOVE X'2020233030303038343732' TO DFHEIV0(25:11)
  8836     CALL 'kxdfhei1' USING DFHEIV0,
  8837           ELCERT-DSID,
  8838           DFHEIV99,
  8839           DFHEIV99,
  8840           DFHEIV99,
  8841           DFHEIV99
  8842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8843
  8844
  8845     GO TO 2010-DELETE-CL.
  8846
  8847 2005-REWRITE-CERT.
  8848
  8849     SUBTRACT +1 FROM CM-CLAIM-ATTACHED-COUNT.
  8850
  8851
  8852
  8853* EXEC CICS HANDLE CONDITION
  8854*         DUPKEY   (2010-DELETE-CL)
  8855*    END-EXEC.
  8856*    MOVE '"$$                   ! + #00008483' TO DFHEIV0
  8857     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  8858     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8859     MOVE X'2B20233030303038343833' TO DFHEIV0(25:11)
  8860     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 167
* EL130.cbl
  8861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8862
  8863
  8864
  8865
  8866* EXEC CICS REWRITE
  8867*        DATASET  (ELCERT-DSID)
  8868*        FROM     (CERTIFICATE-MASTER)
  8869*    END-EXEC.
  8870     MOVE LENGTH OF
  8871      CERTIFICATE-MASTER
  8872       TO DFHEIV11
  8873*    MOVE '&& L                  %   #00008488' TO DFHEIV0
  8874     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8875     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8876     MOVE X'2020233030303038343838' TO DFHEIV0(25:11)
  8877     CALL 'kxdfhei1' USING DFHEIV0,
  8878           ELCERT-DSID,
  8879           CERTIFICATE-MASTER,
  8880           DFHEIV11,
  8881           DFHEIV99
  8882     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8883
  8884
  8885 2010-DELETE-CL.
  8886
  8887
  8888
  8889* EXEC CICS DELETE
  8890*        DATASET  (ELMSTR-DSID)
  8891*    END-EXEC.
  8892*    MOVE '&(                    &   #00008496' TO DFHEIV0
  8893     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8894     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8895     MOVE X'2020233030303038343936' TO DFHEIV0(25:11)
  8896     CALL 'kxdfhei1' USING DFHEIV0,
  8897           ELMSTR-DSID,
  8898           DFHEIV99,
  8899           DFHEIV99,
  8900           DFHEIV99,
  8901           DFHEIV99
  8902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8903
  8904
  8905     MOVE -1                     TO ONE-OR-MIN1.
  8906     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
  8907
  8908     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
  8909         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
  8910                                    WS-SAVE-CLAIM-KEY
  8911         MOVE +1                 TO ONE-OR-MIN1
  8912         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
  8913     END-IF.
  8914
  8915     MOVE ER-0000                TO EMI-ERROR.
  8916     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8917     MOVE LOW-VALUES             TO EL130AO.
  8918     MOVE -1                     TO MAINTL.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 168
* EL130.cbl
  8919     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  8920     MOVE ZEROS                  TO PI-CERT-SELECT-CNT
  8921                                    PI-CERT-PROCESSED
  8922                                    PI-LETTER-ERROR-CODE.
  8923     GO TO 8100-SEND-INITIAL-MAP.
  8924
  8925 2050-DELETE-NOT-FOUND.
  8926     IF FILE-SWITCH = 'MSTR'
  8927         MOVE -1                 TO CLMNOL
  8928         MOVE ER-0204            TO EMI-ERROR
  8929     ELSE
  8930         IF FILE-SWITCH = 'TRLR'
  8931             MOVE -1             TO MAINTL
  8932             MOVE ER-0205        TO EMI-ERROR
  8933         ELSE
  8934             MOVE -1             TO CERTNOL
  8935             MOVE ER-0206        TO EMI-ERROR
  8936         END-IF
  8937     END-IF.
  8938
  8939     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8940     GO TO 8200-SEND-DATAONLY.
  8941
  8942 3000-ADD-CLAIM.
  8943     IF NOT MODIFY-CAP
  8944         MOVE ER-0070            TO EMI-ERROR
  8945         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8946         MOVE -1                 TO MAINTL
  8947         GO TO 8200-SEND-DATAONLY
  8948     END-IF.
  8949
  8950     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
  8951
  8952     IF CERTMTI = 'S'
  8953         IF CERTNOI  = PI-SAVE-CERT-PRIME  AND
  8954            SUFXI    = PI-SAVE-CERT-SUFX   AND
  8955            WS-EFFDT = PI-SAVE-EFFDT       AND
  8956            ACCOUNTI = PI-SAVE-ACCOUNT
  8957             IF EMI-ERROR = 0
  8958                 GO TO 3010-TEST-FOR-ERRORS
  8959             ELSE
  8960                 MOVE PI-COMPANY-CD    TO  CERT-COMP-CD
  8961                 MOVE PI-CARRIER       TO  CERT-CARRIER
  8962                 MOVE PI-GROUPING      TO  CERT-GROUPING
  8963                 MOVE PI-STATE         TO  CERT-STATE
  8964                 MOVE PI-ACCOUNT       TO  CERT-ACCOUNT
  8965                 MOVE PI-CERT-EFF-DT   TO  CERT-EFF-DT
  8966                 MOVE PI-CERT-NO       TO  CERT-CERT-NO
  8967
  8968
  8969* EXEC CICS HANDLE CONDITION
  8970*                    NOTFND   (3010-TEST-FOR-ERRORS)
  8971*                END-EXEC
  8972*    MOVE '"$I                   ! , #00008563' TO DFHEIV0
  8973     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8975     MOVE X'2C20233030303038353633' TO DFHEIV0(25:11)
  8976     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 169
* EL130.cbl
  8977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8978                 PERFORM 7940-READ-CERT THRU 7940-EXIT
  8979                 PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT
  8980                 GO TO 3010-TEST-FOR-ERRORS
  8981             END-IF
  8982         END-IF
  8983     END-IF.
  8984
  8985     IF CERTMTI = 'A'
  8986         IF NOT PI-NO-CARRIER-SECURITY OR
  8987             NOT PI-NO-ACCOUNT-SECURITY
  8988             MOVE ER-2370          TO EMI-ERROR
  8989             MOVE -1               TO MAINTL
  8990             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8991             GO TO 8200-SEND-DATAONLY
  8992         ELSE
  8993             PERFORM 6300-REQUIRED-CERT-EDIT THRU 6399-EXIT
  8994             GO TO 3010-TEST-FOR-ERRORS
  8995         END-IF
  8996     END-IF.
  8997
  8998     IF CERTNOL = ZEROS
  8999        GO TO 3010-TEST-FOR-ERRORS
  9000     END-IF.
  9001
  9002 3000-READ-CERT.
  9003
  9004     MOVE PI-COMPANY-CD          TO CERT-COMP-CD-5
  9005                                    MSTR5-COMP-CD.
  9006     MOVE CERTNOI                TO CERT-CERT-5-PRIME
  9007                                    MSTR5-CERT-NO-PRIME.
  9008     MOVE SUFXI                  TO CERT-CERT-5-SUFX
  9009                                    MSTR5-CERT-NO-SUFX.
  9010
  9011
  9012
  9013* EXEC CICS HANDLE CONDITION
  9014*         DUPKEY   (3008-DUP-ERROR)
  9015*         NOTFND   (3009-NOT-FOUND)
  9016*    END-EXEC
  9017*    MOVE '"$$I                  ! - #00008600' TO DFHEIV0
  9018     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
  9019     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9020     MOVE X'2D20233030303038363030' TO DFHEIV0(25:11)
  9021     CALL 'kxdfhei1' USING DFHEIV0
  9022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9023
  9024     PERFORM 7980-READ-CERT5 THRU 7980-EXIT.
  9025
  9026     IF NOT PI-NO-ACCOUNT-SECURITY
  9027         IF PI-ACCOUNT-SECURITY NOT = CM-ACCOUNT
  9028             MOVE ER-2371          TO EMI-ERROR
  9029             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9030             MOVE -1               TO MAINTL
  9031             GO TO 8200-SEND-DATAONLY
  9032         END-IF
  9033     END-IF.
  9034
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 170
* EL130.cbl
  9035     MOVE CM-CERT-NO             TO PI-SAVE-CERT.
  9036     MOVE CM-ACCOUNT             TO PI-SAVE-ACCOUNT.
  9037     MOVE CM-CERT-EFF-DT         TO PI-SAVE-EFFDT.
  9038     MOVE CM-COMPANY-CD          TO PI-COMPANY-CD.
  9039     MOVE CM-CARRIER             TO PI-CARRIER.
  9040     MOVE CM-GROUPING            TO PI-GROUPING.
  9041     MOVE CM-STATE               TO PI-STATE.
  9042     MOVE CM-ACCOUNT             TO PI-ACCOUNT.
  9043     MOVE CM-CERT-EFF-DT         TO PI-CERT-EFF-DT.
  9044     MOVE CM-CERT-NO             TO PI-CERT-NO.
  9045     PERFORM 7050-BUILD-MAP-CERT-DATA THRU 7099-EXIT.
  9046
  9047     IF CRTLNMEI NOT = SPACES AND LOW-VALUES
  9048         IF LSTNMEO = SPACES OR LOW-VALUES
  9049             MOVE CRTLNMEI       TO  LSTNMEO
  9050             MOVE AL-UANON       TO  LSTNMEA
  9051         END-IF
  9052     END-IF.
  9053
  9054     MOVE 'S'                    TO CERTMTO.
  9055*    MOVE AL-UANON               TO CERTMTA  CERTNOA  CLMCARRA
  9056     MOVE AL-SANON               TO CERTNOA.
  9057     MOVE AL-UANON               TO CERTMTA   CLMCARRA
  9058                                 EFFDTA ACCOUNTA STATEA   GROUPA.
  9059     IF EMI-NO-ERRORS
  9060         MOVE -1                  TO MAINTL
  9061     END-IF.
  9062
  9063     IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9064         PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9065         IF INCURRED-DATE-MATCH
  9066             MOVE ER-7352         TO EMI-ERROR
  9067             MOVE -1              TO CERTNOL
  9068             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9069         ELSE
  9070             IF NO-CLAIMS-FOR-CERT
  9071                 MOVE ER-7353     TO EMI-ERROR
  9072                 MOVE -1          TO CERTNOL
  9073                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9074             ELSE
  9075                 MOVE ER-0558     TO EMI-ERROR
  9076                 MOVE -1          TO CERTNOL
  9077                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9078                 GO TO 3010-TEST-FOR-ERRORS
  9079             END-IF
  9080         END-IF
  9081     END-IF.
  9082
  9083 3007-SEND-SCREEN.
  9084     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9085         GO TO 8150-SEND-MAP-CURSOR
  9086     ELSE
  9087         GO TO 8200-SEND-DATAONLY
  9088     END-IF.
  9089
  9090 3008-DUP-ERROR.
  9091     MOVE ER-0560                TO EMI-ERROR.
  9092     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 171
* EL130.cbl
  9093     MOVE -1                     TO CERTNOL.
  9094     GO TO 3007-SEND-SCREEN.
  9095
  9096 3009-NOT-FOUND.
  9097     MOVE ER-0214                TO EMI-ERROR.
  9098     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9099     MOVE -1                     TO CERTNOL.
  9100     GO TO 3007-SEND-SCREEN.
  9101
  9102 3010-TEST-FOR-ERRORS.
  9103
  9104     PERFORM 6200-EDIT-CERT-DATA           THRU 6200-EXIT.
  9105     perform 6500-get-acct    thru 6500-exit
  9106     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
  9107*     perform 6500-get-acct    thru 6500-exit
  9108
  9109     MOVE ZEROS                  TO WS-MONTHS-BETWEEN
  9110     move +0                     to e1
  9111     move spaces                 to ws-dcc-error-line
  9112     move ' '                    to ws-zero-bens-avail
  9113
  9114     if ws-dcc-product-code not = spaces
  9115        PERFORM 3997-GET-ERPDEF  THRU 3997-EXIT
  9116        IF ERPDEF-FOUND
  9117           MOVE CM-CERT-EFF-DT   TO DC-BIN-DATE-1
  9118           MOVE WS-INCUR         TO DC-BIN-DATE-2
  9119           MOVE '1'              TO DC-OPTION-CODE
  9120           MOVE +0               TO DC-ELAPSED-MONTHS
  9121                                    DC-ELAPSED-DAYS
  9122           PERFORM 9700-LINK-DATE-CONVERT
  9123                                 THRU 9700-EXIT
  9124           IF NO-CONVERSION-ERROR
  9125              MOVE DC-ELAPSED-MONTHS
  9126                                 TO WS-MONTHS-BETWEEN
  9127              IF DC-ELAPSED-DAYS > 1
  9128                 ADD 1 TO WS-MONTHS-BETWEEN
  9129              END-IF
  9130           ELSE
  9131              MOVE ZEROS         TO WS-MONTHS-BETWEEN
  9132           END-IF
  9133
  9134           evaluate true
  9135              when (ws-excl-period not = zeros)
  9136                 and (ws-months-between <= ws-excl-period)
  9137                 MOVE -1         TO MAINTL
  9138                 add +1          to e1
  9139                 move 'Y'        to ws-zero-bens-avail
  9140                 MOVE ER-1651    TO EMI-ERROR
  9141                                    ws-error-no (e1)
  9142                 PERFORM 9900-ERROR-FORMAT
  9143                                 THRU 9900-EXIT
  9144              when (ws-cov-ends not = zeros)
  9145                 and (ws-months-between > ws-cov-ends)
  9146                 MOVE -1         TO MAINTL
  9147                 add +1          to e1
  9148                 move 'Y'        to ws-zero-bens-avail
  9149                 MOVE ER-1653    TO EMI-ERROR
  9150                                    ws-error-no (e1)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 172
* EL130.cbl
  9151                 evaluate true
  9152                    when clmtypei = 'L'
  9153                       move '  LF  ' to emi-claim-type
  9154                    when clmtypei = 'I'
  9155                       move '  IU  ' to emi-claim-type
  9156                    when clmtypei = 'F'
  9157                       move '  FL  ' to emi-claim-type
  9158                    when other
  9159                       move '  AH  ' to emi-claim-type
  9160                 end-evaluate
  9161                 PERFORM 9900-ERROR-FORMAT
  9162                                 THRU 9900-EXIT
  9163              when (ws-acc-period not = zeros)
  9164                 and (ws-months-between <= ws-acc-period)
  9165                 MOVE -1         TO MAINTL
  9166                 add +1          to e1
  9167                 MOVE ER-1652    TO EMI-ERROR
  9168                                    ws-error-no (e1)
  9169                 PERFORM 9900-ERROR-FORMAT
  9170                                 THRU 9900-EXIT
  9171                 add +1          to e1
  9172                 move er-1655    to emi-error
  9173                                    ws-error-no (e1)
  9174                 PERFORM 9900-ERROR-FORMAT
  9175                                 THRU 9900-EXIT
  9176              when clmtypei = 'I'
  9177                 add +1          to e1
  9178                 move er-1661    to emi-error
  9179                                    ws-error-no (e1)
  9180                 PERFORM 9900-ERROR-FORMAT
  9181                                 THRU 9900-EXIT
  9182           end-evaluate
  9183        END-IF
  9184*       perform 3996-read-cert-claim-trailer
  9185*                                thru 3996-exit
  9186     END-IF
  9187     perform 3996-read-cert-claim-trailer
  9188                                 thru 3996-exit
  9189     IF CERTMTI NOT = 'A'
  9190         IF CM-CLAIM-ATTACHED-COUNT NOT = ZERO
  9191             MOVE PI-COMPANY-CD       TO MSTR5-COMP-CD
  9192             MOVE CERTNOI             TO MSTR5-CERT-NO-PRIME
  9193             MOVE SUFXI               TO MSTR5-CERT-NO-SUFX
  9194             PERFORM 7500-BROWSE-FOR-DUPLICATE THRU 7500-EXIT
  9195             IF INCURRED-DATE-MATCH
  9196                 MOVE ER-7352         TO EMI-ERROR
  9197                 MOVE -1              TO CERTNOL
  9198                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9199             ELSE
  9200                 IF NO-CLAIMS-FOR-CERT
  9201                     MOVE ER-7353     TO EMI-ERROR
  9202                     MOVE -1          TO CERTNOL
  9203                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9204                 ELSE
  9205                     MOVE ER-0558     TO EMI-ERROR
  9206                     MOVE -1          TO CERTNOL
  9207                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9208                 END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 173
* EL130.cbl
  9209             END-IF
  9210         END-IF
  9211     END-IF.
  9212
  9213     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
  9214         MOVE ER-0433             TO EMI-ERROR
  9215         MOVE -1                  TO MAINTL
  9216         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9217         GO TO 8200-SEND-DATAONLY
  9218     END-IF.
  9219
  9220     IF (EMI-NO-ERRORS)
  9221        OR (ZEROS = EMI-FATAL-CTR AND EMI-FORCABLE-CTR)
  9222         GO TO 3015-TRY-TO-BUILD
  9223     END-IF.
  9224
  9225     IF EIBAID = DFHPF6
  9226         IF EMI-FATAL-CTR NOT EQUAL ZERO
  9227             MOVE ER-0434         TO EMI-ERROR
  9228             MOVE -1              TO MAINTL
  9229             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9230             GO TO 8200-SEND-DATAONLY
  9231         ELSE
  9232             MOVE +1              TO INCURL
  9233             GO TO 3015-TRY-TO-BUILD
  9234         END-IF
  9235     END-IF.
  9236
  9237     IF RETURNED-FROM = XCTL-132 OR XCTL-127
  9238         GO TO 8150-SEND-MAP-CURSOR
  9239     ELSE
  9240         GO TO 8200-SEND-DATAONLY
  9241     END-IF.
  9242
  9243 3015-TRY-TO-BUILD.
  9244     IF CLMNOL EQUAL ZERO
  9245         GO TO 3030-BUILD-CONT
  9246     END-IF.
  9247
  9248
  9249
  9250* EXEC CICS HANDLE CONDITION
  9251*        NOTFND   (3030-BUILD-CONT)
  9252*    END-EXEC.
  9253*    MOVE '"$I                   ! . #00008830' TO DFHEIV0
  9254     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9255     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9256     MOVE X'2E20233030303038383330' TO DFHEIV0(25:11)
  9257     CALL 'kxdfhei1' USING DFHEIV0
  9258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9259
  9260
  9261     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9262
  9263     MOVE CLMCARRI               TO MSTR-CARRIER.
  9264     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
  9265     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9266     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 174
* EL130.cbl
  9267
  9268     MOVE 'MSTR'                 TO FILE-SWITCH.
  9269
  9270     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9271
  9272     MOVE ER-0221                TO EMI-ERROR.
  9273
  9274     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9275     MOVE -1                     TO MAINTL.
  9276     GO TO 8200-SEND-DATAONLY.
  9277
  9278 3030-BUILD-CONT.
  9279     IF (CERTMTI NOT = 'A')
  9280        and (pi-company-id not = 'DCC' and 'VPP')
  9281         GO TO 3060-BUILD-CONT
  9282     END-IF.
  9283
  9284
  9285
  9286* EXEC CICS HANDLE CONDITION
  9287*        NOTFND   (3033-ACCT-NOT-FOUND)
  9288*        ENDFILE  (3033-ACCT-NOT-FOUND)
  9289*    END-EXEC.
  9290*    MOVE '"$I''                  ! / #00008858' TO DFHEIV0
  9291     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  9292     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9293     MOVE X'2F20233030303038383538' TO DFHEIV0(25:11)
  9294     CALL 'kxdfhei1' USING DFHEIV0
  9295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9296
  9297
  9298     MOVE SPACES                 TO ERACCT-KEY.
  9299
  9300     IF CARR-GROUP-ST-ACCNT-CNTL
  9301         MOVE PI-COMPANY-CD      TO ACCT-COMP-CD
  9302         MOVE CRTCARRI           TO ACCT-CARRIER
  9303         MOVE GROUPI             TO ACCT-GROUPING
  9304         MOVE STATEI             TO ACCT-STATE
  9305         MOVE ACCOUNTI           TO ACCT-ACCOUNT
  9306         GO TO 3031-MOVE-ACCT-KEY
  9307     END-IF.
  9308
  9309     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
  9310     MOVE ACCOUNTI               TO ACCT-ACCOUNT.
  9311
  9312     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
  9313         MOVE STATEI             TO ACCT-STATE
  9314     END-IF.
  9315
  9316     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
  9317         MOVE CRTCARRI           TO ACCT-CARRIER
  9318     END-IF.
  9319
  9320 3031-MOVE-ACCT-KEY.
  9321     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY.
  9322
  9323
  9324
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 175
* EL130.cbl
  9325* EXEC CICS STARTBR
  9326*        DATASET     (ERACCT2-DSID)
  9327*        RIDFLD      (SAVE-ERACCT-KEY)
  9328*        GENERIC
  9329*        KEYLENGTH   (20)
  9330*    END-EXEC.
  9331     MOVE 20
  9332       TO DFHEIV11
  9333     MOVE 0
  9334       TO DFHEIV12
  9335*    MOVE '&,   KG    G          &   #00008889' TO DFHEIV0
  9336     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  9337     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9338     MOVE X'2020233030303038383839' TO DFHEIV0(25:11)
  9339     CALL 'kxdfhei1' USING DFHEIV0,
  9340           ERACCT2-DSID,
  9341           SAVE-ERACCT-KEY,
  9342           DFHEIV11,
  9343           DFHEIV12,
  9344           DFHEIV99
  9345     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9346
  9347
  9348
  9349
  9350* EXEC CICS HANDLE CONDITION
  9351*        ENDFILE   (3032-NOT-IN-DT-RANGE)
  9352*    END-EXEC.
  9353*    MOVE '"$''                   ! 0 #00008897' TO DFHEIV0
  9354     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  9355     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9356     MOVE X'3020233030303038383937' TO DFHEIV0(25:11)
  9357     CALL 'kxdfhei1' USING DFHEIV0
  9358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9359
  9360
  9361 3031-READ-ACCT-LOOP.
  9362
  9363
  9364* EXEC CICS READNEXT
  9365*        DATASET   (ERACCT2-DSID)
  9366*        SET       (ADDRESS OF ACCOUNT-MASTER)
  9367*        RIDFLD    (SAVE-ERACCT-KEY)
  9368*    END-EXEC.
  9369     MOVE 0
  9370       TO DFHEIV11
  9371*    MOVE '&.S                   )   #00008903' TO DFHEIV0
  9372     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9373     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9374     MOVE X'2020233030303038393033' TO DFHEIV0(25:11)
  9375     CALL 'kxdfhei1' USING DFHEIV0,
  9376           ERACCT2-DSID,
  9377           DFHEIV20,
  9378           DFHEIV99,
  9379           SAVE-ERACCT-KEY,
  9380           DFHEIV99,
  9381           DFHEIV11,
  9382           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 176
* EL130.cbl
  9383           DFHEIV99
  9384     SET ADDRESS OF ACCOUNT-MASTER TO
  9385         DFHEIV20
  9386     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9387
  9388
  9389     IF ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1  OR
  9390        ACCT-CARRIER  NOT = AM-VG-CARRIER     OR
  9391        ACCT-GROUPING NOT = AM-VG-GROUPING    OR
  9392        ACCT-STATE    NOT = AM-VG-STATE       OR
  9393        ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT
  9394         GO TO 3033-ACCT-NOT-FOUND
  9395     END-IF.
  9396
  9397     IF WS-EFFDT NOT LESS AM-EFFECTIVE-DT  AND
  9398        WS-EFFDT LESS AM-EXPIRATION-DT
  9399         MOVE PI-COMPANY-CD    TO CERT-COMP-CD
  9400         MOVE AM-CARRIER       TO CERT-CARRIER
  9401         MOVE AM-GROUPING      TO CERT-GROUPING
  9402         MOVE AM-STATE         TO CERT-STATE
  9403         MOVE AM-ACCOUNT       TO CERT-ACCOUNT
  9404         MOVE WS-EFFDT         TO CERT-EFF-DT
  9405         MOVE CERTNOI          TO CERT-CERT-NO-PRIME
  9406         MOVE SUFXI            TO CERT-CERT-NO-SUFX
  9407         MOVE AM-REI-TABLE     TO WS-REIN-TABLE
  9408         GO TO 3034-CHECK-EMPLOYER-STATEMENT
  9409     END-IF.
  9410
  9411     IF WS-EFFDT NOT LESS AM-EXPIRATION-DT
  9412         GO TO 3031-READ-ACCT-LOOP
  9413     END-IF.
  9414
  9415 3032-NOT-IN-DT-RANGE.
  9416     MOVE ER-0226                TO EMI-ERROR.
  9417     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9418     MOVE -1                     TO EFFDTL.
  9419     GO TO 8200-SEND-DATAONLY.
  9420
  9421 3033-ACCT-NOT-FOUND.
  9422     MOVE ER-0226 TO EMI-ERROR.
  9423     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9424     MOVE -1                     TO ACCOUNTL.
  9425     GO TO 8200-SEND-DATAONLY.
  9426
  9427 3034-CHECK-EMPLOYER-STATEMENT.
  9428
  9429     IF AM-EMPLOYER-STMT-USED = '1' OR '2' OR '3' OR 'Y'
  9430*        NEXT SENTENCE
  9431         CONTINUE
  9432     ELSE
  9433         GO TO  3034-CHECK-ACCOUNT-LIMITS
  9434     END-IF.
  9435
  9436     MOVE CERT-EFF-DT            TO  DC-BIN-DATE-1.
  9437     MOVE WS-INCUR               TO  DC-BIN-DATE-2.
  9438     MOVE '1'                    TO  DC-OPTION-CODE.
  9439     MOVE +0                     TO  DC-ELAPSED-MONTHS
  9440                                     DC-ELAPSED-DAYS.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 177
* EL130.cbl
  9441     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9442
  9443     IF (AM-EMPLOYER-STMT-USED = '1' AND
  9444         DC-ELAPSED-DAYS LESS THAN +31)
  9445                      OR
  9446        (AM-EMPLOYER-STMT-USED = '2' AND
  9447         DC-ELAPSED-DAYS LESS THAN +61)
  9448                      OR
  9449        (AM-EMPLOYER-STMT-USED = '3' AND
  9450         DC-ELAPSED-DAYS LESS THAN +91)
  9451            MOVE 'Y'             TO  AM-EMPLOYER-STMT-USED
  9452     END-IF.
  9453
  9454 3034-CHECK-ACCOUNT-LIMITS.
  9455
  9456     IF CERTMTI NOT = 'A'
  9457         GO TO 3060-BUILD-CONT
  9458     END-IF.
  9459
  9460     IF AM-STATUS NOT = '0'
  9461         MOVE ER-0225                TO EMI-ERROR
  9462         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9463         MOVE -1                     TO ACCOUNTL
  9464     END-IF.
  9465
  9466     IF EIBAID = DFHPF6
  9467         IF EMI-FATAL-CTR NOT = ZERO
  9468             MOVE ER-0434         TO EMI-ERROR
  9469             MOVE -1              TO MAINTL
  9470             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9471             GO TO 8200-SEND-DATAONLY
  9472         END-IF
  9473     END-IF.
  9474
  9475*    IF PI-COMPANY-ID NOT = 'CRI'
  9476*        GO TO 3035-END-BROWSE
  9477*    END-IF.
  9478
  9479 3035-END-BROWSE.
  9480
  9481
  9482* EXEC CICS ENDBR
  9483*        DATASET    (ERACCT2-DSID)
  9484*    END-EXEC.
  9485     MOVE 0
  9486       TO DFHEIV11
  9487*    MOVE '&2                    $   #00009001' TO DFHEIV0
  9488     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9489     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9490     MOVE X'2020233030303039303031' TO DFHEIV0(25:11)
  9491     CALL 'kxdfhei1' USING DFHEIV0,
  9492           ERACCT2-DSID,
  9493           DFHEIV11,
  9494           DFHEIV99
  9495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9496
  9497
  9498 3040-CHECK-CERT-ALREADY-ON.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 178
* EL130.cbl
  9499
  9500
  9501* EXEC CICS HANDLE CONDITION
  9502*        NOTFND   (3070-BUILD-CONT)
  9503*    END-EXEC.
  9504*    MOVE '"$I                   ! 1 #00009007' TO DFHEIV0
  9505     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9506     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9507     MOVE X'3120233030303039303037' TO DFHEIV0(25:11)
  9508     CALL 'kxdfhei1' USING DFHEIV0
  9509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9510
  9511
  9512     PERFORM 7940-READ-CERT THRU 7940-EXIT.
  9513
  9514     MOVE ER-0229                TO EMI-ERROR.
  9515     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9516     MOVE -1                     TO MAINTL.
  9517     GO TO 8200-SEND-DATAONLY.
  9518
  9519 3060-BUILD-CONT.
  9520     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9521     MOVE CRTCARRI               TO CERT-CARRIER.
  9522     MOVE GROUPI                 TO CERT-GROUPING.
  9523     MOVE STATEI                 TO CERT-STATE.
  9524     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
  9525     MOVE CERTNOI                TO CERT-CERT-NO-PRIME.
  9526     MOVE SUFXI                  TO CERT-CERT-NO-SUFX.
  9527     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
  9528
  9529
  9530
  9531* EXEC CICS HANDLE CONDITION
  9532*        NOTFND  (3065-CERT-NOT-FOUND)
  9533*    END-EXEC.
  9534*    MOVE '"$I                   ! 2 #00009029' TO DFHEIV0
  9535     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9537     MOVE X'3220233030303039303239' TO DFHEIV0(25:11)
  9538     CALL 'kxdfhei1' USING DFHEIV0
  9539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9540
  9541
  9542     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
  9543
  9544     GO TO 3070-BUILD-CONT.
  9545
  9546 3065-CERT-NOT-FOUND.
  9547     MOVE ER-0244                TO EMI-ERROR.
  9548     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9549     MOVE -1                     TO CERTNOL.
  9550     GO TO 8200-SEND-DATAONLY.
  9551
  9552 3070-BUILD-CONT.
  9553     IF CLMNOL NOT = ZERO
  9554         GO TO 3200-BUILD-ZERO-TRAILER
  9555     END-IF.
  9556
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 179
* EL130.cbl
  9557     MOVE SPACES                 TO ELCNTL-KEY.
  9558
  9559     IF CONTROL-IS-ACTUAL-CARRIER
  9560         MOVE PI-CARRIER         TO CNTL-CARRIER
  9561     ELSE
  9562         MOVE PI-CARRIER-CONTROL-LEVEL
  9563                                 TO CNTL-CARRIER
  9564     END-IF.
  9565
  9566     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  9567     MOVE '6'                    TO CNTL-REC-TYPE.
  9568     MOVE +0                     TO CNTL-SEQ-NO.
  9569
  9570
  9571
  9572* EXEC CICS HANDLE CONDITION
  9573*        NOTFND   (3100-CARRIER-NOT-FOUND)
  9574*    END-EXEC.
  9575*    MOVE '"$I                   ! 3 #00009062' TO DFHEIV0
  9576     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9578     MOVE X'3320233030303039303632' TO DFHEIV0(25:11)
  9579     CALL 'kxdfhei1' USING DFHEIV0
  9580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9581
  9582
  9583
  9584
  9585* EXEC CICS READ
  9586*        UPDATE
  9587*        DATASET   (ELCNTL-DSID)
  9588*        SET       (ADDRESS OF CONTROL-FILE)
  9589*        RIDFLD    (ELCNTL-KEY)
  9590*    END-EXEC.
  9591*    MOVE '&"S        EU         (   #00009067' TO DFHEIV0
  9592     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9593     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9594     MOVE X'2020233030303039303637' TO DFHEIV0(25:11)
  9595     CALL 'kxdfhei1' USING DFHEIV0,
  9596           ELCNTL-DSID,
  9597           DFHEIV20,
  9598           DFHEIV99,
  9599           ELCNTL-KEY,
  9600           DFHEIV99,
  9601           DFHEIV99,
  9602           DFHEIV99
  9603     SET ADDRESS OF CONTROL-FILE TO
  9604         DFHEIV20
  9605     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9606
  9607
  9608     IF CLAIM-NO-MANUAL
  9609         GO TO 3120-CLAIM-MUST-BE-INPUT
  9610     END-IF.
  9611
  9612     MOVE CF-CLAIM-NO-METHOD     TO SAVE-METHOD.
  9613     MOVE CF-CLAIM-COUNTER       TO SAVE-COUNTER.
  9614
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 180
* EL130.cbl
  9615     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' OR 'VPP'
  9616         CONTINUE
  9617     ELSE
  9618         GO TO 3080-ASSIGN-LOOP
  9619     END-IF.
  9620
  9621
  9622
  9623* EXEC CICS UNLOCK
  9624*        DATASET   (ELCNTL-DSID)
  9625*    END-EXEC.
  9626*    MOVE '&*                    #   #00009088' TO DFHEIV0
  9627     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  9628     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9629     MOVE X'2020233030303039303838' TO DFHEIV0(25:11)
  9630     CALL 'kxdfhei1' USING DFHEIV0,
  9631           ELCNTL-DSID,
  9632           DFHEIV99
  9633     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9634
  9635
  9636     MOVE '1'                    TO CNTL-REC-TYPE.
  9637     MOVE SPACES                 TO CNTL-ACCESS.
  9638
  9639     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9640
  9641
  9642
  9643* EXEC CICS HANDLE CONDITION
  9644*        NOTFND   (3110-COMPANY-NOT-FOUND)
  9645*    END-EXEC.
  9646*    MOVE '"$I                   ! 4 #00009098' TO DFHEIV0
  9647     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9648     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9649     MOVE X'3420233030303039303938' TO DFHEIV0(25:11)
  9650     CALL 'kxdfhei1' USING DFHEIV0
  9651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9652
  9653
  9654     PERFORM 7960-READ-CNTL-UPDATE THRU 7960-EXIT.
  9655
  9656     MOVE CF-CO-CLAIM-COUNTER    TO SAVE-COUNTER.
  9657
  9658 3080-ASSIGN-LOOP.
  9659     IF (SAVE-COUNTER = +99999   AND SAVE-METHOD = '2') OR
  9660        (SAVE-COUNTER = +9999999 AND SAVE-METHOD = '3')
  9661         MOVE +0                 TO SAVE-COUNTER
  9662     END-IF.
  9663
  9664     ADD +1 TO SAVE-COUNTER.
  9665
  9666     IF SAVE-METHOD  = '3'
  9667         MOVE SAVE-COUNTER        TO WS-CLAIM-NUMBER-R1
  9668         GO TO 3090-SET-COMP
  9669     END-IF.
  9670
  9671     IF SAVE-METHOD  = '4'
  9672         MOVE SAVE-COUNTER       TO WS-CLAIM-NUMBER-R1
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 181
* EL130.cbl
  9673         MOVE CLMCARRI           TO WS-CN-PRF-A
  9674         GO TO 3090-SET-COMP
  9675     END-IF.
  9676
  9677     MOVE ZEROS                  TO WS-CLAIM-NUMBER.
  9678     MOVE SAVE-COUNTER           TO WS-CN-NUMBER.
  9679     MOVE SAVE-DATE              TO CURR-DATE.
  9680
  9681     IF CURR-MM LESS '10'
  9682         MOVE CURR-M2             TO WS-CN-PRF-B
  9683     END-IF.
  9684
  9685     IF CURR-MM = '10'
  9686        MOVE 'A'                 TO WS-CN-PRF-B
  9687     END-IF.
  9688     IF CURR-MM = '11'
  9689        MOVE 'B'                 TO WS-CN-PRF-B
  9690     END-IF.
  9691     IF CURR-MM = '12'
  9692        MOVE 'C'                 TO WS-CN-PRF-B
  9693     END-IF.
  9694
  9695     MOVE CURR-YEAR              TO WS-CN-PRF-A.
  9696
  9697 3090-SET-COMP.
  9698
  9699     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9700     MOVE WS-CLAIM-NUMBER        TO MSTR-CLAIM-NO
  9701                                    CLMNOO.
  9702     MOVE AL-UANON               TO CLMNOA.
  9703     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
  9704     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
  9705     MOVE CLMCARRI               TO MSTR-CARRIER.
  9706
  9707
  9708
  9709* EXEC CICS HANDLE CONDITION
  9710*        NOTFND  (3200-BUILD-ZERO-TRAILER)
  9711*    END-EXEC.
  9712*    MOVE '"$I                   ! 5 #00009156' TO DFHEIV0
  9713     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9714     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9715     MOVE X'3520233030303039313536' TO DFHEIV0(25:11)
  9716     CALL 'kxdfhei1' USING DFHEIV0
  9717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9718
  9719
  9720     PERFORM 7950-READ-CLAIM THRU 7950-EXIT.
  9721
  9722     GO TO 3080-ASSIGN-LOOP.
  9723
  9724 3100-CARRIER-NOT-FOUND.
  9725     MOVE ER-0252                TO EMI-ERROR.
  9726     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9727     MOVE -1                     TO CLMCARRL.
  9728     GO TO 8200-SEND-DATAONLY.
  9729
  9730 3110-COMPANY-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 182
* EL130.cbl
  9731     MOVE ER-0254                TO EMI-ERROR.
  9732     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9733     MOVE -1                     TO MAINTL.
  9734     GO TO 8200-SEND-DATAONLY.
  9735
  9736 3120-CLAIM-MUST-BE-INPUT.
  9737     MOVE ER-0264                TO EMI-ERROR.
  9738     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9739     MOVE -1                     TO CLMNOL.
  9740     GO TO 8200-SEND-DATAONLY.
  9741
  9742 3200-BUILD-ZERO-TRAILER.
  9743
  9744
  9745* EXEC CICS HANDLE CONDITION
  9746*        NOTFND
  9747*    END-EXEC.
  9748*    MOVE '"$                   ! 6 #00009184' TO DFHEIV0
  9749     MOVE X'2224B9202020202020202020' TO DFHEIV0(1:12)
  9750     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9751     MOVE X'3620233030303039313834' TO DFHEIV0(25:11)
  9752     CALL 'kxdfhei1' USING DFHEIV0
  9753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9754
  9755
  9756
  9757
  9758* EXEC CICS GETMAIN
  9759*        SET     (ADDRESS OF ACTIVITY-TRAILERS)
  9760*        LENGTH  (ELTRLR-LENGTH)
  9761*    END-EXEC.
  9762*    MOVE '," L                  $   #00009189' TO DFHEIV0
  9763     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  9764     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9765     MOVE X'2020233030303039313839' TO DFHEIV0(25:11)
  9766     CALL 'kxdfhei1' USING DFHEIV0,
  9767           DFHEIV20,
  9768           ELTRLR-LENGTH,
  9769           DFHEIV99
  9770     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9771         DFHEIV20
  9772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9773
  9774
  9775     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9776     MOVE 'AT'                   TO AT-RECORD-ID.
  9777
  9778     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9779     MOVE CLMCARRI               TO AT-CARRIER.
  9780     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9781     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9782     MOVE +0                     TO AT-SEQUENCE-NO.
  9783     MOVE '1'                    TO AT-TRAILER-TYPE.
  9784
  9785     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9786     MOVE '5'                    TO DC-OPTION-CODE.
  9787     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  9788     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 183
* EL130.cbl
  9789                                    AT-RESERVES-LAST-MAINT-DT.
  9790
  9791     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9792                                    AT-RESERVES-LAST-UPDATED-BY.
  9793
  9794     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9795
  9796     MOVE WS-RESERVE-CONTROLS    TO AT-RESERVE-CONTROLS.
  9797
  9798     MOVE +0                     TO AT-FUTURE-RESERVE
  9799                                    AT-IBNR-RESERVE
  9800                                    AT-PAY-CURRENT-RESERVE
  9801                                    AT-INITIAL-MANUAL-RESERVE
  9802                                    AT-CURRENT-MANUAL-RESERVE
  9803                                    AT-ITD-LIFE-REFUNDS
  9804                                    AT-ITD-AH-REFUNDS
  9805                                    AT-ITD-ADDITIONAL-RESERVE.
  9806
  9807     MOVE LOW-VALUES             TO AT-LAST-COMPUTED-DT.
  9808
  9809     IF MANRSVL NOT = ZERO
  9810         MOVE WS-MANRSV          TO AT-INITIAL-MANUAL-RESERVE
  9811                                    AT-CURRENT-MANUAL-RESERVE
  9812     END-IF.
  9813
  9814     MOVE WS-EXPENSE-CONTROLS    TO AT-EXPENSE-CONTROLS.
  9815
  9816     MOVE +0                     TO AT-ITD-PAID-EXPENSES
  9817                                    AT-ITD-CHARGEABLE-EXPENSE.
  9818
  9819     MOVE WS-TODAY-DT            TO AT-OPEN-CLOSE-DATE (1).
  9820     MOVE 'O'                    TO AT-OPEN-CLOSE-TYPE (1).
  9821     MOVE 'NEW'                  TO AT-OPEN-CLOSE-REASON (1).
  9822
  9823
  9824
  9825* EXEC CICS WRITE
  9826*        DATASET   (ELTRLR-DSID)
  9827*        FROM      (ACTIVITY-TRAILERS)
  9828*        RIDFLD    (AT-CONTROL-PRIMARY)
  9829*    END-EXEC.
  9830     MOVE LENGTH OF
  9831      ACTIVITY-TRAILERS
  9832       TO DFHEIV11
  9833*    MOVE '&$ L                  ''   #00009243' TO DFHEIV0
  9834     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9835     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9836     MOVE X'2020233030303039323433' TO DFHEIV0(25:11)
  9837     CALL 'kxdfhei1' USING DFHEIV0,
  9838           ELTRLR-DSID,
  9839           ACTIVITY-TRAILERS,
  9840           DFHEIV11,
  9841           AT-CONTROL-PRIMARY,
  9842           DFHEIV99,
  9843           DFHEIV99
  9844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9845
  9846
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 184
* EL130.cbl
  9847     MOVE AT-CONTROL-PRIMARY  TO  SAVE-AT-PRIMARY-KEY.
  9848
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 185
* EL130.cbl
  9850
  9851 3250-BUILD-I1-ADDRESS-TRAILER.
  9852
  9853     MOVE 'N'                    TO WS-NO-INSURED-ADDRESS.
  9854     MOVE +0                     TO WS-INSURED-ADDR-CNT.
  9855     MOVE PI-COMPANY-CD          TO WS-MA-COMPANY-CD.
  9856     MOVE CRTCARRI               TO WS-MA-CARRIER.
  9857     MOVE GROUPI                 TO WS-MA-GROUPING.
  9858     MOVE STATEI                 TO WS-MA-STATE.
  9859     MOVE PI-SAVE-ACCOUNT        TO WS-MA-ACCOUNT.
  9860     MOVE CERTNOI                TO WS-MA-CERT-PRIME.
  9861     MOVE SUFXI                  TO WS-MA-CERT-SFX.
  9862     MOVE PI-SAVE-EFFDT          TO WS-MA-CERT-EFF-DT.
  9863
  9864
  9865* EXEC CICS HANDLE CONDITION
  9866*        NOTFND   (3290-NO-INSURED-ADDRESS)
  9867*    END-EXEC.
  9868*    MOVE '"$I                   ! 7 #00009266' TO DFHEIV0
  9869     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9870     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9871     MOVE X'3720233030303039323636' TO DFHEIV0(25:11)
  9872     CALL 'kxdfhei1' USING DFHEIV0
  9873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9874
  9875
  9876
  9877* EXEC CICS READ
  9878*        EQUAL
  9879*        DATASET   (ERMAIL-DSID)
  9880*        SET       (ADDRESS OF MAILING-DATA)
  9881*        RIDFLD    (WS-MA-CONTROL-PRIMARY)
  9882*    END-EXEC.
  9883*    MOVE '&"S        E          (   #00009270' TO DFHEIV0
  9884     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9885     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9886     MOVE X'2020233030303039323730' TO DFHEIV0(25:11)
  9887     CALL 'kxdfhei1' USING DFHEIV0,
  9888           ERMAIL-DSID,
  9889           DFHEIV20,
  9890           DFHEIV99,
  9891           WS-MA-CONTROL-PRIMARY,
  9892           DFHEIV99,
  9893           DFHEIV99,
  9894           DFHEIV99
  9895     SET ADDRESS OF MAILING-DATA TO
  9896         DFHEIV20
  9897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9898
  9899
  9900     IF MA-INSURED-LAST-NAME NOT GREATER THAN SPACES
  9901         GO TO 3290-NO-INSURED-ADDRESS
  9902     END-IF.
  9903
  9904     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9905     MOVE 'AT'                   TO AT-RECORD-ID.
  9906
  9907     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 186
* EL130.cbl
  9908     MOVE CLMCARRI               TO AT-CARRIER.
  9909     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9910     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9911     MOVE +1                     TO AT-SEQUENCE-NO.
  9912     MOVE '5'                    TO AT-TRAILER-TYPE.
  9913
  9914     MOVE 'I'                    TO AT-ADDRESS-TYPE.
  9915     IF MA-INSURED-MIDDLE-INIT > SPACES
  9916        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9917               ' ' DELIMITED BY SIZE
  9918               MA-INSURED-MIDDLE-INIT DELIMITED BY SIZE
  9919               ' ' DELIMITED BY SIZE
  9920               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9921        INTO AT-MAIL-TO-NAME
  9922     ELSE
  9923        STRING MA-INSURED-FIRST-NAME DELIMITED BY '  '
  9924               ' ' DELIMITED BY SIZE
  9925               MA-INSURED-LAST-NAME DELIMITED BY SIZE
  9926        INTO AT-MAIL-TO-NAME
  9927     END-IF.
  9928     MOVE MA-ADDRESS-LINE-1      TO AT-ADDRESS-LINE-1.
  9929     MOVE MA-ADDRESS-LINE-2      TO AT-ADDRESS-LINE-2.
  9930*    MOVE MA-CITY-STATE          TO AT-CITY-STATE.
  9931     MOVE MA-CITY                TO AT-CITY
  9932     MOVE MA-ADDR-STATE          TO AT-STATE
  9933     MOVE MA-ZIP                 TO AT-ZIP
  9934     MOVE MA-PHONE-NO            TO AT-PHONE-NO
  9935
  9936     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9937                                    AT-ADDRESS-LAST-MAINT-DT.
  9938
  9939     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
  9940                                    AT-ADDRESS-LAST-UPDATED-BY.
  9941
  9942     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
  9943
  9944
  9945* EXEC CICS WRITE
  9946*        DATASET   (ELTRLR-DSID)
  9947*        FROM      (ACTIVITY-TRAILERS)
  9948*        RIDFLD    (AT-CONTROL-PRIMARY)
  9949*    END-EXEC.
  9950     MOVE LENGTH OF
  9951      ACTIVITY-TRAILERS
  9952       TO DFHEIV11
  9953*    MOVE '&$ L                  ''   #00009321' TO DFHEIV0
  9954     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9955     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9956     MOVE X'2020233030303039333231' TO DFHEIV0(25:11)
  9957     CALL 'kxdfhei1' USING DFHEIV0,
  9958           ELTRLR-DSID,
  9959           ACTIVITY-TRAILERS,
  9960           DFHEIV11,
  9961           AT-CONTROL-PRIMARY,
  9962           DFHEIV99,
  9963           DFHEIV99
  9964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9965
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 187
* EL130.cbl
  9966
  9967     ADD +1                      TO WS-INSURED-ADDR-CNT.
  9968     GO TO 3300-BUILD-NINETY-TRAILER.
  9969
  9970 3290-NO-INSURED-ADDRESS.
  9971      MOVE 'Y' TO WS-NO-INSURED-ADDRESS.
  9972
  9973 3300-BUILD-NINETY-TRAILER.
  9974
  9975     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  9976     MOVE 'AT'                   TO AT-RECORD-ID.
  9977
  9978     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
  9979     MOVE CLMCARRI               TO AT-CARRIER.
  9980
  9981     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
  9982     MOVE CERT-CERT-NO           TO AT-CERT-NO.
  9983     MOVE +90                    TO AT-SEQUENCE-NO.
  9984     MOVE '6'                    TO AT-TRAILER-TYPE.
  9985
  9986     IF DIAGL NOT = ZERO
  9987         MOVE DIAGI              TO AT-INFO-LINE-1
  9988     END-IF.
  9989
  9990     IF ICD1L NOT = ZERO
  9991         MOVE ICD1I              TO AT-ICD-CODE-1
  9992     END-IF.
  9993
  9994     IF ICD2L NOT = ZERO
  9995         MOVE ICD2I              TO AT-ICD-CODE-2
  9996     END-IF.
  9997
  9998     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
  9999                                    AT-GEN-INFO-LAST-MAINT-DT.
 10000
 10001     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 10002                                    AT-GEN-INFO-LAST-UPDATED-BY.
 10003     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 10004
 10005
 10006
 10007* EXEC CICS WRITE
 10008*        DATASET   (ELTRLR-DSID)
 10009*        FROM      (ACTIVITY-TRAILERS)
 10010*        RIDFLD    (AT-CONTROL-PRIMARY)
 10011*    END-EXEC.
 10012     MOVE LENGTH OF
 10013      ACTIVITY-TRAILERS
 10014       TO DFHEIV11
 10015*    MOVE '&$ L                  ''   #00009366' TO DFHEIV0
 10016     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10017     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10018     MOVE X'2020233030303039333636' TO DFHEIV0(25:11)
 10019     CALL 'kxdfhei1' USING DFHEIV0,
 10020           ELTRLR-DSID,
 10021           ACTIVITY-TRAILERS,
 10022           DFHEIV11,
 10023           AT-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 188
* EL130.cbl
 10024           DFHEIV99,
 10025           DFHEIV99
 10026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10027
 10028
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 189
* EL130.cbl
 10030 3400-CHECK-CERT-MAINT.
 10031
 10032     IF CERTMTI = 'A'
 10033         GO TO 3600-BUILD-NEW-CERT
 10034     END-IF.
 10035
 10036     IF NO-CLAIM-ATTACHED
 10037         MOVE '1'                TO CM-CLAIM-INTERFACE-SW
 10038     END-IF.
 10039
 10040     ADD +1                      TO CM-CLAIM-ATTACHED-COUNT.
 10041
 10042     IF CM-LF-CURRENT-STATUS = '2' OR
 10043        CM-AH-CURRENT-STATUS = '2'
 10044         GO TO 3400-REWRITE-CERT
 10045     END-IF.
 10046
 10047     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10048
 10049 3400-REWRITE-CERT.
 10050
 10051
 10052
 10053* EXEC CICS HANDLE CONDITION
 10054*        DUPKEY (3410-DUP-KEY)
 10055*    END-EXEC.
 10056*    MOVE '"$$                   ! 8 #00009395' TO DFHEIV0
 10057     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10059     MOVE X'3820233030303039333935' TO DFHEIV0(25:11)
 10060     CALL 'kxdfhei1' USING DFHEIV0
 10061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10062
 10063
 10064
 10065
 10066* EXEC CICS REWRITE
 10067*        DATASET   (ELCERT-DSID)
 10068*        FROM      (CERTIFICATE-MASTER)
 10069*    END-EXEC.
 10070     MOVE LENGTH OF
 10071      CERTIFICATE-MASTER
 10072       TO DFHEIV11
 10073*    MOVE '&& L                  %   #00009400' TO DFHEIV0
 10074     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10075     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10076     MOVE X'2020233030303039343030' TO DFHEIV0(25:11)
 10077     CALL 'kxdfhei1' USING DFHEIV0,
 10078           ELCERT-DSID,
 10079           CERTIFICATE-MASTER,
 10080           DFHEIV11,
 10081           DFHEIV99
 10082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10083
 10084
 10085 3410-DUP-KEY.
 10086     GO TO 3800-BUILD-NEW-CLAIM.
 10087
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 190
* EL130.cbl
 10088 3600-BUILD-NEW-CERT.
 10089
 10090
 10091* EXEC CICS GETMAIN
 10092*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 10093*        LENGTH   (ELCERT-LENGTH)
 10094*    END-EXEC.
 10095*    MOVE '," L                  $   #00009410' TO DFHEIV0
 10096     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10097     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10098     MOVE X'2020233030303039343130' TO DFHEIV0(25:11)
 10099     CALL 'kxdfhei1' USING DFHEIV0,
 10100           DFHEIV20,
 10101           ELCERT-LENGTH,
 10102           DFHEIV99
 10103     SET ADDRESS OF CERTIFICATE-MASTER TO
 10104         DFHEIV20
 10105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10106
 10107
 10108     MOVE SPACES                 TO CERTIFICATE-MASTER.
 10109
 10110     MOVE 'CM'                   TO CM-RECORD-ID.
 10111
 10112     MOVE PI-COMPANY-CD          TO CM-COMPANY-CD
 10113                                    CM-COMPANY-CD-A1
 10114                                    CM-COMPANY-CD-A2
 10115                                    CM-COMPANY-CD-A4
 10116                                    CM-COMPANY-CD-A5.
 10117
 10118     MOVE CERT-CARRIER           TO CM-CARRIER.
 10119     MOVE CERT-GROUPING          TO CM-GROUPING.
 10120     MOVE CERT-STATE             TO CM-STATE.
 10121     MOVE CERT-ACCOUNT           TO CM-ACCOUNT.
 10122     MOVE CERT-CERT-NO           TO CM-CERT-NO  CM-CERT-NO-A4.
 10123     MOVE CERT-EFF-DT            TO CM-CERT-EFF-DT.
 10124
 10125     MOVE ZERO      TO CM-LF-ORIG-TERM       CM-LF-BENEFIT-AMT
 10126                       CM-INSURED-ISSUE-AGE  CM-INSURED-JOINT-AGE
 10127                       CM-LF-BENEFIT-CD      CM-AH-BENEFIT-CD
 10128                       CM-LF-PREMIUM-AMT     CM-LF-REMAINING-AMT
 10129                       CM-LF-ITD-CANCEL-AMT  CM-LF-ITD-DEATH-AMT
 10130                       CM-LIVES              CM-LOAN-TERM
 10131                       CM-AH-ITD-AH-PMT      CM-AH-NSP-PREMIUM-AMT
 10132                       CM-AH-DEV-PCT         CM-AH-CRITICAL-PERIOD
 10133                       CM-LF-TERM-IN-DAYS    CM-LF-ALT-PREMIUM-AMT
 10134                       CM-LF-DEV-PCT         CM-LF-NSP-PREMIUM-AMT
 10135                       CM-LF-CRITICAL-PERIOD CM-LF-ALT-BENEFIT-AMT
 10136                       CM-LF-PREMIUM-RATE    CM-AH-PREMIUM-RATE
 10137                       CM-LF-ALT-PREMIUM-RATE
 10138                       CM-AH-ORIG-TERM       CM-AH-BENEFIT-AMT
 10139                       CM-AH-PREMIUM-AMT     CM-AH-ITD-CANCEL-AMT
 10140                       CM-AH-ITD-LUMP-PMT    CM-LOAN-APR
 10141                       CM-LOAN-BALANCE       CM-PAY-FREQUENCY
 10142                       CM-LIFE-COMM-PCT      CM-AH-COMM-PCT.
 10143
 10144     MOVE LOW-VALUES             TO CM-AH-LOAN-EXPIRE-DT
 10145                                    CM-AH-CANCEL-DT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 191
* EL130.cbl
 10146                                    CM-AH-SETTLEMENT-DT
 10147                                    CM-AH-CANCEL-EXIT-DT
 10148                                    CM-AH-SETTLEMENT-EXIT-DT
 10149                                    CM-LF-LOAN-EXPIRE-DT
 10150                                    CM-LF-CANCEL-DT
 10151                                    CM-LF-DEATH-DT
 10152                                    CM-LF-CANCEL-EXIT-DT
 10153                                    CM-LF-DEATH-EXIT-DT
 10154                                    CM-LAST-ADD-ON-DT
 10155                                    CM-ENTRY-DT.
 10156
 10157     MOVE '2'                    TO CM-CLAIM-INTERFACE-SW.
 10158     MOVE +1                     TO CM-CLAIM-ATTACHED-COUNT.
 10159     MOVE LOW-VALUES             TO CM-LAST-MONTH-END.
 10160
 10161     MOVE CRTLNMEI               TO CM-INSURED-LAST-NAME
 10162                                    CM-PART-LAST-NAME-A2
 10163                                    CM-PART-LAST-NAME-A5.
 10164
 10165     MOVE CRTFNMEI               TO CM-INSURED-INITIAL1
 10166                                    CM-INSURED-INITIAL1-A2
 10167                                    CM-INSURED-INITIAL1-A5
 10168                                    CM-INSURED-FIRST-NAME.
 10169
 10170     IF CRTINITL GREATER ZERO
 10171         MOVE CRTINITI           TO CM-INSURED-INITIAL2
 10172                                    CM-INSURED-INITIAL2-A2
 10173                                    CM-INSURED-INITIAL2-A5
 10174     ELSE
 10175         MOVE SPACES             TO CM-INSURED-INITIAL2
 10176                                    CM-INSURED-INITIAL2-A2
 10177                                    CM-INSURED-INITIAL2-A5
 10178     END-IF.
 10179
 10180     IF CM-INSURED-INITIALS = SPACES
 10181         MOVE '**'               TO CM-INSURED-INITIALS
 10182     END-IF.
 10183
 10184     IF MEMBERL GREATER ZERO
 10185         MOVE MEMBERI              TO CM-MEMBER-NO
 10186     ELSE
 10187         MOVE CERT-STATE           TO CM-MEMB-STATE
 10188         MOVE CERT-ACCOUNT-PRIME   TO CM-MEMB-ACCOUNT
 10189         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A5
 10190         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A5
 10191     END-IF.
 10192
 10193     IF JNTLNMEL GREATER ZERO
 10194         MOVE JNTLNMEI           TO CM-JT-LAST-NAME
 10195     END-IF.
 10196
 10197     IF JNTFNMEL GREATER ZERO
 10198         MOVE JNTFNMEI           TO CM-JT-FIRST-NAME
 10199     END-IF.
 10200
 10201     IF JNTINITL GREATER ZERO
 10202         MOVE JNTINITI           TO CM-JT-INITIAL
 10203     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 192
* EL130.cbl
 10204
 10205     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 10206
 10207
 10208
 10209* EXEC CICS HANDLE CONDITION
 10210*        DUPKEY   (3690-CERT-WRITTEN)
 10211*    END-EXEC.
 10212*    MOVE '"$$                   ! 9 #00009515' TO DFHEIV0
 10213     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10215     MOVE X'3920233030303039353135' TO DFHEIV0(25:11)
 10216     CALL 'kxdfhei1' USING DFHEIV0
 10217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10218
 10219
 10220
 10221
 10222* EXEC CICS WRITE
 10223*        DATASET   (ELCERT-DSID)
 10224*        FROM      (CERTIFICATE-MASTER)
 10225*        RIDFLD    (CM-CONTROL-PRIMARY)
 10226*    END-EXEC.
 10227     MOVE LENGTH OF
 10228      CERTIFICATE-MASTER
 10229       TO DFHEIV11
 10230*    MOVE '&$ L                  ''   #00009520' TO DFHEIV0
 10231     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10232     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10233     MOVE X'2020233030303039353230' TO DFHEIV0(25:11)
 10234     CALL 'kxdfhei1' USING DFHEIV0,
 10235           ELCERT-DSID,
 10236           CERTIFICATE-MASTER,
 10237           DFHEIV11,
 10238           CM-CONTROL-PRIMARY,
 10239           DFHEIV99,
 10240           DFHEIV99
 10241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10242
 10243
 10244 3690-CERT-WRITTEN.
 10245
 10246     GO TO 3800-BUILD-NEW-CLAIM.
 10247
 10248 3690-EXIT.
 10249      EXIT.
 10250
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 193
* EL130.cbl
 10252 3700-BUILD-CERT.
 10253
 10254     IF CERTMTI NOT = 'A'
 10255         GO TO 3700-FINISH-CERT-BUILD
 10256     END-IF.
 10257
 10258     IF CERTMTI = 'A'
 10259         IF LCVCDL = ZEROS
 10260             MOVE ZEROS          TO CM-LF-BENEFIT-CD
 10261                                    CM-LF-ORIG-TERM
 10262                                    CM-LF-BENEFIT-AMT
 10263                                    CM-LF-PREMIUM-RATE
 10264             GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10265         END-IF
 10266     END-IF.
 10267
 10268     IF LCVCDL GREATER ZERO
 10269         MOVE LCVCDI             TO CM-LF-BENEFIT-CD
 10270     END-IF.
 10271
 10272     IF LCVOTRML GREATER ZERO
 10273         MOVE LCVOTRMI           TO CM-LF-ORIG-TERM
 10274     END-IF.
 10275
 10276     IF LCVBENEL GREATER ZERO
 10277         MOVE WS-LCVBENE         TO CM-LF-BENEFIT-AMT
 10278     END-IF.
 10279
 10280     IF LCVRATEL GREATER ZERO
 10281         MOVE WS-LCVRATE         TO CM-LF-PREMIUM-RATE
 10282     END-IF.
 10283
 10284     IF WS-EXPIRE NOT = LOW-VALUES
 10285         MOVE WS-EXPIRE          TO CM-LF-LOAN-EXPIRE-DT
 10286     END-IF.
 10287
 10288     IF LCVFORML GREATER ZERO
 10289         MOVE LCVFORMI           TO CM-POLICY-FORM-NO
 10290     END-IF.
 10291
 10292     IF LCVCNDTL = ZERO
 10293        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10294     END-IF.
 10295
 10296     IF WS-LCVCNDT NOT = LOW-VALUES
 10297        MOVE '8'                 TO CM-LF-CURRENT-STATUS
 10298        MOVE WS-LCVCNDT          TO CM-LF-CANCEL-DT
 10299        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10300     END-IF.
 10301
 10302     IF CM-LF-CURRENT-STATUS = '7'
 10303        MOVE CM-LF-STATUS-AT-DEATH TO CM-LF-CURRENT-STATUS
 10304        MOVE SPACES              TO CM-LF-STATUS-AT-DEATH
 10305        MOVE LOW-VALUES          TO CM-LF-DEATH-EXIT-DT
 10306                                    CM-LF-DEATH-DT
 10307        GO TO 3700-BUILD-AH-COVERAGE-SIDE
 10308     END-IF.
 10309
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 194
* EL130.cbl
 10310     IF CM-LF-CURRENT-STATUS = '8'
 10311        MOVE '1'                 TO CM-LF-CURRENT-STATUS
 10312        MOVE LOW-VALUES          TO CM-LF-CANCEL-DT
 10313     END-IF.
 10314
 10315 3700-BUILD-AH-COVERAGE-SIDE.
 10316
 10317     IF CERTMTI = 'A'
 10318         IF ACVCDL = ZEROS
 10319             MOVE ZEROS          TO CM-AH-BENEFIT-CD
 10320                                    CM-AH-ORIG-TERM
 10321                                    CM-AH-BENEFIT-AMT
 10322                                    CM-AH-PREMIUM-RATE
 10323             GO TO 3700-COVERAGE-BUILT
 10324         END-IF
 10325     END-IF.
 10326
 10327     IF ACVCDL GREATER ZERO
 10328         MOVE ACVCDI             TO CM-AH-BENEFIT-CD
 10329     END-IF.
 10330
 10331     IF ACVOTRML GREATER ZERO
 10332         MOVE ACVOTRMI           TO CM-AH-ORIG-TERM
 10333     END-IF.
 10334
 10335     IF ACVBENEL GREATER ZERO
 10336         MOVE WS-ACVBENE         TO CM-AH-BENEFIT-AMT
 10337     END-IF.
 10338
 10339     IF ACVRATEL GREATER ZERO
 10340         MOVE WS-ACVRATE         TO CM-AH-PREMIUM-RATE
 10341     END-IF.
 10342
 10343     IF WS-EXPIRE NOT = LOW-VALUES
 10344         MOVE WS-EXPIRE          TO CM-AH-LOAN-EXPIRE-DT
 10345     END-IF.
 10346
 10347     IF ACVFORML GREATER ZERO
 10348         MOVE ACVFORMI           TO CM-POLICY-FORM-NO
 10349     END-IF.
 10350
 10351     IF ACVCNDTL = ZERO
 10352        GO TO 3700-COVERAGE-BUILT
 10353     END-IF.
 10354
 10355     IF WS-ACVCNDT NOT = LOW-VALUES
 10356        MOVE '8'                 TO CM-AH-CURRENT-STATUS
 10357        MOVE WS-ACVCNDT          TO CM-AH-CANCEL-DT
 10358        GO TO 3700-COVERAGE-BUILT
 10359     END-IF.
 10360
 10361     IF CM-AH-CURRENT-STATUS = '6'
 10362        MOVE CM-AH-STATUS-AT-SETTLEMENT TO CM-AH-CURRENT-STATUS
 10363        MOVE SPACES              TO CM-AH-STATUS-AT-SETTLEMENT
 10364        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-EXIT-DT
 10365        MOVE LOW-VALUES          TO CM-AH-SETTLEMENT-DT
 10366        GO TO 3700-COVERAGE-BUILT
 10367     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 195
* EL130.cbl
 10368
 10369     IF CM-AH-CURRENT-STATUS = '8'
 10370        MOVE '1'                 TO CM-AH-CURRENT-STATUS
 10371        MOVE LOW-VALUES          TO CM-AH-CANCEL-DT
 10372     END-IF.
 10373
 10374 3700-COVERAGE-BUILT.
 10375     IF ISSAGEL GREATER ZERO
 10376         MOVE ISSAGEI            TO CM-INSURED-ISSUE-AGE
 10377     END-IF.
 10378
 10379     IF JNTAGEL GREATER ZERO
 10380         MOVE JNTAGEI            TO CM-INSURED-JOINT-AGE
 10381     END-IF.
 10382
 10383     IF SEXL GREATER ZERO
 10384         MOVE SEXI               TO CM-INSURED-SEX
 10385     END-IF.
 10386
 10387     IF APRL GREATER ZERO
 10388         MOVE WS-APR             TO CM-LOAN-APR
 10389     END-IF.
 10390
 10391     IF PMTFREQL GREATER ZERO
 10392         MOVE WS-PMTFREQ         TO CM-PAY-FREQUENCY
 10393     END-IF.
 10394
 10395     IF INDGRPL GREATER ZERO
 10396         MOVE INDGRPI            TO CM-IND-GRP-TYPE
 10397     END-IF.
 10398
 10399     IF CERTMTI = 'A'
 10400         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10401     END-IF.
 10402
 10403     IF REINCDL GREATER ZERO
 10404         MOVE REINCDI            TO CM-SPECIAL-REIN-CODE
 10405                                    WS-REIN-1
 10406                                    WS-REIN-2
 10407                                    WS-REIN-3
 10408         MOVE WS-REIN-TABLE      TO CM-REIN-TABLE
 10409     END-IF.
 10410
 10411     IF WS-ADD-ON-DT NOT = LOW-VALUES
 10412         MOVE WS-ADD-ON-DT   TO CM-LAST-ADD-ON-DT
 10413     END-IF.
 10414
 10415     IF CRTSSNL GREATER ZERO
 10416         MOVE CRTSSNI            TO CM-SOC-SEC-NO
 10417     ELSE
 10418         IF SSNL GREATER ZERO
 10419             MOVE SSNI           TO CM-SOC-SEC-NO
 10420         END-IF
 10421     END-IF.
 10422
 10423     IF CRTSSNL = ZERO AND
 10424        SSNL    = ZERO
 10425         MOVE CM-STATE             TO CM-SSN-STATE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 196
* EL130.cbl
 10426         MOVE CM-ACCOUNT-PRIME     TO CM-SSN-ACCOUNT
 10427         MOVE CM-INSURED-INITIALS  TO CM-INSURED-INITIALS-A2
 10428         MOVE CM-INSURED-LAST-NAME TO CM-PART-LAST-NAME-A2
 10429     END-IF.
 10430
 10431     IF CM-LF-CURRENT-STATUS = SPACES
 10432         MOVE '1'                TO CM-LF-CURRENT-STATUS
 10433     END-IF.
 10434
 10435     IF CM-AH-CURRENT-STATUS = SPACES
 10436         MOVE '1'                TO CM-AH-CURRENT-STATUS
 10437     END-IF.
 10438
 10439     IF CERTMTI = 'A'
 10440         MOVE SAVE-BIN-DATE      TO CM-ENTRY-DT
 10441     END-IF.
 10442
 10443 3700-FINISH-CERT-BUILD.
 10444
 10445     IF LOANNOL GREATER ZERO
 10446         MOVE LOANNOI            TO CM-LOAN-NUMBER
 10447     END-IF.
 10448
 10449     IF LOANBALL GREATER ZERO
 10450         MOVE HOLD-LOAN-BAL      TO CM-LOAN-BALANCE
 10451     END-IF.
 10452
 10453     IF PREMTYPL GREATER ZERO
 10454         MOVE PREMTYPI           TO CM-PREMIUM-TYPE
 10455     END-IF.
 10456
 10457 3700-EXIT.
 10458      EXIT.
 10459
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 197
* EL130.cbl
 10461 3800-BUILD-NEW-CLAIM.
 10462
 10463*************************************************************
 10464*****           START OF ACTIVITY FILE PROCESSING          **
 10465*************************************************************
 10466     IF PI-COMPANY-ID EQUAL 'CID' OR 'AHL'
 10467         PERFORM 6700-OUTPUT-ACTIVITY-RECORD THRU
 10468                 6700-EXIT
 10469     END-IF.
 10470*************************************************************
 10471*****            END OF ACTIVITY FILE PROCESSING           **
 10472*************************************************************
 10473
 10474
 10475
 10476
 10477* EXEC CICS GETMAIN
 10478*        SET     (ADDRESS OF CLAIM-MASTER)
 10479*        LENGTH  (ELMSTR-LENGTH)
 10480*    END-EXEC.
 10481*    MOVE '," L                  $   #00009758' TO DFHEIV0
 10482     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10483     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10484     MOVE X'2020233030303039373538' TO DFHEIV0(25:11)
 10485     CALL 'kxdfhei1' USING DFHEIV0,
 10486           DFHEIV20,
 10487           ELMSTR-LENGTH,
 10488           DFHEIV99
 10489     SET ADDRESS OF CLAIM-MASTER TO
 10490         DFHEIV20
 10491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10492
 10493
 10494     MOVE SPACES TO CLAIM-MASTER.
 10495
 10496     MOVE LOW-VALUES   TO       CL-INSURED-BIRTH-DT CL-INCURRED-DT
 10497         CL-NEXT-FOLLOWUP-DT    CL-REPORTED-DT      CL-LAST-PMT-DT
 10498         CL-EST-END-OF-DISAB-DT CL-PAID-THRU-DT   CL-LAST-CLOSE-DT
 10499         CL-LAST-REOPEN-DT      CL-PURGED-DT        CL-RESTORED-DT
 10500         CL-NEXT-AUTO-PAY-DT    CL-NEXT-RESEND-DT
 10501         CL-LAST-ADD-ON-DT      CL-FILE-ESTABLISH-DT
 10502         CL-LAST-MAINT-DT       CL-HISTORY-ARCHIVE-DT
 10503         CL-ACTIVITY-MAINT-DT   cl-benefit-expiration-dt
 10504
 10505     MOVE +0 TO CL-LAST-PMT-AMT      CL-TOTAL-PAID-AMT
 10506             CL-NO-OF-PMTS-MADE      CL-NO-OF-DAYS-PAID
 10507             CL-LAST-INC-DT-CHANGE   CL-AUTO-PAY-SEQ
 10508             CL-INSURED-ADDR-CNT     CL-ACCOUNT-ADDR-CNT
 10509             CL-BENIF-ADDR-CNT       CL-EMPLOYER-ADDR-CNT
 10510             CL-DOCTOR-ADDR-CNT      CL-OTHER-1-ADDR-CNT
 10511             CL-OTHER-2-ADDR-CNT     CL-FATAL-ERROR-CNT
 10512             CL-CLAIM-PAYMENT-STATUS CL-LAST-MAINT-HHMMSS
 10513             CL-FORCEABLE-ERROR-CNT.
 10514
 10515     MOVE WS-INSURED-ADDR-CNT    TO CL-INSURED-ADDR-CNT.
 10516
 10517     MOVE ZEROS                  TO CL-ACTIVITY-CODE
 10518                                    CL-LAPSE-REPORT-CODE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 198
* EL130.cbl
 10519                                    CL-LAG-REPORT-CODE
 10520                                    CL-CRITICAL-PERIOD
 10521*                                   CL-CRIT-PER-RTW-MOS
 10522     move 01                     to cl-benefit-period
 10523
 10524     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 10525     MOVE +4095                  TO CL-TRAILER-SEQ-CNT.
 10526
 10527     IF BENECDL NOT = ZEROS
 10528        MOVE BENECDI             TO CL-BENEFICIARY
 10529     END-IF.
 10530
 10531     MOVE 'CL'                   TO CL-RECORD-ID.
 10532     MOVE 'CR'                   TO CL-SYSTEM-IDENTIFIER.
 10533
 10534     MOVE PI-COMPANY-CD  TO  CL-COMPANY-CD     CL-COMPANY-CD-A1
 10535                             CL-COMPANY-CD-A2  CL-COMPANY-CD-A4
 10536                             CL-COMPANY-CD-A5.
 10537
 10538     MOVE CLMCARRI               TO CL-CARRIER.
 10539
 10540     IF CLMNOL = ZERO
 10541         MOVE WS-CLAIM-NUMBER    TO CL-CLAIM-NO
 10542     ELSE
 10543         MOVE CLMNOI             TO CL-CLAIM-NO
 10544     END-IF.
 10545
 10546     MOVE CERTNOI                TO CL-CERT-PRIME
 10547                                    CL-CERT-A4-PRIME.
 10548
 10549     MOVE SUFXI                  TO CL-CERT-SFX
 10550                                    CL-CERT-A4-SFX.
 10551
 10552     MOVE PCERTNOI               TO CL-PRIME-CERT-PRIME.
 10553
 10554     MOVE PSUFXI                 TO CL-PRIME-CERT-SFX.
 10555
 10556     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 10557
 10558     MOVE LSTNMEI                TO CL-INSURED-LAST-NAME.
 10559
 10560     MOVE WS-TODAY-DT            TO CL-FILE-ESTABLISH-DT.
 10561     MOVE ' '                    TO CL-LAST-MAINT-TYPE.
 10562
 10563     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 10564
 10565     IF CERTMTI = 'A'
 10566         MOVE '2'                TO CL-CERT-ORIGIN
 10567     ELSE
 10568         MOVE '1'                TO CL-CERT-ORIGIN
 10569     END-IF.
 10570
 10571     MOVE CERT-CARRIER        TO CL-CERT-CARRIER   PI-CARRIER.
 10572     MOVE CERT-GROUPING       TO CL-CERT-GROUPING  PI-GROUPING.
 10573     MOVE CERT-STATE          TO CL-CERT-STATE     PI-STATE.
 10574     MOVE CERT-ACCOUNT        TO CL-CERT-ACCOUNT   PI-ACCOUNT.
 10575     MOVE WS-EFFDT            TO CL-CERT-EFF-DT    PI-CERT-EFF-DT.
 10576
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 199
* EL130.cbl
 10577 3820-REWRITE-CONTROL-FILE.
 10578
 10579     IF CLMNOL GREATER ZERO
 10580         GO TO 3830-SEQUENCE-CLAIM-RECORDS
 10581     END-IF.
 10582
 10583     IF CF-RECORD-TYPE = '6'
 10584         MOVE SAVE-COUNTER    TO  CF-CLAIM-COUNTER
 10585     ELSE
 10586         MOVE SAVE-COUNTER    TO  CF-CO-CLAIM-COUNTER
 10587     END-IF.
 10588
 10589
 10590
 10591* EXEC CICS REWRITE
 10592*        DATASET   (ELCNTL-DSID)
 10593*        FROM      (CONTROL-FILE)
 10594*    END-EXEC.
 10595     MOVE LENGTH OF
 10596      CONTROL-FILE
 10597       TO DFHEIV11
 10598*    MOVE '&& L                  %   #00009859' TO DFHEIV0
 10599     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 10600     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10601     MOVE X'2020233030303039383539' TO DFHEIV0(25:11)
 10602     CALL 'kxdfhei1' USING DFHEIV0,
 10603           ELCNTL-DSID,
 10604           CONTROL-FILE,
 10605           DFHEIV11,
 10606           DFHEIV99
 10607     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10608
 10609
 10610 3830-SEQUENCE-CLAIM-RECORDS.
 10611
 10612     MOVE CLAIM-MASTER           TO WS-SAVE-CLAIM-MASTER.
 10613     MOVE CL-CONTROL-PRIMARY     TO ELMSTR-KEY.
 10614     PERFORM 7700-CHECK-SEQUENCE THRU 7799-EXIT.
 10615
 10616     IF WS-ASSOC-CERT-TOTAL = ZERO
 10617         MOVE 1                  TO CL-ASSOC-CERT-SEQU
 10618                                    CL-ASSOC-CERT-TOTAL
 10619         GO TO 3840-WRITE-CLAIM-MASTER
 10620     END-IF.
 10621
 10622     IF CL-CONTROL-PRIMARY LESS THAN WS-SAVE-CLAIM-KEY
 10623         MOVE CL-CONTROL-PRIMARY TO ELMSTR-KEY
 10624     ELSE
 10625         MOVE WS-SAVE-CLAIM-KEY  TO ELMSTR-KEY
 10626     END-IF.
 10627
 10628     MOVE WS-SAVE-CLAIM-MASTER   TO CLAIM-MASTER.
 10629     MOVE ZERO                   TO CL-ASSOC-CERT-SEQU.
 10630     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 10631
 10632 3840-WRITE-CLAIM-MASTER.
 10633
 10634     PERFORM 6600-CHECK-AUTO-ACTIVITY THRU 6600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 200
* EL130.cbl
 10635     IF WS-REC-FOUND-SW = 'Y'
 10636         MOVE 01                 TO  CL-ACTIVITY-CODE
 10637         MOVE SAVE-BIN-DATE      TO  CL-ACTIVITY-MAINT-DT
 10638         MOVE 'ADD '             TO  CL-ACTIVITY-MAINT-TYPE
 10639     END-IF.
 10640
 10641
 10642
 10643* EXEC CICS HANDLE CONDITION
 10644*         DUPKEY    (3850-CLAIM-MSTR-WRITTEN)
 10645*    END-EXEC.
 10646*    MOVE '"$$                   ! : #00009896' TO DFHEIV0
 10647     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 10648     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10649     MOVE X'3A20233030303039383936' TO DFHEIV0(25:11)
 10650     CALL 'kxdfhei1' USING DFHEIV0
 10651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10652
 10653
 10654** POPULATE THE CREDIT-CARD NO WITH THE CERT NO.
 10655     MOVE CL-CERT-NO             TO CL-CCN-A5.
 10656
 10657
 10658*       CL-CERT-NO
 10659*    IF CL-COMPANY-CD = X'04'
 10660*    ELSE
 10661*       IF CL-COMPANY-CD = X'05'
 10662*       ELSE
 10663*       END-IF
 10664*    END-IF
 10665
 10666* EXEC CICS WRITE
 10667*        DATASET   (ELMSTR-DSID)
 10668*        FROM      (CLAIM-MASTER)
 10669*        RIDFLD    (CL-CONTROL-PRIMARY)
 10670*    END-EXEC.
 10671     MOVE LENGTH OF
 10672      CLAIM-MASTER
 10673       TO DFHEIV11
 10674*    MOVE '&$ L                  ''   #00009916' TO DFHEIV0
 10675     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10676     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10677     MOVE X'2020233030303039393136' TO DFHEIV0(25:11)
 10678     CALL 'kxdfhei1' USING DFHEIV0,
 10679           ELMSTR-DSID,
 10680           CLAIM-MASTER,
 10681           DFHEIV11,
 10682           CL-CONTROL-PRIMARY,
 10683           DFHEIV99,
 10684           DFHEIV99
 10685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10686
 10687
 10688 3850-CLAIM-MSTR-WRITTEN.
 10689
 10690     IF WS-ASSOC-CERT-TOTAL NOT = ZERO
 10691         PERFORM 7710-RESEQUENCE-CLAIMS THRU 7799-EXIT
 10692     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 201
* EL130.cbl
 10693
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 202
* EL130.cbl
 10695 3990-ADD-DONE.
 10696*    MOVE 1                     TO EMI-SWITCH1  EMI-SWITCH-AREA-1
 10697*                                  EMI-SUB      EMI-SWITCH-AREA-2.
 10698*    MOVE SPACES                TO EMI-ACTION-SWITCH
 10699*                                  EMI-ERROR-LINES.
 10700
 10701     IF CLMNOL = ZERO
 10702         move spaces             to emi-claim-no
 10703         MOVE ER-0265            TO EMI-ERROR
 10704         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10705         MOVE WS-CLAIM-NUMBER    TO EMI-TEXT-VARIABLE (EMI-SUB)
 10706                                    PI-LAST-CLAIM
 10707     ELSE
 10708         MOVE CLMNOI             TO PI-LAST-CLAIM
 10709                                    MSTR-CLAIM-NO
 10710         MOVE ER-0000            TO EMI-ERROR
 10711         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10712     END-IF.
 10713
 10714     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 10715       AND (PI-ST-VFY-2ND-BENE = 'L' OR 'B')
 10716         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10717         MOVE ER-7575            TO EMI-ERROR
 10718         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10719     END-IF.
 10720
 10721     IF CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 10722       AND (PI-ST-VFY-2ND-BENE = 'A' OR 'B')
 10723         PERFORM 3994-BUILD-NINETY-THREE-TRAILER THRU 3994-EXIT
 10724         MOVE ER-7582            TO EMI-ERROR
 10725         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10726     END-IF.
 10727
 10728     IF PI-STATE = 'VA' OR 'PA' OR 'GA'
 10729        PERFORM 3991-CHECK-2-YEAR-CONTESTABLE THRU 3991-EXIT
 10730     END-IF.
 10731     IF WS-NO-INSURED-ADDRESS = 'Y'
 10732         MOVE ER-3548            TO EMI-ERROR
 10733         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10734     END-IF.
 10735
 10736     IF PI-ST-CAUSAL-STATE = 'B'  OR
 10737       (PI-ST-CAUSAL-STATE = 'L' AND
 10738              CLMTYPEI = PI-LIFE-OVERRIDE-L1)   OR
 10739       (PI-ST-CAUSAL-STATE = 'A' AND
 10740              CLMTYPEI = PI-AH-OVERRIDE-L1)
 10741         PERFORM 3994B-BUILD-NINETY-FOUR-TRAILER THRU 3994B-EXIT
 10742         MOVE ER-7577            TO EMI-ERROR
 10743         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10744     END-IF.
 10745     if pi-company-id = 'DCC' OR 'VPP'
 10746        PERFORM 3994C-BUILD-NINETY-FIVE-TRAILER
 10747                                 THRU 3994C-EXIT
 10748     end-if
 10749     MOVE CLMNOI                     TO  PI-CLAIM-NO.
 10750     MOVE CLMCARRI                   TO  PI-CARRIER.
 10751     MOVE CERTNOI                    TO  PI-CERT-PRIME.
 10752     MOVE SUFXI                      TO  PI-CERT-SFX.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 203
* EL130.cbl
 10753
 10754     IF WS-LETTER-SW = 'Y'
 10755         PERFORM 6600-START-AUTO-LETTER-WRITER THRU 6600-EXIT
 10756         IF W-1523-ERROR-CODE NOT = ZEROS
 10757             MOVE W-1523-ERROR-CODE  TO  EMI-ERROR
 10758             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10759         END-IF
 10760     END-IF.
 10761
 10762     perform 3998-update-cert-claim-trailer
 10763                                 thru 3998-exit
 10764     MOVE CLMTYPEI               TO PI-LAST-CLAIM-TYPE.
 10765     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 10766     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 10767     MOVE CLMCARRI               TO PI-LAST-CARR.
 10768
 10769     IF PRTOPTL GREATER THAN 0
 10770         MOVE PRTOPTI            TO PI-PRT-OPT
 10771     END-IF.
 10772     IF ALTPRTL GREATER THAN 0
 10773         MOVE ALTPRTI            TO PI-ALT-PRT
 10774     END-IF.
 10775
 10776     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10777         MOVE LOW-VALUES         TO EL130AI
 10778         MOVE PI-LAST-CERT-PRIME TO CERTNOO
 10779         MOVE AL-SANON           TO CERTNOA
 10780         MOVE PI-LAST-CERT-SUFX  TO SUFXO
 10781         MOVE AL-SANON           TO SUFXA
 10782         MOVE PI-LAST-CARR       TO CLMCARRO
 10783         MOVE AL-UANON           TO CLMCARRA
 10784         MOVE PI-LAST-CLAIM      TO CLMNOO
 10785         MOVE AL-UANON           TO CLMNOA
 10786         MOVE PI-LAST-CLAIM-TYPE TO CLMTYPEO
 10787         MOVE AL-UANON           TO CLMTYPEA
 10788     ELSE
 10789         PERFORM 0690-HIGHLIGHT-CERTS THRU 0690-EXIT
 10790         PERFORM 3993-MODIFY-CLAIM-ATTRB THRU 3993-EXIT
 10791     END-IF.
 10792
 10793     IF PI-PRT-OPT = 'N' OR 'L'
 10794         MOVE PI-PRT-OPT         TO PRTOPTO
 10795         MOVE 1                  TO PRTOPTL
 10796     END-IF.
 10797
 10798     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 10799         MOVE PI-ALT-PRT         TO ALTPRTO
 10800         MOVE 4                  TO ALTPRTL
 10801     END-IF.
 10802
 10803     IF PRTOPTL GREATER THAN 0
 10804         IF PRTOPTI = 'L'
 10805             GO TO 0400-CREATE-ELACTQ
 10806         ELSE
 10807             GO TO 0480-PRINT-NOW
 10808         END-IF
 10809     END-IF.
 10810     move 'S'                    to mainti
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 204
* EL130.cbl
 10811     PERFORM 0500-CREATE-TEMP-STORAGE
 10812                                 THRU 0599-EXIT
 10813     IF PI-CERT-PROCESSED NOT LESS THAN PI-CERT-SELECT-CNT
 10814         GO TO 8100-SEND-INITIAL-MAP
 10815     ELSE
 10816         MOVE LOW-VALUES         TO MAINTO
 10817         MOVE -1                 TO MAINTL
 10818         GO TO 8200-SEND-DATAONLY
 10819     END-IF.
 10820
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 205
* EL130.cbl
 10822 3991-CHECK-2-YEAR-CONTESTABLE.
 10823     SET ELAPSED-BETWEEN-BIN TO TRUE
 10824     MOVE ZERO               TO DC-ELAPSED-MONTHS
 10825                                DC-ELAPSED-DAYS
 10826
 10827     MOVE PI-SAVE-EFFDT  TO DC-BIN-DATE-1.
 10828     MOVE CL-INCURRED-DT TO DC-BIN-DATE-2.
 10829     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10830     IF DC-ODD-DAYS-OVER > ZERO
 10831        ADD 1 TO DC-ELAPSED-MONTHS
 10832     END-IF
 10833
 10834     IF DC-ELAPSED-MONTHS <= 24
 10835        MOVE CL-REPORTED-DT TO DC-BIN-DATE-2
 10836        MOVE ZERO           TO DC-ELAPSED-MONTHS
 10837                               DC-ELAPSED-DAYS
 10838        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10839        IF DC-ODD-DAYS-OVER > ZERO
 10840           ADD 1 TO DC-ELAPSED-MONTHS
 10841        END-IF
 10842        IF DC-ELAPSED-MONTHS > 24
 10843           MOVE ER-1679            TO EMI-ERROR
 10844           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10845           PERFORM 3992-BUILD-TRAILER THRU 3992-EXIT
 10846        END-IF
 10847     END-IF.
 10848
 10849 3991-EXIT.
 10850     EXIT.
 10851 3992-BUILD-TRAILER.
 10852
 10853     MOVE SPACES             TO AT-GENERAL-INFO-TR
 10854     INITIALIZE AT-GENERAL-INFO-TR
 10855     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 10856     MOVE 'AT'               TO AT-RECORD-ID
 10857     MOVE +96                TO AT-SEQUENCE-NO
 10858     MOVE '6'                TO AT-TRAILER-TYPE
 10859     MOVE WS-TODAY-DT        TO AT-RECORDED-DT
 10860                                AT-GEN-INFO-LAST-MAINT-DT
 10861     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 10862                                AT-GEN-INFO-LAST-UPDATED-BY
 10863     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 10864
 10865     MOVE EMI-LINE2 TO AT-INFO-LINE-1
 10866     MOVE SPACES             TO AT-INFO-LINE-2.
 10867
 10868 3992-WRITE.
 10869
 10870
 10871* EXEC CICS HANDLE CONDITION
 10872*        DUPREC    (3992-DUPREC)
 10873*    END-EXEC.
 10874*    MOVE '"$%                   ! ; #00010104' TO DFHEIV0
 10875     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10876     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10877     MOVE X'3B20233030303130313034' TO DFHEIV0(25:11)
 10878     CALL 'kxdfhei1' USING DFHEIV0
 10879     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 206
* EL130.cbl
 10880
 10881
 10882
 10883* EXEC CICS WRITE
 10884*         DATASET     ('ELTRLR')
 10885*         FROM        (ACTIVITY-TRAILERS)
 10886*         RIDFLD      (AT-CONTROL-PRIMARY)
 10887*     END-EXEC.
 10888     MOVE LENGTH OF
 10889      ACTIVITY-TRAILERS
 10890       TO DFHEIV11
 10891     MOVE 'ELTRLR' TO DFHEIV1
 10892*    MOVE '&$ L                  ''   #00010108' TO DFHEIV0
 10893     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10894     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10895     MOVE X'2020233030303130313038' TO DFHEIV0(25:11)
 10896     CALL 'kxdfhei1' USING DFHEIV0,
 10897           DFHEIV1,
 10898           ACTIVITY-TRAILERS,
 10899           DFHEIV11,
 10900           AT-CONTROL-PRIMARY,
 10901           DFHEIV99,
 10902           DFHEIV99
 10903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10904
 10905
 10906     GO TO 3992-EXIT.
 10907
 10908 3992-DUPREC.
 10909     SUBTRACT +1 FROM AT-SEQUENCE-NO.
 10910     GO TO 3992-WRITE.
 10911
 10912 3992-EXIT.
 10913     EXIT.
 10914 3993-MODIFY-SCREEN-ATTRB.
 10915
 10916     IF CERTMTL GREATER ZERO
 10917         MOVE AL-UANON           TO CERTMTA
 10918     END-IF.
 10919
 10920     IF EFFDTL GREATER ZERO
 10921         MOVE AL-UANON           TO EFFDTA
 10922     END-IF.
 10923
 10924     IF ACCOUNTL GREATER ZERO
 10925         MOVE AL-UANON           TO ACCOUNTA
 10926     END-IF.
 10927
 10928     IF STATEL GREATER ZERO
 10929         MOVE AL-UANON           TO STATEA
 10930     END-IF.
 10931
 10932     IF CRTCARRL GREATER ZERO
 10933         MOVE AL-UANON           TO CRTCARRA
 10934     END-IF.
 10935
 10936     IF GROUPL GREATER ZERO
 10937         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 207
* EL130.cbl
 10938     END-IF.
 10939
 10940     IF CRTLNMEL GREATER ZERO
 10941         MOVE AL-UANON           TO CRTLNMEA
 10942     END-IF.
 10943
 10944     IF CRTFNMEL GREATER ZERO
 10945         MOVE AL-UANON           TO CRTFNMEA
 10946     END-IF.
 10947
 10948     IF CRTINITL GREATER ZERO
 10949         MOVE AL-UANON           TO CRTINITA
 10950     END-IF.
 10951
 10952     IF ISSAGEL GREATER ZERO
 10953         MOVE AL-UNNON           TO ISSAGEA
 10954     END-IF.
 10955
 10956     IF JNTLNMEL GREATER ZERO
 10957         MOVE AL-UANON           TO JNTLNMEA
 10958     END-IF.
 10959
 10960     IF JNTFNMEL GREATER ZERO
 10961         MOVE AL-UANON           TO JNTFNMEA
 10962     END-IF.
 10963
 10964     IF JNTINITL GREATER ZERO
 10965         MOVE AL-UANON           TO JNTINITA
 10966     END-IF.
 10967
 10968     IF JNTAGEL GREATER ZERO
 10969         MOVE AL-UNNON           TO JNTAGEA
 10970     END-IF.
 10971
 10972     IF CRTSSNL GREATER ZERO
 10973         MOVE AL-UANON           TO CRTSSNA
 10974     END-IF.
 10975
 10976     IF ACVDSCRL GREATER ZERO
 10977         MOVE AL-SANON           TO ACVDSCRA
 10978     END-IF.
 10979
 10980     IF ACVKINDL GREATER ZERO
 10981         MOVE AL-SANON           TO ACVKINDA
 10982     END-IF.
 10983
 10984     IF ACVCDL GREATER ZERO
 10985         MOVE AL-UANON           TO ACVCDA
 10986     END-IF.
 10987
 10988     IF ACVOTRML GREATER ZERO
 10989         MOVE AL-UNNON           TO ACVOTRMA
 10990     END-IF.
 10991
 10992     IF ACVRTRML GREATER ZERO
 10993         MOVE AL-UNNON           TO ACVRTRMA
 10994     END-IF.
 10995
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 208
* EL130.cbl
 10996     IF ACVRATEL GREATER ZERO
 10997         MOVE AL-UNNON           TO ACVRATEA
 10998     END-IF.
 10999
 11000     IF ACVBENEL GREATER ZERO
 11001         MOVE AL-UNNON           TO ACVBENEA
 11002     END-IF.
 11003
 11004     IF ACVFORML GREATER ZERO
 11005         MOVE AL-UANON           TO ACVFORMA
 11006     END-IF.
 11007
 11008     IF ACVCNDTL GREATER ZERO
 11009         MOVE AL-UANON           TO ACVCNDTA
 11010     END-IF.
 11011
 11012     IF ACVEXITL GREATER ZERO
 11013         MOVE AL-UANON           TO ACVEXITA
 11014     END-IF.
 11015
 11016     IF ACVSTATL GREATER ZERO
 11017         MOVE AL-UANON           TO ACVSTATA
 11018     END-IF.
 11019
 11020     IF LCVDSCRL GREATER ZERO
 11021         MOVE AL-SANON           TO LCVDSCRA
 11022     END-IF.
 11023
 11024     IF LCVKINDL GREATER ZERO
 11025         MOVE AL-SANON           TO LCVKINDA
 11026     END-IF.
 11027
 11028     IF LCVCDL GREATER ZERO
 11029         MOVE AL-UANON           TO LCVCDA
 11030     END-IF.
 11031
 11032     IF LCVOTRML GREATER ZERO
 11033         MOVE AL-UNNON           TO LCVOTRMA
 11034     END-IF.
 11035
 11036     IF LCVRTRML GREATER ZERO
 11037         MOVE AL-UNNON           TO LCVRTRMA
 11038     END-IF.
 11039
 11040     IF LCVRATEL GREATER ZERO
 11041         MOVE AL-UNNON           TO LCVRATEA
 11042     END-IF.
 11043
 11044     IF LCVBENEL GREATER ZERO
 11045         MOVE AL-UNNON           TO LCVBENEA
 11046     END-IF.
 11047
 11048     IF LCVFORML GREATER ZERO
 11049         MOVE AL-UANON           TO LCVFORMA
 11050     END-IF.
 11051
 11052     IF LCVCNDTL GREATER ZERO
 11053         MOVE AL-UANON           TO LCVCNDTA
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 209
* EL130.cbl
 11054     END-IF.
 11055
 11056     IF LCVEXITL GREATER ZERO
 11057         MOVE AL-UANON           TO LCVEXITA
 11058     END-IF.
 11059
 11060     IF LCVSTATL GREATER ZERO
 11061         MOVE AL-UANON           TO LCVSTATA
 11062     END-IF.
 11063
 11064     IF MEMCAPL GREATER ZERO
 11065         MOVE AL-UANON           TO MEMCAPA
 11066     END-IF.
 11067
 11068     IF APRL GREATER ZERO
 11069         MOVE AL-UNNON           TO APRA
 11070     END-IF.
 11071
 11072     IF PMTFREQL GREATER ZERO
 11073         MOVE AL-UNNON           TO PMTFREQA
 11074     END-IF.
 11075
 11076     IF INDGRPL GREATER ZERO
 11077         MOVE AL-UANON           TO INDGRPA
 11078     END-IF.
 11079
 11080     IF PREMTYPL GREATER ZERO
 11081         MOVE AL-UANON           TO PREMTYPA
 11082     END-IF.
 11083
 11084     IF REINCDL GREATER ZERO
 11085         MOVE AL-UANON           TO REINCDA
 11086     END-IF.
 11087
 11088     IF ADDONDTL GREATER ZERO
 11089         MOVE AL-UANON           TO ADDONDTA
 11090     END-IF.
 11091
 11092     IF MEMBERL GREATER ZERO
 11093         MOVE AL-UANON           TO MEMBERA
 11094     END-IF.
 11095
 11096     IF BCERT1L GREATER ZERO
 11097         MOVE AL-SANON           TO BCERT1A
 11098                                    BSUFX1A
 11099     END-IF.
 11100
 11101     IF BCERT2L GREATER ZERO
 11102         MOVE AL-SANON           TO BCERT2A
 11103                                    BSUFX2A
 11104     END-IF.
 11105
 11106     IF BCERT3L GREATER ZERO
 11107         MOVE AL-SANON           TO BCERT3A
 11108                                    BSUFX3A
 11109     END-IF.
 11110
 11111     IF BCERT4L GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 210
* EL130.cbl
 11112         MOVE AL-SANON           TO BCERT4A
 11113                                    BSUFX4A
 11114     END-IF.
 11115
 11116     IF BCERT5L GREATER ZERO
 11117         MOVE AL-SANON           TO BCERT5A
 11118                                    BSUFX5A
 11119     END-IF.
 11120
 11121 3993-MODIFY-CLAIM-ATTRB.
 11122
 11123     IF PCERTNOL GREATER ZERO
 11124         MOVE AL-UANON           TO PCERTNOA
 11125     END-IF.
 11126
 11127     IF PSUFXL GREATER ZERO
 11128         MOVE AL-UANON           TO PSUFXA
 11129     END-IF.
 11130
 11131     IF LSTNMEL GREATER ZERO
 11132         MOVE AL-UANON           TO LSTNMEA
 11133     END-IF.
 11134
 11135     IF FSTNMEL GREATER ZERO
 11136         MOVE AL-UANON           TO FSTNMEA
 11137     END-IF.
 11138
 11139     IF INITL GREATER ZERO
 11140         MOVE AL-UANON           TO INITA
 11141     END-IF.
 11142
 11143     IF SEXL GREATER ZERO
 11144         MOVE AL-UANON           TO SEXA
 11145     END-IF.
 11146
 11147     IF BIRTHDTL GREATER ZERO
 11148         MOVE AL-UANON           TO BIRTHDTA
 11149     END-IF.
 11150
 11151     IF SSNL GREATER ZERO
 11152         MOVE AL-UANON           TO SSNA
 11153     END-IF.
 11154
 11155     IF INCURL GREATER ZERO
 11156         MOVE AL-UANON           TO INCURA
 11157     END-IF.
 11158
 11159     IF REPORTL GREATER ZERO
 11160         MOVE AL-UANON           TO REPORTA
 11161     END-IF.
 11162
 11163*    IF ESTENDL GREATER ZERO
 11164*        MOVE AL-UANON           TO ESTENDA
 11165*    END-IF.
 11166
 11167     IF DIAGL GREATER ZERO
 11168         MOVE AL-UANON           TO DIAGA
 11169     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 211
* EL130.cbl
 11170*
 11171     IF ICD1L GREATER ZERO
 11172         MOVE AL-UANON           TO ICD1A
 11173     END-IF.
 11174
 11175     IF ICD2L GREATER ZERO
 11176         MOVE AL-UANON           TO ICD2A
 11177     END-IF.
 11178
 11179*    IF CAUSEL GREATER ZERO
 11180*        MOVE AL-UANON           TO CAUSEA
 11181*    END-IF.
 11182
 11183     IF MANRSVL GREATER ZERO
 11184         MOVE AL-UNNON           TO MANRSVA
 11185     END-IF.
 11186
 11187     IF RELCLML GREATER ZERO
 11188         MOVE AL-UANON           TO RELCLMA
 11189     END-IF.
 11190
 11191     IF LOANNOL GREATER ZERO
 11192         MOVE AL-UANON           TO LOANNOA
 11193     END-IF.
 11194
 11195     IF LOANBALL GREATER ZERO
 11196         MOVE AL-UNNON           TO LOANBALA
 11197     END-IF.
 11198
 11199     IF PROCCDL GREATER ZERO
 11200         MOVE AL-UANON           TO PROCCDA
 11201     END-IF.
 11202
 11203     IF BENECDL GREATER THAN ZERO
 11204         MOVE AL-UANON           TO  BENECDA
 11205     END-IF.
 11206
 11207     IF PRICDL GREATER ZERO
 11208         MOVE AL-UANON           TO PRICDA
 11209     END-IF.
 11210
 11211     IF SUPVL GREATER ZERO
 11212         MOVE AL-UANON           TO SUPVA
 11213     END-IF.
 11214
 11215     IF FILETOL GREATER ZERO
 11216         MOVE AL-UANON           TO FILETOA
 11217     END-IF.
 11218
 11219
 11220 3993-MODIFY-CLAIM-KEY-ATTRB.
 11221
 11222     IF CLMNOL GREATER ZERO
 11223         MOVE AL-UANON           TO CLMNOA
 11224     END-IF.
 11225
 11226     IF CLMCARRL GREATER ZERO
 11227         MOVE AL-UANON           TO CLMCARRA
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 212
* EL130.cbl
 11228     END-IF.
 11229
 11230     IF CLMTYPEL GREATER ZERO
 11231         MOVE AL-UANON           TO CLMTYPEA
 11232     END-IF.
 11233
 11234     IF CERTNOL GREATER ZERO
 11235         MOVE AL-SANON           TO CERTNOA
 11236     END-IF.
 11237
 11238     IF SUFXL GREATER ZERO
 11239         MOVE AL-SANON           TO SUFXA
 11240     END-IF.
 11241
 11242 3993-EXIT.
 11243     EXIT.
 11244
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 213
* EL130.cbl
 11246 3994-BUILD-NINETY-THREE-TRAILER.
 11247
 11248     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11249     MOVE 'AT'                   TO AT-RECORD-ID.
 11250
 11251     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11252     MOVE CLMCARRI               TO AT-CARRIER.
 11253
 11254     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11255     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11256     MOVE +93                    TO AT-SEQUENCE-NO.
 11257     MOVE '6'                    TO AT-TRAILER-TYPE.
 11258     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11259
 11260     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 11261         MOVE WS-VERIFY-NOTE     TO AT-INFO-LINE-1
 11262     ELSE
 11263         MOVE WS-VFY-SSN-NOTE    TO AT-INFO-LINE-1
 11264     END-IF
 11265
 11266     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11267                                    AT-GEN-INFO-LAST-MAINT-DT.
 11268
 11269     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11270                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11271     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11272
 11273
 11274
 11275* EXEC CICS WRITE
 11276*        DATASET   (ELTRLR-DSID)
 11277*        FROM      (ACTIVITY-TRAILERS)
 11278*        RIDFLD    (AT-CONTROL-PRIMARY)
 11279*    END-EXEC.
 11280     MOVE LENGTH OF
 11281      ACTIVITY-TRAILERS
 11282       TO DFHEIV11
 11283*    MOVE '&$ L                  ''   #00010482' TO DFHEIV0
 11284     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11285     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11286     MOVE X'2020233030303130343832' TO DFHEIV0(25:11)
 11287     CALL 'kxdfhei1' USING DFHEIV0,
 11288           ELTRLR-DSID,
 11289           ACTIVITY-TRAILERS,
 11290           DFHEIV11,
 11291           AT-CONTROL-PRIMARY,
 11292           DFHEIV99,
 11293           DFHEIV99
 11294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11295
 11296
 11297 3994-EXIT.
 11298     EXIT.
 11299
 11300 3994B-BUILD-NINETY-FOUR-TRAILER.
 11301
 11302     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 11303     MOVE 'AT'                   TO AT-RECORD-ID.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 214
* EL130.cbl
 11304
 11305     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 11306     MOVE CLMCARRI               TO AT-CARRIER.
 11307
 11308     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 11309     MOVE CERT-CERT-NO           TO AT-CERT-NO.
 11310     MOVE +94                    TO AT-SEQUENCE-NO.
 11311     MOVE '6'                    TO AT-TRAILER-TYPE.
 11312     MOVE 'M'                    TO AT-INFO-TRAILER-TYPE.
 11313
 11314     MOVE WS-CAUSAL-NOTE         TO AT-INFO-LINE-1.
 11315
 11316     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11317                                    AT-GEN-INFO-LAST-MAINT-DT.
 11318
 11319     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11320                                    AT-GEN-INFO-LAST-UPDATED-BY.
 11321     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 11322
 11323
 11324
 11325* EXEC CICS WRITE
 11326*        DATASET   (ELTRLR-DSID)
 11327*        FROM      (ACTIVITY-TRAILERS)
 11328*        RIDFLD    (AT-CONTROL-PRIMARY)
 11329*    END-EXEC.
 11330     MOVE LENGTH OF
 11331      ACTIVITY-TRAILERS
 11332       TO DFHEIV11
 11333*    MOVE '&$ L                  ''   #00010515' TO DFHEIV0
 11334     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11335     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11336     MOVE X'2020233030303130353135' TO DFHEIV0(25:11)
 11337     CALL 'kxdfhei1' USING DFHEIV0,
 11338           ELTRLR-DSID,
 11339           ACTIVITY-TRAILERS,
 11340           DFHEIV11,
 11341           AT-CONTROL-PRIMARY,
 11342           DFHEIV99,
 11343           DFHEIV99
 11344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11345
 11346
 11347 3994B-EXIT.
 11348     EXIT.
 11349 3994C-BUILD-NINETY-FIVE-TRAILER.
 11350
 11351     MOVE SPACES                 TO ACTIVITY-TRAILERS
 11352     MOVE 'AT'                   TO AT-RECORD-ID
 11353
 11354     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD
 11355     MOVE CLMCARRI               TO AT-CARRIER
 11356
 11357     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO
 11358     MOVE CERT-CERT-NO           TO AT-CERT-NO
 11359     MOVE +95                    TO AT-SEQUENCE-NO
 11360     MOVE '6'                    TO AT-TRAILER-TYPE
 11361     MOVE 'E'                    TO AT-INFO-TRAILER-TYPE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 215
* EL130.cbl
 11362
 11363     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT
 11364                                    AT-GEN-INFO-LAST-MAINT-DT
 11365
 11366     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 11367                                    AT-GEN-INFO-LAST-UPDATED-BY
 11368     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 11369
 11370     perform varying e1 from +1 by +1 until
 11371        ws-error-no (e1) = spaces
 11372        move ws-error-no (e1)    to at-note-error-no (e1)
 11373     end-perform
 11374
 11375     if at-info-line-1 not = spaces
 11376
 11377* EXEC CICS WRITE
 11378*          DATASET  (ELTRLR-DSID)
 11379*          FROM     (ACTIVITY-TRAILERS)
 11380*          RIDFLD   (AT-CONTROL-PRIMARY)
 11381*       END-EXEC
 11382     MOVE LENGTH OF
 11383      ACTIVITY-TRAILERS
 11384       TO DFHEIV11
 11385*    MOVE '&$ L                  ''   #00010550' TO DFHEIV0
 11386     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11387     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11388     MOVE X'2020233030303130353530' TO DFHEIV0(25:11)
 11389     CALL 'kxdfhei1' USING DFHEIV0,
 11390           ELTRLR-DSID,
 11391           ACTIVITY-TRAILERS,
 11392           DFHEIV11,
 11393           AT-CONTROL-PRIMARY,
 11394           DFHEIV99,
 11395           DFHEIV99
 11396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11397     end-if
 11398
 11399     .
 11400 3994C-EXIT.
 11401     EXIT.
 11402 3995-BUILD-CLAIM-RECORD.
 11403     IF PROCCDL GREATER ZERO
 11404         MOVE PROCCDI            TO CL-PROCESSOR-ID
 11405     ELSE
 11406         MOVE PI-PROCESSOR-ID    TO CL-PROCESSOR-ID
 11407     END-IF.
 11408
 11409     IF FSTNMEL GREATER ZERO
 11410         MOVE FSTNMEI            TO CL-INSURED-1ST-NAME
 11411     END-IF.
 11412
 11413     IF INITL GREATER ZERO
 11414         MOVE INITI              TO CL-INSURED-MID-INIT
 11415     END-IF.
 11416
 11417     IF BIRTHDTL GREATER ZERO
 11418         MOVE WS-BIRTHDT         TO CL-INSURED-BIRTH-DT
 11419     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 216
* EL130.cbl
 11420
 11421     IF SEXL GREATER ZERO
 11422         MOVE SEXI               TO CL-INSURED-SEX-CD
 11423     END-IF.
 11424
 11425     MOVE 'O'                    TO CL-CLAIM-STATUS.
 11426
 11427*    IF CLMTYPEL GREATER ZERO
 11428     MOVE CLMTYPEI               TO CL-CLAIM-TYPE.
 11429*    END-IF.
 11430
 11431     IF PREMTYPL GREATER ZERO
 11432         MOVE PREMTYPI           TO CL-CLAIM-PREM-TYPE
 11433     END-IF.
 11434
 11435     IF INCURL GREATER ZERO
 11436         MOVE WS-INCUR           TO CL-INCURRED-DT
 11437     END-IF.
 11438
 11439     IF (PI-COMPANY-ID = 'DCC' OR 'VPP')
 11440        AND (ERPDEF-FOUND)
 11441        MOVE WS-MAX-BENEFITS     TO CL-CRITICAL-PERIOD
 11442*       MOVE WS-CRIT-PER-RECURRENT
 11443*                                TO CL-CRIT-PER-RECURRENT
 11444*       MOVE WS-CRIT-PER-RTW-MOS TO CL-CRIT-PER-RTW-MOS
 11445        if ws-crit-per-recurrent > 01
 11446           move zeros            to cl-benefit-period
 11447        end-if
 11448     ELSE
 11449        IF CL-CLAIM-TYPE = 'L' OR 'P'
 11450           MOVE CM-LF-CRITICAL-PERIOD
 11451                                 TO CL-CRITICAL-PERIOD
 11452        ELSE
 11453           MOVE CM-AH-CRITICAL-PERIOD
 11454                                 TO CL-CRITICAL-PERIOD
 11455        END-IF
 11456     END-IF
 11457
 11458     IF CL-CRITICAL-PERIOD NOT = ZEROS
 11459        COMPUTE DC-ELAPSED-MONTHS =
 11460           CL-CRITICAL-PERIOD - WS-BENEFITS-PREV-PAID
 11461        MOVE CL-INCURRED-DT      TO DC-BIN-DATE-1
 11462        MOVE ZEROS               TO DC-ELAPSED-DAYS
 11463        MOVE '6'                 TO DC-OPTION-CODE
 11464        PERFORM 9700-LINK-DATE-CONVERT
 11465                                 THRU 9700-EXIT
 11466        MOVE DC-BIN-DATE-2       TO CL-BENEFIT-EXPIRATION-DT
 11467     END-IF
 11468
 11469     if instypel > zero
 11470        move instypei            to cl-insured-type
 11471     end-if
 11472     IF REPORTL GREATER ZERO
 11473         MOVE WS-REPORT          TO CL-REPORTED-DT
 11474     END-IF.
 11475
 11476     IF EIBAID = DFHPF6
 11477         IF WS-REPORT = LOW-VALUES  OR   REPORTL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 217
* EL130.cbl
 11478             MOVE WS-TODAY-DT    TO CL-REPORTED-DT
 11479                 IF EMI-FORCABLE-CTR = +1
 11480                     MOVE ZEROS  TO CL-FORCEABLE-ERROR-CNT
 11481                 END-IF
 11482         END-IF
 11483     END-IF.
 11484
 11485*    IF ESTENDL GREATER ZERO
 11486*       MOVE WS-ESTEND           TO CL-EST-END-OF-DISAB-DT
 11487*    END-IF.
 11488
 11489     IF ADDONDTL GREATER ZERO
 11490         MOVE WS-ADD-ON-DT   TO CL-LAST-ADD-ON-DT
 11491     END-IF.
 11492
 11493*    IF CAUSEL GREATER ZERO
 11494*        MOVE CAUSEI             TO CL-CAUSE-CD
 11495*    END-IF.
 11496
 11497     IF SSNL GREATER ZERO
 11498         MOVE SSNI               TO CL-SOC-SEC-NO
 11499     ELSE
 11500         MOVE CERT-STATE         TO CL-SSN-STATE
 11501         MOVE CERT-ACCOUNT-PRIME TO CL-SSN-ACCOUNT
 11502         MOVE CL-INSURED-LAST-NAME TO CL-SSN-LN3
 11503     END-IF.
 11504
 11505     IF PRICDL GREATER ZERO
 11506         MOVE PRICDI             TO CL-PRIORITY-CD
 11507     END-IF.
 11508
 11509     IF SUPVL GREATER ZERO
 11510         MOVE SUPVI              TO CL-SUPV-ATTN-CD
 11511     END-IF.
 11512
 11513     MOVE WS-TODAY-DT            TO CL-LAST-MAINT-DT.
 11514     MOVE CL-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 11515     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 11516
 11517     IF RELCLML GREATER ZERO
 11518         MOVE RELCLMI            TO CL-RELATED-CLAIM-NO
 11519     END-IF.
 11520
 11521     IF FILETOL GREATER ZERO
 11522         MOVE FILETOI            TO CL-FILE-LOCATION
 11523     END-IF.
 11524
 11525 3995-EXIT.
 11526      EXIT.
 11527 3996-read-cert-claim-trailer.
 11528
 11529     move cm-ah-benefit-amt      to ws-monthly-benefit
 11530     if (pi-dcc-max-amt < ws-monthly-benefit)
 11531        and (pi-dcc-max-amt not = zeros)
 11532        move pi-dcc-max-amt      to ws-monthly-benefit
 11533     end-if
 11534
 11535     MOVE CM-COMPANY-CD          TO CTRLR-COMP-CD
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 218
* EL130.cbl
 11536     MOVE CM-CARRIER             TO CTRLR-CARRIER
 11537     MOVE CM-GROUPING            TO CTRLR-GROUPING
 11538     MOVE CM-STATE               TO CTRLR-STATE
 11539     MOVE CM-ACCOUNT             TO CTRLR-ACCOUNT
 11540     MOVE CM-CERT-EFF-DT         TO CTRLR-EFF-DT
 11541     MOVE CM-CERT-NO             TO CTRLR-CERT-NO
 11542     MOVE 'B'                    TO CTRLR-REC-TYPE
 11543
 11544* EXEC CICS READ
 11545*       DATASET  (ELCRTT-DSID)
 11546*       set     (address of CERTIFICATE-TRAILERS)
 11547*       RIDFLD   (ELCRTT-KEY)
 11548*       RESP     (WS-RESPONSE)
 11549*    END-EXEC
 11550*    MOVE '&"S        E          (  N#00010701' TO DFHEIV0
 11551     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11552     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11553     MOVE X'204E233030303130373031' TO DFHEIV0(25:11)
 11554     CALL 'kxdfhei1' USING DFHEIV0,
 11555           ELCRTT-DSID,
 11556           DFHEIV20,
 11557           DFHEIV99,
 11558           ELCRTT-KEY,
 11559           DFHEIV99,
 11560           DFHEIV99,
 11561           DFHEIV99
 11562     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11563         DFHEIV20
 11564     MOVE EIBRESP  TO WS-RESPONSE
 11565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11566***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11567***                                                            ***
 11568***  This may need some work here. I think I should accumulate ***
 11569***  all the claims with the same claim type?????????          ***
 11570***                                                            ***
 11571***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11572     IF WS-RESP-NORMAL
 11573        move zeros to ws-tot-days-paid ws-tot-amt-paid
 11574        perform varying s1 from +1 by +1 until
 11575           (s1 > +24)
 11576           or (cs-claim-no (s1) = spaces)
 11577           if cs-claim-type (s1) = clmtypei
 11578              move er-1659       to ws-error-no (e1)
 11579              compute ws-tot-days-paid =
 11580                 ws-tot-days-paid + cs-days-paid (s1)
 11581              compute ws-tot-amt-paid =
 11582                 ws-tot-amt-paid + cs-total-paid (s1)
 11583           end-if
 11584        end-perform
 11585*        compute ws-pd-bens rounded = ws-tot-days-paid / 30
 11586*        if (ws-pd-bens >= pi-dcc-max-benefits)
 11587*           and (pi-dcc-max-benefits not = zeros)
 11588*           add +1                to e1
 11589*           MOVE ER-1660          TO EMI-ERROR
 11590*                                    ws-error-no (e1)
 11591*           PERFORM 9900-ERROR-FORMAT
 11592*                                 THRU 9900-EXIT
 11593*        end-if
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 219
* EL130.cbl
 11594     end-if
 11595**       if instypei = 'P'
 11596**          move +1 to s1
 11597**       else
 11598**          MOVE +2 to s1
 11599**       end-if
 11600*
 11601*        move +1 to s1
 11602*        evaluate clmtypei
 11603*           when 'A'
 11604*              move +1 to s2
 11605*           when 'I'
 11606*              move +2 to s2
 11607*           when 'G'
 11608*              move +3 to s2
 11609*           when 'L'
 11610*              move +4 to s2
 11611*           when 'P'
 11612*              move +5 to s2
 11613*        end-evaluate
 11614*        if cs-claim-type (s1 s2) = clmtypei
 11615*           if cs-no-of-claims (s1 s2) > zeros
 11616*              move er-1659       to ws-error-no (e1)
 11617*           end-if
 11618*           compute WS-BENEFITS-PREV-PAID =
 11619*              cs-total-paid (s1 s2) / ws-monthly-benefit
 11620*           if (WS-BENEFITS-PREV-PAID >= pi-dcc-max-benefits)
 11621*              and (pi-dcc-max-benefits not = zeros)
 11622*              add +1             to e1
 11623*              MOVE ER-1660       TO EMI-ERROR
 11624*                                    ws-error-no (e1)
 11625*              PERFORM 9900-ERROR-FORMAT
 11626*                                 THRU 9900-EXIT
 11627*           end-if
 11628*        end-if
 11629*     end-if
 11630
 11631     .
 11632 3996-exit.
 11633     exit.
 11634
 11635 3997-GET-ERPDEF.
 11636
 11637     if cm-clp-state = spaces or low-values or zeros
 11638        move cm-state            to cm-clp-state
 11639     end-if
 11640     MOVE SPACES                 TO WS-ERPDEF-SW
 11641     MOVE ZEROS                  TO WS-MAX-BENEFITS
 11642                                    WS-CRIT-PER-RTW-MOS
 11643                                    WS-CRIT-PER-RECURRENT
 11644
 11645     MOVE PI-COMPANY-CD       TO ERPDEF-KEY
 11646     MOVE CM-clp-state        TO ERPDEF-STATE
 11647     MOVE ws-dcc-product-code TO ERPDEF-PROD-CD
 11648***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 11649***                                                            ***
 11650***  If they set up a claim where there is no coverage on the  ***
 11651***  addendum with the intention of denying.  We need to do    ***
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 220
* EL130.cbl
 11652***  some funky stuff here.                                    ***
 11653***                                                            ***
 11654***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 11655
 11656     evaluate true
 11657        when (clmtypei = 'L' or 'P')
 11658           and (cm-lf-benefit-cd not = '00' and '  ' and 'DD'
 11659              and 'CU')
 11660           move 'L'              to erpdef-ben-type
 11661           move cm-lf-benefit-cd to erpdef-ben-code
 11662        when (clmtypei not = 'L' and 'P')
 11663           and (cm-ah-benefit-cd not = '00' and '  ')
 11664           move 'A'              to erpdef-ben-type
 11665           move cm-ah-benefit-cd to erpdef-ben-code
 11666        when (clmtypei not = 'L' and 'P')
 11667           and (cm-ah-benefit-cd = '00' or '  ')
 11668           move 'L'              to erpdef-ben-type
 11669           move cm-lf-benefit-cd to erpdef-ben-code
 11670        when (clmtypei = 'L' or 'P')
 11671           and (cm-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
 11672           move 'A'              to erpdef-ben-type
 11673           move cm-ah-benefit-cd to erpdef-ben-code
 11674        when other
 11675           move 'A'              to erpdef-ben-type
 11676           move cm-ah-benefit-cd to erpdef-ben-code
 11677     end-evaluate
 11678*    MOVE 'A'                 TO ERPDEF-BEN-TYPE
 11679*    MOVE CM-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
 11680     MOVE CM-CERT-EFF-DT      TO ERPDEF-EXP-DT
 11681     MOVE ERPDEF-KEY          TO ERPDEF-KEY-SAVE
 11682
 11683
 11684* EXEC CICS STARTBR
 11685*        DATASET  ('ERPDEF')
 11686*        RIDFLD   (ERPDEF-KEY)
 11687*        GTEQ
 11688*        RESP     (WS-RESPONSE)
 11689*    END-EXEC
 11690     MOVE 'ERPDEF' TO DFHEIV1
 11691     MOVE 0
 11692       TO DFHEIV11
 11693*    MOVE '&,         G          &  N#00010824' TO DFHEIV0
 11694     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11695     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11696     MOVE X'204E233030303130383234' TO DFHEIV0(25:11)
 11697     CALL 'kxdfhei1' USING DFHEIV0,
 11698           DFHEIV1,
 11699           ERPDEF-KEY,
 11700           DFHEIV99,
 11701           DFHEIV11,
 11702           DFHEIV99
 11703     MOVE EIBRESP  TO WS-RESPONSE
 11704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11705
 11706     IF WS-RESP-NORMAL
 11707
 11708* EXEC CICS READNEXT
 11709*          DATASET  ('ERPDEF')
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 221
* EL130.cbl
 11710*          INTO     (PRODUCT-MASTER)
 11711*          RIDFLD   (ERPDEF-KEY)
 11712*          RESP     (WS-RESPONSE)
 11713*       END-EXEC
 11714     MOVE LENGTH OF
 11715      PRODUCT-MASTER
 11716       TO DFHEIV12
 11717     MOVE 'ERPDEF' TO DFHEIV1
 11718     MOVE 0
 11719       TO DFHEIV11
 11720*    MOVE '&.IL                  )  N#00010832' TO DFHEIV0
 11721     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 11722     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11723     MOVE X'204E233030303130383332' TO DFHEIV0(25:11)
 11724     CALL 'kxdfhei1' USING DFHEIV0,
 11725           DFHEIV1,
 11726           PRODUCT-MASTER,
 11727           DFHEIV12,
 11728           ERPDEF-KEY,
 11729           DFHEIV99,
 11730           DFHEIV11,
 11731           DFHEIV99,
 11732           DFHEIV99
 11733     MOVE EIBRESP  TO WS-RESPONSE
 11734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11735
 11736        IF WS-RESP-NORMAL
 11737           IF (ERPDEF-KEY-SAVE (1:16) =
 11738              PD-CONTROL-PRIMARY (1:16))
 11739              AND (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
 11740
 11741              PERFORM VARYING A1 FROM +1 BY +1 UNTIL
 11742                 (A1 > +8)
 11743                 OR (PD-PROD-CODE (A1) = CLMTYPEI)
 11744              END-PERFORM
 11745              IF A1 < +9
 11746                 SET ERPDEF-FOUND TO TRUE
 11747                 move pd-max-amt (a1)
 11748                              to pi-dcc-max-amt
 11749                 MOVE PD-CRIT-PERIOD (A1)
 11750                              TO WS-MAX-BENEFITS
 11751                                 pi-dcc-max-benefits
 11752                 if pd-rec-crit-period (a1) not numeric
 11753                    move 01      to pd-rec-crit-period (a1)
 11754                 end-if
 11755                 MOVE PD-REC-CRIT-PERIOD (A1)
 11756                              TO WS-CRIT-PER-RECURRENT
 11757                 IF PD-RTW-MOS (A1) NUMERIC
 11758                    MOVE PD-RTW-MOS (A1)
 11759                              TO WS-CRIT-PER-RTW-MOS
 11760                 ELSE
 11761                    MOVE 0    TO WS-CRIT-PER-RTW-MOS
 11762                 END-IF
 11763                 IF PD-EXCLUSION-PERIOD-DAYS (A1) NUMERIC
 11764                    MOVE PD-EXCLUSION-PERIOD-DAYS (A1)
 11765                                 TO WS-EXCL-PERIOD
 11766                 END-IF
 11767                 IF PD-COVERAGE-ENDS-MOS (A1) NUMERIC
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 222
* EL130.cbl
 11768                    MOVE PD-COVERAGE-ENDS-MOS (A1)
 11769                                 TO WS-COV-ENDS
 11770                 END-IF
 11771                 IF PD-ACCIDENT-ONLY-MOS (A1) NUMERIC
 11772                    MOVE PD-ACCIDENT-ONLY-MOS (A1)
 11773                                 TO WS-ACC-PERIOD
 11774                 END-IF
 11775              else
 11776                 MOVE -1         TO MAINTL
 11777                 move er-1673    to emi-error
 11778                 PERFORM 9900-ERROR-FORMAT
 11779                                 THRU 9900-EXIT
 11780              END-IF
 11781           else
 11782              MOVE -1            TO MAINTL
 11783              move er-1671       to emi-error
 11784              PERFORM 9900-ERROR-FORMAT
 11785                                 THRU 9900-EXIT
 11786           END-IF
 11787        END-IF
 11788     END-IF
 11789
 11790     .
 11791 3997-EXIT.
 11792     EXIT.
 11793
 11794 3998-update-cert-claim-trailer.
 11795
 11796
 11797* EXEC CICS GETMAIN
 11798*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 11799*       LENGTH   (ELCRTT-LENGTH)
 11800*       INITIMG  (GETMAIN-SPACE)
 11801*    END-EXEC
 11802*    MOVE ',"IL                  $   #00010899' TO DFHEIV0
 11803     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11804     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11805     MOVE X'2020233030303130383939' TO DFHEIV0(25:11)
 11806     CALL 'kxdfhei1' USING DFHEIV0,
 11807           DFHEIV20,
 11808           ELCRTT-LENGTH,
 11809           GETMAIN-SPACE
 11810     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11811         DFHEIV20
 11812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11813
 11814     MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 11815     MOVE CM-CARRIER       TO CTRLR-CARRIER
 11816     MOVE CM-GROUPING      TO CTRLR-GROUPING
 11817     MOVE CM-STATE         TO CTRLR-STATE
 11818     MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 11819     MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 11820     MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 11821     MOVE 'B'              TO CTRLR-REC-TYPE
 11822
 11823* EXEC CICS READ
 11824*       UPDATE
 11825*       DATASET  (ELCRTT-DSID)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 223
* EL130.cbl
 11826*       into     (CERTIFICATE-TRAILERS)
 11827*       RIDFLD   (ELCRTT-KEY)
 11828*       RESP     (WS-RESPONSE)
 11829*    END-EXEC
 11830     MOVE LENGTH OF
 11831      CERTIFICATE-TRAILERS
 11832       TO DFHEIV11
 11833*    MOVE '&"IL       EU         (  N#00010913' TO DFHEIV0
 11834     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11835     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11836     MOVE X'204E233030303130393133' TO DFHEIV0(25:11)
 11837     CALL 'kxdfhei1' USING DFHEIV0,
 11838           ELCRTT-DSID,
 11839           CERTIFICATE-TRAILERS,
 11840           DFHEIV11,
 11841           ELCRTT-KEY,
 11842           DFHEIV99,
 11843           DFHEIV99,
 11844           DFHEIV99
 11845     MOVE EIBRESP  TO WS-RESPONSE
 11846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11847     IF WS-RESP-NORMAL
 11848        perform varying s1 from +1 by +1 until
 11849           (s1 > +24)
 11850           or (cs-claim-no (s1) = spaces)
 11851        end-perform
 11852        if s1 < +25
 11853           perform 3999-upd-crt-trlr thru 3999-exit
 11854
 11855* EXEC CICS REWRITE
 11856*             DATASET  (ELCRTT-DSID)
 11857*             from     (CERTIFICATE-TRAILERS)
 11858*             RESP     (WS-RESPONSE)
 11859*          END-EXEC
 11860     MOVE LENGTH OF
 11861      CERTIFICATE-TRAILERS
 11862       TO DFHEIV11
 11863*    MOVE '&& L                  %  N#00010927' TO DFHEIV0
 11864     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11865     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11866     MOVE X'204E233030303130393237' TO DFHEIV0(25:11)
 11867     CALL 'kxdfhei1' USING DFHEIV0,
 11868           ELCRTT-DSID,
 11869           CERTIFICATE-TRAILERS,
 11870           DFHEIV11,
 11871           DFHEIV99
 11872     MOVE EIBRESP  TO WS-RESPONSE
 11873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11874        end-if
 11875     else
 11876        if ws-resp-notfnd
 11877           move 'CS'             to certificate-trailers
 11878           move cm-control-primary to cs-control-primary
 11879           move 'B'              to cs-trailer-type
 11880           perform varying s1 from +1 by +1 until s1 > +24
 11881              move zeros         to cs-days-paid (s1)
 11882                                    cs-total-paid (s1)
 11883                                    cs-benefit-period (s1)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 224
* EL130.cbl
 11884                                    cs-remaining-bens (s1)
 11885           end-perform
 11886           move +1               to s1
 11887           perform 3999-upd-crt-trlr
 11888                                 thru 3999-exit
 11889
 11890* EXEC CICS WRITE
 11891*             DATASET  (ELCRTT-DSID)
 11892*             from     (CERTIFICATE-TRAILERS)
 11893*             RIDFLD   (cs-control-primary)
 11894*             RESP     (WS-RESPONSE)
 11895*          END-EXEC
 11896     MOVE LENGTH OF
 11897      CERTIFICATE-TRAILERS
 11898       TO DFHEIV11
 11899*    MOVE '&$ L                  ''  N#00010947' TO DFHEIV0
 11900     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 11901     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11902     MOVE X'204E233030303130393437' TO DFHEIV0(25:11)
 11903     CALL 'kxdfhei1' USING DFHEIV0,
 11904           ELCRTT-DSID,
 11905           CERTIFICATE-TRAILERS,
 11906           DFHEIV11,
 11907           cs-control-primary,
 11908           DFHEIV99,
 11909           DFHEIV99
 11910     MOVE EIBRESP  TO WS-RESPONSE
 11911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11912        end-if
 11913     END-IF
 11914
 11915     .
 11916 3998-exit.
 11917     exit.
 11918
 11919 3999-upd-crt-trlr.
 11920     move clmnoi                 to cs-claim-no       (s1)
 11921     move clmtypei               to cs-claim-type     (s1)
 11922     move instypei               to cs-insured-type   (s1)
 11923     move cl-benefit-period      to cs-benefit-period (s1)
 11924*    move cl-critical-period     to cs-remaining-bens (s1)
 11925     move zeros                  to cs-remaining-bens (s1)
 11926     .
 11927 3999-exit.
 11928     exit.
 11929 4000-CALCULATE-CERT-TERM.
 11930
 11931     PERFORM 4100-CALC-GROSS-TERM THRU 4200-EXIT.
 11932
 11933     MOVE N                      TO WS-TERM.
 11934
 11935     IF WS-TERM GREATER 120
 11936         MOVE 120                TO WS-TERM
 11937     END-IF.
 11938
 11939 4000-CALC-TERM-EXIT.
 11940      EXIT.
 11941
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 225
* EL130.cbl
 11942 4100-CALC-GROSS-TERM.
 11943     MOVE HOLD-LOAN-BAL           TO L.
 11944     MOVE WS-ACVBENE              TO M.
 11945     COMPUTE N = L / M.
 11946     IF N LESS 1
 11947         MOVE 1  TO N
 11948     END-IF.
 11949
 11950     IF LCVCDL GREATER ZERO
 11951         COMPUTE WS-LF-RATE = WS-LCVRATE / +1000
 11952     ELSE
 11953         MOVE ZEROS               TO WS-LF-RATE
 11954     END-IF.
 11955
 11956     IF ACVCDL GREATER ZERO
 11957         COMPUTE WS-AH-RATE = WS-ACVRATE / +1000
 11958     ELSE
 11959         MOVE ZEROS               TO WS-AH-RATE
 11960     END-IF.
 11961
 11962     COMPUTE I = WS-APR / +1200.
 11963
 11964 4105-LOOP.
 11965     IF N GREATER 240
 11966         GO TO 4200-EXIT
 11967     END-IF.
 11968
 11969     PERFORM 4210-CALC-LEFT-RIGHTONE THRU 4220-EXIT.
 11970
 11971     IF LEFT-TOT-1 GREATER RIGHT-TOT-1
 11972         ADD 1 TO N
 11973         GO TO 4105-LOOP
 11974     END-IF.
 11975
 11976 4200-EXIT.
 11977      EXIT.
 11978
 11979 4210-CALC-LEFT-RIGHTONE.
 11980      MOVE L         TO LEFT-TOT-1.
 11981      SUBTRACT 1 FROM N.
 11982      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 11983      PERFORM 4350-CALC-IA-N THRU 4400-EXIT.
 11984      ADD 1 TO N.
 11985
 11986 4211-CALC-TERM1.
 11987      MOVE N         TO TERM1.
 11988      MULTIPLY M BY TERM1.
 11989
 11990 4212-LOOP.
 11991      COMPUTE TERM1 = (WS-AH-RATE + WS-LF-RATE) * TERM1.
 11992      ADD 1 TO A-N.
 11993      MULTIPLY A-N BY TERM1.
 11994      SUBTRACT 1 FROM A-N.
 11995      ADD TERM1 TO LEFT-TOT-1.
 11996
 11997 4213-CALC-TERM2.
 11998      MOVE M         TO TERM2.
 11999      COMPUTE TERM2 = (WS-AH-RATE + WS-LF-RATE) * TERM2.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 226
* EL130.cbl
 12000      MULTIPLY IA-N BY TERM2.
 12001      SUBTRACT TERM2 FROM LEFT-TOT-1.
 12002
 12003 4215-CALC-RIGHTONE.
 12004      MOVE M         TO RIGHT-TOT-1.
 12005      PERFORM 4300-CALC-A-N THRU 4300-EXIT.
 12006      MULTIPLY A-N BY RIGHT-TOT-1.
 12007
 12008 4220-EXIT.
 12009      EXIT.
 12010
 12011 4300-CALC-A-N.
 12012     IF N LESS 1
 12013         MOVE 0     TO A-N
 12014         GO TO 4300-EXIT
 12015     END-IF.
 12016
 12017     IF I = 0
 12018         MOVE .00001 TO I
 12019     END-IF.
 12020
 12021     ADD 1 TO I.
 12022     DIVIDE I INTO 1 GIVING V.
 12023     SUBTRACT 1 FROM I.
 12024     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12025     SUBTRACT V-EX-N FROM 1 GIVING TERM3.
 12026     DIVIDE I INTO TERM3 GIVING A-N.
 12027
 12028 4300-EXIT.
 12029      EXIT.
 12030
 12031 4350-CALC-IA-N.
 12032     IF N LESS 1
 12033         MOVE 0      TO IA-N
 12034         GO TO 4400-EXIT
 12035     END-IF.
 12036
 12037     ADD 1 TO N.
 12038     PERFORM 4450-CALC-V-EX-N THRU 4490-EXIT.
 12039     SUBTRACT 1 FROM N.
 12040     MULTIPLY N BY V-EX-N GIVING TERM3.
 12041     SUBTRACT TERM3 FROM A-N GIVING TERM3.
 12042     SUBTRACT V FROM 1 GIVING TERM4.
 12043     DIVIDE TERM4 INTO TERM3 GIVING IA-N.
 12044
 12045 4400-EXIT.
 12046      EXIT.
 12047
 12048 4450-CALC-V-EX-N.
 12049     IF N LESS 1
 12050         MOVE 1    TO V-EX-N
 12051         GO TO 4490-EXIT
 12052     END-IF.
 12053
 12054     MOVE N        TO NV-STORE.
 12055
 12056     IF V-EX-ONETIME = 1  OR
 12057        V NOT = V-EXPONENT (1)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 227
* EL130.cbl
 12058          PERFORM 4470-BUILD-V-EX-TABLE THRU 4480-EXIT
 12059     END-IF.
 12060
 12061 4460-LOOP.
 12062     IF N GREATER 248
 12063         MOVE 248 TO N
 12064     END-IF.
 12065
 12066     IF N = 1
 12067         MOVE V               TO V-EX-N
 12068     ELSE
 12069         MOVE V-EXPONENT (N)  TO V-EX-N
 12070     END-IF.
 12071
 12072     GO TO 4490-EXIT.
 12073
 12074 4470-BUILD-V-EX-TABLE.
 12075     MOVE 2      TO N.
 12076     MOVE V      TO V-EXPONENT (1)
 12077                    V-EX-N.
 12078
 12079 4471-LOOP.
 12080     MULTIPLY V BY V-EX-N.
 12081     MOVE V-EX-N   TO V-EXPONENT (N).
 12082
 12083     ADD 1 TO N.
 12084     IF N LESS 248
 12085         GO TO 4471-LOOP
 12086     END-IF.
 12087
 12088     MOVE NV-STORE     TO N.
 12089     MOVE ZERO         TO V-EX-ONETIME.
 12090
 12091 4480-EXIT.
 12092      EXIT.
 12093
 12094 4490-EXIT.
 12095      EXIT.
 12096
 12097 4500-CALC-NET-TERM.
 12098     MOVE HOLD-LOAN-BAL           TO L.
 12099     MOVE WS-ACVBENE              TO M.
 12100     DIVIDE L BY M GIVING N REMAINDER WS-REMAIN.
 12101
 12102     IF WS-REMAIN GREATER ZERO
 12103         ADD 1 TO N
 12104     END-IF.
 12105
 12106     IF N = 0
 12107         MOVE 1 TO N
 12108     END-IF.
 12109
 12110 4700-EXIT.
 12111      EXIT.
 12112
 12113 4999-CALC-TERM-EXIT.
 12114     EXIT.
 12115
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 228
* EL130.cbl
 12117 5000-INCURRED-CHANGE.
 12118     IF NOT MODIFY-CAP
 12119         MOVE ER-0070            TO EMI-ERROR
 12120         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12121         MOVE -1                 TO MAINTL
 12122         GO TO 8200-SEND-DATAONLY
 12123     END-IF.
 12124
 12125     IF CLMNOI       NOT = PI-LAST-CLAIM       OR
 12126        CLMCARRI     NOT = PI-LAST-CARR        OR
 12127        CERTNOI      NOT = PI-LAST-CERT-PRIME  OR
 12128        SUFXI        NOT = PI-LAST-CERT-SUFX   OR
 12129        PI-INCURR-SW NOT = 'Y'
 12130          GO TO 1000-SHOW-CLAIM
 12131     END-IF.
 12132
 12133     PERFORM 6000-EDIT-CLAIM-DATA THRU 6000-EXIT.
 12134     PERFORM 6200-EDIT-CERT-DATA  THRU 6200-EXIT.
 12135     PERFORM 6400-TEST-CLAIM-REASONABILITY THRU 6499-EXIT.
 12136
 12137     IF EMI-NO-ERRORS
 12138         GO TO 5000-TRY-TO-BUILD
 12139     END-IF.
 12140
 12141     IF EIBAID = DFHPF6  AND NOT FORCE-CAP
 12142        MOVE ER-0433             TO EMI-ERROR
 12143        MOVE -1                  TO MAINTL
 12144        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12145        GO TO 8200-SEND-DATAONLY
 12146     END-IF.
 12147
 12148     IF EIBAID = DFHPF6
 12149         IF EMI-FATAL-CTR NOT EQUAL ZERO
 12150            MOVE ER-0434         TO EMI-ERROR
 12151            MOVE -1              TO MAINTL
 12152            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12153            GO TO 8200-SEND-DATAONLY
 12154         ELSE
 12155            MOVE +1              TO INCURL
 12156            GO TO 5000-TRY-TO-BUILD
 12157         END-IF
 12158     END-IF.
 12159
 12160     GO TO 8200-SEND-DATAONLY.
 12161
 12162 5000-TRY-TO-BUILD.
 12163
 12164     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 12165
 12166     MOVE CLMCARRI               TO MSTR-CARRIER.
 12167
 12168     MOVE CLMNOI                 TO MSTR-CLAIM-NO.
 12169     MOVE CERTNOI                TO MSTR-CERT-NO-PRIME.
 12170     MOVE SUFXI                  TO MSTR-CERT-NO-SUFX.
 12171
 12172     PERFORM 7920-READ-CLAIM-UPDATE THRU 7920-EXIT.
 12173
 12174     IF CL-CLAIM-PAYMENT-STATUS NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 229
* EL130.cbl
 12175         MOVE ZEROS              TO CL-CLAIM-PAYMENT-STATUS
 12176     END-IF.
 12177
 12178     IF CL-PURGED-DT NOT = LOW-VALUES
 12179
 12180
 12181* EXEC CICS UNLOCK
 12182*            DATASET   (ELMSTR-DSID)
 12183*        END-EXEC
 12184*    MOVE '&*                    #   #00011221' TO DFHEIV0
 12185     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12186     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12187     MOVE X'2020233030303131323231' TO DFHEIV0(25:11)
 12188     CALL 'kxdfhei1' USING DFHEIV0,
 12189           ELMSTR-DSID,
 12190           DFHEIV99
 12191     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12192         MOVE ER-7691            TO EMI-ERROR
 12193         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12194         MOVE -1                 TO MAINTL
 12195         GO TO 8200-SEND-DATAONLY
 12196     END-IF.
 12197
 12198     IF CL-AUTO-PAY-SEQ NOT = ZERO
 12199
 12200
 12201* EXEC CICS UNLOCK
 12202*            DATASET   (ELMSTR-DSID)
 12203*       END-EXEC
 12204*    MOVE '&*                    #   #00011232' TO DFHEIV0
 12205     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12206     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12207     MOVE X'2020233030303131323332' TO DFHEIV0(25:11)
 12208     CALL 'kxdfhei1' USING DFHEIV0,
 12209           ELMSTR-DSID,
 12210           DFHEIV99
 12211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12212         MOVE ER-0523             TO EMI-ERROR
 12213         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12214         MOVE -1                  TO MAINTL
 12215         GO TO 8200-SEND-DATAONLY
 12216     END-IF.
 12217
 12218     PERFORM 7900-READ-ACTV-UPDATE THRU 7900-EXIT.
 12219
 12220     MOVE AT-ITD-PAID-EXPENSES       TO WS-ITD-PAID-EXPENSE.
 12221     MOVE AT-ITD-CHARGEABLE-EXPENSE  TO WS-ITD-CHARGABLE-EXPENSE.
 12222     MOVE AT-INITIAL-MANUAL-RESERVE  TO WS-INITIAL-MANUAL-RESERVE.
 12223     MOVE AT-CURRENT-MANUAL-RESERVE  TO WS-CURRENT-MANUAL-RESERVE.
 12224     MOVE AT-ITD-ADDITIONAL-RESERVE  TO WS-ITD-ADDITIONAL-RESERVE.
 12225
 12226     IF MANRSVL GREATER ZERO
 12227        MOVE WS-MANRSV           TO AT-INITIAL-MANUAL-RESERVE
 12228                                    AT-CURRENT-MANUAL-RESERVE
 12229     END-IF.
 12230     MOVE 1                      TO SUB.
 12231
 12232 5010-LOOP.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 230
* EL130.cbl
 12233     IF SUB = 1
 12234        MOVE WS-TODAY-DT         TO AT-OPEN-CLOSE-DATE   (SUB)
 12235        MOVE 'O'                 TO AT-OPEN-CLOSE-TYPE   (SUB)
 12236        MOVE 'NEW'               TO AT-OPEN-CLOSE-REASON (SUB)
 12237     ELSE
 12238        MOVE LOW-VALUES          TO AT-OPEN-CLOSE-DATE   (SUB)
 12239        MOVE SPACES              TO AT-OPEN-CLOSE-TYPE   (SUB)
 12240                                    AT-OPEN-CLOSE-REASON (SUB)
 12241     END-IF.
 12242
 12243     IF SUB NOT = 6
 12244        ADD 1                    TO SUB
 12245        GO TO 5010-LOOP
 12246     END-IF.
 12247
 12248 5020-UPDATE.
 12249
 12250     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12251
 12252     IF DIAGL = ZERO
 12253       AND ICD1L = ZERO
 12254       AND ICD2L = ZERO
 12255         PERFORM 7910-READ-NINETY THRU 7910-EXIT
 12256         MOVE AT-INFO-LINE-1     TO WS-DIAGNOSIS-DESCRIPT
 12257         MOVE AT-ICD-CODE-1      TO WS-ICD-CODE-1
 12258         MOVE AT-ICD-CODE-2      TO WS-ICD-CODE-2
 12259         GO TO 5025-BYPASS-UPDATE
 12260     END-IF.
 12261
 12262     PERFORM 7900-READ-NINETY-UPDATE THRU 7900-EXIT.
 12263
 12264     MOVE AT-INFO-LINE-1         TO WS-DIAGNOSIS-DESCRIPT.
 12265     IF DIAGL NOT = ZERO
 12266         MOVE DIAGI              TO AT-INFO-LINE-1
 12267     END-IF.
 12268
 12269     MOVE AT-ICD-CODE-1          TO WS-ICD-CODE-1.
 12270     IF ICD1L NOT = ZERO
 12271         MOVE ICD1I              TO AT-ICD-CODE-1
 12272     END-IF.
 12273
 12274     MOVE AT-ICD-CODE-2          TO WS-ICD-CODE-2.
 12275     IF ICD2L NOT = ZERO
 12276         MOVE ICD2I              TO AT-ICD-CODE-2
 12277     END-IF.
 12278
 12279     PERFORM 7915-REWRITE-TRAILER THRU 7915-EXIT.
 12280
 12281 5025-BYPASS-UPDATE.
 12282
 12283
 12284
 12285* EXEC CICS GETMAIN
 12286*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12287*        LENGTH   (ELTRLR-LENGTH)
 12288*    END-EXEC.
 12289*    MOVE '," L                  $   #00011307' TO DFHEIV0
 12290     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 231
* EL130.cbl
 12291     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12292     MOVE X'2020233030303131333037' TO DFHEIV0(25:11)
 12293     CALL 'kxdfhei1' USING DFHEIV0,
 12294           DFHEIV20,
 12295           ELTRLR-LENGTH,
 12296           DFHEIV99
 12297     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12298         DFHEIV20
 12299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12300
 12301
 12302     MOVE SPACES                 TO ACTIVITY-TRAILERS.
 12303     MOVE 'AT'                   TO AT-RECORD-ID.
 12304
 12305     MOVE PI-COMPANY-CD          TO AT-COMPANY-CD.
 12306     MOVE MSTR-CARRIER           TO AT-CARRIER.
 12307     MOVE MSTR-CLAIM-NO          TO AT-CLAIM-NO.
 12308     MOVE MSTR-CERT-NO           TO AT-CERT-NO.
 12309     MOVE CL-TRAILER-SEQ-CNT     TO AT-TRAILER-CNT-AT-CHG.
 12310     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 12311     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12312     MOVE '9'                    TO AT-TRAILER-TYPE.
 12313     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 12314     MOVE '5'                    TO DC-OPTION-CODE.
 12315     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12316     MOVE DC-BIN-DATE-1          TO AT-RECORDED-DT.
 12317
 12318     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY.
 12319     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12320
 12321     MOVE CL-INCURRED-DT         TO AT-OLD-INCURRED-DT.
 12322     MOVE CL-REPORTED-DT         TO AT-OLD-REPORTED-DT.
 12323     MOVE CL-FILE-ESTABLISH-DT   TO AT-OLD-ESTABLISHED-DT.
 12324     MOVE CL-TOTAL-PAID-AMT      TO AT-OLD-TOTAL-PAID.
 12325     MOVE CL-NO-OF-DAYS-PAID     TO AT-OLD-DAYS-PAID.
 12326     MOVE CL-NO-OF-PMTS-MADE     TO AT-OLD-NO-OF-PMTS.
 12327     MOVE CL-PAID-THRU-DT        TO AT-OLD-PAID-THRU-DT.
 12328     MOVE CL-LAST-PMT-DT         TO AT-LAST-PMT-MADE-DT.
 12329     MOVE WS-DIAGNOSIS-DESCRIPT  TO AT-OLD-DIAG-DESCRIP.
 12330     MOVE CL-CAUSE-CD            TO AT-OLD-DIAG-CODE.
 12331     MOVE WS-ICD-CODE-1          TO AT-OLD-ICD-CODE-1.
 12332     MOVE WS-ICD-CODE-2          TO AT-OLD-ICD-CODE-2.
 12333
 12334     MOVE WS-ITD-PAID-EXPENSE    TO AT-OLD-ITD-PAID-EXPENSE.
 12335     MOVE WS-ITD-CHARGABLE-EXPENSE   TO AT-OLD-CHARGABLE-EXPENSE.
 12336     MOVE WS-INITIAL-MANUAL-RESERVE  TO AT-OLD-INIT-MAN-RESV.
 12337     MOVE WS-CURRENT-MANUAL-RESERVE  TO AT-OLD-CURRENT-MAN-RESV.
 12338     MOVE WS-ITD-ADDITIONAL-RESERVE  TO AT-OLD-ADDL-MAN-RESV.
 12339
 12340
 12341
 12342* EXEC CICS WRITE
 12343*        DATASET   (ELTRLR-DSID)
 12344*        FROM      (ACTIVITY-TRAILERS)
 12345*        RIDFLD    (AT-CONTROL-PRIMARY)
 12346*    END-EXEC.
 12347     MOVE LENGTH OF
 12348      ACTIVITY-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 232
* EL130.cbl
 12349       TO DFHEIV11
 12350*    MOVE '&$ L                  ''   #00011351' TO DFHEIV0
 12351     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12352     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12353     MOVE X'2020233030303131333531' TO DFHEIV0(25:11)
 12354     CALL 'kxdfhei1' USING DFHEIV0,
 12355           ELTRLR-DSID,
 12356           ACTIVITY-TRAILERS,
 12357           DFHEIV11,
 12358           AT-CONTROL-PRIMARY,
 12359           DFHEIV99,
 12360           DFHEIV99
 12361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12362
 12363
 12364     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 12365     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 12366     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
 12367     MOVE CL-CERT-STATE          TO CERT-STATE.
 12368     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
 12369     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 12370     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 12371
 12372
 12373
 12374* EXEC CICS HANDLE CONDITION
 12375*        NOTFND   (5050-CERT-NOT-FOUND)
 12376*    END-EXEC.
 12377*    MOVE '"$I                   ! < #00011366' TO DFHEIV0
 12378     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12379     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12380     MOVE X'3C20233030303131333636' TO DFHEIV0(25:11)
 12381     CALL 'kxdfhei1' USING DFHEIV0
 12382     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12383
 12384
 12385     PERFORM 7930-READ-CERT-UPDATE THRU 7930-EXIT.
 12386
 12387     PERFORM 3700-BUILD-CERT THRU 3700-EXIT.
 12388
 12389
 12390
 12391* EXEC CICS HANDLE CONDITION
 12392*         DUPKEY   (5030-CERT-WRITTEN)
 12393*    END-EXEC.
 12394*    MOVE '"$$                   ! = #00011375' TO DFHEIV0
 12395     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12396     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12397     MOVE X'3D20233030303131333735' TO DFHEIV0(25:11)
 12398     CALL 'kxdfhei1' USING DFHEIV0
 12399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12400
 12401
 12402
 12403
 12404* EXEC CICS REWRITE
 12405*        DATASET  (ELCERT-DSID)
 12406*        FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 233
* EL130.cbl
 12407*    END-EXEC.
 12408     MOVE LENGTH OF
 12409      CERTIFICATE-MASTER
 12410       TO DFHEIV11
 12411*    MOVE '&& L                  %   #00011380' TO DFHEIV0
 12412     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12413     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12414     MOVE X'2020233030303131333830' TO DFHEIV0(25:11)
 12415     CALL 'kxdfhei1' USING DFHEIV0,
 12416           ELCERT-DSID,
 12417           CERTIFICATE-MASTER,
 12418           DFHEIV11,
 12419           DFHEIV99
 12420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12421
 12422
 12423 5030-CERT-WRITTEN.
 12424
 12425     MOVE LOW-VALUES             TO CL-LAST-PMT-DT
 12426                                    CL-INCURRED-DT
 12427                                    CL-REPORTED-DT
 12428                                    CL-EST-END-OF-DISAB-DT
 12429                                    CL-PAID-THRU-DT.
 12430
 12431     MOVE ZEROS                  TO CL-TOTAL-PAID-AMT
 12432                                    CL-NO-OF-PMTS-MADE
 12433                                    CL-NO-OF-DAYS-PAID.
 12434
 12435     IF CLAIM-IS-CLOSED
 12436        MOVE WS-TODAY-DT         TO CL-LAST-REOPEN-DT
 12437        MOVE 'O'                 TO CL-CLAIM-STATUS
 12438     END-IF.
 12439
 12440     PERFORM 3995-BUILD-CLAIM-RECORD THRU 3995-EXIT.
 12441     MOVE '5'                    TO CL-LAST-MAINT-TYPE.
 12442     MOVE EMI-FORCABLE-CTR       TO CL-FORCEABLE-ERROR-CNT.
 12443
 12444
 12445
 12446* EXEC CICS HANDLE CONDITION
 12447*         DUPKEY   (5035-CLAIM-WRITTEN)
 12448*    END-EXEC.
 12449*    MOVE '"$$                   ! > #00011407' TO DFHEIV0
 12450     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
 12451     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12452     MOVE X'3E20233030303131343037' TO DFHEIV0(25:11)
 12453     CALL 'kxdfhei1' USING DFHEIV0
 12454     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12455
 12456
 12457
 12458
 12459* EXEC CICS REWRITE
 12460*        DATASET   (ELMSTR-DSID)
 12461*        FROM      (CLAIM-MASTER)
 12462*    END-EXEC.
 12463     MOVE LENGTH OF
 12464      CLAIM-MASTER
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 234
* EL130.cbl
 12465       TO DFHEIV11
 12466*    MOVE '&& L                  %   #00011412' TO DFHEIV0
 12467     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12468     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12469     MOVE X'2020233030303131343132' TO DFHEIV0(25:11)
 12470     CALL 'kxdfhei1' USING DFHEIV0,
 12471           ELMSTR-DSID,
 12472           CLAIM-MASTER,
 12473           DFHEIV11,
 12474           DFHEIV99
 12475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12476
 12477
 12478 5035-CLAIM-WRITTEN.
 12479
 12480     MOVE ER-0000                TO EMI-ERROR.
 12481     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12482
 12483     MOVE CLMNOI                 TO PI-LAST-CLAIM.
 12484     MOVE CERTNOI                TO PI-LAST-CERT-PRIME.
 12485     MOVE SUFXI                  TO PI-LAST-CERT-SUFX.
 12486     MOVE CLMCARRI               TO PI-LAST-CARR.
 12487
 12488     IF PRTOPTL GREATER ZERO
 12489         MOVE PRTOPTI            TO PI-PRT-OPT
 12490     END-IF.
 12491
 12492     IF ALTPRTL GREATER ZERO
 12493         MOVE ALTPRTI            TO PI-ALT-PRT
 12494     END-IF.
 12495
 12496     MOVE LOW-VALUES             TO EL130AI.
 12497
 12498     MOVE PI-LAST-CERT-PRIME     TO CERTNOO.
 12499     MOVE PI-LAST-CERT-SUFX      TO SUFXO.
 12500     MOVE PI-LAST-CARR           TO CLMCARRO.
 12501     MOVE PI-LAST-CLAIM          TO CLMNOO.
 12502
 12503     IF PI-PRT-OPT = 'N' OR 'L'
 12504         MOVE PI-PRT-OPT         TO PRTOPTO
 12505         MOVE 1                  TO PRTOPTL
 12506     END-IF.
 12507
 12508     IF PI-ALT-PRT NOT = SPACES AND LOW-VALUES
 12509         MOVE PI-ALT-PRT         TO ALTPRTO
 12510         MOVE 4                  TO ALTPRTL
 12511     END-IF.
 12512
 12513     MOVE AL-UANON               TO CLMNOA CLMCARRA.
 12514     MOVE AL-SANON               TO CERTNOA SUFXA.
 12515
 12516     MOVE SPACES                 TO PI-INCURR-SW.
 12517
 12518     IF PRTOPTL GREATER ZERO
 12519         IF PRTOPTI = 'L'
 12520             GO TO 0400-CREATE-ELACTQ
 12521         ELSE
 12522             GO TO 0480-PRINT-NOW
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 235
* EL130.cbl
 12523         END-IF
 12524     END-IF.
 12525
 12526     GO TO 8100-SEND-INITIAL-MAP.
 12527
 12528 5050-CERT-NOT-FOUND.
 12529
 12530     MOVE ER-0244                TO EMI-ERROR.
 12531     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12532     MOVE -1                     TO CERTNOL.
 12533     GO TO 8200-SEND-DATAONLY.
 12534
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 236
* EL130.cbl
 12536 5500-BUILD-FORM-TRAILER.
 12537*************************************************************
 12538*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12539*************************************************************
 12540
 12541     MOVE WS-TODAY-DT            TO SAVE-SEND-DT.
 12542
 12543     IF  WS-BEN-ALPHA-2 = '30'
 12544         MOVE WS-TODAY-DT        TO DC-BIN-DATE-1
 12545         MOVE '6'                TO DC-OPTION-CODE
 12546         IF CL-CARRIER = 'C'
 12547             MOVE +14            TO DC-ELAPSED-DAYS
 12548             MOVE +0             TO DC-ELAPSED-MONTHS
 12549             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12550             MOVE DC-BIN-DATE-2  TO SAVE-SEND-DT
 12551         ELSE
 12552             MOVE +21            TO DC-ELAPSED-DAYS
 12553             MOVE +0             TO DC-ELAPSED-MONTHS
 12554             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12555             MOVE DC-BIN-DATE-2      TO  SAVE-SEND-DT
 12556         END-IF
 12557     END-IF.
 12558
 12559
 12560
 12561* EXEC CICS GETMAIN
 12562*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 12563*         LENGTH   (ELTRLR-LENGTH)
 12564*         INITIMG  (GETMAIN-SPACE)
 12565*    END-EXEC.
 12566*    MOVE ',"IL                  $   #00011499' TO DFHEIV0
 12567     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12568     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12569     MOVE X'2020233030303131343939' TO DFHEIV0(25:11)
 12570     CALL 'kxdfhei1' USING DFHEIV0,
 12571           DFHEIV20,
 12572           ELTRLR-LENGTH,
 12573           GETMAIN-SPACE
 12574     SET ADDRESS OF ACTIVITY-TRAILERS TO
 12575         DFHEIV20
 12576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12577
 12578
 12579     MOVE SAVE-AT-PRIMARY-KEY    TO AT-CONTROL-PRIMARY.
 12580     MOVE 'AT'                   TO AT-RECORD-ID.
 12581
 12582     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 12583     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 12584     MOVE 'A'                    TO AT-TRAILER-TYPE.
 12585     MOVE WS-TODAY-DT            TO AT-RECORDED-DT
 12586                                    AT-FORM-LAST-MAINT-DT.
 12587     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 12588                                    AT-FORM-LAST-UPDATED-BY.
 12589     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 12590     MOVE SAVE-SEND-DT           TO AT-FORM-SEND-ON-DT.
 12591     MOVE LOW-VALUES             TO AT-FORM-FOLLOW-UP-DT
 12592                                    AT-FORM-RE-SEND-DT
 12593                                    AT-FORM-ANSWERED-DT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 237
* EL130.cbl
 12594                                    AT-EMP-FORM-ANSWERED-DT
 12595                                    AT-PHY-FORM-ANSWERED-DT
 12596                                    AT-EMP-FORM-SEND-ON-DT
 12597                                    AT-FORM-PRINTED-DT
 12598                                    AT-FORM-REPRINT-DT.
 12599     MOVE '1'                    TO AT-FORM-TYPE.
 12600
 12601     MOVE SPACES                 TO AT-INSTRUCT-LN-1
 12602                                    AT-INSTRUCT-LN-2
 12603                                    AT-INSTRUCT-LN-3.
 12604
 12605     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 12606     MOVE 'I'                    TO AT-FORM-ADDRESS.
 12607
 12608     MOVE SAVE-SEND-DT           TO AT-PHY-FORM-SEND-ON-DT.
 12609
 12610     IF AM-EMPLOYER-STMT-USED = 'Y'
 12611        MOVE SAVE-SEND-DT       TO AT-EMP-FORM-SEND-ON-DT
 12612     END-IF.
 12613
 12614
 12615
 12616* EXEC CICS WRITE
 12617*         DATASET  (ELTRLR-DSID)
 12618*         FROM     (ACTIVITY-TRAILERS)
 12619*         RIDFLD   (AT-CONTROL-PRIMARY)
 12620*    END-EXEC.
 12621     MOVE LENGTH OF
 12622      ACTIVITY-TRAILERS
 12623       TO DFHEIV11
 12624*    MOVE '&$ L                  ''   #00011541' TO DFHEIV0
 12625     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12626     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12627     MOVE X'2020233030303131353431' TO DFHEIV0(25:11)
 12628     CALL 'kxdfhei1' USING DFHEIV0,
 12629           ELTRLR-DSID,
 12630           ACTIVITY-TRAILERS,
 12631           DFHEIV11,
 12632           AT-CONTROL-PRIMARY,
 12633           DFHEIV99,
 12634           DFHEIV99
 12635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12636
 12637
 12638 5599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 238
* EL130.cbl
 12640*************************************************************
 12641*           THIS CODE IS FOR 'CRI' ONLY         04/18/88
 12642*************************************************************
 12643
 12644 5700-BUILD-ARCHIVE-HEADER.
 12645
 12646     MOVE '1'                    TO CNTL-REC-TYPE.
 12647     MOVE ZEROS                  TO CNTL-SEQ-NO.
 12648     MOVE SPACES                 TO CNTL-ACCESS.
 12649
 12650
 12651
 12652* EXEC CICS READ
 12653*         DATASET  (ELCNTL-DSID)
 12654*         SET      (ADDRESS OF CONTROL-FILE)
 12655*         RIDFLD   (ELCNTL-KEY)
 12656*         UPDATE
 12657*    END-EXEC.
 12658*    MOVE '&"S        EU         (   #00011560' TO DFHEIV0
 12659     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12660     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12661     MOVE X'2020233030303131353630' TO DFHEIV0(25:11)
 12662     CALL 'kxdfhei1' USING DFHEIV0,
 12663           ELCNTL-DSID,
 12664           DFHEIV20,
 12665           DFHEIV99,
 12666           ELCNTL-KEY,
 12667           DFHEIV99,
 12668           DFHEIV99,
 12669           DFHEIV99
 12670     SET ADDRESS OF CONTROL-FILE TO
 12671         DFHEIV20
 12672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12673
 12674
 12675     ADD 1 TO CF-CO-ARCHIVE-COUNTER.
 12676
 12677     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 12678
 12679
 12680
 12681* EXEC CICS REWRITE
 12682*         FROM     (CONTROL-FILE)
 12683*         DATASET  (ELCNTL-DSID)
 12684*    END-EXEC.
 12685     MOVE LENGTH OF
 12686      CONTROL-FILE
 12687       TO DFHEIV11
 12688*    MOVE '&& L                  %   #00011572' TO DFHEIV0
 12689     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12690     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12691     MOVE X'2020233030303131353732' TO DFHEIV0(25:11)
 12692     CALL 'kxdfhei1' USING DFHEIV0,
 12693           ELCNTL-DSID,
 12694           CONTROL-FILE,
 12695           DFHEIV11,
 12696           DFHEIV99
 12697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 239
* EL130.cbl
 12698
 12699
 12700
 12701
 12702* EXEC CICS HANDLE CONDITION
 12703*         NOTOPEN  (9990-ABEND)
 12704*         DUPKEY   (5799-EXIT)
 12705*    END-EXEC.
 12706*    MOVE '"$J$                  ! ? #00011578' TO DFHEIV0
 12707     MOVE X'22244A242020202020202020' TO DFHEIV0(1:12)
 12708     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12709     MOVE X'3F20233030303131353738' TO DFHEIV0(25:11)
 12710     CALL 'kxdfhei1' USING DFHEIV0
 12711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12712
 12713
 12714
 12715
 12716* EXEC CICS GETMAIN
 12717*         SET     (ADDRESS OF LETTER-ARCHIVE)
 12718*         LENGTH  (ELARCH-LENGTH)
 12719*    END-EXEC.
 12720*    MOVE '," L                  $   #00011584' TO DFHEIV0
 12721     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 12722     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12723     MOVE X'2020233030303131353834' TO DFHEIV0(25:11)
 12724     CALL 'kxdfhei1' USING DFHEIV0,
 12725           DFHEIV20,
 12726           ELARCH-LENGTH,
 12727           DFHEIV99
 12728     SET ADDRESS OF LETTER-ARCHIVE TO
 12729         DFHEIV20
 12730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12731
 12732
 12733     MOVE SPACES                 TO LETTER-ARCHIVE.
 12734     MOVE 'LA'                   TO LA-RECORD-ID.
 12735     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 12736                                    LA-ARCHIVE-NO-A1.
 12737     MOVE '4'                    TO LA-RECORD-TYPE
 12738                                    LA-RECORD-TYPE-A1.
 12739     MOVE ZEROS                  TO LA-LINE-SEQ-NO
 12740                                    LA-LINE-SEQ-NO-A1.
 12741     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 12742                                    LA-COMPANY-CD-A1.
 12743     MOVE CL-CARRIER             TO LA4-CARRIER.
 12744     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 12745     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 12746     MOVE CL-CERT-STATE          TO LA4-STATE.
 12747     MOVE  ZEROS                 TO LA4-NO-OF-COPIES.
 12748     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 12749     MOVE WS-TODAY-DT            TO LA4-CREATION-DT.
 12750     MOVE LOW-VALUES             TO LA4-INITIAL-PRINT-DATE
 12751                                    LA4-RESEND-PRINT-DATE
 12752                                    LA4-FORM-REM-PRINT-DT
 12753                                    LA4-RESEND-DATE.
 12754     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 12755     MOVE '1'                    TO LA4-FORM-TYPE.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 240
* EL130.cbl
 12756
 12757
 12758
 12759* EXEC CICS WRITE
 12760*         DATASET  (ELARCH-DSID)
 12761*         FROM     (LETTER-ARCHIVE)
 12762*         RIDFLD   (LA-CONTROL-PRIMARY)
 12763*    END-EXEC.
 12764     MOVE LENGTH OF
 12765      LETTER-ARCHIVE
 12766       TO DFHEIV11
 12767*    MOVE '&$ L                  ''   #00011614' TO DFHEIV0
 12768     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12769     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12770     MOVE X'2020233030303131363134' TO DFHEIV0(25:11)
 12771     CALL 'kxdfhei1' USING DFHEIV0,
 12772           ELARCH-DSID,
 12773           LETTER-ARCHIVE,
 12774           DFHEIV11,
 12775           LA-CONTROL-PRIMARY,
 12776           DFHEIV99,
 12777           DFHEIV99
 12778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12779
 12780
 12781 5799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 241
* EL130.cbl
 12783 6000-EDIT-CLAIM-DATA.
 12784
 12785     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 12786     MOVE '2'                    TO DC-OPTION-CODE.
 12787     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12788     MOVE DC-BIN-DATE-1          TO WS-TODAY-DT.
 12789
 12790     IF MAINTL NOT = ZERO
 12791         MOVE AL-UANON           TO MAINTA
 12792     END-IF
 12793
 12794     IF CLMNOL GREATER ZERO
 12795         IF CLMNOI = SPACES OR LOW-VALUES
 12796             MOVE -1             TO CLMNOL
 12797             MOVE AL-UABON       TO CLMNOA
 12798             MOVE ER-7688        TO EMI-ERROR
 12799             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12800         ELSE
 12801             MOVE AL-UANON       TO CLMNOA
 12802         END-IF
 12803     END-IF.
 12804
 12805     IF CERTNOL = ZERO
 12806         MOVE -1                 TO CERTNOL
 12807         MOVE AL-SABON           TO CERTNOA
 12808         MOVE ER-0203            TO EMI-ERROR
 12809         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12810     ELSE
 12811         MOVE AL-SANON           TO CERTNOA
 12812     END-IF.
 12813
 12814     IF SUFXL = ZERO
 12815         MOVE SPACES             TO SUFXI
 12816         MOVE AL-SANON           TO SUFXA
 12817     ELSE
 12818         MOVE AL-SANON           TO SUFXA
 12819     END-IF.
 12820
 12821     IF CLMCARRL = ZERO
 12822         MOVE -1                 TO CLMCARRL
 12823         MOVE ER-0194            TO EMI-ERROR
 12824         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12825     ELSE
 12826         MOVE CLMCARRI           TO PI-CARRIER
 12827         IF PI-NO-CARRIER-SECURITY
 12828             MOVE AL-UANON       TO CLMCARRA
 12829         END-IF
 12830     END-IF.
 12831
 12832     IF CLMTYPEL > ZERO
 12833        IF ((PI-COMPANY-ID = 'DCC' OR 'VPP')
 12834           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12835              AND PI-AH-OVERRIDE-L1 AND 'I' AND 'G' AND 'F'))
 12836                        OR
 12837           ((PI-COMPANY-ID = 'CID' OR 'AHL')
 12838           AND (CLMTYPEI NOT = PI-LIFE-OVERRIDE-L1
 12839              AND PI-AH-OVERRIDE-L1))
 12840              MOVE -1             TO CLMTYPEL
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 242
* EL130.cbl
 12841              MOVE AL-UABON       TO CLMTYPEA
 12842              MOVE ER-7634        TO EMI-ERROR
 12843              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12844        ELSE
 12845           MOVE AL-UANON       TO CLMTYPEA
 12846        END-IF
 12847     ELSE
 12848        IF MAINTI = 'A'
 12849           MOVE -1             TO CLMTYPEL
 12850           MOVE AL-UABON       TO CLMTYPEA
 12851           MOVE ER-0546        TO EMI-ERROR
 12852           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12853        END-IF
 12854     END-IF
 12855     if instypel > ZERO
 12856        if instypei = 'P' OR 'C'
 12857           move al-uanon         to instypea
 12858        else
 12859           MOVE -1               TO INSTYPEL
 12860           MOVE AL-UABON         TO INSTYPEA
 12861           MOVE ER-1654          TO EMI-ERROR
 12862           PERFORM 9900-ERROR-FORMAT
 12863                                 THRU 9900-EXIT
 12864        END-IF
 12865     ELSE
 12866        IF MAINTI = 'A'
 12867           MOVE -1               TO INSTYPEL
 12868           MOVE AL-UABON         TO INSTYPEA
 12869           MOVE ER-1654          TO EMI-ERROR
 12870           PERFORM 9900-ERROR-FORMAT
 12871                                 THRU 9900-EXIT
 12872        END-IF
 12873     END-IF
 12874     if (instypel <> zeros)
 12875        and (emi-error not = er-1654)
 12876        and (instypei = 'C')
 12877        and (crtfnmei = fstnmei)
 12878        move er-1675             to emi-error
 12879        MOVE -1                  TO INSTYPEL
 12880        MOVE AL-UABON            TO INSTYPEA
 12881        PERFORM 9900-ERROR-FORMAT
 12882                                 THRU 9900-EXIT
 12883    end-if
 12884     if (instypel <> zeros)
 12885        and (emi-error not = er-1654)
 12886        and (instypei = 'P')
 12887        and (crtfnmei <> fstnmei)
 12888        move er-1676             to emi-error
 12889        MOVE -1                  TO INSTYPEL
 12890        MOVE AL-UABON            TO INSTYPEA
 12891        PERFORM 9900-ERROR-FORMAT
 12892                                 THRU 9900-EXIT
 12893    end-if
 12894     IF PCERTNOL = ZERO
 12895        MOVE CERTNOI             TO PCERTNOI
 12896        MOVE CERTNOL             TO PCERTNOL
 12897        MOVE AL-UANON            TO PCERTNOA
 12898     ELSE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 243
* EL130.cbl
 12899        MOVE AL-UANON            TO PCERTNOA
 12900     END-IF.
 12901
 12902     IF PSUFXL = ZERO
 12903        MOVE SUFXI               TO PSUFXI
 12904        MOVE SUFXL               TO PSUFXL
 12905        MOVE AL-UANON            TO PSUFXA
 12906     ELSE
 12907        MOVE AL-UANON            TO PSUFXA
 12908     END-IF.
 12909
 12910     IF MAINTI = 'I'
 12911         GO TO 6020-EDIT
 12912     END-IF.
 12913
 12914     IF LSTNMEL = ZERO AND CERTMTL NOT = ZEROS
 12915         MOVE -1                 TO LSTNMEL
 12916         MOVE ER-0236            TO EMI-ERROR
 12917         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12918     ELSE
 12919         MOVE AL-UANON           TO LSTNMEA
 12920     END-IF.
 12921     if fstnmel not = zeros
 12922        move al-uanon            to fstnmea
 12923     end-if
 12924     IF SEXL > ZEROS
 12925        IF SEXI = 'M' OR 'F'
 12926           move al-uanon         to sexa
 12927           CONTINUE
 12928        ELSE
 12929           MOVE -1               TO SEXL
 12930           MOVE AL-UABON         TO SEXA
 12931           MOVE ER-0219          TO EMI-ERROR
 12932           PERFORM 9900-ERROR-FORMAT
 12933                                 THRU 9900-EXIT
 12934        END-IF
 12935     ELSE
 12936        IF MAINTI = 'A'
 12937           MOVE -1               TO SEXL
 12938           MOVE AL-UABON         TO SEXA
 12939           MOVE ER-0219          TO EMI-ERROR
 12940           PERFORM 9900-ERROR-FORMAT
 12941                                 THRU 9900-EXIT
 12942        END-IF
 12943     END-IF
 12944     IF SSNL GREATER THAN ZERO
 12945         MOVE SSNI TO WS-SOC-SEC-NUMBER
 12946         IF WS-SOC-SEC-NO NUMERIC AND
 12947           (WS-SOC-SEC-BLANK = SPACES OR LOW-VALUES)
 12948             NEXT SENTENCE
 12949         ELSE
 12950            IF WS-SSN-1-3 NUMERIC AND WS-SSN-4-5 NUMERIC AND
 12951               WS-SSN-6-9 NUMERIC AND WS-SSN-DASH1 = '-' AND
 12952               WS-SSN-DASH2 = '-'
 12953                 NEXT SENTENCE
 12954            ELSE
 12955                 MOVE ER-0887        TO  EMI-ERROR
 12956                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 244
* EL130.cbl
 12957                 MOVE AL-UABON       TO  SSNA
 12958                 MOVE -1             TO  SSNL
 12959            END-IF
 12960        END-IF
 12961     END-IF.
 12962
 12963     IF BIRTHDTL = ZERO
 12964         GO TO 6020-EDIT
 12965     END-IF.
 12966
 12967     IF BIRTHDTL GREATER ZERO
 12968         MOVE BIRTHDTI           TO DATE-WORK
 12969         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12970         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 12971         MOVE '4'                TO DC-OPTION-CODE
 12972         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12973         IF DATE-CONVERSION-ERROR
 12974             MOVE AL-UABON       TO BIRTHDTA
 12975             MOVE -1             TO BIRTHDTL
 12976             MOVE ER-0220        TO EMI-ERROR
 12977             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12978             GO TO 6020-EDIT
 12979         END-IF
 12980     END-IF.
 12981
 12982******************************************************************
 12983**   IF CALCULATED BIRTH DATE GREATER THAN TODAYS DATE          **
 12984**   USE THE CENTURY ADJUSTMENT SWITCH IN THE DATE ROUTINE      **
 12985**   TO SUBTRACT 100 YEARS TO OBTAIN THE CORRECT BIRTH DATE.    **
 12986******************************************************************
 12987
 12988     IF DC-BIN-DATE-1 GREATER THAN SAVE-BIN-DATE
 12989         MOVE BIRTHDTI           TO  DATE-WORK
 12990         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 12991         MOVE NUM-WORK           TO  DC-GREG-DATE-1-MDY
 12992         MOVE '4'                TO  DC-OPTION-CODE
 12993         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT
 12994         MOVE +0                 TO  DC-ELAPSED-MONTHS
 12995                                     DC-ELAPSED-DAYS
 12996         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12997         IF DATE-CONVERSION-ERROR
 12998             MOVE AL-UABON       TO  BIRTHDTA
 12999             MOVE -1             TO  BIRTHDTL
 13000             MOVE ER-0220        TO  EMI-ERROR
 13001             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13002             GO TO 6020-EDIT
 13003         END-IF
 13004     END-IF.
 13005
 13006     MOVE AL-UANON               TO  BIRTHDTA.
 13007     MOVE DC-GREG-DATE-1-EDIT    TO  BIRTHDTI.
 13008     MOVE DC-BIN-DATE-1          TO  WS-BIRTHDT.
 13009     MOVE ' '                    TO  DC-CENTURY-ADJUSTMENT.
 13010
 13011 6020-EDIT.
 13012     IF INCURL GREATER ZERO
 13013         MOVE INCURI             TO DATE-WORK
 13014         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 245
* EL130.cbl
 13015         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13016         MOVE '4'                TO DC-OPTION-CODE
 13017         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13018         IF DATE-CONVERSION-ERROR
 13019             MOVE AL-UABON       TO INCURA
 13020             MOVE -1             TO INCURL
 13021             MOVE ER-0222        TO EMI-ERROR
 13022             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13023         ELSE
 13024             MOVE AL-UANON       TO INCURA
 13025             MOVE DC-GREG-DATE-1-EDIT  TO INCURI
 13026             MOVE DC-BIN-DATE-1  TO WS-INCUR
 13027                                    PI-SAVE-INCUR-DT
 13028             IF WS-INCUR GREATER THAN WS-TODAY-DT
 13029                 MOVE ER-0511     TO EMI-ERROR
 13030                 MOVE -1          TO INCURL
 13031                 MOVE AL-UABON    TO INCURA
 13032                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13033             ELSE
 13034*                NEXT SENTENCE
 13035                 CONTINUE
 13036             END-IF
 13037         END-IF
 13038     ELSE
 13039         MOVE ER-0516         TO EMI-ERROR
 13040         MOVE AL-UABON        TO INCURA
 13041         MOVE -1              TO INCURL
 13042         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13043     END-IF.
 13044
 13045     IF REPORTL GREATER ZERO
 13046         MOVE REPORTI            TO DATE-WORK
 13047         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13048         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13049         MOVE '4'                TO DC-OPTION-CODE
 13050         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13051         IF DATE-CONVERSION-ERROR
 13052             MOVE AL-UABON       TO REPORTA
 13053             MOVE -1             TO REPORTL
 13054             MOVE ER-0223        TO EMI-ERROR
 13055             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13056         ELSE
 13057             MOVE AL-UANON       TO REPORTA
 13058             MOVE DC-GREG-DATE-1-EDIT  TO REPORTI
 13059             MOVE DC-BIN-DATE-1  TO WS-REPORT
 13060             IF WS-REPORT GREATER THAN WS-TODAY-DT
 13061                 MOVE ER-0512     TO EMI-ERROR
 13062                 MOVE -1          TO REPORTL
 13063                 MOVE AL-UABON    TO REPORTA
 13064                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13065             ELSE
 13066*                NEXT SENTENCE
 13067                 CONTINUE
 13068             END-IF
 13069         END-IF
 13070     ELSE
 13071         MOVE ER-0517         TO EMI-ERROR
 13072         MOVE -1              TO REPORTL
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 246
* EL130.cbl
 13073         MOVE AL-UABON        TO REPORTA
 13074         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13075     END-IF.
 13076
 13077     IF WS-REPORT NOT = LOW-VALUES
 13078         IF WS-INCUR GREATER THAN WS-REPORT
 13079             MOVE AL-UABON       TO REPORTA
 13080             MOVE -1             TO REPORTL
 13081             MOVE ER-0509        TO EMI-ERROR
 13082             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13083         END-IF
 13084     END-IF.
 13085
 13086     IF ICD1L GREATER THAN ZERO
 13087         IF (ICD1I GREATER THAN SPACES) AND
 13088            (ICD1I(4:1) NOT = '.')
 13089             IF ICD1I(4:1) = ' '
 13090                 MOVE '.' TO ICD1I(4:1)
 13091             ELSE
 13092                 IF ICD1I(8:1) = ' '
 13093                     MOVE ICD1I(7:1) TO ICD1I(8:1)
 13094                     MOVE ICD1I(6:1) TO ICD1I(7:1)
 13095                     MOVE ICD1I(5:1) TO ICD1I(6:1)
 13096                     MOVE ICD1I(4:1) TO ICD1I(5:1)
 13097                     MOVE '.'        TO ICD1I(4:1)
 13098                 END-IF
 13099             END-IF
 13100         END-IF
 13101         IF (ICD1I GREATER THAN SPACES) AND
 13102            (ICD1I(1:1) NOT > ' ' OR
 13103             ICD1I(2:1) NOT > ' ' OR
 13104             ICD1I(3:1) NOT > ' ' OR
 13105             ICD1I(4:1) NOT = '.')
 13106              MOVE ER-0992        TO  EMI-ERROR
 13107              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13108              MOVE AL-UABON       TO ICD1A
 13109              MOVE -1             TO ICD1L
 13110         END-IF
 13111     END-IF.
 13112
 13113     IF ICD2L GREATER THAN ZERO
 13114         IF (ICD2I GREATER THAN SPACES) AND
 13115            (ICD2I(4:1) NOT = '.')
 13116             IF ICD2I(4:1) = ' '
 13117                 MOVE '.' TO ICD2I(4:1)
 13118             ELSE
 13119                 IF ICD2I(8:1) = ' '
 13120                     MOVE ICD2I(7:1) TO ICD2I(8:1)
 13121                     MOVE ICD2I(6:1) TO ICD2I(7:1)
 13122                     MOVE ICD2I(5:1) TO ICD2I(6:1)
 13123                     MOVE ICD2I(4:1) TO ICD2I(5:1)
 13124                     MOVE '.'        TO ICD2I(4:1)
 13125                 END-IF
 13126             END-IF
 13127         END-IF
 13128         IF (ICD2I GREATER THAN SPACES) AND
 13129            (ICD2I(1:1) NOT > ' ' OR
 13130             ICD2I(2:1) NOT > ' ' OR
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 247
* EL130.cbl
 13131             ICD2I(3:1) NOT > ' ' OR
 13132             ICD2I(4:1) NOT = '.')
 13133              MOVE ER-0992        TO  EMI-ERROR
 13134              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13135              MOVE AL-UABON       TO ICD2A
 13136              MOVE -1             TO ICD2L
 13137         END-IF
 13138     END-IF
 13139
 13140*    IF ESTENDL GREATER ZERO
 13141*        MOVE ESTENDI            TO DATE-WORK
 13142*        PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13143*        MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13144*        MOVE '4'                TO DC-OPTION-CODE
 13145*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13146*        IF DATE-CONVERSION-ERROR
 13147*            MOVE AL-UABON       TO ESTENDA
 13148*            MOVE -1             TO ESTENDL
 13149*            MOVE ER-0224        TO EMI-ERROR
 13150*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13151*        ELSE
 13152*            MOVE AL-UANON       TO ESTENDA
 13153*            MOVE DC-GREG-DATE-1-EDIT  TO ESTENDI
 13154*            MOVE DC-BIN-DATE-1  TO WS-ESTEND
 13155*            IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 13156*               MOVE AL-UABON    TO ESTENDA
 13157*               MOVE -1          TO ESTENDL
 13158*               MOVE ER-0544     TO EMI-ERROR
 13159*               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13160*            END-IF
 13161*        END-IF
 13162*    END-IF.
 13163*
 13164*    IF WS-ESTEND NOT = LOW-VALUES
 13165*        IF WS-INCUR GREATER THAN WS-ESTEND
 13166*            MOVE AL-UABON       TO ESTENDA
 13167*            MOVE -1             TO ESTENDL
 13168*            MOVE ER-0510        TO EMI-ERROR
 13169*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13170*        END-IF
 13171*    END-IF.
 13172
 13173     IF PRTOPTL GREATER ZERO
 13174         IF PRTOPTI NOT = 'N' AND 'L'
 13175             MOVE AL-UABON       TO PRTOPTA
 13176             MOVE -1             TO PRTOPTL
 13177             MOVE ER-0334        TO EMI-ERROR
 13178             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13179         END-IF
 13180     END-IF.
 13181
 13182     IF MANRSVL GREATER ZERO
 13183
 13184* EXEC CICS BIF DEEDIT
 13185*            FIELD   (MANRSVI)
 13186*            LENGTH  (9)
 13187*        END-EXEC
 13188     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 248
* EL130.cbl
 13189       TO DFHEIV11
 13190*    MOVE '@"L                   #   #00012022' TO DFHEIV0
 13191     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13192     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13193     MOVE X'2020233030303132303232' TO DFHEIV0(25:11)
 13194     CALL 'kxdfhei1' USING DFHEIV0,
 13195           MANRSVI,
 13196           DFHEIV11
 13197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13198         IF MANRSVI NOT NUMERIC
 13199             MOVE AL-UNBON       TO MANRSVA
 13200             MOVE -1             TO MANRSVL
 13201             MOVE ER-0489        TO EMI-ERROR
 13202             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13203         ELSE
 13204             MOVE AL-UNNON       TO MANRSVA
 13205             MOVE MANRSVI        TO WS-MANRSV  MANRSVO
 13206         END-IF
 13207     END-IF.
 13208
 13209     MOVE SPACES                 TO ELCNTL-KEY.
 13210
 13211     IF CONTROL-IS-ACTUAL-CARRIER
 13212         MOVE PI-CARRIER         TO CNTL-CARRIER
 13213     ELSE
 13214         MOVE PI-CARRIER-CONTROL-LEVEL TO CNTL-CARRIER
 13215     END-IF.
 13216
 13217     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13218     MOVE '6'                    TO CNTL-REC-TYPE.
 13219     MOVE +0                     TO CNTL-SEQ-NO.
 13220
 13221
 13222
 13223* EXEC CICS HANDLE CONDITION
 13224*        NOTFND   (3100-CARRIER-NOT-FOUND)
 13225*    END-EXEC.
 13226*    MOVE '"$I                   ! @ #00012050' TO DFHEIV0
 13227     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13228     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13229     MOVE X'4020233030303132303530' TO DFHEIV0(25:11)
 13230     CALL 'kxdfhei1' USING DFHEIV0
 13231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13232
 13233
 13234     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13235
 13236     IF NOT CF-MANUAL-RESERVES-USED AND
 13237           WS-MANRSV GREATER ZERO
 13238         MOVE ER-0518             TO EMI-ERROR
 13239         MOVE -1                  TO MANRSVL
 13240         MOVE AL-UNBON            TO MANRSVA
 13241         MOVE ZEROS               TO WS-MANRSV
 13242         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13243     END-IF.
 13244
 13245     MOVE CF-RESERVE-CONTROLS    TO WS-RESERVE-CONTROLS.
 13246     MOVE CF-EXPENSE-CONTROLS    TO WS-EXPENSE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 249
* EL130.cbl
 13247
 13248     IF SUPVL GREATER ZERO
 13249         IF SUPVI NOT = ' ' AND 'Y' AND 'N'
 13250             MOVE -1             TO SUPVL
 13251             MOVE AL-UABON       TO SUPVA
 13252             MOVE ER-0230        TO EMI-ERROR
 13253             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13254         ELSE
 13255             MOVE AL-UANON       TO SUPVA
 13256         END-IF
 13257     END-IF.
 13258
 13259     IF PROCCDL = ZERO
 13260        GO TO 6050-CONTINUE-EDITS
 13261     END-IF.
 13262
 13263     MOVE SPACES                 TO ELCNTL-KEY.
 13264     MOVE PROCCDI                TO CNTL-ACCESS.
 13265
 13266     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 13267     MOVE '2'                    TO CNTL-REC-TYPE.
 13268     MOVE +0                     TO CNTL-SEQ-NO.
 13269
 13270
 13271
 13272* EXEC CICS HANDLE CONDITION
 13273*        NOTFND   (6040-NO-PROCESSOR-RECORD)
 13274*    END-EXEC.
 13275*    MOVE '"$I                   ! A #00012091' TO DFHEIV0
 13276     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13277     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13278     MOVE X'4120233030303132303931' TO DFHEIV0(25:11)
 13279     CALL 'kxdfhei1' USING DFHEIV0
 13280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13281
 13282
 13283     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 13284
 13285     GO TO 6050-CONTINUE-EDITS.
 13286
 13287 6040-NO-PROCESSOR-RECORD.
 13288     MOVE ER-0019                TO EMI-ERROR.
 13289     MOVE -1                     TO PROCCDL.
 13290     MOVE AL-UABON               TO PROCCDA.
 13291     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13292
 13293 6050-CONTINUE-EDITS.
 13294     IF (BENECDL = ZERO) OR (BENECDI = SPACES OR LOW-VALUES)
 13295           GO TO 6070-CONTINUE-EDITS
 13296     END-IF.
 13297
 13298     MOVE BENECDI                TO BENE-CODE.
 13299     MOVE 'B'                    TO BENE-RCD-TYPE.
 13300     MOVE PI-COMPANY-CD          TO BENE-COMP-CD.
 13301
 13302
 13303
 13304* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 250
* EL130.cbl
 13305*        NOTFND   (6060-NO-BENEFICIARY-RECORD)
 13306*    END-EXEC.
 13307*    MOVE '"$I                   ! B #00012115' TO DFHEIV0
 13308     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13310     MOVE X'4220233030303132313135' TO DFHEIV0(25:11)
 13311     CALL 'kxdfhei1' USING DFHEIV0
 13312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13313
 13314
 13315
 13316* EXEC CICS READ
 13317*         DATASET   (ELBENE-DSID)
 13318*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 13319*         RIDFLD    (ELBENE-KEY)
 13320*    END-EXEC.
 13321*    MOVE '&"S        E          (   #00012119' TO DFHEIV0
 13322     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13323     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13324     MOVE X'2020233030303132313139' TO DFHEIV0(25:11)
 13325     CALL 'kxdfhei1' USING DFHEIV0,
 13326           ELBENE-DSID,
 13327           DFHEIV20,
 13328           DFHEIV99,
 13329           ELBENE-KEY,
 13330           DFHEIV99,
 13331           DFHEIV99,
 13332           DFHEIV99
 13333     SET ADDRESS OF BENEFICIARY-MASTER TO
 13334         DFHEIV20
 13335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13336
 13337
 13338     GO TO 6070-CONTINUE-EDITS.
 13339
 13340 6060-NO-BENEFICIARY-RECORD.
 13341     MOVE ER-0565                TO EMI-ERROR.
 13342     MOVE -1                     TO BENECDL.
 13343     MOVE AL-UABON               TO BENECDA.
 13344     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13345
 13346
 13347 6070-CONTINUE-EDITS.
 13348     IF CERTMTL GREATER ZERO
 13349         IF CERTMTI NOT = 'A' AND 'S'
 13350             MOVE -1             TO CERTMTL
 13351             MOVE AL-UABON       TO CERTMTA
 13352             MOVE ER-0267        TO EMI-ERROR
 13353             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13354         ELSE
 13355             MOVE AL-UANON       TO CERTMTA
 13356         END-IF
 13357     ELSE
 13358         GO TO 6000-EXIT
 13359     END-IF.
 13360
 13361     IF EFFDTL GREATER ZERO
 13362         MOVE EFFDTI             TO DATE-WORK
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 251
* EL130.cbl
 13363         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13364         MOVE NUM-WORK           TO DC-GREG-DATE-1-MDY
 13365         MOVE '4'                TO DC-OPTION-CODE
 13366         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13367         IF DATE-CONVERSION-ERROR
 13368             MOVE AL-UABON       TO EFFDTA
 13369             MOVE -1             TO EFFDTL
 13370             MOVE ER-0231        TO EMI-ERROR
 13371             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13372         ELSE
 13373             MOVE AL-UANON       TO EFFDTA
 13374             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
 13375             MOVE DC-BIN-DATE-1  TO WS-EFFDT
 13376         END-IF
 13377     ELSE
 13378         MOVE ER-0231            TO EMI-ERROR
 13379         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13380         MOVE -1                 TO EFFDTL
 13381         MOVE AL-UABON           TO EFFDTA
 13382     END-IF.
 13383
 13384     IF ACCOUNTL = ZERO
 13385         MOVE ER-0232            TO EMI-ERROR
 13386         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13387         MOVE AL-UABON           TO ACCOUNTA
 13388         MOVE -1                 TO ACCOUNTL
 13389     ELSE
 13390         MOVE AL-UANON           TO ACCOUNTA
 13391     END-IF.
 13392
 13393     IF (PI-CERT-ACCESS-CONTROL = ' ' OR '1' OR '2')  AND
 13394        (STATEL = ZERO)
 13395         MOVE ER-0233        TO EMI-ERROR
 13396         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13397         MOVE AL-UABON       TO STATEA
 13398         MOVE -1             TO STATEL
 13399     ELSE
 13400         MOVE AL-UANON       TO STATEA
 13401     END-IF.
 13402
 13403     IF (PI-CERT-ACCESS-CONTROL = '1' OR '2' OR '4') AND
 13404        (CRTCARRL = ZERO)
 13405         MOVE ER-0234        TO EMI-ERROR
 13406         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13407         MOVE AL-UABON       TO CRTCARRA
 13408         MOVE -1             TO CRTCARRL
 13409     ELSE
 13410         MOVE AL-UANON       TO CRTCARRA
 13411     END-IF.
 13412
 13413     IF PI-CERT-ACCESS-CONTROL = '1' AND
 13414        GROUPL = ZERO
 13415         MOVE ER-0235            TO EMI-ERROR
 13416         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13417         MOVE AL-UABON           TO GROUPA
 13418         MOVE -1                 TO GROUPL
 13419     ELSE
 13420         MOVE AL-UANON           TO GROUPA
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 252
* EL130.cbl
 13421     END-IF.
 13422
 13423     IF CRTLNMEL = ZERO
 13424         IF LSTNMEI = SPACES OR LOW-VALUES
 13425             MOVE ER-0236            TO  EMI-ERROR
 13426             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13427             MOVE AL-UABON           TO  CRTLNMEA
 13428             MOVE -1                 TO  CRTLNMEL
 13429         ELSE
 13430             MOVE LSTNMEI            TO  CRTLNMEI
 13431             MOVE AL-UANON           TO  CRTLNMEA
 13432         END-IF
 13433     ELSE
 13434         MOVE AL-UANON               TO  CRTLNMEA
 13435     END-IF.
 13436
 13437     IF CRTFNMEL = ZERO
 13438         IF FSTNMEI = SPACES OR LOW-VALUES
 13439*            NEXT SENTENCE
 13440             CONTINUE
 13441         ELSE
 13442             MOVE FSTNMEI            TO  CRTFNMEI
 13443             MOVE AL-UANON           TO  CRTFNMEA
 13444         END-IF
 13445     END-IF.
 13446
 13447     IF CRTINITL = ZERO
 13448         IF INITI = SPACES OR LOW-VALUES
 13449*            NEXT SENTENCE
 13450             CONTINUE
 13451         ELSE
 13452             MOVE INITI              TO  CRTINITI
 13453             MOVE AL-UANON           TO  CRTINITA
 13454         END-IF
 13455     END-IF.
 13456
 13457 6000-EXIT.
 13458     EXIT.
 13459
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 253
* EL130.cbl
 13461 6200-EDIT-CERT-DATA.
 13462     IF ISSAGEL GREATER ZERO
 13463         IF ISSAGEI NOT NUMERIC
 13464             MOVE ER-0237        TO EMI-ERROR
 13465             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13466             MOVE -1             TO ISSAGEL
 13467             MOVE AL-UNBON       TO ISSAGEA
 13468         ELSE
 13469             MOVE AL-UNNON       TO ISSAGEA
 13470         END-IF
 13471     END-IF.
 13472
 13473     IF JNTAGEL GREATER ZERO
 13474         IF JNTAGEI NOT NUMERIC
 13475             MOVE ER-0238        TO EMI-ERROR
 13476             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13477             MOVE -1             TO JNTAGEL
 13478             MOVE AL-UNBON       TO JNTAGEA
 13479         ELSE
 13480             MOVE AL-UNNON       TO JNTAGEA
 13481         END-IF
 13482     END-IF.
 13483
 13484     IF LCVCDL GREATER ZERO
 13485         MOVE LCVCDI             TO WS-EDIT-BEN-CODE
 13486         IF INVALID-BENEFIT-CODE
 13487             MOVE ER-7635        TO EMI-ERROR
 13488             MOVE -1             TO LCVCDL
 13489             MOVE AL-UABON       TO LCVCDA
 13490             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13491         ELSE
 13492             MOVE LCVCDI         TO WS-BEN-HOLD
 13493             MOVE '4'            TO WS-REC-TYPE
 13494             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13495             IF WS-BEN-ALPHA-HOLD = SPACES
 13496                MOVE ER-7635     TO EMI-ERROR
 13497                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13498                MOVE -1          TO LCVCDL
 13499                MOVE AL-UABON    TO LCVCDA
 13500             ELSE
 13501                MOVE WS-BEN-ALPHA-HOLD  TO LCVKINDO
 13502                MOVE WS-EARNINGS-CALC   TO WS-LF-EARNINGS-CALC
 13503                MOVE WS-SPECIAL-CALC-CD TO WS-LF-SPECIAL-CALC-CD
 13504                MOVE AL-UANON           TO LCVCDA
 13505             END-IF
 13506         END-IF
 13507     END-IF.
 13508
 13509     IF ACVCDL GREATER ZERO
 13510         MOVE ACVCDI             TO WS-EDIT-BEN-CODE
 13511         IF INVALID-BENEFIT-CODE
 13512             MOVE ER-7635        TO EMI-ERROR
 13513             MOVE -1             TO ACVCDL
 13514             MOVE AL-UABON       TO ACVCDA
 13515             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13516         ELSE
 13517             MOVE ACVCDI         TO WS-BEN-HOLD
 13518             MOVE '5'            TO WS-REC-TYPE
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 254
* EL130.cbl
 13519             PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
 13520             IF WS-BEN-ALPHA-HOLD = SPACES
 13521                MOVE ER-7635     TO EMI-ERROR
 13522                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13523                MOVE -1          TO ACVCDL
 13524                MOVE AL-UABON    TO ACVCDA
 13525             ELSE
 13526                MOVE WS-BEN-ALPHA-HOLD  TO ACVKINDO
 13527                MOVE WS-EARNINGS-CALC   TO WS-AH-EARNINGS-CALC
 13528                MOVE WS-SPECIAL-CALC-CD TO WS-AH-SPECIAL-CALC-CD
 13529                MOVE AL-UANON           TO ACVCDA
 13530             END-IF
 13531         END-IF
 13532     END-IF.
 13533
 13534     IF LCVOTRML GREATER ZERO
 13535         IF LCVOTRMI NOT NUMERIC
 13536             MOVE ER-7636        TO EMI-ERROR
 13537             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13538             MOVE -1             TO LCVOTRML
 13539             MOVE AL-UNBON       TO LCVOTRMA
 13540         ELSE
 13541             MOVE AL-UNNON       TO LCVOTRMA
 13542         END-IF
 13543     END-IF.
 13544
 13545     IF ACVOTRML GREATER ZERO
 13546         IF ACVOTRMI NOT NUMERIC
 13547             MOVE ER-7636        TO EMI-ERROR
 13548             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13549             MOVE -1             TO ACVOTRML
 13550             MOVE AL-UNBON       TO ACVOTRMA
 13551         ELSE
 13552             MOVE AL-UNNON       TO ACVOTRMA
 13553         END-IF
 13554     END-IF.
 13555
 13556     IF LCVRATEL GREATER ZERO
 13557
 13558* EXEC CICS BIF DEEDIT
 13559*            FIELD    (LCVRATEI)
 13560*            LENGTH   (06)
 13561*        END-EXEC
 13562     MOVE 06
 13563       TO DFHEIV11
 13564*    MOVE '@"L                   #   #00012344' TO DFHEIV0
 13565     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13566     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13567     MOVE X'2020233030303132333434' TO DFHEIV0(25:11)
 13568     CALL 'kxdfhei1' USING DFHEIV0,
 13569           LCVRATEI,
 13570           DFHEIV11
 13571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13572         IF LCVRATEI NOT NUMERIC
 13573             MOVE AL-UNBON       TO LCVRATEA
 13574             MOVE -1             TO LCVRATEL
 13575             MOVE ER-2280        TO EMI-ERROR
 13576             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 255
* EL130.cbl
 13577         ELSE
 13578             MOVE AL-UNNON       TO LCVRATEA
 13579             MOVE LCVRATEI       TO WS-LCVRATE LCVRATEO
 13580         END-IF
 13581     END-IF.
 13582
 13583     IF ACVRATEL GREATER ZERO
 13584
 13585* EXEC CICS BIF DEEDIT
 13586*            FIELD    (ACVRATEI)
 13587*            LENGTH   (06)
 13588*        END-EXEC
 13589     MOVE 06
 13590       TO DFHEIV11
 13591*    MOVE '@"L                   #   #00012360' TO DFHEIV0
 13592     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13593     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13594     MOVE X'2020233030303132333630' TO DFHEIV0(25:11)
 13595     CALL 'kxdfhei1' USING DFHEIV0,
 13596           ACVRATEI,
 13597           DFHEIV11
 13598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13599         IF ACVRATEI NOT NUMERIC
 13600             MOVE AL-UNBON       TO ACVRATEA
 13601             MOVE -1             TO ACVRATEL
 13602             MOVE ER-2280        TO EMI-ERROR
 13603             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13604         ELSE
 13605             MOVE AL-UNNON       TO ACVRATEA
 13606             MOVE ACVRATEI       TO WS-ACVRATE ACVRATEO
 13607         END-IF
 13608     END-IF.
 13609
 13610     IF LCVBENEL GREATER ZERO
 13611
 13612* EXEC CICS BIF DEEDIT
 13613*            FIELD    (LCVBENEI)
 13614*            LENGTH   (11)
 13615*        END-EXEC
 13616     MOVE 11
 13617       TO DFHEIV11
 13618*    MOVE '@"L                   #   #00012376' TO DFHEIV0
 13619     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13620     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13621     MOVE X'2020233030303132333736' TO DFHEIV0(25:11)
 13622     CALL 'kxdfhei1' USING DFHEIV0,
 13623           LCVBENEI,
 13624           DFHEIV11
 13625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13626         IF LCVBENEI NOT NUMERIC
 13627             MOVE AL-UNBON       TO LCVBENEA
 13628             MOVE -1             TO LCVBENEL
 13629             MOVE ER-7637        TO EMI-ERROR
 13630             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13631         ELSE
 13632             MOVE AL-UNNON       TO LCVBENEA
 13633             MOVE LCVBENEI       TO WS-LCVBENE LCVBENEO
 13634         END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 256
* EL130.cbl
 13635     END-IF.
 13636
 13637     IF ACVBENEL GREATER ZERO
 13638
 13639* EXEC CICS BIF DEEDIT
 13640*            FIELD    (ACVBENEI)
 13641*            LENGTH   (11)
 13642*        END-EXEC
 13643     MOVE 11
 13644       TO DFHEIV11
 13645*    MOVE '@"L                   #   #00012392' TO DFHEIV0
 13646     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13647     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13648     MOVE X'2020233030303132333932' TO DFHEIV0(25:11)
 13649     CALL 'kxdfhei1' USING DFHEIV0,
 13650           ACVBENEI,
 13651           DFHEIV11
 13652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13653         IF ACVBENEI NOT NUMERIC
 13654             MOVE AL-UNBON       TO ACVBENEA
 13655             MOVE -1             TO ACVBENEL
 13656             MOVE ER-7637        TO EMI-ERROR
 13657             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13658         ELSE
 13659             MOVE AL-UNNON       TO ACVBENEA
 13660             MOVE ACVBENEI       TO WS-ACVBENE ACVBENEO
 13661         END-IF
 13662     END-IF.
 13663
 13664     IF LCVCNDTL GREATER ZERO
 13665         IF LCVCNDTI NOT = SPACES
 13666             MOVE LCVCNDTI        TO DATE-WORK
 13667             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13668             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13669             MOVE '4'             TO DC-OPTION-CODE
 13670             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13671             IF DATE-CONVERSION-ERROR
 13672                 MOVE AL-UABON    TO LCVCNDTA
 13673                 MOVE -1          TO LCVCNDTL
 13674                 MOVE ER-7638     TO EMI-ERROR
 13675                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13676             ELSE
 13677                 MOVE AL-UANON    TO LCVCNDTA
 13678                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTI
 13679                 MOVE DC-BIN-DATE-1 TO WS-LCVCNDT
 13680             END-IF
 13681         END-IF
 13682     END-IF.
 13683
 13684     IF ACVCNDTL GREATER ZERO
 13685         IF ACVCNDTI NOT = SPACES
 13686             MOVE ACVCNDTI        TO DATE-WORK
 13687             PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13688             MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13689             MOVE '4'             TO DC-OPTION-CODE
 13690             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13691             IF DATE-CONVERSION-ERROR
 13692                 MOVE AL-UABON    TO ACVCNDTA
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 257
* EL130.cbl
 13693                 MOVE -1          TO ACVCNDTL
 13694                 MOVE ER-7638     TO EMI-ERROR
 13695                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13696             ELSE
 13697                 MOVE AL-UANON    TO ACVCNDTA
 13698                 MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTI
 13699                 MOVE DC-BIN-DATE-1 TO WS-ACVCNDT
 13700             END-IF
 13701         END-IF
 13702     END-IF.
 13703
 13704     IF ADDONDTL GREATER ZERO
 13705         MOVE ADDONDTI        TO DATE-WORK
 13706         PERFORM 6990-DEEDIT-DATE THRU 6990-EXIT
 13707         MOVE NUM-WORK        TO DC-GREG-DATE-1-MDY
 13708         MOVE '4'             TO DC-OPTION-CODE
 13709         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13710         IF DATE-CONVERSION-ERROR
 13711             MOVE AL-UABON    TO ADDONDTA
 13712             MOVE -1          TO ADDONDTL
 13713             MOVE ER-7651     TO EMI-ERROR
 13714             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13715         ELSE
 13716             MOVE AL-UANON    TO ADDONDTA
 13717             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTI
 13718             MOVE DC-BIN-DATE-1 TO WS-ADD-ON-DT
 13719         END-IF
 13720     END-IF.
 13721
 13722     IF APRL GREATER ZERO
 13723
 13724* EXEC CICS BIF DEEDIT
 13725*            FIELD    (APRI)
 13726*            LENGTH   (8)
 13727*        END-EXEC
 13728     MOVE 8
 13729       TO DFHEIV11
 13730*    MOVE '@"L                   #   #00012466' TO DFHEIV0
 13731     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13732     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13733     MOVE X'2020233030303132343636' TO DFHEIV0(25:11)
 13734     CALL 'kxdfhei1' USING DFHEIV0,
 13735           APRI,
 13736           DFHEIV11
 13737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13738         IF APRI NOT NUMERIC
 13739             MOVE AL-UNBON       TO APRA
 13740             MOVE -1             TO APRL
 13741             MOVE ER-0248        TO EMI-ERROR
 13742             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13743         ELSE
 13744             MOVE AL-UNNON       TO APRA
 13745             MOVE APRI           TO WS-APR APRO
 13746         END-IF
 13747     END-IF.
 13748
 13749     IF PMTFREQL GREATER ZERO
 13750
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 258
* EL130.cbl
 13751* EXEC CICS BIF DEEDIT
 13752*            FIELD   (PMTFREQI)
 13753*            LENGTH  (2)
 13754*        END-EXEC
 13755     MOVE 2
 13756       TO DFHEIV11
 13757*    MOVE '@"L                   #   #00012482' TO DFHEIV0
 13758     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13759     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13760     MOVE X'2020233030303132343832' TO DFHEIV0(25:11)
 13761     CALL 'kxdfhei1' USING DFHEIV0,
 13762           PMTFREQI,
 13763           DFHEIV11
 13764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13765         IF PMTFREQI NOT NUMERIC
 13766             MOVE -1             TO PMTFREQL
 13767             MOVE AL-UNBON       TO PMTFREQA
 13768             MOVE ER-0258        TO EMI-ERROR
 13769             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13770         ELSE
 13771             MOVE AL-UNNON       TO PMTFREQA
 13772             MOVE PMTFREQI       TO WS-PMTFREQ  PMTFREQO
 13773         END-IF
 13774     END-IF.
 13775
 13776     IF INDGRPL GREATER ZERO
 13777         IF INDGRPI = 'I' OR 'G'
 13778             MOVE AL-UANON       TO INDGRPA
 13779         ELSE
 13780             MOVE -1 TO INDGRPL
 13781             MOVE AL-UABON       TO INDGRPA
 13782             MOVE ER-0260        TO EMI-ERROR
 13783             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13784         END-IF
 13785     END-IF.
 13786
 13787     IF LOANBALL GREATER ZERO
 13788         MOVE LOANBALI           TO DEEDIT-FIELD
 13789
 13790* EXEC CICS BIF DEEDIT
 13791*            FIELD   (DEEDIT-FIELD)
 13792*            LENGTH  (12)
 13793*        END-EXEC
 13794     MOVE 12
 13795       TO DFHEIV11
 13796*    MOVE '@"L                   #   #00012510' TO DFHEIV0
 13797     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13798     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13799     MOVE X'2020233030303132353130' TO DFHEIV0(25:11)
 13800     CALL 'kxdfhei1' USING DFHEIV0,
 13801           DEEDIT-FIELD,
 13802           DFHEIV11
 13803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13804         IF DEEDIT-FIELD NOT NUMERIC
 13805             MOVE AL-UNBON       TO LOANBALA
 13806             MOVE -1             TO LOANBALL
 13807             MOVE ER-0247        TO EMI-ERROR
 13808             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 259
* EL130.cbl
 13809         ELSE
 13810             MOVE AL-UNNON       TO LOANBALA
 13811             MOVE DEEDIT-FIELD   TO HOLD-LOAN-BAL  LOANBALO
 13812         END-IF
 13813     END-IF.
 13814
 13815     IF PREMTYPL GREATER ZERO
 13816         IF (PREMTYPI = '1' OR '2' OR '3')
 13817             MOVE AL-UANON       TO PREMTYPA
 13818         ELSE
 13819             MOVE -1             TO PREMTYPL
 13820             MOVE AL-UABON       TO PREMTYPA
 13821             MOVE ER-0227        TO EMI-ERROR
 13822             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13823         END-IF
 13824     END-IF.
 13825
 13826     IF REINCDL GREATER ZERO
 13827         MOVE LOW-VALUES         TO  ERREIN-KEY
 13828         MOVE PI-COMPANY-CD      TO  REIN-COMP-CD
 13829         MOVE REINCDI            TO  REIN-CODE-1
 13830                                     REIN-CODE-2
 13831                                     REIN-CODE-3
 13832         MOVE 'A'                TO  REIN-TYPE
 13833         PERFORM 7992-READ-REIN THRU 7992-EXIT
 13834         IF REIN-REC-NOT-FOUND
 13835             MOVE ER-0266        TO  EMI-ERROR
 13836             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13837             MOVE -1             TO  REINCDL
 13838             MOVE AL-UABON       TO  REINCDA
 13839         ELSE
 13840             MOVE AL-UANON       TO  REINCDA
 13841         END-IF
 13842     END-IF.
 13843
 13844     IF CERTMTI NOT = 'A'
 13845        GO TO 6200-EXIT
 13846     END-IF.
 13847
 13848     IF PREMTYPI = '1'
 13849         IF LCVCDL GREATER ZERO
 13850             IF WS-LF-SPECIAL-CALC-CD = 'O'
 13851                 MOVE ER-0841        TO  EMI-ERROR
 13852                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13853                 MOVE -1             TO  PREMTYPL
 13854                 MOVE AL-UABON       TO  PREMTYPA
 13855             END-IF
 13856         END-IF
 13857     END-IF.
 13858
 13859     IF PREMTYPI = '1'
 13860         IF ACVCDL GREATER ZERO
 13861             IF WS-AH-SPECIAL-CALC-CD = 'O'
 13862                 MOVE ER-0841        TO  EMI-ERROR
 13863                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13864                 MOVE -1             TO  PREMTYPL
 13865                 MOVE AL-UABON       TO  PREMTYPA
 13866             END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 260
* EL130.cbl
 13867         END-IF
 13868     END-IF.
 13869
 13870     IF PREMTYPI = '2'
 13871         IF LCVCDL GREATER ZERO
 13872             IF (PI-COMPANY-ID = 'HAN') AND
 13873                (WS-LF-SPECIAL-CALC-CD = 'O' OR 'M')
 13874                        OR
 13875                 WS-LF-SPECIAL-CALC-CD = 'O'
 13876*                NEXT SENTENCE
 13877                 CONTINUE
 13878             ELSE
 13879                 MOVE ER-0840        TO  EMI-ERROR
 13880                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13881                 MOVE -1             TO  PREMTYPL
 13882                 MOVE AL-UABON       TO  PREMTYPA
 13883             END-IF
 13884         END-IF
 13885     END-IF.
 13886
 13887     IF PREMTYPI = '2'
 13888         IF ACVCDL GREATER ZERO
 13889             IF (PI-COMPANY-ID = 'HAN')  AND
 13890                (WS-AH-SPECIAL-CALC-CD = 'O' OR 'M')
 13891                        OR
 13892                 WS-AH-SPECIAL-CALC-CD = 'O'
 13893*                NEXT SENTENCE
 13894                 CONTINUE
 13895             ELSE
 13896                 MOVE ER-0840        TO  EMI-ERROR
 13897                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13898                 MOVE -1             TO  PREMTYPL
 13899                 MOVE AL-UABON       TO  PREMTYPA
 13900             END-IF
 13901         END-IF
 13902     END-IF.
 13903
 13904     IF LCVCDL = ZEROS
 13905        GO TO 6200-EXIT
 13906     END-IF.
 13907
 13908     IF PMTFREQL NOT = ZEROS  AND NOT TEX-REG
 13909         IF PMTFREQI NOT = ZEROS
 13910             MOVE ER-0428        TO EMI-ERROR
 13911             MOVE -1             TO PMTFREQL
 13912             MOVE AL-UNBON       TO PMTFREQA
 13913             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13914             GO TO 6200-CHECK-APR
 13915         END-IF
 13916     END-IF.
 13917
 13918     IF PMTFREQL = ZEROS AND TEX-REG
 13919         MOVE ER-0429            TO EMI-ERROR
 13920         MOVE -1                 TO PMTFREQL
 13921         MOVE AL-UNBON           TO PMTFREQA
 13922         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13923         GO TO 6200-CHECK-APR
 13924     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 261
* EL130.cbl
 13925
 13926     IF LCVOTRMI NOT NUMERIC
 13927         GO TO 6200-CHECK-APR
 13928     END-IF.
 13929
 13930     IF WS-PMTFREQ NOT = ZERO
 13931         DIVIDE WS-PMTFREQ INTO LCVOTRMI
 13932         GIVING DIVIDE-QUOT
 13933         REMAINDER DIVIDE-REM
 13934         IF DIVIDE-REM GREATER ZERO
 13935             MOVE ER-0430            TO EMI-ERROR
 13936             MOVE -1                 TO PMTFREQL
 13937             MOVE AL-UNBON           TO PMTFREQA
 13938             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13939         END-IF
 13940     END-IF.
 13941
 13942 6200-CHECK-APR.
 13943     IF NET-PAY AND APRL = ZEROS
 13944        MOVE ER-0257             TO EMI-ERROR
 13945        MOVE -1                  TO APRL
 13946        MOVE AL-UABON            TO APRA
 13947        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13948     END-IF.
 13949
 13950 6200-EXIT.
 13951     EXIT.
 13952
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 262
* EL130.cbl
 13954 6300-REQUIRED-CERT-EDIT.
 13955
 13956     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 13957        GO TO 6300-REQUIRED-AH-EDIT
 13958     END-IF
 13959
 13960     IF LCVCDL = ZERO
 13961        MOVE ER-7639             TO EMI-ERROR
 13962        MOVE -1                  TO LCVCDL
 13963        MOVE AL-UABON            TO LCVCDA
 13964        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13965     END-IF.
 13966
 13967     IF LCVOTRML = ZERO
 13968        MOVE ER-7670             TO EMI-ERROR
 13969        MOVE -1                  TO LCVOTRML
 13970        MOVE AL-UNBON            TO LCVOTRMA
 13971        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13972     END-IF.
 13973
 13974     IF LCVBENEL = ZERO
 13975        MOVE ER-7671             TO EMI-ERROR
 13976        MOVE -1                  TO LCVBENEL
 13977        MOVE AL-UNBON            TO LCVBENEA
 13978        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13979     END-IF.
 13980
 13981     GO TO 6399-EXIT.
 13982
 13983 6300-REQUIRED-AH-EDIT.
 13984
 13985     IF ACVCDL = ZERO
 13986        MOVE ER-7639             TO EMI-ERROR
 13987        MOVE -1                  TO ACVCDL
 13988        MOVE AL-UABON            TO ACVCDA
 13989        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13990     END-IF.
 13991
 13992     IF ACVOTRML = ZERO
 13993         MOVE ER-7670             TO EMI-ERROR
 13994         MOVE -1                  TO ACVOTRML
 13995         MOVE AL-UNBON            TO ACVOTRMA
 13996         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13997     END-IF.
 13998
 13999     IF ACVBENEL = ZERO
 14000        MOVE ER-7671             TO EMI-ERROR
 14001        MOVE -1                  TO ACVBENEL
 14002        MOVE AL-UNBON            TO ACVBENEA
 14003        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14004     END-IF.
 14005
 14006 6399-EXIT.
 14007      EXIT.
 14008
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 263
* EL130.cbl
 14010 6400-TEST-CLAIM-REASONABILITY.
 14011
 14012     IF WS-INCUR = LOW-VALUES
 14013        GO TO 6499-EXIT
 14014     END-IF.
 14015
 14016     IF WS-EFFDT NOT = LOW-VALUES
 14017         IF WS-INCUR LESS WS-EFFDT
 14018             MOVE ER-0458          TO EMI-ERROR
 14019             MOVE -1               TO INCURL
 14020             MOVE AL-UABON         TO INCURA
 14021             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14022         END-IF
 14023     END-IF.
 14024
 14025     IF CERTMTI = 'A'
 14026        GO TO 6460-TEST-NEW-CERT
 14027     END-IF.
 14028
 14029     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 14030     MOVE CRTCARRI               TO CERT-CARRIER.
 14031     MOVE GROUPI                 TO CERT-GROUPING.
 14032     MOVE STATEI                 TO CERT-STATE.
 14033     MOVE PI-SAVE-ACCOUNT        TO CERT-ACCOUNT.
 14034     MOVE PI-SAVE-CERT           TO CERT-CERT-NO.
 14035     MOVE PI-SAVE-EFFDT          TO CERT-EFF-DT.
 14036
 14037
 14038
 14039* EXEC CICS HANDLE CONDITION
 14040*         DUPKEY   (6499-EXIT)
 14041*         NOTFND   (6499-EXIT)
 14042*    END-EXEC.
 14043*    MOVE '"$$I                  ! C #00012748' TO DFHEIV0
 14044     MOVE X'222424492020202020202020' TO DFHEIV0(1:12)
 14045     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14046     MOVE X'4320233030303132373438' TO DFHEIV0(25:11)
 14047     CALL 'kxdfhei1' USING DFHEIV0
 14048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14049
 14050
 14051     PERFORM 7940-READ-CERT THRU 7940-EXIT.
 14052
 14053     IF (CLMTYPEI = PI-AH-OVERRIDE-L1  OR
 14054        'I' OR 'G' OR 'F')
 14055        MOVE CM-AH-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14056     ELSE
 14057        MOVE CM-LF-ORIG-TERM     TO DC-ELAPSED-MONTHS
 14058     END-IF.
 14059
 14060     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 14061     MOVE '6'                    TO DC-OPTION-CODE.
 14062     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14063
 14064     IF (WS-INCUR GREATER THAN DC-BIN-DATE-2)
 14065        and (dc-elapsed-months > zeros)
 14066        MOVE ER-0519             TO EMI-ERROR
 14067        MOVE -1                  TO INCURL
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 264
* EL130.cbl
 14068        MOVE AL-UABON            TO INCURA
 14069        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14070     END-IF.
 14071
 14072     IF CLMCARRI NOT = CRTCARRI
 14073        MOVE ER-0562             TO EMI-ERROR
 14074        MOVE AL-UABON            TO CLMCARRA
 14075        MOVE -1                  TO CLMCARRL
 14076        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14077     END-IF.
 14078
 14079     if (pi-company-id = 'DCC' OR 'VPP')
 14080        and (ws-dcc-product-code <> spaces)
 14081        continue
 14082     else
 14083      IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F') AND
 14084        CM-AH-BENEFIT-CD = '00')
 14085                  OR
 14086        (CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 14087        CM-LF-BENEFIT-CD = '00')
 14088         MOVE ER-0521         TO EMI-ERROR
 14089         MOVE AL-UABON        TO CLMTYPEA
 14090         MOVE -1              TO CLMTYPEL
 14091         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14092      END-IF
 14093     end-if
 14094*    IF CLMTYPEI = 'I' AND
 14095*       CM-AH-CRITICAL-PERIOD = +0
 14096*        MOVE ER-0521         TO EMI-ERROR
 14097*        MOVE AL-UABON        TO CLMTYPEA
 14098*        MOVE -1              TO CLMTYPEL
 14099*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14100*    END-IF
 14101
 14102*    IF PI-COMPANY-ID = 'CRI'
 14103*        IF MAINTI = 'A'
 14104*            IF CERT-PEND-ISSUE-ERROR  OR
 14105*               CERT-PEND-ISSUE-RETURNED
 14106*                MOVE -1                 TO CERTNOL
 14107*                MOVE AL-UABON           TO CERTNOA
 14108*                MOVE ER-7640            TO EMI-ERROR
 14109*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14110*            END-IF
 14111*        END-IF
 14112*    END-IF.
 14113
 14114     IF (CM-AH-CANCEL-DT  NOT  =  LOW-VALUES AND
 14115         (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 14116         IF WS-INCUR GREATER THAN CM-AH-CANCEL-DT
 14117             GO TO 6450-DATE-ERROR
 14118         END-IF
 14119     END-IF.
 14120
 14121     IF (CM-LF-CANCEL-DT  NOT  =  LOW-VALUES AND
 14122         CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 14123         IF WS-INCUR GREATER THAN CM-LF-CANCEL-DT
 14124             GO TO 6450-DATE-ERROR
 14125         END-IF
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 265
* EL130.cbl
 14126     END-IF.
 14127
 14128     IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14129         IF WS-INCUR GREATER THAN CM-LF-DEATH-DT
 14130             GO TO 6450-DATE-ERROR
 14131         END-IF
 14132     END-IF.
 14133
 14134     GO TO 6499-EXIT.
 14135
 14136 6450-DATE-ERROR.
 14137     MOVE ER-0520                TO EMI-ERROR.
 14138     MOVE -1                     TO INCURL.
 14139     MOVE AL-UABON               TO INCURA.
 14140     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14141
 14142*    IF (PI-COMPANY-ID = 'FIM' OR 'LGX') AND
 14143*       (EMI-SEVERITY-SAVE = 'X')
 14144*        ADD 1                TO EMI-FORCABLE-CTR
 14145*        SUBTRACT 1 FROM EMI-FATAL-CTR
 14146*    END-IF.
 14147
 14148     GO TO 6499-EXIT.
 14149
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 266
* EL130.cbl
 14151 6460-TEST-NEW-CERT.
 14152
 14153     IF NOT EMI-NO-ERRORS
 14154        GO TO 6499-EXIT
 14155     END-IF.
 14156
 14157     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 14158
 14159     IF ((CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14160          OR 'F') AND
 14161         ACVOTRML GREATER ZERO)
 14162        MOVE ACVOTRMI       TO DC-ELAPSED-MONTHS
 14163     END-IF.
 14164
 14165     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1 AND
 14166         LCVOTRML GREATER ZERO
 14167        MOVE LCVOTRMI       TO DC-ELAPSED-MONTHS
 14168     END-IF.
 14169
 14170     MOVE WS-EFFDT               TO DC-BIN-DATE-1.
 14171
 14172*    IF PI-COMPANY-ID = 'HAN'
 14173*        IF ADDONDTL GREATER ZERO
 14174*            MOVE WS-ADD-ON-DT   TO  DC-BIN-DATE-1
 14175*            IF CLMTYPEI = 'A'
 14176*                IF ACVOTRMI NOT = ZEROS
 14177*                    COMPUTE DC-ELAPSED-MONTHS = (ACVOTRMI - 1)
 14178*                ELSE
 14179*                    NEXT SENTENCE
 14180*                    CONTINUE
 14181*                END-IF
 14182*            ELSE
 14183*                IF LCVOTRMI NOT = ZEROS
 14184*                    COMPUTE DC-ELAPSED-MONTHS = (LCVOTRMI - 1)
 14185*                END-IF
 14186*            END-IF
 14187*        END-IF
 14188*    END-IF.
 14189
 14190     MOVE '6'                    TO DC-OPTION-CODE.
 14191     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14192
 14193     IF NO-CONVERSION-ERROR
 14194         MOVE DC-BIN-DATE-2      TO WS-EXPIRE
 14195     END-IF.
 14196
 14197     IF WS-INCUR GREATER THAN WS-EXPIRE
 14198        MOVE ER-0519             TO EMI-ERROR
 14199        MOVE -1                  TO INCURL
 14200        MOVE AL-UABON            TO INCURA
 14201        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14202     END-IF.
 14203
 14204     IF CLMCARRI NOT = CRTCARRI
 14205        MOVE ER-0562             TO EMI-ERROR
 14206        MOVE AL-UABON            TO CLMCARRA
 14207        MOVE -1                  TO CLMCARRL
 14208        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 267
* EL130.cbl
 14209     END-IF.
 14210
 14211     if (pi-company-id = 'DCC' OR 'VPP')
 14212        and (ws-dcc-product-code <> spaces)
 14213        continue
 14214     else
 14215        IF (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F')
 14216           and (ACVCDL = ZEROS)
 14217           MOVE ER-0521          TO EMI-ERROR
 14218           MOVE AL-UABON         TO CLMTYPEA
 14219           MOVE -1               TO CLMTYPEL
 14220           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14221        END-IF
 14222     end-if
 14223
 14224     if (pi-company-id = 'DCC' OR 'VPP')
 14225        and (ws-dcc-product-code <> spaces)
 14226        continue
 14227     else
 14228        IF (CLMTYPEI = PI-LIFE-OVERRIDE-L1)
 14229           and (LCVCDL = ZEROS)
 14230           MOVE ER-0521          TO EMI-ERROR
 14231           MOVE AL-UABON         TO CLMTYPEA
 14232           MOVE -1               TO CLMTYPEL
 14233           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14234        END-IF
 14235     end-if
 14236
 14237     IF CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14238         IF LCVCNDTL GREATER ZERO
 14239             IF WS-INCUR GREATER THAN WS-LCVCNDT
 14240                 GO TO 6450-DATE-ERROR
 14241             END-IF
 14242         END-IF
 14243     END-IF.
 14244
 14245     IF CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'
 14246         IF ACVCNDTL GREATER ZERO
 14247             IF WS-INCUR GREATER THAN WS-ACVCNDT
 14248                 GO TO 6450-DATE-ERROR
 14249             END-IF
 14250         END-IF
 14251     END-IF.
 14252
 14253 6499-EXIT.
 14254     EXIT.
 14255 6500-get-acct.
 14256
 14257     MOVE SPACES                 TO ERACCT-KEY
 14258                                    ws-dcc-product-code
 14259                                    ws-acct-found-sw
 14260
 14261     IF CARR-GROUP-ST-ACCNT-CNTL
 14262        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 14263        MOVE CRTCARRI            TO ACCT-CARRIER
 14264        MOVE GROUPI              TO ACCT-GROUPING
 14265        MOVE STATEI              TO ACCT-STATE
 14266        MOVE ACCOUNTI            TO ACCT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 268
* EL130.cbl
 14267        GO TO 6500-startbr
 14268     END-IF
 14269
 14270     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 14271     MOVE ACCOUNTI               TO ACCT-ACCOUNT
 14272
 14273     IF PI-CERT-ACCESS-CONTROL = ' ' OR '2'
 14274        MOVE STATEI             TO ACCT-STATE
 14275     END-IF
 14276
 14277     IF PI-CERT-ACCESS-CONTROL = '2' OR '4'
 14278        MOVE CRTCARRI           TO ACCT-CARRIER
 14279     END-IF
 14280
 14281     .
 14282 6500-startbr.
 14283
 14284     MOVE ERACCT-KEY             TO SAVE-ERACCT-KEY
 14285
 14286
 14287* EXEC CICS STARTBR
 14288*       DATASET     (ERACCT2-DSID)
 14289*       RIDFLD      (SAVE-ERACCT-KEY)
 14290*       GENERIC
 14291*       KEYLENGTH   (20)
 14292*       resp        (ws-response)
 14293*    END-EXEC
 14294     MOVE 20
 14295       TO DFHEIV11
 14296     MOVE 0
 14297       TO DFHEIV12
 14298*    MOVE '&,   KG    G          &  N#00012988' TO DFHEIV0
 14299     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 14300     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14301     MOVE X'204E233030303132393838' TO DFHEIV0(25:11)
 14302     CALL 'kxdfhei1' USING DFHEIV0,
 14303           ERACCT2-DSID,
 14304           SAVE-ERACCT-KEY,
 14305           DFHEIV11,
 14306           DFHEIV12,
 14307           DFHEIV99
 14308     MOVE EIBRESP  TO ws-response
 14309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14310
 14311     if not ws-resp-normal
 14312        go to 6500-exit
 14313     end-if
 14314
 14315     .
 14316 6500-readnext.
 14317
 14318
 14319* EXEC CICS READNEXT
 14320*       DATASET   (ERACCT2-DSID)
 14321*       SET       (ADDRESS OF ACCOUNT-MASTER)
 14322*       RIDFLD    (SAVE-ERACCT-KEY)
 14323*    END-EXEC
 14324     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 269
* EL130.cbl
 14325       TO DFHEIV11
 14326*    MOVE '&.S                   )   #00013003' TO DFHEIV0
 14327     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14328     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14329     MOVE X'2020233030303133303033' TO DFHEIV0(25:11)
 14330     CALL 'kxdfhei1' USING DFHEIV0,
 14331           ERACCT2-DSID,
 14332           DFHEIV20,
 14333           DFHEIV99,
 14334           SAVE-ERACCT-KEY,
 14335           DFHEIV99,
 14336           DFHEIV11,
 14337           DFHEIV99,
 14338           DFHEIV99
 14339     SET ADDRESS OF ACCOUNT-MASTER TO
 14340         DFHEIV20
 14341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14342
 14343     IF (ACCT-COMP-CD  NOT = AM-COMPANY-CD-A1)
 14344        or (ACCT-CARRIER  NOT = AM-VG-CARRIER )
 14345        or (ACCT-GROUPING NOT = AM-VG-GROUPING)
 14346        or (ACCT-STATE    NOT = AM-VG-STATE   )
 14347        or (ACCT-ACCOUNT  NOT = AM-VG-ACCOUNT )
 14348        go to 6500-endbr
 14349     END-IF
 14350
 14351     IF (WS-EFFDT >= AM-EFFECTIVE-DT)
 14352        and (WS-EFFDT < AM-EXPIRATION-DT)
 14353        set acct-found to true
 14354        MOVE AM-dcc-product-code to ws-dcc-product-code
 14355        GO TO 6500-endbr
 14356     END-IF
 14357
 14358     IF WS-EFFDT >= AM-EXPIRATION-DT
 14359         GO TO 6500-readnext
 14360     END-IF
 14361
 14362     .
 14363 6500-endbr.
 14364
 14365
 14366* EXEC CICS ENDBR
 14367*        DATASET    (ERACCT2-DSID)
 14368*    END-EXEC
 14369     MOVE 0
 14370       TO DFHEIV11
 14371*    MOVE '&2                    $   #00013031' TO DFHEIV0
 14372     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14373     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14374     MOVE X'2020233030303133303331' TO DFHEIV0(25:11)
 14375     CALL 'kxdfhei1' USING DFHEIV0,
 14376           ERACCT2-DSID,
 14377           DFHEIV11,
 14378           DFHEIV99
 14379     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14380
 14381     .
 14382 6500-exit.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 270
* EL130.cbl
 14383     exit.
 14384 6600-CHECK-AUTO-ACTIVITY.
 14385
 14386
 14387* EXEC CICS HANDLE CONDITION
 14388*        NOTFND   (6600-NOT-FOUND)
 14389*    END-EXEC.
 14390*    MOVE '"$I                   ! D #00013040' TO DFHEIV0
 14391     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14392     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14393     MOVE X'4420233030303133303430' TO DFHEIV0(25:11)
 14394     CALL 'kxdfhei1' USING DFHEIV0
 14395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14396
 14397
 14398     MOVE PI-COMPANY-ID              TO  CNTL-COMP-ID.
 14399     MOVE 'T'                        TO  CNTL-REC-TYPE.
 14400     MOVE SPACES                     TO  CNTL-ACCESS.
 14401     MOVE +0                         TO  CNTL-SEQ-NO.
 14402
 14403     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 14404
 14405     IF CF-SYS-ACTIVE-SW (1) = 'N' OR ' '
 14406         MOVE 'N'                    TO  WS-REC-FOUND-SW
 14407                                         WS-LETTER-SW
 14408         GO TO 6600-EXIT
 14409     END-IF.
 14410
 14411     IF CF-SYS-LETTER-ID (1) = SPACES OR LOW-VALUES
 14412         MOVE 'N'                     TO  WS-LETTER-SW
 14413     ELSE
 14414         MOVE 'Y'                     TO  WS-LETTER-SW
 14415     END-IF.
 14416
 14417     MOVE 'Y'                         TO  WS-REC-FOUND-SW.
 14418     GO TO 6600-EXIT.
 14419
 14420 6600-START-AUTO-LETTER-WRITER.
 14421
 14422     MOVE LOW-VALUES                  TO  W-1523-LINKDATA.
 14423     MOVE PROGRAM-INTERFACE-BLOCK     TO  W-1523-COMMON-PI-DATA.
 14424
 14425     MOVE CF-SYS-LETTER-ID (1)        TO  W-1523-FORM-NUMBER.
 14426
 14427     IF CF-SYS-RESEND-DAYS (1) NOT = ZEROS
 14428         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14429         MOVE '6'                     TO  DC-OPTION-CODE
 14430         MOVE CF-SYS-RESEND-DAYS (1)  TO  DC-ELAPSED-DAYS
 14431         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14432         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14433         IF NO-CONVERSION-ERROR
 14434             MOVE DC-BIN-DATE-2       TO  W-1523-RESEND-DATE
 14435         ELSE
 14436             MOVE LOW-VALUES          TO  W-1523-RESEND-DATE
 14437         END-IF
 14438     END-IF.
 14439
 14440     IF CF-SYS-FOLLOW-UP-DAYS (1) NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 271
* EL130.cbl
 14441         MOVE SAVE-BIN-DATE           TO  DC-BIN-DATE-1
 14442         MOVE '6'                     TO  DC-OPTION-CODE
 14443         MOVE CF-SYS-FOLLOW-UP-DAYS (1)   TO  DC-ELAPSED-DAYS
 14444         MOVE +0                      TO  DC-ELAPSED-MONTHS
 14445         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14446         IF NO-CONVERSION-ERROR
 14447             MOVE DC-BIN-DATE-2       TO  W-1523-FOLLOW-UP-DATE
 14448         ELSE
 14449             MOVE LOW-VALUES          TO  W-1523-FOLLOW-UP-DATE
 14450         END-IF
 14451     END-IF.
 14452
 14453
 14454
 14455* EXEC CICS LINK
 14456*        PROGRAM    (LINK-1523)
 14457*        COMMAREA   (W-1523-LINKDATA)
 14458*        LENGTH     (W-1523-COMM-LENGTH)
 14459*    END-EXEC.
 14460*    MOVE '."C                   (   #00013100' TO DFHEIV0
 14461     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14462     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14463     MOVE X'2020233030303133313030' TO DFHEIV0(25:11)
 14464     CALL 'kxdfhei1' USING DFHEIV0,
 14465           LINK-1523,
 14466           W-1523-LINKDATA,
 14467           W-1523-COMM-LENGTH,
 14468           DFHEIV99,
 14469           DFHEIV99,
 14470           DFHEIV99,
 14471           DFHEIV99
 14472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14473
 14474
 14475     GO TO 6600-EXIT.
 14476
 14477 6600-NOT-FOUND.
 14478     MOVE 'N'                         TO  WS-REC-FOUND-SW.
 14479
 14480 6600-EXIT.
 14481     EXIT.
 14482
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 272
* EL130.cbl
 14483/
 14484*************************************************************
 14485*****        START OF ACTIVITY FILE OUTPUT PROCESSING      **
 14486*************************************************************
 14487
 14488 6700-OUTPUT-ACTIVITY-RECORD.
 14489
 14490
 14491
 14492* EXEC CICS GETMAIN
 14493*        SET (ADDRESS OF DAILY-ACTIVITY-RECORD)
 14494*        LENGTH (DLYACTV-LENGTH)
 14495*        INITIMG (WS-BLANK)
 14496*    END-EXEC.
 14497*    MOVE ',"IL                  $   #00013122' TO DFHEIV0
 14498     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 14499     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14500     MOVE X'2020233030303133313232' TO DFHEIV0(25:11)
 14501     CALL 'kxdfhei1' USING DFHEIV0,
 14502           DFHEIV20,
 14503           DLYACTV-LENGTH,
 14504           WS-BLANK
 14505     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 14506         DFHEIV20
 14507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14508
 14509
 14510     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 14511     MOVE PI-COMPANY-CD          TO DA-COMP-CD.
 14512     MOVE CLMCARRI               TO DA-CARRIER.
 14513     IF CLMNOL EQUAL ZERO
 14514         MOVE WS-CLAIM-NUMBER    TO DA-CLAIM-NO
 14515     ELSE
 14516         MOVE CLMNOI             TO DA-CLAIM-NO
 14517     END-IF.
 14518     MOVE CERTNOI                TO DA-CERT-PRIME.
 14519     MOVE SUFXI                  TO DA-CERT-SFX.
 14520     MOVE +0                     TO DA-TRAILER-SEQ-NO.
 14521     MOVE 'A'                    TO DA-RECORD-TYPE.
 14522
 14523
 14524* EXEC CICS HANDLE CONDITION
 14525*        NOTOPEN (6700-NOTOPEN-ERROR)
 14526*        DUPREC (6700-EXIT)
 14527*    END-EXEC.
 14528*    MOVE '"$J%                  ! E #00013141' TO DFHEIV0
 14529     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 14530     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14531     MOVE X'4520233030303133313431' TO DFHEIV0(25:11)
 14532     CALL 'kxdfhei1' USING DFHEIV0
 14533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14534
 14535
 14536
 14537* EXEC CICS WRITE
 14538*        DATASET (DLYACTV-DSID)
 14539*        RIDFLD (DA-KEY)
 14540*        FROM (DAILY-ACTIVITY-RECORD)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 273
* EL130.cbl
 14541*        LENGTH (DLYACTV-LENGTH)
 14542*    END-EXEC.
 14543*    MOVE '&$ L                  ''   #00013146' TO DFHEIV0
 14544     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14545     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14546     MOVE X'2020233030303133313436' TO DFHEIV0(25:11)
 14547     CALL 'kxdfhei1' USING DFHEIV0,
 14548           DLYACTV-DSID,
 14549           DAILY-ACTIVITY-RECORD,
 14550           DLYACTV-LENGTH,
 14551           DA-KEY,
 14552           DFHEIV99,
 14553           DFHEIV99
 14554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14555
 14556     GO TO 6700-EXIT.
 14557
 14558 6700-NOTOPEN-ERROR.
 14559     MOVE '2955'                 TO EMI-ERROR.
 14560     MOVE -1                     TO MAINTL.
 14561     MOVE AL-UANON               TO MAINTA.
 14562     PERFORM 9900-ERROR-FORMAT THRU
 14563             9900-EXIT.
 14564     GO TO 8200-SEND-DATAONLY.
 14565
 14566 6700-EXIT.
 14567     EXIT.
 14568
 14569*************************************************************
 14570*****         END OF ACTIVITY FILE OUTPUT PROCESSING        *
 14571*************************************************************
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 274
* EL130.cbl
 14572/
 14573 6990-DEEDIT-DATE.
 14574
 14575
 14576* EXEC CICS BIF DEEDIT
 14577*        FIELD   (DATE-WORK)
 14578*        LENGTH  (8)
 14579*    END-EXEC.
 14580     MOVE 8
 14581       TO DFHEIV11
 14582*    MOVE '@"L                   #   #00013171' TO DFHEIV0
 14583     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14584     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14585     MOVE X'2020233030303133313731' TO DFHEIV0(25:11)
 14586     CALL 'kxdfhei1' USING DFHEIV0,
 14587           DATE-WORK,
 14588           DFHEIV11
 14589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14590
 14591 6990-EXIT.
 14592     EXIT.
 14593
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 275
* EL130.cbl
 14595 7000-BUILD-OUTPUT-MAP.
 14596
 14597     IF CLAIM-SWITCH = 'N'
 14598         GO TO 7050-BUILD-MAP-CERT-DATA
 14599     END-IF.
 14600
 14601     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 14602         MOVE SPACES                 TO SEQUO
 14603         MOVE AL-SABOF               TO SEQUA
 14604     ELSE
 14605         MOVE CL-ASSOC-CERT-SEQU     TO WS-CURRENT-SEQU
 14606         MOVE CL-ASSOC-CERT-TOTAL    TO WS-OF-SEQU
 14607         MOVE WS-CLAIM-SEQU          TO SEQUO
 14608         MOVE AL-SABON               TO SEQUA
 14609     END-IF.
 14610
 14611     MOVE CL-CARRIER             TO CLMCARRO.
 14612     MOVE CL-CLAIM-TYPE          TO CLMTYPEO.
 14613     MOVE CL-PRIME-CERT-PRIME    TO PCERTNOO.
 14614     MOVE CL-PRIME-CERT-SFX      TO PSUFXO.
 14615     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14616     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14617     MOVE CL-INSURED-MID-INIT    TO INITO.
 14618     MOVE CL-INSURED-SEX-CD      TO SEXO.
 14619     move cl-insured-type        to instypeo
 14620*    MOVE CL-INSURED-OCC-CD      TO OCCCDO.
 14621
 14622     MOVE AL-UANON               TO CLMCARRA
 14623                                    CLMTYPEA
 14624                                    PCERTNOA
 14625                                    PSUFXA
 14626                                    LSTNMEA
 14627                                    FSTNMEA
 14628                                    INITA
 14629                                    SEXA
 14630
 14631     MOVE CL-PRIME-CERT-NO       TO PI-PRIMARY-CERT-NO.
 14632
 14633     IF CL-INSURED-BIRTH-DT NOT = LOW-VALUES
 14634         MOVE ' '                 TO DC-OPTION-CODE
 14635         MOVE CL-INSURED-BIRTH-DT TO DC-BIN-DATE-1
 14636         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14637         IF NOT DATE-CONVERSION-ERROR
 14638             MOVE DC-GREG-DATE-1-EDIT TO BIRTHDTO
 14639             MOVE AL-UANON            TO BIRTHDTA
 14640         END-IF
 14641     END-IF.
 14642
 14643     MOVE CL-SOC-SEC-NO          TO SSNO.
 14644     MOVE AL-UANON               TO SSNA.
 14645
 14646     IF CL-INCURRED-DT NOT = LOW-VALUES
 14647         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 14648         MOVE ' '                TO DC-OPTION-CODE
 14649         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14650         IF NOT DATE-CONVERSION-ERROR
 14651             MOVE DC-GREG-DATE-1-EDIT TO INCURO
 14652             MOVE AL-UANON            TO INCURA
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 276
* EL130.cbl
 14653         END-IF
 14654     END-IF.
 14655
 14656     IF CL-REPORTED-DT NOT = LOW-VALUES
 14657         MOVE ' '                TO DC-OPTION-CODE
 14658         MOVE CL-REPORTED-DT     TO DC-BIN-DATE-1
 14659         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14660         IF NOT DATE-CONVERSION-ERROR
 14661             MOVE DC-GREG-DATE-1-EDIT TO REPORTO
 14662             MOVE AL-UANON            TO REPORTA
 14663         END-IF
 14664     END-IF.
 14665
 14666*    IF CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES
 14667*        MOVE ' '                 TO DC-OPTION-CODE
 14668*        MOVE CL-EST-END-OF-DISAB-DT TO DC-BIN-DATE-1
 14669*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14670*        IF NOT DATE-CONVERSION-ERROR
 14671*            MOVE DC-GREG-DATE-1-EDIT TO ESTENDO
 14672*            MOVE AL-UANON            TO ESTENDA
 14673*        END-IF
 14674*    END-IF.
 14675
 14676     MOVE WS-DIAGNOSIS-DESCRIPT  TO DIAGO.
 14677     MOVE WS-ICD-CODE-1          TO ICD1O.
 14678     MOVE WS-ICD-CODE-2          TO ICD2O.
 14679*    MOVE CL-CAUSE-CD            TO CAUSEO.
 14680     MOVE AT-CURRENT-MANUAL-RESERVE TO MANRSVO.
 14681     MOVE CL-RELATED-CLAIM-NO    TO RELCLMO.
 14682     MOVE CL-PROCESSOR-ID        TO PROCCDO.
 14683     MOVE CL-PRIORITY-CD         TO PRICDO.
 14684     MOVE AL-UANON               TO DIAGA
 14685                                    ICD1A
 14686                                    ICD2A
 14687*                                   CAUSEA
 14688                                    RELCLMA
 14689                                    PROCCDA
 14690                                    PRICDA.
 14691     MOVE AL-UNNON               TO MANRSVA.
 14692
 14693*    IF PI-COMPANY-ID  = 'ACC'  OR  'FDL' OR 'LGX'
 14694*        MOVE CL-PRODUCT-CD          TO PRODCDO
 14695*        MOVE AL-UANON               TO PRODCDA
 14696*    END-IF.
 14697
 14698     MOVE CL-SUPV-ATTN-CD        TO SUPVO.
 14699     MOVE CL-FILE-LOCATION       TO FILETOO.
 14700     MOVE CL-BENEFICIARY         TO BENECDO.
 14701     MOVE AL-UANON               TO SUPVA
 14702                                    FILETOA
 14703                                    BENECDA.
 14704
 14705     IF CLAIM-SWITCH = 'X'
 14706         GO TO 7099-EXIT
 14707     END-IF.
 14708
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 277
* EL130.cbl
 14710 7050-BUILD-MAP-CERT-DATA.
 14711     MOVE CM-CERT-PRIME          TO CERTNOO.
 14712     MOVE CM-CERT-SFX            TO SUFXO.
 14713     MOVE AL-SANON               TO CERTNOA
 14714                                    SUFXA.
 14715
 14716     IF CM-CERT-EFF-DT NOT = LOW-VALUES
 14717         MOVE CM-CERT-EFF-DT     TO DC-BIN-DATE-1
 14718         MOVE ' '                TO DC-OPTION-CODE
 14719         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14720         IF NOT DATE-CONVERSION-ERROR
 14721             MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
 14722         END-IF
 14723     END-IF.
 14724
 14725     MOVE CM-ACCOUNT             TO ACCOUNTO.
 14726     MOVE CM-STATE               TO STATEO.
 14727     MOVE CM-CARRIER             TO CRTCARRO.
 14728     MOVE CM-GROUPING            TO GROUPO.
 14729     MOVE CM-INSURED-LAST-NAME   TO CRTLNMEO.
 14730     MOVE CM-INSURED-FIRST-NAME  TO CRTFNMEO.
 14731     MOVE CM-INSURED-INITIAL2    TO CRTINITO.
 14732     MOVE CM-INSURED-ISSUE-AGE   TO ISSAGEO.
 14733     MOVE CM-JT-LAST-NAME        TO JNTLNMEO.
 14734     MOVE CM-JT-FIRST-NAME       TO JNTFNMEO.
 14735     MOVE CM-JT-INITIAL          TO JNTINITO.
 14736     MOVE CM-INSURED-JOINT-AGE   TO JNTAGEO.
 14737     MOVE AL-UANON               TO ACCOUNTA
 14738                                    STATEA
 14739                                    CRTCARRA
 14740                                    GROUPA
 14741                                    CRTLNMEA
 14742                                    CRTFNMEA
 14743                                    CRTINITA
 14744                                    JNTLNMEA
 14745                                    JNTFNMEA
 14746                                    JNTINITA.
 14747     MOVE AL-UNNON               TO ISSAGEA
 14748                                    JNTAGEA.
 14749
 14750     IF CM-SSN-STATE   = CM-STATE AND
 14751        CM-SSN-ACCOUNT = CM-ACCOUNT-PRIME
 14752*        NEXT SENTENCE
 14753         CONTINUE
 14754     ELSE
 14755         MOVE CM-SOC-SEC-NO      TO CRTSSNO
 14756     END-IF.
 14757
 14758     MOVE AL-UANON               TO CRTSSNA.
 14759
 14760     MOVE SAVE-DATE              TO DC-GREG-DATE-1-EDIT.
 14761     MOVE '2'                    TO DC-OPTION-CODE.
 14762     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14763     MOVE DC-BIN-DATE-1          TO SAVE-CURRENT-DATE.
 14764
 14765*** READ STATE MASTER RECORD FOR FREE LOOK PERIOD ***
 14766     MOVE SPACES                 TO ELCNTL-KEY.
 14767     MOVE CM-STATE               TO CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 278
* EL130.cbl
 14768     MOVE '3'                    TO CNTL-REC-TYPE.
 14769     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14770     MOVE ZEROS                  TO CNTL-SEQ-NO.
 14771
 14772
 14773
 14774* EXEC CICS READ
 14775*        DATASET  (ELCNTL-DSID)
 14776*        SET      (ADDRESS OF CONTROL-FILE)
 14777*        RIDFLD   (ELCNTL-KEY)
 14778*        RESP     (WS-RESPONSE)
 14779*    END-EXEC.
 14780*    MOVE '&"S        E          (  N#00013357' TO DFHEIV0
 14781     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14782     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14783     MOVE X'204E233030303133333537' TO DFHEIV0(25:11)
 14784     CALL 'kxdfhei1' USING DFHEIV0,
 14785           ELCNTL-DSID,
 14786           DFHEIV20,
 14787           DFHEIV99,
 14788           ELCNTL-KEY,
 14789           DFHEIV99,
 14790           DFHEIV99,
 14791           DFHEIV99
 14792     SET ADDRESS OF CONTROL-FILE TO
 14793         DFHEIV20
 14794     MOVE EIBRESP  TO WS-RESPONSE
 14795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14796
 14797
 14798     IF WS-RESP-NOTFND
 14799          MOVE ER-2848           TO EMI-ERROR
 14800          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14801          GO TO 8100-SEND-INITIAL-MAP
 14802     END-IF.
 14803
 14804     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 14805     MOVE CF-ST-VFY-2ND-BENE TO PI-ST-VFY-2ND-BENE.
 14806     MOVE CF-ST-CAUSAL-STATE TO PI-ST-CAUSAL-STATE.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 279
* EL130.cbl
 14808     IF CM-LF-BENEFIT-CD = '00'
 14809         MOVE ZEROS              TO LCVOTRMO
 14810                                    LCVRTRMO
 14811                                    LCVRATEO
 14812                                    LCVBENEO
 14813         MOVE SPACES             TO LCVDSCRO
 14814                                    LCVCDO
 14815                                    LCVKINDO
 14816                                    LCVFORMO
 14817                                    LCVCNDTO
 14818                                    LCVEXITO
 14819                                    LCVSTATO
 14820         IF CLMTYPEL GREATER THAN ZERO AND
 14821            CLMTYPEI = PI-LIFE-OVERRIDE-L1
 14822                MOVE ER-0521     TO EMI-ERROR
 14823                MOVE AL-UABON    TO CLMTYPEA
 14824                MOVE -1          TO CLMTYPEL
 14825                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14826                GO TO 7060-FILL-AH-COVERAGE
 14827         ELSE
 14828             GO TO 7060-FILL-AH-COVERAGE
 14829         END-IF
 14830     END-IF.
 14831
 14832     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 14833     MOVE AL-UANON               TO LCVDSCRA.
 14834     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-HOLD.
 14835     MOVE '4'                    TO WS-REC-TYPE.
 14836     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14837     MOVE WS-BEN-ALPHA-HOLD      TO LCVKINDO.
 14838     MOVE CM-LF-BENEFIT-CD       TO LCVCDO.
 14839     MOVE AL-UANON               TO LCVCDA.
 14840     MOVE CM-LF-ORIG-TERM        TO LCVOTRMO
 14841                                    CP-ORIGINAL-TERM.
 14842     MOVE AL-UNNON               TO LCVOTRMA.
 14843     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 14844     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 14845     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 14846     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 14847     MOVE '4'                    TO CP-REM-TERM-METHOD.
 14848     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 14849
 14850     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 14851     MOVE CP-REMAINING-TERM-3    TO LCVRTRMO.
 14852
 14853     IF CM-LF-PREMIUM-RATE NUMERIC
 14854         MOVE CM-LF-PREMIUM-RATE TO LCVRATEO
 14855     ELSE
 14856         MOVE ZEROS              TO LCVRATEO
 14857     END-IF.
 14858
 14859     MOVE AL-UNNON               TO LCVRATEA.
 14860
 14861     IF CM-LF-ALT-BENEFIT-AMT NOT NUMERIC
 14862         MOVE ZEROS              TO CM-LF-ALT-BENEFIT-AMT
 14863     END-IF.
 14864
 14865     COMPUTE LCVBENEO = CM-LF-BENEFIT-AMT + CM-LF-ALT-BENEFIT-AMT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 280
* EL130.cbl
 14866
 14867     MOVE AL-UNNON               TO LCVBENEA.
 14868
 14869     IF CM-POLICY-FORM-NO NOT = SPACES
 14870         MOVE CM-POLICY-FORM-NO  TO LCVFORMO
 14871     ELSE
 14872         MOVE WS-FORM-HOLD       TO LCVFORMO
 14873     END-IF.
 14874
 14875     MOVE SPACES                 TO WS-FORM-HOLD.
 14876     MOVE 'L'                    TO WS-REC-TYPE.
 14877     PERFORM 7400-READ-STATE THRU 7499-EXIT.
 14878
 14879     IF WS-FORM-HOLD NOT = SPACES
 14880         MOVE WS-FORM-HOLD       TO LCVFORMO
 14881         MOVE AL-UANON           TO LCVFORMA
 14882     END-IF.
 14883
 14884     IF CM-LF-CURRENT-STATUS = '8'
 14885         IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 14886             MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-1
 14887             MOVE ' '             TO DC-OPTION-CODE
 14888             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14889             IF NOT DATE-CONVERSION-ERROR
 14890                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14891                 MOVE AL-UANON            TO LCVCNDTA
 14892             END-IF
 14893         END-IF
 14894     END-IF.
 14895
 14896     IF CM-LF-CURRENT-STATUS = '7'
 14897         IF CM-LF-DEATH-DT NOT = LOW-VALUES
 14898             MOVE CM-LF-DEATH-DT TO DC-BIN-DATE-1
 14899             MOVE ' '            TO DC-OPTION-CODE
 14900             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14901             IF NOT DATE-CONVERSION-ERROR
 14902                 MOVE DC-GREG-DATE-1-EDIT TO LCVCNDTO
 14903                 MOVE AL-UANON   TO LCVCNDTA
 14904             END-IF
 14905         END-IF
 14906     END-IF.
 14907
 14908     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 14909         IF CM-LF-DEATH-EXIT-DT NOT = SPACES
 14910             MOVE ' '            TO DC-OPTION-CODE
 14911             MOVE CM-LF-DEATH-EXIT-DT
 14912                                 TO DC-BIN-DATE-1
 14913             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14914             IF NOT DATE-CONVERSION-ERROR
 14915                 MOVE DC-GREG-DATE-1-EDIT
 14916                                 TO LCVEXITO
 14917             END-IF
 14918         END-IF
 14919     END-IF.
 14920
 14921     IF CM-LF-CURRENT-STATUS = '1' OR = '4'
 14922         IF CP-REMAINING-TERM-3 = ZEROS
 14923             MOVE 'EXPIRED'      TO LCVSTATO
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 281
* EL130.cbl
 14924         ELSE
 14925             MOVE 'ACTIVE'       TO LCVSTATO
 14926         END-IF
 14927     END-IF.
 14928
 14929     IF CM-LF-CURRENT-STATUS = '2'
 14930        MOVE 'PEND  '            TO LCVSTATO
 14931     END-IF.
 14932     IF CM-LF-CURRENT-STATUS = '3'
 14933        MOVE 'RESTORE'           TO LCVSTATO
 14934     END-IF.
 14935     IF CM-LF-CURRENT-STATUS = '5'
 14936        MOVE 'REISSUE'           TO LCVSTATO
 14937     END-IF.
 14938     IF CM-LF-CURRENT-STATUS = '6'
 14939        MOVE 'LMP DIS'           TO LCVSTATO
 14940     END-IF.
 14941     IF CM-LF-CURRENT-STATUS = '7'
 14942        MOVE 'DEATH  '           TO LCVSTATO
 14943     END-IF.
 14944     IF CM-LF-CURRENT-STATUS = '8'
 14945        MOVE 'CANCEL '           TO LCVSTATO
 14946     END-IF.
 14947     IF CM-LF-CURRENT-STATUS = '9'
 14948        MOVE 'RE-ONLY'           TO LCVSTATO
 14949     END-IF.
 14950     IF CM-LF-CURRENT-STATUS = 'V'
 14951        MOVE 'VOID   '           TO LCVSTATO
 14952     END-IF.
 14953     IF CM-LF-CURRENT-STATUS = 'D'
 14954        MOVE 'DECLINE'           TO LCVSTATO
 14955     END-IF.
 14956
 14957     IF PI-COMPANY-ID = 'CID'
 14958         IF CM-LF-BENEFIT-CD >= '2O' AND
 14959            CM-LF-BENEFIT-CD <= '2V'
 14960             MOVE ER-0878       TO EMI-ERROR
 14961             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14962         END-IF
 14963     END-IF.
 14964
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 282
* EL130.cbl
 14966 7060-FILL-AH-COVERAGE.
 14967
 14968     IF CM-AH-BENEFIT-CD = '00'
 14969         MOVE ZEROS              TO ACVOTRMO
 14970                                    ACVRTRMO
 14971                                    ACVRATEO
 14972                                    ACVBENEO
 14973         MOVE SPACES             TO ACVDSCRO
 14974                                    ACVCDO
 14975                                    ACVKINDO
 14976                                    ACVFORMO
 14977                                    ACVCNDTO
 14978                                    ACVEXITO
 14979                                    ACVSTATO
 14980         IF (CLMTYPEL GREATER THAN ZERO AND
 14981             (CLMTYPEI = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' OR 'F'))
 14982             MOVE ER-0521     TO EMI-ERROR
 14983             MOVE AL-UABON    TO CLMTYPEA
 14984             MOVE -1          TO CLMTYPEL
 14985             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14986             GO TO 7070-BUILD-MAP-FINISH
 14987         ELSE
 14988             GO TO 7070-BUILD-MAP-FINISH
 14989         END-IF
 14990     END-IF.
 14991
 14992     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 14993     MOVE CM-AH-BENEFIT-CD       TO ACVCDO WS-BEN-HOLD.
 14994     MOVE AL-UANON               TO ACVDSCRA
 14995                                    ACVCDA.
 14996     MOVE '5'                    TO WS-REC-TYPE.
 14997     PERFORM 7100-READ-BENEFIT THRU 7199-EXIT.
 14998     MOVE WS-BEN-ALPHA-HOLD      TO ACVKINDO.
 14999
 15000     MOVE CM-AH-ORIG-TERM        TO ACVOTRMO
 15001                                    CP-ORIGINAL-TERM.
 15002     MOVE AL-UNNON               TO ACVOTRMA.
 15003
 15004     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 15005     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 15006     MOVE SAVE-CURRENT-DATE      TO CP-VALUATION-DT.
 15007     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 15008     MOVE '4'                    TO CP-REM-TERM-METHOD.
 15009     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 15010
 15011     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 15012     MOVE CP-REMAINING-TERM-3    TO ACVRTRMO.
 15013
 15014     IF CM-AH-PREMIUM-RATE NUMERIC
 15015         MOVE CM-AH-PREMIUM-RATE TO ACVRATEO
 15016     ELSE
 15017         MOVE ZEROS              TO ACVRATEO
 15018     END-IF.
 15019
 15020     MOVE CM-AH-BENEFIT-AMT      TO ACVBENEO.
 15021     MOVE AL-UNNON               TO ACVRATEA
 15022                                    ACVBENEA.
 15023
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 283
* EL130.cbl
 15024     IF CM-POLICY-FORM-NO NOT = SPACES
 15025         MOVE CM-POLICY-FORM-NO  TO ACVFORMO
 15026     ELSE
 15027         MOVE WS-FORM-HOLD       TO ACVFORMO
 15028         MOVE SPACES TO WS-FORM-HOLD
 15029         MOVE 'A'                TO WS-REC-TYPE
 15030         PERFORM 7400-READ-STATE THRU 7499-EXIT
 15031         IF WS-FORM-HOLD NOT = SPACES
 15032             MOVE WS-FORM-HOLD   TO ACVFORMO
 15033         END-IF
 15034     END-IF.
 15035
 15036     MOVE AL-UANON               TO ACVFORMA.
 15037
 15038     IF CM-AH-CURRENT-STATUS = '8'
 15039         IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 15040             MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-1
 15041             MOVE ' '             TO DC-OPTION-CODE
 15042             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15043             IF NOT DATE-CONVERSION-ERROR
 15044                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15045                MOVE AL-UANON    TO ACVCNDTA
 15046             END-IF
 15047         END-IF
 15048     END-IF.
 15049
 15050     IF CM-AH-CURRENT-STATUS = '6' OR '7'
 15051         IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 15052             MOVE CM-AH-SETTLEMENT-DT TO DC-BIN-DATE-1
 15053             MOVE ' '             TO DC-OPTION-CODE
 15054             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15055             IF NOT DATE-CONVERSION-ERROR
 15056                MOVE DC-GREG-DATE-1-EDIT TO ACVCNDTO
 15057                MOVE AL-UANON            TO ACVCNDTA
 15058             END-IF
 15059         END-IF
 15060     END-IF.
 15061
 15062     IF CM-AH-SETTLEMENT-EXIT-DT NOT = LOW-VALUES
 15063         MOVE ' '                TO DC-OPTION-CODE
 15064         MOVE CM-AH-SETTLEMENT-EXIT-DT TO DC-BIN-DATE-1
 15065         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15066         IF NOT DATE-CONVERSION-ERROR
 15067             MOVE DC-GREG-DATE-1-EDIT TO ACVEXITO
 15068         END-IF
 15069     END-IF.
 15070
 15071     IF CM-AH-CURRENT-STATUS = '1' OR = '4'
 15072         IF CP-REMAINING-TERM-3 = ZEROS
 15073             MOVE 'EXPIRED'      TO ACVSTATO
 15074         ELSE
 15075             MOVE 'ACTIVE'       TO ACVSTATO
 15076         END-IF
 15077     END-IF.
 15078
 15079     IF CM-AH-CURRENT-STATUS = '2'
 15080         MOVE 'PEND  '           TO ACVSTATO
 15081     END-IF.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 284
* EL130.cbl
 15082     IF CM-AH-CURRENT-STATUS = '3'
 15083         MOVE 'RESTORE'          TO ACVSTATO
 15084     END-IF.
 15085     IF CM-AH-CURRENT-STATUS = '5'
 15086         MOVE 'REISSUE'          TO ACVSTATO
 15087     END-IF.
 15088     IF CM-AH-CURRENT-STATUS = '6'
 15089         MOVE 'LMP DIS'          TO ACVSTATO
 15090     END-IF.
 15091     IF CM-AH-CURRENT-STATUS = '7'
 15092         MOVE 'DEATH  '          TO ACVSTATO
 15093     END-IF.
 15094     IF CM-AH-CURRENT-STATUS = '8'
 15095         MOVE 'CANCEL '          TO ACVSTATO
 15096     END-IF.
 15097     IF CM-AH-CURRENT-STATUS = '9'
 15098         MOVE 'RE-ONLY'          TO ACVSTATO
 15099     END-IF.
 15100     IF CM-AH-CURRENT-STATUS = 'V'
 15101         MOVE 'VOID   '          TO ACVSTATO
 15102     END-IF.
 15103     IF CM-AH-CURRENT-STATUS = 'D'
 15104         MOVE 'DECLINE'          TO ACVSTATO
 15105     END-IF.
 15106
 15107     IF PI-COMPANY-ID = 'DCC' OR 'VPP'
 15108        IF CM-ACCOUNT (9:2) = 'BI'
 15109           MOVE CM-COMPANY-CD    TO CTRLR-COMP-CD
 15110           MOVE CM-CARRIER       TO CTRLR-CARRIER
 15111           MOVE CM-GROUPING      TO CTRLR-GROUPING
 15112           MOVE CM-STATE         TO CTRLR-STATE
 15113           MOVE CM-ACCOUNT       TO CTRLR-ACCOUNT
 15114           MOVE CM-CERT-EFF-DT   TO CTRLR-EFF-DT
 15115           MOVE CM-CERT-NO       TO CTRLR-CERT-NO
 15116           MOVE 'C'              TO CTRLR-REC-TYPE
 15117
 15118* EXEC CICS READ
 15119*            DATASET  (ELCRTT-DSID)
 15120*            SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 15121*            RIDFLD   (ELCRTT-KEY)
 15122*            RESP     (WS-RESPONSE)
 15123*          END-EXEC
 15124*    MOVE '&"S        E          (  N#00013683' TO DFHEIV0
 15125     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15126     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15127     MOVE X'204E233030303133363833' TO DFHEIV0(25:11)
 15128     CALL 'kxdfhei1' USING DFHEIV0,
 15129           ELCRTT-DSID,
 15130           DFHEIV20,
 15131           DFHEIV99,
 15132           ELCRTT-KEY,
 15133           DFHEIV99,
 15134           DFHEIV99,
 15135           DFHEIV99
 15136     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 15137         DFHEIV20
 15138     MOVE EIBRESP  TO WS-RESPONSE
 15139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 285
* EL130.cbl
 15140           IF WS-RESP-NORMAL
 15141               MOVE CS-VIN-NUMBER   TO WS-DIAG-VIN
 15142               MOVE WS-DIAG-VIN-MSG TO DIAGO
 15143               MOVE AL-UANON        TO DIAGA
 15144           END-IF
 15145        END-IF
 15146     END-IF.
 15147
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 286
* EL130.cbl
 15149 7070-BUILD-MAP-FINISH.
 15150     MOVE CM-LOAN-APR            TO APRO.
 15151     MOVE CM-PAY-FREQUENCY       TO PMTFREQO.
 15152     MOVE CM-IND-GRP-TYPE        TO INDGRPO.
 15153     MOVE CM-PREMIUM-TYPE        TO PREMTYPO.
 15154     MOVE AL-UNNON               TO APRA
 15155                                    PMTFREQA.
 15156     MOVE AL-UANON               TO INDGRPA
 15157                                    PREMTYPA.
 15158
 15159     IF (CM-SPECIAL-REIN-CODE NOT = SPACES AND LOW-VALUES)
 15160         MOVE CM-SPECIAL-REIN-CODE   TO REINCDO
 15161         MOVE AL-UANON               TO REINCDA
 15162     END-IF.
 15163
 15164     IF CM-LAST-ADD-ON-DT = SPACES OR LOW-VALUES
 15165*        NEXT SENTENCE
 15166         CONTINUE
 15167     ELSE
 15168         MOVE CM-LAST-ADD-ON-DT  TO DC-BIN-DATE-1
 15169         MOVE ' '                TO DC-OPTION-CODE
 15170         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15171         IF NOT DATE-CONVERSION-ERROR
 15172             MOVE DC-GREG-DATE-1-EDIT TO ADDONDTO
 15173             MOVE AL-UANON            TO ADDONDTA
 15174         END-IF
 15175     END-IF.
 15176
 15177     IF CLAIM-SWITCH = 'N'
 15178         IF SEXL = ZEROS
 15179             MOVE CM-INSURED-SEX TO SEXO
 15180*            MOVE AL-UANON       TO SEXA
 15181         END-IF
 15182     END-IF.
 15183
 15184     IF CM-MEMB-ACCOUNT NOT = CM-ACCOUNT-PRIME
 15185         MOVE CM-MEMBER-NO       TO MEMBERO
 15186         MOVE AL-UANON           TO MEMBERA
 15187     END-IF.
 15188
 15189     IF MAINTI = 'A'
 15190         IF (LOANNOL = ZEROS OR
 15191             EIBAID = DFHPF5)
 15192             MOVE CM-LOAN-NUMBER TO LOANNOO
 15193             MOVE AL-UANON       TO LOANNOA
 15194         ELSE
 15195*            NEXT SENTENCE
 15196             CONTINUE
 15197         END-IF
 15198     ELSE
 15199         MOVE CM-LOAN-NUMBER     TO LOANNOO
 15200         MOVE AL-UANON           TO LOANNOA
 15201     END-IF.
 15202
 15203     IF MAINTI = 'A'
 15204         IF (LOANBALL = ZEROS OR
 15205             EIBAID = DFHPF5)
 15206             MOVE CM-LOAN-BALANCE TO LOANBALO
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 287
* EL130.cbl
 15207             MOVE AL-UNNON       TO LOANBALA
 15208         ELSE
 15209*            NEXT SENTENCE
 15210             CONTINUE
 15211         END-IF
 15212     ELSE
 15213         MOVE CM-LOAN-BALANCE    TO LOANBALO
 15214         MOVE AL-UNNON           TO LOANBALA
 15215     END-IF.
 15216
 15217     IF CM-PREMIUM-TYPE NOT = '3'
 15218         IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15219             PERFORM 7200-PROTECT-CERT-FIELDS
 15220         ELSE
 15221             PERFORM 7300-RESET-KEY-ATTRBS
 15222         END-IF
 15223     ELSE
 15224         PERFORM 7300-RESET-KEY-ATTRBS
 15225     END-IF.
 15226
 15227*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 15228*        NEXT SENTENCE
 15229*        CONTINUE
 15230*    ELSE
 15231         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA.
 15232*    END-IF.
 15233
 15234 7099-EXIT.
 15235     EXIT.
 15236
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 288
* EL130.cbl
 15238 7100-READ-BENEFIT.
 15239
 15240
 15241* EXEC CICS HANDLE CONDITION
 15242*         NOTFND   (7120-NOT-FOUND)
 15243*    END-EXEC.
 15244*    MOVE '"$I                   ! F #00013789' TO DFHEIV0
 15245     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15246     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15247     MOVE X'4620233030303133373839' TO DFHEIV0(25:11)
 15248     CALL 'kxdfhei1' USING DFHEIV0
 15249     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15250
 15251
 15252     MOVE SPACES                 TO ELCNTL-KEY.
 15253     MOVE WS-BEN-HOLD            TO CNTL-BENEFIT.
 15254     MOVE WS-REC-TYPE            TO CNTL-REC-TYPE.
 15255     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15256     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15257
 15258 7105-READ-FILE.
 15259     PERFORM 7975-READ-CNTL-GTEQ THRU 7975-EXIT.
 15260
 15261     IF PI-COMPANY-ID NOT = CF-COMPANY-ID  OR
 15262        WS-REC-TYPE   NOT = CF-RECORD-TYPE
 15263          GO TO 7120-NOT-FOUND
 15264     END-IF.
 15265
 15266     MOVE 1                      TO SUB.
 15267 7110-LOOP.
 15268     IF SUB = 9
 15269         GO TO 7120-NOT-FOUND
 15270     END-IF.
 15271
 15272     IF WS-BEN-HOLD NOT = CF-BENEFIT-CODE (SUB)
 15273         ADD 1                   TO SUB
 15274         GO TO 7110-LOOP
 15275     END-IF.
 15276
 15277     if ws-rec-type = '4'
 15278        move cf-joint-indicator (sub)
 15279                                 to ws-lf-joint-indicator
 15280     else
 15281        move cf-joint-indicator (sub)
 15282                                 to ws-ah-joint-indicator
 15283     end-if
 15284     MOVE CF-BENEFIT-ALPHA (SUB)    TO WS-BEN-ALPHA-HOLD.
 15285     MOVE CF-CO-EARNINGS-CALC (SUB) TO WS-EARNINGS-CALC.
 15286     MOVE CF-SPECIAL-CALC-CD (SUB)  TO WS-SPECIAL-CALC-CD.
 15287
 15288     GO TO 7199-EXIT.
 15289
 15290 7120-NOT-FOUND.
 15291     MOVE SPACES                 TO WS-BEN-ALPHA-HOLD
 15292                                    WS-FORM-HOLD.
 15293
 15294 7199-EXIT.
 15295      EXIT.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 289
* EL130.cbl
 15296
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 290
* EL130.cbl
 15298 7200-PROTECT-CERT-FIELDS.
 15299     MOVE AL-SANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15300                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15301                                LCVFORMA ACVFORMA JNTLNMEA
 15302                                JNTFNMEA JNTINITA.
 15303
 15304     IF CM-LF-CURRENT-STATUS = '2' OR
 15305        CM-AH-CURRENT-STATUS = '2'
 15306         MOVE AL-SANON           TO LOANNOA LOANBALA PREMTYPA
 15307     END-IF.
 15308
 15309     MOVE AL-SANOF TO
 15310            CRTINITA   ISSAGEA    JNTAGEA    CRTSSNA   ADDONDTA
 15311            LCVDSCRA   LCVCDA     LCVOTRMA   LCVBENEA  LCVCNDTA
 15312            ACVDSCRA   ACVCDA     ACVOTRMA   ACVBENEA  ACVCNDTA
 15313            APRA       PMTFREQA   INDGRPA    MEMBERA   REINCDA
 15314            LCVRATEA   ACVRATEA.
 15315
 15316     MOVE 'S'                    TO CERTMTI.
 15317
 15318 7300-RESET-KEY-ATTRBS.
 15319     MOVE AL-UANON           TO CERTMTA EFFDTA ACCOUNTA STATEA
 15320                                CRTCARRA GROUPA CRTLNMEA CRTFNMEA
 15321                                LCVFORMA ACVFORMA JNTLNMEA
 15322                                JNTFNMEA JNTINITA.
 15323
 15324     IF NOT CERT-WAS-CREATED-FOR-CLAIM
 15325         MOVE AL-SANOF           TO REINCDA
 15326     END-IF.
 15327
 15328     MOVE 'S'                    TO CERTMTI.
 15329
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 291
* EL130.cbl
 15331 7400-READ-STATE.
 15332
 15333
 15334* EXEC CICS HANDLE CONDITION
 15335*         NOTFND   (7499-EXIT)
 15336*    END-EXEC.
 15337*    MOVE '"$I                   ! G #00013874' TO DFHEIV0
 15338     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15339     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15340     MOVE X'4720233030303133383734' TO DFHEIV0(25:11)
 15341     CALL 'kxdfhei1' USING DFHEIV0
 15342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15343
 15344
 15345     MOVE SPACES                 TO ELCNTL-KEY.
 15346     MOVE CM-STATE               TO CNTL-ACCESS.
 15347     MOVE '3'                    TO CNTL-REC-TYPE.
 15348     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15349     MOVE ZEROS                  TO CNTL-SEQ-NO.
 15350
 15351     PERFORM 7970-READ-CNTL THRU 7970-EXIT.
 15352
 15353     MOVE 1                      TO SUB.
 15354
 15355 7410-LOOP.
 15356     IF SUB = 21
 15357        GO TO 7499-EXIT
 15358     END-IF.
 15359
 15360*    IF (WS-BEN-HOLD  = CF-ST-BENEFIT-CD (SUB))  AND
 15361*       (WS-REC-TYPE  = CF-ST-BENEFIT-KIND (SUB))
 15362*        MOVE CF-ST-FORM-NO (SUB) TO WS-FORM-HOLD
 15363*        GO TO 7499-EXIT.
 15364
 15365     ADD 1                       TO SUB.
 15366     GO TO 7410-LOOP.
 15367
 15368 7499-EXIT.
 15369      EXIT.
 15370
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 292
* EL130.cbl
 15372 7500-BROWSE-FOR-DUPLICATE.
 15373
 15374     MOVE 'N'                    TO INCUR-DTE-DUPE-SW.
 15375
 15376
 15377
 15378* EXEC CICS HANDLE CONDITION
 15379*        NOTFND   (7500-EXIT)
 15380*        DUPKEY   (7500-DUPLICATE-KEY)
 15381*        ENDFILE  (7500-EXIT)
 15382*    END-EXEC.
 15383*    MOVE '"$I$''                 ! H #00013910' TO DFHEIV0
 15384     MOVE X'222449242720202020202020' TO DFHEIV0(1:12)
 15385     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15386     MOVE X'4820233030303133393130' TO DFHEIV0(25:11)
 15387     CALL 'kxdfhei1' USING DFHEIV0
 15388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15389
 15390
 15391
 15392
 15393* EXEC CICS STARTBR
 15394*        DATASET    (ELMSTR5-DSID)
 15395*        RIDFLD     (ELMSTR5-KEY)
 15396*    END-EXEC.
 15397     MOVE 0
 15398       TO DFHEIV11
 15399*    MOVE '&,         G          &   #00013917' TO DFHEIV0
 15400     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15401     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15402     MOVE X'2020233030303133393137' TO DFHEIV0(25:11)
 15403     CALL 'kxdfhei1' USING DFHEIV0,
 15404           ELMSTR5-DSID,
 15405           ELMSTR5-KEY,
 15406           DFHEIV99,
 15407           DFHEIV11,
 15408           DFHEIV99
 15409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15410
 15411
 15412
 15413
 15414* EXEC CICS HANDLE CONDITION
 15415*        ENDFILE  (7500-END-BROWSE)
 15416*    END-EXEC.
 15417*    MOVE '"$''                   ! I #00013923' TO DFHEIV0
 15418     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15419     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15420     MOVE X'4920233030303133393233' TO DFHEIV0(25:11)
 15421     CALL 'kxdfhei1' USING DFHEIV0
 15422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15423
 15424
 15425 7500-READ-CLAIM-LOOP.
 15426
 15427
 15428
 15429* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 293
* EL130.cbl
 15430*        DATASET   (ELMSTR5-DSID)
 15431*        SET       (ADDRESS OF CLAIM-MASTER)
 15432*        RIDFLD    (ELMSTR5-KEY)
 15433*    END-EXEC.
 15434     MOVE 0
 15435       TO DFHEIV11
 15436*    MOVE '&.S                   )   #00013930' TO DFHEIV0
 15437     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15438     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15439     MOVE X'2020233030303133393330' TO DFHEIV0(25:11)
 15440     CALL 'kxdfhei1' USING DFHEIV0,
 15441           ELMSTR5-DSID,
 15442           DFHEIV20,
 15443           DFHEIV99,
 15444           ELMSTR5-KEY,
 15445           DFHEIV99,
 15446           DFHEIV11,
 15447           DFHEIV99,
 15448           DFHEIV99
 15449     SET ADDRESS OF CLAIM-MASTER TO
 15450         DFHEIV20
 15451     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15452
 15453
 15454 7500-DUPLICATE-KEY.
 15455
 15456     IF CL-COMPANY-CD     NOT = CM-COMPANY-CD  OR
 15457        CL-CERT-CARRIER   NOT = CM-CARRIER     OR
 15458        CL-CERT-GROUPING  NOT = CM-GROUPING    OR
 15459        CL-CERT-STATE     NOT = CM-STATE       OR
 15460        CL-CERT-ACCOUNT   NOT = CM-ACCOUNT     OR
 15461        CL-CERT-EFF-DT    NOT = CM-CERT-EFF-DT OR
 15462        CL-CERT-NO        NOT = CM-CERT-NO
 15463           GO TO 7500-CHECK-MATCH-COUNT
 15464     END-IF.
 15465
 15466     MOVE 'H'                    TO INCUR-DTE-DUPE-SW.
 15467
 15468     IF CL-INCURRED-DT = PI-SAVE-INCUR-DT
 15469        MOVE 'Y'                 TO INCUR-DTE-DUPE-SW
 15470        GO TO 7500-END-BROWSE
 15471     ELSE
 15472        GO TO 7500-READ-CLAIM-LOOP
 15473     END-IF.
 15474
 15475 7500-CHECK-MATCH-COUNT.
 15476
 15477     IF CL-COMPANY-CD = CM-COMPANY-CD AND
 15478        CL-CERT-NO    = CM-CERT-NO
 15479          GO TO 7500-READ-CLAIM-LOOP
 15480     END-IF.
 15481
 15482 7500-END-BROWSE.
 15483
 15484
 15485
 15486* EXEC CICS ENDBR
 15487*        DATASET   (ELMSTR5-DSID)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 294
* EL130.cbl
 15488*    END-EXEC.
 15489     MOVE 0
 15490       TO DFHEIV11
 15491*    MOVE '&2                    $   #00013967' TO DFHEIV0
 15492     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15493     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15494     MOVE X'2020233030303133393637' TO DFHEIV0(25:11)
 15495     CALL 'kxdfhei1' USING DFHEIV0,
 15496           ELMSTR5-DSID,
 15497           DFHEIV11,
 15498           DFHEIV99
 15499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15500
 15501
 15502 7500-EXIT.
 15503     EXIT.
 15504
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 295
* EL130.cbl
 15506 7550-FALL-THRU-PARA.
 15507
 15508
 15509
 15510* EXEC CICS DUMP
 15511*         DUMPCODE ('E130')
 15512*         TASK
 15513*    END-EXEC.
 15514     MOVE 'E130' TO DFHEIV5
 15515*    MOVE '<"   T                $   #00013978' TO DFHEIV0
 15516     MOVE X'3C2220202054202020202020' TO DFHEIV0(1:12)
 15517     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15518     MOVE X'2020233030303133393738' TO DFHEIV0(25:11)
 15519     CALL 'kxdfhei1' USING DFHEIV0,
 15520           DFHEIV5,
 15521           DFHEIV99,
 15522           DFHEIV99
 15523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15524
 15525
 15526
 15527
 15528* EXEC CICS RETURN
 15529*    END-EXEC.
 15530*    MOVE '.(                    ''   #00013984' TO DFHEIV0
 15531     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 15532     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15533     MOVE X'2020233030303133393834' TO DFHEIV0(25:11)
 15534     CALL 'kxdfhei1' USING DFHEIV0,
 15535           DFHEIV99,
 15536           DFHEIV99,
 15537           DFHEIV99,
 15538           DFHEIV99,
 15539           DFHEIV99,
 15540           DFHEIV99
 15541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15542
 15543
 15544 7600-BROWSE-CLAIM.
 15545
 15546
 15547
 15548* EXEC CICS READ
 15549*        DATASET(ELMSTR-DSID)
 15550*        SET    (ADDRESS OF CLAIM-MASTER)
 15551*        RIDFLD (ELMSTR-KEY)
 15552*        GENERIC
 15553*        EQUAL
 15554*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15555*    END-EXEC.
 15556*    MOVE '&"S  KG    E          (   #00013990' TO DFHEIV0
 15557     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15558     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15559     MOVE X'2020233030303133393930' TO DFHEIV0(25:11)
 15560     CALL 'kxdfhei1' USING DFHEIV0,
 15561           ELMSTR-DSID,
 15562           DFHEIV20,
 15563           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 296
* EL130.cbl
 15564           ELMSTR-KEY,
 15565           ELMSTR-GENERIC-LENGTH,
 15566           DFHEIV99,
 15567           DFHEIV99
 15568     SET ADDRESS OF CLAIM-MASTER TO
 15569         DFHEIV20
 15570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15571
 15572
 15573     MOVE CL-CERT-PRIME          TO CERTNOI.
 15574     MOVE CL-CERT-SFX            TO SUFXI.
 15575
 15576 7610-BROWSE-CLAIM-LOOP.
 15577
 15578     MOVE LOW-VALUES             TO BCERT1O
 15579                                    BSUFX1O
 15580                                    BCERT2O
 15581                                    BSUFX2O
 15582                                    BCERT3O
 15583                                    BSUFX3O
 15584                                    BCERT4O
 15585                                    BSUFX4O
 15586                                    BCERT5O
 15587                                    BSUFX5O.
 15588
 15589     MOVE ELMSTR-KEY             TO SAVE-ELMSTR-KEY.
 15590
 15591
 15592
 15593* EXEC CICS HANDLE CONDITION
 15594*        ENDFILE  (7630-END-BROWSE)
 15595*    END-EXEC.
 15596*    MOVE '"$''                   ! J #00014018' TO DFHEIV0
 15597     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15598     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15599     MOVE X'4A20233030303134303138' TO DFHEIV0(25:11)
 15600     CALL 'kxdfhei1' USING DFHEIV0
 15601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15602
 15603
 15604
 15605
 15606* EXEC CICS STARTBR
 15607*        DATASET    (ELMSTR-DSID)
 15608*        RIDFLD     (ELMSTR-KEY)
 15609*    END-EXEC.
 15610     MOVE 0
 15611       TO DFHEIV11
 15612*    MOVE '&,         G          &   #00014023' TO DFHEIV0
 15613     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15614     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15615     MOVE X'2020233030303134303233' TO DFHEIV0(25:11)
 15616     CALL 'kxdfhei1' USING DFHEIV0,
 15617           ELMSTR-DSID,
 15618           ELMSTR-KEY,
 15619           DFHEIV99,
 15620           DFHEIV11,
 15621           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 297
* EL130.cbl
 15622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15623
 15624
 15625     MOVE +1                     TO WS-ASSOCIATED-CERTS.
 15626
 15627 7620-READ-CLAIM-LOOP.
 15628
 15629
 15630
 15631* EXEC CICS READNEXT
 15632*        DATASET   (ELMSTR-DSID)
 15633*        SET       (ADDRESS OF CLAIM-MASTER)
 15634*        RIDFLD    (ELMSTR-KEY)
 15635*    END-EXEC.
 15636     MOVE 0
 15637       TO DFHEIV11
 15638*    MOVE '&.S                   )   #00014033' TO DFHEIV0
 15639     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15640     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15641     MOVE X'2020233030303134303333' TO DFHEIV0(25:11)
 15642     CALL 'kxdfhei1' USING DFHEIV0,
 15643           ELMSTR-DSID,
 15644           DFHEIV20,
 15645           DFHEIV99,
 15646           ELMSTR-KEY,
 15647           DFHEIV99,
 15648           DFHEIV11,
 15649           DFHEIV99,
 15650           DFHEIV99
 15651     SET ADDRESS OF CLAIM-MASTER TO
 15652         DFHEIV20
 15653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15654
 15655
 15656     IF CL-COMPANY-CD  NOT = PI-COMPANY-CD  OR
 15657        CL-CARRIER     NOT = CLMCARRI       OR
 15658        CL-CLAIM-NO    NOT = CLMNOI
 15659          GO TO 7630-END-BROWSE
 15660     END-IF.
 15661
 15662     IF WS-ASSOCIATED-CERTS = 1
 15663         MOVE CL-CERT-PRIME      TO BCERT1O
 15664         MOVE CL-CERT-SFX        TO BSUFX1O
 15665     END-IF.
 15666
 15667     IF WS-ASSOCIATED-CERTS = 2
 15668         MOVE CL-CERT-PRIME      TO BCERT2O
 15669         MOVE CL-CERT-SFX        TO BSUFX2O
 15670     END-IF.
 15671
 15672     IF WS-ASSOCIATED-CERTS = 3
 15673         MOVE CL-CERT-PRIME      TO BCERT3O
 15674         MOVE CL-CERT-SFX        TO BSUFX3O
 15675     END-IF.
 15676
 15677     IF WS-ASSOCIATED-CERTS = 4
 15678         MOVE CL-CERT-PRIME      TO BCERT4O
 15679         MOVE CL-CERT-SFX        TO BSUFX4O
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 298
* EL130.cbl
 15680     END-IF.
 15681
 15682     IF WS-ASSOCIATED-CERTS = 5
 15683         MOVE CL-CERT-PRIME      TO BCERT5O
 15684         MOVE CL-CERT-SFX        TO BSUFX5O
 15685     ELSE
 15686         ADD +1                  TO WS-ASSOCIATED-CERTS
 15687         GO TO 7620-READ-CLAIM-LOOP
 15688     END-IF.
 15689
 15690 7630-END-BROWSE.
 15691
 15692
 15693
 15694* EXEC CICS ENDBR
 15695*        DATASET   (ELMSTR-DSID)
 15696*    END-EXEC.
 15697     MOVE 0
 15698       TO DFHEIV11
 15699*    MOVE '&2                    $   #00014076' TO DFHEIV0
 15700     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15701     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15702     MOVE X'2020233030303134303736' TO DFHEIV0(25:11)
 15703     CALL 'kxdfhei1' USING DFHEIV0,
 15704           ELMSTR-DSID,
 15705           DFHEIV11,
 15706           DFHEIV99
 15707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15708
 15709
 15710 7640-HIGHLIGHT-CERT-DISPLAYED.
 15711
 15712     MOVE SAVE-ELMSTR-KEY        TO ELMSTR-KEY.
 15713     MOVE AL-SANON               TO BCERT1A
 15714                                    BSUFX1A
 15715                                    BCERT2A
 15716                                    BSUFX2A
 15717                                    BCERT3A
 15718                                    BSUFX3A
 15719                                    BCERT4A
 15720                                    BSUFX4A
 15721                                    BCERT5A
 15722                                    BSUFX5A.
 15723
 15724     IF BCERT1O = CERTNOI AND
 15725        BSUFX1O = SUFXI
 15726            MOVE AL-SABON        TO BCERT1A
 15727                                    BSUFX1A
 15728     END-IF.
 15729
 15730     IF BCERT2O = CERTNOI AND
 15731        BSUFX2O = SUFXI
 15732            MOVE AL-SABON        TO BCERT2A
 15733                                    BSUFX2A
 15734     END-IF.
 15735
 15736     IF BCERT3O = CERTNOI AND
 15737        BSUFX3O = SUFXI
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 299
* EL130.cbl
 15738            MOVE AL-SABON        TO BCERT3A
 15739                                    BSUFX3A
 15740     END-IF.
 15741
 15742     IF BCERT4O = CERTNOI AND
 15743        BSUFX4O = SUFXI
 15744            MOVE AL-SABON        TO BCERT4A
 15745                                    BSUFX4A
 15746     END-IF.
 15747
 15748     IF BCERT5O = CERTNOI AND
 15749        BSUFX5O = SUFXI
 15750            MOVE AL-SABON        TO BCERT5A
 15751                                    BSUFX5A
 15752     END-IF.
 15753
 15754 7699-EXIT.
 15755     EXIT.
 15756
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 300
* EL130.cbl
 15758 7700-CHECK-SEQUENCE.
 15759
 15760
 15761
 15762* EXEC CICS HANDLE CONDITION
 15763*        ENDFILE  (7799-EXIT)
 15764*        NOTFND   (7799-EXIT)
 15765*    END-EXEC.
 15766*    MOVE '"$''I                  ! K #00014131' TO DFHEIV0
 15767     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 15768     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15769     MOVE X'4B20233030303134313331' TO DFHEIV0(25:11)
 15770     CALL 'kxdfhei1' USING DFHEIV0
 15771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15772
 15773
 15774
 15775
 15776* EXEC CICS READ
 15777*        DATASET(ELMSTR-DSID)
 15778*        SET    (ADDRESS OF CLAIM-MASTER)
 15779*        RIDFLD (ELMSTR-KEY)
 15780*        GENERIC
 15781*        EQUAL
 15782*        KEYLENGTH(ELMSTR-GENERIC-LENGTH)
 15783*    END-EXEC.
 15784*    MOVE '&"S  KG    E          (   #00014137' TO DFHEIV0
 15785     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
 15786     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15787     MOVE X'2020233030303134313337' TO DFHEIV0(25:11)
 15788     CALL 'kxdfhei1' USING DFHEIV0,
 15789           ELMSTR-DSID,
 15790           DFHEIV20,
 15791           DFHEIV99,
 15792           ELMSTR-KEY,
 15793           ELMSTR-GENERIC-LENGTH,
 15794           DFHEIV99,
 15795           DFHEIV99
 15796     SET ADDRESS OF CLAIM-MASTER TO
 15797         DFHEIV20
 15798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15799
 15800
 15801     COMPUTE WS-ASSOC-CERT-TOTAL =
 15802             CL-ASSOC-CERT-TOTAL + ONE-OR-MIN1.
 15803
 15804     GO TO 7799-EXIT.
 15805
 15806 7710-RESEQUENCE-CLAIMS.
 15807
 15808
 15809
 15810* EXEC CICS HANDLE CONDITION
 15811*        ENDFILE  (7790-END-BROWSE)
 15812*    END-EXEC.
 15813*    MOVE '"$''                   ! L #00014154' TO DFHEIV0
 15814     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 15815     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 301
* EL130.cbl
 15816     MOVE X'4C20233030303134313534' TO DFHEIV0(25:11)
 15817     CALL 'kxdfhei1' USING DFHEIV0
 15818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15819
 15820
 15821
 15822
 15823* EXEC CICS STARTBR
 15824*        DATASET    (ELMSTR-DSID)
 15825*        RIDFLD     (ELMSTR-KEY)
 15826*    END-EXEC.
 15827     MOVE 0
 15828       TO DFHEIV11
 15829*    MOVE '&,         G          &   #00014159' TO DFHEIV0
 15830     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 15831     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 15832     MOVE X'2020233030303134313539' TO DFHEIV0(25:11)
 15833     CALL 'kxdfhei1' USING DFHEIV0,
 15834           ELMSTR-DSID,
 15835           ELMSTR-KEY,
 15836           DFHEIV99,
 15837           DFHEIV11,
 15838           DFHEIV99
 15839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15840
 15841
 15842     ADD +1 TO WS-ASSOC-CERT-SEQU
 15843               WS-READNEXT-SWITCH.
 15844
 15845 7720-READ-CLAIM-LOOP.
 15846
 15847
 15848
 15849* EXEC CICS READNEXT
 15850*        DATASET   (ELMSTR-DSID)
 15851*        SET       (ADDRESS OF CLAIM-MASTER)
 15852*        RIDFLD    (ELMSTR-KEY)
 15853*    END-EXEC.
 15854     MOVE 0
 15855       TO DFHEIV11
 15856*    MOVE '&.S                   )   #00014170' TO DFHEIV0
 15857     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 15858     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 15859     MOVE X'2020233030303134313730' TO DFHEIV0(25:11)
 15860     CALL 'kxdfhei1' USING DFHEIV0,
 15861           ELMSTR-DSID,
 15862           DFHEIV20,
 15863           DFHEIV99,
 15864           ELMSTR-KEY,
 15865           DFHEIV99,
 15866           DFHEIV11,
 15867           DFHEIV99,
 15868           DFHEIV99
 15869     SET ADDRESS OF CLAIM-MASTER TO
 15870         DFHEIV20
 15871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15872
 15873
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 302
* EL130.cbl
 15874     IF WS-READNEXT-SWITCH = 1
 15875         ADD 1 TO WS-READNEXT-SWITCH
 15876         GO TO 7720-READ-CLAIM-LOOP
 15877     END-IF.
 15878
 15879 7730-END-BROWSE.
 15880
 15881
 15882
 15883* EXEC CICS ENDBR
 15884*        DATASET   (ELMSTR-DSID)
 15885*    END-EXEC.
 15886     MOVE 0
 15887       TO DFHEIV11
 15888*    MOVE '&2                    $   #00014184' TO DFHEIV0
 15889     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15890     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15891     MOVE X'2020233030303134313834' TO DFHEIV0(25:11)
 15892     CALL 'kxdfhei1' USING DFHEIV0,
 15893           ELMSTR-DSID,
 15894           DFHEIV11,
 15895           DFHEIV99
 15896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15897
 15898
 15899 7740-READ-CLAIM-UPDATE.
 15900
 15901     IF CL-COMPANY-CD NOT = WS-SAVE-COMPANY-CD OR
 15902        CL-CARRIER    NOT = WS-SAVE-CARRIER    OR
 15903        CL-CLAIM-NO   NOT = WS-SAVE-CLAIM-NO
 15904          GO TO 7799-EXIT
 15905     ELSE
 15906          MOVE ZERO              TO WS-READNEXT-SWITCH
 15907     END-IF.
 15908
 15909
 15910
 15911* EXEC CICS READ
 15912*        DATASET(ELMSTR-DSID)
 15913*        SET    (ADDRESS OF CLAIM-MASTER)
 15914*        RIDFLD (ELMSTR-KEY)
 15915*        UPDATE
 15916*    END-EXEC.
 15917*    MOVE '&"S        EU         (   #00014199' TO DFHEIV0
 15918     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15919     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15920     MOVE X'2020233030303134313939' TO DFHEIV0(25:11)
 15921     CALL 'kxdfhei1' USING DFHEIV0,
 15922           ELMSTR-DSID,
 15923           DFHEIV20,
 15924           DFHEIV99,
 15925           ELMSTR-KEY,
 15926           DFHEIV99,
 15927           DFHEIV99,
 15928           DFHEIV99
 15929     SET ADDRESS OF CLAIM-MASTER TO
 15930         DFHEIV20
 15931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 303
* EL130.cbl
 15932
 15933
 15934     MOVE WS-ASSOC-CERT-TOTAL    TO CL-ASSOC-CERT-TOTAL.
 15935     MOVE WS-ASSOC-CERT-SEQU     TO CL-ASSOC-CERT-SEQU.
 15936
 15937
 15938
 15939* EXEC CICS REWRITE
 15940*         DATASET     (ELMSTR-DSID)
 15941*         FROM        (CLAIM-MASTER)
 15942*    END-EXEC.
 15943     MOVE LENGTH OF
 15944      CLAIM-MASTER
 15945       TO DFHEIV11
 15946*    MOVE '&& L                  %   #00014210' TO DFHEIV0
 15947     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15948     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15949     MOVE X'2020233030303134323130' TO DFHEIV0(25:11)
 15950     CALL 'kxdfhei1' USING DFHEIV0,
 15951           ELMSTR-DSID,
 15952           CLAIM-MASTER,
 15953           DFHEIV11,
 15954           DFHEIV99
 15955     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15956
 15957
 15958     GO TO 7710-RESEQUENCE-CLAIMS.
 15959
 15960 7790-END-BROWSE.
 15961
 15962
 15963
 15964* EXEC CICS ENDBR
 15965*        DATASET   (ELMSTR-DSID)
 15966*    END-EXEC.
 15967     MOVE 0
 15968       TO DFHEIV11
 15969*    MOVE '&2                    $   #00014220' TO DFHEIV0
 15970     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 15971     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15972     MOVE X'2020233030303134323230' TO DFHEIV0(25:11)
 15973     CALL 'kxdfhei1' USING DFHEIV0,
 15974           ELMSTR-DSID,
 15975           DFHEIV11,
 15976           DFHEIV99
 15977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15978
 15979
 15980 7799-EXIT.
 15981     EXIT.
 15982
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 304
* EL130.cbl
 15984************************************************
 15985*  I/O REQUESTS AGAINST ACTIVITY TRAILER FILE  *
 15986************************************************
 15987
 15988 7900-READ-ACTV-UPDATE.
 15989     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15990     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 15991     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 15992     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 15993     MOVE +0                     TO TRLR-SEQ-NO.
 15994     MOVE '1'                    TO TRLR-TYPE.
 15995     GO TO 7900-READ-TRAILER-UPDATE.
 15996
 15997 7900-READ-NINETY-UPDATE.
 15998     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 15999     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16000     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16001     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16002     MOVE +90                    TO TRLR-SEQ-NO.
 16003     MOVE '6'                    TO TRLR-TYPE.
 16004
 16005 7900-READ-TRAILER-UPDATE.
 16006
 16007
 16008* EXEC CICS READ  UPDATE
 16009*        DATASET    (ELTRLR-DSID)
 16010*        SET        (ADDRESS OF ACTIVITY-TRAILERS)
 16011*        RIDFLD     (ELTRLR-KEY)
 16012*    END-EXEC.
 16013*    MOVE '&"S        EU         (   #00014251' TO DFHEIV0
 16014     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16015     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16016     MOVE X'2020233030303134323531' TO DFHEIV0(25:11)
 16017     CALL 'kxdfhei1' USING DFHEIV0,
 16018           ELTRLR-DSID,
 16019           DFHEIV20,
 16020           DFHEIV99,
 16021           ELTRLR-KEY,
 16022           DFHEIV99,
 16023           DFHEIV99,
 16024           DFHEIV99
 16025     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16026         DFHEIV20
 16027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16028
 16029
 16030 7900-EXIT.
 16031      EXIT.
 16032
 16033 7910-READ-ACTV.
 16034     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16035     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16036     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16037     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16038     MOVE +0                     TO TRLR-SEQ-NO.
 16039     MOVE '1'                    TO TRLR-TYPE.
 16040     GO TO 7910-READ-TRAILER.
 16041
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 305
* EL130.cbl
 16042 7910-READ-NINETY.
 16043     MOVE MSTR-COMP-CD           TO TRLR-COMP-CD.
 16044     MOVE MSTR-CARRIER           TO TRLR-CARRIER.
 16045     MOVE MSTR-CLAIM-NO          TO TRLR-CLAIM-NO.
 16046     MOVE MSTR-CERT-NO           TO TRLR-CERT-NO.
 16047     MOVE +90                    TO TRLR-SEQ-NO.
 16048     MOVE '6'                    TO TRLR-TYPE.
 16049
 16050 7910-READ-TRAILER.
 16051     MOVE 'TRLR'                 TO FILE-SWITCH.
 16052
 16053
 16054
 16055* EXEC CICS READ
 16056*        DATASET   (ELTRLR-DSID)
 16057*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 16058*        RIDFLD    (ELTRLR-KEY)
 16059*    END-EXEC.
 16060*    MOVE '&"S        E          (   #00014281' TO DFHEIV0
 16061     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16062     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16063     MOVE X'2020233030303134323831' TO DFHEIV0(25:11)
 16064     CALL 'kxdfhei1' USING DFHEIV0,
 16065           ELTRLR-DSID,
 16066           DFHEIV20,
 16067           DFHEIV99,
 16068           ELTRLR-KEY,
 16069           DFHEIV99,
 16070           DFHEIV99,
 16071           DFHEIV99
 16072     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16073         DFHEIV20
 16074     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16075
 16076
 16077 7910-EXIT.
 16078      EXIT.
 16079
 16080 7915-REWRITE-TRAILER.
 16081
 16082
 16083* EXEC CICS REWRITE
 16084*        DATASET   (ELTRLR-DSID)
 16085*        FROM      (ACTIVITY-TRAILERS)
 16086*    END-EXEC.
 16087     MOVE LENGTH OF
 16088      ACTIVITY-TRAILERS
 16089       TO DFHEIV11
 16090*    MOVE '&& L                  %   #00014292' TO DFHEIV0
 16091     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16092     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16093     MOVE X'2020233030303134323932' TO DFHEIV0(25:11)
 16094     CALL 'kxdfhei1' USING DFHEIV0,
 16095           ELTRLR-DSID,
 16096           ACTIVITY-TRAILERS,
 16097           DFHEIV11,
 16098           DFHEIV99
 16099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 306
* EL130.cbl
 16100
 16101
 16102 7915-EXIT.
 16103      EXIT.
 16104
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 307
* EL130.cbl
 16106********************************************
 16107*  I/O REQUESTS AGAINST CLAIM MASTER FILE  *
 16108********************************************
 16109
 16110 7920-READ-CLAIM-UPDATE.
 16111
 16112
 16113
 16114* EXEC CICS READ
 16115*        UPDATE
 16116*        DATASET   (ELMSTR-DSID)
 16117*        SET       (ADDRESS OF CLAIM-MASTER)
 16118*        RIDFLD    (ELMSTR-KEY)
 16119*    END-EXEC.
 16120*    MOVE '&"S        EU         (   #00014308' TO DFHEIV0
 16121     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16122     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16123     MOVE X'2020233030303134333038' TO DFHEIV0(25:11)
 16124     CALL 'kxdfhei1' USING DFHEIV0,
 16125           ELMSTR-DSID,
 16126           DFHEIV20,
 16127           DFHEIV99,
 16128           ELMSTR-KEY,
 16129           DFHEIV99,
 16130           DFHEIV99,
 16131           DFHEIV99
 16132     SET ADDRESS OF CLAIM-MASTER TO
 16133         DFHEIV20
 16134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16135
 16136
 16137 7920-EXIT.
 16138      EXIT.
 16139
 16140 7950-READ-CLAIM.
 16141
 16142
 16143* EXEC CICS READ
 16144*        DATASET   (ELMSTR-DSID)
 16145*        SET       (ADDRESS OF CLAIM-MASTER)
 16146*        RIDFLD    (ELMSTR-KEY)
 16147*    END-EXEC.
 16148*    MOVE '&"S        E          (   #00014320' TO DFHEIV0
 16149     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16150     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16151     MOVE X'2020233030303134333230' TO DFHEIV0(25:11)
 16152     CALL 'kxdfhei1' USING DFHEIV0,
 16153           ELMSTR-DSID,
 16154           DFHEIV20,
 16155           DFHEIV99,
 16156           ELMSTR-KEY,
 16157           DFHEIV99,
 16158           DFHEIV99,
 16159           DFHEIV99
 16160     SET ADDRESS OF CLAIM-MASTER TO
 16161         DFHEIV20
 16162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16163
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 308
* EL130.cbl
 16164
 16165 7950-EXIT.
 16166      EXIT.
 16167
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 309
* EL130.cbl
 16169***************************************
 16170*  I/O REQUESTS AGAINST CONTROL FILE  *
 16171***************************************
 16172
 16173 7960-READ-CNTL-UPDATE.
 16174
 16175
 16176* EXEC CICS READ
 16177*        UPDATE
 16178*        DATASET  (ELCNTL-DSID)
 16179*        SET      (ADDRESS OF CONTROL-FILE)
 16180*        RIDFLD   (ELCNTL-KEY)
 16181*    END-EXEC.
 16182*    MOVE '&"S        EU         (   #00014336' TO DFHEIV0
 16183     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16184     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16185     MOVE X'2020233030303134333336' TO DFHEIV0(25:11)
 16186     CALL 'kxdfhei1' USING DFHEIV0,
 16187           ELCNTL-DSID,
 16188           DFHEIV20,
 16189           DFHEIV99,
 16190           ELCNTL-KEY,
 16191           DFHEIV99,
 16192           DFHEIV99,
 16193           DFHEIV99
 16194     SET ADDRESS OF CONTROL-FILE TO
 16195         DFHEIV20
 16196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16197
 16198
 16199 7960-EXIT.
 16200      EXIT.
 16201
 16202 7970-READ-CNTL.
 16203
 16204
 16205* EXEC CICS READ
 16206*        DATASET  (ELCNTL-DSID)
 16207*        SET      (ADDRESS OF CONTROL-FILE)
 16208*        RIDFLD   (ELCNTL-KEY)
 16209*    END-EXEC.
 16210*    MOVE '&"S        E          (   #00014348' TO DFHEIV0
 16211     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16212     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16213     MOVE X'2020233030303134333438' TO DFHEIV0(25:11)
 16214     CALL 'kxdfhei1' USING DFHEIV0,
 16215           ELCNTL-DSID,
 16216           DFHEIV20,
 16217           DFHEIV99,
 16218           ELCNTL-KEY,
 16219           DFHEIV99,
 16220           DFHEIV99,
 16221           DFHEIV99
 16222     SET ADDRESS OF CONTROL-FILE TO
 16223         DFHEIV20
 16224     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16225
 16226
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 310
* EL130.cbl
 16227 7970-EXIT.
 16228      EXIT.
 16229
 16230 7975-READ-CNTL-GTEQ.
 16231
 16232
 16233* EXEC CICS READ
 16234*         DATASET   (ELCNTL-DSID)
 16235*         SET       (ADDRESS OF CONTROL-FILE)
 16236*         RIDFLD    (ELCNTL-KEY)
 16237*         GTEQ
 16238*     END-EXEC.
 16239*    MOVE '&"S        G          (   #00014359' TO DFHEIV0
 16240     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 16241     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16242     MOVE X'2020233030303134333539' TO DFHEIV0(25:11)
 16243     CALL 'kxdfhei1' USING DFHEIV0,
 16244           ELCNTL-DSID,
 16245           DFHEIV20,
 16246           DFHEIV99,
 16247           ELCNTL-KEY,
 16248           DFHEIV99,
 16249           DFHEIV99,
 16250           DFHEIV99
 16251     SET ADDRESS OF CONTROL-FILE TO
 16252         DFHEIV20
 16253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16254
 16255
 16256 7975-EXIT.
 16257      EXIT.
 16258
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 311
* EL130.cbl
 16260**************************************************
 16261*  I/O REQUESTS AGAINST CERTIFICATE MASTER FILE  *
 16262**************************************************
 16263
 16264 7980-READ-CERT5.
 16265
 16266
 16267* EXEC CICS READ
 16268*         DATASET  (ELCERT5-DSID)
 16269*         SET      (ADDRESS OF CERTIFICATE-MASTER)
 16270*         RIDFLD   (ELCERT-KEY-5)
 16271*     END-EXEC.
 16272*    MOVE '&"S        E          (   #00014376' TO DFHEIV0
 16273     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16274     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16275     MOVE X'2020233030303134333736' TO DFHEIV0(25:11)
 16276     CALL 'kxdfhei1' USING DFHEIV0,
 16277           ELCERT5-DSID,
 16278           DFHEIV20,
 16279           DFHEIV99,
 16280           ELCERT-KEY-5,
 16281           DFHEIV99,
 16282           DFHEIV99,
 16283           DFHEIV99
 16284     SET ADDRESS OF CERTIFICATE-MASTER TO
 16285         DFHEIV20
 16286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16287
 16288
 16289 7980-EXIT.
 16290      EXIT.
 16291
 16292 7930-READ-CERT-UPDATE.
 16293
 16294
 16295* EXEC CICS READ
 16296*        DATASET  (ELCERT-DSID)
 16297*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16298*        RIDFLD   (ELCERT-KEY)
 16299*        UPDATE
 16300*    END-EXEC.
 16301*    MOVE '&"S        EU         (   #00014387' TO DFHEIV0
 16302     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16303     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16304     MOVE X'2020233030303134333837' TO DFHEIV0(25:11)
 16305     CALL 'kxdfhei1' USING DFHEIV0,
 16306           ELCERT-DSID,
 16307           DFHEIV20,
 16308           DFHEIV99,
 16309           ELCERT-KEY,
 16310           DFHEIV99,
 16311           DFHEIV99,
 16312           DFHEIV99
 16313     SET ADDRESS OF CERTIFICATE-MASTER TO
 16314         DFHEIV20
 16315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16316
 16317
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 312
* EL130.cbl
 16318 7930-EXIT.
 16319      EXIT.
 16320
 16321 7940-READ-CERT.
 16322
 16323
 16324* EXEC CICS READ
 16325*        DATASET  (ELCERT-DSID)
 16326*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 16327*        RIDFLD   (ELCERT-KEY)
 16328*    END-EXEC.
 16329*    MOVE '&"S        E          (   #00014399' TO DFHEIV0
 16330     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16331     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16332     MOVE X'2020233030303134333939' TO DFHEIV0(25:11)
 16333     CALL 'kxdfhei1' USING DFHEIV0,
 16334           ELCERT-DSID,
 16335           DFHEIV20,
 16336           DFHEIV99,
 16337           ELCERT-KEY,
 16338           DFHEIV99,
 16339           DFHEIV99,
 16340           DFHEIV99
 16341     SET ADDRESS OF CERTIFICATE-MASTER TO
 16342         DFHEIV20
 16343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16344
 16345
 16346 7940-EXIT.
 16347      EXIT.
 16348
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 313
* EL130.cbl
 16350**************************************************
 16351*  I/O REQUESTS AGAINST BENEFICIARY MASTER FILE  *
 16352**************************************************
 16353
 16354 7991-READ-BENE.
 16355
 16356
 16357* EXEC CICS READ
 16358*         DATASET   (ELBENE-DSID)
 16359*         SET       (ADDRESS OF BENEFICIARY-MASTER)
 16360*         RIDFLD    (ELBENE-KEY)
 16361*     END-EXEC.
 16362*    MOVE '&"S        E          (   #00014415' TO DFHEIV0
 16363     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16364     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16365     MOVE X'2020233030303134343135' TO DFHEIV0(25:11)
 16366     CALL 'kxdfhei1' USING DFHEIV0,
 16367           ELBENE-DSID,
 16368           DFHEIV20,
 16369           DFHEIV99,
 16370           ELBENE-KEY,
 16371           DFHEIV99,
 16372           DFHEIV99,
 16373           DFHEIV99
 16374     SET ADDRESS OF BENEFICIARY-MASTER TO
 16375         DFHEIV20
 16376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16377
 16378
 16379 7991-EXIT.
 16380      EXIT.
 16381
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 314
* EL130.cbl
 16383**************************************************
 16384*  I/O REQUESTS AGAINST REINSURANCE MASTER FILE  *
 16385**************************************************
 16386
 16387 7992-READ-REIN.
 16388
 16389
 16390
 16391* EXEC CICS HANDLE CONDITION
 16392*        NOTFND   (7992-NOT-FOUND)
 16393*    END-EXEC.
 16394*    MOVE '"$I                   ! M #00014432' TO DFHEIV0
 16395     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16396     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16397     MOVE X'4D20233030303134343332' TO DFHEIV0(25:11)
 16398     CALL 'kxdfhei1' USING DFHEIV0
 16399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16400
 16401
 16402
 16403
 16404* EXEC CICS READ
 16405*        DATASET   (ERREIN-DSID)
 16406*        SET       (ADDRESS OF REINSURANCE-RECORD)
 16407*        RIDFLD    (ERREIN-KEY)
 16408*    END-EXEC.
 16409*    MOVE '&"S        E          (   #00014437' TO DFHEIV0
 16410     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16411     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16412     MOVE X'2020233030303134343337' TO DFHEIV0(25:11)
 16413     CALL 'kxdfhei1' USING DFHEIV0,
 16414           ERREIN-DSID,
 16415           DFHEIV20,
 16416           DFHEIV99,
 16417           ERREIN-KEY,
 16418           DFHEIV99,
 16419           DFHEIV99,
 16420           DFHEIV99
 16421     SET ADDRESS OF REINSURANCE-RECORD TO
 16422         DFHEIV20
 16423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16424
 16425
 16426     MOVE 'Y'                       TO  WS-REIN-REC-FOUND-SW.
 16427
 16428     GO TO 7992-EXIT.
 16429
 16430 7992-NOT-FOUND.
 16431     MOVE 'N'                       TO  WS-REIN-REC-FOUND-SW.
 16432
 16433 7992-EXIT.
 16434     EXIT.
 16435
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 315
* EL130.cbl
 16437 8000-LOAD-ERROR-MESSAGES.
 16438     MOVE SPACES                 TO ERRMSG1O  ERRMSG2O.
 16439
 16440     IF EMI-NO-ERRORS
 16441         GO TO 8000-EXIT
 16442     END-IF.
 16443
 16444     perform varying e1 from +1 by +1 until e1 > +3
 16445        if emi-error-number (e1) = '1651' or '1652' or '1653'
 16446                                or '1655' or '1660'
 16447           move 'W'              to emi-severity (e1)
 16448        end-if
 16449     end-perform
 16450     IF EMI-NUMBER-OF-LINES = 1
 16451         MOVE EMI-LINE1          TO ERRMSG1O
 16452         GO TO 8000-EXIT
 16453     END-IF.
 16454
 16455     IF EMI-NUMBER-OF-LINES = 2
 16456          MOVE EMI-LINE1         TO ERRMSG1O
 16457          MOVE EMI-LINE2         TO ERRMSG2O
 16458          GO TO 8000-EXIT
 16459     END-IF.
 16460
 16461     MOVE EMI-LINE1              TO ERRMSG1O.
 16462
 16463 8000-EXIT.
 16464     EXIT.
 16465
 16466 8100-SEND-INITIAL-MAP.
 16467     MOVE SAVE-DATE              TO RUNDTEO.
 16468     MOVE EIBTIME                TO TIME-IN.
 16469     MOVE TIME-OUT               TO RUNTIMEO.
 16470     IF EIBAID = DFHPF11
 16471        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16472        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16473     end-if
 16474     IF RETURNED-FROM = XCTL-114
 16475        CONTINUE
 16476     ELSE
 16477        MOVE -1                  TO MAINTL
 16478     END-IF.
 16479
 16480*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16481         MOVE SPACES             TO PRODO.
 16482         MOVE AL-SANOF           TO PRODCDA.
 16483*    END-IF.
 16484
 16485     MOVE PI-COMPANY-ID          TO COMPO.
 16486     MOVE AL-PABOF               TO COMPA.
 16487     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16488     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16489     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16490
 16491     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16492
 16493     IF NOT PI-NO-CARRIER-SECURITY
 16494        MOVE PI-CARRIER-SECURITY TO CLMCARRO
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 316
* EL130.cbl
 16495        MOVE AL-SABOF            TO CLMCARRA
 16496     END-IF.
 16497
 16498     IF PI-PROCESSOR-ID = 'PEMA'
 16499        MOVE AL-UANON            TO CERTNOA
 16500                                    SUFXA
 16501     END-IF.
 16502*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16503*        NEXT SENTENCE
 16504*        CONTINUE
 16505*    ELSE
 16506         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16507*    END-IF.
 16508
 16509
 16510
 16511* EXEC CICS SEND
 16512*        MAP     (MAP-NAME)
 16513*        MAPSET  (MAPSET-NAME)
 16514*        FROM    (EL130AO)
 16515*        ERASE
 16516*        CURSOR
 16517*    END-EXEC.
 16518     MOVE LENGTH OF
 16519      EL130AO
 16520       TO DFHEIV12
 16521     MOVE -1
 16522       TO DFHEIV11
 16523*    MOVE '8$     CT  E    H L F ,   #00014527' TO DFHEIV0
 16524     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16525     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16526     MOVE X'2020233030303134353237' TO DFHEIV0(25:11)
 16527     CALL 'kxdfhei1' USING DFHEIV0,
 16528           MAP-NAME,
 16529           EL130AO,
 16530           DFHEIV12,
 16531           MAPSET-NAME,
 16532           DFHEIV99,
 16533           DFHEIV99,
 16534           DFHEIV99,
 16535           DFHEIV11,
 16536           DFHEIV99,
 16537           DFHEIV99,
 16538           DFHEIV99
 16539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16540
 16541
 16542     GO TO 9100-RETURN-TRAN.
 16543
 16544 8150-SEND-MAP-CURSOR.
 16545     MOVE SAVE-DATE              TO RUNDTEO.
 16546     MOVE EIBTIME                TO TIME-IN.
 16547     MOVE TIME-OUT               TO RUNTIMEO.
 16548     IF EIBAID = DFHPF11
 16549        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16550        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16551     end-if
 16552     MOVE PI-COMPANY-ID          TO COMPO.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 317
* EL130.cbl
 16553     MOVE AL-PABOF               TO COMPA
 16554     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16555     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16556     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16557
 16558*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16559         MOVE SPACES             TO PRODO.
 16560         MOVE AL-SANOF           TO PRODCDA.
 16561*    END-IF.
 16562
 16563     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16564
 16565     IF NOT PI-NO-CARRIER-SECURITY
 16566         MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16567         MOVE AL-SABOF            TO CLMCARRA
 16568     END-IF.
 16569
 16570     IF PI-PROCESSOR-ID = 'PEMA'
 16571        MOVE AL-UANON            TO CERTNOA
 16572                                    SUFXA
 16573     END-IF.
 16574*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16575*        NEXT SENTENCE
 16576*        CONTINUE
 16577*    ELSE
 16578         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16579*    END-IF.
 16580
 16581
 16582
 16583* EXEC CICS SEND
 16584*        MAP      (MAP-NAME)
 16585*        MAPSET   (MAPSET-NAME)
 16586*        FROM     (EL130AO)
 16587*        CURSOR   (PI-CURSOR)
 16588*        ERASE
 16589*    END-EXEC.
 16590     MOVE LENGTH OF
 16591      EL130AO
 16592       TO DFHEIV11
 16593*    MOVE '8$     CT  E    H L F ,   #00014575' TO DFHEIV0
 16594     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 16595     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16596     MOVE X'2020233030303134353735' TO DFHEIV0(25:11)
 16597     CALL 'kxdfhei1' USING DFHEIV0,
 16598           MAP-NAME,
 16599           EL130AO,
 16600           DFHEIV11,
 16601           MAPSET-NAME,
 16602           DFHEIV99,
 16603           DFHEIV99,
 16604           DFHEIV99,
 16605           PI-CURSOR,
 16606           DFHEIV99,
 16607           DFHEIV99,
 16608           DFHEIV99
 16609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16610
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 318
* EL130.cbl
 16611
 16612     GO TO 9100-RETURN-TRAN.
 16613
 16614 8200-SEND-DATAONLY.
 16615     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 16616
 16617     IF EIBAID = DFHPF11
 16618        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16619        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16620        go to 8100-send-initial-map
 16621     end-if
 16622*    IF EIBAID = DFHPF11
 16623*       MOVE 'Y'                 TO EMI-ROLL-SWITCH
 16624*       move pi-last-claim       to emi-claim-no
 16625*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16626*       go to 8100-send-initial-map
 16627*    END-IF.
 16628     .
 16629 8200-BYPASS-ERROR.
 16630     MOVE SAVE-DATE              TO RUNDTEO.
 16631     MOVE EIBTIME                TO TIME-IN.
 16632     MOVE TIME-OUT               TO RUNTIMEO.
 16633     MOVE PI-COMPANY-ID          TO COMPO.
 16634     MOVE AL-PABOF               TO COMPA
 16635     MOVE PI-MEMBER-CAPTION      TO MEMCAPO.
 16636
 16637*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL' AND 'LGX'
 16638         MOVE SPACES             TO PRODO.
 16639         MOVE AL-SANOF           TO PRODCDA.
 16640*    END-IF.
 16641
 16642     MOVE PI-LIFE-OVERRIDE-L6    TO LCVDSCRO.
 16643     MOVE PI-AH-OVERRIDE-L6      TO ACVDSCRO.
 16644
 16645     IF PI-PROCESSOR-ID = 'PEMA'
 16646        MOVE AL-UANON            TO CERTNOA
 16647                                    SUFXA
 16648     END-IF.
 16649     IF NOT PI-NO-CARRIER-SECURITY
 16650        MOVE PI-CARRIER-SECURITY TO CLMCARRO
 16651        MOVE AL-SABOF            TO CLMCARRA
 16652     END-IF.
 16653
 16654*    IF PI-COMPANY-ID  = 'CRI' OR 'LGX' OR 'NCL' OR 'HAN'
 16655*        NEXT SENTENCE
 16656*        CONTINUE
 16657*    ELSE
 16658         MOVE AL-SANOF           TO LCVRATEA  ACVRATEA
 16659*    END-IF.
 16660
 16661*    IF PI-COMPANY-ID NOT = 'ACC' AND 'FDL'
 16662         MOVE AL-SANOF           TO PRODCDA.
 16663*    END-IF.
 16664
 16665
 16666
 16667* EXEC CICS SEND
 16668*        MAP      (MAP-NAME)
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 319
* EL130.cbl
 16669*        MAPSET   (MAPSET-NAME)
 16670*        FROM     (EL130AO)
 16671*        DATAONLY
 16672*        CURSOR
 16673*    END-EXEC.
 16674     MOVE LENGTH OF
 16675      EL130AO
 16676       TO DFHEIV12
 16677     MOVE -1
 16678       TO DFHEIV11
 16679*    MOVE '8$D    CT       H L F ,   #00014637' TO DFHEIV0
 16680     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 16681     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 16682     MOVE X'2020233030303134363337' TO DFHEIV0(25:11)
 16683     CALL 'kxdfhei1' USING DFHEIV0,
 16684           MAP-NAME,
 16685           EL130AO,
 16686           DFHEIV12,
 16687           MAPSET-NAME,
 16688           DFHEIV99,
 16689           DFHEIV99,
 16690           DFHEIV99,
 16691           DFHEIV11,
 16692           DFHEIV99,
 16693           DFHEIV99,
 16694           DFHEIV99
 16695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16696
 16697
 16698     GO TO 9100-RETURN-TRAN.
 16699
 16700 8300-SEND-TEXT.
 16701
 16702
 16703* EXEC CICS SEND TEXT
 16704*        FROM     (LOGOFF-TEXT)
 16705*        LENGTH   (LOGOFF-LENGTH)
 16706*        ERASE
 16707*        FREEKB
 16708*    END-EXEC.
 16709*    MOVE '8&      T  E F  H   F -   #00014649' TO DFHEIV0
 16710     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 16711     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 16712     MOVE X'2020233030303134363439' TO DFHEIV0(25:11)
 16713     CALL 'kxdfhei1' USING DFHEIV0,
 16714           LOGOFF-TEXT,
 16715           LOGOFF-LENGTH,
 16716           DFHEIV99,
 16717           DFHEIV99,
 16718           DFHEIV99,
 16719           DFHEIV99,
 16720           DFHEIV99,
 16721           DFHEIV99,
 16722           DFHEIV99,
 16723           DFHEIV99,
 16724           DFHEIV99,
 16725           DFHEIV99
 16726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 320
* EL130.cbl
 16727
 16728
 16729
 16730
 16731* EXEC CICS RETURN
 16732*    END-EXEC.
 16733*    MOVE '.(                    ''   #00014657' TO DFHEIV0
 16734     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16735     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16736     MOVE X'2020233030303134363537' TO DFHEIV0(25:11)
 16737     CALL 'kxdfhei1' USING DFHEIV0,
 16738           DFHEIV99,
 16739           DFHEIV99,
 16740           DFHEIV99,
 16741           DFHEIV99,
 16742           DFHEIV99,
 16743           DFHEIV99
 16744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16745
 16746
 16747 8800-UNAUTHORIZED-ACCESS.
 16748     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 16749     GO TO 8300-SEND-TEXT.
 16750
 16751 8810-PF23.
 16752     MOVE EIBAID TO PI-ENTRY-CD-1.
 16753     MOVE XCTL-005               TO PGM-NAME.
 16754     GO TO 9300-XCTL.
 16755
 16756 8820-TERM-ERROR.
 16757     MOVE ER-0412                TO EMI-ERROR.
 16758     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16759     MOVE -1                     TO MAINTL.
 16760     GO TO 8200-SEND-DATAONLY.
 16761
 16762 8830-TRAN-ERROR.
 16763     MOVE ER-0413                TO EMI-ERROR.
 16764     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16765     MOVE -1                     TO MAINTL.
 16766     GO TO 8200-SEND-DATAONLY.
 16767
 16768 9000-RETURN-CICS.
 16769
 16770
 16771* EXEC CICS RETURN
 16772*    END-EXEC.
 16773*    MOVE '.(                    ''   #00014683' TO DFHEIV0
 16774     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 16775     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16776     MOVE X'2020233030303134363833' TO DFHEIV0(25:11)
 16777     CALL 'kxdfhei1' USING DFHEIV0,
 16778           DFHEIV99,
 16779           DFHEIV99,
 16780           DFHEIV99,
 16781           DFHEIV99,
 16782           DFHEIV99,
 16783           DFHEIV99
 16784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 321
* EL130.cbl
 16785
 16786
 16787 9100-RETURN-TRAN.
 16788     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 16789     MOVE '130A'                 TO PI-CURRENT-SCREEN-NO.
 16790
 16791
 16792
 16793* EXEC CICS RETURN
 16794*        TRANSID   (TRANS-ID)
 16795*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16796*        LENGTH    (PI-COMM-LENGTH)
 16797*    END-EXEC.
 16798*    MOVE '.(CT                  ''   #00014691' TO DFHEIV0
 16799     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 16800     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16801     MOVE X'2020233030303134363931' TO DFHEIV0(25:11)
 16802     CALL 'kxdfhei1' USING DFHEIV0,
 16803           TRANS-ID,
 16804           PROGRAM-INTERFACE-BLOCK,
 16805           PI-COMM-LENGTH,
 16806           DFHEIV99,
 16807           DFHEIV99,
 16808           DFHEIV99
 16809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16810
 16811
 16812 9200-RETURN-MAIN-MENU.
 16813     MOVE XCTL-126               TO PGM-NAME.
 16814     GO TO 9300-XCTL.
 16815
 16816 9300-XCTL.
 16817
 16818
 16819* EXEC CICS XCTL
 16820*        PROGRAM   (PGM-NAME)
 16821*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 16822*        LENGTH    (PI-COMM-LENGTH)
 16823*    END-EXEC.
 16824*    MOVE '.$C                   %   #00014703' TO DFHEIV0
 16825     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 16826     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16827     MOVE X'2020233030303134373033' TO DFHEIV0(25:11)
 16828     CALL 'kxdfhei1' USING DFHEIV0,
 16829           PGM-NAME,
 16830           PROGRAM-INTERFACE-BLOCK,
 16831           PI-COMM-LENGTH,
 16832           DFHEIV99
 16833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16834
 16835
 16836 9400-CLEAR.
 16837     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 16838     GO TO 9300-XCTL.
 16839
 16840 9500-PF12.
 16841     MOVE XCTL-010               TO PGM-NAME.
 16842     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 322
* EL130.cbl
 16843
 16844 9600-PGMID-ERROR.
 16845
 16846
 16847* EXEC CICS HANDLE CONDITION
 16848*        PGMIDERR  (8300-SEND-TEXT)
 16849*    END-EXEC.
 16850*    MOVE '"$L                   ! N #00014719' TO DFHEIV0
 16851     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 16852     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16853     MOVE X'4E20233030303134373139' TO DFHEIV0(25:11)
 16854     CALL 'kxdfhei1' USING DFHEIV0
 16855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16856
 16857
 16858     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 16859     MOVE ' '                    TO PI-ENTRY-CD-1.
 16860     MOVE XCTL-005               TO PGM-NAME.
 16861     MOVE PGM-NAME               TO LOGOFF-PGM.
 16862     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 16863     GO TO 9300-XCTL.
 16864
 16865 9700-LINK-DATE-CONVERT.
 16866     MOVE LINK-ELDATCV           TO PGM-NAME.
 16867
 16868
 16869* EXEC CICS LINK
 16870*        PROGRAM    (PGM-NAME)
 16871*        COMMAREA   (DATE-CONVERSION-DATA)
 16872*        LENGTH     (DC-COMM-LENGTH)
 16873*    END-EXEC.
 16874*    MOVE '."C                   (   #00014733' TO DFHEIV0
 16875     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16876     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16877     MOVE X'2020233030303134373333' TO DFHEIV0(25:11)
 16878     CALL 'kxdfhei1' USING DFHEIV0,
 16879           PGM-NAME,
 16880           DATE-CONVERSION-DATA,
 16881           DC-COMM-LENGTH,
 16882           DFHEIV99,
 16883           DFHEIV99,
 16884           DFHEIV99,
 16885           DFHEIV99
 16886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16887
 16888
 16889 9700-EXIT.
 16890     EXIT.
 16891
 16892 9800-LINK-REM-TERM.
 16893     MOVE LINK-ELRTRM            TO PGM-NAME.
 16894
 16895
 16896* EXEC CICS LINK
 16897*        PROGRAM    (PGM-NAME)
 16898*        COMMAREA   (CALCULATION-PASS-AREA)
 16899*        LENGTH     (CP-COMM-LENGTH)
 16900*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 323
* EL130.cbl
 16901*    MOVE '."C                   (   #00014745' TO DFHEIV0
 16902     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16903     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16904     MOVE X'2020233030303134373435' TO DFHEIV0(25:11)
 16905     CALL 'kxdfhei1' USING DFHEIV0,
 16906           PGM-NAME,
 16907           CALCULATION-PASS-AREA,
 16908           CP-COMM-LENGTH,
 16909           DFHEIV99,
 16910           DFHEIV99,
 16911           DFHEIV99,
 16912           DFHEIV99
 16913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16914
 16915
 16916 9800-EXIT.
 16917     EXIT.
 16918
 16919 9900-ERROR-FORMAT.
 16920*    if emi-error = 1651 or 1652 or 1653 or 1655
 16921*       display ' 9900 error ' emi-error
 16922*       display emi-message-area (1)
 16923*       display emi-message-area (2)
 16924*       display emi-message-area (3)
 16925*    end-if
 16926     IF NOT EMI-ERRORS-COMPLETE
 16927         MOVE LINK-001           TO PGM-NAME
 16928
 16929* EXEC CICS LINK
 16930*            PROGRAM   (PGM-NAME)
 16931*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 16932*            LENGTH    (EMI-COMM-LENGTH)
 16933*        END-EXEC
 16934*    MOVE '."C                   (   #00014763' TO DFHEIV0
 16935     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16936     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16937     MOVE X'2020233030303134373633' TO DFHEIV0(25:11)
 16938     CALL 'kxdfhei1' USING DFHEIV0,
 16939           PGM-NAME,
 16940           ERROR-MESSAGE-INTERFACE-BLOCK,
 16941           EMI-COMM-LENGTH,
 16942           DFHEIV99,
 16943           DFHEIV99,
 16944           DFHEIV99,
 16945           DFHEIV99
 16946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16947         if emi-error = 1651 or 1652 or 1653 or 1655 or 1660
 16948            subtract 1 from emi-fatal-ctr
 16949         end-if
 16950     END-IF.
 16951
 16952     .
 16953 9900-EXIT.
 16954     EXIT.
 16955
 16956 9990-ABEND.
 16957     MOVE -1                     TO MAINTL.
 16958     MOVE LINK-004               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 324
* EL130.cbl
 16959     MOVE DFHEIBLK               TO EMI-LINE1.
 16960
 16961
 16962* EXEC CICS LINK
 16963*        PROGRAM   (PGM-NAME)
 16964*        COMMAREA  (EMI-LINE1)
 16965*        LENGTH    (72)
 16966*    END-EXEC.
 16967     MOVE 72
 16968       TO DFHEIV11
 16969*    MOVE '."C                   (   #00014782' TO DFHEIV0
 16970     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16971     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16972     MOVE X'2020233030303134373832' TO DFHEIV0(25:11)
 16973     CALL 'kxdfhei1' USING DFHEIV0,
 16974           PGM-NAME,
 16975           EMI-LINE1,
 16976           DFHEIV11,
 16977           DFHEIV99,
 16978           DFHEIV99,
 16979           DFHEIV99,
 16980           DFHEIV99
 16981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16982
 16983
 16984     MOVE EMI-LINE1              TO ERRMSG2O.
 16985
 16986     GO TO 8200-BYPASS-ERROR.
 16987
 16988
 16989
 16990* GOBACK.
 16991     MOVE '9%                    "   ' TO DFHEIV0
 16992     MOVE 'EL130' TO DFHEIV1
 16993     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 16994     GOBACK.
 16995
 16996 9995-SECURITY-VIOLATION.
 16997*             COPY ELCSCTP.
 16998******************************************************************
 16999*                                                                *
 17000*                            ELCSCTP                             *
 17001*                            VMOD=2.001                          *
 17002*                                                                *
 17003*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 17004******************************************************************
 17005
 17006
 17007     MOVE EIBDATE          TO SM-JUL-DATE.
 17008     MOVE EIBTRMID         TO SM-TERMID.
 17009     MOVE THIS-PGM         TO SM-PGM.
 17010     MOVE EIBTIME          TO TIME-IN.
 17011     MOVE TIME-OUT         TO SM-TIME.
 17012     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 17013
 17014
 17015* EXEC CICS LINK
 17016*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 325
* EL130.cbl
 17017*         COMMAREA (SECURITY-MESSAGE)
 17018*         LENGTH   (80)
 17019*    END-EXEC.
 17020     MOVE 'EL003' TO DFHEIV1
 17021     MOVE 80
 17022       TO DFHEIV11
 17023*    MOVE '."C                   (   #00014813' TO DFHEIV0
 17024     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17025     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17026     MOVE X'2020233030303134383133' TO DFHEIV0(25:11)
 17027     CALL 'kxdfhei1' USING DFHEIV0,
 17028           DFHEIV1,
 17029           SECURITY-MESSAGE,
 17030           DFHEIV11,
 17031           DFHEIV99,
 17032           DFHEIV99,
 17033           DFHEIV99,
 17034           DFHEIV99
 17035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17036
 17037
 17038******************************************************************
 17039
 17040
 17041 9995-EXIT.
 17042     EXIT.
 17043
 17044
 17045 9999-DFHBACK SECTION.
 17046     MOVE '9%                    "   ' TO DFHEIV0
 17047     MOVE 'EL130' TO DFHEIV1
 17048     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17049     GOBACK.
 17050 9999-DFHEXIT.
 17051     IF DFHEIGDJ EQUAL 0001
 17052         NEXT SENTENCE
 17053     ELSE IF DFHEIGDJ EQUAL 2
 17054         GO TO 0100-TEST-ENTRY,
 17055               8100-SEND-INITIAL-MAP,
 17056               9600-PGMID-ERROR,
 17057               8820-TERM-ERROR,
 17058               8830-TRAN-ERROR,
 17059               9990-ABEND
 17060         DEPENDING ON DFHEIGDI
 17061     ELSE IF DFHEIGDJ EQUAL 3
 17062         GO TO 0450-ADD-ELACTQ-RECORD
 17063         DEPENDING ON DFHEIGDI
 17064     ELSE IF DFHEIGDJ EQUAL 4
 17065         GO TO 8820-TERM-ERROR,
 17066               8830-TRAN-ERROR
 17067         DEPENDING ON DFHEIGDI
 17068     ELSE IF DFHEIGDJ EQUAL 5
 17069         GO TO 0660-NOT-FOUND,
 17070               0670-QIDERR
 17071         DEPENDING ON DFHEIGDI
 17072     ELSE IF DFHEIGDJ EQUAL 6
 17073         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17074         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 326
* EL130.cbl
 17075     ELSE IF DFHEIGDJ EQUAL 7
 17076         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17077         DEPENDING ON DFHEIGDI
 17078     ELSE IF DFHEIGDJ EQUAL 8
 17079         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17080         DEPENDING ON DFHEIGDI
 17081     ELSE IF DFHEIGDJ EQUAL 9
 17082         GO TO 1025-SHOW-RECORD-NOT-FOUND
 17083         DEPENDING ON DFHEIGDI
 17084     ELSE IF DFHEIGDJ EQUAL 10
 17085         GO TO 2050-DELETE-NOT-FOUND
 17086         DEPENDING ON DFHEIGDI
 17087     ELSE IF DFHEIGDJ EQUAL 11
 17088         GO TO 2010-DELETE-CL
 17089         DEPENDING ON DFHEIGDI
 17090     ELSE IF DFHEIGDJ EQUAL 12
 17091         GO TO 3010-TEST-FOR-ERRORS
 17092         DEPENDING ON DFHEIGDI
 17093     ELSE IF DFHEIGDJ EQUAL 13
 17094         GO TO 3008-DUP-ERROR,
 17095               3009-NOT-FOUND
 17096         DEPENDING ON DFHEIGDI
 17097     ELSE IF DFHEIGDJ EQUAL 14
 17098         GO TO 3030-BUILD-CONT
 17099         DEPENDING ON DFHEIGDI
 17100     ELSE IF DFHEIGDJ EQUAL 15
 17101         GO TO 3033-ACCT-NOT-FOUND,
 17102               3033-ACCT-NOT-FOUND
 17103         DEPENDING ON DFHEIGDI
 17104     ELSE IF DFHEIGDJ EQUAL 16
 17105         GO TO 3032-NOT-IN-DT-RANGE
 17106         DEPENDING ON DFHEIGDI
 17107     ELSE IF DFHEIGDJ EQUAL 17
 17108         GO TO 3070-BUILD-CONT
 17109         DEPENDING ON DFHEIGDI
 17110     ELSE IF DFHEIGDJ EQUAL 18
 17111         GO TO 3065-CERT-NOT-FOUND
 17112         DEPENDING ON DFHEIGDI
 17113     ELSE IF DFHEIGDJ EQUAL 19
 17114         GO TO 3100-CARRIER-NOT-FOUND
 17115         DEPENDING ON DFHEIGDI
 17116     ELSE IF DFHEIGDJ EQUAL 20
 17117         GO TO 3110-COMPANY-NOT-FOUND
 17118         DEPENDING ON DFHEIGDI
 17119     ELSE IF DFHEIGDJ EQUAL 21
 17120         GO TO 3200-BUILD-ZERO-TRAILER
 17121         DEPENDING ON DFHEIGDI
 17122     ELSE IF DFHEIGDJ EQUAL 22
 17123         GO TO 9999-DFHBACK
 17124         DEPENDING ON DFHEIGDI
 17125     ELSE IF DFHEIGDJ EQUAL 23
 17126         GO TO 3290-NO-INSURED-ADDRESS
 17127         DEPENDING ON DFHEIGDI
 17128     ELSE IF DFHEIGDJ EQUAL 24
 17129         GO TO 3410-DUP-KEY
 17130         DEPENDING ON DFHEIGDI
 17131     ELSE IF DFHEIGDJ EQUAL 25
 17132         GO TO 3690-CERT-WRITTEN
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 327
* EL130.cbl
 17133         DEPENDING ON DFHEIGDI
 17134     ELSE IF DFHEIGDJ EQUAL 26
 17135         GO TO 3850-CLAIM-MSTR-WRITTEN
 17136         DEPENDING ON DFHEIGDI
 17137     ELSE IF DFHEIGDJ EQUAL 27
 17138         GO TO 3992-DUPREC
 17139         DEPENDING ON DFHEIGDI
 17140     ELSE IF DFHEIGDJ EQUAL 28
 17141         GO TO 5050-CERT-NOT-FOUND
 17142         DEPENDING ON DFHEIGDI
 17143     ELSE IF DFHEIGDJ EQUAL 29
 17144         GO TO 5030-CERT-WRITTEN
 17145         DEPENDING ON DFHEIGDI
 17146     ELSE IF DFHEIGDJ EQUAL 30
 17147         GO TO 5035-CLAIM-WRITTEN
 17148         DEPENDING ON DFHEIGDI
 17149     ELSE IF DFHEIGDJ EQUAL 31
 17150         GO TO 9990-ABEND,
 17151               5799-EXIT
 17152         DEPENDING ON DFHEIGDI
 17153     ELSE IF DFHEIGDJ EQUAL 32
 17154         GO TO 3100-CARRIER-NOT-FOUND
 17155         DEPENDING ON DFHEIGDI
 17156     ELSE IF DFHEIGDJ EQUAL 33
 17157         GO TO 6040-NO-PROCESSOR-RECORD
 17158         DEPENDING ON DFHEIGDI
 17159     ELSE IF DFHEIGDJ EQUAL 34
 17160         GO TO 6060-NO-BENEFICIARY-RECORD
 17161         DEPENDING ON DFHEIGDI
 17162     ELSE IF DFHEIGDJ EQUAL 35
 17163         GO TO 6499-EXIT,
 17164               6499-EXIT
 17165         DEPENDING ON DFHEIGDI
 17166     ELSE IF DFHEIGDJ EQUAL 36
 17167         GO TO 6600-NOT-FOUND
 17168         DEPENDING ON DFHEIGDI
 17169     ELSE IF DFHEIGDJ EQUAL 37
 17170         GO TO 6700-NOTOPEN-ERROR,
 17171               6700-EXIT
 17172         DEPENDING ON DFHEIGDI
 17173     ELSE IF DFHEIGDJ EQUAL 38
 17174         GO TO 7120-NOT-FOUND
 17175         DEPENDING ON DFHEIGDI
 17176     ELSE IF DFHEIGDJ EQUAL 39
 17177         GO TO 7499-EXIT
 17178         DEPENDING ON DFHEIGDI
 17179     ELSE IF DFHEIGDJ EQUAL 40
 17180         GO TO 7500-EXIT,
 17181               7500-DUPLICATE-KEY,
 17182               7500-EXIT
 17183         DEPENDING ON DFHEIGDI
 17184     ELSE IF DFHEIGDJ EQUAL 41
 17185         GO TO 7500-END-BROWSE
 17186         DEPENDING ON DFHEIGDI
 17187     ELSE IF DFHEIGDJ EQUAL 42
 17188         GO TO 7630-END-BROWSE
 17189         DEPENDING ON DFHEIGDI
 17190     ELSE IF DFHEIGDJ EQUAL 43
* Micro Focus Server Express         V5.1 revision 000 19-Oct-17 10:34 Page 328
* EL130.cbl
 17191         GO TO 7799-EXIT,
 17192               7799-EXIT
 17193         DEPENDING ON DFHEIGDI
 17194     ELSE IF DFHEIGDJ EQUAL 44
 17195         GO TO 7790-END-BROWSE
 17196         DEPENDING ON DFHEIGDI
 17197     ELSE IF DFHEIGDJ EQUAL 45
 17198         GO TO 7992-NOT-FOUND
 17199         DEPENDING ON DFHEIGDI
 17200     ELSE IF DFHEIGDJ EQUAL 46
 17201         GO TO 8300-SEND-TEXT
 17202         DEPENDING ON DFHEIGDI.
 17203     MOVE '9%                    "   ' TO DFHEIV0
 17204     MOVE 'EL130' TO DFHEIV1
 17205     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17206     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12816     Code:       54710
