* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   1
* EL690.cbl
* Options: int("EL690.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL690.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL690.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL690.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL690 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 10:00:53.
     7*                            VMOD=2.005
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   2
* EL690.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*       TRANSACTION - EXM3 - CREDIT SYSTEM CORRESPONDENCE REVIEW
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL690AI FILLER
    38* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    39* 070711    2011022800001  AJRA  NAPERSOFT CHANGES
    40* 012312    2011022800001  AJRA  NAPERSOFT CHANGES
    41* 101512    2011022800001  AJRA  FIX LIST FOR SAME CERT DIFF EFF D
    42* 121112    2012101700002  AJRA  ADD PF6 TO CERT NOTES
    43******************************************************************
    44
    45 ENVIRONMENT DIVISION.
    46 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   3
* EL690.cbl
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50 77  FILLER   PIC  X(32) VALUE '*******************************'.
    51 77  FILLER   PIC  X(32) VALUE '*    EL690 WORKING STORAGE    *'.
    52 77  FILLER   PIC  X(32) VALUE '********* VMOD=2.005 **********'.
    53
    54 01  W-PROGRAM-CONSTANTS.
    55     12  FILLER                  PIC  X(18)
    56                                 VALUE 'PROGRAM CONSTANTS:'.
    57     12  W-APPL-SCRTY-NDX        PIC S9(04)  VALUE +3    COMP.
    58
    59     12  W-ARCH-FILE-ID          PIC  X(08)  VALUE 'ERARCH'.
    60     12  W-ARCH2-FILE-ID         PIC  X(08)  VALUE 'ERARCH2'.
    61     12  W-ARCH3-FILE-ID         PIC  X(08)  VALUE 'ERARCH3'.
    62     12  W-ARCH4-FILE-ID         PIC  X(08)  VALUE 'ERARCH4'.
    63     12  W-ARCH5-FILE-ID         PIC  X(08)  VALUE 'ERARCH5'.
    64     12  W-ARCH6-FILE-ID         PIC  X(08)  VALUE 'ERARCH6'.
    65     12  W-ARCT-FILE-ID          PIC  X(08)  VALUE 'ERARCT'.
    66     12  W-CNTL-FILE-ID          PIC  X(08)  VALUE 'ELCNTL'.
    67     12  W-LINK-001              PIC  X(08)  VALUE 'EL001'.
    68     12  W-LINK-004              PIC  X(08)  VALUE 'EL004'.
    69     12  W-MAP                   PIC  X(08)  VALUE 'EL690A'.
    70     12  W-MAP-REDEFINE  REDEFINES   W-MAP.
    71         16  FILLER              PIC  X(02).
    72         16  W-MAP-NUM           PIC  X(06).
    73     12  W-MAPSET                PIC  X(08)  VALUE 'EL690S'.
    74     12  W-THIS-PGM              PIC  X(08)  VALUE 'EL690'.
    75     12  W-TRANSACTION           PIC  X(04)  VALUE 'EXM3'.
    76     12  W-XCTL-005              PIC  X(08)  VALUE 'EL005'.
    77     12  W-XCTL-010              PIC  X(08)  VALUE 'EL010'.
    78     12  W-XCTL-153              PIC  X(08)  VALUE 'EL690'.
    79     12  W-XCTL-626              PIC  X(08)  VALUE 'EL626'.
    80     12  W-XCTL-689              PIC  X(08)  VALUE 'EL689'.
    81     12  W-XCTL-691              PIC  X(08)  VALUE 'EL691'.
    82     12  W-XCTL-1279             PIC  X(08)  VALUE 'EL1279'.
    83
    84 01  W-WORK-AREAS.
    85     12  FILLER                  PIC  X(11)
    86                                      VALUE 'WORK AREAS:'.
    87
    88     12  W-ARCH-NDX              PIC S9(04)  COMP.
    89     12  W-ARCH-NDX2             PIC S9(04)  COMP.
    90     12  W-ARCH-NDX3             PIC S9(04)  COMP.
    91     12  W-ARCH-NUMBER           PIC S9(08)  COMP.
    92     12  W-HOLD-ARCHIVE          PIC S9(08)  COMP.
    93     12  W-KEY-NDX               PIC S9(04)  COMP.
    94     12  W-LAST-ERROR            PIC  9(04)  VALUE 9999.
    95
    96     12  W-CALL-PGM              PIC  X(08)  VALUE SPACES.
    97
    98     12  W-DEEDIT-FIELD          PIC  X(15).
    99     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD
   100                                 PIC S9(15).
   101
   102     12  W-HOLD-LINE             PIC X(100).
   103     12  W-RETURNED-FROM         PIC  X(08)  VALUE SPACES.
   104     12  W-RESEND-DATE-1         PIC  X(02)  VALUE SPACES.
   105     12  W-RESEND-DATE-2         PIC  X(02)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   4
* EL690.cbl
   106     12  W-RESEND-DATE-3         PIC  X(02)  VALUE SPACES.
   107     12  W-REPLY-DATE            PIC  X(02)  VALUE SPACES.
   108     12  W-SAVE-BIN-DATE         PIC  X(02)  VALUE SPACES.
   109     12  W-SAVE-DATE             PIC  X(08)  VALUE SPACES.
   110     12  W-STATUS                PIC  X(01)  VALUE SPACES.
   111
   112     12  W-TIME-IN               PIC S9(07).
   113     12  FILLER REDEFINES W-TIME-IN.
   114         16  FILLER              PIC  X(01).
   115         16  W-TIME-OUT          PIC  9(02)V9(02).
   116         16  FILLER              PIC  X(02).
   117
   118 01  W-KEY-FIELDS.
   119     12  FILLER                  PIC  X(11)
   120                                      VALUE 'KEY FIELDS:'.
   121     12  W-CNTL-KEY.
   122         16  W-CNTL-COMPANY-ID   PIC  X(03).
   123         16  W-CNTL-RECORD-TYPE  PIC  X(01).
   124         16  FILLER              PIC  X(04).
   125         16  W-CNTL-SEQ          PIC S9(04) COMP.
   126     12  W-QUID-KEY.
   127         16  W-QUID-TERMINAL     PIC  X(04).
   128         16  W-QUID-MAP-NUM      PIC  X(04).
   129*
   130*    12  W-SC-QUID-KEY.
   131*        16  W-SC-QUID-TERMINAL  PIC  X(04).
   132*        16  W-SC-QUID-SYSTEM    PIC  X(04).
   133
   134     12  W-ARCH-KEY.
   135         16  W-ARCH-COMPANY-CD   PIC  X(01).
   136         16  W-ARCH-ARCHIVE-NO   PIC S9(08) COMP.
   137
   138     12  W-ARCH2-KEY.
   139         16  W-ARCH2-COMPANY-CD  PIC  X(01).
   140         16  W-ARCH2-CSCSAE-KEYLET.
   141             20  W-ARCH2-CERT-PRIME
   142                                 PIC  X(10).
   143             20  W-ARCH2-SUFFIX  PIC  X(01).
   144             20  W-ARCH2-CARRIER PIC  X(01).
   145             20  W-ARCH2-GROUPING
   146                                 PIC  X(06).
   147             20  W-ARCH2-STATE   PIC  X(02).
   148             20  W-ARCH2-ACCOUNT PIC  X(10).
   149             20  W-ARCH2-EFF-DTE PIC  X(02).
   150         16  W-ARCH2-ARCHIVE-NO  PIC S9(08) COMP.
   151
   152     12  W-ARCH3-KEY.
   153         16  W-ARCH3-COMPANY-CD  PIC  X(01).
   154         16  W-ARCH3-FCGSA-KEYLET.
   155             20  W-ARCH3-FORM    PIC  X(04).
   156             20  W-ARCH3-CARRIER PIC  X(01).
   157             20  W-ARCH3-GROUPING
   158                                 PIC  X(06).
   159             20  W-ARCH3-STATE   PIC  X(02).
   160             20  W-ARCH3-ACCOUNT PIC  X(10).
   161         16  W-ARCH3-ARCHIVE-NO  PIC S9(08) COMP.
   162
   163     12  W-ARCH4-KEY.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   5
* EL690.cbl
   164         16  W-ARCH4-COMPANY-CD  PIC  X(01).
   165         16  W-ARCH4-PCGSA-KEYLET.
   166             20  W-ARCH4-PROCESSOR
   167                                 PIC  X(04).
   168             20  W-ARCH4-CARRIER PIC  X(01).
   169             20  W-ARCH4-GROUPING
   170                                 PIC  X(06).
   171             20  W-ARCH4-STATE   PIC  X(02).
   172             20  W-ARCH4-ACCOUNT PIC  X(10).
   173         16  W-ARCH4-ARCHIVE-NO  PIC S9(08) COMP.
   174
   175     12  W-ARCH5-KEY.
   176         16  W-ARCH5-COMPANY-CD  PIC  X(01).
   177         16  W-ARCH5-CGSA-KEYLET.
   178             20  W-ARCH5-CARRIER PIC  X(01).
   179             20  W-ARCH5-GROUPING
   180                                 PIC  X(06).
   181             20  W-ARCH5-STATE   PIC  X(02).
   182             20  W-ARCH5-ACCOUNT PIC  X(10).
   183         16  W-ARCH5-ARCHIVE-NO  PIC S9(08) COMP.
   184
   185     12  W-ARCH6-KEY.
   186         16  W-ARCH6-COMPANY-CD  PIC  X(01).
   187         16  W-ARCH6-ENTRY.
   188             20  W-ARCH6-FILLER  PIC  X(02).
   189             20  W-ARCH6-QUE-CONTROL
   190                                 PIC S9(08) COMP.
   191         16  W-ARCH6-ARCHIVE-NO  PIC S9(08) COMP.
   192
   193     12  W-ARCT-KEY.
   194         16  W-ARCT-COMPANY-CD   PIC  X(01).
   195         16  W-ARCT-ARCHIVE-NO   PIC S9(08) COMP.
   196         16  W-ARCT-RECORD-TYPE  PIC  X(01).
   197             88  W-ARCT-ADDRESS-DATA   VALUE '1'.
   198             88  W-ARCT-TEXT-DATA      VALUE '2'.
   199         16  W-ARCT-LINE-SEQ-NO  PIC S9(04) COMP.
   200
   201     12  FILLER                      PIC  X(28).
   202     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
   203
   204     12  LT-TEXT-RECORD.
   205         16  LT-LETTER-TEXT OCCURS 20 TIMES
   206                            INDEXED BY LT-NDX.
   207             20  LT-TEXT-LINE        PIC  X(70).
   208             20  LT-SKIP-CONTROL     PIC  X(02).
   209                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
   210                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
   211             20  FILLER              PIC  X(08).
   212
   213
   214 01  W-PROGRAM-SWITCHES.
   215     12  FILLER                  PIC  X(09)
   216                                      VALUE 'SWITCHES:'.
   217     12  W-CHANGE-REQUESTED-IND  PIC  X(01)  VALUE SPACES.
   218         88  W-CHANGE-REQUESTED       VALUE 'Y'.
   219         88  W-NO-CHANGES-MADE        VALUE SPACES.
   220     12  W-FIRST-CHANGE-IND      PIC  9(02)  VALUE ZEROS.
   221         88  W-FIRST-CHANGE-FOUND     VALUES 01 THRU 12.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   6
* EL690.cbl
   222         88  W-NO-FIRST-CHANGE        VALUE ZEROS.
   223     12  W-READ-PREV-TWICE-IND   PIC  X(01)  VALUE SPACES.
   224         88  W-READ-PREV-TWICE        VALUE 'Y'.
   225     12  W-VALID-STATUS-SW       PIC  X(01).
   226         88  W-ALLOWED-ENTRIES        VALUE 'A' 'H' '+' '#' '@'
   227                                            'X' 'V'.
   228         88  W-VALID-STATUS           VALUE 'A' 'H'
   229                                            'P' 'X' 'V' 'C'.
   230         88  W-ACTIVE                 VALUE 'A'.
   231         88  W-COMPLETED              VALUE 'C'.
   232         88  W-VOIDED                 VALUE 'V'.
   233         88  W-TO-BE-PURGED-STATUS    VALUE 'X'.
   234         88  W-PURGED-STATUS          VALUE 'P'.
   235         88  W-SPECIAL-STATUS         VALUE '+'.
   236         88  W-CLEAR-INITIAL          VALUE '#'.
   237         88  W-CHECK-STATUS           VALUE '@'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   7
* EL690.cbl
   239 01  FILLER                      PIC  X(14)
   240                                      VALUE 'PGRM MAP AREA:'.
   241*    COPY EL690S.
   242 01  EL690AI.
   243     05  FILLER            PIC  X(0012).
   244*    -------------------------------
   245     05  RUNDTEL PIC S9(0004) COMP.
   246     05  RUNDTEF PIC  X(0001).
   247     05  FILLER REDEFINES RUNDTEF.
   248         10  RUNDTEA PIC  X(0001).
   249     05  RUNDTEI PIC  X(0008).
   250*    -------------------------------
   251     05  RUNTIMEL PIC S9(0004) COMP.
   252     05  RUNTIMEF PIC  X(0001).
   253     05  FILLER REDEFINES RUNTIMEF.
   254         10  RUNTIMEA PIC  X(0001).
   255     05  RUNTIMEI PIC  X(0005).
   256*    -------------------------------
   257     05  COMPANYL PIC S9(0004) COMP.
   258     05  COMPANYF PIC  X(0001).
   259     05  FILLER REDEFINES COMPANYF.
   260         10  COMPANYA PIC  X(0001).
   261     05  COMPANYI PIC  X(0003).
   262*    -------------------------------
   263     05  USERIDL PIC S9(0004) COMP.
   264     05  USERIDF PIC  X(0001).
   265     05  FILLER REDEFINES USERIDF.
   266         10  USERIDA PIC  X(0001).
   267     05  USERIDI PIC  X(0004).
   268*    -------------------------------
   269     05  MAINTL PIC S9(0004) COMP.
   270     05  MAINTF PIC  X(0001).
   271     05  FILLER REDEFINES MAINTF.
   272         10  MAINTA PIC  X(0001).
   273     05  MAINTI PIC  X(0001).
   274*    -------------------------------
   275     05  TYPEBRL PIC S9(0004) COMP.
   276     05  TYPEBRF PIC  X(0001).
   277     05  FILLER REDEFINES TYPEBRF.
   278         10  TYPEBRA PIC  X(0001).
   279     05  TYPEBRI PIC  X(0001).
   280*    -------------------------------
   281     05  CERTRPL PIC S9(0004) COMP.
   282     05  CERTRPF PIC  X(0001).
   283     05  FILLER REDEFINES CERTRPF.
   284         10  CERTRPA PIC  X(0001).
   285     05  CERTRPI PIC  X(0010).
   286*    -------------------------------
   287     05  SUFFIXL PIC S9(0004) COMP.
   288     05  SUFFIXF PIC  X(0001).
   289     05  FILLER REDEFINES SUFFIXF.
   290         10  SUFFIXA PIC  X(0001).
   291     05  SUFFIXI PIC  X(0001).
   292*    -------------------------------
   293     05  FORML PIC S9(0004) COMP.
   294     05  FORMF PIC  X(0001).
   295     05  FILLER REDEFINES FORMF.
   296         10  FORMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   8
* EL690.cbl
   297     05  FORMI PIC  X(0004).
   298*    -------------------------------
   299     05  ENTRYL PIC S9(0004) COMP.
   300     05  ENTRYF PIC  X(0001).
   301     05  FILLER REDEFINES ENTRYF.
   302         10  ENTRYA PIC  X(0001).
   303     05  ENTRYI PIC  X(0006).
   304*    -------------------------------
   305     05  CKCNTLL PIC S9(0004) COMP.
   306     05  CKCNTLF PIC  X(0001).
   307     05  FILLER REDEFINES CKCNTLF.
   308         10  CKCNTLA PIC  X(0001).
   309     05  CKCNTLI PIC  9(8).
   310*    -------------------------------
   311     05  CARRIERL PIC S9(0004) COMP.
   312     05  CARRIERF PIC  X(0001).
   313     05  FILLER REDEFINES CARRIERF.
   314         10  CARRIERA PIC  X(0001).
   315     05  CARRIERI PIC  X(0001).
   316*    -------------------------------
   317     05  GROUPL PIC S9(0004) COMP.
   318     05  GROUPF PIC  X(0001).
   319     05  FILLER REDEFINES GROUPF.
   320         10  GROUPA PIC  X(0001).
   321     05  GROUPI PIC  X(0006).
   322*    -------------------------------
   323     05  STATEL PIC S9(0004) COMP.
   324     05  STATEF PIC  X(0001).
   325     05  FILLER REDEFINES STATEF.
   326         10  STATEA PIC  X(0001).
   327     05  STATEI PIC  X(0002).
   328*    -------------------------------
   329     05  ACCTL PIC S9(0004) COMP.
   330     05  ACCTF PIC  X(0001).
   331     05  FILLER REDEFINES ACCTF.
   332         10  ACCTA PIC  X(0001).
   333     05  ACCTI PIC  X(0010).
   334*    -------------------------------
   335     05  EFFDTEL PIC S9(0004) COMP.
   336     05  EFFDTEF PIC  X(0001).
   337     05  FILLER REDEFINES EFFDTEF.
   338         10  EFFDTEA PIC  X(0001).
   339     05  EFFDTEI PIC  X(0008).
   340*    -------------------------------
   341     05  PROCSRL PIC S9(0004) COMP.
   342     05  PROCSRF PIC  X(0001).
   343     05  FILLER REDEFINES PROCSRF.
   344         10  PROCSRA PIC  X(0001).
   345     05  PROCSRI PIC  X(0004).
   346*    -------------------------------
   347     05  CORRSELL PIC S9(0004) COMP.
   348     05  CORRSELF PIC  X(0001).
   349     05  FILLER REDEFINES CORRSELF.
   350         10  CORRSELA PIC  X(0001).
   351     05  CORRSELI PIC  X(0002).
   352*    -------------------------------
   353     05  STATSELL PIC S9(0004) COMP.
   354     05  STATSELF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page   9
* EL690.cbl
   355     05  FILLER REDEFINES STATSELF.
   356         10  STATSELA PIC  X(0001).
   357     05  STATSELI PIC  X(0001).
   358*    -------------------------------
   359     05  ARCNO1L PIC S9(0004) COMP.
   360     05  ARCNO1F PIC  X(0001).
   361     05  FILLER REDEFINES ARCNO1F.
   362         10  ARCNO1A PIC  X(0001).
   363     05  ARCNO1I PIC  X(0008).
   364*    -------------------------------
   365     05  FORM1L PIC S9(0004) COMP.
   366     05  FORM1F PIC  X(0001).
   367     05  FILLER REDEFINES FORM1F.
   368         10  FORM1A PIC  X(0001).
   369     05  FORM1I PIC  X(0004).
   370*    -------------------------------
   371     05  USRID1L PIC S9(0004) COMP.
   372     05  USRID1F PIC  X(0001).
   373     05  FILLER REDEFINES USRID1F.
   374         10  USRID1A PIC  X(0001).
   375     05  USRID1I PIC  X(0004).
   376*    -------------------------------
   377     05  PRINT1L PIC S9(0004) COMP.
   378     05  PRINT1F PIC  X(0001).
   379     05  FILLER REDEFINES PRINT1F.
   380         10  PRINT1A PIC  X(0001).
   381     05  PRINT1I PIC  X(0008).
   382*    -------------------------------
   383     05  STATS1L PIC S9(0004) COMP.
   384     05  STATS1F PIC  X(0001).
   385     05  FILLER REDEFINES STATS1F.
   386         10  STATS1A PIC  X(0001).
   387     05  STATS1I PIC  X(0008).
   388*    -------------------------------
   389     05  RSFRM1L PIC S9(0004) COMP.
   390     05  RSFRM1F PIC  X(0001).
   391     05  FILLER REDEFINES RSFRM1F.
   392         10  RSFRM1A PIC  X(0001).
   393     05  RSFRM1I PIC  X(0004).
   394*    -------------------------------
   395     05  RSDAT1L PIC S9(0004) COMP.
   396     05  RSDAT1F PIC  X(0001).
   397     05  FILLER REDEFINES RSDAT1F.
   398         10  RSDAT1A PIC  X(0001).
   399     05  RSDAT1I PIC  X(0008).
   400*    -------------------------------
   401     05  ARCNO2L PIC S9(0004) COMP.
   402     05  ARCNO2F PIC  X(0001).
   403     05  FILLER REDEFINES ARCNO2F.
   404         10  ARCNO2A PIC  X(0001).
   405     05  ARCNO2I PIC  X(0008).
   406*    -------------------------------
   407     05  FORM2L PIC S9(0004) COMP.
   408     05  FORM2F PIC  X(0001).
   409     05  FILLER REDEFINES FORM2F.
   410         10  FORM2A PIC  X(0001).
   411     05  FORM2I PIC  X(0004).
   412*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  10
* EL690.cbl
   413     05  USRID2L PIC S9(0004) COMP.
   414     05  USRID2F PIC  X(0001).
   415     05  FILLER REDEFINES USRID2F.
   416         10  USRID2A PIC  X(0001).
   417     05  USRID2I PIC  X(0004).
   418*    -------------------------------
   419     05  PRINT2L PIC S9(0004) COMP.
   420     05  PRINT2F PIC  X(0001).
   421     05  FILLER REDEFINES PRINT2F.
   422         10  PRINT2A PIC  X(0001).
   423     05  PRINT2I PIC  X(0008).
   424*    -------------------------------
   425     05  STATS2L PIC S9(0004) COMP.
   426     05  STATS2F PIC  X(0001).
   427     05  FILLER REDEFINES STATS2F.
   428         10  STATS2A PIC  X(0001).
   429     05  STATS2I PIC  X(0008).
   430*    -------------------------------
   431     05  RSFRM2L PIC S9(0004) COMP.
   432     05  RSFRM2F PIC  X(0001).
   433     05  FILLER REDEFINES RSFRM2F.
   434         10  RSFRM2A PIC  X(0001).
   435     05  RSFRM2I PIC  X(0004).
   436*    -------------------------------
   437     05  RSDAT2L PIC S9(0004) COMP.
   438     05  RSDAT2F PIC  X(0001).
   439     05  FILLER REDEFINES RSDAT2F.
   440         10  RSDAT2A PIC  X(0001).
   441     05  RSDAT2I PIC  X(0008).
   442*    -------------------------------
   443     05  ARCNO3L PIC S9(0004) COMP.
   444     05  ARCNO3F PIC  X(0001).
   445     05  FILLER REDEFINES ARCNO3F.
   446         10  ARCNO3A PIC  X(0001).
   447     05  ARCNO3I PIC  X(0008).
   448*    -------------------------------
   449     05  FORM3L PIC S9(0004) COMP.
   450     05  FORM3F PIC  X(0001).
   451     05  FILLER REDEFINES FORM3F.
   452         10  FORM3A PIC  X(0001).
   453     05  FORM3I PIC  X(0004).
   454*    -------------------------------
   455     05  USRID3L PIC S9(0004) COMP.
   456     05  USRID3F PIC  X(0001).
   457     05  FILLER REDEFINES USRID3F.
   458         10  USRID3A PIC  X(0001).
   459     05  USRID3I PIC  X(0004).
   460*    -------------------------------
   461     05  PRINT3L PIC S9(0004) COMP.
   462     05  PRINT3F PIC  X(0001).
   463     05  FILLER REDEFINES PRINT3F.
   464         10  PRINT3A PIC  X(0001).
   465     05  PRINT3I PIC  X(0008).
   466*    -------------------------------
   467     05  STATS3L PIC S9(0004) COMP.
   468     05  STATS3F PIC  X(0001).
   469     05  FILLER REDEFINES STATS3F.
   470         10  STATS3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  11
* EL690.cbl
   471     05  STATS3I PIC  X(0008).
   472*    -------------------------------
   473     05  RSFRM3L PIC S9(0004) COMP.
   474     05  RSFRM3F PIC  X(0001).
   475     05  FILLER REDEFINES RSFRM3F.
   476         10  RSFRM3A PIC  X(0001).
   477     05  RSFRM3I PIC  X(0004).
   478*    -------------------------------
   479     05  RSDAT3L PIC S9(0004) COMP.
   480     05  RSDAT3F PIC  X(0001).
   481     05  FILLER REDEFINES RSDAT3F.
   482         10  RSDAT3A PIC  X(0001).
   483     05  RSDAT3I PIC  X(0008).
   484*    -------------------------------
   485     05  ARCNO4L PIC S9(0004) COMP.
   486     05  ARCNO4F PIC  X(0001).
   487     05  FILLER REDEFINES ARCNO4F.
   488         10  ARCNO4A PIC  X(0001).
   489     05  ARCNO4I PIC  X(0008).
   490*    -------------------------------
   491     05  FORM4L PIC S9(0004) COMP.
   492     05  FORM4F PIC  X(0001).
   493     05  FILLER REDEFINES FORM4F.
   494         10  FORM4A PIC  X(0001).
   495     05  FORM4I PIC  X(0004).
   496*    -------------------------------
   497     05  USRID4L PIC S9(0004) COMP.
   498     05  USRID4F PIC  X(0001).
   499     05  FILLER REDEFINES USRID4F.
   500         10  USRID4A PIC  X(0001).
   501     05  USRID4I PIC  X(0004).
   502*    -------------------------------
   503     05  PRINT4L PIC S9(0004) COMP.
   504     05  PRINT4F PIC  X(0001).
   505     05  FILLER REDEFINES PRINT4F.
   506         10  PRINT4A PIC  X(0001).
   507     05  PRINT4I PIC  X(0008).
   508*    -------------------------------
   509     05  STATS4L PIC S9(0004) COMP.
   510     05  STATS4F PIC  X(0001).
   511     05  FILLER REDEFINES STATS4F.
   512         10  STATS4A PIC  X(0001).
   513     05  STATS4I PIC  X(0008).
   514*    -------------------------------
   515     05  RSFRM4L PIC S9(0004) COMP.
   516     05  RSFRM4F PIC  X(0001).
   517     05  FILLER REDEFINES RSFRM4F.
   518         10  RSFRM4A PIC  X(0001).
   519     05  RSFRM4I PIC  X(0004).
   520*    -------------------------------
   521     05  RSDAT4L PIC S9(0004) COMP.
   522     05  RSDAT4F PIC  X(0001).
   523     05  FILLER REDEFINES RSDAT4F.
   524         10  RSDAT4A PIC  X(0001).
   525     05  RSDAT4I PIC  X(0008).
   526*    -------------------------------
   527     05  ARCNO5L PIC S9(0004) COMP.
   528     05  ARCNO5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  12
* EL690.cbl
   529     05  FILLER REDEFINES ARCNO5F.
   530         10  ARCNO5A PIC  X(0001).
   531     05  ARCNO5I PIC  X(0008).
   532*    -------------------------------
   533     05  FORM5L PIC S9(0004) COMP.
   534     05  FORM5F PIC  X(0001).
   535     05  FILLER REDEFINES FORM5F.
   536         10  FORM5A PIC  X(0001).
   537     05  FORM5I PIC  X(0004).
   538*    -------------------------------
   539     05  USRID5L PIC S9(0004) COMP.
   540     05  USRID5F PIC  X(0001).
   541     05  FILLER REDEFINES USRID5F.
   542         10  USRID5A PIC  X(0001).
   543     05  USRID5I PIC  X(0004).
   544*    -------------------------------
   545     05  PRINT5L PIC S9(0004) COMP.
   546     05  PRINT5F PIC  X(0001).
   547     05  FILLER REDEFINES PRINT5F.
   548         10  PRINT5A PIC  X(0001).
   549     05  PRINT5I PIC  X(0008).
   550*    -------------------------------
   551     05  STATS5L PIC S9(0004) COMP.
   552     05  STATS5F PIC  X(0001).
   553     05  FILLER REDEFINES STATS5F.
   554         10  STATS5A PIC  X(0001).
   555     05  STATS5I PIC  X(0008).
   556*    -------------------------------
   557     05  RSFRM5L PIC S9(0004) COMP.
   558     05  RSFRM5F PIC  X(0001).
   559     05  FILLER REDEFINES RSFRM5F.
   560         10  RSFRM5A PIC  X(0001).
   561     05  RSFRM5I PIC  X(0004).
   562*    -------------------------------
   563     05  RSDAT5L PIC S9(0004) COMP.
   564     05  RSDAT5F PIC  X(0001).
   565     05  FILLER REDEFINES RSDAT5F.
   566         10  RSDAT5A PIC  X(0001).
   567     05  RSDAT5I PIC  X(0008).
   568*    -------------------------------
   569     05  ARCNO6L PIC S9(0004) COMP.
   570     05  ARCNO6F PIC  X(0001).
   571     05  FILLER REDEFINES ARCNO6F.
   572         10  ARCNO6A PIC  X(0001).
   573     05  ARCNO6I PIC  X(0008).
   574*    -------------------------------
   575     05  FORM6L PIC S9(0004) COMP.
   576     05  FORM6F PIC  X(0001).
   577     05  FILLER REDEFINES FORM6F.
   578         10  FORM6A PIC  X(0001).
   579     05  FORM6I PIC  X(0004).
   580*    -------------------------------
   581     05  USRID6L PIC S9(0004) COMP.
   582     05  USRID6F PIC  X(0001).
   583     05  FILLER REDEFINES USRID6F.
   584         10  USRID6A PIC  X(0001).
   585     05  USRID6I PIC  X(0004).
   586*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  13
* EL690.cbl
   587     05  PRINT6L PIC S9(0004) COMP.
   588     05  PRINT6F PIC  X(0001).
   589     05  FILLER REDEFINES PRINT6F.
   590         10  PRINT6A PIC  X(0001).
   591     05  PRINT6I PIC  X(0008).
   592*    -------------------------------
   593     05  STATS6L PIC S9(0004) COMP.
   594     05  STATS6F PIC  X(0001).
   595     05  FILLER REDEFINES STATS6F.
   596         10  STATS6A PIC  X(0001).
   597     05  STATS6I PIC  X(0008).
   598*    -------------------------------
   599     05  RSFRM6L PIC S9(0004) COMP.
   600     05  RSFRM6F PIC  X(0001).
   601     05  FILLER REDEFINES RSFRM6F.
   602         10  RSFRM6A PIC  X(0001).
   603     05  RSFRM6I PIC  X(0004).
   604*    -------------------------------
   605     05  RSDAT6L PIC S9(0004) COMP.
   606     05  RSDAT6F PIC  X(0001).
   607     05  FILLER REDEFINES RSDAT6F.
   608         10  RSDAT6A PIC  X(0001).
   609     05  RSDAT6I PIC  X(0008).
   610*    -------------------------------
   611     05  ARCNO7L PIC S9(0004) COMP.
   612     05  ARCNO7F PIC  X(0001).
   613     05  FILLER REDEFINES ARCNO7F.
   614         10  ARCNO7A PIC  X(0001).
   615     05  ARCNO7I PIC  X(0008).
   616*    -------------------------------
   617     05  FORM7L PIC S9(0004) COMP.
   618     05  FORM7F PIC  X(0001).
   619     05  FILLER REDEFINES FORM7F.
   620         10  FORM7A PIC  X(0001).
   621     05  FORM7I PIC  X(0004).
   622*    -------------------------------
   623     05  USRID7L PIC S9(0004) COMP.
   624     05  USRID7F PIC  X(0001).
   625     05  FILLER REDEFINES USRID7F.
   626         10  USRID7A PIC  X(0001).
   627     05  USRID7I PIC  X(0004).
   628*    -------------------------------
   629     05  PRINT7L PIC S9(0004) COMP.
   630     05  PRINT7F PIC  X(0001).
   631     05  FILLER REDEFINES PRINT7F.
   632         10  PRINT7A PIC  X(0001).
   633     05  PRINT7I PIC  X(0008).
   634*    -------------------------------
   635     05  STATS7L PIC S9(0004) COMP.
   636     05  STATS7F PIC  X(0001).
   637     05  FILLER REDEFINES STATS7F.
   638         10  STATS7A PIC  X(0001).
   639     05  STATS7I PIC  X(0008).
   640*    -------------------------------
   641     05  RSFRM7L PIC S9(0004) COMP.
   642     05  RSFRM7F PIC  X(0001).
   643     05  FILLER REDEFINES RSFRM7F.
   644         10  RSFRM7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  14
* EL690.cbl
   645     05  RSFRM7I PIC  X(0004).
   646*    -------------------------------
   647     05  RSDAT7L PIC S9(0004) COMP.
   648     05  RSDAT7F PIC  X(0001).
   649     05  FILLER REDEFINES RSDAT7F.
   650         10  RSDAT7A PIC  X(0001).
   651     05  RSDAT7I PIC  X(0008).
   652*    -------------------------------
   653     05  ARCNO8L PIC S9(0004) COMP.
   654     05  ARCNO8F PIC  X(0001).
   655     05  FILLER REDEFINES ARCNO8F.
   656         10  ARCNO8A PIC  X(0001).
   657     05  ARCNO8I PIC  X(0008).
   658*    -------------------------------
   659     05  FORM8L PIC S9(0004) COMP.
   660     05  FORM8F PIC  X(0001).
   661     05  FILLER REDEFINES FORM8F.
   662         10  FORM8A PIC  X(0001).
   663     05  FORM8I PIC  X(0004).
   664*    -------------------------------
   665     05  USRID8L PIC S9(0004) COMP.
   666     05  USRID8F PIC  X(0001).
   667     05  FILLER REDEFINES USRID8F.
   668         10  USRID8A PIC  X(0001).
   669     05  USRID8I PIC  X(0004).
   670*    -------------------------------
   671     05  PRINT8L PIC S9(0004) COMP.
   672     05  PRINT8F PIC  X(0001).
   673     05  FILLER REDEFINES PRINT8F.
   674         10  PRINT8A PIC  X(0001).
   675     05  PRINT8I PIC  X(0008).
   676*    -------------------------------
   677     05  STATS8L PIC S9(0004) COMP.
   678     05  STATS8F PIC  X(0001).
   679     05  FILLER REDEFINES STATS8F.
   680         10  STATS8A PIC  X(0001).
   681     05  STATS8I PIC  X(0008).
   682*    -------------------------------
   683     05  RSFRM8L PIC S9(0004) COMP.
   684     05  RSFRM8F PIC  X(0001).
   685     05  FILLER REDEFINES RSFRM8F.
   686         10  RSFRM8A PIC  X(0001).
   687     05  RSFRM8I PIC  X(0004).
   688*    -------------------------------
   689     05  RSDAT8L PIC S9(0004) COMP.
   690     05  RSDAT8F PIC  X(0001).
   691     05  FILLER REDEFINES RSDAT8F.
   692         10  RSDAT8A PIC  X(0001).
   693     05  RSDAT8I PIC  X(0008).
   694*    -------------------------------
   695     05  ARCNO9L PIC S9(0004) COMP.
   696     05  ARCNO9F PIC  X(0001).
   697     05  FILLER REDEFINES ARCNO9F.
   698         10  ARCNO9A PIC  X(0001).
   699     05  ARCNO9I PIC  X(0008).
   700*    -------------------------------
   701     05  FORM9L PIC S9(0004) COMP.
   702     05  FORM9F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  15
* EL690.cbl
   703     05  FILLER REDEFINES FORM9F.
   704         10  FORM9A PIC  X(0001).
   705     05  FORM9I PIC  X(0004).
   706*    -------------------------------
   707     05  USRID9L PIC S9(0004) COMP.
   708     05  USRID9F PIC  X(0001).
   709     05  FILLER REDEFINES USRID9F.
   710         10  USRID9A PIC  X(0001).
   711     05  USRID9I PIC  X(0004).
   712*    -------------------------------
   713     05  PRINT9L PIC S9(0004) COMP.
   714     05  PRINT9F PIC  X(0001).
   715     05  FILLER REDEFINES PRINT9F.
   716         10  PRINT9A PIC  X(0001).
   717     05  PRINT9I PIC  X(0008).
   718*    -------------------------------
   719     05  STATS9L PIC S9(0004) COMP.
   720     05  STATS9F PIC  X(0001).
   721     05  FILLER REDEFINES STATS9F.
   722         10  STATS9A PIC  X(0001).
   723     05  STATS9I PIC  X(0008).
   724*    -------------------------------
   725     05  RSFRM9L PIC S9(0004) COMP.
   726     05  RSFRM9F PIC  X(0001).
   727     05  FILLER REDEFINES RSFRM9F.
   728         10  RSFRM9A PIC  X(0001).
   729     05  RSFRM9I PIC  X(0004).
   730*    -------------------------------
   731     05  RSDAT9L PIC S9(0004) COMP.
   732     05  RSDAT9F PIC  X(0001).
   733     05  FILLER REDEFINES RSDAT9F.
   734         10  RSDAT9A PIC  X(0001).
   735     05  RSDAT9I PIC  X(0008).
   736*    -------------------------------
   737     05  ARCNO10L PIC S9(0004) COMP.
   738     05  ARCNO10F PIC  X(0001).
   739     05  FILLER REDEFINES ARCNO10F.
   740         10  ARCNO10A PIC  X(0001).
   741     05  ARCNO10I PIC  X(0008).
   742*    -------------------------------
   743     05  FORM10L PIC S9(0004) COMP.
   744     05  FORM10F PIC  X(0001).
   745     05  FILLER REDEFINES FORM10F.
   746         10  FORM10A PIC  X(0001).
   747     05  FORM10I PIC  X(0004).
   748*    -------------------------------
   749     05  USRID10L PIC S9(0004) COMP.
   750     05  USRID10F PIC  X(0001).
   751     05  FILLER REDEFINES USRID10F.
   752         10  USRID10A PIC  X(0001).
   753     05  USRID10I PIC  X(0004).
   754*    -------------------------------
   755     05  PRINT10L PIC S9(0004) COMP.
   756     05  PRINT10F PIC  X(0001).
   757     05  FILLER REDEFINES PRINT10F.
   758         10  PRINT10A PIC  X(0001).
   759     05  PRINT10I PIC  X(0008).
   760*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  16
* EL690.cbl
   761     05  STATS10L PIC S9(0004) COMP.
   762     05  STATS10F PIC  X(0001).
   763     05  FILLER REDEFINES STATS10F.
   764         10  STATS10A PIC  X(0001).
   765     05  STATS10I PIC  X(0008).
   766*    -------------------------------
   767     05  RSFRM10L PIC S9(0004) COMP.
   768     05  RSFRM10F PIC  X(0001).
   769     05  FILLER REDEFINES RSFRM10F.
   770         10  RSFRM10A PIC  X(0001).
   771     05  RSFRM10I PIC  X(0004).
   772*    -------------------------------
   773     05  RSDAT10L PIC S9(0004) COMP.
   774     05  RSDAT10F PIC  X(0001).
   775     05  FILLER REDEFINES RSDAT10F.
   776         10  RSDAT10A PIC  X(0001).
   777     05  RSDAT10I PIC  X(0008).
   778*    -------------------------------
   779     05  ARCNO11L PIC S9(0004) COMP.
   780     05  ARCNO11F PIC  X(0001).
   781     05  FILLER REDEFINES ARCNO11F.
   782         10  ARCNO11A PIC  X(0001).
   783     05  ARCNO11I PIC  X(0008).
   784*    -------------------------------
   785     05  FORM11L PIC S9(0004) COMP.
   786     05  FORM11F PIC  X(0001).
   787     05  FILLER REDEFINES FORM11F.
   788         10  FORM11A PIC  X(0001).
   789     05  FORM11I PIC  X(0004).
   790*    -------------------------------
   791     05  USRID11L PIC S9(0004) COMP.
   792     05  USRID11F PIC  X(0001).
   793     05  FILLER REDEFINES USRID11F.
   794         10  USRID11A PIC  X(0001).
   795     05  USRID11I PIC  X(0004).
   796*    -------------------------------
   797     05  PRINT11L PIC S9(0004) COMP.
   798     05  PRINT11F PIC  X(0001).
   799     05  FILLER REDEFINES PRINT11F.
   800         10  PRINT11A PIC  X(0001).
   801     05  PRINT11I PIC  X(0008).
   802*    -------------------------------
   803     05  STATS11L PIC S9(0004) COMP.
   804     05  STATS11F PIC  X(0001).
   805     05  FILLER REDEFINES STATS11F.
   806         10  STATS11A PIC  X(0001).
   807     05  STATS11I PIC  X(0008).
   808*    -------------------------------
   809     05  RSFRM11L PIC S9(0004) COMP.
   810     05  RSFRM11F PIC  X(0001).
   811     05  FILLER REDEFINES RSFRM11F.
   812         10  RSFRM11A PIC  X(0001).
   813     05  RSFRM11I PIC  X(0004).
   814*    -------------------------------
   815     05  RSDAT11L PIC S9(0004) COMP.
   816     05  RSDAT11F PIC  X(0001).
   817     05  FILLER REDEFINES RSDAT11F.
   818         10  RSDAT11A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  17
* EL690.cbl
   819     05  RSDAT11I PIC  X(0008).
   820*    -------------------------------
   821     05  ARCNO12L PIC S9(0004) COMP.
   822     05  ARCNO12F PIC  X(0001).
   823     05  FILLER REDEFINES ARCNO12F.
   824         10  ARCNO12A PIC  X(0001).
   825     05  ARCNO12I PIC  X(0008).
   826*    -------------------------------
   827     05  FORM12L PIC S9(0004) COMP.
   828     05  FORM12F PIC  X(0001).
   829     05  FILLER REDEFINES FORM12F.
   830         10  FORM12A PIC  X(0001).
   831     05  FORM12I PIC  X(0004).
   832*    -------------------------------
   833     05  USRID12L PIC S9(0004) COMP.
   834     05  USRID12F PIC  X(0001).
   835     05  FILLER REDEFINES USRID12F.
   836         10  USRID12A PIC  X(0001).
   837     05  USRID12I PIC  X(0004).
   838*    -------------------------------
   839     05  PRINT12L PIC S9(0004) COMP.
   840     05  PRINT12F PIC  X(0001).
   841     05  FILLER REDEFINES PRINT12F.
   842         10  PRINT12A PIC  X(0001).
   843     05  PRINT12I PIC  X(0008).
   844*    -------------------------------
   845     05  STATS12L PIC S9(0004) COMP.
   846     05  STATS12F PIC  X(0001).
   847     05  FILLER REDEFINES STATS12F.
   848         10  STATS12A PIC  X(0001).
   849     05  STATS12I PIC  X(0008).
   850*    -------------------------------
   851     05  RSFRM12L PIC S9(0004) COMP.
   852     05  RSFRM12F PIC  X(0001).
   853     05  FILLER REDEFINES RSFRM12F.
   854         10  RSFRM12A PIC  X(0001).
   855     05  RSFRM12I PIC  X(0004).
   856*    -------------------------------
   857     05  RSDAT12L PIC S9(0004) COMP.
   858     05  RSDAT12F PIC  X(0001).
   859     05  FILLER REDEFINES RSDAT12F.
   860         10  RSDAT12A PIC  X(0001).
   861     05  RSDAT12I PIC  X(0008).
   862*    -------------------------------
   863     05  ERRMSG1L PIC S9(0004) COMP.
   864     05  ERRMSG1F PIC  X(0001).
   865     05  FILLER REDEFINES ERRMSG1F.
   866         10  ERRMSG1A PIC  X(0001).
   867     05  ERRMSG1I PIC  X(0079).
   868*    -------------------------------
   869     05  PFKEYL PIC S9(0004) COMP.
   870     05  PFKEYF PIC  X(0001).
   871     05  FILLER REDEFINES PFKEYF.
   872         10  PFKEYA PIC  X(0001).
   873     05  PFKEYI PIC  9(2).
   874 01  EL690AO REDEFINES EL690AI.
   875     05  FILLER            PIC  X(0012).
   876*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  18
* EL690.cbl
   877     05  FILLER            PIC  X(0003).
   878     05  RUNDTEO PIC  X(0008).
   879*    -------------------------------
   880     05  FILLER            PIC  X(0003).
   881     05  RUNTIMEO PIC  99.99.
   882*    -------------------------------
   883     05  FILLER            PIC  X(0003).
   884     05  COMPANYO PIC  X(0003).
   885*    -------------------------------
   886     05  FILLER            PIC  X(0003).
   887     05  USERIDO PIC  X(0004).
   888*    -------------------------------
   889     05  FILLER            PIC  X(0003).
   890     05  MAINTO PIC  X(0001).
   891*    -------------------------------
   892     05  FILLER            PIC  X(0003).
   893     05  TYPEBRO PIC  X(0001).
   894*    -------------------------------
   895     05  FILLER            PIC  X(0003).
   896     05  CERTRPO PIC  X(0010).
   897*    -------------------------------
   898     05  FILLER            PIC  X(0003).
   899     05  SUFFIXO PIC  X(0001).
   900*    -------------------------------
   901     05  FILLER            PIC  X(0003).
   902     05  FORMO PIC  X(0004).
   903*    -------------------------------
   904     05  FILLER            PIC  X(0003).
   905     05  ENTRYO PIC  X(0006).
   906*    -------------------------------
   907     05  FILLER            PIC  X(0003).
   908     05  CKCNTLO PIC  ZZZZZZZ9.
   909*    -------------------------------
   910     05  FILLER            PIC  X(0003).
   911     05  CARRIERO PIC  X(0001).
   912*    -------------------------------
   913     05  FILLER            PIC  X(0003).
   914     05  GROUPO PIC  X(0006).
   915*    -------------------------------
   916     05  FILLER            PIC  X(0003).
   917     05  STATEO PIC  X(0002).
   918*    -------------------------------
   919     05  FILLER            PIC  X(0003).
   920     05  ACCTO PIC  X(0010).
   921*    -------------------------------
   922     05  FILLER            PIC  X(0003).
   923     05  EFFDTEO PIC  X(0008).
   924*    -------------------------------
   925     05  FILLER            PIC  X(0003).
   926     05  PROCSRO PIC  X(0004).
   927*    -------------------------------
   928     05  FILLER            PIC  X(0003).
   929     05  CORRSELO PIC  ZZ.
   930*    -------------------------------
   931     05  FILLER            PIC  X(0003).
   932     05  STATSELO PIC  X(0001).
   933*    -------------------------------
   934     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  19
* EL690.cbl
   935     05  ARCNO1O PIC  X(0008).
   936*    -------------------------------
   937     05  FILLER            PIC  X(0003).
   938     05  FORM1O PIC  X(0004).
   939*    -------------------------------
   940     05  FILLER            PIC  X(0003).
   941     05  USRID1O PIC  X(0004).
   942*    -------------------------------
   943     05  FILLER            PIC  X(0003).
   944     05  PRINT1O PIC  X(0008).
   945*    -------------------------------
   946     05  FILLER            PIC  X(0003).
   947     05  STATS1O PIC  X(0008).
   948*    -------------------------------
   949     05  FILLER            PIC  X(0003).
   950     05  RSFRM1O PIC  X(0004).
   951*    -------------------------------
   952     05  FILLER            PIC  X(0003).
   953     05  RSDAT1O PIC  X(0008).
   954*    -------------------------------
   955     05  FILLER            PIC  X(0003).
   956     05  ARCNO2O PIC  X(0008).
   957*    -------------------------------
   958     05  FILLER            PIC  X(0003).
   959     05  FORM2O PIC  X(0004).
   960*    -------------------------------
   961     05  FILLER            PIC  X(0003).
   962     05  USRID2O PIC  X(0004).
   963*    -------------------------------
   964     05  FILLER            PIC  X(0003).
   965     05  PRINT2O PIC  X(0008).
   966*    -------------------------------
   967     05  FILLER            PIC  X(0003).
   968     05  STATS2O PIC  X(0008).
   969*    -------------------------------
   970     05  FILLER            PIC  X(0003).
   971     05  RSFRM2O PIC  X(0004).
   972*    -------------------------------
   973     05  FILLER            PIC  X(0003).
   974     05  RSDAT2O PIC  X(0008).
   975*    -------------------------------
   976     05  FILLER            PIC  X(0003).
   977     05  ARCNO3O PIC  X(0008).
   978*    -------------------------------
   979     05  FILLER            PIC  X(0003).
   980     05  FORM3O PIC  X(0004).
   981*    -------------------------------
   982     05  FILLER            PIC  X(0003).
   983     05  USRID3O PIC  X(0004).
   984*    -------------------------------
   985     05  FILLER            PIC  X(0003).
   986     05  PRINT3O PIC  X(0008).
   987*    -------------------------------
   988     05  FILLER            PIC  X(0003).
   989     05  STATS3O PIC  X(0008).
   990*    -------------------------------
   991     05  FILLER            PIC  X(0003).
   992     05  RSFRM3O PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  20
* EL690.cbl
   993*    -------------------------------
   994     05  FILLER            PIC  X(0003).
   995     05  RSDAT3O PIC  X(0008).
   996*    -------------------------------
   997     05  FILLER            PIC  X(0003).
   998     05  ARCNO4O PIC  X(0008).
   999*    -------------------------------
  1000     05  FILLER            PIC  X(0003).
  1001     05  FORM4O PIC  X(0004).
  1002*    -------------------------------
  1003     05  FILLER            PIC  X(0003).
  1004     05  USRID4O PIC  X(0004).
  1005*    -------------------------------
  1006     05  FILLER            PIC  X(0003).
  1007     05  PRINT4O PIC  X(0008).
  1008*    -------------------------------
  1009     05  FILLER            PIC  X(0003).
  1010     05  STATS4O PIC  X(0008).
  1011*    -------------------------------
  1012     05  FILLER            PIC  X(0003).
  1013     05  RSFRM4O PIC  X(0004).
  1014*    -------------------------------
  1015     05  FILLER            PIC  X(0003).
  1016     05  RSDAT4O PIC  X(0008).
  1017*    -------------------------------
  1018     05  FILLER            PIC  X(0003).
  1019     05  ARCNO5O PIC  X(0008).
  1020*    -------------------------------
  1021     05  FILLER            PIC  X(0003).
  1022     05  FORM5O PIC  X(0004).
  1023*    -------------------------------
  1024     05  FILLER            PIC  X(0003).
  1025     05  USRID5O PIC  X(0004).
  1026*    -------------------------------
  1027     05  FILLER            PIC  X(0003).
  1028     05  PRINT5O PIC  X(0008).
  1029*    -------------------------------
  1030     05  FILLER            PIC  X(0003).
  1031     05  STATS5O PIC  X(0008).
  1032*    -------------------------------
  1033     05  FILLER            PIC  X(0003).
  1034     05  RSFRM5O PIC  X(0004).
  1035*    -------------------------------
  1036     05  FILLER            PIC  X(0003).
  1037     05  RSDAT5O PIC  X(0008).
  1038*    -------------------------------
  1039     05  FILLER            PIC  X(0003).
  1040     05  ARCNO6O PIC  X(0008).
  1041*    -------------------------------
  1042     05  FILLER            PIC  X(0003).
  1043     05  FORM6O PIC  X(0004).
  1044*    -------------------------------
  1045     05  FILLER            PIC  X(0003).
  1046     05  USRID6O PIC  X(0004).
  1047*    -------------------------------
  1048     05  FILLER            PIC  X(0003).
  1049     05  PRINT6O PIC  X(0008).
  1050*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  21
* EL690.cbl
  1051     05  FILLER            PIC  X(0003).
  1052     05  STATS6O PIC  X(0008).
  1053*    -------------------------------
  1054     05  FILLER            PIC  X(0003).
  1055     05  RSFRM6O PIC  X(0004).
  1056*    -------------------------------
  1057     05  FILLER            PIC  X(0003).
  1058     05  RSDAT6O PIC  X(0008).
  1059*    -------------------------------
  1060     05  FILLER            PIC  X(0003).
  1061     05  ARCNO7O PIC  X(0008).
  1062*    -------------------------------
  1063     05  FILLER            PIC  X(0003).
  1064     05  FORM7O PIC  X(0004).
  1065*    -------------------------------
  1066     05  FILLER            PIC  X(0003).
  1067     05  USRID7O PIC  X(0004).
  1068*    -------------------------------
  1069     05  FILLER            PIC  X(0003).
  1070     05  PRINT7O PIC  X(0008).
  1071*    -------------------------------
  1072     05  FILLER            PIC  X(0003).
  1073     05  STATS7O PIC  X(0008).
  1074*    -------------------------------
  1075     05  FILLER            PIC  X(0003).
  1076     05  RSFRM7O PIC  X(0004).
  1077*    -------------------------------
  1078     05  FILLER            PIC  X(0003).
  1079     05  RSDAT7O PIC  X(0008).
  1080*    -------------------------------
  1081     05  FILLER            PIC  X(0003).
  1082     05  ARCNO8O PIC  X(0008).
  1083*    -------------------------------
  1084     05  FILLER            PIC  X(0003).
  1085     05  FORM8O PIC  X(0004).
  1086*    -------------------------------
  1087     05  FILLER            PIC  X(0003).
  1088     05  USRID8O PIC  X(0004).
  1089*    -------------------------------
  1090     05  FILLER            PIC  X(0003).
  1091     05  PRINT8O PIC  X(0008).
  1092*    -------------------------------
  1093     05  FILLER            PIC  X(0003).
  1094     05  STATS8O PIC  X(0008).
  1095*    -------------------------------
  1096     05  FILLER            PIC  X(0003).
  1097     05  RSFRM8O PIC  X(0004).
  1098*    -------------------------------
  1099     05  FILLER            PIC  X(0003).
  1100     05  RSDAT8O PIC  X(0008).
  1101*    -------------------------------
  1102     05  FILLER            PIC  X(0003).
  1103     05  ARCNO9O PIC  X(0008).
  1104*    -------------------------------
  1105     05  FILLER            PIC  X(0003).
  1106     05  FORM9O PIC  X(0004).
  1107*    -------------------------------
  1108     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  22
* EL690.cbl
  1109     05  USRID9O PIC  X(0004).
  1110*    -------------------------------
  1111     05  FILLER            PIC  X(0003).
  1112     05  PRINT9O PIC  X(0008).
  1113*    -------------------------------
  1114     05  FILLER            PIC  X(0003).
  1115     05  STATS9O PIC  X(0008).
  1116*    -------------------------------
  1117     05  FILLER            PIC  X(0003).
  1118     05  RSFRM9O PIC  X(0004).
  1119*    -------------------------------
  1120     05  FILLER            PIC  X(0003).
  1121     05  RSDAT9O PIC  X(0008).
  1122*    -------------------------------
  1123     05  FILLER            PIC  X(0003).
  1124     05  ARCNO10O PIC  X(0008).
  1125*    -------------------------------
  1126     05  FILLER            PIC  X(0003).
  1127     05  FORM10O PIC  X(0004).
  1128*    -------------------------------
  1129     05  FILLER            PIC  X(0003).
  1130     05  USRID10O PIC  X(0004).
  1131*    -------------------------------
  1132     05  FILLER            PIC  X(0003).
  1133     05  PRINT10O PIC  X(0008).
  1134*    -------------------------------
  1135     05  FILLER            PIC  X(0003).
  1136     05  STATS10O PIC  X(0008).
  1137*    -------------------------------
  1138     05  FILLER            PIC  X(0003).
  1139     05  RSFRM10O PIC  X(0004).
  1140*    -------------------------------
  1141     05  FILLER            PIC  X(0003).
  1142     05  RSDAT10O PIC  X(0008).
  1143*    -------------------------------
  1144     05  FILLER            PIC  X(0003).
  1145     05  ARCNO11O PIC  X(0008).
  1146*    -------------------------------
  1147     05  FILLER            PIC  X(0003).
  1148     05  FORM11O PIC  X(0004).
  1149*    -------------------------------
  1150     05  FILLER            PIC  X(0003).
  1151     05  USRID11O PIC  X(0004).
  1152*    -------------------------------
  1153     05  FILLER            PIC  X(0003).
  1154     05  PRINT11O PIC  X(0008).
  1155*    -------------------------------
  1156     05  FILLER            PIC  X(0003).
  1157     05  STATS11O PIC  X(0008).
  1158*    -------------------------------
  1159     05  FILLER            PIC  X(0003).
  1160     05  RSFRM11O PIC  X(0004).
  1161*    -------------------------------
  1162     05  FILLER            PIC  X(0003).
  1163     05  RSDAT11O PIC  X(0008).
  1164*    -------------------------------
  1165     05  FILLER            PIC  X(0003).
  1166     05  ARCNO12O PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  23
* EL690.cbl
  1167*    -------------------------------
  1168     05  FILLER            PIC  X(0003).
  1169     05  FORM12O PIC  X(0004).
  1170*    -------------------------------
  1171     05  FILLER            PIC  X(0003).
  1172     05  USRID12O PIC  X(0004).
  1173*    -------------------------------
  1174     05  FILLER            PIC  X(0003).
  1175     05  PRINT12O PIC  X(0008).
  1176*    -------------------------------
  1177     05  FILLER            PIC  X(0003).
  1178     05  STATS12O PIC  X(0008).
  1179*    -------------------------------
  1180     05  FILLER            PIC  X(0003).
  1181     05  RSFRM12O PIC  X(0004).
  1182*    -------------------------------
  1183     05  FILLER            PIC  X(0003).
  1184     05  RSDAT12O PIC  X(0008).
  1185*    -------------------------------
  1186     05  FILLER            PIC  X(0003).
  1187     05  ERRMSG1O PIC  X(0079).
  1188*    -------------------------------
  1189     05  FILLER            PIC  X(0003).
  1190     05  PFKEYO PIC  X(0002).
  1191*    -------------------------------
  1192 01  FILLER REDEFINES EL690AI.
  1193     16  FILLER                  PIC X(154).
  1194     16  W-ARCH-GROUPS.
  1195         20  W-ARCHGRP-DATA OCCURS 12 TIMES.
  1196             24  W-ARCNOL        PIC S9(04) COMP.
  1197             24  W-ARCNOA        PIC  X(01).
  1198             24  W-ARCNOO        PIC  9(08).
  1199             24  W-FORML         PIC S9(04) COMP.
  1200             24  W-FORMA         PIC  X(01).
  1201             24  W-FORMO         PIC  X(04).
  1202             24  W-USRIDL        PIC S9(04) COMP.
  1203             24  W-USRIDA        PIC  X(01).
  1204             24  W-USRIDO        PIC  X(04).
  1205             24  W-PRINTL        PIC S9(04) COMP.
  1206             24  W-PRINTA        PIC  X(01).
  1207             24  W-PRINTO        PIC  X(08).
  1208             24  W-STATUSL       PIC S9(04) COMP.
  1209             24  W-STATUSA       PIC  X(01).
  1210             24  W-STATUSO       PIC  X(08).
  1211             24  W-RSFRML        PIC S9(04) COMP.
  1212             24  W-RSFRMA        PIC  X(01).
  1213             24  W-RSFRMO        PIC  X(04).
  1214             24  W-RSDATL        PIC S9(04) COMP.
  1215             24  W-RSDATA        PIC  X(01).
  1216             24  W-RSDATO        PIC  X(08).
  1217     16  FILLER                  PIC  X(87).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  24
* EL690.cbl
  1219
  1220 01  FILLER                      PIC  X(22)
  1221                                 VALUE 'PGRM INTERFACE STARTS:'.
  1222*    COPY ELCINTF.
  1223******************************************************************
  1224*                                                                *
  1225*                                                                *
  1226*                            ELCINTF.                            *
  1227*                            VMOD=2.017                          *
  1228*                                                                *
  1229*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1230*                                                                *
  1231*       LENGTH = 1024                                            *
  1232*                                                                *
  1233******************************************************************
  1234*                   C H A N G E   L O G
  1235*
  1236* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1237*-----------------------------------------------------------------
  1238*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1239* EFFECTIVE    NUMBER
  1240*-----------------------------------------------------------------
  1241* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1242******************************************************************
  1243 01  PROGRAM-INTERFACE-BLOCK.
  1244     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1245     12  PI-CALLING-PROGRAM              PIC X(8).
  1246     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1247     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1248     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1249     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1250     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1251     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1252     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1253     12  PI-COMPANY-ID                   PIC XXX.
  1254     12  PI-COMPANY-CD                   PIC X.
  1255
  1256     12  PI-COMPANY-PASSWORD             PIC X(8).
  1257
  1258     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1259
  1260     12  PI-CONTROL-IN-PROGRESS.
  1261         16  PI-CARRIER                  PIC X.
  1262         16  PI-GROUPING                 PIC X(6).
  1263         16  PI-STATE                    PIC XX.
  1264         16  PI-ACCOUNT                  PIC X(10).
  1265         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1266                                         PIC X(10).
  1267         16  PI-CLAIM-CERT-GRP.
  1268             20  PI-CLAIM-NO             PIC X(7).
  1269             20  PI-CERT-NO.
  1270                 25  PI-CERT-PRIME       PIC X(10).
  1271                 25  PI-CERT-SFX         PIC X.
  1272             20  PI-CERT-EFF-DT          PIC XX.
  1273         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1274             20  PI-PLAN-CODE            PIC X(2).
  1275             20  PI-REVISION-NUMBER      PIC X(3).
  1276             20  PI-PLAN-EFF-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  25
* EL690.cbl
  1277             20  PI-PLAN-EXP-DT          PIC X(2).
  1278             20  FILLER                  PIC X(11).
  1279         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1280             20  PI-OE-REFERENCE-1.
  1281                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1282                 25  PI-OE-REF-1-SUFF    PIC XX.
  1283
  1284     12  PI-SESSION-IN-PROGRESS          PIC X.
  1285         88  CLAIM-SESSION                   VALUE '1'.
  1286         88  CREDIT-SESSION                  VALUE '2'.
  1287         88  WARRANTY-SESSION                VALUE '3'.
  1288         88  MORTGAGE-SESSION                VALUE '4'.
  1289         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1290
  1291
  1292*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1293
  1294     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1295     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1296
  1297     12  PI-CREDIT-USER                  PIC X.
  1298         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1299         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1300
  1301     12  PI-CLAIM-USER                   PIC X.
  1302         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1303         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1304
  1305     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1306         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1307         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1308         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1309         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1310         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1311
  1312     12  PI-PROCESSOR-ID                 PIC X(4).
  1313
  1314     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1315
  1316     12  PI-MEMBER-CAPTION               PIC X(10).
  1317
  1318     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1319         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1320
  1321     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1322     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1323     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1324     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1325
  1326     12  PI-AH-OVERRIDE-L1               PIC X.
  1327     12  PI-AH-OVERRIDE-L2               PIC XX.
  1328     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1329     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1330
  1331     12  PI-NEW-SYSTEM                   PIC X(2).
  1332
  1333     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1334     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  26
* EL690.cbl
  1335         88  PI-USES-PAID-TO                 VALUE '1'.
  1336     12  PI-CRDTCRD-SYSTEM.
  1337         16  PI-CRDTCRD-USER             PIC X.
  1338             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1339             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1340         16  PI-CC-MONTH-END-DT          PIC XX.
  1341     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1342
  1343     12  PI-OE-REFERENCE-2.
  1344         16  PI-OE-REF-2-PRIME           PIC X(10).
  1345         16  PI-OE-REF-2-SUFF            PIC X.
  1346
  1347     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1348
  1349     12  PI-LANGUAGE-TYPE                PIC X.
  1350             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1351             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1352             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1353
  1354     12  PI-POLICY-LINKAGE-IND           PIC X.
  1355         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1356         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1357                                                   LOW-VALUES.
  1358
  1359     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1360     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1361         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1362         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1363
  1364     12  PI-PROCESSOR-CSR-IND            PIC X.
  1365         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1366         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1367
  1368     12  FILLER                          PIC X(3).
  1369
  1370     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1371
  1372     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1373         PI-SYSTEM-LEVEL.
  1374
  1375         16  PI-ENTRY-CODES.
  1376             20  PI-ENTRY-CD-1           PIC X.
  1377             20  PI-ENTRY-CD-2           PIC X.
  1378
  1379         16  PI-RETURN-CODES.
  1380             20  PI-RETURN-CD-1          PIC X.
  1381             20  PI-RETURN-CD-2          PIC X.
  1382
  1383         16  PI-UPDATE-STATUS-SAVE.
  1384             20  PI-UPDATE-BY            PIC X(4).
  1385             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1386
  1387         16  PI-LOWER-CASE-LETTERS       PIC X.
  1388             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1389
  1390*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1391*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1392*            88  CARRIER-CLM-CNTL            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  27
* EL690.cbl
  1393
  1394         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1395             88  ST-ACCNT-CNTL               VALUE ' '.
  1396             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1397             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1398             88  ACCNT-CNTL                  VALUE '3'.
  1399             88  CARR-ACCNT-CNTL             VALUE '4'.
  1400
  1401         16  PI-PROCESSOR-CAP-LIST.
  1402             20  PI-SYSTEM-CONTROLS.
  1403                24 PI-SYSTEM-DISPLAY     PIC X.
  1404                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1405                24 PI-SYSTEM-MODIFY      PIC X.
  1406                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1407             20  FILLER                  PIC XX.
  1408             20  PI-DISPLAY-CAP          PIC X.
  1409                 88  DISPLAY-CAP             VALUE 'Y'.
  1410             20  PI-MODIFY-CAP           PIC X.
  1411                 88  MODIFY-CAP              VALUE 'Y'.
  1412             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1413                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1414             20  PI-FORCE-CAP            PIC X.
  1415                 88  FORCE-CAP               VALUE 'Y'.
  1416
  1417         16  PI-PROGRAM-CONTROLS.
  1418             20  PI-PGM-PRINT-OPT        PIC X.
  1419             20  PI-PGM-FORMAT-OPT       PIC X.
  1420             20  PI-PGM-PROCESS-OPT      PIC X.
  1421             20  PI-PGM-TOTALS-OPT       PIC X.
  1422
  1423         16  PI-HELP-INTERFACE.
  1424             20  PI-LAST-ERROR-NO        PIC X(4).
  1425             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1426
  1427         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1428             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1429
  1430         16  PI-CR-CONTROL-IN-PROGRESS.
  1431             20  PI-CR-CARRIER           PIC X.
  1432             20  PI-CR-GROUPING          PIC X(6).
  1433             20  PI-CR-STATE             PIC XX.
  1434             20  PI-CR-ACCOUNT           PIC X(10).
  1435             20  PI-CR-FIN-RESP          PIC X(10).
  1436             20  PI-CR-TYPE              PIC X.
  1437
  1438         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1439
  1440         16  PI-CR-MONTH-END-DT          PIC XX.
  1441
  1442         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1443             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1444             88  PI-ZERO-CARRIER             VALUE '1'.
  1445             88  PI-ZERO-GROUPING            VALUE '2'.
  1446             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1447
  1448         16  PI-CARRIER-SECURITY         PIC X.
  1449             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1450
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  28
* EL690.cbl
  1451         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1452             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1453             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1454
  1455         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1456             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1457                                         INDEXED BY PI-ACCESS-NDX
  1458                                         PIC X.
  1459
  1460         16  PI-GA-BILLING-CONTROL       PIC X.
  1461             88  PI-GA-BILLING               VALUE '1'.
  1462
  1463         16  PI-MAIL-PROCESSING          PIC X.
  1464             88  PI-MAIL-YES                 VALUE 'Y'.
  1465
  1466         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1467
  1468         16  PI-AR-SYSTEM.
  1469             20  PI-AR-PROCESSING-CNTL   PIC X.
  1470                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1471             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1472             20  PI-AR-MONTH-END-DT      PIC XX.
  1473
  1474         16  PI-MP-SYSTEM.
  1475             20  PI-MORTGAGE-USER            PIC X.
  1476                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1477                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1478             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1479                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1480                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1481                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1482                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1483                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1484             20  PI-MP-MONTH-END-DT          PIC XX.
  1485             20  PI-MP-REFERENCE-NO.
  1486                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1487                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1488
  1489         16  PI-LABEL-CONTROL            PIC X(01).
  1490             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1491             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1492
  1493         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1494             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1495
  1496         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1497             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1498             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1499
  1500         16  FILLER                      PIC X(14).
  1501
  1502     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1503******************************************************************
  1504     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1505*    COPY ELC1042.
  1506******************************************************************
  1507*                                                                *
  1508*                                                                *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  29
* EL690.cbl
  1509*                           ELC1042                              *
  1510*                            VMOD=2.002                          *
  1511*                                                                *
  1512*    NOTE                                                        *
  1513*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1514*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1515*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1516*        TO THESE PROGRAMS.                                      *
  1517*                                                                *
  1518*    NOTE                                                        *
  1519*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1520*        USE ONLY!                                               *
  1521*                                                                *
  1522******************************************************************
  1523
  1524         16  PI-1042-WA.
  1525             20  PI-ACTION       PIC  X(01).
  1526                 88 PI-SHOW-MODE           VALUE '1'.
  1527                 88 PI-CLEAR-MODE          VALUE '2'.
  1528                 88 PI-CREATE-MODE         VALUE '3'.
  1529             20  PI-COMM-CONTROL PIC  X(12).
  1530             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1531             20  PI-EOF-SW       PIC  X(01).
  1532                 88  PI-FILE-EOF           VALUE 'Y'.
  1533             20  PI-FILETYP      PIC  X(01).
  1534             20  PI-FORM-SQUEEZE-CONTROL
  1535                                 PIC  X(01).
  1536                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1537                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1538             20  PI-LAST-CONTROL PIC  X(12).
  1539             20  PI-TEMP-STOR-ITEMS
  1540                                 PIC S9(04) COMP.
  1541             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1542             20  PI-UPDATE-SW    PIC  9(01).
  1543                 88 ANY-UPDATES            VALUE 1.
  1544             20  PI-104-SCREEN-SENT-IND
  1545                                 PIC  X(01).
  1546                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1547                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1548             20  PI-1042-SCREEN-SENT-IND
  1549                                 PIC  X(01).
  1550                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1551                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1552             20  PI-1042-ARCHIVE-IND
  1553                                 PIC  X(01).
  1554                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1555             20  FILLER          PIC  X(29).
  1556*    COPY ELC689PI.
  1557******************************************************************
  1558*                                                                *
  1559*                            ELC689PI                            *
  1560*                            VMOD=2.003                          *
  1561*                                                                *
  1562*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1563*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  1564*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1565*                                                                *
  1566*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  30
* EL690.cbl
  1567*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  1568*    BETWEEN PROGRAMS.                                           *
  1569*                                                                *
  1570*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1571*                                                                *
  1572*               EL631 - EL689  - EL6891 - EL6892                 *
  1573*                                                                *
  1574******************************************************************
  1575*                   C H A N G E   L O G
  1576*
  1577* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1578*-----------------------------------------------------------------
  1579*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1580* EFFECTIVE    NUMBER
  1581*-----------------------------------------------------------------
  1582* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  1583* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  1584* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1585******************************************************************
  1586
  1587
  1588         16  PI-689-WORK-AREA.
  1589             20  PI-689-ALT-PRINTER-ID
  1590                                 PIC  X(04).
  1591             20  PI-689-ARCHIVE-NUMBER
  1592                                 PIC  9(08).
  1593             20  PI-689-ARCHIVE-SW
  1594                                 PIC  X(01).
  1595                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  1596             20  PI-689-DATA-SOURCE
  1597                                 PIC  X(01).
  1598                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  1599                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  1600                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  1601                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  1602                 88  PI-689-SRC-CHECKS         VALUE '5'.
  1603             20  PI-689-ERROR-IND
  1604                                 PIC  X(01).
  1605                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  1606             20  PI-689-ERROR    PIC  9(04).
  1607                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  1608                 88  PI-689-FATAL-ERROR
  1609                     VALUES 0004 0006 0008 0013 0023 0029 0033
  1610                            0042 0047 0051 0066 0067 0070
  1611                            0168 0169 0174 0175 0176 0177 0179
  1612                            0180 0181 0182 0184 0185 0189 0190
  1613                            0191
  1614                            0215 0279 0280
  1615                            0412 0413 0454
  1616                            0533 0537
  1617                            2055 2114 2208 2209 2216 2232 2369
  1618                            2398 2433 2908 2999
  1619                            3000 3770 3771 3775
  1620                            7250 7365 7367 7368 7369 7370 7371
  1621                            7272 7373 7374 7376 7377 7378 7379
  1622                            7381 7388 7390 7393 7395 7396 7398
  1623                            9095 9096 9281 9298 9299 9320 9327
  1624                            9426 9427.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  31
* EL690.cbl
  1625                 88  PI-689-STOP-ERROR
  1626                     VALUES 0004 0008 0013 0023 0029 0033
  1627                            0042 0047 0066 0067 0070
  1628                            0168 0169 0174 0175 0176 0177
  1629                            0181 0182 0184 0185 0189 0190
  1630                            0279 0280
  1631                            0412 0413 0454
  1632                            2055 2208 2209 2216 2232
  1633                            2398 2999
  1634                            3000 3770 3771 3775
  1635                            7250 7365 7369 7370 7371
  1636                            7272 7373 7374 7376 7377 7378 7379
  1637                            7381 7388 7390 7393 7396 7398
  1638                            9095 9096 9299 9320 9426.
  1639             20  PI-689-FOLLOW-UP-DATE
  1640                                 PIC  X(02).
  1641             20  PI-689-FORM-NUMBER
  1642                                 PIC  X(04).
  1643             20  PI-689-LABEL-SOURCE
  1644                                 PIC X(01).
  1645                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1646                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1647                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1648                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1649                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1650                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1651                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1652             20  PI-689-NUMBER-COPIES
  1653                                 PIC  9(01).
  1654             20  PI-689-NUMBER-LABEL-LINES
  1655                                 PIC  9(01).
  1656             20  PI-689-NUMBER-TEXT-RECORDS
  1657                                 PIC  9(03).
  1658             20  PI-689-PRINT-ORDER-SW
  1659                                 PIC  X(01).
  1660                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1661                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1662                 88  PI-689-PRINT-LATER     VALUE '3'.
  1663                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1664             20  PI-689-PRINT-RESTRICTION
  1665                                 PIC  X(01).
  1666                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1667                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1668                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1669             20  PI-689-PRINT-SW PIC  X(01).
  1670                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1671             20  PI-689-RESEND-DATE-1
  1672                                 PIC  X(02).
  1673             20  PI-689-RESEND-LETR-1
  1674                                 PIC X(4).
  1675             20  PI-689-TEMP-STOR-ID
  1676                                 PIC  X(08).
  1677             20  PI-689-USE-SCREEN-IND
  1678                                 PIC  X(01).
  1679                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1680             20  PI-689-ARCH-POINTER
  1681                                 PIC S9(08) COMP.
  1682                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  32
* EL690.cbl
  1683             20  PI-689-ARCT-POINTER
  1684                                 PIC S9(08) COMP.
  1685                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1686             20  PI-689-VARIABLE-DATA-GRP.
  1687                 24  PI-689-VARIABLE-DATA-1
  1688                                 PIC  X(30).
  1689                 24  PI-689-VARIABLE-DATA-2
  1690                                 PIC  X(30).
  1691                 24  PI-689-VARIABLE-DATA-3
  1692                                 PIC  X(30).
  1693                 24  PI-689-VARIABLE-DATA-4
  1694                                 PIC  X(30).
  1695
  1696         16  PI-689-KEY-DATA-FIELDS.
  1697             20  PI-689-ACCOUNT  PIC  X(10).
  1698             20  PI-689-CARRIER  PIC  X(01).
  1699             20  PI-689-CERT-NO.
  1700                 24  PI-689-CERT-PRIME
  1701                                 PIC  X(10).
  1702                 24  PI-689-CERT-SFX
  1703                                 PIC  X(01).
  1704             20  PI-689-CHG-SEQ-NO
  1705                                 PIC S9(04)    COMP.
  1706             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1707                                 PIC  X(02).
  1708             20  PI-689-ENTRY-BATCH
  1709                                 PIC  X(06).
  1710             20  PI-689-EFF-DATE PIC  X(02).
  1711             20  PI-689-EXP-DATE PIC  X(02).
  1712             20  PI-689-GROUPING PIC  X(06).
  1713             20  PI-689-RESP-PERSON
  1714                                 PIC  X(10).
  1715             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1716             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1717                                 PIC  X(04).
  1718             20  PI-689-STATE    PIC  X(02).
  1719             20  PI-689-TYPE     PIC  X(01).
  1720             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1721             20  PI-689-ALT-SEQ-NO
  1722                                 PIC S9(04)    COMP.
  1723         16  PI-689-DATE-EDIT    PIC  X(08).
  1724         16  PI-689-FOLLOW-UP-EDIT
  1725                                 PIC  X(08).
  1726         16  PI-689-RESEND1-EDIT PIC  X(08).
  1727         16  PI-689-SEQ-EDIT     PIC  X(08).
  1728         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1729         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1730             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1731         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1732         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1733         16  PI-690-WORK-AREA.
  1734             20  PI-690-ARCHIVE-TABLE.
  1735                 24  PI-690-ARCHIVE-NUM OCCURS 12 TIMES
  1736                                 PIC S9(08) COMP.
  1737             20  PI-690-CURSOR   PIC S9(04) COMP.
  1738             20  PI-690-FIRST-DATA.
  1739                 24  PI-690-FIRST-CERT-NO.
  1740                     28  PI-690-FIRST-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  33
* EL690.cbl
  1741                                 PIC  X(10).
  1742                     28  PI-690-FIRST-SUFFIX
  1743                                 PIC  X(01).
  1744                 24  PI-690-FIRST-CARRIER
  1745                                 PIC  X(01).
  1746                 24  PI-690-FIRST-GROUPING
  1747                                 PIC  X(06).
  1748                 24  PI-690-FIRST-STATE
  1749                                 PIC  X(02).
  1750                 24  PI-690-FIRST-ACCOUNT
  1751                                 PIC  X(10).
  1752                 24  PI-690-FIRST-EFFECT-DATE
  1753                                 PIC  X(02).
  1754                 24  PI-690-FIRST-ENTRY.
  1755                     28  PI-690-FIRST-CONTROL-PREFIX
  1756                                 PIC  X(02).
  1757                     28  PI-690-FIRST-CONTROL
  1758                                 PIC S9(08) COMP.
  1759                 24  PI-690-FIRST-FORM
  1760                                 PIC  X(04).
  1761                 24  PI-690-FIRST-PROCESSOR
  1762                                 PIC  X(04).
  1763                 24  PI-690-FIRST-ARCHIVE-NO
  1764                                 PIC S9(08) COMP.
  1765             20  PI-690-INIT-DATA.
  1766                 24  PI-690-INIT-CERT-NO.
  1767                     28  PI-690-INIT-CERT-PRIME
  1768                                 PIC  X(10).
  1769                     28  PI-690-INIT-SUFFIX
  1770                                 PIC  X(01).
  1771                 24  PI-690-INIT-CARRIER
  1772                                 PIC  X(01).
  1773                 24  PI-690-INIT-GROUPING
  1774                                 PIC  X(06).
  1775                 24  PI-690-INIT-STATE
  1776                                 PIC  X(02).
  1777                 24  PI-690-INIT-ACCOUNT
  1778                                 PIC  X(10).
  1779                 24  PI-690-INIT-EFFECT-DATE
  1780                                 PIC  X(02).
  1781                 24  PI-690-INIT-EFF-DTE
  1782                                 PIC  X(08).
  1783                 24  PI-690-INIT-ENTRY.
  1784                     28  PI-690-INIT-CONTROL-PREFIX
  1785                                 PIC  X(02).
  1786                     28  PI-690-INIT-CONTROL
  1787                                 PIC S9(08) COMP.
  1788                 24  PI-690-INIT-FORM
  1789                                 PIC  X(04).
  1790                 24  PI-690-INIT-PROCESSOR
  1791                                 PIC  X(04).
  1792                 24  PI-690-INIT-ARCHIVE-NO
  1793                                 PIC S9(08) COMP.
  1794             20  PI-690-LAST-DATA.
  1795                 24  PI-690-LAST-CERT-NO.
  1796                     28  PI-690-LAST-CERT-PRIME
  1797                                 PIC  X(10).
  1798                     28  PI-690-LAST-SUFFIX
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  34
* EL690.cbl
  1799                                 PIC  X(01).
  1800                 24  PI-690-LAST-CARRIER
  1801                                 PIC  X(01).
  1802                 24  PI-690-LAST-GROUPING
  1803                                 PIC  X(06).
  1804                 24  PI-690-LAST-STATE
  1805                                 PIC  X(02).
  1806                 24  PI-690-LAST-ACCOUNT
  1807                                 PIC  X(10).
  1808                 24  PI-690-LAST-EFFECT-DATE
  1809                                 PIC  X(02).
  1810                 24  PI-690-LAST-ENTRY.
  1811                     28  PI-690-LAST-CONTROL-PREFIX
  1812                                 PIC  X(02).
  1813                     28  PI-690-LAST-CONTROL
  1814                                 PIC S9(08) COMP.
  1815                 24  PI-690-LAST-FORM
  1816                                 PIC  X(04).
  1817                 24  PI-690-LAST-PROCESSOR
  1818                                 PIC  X(04).
  1819                 24  PI-690-LAST-ARCHIVE-NO
  1820                                 PIC S9(08) COMP.
  1821             20  PI-690-LAST-ARCH-NDX
  1822                                 PIC S9(04) COMP.
  1823             20  PI-690-BRWS-TYPE-IND
  1824                                 PIC  9(01).
  1825                 88  PI-690-BRWS-CERTRP               VALUE 1.
  1826                 88  PI-690-BRWS-FORM                 VALUE 2.
  1827                 88  PI-690-BRWS-PROCESSOR            VALUE 3.
  1828                 88  PI-690-BRWS-ACCOUNT              VALUE 4.
  1829                 88  PI-690-BRWS-ENTRY-CNTL           VALUE 5.
  1830                 88  PI-690-BRWS-ARCHIVE              VALUE 6.
  1831             20  PI-690-LAST-BROWSE-IND
  1832                                 PIC  X(01).
  1833                 88  PI-690-LAST-BRWS-FWRD            VALUE '1'.
  1834                 88  PI-690-LAST-BRWS-BWRD            VALUE '2'.
  1835             20  PI-690-STATUS-SELECTION-IND
  1836                                 PIC  X(01).
  1837                 88  PI-690-SELECT-ALL       VALUE 'N'.
  1838                 88  PI-690-VALID-SELECTION  VALUE 'A' 'C' 'H'
  1839                                               'X' 'P' 'V' 'N'.
  1840         16  FILLER              PIC X(67).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  35
* EL690.cbl
  1842 01  FILLER                      PIC  X(19)
  1843                                 VALUE ':END INTERFACE AREA'.
  1844
  1845 01  ERROR-MESSAGES.
  1846     12  ER-0000                 PIC  X(04)  VALUE '0000'.
  1847     12  ER-0004                 PIC  X(04)  VALUE '0004'.
  1848     12  ER-0023                 PIC  X(04)  VALUE '0023'.
  1849     12  ER-0029                 PIC  X(04)  VALUE '0029'.
  1850     12  ER-0050                 PIC  X(04)  VALUE '0050'.
  1851     12  ER-0068                 PIC  X(04)  VALUE '0068'.
  1852     12  ER-0074                 PIC  X(04)  VALUE '0074'.
  1853     12  ER-0085                 PIC  X(04)  VALUE '0085'.
  1854     12  ER-0130                 PIC  X(04)  VALUE '0130'.
  1855     12  ER-0131                 PIC  X(04)  VALUE '0131'.
  1856     12  ER-0185                 PIC  X(04)  VALUE '0185'.
  1857     12  ER-0190                 PIC  X(04)  VALUE '0190'.
  1858     12  ER-0314                 PIC  X(04)  VALUE '0314'.
  1859     12  ER-7008                 PIC  X(04)  VALUE '7008'.
  1860     12  ER-7244                 PIC  X(04)  VALUE '7244'.
  1861     12  ER-7357                 PIC  X(04)  VALUE '7357'.
  1862     12  ER-7358                 PIC  X(04)  VALUE '7358'.
  1863     12  ER-7359                 PIC  X(04)  VALUE '7359'.
  1864     12  ER-7360                 PIC  X(04)  VALUE '7360'.
  1865     12  ER-7361                 PIC  X(04)  VALUE '7361'.
  1866     12  ER-7362                 PIC  X(04)  VALUE '7362'.
  1867     12  ER-7366                 PIC  X(04)  VALUE '7366'.
  1868     12  ER-7384                 PIC  X(04)  VALUE '7384'.
  1869     12  ER-7385                 PIC  X(04)  VALUE '7385'.
  1870     12  ER-7386                 PIC  X(04)  VALUE '7386'.
  1871     12  ER-7387                 PIC  X(04)  VALUE '7387'.
  1872     12  ER-7388                 PIC  X(04)  VALUE '7388'.
  1873*    12  ER-7394                 PIC  X(04)  VALUE '7394'.
  1874     12  ER-7396                 PIC  X(04)  VALUE '7396'.
  1875     12  ER-7397                 PIC  X(04)  VALUE '7397'.
  1876     12  ER-7399                 PIC  X(04)  VALUE '7399'.
  1877     12  ER-9007                 PIC  X(04)  VALUE '9007'.
  1878     12  ER-9008                 PIC  X(04)  VALUE '9008'.
  1879     12  ER-9009                 PIC  X(04)  VALUE '9009'.
  1880     12  ER-9010                 PIC  X(04)  VALUE '9010'.
  1881     12  ER-9011                 PIC  X(04)  VALUE '9011'.
  1882     12  ER-9012                 PIC  X(04)  VALUE '9012'.
  1883     12  ER-9015                 PIC  X(04)  VALUE '9015'.
  1884     12  ER-9016                 PIC  X(04)  VALUE '9016'.
  1885     12  ER-9017                 PIC  X(04)  VALUE '9017'.
  1886     12  ER-9042                 PIC  X(04)  VALUE '9042'.
  1887     12  ER-9080                 PIC  X(04)  VALUE '9080'.
  1888     12  ER-9096                 PIC  X(04)  VALUE '9096'.
  1889     12  ER-9097                 PIC  X(04)  VALUE '9097'.
  1890     12  ER-9129                 PIC  X(04)  VALUE '9129'.
  1891     12  ER-9150                 PIC  X(04)  VALUE '9150'.
  1892     12  ER-9196                 PIC  X(04)  VALUE '9196'.
  1893     12  ER-9245                 PIC  X(04)  VALUE '9245'.
  1894     12  ER-9281                 PIC  X(04)  VALUE '9281'.
  1895     12  ER-9282                 PIC  X(04)  VALUE '9282'.
  1896     12  ER-9293                 PIC  X(04)  VALUE '9293'.
  1897     12  ER-9308                 PIC  X(04)  VALUE '9308'.
  1898     12  ER-9310                 PIC  X(04)  VALUE '9310'.
  1899     12  ER-9312                 PIC  X(04)  VALUE '9312'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  36
* EL690.cbl
  1900     12  ER-9323                 PIC  X(04)  VALUE '9323'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  37
* EL690.cbl
  1902*    COPY ELCAID REPLACING '01 DFHAID.' BY '01  DFHAID.'.
  1903******************************************************************
  1904*                                                                *
  1905*                            ELCAID.                             *
  1906*                            VMOD=2.001                          *
  1907*                                                                *
  1908*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1909*                                                                *
  1910*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1911*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1912******************************************************************
  1913
  1914 01  DFHAID.
  1915   02  DFHNULL   PIC  X  VALUE  ' '.
  1916   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1917   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1918   02  DFHPEN    PIC  X  VALUE  '='.
  1919   02  DFHOPID   PIC  X  VALUE  'W'.
  1920   02  DFHPA1    PIC  X  VALUE  '%'.
  1921   02  DFHPA2    PIC  X  VALUE  '>'.
  1922   02  DFHPA3    PIC  X  VALUE  ','.
  1923   02  DFHPF1    PIC  X  VALUE  '1'.
  1924   02  DFHPF2    PIC  X  VALUE  '2'.
  1925   02  DFHPF3    PIC  X  VALUE  '3'.
  1926   02  DFHPF4    PIC  X  VALUE  '4'.
  1927   02  DFHPF5    PIC  X  VALUE  '5'.
  1928   02  DFHPF6    PIC  X  VALUE  '6'.
  1929   02  DFHPF7    PIC  X  VALUE  '7'.
  1930   02  DFHPF8    PIC  X  VALUE  '8'.
  1931   02  DFHPF9    PIC  X  VALUE  '9'.
  1932   02  DFHPF10   PIC  X  VALUE  ':'.
  1933   02  DFHPF11   PIC  X  VALUE  '#'.
  1934   02  DFHPF12   PIC  X  VALUE  '@'.
  1935   02  DFHPF13   PIC  X  VALUE  'A'.
  1936   02  DFHPF14   PIC  X  VALUE  'B'.
  1937   02  DFHPF15   PIC  X  VALUE  'C'.
  1938   02  DFHPF16   PIC  X  VALUE  'D'.
  1939   02  DFHPF17   PIC  X  VALUE  'E'.
  1940   02  DFHPF18   PIC  X  VALUE  'F'.
  1941   02  DFHPF19   PIC  X  VALUE  'G'.
  1942   02  DFHPF20   PIC  X  VALUE  'H'.
  1943   02  DFHPF21   PIC  X  VALUE  'I'.
  1944*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1945   02  DFHPF22   PIC  X  VALUE  '['.
  1946   02  DFHPF23   PIC  X  VALUE  '.'.
  1947   02  DFHPF24   PIC  X  VALUE  '<'.
  1948   02  DFHMSRE   PIC  X  VALUE  'X'.
  1949   02  DFHSTRF   PIC  X  VALUE  'h'.
  1950   02  DFHTRIG   PIC  X  VALUE  '"'.
  1951 01  FILLER  REDEFINES  DFHAID.
  1952     12  FILLER                  PIC  X(08).
  1953     12  PF-VALUES               PIC  X(01)  OCCURS 2.
  1954
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  38
* EL690.cbl
  1956*    COPY ELCATTR.
  1957******************************************************************
  1958*                                                                *
  1959*                            ELCATTR.                            *
  1960*                            VMOD=2.001                          *
  1961*                                                                *
  1962*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1963*                                                                *
  1964*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1965*                                                                *
  1966*                   POS 1   P=PROTECTED                          *
  1967*                           U=UNPROTECTED                        *
  1968*                           S=ASKIP                              *
  1969*                   POS 2   A=ALPHA/NUMERIC                      *
  1970*                           N=NUMERIC                            *
  1971*                   POS 3   N=NORMAL                             *
  1972*                           B=BRIGHT                             *
  1973*                           D=DARK                               *
  1974*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1975*                           OF=MODIFIED DATA TAG OFF             *
  1976*                                                                *
  1977*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1978******************************************************************
  1979 01  ATTRIBUTE-LIST.
  1980     12  AL-PABOF            PIC X       VALUE 'Y'.
  1981     12  AL-PABON            PIC X       VALUE 'Z'.
  1982     12  AL-PADOF            PIC X       VALUE '%'.
  1983     12  AL-PADON            PIC X       VALUE '_'.
  1984     12  AL-PANOF            PIC X       VALUE '-'.
  1985     12  AL-PANON            PIC X       VALUE '/'.
  1986     12  AL-SABOF            PIC X       VALUE '8'.
  1987     12  AL-SABON            PIC X       VALUE '9'.
  1988     12  AL-SADOF            PIC X       VALUE '@'.
  1989     12  AL-SADON            PIC X       VALUE QUOTE.
  1990     12  AL-SANOF            PIC X       VALUE '0'.
  1991     12  AL-SANON            PIC X       VALUE '1'.
  1992     12  AL-UABOF            PIC X       VALUE 'H'.
  1993     12  AL-UABON            PIC X       VALUE 'I'.
  1994     12  AL-UADOF            PIC X       VALUE '<'.
  1995     12  AL-UADON            PIC X       VALUE '('.
  1996     12  AL-UANOF            PIC X       VALUE ' '.
  1997     12  AL-UANON            PIC X       VALUE 'A'.
  1998     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1999     12  AL-UNBON            PIC X       VALUE 'R'.
  2000     12  AL-UNDOF            PIC X       VALUE '*'.
  2001     12  AL-UNDON            PIC X       VALUE ')'.
  2002     12  AL-UNNOF            PIC X       VALUE '&'.
  2003     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  39
* EL690.cbl
  2005*    COPY ELCDATE.
  2006******************************************************************
  2007*                                                                *
  2008*                                                                *
  2009*                            ELCDATE.                            *
  2010*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2011*                            VMOD=2.003
  2012*                                                                *
  2013*                                                                *
  2014*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2015*                 LENGTH = 200                                   *
  2016******************************************************************
  2017
  2018 01  DATE-CONVERSION-DATA.
  2019     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2020     12  DC-OPTION-CODE                PIC X.
  2021         88  BIN-TO-GREG                VALUE ' '.
  2022         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2023         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2024         88  YMD-GREG-TO-BIN            VALUE '3'.
  2025         88  MDY-GREG-TO-BIN            VALUE '4'.
  2026         88  JULIAN-TO-BIN              VALUE '5'.
  2027         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2028         88  FIND-CENTURY               VALUE '7'.
  2029         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2030         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2031         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2032         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2033         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2034         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2035         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2036         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2037         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2038         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2039         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2040         88  BIN-3-TO-GREG              VALUE 'I'.
  2041         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2042         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2043         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2044         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2045         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2046         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2047         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2048         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2049         88  THREE-CHARACTER-BIN
  2050                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2051         88  GREGORIAN-TO-BIN
  2052                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2053         88  BIN-TO-GREGORIAN
  2054                  VALUES ' ' '1' 'I' '8' 'G'.
  2055         88  JULIAN-TO-BINARY
  2056                  VALUES '5' 'C' 'E' 'F'.
  2057     12  DC-ERROR-CODE                 PIC X.
  2058         88  NO-CONVERSION-ERROR        VALUE ' '.
  2059         88  DATE-CONVERSION-ERROR
  2060                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2061         88  DATE-IS-ZERO               VALUE '1'.
  2062         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  40
* EL690.cbl
  2063         88  DATE-IS-INVALID            VALUE '3'.
  2064         88  DATE1-GREATER-DATE2        VALUE '4'.
  2065         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2066         88  DATE-INVALID-OPTION        VALUE '9'.
  2067         88  INVALID-CENTURY            VALUE 'A'.
  2068         88  ONLY-CENTURY               VALUE 'B'.
  2069         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2070         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2071     12  DC-END-OF-MONTH               PIC X.
  2072         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2073     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2074         88  USE-NORMAL-PROCESS         VALUE ' '.
  2075         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2076         88  ADJUST-UP-100-YRS          VALUE '2'.
  2077     12  FILLER                        PIC X.
  2078     12  DC-CONVERSION-DATES.
  2079         16  DC-BIN-DATE-1             PIC XX.
  2080         16  DC-BIN-DATE-2             PIC XX.
  2081         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2082         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2083                       DC-GREG-DATE-1-EDIT.
  2084             20  DC-EDIT1-MONTH        PIC 99.
  2085             20  SLASH1-1              PIC X.
  2086             20  DC-EDIT1-DAY          PIC 99.
  2087             20  SLASH1-2              PIC X.
  2088             20  DC-EDIT1-YEAR         PIC 99.
  2089         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2090         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2091                     DC-GREG-DATE-2-EDIT.
  2092             20  DC-EDIT2-MONTH        PIC 99.
  2093             20  SLASH2-1              PIC X.
  2094             20  DC-EDIT2-DAY          PIC 99.
  2095             20  SLASH2-2              PIC X.
  2096             20  DC-EDIT2-YEAR         PIC 99.
  2097         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2098         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2099                     DC-GREG-DATE-1-YMD.
  2100             20  DC-YMD-YEAR           PIC 99.
  2101             20  DC-YMD-MONTH          PIC 99.
  2102             20  DC-YMD-DAY            PIC 99.
  2103         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2104         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2105                      DC-GREG-DATE-1-MDY.
  2106             20  DC-MDY-MONTH          PIC 99.
  2107             20  DC-MDY-DAY            PIC 99.
  2108             20  DC-MDY-YEAR           PIC 99.
  2109         16  DC-GREG-DATE-1-ALPHA.
  2110             20  DC-ALPHA-MONTH        PIC X(10).
  2111             20  DC-ALPHA-DAY          PIC 99.
  2112             20  FILLER                PIC XX.
  2113             20  DC-ALPHA-CENTURY.
  2114                 24 DC-ALPHA-CEN-N     PIC 99.
  2115             20  DC-ALPHA-YEAR         PIC 99.
  2116         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2117         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2118         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2119         16  DC-JULIAN-DATE            PIC 9(05).
  2120         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  41
* EL690.cbl
  2121                                       PIC 9(05).
  2122         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2123             20  DC-JULIAN-YEAR        PIC 99.
  2124             20  DC-JULIAN-DAYS        PIC 999.
  2125         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2126         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2127         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2128     12  DATE-CONVERSION-VARIBLES.
  2129         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2130         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2131             20  FILLER                PIC 9(3).
  2132             20  HOLD-CEN-1-CCYY.
  2133                 24  HOLD-CEN-1-CC     PIC 99.
  2134                 24  HOLD-CEN-1-YY     PIC 99.
  2135             20  HOLD-CEN-1-MO         PIC 99.
  2136             20  HOLD-CEN-1-DA         PIC 99.
  2137         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2138             20  HOLD-CEN-1-R-MO       PIC 99.
  2139             20  HOLD-CEN-1-R-DA       PIC 99.
  2140             20  HOLD-CEN-1-R-CCYY.
  2141                 24  HOLD-CEN-1-R-CC   PIC 99.
  2142                 24  HOLD-CEN-1-R-YY   PIC 99.
  2143             20  FILLER                PIC 9(3).
  2144         16  HOLD-CENTURY-1-X.
  2145             20  FILLER                PIC X(3)  VALUE SPACES.
  2146             20  HOLD-CEN-1-X-CCYY.
  2147                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2148                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2149             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2150             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2151         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2152             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2153             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2154             20  HOLD-CEN-1-R-X-CCYY.
  2155                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2156                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2157             20  FILLER                PIC XXX.
  2158         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2159         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2160         16  DC-JULIAN-DATE-1          PIC 9(07).
  2161         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2162             20  DC-JULIAN-1-CCYY.
  2163                 24  DC-JULIAN-1-CC    PIC 99.
  2164                 24  DC-JULIAN-1-YR    PIC 99.
  2165             20  DC-JULIAN-DA-1        PIC 999.
  2166         16  DC-JULIAN-DATE-2          PIC 9(07).
  2167         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2168             20  DC-JULIAN-2-CCYY.
  2169                 24  DC-JULIAN-2-CC    PIC 99.
  2170                 24  DC-JULIAN-2-YR    PIC 99.
  2171             20  DC-JULIAN-DA-2        PIC 999.
  2172         16  DC-GREG-DATE-A-EDIT.
  2173             20  DC-EDITA-MONTH        PIC 99.
  2174             20  SLASHA-1              PIC X VALUE '/'.
  2175             20  DC-EDITA-DAY          PIC 99.
  2176             20  SLASHA-2              PIC X VALUE '/'.
  2177             20  DC-EDITA-CCYY.
  2178                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  42
* EL690.cbl
  2179                 24  DC-EDITA-YEAR     PIC 99.
  2180         16  DC-GREG-DATE-B-EDIT.
  2181             20  DC-EDITB-MONTH        PIC 99.
  2182             20  SLASHB-1              PIC X VALUE '/'.
  2183             20  DC-EDITB-DAY          PIC 99.
  2184             20  SLASHB-2              PIC X VALUE '/'.
  2185             20  DC-EDITB-CCYY.
  2186                 24  DC-EDITB-CENT     PIC 99.
  2187                 24  DC-EDITB-YEAR     PIC 99.
  2188         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2189         16  DC-GREG-DATE-CYMD-R REDEFINES
  2190                              DC-GREG-DATE-CYMD.
  2191             20  DC-CYMD-CEN           PIC 99.
  2192             20  DC-CYMD-YEAR          PIC 99.
  2193             20  DC-CYMD-MONTH         PIC 99.
  2194             20  DC-CYMD-DAY           PIC 99.
  2195         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2196         16  DC-GREG-DATE-MDCY-R REDEFINES
  2197                              DC-GREG-DATE-MDCY.
  2198             20  DC-MDCY-MONTH         PIC 99.
  2199             20  DC-MDCY-DAY           PIC 99.
  2200             20  DC-MDCY-CEN           PIC 99.
  2201             20  DC-MDCY-YEAR          PIC 99.
  2202    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2203        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2204    12  DC-EL310-DATE                  PIC X(21).
  2205    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  43
* EL690.cbl
  2207*    COPY ELCEMIB.
  2208******************************************************************
  2209*                                                                *
  2210*                                                                *
  2211*                            ELCEMIB.                            *
  2212*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2213*                            VMOD=2.005                          *
  2214*                                                                *
  2215*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2216*                                                                *
  2217******************************************************************
  2218 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2219     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2220     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2221     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2222     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2223     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2224     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2225     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2226     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2227     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2228         88  EMI-NO-ERRORS                    VALUE '1'.
  2229         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2230         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2231     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2232         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2233     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2234         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2235         88  EMI-AREA1-FULL                   VALUE '2'.
  2236     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2237         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2238         88  EMI-AREA2-FULL                   VALUE '2'.
  2239     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2240         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2241         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2242         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2243         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2244         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2245     12  EMI-ERROR-LINES.
  2246         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2247         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2248         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2249         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2250             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2251                 24  EMI-ERR-NUM         PIC X(4).
  2252                 24  EMI-FILLER          PIC X.
  2253                 24  EMI-SEV             PIC X.
  2254                 24  FILLER              PIC X.
  2255             20  FILLER                  PIC X(02).
  2256     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2257         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2258             20  EMI-ERROR-NUMBER    PIC X(4).
  2259             20  EMI-FILL            PIC X.
  2260             20  EMI-SEVERITY        PIC X.
  2261             20  FILLER              PIC X.
  2262             20  EMI-ERROR-TEXT.
  2263                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2264                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  44
* EL690.cbl
  2265     12  EMI-SEVERITY-SAVE           PIC X.
  2266         88  EMI-NOTE                    VALUE 'N'.
  2267         88  EMI-WARNING                 VALUE 'W'.
  2268         88  EMI-FORCABLE                VALUE 'F'.
  2269         88  EMI-FATAL                   VALUE 'X'.
  2270     12  EMI-MESSAGE-FLAG            PIC X.
  2271         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2272         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2273     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2274     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2275         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2276         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2277         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2278     12  FILLER                      PIC X(137)  VALUE SPACES.
  2279     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2280     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2281     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2282     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  45
* EL690.cbl
  2284*    COPY ELCLOGOF.
  2285******************************************************************
  2286*                                                                *
  2287*                                                                *
  2288*                            ELCLOGOF.                           *
  2289*                            VMOD=2.001                          *
  2290*                                                                *
  2291*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2292*                                                                *
  2293******************************************************************
  2294 01  CLASIC-LOGOFF.
  2295     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2296     12  LOGOFF-TEXT.
  2297         16  FILLER          PIC X(5)    VALUE SPACES.
  2298         16  LOGOFF-MSG.
  2299             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2300             20  FILLER      PIC X       VALUE SPACES.
  2301             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2302         16  FILLER          PIC X(80)
  2303           VALUE '* YOU ARE NOW LOGGED OFF'.
  2304         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2305         16  FILLER          PIC X       VALUE QUOTE.
  2306         16  LOGOFF-SYS-MSG  PIC X(17)
  2307           VALUE 'S CLAS-IC SYSTEM '.
  2308     12  TEXT-MESSAGES.
  2309         16  UNACCESS-MSG    PIC X(29)
  2310             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2311         16  PGMIDERR-MSG    PIC X(17)
  2312             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  46
* EL690.cbl
  2314*    COPY ELCSCTM.
  2315******************************************************************
  2316*                                                                *
  2317*                                                                *
  2318*                            ELCSCTM                             *
  2319*                            VMOD=2.001                          *
  2320*                                                                *
  2321*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  2322*                                                                *
  2323******************************************************************
  2324 01  SECURITY-MESSAGE.
  2325     12  FILLER                          PIC X(30)
  2326            VALUE '** LOGIC SECURITY VIOLATION -'.
  2327     12  SM-READ                         PIC X(6).
  2328     12  FILLER                          PIC X(5)
  2329            VALUE ' PGM='.
  2330     12  SM-PGM                          PIC X(6).
  2331     12  FILLER                          PIC X(5)
  2332            VALUE ' OPR='.
  2333     12  SM-PROCESSOR-ID                 PIC X(4).
  2334     12  FILLER                          PIC X(6)
  2335            VALUE ' TERM='.
  2336     12  SM-TERMID                       PIC X(4).
  2337     12  FILLER                          PIC XX   VALUE SPACE.
  2338     12  SM-JUL-DATE                     PIC 9(5).
  2339     12  FILLER                          PIC X    VALUE SPACE.
  2340     12  SM-TIME                         PIC 99.99.
  2341
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  47
* EL690.cbl
  2343*    COPY ELCSCRTY.
  2344******************************************************************
  2345*                                                                *
  2346*                                                                *
  2347*                            ELCSCRTY                            *
  2348*                            VMOD=2.001                          *
  2349*                                                                *
  2350*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  2351*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  2352*        SAVED IN PI-SECURITY-ADDRESS.                           *
  2353*                                                                *
  2354******************************************************************
  2355 01  SECURITY-CONTROL.
  2356     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  2357     12  FILLER                       PIC XX    VALUE 'SC'.
  2358     12  SC-CREDIT-CODES.
  2359         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  2360             20  SC-CREDIT-DISPLAY    PIC X.
  2361             20  SC-CREDIT-UPDATE     PIC X.
  2362     12  SC-CLAIMS-CODES.
  2363         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  2364             20  SC-CLAIMS-DISPLAY    PIC X.
  2365             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  48
* EL690.cbl
  2367****************************************************************
  2368*
  2369* Copyright (c) 2007 by Clerity Solutions, Inc.
  2370* All rights reserved.
  2371*
  2372****************************************************************
  2373 01  DFHEIV.
  2374   02  DFHEIV0               PIC X(35).
  2375   02  DFHEIV1               PIC X(08).
  2376   02  DFHEIV2               PIC X(08).
  2377   02  DFHEIV3               PIC X(08).
  2378   02  DFHEIV4               PIC X(06).
  2379   02  DFHEIV5               PIC X(04).
  2380   02  DFHEIV6               PIC X(04).
  2381   02  DFHEIV7               PIC X(02).
  2382   02  DFHEIV8               PIC X(02).
  2383   02  DFHEIV9               PIC X(01).
  2384   02  DFHEIV10              PIC S9(7) COMP-3.
  2385   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2386   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2387   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2388   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2389   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2390   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2391   02  DFHEIV17              PIC X(04).
  2392   02  DFHEIV18              PIC X(04).
  2393   02  DFHEIV19              PIC X(04).
  2394   02  DFHEIV20              USAGE IS POINTER.
  2395   02  DFHEIV21              USAGE IS POINTER.
  2396   02  DFHEIV22              USAGE IS POINTER.
  2397   02  DFHEIV23              USAGE IS POINTER.
  2398   02  DFHEIV24              USAGE IS POINTER.
  2399   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2400   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2401   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2402   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2403   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2404   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2405   02  FILLER                PIC X(02).
  2406   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2407   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2408   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2409   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2410   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2411 LINKAGE  SECTION.
  2412*****************************************************************
  2413*                                                               *
  2414* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2415* All rights reserved.                                          *
  2416*                                                               *
  2417*****************************************************************
  2418 01  dfheiblk.
  2419     02  eibtime          pic s9(7) comp-3.
  2420     02  eibdate          pic s9(7) comp-3.
  2421     02  eibtrnid         pic x(4).
  2422     02  eibtaskn         pic s9(7) comp-3.
  2423     02  eibtrmid         pic x(4).
  2424     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  49
* EL690.cbl
  2425     02  eibcposn         pic s9(4) comp.
  2426     02  eibcalen         pic s9(4) comp.
  2427     02  eibaid           pic x(1).
  2428     02  eibfiller1       pic x(1).
  2429     02  eibfn            pic x(2).
  2430     02  eibfiller2       pic x(2).
  2431     02  eibrcode         pic x(6).
  2432     02  eibfiller3       pic x(2).
  2433     02  eibds            pic x(8).
  2434     02  eibreqid         pic x(8).
  2435     02  eibrsrce         pic x(8).
  2436     02  eibsync          pic x(1).
  2437     02  eibfree          pic x(1).
  2438     02  eibrecv          pic x(1).
  2439     02  eibsend          pic x(1).
  2440     02  eibatt           pic x(1).
  2441     02  eibeoc           pic x(1).
  2442     02  eibfmh           pic x(1).
  2443     02  eibcompl         pic x(1).
  2444     02  eibsig           pic x(1).
  2445     02  eibconf          pic x(1).
  2446     02  eiberr           pic x(1).
  2447     02  eibrldbk         pic x(1).
  2448     02  eiberrcd         pic x(4).
  2449     02  eibsynrb         pic x(1).
  2450     02  eibnodat         pic x(1).
  2451     02  eibfiller5       pic x(2).
  2452     02  eibresp          pic 9(09) comp.
  2453     02  eibresp2         pic 9(09) comp.
  2454     02  dfheigdj         pic s9(4) comp.
  2455     02  dfheigdk         pic s9(4) comp.
  2456 01  DFHCOMMAREA                 PIC X(1024).
  2457
  2458*01 PARMLIST .
  2459*    12  FILLER                  PIC S9(8)   COMP.
  2460*    12  L-ARCH-POINTER          PIC S9(8)   COMP.
  2461*    12  L-ARCT-POINTER          PIC S9(8)   COMP.
  2462*    12  L-CNTL-POINTER          PIC S9(8)   COMP.
  2463
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  50
* EL690.cbl
  2465*    COPY ERCARCH.
  2466******************************************************************
  2467*                                                                *
  2468*                            ERCARCH.                            *
  2469*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2470*                            VMOD=2.002                          *
  2471*                                                                *
  2472*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  2473*                                                                *
  2474*   FILE TYPE = VSAM,KSDS                                        *
  2475*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2476*                                                                *
  2477*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  2478*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  2479*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  2480*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  2481*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  2482*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  2483*                                                                *
  2484*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2485******************************************************************
  2486*                   C H A N G E   L O G
  2487*
  2488* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2489*-----------------------------------------------------------------
  2490*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2491* EFFECTIVE    NUMBER
  2492*-----------------------------------------------------------------
  2493* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2494* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2495* 110612    2012101700002  AJRA  ADD NEW FIELDS
  2496******************************************************************
  2497 01  LETTER-ARCHIVE.
  2498     12  LA-RECORD-ID                PIC  X(02).
  2499         88  LA-VALID-ID                VALUE 'LA'.
  2500
  2501     12  LA-CONTROL-PRIMARY.
  2502         16  LA-COMPANY-CD           PIC  X(01).
  2503         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  2504
  2505     12  LA-CONTROL-BY-CERT-RESP.
  2506         16  LA-COMPANY-CD-A2        PIC  X(01).
  2507         16  LA-CERT-NO-A2.
  2508             20  LA-CERT-PRIME-A2    PIC  X(10).
  2509             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  2510         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  2511             20  LA-RESP-PERSON-A2   PIC  X(10).
  2512             20  LA-TYPE-A2          PIC  X(01).
  2513         16  LA-CARRIER-A2           PIC  X(01).
  2514         16  LA-GROUPING-A2          PIC  X(06).
  2515         16  LA-STATE-A2             PIC  X(02).
  2516         16  LA-ACCOUNT-A2           PIC  X(10).
  2517         16  LA-EFFECT-DATE-A2       PIC  X(02).
  2518         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  2519
  2520     12  LA-CONTROL-BY-FORM.
  2521         16  LA-COMPANY-CD-A3        PIC  X(01).
  2522         16  LA-FORM-A3              PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  51
* EL690.cbl
  2523         16  LA-CARRIER-A3           PIC  X(01).
  2524         16  LA-GROUPING-A3          PIC  X(06).
  2525         16  LA-STATE-A3             PIC  X(02).
  2526         16  LA-ACCOUNT-A3           PIC  X(10).
  2527         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  2528
  2529     12  LA-CONTROL-BY-PROCESSOR.
  2530         16  LA-COMPANY-CD-A4        PIC  X(01).
  2531         16  LA-PROCESSOR-CD         PIC  X(04).
  2532         16  LA-CARRIER-A4           PIC  X(01).
  2533         16  LA-GROUPING-A4          PIC  X(06).
  2534         16  LA-STATE-A4             PIC  X(02).
  2535         16  LA-ACCOUNT-A4           PIC  X(10).
  2536         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  2537
  2538     12  LA-CONTROL-BY-KEY-FIELDS.
  2539         16  LA-COMPANY-CD-A5        PIC  X(01).
  2540         16  LA-CARRIER-A5           PIC  X(01).
  2541         16  LA-GROUPING-A5          PIC  X(06).
  2542         16  LA-STATE-A5             PIC  X(02).
  2543         16  LA-ACCOUNT-A5           PIC  X(10).
  2544         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  2545
  2546     12  LA-CONTROL-BY-GROUP-CODE.
  2547         16  LA-COMPANY-CD-A6        PIC  X(01).
  2548         16  LA-ENTRY-A6.
  2549             20  LA-FILLER           PIC  X(02).
  2550             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  2551         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  2552
  2553     12  FILLER                      PIC  X(09).
  2554
  2555     12  LA-HEADER-RECORD.
  2556         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  2557         16  LA-CREATION-DATE        PIC  X(02).
  2558         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  2559         16  LA-FINAL-ACT-DATE       REDEFINES
  2560               LA-FOLLOW-UP-DATE     PIC  X(02).
  2561         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  2562         16  LA-NO-OF-COPIES         PIC S9(01).
  2563         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  2564         16  LA-REPLY-DATE           PIC  X(02).
  2565         16  LA-RESEND-DATES.
  2566             20  LA-RESEND-DATE      PIC  X(02).
  2567             20  LA-SENT-DATE        PIC  X(02).
  2568             20  FILLER              PIC  X(08).
  2569         16  LA-SOURCE-INFORMATION.
  2570             20  LA-DATA-SOURCE      PIC  X(01).
  2571             20  LA-ADDR-SOURCE      PIC  X(01).
  2572         16  LA-STATUS               PIC  X(01).
  2573             88  LA-STATUS-ACTIVE         VALUE 'A'.
  2574             88  LA-STATUS-COMPLETED      VALUE 'C'.
  2575             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  2576             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  2577             88  LA-STATUS-PURGED         VALUE 'P'.
  2578             88  LA-STATUS-VOIDED         VALUE 'V'.
  2579         16  LA-LAST-RESENT-PRINT-DATE
  2580                                     PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  52
* EL690.cbl
  2581         16  LA-PRINT-RESTRICTION    PIC  X(01).
  2582             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  2583                                          VALUE 'C'.
  2584             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  2585                                          VALUE 'F'.
  2586             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  2587                                          VALUE 'P'.
  2588         16  LA-PURGED-DATE          PIC  X(02).
  2589         16  LA-VOIDED-DATE          PIC  X(02).
  2590         16  LA-RESEND-LETR          PIC  X(4).
  2591         16  FILLER                  PIC  X(08).
  2592*        16  LA-RESEND-LETR-2        PIC  X(4).
  2593*        16  LA-RESEND-LETR-3        PIC  X(4).
  2594*        16  FILLER                  PIC  X(59).
  2595         16  LA-ARCHIVE-STATUS       PIC  X.
  2596             88  LA-TEMP                VALUE 'T'.
  2597             88  LA-QWS                 VALUE 'Q'.
  2598             88  LA-BATCH               VALUE 'B'.
  2599         16  LA-FINAL-ACT-IND        PIC  X(1).
  2600         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  2601         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  2602         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  2603                                     PIC X(4).
  2604         16  FILLER                  PIC  X(42).
  2605*        16  FILLER                  PIC  X(71).
  2606         16  LA-LAST-MAINT-DATE      PIC  X(2).
  2607         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  2608         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  2609                                     PIC  X(4).
  2610         16  LA-LAST-UPDATED-BY      PIC  X(4).
  2611
  2612******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  53
* EL690.cbl
  2614*    COPY ERCARCT.
  2615******************************************************************
  2616*                                                                *
  2617*                            ERCARCT.                            *
  2618*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2619*                            VMOD=2.002                          *
  2620*                                                                *
  2621*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  2622*                                                                *
  2623*   FILE TYPE = VSAM,KSDS                                        *
  2624*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  2625*                                                                *
  2626*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  2627*                                                                *
  2628*   LOG = NO                                                     *
  2629*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2630******************************************************************
  2631*                   C H A N G E   L O G
  2632*
  2633* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2634*-----------------------------------------------------------------
  2635*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2636* EFFECTIVE    NUMBER
  2637*-----------------------------------------------------------------
  2638* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2639******************************************************************
  2640 01  LETTER-ARCHIVE-TEXT.
  2641     12  LT-RECORD-ID                PIC  X(02).
  2642         88  LT-VALID-ID                VALUE 'LT'.
  2643
  2644     12  LT-CONTROL-PRIMARY.
  2645         16  LT-COMPANY-CD           PIC  X(01).
  2646         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  2647         16  LT-RECORD-TYPE          PIC  X(01).
  2648             88  LT-ADDRESS-DATA        VALUE '1'.
  2649             88  LT-TEXT-DATA           VALUE '2'.
  2650             88  LT-COMMENT-DATA        VALUE '3'.
  2651         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  2652
  2653     12  FILLER                      PIC  X(28).
  2654     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  2655
  2656     12  LT-TEXT-RECORD.
  2657         16  LT-LETTER-TEXT OCCURS 20 TIMES
  2658                            INDEXED BY LT-NDX.
  2659             20  LT-TEXT-LINE        PIC  X(70).
  2660             20  LT-SKIP-CONTROL     PIC  X(02).
  2661                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  2662                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  2663             20  FILLER              PIC  X(08).
  2664
  2665     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  2666         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  2667             20  LT-COMMENT-LINE     PIC X(69).
  2668             20  LT-COMMENT-CHG-DT   PIC X(02).
  2669             20  LT-COMMENT-CHG-BY   PIC X(04).
  2670             20  FILLER              PIC X(05).
  2671
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  54
* EL690.cbl
  2673*    COPY ELCCNTL.
  2674******************************************************************
  2675*                                                                *
  2676*                                                                *
  2677*                            ELCCNTL.                            *
  2678*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2679*                            VMOD=2.059                          *
  2680*                                                                *
  2681*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2682*                                                                *
  2683*   FILE TYPE = VSAM,KSDS                                        *
  2684*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2685*                                                                *
  2686*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2687*       ALTERNATE INDEX = NONE                                   *
  2688*                                                                *
  2689*   LOG = YES                                                    *
  2690*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2691******************************************************************
  2692*                   C H A N G E   L O G
  2693*
  2694* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2695*-----------------------------------------------------------------
  2696*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2697* EFFECTIVE    NUMBER
  2698*-----------------------------------------------------------------
  2699* 082503                   PEMA  ADD BENEFIT GROUP
  2700* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2701* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2702* 092705    2005050300006  PEMA  ADD SPP LEASES
  2703* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2704* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2705* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2706* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2707* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2708* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2709******************************************************************
  2710*
  2711 01  CONTROL-FILE.
  2712     12  CF-RECORD-ID                       PIC XX.
  2713         88  VALID-CF-ID                        VALUE 'CF'.
  2714
  2715     12  CF-CONTROL-PRIMARY.
  2716         16  CF-COMPANY-ID                  PIC XXX.
  2717         16  CF-RECORD-TYPE                 PIC X.
  2718             88  CF-COMPANY-MASTER              VALUE '1'.
  2719             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2720             88  CF-STATE-MASTER                VALUE '3'.
  2721             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2722             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2723             88  CF-CARRIER-MASTER              VALUE '6'.
  2724             88  CF-MORTALITY-MASTER            VALUE '7'.
  2725             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2726             88  CF-TERMINAL-MASTER             VALUE '9'.
  2727             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2728             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2729             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2730             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  55
* EL690.cbl
  2731             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2732             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2733             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2734             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2735             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2736         16  CF-ACCESS-CD-GENL              PIC X(4).
  2737         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2738             20  CF-PROCESSOR               PIC X(4).
  2739         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2740             20  CF-STATE-CODE              PIC XX.
  2741             20  FILLER                     PIC XX.
  2742         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2743             20  FILLER                     PIC XX.
  2744             20  CF-HI-BEN-IN-REC           PIC XX.
  2745         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2746             20  FILLER                     PIC XXX.
  2747             20  CF-CARRIER-CNTL            PIC X.
  2748         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2749             20  FILLER                     PIC XX.
  2750             20  CF-HI-TYPE-IN-REC          PIC 99.
  2751         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2752             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2753                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2754             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2755             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2756         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2757             20  FILLER                     PIC X.
  2758             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2759         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2760             20  FILLER                     PIC XX.
  2761             20  CF-MORTGAGE-PLAN           PIC XX.
  2762         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2763
  2764     12  CF-LAST-MAINT-DT                   PIC XX.
  2765     12  CF-LAST-MAINT-BY                   PIC X(4).
  2766     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2767
  2768     12  CF-RECORD-BODY                     PIC X(728).
  2769
  2770
  2771****************************************************************
  2772*             COMPANY MASTER RECORD                            *
  2773****************************************************************
  2774
  2775     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2776         16  CF-COMPANY-ADDRESS.
  2777             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2778             20  CF-CL-IN-CARE-OF           PIC X(30).
  2779             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2780             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2781             20  CF-CL-CITY-STATE           PIC X(30).
  2782             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2783             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2784         16  CF-COMPANY-CD                  PIC X.
  2785         16  CF-COMPANY-PASSWORD            PIC X(8).
  2786         16  CF-SECURITY-OPTION             PIC X.
  2787             88  ALL-SECURITY                   VALUE '1'.
  2788             88  COMPANY-VERIFY                 VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  56
* EL690.cbl
  2789             88  PROCESSOR-VERIFY               VALUE '3'.
  2790             88  NO-SECURITY                    VALUE '4'.
  2791             88  ALL-BUT-TERM                   VALUE '5'.
  2792         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2793             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2794         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2795             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2796         16  CF-INFORCE-LOCATION            PIC X.
  2797             88  CERTS-ARE-ONLINE               VALUE '1'.
  2798             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2799             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2800         16  CF-LOWER-CASE-LETTERS          PIC X.
  2801         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2802             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2803             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2804             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2805             88  CF-ACCNT-CNTL                  VALUE '3'.
  2806             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2807
  2808         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2809         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2810
  2811         16  CF-LGX-CREDIT-USER             PIC X.
  2812             88  CO-IS-NOT-USER                 VALUE 'N'.
  2813             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2814
  2815         16 CF-CREDIT-CALC-CODES.
  2816             20  CF-CR-REM-TERM-CALC PIC X.
  2817               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2818               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2819               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2820               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2821               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2822               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2823               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2824             20  CF-CR-R78-METHOD           PIC X.
  2825               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2826               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2827
  2828         16  CF-CLAIM-CONTROL-COUNTS.
  2829             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2830                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2831
  2832             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2833                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2834
  2835             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2836                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2837
  2838             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2839                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2840
  2841         16  CF-CURRENT-MONTH-END           PIC XX.
  2842
  2843         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2844             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2845             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2846             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  57
* EL690.cbl
  2847             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2848                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2849                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2850             20  CF-CO-PREM-REJECT-SW       PIC X.
  2851                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2852                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2853             20  CF-CO-REF-REJECT-SW        PIC X.
  2854                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2855                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2856
  2857         16  CF-CO-REPORTING-DT             PIC XX.
  2858         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2859         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2860           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2861           88  CF-CO-MONTH-END                  VALUE '1'.
  2862
  2863         16  CF-LGX-CLAIM-USER              PIC X.
  2864             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2865             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2866
  2867         16  CF-CREDIT-EDIT-CONTROLS.
  2868             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2869             20  CF-MIN-AGE                 PIC 99.
  2870             20  CF-DEFAULT-AGE             PIC 99.
  2871             20  CF-MIN-TERM                PIC S999      COMP-3.
  2872             20  CF-MAX-TERM                PIC S999      COMP-3.
  2873             20  CF-DEFAULT-SEX             PIC X.
  2874             20  CF-JOINT-AGE-INPUT         PIC X.
  2875                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2876             20  CF-BIRTH-DATE-INPUT        PIC X.
  2877                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2878             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2879                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2880                 88  CF-ZERO-CARRIER            VALUE '1'.
  2881                 88  CF-ZERO-GROUPING           VALUE '2'.
  2882                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2883             20  CF-EDIT-SW                 PIC X.
  2884                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2885             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2886             20  CF-CR-PR-METHOD            PIC X.
  2887               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2888               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2889             20  FILLER                     PIC X.
  2890
  2891         16  CF-CREDIT-MISC-CONTROLS.
  2892             20  CF-REIN-TABLE-SW           PIC X.
  2893                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2894             20  CF-COMP-TABLE-SW           PIC X.
  2895                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2896             20  CF-EXPERIENCE-RETENTION-AGE
  2897                                            PIC S9        COMP-3.
  2898             20  CF-CONVERSION-DT           PIC XX.
  2899             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2900             20  CF-RUN-FREQUENCY-SW        PIC X.
  2901                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2902                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2903
  2904             20  CF-CR-CHECK-NO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  58
* EL690.cbl
  2905                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2906                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2907                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2908                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2909                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2910                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2911
  2912                 24  CF-CR-CHECK-COUNT       REDEFINES
  2913                     CF-CR-CHECK-COUNTER      PIC X(4).
  2914
  2915                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2916                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2917
  2918                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2919                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2920                 24  CF-MAIL-PROCESSING       PIC X.
  2921                     88  MAIL-PROCESSING          VALUE 'Y'.
  2922
  2923         16  CF-MISC-SYSTEM-CONTROL.
  2924             20  CF-SYSTEM-C                 PIC X.
  2925                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2926             20  CF-SYSTEM-D                 PIC X.
  2927                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2928             20  CF-SOC-SEC-NO-SW            PIC X.
  2929                 88  SOC-SEC-NO-USED             VALUE '1'.
  2930             20  CF-MEMBER-NO-SW             PIC X.
  2931                 88  MEMBER-NO-USED              VALUE '1'.
  2932             20  CF-TAX-ID-NUMBER            PIC X(11).
  2933             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2934             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2935                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2936                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2937                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2938                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2939             20  CF-SYSTEM-E                 PIC X.
  2940                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2941
  2942         16  CF-LGX-LIFE-USER               PIC X.
  2943             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2944             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2945
  2946         16  CF-CR-MONTH-END-DT             PIC XX.
  2947
  2948         16  CF-FILE-MAINT-DATES.
  2949             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2950                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2951             20  CF-LAST-BATCH       REDEFINES
  2952                 CF-LAST-BATCH-NO               PIC X(4).
  2953             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2954             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2955             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2956             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2957             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2958             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2959             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2960             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2961             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2962             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  59
* EL690.cbl
  2963
  2964         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2965         16  FILLER                         PIC X.
  2966
  2967         16  CF-ALT-MORT-CODE               PIC X(4).
  2968         16  CF-MEMBER-CAPTION              PIC X(10).
  2969
  2970         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2971             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2972             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2973             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2974             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2975             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2976
  2977         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2978
  2979         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2980         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2981         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2982         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2983
  2984         16  CF-AH-OVERRIDE-L1              PIC X.
  2985         16  CF-AH-OVERRIDE-L2              PIC XX.
  2986         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2987         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2988
  2989         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2990         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2991
  2992         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2993         16  CF-AR-LAST-EL860-DT            PIC XX.
  2994         16  CF-MP-MONTH-END-DT             PIC XX.
  2995
  2996         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2997         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2998             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2999
  3000         16  CF-AR-MONTH-END-DT             PIC XX.
  3001
  3002         16  CF-CRDTCRD-USER                PIC X.
  3003             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3004             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3005
  3006         16  CF-CC-MONTH-END-DT             PIC XX.
  3007
  3008         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3009
  3010         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3011             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3012             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3013             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3014         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3015         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3016         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3017         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3018             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3019             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3020         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  60
* EL690.cbl
  3021         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3022         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3023             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3024         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3025
  3026         16  CF-CL-ZIP-CODE.
  3027             20  CF-CL-ZIP-PRIME.
  3028                 24  CF-CL-ZIP-1ST          PIC X.
  3029                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3030                 24  FILLER                 PIC X(4).
  3031             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3032         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3033             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3034             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3035             20  FILLER                     PIC XXX.
  3036
  3037         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3038         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3039         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3040         16  CF-CO-OPTION-START-DATE        PIC XX.
  3041         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3042           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3043                                                      '3' '4'.
  3044           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3045           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3046           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3047           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3048           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3049           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3050
  3051         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3052
  3053         16  CF-PAYMENT-APPROVAL-LEVELS.
  3054             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3055             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3056             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3057             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3058             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3059             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3060
  3061         16  CF-END-USER-REPORTING-USER     PIC X.
  3062             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3063             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3064
  3065         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3066             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3067             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3068
  3069         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3070
  3071         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3072         16  FILLER                         PIC X.
  3073
  3074         16  CF-CREDIT-ARCHIVE-CNTL.
  3075             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3076             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3077             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3078
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  61
* EL690.cbl
  3079         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3080
  3081         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3082             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3083             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3084
  3085         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3086             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3087             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3088
  3089         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3090
  3091         16  CF-CO-ACH-ID-CODE              PIC  X.
  3092             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3093             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3094             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3095         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3096         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3097         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3098         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3099         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3100         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3101         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3102         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3103         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3104                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3105         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3106                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3107
  3108         16  CF-CO-OVER-SHORT.
  3109             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3110             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3111
  3112*         16  FILLER                         PIC X(102).
  3113         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3114             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3115             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3116
  3117         16  CF-AH-APPROVAL-DAYS.
  3118             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3119             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3120             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3121             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3122
  3123         16  FILLER                         PIC X(82).
  3124****************************************************************
  3125*             PROCESSOR/USER RECORD                            *
  3126****************************************************************
  3127
  3128     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3129         16  CF-PROCESSOR-NAME              PIC X(30).
  3130         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3131         16  CF-PROCESSOR-TITLE             PIC X(26).
  3132         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3133                 88  MESSAGE-YES                VALUE 'Y'.
  3134                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3135
  3136*****************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  62
* EL690.cbl
  3137****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3138****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3139****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3140****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3141*****************************************************
  3142
  3143         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3144             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3145             20  CF-APPLICATION-FORCE       PIC X.
  3146             20  CF-INDIVIDUAL-APP.
  3147                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3148                     28  CF-BROWSE-APP      PIC X.
  3149                     28  CF-UPDATE-APP      PIC X.
  3150
  3151         16  CF-CURRENT-TERM-ON             PIC X(4).
  3152         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3153             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3154             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3155             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3156             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3157             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3158             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3159             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3160         16  CF-PROCESSOR-CARRIER           PIC X.
  3161             88  NO-CARRIER-SECURITY            VALUE ' '.
  3162         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3163             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3164         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3165             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3166         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3167             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3168
  3169         16  CF-PROC-SYS-ACCESS-SW.
  3170             20  CF-PROC-CREDIT-CLAIMS-SW.
  3171                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3172                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3173                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3174                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3175             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3176                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3177                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3178             20  CF-PROC-LIFE-GNRLDGR-SW.
  3179                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3180                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3181                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3182                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3183             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3184                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3185                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3186         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3187             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3188             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3189         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3190
  3191         16  CF-APPROVAL-LEVEL                  PIC X.
  3192             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3193             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3194             88  APPROVAL-LEVEL-3                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  63
* EL690.cbl
  3195             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3196
  3197         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3198
  3199         16  CF-LANGUAGE-TYPE                   PIC X.
  3200             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3201             88  CF-LANG-IS-FR                      VALUE 'F'.
  3202
  3203         16  CF-CSR-IND                         PIC X.
  3204         16  FILLER                             PIC X(239).
  3205
  3206****************************************************************
  3207*             PROCESSOR/REMINDERS RECORD                       *
  3208****************************************************************
  3209
  3210     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3211         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3212             20  CF-START-REMIND-DT         PIC XX.
  3213             20  CF-END-REMIND-DT           PIC XX.
  3214             20  CF-REMINDER-TEXT           PIC X(50).
  3215         16  FILLER                         PIC X(296).
  3216
  3217
  3218****************************************************************
  3219*             STATE MASTER RECORD                              *
  3220****************************************************************
  3221
  3222     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3223         16  CF-STATE-ABBREVIATION          PIC XX.
  3224         16  CF-STATE-NAME                  PIC X(25).
  3225         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3226         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3227             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3228             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3229             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3230             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3231                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3232                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3233             20  CF-ST-PREM-REJECT-SW       PIC X.
  3234                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3235                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3236             20  CF-ST-REF-REJECT-SW        PIC X.
  3237                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3238                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3239         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3240         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3241         16  CF-ST-REFUND-RULES.
  3242             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3243             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3244             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3245         16  CF-ST-FST-PMT-EXTENSION.
  3246             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3247             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3248                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3249                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3250                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3251                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3252         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  64
* EL690.cbl
  3253             20  CF-ST-CALL-UNEARNED        PIC X.
  3254             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3255             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3256         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3257             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3258             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3259         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3260         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3261         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3262         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3263         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3264         16  FILLER                         PIC X.
  3265         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3266             20  CF-ST-BENEFIT-CD           PIC XX.
  3267             20  CF-ST-BENEFIT-KIND         PIC X.
  3268                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3269                 88  CF-ST-AH-KIND              VALUE 'A'.
  3270             20  CF-ST-REM-TERM-CALC        PIC X.
  3271                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3272                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3273                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3274                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3275                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3276                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3277                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3278                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3279
  3280             20  CF-ST-REFUND-CALC          PIC X.
  3281                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3282                 88  ST-REFD-BY-R78             VALUE '1'.
  3283                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3284                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3285                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3286                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3287                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3288                 88  ST-REFD-UTAH               VALUE '7'.
  3289                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3290                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3291                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3292
  3293             20  CF-ST-EARNING-CALC         PIC X.
  3294                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3295                 88  ST-EARN-BY-R78             VALUE '1'.
  3296                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3297                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3298                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3299                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3300                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3301                 88  ST-EARN-MEAN               VALUE '8'.
  3302                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3303
  3304             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3305                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3306                 88  ST-OVRD-BY-R78             VALUE '1'.
  3307                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3308                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3309                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3310                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  65
* EL690.cbl
  3311                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3312                 88  ST-OVRD-MEAN               VALUE '8'.
  3313                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3314             20  FILLER                     PIC X.
  3315
  3316         16  CF-ST-COMMISSION-CAPS.
  3317             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3318             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3319             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3320             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3321         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3322                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3323
  3324         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3325
  3326         16  CF-ST-STATUTORY-INTEREST.
  3327             20  CF-ST-STAT-DATE-FROM       PIC X.
  3328                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3329                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3330             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3331             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3332             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3333             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3334             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3335
  3336         16  CF-ST-OVER-SHORT.
  3337             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3338             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3339
  3340         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3341
  3342         16  CF-ST-RT-CALC                  PIC X.
  3343
  3344         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3345         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3346         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3347         16  CF-ST-RF-LR-CALC               PIC X.
  3348         16  CF-ST-RF-LL-CALC               PIC X.
  3349         16  CF-ST-RF-LN-CALC               PIC X.
  3350         16  CF-ST-RF-AH-CALC               PIC X.
  3351         16  CF-ST-RF-CP-CALC               PIC X.
  3352*        16  FILLER                         PIC X(206).
  3353*CIDMOD         16  FILLER                         PIC X(192).
  3354         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3355             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3356         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3357         16  CF-ST-VFY-2ND-BENE             PIC X.
  3358         16  FILLER                         PIC X(186).
  3359
  3360****************************************************************
  3361*             BENEFIT MASTER RECORD                            *
  3362****************************************************************
  3363
  3364     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3365         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3366             20  CF-BENEFIT-CODE            PIC XX.
  3367             20  CF-BENEFIT-NUMERIC  REDEFINES
  3368                 CF-BENEFIT-CODE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  66
* EL690.cbl
  3369             20  CF-BENEFIT-ALPHA           PIC XXX.
  3370             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3371             20  CF-BENEFIT-COMMENT         PIC X(10).
  3372
  3373             20  CF-LF-COVERAGE-TYPE        PIC X.
  3374                 88  CF-REDUCING                VALUE 'R'.
  3375                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3376
  3377             20  CF-SPECIAL-CALC-CD         PIC X.
  3378                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3379                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3380                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3381                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3382                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3383                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3384                 88  CF-FARM-PLAN               VALUE 'F'.
  3385                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3386                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3387                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3388                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3389                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3390                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3391                 88  CF-PRUDENTIAL              VALUE 'P'.
  3392                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3393                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3394                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3395                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3396                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3397                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3398
  3399             20  CF-JOINT-INDICATOR         PIC X.
  3400                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3401
  3402*            20  FILLER                     PIC X(12).
  3403             20  FILLER                     PIC X(11).
  3404             20  CF-BENEFIT-CATEGORY        PIC X.
  3405             20  CF-LOAN-TYPE               PIC X(8).
  3406
  3407             20  CF-CO-REM-TERM-CALC        PIC X.
  3408                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3409                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3410                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3411                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3412                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3413
  3414             20  CF-CO-EARNINGS-CALC        PIC X.
  3415                 88  CO-EARN-BY-R78             VALUE '1'.
  3416                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3417                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3418                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3419                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3420                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3421                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3422                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3423
  3424             20  CF-CO-REFUND-CALC          PIC X.
  3425                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3426                 88  CO-REFD-BY-R78             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  67
* EL690.cbl
  3427                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3428                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3429                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3430                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3431                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3432                 88  CO-REFD-MEAN               VALUE '8'.
  3433                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3434                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3435                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3436
  3437             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3438                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3439                 88  CO-OVRD-BY-R78             VALUE '1'.
  3440                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3441                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3442                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3443                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3444                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3445                 88  CO-OVRD-MEAN               VALUE '8'.
  3446                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3447
  3448             20  CF-CO-BEN-I-G-CD           PIC X.
  3449                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3450                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3451                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3452
  3453         16  FILLER                         PIC X(304).
  3454
  3455
  3456****************************************************************
  3457*             CARRIER MASTER RECORD                            *
  3458****************************************************************
  3459
  3460     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3461         16  CF-ADDRESS-DATA.
  3462             20  CF-MAIL-TO-NAME            PIC X(30).
  3463             20  CF-IN-CARE-OF              PIC X(30).
  3464             20  CF-ADDRESS-LINE-1          PIC X(30).
  3465             20  CF-ADDRESS-LINE-2          PIC X(30).
  3466             20  CF-CITY-STATE              PIC X(30).
  3467             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3468             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3469
  3470         16  CF-CLAIM-NO-CONTROL.
  3471             20  CF-CLAIM-NO-METHOD         PIC X.
  3472                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3473                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3474                 88  CLAIM-NO-SEQ               VALUE '3'.
  3475                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3476             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3477                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3478                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3479                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3480
  3481         16  CF-CHECK-NO-CONTROL.
  3482             20  CF-CHECK-NO-METHOD         PIC X.
  3483                 88  CHECK-NO-MANUAL            VALUE '1'.
  3484                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  68
* EL690.cbl
  3485                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3486                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3487             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3488                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3489
  3490         16  CF-DOMICILE-STATE              PIC XX.
  3491
  3492         16  CF-EXPENSE-CONTROLS.
  3493             20  CF-EXPENSE-METHOD          PIC X.
  3494                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3495                 88  DOLLARS-PER-PMT            VALUE '2'.
  3496                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3497                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3498             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3499             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3500
  3501         16  CF-CORRESPONDENCE-CONTROL.
  3502             20  CF-LETTER-RESEND-OPT       PIC X.
  3503                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3504                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3505             20  FILLER                     PIC X(4).
  3506
  3507         16  CF-RESERVE-CONTROLS.
  3508             20  CF-MANUAL-SW               PIC X.
  3509                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3510             20  CF-FUTURE-SW               PIC X.
  3511                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3512             20  CF-PTC-SW                  PIC X.
  3513                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3514             20  CF-IBNR-SW                 PIC X.
  3515                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3516             20  CF-PTC-LF-SW               PIC X.
  3517                 88  CF-LF-PTC-USED             VALUE '1'.
  3518             20  CF-CDT-ACCESS-METHOD       PIC X.
  3519                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3520                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3521                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3522             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3523
  3524         16  CF-CLAIM-CALC-METHOD           PIC X.
  3525             88  360-PLUS-MONTHS                VALUE '1'.
  3526             88  365-PLUS-MONTHS                VALUE '2'.
  3527             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3528             88  360-DAILY                      VALUE '4'.
  3529             88  365-DAILY                      VALUE '5'.
  3530
  3531         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3532         16  FILLER                         PIC X(11).
  3533
  3534         16  CF-LIMIT-AMOUNTS.
  3535             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3536             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3537             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3538             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3539             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3540             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3541             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3542             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  69
* EL690.cbl
  3543             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3544             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3545
  3546         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3547         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3548         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3549
  3550         16  CF-ZIP-CODE.
  3551             20  CF-ZIP-PRIME.
  3552                 24  CF-ZIP-1ST             PIC X.
  3553                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3554                 24  FILLER                 PIC X(4).
  3555             20  CF-ZIP-PLUS4               PIC X(4).
  3556         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3557             20  CF-CAN-POSTAL-1            PIC XXX.
  3558             20  CF-CAN-POSTAL-2            PIC XXX.
  3559             20  FILLER                     PIC XXX.
  3560
  3561         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3562         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3563         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3564
  3565         16  CF-RATING-SWITCH               PIC X.
  3566             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3567             88  CF-NO-RATING                   VALUE 'N'.
  3568
  3569         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3570
  3571         16  CF-CARRIER-OVER-SHORT.
  3572             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3573             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3574
  3575         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3576         16  CF-SECPAY-SWITCH               PIC X.
  3577             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3578             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3579         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3580         16  FILLER                         PIC X(448).
  3581*        16  FILLER                         PIC X(452).
  3582
  3583
  3584****************************************************************
  3585*             MORTALITY MASTER RECORD                          *
  3586****************************************************************
  3587
  3588     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3589         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3590                                INDEXED BY CF-MORT-NDX.
  3591             20  CF-MORT-TABLE              PIC X(5).
  3592             20  CF-MORT-TABLE-TYPE         PIC X.
  3593                 88  CF-MORT-JOINT              VALUE 'J'.
  3594                 88  CF-MORT-SINGLE             VALUE 'S'.
  3595                 88  CF-MORT-COMBINED           VALUE 'C'.
  3596                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3597                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3598             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3599             20  CF-MORT-AGE-METHOD         PIC XX.
  3600                 88  CF-AGE-LAST                VALUE 'AL'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  70
* EL690.cbl
  3601                 88  CF-AGE-NEAR                VALUE 'AN'.
  3602             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3603             20  CF-MORT-ADJUSTMENT-DIRECTION
  3604                                            PIC X.
  3605                 88  CF-MINUS                   VALUE '-'.
  3606                 88  CF-PLUS                    VALUE '+'.
  3607             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3608             20  CF-MORT-JOINT-CODE         PIC X.
  3609                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3610             20  CF-MORT-PC-Q               PIC X.
  3611                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3612             20  CF-MORT-TABLE-CODE         PIC X(4).
  3613             20  CF-MORT-COMMENTS           PIC X(15).
  3614             20  FILLER                     PIC X(14).
  3615
  3616         16  FILLER                         PIC X(251).
  3617
  3618
  3619****************************************************************
  3620*             BUSSINESS TYPE MASTER RECORD                     *
  3621****************************************************************
  3622
  3623     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3624* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3625* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3626* AND RECORD 05 IS TYPES 81-99
  3627         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3628             20  CF-BUSINESS-TITLE          PIC  X(19).
  3629             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3630                                            PIC S9V9(4) COMP-3.
  3631             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3632             20  FILLER                     PIC  X.
  3633         16  FILLER                         PIC  X(248).
  3634
  3635
  3636****************************************************************
  3637*             TERMINAL MASTER RECORD                           *
  3638****************************************************************
  3639
  3640     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3641
  3642         16  CF-COMPANY-TERMINALS.
  3643             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3644                                  PIC X(4).
  3645         16  FILLER               PIC X(248).
  3646
  3647
  3648****************************************************************
  3649*             LIFE EDIT MASTER RECORD                          *
  3650****************************************************************
  3651
  3652     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3653         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3654             20  CF-LIFE-CODE-IN            PIC XX.
  3655             20  CF-LIFE-CODE-OUT           PIC XX.
  3656         16  FILLER                         PIC X(248).
  3657
  3658
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  71
* EL690.cbl
  3659****************************************************************
  3660*             AH EDIT MASTER RECORD                            *
  3661****************************************************************
  3662
  3663     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3664         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3665             20  CF-AH-CODE-IN              PIC XXX.
  3666             20  CF-AH-CODE-OUT             PIC XX.
  3667         16  FILLER                         PIC X(248).
  3668
  3669
  3670****************************************************************
  3671*             CREDIBILITY TABLES                               *
  3672****************************************************************
  3673
  3674     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3675         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3676                             INDEXED BY CF-CRDB-NDX.
  3677             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3678             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3679             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3680         16  FILLER                         PIC  X(332).
  3681
  3682
  3683****************************************************************
  3684*             REPORT CUSTOMIZATION RECORD                      *
  3685****************************************************************
  3686
  3687     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3688         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3689             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3690             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3691             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3692**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3693****       A T-TRANSFER.                                   ****
  3694             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3695
  3696         16  FILLER                         PIC XX.
  3697
  3698         16  CF-CARRIER-CNTL-OPT.
  3699             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3700                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3701                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3702             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3703                                            PIC X.
  3704         16  CF-GROUP-CNTL-OPT.
  3705             20  CF-GROUP-OPT-SEQ           PIC 9.
  3706                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3707                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3708             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3709                                            PIC X(6).
  3710         16  CF-STATE-CNTL-OPT.
  3711             20  CF-STATE-OPT-SEQ           PIC 9.
  3712                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3713                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3714             20  CF-STATE-SELECT OCCURS 3 TIMES
  3715                                            PIC XX.
  3716         16  CF-ACCOUNT-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  72
* EL690.cbl
  3717             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3718                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3719                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3720             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3721                                            PIC X(10).
  3722         16  CF-BUS-TYP-CNTL-OPT.
  3723             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3724                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3725                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3726             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3727                                            PIC XX.
  3728         16  CF-LF-TYP-CNTL-OPT.
  3729             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3730                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3731                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3732             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3733                                            PIC XX.
  3734         16  CF-AH-TYP-CNTL-OPT.
  3735             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3736                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3737                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3738             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3739                                            PIC XX.
  3740         16  CF-REPTCD1-CNTL-OPT.
  3741             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3742                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3743                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3744             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3745                                            PIC X(10).
  3746         16  CF-REPTCD2-CNTL-OPT.
  3747             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3748                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3749                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3750             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3751                                            PIC X(10).
  3752         16  CF-USER1-CNTL-OPT.
  3753             20  CF-USER1-OPT-SEQ           PIC 9.
  3754                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3755                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3756             20  CF-USER1-SELECT OCCURS 3 TIMES
  3757                                            PIC X(10).
  3758         16  CF-USER2-CNTL-OPT.
  3759             20  CF-USER2-OPT-SEQ           PIC 9.
  3760                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3761                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3762             20  CF-USER2-SELECT OCCURS 3 TIMES
  3763                                            PIC X(10).
  3764         16  CF-USER3-CNTL-OPT.
  3765             20  CF-USER3-OPT-SEQ           PIC 9.
  3766                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3767                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3768             20  CF-USER3-SELECT OCCURS 3 TIMES
  3769                                            PIC X(10).
  3770         16  CF-USER4-CNTL-OPT.
  3771             20  CF-USER4-OPT-SEQ           PIC 9.
  3772                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3773                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3774             20  CF-USER4-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  73
* EL690.cbl
  3775                                            PIC X(10).
  3776         16  CF-USER5-CNTL-OPT.
  3777             20  CF-USER5-OPT-SEQ           PIC 9.
  3778                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3779                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3780             20  CF-USER5-SELECT OCCURS 3 TIMES
  3781                                            PIC X(10).
  3782         16  CF-REINS-CNTL-OPT.
  3783             20  CF-REINS-OPT-SEQ           PIC 9.
  3784                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3785                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3786             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3787                 24  CF-REINS-PRIME         PIC XXX.
  3788                 24  CF-REINS-SUB           PIC XXX.
  3789
  3790         16  CF-AGENT-CNTL-OPT.
  3791             20  CF-AGENT-OPT-SEQ           PIC 9.
  3792                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3793                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3794             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3795                                            PIC X(10).
  3796
  3797         16  FILLER                         PIC X(43).
  3798
  3799         16  CF-LOSS-RATIO-SELECT.
  3800             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3801             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3802         16  CF-ENTRY-DATE-SELECT.
  3803             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3804             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3805         16  CF-EFFECTIVE-DATE-SELECT.
  3806             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3807             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3808
  3809         16  CF-EXCEPTION-LIST-IND          PIC X.
  3810             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3811
  3812         16  FILLER                         PIC X(318).
  3813
  3814****************************************************************
  3815*                  EXCEPTION REPORTING RECORD                  *
  3816****************************************************************
  3817
  3818     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3819         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3820             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3821
  3822         16  CF-COMBINED-LIFE-AH-OPT.
  3823             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3824             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3825             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3826             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3827
  3828         16  CF-LIFE-OPT.
  3829             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3830             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3831             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3832             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  74
* EL690.cbl
  3833             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3834             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3835             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3836             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3837             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3838             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3839
  3840         16  CF-AH-OPT.
  3841             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3842             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3843             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3844             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3845             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3846             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3847             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3848             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3849             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3850             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3851
  3852         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3853             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3854             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3855             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3856
  3857         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3858
  3859         16  FILLER                         PIC X(673).
  3860
  3861
  3862****************************************************************
  3863*             MORTGAGE SYSTEM PLAN RECORD                      *
  3864****************************************************************
  3865
  3866     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3867         16  CF-PLAN-TYPE                   PIC X.
  3868             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3869             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3870             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3871         16  CF-PLAN-ABBREV                 PIC XXX.
  3872         16  CF-PLAN-DESCRIPT               PIC X(10).
  3873         16  CF-PLAN-NOTES                  PIC X(20).
  3874         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3875         16  CF-PLAN-UNDERWRITING.
  3876             20  CF-PLAN-TERM-DATA.
  3877                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3878                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3879             20  CF-PLAN-AGE-DATA.
  3880                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3881                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3882                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3883             20  CF-PLAN-BENEFIT-DATA.
  3884                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3885                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3886                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3887                                            PIC S9(7)V99  COMP-3.
  3888         16  CF-PLAN-POLICY-FORMS.
  3889             20  CF-POLICY-FORM             PIC X(12).
  3890             20  CF-MASTER-APPLICATION      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  75
* EL690.cbl
  3891             20  CF-MASTER-POLICY           PIC X(12).
  3892         16  CF-PLAN-RATING.
  3893             20  CF-RATE-CODE               PIC X(5).
  3894             20  CF-SEX-RATING              PIC X.
  3895                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3896                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3897             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3898             20  CF-SUB-STD-TYPE            PIC X.
  3899                 88  CF-PCT-OF-PREM            VALUE '1'.
  3900                 88  CF-PCT-OF-BENE            VALUE '2'.
  3901         16  CF-PLAN-PREM-TOLERANCES.
  3902             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3903             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3904         16  CF-PLAN-PYMT-TOLERANCES.
  3905             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3906             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3907         16  CF-PLAN-MISC-DATA.
  3908             20  FILLER                     PIC X.
  3909             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3910             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3911         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3912         16  CF-PLAN-IND-GRP                PIC X.
  3913             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3914                                                     '1'.
  3915             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3916                                                     '2'.
  3917         16  CF-MIB-SEARCH-SW               PIC X.
  3918             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3919             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3920             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3921             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3922         16  CF-ALPHA-SEARCH-SW             PIC X.
  3923             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3924             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3925             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3926             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3927             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3928             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3929             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3930             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3931             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3932             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3933                                                     'A' 'B' 'C'
  3934                                                     'X' 'Y' 'Z'.
  3935         16  CF-EFF-DT-RULE-SW              PIC X.
  3936             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3937             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3938             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3939             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3940             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3941         16  FILLER                         PIC X(4).
  3942         16  CF-HEALTH-QUESTIONS            PIC X.
  3943             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3944         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3945         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3946         16  CF-PLAN-SNGL-JNT               PIC X.
  3947             88  CF-COMBINED-PLAN              VALUE 'C'.
  3948             88  CF-JNT-PLAN                   VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  76
* EL690.cbl
  3949             88  CF-SNGL-PLAN                  VALUE 'S'.
  3950         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3951         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3952         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3953         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3954         16  CF-RERATE-CNTL                 PIC  X.
  3955             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3956             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3957             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3958             88  CF-AUTO-RECALC                 VALUE '4'.
  3959         16  CF-BENEFIT-TYPE                PIC  X.
  3960             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3961             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3962         16  CF-POLICY-FEE                  PIC S999V99
  3963                                                    COMP-3.
  3964         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3965         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3966         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3967         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3968         16  FILLER                         PIC  X(32).
  3969         16  CF-TERMINATION-FORM            PIC  X(04).
  3970         16  FILLER                         PIC  X(08).
  3971         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3972                                                       COMP-3.
  3973         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3974         16  CF-ISSUE-LETTER                PIC  X(4).
  3975         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3976         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3977             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3978             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3979         16  CF-MP-REFUND-CALC              PIC X.
  3980             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3981             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3982             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3983             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3984             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3985             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3986             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3987             88  CF-MP-REFD-MEAN                VALUE '8'.
  3988         16  CF-ALT-RATE-CODE               PIC  X(5).
  3989
  3990
  3991         16  FILLER                         PIC X(498).
  3992****************************************************************
  3993*             MORTGAGE COMPANY MASTER RECORD                   *
  3994****************************************************************
  3995
  3996     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3997         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3998         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3999             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4000             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4001             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4002             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4003             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4004
  4005         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4006         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  77
* EL690.cbl
  4007         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4008         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4009         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4010
  4011         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4012             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4013         16  CF-MP-RECON-USE-IND            PIC X(1).
  4014             88  CF-MP-USE-RECON             VALUE 'Y'.
  4015         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4016             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4017         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4018             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4019             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4020         16  FILLER                         PIC X(1).
  4021         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4022             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4023         16  CF-MORTG-MIB-VERSION           PIC X.
  4024             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4025             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4026             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4027         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4028             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4029                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4030             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4031                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4032             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4033                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4034             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4035                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4036             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4037                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4038             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4039                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4040         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4041         16  FILLER                         PIC X(7).
  4042         16  CF-MORTG-DESTINATION-SYMBOL.
  4043             20  CF-MORTG-MIB-COMM          PIC X(5).
  4044             20  CF-MORTG-MIB-TERM          PIC X(5).
  4045         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4046             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4047         16  FILLER                         PIC X(03).
  4048         16  CF-MP-CHECK-NO-CONTROL.
  4049             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4050                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4051                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4052                                                ' ' LOW-VALUES.
  4053                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4054                                               VALUE '3'.
  4055         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4056         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4057         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4058             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4059                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4060             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4061                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4062             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4063                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4064             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  78
* EL690.cbl
  4065                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4066             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4067                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4068             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4069                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4070         16  CF-MORTG-BILLING-AREA.
  4071             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4072                                            PIC X.
  4073         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4074         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4075         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4076         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4077             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4078             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4079         16  FILLER                         PIC X.
  4080         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4081             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4082             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4083         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4084         16  FILLER                         PIC X(8).
  4085         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4086         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4087         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4088         16  CF-ACH-COMPANY-ID.
  4089             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4090                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4091                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4092                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4093             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4094         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4095             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4096         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4097             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4098             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4099         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4100         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4101         16  FILLER                         PIC X(536).
  4102
  4103****************************************************************
  4104*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4105****************************************************************
  4106
  4107     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4108         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4109             20  CF-FEMALE-HEIGHT.
  4110                 24  CF-FEMALE-FT           PIC 99.
  4111                 24  CF-FEMALE-IN           PIC 99.
  4112             20  CF-FEMALE-MIN-WT           PIC 999.
  4113             20  CF-FEMALE-MAX-WT           PIC 999.
  4114         16  FILLER                         PIC X(428).
  4115
  4116     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4117         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4118             20  CF-MALE-HEIGHT.
  4119                 24  CF-MALE-FT             PIC 99.
  4120                 24  CF-MALE-IN             PIC 99.
  4121             20  CF-MALE-MIN-WT             PIC 999.
  4122             20  CF-MALE-MAX-WT             PIC 999.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  79
* EL690.cbl
  4123         16  FILLER                         PIC X(428).
  4124******************************************************************
  4125*             AUTOMATIC ACTIVITY RECORD                          *
  4126******************************************************************
  4127     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4128         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4129             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4130             20  CF-SYS-LETTER-ID           PIC X(04).
  4131             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4132             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4133             20  CF-SYS-RESET-SW            PIC X(01).
  4134             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4135             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4136
  4137         16  FILLER                         PIC X(50).
  4138
  4139         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4140             20  CF-USER-ACTIVE-SW          PIC X(01).
  4141             20  CF-USER-LETTER-ID          PIC X(04).
  4142             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4143             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4144             20  CF-USER-RESET-SW           PIC X(01).
  4145             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4146             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4147             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4148
  4149         16  FILLER                         PIC X(246).
  4150
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  80
* EL690.cbl
  4152 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA LETTER-ARCHIVE
  4153                          LETTER-ARCHIVE-TEXT CONTROL-FILE.
  4154 0000-DFHEXIT SECTION.
  4155     MOVE '9#                    $   ' TO DFHEIV0.
  4156     MOVE 'EL690' TO DFHEIV1.
  4157     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4158
  4159     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  4160
  4161
  4162* EXEC CICS HANDLE CONDITION
  4163*        QIDERR    (0110-PGM-INITIALIZATION)
  4164*        MAPFAIL   (0110-PGM-INITIALIZATION)
  4165*        NOTOPEN   (8070-NOTOPEN)
  4166*        NOTFND    (8080-ARCH-NOT-FOUND)
  4167*        PGMIDERR  (9700-PGMID-ERROR)
  4168*        ERROR     (9800-ABEND)
  4169*        END-EXEC.
  4170*    MOVE '"$N?JIL.              ! " #00004157' TO DFHEIV0
  4171     MOVE X'22244E3F4A494C2E20202020' TO DFHEIV0(1:12)
  4172     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4173     MOVE X'2220233030303034313537' TO DFHEIV0(25:11)
  4174     CALL 'kxdfhei1' USING DFHEIV0
  4175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4176
  4177
  4178     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  4179     MOVE '5'                    TO DC-OPTION-CODE.
  4180     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  4181     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  4182     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE.
  4183
  4184     MOVE +1                     TO EMI-NUMBER-OF-LINES.
  4185     MOVE '2'                    TO EMI-SWITCH2.
  4186
  4187***************************************************************
  4188*       IF ATTEMPTING TO EXECUTE PROGRAM WITHOUT SIGNING ON   *
  4189*       (COMM LENGTH EQUAL ZERO), SEND ERROR MESSAGE.         *
  4190***************************************************************
  4191
  4192     IF  EIBCALEN EQUAL 0
  4193         GO TO 8000-UNAUTHORIZED-ACCESS.
  4194
  4195     IF  PI-RETURN-TO-PROGRAM EQUAL W-THIS-PGM
  4196         MOVE PI-CALLING-PROGRAM TO W-RETURNED-FROM
  4197
  4198     ELSE
  4199         MOVE SPACES             TO W-RETURNED-FROM.
  4200
  4201     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  4202
  4203         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  4204             MOVE PI-SAVED-PROGRAM-5    TO PI-SAVED-PROGRAM-6
  4205             MOVE PI-SAVED-PROGRAM-4    TO PI-SAVED-PROGRAM-5
  4206             MOVE PI-SAVED-PROGRAM-3    TO PI-SAVED-PROGRAM-4
  4207             MOVE PI-SAVED-PROGRAM-2    TO PI-SAVED-PROGRAM-3
  4208             MOVE PI-SAVED-PROGRAM-1    TO PI-SAVED-PROGRAM-2
  4209             MOVE PI-RETURN-TO-PROGRAM  TO PI-SAVED-PROGRAM-1
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  81
* EL690.cbl
  4210             MOVE PI-CALLING-PROGRAM    TO PI-RETURN-TO-PROGRAM
  4211             MOVE W-THIS-PGM            TO PI-CALLING-PROGRAM
  4212             MOVE LOW-VALUES            TO PI-690-WORK-AREA
  4213             MOVE HIGH-VALUES           TO PI-690-FIRST-DATA
  4214             MOVE ZEROS                 TO PI-690-BRWS-TYPE-IND
  4215
  4216             IF  PI-RETURN-TO-PROGRAM EQUAL W-XCTL-626
  4217                 MOVE LOW-VALUES        TO PI-CARRIER
  4218                                           PI-GROUPING
  4219                                           PI-STATE
  4220                                           PI-ACCOUNT
  4221                                           PI-CERT-EFF-DT
  4222                                           PI-CERT-PRIME
  4223                                           PI-CERT-SFX
  4224                                           PI-689-WORK-AREA
  4225
  4226             ELSE
  4227                 PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  4228                 GO TO 1200-SET-UP-COMPLETE-SCREEN
  4229
  4230         ELSE
  4231             MOVE PI-RETURN-TO-PROGRAM  TO PI-CALLING-PROGRAM
  4232             MOVE PI-SAVED-PROGRAM-1    TO PI-RETURN-TO-PROGRAM
  4233             MOVE PI-SAVED-PROGRAM-2    TO PI-SAVED-PROGRAM-1
  4234             MOVE PI-SAVED-PROGRAM-3    TO PI-SAVED-PROGRAM-2
  4235             MOVE PI-SAVED-PROGRAM-4    TO PI-SAVED-PROGRAM-3
  4236             MOVE PI-SAVED-PROGRAM-5    TO PI-SAVED-PROGRAM-4
  4237             MOVE PI-SAVED-PROGRAM-6    TO PI-SAVED-PROGRAM-5
  4238             MOVE SPACES                TO PI-SAVED-PROGRAM-6.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  82
* EL690.cbl
  4240 0100-ENTRY-LOGIC.
  4241
  4242     IF  EIBTRNID EQUAL W-TRANSACTION
  4243
  4244         IF  EIBAID EQUAL DFHCLEAR
  4245                 OR
  4246             NOT DISPLAY-CAP
  4247             MOVE PI-RETURN-TO-PROGRAM
  4248                                 TO W-CALL-PGM
  4249             PERFORM 9400-XCTL THRU 9400-EXIT
  4250
  4251         ELSE
  4252             GO TO 0200-RECEIVE
  4253
  4254     ELSE
  4255         IF  W-RETURNED-FROM NOT EQUAL SPACES
  4256             GO TO 1000-RECOVER-LAST-SCREEN.
  4257
  4258     MOVE LOW-VALUES             TO EL690AO.
  4259
  4260 0110-PGM-INITIALIZATION.
  4261
  4262     PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT.
  4263
  4264     MOVE LOW-VALUES             TO EL690AO.
  4265     MOVE -1                     TO TYPEBRL.
  4266     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  83
* EL690.cbl
  4268 0200-RECEIVE.
  4269
  4270     IF  EIBAID EQUAL DFHPA1
  4271             OR
  4272         EIBAID EQUAL DFHPA2
  4273             OR
  4274         EIBAID EQUAL DFHPA3
  4275         MOVE ER-7008            TO EMI-ERROR
  4276         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4277         MOVE -1                 TO PFKEYL
  4278         GO TO 8200-SEND-DATAONLY.
  4279
  4280
  4281* EXEC CICS RECEIVE
  4282*        MAP     (W-MAP)
  4283*        MAPSET  (W-MAPSET)
  4284*        INTO    (EL690AI)
  4285*        END-EXEC.
  4286     MOVE LENGTH OF
  4287      EL690AI
  4288       TO DFHEIV11
  4289*    MOVE '8"T I  L              ''   #00004268' TO DFHEIV0
  4290     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4291     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4292     MOVE X'2020233030303034323638' TO DFHEIV0(25:11)
  4293     CALL 'kxdfhei1' USING DFHEIV0,
  4294           W-MAP,
  4295           EL690AI,
  4296           DFHEIV11,
  4297           W-MAPSET,
  4298           DFHEIV99,
  4299           DFHEIV99
  4300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4301
  4302
  4303     IF  PFKEYL EQUAL ZERO
  4304         GO TO 0300-CHECK-PFKEYS.
  4305
  4306     IF  EIBAID NOT EQUAL DFHENTER
  4307         MOVE ER-0004            TO EMI-ERROR
  4308         GO TO 0310-INPUT-ERROR.
  4309
  4310     IF  PFKEYI GREATER 0 AND LESS 25
  4311         MOVE PF-VALUES (PFKEYI) TO EIBAID
  4312
  4313     ELSE
  4314         MOVE ER-0029            TO EMI-ERROR
  4315         GO TO 0310-INPUT-ERROR.
  4316
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  84
* EL690.cbl
  4318 0300-CHECK-PFKEYS.
  4319
  4320     IF  EIBAID EQUAL DFHPF23
  4321         MOVE EIBAID             TO PI-ENTRY-CD-1
  4322         MOVE W-XCTL-005         TO W-CALL-PGM
  4323         PERFORM 9400-XCTL THRU 9400-EXIT.
  4324
  4325     IF  EIBAID EQUAL DFHPF24
  4326         MOVE W-XCTL-626         TO W-CALL-PGM
  4327         PERFORM 9400-XCTL THRU 9400-EXIT.
  4328
  4329     IF  EIBAID EQUAL DFHPF12
  4330         MOVE W-XCTL-010         TO W-CALL-PGM
  4331         PERFORM 9400-XCTL THRU 9400-EXIT.
  4332
  4333     IF  MAINTI EQUAL 'C'
  4334             AND
  4335         EIBAID EQUAL DFHENTER
  4336             AND
  4337         CORRSELL GREATER THAN ZEROS
  4338         MOVE -1                 TO CORRSELL
  4339         MOVE AL-UNBON           TO CORRSELA
  4340                                    MAINTA
  4341         MOVE ER-9323            TO EMI-ERROR
  4342         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4343         GO TO 8200-SEND-DATAONLY.
  4344
  4345     IF  EIBAID EQUAL DFHPF3
  4346*            OR
  4347*        (EIBAID EQUAL DFHENTER
  4348*            AND
  4349*        CORRSELL GREATER THAN ZEROS)
  4350         MOVE '3'                TO EIBAID
  4351         PERFORM 1500-SELECT-ARCHIVE-REC THRU 1500-EXIT
  4352         MOVE W-XCTL-689         TO W-CALL-PGM
  4353         GO TO 9400-XCTL.
  4354
  4355     IF  EIBAID EQUAL DFHPF4
  4356         MOVE LOW-VALUES         TO EL690AO
  4357                                    PI-690-WORK-AREA
  4358         MOVE -1                 TO TYPEBRL
  4359         GO TO 8100-SEND-INITIAL-MAP.
  4360
  4361     IF  EIBAID EQUAL DFHPF5
  4362             OR
  4363         (EIBAID EQUAL DFHENTER
  4364             AND
  4365         CORRSELL GREATER THAN ZEROS)
  4366         MOVE '5'                TO EIBAID
  4367         PERFORM 1500-SELECT-ARCHIVE-REC THRU 1500-EXIT
  4368         IF PI-689-ARCHIVE-NUMBER NOT GREATER ZERO
  4369             MOVE -1             TO CORRSELL
  4370             MOVE AL-UNBON       TO CORRSELA
  4371             MOVE ER-9293        TO EMI-ERROR
  4372             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4373             GO TO 8200-SEND-DATAONLY
  4374         ELSE
  4375             MOVE W-XCTL-691         TO W-CALL-PGM
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  85
* EL690.cbl
  4376             GO TO 9400-XCTL
  4377         END-IF
  4378     END-IF.
  4379
  4380     IF  EIBAID EQUAL DFHPF6
  4381         MOVE PI-690-INIT-CARRIER  TO PI-CARRIER
  4382         MOVE PI-690-INIT-GROUPING TO PI-GROUPING
  4383         MOVE PI-690-INIT-STATE    TO PI-STATE
  4384         MOVE PI-690-INIT-ACCOUNT  TO PI-ACCOUNT
  4385         MOVE PI-690-INIT-EFFECT-DATE TO PI-CERT-EFF-DT
  4386         MOVE PI-690-INIT-CERT-PRIME TO PI-CERT-PRIME
  4387         MOVE PI-690-INIT-SUFFIX   TO PI-CERT-SFX
  4388         MOVE W-XCTL-1279        TO W-CALL-PGM
  4389         GO TO 9400-XCTL
  4390     END-IF
  4391
  4392     IF  MAINTI EQUAL 'C'
  4393             AND
  4394         EIBAID EQUAL DFHENTER
  4395         GO TO 0700-PROCESS-CHANGES.
  4396
  4397     IF  EIBAID EQUAL DFHPF1
  4398         PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT
  4399         MOVE LOW-VALUES         TO PI-690-FIRST-DATA
  4400                                    W-ARCH-GROUPS
  4401         GO TO 2000-PAGE-FORWARD.
  4402
  4403     IF  EIBAID EQUAL DFHPF2
  4404
  4405         IF  PI-690-INIT-DATA EQUAL LOW-VALUES
  4406             MOVE HIGH-VALUES    TO PI-690-INIT-DATA
  4407             PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT
  4408             MOVE HIGH-VALUES    TO PI-690-LAST-DATA
  4409             MOVE LOW-VALUES     TO W-ARCH-GROUPS
  4410             GO TO 3000-PAGE-BACKWARD
  4411
  4412         ELSE
  4413             PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT
  4414             MOVE HIGH-VALUES    TO PI-690-LAST-DATA
  4415             MOVE LOW-VALUES     TO W-ARCH-GROUPS
  4416             GO TO 3000-PAGE-BACKWARD.
  4417
  4418     MOVE ER-0029                TO EMI-ERROR.
  4419
  4420 0310-INPUT-ERROR.
  4421
  4422     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4423     MOVE -1                     TO PFKEYL
  4424     MOVE AL-UNBON               TO PFKEYA
  4425     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  86
* EL690.cbl
  4427 0500-EDIT-SCREEN-DATA.
  4428
  4429     IF  TYPEBRL NOT EQUAL ZEROS
  4430
  4431         IF  TYPEBRI NOT EQUAL PI-690-BRWS-TYPE-IND
  4432             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4433             MOVE TYPEBRI        TO PI-690-BRWS-TYPE-IND
  4434             MOVE AL-UNNON       TO TYPEBRA
  4435
  4436         ELSE
  4437             NEXT SENTENCE
  4438
  4439     ELSE
  4440         IF  PI-690-BRWS-TYPE-IND NOT NUMERIC
  4441                 OR
  4442             PI-690-BRWS-TYPE-IND LESS THAN 1
  4443                 OR
  4444             PI-690-BRWS-TYPE-IND GREATER THAN 6
  4445             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4446             MOVE 6              TO PI-690-BRWS-TYPE-IND
  4447             MOVE +1             TO TYPEBRL
  4448             MOVE AL-UNNON       TO TYPEBRA
  4449
  4450         ELSE
  4451             MOVE +1             TO TYPEBRL
  4452             MOVE AL-UNNON       TO TYPEBRA
  4453             MOVE PI-690-BRWS-TYPE-IND
  4454                                 TO TYPEBRO.
  4455
  4456     IF  CERTRPL GREATER THAN ZEROS
  4457
  4458         IF  CERTRPI NOT EQUAL PI-690-INIT-CERT-PRIME
  4459             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4460             MOVE CERTRPI        TO PI-690-INIT-CERT-PRIME
  4461             MOVE AL-UANON       TO CERTRPA
  4462
  4463             IF  SUFFIXL GREATER THAN ZEROS
  4464
  4465                 IF  SUFFIXI NOT EQUAL PI-690-INIT-SUFFIX
  4466                     MOVE 'Y'    TO W-CHANGE-REQUESTED-IND
  4467
  4468                     IF  SUFFIXI NOT GREATER THAN SPACES
  4469                         MOVE SPACES
  4470                                 TO SUFFIXI
  4471                                    PI-690-INIT-SUFFIX
  4472                         MOVE AL-UANON
  4473                                 TO SUFFIXA
  4474
  4475                     ELSE
  4476                         MOVE AL-UANON
  4477                                 TO SUFFIXA
  4478                         MOVE SUFFIXI
  4479                                 TO PI-690-INIT-SUFFIX
  4480
  4481                 ELSE
  4482                     NEXT SENTENCE
  4483
  4484             ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  87
* EL690.cbl
  4485                 IF  PI-690-INIT-SUFFIX EQUAL LOW-VALUES
  4486                         OR
  4487                     PI-690-INIT-SUFFIX EQUAL HIGH-VALUES
  4488                     MOVE AL-UANON
  4489                                 TO SUFFIXA
  4490                     MOVE SPACES TO PI-690-INIT-SUFFIX
  4491
  4492                 ELSE
  4493                     NEXT SENTENCE
  4494
  4495         ELSE
  4496             NEXT SENTENCE
  4497
  4498     ELSE
  4499         IF  PI-690-INIT-CERT-PRIME GREATER THAN LOW-VALUES
  4500                 AND
  4501             PI-690-INIT-CERT-PRIME LESS THAN HIGH-VALUES
  4502             MOVE PI-690-INIT-CERT-PRIME
  4503                                 TO CERTRPI
  4504             MOVE PI-690-INIT-SUFFIX
  4505                                 TO SUFFIXI
  4506             MOVE AL-UANON       TO CERTRPA
  4507                                    SUFFIXA
  4508             MOVE +10            TO CERTRPL
  4509             MOVE +1             TO SUFFIXL.
  4510
  4511     IF  FORML GREATER THAN ZEROS
  4512
  4513         IF  FORMI NOT EQUAL PI-690-INIT-FORM
  4514             MOVE AL-UANON       TO FORMA
  4515             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4516             MOVE FORMI          TO PI-690-INIT-FORM
  4517
  4518         ELSE
  4519             NEXT SENTENCE
  4520
  4521     ELSE
  4522         IF  PI-690-INIT-FORM GREATER THAN LOW-VALUES
  4523                 AND
  4524             PI-690-INIT-FORM LESS THAN HIGH-VALUES
  4525             MOVE AL-UANON       TO FORMA
  4526             MOVE +4             TO FORML
  4527             MOVE PI-690-INIT-FORM
  4528                                 TO FORMI.
  4529
  4530     IF  ENTRYL GREATER THAN ZEROS
  4531             AND
  4532         CKCNTLL GREATER THAN ZEROS
  4533         MOVE -1                 TO CKCNTLL
  4534         MOVE AL-UABON           TO CKCNTLA
  4535         MOVE ER-7362            TO EMI-ERROR
  4536         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4537         GO TO 8100-SEND-INITIAL-MAP.
  4538
  4539     IF  ENTRYL GREATER THAN ZEROS
  4540
  4541         IF  ENTRYI NOT EQUAL PI-690-INIT-ENTRY
  4542             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  88
* EL690.cbl
  4543             MOVE ENTRYI         TO PI-690-INIT-ENTRY
  4544
  4545         ELSE
  4546             NEXT SENTENCE
  4547
  4548     ELSE
  4549         IF  PI-690-INIT-ENTRY GREATER THAN LOW-VALUES
  4550                 AND
  4551             PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  4552                 AND
  4553             PI-690-INIT-CONTROL-PREFIX NOT EQUAL 'CK'
  4554             MOVE AL-UANON       TO ENTRYA
  4555             MOVE +6             TO ENTRYL
  4556             MOVE PI-690-INIT-ENTRY
  4557                                 TO ENTRYI.
  4558
  4559     IF  CKCNTLL GREATER THAN ZEROS
  4560
  4561         IF  CKCNTLI NUMERIC
  4562
  4563             IF  CKCNTLI NOT EQUAL PI-690-INIT-CONTROL
  4564                 MOVE 'Y'        TO W-CHANGE-REQUESTED-IND
  4565                 MOVE 'CK'       TO PI-690-INIT-CONTROL-PREFIX
  4566                 MOVE CKCNTLI    TO PI-690-INIT-CONTROL
  4567
  4568             ELSE
  4569                 NEXT SENTENCE
  4570
  4571         ELSE
  4572             MOVE ZEROS          TO PI-690-INIT-CONTROL
  4573                                    CKCNTLO
  4574
  4575     ELSE
  4576         IF  PI-690-INIT-CONTROL GREATER THAN ZEROS
  4577                 AND
  4578             PI-690-INIT-CONTROL LESS THAN 99999999
  4579                 AND
  4580             PI-690-INIT-CONTROL-PREFIX EQUAL 'CK'
  4581             MOVE AL-UANON       TO CKCNTLA
  4582             MOVE +8             TO CKCNTLL
  4583             MOVE PI-690-INIT-CONTROL
  4584                                 TO CKCNTLI.
  4585
  4586     IF  CARRIERL GREATER THAN ZEROS
  4587
  4588         IF  CARRIERI NOT EQUAL  TO PI-690-INIT-CARRIER
  4589             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4590             MOVE CARRIERI       TO PI-690-INIT-CARRIER
  4591
  4592         ELSE
  4593             NEXT SENTENCE
  4594
  4595     ELSE
  4596         IF  PI-690-INIT-CARRIER GREATER THAN LOW-VALUES
  4597                 AND
  4598             PI-690-INIT-CARRIER LESS THAN HIGH-VALUES
  4599             MOVE AL-UANON       TO CARRIERA
  4600             MOVE +1             TO CARRIERL
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  89
* EL690.cbl
  4601             MOVE PI-690-INIT-CARRIER
  4602                                 TO CARRIERI.
  4603
  4604     IF  GROUPL GREATER THAN ZEROS
  4605
  4606         IF  GROUPI NOT EQUAL    TO PI-690-INIT-GROUPING
  4607             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4608             MOVE GROUPI         TO PI-690-INIT-GROUPING
  4609
  4610         ELSE
  4611             NEXT SENTENCE
  4612
  4613     ELSE
  4614         IF  PI-690-INIT-GROUPING GREATER THAN LOW-VALUES
  4615                 AND
  4616             PI-690-INIT-GROUPING LESS THAN HIGH-VALUES
  4617             MOVE AL-UANON       TO GROUPA
  4618             MOVE +6             TO GROUPL
  4619             MOVE PI-690-INIT-GROUPING
  4620                                 TO GROUPI.
  4621
  4622     IF  STATEL GREATER THAN ZEROS
  4623
  4624         IF  STATEI NOT EQUAL    TO PI-690-INIT-STATE
  4625             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4626             MOVE STATEI         TO PI-690-INIT-STATE
  4627
  4628         ELSE
  4629             NEXT SENTENCE
  4630
  4631     ELSE
  4632         IF  PI-690-INIT-STATE GREATER THAN LOW-VALUES
  4633                 AND
  4634             PI-690-INIT-STATE LESS THAN HIGH-VALUES
  4635             MOVE AL-UANON       TO STATEA
  4636             MOVE +2             TO STATEL
  4637             MOVE PI-690-INIT-STATE
  4638                                 TO STATEI.
  4639
  4640     IF  ACCTL GREATER THAN ZEROS
  4641
  4642         IF  ACCTI NOT EQUAL     TO PI-690-INIT-ACCOUNT
  4643             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4644             MOVE ACCTI          TO PI-690-INIT-ACCOUNT
  4645
  4646         ELSE
  4647             NEXT SENTENCE
  4648
  4649     ELSE
  4650         IF  PI-690-INIT-ACCOUNT GREATER THAN LOW-VALUES
  4651                 AND
  4652             PI-690-INIT-ACCOUNT LESS THAN HIGH-VALUES
  4653             MOVE AL-UANON       TO ACCTA
  4654             MOVE +10            TO ACCTL
  4655             MOVE PI-690-INIT-ACCOUNT
  4656                                 TO ACCTI.
  4657
  4658     IF  PROCSRL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  90
* EL690.cbl
  4659
  4660         IF  PROCSRI NOT EQUAL   TO PI-690-INIT-PROCESSOR
  4661             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4662             MOVE PROCSRI        TO PI-690-INIT-PROCESSOR
  4663
  4664         ELSE
  4665             NEXT SENTENCE
  4666
  4667     ELSE
  4668         IF  PI-690-INIT-PROCESSOR GREATER THAN LOW-VALUES
  4669                 AND
  4670             PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  4671             MOVE AL-UANON       TO PROCSRA
  4672             MOVE +4             TO PROCSRL
  4673             MOVE PI-690-INIT-PROCESSOR
  4674                                 TO PROCSRI.
  4675
  4676     IF  EFFDTEL GREATER THAN ZEROS
  4677         MOVE EFFDTEI            TO W-DEEDIT-FIELD
  4678
  4679         PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4680
  4681         IF  DC-ERROR-CODE NOT EQUAL SPACES
  4682             MOVE -1             TO EFFDTEL
  4683             MOVE AL-UABON       TO EFFDTEA
  4684             MOVE ER-0314        TO EMI-ERROR
  4685             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4686             GO TO 8100-SEND-INITIAL-MAP
  4687
  4688         ELSE
  4689             IF  DC-BIN-DATE-1 NOT = PI-690-INIT-EFFECT-DATE
  4690                 MOVE 'Y'        TO W-CHANGE-REQUESTED-IND
  4691                 MOVE DC-BIN-DATE-1
  4692                                 TO PI-690-INIT-EFFECT-DATE
  4693                 MOVE DC-GREG-DATE-1-EDIT
  4694                                 TO PI-690-INIT-EFF-DTE
  4695
  4696             ELSE
  4697                 IF  PI-690-INIT-EFFECT-DATE > LOW-VALUES
  4698                         AND
  4699                     PI-690-INIT-EFFECT-DATE < HIGH-VALUES
  4700                     MOVE AL-UANON
  4701                                 TO EFFDTEA
  4702                     MOVE +8     TO EFFDTEL
  4703                     MOVE PI-690-INIT-EFF-DTE
  4704                                 TO EFFDTEI.
  4705
  4706     IF  STATSELL GREATER THAN ZEROS
  4707         MOVE STATSELI           TO PI-690-STATUS-SELECTION-IND
  4708
  4709         IF  NOT PI-690-VALID-SELECTION
  4710             MOVE -1             TO STATSELL
  4711             MOVE AL-UABON       TO STATSELA
  4712             MOVE ER-7244        TO EMI-ERROR
  4713             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4714             GO TO 8100-SEND-INITIAL-MAP
  4715
  4716         ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  91
* EL690.cbl
  4717             NEXT SENTENCE
  4718
  4719     ELSE
  4720         IF  PI-690-VALID-SELECTION
  4721             MOVE AL-UANON       TO STATSELA
  4722             MOVE +1             TO STATSELL
  4723             MOVE PI-690-STATUS-SELECTION-IND
  4724                                 TO STATSELI
  4725
  4726         ELSE
  4727             MOVE AL-UANON       TO STATSELA
  4728             MOVE +1             TO STATSELL
  4729             MOVE 'N'            TO PI-690-STATUS-SELECTION-IND
  4730                                    STATSELI.
  4731
  4732 0500-EXIT.
  4733     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  92
* EL690.cbl
  4735 0700-PROCESS-CHANGES.
  4736
  4737     IF  NOT MODIFY-CAP
  4738         MOVE 'UPDATE'           TO SM-READ
  4739         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  4740         MOVE ER-9096            TO EMI-ERROR
  4741         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4742         MOVE AL-UANON           TO MAINTA
  4743         MOVE -1                 TO MAINTL
  4744         GO TO 8200-SEND-DATAONLY.
  4745
  4746
  4747* EXEC CICS HANDLE CONDITION
  4748*        NOTFND  (8080-ARCH-NOT-FOUND)
  4749*        ENDFILE (8080-ARCH-NOT-FOUND)
  4750*        END-EXEC.
  4751*    MOVE '"$I''                  ! # #00004717' TO DFHEIV0
  4752     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4753     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4754     MOVE X'2320233030303034373137' TO DFHEIV0(25:11)
  4755     CALL 'kxdfhei1' USING DFHEIV0
  4756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4757
  4758
  4759     MOVE ZEROS                  TO W-FIRST-CHANGE-IND.
  4760
  4761     PERFORM 0720-SEARCH-FOR-CHANGES THRU 0720-EXIT
  4762             VARYING
  4763         W-ARCH-NDX FROM 1 BY 1
  4764             UNTIL
  4765         W-ARCH-NDX GREATER THAN 12
  4766             OR
  4767         PI-690-ARCHIVE-NUM (W-ARCH-NDX) EQUAL ZEROS.
  4768
  4769     IF  NOT EMI-NO-ERRORS
  4770         GO TO 8200-SEND-DATAONLY.
  4771
  4772     MOVE SPACES                 TO MAINTO
  4773     MOVE -1                     TO MAINTL
  4774     MOVE ER-9308                TO EMI-ERROR
  4775     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4776
  4777     MOVE LOW-VALUES             TO EL690AO.
  4778
  4779     IF  PI-690-LAST-BRWS-FWRD
  4780         MOVE '1'                TO EIBAID
  4781         GO TO 2000-PAGE-FORWARD.
  4782
  4783     IF  PI-690-LAST-BRWS-BWRD
  4784         MOVE '2'                TO EIBAID
  4785         GO TO 3000-PAGE-BACKWARD.
  4786
  4787 0700-EXIT.
  4788     EXIT.
  4789
  4790 0720-SEARCH-FOR-CHANGES.
  4791
  4792     MOVE SPACES                 TO W-REPLY-DATE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  93
* EL690.cbl
  4793                                    W-RESEND-DATE-1
  4794                                    W-RESEND-DATE-2
  4795                                    W-RESEND-DATE-3
  4796                                    W-STATUS
  4797                                    W-VALID-STATUS-SW.
  4798
  4799*    IF  W-STATSL (W-ARCH-NDX) GREATER THAN ZEROS
  4800*        MOVE W-STATSO (W-ARCH-NDX)
  4801*                                TO W-VALID-STATUS-SW
  4802*
  4803*        IF  W-ALLOWED-ENTRIES
  4804*            MOVE W-STATSO (W-ARCH-NDX)
  4805*                                TO W-STATUS
  4806*
  4807*        ELSE
  4808*            MOVE ER-7358        TO EMI-ERROR
  4809*            MOVE AL-UANON       TO W-STATSA (W-ARCH-NDX)
  4810*            MOVE -1             TO W-STATSL (W-ARCH-NDX)
  4811*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4812
  4813     IF  W-RSDATL (W-ARCH-NDX) GREATER THAN ZEROS
  4814
  4815         IF  W-RSDATO (W-ARCH-NDX) EQUAL SPACES
  4816                 OR
  4817             W-RSDATO (W-ARCH-NDX) EQUAL ZEROES
  4818             MOVE LOW-VALUES     TO W-RESEND-DATE-1
  4819
  4820         ELSE
  4821             MOVE W-RSDATO (W-ARCH-NDX)
  4822                                 TO W-DEEDIT-FIELD
  4823
  4824             PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4825
  4826             IF  DC-ERROR-CODE EQUAL SPACES
  4827                 MOVE DC-BIN-DATE-1
  4828                                 TO W-RESEND-DATE-1
  4829                 MOVE DC-GREG-DATE-1-EDIT
  4830                                 TO W-RSDATO (W-ARCH-NDX)
  4831
  4832             ELSE
  4833                 MOVE ER-0185    TO EMI-ERROR
  4834                 MOVE AL-UANON   TO W-RSDATA (W-ARCH-NDX)
  4835                 MOVE -1         TO W-RSDATL (W-ARCH-NDX)
  4836                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4837
  4838*    IF  W-RSFRML (W-ARCH-NDX) GREATER THAN ZEROS
  4839*
  4840*        IF  W-RSFRMO (W-ARCH-NDX) EQUAL SPACES
  4841*                OR
  4842*            W-RSFRMO (W-ARCH-NDX) EQUAL ZEROES
  4843*            MOVE LOW-VALUES     TO W-RESEND-DATE-2
  4844*
  4845*        ELSE
  4846*            MOVE W-RSFRMO (W-ARCH-NDX)
  4847*                                TO W-DEEDIT-FIELD
  4848*
  4849*            PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4850*
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  94
* EL690.cbl
  4851*            IF  DC-ERROR-CODE EQUAL SPACES
  4852*                MOVE DC-BIN-DATE-1
  4853*                                TO W-RESEND-DATE-2
  4854*                MOVE DC-GREG-DATE-1-EDIT
  4855*                                TO W-RSFRMO (W-ARCH-NDX)
  4856*
  4857*            ELSE
  4858*                MOVE ER-0185    TO EMI-ERROR
  4859*                MOVE AL-UANON   TO W-RSFRMA (W-ARCH-NDX)
  4860*                MOVE -1         TO W-RSFRML (W-ARCH-NDX)
  4861*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4862*
  4863*    IF  W-RSSTSL (W-ARCH-NDX) GREATER THAN ZEROS
  4864*
  4865*        IF  W-RSSTSO (W-ARCH-NDX) EQUAL SPACES
  4866*                OR
  4867*            W-RSSTSO (W-ARCH-NDX) EQUAL ZEROES
  4868*            MOVE LOW-VALUES     TO W-RESEND-DATE-3
  4869*
  4870*        ELSE
  4871*            MOVE W-RSSTSO (W-ARCH-NDX)
  4872*                                TO W-DEEDIT-FIELD
  4873*
  4874*            PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4875*
  4876*            IF  DC-ERROR-CODE EQUAL SPACES
  4877*                MOVE DC-BIN-DATE-1
  4878*                                TO W-RESEND-DATE-3
  4879*                MOVE DC-GREG-DATE-1-EDIT
  4880*                                TO W-RSSTSO (W-ARCH-NDX)
  4881*
  4882*            ELSE
  4883*                MOVE ER-0185    TO EMI-ERROR
  4884*                MOVE AL-UANON   TO W-RSSTSA (W-ARCH-NDX)
  4885*                MOVE -1         TO W-RSSTSL (W-ARCH-NDX)
  4886*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4887
  4888*    IF  W-REPLYL (W-ARCH-NDX) GREATER THAN ZEROS
  4889*
  4890*        IF  W-REPLYO (W-ARCH-NDX) EQUAL SPACES
  4891*                OR
  4892*            W-REPLYO (W-ARCH-NDX) EQUAL ZEROES
  4893*            MOVE LOW-VALUES     TO W-REPLY-DATE
  4894*
  4895*        ELSE
  4896*            MOVE W-REPLYO (W-ARCH-NDX)
  4897*                                TO W-DEEDIT-FIELD
  4898*
  4899*            PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4900*
  4901*            IF  DC-ERROR-CODE EQUAL SPACES
  4902*                MOVE DC-BIN-DATE-1
  4903*                                TO W-REPLY-DATE
  4904*                MOVE DC-GREG-DATE-1-EDIT
  4905*                                TO W-REPLYO (W-ARCH-NDX)
  4906*
  4907*            ELSE
  4908*                MOVE ER-9245    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  95
* EL690.cbl
  4909*                MOVE AL-UANON   TO W-REPLYA (W-ARCH-NDX)
  4910*                MOVE -1         TO W-REPLYL (W-ARCH-NDX)
  4911*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4912
  4913*    IF  (W-REPLY-DATE NOT EQUAL SPACES
  4914*            OR
  4915*        W-RESEND-DATE-1 NOT EQUAL SPACES
  4916*            OR
  4917*        W-RESEND-DATE-2 NOT EQUAL SPACES
  4918*            OR
  4919*        W-RESEND-DATE-3 NOT EQUAL SPACES
  4920*            OR
  4921*        W-STATUS GREATER THAN SPACES)
  4922*            AND
  4923*        PI-690-ARCHIVE-NUM (W-ARCH-NDX) NOT EQUAL ZEROS
  4924*        PERFORM 0740-UPDATE-ARCH-RECORD THRU 0740-EXIT.
  4925
  4926 0720-EXIT.
  4927     EXIT.
  4928
  4929 0740-UPDATE-ARCH-RECORD.
  4930
  4931     MOVE LOW-VALUES             TO W-ARCT-KEY.
  4932     MOVE PI-690-ARCHIVE-NUM (W-ARCH-NDX)
  4933                                 TO W-ARCH-ARCHIVE-NO
  4934                                    W-ARCT-ARCHIVE-NO
  4935                                    W-HOLD-ARCHIVE.
  4936     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
  4937                                    W-ARCT-COMPANY-CD.
  4938
  4939     IF  W-SPECIAL-STATUS
  4940         PERFORM 7800-DELETE-CYCLE THRU 7800-EXIT
  4941         GO TO 0740-EXIT.
  4942
  4943
  4944* EXEC CICS HANDLE CONDITION
  4945*        NOTFND  (8080-ARCH-NOT-FOUND)
  4946*        ENDFILE (8080-ARCH-NOT-FOUND)
  4947*        END-EXEC.
  4948*    MOVE '"$I''                  ! $ #00004906' TO DFHEIV0
  4949     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4950     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4951     MOVE X'2420233030303034393036' TO DFHEIV0(25:11)
  4952     CALL 'kxdfhei1' USING DFHEIV0
  4953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4954
  4955
  4956     PERFORM 7600-READ-ARCH-FILE THRU 7600-EXIT.
  4957
  4958     IF  W-REPLY-DATE NOT EQUAL SPACES
  4959
  4960         IF  W-REPLY-DATE EQUAL LOW-VALUES
  4961             MOVE LOW-VALUES     TO LA-REPLY-DATE
  4962             MOVE 'A'            TO W-STATUS
  4963
  4964         ELSE
  4965             MOVE W-REPLY-DATE   TO LA-REPLY-DATE
  4966             MOVE 'C'            TO W-STATUS.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  96
* EL690.cbl
  4967
  4968     IF  W-RESEND-DATE-1 NOT EQUAL SPACES
  4969             AND
  4970         W-RESEND-DATE-1 NOT EQUAL LA-RESEND-DATE
  4971
  4972         IF  LA-SENT-DATE   GREATER THAN LOW-VALUES
  4973             MOVE ER-7396        TO EMI-ERROR
  4974             MOVE AL-UANON       TO W-RSDATA (W-ARCH-NDX)
  4975             MOVE -1             TO W-RSDATL (W-ARCH-NDX)
  4976             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4977
  4978         ELSE
  4979             MOVE 'A'            TO W-STATUS
  4980             MOVE LOW-VALUES     TO LA-SENT-DATE
  4981             MOVE W-RESEND-DATE-1
  4982                                 TO LA-RESEND-DATE.
  4983
  4984*    IF  W-RESEND-DATE-2 NOT EQUAL SPACES
  4985*            AND
  4986*        W-RESEND-DATE-2 NOT EQUAL LA-RESEND-DATE-2
  4987*
  4988*        IF  LA-SENT-DATE-2 GREATER THAN LOW-VALUES
  4989*            MOVE ER-7396        TO EMI-ERROR
  4990*            MOVE AL-UANON       TO W-RSFRMA (W-ARCH-NDX)
  4991*            MOVE -1             TO W-RSFRML (W-ARCH-NDX)
  4992*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4993*
  4994*        ELSE
  4995*            MOVE 'A'            TO W-STATUS
  4996*            MOVE LOW-VALUES     TO LA-SENT-DATE-2
  4997*            MOVE W-RESEND-DATE-2
  4998*                                TO LA-RESEND-DATE-2.
  4999
  5000*    IF  W-RESEND-DATE-3 NOT EQUAL SPACES
  5001*            AND
  5002*        W-RESEND-DATE-3 NOT EQUAL LA-RESEND-DATE-3
  5003*
  5004*        IF  LA-SENT-DATE-3 GREATER THAN LOW-VALUES
  5005*
  5006*            IF  PI-COMPANY-ID EQUAL 'LAP' OR 'RMC'
  5007*                MOVE ER-7396    TO EMI-ERROR
  5008*                MOVE AL-UANON   TO W-RSSTSA (W-ARCH-NDX)
  5009*                MOVE -1         TO W-RSSTSL (W-ARCH-NDX)
  5010*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5011*
  5012*            ELSE
  5013*                MOVE LOW-VALUES TO LA-SENT-DATE-3
  5014*                MOVE W-RESEND-DATE-3
  5015*                                TO LA-RESEND-DATE-3
  5016*                MOVE 'A'        TO W-STATUS
  5017*
  5018*        ELSE
  5019*            MOVE 'A'            TO W-STATUS
  5020*            MOVE LOW-VALUES     TO LA-SENT-DATE-3
  5021*            MOVE W-RESEND-DATE-3
  5022*                                TO LA-RESEND-DATE-3.
  5023
  5024*    IF  LA-RESEND-DATE-3 GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  97
* EL690.cbl
  5025*
  5026*        IF  LA-RESEND-DATE-3 GREATER THAN LA-RESEND-DATE-2
  5027*            NEXT SENTENCE
  5028*
  5029*        ELSE
  5030*            EXEC CICS UNLOCK
  5031*                DATASET (W-ARCH-FILE-ID)
  5032*            END-EXEC
  5033*            MOVE ER-9281        TO EMI-ERROR
  5034*            MOVE AL-UANON       TO W-RSFRMA (W-ARCH-NDX)
  5035*            MOVE -1             TO W-RSFRML (W-ARCH-NDX)
  5036*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5037*            GO TO 0740-EXIT.
  5038
  5039*    IF  LA-RESEND-DATE-2 GREATER THAN LOW-VALUES
  5040*
  5041*        IF  LA-RESEND-DATE-2 GREATER THAN LA-RESEND-DATE
  5042*            NEXT SENTENCE
  5043*
  5044*        ELSE
  5045*            EXEC CICS UNLOCK
  5046*                DATASET (W-ARCH-FILE-ID)
  5047*            END-EXEC
  5048*
  5049*            MOVE ER-9281        TO EMI-ERROR
  5050*            MOVE AL-UANON       TO W-RSDATA (W-ARCH-NDX)
  5051*            MOVE -1             TO W-RSDATL (W-ARCH-NDX)
  5052*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5053*            GO TO 0740-EXIT.
  5054
  5055     IF  LA-STATUS EQUAL 'X'
  5056             AND
  5057         W-ACTIVE
  5058
  5059         IF  LA-VOIDED-DATE GREATER THAN LOW-VALUES
  5060             MOVE 'V'            TO W-STATUS
  5061
  5062         ELSE
  5063             IF  LA-REPLY-DATE GREATER THAN LOW-VALUES
  5064                 MOVE 'C'        TO W-STATUS.
  5065
  5066     IF  LA-STATUS EQUAL 'V'
  5067             AND
  5068         W-ACTIVE
  5069         MOVE LOW-VALUES         TO LA-VOIDED-DATE.
  5070
  5071*    IF  LA-STATUS EQUAL 'C'
  5072*            AND
  5073*        W-ACTIVE
  5074*        MOVE ER-7399            TO EMI-ERROR
  5075*        MOVE AL-UANON           TO W-STATSA (W-ARCH-NDX)
  5076*        MOVE -1                 TO W-STATSL (W-ARCH-NDX)
  5077*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5078*        GO TO 0740-REWRITE.
  5079
  5080     IF  W-CLEAR-INITIAL
  5081         MOVE LOW-VALUES         TO LA-INITIAL-PRINT-DATE
  5082         MOVE 'A'                TO W-STATUS.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  98
* EL690.cbl
  5083
  5084     IF  W-CHECK-STATUS
  5085         PERFORM 0750-CHECK-STATUS THRU 0750-EXIT
  5086
  5087     ELSE
  5088         IF  W-VALID-STATUS
  5089                 AND
  5090             W-STATUS GREATER THAN SPACES
  5091             MOVE W-STATUS       TO LA-STATUS.
  5092
  5093     IF  W-VOIDED
  5094         MOVE W-SAVE-BIN-DATE    TO LA-VOIDED-DATE.
  5095
  5096     IF  LA-REPLY-DATE GREATER THAN LOW-VALUES
  5097             AND
  5098         LA-STATUS EQUAL 'A'
  5099         MOVE 'C'                TO LA-STATUS.
  5100
  5101 0740-REWRITE.
  5102
  5103
  5104* EXEC CICS REWRITE
  5105*        DATASET (W-ARCH-FILE-ID)
  5106*        FROM    (LETTER-ARCHIVE)
  5107*    END-EXEC.
  5108     MOVE LENGTH OF
  5109      LETTER-ARCHIVE
  5110       TO DFHEIV11
  5111*    MOVE '&& L                  %   #00005058' TO DFHEIV0
  5112     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5113     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5114     MOVE X'2020233030303035303538' TO DFHEIV0(25:11)
  5115     CALL 'kxdfhei1' USING DFHEIV0,
  5116           W-ARCH-FILE-ID,
  5117           LETTER-ARCHIVE,
  5118           DFHEIV11,
  5119           DFHEIV99
  5120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5121
  5122
  5123     IF  W-NO-FIRST-CHANGE
  5124         MOVE W-ARCH-NDX         TO W-FIRST-CHANGE-IND.
  5125
  5126 0740-EXIT.
  5127     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page  99
* EL690.cbl
  5129 0750-CHECK-STATUS.
  5130
  5131     IF  LA-STATUS EQUAL '#'
  5132         MOVE 'A'                TO LA-STATUS
  5133         GO TO 0750-EXIT.
  5134
  5135     IF  LA-STATUS NOT EQUAL 'A' OR 'C'
  5136         GO TO 0750-EXIT.
  5137
  5138     IF LA-INITIAL-PRINT-DATE > LOW-VALUES
  5139        IF LA-RESEND-DATE > LOW-VALUES
  5140           IF LA-SENT-DATE = LOW-VALUES
  5141              MOVE 'A'           TO LA-STATUS
  5142           ELSE
  5143              MOVE 'C'           TO LA-STATUS
  5144           END-IF
  5145        ELSE
  5146           MOVE 'C'              TO LA-STATUS
  5147        END-IF
  5148     ELSE
  5149        MOVE 'A'                  TO LA-STATUS
  5150     END-IF
  5151*    IF  LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
  5152*        IF  LA-RESEND-DATE GREATER THAN LOW-VALUES
  5153*            IF  LA-SENT-DATE   NOT GREATER THAN LOW-VALUES
  5154*                MOVE 'A'        TO LA-STATUS
  5155*
  5156*            ELSE
  5157*                IF  LA-RESEND-DATE-2 GREATER THAN LOW-VALUES
  5158*
  5159*                    IF  LA-SENT-DATE-2 NOT GREATER THAN
  5160*                            LOW-VALUES
  5161*                        MOVE 'A'        TO LA-STATUS
  5162*
  5163*                    ELSE
  5164*                        IF  LA-RESEND-DATE-3 GREATER THAN
  5165*                                LOW-VALUES
  5166*
  5167*                            IF  LA-SENT-DATE-3 NOT GREATER
  5168*                                    THAN LOW-VALUES
  5169*                                MOVE 'A' TO LA-STATUS
  5170*
  5171*                            ELSE
  5172*                                MOVE 'C' TO LA-STATUS
  5173*
  5174*                        ELSE
  5175*                            MOVE 'C'
  5176*                                TO LA-STATUS
  5177*
  5178*
  5179*                 ELSE
  5180*                     MOVE 'C'   TO LA-STATUS
  5181*
  5182*        ELSE
  5183*            MOVE 'C'            TO LA-STATUS
  5184*
  5185*    ELSE
  5186*        MOVE 'A'                TO LA-STATUS.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 100
* EL690.cbl
  5187
  5188     .
  5189 0750-EXIT.
  5190     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 101
* EL690.cbl
  5192 0800-CONVERT-EFFECT-DATE.
  5193
  5194      IF  PI-CERT-EFF-DT > LOW-VALUES
  5195          MOVE PI-CERT-EFF-DT    TO DC-BIN-DATE-1
  5196                                    PI-690-INIT-EFFECT-DATE
  5197          MOVE ' '               TO DC-OPTION-CODE
  5198          PERFORM 9500-LINK-DATE-CONVERT
  5199              THRU 9500-EXIT
  5200
  5201          IF  DC-ERROR-CODE EQUAL SPACES
  5202              MOVE DC-GREG-DATE-1-EDIT
  5203                                 TO EFFDTEI
  5204                                    PI-690-INIT-EFF-DTE
  5205              MOVE +8            TO EFFDTEL
  5206
  5207          ELSE
  5208              MOVE LOW-VALUES    TO EFFDTEI
  5209              MOVE +8            TO EFFDTEL
  5210
  5211      ELSE
  5212          MOVE LOW-VALUES        TO EFFDTEI
  5213          MOVE +8                TO EFFDTEL.
  5214
  5215 0800-EXIT.
  5216     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 102
* EL690.cbl
  5218 1000-RECOVER-LAST-SCREEN.
  5219
  5220     MOVE LOW-VALUES             TO EL690AO.
  5221     MOVE 1                      TO W-FIRST-CHANGE-IND.
  5222
  5223     MOVE PI-690-BRWS-TYPE-IND   TO TYPEBRI.
  5224     MOVE +1                     TO TYPEBRL.
  5225
  5226     IF  PI-690-INIT-CERT-PRIME GREATER THAN LOW-VALUES
  5227             AND
  5228         PI-690-INIT-CERT-PRIME LESS THAN HIGH-VALUES
  5229         MOVE PI-690-INIT-CERT-PRIME
  5230                                 TO CERTRPI
  5231         MOVE +10                TO CERTRPL
  5232         MOVE PI-690-INIT-SUFFIX TO SUFFIXI
  5233         MOVE +1                 TO SUFFIXL.
  5234
  5235     IF  PI-690-INIT-CARRIER GREATER THAN LOW-VALUES
  5236             AND
  5237         PI-690-INIT-CARRIER LESS THAN HIGH-VALUES
  5238         MOVE PI-690-INIT-CARRIER
  5239                                 TO CARRIERI
  5240         MOVE +1                 TO CARRIERL.
  5241
  5242     IF  PI-690-INIT-GROUPING GREATER THAN LOW-VALUES
  5243             AND
  5244         PI-690-INIT-GROUPING LESS THAN HIGH-VALUES
  5245         MOVE PI-690-INIT-GROUPING
  5246                                 TO GROUPI
  5247         MOVE +6                 TO GROUPL.
  5248
  5249     IF  PI-690-INIT-STATE GREATER THAN LOW-VALUES
  5250             AND
  5251         PI-690-INIT-STATE LESS THAN HIGH-VALUES
  5252         MOVE PI-690-INIT-STATE  TO STATEI
  5253         MOVE +2                 TO STATEL.
  5254
  5255     IF  PI-690-INIT-ACCOUNT GREATER THAN LOW-VALUES
  5256             AND
  5257         PI-690-INIT-ACCOUNT LESS THAN HIGH-VALUES
  5258         MOVE PI-690-INIT-ACCOUNT
  5259                                 TO ACCTI
  5260         MOVE +10                TO ACCTL.
  5261
  5262     IF  PI-690-INIT-FORM GREATER THAN LOW-VALUES
  5263             AND
  5264         PI-690-INIT-FORM LESS THAN HIGH-VALUES
  5265         MOVE PI-690-INIT-FORM   TO FORMI
  5266         MOVE +04                TO FORML.
  5267
  5268     IF  PI-690-INIT-PROCESSOR GREATER THAN LOW-VALUES
  5269             AND
  5270         PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  5271         MOVE PI-690-INIT-PROCESSOR
  5272                                 TO PROCSRI
  5273         MOVE +04                TO PROCSRL.
  5274
  5275     IF  PI-690-INIT-EFFECT-DATE > LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 103
* EL690.cbl
  5276             AND
  5277         PI-690-INIT-EFFECT-DATE < HIGH-VALUES
  5278         MOVE PI-690-INIT-EFFECT-DATE
  5279                                 TO DC-BIN-DATE-1
  5280         MOVE ' '                TO DC-OPTION-CODE
  5281         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  5282
  5283         IF  DC-ERROR-CODE EQUAL SPACES
  5284             MOVE DC-GREG-DATE-1-EDIT
  5285                                 TO EFFDTEI
  5286             MOVE +8             TO EFFDTEL.
  5287
  5288     IF  PI-690-INIT-ENTRY GREATER THAN LOW-VALUES
  5289             AND
  5290         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  5291             AND
  5292         PI-690-INIT-CONTROL-PREFIX NOT EQUAL 'CK'
  5293         MOVE PI-690-INIT-ENTRY  TO ENTRYI
  5294         MOVE +6                 TO ENTRYL
  5295
  5296     ELSE
  5297         IF  PI-690-INIT-CONTROL GREATER THAN ZEROS
  5298                 AND
  5299             PI-690-INIT-CONTROL LESS THAN 99999999
  5300                 AND
  5301             PI-690-INIT-CONTROL-PREFIX EQUAL 'CK'
  5302             MOVE PI-690-INIT-CONTROL
  5303                                 TO CKCNTLI
  5304             MOVE +8             TO CKCNTLL.
  5305
  5306     IF  PI-690-VALID-SELECTION
  5307         MOVE PI-690-STATUS-SELECTION-IND
  5308                                 TO STATSELI
  5309         MOVE +1                 TO STATSELL
  5310
  5311     ELSE
  5312         MOVE 'N'                TO STATSELI
  5313         MOVE +1                 TO STATSELL.
  5314
  5315     IF  PI-690-LAST-BRWS-FWRD
  5316         MOVE '1'                TO EIBAID
  5317         GO TO 2000-PAGE-FORWARD.
  5318
  5319     IF  PI-690-LAST-BRWS-BWRD
  5320         MOVE '2'                TO EIBAID
  5321         MOVE 'Y'                TO W-READ-PREV-TWICE-IND
  5322         GO TO 3000-PAGE-BACKWARD.
  5323
  5324     MOVE -1                     TO CORRSELL.
  5325     GO TO 8100-SEND-INITIAL-MAP.
  5326
  5327 1000-EXIT.
  5328     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 104
* EL690.cbl
  5330 1200-SET-UP-COMPLETE-SCREEN.
  5331
  5332     MOVE LOW-VALUES        TO EL690AO.
  5333
  5334     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  5335         GO TO 1220-COMING-FROM-EL6311.
  5336
  5337     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  5338         GO TO 1240-COMING-FROM-EL652.
  5339
  5340     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  5341         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  5342         MOVE PI-CERT-PRIME      TO CERTRPI
  5343         MOVE +10                TO CERTRPL
  5344         MOVE PI-CERT-SFX        TO SUFFIXI
  5345         MOVE +1                 TO SUFFIXL
  5346         MOVE 1                  TO TYPEBRI
  5347         MOVE +1                 TO TYPEBRL
  5348
  5349     ELSE
  5350         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  5351             MOVE 4              TO TYPEBRI
  5352             MOVE +1             TO TYPEBRL.
  5353
  5354     MOVE PI-CARRIER             TO CARRIERI.
  5355     MOVE +1                     TO CARRIERL.
  5356     MOVE PI-GROUPING            TO GROUPI.
  5357     MOVE +6                     TO GROUPL.
  5358     MOVE PI-STATE               TO STATEI.
  5359     MOVE +2                     TO STATEL.
  5360     MOVE PI-ACCOUNT             TO ACCTI.
  5361     MOVE +10                    TO ACCTL.
  5362
  5363     IF  PI-CERT-EFF-DT NOT EQUAL LOW-VALUES
  5364             AND
  5365         PI-CERT-EFF-DT NOT EQUAL SPACES
  5366         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  5367         MOVE ' '                TO DC-OPTION-CODE
  5368         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  5369
  5370         IF  DC-ERROR-CODE EQUAL SPACES
  5371             MOVE DC-GREG-DATE-1-EDIT
  5372                                 TO EFFDTEI
  5373             MOVE +8             TO EFFDTEL.
  5374
  5375     MOVE '1'                    TO EIBAID.
  5376
  5377     PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT.
  5378     MOVE ER-7397                TO EMI-ERROR.
  5379     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5380     GO TO 3000-PAGE-BACKWARD.
  5381*    GO TO 2000-PAGE-FORWARD.
  5382
  5383 1200-EXIT.
  5384     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 105
* EL690.cbl
  5386 1220-COMING-FROM-EL6311.
  5387
  5388     MOVE 1                      TO TYPEBRI.
  5389     MOVE +1                     TO TYPEBRL.
  5390*    MOVE PI-689-ENTRY-BATCH     TO ENTRYI.
  5391*    MOVE +6                     TO ENTRYL.
  5392     MOVE PI-689-CERT-PRIME      TO CERTRPI.
  5393     MOVE +10                    TO CERTRPL.
  5394     MOVE PI-689-CERT-SFX        TO SUFFIXI.
  5395     MOVE +1                     TO SUFFIXL.
  5396     MOVE PI-689-CARRIER         TO CARRIERI.
  5397     MOVE +1                     TO CARRIERL.
  5398     MOVE PI-689-GROUPING        TO GROUPI.
  5399     MOVE +6                     TO GROUPL.
  5400     MOVE PI-689-STATE           TO STATEI.
  5401     MOVE +2                     TO STATEL.
  5402     MOVE PI-689-ACCOUNT         TO ACCTI.
  5403     MOVE +10                    TO ACCTL.
  5404
  5405     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  5406         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  5407         MOVE ' '                TO DC-OPTION-CODE
  5408         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  5409
  5410         IF  DC-ERROR-CODE EQUAL SPACES
  5411             MOVE DC-GREG-DATE-1-EDIT
  5412                                 TO EFFDTEI
  5413             MOVE +8             TO EFFDTEL
  5414
  5415         ELSE
  5416             MOVE LOW-VALUES     TO EFFDTEI
  5417             MOVE +8             TO EFFDTEL
  5418
  5419     ELSE
  5420         MOVE LOW-VALUES         TO EFFDTEI
  5421         MOVE +8                 TO EFFDTEL.
  5422
  5423     MOVE '1'                    TO EIBAID.
  5424
  5425     PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT.
  5426     MOVE ER-7397                TO EMI-ERROR.
  5427     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5428     GO TO 3000-PAGE-BACKWARD.
  5429*    GO TO 2000-PAGE-FORWARD.
  5430
  5431 1220-EXIT.
  5432     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 106
* EL690.cbl
  5434 1240-COMING-FROM-EL652.
  5435
  5436     MOVE 1                      TO TYPEBRI.
  5437     MOVE +1                     TO TYPEBRL.
  5438     MOVE PI-CR-FIN-RESP         TO CERTRPI.
  5439     MOVE +10                    TO CERTRPL.
  5440     MOVE PI-CR-TYPE             TO SUFFIXI.
  5441     MOVE +1                     TO SUFFIXL.
  5442     MOVE PI-CR-CARRIER          TO CARRIERI.
  5443     MOVE +1                     TO CARRIERL.
  5444     MOVE PI-CR-GROUPING         TO GROUPI.
  5445     MOVE +6                     TO GROUPL.
  5446     MOVE PI-CR-ACCOUNT          TO ACCTI.
  5447     MOVE +10                    TO ACCTL.
  5448
  5449     MOVE AL-UANON               TO CARRIERA
  5450                                    GROUPA
  5451                                    ACCTA
  5452                                    TYPEBRA
  5453                                    CERTRPA.
  5454
  5455     PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT.
  5456     MOVE ER-7397                TO EMI-ERROR.
  5457     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5458     GO TO 3000-PAGE-BACKWARD.
  5459*    GO TO 2000-PAGE-FORWARD.
  5460
  5461 1240-EXIT.
  5462     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 107
* EL690.cbl
  5464 1500-SELECT-ARCHIVE-REC.
  5465
  5466     MOVE ZEROS                  TO PI-689-ARCHIVE-NUMBER.
  5467
  5468     IF  CORRSELL GREATER THAN +0
  5469
  5470
  5471* EXEC CICS BIF DEEDIT
  5472*            FIELD   (CORRSELI)
  5473*            LENGTH  (2)
  5474*            END-EXEC
  5475     MOVE 2
  5476       TO DFHEIV11
  5477*    MOVE '@"L                   #   #00005410' TO DFHEIV0
  5478     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5479     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5480     MOVE X'2020233030303035343130' TO DFHEIV0(25:11)
  5481     CALL 'kxdfhei1' USING DFHEIV0,
  5482           CORRSELI,
  5483           DFHEIV11
  5484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5485
  5486         IF  CORRSELI NUMERIC
  5487
  5488             IF  CORRSELI NOT LESS THAN 01
  5489                     AND
  5490                 CORRSELI NOT GREATER THAN 12
  5491                 MOVE CORRSELI   TO W-ARCH-NDX
  5492
  5493                 IF  PI-690-ARCHIVE-NUM (W-ARCH-NDX)
  5494                          NOT EQUAL ZEROS
  5495                     MOVE PI-690-ARCHIVE-NUM (W-ARCH-NDX)
  5496                                 TO PI-689-ARCHIVE-NUMBER
  5497                     GO TO 1500-EXIT
  5498
  5499                 ELSE
  5500                     MOVE ER-9293
  5501                                 TO EMI-ERROR
  5502                     MOVE -1     TO CORRSELL
  5503                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5504                     GO TO 8200-SEND-DATAONLY
  5505
  5506         ELSE
  5507             MOVE ER-9293        TO EMI-ERROR
  5508             MOVE -1             TO CORRSELL
  5509             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5510             GO TO 8200-SEND-DATAONLY.
  5511
  5512 1500-EXIT.
  5513     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 108
* EL690.cbl
  5515 2000-PAGE-FORWARD.
  5516
  5517     MOVE '1'                    TO PI-690-LAST-BROWSE-IND.
  5518     MOVE +1                     TO W-ARCH-NDX.
  5519     MOVE ZEROS                  TO W-ARCH-NUMBER.
  5520
  5521     GO TO 2100-ARCH2-PROCESS
  5522           2200-ARCH3-PROCESS
  5523           2300-ARCH4-PROCESS
  5524           2400-ARCH5-PROCESS
  5525           2500-ARCH6-PROCESS
  5526           2600-ARCH-PROCESS DEPENDING ON PI-690-BRWS-TYPE-IND.
  5527
  5528     MOVE ER-7384                TO EMI-ERROR.
  5529     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5530     MOVE -1                     TO TYPEBRL.
  5531     MOVE AL-UABON               TO TYPEBRA.
  5532     GO TO 8100-SEND-INITIAL-MAP.
  5533
  5534 2000-EXIT.
  5535     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 109
* EL690.cbl
  5537 2100-ARCH2-PROCESS.
  5538
  5539     IF  W-CHANGE-REQUESTED
  5540         MOVE LOW-VALUES         TO W-ARCH2-KEY
  5541         MOVE PI-COMPANY-CD      TO W-ARCH2-COMPANY-CD
  5542         MOVE PI-690-INIT-CERT-PRIME
  5543                                 TO W-ARCH2-CERT-PRIME
  5544         MOVE PI-690-INIT-SUFFIX TO W-ARCH2-SUFFIX
  5545         MOVE PI-690-INIT-CARRIER
  5546                                 TO W-ARCH2-CARRIER
  5547         MOVE PI-690-INIT-GROUPING
  5548                                 TO W-ARCH2-GROUPING
  5549         MOVE PI-690-INIT-STATE  TO W-ARCH2-STATE
  5550         MOVE PI-690-INIT-ACCOUNT
  5551                                 TO W-ARCH2-ACCOUNT
  5552         MOVE PI-690-INIT-EFFECT-DATE
  5553                                 TO W-ARCH2-EFF-DTE
  5554         MOVE PI-690-INIT-ARCHIVE-NO
  5555                                 TO W-ARCH2-ARCHIVE-NO
  5556
  5557     ELSE
  5558         IF  W-FIRST-CHANGE-FOUND
  5559             MOVE LOW-VALUES     TO W-ARCH2-KEY
  5560             MOVE PI-COMPANY-CD  TO W-ARCH2-COMPANY-CD
  5561             MOVE PI-690-FIRST-CERT-PRIME
  5562                                 TO W-ARCH2-CERT-PRIME
  5563             MOVE PI-690-FIRST-SUFFIX
  5564                                 TO W-ARCH2-SUFFIX
  5565             MOVE PI-690-FIRST-CARRIER
  5566                                 TO W-ARCH2-CARRIER
  5567             MOVE PI-690-FIRST-GROUPING
  5568                                 TO W-ARCH2-GROUPING
  5569             MOVE PI-690-FIRST-STATE
  5570                                 TO W-ARCH2-STATE
  5571             MOVE PI-690-FIRST-ACCOUNT
  5572                                 TO W-ARCH2-ACCOUNT
  5573             MOVE PI-690-FIRST-EFFECT-DATE
  5574                                 TO W-ARCH2-EFF-DTE
  5575             MOVE PI-690-FIRST-ARCHIVE-NO
  5576                                 TO W-ARCH2-ARCHIVE-NO
  5577
  5578         ELSE
  5579             MOVE LOW-VALUES     TO W-ARCH2-KEY
  5580             MOVE PI-COMPANY-CD  TO W-ARCH2-COMPANY-CD
  5581             MOVE PI-690-LAST-CERT-PRIME
  5582                                 TO W-ARCH2-CERT-PRIME
  5583             MOVE PI-690-LAST-SUFFIX
  5584                                 TO W-ARCH2-SUFFIX
  5585             MOVE PI-690-LAST-CARRIER
  5586                                 TO W-ARCH2-CARRIER
  5587             MOVE PI-690-LAST-GROUPING
  5588                                 TO W-ARCH2-GROUPING
  5589             MOVE PI-690-LAST-STATE
  5590                                 TO W-ARCH2-STATE
  5591             MOVE PI-690-LAST-ACCOUNT
  5592                                 TO W-ARCH2-ACCOUNT
  5593             MOVE PI-690-LAST-EFFECT-DATE
  5594                                 TO W-ARCH2-EFF-DTE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 110
* EL690.cbl
  5595             MOVE PI-690-LAST-ARCHIVE-NO
  5596                                 TO W-ARCH2-ARCHIVE-NO.
  5597
  5598
  5599* EXEC CICS HANDLE CONDITION
  5600*        NOTFND  (8080-ARCH-NOT-FOUND)
  5601*        ENDFILE (8080-ARCH-NOT-FOUND)
  5602*        NOTOPEN (8000-ARCH2-NOT-OPEN)
  5603*        END-EXEC.
  5604*    MOVE '"$I''J                 ! % #00005527' TO DFHEIV0
  5605     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  5606     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5607     MOVE X'2520233030303035353237' TO DFHEIV0(25:11)
  5608     CALL 'kxdfhei1' USING DFHEIV0
  5609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5610
  5611
  5612
  5613* EXEC CICS STARTBR
  5614*        DATASET  (W-ARCH2-FILE-ID)
  5615*        RIDFLD   (W-ARCH2-KEY)
  5616*        GTEQ
  5617*        END-EXEC.
  5618     MOVE 0
  5619       TO DFHEIV11
  5620*    MOVE '&,         G          &   #00005533' TO DFHEIV0
  5621     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5622     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5623     MOVE X'2020233030303035353333' TO DFHEIV0(25:11)
  5624     CALL 'kxdfhei1' USING DFHEIV0,
  5625           W-ARCH2-FILE-ID,
  5626           W-ARCH2-KEY,
  5627           DFHEIV99,
  5628           DFHEIV11,
  5629           DFHEIV99
  5630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5631
  5632
  5633     PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT.
  5634
  5635
  5636* EXEC CICS HANDLE CONDITION
  5637*        NOTFND  (2100-END-BROWSE)
  5638*        ENDFILE (2100-END-BROWSE)
  5639*        END-EXEC.
  5640*    MOVE '"$I''                  ! & #00005541' TO DFHEIV0
  5641     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5642     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5643     MOVE X'2620233030303035353431' TO DFHEIV0(25:11)
  5644     CALL 'kxdfhei1' USING DFHEIV0
  5645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5646
  5647
  5648 2100-BUILD-ARCH2-LIST.
  5649
  5650     IF  LA-COMPANY-CD-A2 NOT EQUAL PI-COMPANY-CD
  5651         GO TO 2100-END-BROWSE.
  5652
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 111
* EL690.cbl
  5653     IF  PI-690-INIT-CERT-NO EQUAL LOW-VALUES OR HIGH-VALUES
  5654         GO TO 2100-CONTINUE.
  5655
  5656     IF  LA-CERT-NO-A2 NOT EQUAL PI-690-INIT-CERT-NO
  5657         GO TO 2100-END-BROWSE.
  5658
  5659     IF  PI-690-INIT-CARRIER EQUAL LOW-VALUES OR HIGH-VALUES
  5660         GO TO 2100-CONTINUE.
  5661
  5662     IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  5663         GO TO 2100-END-BROWSE.
  5664
  5665     IF  PI-690-INIT-GROUPING EQUAL LOW-VALUES OR HIGH-VALUES
  5666         GO TO 2100-CONTINUE.
  5667
  5668     IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  5669         GO TO 2100-END-BROWSE.
  5670
  5671     IF  PI-690-INIT-STATE EQUAL LOW-VALUES OR HIGH-VALUES
  5672         GO TO 2100-CONTINUE.
  5673
  5674     IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  5675         GO TO 2100-END-BROWSE.
  5676
  5677     IF  PI-690-INIT-ACCOUNT EQUAL LOW-VALUES OR HIGH-VALUES
  5678         GO TO 2100-CONTINUE.
  5679
  5680     IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  5681         GO TO 2100-END-BROWSE.
  5682
  5683     IF  PI-690-INIT-EFFECT-DATE = LOW-VALUES OR HIGH-VALUES
  5684         GO TO 2100-CONTINUE.
  5685
  5686     IF  LA-EFFECT-DATE-A2 NOT EQUAL PI-690-INIT-EFFECT-DATE
  5687         GO TO 2100-END-BROWSE.
  5688
  5689 2100-CONTINUE.
  5690
  5691     IF  NOT PI-690-SELECT-ALL
  5692             AND
  5693         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  5694         PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5695         GO TO 2100-BUILD-ARCH2-LIST.
  5696
  5697     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  5698                 AND
  5699         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  5700         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  5701             PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5702             GO TO 2100-BUILD-ARCH2-LIST.
  5703
  5704     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  5705                 AND
  5706         PI-690-INIT-FORM LESS THAN HIGH-VALUES
  5707         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  5708             PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5709             GO TO 2100-BUILD-ARCH2-LIST.
  5710
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 112
* EL690.cbl
  5711     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  5712                 AND
  5713         PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  5714         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  5715             PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5716             GO TO 2100-BUILD-ARCH2-LIST.
  5717
  5718     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  5719
  5720     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  5721
  5722     IF  W-ARCH-NDX LESS THAN +13
  5723         PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5724         GO TO 2100-BUILD-ARCH2-LIST.
  5725
  5726 2100-END.
  5727
  5728     MOVE -1                     TO CORRSELL.
  5729     MOVE ZEROS                  TO CORRSELO.
  5730     PERFORM 2100-END-BROWSE.
  5731     GO TO 8100-SEND-INITIAL-MAP.
  5732
  5733 2100-END-BROWSE.
  5734
  5735
  5736* EXEC CICS ENDBR
  5737*        DATASET (W-ARCH2-FILE-ID)
  5738*    END-EXEC.
  5739     MOVE 0
  5740       TO DFHEIV11
  5741*    MOVE '&2                    $   #00005633' TO DFHEIV0
  5742     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5743     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5744     MOVE X'2020233030303035363333' TO DFHEIV0(25:11)
  5745     CALL 'kxdfhei1' USING DFHEIV0,
  5746           W-ARCH2-FILE-ID,
  5747           DFHEIV11,
  5748           DFHEIV99
  5749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5750
  5751
  5752 2100-NOT-FOUND.
  5753
  5754     MOVE ER-0130                TO EMI-ERROR.
  5755     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5756     MOVE -1                     TO CORRSELL.
  5757     MOVE ZEROS                  TO CORRSELO.
  5758     GO TO 8100-SEND-INITIAL-MAP.
  5759
  5760 2100-EXIT.
  5761     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 113
* EL690.cbl
  5763 2200-ARCH3-PROCESS.
  5764
  5765     IF  W-CHANGE-REQUESTED
  5766         MOVE LOW-VALUES         TO W-ARCH3-KEY
  5767         MOVE PI-COMPANY-CD      TO W-ARCH3-COMPANY-CD
  5768         MOVE PI-690-INIT-FORM   TO W-ARCH3-FORM
  5769         MOVE PI-690-INIT-CARRIER
  5770                                 TO W-ARCH3-CARRIER
  5771         MOVE PI-690-INIT-GROUPING
  5772                                 TO W-ARCH3-GROUPING
  5773         MOVE PI-690-INIT-STATE  TO W-ARCH3-STATE
  5774         MOVE PI-690-INIT-ACCOUNT
  5775                                 TO W-ARCH3-ACCOUNT
  5776         MOVE PI-690-INIT-ARCHIVE-NO
  5777                                 TO W-ARCH3-ARCHIVE-NO
  5778
  5779     ELSE
  5780         IF  W-FIRST-CHANGE-FOUND
  5781             MOVE LOW-VALUES     TO W-ARCH3-KEY
  5782             MOVE PI-COMPANY-CD  TO W-ARCH3-COMPANY-CD
  5783             MOVE PI-690-FIRST-FORM
  5784                                 TO W-ARCH3-FORM
  5785             MOVE PI-690-FIRST-CARRIER
  5786                                 TO W-ARCH3-CARRIER
  5787             MOVE PI-690-FIRST-GROUPING
  5788                                 TO W-ARCH3-GROUPING
  5789             MOVE PI-690-FIRST-STATE
  5790                                 TO W-ARCH3-STATE
  5791             MOVE PI-690-FIRST-ACCOUNT
  5792                                 TO W-ARCH3-ACCOUNT
  5793             MOVE PI-690-FIRST-ARCHIVE-NO
  5794                                 TO W-ARCH3-ARCHIVE-NO
  5795
  5796         ELSE
  5797             MOVE LOW-VALUES     TO W-ARCH3-KEY
  5798             MOVE PI-COMPANY-CD  TO W-ARCH3-COMPANY-CD
  5799             MOVE PI-690-LAST-FORM
  5800                                 TO W-ARCH3-FORM
  5801             MOVE PI-690-LAST-CARRIER
  5802                                 TO W-ARCH3-CARRIER
  5803             MOVE PI-690-LAST-GROUPING
  5804                                 TO W-ARCH3-GROUPING
  5805             MOVE PI-690-LAST-STATE
  5806                                 TO W-ARCH3-STATE
  5807             MOVE PI-690-LAST-ACCOUNT
  5808                                 TO W-ARCH3-ACCOUNT
  5809             MOVE PI-690-LAST-ARCHIVE-NO
  5810                                 TO W-ARCH3-ARCHIVE-NO.
  5811
  5812
  5813* EXEC CICS HANDLE CONDITION
  5814*        NOTFND  (8080-ARCH-NOT-FOUND)
  5815*        ENDFILE (8080-ARCH-NOT-FOUND)
  5816*        NOTOPEN (8010-ARCH3-NOT-OPEN)
  5817*        END-EXEC.
  5818*    MOVE '"$I''J                 ! '' #00005697' TO DFHEIV0
  5819     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  5820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 114
* EL690.cbl
  5821     MOVE X'2720233030303035363937' TO DFHEIV0(25:11)
  5822     CALL 'kxdfhei1' USING DFHEIV0
  5823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5824
  5825
  5826
  5827* EXEC CICS STARTBR
  5828*        DATASET  (W-ARCH3-FILE-ID)
  5829*        RIDFLD   (W-ARCH3-KEY)
  5830*        GTEQ
  5831*    END-EXEC.
  5832     MOVE 0
  5833       TO DFHEIV11
  5834*    MOVE '&,         G          &   #00005703' TO DFHEIV0
  5835     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5836     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5837     MOVE X'2020233030303035373033' TO DFHEIV0(25:11)
  5838     CALL 'kxdfhei1' USING DFHEIV0,
  5839           W-ARCH3-FILE-ID,
  5840           W-ARCH3-KEY,
  5841           DFHEIV99,
  5842           DFHEIV11,
  5843           DFHEIV99
  5844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5845
  5846
  5847     PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT.
  5848
  5849
  5850* EXEC CICS HANDLE CONDITION
  5851*        NOTFND  (2200-END-BROWSE)
  5852*        ENDFILE (2200-END-BROWSE)
  5853*        END-EXEC.
  5854*    MOVE '"$I''                  ! ( #00005711' TO DFHEIV0
  5855     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5856     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5857     MOVE X'2820233030303035373131' TO DFHEIV0(25:11)
  5858     CALL 'kxdfhei1' USING DFHEIV0
  5859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5860
  5861
  5862 2200-BUILD-ARCH3-LIST.
  5863
  5864     IF  LA-COMPANY-CD-A3 NOT EQUAL PI-COMPANY-CD
  5865         GO TO 2200-END-BROWSE.
  5866
  5867     IF  PI-690-INIT-FORM EQUAL LOW-VALUES OR HIGH-VALUES
  5868         GO TO 2200-CONTINUE.
  5869
  5870     IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  5871         GO TO 2200-END-BROWSE.
  5872
  5873     IF  PI-690-INIT-CARRIER EQUAL LOW-VALUES OR HIGH-VALUES
  5874         GO TO 2200-CONTINUE.
  5875
  5876     IF  LA-CARRIER-A3 NOT EQUAL PI-690-INIT-CARRIER
  5877         GO TO 2200-END-BROWSE.
  5878
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 115
* EL690.cbl
  5879     IF  PI-690-INIT-GROUPING EQUAL LOW-VALUES OR HIGH-VALUES
  5880         GO TO 2200-CONTINUE.
  5881
  5882     IF  LA-GROUPING-A3 NOT EQUAL PI-690-INIT-GROUPING
  5883         GO TO 2200-END-BROWSE.
  5884
  5885     IF  PI-690-INIT-STATE EQUAL LOW-VALUES OR HIGH-VALUES
  5886         GO TO 2200-CONTINUE.
  5887
  5888     IF  LA-STATE-A3 NOT EQUAL PI-690-INIT-STATE
  5889         GO TO 2200-END-BROWSE.
  5890
  5891     IF  PI-690-INIT-ACCOUNT EQUAL LOW-VALUES OR HIGH-VALUES
  5892         GO TO 2200-CONTINUE.
  5893
  5894     IF  LA-ACCOUNT-A3 NOT EQUAL PI-690-INIT-ACCOUNT
  5895         GO TO 2200-END-BROWSE.
  5896
  5897 2200-CONTINUE.
  5898
  5899     IF  NOT PI-690-SELECT-ALL
  5900             AND
  5901         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  5902         PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT
  5903         GO TO 2200-BUILD-ARCH3-LIST.
  5904
  5905     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  5906                 AND
  5907         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  5908         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  5909             PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT
  5910             GO TO 2200-BUILD-ARCH3-LIST.
  5911
  5912     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  5913                 AND
  5914         PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  5915         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  5916             PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT
  5917             GO TO 2200-BUILD-ARCH3-LIST.
  5918
  5919     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  5920
  5921     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  5922
  5923     IF  W-ARCH-NDX LESS THAN +13
  5924         PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT
  5925         GO TO 2200-BUILD-ARCH3-LIST.
  5926
  5927 2200-END.
  5928
  5929     MOVE -1                     TO CORRSELL.
  5930     MOVE ZEROS                  TO CORRSELO.
  5931     PERFORM 2200-END-BROWSE.
  5932     GO TO 8100-SEND-INITIAL-MAP.
  5933
  5934 2200-END-BROWSE.
  5935
  5936
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 116
* EL690.cbl
  5937* EXEC CICS ENDBR
  5938*        DATASET (W-ARCH3-FILE-ID)
  5939*    END-EXEC.
  5940     MOVE 0
  5941       TO DFHEIV11
  5942*    MOVE '&2                    $   #00005790' TO DFHEIV0
  5943     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5944     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5945     MOVE X'2020233030303035373930' TO DFHEIV0(25:11)
  5946     CALL 'kxdfhei1' USING DFHEIV0,
  5947           W-ARCH3-FILE-ID,
  5948           DFHEIV11,
  5949           DFHEIV99
  5950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5951
  5952
  5953 2200-ARCH3-NOT-FOUND.
  5954
  5955     MOVE ER-0130                TO EMI-ERROR.
  5956     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5957     MOVE -1                     TO CORRSELL.
  5958     MOVE ZEROS                  TO CORRSELO.
  5959     GO TO 8100-SEND-INITIAL-MAP.
  5960
  5961 2200-EXIT.
  5962     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 117
* EL690.cbl
  5964 2300-ARCH4-PROCESS.
  5965
  5966     IF  W-CHANGE-REQUESTED
  5967         MOVE LOW-VALUES         TO W-ARCH4-KEY
  5968         MOVE PI-COMPANY-CD      TO W-ARCH4-COMPANY-CD
  5969         MOVE PI-690-INIT-PROCESSOR
  5970                                 TO W-ARCH4-PROCESSOR
  5971         MOVE PI-690-INIT-CARRIER
  5972                                 TO W-ARCH4-CARRIER
  5973         MOVE PI-690-INIT-GROUPING
  5974                                 TO W-ARCH4-GROUPING
  5975         MOVE PI-690-INIT-STATE  TO W-ARCH4-STATE
  5976         MOVE PI-690-INIT-ACCOUNT
  5977                                 TO W-ARCH4-ACCOUNT
  5978         MOVE PI-690-INIT-ARCHIVE-NO
  5979                                 TO W-ARCH4-ARCHIVE-NO
  5980
  5981     ELSE
  5982         IF  W-FIRST-CHANGE-FOUND
  5983             MOVE LOW-VALUES     TO W-ARCH4-KEY
  5984             MOVE PI-COMPANY-CD  TO W-ARCH4-COMPANY-CD
  5985             MOVE PI-690-FIRST-PROCESSOR
  5986                                 TO W-ARCH4-PROCESSOR
  5987             MOVE PI-690-FIRST-CARRIER
  5988                                 TO W-ARCH4-CARRIER
  5989             MOVE PI-690-FIRST-GROUPING
  5990                                 TO W-ARCH4-GROUPING
  5991             MOVE PI-690-FIRST-STATE
  5992                                 TO W-ARCH4-STATE
  5993             MOVE PI-690-FIRST-ACCOUNT
  5994                                 TO W-ARCH4-ACCOUNT
  5995             MOVE PI-690-FIRST-ARCHIVE-NO
  5996                                 TO W-ARCH4-ARCHIVE-NO
  5997
  5998         ELSE
  5999             MOVE LOW-VALUES     TO W-ARCH4-KEY
  6000             MOVE PI-COMPANY-CD  TO W-ARCH4-COMPANY-CD
  6001             MOVE PI-690-LAST-PROCESSOR
  6002                                 TO W-ARCH4-PROCESSOR
  6003             MOVE PI-690-LAST-CARRIER
  6004                                 TO W-ARCH4-CARRIER
  6005             MOVE PI-690-LAST-GROUPING
  6006                                 TO W-ARCH4-GROUPING
  6007             MOVE PI-690-LAST-STATE
  6008                                 TO W-ARCH4-STATE
  6009             MOVE PI-690-LAST-ACCOUNT
  6010                                 TO W-ARCH4-ACCOUNT
  6011             MOVE PI-690-LAST-ARCHIVE-NO
  6012                                 TO W-ARCH4-ARCHIVE-NO.
  6013
  6014
  6015* EXEC CICS HANDLE CONDITION
  6016*        NOTFND  (8080-ARCH-NOT-FOUND)
  6017*        ENDFILE (8080-ARCH-NOT-FOUND)
  6018*        NOTOPEN (8020-ARCH4-NOT-OPEN)
  6019*        END-EXEC.
  6020*    MOVE '"$I''J                 ! ) #00005855' TO DFHEIV0
  6021     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 118
* EL690.cbl
  6022     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6023     MOVE X'2920233030303035383535' TO DFHEIV0(25:11)
  6024     CALL 'kxdfhei1' USING DFHEIV0
  6025     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6026
  6027
  6028
  6029* EXEC CICS STARTBR
  6030*        DATASET  (W-ARCH4-FILE-ID)
  6031*        RIDFLD   (W-ARCH4-KEY)
  6032*        GTEQ
  6033*    END-EXEC.
  6034     MOVE 0
  6035       TO DFHEIV11
  6036*    MOVE '&,         G          &   #00005861' TO DFHEIV0
  6037     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6038     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6039     MOVE X'2020233030303035383631' TO DFHEIV0(25:11)
  6040     CALL 'kxdfhei1' USING DFHEIV0,
  6041           W-ARCH4-FILE-ID,
  6042           W-ARCH4-KEY,
  6043           DFHEIV99,
  6044           DFHEIV11,
  6045           DFHEIV99
  6046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6047
  6048
  6049     PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT.
  6050
  6051
  6052* EXEC CICS HANDLE CONDITION
  6053*        NOTFND  (2300-END-BROWSE)
  6054*        ENDFILE (2300-END-BROWSE)
  6055*        END-EXEC.
  6056*    MOVE '"$I''                  ! * #00005869' TO DFHEIV0
  6057     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6058     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6059     MOVE X'2A20233030303035383639' TO DFHEIV0(25:11)
  6060     CALL 'kxdfhei1' USING DFHEIV0
  6061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6062
  6063
  6064 2300-BUILD-ARCH4-LIST.
  6065
  6066     IF  LA-COMPANY-CD-A4 NOT EQUAL PI-COMPANY-CD
  6067         GO TO 2300-END-BROWSE.
  6068
  6069     IF  PI-690-INIT-PROCESSOR EQUAL LOW-VALUES OR HIGH-VALUES
  6070         GO TO 2300-CONTINUE.
  6071
  6072     IF  LA-PROCESSOR-CD NOT EQUAL PI-690-INIT-PROCESSOR
  6073         GO TO 2300-END-BROWSE.
  6074
  6075     IF  PI-690-INIT-CARRIER EQUAL LOW-VALUES OR HIGH-VALUES
  6076         GO TO 2300-CONTINUE.
  6077
  6078     IF  LA-CARRIER-A4 NOT EQUAL PI-690-INIT-CARRIER
  6079         GO TO 2300-END-BROWSE.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 119
* EL690.cbl
  6080
  6081     IF  PI-690-INIT-GROUPING EQUAL LOW-VALUES OR HIGH-VALUES
  6082         GO TO 2300-CONTINUE.
  6083
  6084     IF  LA-GROUPING-A4 NOT EQUAL PI-690-INIT-GROUPING
  6085         GO TO 2300-END-BROWSE.
  6086
  6087     IF  PI-690-INIT-STATE EQUAL LOW-VALUES OR HIGH-VALUES
  6088         GO TO 2300-CONTINUE.
  6089
  6090     IF  LA-STATE-A4 NOT EQUAL PI-690-INIT-STATE
  6091         GO TO 2300-END-BROWSE.
  6092
  6093     IF  PI-690-INIT-ACCOUNT EQUAL LOW-VALUES OR HIGH-VALUES
  6094         GO TO 2300-CONTINUE.
  6095
  6096     IF  LA-ACCOUNT-A4 NOT EQUAL PI-690-INIT-ACCOUNT
  6097         GO TO 2300-END-BROWSE.
  6098
  6099 2300-CONTINUE.
  6100
  6101     IF  NOT PI-690-SELECT-ALL
  6102             AND
  6103         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6104         PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT
  6105         GO TO 2300-BUILD-ARCH4-LIST.
  6106
  6107     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  6108                 AND
  6109         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  6110         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  6111             PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT
  6112             GO TO 2300-BUILD-ARCH4-LIST.
  6113
  6114     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6115                 AND
  6116         PI-690-INIT-FORM LESS THAN HIGH-VALUES
  6117         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  6118             PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT
  6119             GO TO 2300-BUILD-ARCH4-LIST.
  6120
  6121     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6122
  6123     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6124
  6125     IF  W-ARCH-NDX LESS THAN +13
  6126         PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT
  6127         GO TO 2300-BUILD-ARCH4-LIST.
  6128
  6129 2300-END.
  6130
  6131     MOVE -1                     TO CORRSELL.
  6132     MOVE ZEROS                  TO CORRSELO.
  6133     PERFORM 2300-END-BROWSE.
  6134     GO TO 8100-SEND-INITIAL-MAP.
  6135
  6136 2300-END-BROWSE.
  6137
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 120
* EL690.cbl
  6138
  6139* EXEC CICS ENDBR
  6140*        DATASET (W-ARCH4-FILE-ID)
  6141*    END-EXEC.
  6142     MOVE 0
  6143       TO DFHEIV11
  6144*    MOVE '&2                    $   #00005948' TO DFHEIV0
  6145     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6146     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6147     MOVE X'2020233030303035393438' TO DFHEIV0(25:11)
  6148     CALL 'kxdfhei1' USING DFHEIV0,
  6149           W-ARCH4-FILE-ID,
  6150           DFHEIV11,
  6151           DFHEIV99
  6152     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6153
  6154
  6155 2300-ARCH4-NOT-FOUND.
  6156
  6157     MOVE ER-0130                TO EMI-ERROR.
  6158     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6159     MOVE -1                     TO CORRSELL.
  6160     MOVE ZEROS                  TO CORRSELO.
  6161     GO TO 8100-SEND-INITIAL-MAP.
  6162
  6163 2300-EXIT.
  6164     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 121
* EL690.cbl
  6166 2400-ARCH5-PROCESS.
  6167
  6168     IF  W-CHANGE-REQUESTED
  6169         MOVE LOW-VALUES         TO W-ARCH5-KEY
  6170         MOVE PI-COMPANY-CD      TO W-ARCH5-COMPANY-CD
  6171         MOVE PI-690-INIT-CARRIER
  6172                                 TO W-ARCH5-CARRIER
  6173         MOVE PI-690-INIT-GROUPING
  6174                                 TO W-ARCH5-GROUPING
  6175         MOVE PI-690-INIT-STATE  TO W-ARCH5-STATE
  6176         MOVE PI-690-INIT-ACCOUNT
  6177                                 TO W-ARCH5-ACCOUNT
  6178         MOVE PI-690-INIT-ARCHIVE-NO
  6179                                 TO W-ARCH5-ARCHIVE-NO
  6180
  6181     ELSE
  6182         IF  W-FIRST-CHANGE-FOUND
  6183             MOVE LOW-VALUES     TO W-ARCH5-KEY
  6184             MOVE PI-COMPANY-CD  TO W-ARCH5-COMPANY-CD
  6185             MOVE PI-690-FIRST-CARRIER
  6186                                 TO W-ARCH5-CARRIER
  6187             MOVE PI-690-FIRST-GROUPING
  6188                                 TO W-ARCH5-GROUPING
  6189             MOVE PI-690-FIRST-STATE
  6190                                 TO W-ARCH5-STATE
  6191             MOVE PI-690-FIRST-ACCOUNT
  6192                                 TO W-ARCH5-ACCOUNT
  6193             MOVE PI-690-FIRST-ARCHIVE-NO
  6194                                 TO W-ARCH5-ARCHIVE-NO
  6195
  6196         ELSE
  6197             MOVE LOW-VALUES     TO W-ARCH5-KEY
  6198             MOVE PI-COMPANY-CD  TO W-ARCH5-COMPANY-CD
  6199             MOVE PI-690-LAST-CARRIER
  6200                                 TO W-ARCH5-CARRIER
  6201             MOVE PI-690-LAST-GROUPING
  6202                                 TO W-ARCH5-GROUPING
  6203             MOVE PI-690-LAST-STATE
  6204                                 TO W-ARCH5-STATE
  6205             MOVE PI-690-LAST-ACCOUNT
  6206                                 TO W-ARCH5-ACCOUNT
  6207             MOVE PI-690-LAST-ARCHIVE-NO
  6208                                 TO W-ARCH5-ARCHIVE-NO.
  6209
  6210
  6211* EXEC CICS HANDLE CONDITION
  6212*        NOTFND  (8080-ARCH-NOT-FOUND)
  6213*        ENDFILE (8080-ARCH-NOT-FOUND)
  6214*        NOTOPEN (8030-ARCH5-NOT-OPEN)
  6215*        END-EXEC.
  6216*    MOVE '"$I''J                 ! + #00006007' TO DFHEIV0
  6217     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  6218     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6219     MOVE X'2B20233030303036303037' TO DFHEIV0(25:11)
  6220     CALL 'kxdfhei1' USING DFHEIV0
  6221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6222
  6223
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 122
* EL690.cbl
  6224
  6225* EXEC CICS STARTBR
  6226*        DATASET  (W-ARCH5-FILE-ID)
  6227*        RIDFLD   (W-ARCH5-KEY)
  6228*        GTEQ
  6229*    END-EXEC.
  6230     MOVE 0
  6231       TO DFHEIV11
  6232*    MOVE '&,         G          &   #00006013' TO DFHEIV0
  6233     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6234     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6235     MOVE X'2020233030303036303133' TO DFHEIV0(25:11)
  6236     CALL 'kxdfhei1' USING DFHEIV0,
  6237           W-ARCH5-FILE-ID,
  6238           W-ARCH5-KEY,
  6239           DFHEIV99,
  6240           DFHEIV11,
  6241           DFHEIV99
  6242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6243
  6244
  6245     PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT.
  6246
  6247
  6248* EXEC CICS HANDLE CONDITION
  6249*        NOTFND  (2400-END-BROWSE)
  6250*        ENDFILE (2400-END-BROWSE)
  6251*        END-EXEC.
  6252*    MOVE '"$I''                  ! , #00006021' TO DFHEIV0
  6253     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6254     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6255     MOVE X'2C20233030303036303231' TO DFHEIV0(25:11)
  6256     CALL 'kxdfhei1' USING DFHEIV0
  6257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6258
  6259
  6260 2400-BUILD-ARCH5-LIST.
  6261
  6262     IF  LA-COMPANY-CD-A5 NOT EQUAL PI-COMPANY-CD
  6263         GO TO 2400-END-BROWSE.
  6264
  6265     IF  PI-690-INIT-CARRIER EQUAL LOW-VALUES OR HIGH-VALUES
  6266         GO TO 2400-CONTINUE.
  6267
  6268     IF  LA-CARRIER-A5 NOT EQUAL PI-690-INIT-CARRIER
  6269         GO TO 2400-END-BROWSE.
  6270
  6271     IF  PI-690-INIT-GROUPING EQUAL LOW-VALUES OR HIGH-VALUES
  6272         GO TO 2400-CONTINUE.
  6273
  6274     IF  LA-GROUPING-A5 NOT EQUAL PI-690-INIT-GROUPING
  6275         GO TO 2400-END-BROWSE.
  6276
  6277     IF  PI-690-INIT-STATE EQUAL LOW-VALUES OR HIGH-VALUES
  6278         GO TO 2400-CONTINUE.
  6279
  6280     IF  LA-STATE-A5 NOT EQUAL PI-690-INIT-STATE
  6281         GO TO 2400-END-BROWSE.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 123
* EL690.cbl
  6282
  6283     IF  PI-690-INIT-ACCOUNT EQUAL LOW-VALUES OR HIGH-VALUES
  6284         GO TO 2400-CONTINUE.
  6285
  6286     IF  LA-ACCOUNT-A5 NOT EQUAL PI-690-INIT-ACCOUNT
  6287         GO TO 2400-END-BROWSE.
  6288
  6289 2400-CONTINUE.
  6290
  6291     IF  NOT PI-690-SELECT-ALL
  6292             AND
  6293         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6294         PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6295         GO TO 2400-BUILD-ARCH5-LIST.
  6296
  6297     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  6298                 AND
  6299         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  6300         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  6301             PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6302             GO TO 2400-BUILD-ARCH5-LIST.
  6303
  6304     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6305                 AND
  6306         PI-690-INIT-FORM LESS THAN HIGH-VALUES
  6307         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  6308             PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6309             GO TO 2400-BUILD-ARCH5-LIST.
  6310
  6311     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  6312                 AND
  6313         PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  6314         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  6315             PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6316             GO TO 2400-BUILD-ARCH5-LIST.
  6317
  6318     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6319
  6320     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6321
  6322     IF  W-ARCH-NDX LESS THAN +13
  6323         PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6324         GO TO 2400-BUILD-ARCH5-LIST.
  6325
  6326 2400-END.
  6327
  6328     MOVE -1                     TO CORRSELL.
  6329     MOVE ZEROS                  TO CORRSELO.
  6330     PERFORM 2400-END-BROWSE.
  6331     GO TO 8100-SEND-INITIAL-MAP.
  6332
  6333 2400-END-BROWSE.
  6334
  6335
  6336* EXEC CICS ENDBR
  6337*        DATASET (W-ARCH5-FILE-ID)
  6338*    END-EXEC.
  6339     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 124
* EL690.cbl
  6340       TO DFHEIV11
  6341*    MOVE '&2                    $   #00006101' TO DFHEIV0
  6342     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6343     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6344     MOVE X'2020233030303036313031' TO DFHEIV0(25:11)
  6345     CALL 'kxdfhei1' USING DFHEIV0,
  6346           W-ARCH5-FILE-ID,
  6347           DFHEIV11,
  6348           DFHEIV99
  6349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6350
  6351
  6352 2400-ARCH5-NOT-FOUND.
  6353
  6354     MOVE ER-0130                TO EMI-ERROR.
  6355     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6356     MOVE -1                     TO CORRSELL.
  6357     MOVE ZEROS                  TO CORRSELO.
  6358     GO TO 8100-SEND-INITIAL-MAP.
  6359
  6360 2400-EXIT.
  6361     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 125
* EL690.cbl
  6363 2500-ARCH6-PROCESS.
  6364
  6365     IF  W-CHANGE-REQUESTED
  6366         MOVE LOW-VALUES         TO W-ARCH6-KEY
  6367         MOVE PI-COMPANY-CD      TO W-ARCH6-COMPANY-CD
  6368         MOVE PI-690-INIT-ENTRY  TO W-ARCH6-ENTRY
  6369         MOVE PI-690-INIT-ARCHIVE-NO
  6370                                 TO W-ARCH6-ARCHIVE-NO
  6371
  6372     ELSE
  6373         IF  W-FIRST-CHANGE-FOUND
  6374             MOVE LOW-VALUES     TO W-ARCH6-KEY
  6375             MOVE PI-COMPANY-CD  TO W-ARCH6-COMPANY-CD
  6376             MOVE PI-690-FIRST-ENTRY
  6377                                 TO W-ARCH6-ENTRY
  6378             MOVE PI-690-FIRST-ARCHIVE-NO
  6379                                 TO W-ARCH6-ARCHIVE-NO
  6380
  6381         ELSE
  6382             MOVE LOW-VALUES     TO W-ARCH6-KEY
  6383             MOVE PI-COMPANY-CD  TO W-ARCH6-COMPANY-CD
  6384             MOVE PI-690-LAST-ENTRY
  6385                                 TO W-ARCH6-ENTRY
  6386             MOVE PI-690-LAST-ARCHIVE-NO
  6387                                 TO W-ARCH6-ARCHIVE-NO.
  6388
  6389
  6390* EXEC CICS HANDLE CONDITION
  6391*        NOTFND  (8080-ARCH-NOT-FOUND)
  6392*        ENDFILE (8080-ARCH-NOT-FOUND)
  6393*        NOTOPEN (8040-ARCH6-NOT-OPEN)
  6394*        END-EXEC.
  6395*    MOVE '"$I''J                 ! - #00006142' TO DFHEIV0
  6396     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  6397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6398     MOVE X'2D20233030303036313432' TO DFHEIV0(25:11)
  6399     CALL 'kxdfhei1' USING DFHEIV0
  6400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6401
  6402
  6403
  6404* EXEC CICS STARTBR
  6405*        DATASET  (W-ARCH6-FILE-ID)
  6406*        RIDFLD   (W-ARCH6-KEY)
  6407*        GTEQ
  6408*    END-EXEC.
  6409     MOVE 0
  6410       TO DFHEIV11
  6411*    MOVE '&,         G          &   #00006148' TO DFHEIV0
  6412     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6413     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6414     MOVE X'2020233030303036313438' TO DFHEIV0(25:11)
  6415     CALL 'kxdfhei1' USING DFHEIV0,
  6416           W-ARCH6-FILE-ID,
  6417           W-ARCH6-KEY,
  6418           DFHEIV99,
  6419           DFHEIV11,
  6420           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 126
* EL690.cbl
  6421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6422
  6423
  6424     PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT.
  6425
  6426
  6427* EXEC CICS HANDLE CONDITION
  6428*        NOTFND  (2500-END-BROWSE)
  6429*        ENDFILE (2500-END-BROWSE)
  6430*        END-EXEC.
  6431*    MOVE '"$I''                  ! . #00006156' TO DFHEIV0
  6432     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6433     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6434     MOVE X'2E20233030303036313536' TO DFHEIV0(25:11)
  6435     CALL 'kxdfhei1' USING DFHEIV0
  6436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6437
  6438
  6439 2500-BUILD-ARCH6-LIST.
  6440
  6441     IF  LA-COMPANY-CD-A6 NOT EQUAL PI-COMPANY-CD
  6442         GO TO 2500-END-BROWSE.
  6443
  6444     IF  PI-690-INIT-ENTRY EQUAL LOW-VALUES OR HIGH-VALUES
  6445         GO TO 2500-CONTINUE.
  6446
  6447     IF  LA-ENTRY-A6 NOT EQUAL PI-690-INIT-ENTRY
  6448         GO TO 2500-END-BROWSE.
  6449
  6450 2500-CONTINUE.
  6451
  6452     IF  NOT PI-690-SELECT-ALL
  6453             AND
  6454         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6455         PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6456         GO TO 2500-BUILD-ARCH6-LIST.
  6457
  6458     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  6459             AND
  6460         PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  6461         IF  LA-ENTRY-A6 NOT EQUAL PI-690-INIT-PROCESSOR
  6462             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6463             GO TO 2500-BUILD-ARCH6-LIST.
  6464
  6465     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6466             AND
  6467         PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  6468         IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  6469             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6470             GO TO 2500-BUILD-ARCH6-LIST.
  6471
  6472     IF  PI-690-INIT-CARRIER NOT EQUAL LOW-VALUES
  6473             AND
  6474         PI-690-INIT-CARRIER NOT EQUAL HIGH-VALUES
  6475         IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  6476             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6477             GO TO 2500-BUILD-ARCH6-LIST.
  6478
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 127
* EL690.cbl
  6479     IF  PI-690-INIT-GROUPING NOT EQUAL LOW-VALUES
  6480             AND
  6481         PI-690-INIT-GROUPING NOT EQUAL HIGH-VALUES
  6482         IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  6483             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6484             GO TO 2500-BUILD-ARCH6-LIST.
  6485
  6486     IF  PI-690-INIT-STATE NOT EQUAL LOW-VALUES
  6487             AND
  6488         PI-690-INIT-STATE NOT EQUAL HIGH-VALUES
  6489         IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  6490             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6491             GO TO 2500-BUILD-ARCH6-LIST.
  6492
  6493     IF  PI-690-INIT-ACCOUNT NOT EQUAL LOW-VALUES
  6494             AND
  6495         PI-690-INIT-ACCOUNT NOT EQUAL HIGH-VALUES
  6496         IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  6497             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6498             GO TO 2500-BUILD-ARCH6-LIST.
  6499
  6500     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6501
  6502     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6503
  6504     IF  W-ARCH-NDX LESS THAN +13
  6505         PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6506         GO TO 2500-BUILD-ARCH6-LIST.
  6507
  6508 2500-END.
  6509
  6510     MOVE -1                     TO CORRSELL.
  6511     MOVE ZEROS                  TO CORRSELO.
  6512     PERFORM 2500-END-BROWSE.
  6513     GO TO 8100-SEND-INITIAL-MAP.
  6514
  6515 2500-END-BROWSE.
  6516
  6517
  6518* EXEC CICS ENDBR
  6519*        DATASET (W-ARCH6-FILE-ID)
  6520*    END-EXEC.
  6521     MOVE 0
  6522       TO DFHEIV11
  6523*    MOVE '&2                    $   #00006239' TO DFHEIV0
  6524     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6525     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6526     MOVE X'2020233030303036323339' TO DFHEIV0(25:11)
  6527     CALL 'kxdfhei1' USING DFHEIV0,
  6528           W-ARCH6-FILE-ID,
  6529           DFHEIV11,
  6530           DFHEIV99
  6531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6532
  6533
  6534 2500-ARCH6-NOT-FOUND.
  6535
  6536     MOVE ER-0130                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 128
* EL690.cbl
  6537     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6538     MOVE -1                     TO CORRSELL.
  6539     MOVE ZEROS                  TO CORRSELO.
  6540     GO TO 8100-SEND-INITIAL-MAP.
  6541
  6542 2500-EXIT.
  6543     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 129
* EL690.cbl
  6545 2600-ARCH-PROCESS.
  6546
  6547     IF  W-CHANGE-REQUESTED
  6548         MOVE LOW-VALUES         TO W-ARCH-KEY
  6549         MOVE PI-COMPANY-CD      TO W-ARCH-COMPANY-CD
  6550         MOVE PI-690-INIT-ARCHIVE-NO
  6551                                 TO W-ARCH-ARCHIVE-NO
  6552
  6553     ELSE
  6554         IF  W-FIRST-CHANGE-FOUND
  6555             MOVE LOW-VALUES     TO W-ARCH-KEY
  6556             MOVE PI-COMPANY-CD  TO W-ARCH-COMPANY-CD
  6557             MOVE PI-690-FIRST-ARCHIVE-NO
  6558                                 TO W-ARCH-ARCHIVE-NO
  6559
  6560         ELSE
  6561             MOVE LOW-VALUES     TO W-ARCH-KEY
  6562             MOVE PI-COMPANY-CD  TO W-ARCH-COMPANY-CD
  6563             MOVE PI-690-LAST-ARCHIVE-NO
  6564                                 TO W-ARCH-ARCHIVE-NO.
  6565
  6566
  6567* EXEC CICS HANDLE CONDITION
  6568*        NOTFND  (8080-ARCH-NOT-FOUND)
  6569*        ENDFILE (8080-ARCH-NOT-FOUND)
  6570*        NOTOPEN (8050-ARCH-NOT-OPEN)
  6571*        END-EXEC.
  6572*    MOVE '"$I''J                 ! / #00006275' TO DFHEIV0
  6573     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  6574     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6575     MOVE X'2F20233030303036323735' TO DFHEIV0(25:11)
  6576     CALL 'kxdfhei1' USING DFHEIV0
  6577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6578
  6579
  6580
  6581* EXEC CICS STARTBR
  6582*        DATASET  (W-ARCH-FILE-ID)
  6583*        RIDFLD   (W-ARCH-KEY)
  6584*        GTEQ
  6585*    END-EXEC.
  6586     MOVE 0
  6587       TO DFHEIV11
  6588*    MOVE '&,         G          &   #00006281' TO DFHEIV0
  6589     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6590     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6591     MOVE X'2020233030303036323831' TO DFHEIV0(25:11)
  6592     CALL 'kxdfhei1' USING DFHEIV0,
  6593           W-ARCH-FILE-ID,
  6594           W-ARCH-KEY,
  6595           DFHEIV99,
  6596           DFHEIV11,
  6597           DFHEIV99
  6598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6599
  6600
  6601     PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT.
  6602
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 130
* EL690.cbl
  6603
  6604* EXEC CICS HANDLE CONDITION
  6605*        NOTFND  (2600-END-BROWSE)
  6606*        ENDFILE (2600-END-BROWSE)
  6607*        END-EXEC.
  6608*    MOVE '"$I''                  ! 0 #00006289' TO DFHEIV0
  6609     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6610     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6611     MOVE X'3020233030303036323839' TO DFHEIV0(25:11)
  6612     CALL 'kxdfhei1' USING DFHEIV0
  6613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6614
  6615
  6616 2600-BUILD-ARCH-LIST.
  6617
  6618     IF  LA-COMPANY-CD NOT EQUAL PI-COMPANY-CD
  6619         GO TO 2600-END-BROWSE.
  6620
  6621     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  6622             AND
  6623         PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  6624         IF  LA-PROCESSOR-CD NOT EQUAL PI-690-INIT-PROCESSOR
  6625             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6626             GO TO 2600-BUILD-ARCH-LIST.
  6627
  6628     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6629             AND
  6630         PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  6631         IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  6632             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6633             GO TO 2600-BUILD-ARCH-LIST.
  6634
  6635     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  6636             AND
  6637         PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  6638         IF  LA-ENTRY-A6 NOT EQUAL PI-690-INIT-ENTRY
  6639             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6640             GO TO 2600-BUILD-ARCH-LIST.
  6641
  6642     IF  PI-690-INIT-CARRIER NOT EQUAL LOW-VALUES
  6643             AND
  6644         PI-690-INIT-CARRIER NOT EQUAL HIGH-VALUES
  6645         IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  6646             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6647             GO TO 2600-BUILD-ARCH-LIST.
  6648
  6649     IF  PI-690-INIT-GROUPING NOT EQUAL LOW-VALUES
  6650             AND
  6651         PI-690-INIT-GROUPING NOT EQUAL HIGH-VALUES
  6652         IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  6653             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6654             GO TO 2600-BUILD-ARCH-LIST.
  6655
  6656     IF  PI-690-INIT-STATE NOT EQUAL LOW-VALUES
  6657             AND
  6658         PI-690-INIT-STATE NOT EQUAL HIGH-VALUES
  6659         IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  6660             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 131
* EL690.cbl
  6661             GO TO 2600-BUILD-ARCH-LIST.
  6662
  6663     IF  PI-690-INIT-ACCOUNT NOT EQUAL LOW-VALUES
  6664             AND
  6665         PI-690-INIT-ACCOUNT NOT EQUAL HIGH-VALUES
  6666         IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  6667             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6668             GO TO 2600-BUILD-ARCH-LIST.
  6669
  6670 2600-CONTINUE.
  6671
  6672     IF  NOT PI-690-SELECT-ALL
  6673             AND
  6674         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6675         PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6676         GO TO 2600-BUILD-ARCH-LIST.
  6677
  6678     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6679
  6680     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6681
  6682     IF  W-ARCH-NDX LESS THAN +13
  6683         PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6684         GO TO 2600-BUILD-ARCH-LIST.
  6685
  6686 2600-END.
  6687
  6688     MOVE -1                     TO CORRSELL.
  6689     MOVE ZEROS                  TO CORRSELO.
  6690     PERFORM 2600-END-BROWSE.
  6691     GO TO 8100-SEND-INITIAL-MAP.
  6692
  6693 2600-END-BROWSE.
  6694
  6695
  6696* EXEC CICS ENDBR
  6697*        DATASET (W-ARCH-FILE-ID)
  6698*    END-EXEC.
  6699     MOVE 0
  6700       TO DFHEIV11
  6701*    MOVE '&2                    $   #00006373' TO DFHEIV0
  6702     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6703     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6704     MOVE X'2020233030303036333733' TO DFHEIV0(25:11)
  6705     CALL 'kxdfhei1' USING DFHEIV0,
  6706           W-ARCH-FILE-ID,
  6707           DFHEIV11,
  6708           DFHEIV99
  6709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6710
  6711
  6712 2600-ARCH-NOT-FOUND.
  6713
  6714     MOVE ER-0130                TO EMI-ERROR.
  6715     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6716     MOVE -1                     TO CORRSELL.
  6717     MOVE ZEROS                  TO CORRSELO.
  6718     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 132
* EL690.cbl
  6719
  6720 2600-EXIT.
  6721     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 133
* EL690.cbl
  6723 3000-PAGE-BACKWARD.
  6724
  6725     MOVE '2'                    TO PI-690-LAST-BROWSE-IND.
  6726     MOVE +1                     TO W-ARCH-NDX
  6727                                    W-ARCH-NDX2.
  6728     MOVE ZEROS                  TO W-ARCH-NUMBER.
  6729
  6730     GO TO 3100-ARCH2-PROCESS
  6731           3200-ARCH3-PROCESS
  6732           3300-ARCH4-PROCESS
  6733           3400-ARCH5-PROCESS
  6734           3500-ARCH6-PROCESS
  6735           3600-ARCH-PROCESS DEPENDING ON PI-690-BRWS-TYPE-IND.
  6736
  6737     MOVE ER-7384                TO EMI-ERROR.
  6738     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6739     MOVE -1                     TO TYPEBRL.
  6740     MOVE AL-UABON               TO TYPEBRA.
  6741     GO TO 8100-SEND-INITIAL-MAP.
  6742
  6743 3000-EXIT.
  6744     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 134
* EL690.cbl
  6746 3100-ARCH2-PROCESS.
  6747
  6748     IF  W-CHANGE-REQUESTED
  6749         MOVE HIGH-VALUES        TO W-ARCH2-KEY
  6750         MOVE PI-COMPANY-CD      TO W-ARCH2-COMPANY-CD
  6751         MOVE PI-690-INIT-CERT-PRIME
  6752                                 TO W-ARCH2-CERT-PRIME
  6753         MOVE PI-690-INIT-SUFFIX TO W-ARCH2-SUFFIX
  6754         MOVE PI-690-INIT-CARRIER
  6755                                 TO W-ARCH2-CARRIER
  6756         MOVE PI-690-INIT-GROUPING
  6757                                 TO W-ARCH2-GROUPING
  6758         MOVE PI-690-INIT-STATE  TO W-ARCH2-STATE
  6759         MOVE PI-690-INIT-ACCOUNT
  6760                                 TO W-ARCH2-ACCOUNT
  6761         MOVE PI-690-INIT-EFFECT-DATE
  6762                                 TO W-ARCH2-EFF-DTE
  6763
  6764
  6765     ELSE
  6766         IF  W-FIRST-CHANGE-FOUND
  6767             MOVE HIGH-VALUES    TO W-ARCH2-KEY
  6768             MOVE PI-COMPANY-CD  TO W-ARCH2-COMPANY-CD
  6769             MOVE PI-690-LAST-CERT-PRIME
  6770                                 TO W-ARCH2-CERT-PRIME
  6771             MOVE PI-690-LAST-SUFFIX
  6772                                 TO W-ARCH2-SUFFIX
  6773             MOVE PI-690-LAST-CARRIER
  6774                                 TO W-ARCH2-CARRIER
  6775             MOVE PI-690-LAST-GROUPING
  6776                                 TO W-ARCH2-GROUPING
  6777             MOVE PI-690-LAST-STATE
  6778                                 TO W-ARCH2-STATE
  6779             MOVE PI-690-LAST-ACCOUNT
  6780                                 TO W-ARCH2-ACCOUNT
  6781             MOVE PI-690-LAST-EFFECT-DATE
  6782                                 TO W-ARCH2-EFF-DTE
  6783
  6784         ELSE
  6785             MOVE PI-COMPANY-CD  TO W-ARCH2-COMPANY-CD
  6786             MOVE PI-690-FIRST-CERT-PRIME
  6787                                 TO W-ARCH2-CERT-PRIME
  6788             MOVE PI-690-FIRST-SUFFIX
  6789                                 TO W-ARCH2-SUFFIX
  6790             MOVE PI-690-FIRST-CARRIER
  6791                                 TO W-ARCH2-CARRIER
  6792             MOVE PI-690-FIRST-GROUPING
  6793                                 TO W-ARCH2-GROUPING
  6794             MOVE PI-690-FIRST-STATE
  6795                                 TO W-ARCH2-STATE
  6796             MOVE PI-690-FIRST-ACCOUNT
  6797                                 TO W-ARCH2-ACCOUNT
  6798             MOVE PI-690-FIRST-EFFECT-DATE
  6799                                 TO W-ARCH2-EFF-DTE
  6800             MOVE PI-690-FIRST-ARCHIVE-NO
  6801                                 TO W-ARCH2-ARCHIVE-NO.
  6802
  6803
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 135
* EL690.cbl
  6804* EXEC CICS HANDLE CONDITION
  6805*        NOTFND  (8080-ARCH-NOT-FOUND)
  6806*        ENDFILE (8080-ARCH-NOT-FOUND)
  6807*        NOTOPEN (8000-ARCH2-NOT-OPEN)
  6808*        END-EXEC.
  6809*    MOVE '"$I''J                 ! 1 #00006468' TO DFHEIV0
  6810     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  6811     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6812     MOVE X'3120233030303036343638' TO DFHEIV0(25:11)
  6813     CALL 'kxdfhei1' USING DFHEIV0
  6814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6815
  6816
  6817
  6818* EXEC CICS STARTBR
  6819*        DATASET  (W-ARCH2-FILE-ID)
  6820*        RIDFLD   (W-ARCH2-KEY)
  6821*        GTEQ
  6822*        END-EXEC.
  6823     MOVE 0
  6824       TO DFHEIV11
  6825*    MOVE '&,         G          &   #00006474' TO DFHEIV0
  6826     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6827     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6828     MOVE X'2020233030303036343734' TO DFHEIV0(25:11)
  6829     CALL 'kxdfhei1' USING DFHEIV0,
  6830           W-ARCH2-FILE-ID,
  6831           W-ARCH2-KEY,
  6832           DFHEIV99,
  6833           DFHEIV11,
  6834           DFHEIV99
  6835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6836
  6837
  6838
  6839* EXEC CICS HANDLE CONDITION
  6840*        NOTFND  (3100-END-BROWSE)
  6841*        ENDFILE (3100-END-BROWSE)
  6842*        END-EXEC.
  6843*    MOVE '"$I''                  ! 2 #00006480' TO DFHEIV0
  6844     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6845     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6846     MOVE X'3220233030303036343830' TO DFHEIV0(25:11)
  6847     CALL 'kxdfhei1' USING DFHEIV0
  6848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6849
  6850
  6851     PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT.
  6852
  6853     IF  W-CHANGE-REQUESTED
  6854             OR
  6855         W-READ-PREV-TWICE
  6856         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  6857         PERFORM 7050-READ-PREV-ARCH2 THRU 7050-EXIT.
  6858
  6859 3100-BUILD-ARCH2-LIST-BACKWARD.
  6860
  6861     PERFORM 7050-READ-PREV-ARCH2 THRU 7050-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 136
* EL690.cbl
  6862
  6863     IF  LA-COMPANY-CD-A2 NOT EQUAL PI-COMPANY-CD
  6864         GO TO 3100-END.
  6865
  6866     IF  PI-690-INIT-CERT-NO EQUAL HIGH-VALUES OR LOW-VALUES
  6867         GO TO 3100-CONTINUE.
  6868
  6869     IF  LA-CERT-NO-A2 NOT EQUAL PI-690-INIT-CERT-NO
  6870         GO TO 3100-END-BROWSE.
  6871
  6872     IF  PI-690-INIT-CARRIER EQUAL HIGH-VALUES OR LOW-VALUES
  6873         GO TO 3100-CONTINUE.
  6874
  6875     IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  6876         GO TO 3100-END-BROWSE.
  6877
  6878     IF  PI-690-INIT-GROUPING EQUAL HIGH-VALUES OR LOW-VALUES
  6879         GO TO 3100-CONTINUE.
  6880
  6881     IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  6882         GO TO 3100-END-BROWSE.
  6883
  6884     IF  PI-690-INIT-STATE EQUAL HIGH-VALUES OR LOW-VALUES
  6885         GO TO 3100-CONTINUE.
  6886
  6887     IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  6888         GO TO 3100-END-BROWSE.
  6889
  6890     IF  PI-690-INIT-ACCOUNT EQUAL HIGH-VALUES OR LOW-VALUES
  6891         GO TO 3100-CONTINUE.
  6892
  6893     IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  6894         GO TO 3100-END-BROWSE.
  6895
  6896     IF  PI-690-INIT-EFFECT-DATE = LOW-VALUES OR HIGH-VALUES
  6897         GO TO 3100-CONTINUE.
  6898
  6899     IF  LA-EFFECT-DATE-A2 NOT EQUAL PI-690-INIT-EFFECT-DATE
  6900         GO TO 3100-END-BROWSE.
  6901
  6902 3100-CONTINUE.
  6903
  6904     IF  NOT PI-690-SELECT-ALL
  6905             AND
  6906         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6907         GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
  6908
  6909     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  6910             AND
  6911         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  6912         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  6913             GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
  6914
  6915     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  6916             AND
  6917         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6918         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  6919             GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 137
* EL690.cbl
  6920
  6921     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  6922             AND
  6923         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  6924         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  6925             GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
  6926
  6927     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6928
  6929     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6930
  6931     IF  W-ARCH-NDX LESS THAN +13
  6932         GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
  6933
  6934 3100-END.
  6935
  6936     MOVE -1                     TO CORRSELL.
  6937     MOVE ZEROS                  TO CORRSELO.
  6938     PERFORM 3100-END-BROWSE
  6939     GO TO 8100-SEND-INITIAL-MAP.
  6940
  6941 3100-END-BROWSE.
  6942
  6943     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  6944     SUBTRACT +1 FROM W-ARCH-NDX3.
  6945
  6946     IF  W-ARCH-NDX3 GREATER THAN +1
  6947         MOVE +1 TO W-ARCH-NDX2
  6948         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  6949                 UNTIL
  6950             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  6951
  6952
  6953* EXEC CICS ENDBR
  6954*        DATASET (W-ARCH2-FILE-ID)
  6955*    END-EXEC.
  6956     MOVE 0
  6957       TO DFHEIV11
  6958*    MOVE '&2                    $   #00006586' TO DFHEIV0
  6959     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6960     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6961     MOVE X'2020233030303036353836' TO DFHEIV0(25:11)
  6962     CALL 'kxdfhei1' USING DFHEIV0,
  6963           W-ARCH2-FILE-ID,
  6964           DFHEIV11,
  6965           DFHEIV99
  6966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6967
  6968
  6969 3100-FRONT-OF-FILE.
  6970
  6971     MOVE ER-0131                TO EMI-ERROR.
  6972     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6973     MOVE -1                     TO CORRSELL.
  6974     MOVE ZEROS                  TO CORRSELO.
  6975     GO TO 8100-SEND-INITIAL-MAP.
  6976
  6977 3100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 138
* EL690.cbl
  6978     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 139
* EL690.cbl
  6980 3200-ARCH3-PROCESS.
  6981
  6982     IF  W-CHANGE-REQUESTED
  6983         MOVE HIGH-VALUES        TO W-ARCH3-KEY
  6984         MOVE PI-COMPANY-CD      TO W-ARCH3-COMPANY-CD
  6985         MOVE PI-690-INIT-FORM   TO W-ARCH3-FORM
  6986         MOVE PI-690-INIT-CARRIER
  6987                                 TO W-ARCH3-CARRIER
  6988         MOVE PI-690-INIT-GROUPING
  6989                                 TO W-ARCH3-GROUPING
  6990         MOVE PI-690-INIT-STATE  TO W-ARCH3-STATE
  6991         MOVE PI-690-INIT-ACCOUNT
  6992                                 TO W-ARCH3-ACCOUNT
  6993
  6994     ELSE
  6995         IF  W-FIRST-CHANGE-FOUND
  6996             MOVE HIGH-VALUES    TO W-ARCH3-KEY
  6997             MOVE PI-COMPANY-CD  TO W-ARCH3-COMPANY-CD
  6998             MOVE PI-690-LAST-FORM
  6999                                 TO W-ARCH3-FORM
  7000             MOVE PI-690-LAST-CARRIER
  7001                                 TO W-ARCH3-CARRIER
  7002             MOVE PI-690-LAST-GROUPING
  7003                                 TO W-ARCH3-GROUPING
  7004             MOVE PI-690-LAST-STATE
  7005                                 TO W-ARCH3-STATE
  7006             MOVE PI-690-LAST-ACCOUNT
  7007                                 TO W-ARCH3-ACCOUNT
  7008
  7009         ELSE
  7010             MOVE PI-COMPANY-CD  TO W-ARCH3-COMPANY-CD
  7011             MOVE PI-690-FIRST-FORM
  7012                                 TO W-ARCH3-FORM
  7013             MOVE PI-690-FIRST-CARRIER
  7014                                 TO W-ARCH3-CARRIER
  7015             MOVE PI-690-FIRST-GROUPING
  7016                                 TO W-ARCH3-GROUPING
  7017             MOVE PI-690-FIRST-STATE
  7018                                 TO W-ARCH3-STATE
  7019             MOVE PI-690-FIRST-ACCOUNT
  7020                                 TO W-ARCH3-ACCOUNT
  7021             MOVE PI-690-FIRST-ARCHIVE-NO
  7022                                 TO W-ARCH3-ARCHIVE-NO.
  7023
  7024
  7025* EXEC CICS HANDLE CONDITION
  7026*        NOTFND  (8080-ARCH-NOT-FOUND)
  7027*        ENDFILE (8080-ARCH-NOT-FOUND)
  7028*        NOTOPEN (8010-ARCH3-NOT-OPEN)
  7029*        END-EXEC.
  7030*    MOVE '"$I''J                 ! 3 #00006645' TO DFHEIV0
  7031     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7032     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7033     MOVE X'3320233030303036363435' TO DFHEIV0(25:11)
  7034     CALL 'kxdfhei1' USING DFHEIV0
  7035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7036
  7037
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 140
* EL690.cbl
  7038
  7039* EXEC CICS STARTBR
  7040*        DATASET  (W-ARCH3-FILE-ID)
  7041*        RIDFLD   (W-ARCH3-KEY)
  7042*        GTEQ
  7043*        END-EXEC.
  7044     MOVE 0
  7045       TO DFHEIV11
  7046*    MOVE '&,         G          &   #00006651' TO DFHEIV0
  7047     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7048     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7049     MOVE X'2020233030303036363531' TO DFHEIV0(25:11)
  7050     CALL 'kxdfhei1' USING DFHEIV0,
  7051           W-ARCH3-FILE-ID,
  7052           W-ARCH3-KEY,
  7053           DFHEIV99,
  7054           DFHEIV11,
  7055           DFHEIV99
  7056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7057
  7058
  7059
  7060* EXEC CICS HANDLE CONDITION
  7061*        NOTFND  (3200-END-BROWSE)
  7062*        ENDFILE (3200-END-BROWSE)
  7063*        END-EXEC.
  7064*    MOVE '"$I''                  ! 4 #00006657' TO DFHEIV0
  7065     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7066     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7067     MOVE X'3420233030303036363537' TO DFHEIV0(25:11)
  7068     CALL 'kxdfhei1' USING DFHEIV0
  7069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7070
  7071
  7072     PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT.
  7073
  7074     IF  W-CHANGE-REQUESTED
  7075             OR
  7076         W-READ-PREV-TWICE
  7077         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7078         PERFORM 7150-READ-PREV-ARCH3 THRU 7150-EXIT.
  7079
  7080 3200-BUILD-ARCH3-LIST-BACKWARD.
  7081
  7082     PERFORM 7150-READ-PREV-ARCH3 THRU 7150-EXIT.
  7083
  7084     IF  LA-COMPANY-CD-A3 NOT EQUAL PI-COMPANY-CD
  7085         GO TO 3200-END.
  7086
  7087     IF  PI-690-INIT-FORM EQUAL HIGH-VALUES OR LOW-VALUES
  7088         GO TO 3200-CONTINUE.
  7089
  7090     IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  7091         GO TO 3200-END-BROWSE.
  7092
  7093     IF  PI-690-INIT-CARRIER EQUAL HIGH-VALUES OR LOW-VALUES
  7094         GO TO 3200-CONTINUE.
  7095
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 141
* EL690.cbl
  7096     IF  LA-CARRIER-A3 NOT EQUAL PI-690-INIT-CARRIER
  7097         GO TO 3200-END-BROWSE.
  7098
  7099     IF  PI-690-INIT-GROUPING EQUAL HIGH-VALUES OR LOW-VALUES
  7100         GO TO 3200-CONTINUE.
  7101
  7102     IF  LA-GROUPING-A3 NOT EQUAL PI-690-INIT-GROUPING
  7103         GO TO 3200-END-BROWSE.
  7104
  7105     IF  PI-690-INIT-STATE EQUAL HIGH-VALUES OR LOW-VALUES
  7106         GO TO 3200-CONTINUE.
  7107
  7108     IF  LA-STATE-A3 NOT EQUAL PI-690-INIT-STATE
  7109         GO TO 3200-END-BROWSE.
  7110
  7111     IF  PI-690-INIT-ACCOUNT EQUAL HIGH-VALUES OR LOW-VALUES
  7112         GO TO 3200-CONTINUE.
  7113
  7114     IF  LA-ACCOUNT-A3 NOT EQUAL PI-690-INIT-ACCOUNT
  7115         GO TO 3200-END-BROWSE.
  7116
  7117 3200-CONTINUE.
  7118
  7119     IF  NOT PI-690-SELECT-ALL
  7120             AND
  7121         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7122         GO TO 3200-BUILD-ARCH3-LIST-BACKWARD.
  7123
  7124     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  7125             AND
  7126         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  7127         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  7128             GO TO 3200-BUILD-ARCH3-LIST-BACKWARD.
  7129
  7130     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  7131             AND
  7132         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  7133         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  7134             GO TO 3200-BUILD-ARCH3-LIST-BACKWARD.
  7135
  7136     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7137
  7138     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7139
  7140     IF  W-ARCH-NDX LESS THAN +13
  7141         GO TO 3200-BUILD-ARCH3-LIST-BACKWARD.
  7142
  7143 3200-END.
  7144
  7145     MOVE -1                     TO CORRSELL.
  7146     MOVE ZEROS                  TO CORRSELO.
  7147     PERFORM 3200-END-BROWSE.
  7148     GO TO 8100-SEND-INITIAL-MAP.
  7149
  7150 3200-END-BROWSE.
  7151
  7152     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  7153     SUBTRACT +1 FROM W-ARCH-NDX3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 142
* EL690.cbl
  7154
  7155     IF  W-ARCH-NDX3 GREATER THAN +1
  7156         MOVE +1 TO W-ARCH-NDX2
  7157         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7158                 UNTIL
  7159             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7160
  7161
  7162* EXEC CICS ENDBR
  7163*        DATASET (W-ARCH3-FILE-ID)
  7164*    END-EXEC.
  7165     MOVE 0
  7166       TO DFHEIV11
  7167*    MOVE '&2                    $   #00006751' TO DFHEIV0
  7168     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7169     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7170     MOVE X'2020233030303036373531' TO DFHEIV0(25:11)
  7171     CALL 'kxdfhei1' USING DFHEIV0,
  7172           W-ARCH3-FILE-ID,
  7173           DFHEIV11,
  7174           DFHEIV99
  7175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7176
  7177
  7178 3200-FRONT-OF-FILE.
  7179
  7180     MOVE ER-0131                TO EMI-ERROR.
  7181     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7182     MOVE -1                     TO CORRSELL.
  7183     MOVE ZEROS                  TO CORRSELO.
  7184     GO TO 8100-SEND-INITIAL-MAP.
  7185
  7186 3200-EXIT.
  7187     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 143
* EL690.cbl
  7189 3300-ARCH4-PROCESS.
  7190
  7191     IF  W-CHANGE-REQUESTED
  7192         MOVE HIGH-VALUES        TO W-ARCH4-KEY
  7193         MOVE PI-COMPANY-CD      TO W-ARCH4-COMPANY-CD
  7194         MOVE PI-690-INIT-PROCESSOR
  7195                                 TO W-ARCH4-PROCESSOR
  7196         MOVE PI-690-INIT-CARRIER
  7197                                 TO W-ARCH4-CARRIER
  7198         MOVE PI-690-INIT-GROUPING
  7199                                 TO W-ARCH4-GROUPING
  7200         MOVE PI-690-INIT-STATE  TO W-ARCH4-STATE
  7201         MOVE PI-690-INIT-ACCOUNT
  7202                                 TO W-ARCH4-ACCOUNT
  7203
  7204     ELSE
  7205         IF  W-FIRST-CHANGE-FOUND
  7206             MOVE HIGH-VALUES    TO W-ARCH4-KEY
  7207             MOVE PI-COMPANY-CD  TO W-ARCH4-COMPANY-CD
  7208             MOVE PI-690-LAST-PROCESSOR
  7209                                 TO W-ARCH4-PROCESSOR
  7210             MOVE PI-690-LAST-CARRIER
  7211                                 TO W-ARCH4-CARRIER
  7212             MOVE PI-690-LAST-GROUPING
  7213                                 TO W-ARCH4-GROUPING
  7214             MOVE PI-690-LAST-STATE
  7215                                 TO W-ARCH4-STATE
  7216             MOVE PI-690-LAST-ACCOUNT
  7217                                 TO W-ARCH4-ACCOUNT
  7218
  7219         ELSE
  7220             MOVE PI-COMPANY-CD  TO W-ARCH4-COMPANY-CD
  7221             MOVE PI-690-FIRST-PROCESSOR
  7222                                 TO W-ARCH4-PROCESSOR
  7223             MOVE PI-690-FIRST-CARRIER
  7224                                 TO W-ARCH4-CARRIER
  7225             MOVE PI-690-FIRST-GROUPING
  7226                                 TO W-ARCH4-GROUPING
  7227             MOVE PI-690-FIRST-STATE
  7228                                 TO W-ARCH4-STATE
  7229             MOVE PI-690-FIRST-ACCOUNT
  7230                                 TO W-ARCH4-ACCOUNT
  7231             MOVE PI-690-FIRST-ARCHIVE-NO
  7232                                 TO W-ARCH4-ARCHIVE-NO.
  7233
  7234
  7235* EXEC CICS HANDLE CONDITION
  7236*        NOTFND  (8080-ARCH-NOT-FOUND)
  7237*        ENDFILE (8080-ARCH-NOT-FOUND)
  7238*        NOTOPEN (8020-ARCH4-NOT-OPEN)
  7239*        END-EXEC.
  7240*    MOVE '"$I''J                 ! 5 #00006811' TO DFHEIV0
  7241     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7243     MOVE X'3520233030303036383131' TO DFHEIV0(25:11)
  7244     CALL 'kxdfhei1' USING DFHEIV0
  7245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7246
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 144
* EL690.cbl
  7247
  7248
  7249* EXEC CICS STARTBR
  7250*        DATASET  (W-ARCH4-FILE-ID)
  7251*        RIDFLD   (W-ARCH4-KEY)
  7252*        GTEQ
  7253*        END-EXEC.
  7254     MOVE 0
  7255       TO DFHEIV11
  7256*    MOVE '&,         G          &   #00006817' TO DFHEIV0
  7257     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7258     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7259     MOVE X'2020233030303036383137' TO DFHEIV0(25:11)
  7260     CALL 'kxdfhei1' USING DFHEIV0,
  7261           W-ARCH4-FILE-ID,
  7262           W-ARCH4-KEY,
  7263           DFHEIV99,
  7264           DFHEIV11,
  7265           DFHEIV99
  7266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7267
  7268
  7269
  7270* EXEC CICS HANDLE CONDITION
  7271*        NOTFND  (3300-END-BROWSE)
  7272*        ENDFILE (3300-END-BROWSE)
  7273*        END-EXEC.
  7274*    MOVE '"$I''                  ! 6 #00006823' TO DFHEIV0
  7275     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7276     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7277     MOVE X'3620233030303036383233' TO DFHEIV0(25:11)
  7278     CALL 'kxdfhei1' USING DFHEIV0
  7279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7280
  7281
  7282     PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT.
  7283
  7284     IF  W-CHANGE-REQUESTED
  7285             OR
  7286         W-READ-PREV-TWICE
  7287         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7288         PERFORM 7250-READ-PREV-ARCH4 THRU 7250-EXIT.
  7289
  7290 3300-BUILD-ARCH4-LIST-BACKWARD.
  7291
  7292     PERFORM 7250-READ-PREV-ARCH4 THRU 7250-EXIT.
  7293
  7294     IF  LA-COMPANY-CD-A3 NOT EQUAL PI-COMPANY-CD
  7295         GO TO 3300-END.
  7296
  7297     IF  PI-690-INIT-PROCESSOR EQUAL HIGH-VALUES OR LOW-VALUES
  7298         GO TO 3300-CONTINUE.
  7299
  7300     IF  LA-PROCESSOR-CD NOT EQUAL PI-690-INIT-PROCESSOR
  7301         GO TO 3300-END-BROWSE.
  7302
  7303     IF  PI-690-INIT-CARRIER EQUAL HIGH-VALUES OR LOW-VALUES
  7304         GO TO 3300-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 145
* EL690.cbl
  7305
  7306     IF  LA-CARRIER-A4 NOT EQUAL PI-690-INIT-CARRIER
  7307         GO TO 3300-END-BROWSE.
  7308
  7309     IF  PI-690-INIT-GROUPING EQUAL HIGH-VALUES OR LOW-VALUES
  7310         GO TO 3300-CONTINUE.
  7311
  7312     IF  LA-GROUPING-A4 NOT EQUAL PI-690-INIT-GROUPING
  7313         GO TO 3300-END-BROWSE.
  7314
  7315     IF  PI-690-INIT-STATE EQUAL HIGH-VALUES OR LOW-VALUES
  7316         GO TO 3300-CONTINUE.
  7317
  7318     IF  LA-STATE-A4 NOT EQUAL PI-690-INIT-STATE
  7319         GO TO 3300-END-BROWSE.
  7320
  7321     IF  PI-690-INIT-ACCOUNT EQUAL HIGH-VALUES OR LOW-VALUES
  7322         GO TO 3300-CONTINUE.
  7323
  7324     IF  LA-ACCOUNT-A4 NOT EQUAL PI-690-INIT-ACCOUNT
  7325         GO TO 3300-END-BROWSE.
  7326
  7327 3300-CONTINUE.
  7328
  7329     IF  NOT PI-690-SELECT-ALL
  7330             AND
  7331         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7332         GO TO 3300-BUILD-ARCH4-LIST-BACKWARD.
  7333
  7334     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  7335             AND
  7336         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  7337         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  7338             GO TO 3300-BUILD-ARCH4-LIST-BACKWARD.
  7339
  7340     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  7341             AND
  7342         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  7343         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  7344             GO TO 3300-BUILD-ARCH4-LIST-BACKWARD.
  7345
  7346     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7347
  7348     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7349
  7350     IF  W-ARCH-NDX LESS THAN +13
  7351         GO TO 3300-BUILD-ARCH4-LIST-BACKWARD.
  7352
  7353 3300-END.
  7354
  7355     MOVE -1                     TO CORRSELL.
  7356     MOVE ZEROS                  TO CORRSELO.
  7357     PERFORM 3300-END-BROWSE
  7358     GO TO 8100-SEND-INITIAL-MAP.
  7359
  7360 3300-END-BROWSE.
  7361
  7362     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 146
* EL690.cbl
  7363     SUBTRACT +1 FROM W-ARCH-NDX3.
  7364
  7365     IF  W-ARCH-NDX3 GREATER THAN +1
  7366         MOVE +1 TO W-ARCH-NDX2
  7367         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7368                 UNTIL
  7369             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7370
  7371
  7372* EXEC CICS ENDBR
  7373*        DATASET (W-ARCH4-FILE-ID)
  7374*    END-EXEC.
  7375     MOVE 0
  7376       TO DFHEIV11
  7377*    MOVE '&2                    $   #00006917' TO DFHEIV0
  7378     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7379     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7380     MOVE X'2020233030303036393137' TO DFHEIV0(25:11)
  7381     CALL 'kxdfhei1' USING DFHEIV0,
  7382           W-ARCH4-FILE-ID,
  7383           DFHEIV11,
  7384           DFHEIV99
  7385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7386
  7387
  7388 3300-FRONT-OF-FILE.
  7389
  7390     MOVE ER-0131                TO EMI-ERROR.
  7391     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7392     MOVE -1                     TO CORRSELL.
  7393     MOVE ZEROS                  TO CORRSELO.
  7394     GO TO 8100-SEND-INITIAL-MAP.
  7395
  7396 3300-EXIT.
  7397     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 147
* EL690.cbl
  7399 3400-ARCH5-PROCESS.
  7400
  7401     IF  W-CHANGE-REQUESTED
  7402         MOVE HIGH-VALUES        TO W-ARCH5-KEY
  7403         MOVE PI-COMPANY-CD      TO W-ARCH5-COMPANY-CD
  7404         MOVE PI-690-INIT-CARRIER
  7405                                 TO W-ARCH5-CARRIER
  7406         MOVE PI-690-INIT-GROUPING
  7407                                 TO W-ARCH5-GROUPING
  7408         MOVE PI-690-INIT-STATE  TO W-ARCH5-STATE
  7409         MOVE PI-690-INIT-ACCOUNT
  7410                                 TO W-ARCH5-ACCOUNT
  7411
  7412     ELSE
  7413         IF  W-FIRST-CHANGE-FOUND
  7414             MOVE SPACES         TO W-READ-PREV-TWICE-IND
  7415             MOVE HIGH-VALUES    TO W-ARCH5-KEY
  7416             MOVE PI-COMPANY-CD  TO W-ARCH5-COMPANY-CD
  7417             MOVE PI-690-LAST-CARRIER
  7418                                 TO W-ARCH5-CARRIER
  7419             MOVE PI-690-LAST-GROUPING
  7420                                 TO W-ARCH5-GROUPING
  7421             MOVE PI-690-LAST-STATE
  7422                                 TO W-ARCH5-STATE
  7423             MOVE PI-690-LAST-ACCOUNT
  7424                                 TO W-ARCH5-ACCOUNT
  7425             MOVE PI-690-LAST-ARCHIVE-NO
  7426                                 TO W-ARCH5-ARCHIVE-NO
  7427
  7428         ELSE
  7429             MOVE PI-COMPANY-CD  TO W-ARCH5-COMPANY-CD
  7430             MOVE PI-690-FIRST-CARRIER
  7431                                 TO W-ARCH5-CARRIER
  7432             MOVE PI-690-FIRST-GROUPING
  7433                                 TO W-ARCH5-GROUPING
  7434             MOVE PI-690-FIRST-STATE
  7435                                 TO W-ARCH5-STATE
  7436             MOVE PI-690-FIRST-ACCOUNT
  7437                                 TO W-ARCH5-ACCOUNT
  7438             MOVE PI-690-FIRST-ARCHIVE-NO
  7439                                 TO W-ARCH5-ARCHIVE-NO.
  7440
  7441
  7442* EXEC CICS HANDLE CONDITION
  7443*        NOTFND  (8080-ARCH-NOT-FOUND)
  7444*        ENDFILE (8080-ARCH-NOT-FOUND)
  7445*        NOTOPEN (8030-ARCH5-NOT-OPEN)
  7446*        END-EXEC.
  7447*    MOVE '"$I''J                 ! 7 #00006974' TO DFHEIV0
  7448     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7450     MOVE X'3720233030303036393734' TO DFHEIV0(25:11)
  7451     CALL 'kxdfhei1' USING DFHEIV0
  7452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7453
  7454
  7455
  7456* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 148
* EL690.cbl
  7457*        DATASET  (W-ARCH5-FILE-ID)
  7458*        RIDFLD   (W-ARCH5-KEY)
  7459*        GTEQ
  7460*        END-EXEC.
  7461     MOVE 0
  7462       TO DFHEIV11
  7463*    MOVE '&,         G          &   #00006980' TO DFHEIV0
  7464     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7465     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7466     MOVE X'2020233030303036393830' TO DFHEIV0(25:11)
  7467     CALL 'kxdfhei1' USING DFHEIV0,
  7468           W-ARCH5-FILE-ID,
  7469           W-ARCH5-KEY,
  7470           DFHEIV99,
  7471           DFHEIV11,
  7472           DFHEIV99
  7473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7474
  7475
  7476
  7477* EXEC CICS HANDLE CONDITION
  7478*        NOTFND  (3400-END-BROWSE)
  7479*        ENDFILE (3400-END-BROWSE)
  7480*        END-EXEC.
  7481*    MOVE '"$I''                  ! 8 #00006986' TO DFHEIV0
  7482     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7483     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7484     MOVE X'3820233030303036393836' TO DFHEIV0(25:11)
  7485     CALL 'kxdfhei1' USING DFHEIV0
  7486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7487
  7488
  7489     PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT.
  7490
  7491     IF  W-CHANGE-REQUESTED
  7492*            OR
  7493*        W-READ-PREV-TWICE
  7494*        MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7495         PERFORM 7350-READ-PREV-ARCH5 THRU 7350-EXIT.
  7496
  7497 3400-BUILD-ARCH5-LIST-BACKWARD.
  7498
  7499     PERFORM 7350-READ-PREV-ARCH5 THRU 7350-EXIT.
  7500
  7501     IF  LA-COMPANY-CD-A5 NOT EQUAL PI-COMPANY-CD
  7502         GO TO 3400-END.
  7503
  7504     IF  PI-690-INIT-CARRIER EQUAL HIGH-VALUES OR LOW-VALUES
  7505         GO TO 3400-CONTINUE.
  7506
  7507     IF  LA-CARRIER-A5 NOT EQUAL PI-690-INIT-CARRIER
  7508         GO TO 3400-END-BROWSE.
  7509
  7510     IF  PI-690-INIT-GROUPING EQUAL HIGH-VALUES OR LOW-VALUES
  7511         GO TO 3400-CONTINUE.
  7512
  7513     IF  LA-GROUPING-A5 NOT EQUAL PI-690-INIT-GROUPING
  7514         GO TO 3400-END-BROWSE.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 149
* EL690.cbl
  7515
  7516     IF  PI-690-INIT-STATE EQUAL HIGH-VALUES OR LOW-VALUES
  7517         GO TO 3400-CONTINUE.
  7518
  7519     IF  LA-STATE-A5 NOT EQUAL PI-690-INIT-STATE
  7520         GO TO 3400-END-BROWSE.
  7521
  7522     IF  PI-690-INIT-ACCOUNT EQUAL HIGH-VALUES OR LOW-VALUES
  7523         GO TO 3400-CONTINUE.
  7524
  7525     IF  LA-ACCOUNT-A5 NOT EQUAL PI-690-INIT-ACCOUNT
  7526         GO TO 3400-END-BROWSE.
  7527
  7528 3400-CONTINUE.
  7529
  7530     IF  NOT PI-690-SELECT-ALL
  7531             AND
  7532         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7533         GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7534
  7535     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  7536             AND
  7537         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  7538         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  7539             GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7540
  7541     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  7542             AND
  7543         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  7544         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  7545             GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7546
  7547     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  7548             AND
  7549         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  7550         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  7551             GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7552
  7553     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7554
  7555     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7556
  7557     IF  W-ARCH-NDX LESS THAN +13
  7558         GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7559
  7560 3400-END.
  7561
  7562     MOVE -1                     TO CORRSELL.
  7563     MOVE ZEROS                  TO CORRSELO.
  7564     PERFORM 3400-END-BROWSE
  7565     GO TO 8100-SEND-INITIAL-MAP.
  7566
  7567 3400-END-BROWSE.
  7568
  7569     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  7570     SUBTRACT +1 FROM W-ARCH-NDX3.
  7571
  7572     IF  W-ARCH-NDX3 GREATER THAN +1
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 150
* EL690.cbl
  7573         MOVE +1 TO W-ARCH-NDX2
  7574         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7575                 UNTIL
  7576             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7577
  7578
  7579* EXEC CICS ENDBR
  7580*        DATASET (W-ARCH5-FILE-ID)
  7581*    END-EXEC.
  7582     MOVE 0
  7583       TO DFHEIV11
  7584*    MOVE '&2                    $   #00007080' TO DFHEIV0
  7585     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7586     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7587     MOVE X'2020233030303037303830' TO DFHEIV0(25:11)
  7588     CALL 'kxdfhei1' USING DFHEIV0,
  7589           W-ARCH5-FILE-ID,
  7590           DFHEIV11,
  7591           DFHEIV99
  7592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7593
  7594
  7595 3400-FRONT-OF-FILE.
  7596
  7597     MOVE ER-0131                TO EMI-ERROR.
  7598     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7599     MOVE -1                     TO CORRSELL.
  7600     MOVE ZEROS                  TO CORRSELO.
  7601     GO TO 8100-SEND-INITIAL-MAP.
  7602
  7603 3400-EXIT.
  7604     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 151
* EL690.cbl
  7606 3500-ARCH6-PROCESS.
  7607
  7608     IF  W-CHANGE-REQUESTED
  7609         MOVE HIGH-VALUES        TO W-ARCH6-KEY
  7610         MOVE PI-COMPANY-CD      TO W-ARCH6-COMPANY-CD
  7611         MOVE PI-690-INIT-ENTRY  TO W-ARCH6-ENTRY
  7612
  7613
  7614     ELSE
  7615         IF  W-FIRST-CHANGE-FOUND
  7616             MOVE HIGH-VALUES    TO W-ARCH6-KEY
  7617             MOVE PI-COMPANY-CD  TO W-ARCH6-COMPANY-CD
  7618             MOVE PI-690-LAST-ENTRY
  7619                                 TO W-ARCH6-ENTRY
  7620
  7621         ELSE
  7622             MOVE PI-COMPANY-CD  TO W-ARCH6-COMPANY-CD
  7623             MOVE PI-690-FIRST-ENTRY
  7624                                 TO W-ARCH6-ENTRY
  7625             MOVE PI-690-FIRST-ARCHIVE-NO
  7626                                 TO W-ARCH6-ARCHIVE-NO.
  7627
  7628
  7629* EXEC CICS HANDLE CONDITION
  7630*        NOTFND  (8080-ARCH-NOT-FOUND)
  7631*        ENDFILE (8080-ARCH-NOT-FOUND)
  7632*        NOTOPEN (8040-ARCH6-NOT-OPEN)
  7633*        END-EXEC.
  7634*    MOVE '"$I''J                 ! 9 #00007117' TO DFHEIV0
  7635     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7636     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7637     MOVE X'3920233030303037313137' TO DFHEIV0(25:11)
  7638     CALL 'kxdfhei1' USING DFHEIV0
  7639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7640
  7641
  7642
  7643* EXEC CICS STARTBR
  7644*        DATASET  (W-ARCH6-FILE-ID)
  7645*        RIDFLD   (W-ARCH6-KEY)
  7646*        GTEQ
  7647*        END-EXEC.
  7648     MOVE 0
  7649       TO DFHEIV11
  7650*    MOVE '&,         G          &   #00007123' TO DFHEIV0
  7651     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7652     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7653     MOVE X'2020233030303037313233' TO DFHEIV0(25:11)
  7654     CALL 'kxdfhei1' USING DFHEIV0,
  7655           W-ARCH6-FILE-ID,
  7656           W-ARCH6-KEY,
  7657           DFHEIV99,
  7658           DFHEIV11,
  7659           DFHEIV99
  7660     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7661
  7662
  7663
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 152
* EL690.cbl
  7664* EXEC CICS HANDLE CONDITION
  7665*        NOTFND  (3500-END-BROWSE)
  7666*        ENDFILE (3500-END-BROWSE)
  7667*        END-EXEC.
  7668*    MOVE '"$I''                  ! : #00007129' TO DFHEIV0
  7669     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7671     MOVE X'3A20233030303037313239' TO DFHEIV0(25:11)
  7672     CALL 'kxdfhei1' USING DFHEIV0
  7673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7674
  7675
  7676     PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT.
  7677
  7678     IF  W-CHANGE-REQUESTED
  7679             OR
  7680         W-READ-PREV-TWICE
  7681         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7682         PERFORM 7450-READ-PREV-ARCH6 THRU 7450-EXIT.
  7683
  7684 3500-BUILD-ARCH6-LIST-BACKWARD.
  7685
  7686     PERFORM 7450-READ-PREV-ARCH6 THRU 7450-EXIT.
  7687
  7688     IF  LA-COMPANY-CD-A5 NOT EQUAL PI-COMPANY-CD
  7689         GO TO 3500-END.
  7690
  7691     IF  PI-690-INIT-ENTRY EQUAL HIGH-VALUES OR LOW-VALUES
  7692         GO TO 3500-CONTINUE.
  7693
  7694     IF  LA-ENTRY-A6 NOT EQUAL PI-690-INIT-ENTRY
  7695         GO TO 3500-END-BROWSE.
  7696
  7697 3500-CONTINUE.
  7698
  7699     IF  NOT PI-690-SELECT-ALL
  7700             AND
  7701         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7702         GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7703
  7704     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  7705             AND
  7706         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  7707         IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  7708             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7709
  7710     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  7711             AND
  7712         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  7713         IF  LA-PROCESSOR-CD NOT EQUAL PI-690-INIT-PROCESSOR
  7714             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7715
  7716     IF  PI-690-INIT-CARRIER NOT EQUAL HIGH-VALUES
  7717             AND
  7718         PI-690-INIT-CARRIER NOT EQUAL LOW-VALUES
  7719         IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  7720             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7721
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 153
* EL690.cbl
  7722     IF  PI-690-INIT-GROUPING NOT EQUAL HIGH-VALUES
  7723             AND
  7724         PI-690-INIT-GROUPING NOT EQUAL LOW-VALUES
  7725         IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  7726             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7727
  7728     IF  PI-690-INIT-STATE NOT EQUAL HIGH-VALUES
  7729             AND
  7730         PI-690-INIT-STATE NOT EQUAL LOW-VALUES
  7731         IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  7732             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7733
  7734     IF  PI-690-INIT-ACCOUNT NOT EQUAL HIGH-VALUES
  7735             AND
  7736         PI-690-INIT-ACCOUNT NOT EQUAL LOW-VALUES
  7737         IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  7738             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7739
  7740     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7741
  7742     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7743
  7744     IF  W-ARCH-NDX LESS THAN +13
  7745         GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7746
  7747 3500-END.
  7748
  7749     MOVE -1                     TO CORRSELL.
  7750     MOVE ZEROS                  TO CORRSELO.
  7751     PERFORM 3500-END-BROWSE
  7752     GO TO 8100-SEND-INITIAL-MAP.
  7753
  7754 3500-END-BROWSE.
  7755
  7756     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  7757     SUBTRACT +1 FROM W-ARCH-NDX3.
  7758
  7759     IF  W-ARCH-NDX3 GREATER THAN +1
  7760         MOVE +1 TO W-ARCH-NDX2
  7761         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7762                 UNTIL
  7763             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7764
  7765
  7766* EXEC CICS ENDBR
  7767*        DATASET (W-ARCH6-FILE-ID)
  7768*    END-EXEC.
  7769     MOVE 0
  7770       TO DFHEIV11
  7771*    MOVE '&2                    $   #00007223' TO DFHEIV0
  7772     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7773     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7774     MOVE X'2020233030303037323233' TO DFHEIV0(25:11)
  7775     CALL 'kxdfhei1' USING DFHEIV0,
  7776           W-ARCH6-FILE-ID,
  7777           DFHEIV11,
  7778           DFHEIV99
  7779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 154
* EL690.cbl
  7780
  7781
  7782 3500-FRONT-OF-FILE.
  7783
  7784     MOVE ER-0131                TO EMI-ERROR.
  7785     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7786     MOVE -1                     TO CORRSELL.
  7787     MOVE ZEROS                  TO CORRSELO.
  7788     GO TO 8100-SEND-INITIAL-MAP.
  7789
  7790 3500-EXIT.
  7791     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 155
* EL690.cbl
  7793 3600-ARCH-PROCESS.
  7794
  7795     IF  W-CHANGE-REQUESTED
  7796         MOVE HIGH-VALUES        TO W-ARCH-KEY
  7797         MOVE PI-COMPANY-CD      TO W-ARCH-COMPANY-CD
  7798
  7799     ELSE
  7800         IF  W-FIRST-CHANGE-FOUND
  7801             MOVE HIGH-VALUES    TO W-ARCH-KEY
  7802             MOVE PI-COMPANY-CD  TO W-ARCH-COMPANY-CD
  7803             MOVE PI-690-LAST-ARCHIVE-NO
  7804                                 TO W-ARCH-ARCHIVE-NO
  7805
  7806         ELSE
  7807             MOVE PI-COMPANY-CD  TO W-ARCH-COMPANY-CD
  7808             MOVE PI-690-FIRST-ARCHIVE-NO
  7809                                 TO W-ARCH-ARCHIVE-NO
  7810             MOVE PI-690-FIRST-ARCHIVE-NO
  7811                                 TO W-ARCH-ARCHIVE-NO.
  7812
  7813
  7814* EXEC CICS HANDLE CONDITION
  7815*        NOTFND  (8080-ARCH-NOT-FOUND)
  7816*        ENDFILE (8080-ARCH-NOT-FOUND)
  7817*        NOTOPEN (8050-ARCH-NOT-OPEN)
  7818*        END-EXEC.
  7819*    MOVE '"$I''J                 ! ; #00007258' TO DFHEIV0
  7820     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7821     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7822     MOVE X'3B20233030303037323538' TO DFHEIV0(25:11)
  7823     CALL 'kxdfhei1' USING DFHEIV0
  7824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7825
  7826
  7827
  7828* EXEC CICS STARTBR
  7829*        DATASET  (W-ARCH-FILE-ID)
  7830*        RIDFLD   (W-ARCH-KEY)
  7831*        GTEQ
  7832*        END-EXEC.
  7833     MOVE 0
  7834       TO DFHEIV11
  7835*    MOVE '&,         G          &   #00007264' TO DFHEIV0
  7836     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7837     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7838     MOVE X'2020233030303037323634' TO DFHEIV0(25:11)
  7839     CALL 'kxdfhei1' USING DFHEIV0,
  7840           W-ARCH-FILE-ID,
  7841           W-ARCH-KEY,
  7842           DFHEIV99,
  7843           DFHEIV11,
  7844           DFHEIV99
  7845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7846
  7847
  7848
  7849* EXEC CICS HANDLE CONDITION
  7850*        NOTFND  (3600-END-BROWSE)
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 156
* EL690.cbl
  7851*        ENDFILE (3600-END-BROWSE)
  7852*        END-EXEC.
  7853*    MOVE '"$I''                  ! < #00007270' TO DFHEIV0
  7854     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7855     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7856     MOVE X'3C20233030303037323730' TO DFHEIV0(25:11)
  7857     CALL 'kxdfhei1' USING DFHEIV0
  7858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7859
  7860
  7861     PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT.
  7862
  7863     IF  W-CHANGE-REQUESTED
  7864             OR
  7865         W-READ-PREV-TWICE
  7866         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7867         PERFORM 7550-READ-PREV-ARCH THRU 7550-EXIT.
  7868
  7869 3600-BUILD-ARCH-LIST-BACKWARD.
  7870
  7871     PERFORM 7550-READ-PREV-ARCH THRU 7550-EXIT.
  7872
  7873     IF  LA-COMPANY-CD-A5 NOT EQUAL PI-COMPANY-CD
  7874         GO TO 3600-END.
  7875
  7876     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  7877             AND
  7878         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  7879         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  7880             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7881
  7882     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  7883             AND
  7884         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  7885         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  7886             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7887
  7888     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  7889             AND
  7890         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  7891         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  7892             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7893
  7894     IF  PI-690-INIT-CARRIER NOT EQUAL HIGH-VALUES
  7895             AND
  7896         PI-690-INIT-CARRIER NOT EQUAL LOW-VALUES
  7897         IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  7898             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7899
  7900     IF  PI-690-INIT-GROUPING NOT EQUAL HIGH-VALUES
  7901             AND
  7902         PI-690-INIT-GROUPING NOT EQUAL LOW-VALUES
  7903         IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  7904             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7905
  7906     IF  PI-690-INIT-STATE NOT EQUAL HIGH-VALUES
  7907             AND
  7908         PI-690-INIT-STATE NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 157
* EL690.cbl
  7909         IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  7910             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7911
  7912     IF  PI-690-INIT-ACCOUNT NOT EQUAL HIGH-VALUES
  7913             AND
  7914         PI-690-INIT-ACCOUNT NOT EQUAL LOW-VALUES
  7915         IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  7916             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7917
  7918     IF  NOT PI-690-SELECT-ALL
  7919             AND
  7920         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7921         GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7922
  7923     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7924
  7925     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7926
  7927     IF  W-ARCH-NDX LESS THAN +13
  7928         GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7929
  7930 3600-END.
  7931
  7932     MOVE -1                     TO CORRSELL.
  7933     MOVE ZEROS                  TO CORRSELO.
  7934     PERFORM 3600-END-BROWSE
  7935     GO TO 8100-SEND-INITIAL-MAP.
  7936
  7937 3600-END-BROWSE.
  7938
  7939     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  7940     SUBTRACT +1 FROM W-ARCH-NDX3.
  7941
  7942     IF  W-ARCH-NDX3 GREATER THAN +1
  7943         MOVE +1 TO W-ARCH-NDX2
  7944         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7945                 UNTIL
  7946             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7947
  7948
  7949* EXEC CICS ENDBR
  7950*        DATASET (W-ARCH-FILE-ID)
  7951*    END-EXEC.
  7952     MOVE 0
  7953       TO DFHEIV11
  7954*    MOVE '&2                    $   #00007362' TO DFHEIV0
  7955     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7956     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7957     MOVE X'2020233030303037333632' TO DFHEIV0(25:11)
  7958     CALL 'kxdfhei1' USING DFHEIV0,
  7959           W-ARCH-FILE-ID,
  7960           DFHEIV11,
  7961           DFHEIV99
  7962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7963
  7964
  7965 3600-FRONT-OF-FILE.
  7966
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 158
* EL690.cbl
  7967     MOVE ER-0131                TO EMI-ERROR.
  7968     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7969     MOVE -1                     TO CORRSELL.
  7970     MOVE ZEROS                  TO CORRSELO.
  7971     GO TO 8100-SEND-INITIAL-MAP.
  7972
  7973 3600-EXIT.
  7974     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 159
* EL690.cbl
  7976 6000-SELECT-FOR-OUTPUT.
  7977
  7978     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
  7979             AND
  7980         PI-CARRIER-SECURITY NOT EQUAL LA-CARRIER-A2
  7981
  7982         IF  EMI-ERROR NOT EQUAL ER-9150
  7983             MOVE ER-9150        TO EMI-ERROR
  7984             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7985             GO TO 6000-EXIT
  7986
  7987         ELSE
  7988             GO TO 6000-EXIT.
  7989
  7990     IF LA-TEMP
  7991         GO TO 6000-EXIT
  7992     END-IF.
  7993
  7994     PERFORM 6100-TABLE-LINE-CREATE  THRU 6100-EXIT.
  7995
  7996     MOVE W-ARCH-NDX             TO PI-690-LAST-ARCH-NDX.
  7997     ADD +1                      TO W-ARCH-NDX.
  7998
  7999
  8000     IF  EIBAID EQUAL DFHPF1
  8001         MOVE LA-CARRIER-A2      TO PI-690-LAST-CARRIER
  8002         MOVE LA-GROUPING-A2     TO PI-690-LAST-GROUPING
  8003         MOVE LA-STATE-A2        TO PI-690-LAST-STATE
  8004         MOVE LA-ACCOUNT-A2      TO PI-690-LAST-ACCOUNT
  8005         MOVE LA-CERT-PRIME-A2   TO PI-690-LAST-CERT-PRIME
  8006         MOVE LA-CERT-SUFFIX-A2  TO PI-690-LAST-SUFFIX
  8007         MOVE LA-EFFECT-DATE-A2  TO PI-690-LAST-EFFECT-DATE
  8008         MOVE LA-FORM-A3         TO PI-690-LAST-FORM
  8009         MOVE LA-PROCESSOR-CD    TO PI-690-LAST-PROCESSOR
  8010         MOVE LA-ENTRY-A6        TO PI-690-LAST-ENTRY
  8011         MOVE LA-ARCHIVE-NO      TO PI-690-LAST-ARCHIVE-NO
  8012
  8013         IF  PI-690-FIRST-DATA EQUAL LOW-VALUES
  8014                 OR
  8015             PI-690-FIRST-DATA EQUAL HIGH-VALUES
  8016             MOVE PI-690-LAST-DATA
  8017                                 TO PI-690-FIRST-DATA
  8018
  8019         ELSE
  8020             NEXT SENTENCE
  8021
  8022     ELSE
  8023         MOVE LA-CARRIER-A2      TO PI-690-FIRST-CARRIER
  8024         MOVE LA-GROUPING-A2     TO PI-690-FIRST-GROUPING
  8025         MOVE LA-STATE-A2        TO PI-690-FIRST-STATE
  8026         MOVE LA-ACCOUNT-A2      TO PI-690-FIRST-ACCOUNT
  8027         MOVE LA-CERT-PRIME-A2   TO PI-690-FIRST-CERT-PRIME
  8028         MOVE LA-CERT-SUFFIX-A2  TO PI-690-FIRST-SUFFIX
  8029         MOVE LA-EFFECT-DATE-A2  TO PI-690-FIRST-EFFECT-DATE
  8030         MOVE LA-FORM-A3         TO PI-690-FIRST-FORM
  8031         MOVE LA-PROCESSOR-CD    TO PI-690-FIRST-PROCESSOR
  8032         MOVE LA-ENTRY-A6        TO PI-690-FIRST-ENTRY
  8033         MOVE LA-ARCHIVE-NO      TO PI-690-FIRST-ARCHIVE-NO
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 160
* EL690.cbl
  8034
  8035         IF  PI-690-LAST-DATA EQUAL LOW-VALUES
  8036                 OR
  8037             PI-690-LAST-DATA EQUAL HIGH-VALUES
  8038             MOVE PI-690-FIRST-DATA
  8039                                 TO PI-690-LAST-DATA.
  8040
  8041 6000-EXIT.
  8042     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 161
* EL690.cbl
  8044 6100-TABLE-LINE-CREATE.
  8045
  8046     MOVE LA-ARCHIVE-NO
  8047         TO W-ARCNOO (W-ARCH-NDX)
  8048            PI-690-ARCHIVE-NUM (W-ARCH-NDX).
  8049
  8050*    MOVE LA-STATUS              TO W-STATSO (W-ARCH-NDX).
  8051     MOVE LA-FORM-A3             TO W-FORMO (W-ARCH-NDX).
  8052     MOVE LA-PROCESSOR-CD        TO W-USRIDO (W-ARCH-NDX).
  8053
  8054*    IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  8055*        MOVE 'F'                TO W-PRRSTO (W-ARCH-NDX)
  8056*
  8057*    ELSE
  8058*        IF  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  8059*            MOVE 'P'            TO W-PRRSTO (W-ARCH-NDX)
  8060*
  8061*        ELSE
  8062*            IF  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  8063*                MOVE 'C'        TO W-PRRSTO (W-ARCH-NDX)
  8064*
  8065*            ELSE
  8066*                MOVE SPACES     TO W-PRRSTO (W-ARCH-NDX).
  8067
  8068     IF  LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
  8069*        MOVE AL-PABON           TO W-PRINTA (W-ARCH-NDX)
  8070         MOVE LA-INITIAL-PRINT-DATE
  8071                                 TO DC-BIN-DATE-1
  8072         MOVE ' '                TO DC-OPTION-CODE
  8073         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8074
  8075         IF  DC-ERROR-CODE EQUAL SPACES
  8076             MOVE DC-GREG-DATE-1-EDIT
  8077                                 TO W-PRINTO (W-ARCH-NDX)
  8078
  8079         ELSE
  8080             MOVE SPACES         TO W-PRINTO (W-ARCH-NDX)
  8081         END-IF
  8082     ELSE
  8083         MOVE SPACES             TO W-PRINTO (W-ARCH-NDX)
  8084     END-IF.
  8085
  8086*        IF  LA-CREATION-DATE GREATER THAN LOW-VALUES
  8087*            MOVE LA-CREATION-DATE
  8088*                                TO DC-BIN-DATE-1
  8089*            MOVE ' '            TO DC-OPTION-CODE
  8090*            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8091*
  8092*            IF  DC-ERROR-CODE EQUAL SPACES
  8093*                MOVE DC-GREG-DATE-1-EDIT
  8094*                                TO W-CREATO (W-ARCH-NDX)
  8095*
  8096*            ELSE
  8097*                MOVE SPACES     TO W-CREATO (W-ARCH-NDX)
  8098*
  8099*        ELSE
  8100*            MOVE SPACES         TO W-CREATO (W-ARCH-NDX).
  8101
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 162
* EL690.cbl
  8102
  8103*    IF  LA-FOLLOW-UP-DATE GREATER THAN LOW-VALUES
  8104*        MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
  8105*        MOVE ' '                TO DC-OPTION-CODE
  8106*        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8107*
  8108*        IF  DC-ERROR-CODE EQUAL SPACES
  8109*            MOVE DC-GREG-DATE-1-EDIT
  8110*                                TO W-FOLUPO (W-ARCH-NDX)
  8111*
  8112*        ELSE
  8113*            MOVE SPACES         TO W-FOLUPO (W-ARCH-NDX)
  8114*
  8115*    ELSE
  8116*        MOVE SPACES             TO W-FOLUPO (W-ARCH-NDX).
  8117*
  8118
  8119*    IF  LA-SENT-DATE   GREATER THAN LOW-VALUES
  8120*        MOVE 'C'                TO W-RSSTSO (W-ARCH-NDX)
  8121*    ELSE
  8122*        MOVE 'A'                TO W-RSSTSO (W-ARCH-NDX)
  8123*    END-IF
  8124
  8125     IF  LA-RESEND-DATE   GREATER THAN LOW-VALUES
  8126         MOVE LA-RESEND-DATE
  8127                             TO DC-BIN-DATE-1
  8128         MOVE ' '            TO DC-OPTION-CODE
  8129         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8130
  8131         IF  DC-ERROR-CODE EQUAL SPACES
  8132             MOVE DC-GREG-DATE-1-EDIT
  8133                             TO W-RSDATO (W-ARCH-NDX)
  8134
  8135         ELSE
  8136             MOVE SPACES     TO W-RSDATO (W-ARCH-NDX)
  8137
  8138     ELSE
  8139         MOVE SPACES         TO W-RSDATO (W-ARCH-NDX)
  8140                                W-RSFRMO (W-ARCH-NDX)
  8141         GO TO 6100-CHECK-REPLY.
  8142
  8143
  8144     IF LA-RESEND-LETR NOT = SPACES
  8145        MOVE LA-RESEND-LETR      TO W-RSFRMO (W-ARCH-NDX)
  8146     ELSE
  8147        MOVE SPACES              TO W-RSFRMO (W-ARCH-NDX)
  8148     END-IF
  8149*    IF  LA-SENT-DATE-2 GREATER THAN LOW-VALUES
  8150*        MOVE AL-UABON           TO W-RSFRMA (W-ARCH-NDX)
  8151*        MOVE LA-SENT-DATE-2     TO DC-BIN-DATE-1
  8152*        MOVE ' '                TO DC-OPTION-CODE
  8153*        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8154*
  8155*        IF  DC-ERROR-CODE EQUAL SPACES
  8156*            MOVE DC-GREG-DATE-1-EDIT
  8157*                                TO W-RSFRMO (W-ARCH-NDX)
  8158*
  8159*        ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 163
* EL690.cbl
  8160*            MOVE SPACES         TO W-RSFRMO (W-ARCH-NDX)
  8161*
  8162*    ELSE
  8163*        IF  LA-RESEND-DATE-2 GREATER THAN LOW-VALUES
  8164*            MOVE LA-RESEND-DATE-2
  8165*                                TO DC-BIN-DATE-1
  8166*            MOVE ' '            TO DC-OPTION-CODE
  8167*            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8168*
  8169*            IF  DC-ERROR-CODE EQUAL SPACES
  8170*                MOVE DC-GREG-DATE-1-EDIT
  8171*                                TO W-RSFRMO (W-ARCH-NDX)
  8172*
  8173*            ELSE
  8174*                MOVE SPACES     TO W-RSFRMO (W-ARCH-NDX)
  8175*
  8176*        ELSE
  8177*            MOVE SPACES         TO W-RSFRMO (W-ARCH-NDX)
  8178*                                   W-RSSTSO (W-ARCH-NDX)
  8179*            GO TO 6100-CHECK-REPLY.
  8180*
  8181*
  8182*    IF  LA-SENT-DATE-3 GREATER THAN LOW-VALUES
  8183*        MOVE AL-UABON           TO W-RSSTSA (W-ARCH-NDX)
  8184*        MOVE LA-SENT-DATE-3     TO DC-BIN-DATE-1
  8185*        MOVE ' '                TO DC-OPTION-CODE
  8186*        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8187*
  8188*        IF  DC-ERROR-CODE EQUAL SPACES
  8189*            MOVE DC-GREG-DATE-1-EDIT
  8190*                                TO W-RSSTSO (W-ARCH-NDX)
  8191*
  8192*        ELSE
  8193*            MOVE SPACES         TO W-RSSTSO (W-ARCH-NDX)
  8194*
  8195*    ELSE
  8196*        IF  LA-RESEND-DATE-3 GREATER THAN LOW-VALUES
  8197*            MOVE LA-RESEND-DATE-3
  8198*                                TO DC-BIN-DATE-1
  8199*            MOVE ' '            TO DC-OPTION-CODE
  8200*            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8201*
  8202*            IF  DC-ERROR-CODE EQUAL SPACES
  8203*                MOVE DC-GREG-DATE-1-EDIT
  8204*                                TO W-RSSTSO (W-ARCH-NDX)
  8205*
  8206*            ELSE
  8207*                MOVE SPACES     TO W-RSSTSO (W-ARCH-NDX)
  8208*
  8209*        ELSE
  8210*            MOVE SPACES         TO W-RSSTSO (W-ARCH-NDX).
  8211     .
  8212 6100-CHECK-REPLY.
  8213
  8214     IF  LA-PURGED-DATE GREATER THAN LOW-VALUES
  8215             AND
  8216         LA-PURGED-DATE NOT EQUAL SPACES
  8217*        MOVE LA-PURGED-DATE     TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 164
* EL690.cbl
  8218*        MOVE ' '                TO DC-OPTION-CODE
  8219*        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8220
  8221*        IF  DC-ERROR-CODE EQUAL SPACES
  8222*            MOVE DC-GREG-DATE-1-EDIT
  8223*                                TO W-REPLYO (W-ARCH-NDX)
  8224             MOVE 'PURGED'       TO W-STATUSO (W-ARCH-NDX)
  8225
  8226*        ELSE
  8227*            MOVE SPACES         TO W-REPLYO (W-ARCH-NDX)
  8228*                                   W-STOPO (W-ARCH-NDX)
  8229*
  8230*        END-IF
  8231     ELSE
  8232         IF  LA-VOIDED-DATE GREATER THAN LOW-VALUES
  8233                 AND
  8234             LA-VOIDED-DATE NOT EQUAL SPACES
  8235*            MOVE LA-VOIDED-DATE TO DC-BIN-DATE-1
  8236*            MOVE ' '            TO DC-OPTION-CODE
  8237*            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8238
  8239*            IF  DC-ERROR-CODE EQUAL SPACES
  8240*                MOVE AL-PANOF   TO W-REPLYA (W-ARCH-NDX)
  8241*                MOVE DC-GREG-DATE-1-EDIT
  8242*                                TO W-REPLYO (W-ARCH-NDX)
  8243                 MOVE 'STOPPED'  TO W-STATUSO (W-ARCH-NDX)
  8244
  8245*            ELSE
  8246*                MOVE AL-PANOF   TO W-REPLYA (W-ARCH-NDX)
  8247*                MOVE SPACES     TO W-REPLYO (W-ARCH-NDX)
  8248*                                   W-STOPO (W-ARCH-NDX)
  8249*
  8250*
  8251*            END-IF
  8252         ELSE
  8253             IF  LA-REPLY-DATE GREATER THAN LOW-VALUES
  8254                     AND
  8255                 LA-REPLY-DATE NOT EQUAL SPACES
  8256*                MOVE LA-REPLY-DATE
  8257*                                TO DC-BIN-DATE-1
  8258*                MOVE ' '        TO DC-OPTION-CODE
  8259*                PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8260*
  8261*                IF  DC-ERROR-CODE EQUAL SPACES
  8262*                    MOVE DC-GREG-DATE-1-EDIT
  8263*                                TO W-REPLYO (W-ARCH-NDX)
  8264                     MOVE 'RECEIVED' TO W-STATUSO (W-ARCH-NDX)
  8265
  8266*                ELSE
  8267*                    MOVE SPACES TO W-REPLYO (W-ARCH-NDX)
  8268*                                   W-STOPO (W-ARCH-NDX)
  8269*
  8270*                END-IF
  8271             ELSE
  8272                 IF LA-STATUS = 'A'
  8273                     MOVE 'ACTIVE' TO W-STATUSO (W-ARCH-NDX)
  8274                 ELSE
  8275                     IF LA-STATUS = 'C'
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 165
* EL690.cbl
  8276                        MOVE 'COMPLETE' TO W-STATUSO (W-ARCH-NDX)
  8277                     ELSE
  8278                        MOVE SPACES     TO W-STATUSO (W-ARCH-NDX)
  8279                     END-IF
  8280                 END-IF
  8281             END-IF
  8282         END-IF
  8283     END-IF.
  8284
  8285
  8286 6100-EXIT.
  8287     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 166
* EL690.cbl
  8289 6500-REVERSE-TABLE-DATA.
  8290
  8291     MOVE W-ARCHGRP-DATA (W-ARCH-NDX2)
  8292                                 TO W-HOLD-LINE.
  8293     MOVE W-ARCHGRP-DATA (W-ARCH-NDX3)
  8294                                 TO W-ARCHGRP-DATA (W-ARCH-NDX2).
  8295     MOVE W-HOLD-LINE            TO W-ARCHGRP-DATA (W-ARCH-NDX3).
  8296     MOVE PI-690-ARCHIVE-NUM (W-ARCH-NDX2)
  8297                                 TO W-HOLD-ARCHIVE.
  8298     MOVE PI-690-ARCHIVE-NUM (W-ARCH-NDX3)
  8299         TO PI-690-ARCHIVE-NUM (W-ARCH-NDX2).
  8300     MOVE W-HOLD-ARCHIVE
  8301         TO PI-690-ARCHIVE-NUM (W-ARCH-NDX3).
  8302
  8303     ADD +1                      TO W-ARCH-NDX2.
  8304     SUBTRACT +1 FROM W-ARCH-NDX3.
  8305
  8306 6500-EXIT.
  8307     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 167
* EL690.cbl
  8309 7000-READ-ARCH2-FILE-NEXT.
  8310
  8311
  8312* EXEC CICS READNEXT
  8313*        DATASET  (W-ARCH2-FILE-ID)
  8314*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8315*        RIDFLD   (W-ARCH2-KEY)
  8316*        END-EXEC.
  8317     MOVE 0
  8318       TO DFHEIV11
  8319*    MOVE '&.S                   )   #00007712' TO DFHEIV0
  8320     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8321     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8322     MOVE X'2020233030303037373132' TO DFHEIV0(25:11)
  8323     CALL 'kxdfhei1' USING DFHEIV0,
  8324           W-ARCH2-FILE-ID,
  8325           DFHEIV20,
  8326           DFHEIV99,
  8327           W-ARCH2-KEY,
  8328           DFHEIV99,
  8329           DFHEIV11,
  8330           DFHEIV99,
  8331           DFHEIV99
  8332     SET ADDRESS OF LETTER-ARCHIVE TO
  8333         DFHEIV20
  8334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8335
  8336
  8337 7000-EXIT.
  8338     EXIT.
  8339
  8340 7050-READ-PREV-ARCH2.
  8341
  8342
  8343* EXEC CICS READPREV
  8344*        DATASET  (W-ARCH2-FILE-ID)
  8345*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8346*        RIDFLD   (W-ARCH2-KEY)
  8347*        END-EXEC.
  8348     MOVE 0
  8349       TO DFHEIV11
  8350*    MOVE '&0S                   )   #00007723' TO DFHEIV0
  8351     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8352     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8353     MOVE X'2020233030303037373233' TO DFHEIV0(25:11)
  8354     CALL 'kxdfhei1' USING DFHEIV0,
  8355           W-ARCH2-FILE-ID,
  8356           DFHEIV20,
  8357           DFHEIV99,
  8358           W-ARCH2-KEY,
  8359           DFHEIV99,
  8360           DFHEIV11,
  8361           DFHEIV99,
  8362           DFHEIV99
  8363     SET ADDRESS OF LETTER-ARCHIVE TO
  8364         DFHEIV20
  8365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8366
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 168
* EL690.cbl
  8367
  8368 7050-EXIT.
  8369     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 169
* EL690.cbl
  8371 7100-READ-ARCH3-FILE-NEXT.
  8372
  8373
  8374* EXEC CICS READNEXT
  8375*        DATASET  (W-ARCH3-FILE-ID)
  8376*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8377*        RIDFLD   (W-ARCH3-KEY)
  8378*        END-EXEC.
  8379     MOVE 0
  8380       TO DFHEIV11
  8381*    MOVE '&.S                   )   #00007734' TO DFHEIV0
  8382     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8383     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8384     MOVE X'2020233030303037373334' TO DFHEIV0(25:11)
  8385     CALL 'kxdfhei1' USING DFHEIV0,
  8386           W-ARCH3-FILE-ID,
  8387           DFHEIV20,
  8388           DFHEIV99,
  8389           W-ARCH3-KEY,
  8390           DFHEIV99,
  8391           DFHEIV11,
  8392           DFHEIV99,
  8393           DFHEIV99
  8394     SET ADDRESS OF LETTER-ARCHIVE TO
  8395         DFHEIV20
  8396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8397
  8398
  8399 7100-EXIT.
  8400     EXIT.
  8401
  8402 7150-READ-PREV-ARCH3.
  8403
  8404
  8405* EXEC CICS READPREV
  8406*        DATASET  (W-ARCH3-FILE-ID)
  8407*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8408*        RIDFLD   (W-ARCH3-KEY)
  8409*    END-EXEC.
  8410     MOVE 0
  8411       TO DFHEIV11
  8412*    MOVE '&0S                   )   #00007745' TO DFHEIV0
  8413     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8414     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8415     MOVE X'2020233030303037373435' TO DFHEIV0(25:11)
  8416     CALL 'kxdfhei1' USING DFHEIV0,
  8417           W-ARCH3-FILE-ID,
  8418           DFHEIV20,
  8419           DFHEIV99,
  8420           W-ARCH3-KEY,
  8421           DFHEIV99,
  8422           DFHEIV11,
  8423           DFHEIV99,
  8424           DFHEIV99
  8425     SET ADDRESS OF LETTER-ARCHIVE TO
  8426         DFHEIV20
  8427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8428
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 170
* EL690.cbl
  8429
  8430 7150-EXIT.
  8431     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 171
* EL690.cbl
  8433 7200-READ-ARCH4-FILE-NEXT.
  8434
  8435
  8436* EXEC CICS READNEXT
  8437*        DATASET  (W-ARCH4-FILE-ID)
  8438*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8439*        RIDFLD   (W-ARCH4-KEY)
  8440*        END-EXEC.
  8441     MOVE 0
  8442       TO DFHEIV11
  8443*    MOVE '&.S                   )   #00007756' TO DFHEIV0
  8444     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8445     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8446     MOVE X'2020233030303037373536' TO DFHEIV0(25:11)
  8447     CALL 'kxdfhei1' USING DFHEIV0,
  8448           W-ARCH4-FILE-ID,
  8449           DFHEIV20,
  8450           DFHEIV99,
  8451           W-ARCH4-KEY,
  8452           DFHEIV99,
  8453           DFHEIV11,
  8454           DFHEIV99,
  8455           DFHEIV99
  8456     SET ADDRESS OF LETTER-ARCHIVE TO
  8457         DFHEIV20
  8458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8459
  8460
  8461 7200-EXIT.
  8462     EXIT.
  8463
  8464 7250-READ-PREV-ARCH4.
  8465
  8466
  8467* EXEC CICS READPREV
  8468*        DATASET  (W-ARCH4-FILE-ID)
  8469*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8470*        RIDFLD   (W-ARCH4-KEY)
  8471*    END-EXEC.
  8472     MOVE 0
  8473       TO DFHEIV11
  8474*    MOVE '&0S                   )   #00007767' TO DFHEIV0
  8475     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8476     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8477     MOVE X'2020233030303037373637' TO DFHEIV0(25:11)
  8478     CALL 'kxdfhei1' USING DFHEIV0,
  8479           W-ARCH4-FILE-ID,
  8480           DFHEIV20,
  8481           DFHEIV99,
  8482           W-ARCH4-KEY,
  8483           DFHEIV99,
  8484           DFHEIV11,
  8485           DFHEIV99,
  8486           DFHEIV99
  8487     SET ADDRESS OF LETTER-ARCHIVE TO
  8488         DFHEIV20
  8489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8490
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 172
* EL690.cbl
  8491
  8492 7250-EXIT.
  8493     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 173
* EL690.cbl
  8495 7300-READ-ARCH5-FILE-NEXT.
  8496
  8497
  8498* EXEC CICS READNEXT
  8499*        DATASET  (W-ARCH5-FILE-ID)
  8500*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8501*        RIDFLD   (W-ARCH5-KEY)
  8502*        END-EXEC.
  8503     MOVE 0
  8504       TO DFHEIV11
  8505*    MOVE '&.S                   )   #00007778' TO DFHEIV0
  8506     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8507     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8508     MOVE X'2020233030303037373738' TO DFHEIV0(25:11)
  8509     CALL 'kxdfhei1' USING DFHEIV0,
  8510           W-ARCH5-FILE-ID,
  8511           DFHEIV20,
  8512           DFHEIV99,
  8513           W-ARCH5-KEY,
  8514           DFHEIV99,
  8515           DFHEIV11,
  8516           DFHEIV99,
  8517           DFHEIV99
  8518     SET ADDRESS OF LETTER-ARCHIVE TO
  8519         DFHEIV20
  8520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8521
  8522
  8523 7300-EXIT.
  8524     EXIT.
  8525
  8526 7350-READ-PREV-ARCH5.
  8527
  8528
  8529* EXEC CICS READPREV
  8530*        DATASET  (W-ARCH5-FILE-ID)
  8531*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8532*        RIDFLD   (W-ARCH5-KEY)
  8533*    END-EXEC.
  8534     MOVE 0
  8535       TO DFHEIV11
  8536*    MOVE '&0S                   )   #00007789' TO DFHEIV0
  8537     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8538     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8539     MOVE X'2020233030303037373839' TO DFHEIV0(25:11)
  8540     CALL 'kxdfhei1' USING DFHEIV0,
  8541           W-ARCH5-FILE-ID,
  8542           DFHEIV20,
  8543           DFHEIV99,
  8544           W-ARCH5-KEY,
  8545           DFHEIV99,
  8546           DFHEIV11,
  8547           DFHEIV99,
  8548           DFHEIV99
  8549     SET ADDRESS OF LETTER-ARCHIVE TO
  8550         DFHEIV20
  8551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8552
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 174
* EL690.cbl
  8553
  8554 7350-EXIT.
  8555     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 175
* EL690.cbl
  8557 7400-READ-ARCH6-FILE-NEXT.
  8558
  8559
  8560* EXEC CICS READNEXT
  8561*        DATASET  (W-ARCH6-FILE-ID)
  8562*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8563*        RIDFLD   (W-ARCH6-KEY)
  8564*        END-EXEC.
  8565     MOVE 0
  8566       TO DFHEIV11
  8567*    MOVE '&.S                   )   #00007800' TO DFHEIV0
  8568     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8569     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8570     MOVE X'2020233030303037383030' TO DFHEIV0(25:11)
  8571     CALL 'kxdfhei1' USING DFHEIV0,
  8572           W-ARCH6-FILE-ID,
  8573           DFHEIV20,
  8574           DFHEIV99,
  8575           W-ARCH6-KEY,
  8576           DFHEIV99,
  8577           DFHEIV11,
  8578           DFHEIV99,
  8579           DFHEIV99
  8580     SET ADDRESS OF LETTER-ARCHIVE TO
  8581         DFHEIV20
  8582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8583
  8584
  8585 7400-EXIT.
  8586     EXIT.
  8587
  8588 7450-READ-PREV-ARCH6.
  8589
  8590
  8591* EXEC CICS READPREV
  8592*        DATASET  (W-ARCH6-FILE-ID)
  8593*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8594*        RIDFLD   (W-ARCH6-KEY)
  8595*    END-EXEC.
  8596     MOVE 0
  8597       TO DFHEIV11
  8598*    MOVE '&0S                   )   #00007811' TO DFHEIV0
  8599     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8600     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8601     MOVE X'2020233030303037383131' TO DFHEIV0(25:11)
  8602     CALL 'kxdfhei1' USING DFHEIV0,
  8603           W-ARCH6-FILE-ID,
  8604           DFHEIV20,
  8605           DFHEIV99,
  8606           W-ARCH6-KEY,
  8607           DFHEIV99,
  8608           DFHEIV11,
  8609           DFHEIV99,
  8610           DFHEIV99
  8611     SET ADDRESS OF LETTER-ARCHIVE TO
  8612         DFHEIV20
  8613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8614
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 176
* EL690.cbl
  8615
  8616 7450-EXIT.
  8617     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 177
* EL690.cbl
  8619 7500-READ-ARCH-FILE-NEXT.
  8620
  8621
  8622* EXEC CICS READNEXT
  8623*        DATASET  (W-ARCH-FILE-ID)
  8624*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8625*        RIDFLD   (W-ARCH-KEY)
  8626*        END-EXEC.
  8627     MOVE 0
  8628       TO DFHEIV11
  8629*    MOVE '&.S                   )   #00007822' TO DFHEIV0
  8630     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8631     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8632     MOVE X'2020233030303037383232' TO DFHEIV0(25:11)
  8633     CALL 'kxdfhei1' USING DFHEIV0,
  8634           W-ARCH-FILE-ID,
  8635           DFHEIV20,
  8636           DFHEIV99,
  8637           W-ARCH-KEY,
  8638           DFHEIV99,
  8639           DFHEIV11,
  8640           DFHEIV99,
  8641           DFHEIV99
  8642     SET ADDRESS OF LETTER-ARCHIVE TO
  8643         DFHEIV20
  8644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8645
  8646
  8647 7500-EXIT.
  8648     EXIT.
  8649
  8650 7550-READ-PREV-ARCH.
  8651
  8652
  8653* EXEC CICS READPREV
  8654*        DATASET  (W-ARCH-FILE-ID)
  8655*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8656*        RIDFLD   (W-ARCH-KEY)
  8657*    END-EXEC.
  8658     MOVE 0
  8659       TO DFHEIV11
  8660*    MOVE '&0S                   )   #00007833' TO DFHEIV0
  8661     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8662     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8663     MOVE X'2020233030303037383333' TO DFHEIV0(25:11)
  8664     CALL 'kxdfhei1' USING DFHEIV0,
  8665           W-ARCH-FILE-ID,
  8666           DFHEIV20,
  8667           DFHEIV99,
  8668           W-ARCH-KEY,
  8669           DFHEIV99,
  8670           DFHEIV11,
  8671           DFHEIV99,
  8672           DFHEIV99
  8673     SET ADDRESS OF LETTER-ARCHIVE TO
  8674         DFHEIV20
  8675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8676
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 178
* EL690.cbl
  8677
  8678 7550-EXIT.
  8679     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 179
* EL690.cbl
  8681 7600-READ-ARCH-FILE.
  8682
  8683
  8684* EXEC CICS READ
  8685*        DATASET  (W-ARCH-FILE-ID)
  8686*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8687*        RIDFLD   (W-ARCH-KEY)
  8688*        UPDATE
  8689*        END-EXEC.
  8690*    MOVE '&"S        EU         (   #00007844' TO DFHEIV0
  8691     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8692     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8693     MOVE X'2020233030303037383434' TO DFHEIV0(25:11)
  8694     CALL 'kxdfhei1' USING DFHEIV0,
  8695           W-ARCH-FILE-ID,
  8696           DFHEIV20,
  8697           DFHEIV99,
  8698           W-ARCH-KEY,
  8699           DFHEIV99,
  8700           DFHEIV99,
  8701           DFHEIV99
  8702     SET ADDRESS OF LETTER-ARCHIVE TO
  8703         DFHEIV20
  8704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8705
  8706
  8707 7600-EXIT.
  8708     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 180
* EL690.cbl
  8710 7650-READ-ARCT-FILE.
  8711
  8712
  8713* EXEC CICS READ
  8714*        DATASET  (W-ARCT-FILE-ID)
  8715*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  8716*        RIDFLD   (W-ARCT-KEY)
  8717*        UPDATE
  8718*        END-EXEC.
  8719*    MOVE '&"S        EU         (   #00007856' TO DFHEIV0
  8720     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8721     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8722     MOVE X'2020233030303037383536' TO DFHEIV0(25:11)
  8723     CALL 'kxdfhei1' USING DFHEIV0,
  8724           W-ARCT-FILE-ID,
  8725           DFHEIV20,
  8726           DFHEIV99,
  8727           W-ARCT-KEY,
  8728           DFHEIV99,
  8729           DFHEIV99,
  8730           DFHEIV99
  8731     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  8732         DFHEIV20
  8733     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8734
  8735
  8736 7650-EXIT.
  8737     EXIT.
  8738
  8739 7750-READ-ARCH-FILE-NUPDT.
  8740
  8741
  8742* EXEC CICS READ
  8743*        DATASET  (W-ARCH-FILE-ID)
  8744*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8745*        RIDFLD   (W-ARCH-KEY)
  8746*        END-EXEC.
  8747*    MOVE '&"S        E          (   #00007868' TO DFHEIV0
  8748     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8749     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8750     MOVE X'2020233030303037383638' TO DFHEIV0(25:11)
  8751     CALL 'kxdfhei1' USING DFHEIV0,
  8752           W-ARCH-FILE-ID,
  8753           DFHEIV20,
  8754           DFHEIV99,
  8755           W-ARCH-KEY,
  8756           DFHEIV99,
  8757           DFHEIV99,
  8758           DFHEIV99
  8759     SET ADDRESS OF LETTER-ARCHIVE TO
  8760         DFHEIV20
  8761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8762
  8763
  8764 7750-EXIT.
  8765     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 181
* EL690.cbl
  8767 7800-DELETE-CYCLE.
  8768
  8769
  8770* EXEC CICS HANDLE CONDITION
  8771*        NOTFND  (7800-EXIT)
  8772*        ENDFILE (7800-EXIT)
  8773*        END-EXEC.
  8774*    MOVE '"$I''                  ! = #00007879' TO DFHEIV0
  8775     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8776     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8777     MOVE X'3D20233030303037383739' TO DFHEIV0(25:11)
  8778     CALL 'kxdfhei1' USING DFHEIV0
  8779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8780
  8781
  8782*    PERFORM 7650-READ-ARCT-FILE THRU 7650-EXIT.
  8783
  8784
  8785* EXEC CICS DELETE
  8786*        DATASET   (W-ARCT-FILE-ID)
  8787*        RIDFLD    (W-ARCT-KEY)
  8788*        KEYLENGTH (5)
  8789*        GENERIC
  8790*    END-EXEC.
  8791     MOVE 5
  8792       TO DFHEIV11
  8793*    MOVE '&(  RKG               &   #00007886' TO DFHEIV0
  8794     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  8795     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8796     MOVE X'2020233030303037383836' TO DFHEIV0(25:11)
  8797     CALL 'kxdfhei1' USING DFHEIV0,
  8798           W-ARCT-FILE-ID,
  8799           W-ARCT-KEY,
  8800           DFHEIV11,
  8801           DFHEIV99,
  8802           DFHEIV99
  8803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8804
  8805
  8806
  8807* EXEC CICS DELETE
  8808*        DATASET   (W-ARCH-FILE-ID)
  8809*        RIDFLD    (W-ARCH-KEY)
  8810*    END-EXEC.
  8811*    MOVE '&(  R                 &   #00007893' TO DFHEIV0
  8812     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8813     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8814     MOVE X'2020233030303037383933' TO DFHEIV0(25:11)
  8815     CALL 'kxdfhei1' USING DFHEIV0,
  8816           W-ARCH-FILE-ID,
  8817           W-ARCH-KEY,
  8818           DFHEIV99,
  8819           DFHEIV99,
  8820           DFHEIV99
  8821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8822
  8823
  8824     MOVE +99999999            TO PI-690-ARCHIVE-NUM (W-ARCH-NDX).
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 182
* EL690.cbl
  8825     MOVE 1                      TO W-FIRST-CHANGE-IND.
  8826
  8827 7800-EXIT.
  8828     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 183
* EL690.cbl
  8830 8000-UNAUTHORIZED-ACCESS.
  8831
  8832     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8833     GO TO 8300-SEND-TEXT.
  8834
  8835 8000-ARCH2-NOT-OPEN.
  8836
  8837     MOVE ER-7357                TO EMI-ERROR.
  8838     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8839     MOVE -1                     TO TYPEBRL.
  8840
  8841     GO TO 8100-SEND-INITIAL-MAP.
  8842
  8843 8010-ARCH3-NOT-OPEN.
  8844
  8845     MOVE ER-7366                TO EMI-ERROR.
  8846     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8847     MOVE -1                     TO TYPEBRL.
  8848
  8849     GO TO 8100-SEND-INITIAL-MAP.
  8850
  8851 8020-ARCH4-NOT-OPEN.
  8852
  8853     MOVE ER-7385                TO EMI-ERROR.
  8854     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8855     MOVE -1                     TO TYPEBRL.
  8856
  8857     GO TO 8100-SEND-INITIAL-MAP.
  8858
  8859 8030-ARCH5-NOT-OPEN.
  8860
  8861     MOVE ER-7386                TO EMI-ERROR.
  8862     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8863     MOVE -1                     TO TYPEBRL.
  8864
  8865     GO TO 8100-SEND-INITIAL-MAP.
  8866
  8867 8040-ARCH6-NOT-OPEN.
  8868
  8869     MOVE ER-7387                TO EMI-ERROR.
  8870     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8871     MOVE -1                     TO TYPEBRL.
  8872
  8873     GO TO 8100-SEND-INITIAL-MAP.
  8874
  8875 8050-ARCH-NOT-OPEN.
  8876
  8877     MOVE ER-7388                TO EMI-ERROR.
  8878     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8879     MOVE -1                     TO TYPEBRL.
  8880
  8881     GO TO 8100-SEND-INITIAL-MAP.
  8882
  8883 8070-NOTOPEN.
  8884
  8885     MOVE ER-9282                TO EMI-ERROR.
  8886     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8887     MOVE -1                     TO CERTRPL.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 184
* EL690.cbl
  8888
  8889     GO TO 8100-SEND-INITIAL-MAP.
  8890
  8891 8080-ARCH-NOT-FOUND.
  8892
  8893     MOVE ER-9010                TO EMI-ERROR.
  8894     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8895     MOVE -1                     TO CERTRPL.
  8896     MOVE AL-UABON               TO CERTRPA.
  8897     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 185
* EL690.cbl
  8899
  8900 8090-NOT-FOUND-CNTL.
  8901
  8902     MOVE ER-0190                TO EMI-ERROR.
  8903     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8904     MOVE -1                     TO MAINTL.
  8905     MOVE AL-UABON               TO MAINTA.
  8906     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 186
* EL690.cbl
  8908 8100-SEND-INITIAL-MAP.
  8909******************************************************************
  8910*                                                                *
  8911*       THIS LOGIC SENDS THE INITIAL MAP.  IT WILL LOOK FOR      *
  8912*       THE MAP DATA UNDER THE NAMES LISTED BELOW AND FOUND      *
  8913*       IN THE WORK AREA SECTION OF WORKING STORAGE.             *
  8914*                                                                *
  8915*       W-MAP          PIC  X(08)                                *
  8916*       W-MAPSET       PIC  X(08)                                *
  8917*       W-MAP-AREA     PIC  X(**)                                *
  8918* ** THIS AREA REDEFINES MAP AREA AND IS MAP DEPENDENT           *
  8919*    FOR SIZE.                                                   *
  8920*                                                                *
  8921******************************************************************
  8922
  8923     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  8924
  8925     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8926
  8927
  8928* EXEC CICS SEND
  8929*        MAP    (W-MAP)
  8930*        MAPSET (W-MAPSET)
  8931*        FROM   (EL690AI)
  8932*        ERASE
  8933*        FREEKB
  8934*        CURSOR
  8935*    END-EXEC.
  8936     MOVE LENGTH OF
  8937      EL690AI
  8938       TO DFHEIV12
  8939     MOVE -1
  8940       TO DFHEIV11
  8941*    MOVE '8$     CT  E F  H L F ,   #00008001' TO DFHEIV0
  8942     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8943     MOVE X'2046202048204C2046202C20' TO DFHEIV0(13:12)
  8944     MOVE X'2020233030303038303031' TO DFHEIV0(25:11)
  8945     CALL 'kxdfhei1' USING DFHEIV0,
  8946           W-MAP,
  8947           EL690AI,
  8948           DFHEIV12,
  8949           W-MAPSET,
  8950           DFHEIV99,
  8951           DFHEIV99,
  8952           DFHEIV99,
  8953           DFHEIV11,
  8954           DFHEIV99,
  8955           DFHEIV99,
  8956           DFHEIV99
  8957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8958
  8959
  8960     GO TO 9000-RETURN-TRANS.
  8961
  8962 8100-EXIT.
  8963     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 187
* EL690.cbl
  8965 8200-SEND-DATAONLY.
  8966******************************************************************
  8967*                                                                *
  8968*       THIS LOGIC SENDS THE UPDATED VERSION OF THE MAP, USING   *
  8969*       THE FIELDS LISTED BELOW WHICH SHOULD BE FOUND IN THE     *
  8970*       WORK AREA OF WORKING STORAGE.                            *
  8971*                                                                *
  8972*       W-MAP           PIC  X(08)                               *
  8973*       W-MAPSET        PIC  X(08)                               *
  8974*       W-MAP-AREA      PIC  X(****)                             *
  8975*                                                                *
  8976* **** REDEFINES MAP AREA AND IS MAP DEPENDENT.                  *
  8977*                                                                *
  8978******************************************************************
  8979
  8980     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  8981
  8982     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8983
  8984
  8985* EXEC CICS SEND
  8986*        MAP    (W-MAP)
  8987*        MAPSET (W-MAPSET)
  8988*        FROM   (EL690AI)
  8989*        DATAONLY
  8990*        FREEKB
  8991*        CURSOR
  8992*    END-EXEC.
  8993     MOVE LENGTH OF
  8994      EL690AI
  8995       TO DFHEIV12
  8996     MOVE -1
  8997       TO DFHEIV11
  8998*    MOVE '8$D    CT    F  H L F ,   #00008034' TO DFHEIV0
  8999     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9000     MOVE X'2046202048204C2046202C20' TO DFHEIV0(13:12)
  9001     MOVE X'2020233030303038303334' TO DFHEIV0(25:11)
  9002     CALL 'kxdfhei1' USING DFHEIV0,
  9003           W-MAP,
  9004           EL690AI,
  9005           DFHEIV12,
  9006           W-MAPSET,
  9007           DFHEIV99,
  9008           DFHEIV99,
  9009           DFHEIV99,
  9010           DFHEIV11,
  9011           DFHEIV99,
  9012           DFHEIV99,
  9013           DFHEIV99
  9014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9015
  9016
  9017     GO TO 9000-RETURN-TRANS.
  9018
  9019 8200-EXIT.
  9020     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 188
* EL690.cbl
  9022 8300-SEND-TEXT.
  9023*****************************************************************
  9024*    THIS PARAGRAPH SENDS THE COMMON LOGOFF MESSAGE.            *
  9025*****************************************************************
  9026
  9027
  9028* EXEC CICS SEND TEXT
  9029*        FROM    (LOGOFF-TEXT)
  9030*        LENGTH  (LOGOFF-LENGTH)
  9031*        ERASE
  9032*        FREEKB
  9033*    END-EXEC.
  9034*    MOVE '8&      T  E F  H   F -   #00008053' TO DFHEIV0
  9035     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9036     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9037     MOVE X'2020233030303038303533' TO DFHEIV0(25:11)
  9038     CALL 'kxdfhei1' USING DFHEIV0,
  9039           LOGOFF-TEXT,
  9040           LOGOFF-LENGTH,
  9041           DFHEIV99,
  9042           DFHEIV99,
  9043           DFHEIV99,
  9044           DFHEIV99,
  9045           DFHEIV99,
  9046           DFHEIV99,
  9047           DFHEIV99,
  9048           DFHEIV99,
  9049           DFHEIV99,
  9050           DFHEIV99
  9051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9052
  9053
  9054     GO TO 9000-RETURN-TRANS.
  9055
  9056 8300-EXIT.
  9057     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 189
* EL690.cbl
  9059 9000-RETURN-TRANS.
  9060*****************************************************************
  9061*     THIS PARAGRAPH CAUSES THE PROGRAM TO EXIT TO A            *
  9062*     TRANSACTION.                                              *
  9063*     THE FOLLOWING FIELDS ARE NEEDED IN WORKING-STORAGE        *
  9064*     W-TRANSACTION          PIC  X(04)  VALUE 'XXXX'.          *
  9065*****************************************************************
  9066
  9067     MOVE EMI-ERROR-NUMBER(1)    TO PI-LAST-ERROR-NO.
  9068
  9069
  9070* EXEC CICS RETURN
  9071*        TRANSID  (W-TRANSACTION)
  9072*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9073*        LENGTH   (PI-COMM-LENGTH)
  9074*    END-EXEC.
  9075*    MOVE '.(CT                  ''   #00008075' TO DFHEIV0
  9076     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9077     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9078     MOVE X'2020233030303038303735' TO DFHEIV0(25:11)
  9079     CALL 'kxdfhei1' USING DFHEIV0,
  9080           W-TRANSACTION,
  9081           PROGRAM-INTERFACE-BLOCK,
  9082           PI-COMM-LENGTH,
  9083           DFHEIV99,
  9084           DFHEIV99,
  9085           DFHEIV99
  9086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9087
  9088
  9089 9000-EXIT.
  9090     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 190
* EL690.cbl
  9092 9200-DATE-EDIT.
  9093*****************************************************************
  9094*     THIS ROUTINE VALIDATES THE DATE PASSED IN THE             *
  9095*     'W-DEEDIT-FIELD' BY CALLING THE 'ELDATECV' PROGRAM.       *
  9096*     AFTER EXITING THIS COPY BOOK, 'DC-ERROR-CODE' CAN BE      *
  9097*     CHECKED FOR SPACES TO DETERMINE IF ERRORS WERE FOUND      *
  9098*     ELSE THE BINARY DATE CAN BE FOUND IN 'DC-BIN-DATE-1'.     *
  9099*****************************************************************
  9100
  9101
  9102* EXEC CICS BIF DEEDIT
  9103*        FIELD  (W-DEEDIT-FIELD)
  9104*        LENGTH (15)
  9105*    END-EXEC.
  9106     MOVE 15
  9107       TO DFHEIV11
  9108*    MOVE '@"L                   #   #00008093' TO DFHEIV0
  9109     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9110     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9111     MOVE X'2020233030303038303933' TO DFHEIV0(25:11)
  9112     CALL 'kxdfhei1' USING DFHEIV0,
  9113           W-DEEDIT-FIELD,
  9114           DFHEIV11
  9115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9116
  9117
  9118     IF  W-DEEDIT-FIELD-V0 NUMERIC
  9119         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-EDIT
  9120                                    DC-GREG-DATE-1-MDY
  9121         INSPECT DC-GREG-DATE-1-EDIT CONVERTING ' ' TO '/'
  9122*        INSPECT DC-GREG-DATE-1-EDIT REPLACING ALL ' ' BY '/'
  9123         MOVE '4'                TO DC-OPTION-CODE
  9124
  9125         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9126
  9127     ELSE
  9128         MOVE HIGH-VALUES        TO  DC-ERROR-CODE.
  9129
  9130 9200-EXIT.
  9131     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 191
* EL690.cbl
  9133 9400-XCTL.
  9134*****************************************************************
  9135*    THIS PARAGRAPH TRANSFERS CONTROL TO INDICATED PROGRAM.     *
  9136*    PROGRAM MUST RESIDE IN W-CALL-PGM.                         *
  9137*****************************************************************
  9138
  9139
  9140* EXEC CICS XCTL
  9141*        PROGRAM  (W-CALL-PGM)
  9142*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9143*        LENGTH   (PI-COMM-LENGTH)
  9144*    END-EXEC.
  9145*    MOVE '.$C                   %   #00008119' TO DFHEIV0
  9146     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9147     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9148     MOVE X'2020233030303038313139' TO DFHEIV0(25:11)
  9149     CALL 'kxdfhei1' USING DFHEIV0,
  9150           W-CALL-PGM,
  9151           PROGRAM-INTERFACE-BLOCK,
  9152           PI-COMM-LENGTH,
  9153           DFHEIV99
  9154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9155
  9156
  9157 9400-EXIT.
  9158     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 192
* EL690.cbl
  9160 9500-LINK-DATE-CONVERT.
  9161*****************************************************************
  9162*    THIS PARAGRAPH 'CALLS' THE UTILITY DATE PROCESSOR.         *
  9163*****************************************************************
  9164
  9165
  9166* EXEC CICS LINK
  9167*        PROGRAM    ('ELDATCV')
  9168*        COMMAREA   (DATE-CONVERSION-DATA)
  9169*        LENGTH     (DC-COMM-LENGTH)
  9170*        END-EXEC.
  9171     MOVE 'ELDATCV' TO DFHEIV1
  9172*    MOVE '."C                   (   #00008133' TO DFHEIV0
  9173     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9174     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9175     MOVE X'2020233030303038313333' TO DFHEIV0(25:11)
  9176     CALL 'kxdfhei1' USING DFHEIV0,
  9177           DFHEIV1,
  9178           DATE-CONVERSION-DATA,
  9179           DC-COMM-LENGTH,
  9180           DFHEIV99,
  9181           DFHEIV99,
  9182           DFHEIV99,
  9183           DFHEIV99
  9184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9185
  9186
  9187 9500-EXIT.
  9188     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 193
* EL690.cbl
  9190 9600-FORMAT-DATE-TIME.
  9191*****************************************************************
  9192*     THIS LOGIC UPDATES THE DATE/TIME INFO ON GIVEN MAP        *
  9193*****************************************************************
  9194
  9195     MOVE W-SAVE-DATE            TO RUNDTEO.
  9196
  9197
  9198* EXEC CICS ASKTIME
  9199*    END-EXEC.
  9200*    MOVE '0"                    "   #00008149' TO DFHEIV0
  9201     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  9202     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  9203     MOVE X'2020233030303038313439' TO DFHEIV0(25:11)
  9204     CALL 'kxdfhei1' USING DFHEIV0,
  9205           DFHEIV99
  9206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9207
  9208
  9209     MOVE EIBTIME                TO W-TIME-IN.
  9210     MOVE W-TIME-OUT             TO RUNTIMEO.
  9211     MOVE PI-COMPANY-ID          TO COMPANYO.
  9212     MOVE PI-PROCESSOR-ID        TO USERIDO.
  9213     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
  9214
  9215 9600-EXIT.
  9216     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 194
* EL690.cbl
  9218 9700-PGMID-ERROR.
  9219*****************************************************************
  9220*     THIS PARAGRAPH TRANSFERS CONTROL TO EL005 LOGOFF.         *
  9221*     THE FOLLOWING FIELDS ARE NEEDED IN WORKING-STORAGE        *
  9222*     W-CALL-PGM             PIC  X(08)  VALUE 'EL000   '.      *
  9223*     W-THIS-PGM             PIC  X(08).                        *
  9224*     W-XCTL-005             PIC  X(08)  VALUE 'EL005   '.      *
  9225*****************************************************************
  9226
  9227
  9228* EXEC CICS  HANDLE CONDITION
  9229*        PGMIDERR  (8300-SEND-TEXT)
  9230*        END-EXEC.
  9231*    MOVE '"$L                   ! > #00008170' TO DFHEIV0
  9232     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9233     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9234     MOVE X'3E20233030303038313730' TO DFHEIV0(25:11)
  9235     CALL 'kxdfhei1' USING DFHEIV0
  9236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9237
  9238
  9239     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
  9240     MOVE ' '                    TO PI-ENTRY-CD-1.
  9241     MOVE W-XCTL-005             TO W-CALL-PGM
  9242                                    LOGOFF-PGM.
  9243     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  9244
  9245     PERFORM 9400-XCTL THRU 9400-EXIT.
  9246
  9247 9700-EXIT.
  9248     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 195
* EL690.cbl
  9250 9800-ABEND.
  9251*****************************************************************
  9252*     THIS PARAGRAPH LINKS TO A COMMON ABEND ROUTINE.           *
  9253*     THE FOLLOWING FIELDS ARE NEEDED IN WORKING-STORAGE        *
  9254*     W-LINK-004             PIC  X(08)  VALUE 'EL004   '.      *
  9255*****************************************************************
  9256
  9257     MOVE W-LINK-004             TO W-CALL-PGM.
  9258     MOVE DFHEIBLK               TO EMI-LINE1
  9259
  9260
  9261* EXEC CICS  LINK
  9262*        PROGRAM   (W-CALL-PGM)
  9263*        COMMAREA  (EMI-LINE1)
  9264*        LENGTH    (72)
  9265*        END-EXEC.
  9266     MOVE 72
  9267       TO DFHEIV11
  9268*    MOVE '."C                   (   #00008195' TO DFHEIV0
  9269     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9270     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9271     MOVE X'2020233030303038313935' TO DFHEIV0(25:11)
  9272     CALL 'kxdfhei1' USING DFHEIV0,
  9273           W-CALL-PGM,
  9274           EMI-LINE1,
  9275           DFHEIV11,
  9276           DFHEIV99,
  9277           DFHEIV99,
  9278           DFHEIV99,
  9279           DFHEIV99
  9280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9281
  9282
  9283     GO TO 8200-SEND-DATAONLY.
  9284
  9285 9800-EXIT.
  9286     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 196
* EL690.cbl
  9288 9900-ERROR-FORMAT.
  9289*****************************************************************
  9290*     THIS PARAGRAPH IS THE STANDARDIZED ERROR FORMAT ROUTINE.  *
  9291*     THE FIELDS W-LINK-001 AND W-CALL-PGM MUST BE DEFINED IN   *
  9292*     WORKING STORAGE.                                          *
  9293*****************************************************************
  9294
  9295     IF  NOT EMI-ERRORS-COMPLETE
  9296             AND
  9297         EMI-ERROR NOT EQUAL W-LAST-ERROR
  9298         MOVE W-LINK-001         TO W-CALL-PGM
  9299
  9300
  9301* EXEC CICS LINK
  9302*            PROGRAM    (W-CALL-PGM)
  9303*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  9304*            LENGTH     (EMI-COMM-LENGTH)
  9305*        END-EXEC
  9306*    MOVE '."C                   (   #00008218' TO DFHEIV0
  9307     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9308     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9309     MOVE X'2020233030303038323138' TO DFHEIV0(25:11)
  9310     CALL 'kxdfhei1' USING DFHEIV0,
  9311           W-CALL-PGM,
  9312           ERROR-MESSAGE-INTERFACE-BLOCK,
  9313           EMI-COMM-LENGTH,
  9314           DFHEIV99,
  9315           DFHEIV99,
  9316           DFHEIV99,
  9317           DFHEIV99
  9318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9319
  9320         MOVE EMI-ERROR TO W-LAST-ERROR.
  9321
  9322 9900-EXIT.
  9323     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 197
* EL690.cbl
  9325 9910-INITIALIZE-SECURITY.
  9326******************************************************************
  9327*                                                                *
  9328*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  9329*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
  9330*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
  9331*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
  9332*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  9333*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  9334*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  9335*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  9336*                                                                *
  9337*       NOTE:  THE CARRIER/GRP/STATE/PRODUCER SECURITY DATA      *
  9338*       IS ALSO PROVIDED BY THIS LOGIC.                          *
  9339*                                                                *
  9340******************************************************************
  9341
  9342     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
  9343         MOVE 'Y'                TO PI-DISPLAY-CAP
  9344                                        PI-MODIFY-CAP
  9345
  9346     ELSE
  9347*        MOVE '125E'             TO W-SC-QUID-SYSTEM
  9348*        MOVE EIBTRMID           TO W-SC-QUID-TERMINAL
  9349
  9350
  9351* EXEC CICS READQ TS
  9352*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  9353*            INTO   (SECURITY-CONTROL)
  9354*            LENGTH (SC-COMM-LENGTH)
  9355*            ITEM   (1)
  9356*        END-EXEC
  9357     MOVE 1
  9358       TO DFHEIV11
  9359*    MOVE '*$II   L              ''   #00008254' TO DFHEIV0
  9360     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  9361     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9362     MOVE X'2020233030303038323534' TO DFHEIV0(25:11)
  9363     CALL 'kxdfhei1' USING DFHEIV0,
  9364           PI-SECURITY-TEMP-STORE-ID,
  9365           SECURITY-CONTROL,
  9366           SC-COMM-LENGTH,
  9367           DFHEIV11,
  9368           DFHEIV99,
  9369           DFHEIV99
  9370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9371
  9372         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
  9373                                 TO PI-DISPLAY-CAP
  9374         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
  9375                                 TO PI-MODIFY-CAP
  9376
  9377         IF  NOT DISPLAY-CAP
  9378             MOVE 'READ'         TO SM-READ
  9379             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  9380             MOVE ER-9097        TO EMI-ERROR
  9381             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9382             GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 198
* EL690.cbl
  9383
  9384 9910-EXIT.
  9385     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 199
* EL690.cbl
  9387 9995-SECURITY-VIOLATION.
  9388
  9389     MOVE EIBDATE          TO SM-JUL-DATE.
  9390     MOVE EIBTRMID         TO SM-TERMID.
  9391     MOVE W-THIS-PGM       TO SM-PGM.
  9392     MOVE EIBTIME          TO W-TIME-IN.
  9393     MOVE W-TIME-OUT       TO SM-TIME.
  9394     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9395
  9396
  9397* EXEC CICS LINK
  9398*         PROGRAM  ('EL003')
  9399*         COMMAREA (SECURITY-MESSAGE)
  9400*         LENGTH   (80)
  9401*    END-EXEC.
  9402     MOVE 'EL003' TO DFHEIV1
  9403     MOVE 80
  9404       TO DFHEIV11
  9405*    MOVE '."C                   (   #00008285' TO DFHEIV0
  9406     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9407     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9408     MOVE X'2020233030303038323835' TO DFHEIV0(25:11)
  9409     CALL 'kxdfhei1' USING DFHEIV0,
  9410           DFHEIV1,
  9411           SECURITY-MESSAGE,
  9412           DFHEIV11,
  9413           DFHEIV99,
  9414           DFHEIV99,
  9415           DFHEIV99,
  9416           DFHEIV99
  9417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9418
  9419
  9420 9995-EXIT.
  9421     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 200
* EL690.cbl
  9423 9999-GOBACK.
  9424******************************************************************
  9425*                                                                *
  9426*       THIS PARAGRAPH FULFILL THE COMPILE REQUIRMENT FOR A      *
  9427*       COBOL RETURN COMMAND.  IN A SEPARATE PARAGRAPH IT        *
  9428*       PREVENTS AN COMPILE ERROR.                               *
  9429*                                                                *
  9430******************************************************************
  9431
  9432
  9433* GOBACK.
  9434     MOVE '9%                    "   ' TO DFHEIV0
  9435     MOVE 'EL690' TO DFHEIV1
  9436     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9437     GOBACK.
  9438
  9439 9999-EXIT.
  9440     EXIT.
  9441
  9442 9999-DFHBACK SECTION.
  9443     MOVE '9%                    "   ' TO DFHEIV0
  9444     MOVE 'EL690' TO DFHEIV1
  9445     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9446     GOBACK.
  9447 9999-DFHEXIT.
  9448     IF DFHEIGDJ EQUAL 0001
  9449         NEXT SENTENCE
  9450     ELSE IF DFHEIGDJ EQUAL 2
  9451         GO TO 0110-PGM-INITIALIZATION,
  9452               0110-PGM-INITIALIZATION,
  9453               8070-NOTOPEN,
  9454               8080-ARCH-NOT-FOUND,
  9455               9700-PGMID-ERROR,
  9456               9800-ABEND
  9457         DEPENDING ON DFHEIGDI
  9458     ELSE IF DFHEIGDJ EQUAL 3
  9459         GO TO 8080-ARCH-NOT-FOUND,
  9460               8080-ARCH-NOT-FOUND
  9461         DEPENDING ON DFHEIGDI
  9462     ELSE IF DFHEIGDJ EQUAL 4
  9463         GO TO 8080-ARCH-NOT-FOUND,
  9464               8080-ARCH-NOT-FOUND
  9465         DEPENDING ON DFHEIGDI
  9466     ELSE IF DFHEIGDJ EQUAL 5
  9467         GO TO 8080-ARCH-NOT-FOUND,
  9468               8080-ARCH-NOT-FOUND,
  9469               8000-ARCH2-NOT-OPEN
  9470         DEPENDING ON DFHEIGDI
  9471     ELSE IF DFHEIGDJ EQUAL 6
  9472         GO TO 2100-END-BROWSE,
  9473               2100-END-BROWSE
  9474         DEPENDING ON DFHEIGDI
  9475     ELSE IF DFHEIGDJ EQUAL 7
  9476         GO TO 8080-ARCH-NOT-FOUND,
  9477               8080-ARCH-NOT-FOUND,
  9478               8010-ARCH3-NOT-OPEN
  9479         DEPENDING ON DFHEIGDI
  9480     ELSE IF DFHEIGDJ EQUAL 8
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 201
* EL690.cbl
  9481         GO TO 2200-END-BROWSE,
  9482               2200-END-BROWSE
  9483         DEPENDING ON DFHEIGDI
  9484     ELSE IF DFHEIGDJ EQUAL 9
  9485         GO TO 8080-ARCH-NOT-FOUND,
  9486               8080-ARCH-NOT-FOUND,
  9487               8020-ARCH4-NOT-OPEN
  9488         DEPENDING ON DFHEIGDI
  9489     ELSE IF DFHEIGDJ EQUAL 10
  9490         GO TO 2300-END-BROWSE,
  9491               2300-END-BROWSE
  9492         DEPENDING ON DFHEIGDI
  9493     ELSE IF DFHEIGDJ EQUAL 11
  9494         GO TO 8080-ARCH-NOT-FOUND,
  9495               8080-ARCH-NOT-FOUND,
  9496               8030-ARCH5-NOT-OPEN
  9497         DEPENDING ON DFHEIGDI
  9498     ELSE IF DFHEIGDJ EQUAL 12
  9499         GO TO 2400-END-BROWSE,
  9500               2400-END-BROWSE
  9501         DEPENDING ON DFHEIGDI
  9502     ELSE IF DFHEIGDJ EQUAL 13
  9503         GO TO 8080-ARCH-NOT-FOUND,
  9504               8080-ARCH-NOT-FOUND,
  9505               8040-ARCH6-NOT-OPEN
  9506         DEPENDING ON DFHEIGDI
  9507     ELSE IF DFHEIGDJ EQUAL 14
  9508         GO TO 2500-END-BROWSE,
  9509               2500-END-BROWSE
  9510         DEPENDING ON DFHEIGDI
  9511     ELSE IF DFHEIGDJ EQUAL 15
  9512         GO TO 8080-ARCH-NOT-FOUND,
  9513               8080-ARCH-NOT-FOUND,
  9514               8050-ARCH-NOT-OPEN
  9515         DEPENDING ON DFHEIGDI
  9516     ELSE IF DFHEIGDJ EQUAL 16
  9517         GO TO 2600-END-BROWSE,
  9518               2600-END-BROWSE
  9519         DEPENDING ON DFHEIGDI
  9520     ELSE IF DFHEIGDJ EQUAL 17
  9521         GO TO 8080-ARCH-NOT-FOUND,
  9522               8080-ARCH-NOT-FOUND,
  9523               8000-ARCH2-NOT-OPEN
  9524         DEPENDING ON DFHEIGDI
  9525     ELSE IF DFHEIGDJ EQUAL 18
  9526         GO TO 3100-END-BROWSE,
  9527               3100-END-BROWSE
  9528         DEPENDING ON DFHEIGDI
  9529     ELSE IF DFHEIGDJ EQUAL 19
  9530         GO TO 8080-ARCH-NOT-FOUND,
  9531               8080-ARCH-NOT-FOUND,
  9532               8010-ARCH3-NOT-OPEN
  9533         DEPENDING ON DFHEIGDI
  9534     ELSE IF DFHEIGDJ EQUAL 20
  9535         GO TO 3200-END-BROWSE,
  9536               3200-END-BROWSE
  9537         DEPENDING ON DFHEIGDI
  9538     ELSE IF DFHEIGDJ EQUAL 21
* Micro Focus Server Express         V5.1 revision 000 20-Dec-12 06:20 Page 202
* EL690.cbl
  9539         GO TO 8080-ARCH-NOT-FOUND,
  9540               8080-ARCH-NOT-FOUND,
  9541               8020-ARCH4-NOT-OPEN
  9542         DEPENDING ON DFHEIGDI
  9543     ELSE IF DFHEIGDJ EQUAL 22
  9544         GO TO 3300-END-BROWSE,
  9545               3300-END-BROWSE
  9546         DEPENDING ON DFHEIGDI
  9547     ELSE IF DFHEIGDJ EQUAL 23
  9548         GO TO 8080-ARCH-NOT-FOUND,
  9549               8080-ARCH-NOT-FOUND,
  9550               8030-ARCH5-NOT-OPEN
  9551         DEPENDING ON DFHEIGDI
  9552     ELSE IF DFHEIGDJ EQUAL 24
  9553         GO TO 3400-END-BROWSE,
  9554               3400-END-BROWSE
  9555         DEPENDING ON DFHEIGDI
  9556     ELSE IF DFHEIGDJ EQUAL 25
  9557         GO TO 8080-ARCH-NOT-FOUND,
  9558               8080-ARCH-NOT-FOUND,
  9559               8040-ARCH6-NOT-OPEN
  9560         DEPENDING ON DFHEIGDI
  9561     ELSE IF DFHEIGDJ EQUAL 26
  9562         GO TO 3500-END-BROWSE,
  9563               3500-END-BROWSE
  9564         DEPENDING ON DFHEIGDI
  9565     ELSE IF DFHEIGDJ EQUAL 27
  9566         GO TO 8080-ARCH-NOT-FOUND,
  9567               8080-ARCH-NOT-FOUND,
  9568               8050-ARCH-NOT-OPEN
  9569         DEPENDING ON DFHEIGDI
  9570     ELSE IF DFHEIGDJ EQUAL 28
  9571         GO TO 3600-END-BROWSE,
  9572               3600-END-BROWSE
  9573         DEPENDING ON DFHEIGDI
  9574     ELSE IF DFHEIGDJ EQUAL 29
  9575         GO TO 7800-EXIT,
  9576               7800-EXIT
  9577         DEPENDING ON DFHEIGDI
  9578     ELSE IF DFHEIGDJ EQUAL 30
  9579         GO TO 8300-SEND-TEXT
  9580         DEPENDING ON DFHEIGDI.
  9581     MOVE '9%                    "   ' TO DFHEIV0
  9582     MOVE 'EL690' TO DFHEIV1
  9583     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9584     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6760     Code:       24923
