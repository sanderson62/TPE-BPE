* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page   1
* EL156.cbl
* Options: int("EL156.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL156.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL156.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL156.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL156 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/17/94 13:55:56.
     7*                            VMOD=2.098
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*REMARKS.    TRANSACTION - EX29 - PAYMENT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page   2
* EL156.cbl
    14******************************************************************
    15*                   C H A N G E   L O G
    16*
    17* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    18*-----------------------------------------------------------------
    19*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    20* EFFECTIVE    NUMBER
    21*-----------------------------------------------------------------
    22* 121802    2001061800003  SMVA  ADD PROCESSING FOR NEW CLM TYPE I
    23* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST CALC
    24* 052506    2006030600001  AJRA  ADD PROOF DATE
    25* 071806    2004040700004  PEMA  ADD TONYS PROOF DATE TO INT CALC
    26* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    27* 110807  IR2007110700001  AJRA  DO NOT CALC INT ON MANUAL PMTS
    28* 022208    2008021500001  AJRA  DO NOT DEFAULT PROOF DATE,FORCE E
    29* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
    30* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    31* 091808    2008022800002  AJRA  GET CHECK NUMBER FROM STATE CNTL
    32* 012810    2007111300001  AJRA  EXPAND EDIT PATTERN
    33* 041710    2007111300001  AJRA  ADD MSG AND CALC PMT FOR SC NET P
    34* 092310  IR2010090900001  PEMA  CHANGE CRIT PERIOD EDIT
    35* 112210    2010091000003  AJRA  MICHIGAN FULL MONTH ON 1ST PAYMEN
    36* 042011  CR2011040600001  PEMA  ADD EOB PROCESSING FOR DCC
    37* 061511    2011042000002  AJRA  VERIFY 2ND BENEFICIARY SSN
    38* 030512    2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 041812  IR2012041800001  AJRA  FIX TERM/REM ON SCREEN
    40* 013013    2012092400003  AJRA  SPECIAL EOB FOR ACCELERATED DEATH
    41* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
    42* 020513    2012092400005  AJRA  LIFE PAYEE NAME SHOULD NOT = INS
    43* 032813    2011013100001  AJRA  SELECT CLAIM PAYMENTS FOR REAUDIT
    44* 061013    2012113000002  PEMA  ADD SPECIAL STUFF FOR SPP DDF
    45* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
    46* 110513    2013102900002  AJRA  FIX AK PAYEE STATE CODE ROUTINE
    47* 102413    2013100800001  AJRA  ADD SPECIAL RELEASE IND
    48* 111113    2013110600002  AJRA  CHG LEVEL 5 RESTRICTIONS TO LEVEL
    49* 030514    2014021300001  AJRA  FORCE LF PAYMENT > BENEFIT AMT
    50* 032414    2013092400002  AJRA  LIFE ADDIT PMTS TO ESTATE SHOULD
    51* 032514    2013111100001  AJRA  VERIFY SSN FOR DISAB PMTS
    52* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
    53* 052814  CR2014041800001  AJRA  SET APPROVAL FLAG FOR 3550 MESSAG
    54* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    55* 070714    2014052800001  PEMA  correct read on erpdef for DCC
    56* 100314  CR2014061900001  PEMA  Add pct of benefit funcionality
    57* 111714  CR2014073000001  PEMA  DRAFTS TO CHECKS
    58* 032015  CR2014121000003  TANA  Default prnt survey to 'N'for DCC
    59* 110515  IR2015103000001  TANA  Check app level for 3550 message
    60******************************************************************
    61
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page   3
* EL156.cbl
    63 ENVIRONMENT DIVISION.
    64
    65 DATA DIVISION.
    66
    67 WORKING-STORAGE SECTION.
    68 01  DFH-START PIC X(04).
    69
    70 77  FILLER  PIC X(32)  VALUE '********************************'.
    71 77  FILLER  PIC X(32)  VALUE '*    EL156 WORKING STORAGE     *'.
    72 77  FILLER  PIC X(32)  VALUE '********** VMOD=2.098 **********'.
    73 77  WS-SSN  PIC X(9) VALUE ZEROS.
    74 77  WS-SET-NOTE2-MDT            PIC X  VALUE SPACES.
    75 77  C0                          PIC S999 COMP-3 VALUE +0.
    76 77  C1                          PIC S999 COMP-3 VALUE +0.
    77 77  C2                          PIC S999 COMP-3 VALUE +0.
    78 77  C3                          PIC S999 COMP-3 VALUE +0.
    79 77  s1                          PIC S999 COMP-3 VALUE +0.
    80 77  s2                          pic s999 comp-3 value +0.
    81 77  P1                          PIC S999 COMP-3 VALUE +0.
    82 77  WS-DDF-COMM-AND-MFEE        PIC S9(5)V99 VALUE +0 COMP-3.
    83 77  WS-DDF-ADMIN-FEES           PIC S9(5)V99 VALUE +0 COMP-3.
    84 77  WS-DDF-CSO-ADMIN-FEE        PIC S9(5)V99 VALUE +0 COMP-3.
    85 77  WS-DDF-1ST-YR-TOT-EXP       PIC S9(5)V99 VALUE +0 COMP-3.
    86 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
    87 77  TEX-FACT-8                  PIC S9V9(6)     COMP-3.
    88 77  WS-COMM-PCT                 PIC S9(5)V9(5)  COMP-3 VALUE +0.
    89 77  WS-TERM                     PIC S999 COMP-3 VALUE +0.
    90 77  ws-monthly-benefit          pic s9(11)v99 comp-3 value +0.
    91 77  ws-max-bens                 pic s999 comp-3 value +0.
    92 77  ws-prev-days-paid           pic s9(5) comp-3 value +0.
    93 77  ws-prev-amt-paid            pic s9(9)v99 comp-3 value +0.
    94 77  ws-tot-days-paid            pic s9(5) comp-3 value +0.
    95 77  ws-tot-amt-paid             pic s9(9)v99 comp-3 value +0.
    96 77  ws-pd-bens                  pic s9(5) comp-3 value +0.
    97 77  ws-work-ben-pct             pic s9v999 comp-3 value +0.
    98
    99*    COPY ELCSCTM.
   100******************************************************************
   101*                                                                *
   102*                                                                *
   103*                            ELCSCTM                             *
   104*                            VMOD=2.001                          *
   105*                                                                *
   106*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   107*                                                                *
   108******************************************************************
   109 01  SECURITY-MESSAGE.
   110     12  FILLER                          PIC X(30)
   111            VALUE '** LOGIC SECURITY VIOLATION -'.
   112     12  SM-READ                         PIC X(6).
   113     12  FILLER                          PIC X(5)
   114            VALUE ' PGM='.
   115     12  SM-PGM                          PIC X(6).
   116     12  FILLER                          PIC X(5)
   117            VALUE ' OPR='.
   118     12  SM-PROCESSOR-ID                 PIC X(4).
   119     12  FILLER                          PIC X(6)
   120            VALUE ' TERM='.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page   4
* EL156.cbl
   121     12  SM-TERMID                       PIC X(4).
   122     12  FILLER                          PIC XX   VALUE SPACE.
   123     12  SM-JUL-DATE                     PIC 9(5).
   124     12  FILLER                          PIC X    VALUE SPACE.
   125     12  SM-TIME                         PIC 99.99.
   126
   127
   128*    COPY ELCSCRTY.
   129******************************************************************
   130*                                                                *
   131*                                                                *
   132*                            ELCSCRTY                            *
   133*                            VMOD=2.001                          *
   134*                                                                *
   135*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   136*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   137*        SAVED IN PI-SECURITY-ADDRESS.                           *
   138*                                                                *
   139******************************************************************
   140 01  SECURITY-CONTROL.
   141     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   142     12  FILLER                       PIC XX    VALUE 'SC'.
   143     12  SC-CREDIT-CODES.
   144         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   145             20  SC-CREDIT-DISPLAY    PIC X.
   146             20  SC-CREDIT-UPDATE     PIC X.
   147     12  SC-CLAIMS-CODES.
   148         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   149             20  SC-CLAIMS-DISPLAY    PIC X.
   150             20  SC-CLAIMS-UPDATE     PIC X.
   151
   152 01  WS-BIN-PROOF-DT             PIC XX  VALUE LOW-VALUES.
   153 01  WS-DATE-AREA.
   154     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   155     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   156     12  SAVE-DATE-CCYYMMDD.
   157         16  SAVE-DATE-CC            PIC XX      VALUE SPACES.
   158         16  SAVE-DATE-YMD.
   159             20  SAVE-DATE-YY        PIC XX      VALUE SPACES.
   160             20  FILLER              PIC X(04)   VALUE SPACES.
   161
   162 01  WS-SAVED-EOB-CODES          PIC X(60) VALUE SPACES.
   163 01  STANDARD-AREAS.
   164     12  WS-RESPONSE         PIC S9(8)   COMP.
   165         88  WS-RESP-NORMAL              VALUE +00.
   166         88  WS-RESP-ERROR               VALUE +01.
   167         88  WS-RESP-NOTFND              VALUE +13.
   168         88  WS-RESP-DUPREC              VALUE +14.
   169         88  WS-RESP-ENDFILE             VALUE +20.
   170     12  PMT-HEAD-A.
   171         16  FILLER          PIC X(09)   VALUE 'PAY-FROM '.
   172         16  HDGA-VRBLE      PIC X(10)   VALUE 'PAY THRU  '.
   173         16  FILLER          PIC X(47)   VALUE 'DAYS   PAYMENT AMT
   174-        '     RESERVES  TYPE    AMOUNT'.
   175     12  PMT-HEAD-B.
   176         16  FILLER          PIC X(12)   VALUE 'PAYS FROM   '.
   177         16  HDGB-VRBLE      PIC X(12)   VALUE 'PAYS THRU   '.
   178         16  FILLER          PIC X(10)   VALUE 'DAYS   BY '.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page   5
* EL156.cbl
   179     12  SC-ITEM             PIC S9(4)   VALUE +0001  COMP.
   180     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   181     12  MAP-NAME            PIC X(8)    VALUE 'EL156A'.
   182     12  MAP-NAMEA           PIC X(8)    VALUE 'EL156A'.
   183     12  MAP-NAMEB           PIC X(8)    VALUE 'EL156B'.
   184     12  MAPSET-NAME         PIC X(8)    VALUE 'EL156S'.
   185     12  TRANS-ID            PIC X(4)    VALUE 'EX29'.
   186     12  THIS-PGM            PIC X(8)    VALUE 'EL156'.
   187     12  PGM-NAME            PIC X(8).
   188     12  TIME-IN             PIC S9(7).
   189     12  TIME-OUT-R  REDEFINES TIME-IN.
   190         16  FILLER          PIC X.
   191         16  TIME-OUT        PIC 99V99.
   192         16  FILLER          PIC XX.
   193     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   194     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   195     12  XCTL-126            PIC X(8)    VALUE 'EL126'.
   196     12  XCTL-141            PIC X(8)    VALUE 'EL141'.
   197     12  XCTL-157            PIC X(8)    VALUE 'EL157'.
   198     12  XCTL-155            PIC X(8)    VALUE 'EL155'.
   199     12  XCTL-130            PIC X(8)    VALUE 'EL130'.
   200     12  XCTL-132            PIC X(8)    VALUE 'EL132'.
   201     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   202     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   203     12  LINK-1523           PIC X(8)    VALUE 'EL1523'.
   204     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   205     12  LINK-REMTERM        PIC X(8)    VALUE 'ELRTRM'.
   206     12  LINK-REMAMT         PIC X(8)    VALUE 'ELRAMT'.
   207     12  ELARCH-LENGTH       PIC S9(4)   VALUE +90     COMP.
   208     12  WS-BLANK            PIC X       VALUE ' '.
   209
   210 01  MISC-WORK-AREAS.
   211     12  W-INTEREST              PIC S9(7)V99  COMP-3 VALUE +0.
   212     12  W-PAYMENT-TOTAL         PIC S9(7)V99  COMP-3 VALUE +0.
   213     12  W-PERCENT               PIC S9V9(4)   COMP-3 VALUE +0.
   214     12  W-TOTAL-INTEREST        PIC S9(7)V99  COMP-3 VALUE +0.
   215     12  W-PAID-DAYS             PIC S999      COMP-3 VALUE +0.
   216     12  W-PAID-MONTHS           PIC S999      COMP-3 VALUE +0.
   217     12  W-REM                   PIC S999      COMP-3 VALUE +0.
   218     12  W-REM-DAYS              PIC S999      COMP-3 VALUE +0.
   219     12  W-TERM-IN-DAYS          PIC S9(4)     COMP-3.
   220     12  W-REM-TERM-IN-DAYS      PIC S9(4)     COMP-3.
   221     12  W-CALLED-NAME           PIC X(08).
   222     12  W-EOB-CODES.
   223         16  W-EOB-CODE-GRP OCCURS 5 TIMES.
   224             20  W-EOB-CODE      PIC XXX.
   225             20  W-EOB-FILLER    PIC X.
   226     12  W-EOB-NDX               PIC S9        VALUE ZERO.
   227     12  W-NAME-LAST             PIC X(15).
   228     12  W-NAME-FIRST            PIC X(15).
   229     12  W-NAME-MIDDLE.
   230         16  FILLER              PIC X.
   231         16  W-NAME-MIDDLE-2     PIC X.
   232         16  FILLER              PIC X(13).
   233     12  W-DMD-CHECK-NO.
   234         16  W-DMD-CHECK-NO-1    PIC X(4).
   235         16  W-DMD-CHECK-NO-2    PIC X.
   236         16  W-DMD-CHECK-NO-3    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page   6
* EL156.cbl
   237
   238     12  WS-COMPUTE-FROM-DT  PIC XX.
   239     12  WS-PMT-MOS          PIC 999V99        VALUE ZEROS.
   240     12  WS-HER-PART-DAYS    PIC 999V99        VALUE ZEROS.
   241     12  WS-HER-MO-PMT-AMT   PIC 9(07)V99      VALUE ZEROS.
   242     12  WS-FORM-CTL-SEQ-NO  PIC S9(4)   COMP  VALUE +0.
   243     12  WS-HOLD-ELMSTR-KEY  PIC X(20) VALUE LOW-VALUES.
   244     12  WS-PRINTED-SW       PIC X VALUE SPACES.
   245         88  PAYMENT-HAS-BEEN-PRINTED  VALUE 'Y'.
   246         88  PAYMENT-NOT-PRINTED       VALUE 'N'.
   247     12  WS-RELEASED-SW      PIC X VALUE SPACES.
   248         88  PAYMENT-NOT-RELEASED      VALUE 'N'.
   249     12  WS-UPDATE-SW        PIC X VALUE ' '.
   250     12  WS-GROUPING.
   251         16  WS-GROUP-1      PIC X VALUE SPACES.
   252         16  FILLER          PIC X(05) VALUE SPACES.
   253     12  WS-BROWSE-TRLR-SW   PIC X VALUE ' '.
   254     12  WS-BROWSE-START-SW  PIC X VALUE ' '.
   255     12  WS-WORK-STATE-ACCT.
   256         16  WS-WORK-ACCT    PIC X(10)   VALUE SPACES.
   257         16  FILLER          PIC X       VALUE '/'.
   258         16  WS-WORK-STATE   PIC XX      VALUE SPACES.
   259     12  WS-CHECK-WRITTEN-DT PIC XX      VALUE LOW-VALUES.
   260     12  WS-PMT-APPROVAL-SW  PIC X       VALUE SPACES.
   261     12  WS-SPECIAL-CALC-CD  PIC X       VALUE SPACES.
   262     12  QID.
   263         16  QID-TERM        PIC X(4)    VALUE SPACES.
   264         16  FILLER          PIC X(4)    VALUE '156A'.
   265     12  MAP-LENGTH          PIC S9(4)   VALUE +1098 COMP.
   266     12  SUB-1               PIC S9(4)   VALUE +0     COMP.
   267     12  FIRST-ENTRY         PIC X       VALUE 'N'.
   268     12  FILE-SWITCH         PIC X(4)    VALUE SPACES.
   269     12  BENE-FOUND-SW       PIC X       VALUE SPACE.
   270     12  FOUND-TOL-SW        PIC X       VALUE 'N'.
   271     12  RETURNED-FROM-B     PIC X       VALUE 'N'.
   272     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   273     12  WS-STATUS           PIC X       VALUE SPACES.
   274     12  WS-TODAY-DATE       PIC XX      VALUE LOW-VALUES.
   275     12  WS-RETRO-ELIM-DATE  PIC XX      VALUE LOW-VALUES.
   276     12  WS-EXP-DT           PIC XX      VALUE LOW-VALUES.
   277     12  ws-extended-exp-dt  pic xx      value low-values.
   278     12  WS-SV-EPYFROM       PIC XX      VALUE LOW-VALUES.
   279     12  WS-SV-AIGFROM       PIC XX      VALUE LOW-VALUES.
   280     12  WS-SV-EPYTHRU       PIC XX      VALUE LOW-VALUES.
   281     12  WS-SV-PREV-PD-THRU  PIC XX      VALUE LOW-VALUES.
   282     12  WS-STATE-ABBREV     PIC XX      VALUE SPACES.
   283     12  WS-BEN-DAYS         PIC 99      VALUE ZEROS.
   284     12  WS-PMT-UNAPPROVED-CNT PIC S9(3)   VALUE +0      COMP-3.
   285     12  WS-DAYS-TOL         PIC S9(3)     VALUE +0      COMP-3.
   286     12  WS-PMT-TOL          PIC S9(3)V99  VALUE +0      COMP-3.
   287     12  WS-MAX-DAYS-TOL     PIC S9(3)     VALUE +0      COMP-3.
   288     12  WS-MAX-PMT-TOL      PIC S9(7)V99  VALUE +0      COMP-3.
   289     12  WS-MAX-LF-PMT-TOL   PIC S9(7)V99  VALUE +0      COMP-3.
   290     12  WS-AH-BEN-AMT       PIC S9(7)V999 VALUE +0      COMP-3.
   291     12  WS-LF-BEN-AMT       PIC S9(9)V99  VALUE +0      COMP-3.
   292     12  WS-BEN-AMT-LEFT     PIC S9(7)V99  VALUE +0.
   293     12  WS-REMAINING-AMT    PIC S9(9)V99  VALUE +0.
   294     12  WS-TOL-SEVERITY     PIC X         VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page   7
* EL156.cbl
   295     12  WS-LF-COVERAGE-TYPE PIC X         VALUE ' '.
   296     12  WS-EARNING-METHOD   PIC X         VALUE ' '.
   297     12  WS-CALC-METHOD      PIC X         VALUE ' '.
   298     12  WS-PAY-TYPE         PIC X         VALUE ' '.
   299     12  EXPENSE-MONTH-SAVE      PIC S9(4)     COMP-3 VALUE +0.
   300     12  WS-RESERVE-WORK         PIC S9(6)V99  COMP-3 VALUE +0.
   301     12  WS-EDIT-PATTERN         PIC Z(7).99  VALUE ZEROS.
   302     12  WS-EDIT REDEFINES WS-EDIT-PATTERN PIC X(10).
   303     12  WORK-DATE-FROM.
   304         16  WDF-MONTH       PIC 99        VALUE ZERO.
   305         16  WDF-DAY         PIC 99        VALUE ZERO.
   306         16  WDF-YEAR        PIC 99        VALUE ZERO.
   307     12  WORK-DATE-THRU.
   308         16  WDT-MONTH       PIC 99        VALUE ZERO.
   309         16  WDT-DAY         PIC 99        VALUE ZERO.
   310         16  WDT-YEAR        PIC 99        VALUE ZERO.
   311     12  FROM-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   312     12  THRU-DAYS-IN-MONTH  PIC 99        VALUE ZERO.
   313     12  FROM-PMT-DAYS       PIC 99        VALUE ZERO.
   314     12  THRU-PMT-DAYS       PIC 99        VALUE ZERO.
   315     12  SAVE-ELAPSED-MONTHS PIC 999       VALUE ZERO.
   316     12  SAVE-ELAPSED-DAYS   PIC 9(04)     VALUE ZERO.
   317     12  WS-SAVE-ODD-DAYS    PIC S9(04)    VALUE ZERO.
   318     12  SAVE-ODD-DAYS-OVER  PIC 999       VALUE ZERO.
   319     12  WS-DAILY-RATE       PIC S999V99999  VALUE +0.
   320     12  WS-PY-WORK          PIC S9(8)V99 VALUE +0.
   321     12  WS-PY-WK REDEFINES WS-PY-WORK.
   322         16  WS-PY-NUM       PIC S9(7)V99.
   323         16  WS-PY-SIGN      PIC X.
   324     12  WS-DY-WORK          PIC S9(5).
   325     12  WS-DY-WK REDEFINES WS-DY-WORK.
   326         16  WS-DY-NUM       PIC S9(4).
   327         16  WS-DY-SIGN      PIC X.
   328     12  WS-COMP-MSTR-SW     PIC X       VALUE 'N'.
   329         88  COMP-REC-FOUND              VALUE 'Y'.
   330     12  WS-BEN-SEARCH-SW    PIC X       VALUE 'N'.
   331         88  BENEFIT-FOUND       VALUE 'Y'.
   332         88  NO-BENEFIT-FOUND    VALUE 'N'.
   333     12  WS-TERMS.
   334         16  WST-ORIG        PIC ZZ9     VALUE ZEROS.
   335         16  FILLER          PIC X       VALUE '/'.
   336         16  WST-REM         PIC ZZ9     VALUE ZEROS.
   337         16  WST-REM-DAYS-GRP.
   338             20  WST-SLASH   PIC X       VALUE '/'.
   339             20  WST-REM-DAYS
   340                             PIC --9.
   341     12  WS-ACCESS.
   342         16  FILLER          PIC XX      VALUE SPACES.
   343         16  WS-BEN-CD       PIC XX      VALUE SPACES.
   344     12  WS-STATE-ACCESS.
   345         16  WS-ST-ACCESS    PIC XX      VALUE SPACES.
   346         16  FILLER          PIC XX      VALUE SPACES.
   347     12  WS-CARR-ACCESS.
   348         16  FILLER          PIC X(3)    VALUE SPACES.
   349         16  WS-CARR         PIC X       VALUE SPACES.
   350     12  DATE-WORK.
   351         16  FILLER          PIC XX      VALUE SPACES.
   352         16  NUM-WORK        PIC X(6)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page   8
* EL156.cbl
   353     12  WS-SAVE-INPUT.
   354         16  WS-PMTTYPE      PIC X       VALUE SPACE.
   355         16  WS-PAYEE        PIC XX      VALUE SPACE.
   356         16  WS-PMTNOTE1     PIC X(60)   VALUE SPACES.
   357         16  WS-PMTNOTE2     PIC X(60)   VALUE SPACES.
   358         16  WS-OFFLINE      PIC X       VALUE SPACE.
   359         16  WS-CHECKNO      PIC X(7)    VALUE SPACES.
   360         16  WS-HOLDTIL      PIC 9(6)    VALUE 0.
   361         16  WS-EPYFROM      PIC 9(6)    VALUE 0.
   362         16  WS-EPYTHRU      PIC 9(6)    VALUE 0.
   363         16  WS-EDAYS        PIC S9(5)    VALUE +0.
   364         16  WS-EPYAMT       PIC S9(7)V99 VALUE +0.
   365         16  WS-ERESV        PIC S9(7)V99 VALUE +0.
   366         16  WS-EEXPENS      PIC 9(6)V99  VALUE 0.
   367         16  WS-ETYPE        PIC X       VALUE SPACE.
   368         16  WS-CASH         PIC X       VALUE SPACE.
   369         16  WS-GROUPED      PIC X       VALUE SPACE.
   370         16  WS-INT-RATE     PIC S99V9(5) VALUE +0.
   371         16  WS-AIGFROM      PIC 9(6)    VALUE 0.
   372         16  WS-LOAN-NO      PIC X(20)   VALUE SPACES.
   373         16  WS-PROOF-DATE   PIC 9(6)    VALUE 0.
   374         16  WS-PRINT-EOB-YN PIC X       VALUE ' '.
   375         16  WS-PRINT-CLM-FRM-YN PIC X   VALUE SPACE.
   376         16  WS-PRINT-SURVEY-YN PIC X    VALUE SPACE.
   377         16  WS-SPECIAL-RELEASE-YN PIC X VALUE SPACE.
   378     12  LAST-ERROR-LINE.
   379         16  WS-FATAL-CTR        PIC ZZ9  VALUE ZEROS.
   380         16  FILLER              PIC X(30)
   381             VALUE ' FATAL ERRORS ENCOUNTERED'.
   382         16  WS-FORCE-CTR        PIC ZZ9   VALUE ZEROS.
   383         16  FILLER              PIC X(28)
   384             VALUE ' FORCIBLE ERRORS ENCOUNTERED'.
   385     12  WS-CHECK-AREA.
   386         16  WS-CHECK-CARR       PIC X   VALUE SPACES.
   387         16  WS-CHECK-NUM        PIC 9(6) VALUE ZEROS.
   388     12  WS-CHECK-NUMERIC REDEFINES WS-CHECK-AREA PIC 9(7).
   389     12  WS-CHECK-AREA-RDF REDEFINES WS-CHECK-AREA.
   390         16  FILLER              PIC XX.
   391         16  WS-A-CHECK-NUM-5    PIC 9(5).
   392     12  WS-CHECK-AREA-RDF1 REDEFINES WS-CHECK-AREA.
   393         16  FILLER              PIC X.
   394         16  WS-A-CHECK-NUM-6    PIC 9(6).
   395     12  OPTION-1-SAVE-AREA.
   396         16  SAVE1-FROM-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   397         16  SAVE1-THRU-DAYS-IN-MONTH    PIC 999  VALUE ZEROS.
   398     12  WS-WORK-ZIP.
   399         16  WS-ZIP              PIC X(5)  VALUE ZEROS.
   400         16  WS-ZIP-EXT          PIC X(4)  VALUE ZEROS.
   401     12  WS-NUMERIC-ZIP REDEFINES WS-WORK-ZIP
   402                                 PIC 9(9).
   403     12  WS-FLI-PMTNOTE.
   404         16  WS-PMTOPTION        PIC XX.
   405         16  WS-DOCNAME          PIC X(28).
   406         16  WS-AMOUNT-LINE REDEFINES WS-DOCNAME.
   407             20  WS-AMOUNT       PIC X(8).
   408             20  FILLER          PIC X(20).
   409         16  WS-NUMERIC-LINE REDEFINES WS-DOCNAME.
   410             20  WS-NUM-AMT      PIC 9(6)V99.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page   9
* EL156.cbl
   411             20  FILLER          PIC X(20).
   412
   413     12  WS-HAN-PMTNOTE.
   414         16  WS-HAN-PMT-CODE     PIC X.
   415         16  WS-HAN-PMT-NOTE     PIC X(39).
   416
   417     12  WS-NCL-PMT-OPTION       PIC XX.
   418         88  WS-VALID-NCL-OPTION           VALUE '00' THRU '19'.
   419
   420     12  WS-CLAIM-SEQUENCE.
   421         16  FILLER              PIC X VALUE '('.
   422         16  WS-CUR-SEQU         PIC Z9    VALUE ZEROS.
   423         16  FILLER              PIC X(04) VALUE ' OF '.
   424         16  WS-OF-SEQU          PIC Z9    VALUE ZEROS.
   425         16  FILLER              PIC X VALUE ')'.
   426
   427     12  WS-REFUND-AMT           PIC Z(7).99.
   428     12  WS-CALC-INT             PIC S9(7)V99.
   429     12  ws-benefits-paid     PIC S9(4)V999 VALUE +0  COMP-3.
   430
   431     12  SUB                     PIC 99 VALUE ZEROS.
   432
   433     12  WS-BOANOTE1.
   434         16  WS-BOANOTE1-DESC    PIC X(11).
   435         16  WS-BOANOTE1-EPYAMT  PIC Z,ZZZ,ZZZ.99.
   436         16  FILLER              PIC X(17).
   437     12  WS-BOANOTE2.
   438         16  WS-BOANOTE2-DESC    PIC X(11).
   439         16  WS-BOANOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   440         16  FILLER              PIC X(17).
   441
   442     12  WS-NCLNOTE1.
   443         16  WS-NCLNOTE1-DESC    PIC X(11).
   444         16  WS-NCLNOTE1-CPYAMT  PIC Z,ZZZ,ZZZ.99.
   445         16  FILLER              PIC X(17).
   446     12  WS-NCLNOTE2.
   447         16  WS-NCLNOTE2-DESC    PIC X(11).
   448         16  WS-NCLNOTE2-INT     PIC Z,ZZZ,ZZZ.99.
   449         16  FILLER              PIC X(17).
   450
   451     12  WS-MAX-LETTER-ANSWER-DT PIC XX         VALUE LOW-VALUES.
   452     12  WS-SAVE-APPROVAL-LEVEL-REQD  PIC X.
   453     12  WS-SAVE-APPROVED-LEVEL  PIC X.
   454     12  WS-MAX-EXP-PMT          PIC S9(07)V99  VALUE +0.
   455     12  WS-ACTIVITY-CODE        PIC 99         VALUE ZEROS.
   456     12  WS-LETTER-SW            PIC X          VALUE 'N'.
   457     12  WS-ACT-REC-FOUND-SW     PIC X          VALUE 'N'.
   458     12  WS-BROWSE-SW            PIC X          VALUE 'N'.
   459     12  WS-APPROVAL-LEVEL       PIC X          VALUE ' '.
   460     12  WS-OPEN-CLOSE-SW        PIC X          VALUE ' '.
   461
   462     12  WS-AIG-WORK-AREAS.
   463         16  WS-RECALC-PAYFROM-SW  PIC X VALUE 'N'.
   464             88  WS-AIG-RECALC-PAYFROM   VALUE 'Y'.
   465         16  WS-AIG-PAYFROM-SW PIC X     VALUE 'N'.
   466             88  WS-USE-AIG-PAYFROM      VALUE 'Y'.
   467         16  WS-FROM-DATE-MDY.
   468             20  WS-FROM-MO      PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  10
* EL156.cbl
   469             20  WS-FROM-DA      PIC 99.
   470             20  WS-FROM-YR      PIC 99.
   471         16  WS-TEMP-DATE-MDY.
   472             20  WS-TEMP-MO      PIC 99.
   473             20  WS-TEMP-DA      PIC 99.
   474             20  WS-TEMP-YR      PIC 99.
   475         16  WS-BIN-FROM-DT      PIC XX.
   476         16  WS-TEMP-INC-MDY.
   477             20  WS-TEMP-INC-MO  PIC 99.
   478             20  WS-TEMP-INC-DA  PIC 99.
   479             20  WS-TEMP-INC-YR  PIC 99.
   480         16  WS-PMT-DUE-MDY.
   481             20  WS-PMT-DUE-MO   PIC 99.
   482             20  WS-PMT-DUE-DA   PIC 99.
   483             20  WS-PMT-DUE-YR   PIC 99.
   484         16  WS-PMT-DUE-DT       PIC XX.
   485         16  WS-NEXT-PMT-DUE-DT  PIC XX.
   486         16  WS-RETRO-ELIM-DT    PIC XX.
   487         16  WS-DUE-DAY-SW               PIC X       VALUE 'N'.
   488             88 WS-RESTORE-DUE-DAY                   VALUE 'Y'.
   489         16  WS-SAVE-DUE-DA      PIC 99.
   490         16  WS-CDAYS            PIC S9(05).
   491         16  WS-DAYS-OFF         PIC S9(05).
   492         16  WS-ELIMINATION-SW   PIC X     VALUE 'N'.
   493             88  ELIM-SATISFIED            VALUE 'Y'.
   494         16  WS-AIG-CHECKNO.
   495             20  WS-A-CHECKNO-1-2        PIC XX      VALUE SPACES.
   496             20  WS-A-CHECKNO-3-7.
   497                 24  FILLER              PIC X(3)    VALUE SPACES.
   498                 24  WS-A-CHECKNO-6-7    PIC XX      VALUE SPACES.
   499                     88  WS-AIG-CREDIT-ENTERED       VALUE 'CR'.
   500         16  WS-AIG-GROUPING.
   501             20  WS-A-BENE               PIC XXX.
   502             20  FILLER                  PIC XXX.
   503         16  WS-PAYMENT-TRAILER-SW       PIC X       VALUE ' '.
   504             88  WS-1ST-SPECIAL-PMT                  VALUE '1'.
   505             88  WS-2ND-SPECIAL-PMT                  VALUE '2'.
   506         16  WS-AIG-UNEMPLY-DESC         PIC X(60)
   507                 VALUE 'UNEMPLOYMENT PAYMENT'.
   508         16  WS-CHK-THRU-DT              PIC XX.
   509         16  WS-HOLD-BIN-DATE-1          PIC XX.
   510
   511 01  MISC-CSO-AREA.
   512     12  ELCRTT-LENGTH       PIC S9(04)    COMP     VALUE +552.
   513     12  ELCRTT-DSID         PIC X(8)    VALUE 'ELCRTT'.
   514     12  WS-NEED-APPROVAL                PIC X(1)   VALUE 'N'.
   515         88  APPROVAL-NEEDED                        VALUE 'Y'.
   516     12  WS-APPROV-NOTE                  PIC X(43)
   517         VALUE 'REFERRED FOR CLAIM PAYMENT APPROVAL REVIEW.'.
   518     12  WS-3550-APPROV-NOTE             PIC X(43)
   519         VALUE 'APPROVL NEEDED-DOES CLAIMANT HAVE COVERAGE?'.
   520     12  WS-REAUDIT-NOTE                 PIC X(43)
   521         VALUE 'REFERRED FOR RANDOM AUDIT APPROVAL REVIEW. '.
   522     12  WS-CALC-PMT-MONTHS      PIC S9(2)V9(8)  VALUE +0.
   523     12  WS-CALC-MO-AH-AMT       PIC S9(07)V99   VALUE +0.
   524     12  WS-SUB                  PIC S9(3) COMP-3 VALUE +0.
   525     12  WS-BEG-SUB              PIC S9(3) COMP-3 VALUE +0.
   526     12  WS-END-SUB              PIC S9(3) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  11
* EL156.cbl
   527     12  WS-STATE-LENGTH         PIC S9(3) COMP-3 VALUE +0.
   528     12  WS-PAYEE-STATE-FOUND    PIC X(01)        VALUE 'N'.
   529         88 PAYEE-STATE-FOUND                     VALUE 'Y'.
   530     12  WS-PAYEE-CITY-STATE     PIC X(30).
   531     12  FILLER  REDEFINES WS-PAYEE-CITY-STATE.
   532         16  WS-PAYEE-CITY-ST OCCURS 30 TIMES PIC X(1).
   533     12  WS-PD-DAYS              PIC S9(5) VALUE +0.
   534     12  WS-SUB2                 PIC S9(3) COMP-3 VALUE +0.
   535     12  WS-WORK-NAME            PIC X(30).
   536     12  FILLER  REDEFINES WS-WORK-NAME.
   537         16  WS-WORK-NAME-X OCCURS 30 TIMES PIC X(1).
   538     12  WS-INSURED-NAME         PIC X(30).
   539     12  FILLER  REDEFINES WS-INSURED-NAME.
   540         16  WS-INSURED-NAME-X OCCURS 30 TIMES PIC X(1).
   541     12  WS-PAYEE-NAME           PIC X(30).
   542     12  FILLER  REDEFINES WS-PAYEE-NAME.
   543         16  WS-PAYEE-NAME-X OCCURS 30 TIMES PIC X(1).
   544
   545 01  ERROR-MESSAGES.
   546     12  ER-0000                 PIC X(4)  VALUE '0000'.
   547     12  ER-0004                 PIC X(4)  VALUE '0004'.
   548     12  ER-0008                 PIC X(4)  VALUE '0008'.
   549     12  ER-0019                 PIC X(4)  VALUE '0019'.
   550     12  ER-0029                 PIC X(4)  VALUE '0029'.
   551     12  ER-0042                 PIC X(4)  VALUE '0042'.
   552     12  ER-0070                 PIC X(4)  VALUE '0070'.
   553     12  ER-0130                 PIC X(4)  VALUE '0130'.
   554     12  ER-0149                 PIC X(4)  VALUE '0149'.
   555     12  ER-0154                 PIC X(4)  VALUE '0154'.
   556     12  ER-0168                 PIC X(4)  VALUE '0168'.
   557     12  ER-0169                 PIC X(4)  VALUE '0169'.
   558     12  ER-0172                 PIC X(4)  VALUE '0174'.
   559     12  ER-0198                 PIC X(4)  VALUE '0198'.
   560     12  ER-0204                 PIC X(4)  VALUE '0204'.
   561     12  ER-0206                 PIC X(4)  VALUE '0206'.
   562     12  ER-0252                 PIC X(4)  VALUE '0252'.
   563     12  ER-0254                 PIC X(4)  VALUE '0254'.
   564     12  ER-0282                 PIC X(4)  VALUE '0282'.
   565     12  ER-0283                 PIC X(4)  VALUE '0283'.
   566     12  ER-0294                 PIC X(4)  VALUE '0294'.
   567     12  ER-0338                 PIC X(4)  VALUE '0338'.
   568     12  ER-0419                 PIC X(4)  VALUE '0419'.
   569     12  ER-0420                 PIC X(4)  VALUE '0420'.
   570     12  ER-0421                 PIC X(4)  VALUE '0421'.
   571     12  ER-0422                 PIC X(4)  VALUE '0422'.
   572     12  ER-0433                 PIC X(4)  VALUE '0433'.
   573     12  ER-0436                 PIC X(4)  VALUE '0436'.
   574     12  ER-0437                 PIC X(4)  VALUE '0437'.
   575     12  ER-0438                 PIC X(4)  VALUE '0438'.
   576     12  ER-0439                 PIC X(4)  VALUE '0439'.
   577     12  ER-0440                 PIC X(4)  VALUE '0440'.
   578     12  ER-0441                 PIC X(4)  VALUE '0441'.
   579     12  ER-0442                 PIC X(4)  VALUE '0442'.
   580     12  ER-0443                 PIC X(4)  VALUE '0443'.
   581     12  ER-0444                 PIC X(4)  VALUE '0444'.
   582     12  ER-0445                 PIC X(4)  VALUE '0445'.
   583     12  ER-0446                 PIC X(4)  VALUE '0446'.
   584     12  ER-0447                 PIC X(4)  VALUE '0447'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  12
* EL156.cbl
   585     12  ER-0448                 PIC X(4)  VALUE '0448'.
   586     12  ER-0449                 PIC X(4)  VALUE '0449'.
   587     12  ER-0452                 PIC X(4)  VALUE '0452'.
   588     12  ER-0458                 PIC X(4)  VALUE '0458'.
   589     12  ER-0459                 PIC X(4)  VALUE '0459'.
   590     12  ER-0460                 PIC X(4)  VALUE '0460'.
   591     12  ER-0461                 PIC X(4)  VALUE '0461'.
   592     12  ER-0462                 PIC X(4)  VALUE '0462'.
   593     12  ER-0463                 PIC X(4)  VALUE '0463'.
   594     12  ER-0464                 PIC X(4)  VALUE '0464'.
   595     12  ER-0465                 PIC X(4)  VALUE '0465'.
   596     12  ER-0466                 PIC X(4)  VALUE '0466'.
   597     12  ER-0467                 PIC X(4)  VALUE '0467'.
   598     12  ER-0468                 PIC X(4)  VALUE '0468'.
   599     12  ER-0469                 PIC X(4)  VALUE '0469'.
   600     12  ER-0473                 PIC X(4)  VALUE '0473'.
   601     12  ER-0474                 PIC X(4)  VALUE '0474'.
   602     12  ER-0475                 PIC X(4)  VALUE '0475'.
   603     12  ER-0476                 PIC X(4)  VALUE '0476'.
   604     12  ER-0477                 PIC X(4)  VALUE '0477'.
   605     12  ER-0478                 PIC X(4)  VALUE '0478'.
   606     12  ER-0479                 PIC X(4)  VALUE '0479'.
   607     12  ER-0481                 PIC X(4)  VALUE '0481'.
   608     12  ER-0491                 PIC X(4)  VALUE '0491'.
   609     12  ER-0492                 PIC X(4)  VALUE '0492'.
   610     12  ER-0493                 PIC X(4)  VALUE '0493'.
   611     12  ER-0494                 PIC X(4)  VALUE '0494'.
   612     12  ER-0495                 PIC X(4)  VALUE '0495'.
   613     12  ER-0499                 PIC X(4)  VALUE '0499'.
   614     12  ER-0500                 PIC X(4)  VALUE '0500'.
   615     12  ER-0501                 PIC X(4)  VALUE '0501'.
   616     12  ER-0502                 PIC X(4)  VALUE '0502'.
   617     12  ER-0508                 PIC X(4)  VALUE '0508'.
   618     12  ER-0513                 PIC X(4)  VALUE '0513'.
   619     12  ER-0518                 PIC X(4)  VALUE '0518'.
   620     12  ER-0524                 PIC X(4)  VALUE '0524'.
   621     12  ER-0525                 PIC X(4)  VALUE '0525'.
   622     12  ER-0526                 PIC X(4)  VALUE '0526'.
   623     12  ER-0530                 PIC X(4)  VALUE '0530'.
   624     12  ER-0540                 PIC X(4)  VALUE '0540'.
   625     12  ER-0541                 PIC X(4)  VALUE '0541'.
   626     12  ER-0542                 PIC X(4)  VALUE '0542'.
   627     12  ER-0543                 PIC X(4)  VALUE '0543'.
   628     12  ER-0545                 PIC X(4)  VALUE '0545'.
   629     12  ER-0552                 PIC X(4)  VALUE '0552'.
   630     12  ER-0555                 PIC X(4)  VALUE '0555'.
   631     12  ER-0556                 PIC X(4)  VALUE '0556'.
   632     12  ER-0557                 PIC X(4)  VALUE '0557'.
   633     12  ER-0572                 PIC X(4)  VALUE '0572'.
   634     12  ER-0573                 PIC X(4)  VALUE '0573'.
   635     12  ER-0594                 PIC X(4)  VALUE '0594'.
   636     12  ER-0616                 PIC X(4)  VALUE '0616'.
   637     12  ER-0617                 PIC X(4)  VALUE '0617'.
   638     12  ER-0618                 PIC X(4)  VALUE '0618'.
   639     12  ER-0657                 PIC X(4)  VALUE '0657'.
   640     12  ER-0658                 PIC X(4)  VALUE '0658'.
   641     12  ER-0699                 PIC X(4)  VALUE '0699'.
   642     12  ER-0730                 PIC X(4)  VALUE '0730'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  13
* EL156.cbl
   643     12  ER-0737                 PIC X(4)  VALUE '0737'.
   644     12  ER-0760                 PIC X(4)  VALUE '0760'.
   645     12  ER-0768                 PIC X(4)  VALUE '0768'.
   646     12  ER-0769                 PIC X(4)  VALUE '0769'.
   647     12  ER-0770                 PIC X(4)  VALUE '0770'.
   648     12  ER-0802                 PIC X(4)  VALUE '0802'.
   649     12  ER-0803                 PIC X(4)  VALUE '0803'.
   650     12  ER-0819                 PIC X(4)  VALUE '0819'.
   651     12  ER-0834                 PIC X(4)  VALUE '0834'.
   652     12  ER-0836                 PIC X(4)  VALUE '0836'.
   653     12  ER-0844                 PIC X(4)  VALUE '0844'.
   654     12  ER-0845                 PIC X(4)  VALUE '0845'.
   655     12  ER-0846                 PIC X(4)  VALUE '0846'.
   656     12  ER-0849                 PIC X(4)  VALUE '0849'.
   657     12  ER-0851                 PIC X(4)  VALUE '0851'.
   658     12  ER-0872                 PIC X(4)  VALUE '0872'.
   659     12  ER-0873                 PIC X(4)  VALUE '0873'.
   660     12  ER-0874                 PIC X(4)  VALUE '0874'.
   661     12  ER-0879                 PIC X(4)  VALUE '0879'.
   662     12  ER-0919                 PIC X(4)  VALUE '0919'.
   663     12  ER-0921                 PIC X(4)  VALUE '0921'.
   664     12  ER-0923                 PIC X(4)  VALUE '0923'.
   665     12  ER-0925                 PIC X(4)  VALUE '0925'.
   666     12  ER-0944                 PIC X(4)  VALUE '0944'.
   667     12  ER-0945                 PIC X(4)  VALUE '0945'.
   668     12  ER-0946                 PIC X(4)  VALUE '0946'.
   669     12  ER-0947                 PIC X(4)  VALUE '0947'.
   670     12  ER-0948                 PIC X(4)  VALUE '0948'.
   671     12  ER-0949                 PIC X(4)  VALUE '0949'.
   672     12  ER-0950                 PIC X(4)  VALUE '0950'.
   673     12  ER-0951                 PIC X(4)  VALUE '0951'.
   674     12  ER-0954                 PIC X(4)  VALUE '0954'.
   675     12  ER-0956                 PIC X(4)  VALUE '0956'.
   676     12  ER-0967                 PIC X(4)  VALUE '0967'.
   677     12  ER-0968                 PIC X(4)  VALUE '0968'.
   678     12  ER-0974                 PIC X(4)  VALUE '0974'.
   679     12  ER-0975                 PIC X(4)  VALUE '0975'.
   680     12  ER-1561                 PIC X(4)  VALUE '1561'.
   681     12  ER-1566                 PIC X(4)  VALUE '1566'.
   682     12  ER-1567                 PIC X(4)  VALUE '1567'.
   683     12  ER-1569                 PIC X(4)  VALUE '1569'.
   684     12  er-1657                 pic x(4)  value '1657'.
   685     12  er-1658                 pic x(4)  value '1658'.
   686     12  er-1667                 pic x(4)  value '1667'.
   687     12  er-1670                 pic x(4)  value '1670'.
   688     12  er-1671                 pic x(4)  value '1671'.
   689     12  er-1672                 pic x(4)  value '1672'.
   690     12  er-1673                 pic x(4)  value '1673'.
   691     12  er-1674                 pic x(4)  value '1674'.
   692     12  er-1677                 pic x(4)  value '1677'.
   693     12  ER-1775                 PIC X(4)  VALUE '1775'.
   694     12  ER-1880                 PIC X(4)  VALUE '1880'.
   695     12  ER-2044                 PIC X(4)  VALUE '2044'.
   696     12  ER-3140                 PIC X(4)  VALUE '3140'.
   697     12  ER-3141                 PIC X(4)  VALUE '3141'.
   698     12  ER-3255                 PIC X(4)  VALUE '3255'.
   699     12  ER-3516                 PIC X(4)  VALUE '3516'.
   700     12  ER-3527                 PIC X(4)  VALUE '3527'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  14
* EL156.cbl
   701     12  ER-3528                 PIC X(4)  VALUE '3528'.
   702     12  ER-3529                 PIC X(4)  VALUE '3529'.
   703     12  ER-3530                 PIC X(4)  VALUE '3530'.
   704     12  ER-3531                 PIC X(4)  VALUE '3531'.
   705     12  ER-3532                 PIC X(4)  VALUE '3532'.
   706     12  ER-3533                 PIC X(4)  VALUE '3533'.
   707     12  ER-3534                 PIC X(4)  VALUE '3534'.
   708     12  ER-3535                 PIC X(4)  VALUE '3535'.
   709     12  ER-3536                 PIC X(4)  VALUE '3536'.
   710     12  ER-3537                 PIC X(4)  VALUE '3537'.
   711     12  ER-3538                 PIC X(4)  VALUE '3538'.
   712     12  ER-3539                 PIC X(4)  VALUE '3539'.
   713     12  ER-3540                 PIC X(4)  VALUE '3540'.
   714     12  ER-3541                 PIC X(4)  VALUE '3541'.
   715     12  ER-3542                 PIC X(4)  VALUE '3542'.
   716     12  ER-3543                 PIC X(4)  VALUE '3543'.
   717     12  ER-3546                 PIC X(4)  VALUE '3546'.
   718     12  ER-3549                 PIC X(4)  VALUE '3549'.
   719     12  ER-3818                 PIC X(4)  VALUE '3818'.
   720     12  ER-7540                 PIC X(4)  VALUE '7540'.
   721     12  ER-7576                 PIC X(4)  VALUE '7576'.
   722     12  ER-7579                 PIC X(4)  VALUE '7579'.
   723     12  ER-7580                 PIC X(4)  VALUE '7580'.
   724     12  ER-7583                 PIC X(4)  VALUE '7583'.
   725     12  ER-7830                 PIC X(4)  VALUE '7830'.
   726     12  ER-7831                 PIC X(4)  VALUE '7831'.
   727     12  ER-7832                 PIC X(4)  VALUE '7832'.
   728     12  ER-7833                 PIC X(4)  VALUE '7833'.
   729     12  ER-7834                 PIC X(4)  VALUE '7834'.
   730     12  ER-7835                 PIC X(4)  VALUE '7835'.
   731     12  ER-7836                 PIC X(4)  VALUE '7836'.
   732     12  ER-7837                 PIC X(4)  VALUE '7837'.
   733     12  ER-7838                 PIC X(4)  VALUE '7838'.
   734     12  ER-7841                 PIC X(4)  VALUE '7841'.
   735     12  ER-7844                 PIC X(4)  VALUE '7844'.
   736     12  ER-7845                 PIC X(4)  VALUE '7845'.
   737     12  ER-8000                 PIC X(4)  VALUE '8000'.
   738     12  ER-8051                 PIC X(4)  VALUE '8051'.
   739     12  ER-8052                 PIC X(4)  VALUE '8052'.
   740     12  ER-8053                 PIC X(4)  VALUE '8053'.
   741     12  ER-8054                 PIC X(4)  VALUE '8054'.
   742     12  ER-8055                 PIC X(4)  VALUE '8055'.
   743     12  ER-8056                 PIC X(4)  VALUE '8056'.
   744     12  ER-8057                 PIC X(4)  VALUE '8057'.
   745     12  ER-8058                 PIC X(4)  VALUE '8058'.
   746     12  ER-8059                 PIC X(4)  VALUE '8059'.
   747     12  ER-8060                 PIC X(4)  VALUE '8060'.
   748     12  ER-8061                 PIC X(4)  VALUE '8061'.
   749     12  ER-8062                 PIC X(4)  VALUE '8062'.
   750     12  ER-8063                 PIC X(4)  VALUE '8063'.
   751     12  ER-8064                 PIC X(4)  VALUE '8064'.
   752     12  ER-8065                 PIC X(4)  VALUE '8065'.
   753     12  ER-8066                 PIC X(4)  VALUE '8066'.
   754     12  ER-8146                 PIC X(4)  VALUE '8146'.
   755     12  ER-8147                 PIC X(4)  VALUE '8147'.
   756     12  ER-8152                 PIC X(4)  VALUE '8152'.
   757     12  ER-8153                 PIC X(4)  VALUE '8153'.
   758     12  ER-8154                 PIC X(4)  VALUE '8154'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  15
* EL156.cbl
   759     12  ER-8155                 PIC X(4)  VALUE '8155'.
   760     12  ER-8310                 PIC X(4)  VALUE '8310'.
   761     12  ER-8311                 PIC X(4)  VALUE '8311'.
   762     12  ER-8312                 PIC X(4)  VALUE '8312'.
   763     12  ER-8313                 PIC X(4)  VALUE '8313'.
   764     12  ER-8314                 PIC X(4)  VALUE '8314'.
   765     12  ER-8315                 PIC X(4)  VALUE '8315'.
   766     12  ER-8316                 PIC X(4)  VALUE '8316'.
   767     12  ER-8317                 PIC X(4)  VALUE '8317'.
   768
   769 01  CSO-WORK-FIELDS.
   770     05  ERROR-ON-OUTPUT-SW  PIC X     VALUE 'N'.
   771       88  ERROR-ON-OUTPUT             VALUE 'Y'.
   772
   773     05  WRK-6MO                 PIC S9(7)V99 VALUE +0.
   774     05  WRK-CERT-NOTE-ADD       PIC X VALUE SPACES.
   775         88  CERT-NOTE-ADDED           VALUE 'Y'.
   776     05  WRK-ORIG-NOTE-ADD       PIC X VALUE SPACES.
   777         88  ORIG-NOTE-ADDED           VALUE 'Y'.
   778     05  WRK-NOTE-SEQ            PIC S9(4) COMP  VALUE +0.
   779
   780     05  WRK-NEXT-AUDIT-CHK-NO   PIC S9(8) COMP  VALUE +0.
   781
   782 01  SC-NP6-CERT-NOTE.
   783     12  FILLER                  PIC X(12)
   784               VALUE 'REM BENEFIT '.
   785     12  SC-NP6-REM-BEN          PIC ZZZ,ZZZ.99.
   786     12  SC-NP6-COMM             PIC X(8)
   787               VALUE ' + 6 MO '.
   788     12  SC-NP6-6-MO             PIC ZZZ,ZZZ.99.
   789     12  FILLER                  PIC X(12)
   790               VALUE ' = AMT PAID '.
   791     12  SC-NP6-AMT-PAID         PIC ZZZ,ZZZ.99.
   792
   793 01  SC-NP6-ORIG-NOTE.
   794     12  FILLER                  PIC X(63)  VALUE
   795         'BENEFITS PAID CANNOT EXCEED ORIGINAL LIFE BENEFIT'.
   796 01  WS-PDEF-RECORD-SW           PIC X  VALUE ' '.
   797     88  PDEF-FOUND                   VALUE 'Y'.
   798 01  WS-ACCT-RECORD-SW           PIC X  VALUE ' '.
   799     88  ACCT-FOUND                   VALUE 'Y'.
   800 01  CTBL-KEY-SAVE               PIC X(5).
   801 01  CTBL-KEY.
   802     05  CTBL-COMPANY-CD         PIC X.
   803     05  CTBL-TABLE              PIC XXX.
   804     05  CTBL-BEN-TYPE           PIC X.
   805     05  CTBL-BEN-CODE           PIC XX.
   806 01  ERPDEF-KEY-SAVE             PIC X(18).
   807 01  ERPDEF-KEY.
   808     12  ERPDEF-COMPANY-CD       PIC X.
   809     12  ERPDEF-STATE            PIC XX.
   810     12  ERPDEF-PROD-CD          PIC XXX.
   811     12  F                       PIC X(7).
   812     12  ERPDEF-BEN-TYPE         PIC X.
   813     12  ERPDEF-BEN-CODE         PIC XX.
   814     12  ERPDEF-EXP-DT           PIC XX.
   815 01  ELCRTT-KEY.
   816     05  CTRLR-COMP-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  16
* EL156.cbl
   817     05  CTRLR-CARRIER       PIC X.
   818     05  CTRLR-GROUPING      PIC X(6).
   819     05  CTRLR-STATE         PIC X(2).
   820     05  CTRLR-ACCOUNT       PIC X(10).
   821     05  CTRLR-EFF-DT        PIC XX.
   822     05  CTRLR-CERT-NO       PIC X(11).
   823     05  CTRLR-REC-TYPE      PIC X.
   824 01  ACCESS-KEYS.
   825     12  ELARCH-KEY.
   826         16  ARCH-CO             PIC X.
   827         16  ARCH-NUMBER         PIC S9(08) COMP.
   828         16  ARCH-REC-TYPE       PIC X.
   829         16  ARCH-SEQ            PIC S9(04) COMP.
   830     12  ELMSTR-KEY.
   831         16  MSTR-COMP-CD        PIC X.
   832         16  MSTR-CARRIER        PIC X.
   833         16  MSTR-CLAIM-NO       PIC X(7).
   834         16  MSTR-CERT-NO        PIC X(11).
   835     12  ELCNTL-KEY.
   836         16  CNTL-COMP-ID        PIC X(3).
   837         16  CNTL-REC-TYPE       PIC X.
   838         16  CNTL-ACCESS         PIC X(4).
   839         16  CNTL-SEQ-NO         PIC S9(4)    COMP.
   840     12  ELCERT-KEY.
   841         16  CERT-COMP-CD        PIC X.
   842         16  CERT-CARRIER        PIC X.
   843         16  CERT-GROUPING       PIC X(6).
   844         16  CERT-STATE          PIC XX.
   845         16  CERT-ACCOUNT        PIC X(10).
   846         16  CERT-EFF-DT         PIC XX.
   847         16  CERT-CERT-NO        PIC X(11).
   848     12  ELTRLR-KEY.
   849         16  TRLR-COMP-CD        PIC X.
   850         16  TRLR-CARRIER        PIC X.
   851         16  TRLR-CLAIM-NO       PIC X(7).
   852         16  TRLR-CERT-NO        PIC X(11).
   853         16  TRLR-SEQ-NO         PIC S9(4)   COMP.
   854     12  ELACTQ-KEY.
   855         16  ACTQ-COMP-CD        PIC X.
   856         16  ACTQ-CARRIER        PIC X.
   857         16  ACTQ-CLAIM-NO       PIC X(7).
   858         16  ACTQ-CERT-NO        PIC X(11).
   859     12  W-NOTE-KEY.
   860         16  W-NOTE-COMP-CD      PIC X.
   861         16  W-NOTE-CERT-KEY.
   862             20  W-NOTE-CARRIER  PIC X.
   863             20  W-NOTE-GROUPING PIC X(6).
   864             20  W-NOTE-STATE    PIC XX.
   865             20  W-NOTE-ACCOUNT  PIC X(10).
   866             20  W-NOTE-EFF-DT   PIC XX.
   867             20  W-NOTE-CERT-NO  PIC X(11).
   868     12  WS-ERACCT-SAVE-KEY      PIC X(20).
   869     12  WS-ERACCT-HOLD-RECORD   PIC X(2000).
   870     12  ERACCT-KEY.
   871         16  ERACCT-PARTIAL-KEY.
   872             20  ACCT-COMP-CD    PIC X.
   873             20  ACCT-CARRIER    PIC X.
   874             20  ACCT-GROUPING   PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  17
* EL156.cbl
   875             20  ACCT-STATE      PIC XX.
   876             20  ACCT-ACCOUNT    PIC X(10).
   877         16  ACCT-EXP-DT         PIC XX.
   878         16  FILLER              PIC X(4) VALUE SPACES.
   879     12  ELCHKQ-KEY.
   880         16  CHKQ-COMP-CD        PIC X.
   881         16  CHKQ-CONTROL        PIC S9(8) COMP.
   882         16  CHKQ-SEQ-NO         PIC S9(4) COMP.
   883     12  ELBENE-KEY.
   884         16  BENE-COMP-CD         PIC X.
   885         16  BENE-RECORD-TYPE     PIC X.
   886         16  BENE-NUMBER          PIC X(10).
   887     12  ERCOMP-KEY.
   888         16  COMP-COMP-CD        PIC X.
   889         16  COMP-CARRIER        PIC X.
   890         16  COMP-GROUP          PIC X(06).
   891         16  COMP-FIN-RESP       PIC X(10).
   892         16  COMP-ACCOUNT        PIC X(10).
   893         16  COMP-TYPE           PIC X.
   894
   895     12  DLO035-KEY.
   896         16  DL35-PROCESS-TYPE   PIC X.
   897         16  DL35-CREDIT-CARD    PIC X(20).
   898         16  DL35-BEN-TYPE       PIC XX.
   899         16  DL35-PAYMENT-AMT    PIC 9(7)V99.
   900         16  DL35-RETURN-CODE    PIC XX.
   901
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  18
* EL156.cbl
   903*    COPY ELCDATE.
   904******************************************************************
   905*                                                                *
   906*                                                                *
   907*                            ELCDATE.                            *
   908*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   909*                            VMOD=2.003
   910*                                                                *
   911*                                                                *
   912*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   913*                 LENGTH = 200                                   *
   914******************************************************************
   915
   916 01  DATE-CONVERSION-DATA.
   917     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   918     12  DC-OPTION-CODE                PIC X.
   919         88  BIN-TO-GREG                VALUE ' '.
   920         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   921         88  EDIT-GREG-TO-BIN           VALUE '2'.
   922         88  YMD-GREG-TO-BIN            VALUE '3'.
   923         88  MDY-GREG-TO-BIN            VALUE '4'.
   924         88  JULIAN-TO-BIN              VALUE '5'.
   925         88  BIN-PLUS-ELAPSED           VALUE '6'.
   926         88  FIND-CENTURY               VALUE '7'.
   927         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   928         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   929         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   930         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   931         88  JULIAN-TO-BIN-3            VALUE 'C'.
   932         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   933         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   934         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   935         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   936         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   937         88  CHECK-LEAP-YEAR            VALUE 'H'.
   938         88  BIN-3-TO-GREG              VALUE 'I'.
   939         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   940         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   941         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   942         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   943         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   944         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   945         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   946         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   947         88  THREE-CHARACTER-BIN
   948                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   949         88  GREGORIAN-TO-BIN
   950                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   951         88  BIN-TO-GREGORIAN
   952                  VALUES ' ' '1' 'I' '8' 'G'.
   953         88  JULIAN-TO-BINARY
   954                  VALUES '5' 'C' 'E' 'F'.
   955     12  DC-ERROR-CODE                 PIC X.
   956         88  NO-CONVERSION-ERROR        VALUE ' '.
   957         88  DATE-CONVERSION-ERROR
   958                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   959         88  DATE-IS-ZERO               VALUE '1'.
   960         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  19
* EL156.cbl
   961         88  DATE-IS-INVALID            VALUE '3'.
   962         88  DATE1-GREATER-DATE2        VALUE '4'.
   963         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   964         88  DATE-INVALID-OPTION        VALUE '9'.
   965         88  INVALID-CENTURY            VALUE 'A'.
   966         88  ONLY-CENTURY               VALUE 'B'.
   967         88  ONLY-LEAP-YEAR             VALUE 'C'.
   968         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   969     12  DC-END-OF-MONTH               PIC X.
   970         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   971     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   972         88  USE-NORMAL-PROCESS         VALUE ' '.
   973         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   974         88  ADJUST-UP-100-YRS          VALUE '2'.
   975     12  FILLER                        PIC X.
   976     12  DC-CONVERSION-DATES.
   977         16  DC-BIN-DATE-1             PIC XX.
   978         16  DC-BIN-DATE-2             PIC XX.
   979         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   980         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   981                       DC-GREG-DATE-1-EDIT.
   982             20  DC-EDIT1-MONTH        PIC 99.
   983             20  SLASH1-1              PIC X.
   984             20  DC-EDIT1-DAY          PIC 99.
   985             20  SLASH1-2              PIC X.
   986             20  DC-EDIT1-YEAR         PIC 99.
   987         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   988         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   989                     DC-GREG-DATE-2-EDIT.
   990             20  DC-EDIT2-MONTH        PIC 99.
   991             20  SLASH2-1              PIC X.
   992             20  DC-EDIT2-DAY          PIC 99.
   993             20  SLASH2-2              PIC X.
   994             20  DC-EDIT2-YEAR         PIC 99.
   995         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   996         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   997                     DC-GREG-DATE-1-YMD.
   998             20  DC-YMD-YEAR           PIC 99.
   999             20  DC-YMD-MONTH          PIC 99.
  1000             20  DC-YMD-DAY            PIC 99.
  1001         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1002         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1003                      DC-GREG-DATE-1-MDY.
  1004             20  DC-MDY-MONTH          PIC 99.
  1005             20  DC-MDY-DAY            PIC 99.
  1006             20  DC-MDY-YEAR           PIC 99.
  1007         16  DC-GREG-DATE-1-ALPHA.
  1008             20  DC-ALPHA-MONTH        PIC X(10).
  1009             20  DC-ALPHA-DAY          PIC 99.
  1010             20  FILLER                PIC XX.
  1011             20  DC-ALPHA-CENTURY.
  1012                 24 DC-ALPHA-CEN-N     PIC 99.
  1013             20  DC-ALPHA-YEAR         PIC 99.
  1014         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1015         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1016         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1017         16  DC-JULIAN-DATE            PIC 9(05).
  1018         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  20
* EL156.cbl
  1019                                       PIC 9(05).
  1020         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1021             20  DC-JULIAN-YEAR        PIC 99.
  1022             20  DC-JULIAN-DAYS        PIC 999.
  1023         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1024         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1025         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1026     12  DATE-CONVERSION-VARIBLES.
  1027         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1028         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1029             20  FILLER                PIC 9(3).
  1030             20  HOLD-CEN-1-CCYY.
  1031                 24  HOLD-CEN-1-CC     PIC 99.
  1032                 24  HOLD-CEN-1-YY     PIC 99.
  1033             20  HOLD-CEN-1-MO         PIC 99.
  1034             20  HOLD-CEN-1-DA         PIC 99.
  1035         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1036             20  HOLD-CEN-1-R-MO       PIC 99.
  1037             20  HOLD-CEN-1-R-DA       PIC 99.
  1038             20  HOLD-CEN-1-R-CCYY.
  1039                 24  HOLD-CEN-1-R-CC   PIC 99.
  1040                 24  HOLD-CEN-1-R-YY   PIC 99.
  1041             20  FILLER                PIC 9(3).
  1042         16  HOLD-CENTURY-1-X.
  1043             20  FILLER                PIC X(3)  VALUE SPACES.
  1044             20  HOLD-CEN-1-X-CCYY.
  1045                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1046                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1047             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1048             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1049         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1050             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1051             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1052             20  HOLD-CEN-1-R-X-CCYY.
  1053                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1054                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1055             20  FILLER                PIC XXX.
  1056         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1057         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1058         16  DC-JULIAN-DATE-1          PIC 9(07).
  1059         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1060             20  DC-JULIAN-1-CCYY.
  1061                 24  DC-JULIAN-1-CC    PIC 99.
  1062                 24  DC-JULIAN-1-YR    PIC 99.
  1063             20  DC-JULIAN-DA-1        PIC 999.
  1064         16  DC-JULIAN-DATE-2          PIC 9(07).
  1065         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1066             20  DC-JULIAN-2-CCYY.
  1067                 24  DC-JULIAN-2-CC    PIC 99.
  1068                 24  DC-JULIAN-2-YR    PIC 99.
  1069             20  DC-JULIAN-DA-2        PIC 999.
  1070         16  DC-GREG-DATE-A-EDIT.
  1071             20  DC-EDITA-MONTH        PIC 99.
  1072             20  SLASHA-1              PIC X VALUE '/'.
  1073             20  DC-EDITA-DAY          PIC 99.
  1074             20  SLASHA-2              PIC X VALUE '/'.
  1075             20  DC-EDITA-CCYY.
  1076                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  21
* EL156.cbl
  1077                 24  DC-EDITA-YEAR     PIC 99.
  1078         16  DC-GREG-DATE-B-EDIT.
  1079             20  DC-EDITB-MONTH        PIC 99.
  1080             20  SLASHB-1              PIC X VALUE '/'.
  1081             20  DC-EDITB-DAY          PIC 99.
  1082             20  SLASHB-2              PIC X VALUE '/'.
  1083             20  DC-EDITB-CCYY.
  1084                 24  DC-EDITB-CENT     PIC 99.
  1085                 24  DC-EDITB-YEAR     PIC 99.
  1086         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1087         16  DC-GREG-DATE-CYMD-R REDEFINES
  1088                              DC-GREG-DATE-CYMD.
  1089             20  DC-CYMD-CEN           PIC 99.
  1090             20  DC-CYMD-YEAR          PIC 99.
  1091             20  DC-CYMD-MONTH         PIC 99.
  1092             20  DC-CYMD-DAY           PIC 99.
  1093         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1094         16  DC-GREG-DATE-MDCY-R REDEFINES
  1095                              DC-GREG-DATE-MDCY.
  1096             20  DC-MDCY-MONTH         PIC 99.
  1097             20  DC-MDCY-DAY           PIC 99.
  1098             20  DC-MDCY-CEN           PIC 99.
  1099             20  DC-MDCY-YEAR          PIC 99.
  1100    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1101        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1102    12  DC-EL310-DATE                  PIC X(21).
  1103    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  22
* EL156.cbl
  1105*    COPY ELCLOGOF.
  1106******************************************************************
  1107*                                                                *
  1108*                                                                *
  1109*                            ELCLOGOF.                           *
  1110*                            VMOD=2.001                          *
  1111*                                                                *
  1112*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1113*                                                                *
  1114******************************************************************
  1115 01  CLASIC-LOGOFF.
  1116     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1117     12  LOGOFF-TEXT.
  1118         16  FILLER          PIC X(5)    VALUE SPACES.
  1119         16  LOGOFF-MSG.
  1120             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1121             20  FILLER      PIC X       VALUE SPACES.
  1122             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1123         16  FILLER          PIC X(80)
  1124           VALUE '* YOU ARE NOW LOGGED OFF'.
  1125         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1126         16  FILLER          PIC X       VALUE QUOTE.
  1127         16  LOGOFF-SYS-MSG  PIC X(17)
  1128           VALUE 'S CLAS-IC SYSTEM '.
  1129     12  TEXT-MESSAGES.
  1130         16  UNACCESS-MSG    PIC X(29)
  1131             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1132         16  PGMIDERR-MSG    PIC X(17)
  1133             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  23
* EL156.cbl
  1135*    COPY ELCCALC.
  1136******************************************************************
  1137*                                                                *
  1138*                           ELCCALC.                            *
  1139*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1140*                            VMOD=2.025                          *
  1141*                                                                *
  1142*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  1143*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  1144*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  1145*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  1146*                                                                *
  1147*  PASSED TO ELRTRM                                              *
  1148*  -----------------                                             *
  1149*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  1150*  ORIGINAL TERM                                                 *
  1151*  BEGINNING DATE                                                *
  1152*  ENDING DATE                                                   *
  1153*  COMPANY I.D.                                                  *
  1154*  ACCOUNT MASTER USER FIELD                                     *
  1155*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  1156*  FREE LOOK DAYS                                                *
  1157*                                                                *
  1158*  RETURNED FROM ELRTRM                                          *
  1159*  ---------------------                                         *
  1160*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  1161*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  1162*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  1163*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  1164*----------------------------------------------------------------*
  1165*  PASSED TO ELRAMT                                              *
  1166*  ----------------                                              *
  1167*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  1168*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1169*  ORIGINAL AMOUNT                                               *
  1170*  ALTERNATE BENEFIT (BALLON)                                    *
  1171*  A.P.R. - NET PAY ONLY                                         *
  1172*  METHOD
  1173*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  1174*  COMPANY I.D.                                                  *
  1175*  BENEFIT TYPE                                                  *
  1176*                                                                *
  1177*  RETURNED FROM ELRAMT                                          *
  1178*  --------------------                                          *
  1179*  REMAINING AMOUNT 1 - CURRENT                                  *
  1180*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  1181*  REMAINING AMOUNT FACTOR
  1182*----------------------------------------------------------------*
  1183*  PASSED TO ELRESV                                              *
  1184*  -----------------                                             *
  1185*  CERTIFICATE EFFECTIVE DATE                                    *
  1186*  VALUATION DATE                                                *
  1187*  PAID THRU DATE                                                *
  1188*  BENEFIT                                                       *
  1189*  INCURRED DATE                                                 *
  1190*  REPORTED DATE                                                 *
  1191*  ISSUE AGE                                                     *
  1192*  TERM                                                          *
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  24
* EL156.cbl
  1193*  CDT PERCENT                                                   *
  1194*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  1195* *CLAIM TYPE (LIFE, A/H)                                        *
  1196* *REMAINING BENEFIT (FROM ELRAMT)                               *
  1197* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  1198*                                                                *
  1199*  RETURNED FROM ELRESV                                          *
  1200*  --------------------                                          *
  1201*  CDT TABLE USED                                                *
  1202*  CDT FACTOR USED                                               *
  1203*  PAY TO CURRENT RESERVE                                        *
  1204*  I.B.N.R. - A/H ONLY                                           *
  1205*  FUTURE (ACCRUED) AH ONLY                                      *
  1206*----------------------------------------------------------------*
  1207*  PASSED TO ELRATE                                              *
  1208*  ----------------                                              *
  1209*  CERT ISSUE DATE                                               *
  1210*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1211*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1212*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  1213*  STATE CODE (CLIENT DEFINED)                                   *
  1214*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1215*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1216*  DEVIATION CODE                                                *
  1217*  ISSUE AGE                                                     *
  1218*  ORIGINAL BENEFIT AMOUNT                                       *
  1219*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1220*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  1221*  BENEFIT KIND (LIFE OR A/H)                                    *
  1222*  A.P.R.                                                        *
  1223*  METHOD
  1224*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1225*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1226*  COMPANY I.D. (3 CHARACTER)                                    *
  1227*  BENEFIT CODE                                                  *
  1228*  BENEFIT OVERRIDE CODE                                         *
  1229*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  1230*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  1231*  JOINT INDICATOR (CSL ONLY)                                    *
  1232*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  1233*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  1234*                                                                *
  1235*  RETURNED FROM ELRATE                                          *
  1236*  --------------------                                          *
  1237*  CALCULATED PREMIUM                                            *
  1238*  PREMIUM RATE                                                  *
  1239*  MORTALITY CODE                                                *
  1240*  MAX ATTAINED AGE                                              *
  1241*  MAX AGE                                                       *
  1242*  MAX TERM                                                      *
  1243*  MAX MONTHLY BENEFIT                                           *
  1244*  MAX TOTAL BENIFIT                                             *
  1245*  COMPOSITE RATE (OPEN-END ONLY)                                *
  1246*----------------------------------------------------------------*
  1247*  PASSED TO ELRFND                                              *
  1248*  ----------------                                              *
  1249*  CERT ISSUE DATE                                               *
  1250*  REFUND DATE                                                   *
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  25
* EL156.cbl
  1251*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1252*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1253*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  1254*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1255*  STATE CODE (CLIENT DEFINED)                                   *
  1256*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1257*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1258*  DEVIATION CODE                                                *
  1259*  ISSUE AGE                                                     *
  1260*  ORIGINAL BENEFIT AMOUNT                                       *
  1261*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  1262*  PROCESS TYPE (CANCEL)                                         *
  1263*  BENEFIT KIND (LIFE OR A/H)                                    *
  1264*  A.P.R.                                                        *
  1265*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  1266*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  1267*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1268*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1269*  COMPANY I.D. (3 CHARACTER)                                    *
  1270*  BENEFIT CODE                                                  *
  1271*  BENEFIT OVERRIDE CODE                                         *
  1272*                                                                *
  1273*  RETURNED FROM ELRFND                                          *
  1274*  --------------------                                          *
  1275*  CALCULATED REFUND                                             *
  1276*----------------------------------------------------------------*
  1277*  PASSED TO ELEARN                                              *
  1278*  ----------------                                              *
  1279*  CERT ISSUE DATE                                               *
  1280*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  1281*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  1282*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  1283*  STATE CODE (CLIENT DEFINED)                                   *
  1284*  STATE CODE (STANDARD P.O. ABBRV)                              *
  1285*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  1286*  DEVIATION CODE                                                *
  1287*  ISSUE AGE                                                     *
  1288*  ORIGINAL BENEFIT AMOUNT                                       *
  1289*  BENEFIT KIND (LIFE OR A/H)                                    *
  1290*  A.P.R.                                                        *
  1291*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  1292*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  1293*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  1294*  COMPANY I.D. (3 CHARACTER)                                    *
  1295*  BENEFIT CODE                                                  *
  1296*  BENEFIT OVERRIDE CODE                                         *
  1297*                                                                *
  1298*  RETURNED FROM ELEARN                                          *
  1299*  --------------------                                          *
  1300*  INDICATED  EARNINGS                                           *
  1301*----------------------------------------------------------------*
  1302*                 LENGTH = 450                                   *
  1303*                                                                *
  1304******************************************************************
  1305******************************************************************
  1306*                   C H A N G E   L O G
  1307*
  1308* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  26
* EL156.cbl
  1309*-----------------------------------------------------------------
  1310*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1311* EFFECTIVE    NUMBER
  1312*-----------------------------------------------------------------
  1313* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1314* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1315* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1316* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1317* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1318* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1319* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1320* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1321* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1322* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1323******************************************************************
  1324
  1325 01  CALCULATION-PASS-AREA.
  1326     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  1327                                     COMP.
  1328
  1329     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  1330       88  NO-CP-ERROR                             VALUE ZERO.
  1331       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  1332                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  1333       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  1334       88  CP-ERROR-IN-DATES                       VALUE '2'.
  1335       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  1336       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  1337       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  1338       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  1339       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  1340       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  1341       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  1342       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  1343       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  1344       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  1345       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  1346       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  1347       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  1348       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  1349       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  1350
  1351     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  1352       88  NO-CP-ERROR-2                           VALUE ZERO.
  1353***********************  INPUT AREAS ****************************
  1354
  1355     12  CP-CALCULATION-AREA.
  1356         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  1357         16  CP-CERT-EFF-DT        PIC XX.
  1358         16  CP-VALUATION-DT       PIC XX.
  1359         16  CP-PAID-THRU-DT       PIC XX.
  1360         16  CP-BENEFIT-TYPE       PIC X.
  1361           88  CP-AH                               VALUE 'A' 'D'
  1362                                                   'I' 'U'.
  1363           88  CP-REDUCING-LIFE                    VALUE 'R'.
  1364           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  1365         16  CP-INCURRED-DT        PIC XX.
  1366         16  CP-REPORTED-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  27
* EL156.cbl
  1367         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  1368         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  1369         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  1370                                     COMP-3.
  1371         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  1372                                     COMP-3.
  1373         16  CP-CDT-METHOD         PIC X.
  1374           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  1375           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  1376           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  1377         16  CP-CLAIM-TYPE         PIC X.
  1378           88  CP-AH-CLAIM                         VALUE 'A'.
  1379           88  CP-LIFE-CLAIM                       VALUE 'L'.
  1380         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
  1381                                     COMP-3.
  1382         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  1383                                     COMP-3.
  1384         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  1385                                     COMP-3.
  1386         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  1387                                     COMP-3.
  1388         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1389                                     COMP-3.
  1390         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  1391                                     COMP-3.
  1392         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  1393                                     COMP-3.
  1394         16  CP-REM-TERM-METHOD    PIC X.
  1395           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  1396           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  1397           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  1398           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  1399           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  1400           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  1401           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  1402         16  CP-EARNING-METHOD     PIC X.
  1403           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  1404           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  1405           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  1406           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  1407           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  1408           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  1409           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  1410           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  1411           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  1412           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  1413           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1414           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1415           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1416           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1417         16  CP-PROCESS-TYPE       PIC X.
  1418           88  CP-CLAIM                            VALUE '1'.
  1419           88  CP-CANCEL                           VALUE '2'.
  1420           88  CP-ISSUE                            VALUE '3'.
  1421         16  CP-SPECIAL-CALC-CD    PIC X.
  1422           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  1423           88  CP-1-MTH-INTEREST               VALUE ' '.
  1424           88  CP-0-MTH-INTEREST               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  28
* EL156.cbl
  1425           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  1426           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  1427           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  1428           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  1429           88  CP-FARM-PLAN                    VALUE 'F'.
  1430           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  1431           88  CP-2-MTH-INTEREST               VALUE 'I'.
  1432           88  CP-3-MTH-INTEREST               VALUE 'J'.
  1433           88  CP-4-MTH-INTEREST               VALUE 'K'.
  1434           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  1435           88  CP-MORTGAGE-REC                 VALUE 'M'.
  1436           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  1437           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  1438           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
  1439           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  1440                                                     'W' 'X'.
  1441           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  1442           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  1443           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  1444           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  1445           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  1446           88  CP-SUMMARY-REC                  VALUE 'Z'.
  1447           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  1448           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  1449           88  CP-AD-D-BENEFIT                 VALUE '4'.
  1450           88  CP-CSL-METH-1                   VALUE '5'.
  1451           88  CP-CSL-METH-2                   VALUE '6'.
  1452           88  CP-CSL-METH-3                   VALUE '7'.
  1453           88  CP-CSL-METH-4                   VALUE '8'.
  1454
  1455         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  1456                                     COMP-3.
  1457         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  1458         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  1459         16  CP-STATE              PIC XX          VALUE SPACE.
  1460         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  1461         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  1462           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  1463               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  1464         16  CP-R78-OPTION         PIC X.
  1465           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  1466           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  1467
  1468         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  1469         16  CP-IBNR-RESERVE-SW    PIC X.
  1470         16  CP-CLAIM-STATUS       PIC X.
  1471         16  CP-RATE-FILE          PIC X.
  1472         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  1473                                     COMP-3.
  1474
  1475         16  CP-LIFE-OVERRIDE-CODE PIC X.
  1476         16  CP-AH-OVERRIDE-CODE   PIC X.
  1477
  1478         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  1479                                     COMP-3.
  1480         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1481                                   PIC S9(5)V99 COMP-3.
  1482         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  29
* EL156.cbl
  1483                                     COMP-3.
  1484         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  1485                                     COMP-3.
  1486         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  1487                                     COMP-3.
  1488         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1489                                  PIC S9(7)V99 COMP-3.
  1490
  1491         16  CP-PAID-FROM-DATE     PIC X(02).
  1492         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  1493         16  CP-EXT-DAYS-CALC      PIC X.
  1494           88  CP-EXT-NO-CHG                   VALUE ' '.
  1495           88  CP-EXT-CHG-LF                   VALUE '1'.
  1496           88  CP-EXT-CHG-AH                   VALUE '2'.
  1497           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  1498         16  CP-DOMICILE-STATE     PIC XX.
  1499         16  CP-CARRIER            PIC X.
  1500         16  CP-REIN-FLAG          PIC X.
  1501         16  CP-REM-TRM-CALC-OPTION PIC X.
  1502           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  1503                      '2' '3' '4' '5'.
  1504           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  1505           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  1506           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  1507           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  1508           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  1509           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  1510           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  1511           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1512         16  CP-SIG-SWITCH         PIC X.
  1513         16  CP-RATING-METHOD      PIC X.
  1514           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  1515           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  1516           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  1517           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  1518           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  1519           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  1520           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  1521           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  1522           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  1523         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  1524                                     COMP-3.
  1525         16  CP-BEN-CATEGORY       PIC X.
  1526         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1527         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1528                                   PIC S99V9(5) COMP-3.
  1529         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1530         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1531                                   PIC S99V9(5) COMP-3.
  1532         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1533         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1534         16  CP-EXPIRE-DT          PIC XX.
  1535         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1536         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1537         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1538         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1539         16  CP-DDF-SPEC-CALC      PIC X.
  1540             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  30
* EL156.cbl
  1541             88  CP-CALC-CLP              VALUE 'C'.
  1542         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1543         16  CP-CANCEL-REASON      PIC X.
  1544         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1545         16  CP-PMT-MODE           PIC X.
  1546         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1547         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1548         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1549         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1550         16  FILLER                PIC X.
  1551
  1552***************    OUTPUT FROM ELRESV   ************************
  1553
  1554         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
  1555
  1556         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  1557                                     COMP-3.
  1558         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  1559                                     COMP-3.
  1560         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  1561                                     COMP-3.
  1562         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  1563                                     COMP-3.
  1564         16  FILLER                PIC X(09).
  1565***************    OUTPUT FROM ELRTRM   *************************
  1566
  1567         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  1568                                     COMP-3.
  1569         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  1570                                     COMP-3.
  1571         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  1572                                     COMP-3.
  1573         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  1574                                     COMP-3.
  1575         16  FILLER                PIC X(12).
  1576
  1577***************    OUTPUT FROM ELRAMT   *************************
  1578
  1579         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  1580                                     COMP-3.
  1581         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  1582                                     COMP-3.
  1583         16  FILLER                PIC X(12).
  1584
  1585***************    OUTPUT FROM ELRATE   *************************
  1586
  1587         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  1588                                     COMP-3.
  1589         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  1590                                     COMP-3.
  1591         16  CP-MORTALITY-CODE     PIC X(4).
  1592         16  CP-RATE-EDIT-FLAG     PIC X.
  1593             88  CP-RATES-NEED-APR                  VALUE '1'.
  1594         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  1595                                     COMP-3.
  1596         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  1597         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1598         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  31
* EL156.cbl
  1599                                   PIC S9(7)V99 COMP-3.
  1600         16  FILLER                PIC X(07).
  1601
  1602***************    OUTPUT FROM ELRFND   *************************
  1603
  1604         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  1605                                     COMP-3.
  1606         16  CP-REFUND-TYPE-USED   PIC X.
  1607           88  CP-R-AS-R78                         VALUE '1'.
  1608           88  CP-R-AS-PRORATA                     VALUE '2'.
  1609           88  CP-R-AS-CALIF                       VALUE '3'.
  1610           88  CP-R-AS-TEXAS                       VALUE '4'.
  1611           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  1612           88  CP-R-AS-NET-PAY                     VALUE '5'.
  1613           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  1614           88  CP-R-AS-MEAN                        VALUE '8'.
  1615           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  1616           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1617           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1618           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1619           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1620           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1621         16  FILLER                PIC X(12).
  1622
  1623***************    OUTPUT FROM ELEARN   *************************
  1624
  1625         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  1626                                     COMP-3.
  1627         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  1628                                     COMP-3.
  1629         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  1630                                     COMP-3.
  1631         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  1632                                     COMP-3.
  1633         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  1634                                     COMP-3.
  1635         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  1636                                     COMP-3.
  1637         16  CP-EARNING-TYPE-USED  PIC X.
  1638           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  1639           88  CP-E-AS-R78                         VALUE '1'.
  1640           88  CP-E-AS-PRORATA                     VALUE '2'.
  1641           88  CP-E-AS-TEXAS                       VALUE '4'.
  1642           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  1643           88  CP-E-AS-NET-PAY                     VALUE '5'.
  1644           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  1645           88  CP-E-AS-MEAN                        VALUE '8'.
  1646           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  1647         16  FILLER                PIC X(12).
  1648
  1649***************    OUTPUT FROM ELPMNT   *************************
  1650
  1651         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  1652                                     COMP-3.
  1653         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  1654                                     COMP-3.
  1655         16  FILLER                PIC X(12).
  1656
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  32
* EL156.cbl
  1657***************   MISC WORK AREAS    *****************************
  1658         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  1659                                     COMP-3.
  1660         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  1661                                     COMP-3.
  1662         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  1663                                     COMP-3.
  1664         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  1665                                     COMP-3.
  1666         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  1667                                     COMP-3.
  1668         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  1669                                     COMP-3.
  1670         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
  1671             88  OPEN-RATE-FILE                   VALUE 'O'.
  1672             88  CLOSE-RATE-FILE                  VALUE 'C'.
  1673             88  IO-ERROR                         VALUE 'E'.
  1674
  1675         16  CP-FIRST-PAY-DATE     PIC XX.
  1676
  1677         16  CP-JOINT-INDICATOR    PIC X.
  1678
  1679         16  CP-RESERVE-REMAINING-TERM
  1680                                   PIC S9(4)V9    VALUE ZERO
  1681                                     COMP-3.
  1682
  1683         16  CP-INSURED-BIRTH-DT   PIC XX.
  1684
  1685         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  1686                                     COMP-3.
  1687
  1688         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  1689                                     COMP-3.
  1690
  1691         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  1692                                     COMP-3.
  1693
  1694         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  1695                                     COMP-3.
  1696
  1697         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  1698                                     COMP-3.
  1699
  1700         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  1701                                     COMP-3.
  1702
  1703         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  1704                                     COMP-3.
  1705
  1706         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  1707             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  1708
  1709         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  1710                                     COMP-3.
  1711         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1712                                     COMP-3.
  1713         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1714         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  33
* EL156.cbl
  1715         16  cp-net-only-state     pic x value spaces.
  1716         16  FILLER                PIC X(13).
  1717******************************************************************
  1718*    COPY ELCICALC.
  1719******************************************************************
  1720*                                                                *
  1721*                           ELCCICALC.                           *
  1722*                            VMOD=2.001                          *
  1723*                                                                *
  1724*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
  1725*                 CALCULATION MODULE                             *
  1726*                                                                *
  1727*  PASSED TO ELCLMI                                              *
  1728*  -----------------                                             *
  1729*  STATE                                                         *
  1730*  PRODUCT                                                       *
  1731*  COVERAGE                                                      *
  1732*  EFFECTIVE DATE                                                *
  1733*  INCURRED DATE                                                 *
  1734*  ESTABLISHED DATE                                              *
  1735*  LAST PAID DATE                                                *
  1736*  REPORTED DATE                                                 *
  1737*  CLAIM PAYMENT AMOUNT                                          *
  1738*                                                                *
  1739*  RETURNED FROM ELRTRM                                          *
  1740*  ---------------------                                         *
  1741*  RETURN CODE                                                   *
  1742*  CLAIM INTEREST DUE SWITCH Y/N                                 *
  1743*  CLAIM INTEREST AMOUNT                                         *
  1744*----------------------------------------------------------------*
  1745*----------------------------------------------------------------*
  1746*                 LENGTH = 100                                   *
  1747*                                                                *
  1748******************************************************************
  1749******************************************************************
  1750*                   C H A N G E   L O G
  1751*
  1752* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1753*-----------------------------------------------------------------
  1754*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1755* EFFECTIVE    NUMBER
  1756*-----------------------------------------------------------------
  1757* 120905    2004040700004  PEMA  NEW COPYBOOK
  1758* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
  1759******************************************************************
  1760
  1761 01  CLAIM-INT-PASS-AREA.
  1762     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
  1763                                     COMP.
  1764
  1765     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
  1766       88  NO-CI-ERROR                             VALUE ZERO.
  1767       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
  1768       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
  1769       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
  1770       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
  1771       88  CP-AMT-LT-5000                          VALUE '4'.
  1772       88  CP-ERROR-IN-DATES                       VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  34
* EL156.cbl
  1773       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
  1774       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
  1775       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
  1776***********************  INPUT AREAS ****************************
  1777
  1778     12  CP-CALCULATION-AREA.
  1779         16  CP-COMPANY-CD         PIC X.
  1780         16  CP-STATE              PIC XX.
  1781         16  CP-PRODUCT            PIC XX.
  1782         16  CP-COVERAGE           PIC XX.
  1783         16  CP-INC-DT             PIC XX.
  1784         16  CP-EST-DT             PIC XX.
  1785         16  CP-LSTPD-DT           PIC XX.
  1786         16  CP-RPT-DT             PIC XX.
  1787         16  CP-PRF-DT             PIC XX.
  1788         16  CP-EFF-DT             PIC XX.
  1789         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
  1790         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
  1791         16  FILLER                PIC X(37).
  1792
  1793***************    OUTPUT FROM ELCLMI   ************************
  1794
  1795         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
  1796
  1797         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
  1798         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
  1799         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
  1800         16  FILLER                PIC X(19).
  1801******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  35
* EL156.cbl
  1803*    COPY ELCATTR.
  1804******************************************************************
  1805*                                                                *
  1806*                            ELCATTR.                            *
  1807*                            VMOD=2.001                          *
  1808*                                                                *
  1809*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1810*                                                                *
  1811*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1812*                                                                *
  1813*                   POS 1   P=PROTECTED                          *
  1814*                           U=UNPROTECTED                        *
  1815*                           S=ASKIP                              *
  1816*                   POS 2   A=ALPHA/NUMERIC                      *
  1817*                           N=NUMERIC                            *
  1818*                   POS 3   N=NORMAL                             *
  1819*                           B=BRIGHT                             *
  1820*                           D=DARK                               *
  1821*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1822*                           OF=MODIFIED DATA TAG OFF             *
  1823*                                                                *
  1824*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1825******************************************************************
  1826 01  ATTRIBUTE-LIST.
  1827     12  AL-PABOF            PIC X       VALUE 'Y'.
  1828     12  AL-PABON            PIC X       VALUE 'Z'.
  1829     12  AL-PADOF            PIC X       VALUE '%'.
  1830     12  AL-PADON            PIC X       VALUE '_'.
  1831     12  AL-PANOF            PIC X       VALUE '-'.
  1832     12  AL-PANON            PIC X       VALUE '/'.
  1833     12  AL-SABOF            PIC X       VALUE '8'.
  1834     12  AL-SABON            PIC X       VALUE '9'.
  1835     12  AL-SADOF            PIC X       VALUE '@'.
  1836     12  AL-SADON            PIC X       VALUE QUOTE.
  1837     12  AL-SANOF            PIC X       VALUE '0'.
  1838     12  AL-SANON            PIC X       VALUE '1'.
  1839     12  AL-UABOF            PIC X       VALUE 'H'.
  1840     12  AL-UABON            PIC X       VALUE 'I'.
  1841     12  AL-UADOF            PIC X       VALUE '<'.
  1842     12  AL-UADON            PIC X       VALUE '('.
  1843     12  AL-UANOF            PIC X       VALUE ' '.
  1844     12  AL-UANON            PIC X       VALUE 'A'.
  1845     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1846     12  AL-UNBON            PIC X       VALUE 'R'.
  1847     12  AL-UNDOF            PIC X       VALUE '*'.
  1848     12  AL-UNDON            PIC X       VALUE ')'.
  1849     12  AL-UNNOF            PIC X       VALUE '&'.
  1850     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  36
* EL156.cbl
  1852*    COPY ELCEMIB.
  1853******************************************************************
  1854*                                                                *
  1855*                                                                *
  1856*                            ELCEMIB.                            *
  1857*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1858*                            VMOD=2.005                          *
  1859*                                                                *
  1860*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1861*                                                                *
  1862******************************************************************
  1863 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1864     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1865     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1866     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1867     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1868     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1869     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1870     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1871     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1872     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1873         88  EMI-NO-ERRORS                    VALUE '1'.
  1874         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1875         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1876     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1877         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1878     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1879         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1880         88  EMI-AREA1-FULL                   VALUE '2'.
  1881     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1882         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1883         88  EMI-AREA2-FULL                   VALUE '2'.
  1884     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1885         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1886         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1887         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1888         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1889         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1890     12  EMI-ERROR-LINES.
  1891         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1892         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1893         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1894         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1895             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1896                 24  EMI-ERR-NUM         PIC X(4).
  1897                 24  EMI-FILLER          PIC X.
  1898                 24  EMI-SEV             PIC X.
  1899                 24  FILLER              PIC X.
  1900             20  FILLER                  PIC X(02).
  1901     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1902         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1903             20  EMI-ERROR-NUMBER    PIC X(4).
  1904             20  EMI-FILL            PIC X.
  1905             20  EMI-SEVERITY        PIC X.
  1906             20  FILLER              PIC X.
  1907             20  EMI-ERROR-TEXT.
  1908                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1909                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  37
* EL156.cbl
  1910     12  EMI-SEVERITY-SAVE           PIC X.
  1911         88  EMI-NOTE                    VALUE 'N'.
  1912         88  EMI-WARNING                 VALUE 'W'.
  1913         88  EMI-FORCABLE                VALUE 'F'.
  1914         88  EMI-FATAL                   VALUE 'X'.
  1915     12  EMI-MESSAGE-FLAG            PIC X.
  1916         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1917         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1918     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1919     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1920         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1921         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1922         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1923     12  emi-claim-no                pic x(7).
  1924     12  emi-claim-type              pic x(6).
  1925     12  FILLER                      PIC X(124)  VALUE SPACES.
  1926     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1927     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1928     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1929     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  38
* EL156.cbl
  1931*    COPY ELCLNKLT.
  1932******************************************************************
  1933*                                                                *
  1934*                                                                *
  1935*                           ELCLNKLT                             *
  1936*                            VMOD=2.003                          *
  1937*                                                                *
  1938*   THIS COPY BOOK IS USED TO PASS DATA TO THE LETTER GENERATOR  *
  1939*   PROGRAM (EL1523). THE AREA SHOULD BE INITIALIZED TO LOW-     *
  1940*   VALUES BEFORE ENTERING YOUR INFORMATION.                     *
  1941*                                                                *
  1942*   MOVE THE PROGRAM-INTERFACE-BLOCK TO W-1523-LINK-DATA BEFORE  *
  1943*   COMPLETING THE REQUIRED FIELDS.                              *
  1944*                                                                *
  1945*   THE CALLING PROGRAM SHOULD CHECK:                            *
  1946*   1. W-1523-ERROR-CODE WHERE 0000 INDICATES NO ERROR DETECTED. *
  1947*                              9999 INDICATES AN UNKNOWN ABEND   *
  1948*                                   WAS DETECTED.                *
  1949*                              ALL OTHER VALUES ARE NORMAL ERROR *
  1950*                              CODES FOUND IN THE ERROR FILE.    *
  1951******************************************************************
  1952 01  W-1523-LINKDATA.
  1953     12  W-1523-COMMON-PI-DATA.
  1954         16  W-1523-COMM-LENGTH  PIC S9(04) COMP   VALUE +1024.
  1955         16  FILLER              PIC  X(67).
  1956         16  W-1523-COMPANY-CD   PIC  X(01).
  1957         16  FILLER              PIC  X(10).
  1958         16  W-1523-CONTROL-IN-PROGRESS.
  1959             20  W-1523-CARRIER  PIC  X(01).
  1960             20  W-1523-GROUPING PIC  X(06).
  1961             20  W-1523-STATE    PIC  X(02).
  1962             20  W-1523-ACCOUNT  PIC  X(10).
  1963             20  W-1523-CLAIM-CERT-GRP.
  1964                 24  W-1523-CLAIM-NO
  1965                                 PIC  X(07).
  1966                 24  W-1523-CERT-NO.
  1967                     28  W-1523-CERT-PRIME
  1968                                 PIC  X(10).
  1969                     28  W-1523-CERT-SFX
  1970                                 PIC  X(01).
  1971                 24  W-1523-CERT-EFF-DT
  1972                                 PIC  X(02).
  1973         16  FILLER              PIC X(265).
  1974
  1975     12  W-1523-WORK-AREA.
  1976         16  W-1523-FORM-NUMBER  PIC  X(04).
  1977         16  W-1523-NUMBER-COPIES
  1978                                 PIC  9(01).
  1979         16  W-1523-ADDR-TYPE    PIC  X(02).
  1980         16  W-1523-FOLLOW-UP-DATE
  1981                                 PIC  X(02).
  1982         16  W-1523-RESEND-DATE  PIC  X(02).
  1983         16  W-1523-ERROR-CODE   PIC  9(04).
  1984             88  W-1523-NO-ERRORS-DETECTED VALUE 0000.
  1985             88  W-1523-FATAL-ERROR
  1986                                    VALUES  0006 0013 0042
  1987                                            0154 0168 0169
  1988                                            0176 9999 0172
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  39
* EL156.cbl
  1989                                            0179 0186 0281
  1990                                            0332 2055 3697
  1991                                            3698 3699 3770
  1992                                            3771 3772 7675
  1993                                            9106 9808 9883
  1994                                            9887.
  1995             88  W-1523-STOP-ERRORS
  1996                                    VALUES  0013 0042 0154
  1997                                            0168 0169 0172
  1998                                            0281 0332 2055
  1999                                            3698 3699 7675
  2000                                            9106 9808 9883
  2001                                            9999.
  2002         16  W-1523-REASON       PIC  X(70).
  2003         16  W-1523-ARCHIVE-NUMBER
  2004                                 PIC  9(08).
  2005     12  W-1523-POINTER-AREA.
  2006         16  W-1523-ACCT-POINTER PIC S9(08) COMP.
  2007         16  W-1523-ACTY-POINTER PIC S9(08) COMP.
  2008         16  W-1523-ARCH-POINTER PIC S9(08) COMP.
  2009         16  W-1523-VAR-POINTER  PIC S9(08) COMP.
  2010         16  W-1523-PROD-POINTER PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  40
* EL156.cbl
  2012*    COPY ELCNWA.
  2013*****************************************************************
  2014*                                                               *
  2015*                                                               *
  2016*                            ELCNWA.                            *
  2017*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2018*                            VMOD=2.003                         *
  2019*                                                               *
  2020*            M O V E   N A M E   W O R K   A R E A.             *
  2021*                                                               *
  2022*****************************************************************.
  2023
  2024 01  WS-NAME-WORK-AREA.
  2025     05  WS-INSURED-LAST-NAME        PIC X(15).
  2026     05  WS-INSURED-1ST-NAME         PIC X(12).
  2027     05  WS-INSURED-MID-INIT         PIC X.
  2028
  2029     05  WS-NAME-WORK.
  2030         10  WS-NW                   PIC X
  2031             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  2032
  2033     05  WS-NAME-WORK2.
  2034         10  WS-NW2                  PIC X
  2035             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  2036                                        NWA-INDEX0.
  2037
  2038     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  2039                                     COMP-3.
  2040
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  41
* EL156.cbl
  2042*    COPY ELCDMO.
  2043******************************************************************
  2044*                                                                *
  2045*                                                                *
  2046*                            ELCDMO.                             *
  2047*                            VMOD=2.004                          *
  2048*                                                                *
  2049*   FILE DESCRIPTION = DLO025 (DMO FILE MAINTENANCE PGRM)        *
  2050*        COMMUNICATION AREA                                      *
  2051*   FILE TYPE = NA                                               *
  2052*   RECORD SIZE = 110    RECFORM = FIXED                         *
  2053*                                                                *
  2054******************************************************************
  2055 01  DMO-COMMUNICATION-AREA.
  2056     12  DM-RECORD-TYPE                  PIC  X(02).
  2057             88  DM-ISSUE-TRAN                VALUE 'CC'.
  2058             88  DM-CLAIM-STATUS-CHANGE       VALUE 'CS'.
  2059             88  DM-CLAIM-PAYMENT             VALUE 'DR'.
  2060     12  DM-DIST-CODE                    PIC  X(04).
  2061     12  DM-MAIL-CODE                    PIC  X(05).
  2062     12  DM-CREDIT-CARD-NUMBER           PIC  X(16).
  2063     12  DM-INSURED-NAME                 PIC  X(30).
  2064     12  DM-CLAIM-NO                     PIC  X(07).
  2065     12  DM-CLAIM-TYPE                   PIC  X.
  2066
  2067     12  DM-STATUS-DATA-AREA.
  2068         16  DM-CLAIM-STATUS             PIC  X.
  2069             88  DM-OPEN-NO-PAYMENTS              VALUE '1'.
  2070             88  DM-OPEN-WITH-PAYMENTS            VALUE '2'.
  2071             88  DM-CLOSED                        VALUE '3'.
  2072             88  DM-CLOSE-SETTLE-FINAL            VALUE '4'.
  2073             88  DM-DEFAULT                       VALUE '9'.
  2074         16  DM-STATUS-DATE              PIC  X(08).
  2075******YYYYMMDD
  2076         16  DM-STAT-CHANGE-TYPE         PIC  X.
  2077             88  DM-MANUAL-CLOSE                  VALUE 'C'.
  2078             88  DM-CLAIM-DENIED                  VALUE 'D'.
  2079             88  DM-FINAL-PAYMENT                 VALUE 'F'.
  2080             88  DM-INITIAL-PAYMENT               VALUE 'I'.
  2081             88  DM-AUTO-CLOSE                    VALUE 'Q'.
  2082             88  DM-RE-OPENED                     VALUE 'R'.
  2083             88  DM-NEW-CLAIM-SETUP               VALUE 'S'.
  2084             88  DM-VOIDED-PAYMENT                VALUE 'V'.
  2085             88  DM-CLAIM-DELETED                 VALUE 'X'.
  2086         16  DM-STAT-CARRIER             PIC X.
  2087
  2088     12  DM-DRAFT-DATA-AREA.
  2089         16  DM-PAYMENT-TYPE             PIC  X.
  2090             88  DM-VALID-CLAIM-TYPES VALUES 'L' 'D' 'U' 'A'.
  2091         16  DM-PAYMENT-AMT              PIC  9(05)V9(02).
  2092         16  DM-PAYMENT-DATE             PIC  X(08).
  2093******YYYYMMDD
  2094         16  DM-CERT-NO                  PIC  X(11).
  2095         16  DM-TRLR-SEQ-NO              PIC  9(04).
  2096         16  DM-CARRIER                  PIC  X.
  2097
  2098     12  DM-RETURN-CODE                  PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  42
* EL156.cbl
  2100*    COPY ELCDMDCD.
  2101******************************************************************
  2102*                                                                *
  2103*                                                                *
  2104*                            ELCDMDCD.                           *
  2105*                            VMOD=2.001                          *
  2106*                                                                *
  2107*   DESCRIPTION = CODES VALIDATION PROGRAM (DLO023)              *
  2108*       COMMUNICATIONS AREA                                      *
  2109*                                                                *
  2110******************************************************************
  2111 01  CD-COMMUNICATION-AREA.
  2112     12  CD-SYSTEM-ID            PIC  X(02).
  2113         88 CD-CLAIMS                      VALUE 'CL'.
  2114         88 CD-CREDIT                      VALUE 'CR'.
  2115     12  CD-RECORD-TYPE          PIC  X(02).
  2116         88 CD-DENIAL-CODE                 VALUE 'DN'.
  2117         88 CD-EOB-CODE                    VALUE 'EO'.
  2118         88 CD-ICD9-CODE                   VALUE 'I9'.
  2119         88 CD-OCCUPATION-CODE             VALUE 'OC'.
  2120         88 CD-PAYMENT-NOT-CODE            VALUE 'PN'.
  2121         88 CD-CAUSE-CODE                  VALUE 'CS'.
  2122         88 CD-COVERAGE-CAT-CODE           VALUE 'CV'.
  2123         88 CD-RESIDENT-STATE-CODE         VALUE 'RS'.
  2124     12  CD-RECORD-KEY           PIC  X(06).
  2125         88 CD-SUCCESSFUL                  VALUE 'OK'.
  2126     12  CD-RETURN-CODE          PIC  X(02).
  2127     12  CD-CODE-DESCRIPTION     PIC  X(60).
  2128     12  CD-GENERAL-DESCRIPTION1 PIC  X(20).
  2129     12  CD-GENERAL-DESCRIPTION2 PIC  X(20).
  2130     12  CD-GENERAL-DESCRIPTION3 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  43
* EL156.cbl
  2132*    COPY ELCDCTB.
  2133******************************************************************
  2134*                                                                *
  2135*                                                                *
  2136*                            ELCDCTB.                            *
  2137*                            VMOD=2.002                          *
  2138*                                                                *
  2139*   DESCRIPTION = DISTRIBUTION CONTROL TABLE MAINTENANCE PROGRAM *
  2140*       COMMUNICATIONS AREA                                      *
  2141*                                                                *
  2142******************************************************************
  2143 01  DCT-COMMUNICATION-AREA.
  2144     12  DCT-BILLING-BANK-ID      PIC  X(05).
  2145     12  DCT-LOGIC-BENEFICIARY-ID PIC  X(10).
  2146     12  DCT-CREDIT-CARD-NUMBER   PIC  X(16).
  2147     12  DCT-PRODUCT-CODE         PIC  X(02).
  2148     12  DCT-COLUMN-ID-REQUESTED  PIC  X(02).
  2149     12  DCT-RETURN-CODE          PIC  X(02).
  2150     12  DCT-MAIL-CODE            PIC  X(05).
  2151     12  DCT-DISTRIBUTION-CODE    PIC  X(04).
  2152     12  DCT-MSA-ACCT-NO          PIC  X(07).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  44
* EL156.cbl
  2154 01  CD-RCRD-LENGTH                  PIC S9(4)  COMP VALUE +132.
  2155 01  DCT-RCRD-LENGTH                 PIC S9(4)  COMP VALUE +53.
  2156 01  DM-DMO-LENGTH                   PIC S9(4)  COMP VALUE +108.
  2157 01  DL35-LENGTH                     PIC S9(4)  COMP VALUE +34.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  45
* EL156.cbl
  2159*    COPY ELCINTF.
  2160******************************************************************
  2161*                                                                *
  2162*                                                                *
  2163*                            ELCINTF.                            *
  2164*                            VMOD=2.017                          *
  2165*                                                                *
  2166*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2167*                                                                *
  2168*       LENGTH = 1024                                            *
  2169*                                                                *
  2170******************************************************************
  2171*                   C H A N G E   L O G
  2172*
  2173* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2174*-----------------------------------------------------------------
  2175*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2176* EFFECTIVE    NUMBER
  2177*-----------------------------------------------------------------
  2178* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2179******************************************************************
  2180 01  PROGRAM-INTERFACE-BLOCK.
  2181     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2182     12  PI-CALLING-PROGRAM              PIC X(8).
  2183     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2184     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2185     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2186     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2187     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2188     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2189     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2190     12  PI-COMPANY-ID                   PIC XXX.
  2191     12  PI-COMPANY-CD                   PIC X.
  2192
  2193     12  PI-COMPANY-PASSWORD             PIC X(8).
  2194
  2195     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2196
  2197     12  PI-CONTROL-IN-PROGRESS.
  2198         16  PI-CARRIER                  PIC X.
  2199         16  PI-GROUPING                 PIC X(6).
  2200         16  PI-STATE                    PIC XX.
  2201         16  PI-ACCOUNT                  PIC X(10).
  2202         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2203                                         PIC X(10).
  2204         16  PI-CLAIM-CERT-GRP.
  2205             20  PI-CLAIM-NO             PIC X(7).
  2206             20  PI-CERT-NO.
  2207                 25  PI-CERT-PRIME       PIC X(10).
  2208                 25  PI-CERT-SFX         PIC X.
  2209             20  PI-CERT-EFF-DT          PIC XX.
  2210         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2211             20  PI-PLAN-CODE            PIC X(2).
  2212             20  PI-REVISION-NUMBER      PIC X(3).
  2213             20  PI-PLAN-EFF-DT          PIC X(2).
  2214             20  PI-PLAN-EXP-DT          PIC X(2).
  2215             20  FILLER                  PIC X(11).
  2216         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  46
* EL156.cbl
  2217             20  PI-OE-REFERENCE-1.
  2218                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2219                 25  PI-OE-REF-1-SUFF    PIC XX.
  2220
  2221     12  PI-SESSION-IN-PROGRESS          PIC X.
  2222         88  CLAIM-SESSION                   VALUE '1'.
  2223         88  CREDIT-SESSION                  VALUE '2'.
  2224         88  WARRANTY-SESSION                VALUE '3'.
  2225         88  MORTGAGE-SESSION                VALUE '4'.
  2226         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2227
  2228
  2229*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2230
  2231     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2232     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2233
  2234     12  PI-CREDIT-USER                  PIC X.
  2235         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2236         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2237
  2238     12  PI-CLAIM-USER                   PIC X.
  2239         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2240         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2241
  2242     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2243         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2244         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2245         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2246         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2247         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2248
  2249     12  PI-PROCESSOR-ID                 PIC X(4).
  2250
  2251     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2252
  2253     12  PI-MEMBER-CAPTION               PIC X(10).
  2254
  2255     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2256         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2257
  2258     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2259     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2260     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2261     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2262
  2263     12  PI-AH-OVERRIDE-L1               PIC X.
  2264     12  PI-AH-OVERRIDE-L2               PIC XX.
  2265     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2266     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2267
  2268     12  PI-NEW-SYSTEM                   PIC X(2).
  2269
  2270     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2271     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2272         88  PI-USES-PAID-TO                 VALUE '1'.
  2273     12  PI-CRDTCRD-SYSTEM.
  2274         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  47
* EL156.cbl
  2275             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2276             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2277         16  PI-CC-MONTH-END-DT          PIC XX.
  2278     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2279
  2280     12  PI-OE-REFERENCE-2.
  2281         16  PI-OE-REF-2-PRIME           PIC X(10).
  2282         16  PI-OE-REF-2-SUFF            PIC X.
  2283
  2284     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2285
  2286     12  PI-LANGUAGE-TYPE                PIC X.
  2287             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2288             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2289             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2290
  2291     12  PI-POLICY-LINKAGE-IND           PIC X.
  2292         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2293         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2294                                                   LOW-VALUES.
  2295
  2296     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2297     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2298         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2299         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2300
  2301     12  PI-PROCESSOR-CSR-IND            PIC X.
  2302         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2303         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2304
  2305     12  FILLER                          PIC X(3).
  2306
  2307     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2308
  2309     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2310         PI-SYSTEM-LEVEL.
  2311
  2312         16  PI-ENTRY-CODES.
  2313             20  PI-ENTRY-CD-1           PIC X.
  2314             20  PI-ENTRY-CD-2           PIC X.
  2315
  2316         16  PI-RETURN-CODES.
  2317             20  PI-RETURN-CD-1          PIC X.
  2318             20  PI-RETURN-CD-2          PIC X.
  2319
  2320         16  PI-UPDATE-STATUS-SAVE.
  2321             20  PI-UPDATE-BY            PIC X(4).
  2322             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2323
  2324         16  PI-LOWER-CASE-LETTERS       PIC X.
  2325             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2326
  2327*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2328*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2329*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2330
  2331         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2332             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  48
* EL156.cbl
  2333             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2334             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2335             88  ACCNT-CNTL                  VALUE '3'.
  2336             88  CARR-ACCNT-CNTL             VALUE '4'.
  2337
  2338         16  PI-PROCESSOR-CAP-LIST.
  2339             20  PI-SYSTEM-CONTROLS.
  2340                24 PI-SYSTEM-DISPLAY     PIC X.
  2341                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2342                24 PI-SYSTEM-MODIFY      PIC X.
  2343                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2344             20  FILLER                  PIC XX.
  2345             20  PI-DISPLAY-CAP          PIC X.
  2346                 88  DISPLAY-CAP             VALUE 'Y'.
  2347             20  PI-MODIFY-CAP           PIC X.
  2348                 88  MODIFY-CAP              VALUE 'Y'.
  2349             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2350                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2351             20  PI-FORCE-CAP            PIC X.
  2352                 88  FORCE-CAP               VALUE 'Y'.
  2353
  2354         16  PI-PROGRAM-CONTROLS.
  2355             20  PI-PGM-PRINT-OPT        PIC X.
  2356             20  PI-PGM-FORMAT-OPT       PIC X.
  2357             20  PI-PGM-PROCESS-OPT      PIC X.
  2358             20  PI-PGM-TOTALS-OPT       PIC X.
  2359
  2360         16  PI-HELP-INTERFACE.
  2361             20  PI-LAST-ERROR-NO        PIC X(4).
  2362             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2363
  2364         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2365             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2366
  2367         16  PI-CR-CONTROL-IN-PROGRESS.
  2368             20  PI-CR-CARRIER           PIC X.
  2369             20  PI-CR-GROUPING          PIC X(6).
  2370             20  PI-CR-STATE             PIC XX.
  2371             20  PI-CR-ACCOUNT           PIC X(10).
  2372             20  PI-CR-FIN-RESP          PIC X(10).
  2373             20  PI-CR-TYPE              PIC X.
  2374
  2375         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2376
  2377         16  PI-CR-MONTH-END-DT          PIC XX.
  2378
  2379         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2380             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2381             88  PI-ZERO-CARRIER             VALUE '1'.
  2382             88  PI-ZERO-GROUPING            VALUE '2'.
  2383             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2384
  2385         16  PI-CARRIER-SECURITY         PIC X.
  2386             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2387
  2388         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2389             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2390             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  49
* EL156.cbl
  2391
  2392         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2393             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2394                                         INDEXED BY PI-ACCESS-NDX
  2395                                         PIC X.
  2396
  2397         16  PI-GA-BILLING-CONTROL       PIC X.
  2398             88  PI-GA-BILLING               VALUE '1'.
  2399
  2400         16  PI-MAIL-PROCESSING          PIC X.
  2401             88  PI-MAIL-YES                 VALUE 'Y'.
  2402
  2403         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2404
  2405         16  PI-AR-SYSTEM.
  2406             20  PI-AR-PROCESSING-CNTL   PIC X.
  2407                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2408             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2409             20  PI-AR-MONTH-END-DT      PIC XX.
  2410
  2411         16  PI-MP-SYSTEM.
  2412             20  PI-MORTGAGE-USER            PIC X.
  2413                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2414                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2415             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2416                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2417                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2418                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2419                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2420                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2421             20  PI-MP-MONTH-END-DT          PIC XX.
  2422             20  PI-MP-REFERENCE-NO.
  2423                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2424                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2425
  2426         16  PI-LABEL-CONTROL            PIC X(01).
  2427             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2428             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2429
  2430         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2431             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2432
  2433         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2434             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2435             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2436
  2437         16  FILLER                      PIC X(14).
  2438
  2439     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2440******************************************************************
  2441     12  PI-REDEF     REDEFINES PI-PROGRAM-WORK-AREA.
  2442         16  PI-SAVE-FORM        PIC X(12).
  2443         16  PI-ACCT-KEY         PIC X(26).
  2444         16  PI-PAYEE-NAME       PIC X(30).
  2445         16  PI-DAILY-RATE       PIC S9(3)V99.
  2446         16  PI-MONTH-END-SAVE   PIC XX.
  2447         16  PI-BENEFIT-SAVE.
  2448             20  PI-BEN-DAYS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  50
* EL156.cbl
  2449             20  PI-BEN-TYPE     PIC X.
  2450         16  PI-MANUAL-SW        PIC 9.
  2451         16  PI-SAVE-CURSOR      PIC S9(4) COMP.
  2452         16  PI-PASS-SW          PIC X.
  2453         16  PI-PFKEY-USED       PIC X.
  2454         16  PI-CK-ASSIGN        PIC X.
  2455         16  PI-FATAL-COUNT      PIC 99.
  2456         16  PI-FORCE-COUNT      PIC 99.
  2457         16  PI-SAVE-INPUT.
  2458             20  PI-PMTTYPE      PIC X.
  2459             20  PI-PAYEE.
  2460                 24  PI-PAYEE-TYPE PIC X.
  2461                 24  PI-PAYEE-SEQ  PIC X.
  2462                 24  PI-PAYEE-SEQ-NUM REDEFINES
  2463                   PI-PAYEE-SEQ    PIC S9.
  2464             20  PI-PMTNOTE1     PIC X(60).
  2465             20  PI-PMTNOTE2     PIC X(60).
  2466             20  PI-OFFLINE      PIC X.
  2467             20  PI-ECHECKNO     PIC X(7).
  2468             20  PI-ECHECKNO-RDF REDEFINES PI-ECHECKNO.
  2469                 28  PI-ECHECKNO-N     PIC X.
  2470                 28  PI-ECHECKNO-6     PIC X(6).
  2471             20  PI-ECHECKNO-RDF1 REDEFINES PI-ECHECKNO.
  2472                 24  PI-ECHECKNO-CR    PIC XX.
  2473                 24  PI-ECHECKNO-5     PIC X(5).
  2474             20  PI-HOLDTIL      PIC 9(6).
  2475             20  PI-EPYFROM      PIC 9(6).
  2476             20  PI-EPYTHRU      PIC 9(6).
  2477             20  PI-EDAYS        PIC S9(5).
  2478             20  PI-EPYAMT       PIC S9(7)V99.
  2479             20  PI-ERESV        PIC S9(7)V99.
  2480             20  PI-EEXPENS      PIC 9(6)V99.
  2481             20  PI-ETYPE        PIC X.
  2482             20  PI-CASH         PIC X.
  2483             20  PI-GROUPED      PIC X.
  2484             20  PI-INT-RATE     PIC S99V9(5).
  2485             20  PI-AIGFROM      PIC 9(6).
  2486             20  PI-LOAN-NO      PIC X(20).
  2487             20  PI-PROOF-DATE   PIC 9(6).
  2488             20  PI-PRINT-EOB-YN PIC X.
  2489             20  PI-PRINT-CLM-FRM-YN PIC X.
  2490             20  PI-PRINT-SURVEY-YN PIC X.
  2491             20  PI-SPECIAL-RELEASE-YN PIC X.
  2492         16  PI-SAVE-COMPUTED.
  2493             20  PI-CCHECKNO     PIC X(7).
  2494             20  PI-CCHECKNO-RDF REDEFINES PI-CCHECKNO.
  2495                 28  PI-CCHECKNO-N     PIC X.
  2496                 28  PI-CCHECKNO-6     PIC X(6).
  2497             20  PI-CCHECKNO-RDF1 REDEFINES PI-CCHECKNO.
  2498                 24  PI-CCHECKNO-CR    PIC XX.
  2499                 24  PI-CCHECKNO-5     PIC X(5).
  2500             20  PI-CPYFROM      PIC XX.
  2501             20  PI-CPYTHRU      PIC XX.
  2502             20  PI-CDAYS        PIC S9(5).
  2503             20  PI-CPYAMT       PIC S9(7)V99.
  2504             20  PI-CRESV        PIC 9(6)V99.
  2505             20  PI-CEXPENS      PIC 9(6)V99.
  2506             20  PI-PMT-APPR-SW  PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  51
* EL156.cbl
  2507                 88 PI-PMT-APPROVED    VALUE 'G' 'Y'.
  2508                 88 PI-PMT-GRADUATED   VALUE 'G'.
  2509                 88 PI-PMT-NO-APPROVAL VALUE ' ' 'N'.
  2510         16  PI-PREV-CLMNO       PIC X(7).
  2511         16  PI-LF-COVERAGE-TYPE PIC X.
  2512         16  PI-MAX-PMT-TOL      PIC S9(7)V99  COMP-3.
  2513         16  PI-MAX-LF-PMT-TOL   PIC S9(7)V99  COMP-3.
  2514         16  PI-PROVISIONAL-IND  PIC X.
  2515             88 PI-PROV-PMT      VALUE 'P'.
  2516         16  PI-PREV-TRLR-KEY    PIC X(22).
  2517         16  PI-SPLIT-PMT-SW     PIC X.
  2518         16  PI-MAX-EXP-PMT      PIC S9(7)V99 COMP-3.
  2519         16  PI-ACTIVITY-CODE    PIC 99.
  2520         16  PI-RESET-SW         PIC X.
  2521         16  PI-SPECIAL-BEN-SW   PIC X.
  2522             88 PI-AIG-SPECIAL-BENEFIT VALUE 'Y'.
  2523         16  PI-REDUND-PMTAMT    PIC S9(7)V99.
  2524         16  PI-EXP-DT           PIC XX.
  2525         16  PI-LOAN-DUE-DAY     PIC 99.
  2526         16  PI-3RD-PARTY-SW     PIC X.
  2527         16  PI-LOAN-UPDATE-SW   PIC X.
  2528
  2529         16  PI-DMD-DATA.
  2530             20  PI-SV-CERT-KEY       PIC X(21).
  2531             20  PI-SV-CERT-NO        PIC X(11).
  2532             20  PI-SV-BEN            PIC X(10).
  2533             20  PI-SV-CCN            PIC X(16).
  2534             20  PI-INTEREST-PAID-IND PIC X.
  2535                 88  PI-INTEREST-PAID  VALUE 'Y'.
  2536             20  PI-MAX-BENEFIT-AMT   PIC S9(5)V99 COMP-3.
  2537             20  PI-MAX-BENEFIT-PYMT  PIC S9(5)V99 COMP-3.
  2538             20  PI-MIN-PAYMENT-AMT   PIC S9(5)V99 COMP-3.
  2539             20  PI-TIME-OF-LOSS-BAL  PIC S9(5)V99 COMP-3.
  2540         16  PI-AT-EOB-CODES.
  2541             20 PI-AT-EOB-CODE        PIC XXX   OCCURS 5.
  2542         16  PI-INT-AMT               PIC S9(5)V99 COMP-3.
  2543         16  PI-INT-DAYS              PIC S9(5) COMP-3.
  2544         16  PI-INT-RATE-USED         PIC S99V9(5) COMP-3.
  2545         16  PI-SAVE-ELAPSED-MONTHS   PIC 9(03).
  2546         16  PI-SAVE-ODD-DAYS-OVER    PIC S9(04).
  2547         16  PI-CHECK-STATE-FOR-AK    PIC X(02).
  2548         16  PI-ORIG-BEN-AMT          PIC S9(7)V99 COMP-3.
  2549         16  PI-REM-BEN-AMT           PIC S9(7)V99 COMP-3.
  2550         16  PI-MO-BEN-AMT            PIC S9(7)V99 COMP-3.
  2551         16  PI-LF-BENEFIT-CD         PIC X(2).
  2552         16  PI-EOB-CODES-EXIST PIC X.
  2553         16  PI-SET-NOTE2-MDT   PIC X.
  2554         16  PI-VFY-2ND-BENE          PIC X.
  2555         16  PI-CLM-TYPE              PIC X.
  2556         16  PI-APPROVAL-LEVEL        PIC X.
  2557         16  PI-REAUDIT-INTERVAL      PIC S9(5) COMP-3.
  2558         16  PI-REAUDIT-NEEDED        PIC X.
  2559         16  PI-DCC-PRODUCT-CODE      PIC XXX.
  2560         16  PI-AH-BENEFIT-CD         PIC XX.
  2561         16  pi-ah-term               pic s999 comp-3.
  2562         16  pi-ah-benefit-amt        pic s9(7)v99 comp-3.
  2563         16  pi-max-ext               pic 999.
  2564         16  pi-max-ext-used          pic x.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  52
* EL156.cbl
  2565         16  PI-APPROVAL-3550-NEEDED  PIC X.
  2566         16  PI-JOINT-COV-IND         PIC X.
  2567             88  PI-JOINT-COVERAGE       VALUE 'J'.
  2568             88  PI-SINGLE-COVERAGE      VALUE ' '.
  2569         16  PI-JOINT-INSURED-IND     PIC X.
  2570             88  PI-JOINT-INSURED        VALUE 'Y'.
  2571             88  PI-PRIMARY-INSURED      VALUE 'N'.
  2572*00781          16  FILLER                   PIC X(176).
  2573*052506         16  FILLER                   PIC X(161).
  2574*031808         16  FILLER                   PIC X(154).
  2575*091808         16  FILLER                   PIC X(152).
  2576*041710         16  FILLER                   PIC X(94).
  2577         16  FILLER                   PIC X(67).
  2578
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  53
* EL156.cbl
  2580*    COPY ELCJPFX.
  2581******************************************************************
  2582*                                                                *
  2583*                                                                *
  2584*                            ELCJPFX.                            *
  2585*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2586*                            VMOD=2.002                          *
  2587*                                                                *
  2588*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  2589*                                                                *
  2590*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  2591*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  2592*        ELCNTL - CONTROL FILE                                   *
  2593*        ELMSTR - CLAIM MASTERS                                  *
  2594*        ELTRLR - ACTIVITY TRAILERS                              *
  2595*        ELCHKQ - CHECK QUE                                      *
  2596******************************************************************
  2597 01  JOURNAL-RECORD.
  2598     12  jp-date                     pic s9(5) comp-3.
  2599     12  jp-time                     pic s9(7) comp-3.
  2600     12  JP-USER-ID                  PIC X(4).
  2601     12  JP-FILE-ID                  PIC X(8).
  2602     12  JP-PROGRAM-ID               PIC X(8).
  2603     12  JP-RECORD-TYPE              PIC X.
  2604         88 JP-ADD              VALUE 'A'.
  2605         88 JP-BEFORE-CHANGE    VALUE 'B'.
  2606         88 JP-AFTER-CHANGE     VALUE 'C'.
  2607         88 JP-DELETE           VALUE 'D'.
  2608         88 JP-GENERIC-DELETE   VALUE 'G'.
  2609         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  2610         88 JP-KEY-CHG-ADD      VALUE 'N'.
  2611     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  2612     12  JP-RECORD-AREA
  2613
  2614
  2615                             PIC X(750).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  54
* EL156.cbl
  2617*    COPY ELCAID.
  2618******************************************************************
  2619*                                                                *
  2620*                            ELCAID.                             *
  2621*                            VMOD=2.001                          *
  2622*                                                                *
  2623*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  2624*                                                                *
  2625*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  2626*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  2627******************************************************************
  2628
  2629 01  DFHAID.
  2630   02  DFHNULL   PIC  X  VALUE  ' '.
  2631   02  DFHENTER  PIC  X  VALUE  QUOTE.
  2632   02  DFHCLEAR  PIC  X  VALUE  '_'.
  2633   02  DFHPEN    PIC  X  VALUE  '='.
  2634   02  DFHOPID   PIC  X  VALUE  'W'.
  2635   02  DFHPA1    PIC  X  VALUE  '%'.
  2636   02  DFHPA2    PIC  X  VALUE  '>'.
  2637   02  DFHPA3    PIC  X  VALUE  ','.
  2638   02  DFHPF1    PIC  X  VALUE  '1'.
  2639   02  DFHPF2    PIC  X  VALUE  '2'.
  2640   02  DFHPF3    PIC  X  VALUE  '3'.
  2641   02  DFHPF4    PIC  X  VALUE  '4'.
  2642   02  DFHPF5    PIC  X  VALUE  '5'.
  2643   02  DFHPF6    PIC  X  VALUE  '6'.
  2644   02  DFHPF7    PIC  X  VALUE  '7'.
  2645   02  DFHPF8    PIC  X  VALUE  '8'.
  2646   02  DFHPF9    PIC  X  VALUE  '9'.
  2647   02  DFHPF10   PIC  X  VALUE  ':'.
  2648   02  DFHPF11   PIC  X  VALUE  '#'.
  2649   02  DFHPF12   PIC  X  VALUE  '@'.
  2650   02  DFHPF13   PIC  X  VALUE  'A'.
  2651   02  DFHPF14   PIC  X  VALUE  'B'.
  2652   02  DFHPF15   PIC  X  VALUE  'C'.
  2653   02  DFHPF16   PIC  X  VALUE  'D'.
  2654   02  DFHPF17   PIC  X  VALUE  'E'.
  2655   02  DFHPF18   PIC  X  VALUE  'F'.
  2656   02  DFHPF19   PIC  X  VALUE  'G'.
  2657   02  DFHPF20   PIC  X  VALUE  'H'.
  2658   02  DFHPF21   PIC  X  VALUE  'I'.
  2659*00039    02  DFHPF22   PIC  X  VALUE  ''.
  2660   02  DFHPF22   PIC  X  VALUE  '['.
  2661   02  DFHPF23   PIC  X  VALUE  '.'.
  2662   02  DFHPF24   PIC  X  VALUE  '<'.
  2663   02  DFHMSRE   PIC  X  VALUE  'X'.
  2664   02  DFHSTRF   PIC  X  VALUE  'h'.
  2665   02  DFHTRIG   PIC  X  VALUE  '"'.
  2666 01  FILLER    REDEFINES DFHAID.
  2667     12  FILLER              PIC X(8).
  2668     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  55
* EL156.cbl
  2670*    COPY EL156S.
  2671 01  EL156AI.
  2672     05  FILLER            PIC  X(0012).
  2673*    -------------------------------
  2674     05  RUNDTEAL PIC S9(0004) COMP.
  2675     05  RUNDTEAF PIC  X(0001).
  2676     05  FILLER REDEFINES RUNDTEAF.
  2677         10  RUNDTEAA PIC  X(0001).
  2678     05  RUNDTEAI PIC  X(0008).
  2679*    -------------------------------
  2680     05  RUNTIMAL PIC S9(0004) COMP.
  2681     05  RUNTIMAF PIC  X(0001).
  2682     05  FILLER REDEFINES RUNTIMAF.
  2683         10  RUNTIMAA PIC  X(0001).
  2684     05  RUNTIMAI PIC  X(0005).
  2685*    -------------------------------
  2686     05  SEQUL PIC S9(0004) COMP.
  2687     05  SEQUF PIC  X(0001).
  2688     05  FILLER REDEFINES SEQUF.
  2689         10  SEQUA PIC  X(0001).
  2690     05  SEQUI PIC  X(0010).
  2691*    -------------------------------
  2692     05  CLMNOL PIC S9(0004) COMP.
  2693     05  CLMNOF PIC  X(0001).
  2694     05  FILLER REDEFINES CLMNOF.
  2695         10  CLMNOA PIC  X(0001).
  2696     05  CLMNOI PIC  X(0007).
  2697*    -------------------------------
  2698     05  CARRL PIC S9(0004) COMP.
  2699     05  CARRF PIC  X(0001).
  2700     05  FILLER REDEFINES CARRF.
  2701         10  CARRA PIC  X(0001).
  2702     05  CARRI PIC  X(0001).
  2703*    -------------------------------
  2704     05  CERTNOL PIC S9(0004) COMP.
  2705     05  CERTNOF PIC  X(0001).
  2706     05  FILLER REDEFINES CERTNOF.
  2707         10  CERTNOA PIC  X(0001).
  2708     05  CERTNOI PIC  X(0010).
  2709*    -------------------------------
  2710     05  SUFXL PIC S9(0004) COMP.
  2711     05  SUFXF PIC  X(0001).
  2712     05  FILLER REDEFINES SUFXF.
  2713         10  SUFXA PIC  X(0001).
  2714     05  SUFXI PIC  X(0001).
  2715*    -------------------------------
  2716     05  CLMTYPL PIC S9(0004) COMP.
  2717     05  CLMTYPF PIC  X(0001).
  2718     05  FILLER REDEFINES CLMTYPF.
  2719         10  CLMTYPA PIC  X(0001).
  2720     05  CLMTYPI PIC  X(0006).
  2721*    -------------------------------
  2722     05  CLMSTATL PIC S9(0004) COMP.
  2723     05  CLMSTATF PIC  X(0001).
  2724     05  FILLER REDEFINES CLMSTATF.
  2725         10  CLMSTATA PIC  X(0001).
  2726     05  CLMSTATI PIC  X(0006).
  2727*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  56
* EL156.cbl
  2728     05  LSTNMEL PIC S9(0004) COMP.
  2729     05  LSTNMEF PIC  X(0001).
  2730     05  FILLER REDEFINES LSTNMEF.
  2731         10  LSTNMEA PIC  X(0001).
  2732     05  LSTNMEI PIC  X(0015).
  2733*    -------------------------------
  2734     05  FSTNMEL PIC S9(0004) COMP.
  2735     05  FSTNMEF PIC  X(0001).
  2736     05  FILLER REDEFINES FSTNMEF.
  2737         10  FSTNMEA PIC  X(0001).
  2738     05  FSTNMEI PIC  X(0012).
  2739*    -------------------------------
  2740     05  MINITL PIC S9(0004) COMP.
  2741     05  MINITF PIC  X(0001).
  2742     05  FILLER REDEFINES MINITF.
  2743         10  MINITA PIC  X(0001).
  2744     05  MINITI PIC  X(0001).
  2745*    -------------------------------
  2746     05  PRIMHDGL PIC S9(0004) COMP.
  2747     05  PRIMHDGF PIC  X(0001).
  2748     05  FILLER REDEFINES PRIMHDGF.
  2749         10  PRIMHDGA PIC  X(0001).
  2750     05  PRIMHDGI PIC  X(0012).
  2751*    -------------------------------
  2752     05  PCERTNOL PIC S9(0004) COMP.
  2753     05  PCERTNOF PIC  X(0001).
  2754     05  FILLER REDEFINES PCERTNOF.
  2755         10  PCERTNOA PIC  X(0001).
  2756     05  PCERTNOI PIC  X(0010).
  2757*    -------------------------------
  2758     05  PSUFXL PIC S9(0004) COMP.
  2759     05  PSUFXF PIC  X(0001).
  2760     05  FILLER REDEFINES PSUFXF.
  2761         10  PSUFXA PIC  X(0001).
  2762     05  PSUFXI PIC  X(0001).
  2763*    -------------------------------
  2764     05  STATUSL PIC S9(0004) COMP.
  2765     05  STATUSF PIC  X(0001).
  2766     05  FILLER REDEFINES STATUSF.
  2767         10  STATUSA PIC  X(0001).
  2768     05  STATUSI PIC  X(0010).
  2769*    -------------------------------
  2770     05  LOANHL PIC S9(0004) COMP.
  2771     05  LOANHF PIC  X(0001).
  2772     05  FILLER REDEFINES LOANHF.
  2773         10  LOANHA PIC  X(0001).
  2774     05  LOANHI PIC  X(0014).
  2775*    -------------------------------
  2776     05  LOANNOL PIC S9(0004) COMP.
  2777     05  LOANNOF PIC  X(0001).
  2778     05  FILLER REDEFINES LOANNOF.
  2779         10  LOANNOA PIC  X(0001).
  2780     05  LOANNOI PIC  X(0025).
  2781*    -------------------------------
  2782     05  DUEDAYHL PIC S9(0004) COMP.
  2783     05  DUEDAYHF PIC  X(0001).
  2784     05  FILLER REDEFINES DUEDAYHF.
  2785         10  DUEDAYHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  57
* EL156.cbl
  2786     05  DUEDAYHI PIC  X(0008).
  2787*    -------------------------------
  2788     05  DUEDAYL PIC S9(0004) COMP.
  2789     05  DUEDAYF PIC  X(0001).
  2790     05  FILLER REDEFINES DUEDAYF.
  2791         10  DUEDAYA PIC  X(0001).
  2792     05  DUEDAYI PIC  X(0002).
  2793*    -------------------------------
  2794     05  ZINTHL PIC S9(0004) COMP.
  2795     05  ZINTHF PIC  X(0001).
  2796     05  FILLER REDEFINES ZINTHF.
  2797         10  ZINTHA PIC  X(0001).
  2798     05  ZINTHI PIC  X(0009).
  2799*    -------------------------------
  2800     05  ZINTL PIC S9(0004) COMP.
  2801     05  ZINTF PIC  X(0001).
  2802     05  FILLER REDEFINES ZINTF.
  2803         10  ZINTA PIC  X(0001).
  2804     05  ZINTI PIC  99V99999.
  2805*    -------------------------------
  2806     05  PTHRHDGL PIC S9(0004) COMP.
  2807     05  PTHRHDGF PIC  X(0001).
  2808     05  FILLER REDEFINES PTHRHDGF.
  2809         10  PTHRHDGA PIC  X(0001).
  2810     05  PTHRHDGI PIC  X(0014).
  2811*    -------------------------------
  2812     05  PDTHRUL PIC S9(0004) COMP.
  2813     05  PDTHRUF PIC  X(0001).
  2814     05  FILLER REDEFINES PDTHRUF.
  2815         10  PDTHRUA PIC  X(0001).
  2816     05  PDTHRUI PIC  X(0008).
  2817*    -------------------------------
  2818     05  TOTPAIDL PIC S9(0004) COMP.
  2819     05  TOTPAIDF PIC  X(0001).
  2820     05  FILLER REDEFINES TOTPAIDF.
  2821         10  TOTPAIDA PIC  X(0001).
  2822     05  TOTPAIDI PIC  X(0010).
  2823*    -------------------------------
  2824     05  COVERL PIC S9(0004) COMP.
  2825     05  COVERF PIC  X(0001).
  2826     05  FILLER REDEFINES COVERF.
  2827         10  COVERA PIC  X(0001).
  2828     05  COVERI PIC  X(0010).
  2829*    -------------------------------
  2830     05  INCURL PIC S9(0004) COMP.
  2831     05  INCURF PIC  X(0001).
  2832     05  FILLER REDEFINES INCURF.
  2833         10  INCURA PIC  X(0001).
  2834     05  INCURI PIC  X(0008).
  2835*    -------------------------------
  2836     05  LSTDTEL PIC S9(0004) COMP.
  2837     05  LSTDTEF PIC  X(0001).
  2838     05  FILLER REDEFINES LSTDTEF.
  2839         10  LSTDTEA PIC  X(0001).
  2840     05  LSTDTEI PIC  X(0008).
  2841*    -------------------------------
  2842     05  CRTSTATL PIC S9(0004) COMP.
  2843     05  CRTSTATF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  58
* EL156.cbl
  2844     05  FILLER REDEFINES CRTSTATF.
  2845         10  CRTSTATA PIC  X(0001).
  2846     05  CRTSTATI PIC  X(0010).
  2847*    -------------------------------
  2848     05  EFFECTL PIC S9(0004) COMP.
  2849     05  EFFECTF PIC  X(0001).
  2850     05  FILLER REDEFINES EFFECTF.
  2851         10  EFFECTA PIC  X(0001).
  2852     05  EFFECTI PIC  X(0008).
  2853*    -------------------------------
  2854     05  TERMSL PIC S9(0004) COMP.
  2855     05  TERMSF PIC  X(0001).
  2856     05  FILLER REDEFINES TERMSF.
  2857         10  TERMSA PIC  X(0001).
  2858     05  TERMSI PIC  X(0011).
  2859*    -------------------------------
  2860     05  STACCTL PIC S9(0004) COMP.
  2861     05  STACCTF PIC  X(0001).
  2862     05  FILLER REDEFINES STACCTF.
  2863         10  STACCTA PIC  X(0001).
  2864     05  STACCTI PIC  X(0013).
  2865*    -------------------------------
  2866     05  EXPDTEHL PIC S9(0004) COMP.
  2867     05  EXPDTEHF PIC  X(0001).
  2868     05  FILLER REDEFINES EXPDTEHF.
  2869         10  EXPDTEHA PIC  X(0001).
  2870     05  EXPDTEHI PIC  X(0014).
  2871*    -------------------------------
  2872     05  EXPDTEL PIC S9(0004) COMP.
  2873     05  EXPDTEF PIC  X(0001).
  2874     05  FILLER REDEFINES EXPDTEF.
  2875         10  EXPDTEA PIC  X(0001).
  2876     05  EXPDTEI PIC  X(0008).
  2877*    -------------------------------
  2878     05  BENECAPL PIC S9(0004) COMP.
  2879     05  BENECAPF PIC  X(0001).
  2880     05  FILLER REDEFINES BENECAPF.
  2881         10  BENECAPA PIC  X(0001).
  2882     05  BENECAPI PIC  X(0013).
  2883*    -------------------------------
  2884     05  BENEL PIC S9(0004) COMP.
  2885     05  BENEF PIC  X(0001).
  2886     05  FILLER REDEFINES BENEF.
  2887         10  BENEA PIC  X(0001).
  2888     05  BENEI PIC  X(0009).
  2889*    -------------------------------
  2890     05  FORMTYPL PIC S9(0004) COMP.
  2891     05  FORMTYPF PIC  X(0001).
  2892     05  FILLER REDEFINES FORMTYPF.
  2893         10  FORMTYPA PIC  X(0001).
  2894     05  FORMTYPI PIC  X(0001).
  2895*    -------------------------------
  2896     05  PMTTYPEL PIC S9(0004) COMP.
  2897     05  PMTTYPEF PIC  X(0001).
  2898     05  FILLER REDEFINES PMTTYPEF.
  2899         10  PMTTYPEA PIC  X(0001).
  2900     05  PMTTYPEI PIC  X(0001).
  2901*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  59
* EL156.cbl
  2902     05  PAYEEL PIC S9(0004) COMP.
  2903     05  PAYEEF PIC  X(0001).
  2904     05  FILLER REDEFINES PAYEEF.
  2905         10  PAYEEA PIC  X(0001).
  2906     05  PAYEEI PIC  X(0002).
  2907*    -------------------------------
  2908     05  CHECKNOL PIC S9(0004) COMP.
  2909     05  CHECKNOF PIC  X(0001).
  2910     05  FILLER REDEFINES CHECKNOF.
  2911         10  CHECKNOA PIC  X(0001).
  2912     05  CHECKNOI PIC  X(0007).
  2913*    -------------------------------
  2914     05  OFFLINEL PIC S9(0004) COMP.
  2915     05  OFFLINEF PIC  X(0001).
  2916     05  FILLER REDEFINES OFFLINEF.
  2917         10  OFFLINEA PIC  X(0001).
  2918     05  OFFLINEI PIC  X(0001).
  2919*    -------------------------------
  2920     05  HOLDTILL PIC S9(0004) COMP.
  2921     05  HOLDTILF PIC  X(0001).
  2922     05  FILLER REDEFINES HOLDTILF.
  2923         10  HOLDTILA PIC  X(0001).
  2924     05  HOLDTILI PIC  X(0008).
  2925*    -------------------------------
  2926     05  NOTE1L PIC S9(0004) COMP.
  2927     05  NOTE1F PIC  X(0001).
  2928     05  FILLER REDEFINES NOTE1F.
  2929         10  NOTE1A PIC  X(0001).
  2930     05  NOTE1I PIC  X(0060).
  2931*    -------------------------------
  2932     05  NOTE2L PIC S9(0004) COMP.
  2933     05  NOTE2F PIC  X(0001).
  2934     05  FILLER REDEFINES NOTE2F.
  2935         10  NOTE2A PIC  X(0001).
  2936     05  NOTE2I PIC  X(0060).
  2937*    -------------------------------
  2938     05  EOBYNL PIC S9(0004) COMP.
  2939     05  EOBYNF PIC  X(0001).
  2940     05  FILLER REDEFINES EOBYNF.
  2941         10  EOBYNA PIC  X(0001).
  2942     05  EOBYNI PIC  X(0001).
  2943*    -------------------------------
  2944     05  CLMFMYNL PIC S9(0004) COMP.
  2945     05  CLMFMYNF PIC  X(0001).
  2946     05  FILLER REDEFINES CLMFMYNF.
  2947         10  CLMFMYNA PIC  X(0001).
  2948     05  CLMFMYNI PIC  X(0001).
  2949*    -------------------------------
  2950     05  SURVYYNL PIC S9(0004) COMP.
  2951     05  SURVYYNF PIC  X(0001).
  2952     05  FILLER REDEFINES SURVYYNF.
  2953         10  SURVYYNA PIC  X(0001).
  2954     05  SURVYYNI PIC  X(0001).
  2955*    -------------------------------
  2956     05  SPRELYNL PIC S9(0004) COMP.
  2957     05  SPRELYNF PIC  X(0001).
  2958     05  FILLER REDEFINES SPRELYNF.
  2959         10  SPRELYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  60
* EL156.cbl
  2960     05  SPRELYNI PIC  X(0001).
  2961*    -------------------------------
  2962     05  PINTHL PIC S9(0004) COMP.
  2963     05  PINTHF PIC  X(0001).
  2964     05  FILLER REDEFINES PINTHF.
  2965         10  PINTHA PIC  X(0001).
  2966     05  PINTHI PIC  X(0004).
  2967*    -------------------------------
  2968     05  PINTL PIC S9(0004) COMP.
  2969     05  PINTF PIC  X(0001).
  2970     05  FILLER REDEFINES PINTF.
  2971         10  PINTA PIC  X(0001).
  2972     05  PINTI PIC  X(0008).
  2973*    -------------------------------
  2974     05  PROOFDTL PIC S9(0004) COMP.
  2975     05  PROOFDTF PIC  X(0001).
  2976     05  FILLER REDEFINES PROOFDTF.
  2977         10  PROOFDTA PIC  X(0001).
  2978     05  PROOFDTI PIC  X(0008).
  2979*    -------------------------------
  2980     05  AIGFRMHL PIC S9(0004) COMP.
  2981     05  AIGFRMHF PIC  X(0001).
  2982     05  FILLER REDEFINES AIGFRMHF.
  2983         10  AIGFRMHA PIC  X(0001).
  2984     05  AIGFRMHI PIC  X(0012).
  2985*    -------------------------------
  2986     05  AIGFROML PIC S9(0004) COMP.
  2987     05  AIGFROMF PIC  X(0001).
  2988     05  FILLER REDEFINES AIGFROMF.
  2989         10  AIGFROMA PIC  X(0001).
  2990     05  AIGFROMI PIC  X(0008).
  2991*    -------------------------------
  2992     05  PMTHDGAL PIC S9(0004) COMP.
  2993     05  PMTHDGAF PIC  X(0001).
  2994     05  FILLER REDEFINES PMTHDGAF.
  2995         10  PMTHDGAA PIC  X(0001).
  2996     05  PMTHDGAI PIC  X(0066).
  2997*    -------------------------------
  2998     05  EPYFROML PIC S9(0004) COMP.
  2999     05  EPYFROMF PIC  X(0001).
  3000     05  FILLER REDEFINES EPYFROMF.
  3001         10  EPYFROMA PIC  X(0001).
  3002     05  EPYFROMI PIC  X(0008).
  3003*    -------------------------------
  3004     05  EPYTHRUL PIC S9(0004) COMP.
  3005     05  EPYTHRUF PIC  X(0001).
  3006     05  FILLER REDEFINES EPYTHRUF.
  3007         10  EPYTHRUA PIC  X(0001).
  3008     05  EPYTHRUI PIC  X(0008).
  3009*    -------------------------------
  3010     05  EDAYSL PIC S9(0004) COMP.
  3011     05  EDAYSF PIC  X(0001).
  3012     05  FILLER REDEFINES EDAYSF.
  3013         10  EDAYSA PIC  X(0001).
  3014     05  EDAYSI PIC  S9(6).
  3015*    -------------------------------
  3016     05  EPYAMTL PIC S9(0004) COMP.
  3017     05  EPYAMTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  61
* EL156.cbl
  3018     05  FILLER REDEFINES EPYAMTF.
  3019         10  EPYAMTA PIC  X(0001).
  3020     05  EPYAMTI PIC  S9(8)V99.
  3021*    -------------------------------
  3022     05  ERESVL PIC S9(0004) COMP.
  3023     05  ERESVF PIC  X(0001).
  3024     05  FILLER REDEFINES ERESVF.
  3025         10  ERESVA PIC  X(0001).
  3026     05  ERESVI PIC  S9(7)V99.
  3027*    -------------------------------
  3028     05  ETYPEL PIC S9(0004) COMP.
  3029     05  ETYPEF PIC  X(0001).
  3030     05  FILLER REDEFINES ETYPEF.
  3031         10  ETYPEA PIC  X(0001).
  3032     05  ETYPEI PIC  X(0001).
  3033*    -------------------------------
  3034     05  EEXPENSL PIC S9(0004) COMP.
  3035     05  EEXPENSF PIC  X(0001).
  3036     05  FILLER REDEFINES EEXPENSF.
  3037         10  EEXPENSA PIC  X(0001).
  3038     05  EEXPENSI PIC  9(6)V99.
  3039*    -------------------------------
  3040     05  CPYFROML PIC S9(0004) COMP.
  3041     05  CPYFROMF PIC  X(0001).
  3042     05  FILLER REDEFINES CPYFROMF.
  3043         10  CPYFROMA PIC  X(0001).
  3044     05  CPYFROMI PIC  X(0008).
  3045*    -------------------------------
  3046     05  CPYTHRUL PIC S9(0004) COMP.
  3047     05  CPYTHRUF PIC  X(0001).
  3048     05  FILLER REDEFINES CPYTHRUF.
  3049         10  CPYTHRUA PIC  X(0001).
  3050     05  CPYTHRUI PIC  X(0008).
  3051*    -------------------------------
  3052     05  CDAYSL PIC S9(0004) COMP.
  3053     05  CDAYSF PIC  X(0001).
  3054     05  FILLER REDEFINES CDAYSF.
  3055         10  CDAYSA PIC  X(0001).
  3056     05  CDAYSI PIC  9(6).
  3057*    -------------------------------
  3058     05  CPYAMTL PIC S9(0004) COMP.
  3059     05  CPYAMTF PIC  X(0001).
  3060     05  FILLER REDEFINES CPYAMTF.
  3061         10  CPYAMTA PIC  X(0001).
  3062     05  CPYAMTI PIC  S9(8)V99.
  3063*    -------------------------------
  3064     05  CRESVL PIC S9(0004) COMP.
  3065     05  CRESVF PIC  X(0001).
  3066     05  FILLER REDEFINES CRESVF.
  3067         10  CRESVA PIC  X(0001).
  3068     05  CRESVI PIC  9(6)V99.
  3069*    -------------------------------
  3070     05  CEXPENSL PIC S9(0004) COMP.
  3071     05  CEXPENSF PIC  X(0001).
  3072     05  FILLER REDEFINES CEXPENSF.
  3073         10  CEXPENSA PIC  X(0001).
  3074     05  CEXPENSI PIC  9(6)V99.
  3075*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  62
* EL156.cbl
  3076     05  ERRMSG0L PIC S9(0004) COMP.
  3077     05  ERRMSG0F PIC  X(0001).
  3078     05  FILLER REDEFINES ERRMSG0F.
  3079         10  ERRMSG0A PIC  X(0001).
  3080     05  ERRMSG0I PIC  X(0072).
  3081*    -------------------------------
  3082     05  ERRMSG1L PIC S9(0004) COMP.
  3083     05  ERRMSG1F PIC  X(0001).
  3084     05  FILLER REDEFINES ERRMSG1F.
  3085         10  ERRMSG1A PIC  X(0001).
  3086     05  ERRMSG1I PIC  X(0072).
  3087*    -------------------------------
  3088     05  ERRMSG2L PIC S9(0004) COMP.
  3089     05  ERRMSG2F PIC  X(0001).
  3090     05  FILLER REDEFINES ERRMSG2F.
  3091         10  ERRMSG2A PIC  X(0001).
  3092     05  ERRMSG2I PIC  X(0072).
  3093*    -------------------------------
  3094     05  ENTERPFL PIC S9(0004) COMP.
  3095     05  ENTERPFF PIC  X(0001).
  3096     05  FILLER REDEFINES ENTERPFF.
  3097         10  ENTERPFA PIC  X(0001).
  3098     05  ENTERPFI PIC  99.
  3099*    -------------------------------
  3100     05  PF6TITL PIC S9(0004) COMP.
  3101     05  PF6TITF PIC  X(0001).
  3102     05  FILLER REDEFINES PF6TITF.
  3103         10  PF6TITA PIC  X(0001).
  3104     05  PF6TITI PIC  X(0016).
  3105 01  EL156AO REDEFINES EL156AI.
  3106     05  FILLER            PIC  X(0012).
  3107*    -------------------------------
  3108     05  FILLER            PIC  X(0003).
  3109     05  RUNDTEAO PIC  X(0008).
  3110*    -------------------------------
  3111     05  FILLER            PIC  X(0003).
  3112     05  RUNTIMAO PIC  99.99.
  3113*    -------------------------------
  3114     05  FILLER            PIC  X(0003).
  3115     05  SEQUO PIC  X(0010).
  3116*    -------------------------------
  3117     05  FILLER            PIC  X(0003).
  3118     05  CLMNOO PIC  X(0007).
  3119*    -------------------------------
  3120     05  FILLER            PIC  X(0003).
  3121     05  CARRO PIC  X(0001).
  3122*    -------------------------------
  3123     05  FILLER            PIC  X(0003).
  3124     05  CERTNOO PIC  X(0010).
  3125*    -------------------------------
  3126     05  FILLER            PIC  X(0003).
  3127     05  SUFXO PIC  X(0001).
  3128*    -------------------------------
  3129     05  FILLER            PIC  X(0003).
  3130     05  CLMTYPO PIC  X(0006).
  3131*    -------------------------------
  3132     05  FILLER            PIC  X(0003).
  3133     05  CLMSTATO PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  63
* EL156.cbl
  3134*    -------------------------------
  3135     05  FILLER            PIC  X(0003).
  3136     05  LSTNMEO PIC  X(0015).
  3137*    -------------------------------
  3138     05  FILLER            PIC  X(0003).
  3139     05  FSTNMEO PIC  X(0012).
  3140*    -------------------------------
  3141     05  FILLER            PIC  X(0003).
  3142     05  MINITO PIC  X(0001).
  3143*    -------------------------------
  3144     05  FILLER            PIC  X(0003).
  3145     05  PRIMHDGO PIC  X(0012).
  3146*    -------------------------------
  3147     05  FILLER            PIC  X(0003).
  3148     05  PCERTNOO PIC  X(0010).
  3149*    -------------------------------
  3150     05  FILLER            PIC  X(0003).
  3151     05  PSUFXO PIC  X(0001).
  3152*    -------------------------------
  3153     05  FILLER            PIC  X(0003).
  3154     05  STATUSO PIC  X(0010).
  3155*    -------------------------------
  3156     05  FILLER            PIC  X(0003).
  3157     05  LOANHO PIC  X(0014).
  3158*    -------------------------------
  3159     05  FILLER            PIC  X(0003).
  3160     05  LOANNOO PIC  X(0025).
  3161*    -------------------------------
  3162     05  FILLER            PIC  X(0003).
  3163     05  DUEDAYHO PIC  X(0008).
  3164*    -------------------------------
  3165     05  FILLER            PIC  X(0003).
  3166     05  DUEDAYO PIC  X(0002).
  3167*    -------------------------------
  3168     05  FILLER            PIC  X(0003).
  3169     05  ZINTHO PIC  X(0009).
  3170*    -------------------------------
  3171     05  FILLER            PIC  X(0003).
  3172     05  ZINTO PIC  9.99999.
  3173*    -------------------------------
  3174     05  FILLER            PIC  X(0003).
  3175     05  PTHRHDGO PIC  X(0014).
  3176*    -------------------------------
  3177     05  FILLER            PIC  X(0003).
  3178     05  PDTHRUO PIC  X(0008).
  3179*    -------------------------------
  3180     05  FILLER            PIC  X(0003).
  3181     05  TOTPAIDO PIC  Z(6).99-.
  3182*    -------------------------------
  3183     05  FILLER            PIC  X(0003).
  3184     05  COVERO PIC  X(0010).
  3185*    -------------------------------
  3186     05  FILLER            PIC  X(0003).
  3187     05  INCURO PIC  X(0008).
  3188*    -------------------------------
  3189     05  FILLER            PIC  X(0003).
  3190     05  LSTDTEO PIC  X(0008).
  3191*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  64
* EL156.cbl
  3192     05  FILLER            PIC  X(0003).
  3193     05  CRTSTATO PIC  X(0010).
  3194*    -------------------------------
  3195     05  FILLER            PIC  X(0003).
  3196     05  EFFECTO PIC  X(0008).
  3197*    -------------------------------
  3198     05  FILLER            PIC  X(0003).
  3199     05  TERMSO PIC  X(0011).
  3200*    -------------------------------
  3201     05  FILLER            PIC  X(0003).
  3202     05  STACCTO PIC  X(0013).
  3203*    -------------------------------
  3204     05  FILLER            PIC  X(0003).
  3205     05  EXPDTEHO PIC  X(0014).
  3206*    -------------------------------
  3207     05  FILLER            PIC  X(0003).
  3208     05  EXPDTEO PIC  X(0008).
  3209*    -------------------------------
  3210     05  FILLER            PIC  X(0003).
  3211     05  BENECAPO PIC  X(0013).
  3212*    -------------------------------
  3213     05  FILLER            PIC  X(0003).
  3214     05  BENEO PIC  Z(6).99.
  3215*    -------------------------------
  3216     05  FILLER            PIC  X(0003).
  3217     05  FORMTYPO PIC  X(0001).
  3218*    -------------------------------
  3219     05  FILLER            PIC  X(0003).
  3220     05  PMTTYPEO PIC  X(0001).
  3221*    -------------------------------
  3222     05  FILLER            PIC  X(0003).
  3223     05  PAYEEO PIC  X(0002).
  3224*    -------------------------------
  3225     05  FILLER            PIC  X(0003).
  3226     05  CHECKNOO PIC  X(0007).
  3227*    -------------------------------
  3228     05  FILLER            PIC  X(0003).
  3229     05  OFFLINEO PIC  X(0001).
  3230*    -------------------------------
  3231     05  FILLER            PIC  X(0003).
  3232     05  HOLDTILO PIC  99B99B99.
  3233*    -------------------------------
  3234     05  FILLER            PIC  X(0003).
  3235     05  NOTE1O PIC  X(0060).
  3236*    -------------------------------
  3237     05  FILLER            PIC  X(0003).
  3238     05  NOTE2O PIC  X(0060).
  3239*    -------------------------------
  3240     05  FILLER            PIC  X(0003).
  3241     05  EOBYNO PIC  X(0001).
  3242*    -------------------------------
  3243     05  FILLER            PIC  X(0003).
  3244     05  CLMFMYNO PIC  X(0001).
  3245*    -------------------------------
  3246     05  FILLER            PIC  X(0003).
  3247     05  SURVYYNO PIC  X(0001).
  3248*    -------------------------------
  3249     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  65
* EL156.cbl
  3250     05  SPRELYNO PIC  X(0001).
  3251*    -------------------------------
  3252     05  FILLER            PIC  X(0003).
  3253     05  PINTHO PIC  X(0004).
  3254*    -------------------------------
  3255     05  FILLER            PIC  X(0003).
  3256     05  PINTO PIC  Z,ZZ9.99.
  3257*    -------------------------------
  3258     05  FILLER            PIC  X(0003).
  3259     05  PROOFDTO PIC  99B99B99.
  3260*    -------------------------------
  3261     05  FILLER            PIC  X(0003).
  3262     05  AIGFRMHO PIC  X(0012).
  3263*    -------------------------------
  3264     05  FILLER            PIC  X(0003).
  3265     05  AIGFROMO PIC  99B99B99.
  3266*    -------------------------------
  3267     05  FILLER            PIC  X(0003).
  3268     05  PMTHDGAO PIC  X(0066).
  3269*    -------------------------------
  3270     05  FILLER            PIC  X(0003).
  3271     05  EPYFROMO PIC  99B99B99.
  3272*    -------------------------------
  3273     05  FILLER            PIC  X(0003).
  3274     05  EPYTHRUO PIC  99B99B99.
  3275*    -------------------------------
  3276     05  FILLER            PIC  X(0003).
  3277     05  EDAYSO PIC  Z(4)9-.
  3278*    -------------------------------
  3279     05  FILLER            PIC  X(0003).
  3280     05  EPYAMTO PIC  Z(6).99-.
  3281*    -------------------------------
  3282     05  FILLER            PIC  X(0003).
  3283     05  ERESVO PIC  Z(5).99-.
  3284*    -------------------------------
  3285     05  FILLER            PIC  X(0003).
  3286     05  ETYPEO PIC  X(0001).
  3287*    -------------------------------
  3288     05  FILLER            PIC  X(0003).
  3289     05  EEXPENSO PIC  Z(5).99.
  3290*    -------------------------------
  3291     05  FILLER            PIC  X(0003).
  3292     05  CPYFROMO PIC  99B99B99.
  3293*    -------------------------------
  3294     05  FILLER            PIC  X(0003).
  3295     05  CPYTHRUO PIC  99B99B99.
  3296*    -------------------------------
  3297     05  FILLER            PIC  X(0003).
  3298     05  CDAYSO PIC  Z(4)9-.
  3299*    -------------------------------
  3300     05  FILLER            PIC  X(0003).
  3301     05  CPYAMTO PIC  Z(6).99-.
  3302*    -------------------------------
  3303     05  FILLER            PIC  X(0003).
  3304     05  CRESVO PIC  Z(5).99.
  3305*    -------------------------------
  3306     05  FILLER            PIC  X(0003).
  3307     05  CEXPENSO PIC  Z(5).99.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  66
* EL156.cbl
  3308*    -------------------------------
  3309     05  FILLER            PIC  X(0003).
  3310     05  ERRMSG0O PIC  X(0072).
  3311*    -------------------------------
  3312     05  FILLER            PIC  X(0003).
  3313     05  ERRMSG1O PIC  X(0072).
  3314*    -------------------------------
  3315     05  FILLER            PIC  X(0003).
  3316     05  ERRMSG2O PIC  X(0072).
  3317*    -------------------------------
  3318     05  FILLER            PIC  X(0003).
  3319     05  ENTERPFO PIC  X(0002).
  3320*    -------------------------------
  3321     05  FILLER            PIC  X(0003).
  3322     05  PF6TITO PIC  X(0016).
  3323*    -------------------------------
  3324 01  EL156BI REDEFINES EL156AI.
  3325     05  FILLER            PIC  X(0012).
  3326*    -------------------------------
  3327     05  RUNDTEBL PIC S9(0004) COMP.
  3328     05  RUNDTEBF PIC  X(0001).
  3329     05  FILLER REDEFINES RUNDTEBF.
  3330         10  RUNDTEBA PIC  X(0001).
  3331     05  RUNDTEBI PIC  X(0008).
  3332*    -------------------------------
  3333     05  RUNTIMBL PIC S9(0004) COMP.
  3334     05  RUNTIMBF PIC  X(0001).
  3335     05  FILLER REDEFINES RUNTIMBF.
  3336         10  RUNTIMBA PIC  X(0001).
  3337     05  RUNTIMBI PIC  X(0005).
  3338*    -------------------------------
  3339     05  PAYDTBL PIC S9(0004) COMP.
  3340     05  PAYDTBF PIC  X(0001).
  3341     05  FILLER REDEFINES PAYDTBF.
  3342         10  PAYDTBA PIC  X(0001).
  3343     05  PAYDTBI PIC  X(0008).
  3344*    -------------------------------
  3345     05  PAYTYPBL PIC S9(0004) COMP.
  3346     05  PAYTYPBF PIC  X(0001).
  3347     05  FILLER REDEFINES PAYTYPBF.
  3348         10  PAYTYPBA PIC  X(0001).
  3349     05  PAYTYPBI PIC  X(0015).
  3350*    -------------------------------
  3351     05  PAYAMTBL PIC S9(0004) COMP.
  3352     05  PAYAMTBF PIC  X(0001).
  3353     05  FILLER REDEFINES PAYAMTBF.
  3354         10  PAYAMTBA PIC  X(0001).
  3355     05  PAYAMTBI PIC  X(0011).
  3356*    -------------------------------
  3357     05  LOANHBL PIC S9(0004) COMP.
  3358     05  LOANHBF PIC  X(0001).
  3359     05  FILLER REDEFINES LOANHBF.
  3360         10  LOANHBA PIC  X(0001).
  3361     05  LOANHBI PIC  X(0012).
  3362*    -------------------------------
  3363     05  LOANNBL PIC S9(0004) COMP.
  3364     05  LOANNBF PIC  X(0001).
  3365     05  FILLER REDEFINES LOANNBF.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  67
* EL156.cbl
  3366         10  LOANNBA PIC  X(0001).
  3367     05  LOANNBI PIC  X(0025).
  3368*    -------------------------------
  3369     05  CKNUMHDL PIC S9(0004) COMP.
  3370     05  CKNUMHDF PIC  X(0001).
  3371     05  FILLER REDEFINES CKNUMHDF.
  3372         10  CKNUMHDA PIC  X(0001).
  3373     05  CKNUMHDI PIC  X(0012).
  3374*    -------------------------------
  3375     05  CKNUMBL PIC S9(0004) COMP.
  3376     05  CKNUMBF PIC  X(0001).
  3377     05  FILLER REDEFINES CKNUMBF.
  3378         10  CKNUMBA PIC  X(0001).
  3379     05  CKNUMBI PIC  X(0007).
  3380*    -------------------------------
  3381     05  AGTHDGL PIC S9(0004) COMP.
  3382     05  AGTHDGF PIC  X(0001).
  3383     05  FILLER REDEFINES AGTHDGF.
  3384         10  AGTHDGA PIC  X(0001).
  3385     05  AGTHDGI PIC  X(0016).
  3386*    -------------------------------
  3387     05  NAMEBL PIC S9(0004) COMP.
  3388     05  NAMEBF PIC  X(0001).
  3389     05  FILLER REDEFINES NAMEBF.
  3390         10  NAMEBA PIC  X(0001).
  3391     05  NAMEBI PIC  X(0030).
  3392*    -------------------------------
  3393     05  NAMEB2L PIC S9(0004) COMP.
  3394     05  NAMEB2F PIC  X(0001).
  3395     05  FILLER REDEFINES NAMEB2F.
  3396         10  NAMEB2A PIC  X(0001).
  3397     05  NAMEB2I PIC  X(0030).
  3398*    -------------------------------
  3399     05  ADDR1BL PIC S9(0004) COMP.
  3400     05  ADDR1BF PIC  X(0001).
  3401     05  FILLER REDEFINES ADDR1BF.
  3402         10  ADDR1BA PIC  X(0001).
  3403     05  ADDR1BI PIC  X(0030).
  3404*    -------------------------------
  3405     05  ADDR1B2L PIC S9(0004) COMP.
  3406     05  ADDR1B2F PIC  X(0001).
  3407     05  FILLER REDEFINES ADDR1B2F.
  3408         10  ADDR1B2A PIC  X(0001).
  3409     05  ADDR1B2I PIC  X(0030).
  3410*    -------------------------------
  3411     05  ADDR2BL PIC S9(0004) COMP.
  3412     05  ADDR2BF PIC  X(0001).
  3413     05  FILLER REDEFINES ADDR2BF.
  3414         10  ADDR2BA PIC  X(0001).
  3415     05  ADDR2BI PIC  X(0030).
  3416*    -------------------------------
  3417     05  ADDR2B2L PIC S9(0004) COMP.
  3418     05  ADDR2B2F PIC  X(0001).
  3419     05  FILLER REDEFINES ADDR2B2F.
  3420         10  ADDR2B2A PIC  X(0001).
  3421     05  ADDR2B2I PIC  X(0030).
  3422*    -------------------------------
  3423     05  CITYSTBL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  68
* EL156.cbl
  3424     05  CITYSTBF PIC  X(0001).
  3425     05  FILLER REDEFINES CITYSTBF.
  3426         10  CITYSTBA PIC  X(0001).
  3427     05  CITYSTBI PIC  X(0030).
  3428*    -------------------------------
  3429     05  CITYST2L PIC S9(0004) COMP.
  3430     05  CITYST2F PIC  X(0001).
  3431     05  FILLER REDEFINES CITYST2F.
  3432         10  CITYST2A PIC  X(0001).
  3433     05  CITYST2I PIC  X(0030).
  3434*    -------------------------------
  3435     05  ZIPBL PIC S9(0004) COMP.
  3436     05  ZIPBF PIC  X(0001).
  3437     05  FILLER REDEFINES ZIPBF.
  3438         10  ZIPBA PIC  X(0001).
  3439     05  ZIPBI PIC  X(0009).
  3440*    -------------------------------
  3441     05  ZIPB2L PIC S9(0004) COMP.
  3442     05  ZIPB2F PIC  X(0001).
  3443     05  FILLER REDEFINES ZIPB2F.
  3444         10  ZIPB2A PIC  X(0001).
  3445     05  ZIPB2I PIC  X(0009).
  3446*    -------------------------------
  3447     05  INTHDBL PIC S9(0004) COMP.
  3448     05  INTHDBF PIC  X(0001).
  3449     05  FILLER REDEFINES INTHDBF.
  3450         10  INTHDBA PIC  X(0001).
  3451     05  INTHDBI PIC  X(0012).
  3452*    -------------------------------
  3453     05  INTAMTBL PIC S9(0004) COMP.
  3454     05  INTAMTBF PIC  X(0001).
  3455     05  FILLER REDEFINES INTAMTBF.
  3456         10  INTAMTBA PIC  X(0001).
  3457     05  INTAMTBI PIC  X(0011).
  3458*    -------------------------------
  3459     05  PMTHDGBL PIC S9(0004) COMP.
  3460     05  PMTHDGBF PIC  X(0001).
  3461     05  FILLER REDEFINES PMTHDGBF.
  3462         10  PMTHDGBA PIC  X(0001).
  3463     05  PMTHDGBI PIC  X(0034).
  3464*    -------------------------------
  3465     05  CLMNOBL PIC S9(0004) COMP.
  3466     05  CLMNOBF PIC  X(0001).
  3467     05  FILLER REDEFINES CLMNOBF.
  3468         10  CLMNOBA PIC  X(0001).
  3469     05  CLMNOBI PIC  X(0007).
  3470*    -------------------------------
  3471     05  CARRBL PIC S9(0004) COMP.
  3472     05  CARRBF PIC  X(0001).
  3473     05  FILLER REDEFINES CARRBF.
  3474         10  CARRBA PIC  X(0001).
  3475     05  CARRBI PIC  X(0001).
  3476*    -------------------------------
  3477     05  CERTNOBL PIC S9(0004) COMP.
  3478     05  CERTNOBF PIC  X(0001).
  3479     05  FILLER REDEFINES CERTNOBF.
  3480         10  CERTNOBA PIC  X(0001).
  3481     05  CERTNOBI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  69
* EL156.cbl
  3482*    -------------------------------
  3483     05  SUFXBL PIC S9(0004) COMP.
  3484     05  SUFXBF PIC  X(0001).
  3485     05  FILLER REDEFINES SUFXBF.
  3486         10  SUFXBA PIC  X(0001).
  3487     05  SUFXBI PIC  X(0001).
  3488*    -------------------------------
  3489     05  CLMTYPBL PIC S9(0004) COMP.
  3490     05  CLMTYPBF PIC  X(0001).
  3491     05  FILLER REDEFINES CLMTYPBF.
  3492         10  CLMTYPBA PIC  X(0001).
  3493     05  CLMTYPBI PIC  X(0006).
  3494*    -------------------------------
  3495     05  INCURBL PIC S9(0004) COMP.
  3496     05  INCURBF PIC  X(0001).
  3497     05  FILLER REDEFINES INCURBF.
  3498         10  INCURBA PIC  X(0001).
  3499     05  INCURBI PIC  X(0008).
  3500*    -------------------------------
  3501     05  PYFROMBL PIC S9(0004) COMP.
  3502     05  PYFROMBF PIC  X(0001).
  3503     05  FILLER REDEFINES PYFROMBF.
  3504         10  PYFROMBA PIC  X(0001).
  3505     05  PYFROMBI PIC  X(0008).
  3506*    -------------------------------
  3507     05  PYTHRUBL PIC S9(0004) COMP.
  3508     05  PYTHRUBF PIC  X(0001).
  3509     05  FILLER REDEFINES PYTHRUBF.
  3510         10  PYTHRUBA PIC  X(0001).
  3511     05  PYTHRUBI PIC  X(0008).
  3512*    -------------------------------
  3513     05  DAYSBL PIC S9(0004) COMP.
  3514     05  DAYSBF PIC  X(0001).
  3515     05  FILLER REDEFINES DAYSBF.
  3516         10  DAYSBA PIC  X(0001).
  3517     05  DAYSBI PIC  X(0005).
  3518*    -------------------------------
  3519     05  BYBL PIC S9(0004) COMP.
  3520     05  BYBF PIC  X(0001).
  3521     05  FILLER REDEFINES BYBF.
  3522         10  BYBA PIC  X(0001).
  3523     05  BYBI PIC  X(0004).
  3524*    -------------------------------
  3525     05  PROOFDBL PIC S9(0004) COMP.
  3526     05  PROOFDBF PIC  X(0001).
  3527     05  FILLER REDEFINES PROOFDBF.
  3528         10  PROOFDBA PIC  X(0001).
  3529     05  PROOFDBI PIC  X(0008).
  3530*    -------------------------------
  3531     05  ACCTBL PIC S9(0004) COMP.
  3532     05  ACCTBF PIC  X(0001).
  3533     05  FILLER REDEFINES ACCTBF.
  3534         10  ACCTBA PIC  X(0001).
  3535     05  ACCTBI PIC  X(0010).
  3536*    -------------------------------
  3537     05  STATEBL PIC S9(0004) COMP.
  3538     05  STATEBF PIC  X(0001).
  3539     05  FILLER REDEFINES STATEBF.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  70
* EL156.cbl
  3540         10  STATEBA PIC  X(0001).
  3541     05  STATEBI PIC  X(0002).
  3542*    -------------------------------
  3543     05  GROUPBL PIC S9(0004) COMP.
  3544     05  GROUPBF PIC  X(0001).
  3545     05  FILLER REDEFINES GROUPBF.
  3546         10  GROUPBA PIC  X(0001).
  3547     05  GROUPBI PIC  X(0006).
  3548*    -------------------------------
  3549     05  ACARRBL PIC S9(0004) COMP.
  3550     05  ACARRBF PIC  X(0001).
  3551     05  FILLER REDEFINES ACARRBF.
  3552         10  ACARRBA PIC  X(0001).
  3553     05  ACARRBI PIC  X(0001).
  3554*    -------------------------------
  3555     05  ACCTNMBL PIC S9(0004) COMP.
  3556     05  ACCTNMBF PIC  X(0001).
  3557     05  FILLER REDEFINES ACCTNMBF.
  3558         10  ACCTNMBA PIC  X(0001).
  3559     05  ACCTNMBI PIC  X(0030).
  3560*    -------------------------------
  3561     05  UNDISBL PIC S9(0004) COMP.
  3562     05  UNDISBF PIC  X(0001).
  3563     05  FILLER REDEFINES UNDISBF.
  3564         10  UNDISBA PIC  X(0001).
  3565     05  UNDISBI PIC  X(0010).
  3566*    -------------------------------
  3567     05  RATEBL PIC S9(0004) COMP.
  3568     05  RATEBF PIC  X(0001).
  3569     05  FILLER REDEFINES RATEBF.
  3570         10  RATEBA PIC  X(0001).
  3571     05  RATEBI PIC  X(0006).
  3572*    -------------------------------
  3573     05  ERMSG1BL PIC S9(0004) COMP.
  3574     05  ERMSG1BF PIC  X(0001).
  3575     05  FILLER REDEFINES ERMSG1BF.
  3576         10  ERMSG1BA PIC  X(0001).
  3577     05  ERMSG1BI PIC  X(0072).
  3578*    -------------------------------
  3579     05  ENTPFBL PIC S9(0004) COMP.
  3580     05  ENTPFBF PIC  X(0001).
  3581     05  FILLER REDEFINES ENTPFBF.
  3582         10  ENTPFBA PIC  X(0001).
  3583     05  ENTPFBI PIC  99.
  3584 01  EL156BO REDEFINES EL156AI.
  3585     05  FILLER            PIC  X(0012).
  3586*    -------------------------------
  3587     05  FILLER            PIC  X(0003).
  3588     05  RUNDTEBO PIC  X(0008).
  3589*    -------------------------------
  3590     05  FILLER            PIC  X(0003).
  3591     05  RUNTIMBO PIC  99.99.
  3592*    -------------------------------
  3593     05  FILLER            PIC  X(0003).
  3594     05  PAYDTBO PIC  99B99B99.
  3595*    -------------------------------
  3596     05  FILLER            PIC  X(0003).
  3597     05  PAYTYPBO PIC  X(0015).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  71
* EL156.cbl
  3598*    -------------------------------
  3599     05  FILLER            PIC  X(0003).
  3600     05  PAYAMTBO PIC  ZZZZ,ZZ9.99.
  3601*    -------------------------------
  3602     05  FILLER            PIC  X(0003).
  3603     05  LOANHBO PIC  X(0012).
  3604*    -------------------------------
  3605     05  FILLER            PIC  X(0003).
  3606     05  LOANNBO PIC  X(0025).
  3607*    -------------------------------
  3608     05  FILLER            PIC  X(0003).
  3609     05  CKNUMHDO PIC  X(0012).
  3610*    -------------------------------
  3611     05  FILLER            PIC  X(0003).
  3612     05  CKNUMBO PIC  X(0007).
  3613*    -------------------------------
  3614     05  FILLER            PIC  X(0003).
  3615     05  AGTHDGO PIC  X(0016).
  3616*    -------------------------------
  3617     05  FILLER            PIC  X(0003).
  3618     05  NAMEBO PIC  X(0030).
  3619*    -------------------------------
  3620     05  FILLER            PIC  X(0003).
  3621     05  NAMEB2O PIC  X(0030).
  3622*    -------------------------------
  3623     05  FILLER            PIC  X(0003).
  3624     05  ADDR1BO PIC  X(0030).
  3625*    -------------------------------
  3626     05  FILLER            PIC  X(0003).
  3627     05  ADDR1B2O PIC  X(0030).
  3628*    -------------------------------
  3629     05  FILLER            PIC  X(0003).
  3630     05  ADDR2BO PIC  X(0030).
  3631*    -------------------------------
  3632     05  FILLER            PIC  X(0003).
  3633     05  ADDR2B2O PIC  X(0030).
  3634*    -------------------------------
  3635     05  FILLER            PIC  X(0003).
  3636     05  CITYSTBO PIC  X(0030).
  3637*    -------------------------------
  3638     05  FILLER            PIC  X(0003).
  3639     05  CITYST2O PIC  X(0030).
  3640*    -------------------------------
  3641     05  FILLER            PIC  X(0003).
  3642     05  ZIPBO PIC  ZZZZ99999.
  3643*    -------------------------------
  3644     05  FILLER            PIC  X(0003).
  3645     05  ZIPB2O PIC  ZZZZZZZZZ.
  3646*    -------------------------------
  3647     05  FILLER            PIC  X(0003).
  3648     05  INTHDBO PIC  X(0012).
  3649*    -------------------------------
  3650     05  FILLER            PIC  X(0003).
  3651     05  INTAMTBO PIC  ZZZZ,ZZZ.ZZ.
  3652*    -------------------------------
  3653     05  FILLER            PIC  X(0003).
  3654     05  PMTHDGBO PIC  X(0034).
  3655*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  72
* EL156.cbl
  3656     05  FILLER            PIC  X(0003).
  3657     05  CLMNOBO PIC  X(0007).
  3658*    -------------------------------
  3659     05  FILLER            PIC  X(0003).
  3660     05  CARRBO PIC  X(0001).
  3661*    -------------------------------
  3662     05  FILLER            PIC  X(0003).
  3663     05  CERTNOBO PIC  X(0010).
  3664*    -------------------------------
  3665     05  FILLER            PIC  X(0003).
  3666     05  SUFXBO PIC  X(0001).
  3667*    -------------------------------
  3668     05  FILLER            PIC  X(0003).
  3669     05  CLMTYPBO PIC  X(0006).
  3670*    -------------------------------
  3671     05  FILLER            PIC  X(0003).
  3672     05  INCURBO PIC  X(0008).
  3673*    -------------------------------
  3674     05  FILLER            PIC  X(0003).
  3675     05  PYFROMBO PIC  99B99B99.
  3676*    -------------------------------
  3677     05  FILLER            PIC  X(0003).
  3678     05  PYTHRUBO PIC  99B99B99.
  3679*    -------------------------------
  3680     05  FILLER            PIC  X(0003).
  3681     05  DAYSBO PIC  X(0005).
  3682*    -------------------------------
  3683     05  FILLER            PIC  X(0003).
  3684     05  BYBO PIC  X(0004).
  3685*    -------------------------------
  3686     05  FILLER            PIC  X(0003).
  3687     05  PROOFDBO PIC  99B99B99.
  3688*    -------------------------------
  3689     05  FILLER            PIC  X(0003).
  3690     05  ACCTBO PIC  X(0010).
  3691*    -------------------------------
  3692     05  FILLER            PIC  X(0003).
  3693     05  STATEBO PIC  X(0002).
  3694*    -------------------------------
  3695     05  FILLER            PIC  X(0003).
  3696     05  GROUPBO PIC  X(0006).
  3697*    -------------------------------
  3698     05  FILLER            PIC  X(0003).
  3699     05  ACARRBO PIC  X(0001).
  3700*    -------------------------------
  3701     05  FILLER            PIC  X(0003).
  3702     05  ACCTNMBO PIC  X(0030).
  3703*    -------------------------------
  3704     05  FILLER            PIC  X(0003).
  3705     05  UNDISBO PIC  ZZZ,Z99.99.
  3706*    -------------------------------
  3707     05  FILLER            PIC  X(0003).
  3708     05  RATEBO PIC  ZZZ.99.
  3709*    -------------------------------
  3710     05  FILLER            PIC  X(0003).
  3711     05  ERMSG1BO PIC  X(0072).
  3712*    -------------------------------
  3713     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  73
* EL156.cbl
  3714     05  ENTPFBO PIC  X(0002).
  3715*    -------------------------------
  3716****************************************************************
  3717*
  3718* Copyright (c) 2007 by Clerity Solutions, Inc.
  3719* All rights reserved.
  3720*
  3721****************************************************************
  3722 01  DFHEIV.
  3723   02  DFHEIV0               PIC X(35).
  3724   02  DFHEIV1               PIC X(08).
  3725   02  DFHEIV2               PIC X(08).
  3726   02  DFHEIV3               PIC X(08).
  3727   02  DFHEIV4               PIC X(06).
  3728   02  DFHEIV5               PIC X(04).
  3729   02  DFHEIV6               PIC X(04).
  3730   02  DFHEIV7               PIC X(02).
  3731   02  DFHEIV8               PIC X(02).
  3732   02  DFHEIV9               PIC X(01).
  3733   02  DFHEIV10              PIC S9(7) COMP-3.
  3734   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3735   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3736   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3737   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3738   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3739   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3740   02  DFHEIV17              PIC X(04).
  3741   02  DFHEIV18              PIC X(04).
  3742   02  DFHEIV19              PIC X(04).
  3743   02  DFHEIV20              USAGE IS POINTER.
  3744   02  DFHEIV21              USAGE IS POINTER.
  3745   02  DFHEIV22              USAGE IS POINTER.
  3746   02  DFHEIV23              USAGE IS POINTER.
  3747   02  DFHEIV24              USAGE IS POINTER.
  3748   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3749   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3750   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3751   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3752   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3753   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3754   02  FILLER                PIC X(02).
  3755   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3756   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3757   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3758   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3759   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3760 LINKAGE  SECTION.
  3761*****************************************************************
  3762*                                                               *
  3763* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3764* All rights reserved.                                          *
  3765*                                                               *
  3766*****************************************************************
  3767 01  dfheiblk.
  3768     02  eibtime          pic s9(7) comp-3.
  3769     02  eibdate          pic s9(7) comp-3.
  3770     02  eibtrnid         pic x(4).
  3771     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  74
* EL156.cbl
  3772     02  eibtrmid         pic x(4).
  3773     02  dfheigdi         pic s9(4) comp.
  3774     02  eibcposn         pic s9(4) comp.
  3775     02  eibcalen         pic s9(4) comp.
  3776     02  eibaid           pic x(1).
  3777     02  eibfiller1       pic x(1).
  3778     02  eibfn            pic x(2).
  3779     02  eibfiller2       pic x(2).
  3780     02  eibrcode         pic x(6).
  3781     02  eibfiller3       pic x(2).
  3782     02  eibds            pic x(8).
  3783     02  eibreqid         pic x(8).
  3784     02  eibrsrce         pic x(8).
  3785     02  eibsync          pic x(1).
  3786     02  eibfree          pic x(1).
  3787     02  eibrecv          pic x(1).
  3788     02  eibsend          pic x(1).
  3789     02  eibatt           pic x(1).
  3790     02  eibeoc           pic x(1).
  3791     02  eibfmh           pic x(1).
  3792     02  eibcompl         pic x(1).
  3793     02  eibsig           pic x(1).
  3794     02  eibconf          pic x(1).
  3795     02  eiberr           pic x(1).
  3796     02  eibrldbk         pic x(1).
  3797     02  eiberrcd         pic x(4).
  3798     02  eibsynrb         pic x(1).
  3799     02  eibnodat         pic x(1).
  3800     02  eibfiller5       pic x(2).
  3801     02  eibresp          pic 9(09) comp.
  3802     02  eibresp2         pic 9(09) comp.
  3803     02  dfheigdj         pic s9(4) comp.
  3804     02  dfheigdk         pic s9(4) comp.
  3805 01  DFHCOMMAREA             PIC X(1024).
  3806
  3807*    COPY ELCMSTR.
  3808******************************************************************
  3809*                                                                *
  3810*                            ELCMSTR.                            *
  3811*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3812*                            VMOD=2.012                          *
  3813*                                                                *
  3814*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  3815*                                                                *
  3816*   FILE TYPE = VSAM,KSDS                                        *
  3817*   RECORD SIZE = 350  RECFORM = FIXED                           *
  3818*                                                                *
  3819*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  3820*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  3821*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  3822*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  3823*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  3824*                                                 RKP=75,LEN=21  *
  3825*                                                                *
  3826*   **** NOTE ****                                               *
  3827*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  3828*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  3829*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  75
* EL156.cbl
  3830*   LOG = YES                                                    *
  3831*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3832******************************************************************
  3833*                   C H A N G E   L O G
  3834*
  3835* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3836*-----------------------------------------------------------------
  3837*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3838* EFFECTIVE    NUMBER
  3839*-----------------------------------------------------------------
  3840* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  3841* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  3842* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  3843* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  3844* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  3845******************************************************************
  3846 01  CLAIM-MASTER.
  3847     12  CL-RECORD-ID                PIC XX.
  3848         88  VALID-CL-ID         VALUE 'CL'.
  3849
  3850     12  CL-CONTROL-PRIMARY.
  3851         16  CL-COMPANY-CD           PIC X.
  3852         16  CL-CARRIER              PIC X.
  3853         16  CL-CLAIM-NO             PIC X(7).
  3854         16  CL-CERT-NO.
  3855             20  CL-CERT-PRIME       PIC X(10).
  3856             20  CL-CERT-SFX         PIC X.
  3857
  3858     12  CL-CONTROL-BY-NAME.
  3859         16  CL-COMPANY-CD-A1        PIC X.
  3860         16  CL-INSURED-LAST-NAME    PIC X(15).
  3861         16  CL-INSURED-NAME.
  3862             20  CL-INSURED-1ST-NAME PIC X(12).
  3863             20  CL-INSURED-MID-INIT PIC X.
  3864
  3865     12  CL-CONTROL-BY-SSN.
  3866         16  CL-COMPANY-CD-A2        PIC X.
  3867         16  CL-SOC-SEC-NO.
  3868             20  CL-SSN-STATE        PIC XX.
  3869             20  CL-SSN-ACCOUNT      PIC X(6).
  3870             20  CL-SSN-LN3          PIC X(3).
  3871
  3872     12  CL-CONTROL-BY-CERT-NO.
  3873         16  CL-COMPANY-CD-A4        PIC X.
  3874         16  CL-CERT-NO-A4.
  3875             20  CL-CERT-A4-PRIME    PIC X(10).
  3876             20  CL-CERT-A4-SFX      PIC X.
  3877
  3878     12  CL-CONTROL-BY-CCN.
  3879         16  CL-COMPANY-CD-A5        PIC X.
  3880         16  CL-CCN-A5.
  3881             20  CL-CCN.
  3882                 24  CL-CCN-PREFIX-A5 PIC X(4).
  3883                 24  CL-CCN-PRIME-A5 PIC X(12).
  3884             20  CL-CCN-FILLER-A5    PIC X(4).
  3885
  3886     12  CL-INSURED-PROFILE-DATA.
  3887         16  CL-INSURED-BIRTH-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  76
* EL156.cbl
  3888         16  CL-INSURED-SEX-CD       PIC X.
  3889             88  INSURED-IS-MALE        VALUE 'M'.
  3890             88  INSURED-IS-FEMALE      VALUE 'F'.
  3891             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  3892         16  CL-INSURED-OCC-CD       PIC X(6).
  3893         16  FILLER                  PIC X(5).
  3894
  3895     12  CL-PROCESSING-INFO.
  3896         16  CL-PROCESSOR-ID         PIC X(4).
  3897         16  CL-CLAIM-STATUS         PIC X.
  3898             88  CLAIM-IS-OPEN          VALUE 'O'.
  3899             88  CLAIM-IS-CLOSED        VALUE 'C'.
  3900         16  CL-CLAIM-TYPE           PIC X.
  3901*            88  AH-CLAIM               VALUE 'A'.
  3902*            88  LIFE-CLAIM             VALUE 'L'.
  3903*            88  PROPERTY-CLAIM         VALUE 'P'.
  3904*            88  IUI-CLAIM              VALUE 'I'.
  3905*            88  GAP-CLAIM              VALUE 'G'.
  3906*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  3907         16  CL-CLAIM-PREM-TYPE      PIC X.
  3908             88  SINGLE-PREMIUM         VALUE '1'.
  3909             88  O-B-COVERAGE           VALUE '2'.
  3910             88  OPEN-END-COVERAGE      VALUE '3'.
  3911         16  CL-INCURRED-DT          PIC XX.
  3912         16  CL-REPORTED-DT          PIC XX.
  3913         16  CL-FILE-ESTABLISH-DT    PIC XX.
  3914         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  3915         16  CL-LAST-PMT-DT          PIC XX.
  3916         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  3917         16  CL-PAID-THRU-DT         PIC XX.
  3918         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  3919         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  3920         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  3921         16  CL-PMT-CALC-METHOD      PIC X.
  3922             88  CL-360-DAY-YR          VALUE '1'.
  3923             88  CL-365-DAY-YR          VALUE '2'.
  3924             88  CL-FULL-MONTHS         VALUE '3'.
  3925         16  CL-CAUSE-CD             PIC X(6).
  3926
  3927         16  CL-PRIME-CERT-NO.
  3928             20  CL-PRIME-CERT-PRIME PIC X(10).
  3929             20  CL-PRIME-CERT-SFX   PIC X.
  3930
  3931         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  3932             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  3933             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  3934
  3935         16  CL-MICROFILM-NO         PIC X(10).
  3936         16  FILLER REDEFINES CL-MICROFILM-NO.
  3937             20  CL-BENEFIT-PERIOD   PIC 99.
  3938             20  FILLER              PIC X(8).
  3939         16  CL-PROG-FORM-TYPE       PIC X.
  3940         16  CL-LAST-ADD-ON-DT       PIC XX.
  3941
  3942         16  CL-LAST-REOPEN-DT       PIC XX.
  3943         16  CL-LAST-CLOSE-DT        PIC XX.
  3944         16  CL-LAST-CLOSE-REASON    PIC X(01).
  3945             88  FINAL-PAID             VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  77
* EL156.cbl
  3946             88  CLAIM-DENIED           VALUE '2'.
  3947             88  AUTO-CLOSE             VALUE '3'.
  3948             88  MANUAL-CLOSE           VALUE '4'.
  3949             88  BENEFITS-CHANGED       VALUE 'C'.
  3950             88  SETUP-ERRORS           VALUE 'E'.
  3951         16  CL-ASSOC-CERT-SEQU      PIC S99.
  3952         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  3953         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  3954             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  3955         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  3956         16  FILLER                  PIC X.
  3957
  3958     12  CL-CERTIFICATE-DATA.
  3959         16  CL-CERT-ORIGIN          PIC X.
  3960             88  CERT-WAS-ONLINE        VALUE '1'.
  3961             88  CERT-WAS-CREATED       VALUE '2'.
  3962             88  COVERAGE-WAS-ADDED     VALUE '3'.
  3963         16  CL-CERT-KEY-DATA.
  3964             20  CL-CERT-CARRIER     PIC X.
  3965             20  CL-CERT-GROUPING    PIC X(6).
  3966             20  CL-CERT-STATE       PIC XX.
  3967             20  CL-CERT-ACCOUNT.
  3968                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  3969                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  3970             20  CL-CERT-EFF-DT      PIC XX.
  3971
  3972     12  CL-STATUS-CONTROLS.
  3973         16  CL-PRIORITY-CD          PIC X.
  3974             88  CONFIDENTIAL-DATA      VALUE '8'.
  3975             88  HIGHEST-PRIORITY       VALUE '9'.
  3976         16  CL-SUPV-ATTN-CD         PIC X.
  3977             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  3978             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  3979         16  CL-PURGED-DT            PIC XX.
  3980         16  CL-RESTORED-DT          PIC XX.
  3981         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  3982         16  CL-NEXT-RESEND-DT       PIC XX.
  3983         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  3984         16  CL-CRITICAL-PERIOD      PIC 99.
  3985*        16  FILLER                  PIC XX.
  3986         16  CL-LAST-MAINT-DT        PIC XX.
  3987         16  CL-LAST-MAINT-USER      PIC X(4).
  3988         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  3989         16  CL-LAST-MAINT-TYPE      PIC X.
  3990             88  CLAIM-SET-UP           VALUE ' '.
  3991             88  PAYMENT-MADE           VALUE '1'.
  3992             88  LETTER-SENT            VALUE '2'.
  3993             88  MASTER-WAS-ALTERED     VALUE '3'.
  3994             88  MASTER-WAS-RESTORED    VALUE '4'.
  3995             88  INCURRED-DATE-CHANGED  VALUE '5'.
  3996             88  FILE-CONVERTED         VALUE '6'.
  3997             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  3998             88  ERROR-CORRECTION       VALUE 'E'.
  3999         16  CL-RELATED-CLAIM-NO     PIC X(7).
  4000         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  4001         16  CL-BENEFICIARY          PIC X(10).
  4002         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  4003         16  CL-DENIAL-TYPE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  78
* EL156.cbl
  4004             88  CL-TYPE-DENIAL          VALUE '1'.
  4005             88  CL-TYPE-RESCISSION      VALUE '2'.
  4006             88  CL-TYPE-REFORMATION     VALUE '3'.
  4007             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  4008             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  4009         16  filler                  pic x(5).
  4010*        16  CL-CRIT-PER-RECURRENT   PIC X.
  4011*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  4012*        16  CL-RTW-DT               PIC XX.
  4013
  4014     12  CL-TRAILER-CONTROLS.
  4015         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  4016             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  4017             88  CL-LAST-TRL-AVAIL      VALUE +100.
  4018             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  4019         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  4020         16  FILLER                  PIC XX.
  4021         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  4022         16  CL-ADDRESS-TRAILER-CNT.
  4023             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  4024                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  4025             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  4026                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  4027             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  4028                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  4029             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  4030                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  4031             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  4032                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  4033             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  4034                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  4035             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  4036                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  4037
  4038     12  CL-CV-REFERENCE-NO.
  4039         16  CL-CV-REFNO-PRIME       PIC X(18).
  4040         16  CL-CV-REFNO-SFX         PIC XX.
  4041
  4042     12  CL-FILE-LOCATION            PIC X(4).
  4043
  4044     12  CL-PROCESS-ERRORS.
  4045         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  4046             88  NO-FATAL-ERRORS        VALUE ZERO.
  4047         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  4048             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  4049
  4050     12  CL-PRODUCT-CD               PIC X.
  4051
  4052     12  CL-CURRENT-KEY-DATA.
  4053         16  CL-CURRENT-CARRIER      PIC X.
  4054         16  CL-CURRENT-GROUPING     PIC X(6).
  4055         16  CL-CURRENT-STATE        PIC XX.
  4056         16  CL-CURRENT-ACCOUNT      PIC X(10).
  4057
  4058     12  CL-ASSOCIATES               PIC X.
  4059         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  4060         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  4061         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  79
* EL156.cbl
  4062         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  4063
  4064     12  CL-ACTIVITY-CODE            PIC 99.
  4065     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  4066     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  4067
  4068     12  CL-LAPSE-REPORT-CODE        PIC 9.
  4069     12  CL-LAG-REPORT-CODE          PIC 9.
  4070     12  CL-LOAN-TYPE                PIC XX.
  4071     12  CL-LEGAL-STATE              PIC XX.
  4072
  4073     12  CL-YESNOSW                  PIC X.
  4074     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  4075         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  4076         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  4077         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  4078     12  cl-insured-type             pic x.
  4079         88  cl-claim-on-primary         value 'P'.
  4080         88  cl-claim-on-co-borrower     value 'C'.
  4081     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  80
* EL156.cbl
  4083*    COPY ELCCNTL.
  4084******************************************************************
  4085*                                                                *
  4086*                                                                *
  4087*                            ELCCNTL.                            *
  4088*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4089*                            VMOD=2.059                          *
  4090*                                                                *
  4091*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  4092*                                                                *
  4093*   FILE TYPE = VSAM,KSDS                                        *
  4094*   RECORD SIZE = 750  RECFORM = FIXED                           *
  4095*                                                                *
  4096*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  4097*       ALTERNATE INDEX = NONE                                   *
  4098*                                                                *
  4099*   LOG = YES                                                    *
  4100*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4101******************************************************************
  4102*                   C H A N G E   L O G
  4103*
  4104* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4105*-----------------------------------------------------------------
  4106*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4107* EFFECTIVE    NUMBER
  4108*-----------------------------------------------------------------
  4109* 082503                   PEMA  ADD BENEFIT GROUP
  4110* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4111* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  4112* 092705    2005050300006  PEMA  ADD SPP LEASES
  4113* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  4114* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  4115* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  4116* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  4117* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  4118* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  4119* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  4120* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  4121* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  4122* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  4123******************************************************************
  4124*
  4125 01  CONTROL-FILE.
  4126     12  CF-RECORD-ID                       PIC XX.
  4127         88  VALID-CF-ID                        VALUE 'CF'.
  4128
  4129     12  CF-CONTROL-PRIMARY.
  4130         16  CF-COMPANY-ID                  PIC XXX.
  4131         16  CF-RECORD-TYPE                 PIC X.
  4132             88  CF-COMPANY-MASTER              VALUE '1'.
  4133             88  CF-PROCESSOR-MASTER            VALUE '2'.
  4134             88  CF-STATE-MASTER                VALUE '3'.
  4135             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  4136             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  4137             88  CF-CARRIER-MASTER              VALUE '6'.
  4138             88  CF-MORTALITY-MASTER            VALUE '7'.
  4139             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  4140             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  81
* EL156.cbl
  4141             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  4142             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  4143             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  4144             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  4145             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  4146             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  4147             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  4148             88  CF-REMINDERS-MASTER            VALUE 'R'.
  4149             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  4150         16  CF-ACCESS-CD-GENL              PIC X(4).
  4151         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  4152             20  CF-PROCESSOR               PIC X(4).
  4153         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  4154             20  CF-STATE-CODE              PIC XX.
  4155             20  FILLER                     PIC XX.
  4156         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  4157             20  FILLER                     PIC XX.
  4158             20  CF-HI-BEN-IN-REC           PIC XX.
  4159         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  4160             20  FILLER                     PIC XXX.
  4161             20  CF-CARRIER-CNTL            PIC X.
  4162         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  4163             20  FILLER                     PIC XX.
  4164             20  CF-HI-TYPE-IN-REC          PIC 99.
  4165         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  4166             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  4167                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  4168             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  4169             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  4170         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  4171             20  FILLER                     PIC X.
  4172             20  CF-CUSTOM-REPORT-NO        PIC 999.
  4173         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  4174             20  FILLER                     PIC XX.
  4175             20  CF-MORTGAGE-PLAN           PIC XX.
  4176         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  4177
  4178     12  CF-LAST-MAINT-DT                   PIC XX.
  4179     12  CF-LAST-MAINT-BY                   PIC X(4).
  4180     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  4181
  4182     12  CF-RECORD-BODY                     PIC X(728).
  4183
  4184
  4185****************************************************************
  4186*             COMPANY MASTER RECORD                            *
  4187****************************************************************
  4188
  4189     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4190         16  CF-COMPANY-ADDRESS.
  4191             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  4192             20  CF-CL-IN-CARE-OF           PIC X(30).
  4193             20  CF-CL-ADDR-LINE-1          PIC X(30).
  4194             20  CF-CL-ADDR-LINE-2          PIC X(30).
  4195             20  CF-CL-CITY-STATE           PIC X(30).
  4196             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  4197             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  4198         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  82
* EL156.cbl
  4199         16  CF-COMPANY-PASSWORD            PIC X(8).
  4200         16  CF-SECURITY-OPTION             PIC X.
  4201             88  ALL-SECURITY                   VALUE '1'.
  4202             88  COMPANY-VERIFY                 VALUE '2'.
  4203             88  PROCESSOR-VERIFY               VALUE '3'.
  4204             88  NO-SECURITY                    VALUE '4'.
  4205             88  ALL-BUT-TERM                   VALUE '5'.
  4206         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  4207             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  4208         16  CF-LGX-INTERFACE-CNTL          PIC X.
  4209             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  4210         16  CF-INFORCE-LOCATION            PIC X.
  4211             88  CERTS-ARE-ONLINE               VALUE '1'.
  4212             88  CERTS-ARE-OFFLINE              VALUE '2'.
  4213             88  NO-CERTS-AVAILABLE             VALUE '3'.
  4214         16  CF-LOWER-CASE-LETTERS          PIC X.
  4215         16  CF-CERT-ACCESS-CONTROL         PIC X.
  4216             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  4217             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  4218             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  4219             88  CF-ACCNT-CNTL                  VALUE '3'.
  4220             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  4221
  4222         16  CF-FORMS-PRINTER-ID            PIC X(4).
  4223         16  CF-CHECK-PRINTER-ID            PIC X(4).
  4224
  4225         16  CF-LGX-CREDIT-USER             PIC X.
  4226             88  CO-IS-NOT-USER                 VALUE 'N'.
  4227             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  4228
  4229         16 CF-CREDIT-CALC-CODES.
  4230             20  CF-CR-REM-TERM-CALC PIC X.
  4231               88  CR-EARN-AFTER-15TH           VALUE '1'.
  4232               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  4233               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  4234               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  4235               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  4236               88  CR-EARN-AFTER-14TH           VALUE '6'.
  4237               88  CR-EARN-AFTER-16TH           VALUE '7'.
  4238             20  CF-CR-R78-METHOD           PIC X.
  4239               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  4240               88  DONT-USE-PLUS-ONE            VALUE '1'.
  4241
  4242         16  CF-CLAIM-CONTROL-COUNTS.
  4243             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  4244                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  4245
  4246             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  4247                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  4248
  4249             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  4250                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  4251
  4252             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  4253                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  4254
  4255         16  CF-CURRENT-MONTH-END           PIC XX.
  4256
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  83
* EL156.cbl
  4257         16  CF-CO-CALC-QUOTE-TOLERANCE.
  4258             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  4259             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  4260             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  4261             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  4262                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4263                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4264             20  CF-CO-PREM-REJECT-SW       PIC X.
  4265                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  4266                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  4267             20  CF-CO-REF-REJECT-SW        PIC X.
  4268                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  4269                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  4270
  4271         16  CF-CO-REPORTING-DT             PIC XX.
  4272         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  4273         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  4274           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  4275           88  CF-CO-MONTH-END                  VALUE '1'.
  4276
  4277         16  CF-LGX-CLAIM-USER              PIC X.
  4278             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  4279             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  4280
  4281         16  CF-CREDIT-EDIT-CONTROLS.
  4282             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  4283             20  CF-MIN-AGE                 PIC 99.
  4284             20  CF-DEFAULT-AGE             PIC 99.
  4285             20  CF-MIN-TERM                PIC S999      COMP-3.
  4286             20  CF-MAX-TERM                PIC S999      COMP-3.
  4287             20  CF-DEFAULT-SEX             PIC X.
  4288             20  CF-JOINT-AGE-INPUT         PIC X.
  4289                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  4290             20  CF-BIRTH-DATE-INPUT        PIC X.
  4291                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  4292             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  4293                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  4294                 88  CF-ZERO-CARRIER            VALUE '1'.
  4295                 88  CF-ZERO-GROUPING           VALUE '2'.
  4296                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  4297             20  CF-EDIT-SW                 PIC X.
  4298                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  4299             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  4300             20  CF-CR-PR-METHOD            PIC X.
  4301               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  4302               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  4303             20  FILLER                     PIC X.
  4304
  4305         16  CF-CREDIT-MISC-CONTROLS.
  4306             20  CF-REIN-TABLE-SW           PIC X.
  4307                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  4308             20  CF-COMP-TABLE-SW           PIC X.
  4309                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  4310             20  CF-EXPERIENCE-RETENTION-AGE
  4311                                            PIC S9        COMP-3.
  4312             20  CF-CONVERSION-DT           PIC XX.
  4313             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  4314             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  84
* EL156.cbl
  4315                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  4316                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  4317
  4318             20  CF-CR-CHECK-NO-CONTROL.
  4319                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  4320                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  4321                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  4322                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  4323                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  4324                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  4325
  4326                 24  CF-CR-CHECK-COUNT       REDEFINES
  4327                     CF-CR-CHECK-COUNTER      PIC X(4).
  4328
  4329                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  4330                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  4331
  4332                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  4333                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  4334                 24  CF-MAIL-PROCESSING       PIC X.
  4335                     88  MAIL-PROCESSING          VALUE 'Y'.
  4336
  4337         16  CF-MISC-SYSTEM-CONTROL.
  4338             20  CF-SYSTEM-C                 PIC X.
  4339                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  4340             20  CF-SYSTEM-D                 PIC X.
  4341                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  4342             20  CF-SOC-SEC-NO-SW            PIC X.
  4343                 88  SOC-SEC-NO-USED             VALUE '1'.
  4344             20  CF-MEMBER-NO-SW             PIC X.
  4345                 88  MEMBER-NO-USED              VALUE '1'.
  4346             20  CF-TAX-ID-NUMBER            PIC X(11).
  4347             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  4348             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  4349                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  4350                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  4351                 88  CF-ALL-APPROVED             VALUE 'Y'.
  4352                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  4353             20  CF-SYSTEM-E                 PIC X.
  4354                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  4355
  4356         16  CF-LGX-LIFE-USER               PIC X.
  4357             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  4358             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  4359
  4360         16  CF-CR-MONTH-END-DT             PIC XX.
  4361
  4362         16  CF-FILE-MAINT-DATES.
  4363             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  4364                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  4365             20  CF-LAST-BATCH       REDEFINES
  4366                 CF-LAST-BATCH-NO               PIC X(4).
  4367             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  4368             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  4369             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  4370             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  4371             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  4372             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  85
* EL156.cbl
  4373             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  4374             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  4375             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  4376             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  4377
  4378         16  CF-NEXT-COMPANY-ID             PIC XXX.
  4379         16  FILLER                         PIC X.
  4380
  4381         16  CF-ALT-MORT-CODE               PIC X(4).
  4382         16  CF-MEMBER-CAPTION              PIC X(10).
  4383
  4384         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  4385             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  4386             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  4387             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  4388             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  4389             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  4390
  4391         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  4392
  4393         16  CF-LIFE-OVERRIDE-L1            PIC X.
  4394         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  4395         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  4396         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  4397
  4398         16  CF-AH-OVERRIDE-L1              PIC X.
  4399         16  CF-AH-OVERRIDE-L2              PIC XX.
  4400         16  CF-AH-OVERRIDE-L6              PIC X(6).
  4401         16  CF-AH-OVERRIDE-L12             PIC X(12).
  4402
  4403         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  4404         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  4405
  4406         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  4407         16  CF-AR-LAST-EL860-DT            PIC XX.
  4408         16  CF-MP-MONTH-END-DT             PIC XX.
  4409
  4410         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  4411         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  4412             88  CF-CLAIM-PAID-TO               VALUE '1'.
  4413
  4414         16  CF-AR-MONTH-END-DT             PIC XX.
  4415
  4416         16  CF-CRDTCRD-USER                PIC X.
  4417             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  4418             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  4419
  4420         16  CF-CC-MONTH-END-DT             PIC XX.
  4421
  4422         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  4423
  4424         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  4425             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  4426             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  4427             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  4428         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  4429         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  4430         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  86
* EL156.cbl
  4431         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  4432             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  4433             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  4434         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  4435         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  4436         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  4437             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  4438         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  4439
  4440         16  CF-CL-ZIP-CODE.
  4441             20  CF-CL-ZIP-PRIME.
  4442                 24  CF-CL-ZIP-1ST          PIC X.
  4443                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  4444                 24  FILLER                 PIC X(4).
  4445             20  CF-CL-ZIP-PLUS4            PIC X(4).
  4446         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  4447             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  4448             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  4449             20  FILLER                     PIC XXX.
  4450
  4451         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  4452         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  4453         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  4454         16  CF-CO-OPTION-START-DATE        PIC XX.
  4455         16  CF-REM-TRM-CALC-OPTION         PIC X.
  4456           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  4457                                                      '3' '4'.
  4458           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  4459           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  4460           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  4461           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  4462           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  4463           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  4464
  4465         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  4466
  4467         16  CF-PAYMENT-APPROVAL-LEVELS.
  4468             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  4469             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  4470             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  4471             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  4472             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  4473             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  4474
  4475         16  CF-END-USER-REPORTING-USER     PIC X.
  4476             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  4477             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  4478
  4479         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  4480             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  4481             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  4482
  4483         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  4484
  4485         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  4486         16  FILLER                         PIC X.
  4487
  4488         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  87
* EL156.cbl
  4489             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  4490             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  4491             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  4492
  4493         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  4494
  4495         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  4496             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  4497             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  4498
  4499         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  4500             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  4501             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  4502
  4503         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  4504
  4505         16  CF-CO-ACH-ID-CODE              PIC  X.
  4506             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  4507             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  4508             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  4509         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  4510         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  4511         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  4512         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  4513         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  4514         16  CF-CO-ACH-RECV-NO              PIC X(08).
  4515         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  4516         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  4517         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  4518                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  4519         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  4520                 CF-CO-ACH-TRACE-NO         PIC X(4).
  4521
  4522         16  CF-CO-OVER-SHORT.
  4523             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4524             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4525
  4526*         16  FILLER                         PIC X(102).
  4527         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  4528             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  4529             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  4530
  4531         16  CF-AH-APPROVAL-DAYS.
  4532             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  4533             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  4534             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  4535             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  4536
  4537         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  4538
  4539         16  CF-APPROV-LEV-5.
  4540             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  4541             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  4542             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  4543
  4544         16  FILLER                         PIC X(68).
  4545****************************************************************
  4546*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  88
* EL156.cbl
  4547****************************************************************
  4548
  4549     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4550         16  CF-PROCESSOR-NAME              PIC X(30).
  4551         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  4552         16  CF-PROCESSOR-TITLE             PIC X(26).
  4553         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  4554                 88  MESSAGE-YES                VALUE 'Y'.
  4555                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  4556
  4557*****************************************************
  4558****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  4559****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  4560****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  4561****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  4562*****************************************************
  4563
  4564         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  4565             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  4566             20  CF-APPLICATION-FORCE       PIC X.
  4567             20  CF-INDIVIDUAL-APP.
  4568                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  4569                     28  CF-BROWSE-APP      PIC X.
  4570                     28  CF-UPDATE-APP      PIC X.
  4571
  4572         16  CF-CURRENT-TERM-ON             PIC X(4).
  4573         16  CF-PROCESSOR-LIMITS-CLAIMS.
  4574             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  4575             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  4576             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  4577             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  4578             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  4579             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  4580             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  4581         16  CF-PROCESSOR-CARRIER           PIC X.
  4582             88  NO-CARRIER-SECURITY            VALUE ' '.
  4583         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  4584             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  4585         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  4586             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  4587         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  4588             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  4589
  4590         16  CF-PROC-SYS-ACCESS-SW.
  4591             20  CF-PROC-CREDIT-CLAIMS-SW.
  4592                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  4593                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  4594                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  4595                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  4596             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  4597                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  4598                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  4599             20  CF-PROC-LIFE-GNRLDGR-SW.
  4600                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  4601                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  4602                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  4603                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  4604             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  89
* EL156.cbl
  4605                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  4606                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  4607         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  4608             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  4609             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  4610         16  CF-PROCESSOR-PRINTER               PIC X(4).
  4611
  4612         16  CF-APPROVAL-LEVEL                  PIC X.
  4613             88  APPROVAL-LEVEL-1                   VALUE '1'.
  4614             88  APPROVAL-LEVEL-2                   VALUE '2'.
  4615             88  APPROVAL-LEVEL-3                   VALUE '3'.
  4616             88  APPROVAL-LEVEL-4                   VALUE '4'.
  4617             88  APPROVAL-LEVEL-5                   VALUE '5'.
  4618
  4619         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  4620
  4621         16  CF-LANGUAGE-TYPE                   PIC X.
  4622             88  CF-LANG-IS-ENG                     VALUE 'E'.
  4623             88  CF-LANG-IS-FR                      VALUE 'F'.
  4624
  4625         16  CF-CSR-IND                         PIC X.
  4626         16  FILLER                             PIC X(239).
  4627
  4628****************************************************************
  4629*             PROCESSOR/REMINDERS RECORD                       *
  4630****************************************************************
  4631
  4632     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  4633         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  4634             20  CF-START-REMIND-DT         PIC XX.
  4635             20  CF-END-REMIND-DT           PIC XX.
  4636             20  CF-REMINDER-TEXT           PIC X(50).
  4637         16  FILLER                         PIC X(296).
  4638
  4639
  4640****************************************************************
  4641*             STATE MASTER RECORD                              *
  4642****************************************************************
  4643
  4644     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4645         16  CF-STATE-ABBREVIATION          PIC XX.
  4646         16  CF-STATE-NAME                  PIC X(25).
  4647         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  4648         16  CF-ST-CALC-QUOTE-TOLERANCE.
  4649             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  4650             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  4651             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  4652             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  4653                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  4654                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  4655             20  CF-ST-PREM-REJECT-SW       PIC X.
  4656                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  4657                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  4658             20  CF-ST-REF-REJECT-SW        PIC X.
  4659                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  4660                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  4661         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  4662         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  90
* EL156.cbl
  4663         16  CF-ST-REFUND-RULES.
  4664             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  4665             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  4666             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  4667         16  CF-ST-FST-PMT-EXTENSION.
  4668             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  4669             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  4670                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  4671                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  4672                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  4673                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  4674         16  CF-ST-STATE-CALL.
  4675             20  CF-ST-CALL-UNEARNED        PIC X.
  4676             20  CF-ST-CALL-RPT-CNTL        PIC X.
  4677             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  4678         16  CF-REPLACEMENT-LAW-SW          PIC X.
  4679             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  4680             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  4681         16  CF-REPLACEMENT-LETTER          PIC X(4).
  4682         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  4683         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  4684         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  4685         16  CF-ST-SPLIT-PAYMENT            PIC X.
  4686         16  FILLER                         PIC X.
  4687         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  4688             20  CF-ST-BENEFIT-CD           PIC XX.
  4689             20  CF-ST-BENEFIT-KIND         PIC X.
  4690                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  4691                 88  CF-ST-AH-KIND              VALUE 'A'.
  4692             20  CF-ST-REM-TERM-CALC        PIC X.
  4693                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  4694                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  4695                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  4696                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  4697                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  4698                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  4699                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  4700                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  4701
  4702             20  CF-ST-REFUND-CALC          PIC X.
  4703                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  4704                 88  ST-REFD-BY-R78             VALUE '1'.
  4705                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  4706                 88  ST-REFD-AS-CALIF           VALUE '3'.
  4707                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  4708                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  4709                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  4710                 88  ST-REFD-UTAH               VALUE '7'.
  4711                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  4712                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  4713                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  4714
  4715             20  CF-ST-EARNING-CALC         PIC X.
  4716                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  4717                 88  ST-EARN-BY-R78             VALUE '1'.
  4718                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  4719                 88  ST-EARN-AS-CALIF           VALUE '3'.
  4720                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  91
* EL156.cbl
  4721                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  4722                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  4723                 88  ST-EARN-MEAN               VALUE '8'.
  4724                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  4725
  4726             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4727                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4728                 88  ST-OVRD-BY-R78             VALUE '1'.
  4729                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4730                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4731                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4732                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4733                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4734                 88  ST-OVRD-MEAN               VALUE '8'.
  4735                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  4736             20  cf-st-extra-periods        pic 9.
  4737*            20  FILLER                     PIC X.
  4738
  4739         16  CF-ST-COMMISSION-CAPS.
  4740             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4741             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4742             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4743             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4744         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4745                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4746
  4747         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4748
  4749         16  CF-ST-STATUTORY-INTEREST.
  4750             20  CF-ST-STAT-DATE-FROM       PIC X.
  4751                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4752                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4753             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4754             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4755             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4756             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4757             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4758
  4759         16  CF-ST-OVER-SHORT.
  4760             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4761             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4762
  4763         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4764
  4765         16  CF-ST-RT-CALC                  PIC X.
  4766
  4767         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4768         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4769         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4770         16  CF-ST-RF-LR-CALC               PIC X.
  4771         16  CF-ST-RF-LL-CALC               PIC X.
  4772         16  CF-ST-RF-LN-CALC               PIC X.
  4773         16  CF-ST-RF-AH-CALC               PIC X.
  4774         16  CF-ST-RF-CP-CALC               PIC X.
  4775*        16  FILLER                         PIC X(206).
  4776*CIDMOD         16  FILLER                         PIC X(192).
  4777         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4778             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  92
* EL156.cbl
  4779         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4780         16  CF-ST-VFY-2ND-BENE             PIC X.
  4781         16  CF-ST-CAUSAL-STATE             PIC X.
  4782         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  4783         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  4784         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  4785             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  4786         16  CF-ST-NET-ONLY-STATE           PIC X.
  4787             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  4788         16  FILLER                         PIC X(181).
  4789
  4790****************************************************************
  4791*             BENEFIT MASTER RECORD                            *
  4792****************************************************************
  4793
  4794     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4795         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4796             20  CF-BENEFIT-CODE            PIC XX.
  4797             20  CF-BENEFIT-NUMERIC  REDEFINES
  4798                 CF-BENEFIT-CODE            PIC XX.
  4799             20  CF-BENEFIT-ALPHA           PIC XXX.
  4800             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4801             20  CF-BENEFIT-COMMENT         PIC X(10).
  4802
  4803             20  CF-LF-COVERAGE-TYPE        PIC X.
  4804                 88  CF-REDUCING                VALUE 'R'.
  4805                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4806
  4807             20  CF-SPECIAL-CALC-CD         PIC X.
  4808                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4809                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4810                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4811                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4812                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4813                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4814                 88  CF-FARM-PLAN               VALUE 'F'.
  4815                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4816                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4817                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4818                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4819                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4820                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4821                 88  CF-PRUDENTIAL              VALUE 'P'.
  4822                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4823                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4824                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4825                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4826                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4827                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4828
  4829             20  CF-JOINT-INDICATOR         PIC X.
  4830                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4831
  4832*            20  FILLER                     PIC X(12).
  4833             20  cf-maximum-benefits        pic s999 comp-3.
  4834             20  FILLER                     PIC X(09).
  4835             20  CF-BENEFIT-CATEGORY        PIC X.
  4836             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  93
* EL156.cbl
  4837
  4838             20  CF-CO-REM-TERM-CALC        PIC X.
  4839                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4840                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4841                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4842                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4843                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4844
  4845             20  CF-CO-EARNINGS-CALC        PIC X.
  4846                 88  CO-EARN-BY-R78             VALUE '1'.
  4847                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4848                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4849                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4850                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4851                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4852                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4853                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4854
  4855             20  CF-CO-REFUND-CALC          PIC X.
  4856                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4857                 88  CO-REFD-BY-R78             VALUE '1'.
  4858                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4859                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4860                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4861                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  4862                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4863                 88  CO-REFD-MEAN               VALUE '8'.
  4864                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4865                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4866                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4867
  4868             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4869                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4870                 88  CO-OVRD-BY-R78             VALUE '1'.
  4871                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4872                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4873                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4874                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4875                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4876                 88  CO-OVRD-MEAN               VALUE '8'.
  4877                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4878
  4879             20  CF-CO-BEN-I-G-CD           PIC X.
  4880                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4881                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4882                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4883
  4884         16  FILLER                         PIC X(304).
  4885
  4886
  4887****************************************************************
  4888*             CARRIER MASTER RECORD                            *
  4889****************************************************************
  4890
  4891     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4892         16  CF-ADDRESS-DATA.
  4893             20  CF-MAIL-TO-NAME            PIC X(30).
  4894             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  94
* EL156.cbl
  4895             20  CF-ADDRESS-LINE-1          PIC X(30).
  4896             20  CF-ADDRESS-LINE-2          PIC X(30).
  4897             20  CF-CITY-STATE              PIC X(30).
  4898             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4899             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4900
  4901         16  CF-CLAIM-NO-CONTROL.
  4902             20  CF-CLAIM-NO-METHOD         PIC X.
  4903                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4904                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4905                 88  CLAIM-NO-SEQ               VALUE '3'.
  4906                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4907             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4908                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4909                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4910                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4911
  4912         16  CF-CHECK-NO-CONTROL.
  4913             20  CF-CHECK-NO-METHOD         PIC X.
  4914                 88  CHECK-NO-MANUAL            VALUE '1'.
  4915                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4916                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4917                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4918             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4919                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  4920
  4921         16  CF-DOMICILE-STATE              PIC XX.
  4922
  4923         16  CF-EXPENSE-CONTROLS.
  4924             20  CF-EXPENSE-METHOD          PIC X.
  4925                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4926                 88  DOLLARS-PER-PMT            VALUE '2'.
  4927                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4928                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4929             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4930             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4931
  4932         16  CF-CORRESPONDENCE-CONTROL.
  4933             20  CF-LETTER-RESEND-OPT       PIC X.
  4934                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4935                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4936             20  FILLER                     PIC X(4).
  4937
  4938         16  CF-RESERVE-CONTROLS.
  4939             20  CF-MANUAL-SW               PIC X.
  4940                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4941             20  CF-FUTURE-SW               PIC X.
  4942                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4943             20  CF-PTC-SW                  PIC X.
  4944                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4945             20  CF-IBNR-SW                 PIC X.
  4946                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4947             20  CF-PTC-LF-SW               PIC X.
  4948                 88  CF-LF-PTC-USED             VALUE '1'.
  4949             20  CF-CDT-ACCESS-METHOD       PIC X.
  4950                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4951                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4952                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  95
* EL156.cbl
  4953             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4954
  4955         16  CF-CLAIM-CALC-METHOD           PIC X.
  4956             88  360-PLUS-MONTHS                VALUE '1'.
  4957             88  365-PLUS-MONTHS                VALUE '2'.
  4958             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4959             88  360-DAILY                      VALUE '4'.
  4960             88  365-DAILY                      VALUE '5'.
  4961
  4962         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4963         16  FILLER                         PIC X(11).
  4964
  4965         16  CF-LIMIT-AMOUNTS.
  4966             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4967             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4968             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4969             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4970             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4971             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4972             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4973             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4974             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4975             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4976
  4977         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  4978         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4979         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4980
  4981         16  CF-ZIP-CODE.
  4982             20  CF-ZIP-PRIME.
  4983                 24  CF-ZIP-1ST             PIC X.
  4984                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4985                 24  FILLER                 PIC X(4).
  4986             20  CF-ZIP-PLUS4               PIC X(4).
  4987         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4988             20  CF-CAN-POSTAL-1            PIC XXX.
  4989             20  CF-CAN-POSTAL-2            PIC XXX.
  4990             20  FILLER                     PIC XXX.
  4991
  4992         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4993         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4994         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4995
  4996         16  CF-RATING-SWITCH               PIC X.
  4997             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4998             88  CF-NO-RATING                   VALUE 'N'.
  4999
  5000         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  5001
  5002         16  CF-CARRIER-OVER-SHORT.
  5003             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5004             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5005
  5006         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  5007         16  CF-SECPAY-SWITCH               PIC X.
  5008             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  5009             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  5010         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  96
* EL156.cbl
  5011         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  5012         16  FILLER                         PIC X(444).
  5013*        16  FILLER                         PIC X(452).
  5014
  5015
  5016****************************************************************
  5017*             MORTALITY MASTER RECORD                          *
  5018****************************************************************
  5019
  5020     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5021         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  5022                                INDEXED BY CF-MORT-NDX.
  5023             20  CF-MORT-TABLE              PIC X(5).
  5024             20  CF-MORT-TABLE-TYPE         PIC X.
  5025                 88  CF-MORT-JOINT              VALUE 'J'.
  5026                 88  CF-MORT-SINGLE             VALUE 'S'.
  5027                 88  CF-MORT-COMBINED           VALUE 'C'.
  5028                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  5029                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  5030             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  5031             20  CF-MORT-AGE-METHOD         PIC XX.
  5032                 88  CF-AGE-LAST                VALUE 'AL'.
  5033                 88  CF-AGE-NEAR                VALUE 'AN'.
  5034             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  5035             20  CF-MORT-ADJUSTMENT-DIRECTION
  5036                                            PIC X.
  5037                 88  CF-MINUS                   VALUE '-'.
  5038                 88  CF-PLUS                    VALUE '+'.
  5039             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  5040             20  CF-MORT-JOINT-CODE         PIC X.
  5041                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  5042             20  CF-MORT-PC-Q               PIC X.
  5043                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  5044             20  CF-MORT-TABLE-CODE         PIC X(4).
  5045             20  CF-MORT-COMMENTS           PIC X(15).
  5046             20  FILLER                     PIC X(14).
  5047
  5048         16  FILLER                         PIC X(251).
  5049
  5050
  5051****************************************************************
  5052*             BUSSINESS TYPE MASTER RECORD                     *
  5053****************************************************************
  5054
  5055     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5056* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  5057* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  5058* AND RECORD 05 IS TYPES 81-99
  5059         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  5060             20  CF-BUSINESS-TITLE          PIC  X(19).
  5061             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  5062                                            PIC S9V9(4) COMP-3.
  5063             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  5064             20  FILLER                     PIC  X.
  5065         16  FILLER                         PIC  X(248).
  5066
  5067
  5068****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  97
* EL156.cbl
  5069*             TERMINAL MASTER RECORD                           *
  5070****************************************************************
  5071
  5072     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5073
  5074         16  CF-COMPANY-TERMINALS.
  5075             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  5076                                  PIC X(4).
  5077         16  FILLER               PIC X(248).
  5078
  5079
  5080****************************************************************
  5081*             LIFE EDIT MASTER RECORD                          *
  5082****************************************************************
  5083
  5084     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5085         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  5086             20  CF-LIFE-CODE-IN            PIC XX.
  5087             20  CF-LIFE-CODE-OUT           PIC XX.
  5088         16  FILLER                         PIC X(248).
  5089
  5090
  5091****************************************************************
  5092*             AH EDIT MASTER RECORD                            *
  5093****************************************************************
  5094
  5095     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5096         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  5097             20  CF-AH-CODE-IN              PIC XXX.
  5098             20  CF-AH-CODE-OUT             PIC XX.
  5099         16  FILLER                         PIC X(248).
  5100
  5101
  5102****************************************************************
  5103*             CREDIBILITY TABLES                               *
  5104****************************************************************
  5105
  5106     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  5107         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  5108                             INDEXED BY CF-CRDB-NDX.
  5109             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  5110             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  5111             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  5112         16  FILLER                         PIC  X(332).
  5113
  5114
  5115****************************************************************
  5116*             REPORT CUSTOMIZATION RECORD                      *
  5117****************************************************************
  5118
  5119     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  5120         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  5121             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  5122             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  5123             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  5124**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  5125****       A T-TRANSFER.                                   ****
  5126             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  98
* EL156.cbl
  5127
  5128         16  FILLER                         PIC XX.
  5129
  5130         16  CF-CARRIER-CNTL-OPT.
  5131             20  CF-CARRIER-OPT-SEQ         PIC 9.
  5132                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  5133                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  5134             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  5135                                            PIC X.
  5136         16  CF-GROUP-CNTL-OPT.
  5137             20  CF-GROUP-OPT-SEQ           PIC 9.
  5138                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  5139                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  5140             20  CF-GROUP-SELECT OCCURS 3 TIMES
  5141                                            PIC X(6).
  5142         16  CF-STATE-CNTL-OPT.
  5143             20  CF-STATE-OPT-SEQ           PIC 9.
  5144                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  5145                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  5146             20  CF-STATE-SELECT OCCURS 3 TIMES
  5147                                            PIC XX.
  5148         16  CF-ACCOUNT-CNTL-OPT.
  5149             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  5150                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  5151                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  5152             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  5153                                            PIC X(10).
  5154         16  CF-BUS-TYP-CNTL-OPT.
  5155             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  5156                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  5157                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  5158             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  5159                                            PIC XX.
  5160         16  CF-LF-TYP-CNTL-OPT.
  5161             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  5162                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  5163                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  5164             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  5165                                            PIC XX.
  5166         16  CF-AH-TYP-CNTL-OPT.
  5167             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  5168                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  5169                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  5170             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  5171                                            PIC XX.
  5172         16  CF-REPTCD1-CNTL-OPT.
  5173             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  5174                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  5175                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  5176             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  5177                                            PIC X(10).
  5178         16  CF-REPTCD2-CNTL-OPT.
  5179             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  5180                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  5181                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  5182             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  5183                                            PIC X(10).
  5184         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page  99
* EL156.cbl
  5185             20  CF-USER1-OPT-SEQ           PIC 9.
  5186                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  5187                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  5188             20  CF-USER1-SELECT OCCURS 3 TIMES
  5189                                            PIC X(10).
  5190         16  CF-USER2-CNTL-OPT.
  5191             20  CF-USER2-OPT-SEQ           PIC 9.
  5192                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  5193                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  5194             20  CF-USER2-SELECT OCCURS 3 TIMES
  5195                                            PIC X(10).
  5196         16  CF-USER3-CNTL-OPT.
  5197             20  CF-USER3-OPT-SEQ           PIC 9.
  5198                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  5199                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  5200             20  CF-USER3-SELECT OCCURS 3 TIMES
  5201                                            PIC X(10).
  5202         16  CF-USER4-CNTL-OPT.
  5203             20  CF-USER4-OPT-SEQ           PIC 9.
  5204                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  5205                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  5206             20  CF-USER4-SELECT OCCURS 3 TIMES
  5207                                            PIC X(10).
  5208         16  CF-USER5-CNTL-OPT.
  5209             20  CF-USER5-OPT-SEQ           PIC 9.
  5210                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  5211                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  5212             20  CF-USER5-SELECT OCCURS 3 TIMES
  5213                                            PIC X(10).
  5214         16  CF-REINS-CNTL-OPT.
  5215             20  CF-REINS-OPT-SEQ           PIC 9.
  5216                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  5217                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  5218             20  CF-REINS-SELECT OCCURS 3 TIMES.
  5219                 24  CF-REINS-PRIME         PIC XXX.
  5220                 24  CF-REINS-SUB           PIC XXX.
  5221
  5222         16  CF-AGENT-CNTL-OPT.
  5223             20  CF-AGENT-OPT-SEQ           PIC 9.
  5224                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  5225                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  5226             20  CF-AGENT-SELECT OCCURS 3 TIMES
  5227                                            PIC X(10).
  5228
  5229         16  FILLER                         PIC X(43).
  5230
  5231         16  CF-LOSS-RATIO-SELECT.
  5232             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  5233             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  5234         16  CF-ENTRY-DATE-SELECT.
  5235             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  5236             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  5237         16  CF-EFFECTIVE-DATE-SELECT.
  5238             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  5239             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  5240
  5241         16  CF-EXCEPTION-LIST-IND          PIC X.
  5242             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 100
* EL156.cbl
  5243
  5244         16  FILLER                         PIC X(318).
  5245
  5246****************************************************************
  5247*                  EXCEPTION REPORTING RECORD                  *
  5248****************************************************************
  5249
  5250     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  5251         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  5252             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  5253
  5254         16  CF-COMBINED-LIFE-AH-OPT.
  5255             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  5256             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  5257             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  5258             20  CF-CANCELLATION-RATIO      PIC S9(02).
  5259
  5260         16  CF-LIFE-OPT.
  5261             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5262             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5263             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5264             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5265             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5266             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5267             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5268             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5269             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5270             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  5271
  5272         16  CF-AH-OPT.
  5273             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  5274             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  5275             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  5276             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  5277             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  5278             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  5279             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  5280             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  5281             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  5282             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  5283
  5284         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  5285             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  5286             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  5287             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  5288
  5289         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  5290
  5291         16  FILLER                         PIC X(673).
  5292
  5293
  5294****************************************************************
  5295*             MORTGAGE SYSTEM PLAN RECORD                      *
  5296****************************************************************
  5297
  5298     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  5299         16  CF-PLAN-TYPE                   PIC X.
  5300             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 101
* EL156.cbl
  5301             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  5302             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  5303         16  CF-PLAN-ABBREV                 PIC XXX.
  5304         16  CF-PLAN-DESCRIPT               PIC X(10).
  5305         16  CF-PLAN-NOTES                  PIC X(20).
  5306         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  5307         16  CF-PLAN-UNDERWRITING.
  5308             20  CF-PLAN-TERM-DATA.
  5309                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  5310                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  5311             20  CF-PLAN-AGE-DATA.
  5312                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  5313                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  5314                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  5315             20  CF-PLAN-BENEFIT-DATA.
  5316                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5317                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  5318                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  5319                                            PIC S9(7)V99  COMP-3.
  5320         16  CF-PLAN-POLICY-FORMS.
  5321             20  CF-POLICY-FORM             PIC X(12).
  5322             20  CF-MASTER-APPLICATION      PIC X(12).
  5323             20  CF-MASTER-POLICY           PIC X(12).
  5324         16  CF-PLAN-RATING.
  5325             20  CF-RATE-CODE               PIC X(5).
  5326             20  CF-SEX-RATING              PIC X.
  5327                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  5328                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  5329             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  5330             20  CF-SUB-STD-TYPE            PIC X.
  5331                 88  CF-PCT-OF-PREM            VALUE '1'.
  5332                 88  CF-PCT-OF-BENE            VALUE '2'.
  5333         16  CF-PLAN-PREM-TOLERANCES.
  5334             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  5335             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  5336         16  CF-PLAN-PYMT-TOLERANCES.
  5337             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  5338             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  5339         16  CF-PLAN-MISC-DATA.
  5340             20  FILLER                     PIC X.
  5341             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  5342             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  5343         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  5344         16  CF-PLAN-IND-GRP                PIC X.
  5345             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  5346                                                     '1'.
  5347             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  5348                                                     '2'.
  5349         16  CF-MIB-SEARCH-SW               PIC X.
  5350             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  5351             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  5352             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  5353             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  5354         16  CF-ALPHA-SEARCH-SW             PIC X.
  5355             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  5356             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  5357             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  5358             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 102
* EL156.cbl
  5359             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  5360             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  5361             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  5362             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  5363             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  5364             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  5365                                                     'A' 'B' 'C'
  5366                                                     'X' 'Y' 'Z'.
  5367         16  CF-EFF-DT-RULE-SW              PIC X.
  5368             88  CF-EFF-DT-ENTER               VALUE 'E'.
  5369             88  CF-EFF-DT-MONTH               VALUE 'M'.
  5370             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  5371             88  CF-EFF-DT-SEMI                VALUE 'S'.
  5372             88  CF-EFF-DT-ANN                 VALUE 'A'.
  5373         16  FILLER                         PIC X(4).
  5374         16  CF-HEALTH-QUESTIONS            PIC X.
  5375             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  5376         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  5377         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  5378         16  CF-PLAN-SNGL-JNT               PIC X.
  5379             88  CF-COMBINED-PLAN              VALUE 'C'.
  5380             88  CF-JNT-PLAN                   VALUE 'J'.
  5381             88  CF-SNGL-PLAN                  VALUE 'S'.
  5382         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  5383         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  5384         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  5385         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  5386         16  CF-RERATE-CNTL                 PIC  X.
  5387             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  5388             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  5389             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  5390             88  CF-AUTO-RECALC                 VALUE '4'.
  5391         16  CF-BENEFIT-TYPE                PIC  X.
  5392             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  5393             88  CF-BENEFIT-REDUCES             VALUE '2'.
  5394         16  CF-POLICY-FEE                  PIC S999V99
  5395                                                    COMP-3.
  5396         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  5397         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  5398         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  5399         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  5400         16  FILLER                         PIC  X(32).
  5401         16  CF-TERMINATION-FORM            PIC  X(04).
  5402         16  FILLER                         PIC  X(08).
  5403         16  CF-CLAIM-CAP                   PIC S9(7)V99
  5404                                                       COMP-3.
  5405         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  5406         16  CF-ISSUE-LETTER                PIC  X(4).
  5407         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  5408         16  CF-DEPENDENT-COVERAGE          PIC  X.
  5409             88  CF-YES-DEP-COV                 VALUE 'Y'.
  5410             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  5411         16  CF-MP-REFUND-CALC              PIC X.
  5412             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  5413             88  CF-MP-REFD-BY-R78              VALUE '1'.
  5414             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  5415             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  5416             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 103
* EL156.cbl
  5417             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  5418             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  5419             88  CF-MP-REFD-MEAN                VALUE '8'.
  5420         16  CF-ALT-RATE-CODE               PIC  X(5).
  5421
  5422
  5423         16  FILLER                         PIC X(498).
  5424****************************************************************
  5425*             MORTGAGE COMPANY MASTER RECORD                   *
  5426****************************************************************
  5427
  5428     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5429         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  5430         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  5431             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  5432             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  5433             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  5434             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  5435             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  5436
  5437         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  5438         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  5439         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  5440         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  5441         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  5442
  5443         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  5444             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  5445         16  CF-MP-RECON-USE-IND            PIC X(1).
  5446             88  CF-MP-USE-RECON             VALUE 'Y'.
  5447         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  5448             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  5449         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  5450             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  5451             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  5452         16  FILLER                         PIC X(1).
  5453         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  5454             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  5455         16  CF-MORTG-MIB-VERSION           PIC X.
  5456             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  5457             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  5458             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  5459         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  5460             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  5461                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  5462             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  5463                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  5464             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  5465                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  5466             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  5467                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  5468             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  5469                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  5470             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  5471                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  5472         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  5473         16  FILLER                         PIC X(7).
  5474         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 104
* EL156.cbl
  5475             20  CF-MORTG-MIB-COMM          PIC X(5).
  5476             20  CF-MORTG-MIB-TERM          PIC X(5).
  5477         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  5478             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  5479         16  FILLER                         PIC X(03).
  5480         16  CF-MP-CHECK-NO-CONTROL.
  5481             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  5482                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  5483                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  5484                                                ' ' LOW-VALUES.
  5485                 88  CF-MP-CHECK-NO-PRE-PRINTED
  5486                                               VALUE '3'.
  5487         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  5488         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  5489         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  5490             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  5491                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  5492             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  5493                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  5494             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  5495                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  5496             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  5497                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  5498             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  5499                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  5500             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  5501                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  5502         16  CF-MORTG-BILLING-AREA.
  5503             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  5504                                            PIC X.
  5505         16  CF-MORTG-MONTH-END-DT          PIC XX.
  5506         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  5507         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  5508         16  CF-MORTG-MIB-DEST-SW           PIC X.
  5509             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  5510             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  5511         16  FILLER                         PIC X.
  5512         16  CF-MORTG-LABEL-CONTROL         PIC X.
  5513             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  5514             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  5515         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  5516         16  FILLER                         PIC X(8).
  5517         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  5518         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  5519         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  5520         16  CF-ACH-COMPANY-ID.
  5521             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  5522                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  5523                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  5524                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  5525             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  5526         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  5527             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  5528         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  5529             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  5530             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  5531         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  5532         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 105
* EL156.cbl
  5533         16  FILLER                         PIC X(536).
  5534
  5535****************************************************************
  5536*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  5537****************************************************************
  5538
  5539     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  5540         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  5541             20  CF-FEMALE-HEIGHT.
  5542                 24  CF-FEMALE-FT           PIC 99.
  5543                 24  CF-FEMALE-IN           PIC 99.
  5544             20  CF-FEMALE-MIN-WT           PIC 999.
  5545             20  CF-FEMALE-MAX-WT           PIC 999.
  5546         16  FILLER                         PIC X(428).
  5547
  5548     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  5549         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  5550             20  CF-MALE-HEIGHT.
  5551                 24  CF-MALE-FT             PIC 99.
  5552                 24  CF-MALE-IN             PIC 99.
  5553             20  CF-MALE-MIN-WT             PIC 999.
  5554             20  CF-MALE-MAX-WT             PIC 999.
  5555         16  FILLER                         PIC X(428).
  5556******************************************************************
  5557*             AUTOMATIC ACTIVITY RECORD                          *
  5558******************************************************************
  5559     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  5560         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  5561             20  CF-SYS-ACTIVE-SW           PIC X(01).
  5562             20  CF-SYS-LETTER-ID           PIC X(04).
  5563             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  5564             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  5565             20  CF-SYS-RESET-SW            PIC X(01).
  5566             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  5567             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  5568
  5569         16  FILLER                         PIC X(50).
  5570
  5571         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  5572             20  CF-USER-ACTIVE-SW          PIC X(01).
  5573             20  CF-USER-LETTER-ID          PIC X(04).
  5574             20  CF-USER-RESEND-DAYS        PIC 9(03).
  5575             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  5576             20  CF-USER-RESET-SW           PIC X(01).
  5577             20  CF-USER-REPORT-DAYS        PIC 9(03).
  5578             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  5579             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  5580
  5581         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 106
* EL156.cbl
  5583*    COPY ELCCERT.
  5584******************************************************************
  5585*                                                                *
  5586*                            ELCCERT.                            *
  5587*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5588*                            VMOD=2.013                          *
  5589*                                                                *
  5590*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  5591*                                                                *
  5592*   FILE TYPE = VSAM,KSDS                                        *
  5593*   RECORD SIZE = 450  RECFORM = FIXED                           *
  5594*                                                                *
  5595*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  5596*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  5597*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  5598*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  5599*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  5600*                                                                *
  5601*   LOG = YES                                                    *
  5602*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5603******************************************************************
  5604*                   C H A N G E   L O G
  5605*
  5606* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5607*-----------------------------------------------------------------
  5608*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5609* EFFECTIVE    NUMBER
  5610*-----------------------------------------------------------------
  5611* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5612* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5613* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  5614* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5615* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5616* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  5617* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5618* 032612  CR2011110200001  PEMA  AHL CHANGES
  5619* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5620******************************************************************
  5621
  5622 01  CERTIFICATE-MASTER.
  5623     12  CM-RECORD-ID                      PIC XX.
  5624         88  VALID-CM-ID                      VALUE 'CM'.
  5625
  5626     12  CM-CONTROL-PRIMARY.
  5627         16  CM-COMPANY-CD                 PIC X.
  5628         16  CM-CARRIER                    PIC X.
  5629         16  CM-GROUPING.
  5630             20  CM-GROUPING-PREFIX        PIC X(3).
  5631             20  CM-GROUPING-PRIME         PIC X(3).
  5632         16  CM-STATE                      PIC XX.
  5633         16  CM-ACCOUNT.
  5634             20  CM-ACCOUNT-PREFIX         PIC X(4).
  5635             20  CM-ACCOUNT-PRIME          PIC X(6).
  5636         16  CM-CERT-EFF-DT                PIC XX.
  5637         16  CM-CERT-NO.
  5638             20  CM-CERT-PRIME             PIC X(10).
  5639             20  CM-CERT-SFX               PIC X.
  5640
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 107
* EL156.cbl
  5641     12  CM-CONTROL-BY-NAME.
  5642         16  CM-COMPANY-CD-A1              PIC X.
  5643         16  CM-INSURED-LAST-NAME          PIC X(15).
  5644         16  CM-INSURED-INITIALS.
  5645             20  CM-INSURED-INITIAL1       PIC X.
  5646             20  CM-INSURED-INITIAL2       PIC X.
  5647
  5648     12  CM-CONTROL-BY-SSN.
  5649         16  CM-COMPANY-CD-A2              PIC X.
  5650         16  CM-SOC-SEC-NO.
  5651             20  CM-SSN-STATE              PIC XX.
  5652             20  CM-SSN-ACCOUNT            PIC X(6).
  5653             20  CM-SSN-LN3.
  5654                 25  CM-INSURED-INITIALS-A2.
  5655                     30 CM-INSURED-INITIAL1-A2   PIC X.
  5656                     30 CM-INSURED-INITIAL2-A2   PIC X.
  5657                 25 CM-PART-LAST-NAME-A2         PIC X.
  5658
  5659     12  CM-CONTROL-BY-CERT-NO.
  5660         16  CM-COMPANY-CD-A4              PIC X.
  5661         16  CM-CERT-NO-A4                 PIC X(11).
  5662
  5663     12  CM-CONTROL-BY-MEMB.
  5664         16  CM-COMPANY-CD-A5              PIC X.
  5665         16  CM-MEMBER-NO.
  5666             20  CM-MEMB-STATE             PIC XX.
  5667             20  CM-MEMB-ACCOUNT           PIC X(6).
  5668             20  CM-MEMB-LN4.
  5669                 25  CM-INSURED-INITIALS-A5.
  5670                     30 CM-INSURED-INITIAL1-A5   PIC X.
  5671                     30 CM-INSURED-INITIAL2-A5   PIC X.
  5672                 25 CM-PART-LAST-NAME-A5         PIC XX.
  5673
  5674     12  CM-INSURED-PROFILE-DATA.
  5675         16  CM-INSURED-FIRST-NAME.
  5676             20  CM-INSURED-1ST-INIT       PIC X.
  5677             20  FILLER                    PIC X(9).
  5678         16  CM-INSURED-ISSUE-AGE          PIC 99.
  5679         16  CM-INSURED-SEX                PIC X.
  5680             88  CM-SEX-MALE                  VALUE 'M'.
  5681             88  CM-SEX-FEMAL                 VALUE 'F'.
  5682         16  CM-INSURED-JOINT-AGE          PIC 99.
  5683         16  CM-JOINT-INSURED-NAME.
  5684             20  CM-JT-LAST-NAME           PIC X(15).
  5685             20  CM-JT-FIRST-NAME.
  5686                 24  CM-JT-1ST-INIT        PIC X.
  5687                 24  FILLER                PIC X(9).
  5688             20  CM-JT-INITIAL             PIC X.
  5689
  5690     12  CM-LIFE-DATA.
  5691         16  CM-LF-BENEFIT-CD              PIC XX.
  5692         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  5693         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  5694         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  5695         16  CM-LF-DEV-CODE                PIC XXX.
  5696         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5697         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  5698         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 108
* EL156.cbl
  5699         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  5700         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5701         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5702         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  5703         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5704         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  5705         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5706         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5707         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  5708         16  cm-temp-epiq                  pic xx.
  5709             88  EPIQ-CLASS                  value 'EQ'.
  5710*        16  FILLER                        PIC XX.
  5711
  5712     12  CM-AH-DATA.
  5713         16  CM-AH-BENEFIT-CD              PIC XX.
  5714         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  5715         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  5716         16  CM-AH-DEV-CODE                PIC XXX.
  5717         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  5718         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  5719         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  5720         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  5721         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5722         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  5723         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  5724         16  CM-AH-PAID-THRU-DT            PIC XX.
  5725             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  5726         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  5727         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  5728         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  5729         16  FILLER                        PIC X.
  5730
  5731     12  CM-LOAN-INFORMATION.
  5732         16  CM-LIVES                      PIC S9(7)     COMP-3.
  5733         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  5734                                           PIC S9(5)V99  COMP-3.
  5735         16  CM-BILLED                     PIC S9(7)     COMP-3.
  5736         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  5737         16  CM-PAY-FREQUENCY              PIC S99.
  5738         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  5739         16  CM-RATE-CLASS                 PIC XX.
  5740         16  CM-BENEFICIARY                PIC X(25).
  5741         16  CM-POLICY-FORM-NO             PIC X(12).
  5742         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5743         16  CM-LAST-ADD-ON-DT             PIC XX.
  5744         16  CM-DEDUCTIBLE-AMOUNTS.
  5745             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5746             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5747         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5748             20  CM-RESIDENT-STATE         PIC XX.
  5749             20  CM-RATE-CODE              PIC X(4).
  5750             20  FILLER                    PIC XX.
  5751         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5752             20  CM-LOAN-OFFICER           PIC X(5).
  5753             20  FILLER                    PIC XXX.
  5754         16  CM-CSR-CODE                   PIC XXX.
  5755         16  CM-UNDERWRITING-CODE          PIC X.
  5756             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 109
* EL156.cbl
  5757         16  CM-POST-CARD-IND              PIC X.
  5758         16  CM-NH-INTERFACE-SW            PIC X.
  5759         16  CM-PREMIUM-TYPE               PIC X.
  5760             88  CM-SING-PRM                  VALUE '1'.
  5761             88  CM-O-B-COVERAGE              VALUE '2'.
  5762             88  CM-OPEN-END                  VALUE '3'.
  5763         16  CM-IND-GRP-TYPE               PIC X.
  5764             88  CM-INDIVIDUAL                VALUE 'I'.
  5765             88  CM-GROUP                     VALUE 'G'.
  5766         16  CM-SKIP-CODE                  PIC X.
  5767             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5768             88  SKIP-JULY                    VALUE '1'.
  5769             88  SKIP-AUGUST                  VALUE '2'.
  5770             88  SKIP-SEPTEMBER               VALUE '3'.
  5771             88  SKIP-JULY-AUG                VALUE '4'.
  5772             88  SKIP-AUG-SEPT                VALUE '5'.
  5773             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5774             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5775             88  SKIP-JUNE                    VALUE '8'.
  5776             88  SKIP-JUNE-JULY               VALUE '9'.
  5777             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5778             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5779         16  CM-PAYMENT-MODE               PIC X.
  5780             88  PAY-MONTHLY                  VALUE SPACE.
  5781             88  PAY-WEEKLY                   VALUE '1'.
  5782             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5783             88  PAY-BI-WEEKLY                VALUE '3'.
  5784             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5785         16  CM-LOAN-NUMBER                PIC X(8).
  5786         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5787         16  CM-OLD-LOF                    PIC XXX.
  5788*        16  CM-LOAN-OFFICER               PIC XXX.
  5789         16  CM-REIN-TABLE                 PIC XXX.
  5790         16  CM-SPECIAL-REIN-CODE          PIC X.
  5791         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5792         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5793         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5794
  5795     12  CM-STATUS-DATA.
  5796         16  CM-ENTRY-STATUS               PIC X.
  5797         16  CM-ENTRY-DT                   PIC XX.
  5798
  5799         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5800         16  CM-LF-CANCEL-DT               PIC XX.
  5801         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5802
  5803         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5804         16  CM-LF-DEATH-DT                PIC XX.
  5805         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5806
  5807         16  CM-LF-CURRENT-STATUS          PIC X.
  5808             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5809                                                'M' '4' '5' '9'.
  5810             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5811             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5812             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5813             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5814             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 110
* EL156.cbl
  5815             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5816             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5817             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5818             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5819             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5820             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5821             88  CM-LF-DECLINED               VALUE 'D'.
  5822             88  CM-LF-VOIDED                 VALUE 'V'.
  5823
  5824         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5825         16  CM-AH-CANCEL-DT               PIC XX.
  5826         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5827
  5828         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5829         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5830         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5831
  5832         16  CM-AH-CURRENT-STATUS          PIC X.
  5833             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5834                                                'M' '4' '5' '9'.
  5835             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5836             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5837             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5838             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5839             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5840             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5841             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5842             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5843             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5844             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5845             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5846             88  CM-AH-DECLINED               VALUE 'D'.
  5847             88  CM-AH-VOIDED                 VALUE 'V'.
  5848
  5849         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5850             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5851             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5852             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5853         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5854
  5855         16  CM-ENTRY-BATCH                PIC X(6).
  5856         16  CM-LF-EXIT-BATCH              PIC X(6).
  5857         16  CM-AH-EXIT-BATCH              PIC X(6).
  5858         16  CM-LAST-MONTH-END             PIC XX.
  5859
  5860     12  CM-NOTE-SW                        PIC X.
  5861         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5862         88  CERT-NOTES-PRESENT               VALUE '1'.
  5863         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5864         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5865         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5866         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5867         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5868         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5869     12  CM-COMP-EXCP-SW                   PIC X.
  5870         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5871         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5872     12  CM-INSURED-ADDRESS-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 111
* EL156.cbl
  5873         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5874         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5875
  5876*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5877     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5878     12  FILLER                            PIC X.
  5879
  5880*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5881     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5882     12  FILLER                            PIC X.
  5883*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5884     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5885
  5886     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5887         88  CERT-ADDED-BATCH                 VALUE ' '.
  5888         88  CERT-ADDED-ONLINE                VALUE '1'.
  5889         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5890         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5891         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5892     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5893         88  CERT-AS-LOADED                   VALUE ' '.
  5894         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5895         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5896         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5897         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5898         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5899         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5900         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5901
  5902     12  CM-ACCOUNT-COMM-PCTS.
  5903         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5904         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5905
  5906     12  CM-USER-FIELD                     PIC X.
  5907     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5908     12  CM-CLP-STATE                      PIC XX.
  5909     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5910     12  CM-USER-RESERVED                  PIC XXX.
  5911     12  FILLER REDEFINES CM-USER-RESERVED.
  5912         16  CM-AH-CLASS-CD                PIC XX.
  5913         16  F                             PIC X.
  5914******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 112
* EL156.cbl
  5916*    COPY ELCTRLR.
  5917******************************************************************
  5918*                                                                *
  5919*                            ELCTRLR.                            *
  5920*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5921*                            VMOD=2.014                          *
  5922*                                                                *
  5923*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  5924*                                                                *
  5925*   FILE TYPE = VSAM,KSDS                                        *
  5926*   RECORD SIZE = 200    RECFORM = FIXED                         *
  5927*                                                                *
  5928*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  5929*       ALTERNATE INDEX = NONE                                   *
  5930*                                                                *
  5931*   LOG = YES                                                    *
  5932*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5933******************************************************************
  5934*                   C H A N G E   L O G
  5935*
  5936* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5937*-----------------------------------------------------------------
  5938*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5939* EFFECTIVE    NUMBER
  5940*-----------------------------------------------------------------
  5941* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  5942* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  5943* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  5944* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  5945* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  5946* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  5947* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  5948* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  5949* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  5950* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  5951* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  5952* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  5953* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  5954* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  5955* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  5956* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5957* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  5958* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  5959* 040814    2014030500002  AJRA  ADD ICD CODES
  5960* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5961******************************************************************
  5962 01  ACTIVITY-TRAILERS.
  5963     12  AT-RECORD-ID                    PIC XX.
  5964         88  VALID-AT-ID                       VALUE 'AT'.
  5965
  5966     12  AT-CONTROL-PRIMARY.
  5967         16  AT-COMPANY-CD               PIC X.
  5968         16  AT-CARRIER                  PIC X.
  5969         16  AT-CLAIM-NO                 PIC X(7).
  5970         16  AT-CERT-NO.
  5971             20  AT-CERT-PRIME           PIC X(10).
  5972             20  AT-CERT-SFX             PIC X.
  5973         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 113
* EL156.cbl
  5974             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  5975             88  AT-LAST-TRL-AVAIL            VALUE +100.
  5976             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  5977             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  5978             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  5979             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  5980             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  5981             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  5982             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  5983             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  5984             88  AT-DIAGNOSIS-TRL             VALUE +90.
  5985             88  AT-BENEFICIARY-TRL           VALUE +91.
  5986             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  5987             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  5988             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  5989             88  AT-ERROR-MSGS-TRL            VALUE +95.
  5990
  5991     12  AT-TRAILER-TYPE                 PIC X.
  5992         88  RESERVE-EXPENSE-TR               VALUE '1'.
  5993         88  PAYMENT-TR                       VALUE '2'.
  5994         88  AUTO-PAY-TR                      VALUE '3'.
  5995         88  CORRESPONDENCE-TR                VALUE '4'.
  5996         88  ADDRESS-TR                       VALUE '5'.
  5997         88  GENERAL-INFO-TR                  VALUE '6'.
  5998         88  AUTO-PROMPT-TR                   VALUE '7'.
  5999         88  DENIAL-TR                        VALUE '8'.
  6000         88  INCURRED-CHG-TR                  VALUE '9'.
  6001         88  FORM-CONTROL-TR                  VALUE 'A'.
  6002
  6003     12  AT-RECORDED-DT                  PIC XX.
  6004     12  AT-RECORDED-BY                  PIC X(4).
  6005     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  6006
  6007     12  AT-TRAILER-BODY                 PIC X(165).
  6008
  6009     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  6010         16  AT-RESERVE-CONTROLS.
  6011             20  AT-MANUAL-SW            PIC X.
  6012                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  6013             20  AT-FUTURE-SW            PIC X.
  6014                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  6015             20  AT-PTC-SW               PIC X.
  6016                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  6017             20  AT-IBNR-SW              PIC X.
  6018                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  6019             20  AT-PTC-LF-SW            PIC X.
  6020                 88  AT-LF-PTC-USED          VALUE '1'.
  6021             20  AT-CDT-ACCESS-METHOD    PIC X.
  6022                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  6023                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  6024                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  6025             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  6026         16  AT-LAST-COMPUTED-DT         PIC XX.
  6027         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
  6028         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  6029         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  6030         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  6031         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 114
* EL156.cbl
  6032         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  6033         16  AT-EXPENSE-CONTROLS.
  6034             20  AT-EXPENSE-METHOD       PIC X.
  6035                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  6036                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  6037                 88  PERCENT-OF-PMT           VALUE '3'.
  6038                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  6039             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  6040             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  6041         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  6042         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  6043
  6044         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  6045         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  6046
  6047*        16  FILLER                      PIC X(53).
  6048         16  FILLER                      PIC X(47).
  6049
  6050         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  6051         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  6052
  6053         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  6054             20  AT-OPEN-CLOSE-DATE      PIC XX.
  6055             20  AT-OPEN-CLOSE-TYPE      PIC X.
  6056*                    C = CLOSED
  6057*                    O = OPEN
  6058             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  6059*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  6060
  6061     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  6062         16  AT-PAYMENT-TYPE             PIC X.
  6063             88  PARTIAL-PAYMENT                VALUE '1'.
  6064             88  FINAL-PAYMENT                  VALUE '2'.
  6065             88  LUMP-SUM-PAYMENT               VALUE '3'.
  6066             88  ADDITIONAL-PAYMENT             VALUE '4'.
  6067             88  CHARGEABLE-EXPENSE             VALUE '5'.
  6068             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  6069             88  VOIDED-PAYMENT                 VALUE '9'.
  6070             88  TRANSFER                       VALUE 'T'.
  6071             88  LIFE-INTEREST                  VALUE 'I'.
  6072
  6073         16  AT-CLAIM-TYPE               PIC X.
  6074             88  PAID-FOR-AH                    VALUE 'A'.
  6075             88  PAID-FOR-LIFE                  VALUE 'L'.
  6076             88  PAID-FOR-IUI                   VALUE 'I'.
  6077             88  PAID-FOR-GAP                   VALUE 'G'.
  6078             88  PAID-FOR-FAM                   VALUE 'F'.
  6079         16  AT-CLAIM-PREM-TYPE          PIC X.
  6080             88  AT-SINGLE-PREMIUM              VALUE '1'.
  6081             88  AT-O-B-COVERAGE                VALUE '2'.
  6082             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  6083         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  6084         16  AT-CHECK-NO                 PIC X(7).
  6085         16  AT-PAID-FROM-DT             PIC XX.
  6086         16  AT-PAID-THRU-DT             PIC XX.
  6087         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  6088         16  FILLER                      PIC X.
  6089         16  AT-PAYEES-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 115
* EL156.cbl
  6090         16  AT-PAYMENT-ORIGIN           PIC X.
  6091             88  ONLINE-MANUAL-PMT              VALUE '1'.
  6092             88  ONLINE-AUTO-PMT                VALUE '2'.
  6093             88  OFFLINE-PMT                    VALUE '3'.
  6094         16  AT-CHECK-WRITTEN-DT         PIC XX.
  6095         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  6096         16  AT-VOID-DATA.
  6097             20  AT-VOID-DT              PIC XX.
  6098*00144       20  AT-VOID-REASON          PIC X(30).
  6099             20  AT-VOID-REASON          PIC X(26).
  6100         16  AT-PMT-APPROVED-BY          PIC X(04).
  6101         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  6102         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  6103         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  6104                                         PIC S99V9(5)  COMP-3.
  6105         16  AT-CREDIT-INTERFACE.
  6106             20  AT-PMT-SELECT-DT        PIC XX.
  6107                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  6108             20  AT-PMT-ACCEPT-DT        PIC XX.
  6109                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  6110             20  AT-VOID-SELECT-DT       PIC XX.
  6111                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  6112             20  AT-VOID-ACCEPT-DT       PIC XX.
  6113                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  6114
  6115         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  6116                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  6117                 88  CONVERSION-PAYMENT           VALUE +99999999.
  6118         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  6119
  6120         16  AT-FORCE-CONTROL            PIC X.
  6121             88  PAYMENT-WAS-FORCED           VALUE '1'.
  6122         16  AT-PREV-LAST-PMT-DT         PIC XX.
  6123         16  AT-PREV-PAID-THRU-DT        PIC XX.
  6124         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6125         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  6126         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  6127         16  AT-BENEFIT-TYPE             PIC X.
  6128
  6129         16  AT-EXPENSE-TYPE             PIC X.
  6130         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  6131
  6132         16  AT-PAYEE-TYPE-CD.
  6133             20  AT-PAYEE-TYPE           PIC X.
  6134                 88  INSURED-PAID           VALUE 'I'.
  6135                 88  BENEFICIARY-PAID       VALUE 'B'.
  6136                 88  ACCOUNT-PAID           VALUE 'A'.
  6137                 88  OTHER-1-PAID           VALUE 'O'.
  6138                 88  OTHER-2-PAID           VALUE 'Q'.
  6139                 88  DOCTOR-PAID            VALUE 'P'.
  6140                 88  EMPLOYER-PAID          VALUE 'E'.
  6141             20  AT-PAYEE-SEQ            PIC X.
  6142
  6143         16  AT-CASH-PAYMENT             PIC X.
  6144         16  AT-GROUPED-PAYMENT          PIC X.
  6145         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  6146         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  6147         16  AT-APPROVED-LEVEL           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 116
* EL156.cbl
  6148         16  AT-VOID-TYPE                PIC X.
  6149             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  6150             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  6151         16  AT-AIG-UNEMP-IND            PIC X.
  6152             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  6153         16  AT-ASSOCIATES               PIC X.
  6154             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  6155             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  6156
  6157         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  6158         16  AT-CV-PMT-CODE              PIC X.
  6159             88  FULL-DEATH-PAYMENT         VALUE '1'.
  6160             88  HALF-DEATH-PAYMENT         VALUE '2'.
  6161             88  FULL-ADD-PAYMENT           VALUE '3'.
  6162             88  HALF-ADD-PAYMENT           VALUE '4'.
  6163             88  FULL-RIDER-PAYMENT         VALUE '5'.
  6164             88  HALF-RIDER-PAYMENT         VALUE '6'.
  6165             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  6166             88  ADDL-PAYMENT               VALUE '8'.
  6167
  6168         16  AT-EOB-CODE1                PIC XXX.
  6169         16  AT-EOB-CODE2                PIC XXX.
  6170         16  AT-EOB-CODE3                PIC XXX.
  6171         16  FILLER REDEFINES AT-EOB-CODE3.
  6172             20  AT-PRINT-CLM-FORM       PIC X.
  6173             20  AT-PRINT-SURVEY         PIC X.
  6174             20  AT-SPECIAL-RELEASE      PIC X.
  6175         16  AT-EOB-CODE4                PIC XXX.
  6176         16  FILLER REDEFINES AT-EOB-CODE4.
  6177             20  AT-INT-PMT-SELECT-DT    PIC XX.
  6178             20  FILLER                  PIC X.
  6179         16  AT-EOB-CODE5                PIC XXX.
  6180         16  FILLER REDEFINES AT-EOB-CODE5.
  6181             20  AT-PMT-PROOF-DT         PIC XX.
  6182             20  FILLER                  PIC X.
  6183
  6184         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  6185             88  AT-PRINT-EOB            VALUE 'Y'.
  6186
  6187         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  6188         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  6189
  6190     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  6191         16  AT-SCHEDULE-START-DT        PIC XX.
  6192         16  AT-SCHEDULE-END-DT          PIC XX.
  6193         16  AT-TERMINATED-DT            PIC XX.
  6194         16  AT-LAST-PMT-TYPE            PIC X.
  6195             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  6196             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  6197         16  AT-FIRST-PMT-DATA.
  6198             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  6199             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
  6200             20  AT-1ST-PAY-THRU-DT      PIC XX.
  6201         16  AT-REGULAR-PMT-DATA.
  6202             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  6203             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  6204             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  6205         16  AT-AUTO-PAYEE-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 117
* EL156.cbl
  6206             20  AT-AUTO-PAYEE-TYPE      PIC X.
  6207                 88  INSURED-PAID-AUTO      VALUE 'I'.
  6208                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  6209                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  6210                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  6211                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  6212             20  AT-AUTO-PAYEE-SEQ       PIC X.
  6213         16  AT-AUTO-PAY-DAY             PIC 99.
  6214         16  AT-AUTO-CASH                PIC X.
  6215             88  AT-CASH                      VALUE 'Y'.
  6216             88  AT-NON-CASH                  VALUE 'N'.
  6217*        16  FILLER                      PIC X(129).
  6218         16  AT-AUTO-END-LETTER          PIC X(4).
  6219         16  FILLER                      PIC X(125).
  6220
  6221         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  6222         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  6223
  6224     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  6225         16  AT-LETTER-SENT-DT           PIC XX.
  6226         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  6227         16  AT-AUTO-RE-SEND-DT          PIC XX.
  6228         16  AT-LETTER-ANSWERED-DT       PIC XX.
  6229         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  6230         16  AT-LETTER-ORIGIN            PIC X.
  6231             88  ONLINE-CREATION              VALUE '1' '3'.
  6232             88  OFFLINE-CREATION             VALUE '2' '4'.
  6233             88  NAPER-ONLINE-CREATION        VALUE '3'.
  6234             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  6235         16  AT-STD-LETTER-FORM          PIC X(4).
  6236         16  AT-REASON-TEXT              PIC X(70).
  6237         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  6238         16  AT-ADDRESEE-TYPE            PIC X.
  6239              88  INSURED-ADDRESEE            VALUE 'I'.
  6240              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  6241              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  6242              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  6243              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  6244              88  OTHER-ADDRESEE-1            VALUE 'O'.
  6245              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  6246         16  AT-ADDRESSEE-NAME           PIC X(30).
  6247         16  AT-INITIAL-PRINT-DATE       PIC XX.
  6248         16  AT-RESEND-PRINT-DATE        PIC XX.
  6249         16  AT-CORR-SOL-UNSOL           PIC X.
  6250         16  AT-LETTER-PURGED-DT         PIC XX.
  6251*
  6252*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  6253*
  6254         16  AT-CSO-REDEFINITION.
  6255             20  AT-RESEND-LETTER-FORM   PIC X(4).
  6256             20  AT-AUTO-CLOSE-IND       PIC X(1).
  6257             20  AT-LETTER-TO-BENE       PIC X(1).
  6258             20  AT-STOP-LETTER-DT       PIC X(2).
  6259             20  FILLER                  PIC X(19).
  6260*             20  FILLER                  PIC X(27).
  6261             20  AT-CSO-LETTER-STATUS    PIC X.
  6262                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  6263                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 118
* EL156.cbl
  6264                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  6265             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  6266             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  6267*
  6268*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  6269*
  6270*        16  FILLER                      PIC X(26).
  6271*
  6272*        16  AT-DMD-BSR-CODE             PIC X.
  6273*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  6274*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  6275*
  6276*        16  AT-DMD-LETTER-STATUS        PIC X.
  6277*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  6278*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  6279*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  6280*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  6281*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  6282
  6283         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  6284         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  6285
  6286     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  6287         16  AT-ADDRESS-TYPE             PIC X.
  6288             88  INSURED-ADDRESS               VALUE 'I'.
  6289             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  6290             88  ACCOUNT-ADDRESS               VALUE 'A'.
  6291             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  6292             88  EMPLOYER-ADDRESS              VALUE 'E'.
  6293             88  OTHER-ADDRESS-1               VALUE 'O'.
  6294             88  OTHER-ADDRESS-2               VALUE 'Q'.
  6295         16  AT-MAIL-TO-NAME             PIC X(30).
  6296         16  AT-ADDRESS-LINE-1           PIC X(30).
  6297         16  AT-ADDRESS-LINE-2           PIC X(30).
  6298         16  AT-CITY-STATE.
  6299             20  AT-CITY                 PIC X(28).
  6300             20  AT-STATE                PIC XX.
  6301         16  AT-ZIP.
  6302             20  AT-ZIP-CODE.
  6303                 24  AT-ZIP-1ST          PIC X.
  6304                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6305                 24  FILLER              PIC X(4).
  6306             20  AT-ZIP-PLUS4            PIC X(4).
  6307         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  6308             20  AT-CAN-POSTAL-1         PIC XXX.
  6309             20  AT-CAN-POSTAL-2         PIC XXX.
  6310             20  FILLER                  PIC XXX.
  6311         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  6312*         16  FILLER                      PIC X(23).
  6313         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  6314         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
  6315         16  FILLER                      PIC X(13).
  6316         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  6317         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  6318
  6319     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6320         16  AT-INFO-LINE-1              PIC X(60).
  6321         16  FILLER REDEFINES AT-INFO-LINE-1.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 119
* EL156.cbl
  6322             20  AT-NOTE-ERROR-NO OCCURS 15
  6323                                         PIC X(4).
  6324         16  AT-INFO-LINE-2              PIC X(60).
  6325         16  FILLER REDEFINES AT-INFO-LINE-2.
  6326             20  AT-ICD-CODE-1           PIC X(8).
  6327             20  AT-ICD-CODE-2           PIC X(8).
  6328             20  FILLER                  PIC X(44).
  6329         16  AT-INFO-TRAILER-TYPE        PIC X.
  6330             88  AT-ERRORS-NOTE          VALUE 'E'.
  6331             88  AT-PAYMENT-NOTE         VALUE 'P'.
  6332             88  AT-CALL-NOTE            VALUE 'C'.
  6333             88  AT-MAINT-NOTE           VALUE 'M'.
  6334             88  AT-CERT-CHANGE          VALUE 'X'.
  6335             88  AT-APPROVAL-NOTE        VALUE 'R'.
  6336             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  6337             88  AT-CERT-CANCELLED       VALUE 'T'.
  6338         16  AT-CALL-TYPE                PIC X.
  6339             88  AT-PHONE-CALL-IN        VALUE 'I'.
  6340             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  6341         16  AT-NOTE-CONTINUATION        PIC X.
  6342             88  AT-CONTINUED-NOTE       VALUE 'X'.
  6343         16  AT-EOB-CODES-EXIST          PIC X.
  6344             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  6345         16  FILLER                      PIC X(35).
  6346         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  6347         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  6348
  6349     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  6350         16  AT-PROMPT-LINE-1            PIC X(60).
  6351         16  AT-PROMPT-LINE-2            PIC X(60).
  6352         16  AT-PROMPT-START-DT          PIC XX.
  6353         16  AT-PROMPT-END-DT            PIC XX.
  6354         16  FILLER                      PIC X(35).
  6355         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  6356         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  6357
  6358     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  6359         16  AT-DENIAL-INFO-1            PIC X(60).
  6360         16  AT-DENIAL-INFO-2            PIC X(60).
  6361         16  AT-DENIAL-DT                PIC XX.
  6362         16  AT-RETRACTION-DT            PIC XX.
  6363         16  AT-DENIAL-REASON-CODE       PIC X(4).
  6364*         16  FILLER                      PIC X(31).
  6365         16  AT-DENIAL-PROOF-DT          PIC XX.
  6366         16  FILLER                      PIC X(29).
  6367         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  6368         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  6369
  6370     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  6371         16  AT-OLD-INCURRED-DT          PIC XX.
  6372         16  AT-OLD-REPORTED-DT          PIC XX.
  6373         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  6374         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  6375         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  6376         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  6377         16  AT-OLD-PAID-THRU-DT         PIC XX.
  6378         16  AT-LAST-PMT-MADE-DT         PIC XX.
  6379         16  FILLER                      PIC X(26).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 120
* EL156.cbl
  6380         16  AT-OLD-DIAG-CODE            PIC X(6).
  6381         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  6382         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  6383         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  6384         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  6385         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  6386         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  6387         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  6388         16  AT-OLD-ICD-CODE-1           PIC X(8).
  6389         16  AT-OLD-ICD-CODE-2           PIC X(8).
  6390         16  FILLER                      PIC X(9).
  6391         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  6392
  6393     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  6394         16  AT-FORM-SEND-ON-DT          PIC XX.
  6395         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  6396         16  AT-FORM-RE-SEND-DT          PIC XX.
  6397         16  AT-FORM-ANSWERED-DT         PIC XX.
  6398         16  AT-FORM-PRINTED-DT          PIC XX.
  6399         16  AT-FORM-REPRINT-DT          PIC XX.
  6400         16  AT-FORM-TYPE                PIC X.
  6401             88  INITIAL-FORM                  VALUE '1'.
  6402             88  PROGRESS-FORM                 VALUE '2'.
  6403         16  AT-INSTRUCT-LN-1            PIC X(28).
  6404         16  AT-INSTRUCT-LN-2            PIC X(28).
  6405         16  AT-INSTRUCT-LN-3            PIC X(28).
  6406         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  6407         16  AT-FORM-ADDRESS             PIC X.
  6408             88  FORM-TO-INSURED              VALUE 'I'.
  6409             88  FORM-TO-ACCOUNT              VALUE 'A'.
  6410             88  FORM-TO-OTHER-1              VALUE 'O'.
  6411             88  FORM-TO-OTHER-2              VALUE 'Q'.
  6412         16  AT-RELATED-1.
  6413             20 AT-REL-CARR-1            PIC X.
  6414             20 AT-REL-CLAIM-1           PIC X(7).
  6415             20 AT-REL-CERT-1            PIC X(11).
  6416         16  AT-RELATED-2.
  6417             20 AT-REL-CARR-2            PIC X.
  6418             20 AT-REL-CLAIM-2           PIC X(7).
  6419             20 AT-REL-CERT-2            PIC X(11).
  6420         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  6421         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  6422         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  6423         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  6424         16  AT-FORM-REM-PRINT-DT        PIC XX.
  6425         16  AT-STOP-FORM-DT             PIC X(2).
  6426
  6427         16  FILLER                      PIC X(09).
  6428         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  6429         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
  6430******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 121
* EL156.cbl
  6432*    COPY ELCACTQ.
  6433******************************************************************
  6434*                                                                *
  6435*                            ELCACTQ.                            *
  6436*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
  6437*                            VMOD=2.004                          *
  6438*                                                                *
  6439*   FILE DESCRIPTION = ACTIVITY QUE FILE                         *
  6440*                                                                *
  6441*   FILE TYPE = VSAM,KSDS                                        *
  6442*   RECORD SIZE = 60     RECFORM = FIXED                         *
  6443*                                                                *
  6444*   BASE CLUSTER NAME = ELACTQ             RKP=2,LEN=20          *
  6445*       ALTERNATE INDEX = NONE                                   *
  6446*                                                                *
  6447*   LOG = YES                                                    *
  6448*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6449*                                                                *
  6450*  NO  CID  MODS  IN  COPYBOOK  ELCACTQ                          *
  6451******************************************************************
  6452
  6453 01  ACTIVITY-QUE.
  6454     12  AQ-RECORD-ID                PIC XX.
  6455         88  VALID-AQ-ID                VALUE 'AQ'.
  6456
  6457     12  AQ-CONTROL-PRIMARY.
  6458         16  AQ-COMPANY-CD           PIC X.
  6459         16  AQ-CARRIER              PIC X.
  6460         16  AQ-CLAIM-NO             PIC X(7).
  6461         16  AQ-CERT-NO.
  6462             20  AQ-CERT-PRIME       PIC X(10).
  6463             20  AQ-CERT-SFX         PIC X.
  6464
  6465     12  AQ-PENDING-ACTIVITY-FLAGS.
  6466         88  NO-PENDING-ACTIVITY        VALUE SPACES.
  6467         16  AQ-PENDING-PAYMENT-FLAG PIC X.
  6468             88  PENDING-PAYMENTS       VALUE '1'.
  6469         16  AQ-PENDING-STATUS-FLAG  PIC X.
  6470             88  PENDING-FULL-PRINT     VALUE '1'.
  6471             88  PENDING-PART-PRINT     VALUE '2'.
  6472         16  AQ-PENDING-LETTER-FLAG  PIC X.
  6473             88  PENDING-LETTERS        VALUE '1'.
  6474         16  AQ-PENDING-CLAIM-RESTORE PIC X.
  6475             88  PENDING-RESTORE        VALUE 'C'.
  6476             88  PENDING-RESTORE-LETTER VALUE 'L'.
  6477
  6478     12  FILLER                      PIC X(20).
  6479
  6480     12  AQ-RESEND-DATE              PIC XX.
  6481     12  AQ-FOLLOWUP-DATE            PIC XX.
  6482     12  AQ-PAYMENT-COUNTER          PIC S9        COMP-3.
  6483     12  AQ-PMT-UNAPPROVED-COUNT     PIC S9        COMP-3.
  6484     12  AQ-AUTO-LETTER              PIC X(4).
  6485     12  FILLER                      PIC XX.
  6486     12  AQ-LAST-UPDATED-BY          PIC S9(4)     COMP.
  6487*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 122
* EL156.cbl
  6489*    COPY ERCACCT.
  6490******************************************************************
  6491*                                                                *
  6492*                                                                *
  6493*                            ERCACCT                             *
  6494*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6495*                            VMOD=2.031                          *
  6496*                                                                *
  6497*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  6498*                                                                *
  6499*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  6500*   VSAM ACCOUNT MASTER FILES.                                   *
  6501*                                                                *
  6502*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  6503*                                                                *
  6504*   FILE TYPE = VSAM,KSDS                                        *
  6505*   RECORD SIZE = 2000  RECFORM = FIX                            *
  6506*                                                                *
  6507*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  6508*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  6509*                                                                *
  6510*   LOG = NO                                                     *
  6511*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6512*                                                                *
  6513*                                                                *
  6514******************************************************************
  6515*                   C H A N G E   L O G
  6516*
  6517* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6518*-----------------------------------------------------------------
  6519*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6520* EFFECTIVE    NUMBER
  6521*-----------------------------------------------------------------
  6522* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  6523* 092705    2005050300006  PEMA  ADD SPP LEASES
  6524* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  6525* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6526* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  6527* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  6528* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  6529******************************************************************
  6530
  6531 01  ACCOUNT-MASTER.
  6532     12  AM-RECORD-ID                      PIC XX.
  6533         88  VALID-AM-ID                      VALUE 'AM'.
  6534
  6535     12  AM-CONTROL-PRIMARY.
  6536         16  AM-COMPANY-CD                 PIC X.
  6537         16  AM-MSTR-CNTRL.
  6538             20  AM-CONTROL-A.
  6539                 24  AM-CARRIER            PIC X.
  6540                 24  AM-GROUPING.
  6541                     28 AM-GROUPING-PREFIX PIC XXX.
  6542                     28 AM-GROUPING-PRIME  PIC XXX.
  6543                 24  AM-STATE              PIC XX.
  6544                 24  AM-ACCOUNT.
  6545                     28  AM-ACCOUNT-PREFIX PIC X(4).
  6546                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 123
* EL156.cbl
  6547             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  6548                                           PIC X(19).
  6549             20  AM-CNTRL-B.
  6550                 24  AM-EXPIRATION-DT      PIC XX.
  6551                 24  FILLER                PIC X(4).
  6552             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  6553                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  6554
  6555     12  AM-CONTROL-BY-VAR-GRP.
  6556         16  AM-COMPANY-CD-A1              PIC X.
  6557         16  AM-VG-CARRIER                 PIC X.
  6558         16  AM-VG-GROUPING                PIC X(6).
  6559         16  AM-VG-STATE                   PIC XX.
  6560         16  AM-VG-ACCOUNT                 PIC X(10).
  6561         16  AM-VG-DATE.
  6562             20  AM-VG-EXPIRATION-DT       PIC XX.
  6563             20  FILLER                    PIC X(4).
  6564         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  6565                                           PIC 9(11)      COMP-3.
  6566     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  6567         16  FILLER                        PIC X(10).
  6568         16  AM-VG-KEY3.
  6569             20  AM-VG3-ACCOUNT            PIC X(10).
  6570             20  AM-VG3-EXP-DT             PIC XX.
  6571         16  FILLER                        PIC X(4).
  6572     12  AM-MAINT-INFORMATION.
  6573         16  AM-LAST-MAINT-DT              PIC XX.
  6574         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  6575         16  AM-LAST-MAINT-USER            PIC X(4).
  6576         16  FILLER                        PIC XX.
  6577
  6578     12  AM-EFFECTIVE-DT                   PIC XX.
  6579     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  6580
  6581     12  AM-PREV-DATES  COMP-3.
  6582         16  AM-PREV-EXP-DT                PIC 9(11).
  6583         16  AM-PREV-EFF-DT                PIC 9(11).
  6584
  6585     12  AM-REPORT-CODE-1                  PIC X(10).
  6586     12  AM-REPORT-CODE-2                  PIC X(10).
  6587
  6588     12  AM-CITY-CODE                      PIC X(4).
  6589     12  AM-COUNTY-PARISH                  PIC X(6).
  6590
  6591     12  AM-NAME                           PIC X(30).
  6592     12  AM-PERSON                         PIC X(30).
  6593     12  AM-ADDRS                          PIC X(30).
  6594     12  AM-CITY.
  6595         16  AM-ADDR-CITY                  PIC X(28).
  6596         16  AM-ADDR-STATE                 PIC XX.
  6597     12  AM-ZIP.
  6598         16  AM-ZIP-PRIME.
  6599             20  AM-ZIP-PRI-1ST            PIC X.
  6600                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  6601             20  FILLER                    PIC X(4).
  6602         16  AM-ZIP-PLUS4                  PIC X(4).
  6603     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  6604         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 124
* EL156.cbl
  6605         16  AM-CAN-POSTAL-2               PIC XXX.
  6606         16  FILLER                        PIC XXX.
  6607     12  AM-TEL-NO.
  6608         16  AM-AREA-CODE                  PIC 999.
  6609         16  AM-TEL-PRE                    PIC 999.
  6610         16  AM-TEL-NBR                    PIC 9(4).
  6611     12  AM-TEL-LOC                        PIC X.
  6612         88  AM-TEL-AT-HOME                   VALUE 'H'.
  6613         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  6614
  6615     12  AM-COMM-STRUCTURE.
  6616         16  AM-DEFN-1.
  6617             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  6618                 24  AM-AGT.
  6619                     28  AM-AGT-PREFIX     PIC X(4).
  6620                     28  AM-AGT-PRIME      PIC X(6).
  6621                 24  AM-COM-TYP            PIC X.
  6622                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  6623                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  6624                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  6625                 24  AM-RECALC-LV-INDIC    PIC X.
  6626                 24  AM-RETRO-LV-INDIC     PIC X.
  6627                 24  AM-GL-CODES           PIC X.
  6628                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  6629                 24  FILLER                PIC X(01).
  6630         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  6631             20  AM-COM-TBLS        OCCURS 10 TIMES.
  6632                 24  FILLER                PIC X(11).
  6633                 24  AM-L-COMA             PIC XXX.
  6634                 24  AM-J-COMA             PIC XXX.
  6635                 24  AM-A-COMA             PIC XXX.
  6636                 24  FILLER                PIC X(6).
  6637
  6638     12  AM-COMM-CHANGE-STATUS             PIC X.
  6639         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  6640
  6641     12  AM-CSR-CODE                       PIC X(4).
  6642
  6643     12  AM-BILLING-STATUS                 PIC X.
  6644         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  6645         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  6646     12  AM-AUTO-REFUND-SW                 PIC X.
  6647         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  6648         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  6649     12  AM-GPCD                           PIC 99.
  6650     12  AM-IG                             PIC X.
  6651         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  6652         88  AM-HAS-GROUP                     VALUE '2'.
  6653     12  AM-STATUS                         PIC X.
  6654         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  6655         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  6656         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  6657         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  6658         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  6659         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  6660     12  AM-REMIT-TO                       PIC 99.
  6661     12  AM-ID-NO                          PIC X(11).
  6662
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 125
* EL156.cbl
  6663     12  AM-CAL-TABLE                      PIC XX.
  6664     12  AM-LF-DEVIATION                   PIC XXX.
  6665     12  AM-AH-DEVIATION                   PIC XXX.
  6666     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6667     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  6668     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  6669     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  6670     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6671     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  6672
  6673     12  AM-USER-FIELDS.
  6674         16  AM-FLD-1                      PIC XX.
  6675         16  AM-FLD-2                      PIC XX.
  6676         16  AM-FLD-3                      PIC XX.
  6677         16  AM-FLD-4                      PIC XX.
  6678         16  AM-FLD-5                      PIC XX.
  6679
  6680     12  AM-1ST-PROD-DATE.
  6681         16  AM-1ST-PROD-YR                PIC XX.
  6682         16  AM-1ST-PROD-MO                PIC XX.
  6683         16  AM-1ST-PROD-DA                PIC XX.
  6684     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  6685     12  AM-CERTS-PURGED-DATE.
  6686         16  AM-PUR-YR                     PIC XX.
  6687         16  AM-PUR-MO                     PIC XX.
  6688         16  AM-PUR-DA                     PIC XX.
  6689     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  6690     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  6691     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  6692     12  AM-INACTIVE-DATE.
  6693         16  AM-INA-MO                     PIC 99.
  6694         16  AM-INA-DA                     PIC 99.
  6695         16  AM-INA-YR                     PIC 99.
  6696     12  AM-AR-HI-CERT-DATE                PIC XX.
  6697
  6698     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6699     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  6700
  6701     12  AM-OB-PAYMENT-MODE                PIC X.
  6702         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  6703         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  6704         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  6705         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  6706
  6707     12  AM-AH-ONLY-INDICATOR              PIC X.
  6708         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  6709         88  AM-NO-AH-ONLY                    VALUE 'N'.
  6710
  6711     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  6712
  6713     12  AM-OVER-SHORT.
  6714         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  6715         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  6716
  6717     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  6718     12  AM-DCC-CLP-STATE                  PIC XX.
  6719
  6720     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 126
* EL156.cbl
  6721     12  AM-RECALC-REIN                    PIC X.
  6722
  6723     12  AM-REI-TABLE                      PIC XXX.
  6724     12  AM-REI-ET-LF                      PIC X.
  6725     12  AM-REI-ET-AH                      PIC X.
  6726     12  AM-REI-PE-LF                      PIC X.
  6727     12  AM-REI-PE-AH                      PIC X.
  6728     12  AM-REI-PRT-ST                     PIC X.
  6729     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  6730     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  6731     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  6732     12  AM-REI-GROUP-A                    PIC X(6).
  6733     12  AM-REI-MORT                       PIC X(4).
  6734     12  AM-REI-PRT-OW                     PIC X.
  6735     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  6736     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  6737     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  6738     12  AM-REI-GROUP-B                    PIC X(6).
  6739
  6740     12  AM-TRUST-TYPE                     PIC X(2).
  6741
  6742     12  AM-EMPLOYER-STMT-USED             PIC X.
  6743     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  6744
  6745     12  AM-STD-AH-TYPE                    PIC XX.
  6746     12  AM-EARN-METHODS.
  6747         16  AM-EARN-METHOD-R              PIC X.
  6748             88 AM-REF-RL-R78                 VALUE 'R'.
  6749             88 AM-REF-RL-PR                  VALUE 'P'.
  6750             88 AM-REF-RL-MEAN                VALUE 'M'.
  6751             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  6752         16  AM-EARN-METHOD-L              PIC X.
  6753             88 AM-REF-LL-R78                 VALUE 'R'.
  6754             88 AM-REF-LL-PR                  VALUE 'P'.
  6755             88 AM-REF-LL-MEAN                VALUE 'M'.
  6756             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  6757         16  AM-EARN-METHOD-A              PIC X.
  6758             88 AM-REF-AH-R78                 VALUE 'R'.
  6759             88 AM-REF-AH-PR                  VALUE 'P'.
  6760             88 AM-REF-AH-MEAN                VALUE 'M'.
  6761             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  6762             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  6763             88 AM-REF-AH-NET                 VALUE 'N'.
  6764
  6765     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  6766     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  6767     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  6768
  6769     12  AM-RET-Y-N                        PIC X.
  6770     12  AM-RET-P-E                        PIC X.
  6771     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  6772     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  6773     12  AM-RET-GRP                        PIC X(6).
  6774     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  6775         16  AM-POOL-PRIME                 PIC XXX.
  6776         16  AM-POOL-SUB                   PIC XXX.
  6777     12  AM-RETRO-EARNINGS.
  6778         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 127
* EL156.cbl
  6779         16  AM-RET-EARN-L                 PIC X.
  6780         16  AM-RET-EARN-A                 PIC X.
  6781     12  AM-RET-ST-TAX-USE                 PIC X.
  6782         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  6783         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  6784     12  AM-RETRO-BEG-EARNINGS.
  6785         16  AM-RET-BEG-EARN-R             PIC X.
  6786         16  AM-RET-BEG-EARN-L             PIC X.
  6787         16  AM-RET-BEG-EARN-A             PIC X.
  6788     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  6789     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  6790
  6791     12  AM-USER-SELECT-OPTIONS.
  6792         16  AM-USER-SELECT-1              PIC X(10).
  6793         16  AM-USER-SELECT-2              PIC X(10).
  6794         16  AM-USER-SELECT-3              PIC X(10).
  6795         16  AM-USER-SELECT-4              PIC X(10).
  6796         16  AM-USER-SELECT-5              PIC X(10).
  6797
  6798     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6799
  6800     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  6801
  6802     12  AM-RPT045A-SWITCH                 PIC X.
  6803         88  RPT045A-OFF                   VALUE 'N'.
  6804
  6805     12  AM-INSURANCE-LIMITS.
  6806         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  6807         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  6808
  6809     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  6810         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  6811
  6812     12  AM-DISMBR-COVERAGE-SW             PIC X.
  6813         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  6814         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  6815
  6816     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  6817
  6818     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  6819     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  6820     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  6821     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  6822     12  AM-DCC-UEF-STATE                  PIC XX.
  6823     12  FILLER                            PIC XXX.
  6824     12  AM-REPORT-CODE-3                  PIC X(10).
  6825*    12  FILLER                            PIC X(22).
  6826
  6827     12  AM-RESERVE-DATE.
  6828         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  6829         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  6830         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  6831
  6832     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  6833     12  AM-NOTIFICATION-TYPES.
  6834         16  AM-NOTIF-OF-LETTERS           PIC X.
  6835         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  6836         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 128
* EL156.cbl
  6837         16  AM-NOTIF-OF-STATUS            PIC X.
  6838
  6839     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  6840         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  6841         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  6842         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  6843         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  6844
  6845     12  AM-BENEFIT-CONTROLS.
  6846         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  6847             20  AM-BENEFIT-CODE           PIC XX.
  6848             20  AM-BENEFIT-TYPE           PIC X.
  6849             20  AM-BENEFIT-REVISION       PIC XXX.
  6850             20  AM-BENEFIT-REM-TERM       PIC X.
  6851             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  6852             20  FILLER                    PIC XX.
  6853         16  FILLER                        PIC X(80).
  6854
  6855     12  AM-TRANSFER-DATA.
  6856         16  AM-TRANSFERRED-FROM.
  6857             20  AM-TRNFROM-CARRIER        PIC X.
  6858             20  AM-TRNFROM-GROUPING.
  6859                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  6860                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  6861             20  AM-TRNFROM-STATE          PIC XX.
  6862             20  AM-TRNFROM-ACCOUNT.
  6863                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  6864                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  6865             20  AM-TRNFROM-DTE            PIC XX.
  6866         16  AM-TRANSFERRED-TO.
  6867             20  AM-TRNTO-CARRIER          PIC X.
  6868             20  AM-TRNTO-GROUPING.
  6869                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  6870                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  6871             20  AM-TRNTO-STATE            PIC XX.
  6872             20  AM-TRNTO-ACCOUNT.
  6873                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  6874                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  6875             20  AM-TRNTO-DTE              PIC XX.
  6876         16  FILLER                        PIC X(10).
  6877
  6878     12  AM-SAVED-REMIT-TO                 PIC 99.
  6879
  6880     12  AM-COMM-STRUCTURE-SAVED.
  6881         16  AM-DEFN-1-SAVED.
  6882             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  6883                 24  AM-AGT-SV             PIC X(10).
  6884                 24  AM-COM-TYP-SV         PIC X.
  6885                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  6886                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  6887                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  6888                 24  AM-RECALC-LV-INDIC-SV PIC X.
  6889                 24  FILLER                PIC X.
  6890                 24  AM-GL-CODES-SV        PIC X.
  6891                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  6892                 24  FILLER                PIC X.
  6893         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  6894             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 129
* EL156.cbl
  6895                 24  FILLER                PIC X(11).
  6896                 24  AM-L-COMA-SV          PIC XXX.
  6897                 24  AM-J-COMA-SV          PIC XXX.
  6898                 24  AM-A-COMA-SV          PIC XXX.
  6899                 24  FILLER                PIC X(6).
  6900
  6901     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  6902         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  6903            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  6904            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  6905            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  6906
  6907     12  AM-ORIG-DEALER-NO                 PIC X(10).
  6908     12  FILLER                            PIC X(120).
  6909
  6910     12  AM-ACCOUNT-EXECUTIVE-DATA.
  6911         16  AM-CONTROL-NAME               PIC X(30).
  6912         16  AM-EXECUTIVE-ONE.
  6913             20  AM-EXEC1-NAME             PIC X(15).
  6914             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  6915                                                          COMP-3.
  6916             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  6917                                                          COMP-3.
  6918         16  AM-EXECUTIVE-TWO.
  6919             20  AM-EXEC2-NAME             PIC X(15).
  6920             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  6921                                                          COMP-3.
  6922             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  6923                                                          COMP-3.
  6924
  6925     12  AM-RETRO-ADDITIONAL-DATA.
  6926         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  6927         16  AM-RETRO-PREM-P-E             PIC X.
  6928         16  AM-RETRO-CLMS-P-I             PIC X.
  6929         16  AM-RETRO-RET-BRACKET-LF.
  6930             20  AM-RETRO-RET-METHOD-LF    PIC X.
  6931                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  6932                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  6933             20  AM-RETRO-RET-BASIS-LF     PIC X.
  6934                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  6935                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  6936             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  6937                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  6938                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  6939         16  AM-RETRO-RET-BRACKET-AH.
  6940             20  AM-RETRO-RET-METHOD-AH    PIC X.
  6941                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  6942                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  6943                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  6944             20  AM-RETRO-RET-BASIS-AH     PIC X.
  6945                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  6946                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  6947             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  6948                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  6949                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  6950
  6951     12  AM-COMMENTS.
  6952         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 130
* EL156.cbl
  6953
  6954     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  6955         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  6956         16  AM-FLI-BILLING-CODE           PIC X.
  6957         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  6958         16  AM-FLI-UNITED-IDENT           PIC X.
  6959         16  AM-FLI-INTEREST-LOST-DATA.
  6960             20  AM-FLI-BANK-NO            PIC X(5).
  6961             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  6962             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  6963             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  6964         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  6965             20  AM-FLI-AGT                PIC X(9).
  6966             20  AM-FLI-AGT-COMM-ACC       PIC X.
  6967             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  6968         16  FILLER                        PIC X(102).
  6969
  6970     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  6971         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  6972             20  AM-BENEFIT-DMD-CODE         PIC XX.
  6973             20  AM-BENEFIT-DMD-TYPE         PIC X.
  6974             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  6975             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  6976             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  6977         16  FILLER                          PIC X(10).
  6978******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 131
* EL156.cbl
  6980*    COPY ELCCHKQ.
  6981******************************************************************
  6982*                                                                *
  6983*                                                                *
  6984*                            ELCCHKQ.                            *
  6985*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6986*                            VMOD=2.007                          *
  6987*                                                                *
  6988*   FILE DESCRIPTION = CHECK QUE FILE                            *
  6989*                                                                *
  6990*   FILE TYPE = VSAM,KSDS                                        *
  6991*   RECORD SIZE = 100  RECFORM = FIXED                           *
  6992*                                                                *
  6993*   BASE CLUSTER = ELCHKQ                         RKP=2,LEN=7    *
  6994*       ALTERNATE PATH1 = ELCHKQ2 (BY PAYEE)      RKP=9,LEN=26   *
  6995*                                                                *
  6996*   LOG = YES                                                    *
  6997*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6998******************************************************************
  6999 01  CHECK-QUE.
  7000     12  CQ-RECORD-ID                PIC XX.
  7001         88  VALID-CQ-ID         VALUE 'CQ'.
  7002
  7003     12  CQ-CONTROL-PRIMARY.
  7004         16  CQ-COMPANY-CD           PIC X.
  7005         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  7006         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  7007
  7008     12  CQ-CONTROL-BY-PAYEE.
  7009         16  CQ-CONTROL-BY-NUMBER.
  7010             20  CQ-COMPANY-CD-A1     PIC X.
  7011             20  CQ-CONTROL-NUMBER-A1 PIC S9(8)      COMP.
  7012         16  CQ-PAYEE-CARRIER        PIC X.
  7013         16  CQ-PAYEE-GROUPING       PIC X(6).
  7014         16  CQ-PAYEE-STATE          PIC XX.
  7015         16  CQ-PAYEE-BENE-ACCT      PIC X(10).
  7016         16  CQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  7017
  7018     12  CQ-DMD-CONTROL  REDEFINES  CQ-CONTROL-BY-PAYEE.
  7019         16  CQ-DMD-COMPANY-CD-A2    PIC X.
  7020         16  CQ-DMD-PAYEE-TYPE-A2    PIC X.
  7021         16  CQ-DMD-BENE-CODE-A2     PIC X(10).
  7022         16  CQ-DMD-CLAIM-NO-A2      PIC X(7).
  7023         16  CQ-DMD-TIME-SEQ-A2      PIC S9(7)       COMP.
  7024         16  FILLER                  PIC X(3).
  7025
  7026     12  CQ-ENTRY-TYPE               PIC X.
  7027             88  CHECK-ON-QUE           VALUE 'Q'.
  7028             88  ALIGNMENT-CHECK        VALUE 'A'.
  7029             88  SPOILED-CHECK          VALUE 'S'.
  7030             88  PAYMENT-ABORTED        VALUE 'X'.
  7031
  7032     12  CQ-CLAIM-MAST-CNTL.
  7033         16  CQ-CARRIER              PIC X.
  7034         16  CQ-CLAIM-NO             PIC X(7).
  7035         16  CQ-CERT-NO.
  7036             20  CQ-CERT-PRIME       PIC X(10).
  7037             20  CQ-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 132
* EL156.cbl
  7038         16  CQ-CLAIM-TYPE           PIC X.
  7039             88  CQ-LIFE-CLAIM          VALUE 'L'.
  7040             88  CQ-AH-CLAIM            VALUE 'A'.
  7041         16  CQ-CLAIM-SUB-TYPE       PIC X.
  7042             88  CQ-FIXED-COVERAGE      VALUE '1'.
  7043             88  CQ-O-B-COVERAGE        VALUE '2'.
  7044             88  CQ-OPEN-END-COVERAGE   VALUE '3'.
  7045
  7046     12  CQ-PMT-TRLR-SEQUENCE        PIC S9(4)       COMP.
  7047     12  CQ-CHECK-NUMBER             PIC X(7).
  7048     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  7049     12  CQ-PAYMENT-TYPE             PIC X.
  7050             88  CQ-PARTIAL-PAYMENT        VALUE '1'.
  7051             88  CQ-FINAL-PAYMENT          VALUE '2'.
  7052             88  CQ-LUMP-SUM-PAYMENT       VALUE '3'.
  7053             88  CQ-ADDITIONAL-PAYMENT     VALUE '4'.
  7054             88  CQ-CHARGEABLE-EXPENSE     VALUE '5'.
  7055             88  CQ-NON-CHARGEABLE-EXPENSE VALUE '6'.
  7056             88  CQ-LIFE-PREMIUM-REFUND    VALUE '7'.
  7057             88  CQ-AH-PREMIUM-REFUND      VALUE '8'.
  7058     12  CQ-VOID-INDICATOR           PIC X.
  7059             88  CHECK-IS-STOPPED          VALUE 'S'.
  7060             88  CHECK-IS-VOID             VALUE 'V'.
  7061     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  7062     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  7063     12  CQ-CHECK-BY-USER            PIC X(4).
  7064     12  CQ-PRE-NUMBERING-SW         PIC X.
  7065       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  7066       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  7067
  7068     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  7069     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  7070     12  CQ-LEDGER-FLAG              PIC X(01).
  7071     12  CQ-VOID-AFTER-LEDGER        PIC X(01).
  7072     12  CQ-LAST-UPDATED-DT          PIC XX.
  7073     12  CQ-LAST-UPDATED-HHMMSS      PIC S9(6)       COMP-3.
  7074     12  CQ-APPLIED-TO-RCON-DT       PIC XX.
  7075
  7076     12  FILLER                      PIC X(04).
  7077
  7078******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 133
* EL156.cbl
  7080*    COPY ELCBENE.
  7081******************************************************************
  7082*                                                                *
  7083*                            ELCBENE.                            *
  7084*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7085*                            VMOD=2.006                          *
  7086*                                                                *
  7087*   FILE DESCRIPTION = BENEFICIARY FILE                          *
  7088*                                                                *
  7089*   FILE TYPE = VSAM,KSDS                                        *
  7090*   RECORD SIZE = 500   RECFORM = FIX                            *
  7091*                                                                *
  7092*   BASE CLUSTER NAME = ELBENE                   RKP=2,LEN=12    *
  7093*     ALTERNATE PATH1 = ELBENE2 (ALT BY NAME)    RKP=14,LEN=42   *
  7094*                                                                *
  7095*   LOG = YES                                                    *
  7096*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7097*                                                                *
  7098*  NO  CID  MODS  TO  COPYBOOK  ELCBENE                          *
  7099******************************************************************
  7100
  7101 01  BENEFICIARY-MASTER.
  7102     12  BE-RECORD-ID                PIC XX.
  7103         88  VALID-BE-ID                VALUE 'BE'.
  7104
  7105     12  BE-CONTROL-PRIMARY.
  7106         16  BE-COMPANY-CD           PIC X.
  7107         16  BE-RECORD-TYPE          PIC X.
  7108             88  BENEFICIARY-RECORD  VALUE 'B'.
  7109             88  ADJUSTOR-RECORD     VALUE 'A'.
  7110         16  BE-BENEFICIARY          PIC X(10).
  7111     12  BE-CONTROL-BY-NAME.
  7112         16  BE-COMPANY-CD-A1        PIC X.
  7113         16  BE-RECORD-TYPE-A1       PIC X.
  7114         16  BE-MAIL-TO-NAME-A1      PIC X(30).
  7115         16  BE-ALTERNATE-PRIME-A1   PIC X(10).
  7116
  7117     12  BE-LAST-MAINT-DT            PIC XX.
  7118     12  BE-LAST-MAINT-BY            PIC X(4).
  7119     12  BE-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7120
  7121     12  BE-ADDRESS-DATA.
  7122         16  BE-MAIL-TO-NAME         PIC X(30).
  7123         16  BE-ADDRESS-LINE-1       PIC X(30).
  7124         16  BE-ADDRESS-LINE-2       PIC X(30).
  7125         16  BE-ADDRESS-LINE-3       PIC X(30).
  7126         16  BE-CITY-STATE.
  7127             20  BE-CITY             PIC X(28).
  7128             20  BE-STATE            PIC XX.
  7129         16  BE-ZIP-CODE.
  7130             20  BE-ZIP-PRIME.
  7131                 24  BE-ZIP-1ST      PIC X.
  7132                     88  BE-CANADIAN-POST-CODE
  7133                                         VALUE 'A' THRU 'Z'.
  7134                 24  FILLER          PIC X(4).
  7135             20  BE-ZIP-PLUS4        PIC X(4).
  7136         16  BE-CANADIAN-POSTAL-CODE  REDEFINES  BE-ZIP-CODE.
  7137             20  BE-CAN-POSTAL-1     PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 134
* EL156.cbl
  7138             20  BE-CAN-POSTAL-2     PIC XXX.
  7139             20  FILLER              PIC XXX.
  7140         16  BE-PHONE-NO             PIC 9(11)     COMP-3.
  7141         16  BE-GROUP-CHECKS-Y-N     PIC X.
  7142
  7143******************************************************************
  7144*    THE BE-CARRIER FIELD IS USED BY 'AIG' TO DETERMINE HOW TO   *
  7145*    SET THE CARRIER CODE IN THE PENDING CLAIM FILE.             *
  7146******************************************************************
  7147     12  BE-CARRIER                  PIC X.
  7148
  7149     12  BE-ADDRESS-DATA2.
  7150         16  BE-MAIL-TO-NAME2        PIC X(30).
  7151         16  BE-ADDRESS-LINE-12      PIC X(30).
  7152         16  BE-ADDRESS-LINE-22      PIC X(30).
  7153         16  BE-ADDRESS-LINE-32      PIC X(30).
  7154         16  BE-CITY-STATE2.
  7155             20  BE-CITY2            PIC X(28).
  7156             20  BE-STATE2           PIC XX.
  7157         16  BE-ZIP-CODE2.
  7158             20  BE-ZIP-PRIME2.
  7159                 24  BE-ZIP-1ST2     PIC X.
  7160                     88  BE-CANADIAN-POST-CODE2
  7161                                         VALUE 'A' THRU 'Z'.
  7162                 24  FILLER          PIC X(4).
  7163             20  BE-ZIP-PLUS42       PIC X(4).
  7164         16  BE-CANADIAN-POSTAL-CODE2 REDEFINES  BE-ZIP-CODE2.
  7165             20  BE-CAN-POSTAL-12    PIC XXX.
  7166             20  BE-CAN-POSTAL-22    PIC XXX.
  7167             20  FILLER              PIC XXX.
  7168         16  BE-PHONE-NO2            PIC 9(11)     COMP-3.
  7169         16  BE-BILLING-STMT-DATA.
  7170             20  BE-BSR              PIC X.
  7171                 88  BE-AUTOMATED-BSR      VALUE 'A'.
  7172                 88  BE-NOT-AUTOMATED-BSR  VALUE ' '.
  7173             20  BE-BSR-FROM         PIC X(30).
  7174             20  BE-BSR-DEPT         PIC X(30).
  7175             20  BE-BSR-PHONE-NUM    PIC 9(11)     COMP-3.
  7176             20  BE-BSR-FAX-NUM      PIC 9(11)     COMP-3.
  7177             20  BE-OUTPUT-TYPE      PIC X.
  7178                 88  BE-FAX-OUTPUT         VALUE 'F'.
  7179                 88  BE-PRINT-OUTPUT       VALUE 'P' ' '.
  7180
  7181     12  FILLER                      PIC X(28).
  7182******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 135
* EL156.cbl
  7184*    COPY ELCARCH.
  7185******************************************************************
  7186*                                                                *
  7187*                            ELCARCH.                            *
  7188*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7189*                            VMOD=2.007                          *
  7190*                                                                *
  7191*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  7192*                                                                *
  7193*   FILE TYPE = VSAM,KSDS                                        *
  7194*   RECORD SIZE = 090  RECFORM = FIXED                           *
  7195*                                                                *
  7196*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *
  7197*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *
  7198*                                                                *
  7199*   LOG = NO                                                     *
  7200*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7201*                                                                *
  7202*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *
  7203******************************************************************
  7204 01  LETTER-ARCHIVE.
  7205     12  LA-RECORD-ID                PIC XX.
  7206         88  VALID-LA-ID                VALUE 'LA'.
  7207
  7208     12  LA-CONTROL-PRIMARY.
  7209         16  LA-COMPANY-CD           PIC X.
  7210         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.
  7211         16  LA-RECORD-TYPE          PIC X.
  7212             88  LA-HEADER-DATA         VALUE '1'.
  7213             88  LA-ADDRESS-DATA        VALUE '2'.
  7214             88  LA-TEXT-DATA           VALUE '3'.
  7215             88  LA-FORM-CONTROL-HDR    VALUE '4'.
  7216         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.
  7217
  7218     12  LA-CONTROL-BY-TYPE.
  7219         16  LA-COMPANY-CD-A1        PIC X.
  7220         16  LA-RECORD-TYPE-A1       PIC X.
  7221         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.
  7222         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.
  7223
  7224     12  LA-TEXT-RECORD.
  7225         16  LA-SKIP-CONTROL         PIC XX.
  7226             88  NO-LINES-SKIPPED       VALUE SPACES.
  7227             88  SKIP-TO-NEXT-PAGE      VALUE '99'.
  7228         16  LA-TEXT-LINE            PIC X(70).
  7229
  7230     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.
  7231         16  FILLER                  PIC XX.
  7232         16  LA-ADDRESS-LINE         PIC X(30).
  7233         16  FILLER                  PIC X(40).
  7234
  7235     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.
  7236         16  FILLER                  PIC XX.
  7237         16  LA-CARRIER              PIC X.
  7238         16  LA-CLAIM-NO             PIC X(7).
  7239         16  LA-CERT-NO.
  7240             20  LA-CERT-PRIME       PIC X(10).
  7241             20  LA-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 136
* EL156.cbl
  7242         16  LA-NO-OF-COPIES         PIC S9.
  7243         16  LA-RESEND-DATE          PIC XX.
  7244         16  LA-PROCESSOR-CD         PIC X(4).
  7245         16  LA-CREATION-DT          PIC XX.
  7246         16  LA-INITIAL-PRINT-DATE   PIC XX.
  7247         16  LA-RESEND-PRINT-DATE    PIC XX.
  7248         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.
  7249         16  LA-1ST-RESEND-PRINT-DT  PIC XX.
  7250*
  7251* -----  16  LA-DMD-ADDITIONAL-FIELDS.
  7252*   I        20  LA-DMD-LETTER-FORM      PIC X(4).
  7253*   I        20  LA-DMD-PROD-CODE        PIC XX.
  7254*   I        20  LA-DMD-RES-ST           PIC XX.
  7255*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.
  7256*   I        20  LA-DMD-LETTER-STATUS    PIC X.
  7257*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.
  7258*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.
  7259*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.
  7260*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.
  7261*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.
  7262*   I        20  LA-DMD-UND-CODE         PIC XX.
  7263*   I        20  LA-DMD-BEN-CODE         PIC XX.
  7264*   V    16  FILLER                  PIC X(15).
  7265* -----
  7266*
  7267* REINSERTED  CSO  MODS
  7268*
  7269         16  FILLER.
  7270             20  FILLER                  PIC X(29).
  7271             20  LA-CSO-LETTER-STATUS    PIC X.
  7272                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.
  7273                 88  LA-CSO-LETTER-PURGED   VALUE '2'.
  7274                 88  LA-CSO-LETTER-RELOADED VALUE '3'.
  7275             20  LA-CSO-LETTER-PURGE-DT  PIC XX.
  7276             20  LA-CSO-LETTER-RELOAD-DT PIC XX.
  7277*
  7278
  7279     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.
  7280         16  FILLER                  PIC XX.
  7281         16  LA4-CARRIER             PIC X.
  7282         16  LA4-CLAIM-NO            PIC X(7).
  7283         16  LA4-CERT-NO.
  7284             20  LA4-CERT-PRIME      PIC X(10).
  7285             20  LA4-CERT-SFX        PIC X.
  7286         16  LA4-NO-OF-COPIES        PIC S9.
  7287         16  LA4-RESEND-DATE         PIC XX.
  7288         16  LA4-PROCESSOR-CD        PIC X(4).
  7289         16  LA4-CREATION-DT         PIC XX.
  7290         16  LA4-INITIAL-PRINT-DATE  PIC XX.
  7291         16  LA4-RESEND-PRINT-DATE   PIC XX.
  7292         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.
  7293         16  LA4-FORM-TYPE           PIC X.
  7294             88  LA4-INITIAL-FORM    VALUE '1'.
  7295             88  LA4-PROGRESS-FORM   VALUE '2'.
  7296         16  LA4-FORM-REM-PRINT-DT   PIC X(02).
  7297         16  LA4-STATE               PIC X(02).
  7298         16  FILLER                  PIC X(31).
  7299******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 137
* EL156.cbl
  7301*    COPY ELCDAR.
  7302******************************************************************
  7303*                                                                *
  7304*   FILE DESC. = DAILY ACTIVITY FILE, FOR PROCESSING NITELY      *
  7305*   FILE TYPE = VSAM,KSDS                                        *
  7306*   RECORD SIZE = 25   RECFORM = FIXED                           *
  7307*   BASE CLUSTER = DLYACTV                                       *
  7308*   LOG = YES                                                    *
  7309*   NARRATIVE - FILE IS BUILT DURING DAYTIME CICS PROCESSING AND *
  7310*               IS THEN PROCESSED BY CYCLE PROCESSING AT NIGHT.  *
  7311*               THIS IS USED TO BUILD THE LOGIC "F" EXTRACT      *
  7312*               RECORDS FOR THOSE CLAIMS WHICH HAVE HAD ACTIVITY *
  7313*               DURING THE DAY. THE EXTRACTS THEN GET READ IN    *
  7314*               BY PROGRAM "LGINFCE".                            *
  7315*                                                                *
  7316******************************************************************
  7317 01  DAILY-ACTIVITY-RECORD.
  7318     05  DA-KEY.
  7319         10  DA-COMP-CD          PIC X.
  7320         10  DA-CARRIER          PIC X.
  7321         10  DA-CLAIM-NO         PIC X(7).
  7322         10  DA-CERT-NO.
  7323             15  DA-CERT-PRIME   PIC X(10).
  7324             15  DA-CERT-SFX     PIC X.
  7325     05  DA-TRAILER-SEQ-NO       PIC S9(4)  COMP.
  7326     05  DA-RECORD-TYPE          PIC X.
  7327     05  FILLER                  PIC X(2).
  7328******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 138
* EL156.cbl
  7330*    COPY ERCCOMP.
  7331******************************************************************
  7332*                                                                *
  7333*                                                                *
  7334*                            ERCCOMP                             *
  7335*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7336*                            VMOD=2.019                          *
  7337*                                                                *
  7338*   ONLINE CREDIT SYSTEM                                         *
  7339*                                                                *
  7340*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  7341*                                                                *
  7342*   FILE TYPE = VSAM,KSDS                                        *
  7343*   RECORD SIZE = 700   RECFORM = FIXED                          *
  7344*                                                                *
  7345*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  7346*       ALTERNATE PATH = NONE                                    *
  7347*                                                                *
  7348*   LOG = NO                                                     *
  7349*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7350*                                                                *
  7351******************************************************************
  7352*                   C H A N G E   L O G
  7353*
  7354* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7355*-----------------------------------------------------------------
  7356*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7357* EFFECTIVE    NUMBER
  7358*-----------------------------------------------------------------
  7359* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7360* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  7361* 092205    2005050300006  PEMA  ADD LEASE FEE
  7362* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  7363* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  7364* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  7365* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7366* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  7367* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  7368******************************************************************
  7369
  7370 01  COMPENSATION-MASTER.
  7371     12  CO-RECORD-ID                          PIC XX.
  7372         88  VALID-CO-ID                          VALUE 'CO'.
  7373
  7374     12  CO-CONTROL-PRIMARY.
  7375         16  CO-COMPANY-CD                     PIC X.
  7376         16  CO-CONTROL.
  7377             20  CO-CTL-1.
  7378                 24  CO-CARR-GROUP.
  7379                     28  CO-CARRIER            PIC X.
  7380                     28  CO-GROUPING.
  7381                         32  CO-GROUP-PREFIX   PIC XXX.
  7382                         32  CO-GROUP-PRIME    PIC XXX.
  7383                 24  CO-RESP-NO.
  7384                     28  CO-RESP-PREFIX        PIC X(4).
  7385                     28  CO-RESP-PRIME         PIC X(6).
  7386             20  CO-CTL-2.
  7387                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 139
* EL156.cbl
  7388                     28  CO-ACCT-PREFIX        PIC X(4).
  7389                     28  CO-ACCT-PRIME         PIC X(6).
  7390         16  CO-TYPE                           PIC X.
  7391             88  CO-COMPANY-TYPE                  VALUE 'C'.
  7392             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  7393             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  7394
  7395     12  CO-MAINT-INFORMATION.
  7396         16  CO-LAST-MAINT-DT                  PIC XX.
  7397         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  7398         16  CO-LAST-MAINT-USER                PIC X(4).
  7399     12  FILLER                                PIC XX.
  7400     12  CO-STMT-TYPE                          PIC XXX.
  7401     12  CO-COMP-TYPE                          PIC X.
  7402         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  7403     12  CO-STMT-OWNER                         PIC X(4).
  7404     12  CO-BALANCE-CONTROL                    PIC X.
  7405         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  7406         88  CO-NO-BALANCE                        VALUE 'N'.
  7407
  7408     12  CO-INTERNAL-CONTROL-1                 PIC X.
  7409         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  7410         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  7411         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  7412
  7413     12  CO-INTERNAL-CONTROL-2                 PIC X.
  7414         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  7415         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  7416
  7417     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  7418     12  CO-GA-DIRECT-DEP                      PIC X.
  7419     12  CO-FUTURE-SPACE                       PIC X.
  7420         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  7421
  7422     12  CO-ACCT-NAME                          PIC X(30).
  7423     12  CO-MAIL-NAME                          PIC X(30).
  7424     12  CO-ADDR-1                             PIC X(30).
  7425     12  CO-ADDR-2                             PIC X(30).
  7426     12  CO-ADDR-3.
  7427         16  CO-ADDR-CITY                      PIC X(27).
  7428         16  CO-ADDR-STATE                     PIC XX.
  7429     12  CO-CSO-1099                           PIC X.
  7430     12  CO-ZIP.
  7431         16  CO-ZIP-PRIME.
  7432             20  CO-ZIP-PRI-1ST                PIC X.
  7433                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  7434             20  FILLER                        PIC X(4).
  7435         16  CO-ZIP-PLUS4                      PIC X(4).
  7436     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  7437         16  CO-CAN-POSTAL-1                   PIC XXX.
  7438         16  CO-CAN-POSTAL-2                   PIC XXX.
  7439         16  FILLER                            PIC XXX.
  7440     12  CO-SOC-SEC                            PIC X(13).
  7441     12  CO-TELEPHONE.
  7442         16  CO-AREA-CODE                      PIC XXX.
  7443         16  CO-PREFIX                         PIC XXX.
  7444         16  CO-PHONE                          PIC X(4).
  7445
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 140
* EL156.cbl
  7446     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  7447
  7448     12  CO-AR-BAL-LEVEL                       PIC X.
  7449         88  CO-AR-REF-LVL                        VALUE '1'.
  7450         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  7451         88  CO-AR-BILL-LVL                       VALUE '2'.
  7452         88  CO-AR-AGT-LVL                        VALUE '3'.
  7453         88  CO-AR-FR-LVL                         VALUE '4'.
  7454
  7455     12  CO-AR-NORMAL-PRINT                    PIC X.
  7456         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  7457         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  7458
  7459     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  7460
  7461     12  CO-AR-REPORTING                       PIC X.
  7462         88  CO-AR-NET-REPORT                     VALUE 'N'.
  7463         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  7464
  7465     12  CO-AR-PULL-CHECK                      PIC X.
  7466         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  7467         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  7468
  7469     12  CO-AR-BALANCE-PRINT                   PIC X.
  7470         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  7471
  7472     12  CO-AR-LAST-RUN-CODE                   PIC X.
  7473         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  7474         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  7475         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  7476
  7477     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  7478
  7479     12  CO-USER-CODE                          PIC X.
  7480     12  CO-REPORT-GROUP-ID                    PIC X(12).
  7481
  7482******************************************************************
  7483*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  7484*    THE LAST MONTH END RUN.
  7485******************************************************************
  7486
  7487     12  CO-LAST-ACTIVITY-DATE.
  7488         16  CO-ACT-YEAR                       PIC 99.
  7489         16  CO-ACT-MONTH                      PIC 99.
  7490         16  CO-ACT-DAY                        PIC 99.
  7491
  7492     12  CO-LAST-STMT-DT.
  7493         16  CO-LAST-STMT-YEAR                 PIC 99.
  7494         16  CO-LAST-STMT-MONTH                PIC 99.
  7495         16  CO-LAST-STMT-DAY                  PIC 99.
  7496
  7497     12  CO-MO-END-TOTALS.
  7498         16  CO-MONTHLY-TOTALS.
  7499             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  7500             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  7501             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  7502             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  7503             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 141
* EL156.cbl
  7504
  7505         16  CO-AGING-TOTALS.
  7506             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  7507             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  7508             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  7509             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  7510
  7511         16  CO-YTD-TOTALS.
  7512             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  7513             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  7514
  7515         16  CO-OVER-UNDER-TOTALS.
  7516             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7517             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  7518
  7519     12  CO-MISCELLANEOUS-TOTALS.
  7520         16  CO-FICA-TOTALS.
  7521             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  7522             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  7523
  7524         16  CO-CLAIM-TOTALS.
  7525             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7526             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7527
  7528******************************************************************
  7529*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7530*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7531******************************************************************
  7532
  7533     12  CO-CURRENT-TOTALS.
  7534         16  CO-CURRENT-LAST-STMT-DT.
  7535             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7536             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7537             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7538
  7539         16  CO-CURRENT-MONTHLY-TOTALS.
  7540             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7541             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7542             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7543             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7544             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7545
  7546         16  CO-CURRENT-AGING-TOTALS.
  7547             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7548             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7549             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7550             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7551
  7552         16  CO-CURRENT-YTD-TOTALS.
  7553             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7554             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7555
  7556     12  CO-PAID-COMM-TOTALS.
  7557         16  CO-YTD-PAID-COMMS.
  7558             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7559             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7560
  7561     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 142
* EL156.cbl
  7562         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7563         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7564
  7565     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7566         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7567         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7568         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7569         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7570         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7571         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7572         88  CO-FINAL-LETTER                  VALUE 'F'.
  7573         88  CO-RECONCILING                   VALUE 'R'.
  7574         88  CO-PHONE-CALL                    VALUE 'P'.
  7575         88  CO-LEGAL                         VALUE 'L'.
  7576         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7577         88  CO-WRITE-OFF                     VALUE 'W'.
  7578         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7579
  7580     12  CO-CSR-CODE                       PIC X(4).
  7581
  7582     12  CO-GA-STATUS-INFO.
  7583         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7584         16  CO-GA-TERMINATION-DT          PIC XX.
  7585         16  CO-GA-STATUS-CODE             PIC X.
  7586             88  CO-GA-ACTIVE                 VALUE 'A'.
  7587             88  CO-GA-INACTIVE               VALUE 'I'.
  7588             88  CO-GA-PENDING                VALUE 'P'.
  7589         16  CO-GA-COMMENTS.
  7590             20  CO-GA-COMMENT-1           PIC X(40).
  7591             20  CO-GA-COMMENT-2           PIC X(40).
  7592             20  CO-GA-COMMENT-3           PIC X(40).
  7593             20  CO-GA-COMMENT-4           PIC X(40).
  7594
  7595     12  CO-RPTCD2                         PIC X(10).
  7596     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7597         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7598         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7599
  7600     12  CO-TYPE-AGENT                     PIC X(01).
  7601         88  CO-CORPORATION                   VALUE 'C'.
  7602         88  CO-PARTNERSHIP                   VALUE 'P'.
  7603         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7604         88  CO-TRUST                         VALUE 'T'.
  7605         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7606
  7607     12  CO-FAXNO.
  7608         16  CO-FAX-AREA-CODE                  PIC XXX.
  7609         16  CO-FAX-PREFIX                     PIC XXX.
  7610         16  CO-FAX-PHONE                      PIC X(4).
  7611
  7612     12  CO-BANK-INFORMATION.
  7613         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7614         16  CO-BANK-TRANSIT-NON REDEFINES
  7615             CO-BANK-TRANSIT-NO                PIC 9(8).
  7616
  7617         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7618     12  CO-MISC-DEDUCT-INFO REDEFINES
  7619                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 143
* EL156.cbl
  7620         16  CO-MD-GL-ACCT                     PIC X(10).
  7621         16  CO-MD-DIV                         PIC XX.
  7622         16  CO-MD-CENTER                      PIC X(4).
  7623         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7624         16  CO-CREATE-AP-CHECK                PIC X.
  7625         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7626         16  FILLER                            PIC XXX.
  7627     12  CO-ACH-STATUS                         PIC X.
  7628         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7629         88  CO-ACH-PENDING                        VALUE 'P'.
  7630
  7631     12  CO-BILL-SW                            PIC X.
  7632     12  CO-CONTROL-NAME                       PIC X(30).
  7633     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7634     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7635     12  CO-CLP-STATE                          PIC XX.
  7636     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7637     12  CO-SPP-REFUND-EDIT                    PIC X.
  7638
  7639******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 144
* EL156.cbl
  7641*    COPY ERCDMDNT.
  7642******************************************************************
  7643*                                                                *
  7644*                            ERCDMDNT                            *
  7645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7646*                            VMOD=2.005                          *
  7647*                                                                *
  7648*        FILE DESCRIPTION = DMD CERTIFICATE NOTES                *
  7649*                                                                *
  7650*        THIS COPYBOOK IS A REDEFINES OF ERCNOTE -               *
  7651*                                                                *
  7652*        FILE TYPE= VSAM,KSDS                                    *
  7653*        RECORD SIZE = 825    RECFORM = FIXED                    *
  7654*                                                                *
  7655*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  7656*                                                                *
  7657*        LOG = YES                                               *
  7658*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7659*                                                                *
  7660******************************************************************
  7661
  7662 01  CERTIFICATE-NOTE.
  7663     12  CN-RECORD-ID                     PIC  XX.
  7664         88  VALID-CN-ID                      VALUE 'CN'.
  7665
  7666     12  CN-CONTROL-PRIMARY.
  7667         16  CN-COMPANY-CD                PIC X.
  7668         16  CN-CERT-KEY.
  7669             20  CN-CARRIER               PIC X.
  7670             20  CN-GROUPING.
  7671                 24  CN-GROUPING-PREFIX   PIC XXX.
  7672                 24  CN-GROUPING-PRIME    PIC XXX.
  7673             20  CN-STATE                 PIC XX.
  7674             20  CN-ACCOUNT.
  7675                 24  CN-ACCOUNT-PREFIX    PIC X(4).
  7676                 24  CN-ACCOUNT-PRIME     PIC X(6).
  7677             20  CN-CERT-EFF-DT           PIC XX.
  7678             20  CN-CERT-NO.
  7679                 24  CN-CERT-PRIME        PIC X(10).
  7680                 24  CN-CERT-SFX          PIC X.
  7681
  7682     12  CN-BILLING-START-LINE-NO         PIC 99.
  7683     12  CN-BILLING-END-LINE-NO           PIC 99.
  7684
  7685     12  CN-LINES.
  7686         16  CN-LINE                      PIC X(77)  OCCURS 10.
  7687
  7688     12  CN-CSI-NOTES REDEFINES CN-LINES.
  7689         16  CN-CSI-TEXT-NOTES            PIC X(77)  OCCURS 6.
  7690         16  CN-CSI-GENERAL-DATA-AREA.
  7691             20  CN-CSI-GENERAL-DATA      PIC X(77)  OCCURS 2.
  7692
  7693         16  CN-CSI-GENERAL-DATA-R REDEFINES
  7694             CN-CSI-GENERAL-DATA-AREA.
  7695             20  CN-CSI-GEN-NOC-KEY           PIC X(11).
  7696             20  CN-CSI-GEN-PRI-INSD-1ST-NAME PIC X(15).
  7697             20  CN-CSI-GEN-SEC-INSD-1ST-NAME PIC X(15).
  7698             20  CN-CSI-GEN-INSD-WORK-PHONE   PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 145
* EL156.cbl
  7699             20  CN-CSI-GEN-INFRM-1ST-NAME    PIC X(15).
  7700             20  CN-CSI-GEN-INFRM-LAST-NAME   PIC X(20).
  7701             20  CN-CSI-GEN-INFRM-MI          PIC X.
  7702             20  CN-CSI-GEN-INFRM-PHONE       PIC X(10).
  7703             20  CN-CSI-GEN-INFRM-REL         PIC X(15).
  7704             20  FILLER                       PIC XX.
  7705             20  CN-CSI-GEN-DATA-SOURCE       PIC XX.
  7706             20  FILLER                       PIC X(38).
  7707
  7708         16  CN-CSI-PRODUCT-DATA-AREA.
  7709             20  CN-CSI-PRODUCT-DATA      PIC X(77)  OCCURS 2.
  7710
  7711         16  CN-CSI-CREDIT-CARD-DATA REDEFINES
  7712             CN-CSI-PRODUCT-DATA-AREA.
  7713             20  CN-CSI-CC-BILL-BANK-ID   PIC X(6).
  7714             20  CN-CSI-CC-CANCEL-CD      PIC XX.
  7715             20  CN-CSI-CC-CANCEL-DT      PIC X(8).
  7716             20  CN-CSI-CC-CARD-TYPE      PIC XX.
  7717             20  CN-CSI-CC-CHANGE-AGE     PIC 999.
  7718             20  CN-CSI-CC-DIAGNOSIS-CD   PIC X(6).
  7719             20  FILLER                   PIC XX.
  7720             20  CN-CSI-CC-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7721             20  CN-CSI-CC-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7722             20  CN-CSI-CC-INTEREST-PAID  PIC X.
  7723             20  CN-CSI-CC-ISSUE-ST       PIC XX.
  7724             20  CN-CSI-CC-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7725             20  CN-CSI-CC-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7726             20  CN-CSI-CC-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7727             20  CN-CSI-CC-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7728             20  CN-CSI-CC-OLD-ACCT-NO    PIC X(20).
  7729             20  CN-CSI-CC-POLICY-TYPE    PIC XXX.
  7730             20  CN-CSI-CC-PREMIUM-AMT    PIC S999V99   COMP-3.
  7731             20  CN-CSI-CC-PREMIUM-RT     PIC S999V999  COMP-3.
  7732             20  CN-CSI-CC-PREV-CLAIM-NO  PIC X(7).
  7733             20  CN-CSI-CC-SIGNED-DT      PIC X(8).
  7734             20  CN-CSI-CC-SPECIAL-TERM   PIC S999      COMP-3.
  7735             20  CN-CSI-CC-STMNT-DT       PIC X(8).
  7736             20  CN-CSI-CC-TERM-AGE       PIC 999.
  7737             20  CN-CSI-CC-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7738             20  CN-CSI-CC-WAIV-PREM-FLAG PIC X.
  7739             20  CN-CSI-CC-ISSUE-DT       PIC X(8).
  7740             20  CN-CSI-CC-BEN-CALC-SW    PIC X.
  7741             20  CN-CSI-CC-TERM-ROUND-SW  PIC X.
  7742             20  FILLER                   PIC X(25).
  7743
  7744         16  CN-CSI-FAMILY-LEAVE-DATA REDEFINES
  7745             CN-CSI-CREDIT-CARD-DATA.
  7746             20  CN-CSI-FL-BILL-BANK-ID   PIC X(6).
  7747             20  CN-CSI-FL-CANCEL-CD      PIC XX.
  7748             20  CN-CSI-FL-CANCEL-DT      PIC X(8).
  7749             20  CN-CSI-FL-CARD-TYPE      PIC XX.
  7750             20  CN-CSI-FL-CHANGE-AGE     PIC 999.
  7751             20  CN-CSI-FL-DIAGNOSIS-CD   PIC X(6).
  7752             20  FILLER                   PIC XX.
  7753             20  CN-CSI-FL-INSURED-BAL    PIC S9(5)V99  COMP-3.
  7754             20  CN-CSI-FL-INTEREST-AMT   PIC S9(5)V99  COMP-3.
  7755             20  CN-CSI-FL-INTEREST-PAID  PIC X.
  7756             20  CN-CSI-FL-ISSUE-ST       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 146
* EL156.cbl
  7757             20  CN-CSI-FL-MAX-BEN-LIMIT  PIC S9(5)V99  COMP-3.
  7758             20  CN-CSI-FL-MAX-BENEFITS   PIC S9(5)V99  COMP-3.
  7759             20  CN-CSI-FL-MIN-PAY-AMT    PIC S9(5)V99  COMP-3.
  7760             20  CN-CSI-FL-MIN-PAY-PCT    PIC SV9(6)    COMP-3.
  7761             20  CN-CSI-FL-OLD-ACCT-NO    PIC X(20).
  7762             20  CN-CSI-FL-POLICY-TYPE    PIC XXX.
  7763             20  CN-CSI-FL-PREMIUM-AMT    PIC S999V99   COMP-3.
  7764             20  CN-CSI-FL-PREMIUM-RT     PIC S999V999  COMP-3.
  7765             20  CN-CSI-FL-PREV-CLAIM-NO  PIC X(7).
  7766             20  CN-CSI-FL-SIGNED-DT      PIC X(8).
  7767             20  CN-CSI-FL-SPECIAL-TERM   PIC S999      COMP-3.
  7768             20  CN-CSI-FL-STMNT-DT       PIC X(8).
  7769             20  CN-CSI-FL-TERM-AGE       PIC 999.
  7770             20  CN-CSI-FL-TOL-BALANCE    PIC S9(5)V99  COMP-3.
  7771             20  CN-CSI-FL-WAIV-PREM-FLAG PIC X.
  7772             20  CN-CSI-FL-ISSUE-DT       PIC X(8).
  7773             20  CN-CSI-FL-BEN-CALC-SW    PIC X.
  7774             20  CN-CSI-FL-TERM-ROUND-SW  PIC X.
  7775             20  CN-CSI-FL-LAST-DAY-WRKED PIC X(8).
  7776             20  FILLER                   PIC X(17).
  7777
  7778         16  CN-CSI-SENIOR-LIFE-DATA REDEFINES
  7779             CN-CSI-FAMILY-LEAVE-DATA.
  7780             20  CN-CSI-SL-BENE-DOB       PIC X(8).
  7781             20  CN-CSI-SL-BENE-NAME      PIC X(27).
  7782             20  CN-CSI-SL-BENE-REL       PIC X(8).
  7783             20  CN-CSI-SL-BENE-SSN       PIC S9(9)     COMP-3.
  7784             20  CN-CSI-SL-BILL-BANK-ID   PIC X(6).
  7785             20  CN-CSI-SL-CANCEL-DT      PIC X(8).
  7786             20  CN-CSI-SL-DIAGNOSIS-CD   PIC X(6).
  7787             20  CN-CSI-SL-INT-CHECK-DT   PIC X(8).
  7788             20  CN-CSI-SL-INT-CHECK-NO   PIC S9(7)     COMP-3.
  7789             20  CN-CSI-SL-INT-ON-PROCEEDS
  7790                                          PIC S9(5)V99  COMP-3.
  7791             20  CN-CSI-SL-ISSUE-DT       PIC X(8).
  7792             20  CN-CSI-SL-ISSUE-ST       PIC XX.
  7793             20  CN-CSI-SL-LIFE-PROCEEDS  PIC S9(5)V99  COMP-3.
  7794             20  CN-CSI-SL-LOAN-INT-DUE   PIC S9(5)V99  COMP-3.
  7795             20  CN-CSI-SL-POLICY-BENEFITS
  7796                                          PIC S9(5)V99  COMP-3.
  7797             20  CN-CSI-SL-POLICY-TYPE    PIC XXX.
  7798             20  CN-CSI-SL-PREM-AMT       PIC S9(5)V99  COMP-3.
  7799             20  CN-CSI-SL-PREM-CHECK-DT  PIC X(8).
  7800             20  CN-CSI-SL-PREM-CHECK-NO  PIC S9(7)     COMP-3.
  7801             20  CN-CSI-SL-PREM-DUE       PIC S9(5)V99  COMP-3.
  7802             20  CN-CSI-SL-PREM-MODE      PIC 99.
  7803             20  CN-CSI-SL-PREM-REFUND    PIC S9(5)V99  COMP-3.
  7804             20  CN-CSI-SL-PREM-SUSP-DT   PIC X(8).
  7805             20  CN-CSI-SL-SIGNED-DT      PIC X(8).
  7806             20  CN-CSI-SL-STATE-NOT      PIC X.
  7807             20  FILLER                   PIC XX.
  7808
  7809         16  CN-CSI-PURCH-PROP-DATA REDEFINES
  7810             CN-CSI-SENIOR-LIFE-DATA.
  7811             20  CN-CSI-PP-CARD-TYPE      PIC XX.
  7812             20  CN-CSI-PP-CHANGE-AGE     PIC 999.
  7813             20  CN-CSI-PP-BEN-PAID-TO-DATE
  7814                                          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 147
* EL156.cbl
  7815             20  CN-CSI-PP-BILL-BANK-ID   PIC X(6).
  7816             20  CN-CSI-PP-CANCEL-CD      PIC XX.
  7817             20  CN-CSI-PP-CANCEL-DT      PIC X(8).
  7818             20  CN-CSI-PP-DIAGNOSIS-CD   PIC X(6).
  7819             20  CN-CSI-PP-ISSUE-DT       PIC X(8).
  7820             20  CN-CSI-PP-ISSUE-ST       PIC XX.
  7821             20  CN-CSI-PP-MANUFACTURER   PIC X(17).
  7822             20  CN-CSI-PP-MODEL-NO       PIC X(8).
  7823             20  CN-CSI-PP-OLD-ACCT-NO    PIC X(20).
  7824             20  CN-CSI-PP-POLICY-TYPE    PIC XXX.
  7825             20  CN-CSI-PP-PREMIUM-RT     PIC S999V999  COMP-3.
  7826             20  CN-CSI-PP-PREV-CLAIM-NO  PIC X(7).
  7827             20  CN-CSI-PP-PURCHASE-DT    PIC X(8).
  7828             20  CN-CSI-PP-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7829             20  CN-CSI-PP-REPAIR         PIC X.
  7830             20  CN-CSI-PP-REPLACE        PIC X.
  7831             20  CN-CSI-PP-SERIAL-NO      PIC X(16).
  7832             20  CN-CSI-PP-SIGNED-DT      PIC X(8).
  7833             20  CN-CSI-PP-STMNT-DT       PIC X(8).
  7834             20  CN-CSI-PP-TERM-AGE       PIC 999.
  7835             20  FILLER                   PIC X(5).
  7836
  7837         16  CN-CSI-EXT-WARR-DATA REDEFINES
  7838             CN-CSI-PURCH-PROP-DATA.
  7839             20  CN-CSI-EW-CARD-TYPE      PIC XX.
  7840             20  CN-CSI-EW-CHANGE-AGE     PIC 999.
  7841             20  CN-CSI-EW-BILL-BANK-ID   PIC X(6).
  7842             20  CN-CSI-EW-CANCEL-CD      PIC XX.
  7843             20  CN-CSI-EW-CANCEL-DT      PIC X(8).
  7844             20  CN-CSI-EW-DIAGNOSIS-CD   PIC X(6).
  7845             20  CN-CSI-EW-ISSUE-DT       PIC X(8).
  7846             20  CN-CSI-EW-ISSUE-ST       PIC XX.
  7847             20  CN-CSI-EW-MANUFACTURER   PIC X(17).
  7848             20  CN-CSI-EW-MODEL-NO       PIC X(8).
  7849             20  CN-CSI-EW-OLD-ACCT-NO    PIC X(20).
  7850             20  CN-CSI-EW-POLICY-TYPE    PIC XXX.
  7851             20  CN-CSI-EW-PREMIUM-RT     PIC S999V999  COMP-3.
  7852             20  CN-CSI-EW-PREV-CLAIM-NO  PIC X(7).
  7853             20  CN-CSI-EW-PURCHASE-DT    PIC X(8).
  7854             20  CN-CSI-EW-PURCHASE-PRICE PIC S9(5)V99  COMP-3.
  7855             20  CN-CSI-EW-REPAIR-COST    PIC S9(5)V99  COMP-3.
  7856             20  CN-CSI-EW-REPLACE        PIC X.
  7857             20  CN-CSI-EW-SERIAL-NO      PIC X(16).
  7858             20  CN-CSI-EW-SIGNED-DT      PIC X(8).
  7859             20  CN-CSI-EW-STMNT-DT       PIC X(8).
  7860             20  CN-CSI-EW-TERM-AGE       PIC 999.
  7861             20  CN-CSI-EW-WARRANTY-NO    PIC 99.
  7862             20  FILLER                   PIC X(4).
  7863
  7864     12  CN-LAST-MAINT-DT                 PIC XX.
  7865     12  CN-LAST-MAINT-HHMMSS             PIC S9(7)     COMP-3.
  7866     12  CN-LAST-MAINT-USER               PIC X(4).
  7867     12  FILLER                           PIC X(6).
  7868
  7869******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 148
* EL156.cbl
  7871*    COPY ERCCNOT.
  7872******************************************************************
  7873*                                                                *
  7874*                            ERCCNOT                             *
  7875*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7876*                            VMOD=2.003                          *
  7877*                                                                *
  7878*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7879*                                                                *
  7880*        FILE TYPE= VSAM,KSDS                                    *
  7881*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7882*                                                                *
  7883*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7884*                                                                *
  7885*        LOG = YES                                               *
  7886*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7887*                                                                *
  7888******************************************************************
  7889*                   C H A N G E   L O G
  7890*
  7891* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7892*-----------------------------------------------------------------
  7893*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7894* EFFECTIVE    NUMBER
  7895*-----------------------------------------------------------------
  7896* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7897******************************************************************
  7898
  7899 01  CERT-NOTE-FILE.
  7900     12  CZ-RECORD-ID                PIC  XX.
  7901         88  VALID-CZ-ID                  VALUE 'CZ'.
  7902
  7903     12  CZ-CONTROL-PRIMARY.
  7904         16  CZ-COMPANY-CD           PIC X.
  7905         16  CZ-CARRIER              PIC X.
  7906         16  CZ-GROUPING.
  7907             20 CZ-GROUPING-PREFIX   PIC XXX.
  7908             20 CZ-GROUPING-PRIME    PIC XXX.
  7909         16  CZ-STATE                PIC XX.
  7910         16  CZ-ACCOUNT.
  7911             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7912             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7913         16  CZ-CERT-EFF-DT          PIC XX.
  7914         16  CZ-CERT-NO.
  7915             20  CZ-CERT-PRIME       PIC X(10).
  7916             20  CZ-CERT-SFX         PIC X.
  7917         16  CZ-RECORD-TYPE          PIC X.
  7918             88  CERT-NOTE           VALUE '1'.
  7919             88  CLAIM-CERT-NOTE     VALUE '2'.
  7920         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7921
  7922     12  CZ-LAST-MAINT-DT            PIC XX.
  7923     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7924     12  CZ-LAST-MAINT-USER          PIC X(4).
  7925
  7926     12  CZ-NOTE-INFORMATION.
  7927         16  CZ-NOTE                 PIC X(63).
  7928         16  FILLER                  PIC X(39).
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 149
* EL156.cbl
  7929******************************************************************
  7930*                            COPY ERCPDEF.
  7931******************************************************************
  7932*                                                                *
  7933*                                                                *
  7934*                            ERCPDEF.                            *
  7935*                                                                *
  7936*    FILE DESCRIPTION = PRODUCT DEFINITION MASTER                *
  7937*                                                                *
  7938*    FILE TYPE = VSAM,KSDS                                       *
  7939*    RECORD SIZE = 1319 RECFORM = FIXED                          *
  7940*                                                                *
  7941*    BASE CLUSTER = ERPDEF                      RKP=02,LEN=18    *
  7942*                                                                *
  7943*    LOG = YES                                                   *
  7944*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7945******************************************************************
  7946*                   C H A N G E   L O G
  7947*
  7948* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7949*-----------------------------------------------------------------
  7950*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7951* EFFECTIVE    NUMBER
  7952*-----------------------------------------------------------------
  7953* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7954* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7955* 100314  CR2014061900001  PEMA  ADD PCT OF BENEFIT
  7956******************************************************************
  7957 01  PRODUCT-MASTER.
  7958    12  PD-RECORD-ID                 PIC X(02).
  7959        88  VALID-PD-ID                  VALUE 'PD'.
  7960    12  PD-CONTROL-PRIMARY.
  7961        16  PD-COMPANY-CD            PIC X.
  7962        16  PD-STATE                 PIC XX.
  7963        16  PD-PRODUCT-CD            PIC XXX.
  7964        16  PD-FILLER                PIC X(7).
  7965        16  PD-BEN-TYPE              PIC X.
  7966        16  PD-BEN-CODE              PIC XX.
  7967        16  PD-PROD-EXP-DT           PIC XX.
  7968    12  FILLER                       PIC X(50).
  7969    12  PD-PRODUCT-DATA OCCURS 8.
  7970        16  PD-PROD-CODE             PIC X.
  7971            88  PD-PROD-LIFE           VALUE 'L'.
  7972            88  PD-PROD-PROP           VALUE 'P'.
  7973            88  PD-PROD-AH             VALUE 'A'.
  7974            88  PD-PROD-IU             VALUE 'I'.
  7975            88  PD-PROD-GAP            VALUE 'G'.
  7976            88  PD-PROD-FAML           VALUE 'F'.
  7977        16  PD-MAX-ATT-AGE           PIC S999        COMP-3.
  7978        16  PD-MIN-ISSUE-AGE         PIC S999        COMP-3.
  7979        16  PD-MAX-ISSUE-AGE         PIC S999        COMP-3.
  7980        16  PD-MAX-TERM              PIC S999        COMP-3.
  7981        16  PD-MAX-AMT               PIC S9(07)      COMP-3.
  7982        16  FILLER                   PIC X.
  7983        16  PD-PRE-EXIST-EXCL-TYPE   PIC 99.
  7984        16  PD-EXCLUSION-PERIOD-DAYS PIC S999        COMP-3.
  7985        16  PD-COVERAGE-ENDS-MOS     PIC S999        COMP-3.
  7986        16  PD-ACCIDENT-ONLY-MOS     PIC S999        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 150
* EL156.cbl
  7987        16  PD-CRIT-PERIOD           PIC S999        COMP-3.
  7988        16  PD-REC-CRIT-PERIOD       PIC 99.
  7989        16  PD-REC-CP-ALPHA  REDEFINES PD-REC-CRIT-PERIOD.
  7990            20  PD-RECURRING-YN      PIC X.
  7991            20  FILLER               PIC X.
  7992        16  PD-RTW-MOS               PIC 99.
  7993        16  PD-MAX-EXTENSION         PIC 99.
  7994        16  pd-ben-pct               pic sv999 comp-3.
  7995*       16  FILLER                   PIC XX.
  7996    12  PD-1ST-YR-ADMIN-ALLOW        PIC S9(3)V99    COMP-3.
  7997    12  PD-TERM-LIMITS OCCURS 15.
  7998        16  PD-LOW-TERM              PIC S999        COMP-3.
  7999        16  PD-HI-TERM               PIC S999        COMP-3.
  8000*  THE LOAN AMT LIMITS CORRESPOND TO THE TERM LIMITS ABOVE
  8001    12  PD-LOAN-AMT-LIMITS OCCURS 15.
  8002        16  PD-LOW-AMT               PIC S9(5)       COMP-3.
  8003        16  PD-HI-AMT                PIC S9(7)       COMP-3.
  8004    12  PD-EARN-FACTORS.
  8005        16  FILLER OCCURS 15.
  8006            20  FILLER OCCURS 15.
  8007                24  PD-UEP-FACTOR    PIC S9V9(3)     COMP-3.
  8008    12  PD-PRODUCT-DESC              PIC X(80).
  8009    12  PD-TRUNCATED                 PIC X.
  8010    12  FILLER                       PIC X(59).
  8011    12  PD-MAINT-INFORMATION.
  8012        16  PD-LAST-MAINT-DT         PIC X(02).
  8013        16  PD-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  8014        16  PD-LAST-MAINT-BY         PIC X(04).
  8015*                            COPY ELCCRTT.
  8016******************************************************************
  8017*                                                                *
  8018*                            ELCCRTT.                            *
  8019*                                                                *
  8020*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  8021*                                                                *
  8022*   FILE TYPE = VSAM,KSDS                                        *
  8023*   RECORD SIZE = 552  RECFORM = FIXED                           *
  8024*                                                                *
  8025*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  8026*                                                                *
  8027*   LOG = YES                                                    *
  8028*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8029******************************************************************
  8030*                   C H A N G E   L O G
  8031*
  8032* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8033*-----------------------------------------------------------------
  8034*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8035* EFFECTIVE    NUMBER
  8036*-----------------------------------------------------------------
  8037* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  8038* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  8039* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  8040* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8041* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  8042* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  8043* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  8044* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 151
* EL156.cbl
  8045******************************************************************
  8046
  8047 01  CERTIFICATE-TRAILERS.
  8048     12  CS-RECORD-ID                      PIC XX.
  8049         88  VALID-CS-ID                      VALUE 'CS'.
  8050
  8051     12  CS-CONTROL-PRIMARY.
  8052         16  CS-COMPANY-CD                 PIC X.
  8053         16  CS-CARRIER                    PIC X.
  8054         16  CS-GROUPING                   PIC X(6).
  8055         16  CS-STATE                      PIC XX.
  8056         16  CS-ACCOUNT                    PIC X(10).
  8057         16  CS-CERT-EFF-DT                PIC XX.
  8058         16  CS-CERT-NO.
  8059             20  CS-CERT-PRIME             PIC X(10).
  8060             20  CS-CERT-SFX               PIC X.
  8061         16  CS-TRAILER-TYPE               PIC X.
  8062             88  COMM-TRLR           VALUE 'A'.
  8063             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  8064             88  CERT-DATA-TRLR      VALUE 'C'.
  8065
  8066     12  CS-DATA-AREA                      PIC X(516).
  8067
  8068     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  8069         16  CS-BANK-COMMISSION-AREA.
  8070             20  CS-BANK-COMMS       OCCURS 10.
  8071                 24  CS-AGT                PIC X(10).
  8072                 24  CS-COM-TYP            PIC X.
  8073                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  8074                 24  CS-RECALC-LV-INDIC    PIC X.
  8075                 24  FILLER                PIC X(10).
  8076         16  FILLER                        PIC X(256).
  8077
  8078     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  8079****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  8080         16  CS-MB-CLAIM-DATA OCCURS 24.
  8081             20  CS-CLAIM-NO               PIC X(7).
  8082             20  CS-CLAIM-TYPE             PIC X.
  8083                 88  CS-AH-CLM               VALUE 'A'.
  8084                 88  CS-IU-CLM               VALUE 'I'.
  8085                 88  CS-GP-CLM               VALUE 'G'.
  8086                 88  CS-LF-CLM               VALUE 'L'.
  8087                 88  CS-PR-CLM               VALUE 'P'.
  8088                 88  CS-FL-CLM               VALUE 'F'.
  8089             20  CS-INSURED-TYPE           PIC X.
  8090                 88  CS-PRIM-INSURED          VALUE 'P'.
  8091                 88  CS-CO-BORROWER           VALUE 'C'.
  8092             20  CS-BENEFIT-PERIOD         PIC 99.
  8093             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8094             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8095             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8096         16  FILLER                        PIC X(12).
  8097     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8098         16  CS-VIN-NUMBER                 PIC X(17).
  8099         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8100         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8101         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8102         16  cs-agent-name.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 152
* EL156.cbl
  8103             20  cs-agent-fname            pic x(20).
  8104             20  cs-agent-mi               pic x.
  8105             20  cs-agent-lname            pic x(25).
  8106         16  cs-license-no                 pic x(15).
  8107         16  cs-npn-number                 pic x(10).
  8108         16  cs-agent-edit-status          pic x.
  8109             88  cs-ae-refer-to-manager      value 'M'.
  8110             88  cs-ae-cover-sheet           value 'C'.
  8111             88  cs-ae-sig-form              value 'S'.
  8112             88  cs-ae-verified              value 'V'.
  8113             88  cs-unidentified-signature   value 'U'.
  8114             88  cs-cert-returned            value 'R'.
  8115             88  cs-accept-no-commission     value 'N'.
  8116         16  FILLER                        PIC X(424).
  8117*        16  FILLER                        PIC X(496).
  8118 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  8119                          CONTROL-FILE CERTIFICATE-MASTER
  8120                          ACTIVITY-TRAILERS ACTIVITY-QUE
  8121                          ACCOUNT-MASTER CHECK-QUE
  8122                          BENEFICIARY-MASTER LETTER-ARCHIVE
  8123                          DAILY-ACTIVITY-RECORD
  8124                          COMPENSATION-MASTER CERTIFICATE-NOTE
  8125                          CERT-NOTE-FILE PRODUCT-MASTER
  8126                          CERTIFICATE-TRAILERS.
  8127 0000-DFHEXIT SECTION.
  8128     MOVE '9#                    $   ' TO DFHEIV0.
  8129     MOVE 'EL156' TO DFHEIV1.
  8130     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8131
  8132     IF EIBCALEN = 0
  8133         GO TO 8800-UNAUTHORIZED-ACCESS.
  8134
  8135     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8136     MOVE EIBTRMID               TO QID-TERM.
  8137     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8138     MOVE '2'                    TO EMI-SWITCH2.
  8139     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8140     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
  8141
  8142     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8143     MOVE '5'                    TO DC-OPTION-CODE.
  8144     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  8145     MOVE DC-BIN-DATE-1          TO WS-TODAY-DATE
  8146                                    SAVE-BIN-DATE.
  8147     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE.
  8148     MOVE DC-GREG-DATE-1-YMD     TO SAVE-DATE-YMD.
  8149
  8150     IF SAVE-DATE-YY > 70
  8151         MOVE 19                 TO SAVE-DATE-CC
  8152     ELSE
  8153         MOVE 20                 TO SAVE-DATE-CC.
  8154
  8155     IF PI-PROOF-DATE NOT = 0 AND LOW-VALUES
  8156         MOVE PI-PROOF-DATE TO WS-PROOF-DATE
  8157     END-IF.
  8158
  8159     IF PI-PRINT-EOB-YN = 'Y' OR 'S'
  8160        MOVE PI-PRINT-EOB-YN     TO WS-PRINT-EOB-YN
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 153
* EL156.cbl
  8161     ELSE
  8162        MOVE 'N'                 TO WS-PRINT-EOB-YN
  8163     END-IF
  8164
  8165     IF PI-PRINT-CLM-FRM-YN = 'N'
  8166         MOVE PI-PRINT-CLM-FRM-YN TO WS-PRINT-CLM-FRM-YN
  8167     ELSE
  8168         MOVE 'Y'                TO WS-PRINT-CLM-FRM-YN
  8169     END-IF
  8170
  8171     IF PI-PRINT-SURVEY-YN = 'N'
  8172         MOVE PI-PRINT-SURVEY-YN TO WS-PRINT-SURVEY-YN
  8173     ELSE
  8174         MOVE 'Y'                TO WS-PRINT-SURVEY-YN
  8175     END-IF
  8176
  8177     IF PI-SPECIAL-RELEASE-YN = 'Y'
  8178         MOVE PI-SPECIAL-RELEASE-YN TO WS-SPECIAL-RELEASE-YN
  8179     ELSE
  8180         MOVE 'N'                TO WS-SPECIAL-RELEASE-YN
  8181     END-IF
  8182
  8183* EXEC CICS HANDLE CONDITION
  8184*        NOTOPEN   (9990-ABEND)
  8185*        PGMIDERR  (8600-PGRM-NOT-FOUND)
  8186*        MAPFAIL   (0400-FIRST-TIME)
  8187*        DUPREC    (6180-DUPREC)
  8188*        ERROR     (9990-ABEND)
  8189*    END-EXEC.
  8190*    MOVE '"$JL?%.               ! " #00008178' TO DFHEIV0
  8191     MOVE X'22244A4C3F252E2020202020' TO DFHEIV0(1:12)
  8192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8193     MOVE X'2220233030303038313738' TO DFHEIV0(25:11)
  8194     CALL 'kxdfhei1' USING DFHEIV0
  8195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8196
  8197
  8198     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  8199         MOVE PI-CALLING-PROGRAM TO RETURNED-FROM.
  8200
  8201     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8202         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8203             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8204             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  8205             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8206             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8207             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8208             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8209             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8210             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8211             MOVE LOW-VALUES           TO EL156AI
  8212             MOVE 'Y'                  TO FIRST-ENTRY
  8213         ELSE
  8214             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8215             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8216             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8217             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8218             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 154
* EL156.cbl
  8219             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8220             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8221             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  8222
  8223     IF RETURNED-FROM NOT = SPACES
  8224        IF (RETURNED-FROM = 'EL614')
  8225           MOVE PI-PROGRAM-WORK-AREA (1:60) TO WS-SAVED-EOB-CODES
  8226           IF WS-SAVED-EOB-CODES NOT = SPACES
  8227              MOVE 'Y'                TO WS-SET-NOTE2-MDT
  8228           ELSE
  8229              MOVE 'N'                TO WS-SET-NOTE2-MDT
  8230           END-IF
  8231        END-IF
  8232         PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8233            MOVE 'Y'             TO FIRST-ENTRY
  8234            IF RETURNED-FROM = 'EL614'
  8235               AND (PI-PASS-SW NOT = 'C')
  8236               IF WS-SAVED-EOB-CODES NOT = SPACES
  8237                  MOVE WS-SAVED-EOB-CODES
  8238                                 TO PI-PMTNOTE2
  8239                                    WS-PMTNOTE2
  8240                  MOVE 'Y'       TO PI-EOB-CODES-EXIST
  8241               ELSE
  8242                  MOVE SPACES    TO PI-PMTNOTE2
  8243                                    WS-PMTNOTE2
  8244                                    PI-EOB-CODES-EXIST
  8245               END-IF
  8246            END-IF
  8247            PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
  8248            PERFORM 7010-BUILD-MAP THRU 7023-BYPASS-REMAINING-TERM
  8249            IF RETURNED-FROM = 'EL614'
  8250               GO TO 1000-EDIT-DATA
  8251            END-IF
  8252            IF (PMTTYPEI = LOW-VALUES OR SPACES) AND
  8253               (PAYEEI   = LOW-VALUES OR SPACES)
  8254               GO TO 8100-SEND-INITIAL-MAP
  8255            ELSE
  8256               GO TO 1000-EDIT-DATA.
  8257
  8258     IF EIBTRNID NOT = TRANS-ID
  8259         GO TO 0400-FIRST-TIME.
  8260
  8261     IF EIBAID = DFHCLEAR
  8262        IF PI-PASS-SW = 'C'
  8263           PERFORM 0600-RECOVER-TEMP-STORAGE THRU 0699-EXIT
  8264           PERFORM 3050-REBUILD-ENTERED      THRU 3059-EXIT
  8265           PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
  8266           MOVE 'Y'            TO RETURNED-FROM-B
  8267           GO TO 1000-EDIT-DATA
  8268        ELSE
  8269           GO TO 9400-CLEAR.
  8270
  8271     IF PI-PASS-SW = 'C'
  8272         MOVE MAP-NAMEB          TO MAP-NAME
  8273         IF EIBAID = DFHPF1 OR DFHPF13
  8274             GO TO 5000-UPDATE
  8275           ELSE
  8276             IF EIBAID NOT = DFHENTER
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 155
* EL156.cbl
  8277                 MOVE LOW-VALUES TO EL156BI
  8278                 MOVE MAP-NAMEB  TO MAP-NAME
  8279                 MOVE ER-0029    TO EMI-ERROR
  8280                 MOVE -1         TO  ENTPFBL
  8281                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8282                 GO TO 8200-SEND-DATAONLY.
  8283
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 156
* EL156.cbl
  8285 0200-RECEIVE.
  8286     MOVE LOW-VALUES             TO EL156AI.
  8287     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8288         MOVE ER-0008            TO EMI-ERROR
  8289         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8290         IF PI-PASS-SW = 'C'
  8291             MOVE -1             TO ENTPFBL
  8292             GO TO 8200-SEND-DATAONLY
  8293         ELSE
  8294             MOVE -1             TO PMTTYPEL
  8295             GO TO 8200-SEND-DATAONLY.
  8296
  8297     IF PI-COMPANY-ID = 'DMD'
  8298         PERFORM 7700-GET-DCT THRU 7700-EXIT.
  8299
  8300     IF PI-PASS-SW = 'C'
  8301         MOVE MAP-NAMEB          TO MAP-NAME.
  8302
  8303
  8304* EXEC CICS RECEIVE
  8305*        MAP   (MAP-NAME)
  8306*        MAPSET(MAPSET-NAME)
  8307*        ASIS
  8308*        INTO  (EL156AI)
  8309*    END-EXEC.
  8310     MOVE LENGTH OF
  8311      EL156AI
  8312       TO DFHEIV11
  8313*    MOVE '8"TAI  L              ''   #00008291' TO DFHEIV0
  8314     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8315     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8316     MOVE X'2020233030303038323931' TO DFHEIV0(25:11)
  8317     CALL 'kxdfhei1' USING DFHEIV0,
  8318           MAP-NAME,
  8319           EL156AI,
  8320           DFHEIV11,
  8321           MAPSET-NAME,
  8322           DFHEIV99,
  8323           DFHEIV99
  8324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8325
  8326
  8327     IF PI-PASS-SW NOT = 'C'
  8328         GO TO 0250-MAPA.
  8329
  8330     IF ENTPFBL NOT > ZERO
  8331         MOVE MAP-NAMEB          TO MAP-NAME
  8332         MOVE ER-0029            TO EMI-ERROR
  8333         MOVE -1                 TO  ENTPFBL
  8334         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8335         GO TO 8200-SEND-DATAONLY.
  8336
  8337     IF (ENTPFBI NUMERIC) AND (ENTPFBI > 0 AND < 25)
  8338         MOVE PF-VALUES (ENTPFBI) TO EIBAID
  8339       ELSE
  8340         MOVE MAP-NAMEB           TO MAP-NAME
  8341         MOVE ER-0029             TO EMI-ERROR
  8342         MOVE -1                  TO ENTPFBL
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 157
* EL156.cbl
  8343         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8344         GO TO 8200-SEND-DATAONLY.
  8345
  8346     IF EIBAID = DFHPF1 OR DFHPF13
  8347         IF MODIFY-CAP
  8348            GO TO 5000-UPDATE
  8349          ELSE
  8350            MOVE 'UPDATE'           TO SM-READ
  8351            PERFORM 9995-SECURITY-VIOLATION
  8352            MOVE MAP-NAMEB          TO MAP-NAME
  8353            MOVE ER-0070            TO EMI-ERROR
  8354            MOVE -1                 TO  ENTPFBL
  8355            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8356            GO TO 8200-SEND-DATAONLY.
  8357
  8358 0250-MAPA.
  8359     IF ENTERPFL = 0
  8360         GO TO 0300-CHECK-PFKEYS.
  8361
  8362     IF EIBAID NOT = DFHENTER
  8363         MOVE ER-0004            TO EMI-ERROR
  8364         GO TO 0320-INPUT-ERROR.
  8365
  8366     IF (ENTERPFI NUMERIC) AND (ENTERPFI > 0 AND < 25)
  8367         MOVE PF-VALUES (ENTERPFI) TO EIBAID
  8368     ELSE
  8369         MOVE ER-0029            TO EMI-ERROR
  8370         GO TO 0320-INPUT-ERROR.
  8371
  8372 0300-CHECK-PFKEYS.
  8373     IF EIBAID = DFHPF7 OR DFHPF8
  8374         GO TO 8820-PF7-8.
  8375
  8376     IF EIBAID = DFHPF23
  8377         GO TO 8810-PF23.
  8378
  8379     IF EIBAID = DFHPF24
  8380         GO TO 9200-RETURN-MAIN-MENU.
  8381
  8382     IF EIBAID = DFHPF12
  8383         GO TO 9500-PF12.
  8384
  8385     IF EIBAID = DFHPF1
  8386        IF PI-PASS-SW = 'A' OR 'B'
  8387          GO TO 0330-BROWSE-FORWARD.
  8388
  8389     IF EIBAID = DFHPF2
  8390        IF PI-PASS-SW = 'A' OR 'B'
  8391          GO TO 0350-BROWSE-BACKWARD.
  8392
  8393     IF EIBAID = DFHPF6
  8394        IF PI-EOB-CODES-EXIST = 'Y'
  8395           MOVE PI-PMTNOTE2         TO WS-PMTNOTE2
  8396        ELSE
  8397           MOVE SPACES              TO WS-PMTNOTE2
  8398        END-IF
  8399         PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT
  8400         IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 158
* EL156.cbl
  8401            MOVE WS-SAVE-INPUT   TO PI-SAVE-INPUT
  8402         END-IF
  8403         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  8404         IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  8405             MOVE 'EL614'        TO PGM-NAME
  8406             MOVE WS-PMTNOTE2    TO PI-PROGRAM-WORK-AREA
  8407             GO TO 9300-XCTL
  8408         ELSE
  8409             MOVE XCTL-157       TO PGM-NAME
  8410             GO TO 9300-XCTL.
  8411
  8412     IF EIBAID = DFHPF9
  8413        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8414        MOVE XCTL-141            TO PGM-NAME
  8415        GO TO 9300-XCTL.
  8416
  8417     IF EIBAID = DFHPF10
  8418        PERFORM 0500-CREATE-TEMP-STORAGE  THRU 0599-EXIT
  8419        MOVE XCTL-155            TO PGM-NAME
  8420        GO TO 9300-XCTL.
  8421
  8422     MOVE SPACES                 TO ERRMSG0O
  8423                                    ERRMSG1O
  8424                                    ERRMSG2O.
  8425
  8426     IF EIBAID = DFHPF3 OR DFHPF4 OR DFHPF5
  8427         IF PI-PASS-SW NOT = 'B'
  8428             MOVE ER-0422        TO EMI-ERROR
  8429             GO TO 0320-INPUT-ERROR
  8430           ELSE
  8431             GO TO 0700-TEST-FOR-CHANGES.
  8432
  8433     IF EIBAID = DFHPF11
  8434        IF PI-PASS-SW = 'C'
  8435           MOVE ER-0029          TO EMI-ERROR
  8436           GO TO 0320-INPUT-ERROR.
  8437
  8438     IF EIBAID = DFHENTER OR DFHPF11
  8439        NEXT SENTENCE
  8440     ELSE
  8441        MOVE ER-0029             TO EMI-ERROR
  8442        GO TO 0320-INPUT-ERROR.
  8443
  8444     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8445
  8446     if pi-epyfrom not = zeros
  8447        if pi-epyfrom not = ws-epyfrom
  8448           move zeros        to ws-edays
  8449        end-if
  8450     end-if
  8451
  8452     if pi-epythru not = zeros
  8453        if pi-epythru not = ws-epythru
  8454           move zeros        to ws-edays
  8455        end-if
  8456     end-if
  8457
  8458     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 159
* EL156.cbl
  8459         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  8460         GO TO 1000-EDIT-DATA
  8461     ELSE
  8462         IF PI-FATAL-COUNT NOT = 0 OR
  8463            PI-FORCE-COUNT NOT = 0
  8464             GO TO 1000-EDIT-DATA
  8465         ELSE
  8466             GO TO 2000-EDIT-DONE.
  8467
  8468 0320-INPUT-ERROR.
  8469     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8470
  8471     IF ENTERPFL = 0
  8472         MOVE -1                 TO PMTTYPEL
  8473     ELSE
  8474         MOVE AL-UNBON           TO ENTERPFA
  8475         MOVE -1                 TO ENTERPFL.
  8476
  8477     GO TO 8200-SEND-DATAONLY.
  8478
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 160
* EL156.cbl
  8480 0330-BROWSE-FORWARD.
  8481
  8482     MOVE CLMNOI            TO PI-CLAIM-NO.
  8483     MOVE CARRI             TO PI-CARRIER.
  8484     MOVE CERTNOI           TO PI-CERT-PRIME.
  8485     MOVE SUFXI             TO PI-CERT-SFX.
  8486
  8487     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8488     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8489     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8490     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8491
  8492     MOVE ELMSTR-KEY        TO WS-HOLD-ELMSTR-KEY.
  8493
  8494
  8495* EXEC CICS HANDLE CONDITION
  8496*         NOTFND   (0380-CLAIM-END-FILE)
  8497*         ENDFILE  (0380-CLAIM-END-FILE)
  8498*    END-EXEC.
  8499*    MOVE '"$I''                  ! # #00008465' TO DFHEIV0
  8500     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8502     MOVE X'2320233030303038343635' TO DFHEIV0(25:11)
  8503     CALL 'kxdfhei1' USING DFHEIV0
  8504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8505
  8506
  8507
  8508* EXEC CICS STARTBR
  8509*         DATASET    ('ELMSTR')
  8510*         RIDFLD     (ELMSTR-KEY)
  8511*         GTEQ
  8512*    END-EXEC.
  8513     MOVE 'ELMSTR' TO DFHEIV1
  8514     MOVE 0
  8515       TO DFHEIV11
  8516*    MOVE '&,         G          &   #00008470' TO DFHEIV0
  8517     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8518     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8519     MOVE X'2020233030303038343730' TO DFHEIV0(25:11)
  8520     CALL 'kxdfhei1' USING DFHEIV0,
  8521           DFHEIV1,
  8522           ELMSTR-KEY,
  8523           DFHEIV99,
  8524           DFHEIV11,
  8525           DFHEIV99
  8526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8527
  8528
  8529     MOVE 'Y' TO WS-BROWSE-START-SW.
  8530
  8531 0335-READNEXT.
  8532
  8533
  8534* EXEC CICS READNEXT
  8535*         DATASET    ('ELMSTR')
  8536*         RIDFLD     (ELMSTR-KEY)
  8537*         SET        (ADDRESS OF CLAIM-MASTER)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 161
* EL156.cbl
  8538*    END-EXEC.
  8539     MOVE 'ELMSTR' TO DFHEIV1
  8540     MOVE 0
  8541       TO DFHEIV11
  8542*    MOVE '&.S                   )   #00008480' TO DFHEIV0
  8543     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8544     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8545     MOVE X'2020233030303038343830' TO DFHEIV0(25:11)
  8546     CALL 'kxdfhei1' USING DFHEIV0,
  8547           DFHEIV1,
  8548           DFHEIV20,
  8549           DFHEIV99,
  8550           ELMSTR-KEY,
  8551           DFHEIV99,
  8552           DFHEIV11,
  8553           DFHEIV99,
  8554           DFHEIV99
  8555     SET ADDRESS OF CLAIM-MASTER TO
  8556         DFHEIV20
  8557     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8558
  8559
  8560     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8561        GO TO 0380-CLAIM-END-FILE.
  8562
  8563     IF ELMSTR-KEY = WS-HOLD-ELMSTR-KEY
  8564        MOVE CL-CLAIM-NO         TO  PI-PREV-CLMNO
  8565        GO TO 0335-READNEXT.
  8566
  8567     IF PI-COMPANY-ID = 'CRI'
  8568         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8569            GO TO 0380-CLAIM-END-FILE.
  8570
  8571     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8572         GO TO 0335-READNEXT.
  8573
  8574     IF PI-CARRIER-SECURITY > SPACES
  8575         IF CL-CARRIER = PI-CARRIER-SECURITY
  8576             NEXT SENTENCE
  8577         ELSE
  8578             GO TO 0335-READNEXT.
  8579
  8580     IF PI-ACCOUNT-SECURITY > SPACES
  8581         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8582             NEXT SENTENCE
  8583         ELSE
  8584             GO TO 0335-READNEXT.
  8585
  8586     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8587     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8588     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8589
  8590     GO TO 0400-FIRST-TIME.
  8591
  8592 0350-BROWSE-BACKWARD.
  8593
  8594     MOVE CLMNOI            TO PI-CLAIM-NO
  8595                               PI-PREV-CLMNO.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 162
* EL156.cbl
  8596     MOVE CARRI             TO PI-CARRIER.
  8597     MOVE CERTNOI           TO PI-CERT-PRIME.
  8598     MOVE SUFXI             TO PI-CERT-SFX.
  8599
  8600     MOVE PI-CARRIER        TO MSTR-CARRIER.
  8601
  8602     MOVE PI-COMPANY-CD     TO MSTR-COMP-CD.
  8603     MOVE PI-CLAIM-NO       TO MSTR-CLAIM-NO.
  8604     MOVE PI-CERT-NO        TO MSTR-CERT-NO.
  8605
  8606
  8607* EXEC CICS HANDLE CONDITION
  8608*         NOTFND   (0380-CLAIM-END-FILE)
  8609*         ENDFILE  (0380-CLAIM-END-FILE)
  8610*    END-EXEC.
  8611*    MOVE '"$I''                  ! $ #00008532' TO DFHEIV0
  8612     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8613     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8614     MOVE X'2420233030303038353332' TO DFHEIV0(25:11)
  8615     CALL 'kxdfhei1' USING DFHEIV0
  8616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8617
  8618
  8619
  8620* EXEC CICS STARTBR
  8621*         DATASET    ('ELMSTR')
  8622*         RIDFLD     (ELMSTR-KEY)
  8623*         GTEQ
  8624*    END-EXEC.
  8625     MOVE 'ELMSTR' TO DFHEIV1
  8626     MOVE 0
  8627       TO DFHEIV11
  8628*    MOVE '&,         G          &   #00008537' TO DFHEIV0
  8629     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8630     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8631     MOVE X'2020233030303038353337' TO DFHEIV0(25:11)
  8632     CALL 'kxdfhei1' USING DFHEIV0,
  8633           DFHEIV1,
  8634           ELMSTR-KEY,
  8635           DFHEIV99,
  8636           DFHEIV11,
  8637           DFHEIV99
  8638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8639
  8640
  8641     MOVE 'Y' TO WS-BROWSE-START-SW.
  8642
  8643
  8644* EXEC CICS READNEXT
  8645*         DATASET    ('ELMSTR')
  8646*         RIDFLD     (ELMSTR-KEY)
  8647*         SET        (ADDRESS OF CLAIM-MASTER)
  8648*    END-EXEC.
  8649     MOVE 'ELMSTR' TO DFHEIV1
  8650     MOVE 0
  8651       TO DFHEIV11
  8652*    MOVE '&.S                   )   #00008545' TO DFHEIV0
  8653     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 163
* EL156.cbl
  8654     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8655     MOVE X'2020233030303038353435' TO DFHEIV0(25:11)
  8656     CALL 'kxdfhei1' USING DFHEIV0,
  8657           DFHEIV1,
  8658           DFHEIV20,
  8659           DFHEIV99,
  8660           ELMSTR-KEY,
  8661           DFHEIV99,
  8662           DFHEIV11,
  8663           DFHEIV99,
  8664           DFHEIV99
  8665     SET ADDRESS OF CLAIM-MASTER TO
  8666         DFHEIV20
  8667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8668
  8669
  8670
  8671* EXEC CICS READPREV
  8672*         DATASET    ('ELMSTR')
  8673*         RIDFLD     (ELMSTR-KEY)
  8674*         SET        (ADDRESS OF CLAIM-MASTER)
  8675*    END-EXEC.
  8676     MOVE 'ELMSTR' TO DFHEIV1
  8677     MOVE 0
  8678       TO DFHEIV11
  8679*    MOVE '&0S                   )   #00008551' TO DFHEIV0
  8680     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8681     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8682     MOVE X'2020233030303038353531' TO DFHEIV0(25:11)
  8683     CALL 'kxdfhei1' USING DFHEIV0,
  8684           DFHEIV1,
  8685           DFHEIV20,
  8686           DFHEIV99,
  8687           ELMSTR-KEY,
  8688           DFHEIV99,
  8689           DFHEIV11,
  8690           DFHEIV99,
  8691           DFHEIV99
  8692     SET ADDRESS OF CLAIM-MASTER TO
  8693         DFHEIV20
  8694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8695
  8696
  8697 0360-BROWSE-BACKWARD.
  8698
  8699
  8700* EXEC CICS READPREV
  8701*         DATASET    ('ELMSTR')
  8702*         RIDFLD     (ELMSTR-KEY)
  8703*         SET        (ADDRESS OF CLAIM-MASTER)
  8704*    END-EXEC.
  8705     MOVE 'ELMSTR' TO DFHEIV1
  8706     MOVE 0
  8707       TO DFHEIV11
  8708*    MOVE '&0S                   )   #00008559' TO DFHEIV0
  8709     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8710     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8711     MOVE X'2020233030303038353539' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 164
* EL156.cbl
  8712     CALL 'kxdfhei1' USING DFHEIV0,
  8713           DFHEIV1,
  8714           DFHEIV20,
  8715           DFHEIV99,
  8716           ELMSTR-KEY,
  8717           DFHEIV99,
  8718           DFHEIV11,
  8719           DFHEIV99,
  8720           DFHEIV99
  8721     SET ADDRESS OF CLAIM-MASTER TO
  8722         DFHEIV20
  8723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8724
  8725
  8726     IF PI-COMPANY-CD NOT = MSTR-COMP-CD
  8727        GO TO 0380-CLAIM-END-FILE.
  8728
  8729     IF PI-COMPANY-ID = 'CRI'
  8730         IF CL-CLAIM-NO  NOT =  PI-PREV-CLMNO
  8731            GO TO 0380-CLAIM-END-FILE.
  8732
  8733     IF CL-SYSTEM-IDENTIFIER = 'CV'
  8734         GO TO 0360-BROWSE-BACKWARD.
  8735
  8736     IF PI-CARRIER-SECURITY > SPACES
  8737         IF CL-CARRIER = PI-CARRIER-SECURITY
  8738             NEXT SENTENCE
  8739         ELSE
  8740             GO TO 0360-BROWSE-BACKWARD.
  8741
  8742     IF PI-ACCOUNT-SECURITY > SPACES
  8743         IF CL-CERT-ACCOUNT = PI-ACCOUNT-SECURITY
  8744             NEXT SENTENCE
  8745         ELSE
  8746             GO TO 0360-BROWSE-BACKWARD.
  8747
  8748     MOVE MSTR-CARRIER      TO PI-CARRIER.
  8749     MOVE MSTR-CLAIM-NO     TO PI-CLAIM-NO.
  8750     MOVE MSTR-CERT-NO      TO PI-CERT-NO.
  8751
  8752     GO TO 0400-FIRST-TIME.
  8753
  8754 0380-CLAIM-END-FILE.
  8755
  8756     MOVE ER-0130     TO EMI-ERROR.
  8757     MOVE -1          TO CLMNOL.
  8758     MOVE AL-UABON    TO CARRA
  8759                         CLMNOA
  8760                         CERTNOA
  8761                         SUFXA.
  8762
  8763     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8764
  8765     GO TO 8200-SEND-DATAONLY.
  8766
  8767 0400-FIRST-TIME.
  8768
  8769     IF WS-BROWSE-START-SW = 'Y'
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 165
* EL156.cbl
  8770        MOVE 'N'         TO WS-BROWSE-START-SW
  8771
  8772* EXEC CICS ENDBR
  8773*            DATASET    ('ELMSTR')
  8774*       END-EXEC.
  8775     MOVE 'ELMSTR' TO DFHEIV1
  8776     MOVE 0
  8777       TO DFHEIV11
  8778*    MOVE '&2                    $   #00008610' TO DFHEIV0
  8779     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8780     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8781     MOVE X'2020233030303038363130' TO DFHEIV0(25:11)
  8782     CALL 'kxdfhei1' USING DFHEIV0,
  8783           DFHEIV1,
  8784           DFHEIV11,
  8785           DFHEIV99
  8786     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8787
  8788
  8789     IF PI-PROCESSOR-ID = 'LGXX'
  8790         NEXT SENTENCE
  8791     ELSE
  8792
  8793* EXEC CICS READQ TS
  8794*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  8795*            INTO    (SECURITY-CONTROL)
  8796*            LENGTH  (SC-COMM-LENGTH)
  8797*            ITEM    (SC-ITEM)
  8798*        END-EXEC
  8799*    MOVE '*$II   L              ''   #00008617' TO DFHEIV0
  8800     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  8801     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8802     MOVE X'2020233030303038363137' TO DFHEIV0(25:11)
  8803     CALL 'kxdfhei1' USING DFHEIV0,
  8804           PI-SECURITY-TEMP-STORE-ID,
  8805           SECURITY-CONTROL,
  8806           SC-COMM-LENGTH,
  8807           SC-ITEM,
  8808           DFHEIV99,
  8809           DFHEIV99
  8810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8811         MOVE SC-CLAIMS-DISPLAY (10)  TO  PI-DISPLAY-CAP
  8812         MOVE SC-CLAIMS-UPDATE  (10)  TO  PI-MODIFY-CAP.
  8813
  8814     MOVE LOW-VALUES             TO EL156AI.
  8815     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8816     MOVE 'Y'                    TO FIRST-ENTRY.
  8817     GO TO 7000-SHOW-CLAIM.
  8818
  8819 0500-CREATE-TEMP-STORAGE.
  8820     MOVE EIBCPOSN               TO PI-SAVE-CURSOR.
  8821
  8822
  8823* EXEC CICS WRITEQ TS
  8824*        QUEUE (QID)
  8825*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8826*        LENGTH(PI-COMM-LENGTH)
  8827*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 166
* EL156.cbl
  8828*    MOVE '*"                    ''   #00008634' TO DFHEIV0
  8829     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8830     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8831     MOVE X'2020233030303038363334' TO DFHEIV0(25:11)
  8832     CALL 'kxdfhei1' USING DFHEIV0,
  8833           QID,
  8834           PROGRAM-INTERFACE-BLOCK,
  8835           PI-COMM-LENGTH,
  8836           DFHEIV99,
  8837           DFHEIV99,
  8838           DFHEIV99
  8839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8840
  8841
  8842
  8843* EXEC CICS WRITEQ TS
  8844*        QUEUE (QID)
  8845*        FROM  (EL156AI)
  8846*        LENGTH(MAP-LENGTH)
  8847*    END-EXEC.
  8848*    MOVE '*"                    ''   #00008640' TO DFHEIV0
  8849     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  8850     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8851     MOVE X'2020233030303038363430' TO DFHEIV0(25:11)
  8852     CALL 'kxdfhei1' USING DFHEIV0,
  8853           QID,
  8854           EL156AI,
  8855           MAP-LENGTH,
  8856           DFHEIV99,
  8857           DFHEIV99,
  8858           DFHEIV99
  8859     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8860
  8861
  8862 0599-EXIT.
  8863      EXIT.
  8864
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 167
* EL156.cbl
  8866 0600-RECOVER-TEMP-STORAGE.
  8867
  8868* EXEC CICS READQ TS
  8869*        QUEUE (QID)
  8870*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8871*        LENGTH(PI-COMM-LENGTH)
  8872*    END-EXEC.
  8873*    MOVE '*$I    L              ''   #00008651' TO DFHEIV0
  8874     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8875     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8876     MOVE X'2020233030303038363531' TO DFHEIV0(25:11)
  8877     CALL 'kxdfhei1' USING DFHEIV0,
  8878           QID,
  8879           PROGRAM-INTERFACE-BLOCK,
  8880           PI-COMM-LENGTH,
  8881           DFHEIV99,
  8882           DFHEIV99,
  8883           DFHEIV99
  8884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8885
  8886
  8887
  8888* EXEC CICS READQ TS
  8889*        QUEUE (QID)
  8890*        INTO  (EL156AI)
  8891*        LENGTH(MAP-LENGTH)
  8892*    END-EXEC.
  8893*    MOVE '*$I    L              ''   #00008657' TO DFHEIV0
  8894     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8895     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8896     MOVE X'2020233030303038363537' TO DFHEIV0(25:11)
  8897     CALL 'kxdfhei1' USING DFHEIV0,
  8898           QID,
  8899           EL156AI,
  8900           MAP-LENGTH,
  8901           DFHEIV99,
  8902           DFHEIV99,
  8903           DFHEIV99
  8904     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8905
  8906
  8907     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8908
  8909     IF PMTTYPEI NOT = LOW-VALUES
  8910         MOVE AL-UANON           TO PMTTYPEA.
  8911
  8912     IF PAYEEI NOT = LOW-VALUES
  8913         MOVE AL-UANON           TO PAYEEA.
  8914
  8915     IF NOTE1I NOT = LOW-VALUES
  8916         MOVE AL-UANON           TO NOTE1A.
  8917
  8918     IF (RETURNED-FROM = 'EL614')
  8919        MOVE WS-SET-NOTE2-MDT    TO PI-SET-NOTE2-MDT
  8920     END-IF
  8921*    IF (NOTE2I NOT = LOW-VALUES AND SPACES)
  8922*       AND (PI-EOB-CODES-EXIST = 'Y')
  8923*       AND (PI-SET-NOTE2-MDT = 'Y')
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 168
* EL156.cbl
  8924*       MOVE ' '                 TO PI-SET-NOTE2-MDT
  8925     IF PI-SET-NOTE2-MDT = 'Y'
  8926         MOVE AL-SANON           TO NOTE2A
  8927     END-IF
  8928
  8929     IF OFFLINEI NOT = LOW-VALUES
  8930         MOVE AL-UANON           TO OFFLINEA.
  8931
  8932*    IF GROUPEDI NOT = LOW-VALUES
  8933*        MOVE AL-UANON           TO GROUPEDA.
  8934
  8935*    IF CASHI NOT = LOW-VALUES
  8936*        MOVE AL-UANON           TO CASHA.
  8937
  8938     IF CHECKNOI NOT = LOW-VALUES
  8939         MOVE AL-UANON           TO CHECKNOA.
  8940
  8941     IF HOLDTILI NOT = LOW-VALUES
  8942         MOVE AL-UANON           TO HOLDTILA.
  8943
  8944     IF EPYFROMI NOT = LOW-VALUES
  8945         MOVE AL-UANON           TO EPYFROMA.
  8946
  8947     IF AIGFROMI NOT = LOW-VALUES
  8948         MOVE AL-UANON           TO AIGFROMA.
  8949
  8950     IF EPYTHRUI NOT = LOW-VALUES
  8951         MOVE AL-UANON           TO EPYTHRUA.
  8952
  8953     IF EDAYSI NOT = LOW-VALUES
  8954         MOVE AL-UNNON           TO EDAYSA.
  8955
  8956     IF EPYAMTL NOT = +0
  8957         MOVE AL-UNNON           TO EPYAMTA.
  8958
  8959     IF ERESVL NOT = +0
  8960         MOVE AL-UNNON           TO ERESVA.
  8961
  8962     IF EEXPENSL NOT = +0
  8963         MOVE AL-UNNON           TO EEXPENSA.
  8964
  8965     IF ETYPEI NOT = LOW-VALUES
  8966         MOVE AL-UNNON           TO ETYPEA.
  8967
  8968     IF PROOFDTI NOT = 0
  8969         MOVE AL-UNNON           TO PROOFDTA.
  8970
  8971     IF EOBYNI = 'Y' OR 'N' OR 'S'
  8972        MOVE AL-UANON            TO EOBYNA
  8973     END-IF
  8974     IF CLMFMYNI = 'Y' OR 'N'
  8975        MOVE AL-UANON            TO CLMFMYNA
  8976     END-IF
  8977
  8978     IF SURVYYNI = 'Y' OR 'N'
  8979        IF PI-APPROVAL-LEVEL = '4' OR '5'
  8980           MOVE AL-UANON         TO SURVYYNA
  8981        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 169
* EL156.cbl
  8982     END-IF
  8983
  8984     IF SPRELYNI = 'Y' OR 'N'
  8985        MOVE AL-UANON            TO SPRELYNA
  8986     END-IF
  8987
  8988     .
  8989 0699-EXIT.
  8990      EXIT.
  8991
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 170
* EL156.cbl
  8993 0700-TEST-FOR-CHANGES.
  8994     IF (EIBAID = DFHPF4) AND (NOT FORCE-CAP)
  8995         MOVE ER-0433            TO EMI-ERROR
  8996         GO TO 0750-FUNCTION-ERROR.
  8997
  8998     PERFORM 3000-MOVE-INPUT-TO-SAVE-AREA THRU 3000-EXIT.
  8999
  9000     IF WS-SAVE-INPUT NOT = PI-SAVE-INPUT
  9001         MOVE WS-SAVE-INPUT      TO PI-SAVE-INPUT
  9002         MOVE 'A'                TO PI-PASS-SW
  9003         GO TO 1000-EDIT-DATA.
  9004
  9005     IF PI-FATAL-COUNT NOT = 0
  9006         MOVE ER-0499            TO EMI-ERROR
  9007         GO TO 0750-FUNCTION-ERROR.
  9008
  9009     IF (PI-FORCE-COUNT NOT = 0) AND (EIBAID NOT = DFHPF4)
  9010         MOVE ER-0500            TO EMI-ERROR
  9011         GO TO 0750-FUNCTION-ERROR.
  9012
  9013     IF (EIBAID  = DFHPF5 AND PI-CPYAMT = ZEROS) OR
  9014        ((EIBAID = DFHPF3 OR DFHPF4) AND PI-EPYAMT = ZEROS)
  9015           MOVE ER-0542          TO EMI-ERROR
  9016           MOVE -1               TO EPYAMTL
  9017           GO TO 0750-FUNCTION-ERROR.
  9018
  9019     IF PI-OFFLINE = 'Y'  OR
  9020        (PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE)
  9021        MOVE EIBAID              TO PI-PFKEY-USED
  9022        GO TO 5000-UPDATE.
  9023
  9024     GO TO 6000-BUILD-SCREEN-B.
  9025
  9026 0750-FUNCTION-ERROR.
  9027     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9028
  9029     IF ENTERPFL > 0
  9030         MOVE -1                 TO ENTERPFL
  9031         MOVE AL-UNBON           TO ENTERPFA
  9032         GO TO 8200-SEND-DATAONLY
  9033     ELSE
  9034         MOVE -1                 TO ENTERPFL
  9035         MOVE AL-UNNOF           TO ENTERPFA
  9036         GO TO 8200-SEND-DATAONLY.
  9037
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 171
* EL156.cbl
  9039 0800-DELETE-TS.
  9040
  9041* EXEC CICS HANDLE CONDITION
  9042*        QIDERR(0800-EXIT)
  9043*    END-EXEC.
  9044*    MOVE '"$N                   ! % #00008796' TO DFHEIV0
  9045     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  9046     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9047     MOVE X'2520233030303038373936' TO DFHEIV0(25:11)
  9048     CALL 'kxdfhei1' USING DFHEIV0
  9049     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9050
  9051
  9052
  9053* EXEC CICS DELETEQ TS
  9054*        QUEUE(QID)
  9055*    END-EXEC.
  9056*    MOVE '*&                    #   #00008800' TO DFHEIV0
  9057     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9058     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9059     MOVE X'2020233030303038383030' TO DFHEIV0(25:11)
  9060     CALL 'kxdfhei1' USING DFHEIV0,
  9061           QID,
  9062           DFHEIV99
  9063     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9064
  9065
  9066 0800-EXIT.
  9067      EXIT.
  9068 0900-GET-DDF-LIMITS.
  9069
  9070     if cm-clp-state = zeros or spaces or low-values
  9071        move cm-state            to cm-clp-state
  9072     end-if
  9073     MOVE ' '                    TO WS-PDEF-RECORD-SW
  9074     MOVE PI-COMPANY-CD          TO ERPDEF-KEY
  9075     MOVE cm-clp-state           TO ERPDEF-STATE
  9076     MOVE PI-DCC-PRODUCT-CODE    TO ERPDEF-PROD-CD
  9077     evaluate true
  9078        when (cl-claim-type = 'L' or 'P')
  9079           and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9080             and 'CU')
  9081           move 'L'              to erpdef-ben-type
  9082           move pi-lf-benefit-cd to erpdef-ben-code
  9083        when (cl-claim-type not = 'L' and 'P')
  9084           and (pi-ah-benefit-cd not = '00' and '  ')
  9085           move 'A'              to erpdef-ben-type
  9086           move pi-ah-benefit-cd to erpdef-ben-code
  9087        when (cl-claim-type not = 'L' and 'P')
  9088           and (pi-ah-benefit-cd = '00' or '  ')
  9089           move 'L'              to erpdef-ben-type
  9090           move pi-lf-benefit-cd to erpdef-ben-code
  9091        when (cl-claim-type = 'L' or 'P')
  9092           and (pi-lf-benefit-cd = '00' or '  ' or 'DD' or 'CU')
  9093           move 'A'              to erpdef-ben-type
  9094           move pi-ah-benefit-cd to erpdef-ben-code
  9095        when other
  9096           move 'A'              to erpdef-ben-type
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 172
* EL156.cbl
  9097           move pi-ah-benefit-cd to erpdef-ben-code
  9098     end-evaluate
  9099*    if (cl-claim-type = 'L' or 'P')
  9100*       and (pi-lf-benefit-cd not = '00' and '  ' and 'DD'
  9101*          and 'CU')
  9102*       move 'L'                 to erpdef-ben-type
  9103*       move pi-lf-benefit-cd    to erpdef-ben-code
  9104*    else
  9105*       MOVE 'A'                 TO ERPDEF-BEN-TYPE
  9106*       MOVE PI-AH-BENEFIT-CD    TO ERPDEF-BEN-CODE
  9107*    end-if
  9108     MOVE CL-CERT-EFF-DT         TO ERPDEF-EXP-DT
  9109
  9110     MOVE ERPDEF-KEY             TO ERPDEF-KEY-SAVE
  9111
  9112
  9113* EXEC CICS STARTBR
  9114*        DATASET  ('ERPDEF')
  9115*        RIDFLD   (ERPDEF-KEY)
  9116*        GTEQ
  9117*        RESP     (WS-RESPONSE)
  9118*    END-EXEC
  9119     MOVE 'ERPDEF' TO DFHEIV1
  9120     MOVE 0
  9121       TO DFHEIV11
  9122*    MOVE '&,         G          &  N#00008850' TO DFHEIV0
  9123     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9124     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9125     MOVE X'204E233030303038383530' TO DFHEIV0(25:11)
  9126     CALL 'kxdfhei1' USING DFHEIV0,
  9127           DFHEIV1,
  9128           ERPDEF-KEY,
  9129           DFHEIV99,
  9130           DFHEIV11,
  9131           DFHEIV99
  9132     MOVE EIBRESP  TO WS-RESPONSE
  9133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9134
  9135     IF NOT WS-RESP-NORMAL
  9136        GO TO 0900-EXIT
  9137     END-IF
  9138
  9139     .
  9140 0900-READNEXT.
  9141
  9142
  9143* EXEC CICS READNEXT
  9144*       DATASET  ('ERPDEF')
  9145*       SET      (ADDRESS OF PRODUCT-MASTER)
  9146*       RIDFLD   (ERPDEF-KEY)
  9147*       RESP     (WS-RESPONSE)
  9148*    END-EXEC
  9149     MOVE 'ERPDEF' TO DFHEIV1
  9150     MOVE 0
  9151       TO DFHEIV11
  9152*    MOVE '&.S                   )  N#00008864' TO DFHEIV0
  9153     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9154     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 173
* EL156.cbl
  9155     MOVE X'204E233030303038383634' TO DFHEIV0(25:11)
  9156     CALL 'kxdfhei1' USING DFHEIV0,
  9157           DFHEIV1,
  9158           DFHEIV20,
  9159           DFHEIV99,
  9160           ERPDEF-KEY,
  9161           DFHEIV99,
  9162           DFHEIV11,
  9163           DFHEIV99,
  9164           DFHEIV99
  9165     SET ADDRESS OF PRODUCT-MASTER TO
  9166         DFHEIV20
  9167     MOVE EIBRESP  TO WS-RESPONSE
  9168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9169
  9170     IF NOT WS-RESP-NORMAL
  9171        GO TO 0900-ENDBR
  9172     END-IF
  9173
  9174     IF (ERPDEF-KEY-SAVE (1:16) = PD-CONTROL-PRIMARY (1:16))
  9175        IF (CM-CERT-EFF-DT < PD-PROD-EXP-DT)
  9176           MOVE 'Y'              TO WS-PDEF-RECORD-SW
  9177        ELSE
  9178           GO TO 0900-READNEXT
  9179        END-IF
  9180     ELSE
  9181        GO TO 0900-ENDBR
  9182     END-IF
  9183
  9184     IF CM-LOAN-TERM = ZEROS
  9185        MOVE CP-ORIGINAL-TERM    TO CP-LOAN-TERM
  9186     END-IF
  9187
  9188     .
  9189 0900-ENDBR.
  9190
  9191
  9192* EXEC CICS ENDBR
  9193*       DATASET  ('ERPDEF')
  9194*    END-EXEC
  9195     MOVE 'ERPDEF' TO DFHEIV1
  9196     MOVE 0
  9197       TO DFHEIV11
  9198*    MOVE '&2                    $   #00008892' TO DFHEIV0
  9199     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9200     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9201     MOVE X'2020233030303038383932' TO DFHEIV0(25:11)
  9202     CALL 'kxdfhei1' USING DFHEIV0,
  9203           DFHEIV1,
  9204           DFHEIV11,
  9205           DFHEIV99
  9206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9207
  9208     .
  9209 0900-EXIT.
  9210     EXIT.
  9211 1000-EDIT-DATA.
  9212
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 174
* EL156.cbl
  9213     MOVE 0 TO PI-FATAL-COUNT  PI-FORCE-COUNT  PI-BEN-DAYS
  9214         PI-CDAYS  PI-CPYAMT  PI-CRESV  PI-CEXPENS PI-MANUAL-SW
  9215         PI-INT-AMT PI-INT-DAYS PI-INT-RATE-USED
  9216
  9217     MOVE LOW-VALUES TO PI-CPYFROM  PI-CPYTHRU.
  9218
  9219     IF NOT MODIFY-CAP
  9220         MOVE ER-0070            TO EMI-ERROR
  9221         MOVE -1                 TO PMTTYPEL
  9222         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9223         GO TO 2000-EDIT-DONE.
  9224
  9225     IF PI-PMTTYPE NOT = '1' AND '2' AND '3' AND '4' AND
  9226                         '5' AND '6'
  9227         MOVE ER-0420            TO EMI-ERROR
  9228         MOVE -1                 TO PMTTYPEL
  9229         MOVE AL-UABON           TO PMTTYPEA
  9230         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9231     ELSE
  9232         MOVE AL-UANON           TO PMTTYPEA.
  9233
  9234*    IF PI-OFFLINE = 'Y'
  9235*       IF PI-GROUPED = 'Y'
  9236*          MOVE ER-1880         TO EMI-ERROR
  9237*          MOVE -1              TO GROUPEDL
  9238*          MOVE AL-UABON        TO GROUPEDA
  9239*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9240*
  9241*    IF GROUPEDL > +0
  9242*       IF PI-GROUPED = 'Y' OR 'N'
  9243*          MOVE AL-UANON TO GROUPEDA
  9244*       ELSE
  9245*          MOVE ER-3140            TO EMI-ERROR
  9246*          MOVE -1                 TO GROUPEDL
  9247*          MOVE AL-UABON           TO GROUPEDA
  9248*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9249*
  9250*    IF CASHL > +0
  9251*       IF PI-CASH = 'Y' OR 'N'
  9252*          MOVE AL-UANON           TO CASHA
  9253*       ELSE
  9254*          MOVE ER-3141            TO EMI-ERROR
  9255*          MOVE -1                 TO CASHL
  9256*          MOVE AL-UABON           TO CASHA
  9257*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9258
  9259     IF LOANNOL > +0
  9260         MOVE 'Y'                TO  PI-LOAN-UPDATE-SW.
  9261
  9262 1000-EDIT-PAYEE.
  9263
  9264     IF PI-PAYEE-SEQ NOT NUMERIC
  9265         MOVE ER-0294            TO  EMI-ERROR
  9266         MOVE -1                 TO  PAYEEL
  9267         MOVE AL-UABON           TO  PAYEEA
  9268         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9269         GO TO 1000-CONT-EDIT.
  9270
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 175
* EL156.cbl
  9271     IF PI-PAYEE-TYPE =  'I' OR 'B' OR 'A' OR 'P' OR
  9272                         'E' OR 'O' OR 'Q'
  9273         NEXT SENTENCE
  9274     ELSE
  9275         MOVE ER-0294            TO  EMI-ERROR
  9276         MOVE -1                 TO  PAYEEL
  9277         MOVE AL-UABON           TO  PAYEEA
  9278         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9279         GO TO 1000-CONT-EDIT.
  9280
  9281     IF ((PI-PAYEE-TYPE = 'I' OR 'E' OR 'O' OR 'P' OR 'Q')  AND
  9282        (PI-PAYEE-SEQ NOT < '1' AND
  9283         PI-PAYEE-SEQ NOT > '9'))
  9284      OR
  9285        ((PI-PAYEE-TYPE = 'A' OR 'B')  AND
  9286         (PI-PAYEE-SEQ NOT > '9'))
  9287         MOVE AL-UANON            TO PAYEEA
  9288     ELSE
  9289         MOVE ER-0294            TO EMI-ERROR
  9290         MOVE -1                 TO PAYEEL
  9291         MOVE AL-UABON           TO PAYEEA
  9292         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9293
  9294     IF PI-COMPANY-ID = 'DMD'
  9295         IF PI-PAYEE-TYPE = 'B' AND
  9296            PI-PAYEE-SEQ NOT = '0'
  9297               MOVE ER-7841            TO EMI-ERROR
  9298               MOVE -1                 TO PAYEEL
  9299               MOVE AL-UABON           TO PAYEEA
  9300               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9301
  9302     IF PI-COMPANY-ID = 'JHL'
  9303         IF PI-PAYEE = 'B0'
  9304             NEXT SENTENCE
  9305           ELSE
  9306
  9307* EXEC CICS HANDLE CONDITION
  9308*            ENDFILE(1950-NOT-FOUND)
  9309*            NOTFND (1950-NOT-FOUND)
  9310*        END-EXEC
  9311*    MOVE '"$''I                  ! & #00008994' TO DFHEIV0
  9312     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  9313     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9314     MOVE X'2620233030303038393934' TO DFHEIV0(25:11)
  9315     CALL 'kxdfhei1' USING DFHEIV0
  9316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9317         MOVE 'N'                    TO FOUND-TOL-SW
  9318         MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  9319         MOVE '2'                    TO CNTL-REC-TYPE
  9320         MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS
  9321         MOVE +0                     TO CNTL-SEQ-NO
  9322         MOVE 'PROC'                 TO FILE-SWITCH
  9323         PERFORM 7930-READ-CONTROL THRU 7930-EXIT
  9324         IF PI-PAYEE = 'I1' AND
  9325            APPROVAL-LEVEL-2
  9326             NEXT SENTENCE
  9327           ELSE
  9328         IF NOT PI-USER-ALMIGHTY-YES
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 176
* EL156.cbl
  9329             MOVE ER-3546        TO EMI-ERROR
  9330             MOVE -1             TO PAYEEL
  9331             MOVE AL-UABON       TO PAYEEA
  9332             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9333
  9334     IF PI-PAYEE-TYPE = 'E'
  9335        IF PI-PMTTYPE = '5' OR '6'
  9336            NEXT SENTENCE
  9337        ELSE
  9338            MOVE ER-3539            TO EMI-ERROR
  9339            MOVE -1                 TO PAYEEL
  9340            MOVE AL-UABON           TO PAYEEA
  9341            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9342
  9343 1000-CONT-EDIT.
  9344
  9345     IF PI-OFFLINE NOT = 'Y' AND 'N'
  9346        IF PI-EPYAMT NOT NEGATIVE
  9347            MOVE ER-0421         TO EMI-ERROR
  9348            MOVE -1              TO OFFLINEL
  9349            MOVE AL-UABON        TO OFFLINEA
  9350            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9351        ELSE
  9352            MOVE AL-UANON        TO OFFLINEA.
  9353
  9354     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
  9355        IF PI-PRINT-EOB-YN = 'Y' OR 'N'
  9356           CONTINUE
  9357        ELSE
  9358           IF PI-PRINT-EOB-YN = 'S' AND
  9359              PI-CLM-TYPE = PI-LIFE-OVERRIDE-L1
  9360                CONTINUE
  9361           ELSE
  9362              MOVE ER-1561       TO EMI-ERROR
  9363              MOVE -1            TO EOBYNL
  9364              MOVE AL-UABON      TO EOBYNA
  9365              PERFORM 9900-ERROR-FORMAT
  9366                                 THRU 9900-EXIT
  9367           END-IF
  9368        END-IF
  9369
  9370        IF PI-PRINT-CLM-FRM-YN NOT = 'Y' AND 'N'
  9371            MOVE ER-1566        TO EMI-ERROR
  9372            MOVE -1             TO CLMFMYNL
  9373            MOVE AL-UABON       TO CLMFMYNA
  9374            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9375        END-IF
  9376
  9377        IF PI-PRINT-SURVEY-YN NOT = 'Y' AND 'N'
  9378            MOVE ER-1567        TO EMI-ERROR
  9379            MOVE -1             TO SURVYYNL
  9380            MOVE AL-UABON       TO SURVYYNA
  9381            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9382        END-IF
  9383
  9384        IF PI-SPECIAL-RELEASE-YN NOT = 'Y' AND 'N'
  9385            MOVE ER-1569        TO EMI-ERROR
  9386            MOVE -1             TO SPRELYNL
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 177
* EL156.cbl
  9387            MOVE AL-UABON       TO SPRELYNA
  9388            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9389        END-IF
  9390
  9391     END-IF
  9392     IF PI-EPYAMT IS NEGATIVE
  9393         IF PI-OFFLINE NOT = 'Y'
  9394             MOVE ER-0836        TO  EMI-ERROR
  9395             MOVE -1             TO  OFFLINEL
  9396             MOVE AL-UABON       TO  OFFLINEA
  9397             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9398
  9399     IF PI-PROOF-DATE = ZEROS OR LOW-VALUES OR SPACES
  9400        MOVE ER-0872             TO EMI-ERROR
  9401        MOVE -1                  TO PROOFDTL
  9402        MOVE AL-UABON            TO PROOFDTA
  9403        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9404     ELSE
  9405        MOVE '4'                TO DC-OPTION-CODE
  9406        MOVE PI-PROOF-DATE      TO DC-GREG-DATE-1-MDY
  9407        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  9408        IF DATE-CONVERSION-ERROR
  9409            MOVE ER-0873        TO EMI-ERROR
  9410            MOVE -1                  TO PROOFDTL
  9411            MOVE AL-UABON            TO PROOFDTA
  9412            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9413        ELSE
  9414            MOVE DC-BIN-DATE-1   TO WS-BIN-PROOF-DT
  9415            IF DC-BIN-DATE-1 > WS-TODAY-DATE
  9416                MOVE ER-0873    TO EMI-ERROR
  9417                MOVE -1                  TO PROOFDTL
  9418                MOVE AL-UABON            TO PROOFDTA
  9419                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9420            END-IF
  9421        END-IF
  9422     END-IF.
  9423
  9424     IF PI-COMPANY-ID = 'DMD'
  9425        IF NOTE1L NOT = ZEROS
  9426            MOVE ER-7844        TO  EMI-ERROR
  9427            MOVE -1             TO  NOTE1L
  9428            MOVE AL-UABON       TO  NOTE1A
  9429            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9430
  9431     IF PI-COMPANY-ID = 'DMD'
  9432        IF NOTE2L NOT = ZEROS
  9433          GO TO 1004-DMD-EOB-CHECKS.
  9434
  9435     IF NOTE1L NOT > +0
  9436         GO TO 1005-CHECK-ERRORS.
  9437
  9438     IF PI-COMPANY-ID NOT = 'FLI' AND 'FLU' AND 'HAN' AND 'JHL'
  9439         GO TO 1005-CHECK-ERRORS.
  9440
  9441     IF PI-COMPANY-ID = 'HAN' OR 'JHL'
  9442         GO TO 1003-HAN-PMT-NOTES.
  9443
  9444     MOVE NOTE1I                 TO WS-FLI-PMTNOTE.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 178
* EL156.cbl
  9445
  9446     IF WS-PMTOPTION NUMERIC
  9447        IF WS-PMTOPTION > '00' AND < '17'
  9448           NEXT SENTENCE
  9449        ELSE
  9450           MOVE ER-0618          TO EMI-ERROR
  9451           MOVE -1               TO NOTE1L
  9452           MOVE AL-UABON         TO NOTE1A
  9453           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9454     ELSE
  9455        GO TO 1005-CHECK-ERRORS.
  9456
  9457     IF WS-PMTOPTION = '05' AND
  9458        WS-DOCNAME = SPACES
  9459          MOVE ER-0616             TO EMI-ERROR
  9460          MOVE -1                  TO NOTE1L
  9461          MOVE AL-UABON            TO NOTE1A
  9462          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9463
  9464     IF WS-PMTOPTION = '15' OR '16'
  9465
  9466* EXEC CICS BIF DEEDIT
  9467*            FIELD (WS-AMOUNT)
  9468*            LENGTH(08)
  9469*        END-EXEC
  9470     MOVE 08
  9471       TO DFHEIV11
  9472*    MOVE '@"L                   #   #00009146' TO DFHEIV0
  9473     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9474     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9475     MOVE X'2020233030303039313436' TO DFHEIV0(25:11)
  9476     CALL 'kxdfhei1' USING DFHEIV0,
  9477           WS-AMOUNT,
  9478           DFHEIV11
  9479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9480        IF (WS-NUM-AMT = ZEROS) OR
  9481           (WS-AMOUNT NOT NUMERIC)
  9482           MOVE ER-0617          TO EMI-ERROR
  9483           MOVE -1               TO NOTE1L
  9484           MOVE AL-UABON         TO NOTE1A
  9485           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9486
  9487     MOVE WS-FLI-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9488
  9489     GO TO 1005-CHECK-ERRORS.
  9490
  9491 1003-HAN-PMT-NOTES.
  9492
  9493     MOVE NOTE1I                 TO WS-HAN-PMTNOTE.
  9494
  9495     IF WS-HAN-PMT-CODE = SPACE
  9496         MOVE SPACES             TO WS-HAN-PMT-NOTE
  9497     ELSE
  9498     IF WS-HAN-PMT-CODE = 'A'
  9499         MOVE ':FINAL PAYMENT / MAXIMUM BENEFIT-PAID'
  9500                                 TO WS-HAN-PMT-NOTE
  9501     ELSE
  9502     IF WS-HAN-PMT-CODE = 'B'
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 179
* EL156.cbl
  9503         MOVE ':FINAL PAYMENT / DECEASED'
  9504                                 TO WS-HAN-PMT-NOTE
  9505     ELSE
  9506     IF WS-HAN-PMT-CODE = 'C'
  9507         MOVE ':FINAL PAYMENT / NO LONGER DISABLED'
  9508                                 TO WS-HAN-PMT-NOTE
  9509     ELSE
  9510     IF WS-HAN-PMT-CODE = 'D'
  9511         MOVE ':FINAL PAYMENT / ADDL INFO NOT PROVIDED'
  9512                                 TO WS-HAN-PMT-NOTE
  9513     ELSE
  9514     IF WS-HAN-PMT-CODE = 'E'
  9515         MOVE ':FINAL PAYMENT / RETURNED TO WORK'
  9516                                 TO WS-HAN-PMT-NOTE
  9517     ELSE
  9518     IF WS-HAN-PMT-CODE = 'F'
  9519         MOVE ':FINAL PAYMENT / PAID TO MATURITY DATE'
  9520                                 TO WS-HAN-PMT-NOTE
  9521     ELSE
  9522     IF WS-HAN-PMT-CODE = 'P'
  9523         MOVE ':PARTIAL PAYMENT' TO WS-HAN-PMT-NOTE.
  9524
  9525     MOVE WS-HAN-PMTNOTE TO NOTE1I WS-PMTNOTE1 PI-PMTNOTE1.
  9526     GO TO 1005-CHECK-ERRORS.
  9527
  9528 1004-DMD-EOB-CHECKS.
  9529
  9530     INITIALIZE PI-AT-EOB-CODES.
  9531
  9532     IF NOTE2I (20:21) > SPACES
  9533         MOVE ER-7845          TO EMI-ERROR
  9534         MOVE -1               TO NOTE2L
  9535         MOVE AL-UABON         TO NOTE2A
  9536         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9537         GO TO 1005-CHECK-ERRORS
  9538      ELSE
  9539         MOVE NOTE2I             TO W-EOB-CODES.
  9540
  9541     MOVE +1                     TO W-EOB-NDX.
  9542
  9543 1004-CHECK-EACH-EOB.
  9544
  9545     IF W-EOB-NDX > +5
  9546             OR
  9547        W-EOB-CODE (W-EOB-NDX) = SPACES
  9548         GO TO 1004-CHECK-DUP-EOB.
  9549
  9550     IF W-EOB-FILLER (W-EOB-NDX) NOT = SPACES
  9551         MOVE ER-0956            TO EMI-ERROR
  9552         MOVE -1                 TO NOTE2L
  9553         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9554         GO TO 1005-CHECK-ERRORS.
  9555
  9556     MOVE 'CL'                   TO CD-SYSTEM-ID.
  9557     MOVE 'EO'                   TO CD-RECORD-TYPE.
  9558     MOVE W-EOB-CODE (W-EOB-NDX) TO CD-RECORD-KEY.
  9559     MOVE 'DLO023'               TO PGM-NAME.
  9560
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 180
* EL156.cbl
  9561
  9562* EXEC CICS LINK
  9563*        PROGRAM    (PGM-NAME)
  9564*        COMMAREA   (CD-COMMUNICATION-AREA)
  9565*        LENGTH     (CD-RCRD-LENGTH)
  9566*    END-EXEC.
  9567*    MOVE '."C                   (   #00009231' TO DFHEIV0
  9568     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9569     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9570     MOVE X'2020233030303039323331' TO DFHEIV0(25:11)
  9571     CALL 'kxdfhei1' USING DFHEIV0,
  9572           PGM-NAME,
  9573           CD-COMMUNICATION-AREA,
  9574           CD-RCRD-LENGTH,
  9575           DFHEIV99,
  9576           DFHEIV99,
  9577           DFHEIV99,
  9578           DFHEIV99
  9579     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9580
  9581
  9582     IF CD-RETURN-CODE = 'OK'
  9583         GO TO 1004-CONT.
  9584
  9585     MOVE -1                     TO NOTE2L.
  9586
  9587     IF CD-RETURN-CODE = '01'
  9588         MOVE ER-8310            TO EMI-ERROR
  9589         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9590         GO TO 1005-CHECK-ERRORS.
  9591
  9592     IF CD-RETURN-CODE = '02'
  9593         MOVE ER-8311            TO EMI-ERROR
  9594         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9595         GO TO 1005-CHECK-ERRORS.
  9596
  9597     IF CD-RETURN-CODE = '03'
  9598         MOVE ER-8312            TO EMI-ERROR
  9599         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9600         GO TO 1005-CHECK-ERRORS.
  9601
  9602     IF CD-RETURN-CODE = '04'
  9603         MOVE ER-8313            TO EMI-ERROR
  9604         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9605         GO TO 1005-CHECK-ERRORS.
  9606
  9607     IF CD-RETURN-CODE = '05'
  9608         MOVE ER-8314            TO EMI-ERROR
  9609         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9610         GO TO 1005-CHECK-ERRORS.
  9611
  9612     IF CD-RETURN-CODE = '06'
  9613         MOVE ER-8315            TO EMI-ERROR
  9614         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9615         GO TO 1005-CHECK-ERRORS.
  9616
  9617     IF CD-RETURN-CODE = 'E1'
  9618         MOVE ER-8316            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 181
* EL156.cbl
  9619         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9620         GO TO 1005-CHECK-ERRORS.
  9621
  9622     IF CD-RETURN-CODE = 'N1'
  9623         MOVE ER-8317            TO EMI-ERROR
  9624         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9625         GO TO 1005-CHECK-ERRORS.
  9626
  9627 1004-CONT.
  9628     MOVE W-EOB-CODE (W-EOB-NDX) TO PI-AT-EOB-CODE (W-EOB-NDX).
  9629
  9630     ADD +1 TO W-EOB-NDX.
  9631     GO TO 1004-CHECK-EACH-EOB.
  9632
  9633 1004-CHECK-DUP-EOB.
  9634     IF ((PI-AT-EOB-CODE (1) NOT = SPACE) AND
  9635         (PI-AT-EOB-CODE (1) = PI-AT-EOB-CODE (2) OR
  9636                               PI-AT-EOB-CODE (3) OR
  9637                               PI-AT-EOB-CODE (4) OR
  9638                               PI-AT-EOB-CODE (5)))
  9639                  OR
  9640        ((PI-AT-EOB-CODE (2) NOT = SPACE) AND
  9641         (PI-AT-EOB-CODE (2) = PI-AT-EOB-CODE (3) OR
  9642                               PI-AT-EOB-CODE (4) OR
  9643                               PI-AT-EOB-CODE (5)))
  9644                  OR
  9645        ((PI-AT-EOB-CODE (3) NOT = SPACE) AND
  9646         (PI-AT-EOB-CODE (3) = PI-AT-EOB-CODE (4) OR
  9647                               PI-AT-EOB-CODE (5)))
  9648                  OR
  9649        ((PI-AT-EOB-CODE (4) NOT = SPACE) AND
  9650         (PI-AT-EOB-CODE (4) = PI-AT-EOB-CODE (5)))
  9651            MOVE ER-8000            TO EMI-ERROR
  9652            MOVE AL-UABON           TO NOTE2A
  9653            MOVE -1                 TO NOTE2L
  9654            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9655            GO TO 1005-CHECK-ERRORS.
  9656
  9657 1005-CHECK-ERRORS.
  9658*    IF PI-COMPANY-ID NOT = 'DMD'
  9659        GO TO 1006-CHECK-ERRORS.
  9660
  9661*********  DMD CODE START ******************
  9662*    IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND 'G'
  9663*       GO TO 1006-CHECK-ERRORS.
  9664*
  9665*    PERFORM 7700-GET-DCT THRU 7700-EXIT.
  9666*
  9667*    COMPUTE W-PAYMENT-TOTAL
  9668*         = CL-TOTAL-PAID-AMT + PI-EPYAMT
  9669*    IF (W-PAYMENT-TOTAL > PI-MAX-BENEFIT-PYMT)
  9670*               AND
  9671*       (PI-MAX-BENEFIT-PYMT > ZEROS)
  9672*          EXEC CICS SYNCPOINT ROLLBACK END-EXEC
  9673*          MOVE ER-0967    TO EMI-ERROR
  9674*          MOVE -1         TO PMTTYPEL
  9675*          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9676*
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 182
* EL156.cbl
  9677*    GO TO 1006-CHECK-ERRORS.
  9678*********  DMD CODE END ******************
  9679
  9680 1006-CHECK-ERRORS.
  9681     IF NOT EMI-NO-ERRORS
  9682        GO TO 2000-EDIT-DONE.
  9683
  9684
  9685* EXEC CICS HANDLE CONDITION
  9686*        NOTFND(1950-NOT-FOUND)
  9687*    END-EXEC.
  9688*    MOVE '"$I                   ! '' #00009339' TO DFHEIV0
  9689     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9691     MOVE X'2720233030303039333339' TO DFHEIV0(25:11)
  9692     CALL 'kxdfhei1' USING DFHEIV0
  9693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9694
  9695
  9696     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
  9697     MOVE PI-CARRIER             TO MSTR-CARRIER.
  9698     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
  9699     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
  9700     MOVE 'MSTR'                 TO FILE-SWITCH.
  9701
  9702     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
  9703
  9704     IF PI-COMPANY-ID = 'DMD'
  9705         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
  9706
  9707     IF WS-BIN-PROOF-DT NOT = LOW-VALUES
  9708        IF WS-BIN-PROOF-DT < CL-INCURRED-DT
  9709           MOVE ER-0873    TO EMI-ERROR
  9710           MOVE -1                  TO PROOFDTL
  9711           MOVE AL-UABON            TO PROOFDTA
  9712           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9713        END-IF
  9714     END-IF
  9715     if cl-benefit-period = zeros
  9716        move er-1667             to emi-error
  9717        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9718     end-if
  9719     MOVE ELMSTR-KEY             TO ELTRLR-KEY
  9720     MOVE +95                    TO TRLR-SEQ-NO
  9721
  9722* EXEC CICS READ
  9723*       DATASET  ('ELTRLR')
  9724*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
  9725*       RIDFLD   (ELTRLR-KEY)
  9726*       RESP     (WS-RESPONSE)
  9727*    END-EXEC
  9728     MOVE 'ELTRLR' TO DFHEIV1
  9729*    MOVE '&"S        E          (  N#00009368' TO DFHEIV0
  9730     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9731     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9732     MOVE X'204E233030303039333638' TO DFHEIV0(25:11)
  9733     CALL 'kxdfhei1' USING DFHEIV0,
  9734           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 183
* EL156.cbl
  9735           DFHEIV20,
  9736           DFHEIV99,
  9737           ELTRLR-KEY,
  9738           DFHEIV99,
  9739           DFHEIV99,
  9740           DFHEIV99
  9741     SET ADDRESS OF ACTIVITY-TRAILERS TO
  9742         DFHEIV20
  9743     MOVE EIBRESP  TO WS-RESPONSE
  9744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9745
  9746     if ws-resp-normal
  9747        perform varying s1 from +1 by +1 until
  9748           at-note-error-no (s1) = spaces
  9749           if at-note-error-no (s1) = '1662'
  9750              continue
  9751           else
  9752              move at-note-error-no (s1)
  9753                                 to emi-error
  9754              if at-note-error-no (s1) = '1653'
  9755                 evaluate true
  9756                    when cl-claim-type = 'L'
  9757                       move '  LF  '
  9758                                 to emi-claim-type
  9759                    when cl-claim-type = 'I'
  9760                       move '  IU  '
  9761                                 to emi-claim-type
  9762                    when cl-claim-type = 'A'
  9763                       move '  AH  '
  9764                                 to emi-claim-type
  9765                    when other
  9766                       move ' FMLA '
  9767                                 to emi-claim-type
  9768                 end-evaluate
  9769              end-if
  9770              PERFORM 9900-ERROR-FORMAT
  9771                                 THRU 9900-EXIT
  9772           end-if
  9773        end-perform
  9774     end-if
  9775     IF CL-AUTO-PAY-SEQ NOT = ZEROS
  9776         IF PI-PMTTYPE = '5' OR '6'
  9777             NEXT SENTENCE
  9778         ELSE
  9779             MOVE ER-0555             TO EMI-ERROR
  9780             MOVE -1                  TO PMTTYPEL
  9781             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9782
  9783     IF CL-LAST-CLOSE-REASON = '2'
  9784         IF CL-CLAIM-STATUS = 'C'
  9785             MOVE ER-0760        TO  EMI-ERROR
  9786             MOVE -1             TO  PMTTYPEL
  9787             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9788
  9789     IF PI-ACTIVITY-CODE = 9
  9790         MOVE ER-3538            TO  EMI-ERROR
  9791         MOVE -1                 TO  PMTTYPEL
  9792         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 184
* EL156.cbl
  9793
  9794     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
  9795         GO TO 1008-READ-CERT.
  9796**********************AIG LOGIC STARTS *********************
  9797     IF CL-CERT-PRIME = 'INCOMPLETE'
  9798         MOVE ER-3540            TO  EMI-ERROR
  9799         MOVE -1                 TO  PMTTYPEL
  9800         MOVE AL-UABON           TO  PMTTYPEA
  9801         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9802         GO TO 2000-EDIT-DONE.
  9803
  9804     IF PI-PMTTYPE = '4'
  9805         IF PI-EPYAMT IS NEGATIVE
  9806             IF PI-ECHECKNO-CR = 'CR'
  9807                 NEXT SENTENCE
  9808             ELSE
  9809                 MOVE 'CR'       TO  PI-ECHECKNO-CR.
  9810
  9811     IF PI-PMTTYPE = '4'
  9812         IF PI-ECHECKNO-CR = 'CR'
  9813             IF PI-EPYAMT IS NEGATIVE
  9814                 NEXT SENTENCE
  9815             ELSE
  9816                 MOVE ER-0834    TO  EMI-ERROR
  9817                 MOVE -1         TO  EPYAMTL
  9818                 MOVE AL-UNBON   TO  EPYAMTA
  9819                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9820
  9821     IF PI-PMTTYPE = '4'
  9822         IF PI-EPYAMT IS NEGATIVE
  9823             IF PI-OFFLINE = 'Y'
  9824                 NEXT SENTENCE
  9825             ELSE
  9826                 MOVE 'Y'        TO  PI-OFFLINE
  9827                                     WS-OFFLINE
  9828                                     OFFLINEO
  9829                 MOVE AL-UANON   TO  OFFLINEA.
  9830
  9831*    IF PI-PMTTYPE = '4'
  9832*        IF PI-EPYAMT IS NEGATIVE
  9833*            IF PI-CASH = 'Y'
  9834*                NEXT SENTENCE
  9835*            ELSE
  9836*                MOVE 'Y'        TO  CASHI PI-CASH WS-CASH
  9837*                MOVE AL-UANON   TO  CASHA
  9838*                GO TO 1007-DEFAULT-AIG-CHECKNO.
  9839*
  9840*    IF PI-CASH NOT = 'Y' AND 'N'
  9841*         IF PI-OFFLINE = 'Y'  AND
  9842*            PI-ECHECKNO-CR = 'CR'
  9843*              MOVE 'Y'          TO  CASHI PI-CASH WS-CASH
  9844*              MOVE AL-UANON     TO  CASHA
  9845*              GO TO 1007-DEFAULT-AIG-CHECKNO.
  9846*
  9847*    IF PI-CASH NOT = 'Y' AND 'N'
  9848*        IF PI-PMTTYPE = '5' OR '6'
  9849*            MOVE 'Y'            TO  CASHI PI-CASH WS-CASH
  9850*            MOVE AL-UANON       TO  CASHA
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 185
* EL156.cbl
  9851*            GO TO 1007-DEFAULT-AIG-CHECKNO.
  9852*
  9853*    IF PI-CASH NOT = 'Y' AND 'N'
  9854*       IF CL-ASSOCIATES = 'N' OR 'A'
  9855*           MOVE 'Y'             TO  CASHI PI-CASH WS-CASH
  9856*           MOVE AL-UANON        TO  CASHA
  9857*       ELSE
  9858*           MOVE 'N'             TO  CASHI PI-CASH WS-CASH
  9859*           MOVE AL-UANON        TO  CASHA.
  9860*
  9861*    IF PI-PMTTYPE = '5' OR '6'
  9862*        IF PI-CASH = 'N'
  9863*            MOVE ER-0819        TO  EMI-ERROR
  9864*            MOVE AL-UANON       TO  CASHA
  9865*            MOVE -1             TO  CASHL
  9866*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9867*
  9868*    IF CL-ASSOCIATES = 'N' OR 'A'
  9869*       IF CASHI = 'N'
  9870*        MOVE ER-3537            TO  EMI-ERROR
  9871*        MOVE AL-UANON           TO  CASHA
  9872*        MOVE -1                 TO  CASHL
  9873*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9874
  9875 1007-DEFAULT-AIG-CHECKNO.
  9876
  9877     IF CL-CAUSE-CD = SPACES OR LOW-VALUES
  9878         MOVE ER-3532            TO  EMI-ERROR
  9879         MOVE -1                 TO  PMTTYPEL
  9880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9881**********************AIG LOGIC ENDS ***********************
  9882
  9883 1008-READ-CERT.
  9884
  9885     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
  9886     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
  9887     MOVE CL-CERT-GROUPING       TO CERT-GROUPING.
  9888     MOVE CL-CERT-STATE          TO CERT-STATE.
  9889     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT.
  9890     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
  9891     MOVE CL-CERT-NO             TO CERT-CERT-NO.
  9892     MOVE 'CERT'                 TO FILE-SWITCH.
  9893
  9894     PERFORM 7970-READ-CERT THRU 7970-EXIT.
  9895
  9896     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9897        MOVE CM-LF-LOAN-EXPIRE-DT
  9898                                 TO WS-EXP-DT PI-EXP-DT
  9899                                    ws-extended-exp-dt
  9900     ELSE
  9901        MOVE CM-AH-LOAN-EXPIRE-DT
  9902                                 TO WS-EXP-DT PI-EXP-DT
  9903                                    ws-extended-exp-dt
  9904     end-if
  9905     if pi-dcc-product-code not = spaces
  9906        move cm-ah-benefit-cd    to pi-ah-benefit-cd
  9907        move cm-lf-benefit-cd    to pi-lf-benefit-cd
  9908        PERFORM 0900-GET-DDF-limits
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 186
* EL156.cbl
  9909                                 THRU 0900-EXIT
  9910        IF PDEF-FOUND
  9911           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
  9912              (P1 > +8)
  9913              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
  9914           END-PERFORM
  9915           IF P1 < +9
  9916              MOVE '6'           TO DC-OPTION-CODE
  9917              MOVE WS-EXP-DT     TO DC-BIN-DATE-1
  9918              MOVE PD-MAX-EXTENSION (P1)
  9919                                 TO DC-ELAPSED-MONTHS
  9920              PERFORM 9700-LINK-DATE-CONVERT
  9921                                 THRU 9700-EXIT
  9922              if no-conversion-error
  9923                 move dc-bin-date-2 to ws-extended-exp-dt
  9924              end-if
  9925           else
  9926              move er-1674       to emi-error
  9927              PERFORM 9900-ERROR-FORMAT
  9928                                 THRU 9900-EXIT
  9929           end-if
  9930        end-if
  9931     end-if
  9932*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  9933*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT.
  9934
  9935     IF CL-INCURRED-DT < CM-CERT-EFF-DT
  9936         MOVE ER-0458            TO EMI-ERROR
  9937         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9938
  9939     IF (CL-INCURRED-DT > WS-EXP-DT)
  9940        AND (CL-INCURRED-DT < WS-EXTENDED-EXP-DT)
  9941        MOVE ER-1677             TO EMI-ERROR
  9942        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT
  9943     END-IF
  9944     move ws-extended-exp-dt     to ws-exp-dt pi-exp-dt
  9945     IF CL-INCURRED-DT NOT < WS-EXTENDED-EXP-DT
  9946         MOVE ER-0459            TO EMI-ERROR
  9947         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9948
  9949     IF CL-REPORTED-DT = LOW-VALUES
  9950        MOVE ER-0530             TO EMI-ERROR
  9951        PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9952
  9953     IF PI-COMPANY-ID = 'NCL'
  9954        IF CM-CREDIT-INTERFACE-SW-1 = '2'
  9955            MOVE ER-0770            TO EMI-ERROR
  9956            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9957
  9958     IF PI-COMPANY-ID = 'NCL'
  9959        IF (CM-SING-PRM AND CERT-WAS-CREATED-FOR-CLAIM)
  9960            MOVE ER-0737            TO EMI-ERROR
  9961            PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9962
  9963     IF CM-ENTRY-STATUS = 'D' OR 'V'
  9964         MOVE ER-0768            TO  EMI-ERROR
  9965         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9966
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 187
* EL156.cbl
  9967     IF CM-CREDIT-INTERFACE-SW-1 = '4'
  9968         MOVE ER-0769            TO  EMI-ERROR
  9969         PERFORM 1010-GENERAL-ERROR THRU 1010-EXIT.
  9970
  9971     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
  9972         GO TO 1020-DO-LIFE-EDITS
  9973     ELSE
  9974         GO TO 1030-DO-AH-EDITS.
  9975
  9976 1010-GENERAL-ERROR.
  9977     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9978
  9979     IF EMI-MESSAGE-FORMATTED
  9980         MOVE -1                 TO PMTTYPEL.
  9981
  9982 1010-EXIT.
  9983     EXIT.
  9984
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 188
* EL156.cbl
  9986 1020-DO-LIFE-EDITS.
  9987     IF CM-LF-BENEFIT-CD = '00'
  9988         IF PI-PMTTYPE = '5' OR '6'
  9989             MOVE ER-0658        TO EMI-ERROR
  9990             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
  9991         ELSE
  9992            if (pi-company-id = 'DCC')
  9993               and (pi-dcc-product-code not = spaces)
  9994               continue
  9995            else
  9996               MOVE ER-1775      TO EMI-ERROR
  9997               PERFORM 1040-PMTTYPE-ERROR
  9998                                 THRU 1040-EXIT
  9999            end-if
 10000         end-if
 10001     end-if
 10002
 10003     move cm-ah-benefit-cd to pi-ah-benefit-cd
 10004     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10005         MOVE ER-0460            TO EMI-ERROR
 10006         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10007
 10008     MOVE CM-LF-BENEFIT-CD      TO PI-LF-BENEFIT-CD.
 10009     MOVE CM-LF-BENEFIT-CD       TO  WS-BEN-CD.
 10010     MOVE WS-ACCESS              TO  CNTL-ACCESS.
 10011     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 10012     MOVE '4'                    TO  CNTL-REC-TYPE.
 10013     MOVE ZEROS                  TO  CNTL-SEQ-NO.
 10014     MOVE 'BENE'                 TO  FILE-SWITCH.
 10015     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10016     IF NO-BENEFIT-FOUND
 10017         GO TO 1950-NOT-FOUND.
 10018
 10019     MOVE CF-LF-COVERAGE-TYPE (SUB-1)   TO  PI-LF-COVERAGE-TYPE.
 10020
 10021     IF CM-LF-DEATH-EXIT-DT = LOW-VALUES
 10022         IF PI-PMTTYPE = '4'
 10023             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10024                PI-LF-COVERAGE-TYPE = 'P'
 10025                 NEXT SENTENCE
 10026             ELSE
 10027                 MOVE ER-0461        TO EMI-ERROR
 10028                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10029         ELSE
 10030            NEXT SENTENCE
 10031     ELSE
 10032         IF PI-PMTTYPE = '2'
 10033            IF NOT CM-O-B-COVERAGE
 10034              AND CM-LF-CURRENT-STATUS = '7'
 10035                MOVE ER-0462     TO EMI-ERROR
 10036                PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10037
 10038     IF PI-PMTTYPE = '2'
 10039         IF (CM-LF-CANCEL-DT      NOT = LOW-VALUES AND SPACES) OR
 10040            (CM-LF-CANCEL-EXIT-DT NOT = LOW-VALUES AND SPACES)
 10041             MOVE CM-LF-ITD-CANCEL-AMT  TO  WS-REFUND-AMT
 10042             MOVE ER-0730            TO  EMI-ERROR
 10043             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 189
* EL156.cbl
 10044             MOVE WS-REFUND-AMT      TO  EMI-TEXT-VARIABLE (1).
 10045
 10046     IF PI-PMTTYPE = '2'
 10047         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10048            PI-LF-COVERAGE-TYPE = 'P'
 10049             IF CL-PAID-THRU-DT = CL-INCURRED-DT
 10050                 MOVE ER-0462    TO  EMI-ERROR
 10051                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10052
 10053     IF CM-LF-CANCEL-DT NOT = LOW-VALUES
 10054       AND CL-INCURRED-DT > CM-LF-CANCEL-DT
 10055         MOVE ER-0466            TO EMI-ERROR
 10056         PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10057
 10058     IF PI-COMPANY-ID = 'FLI' OR 'FLU'
 10059         IF PI-PMTTYPE = '3'
 10060             MOVE 0436           TO EMI-ERROR
 10061             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10062             GO TO 1045-EDIT-PAYEE-ADDR
 10063         ELSE
 10064             GO TO 1045-EDIT-PAYEE-ADDR.
 10065
 10066     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10067        PI-LF-COVERAGE-TYPE = 'P'
 10068         IF PI-PMTTYPE = '3'
 10069             MOVE ER-0436          TO  EMI-ERROR
 10070             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10071         ELSE
 10072             NEXT SENTENCE
 10073     ELSE
 10074         IF PI-PMTTYPE = '1' OR '3'
 10075             MOVE ER-0436            TO EMI-ERROR
 10076             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10077*
 10078     IF PI-COMPANY-ID = 'CID' AND
 10079        CL-CERT-STATE = 'SC'  AND
 10080        (CM-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 10081           MOVE ER-0879    TO  EMI-ERROR
 10082           PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10083           move 'NET PAY + 6'    TO EMI-ERROR-TEXT (1) (18:11)
 10084     END-IF.
 10085     IF PI-COMPANY-ID = 'AHL'
 10086        evaluate true
 10087           when CM-LF-BENEFIT-CD = '5I' OR '6J'
 10088              MOVE ER-0879       TO  EMI-ERROR
 10089              PERFORM 1040-PMTTYPE-ERROR
 10090                                 THRU 1040-EXIT
 10091              move 'NET PAY + 6' TO EMI-ERROR-TEXT (1) (18:11)
 10092           when CM-LF-BENEFIT-CD = '5G' OR '5J' OR '5S' OR
 10093                 '6D' OR '6H' OR '6R'
 10094              MOVE ER-0879       TO  EMI-ERROR
 10095              PERFORM 1040-PMTTYPE-ERROR
 10096                                 THRU 1040-EXIT
 10097              move 'NET PAY + 2' TO EMI-ERROR-TEXT (1) (18:11)
 10098           when CM-LF-BENEFIT-CD = '5M' OR '6M'
 10099              MOVE ER-0879       TO  EMI-ERROR
 10100              PERFORM 1040-PMTTYPE-ERROR
 10101                                 THRU 1040-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 190
* EL156.cbl
 10102              move 'NET PAY + 1' TO EMI-ERROR-TEXT (1) (18:11)
 10103        end-evaluate
 10104     END-IF
 10105     GO TO 1045-EDIT-PAYEE-ADDR.
 10106
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 191
* EL156.cbl
 10108 1030-DO-AH-EDITS.
 10109     MOVE CM-AH-BENEFIT-CD       TO PI-AH-BENEFIT-CD
 10110     IF CM-AH-BENEFIT-CD = '00'
 10111         IF PI-PMTTYPE = '5' OR '6'
 10112             MOVE ER-0658        TO EMI-ERROR
 10113             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10114         ELSE
 10115             MOVE ER-1775        TO EMI-ERROR
 10116             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10117
 10118     IF CL-TOTAL-PAID-AMT = ZEROS
 10119         IF PI-PMTTYPE = '4'
 10120             MOVE ER-0438        TO EMI-ERROR
 10121             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10122
 10123     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 10124         IF PI-PMTTYPE = '3'
 10125             MOVE ER-0463        TO EMI-ERROR
 10126             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10127         ELSE
 10128             IF (CL-INCURRED-DT NOT < CM-LF-DEATH-EXIT-DT)
 10129              AND CM-LF-CURRENT-STATUS = '7'
 10130                 MOVE ER-0465    TO EMI-ERROR
 10131                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10132
 10133     IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
 10134         IF PI-PMTTYPE = '3'
 10135             MOVE ER-0464        TO EMI-ERROR
 10136             PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10137         ELSE
 10138             IF CL-INCURRED-DT > CM-AH-SETTLEMENT-DT
 10139                 MOVE ER-0469    TO EMI-ERROR
 10140                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10141
 10142     IF CM-AH-CANCEL-DT NOT = LOW-VALUES
 10143         IF PI-PMTTYPE = '3'
 10144             IF CL-INCURRED-DT NOT = CM-AH-CANCEL-DT
 10145                 MOVE ER-0467    TO EMI-ERROR
 10146                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT
 10147             ELSE
 10148                 NEXT SENTENCE
 10149         ELSE
 10150             IF CL-INCURRED-DT NOT < CM-AH-CANCEL-DT
 10151                 MOVE ER-0468    TO EMI-ERROR
 10152                 PERFORM 1040-PMTTYPE-ERROR THRU 1040-EXIT.
 10153
 10154     GO TO 1045-EDIT-PAYEE-ADDR.
 10155
 10156 1040-PMTTYPE-ERROR.
 10157     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10158
 10159     IF EMI-MESSAGE-FORMATTED
 10160         MOVE -1                 TO PMTTYPEL
 10161         MOVE AL-UABON           TO PMTTYPEA.
 10162
 10163 1040-EXIT.
 10164     EXIT.
 10165
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 192
* EL156.cbl
 10167 1045-EDIT-PAYEE-ADDR.
 10168
 10169     IF PI-OFFLINE = 'N' AND
 10170        ((PI-PAYEE-TYPE = 'A' AND CL-ACCOUNT-ADDR-CNT
 10171           < PI-PAYEE-SEQ-NUM)
 10172        OR
 10173         (PI-COMPANY-ID NOT = 'AIG' AND 'AUK') AND
 10174         (PI-PAYEE-TYPE = 'B')                 AND
 10175         (CL-BENIF-ADDR-CNT < PI-PAYEE-SEQ-NUM)
 10176        OR
 10177         (PI-PAYEE-TYPE = 'I' AND CL-INSURED-ADDR-CNT
 10178           < PI-PAYEE-SEQ-NUM)
 10179        OR
 10180         (PI-PAYEE-TYPE = 'O' AND CL-OTHER-1-ADDR-CNT
 10181           < PI-PAYEE-SEQ-NUM)
 10182        OR
 10183         (PI-PAYEE-TYPE = 'Q' AND CL-OTHER-2-ADDR-CNT
 10184           < PI-PAYEE-SEQ-NUM)
 10185        OR
 10186         (PI-PAYEE-TYPE = 'P' AND CL-DOCTOR-ADDR-CNT
 10187           < PI-PAYEE-SEQ-NUM)
 10188        OR
 10189         (PI-PAYEE-TYPE = 'E' AND CL-EMPLOYER-ADDR-CNT
 10190           < PI-PAYEE-SEQ-NUM))
 10191             MOVE ER-0437        TO EMI-ERROR
 10192             MOVE -1             TO PAYEEL
 10193             MOVE AL-UABON       TO PAYEEA
 10194             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10195
 10196     IF PI-OFFLINE    = 'N' AND
 10197        PI-PAYEE-TYPE = 'B' AND
 10198        PI-PAYEE-SEQ  = '0'
 10199         PERFORM 7920-READ-BENE THRU 7920-EXIT
 10200         IF BENE-FOUND-SW = 'N'
 10201             MOVE ER-0437        TO EMI-ERROR
 10202             MOVE -1             TO PAYEEL
 10203             MOVE AL-UABON       TO PAYEEA
 10204             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10205
 10206     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10207        IF PI-OFFLINE    = 'N'  AND
 10208           PI-PAYEE-TYPE = 'B'  AND
 10209           PI-PAYEE-SEQ  = '9'
 10210             PERFORM 7920-READ-BENE THRU 7920-EXIT
 10211             IF BENE-FOUND-SW = 'N'
 10212                MOVE ER-0437        TO EMI-ERROR
 10213                MOVE -1             TO PAYEEL
 10214                MOVE AL-UABON       TO PAYEEA
 10215                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10216
 10217*    IF PI-COMPANY-ID = 'CRI'
 10218*        IF CL-CLAIM-TYPE = 'L'
 10219*            MOVE 'N'                TO  WS-GROUPED
 10220*                                        PI-GROUPED
 10221*                                        GROUPEDI
 10222*            MOVE AL-UANON           TO  GROUPEDA
 10223*            GO TO 1050-EDIT-CHECK-NO
 10224*        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 193
* EL156.cbl
 10225*            MOVE CL-CERT-GROUPING   TO  WS-GROUPING
 10226*            IF WS-GROUP-1 = 'C'
 10227*                NEXT SENTENCE
 10228*            ELSE
 10229*                MOVE 'N'            TO  WS-GROUPED
 10230*                                        PI-GROUPED
 10231*                                        GROUPEDI
 10232*                MOVE AL-UANON       TO  GROUPEDA
 10233*                GO TO 1050-EDIT-CHECK-NO.
 10234
 10235*     IF PI-GROUPED = 'Y'
 10236*        IF PI-PAYEE-TYPE = 'B' OR 'A'
 10237*           NEXT SENTENCE
 10238*        ELSE
 10239*           MOVE ER-0437        TO EMI-ERROR
 10240*           MOVE -1             TO PAYEEL
 10241**02180            MOVE AL-UABON       TO PAYEEA
 10242*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10243*
 10244*     IF (PI-PAYEE-TYPE = 'B' OR 'A') AND
 10245*        (PI-GROUPED    = ' ')
 10246*        NEXT SENTENCE
 10247*     ELSE
 10248*
 10249     GO TO 1050-EDIT-CHECK-NO.
 10250*     IF PI-COMPANY-ID = 'CRI'
 10251*        MOVE 'N'           TO GROUPEDI
 10252*                              PI-GROUPED
 10253*                              WS-GROUPED
 10254*        MOVE AL-UANON      TO GROUPEDA.
 10255*
 10256*     IF PI-COMPANY-ID = 'CRI'
 10257*        IF PI-PAYEE-TYPE = 'B'
 10258*           IF BENE-FOUND-SW = 'Y'
 10259*              IF BE-GROUP-CHECKS-Y-N = 'Y'
 10260*                 MOVE 'Y'           TO GROUPEDI
 10261*                                       PI-GROUPED
 10262*                                       WS-GROUPED
 10263*                 MOVE AL-UANON      TO GROUPEDA
 10264*              ELSE
 10265*                 NEXT SENTENCE
 10266*           ELSE
 10267*              PERFORM 7920-READ-BENE THRU 7920-EXIT
 10268*              IF BENE-FOUND-SW = 'Y'
 10269*                 IF BE-GROUP-CHECKS-Y-N = 'Y'
 10270*                    MOVE 'Y'      TO GROUPEDI
 10271*                                     PI-GROUPED
 10272*                                     WS-GROUPED
 10273*                    MOVE AL-UANON TO GROUPEDA.
 10274*
 10275
 10276     IF PI-COMPANY-ID NOT = 'CRI'
 10277        GO TO 1050-EDIT-CHECK-NO.
 10278
 10279*************** CRI CODE START ******************
 10280     IF PI-PAYEE-TYPE NOT = 'A'
 10281        GO TO 1050-EDIT-CHECK-NO.
 10282
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 194
* EL156.cbl
 10283     MOVE LOW-VALUES             TO ERACCT-KEY.
 10284     MOVE PI-COMPANY-CD          TO ACCT-COMP-CD.
 10285     MOVE PI-CARRIER             TO ACCT-CARRIER.
 10286     MOVE PI-GROUPING            TO ACCT-GROUPING.
 10287     MOVE PI-STATE               TO ACCT-STATE.
 10288     MOVE PI-ACCOUNT             TO ACCT-ACCOUNT.
 10289     MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 10290     MOVE 'ACCT'                 TO FILE-SWITCH.
 10291
 10292     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 10293     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 10294
 10295
 10296* EXEC CICS HANDLE CONDITION
 10297*         NOTFND   (1950-NOT-FOUND)
 10298*         ENDFILE  (1950-NOT-FOUND)
 10299*    END-EXEC.
 10300*    MOVE '"$I''                  ! ( #00009924' TO DFHEIV0
 10301     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 10302     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10303     MOVE X'2820233030303039393234' TO DFHEIV0(25:11)
 10304     CALL 'kxdfhei1' USING DFHEIV0
 10305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10306
 10307
 10308
 10309* EXEC CICS STARTBR
 10310*         DATASET   ('ERACCT')
 10311*         RIDFLD    (ERACCT-KEY)
 10312*         GTEQ
 10313*    END-EXEC.
 10314     MOVE 'ERACCT' TO DFHEIV1
 10315     MOVE 0
 10316       TO DFHEIV11
 10317*    MOVE '&,         G          &   #00009929' TO DFHEIV0
 10318     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 10319     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10320     MOVE X'2020233030303039393239' TO DFHEIV0(25:11)
 10321     CALL 'kxdfhei1' USING DFHEIV0,
 10322           DFHEIV1,
 10323           ERACCT-KEY,
 10324           DFHEIV99,
 10325           DFHEIV11,
 10326           DFHEIV99
 10327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10328
 10329
 10330 1046-READNEXT-ERACCT.
 10331
 10332
 10333* EXEC CICS READNEXT
 10334*         DATASET   ('ERACCT')
 10335*         RIDFLD    (ERACCT-KEY)
 10336*         SET       (ADDRESS OF ACCOUNT-MASTER)
 10337*    END-EXEC.
 10338     MOVE 'ERACCT' TO DFHEIV1
 10339     MOVE 0
 10340       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 195
* EL156.cbl
 10341*    MOVE '&.S                   )   #00009937' TO DFHEIV0
 10342     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 10343     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 10344     MOVE X'2020233030303039393337' TO DFHEIV0(25:11)
 10345     CALL 'kxdfhei1' USING DFHEIV0,
 10346           DFHEIV1,
 10347           DFHEIV20,
 10348           DFHEIV99,
 10349           ERACCT-KEY,
 10350           DFHEIV99,
 10351           DFHEIV11,
 10352           DFHEIV99,
 10353           DFHEIV99
 10354     SET ADDRESS OF ACCOUNT-MASTER TO
 10355         DFHEIV20
 10356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10357
 10358
 10359     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 10360        IF WS-ERACCT-HOLD-RECORD = SPACES
 10361           GO TO 1950-NOT-FOUND
 10362        ELSE
 10363           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 10364           GO TO 1048-CONTINUE.
 10365
 10366     IF ACCT-EXP-DT = HIGH-VALUES
 10367        NEXT SENTENCE
 10368     ELSE
 10369        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 10370        GO TO 1046-READNEXT-ERACCT.
 10371
 10372 1048-CONTINUE.
 10373
 10374*    IF AM-GROUPED-CHECKS-Y-N = 'Y'
 10375*       MOVE 'Y'                 TO GROUPEDI
 10376*                                   PI-GROUPED
 10377*                                   WS-GROUPED
 10378*       MOVE AL-UANON            TO GROUPEDA.
 10379*************** CRI CODE END ******************
 10380
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 196
* EL156.cbl
 10382 1050-EDIT-CHECK-NO.
 10383
 10384     IF PI-OFFLINE = 'Y'
 10385         IF PI-ECHECKNO = SPACES
 10386              MOVE ER-0439        TO EMI-ERROR
 10387              GO TO 1090-CHECK-NO-ERROR
 10388           ELSE
 10389*        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10390*           IF PI-ECHECKNO-N = 'N' AND
 10391*              PI-CASH       = 'Y'
 10392*                MOVE ER-3535        TO EMI-ERROR
 10393*                GO TO 1090-CHECK-NO-ERROR
 10394*             ELSE
 10395*                MOVE AL-UANON    TO CHECKNOA
 10396*                GO TO 1100-EDIT-HOLDTIL
 10397*         ELSE
 10398            MOVE AL-UANON    TO CHECKNOA
 10399            GO TO 1100-EDIT-HOLDTIL.
 10400
 10401     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10402     MOVE '6'                    TO CNTL-REC-TYPE.
 10403
 10404     IF CONTROL-IS-ACTUAL-CARRIER
 10405         MOVE PI-CARRIER         TO WS-CARR
 10406     ELSE
 10407         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 10408
 10409     IF PI-COMPANY-ID = 'FIA'
 10410         MOVE PI-CARRIER         TO WS-CARR.
 10411
 10412     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 10413     MOVE 0                      TO CNTL-SEQ-NO.
 10414     MOVE 'CARR'                 TO FILE-SWITCH.
 10415
 10416     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 10417
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 197
* EL156.cbl
 10419     IF PI-COMPANY-ID NOT = 'AIG' AND 'AUK'
 10420         GO TO 1051-EDIT-CHECKNO-CONT.
 10421
 10422**********************AIG LOGIC STARTS**********************
 10423     IF PI-ECHECKNO = SPACES
 10424         IF CHECK-NO-MANUAL
 10425             MOVE ER-0441        TO EMI-ERROR
 10426             GO TO 1090-CHECK-NO-ERROR
 10427         ELSE
 10428             MOVE AL-UANOF       TO CHECKNOA
 10429             GO TO 1100-EDIT-HOLDTIL.
 10430
 10431     IF PI-ECHECKNO NOT = SPACES
 10432         IF CHECK-NO-MANUAL
 10433             MOVE AL-UANON       TO CHECKNOA
 10434             GO TO 1100-EDIT-HOLDTIL.
 10435
 10436     IF PI-ECHECKNO-CR = 'CR'
 10437        IF PI-OFFLINE = 'Y'
 10438            MOVE AL-UANON       TO CHECKNOA
 10439            GO TO 1100-EDIT-HOLDTIL
 10440        ELSE
 10441            MOVE ER-3534        TO EMI-ERROR
 10442            GO TO 1090-CHECK-NO-ERROR.
 10443
 10444     IF PI-ECHECKNO-N = 'N'
 10445        IF PI-CASH = 'N'
 10446            MOVE AL-UANON       TO CHECKNOA
 10447            GO TO 1100-EDIT-HOLDTIL
 10448        ELSE
 10449            MOVE ER-3535          TO EMI-ERROR
 10450            GO TO 1090-CHECK-NO-ERROR.
 10451
 10452     MOVE ER-0442        TO EMI-ERROR
 10453     GO TO 1090-CHECK-NO-ERROR.
 10454**********************AIG LOGIC ENDS************************
 10455
 10456 1051-EDIT-CHECKNO-CONT.
 10457
 10458     IF PI-COMPANY-ID = 'DMD'
 10459        IF PI-ECHECKNO NOT = SPACES
 10460           IF PI-ECHECKNO (6:2) NOT = 'TP'
 10461              MOVE ER-0442        TO EMI-ERROR
 10462              GO TO 1090-CHECK-NO-ERROR
 10463            ELSE
 10464              GO TO 1100-EDIT-HOLDTIL
 10465          ELSE
 10466           GO TO 1100-EDIT-HOLDTIL.
 10467
 10468     IF PI-ECHECKNO = SPACES
 10469         IF CHECK-NO-MANUAL
 10470             MOVE ER-0441        TO EMI-ERROR
 10471             GO TO 1090-CHECK-NO-ERROR
 10472         ELSE
 10473             MOVE AL-UANOF       TO CHECKNOA
 10474             GO TO 1100-EDIT-HOLDTIL
 10475     ELSE
 10476         IF CHECK-NO-MANUAL
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 198
* EL156.cbl
 10477             MOVE AL-UANON       TO CHECKNOA
 10478             GO TO 1100-EDIT-HOLDTIL
 10479         ELSE
 10480             MOVE ER-0442        TO EMI-ERROR
 10481             GO TO 1090-CHECK-NO-ERROR.
 10482
 10483 1090-CHECK-NO-ERROR.
 10484     MOVE -1                     TO CHECKNOL.
 10485     MOVE AL-UABON               TO CHECKNOA.
 10486     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10487
 10488     GO TO 2000-EDIT-DONE.
 10489
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 199
* EL156.cbl
 10491 1100-EDIT-HOLDTIL.
 10492     MOVE AL-UANON               TO HOLDTILA.
 10493
 10494     IF PI-HOLDTIL = ZEROS
 10495        IF PI-OFFLINE = 'Y'
 10496           MOVE ER-0572          TO EMI-ERROR
 10497           GO TO 1105-HOLDTIL-ERROR
 10498        ELSE
 10499           GO TO 1110-EDIT-PAID-FROM.
 10500
 10501     MOVE '4'                    TO DC-OPTION-CODE.
 10502     MOVE PI-HOLDTIL             TO DC-GREG-DATE-1-MDY.
 10503     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10504
 10505     IF DATE-CONVERSION-ERROR
 10506         MOVE ER-0446            TO EMI-ERROR
 10507         GO TO 1105-HOLDTIL-ERROR
 10508     END-IF
 10509     IF PI-OFFLINE = 'Y'
 10510        IF DC-BIN-DATE-1 < SAVE-BIN-DATE
 10511           MOVE ER-0446            TO EMI-ERROR
 10512           GO TO 1105-HOLDTIL-ERROR
 10513        END-IF
 10514     END-IF
 10515
 10516     IF PI-OFFLINE = 'Y'
 10517        GO TO 1110-EDIT-PAID-FROM.
 10518
 10519     MOVE DC-BIN-DATE-1          TO DC-BIN-DATE-2.
 10520     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 10521     MOVE '1'                    TO DC-OPTION-CODE.
 10522     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10523
 10524     IF DC-ELAPSED-DAYS > 30 OR DATE-CONVERSION-ERROR
 10525         MOVE ER-0447            TO EMI-ERROR
 10526         GO TO 1105-HOLDTIL-ERROR.
 10527
 10528     GO TO 1110-EDIT-PAID-FROM.
 10529
 10530 1105-HOLDTIL-ERROR.
 10531     MOVE -1                     TO HOLDTILL.
 10532     MOVE AL-UNBON               TO HOLDTILA.
 10533     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10534
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 200
* EL156.cbl
 10536 1110-EDIT-PAID-FROM.
 10537     MOVE AL-UANON               TO EPYFROMA.
 10538
 10539     IF PI-EPYFROM = ZEROS
 10540         GO TO 1120-CALCULATE-PAID-FROM.
 10541
 10542     IF PI-PMTTYPE = '5' OR '6'
 10543         MOVE ER-0448            TO EMI-ERROR
 10544         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10545         MOVE AL-UNBON           TO EPYFROMA
 10546         MOVE -1                 TO EPYFROML
 10547         GO TO 1150-EDIT-PAID-THRU.
 10548
 10549     MOVE '4'                    TO DC-OPTION-CODE.
 10550     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 10551     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10552
 10553     IF DATE-CONVERSION-ERROR
 10554         MOVE ER-0449            TO EMI-ERROR
 10555         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10556         MOVE AL-UNBON           TO EPYFROMA
 10557         MOVE -1                 TO EPYFROML
 10558     ELSE
 10559         MOVE DC-BIN-DATE-1      TO WS-SV-EPYFROM.
 10560
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 201
* EL156.cbl
 10562 1120-CALCULATE-PAID-FROM.
 10563     IF PI-PMTTYPE = '5' OR '6'
 10564         GO TO 1150-EDIT-PAID-THRU.
 10565
 10566*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10567*       IF PI-PMTTYPE = '4'
 10568*         GO TO 1150-EDIT-PAID-THRU.
 10569
 10570     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 10571         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 10572         MOVE ' '                TO DC-OPTION-CODE
 10573         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10574         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10575         GO TO 1145-TEST-PAID-FROM.
 10576
 10577     IF PI-PMTTYPE = '4'
 10578        GO TO 1150-EDIT-PAID-THRU.
 10579
 10580     MOVE CM-AH-BENEFIT-CD       TO WS-BEN-CD.
 10581     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10582     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10583     MOVE '5'                    TO CNTL-REC-TYPE.
 10584     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10585     MOVE 'BENE'                 TO FILE-SWITCH.
 10586
 10587     IF WS-BEN-CD = ZEROS
 10588         GO TO 1950-NOT-FOUND.
 10589
 10590     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10591
 10592     IF NO-BENEFIT-FOUND
 10593         GO TO 1950-NOT-FOUND.
 10594
 10595     MOVE CF-BENEFIT-ALPHA   (SUB-1) TO PI-BENEFIT-SAVE.
 10596     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10597
 10598     IF PI-BEN-DAYS NOT NUMERIC
 10599        MOVE ZEROS               TO PI-BEN-DAYS.
 10600
 10601     MOVE PI-BEN-DAYS            TO WS-BEN-DAYS.
 10602
 10603     IF (CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES)  AND
 10604        (CL-TOTAL-PAID-AMT > ZEROS)
 10605         MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 10606         MOVE '6'                 TO DC-OPTION-CODE
 10607         MOVE +0                  TO DC-ELAPSED-MONTHS
 10608         MOVE +1                  TO DC-ELAPSED-DAYS
 10609         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10610         MOVE DC-BIN-DATE-2       TO PI-CPYFROM
 10611         GO TO 1145-TEST-PAID-FROM.
 10612
 10613******************************************************************
 10614****** ON FIRST PAYMENTS, ELIM/RETRO EDITS TO BE MADE AGAINST THE
 10615****** SPECIAL ENTERED DATE.
 10616******************************************************************
 10617
 10618     IF PI-AIGFROM = ZEROS
 10619         GO TO 1130-CONTINUE-PAID-FROM.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 202
* EL156.cbl
 10620
 10621     MOVE AL-UANON TO AIGFROMA.
 10622
 10623     MOVE '4'                    TO DC-OPTION-CODE.
 10624     MOVE PI-AIGFROM             TO DC-GREG-DATE-1-MDY.
 10625     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10626
 10627     IF DATE-CONVERSION-ERROR
 10628         MOVE ER-0449            TO EMI-ERROR
 10629         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10630         MOVE AL-UNBON           TO AIGFROMA
 10631         MOVE -1                 TO AIGFROML
 10632         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1
 10633     ELSE
 10634         MOVE 'Y'                TO WS-AIG-PAYFROM-SW
 10635         MOVE DC-BIN-DATE-1      TO WS-SV-AIGFROM.
 10636
 10637     GO TO 1140-CONTINUE-PAID-FROM.
 10638
 10639 1130-CONTINUE-PAID-FROM.
 10640
 10641     IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10642        (CL-TOTAL-PAID-AMT = ZEROS)
 10643           MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 10644
 10645 1140-CONTINUE-PAID-FROM.
 10646
 10647     IF PI-BEN-TYPE = 'R'
 10648         IF PI-BEN-DAYS = ZEROS
 10649             NEXT SENTENCE
 10650         ELSE
 10651         IF PI-COMPANY-ID NOT = 'DMD'
 10652             SUBTRACT 1 FROM PI-BEN-DAYS.
 10653
 10654     MOVE DC-BIN-DATE-1          TO WS-HOLD-BIN-DATE-1.
 10655
 10656     IF PI-COMPANY-ID = 'DMD'
 10657         MOVE -1                 TO DC-ELAPSED-DAYS
 10658         MOVE +0                 TO DC-ELAPSED-MONTHS
 10659         MOVE '6'                TO DC-OPTION-CODE
 10660         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10661         MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 10662         DIVIDE PI-BEN-DAYS BY 30 GIVING DC-ELAPSED-MONTHS
 10663                               REMAINDER DC-ELAPSED-DAYS
 10664      ELSE
 10665         MOVE PI-BEN-DAYS        TO DC-ELAPSED-DAYS
 10666         MOVE +0                 TO DC-ELAPSED-MONTHS.
 10667
 10668     MOVE '6'                    TO DC-OPTION-CODE.
 10669     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10670     MOVE DC-BIN-DATE-2          TO WS-RETRO-ELIM-DATE.
 10671
 10672     MOVE WS-HOLD-BIN-DATE-1     TO DC-BIN-DATE-1.
 10673
 10674     IF WS-RETRO-ELIM-DATE > WS-TODAY-DATE
 10675         MOVE ER-0541            TO EMI-ERROR
 10676         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10677         MOVE -1                 TO EPYFROML
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 203
* EL156.cbl
 10678         MOVE AL-UNBON           TO EPYFROMA.
 10679
 10680     IF (PI-COMPANY-ID = 'AIG' OR 'AUK')  AND
 10681        (PI-BENEFIT-SAVE = '60E')
 10682        IF (CL-PAID-THRU-DT   = LOW-VALUES OR SPACES) OR
 10683           (CL-TOTAL-PAID-AMT = ZEROS)
 10684             MOVE WS-HOLD-BIN-DATE-1  TO DC-BIN-DATE-1
 10685             MOVE 30                  TO DC-ELAPSED-DAYS
 10686             MOVE +0                  TO DC-ELAPSED-MONTHS
 10687             MOVE '6'                 TO DC-OPTION-CODE
 10688             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10689
 10690     IF PI-BEN-TYPE = 'R'
 10691         MOVE DC-BIN-DATE-1      TO PI-CPYFROM
 10692     ELSE
 10693         MOVE DC-BIN-DATE-2      TO PI-CPYFROM
 10694         IF WS-SV-EPYFROM = LOW-VALUES
 10695            MOVE DC-BIN-DATE-2   TO WS-SV-EPYFROM.
 10696
 10697     IF CL-PAID-THRU-DT = LOW-VALUES OR SPACES
 10698         IF WS-USE-AIG-PAYFROM   OR
 10699            WS-AIG-RECALC-PAYFROM
 10700              MOVE PI-CPYFROM     TO  WS-SV-EPYFROM
 10701                                      DC-BIN-DATE-1
 10702              MOVE ' '            TO  DC-OPTION-CODE
 10703              MOVE +0             TO  DC-ELAPSED-MONTHS
 10704                                      DC-ELAPSED-DAYS
 10705              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10706              IF NO-CONVERSION-ERROR
 10707                  MOVE DC-GREG-DATE-1-MDY TO PI-EPYFROM.
 10708
 10709     IF PI-CPYFROM < CL-INCURRED-DT
 10710        MOVE -1                  TO EPYFROML
 10711        MOVE ER-3542             TO EMI-ERROR
 10712        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10713
 10714     IF CM-ENTRY-DT < CL-INCURRED-DT
 10715        MOVE CM-ENTRY-DT            TO DC-BIN-DATE-1
 10716        MOVE CL-INCURRED-DT         TO DC-BIN-DATE-2
 10717        MOVE +0                     TO DC-ELAPSED-DAYS
 10718        MOVE +0                     TO DC-ELAPSED-MONTHS
 10719        MOVE '1'                    TO DC-OPTION-CODE
 10720        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10721        ELSE
 10722        MOVE ZEROS TO DC-ELAPSED-MONTHS.
 10723
 10724     IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 10725         NEXT SENTENCE
 10726     ELSE
 10727         IF DC-ELAPSED-MONTHS < 2
 10728             MOVE ER-3255        TO EMI-ERROR
 10729             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10730
 10731 1145-TEST-PAID-FROM.
 10732     IF LOW-VALUES = WS-SV-EPYFROM OR PI-CPYFROM
 10733         GO TO 1150-EDIT-PAID-THRU.
 10734
 10735     IF WS-SV-EPYFROM NOT = PI-CPYFROM
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 204
* EL156.cbl
 10736         MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 10737         MOVE ' '                TO DC-OPTION-CODE
 10738         MOVE +0                 TO DC-ELAPSED-MONTHS
 10739                                    DC-ELAPSED-DAYS
 10740         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10741         IF NO-CONVERSION-ERROR
 10742             MOVE DC-GREG-DATE-1-MDY TO EMI-DATE-FIELD
 10743         ELSE
 10744             MOVE SPACES             TO EMI-DATE-FIELD.
 10745
 10746     IF WS-SV-EPYFROM NOT = PI-CPYFROM
 10747         IF CL-TOTAL-PAID-AMT = ZEROS
 10748             MOVE ER-3543            TO EMI-ERROR
 10749             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10750             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10751             IF EMI-MESSAGE-FORMATTED
 10752                MOVE -1             TO EPYFROML
 10753                MOVE AL-UNBON       TO EPYFROMA
 10754             ELSE
 10755                NEXT SENTENCE
 10756         ELSE
 10757             MOVE ER-0452            TO EMI-ERROR
 10758             MOVE WS-SV-EPYFROM      TO PI-CPYFROM
 10759             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10760             IF EMI-MESSAGE-FORMATTED
 10761                MOVE -1             TO EPYFROML
 10762                MOVE AL-UNBON       TO EPYFROMA.
 10763
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 205
* EL156.cbl
 10765 1150-EDIT-PAID-THRU.
 10766
 10767     MOVE AL-UANON               TO EPYTHRUA.
 10768
 10769     IF PI-EPYTHRU = ZEROS
 10770         IF PI-PMTTYPE = '4' OR '5' OR '6'
 10771             GO TO 1200-EDIT-FIND-TOLERANCES
 10772         ELSE
 10773            IF (PI-PMTTYPE = '3') OR
 10774               (PI-PMTTYPE = '2' AND
 10775                PI-LIFE-OVERRIDE-L1 = CL-CLAIM-TYPE)
 10776               GO TO 1152-CHECK-TYPE
 10777            ELSE
 10778               MOVE ER-0473      TO EMI-ERROR
 10779               GO TO 1170-PAID-THRU-FATAL-ERROR
 10780     ELSE
 10781         IF PI-PMTTYPE = '5' OR '6'
 10782             MOVE ER-0474        TO EMI-ERROR
 10783             GO TO 1170-PAID-THRU-FATAL-ERROR.
 10784
 10785     MOVE '4'                    TO DC-OPTION-CODE.
 10786     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 10787     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10788
 10789     IF DATE-CONVERSION-ERROR
 10790         MOVE ER-0475            TO EMI-ERROR
 10791         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10792
 10793     MOVE DC-BIN-DATE-1       TO WS-SV-EPYTHRU.
 10794
 10795     IF PI-COMPANY-ID = 'DMD'
 10796         IF PI-PMTTYPE NOT = '2'
 10797                 AND
 10798            WS-EXP-DT > WS-SV-EPYTHRU
 10799             MOVE WS-SV-EPYTHRU    TO DC-BIN-DATE-1
 10800             MOVE WS-EXP-DT        TO DC-BIN-DATE-2
 10801             MOVE '1'              TO DC-OPTION-CODE
 10802             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 10803             IF DATE-CONVERSION-ERROR
 10804                 MOVE ER-0944      TO EMI-ERROR
 10805                 GO TO 1170-PAID-THRU-FATAL-ERROR
 10806             ELSE
 10807                 IF DC-ELAPSED-MONTHS = ZEROS AND
 10808                    DC-ELAPSED-DAYS   = 1
 10809                     MOVE ER-0945  TO EMI-ERROR
 10810                     MOVE -1       TO EPYTHRUL
 10811                     MOVE AL-UABON TO EPYTHRUA
 10812                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10813
 10814     IF PI-PMTTYPE = '4'
 10815         NEXT SENTENCE
 10816     ELSE
 10817         IF WS-SV-EPYTHRU = WS-EXP-DT
 10818             IF PI-PMTTYPE NOT = '2' AND '3'
 10819                 MOVE ER-3541    TO EMI-ERROR
 10820                 MOVE -1         TO PMTTYPEL
 10821                 MOVE AL-UABON   TO PMTTYPEA
 10822                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 206
* EL156.cbl
 10823
 10824     IF WS-SV-EPYTHRU < WS-SV-EPYFROM
 10825         MOVE ER-0501            TO EMI-ERROR
 10826         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10827
 10828     IF WS-SV-EPYTHRU > WS-TODAY-DATE
 10829        IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 10830*          IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 10831*              MOVE ER-0540         TO EMI-ERROR
 10832*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10833*              MOVE -1              TO EPYTHRUL
 10834*              MOVE AL-UNBON        TO EPYTHRUA
 10835*          ELSE
 10836*          IF PI-COMPANY-ID = 'DMD'
 10837*              MOVE ER-7540         TO EMI-ERROR
 10838*              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10839*              MOVE -1              TO EPYTHRUL
 10840*              MOVE AL-UNBON        TO EPYTHRUA
 10841*          ELSE
 10842               IF PI-PMTTYPE NOT = '2' AND '3'
 10843                  IF PI-COMPANY-ID = '???'
 10844                      MOVE ER-7540  TO EMI-ERROR
 10845                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10846                      MOVE -1       TO EPYTHRUL
 10847                      MOVE AL-UNBON TO EPYTHRUA
 10848                  ELSE
 10849                      MOVE ER-0540  TO EMI-ERROR
 10850                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10851                      MOVE -1       TO EPYTHRUL
 10852                      MOVE AL-UNBON TO EPYTHRUA.
 10853
 10854     IF (WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10855            OR
 10856        (WS-SV-EPYTHRU NOT = LOW-VALUES AND
 10857         WS-SV-EPYTHRU < CL-PAID-THRU-DT)
 10858            OR
 10859        (PI-CPYFROM NOT = LOW-VALUES AND
 10860         PI-CPYFROM < CL-PAID-THRU-DT)
 10861        PERFORM 1166-CHECK-ALL-TRLRS THRU 1166-TRLR-EXIT.
 10862
 10863 1152-CHECK-TYPE.
 10864     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 10865        OR (PI-PMTTYPE = '5' OR '6')
 10866         GO TO 1160-EDIT-PAID-THRU-AH.
 10867
 10868 1155-EDIT-PAID-THRU-LIFE.
 10869     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 10870     MOVE WS-ACCESS              TO CNTL-ACCESS.
 10871     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 10872     MOVE '4'                    TO CNTL-REC-TYPE.
 10873     MOVE ZEROS                  TO CNTL-SEQ-NO.
 10874     MOVE 'BENE'                 TO FILE-SWITCH.
 10875
 10876     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 10877
 10878     IF NO-BENEFIT-FOUND
 10879         GO TO 1950-NOT-FOUND.
 10880
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 207
* EL156.cbl
 10881     MOVE CF-SPECIAL-CALC-CD (SUB-1) TO WS-SPECIAL-CALC-CD.
 10882
 10883     MOVE WS-EXP-DT              TO PI-CPYTHRU.
 10884
 10885     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 10886        PI-LF-COVERAGE-TYPE = 'P'
 10887         MOVE CL-INCURRED-DT     TO  PI-CPYTHRU
 10888         GO TO 1200-EDIT-FIND-TOLERANCES.
 10889
 10890     IF PI-EPYTHRU = ZEROS
 10891        MOVE PI-CPYTHRU          TO WS-SV-EPYTHRU.
 10892
 10893     IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10894         MOVE ER-0476            TO EMI-ERROR
 10895         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10896
 10897     MOVE CM-CERT-EFF-DT        TO DC-BIN-DATE-1.
 10898*    MOVE CM-LF-CRITICAL-PERIOD TO DC-ELAPSED-MONTHS.
 10899     move cl-critical-period    to dc-elapsed-months
 10900     MOVE +0                    TO DC-ELAPSED-DAYS.
 10901     MOVE '6'                   TO DC-OPTION-CODE.
 10902     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 10903
 10904     IF (NO-CONVERSION-ERROR AND
 10905         WS-SPECIAL-CALC-CD = 'C')
 10906        IF CL-INCURRED-DT > DC-BIN-DATE-2
 10907            MOVE ER-0657 TO EMI-ERROR
 10908            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10909
 10910     IF PI-COMPANY-ID = 'NCL'
 10911         IF WS-SPECIAL-CALC-CD = 'C' AND
 10912            cl-critical-period = zeros
 10913*           CM-LF-CRITICAL-PERIOD = +0
 10914             MOVE ER-0844       TO EMI-ERROR
 10915             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10916
 10917     GO TO 1200-EDIT-FIND-TOLERANCES.
 10918
 10919 1160-EDIT-PAID-THRU-AH.
 10920     IF PI-EPYTHRU = ZEROS
 10921        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10922                                    WS-SV-EPYTHRU
 10923     ELSE
 10924        MOVE WS-SV-EPYTHRU       TO PI-CPYTHRU.
 10925
 10926     IF WS-SV-EPYTHRU < PI-CPYFROM
 10927         MOVE ER-0508            TO EMI-ERROR
 10928         GO TO 1170-PAID-THRU-FATAL-ERROR.
 10929
 10930     perform 7975-read-acct      thru 7975-exit
 10931     move zeros                  to pi-max-ext
 10932     if PI-DCC-PRODUCT-CODE NOT = SPACES
 10933        PERFORM 0900-GET-DDF-LIMITS
 10934                                 THRU 0900-EXIT
 10935        IF PDEF-FOUND
 10936           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 10937              (P1 > +8)
 10938              OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 208
* EL156.cbl
 10939           END-PERFORM
 10940           IF P1 < +9
 10941              MOVE PD-MAX-extension (P1)
 10942                                 TO pi-max-ext
 10943           else
 10944              move er-1674       to emi-error
 10945              PERFORM 9900-ERROR-FORMAT
 10946                                 THRU 9900-EXIT
 10947           END-IF
 10948        else
 10949           move er-1672          to emi-error
 10950           PERFORM 9900-ERROR-FORMAT
 10951                                 THRU 9900-EXIT
 10952        END-IF
 10953     end-if
 10954     move spaces                 to pi-max-ext-used
 10955     IF PI-PMTTYPE = '3'
 10956        MOVE WS-EXP-DT           TO PI-CPYTHRU
 10957        IF WS-SV-EPYTHRU NOT = WS-EXP-DT
 10958           MOVE ER-0477          TO EMI-ERROR
 10959           PERFORM 1165-PAID-THRU-ERROR
 10960                                 THRU 1165-EXIT
 10961        ELSE
 10962           continue
 10963        end-if
 10964     ELSE
 10965        IF WS-SV-EPYTHRU > WS-EXP-DT
 10966           move ws-exp-dt        to dc-bin-date-1
 10967           move ws-sv-epythru    to dc-bin-date-2
 10968           MOVE '1'              TO DC-OPTION-CODE
 10969           MOVE +0               TO DC-ELAPSED-DAYS
 10970                                    DC-ELAPSED-MONTHS
 10971           PERFORM 9700-LINK-DATE-CONVERT
 10972                                 THRU 9700-EXIT
 10973           if no-conversion-error
 10974              if dc-elapsed-days > zeros
 10975                 add +1 to dc-elapsed-months
 10976              end-if
 10977              if dc-elapsed-months > pi-max-ext
 10978                 MOVE ER-0557    TO EMI-ERROR
 10979                 PERFORM 1165-PAID-THRU-ERROR
 10980                                 THRU 1165-EXIT
 10981              else
 10982                 move 'Y'        to pi-max-ext-used
 10983                 move er-1670    to emi-error
 10984                 perform 9900-error-format
 10985                                 thru 9900-exit
 10986              end-if
 10987           end-if
 10988        end-if
 10989     end-if
 10990
 10991     IF (WS-RETRO-ELIM-DATE > WS-SV-EPYTHRU) AND
 10992         PI-PMTTYPE NOT = '3'
 10993         MOVE ER-0541        TO EMI-ERROR
 10994         PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 10995
 10996     IF (CM-AH-CANCEL-DT NOT = LOW-VALUES) AND
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 209
* EL156.cbl
 10997        (PI-PMTTYPE NOT = '3')
 10998         IF WS-SV-EPYTHRU > CM-AH-CANCEL-DT
 10999             MOVE ER-0478        TO EMI-ERROR
 11000             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11001
 11002     IF (CM-AH-SETTLEMENT-DT NOT = LOW-VALUES) AND
 11003        (PI-PMTTYPE NOT = '4')
 11004         IF WS-SV-EPYTHRU > CM-AH-SETTLEMENT-DT
 11005             MOVE ER-0479        TO EMI-ERROR
 11006             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11007
 11008     IF (CL-EST-END-OF-DISAB-DT NOT = LOW-VALUES) AND
 11009         WS-SV-EPYTHRU > CL-EST-END-OF-DISAB-DT
 11010             MOVE ER-0545        TO EMI-ERROR
 11011             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11012
 11013     IF CM-LF-DEATH-EXIT-DT NOT = LOW-VALUES
 11014         IF WS-SV-EPYTHRU > CM-LF-DEATH-EXIT-DT
 11015             MOVE ER-0481        TO EMI-ERROR
 11016             PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11017
 11018*    IF PI-COMPANY-ID = 'NCL'
 11019*        IF WS-SPECIAL-CALC-CD = 'C' AND
 11020*           CM-AH-CRITICAL-PERIOD = +0
 11021*            MOVE ER-0844        TO  EMI-ERROR
 11022*            PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11023
 11024*    IF (CM-AH-CRITICAL-PERIOD = ZEROS) OR
 11025     if (cl-critical-period = zeros)
 11026        or (WS-SPECIAL-CALC-CD NOT = 'C')
 11027          GO TO 1200-EDIT-FIND-TOLERANCES.
 11028
 11029     MOVE PI-CPYFROM TO DC-BIN-DATE-1.
 11030     MOVE PI-CPYTHRU TO DC-BIN-DATE-2.
 11031     MOVE '1'        TO DC-OPTION-CODE.
 11032     MOVE +0         TO DC-ELAPSED-DAYS
 11033                        DC-ELAPSED-MONTHS.
 11034     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11035
 11036*    IF NO-CONVERSION-ERROR
 11037*       COMPUTE ws-benefits-paid =
 11038*           (DC-ELAPSED-DAYS + CL-NO-OF-DAYS-PAID) / 30.5
 11039*       IF ws-benefits-paid > CM-AH-CRITICAL-PERIOD
 11040*           MOVE ER-0657 TO EMI-ERROR
 11041*           PERFORM 1165-PAID-THRU-ERROR THRU 1165-EXIT.
 11042
 11043     GO TO 1200-EDIT-FIND-TOLERANCES.
 11044
 11045 1165-PAID-THRU-ERROR.
 11046     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11047
 11048     IF EMI-MESSAGE-FORMATTED
 11049         MOVE -1                 TO EPYTHRUL
 11050         MOVE AL-UNBON           TO EPYTHRUA.
 11051
 11052 1165-EXIT.
 11053     EXIT.
 11054
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 210
* EL156.cbl
 11055 1166-CHECK-ALL-TRLRS.
 11056
 11057     IF PI-PMTTYPE = '4'
 11058        GO TO 1166-TRLR-EXIT.
 11059
 11060     MOVE ' ' TO WS-BROWSE-TRLR-SW.
 11061
 11062     IF WS-SV-EPYTHRU = LOW-VALUES  AND
 11063        WS-SV-EPYFROM = LOW-VALUES
 11064          GO TO 1166-END-CHECK.
 11065
 11066
 11067* EXEC CICS HANDLE CONDITION
 11068*        ENDFILE   (1166-END-CHECK)
 11069*        NOTFND    (1166-END-CHECK)
 11070*    END-EXEC.
 11071*    MOVE '"$''I                  ! ) #00010650' TO DFHEIV0
 11072     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11074     MOVE X'2920233030303130363530' TO DFHEIV0(25:11)
 11075     CALL 'kxdfhei1' USING DFHEIV0
 11076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11077
 11078
 11079     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 11080     MOVE +100                   TO TRLR-SEQ-NO.
 11081
 11082
 11083* EXEC CICS STARTBR
 11084*         DATASET    ('ELTRLR')
 11085*         RIDFLD     (ELTRLR-KEY)
 11086*         GTEQ
 11087*    END-EXEC.
 11088     MOVE 'ELTRLR' TO DFHEIV1
 11089     MOVE 0
 11090       TO DFHEIV11
 11091*    MOVE '&,         G          &   #00010658' TO DFHEIV0
 11092     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11093     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11094     MOVE X'2020233030303130363538' TO DFHEIV0(25:11)
 11095     CALL 'kxdfhei1' USING DFHEIV0,
 11096           DFHEIV1,
 11097           ELTRLR-KEY,
 11098           DFHEIV99,
 11099           DFHEIV11,
 11100           DFHEIV99
 11101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11102
 11103
 11104     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11105
 11106 1166-READ-TRLR-NEXT.
 11107
 11108
 11109* EXEC CICS READNEXT
 11110*         DATASET    ('ELTRLR')
 11111*         RIDFLD     (ELTRLR-KEY)
 11112*         SET        (ADDRESS OF ACTIVITY-TRAILERS)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 211
* EL156.cbl
 11113*    END-EXEC.
 11114     MOVE 'ELTRLR' TO DFHEIV1
 11115     MOVE 0
 11116       TO DFHEIV11
 11117*    MOVE '&.S                   )   #00010668' TO DFHEIV0
 11118     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11119     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11120     MOVE X'2020233030303130363638' TO DFHEIV0(25:11)
 11121     CALL 'kxdfhei1' USING DFHEIV0,
 11122           DFHEIV1,
 11123           DFHEIV20,
 11124           DFHEIV99,
 11125           ELTRLR-KEY,
 11126           DFHEIV99,
 11127           DFHEIV11,
 11128           DFHEIV99,
 11129           DFHEIV99
 11130     SET ADDRESS OF ACTIVITY-TRAILERS TO
 11131         DFHEIV20
 11132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11133
 11134
 11135     IF TRLR-COMP-CD  = MSTR-COMP-CD  AND
 11136        TRLR-CARRIER  = MSTR-CARRIER  AND
 11137        TRLR-CLAIM-NO = MSTR-CLAIM-NO AND
 11138        TRLR-CERT-NO  = MSTR-CERT-NO
 11139          NEXT SENTENCE
 11140      ELSE
 11141          GO TO 1166-END-CHECK.
 11142
 11143* **  BYPASS ALL NON-PAYMENT TRAILERS
 11144
 11145     IF AT-TRAILER-TYPE = '2'
 11146        NEXT SENTENCE
 11147     ELSE
 11148        GO TO 1166-READ-TRLR-NEXT.
 11149
 11150* **  BYPASS ALL NON-PARTIAL PAYMENTS
 11151
 11152     IF AT-PAYMENT-TYPE = '1' OR '2'
 11153        NEXT SENTENCE
 11154     ELSE
 11155        GO TO 1166-READ-TRLR-NEXT.
 11156
 11157* **  BYPASS ALL VOID PAYMENTS
 11158
 11159     IF AT-VOID-DT NOT = LOW-VALUES
 11160        GO TO 1166-READ-TRLR-NEXT.
 11161
 11162     IF (AT-PAID-FROM-DT = LOW-VALUES OR SPACES) OR
 11163        (AT-PAID-THRU-DT = LOW-VALUES OR SPACES)
 11164          GO TO 1166-READ-TRLR-NEXT.
 11165
 11166     IF ((WS-SV-EPYTHRU < AT-PAID-FROM-DT) AND
 11167         (WS-SV-EPYFROM < AT-PAID-FROM-DT))
 11168            OR
 11169        ((WS-SV-EPYTHRU > AT-PAID-THRU-DT) AND
 11170         (WS-SV-EPYFROM > AT-PAID-THRU-DT))
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 212
* EL156.cbl
 11171        NEXT SENTENCE
 11172     ELSE
 11173         IF CL-TOTAL-PAID-AMT > ZEROS
 11174             MOVE ER-0502            TO EMI-ERROR
 11175             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11176             MOVE -1                 TO EPYTHRUL
 11177             MOVE AL-UNBON           TO EPYTHRUA.
 11178
 11179     GO TO 1166-READ-TRLR-NEXT.
 11180
 11181 1166-END-CHECK.
 11182
 11183     IF WS-BROWSE-TRLR-SW = 'Y'
 11184
 11185* EXEC CICS ENDBR
 11186*            DATASET   ('ELTRLR')
 11187*       END-EXEC.
 11188     MOVE 'ELTRLR' TO DFHEIV1
 11189     MOVE 0
 11190       TO DFHEIV11
 11191*    MOVE '&2                    $   #00010723' TO DFHEIV0
 11192     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11193     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11194     MOVE X'2020233030303130373233' TO DFHEIV0(25:11)
 11195     CALL 'kxdfhei1' USING DFHEIV0,
 11196           DFHEIV1,
 11197           DFHEIV11,
 11198           DFHEIV99
 11199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11200
 11201
 11202     MOVE 'Y' TO WS-BROWSE-TRLR-SW.
 11203
 11204 1166-TRLR-EXIT.
 11205     EXIT.
 11206
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 213
* EL156.cbl
 11208 1170-PAID-THRU-FATAL-ERROR.
 11209     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11210
 11211     MOVE -1                     TO EPYTHRUL.
 11212     MOVE AL-UNBON               TO EPYTHRUA.
 11213
 11214 1200-EDIT-FIND-TOLERANCES.
 11215
 11216* EXEC CICS HANDLE CONDITION
 11217*        ENDFILE(1950-NOT-FOUND)
 11218*        NOTFND (1950-NOT-FOUND)
 11219*    END-EXEC.
 11220*    MOVE '"$''I                  ! * #00010740' TO DFHEIV0
 11221     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 11222     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11223     MOVE X'2A20233030303130373430' TO DFHEIV0(25:11)
 11224     CALL 'kxdfhei1' USING DFHEIV0
 11225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11226
 11227
 11228     IF PI-PROCESSOR-ID = 'LGXX'
 11229        GO TO 1240-FIND-ACCT-TOLERANCES.
 11230
 11231     MOVE 'N'                    TO FOUND-TOL-SW.
 11232     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11233     MOVE '2'                    TO CNTL-REC-TYPE.
 11234     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 11235     MOVE +0                     TO CNTL-SEQ-NO.
 11236     MOVE 'PROC'                 TO FILE-SWITCH.
 11237
 11238     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11239
 11240     MOVE CF-PROC-CALC-AMT-TOL   TO WS-PMT-TOL.
 11241     MOVE CF-PROC-MAX-REG-PMT    TO WS-MAX-PMT-TOL
 11242                                    PI-MAX-PMT-TOL.
 11243     MOVE CF-PROC-MAX-REG-DAYS   TO WS-MAX-DAYS-TOL.
 11244
 11245     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11246         MOVE CF-PROC-MAX-REG-PMT   TO  WS-HER-MO-PMT-AMT.
 11247
 11248     MOVE CF-PROC-CALC-DAYS-TOL  TO WS-DAYS-TOL.
 11249     MOVE CF-PROC-MAX-LF-PMT     TO WS-MAX-LF-PMT-TOL
 11250                                    PI-MAX-LF-PMT-TOL.
 11251
 11252     IF CF-PROC-MAX-EXP-PMT NOT NUMERIC
 11253         MOVE ZEROS              TO CF-PROC-MAX-EXP-PMT.
 11254
 11255     MOVE CF-PROC-MAX-EXP-PMT    TO WS-MAX-EXP-PMT
 11256                                    PI-MAX-EXP-PMT.
 11257
 11258 1240-FIND-ACCT-TOLERANCES.
 11259
 11260     IF WS-PMT-TOL NOT = +0
 11261         MOVE 'Y'                TO FOUND-TOL-SW.
 11262
 11263     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11264         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11265         MOVE CL-CURRENT-CARRIER     TO ACCT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 214
* EL156.cbl
 11266         MOVE CL-CURRENT-GROUPING    TO ACCT-GROUPING
 11267         MOVE CL-CURRENT-STATE       TO ACCT-STATE
 11268         MOVE CL-CURRENT-ACCOUNT     TO ACCT-ACCOUNT
 11269         MOVE CL-CERT-EFF-DT         TO ACCT-EXP-DT
 11270     ELSE
 11271         MOVE PI-COMPANY-CD          TO ACCT-COMP-CD
 11272         MOVE PI-CARRIER             TO ACCT-CARRIER
 11273         MOVE PI-GROUPING            TO ACCT-GROUPING
 11274         MOVE PI-STATE               TO ACCT-STATE
 11275         MOVE PI-ACCOUNT             TO ACCT-ACCOUNT
 11276         MOVE PI-CERT-EFF-DT         TO ACCT-EXP-DT.
 11277
 11278     MOVE 'ACCT'                 TO FILE-SWITCH.
 11279
 11280     MOVE ERACCT-PARTIAL-KEY     TO WS-ERACCT-SAVE-KEY.
 11281     MOVE SPACES                 TO WS-ERACCT-HOLD-RECORD.
 11282
 11283
 11284* EXEC CICS HANDLE CONDITION
 11285*         NOTFND   (1950-NOT-FOUND)
 11286*         ENDFILE  (1950-NOT-FOUND)
 11287*    END-EXEC.
 11288*    MOVE '"$I''                  ! + #00010800' TO DFHEIV0
 11289     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 11290     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11291     MOVE X'2B20233030303130383030' TO DFHEIV0(25:11)
 11292     CALL 'kxdfhei1' USING DFHEIV0
 11293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11294
 11295
 11296
 11297* EXEC CICS STARTBR
 11298*        DATASET('ERACCT')
 11299*        RIDFLD (ERACCT-KEY)
 11300*        GTEQ
 11301*    END-EXEC.
 11302     MOVE 'ERACCT' TO DFHEIV1
 11303     MOVE 0
 11304       TO DFHEIV11
 11305*    MOVE '&,         G          &   #00010805' TO DFHEIV0
 11306     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11307     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11308     MOVE X'2020233030303130383035' TO DFHEIV0(25:11)
 11309     CALL 'kxdfhei1' USING DFHEIV0,
 11310           DFHEIV1,
 11311           ERACCT-KEY,
 11312           DFHEIV99,
 11313           DFHEIV11,
 11314           DFHEIV99
 11315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11316
 11317
 11318 1245-FIND-ACCT-TOLERANCES-LOOP.
 11319
 11320
 11321* EXEC CICS READNEXT
 11322*        DATASET('ERACCT')
 11323*        SET    (ADDRESS OF ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 215
* EL156.cbl
 11324*        RIDFLD (ERACCT-KEY)
 11325*    END-EXEC.
 11326     MOVE 'ERACCT' TO DFHEIV1
 11327     MOVE 0
 11328       TO DFHEIV11
 11329*    MOVE '&.S                   )   #00010813' TO DFHEIV0
 11330     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11331     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11332     MOVE X'2020233030303130383133' TO DFHEIV0(25:11)
 11333     CALL 'kxdfhei1' USING DFHEIV0,
 11334           DFHEIV1,
 11335           DFHEIV20,
 11336           DFHEIV99,
 11337           ERACCT-KEY,
 11338           DFHEIV99,
 11339           DFHEIV11,
 11340           DFHEIV99,
 11341           DFHEIV99
 11342     SET ADDRESS OF ACCOUNT-MASTER TO
 11343         DFHEIV20
 11344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11345
 11346
 11347     IF WS-ERACCT-SAVE-KEY NOT = ERACCT-PARTIAL-KEY
 11348        IF WS-ERACCT-HOLD-RECORD = SPACES
 11349           GO TO 1950-NOT-FOUND
 11350        ELSE
 11351           MOVE WS-ERACCT-HOLD-RECORD TO ACCOUNT-MASTER
 11352           GO TO 1250-CONTINUE.
 11353
 11354     IF ACCT-EXP-DT = HIGH-VALUES
 11355        NEXT SENTENCE
 11356     ELSE
 11357        MOVE ACCOUNT-MASTER TO WS-ERACCT-HOLD-RECORD
 11358        GO TO 1245-FIND-ACCT-TOLERANCES-LOOP.
 11359
 11360 1250-CONTINUE.
 11361
 11362     MOVE AM-CONTROL-PRIMARY     TO PI-ACCT-KEY.
 11363
 11364     IF FOUND-TOL-SW = 'N'
 11365         MOVE AM-TOL-CLM         TO WS-PMT-TOL.
 11366
 11367********* 1260-FIND-STATE-TOLERANCES.
 11368
 11369     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11370     MOVE PI-STATE               TO WS-ST-ACCESS.
 11371     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 11372     MOVE '3'                    TO CNTL-REC-TYPE.
 11373     MOVE +0                     TO CNTL-SEQ-NO.
 11374     MOVE 'STAT'                 TO FILE-SWITCH.
 11375
 11376     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11377
 11378     IF WS-PMT-TOL = +0
 11379         MOVE CF-ST-TOL-CLAIM    TO WS-PMT-TOL.
 11380
 11381     MOVE CF-ST-CLAIM-REJECT-SW  TO WS-TOL-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 216
* EL156.cbl
 11382     MOVE CF-ST-SPLIT-PAYMENT    TO PI-SPLIT-PMT-SW.
 11383     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 11384     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 11385     MOVE CF-ST-VFY-2ND-BENE     TO PI-VFY-2ND-BENE.
 11386
 11387****FOR ANY PAYMENT NOT MADE TO BENEFICIARY, CHECK FOR VERIFY IND
 11388****AND FOR LIFE PAYMENTS CHECK PAYEE NAME NOT EQUAL TO DECEASED
 11389     IF PI-PAYEE-TYPE <> 'B'
 11390           PERFORM 3600-CHECK-VERIFICATION THRU 3600-EXIT
 11391     END-IF.
 11392
 11393     IF PI-PMTTYPE      = '2'  AND
 11394        PI-SPLIT-PMT-SW = 'Y'  AND
 11395        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 11396          MOVE ER-3530                TO EMI-ERROR
 11397          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11398
 11399********* 1280-FIND-BENEFIT-TOLERANCES.
 11400
 11401     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 11402        OR (PI-PMTTYPE = '5' OR '6')
 11403         GO TO 1300-FIND-CARR-TOLERANCES.
 11404
 11405     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11406     MOVE '4'                    TO CNTL-REC-TYPE.
 11407     MOVE +0                     TO CNTL-SEQ-NO.
 11408     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 11409     MOVE WS-ACCESS              TO CNTL-ACCESS.
 11410     MOVE 'BENE'                 TO FILE-SWITCH.
 11411
 11412     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 11413
 11414     IF NO-BENEFIT-FOUND
 11415         GO TO 1950-NOT-FOUND.
 11416
 11417     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 11418     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 11419     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 11420
 11421
 11422* EXEC CICS HANDLE CONDITION
 11423*        NOTFND(1950-NOT-FOUND)
 11424*    END-EXEC.
 11425*    MOVE '"$I                   ! , #00010893' TO DFHEIV0
 11426     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11427     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11428     MOVE X'2C20233030303130383933' TO DFHEIV0(25:11)
 11429     CALL 'kxdfhei1' USING DFHEIV0
 11430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11431
 11432
 11433 1300-FIND-CARR-TOLERANCES.
 11434     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11435     MOVE '6'                    TO CNTL-REC-TYPE.
 11436
 11437     IF CONTROL-IS-ACTUAL-CARRIER
 11438         MOVE PI-CARRIER               TO WS-CARR
 11439     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 217
* EL156.cbl
 11440         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 11441
 11442     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 11443     MOVE +0                     TO CNTL-SEQ-NO.
 11444     MOVE 'CARR'                 TO FILE-SWITCH.
 11445
 11446     PERFORM 7930-READ-CONTROL   THRU 7930-EXIT.
 11447
 11448     IF WS-DAYS-TOL = +0
 11449         MOVE CF-CALC-DAYS-TOL   TO WS-DAYS-TOL.
 11450
 11451     IF WS-PMT-TOL = +0
 11452         MOVE CF-CALC-AMT-TOL    TO WS-PMT-TOL.
 11453
 11454     IF WS-MAX-DAYS-TOL = +0
 11455         MOVE CF-MAX-REG-DAYS    TO WS-MAX-DAYS-TOL.
 11456
 11457     IF WS-MAX-PMT-TOL = +0
 11458         MOVE CF-MAX-REG-PMT     TO WS-MAX-PMT-TOL
 11459                                    PI-MAX-PMT-TOL.
 11460
 11461     IF WS-MAX-LF-PMT-TOL = +0
 11462        MOVE CF-MAX-REG-PMT      TO WS-MAX-LF-PMT-TOL
 11463                                    PI-MAX-LF-PMT-TOL.
 11464
 11465     MOVE CF-CLAIM-CALC-METHOD   TO WS-CALC-METHOD.
 11466
 11467********* 1320-FIND-COMP-TOLERANCES.
 11468
 11469     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 11470     MOVE '1'                    TO CNTL-REC-TYPE.
 11471     MOVE SPACES                 TO CNTL-ACCESS.
 11472     MOVE +0                     TO CNTL-SEQ-NO.
 11473     MOVE 'COMP'                 TO FILE-SWITCH.
 11474
 11475     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 11476
 11477     MOVE CF-CURRENT-MONTH-END   TO PI-MONTH-END-SAVE.
 11478     MOVE CF-PAYMENT-APPROVAL-SW TO PI-PMT-APPR-SW.
 11479
 11480     IF WS-PMT-TOL NOT = +0
 11481        IF WS-TOL-SEVERITY NOT = ' '
 11482         GO TO 1360-EDIT-DAYS.
 11483
 11484     IF WS-PMT-TOL = +0
 11485         MOVE CF-CO-TOL-CLAIM    TO WS-PMT-TOL.
 11486
 11487     IF WS-TOL-SEVERITY = ' '
 11488         MOVE CF-CO-CLAIM-REJECT-SW TO WS-TOL-SEVERITY.
 11489
 11490 1360-EDIT-DAYS.
 11491     IF PI-PMTTYPE NOT = '4'
 11492        IF PI-EDAYS NEGATIVE OR
 11493           PI-EPYAMT NEGATIVE
 11494          MOVE ER-0513             TO EMI-ERROR
 11495          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11496          MOVE -1                  TO PMTTYPEL.
 11497
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 218
* EL156.cbl
 11498     IF PI-PMTTYPE = '5' OR '6'
 11499        GO TO 1380-EDIT-EXPENSE-PMT-AMT.
 11500
 11501     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11502        IF PI-PMTTYPE = '4'
 11503          MOVE PI-EDAYS          TO PI-CDAYS.
 11504
 11505     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 11506         GO TO 1440-COMPUTE-LIFE-REMAINING.
 11507
 11508     IF PI-PMTTYPE = '4'
 11509        MOVE PI-EDAYS            TO PI-CDAYS
 11510        GO TO 1400-EDIT-PAYMENT.
 11511
 11512     IF LOW-VALUES = PI-CPYFROM OR PI-CPYTHRU
 11513        GO TO 1500-EDIT-EXPENSES.
 11514
 11515*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11516*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1 AND
 11517*          CM-AH-BENEFIT-CD = '23'              AND
 11518*          CL-CERT-STATE    = '04'              AND
 11519*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11520*            PERFORM 3200-CALC-AIG-DAYS THRU 3299-EXIT
 11521*            GO TO 1362-CHECK-MAX-DAYS.
 11522
 11523     IF PI-EDAYS = ZEROS
 11524*        IF PI-COMPANY-ID = 'DMD'
 11525*            MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 11526*            MOVE -1             TO DC-ELAPSED-DAYS
 11527*            MOVE ZEROS          TO DC-ELAPSED-MONTHS
 11528*            MOVE '6'            TO DC-OPTION-CODE
 11529*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11530*            MOVE DC-BIN-DATE-2  TO DC-BIN-DATE-1
 11531*            MOVE WS-SV-EPYTHRU  TO DC-BIN-DATE-2
 11532*            MOVE '1'            TO DC-OPTION-CODE
 11533*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11534*            IF NO-CONVERSION-ERROR
 11535*                COMPUTE PI-EDAYS = DC-ELAPSED-MONTHS * 30
 11536*                                 + DC-ODD-DAYS-OVER
 11537*               MOVE 6           TO EDAYSL
 11538*               MOVE AL-UNNON    TO EDAYSA
 11539*            ELSE
 11540*                NEXT SENTENCE
 11541*       ELSE
 11542            MOVE WS-SV-EPYFROM   TO DC-BIN-DATE-1
 11543            MOVE WS-SV-EPYTHRU   TO DC-BIN-DATE-2
 11544            MOVE '1'             TO DC-OPTION-CODE
 11545            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11546            IF NO-CONVERSION-ERROR
 11547                MOVE DC-ELAPSED-DAYS  TO PI-EDAYS
 11548                ADD 1                 TO PI-EDAYS
 11549                MOVE AL-UNNON         TO EDAYSA.
 11550
 11551*    IF PI-COMPANY-ID = 'DMD'
 11552*        MOVE PI-CPYFROM         TO DC-BIN-DATE-1
 11553*        MOVE -1                 TO DC-ELAPSED-DAYS
 11554*        MOVE ZEROS              TO DC-ELAPSED-MONTHS
 11555*        MOVE '6'                TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 219
* EL156.cbl
 11556*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11557*        MOVE DC-BIN-DATE-2      TO DC-BIN-DATE-1
 11558*        MOVE PI-CPYTHRU         TO DC-BIN-DATE-2
 11559*        MOVE '1'                TO DC-OPTION-CODE
 11560*        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11561*    ELSE
 11562         MOVE PI-CPYFROM         TO DC-BIN-DATE-1.
 11563         MOVE PI-CPYTHRU         TO DC-BIN-DATE-2.
 11564         MOVE '1'                TO DC-OPTION-CODE.
 11565         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11566
 11567     IF NO-CONVERSION-ERROR
 11568        IF PI-COMPANY-ID = 'DMD'
 11569            COMPUTE PI-CDAYS = DC-ELAPSED-MONTHS * 30
 11570                             + DC-ODD-DAYS-OVER
 11571        ELSE
 11572            MOVE DC-ELAPSED-DAYS TO PI-CDAYS
 11573            ADD 1                TO PI-CDAYS.
 11574
 11575     IF DC-ODD-DAYS-OVER NOT = ZEROS
 11576        MOVE DC-ELAPSED-MONTHS   TO EXPENSE-MONTH-SAVE
 11577        ADD 1                    TO EXPENSE-MONTH-SAVE.
 11578
 11579     IF PI-EDAYS NOT NUMERIC
 11580         MOVE ER-0491            TO EMI-ERROR
 11581         GO TO 1370-DAYS-ERROR.
 11582
 11583     IF CL-NO-OF-PMTS-MADE = 0
 11584        AND (PI-COMPANY-ID = 'CID' OR 'AHL')
 11585        AND CL-CERT-STATE = 'MI'
 11586        AND (CM-AH-BENEFIT-CD = '20' OR '21' OR '22' OR '23')
 11587            PERFORM 1390-CHECK-PAYMENT-DAYS THRU 1390-EXIT
 11588     END-IF.
 11589
 11590 1362-CHECK-MAX-DAYS.
 11591
 11592     IF WS-MAX-DAYS-TOL = +999
 11593         GO TO 1365-SKIP-MAX-DAYS-EDIT.
 11594
 11595     IF PI-COMPANY-ID = 'HER' OR 'KSM'
 11596         IF PI-EDAYS = ZEROS
 11597             COMPUTE WS-PMT-MOS ROUNDED = (PI-CDAYS / +30) + .005
 11598         ELSE
 11599             COMPUTE WS-PMT-MOS ROUNDED = (PI-EDAYS / +30) + .005.
 11600
 11601     IF WS-MAX-DAYS-TOL NOT = ZERO
 11602        IF PI-EDAYS > WS-MAX-DAYS-TOL OR
 11603           PI-CDAYS > WS-MAX-DAYS-TOL
 11604             MOVE ER-0492          TO EMI-ERROR
 11605             GO TO 1370-DAYS-ERROR.
 11606
 11607 1365-SKIP-MAX-DAYS-EDIT.
 11608     IF PI-EDAYS = ZEROS
 11609        GO TO 1400-EDIT-PAYMENT.
 11610
 11611     IF WS-DAYS-TOL NOT = ZERO
 11612        IF ((PI-CDAYS - WS-DAYS-TOL) > PI-EDAYS) OR
 11613           ((PI-CDAYS + WS-DAYS-TOL) < PI-EDAYS)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 220
* EL156.cbl
 11614                MOVE ER-0493     TO EMI-ERROR
 11615                GO TO 1370-DAYS-ERROR.
 11616
 11617     GO TO 1400-EDIT-PAYMENT.
 11618
 11619 1370-DAYS-ERROR.
 11620     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11621
 11622     IF EMI-MESSAGE-FORMATTED
 11623         MOVE -1                 TO EDAYSL
 11624         MOVE AL-UABON           TO EDAYSA.
 11625
 11626     GO TO 1400-EDIT-PAYMENT.
 11627
 11628 1380-EDIT-EXPENSE-PMT-AMT.
 11629     IF PI-PMTTYPE = '5' OR '6'
 11630         NEXT SENTENCE
 11631     ELSE
 11632         GO TO 1400-EDIT-PAYMENT.
 11633
 11634     IF WS-MAX-EXP-PMT NOT = ZEROS
 11635        IF PI-EPYAMT > WS-MAX-EXP-PMT
 11636            MOVE ER-3529            TO EMI-ERROR
 11637            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 11638
 11639     GO TO 1500-EDIT-EXPENSES.
 11640
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 221
* EL156.cbl
 11642
 11643 1390-CHECK-PAYMENT-DAYS.
 11644
 11645     IF PI-EDAYS = 0
 11646         MOVE PI-CDAYS TO WS-PD-DAYS
 11647     ELSE
 11648         MOVE PI-EDAYS TO WS-PD-DAYS
 11649     END-IF.
 11650
 11651     IF CM-AH-BENEFIT-CD = '20' OR '21'
 11652         IF WS-PD-DAYS = 14
 11653            GO TO 1390-EXIT
 11654         END-IF
 11655     END-IF.
 11656
 11657     IF PI-COMPANY-ID = 'AHL'  AND
 11658        CM-AH-BENEFIT-CD = '1K'
 11659         IF WS-PD-DAYS = 14
 11660            GO TO 1390-EXIT
 11661         END-IF
 11662     END-IF.
 11663
 11664     IF WS-PD-DAYS < 30
 11665         MOVE ER-3549              TO EMI-ERROR
 11666         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 11667     END-IF.
 11668
 11669 1390-EXIT.
 11670      EXIT.
 11671
 11672 1400-EDIT-PAYMENT.
 11673*    IF PI-COMPANY-ID = 'DMD'
 11674*       IF CL-CERT-NO (5:2) = '69' OR '70'
 11675*           PERFORM 6500-READ-DLO035 THRU 6500-EXIT.
 11676
 11677     IF PI-COMPANY-ID = 'DCC'
 11678        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 11679        MOVE PI-CARRIER          TO ACCT-CARRIER
 11680        MOVE PI-GROUPING         TO ACCT-GROUPING
 11681        MOVE PI-STATE            TO ACCT-STATE
 11682        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 11683        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 11684        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 11685        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 11686
 11687
 11688* EXEC CICS READ
 11689*          DATASET ('ERACCT')
 11690*          RIDFLD  (ERACCT-KEY)
 11691*          SET     (ADDRESS OF ACCOUNT-MASTER)
 11692*          GTEQ
 11693*          resp    (WS-RESPONSE)
 11694*       END-EXEC
 11695     MOVE 'ERACCT' TO DFHEIV1
 11696*    MOVE '&"S        G          (  N#00011151' TO DFHEIV0
 11697     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 11698     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11699     MOVE X'204E233030303131313531' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 222
* EL156.cbl
 11700     CALL 'kxdfhei1' USING DFHEIV0,
 11701           DFHEIV1,
 11702           DFHEIV20,
 11703           DFHEIV99,
 11704           ERACCT-KEY,
 11705           DFHEIV99,
 11706           DFHEIV99,
 11707           DFHEIV99
 11708     SET ADDRESS OF ACCOUNT-MASTER TO
 11709         DFHEIV20
 11710     MOVE EIBRESP  TO WS-RESPONSE
 11711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11712        IF WS-RESP-NORMAL
 11713           AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 11714           and pi-cert-eff-dt < am-expiration-dt
 11715           and pi-cert-eff-dt >= am-effective-dt
 11716           move am-dcc-product-code to pi-dcc-product-code
 11717        else
 11718           move spaces           to pi-dcc-product-code
 11719        end-if
 11720        if PI-DCC-PRODUCT-CODE NOT = SPACES
 11721           PERFORM 0900-GET-DDF-LIMITS
 11722                                 THRU 0900-EXIT
 11723           IF PDEF-FOUND
 11724              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 11725                 (P1 > +8)
 11726                 OR (PD-PROD-CODE (P1) = CL-CLAIM-TYPE)
 11727              END-PERFORM
 11728              IF P1 < +9
 11729                 if pd-ben-pct (p1) not numeric
 11730                    move zeros   to pd-ben-pct (p1)
 11731                 end-if
 11732                 if pd-ben-pct (p1) = zeros
 11733                    move +1      to ws-work-ben-pct
 11734                 else
 11735                    move pd-ben-pct (p1)
 11736                                 to ws-work-ben-pct
 11737                 end-if
 11738                 compute cm-ah-benefit-amt =
 11739                    cm-ah-benefit-amt * ws-work-ben-pct
 11740                 if cm-ah-benefit-amt > pd-max-amt (p1)
 11741                    move pd-max-amt (p1) to cm-ah-benefit-amt
 11742                 end-if
 11743              else
 11744                 move er-1674    to emi-error
 11745                 PERFORM 9900-ERROR-FORMAT
 11746                                 THRU 9900-EXIT
 11747              END-IF
 11748           else
 11749              move er-1672       to emi-error
 11750              PERFORM 9900-ERROR-FORMAT
 11751                                 THRU 9900-EXIT
 11752           END-IF
 11753        end-if
 11754     END-IF
 11755     IF PI-PMTTYPE NOT = '4'
 11756        GO TO 1405-CALC-PAYMENT.
 11757
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 223
* EL156.cbl
 11758     IF PI-EDAYS NOT NUMERIC
 11759         MOVE PI-EPYAMT           TO PI-CPYAMT
 11760         MOVE SPACES              TO PI-SPECIAL-BEN-SW
 11761         GO TO 1430-CHECK-AH-TOLERANCE.
 11762
 11763*    IF PI-COMPANY-ID = 'FIA'
 11764*       IF CERT-ACCOUNT = '0000011043'
 11765*        COMPUTE PI-DAILY-RATE ROUNDED =
 11766*                      (CM-AH-BENEFIT-AMT * 13) / 365
 11767*        COMPUTE PI-CPYAMT ROUNDED =
 11768*                          PI-DAILY-RATE * PI-EDAYS
 11769*        MOVE SPACES TO PI-SPECIAL-BEN-SW
 11770*        GO TO 1430-CHECK-AH-TOLERANCE.
 11771
 11772     IF WS-CALC-METHOD = '1' OR '4' OR '6'
 11773         COMPUTE PI-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11774         COMPUTE PI-CPYAMT     ROUNDED = PI-DAILY-RATE * PI-EDAYS
 11775         GO TO 1420-CHECK-AIG-BENEFIT.
 11776
 11777     IF WS-CALC-METHOD = '2' OR  '5'
 11778         COMPUTE PI-DAILY-RATE ROUNDED =
 11779                        (CM-AH-BENEFIT-AMT * 12) / 365
 11780         COMPUTE PI-CPYAMT ROUNDED =
 11781                           PI-DAILY-RATE * PI-EDAYS
 11782        GO TO 1420-CHECK-AIG-BENEFIT.
 11783
 11784     IF WS-CALC-METHOD = '3'
 11785         COMPUTE PI-DAILY-RATE =
 11786                         (CM-AH-BENEFIT-AMT * 12) / 365
 11787         COMPUTE PI-CPYAMT ROUNDED =
 11788                           PI-DAILY-RATE * PI-EDAYS
 11789        GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 224
* EL156.cbl
 11791*    SAMPLE DATE RANGES AND DAYS PAID FOR OPTION 1 AND 6
 11792
 11793****************************************************************
 11794****************************************************************
 11795*                  CALCULATED FROM      PAYMENT      PAYMENT
 11796*   DATES           DATE ROUTINE        OPT  1       OPT  6
 11797* FROM    THRU    MONTHS ODD ELAPSED   DAYS-PAID    DAYS-PAID
 11798*1-01-83  1-15-83    0    15     15        15           15
 11799*1-01-83  1-30-83    0    30     30        30           30
 11800*1-01-83  1-31-83    1     0     31        30           30
 11801*1-01-83  2-01-83    1     1     32        31           31
 11802*1-01-83  2-15-83    1    15     46        45           45
 11803*1-01-83  2-28-83    2     0     59        60           60
 11804*1-01-83  3-01-83    2     1     60        61           61
 11805*1-01-83  3-31-83    3     0     90        90           90
 11806*1-15-83  1-31-83    0    17     17        17           16
 11807*1-15-83  2-01-83    0    18     18        18           17
 11808*1-15-83  2-28-83    1    14     45        44           46
 11809*1-21-83  3-09-83    1    20     48        50           49
 11810*2-05-83  3-06-83    1     2     30        32           32
 11811*2-05-83  3-23-83    1    19     47        49           49
 11812*2-15-83  2-28-83    0    14     14        14           16
 11813*2-15-83  3-01-83    0    15     15        15           17
 11814*2-21-83  3-19-83    0    27     27        27           29
 11815*2-21-83  3-20-83    1     0     28        30           30
 11816*2-21-83  4-10-83    1    18     49        30           50
 11817*2-21-83  5-19-83    2    27     88        87           89
 11818*2-21-83  5-22-83    3     2     91        92           92
 11819*3-21-83  5-19-83    1    30     60        60           59
 11820****************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 225
* EL156.cbl
 11822 1405-CALC-PAYMENT.
 11823     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11824     MOVE ' '                    TO DC-OPTION-CODE.
 11825     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11826     MOVE DC-DAYS-IN-MONTH       TO FROM-DAYS-IN-MONTH.
 11827     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-FROM.
 11828
 11829     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 11830     MOVE ' '                    TO DC-OPTION-CODE.
 11831     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11832     MOVE DC-GREG-DATE-1-MDY     TO WORK-DATE-THRU.
 11833     MOVE DC-DAYS-IN-MONTH       TO THRU-DAYS-IN-MONTH.
 11834
 11835     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 11836     MOVE -1                     TO DC-ELAPSED-DAYS.
 11837     MOVE ZEROS                  TO DC-ELAPSED-MONTHS.
 11838     MOVE '6'                    TO DC-OPTION-CODE.
 11839     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11840     MOVE DC-DAYS-IN-MONTH       TO SAVE1-FROM-DAYS-IN-MONTH.
 11841
 11842     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 11843     MOVE PI-CPYTHRU             TO DC-BIN-DATE-2.
 11844     MOVE '1'                    TO DC-OPTION-CODE.
 11845     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 11846
 11847     MOVE DC-ELAPSED-MONTHS      TO SAVE-ELAPSED-MONTHS.
 11848     MOVE DC-ODD-DAYS-OVER       TO SAVE-ODD-DAYS-OVER.
 11849     MOVE DC-ELAPSED-DAYS        TO SAVE-ELAPSED-DAYS.
 11850
 11851******************************************************************
 11852*   THE FOLLOWING STATEMENT ADJUSTS THE ODD DAYS OVER BY THE     *
 11853*     DIFFERENCE BETWEEN DAYS IN MONTH (FROM MONTH) AND          *
 11854*     DAYS IN MONTH (ONE MONTH PRIOR TO THRU MONTH)              *
 11855******************************************************************
 11856
 11857     IF WS-CALC-METHOD = '1'           AND
 11858        DC-ELAPSED-MONTHS > ZERO AND
 11859        DC-ODD-DAYS-OVER NOT = ZEROS   AND
 11860        WDF-DAY > WDT-DAY
 11861          MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 11862          MOVE ZEROS               TO DC-ELAPSED-DAYS
 11863          MOVE -1                  TO DC-ELAPSED-MONTHS
 11864          MOVE '6'                 TO DC-OPTION-CODE
 11865          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11866          MOVE DC-DAYS-IN-MONTH    TO SAVE1-THRU-DAYS-IN-MONTH
 11867          COMPUTE WS-SAVE-ODD-DAYS =
 11868          (SAVE1-THRU-DAYS-IN-MONTH - SAVE1-FROM-DAYS-IN-MONTH)
 11869          ADD WS-SAVE-ODD-DAYS     TO SAVE-ODD-DAYS-OVER.
 11870
 11871     MOVE SAVE-ELAPSED-MONTHS    TO DC-ELAPSED-MONTHS.
 11872     MOVE SAVE-ODD-DAYS-OVER     TO DC-ODD-DAYS-OVER
 11873     MOVE SAVE-ELAPSED-DAYS      TO DC-ELAPSED-DAYS.
 11874
 11875     MOVE SAVE-ELAPSED-MONTHS TO PI-SAVE-ELAPSED-MONTHS.
 11876     MOVE SAVE-ODD-DAYS-OVER  TO PI-SAVE-ODD-DAYS-OVER.
 11877
 11878*    IF PI-COMPANY-ID = 'FIA'
 11879*       IF CERT-ACCOUNT = '0000011043'
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 226
* EL156.cbl
 11880*        COMPUTE PI-DAILY-RATE ROUNDED =
 11881*                          (CM-AH-BENEFIT-AMT * 13) / 365
 11882*        COMPUTE PI-CPYAMT ROUNDED =
 11883*                          PI-DAILY-RATE * DC-ELAPSED-DAYS
 11884*        GO TO 1420-CHECK-AIG-BENEFIT.
 11885
 11886*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 11887*       IF CL-CLAIM-TYPE    = PI-AH-OVERRIDE-L1  AND
 11888*          CM-AH-BENEFIT-CD = '23'               AND
 11889*          CL-CERT-STATE    = '04'               AND
 11890*         (PI-PMTTYPE = '1' OR '2' OR '3')
 11891*            COMPUTE WS-DAILY-RATE ROUNDED =
 11892*                               CM-AH-BENEFIT-AMT / 30
 11893*            COMPUTE PI-CPYAMT ROUNDED =
 11894*                               (WS-DAILY-RATE * PI-CDAYS)
 11895*            MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11896*            GO TO 1420-CHECK-AIG-BENEFIT.
 11897
 11898     IF WS-CALC-METHOD = '1'
 11899         COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30
 11900         COMPUTE PI-CPYAMT ROUNDED =
 11901             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11902             (WS-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11903         MOVE WS-DAILY-RATE    TO PI-DAILY-RATE
 11904         GO TO 1420-CHECK-AIG-BENEFIT.
 11905
 11906     IF WS-CALC-METHOD = '2'
 11907         COMPUTE PI-DAILY-RATE ROUNDED =
 11908                          (CM-AH-BENEFIT-AMT * 12) / 365
 11909         COMPUTE PI-CPYAMT ROUNDED =
 11910             (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS) +
 11911             (PI-DAILY-RATE     * DC-ODD-DAYS-OVER)
 11912         GO TO 1420-CHECK-AIG-BENEFIT.
 11913
 11914     IF WS-CALC-METHOD = '4'
 11915         MOVE CM-AH-BENEFIT-AMT   TO  WS-AH-BEN-AMT
 11916         COMPUTE WS-DAILY-RATE ROUNDED = (WS-AH-BEN-AMT / 30)
 11917         MOVE WS-DAILY-RATE TO PI-DAILY-RATE
 11918         COMPUTE PI-CPYAMT ROUNDED =
 11919                           WS-DAILY-RATE * DC-ELAPSED-DAYS
 11920         GO TO 1420-CHECK-AIG-BENEFIT.
 11921
 11922     IF WS-CALC-METHOD = '5'
 11923         COMPUTE PI-DAILY-RATE ROUNDED =
 11924                            (CM-AH-BENEFIT-AMT * 12) / 365
 11925         COMPUTE PI-CPYAMT ROUNDED =
 11926                           PI-DAILY-RATE * DC-ELAPSED-DAYS
 11927         GO TO 1420-CHECK-AIG-BENEFIT.
 11928
 11929     IF WS-CALC-METHOD NOT = '3'
 11930        GO TO 1410-CHECK-PAYMENT.
 11931
 11932******   CALCULATION METHOD  3  ROUTINE
 11933     COMPUTE PI-DAILY-RATE =
 11934                 CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH.
 11935
 11936******CHECK TO SEE IF WITHIN SAME MONTH
 11937     IF (WDF-MONTH = WDT-MONTH) AND (WDF-YEAR = WDT-YEAR)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 227
* EL156.cbl
 11938        COMPUTE PI-CPYAMT ROUNDED = SAVE-ELAPSED-DAYS    *
 11939                     (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)
 11940         GO TO 1420-CHECK-AIG-BENEFIT.
 11941
 11942******CHECK TO SEE IF EVEN MONTHS AND NO ODD DAYS
 11943     IF SAVE-ELAPSED-MONTHS NOT = ZEROS   AND
 11944             SAVE-ODD-DAYS-OVER = ZEROS
 11945      COMPUTE PI-CPYAMT  ROUNDED =
 11946                  CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS
 11947      GO TO 1420-CHECK-AIG-BENEFIT.
 11948
 11949******BUMP THE FROM DATE WITH THE NUMBER OF MONTHS
 11950******AND FIND THE NUMBER OF DAYS LEFT IN THIS MONTH.
 11951     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11952        ADD SAVE-ELAPSED-MONTHS  TO WDF-MONTH
 11953        IF WDF-MONTH > 12
 11954           ADD 1                 TO WDF-YEAR
 11955           SUBTRACT 12         FROM WDF-MONTH.
 11956
 11957******CONVERT THE NEW FROM MONTH TO BINARY
 11958     IF SAVE-ELAPSED-MONTHS NOT = ZERO
 11959        MOVE WORK-DATE-FROM   TO DC-GREG-DATE-1-MDY
 11960        MOVE '4'              TO DC-OPTION-CODE
 11961        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 11962        MOVE DC-DAYS-IN-MONTH TO FROM-DAYS-IN-MONTH.
 11963
 11964     IF WDF-MONTH = WDT-MONTH AND
 11965        WDF-YEAR  = WDT-YEAR
 11966          COMPUTE PI-CPYAMT ROUNDED = ((WDT-DAY  -  WDF-DAY)  *
 11967                    (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH)) +
 11968                    (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS)
 11969        ELSE
 11970          COMPUTE FROM-PMT-DAYS = FROM-DAYS-IN-MONTH - WDF-DAY
 11971          MOVE WDT-DAY              TO THRU-PMT-DAYS
 11972          COMPUTE PI-CPYAMT ROUNDED =
 11973       (FROM-PMT-DAYS * (CM-AH-BENEFIT-AMT / FROM-DAYS-IN-MONTH))
 11974       +
 11975       (THRU-PMT-DAYS * (CM-AH-BENEFIT-AMT / THRU-DAYS-IN-MONTH))
 11976       +
 11977       (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS).
 11978
 11979     GO TO 1420-CHECK-AIG-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 228
* EL156.cbl
 11981 1410-CHECK-PAYMENT.
 11982******PAYMENT OPTION 6
 11983******CHECK TO SEE IF LESS THAN 1 MONTH AND WITHIN SAME MONTH
 11984     IF SAVE-ELAPSED-MONTHS > ZERO
 11985        IF SAVE-ODD-DAYS-OVER = ZEROS
 11986           GO TO 1412-CHECK-TO-DAY
 11987        ELSE
 11988           IF WDF-DAY > WDT-DAY
 11989              IF WDF-MONTH = 02
 11990                  PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 11991                  ADD 2  TO  SAVE-ODD-DAYS-OVER
 11992                  GO TO 1412-CHECK-TO-DAY
 11993              ELSE
 11994                  IF FROM-DAYS-IN-MONTH = 31
 11995                     SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER
 11996                     GO TO 1412-CHECK-TO-DAY
 11997                  ELSE
 11998                     GO TO 1412-CHECK-TO-DAY
 11999           ELSE
 12000               GO TO 1412-CHECK-TO-DAY.
 12001
 12002     IF WDF-MONTH NOT = WDT-MONTH
 12003        IF WDF-MONTH = 02
 12004           PERFORM 1415-CHECK-LEAP-YEAR THRU 1415-EXIT
 12005           IF WDF-DAY = 29
 12006              ADD 1              TO SAVE-ODD-DAYS-OVER
 12007           ELSE
 12008              ADD 2              TO SAVE-ODD-DAYS-OVER
 12009        ELSE
 12010           IF FROM-DAYS-IN-MONTH = 31
 12011              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12012
 12013 1412-CHECK-TO-DAY.
 12014        IF WDT-MONTH = 02 AND SAVE-ODD-DAYS-OVER NOT = 0
 12015           IF WDT-DAY = 28
 12016              ADD 2              TO SAVE-ODD-DAYS-OVER
 12017           ELSE
 12018              IF WDT-DAY = 29
 12019                 ADD 1           TO SAVE-ODD-DAYS-OVER
 12020              ELSE
 12021                 NEXT SENTENCE
 12022        ELSE
 12023           IF WDT-DAY = 31 AND SAVE-ODD-DAYS-OVER NOT = 0
 12024              SUBTRACT 1         FROM SAVE-ODD-DAYS-OVER.
 12025
 12026     COMPUTE WS-DAILY-RATE ROUNDED = CM-AH-BENEFIT-AMT / 30.
 12027     MOVE WS-DAILY-RATE          TO PI-DAILY-RATE.
 12028     COMPUTE PI-CPYAMT ROUNDED =
 12029         (CM-AH-BENEFIT-AMT * SAVE-ELAPSED-MONTHS) +
 12030         (WS-DAILY-RATE     * SAVE-ODD-DAYS-OVER).
 12031
 12032     GO TO 1420-CHECK-AIG-BENEFIT.
 12033
 12034 1415-CHECK-LEAP-YEAR.
 12035     IF FROM-DAYS-IN-MONTH = 29
 12036        SUBTRACT 1 FROM SAVE-ODD-DAYS-OVER.
 12037
 12038 1415-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 229
* EL156.cbl
 12039     EXIT.
 12040
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 230
* EL156.cbl
 12042 1420-CHECK-AIG-BENEFIT.
 12043
 12044     IF WS-SPECIAL-CALC-CD = 'Q'
 12045         GO TO 1425-CHECK-WHOLE-MONTH.
 12046
 12047*    IF (PI-COMPANY-ID = 'AIG' OR 'AUK')   AND
 12048*       (CM-AH-BENEFIT-CD = '63' OR '66')  AND
 12049*       (CL-NO-OF-PMTS-MADE < +6)          AND
 12050*       (PI-PMTTYPE = '1' OR '2')
 12051*        NEXT SENTENCE
 12052*    ELSE
 12053         MOVE SPACES TO PI-SPECIAL-BEN-SW.
 12054         GO TO 1430-CHECK-AH-TOLERANCE.
 12055
 12056******************AIG LOGIC STARTS**********************
 12057*    MOVE 'Y'          TO PI-SPECIAL-BEN-SW.
 12058*    COMPUTE PI-CPYAMT = PI-CPYAMT * 1.5.
 12059*    MOVE ER-3533      TO EMI-ERROR.
 12060*    PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12061*    GO TO 1430-CHECK-AH-TOLERANCE.
 12062******************AIG LOGIC ENDS************************
 12063
 12064 1425-CHECK-WHOLE-MONTH.
 12065******************************************************************
 12066****    THIS PARAGRAPH COMPUTES THE 1ST PAYMENT FOR WHOLE     ****
 12067****    MONTH DISABILITY CLAIMS.  THE PROCESS IS AS FOLLOWS:  ****
 12068****      1.  IF THE PERIOD BEING PAID IS THE RETRO PERIOD    ****
 12069****          A WHOLE MONTHS BENEFIT IS PAID.                 ****
 12070****      2.  IF MORE THAN THE RETRO PERIOD IS BEING PAID THE ****
 12071****          ADDITIONAL DAYS MUST BE IN WHOLE CALENDAR       ****
 12072****          MONTHS.  PAYMENT = 1 MONTH (RETRO               ****
 12073****          PERIOD) + NUMBER OF ADDITIONAL MONTHS BEING     ****
 12074****          PAID * MONTHLY BENEFIT.                         ****
 12075******************************************************************
 12076
 12077     MOVE SPACES                     TO  PI-SPECIAL-BEN-SW.
 12078
 12079     IF CL-NO-OF-PMTS-MADE > +0
 12080         GO TO 1425-CONT-WHOLE-MONTH-PMTS.
 12081
 12082     IF PI-CDAYS < WS-BEN-DAYS
 12083         GO TO 1430-CHECK-AH-TOLERANCE.
 12084
 12085     IF PI-CDAYS = WS-BEN-DAYS
 12086         MOVE CM-AH-BENEFIT-AMT      TO  PI-CPYAMT
 12087         GO TO 1430-CHECK-AH-TOLERANCE.
 12088
 12089*    IF PI-COMPANY-ID = 'ACM'
 12090*       NEXT SENTENCE
 12091*    ELSE
 12092        GO TO 1425-NOT-ACM-W15C.
 12093
 12094*    MOVE PI-CPYFROM             TO  DC-BIN-DATE-1.
 12095*    MOVE -1                     TO  DC-ELAPSED-DAYS.
 12096*    MOVE +0                     TO  DC-ELAPSED-MONTHS.
 12097*    MOVE '6'                    TO  DC-OPTION-CODE.
 12098*    PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12099*    IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 231
* EL156.cbl
 12100*       MOVE DC-BIN-DATE-2       TO  DC-BIN-DATE-1
 12101*       MOVE PI-CPYTHRU          TO  DC-BIN-DATE-2
 12102*       MOVE '1'                 TO  DC-OPTION-CODE
 12103*       MOVE +0                  TO  DC-ELAPSED-DAYS
 12104*       MOVE +0                  TO  DC-ELAPSED-MONTHS
 12105*       PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12106*       IF NO-CONVERSION-ERROR
 12107*          IF (DC-ELAPSED-MONTHS > +0) OR
 12108*             (DC-ELAPSED-DAYS NOT < WS-BEN-DAYS)
 12109*             NEXT SENTENCE
 12110*          ELSE
 12111*             MOVE +0            TO  PI-CPYAMT
 12112*             MOVE ER-0846       TO  EMI-ERROR
 12113*             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12114*             GO TO 1430-CHECK-AH-TOLERANCE
 12115*       ELSE
 12116*           MOVE ER-0846         TO  EMI-ERROR
 12117*           PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12118*           GO TO 1430-CHECK-AH-TOLERANCE.
 12119*
 12120*    IF DC-ODD-DAYS-OVER NOT < WS-BEN-DAYS
 12121*       ADD +1 TO DC-ELAPSED-MONTHS.
 12122*
 12123*    COMPUTE PI-CPYAMT ROUNDED =
 12124*                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12125*
 12126*    GO TO 1430-CHECK-AH-TOLERANCE.
 12127
 12128 1425-NOT-ACM-W15C.
 12129
 12130     MOVE PI-CPYFROM                 TO  DC-BIN-DATE-1.
 12131     MOVE '6'                        TO  DC-OPTION-CODE.
 12132     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12133     COMPUTE DC-ELAPSED-DAYS = WS-BEN-DAYS - 1.
 12134
 12135     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12136     IF NO-CONVERSION-ERROR
 12137         MOVE DC-BIN-DATE-2          TO  DC-BIN-DATE-1
 12138     ELSE
 12139         MOVE ER-0846                TO  EMI-ERROR
 12140         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12141         GO TO 1430-CHECK-AH-TOLERANCE.
 12142
 12143     MOVE PI-CPYTHRU                 TO  DC-BIN-DATE-2.
 12144     MOVE '1'                        TO  DC-OPTION-CODE.
 12145     MOVE +0                         TO  DC-ELAPSED-MONTHS.
 12146     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12147     IF NO-CONVERSION-ERROR
 12148         IF DC-ODD-DAYS-OVER = +0
 12149             NEXT SENTENCE
 12150         ELSE
 12151             MOVE ER-0846            TO  EMI-ERROR
 12152             PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12153             GO TO 1430-CHECK-AH-TOLERANCE
 12154     ELSE
 12155         MOVE ER-0846                TO  EMI-ERROR
 12156         PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12157         GO TO 1430-CHECK-AH-TOLERANCE.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 232
* EL156.cbl
 12158
 12159     COMPUTE PI-CPYAMT ROUNDED = CM-AH-BENEFIT-AMT +
 12160         (CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS).
 12161
 12162     GO TO 1430-CHECK-AH-TOLERANCE.
 12163
 12164 1425-CONT-WHOLE-MONTH-PMTS.
 12165******************************************************************
 12166****    WHOLE MONTH DISABILITY EDIT.  IN ORDER TO QUALIFY     ****
 12167****    FOR A PAYMENT TO BE MADE THE PAYMENT PERIOD MUST      ****
 12168****    BE IN CALENDAR MONTH INCREMENTS.                      ****
 12169******************************************************************
 12170
 12171     IF PI-COMPANY-ID = 'ACM'
 12172        NEXT SENTENCE
 12173     ELSE
 12174        IF DC-ODD-DAYS-OVER = +0
 12175            NEXT SENTENCE
 12176        ELSE
 12177            MOVE ER-0845            TO  EMI-ERROR
 12178            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12179            GO TO 1430-CHECK-AH-TOLERANCE.
 12180
 12181     COMPUTE PI-CPYAMT ROUNDED =
 12182                CM-AH-BENEFIT-AMT * DC-ELAPSED-MONTHS.
 12183
 12184 1430-CHECK-AH-TOLERANCE.
 12185     IF PI-PMT-APPR-SW = 'G'
 12186         GO TO 1430-CONT-CHECK-AH-TOLERANCE.
 12187
 12188*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12189*        COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL * WS-PMT-MOS
 12190*        MOVE WS-MAX-PMT-TOL         TO  PI-MAX-PMT-TOL.
 12191*
 12192*    IF PI-COMPANY-ID = 'HER' OR 'KSM'
 12193*      IF WDF-MONTH = 02
 12194*        IF SAVE-ELAPSED-MONTHS = 0
 12195*          NEXT SENTENCE
 12196*        ELSE
 12197*          IF SAVE-ODD-DAYS-OVER > 0
 12198*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12199*            COMPUTE WS-PMT-MOS ROUNDED =
 12200*                (SAVE-ODD-DAYS-OVER / +30) + .005
 12201*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12202*                                     WS-PMT-MOS
 12203*            COMPUTE WS-MAX-PMT-TOL = WS-MAX-PMT-TOL +
 12204*                (WS-HER-MO-PMT-AMT * SAVE-ELAPSED-MONTHS)
 12205*          ELSE
 12206*            MOVE +0                     TO  WS-MAX-PMT-TOL
 12207*            MOVE SAVE-ELAPSED-MONTHS    TO  WS-PMT-MOS
 12208*            COMPUTE WS-MAX-PMT-TOL = WS-HER-MO-PMT-AMT *
 12209*                                     WS-PMT-MOS.
 12210
 12211     IF WS-MAX-PMT-TOL NOT = ZERO
 12212        IF (PI-EPYAMT > WS-MAX-PMT-TOL) OR
 12213           (PI-CPYAMT > WS-MAX-PMT-TOL)
 12214            MOVE ER-0494         TO  EMI-ERROR
 12215            PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 233
* EL156.cbl
 12216            GO TO 1500-EDIT-EXPENSES.
 12217
 12218 1430-CONT-CHECK-AH-TOLERANCE.
 12219
 12220     IF PI-EPYAMT = ZEROS OR   PI-EPYAMT NEGATIVE
 12221        GO TO 1500-EDIT-EXPENSES.
 12222
 12223     IF CM-O-B-COVERAGE
 12224        GO TO 1500-EDIT-EXPENSES.
 12225
 12226     IF PI-COMPANY-ID = 'NCL'
 12227       IF FOUND-TOL-SW = 'Y'
 12228         IF WS-PMT-TOL NOT = ZERO
 12229           IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT) OR
 12230              ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12231                  MOVE PI-PMTNOTE1 TO WS-NCL-PMT-OPTION
 12232                  IF WS-NCL-PMT-OPTION = SPACES
 12233                      MOVE ER-0699 TO EMI-ERROR
 12234                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12235                  ELSE
 12236                  IF WS-NCL-PMT-OPTION ALPHABETIC-UPPER
 12237                      NEXT SENTENCE
 12238                  ELSE
 12239                  IF NOT WS-VALID-NCL-OPTION
 12240                      MOVE ER-0699 TO EMI-ERROR
 12241                      PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12242
 12243     IF WS-PMT-TOL NOT = ZERO
 12244        IF ((PI-CPYAMT - WS-PMT-TOL) > PI-EPYAMT)
 12245           or ((PI-CPYAMT + WS-PMT-TOL) < PI-EPYAMT)
 12246           MOVE ER-0495          TO EMI-ERROR
 12247           PERFORM 1490-PAYMENT-ERROR
 12248                                 THRU 1490-EXIT
 12249        end-if
 12250     end-if
 12251
 12252     GO TO 1500-EDIT-EXPENSES.
 12253
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 234
* EL156.cbl
 12255 1440-COMPUTE-LIFE-REMAINING.
 12256
 12257     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 12258        IF PI-PMTTYPE = '4'
 12259          MOVE PI-EPYAMT TO PI-CPYAMT
 12260          GO TO 1460-TEST-TYPE.
 12261
 12262     IF WS-LF-COVERAGE-TYPE = 'L'
 12263        COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT
 12264                          - CL-TOTAL-PAID-AMT
 12265        GO TO 1450-CHECK-MAX.
 12266
 12267     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12268        PI-LF-COVERAGE-TYPE = 'P'
 12269          COMPUTE PI-CPYAMT = CM-LF-BENEFIT-AMT -
 12270                              CM-LF-ITD-DEATH-AMT
 12271          GO TO 1450-CHECK-MAX.
 12272
 12273     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 12274     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 12275     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 12276     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12277     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12278     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 12279     MOVE '4'                    TO CP-REM-TERM-METHOD.
 12280     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12281     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12282
 12283     PERFORM 9800-LINK-REM-TERM.
 12284
 12285     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 12286     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 12287     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM.
 12288     MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT.
 12289     MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT.
 12290     MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM.
 12291     MOVE CM-LOAN-APR            TO CP-LOAN-APR.
 12292     MOVE CM-LOAN-TERM           TO CP-LOAN-TERM.
 12293     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY.
 12294     MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV.
 12295     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 12296     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 12297     MOVE CM-RATE-CLASS          TO CP-CLASS-CODE
 12298     MOVE CM-LF-BENEFIT-CD       TO CP-BENEFIT-CD.
 12299     MOVE CM-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS.
 12300     MOVE 'Y'                    TO CP-LF-CLAIM-CALC-SW.
 12301     IF PI-COMPANY-ID = 'DCC'
 12302        MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 12303        MOVE PI-CARRIER          TO ACCT-CARRIER
 12304        MOVE PI-GROUPING         TO ACCT-GROUPING
 12305        MOVE PI-STATE            TO ACCT-STATE
 12306        MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 12307        MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 12308        MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 12309        MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 12310
 12311
 12312* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 235
* EL156.cbl
 12313*          DATASET ('ERACCT')
 12314*          RIDFLD  (ERACCT-KEY)
 12315*          SET     (ADDRESS OF ACCOUNT-MASTER)
 12316*          GTEQ
 12317*          resp    (WS-RESPONSE)
 12318*       END-EXEC
 12319     MOVE 'ERACCT' TO DFHEIV1
 12320*    MOVE '&"S        G          (  N#00011757' TO DFHEIV0
 12321     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12322     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12323     MOVE X'204E233030303131373537' TO DFHEIV0(25:11)
 12324     CALL 'kxdfhei1' USING DFHEIV0,
 12325           DFHEIV1,
 12326           DFHEIV20,
 12327           DFHEIV99,
 12328           ERACCT-KEY,
 12329           DFHEIV99,
 12330           DFHEIV99,
 12331           DFHEIV99
 12332     SET ADDRESS OF ACCOUNT-MASTER TO
 12333         DFHEIV20
 12334     MOVE EIBRESP  TO WS-RESPONSE
 12335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12336        IF WS-RESP-NORMAL
 12337           AND (WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20))
 12338           and (pi-cert-eff-dt < am-expiration-dt)
 12339           and (pi-cert-eff-dt >= am-effective-dt)
 12340           move am-dcc-product-code to pi-dcc-product-code
 12341        else
 12342           move spaces           to pi-dcc-product-code
 12343        end-if
 12344        if pi-dcc-product-code not = spaces
 12345           move cm-ah-benefit-cd to pi-ah-benefit-cd
 12346           move cm-lf-benefit-cd to pi-lf-benefit-cd
 12347           PERFORM 0900-GET-DDF-limits
 12348                                 THRU 0900-EXIT
 12349           IF PDEF-FOUND
 12350              PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 12351                 (P1 > +8)
 12352                 OR (PD-PROD-CODE (P1) = 'L')
 12353              END-PERFORM
 12354              IF P1 < +9
 12355                 MOVE PD-MAX-AMT (P1)
 12356                                 TO CP-R-MAX-TOT-BEN
 12357              else
 12358                 move er-1674    to emi-error
 12359                 PERFORM 9900-ERROR-FORMAT
 12360                                 THRU 9900-EXIT
 12361              END-IF
 12362           else
 12363              move er-1672       to emi-error
 12364              PERFORM 9900-ERROR-FORMAT
 12365                                 THRU 9900-EXIT
 12366           END-IF
 12367        end-if
 12368     END-IF
 12369
 12370* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 236
* EL156.cbl
 12371*       PROGRAM  (LINK-REMAMT)
 12372*       COMMAREA (CALCULATION-PASS-AREA)
 12373*       LENGTH   (CP-COMM-LENGTH)
 12374*    END-EXEC.
 12375*    MOVE '."C                   (   #00011797' TO DFHEIV0
 12376     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12377     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12378     MOVE X'2020233030303131373937' TO DFHEIV0(25:11)
 12379     CALL 'kxdfhei1' USING DFHEIV0,
 12380           LINK-REMAMT,
 12381           CALCULATION-PASS-AREA,
 12382           CP-COMM-LENGTH,
 12383           DFHEIV99,
 12384           DFHEIV99,
 12385           DFHEIV99,
 12386           DFHEIV99
 12387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12388
 12389
 12390     COMPUTE PI-CPYAMT = CP-REMAINING-AMT - CL-TOTAL-PAID-AMT.
 12391
 12392     MOVE ' '                    TO CP-LF-CLAIM-CALC-SW.
 12393     MOVE CP-SCNP-6MO-AMT        TO PI-MO-BEN-AMT.
 12394
 12395     IF PI-COMPANY-ID = 'BOA' AND
 12396        PI-PMTTYPE    = '2'   AND
 12397        PI-OFFLINE    = 'N'
 12398           GO TO 1441-COMPUTE-BOA-INTEREST.
 12399
 12400     IF PI-COMPANY-ID = 'NCL' AND
 12401        PI-PMTTYPE    = '2'   AND
 12402        PI-OFFLINE    = 'N'
 12403          GO TO 1442-COMPUTE-NCL-INTEREST
 12404       ELSE
 12405          GO TO 1445-CONTINUE.
 12406
 12407 1441-COMPUTE-BOA-INTEREST.
 12408     MOVE +0             TO WS-CALC-INT.
 12409
 12410     MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 12411     MOVE WS-TODAY-DATE  TO DC-BIN-DATE-2.
 12412     MOVE +0             TO DC-ELAPSED-MONTHS
 12413                            DC-ELAPSED-DAYS.
 12414     MOVE '1'            TO DC-OPTION-CODE.
 12415     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12416     IF NO-CONVERSION-ERROR
 12417         NEXT SENTENCE
 12418     ELSE
 12419         GO TO 1445-CONTINUE.
 12420
 12421     IF (PI-INT-RATE NOT > ZEROS)  AND
 12422        (DC-ELAPSED-DAYS > +30)
 12423         MOVE ER-3531            TO EMI-ERROR
 12424         MOVE -1                 TO PINTL
 12425         MOVE AL-UNBON           TO PINTA
 12426         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12427
 12428     IF PI-EPYAMT NOT > ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 237
* EL156.cbl
 12429         GO TO 1445-CONTINUE.
 12430
 12431     IF (PI-INT-RATE NOT > ZEROS)  OR
 12432        (DC-ELAPSED-DAYS NOT > +30)
 12433         MOVE PI-EPYAMT TO PI-CPYAMT
 12434         GO TO 1441-FORMAT-NOTE.
 12435
 12436     COMPUTE WS-CALC-INT ROUNDED =  PI-EPYAMT
 12437                                 *  PI-INT-RATE
 12438                                 *  DC-ELAPSED-DAYS
 12439                                 /  365
 12440                                 /  100.
 12441
 12442     COMPUTE PI-CPYAMT = PI-EPYAMT + WS-CALC-INT.
 12443
 12444 1441-FORMAT-NOTE.
 12445
 12446     MOVE SPACES        TO WS-BOANOTE1.
 12447     MOVE 'BENEFIT -  ' TO WS-BOANOTE1-DESC.
 12448     MOVE PI-EPYAMT     TO WS-BOANOTE1-EPYAMT.
 12449     MOVE WS-BOANOTE1   TO WS-PMTNOTE1 PI-PMTNOTE1 NOTE1I.
 12450     MOVE AL-UANON      TO NOTE1A.
 12451
 12452     IF WS-CALC-INT > ZEROS
 12453         MOVE SPACES        TO WS-BOANOTE2
 12454         MOVE 'INTEREST - ' TO WS-BOANOTE2-DESC
 12455         MOVE WS-CALC-INT   TO WS-BOANOTE2-INT
 12456         MOVE WS-BOANOTE2   TO WS-PMTNOTE2 PI-PMTNOTE2 NOTE2I
 12457         MOVE AL-UANON      TO NOTE2A.
 12458
 12459     GO TO 1445-CONTINUE.
 12460
 12461 1442-COMPUTE-NCL-INTEREST.
 12462     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12463     MOVE PI-STATE               TO WS-ST-ACCESS.
 12464     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 12465     MOVE '3'                    TO CNTL-REC-TYPE.
 12466     MOVE +0                     TO CNTL-SEQ-NO.
 12467     MOVE 'STAT'                 TO FILE-SWITCH.
 12468
 12469     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12470
 12471     MOVE +0                 TO WS-CALC-INT.
 12472
 12473     IF ST-STAT-FROM-INCURRED
 12474         MOVE CL-INCURRED-DT TO WS-COMPUTE-FROM-DT
 12475       ELSE
 12476     IF ST-STAT-FROM-REPORTED
 12477         MOVE CL-REPORTED-DT TO WS-COMPUTE-FROM-DT
 12478       ELSE
 12479         GO TO 1445-CONTINUE.
 12480
 12481     MOVE WS-COMPUTE-FROM-DT TO DC-BIN-DATE-1.
 12482     MOVE WS-TODAY-DATE      TO DC-BIN-DATE-2.
 12483     MOVE +0                 TO DC-ELAPSED-MONTHS
 12484                                DC-ELAPSED-DAYS.
 12485     MOVE '1'                TO DC-OPTION-CODE.
 12486     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 238
* EL156.cbl
 12487     IF NO-CONVERSION-ERROR
 12488         NEXT SENTENCE
 12489     ELSE
 12490         GO TO 1445-CONTINUE.
 12491
 12492     IF (CF-ST-STAT-INTEREST NOT > ZEROS) OR
 12493        (DC-ELAPSED-DAYS NOT > CF-ST-NO-DAYS-ELAPSED)
 12494         GO TO 1445-CONTINUE.
 12495
 12496     COMPUTE WS-CALC-INT ROUNDED =  PI-CPYAMT
 12497                                 *  CF-ST-STAT-INTEREST.
 12498
 12499     MOVE SPACES              TO WS-NCLNOTE1.
 12500     MOVE 'BENEFIT -  '       TO WS-NCLNOTE1-DESC.
 12501     MOVE PI-CPYAMT           TO WS-NCLNOTE1-CPYAMT.
 12502     MOVE WS-NCLNOTE1         TO WS-PMTNOTE1
 12503                                 PI-PMTNOTE1
 12504                                 NOTE1I.
 12505     MOVE AL-UANON            TO NOTE1A.
 12506
 12507     IF WS-CALC-INT > ZEROS
 12508         MOVE SPACES          TO WS-NCLNOTE2
 12509         MOVE 'INTEREST - '   TO WS-NCLNOTE2-DESC
 12510         MOVE WS-CALC-INT     TO WS-NCLNOTE2-INT
 12511         MOVE WS-NCLNOTE2     TO WS-PMTNOTE2
 12512                                 PI-PMTNOTE2
 12513                                 NOTE2I
 12514         MOVE AL-UANON        TO NOTE2A.
 12515
 12516     COMPUTE PI-CPYAMT = PI-CPYAMT + WS-CALC-INT.
 12517
 12518 1445-CONTINUE.
 12519
 12520     IF PI-EPYAMT = ZEROS OR PI-PMTTYPE = '4'
 12521        GO TO 1460-TEST-TYPE.
 12522
 12523     IF CM-O-B-COVERAGE
 12524        GO TO 1460-TEST-TYPE.
 12525
 12526     IF PI-COMPANY-ID = 'BOA' OR 'NCL'
 12527         GO TO 1450-CHECK-MAX.
 12528
 12529     if (pi-company-id = 'DCC')
 12530        and (pdef-found)
 12531        if pi-epyamt > pd-max-amt (p1)
 12532           move er-1657          to emi-error
 12533           perform 1490-payment-error
 12534                                 thru 1490-exit
 12535           go to 1460-test-type
 12536        end-if
 12537     else
 12538        IF (PI-CPYAMT - (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12539           > PI-EPYAMT)
 12540                         OR
 12541           (PI-CPYAMT + (CP-REMAINING-AMT-PRV - CP-REMAINING-AMT)
 12542           < PI-EPYAMT)
 12543           MOVE ER-0594          TO EMI-ERROR
 12544           PERFORM 1490-PAYMENT-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 239
* EL156.cbl
 12545                                 THRU 1490-EXIT
 12546           GO TO 1460-TEST-TYPE
 12547        end-if
 12548     end-if
 12549     .
 12550 1450-CHECK-MAX.
 12551
 12552     IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 12553        PI-LF-COVERAGE-TYPE = 'P'
 12554         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12555                                   CM-LF-ITD-DEATH-AMT
 12556     ELSE
 12557         COMPUTE WS-BEN-AMT-LEFT = CM-LF-BENEFIT-AMT -
 12558                                   CL-TOTAL-PAID-AMT.
 12559
 12560     IF PI-EPYAMT > WS-BEN-AMT-LEFT
 12561          MOVE ER-0543           TO EMI-ERROR
 12562          PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT.
 12563
 12564 1460-TEST-TYPE.
 12565
 12566     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 12567        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12568           COMPUTE WS-LF-BEN-AMT = CM-LF-BENEFIT-AMT +
 12569                                   CM-LF-ALT-BENEFIT-AMT -
 12570                                   CL-TOTAL-PAID-AMT
 12571           IF PI-EPYAMT > WS-LF-BEN-AMT
 12572               MOVE ER-0543      TO EMI-ERROR
 12573               PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12574           END-IF
 12575        END-IF
 12576     END-IF
 12577
 12578     IF PI-PMT-APPR-SW = 'G'
 12579       NEXT SENTENCE
 12580     ELSE
 12581       IF WS-MAX-LF-PMT-TOL NOT = ZERO
 12582         IF PI-EPYAMT = ZERO
 12583             IF PI-CPYAMT > WS-MAX-LF-PMT-TOL
 12584                 MOVE ER-0494    TO  EMI-ERROR
 12585                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12586                 GO TO 1500-EDIT-EXPENSES
 12587             ELSE
 12588                 NEXT SENTENCE
 12589         ELSE
 12590             IF PI-EPYAMT > WS-MAX-LF-PMT-TOL
 12591                 MOVE ER-0494    TO  EMI-ERROR
 12592                 PERFORM 1490-PAYMENT-ERROR THRU 1490-EXIT
 12593                 GO TO 1500-EDIT-EXPENSES.
 12594
 12595     IF PI-PMTTYPE NOT = '2' OR
 12596        (WS-LF-COVERAGE-TYPE = 'L' OR 'P')
 12597         GO TO 1500-EDIT-EXPENSES.
 12598
 12599     MOVE CP-REMAINING-AMT-PRV   TO WS-EDIT-PATTERN.
 12600     MOVE ER-0526                TO EMI-ERROR.
 12601     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12602
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 240
* EL156.cbl
 12603     IF EMI-ERROR-NUMBER (1) = '0526'
 12604        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (1).
 12605
 12606     IF EMI-ERROR-NUMBER (2) = '0526'
 12607        MOVE WS-EDIT             TO EMI-TEXT-VARIABLE (2).
 12608
 12609     GO TO 1500-EDIT-EXPENSES.
 12610
 12611 1490-PAYMENT-ERROR.
 12612     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12613
 12614     IF EMI-MESSAGE-FORMATTED
 12615         MOVE -1                 TO EPYAMTL
 12616         MOVE AL-UNBON           TO EPYAMTA.
 12617
 12618 1490-EXIT.
 12619      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 241
* EL156.cbl
 12621 1500-EDIT-EXPENSES.
 12622     IF PI-COMPANY-ID = 'MET' OR 'AIG' OR 'AUK' OR 'DMD'
 12623         GO TO 1500-SKIP-ERROR-0556.
 12624
 12625 1500-CONTINUE-ON.
 12626
 12627     IF CM-O-B-COVERAGE
 12628        MOVE ER-0556             TO EMI-ERROR
 12629        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12630
 12631 1500-SKIP-ERROR-0556.
 12632     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12633        IF PI-EEXPENS NOT = ZEROS
 12634           MOVE ER-0524          TO EMI-ERROR
 12635           GO TO 1590-EXPENSE-ERROR
 12636        ELSE
 12637           GO TO 1600-EDIT-RESERVES.
 12638
 12639     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 12640     MOVE '6'                    TO CNTL-REC-TYPE.
 12641
 12642     IF CONTROL-IS-ACTUAL-CARRIER
 12643         MOVE PI-CARRIER         TO WS-CARR
 12644     ELSE
 12645         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 12646
 12647     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 12648     MOVE +0                     TO CNTL-SEQ-NO.
 12649     MOVE 'CARR'                 TO FILE-SWITCH.
 12650
 12651     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 12652
 12653     IF EXPENSE-CALC-MANUAL
 12654        GO TO 1600-EDIT-RESERVES.
 12655
 12656     IF DOLLARS-PER-PMT
 12657        MOVE CF-EXPENSE-DOLLAR   TO PI-CEXPENS
 12658        GO TO 1600-EDIT-RESERVES.
 12659
 12660     IF DOLLARS-PER-MONTH AND
 12661        (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 12662       COMPUTE PI-CEXPENS = CF-EXPENSE-DOLLAR * EXPENSE-MONTH-SAVE
 12663       GO TO 1600-EDIT-RESERVES.
 12664
 12665     IF PERCENT-OF-PAYMENT
 12666        COMPUTE PI-CEXPENS = PI-CPYAMT * CF-EXPENSE-PERCENT.
 12667
 12668     GO TO 1600-EDIT-RESERVES.
 12669
 12670 1590-EXPENSE-ERROR.
 12671     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12672
 12673     IF EMI-MESSAGE-FORMATTED
 12674        MOVE -1                  TO EEXPENSL
 12675        MOVE AL-UNBON            TO EEXPENSA.
 12676
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 242
* EL156.cbl
 12678 1600-EDIT-RESERVES.
 12679     IF PI-PMTTYPE = '4' OR '5' OR '6'
 12680        IF PI-ERESV = ZEROS
 12681           GO TO 1700-EDIT-EXPENSE-TYPE
 12682        ELSE
 12683           MOVE ER-0525          TO EMI-ERROR
 12684           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT
 12685           GO TO 1700-EDIT-EXPENSE-TYPE.
 12686
 12687     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 12688     MOVE ZEROS                  TO TRLR-SEQ-NO.
 12689     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 12690
 12691     IF NOT AT-MANUAL-RESERVES-USED
 12692        IF PI-ERESV NOT = ZEROS
 12693           MOVE ER-0518          TO EMI-ERROR
 12694           PERFORM 1690-RESERVE-ERROR THRU 1690-EXIT.
 12695
 12696     IF AT-MANUAL-RESERVES-USED
 12697        MOVE AT-CURRENT-MANUAL-RESERVE  TO PI-CRESV
 12698        GO TO 1700-EDIT-EXPENSE-TYPE.
 12699
 12700     IF AT-FUTURE-RESERVES-USED
 12701        ADD AT-CURRENT-MANUAL-RESERVE   TO WS-RESERVE-WORK.
 12702
 12703     IF AT-FUTURE-RESERVES-USED
 12704        ADD AT-FUTURE-RESERVE    TO WS-RESERVE-WORK.
 12705
 12706     IF AT-PAY-TO-CURRENT-USED OR AT-LF-PTC-USED
 12707        ADD AT-PAY-CURRENT-RESERVE TO WS-RESERVE-WORK.
 12708
 12709     IF AT-IBNR-RESERVES-USED
 12710        ADD AT-IBNR-RESERVE      TO WS-RESERVE-WORK.
 12711
 12712     MOVE WS-RESERVE-WORK        TO PI-CRESV.
 12713     GO TO 1700-EDIT-EXPENSE-TYPE.
 12714
 12715 1690-RESERVE-ERROR.
 12716     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12717
 12718     IF EMI-MESSAGE-FORMATTED
 12719        MOVE AL-UNBON            TO ERESVA
 12720        MOVE -1                  TO ERESVL.
 12721
 12722 1690-EXIT.
 12723      EXIT.
 12724
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 243
* EL156.cbl
 12726 1700-EDIT-EXPENSE-TYPE.
 12727     IF PI-PMTTYPE NOT = '5' AND '6'
 12728        GO TO 2000-EDIT-DONE.
 12729
 12730     IF PI-ETYPE = ' ' OR '1' OR '2' OR '3' OR '4' OR '5' OR
 12731                   '6' OR '7' OR '8' OR '9'
 12732        GO TO 2000-EDIT-DONE.
 12733
 12734 1705-EXPENSE-ERROR.
 12735     MOVE ER-0573                TO EMI-ERROR.
 12736     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12737
 12738     IF EMI-MESSAGE-FORMATTED
 12739        MOVE AL-UABON            TO ETYPEA
 12740        MOVE -1                  TO ETYPEL.
 12741
 12742     GO TO 2000-EDIT-DONE.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 244
* EL156.cbl
 12744 1950-NOT-FOUND.
 12745     IF FILE-SWITCH = 'MSTR'
 12746        MOVE ER-0204             TO EMI-ERROR.
 12747
 12748     IF FILE-SWITCH = 'CARR'
 12749        MOVE ER-0252             TO EMI-ERROR.
 12750
 12751     IF FILE-SWITCH = 'COMP'
 12752        MOVE ER-0254             TO EMI-ERROR.
 12753
 12754     IF FILE-SWITCH = 'STAT'
 12755        MOVE ER-0149             TO EMI-ERROR.
 12756
 12757     IF FILE-SWITCH = 'PROC'
 12758        MOVE ER-0019             TO EMI-ERROR.
 12759
 12760     IF FILE-SWITCH = 'ACCT'
 12761        MOVE ER-0198             TO EMI-ERROR.
 12762
 12763     IF FILE-SWITCH = 'BENE'
 12764        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 12765           MOVE ER-0282          TO EMI-ERROR
 12766        ELSE
 12767           MOVE ER-0283          TO EMI-ERROR.
 12768
 12769     MOVE -1                     TO PMTTYPEL.
 12770     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12771
 12772     MOVE EMI-FORCABLE-CTR       TO  PI-FORCE-COUNT
 12773                                     WS-FORCE-CTR.
 12774
 12775     MOVE EMI-FATAL-CTR          TO  PI-FATAL-COUNT
 12776                                     WS-FATAL-CTR.
 12777
 12778     GO TO 8200-SEND-DATAONLY.
 12779
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 245
* EL156.cbl
 12781 2000-EDIT-DONE.
 12782*********************
 12783     perform 2210-dcc-max-benes thru 2210-exit
 12784     if pi-company-id not = 'DCC'
 12785        IF (WS-SPECIAL-CALC-CD = 'C')
 12786           and (cl-critical-period > 0)
 12787           IF CM-AH-BENEFIT-AMT NOT = ZERO
 12788              IF PI-EPYAMT > ZEROS
 12789                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12790                    PI-EPYAMT) / CM-AH-BENEFIT-AMT
 12791              ELSE
 12792                 COMPUTE ws-benefits-paid = (CL-TOTAL-PAID-AMT +
 12793                    PI-CPYAMT) / CM-AH-BENEFIT-AMT
 12794              END-IF
 12795              if ws-benefits-paid > cl-critical-period
 12796                 MOVE ER-0657          TO EMI-ERROR
 12797                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12798              END-IF
 12799           END-IF
 12800        END-IF
 12801     end-if
 12802     IF PI-HOLDTIL NOT = ZEROS
 12803        MOVE PI-HOLDTIL          TO HOLDTILO
 12804        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 12805
 12806     IF PI-EPYFROM NOT = ZEROS
 12807        MOVE PI-EPYFROM          TO EPYFROMO
 12808        INSPECT EPYFROMI REPLACING ALL SPACES BY '/'.
 12809
 12810     IF PI-EPYTHRU NOT = ZEROS
 12811        MOVE PI-EPYTHRU            TO EPYTHRUO
 12812        INSPECT EPYTHRUI REPLACING ALL SPACES BY '/'
 12813        IF PI-USES-PAID-TO
 12814           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 12815           MOVE '4'                TO DC-OPTION-CODE
 12816           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12817           IF NO-CONVERSION-ERROR
 12818              MOVE +1              TO DC-ELAPSED-DAYS
 12819              MOVE +0              TO DC-ELAPSED-MONTHS
 12820              MOVE '6'             TO DC-OPTION-CODE
 12821              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12822              IF NO-CONVERSION-ERROR
 12823                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 12824
 12825     MOVE PI-EDAYS               TO EDAYSO.
 12826
 12827     IF PI-AIGFROM NOT = ZEROS
 12828        MOVE PI-AIGFROM          TO AIGFROMO
 12829        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 12830
 12831     MOVE PI-EPYAMT              TO EPYAMTO.
 12832     MOVE PI-ERESV               TO ERESVO.
 12833     MOVE PI-EEXPENS             TO EEXPENSO.
 12834
 12835     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 12836     MOVE SPACES                 TO DC-OPTION-CODE.
 12837     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12838
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 246
* EL156.cbl
 12839     IF DATE-CONVERSION-ERROR
 12840        MOVE SPACES              TO CPYFROMI
 12841     ELSE
 12842        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI
 12843        IF PI-EPYFROM = ZEROS
 12844           MOVE AL-UANON             TO EPYFROMA
 12845           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYFROM
 12846           MOVE DC-GREG-DATE-1-EDIT  TO EPYFROMI.
 12847
 12848     IF PI-USES-PAID-TO
 12849        MOVE PI-CPYTHRU                    TO DC-BIN-DATE-1
 12850        MOVE +1                            TO DC-ELAPSED-DAYS
 12851        MOVE +0                            TO DC-ELAPSED-MONTHS
 12852        MOVE '6'                           TO DC-OPTION-CODE
 12853        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12854        IF NO-CONVERSION-ERROR
 12855           MOVE DC-GREG-DATE-1-EDIT        TO CPYTHRUI
 12856           IF PI-EPYTHRU = ZEROS
 12857              MOVE AL-UANON                TO EPYTHRUA
 12858              MOVE DC-GREG-DATE-1-EDIT     TO EPYTHRUI
 12859              MOVE ' '                     TO DC-OPTION-CODE
 12860              MOVE +0                      TO DC-ELAPSED-DAYS
 12861                                              DC-ELAPSED-MONTHS
 12862              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 12863              IF NO-CONVERSION-ERROR
 12864                  MOVE DC-GREG-DATE-1-MDY  TO  PI-EPYTHRU
 12865                  GO TO 2001-CONTINUE
 12866              ELSE
 12867                  GO TO 2001-CONTINUE
 12868           ELSE
 12869              GO TO 2001-CONTINUE.
 12870
 12871     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 12872     MOVE SPACES                 TO DC-OPTION-CODE.
 12873     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 12874
 12875     IF DATE-CONVERSION-ERROR
 12876        MOVE SPACES              TO CPYTHRUI
 12877     ELSE
 12878        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 12879        IF PI-EPYTHRU = ZEROS
 12880           MOVE AL-UANON TO EPYTHRUA
 12881           MOVE DC-GREG-DATE-1-MDY   TO PI-EPYTHRU
 12882           MOVE DC-GREG-DATE-1-EDIT  TO EPYTHRUI.
 12883
 12884 2001-CONTINUE.
 12885
 12886     MOVE PI-CDAYS               TO CDAYSO.
 12887
 12888     IF PI-EDAYS = ZEROS
 12889        MOVE AL-UNNON TO EDAYSA
 12890        MOVE PI-CDAYS            TO EDAYSO PI-EDAYS.
 12891
 12892     MOVE PI-CPYAMT              TO CPYAMTO.
 12893
 12894     IF PI-EPYAMT = ZEROS
 12895        MOVE AL-UNNON            TO EPYAMTA
 12896        MOVE PI-CPYAMT           TO EPYAMTO  PI-EPYAMT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 247
* EL156.cbl
 12897
 12898     MOVE PI-CRESV               TO CRESVO.
 12899     MOVE PI-CEXPENS             TO CEXPENSO.
 12900
 12901     IF PI-EEXPENS = ZEROS
 12902        MOVE AL-UNNON TO EEXPENSA
 12903        MOVE PI-CEXPENS          TO EEXPENSO  PI-EEXPENS.
 12904
 12905     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 12906        AND (CL-CLAIM-TYPE = 'L')
 12907        AND (PI-OFFLINE NOT EQUAL 'Y')
 12908        IF PI-PMTTYPE = '2' OR '4'
 12909           PERFORM 2200-CALC-INTEREST
 12910                                 THRU 2200-EXIT
 12911        END-IF
 12912     END-IF
 12913     MOVE EMI-FORCABLE-CTR       TO PI-FORCE-COUNT WS-FORCE-CTR.
 12914     MOVE EMI-FATAL-CTR          TO PI-FATAL-COUNT WS-FATAL-CTR.
 12915     MOVE LAST-ERROR-LINE        TO ERRMSG0O.
 12916
 12917     IF EMI-FATAL-CTR = ZEROS
 12918        MOVE 'B'                 TO PI-PASS-SW.
 12919
 12920     IF NOT EMI-MESSAGE-FORMATTED
 12921         MOVE -1                 TO EPYFROML
 12922     ELSE
 12923         IF EMI-ERROR-NUMBER (1) = '0526' AND
 12924            EMI-ERROR-NUMBER (2) = SPACES
 12925             MOVE -1             TO EPYFROML.
 12926
 12927     GO TO 8200-SEND-DATAONLY.
 12928
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 248
* EL156.cbl
 12930 2200-CALC-INTEREST.
 12931     IF PI-PROOF-DATE NOT = ZEROS AND LOW-VALUES
 12932        MOVE PI-PROOF-DATE       TO DC-GREG-DATE-1-MDY
 12933        MOVE '4'                 TO DC-OPTION-CODE
 12934        PERFORM 9700-LINK-DATE-CONVERT
 12935        IF DATE-CONVERSION-ERROR
 12936            MOVE LOW-VALUES      TO CP-PRF-DT
 12937        ELSE
 12938           MOVE DC-BIN-DATE-1    TO CP-PRF-DT
 12939        END-IF
 12940     END-IF
 12941     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
 12942        IN CLAIM-INT-PASS-AREA
 12943     MOVE CL-CERT-STATE          TO CP-STATE
 12944        IN CLAIM-INT-PASS-AREA
 12945     MOVE CM-LF-BENEFIT-CD       TO CP-PRODUCT
 12946     MOVE 'LF'                   TO CP-COVERAGE
 12947     MOVE CL-INCURRED-DT         TO CP-INC-DT
 12948     MOVE CL-FILE-ESTABLISH-DT   TO CP-EST-DT
 12949     MOVE LOW-VALUES             TO CP-LSTPD-DT
 12950     MOVE CL-REPORTED-DT         TO CP-RPT-DT
 12951     MOVE CL-CERT-EFF-DT         TO CP-EFF-DT
 12952     MOVE PI-EPYAMT              TO CP-CLAIM-AMT
 12953
 12954* EXEC CICS LINK
 12955*       PROGRAM   ('ELCLMI')
 12956*       COMMAREA  (CLAIM-INT-PASS-AREA)
 12957*       LENGTH    (CP-CLAIM-LENGTH)
 12958*    END-EXEC
 12959     MOVE 'ELCLMI' TO DFHEIV1
 12960*    MOVE '."C                   (   #00012366' TO DFHEIV0
 12961     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12962     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12963     MOVE X'2020233030303132333636' TO DFHEIV0(25:11)
 12964     CALL 'kxdfhei1' USING DFHEIV0,
 12965           DFHEIV1,
 12966           CLAIM-INT-PASS-AREA,
 12967           CP-CLAIM-LENGTH,
 12968           DFHEIV99,
 12969           DFHEIV99,
 12970           DFHEIV99,
 12971           DFHEIV99
 12972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12973     MOVE AL-PANOF               TO PINTHA
 12974                                    PINTA
 12975     IF NO-CI-ERROR
 12976        MOVE CP-CLM-INT-AMT      TO PINTO
 12977                                    PI-INT-AMT
 12978        MOVE CP-CLM-INT-NODAYS   TO PI-INT-DAYS
 12979        MOVE CP-CLM-INT-RATE     TO PI-INT-RATE-USED
 12980        MOVE AL-PANOF            TO PINTHA
 12981                                    PINTA
 12982     ELSE
 12983        IF CI-RETURN-CODE = '8'
 12984           MOVE ER-3818          TO EMI-ERROR
 12985           MOVE -1               TO ZINTL
 12986           PERFORM 9900-ERROR-FORMAT
 12987                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 249
* EL156.cbl
 12988           GO TO 2200-EXIT
 12989        ELSE
 12990           MOVE ZEROS            TO PINTO
 12991                                    PI-INT-AMT
 12992                                    PI-INT-DAYS
 12993                                    PI-INT-RATE-USED
 12994        END-IF
 12995     END-IF
 12996     IF PI-INT-AMT NOT = ZEROS
 12997        IF (CL-SOC-SEC-NO (1:9) NUMERIC)
 12998           AND (CL-SOC-SEC-NO NOT = ZEROS)
 12999           CONTINUE
 13000        ELSE
 13001           MOVE CL-SOC-SEC-NO (1:3)
 13002                                 TO WS-SSN (1:3)
 13003           MOVE CL-SOC-SEC-NO (5:2)
 13004                                 TO WS-SSN (4:2)
 13005           MOVE CL-SOC-SEC-NO (8:4)
 13006                                 TO WS-SSN (6:4)
 13007           IF (WS-SSN NUMERIC)
 13008              AND (WS-SSN NOT = ZEROS)
 13009              CONTINUE
 13010           ELSE
 13011              MOVE ER-2044       TO EMI-ERROR
 13012              PERFORM 9900-ERROR-FORMAT
 13013                                 THRU 9900-EXIT
 13014           END-IF
 13015        END-IF
 13016        MOVE ELMSTR-KEY          TO ELTRLR-KEY
 13017        MOVE +51                 TO TRLR-SEQ-NO
 13018
 13019* EXEC CICS READ
 13020*          DATASET  ('ELTRLR')
 13021*          SET      (ADDRESS OF ACTIVITY-TRAILERS)
 13022*          RIDFLD   (ELTRLR-KEY)
 13023*          RESP     (WS-RESPONSE)
 13024*       END-EXEC
 13025     MOVE 'ELTRLR' TO DFHEIV1
 13026*    MOVE '&"S        E          (  N#00012416' TO DFHEIV0
 13027     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13028     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13029     MOVE X'204E233030303132343136' TO DFHEIV0(25:11)
 13030     CALL 'kxdfhei1' USING DFHEIV0,
 13031           DFHEIV1,
 13032           DFHEIV20,
 13033           DFHEIV99,
 13034           ELTRLR-KEY,
 13035           DFHEIV99,
 13036           DFHEIV99,
 13037           DFHEIV99
 13038     SET ADDRESS OF ACTIVITY-TRAILERS TO
 13039         DFHEIV20
 13040     MOVE EIBRESP  TO WS-RESPONSE
 13041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13042        IF (NOT WS-RESP-NORMAL)
 13043                    OR
 13044           ((WS-RESP-NORMAL)
 13045           AND ((AT-ADDRESS-LINE-1 = SPACES)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 250
* EL156.cbl
 13046           OR (AT-CITY-STATE = SPACES)))
 13047           MOVE ER-0874          TO EMI-ERROR
 13048           PERFORM 9900-ERROR-FORMAT
 13049                                 THRU 9900-EXIT
 13050        END-IF
 13051     END-IF
 13052     .
 13053 2200-EXIT.
 13054     EXIT.
 13055 2210-dcc-max-benes.
 13056
 13057     move pi-ah-term             to ws-max-bens
 13058     if cl-critical-period not = zeros and spaces
 13059        move cl-critical-period  to ws-max-bens
 13060     end-if
 13061     move cm-ah-benefit-amt      to ws-monthly-benefit
 13062     if pdef-found
 13063        and (pd-max-amt (p1) not = zeros)
 13064        if pd-ben-pct (p1) not numeric
 13065           move zeros            to pd-ben-pct (p1)
 13066        end-if
 13067        if pd-ben-pct (p1) = zeros
 13068           move +1               to ws-work-ben-pct
 13069        else
 13070           move pd-ben-pct (p1)  to ws-work-ben-pct
 13071        end-if
 13072*       compute ws-monthly-benefit =
 13073*          ws-monthly-benefit * ws-work-ben-pct
 13074*       if ws-monthly-benefit > pd-max-amt (p1)
 13075*          move pd-max-amt (p1) to ws-monthly-benefit
 13076*       end-if
 13077     end-if
 13078
 13079     move cl-cert-key-data       to elcrtt-key (2:21)
 13080     move cl-company-cd          to ctrlr-comp-cd
 13081     move cl-cert-no             to ctrlr-cert-no
 13082     move 'B'                    to ctrlr-rec-type
 13083
 13084
 13085* EXEC CICS READ
 13086*       DATASET  ('ELCRTT')
 13087*       set      (address of CERTIFICATE-TRAILERS)
 13088*       RIDFLD   (ELCRTT-KEY)
 13089*       RESP     (WS-RESPONSE)
 13090*    END-EXEC
 13091     MOVE 'ELCRTT' TO DFHEIV1
 13092*    MOVE '&"S        E          (  N#00012464' TO DFHEIV0
 13093     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13094     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13095     MOVE X'204E233030303132343634' TO DFHEIV0(25:11)
 13096     CALL 'kxdfhei1' USING DFHEIV0,
 13097           DFHEIV1,
 13098           DFHEIV20,
 13099           DFHEIV99,
 13100           ELCRTT-KEY,
 13101           DFHEIV99,
 13102           DFHEIV99,
 13103           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 251
* EL156.cbl
 13104     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13105         DFHEIV20
 13106     MOVE EIBRESP  TO WS-RESPONSE
 13107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13108     IF not WS-RESP-NORMAL
 13109        go to 2210-exit
 13110     end-if
 13111
 13112*    if instypei = 'P'
 13113*       move +1 to s1
 13114*    else
 13115*       MOVE +2 to s1
 13116*    end-if
 13117
 13118*    move +1 to s1
 13119*    evaluate cl-claim-type
 13120*       when 'A'
 13121*          move +1 to s2
 13122*       when 'I'
 13123*          move +2 to s2
 13124*       when 'G'
 13125*          move +3 to s2
 13126*       when 'L'
 13127*          move +4 to s2
 13128*       when 'P'
 13129*          move +5 to s2
 13130*    end-evaluate
 13131
 13132     move zeros                  to ws-prev-days-paid
 13133                                    ws-benefits-paid
 13134                                    ws-prev-amt-paid
 13135     perform varying s1 from +1 by +1 until
 13136        (s1 > +24)
 13137        or (cs-claim-type (s1) = spaces)
 13138        if pi-company-id not = 'DCC'
 13139           if cs-claim-type (s1) = cl-claim-type
 13140              compute ws-prev-days-paid =
 13141                 ws-prev-days-paid + cs-days-paid (s1)
 13142              compute ws-prev-amt-paid =
 13143                 ws-prev-amt-paid + cs-total-paid (s1)
 13144           end-if
 13145        else
 13146           if (cs-claim-type (s1) = cl-claim-type)
 13147              and (cs-benefit-period (s1) = cl-benefit-period)
 13148              and (cs-insured-type (s1) = cl-insured-type)
 13149              compute ws-prev-days-paid =
 13150                 ws-prev-days-paid + cs-days-paid (s1)
 13151              compute ws-prev-amt-paid =
 13152                 ws-prev-amt-paid + cs-total-paid (s1)
 13153           end-if
 13154        end-if
 13155     end-perform
 13156     if pi-epyamt > zeros
 13157        compute ws-benefits-paid =
 13158           (ws-prev-amt-paid + pi-epyamt)
 13159           / ws-monthly-benefit
 13160     else
 13161        compute ws-benefits-paid =
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 252
* EL156.cbl
 13162           (ws-prev-amt-paid + pi-cpyamt)
 13163           / ws-monthly-benefit
 13164     end-if
 13165*    if pi-company-id = 'DCC'
 13166     if cl-claim-type not = 'L' and 'P'
 13167        if ws-benefits-paid > ws-max-bens
 13168           move er-1658          to emi-error
 13169           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13170        end-if
 13171     end-if
 13172*    end-if
 13173*     if s1 < +25
 13174*        if pi-epyamt > zeros
 13175*           compute ws-benefits-paid =
 13176*              (cs-total-paid (s1) + PI-EPYAMT)
 13177*              / ws-monthly-benefit
 13178*        else
 13179*           compute ws-benefits-paid =
 13180*              (cs-total-paid (s1) + PI-CPYAMT)
 13181*              / ws-monthly-benefit
 13182*        end-if
 13183
 13184*       if ws-benefits-paid > pd-crit-period (p1)
 13185*        if ws-benefits-paid > ws-max-bens
 13186*           move er-1658          to emi-error
 13187*           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13188*        end-if
 13189*     end-if
 13190     .
 13191 2210-exit.
 13192     exit.
 13193
 13194 2220-update-elcrtt.
 13195
 13196
 13197* EXEC CICS GETMAIN
 13198*       SET      (ADDRESS OF CERTIFICATE-TRAILERS)
 13199*       LENGTH   (ELCRTT-LENGTH)
 13200*       INITIMG  (GETMAIN-SPACE)
 13201*    END-EXEC
 13202*    MOVE ',"IL                  $   #00012558' TO DFHEIV0
 13203     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13204     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13205     MOVE X'2020233030303132353538' TO DFHEIV0(25:11)
 13206     CALL 'kxdfhei1' USING DFHEIV0,
 13207           DFHEIV20,
 13208           ELCRTT-LENGTH,
 13209           GETMAIN-SPACE
 13210     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 13211         DFHEIV20
 13212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13213
 13214     move cl-cert-key-data       to elcrtt-key (2:21)
 13215     move cl-company-cd          to ctrlr-comp-cd
 13216     move cl-cert-no             to ctrlr-cert-no
 13217     move 'B'                    to ctrlr-rec-type
 13218
 13219
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 253
* EL156.cbl
 13220* EXEC CICS READ
 13221*       UPDATE
 13222*       DATASET  (ELCRTT-DSID)
 13223*       into     (CERTIFICATE-TRAILERS)
 13224*       RIDFLD   (ELCRTT-KEY)
 13225*       RESP     (WS-RESPONSE)
 13226*    END-EXEC
 13227     MOVE LENGTH OF
 13228      CERTIFICATE-TRAILERS
 13229       TO DFHEIV11
 13230*    MOVE '&"IL       EU         (  N#00012569' TO DFHEIV0
 13231     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13232     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13233     MOVE X'204E233030303132353639' TO DFHEIV0(25:11)
 13234     CALL 'kxdfhei1' USING DFHEIV0,
 13235           ELCRTT-DSID,
 13236           CERTIFICATE-TRAILERS,
 13237           DFHEIV11,
 13238           ELCRTT-KEY,
 13239           DFHEIV99,
 13240           DFHEIV99,
 13241           DFHEIV99
 13242     MOVE EIBRESP  TO WS-RESPONSE
 13243     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13244
 13245     IF WS-RESP-NORMAL
 13246        perform 2225-upd-crt-trlr thru 2225-exit
 13247
 13248* EXEC CICS REWRITE
 13249*          DATASET  (ELCRTT-DSID)
 13250*          from     (CERTIFICATE-TRAILERS)
 13251*          RESP     (WS-RESPONSE)
 13252*       END-EXEC
 13253     MOVE LENGTH OF
 13254      CERTIFICATE-TRAILERS
 13255       TO DFHEIV11
 13256*    MOVE '&& L                  %  N#00012579' TO DFHEIV0
 13257     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13258     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13259     MOVE X'204E233030303132353739' TO DFHEIV0(25:11)
 13260     CALL 'kxdfhei1' USING DFHEIV0,
 13261           ELCRTT-DSID,
 13262           CERTIFICATE-TRAILERS,
 13263           DFHEIV11,
 13264           DFHEIV99
 13265     MOVE EIBRESP  TO WS-RESPONSE
 13266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13267     else
 13268        if ws-resp-notfnd
 13269           move 'CS'             to certificate-trailers
 13270           move cl-company-cd    to cs-company-cd
 13271           move cl-cert-key-data to cs-control-primary (2:21)
 13272           move cl-cert-no       to cs-cert-no
 13273           move 'B'              to cs-trailer-type
 13274           perform varying s1 from +1 by +1 until s1 > +24
 13275              move zeros         to cs-benefit-period (s1)
 13276                                    cs-days-paid (s1)
 13277                                    cs-total-paid (s1)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 254
* EL156.cbl
 13278                                    cs-remaining-bens (s1)
 13279           end-perform
 13280           perform 2225-upd-crt-trlr
 13281                                 thru 2225-exit
 13282
 13283* EXEC CICS WRITE
 13284*             DATASET  (ELCRTT-DSID)
 13285*             from     (CERTIFICATE-TRAILERS)
 13286*             RIDFLD   (cs-control-primary)
 13287*             RESP     (WS-RESPONSE)
 13288*          END-EXEC
 13289     MOVE LENGTH OF
 13290      CERTIFICATE-TRAILERS
 13291       TO DFHEIV11
 13292*    MOVE '&$ L                  ''  N#00012599' TO DFHEIV0
 13293     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13294     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13295     MOVE X'204E233030303132353939' TO DFHEIV0(25:11)
 13296     CALL 'kxdfhei1' USING DFHEIV0,
 13297           ELCRTT-DSID,
 13298           CERTIFICATE-TRAILERS,
 13299           DFHEIV11,
 13300           cs-control-primary,
 13301           DFHEIV99,
 13302           DFHEIV99
 13303     MOVE EIBRESP  TO WS-RESPONSE
 13304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13305        end-if
 13306     END-IF
 13307
 13308     .
 13309 2220-exit.
 13310     exit.
 13311
 13312 2225-upd-crt-trlr.
 13313
 13314*    if instypei = 'P'
 13315*       move +1 to s1
 13316*    else
 13317*       MOVE +2 to s1
 13318*    end-if
 13319
 13320*    move +1 to s1
 13321*    evaluate cl-claim-type
 13322*       when 'A'
 13323*          move +1 to s2
 13324*       when 'I'
 13325*          move +2 to s2
 13326*       when 'G'
 13327*          move +3 to s2
 13328*       when 'L'
 13329*          move +4 to s2
 13330*       when 'P'
 13331*          move +5 to s2
 13332*    end-evaluate
 13333     perform varying s1 from +1 by +1 until
 13334        (s1 > +24)
 13335        or (cl-claim-no = cs-claim-no (s1))
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 255
* EL156.cbl
 13336     end-perform
 13337     if s1 < +25
 13338        compute cs-total-paid (s1) =
 13339           cs-total-paid (s1) + at-amount-paid
 13340        compute cs-days-paid (s1) =
 13341           cs-days-paid (s1) +  at-days-in-period
 13342*       compute cs-remaining-bens (s1) =
 13343*          cs-remaining-bens (s1) - (cs-days-paid (s1) / 30)
 13344        perform 2230-accum-bens-paid thru 2230-exit
 13345     end-if
 13346
 13347     .
 13348 2225-exit.
 13349     exit.
 13350 2230-accum-bens-paid.
 13351     if cl-claim-type not = 'L' and 'P'
 13352        move pi-ah-term          to ws-max-bens
 13353        if cl-critical-period not = zeros and spaces
 13354           move cl-critical-period
 13355                                 to ws-max-bens
 13356        end-if
 13357     else
 13358        move 01                  to ws-max-bens
 13359     end-if
 13360     move zeros to ws-tot-days-paid ws-tot-amt-paid
 13361     perform varying s2 from +1 by +1 until
 13362        (s2 > +24)
 13363        or (cs-claim-no (s2) = spaces)
 13364        if pi-company-id not = 'DCC'
 13365           if cs-claim-type (s2) = cl-claim-type
 13366              compute ws-tot-days-paid =
 13367                 ws-tot-days-paid + cs-days-paid (s2)
 13368              compute ws-tot-amt-paid =
 13369                 ws-tot-amt-paid + cs-total-paid (s2)
 13370           end-if
 13371        else
 13372           if (cs-benefit-period (s2) = cl-benefit-period)
 13373              and (cs-claim-type (s2) = cl-claim-type)
 13374              and (cs-insured-type (s2) = cl-insured-type)
 13375              compute ws-tot-days-paid =
 13376                 ws-tot-days-paid + cs-days-paid (s2)
 13377              compute ws-tot-amt-paid =
 13378                 ws-tot-amt-paid + cs-total-paid (s2)
 13379           end-if
 13380        end-if
 13381     end-perform
 13382     if cl-claim-type = 'L' and 'P'
 13383        if ws-tot-amt-paid > zeros
 13384           move zeros            to cs-remaining-bens (s1)
 13385        else
 13386           move 01               to cs-remaining-bens (s1)
 13387        end-if
 13388     else
 13389        compute ws-pd-bens rounded =
 13390           ws-tot-amt-paid / pi-ah-benefit-amt
 13391        compute cs-remaining-bens (s1) =
 13392           ws-max-bens - ws-pd-bens
 13393        if cs-remaining-bens (s1) < zeros
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 256
* EL156.cbl
 13394           move zeros            to cs-remaining-bens (s1)
 13395        end-if
 13396     end-if
 13397     .
 13398 2230-exit.
 13399     exit.
 13400 3000-MOVE-INPUT-TO-SAVE-AREA.
 13401     IF PMTTYPEL > 0
 13402         MOVE PMTTYPEI           TO WS-PMTTYPE.
 13403
 13404     MOVE SPACES                 TO PI-PROVISIONAL-IND.
 13405
 13406     IF WS-PMTTYPE = '9'
 13407         MOVE 'P'                TO PI-PROVISIONAL-IND
 13408         MOVE '1'                TO WS-PMTTYPE.
 13409
 13410     IF PAYEEL > 0
 13411         MOVE FUNCTION UPPER-CASE(PAYEEI) TO PAYEEI
 13412         MOVE PAYEEI             TO WS-PAYEE.
 13413
 13414     IF NOTE1L > +0
 13415         MOVE NOTE1I             TO WS-PMTNOTE1
 13416                                    WS-FLI-PMTNOTE
 13417                                    WS-HAN-PMTNOTE.
 13418
 13419     IF NOTE2L > +0
 13420         MOVE NOTE2I             TO WS-PMTNOTE2.
 13421
 13422     IF OFFLINEL > 0
 13423         MOVE OFFLINEI           TO WS-OFFLINE.
 13424
 13425     IF PROOFDTL > 0
 13426         MOVE PROOFDTI            TO DATE-WORK
 13427         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13428         MOVE NUM-WORK            TO DC-GREG-DATE-1-MDY
 13429         MOVE '4'                 TO DC-OPTION-CODE
 13430         PERFORM 9700-LINK-DATE-CONVERT THRU  9700-EXIT
 13431         IF NO-CONVERSION-ERROR
 13432            MOVE NUM-WORK         TO PROOFDTO
 13433            INSPECT PROOFDTI REPLACING ALL ' ' BY '/'
 13434            MOVE NUM-WORK         TO WS-PROOF-DATE
 13435         ELSE
 13436            MOVE ZEROS            TO WS-PROOF-DATE
 13437         END-IF
 13438     END-IF.
 13439
 13440     IF EOBYNL > +0
 13441         MOVE FUNCTION UPPER-CASE(EOBYNI) TO EOBYNI
 13442         MOVE EOBYNI              TO WS-PRINT-EOB-YN
 13443     END-IF
 13444
 13445     IF CLMFMYNL > +0
 13446         MOVE FUNCTION UPPER-CASE(CLMFMYNI) TO CLMFMYNI
 13447         MOVE CLMFMYNI            TO WS-PRINT-CLM-FRM-YN
 13448     END-IF
 13449
 13450     IF SURVYYNL > +0
 13451         MOVE FUNCTION UPPER-CASE(SURVYYNI) TO SURVYYNI
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 257
* EL156.cbl
 13452         MOVE SURVYYNI            TO WS-PRINT-SURVEY-YN
 13453     END-IF
 13454
 13455     IF SPRELYNL > +0
 13456         MOVE FUNCTION UPPER-CASE(SPRELYNI) TO SPRELYNI
 13457         MOVE SPRELYNI            TO WS-SPECIAL-RELEASE-YN
 13458     END-IF
 13459*    IF GROUPEDL > +0
 13460*        MOVE GROUPEDI           TO WS-GROUPED.
 13461*
 13462*    IF CASHL > +0
 13463*       MOVE CASHI               TO WS-CASH.
 13464     IF LOANNOL > +0
 13465         MOVE LOANNOI            TO WS-LOAN-NO.
 13466
 13467     IF CHECKNOL > 0
 13468         MOVE CHECKNOI           TO WS-CHECKNO, WS-AIG-CHECKNO.
 13469
 13470     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 13471         IF WS-AIG-CREDIT-ENTERED
 13472             MOVE WS-A-CHECKNO-6-7 TO WS-A-CHECKNO-1-2
 13473             MOVE ZEROS            TO WS-A-CHECKNO-3-7
 13474             MOVE WS-AIG-CHECKNO   TO WS-CHECKNO CHECKNOO
 13475             MOVE AL-UANON         TO CHECKNOA.
 13476
 13477     IF HOLDTILL > 0
 13478         MOVE HOLDTILI           TO DATE-WORK
 13479         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13480         MOVE NUM-WORK           TO WS-HOLDTIL.
 13481
 13482     IF ZINTL > +0
 13483
 13484* EXEC CICS BIF DEEDIT
 13485*           FIELD   (ZINTI)
 13486*           LENGTH  (07)
 13487*       END-EXEC
 13488     MOVE 07
 13489       TO DFHEIV11
 13490*    MOVE '@"L                   #   #00012783' TO DFHEIV0
 13491     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13492     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13493     MOVE X'2020233030303132373833' TO DFHEIV0(25:11)
 13494     CALL 'kxdfhei1' USING DFHEIV0,
 13495           ZINTI,
 13496           DFHEIV11
 13497     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13498        IF ZINTI NOT NUMERIC
 13499           MOVE ER-0419          TO EMI-ERROR
 13500           PERFORM 9900-ERROR-FORMAT
 13501           MOVE AL-UABON         TO ZINTA
 13502           MOVE -1               TO ZINTL
 13503        ELSE
 13504           MOVE ZINTI            TO CP-INT-RATE
 13505                                    WS-INT-RATE
 13506           MOVE CP-INT-RATE      TO ZINTO
 13507           MOVE AL-UNNON         TO ZINTA
 13508        END-IF
 13509     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 258
* EL156.cbl
 13510        MOVE ZEROS               TO CP-INT-RATE
 13511     END-IF
 13512     IF EPYFROML > 0
 13513         MOVE EPYFROMI           TO DATE-WORK
 13514         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13515         MOVE NUM-WORK           TO WS-EPYFROM.
 13516
 13517     IF AIGFROML > 0
 13518         MOVE AIGFROMI           TO DATE-WORK
 13519         PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13520         MOVE NUM-WORK           TO WS-AIGFROM
 13521     ELSE
 13522         IF (AIGFROMI = LOW-VALUES) AND
 13523            (PI-AIGFROM NOT = ZEROS)
 13524              MOVE 'Y' TO WS-RECALC-PAYFROM-SW.
 13525
 13526     IF EPYTHRUL > +0
 13527        MOVE EPYTHRUI           TO DATE-WORK
 13528        PERFORM 3100-DEEDIT-DATE THRU 3100-EXIT
 13529        MOVE NUM-WORK           TO WS-EPYTHRU
 13530        MOVE WS-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13531        MOVE '4'                TO DC-OPTION-CODE
 13532        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13533        IF NO-CONVERSION-ERROR
 13534           IF PI-USES-PAID-TO
 13535              MOVE '6'                TO DC-OPTION-CODE
 13536              MOVE -1                 TO DC-ELAPSED-DAYS
 13537              MOVE +0                 TO DC-ELAPSED-MONTHS
 13538              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13539              IF NO-CONVERSION-ERROR
 13540                 MOVE DC-BIN-DATE-2   TO DC-BIN-DATE-1
 13541                 MOVE ' '             TO DC-OPTION-CODE
 13542                 MOVE +0              TO DC-ELAPSED-DAYS
 13543                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13544              IF NO-CONVERSION-ERROR
 13545                 MOVE DC-GREG-DATE-1-MDY TO WS-EPYTHRU.
 13546
 13547*****DEEDIT DAYS AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13548*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13549     IF EDAYSL > 0
 13550
 13551* EXEC CICS BIF DEEDIT
 13552*            FIELD(EDAYSI)
 13553*            LENGTH(6)
 13554*        END-EXEC
 13555     MOVE 6
 13556       TO DFHEIV11
 13557*    MOVE '@"L                   #   #00012839' TO DFHEIV0
 13558     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13559     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13560     MOVE X'2020233030303132383339' TO DFHEIV0(25:11)
 13561     CALL 'kxdfhei1' USING DFHEIV0,
 13562           EDAYSI,
 13563           DFHEIV11
 13564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13565         MOVE EDAYSI             TO WS-DY-WORK
 13566         IF WS-DY-SIGN = SPACES
 13567            MOVE WS-DY-NUM       TO WS-EDAYS
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 259
* EL156.cbl
 13568            ADD 0                TO WS-EDAYS
 13569         ELSE
 13570            MOVE EDAYSI          TO WS-EDAYS
 13571            ADD 0                TO WS-EDAYS.
 13572
 13573*****DEEDIT PAYMENT AND ADD ZERO IN ORDER TO SET A 'C' SIGN
 13574*****THAT WILL BE NEEDED LATER FOR A GROUP TEST.
 13575     IF EPYAMTL > 0
 13576
 13577* EXEC CICS BIF DEEDIT
 13578*            FIELD(EPYAMTI)
 13579*            LENGTH(10)
 13580*        END-EXEC
 13581     MOVE 10
 13582       TO DFHEIV11
 13583*    MOVE '@"L                   #   #00012854' TO DFHEIV0
 13584     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13585     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13586     MOVE X'2020233030303132383534' TO DFHEIV0(25:11)
 13587     CALL 'kxdfhei1' USING DFHEIV0,
 13588           EPYAMTI,
 13589           DFHEIV11
 13590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13591         MOVE EPYAMTI            TO WS-PY-WORK
 13592         IF WS-PY-SIGN = SPACES
 13593            MOVE WS-PY-NUM       TO WS-EPYAMT
 13594            ADD 0                TO WS-EPYAMT
 13595         ELSE
 13596            MOVE EPYAMTI         TO WS-EPYAMT
 13597            ADD 0                TO WS-EPYAMT.
 13598
 13599     IF ERESVL > 0
 13600
 13601* EXEC CICS BIF DEEDIT
 13602*            FIELD(ERESVI)
 13603*            LENGTH(9)
 13604*        END-EXEC
 13605     MOVE 9
 13606       TO DFHEIV11
 13607*    MOVE '@"L                   #   #00012867' TO DFHEIV0
 13608     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13609     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13610     MOVE X'2020233030303132383637' TO DFHEIV0(25:11)
 13611     CALL 'kxdfhei1' USING DFHEIV0,
 13612           ERESVI,
 13613           DFHEIV11
 13614     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13615         MOVE ERESVI TO WS-ERESV.
 13616
 13617     IF EEXPENSL > 0
 13618
 13619* EXEC CICS BIF DEEDIT
 13620*            FIELD(EEXPENSI)
 13621*            LENGTH(8)
 13622*        END-EXEC
 13623     MOVE 8
 13624       TO DFHEIV11
 13625*    MOVE '@"L                   #   #00012874' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 260
* EL156.cbl
 13626     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13627     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13628     MOVE X'2020233030303132383734' TO DFHEIV0(25:11)
 13629     CALL 'kxdfhei1' USING DFHEIV0,
 13630           EEXPENSI,
 13631           DFHEIV11
 13632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13633         MOVE EEXPENSI           TO WS-EEXPENS.
 13634
 13635     IF ETYPEL > ZEROS
 13636         MOVE ETYPEI             TO WS-ETYPE.
 13637
 13638     IF PI-COMPANY-ID = 'BOA'
 13639        IF PINTL > ZEROS
 13640
 13641* EXEC CICS BIF DEEDIT
 13642*            FIELD (PINTI)
 13643*            LENGTH(05)
 13644*          END-EXEC
 13645     MOVE 05
 13646       TO DFHEIV11
 13647*    MOVE '@"L                   #   #00012885' TO DFHEIV0
 13648     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13649     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13650     MOVE X'2020233030303132383835' TO DFHEIV0(25:11)
 13651     CALL 'kxdfhei1' USING DFHEIV0,
 13652           PINTI,
 13653           DFHEIV11
 13654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13655           IF PINTI NUMERIC
 13656               MOVE AL-UNNON     TO PINTA
 13657               MOVE PINTI        TO WS-INT-RATE
 13658               MOVE WS-INT-RATE  TO PINTO.
 13659
 13660 3000-EXIT.
 13661     EXIT.
 13662
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 261
* EL156.cbl
 13664 3050-REBUILD-ENTERED.
 13665
 13666     MOVE PI-SAVE-INPUT TO WS-SAVE-INPUT.
 13667
 13668     IF PI-PROV-PMT
 13669         MOVE '9'           TO PMTTYPEO
 13670     ELSE
 13671         MOVE PI-PMTTYPE    TO PMTTYPEO.
 13672
 13673     MOVE PI-PAYEE          TO PAYEEO.
 13674     MOVE PI-PMTNOTE1       TO NOTE1O.
 13675     MOVE PI-PMTNOTE2       TO NOTE2O.
 13676     MOVE PI-OFFLINE        TO OFFLINEO.
 13677     IF PI-PROOF-DATE NOT = ZEROS
 13678         MOVE PI-PROOF-DATE TO PROOFDTO
 13679         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 13680     END-IF.
 13681*    MOVE PI-GROUPED        TO GROUPEDO.
 13682
 13683*    MOVE PI-CASH           TO CASHO.
 13684
 13685     IF PI-INT-RATE > ZEROS
 13686         MOVE PI-INT-RATE   TO PINTO.
 13687
 13688     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 13689        IF PI-INT-AMT > ZEROS
 13690           MOVE PI-INT-AMT       TO PINTO
 13691           MOVE AL-PANOF         TO PINTA
 13692                                    PINTHA
 13693        END-IF
 13694     END-IF
 13695     MOVE PI-PRINT-EOB-YN        TO EOBYNI
 13696     MOVE PI-PRINT-CLM-FRM-YN    TO CLMFMYNI
 13697     MOVE PI-PRINT-SURVEY-YN     TO SURVYYNI
 13698     MOVE PI-SPECIAL-RELEASE-YN  TO SPRELYNI
 13699     IF PI-HOLDTIL NOT = ZEROS
 13700        MOVE PI-HOLDTIL          TO HOLDTILO
 13701        INSPECT HOLDTILO REPLACING ALL SPACES BY '/'.
 13702
 13703     IF PI-EPYFROM NOT = ZEROS
 13704        MOVE PI-EPYFROM          TO EPYFROMO
 13705        INSPECT EPYFROMO REPLACING ALL SPACES BY '/'.
 13706
 13707     IF PI-AIGFROM NOT = ZEROS
 13708        MOVE PI-AIGFROM          TO AIGFROMO
 13709        INSPECT AIGFROMO REPLACING ALL SPACES BY '/'.
 13710
 13711     IF PI-EPYTHRU NOT = ZEROS
 13712        MOVE PI-EPYTHRU          TO EPYTHRUO
 13713        INSPECT EPYTHRUO REPLACING ALL SPACES BY '/'
 13714        IF PI-USES-PAID-TO
 13715           MOVE PI-EPYTHRU         TO DC-GREG-DATE-1-MDY
 13716           MOVE '4'                TO DC-OPTION-CODE
 13717           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13718           IF NO-CONVERSION-ERROR
 13719              MOVE +1 TO DC-ELAPSED-DAYS
 13720              MOVE +0 TO DC-ELAPSED-MONTHS
 13721              MOVE '6' TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 262
* EL156.cbl
 13722              PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13723              IF NO-CONVERSION-ERROR
 13724                 MOVE DC-GREG-DATE-1-EDIT TO EPYTHRUI.
 13725
 13726     IF PI-EDAYS NOT = ZEROS
 13727        MOVE PI-EDAYS TO EDAYSO.
 13728
 13729     IF PI-EPYAMT NOT = ZEROS
 13730        MOVE PI-EPYAMT TO EPYAMTO.
 13731
 13732     IF PI-ERESV NOT = ZEROS
 13733        MOVE PI-ERESV TO ERESVO.
 13734
 13735     IF PI-EEXPENS NOT = ZEROS
 13736        MOVE PI-EEXPENS TO EEXPENSO.
 13737
 13738     MOVE PI-ETYPE TO ETYPEO.
 13739
 13740     IF PI-ECHECKNO NOT = SPACES
 13741        MOVE PI-ECHECKNO         TO CHECKNOO
 13742     ELSE
 13743        MOVE PI-CCHECKNO         TO CHECKNOO.
 13744
 13745     MOVE PI-CPYFROM             TO DC-BIN-DATE-1.
 13746     MOVE SPACES                 TO DC-OPTION-CODE.
 13747     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13748
 13749     IF DATE-CONVERSION-ERROR
 13750        MOVE SPACES              TO CPYFROMI
 13751     ELSE
 13752        MOVE DC-GREG-DATE-1-EDIT TO CPYFROMI.
 13753
 13754     IF PI-USES-PAID-TO
 13755        MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 13756        MOVE +1                  TO DC-ELAPSED-DAYS
 13757        MOVE +0                  TO DC-ELAPSED-MONTHS
 13758        MOVE '6'                 TO DC-OPTION-CODE
 13759        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 13760        IF NO-CONVERSION-ERROR
 13761           MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI
 13762           GO TO 3051-CONTINUE.
 13763
 13764     MOVE PI-CPYTHRU             TO DC-BIN-DATE-1.
 13765     MOVE SPACES                 TO DC-OPTION-CODE.
 13766     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13767
 13768     IF DATE-CONVERSION-ERROR
 13769        MOVE SPACES              TO CPYTHRUI
 13770     ELSE
 13771        MOVE DC-GREG-DATE-1-EDIT TO CPYTHRUI.
 13772
 13773 3051-CONTINUE.
 13774
 13775     IF PI-CDAYS NOT = ZEROS
 13776        MOVE PI-CDAYS TO CDAYSO.
 13777
 13778     IF PI-CPYAMT NOT = ZEROS
 13779        MOVE PI-CPYAMT TO CPYAMTO.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 263
* EL156.cbl
 13780
 13781     IF PI-CRESV NOT = ZEROS
 13782        MOVE PI-CRESV TO CRESVO.
 13783
 13784     IF PI-CEXPENS NOT = ZEROS
 13785        MOVE PI-CEXPENS TO CEXPENSO.
 13786
 13787 3059-EXIT.
 13788     EXIT.
 13789
 13790 3100-DEEDIT-DATE.
 13791
 13792* EXEC CICS BIF DEEDIT
 13793*        FIELD(DATE-WORK)
 13794*        LENGTH(8)
 13795*    END-EXEC.
 13796     MOVE 8
 13797       TO DFHEIV11
 13798*    MOVE '@"L                   #   #00013025' TO DFHEIV0
 13799     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 13800     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13801     MOVE X'2020233030303133303235' TO DFHEIV0(25:11)
 13802     CALL 'kxdfhei1' USING DFHEIV0,
 13803           DATE-WORK,
 13804           DFHEIV11
 13805     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13806
 13807
 13808 3100-EXIT.
 13809     EXIT.
 13810
 13811 3200-CALC-AIG-DAYS.
 13812
 13813     MOVE 'N'                    TO WS-DUE-DAY-SW.
 13814
 13815     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 13816     MOVE ' '                    TO DC-OPTION-CODE.
 13817     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13818     IF NO-CONVERSION-ERROR
 13819         MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-INC-MDY
 13820     ELSE
 13821         GO TO 3290-ERROR.
 13822
 13823     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13824         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13825                                WS-BIN-FROM-DT
 13826     ELSE
 13827         IF CL-TOTAL-PAID-AMT > ZEROS
 13828             IF WS-SV-EPYFROM = LOW-VALUES
 13829                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 13830                                        WS-BIN-FROM-DT
 13831             ELSE
 13832                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 13833                                        WS-BIN-FROM-DT
 13834         ELSE
 13835             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 13836                                        WS-BIN-FROM-DT.
 13837
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 264
* EL156.cbl
 13838 3210-CONTINUE.
 13839
 13840     MOVE ' '                    TO DC-OPTION-CODE.
 13841     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13842     IF DATE-CONVERSION-ERROR
 13843         GO TO 3290-ERROR.
 13844
 13845     MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY.
 13846
 13847     IF PI-LOAN-DUE-DAY = 31
 13848         MOVE 30              TO WS-PMT-DUE-DA
 13849                                 WS-SAVE-DUE-DA
 13850     ELSE
 13851         MOVE PI-LOAN-DUE-DAY TO WS-PMT-DUE-DA
 13852                                 WS-SAVE-DUE-DA.
 13853
 13854     IF (PI-LOAN-DUE-DAY > 28) AND
 13855        (WS-PMT-DUE-MO = 2)
 13856         MOVE 'Y'                TO WS-DUE-DAY-SW
 13857         MOVE 28                 TO WS-PMT-DUE-DA.
 13858
 13859     MOVE WS-PMT-DUE-MDY         TO DC-GREG-DATE-1-MDY.
 13860     MOVE '4'                    TO DC-OPTION-CODE.
 13861     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13862     IF NO-CONVERSION-ERROR
 13863         MOVE DC-BIN-DATE-1      TO WS-PMT-DUE-DT
 13864     ELSE
 13865         GO TO 3290-ERROR.
 13866
 13867*--------------------------------------------------------------*
 13868*    IF THE 1ST LOAN PMT DATE LESS THAN INCURRED DATE          *
 13869*    AND THE EFFECTIVE DAY LESS THAN INCURRED DAY              *
 13870*    ADD ONE MONTH TO THE CURRENT PAYMENT DUE DATE             *
 13871*                                                              *
 13872*    EXAMPLE: CERT LOAN PMT DUE  - 05/03/87                    *
 13873*             INCURRED DATE      - 04/15/91                    *
 13874*             PMT DUE DATE       - 04/03/91                    *
 13875*             PMT DUE DATE       - 05/03/91                    *
 13876*--------------------------------------------------------------*
 13877
 13878     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13879        (WS-SV-AIGFROM = LOW-VALUES)
 13880         IF (WS-PMT-DUE-MO = WS-TEMP-INC-MO) AND
 13881            (WS-PMT-DUE-DA < WS-TEMP-INC-DA)
 13882             MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13883             PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13884             IF NO-CONVERSION-ERROR
 13885                 MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13886                 MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13887             ELSE
 13888                 GO TO 3290-ERROR.
 13889
 13890     IF (CL-TOTAL-PAID-AMT NOT > ZEROS)  AND
 13891        (WS-SV-AIGFROM = LOW-VALUES)
 13892         GO TO 3205-CONT-CALC-PMT.
 13893
 13894     MOVE WS-BIN-FROM-DT         TO DC-BIN-DATE-1.
 13895     MOVE ' '                    TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 265
* EL156.cbl
 13896     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13897     IF NO-CONVERSION-ERROR
 13898         MOVE DC-GREG-DATE-1-MDY     TO WS-FROM-DATE-MDY
 13899     ELSE
 13900         GO TO 3290-ERROR.
 13901
 13902     IF (WS-PMT-DUE-MO = WS-FROM-MO) AND
 13903        (WS-PMT-DUE-DA < WS-FROM-DA)
 13904          MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1
 13905          PERFORM 3300-BUMP-DATE THRU 3399-EXIT
 13906          IF NO-CONVERSION-ERROR
 13907              MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13908              MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13909          ELSE
 13910              GO TO 3290-ERROR.
 13911
 13912 3205-CONT-CALC-PMT.
 13913
 13914*--------------------------------------------------------------*
 13915*    VERIFY THAT THE SYSTEM CALCULATED LOAN PAYMENT DATE FALLS *
 13916*    BETWEEN THE PAY FROM / THRU DATES.                        *
 13917*--------------------------------------------------------------*
 13918
 13919     IF CL-TOTAL-PAID-AMT = ZEROS AND
 13920        PI-PMTTYPE = '2'
 13921          NEXT SENTENCE
 13922     ELSE
 13923        IF (WS-PMT-DUE-DT < WS-BIN-FROM-DT) OR
 13924           (WS-PMT-DUE-DT > WS-SV-EPYTHRU)
 13925             MOVE WS-PMT-DUE-MDY     TO EMI-DATE-FIELD
 13926             MOVE ER-3527            TO EMI-ERROR
 13927             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13928             MOVE -1                 TO EPYTHRUL
 13929             MOVE AL-UNBON           TO EPYTHRUA
 13930                                        EPYFROMA
 13931             GO TO 3299-EXIT.
 13932
 13933*--------------------------------------------------------------*
 13934*    CALCULATE RETRO ELIMINATION DATE                          *
 13935*--------------------------------------------------------------*
 13936
 13937     IF WS-SV-AIGFROM NOT = LOW-VALUES
 13938         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 13939     ELSE
 13940         MOVE CL-INCURRED-DT TO DC-BIN-DATE-1.
 13941
 13942     MOVE PI-BEN-DAYS    TO DC-ELAPSED-DAYS.
 13943     MOVE +0             TO DC-ELAPSED-MONTHS.
 13944     MOVE '6'            TO DC-OPTION-CODE.
 13945     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 13946     IF NO-CONVERSION-ERROR
 13947         MOVE DC-BIN-DATE-2 TO WS-RETRO-ELIM-DT
 13948     ELSE
 13949         GO TO 3290-ERROR.
 13950
 13951 3210-CHECK-PMT-DATE.
 13952
 13953*--------------------------------------------------------------*
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 266
* EL156.cbl
 13954*    VERIFY THAT THE CALCULATED LOAN DUE DATE FALLS AFTER      *
 13955*    THE ENTERED PAY FROM DATE                                 *
 13956*--------------------------------------------------------------*
 13957
 13958     IF WS-PMT-DUE-DT < WS-SV-EPYFROM
 13959         NEXT SENTENCE
 13960     ELSE
 13961         GO TO 3220-COMPUTE-DAYS.
 13962
 13963     MOVE WS-PMT-DUE-DT      TO DC-BIN-DATE-1.
 13964     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13965     IF NO-CONVERSION-ERROR
 13966         MOVE DC-BIN-DATE-2      TO WS-PMT-DUE-DT
 13967         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13968         GO TO 3210-CHECK-PMT-DATE
 13969     ELSE
 13970         GO TO 3290-ERROR.
 13971
 13972 3220-COMPUTE-DAYS.
 13973
 13974     MOVE WS-PMT-DUE-DT TO WS-NEXT-PMT-DUE-DT.
 13975     MOVE ZEROS         TO WS-CDAYS.
 13976     MOVE 'N'           TO WS-ELIMINATION-SW.
 13977
 13978*--------------------------------------------------------------*
 13979*    COMPUTE CALIFORNIA DUE DAYS                               *
 13980*--------------------------------------------------------------*
 13981
 13982     IF CL-TOTAL-PAID-AMT > ZEROS
 13983         MOVE 'Y' TO WS-ELIMINATION-SW
 13984         GO TO 3240-FIRST-PMT-DUE
 13985     ELSE
 13986        IF WS-RETRO-ELIM-DT > WS-PMT-DUE-DT
 13987            NEXT SENTENCE
 13988        ELSE
 13989            GO TO 3240-FIRST-PMT-DUE.
 13990
 13991 3230-NEXT-PMT-DUE.
 13992
 13993     MOVE WS-NEXT-PMT-DUE-DT TO DC-BIN-DATE-1.
 13994     PERFORM 3300-BUMP-DATE THRU 3399-EXIT.
 13995     IF NO-CONVERSION-ERROR
 13996         MOVE DC-BIN-DATE-2 TO WS-NEXT-PMT-DUE-DT
 13997         MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 13998     ELSE
 13999         GO TO 3290-ERROR.
 14000
 14001 3240-FIRST-PMT-DUE.
 14002
 14003     IF CL-TOTAL-PAID-AMT > ZEROS
 14004         NEXT SENTENCE
 14005     ELSE
 14006        IF WS-RETRO-ELIM-DT > WS-NEXT-PMT-DUE-DT
 14007            GO TO 3230-NEXT-PMT-DUE.
 14008
 14009     IF WS-NEXT-PMT-DUE-DT > WS-SV-EPYTHRU
 14010         GO TO 3250-VERIFY-ELIMINATION.
 14011
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 267
* EL156.cbl
 14012     ADD +30 TO WS-CDAYS.
 14013     MOVE 'Y' TO WS-ELIMINATION-SW.
 14014     GO TO 3230-NEXT-PMT-DUE.
 14015
 14016 3250-VERIFY-ELIMINATION.
 14017
 14018     IF ELIM-SATISFIED
 14019         GO TO 3260-END-CALC.
 14020
 14021     IF PI-PMTTYPE = '1'
 14022         MOVE ZEROS TO WS-CDAYS
 14023         GO TO 3260-END-CALC.
 14024
 14025     IF WS-SV-AIGFROM NOT = LOW-VALUES
 14026         MOVE WS-SV-AIGFROM  TO DC-BIN-DATE-1
 14027     ELSE
 14028         IF CL-TOTAL-PAID-AMT > ZEROS
 14029             IF WS-SV-EPYFROM = LOW-VALUES
 14030                 MOVE PI-CPYFROM     TO DC-BIN-DATE-1
 14031             ELSE
 14032                 MOVE WS-SV-EPYFROM  TO DC-BIN-DATE-1
 14033         ELSE
 14034             MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1.
 14035
 14036     MOVE WS-SV-EPYTHRU          TO DC-BIN-DATE-2.
 14037     MOVE '1'                    TO DC-OPTION-CODE.
 14038     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14039     IF NO-CONVERSION-ERROR
 14040         COMPUTE WS-DAYS-OFF =  DC-ELAPSED-DAYS + 1
 14041     ELSE
 14042         GO TO 3290-ERROR.
 14043
 14044     IF CL-TOTAL-PAID-AMT > ZEROS
 14045         MOVE WS-DAYS-OFF TO WS-CDAYS
 14046     ELSE
 14047         IF PI-BEN-DAYS > WS-DAYS-OFF
 14048             MOVE ZEROS TO WS-CDAYS
 14049         ELSE
 14050             COMPUTE WS-CDAYS = WS-DAYS-OFF - PI-BEN-DAYS.
 14051
 14052 3260-END-CALC.
 14053
 14054     MOVE WS-CDAYS TO PI-CDAYS.
 14055
 14056     IF PI-EDAYS = ZEROS
 14057         MOVE PI-CDAYS TO PI-EDAYS
 14058         MOVE AL-UNNON TO EDAYSA.
 14059
 14060     GO TO 3299-EXIT.
 14061
 14062 3290-ERROR.
 14063
 14064     MOVE ER-3528            TO EMI-ERROR.
 14065     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14066     MOVE -1                 TO CDAYSL.
 14067     MOVE AL-UNBON           TO CDAYSA.
 14068
 14069 3299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 268
* EL156.cbl
 14070     EXIT.
 14071
 14072 3300-BUMP-DATE.
 14073
 14074     IF WS-RESTORE-DUE-DAY
 14075         MOVE 'N'              TO WS-DUE-DAY-SW
 14076         MOVE WS-SAVE-DUE-DA   TO WS-PMT-DUE-DA
 14077         ADD 1                 TO WS-PMT-DUE-MO
 14078         MOVE WS-PMT-DUE-MDY   TO DC-GREG-DATE-1-MDY
 14079         MOVE '4'              TO DC-OPTION-CODE
 14080         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 14081         IF NO-CONVERSION-ERROR
 14082             MOVE DC-GREG-DATE-1-MDY TO WS-PMT-DUE-MDY
 14083             MOVE DC-BIN-DATE-1      TO DC-BIN-DATE-2
 14084             GO TO 3399-EXIT
 14085         ELSE
 14086             MOVE '9'          TO DC-ERROR-CODE
 14087             GO TO 3399-EXIT.
 14088
 14089     IF (WS-PMT-DUE-MO = 1) AND
 14090        (WS-SAVE-DUE-DA > 28)
 14091           MOVE 'Y' TO WS-DUE-DAY-SW.
 14092
 14093     MOVE +0                 TO DC-ELAPSED-DAYS.
 14094     MOVE +1                 TO DC-ELAPSED-MONTHS.
 14095     MOVE '6'                TO DC-OPTION-CODE.
 14096     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14097
 14098 3399-EXIT.
 14099     EXIT.
 14100
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 269
* EL156.cbl
 14102 3400-COMPUTE-EXPIRY.
 14103
 14104     MOVE CM-LOAN-1ST-PMT-DT    TO DC-BIN-DATE-1.
 14105     MOVE +0                    TO DC-ELAPSED-DAYS
 14106                                   DC-ODD-DAYS-OVER.
 14107     MOVE '1'                   TO DC-END-OF-MONTH.
 14108     MOVE '6'                   TO DC-OPTION-CODE.
 14109
 14110     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14111         COMPUTE DC-ELAPSED-MONTHS = CM-LF-ORIG-TERM - +1
 14112     ELSE
 14113         COMPUTE DC-ELAPSED-MONTHS = CM-AH-ORIG-TERM - +1.
 14114
 14115     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14116     IF NO-CONVERSION-ERROR
 14117         MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT
 14118     ELSE
 14119         GO TO 3390-CONTINUE.
 14120
 14121     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14122         GO TO 3390-CONTINUE.
 14123
 14124     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 14125     MOVE '4'                    TO CNTL-REC-TYPE.
 14126     MOVE +0                     TO CNTL-SEQ-NO.
 14127     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 14128     MOVE WS-ACCESS              TO CNTL-ACCESS.
 14129     MOVE 'BENE'                 TO FILE-SWITCH.
 14130
 14131     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 14132
 14133     IF NO-BENEFIT-FOUND
 14134         GO TO 3390-CONTINUE.
 14135
 14136     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 14137        IF (PI-OFFLINE = 'Y') OR
 14138           (PI-PMTTYPE = '7')
 14139           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 14140                                     THRU 9870-EXIT
 14141           IF ERROR-ON-OUTPUT
 14142             MOVE -1                 TO ENTERPFL
 14143             MOVE AL-UANON           TO ENTERPFA
 14144             MOVE MAP-NAMEA          TO MAP-NAME
 14145             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14146             GO TO 8200-SEND-DATAONLY.
 14147
 14148     IF (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)  AND
 14149        (CF-CO-EARNINGS-CALC (SUB-1) = 'B' OR 'K' OR 'L') AND
 14150        (CF-SPECIAL-CALC-CD  (SUB-1) = 'L')
 14151          MOVE WS-EXP-DT TO DC-BIN-DATE-1
 14152          MOVE +0        TO DC-ELAPSED-DAYS
 14153          MOVE +1        TO DC-ELAPSED-MONTHS
 14154          MOVE 6         TO DC-OPTION-CODE
 14155          PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14156          IF NO-CONVERSION-ERROR
 14157              MOVE DC-BIN-DATE-2  TO WS-EXP-DT PI-EXP-DT.
 14158
 14159 3390-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 270
* EL156.cbl
 14160
 14161      IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 14162         MOVE CM-AH-LOAN-EXPIRE-DT
 14163                                 TO DC-BIN-DATE-1
 14164      ELSE
 14165         MOVE CM-LF-LOAN-EXPIRE-DT
 14166                                 TO DC-BIN-DATE-1
 14167      END-IF
 14168
 14169      MOVE ' '                    TO DC-OPTION-CODE.
 14170      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 14171      MOVE DC-GREG-DATE-1-MDY     TO WS-TEMP-DATE-MDY.
 14172      MOVE WS-TEMP-DA             TO PI-LOAN-DUE-DAY.
 14173
 14174 3499-EXIT.
 14175     EXIT.
 14176
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 271
* EL156.cbl
 14178
 14179 3600-CHECK-VERIFICATION.
 14180
 14181     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14182
 14183     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14184
 14185     IF PI-PAYEE-TYPE = 'I'
 14186        GO TO 3600-READ-TRAILER.
 14187
 14188     IF PI-PAYEE-TYPE = 'B'
 14189        ADD +10                  TO TRLR-SEQ-NO
 14190        GO TO 3600-READ-TRAILER.
 14191
 14192     IF PI-PAYEE-TYPE = 'A'
 14193        ADD +20                  TO TRLR-SEQ-NO
 14194        GO TO 3600-READ-TRAILER.
 14195
 14196     IF PI-PAYEE-TYPE = 'O'
 14197        ADD +50                  TO TRLR-SEQ-NO
 14198        GO TO 3600-READ-TRAILER.
 14199
 14200     IF PI-PAYEE-TYPE = 'Q'
 14201        ADD +60                  TO TRLR-SEQ-NO
 14202        GO TO 3600-READ-TRAILER.
 14203
 14204     IF PI-PAYEE-TYPE = 'P'
 14205        ADD +30                  TO TRLR-SEQ-NO
 14206        GO TO 3600-READ-TRAILER.
 14207
 14208     IF PI-PAYEE-TYPE = 'E'
 14209        ADD +40                  TO TRLR-SEQ-NO.
 14210
 14211 3600-READ-TRAILER.
 14212
 14213
 14214* EXEC CICS HANDLE CONDITION
 14215*         NOTFND(3600-CONTINUE)
 14216*    END-EXEC.
 14217*    MOVE '"$I                   ! - #00013435' TO DFHEIV0
 14218     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14219     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14220     MOVE X'2D20233030303133343335' TO DFHEIV0(25:11)
 14221     CALL 'kxdfhei1' USING DFHEIV0
 14222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14223
 14224
 14225     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14226
 14227 3600-CONTINUE.
 14228
 14229     IF CL-CLAIM-TYPE NOT = PI-LIFE-OVERRIDE-L1
 14230         GO TO 3600-AH-VERIFY
 14231     END-IF.
 14232
 14233     IF PI-VFY-2ND-BENE = 'L' OR 'B'
 14234       IF AT-MAIL-TO-NAME (1:9) <> 'ESTATE OF'
 14235         IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 272
* EL156.cbl
 14236           MOVE ER-7576            TO EMI-ERROR
 14237           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14238           MOVE -1                 TO PAYEEL
 14239           MOVE AL-UABON           TO PAYEEA
 14240           GO TO 3600-EXIT
 14241         END-IF
 14242       END-IF
 14243     END-IF.
 14244
 14245     MOVE AT-MAIL-TO-NAME TO WS-WORK-NAME.
 14246     MOVE 1 TO WS-SUB2
 14247     MOVE SPACES TO WS-PAYEE-NAME
 14248     PERFORM VARYING WS-SUB FROM 1 BY 1
 14249             UNTIL WS-SUB > 30
 14250         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14251            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14252                 WS-PAYEE-NAME-X (WS-SUB2)
 14253            ADD +1 TO WS-SUB2
 14254         END-IF
 14255     END-PERFORM.
 14256
 14257     STRING CL-INSURED-1ST-NAME
 14258            CL-INSURED-MID-INIT
 14259            CL-INSURED-LAST-NAME INTO WS-WORK-NAME.
 14260     MOVE 1 TO WS-SUB2
 14261     MOVE SPACES TO WS-INSURED-NAME
 14262     PERFORM VARYING WS-SUB FROM 1 BY 1
 14263             UNTIL WS-SUB > 30
 14264         IF WS-WORK-NAME-X (WS-SUB) > SPACES
 14265            MOVE WS-WORK-NAME-X (WS-SUB) TO
 14266                 WS-INSURED-NAME-X (WS-SUB2)
 14267            ADD +1 TO WS-SUB2
 14268         END-IF
 14269     END-PERFORM.
 14270
 14271     IF WS-PAYEE-NAME = WS-INSURED-NAME
 14272        MOVE ER-7579            TO EMI-ERROR
 14273        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14274        MOVE -1                 TO PAYEEL
 14275        MOVE AL-UABON           TO PAYEEA
 14276     END-IF.
 14277
 14278     IF PI-PMTTYPE = '4'  AND
 14279        WS-PAYEE-NAME (1:8) = 'ESTATEOF'  AND
 14280        PI-PAYEE-TYPE <> 'I'
 14281          MOVE ER-7580          TO EMI-ERROR
 14282          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14283          MOVE -1               TO PAYEEL
 14284          MOVE AL-UABON         TO PAYEEA
 14285     END-IF.
 14286
 14287     GO TO 3600-EXIT.
 14288
 14289 3600-AH-VERIFY.
 14290
 14291     IF PI-VFY-2ND-BENE = 'A' OR 'B'
 14292        IF AT-VFY-2ND-BENE-VERIFIED <> 'Y'
 14293           MOVE ER-7583            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 273
* EL156.cbl
 14294           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14295           MOVE -1                 TO PAYEEL
 14296           MOVE AL-UABON           TO PAYEEA
 14297        END-IF
 14298     END-IF.
 14299
 14300
 14301 3600-EXIT.
 14302     EXIT.
 14303
 14304 5000-UPDATE.
 14305
 14306     PERFORM 7300-CHECK-AUTO-ACTIVITY THRU 7399-EXIT.
 14307
 14308     PERFORM 6200-UPDATE-CLAIM-MSTR THRU 6299-EXIT.
 14309
 14310     IF PI-PMTTYPE = '4' AND PI-EPYAMT NEGATIVE  OR
 14311        PI-OFFLINE = 'Y'
 14312        NEXT SENTENCE
 14313     ELSE
 14314        PERFORM 6700-UPDATE-ACTQ THRU 6799-EXIT.
 14315
 14316*    IF PI-COMPANY-ID = 'CRI'
 14317*       IF PI-PMTTYPE = '1' OR  '2'
 14318*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14319*             PERFORM 6800-BUILD-FORM-TRAILER   THRU 6899-EXIT
 14320*             PERFORM 6900-BUILD-ARCHIVE-HEADER THRU 6999-EXIT.
 14321
 14322*    IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 14323*       IF PI-PMTTYPE = '1'
 14324*          IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 14325*             PERFORM 6800-BUILD-FORM-TRAILER THRU 6899-EXIT.
 14326
 14327     IF PI-PMTTYPE      = '2' AND
 14328        PI-SPLIT-PMT-SW = 'Y' AND
 14329        CL-CLAIM-TYPE   = PI-LIFE-OVERRIDE-L1
 14330          MOVE ER-3530                TO EMI-ERROR
 14331          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14332
 14333     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 14334        AND (CL-CLAIM-TYPE = 'L')
 14335        IF PI-PMTTYPE = '2' OR '4'
 14336           IF PI-INT-AMT NOT = ZEROS
 14337              PERFORM 7110-BUILD-PMT-TRLR
 14338                                 THRU 7130-EXIT
 14339           ELSE
 14340              IF PI-PMTTYPE = '2'
 14341                 PERFORM 7140-BUILD-NOTE-TRLR
 14342                                 THRU 7170-EXIT
 14343              END-IF
 14344           END-IF
 14345        END-IF
 14346     END-IF
 14347*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 14348*        IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 14349*            MOVE 'N'                 TO  WS-LETTER-SW.
 14350
 14351*    IF PI-COMPANY-ID = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 274
* EL156.cbl
 14352*        IF CL-NO-OF-PMTS-MADE = +1
 14353*                OR
 14354*           PI-PMTTYPE = '2'
 14355*            PERFORM 5300-CREATE-DMO THRU 5300-EXIT.
 14356
 14357     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
 14358
 14359*    IF PI-COMPANY-ID = 'DMD'
 14360*       IF CL-CERT-NO (5:2) = '69' OR '70'
 14361*           PERFORM 6600-UPDATE-DLO035 THRU 6600-EXIT.
 14362
 14363
 14364* EXEC CICS REWRITE
 14365*         DATASET('ELMSTR')
 14366*         FROM(CLAIM-MASTER)
 14367*     END-EXEC.
 14368     MOVE LENGTH OF
 14369      CLAIM-MASTER
 14370       TO DFHEIV11
 14371     MOVE 'ELMSTR' TO DFHEIV1
 14372*    MOVE '&& L                  %   #00013577' TO DFHEIV0
 14373     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 14374     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 14375     MOVE X'2020233030303133353737' TO DFHEIV0(25:11)
 14376     CALL 'kxdfhei1' USING DFHEIV0,
 14377           DFHEIV1,
 14378           CLAIM-MASTER,
 14379           DFHEIV11,
 14380           DFHEIV99
 14381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14382
 14383
 14384     IF WS-LETTER-SW = 'N'
 14385         GO TO 5000-END-UPDATE.
 14386
 14387 5000-GENERATE-AUTO-LETTER.
 14388
 14389
 14390* EXEC CICS LINK
 14391*        PROGRAM    (LINK-1523)
 14392*        COMMAREA   (W-1523-LINKDATA)
 14393*        LENGTH     (W-1523-COMM-LENGTH)
 14394*    END-EXEC.
 14395*    MOVE '."C                   (   #00013587' TO DFHEIV0
 14396     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14397     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14398     MOVE X'2020233030303133353837' TO DFHEIV0(25:11)
 14399     CALL 'kxdfhei1' USING DFHEIV0,
 14400           LINK-1523,
 14401           W-1523-LINKDATA,
 14402           W-1523-COMM-LENGTH,
 14403           DFHEIV99,
 14404           DFHEIV99,
 14405           DFHEIV99,
 14406           DFHEIV99
 14407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14408
 14409
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 275
* EL156.cbl
 14410     IF W-1523-FATAL-ERROR
 14411         MOVE W-1523-ERROR-CODE      TO  EMI-ERROR
 14412         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14413         MOVE ER-0802                TO  EMI-ERROR
 14414         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14415
 14416     IF W-1523-ERROR-CODE = 0191
 14417         MOVE ER-0803                TO  EMI-ERROR
 14418         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14419
 14420     IF PI-COMPANY-ID      = 'HAN' AND
 14421        PI-PMTTYPE         = '1'   AND
 14422        PI-3RD-PARTY-SW    = 'Y'   AND
 14423        W-1523-FORM-NUMBER = 'EOB1'
 14424           MOVE LOW-VALUES              TO W-1523-LINKDATA
 14425           MOVE PROGRAM-INTERFACE-BLOCK TO W-1523-COMMON-PI-DATA
 14426           MOVE 'EOB3'                  TO W-1523-FORM-NUMBER
 14427           GO TO 5000-GENERATE-AUTO-LETTER.
 14428
 14429 5000-END-UPDATE.
 14430
 14431     MOVE ER-0000                TO EMI-ERROR.
 14432     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14433     GO TO 7000-SHOW-CLAIM.
 14434
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 276
* EL156.cbl
 14436 5000-MOVE-NAME.
 14437     MOVE CL-INSURED-LAST-NAME   TO LSTNMEO.
 14438     MOVE CL-INSURED-1ST-NAME    TO FSTNMEO.
 14439     MOVE CL-INSURED-MID-INIT    TO MINITO.
 14440
 14441 5000-EXIT.
 14442     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 277
* EL156.cbl
 14444 5300-CREATE-DMO.
 14445
 14446     MOVE CL-CERT-KEY-DATA       TO W-NOTE-CERT-KEY.
 14447     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 14448     MOVE CL-CERT-NO             TO W-NOTE-CERT-NO.
 14449
 14450
 14451* EXEC CICS HANDLE CONDITION
 14452*         NOTFND   (5300-NOTE-NOT-FOUND)
 14453*    END-EXEC.
 14454*    MOVE '"$I                   ! . #00013633' TO DFHEIV0
 14455     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14456     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14457     MOVE X'2E20233030303133363333' TO DFHEIV0(25:11)
 14458     CALL 'kxdfhei1' USING DFHEIV0
 14459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14460
 14461
 14462
 14463* EXEC CICS READ
 14464*         DATASET('ERNOTE')
 14465*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 14466*         RIDFLD (W-NOTE-KEY)
 14467*    END-EXEC.
 14468     MOVE 'ERNOTE' TO DFHEIV1
 14469*    MOVE '&"S        E          (   #00013637' TO DFHEIV0
 14470     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14471     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14472     MOVE X'2020233030303133363337' TO DFHEIV0(25:11)
 14473     CALL 'kxdfhei1' USING DFHEIV0,
 14474           DFHEIV1,
 14475           DFHEIV20,
 14476           DFHEIV99,
 14477           W-NOTE-KEY,
 14478           DFHEIV99,
 14479           DFHEIV99,
 14480           DFHEIV99
 14481     SET ADDRESS OF CERTIFICATE-NOTE TO
 14482         DFHEIV20
 14483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14484
 14485
 14486     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 14487     MOVE CL-BENEFICIARY         TO DCT-LOGIC-BENEFICIARY-ID.
 14488     MOVE CL-CCN                 TO DCT-CREDIT-CARD-NUMBER.
 14489
 14490     IF CL-CERT-GROUPING (5:2) = ZEROS OR SPACES
 14491         MOVE 'CC'                   TO DCT-PRODUCT-CODE
 14492     ELSE
 14493         MOVE CL-CERT-GROUPING (5:2) TO DCT-PRODUCT-CODE.
 14494
 14495     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 14496     MOVE '02'                   TO DCT-COLUMN-ID-REQUESTED.
 14497     MOVE 'DLO006'               TO PGM-NAME.
 14498
 14499
 14500* EXEC CICS LINK
 14501*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 278
* EL156.cbl
 14502*        COMMAREA   (DCT-COMMUNICATION-AREA)
 14503*        LENGTH     (DCT-RCRD-LENGTH)
 14504*    END-EXEC.
 14505*    MOVE '."C                   (   #00013656' TO DFHEIV0
 14506     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14507     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14508     MOVE X'2020233030303133363536' TO DFHEIV0(25:11)
 14509     CALL 'kxdfhei1' USING DFHEIV0,
 14510           PGM-NAME,
 14511           DCT-COMMUNICATION-AREA,
 14512           DCT-RCRD-LENGTH,
 14513           DFHEIV99,
 14514           DFHEIV99,
 14515           DFHEIV99,
 14516           DFHEIV99
 14517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14518
 14519
 14520     IF DCT-RETURN-CODE = 'OK'
 14521         GO TO 5300-CONT.
 14522
 14523     IF DCT-RETURN-CODE = '01' OR '02'
 14524         GO TO 5300-EXIT.
 14525
 14526     IF DCT-RETURN-CODE = '03'
 14527         MOVE ER-0951            TO EMI-ERROR
 14528         GO TO 5300-BAD-EXIT.
 14529
 14530     IF DCT-RETURN-CODE = '04'
 14531         MOVE ER-0946            TO EMI-ERROR
 14532         GO TO 5300-BAD-EXIT.
 14533
 14534     IF DCT-RETURN-CODE = '05'
 14535         MOVE ER-0947            TO EMI-ERROR
 14536         GO TO 5300-BAD-EXIT.
 14537
 14538     IF DCT-RETURN-CODE = '06'
 14539         MOVE ER-0921            TO EMI-ERROR
 14540         GO TO 5300-BAD-EXIT.
 14541
 14542     IF DCT-RETURN-CODE = '07'
 14543         MOVE ER-0849            TO EMI-ERROR
 14544         GO TO 5300-BAD-EXIT.
 14545
 14546     IF DCT-RETURN-CODE = '08'
 14547         MOVE ER-0948            TO EMI-ERROR
 14548         GO TO 5300-BAD-EXIT.
 14549
 14550     IF DCT-RETURN-CODE = 'N1'
 14551         MOVE ER-0950            TO EMI-ERROR
 14552         GO TO 5300-BAD-EXIT.
 14553
 14554     IF DCT-RETURN-CODE = 'E1'
 14555         MOVE ER-0974            TO EMI-ERROR
 14556         GO TO 5300-BAD-EXIT.
 14557
 14558     IF DCT-RETURN-CODE = 'E2'
 14559         MOVE ER-0975            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 279
* EL156.cbl
 14560         GO TO 5300-BAD-EXIT.
 14561
 14562     IF DCT-RETURN-CODE NOT = 'OK'
 14563         MOVE ER-0949            TO EMI-ERROR
 14564         GO TO 5300-BAD-EXIT.
 14565
 14566 5300-CONT.
 14567
 14568     MOVE SPACES                 TO DMO-COMMUNICATION-AREA.
 14569     MOVE 'CS'                   TO DM-RECORD-TYPE.
 14570     MOVE DCT-DISTRIBUTION-CODE  TO DM-DIST-CODE.
 14571     MOVE DCT-MAIL-CODE          TO DM-MAIL-CODE.
 14572     MOVE CL-CLAIM-NO            TO DM-CLAIM-NO.
 14573     MOVE CL-CERT-NO (4:1)       TO DM-CLAIM-TYPE.
 14574     MOVE CL-CCN                 TO DM-CREDIT-CARD-NUMBER.
 14575     MOVE SAVE-DATE-CCYYMMDD     TO DM-STATUS-DATE.
 14576
 14577     MOVE CL-INSURED-LAST-NAME   TO W-NAME-LAST.
 14578     MOVE CL-INSURED-1ST-NAME    TO W-NAME-FIRST.
 14579     MOVE CL-INSURED-MID-INIT    TO W-NAME-MIDDLE.
 14580     PERFORM 5350-FORMAT-LAST-NAME-1ST THRU 5350-EXIT.
 14581     MOVE WS-NAME-WORK           TO DM-INSURED-NAME.
 14582
 14583     MOVE CL-CARRIER             TO DM-STAT-CARRIER.
 14584
 14585     IF PI-PMTTYPE = '2'
 14586         MOVE 'F'                TO DM-STAT-CHANGE-TYPE
 14587         MOVE '4'                TO DM-CLAIM-STATUS
 14588     ELSE
 14589         MOVE 'I'                TO DM-STAT-CHANGE-TYPE
 14590         MOVE '2'                TO DM-CLAIM-STATUS.
 14591
 14592     MOVE 'DLO025'               TO PGM-NAME.
 14593
 14594
 14595* EXEC CICS LINK
 14596*        PROGRAM    (PGM-NAME)
 14597*        COMMAREA   (DMO-COMMUNICATION-AREA)
 14598*        LENGTH     (DM-DMO-LENGTH)
 14599*    END-EXEC.
 14600*    MOVE '."C                   (   #00013736' TO DFHEIV0
 14601     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 14602     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14603     MOVE X'2020233030303133373336' TO DFHEIV0(25:11)
 14604     CALL 'kxdfhei1' USING DFHEIV0,
 14605           PGM-NAME,
 14606           DMO-COMMUNICATION-AREA,
 14607           DM-DMO-LENGTH,
 14608           DFHEIV99,
 14609           DFHEIV99,
 14610           DFHEIV99,
 14611           DFHEIV99
 14612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14613
 14614
 14615     IF DM-RETURN-CODE = 'OK'
 14616         GO TO 5300-EXIT.
 14617
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 280
* EL156.cbl
 14618     IF DM-RETURN-CODE = '01'
 14619         MOVE ER-8051            TO EMI-ERROR
 14620         GO TO 5300-BAD-EXIT.
 14621
 14622     IF DM-RETURN-CODE = '02'
 14623         MOVE ER-8052            TO EMI-ERROR
 14624         GO TO 5300-BAD-EXIT.
 14625
 14626     IF DM-RETURN-CODE = '03'
 14627         MOVE ER-8053            TO EMI-ERROR
 14628         GO TO 5300-BAD-EXIT.
 14629
 14630     IF DM-RETURN-CODE = '04'
 14631         MOVE ER-8054            TO EMI-ERROR
 14632         GO TO 5300-BAD-EXIT.
 14633
 14634     IF DM-RETURN-CODE = '05'
 14635         MOVE ER-8055            TO EMI-ERROR
 14636         GO TO 5300-BAD-EXIT.
 14637
 14638     IF DM-RETURN-CODE = '06'
 14639         MOVE ER-8056            TO EMI-ERROR
 14640         GO TO 5300-BAD-EXIT.
 14641
 14642     IF DM-RETURN-CODE = '07'
 14643         MOVE ER-8057            TO EMI-ERROR
 14644         GO TO 5300-BAD-EXIT.
 14645
 14646     IF DM-RETURN-CODE = '08'
 14647         MOVE ER-8058            TO EMI-ERROR
 14648         GO TO 5300-BAD-EXIT.
 14649
 14650     IF DM-RETURN-CODE = '09'
 14651         MOVE ER-8059            TO EMI-ERROR
 14652         GO TO 5300-BAD-EXIT.
 14653
 14654     IF DM-RETURN-CODE = '10'
 14655         MOVE ER-8060            TO EMI-ERROR
 14656         GO TO 5300-BAD-EXIT.
 14657
 14658     IF DM-RETURN-CODE = '11'
 14659         MOVE ER-8061            TO EMI-ERROR
 14660         GO TO 5300-BAD-EXIT.
 14661
 14662     IF DM-RETURN-CODE = '12'
 14663         MOVE ER-8062            TO EMI-ERROR
 14664         GO TO 5300-BAD-EXIT.
 14665
 14666     IF DM-RETURN-CODE = '13'
 14667         MOVE ER-8063            TO EMI-ERROR
 14668         GO TO 5300-BAD-EXIT.
 14669
 14670     IF DM-RETURN-CODE = '14'
 14671         MOVE ER-8064            TO EMI-ERROR
 14672         GO TO 5300-BAD-EXIT.
 14673
 14674     IF DM-RETURN-CODE = '15'
 14675         MOVE ER-8065            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 281
* EL156.cbl
 14676         GO TO 5300-BAD-EXIT.
 14677
 14678     IF DM-RETURN-CODE = '16'
 14679         MOVE ER-8154            TO EMI-ERROR
 14680         GO TO 5300-BAD-EXIT.
 14681
 14682     IF DM-RETURN-CODE = '17'
 14683         MOVE ER-8155            TO EMI-ERROR
 14684         GO TO 5300-BAD-EXIT.
 14685
 14686     IF DM-RETURN-CODE = 'N1'
 14687         MOVE ER-8152            TO EMI-ERROR
 14688         GO TO 5300-BAD-EXIT.
 14689
 14690     IF DM-RETURN-CODE = 'E1'
 14691         MOVE ER-8153            TO EMI-ERROR
 14692         GO TO 5300-BAD-EXIT.
 14693
 14694     MOVE ER-8066            TO EMI-ERROR.
 14695     GO TO 5300-BAD-EXIT.
 14696
 14697 5300-NOTE-NOT-FOUND.
 14698
 14699     MOVE ER-0954                TO EMI-ERROR.
 14700     GO TO 5300-BAD-EXIT.
 14701
 14702 5300-BAD-EXIT.
 14703
 14704* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 14705*    MOVE '6"R                   !   #00013830' TO DFHEIV0
 14706     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 14707     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14708     MOVE X'2020233030303133383330' TO DFHEIV0(25:11)
 14709     CALL 'kxdfhei1' USING DFHEIV0
 14710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14711
 14712     IF MAP-NAME = 'EL156A'
 14713         MOVE -1             TO ENTERPFL
 14714       ELSE
 14715         MOVE LOW-VALUES     TO EL156BI
 14716         MOVE -1             TO ENTPFBL.
 14717
 14718     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14719     GO TO 8200-SEND-DATAONLY.
 14720
 14721 5300-EXIT.
 14722     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 282
* EL156.cbl
 14724 5350-FORMAT-LAST-NAME-1ST.
 14725*****************************************************************
 14726*             M O V E   N A M E   R O U T I N E                 *
 14727*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 14728*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 14729*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 14730*                  FIELD                   VALUE                *
 14731*           W-NAME-LAST    (CL15)      SMITH                    *
 14732*           W-NAME-FIRST   (CL15)      JOHN                     *
 14733*           W-NAME-MIDDLE  (CL15)      ALLEN                    *
 14734*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 14735*     CONTAIN                                                   *
 14736*                SMITH, JOHN ALLEN                              *
 14737*     OR                                                        *
 14738*                SMITH, JOHN A.                                 *
 14739*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 14740*     COPYBOOK, ELCNWA.                                         *
 14741*****************************************************************.
 14742
 14743     MOVE SPACES                 TO  WS-NAME-WORK-AREA.
 14744     MOVE ZERO                   TO  WS-NAME-SW.
 14745     SET NWA-INDEX               TO +1.
 14746
 14747     IF W-NAME-LAST   = SPACES AND
 14748        W-NAME-MIDDLE = SPACES
 14749         MOVE +1                 TO WS-NAME-SW.
 14750
 14751     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 14752     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14753
 14754     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 14755     PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14756
 14757     SET NWA-INDEX UP BY +1.
 14758
 14759     IF W-NAME-MIDDLE NOT = SPACES
 14760         IF W-NAME-MIDDLE-2 = SPACES
 14761             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 14762             SET NWA-INDEX UP BY +1
 14763             MOVE '.'            TO WS-NW (NWA-INDEX)
 14764             SET NWA-INDEX UP BY +2
 14765         ELSE
 14766             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 14767             PERFORM 5360-MOVE-NAME THRU 5360-EXIT.
 14768
 14769 5350-EXIT.
 14770     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 283
* EL156.cbl
 14772 5360-MOVE-NAME.
 14773
 14774     IF WS-NAME-SW > +1
 14775         GO TO 5360-EXIT.
 14776
 14777     IF WS-NAME-WORK2 = SPACES
 14778         GO TO 5360-EXIT.
 14779
 14780     SET NWA-INDEX2            TO +1.
 14781     SET NWA-INDEX3            TO +2.
 14782
 14783 5360-MOVE-NAME-CYCLE.
 14784
 14785     MOVE WS-NW2 (NWA-INDEX2)  TO  WS-NW (NWA-INDEX).
 14786
 14787     IF NWA-INDEX < +30
 14788         SET NWA-INDEX UP BY +1
 14789     ELSE
 14790         ADD +2                TO  WS-NAME-SW
 14791         GO TO 5360-EXIT.
 14792
 14793     IF NWA-INDEX2 < +20
 14794         SET NWA-INDEX3 UP BY +1
 14795         SET NWA-INDEX2 UP BY +1.
 14796
 14797     IF WS-NW2 (NWA-INDEX2) = SPACES AND
 14798        WS-NW2 (NWA-INDEX3) = SPACES
 14799         IF WS-NAME-SW = ZERO
 14800             MOVE ','            TO  WS-NW (NWA-INDEX)
 14801             SET NWA-INDEX UP BY +2
 14802             MOVE +1             TO  WS-NAME-SW
 14803             GO TO 5360-EXIT
 14804         ELSE
 14805             GO TO 5360-EXIT.
 14806
 14807     GO TO 5360-MOVE-NAME-CYCLE.
 14808
 14809 5360-EXIT.
 14810     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 284
* EL156.cbl
 14812 6000-BUILD-SCREEN-B.
 14813     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 14814     MOVE PI-CARRIER             TO MSTR-CARRIER.
 14815     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 14816     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 14817
 14818     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 14819
 14820 6050-BUILD-SCREEN.
 14821     PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT.
 14822     MOVE LOW-VALUES             TO EL156BI.
 14823     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 14824
 14825     MOVE PI-PAYEE-SEQ-NUM       TO TRLR-SEQ-NO.
 14826
 14827     IF PI-PAYEE-TYPE = 'I'
 14828        GO TO 6060-READ-TRAILER.
 14829
 14830     IF PI-PAYEE-TYPE = 'B'
 14831        ADD +10                  TO TRLR-SEQ-NO
 14832        GO TO 6060-READ-TRAILER.
 14833
 14834     IF PI-PAYEE-TYPE = 'A'
 14835        ADD +20                  TO TRLR-SEQ-NO
 14836        GO TO 6060-READ-TRAILER.
 14837
 14838     IF PI-PAYEE-TYPE = 'O'
 14839        ADD +50                  TO TRLR-SEQ-NO
 14840        GO TO 6060-READ-TRAILER.
 14841
 14842     IF PI-PAYEE-TYPE = 'Q'
 14843        ADD +60                  TO TRLR-SEQ-NO
 14844        GO TO 6060-READ-TRAILER.
 14845
 14846     IF PI-PAYEE-TYPE = 'P'
 14847        ADD +30                  TO TRLR-SEQ-NO
 14848        GO TO 6060-READ-TRAILER.
 14849
 14850     IF PI-PAYEE-TYPE = 'E'
 14851        ADD +40                  TO TRLR-SEQ-NO.
 14852
 14853 6060-READ-TRAILER.
 14854
 14855     IF PI-PAYEE-TYPE    = 'A' AND
 14856        PI-PAYEE-SEQ-NUM = 0
 14857          GO TO 6061-READ-ACCOUNT.
 14858
 14859     IF (PI-COMPANY-ID    = 'AIG' OR 'AUK')  AND
 14860        (PI-PAYEE-TYPE    = 'B')             AND
 14861        (PI-PAYEE-SEQ-NUM = 9)
 14862          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14863          IF BENE-FOUND-SW = 'N'
 14864            GO TO 6065-NOT-FOUND
 14865          ELSE
 14866            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14867            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14868            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14869*           MOVE BE-CITY-STATE     TO CITYSTBO
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 285
* EL156.cbl
 14870            STRING BE-CITY ' ' BE-STATE
 14871               DELIMITED BY '  ' INTO CITYSTBO
 14872            END-STRING
 14873            MOVE BE-ZIP-CODE       TO ZIPBO
 14874            GO TO 6061-READ-ACCOUNT.
 14875
 14876     IF PI-PAYEE-TYPE    = 'B' AND
 14877        PI-PAYEE-SEQ-NUM = 0
 14878          PERFORM 7920-READ-BENE THRU 7920-EXIT
 14879          IF BENE-FOUND-SW = 'N'
 14880            GO TO 6065-NOT-FOUND
 14881          ELSE
 14882            MOVE BE-MAIL-TO-NAME   TO PI-PAYEE-NAME  NAMEBO
 14883            MOVE BE-ADDRESS-LINE-1 TO ADDR1BO
 14884            MOVE BE-ADDRESS-LINE-2 TO ADDR2BO
 14885*           MOVE BE-CITY-STATE     TO CITYSTBO
 14886            STRING BE-CITY ' ' BE-STATE
 14887               DELIMITED BY '  ' INTO CITYSTBO
 14888            END-STRING
 14889            MOVE BE-ZIP-CODE       TO ZIPBO
 14890            GO TO 6061-READ-ACCOUNT.
 14891
 14892
 14893* EXEC CICS HANDLE CONDITION
 14894*         NOTFND(6065-NOT-FOUND)
 14895*     END-EXEC.
 14896*    MOVE '"$I                   ! / #00014011' TO DFHEIV0
 14897     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14898     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14899     MOVE X'2F20233030303134303131' TO DFHEIV0(25:11)
 14900     CALL 'kxdfhei1' USING DFHEIV0
 14901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14902
 14903
 14904     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 14905
 14906     MOVE AT-MAIL-TO-NAME        TO PI-PAYEE-NAME.
 14907     MOVE AT-MAIL-TO-NAME        TO NAMEBO.
 14908     MOVE AT-ADDRESS-LINE-1      TO ADDR1BO.
 14909     MOVE AT-ADDRESS-LINE-2      TO ADDR2BO.
 14910*    MOVE AT-CITY-STATE          TO CITYSTBO.
 14911     STRING AT-CITY ' ' AT-STATE
 14912        DELIMITED BY '  ' INTO CITYSTBO
 14913     END-STRING
 14914     MOVE AT-ZIP-CODE            TO ZIPBO.
 14915
 14916 6061-READ-ACCOUNT.
 14917
 14918* EXEC CICS HANDLE CONDITION
 14919*         NOTFND(6068-ACCT-NOT-FND)
 14920*     END-EXEC.
 14921*    MOVE '"$I                   ! 0 #00014028' TO DFHEIV0
 14922     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14923     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14924     MOVE X'3020233030303134303238' TO DFHEIV0(25:11)
 14925     CALL 'kxdfhei1' USING DFHEIV0
 14926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14927
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 286
* EL156.cbl
 14928
 14929
 14930* EXEC CICS READ
 14931*         DATASET('ERACCT')
 14932*         SET    (ADDRESS OF ACCOUNT-MASTER)
 14933*         RIDFLD (PI-ACCT-KEY)
 14934*     END-EXEC.
 14935     MOVE 'ERACCT' TO DFHEIV1
 14936*    MOVE '&"S        E          (   #00014032' TO DFHEIV0
 14937     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14938     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14939     MOVE X'2020233030303134303332' TO DFHEIV0(25:11)
 14940     CALL 'kxdfhei1' USING DFHEIV0,
 14941           DFHEIV1,
 14942           DFHEIV20,
 14943           DFHEIV99,
 14944           PI-ACCT-KEY,
 14945           DFHEIV99,
 14946           DFHEIV99,
 14947           DFHEIV99
 14948     SET ADDRESS OF ACCOUNT-MASTER TO
 14949         DFHEIV20
 14950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14951
 14952
 14953     MOVE AM-CARRIER             TO ACARRBO.
 14954     MOVE AM-GROUPING            TO GROUPBO.
 14955     MOVE AM-STATE               TO STATEBO.
 14956     MOVE AM-ACCOUNT             TO ACCTBO.
 14957     MOVE AM-NAME                TO ACCTNMBO.
 14958
 14959     IF PI-PAYEE-TYPE = 'A' AND
 14960        PI-PAYEE-SEQ-NUM = 0
 14961          MOVE AM-NAME             TO NAMEBO
 14962                                      PI-PAYEE-NAME
 14963          MOVE AM-ADDRS            TO ADDR1BO
 14964          MOVE SPACES              TO ADDR2BO
 14965*         MOVE AM-CITY             TO CITYSTBO
 14966          STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 14967             DELIMITED BY '  ' INTO CITYSTBO
 14968          END-STRING
 14969          MOVE AM-ZIP-PRIME        TO WS-ZIP
 14970          MOVE AM-ZIP-PLUS4        TO WS-ZIP-EXT
 14971          INSPECT WS-WORK-ZIP REPLACING ALL SPACES BY '0'
 14972          MOVE WS-NUMERIC-ZIP      TO ZIPBO.
 14973
 14974***  We don't really need the code below because we don't do the
 14975***  AK thing anymore.  However, we may have a state special
 14976***  of some sort in the future so why not just leave it??
 14977     IF CITYSTBO EQUAL SPACES
 14978         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 14979         GO TO 6070-FORMAT-DATA
 14980     END-IF.
 14981
 14982     MOVE CITYSTBO TO WS-PAYEE-CITY-STATE.
 14983     MOVE 'N' TO WS-PAYEE-STATE-FOUND.
 14984     MOVE 0 TO WS-BEG-SUB WS-END-SUB.
 14985     PERFORM VARYING WS-SUB FROM 30 BY -1
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 287
* EL156.cbl
 14986          UNTIL WS-SUB = 0 OR PAYEE-STATE-FOUND
 14987        IF WS-END-SUB = 0  AND
 14988           (WS-PAYEE-CITY-ST (WS-SUB) EQUAL SPACES
 14989              OR LOW-VALUES  OR '.')
 14990            CONTINUE
 14991        ELSE
 14992            IF WS-END-SUB = 0
 14993                MOVE WS-SUB TO WS-END-SUB
 14994            ELSE
 14995                IF WS-PAYEE-CITY-ST (WS-SUB) = SPACES
 14996                    COMPUTE WS-BEG-SUB = WS-SUB + 1
 14997                    MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 14998                END-IF
 14999            END-IF
 15000        END-IF
 15001        IF WS-PAYEE-CITY-ST (WS-SUB) EQUAL ','
 15002            COMPUTE WS-BEG-SUB = WS-SUB + 1
 15003            MOVE 'Y' TO WS-PAYEE-STATE-FOUND
 15004        END-IF
 15005     END-PERFORM.
 15006
 15007     IF WS-BEG-SUB > 0
 15008         COMPUTE WS-STATE-LENGTH = WS-END-SUB - WS-BEG-SUB + 1
 15009         IF WS-STATE-LENGTH = 2
 15010             MOVE WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH)
 15011                  TO PI-CHECK-STATE-FOR-AK
 15012         ELSE
 15013             IF WS-PAYEE-CITY-STATE (WS-BEG-SUB:WS-STATE-LENGTH) =
 15014                'ALASKA'
 15015                 MOVE 'AK' TO PI-CHECK-STATE-FOR-AK
 15016             ELSE
 15017                 MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15018             END-IF
 15019         END-IF
 15020     ELSE
 15021         MOVE 'XX' TO PI-CHECK-STATE-FOR-AK
 15022     END-IF.
 15023
 15024     GO TO 6070-FORMAT-DATA.
 15025
 15026 6065-NOT-FOUND.
 15027     MOVE 'NO ADDRESS RECORD FOUND'  TO ADDR1BO.
 15028     GO TO 6061-READ-ACCOUNT.
 15029
 15030 6068-ACCT-NOT-FND.
 15031     MOVE 'NO ACCOUNT RECORD FOUND'  TO ACCTNMBO.
 15032
 15033 6070-FORMAT-DATA.
 15034     IF PI-HOLDTIL = ZEROS
 15035        MOVE SAVE-DATE           TO PAYDTBI
 15036       ELSE
 15037        MOVE PI-HOLDTIL          TO PAYDTBO
 15038        INSPECT PAYDTBI REPLACING ALL SPACES BY '/'.
 15039
 15040     MOVE PI-PROOF-DATE          TO PROOFDBO.
 15041     INSPECT PROOFDBI REPLACING ALL SPACES BY '/'.
 15042
 15043     IF EIBAID = DFHPF3 OR DFHPF4
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 288
* EL156.cbl
 15044        NEXT SENTENCE
 15045     ELSE
 15046       GO TO 6071-CONTINUE.
 15047
 15048     MOVE PI-EPYFROM          TO PYFROMBO.
 15049     INSPECT PYFROMBI REPLACING ALL SPACES BY '/'.
 15050
 15051     IF NOT PI-USES-PAID-TO
 15052        MOVE PI-EPYTHRU          TO PYTHRUBO
 15053        INSPECT PYTHRUBI REPLACING ALL SPACES BY '/'
 15054     ELSE
 15055        MOVE PI-EPYTHRU       TO DC-GREG-DATE-1-MDY
 15056        MOVE '4'              TO DC-OPTION-CODE
 15057        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15058        IF NO-CONVERSION-ERROR
 15059           MOVE +1            TO DC-ELAPSED-DAYS
 15060           MOVE +0            TO DC-ELAPSED-MONTHS
 15061           MOVE '6'           TO DC-OPTION-CODE
 15062           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15063           IF NO-CONVERSION-ERROR
 15064              MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15065
 15066     MOVE PI-EDAYS            TO DAYSBO.
 15067     MOVE PI-EPYAMT           TO PAYAMTBO.
 15068     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15069        IF PI-INT-AMT > ZEROS
 15070           MOVE PI-INT-AMT       TO INTAMTBO
 15071        END-IF
 15072     END-IF
 15073     GO TO 6072-SET-TYPE.
 15074
 15075 6071-CONTINUE.
 15076
 15077     IF PI-CPYFROM NOT = LOW-VALUES
 15078        MOVE PI-CPYFROM          TO DC-BIN-DATE-1
 15079        MOVE SPACES              TO DC-OPTION-CODE
 15080        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15081        MOVE DC-GREG-DATE-1-EDIT TO PYFROMBI.
 15082
 15083     IF PI-CPYTHRU NOT = LOW-VALUES
 15084        IF NOT PI-USES-PAID-TO
 15085           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15086           MOVE SPACES             TO DC-OPTION-CODE
 15087           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15088           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI
 15089        ELSE
 15090           MOVE PI-CPYTHRU         TO DC-BIN-DATE-1
 15091           MOVE '6'                TO DC-OPTION-CODE
 15092           MOVE +1                 TO DC-ELAPSED-DAYS
 15093           MOVE +0                 TO DC-ELAPSED-MONTHS
 15094           PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 15095           MOVE DC-GREG-DATE-1-EDIT TO PYTHRUBI.
 15096
 15097     MOVE PI-CDAYS               TO DAYSBO.
 15098     MOVE PI-CPYAMT              TO PAYAMTBO.
 15099     IF PI-COMPANY-ID = 'CID' OR 'AHL'
 15100        IF PI-INT-AMT > ZEROS
 15101           MOVE PI-INT-AMT       TO INTAMTBO
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 289
* EL156.cbl
 15102        END-IF
 15103     END-IF
 15104     .
 15105 6072-SET-TYPE.
 15106     IF PI-PMTTYPE = '1'
 15107        MOVE 'PARTIAL'           TO PAYTYPBO.
 15108
 15109     IF PI-PMTTYPE = '2'
 15110        MOVE 'FINAL'             TO PAYTYPBO.
 15111
 15112     IF PI-PMTTYPE = '3'
 15113        MOVE 'LUMP SUM'          TO PAYTYPBO.
 15114
 15115     IF PI-PMTTYPE = '4'
 15116        MOVE 'ADDITIONAL'        TO PAYTYPBO.
 15117
 15118     IF PI-PMTTYPE = '5'
 15119        MOVE 'CHARGEABLE'        TO PAYTYPBO.
 15120
 15121     IF PI-PMTTYPE = '6'
 15122        MOVE 'NON-CHARGEABLE'    TO PAYTYPBO.
 15123
 15124     IF PI-PROV-PMT
 15125        MOVE 'PROVISIONAL   '    TO PAYTYPBO.
 15126
 15127     IF PI-ECHECKNO NOT = SPACES
 15128        MOVE PI-ECHECKNO         TO CKNUMBO
 15129     ELSE
 15130        MOVE PI-CCHECKNO         TO CKNUMBO.
 15131
 15132     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 15133        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 15134        MOVE +91                 TO  TRLR-SEQ-NO
 15135
 15136* EXEC CICS READ
 15137*           DATASET  ('ELTRLR')
 15138*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 15139*           RIDFLD   (ELTRLR-KEY)
 15140*           RESP     (WS-RESPONSE)
 15141*       END-EXEC
 15142     MOVE 'ELTRLR' TO DFHEIV1
 15143*    MOVE '&"S        E          (  N#00014220' TO DFHEIV0
 15144     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15145     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15146     MOVE X'204E233030303134323230' TO DFHEIV0(25:11)
 15147     CALL 'kxdfhei1' USING DFHEIV0,
 15148           DFHEIV1,
 15149           DFHEIV20,
 15150           DFHEIV99,
 15151           ELTRLR-KEY,
 15152           DFHEIV99,
 15153           DFHEIV99,
 15154           DFHEIV99
 15155     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15156         DFHEIV20
 15157     MOVE EIBRESP  TO WS-RESPONSE
 15158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15159
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 290
* EL156.cbl
 15160        IF WS-RESP-NORMAL
 15161           MOVE AT-INFO-LINE-1   TO  LOANNBO
 15162        ELSE
 15163           MOVE SPACES           TO  LOANNBO
 15164        END-IF
 15165     END-IF
 15166
 15167*       MOVE PI-LOAN-NO          TO LOANNBO
 15168
 15169     IF CKNUMBO = SPACES
 15170         MOVE SPACES             TO CKNUMHDO.
 15171
 15172     MOVE CL-CLAIM-NO            TO CLMNOBO.
 15173     MOVE CL-CARRIER             TO CARRBO.
 15174     MOVE CL-CERT-PRIME          TO CERTNOBO.
 15175     MOVE CL-CERT-SFX            TO SUFXBO.
 15176
 15177     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 15178        EVALUATE CL-CLAIM-TYPE
 15179           WHEN 'I'
 15180              MOVE '  IU  '      TO CLMTYPBO
 15181           WHEN 'G'
 15182              MOVE ' GAP  '      TO CLMTYPBO
 15183           WHEN 'F'
 15184              MOVE ' FMLA '      TO CLMTYPBO
 15185           WHEN OTHER
 15186              MOVE PI-AH-OVERRIDE-L6
 15187                                 TO CLMTYPBO
 15188        END-EVALUATE
 15189        MOVE ZEROS               TO UNDISBO
 15190*       MOVE PI-AH-OVERRIDE-L6   TO CLMTYPBO
 15191        IF PI-PMTTYPE = '5' OR '6'
 15192           GO TO 6073-GET-NOTIFY-DATA
 15193        ELSE
 15194           MOVE PI-DAILY-RATE    TO RATEBO
 15195           GO TO 6073-GET-NOTIFY-DATA.
 15196
 15197     MOVE PI-LIFE-OVERRIDE-L6    TO CLMTYPBO.
 15198
 15199     IF (PI-PMTTYPE = '5' OR '6') OR EIBAID = DFHPF5
 15200        MOVE ZEROS               TO UNDISBO
 15201     ELSE
 15202        COMPUTE UNDISBO = PI-CPYAMT - PI-EPYAMT.
 15203
 15204 6073-GET-NOTIFY-DATA.
 15205
 15206     MOVE 'N'                    TO  PI-3RD-PARTY-SW.
 15207
 15208     IF AM-NOTIF-OF-PAYMENTS NOT = 'Y'
 15209         MOVE SPACES             TO  NAMEB2O
 15210                                     ADDR1B2O
 15211                                     ADDR2B2O
 15212                                     CITYST2O
 15213                                     AGTHDGO
 15214         MOVE ZEROS              TO  ZIPB2O
 15215         GO TO 6080-SET-INCURRED.
 15216
 15217     MOVE ELMSTR-KEY             TO  ELTRLR-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 291
* EL156.cbl
 15218     MOVE +29                    TO  TRLR-SEQ-NO.
 15219
 15220
 15221* EXEC CICS HANDLE CONDITION
 15222*        NOTFND   (6074-GET-COMP-DATA)
 15223*    END-EXEC.
 15224*    MOVE '"$I                   ! 1 #00014287' TO DFHEIV0
 15225     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15226     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15227     MOVE X'3120233030303134323837' TO DFHEIV0(25:11)
 15228     CALL 'kxdfhei1' USING DFHEIV0
 15229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15230
 15231
 15232     PERFORM 7950-READ-TRAILER THRU 7950-EXIT.
 15233
 15234     MOVE AT-MAIL-TO-NAME        TO  NAMEB2O.
 15235     MOVE AT-ADDRESS-LINE-1      TO  ADDR1B2O.
 15236     MOVE AT-ADDRESS-LINE-2      TO  ADDR2B2O.
 15237*    MOVE AT-CITY-STATE          TO  CITYST2O.
 15238     STRING AT-CITY ' ' AT-STATE
 15239        DELIMITED BY '  ' INTO CITYST2O
 15240     END-STRING
 15241     MOVE AT-ZIP-CODE            TO  ZIPB2O.
 15242     GO TO 6080-SET-INCURRED.
 15243
 15244 6074-GET-COMP-DATA.
 15245
 15246     IF AM-3RD-PARTY-NOTIF-LEVEL IS NOT NUMERIC
 15247         MOVE ZEROS              TO  AM-3RD-PARTY-NOTIF-LEVEL.
 15248
 15249     IF AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL) = ZEROS OR SPACES
 15250         MOVE 'NO ADDRESS AVAILABLE' TO  NAMEB2O
 15251                                         ADDR1B2O
 15252                                         ADDR2B2O
 15253                                         CITYST2O
 15254         MOVE ZEROS                  TO  ZIPB2O
 15255         GO TO 6080-SET-INCURRED.
 15256
 15257     MOVE 'Y'                    TO  PI-3RD-PARTY-SW.
 15258     MOVE AM-COMPANY-CD          TO  COMP-COMP-CD.
 15259     MOVE AM-CARRIER             TO  COMP-CARRIER.
 15260     MOVE AM-GROUPING            TO  COMP-GROUP.
 15261     MOVE 'A'                    TO  COMP-TYPE.
 15262     MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15263                                 TO  COMP-FIN-RESP.
 15264
 15265     IF AM-3RD-PARTY-NOTIF-LEVEL = AM-REMIT-TO
 15266         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' OR
 15267                                       'G' OR 'B' or 'S'
 15268             MOVE 'G'            TO  COMP-TYPE
 15269             MOVE LOW-VALUES     TO  COMP-ACCOUNT
 15270         ELSE
 15271             MOVE AM-AGT (AM-3RD-PARTY-NOTIF-LEVEL)
 15272                                 TO  COMP-ACCOUNT
 15273     ELSE
 15274         MOVE 'G'                TO  COMP-TYPE
 15275         MOVE LOW-VALUES         TO  COMP-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 292
* EL156.cbl
 15276
 15277     PERFORM 7800-READ-COMP-MSTR THRU 7800-COMP-EXIT.
 15278
 15279     IF COMP-REC-FOUND
 15280         MOVE CO-ACCT-NAME       TO  NAMEB2O
 15281         MOVE CO-ADDR-1          TO  ADDR1B2O
 15282         MOVE CO-ADDR-2          TO  ADDR2B2O
 15283*        MOVE CO-ADDR-3          TO  CITYST2O
 15284         STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 15285            DELIMITED BY '  ' INTO CITYST2O
 15286         END-STRING
 15287         MOVE CO-ZIP             TO  ZIPB2O
 15288     ELSE
 15289         MOVE 'NO COMP ADDRESS AVAILABLE'
 15290                                 TO  NAMEB2O
 15291                                     ADDR1B2O
 15292                                     ADDR2B2O
 15293                                     CITYST2O
 15294         MOVE ZEROS               TO ZIPB2O.
 15295
 15296 6080-SET-INCURRED.
 15297     MOVE CL-INCURRED-DT         TO DC-BIN-DATE-1.
 15298     MOVE SPACES                 TO DC-OPTION-CODE.
 15299     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 15300     MOVE DC-GREG-DATE-1-EDIT    TO INCURBO.
 15301     MOVE PI-PROCESSOR-ID        TO BYBO.
 15302     MOVE MAP-NAMEB              TO MAP-NAME.
 15303     MOVE 'C'                    TO PI-PASS-SW.
 15304     MOVE EIBAID                 TO PI-PFKEY-USED.
 15305     MOVE -1                     TO ENTPFBL.
 15306     GO TO 8100-SEND-INITIAL-MAP.
 15307
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 293
* EL156.cbl
 15309 6100-BUILD-PAYMENT-TRAILER.
 15310
 15311     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15312     MOVE '6'                    TO CNTL-REC-TYPE.
 15313
 15314     IF CONTROL-IS-ACTUAL-CARRIER
 15315         MOVE PI-CARRIER         TO WS-CARR
 15316     ELSE
 15317         MOVE PI-CARRIER-CONTROL-LEVEL TO WS-CARR.
 15318
 15319     IF PI-COMPANY-ID = 'FIA'
 15320         MOVE PI-CARRIER         TO  WS-CARR.
 15321
 15322     MOVE WS-CARR-ACCESS         TO CNTL-ACCESS.
 15323     MOVE 0                      TO CNTL-SEQ-NO.
 15324     MOVE 'CARR'                 TO FILE-SWITCH.
 15325
 15326     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15327
 15328     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15329         IF PI-OFFLINE     = 'Y' AND
 15330            PI-ECHECKNO-CR = 'CR'
 15331              GO TO 6110-READ-CONTROL
 15332         ELSE
 15333            IF PI-CASH = 'N'
 15334                GO TO 6110-READ-CONTROL.
 15335
 15336     IF CHECK-NO-MANUAL    OR
 15337        CHECK-NO-AT-PRINT  OR
 15338        PI-OFFLINE = 'Y'
 15339          GO TO 6130-BUILD-TRAILER.
 15340
 15341     IF PI-COMPANY-ID = 'FIA'
 15342         NEXT SENTENCE
 15343     ELSE
 15344         IF NOT CONTROL-IS-ACTUAL-CARRIER
 15345             GO TO 6110-READ-CONTROL.
 15346
 15347     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15348
 15349     IF CHECK-CNT-RESET-VALUE
 15350        MOVE +1                  TO CF-CHECK-COUNTER
 15351     ELSE
 15352        ADD +1                   TO CF-CHECK-COUNTER.
 15353
 15354     MOVE CF-CHECK-COUNTER       TO WS-CHECK-NUMERIC.
 15355
 15356     IF CHECK-NO-CARR-SEQ
 15357        MOVE PI-CARRIER          TO WS-CHECK-CARR.
 15358
 15359     MOVE WS-CHECK-AREA          TO PI-CCHECKNO.
 15360
 15361     MOVE 'N' TO PI-REAUDIT-NEEDED.
 15362     IF CF-CHECK-COUNTER >= CF-CARRIER-NEXT-AUDIT-CHK-NO  AND
 15363        CF-CARRIER-NEXT-AUDIT-CHK-NO > ZERO
 15364         MOVE 'Y' TO PI-REAUDIT-NEEDED
 15365         COMPUTE WRK-NEXT-AUDIT-CHK-NO =
 15366            CF-CHECK-COUNTER + PI-REAUDIT-INTERVAL
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 294
* EL156.cbl
 15367         MOVE WRK-NEXT-AUDIT-CHK-NO TO
 15368                      CF-CARRIER-NEXT-AUDIT-CHK-NO
 15369     END-IF.
 15370
 15371     GO TO 6120-REWRITE.
 15372
 15373 6105-STATE-CHECK-NUMBER.
 15374     IF CHECK-NO-MANUAL    OR
 15375        CHECK-NO-AT-PRINT  OR
 15376        PI-OFFLINE = 'Y'
 15377           GO TO 6130-BUILD-TRAILER
 15378     END-IF.
 15379
 15380     MOVE PI-COMPANY-ID      TO CNTL-COMP-ID.
 15381     MOVE PI-CHECK-STATE-FOR-AK TO WS-ST-ACCESS.
 15382     MOVE WS-STATE-ACCESS    TO CNTL-ACCESS.
 15383     MOVE '3'                TO CNTL-REC-TYPE.
 15384     MOVE +0                 TO CNTL-SEQ-NO.
 15385     MOVE 'STAT'             TO FILE-SWITCH.
 15386     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15387
 15388     IF CF-ST-CHECK-CNT-RESET
 15389         MOVE +1             TO CF-ST-CHECK-COUNTER
 15390     ELSE
 15391         ADD +1              TO CF-ST-CHECK-COUNTER
 15392     END-IF.
 15393
 15394     MOVE CF-ST-CHECK-COUNTER TO WS-CHECK-NUMERIC.
 15395     MOVE WS-CHECK-AREA       TO PI-CCHECKNO.
 15396     GO TO 6120-REWRITE.
 15397
 15398 6110-READ-CONTROL.
 15399     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15400     MOVE '1'                    TO CNTL-REC-TYPE.
 15401     MOVE SPACES                 TO CNTL-ACCESS.
 15402     MOVE 0                      TO CNTL-SEQ-NO.
 15403
 15404     PERFORM 7940-READ-CONTROL-UPDATE THRU 7940-EXIT.
 15405
 15406     IF CO-CHECK-COUNT-RESET
 15407        MOVE +1                  TO CF-CO-CHECK-COUNTER
 15408     ELSE
 15409        ADD +1                   TO CF-CO-CHECK-COUNTER.
 15410
 15411     MOVE CF-CO-CHECK-COUNTER    TO WS-CHECK-NUMERIC.
 15412
 15413     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15414         IF PI-OFFLINE     = 'Y'  AND
 15415            PI-ECHECKNO-CR = 'CR'
 15416              MOVE WS-A-CHECK-NUM-5   TO PI-ECHECKNO-5
 15417              MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
 15418              MOVE AL-UANON           TO CHECKNOA
 15419              GO TO 6120-REWRITE
 15420         ELSE
 15421         IF PI-CASH = 'N'
 15422             MOVE 'N'                TO PI-ECHECKNO-N
 15423             MOVE WS-A-CHECK-NUM-6   TO PI-ECHECKNO-6
 15424             MOVE PI-ECHECKNO        TO PI-CCHECKNO CHECKNOO
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 295
* EL156.cbl
 15425             MOVE AL-UANON           TO CHECKNOA
 15426             GO TO 6120-REWRITE.
 15427
 15428     MOVE WS-CHECK-NUMERIC       TO PI-CCHECKNO.
 15429
 15430 6120-REWRITE.
 15431
 15432* EXEC CICS REWRITE
 15433*         DATASET('ELCNTL')
 15434*         FROM(CONTROL-FILE)
 15435*     END-EXEC.
 15436     MOVE LENGTH OF
 15437      CONTROL-FILE
 15438       TO DFHEIV11
 15439     MOVE 'ELCNTL' TO DFHEIV1
 15440*    MOVE '&& L                  %   #00014490' TO DFHEIV0
 15441     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15442     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15443     MOVE X'2020233030303134343930' TO DFHEIV0(25:11)
 15444     CALL 'kxdfhei1' USING DFHEIV0,
 15445           DFHEIV1,
 15446           CONTROL-FILE,
 15447           DFHEIV11,
 15448           DFHEIV99
 15449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15450
 15451
 15452     MOVE 'Y'                    TO PI-CK-ASSIGN.
 15453
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 296
* EL156.cbl
 15455 6130-BUILD-TRAILER.
 15456
 15457
 15458* EXEC CICS GETMAIN
 15459*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15460*         LENGTH    (200)
 15461*         INITIMG   (GETMAIN-SPACE)
 15462*     END-EXEC.
 15463     MOVE 200
 15464       TO DFHEIV11
 15465*    MOVE ',"IL                  $   #00014500' TO DFHEIV0
 15466     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15467     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15468     MOVE X'2020233030303134353030' TO DFHEIV0(25:11)
 15469     CALL 'kxdfhei1' USING DFHEIV0,
 15470           DFHEIV20,
 15471           DFHEIV11,
 15472           GETMAIN-SPACE
 15473     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15474         DFHEIV20
 15475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15476
 15477
 15478     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 15479                                    AT-PREV-PAID-THRU-DT.
 15480     MOVE LOW-VALUES             TO AT-PMT-PROOF-DT.
 15481     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT.
 15482     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15483     MOVE 'AT'                   TO AT-RECORD-ID.
 15484     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15485
 15486     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15487        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15488           MOVE +0               TO AT-PAYMENT-NOTE-SEQ-NO
 15489     ELSE
 15490           MOVE AT-SEQUENCE-NO   TO AT-PAYMENT-NOTE-SEQ-NO
 15491           SUBTRACT +1         FROM AT-PAYMENT-NOTE-SEQ-NO.
 15492
 15493     IF PI-COMPANY-ID = 'LAP' OR 'RMC'
 15494         IF AT-PAYMENT-NOTE-SEQ-NO = ZERO
 15495             MOVE AT-SEQUENCE-NO TO AT-FORM-CTL-SEQ-NO
 15496             SUBTRACT +1       FROM AT-FORM-CTL-SEQ-NO
 15497           ELSE
 15498             MOVE AT-PAYMENT-NOTE-SEQ-NO TO AT-FORM-CTL-SEQ-NO
 15499             SUBTRACT +1               FROM AT-FORM-CTL-SEQ-NO.
 15500
 15501     MOVE '2'                    TO AT-TRAILER-TYPE.
 15502     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15503                                    AT-PAYMENT-LAST-MAINT-DT.
 15504     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15505                                    AT-PAYMENT-LAST-UPDATED-BY.
 15506     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15507     MOVE PI-PMTTYPE             TO AT-PAYMENT-TYPE.
 15508     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE.
 15509     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE.
 15510
 15511     IF PI-PMT-APPROVED
 15512        IF PI-OFFLINE  = 'N'
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 297
* EL156.cbl
 15513           MOVE 'U'              TO AT-PAYMENT-APPROVAL-SW.
 15514
 15515     IF PI-PFKEY-USED = DFHPF5
 15516        GO TO 6140-PF5-ENTERED.
 15517
 15518     MOVE PI-EEXPENS             TO AT-EXPENSE-PER-PMT.
 15519     MOVE PI-EPYAMT              TO AT-AMOUNT-PAID.
 15520
 15521     IF PI-AIG-SPECIAL-BENEFIT
 15522         IF WS-1ST-SPECIAL-PMT
 15523             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-EPYAMT / 1.5
 15524             COMPUTE PI-REDUND-PMTAMT = PI-EPYAMT -
 15525                                        AT-AMOUNT-PAID
 15526         ELSE
 15527             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15528
 15529     MOVE PI-ETYPE               TO AT-EXPENSE-TYPE.
 15530
 15531     MOVE PI-EPYFROM             TO DC-GREG-DATE-1-MDY.
 15532     MOVE '4'                    TO DC-OPTION-CODE.
 15533     PERFORM 9700-LINK-DATE-CONVERT.
 15534
 15535     IF DATE-CONVERSION-ERROR
 15536        MOVE LOW-VALUES          TO AT-PAID-FROM-DT
 15537     ELSE
 15538        MOVE DC-BIN-DATE-1       TO AT-PAID-FROM-DT.
 15539
 15540     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 15541     MOVE '4'                    TO DC-OPTION-CODE.
 15542     PERFORM 9700-LINK-DATE-CONVERT.
 15543
 15544     IF DATE-CONVERSION-ERROR
 15545        MOVE LOW-VALUES          TO AT-PAID-THRU-DT
 15546     ELSE
 15547        MOVE DC-BIN-DATE-1       TO AT-PAID-THRU-DT.
 15548
 15549     MOVE PI-EDAYS               TO AT-DAYS-IN-PERIOD.
 15550     GO TO 6150-FINISH-MOVE.
 15551
 15552 6140-PF5-ENTERED.
 15553     MOVE PI-CEXPENS             TO AT-EXPENSE-PER-PMT.
 15554     MOVE PI-CPYAMT              TO AT-AMOUNT-PAID.
 15555
 15556     IF PI-AIG-SPECIAL-BENEFIT
 15557         IF WS-1ST-SPECIAL-PMT
 15558             COMPUTE AT-AMOUNT-PAID ROUNDED = PI-CPYAMT / 1.5
 15559             COMPUTE PI-REDUND-PMTAMT = PI-CPYAMT -
 15560                                        AT-AMOUNT-PAID
 15561         ELSE
 15562             MOVE PI-REDUND-PMTAMT TO AT-AMOUNT-PAID.
 15563
 15564     MOVE PI-CPYFROM             TO AT-PAID-FROM-DT.
 15565     MOVE PI-CPYTHRU             TO AT-PAID-THRU-DT.
 15566     MOVE PI-CDAYS               TO AT-DAYS-IN-PERIOD.
 15567
 15568 6150-FINISH-MOVE.
 15569
 15570     IF PI-ECHECKNO = SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 298
* EL156.cbl
 15571         MOVE PI-CCHECKNO    TO AT-CHECK-NO
 15572     ELSE
 15573         MOVE PI-ECHECKNO    TO AT-CHECK-NO.
 15574
 15575     MOVE PI-PAYEE               TO AT-PAYEE-TYPE-CD.
 15576     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME.
 15577
 15578*    MOVE PI-GROUPED             TO AT-GROUPED-PAYMENT.
 15579*    MOVE PI-CASH                TO AT-CASH-PAYMENT.
 15580
 15581     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 15582         MOVE CL-ASSOCIATES      TO AT-ASSOCIATES.
 15583
 15584     IF PI-OFFLINE = 'N'
 15585        MOVE '1'                 TO AT-PAYMENT-ORIGIN
 15586        MOVE LOW-VALUES          TO AT-PMT-SELECT-DT
 15587     ELSE
 15588        MOVE PI-MONTH-END-SAVE   TO AT-PMT-SELECT-DT
 15589        MOVE '3'                 TO AT-PAYMENT-ORIGIN.
 15590
 15591     MOVE SPACES                 TO AT-AIG-UNEMP-IND.
 15592
 15593     IF WS-2ND-SPECIAL-PMT
 15594         MOVE 'Y'                TO AT-CASH-PAYMENT
 15595         MOVE SPACES             TO AT-CHECK-NO
 15596         MOVE '3'                TO AT-PAYMENT-ORIGIN
 15597         MOVE PI-MONTH-END-SAVE  TO AT-PMT-SELECT-DT
 15598         MOVE 'U'                TO AT-AIG-UNEMP-IND
 15599         MOVE 'I'                TO AT-PAYEE-TYPE-CD.
 15600
 15601     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 15602                                    AT-TO-BE-WRITTEN-DT.
 15603
 15604     IF PI-HOLDTIL NOT = ZEROS
 15605        MOVE PI-HOLDTIL          TO DC-GREG-DATE-1-MDY
 15606        MOVE '4'                 TO DC-OPTION-CODE
 15607        PERFORM 9700-LINK-DATE-CONVERT
 15608        IF PI-OFFLINE = 'N'
 15609           MOVE DC-BIN-DATE-1    TO AT-TO-BE-WRITTEN-DT
 15610        ELSE
 15611           MOVE DC-BIN-DATE-1    TO AT-CHECK-WRITTEN-DT.
 15612
 15613     MOVE PI-ERESV               TO AT-ADDL-RESERVE.
 15614     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 15615                                    AT-CHECK-QUE-SEQUENCE.
 15616
 15617     IF PI-PFKEY-USED = DFHPF4
 15618        MOVE '1'                 TO AT-FORCE-CONTROL.
 15619
 15620     IF PI-PMTTYPE NOT = '4' AND '5' AND '6'
 15621        MOVE CL-LAST-PMT-DT      TO AT-PREV-LAST-PMT-DT
 15622        MOVE CL-PAID-THRU-DT     TO AT-PREV-PAID-THRU-DT
 15623        MOVE CL-LAST-PMT-AMT     TO AT-PREV-LAST-PMT-AMT.
 15624
 15625     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 15626                                    AT-VOID-SELECT-DT
 15627                                    AT-VOID-ACCEPT-DT
 15628                                    AT-VOID-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 299
* EL156.cbl
 15629     IF (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F')
 15630        AND (PI-PMTTYPE NOT = '4' AND '5' AND '6')
 15631        MOVE PI-DAILY-RATE       TO AT-DAILY-RATE
 15632        MOVE PI-BEN-DAYS         TO AT-ELIMINATION-DAYS
 15633        MOVE PI-BEN-TYPE         TO AT-BENEFIT-TYPE
 15634     ELSE
 15635        MOVE ZEROS               TO AT-DAILY-RATE
 15636                                    AT-ELIMINATION-DAYS
 15637        MOVE SPACES              TO AT-BENEFIT-TYPE
 15638     END-IF
 15639     MOVE PI-PROOF-DATE          TO DC-GREG-DATE-1-MDY.
 15640     MOVE '4'                    TO DC-OPTION-CODE.
 15641     PERFORM 9700-LINK-DATE-CONVERT.
 15642     IF DATE-CONVERSION-ERROR
 15643         MOVE LOW-VALUES          TO AT-PMT-PROOF-DT
 15644     ELSE
 15645         MOVE DC-BIN-DATE-1       TO AT-PMT-PROOF-DT
 15646     END-IF.
 15647     MOVE PI-PRINT-EOB-YN        TO AT-PRINT-EOB-WITH-CHECK
 15648     MOVE PI-PRINT-CLM-FRM-YN    TO AT-PRINT-CLM-FORM
 15649     MOVE PI-PRINT-SURVEY-YN     TO AT-PRINT-SURVEY
 15650     MOVE PI-SPECIAL-RELEASE-YN  TO AT-SPECIAL-RELEASE
 15651     IF (PI-REAUDIT-NEEDED = 'Y')
 15652        or (pi-max-ext-used = 'Y')
 15653        OR (PI-APPROVAL-3550-NEEDED = 'Y')
 15654         PERFORM 6155-READ-CONTROL
 15655         PERFORM 6157-SET-APP-LEVEL
 15656         IF AT-APPROVAL-LEVEL-REQD < '4'
 15657            MOVE '4' TO AT-APPROVAL-LEVEL-REQD
 15658         END-IF
 15659         MOVE 'Y' TO WS-NEED-APPROVAL
 15660         GO TO 6170-WRITE
 15661     END-IF.
 15662*******************************************************
 15663     IF NOT PI-PMT-GRADUATED
 15664         GO TO 6170-WRITE.
 15665     PERFORM 6155-READ-CONTROL.
 15666
 15667     IF PAID-FOR-LIFE
 15668         IF AT-AMOUNT-PAID < PI-MAX-LF-PMT-TOL
 15669             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15670                                     WS-PMT-APPROVAL-SW
 15671             GO TO 6170-WRITE.
 15672
 15673*05999      IF PAID-FOR-AH
 15674     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15675         IF AT-AMOUNT-PAID < PI-MAX-PMT-TOL
 15676             MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15677                                     WS-PMT-APPROVAL-SW
 15678             GO TO 6170-WRITE.
 15679
 15680     MOVE '1'                    TO AT-APPROVED-LEVEL.
 15681
 15682     PERFORM 6157-SET-APP-LEVEL.
 15683
 15684     MOVE AT-APPROVAL-LEVEL-REQD TO WS-SAVE-APPROVAL-LEVEL-REQD.
 15685
 15686     IF NOT PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 300
* EL156.cbl
 15687         GO TO 6170-WRITE.
 15688
 15689
 15690* EXEC CICS HANDLE CONDITION
 15691*        NOTFND   (6170-WRITE)
 15692*    END-EXEC.
 15693*    MOVE '"$I                   ! 2 #00014717' TO DFHEIV0
 15694     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15695     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15696     MOVE X'3220233030303134373137' TO DFHEIV0(25:11)
 15697     CALL 'kxdfhei1' USING DFHEIV0
 15698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15699
 15700
 15701     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15702     MOVE '2'                    TO CNTL-REC-TYPE.
 15703     MOVE +0                     TO CNTL-SEQ-NO.
 15704     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 15705
 15706
 15707* EXEC CICS READ
 15708*         DATASET  ('ELCNTL')
 15709*         SET      (ADDRESS OF CONTROL-FILE)
 15710*         RIDFLD   (ELCNTL-KEY)
 15711*    END-EXEC.
 15712     MOVE 'ELCNTL' TO DFHEIV1
 15713*    MOVE '&"S        E          (   #00014726' TO DFHEIV0
 15714     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15715     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15716     MOVE X'2020233030303134373236' TO DFHEIV0(25:11)
 15717     CALL 'kxdfhei1' USING DFHEIV0,
 15718           DFHEIV1,
 15719           DFHEIV20,
 15720           DFHEIV99,
 15721           ELCNTL-KEY,
 15722           DFHEIV99,
 15723           DFHEIV99,
 15724           DFHEIV99
 15725     SET ADDRESS OF CONTROL-FILE TO
 15726         DFHEIV20
 15727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15728
 15729
 15730     MOVE CF-APPROVAL-LEVEL TO WS-APPROVAL-LEVEL.
 15731
 15732     IF WS-APPROVAL-LEVEL = '1' OR '2' OR '3'
 15733                         OR '4' OR '5'
 15734         NEXT SENTENCE
 15735     ELSE
 15736         MOVE 'Y' TO WS-NEED-APPROVAL
 15737         GO TO 6170-WRITE.
 15738
 15739     IF WS-APPROVAL-LEVEL < AT-APPROVAL-LEVEL-REQD
 15740         MOVE 'Y' TO WS-NEED-APPROVAL
 15741         IF WS-APPROVAL-LEVEL = '1'
 15742             MOVE '2'        TO  AT-APPROVED-LEVEL
 15743                            WS-SAVE-APPROVED-LEVEL
 15744             GO TO 6170-WRITE
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 301
* EL156.cbl
 15745         ELSE
 15746             IF WS-APPROVAL-LEVEL = '2'
 15747                 MOVE '3'        TO  AT-APPROVED-LEVEL
 15748                                WS-SAVE-APPROVED-LEVEL
 15749                 GO TO 6170-WRITE
 15750             ELSE IF WS-APPROVAL-LEVEL = '3'
 15751                 MOVE '4'        TO  AT-APPROVED-LEVEL
 15752                                WS-SAVE-APPROVED-LEVEL
 15753                 GO TO 6170-WRITE
 15754             ELSE IF WS-APPROVAL-LEVEL = '4'
 15755                 MOVE '5'        TO  AT-APPROVED-LEVEL
 15756                                WS-SAVE-APPROVED-LEVEL
 15757                 GO TO 6170-WRITE.
 15758
 15759     MOVE 'A'            TO  AT-PAYMENT-APPROVAL-SW
 15760                             WS-PMT-APPROVAL-SW.
 15761     MOVE SPACES         TO  AT-APPROVED-LEVEL
 15762                             AT-APPROVAL-LEVEL-REQD.
 15763
 15764*******************************************************
 15765 6155-READ-CONTROL.
 15766     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 15767     MOVE '1'                    TO CNTL-REC-TYPE.
 15768     MOVE SPACES                 TO CNTL-ACCESS.
 15769     MOVE +0                     TO CNTL-SEQ-NO.
 15770     MOVE 'COMP'                 TO FILE-SWITCH.
 15771
 15772     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 15773 6157-SET-APP-LEVEL.
 15774******A&H Limits are set as a monthly payment.  Calculate the mont
 15775******equivalent of the amount paid today
 15776     IF PI-SAVE-ELAPSED-MONTHS > 0 OR
 15777        PI-SAVE-ODD-DAYS-OVER > 0
 15778           COMPUTE WS-CALC-PMT-MONTHS = (PI-SAVE-ODD-DAYS-OVER
 15779                               / 30) + PI-SAVE-ELAPSED-MONTHS
 15780           COMPUTE WS-CALC-MO-AH-AMT ROUNDED = AT-AMOUNT-PAID /
 15781                                  WS-CALC-PMT-MONTHS
 15782     ELSE
 15783           MOVE AT-AMOUNT-PAID TO WS-CALC-MO-AH-AMT
 15784     END-IF.
 15785*06007      IF ((PAID-FOR-AH) AND
 15786     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15787*06008         (CF-AH-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15788        (CF-AH-PAY-APP-LEVEL-1 >= WS-CALC-MO-AH-AMT))
 15789              OR
 15790        ((PAID-FOR-LIFE) AND
 15791        (CF-LIFE-PAY-APP-LEVEL-1 >= AT-AMOUNT-PAID))
 15792            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15793       ELSE
 15794*06014      IF ((PAID-FOR-AH)  AND
 15795         IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15796*06015         (CF-AH-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15797           (CF-AH-PAY-APP-LEVEL-2 >= WS-CALC-MO-AH-AMT))
 15798              OR
 15799        ((PAID-FOR-LIFE) AND
 15800        (CF-LIFE-PAY-APP-LEVEL-2 >= AT-AMOUNT-PAID))
 15801            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15802         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 302
* EL156.cbl
 15803*06021             MOVE '3'         TO AT-APPROVAL-LEVEL-REQD.
 15804           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15805               (CF-AH-PAY-APP-LEVEL-3 >= WS-CALC-MO-AH-AMT))
 15806              OR
 15807          ((PAID-FOR-LIFE) AND
 15808          (CF-LIFE-PAY-APP-LEVEL-3 >= AT-AMOUNT-PAID))
 15809            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15810       ELSE
 15811           IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15812               (CF-AH-PAY-APP-LEVEL-4 >= WS-CALC-MO-AH-AMT))
 15813              OR
 15814          ((PAID-FOR-LIFE) AND
 15815          (CF-LIFE-PAY-APP-LEVEL-4 >= AT-AMOUNT-PAID))
 15816            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15817       ELSE
 15818            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15819
 15820     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15821        (CF-AH-APP-DAY-LEVEL-1 >= AT-DAYS-IN-PERIOD))
 15822        IF ('1' >= AT-APPROVAL-LEVEL-REQD)
 15823            MOVE '1'         TO AT-APPROVAL-LEVEL-REQD
 15824        END-IF
 15825     ELSE
 15826     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15827        (CF-AH-APP-DAY-LEVEL-2 >= AT-DAYS-IN-PERIOD))
 15828        IF ('2' >= AT-APPROVAL-LEVEL-REQD)
 15829            MOVE '2'         TO AT-APPROVAL-LEVEL-REQD
 15830        END-IF
 15831     ELSE
 15832     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15833        (CF-AH-APP-DAY-LEVEL-3 >= AT-DAYS-IN-PERIOD))
 15834        IF ('3' >= AT-APPROVAL-LEVEL-REQD)
 15835            MOVE '3'         TO AT-APPROVAL-LEVEL-REQD
 15836        END-IF
 15837     ELSE
 15838     IF ((PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP) AND
 15839        (CF-AH-APP-DAY-LEVEL-4 >= AT-DAYS-IN-PERIOD))
 15840        IF ('4' >= AT-APPROVAL-LEVEL-REQD)
 15841            MOVE '4'         TO AT-APPROVAL-LEVEL-REQD
 15842        END-IF
 15843     ELSE
 15844     IF (PAID-FOR-AH OR PAID-FOR-IUI OR PAID-FOR-GAP)
 15845            MOVE '5'         TO AT-APPROVAL-LEVEL-REQD.
 15846
 15847 6170-WRITE.
 15848
 15849     if pi-company-id = 'DCC'
 15850        PERFORM 0900-GET-DDF-limits
 15851                                 THRU 0900-EXIT
 15852     end-if
 15853     perform 2220-update-elcrtt  thru 2220-exit
 15854     IF PI-COMPANY-ID = 'DMD'
 15855        IF PI-AT-EOB-CODES NOT = SPACES
 15856           MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 15857           MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 15858           MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 15859           MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 15860           MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 303
* EL156.cbl
 15861
 15862
 15863* EXEC CICS HANDLE CONDITION
 15864*        DUPREC    (6180-DUPREC)
 15865*    END-EXEC.
 15866*    MOVE '"$%                   ! 3 #00014864' TO DFHEIV0
 15867     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15868     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15869     MOVE X'3320233030303134383634' TO DFHEIV0(25:11)
 15870     CALL 'kxdfhei1' USING DFHEIV0
 15871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15872
 15873
 15874
 15875* EXEC CICS WRITE
 15876*         DATASET       ('ELTRLR')
 15877*         FROM          (ACTIVITY-TRAILERS)
 15878*         RIDFLD        (AT-CONTROL-PRIMARY)
 15879*     END-EXEC.
 15880     MOVE LENGTH OF
 15881      ACTIVITY-TRAILERS
 15882       TO DFHEIV11
 15883     MOVE 'ELTRLR' TO DFHEIV1
 15884*    MOVE '&$ L                  ''   #00014868' TO DFHEIV0
 15885     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15886     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15887     MOVE X'2020233030303134383638' TO DFHEIV0(25:11)
 15888     CALL 'kxdfhei1' USING DFHEIV0,
 15889           DFHEIV1,
 15890           ACTIVITY-TRAILERS,
 15891           DFHEIV11,
 15892           AT-CONTROL-PRIMARY,
 15893           DFHEIV99,
 15894           DFHEIV99
 15895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15896
 15897
 15898     IF (PI-PMTNOTE1 = SPACES OR LOW-VALUES) AND
 15899        (PI-PMTNOTE2 = SPACES OR LOW-VALUES)
 15900*06088           GO TO 6199-EXIT.
 15901           GO TO 6176-APPROVAL-NOTE.
 15902
 15903
 15904* EXEC CICS GETMAIN
 15905*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15906*         LENGTH    (200)
 15907*         INITIMG   (GETMAIN-SPACE)
 15908*     END-EXEC.
 15909     MOVE 200
 15910       TO DFHEIV11
 15911*    MOVE ',"IL                  $   #00014879' TO DFHEIV0
 15912     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15913     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15914     MOVE X'2020233030303134383739' TO DFHEIV0(25:11)
 15915     CALL 'kxdfhei1' USING DFHEIV0,
 15916           DFHEIV20,
 15917           DFHEIV11,
 15918           GETMAIN-SPACE
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 304
* EL156.cbl
 15919     SET ADDRESS OF ACTIVITY-TRAILERS TO
 15920         DFHEIV20
 15921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15922
 15923
 15924     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 15925
 15926     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY.
 15927     MOVE 'AT'                   TO AT-RECORD-ID.
 15928     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 15929     MOVE '6'                    TO AT-TRAILER-TYPE.
 15930     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 15931                                    AT-GEN-INFO-LAST-MAINT-DT
 15932     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 15933                                    AT-GEN-INFO-LAST-UPDATED-BY
 15934     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 15935
 15936     MOVE PI-PMTNOTE1            TO AT-INFO-LINE-1.
 15937     MOVE PI-PMTNOTE2            TO AT-INFO-LINE-2
 15938     MOVE PI-EOB-CODES-EXIST     TO AT-EOB-CODES-EXIST
 15939
 15940     MOVE 'P'                    TO AT-INFO-TRAILER-TYPE.
 15941
 15942 6175-WRITE.
 15943
 15944
 15945* EXEC CICS HANDLE CONDITION
 15946*        DUPREC    (6190-DUPREC)
 15947*    END-EXEC.
 15948*    MOVE '"$%                   ! 4 #00014905' TO DFHEIV0
 15949     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 15950     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15951     MOVE X'3420233030303134393035' TO DFHEIV0(25:11)
 15952     CALL 'kxdfhei1' USING DFHEIV0
 15953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15954
 15955
 15956
 15957* EXEC CICS WRITE
 15958*         DATASET     ('ELTRLR')
 15959*         FROM        (ACTIVITY-TRAILERS)
 15960*         RIDFLD      (AT-CONTROL-PRIMARY)
 15961*     END-EXEC.
 15962     MOVE LENGTH OF
 15963      ACTIVITY-TRAILERS
 15964       TO DFHEIV11
 15965     MOVE 'ELTRLR' TO DFHEIV1
 15966*    MOVE '&$ L                  ''   #00014909' TO DFHEIV0
 15967     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15968     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15969     MOVE X'2020233030303134393039' TO DFHEIV0(25:11)
 15970     CALL 'kxdfhei1' USING DFHEIV0,
 15971           DFHEIV1,
 15972           ACTIVITY-TRAILERS,
 15973           DFHEIV11,
 15974           AT-CONTROL-PRIMARY,
 15975           DFHEIV99,
 15976           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 305
* EL156.cbl
 15977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15978
 15979
 15980 6176-APPROVAL-NOTE.
 15981
 15982     IF NOT APPROVAL-NEEDED
 15983         GO TO 6199-EXIT.
 15984
 15985
 15986* EXEC CICS GETMAIN
 15987*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 15988*        LENGTH    (200)
 15989*        INITIMG   (GETMAIN-SPACE)
 15990*    END-EXEC.
 15991     MOVE 200
 15992       TO DFHEIV11
 15993*    MOVE ',"IL                  $   #00014920' TO DFHEIV0
 15994     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15995     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15996     MOVE X'2020233030303134393230' TO DFHEIV0(25:11)
 15997     CALL 'kxdfhei1' USING DFHEIV0,
 15998           DFHEIV20,
 15999           DFHEIV11,
 16000           GETMAIN-SPACE
 16001     SET ADDRESS OF ACTIVITY-TRAILERS TO
 16002         DFHEIV20
 16003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16004
 16005
 16006     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT
 16007
 16008     MOVE ELMSTR-KEY         TO AT-CONTROL-PRIMARY
 16009     MOVE 'AT'               TO AT-RECORD-ID
 16010     MOVE CL-TRAILER-SEQ-CNT TO AT-SEQUENCE-NO
 16011     MOVE '6'                TO AT-TRAILER-TYPE
 16012     MOVE WS-TODAY-DATE      TO AT-RECORDED-DT
 16013                                AT-GEN-INFO-LAST-MAINT-DT
 16014     MOVE PI-PROCESSOR-ID    TO AT-RECORDED-BY
 16015                                AT-GEN-INFO-LAST-UPDATED-BY
 16016     MOVE EIBTIME            TO AT-LAST-MAINT-HHMMSS
 16017
 16018     IF PI-REAUDIT-NEEDED = 'Y'
 16019         MOVE WS-REAUDIT-NOTE TO AT-INFO-LINE-1
 16020     ELSE
 16021         MOVE WS-APPROV-NOTE  TO AT-INFO-LINE-1
 16022     END-IF
 16023     IF PI-APPROVAL-3550-NEEDED = 'Y'
 16024         MOVE WS-3550-APPROV-NOTE TO AT-INFO-LINE-1
 16025     END-IF
 16026     MOVE SPACES             TO AT-INFO-LINE-2
 16027
 16028     MOVE 'R'                TO AT-INFO-TRAILER-TYPE.
 16029 6177-WRITE.
 16030
 16031
 16032* EXEC CICS HANDLE CONDITION
 16033*        DUPREC    (6185-DUPREC)
 16034*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 306
* EL156.cbl
 16035*    MOVE '"$%                   ! 5 #00014951' TO DFHEIV0
 16036     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 16037     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16038     MOVE X'3520233030303134393531' TO DFHEIV0(25:11)
 16039     CALL 'kxdfhei1' USING DFHEIV0
 16040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16041
 16042
 16043
 16044* EXEC CICS WRITE
 16045*         DATASET     ('ELTRLR')
 16046*         FROM        (ACTIVITY-TRAILERS)
 16047*         RIDFLD      (AT-CONTROL-PRIMARY)
 16048*     END-EXEC.
 16049     MOVE LENGTH OF
 16050      ACTIVITY-TRAILERS
 16051       TO DFHEIV11
 16052     MOVE 'ELTRLR' TO DFHEIV1
 16053*    MOVE '&$ L                  ''   #00014955' TO DFHEIV0
 16054     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16055     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16056     MOVE X'2020233030303134393535' TO DFHEIV0(25:11)
 16057     CALL 'kxdfhei1' USING DFHEIV0,
 16058           DFHEIV1,
 16059           ACTIVITY-TRAILERS,
 16060           DFHEIV11,
 16061           AT-CONTROL-PRIMARY,
 16062           DFHEIV99,
 16063           DFHEIV99
 16064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16065
 16066
 16067
 16068     GO TO 6199-EXIT.
 16069
 16070 6180-DUPREC.
 16071
 16072     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16073     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16074     GO TO 6170-WRITE.
 16075
 16076 6185-DUPREC.
 16077     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16078     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16079     GO TO 6177-WRITE.
 16080
 16081 6190-DUPREC.
 16082     SUBTRACT +1 FROM CL-TRAILER-SEQ-CNT.
 16083     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
 16084     GO TO 6175-WRITE.
 16085
 16086 6199-EXIT.
 16087      EXIT.
 16088
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 307
* EL156.cbl
 16090 6200-UPDATE-CLAIM-MSTR.
 16091     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 16092     MOVE PI-CARRIER             TO MSTR-CARRIER.
 16093     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 16094     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 16095
 16096     PERFORM 7910-READ-CLAIM-UPDATE THRU 7910-EXIT.
 16097
 16098     MOVE ZEROS                  TO W-INTEREST.
 16099
 16100     IF PI-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'AHL'
 16101        IF (PI-OFFLINE = 'Y') OR
 16102           (PI-PMTTYPE = '7')
 16103           PERFORM 9870-OUTPUT-ACTIVITY-RECORD
 16104                                 THRU 9870-EXIT
 16105        END-IF
 16106     END-IF
 16107     IF NOT ERROR-ON-OUTPUT
 16108        CONTINUE
 16109     ELSE
 16110
 16111* EXEC CICS REWRITE
 16112*          DATASET('ELMSTR')
 16113*          FROM(CLAIM-MASTER)
 16114*       END-EXEC
 16115     MOVE LENGTH OF
 16116      CLAIM-MASTER
 16117       TO DFHEIV11
 16118     MOVE 'ELMSTR' TO DFHEIV1
 16119*    MOVE '&& L                  %   #00015004' TO DFHEIV0
 16120     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16121     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16122     MOVE X'2020233030303135303034' TO DFHEIV0(25:11)
 16123     CALL 'kxdfhei1' USING DFHEIV0,
 16124           DFHEIV1,
 16125           CLAIM-MASTER,
 16126           DFHEIV11,
 16127           DFHEIV99
 16128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16129
 16130        MOVE -1                  TO ENTPFBL
 16131        MOVE AL-UANON            TO ENTPFBA
 16132        MOVE MAP-NAMEB           TO MAP-NAME
 16133        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16134        GO TO 8200-SEND-DATAONLY
 16135     END-IF
 16136
 16137     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT.
 16138
 16139     MOVE SPACES TO WS-PAYMENT-TRAILER-SW.
 16140
 16141     IF PI-AIG-SPECIAL-BENEFIT
 16142         MOVE '1' TO WS-PAYMENT-TRAILER-SW.
 16143
 16144     PERFORM 6100-BUILD-PAYMENT-TRAILER THRU 6199-EXIT.
 16145
 16146     IF PI-SPECIAL-BEN-SW = 'Y'
 16147         MOVE '2' TO WS-PAYMENT-TRAILER-SW
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 308
* EL156.cbl
 16148         PERFORM 6130-BUILD-TRAILER THRU 6199-EXIT.
 16149
 16150     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16151         PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT
 16152     ELSE
 16153         IF PI-PMTTYPE NOT = '4'
 16154            PERFORM 6400-UPDATE-ZERO-TRAILER THRU 6499-EXIT.
 16155
 16156     IF PI-PMTTYPE = '5' OR '6'
 16157        GO TO  6250-SET-MAINT.
 16158
 16159     MOVE ZEROS                      TO  CL-LAPSE-REPORT-CODE
 16160                                         CL-LAG-REPORT-CODE.
 16161
 16162     IF CL-ACTIVITY-CODE = 09
 16163         GO TO 6200-CONT-UPDATE.
 16164
 16165     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16166         IF CL-ACTIVITY-CODE = 11
 16167             GO TO 6200-CONT-UPDATE.
 16168
 16169     IF WS-ACT-REC-FOUND-SW = 'N'
 16170         GO TO 6200-CONT-UPDATE.
 16171
 16172     IF PI-RESET-SW = 'Y' OR PI-PROV-PMT
 16173         MOVE WS-TODAY-DATE          TO  CL-ACTIVITY-MAINT-DT
 16174         MOVE 'PMT'                  TO  CL-ACTIVITY-MAINT-TYPE
 16175         MOVE WS-ACTIVITY-CODE       TO  CL-ACTIVITY-CODE.
 16176
 16177     IF WS-UPDATE-SW = 'Y'
 16178         MOVE LOW-VALUES             TO  CL-NEXT-RESEND-DT
 16179                                         CL-NEXT-FOLLOWUP-DT.
 16180
 16181 6200-CONT-UPDATE.
 16182
 16183     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16184       IF CLAIM-IS-CLOSED
 16185         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16186           IF WS-OPEN-CLOSE-SW = '2'
 16187             MOVE WS-TODAY-DATE     TO  CL-LAST-REOPEN-DT
 16188                                        CL-LAST-CLOSE-DT.
 16189
 16190     IF CLAIM-IS-CLOSED AND PI-PMTTYPE = '1'
 16191        MOVE WS-TODAY-DATE       TO CL-LAST-REOPEN-DT
 16192        MOVE 'O'                 TO CL-CLAIM-STATUS.
 16193
 16194     IF PI-PMTTYPE = ('2' OR '3') AND CLAIM-IS-OPEN
 16195        MOVE WS-TODAY-DATE       TO CL-LAST-CLOSE-DT
 16196        MOVE '1'                 TO CL-LAST-CLOSE-REASON
 16197        MOVE 'C'                 TO CL-CLAIM-STATUS
 16198        IF PI-PMTTYPE = '2'
 16199           AND (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16200              or 'F')
 16201           CONTINUE
 16202        ELSE
 16203           PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16204        END-IF
 16205     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 309
* EL156.cbl
 16206        IF PI-PMTTYPE = '2' OR '3'
 16207           IF PI-PMTTYPE = '2' AND
 16208              (CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G'
 16209                 or 'F')
 16210              CONTINUE
 16211           ELSE
 16212              PERFORM 6300-UPDATE-CERT THRU 6399-EXIT
 16213           END-IF
 16214        END-IF
 16215     END-IF
 16216
 16217     IF PI-PMTTYPE = '4'
 16218        PERFORM 6300-UPDATE-CERT THRU 6399-EXIT.
 16219
 16220     IF PI-COMPANY-ID = 'CVL'
 16221         IF PI-LOAN-UPDATE-SW = 'Y'
 16222             MOVE PI-COMPANY-CD      TO  CERT-COMP-CD
 16223             MOVE CL-CERT-CARRIER    TO  CERT-CARRIER
 16224             MOVE CL-CERT-GROUPING   TO  CERT-GROUPING
 16225             MOVE CL-CERT-STATE      TO  CERT-STATE
 16226             MOVE CL-CERT-ACCOUNT    TO  CERT-ACCOUNT
 16227             MOVE CL-CERT-EFF-DT     TO  CERT-EFF-DT
 16228             MOVE CL-CERT-NO         TO  CERT-CERT-NO
 16229             MOVE 'CERT'             TO  FILE-SWITCH
 16230             PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT
 16231             MOVE PI-LOAN-NO         TO  CM-BENEFICIARY
 16232             PERFORM 6350-REWRITE-CERT THRU 6399-EXIT.
 16233
 16234     IF PI-PFKEY-USED = DFHPF5 AND PI-PROCESSOR-ID NOT = 'FIX '
 16235        GO TO 6220-USE-COMPUTED.
 16236
 16237     IF (PI-PMTTYPE = '4')  AND
 16238        (PI-EPYAMT < ZEROS)
 16239          COMPUTE CL-NO-OF-DAYS-PAID =
 16240                       CL-NO-OF-DAYS-PAID - PI-EDAYS
 16241          IF CL-NO-OF-DAYS-PAID < +0
 16242              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16243          ELSE
 16244              NEXT SENTENCE
 16245     ELSE
 16246          ADD PI-EDAYS           TO CL-NO-OF-DAYS-PAID.
 16247
 16248     IF PI-PROCESSOR-ID = 'FIX '
 16249        IF CL-TOTAL-PAID-AMT NOT = ZEROS
 16250           NEXT SENTENCE
 16251        ELSE
 16252           ADD PI-EPYAMT         TO CL-TOTAL-PAID-AMT
 16253     ELSE
 16254        ADD PI-EPYAMT            TO CL-TOTAL-PAID-AMT.
 16255
 16256     IF PI-PMTTYPE = '4'
 16257        GO TO 6250-SET-MAINT.
 16258
 16259     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16260
 16261     MOVE PI-EPYTHRU             TO DC-GREG-DATE-1-MDY.
 16262     MOVE '4'                    TO DC-OPTION-CODE.
 16263     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 310
* EL156.cbl
 16264     IF DATE-CONVERSION-ERROR
 16265        MOVE LOW-VALUES          TO CL-PAID-THRU-DT
 16266     ELSE
 16267        IF DC-BIN-DATE-1 > CL-PAID-THRU-DT
 16268           MOVE DC-BIN-DATE-1    TO CL-PAID-THRU-DT
 16269           IF PI-AIG-SPECIAL-BENEFIT
 16270               COMPUTE CL-LAST-PMT-AMT = PI-EPYAMT / 1.5
 16271           ELSE
 16272               MOVE PI-EPYAMT        TO CL-LAST-PMT-AMT.
 16273
 16274     GO TO 6250-SET-MAINT.
 16275
 16276 6220-USE-COMPUTED.
 16277
 16278     IF (PI-PMTTYPE = '4')  AND
 16279        (PI-CPYAMT < ZEROS)
 16280          COMPUTE CL-NO-OF-DAYS-PAID =
 16281                       CL-NO-OF-DAYS-PAID - PI-CDAYS
 16282          IF CL-NO-OF-DAYS-PAID < +0
 16283              MOVE ZEROS TO CL-NO-OF-DAYS-PAID
 16284          ELSE
 16285              NEXT SENTENCE
 16286     ELSE
 16287          ADD PI-CDAYS           TO CL-NO-OF-DAYS-PAID.
 16288
 16289     ADD PI-CPYAMT               TO CL-TOTAL-PAID-AMT.
 16290
 16291     IF PI-PMTTYPE = '4'
 16292        GO TO 6250-SET-MAINT.
 16293
 16294     IF PI-AIG-SPECIAL-BENEFIT
 16295         COMPUTE CL-LAST-PMT-AMT = PI-CPYAMT / 1.5
 16296     ELSE
 16297         MOVE PI-CPYAMT        TO CL-LAST-PMT-AMT.
 16298
 16299     ADD 1                       TO CL-NO-OF-PMTS-MADE.
 16300
 16301     IF PI-CPYTHRU > CL-PAID-THRU-DT
 16302        MOVE PI-CPYTHRU          TO CL-PAID-THRU-DT.
 16303
 16304 6250-SET-MAINT.
 16305     MOVE WS-TODAY-DATE          TO CL-LAST-MAINT-DT.
 16306
 16307     IF PI-PROCESSOR-ID = 'FIX '
 16308        IF DC-BIN-DATE-1 = CL-PAID-THRU-DT
 16309           MOVE WS-TODAY-DATE    TO CL-LAST-PMT-DT
 16310        ELSE
 16311           NEXT SENTENCE
 16312     ELSE
 16313        MOVE WS-TODAY-DATE       TO CL-LAST-PMT-DT.
 16314
 16315     MOVE PI-PROCESSOR-ID        TO CL-LAST-MAINT-USER.
 16316     MOVE EIBTIME                TO CL-LAST-MAINT-HHMMSS.
 16317     MOVE '1'                    TO CL-LAST-MAINT-TYPE.
 16318
 16319 6299-EXIT.
 16320      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 311
* EL156.cbl
 16322 6300-UPDATE-CERT.
 16323
 16324*  ADD CERTNOTE FOR SC NP+6
 16325     IF PI-COMPANY-ID = 'CID' AND
 16326       (PI-PMTTYPE = '2' OR '3') AND
 16327        CL-CERT-STATE = 'SC'  AND
 16328        (PI-LF-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
 16329           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16330     END-IF.
 16331
 16332     IF PI-COMPANY-ID = 'AHL' AND
 16333       (PI-PMTTYPE = '2' OR '3') AND
 16334        (PI-LF-BENEFIT-CD = '5I' OR '6J' OR '5M' OR '6M' OR
 16335           '5G' OR '5J' OR '5S' OR '6D' OR '6H' OR '6R')
 16336           PERFORM 7180-ADD-CERT-NOTE THRU 7189-EXIT
 16337     END-IF.
 16338
 16339     MOVE PI-COMPANY-CD    TO CERT-COMP-CD.
 16340     MOVE CL-CERT-CARRIER  TO CERT-CARRIER.
 16341     MOVE CL-CERT-GROUPING TO CERT-GROUPING.
 16342     MOVE CL-CERT-STATE    TO CERT-STATE.
 16343     MOVE CL-CERT-ACCOUNT  TO CERT-ACCOUNT.
 16344     MOVE CL-CERT-EFF-DT   TO CERT-EFF-DT.
 16345     MOVE CL-CERT-NO       TO CERT-CERT-NO.
 16346     MOVE 'CERT'           TO FILE-SWITCH.
 16347
 16348     PERFORM 7980-READ-CERT-UPDATE THRU 7980-EXIT.
 16349
 16350     IF CERT-NOTE-ADDED
 16351        IF CM-NOTE-SW = ' '
 16352           MOVE '4'             TO CM-NOTE-SW
 16353        ELSE
 16354           IF CM-NOTE-SW = '1'
 16355               MOVE '5'           TO CM-NOTE-SW
 16356           ELSE
 16357              IF CM-NOTE-SW = '2'
 16358                 MOVE '6'         TO CM-NOTE-SW
 16359              ELSE
 16360                 IF CM-NOTE-SW = '3'
 16361                    MOVE '7'      TO CM-NOTE-SW
 16362                 END-IF
 16363              END-IF
 16364           END-IF
 16365        END-IF
 16366     END-IF.
 16367
 16368     IF PI-COMPANY-ID = 'CVL'
 16369         MOVE PI-LOAN-NO   TO  CM-BENEFICIARY
 16370         MOVE 'N'          TO  PI-LOAN-UPDATE-SW.
 16371
 16372     IF PI-PMTTYPE NOT = '4'
 16373        GO TO 6340-UPDATE-CERT.
 16374
 16375     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16376        IF PI-PFKEY-USED = DFHPF5
 16377           ADD PI-CPYAMT         TO CM-LF-ITD-DEATH-AMT
 16378        ELSE
 16379           ADD PI-EPYAMT         TO CM-LF-ITD-DEATH-AMT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 312
* EL156.cbl
 16380
 16381*    IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16382*        IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16383*            IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16384*               PI-LF-COVERAGE-TYPE = 'P'
 16385*                GO TO 6350-REWRITE-CERT.
 16386
 16387     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16388       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16389          PI-LF-COVERAGE-TYPE = 'P'
 16390           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16391                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16392                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16393                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16394                MOVE '7'                  TO CM-LF-CURRENT-STATUS
 16395                GO TO 6350-REWRITE-CERT
 16396            ELSE
 16397                GO TO 6350-REWRITE-CERT.
 16398
 16399     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16400         GO TO 6350-REWRITE-CERT.
 16401
 16402     IF NOT CM-AH-LUMP-SUM-DISAB
 16403        GO TO 6380-UNLOCK-CERT.
 16404
 16405     IF PI-PFKEY-USED = DFHPF5
 16406        ADD PI-CPYAMT            TO CM-AH-ITD-LUMP-PMT
 16407                                    CM-AH-ITD-AH-PMT
 16408        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16409        GO TO 6350-REWRITE-CERT
 16410     ELSE
 16411        ADD PI-EPYAMT            TO CM-AH-ITD-LUMP-PMT
 16412                                    CM-AH-ITD-AH-PMT
 16413        MOVE PI-EPYTHRU          TO CM-AH-PAID-THRU-DT
 16414        GO TO 6350-REWRITE-CERT.
 16415
 16416 6340-UPDATE-CERT.
 16417
 16418     IF CL-CLAIM-TYPE = 'L'
 16419         IF PI-PFKEY-USED = DFHPF5
 16420             ADD PI-CPYAMT          TO CM-LF-ITD-DEATH-AMT
 16421         ELSE
 16422             ADD PI-EPYAMT          TO CM-LF-ITD-DEATH-AMT.
 16423
 16424     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16425         IF PI-COMPANY-ID = 'ACC' OR 'FDL'
 16426             IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16427                PI-LF-COVERAGE-TYPE = 'P'
 16428                 GO TO 6350-REWRITE-CERT.
 16429
 16430     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16431       IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 16432          PI-LF-COVERAGE-TYPE = 'P'
 16433           IF CM-LF-ITD-DEATH-AMT >= CM-LF-BENEFIT-AMT
 16434                MOVE CL-INCURRED-DT       TO CM-LF-DEATH-DT
 16435                MOVE PI-MONTH-END-SAVE    TO CM-LF-DEATH-EXIT-DT
 16436                MOVE CM-LF-CURRENT-STATUS TO CM-LF-STATUS-AT-DEATH
 16437                MOVE '7'                  TO CM-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 313
* EL156.cbl
 16438                GO TO 6350-REWRITE-CERT.
 16439
 16440     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 16441         IF PI-LIFE-OVERRIDE-L1 = 'L' AND
 16442            PI-LF-COVERAGE-TYPE NOT = 'P'
 16443             MOVE CL-INCURRED-DT         TO CM-LF-DEATH-DT
 16444             MOVE PI-MONTH-END-SAVE      TO CM-LF-DEATH-EXIT-DT
 16445             MOVE CM-LF-CURRENT-STATUS   TO CM-LF-STATUS-AT-DEATH
 16446             MOVE '7'                    TO CM-LF-CURRENT-STATUS
 16447             GO TO 6350-REWRITE-CERT.
 16448
 16449     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 16450         MOVE CL-INCURRED-DT         TO CM-AH-SETTLEMENT-DT
 16451         MOVE PI-MONTH-END-SAVE      TO CM-AH-SETTLEMENT-EXIT-DT
 16452         MOVE CM-AH-CURRENT-STATUS   TO CM-AH-STATUS-AT-SETTLEMENT
 16453         MOVE '6'                    TO CM-AH-CURRENT-STATUS
 16454         MOVE PI-EPYTHRU             TO CM-AH-PAID-THRU-DT
 16455         IF PI-PFKEY-USED = DFHPF5
 16456             ADD PI-CPYAMT           TO CM-AH-ITD-LUMP-PMT
 16457                                        CM-AH-ITD-AH-PMT
 16458             GO TO 6350-REWRITE-CERT
 16459         ELSE
 16460             ADD PI-EPYAMT           TO CM-AH-ITD-LUMP-PMT
 16461                                        CM-AH-ITD-AH-PMT
 16462             GO TO 6350-REWRITE-CERT.
 16463
 16464 6350-REWRITE-CERT.
 16465
 16466
 16467* EXEC CICS REWRITE
 16468*         DATASET  ('ELCERT')
 16469*         FROM(CERTIFICATE-MASTER)
 16470*     END-EXEC.
 16471     MOVE LENGTH OF
 16472      CERTIFICATE-MASTER
 16473       TO DFHEIV11
 16474     MOVE 'ELCERT' TO DFHEIV1
 16475*    MOVE '&& L                  %   #00015345' TO DFHEIV0
 16476     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16477     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16478     MOVE X'2020233030303135333435' TO DFHEIV0(25:11)
 16479     CALL 'kxdfhei1' USING DFHEIV0,
 16480           DFHEIV1,
 16481           CERTIFICATE-MASTER,
 16482           DFHEIV11,
 16483           DFHEIV99
 16484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16485
 16486
 16487     GO TO 6399-EXIT.
 16488
 16489 6380-UNLOCK-CERT.
 16490
 16491* EXEC CICS UNLOCK
 16492*         DATASET  ('ELCERT')
 16493*     END-EXEC.
 16494     MOVE 'ELCERT' TO DFHEIV1
 16495*    MOVE '&*                    #   #00015353' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 314
* EL156.cbl
 16496     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 16497     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16498     MOVE X'2020233030303135333533' TO DFHEIV0(25:11)
 16499     CALL 'kxdfhei1' USING DFHEIV0,
 16500           DFHEIV1,
 16501           DFHEIV99
 16502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16503
 16504
 16505 6399-EXIT.
 16506      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 315
* EL156.cbl
 16508 6400-UPDATE-ZERO-TRAILER.
 16509     MOVE ELMSTR-KEY             TO ELTRLR-KEY.
 16510     MOVE ZEROS                  TO TRLR-SEQ-NO.
 16511
 16512     PERFORM 7960-READ-TRAILER-UPDATE THRU 7960-EXIT.
 16513
 16514     IF PI-EPYAMT NOT = ZEROS
 16515         SUBTRACT PI-EPYAMT    FROM AT-CURRENT-MANUAL-RESERVE
 16516     ELSE
 16517         SUBTRACT PI-CPYAMT    FROM AT-CURRENT-MANUAL-RESERVE.
 16518
 16519     IF PI-ERESV NOT = ZEROS
 16520        ADD PI-ERESV             TO AT-CURRENT-MANUAL-RESERVE.
 16521
 16522     IF AT-CURRENT-MANUAL-RESERVE NEGATIVE
 16523        MOVE ZEROS               TO AT-CURRENT-MANUAL-RESERVE.
 16524
 16525     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 16526        ADD PI-EEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE
 16527     ELSE
 16528        ADD PI-CEXPENS           TO AT-ITD-CHARGEABLE-EXPENSE.
 16529
 16530     IF PI-PMTTYPE = '5'
 16531        IF PI-EPYAMT = ZEROS
 16532           ADD PI-CPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE
 16533        ELSE
 16534           ADD PI-EPYAMT         TO AT-ITD-CHARGEABLE-EXPENSE.
 16535
 16536     IF PI-PMTTYPE = '6'
 16537        IF PI-EPYAMT = ZEROS
 16538           ADD PI-CPYAMT         TO AT-ITD-PAID-EXPENSES
 16539        ELSE
 16540           ADD PI-EPYAMT         TO AT-ITD-PAID-EXPENSES.
 16541
 16542 6420-CHECK-OPEN-CLOSE.
 16543     IF PI-PMTTYPE = '5' OR '6'
 16544        GO TO 6450-REWRITE.
 16545
 16546     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 16547         IF PI-PMTTYPE = '2' OR '3' OR '4'
 16548             IF CLAIM-IS-CLOSED
 16549                 MOVE '1'        TO  WS-OPEN-CLOSE-SW
 16550                 MOVE 1          TO  SUB-1
 16551                 GO TO 6440-AIG-LOOP.
 16552
 16553     IF (PI-PMTTYPE = '1' OR '4') AND CLAIM-IS-OPEN
 16554        GO TO 6450-REWRITE.
 16555
 16556     IF (PI-PMTTYPE = '2' OR '3') AND CLAIM-IS-CLOSED
 16557        GO TO 6450-REWRITE.
 16558
 16559     MOVE 1                      TO SUB-1.
 16560
 16561 6430-LOOP.
 16562     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16563        MOVE WS-TODAY-DATE       TO AT-OPEN-CLOSE-DATE (SUB-1)
 16564        IF PI-PMTTYPE = '1' OR '4'
 16565           MOVE 'O'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 316
* EL156.cbl
 16566           MOVE 'FORCE'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16567           GO TO 6450-REWRITE
 16568        ELSE
 16569           MOVE 'C'              TO AT-OPEN-CLOSE-TYPE (SUB-1)
 16570           MOVE 'FINAL'          TO AT-OPEN-CLOSE-REASON (SUB-1)
 16571           GO TO 6450-REWRITE.
 16572
 16573     IF SUB-1 = 6
 16574      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16575      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16576      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16577      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16578      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16579      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16580      GO TO 6430-LOOP.
 16581
 16582     ADD 1                       TO SUB-1.
 16583     GO TO 6430-LOOP.
 16584
 16585
 16586 6440-AIG-LOOP.
 16587
 16588     IF AT-OPEN-CLOSE-TYPE (SUB-1) = SPACES
 16589       MOVE WS-TODAY-DATE        TO AT-OPEN-CLOSE-DATE (SUB-1)
 16590       IF WS-OPEN-CLOSE-SW = '1'
 16591         MOVE 'O'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16592         IF PI-PMTTYPE = '2'
 16593           MOVE 'FINAL'          TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16594           MOVE '2'              TO  WS-OPEN-CLOSE-SW
 16595         ELSE
 16596           IF PI-PMTTYPE = '3'
 16597             MOVE 'SETTL'        TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16598             MOVE '2'            TO  WS-OPEN-CLOSE-SW
 16599           ELSE
 16600             IF PI-PMTTYPE = '4'
 16601               MOVE 'ADDL'       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16602               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16603             ELSE
 16604               MOVE 'UNK '       TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16605               MOVE '2'          TO  WS-OPEN-CLOSE-SW
 16606       ELSE
 16607         MOVE 'C'                TO  AT-OPEN-CLOSE-TYPE (SUB-1)
 16608         MOVE 'FORCE'            TO  AT-OPEN-CLOSE-REASON (SUB-1)
 16609         GO TO 6450-REWRITE.
 16610
 16611     IF SUB-1 = 6
 16612      MOVE AT-OPEN-CLOSE-HISTORY (2) TO AT-OPEN-CLOSE-HISTORY (1)
 16613      MOVE AT-OPEN-CLOSE-HISTORY (3) TO AT-OPEN-CLOSE-HISTORY (2)
 16614      MOVE AT-OPEN-CLOSE-HISTORY (4) TO AT-OPEN-CLOSE-HISTORY (3)
 16615      MOVE AT-OPEN-CLOSE-HISTORY (5) TO AT-OPEN-CLOSE-HISTORY (4)
 16616      MOVE AT-OPEN-CLOSE-HISTORY (6) TO AT-OPEN-CLOSE-HISTORY (5)
 16617      MOVE SPACES                    TO AT-OPEN-CLOSE-HISTORY (6)
 16618      GO TO 6440-AIG-LOOP.
 16619
 16620     ADD 1                       TO SUB-1.
 16621     GO TO 6440-AIG-LOOP.
 16622
 16623 6450-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 317
* EL156.cbl
 16624     MOVE PI-PROCESSOR-ID     TO AT-RESERVES-LAST-UPDATED-BY.
 16625     MOVE EIBTIME             TO AT-LAST-MAINT-HHMMSS.
 16626     MOVE WS-TODAY-DATE       TO AT-RESERVES-LAST-MAINT-DT.
 16627
 16628     IF PI-COMPANY-ID = 'DMD'
 16629         MOVE PI-AT-EOB-CODE (1) TO AT-EOB-CODE1
 16630         MOVE PI-AT-EOB-CODE (2) TO AT-EOB-CODE2
 16631         MOVE PI-AT-EOB-CODE (3) TO AT-EOB-CODE3
 16632         MOVE PI-AT-EOB-CODE (4) TO AT-EOB-CODE4
 16633         MOVE PI-AT-EOB-CODE (5) TO AT-EOB-CODE5.
 16634
 16635
 16636* EXEC CICS REWRITE
 16637*         DATASET  ('ELTRLR')
 16638*         FROM     (ACTIVITY-TRAILERS)
 16639*     END-EXEC.
 16640     MOVE LENGTH OF
 16641      ACTIVITY-TRAILERS
 16642       TO DFHEIV11
 16643     MOVE 'ELTRLR' TO DFHEIV1
 16644*    MOVE '&& L                  %   #00015487' TO DFHEIV0
 16645     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16646     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16647     MOVE X'2020233030303135343837' TO DFHEIV0(25:11)
 16648     CALL 'kxdfhei1' USING DFHEIV0,
 16649           DFHEIV1,
 16650           ACTIVITY-TRAILERS,
 16651           DFHEIV11,
 16652           DFHEIV99
 16653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16654
 16655
 16656 6499-EXIT.
 16657      EXIT.
 16658
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 318
* EL156.cbl
 16660 6500-READ-DLO035.
 16661     MOVE 'E'                    TO DL35-PROCESS-TYPE.
 16662     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16663     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16664     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16665
 16666
 16667* EXEC CICS LINK
 16668*        PROGRAM    ('DLO035')
 16669*        COMMAREA   (DLO035-KEY)
 16670*        LENGTH     (DL35-LENGTH)
 16671*    END-EXEC.
 16672     MOVE 'DLO035' TO DFHEIV1
 16673*    MOVE '."C                   (   #00015502' TO DFHEIV0
 16674     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16675     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16676     MOVE X'2020233030303135353032' TO DFHEIV0(25:11)
 16677     CALL 'kxdfhei1' USING DFHEIV0,
 16678           DFHEIV1,
 16679           DLO035-KEY,
 16680           DL35-LENGTH,
 16681           DFHEIV99,
 16682           DFHEIV99,
 16683           DFHEIV99,
 16684           DFHEIV99
 16685     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16686
 16687
 16688     IF DL35-RETURN-CODE = 'OK'
 16689         GO TO 6500-EXIT.
 16690
 16691     IF DL35-RETURN-CODE = '01'
 16692         MOVE ER-7830            TO EMI-ERROR
 16693         GO TO 6500-BAD-EXIT.
 16694
 16695     IF DL35-RETURN-CODE = '02'
 16696         MOVE ER-7831            TO EMI-ERROR
 16697         GO TO 6500-BAD-EXIT.
 16698
 16699     IF DL35-RETURN-CODE = '03'
 16700         MOVE ER-7832            TO EMI-ERROR
 16701         GO TO 6500-BAD-EXIT.
 16702
 16703     IF DL35-RETURN-CODE = '04'
 16704         MOVE ER-7833            TO EMI-ERROR
 16705         GO TO 6500-BAD-EXIT.
 16706
 16707     IF DL35-RETURN-CODE = '05'
 16708         MOVE ER-7834            TO EMI-ERROR
 16709         GO TO 6500-BAD-EXIT.
 16710
 16711     IF DL35-RETURN-CODE = '06'
 16712         MOVE ER-7835            TO EMI-ERROR
 16713         GO TO 6500-BAD-EXIT.
 16714
 16715     IF DL35-RETURN-CODE = '07'
 16716         MOVE ER-7836            TO EMI-ERROR
 16717         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 319
* EL156.cbl
 16718
 16719     IF DL35-RETURN-CODE = 'E1'
 16720         MOVE ER-7837            TO EMI-ERROR
 16721         GO TO 6500-BAD-EXIT.
 16722
 16723     IF DL35-RETURN-CODE NOT = 'OK'
 16724         MOVE ER-7838            TO EMI-ERROR
 16725         GO TO 6500-BAD-EXIT.
 16726
 16727 6500-EXIT.
 16728      EXIT.
 16729
 16730 6500-BAD-EXIT.
 16731
 16732* EXEC CICS SYNCPOINT ROLLBACK END-EXEC.
 16733*    MOVE '6"R                   !   #00015551' TO DFHEIV0
 16734     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 16735     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16736     MOVE X'2020233030303135353531' TO DFHEIV0(25:11)
 16737     CALL 'kxdfhei1' USING DFHEIV0
 16738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16739
 16740     MOVE -1                 TO PMTTYPEL.
 16741     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16742     GO TO 8200-SEND-DATAONLY.
 16743
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 320
* EL156.cbl
 16745 6600-UPDATE-DLO035.
 16746     MOVE 'U'                    TO DL35-PROCESS-TYPE.
 16747     MOVE CL-CCN-A5              TO DL35-CREDIT-CARD.
 16748     MOVE CL-CERT-NO (5:2)       TO DL35-BEN-TYPE.
 16749     MOVE PI-EPYAMT              TO DL35-PAYMENT-AMT.
 16750
 16751
 16752* EXEC CICS LINK
 16753*        PROGRAM    ('DLO035')
 16754*        COMMAREA   (DLO035-KEY)
 16755*        LENGTH     (DL35-LENGTH)
 16756*    END-EXEC.
 16757     MOVE 'DLO035' TO DFHEIV1
 16758*    MOVE '."C                   (   #00015563' TO DFHEIV0
 16759     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 16760     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16761     MOVE X'2020233030303135353633' TO DFHEIV0(25:11)
 16762     CALL 'kxdfhei1' USING DFHEIV0,
 16763           DFHEIV1,
 16764           DLO035-KEY,
 16765           DL35-LENGTH,
 16766           DFHEIV99,
 16767           DFHEIV99,
 16768           DFHEIV99,
 16769           DFHEIV99
 16770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16771
 16772
 16773     IF DL35-RETURN-CODE = 'OK'
 16774         GO TO 6600-EXIT.
 16775
 16776     IF DL35-RETURN-CODE = '01'
 16777         MOVE ER-7830            TO EMI-ERROR
 16778         GO TO 6500-BAD-EXIT.
 16779
 16780     IF DL35-RETURN-CODE = '02'
 16781         MOVE ER-7831            TO EMI-ERROR
 16782         GO TO 6500-BAD-EXIT.
 16783
 16784     IF DL35-RETURN-CODE = '03'
 16785         MOVE ER-7832            TO EMI-ERROR
 16786         GO TO 6500-BAD-EXIT.
 16787
 16788     IF DL35-RETURN-CODE = '04'
 16789         MOVE ER-7833            TO EMI-ERROR
 16790         GO TO 6500-BAD-EXIT.
 16791
 16792     IF DL35-RETURN-CODE = '05'
 16793         MOVE ER-7834            TO EMI-ERROR
 16794         GO TO 6500-BAD-EXIT.
 16795
 16796     IF DL35-RETURN-CODE = '06'
 16797         MOVE ER-7835            TO EMI-ERROR
 16798         GO TO 6500-BAD-EXIT.
 16799
 16800     IF DL35-RETURN-CODE = '07'
 16801         MOVE ER-7836            TO EMI-ERROR
 16802         GO TO 6500-BAD-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 321
* EL156.cbl
 16803
 16804     IF DL35-RETURN-CODE = 'E1'
 16805         MOVE ER-7837            TO EMI-ERROR
 16806         GO TO 6500-BAD-EXIT.
 16807
 16808     IF DL35-RETURN-CODE NOT = 'OK'
 16809         MOVE ER-7838            TO EMI-ERROR
 16810         GO TO 6500-BAD-EXIT.
 16811
 16812 6600-EXIT.
 16813      EXIT.
 16814
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 322
* EL156.cbl
 16816 6700-UPDATE-ACTQ.
 16817***************************************************************
 16818*    THE ACTIVITY QUE FILE IS READ TO GET THE RECORD FOR      *
 16819*    THIS CLAIM.  A NEW RECORD WILL BE BUILT IF THERE ISNT    *
 16820*    ONE ALREADY THERE.                                       *
 16821***************************************************************
 16822
 16823
 16824* EXEC CICS HANDLE CONDITION
 16825*         NOTFND(6720-BUILD-NEW-RECORD)
 16826*     END-EXEC.
 16827*    MOVE '"$I                   ! 6 #00015619' TO DFHEIV0
 16828     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16829     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16830     MOVE X'3620233030303135363139' TO DFHEIV0(25:11)
 16831     CALL 'kxdfhei1' USING DFHEIV0
 16832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16833
 16834
 16835
 16836* EXEC CICS READ
 16837*         DATASET('ELACTQ')
 16838*         RIDFLD (ELMSTR-KEY)
 16839*         SET    (ADDRESS OF ACTIVITY-QUE)
 16840*         UPDATE
 16841*     END-EXEC.
 16842     MOVE 'ELACTQ' TO DFHEIV1
 16843*    MOVE '&"S        EU         (   #00015623' TO DFHEIV0
 16844     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16845     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16846     MOVE X'2020233030303135363233' TO DFHEIV0(25:11)
 16847     CALL 'kxdfhei1' USING DFHEIV0,
 16848           DFHEIV1,
 16849           DFHEIV20,
 16850           DFHEIV99,
 16851           ELMSTR-KEY,
 16852           DFHEIV99,
 16853           DFHEIV99,
 16854           DFHEIV99
 16855     SET ADDRESS OF ACTIVITY-QUE TO
 16856         DFHEIV20
 16857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16858
 16859
 16860     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16861
 16862     IF PI-AIG-SPECIAL-BENEFIT AND
 16863        PI-CASH = 'Y'
 16864         ADD 2                   TO AQ-PAYMENT-COUNTER
 16865     ELSE
 16866         ADD 1                   TO AQ-PAYMENT-COUNTER.
 16867
 16868     IF AQ-PMT-UNAPPROVED-COUNT IS NOT NUMERIC
 16869         MOVE +0                 TO  AQ-PMT-UNAPPROVED-COUNT.
 16870
 16871     MOVE +0                     TO  WS-PMT-UNAPPROVED-CNT.
 16872
 16873     IF PI-PMT-GRADUATED
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 323
* EL156.cbl
 16874         IF WS-PMT-APPROVAL-SW = 'A'
 16875             NEXT SENTENCE
 16876         ELSE
 16877            IF PI-AIG-SPECIAL-BENEFIT AND
 16878               PI-CASH = 'Y'
 16879                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16880                                     WS-PMT-UNAPPROVED-CNT
 16881            ELSE
 16882                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16883                                     WS-PMT-UNAPPROVED-CNT
 16884     ELSE
 16885         IF PI-PMT-APPR-SW = 'Y'
 16886            IF PI-AIG-SPECIAL-BENEFIT AND
 16887               PI-CASH = 'Y'
 16888                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16889                                     WS-PMT-UNAPPROVED-CNT
 16890            ELSE
 16891                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16892                                     WS-PMT-UNAPPROVED-CNT.
 16893
 16894     IF WS-PMT-UNAPPROVED-CNT > ZERO
 16895         MOVE ER-3536 TO EMI-ERROR
 16896         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16897
 16898     MOVE +156                   TO  AQ-LAST-UPDATED-BY.
 16899
 16900
 16901* EXEC CICS REWRITE
 16902*         DATASET('ELACTQ')
 16903*         FROM   (ACTIVITY-QUE)
 16904*     END-EXEC.
 16905     MOVE LENGTH OF
 16906      ACTIVITY-QUE
 16907       TO DFHEIV11
 16908     MOVE 'ELACTQ' TO DFHEIV1
 16909*    MOVE '&& L                  %   #00015670' TO DFHEIV0
 16910     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16911     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16912     MOVE X'2020233030303135363730' TO DFHEIV0(25:11)
 16913     CALL 'kxdfhei1' USING DFHEIV0,
 16914           DFHEIV1,
 16915           ACTIVITY-QUE,
 16916           DFHEIV11,
 16917           DFHEIV99
 16918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16919
 16920
 16921     GO TO 6799-EXIT.
 16922
 16923 6720-BUILD-NEW-RECORD.
 16924
 16925* EXEC CICS GETMAIN
 16926*         SET    (ADDRESS OF ACTIVITY-QUE)
 16927*         LENGTH (60)
 16928*         INITIMG(GETMAIN-SPACE)
 16929*     END-EXEC.
 16930     MOVE 60
 16931       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 324
* EL156.cbl
 16932*    MOVE ',"IL                  $   #00015678' TO DFHEIV0
 16933     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 16934     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16935     MOVE X'2020233030303135363738' TO DFHEIV0(25:11)
 16936     CALL 'kxdfhei1' USING DFHEIV0,
 16937           DFHEIV20,
 16938           DFHEIV11,
 16939           GETMAIN-SPACE
 16940     SET ADDRESS OF ACTIVITY-QUE TO
 16941         DFHEIV20
 16942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16943
 16944
 16945     MOVE ZEROS                  TO AQ-PMT-UNAPPROVED-COUNT.
 16946
 16947     IF PI-AIG-SPECIAL-BENEFIT AND
 16948        PI-CASH = 'Y'
 16949         MOVE 2                  TO AQ-PAYMENT-COUNTER
 16950     ELSE
 16951         MOVE 1                  TO AQ-PAYMENT-COUNTER.
 16952
 16953     MOVE ELMSTR-KEY             TO AQ-CONTROL-PRIMARY.
 16954     MOVE 'AQ'                   TO AQ-RECORD-ID.
 16955     MOVE SPACES                 TO AQ-PENDING-ACTIVITY-FLAGS.
 16956     MOVE LOW-VALUES             TO AQ-RESEND-DATE
 16957                                    AQ-FOLLOWUP-DATE.
 16958     MOVE +156                   TO AQ-LAST-UPDATED-BY.
 16959     MOVE '1'                    TO AQ-PENDING-PAYMENT-FLAG.
 16960
 16961     IF PI-PMT-GRADUATED
 16962         IF WS-PMT-APPROVAL-SW = 'A'
 16963             NEXT SENTENCE
 16964         ELSE
 16965            IF PI-AIG-SPECIAL-BENEFIT AND
 16966               PI-CASH = 'Y'
 16967                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16968            ELSE
 16969                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT
 16970     ELSE
 16971         IF PI-PMT-APPR-SW = 'Y'
 16972            IF PI-AIG-SPECIAL-BENEFIT AND
 16973               PI-CASH = 'Y'
 16974                ADD +2           TO  AQ-PMT-UNAPPROVED-COUNT
 16975            ELSE
 16976                ADD +1           TO  AQ-PMT-UNAPPROVED-COUNT.
 16977
 16978     IF AQ-PMT-UNAPPROVED-COUNT > ZERO
 16979         MOVE ER-3536 TO EMI-ERROR
 16980         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16981
 16982
 16983* EXEC CICS WRITE
 16984*         DATASET('ELACTQ')
 16985*         RIDFLD (ELMSTR-KEY)
 16986*         FROM   (ACTIVITY-QUE)
 16987*     END-EXEC.
 16988     MOVE LENGTH OF
 16989      ACTIVITY-QUE
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 325
* EL156.cbl
 16990       TO DFHEIV11
 16991     MOVE 'ELACTQ' TO DFHEIV1
 16992*    MOVE '&$ L                  ''   #00015721' TO DFHEIV0
 16993     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16994     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16995     MOVE X'2020233030303135373231' TO DFHEIV0(25:11)
 16996     CALL 'kxdfhei1' USING DFHEIV0,
 16997           DFHEIV1,
 16998           ACTIVITY-QUE,
 16999           DFHEIV11,
 17000           ELMSTR-KEY,
 17001           DFHEIV99,
 17002           DFHEIV99
 17003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17004
 17005
 17006 6799-EXIT.
 17007      EXIT.
 17008
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 326
* EL156.cbl
 17010 6800-BUILD-FORM-TRAILER.
 17011
 17012
 17013* EXEC CICS GETMAIN
 17014*         SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17015*         LENGTH   (200)
 17016*         INITIMG  (GETMAIN-SPACE)
 17017*    END-EXEC.
 17018     MOVE 200
 17019       TO DFHEIV11
 17020*    MOVE ',"IL                  $   #00015733' TO DFHEIV0
 17021     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17022     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17023     MOVE X'2020233030303135373333' TO DFHEIV0(25:11)
 17024     CALL 'kxdfhei1' USING DFHEIV0,
 17025           DFHEIV20,
 17026           DFHEIV11,
 17027           GETMAIN-SPACE
 17028     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17029         DFHEIV20
 17030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17031
 17032
 17033     SUBTRACT +1               FROM CL-TRAILER-SEQ-CNT.
 17034
 17035     MOVE CL-CONTROL-PRIMARY     TO AT-CONTROL-PRIMARY.
 17036     MOVE 'AT'                   TO AT-RECORD-ID.
 17037     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO.
 17038
 17039     MOVE 'A'                    TO AT-TRAILER-TYPE.
 17040     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17041                                    AT-FORM-LAST-MAINT-DT
 17042                                    AT-FORM-SEND-ON-DT.
 17043     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17044                                    AT-FORM-LAST-UPDATED-BY.
 17045     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS.
 17046     MOVE WS-TODAY-DATE          TO DC-BIN-DATE-1.
 17047     MOVE '6'                    TO DC-OPTION-CODE.
 17048     MOVE +29                    TO DC-ELAPSED-DAYS.
 17049     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17050     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17051     MOVE DC-BIN-DATE-2          TO AT-FORM-FOLLOW-UP-DT.
 17052
 17053     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17054         MOVE  LOW-VALUES        TO AT-FORM-FOLLOW-UP-DT.
 17055
 17056     MOVE LOW-VALUES             TO AT-FORM-ANSWERED-DT
 17057                                    AT-FORM-RE-SEND-DT
 17058                                    AT-EMP-FORM-ANSWERED-DT
 17059                                    AT-PHY-FORM-ANSWERED-DT
 17060                                    AT-EMP-FORM-SEND-ON-DT
 17061                                    AT-PHY-FORM-SEND-ON-DT
 17062                                    AT-FORM-PRINTED-DT
 17063                                    AT-FORM-REPRINT-DT.
 17064     MOVE '2'                    TO AT-FORM-TYPE.
 17065
 17066     MOVE CL-INSURED-ADDR-CNT    TO AT-FORM-ADDR-SEQ-NO.
 17067     MOVE 'I'                    TO AT-FORM-ADDRESS.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 327
* EL156.cbl
 17068
 17069     IF PI-COMPANY-ID = 'RMC' OR 'LAP'
 17070         NEXT SENTENCE
 17071     ELSE
 17072         IF CL-PROG-FORM-TYPE NOT = 'S'
 17073            MOVE WS-TODAY-DATE   TO AT-PHY-FORM-SEND-ON-DT.
 17074
 17075
 17076* EXEC CICS WRITE
 17077*         DATASET  ('ELTRLR')
 17078*         FROM     (ACTIVITY-TRAILERS)
 17079*         RIDFLD   (AT-CONTROL-PRIMARY)
 17080*     END-EXEC.
 17081     MOVE LENGTH OF
 17082      ACTIVITY-TRAILERS
 17083       TO DFHEIV11
 17084     MOVE 'ELTRLR' TO DFHEIV1
 17085*    MOVE '&$ L                  ''   #00015781' TO DFHEIV0
 17086     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17087     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17088     MOVE X'2020233030303135373831' TO DFHEIV0(25:11)
 17089     CALL 'kxdfhei1' USING DFHEIV0,
 17090           DFHEIV1,
 17091           ACTIVITY-TRAILERS,
 17092           DFHEIV11,
 17093           AT-CONTROL-PRIMARY,
 17094           DFHEIV99,
 17095           DFHEIV99
 17096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17097
 17098
 17099 6899-EXIT.
 17100      EXIT.
 17101
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 328
* EL156.cbl
 17103 6900-BUILD-ARCHIVE-HEADER.
 17104
 17105     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17106     MOVE '1'                    TO CNTL-REC-TYPE.
 17107     MOVE +0                     TO CNTL-SEQ-NO.
 17108     MOVE SPACES                 TO CNTL-ACCESS.
 17109
 17110
 17111* EXEC CICS READ
 17112*         DATASET  ('ELCNTL')
 17113*         SET      (ADDRESS OF CONTROL-FILE)
 17114*         RIDFLD   (ELCNTL-KEY)
 17115*         UPDATE
 17116*    END-EXEC.
 17117     MOVE 'ELCNTL' TO DFHEIV1
 17118*    MOVE '&"S        EU         (   #00015798' TO DFHEIV0
 17119     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17120     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17121     MOVE X'2020233030303135373938' TO DFHEIV0(25:11)
 17122     CALL 'kxdfhei1' USING DFHEIV0,
 17123           DFHEIV1,
 17124           DFHEIV20,
 17125           DFHEIV99,
 17126           ELCNTL-KEY,
 17127           DFHEIV99,
 17128           DFHEIV99,
 17129           DFHEIV99
 17130     SET ADDRESS OF CONTROL-FILE TO
 17131         DFHEIV20
 17132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17133
 17134
 17135     ADD +1                      TO CF-CO-ARCHIVE-COUNTER.
 17136     MOVE CF-CO-ARCHIVE-COUNTER  TO ARCH-NUMBER.
 17137
 17138
 17139* EXEC CICS REWRITE
 17140*         FROM     (CONTROL-FILE)
 17141*         DATASET  ('ELCNTL')
 17142*    END-EXEC.
 17143     MOVE LENGTH OF
 17144      CONTROL-FILE
 17145       TO DFHEIV11
 17146     MOVE 'ELCNTL' TO DFHEIV1
 17147*    MOVE '&& L                  %   #00015808' TO DFHEIV0
 17148     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17149     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17150     MOVE X'2020233030303135383038' TO DFHEIV0(25:11)
 17151     CALL 'kxdfhei1' USING DFHEIV0,
 17152           DFHEIV1,
 17153           CONTROL-FILE,
 17154           DFHEIV11,
 17155           DFHEIV99
 17156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17157
 17158
 17159
 17160* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 329
* EL156.cbl
 17161*         DUPKEY   (6900-BUILD-ARCHIVE-HEADER)
 17162*         DUPREC   (6900-BUILD-ARCHIVE-HEADER)
 17163*    END-EXEC.
 17164*    MOVE '"$$%                  ! 7 #00015813' TO DFHEIV0
 17165     MOVE X'222424252020202020202020' TO DFHEIV0(1:12)
 17166     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17167     MOVE X'3720233030303135383133' TO DFHEIV0(25:11)
 17168     CALL 'kxdfhei1' USING DFHEIV0
 17169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17170
 17171
 17172
 17173* EXEC CICS GETMAIN
 17174*         SET     (ADDRESS OF LETTER-ARCHIVE)
 17175*         LENGTH  (ELARCH-LENGTH)
 17176*         INITIMG (GETMAIN-SPACE)
 17177*    END-EXEC.
 17178*    MOVE ',"IL                  $   #00015818' TO DFHEIV0
 17179     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17180     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17181     MOVE X'2020233030303135383138' TO DFHEIV0(25:11)
 17182     CALL 'kxdfhei1' USING DFHEIV0,
 17183           DFHEIV20,
 17184           ELARCH-LENGTH,
 17185           GETMAIN-SPACE
 17186     SET ADDRESS OF LETTER-ARCHIVE TO
 17187         DFHEIV20
 17188     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17189
 17190
 17191     MOVE 'LA'                   TO LA-RECORD-ID.
 17192     MOVE ARCH-NUMBER            TO LA-ARCHIVE-NO
 17193                                    LA-ARCHIVE-NO-A1.
 17194     MOVE '4'                    TO LA-RECORD-TYPE
 17195                                    LA-RECORD-TYPE-A1.
 17196     MOVE +0                     TO LA-LINE-SEQ-NO
 17197                                    LA-LINE-SEQ-NO-A1.
 17198     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
 17199                                    LA-COMPANY-CD-A1.
 17200     MOVE CL-CARRIER             TO LA4-CARRIER.
 17201     MOVE CL-CLAIM-NO            TO LA4-CLAIM-NO.
 17202     MOVE CL-CERT-NO             TO LA4-CERT-NO.
 17203     MOVE CL-CERT-STATE          TO LA4-STATE.
 17204     MOVE +0                     TO LA4-NO-OF-COPIES.
 17205     MOVE PI-PROCESSOR-ID        TO LA4-PROCESSOR-CD.
 17206     MOVE WS-TODAY-DATE          TO LA4-CREATION-DT.
 17207     MOVE LOW-VALUES             TO LA4-RESEND-DATE
 17208                                    LA4-INITIAL-PRINT-DATE
 17209                                    LA4-RESEND-PRINT-DATE
 17210                                    LA4-FORM-REM-PRINT-DT.
 17211     MOVE CL-TRAILER-SEQ-CNT     TO LA4-FORM-TRLR-SEQ.
 17212     MOVE '2'                    TO LA4-FORM-TYPE.
 17213
 17214
 17215* EXEC CICS WRITE
 17216*         DATASET  ('ELARCH')
 17217*         FROM     (LETTER-ARCHIVE)
 17218*         RIDFLD   (LA-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 330
* EL156.cbl
 17219*    END-EXEC.
 17220     MOVE LENGTH OF
 17221      LETTER-ARCHIVE
 17222       TO DFHEIV11
 17223     MOVE 'ELARCH' TO DFHEIV1
 17224*    MOVE '&$ L                  ''   #00015847' TO DFHEIV0
 17225     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17226     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17227     MOVE X'2020233030303135383437' TO DFHEIV0(25:11)
 17228     CALL 'kxdfhei1' USING DFHEIV0,
 17229           DFHEIV1,
 17230           LETTER-ARCHIVE,
 17231           DFHEIV11,
 17232           LA-CONTROL-PRIMARY,
 17233           DFHEIV99,
 17234           DFHEIV99
 17235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17236
 17237
 17238 6999-EXIT.
 17239      EXIT.
 17240
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 331
* EL156.cbl
 17242 7000-SHOW-CLAIM.
 17243     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
 17244     MOVE 'A'                    TO PI-PASS-SW.
 17245     MOVE LOW-VALUES             TO PI-CPYFROM
 17246                                    PI-MONTH-END-SAVE
 17247                                    PI-CPYTHRU.
 17248
 17249     MOVE ZEROS                  TO PI-FATAL-COUNT
 17250                                    PI-DAILY-RATE
 17251                                    PI-BEN-DAYS
 17252                                    PI-MANUAL-SW
 17253                                    PI-SAVE-CURSOR
 17254                                    PI-FORCE-COUNT
 17255                                    PI-HOLDTIL
 17256                                    PI-EPYFROM
 17257                                    PI-EPYTHRU
 17258                                    PI-EDAYS
 17259                                    PI-EPYAMT
 17260                                    PI-ERESV
 17261                                    PI-EEXPENS
 17262                                    PI-CDAYS
 17263                                    PI-CPYAMT
 17264                                    PI-CRESV
 17265                                    PI-CEXPENS
 17266                                    PI-INT-RATE
 17267                                    PI-AIGFROM.
 17268     MOVE ZEROS                  TO PI-PROOF-DATE.
 17269     MOVE ZEROS                  TO PI-ORIG-BEN-AMT
 17270                                    PI-REM-BEN-AMT
 17271                                    PI-MO-BEN-AMT
 17272                                    pi-ah-term.
 17273
 17274     MOVE LOW-VALUES             TO EL156AI.
 17275     MOVE MAP-NAMEA              TO MAP-NAME.
 17276
 17277* EXEC CICS HANDLE CONDITION
 17278*        NOTFND   (7010-BUILD-MAP)
 17279*    END-EXEC.
 17280*    MOVE '"$I                   ! 8 #00015891' TO DFHEIV0
 17281     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17282     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17283     MOVE X'3820233030303135383931' TO DFHEIV0(25:11)
 17284     CALL 'kxdfhei1' USING DFHEIV0
 17285     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17286
 17287
 17288     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17289     MOVE '2'                    TO CNTL-REC-TYPE.
 17290     MOVE +0                     TO CNTL-SEQ-NO.
 17291     MOVE PI-PROCESSOR-ID        TO CNTL-ACCESS.
 17292
 17293
 17294* EXEC CICS READ
 17295*         DATASET  ('ELCNTL')
 17296*         SET      (ADDRESS OF CONTROL-FILE)
 17297*         RIDFLD   (ELCNTL-KEY)
 17298*    END-EXEC.
 17299     MOVE 'ELCNTL' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 332
* EL156.cbl
 17300*    MOVE '&"S        E          (   #00015900' TO DFHEIV0
 17301     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17302     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17303     MOVE X'2020233030303135393030' TO DFHEIV0(25:11)
 17304     CALL 'kxdfhei1' USING DFHEIV0,
 17305           DFHEIV1,
 17306           DFHEIV20,
 17307           DFHEIV99,
 17308           ELCNTL-KEY,
 17309           DFHEIV99,
 17310           DFHEIV99,
 17311           DFHEIV99
 17312     SET ADDRESS OF CONTROL-FILE TO
 17313         DFHEIV20
 17314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17315
 17316
 17317     MOVE CF-APPROVAL-LEVEL TO PI-APPROVAL-LEVEL.
 17318
 17319     IF PI-APPROVAL-LEVEL = '4' OR '5'
 17320         MOVE AL-UANON      TO SURVYYNA
 17321     END-IF.
 17322
 17323
 17324     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17325     MOVE '1'                    TO CNTL-REC-TYPE.
 17326     MOVE SPACES                 TO CNTL-ACCESS.
 17327     MOVE +0                     TO CNTL-SEQ-NO.
 17328
 17329
 17330* EXEC CICS READ
 17331*         DATASET  ('ELCNTL')
 17332*         SET      (ADDRESS OF CONTROL-FILE)
 17333*         RIDFLD   (ELCNTL-KEY)
 17334*    END-EXEC.
 17335     MOVE 'ELCNTL' TO DFHEIV1
 17336*    MOVE '&"S        E          (   #00015918' TO DFHEIV0
 17337     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17338     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17339     MOVE X'2020233030303135393138' TO DFHEIV0(25:11)
 17340     CALL 'kxdfhei1' USING DFHEIV0,
 17341           DFHEIV1,
 17342           DFHEIV20,
 17343           DFHEIV99,
 17344           ELCNTL-KEY,
 17345           DFHEIV99,
 17346           DFHEIV99,
 17347           DFHEIV99
 17348     SET ADDRESS OF CONTROL-FILE TO
 17349         DFHEIV20
 17350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17351
 17352
 17353     MOVE CF-CO-REAUDIT-INTERVAL TO PI-REAUDIT-INTERVAL.
 17354
 17355 7010-BUILD-MAP.
 17356
 17357
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 333
* EL156.cbl
 17358* EXEC CICS HANDLE CONDITION
 17359*        NOTFND(7100-SHOW-RECORD-NOT-FOUND)
 17360*    END-EXEC.
 17361*    MOVE '"$I                   ! 9 #00015928' TO DFHEIV0
 17362     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17363     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17364     MOVE X'3920233030303135393238' TO DFHEIV0(25:11)
 17365     CALL 'kxdfhei1' USING DFHEIV0
 17366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17367
 17368
 17369     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD.
 17370     MOVE PI-CARRIER             TO MSTR-CARRIER.
 17371     MOVE PI-CLAIM-NO            TO MSTR-CLAIM-NO.
 17372     MOVE PI-CERT-NO             TO MSTR-CERT-NO.
 17373     MOVE 'MSTR'                 TO FILE-SWITCH.
 17374
 17375     PERFORM 7900-READ-CLAIM THRU 7900-EXIT.
 17376
 17377     MOVE CL-CERT-KEY-DATA       TO PI-SV-CERT-KEY.
 17378     MOVE CL-CERT-NO             TO PI-SV-CERT-NO.
 17379     MOVE CL-BENEFICIARY         TO PI-SV-BEN.
 17380     MOVE CL-CCN                 TO PI-SV-CCN.
 17381
 17382     MOVE CL-LAST-MAINT-USER     TO PI-UPDATE-BY.
 17383     MOVE CL-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
 17384     MOVE CL-CLAIM-NO            TO CLMNOO.
 17385     MOVE CL-CARRIER             TO CARRO.
 17386     MOVE CL-CERT-PRIME          TO CERTNOO.
 17387     MOVE CL-CERT-SFX            TO SUFXO.
 17388
 17389     IF (PI-COMPANY-ID = 'CID' OR 'AHL')
 17390        AND (CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1)
 17391        CONTINUE
 17392     ELSE
 17393        MOVE AL-SADOF            TO ZINTHA
 17394                                    ZINTA
 17395                                    PINTHA
 17396                                    PINTA
 17397     END-IF
 17398     MOVE CL-CLAIM-TYPE          TO PI-CLM-TYPE
 17399     EVALUATE TRUE
 17400     WHEN CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1
 17401         MOVE PI-AH-OVERRIDE-L6   TO CLMTYPO
 17402     WHEN CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17403         MOVE PI-LIFE-OVERRIDE-L6 TO CLMTYPO
 17404
 17405     WHEN CL-CLAIM-TYPE = 'I'
 17406         MOVE '  IU  '           TO CLMTYPO
 17407     WHEN CL-CLAIM-TYPE = 'G'
 17408         MOVE ' GAP  '           TO CLMTYPO
 17409     WHEN CL-CLAIM-TYPE = 'F'
 17410         MOVE ' FMLA '           TO CLMTYPO
 17411     END-EVALUATE.
 17412     IF CLAIM-IS-OPEN
 17413         MOVE ' OPEN'            TO CLMSTATO
 17414     ELSE
 17415         MOVE 'CLOSED'           TO CLMSTATO.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 334
* EL156.cbl
 17416
 17417     PERFORM 5000-MOVE-NAME  THRU 5000-EXIT.
 17418
 17419     IF CL-ASSOC-CERT-TOTAL = +0 OR +1
 17420         MOVE SPACES             TO  PCERTNOO
 17421                                     PSUFXO
 17422                                     PRIMHDGO
 17423                                     SEQUO
 17424         MOVE AL-SADOF           TO  PCERTNOA
 17425                                     PSUFXA
 17426                                     PRIMHDGA
 17427                                     SEQUA
 17428     ELSE
 17429         MOVE CL-ASSOC-CERT-SEQU     TO  WS-CUR-SEQU
 17430         MOVE CL-ASSOC-CERT-TOTAL    TO  WS-OF-SEQU
 17431         MOVE WS-CLAIM-SEQUENCE      TO  SEQUO
 17432         MOVE CL-PRIME-CERT-PRIME    TO  PCERTNOO
 17433         MOVE CL-PRIME-CERT-SFX      TO  PSUFXO
 17434         MOVE 'PRIME CERT :'         TO  PRIMHDGO
 17435         MOVE AL-SANON               TO  PCERTNOA
 17436                                         PSUFXA
 17437                                         PRIMHDGA
 17438         MOVE AL-SABON               TO  SEQUA.
 17439
 17440     MOVE CL-ACTIVITY-CODE           TO  PI-ACTIVITY-CODE.
 17441
 17442     IF CL-NO-OF-PMTS-MADE = 0 AND
 17443        CL-TOTAL-PAID-AMT = 0
 17444         NEXT SENTENCE
 17445     ELSE
 17446         IF CL-PAID-THRU-DT NOT = LOW-VALUES
 17447             IF NOT PI-USES-PAID-TO
 17448                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17449                 MOVE ' '                 TO DC-OPTION-CODE
 17450                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17451                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO
 17452             ELSE
 17453                 MOVE CL-PAID-THRU-DT     TO DC-BIN-DATE-1
 17454                 MOVE '6'                 TO DC-OPTION-CODE
 17455                 MOVE +1                  TO DC-ELAPSED-DAYS
 17456                 MOVE +0                  TO DC-ELAPSED-MONTHS
 17457                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17458                 MOVE DC-GREG-DATE-1-EDIT TO PDTHRUO.
 17459
 17460     IF MAP-NAME = 'EL156A'
 17461        IF CL-PAID-THRU-DT NOT = LOW-VALUES AND SPACES
 17462           IF CL-TOTAL-PAID-AMT NOT = ZEROS
 17463             MOVE AL-SADOF TO    AIGFRMHA AIGFROMA
 17464           end-if
 17465        end-if
 17466     end-if
 17467     IF CL-LAST-PMT-DT NOT = LOW-VALUES
 17468         MOVE CL-LAST-PMT-DT     TO DC-BIN-DATE-1
 17469         MOVE ' '                TO DC-OPTION-CODE
 17470         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17471         MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO.
 17472
 17473     IF CL-INCURRED-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 335
* EL156.cbl
 17474         MOVE CL-INCURRED-DT     TO DC-BIN-DATE-1
 17475         MOVE ' '                TO DC-OPTION-CODE
 17476         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17477         MOVE DC-GREG-DATE-1-EDIT    TO INCURO.
 17478
 17479     MOVE CL-TOTAL-PAID-AMT      TO TOTPAIDO.
 17480
 17481     IF CL-CERT-EFF-DT NOT = LOW-VALUES
 17482         MOVE CL-CERT-EFF-DT     TO DC-BIN-DATE-1
 17483         MOVE ' '                TO DC-OPTION-CODE
 17484         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 17485         MOVE DC-GREG-DATE-1-EDIT    TO EFFECTO.
 17486
 17487     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17488         MOVE CL-CURRENT-ACCOUNT TO WS-WORK-ACCT
 17489         MOVE CL-CURRENT-STATE   TO WS-WORK-STATE
 17490     ELSE
 17491         MOVE CL-CERT-ACCOUNT    TO WS-WORK-ACCT
 17492         MOVE CL-CERT-STATE      TO WS-WORK-STATE.
 17493
 17494     MOVE WS-WORK-STATE-ACCT     TO STACCTO.
 17495     MOVE PI-COMPANY-CD          TO CERT-COMP-CD.
 17496     MOVE CL-CERT-CARRIER        TO CERT-CARRIER.
 17497     MOVE CL-CERT-GROUPING       TO CERT-GROUPING
 17498                                    PI-GROUPING.
 17499     MOVE CL-CERT-STATE          TO CERT-STATE
 17500                                    PI-STATE.
 17501     MOVE CL-CERT-ACCOUNT        TO CERT-ACCOUNT
 17502                                    PI-ACCOUNT.
 17503     MOVE CL-CERT-EFF-DT         TO CERT-EFF-DT.
 17504     MOVE CL-CERT-NO             TO CERT-CERT-NO.
 17505     MOVE 'CERT'                 TO FILE-SWITCH.
 17506
 17507     PERFORM 7970-READ-CERT THRU 7970-EXIT.
 17508     IF CM-INSURED-LAST-NAME EQUAL CL-INSURED-LAST-NAME  AND
 17509        CM-INSURED-FIRST-NAME EQUAL CL-INSURED-1ST-NAME  AND
 17510        CM-INSURED-INITIAL2 EQUAL CL-INSURED-MID-INIT
 17511            MOVE 'N' TO PI-JOINT-INSURED-IND
 17512     ELSE
 17513            MOVE 'Y' TO PI-JOINT-INSURED-IND
 17514     END-IF.
 17515
 17516     perform 7975-read-acct      thru 7975-exit
 17517     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17518     MOVE PI-STATE               TO WS-ST-ACCESS.
 17519     MOVE WS-STATE-ACCESS        TO CNTL-ACCESS.
 17520     MOVE '3'                    TO CNTL-REC-TYPE.
 17521     MOVE +0                     TO CNTL-SEQ-NO.
 17522     MOVE 'STAT'                 TO FILE-SWITCH.
 17523
 17524     PERFORM 7930-READ-CONTROL THRU 7930-EXIT.
 17525
 17526     MOVE CF-STATE-ABBREVIATION  TO WS-STATE-ABBREV.
 17527     MOVE CF-ST-FREE-LOOK-PERIOD TO CP-FREE-LOOK.
 17528
 17529     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17530        GO TO 7020-BYPASS-BENEFIT.
 17531
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 336
* EL156.cbl
 17532     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17533     MOVE '4'                    TO CNTL-REC-TYPE.
 17534     MOVE +0                     TO CNTL-SEQ-NO.
 17535     MOVE CM-LF-BENEFIT-CD       TO WS-BEN-CD.
 17536     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17537     MOVE 'BENE'                 TO FILE-SWITCH.
 17538
 17539     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17540
 17541     IF NO-BENEFIT-FOUND
 17542        GO TO 7020-BYPASS-BENEFIT.
 17543
 17544     MOVE CF-CO-EARNINGS-CALC (SUB-1)    TO  WS-EARNING-METHOD.
 17545     MOVE CF-SPECIAL-CALC-CD  (SUB-1)    TO  WS-SPECIAL-CALC-CD.
 17546     MOVE CF-LF-COVERAGE-TYPE (SUB-1)    TO  WS-LF-COVERAGE-TYPE.
 17547
 17548 7020-BYPASS-BENEFIT.
 17549
 17550*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17551*        PERFORM 3400-COMPUTE-EXPIRY THRU 3499-EXIT
 17552*        MOVE PI-LOAN-DUE-DAY TO DUEDAYO.
 17553
 17554     move zeros                  to PI-MAX-BENEFIT-AMT
 17555     move cm-ah-benefit-cd       to pi-ah-benefit-cd
 17556     move cm-ah-orig-term        to pi-ah-term
 17557     move cm-ah-benefit-amt      to pi-ah-benefit-amt
 17558     IF CL-CLAIM-TYPE NOT = PI-AH-OVERRIDE-L1 AND 'I' AND
 17559          'G' and 'F'
 17560         GO TO 7021-GO-TO-LIFE.
 17561
 17562     IF (PI-COMPANY-ID = 'DCC')
 17563        and (acct-found)
 17564        AND (PI-DCC-PRODUCT-CODE not = '   ')
 17565        PERFORM 0900-GET-DDF-limits
 17566                                 THRU 0900-EXIT
 17567        IF PDEF-FOUND
 17568           PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17569              (P1 > +8)
 17570              OR (PD-PROD-CODE (P1) = cl-claim-type)
 17571           END-PERFORM
 17572           IF P1 < +9
 17573              if pd-ben-pct (p1) not numeric
 17574                 move zeros      to pd-ben-pct (p1)
 17575              end-if
 17576              if pd-ben-pct (p1) = zeros
 17577                 move +1         to ws-work-ben-pct
 17578              else
 17579                 move pd-ben-pct (p1)
 17580                                 to ws-work-ben-pct
 17581              end-if
 17582              compute cm-ah-benefit-amt =
 17583                 cm-ah-benefit-amt * ws-work-ben-pct
 17584              move pd-max-amt (p1) to pi-max-benefit-amt
 17585           END-IF
 17586        END-IF
 17587     end-if
 17588     MOVE 'A'                    TO CP-BENEFIT-TYPE.
 17589     MOVE 'MO. BENEFIT :'        TO BENECAPO.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 337
* EL156.cbl
 17590     if (pi-max-benefit-amt not = zeros)
 17591        and (cm-ah-benefit-amt > pi-max-benefit-amt)
 17592        move pi-max-benefit-amt  to beneo
 17593     else
 17594        MOVE CM-AH-BENEFIT-AMT   TO BENEO
 17595     end-if
 17596     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17597     MOVE CM-AH-ORIG-TERM        TO WST-ORIG
 17598                                    CP-ORIGINAL-TERM.
 17599     MOVE CM-AH-CURRENT-STATUS   TO WS-STATUS.
 17600
 17601*    IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17602*        MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17603*    ELSE
 17604         MOVE CM-AH-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17605
 17606     MOVE ' '                    TO DC-OPTION-CODE.
 17607     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17608     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17609
 17610     IF PI-COMPANY-ID = 'DMD'
 17611         PERFORM 9830-DMD-REMAINING-TERM THRU 9830-EXIT
 17612         GO TO 7023-BYPASS-REMAINING-TERM.
 17613
 17614     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17615     MOVE SAVE-BIN-DATE          TO CP-VALUATION-DT.
 17616     GO TO 7022-AROUND-LIFE.
 17617
 17618 7021-GO-TO-LIFE.
 17619
 17620     MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE.
 17621     MOVE CM-POLICY-FORM-NO      TO PI-SAVE-FORM.
 17622     MOVE CM-LF-ORIG-TERM        TO WST-ORIG
 17623                                    CP-ORIGINAL-TERM.
 17624     MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD.
 17625     MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD.
 17626     MOVE CL-INCURRED-DT         TO CP-VALUATION-DT.
 17627     MOVE CM-LF-CURRENT-STATUS   TO WS-STATUS.
 17628
 17629     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 17630         MOVE WS-EXP-DT            TO DC-BIN-DATE-1
 17631     ELSE
 17632         MOVE CM-LF-LOAN-EXPIRE-DT TO DC-BIN-DATE-1.
 17633
 17634     MOVE ' '                    TO DC-OPTION-CODE.
 17635     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 17636     MOVE DC-GREG-DATE-1-EDIT    TO EXPDTEO.
 17637
 17638 7022-AROUND-LIFE.
 17639
 17640     MOVE PI-COMPANY-ID          TO CP-COMPANY-ID.
 17641     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT.
 17642     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE.
 17643     MOVE PI-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION.
 17644     MOVE '4'                    TO CP-REM-TERM-METHOD.
 17645     PERFORM 9800-LINK-REM-TERM THRU 9800-EXIT.
 17646     MOVE CP-REMAINING-TERM-3    TO WST-REM.
 17647
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 338
* EL156.cbl
 17648     MOVE SPACES                 TO WST-REM-DAYS-GRP.
 17649
 17650     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17651        IF CP-REMAINING-TERM-3 > CM-AH-ORIG-TERM
 17652           MOVE CM-AH-ORIG-TERM  TO WST-REM.
 17653
 17654     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17655        IF CP-REMAINING-TERM-3 > CM-LF-ORIG-TERM
 17656           MOVE CM-LF-ORIG-TERM  TO WST-REM.
 17657
 17658 7023-BYPASS-REMAINING-TERM.
 17659     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17660       IF CM-LF-CURRENT-STATUS = '6' OR '7' OR '8'
 17661          MOVE ZEROS                  TO BENEO
 17662       ELSE
 17663          MOVE WS-LF-COVERAGE-TYPE    TO CP-BENEFIT-TYPE
 17664          MOVE PI-COMPANY-ID          TO CP-COMPANY-ID
 17665          MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
 17666          MOVE CM-LF-BENEFIT-AMT      TO CP-ORIGINAL-BENEFIT
 17667          MOVE CM-LF-ALT-BENEFIT-AMT  TO CP-ALTERNATE-BENEFIT
 17668          MOVE CP-REMAINING-TERM-3    TO CP-REMAINING-TERM
 17669          MOVE CM-LOAN-APR            TO CP-LOAN-APR
 17670          MOVE CM-LOAN-TERM           TO CP-LOAN-TERM
 17671          MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
 17672          MOVE WS-EARNING-METHOD      TO CP-EARNING-METHOD
 17673          MOVE WS-SPECIAL-CALC-CD     TO CP-SPECIAL-CALC-CD
 17674          MOVE WS-STATE-ABBREV        TO CP-STATE-STD-ABBRV
 17675          IF (PI-COMPANY-ID = 'DCC')
 17676             AND (PI-DCC-PRODUCT-CODE not = '   ')
 17677             PERFORM 0900-GET-DDF-limits
 17678                                 THRU 0900-EXIT
 17679             IF PDEF-FOUND
 17680                PERFORM VARYING P1 FROM +1 BY +1 UNTIL
 17681                   (P1 > +8)
 17682                   OR (PD-PROD-CODE (P1) = 'L')
 17683                END-PERFORM
 17684                IF P1 < +9
 17685                   MOVE PD-MAX-AMT (P1)
 17686                                 TO CP-R-MAX-TOT-BEN
 17687                END-IF
 17688             END-IF
 17689          END-IF
 17690
 17691* EXEC CICS LINK
 17692*            PROGRAM  (LINK-REMAMT)
 17693*            COMMAREA (CALCULATION-PASS-AREA)
 17694*            LENGTH   (CP-COMM-LENGTH)
 17695*         END-EXEC
 17696*    MOVE '."C                   (   #00016253' TO DFHEIV0
 17697     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17698     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17699     MOVE X'2020233030303136323533' TO DFHEIV0(25:11)
 17700     CALL 'kxdfhei1' USING DFHEIV0,
 17701           LINK-REMAMT,
 17702           CALCULATION-PASS-AREA,
 17703           CP-COMM-LENGTH,
 17704           DFHEIV99,
 17705           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 339
* EL156.cbl
 17706           DFHEIV99,
 17707           DFHEIV99
 17708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17709          MOVE CP-REMAINING-AMT       TO BENEO
 17710       end-if
 17711     end-if
 17712     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17713     MOVE +95                    TO TRLR-SEQ-NO
 17714
 17715* EXEC CICS READ
 17716*       DATASET  ('ELTRLR')
 17717*       SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17718*       RIDFLD   (ELTRLR-KEY)
 17719*       RESP     (WS-RESPONSE)
 17720*    END-EXEC
 17721     MOVE 'ELTRLR' TO DFHEIV1
 17722*    MOVE '&"S        E          (  N#00016263' TO DFHEIV0
 17723     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17724     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17725     MOVE X'204E233030303136323633' TO DFHEIV0(25:11)
 17726     CALL 'kxdfhei1' USING DFHEIV0,
 17727           DFHEIV1,
 17728           DFHEIV20,
 17729           DFHEIV99,
 17730           ELTRLR-KEY,
 17731           DFHEIV99,
 17732           DFHEIV99,
 17733           DFHEIV99
 17734     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17735         DFHEIV20
 17736     MOVE EIBRESP  TO WS-RESPONSE
 17737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17738
 17739     if ws-resp-normal
 17740        perform varying s1 from +1 by +1 until
 17741           at-note-error-no (s1) = spaces
 17742           move at-note-error-no (s1)
 17743                                 to emi-error
 17744           if at-note-error-no (s1) = '1653'
 17745              evaluate true
 17746                 when cl-claim-type = 'L'
 17747                    move '  LF  '
 17748                                 to emi-claim-type
 17749                 when cl-claim-type = 'I'
 17750                    move '  IU  '
 17751                                 to emi-claim-type
 17752                 when cl-claim-type = 'F'
 17753                    move ' FMLA '
 17754                                 to emi-claim-type
 17755                 when other
 17756                    move '  AH  '
 17757                                 to emi-claim-type
 17758              end-evaluate
 17759           end-if
 17760           PERFORM 9900-ERROR-FORMAT
 17761                                 THRU 9900-EXIT
 17762        end-perform
 17763     end-if
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 340
* EL156.cbl
 17764     IF CL-CLAIM-TYPE = PI-LIFE-OVERRIDE-L1
 17765         IF PI-LIFE-OVERRIDE-L1 = 'P' OR
 17766            WS-LF-COVERAGE-TYPE = 'P'
 17767             COMPUTE WS-REMAINING-AMT = CM-LF-BENEFIT-AMT -
 17768                                        CM-LF-ITD-DEATH-AMT
 17769             MOVE WS-REMAINING-AMT  TO  BENEO.
 17770
 17771     MOVE CM-LF-BENEFIT-AMT      TO PI-ORIG-BEN-AMT.
 17772     MOVE BENEO                  TO PI-REM-BEN-AMT.
 17773     MOVE WS-TERMS               TO TERMSO.
 17774
 17775     IF WS-STATUS = '6' OR '7' OR '8'
 17776         MOVE AL-SABOF           TO CRTSTATA.
 17777
 17778     IF WS-STATUS = '1' OR '4'
 17779        IF CP-REMAINING-TERM-3 = ZEROS
 17780           MOVE 'EXPIRED'        TO CRTSTATO
 17781        ELSE
 17782           MOVE 'ACTIVE  '       TO CRTSTATO.
 17783
 17784     IF WS-STATUS = '2'
 17785         MOVE 'PEND    '         TO CRTSTATO.
 17786
 17787     IF WS-STATUS = '3'
 17788         MOVE 'RESTORE '         TO CRTSTATO.
 17789
 17790     IF WS-STATUS = '5'
 17791         MOVE 'REISSUE '         TO CRTSTATO.
 17792
 17793     IF WS-STATUS = '6'
 17794         MOVE 'LMP DIS'          TO CRTSTATO.
 17795
 17796     IF WS-STATUS = '7'
 17797         MOVE 'DEATH'            TO CRTSTATO.
 17798
 17799     IF WS-STATUS = '8'
 17800         MOVE 'CANCEL'           TO CRTSTATO.
 17801
 17802     IF WS-STATUS = '9'
 17803         MOVE 'RE-ONLY '         TO CRTSTATO.
 17804
 17805     IF WS-STATUS = 'V'
 17806         MOVE 'VOID  '           TO CRTSTATO.
 17807
 17808     IF WS-STATUS = 'D'
 17809         MOVE 'DECLINE '         TO CRTSTATO.
 17810
 17811     IF CL-CLAIM-TYPE = PI-AH-OVERRIDE-L1 OR 'I' OR 'G' or 'F'
 17812         MOVE CM-AH-BENEFIT-CD   TO WS-BEN-CD
 17813         MOVE '5'                TO CNTL-REC-TYPE
 17814     ELSE
 17815         MOVE CM-LF-BENEFIT-CD   TO WS-BEN-CD
 17816         MOVE '4'                TO CNTL-REC-TYPE.
 17817
 17818     MOVE '** NONE **'           TO COVERO.
 17819     MOVE AL-SABON               TO COVERA.
 17820
 17821     IF PI-COMPANY-ID = 'CVL'
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 341
* EL156.cbl
 17822         IF CM-BENEFICIARY NOT = SPACES AND LOW-VALUES
 17823             MOVE CM-BENEFICIARY TO LOANNOO
 17824             MOVE AL-UANON       TO LOANNOA.
 17825
 17826     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 17827        MOVE ELMSTR-KEY          TO  ELTRLR-KEY
 17828        MOVE +91                 TO  TRLR-SEQ-NO
 17829
 17830* EXEC CICS READ
 17831*           DATASET  ('ELTRLR')
 17832*           SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17833*           RIDFLD   (ELTRLR-KEY)
 17834*           RESP     (WS-RESPONSE)
 17835*       END-EXEC
 17836     MOVE 'ELTRLR' TO DFHEIV1
 17837*    MOVE '&"S        E          (  N#00016360' TO DFHEIV0
 17838     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17839     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17840     MOVE X'204E233030303136333630' TO DFHEIV0(25:11)
 17841     CALL 'kxdfhei1' USING DFHEIV0,
 17842           DFHEIV1,
 17843           DFHEIV20,
 17844           DFHEIV99,
 17845           ELTRLR-KEY,
 17846           DFHEIV99,
 17847           DFHEIV99,
 17848           DFHEIV99
 17849     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17850         DFHEIV20
 17851     MOVE EIBRESP  TO WS-RESPONSE
 17852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17853
 17854        IF WS-RESP-NORMAL
 17855           MOVE AT-INFO-LINE-1   TO  LOANNOO
 17856        ELSE
 17857           MOVE SPACES           TO  LOANNOO
 17858        END-IF
 17859*052506
 17860*052506        PERFORM 7250-FIND-LETTER-TRLR THRU 7250-EXIT
 17861*052506
 17862     END-IF
 17863
 17864     IF CL-PROG-FORM-TYPE = 'S' OR 'L'
 17865        MOVE CL-PROG-FORM-TYPE   TO FORMTYPO.
 17866
 17867     IF WS-BEN-CD = ZEROS
 17868         GO TO 7050-SHOW-CONTINUE.
 17869
 17870     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
 17871     MOVE WS-ACCESS              TO CNTL-ACCESS.
 17872     MOVE +0                     TO CNTL-SEQ-NO.
 17873     MOVE 'BENE'                 TO FILE-SWITCH.
 17874
 17875     PERFORM 7200-FIND-BENEFIT THRU 7200-EXIT.
 17876
 17877     IF BENEFIT-FOUND
 17878         MOVE CF-JOINT-INDICATOR (SUB-1)  TO PI-JOINT-COV-IND
 17879         MOVE CF-BENEFIT-DESCRIP (SUB-1)  TO COVERO
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 342
* EL156.cbl
 17880         MOVE AL-SANON                    TO COVERA.
 17881
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 343
* EL156.cbl
 17883 7050-SHOW-CONTINUE.
 17884
 17885     IF PI-JOINT-INSURED AND NOT PI-JOINT-COVERAGE
 17886        AND CL-TOTAL-PAID-AMT NOT GREATER THAN ZERO
 17887            MOVE 'Y' TO PI-APPROVAL-3550-NEEDED
 17888     END-IF
 17889
 17890     IF PI-COMPANY-ID = 'DMD'
 17891         PERFORM 8010-DMD-ERROR-CHECKS THRU 8090-EXIT.
 17892
 17893     MOVE -1                     TO PMTTYPEL.
 17894     GO TO 8100-SEND-INITIAL-MAP.
 17895
 17896 7100-SHOW-RECORD-NOT-FOUND.
 17897     IF FILE-SWITCH = 'MSTR'
 17898         MOVE ER-0204            TO EMI-ERROR.
 17899
 17900     IF FILE-SWITCH = 'CERT'
 17901         MOVE ER-0206            TO EMI-ERROR.
 17902
 17903     IF FILE-SWITCH = 'STAT'
 17904         MOVE ER-0149            TO EMI-ERROR.
 17905
 17906     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17907
 17908     MOVE -1                     TO PMTTYPEL.
 17909     GO TO 8100-SEND-INITIAL-MAP
 17910
 17911     .
 17912 7110-BUILD-PMT-TRLR.
 17913     MOVE ELMSTR-KEY             TO ELTRLR-KEY
 17914     MOVE +51                    TO TRLR-SEQ-NO
 17915
 17916* EXEC CICS READ
 17917*        DATASET  ('ELTRLR')
 17918*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 17919*        RIDFLD   (ELTRLR-KEY)
 17920*        RESP     (WS-RESPONSE)
 17921*    END-EXEC
 17922     MOVE 'ELTRLR' TO DFHEIV1
 17923*    MOVE '&"S        E          (  N#00016428' TO DFHEIV0
 17924     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17925     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17926     MOVE X'204E233030303136343238' TO DFHEIV0(25:11)
 17927     CALL 'kxdfhei1' USING DFHEIV0,
 17928           DFHEIV1,
 17929           DFHEIV20,
 17930           DFHEIV99,
 17931           ELTRLR-KEY,
 17932           DFHEIV99,
 17933           DFHEIV99,
 17934           DFHEIV99
 17935     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17936         DFHEIV20
 17937     MOVE EIBRESP  TO WS-RESPONSE
 17938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17939     IF WS-RESP-NORMAL
 17940        MOVE AT-MAIL-TO-NAME     TO PI-PAYEE-NAME
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 344
* EL156.cbl
 17941     END-IF
 17942     SUBTRACT 1 FROM CL-TRAILER-SEQ-CNT
 17943
 17944* EXEC CICS GETMAIN
 17945*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 17946*         LENGTH    (200)
 17947*         INITIMG   (GETMAIN-SPACE)
 17948*     END-EXEC
 17949     MOVE 200
 17950       TO DFHEIV11
 17951*    MOVE ',"IL                  $   #00016438' TO DFHEIV0
 17952     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17953     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17954     MOVE X'2020233030303136343338' TO DFHEIV0(25:11)
 17955     CALL 'kxdfhei1' USING DFHEIV0,
 17956           DFHEIV20,
 17957           DFHEIV11,
 17958           GETMAIN-SPACE
 17959     SET ADDRESS OF ACTIVITY-TRAILERS TO
 17960         DFHEIV20
 17961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17962     MOVE LOW-VALUES             TO AT-PREV-LAST-PMT-DT
 17963                                    AT-PREV-PAID-THRU-DT
 17964     MOVE ZEROS                  TO AT-PREV-LAST-PMT-AMT
 17965     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 17966     MOVE 'AT'                   TO AT-RECORD-ID
 17967     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 17968     MOVE +0                     TO AT-PAYMENT-NOTE-SEQ-NO
 17969     MOVE '2'                    TO AT-TRAILER-TYPE
 17970     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 17971                                    AT-PAYMENT-LAST-MAINT-DT
 17972     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 17973                                    AT-PAYMENT-LAST-UPDATED-BY
 17974     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 17975     MOVE 'I'                    TO AT-PAYMENT-TYPE
 17976     MOVE CL-CLAIM-TYPE          TO AT-CLAIM-TYPE
 17977     MOVE CL-CLAIM-PREM-TYPE     TO AT-CLAIM-PREM-TYPE
 17978     MOVE +0                     TO AT-EXPENSE-PER-PMT
 17979     MOVE PI-INT-AMT             TO AT-AMOUNT-PAID
 17980     MOVE LOW-VALUES             TO AT-PAID-FROM-DT
 17981     MOVE LOW-VALUES             TO AT-PAID-THRU-DT
 17982     MOVE PI-INT-DAYS            TO AT-DAYS-IN-PERIOD
 17983     MOVE PI-INT-RATE-USED       TO AT-INT-RATE
 17984     MOVE 'O1'                   TO AT-PAYEE-TYPE-CD
 17985     MOVE PI-PAYEE-NAME          TO AT-PAYEES-NAME
 17986     MOVE PI-MONTH-END-SAVE      TO AT-PMT-SELECT-DT
 17987     MOVE '3'                    TO AT-PAYMENT-ORIGIN
 17988     MOVE SPACES                 TO AT-AIG-UNEMP-IND
 17989     MOVE LOW-VALUES             TO AT-CHECK-WRITTEN-DT
 17990                                    AT-TO-BE-WRITTEN-DT
 17991     MOVE ZEROS                  TO AT-CHECK-QUE-CONTROL
 17992                                    AT-CHECK-QUE-SEQUENCE
 17993                                    AT-ADDL-RESERVE
 17994     MOVE LOW-VALUES             TO AT-PMT-ACCEPT-DT
 17995                                    AT-VOID-SELECT-DT
 17996                                    AT-VOID-ACCEPT-DT
 17997                                    AT-VOID-DT
 17998                                    AT-PMT-PROOF-DT
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 345
* EL156.cbl
 17999                                    AT-INT-PMT-SELECT-DT
 18000     MOVE ZEROS                  TO AT-DAILY-RATE
 18001                                    AT-ELIMINATION-DAYS
 18002     MOVE SPACES                 TO AT-BENEFIT-TYPE
 18003*    EXEC CICS HANDLE CONDITION
 18004*        DUPREC    (7120-DUPREC)
 18005*    END-EXEC
 18006     .
 18007 7115-WRITE-INT-TRLR.
 18008
 18009* EXEC CICS WRITE
 18010*         DATASET       ('ELTRLR')
 18011*         FROM          (ACTIVITY-TRAILERS)
 18012*         RIDFLD        (AT-CONTROL-PRIMARY)
 18013*         RESP          (WS-RESPONSE)
 18014*     END-EXEC
 18015     MOVE LENGTH OF
 18016      ACTIVITY-TRAILERS
 18017       TO DFHEIV11
 18018     MOVE 'ELTRLR' TO DFHEIV1
 18019*    MOVE '&$ L                  ''  N#00016489' TO DFHEIV0
 18020     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18021     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18022     MOVE X'204E233030303136343839' TO DFHEIV0(25:11)
 18023     CALL 'kxdfhei1' USING DFHEIV0,
 18024           DFHEIV1,
 18025           ACTIVITY-TRAILERS,
 18026           DFHEIV11,
 18027           AT-CONTROL-PRIMARY,
 18028           DFHEIV99,
 18029           DFHEIV99
 18030     MOVE EIBRESP  TO WS-RESPONSE
 18031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18032      IF WS-RESP-DUPREC
 18033         GO TO 7120-DUPREC
 18034      END-IF
 18035     GO TO 7130-EXIT
 18036     .
 18037 7120-DUPREC.
 18038     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18039     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18040     GO TO 7115-WRITE-INT-TRLR
 18041     .
 18042 7130-EXIT.
 18043      EXIT.
 18044 7140-BUILD-NOTE-TRLR.
 18045
 18046
 18047* EXEC CICS GETMAIN
 18048*         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18049*         LENGTH    (200)
 18050*         INITIMG   (GETMAIN-SPACE)
 18051*     END-EXEC
 18052     MOVE 200
 18053       TO DFHEIV11
 18054*    MOVE ',"IL                  $   #00016509' TO DFHEIV0
 18055     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18056     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 346
* EL156.cbl
 18057     MOVE X'2020233030303136353039' TO DFHEIV0(25:11)
 18058     CALL 'kxdfhei1' USING DFHEIV0,
 18059           DFHEIV20,
 18060           DFHEIV11,
 18061           GETMAIN-SPACE
 18062     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18063         DFHEIV20
 18064     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18065     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18066     MOVE ELMSTR-KEY             TO AT-CONTROL-PRIMARY
 18067     MOVE 'AT'                   TO AT-RECORD-ID
 18068     MOVE CL-TRAILER-SEQ-CNT     TO AT-SEQUENCE-NO
 18069     MOVE '6'                    TO AT-TRAILER-TYPE
 18070     MOVE WS-TODAY-DATE          TO AT-RECORDED-DT
 18071                                    AT-GEN-INFO-LAST-MAINT-DT
 18072     MOVE PI-PROCESSOR-ID        TO AT-RECORDED-BY
 18073                                    AT-GEN-INFO-LAST-UPDATED-BY
 18074     MOVE EIBTIME                TO AT-LAST-MAINT-HHMMSS
 18075     MOVE 'NO INTEREST DUE'      TO AT-INFO-LINE-1
 18076     .
 18077 7150-WRITE.
 18078
 18079* EXEC CICS HANDLE CONDITION
 18080*        DUPREC    (7160-DUPREC)
 18081*    END-EXEC
 18082*    MOVE '"$%                   ! : #00016527' TO DFHEIV0
 18083     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 18084     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18085     MOVE X'3A20233030303136353237' TO DFHEIV0(25:11)
 18086     CALL 'kxdfhei1' USING DFHEIV0
 18087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18088
 18089* EXEC CICS WRITE
 18090*         DATASET     ('ELTRLR')
 18091*         FROM        (ACTIVITY-TRAILERS)
 18092*         RIDFLD      (AT-CONTROL-PRIMARY)
 18093*         RESP        (WS-RESPONSE)
 18094*     END-EXEC
 18095     MOVE LENGTH OF
 18096      ACTIVITY-TRAILERS
 18097       TO DFHEIV11
 18098     MOVE 'ELTRLR' TO DFHEIV1
 18099*    MOVE '&$ L                  ''  N#00016530' TO DFHEIV0
 18100     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18101     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18102     MOVE X'204E233030303136353330' TO DFHEIV0(25:11)
 18103     CALL 'kxdfhei1' USING DFHEIV0,
 18104           DFHEIV1,
 18105           ACTIVITY-TRAILERS,
 18106           DFHEIV11,
 18107           AT-CONTROL-PRIMARY,
 18108           DFHEIV99,
 18109           DFHEIV99
 18110     MOVE EIBRESP  TO WS-RESPONSE
 18111     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18112      IF WS-RESP-DUPREC
 18113         GO TO 7160-DUPREC
 18114      END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 347
* EL156.cbl
 18115     GO TO 7170-EXIT
 18116     .
 18117 7160-DUPREC.
 18118     SUBTRACT +1                 FROM CL-TRAILER-SEQ-CNT
 18119     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO
 18120     GO TO 7150-WRITE
 18121     .
 18122 7170-EXIT.
 18123      EXIT.
 18124
 18125 7180-ADD-CERT-NOTE.
 18126*ADD CERT NOTE FOR SC NP+6
 18127
 18128
 18129* EXEC CICS GETMAIN
 18130*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18131*         LENGTH    (150)
 18132*         INITIMG   (GETMAIN-SPACE)
 18133*     END-EXEC.
 18134     MOVE 150
 18135       TO DFHEIV11
 18136*    MOVE ',"IL                  $   #00016552' TO DFHEIV0
 18137     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18138     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18139     MOVE X'2020233030303136353532' TO DFHEIV0(25:11)
 18140     CALL 'kxdfhei1' USING DFHEIV0,
 18141           DFHEIV20,
 18142           DFHEIV11,
 18143           GETMAIN-SPACE
 18144     SET ADDRESS OF CERT-NOTE-FILE TO
 18145         DFHEIV20
 18146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18147
 18148
 18149     MOVE SPACES                 TO WRK-CERT-NOTE-ADD.
 18150     MOVE SPACES                 TO WRK-ORIG-NOTE-ADD.
 18151     MOVE +1                     TO WRK-NOTE-SEQ.
 18152     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18153     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18154     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18155     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18156     MOVE CL-CERT-STATE          TO CZ-STATE.
 18157     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18158     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18159     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18160     MOVE '2'                    TO CZ-RECORD-TYPE.
 18161     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18162     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18163     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18164     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18165     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18166     MOVE PI-REM-BEN-AMT         TO SC-NP6-REM-BEN.
 18167     MOVE PI-MO-BEN-AMT          TO SC-NP6-6-MO.
 18168     MOVE ' + 6 MO '             TO SC-NP6-COMM
 18169     IF PI-COMPANY-ID = 'AHL'
 18170        IF PI-LF-BENEFIT-CD = '5I' OR '6J'
 18171           CONTINUE
 18172        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 348
* EL156.cbl
 18173           IF PI-LF-BENEFIT-CD = '5M' OR '6M'
 18174              MOVE ' + 1 MO '    TO SC-NP6-COMM
 18175           ELSE
 18176              MOVE ' + 2 MO '    TO SC-NP6-COMM
 18177           END-IF
 18178        END-IF
 18179     END-IF
 18180     MOVE PI-CPYAMT              TO SC-NP6-AMT-PAID.
 18181     MOVE SC-NP6-CERT-NOTE       TO CZ-NOTE.
 18182
 18183 7181-WRITE.
 18184
 18185
 18186* EXEC CICS WRITE
 18187*         DATASET     ('ERCNOT')
 18188*         FROM        (CERT-NOTE-FILE)
 18189*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18190*         RESP        (WS-RESPONSE)
 18191*    END-EXEC.
 18192     MOVE LENGTH OF
 18193      CERT-NOTE-FILE
 18194       TO DFHEIV11
 18195     MOVE 'ERCNOT' TO DFHEIV1
 18196*    MOVE '&$ L                  ''  N#00016594' TO DFHEIV0
 18197     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18198     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18199     MOVE X'204E233030303136353934' TO DFHEIV0(25:11)
 18200     CALL 'kxdfhei1' USING DFHEIV0,
 18201           DFHEIV1,
 18202           CERT-NOTE-FILE,
 18203           DFHEIV11,
 18204           CZ-CONTROL-PRIMARY,
 18205           DFHEIV99,
 18206           DFHEIV99
 18207     MOVE EIBRESP  TO WS-RESPONSE
 18208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18209
 18210
 18211     IF WS-RESP-DUPREC
 18212         GO TO 7182-DUPREC
 18213     END-IF.
 18214
 18215     SET CERT-NOTE-ADDED TO TRUE.
 18216
 18217     IF PI-CPYAMT EQUAL PI-ORIG-BEN-AMT
 18218         PERFORM 7190-ADD-ORIG-NOTE THRU 7199-EXIT
 18219     END-IF.
 18220
 18221     GO TO 7189-EXIT.
 18222
 18223 7182-DUPREC.
 18224
 18225     ADD +1                      TO  WRK-NOTE-SEQ.
 18226     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18227     GO TO 7181-WRITE.
 18228
 18229 7189-EXIT.
 18230      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 349
* EL156.cbl
 18231
 18232 7190-ADD-ORIG-NOTE.
 18233
 18234
 18235* EXEC CICS GETMAIN
 18236*         SET       (ADDRESS OF CERT-NOTE-FILE)
 18237*         LENGTH    (150)
 18238*         INITIMG   (GETMAIN-SPACE)
 18239*     END-EXEC.
 18240     MOVE 150
 18241       TO DFHEIV11
 18242*    MOVE ',"IL                  $   #00016624' TO DFHEIV0
 18243     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 18244     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18245     MOVE X'2020233030303136363234' TO DFHEIV0(25:11)
 18246     CALL 'kxdfhei1' USING DFHEIV0,
 18247           DFHEIV20,
 18248           DFHEIV11,
 18249           GETMAIN-SPACE
 18250     SET ADDRESS OF CERT-NOTE-FILE TO
 18251         DFHEIV20
 18252     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18253
 18254
 18255     ADD +1                      TO WRK-NOTE-SEQ.
 18256     MOVE LOW-VALUES             TO CERT-NOTE-FILE.
 18257     MOVE PI-COMPANY-CD          TO CZ-COMPANY-CD.
 18258     MOVE CL-CERT-CARRIER        TO CZ-CARRIER.
 18259     MOVE CL-CERT-GROUPING       TO CZ-GROUPING.
 18260     MOVE CL-CERT-STATE          TO CZ-STATE.
 18261     MOVE CL-CERT-ACCOUNT        TO CZ-ACCOUNT.
 18262     MOVE CL-CERT-EFF-DT         TO CZ-CERT-EFF-DT.
 18263     MOVE CL-CERT-NO             TO CZ-CERT-NO.
 18264     MOVE '2'                    TO CZ-RECORD-TYPE.
 18265     MOVE WRK-NOTE-SEQ           TO CZ-NOTE-SEQUENCE.
 18266     MOVE 'CZ'                   TO CZ-RECORD-ID.
 18267     MOVE WS-TODAY-DATE          TO CZ-LAST-MAINT-DT.
 18268     MOVE EIBTIME                TO CZ-LAST-MAINT-HHMMSS.
 18269     MOVE PI-PROCESSOR-ID        TO CZ-LAST-MAINT-USER.
 18270     MOVE SC-NP6-ORIG-NOTE       TO CZ-NOTE.
 18271
 18272 7191-WRITE.
 18273
 18274
 18275* EXEC CICS WRITE
 18276*         DATASET     ('ERCNOT')
 18277*         FROM        (CERT-NOTE-FILE)
 18278*         RIDFLD      (CZ-CONTROL-PRIMARY)
 18279*         RESP        (WS-RESPONSE)
 18280*    END-EXEC.
 18281     MOVE LENGTH OF
 18282      CERT-NOTE-FILE
 18283       TO DFHEIV11
 18284     MOVE 'ERCNOT' TO DFHEIV1
 18285*    MOVE '&$ L                  ''  N#00016649' TO DFHEIV0
 18286     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 18287     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 18288     MOVE X'204E233030303136363439' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 350
* EL156.cbl
 18289     CALL 'kxdfhei1' USING DFHEIV0,
 18290           DFHEIV1,
 18291           CERT-NOTE-FILE,
 18292           DFHEIV11,
 18293           CZ-CONTROL-PRIMARY,
 18294           DFHEIV99,
 18295           DFHEIV99
 18296     MOVE EIBRESP  TO WS-RESPONSE
 18297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18298
 18299
 18300     IF WS-RESP-DUPREC
 18301         GO TO 7192-DUPREC
 18302     END-IF.
 18303
 18304     GO TO 7199-EXIT.
 18305
 18306 7192-DUPREC.
 18307
 18308     ADD +1                      TO  WRK-NOTE-SEQ.
 18309     MOVE WRK-NOTE-SEQ           TO  CZ-NOTE-SEQUENCE.
 18310     GO TO 7191-WRITE.
 18311
 18312 7199-EXIT.
 18313      EXIT.
 18314 7200-FIND-BENEFIT.
 18315     MOVE 'N' TO WS-BEN-SEARCH-SW.
 18316
 18317
 18318* EXEC CICS HANDLE CONDITION
 18319*        ENDFILE(7200-EXIT)
 18320*        NOTFND(7200-EXIT)
 18321*    END-EXEC.
 18322*    MOVE '"$''I                  ! ; #00016673' TO DFHEIV0
 18323     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18324     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18325     MOVE X'3B20233030303136363733' TO DFHEIV0(25:11)
 18326     CALL 'kxdfhei1' USING DFHEIV0
 18327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18328
 18329
 18330
 18331* EXEC CICS READ
 18332*        DATASET('ELCNTL')
 18333*        SET(ADDRESS OF CONTROL-FILE)
 18334*        RIDFLD(ELCNTL-KEY)
 18335*        GTEQ
 18336*    END-EXEC.
 18337     MOVE 'ELCNTL' TO DFHEIV1
 18338*    MOVE '&"S        G          (   #00016678' TO DFHEIV0
 18339     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18340     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18341     MOVE X'2020233030303136363738' TO DFHEIV0(25:11)
 18342     CALL 'kxdfhei1' USING DFHEIV0,
 18343           DFHEIV1,
 18344           DFHEIV20,
 18345           DFHEIV99,
 18346           ELCNTL-KEY,
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 351
* EL156.cbl
 18347           DFHEIV99,
 18348           DFHEIV99,
 18349           DFHEIV99
 18350     SET ADDRESS OF CONTROL-FILE TO
 18351         DFHEIV20
 18352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18353
 18354
 18355     IF CNTL-COMP-ID  NOT = CF-COMPANY-ID  OR
 18356        CNTL-REC-TYPE NOT = CF-RECORD-TYPE
 18357           GO TO 7200-EXIT.
 18358
 18359     PERFORM 7200-BENEFIT-DUMMY THRU 7200-DUMMY-EXIT
 18360         VARYING SUB-1 FROM 1 BY 1 UNTIL
 18361            ((SUB-1 > 8) OR
 18362            (CF-BENEFIT-CODE (SUB-1) = WS-BEN-CD)).
 18363
 18364     IF SUB-1 NOT = 9
 18365         MOVE 'Y' TO WS-BEN-SEARCH-SW.
 18366
 18367     GO TO 7200-EXIT.
 18368
 18369 7200-BENEFIT-DUMMY.
 18370
 18371 7200-DUMMY-EXIT.
 18372     EXIT.
 18373
 18374 7200-EXIT.
 18375     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 352
* EL156.cbl
 18377*052506
 18378*052506 7250-FIND-LETTER-TRLR.
 18379*052506     EXEC CICS HANDLE CONDITION
 18380*052506         ENDFILE  (7250-END)
 18381*052506         NOTFND   (7250-END)
 18382*052506     END-EXEC.
 18383*052506
 18384*052506     EXEC CICS STARTBR
 18385*052506         DATASET   ('ELTRLR')
 18386*052506         RIDFLD    (ELTRLR-KEY)
 18387*052506         GTEQ
 18388*052506     END-EXEC.
 18389*052506
 18390*052506     MOVE LOW-VALUES TO WS-MAX-LETTER-ANSWER-DT.
 18391*052506
 18392*052506 7250-FIND-LOOP.
 18393*052506     EXEC CICS READNEXT
 18394*052506         DATASET   ('ELTRLR')
 18395*052506         RIDFLD    (ELTRLR-KEY)
 18396*052506         SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18397*052506     END-EXEC.
 18398*052506
 18399*052506     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18400*052506        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18401*052506        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18402*052506        PI-CERT-NO    NOT = TRLR-CERT-NO
 18403*052506        GO TO 7250-END
 18404*052506     END-IF.
 18405*052506
 18406*052506     IF AT-TRAILER-TYPE NOT = '4'
 18407*052506         GO TO 7250-FIND-LOOP
 18408*052506     END-IF.
 18409*052506
 18410*052506     IF AT-LETTER-ANSWERED-DT GREATER THAN WS-MAX-LETTER-AN
 18411*052506         MOVE AT-LETTER-ANSWERED-DT TO WS-MAX-LETTER-ANSWER
 18412*052506     END-IF.
 18413*052506
 18414*052506     GO TO 7250-FIND-LOOP.
 18415*052506
 18416*052506 7250-END.
 18417*052506
 18418*052506     IF WS-MAX-LETTER-ANSWER-DT NOT = LOW-VALUES AND SPACES
 18419*051506         MOVE SPACES             TO  DC-OPTION-CODE
 18420*052506         MOVE WS-MAX-LETTER-ANSWER-DT TO  DC-BIN-DATE-1
 18421*052506         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18422*052506         MOVE DC-GREG-DATE-1-MDY  TO  PI-PROOF-DATE
 18423*052506         MOVE PI-PROOF-DATE  TO  PROOFDTO
 18424*052506         INSPECT PROOFDTI REPLACING ALL SPACES BY '/'
 18425*052506     END-IF.
 18426*052506
 18427*052506     EXEC CICS ENDBR
 18428*052506          DATASET    ('ELTRLR')
 18429*052506     END-EXEC.
 18430*052506
 18431*052506 7250-EXIT.
 18432*052506     EXIT.
 18433*052506     EJECT
 18434*052506
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 353
* EL156.cbl
 18435 7300-CHECK-AUTO-ACTIVITY.
 18436
 18437     IF PI-PMTTYPE = '1' OR '2' OR '3' OR '4'
 18438         NEXT SENTENCE
 18439     ELSE
 18440         GO TO 7399-EXIT.
 18441
 18442     PERFORM 7400-CHECK-AUTO-ACTIVITY THRU 7400-EXIT.
 18443
 18444     IF WS-ACT-REC-FOUND-SW = 'N'
 18445         GO TO 7399-EXIT.
 18446
 18447     IF PI-ACTIVITY-CODE = 09
 18448         GO TO 7300-CONT-AUTO-ACTIVITY.
 18449
 18450     IF (PI-COMPANY-ID = 'AIG' OR 'AUK') AND
 18451        (PI-ACTIVITY-CODE = 11)
 18452         GO TO 7300-CONT-AUTO-ACTIVITY.
 18453
 18454     IF PI-PROVISIONAL-IND = 'P'
 18455         IF PI-PMTTYPE = '1'
 18456             IF CF-SYS-ACTIVE-SW (9) = ' ' OR 'N'
 18457                 MOVE 'N'    TO  PI-RESET-SW
 18458                 GO TO 7399-EXIT.
 18459
 18460     IF PI-PMTTYPE = '1'
 18461         IF CF-SYS-ACTIVE-SW (2) = ' ' OR 'N'
 18462             MOVE 'N'        TO  PI-RESET-SW
 18463             GO TO 7399-EXIT.
 18464
 18465     IF PI-PMTTYPE = '2' OR '3'
 18466         IF CF-SYS-ACTIVE-SW (3) = ' ' OR 'N'
 18467             MOVE 'N'        TO  PI-RESET-SW
 18468             GO TO 7399-EXIT.
 18469
 18470     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 18471         IF PI-PROVISIONAL-IND = 'P'
 18472             NEXT SENTENCE
 18473         ELSE
 18474             PERFORM 7500-RESET-AUTO-ACTIVITY THRU 7599-EXIT.
 18475
 18476 7300-CONT-AUTO-ACTIVITY.
 18477
 18478     IF PI-PFKEY-USED = DFHPF3 OR DFHPF4
 18479         MOVE PI-EPYTHRU     TO DC-GREG-DATE-1-MDY
 18480         MOVE '4'            TO DC-OPTION-CODE
 18481         MOVE +0             TO DC-ELAPSED-DAYS
 18482                                DC-ELAPSED-MONTHS
 18483         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18484         MOVE DC-BIN-DATE-1  TO WS-CHK-THRU-DT
 18485         IF PI-USES-PAID-TO
 18486             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18487             IF NO-CONVERSION-ERROR
 18488                 MOVE +1     TO DC-ELAPSED-DAYS
 18489                 MOVE +0     TO DC-ELAPSED-MONTHS
 18490                 MOVE '6'    TO DC-OPTION-CODE
 18491                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18492                 IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 354
* EL156.cbl
 18493                     MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18494
 18495     IF PI-PFKEY-USED = DFHPF5
 18496         MOVE PI-CPYTHRU TO WS-CHK-THRU-DT
 18497         IF PI-USES-PAID-TO
 18498             MOVE PI-CPYTHRU          TO DC-BIN-DATE-1
 18499             MOVE +1                  TO DC-ELAPSED-DAYS
 18500             MOVE +0                  TO DC-ELAPSED-MONTHS
 18501             MOVE '6'                 TO DC-OPTION-CODE
 18502             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18503             IF NO-CONVERSION-ERROR
 18504                 MOVE DC-BIN-DATE-2   TO WS-CHK-THRU-DT.
 18505
 18506     IF WS-CHK-THRU-DT < PI-EXP-DT
 18507         NEXT SENTENCE
 18508     ELSE
 18509         MOVE 03                     TO  WS-ACTIVITY-CODE
 18510         GO TO 7390-PROCESS-ACTIVITY.
 18511
 18512     IF PI-PROV-PMT
 18513         MOVE 09                     TO  WS-ACTIVITY-CODE
 18514     ELSE
 18515        IF PI-PMTTYPE = '1'
 18516            MOVE 02                  TO  WS-ACTIVITY-CODE
 18517        ELSE
 18518        IF PI-PMTTYPE = '2' OR '3'
 18519            MOVE 07                  TO  WS-ACTIVITY-CODE
 18520        ELSE
 18521        IF PI-PMTTYPE = '4'
 18522            MOVE 00                  TO  WS-ACTIVITY-CODE
 18523        ELSE
 18524            MOVE 'N'                 TO  PI-RESET-SW
 18525            GO TO 7399-EXIT.
 18526
 18527 7390-PROCESS-ACTIVITY.
 18528
 18529     PERFORM 7450-FORMAT-AUTO-LETTER THRU 7450-EXIT.
 18530
 18531 7399-EXIT.
 18532     EXIT.
 18533
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 355
* EL156.cbl
 18535 7400-CHECK-AUTO-ACTIVITY.
 18536
 18537
 18538* EXEC CICS HANDLE CONDITION
 18539*        NOTFND   (7400-NOT-FOUND)
 18540*    END-EXEC.
 18541*    MOVE '"$I                   ! < #00016867' TO DFHEIV0
 18542     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18544     MOVE X'3C20233030303136383637' TO DFHEIV0(25:11)
 18545     CALL 'kxdfhei1' USING DFHEIV0
 18546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18547
 18548
 18549     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
 18550     MOVE 'T'                    TO  CNTL-REC-TYPE.
 18551     MOVE SPACES                 TO  CNTL-ACCESS.
 18552     MOVE +0                     TO  CNTL-SEQ-NO.
 18553
 18554
 18555* EXEC CICS READ
 18556*        DATASET   ('ELCNTL')
 18557*        RIDFLD    (ELCNTL-KEY)
 18558*        SET       (ADDRESS OF CONTROL-FILE)
 18559*    END-EXEC.
 18560     MOVE 'ELCNTL' TO DFHEIV1
 18561*    MOVE '&"S        E          (   #00016876' TO DFHEIV0
 18562     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18563     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18564     MOVE X'2020233030303136383736' TO DFHEIV0(25:11)
 18565     CALL 'kxdfhei1' USING DFHEIV0,
 18566           DFHEIV1,
 18567           DFHEIV20,
 18568           DFHEIV99,
 18569           ELCNTL-KEY,
 18570           DFHEIV99,
 18571           DFHEIV99,
 18572           DFHEIV99
 18573     SET ADDRESS OF CONTROL-FILE TO
 18574         DFHEIV20
 18575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18576
 18577
 18578     MOVE 'Y'                        TO  WS-ACT-REC-FOUND-SW.
 18579     GO TO 7400-EXIT.
 18580
 18581 7400-NOT-FOUND.
 18582     MOVE 'N'                        TO  PI-RESET-SW
 18583                                         WS-LETTER-SW
 18584                                         WS-ACT-REC-FOUND-SW.
 18585
 18586     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18587
 18588 7400-EXIT.
 18589     EXIT.
 18590
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 356
* EL156.cbl
 18592 7450-FORMAT-AUTO-LETTER.
 18593
 18594     IF PI-ACTIVITY-CODE = ZEROS OR LOW-VALUES OR SPACES
 18595         MOVE 'Y'                    TO PI-RESET-SW
 18596         GO TO 7450-CONTINUE-PROCESS.
 18597
 18598     MOVE PI-ACTIVITY-CODE           TO  SUB.
 18599
 18600     IF SUB > 9
 18601         SUBTRACT 9 FROM SUB
 18602         MOVE CF-USER-RESET-SW (SUB)  TO PI-RESET-SW
 18603     ELSE
 18604         MOVE CF-SYS-RESET-SW (SUB)   TO PI-RESET-SW.
 18605
 18606 7450-CONTINUE-PROCESS.
 18607
 18608     IF WS-ACTIVITY-CODE = ZEROS
 18609         MOVE 'N'                    TO  WS-LETTER-SW
 18610         GO TO 7450-EXIT.
 18611
 18612     MOVE WS-ACTIVITY-CODE           TO  SUB.
 18613
 18614     IF CF-SYS-ACTIVE-SW (SUB) = ' ' OR 'N'
 18615         MOVE 'N'                    TO  PI-RESET-SW
 18616                                         WS-LETTER-SW
 18617         GO TO 7450-EXIT.
 18618
 18619     IF CF-SYS-LETTER-ID (SUB) = SPACES OR LOW-VALUES
 18620         MOVE 'N'                    TO  WS-LETTER-SW
 18621         GO TO 7450-EXIT.
 18622
 18623     MOVE 'Y'                        TO  WS-LETTER-SW.
 18624     MOVE LOW-VALUES                 TO  W-1523-LINKDATA.
 18625     MOVE PROGRAM-INTERFACE-BLOCK    TO  W-1523-COMMON-PI-DATA.
 18626
 18627     MOVE CF-SYS-LETTER-ID  (SUB)    TO W-1523-FORM-NUMBER.
 18628
 18629     IF CF-SYS-RESEND-DAYS (SUB) NOT = ZEROS
 18630         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18631         MOVE '6'                    TO  DC-OPTION-CODE
 18632         MOVE CF-SYS-RESEND-DAYS (SUB)   TO  DC-ELAPSED-DAYS
 18633         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18634         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18635         IF NO-CONVERSION-ERROR
 18636             MOVE DC-BIN-DATE-2      TO  W-1523-RESEND-DATE
 18637         ELSE
 18638              MOVE LOW-VALUES        TO  W-1523-RESEND-DATE.
 18639
 18640     IF CF-SYS-FOLLOW-UP-DAYS (SUB) NOT = ZEROS
 18641         MOVE SAVE-BIN-DATE          TO  DC-BIN-DATE-1
 18642         MOVE '6'                    TO  DC-OPTION-CODE
 18643         MOVE CF-SYS-FOLLOW-UP-DAYS (SUB) TO DC-ELAPSED-DAYS
 18644         MOVE +0                     TO  DC-ELAPSED-MONTHS
 18645         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
 18646         IF NO-CONVERSION-ERROR
 18647             MOVE DC-BIN-DATE-2      TO  W-1523-FOLLOW-UP-DATE
 18648         ELSE
 18649             MOVE LOW-VALUES         TO  W-1523-FOLLOW-UP-DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 357
* EL156.cbl
 18650
 18651 7450-EXIT.
 18652     EXIT.
 18653
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 358
* EL156.cbl
 18655 7500-RESET-AUTO-ACTIVITY.
 18656
 18657     MOVE PI-COMPANY-CD          TO  TRLR-COMP-CD.
 18658     MOVE PI-CARRIER             TO  TRLR-CARRIER.
 18659     MOVE PI-CLAIM-NO            TO  TRLR-CLAIM-NO.
 18660     MOVE PI-CERT-NO             TO  TRLR-CERT-NO.
 18661     MOVE +100                   TO  TRLR-SEQ-NO.
 18662
 18663 7500-STARTBR-TRLR.
 18664
 18665
 18666* EXEC CICS HANDLE CONDITION
 18667*        ENDFILE  (7590-END)
 18668*        NOTFND   (7590-END)
 18669*    END-EXEC.
 18670*    MOVE '"$''I                  ! = #00016969' TO DFHEIV0
 18671     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 18672     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18673     MOVE X'3D20233030303136393639' TO DFHEIV0(25:11)
 18674     CALL 'kxdfhei1' USING DFHEIV0
 18675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18676
 18677
 18678
 18679* EXEC CICS STARTBR
 18680*        DATASET   ('ELTRLR')
 18681*        RIDFLD    (ELTRLR-KEY)
 18682*        GTEQ
 18683*    END-EXEC.
 18684     MOVE 'ELTRLR' TO DFHEIV1
 18685     MOVE 0
 18686       TO DFHEIV11
 18687*    MOVE '&,         G          &   #00016974' TO DFHEIV0
 18688     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18689     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18690     MOVE X'2020233030303136393734' TO DFHEIV0(25:11)
 18691     CALL 'kxdfhei1' USING DFHEIV0,
 18692           DFHEIV1,
 18693           ELTRLR-KEY,
 18694           DFHEIV99,
 18695           DFHEIV11,
 18696           DFHEIV99
 18697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18698
 18699
 18700     MOVE 'Y'                        TO  WS-BROWSE-SW.
 18701
 18702 7500-READ-NEXT.
 18703
 18704
 18705* EXEC CICS READNEXT
 18706*        DATASET   ('ELTRLR')
 18707*        RIDFLD    (ELTRLR-KEY)
 18708*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18709*    END-EXEC.
 18710     MOVE 'ELTRLR' TO DFHEIV1
 18711     MOVE 0
 18712       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 359
* EL156.cbl
 18713*    MOVE '&.S                   )   #00016984' TO DFHEIV0
 18714     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18715     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18716     MOVE X'2020233030303136393834' TO DFHEIV0(25:11)
 18717     CALL 'kxdfhei1' USING DFHEIV0,
 18718           DFHEIV1,
 18719           DFHEIV20,
 18720           DFHEIV99,
 18721           ELTRLR-KEY,
 18722           DFHEIV99,
 18723           DFHEIV11,
 18724           DFHEIV99,
 18725           DFHEIV99
 18726     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18727         DFHEIV20
 18728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18729
 18730
 18731     IF PI-COMPANY-CD NOT = TRLR-COMP-CD  OR
 18732        PI-CARRIER    NOT = TRLR-CARRIER  OR
 18733        PI-CLAIM-NO   NOT = TRLR-CLAIM-NO OR
 18734        PI-CERT-NO    NOT = TRLR-CERT-NO
 18735         GO TO 7590-END.
 18736
 18737     IF ELTRLR-KEY = PI-PREV-TRLR-KEY
 18738         GO TO 7500-READ-NEXT.
 18739
 18740     IF AT-TRAILER-TYPE NOT = '4'
 18741         GO TO 7500-READ-NEXT.
 18742
 18743     IF AT-LETTER-ANSWERED-DT NOT = LOW-VALUES AND SPACES
 18744         GO TO 7500-READ-NEXT.
 18745
 18746     IF (AT-AUTO-RE-SEND-DT   = LOW-VALUES OR SPACES) AND
 18747        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES OR SPACES)
 18748         GO TO 7500-READ-NEXT.
 18749
 18750     IF AT-RECEIPT-FOLLOW-UP < SAVE-BIN-DATE AND
 18751        AT-AUTO-RE-SEND-DT   < SAVE-BIN-DATE AND
 18752        AT-RESEND-PRINT-DATE < SAVE-BIN-DATE
 18753         GO TO 7500-READ-NEXT.
 18754
 18755     IF (AT-AUTO-RE-SEND-DT NOT = LOW-VALUES AND SPACES)
 18756                         AND
 18757        (AT-RESEND-PRINT-DATE NOT = LOW-VALUES AND SPACES)
 18758                         AND
 18759        (AT-RECEIPT-FOLLOW-UP = LOW-VALUES)
 18760            GO TO 7500-READ-NEXT.
 18761
 18762     MOVE ELTRLR-KEY                 TO  PI-PREV-TRLR-KEY.
 18763
 18764
 18765* EXEC CICS ENDBR
 18766*        DATASET   ('ELTRLR')
 18767*    END-EXEC.
 18768     MOVE 'ELTRLR' TO DFHEIV1
 18769     MOVE 0
 18770       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 360
* EL156.cbl
 18771*    MOVE '&2                    $   #00017023' TO DFHEIV0
 18772     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18773     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18774     MOVE X'2020233030303137303233' TO DFHEIV0(25:11)
 18775     CALL 'kxdfhei1' USING DFHEIV0,
 18776           DFHEIV1,
 18777           DFHEIV11,
 18778           DFHEIV99
 18779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18780
 18781
 18782     MOVE 'N'                        TO  WS-BROWSE-SW.
 18783
 18784
 18785* EXEC CICS READ
 18786*        DATASET   ('ELTRLR')
 18787*        RIDFLD    (ELTRLR-KEY)
 18788*        SET       (ADDRESS OF ACTIVITY-TRAILERS)
 18789*        UPDATE
 18790*    END-EXEC.
 18791     MOVE 'ELTRLR' TO DFHEIV1
 18792*    MOVE '&"S        EU         (   #00017029' TO DFHEIV0
 18793     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18794     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18795     MOVE X'2020233030303137303239' TO DFHEIV0(25:11)
 18796     CALL 'kxdfhei1' USING DFHEIV0,
 18797           DFHEIV1,
 18798           DFHEIV20,
 18799           DFHEIV99,
 18800           ELTRLR-KEY,
 18801           DFHEIV99,
 18802           DFHEIV99,
 18803           DFHEIV99
 18804     SET ADDRESS OF ACTIVITY-TRAILERS TO
 18805         DFHEIV20
 18806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18807
 18808
 18809     MOVE 'Y'                        TO  WS-UPDATE-SW.
 18810
 18811     IF AT-AUTO-RE-SEND-DT NOT < SAVE-BIN-DATE
 18812         MOVE LOW-VALUES             TO  AT-AUTO-RE-SEND-DT
 18813     ELSE
 18814         IF AT-RECEIPT-FOLLOW-UP NOT < SAVE-BIN-DATE
 18815             NEXT SENTENCE
 18816         ELSE
 18817             GO TO 7500-REWRITE-TRLR.
 18818
 18819     MOVE LOW-VALUES                 TO  AT-RECEIPT-FOLLOW-UP.
 18820
 18821     MOVE PI-COMPANY-CD              TO  ARCH-CO.
 18822     MOVE AT-LETTER-ARCHIVE-NO       TO  ARCH-NUMBER.
 18823     MOVE '1'                        TO  ARCH-REC-TYPE.
 18824     MOVE +0                         TO  ARCH-SEQ.
 18825
 18826     PERFORM 7600-READ-ARCH-UPDATE THRU 7699-EXIT.
 18827
 18828 7500-REWRITE-TRLR.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 361
* EL156.cbl
 18829
 18830
 18831* EXEC CICS REWRITE
 18832*        DATASET   ('ELTRLR')
 18833*        FROM      (ACTIVITY-TRAILERS)
 18834*    END-EXEC.
 18835     MOVE LENGTH OF
 18836      ACTIVITY-TRAILERS
 18837       TO DFHEIV11
 18838     MOVE 'ELTRLR' TO DFHEIV1
 18839*    MOVE '&& L                  %   #00017057' TO DFHEIV0
 18840     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18841     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18842     MOVE X'2020233030303137303537' TO DFHEIV0(25:11)
 18843     CALL 'kxdfhei1' USING DFHEIV0,
 18844           DFHEIV1,
 18845           ACTIVITY-TRAILERS,
 18846           DFHEIV11,
 18847           DFHEIV99
 18848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18849
 18850
 18851     GO TO 7500-STARTBR-TRLR.
 18852
 18853 7590-END.
 18854
 18855     IF WS-BROWSE-SW = 'Y'
 18856         MOVE 'N'                    TO  WS-BROWSE-SW
 18857
 18858* EXEC CICS ENDBR
 18859*            DATASET   ('ELTRLR')
 18860*        END-EXEC.
 18861     MOVE 'ELTRLR' TO DFHEIV1
 18862     MOVE 0
 18863       TO DFHEIV11
 18864*    MOVE '&2                    $   #00017068' TO DFHEIV0
 18865     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18866     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 18867     MOVE X'2020233030303137303638' TO DFHEIV0(25:11)
 18868     CALL 'kxdfhei1' USING DFHEIV0,
 18869           DFHEIV1,
 18870           DFHEIV11,
 18871           DFHEIV99
 18872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18873
 18874
 18875 7599-EXIT.
 18876     EXIT.
 18877
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 362
* EL156.cbl
 18879 7600-READ-ARCH-UPDATE.
 18880
 18881
 18882* EXEC CICS HANDLE CONDITION
 18883*        NOTFND   (7699-EXIT)
 18884*    END-EXEC.
 18885*    MOVE '"$I                   ! > #00017078' TO DFHEIV0
 18886     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18887     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18888     MOVE X'3E20233030303137303738' TO DFHEIV0(25:11)
 18889     CALL 'kxdfhei1' USING DFHEIV0
 18890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18891
 18892
 18893
 18894* EXEC CICS READ
 18895*        DATASET   ('ELARCH')
 18896*        RIDFLD    (ELARCH-KEY)
 18897*        SET       (ADDRESS OF LETTER-ARCHIVE)
 18898*        UPDATE
 18899*    END-EXEC.
 18900     MOVE 'ELARCH' TO DFHEIV1
 18901*    MOVE '&"S        EU         (   #00017082' TO DFHEIV0
 18902     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18903     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18904     MOVE X'2020233030303137303832' TO DFHEIV0(25:11)
 18905     CALL 'kxdfhei1' USING DFHEIV0,
 18906           DFHEIV1,
 18907           DFHEIV20,
 18908           DFHEIV99,
 18909           ELARCH-KEY,
 18910           DFHEIV99,
 18911           DFHEIV99,
 18912           DFHEIV99
 18913     SET ADDRESS OF LETTER-ARCHIVE TO
 18914         DFHEIV20
 18915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18916
 18917
 18918     MOVE LOW-VALUES                 TO  LA-RESEND-DATE.
 18919
 18920
 18921* EXEC CICS REWRITE
 18922*        DATASET   ('ELARCH')
 18923*        FROM      (LETTER-ARCHIVE)
 18924*    END-EXEC.
 18925     MOVE LENGTH OF
 18926      LETTER-ARCHIVE
 18927       TO DFHEIV11
 18928     MOVE 'ELARCH' TO DFHEIV1
 18929*    MOVE '&& L                  %   #00017091' TO DFHEIV0
 18930     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18931     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18932     MOVE X'2020233030303137303931' TO DFHEIV0(25:11)
 18933     CALL 'kxdfhei1' USING DFHEIV0,
 18934           DFHEIV1,
 18935           LETTER-ARCHIVE,
 18936           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 363
* EL156.cbl
 18937           DFHEIV99
 18938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18939
 18940
 18941 7699-EXIT.
 18942     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 364
* EL156.cbl
 18944 7700-GET-DCT.
 18945
 18946     MOVE PI-SV-CERT-KEY         TO W-NOTE-CERT-KEY.
 18947     MOVE PI-COMPANY-CD          TO W-NOTE-COMP-CD.
 18948     MOVE PI-SV-CERT-NO          TO W-NOTE-CERT-NO.
 18949     MOVE ZEROS                  TO PI-INTEREST-PAID-IND
 18950                                    PI-MAX-BENEFIT-AMT
 18951                                    PI-MAX-BENEFIT-PYMT
 18952                                    PI-MIN-PAYMENT-AMT
 18953                                    PI-TIME-OF-LOSS-BAL.
 18954
 18955
 18956* EXEC CICS HANDLE CONDITION
 18957*         NOTFND (5300-NOTE-NOT-FOUND)
 18958*     END-EXEC.
 18959*    MOVE '"$I                   ! ? #00017110' TO DFHEIV0
 18960     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18961     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18962     MOVE X'3F20233030303137313130' TO DFHEIV0(25:11)
 18963     CALL 'kxdfhei1' USING DFHEIV0
 18964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18965
 18966
 18967
 18968* EXEC CICS READ
 18969*         DATASET('ERNOTE')
 18970*         SET    (ADDRESS OF CERTIFICATE-NOTE)
 18971*         RIDFLD (W-NOTE-KEY)
 18972*     END-EXEC.
 18973     MOVE 'ERNOTE' TO DFHEIV1
 18974*    MOVE '&"S        E          (   #00017114' TO DFHEIV0
 18975     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18976     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18977     MOVE X'2020233030303137313134' TO DFHEIV0(25:11)
 18978     CALL 'kxdfhei1' USING DFHEIV0,
 18979           DFHEIV1,
 18980           DFHEIV20,
 18981           DFHEIV99,
 18982           W-NOTE-KEY,
 18983           DFHEIV99,
 18984           DFHEIV99,
 18985           DFHEIV99
 18986     SET ADDRESS OF CERTIFICATE-NOTE TO
 18987         DFHEIV20
 18988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18989
 18990
 18991     MOVE CN-CSI-CC-INTEREST-PAID TO PI-INTEREST-PAID-IND.
 18992     MOVE CN-CSI-CC-MAX-BEN-LIMIT TO PI-MAX-BENEFIT-AMT.
 18993     MOVE CN-CSI-CC-MAX-BENEFITS  TO PI-MAX-BENEFIT-PYMT.
 18994     MOVE CN-CSI-CC-MIN-PAY-AMT   TO PI-MIN-PAYMENT-AMT.
 18995     MOVE CN-CSI-CC-TOL-BALANCE   TO PI-TIME-OF-LOSS-BAL.
 18996
 18997     IF PI-PAYEE-TYPE NOT = 'B'
 18998         GO TO 7700-EXIT.
 18999
 19000     MOVE SPACES                 TO DCT-COMMUNICATION-AREA.
 19001     MOVE PI-SV-BEN              TO DCT-LOGIC-BENEFICIARY-ID.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 365
* EL156.cbl
 19002     MOVE PI-SV-CCN              TO DCT-CREDIT-CARD-NUMBER.
 19003
 19004     IF PI-SV-CERT-KEY (6:2) = ZERO OR SPACES
 19005         MOVE 'CC'                 TO DCT-PRODUCT-CODE
 19006     ELSE
 19007         MOVE PI-SV-CERT-KEY (6:2) TO DCT-PRODUCT-CODE.
 19008
 19009     MOVE CN-CSI-CC-BILL-BANK-ID TO DCT-BILLING-BANK-ID.
 19010     MOVE '01'                   TO DCT-COLUMN-ID-REQUESTED.
 19011     MOVE 'DLO006'               TO PGM-NAME.
 19012
 19013
 19014* EXEC CICS LINK
 19015*        PROGRAM    (PGM-NAME)
 19016*        COMMAREA   (DCT-COMMUNICATION-AREA)
 19017*        LENGTH     (DCT-RCRD-LENGTH)
 19018*    END-EXEC.
 19019*    MOVE '."C                   (   #00017142' TO DFHEIV0
 19020     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19021     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19022     MOVE X'2020233030303137313432' TO DFHEIV0(25:11)
 19023     CALL 'kxdfhei1' USING DFHEIV0,
 19024           PGM-NAME,
 19025           DCT-COMMUNICATION-AREA,
 19026           DCT-RCRD-LENGTH,
 19027           DFHEIV99,
 19028           DFHEIV99,
 19029           DFHEIV99,
 19030           DFHEIV99
 19031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19032
 19033
 19034     IF DCT-RETURN-CODE = 'OK'
 19035         GO TO 7700-CONT.
 19036
 19037     IF DCT-RETURN-CODE = '01' OR '02'
 19038         GO TO 7700-SET-TO-YES.
 19039
 19040     IF DCT-RETURN-CODE = '03'
 19041
 19042* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19043*    MOVE '6"R                   !   #00017155' TO DFHEIV0
 19044     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19045     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19046     MOVE X'2020233030303137313535' TO DFHEIV0(25:11)
 19047     CALL 'kxdfhei1' USING DFHEIV0
 19048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19049         MOVE ER-0951            TO EMI-ERROR
 19050         MOVE -1                 TO PMTTYPEL
 19051         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19052         GO TO 8200-SEND-DATAONLY.
 19053
 19054     IF DCT-RETURN-CODE = '04'
 19055
 19056* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19057*    MOVE '6"R                   !   #00017162' TO DFHEIV0
 19058     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19059     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 366
* EL156.cbl
 19060     MOVE X'2020233030303137313632' TO DFHEIV0(25:11)
 19061     CALL 'kxdfhei1' USING DFHEIV0
 19062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19063         MOVE ER-0946            TO EMI-ERROR
 19064         MOVE -1                 TO PMTTYPEL
 19065         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19066         GO TO 8200-SEND-DATAONLY.
 19067
 19068     IF DCT-RETURN-CODE = '05'
 19069
 19070* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19071*    MOVE '6"R                   !   #00017169' TO DFHEIV0
 19072     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19073     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19074     MOVE X'2020233030303137313639' TO DFHEIV0(25:11)
 19075     CALL 'kxdfhei1' USING DFHEIV0
 19076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19077         MOVE ER-0947            TO EMI-ERROR
 19078         MOVE -1                 TO PMTTYPEL
 19079         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19080         GO TO 8200-SEND-DATAONLY.
 19081
 19082     IF DCT-RETURN-CODE = '06'
 19083
 19084* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19085*    MOVE '6"R                   !   #00017176' TO DFHEIV0
 19086     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19087     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19088     MOVE X'2020233030303137313736' TO DFHEIV0(25:11)
 19089     CALL 'kxdfhei1' USING DFHEIV0
 19090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19091         MOVE ER-0921            TO EMI-ERROR
 19092         MOVE -1                 TO PMTTYPEL
 19093         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19094         GO TO 8200-SEND-DATAONLY.
 19095
 19096     IF DCT-RETURN-CODE = '07'
 19097
 19098* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19099*    MOVE '6"R                   !   #00017183' TO DFHEIV0
 19100     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19102     MOVE X'2020233030303137313833' TO DFHEIV0(25:11)
 19103     CALL 'kxdfhei1' USING DFHEIV0
 19104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19105         MOVE ER-0919            TO EMI-ERROR
 19106         MOVE -1                 TO PMTTYPEL
 19107         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19108         GO TO 8200-SEND-DATAONLY.
 19109
 19110     IF DCT-RETURN-CODE = '08'
 19111
 19112* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19113*    MOVE '6"R                   !   #00017190' TO DFHEIV0
 19114     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19115     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19116     MOVE X'2020233030303137313930' TO DFHEIV0(25:11)
 19117     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 367
* EL156.cbl
 19118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19119         MOVE ER-0948            TO EMI-ERROR
 19120         MOVE -1                 TO PMTTYPEL
 19121         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19122         GO TO 8200-SEND-DATAONLY.
 19123
 19124     IF DCT-RETURN-CODE = 'N1'
 19125
 19126* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19127*    MOVE '6"R                   !   #00017197' TO DFHEIV0
 19128     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19130     MOVE X'2020233030303137313937' TO DFHEIV0(25:11)
 19131     CALL 'kxdfhei1' USING DFHEIV0
 19132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19133         MOVE ER-0950            TO EMI-ERROR
 19134         MOVE -1                 TO PMTTYPEL
 19135         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19136         GO TO 8200-SEND-DATAONLY.
 19137
 19138     IF DCT-RETURN-CODE = 'E1'
 19139
 19140* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19141*    MOVE '6"R                   !   #00017204' TO DFHEIV0
 19142     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19143     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19144     MOVE X'2020233030303137323034' TO DFHEIV0(25:11)
 19145     CALL 'kxdfhei1' USING DFHEIV0
 19146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19147         MOVE ER-0974            TO EMI-ERROR
 19148         MOVE -1                 TO PMTTYPEL
 19149         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19150         GO TO 8200-SEND-DATAONLY.
 19151
 19152     IF DCT-RETURN-CODE = 'E2'
 19153
 19154* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19155*    MOVE '6"R                   !   #00017211' TO DFHEIV0
 19156     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19157     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19158     MOVE X'2020233030303137323131' TO DFHEIV0(25:11)
 19159     CALL 'kxdfhei1' USING DFHEIV0
 19160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19161         MOVE ER-0975            TO EMI-ERROR
 19162         MOVE -1                 TO PMTTYPEL
 19163         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19164         GO TO 8200-SEND-DATAONLY.
 19165
 19166     IF DCT-RETURN-CODE NOT = 'OK'
 19167
 19168* EXEC CICS SYNCPOINT ROLLBACK END-EXEC
 19169*    MOVE '6"R                   !   #00017218' TO DFHEIV0
 19170     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 19171     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19172     MOVE X'2020233030303137323138' TO DFHEIV0(25:11)
 19173     CALL 'kxdfhei1' USING DFHEIV0
 19174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19175         MOVE ER-0949            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 368
* EL156.cbl
 19176         MOVE -1                 TO PMTTYPEL
 19177         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19178         GO TO 8200-SEND-DATAONLY.
 19179
 19180 7700-CONT.
 19181
 19182*    MOVE 'N'                    TO CASHO.
 19183*    MOVE +1                     TO CASHL.
 19184*    MOVE AL-UANON               TO CASHA.
 19185
 19186     IF PI-OFFLINE = 'Y'
 19187         GO TO 7700-EXIT.
 19188
 19189     MOVE DCT-DISTRIBUTION-CODE  TO W-DMD-CHECK-NO-1.
 19190     MOVE CL-CERT-NO (4:1)       TO W-DMD-CHECK-NO-2.
 19191     MOVE 'TP'                   TO W-DMD-CHECK-NO-3.
 19192     MOVE W-DMD-CHECK-NO         TO CHECKNOO.
 19193     MOVE +7                     TO CHECKNOL.
 19194     MOVE AL-UANON               TO CHECKNOA.
 19195     GO TO 7700-EXIT.
 19196
 19197 7700-SET-TO-YES.
 19198
 19199*    MOVE 'Y'                    TO CASHO.
 19200*    MOVE +1                     TO CASHL.
 19201*    MOVE AL-UANON               TO CASHA.
 19202
 19203 7700-EXIT.
 19204     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 369
* EL156.cbl
 19206 7800-READ-COMP-MSTR.
 19207
 19208
 19209* EXEC CICS HANDLE CONDITION
 19210*        NOTFND   (7800-COMP-NOTFND)
 19211*    END-EXEC.
 19212*    MOVE '"$I                   ! @ #00017252' TO DFHEIV0
 19213     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19214     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19215     MOVE X'4020233030303137323532' TO DFHEIV0(25:11)
 19216     CALL 'kxdfhei1' USING DFHEIV0
 19217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19218
 19219
 19220
 19221* EXEC CICS READ
 19222*        DATASET   ('ERCOMP')
 19223*        RIDFLD    (ERCOMP-KEY)
 19224*        SET       (ADDRESS OF COMPENSATION-MASTER)
 19225*    END-EXEC.
 19226     MOVE 'ERCOMP' TO DFHEIV1
 19227*    MOVE '&"S        E          (   #00017256' TO DFHEIV0
 19228     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19229     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19230     MOVE X'2020233030303137323536' TO DFHEIV0(25:11)
 19231     CALL 'kxdfhei1' USING DFHEIV0,
 19232           DFHEIV1,
 19233           DFHEIV20,
 19234           DFHEIV99,
 19235           ERCOMP-KEY,
 19236           DFHEIV99,
 19237           DFHEIV99,
 19238           DFHEIV99
 19239     SET ADDRESS OF COMPENSATION-MASTER TO
 19240         DFHEIV20
 19241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19242
 19243
 19244     MOVE 'Y'                    TO  WS-COMP-MSTR-SW.
 19245     GO TO 7800-COMP-EXIT.
 19246
 19247 7800-COMP-NOTFND.
 19248     MOVE 'N'                    TO  WS-COMP-MSTR-SW.
 19249
 19250 7800-COMP-EXIT.
 19251     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 370
* EL156.cbl
 19253 7900-READ-CLAIM.
 19254
 19255* EXEC CICS READ
 19256*        DATASET  ('ELMSTR')
 19257*        SET      (ADDRESS OF CLAIM-MASTER)
 19258*        RIDFLD   (ELMSTR-KEY)
 19259*    END-EXEC.
 19260     MOVE 'ELMSTR' TO DFHEIV1
 19261*    MOVE '&"S        E          (   #00017272' TO DFHEIV0
 19262     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19263     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19264     MOVE X'2020233030303137323732' TO DFHEIV0(25:11)
 19265     CALL 'kxdfhei1' USING DFHEIV0,
 19266           DFHEIV1,
 19267           DFHEIV20,
 19268           DFHEIV99,
 19269           ELMSTR-KEY,
 19270           DFHEIV99,
 19271           DFHEIV99,
 19272           DFHEIV99
 19273     SET ADDRESS OF CLAIM-MASTER TO
 19274         DFHEIV20
 19275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19276
 19277
 19278 7900-EXIT.
 19279      EXIT.
 19280
 19281 7910-READ-CLAIM-UPDATE.
 19282
 19283* EXEC CICS READ
 19284*        DATASET  ('ELMSTR')
 19285*        SET      (ADDRESS OF CLAIM-MASTER)
 19286*        RIDFLD   (ELMSTR-KEY)
 19287*        UPDATE
 19288*    END-EXEC.
 19289     MOVE 'ELMSTR' TO DFHEIV1
 19290*    MOVE '&"S        EU         (   #00017282' TO DFHEIV0
 19291     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19292     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19293     MOVE X'2020233030303137323832' TO DFHEIV0(25:11)
 19294     CALL 'kxdfhei1' USING DFHEIV0,
 19295           DFHEIV1,
 19296           DFHEIV20,
 19297           DFHEIV99,
 19298           ELMSTR-KEY,
 19299           DFHEIV99,
 19300           DFHEIV99,
 19301           DFHEIV99
 19302     SET ADDRESS OF CLAIM-MASTER TO
 19303         DFHEIV20
 19304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19305
 19306
 19307 7910-EXIT.
 19308      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 371
* EL156.cbl
 19310 7920-READ-BENE.
 19311     MOVE PI-COMPANY-CD      TO BENE-COMP-CD.
 19312     MOVE 'B'                TO BENE-RECORD-TYPE.
 19313     MOVE CL-BENEFICIARY     TO BENE-NUMBER.
 19314
 19315     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19316        IF PI-PAYEE-TYPE    = 'B' AND
 19317           PI-PAYEE-SEQ-NUM = 9
 19318             MOVE CL-CURRENT-GROUPING TO WS-AIG-GROUPING
 19319             MOVE WS-A-BENE           TO BENE-NUMBER.
 19320
 19321
 19322* EXEC CICS HANDLE CONDITION
 19323*        NOTFND   (7920-NOT-FOUND)
 19324*    END-EXEC.
 19325*    MOVE '"$I                   ! A #00017303' TO DFHEIV0
 19326     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19327     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19328     MOVE X'4120233030303137333033' TO DFHEIV0(25:11)
 19329     CALL 'kxdfhei1' USING DFHEIV0
 19330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19331
 19332
 19333
 19334* EXEC CICS READ
 19335*        DATASET  ('ELBENE')
 19336*        SET      (ADDRESS OF BENEFICIARY-MASTER)
 19337*        RIDFLD   (ELBENE-KEY)
 19338*    END-EXEC.
 19339     MOVE 'ELBENE' TO DFHEIV1
 19340*    MOVE '&"S        E          (   #00017307' TO DFHEIV0
 19341     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19342     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19343     MOVE X'2020233030303137333037' TO DFHEIV0(25:11)
 19344     CALL 'kxdfhei1' USING DFHEIV0,
 19345           DFHEIV1,
 19346           DFHEIV20,
 19347           DFHEIV99,
 19348           ELBENE-KEY,
 19349           DFHEIV99,
 19350           DFHEIV99,
 19351           DFHEIV99
 19352     SET ADDRESS OF BENEFICIARY-MASTER TO
 19353         DFHEIV20
 19354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19355
 19356
 19357     MOVE 'Y' TO BENE-FOUND-SW.
 19358     GO TO 7920-EXIT.
 19359
 19360 7920-NOT-FOUND.
 19361     MOVE 'N'                    TO BENE-FOUND-SW.
 19362
 19363 7920-EXIT.
 19364      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 372
* EL156.cbl
 19366 7930-READ-CONTROL.
 19367
 19368* EXEC CICS READ
 19369*        DATASET  ('ELCNTL')
 19370*        SET      (ADDRESS OF CONTROL-FILE)
 19371*        RIDFLD   (ELCNTL-KEY)
 19372*    END-EXEC.
 19373     MOVE 'ELCNTL' TO DFHEIV1
 19374*    MOVE '&"S        E          (   #00017323' TO DFHEIV0
 19375     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19376     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19377     MOVE X'2020233030303137333233' TO DFHEIV0(25:11)
 19378     CALL 'kxdfhei1' USING DFHEIV0,
 19379           DFHEIV1,
 19380           DFHEIV20,
 19381           DFHEIV99,
 19382           ELCNTL-KEY,
 19383           DFHEIV99,
 19384           DFHEIV99,
 19385           DFHEIV99
 19386     SET ADDRESS OF CONTROL-FILE TO
 19387         DFHEIV20
 19388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19389
 19390
 19391 7930-EXIT.
 19392      EXIT.
 19393
 19394 7940-READ-CONTROL-UPDATE.
 19395
 19396* EXEC CICS READ
 19397*        DATASET  ('ELCNTL')
 19398*        SET      (ADDRESS OF CONTROL-FILE)
 19399*        RIDFLD   (ELCNTL-KEY)
 19400*        UPDATE
 19401*    END-EXEC.
 19402     MOVE 'ELCNTL' TO DFHEIV1
 19403*    MOVE '&"S        EU         (   #00017333' TO DFHEIV0
 19404     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19405     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19406     MOVE X'2020233030303137333333' TO DFHEIV0(25:11)
 19407     CALL 'kxdfhei1' USING DFHEIV0,
 19408           DFHEIV1,
 19409           DFHEIV20,
 19410           DFHEIV99,
 19411           ELCNTL-KEY,
 19412           DFHEIV99,
 19413           DFHEIV99,
 19414           DFHEIV99
 19415     SET ADDRESS OF CONTROL-FILE TO
 19416         DFHEIV20
 19417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19418
 19419
 19420 7940-EXIT.
 19421      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 373
* EL156.cbl
 19423 7950-READ-TRAILER.
 19424
 19425* EXEC CICS READ
 19426*        DATASET  ('ELTRLR')
 19427*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19428*        RIDFLD   (ELTRLR-KEY)
 19429*    END-EXEC.
 19430     MOVE 'ELTRLR' TO DFHEIV1
 19431*    MOVE '&"S        E          (   #00017344' TO DFHEIV0
 19432     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19433     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19434     MOVE X'2020233030303137333434' TO DFHEIV0(25:11)
 19435     CALL 'kxdfhei1' USING DFHEIV0,
 19436           DFHEIV1,
 19437           DFHEIV20,
 19438           DFHEIV99,
 19439           ELTRLR-KEY,
 19440           DFHEIV99,
 19441           DFHEIV99,
 19442           DFHEIV99
 19443     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19444         DFHEIV20
 19445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19446
 19447
 19448 7950-EXIT.
 19449      EXIT.
 19450
 19451 7960-READ-TRAILER-UPDATE.
 19452
 19453* EXEC CICS READ
 19454*        DATASET  ('ELTRLR')
 19455*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
 19456*        RIDFLD   (ELTRLR-KEY)
 19457*        UPDATE
 19458*    END-EXEC.
 19459     MOVE 'ELTRLR' TO DFHEIV1
 19460*    MOVE '&"S        EU         (   #00017354' TO DFHEIV0
 19461     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19462     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19463     MOVE X'2020233030303137333534' TO DFHEIV0(25:11)
 19464     CALL 'kxdfhei1' USING DFHEIV0,
 19465           DFHEIV1,
 19466           DFHEIV20,
 19467           DFHEIV99,
 19468           ELTRLR-KEY,
 19469           DFHEIV99,
 19470           DFHEIV99,
 19471           DFHEIV99
 19472     SET ADDRESS OF ACTIVITY-TRAILERS TO
 19473         DFHEIV20
 19474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19475
 19476
 19477 7960-EXIT.
 19478      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 374
* EL156.cbl
 19480 7970-READ-CERT.
 19481
 19482* EXEC CICS READ
 19483*        DATASET  ('ELCERT')
 19484*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19485*        RIDFLD   (ELCERT-KEY)
 19486*    END-EXEC.
 19487     MOVE 'ELCERT' TO DFHEIV1
 19488*    MOVE '&"S        E          (   #00017365' TO DFHEIV0
 19489     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19490     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19491     MOVE X'2020233030303137333635' TO DFHEIV0(25:11)
 19492     CALL 'kxdfhei1' USING DFHEIV0,
 19493           DFHEIV1,
 19494           DFHEIV20,
 19495           DFHEIV99,
 19496           ELCERT-KEY,
 19497           DFHEIV99,
 19498           DFHEIV99,
 19499           DFHEIV99
 19500     SET ADDRESS OF CERTIFICATE-MASTER TO
 19501         DFHEIV20
 19502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19503
 19504
 19505 7970-EXIT.
 19506      EXIT.
 19507 7975-read-acct.
 19508
 19509     move spaces              to WS-ACCT-RECORD-SW
 19510                                 pi-dcc-product-code
 19511
 19512     MOVE PI-COMPANY-CD       TO ACCT-COMP-CD
 19513     MOVE PI-CARRIER          TO ACCT-CARRIER
 19514     MOVE PI-GROUPING         TO ACCT-GROUPING
 19515     MOVE PI-STATE            TO ACCT-STATE
 19516     MOVE PI-ACCOUNT          TO ACCT-ACCOUNT
 19517     MOVE PI-CERT-EFF-DT      TO ACCT-EXP-DT
 19518     MOVE ERACCT-PARTIAL-KEY  TO WS-ERACCT-SAVE-KEY
 19519     MOVE SPACES              TO WS-ERACCT-HOLD-RECORD
 19520
 19521
 19522* EXEC CICS READ
 19523*       DATASET ('ERACCT')
 19524*       RIDFLD  (ERACCT-KEY)
 19525*       SET     (ADDRESS OF ACCOUNT-MASTER)
 19526*       GTEQ
 19527*       resp    (WS-RESPONSE)
 19528*    END-EXEC
 19529     MOVE 'ERACCT' TO DFHEIV1
 19530*    MOVE '&"S        G          (  N#00017387' TO DFHEIV0
 19531     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19532     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19533     MOVE X'204E233030303137333837' TO DFHEIV0(25:11)
 19534     CALL 'kxdfhei1' USING DFHEIV0,
 19535           DFHEIV1,
 19536           DFHEIV20,
 19537           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 375
* EL156.cbl
 19538           ERACCT-KEY,
 19539           DFHEIV99,
 19540           DFHEIV99,
 19541           DFHEIV99
 19542     SET ADDRESS OF ACCOUNT-MASTER TO
 19543         DFHEIV20
 19544     MOVE EIBRESP  TO WS-RESPONSE
 19545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19546     IF WS-RESP-NORMAL
 19547        AND WS-ERACCT-SAVE-KEY = AM-CONTROL-PRIMARY (1:20)
 19548        and pi-cert-eff-dt < am-expiration-dt
 19549        and pi-cert-eff-dt >= am-effective-dt
 19550        move am-dcc-product-code to pi-dcc-product-code
 19551        set acct-found to true
 19552     end-if
 19553
 19554     .
 19555 7975-exit.
 19556     exit.
 19557 7980-READ-CERT-UPDATE.
 19558
 19559* EXEC CICS READ
 19560*        DATASET  ('ELCERT')
 19561*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 19562*        RIDFLD   (ELCERT-KEY)
 19563*        UPDATE
 19564*    END-EXEC.
 19565     MOVE 'ELCERT' TO DFHEIV1
 19566*    MOVE '&"S        EU         (   #00017406' TO DFHEIV0
 19567     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 19568     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 19569     MOVE X'2020233030303137343036' TO DFHEIV0(25:11)
 19570     CALL 'kxdfhei1' USING DFHEIV0,
 19571           DFHEIV1,
 19572           DFHEIV20,
 19573           DFHEIV99,
 19574           ELCERT-KEY,
 19575           DFHEIV99,
 19576           DFHEIV99,
 19577           DFHEIV99
 19578     SET ADDRESS OF CERTIFICATE-MASTER TO
 19579         DFHEIV20
 19580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19581
 19582
 19583 7980-EXIT.
 19584      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 376
* EL156.cbl
 19586 8000-LOAD-ERROR-MESSAGES.
 19587     IF PI-PASS-SW = 'C'
 19588        MOVE EMI-LINE1           TO ERMSG1BO
 19589     ELSE
 19590        MOVE EMI-LINE1           TO ERRMSG1O
 19591        MOVE EMI-LINE2           TO ERRMSG2O.
 19592
 19593 8000-EXIT.
 19594     EXIT.
 19595
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 377
* EL156.cbl
 19597
 19598 8010-DMD-ERROR-CHECKS.
 19599     PERFORM 7700-GET-DCT THRU 7700-EXIT.
 19600
 19601     IF CN-CSI-CC-ISSUE-DT = SPACES OR LOW-VALUES OR ZEROS
 19602         GO TO 8051-ISSUE-ERROR.
 19603
 19604     MOVE CN-CSI-CC-ISSUE-DT     TO SAVE-DATE-CCYYMMDD.
 19605     MOVE SAVE-DATE-YMD          TO DC-GREG-DATE-1-YMD.
 19606     MOVE '3'                    TO DC-OPTION-CODE.
 19607     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
 19608     IF DC-BIN-DATE-1 > CL-INCURRED-DT
 19609         GO TO 8051-ISSUE-ERROR.
 19610
 19611     IF CL-CERT-NO (4:1) = 'U' OR 'F'
 19612       IF (CL-SOC-SEC-NO = SPACES OR LOW-VALUES OR ZEROS)
 19613                           OR
 19614          (CL-SSN-STATE   = CL-CERT-STATE  AND
 19615           CL-SSN-ACCOUNT = CL-CERT-ACCOUNT-PRIME)
 19616             MOVE ER-0851         TO EMI-ERROR
 19617             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19618       END-IF
 19619       IF CN-CSI-CC-PREMIUM-AMT = ZERO
 19620             MOVE ER-8147         TO EMI-ERROR
 19621             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19622
 19623     GO TO 8090-EXIT.
 19624
 19625 8051-ISSUE-ERROR.
 19626     MOVE ER-8146            TO EMI-ERROR.
 19627     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19628     GO TO 8090-EXIT.
 19629
 19630 8090-EXIT.
 19631      EXIT.
 19632
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 378
* EL156.cbl
 19634 8100-SEND-INITIAL-MAP.
 19635
 19636     MOVE SAVE-DATE              TO RUNDTEAO.
 19637     MOVE EIBTIME                TO TIME-IN.
 19638     MOVE TIME-OUT               TO RUNTIMAO.
 19639     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19640
 19641     IF MAP-NAME = 'EL156A'
 19642        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19643           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19644        END-IF
 19645        IF PI-COMPANY-ID = 'DCC'
 19646           MOVE 'N'     TO SURVYYNO
 19647        END-IF
 19648     END-IF
 19649*    IF MAP-NAME = 'EL156A'
 19650*       IF PI-COMPANY-ID = 'CRI'
 19651*          NEXT SENTENCE
 19652*       ELSE
 19653*          MOVE AL-SADOF TO  GROUPHA  GROUPEDA.
 19654
 19655     IF MAP-NAME = 'EL156A'
 19656        IF PI-COMPANY-ID = 'BOA' OR 'CID' OR 'AHL'
 19657           NEXT SENTENCE
 19658        ELSE
 19659           MOVE AL-SADOF TO  PINTA    PINTHA.
 19660
 19661     IF MAP-NAME = 'EL156A'
 19662        IF PI-COMPANY-ID = 'AIG' OR 'AUK'
 19663            NEXT SENTENCE
 19664        ELSE
 19665           MOVE AL-SADOF TO    DUEDAYHA DUEDAYA.
 19666
 19667*    IF MAP-NAME = 'EL156A'
 19668*       IF PI-COMPANY-ID = 'AIG' OR 'AUK' OR 'DMD'
 19669*          NEXT SENTENCE
 19670*       ELSE
 19671*          MOVE AL-SADOF TO CASHHA CASHA.
 19672
 19673     IF MAP-NAME = 'EL156A'
 19674        IF PI-COMPANY-ID = 'CVL' OR 'CID' OR 'DCC' OR 'AHL'
 19675           NEXT SENTENCE
 19676        ELSE
 19677           MOVE AL-SADOF        TO  LOANHA
 19678                                    LOANNOA.
 19679
 19680     IF MAP-NAME = 'EL156A'
 19681        MOVE -1                 TO  ENTERPFL
 19682        IF PI-USES-PAID-TO
 19683           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19684           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19685           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19686        ELSE
 19687           NEXT SENTENCE
 19688     ELSE
 19689        IF MAP-NAME = 'EL156B'
 19690           IF PI-USES-PAID-TO
 19691              MOVE ' PAYS TO    ' TO HDGB-VRBLE
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 379
* EL156.cbl
 19692              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19693
 19694
 19695* EXEC CICS SEND
 19696*        MAP   (MAP-NAME)
 19697*        MAPSET(MAPSET-NAME)
 19698*        FROM  (EL156AI)
 19699*        ERASE
 19700*        CURSOR
 19701*    END-EXEC.
 19702     MOVE LENGTH OF
 19703      EL156AI
 19704       TO DFHEIV12
 19705     MOVE -1
 19706       TO DFHEIV11
 19707*    MOVE '8$     CT  E    H L F ,   #00017524' TO DFHEIV0
 19708     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 19709     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19710     MOVE X'2020233030303137353234' TO DFHEIV0(25:11)
 19711     CALL 'kxdfhei1' USING DFHEIV0,
 19712           MAP-NAME,
 19713           EL156AI,
 19714           DFHEIV12,
 19715           MAPSET-NAME,
 19716           DFHEIV99,
 19717           DFHEIV99,
 19718           DFHEIV99,
 19719           DFHEIV11,
 19720           DFHEIV99,
 19721           DFHEIV99,
 19722           DFHEIV99
 19723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19724
 19725
 19726     GO TO 9100-RETURN-TRAN.
 19727
 19728 8200-SEND-DATAONLY.
 19729
 19730     IF FIRST-ENTRY = 'Y'
 19731         GO TO 8100-SEND-INITIAL-MAP.
 19732
 19733     IF RETURNED-FROM-B = 'Y'
 19734         GO TO 8100-SEND-INITIAL-MAP.
 19735
 19736     MOVE SAVE-DATE              TO RUNDTEAO.
 19737     MOVE EIBTIME                TO TIME-IN.
 19738     MOVE TIME-OUT               TO RUNTIMAO.
 19739
 19740     IF EIBAID = DFHPF11
 19741        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 19742        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19743        MOVE 'EL001   '          TO RETURNED-FROM
 19744        PERFORM 3050-REBUILD-ENTERED THRU 3059-EXIT
 19745        PERFORM 7010-BUILD-MAP THRU 7020-BYPASS-BENEFIT
 19746        GO TO 8100-SEND-INITIAL-MAP.
 19747
 19748     PERFORM 8000-LOAD-ERROR-MESSAGES THRU 8000-EXIT.
 19749
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 380
* EL156.cbl
 19750     IF MAP-NAME =  'EL156A'
 19751        MOVE -1                 TO  ENTERPFL
 19752        IF PI-USES-PAID-TO
 19753           MOVE 'PAID TO DATE :' TO PTHRHDGO
 19754           MOVE '  PAY TO  '    TO  HDGA-VRBLE
 19755           MOVE PMT-HEAD-A      TO  PMTHDGAO
 19756        ELSE
 19757           NEXT SENTENCE
 19758     ELSE
 19759        IF MAP-NAME = 'EL156B'
 19760           IF PI-USES-PAID-TO
 19761              MOVE ' PAYS TO    ' TO HDGB-VRBLE
 19762              MOVE PMT-HEAD-B     TO PMTHDGBO.
 19763
 19764     IF MAP-NAME =  'EL156A'
 19765        IF PI-COMPANY-ID = 'BOA'
 19766            IF PI-INT-RATE NUMERIC
 19767                MOVE PI-INT-RATE TO PINTO.
 19768     IF MAP-NAME = 'EL156A'
 19769        IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL'
 19770           MOVE 'PF6=EOB CODES'  TO PF6TITO
 19771*          MOVE 'Y'              TO EOBYNO
 19772        END-IF
 19773     END-IF
 19774
 19775
 19776* EXEC CICS SEND
 19777*        MAP   (MAP-NAME)
 19778*        MAPSET(MAPSET-NAME)
 19779*        FROM  (EL156AI)
 19780*        DATAONLY
 19781*        CURSOR
 19782*    END-EXEC.
 19783     MOVE LENGTH OF
 19784      EL156AI
 19785       TO DFHEIV12
 19786     MOVE -1
 19787       TO DFHEIV11
 19788*    MOVE '8$D    CT       H L F ,   #00017581' TO DFHEIV0
 19789     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 19790     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 19791     MOVE X'2020233030303137353831' TO DFHEIV0(25:11)
 19792     CALL 'kxdfhei1' USING DFHEIV0,
 19793           MAP-NAME,
 19794           EL156AI,
 19795           DFHEIV12,
 19796           MAPSET-NAME,
 19797           DFHEIV99,
 19798           DFHEIV99,
 19799           DFHEIV99,
 19800           DFHEIV11,
 19801           DFHEIV99,
 19802           DFHEIV99,
 19803           DFHEIV99
 19804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19805
 19806
 19807     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 381
* EL156.cbl
 19808
 19809 8300-SEND-TEXT.
 19810
 19811* EXEC CICS SEND TEXT
 19812*        FROM(LOGOFF-TEXT)
 19813*        LENGTH(LOGOFF-LENGTH)
 19814*        ERASE
 19815*        FREEKB
 19816*    END-EXEC.
 19817*    MOVE '8&      T  E F  H   F -   #00017592' TO DFHEIV0
 19818     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 19819     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 19820     MOVE X'2020233030303137353932' TO DFHEIV0(25:11)
 19821     CALL 'kxdfhei1' USING DFHEIV0,
 19822           LOGOFF-TEXT,
 19823           LOGOFF-LENGTH,
 19824           DFHEIV99,
 19825           DFHEIV99,
 19826           DFHEIV99,
 19827           DFHEIV99,
 19828           DFHEIV99,
 19829           DFHEIV99,
 19830           DFHEIV99,
 19831           DFHEIV99,
 19832           DFHEIV99,
 19833           DFHEIV99
 19834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19835
 19836
 19837
 19838* EXEC CICS RETURN
 19839*    END-EXEC.
 19840*    MOVE '.(                    ''   #00017599' TO DFHEIV0
 19841     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 19842     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19843     MOVE X'2020233030303137353939' TO DFHEIV0(25:11)
 19844     CALL 'kxdfhei1' USING DFHEIV0,
 19845           DFHEIV99,
 19846           DFHEIV99,
 19847           DFHEIV99,
 19848           DFHEIV99,
 19849           DFHEIV99,
 19850           DFHEIV99
 19851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19852
 19853
 19854 8500-FILE-NOTOPEN.
 19855     IF FILE-SWITCH = 'MSTR'
 19856         MOVE ER-0154            TO EMI-ERROR.
 19857     IF FILE-SWITCH = 'TRLR'
 19858         MOVE ER-0172            TO EMI-ERROR.
 19859     IF FILE-SWITCH = 'CERT'
 19860         MOVE ER-0169            TO EMI-ERROR.
 19861     IF FILE-SWITCH = 'CNTL' OR 'CARR' OR 'BENE' OR
 19862                      'PROC' OR 'STAT'
 19863         MOVE ER-0042            TO EMI-ERROR.
 19864     IF FILE-SWITCH = 'ACTQ'
 19865         MOVE ER-0338            TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 382
* EL156.cbl
 19866     IF FILE-SWITCH = 'ACCT'
 19867         MOVE ER-0168            TO EMI-ERROR.
 19868
 19869     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19870     MOVE -1                     TO PMTTYPEL.
 19871
 19872     IF FIRST-ENTRY = 'Y'
 19873         GO TO 8100-SEND-INITIAL-MAP.
 19874
 19875     GO TO 8200-SEND-DATAONLY.
 19876
 19877 8600-PGRM-NOT-FOUND.
 19878
 19879     MOVE ER-0923                TO EMI-ERROR.
 19880     MOVE -1                     TO ENTPFBL.
 19881     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19882
 19883     IF FIRST-ENTRY = 'Y'
 19884         GO TO 8100-SEND-INITIAL-MAP
 19885     ELSE
 19886         GO TO 8200-SEND-DATAONLY.
 19887
 19888 8800-UNAUTHORIZED-ACCESS.
 19889     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 19890     GO TO 8300-SEND-TEXT.
 19891
 19892 8810-PF23.
 19893     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 19894     MOVE XCTL-005               TO PGM-NAME.
 19895     GO TO 9300-XCTL.
 19896
 19897 8820-PF7-8.
 19898     MOVE XCTL-126               TO PI-CALLING-PROGRAM.
 19899     MOVE SPACES                 TO PI-SAVED-PROGRAM-1
 19900                                    PI-SAVED-PROGRAM-2
 19901                                    PI-SAVED-PROGRAM-3
 19902                                    PI-SAVED-PROGRAM-4
 19903                                    PI-SAVED-PROGRAM-5
 19904                                    PI-SAVED-PROGRAM-6
 19905                                    PI-RETURN-TO-PROGRAM.
 19906     IF EIBAID = DFHPF8
 19907        MOVE XCTL-132            TO PGM-NAME
 19908     ELSE
 19909        MOVE XCTL-130            TO PGM-NAME.
 19910
 19911     GO TO 9300-XCTL.
 19912
 19913 9100-RETURN-TRAN.
 19914     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 19915     MOVE '156A'                 TO PI-CURRENT-SCREEN-NO.
 19916
 19917
 19918* EXEC CICS RETURN
 19919*        TRANSID(TRANS-ID)
 19920*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19921*        LENGTH(PI-COMM-LENGTH)
 19922*    END-EXEC.
 19923*    MOVE '.(CT                  ''   #00017665' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 383
* EL156.cbl
 19924     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 19925     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 19926     MOVE X'2020233030303137363635' TO DFHEIV0(25:11)
 19927     CALL 'kxdfhei1' USING DFHEIV0,
 19928           TRANS-ID,
 19929           PROGRAM-INTERFACE-BLOCK,
 19930           PI-COMM-LENGTH,
 19931           DFHEIV99,
 19932           DFHEIV99,
 19933           DFHEIV99
 19934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19935
 19936
 19937 9200-RETURN-MAIN-MENU.
 19938     MOVE XCTL-126               TO PGM-NAME.
 19939     GO TO 9300-XCTL.
 19940
 19941 9300-XCTL.
 19942
 19943* EXEC CICS XCTL
 19944*        PROGRAM(PGM-NAME)
 19945*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
 19946*        LENGTH(PI-COMM-LENGTH)
 19947*    END-EXEC.
 19948*    MOVE '.$C                   %   #00017676' TO DFHEIV0
 19949     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 19950     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 19951     MOVE X'2020233030303137363736' TO DFHEIV0(25:11)
 19952     CALL 'kxdfhei1' USING DFHEIV0,
 19953           PGM-NAME,
 19954           PROGRAM-INTERFACE-BLOCK,
 19955           PI-COMM-LENGTH,
 19956           DFHEIV99
 19957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19958
 19959
 19960 9400-CLEAR.
 19961     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 19962     GO TO 9300-XCTL.
 19963
 19964 9500-PF12.
 19965     MOVE XCTL-010               TO PGM-NAME.
 19966     GO TO 9300-XCTL.
 19967
 19968 9700-LINK-DATE-CONVERT.
 19969     MOVE LINK-ELDATCV           TO PGM-NAME.
 19970
 19971* EXEC CICS LINK
 19972*        PROGRAM   (PGM-NAME)
 19973*        COMMAREA  (DATE-CONVERSION-DATA)
 19974*        LENGTH    (DC-COMM-LENGTH)
 19975*    END-EXEC.
 19976*    MOVE '."C                   (   #00017692' TO DFHEIV0
 19977     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 19978     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19979     MOVE X'2020233030303137363932' TO DFHEIV0(25:11)
 19980     CALL 'kxdfhei1' USING DFHEIV0,
 19981           PGM-NAME,
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 384
* EL156.cbl
 19982           DATE-CONVERSION-DATA,
 19983           DC-COMM-LENGTH,
 19984           DFHEIV99,
 19985           DFHEIV99,
 19986           DFHEIV99,
 19987           DFHEIV99
 19988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19989
 19990
 19991 9700-EXIT.
 19992     EXIT.
 19993
 19994 9800-LINK-REM-TERM.
 19995     MOVE LINK-REMTERM TO PGM-NAME.
 19996
 19997
 19998* EXEC CICS LINK
 19999*        PROGRAM   (PGM-NAME)
 20000*        COMMAREA  (CALCULATION-PASS-AREA)
 20001*        LENGTH    (CP-COMM-LENGTH)
 20002*    END-EXEC.
 20003*    MOVE '."C                   (   #00017704' TO DFHEIV0
 20004     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20005     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20006     MOVE X'2020233030303137373034' TO DFHEIV0(25:11)
 20007     CALL 'kxdfhei1' USING DFHEIV0,
 20008           PGM-NAME,
 20009           CALCULATION-PASS-AREA,
 20010           CP-COMM-LENGTH,
 20011           DFHEIV99,
 20012           DFHEIV99,
 20013           DFHEIV99,
 20014           DFHEIV99
 20015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20016
 20017
 20018 9800-EXIT.
 20019     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 385
* EL156.cbl
 20021 9830-DMD-REMAINING-TERM.
 20022
 20023     DIVIDE CL-NO-OF-DAYS-PAID BY +30
 20024         GIVING W-PAID-MONTHS REMAINDER W-PAID-DAYS.
 20025
 20026     COMPUTE W-TERM-IN-DAYS = CM-AH-ORIG-TERM * 30 +
 20027                              CM-PMT-EXTENSION-DAYS.
 20028
 20029     COMPUTE W-REM-TERM-IN-DAYS = W-TERM-IN-DAYS -
 20030                                  CL-NO-OF-DAYS-PAID.
 20031
 20032     DIVIDE W-REM-TERM-IN-DAYS BY +30
 20033         GIVING W-REM REMAINDER W-REM-DAYS.
 20034
 20035     MOVE W-REM                  TO WST-REM.
 20036
 20037     IF W-REM-DAYS > ZEROS
 20038         MOVE '/'                TO WST-SLASH
 20039         MOVE W-REM-DAYS         TO WST-REM-DAYS
 20040     ELSE
 20041         MOVE SPACES             TO WST-REM-DAYS-GRP.
 20042
 20043 9830-EXIT.
 20044     EXIT.
 20045
 20046 9870-OUTPUT-ACTIVITY-RECORD.
 20047
 20048
 20049* EXEC CICS GETMAIN
 20050*         SET(ADDRESS OF DAILY-ACTIVITY-RECORD)
 20051*         LENGTH(25)
 20052*         INITIMG(WS-BLANK)
 20053*    END-EXEC.
 20054     MOVE 25
 20055       TO DFHEIV11
 20056*    MOVE ',"IL                  $   #00017740' TO DFHEIV0
 20057     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 20058     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 20059     MOVE X'2020233030303137373430' TO DFHEIV0(25:11)
 20060     CALL 'kxdfhei1' USING DFHEIV0,
 20061           DFHEIV20,
 20062           DFHEIV11,
 20063           WS-BLANK
 20064     SET ADDRESS OF DAILY-ACTIVITY-RECORD TO
 20065         DFHEIV20
 20066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20067
 20068
 20069     MOVE SPACES                 TO DAILY-ACTIVITY-RECORD.
 20070     MOVE ELMSTR-KEY             TO DA-KEY.
 20071     MOVE CL-TRAILER-SEQ-CNT     TO DA-TRAILER-SEQ-NO.
 20072
 20073     IF PI-PMTTYPE EQUAL '7'
 20074         MOVE 'V'                TO DA-RECORD-TYPE
 20075     ELSE
 20076         MOVE 'P'                TO DA-RECORD-TYPE.
 20077
 20078
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 386
* EL156.cbl
 20079* EXEC CICS HANDLE CONDITION
 20080*         NOTOPEN(9870-NOTOPEN)
 20081*         DUPREC(9870-EXIT)
 20082*    END-EXEC.
 20083*    MOVE '"$J%                  ! B #00017755' TO DFHEIV0
 20084     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
 20085     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20086     MOVE X'4220233030303137373535' TO DFHEIV0(25:11)
 20087     CALL 'kxdfhei1' USING DFHEIV0
 20088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20089
 20090
 20091
 20092* EXEC CICS WRITE
 20093*         DATASET('DLYACTV')
 20094*         RIDFLD(DA-KEY)
 20095*         FROM(DAILY-ACTIVITY-RECORD)
 20096*         LENGTH(25)
 20097*    END-EXEC.
 20098     MOVE 'DLYACTV' TO DFHEIV1
 20099     MOVE 25
 20100       TO DFHEIV11
 20101*    MOVE '&$ L                  ''   #00017760' TO DFHEIV0
 20102     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 20103     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 20104     MOVE X'2020233030303137373630' TO DFHEIV0(25:11)
 20105     CALL 'kxdfhei1' USING DFHEIV0,
 20106           DFHEIV1,
 20107           DAILY-ACTIVITY-RECORD,
 20108           DFHEIV11,
 20109           DA-KEY,
 20110           DFHEIV99,
 20111           DFHEIV99
 20112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20113
 20114     MOVE 'N'                    TO ERROR-ON-OUTPUT-SW.
 20115     GO TO 9870-EXIT.
 20116
 20117 9870-NOTOPEN.
 20118
 20119     MOVE '2955'                 TO EMI-ERROR.
 20120     MOVE 'Y'                    TO ERROR-ON-OUTPUT-SW.
 20121
 20122 9870-EXIT.
 20123     EXIT.
 20124
 20125 9900-ERROR-FORMAT.
 20126
 20127     IF EMI-ERROR = ER-0923
 20128         MOVE PGM-NAME           TO W-CALLED-NAME.
 20129
 20130     MOVE LINK-001      TO PGM-NAME.
 20131     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 20132
 20133
 20134* EXEC CICS LINK
 20135*        PROGRAM (PGM-NAME)
 20136*        COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 387
* EL156.cbl
 20137*        LENGTH  (EMI-COMM-LENGTH)
 20138*    END-EXEC.
 20139*    MOVE '."C                   (   #00017785' TO DFHEIV0
 20140     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20141     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20142     MOVE X'2020233030303137373835' TO DFHEIV0(25:11)
 20143     CALL 'kxdfhei1' USING DFHEIV0,
 20144           PGM-NAME,
 20145           ERROR-MESSAGE-INTERFACE-BLOCK,
 20146           EMI-COMM-LENGTH,
 20147           DFHEIV99,
 20148           DFHEIV99,
 20149           DFHEIV99,
 20150           DFHEIV99
 20151     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20152
 20153
 20154     IF EMI-ERROR = ER-0923
 20155         MOVE W-CALLED-NAME      TO EMI-TEXT-VARIABLE (1).
 20156
 20157 9900-EXIT.
 20158     EXIT.
 20159
 20160 9990-ABEND.
 20161     MOVE LINK-004               TO PGM-NAME.
 20162     MOVE DFHEIBLK               TO EMI-LINE1.
 20163
 20164* EXEC CICS LINK
 20165*        PROGRAM   (PGM-NAME)
 20166*        COMMAREA  (EMI-LINE1)
 20167*        LENGTH    (64)
 20168*    END-EXEC.
 20169     MOVE 64
 20170       TO DFHEIV11
 20171*    MOVE '."C                   (   #00017800' TO DFHEIV0
 20172     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20173     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20174     MOVE X'2020233030303137383030' TO DFHEIV0(25:11)
 20175     CALL 'kxdfhei1' USING DFHEIV0,
 20176           PGM-NAME,
 20177           EMI-LINE1,
 20178           DFHEIV11,
 20179           DFHEIV99,
 20180           DFHEIV99,
 20181           DFHEIV99,
 20182           DFHEIV99
 20183     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20184
 20185
 20186     MOVE 'EL156A'               TO  MAP-NAME.
 20187     MOVE LOW-VALUES             TO  EL156AO.
 20188     GO TO 8100-SEND-INITIAL-MAP.
 20189
 20190 9995-SECURITY-VIOLATION.
 20191*    COPY ELCSCTP.
 20192******************************************************************
 20193*                                                                *
 20194*                            ELCSCTP                             *
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 388
* EL156.cbl
 20195*                            VMOD=2.001                          *
 20196*                                                                *
 20197*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 20198******************************************************************
 20199
 20200
 20201     MOVE EIBDATE          TO SM-JUL-DATE.
 20202     MOVE EIBTRMID         TO SM-TERMID.
 20203     MOVE THIS-PGM         TO SM-PGM.
 20204     MOVE EIBTIME          TO TIME-IN.
 20205     MOVE TIME-OUT         TO SM-TIME.
 20206     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 20207
 20208
 20209* EXEC CICS LINK
 20210*         PROGRAM  ('EL003')
 20211*         COMMAREA (SECURITY-MESSAGE)
 20212*         LENGTH   (80)
 20213*    END-EXEC.
 20214     MOVE 'EL003' TO DFHEIV1
 20215     MOVE 80
 20216       TO DFHEIV11
 20217*    MOVE '."C                   (   #00017828' TO DFHEIV0
 20218     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 20219     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20220     MOVE X'2020233030303137383238' TO DFHEIV0(25:11)
 20221     CALL 'kxdfhei1' USING DFHEIV0,
 20222           DFHEIV1,
 20223           SECURITY-MESSAGE,
 20224           DFHEIV11,
 20225           DFHEIV99,
 20226           DFHEIV99,
 20227           DFHEIV99,
 20228           DFHEIV99
 20229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20230
 20231
 20232******************************************************************
 20233
 20234
 20235
 20236 9999-DFHBACK SECTION.
 20237     MOVE '9%                    "   ' TO DFHEIV0
 20238     MOVE 'EL156' TO DFHEIV1
 20239     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20240     GOBACK.
 20241 9999-DFHEXIT.
 20242     IF DFHEIGDJ EQUAL 0001
 20243         NEXT SENTENCE
 20244     ELSE IF DFHEIGDJ EQUAL 2
 20245         GO TO 9990-ABEND,
 20246               8600-PGRM-NOT-FOUND,
 20247               0400-FIRST-TIME,
 20248               6180-DUPREC,
 20249               9990-ABEND
 20250         DEPENDING ON DFHEIGDI
 20251     ELSE IF DFHEIGDJ EQUAL 3
 20252         GO TO 0380-CLAIM-END-FILE,
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 389
* EL156.cbl
 20253               0380-CLAIM-END-FILE
 20254         DEPENDING ON DFHEIGDI
 20255     ELSE IF DFHEIGDJ EQUAL 4
 20256         GO TO 0380-CLAIM-END-FILE,
 20257               0380-CLAIM-END-FILE
 20258         DEPENDING ON DFHEIGDI
 20259     ELSE IF DFHEIGDJ EQUAL 5
 20260         GO TO 0800-EXIT
 20261         DEPENDING ON DFHEIGDI
 20262     ELSE IF DFHEIGDJ EQUAL 6
 20263         GO TO 1950-NOT-FOUND,
 20264               1950-NOT-FOUND
 20265         DEPENDING ON DFHEIGDI
 20266     ELSE IF DFHEIGDJ EQUAL 7
 20267         GO TO 1950-NOT-FOUND
 20268         DEPENDING ON DFHEIGDI
 20269     ELSE IF DFHEIGDJ EQUAL 8
 20270         GO TO 1950-NOT-FOUND,
 20271               1950-NOT-FOUND
 20272         DEPENDING ON DFHEIGDI
 20273     ELSE IF DFHEIGDJ EQUAL 9
 20274         GO TO 1166-END-CHECK,
 20275               1166-END-CHECK
 20276         DEPENDING ON DFHEIGDI
 20277     ELSE IF DFHEIGDJ EQUAL 10
 20278         GO TO 1950-NOT-FOUND,
 20279               1950-NOT-FOUND
 20280         DEPENDING ON DFHEIGDI
 20281     ELSE IF DFHEIGDJ EQUAL 11
 20282         GO TO 1950-NOT-FOUND,
 20283               1950-NOT-FOUND
 20284         DEPENDING ON DFHEIGDI
 20285     ELSE IF DFHEIGDJ EQUAL 12
 20286         GO TO 1950-NOT-FOUND
 20287         DEPENDING ON DFHEIGDI
 20288     ELSE IF DFHEIGDJ EQUAL 13
 20289         GO TO 3600-CONTINUE
 20290         DEPENDING ON DFHEIGDI
 20291     ELSE IF DFHEIGDJ EQUAL 14
 20292         GO TO 5300-NOTE-NOT-FOUND
 20293         DEPENDING ON DFHEIGDI
 20294     ELSE IF DFHEIGDJ EQUAL 15
 20295         GO TO 6065-NOT-FOUND
 20296         DEPENDING ON DFHEIGDI
 20297     ELSE IF DFHEIGDJ EQUAL 16
 20298         GO TO 6068-ACCT-NOT-FND
 20299         DEPENDING ON DFHEIGDI
 20300     ELSE IF DFHEIGDJ EQUAL 17
 20301         GO TO 6074-GET-COMP-DATA
 20302         DEPENDING ON DFHEIGDI
 20303     ELSE IF DFHEIGDJ EQUAL 18
 20304         GO TO 6170-WRITE
 20305         DEPENDING ON DFHEIGDI
 20306     ELSE IF DFHEIGDJ EQUAL 19
 20307         GO TO 6180-DUPREC
 20308         DEPENDING ON DFHEIGDI
 20309     ELSE IF DFHEIGDJ EQUAL 20
 20310         GO TO 6190-DUPREC
* Micro Focus Server Express         V5.1 revision 000 06-Nov-15 10:33 Page 390
* EL156.cbl
 20311         DEPENDING ON DFHEIGDI
 20312     ELSE IF DFHEIGDJ EQUAL 21
 20313         GO TO 6185-DUPREC
 20314         DEPENDING ON DFHEIGDI
 20315     ELSE IF DFHEIGDJ EQUAL 22
 20316         GO TO 6720-BUILD-NEW-RECORD
 20317         DEPENDING ON DFHEIGDI
 20318     ELSE IF DFHEIGDJ EQUAL 23
 20319         GO TO 6900-BUILD-ARCHIVE-HEADER,
 20320               6900-BUILD-ARCHIVE-HEADER
 20321         DEPENDING ON DFHEIGDI
 20322     ELSE IF DFHEIGDJ EQUAL 24
 20323         GO TO 7010-BUILD-MAP
 20324         DEPENDING ON DFHEIGDI
 20325     ELSE IF DFHEIGDJ EQUAL 25
 20326         GO TO 7100-SHOW-RECORD-NOT-FOUND
 20327         DEPENDING ON DFHEIGDI
 20328     ELSE IF DFHEIGDJ EQUAL 26
 20329         GO TO 7160-DUPREC
 20330         DEPENDING ON DFHEIGDI
 20331     ELSE IF DFHEIGDJ EQUAL 27
 20332         GO TO 7200-EXIT,
 20333               7200-EXIT
 20334         DEPENDING ON DFHEIGDI
 20335     ELSE IF DFHEIGDJ EQUAL 28
 20336         GO TO 7400-NOT-FOUND
 20337         DEPENDING ON DFHEIGDI
 20338     ELSE IF DFHEIGDJ EQUAL 29
 20339         GO TO 7590-END,
 20340               7590-END
 20341         DEPENDING ON DFHEIGDI
 20342     ELSE IF DFHEIGDJ EQUAL 30
 20343         GO TO 7699-EXIT
 20344         DEPENDING ON DFHEIGDI
 20345     ELSE IF DFHEIGDJ EQUAL 31
 20346         GO TO 5300-NOTE-NOT-FOUND
 20347         DEPENDING ON DFHEIGDI
 20348     ELSE IF DFHEIGDJ EQUAL 32
 20349         GO TO 7800-COMP-NOTFND
 20350         DEPENDING ON DFHEIGDI
 20351     ELSE IF DFHEIGDJ EQUAL 33
 20352         GO TO 7920-NOT-FOUND
 20353         DEPENDING ON DFHEIGDI
 20354     ELSE IF DFHEIGDJ EQUAL 34
 20355         GO TO 9870-NOTOPEN,
 20356               9870-EXIT
 20357         DEPENDING ON DFHEIGDI.
 20358     MOVE '9%                    "   ' TO DFHEIV0
 20359     MOVE 'EL156' TO DFHEIV1
 20360     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 20361     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       12188     Code:       75467
