* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   1
* EL6311.cbl
* Options: int("EL6311.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6311.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6311.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6311.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6311.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:50:32.
     7*                            VMOD=2.089.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   2
* EL6311.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        TRANSACTION - EXB1 - NEW BUSINESS, REVIEW AND CORRECTION
    26*                             ISSUES, CANCELS, AND BATCH HEADERS
    27******************************************************************
    28*                   C H A N G E   L O G
    29*
    30* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    31*-----------------------------------------------------------------
    32*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    33* EFFECTIVE    NUMBER
    34*-----------------------------------------------------------------
    35* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    36* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    37* 011904                   PEMA  ADD TOTAL FEE PROCESSING
    38* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    39* 081606  CR2006051800002  PEMA  ADD POST CARD PROCESSING
    40* 101706  CR2006080800002  PEMA  ADD VIN NUMBER
    41* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
    42* 090607  CR2007010300001  PEMA  ADD CO TYPE TO OVERCHARGE
    43* 030708  CR2007092500001  PEMA  ADD VA DISCLOSURE PROCESSING
    44* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
    45* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    46* 102408  CR2008080500002  PEMA  ADD BILLING NOTE FOR EC OF P
    47* 072009  IR2009062300002  AJRA  RESET CALC FLAG ON CHANGE
    48* 072209  CR2008101500003  AJRA  PRINT BORROWER FIRST NAME
    49* 111109  CR2008100900003  AJRA  CHANGE PF8 TO NEW CERT NOTE SCRN
    50* 032210  IR2010022400001  PEMA  CORRECT PF5 LOGIC, ADD APR PROC
    51* 101110  CR2010091000002  PEMA  ENHANCE PREMIUM EDIT
    52* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    53* 100111  CR2011022800001  AJRA  NAPERSOFT VA DISC
    54* 010412  CR2011022800001  AJRA  NAPERSOFT
    55* 032612  CR2011110200001  PEMA  AHL CHANGES
    56* 062712  CR2011022800001  AJRA  REDEFINE ORIG DATA
    57* 072312  CR2011022800001  AJRA  NAPERSOFT MISC
    58* 091112  IR2012091100002  AJRA  FIX AKA
    59* 091312  IR2012091100004  AJRA  FIX ADDRESS CHECK
    60* 091712  IR2012091400003  AJRA  CHANGE PF6 TO GO TO CANCEL TRANS
    61* 100412  IR2012100300002  AJRA  FIX VA DISC FOR DISAB ONLY CERT
    62* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
    63* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    64* 080713  CR2012032000002  AJRA  HIGHLIGHT AGE ERRORS
    65* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
    66* 102813  IR2013102100001  PEMA  CORRECT CANCEL VOID STATUS
    67* 111913  CR2008042200001  PEMA  ADDITIONAL 0 % APR CHANGES
    68* 100213  CR2013090300001  AJRA  NAPERSOFT PHASE 2
    69* 111513  CR2013053000001  PEMA  DAILY CHECK REQUEST CHANGES
    70* 120513  CR2013090300001  AJRA  CHG ALL NINES IN PREM PROCESS
    71* 030314  IR2014030300003  PEMA  ADD CHK FOR STARTBR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   3
* EL6311.cbl
    72* 031114  IR2014031100001  PEMA  CHECK FOR 0 CHECK AMOUNT
    73* 041514  CR2014032600001  PEMA  ALLOW DEL CNC IF VOID CHKS
    74* 051914  IR2014050500003  PEMA  ALLOW DEL CNC IF NO CHK ATTACHED
    75* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    76* 091615  CR2015082000001  PEMA  add endorsement check processing
    77* 101615  CR2015080300002  PEMA  ALLOW VIN FOR CID
    78* 010517  CR2016021600005  PEMA  ADD NEW FORCE CD FOR AGG
    79* 022017  IR2017022000002  PEMA  PREVENT DEL OF ISS W/CHECK
    80* 101016  CR2015082500001  PEMA  ADD COMPANY VPP
    81******************************************************************
    82
    83 ENVIRONMENT DIVISION.
    84
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   4
* EL6311.cbl
    86 DATA DIVISION.
    87 WORKING-STORAGE SECTION.
    88 01  DFH-START PIC X(04).
    89 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    90 77  LCP-ONCTR-02                  PIC S9(8) COMP-3 VALUE ZERO.
    91 77  FILLER  PIC X(32)  VALUE '********************************'.
    92 77  FILLER  PIC X(32)  VALUE '*    EL6311 WORKING STORAGE    *'.
    93 77  FILLER  PIC X(32)  VALUE '************VMOD=2.089**********'.
    94 77  A1                          PIC S999 COMP-3 VALUE +0.
    95 77  N1                          PIC S999 COMP-3 VALUE +0.
    96 77  N2                          PIC S999 COMP-3 VALUE +0.
    97 77  N3                          PIC S999 COMP-3 VALUE +0.
    98 77  WS-OC-AMT                   PIC S9(9)V99 COMP-3 VALUE +0.
    99 77  WS-SAVE-ERPYAJ-KEY          PIC X(33) VALUE SPACES.
   100 77  WS-REVERSE-SW               PIC X VALUE 'N'.
   101     88  REVERSAL                    VALUE 'Y'.
   102 77  WS-NOTE-SW                  PIC X  VALUE ' '.
   103 77  WS-BEG                      PIC S999 COMP-3 VALUE +0.
   104 77  WS-END                      PIC S999 COMP-3 VALUE +0.
   105 77  WS-TALLY                    PIC 99  VALUE ZEROS.
   106 77  WS-ERMAIL-SW                PIC X  VALUE ' '.
   107     88  ERMAIL-FOUND                 VALUE 'Y'.
   108 77  A2                          PIC S9(5) COMP-3 VALUE +0.
   109 77  M1                          PIC S9(5) COMP-3 VALUE +0.
   110 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
   111 77  WS-CERT-TRL-REC-NOT-FOUND   PIC S9       VALUE +0.
   112     88  CERT-TRL-REC-NOT-FOUND     VALUE +1.
   113 77  ws-stop-sw                  pic x value ' '.
   114     88  i-say-stop                 value 'Y'.
   115 77  ws-check-sw                 pic x value ' '.
   116     88  i-have-checks              value 'Y'.
   117 77  ws-proc-check-sw            pic x value ' '.
   118     88  i-have-processed-checks    value 'Y'.
   119 77  ws-any-check-sw             pic x value ' '.
   120     88  i-have-a-check-period      value 'Y'.
   121 77  ws-chek-browse-sw           pic x value ' '.
   122 77  ws-lf-diff                  pic s9(7)v99 comp-3 value +0.
   123 77  ws-ah-diff                  pic s9(7)v99 comp-3 value +0.
   124 77  ws-new-ref-total            pic s9(7)v99 comp-3 value +0.
   125 77  ws-new-iss-total            pic s9(7)v99 comp-3 value +0.
   126 77  ws-check-amts               pic s9(7)v99 comp-3 value +0.
   127 77  ws-tot-orig-prem            pic s9(7)v99 comp-3 value +0.
   128 01  P pointer.
   129 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   130 01  var-ptr pointer.
   131 01  env-var-len                 pic 9(4)  binary.
   132 01  rc                          pic 9(9)  binary.
   133 01  WS-KIXSYS.
   134     05  WS-KIX-FIL1             PIC X(10).
   135     05  WS-KIX-APPS             PIC X(10).
   136     05  WS-KIX-ENV              PIC X(10).
   137     05  WS-KIX-MYENV            PIC X(10).
   138     05  WS-KIX-SYS              PIC X(10).
   139*    COPY ELCSCTM.
   140******************************************************************
   141*                                                                *
   142*                                                                *
   143*                            ELCSCTM                             *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   5
* EL6311.cbl
   144*                            VMOD=2.001                          *
   145*                                                                *
   146*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   147*                                                                *
   148******************************************************************
   149 01  SECURITY-MESSAGE.
   150     12  FILLER                          PIC X(30)
   151            VALUE '** LOGIC SECURITY VIOLATION -'.
   152     12  SM-READ                         PIC X(6).
   153     12  FILLER                          PIC X(5)
   154            VALUE ' PGM='.
   155     12  SM-PGM                          PIC X(6).
   156     12  FILLER                          PIC X(5)
   157            VALUE ' OPR='.
   158     12  SM-PROCESSOR-ID                 PIC X(4).
   159     12  FILLER                          PIC X(6)
   160            VALUE ' TERM='.
   161     12  SM-TERMID                       PIC X(4).
   162     12  FILLER                          PIC XX   VALUE SPACE.
   163     12  SM-JUL-DATE                     PIC 9(5).
   164     12  FILLER                          PIC X    VALUE SPACE.
   165     12  SM-TIME                         PIC 99.99.
   166
   167
   168*    COPY ELCSCRTY.
   169******************************************************************
   170*                                                                *
   171*                                                                *
   172*                            ELCSCRTY                            *
   173*                            VMOD=2.001                          *
   174*                                                                *
   175*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   176*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   177*        SAVED IN PI-SECURITY-ADDRESS.                           *
   178*                                                                *
   179******************************************************************
   180 01  SECURITY-CONTROL.
   181     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   182     12  FILLER                       PIC XX    VALUE 'SC'.
   183     12  SC-CREDIT-CODES.
   184         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   185             20  SC-CREDIT-DISPLAY    PIC X.
   186             20  SC-CREDIT-UPDATE     PIC X.
   187     12  SC-CLAIMS-CODES.
   188         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   189             20  SC-CLAIMS-DISPLAY    PIC X.
   190             20  SC-CLAIMS-UPDATE     PIC X.
   191
   192 01  WS-VA-NO-COMM-MESS.
   193     12  FILLER                  PIC X(41) VALUE
   194        'MAXIMUM AGE EXCEEDED - NO COMMISSION PAID'.
   195 01  WS-OC-MESSAGE.
   196     12  FILLER                  PIC X(43) VALUE
   197        'OVERCHARGE AUTO CORRECTED IN THE AMOUNT OF '.
   198     12  WS-OC-DIS-AMT           PIC -----9.99.
   199     12  FILLER                  PIC X(4) VALUE ' ON '.
   200     12  WS-OC-DATE              PIC X(10).
   201 01  WS-DATE-AREA.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   6
* EL6311.cbl
   202     12  WS-TEMP-EFF-DT          PIC XX     VALUE LOW-VALUES.
   203     12  WS-CURRENT-DT.
   204         16  FILLER              PIC X(6)    VALUE SPACES.
   205         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   206     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   207     12  WS-CREDIT-SELECT-DT     PIC XX      VALUE SPACES.
   208     12  WS-MONTH-END-DT         PIC X(8)    VALUE SPACES.
   209
   210 01  STANDARD-AREAS.
   211     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
   212     12  EL631B                  PIC X(8)    VALUE 'EL631B'.
   213     12  EL631C                  PIC X(8)    VALUE 'EL631C'.
   214     12  EL631D                  PIC X(8)    VALUE 'EL631D'.
   215     12  MAPSET-EL6311S          PIC X(8)    VALUE 'EL6311S'.
   216     12  SCREEN-NUMBER           PIC X(6)    VALUE 'EL631B'.
   217     12  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
   218     12  THIS-PGM                PIC X(8)    VALUE 'EL6311'.
   219     12  PGM-NAME                PIC X(8).
   220     12  TIME-IN                 PIC S9(7).
   221     12  TIME-OUT-R  REDEFINES TIME-IN.
   222         16  FILLER              PIC X.
   223         16  TIME-OUT            PIC 99V99.
   224         16  FILLER              PIC XX.
   225     12  XCTL-EL001              PIC X(8)    VALUE 'EL001'.
   226     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   227     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   228     12  XCTL-EL127              PIC X(8)    VALUE 'EL127'.
   229     12  XCTL-EL1272             PIC X(8)    VALUE 'EL1272'.
   230     12  XCTL-EL1273             PIC X(8)    VALUE 'EL1273'.
   231     12  XCTL-EL1276             PIC X(8)    VALUE 'EL1276'.
   232     12  XCTL-EL1279             PIC X(8)    VALUE 'EL1279'.
   233     12  XCTL-EL401DMD           PIC X(8)    VALUE 'EL401DMD'.
   234     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   235     12  XCTL-EL631              PIC X(8)    VALUE 'EL631'.
   236     12  XCTL-EL6312             PIC X(8)    VALUE 'EL6312'.
   237     12  XCTL-EL6313             PIC X(8)    VALUE 'EL6313'.
   238     12  XCTL-EL6314             PIC X(8)    VALUE 'EL6314'.
   239     12  XCTL-EL6315             PIC X(8)    VALUE 'EL6315'.
   240     12  XCTL-EL6316             PIC X(8)    VALUE 'EL6316'.
   241     12  XCTL-EL640              PIC X(8)    VALUE 'EL640'.
   242     12  XCTL-EL650              PIC X(8)    VALUE 'EL650'.
   243     12  XCTL-EL677              PIC X(8)    VALUE 'EL677'.
   244     12  XCTL-EL680              PIC X(8)    VALUE 'EL680'.
   245     12  XCTL-EL689              PIC X(8)    VALUE 'EL689'.
   246     12  XCTL-EL690              PIC X(8)    VALUE 'EL690'.
   247     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   248     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   249     12  LINK-EL050              PIC X(8)    VALUE 'EL050'.
   250     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   251     12  LINK-ELVADS             PIC X(8)    VALUE 'ELVADS'.
   252     12  FILE-ID                 PIC X(8).
   253     12  FILE-ID-ELCERT          PIC X(8)    VALUE 'ELCERT'.
   254     12  FILE-ID-ERPNDB          PIC X(8)    VALUE 'ERPNDB'.
   255     12  FILE-ID-ERPNDB2         PIC X(8)    VALUE 'ERPNDB2'.
   256     12  FILE-ID-ERPNDB3         PIC X(8)    VALUE 'ERPNDB3'.
   257     12  FILE-ID-ERPNDB4         PIC X(8)    VALUE 'ERPNDB4'.
   258     12  FILE-ID-ERPNDM          PIC X(8)    VALUE 'ERPNDM'.
   259     12  FILE-ID-ERNOTE          PIC X(8)    VALUE 'ERNOTE'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   7
* EL6311.cbl
   260     12  FILE-ID-ERCNOT          PIC X(8)    VALUE 'ERCNOT'.
   261     12  FILE-ID-ERPYAJ          PIC X(8)    VALUE 'ERPYAJ'.
   262     12  FILE-ID-ERMAIL          PIC X(8)    VALUE 'ERMAIL'.
   263     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   264     12  FILE-ID-ERLOFC          PIC X(8)    VALUE 'ERLOFC'.
   265     12  CLMS-ID                 PIC X(8)    VALUE 'ELMSTR5'.
   266     12  FILE-ID-ERENDT          PIC X(8)    VALUE 'ERENDT'.
   267     12  CRTT-ID                 PIC X(8)    VALUE 'ELCRTT'.
   268
   269 01  WS-PASS-AREA.
   270     05  WS-PASS-AREA-LENGTH PIC S9(4) COMP VALUE +352.
   271     05  WS-PASS-VADS-REC    PIC X(350).
   272*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   273*                                COPY ELCZREC.
   274******************************************************************
   275*                                                                *
   276*                                                                *
   277*                            ELCZREC.                            *
   278*                                                                *
   279*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   280*                                                                *
   281******************************************************************
   282*-----------------------------------------------------------------
   283*                   C H A N G E   L O G
   284*
   285* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   286*-----------------------------------------------------------------
   287*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   288* EFFECTIVE    NUMBER
   289*-----------------------------------------------------------------
   290* 122011    2011022800001  AJRA  NEW FILE
   291* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   292* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   293* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   294* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   295*-----------------------------------------------------------------
   296 01  W-Z-CONTROL-DATA.
   297     05  W-NUMBER-OF-COPIES      PIC  9.
   298     05  FILLER                  PIC  X.
   299     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   300     05  FILLER                  PIC  X.
   301     05  W-DAYS-TO-RESEND        PIC  999.
   302     05  FILLER                  PIC  X.
   303     05  W-FORM-TO-RESEND        PIC  X(4).
   304     05  W-ADD-BAR-CODE          PIC  X.
   305     05  W-PROMPT-LETTER         PIC  X.
   306     05  W-HAS-RETURN-ENV        PIC  X.
   307     05  W-ENCLOSURE-CD          PIC  XXX.
   308     05  W-SIG-FLAG-DEFAULT      PIC  X.
   309     05  W-AUTO-CLOSE-IND        PIC  X.
   310     05  FILLER                  PIC  X.
   311     05  W-LETTER-TO-BENE        PIC  X.
   312     05  FILLER                  PIC  X.
   313     05  W-LETTER-TO-ACCT        PIC  X.
   314     05  FILLER                  PIC  X.
   315     05  W-LETTER-TYPE           PIC  X.
   316     05  FILLER                  PIC  X.
   317     05  W-PRINT-CERTIFICATE     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   8
* EL6311.cbl
   318     05  FILLER                  PIC  X.
   319     05  W-REFUND-REQUIRED       PIC  X.
   320     05  FILLER                  PIC  X.
   321     05  W-ONBASE-CODE           PIC  XX.
   322     05  FILLER                  PIC  X.
   323     05  W-ACCT-SUMM             PIC  X.
   324     05  FILLER                  PIC  X.
   325     05  W-CSO-SUMM              PIC  X.
   326     05  FILLER                  PIC  X.
   327     05  W-REASONS-REQUIRED      PIC  X.
   328     05  FILLER                  PIC  X(29).
   329******************************************************************
   330*                                                                *
   331*              A C C E S S   K E Y S                             *
   332*                                                                *
   333******************************************************************
   334
   335 01  ACCESS-KEYS.
   336     12  ERPYAJ-KEY.
   337         16  ERPYAJ-COMPANY-CD       PIC X.
   338         16  ERPYAJ-CARRIER          PIC X.
   339         16  ERPYAJ-GROUPING         PIC X(6).
   340         16  ERPYAJ-FIN-RESP         PIC X(10).
   341         16  ERPYAJ-ACCOUNT          PIC X(10).
   342         16  ERPYAJ-SEQ-NO           PIC S9(8) COMP.
   343         16  ERPYAJ-TYPE             PIC X.
   344     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   345     12  ELCERT-KEY.
   346         16  ELCERT-COMPANY-CD       PIC X.
   347         16  ELCERT-CARRIER          PIC X.
   348         16  ELCERT-GROUPING         PIC X(6).
   349         16  ELCERT-STATE            PIC XX.
   350         16  ELCERT-ACCOUNT          PIC X(10).
   351         16  ELCERT-CERT-EFF-DT      PIC XX.
   352         16  ELCERT-CERT-NO.
   353             20  ELCERT-CERT-PRIME   PIC X(10).
   354             20  ELCERT-CERT-SFX     PIC X.
   355
   356     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   357     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   358     12  ELCRTO-KEY.
   359         16  ELCRTO-COMPANY-CD       PIC X.
   360         16  ELCRTO-CARRIER          PIC X.
   361         16  ELCRTO-GROUPING         PIC X(6).
   362         16  ELCRTO-STATE            PIC XX.
   363         16  ELCRTO-ACCOUNT          PIC X(10).
   364         16  ELCRTO-CERT-EFF-DT      PIC XX.
   365         16  ELCRTO-CERT-NO.
   366             20  ELCRTO-CERT-PRIME   PIC X(10).
   367             20  ELCRTO-CERT-SFX     PIC X.
   368         16  ELCRTO-RECORD-TYPE      PIC X.
   369         16  ELCRTO-SEQ-NO           PIC 9(4)  BINARY.
   370
   371     12  ELCRTT-KEY.
   372         16  ELCRTT-PRIMARY          PIC X(33).
   373         16  ELCRTT-REC-TYPE         PIC X(1).
   374     12  ELCRTT-RECORD-LENGTH        PIC S9(4) COMP VALUE +552.
   375     12  ELCRTT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +575.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page   9
* EL6311.cbl
   376
   377     12  ERPNDB-KEY.
   378         16  ERPNDB-COMPANY-CD       PIC X        VALUE SPACE.
   379         16  ERPNDB-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   380         16  ERPNDB-BATCH-SEQ-NO     PIC S9(4)    VALUE +0 COMP.
   381         16  ERPNDB-BATCH-SEQ-ALPHA  REDEFINES
   382             ERPNDB-BATCH-SEQ-NO     PIC XX.
   383         16  ERPNDB-BATCH-CHG-SEQ-NO PIC S9(4)    VALUE +0 COMP.
   384
   385     12  ERPNDB-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   386     12  ERPNDB-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   387     12  ERCHEK-KEY.
   388         16  CHEK-COMPANY-CD         PIC X       VALUE SPACE.
   389         16  CHEK-CARRIER            PIC X       VALUE SPACE.
   390         16  CHEK-GROUPING           PIC X(6)    VALUE SPACES.
   391         16  CHEK-STATE              PIC XX      VALUE SPACES.
   392         16  CHEK-ACCOUNT            PIC X(10)   VALUE SPACES.
   393         16  CHEK-EFF-DT             PIC XX      VALUE SPACES.
   394         16  CHEK-CERT-NO            PIC X(10)   VALUE SPACES.
   395         16  CHEK-SUF-NO             PIC X       VALUE SPACES.
   396         16  CHEK-RECORD-SEQ         PIC S9(4)   VALUE ZEROS COMP.
   397     12  ELLETR-KEY.
   398         16  LETR-COMPANY-CD     PIC X.
   399         16  LETR-LETTER-ID      PIC X(4).
   400         16  LETR-FILLER         PIC X(8).
   401         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   402     12  ERPNDM-KEY.
   403         16  ERPNDM-COMPANY-CD       PIC X        VALUE SPACE.
   404         16  ERPNDM-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   405         16  ERPNDM-BATCH-SEQ        PIC S9(4)    VALUE +1 COMP.
   406         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4)    VALUE +0 COMP.
   407
   408*    12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   409     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   410*    12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   411     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +397.
   412
   413     12  ERPNDB-ALT-KEY.
   414         16  ERPNDB-COMPANY-CD-A1    PIC X        VALUE SPACE.
   415         16  ERPNDB-CARRIER          PIC X        VALUE SPACES.
   416         16  ERPNDB-GROUPING         PIC X(6)     VALUE SPACES.
   417         16  ERPNDB-STATE            PIC XX       VALUE SPACES.
   418         16  ERPNDB-ACCOUNT          PIC X(10)    VALUE SPACES.
   419         16  ERPNDB-CERT-EFF-DT      PIC XX       VALUE SPACES.
   420         16  ERPNDB-CERT-NO.
   421             20  ERPNDB-CERT-PRIME   PIC X(10)    VALUE SPACES.
   422             20  ERPNDB-CERT-SFX     PIC X        VALUE SPACE.
   423         16  ERPNDB-ALT-CHG-SEQ-NO   PIC S9(4)    VALUE +0 COMP.
   424         16  ERPNDB-RECORD-TYPE      PIC X.
   425
   426      12  ERPNDB-CSR-KEY.
   427          20  ERPNDB-CSR-COMPANY-CD-A2     PIC X.
   428          20  ERPNDB-CSR-ID                PIC X(4).
   429          20  ERPNDB-CSR-ENTRY-BATCH       PIC X(6).
   430          20  ERPNDB-CSR-BTCH-SEQ-NO       PIC S9(4)     COMP.
   431          20  ERPNDB-CSR-BTCH-CHG-SEQ      PIC S9(4)     COMP.
   432
   433     12  ERNOTE-KEY.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  10
* EL6311.cbl
   434         16  ERNOTE-COMPANY-CD       PIC X        VALUE SPACE.
   435         16  ERNOTE-CARRIER          PIC X        VALUE SPACES.
   436         16  ERNOTE-GROUPING         PIC X(6)     VALUE SPACES.
   437         16  ERNOTE-STATE            PIC XX       VALUE SPACES.
   438         16  ERNOTE-ACCOUNT          PIC X(10)    VALUE SPACES.
   439         16  ERNOTE-CERT-EFF-DT      PIC XX       VALUE SPACES.
   440         16  ERNOTE-CERT-NO.
   441             20  ERNOTE-CERT-PRIME   PIC X(10)    VALUE SPACES.
   442             20  ERNOTE-CERT-SFX     PIC X        VALUE SPACES.
   443
   444     12  ERNOTE-RECORD-LENGTH        PIC S9(4) COMP VALUE +825.
   445     12  ERNOTE-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +848.
   446
   447     12  ERCNOT-KEY.
   448         16  ERCNOT-PART-KEY.
   449             20  ERCNOT-COMPANY-CD   PIC X        VALUE SPACE.
   450             20  ERCNOT-CARRIER      PIC X        VALUE SPACES.
   451             20  ERCNOT-GROUPING     PIC X(6)     VALUE SPACES.
   452             20  ERCNOT-STATE        PIC XX       VALUE SPACES.
   453             20  ERCNOT-ACCOUNT      PIC X(10)    VALUE SPACES.
   454             20  ERCNOT-CERT-EFF-DT  PIC XX       VALUE SPACES.
   455             20  ERCNOT-CERT-NO.
   456                 25  ERCNOT-CERT-PRIME PIC X(10)  VALUE SPACES.
   457                 25  ERCNOT-CERT-SFX PIC X        VALUE SPACES.
   458         16  ERCNOT-REC-TYPE         PIC X        VALUE SPACES.
   459         16  ERCNOT-SEQUENCE         PIC S9(4) COMP VALUE +0.
   460
   461     12  ERCNOT-RECORD-LENGTH        PIC S9(4) COMP VALUE +150.
   462     12  ERCNOT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +173.
   463
   464     12  ERMAIL-KEY.
   465         16  ERMAIL-COMPANY-CD       PIC X        VALUE SPACE.
   466         16  ERMAIL-CARRIER          PIC X        VALUE SPACES.
   467         16  ERMAIL-GROUPING         PIC X(6)     VALUE SPACES.
   468         16  ERMAIL-STATE            PIC XX       VALUE SPACES.
   469         16  ERMAIL-ACCOUNT          PIC X(10)    VALUE SPACES.
   470         16  ERMAIL-CERT-EFF-DT      PIC XX       VALUE SPACES.
   471         16  ERMAIL-CERT-NO.
   472             20  ERMAIL-CERT-PRIME   PIC X(10)    VALUE SPACES.
   473             20  ERMAIL-CERT-SFX     PIC X        VALUE SPACES.
   474
   475     12  ERMAIL-RECORD-LENGTH        PIC S9(4) COMP VALUE +374.
   476     12  ERMAIL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +393.
   477
   478     12  ERRQST-KEY.
   479         16  ERRQST-COMPANY-CD       PIC X        VALUE SPACE.
   480         16  ERRQST-ENTRY-BATCH      PIC X(6)     VALUE SPACES.
   481
   482     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   483     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   484
   485     12  WS-JOURNAL-RECORD-LENGTH    PIC S9(4) COMP VALUE +0000.
   486
   487     12  ERLOFC-KEY.
   488         16  ERLOFC-COMPANY-CD          PIC  X.
   489         16  ERLOFC-CARRIER             PIC  X.
   490         16  ERLOFC-GROUPING            PIC  X(6).
   491         16  ERLOFC-STATE               PIC  XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  11
* EL6311.cbl
   492         16  ERLOFC-ACCOUNT             PIC  X(10).
   493         16  ERLOFC-OFFICER-CODE        PIC  X(5).
   494*        16  ERLOFC-OFFICER-CODE        PIC  XXX.
   495
   496     12  ERACCT-KEY.
   497         16  ERACCT-COMPANY-CD          PIC  X.
   498         16  ERACCT-CARRIER             PIC  X.
   499         16  ERACCT-GROUPING            PIC  X(6).
   500         16  ERACCT-STATE               PIC  XX.
   501         16  ERACCT-ACCOUNT             PIC  X(10).
   502         16  ERACCT-EXP-DT.
   503             20  ERACCT-DT              PIC  XX.
   504             20  ERACCT-FILL            PIC  X(4).
   505
   506     12  ERENDT-KEY.
   507         16  ENDT-COMPANY-CD       PIC X.
   508         16  ENDT-CARRIER          PIC X.
   509         16  ENDT-GROUPING         PIC X(6).
   510         16  ENDT-STATE            PIC XX.
   511         16  ENDT-ACCOUNT          PIC X(10).
   512         16  ENDT-CERT-EFF-DT      PIC XX.
   513         16  ENDT-CERT-PRIME       PIC X(10).
   514         16  ENDT-CERT-SFX         PIC X.
   515         16  ENDT-RECORD-TYPE      PIC X.
   516         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   517
   518 01  WS-ELMSTR-WORK.
   519     12  ELMSTR-KEY.
   520         16  MSTR-COMP-CD         PIC X       VALUE LOW-VALUES.
   521         16  MSTR-CERT-NO.
   522             20  MSTR-CERT-PRIME  PIC X(10)   VALUE SPACES.
   523             20  MSTR-CERT-SFX    PIC X(1)    VALUE SPACES.
   524     12  W-CLAIM-KEY.
   525         16  W-CL-COMP-CD         PIC X       VALUE LOW-VALUES.
   526         16  W-CL-CERT-NO.
   527             20  W-CL-CERT-PRIME  PIC X(10)   VALUE SPACES.
   528             20  W-CL-CERT-SFX    PIC X(1)    VALUE SPACES.
   529      12  ELMSTR-LENGTH           PIC S9999 COMP  VALUE +11.
   530 01  CANCEL-GEN-PASS-AREA.
   531     05  CG-OPTION-CODE          PIC X.
   532         88  CG-VALID-OPTION       VALUE '1' '2' '3' '4'.
   533         88  CG-FLAT-CANCEL        VALUE '1'.
   534         88  CG-CANCEL             VALUE '2'.
   535         88  CG-CANCEL-REISSUE     VALUE '3'.
   536     05  CG-ERROR-CODE           PIC 99.
   537         88  CG-SUCCESS            VALUE 00.
   538         88  CG-DATE-ERROR         VALUE 01.
   539         88  CG-CERT-NOT-FOUND     VALUE 02.
   540         88  CG-AMOUNT-ERROR       VALUE 04.
   541         88  CG-OPTION-ERROR       VALUE 05.
   542         88  CG-PREV-CAN           VALUE 06.
   543         88  CG-INVALID-DATA       VALUE 07.
   544         88  CG-NO-ACCT-MSTR       VALUE 08.
   545         88  CG-SFX-A-EXIST        VALUE 09.
   546         88  CG-MISC-ERROR         VALUE 99.
   547     05  CG-COMPANY-ID           PIC XXX.
   548     05  CG-PROC-ID              PIC XXXX.
   549     05  CG-CURRENT-DT           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  12
* EL6311.cbl
   550     05  CG-MONTH-END-DT         PIC XX.
   551     05  CG-CERT-KEY.
   552         10  CG-CERT-COMPANY-CD  PIC X.
   553         10  CG-CERT-CARRIER     PIC X.
   554         10  CG-CERT-GROUP       PIC X(6).
   555         10  CG-CERT-STATE       PIC XX.
   556         10  CG-CERT-ACCOUNT     PIC X(10).
   557         10  CG-CERT-EFF-DT      PIC XX.
   558         10  CG-CERT-CERT-NO     PIC X(11).
   559     05  CG-LF-CAN-DATA.
   560         10  CG-LF-CAN-DT        PIC XX.
   561         10  CG-LF-CAN-AMT       PIC S9(7)V99 COMP-3.
   562     05  CG-AH-CAN-DATA.
   563         10  CG-AH-CAN-DT        PIC XX.
   564         10  CG-AH-CAN-AMT       PIC S9(7)V99 COMP-3.
   565     05  CG-CERT-PROFILE-DATA.
   566         10  CG-INS-LNAME        PIC X(15).
   567         10  CG-INS-FNAME        PIC X(10).
   568         10  CG-INS-MID-INIT     PIC X.
   569         10  CG-INS-AGE          PIC 99.
   570         10  CG-JNT-LNAME        PIC X(15).
   571         10  CG-JNT-FNAME        PIC X(10).
   572         10  CG-JNT-MID-INIT     PIC X.
   573         10  CG-JNT-AGE          PIC 99.
   574     05  CG-LF-ISS-DATA.
   575         10  CG-LF-BENCD         PIC XX.
   576         10  CG-LF-PREM-AMT      PIC S9(7)V99 COMP-3.
   577         10  CG-LF-ALT-PREM-AMT  PIC S9(7)V99 COMP-3.
   578     05  CG-AH-ISS-DATA.
   579         10  CG-AH-BENCD         PIC XX.
   580         10  CG-AH-PREM-AMT      PIC S9(7)V99 COMP-3.
   581     05  CG-BATCH-NO             PIC X(6).
   582     05  CG-BATCH-SEQ-NO         PIC 9(4)  COMP.
   583     05  FILLER                  PIC X(306).
   584******************************************************************
   585*                                                                *
   586*            G E N E R A L   W O R K   A R E A                   *
   587*                                                                *
   588******************************************************************
   589
   590 01  WORK-AREA.
   591     12  WS-RESPONSE             PIC S9(8)   COMP.
   592         88  RESP-NORMAL           VALUE +0.
   593         88  resp-file-notfnd      value +12.
   594         88  RESP-NOTFND           VALUE +13.
   595         88  resp-duprec           value +14.
   596         88  resp-dupkey           value +15.
   597         88  resp-invreq           value +16.
   598         88  RESP-NOTOPEN          VALUE +19.
   599         88  RESP-ENDFILE          VALUE +20.
   600         88  resp-lengtherr        value +22.
   601     12  DEEDIT-FIELD            PIC X(15).
   602     12  FILLER          REDEFINES DEEDIT-FIELD.
   603         16  FILLER              PIC X(4).
   604         16  DEEDIT-FIELD-X11    PIC X(11).
   605     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
   606                                 PIC S9(15).
   607     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  13
* EL6311.cbl
   608                                 PIC S9(13)V99.
   609     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD
   610                                 PIC S9(11)V9999.
   611     12  W-ONE                   PIC S9(4) COMP VALUE +1.
   612     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   613     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   614         16  WS-CALC-TERM-WHOLE  PIC S999.
   615         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   616
   617     12  WS-TIME                 PIC 9(6)   VALUE ZEROS.
   618     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   619         16  WS-HR-MINS          PIC 99V99.
   620         16  FILLER              PIC XX.
   621
   622     12  WS-EDIT-PASS-LENGTH     PIC S9(4)  VALUE +1036 COMP.
   623     12  WS-COMM-LENGTH          PIC S9(4)  VALUE +1306 COMP.
   624
   625     12  W-CANCEL-FEE-LONG       PIC S9(3)V9(2)  VALUE +0  COMP-3.
   626     12  W-CANCEL-FEE            PIC S99         VALUE +0  COMP-3.
   627
   628     12  WS-SUB                  PIC S9(4) VALUE +0  COMP-3.
   629     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   630     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   631     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   632     12  WS-SUB4                 PIC S9(4) VALUE +0  COMP.
   633     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   634     12  WS-CSO-SUB              PIC S9(4) VALUE +0  COMP.
   635
   636     12  QID.
   637         16  QID-TERM            PIC X(4).
   638         16  FILLER              PIC X(4)    VALUE '607B'.
   639
   640     12  WS-DISPLAY-SW           PIC X     VALUE SPACE.
   641         88  WS-DISPLAY-SCREEN       VALUE 'Y'.
   642
   643     12  WS-LOAN-OFFICER         PIC X     VALUE SPACE.
   644         88  LOAN-OFFICER-FOUND      VALUE SPACE.
   645
   646     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   647         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B' 'T'
   648                                         'A'.
   649
   650     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   651
   652     12  WS-NUMERIC-SW           PIC X.
   653        88  CSO-NUMERIC-FIELD   VALUE 'Y'.
   654
   655     12  WS-EDIT-CSO-FIELD.
   656         16  WS-EDIT-BYTE  OCCURS 9 TIMES
   657                                 PIC X.
   658
   659     12  WS-SAVE-INPUT-FIELDS.
   660         16  WS-BAGE             PIC 99       VALUE ZERO.
   661*        16  WS-BAPR             PIC S99V9(4) VALUE +0 COMP-3.
   662         16  WS-BAPR                 PIC 99V9(4) VALUE ZEROS.
   663         16  FILLER REDEFINES WS-BAPR.
   664             20  WS-APR-WHOLE-NUM    PIC 99.
   665             20  WS-APR-DEC          PIC 9999.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  14
* EL6311.cbl
   666         16  WS-BLIVES           PIC S9(7)    VALUE +0 COMP-3.
   667         16  WS-BILLED           PIC S9(7)    VALUE +0 COMP-3.
   668
   669         16  WS-B-COVERAGE OCCURS 2 TIMES.
   670             20  WS-TERM-IN-DAYS-SW  PIC X.
   671                 88  WS-TERM-IN-DAYS-FOUND        VALUE 'Y'.
   672             20  WS-BTERM        PIC 999       COMP-3.
   673             20  WS-BALT-TERM    PIC 999       COMP-3.
   674             20  WS-BCRIT-PERD   PIC 99        COMP-3.
   675             20  WS-BBEN         PIC S9(10)V99 COMP-3.
   676             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   677             20  WS-BPREM        PIC S9(7)V99  COMP-3.
   678             20  WS-BALT-PREM    PIC S9(7)V99  COMP-3.
   679             20  WS-BCPREM       PIC S9(7)V99  COMP-3.
   680
   681         16  WS-C-FIELDS COMP-3.
   682             20  WS-CLIVES       PIC S9(3)     VALUE +0.
   683             20  WS-CREFND1      PIC S9(7)V99  VALUE +0.
   684             20  WS-CREFND2      PIC S9(7)V99  VALUE +0.
   685
   686         16  WS-D-FIELDS COMP-3.
   687             20  WS-DRISS        PIC S9(5)    VALUE +0.
   688             20  WS-DRLFPRM      PIC S9(7)V99 VALUE +0.
   689             20  WS-DRAHPRM      PIC S9(7)V99 VALUE +0.
   690             20  WS-DRCANC       PIC S9(5)    VALUE +0.
   691             20  WS-DRLFRFD      PIC S9(7)V99 VALUE +0.
   692             20  WS-DRAHRFD      PIC S9(7)V99 VALUE +0.
   693
   694     12  WS-SAVE-BIRTH-DATE.
   695         16  FILLER              PIC X(4)   VALUE SPACES.
   696         16  WS-SAVE-BIRTH-YR    PIC X(2)   VALUE SPACES.
   697
   698     12  CENTURY-ADJ             PIC S9(08) VALUE +38400 COMP.
   699     12  WS-WORK-BIN-RED         PIC S9(08) VALUE +0 COMP.
   700     12  FILLER REDEFINES WS-WORK-BIN-RED.
   701         16  FILLER              PIC X(02).
   702         16  WS-WORK-BIN-DT      PIC X(02).
   703     12  WS-SW-1                 PIC X     VALUE SPACE.
   704     12  WS-SW-2                 PIC X     VALUE SPACE.
   705     12  WS-REMOVE-AH-SW         PIC X     VALUE SPACE.
   706         88  REMOVE-AH-COVERAGE  VALUE 'Y'.
   707     12  WS-REMOVE-LF-SW         PIC X     VALUE SPACE.
   708         88  REMOVE-LF-COVERAGE  VALUE 'Y'.
   709
   710     12  WS-CONVERTED-BIRTH      PIC XX    VALUE SPACE.
   711     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACE.
   712     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   713     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   714     12  WS-CONVERTED-CANCEL-DATES.
   715         16  WS-CONVERTED-CANDT1                  PIC XX.
   716         16  WS-CONVERTED-CANDT2                  PIC XX.
   717
   718     12  WS-EXP-DT-EDIT          PIC 99B99B99.
   719
   720     12  WS-REC-FOUND-SW         PIC X.
   721         88  RECORD-NOT-FOUND    VALUE 'N'.
   722
   723     12  WS-PB-RECORDS-FOUND-SW  PIC X     VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  15
* EL6311.cbl
   724         88  PENDING-BUS-RECS-NOT-FOUND    VALUE 'N'.
   725         88  PENDING-BUS-RECS-FOUND        VALUE 'Y'.
   726
   727     12  WS-ERRORS-PRESENT-SW    PIC X     VALUE 'N'.
   728         88  WS-ERRORS-PRESENT             VALUE 'Y'.
   729         88  WS-ERRORS-NOT-PRESENT         VALUE 'N'.
   730
   731     12  WS-BROWSE-STARTED-SW    PIC X            VALUE ' '.
   732         88  BROWSE-STARTED      VALUE 'Y'.
   733
   734     12  WS-FIRST-TIME-SW        PIC X            VALUE ' '.
   735         88  FIRST-TIME          VALUE 'Y'.
   736
   737     12  WS-FIRST-ENTRY-SW       PIC X            VALUE ' '.
   738         88  FIRST-ENTRY         VALUE 'Y'.
   739
   740     12  WS-REC-BILLED-SW        PIC X            VALUE ' '.
   741         88  REC-BILLED          VALUE 'Y'.
   742
   743     12  SET-CURSOR-SW           PIC S9  COMP-3   VALUE +0.
   744         88  NO-CURSOR-SET       VALUE +0.
   745         88  CURSOR-SET          VALUE +1.
   746
   747     12  WS-ERR-SW               PIC X.
   748         88  STD-ERRORS          VALUE 'S'.
   749         88  TRN-ERRORS          VALUE 'T'.
   750
   751     12  WS-CERT-NOTE-SW         PIC X            VALUE ' '.
   752         88 CERT-NOTES-ARE-PRESENT   VALUE 'Y'.
   753
   754     12  WS-CERT-ADDRESS-SW      PIC X            VALUE ' '.
   755         88 CERT-ADDRESS-PRESENT VALUE 'Y'.
   756
   757     12  WS-CANCEL-LETTER-SW     PIC X            VALUE ' '.
   758         88 CREATE-CANCEL-LETTER VALUE 'Y'.
   759
   760     12  WS-ERR-CODE.
   761         16  FILLER              PIC 99.
   762         16  WS-ERROR-SUB        PIC 99.
   763
   764     12  WS-DATE-WORK.
   765         16  WS-WORK-MM          PIC XX.
   766         16  WS-WORK-DD          PIC XX.
   767         16  WS-WORK-YY          PIC XX.
   768
   769     12  WS-MM-YY.
   770         16  WS-MM               PIC XX.
   771         16  FILLER              PIC X     VALUE '/'.
   772         16  WS-YY               PIC XX.
   773
   774     12  WS-CERT-EFF-DT          PIC XX.
   775
   776     12  WS-MEMBER-NO            PIC X(12).
   777     12  FILLER  REDEFINES  WS-MEMBER-NO.
   778         16  WS-MEMBER-NO-1-8    PIC 9(8).
   779         16  FILLER              PIC X(4).
   780
   781     12  WS-I-MICRO-NO           PIC S9(9)        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  16
* EL6311.cbl
   782
   783     12  WS-ERPNDB-ALT-KEY.
   784         16  WS-PB-COMPANY-CD-A1         PIC X.
   785         16  WS-PB-CARRIER               PIC X.
   786         16  WS-PB-GROUPING              PIC X(6).
   787         16  WS-PB-STATE                 PIC XX.
   788         16  WS-PB-ACCOUNT               PIC X(10).
   789         16  WS-PB-CERT-EFF-DT           PIC XX.
   790         16  WS-PB-CERT-NO.
   791             20  WS-PB-CERT-PRIME        PIC X(10).
   792             20  WS-PB-CERT-SFX          PIC X.
   793         16  WS-PB-ALT-CHG-SEQ-NO        PIC S9(4)     COMP.
   794         16  WS-PB-RECORD-TYPE           PIC X.
   795
   796     12  WS-SHOW-SAVE-AREAS.
   797         16  WS-NEW-CERT-NO.
   798             20  WS-NEW-PRIME    PIC X(10).
   799             20  WS-NEW-SUFFIX   PIC X.
   800         16  WS-NEW-CERT-EFF-DT  PIC XX.
   801         16  WS-NEW-RECORD-TYPE  PIC X.
   802         16  WS-SHOW-SW          PIC X   VALUE 'N'.
   803             88   SHOW-RECORD            VALUE 'Y'.
   804
   805     12  WS-SEQ-SAVE             PIC S9(4) COMP.
   806
   807     12  WS-BATCH-NO.
   808         16  WS-BATCH-PREFIX     PIC XXX  VALUE SPACES.
   809         16  FILLER              PIC X(5) VALUE SPACES.
   810
   811     12  WS-FIRST-NAME.
   812         16  WS-1ST-INIT         PIC X.
   813         16  FILLER              PIC X(9).
   814
   815     12  WS-INITIALS.
   816         16  WS-INITIAL-1        PIC X.
   817         16  WS-INITIAL-2        PIC X.
   818
   819     12  WS-C-HDG.
   820         16  WS-REF-HDG-OVERRIDE PIC XX   VALUE SPACES.
   821         16  FILLER              PIC X(4) VALUE '-REF'.
   822
   823     12  WS-D-PREM-HDG.
   824         16  WS-PREM-HDG-OVERRIDE    PIC XX   VALUE SPACES.
   825         16  FILLER                  PIC X(8) VALUE '-PREMIUM'.
   826
   827     12  WS-D-REFUND-HDG.
   828         16  WS-REFUND-HDG-OVERRIDE  PIC XX   VALUE SPACES.
   829         16  FILLER                  PIC X(7) VALUE '-REFUND'.
   830
   831     12  WS-BATCH-CSR-ID     PIC X(4)    VALUE SPACE.
   832
   833     12  CLIENT-ACE          PIC X(3)    VALUE 'ACE'.
   834     12  CLIENT-CRI          PIC X(3)    VALUE 'CRI'.
   835     12  CLIENT-CSO          PIC X(3)    VALUE 'CSO'.
   836     12  CLIENT-GIC          PIC X(3)    VALUE 'GIC'.
   837     12  CLIENT-LGX          PIC X(3)    VALUE 'LGX'.
   838     12  CLIENT-MIC          PIC X(3)    VALUE 'MIC'.
   839     12  CLIENT-PEM          PIC X(3)    VALUE 'PEM'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  17
* EL6311.cbl
   840
   841     12  WS-01-CANCEL-ERR        PIC X(25)
   842         VALUE 'CANCEL DATE ERROR'.
   843     12  WS-02-CANCEL-ERR        PIC X(25)
   844         VALUE 'CERT NOT FOUND'.
   845     12  WS-04-CANCEL-ERR        PIC X(25)
   846         VALUE 'CANCEL AMOUNT ERROR'.
   847     12  WS-05-CANCEL-ERR        PIC X(25)
   848         VALUE 'CANCEL OPTION ERROR'.
   849     12  WS-06-CANCEL-ERR        PIC X(25)
   850         VALUE 'PREVIOUSLY CANCELLED'.
   851     12  WS-07-CANCEL-ERR        PIC X(25)
   852         VALUE 'INVALID DATA'.
   853     12  WS-08-CANCEL-ERR        PIC X(25)
   854         VALUE 'NO ACCOUNT MASTER'.
   855     12  WS-09-CANCEL-ERR        PIC X(25)
   856         VALUE 'SUFFIX ALREADY EXISTS'.
   857     12  WS-99-CANCEL-ERR        PIC X(25)
   858         VALUE 'MISC CANCEL ERROR'.
   859
   860     12  ARCH-SUPPRESS           PIC ZZZZZZZZ99.
   861     12  ARCH-EDIT REDEFINES ARCH-SUPPRESS    PIC X(10).
   862
   863     12  WS-AGE-FIELDS.
   864         16  WS-INS-AGE-SET             PIC X VALUE 'N'.
   865         16  WS-JNT-AGE-SET             PIC X VALUE 'N'.
   866         16  WS-INS-AGE-DEFAULTED       PIC X VALUE 'N'.
   867         16  WS-JNT-AGE-DEFAULTED       PIC X VALUE 'N'.
   868
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  18
* EL6311.cbl
   870
   871******************************************************************
   872*                                                                *
   873*                 B A T C H   T O T A L S                        *
   874*                                                                *
   875******************************************************************
   876
   877     12  WS-BATCH-RECORD.
   878         16  FILLER                       PIC X(10).
   879         16  WS-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   880         16  WS-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   881         16  WS-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   882         16  WS-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   883         16  WS-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   884         16  WS-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   885         16  WS-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   886         16  WS-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   887         16  WS-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   888         16  WS-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   889         16  WS-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   890         16  WS-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   891         16  WS-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   892         16  WS-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   893         16  WS-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   894         16  WS-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   895         16  WS-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   896         16  WS-ACCOUNT-NAME              PIC X(30).
   897         16  FILLER                       PIC X.
   898         16  WS-REFERENCE                 PIC X(12).
   899         16  FILLER                       PIC X(197).
   900
   901     12  WS-BATCH-TOTALS.
   902         16  WS-ISS-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   903         16  WS-ISS-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   904         16  WS-ISS-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   905         16  WS-ISS-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   906         16  WS-ISS-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   907         16  WS-ISS-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   908         16  WS-CAN-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   909         16  WS-CAN-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   910         16  WS-CAN-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   911         16  WS-CAN-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   912         16  WS-CAN-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   913         16  WS-CAN-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   914         16  WS-NET-TOTAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   915         16  WS-NET-FATAL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   916         16  WS-NET-FORCE-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   917         16  WS-NET-HOLD-CNT     PIC S9(5)     COMP-3 VALUE ZEROS.
   918         16  WS-NET-AVAIL-CNT    PIC S9(5)     COMP-3 VALUE ZEROS.
   919         16  WS-NET-GOOD-PREM    PIC S9(7)V99  COMP-3 VALUE ZEROS.
   920         16  WS-NET-BAD-PREM     PIC S9(7)V99  COMP-3 VALUE ZEROS.
   921
   922     12  WS-SEQ-NO-COUNTER       PIC S9(3)     COMP-3 VALUE ZEROS.
   923
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  19
* EL6311.cbl
   925
   926******************************************************************
   927*                                                                *
   928*                E R R O R   M E S S A G E S                     *
   929*                                                                *
   930******************************************************************
   931
   932 01  ERROR-MESSAGES.
   933     12  ER-0004                 PIC  9(4) VALUE 0004.
   934     12  ER-0008                 PIC  9(4) VALUE 0008.
   935     12  ER-0023                 PIC  9(4) VALUE 0023.
   936     12  ER-0029                 PIC  9(4) VALUE 0029.
   937     12  ER-0033                 PIC  9(4) VALUE 0033.
   938     12  ER-0070                 PIC  9(4) VALUE 0070.
   939     12  ER-0220                 PIC  9(4) VALUE 0220.
   940     12  ER-0248                 PIC  9(4) VALUE 0248.
   941     12  ER-0280                 PIC  9(4) VALUE 0280.
   942     12  ER-0348                 PIC  9(4) VALUE 0348.
   943     12  ER-0582                 PIC  9(4) VALUE 0582.
   944     12  ER-0877                 PIC  9(4) VALUE 0877.
   945     12  ER-1236                 PIC  9(4) VALUE 1236.
   946     12  ER-1570                 PIC  9(4) VALUE 1570.
   947     12  ER-1575                 PIC  9(4) VALUE 1575.
   948     12  ER-1609                 PIC  9(4) VALUE 1609.
   949     12  ER-1819                 PIC  9(4) VALUE 1819.
   950     12  ER-2077                 PIC  9(4) VALUE 2077.
   951     12  ER-2129                 PIC  9(4) VALUE 2129.
   952     12  ER-2188                 PIC  9(4) VALUE 2188.
   953     12  ER-2192                 PIC  9(4) VALUE 2192.
   954     12  ER-2196                 PIC  9(4) VALUE 2196.
   955     12  ER-2197                 PIC  9(4) VALUE 2197.
   956     12  ER-2198                 PIC  9(4) VALUE 2198.
   957     12  ER-2200                 PIC  9(4) VALUE 2200.
   958     12  ER-2212                 PIC  9(4) VALUE 2212.
   959     12  ER-2218                 PIC  9(4) VALUE 2218.
   960     12  ER-2220                 PIC  9(4) VALUE 2220.
   961     12  ER-2222                 PIC  9(4) VALUE 2222.
   962     12  ER-2223                 PIC  9(4) VALUE 2223.
   963     12  ER-2224                 PIC  9(4) VALUE 2224.
   964     12  ER-2225                 PIC  9(4) VALUE 2225.
   965     12  ER-2226                 PIC  9(4) VALUE 2226.
   966     12  ER-2227                 PIC  9(4) VALUE 2227.
   967     12  ER-2228                 PIC  9(4) VALUE 2228.
   968     12  ER-2240                 PIC  9(4) VALUE 2240.
   969     12  ER-2241                 PIC  9(4) VALUE 2241.
   970     12  ER-2242                 PIC  9(4) VALUE 2242.
   971     12  ER-2243                 PIC  9(4) VALUE 2243.
   972     12  ER-2244                 PIC  9(4) VALUE 2244.
   973     12  ER-2245                 PIC  9(4) VALUE 2245.
   974     12  ER-2246                 PIC  9(4) VALUE 2246.
   975     12  ER-2247                 PIC  9(4) VALUE 2247.
   976     12  ER-2251                 PIC  9(4) VALUE 2251.
   977     12  ER-2252                 PIC  9(4) VALUE 2252.
   978     12  ER-2253                 PIC  9(4) VALUE 2253.
   979     12  ER-2254                 PIC  9(4) VALUE 2254.
   980     12  ER-2255                 PIC  9(4) VALUE 2255.
   981     12  ER-2256                 PIC  9(4) VALUE 2256.
   982     12  ER-2257                 PIC  9(4) VALUE 2257.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  20
* EL6311.cbl
   983     12  ER-2258                 PIC  9(4) VALUE 2258.
   984     12  ER-2259                 PIC  9(4) VALUE 2259.
   985     12  ER-2260                 PIC  9(4) VALUE 2260.
   986     12  ER-2261                 PIC  9(4) VALUE 2261.
   987     12  ER-2287                 PIC  9(4) VALUE 2287.
   988     12  ER-2336                 PIC  9(4) VALUE 2336.
   989     12  ER-2337                 PIC  9(4) VALUE 2337.
   990     12  ER-2437                 PIC  9(4) VALUE 2437.
   991     12  ER-2471                 PIC  9(4) VALUE 2471.
   992     12  ER-2530                 PIC  9(4) VALUE 2530.
   993     12  ER-2531                 PIC  9(4) VALUE 2531.
   994     12  ER-2532                 PIC  9(4) VALUE 2532.
   995     12  ER-2533                 PIC  9(4) VALUE 2533.
   996     12  ER-2547                 PIC  9(4) VALUE 2547.
   997     12  ER-2591                 PIC  9(4) VALUE 2591.
   998     12  ER-2592                 PIC  9(4) VALUE 2592.
   999     12  ER-2593                 PIC  9(4) VALUE 2593.
  1000     12  ER-2600                 PIC  9(4) VALUE 2600.
  1001     12  ER-2601                 PIC  9(4) VALUE 2601.
  1002     12  ER-2604                 PIC  9(4) VALUE 2604.
  1003     12  ER-2605                 PIC  9(4) VALUE 2605.
  1004     12  ER-2606                 PIC  9(4) VALUE 2606.
  1005     12  ER-2607                 PIC  9(4) VALUE 2607.
  1006     12  ER-2622                 PIC  9(4) VALUE 2622.
  1007     12  ER-2625                 PIC  9(4) VALUE 2625.
  1008     12  ER-2626                 PIC  9(4) VALUE 2626.
  1009     12  ER-2627                 PIC  9(4) VALUE 2627.
  1010     12  ER-2628                 PIC  9(4) VALUE 2628.
  1011     12  ER-2629                 PIC  9(4) VALUE 2629.
  1012     12  ER-2630                 PIC  9(4) VALUE 2630.
  1013     12  ER-2631                 PIC  9(4) VALUE 2631.
  1014     12  ER-2632                 PIC  9(4) VALUE 2632.
  1015     12  ER-2633                 PIC  9(4) VALUE 2633.
  1016     12  ER-2634                 PIC  9(4) VALUE 2634.
  1017     12  ER-2635                 PIC  9(4) VALUE 2635.
  1018     12  ER-2636                 PIC  9(4) VALUE 2636.
  1019     12  ER-2639                 PIC  9(4) VALUE 2639.
  1020     12  ER-2640                 PIC  9(4) VALUE 2640.
  1021     12  ER-2647                 PIC  9(4) VALUE 2647.
  1022     12  ER-2648                 PIC  9(4) VALUE 2648.
  1023     12  ER-2649                 PIC  9(4) VALUE 2649.
  1024     12  ER-2650                 PIC  9(4) VALUE 2650.
  1025     12  ER-2653                 PIC  9(4) VALUE 2653.
  1026     12  ER-2654                 PIC  9(4) VALUE 2654.
  1027     12  ER-2655                 PIC  9(4) VALUE 2655.
  1028     12  ER-2656                 PIC  9(4) VALUE 2656.
  1029     12  ER-2657                 PIC  9(4) VALUE 2657.
  1030     12  ER-2660                 PIC  9(4) VALUE 2660.
  1031     12  ER-2661                 PIC  9(4) VALUE 2661.
  1032     12  ER-2662                 PIC  9(4) VALUE 2662.
  1033     12  ER-2663                 PIC  9(4) VALUE 2663.
  1034     12  ER-2664                 PIC  9(4) VALUE 2664.
  1035     12  ER-2667                 PIC  9(4) VALUE 2667.
  1036     12  ER-2668                 PIC  9(4) VALUE 2668.
  1037     12  ER-2669                 PIC  9(4) VALUE 2669.
  1038     12  ER-2670                 PIC  9(4) VALUE 2670.
  1039     12  ER-2671                 PIC  9(4) VALUE 2671.
  1040     12  ER-2672                 PIC  9(4) VALUE 2672.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  21
* EL6311.cbl
  1041     12  ER-2673                 PIC  9(4) VALUE 2673.
  1042     12  ER-2677                 PIC  9(4) VALUE 2677.
  1043     12  ER-2678                 PIC  9(4) VALUE 2678.
  1044     12  ER-2679                 PIC  9(4) VALUE 2679.
  1045     12  ER-2680                 PIC  9(4) VALUE 2680.
  1046     12  ER-2681                 PIC  9(4) VALUE 2681.
  1047     12  ER-2682                 PIC  9(4) VALUE 2682.
  1048     12  ER-2683                 PIC  9(4) VALUE 2683.
  1049     12  ER-2684                 PIC  9(4) VALUE 2684.
  1050     12  ER-2686                 PIC  9(4) VALUE 2686.
  1051     12  ER-2689                 PIC  9(4) VALUE 2689.
  1052     12  ER-2690                 PIC  9(4) VALUE 2690.
  1053     12  ER-2693                 PIC  9(4) VALUE 2693.
  1054     12  ER-2695                 PIC  9(4) VALUE 2695.
  1055     12  ER-2701                 PIC  9(4) VALUE 2701.
  1056     12  ER-2720                 PIC  9(4) VALUE 2720.
  1057     12  ER-2709                 PIC  9(4) VALUE 2709.
  1058     12  ER-2704                 PIC  9(4) VALUE 2704.
  1059     12  ER-2725                 PIC  9(4) VALUE 2725.
  1060     12  ER-2726                 PIC  9(4) VALUE 2726.
  1061     12  ER-2728                 PIC  9(4) VALUE 2728.
  1062     12  ER-2729                 PIC  9(4) VALUE 2729.
  1063     12  ER-2731                 PIC  9(4) VALUE 2731.
  1064     12  ER-2732                 PIC  9(4) VALUE 2732.
  1065     12  ER-2733                 PIC  9(4) VALUE 2733.
  1066     12  ER-2735                 PIC  9(4) VALUE 2735.
  1067     12  ER-2738                 PIC  9(4) VALUE 2738.
  1068     12  ER-2742                 PIC  9(4) VALUE 2742.
  1069     12  ER-2743                 PIC  9(4) VALUE 2743.
  1070     12  ER-2744                 PIC  9(4) VALUE 2744.
  1071     12  ER-2747                 PIC  9(4) VALUE 2747.
  1072     12  ER-2749                 PIC  9(4) VALUE 2749.
  1073     12  ER-2753                 PIC  9(4) VALUE 2753.
  1074     12  ER-2755                 PIC  9(4) VALUE 2755.
  1075     12  ER-2757                 PIC  9(4) VALUE 2757.
  1076     12  ER-2771                 PIC  9(4) VALUE 2771.
  1077     12  ER-2774                 PIC  9(4) VALUE 2774.
  1078     12  ER-2775                 PIC  9(4) VALUE 2775.
  1079     12  ER-2776                 PIC  9(4) VALUE 2776.
  1080     12  ER-2777                 PIC  9(4) VALUE 2777.
  1081     12  ER-2794                 PIC  9(4) VALUE 2794.
  1082     12  ER-2799                 PIC  9(4) VALUE 2799.
  1083     12  ER-2900                 PIC  9(4) VALUE 2900.
  1084     12  ER-2902                 PIC  9(4) VALUE 2902.
  1085     12  ER-2945                 PIC  9(4) VALUE 2945.
  1086     12  ER-3000                 PIC  9(4) VALUE 3000.
  1087     12  ER-3006                 PIC  9(4) VALUE 3006.
  1088     12  ER-3054                 PIC  9(4) VALUE 3054.
  1089     12  ER-3224                 PIC  9(4) VALUE 3224.
  1090     12  ER-3269                 PIC  9(4) VALUE 3269.
  1091     12  er-3444                 pic  9(4) value 3444.
  1092     12  er-3446                 pic  9(4) value 3446.
  1093     12  er-3447                 pic  9(4) value 3447.
  1094     12  er-3448                 pic  9(4) value 3448.
  1095     12  er-3449                 pic  9(4) value 3449.
  1096     12  ER-3456                 PIC  9(4) VALUE 3456.
  1097     12  ER-3457                 PIC  9(4) VALUE 3457.
  1098     12  ER-3458                 PIC  9(4) VALUE 3458.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  22
* EL6311.cbl
  1099     12  ER-3504                 PIC  9(4) VALUE 3504.
  1100     12  ER-3513                 PIC  9(4) VALUE 3513.
  1101     12  ER-3831                 PIC  9(4) VALUE 3831.
  1102     12  ER-3834                 PIC  9(4) VALUE 3834.
  1103     12  ER-3835                 PIC  9(4) VALUE 3835.
  1104     12  ER-4005                 PIC  9(4) VALUE 4005.
  1105     12  ER-7144                 PIC  9(4) VALUE 7144.
  1106     12  ER-7401                 PIC  9(4) VALUE 7401.
  1107     12  ER-7402                 PIC  9(4) VALUE 7402.
  1108     12  ER-7403                 PIC  9(4) VALUE 7403.
  1109     12  ER-7404                 PIC  9(4) VALUE 7404.
  1110     12  ER-7423                 PIC  9(4) VALUE 7423.
  1111     12  ER-7424                 PIC  9(4) VALUE 7424.
  1112     12  ER-7433                 PIC  9(4) VALUE 7433.
  1113     12  ER-7450                 PIC  9(4) VALUE 7450.
  1114     12  ER-7451                 PIC  9(4) VALUE 7451.
  1115     12  ER-7530                 PIC  9(4) VALUE 7530.
  1116     12  ER-7573                 PIC  9(4) VALUE 7573.
  1117     12  ER-7631                 PIC  9(4) VALUE 7631.
  1118     12  ER-7632                 PIC  9(4) VALUE 7632.
  1119     12  ER-7633                 PIC  9(4) VALUE 7633.
  1120     12  ER-7537                 PIC  9(4) VALUE 7537.
  1121     12  ER-7538                 PIC  9(4) VALUE 7538.
  1122     12  ER-7574                 PIC  9(4) VALUE 7574.
  1123     12  ER-7997                 PIC  9(4) VALUE 7997.
  1124     12  ER-7998                 PIC  9(4) VALUE 7998.
  1125     12  ER-8148                 PIC  9(4) VALUE 8148.
  1126     12  ER-9063                 PIC  9(4) VALUE 9063.
  1127     12  ER-9076                 PIC  9(4) VALUE 9076.
  1128     12  ER-9618                 PIC  9(4) VALUE 9618.
  1129     12  ER-9841                 PIC  9(4) VALUE 9841.
  1130
  1131*                                COPY ELCTEXT.
  1132******************************************************************
  1133*                                                                *
  1134*                                                                *
  1135*                            ELCTEXT.                            *
  1136*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1137*                            VMOD=2.008                          *
  1138*                                                                *
  1139*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1140*                                     FORM LETTERS,              *
  1141*                                     CERT FORM DISPLAY.
  1142*                                                                *
  1143*   FILE TYPE = VSAM,KSDS                                        *
  1144*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1145*                                                                *
  1146*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1147*       ALTERNATE INDEX = NONE                                   *
  1148*                                                                *
  1149*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1150*       ALTERNATE INDEX = NONE                                   *
  1151*                                                                *
  1152*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1153*       ALTERNATE INDEX = NONE                                   *
  1154*                                                                *
  1155*   LOG = NO                                                     *
  1156*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  23
* EL6311.cbl
  1157******************************************************************
  1158 01  TEXT-FILES.
  1159     12  TEXT-FILE-ID                PIC XX.
  1160         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1161         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1162         88  HELP-FILE-TEXT             VALUE 'TH'.
  1163
  1164     12  TX-CONTROL-PRIMARY.
  1165         16  TX-COMPANY-CD           PIC X.
  1166             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1167         16  TX-ACCESS-CD-GENL       PIC X(12).
  1168
  1169         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1170             20  TX-LETTER-NO        PIC X(4).
  1171             20  FILLER              PIC X(8).
  1172
  1173         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1174             20  TX-FORM-NO          PIC X(12).
  1175
  1176         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1177             20  TX-HELP-TYPE        PIC X.
  1178                 88  HELP-FOR-GENERAL   VALUE ' '.
  1179                 88  HELP-BY-SCREEN     VALUE 'S'.
  1180                 88  HELP-BY-ERROR      VALUE 'E'.
  1181             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1182                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1183             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1184                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1185             20  FILLER              PIC X(4).
  1186
  1187         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1188
  1189     12  TX-PROCESS-CONTROL          PIC XX.
  1190         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1191
  1192     12  TX-TEXT-LINE                PIC X(70).
  1193
  1194     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1195         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1196         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1197         88  TX-VALID-FORM-SQUEEZE-VALUE
  1198                                        VALUE 'Y' ' '.
  1199
  1200     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1201         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1202         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1203         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1204         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1205         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1206         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1207         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1208                                              'K' 'N' ' '
  1209                                              'Z'.
  1210
  1211     12  TX-ARCHIVE-SW               PIC X.
  1212         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1213         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1214         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  24
* EL6311.cbl
  1215
  1216     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1217     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1218
  1219     12  TX-BSR-CODE                 PIC X.
  1220         88  TX-BSR-LETTER              VALUE 'B'.
  1221         88  TX-NON-BSR-LETTER          VALUE ' '.
  1222
  1223     12  FILLER                      PIC X.
  1224*****************************************************************
  1225*                                COPY ELCCRTO.
  1226******************************************************************
  1227*                                                                *
  1228*                            ELCCRTO.                            *
  1229*                                                                *
  1230*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  1231*                                                                *
  1232*   FILE TYPE = VSAM,KSDS                                        *
  1233*   RECORD SIZE = 524  RECFORM = FIXED                           *
  1234*                                                                *
  1235*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  1236*                                                                *
  1237*   LOG = YES                                                    *
  1238*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1239******************************************************************
  1240*                   C H A N G E   L O G
  1241*
  1242* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1243*-----------------------------------------------------------------
  1244*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1245* EFFECTIVE    NUMBER
  1246*-----------------------------------------------------------------
  1247* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  1248* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  1249* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  1250* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1251* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  1252******************************************************************
  1253 01  ORIGINAL-CERTIFICATE.
  1254     12  OC-RECORD-ID                      PIC XX.
  1255         88  VALID-OC-ID                      VALUE 'OC'.
  1256     12  OC-CONTROL-PRIMARY.
  1257         16  OC-COMPANY-CD                 PIC X.
  1258         16  OC-CARRIER                    PIC X.
  1259         16  OC-GROUPING                   PIC X(6).
  1260         16  OC-STATE                      PIC XX.
  1261         16  OC-ACCOUNT                    PIC X(10).
  1262         16  OC-CERT-EFF-DT                PIC XX.
  1263         16  OC-CERT-NO.
  1264             20  OC-CERT-PRIME             PIC X(10).
  1265             20  OC-CERT-SFX               PIC X.
  1266         16  OC-RECORD-TYPE                PIC X.
  1267         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  1268     12  OC-LAST-MAINT-DT                  PIC XX.
  1269     12  OC-LAST-MAINT-BY                  PIC X(4).
  1270     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  1271     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  1272     12  FILLER                            PIC X(49).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  25
* EL6311.cbl
  1273     12  OC-ORIG-REC.
  1274         16  OC-INS-LAST-NAME              PIC X(15).
  1275         16  OC-INS-FIRST-NAME             PIC X(10).
  1276         16  OC-INS-MIDDLE-INIT            PIC X.
  1277         16  OC-INS-AGE                    PIC S999     COMP-3.
  1278         16  OC-JNT-LAST-NAME              PIC X(15).
  1279         16  OC-JNT-FIRST-NAME             PIC X(10).
  1280         16  OC-JNT-MIDDLE-INIT            PIC X.
  1281         16  OC-JNT-AGE                    PIC S999     COMP-3.
  1282         16  OC-LF-BENCD                   PIC XX.
  1283         16  OC-LF-TERM                    PIC S999      COMP-3.
  1284         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1285         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1286         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  1287         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  1288         16  OC-LF-EXP-DT                  PIC XX.
  1289         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  1290         16  OC-LF-CANCEL-DT               PIC XX.
  1291         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1292         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1293         16  OC-AH-BENCD                   PIC XX.
  1294         16  OC-AH-TERM                    PIC S999      COMP-3.
  1295         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  1296         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  1297         16  OC-AH-EXP-DT                  PIC XX.
  1298         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1299         16  OC-AH-CP                      PIC 99.
  1300         16  OC-AH-CANCEL-DT               PIC XX.
  1301         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  1302         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1303         16  OC-CRED-BENE-NAME             PIC X(25).
  1304         16  OC-1ST-PMT-DT                 PIC XX.
  1305         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  1306         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  1307         16  OC-ISSUE-TRAN-IND             PIC X.
  1308         16  OC-CANCEL-TRAN-IND            PIC X.
  1309         16  FILLER                        PIC X(211).
  1310
  1311     12  FILLER                            PIC X(50).
  1312******************************************************************
  1313*                                COPY ERCACCT.
  1314******************************************************************
  1315*                                                                *
  1316*                                                                *
  1317*                            ERCACCT                             *
  1318*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1319*                            VMOD=2.031                          *
  1320*                                                                *
  1321*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1322*                                                                *
  1323*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1324*   VSAM ACCOUNT MASTER FILES.                                   *
  1325*                                                                *
  1326*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1327*                                                                *
  1328*   FILE TYPE = VSAM,KSDS                                        *
  1329*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1330*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  26
* EL6311.cbl
  1331*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1332*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1333*                                                                *
  1334*   LOG = NO                                                     *
  1335*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1336*                                                                *
  1337*                                                                *
  1338******************************************************************
  1339*                   C H A N G E   L O G
  1340*
  1341* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1342*-----------------------------------------------------------------
  1343*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1344* EFFECTIVE    NUMBER
  1345*-----------------------------------------------------------------
  1346* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1347* 092705    2005050300006  PEMA  ADD SPP LEASES
  1348* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1349* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1350* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1351* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1352* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1353* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1354******************************************************************
  1355
  1356 01  ACCOUNT-MASTER.
  1357     12  AM-RECORD-ID                      PIC XX.
  1358         88  VALID-AM-ID                      VALUE 'AM'.
  1359
  1360     12  AM-CONTROL-PRIMARY.
  1361         16  AM-COMPANY-CD                 PIC X.
  1362         16  AM-MSTR-CNTRL.
  1363             20  AM-CONTROL-A.
  1364                 24  AM-CARRIER            PIC X.
  1365                 24  AM-GROUPING.
  1366                     28 AM-GROUPING-PREFIX PIC XXX.
  1367                     28 AM-GROUPING-PRIME  PIC XXX.
  1368                 24  AM-STATE              PIC XX.
  1369                 24  AM-ACCOUNT.
  1370                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1371                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1372             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1373                                           PIC X(19).
  1374             20  AM-CNTRL-B.
  1375                 24  AM-EXPIRATION-DT      PIC XX.
  1376                 24  FILLER                PIC X(4).
  1377             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1378                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1379
  1380     12  AM-CONTROL-BY-VAR-GRP.
  1381         16  AM-COMPANY-CD-A1              PIC X.
  1382         16  AM-VG-CARRIER                 PIC X.
  1383         16  AM-VG-GROUPING                PIC X(6).
  1384         16  AM-VG-STATE                   PIC XX.
  1385         16  AM-VG-ACCOUNT                 PIC X(10).
  1386         16  AM-VG-DATE.
  1387             20  AM-VG-EXPIRATION-DT       PIC XX.
  1388             20  FILLER                    PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  27
* EL6311.cbl
  1389         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1390                                           PIC 9(11)      COMP-3.
  1391     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1392         16  FILLER                        PIC X(10).
  1393         16  AM-VG-KEY3.
  1394             20  AM-VG3-ACCOUNT            PIC X(10).
  1395             20  AM-VG3-EXP-DT             PIC XX.
  1396         16  FILLER                        PIC X(4).
  1397     12  AM-MAINT-INFORMATION.
  1398         16  AM-LAST-MAINT-DT              PIC XX.
  1399         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1400         16  AM-LAST-MAINT-USER            PIC X(4).
  1401         16  FILLER                        PIC XX.
  1402
  1403     12  AM-EFFECTIVE-DT                   PIC XX.
  1404     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1405
  1406     12  AM-PREV-DATES  COMP-3.
  1407         16  AM-PREV-EXP-DT                PIC 9(11).
  1408         16  AM-PREV-EFF-DT                PIC 9(11).
  1409
  1410     12  AM-REPORT-CODE-1                  PIC X(10).
  1411     12  AM-REPORT-CODE-2                  PIC X(10).
  1412
  1413     12  AM-CITY-CODE                      PIC X(4).
  1414     12  AM-COUNTY-PARISH                  PIC X(6).
  1415
  1416     12  AM-NAME                           PIC X(30).
  1417     12  AM-PERSON                         PIC X(30).
  1418     12  AM-ADDRS                          PIC X(30).
  1419     12  AM-CITY.
  1420         16  AM-ADDR-CITY                  PIC X(28).
  1421         16  AM-ADDR-STATE                 PIC XX.
  1422     12  AM-ZIP.
  1423         16  AM-ZIP-PRIME.
  1424             20  AM-ZIP-PRI-1ST            PIC X.
  1425                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1426             20  FILLER                    PIC X(4).
  1427         16  AM-ZIP-PLUS4                  PIC X(4).
  1428     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1429         16  AM-CAN-POSTAL-1               PIC XXX.
  1430         16  AM-CAN-POSTAL-2               PIC XXX.
  1431         16  FILLER                        PIC XXX.
  1432     12  AM-TEL-NO.
  1433         16  AM-AREA-CODE                  PIC 999.
  1434         16  AM-TEL-PRE                    PIC 999.
  1435         16  AM-TEL-NBR                    PIC 9(4).
  1436     12  AM-TEL-LOC                        PIC X.
  1437         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1438         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1439
  1440     12  AM-COMM-STRUCTURE.
  1441         16  AM-DEFN-1.
  1442             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1443                 24  AM-AGT.
  1444                     28  AM-AGT-PREFIX     PIC X(4).
  1445                     28  AM-AGT-PRIME      PIC X(6).
  1446                 24  AM-COM-TYP            PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  28
* EL6311.cbl
  1447                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1448                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1449                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1450                 24  AM-RECALC-LV-INDIC    PIC X.
  1451                 24  AM-RETRO-LV-INDIC     PIC X.
  1452                 24  AM-GL-CODES           PIC X.
  1453                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1454                 24  FILLER                PIC X(01).
  1455         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1456             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1457                 24  FILLER                PIC X(11).
  1458                 24  AM-L-COMA             PIC XXX.
  1459                 24  AM-J-COMA             PIC XXX.
  1460                 24  AM-A-COMA             PIC XXX.
  1461                 24  FILLER                PIC X(6).
  1462
  1463     12  AM-COMM-CHANGE-STATUS             PIC X.
  1464         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1465
  1466     12  AM-CSR-CODE                       PIC X(4).
  1467
  1468     12  AM-BILLING-STATUS                 PIC X.
  1469         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1470         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1471     12  AM-AUTO-REFUND-SW                 PIC X.
  1472         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1473         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1474     12  AM-GPCD                           PIC 99.
  1475     12  AM-IG                             PIC X.
  1476         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1477         88  AM-HAS-GROUP                     VALUE '2'.
  1478     12  AM-STATUS                         PIC X.
  1479         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1480         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1481         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1482         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1483         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1484         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1485         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1486         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  1487         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1488         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1489     12  AM-REMIT-TO                       PIC 99.
  1490     12  AM-ID-NO                          PIC X(11).
  1491
  1492     12  AM-CAL-TABLE                      PIC XX.
  1493     12  AM-LF-DEVIATION                   PIC XXX.
  1494     12  AM-AH-DEVIATION                   PIC XXX.
  1495     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1496     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1497     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1498     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1499     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1500     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1501
  1502     12  AM-USER-FIELDS.
  1503         16  AM-FLD-1                      PIC XX.
  1504         16  AM-FLD-2                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  29
* EL6311.cbl
  1505         16  AM-FLD-3                      PIC XX.
  1506         16  AM-FLD-4                      PIC XX.
  1507         16  AM-FLD-5                      PIC XX.
  1508
  1509     12  AM-1ST-PROD-DATE.
  1510         16  AM-1ST-PROD-YR                PIC XX.
  1511         16  AM-1ST-PROD-MO                PIC XX.
  1512         16  AM-1ST-PROD-DA                PIC XX.
  1513     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1514     12  AM-CERTS-PURGED-DATE.
  1515         16  AM-PUR-YR                     PIC XX.
  1516         16  AM-PUR-MO                     PIC XX.
  1517         16  AM-PUR-DA                     PIC XX.
  1518     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1519     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1520     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1521     12  AM-INACTIVE-DATE.
  1522         16  AM-INA-MO                     PIC 99.
  1523         16  AM-INA-DA                     PIC 99.
  1524         16  AM-INA-YR                     PIC 99.
  1525     12  AM-AR-HI-CERT-DATE                PIC XX.
  1526
  1527     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1528     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1529
  1530     12  AM-OB-PAYMENT-MODE                PIC X.
  1531         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1532         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1533         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1534         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1535
  1536     12  AM-AH-ONLY-INDICATOR              PIC X.
  1537         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1538         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1539
  1540     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1541
  1542     12  AM-OVER-SHORT.
  1543         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1544         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1545
  1546     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1547     12  AM-DCC-CLP-STATE                  PIC XX.
  1548
  1549     12  AM-RECALC-COMM                    PIC X.
  1550     12  AM-RECALC-REIN                    PIC X.
  1551
  1552     12  AM-REI-TABLE                      PIC XXX.
  1553     12  AM-REI-ET-LF                      PIC X.
  1554     12  AM-REI-ET-AH                      PIC X.
  1555     12  AM-REI-PE-LF                      PIC X.
  1556     12  AM-REI-PE-AH                      PIC X.
  1557     12  AM-REI-PRT-ST                     PIC X.
  1558     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1559     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1560     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1561     12  AM-REI-GROUP-A                    PIC X(6).
  1562     12  AM-REI-MORT                       PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  30
* EL6311.cbl
  1563     12  AM-REI-PRT-OW                     PIC X.
  1564     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1565     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1566     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1567     12  AM-REI-GROUP-B                    PIC X(6).
  1568
  1569     12  AM-TRUST-TYPE                     PIC X(2).
  1570
  1571     12  AM-EMPLOYER-STMT-USED             PIC X.
  1572     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1573
  1574     12  AM-STD-AH-TYPE                    PIC XX.
  1575     12  AM-EARN-METHODS.
  1576         16  AM-EARN-METHOD-R              PIC X.
  1577             88 AM-REF-RL-R78                 VALUE 'R'.
  1578             88 AM-REF-RL-PR                  VALUE 'P'.
  1579             88 AM-REF-RL-MEAN                VALUE 'M'.
  1580             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1581         16  AM-EARN-METHOD-L              PIC X.
  1582             88 AM-REF-LL-R78                 VALUE 'R'.
  1583             88 AM-REF-LL-PR                  VALUE 'P'.
  1584             88 AM-REF-LL-MEAN                VALUE 'M'.
  1585             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1586         16  AM-EARN-METHOD-A              PIC X.
  1587             88 AM-REF-AH-R78                 VALUE 'R'.
  1588             88 AM-REF-AH-PR                  VALUE 'P'.
  1589             88 AM-REF-AH-MEAN                VALUE 'M'.
  1590             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1591             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1592             88 AM-REF-AH-NET                 VALUE 'N'.
  1593
  1594     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1595     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1596     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1597
  1598     12  AM-RET-Y-N                        PIC X.
  1599     12  AM-RET-P-E                        PIC X.
  1600     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1601     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1602     12  AM-RET-GRP                        PIC X(6).
  1603     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1604         16  AM-POOL-PRIME                 PIC XXX.
  1605         16  AM-POOL-SUB                   PIC XXX.
  1606     12  AM-RETRO-EARNINGS.
  1607         16  AM-RET-EARN-R                 PIC X.
  1608         16  AM-RET-EARN-L                 PIC X.
  1609         16  AM-RET-EARN-A                 PIC X.
  1610     12  AM-RET-ST-TAX-USE                 PIC X.
  1611         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1612         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1613     12  AM-RETRO-BEG-EARNINGS.
  1614         16  AM-RET-BEG-EARN-R             PIC X.
  1615         16  AM-RET-BEG-EARN-L             PIC X.
  1616         16  AM-RET-BEG-EARN-A             PIC X.
  1617     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1618     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1619
  1620     12  AM-USER-SELECT-OPTIONS.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  31
* EL6311.cbl
  1621         16  AM-USER-SELECT-1              PIC X(10).
  1622         16  AM-USER-SELECT-2              PIC X(10).
  1623         16  AM-USER-SELECT-3              PIC X(10).
  1624         16  AM-USER-SELECT-4              PIC X(10).
  1625         16  AM-USER-SELECT-5              PIC X(10).
  1626
  1627     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1628
  1629     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1630
  1631     12  AM-RPT045A-SWITCH                 PIC X.
  1632         88  RPT045A-OFF                   VALUE 'N'.
  1633
  1634     12  AM-INSURANCE-LIMITS.
  1635         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1636         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1637
  1638     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1639         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1640
  1641     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1642         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1643         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1644
  1645     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1646
  1647     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1648     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1649     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1650     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1651     12  AM-DCC-UEF-STATE                  PIC XX.
  1652     12  FILLER                            PIC XXX.
  1653     12  AM-REPORT-CODE-3                  PIC X(10).
  1654*    12  FILLER                            PIC X(22).
  1655
  1656     12  AM-RESERVE-DATE.
  1657         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1658         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1659         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1660
  1661     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1662     12  AM-NOTIFICATION-TYPES.
  1663         16  AM-NOTIF-OF-LETTERS           PIC X.
  1664         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1665         16  AM-NOTIF-OF-REPORTS           PIC X.
  1666         16  AM-NOTIF-OF-STATUS            PIC X.
  1667
  1668     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1669         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1670         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1671         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1672         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1673
  1674     12  AM-BENEFIT-CONTROLS.
  1675         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1676             20  AM-BENEFIT-CODE           PIC XX.
  1677             20  AM-BENEFIT-TYPE           PIC X.
  1678             20  AM-BENEFIT-REVISION       PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  32
* EL6311.cbl
  1679             20  AM-BENEFIT-REM-TERM       PIC X.
  1680             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1681             20  FILLER                    PIC XX.
  1682         16  FILLER                        PIC X(80).
  1683
  1684     12  AM-TRANSFER-DATA.
  1685         16  AM-TRANSFERRED-FROM.
  1686             20  AM-TRNFROM-CARRIER        PIC X.
  1687             20  AM-TRNFROM-GROUPING.
  1688                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1689                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1690             20  AM-TRNFROM-STATE          PIC XX.
  1691             20  AM-TRNFROM-ACCOUNT.
  1692                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1693                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1694             20  AM-TRNFROM-DTE            PIC XX.
  1695         16  AM-TRANSFERRED-TO.
  1696             20  AM-TRNTO-CARRIER          PIC X.
  1697             20  AM-TRNTO-GROUPING.
  1698                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1699                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1700             20  AM-TRNTO-STATE            PIC XX.
  1701             20  AM-TRNTO-ACCOUNT.
  1702                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1703                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1704             20  AM-TRNTO-DTE              PIC XX.
  1705         16  FILLER                        PIC X(10).
  1706
  1707     12  AM-SAVED-REMIT-TO                 PIC 99.
  1708
  1709     12  AM-COMM-STRUCTURE-SAVED.
  1710         16  AM-DEFN-1-SAVED.
  1711             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1712                 24  AM-AGT-SV             PIC X(10).
  1713                 24  AM-COM-TYP-SV         PIC X.
  1714                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1715                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1716                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1717                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1718                 24  FILLER                PIC X.
  1719                 24  AM-GL-CODES-SV        PIC X.
  1720                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1721                 24  FILLER                PIC X.
  1722         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1723             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1724                 24  FILLER                PIC X(11).
  1725                 24  AM-L-COMA-SV          PIC XXX.
  1726                 24  AM-J-COMA-SV          PIC XXX.
  1727                 24  AM-A-COMA-SV          PIC XXX.
  1728                 24  FILLER                PIC X(6).
  1729
  1730     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1731         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1732            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1733            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1734            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1735
  1736     12  AM-ORIG-DEALER-NO                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  33
* EL6311.cbl
  1737     12  FILLER                            PIC X(120).
  1738
  1739     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1740         16  AM-CONTROL-NAME               PIC X(30).
  1741         16  AM-EXECUTIVE-ONE.
  1742             20  AM-EXEC1-NAME             PIC X(15).
  1743             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1744                                                          COMP-3.
  1745             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1746                                                          COMP-3.
  1747         16  AM-EXECUTIVE-TWO.
  1748             20  AM-EXEC2-NAME             PIC X(15).
  1749             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1750                                                          COMP-3.
  1751             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1752                                                          COMP-3.
  1753
  1754     12  AM-RETRO-ADDITIONAL-DATA.
  1755         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1756         16  AM-RETRO-PREM-P-E             PIC X.
  1757         16  AM-RETRO-CLMS-P-I             PIC X.
  1758         16  AM-RETRO-RET-BRACKET-LF.
  1759             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1760                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1761                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1762             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1763                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1764                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1765             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1766                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1767                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1768         16  AM-RETRO-RET-BRACKET-AH.
  1769             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1770                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1771                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1772                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1773             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1774                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1775                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1776             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1777                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1778                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1779
  1780     12  AM-COMMENTS.
  1781         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1782
  1783     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1784         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1785         16  AM-FLI-BILLING-CODE           PIC X.
  1786         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1787         16  AM-FLI-UNITED-IDENT           PIC X.
  1788         16  AM-FLI-INTEREST-LOST-DATA.
  1789             20  AM-FLI-BANK-NO            PIC X(5).
  1790             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1791             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1792             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1793         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1794             20  AM-FLI-AGT                PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  34
* EL6311.cbl
  1795             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1796             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1797         16  FILLER                        PIC X(102).
  1798
  1799     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1800         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1801             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1802             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1803             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1804             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1805             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1806         16  FILLER                          PIC X(10).
  1807******************************************************************
  1808*                                COPY ELCVADS.
  1809******************************************************************
  1810*                                                                *
  1811*                                                                *
  1812*                            ELCVADS.                            *
  1813*                                                                *
  1814*   FILE DESCRIPTION = VIRGINIA DISLCOSURE FIELDS PASSED TO      *
  1815*   ELVADS                  LENGTH = 350                         *
  1816******************************************************************
  1817******************************************************************
  1818*                   C H A N G E   L O G
  1819*
  1820* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1821*-----------------------------------------------------------------
  1822*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1823* EFFECTIVE    NUMBER
  1824*-----------------------------------------------------------------
  1825* 100111    2011022800001  AJRA  NAPERSOFT
  1826******************************************************************
  1827
  1828 01  VIRGINIA-DISCLOSURE.
  1829     12  VD-COMPANY-CD              PIC X.
  1830     12  VD-CARRIER                 PIC X.
  1831     12  VD-GROUPING.
  1832         20  VD-GROUPING-PREFIX     PIC XXX.
  1833         20  VD-GROUPING-PRIME      PIC XXX.
  1834     12  VD-STATE                   PIC XX.
  1835     12  VD-ACCOUNT.
  1836         20  VD-ACCOUNT-PREFIX      PIC X(4).
  1837         20  VD-ACCOUNT-PRIME       PIC X(6).
  1838     12  VD-CERT-EFF-DT             PIC XX.
  1839     12  VD-CERT-NO.
  1840         20  VD-CERT-PRIME          PIC X(10).
  1841         20  VD-CERT-SFX            PIC X.
  1842     12  VD-ENTRY-BATCH             PIC X(6).
  1843     12  VD-CSR-ID                  PIC X(4).
  1844     12  VD-NAME.
  1845         20  VD-INSURED-LAST-NAME   PIC X(15).
  1846         20  VD-INSURED-FIRST-NAME.
  1847             24  VD-INSURED-1ST-INIT PIC X.
  1848             24  FILLER             PIC X(9).
  1849         20  VD-INSURED-MIDDLE-INIT PIC X.
  1850     12  VD-JOINT-INSURED.
  1851         20 VD-JOINT-LAST-NAME      PIC X(15).
  1852         20 VD-JOINT-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  35
* EL6311.cbl
  1853            24  VD-JOINT-FIRST-INIT PIC X.
  1854            24  FILLER              PIC X(9).
  1855         20 VD-JOINT-MIDDLE-INIT    PIC X.
  1856     12  VD-INSURED-ADDRESS-1       PIC X(30).
  1857     12  VD-INSURED-ADDRESS-2       PIC X(30).
  1858     12  VD-INSURED-CITY-STATE.
  1859         20  VD-INSURED-CITY        PIC X(28).
  1860         20  VD-INSURED-STATE       PIC XX.
  1861     12  VD-INSURED-ZIP-CODE.
  1862         20  VD-INSURED-ZIP-PRIME.
  1863             24  VD-INSURED-ZIP-1   PIC X.
  1864                 88  VD-CANADIAN-POST-CODE
  1865                                       VALUE 'A' THRU 'Z'.
  1866             24  FILLER             PIC X(4).
  1867         20  VD-INSURED-ZIP-PLUS4   PIC X(4).
  1868     12  VD-BENEFICIARY-NAME        PIC X(30).
  1869     12  VD-ACCOUNT-NAME            PIC X(30).
  1870     12  VD-LOAN-TERM               PIC S999   COMP-3.
  1871     12  VD-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1872     12  VD-1ST-PMT-DT              PIC XX.
  1873     12  VD-LIFE-BENEFIT-CD         PIC XX.
  1874         88  VD-VALID-LIFE             VALUE '01' THRU '89'.
  1875         88  VD-INVALID-LIFE           VALUE '  ' '00'
  1876                                             '90' THRU '99'.
  1877     12  VD-LF-BENEFIT-CD   REDEFINES VD-LIFE-BENEFIT-CD
  1878                                    PIC XX.
  1879     12  VD-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1880     12  VD-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1881     12  VD-LF-RATE                 PIC S99V9(5)   COMP-3.
  1882     12  VD-LF-TERM                 PIC S999   COMP-3.
  1883     12  VD-AH-BENEFIT-CD           PIC XX.
  1884         88  VD-VALID-AH               VALUE '01' THRU '89'.
  1885         88  VD-INVALID-AH             VALUE '  ' '00'
  1886                                             '90' THRU '99'.
  1887     12  VD-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1888     12  VD-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1889     12  VD-AH-RATE                 PIC S99V9(5)   COMP-3.
  1890     12  VD-AH-TERM                 PIC S999   COMP-3.
  1891     12  VD-LETTER-ID               PIC X(4).
  1892     12  VD-PROC-ID                 PIC X(4).
  1893     12  VD-COMP-ID                 PIC X(3).
  1894     12  VD-CURRENT-DATE            PIC XX.
  1895     12  VD-CURRENT-TIME            PIC S9(6) COMP-3.
  1896     12  VD-ARCHIVE-NO              PIC S9(08) COMP VALUE +0.
  1897     12  FILLER                     PIC X(32).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  36
* EL6311.cbl
  1899*    COPY ELCDATE.
  1900******************************************************************
  1901*                                                                *
  1902*                                                                *
  1903*                            ELCDATE.                            *
  1904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1905*                            VMOD=2.003
  1906*                                                                *
  1907*                                                                *
  1908*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1909*                 LENGTH = 200                                   *
  1910******************************************************************
  1911
  1912 01  DATE-CONVERSION-DATA.
  1913     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1914     12  DC-OPTION-CODE                PIC X.
  1915         88  BIN-TO-GREG                VALUE ' '.
  1916         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1917         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1918         88  YMD-GREG-TO-BIN            VALUE '3'.
  1919         88  MDY-GREG-TO-BIN            VALUE '4'.
  1920         88  JULIAN-TO-BIN              VALUE '5'.
  1921         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1922         88  FIND-CENTURY               VALUE '7'.
  1923         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1924         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1925         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1926         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1927         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1928         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1929         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1930         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1931         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1932         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1933         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1934         88  BIN-3-TO-GREG              VALUE 'I'.
  1935         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1936         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1937         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1938         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1939         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1940         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1941         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1942         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1943         88  THREE-CHARACTER-BIN
  1944                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1945         88  GREGORIAN-TO-BIN
  1946                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1947         88  BIN-TO-GREGORIAN
  1948                  VALUES ' ' '1' 'I' '8' 'G'.
  1949         88  JULIAN-TO-BINARY
  1950                  VALUES '5' 'C' 'E' 'F'.
  1951     12  DC-ERROR-CODE                 PIC X.
  1952         88  NO-CONVERSION-ERROR        VALUE ' '.
  1953         88  DATE-CONVERSION-ERROR
  1954                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1955         88  DATE-IS-ZERO               VALUE '1'.
  1956         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  37
* EL6311.cbl
  1957         88  DATE-IS-INVALID            VALUE '3'.
  1958         88  DATE1-GREATER-DATE2        VALUE '4'.
  1959         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1960         88  DATE-INVALID-OPTION        VALUE '9'.
  1961         88  INVALID-CENTURY            VALUE 'A'.
  1962         88  ONLY-CENTURY               VALUE 'B'.
  1963         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1964         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1965     12  DC-END-OF-MONTH               PIC X.
  1966         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1967     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1968         88  USE-NORMAL-PROCESS         VALUE ' '.
  1969         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1970         88  ADJUST-UP-100-YRS          VALUE '2'.
  1971     12  FILLER                        PIC X.
  1972     12  DC-CONVERSION-DATES.
  1973         16  DC-BIN-DATE-1             PIC XX.
  1974         16  DC-BIN-DATE-2             PIC XX.
  1975         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1976         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1977                       DC-GREG-DATE-1-EDIT.
  1978             20  DC-EDIT1-MONTH        PIC 99.
  1979             20  SLASH1-1              PIC X.
  1980             20  DC-EDIT1-DAY          PIC 99.
  1981             20  SLASH1-2              PIC X.
  1982             20  DC-EDIT1-YEAR         PIC 99.
  1983         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1984         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1985                     DC-GREG-DATE-2-EDIT.
  1986             20  DC-EDIT2-MONTH        PIC 99.
  1987             20  SLASH2-1              PIC X.
  1988             20  DC-EDIT2-DAY          PIC 99.
  1989             20  SLASH2-2              PIC X.
  1990             20  DC-EDIT2-YEAR         PIC 99.
  1991         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1992         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1993                     DC-GREG-DATE-1-YMD.
  1994             20  DC-YMD-YEAR           PIC 99.
  1995             20  DC-YMD-MONTH          PIC 99.
  1996             20  DC-YMD-DAY            PIC 99.
  1997         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1998         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1999                      DC-GREG-DATE-1-MDY.
  2000             20  DC-MDY-MONTH          PIC 99.
  2001             20  DC-MDY-DAY            PIC 99.
  2002             20  DC-MDY-YEAR           PIC 99.
  2003         16  DC-GREG-DATE-1-ALPHA.
  2004             20  DC-ALPHA-MONTH        PIC X(10).
  2005             20  DC-ALPHA-DAY          PIC 99.
  2006             20  FILLER                PIC XX.
  2007             20  DC-ALPHA-CENTURY.
  2008                 24 DC-ALPHA-CEN-N     PIC 99.
  2009             20  DC-ALPHA-YEAR         PIC 99.
  2010         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2011         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2012         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2013         16  DC-JULIAN-DATE            PIC 9(05).
  2014         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  38
* EL6311.cbl
  2015                                       PIC 9(05).
  2016         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2017             20  DC-JULIAN-YEAR        PIC 99.
  2018             20  DC-JULIAN-DAYS        PIC 999.
  2019         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2020         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2021         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2022     12  DATE-CONVERSION-VARIBLES.
  2023         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2024         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2025             20  FILLER                PIC 9(3).
  2026             20  HOLD-CEN-1-CCYY.
  2027                 24  HOLD-CEN-1-CC     PIC 99.
  2028                 24  HOLD-CEN-1-YY     PIC 99.
  2029             20  HOLD-CEN-1-MO         PIC 99.
  2030             20  HOLD-CEN-1-DA         PIC 99.
  2031         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2032             20  HOLD-CEN-1-R-MO       PIC 99.
  2033             20  HOLD-CEN-1-R-DA       PIC 99.
  2034             20  HOLD-CEN-1-R-CCYY.
  2035                 24  HOLD-CEN-1-R-CC   PIC 99.
  2036                 24  HOLD-CEN-1-R-YY   PIC 99.
  2037             20  FILLER                PIC 9(3).
  2038         16  HOLD-CENTURY-1-X.
  2039             20  FILLER                PIC X(3)  VALUE SPACES.
  2040             20  HOLD-CEN-1-X-CCYY.
  2041                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2042                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2043             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2044             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2045         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2046             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2047             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2048             20  HOLD-CEN-1-R-X-CCYY.
  2049                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2050                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2051             20  FILLER                PIC XXX.
  2052         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2053         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2054         16  DC-JULIAN-DATE-1          PIC 9(07).
  2055         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2056             20  DC-JULIAN-1-CCYY.
  2057                 24  DC-JULIAN-1-CC    PIC 99.
  2058                 24  DC-JULIAN-1-YR    PIC 99.
  2059             20  DC-JULIAN-DA-1        PIC 999.
  2060         16  DC-JULIAN-DATE-2          PIC 9(07).
  2061         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2062             20  DC-JULIAN-2-CCYY.
  2063                 24  DC-JULIAN-2-CC    PIC 99.
  2064                 24  DC-JULIAN-2-YR    PIC 99.
  2065             20  DC-JULIAN-DA-2        PIC 999.
  2066         16  DC-GREG-DATE-A-EDIT.
  2067             20  DC-EDITA-MONTH        PIC 99.
  2068             20  SLASHA-1              PIC X VALUE '/'.
  2069             20  DC-EDITA-DAY          PIC 99.
  2070             20  SLASHA-2              PIC X VALUE '/'.
  2071             20  DC-EDITA-CCYY.
  2072                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  39
* EL6311.cbl
  2073                 24  DC-EDITA-YEAR     PIC 99.
  2074         16  DC-GREG-DATE-B-EDIT.
  2075             20  DC-EDITB-MONTH        PIC 99.
  2076             20  SLASHB-1              PIC X VALUE '/'.
  2077             20  DC-EDITB-DAY          PIC 99.
  2078             20  SLASHB-2              PIC X VALUE '/'.
  2079             20  DC-EDITB-CCYY.
  2080                 24  DC-EDITB-CENT     PIC 99.
  2081                 24  DC-EDITB-YEAR     PIC 99.
  2082         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2083         16  DC-GREG-DATE-CYMD-R REDEFINES
  2084                              DC-GREG-DATE-CYMD.
  2085             20  DC-CYMD-CEN           PIC 99.
  2086             20  DC-CYMD-YEAR          PIC 99.
  2087             20  DC-CYMD-MONTH         PIC 99.
  2088             20  DC-CYMD-DAY           PIC 99.
  2089         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2090         16  DC-GREG-DATE-MDCY-R REDEFINES
  2091                              DC-GREG-DATE-MDCY.
  2092             20  DC-MDCY-MONTH         PIC 99.
  2093             20  DC-MDCY-DAY           PIC 99.
  2094             20  DC-MDCY-CEN           PIC 99.
  2095             20  DC-MDCY-YEAR          PIC 99.
  2096    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2097        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2098    12  DC-EL310-DATE                  PIC X(21).
  2099    12  FILLER                         PIC X(28).
  2100
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  40
* EL6311.cbl
  2102*    COPY ELCLOGOF.
  2103******************************************************************
  2104*                                                                *
  2105*                                                                *
  2106*                            ELCLOGOF.                           *
  2107*                            VMOD=2.001                          *
  2108*                                                                *
  2109*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2110*                                                                *
  2111******************************************************************
  2112 01  CLASIC-LOGOFF.
  2113     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2114     12  LOGOFF-TEXT.
  2115         16  FILLER          PIC X(5)    VALUE SPACES.
  2116         16  LOGOFF-MSG.
  2117             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2118             20  FILLER      PIC X       VALUE SPACES.
  2119             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2120         16  FILLER          PIC X(80)
  2121           VALUE '* YOU ARE NOW LOGGED OFF'.
  2122         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2123         16  FILLER          PIC X       VALUE QUOTE.
  2124         16  LOGOFF-SYS-MSG  PIC X(17)
  2125           VALUE 'S CLAS-IC SYSTEM '.
  2126     12  TEXT-MESSAGES.
  2127         16  UNACCESS-MSG    PIC X(29)
  2128             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2129         16  PGMIDERR-MSG    PIC X(17)
  2130             VALUE 'PROGRAM NOT FOUND'.
  2131
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  41
* EL6311.cbl
  2133*    COPY ELCATTR.
  2134******************************************************************
  2135*                                                                *
  2136*                            ELCATTR.                            *
  2137*                            VMOD=2.001                          *
  2138*                                                                *
  2139*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  2140*                                                                *
  2141*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  2142*                                                                *
  2143*                   POS 1   P=PROTECTED                          *
  2144*                           U=UNPROTECTED                        *
  2145*                           S=ASKIP                              *
  2146*                   POS 2   A=ALPHA/NUMERIC                      *
  2147*                           N=NUMERIC                            *
  2148*                   POS 3   N=NORMAL                             *
  2149*                           B=BRIGHT                             *
  2150*                           D=DARK                               *
  2151*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  2152*                           OF=MODIFIED DATA TAG OFF             *
  2153*                                                                *
  2154*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  2155******************************************************************
  2156 01  ATTRIBUTE-LIST.
  2157     12  AL-PABOF            PIC X       VALUE 'Y'.
  2158     12  AL-PABON            PIC X       VALUE 'Z'.
  2159     12  AL-PADOF            PIC X       VALUE '%'.
  2160     12  AL-PADON            PIC X       VALUE '_'.
  2161     12  AL-PANOF            PIC X       VALUE '-'.
  2162     12  AL-PANON            PIC X       VALUE '/'.
  2163     12  AL-SABOF            PIC X       VALUE '8'.
  2164     12  AL-SABON            PIC X       VALUE '9'.
  2165     12  AL-SADOF            PIC X       VALUE '@'.
  2166     12  AL-SADON            PIC X       VALUE QUOTE.
  2167     12  AL-SANOF            PIC X       VALUE '0'.
  2168     12  AL-SANON            PIC X       VALUE '1'.
  2169     12  AL-UABOF            PIC X       VALUE 'H'.
  2170     12  AL-UABON            PIC X       VALUE 'I'.
  2171     12  AL-UADOF            PIC X       VALUE '<'.
  2172     12  AL-UADON            PIC X       VALUE '('.
  2173     12  AL-UANOF            PIC X       VALUE ' '.
  2174     12  AL-UANON            PIC X       VALUE 'A'.
  2175     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2176     12  AL-UNBON            PIC X       VALUE 'R'.
  2177     12  AL-UNDOF            PIC X       VALUE '*'.
  2178     12  AL-UNDON            PIC X       VALUE ')'.
  2179     12  AL-UNNOF            PIC X       VALUE '&'.
  2180     12  AL-UNNON            PIC X       VALUE 'J'.
  2181
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  42
* EL6311.cbl
  2183*    COPY ELCEMIB.
  2184******************************************************************
  2185*                                                                *
  2186*                                                                *
  2187*                            ELCEMIB.                            *
  2188*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2189*                            VMOD=2.005                          *
  2190*                                                                *
  2191*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2192*                                                                *
  2193******************************************************************
  2194 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2195     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2196     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2197     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2198     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2199     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2200     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2201     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2202     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2203     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2204         88  EMI-NO-ERRORS                    VALUE '1'.
  2205         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2206         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2207     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2208         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2209     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2210         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2211         88  EMI-AREA1-FULL                   VALUE '2'.
  2212     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2213         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2214         88  EMI-AREA2-FULL                   VALUE '2'.
  2215     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2216         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2217         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2218         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2219         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2220         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2221     12  EMI-ERROR-LINES.
  2222         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2223         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2224         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2225         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2226             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2227                 24  EMI-ERR-NUM         PIC X(4).
  2228                 24  EMI-FILLER          PIC X.
  2229                 24  EMI-SEV             PIC X.
  2230                 24  FILLER              PIC X.
  2231             20  FILLER                  PIC X(02).
  2232     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2233         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2234             20  EMI-ERROR-NUMBER    PIC X(4).
  2235             20  EMI-FILL            PIC X.
  2236             20  EMI-SEVERITY        PIC X.
  2237             20  FILLER              PIC X.
  2238             20  EMI-ERROR-TEXT.
  2239                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2240                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  43
* EL6311.cbl
  2241     12  EMI-SEVERITY-SAVE           PIC X.
  2242         88  EMI-NOTE                    VALUE 'N'.
  2243         88  EMI-WARNING                 VALUE 'W'.
  2244         88  EMI-FORCABLE                VALUE 'F'.
  2245         88  EMI-FATAL                   VALUE 'X'.
  2246     12  EMI-MESSAGE-FLAG            PIC X.
  2247         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2248         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2249     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2250     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2251         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2252         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2253         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2254     12  emi-claim-no                pic x(7).
  2255     12  emi-claim-type              pic x(6).
  2256     12  FILLER                      PIC X(124)  VALUE SPACES.
  2257     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2258     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2259     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2260     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  2261
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  44
* EL6311.cbl
  2263*    COPY ELCINTF.
  2264******************************************************************
  2265*                                                                *
  2266*                                                                *
  2267*                            ELCINTF.                            *
  2268*                            VMOD=2.017                          *
  2269*                                                                *
  2270*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  2271*                                                                *
  2272*       LENGTH = 1024                                            *
  2273*                                                                *
  2274******************************************************************
  2275*                   C H A N G E   L O G
  2276*
  2277* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2278*-----------------------------------------------------------------
  2279*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2280* EFFECTIVE    NUMBER
  2281*-----------------------------------------------------------------
  2282* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2283******************************************************************
  2284 01  PROGRAM-INTERFACE-BLOCK.
  2285     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  2286     12  PI-CALLING-PROGRAM              PIC X(8).
  2287     12  PI-SAVED-PROGRAM-1              PIC X(8).
  2288     12  PI-SAVED-PROGRAM-2              PIC X(8).
  2289     12  PI-SAVED-PROGRAM-3              PIC X(8).
  2290     12  PI-SAVED-PROGRAM-4              PIC X(8).
  2291     12  PI-SAVED-PROGRAM-5              PIC X(8).
  2292     12  PI-SAVED-PROGRAM-6              PIC X(8).
  2293     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  2294     12  PI-COMPANY-ID                   PIC XXX.
  2295     12  PI-COMPANY-CD                   PIC X.
  2296
  2297     12  PI-COMPANY-PASSWORD             PIC X(8).
  2298
  2299     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  2300
  2301     12  PI-CONTROL-IN-PROGRESS.
  2302         16  PI-CARRIER                  PIC X.
  2303         16  PI-GROUPING                 PIC X(6).
  2304         16  PI-STATE                    PIC XX.
  2305         16  PI-ACCOUNT                  PIC X(10).
  2306         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  2307                                         PIC X(10).
  2308         16  PI-CLAIM-CERT-GRP.
  2309             20  PI-CLAIM-NO             PIC X(7).
  2310             20  PI-CERT-NO.
  2311                 25  PI-CERT-PRIME       PIC X(10).
  2312                 25  PI-CERT-SFX         PIC X.
  2313             20  PI-CERT-EFF-DT          PIC XX.
  2314         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  2315             20  PI-PLAN-CODE            PIC X(2).
  2316             20  PI-REVISION-NUMBER      PIC X(3).
  2317             20  PI-PLAN-EFF-DT          PIC X(2).
  2318             20  PI-PLAN-EXP-DT          PIC X(2).
  2319             20  FILLER                  PIC X(11).
  2320         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  45
* EL6311.cbl
  2321             20  PI-OE-REFERENCE-1.
  2322                 25  PI-OE-REF-1-PRIME   PIC X(18).
  2323                 25  PI-OE-REF-1-SUFF    PIC XX.
  2324
  2325     12  PI-SESSION-IN-PROGRESS          PIC X.
  2326         88  CLAIM-SESSION                   VALUE '1'.
  2327         88  CREDIT-SESSION                  VALUE '2'.
  2328         88  WARRANTY-SESSION                VALUE '3'.
  2329         88  MORTGAGE-SESSION                VALUE '4'.
  2330         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  2331
  2332
  2333*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  2334
  2335     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  2336     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  2337
  2338     12  PI-CREDIT-USER                  PIC X.
  2339         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  2340         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  2341
  2342     12  PI-CLAIM-USER                   PIC X.
  2343         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  2344         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  2345
  2346     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  2347         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  2348         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  2349         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  2350         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  2351         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  2352
  2353     12  PI-PROCESSOR-ID                 PIC X(4).
  2354
  2355     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  2356
  2357     12  PI-MEMBER-CAPTION               PIC X(10).
  2358
  2359     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  2360         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  2361
  2362     12  PI-LIFE-OVERRIDE-L1             PIC X.
  2363     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  2364     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  2365     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  2366
  2367     12  PI-AH-OVERRIDE-L1               PIC X.
  2368     12  PI-AH-OVERRIDE-L2               PIC XX.
  2369     12  PI-AH-OVERRIDE-L6               PIC X(6).
  2370     12  PI-AH-OVERRIDE-L12              PIC X(12).
  2371
  2372     12  PI-NEW-SYSTEM                   PIC X(2).
  2373
  2374     12  PI-PRIMARY-CERT-NO              PIC X(11).
  2375     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  2376         88  PI-USES-PAID-TO                 VALUE '1'.
  2377     12  PI-CRDTCRD-SYSTEM.
  2378         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  46
* EL6311.cbl
  2379             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  2380             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  2381         16  PI-CC-MONTH-END-DT          PIC XX.
  2382     12  PI-PROCESSOR-PRINTER            PIC X(4).
  2383
  2384     12  PI-OE-REFERENCE-2.
  2385         16  PI-OE-REF-2-PRIME           PIC X(10).
  2386         16  PI-OE-REF-2-SUFF            PIC X.
  2387
  2388     12  PI-REM-TRM-CALC-OPTION          PIC X.
  2389
  2390     12  PI-LANGUAGE-TYPE                PIC X.
  2391             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  2392             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  2393             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  2394
  2395     12  PI-POLICY-LINKAGE-IND           PIC X.
  2396         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  2397         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  2398                                                   LOW-VALUES.
  2399
  2400     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  2401     12  PI-CLAIM-PW-SESSION             PIC X(1).
  2402         88  PI-CLAIM-CREDIT                 VALUE '1'.
  2403         88  PI-CLAIM-CONVEN                 VALUE '2'.
  2404
  2405     12  PI-PROCESSOR-CSR-IND            PIC X.
  2406         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  2407         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  2408
  2409     12  FILLER                          PIC X(3).
  2410
  2411     12  PI-SYSTEM-LEVEL                 PIC X(145).
  2412
  2413     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  2414         PI-SYSTEM-LEVEL.
  2415
  2416         16  PI-ENTRY-CODES.
  2417             20  PI-ENTRY-CD-1           PIC X.
  2418             20  PI-ENTRY-CD-2           PIC X.
  2419
  2420         16  PI-RETURN-CODES.
  2421             20  PI-RETURN-CD-1          PIC X.
  2422             20  PI-RETURN-CD-2          PIC X.
  2423
  2424         16  PI-UPDATE-STATUS-SAVE.
  2425             20  PI-UPDATE-BY            PIC X(4).
  2426             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  2427
  2428         16  PI-LOWER-CASE-LETTERS       PIC X.
  2429             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  2430
  2431*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  2432*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  2433*            88  CARRIER-CLM-CNTL            VALUE '2'.
  2434
  2435         16  PI-CERT-ACCESS-CONTROL      PIC X.
  2436             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  47
* EL6311.cbl
  2437             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2438             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  2439             88  ACCNT-CNTL                  VALUE '3'.
  2440             88  CARR-ACCNT-CNTL             VALUE '4'.
  2441
  2442         16  PI-PROCESSOR-CAP-LIST.
  2443             20  PI-SYSTEM-CONTROLS.
  2444                24 PI-SYSTEM-DISPLAY     PIC X.
  2445                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  2446                24 PI-SYSTEM-MODIFY      PIC X.
  2447                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  2448             20  FILLER                  PIC XX.
  2449             20  PI-DISPLAY-CAP          PIC X.
  2450                 88  DISPLAY-CAP             VALUE 'Y'.
  2451             20  PI-MODIFY-CAP           PIC X.
  2452                 88  MODIFY-CAP              VALUE 'Y'.
  2453             20  PI-MSG-AT-LOGON-CAP     PIC X.
  2454                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  2455             20  PI-FORCE-CAP            PIC X.
  2456                 88  FORCE-CAP               VALUE 'Y'.
  2457
  2458         16  PI-PROGRAM-CONTROLS.
  2459             20  PI-PGM-PRINT-OPT        PIC X.
  2460             20  PI-PGM-FORMAT-OPT       PIC X.
  2461             20  PI-PGM-PROCESS-OPT      PIC X.
  2462             20  PI-PGM-TOTALS-OPT       PIC X.
  2463
  2464         16  PI-HELP-INTERFACE.
  2465             20  PI-LAST-ERROR-NO        PIC X(4).
  2466             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  2467
  2468         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  2469             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  2470
  2471         16  PI-CR-CONTROL-IN-PROGRESS.
  2472             20  PI-CR-CARRIER           PIC X.
  2473             20  PI-CR-GROUPING          PIC X(6).
  2474             20  PI-CR-STATE             PIC XX.
  2475             20  PI-CR-ACCOUNT           PIC X(10).
  2476             20  PI-CR-FIN-RESP          PIC X(10).
  2477             20  PI-CR-TYPE              PIC X.
  2478
  2479         16  PI-CR-BATCH-NUMBER          PIC X(6).
  2480
  2481         16  PI-CR-MONTH-END-DT          PIC XX.
  2482
  2483         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  2484             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  2485             88  PI-ZERO-CARRIER             VALUE '1'.
  2486             88  PI-ZERO-GROUPING            VALUE '2'.
  2487             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  2488
  2489         16  PI-CARRIER-SECURITY         PIC X.
  2490             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  2491
  2492         16  PI-ACCOUNT-SECURITY         PIC X(10).
  2493             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  2494             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  48
* EL6311.cbl
  2495
  2496         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  2497             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  2498                                         INDEXED BY PI-ACCESS-NDX
  2499                                         PIC X.
  2500
  2501         16  PI-GA-BILLING-CONTROL       PIC X.
  2502             88  PI-GA-BILLING               VALUE '1'.
  2503
  2504         16  PI-MAIL-PROCESSING          PIC X.
  2505             88  PI-MAIL-YES                 VALUE 'Y'.
  2506
  2507         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  2508
  2509         16  PI-AR-SYSTEM.
  2510             20  PI-AR-PROCESSING-CNTL   PIC X.
  2511                 88  PI-AR-PROCESSING        VALUE 'Y'.
  2512             20  PI-AR-SUMMARY-CODE      PIC X(6).
  2513             20  PI-AR-MONTH-END-DT      PIC XX.
  2514
  2515         16  PI-MP-SYSTEM.
  2516             20  PI-MORTGAGE-USER            PIC X.
  2517                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  2518                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  2519             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  2520                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  2521                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  2522                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  2523                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  2524                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  2525             20  PI-MP-MONTH-END-DT          PIC XX.
  2526             20  PI-MP-REFERENCE-NO.
  2527                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  2528                 24  PI-MP-REFERENCE-SFX     PIC XX.
  2529
  2530         16  PI-LABEL-CONTROL            PIC X(01).
  2531             88  PI-CREATE-LABELS                    VALUE 'Y'.
  2532             88  PI-BYPASS-LABELS                    VALUE 'N'.
  2533
  2534         16  PI-BILL-GROUPING-CODE       PIC X(01).
  2535             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  2536
  2537         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  2538             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  2539             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  2540
  2541         16  FILLER                      PIC X(14).
  2542
  2543     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  2544******************************************************************
  2545
  2546     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  2547*    COPY ELC631PI.
  2548******************************************************************
  2549*                                                                *
  2550*                                                                *
  2551*                            ELC631PI                            *
  2552*                            VMOD=2.012                          *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  49
* EL6311.cbl
  2553*                                                                *
  2554*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2555*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
  2556*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2557*                                                                *
  2558*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2559*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2560*    BETWEEN PROGRAMS.                                           *
  2561*                                                                *
  2562*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2563*                                                                *
  2564*               EL631 - EL6311 - EL6312 - EL6313                 *
  2565*                                                                *
  2566******************************************************************
  2567*                   C H A N G E   L O G
  2568*
  2569* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2570*-----------------------------------------------------------------
  2571*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2572* EFFECTIVE    NUMBER
  2573*-----------------------------------------------------------------
  2574* 021414    2003053000001  PEMA  changes for auto chk request
  2575******************************************************************
  2576
  2577         16  PI-631-DATA.
  2578             20  PI-ERPNDB-KEY.
  2579                 24  PI-PB-COMPANY-CD     PIC X.
  2580                 24  PI-PB-ENTRY-BATCH    PIC X(6).
  2581                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
  2582                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
  2583
  2584             20  PI-ERPNDB-ALT-KEY.
  2585                 24  PI-PB-COMPANY-CD-A1  PIC X.
  2586                 24  PI-PB-CARRIER        PIC X.
  2587                 24  PI-PB-GROUPING       PIC X(6).
  2588                 24  PI-PB-STATE          PIC XX.
  2589                 24  PI-PB-ACCOUNT        PIC X(10).
  2590                 24  PI-PB-CERT-EFF-DT    PIC XX.
  2591                 24  PI-PB-CERT-NO.
  2592                     28  PI-PB-CERT-PRIME PIC X(10).
  2593                     28  PI-PB-CERT-SFX   PIC X.
  2594                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
  2595                 24  PI-PB-RECORD-TYPE    PIC X.
  2596
  2597             20  PI-ERPNDB-CSR-KEY.
  2598                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
  2599                 24  PI-PB-CSR-ID             PIC X(4).
  2600                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
  2601                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
  2602                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
  2603
  2604             20  PI-BROWSE-TYPE               PIC X.
  2605                 88  PI-FILE-BROWSE             VALUE ' '.
  2606                 88  PI-PRIMARY-BROWSE          VALUE '1'.
  2607                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
  2608                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
  2609                 88  PI-CSR-BROWSE              VALUE '4'.
  2610
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  50
* EL6311.cbl
  2611             20  PI-MAINT-FUNCTION            PIC X.
  2612                 88  PI-ADD-FUNCTION            VALUE 'A'.
  2613                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
  2614                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
  2615                 88  PI-DELETE-FUNCTION         VALUE 'D'.
  2616                 88  PI-SHOW-FUNCTION           VALUE 'S'.
  2617                 88  PI-PF5-FUNCTION            VALUE '5'.
  2618                 88  PI-PF6-FUNCTION            VALUE '6'.
  2619
  2620             20  PI-FILE-SWITCHES.
  2621                 24  PI-ALL-ISSUES-SW         PIC X.
  2622                     88  ALL-ISSUES             VALUE 'Y'.
  2623                 24  PI-ALL-CANCELS-SW        PIC X.
  2624                     88  ALL-CANCELS            VALUE 'Y'.
  2625                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
  2626                     88  ISSUES-IN-ERROR        VALUE 'Y'.
  2627                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
  2628                     88  CANCEL-IN-ERROR        VALUE 'Y'.
  2629                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
  2630                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
  2631                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
  2632                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
  2633                 24  PI-HOLD-REC-SW           PIC X.
  2634                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
  2635                 24  PI-CHANGE-REC-SW         PIC X.
  2636                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
  2637                 24  PI-CHK-REQ-REC-SW        PIC X.
  2638                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
  2639                 24  PI-ISSUE-WARNING-SW      PIC X.
  2640                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
  2641                 24  PI-CANCEL-WARNING-SW     PIC X.
  2642                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
  2643             20  PI-DISPLAY-SCREEN-SW         PIC X.
  2644                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
  2645             20  PI-ORIGINAL-BATCH-SW         PIC X.
  2646                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
  2647
  2648             20  PI-MAP-NAME                  PIC X(8).
  2649
  2650             20  PI-CURSOR                    PIC S9(4) COMP.
  2651
  2652             20  PI-PREV-ALT-KEY              PIC X(36).
  2653             20  PI-PREV-CSR-KEY              PIC X(15).
  2654             20  PI-PREV-KEY.
  2655                 24  PI-PREV-COMPANY-CD       PIC X.
  2656                 24  PI-PREV-BATCH            PIC X(6).
  2657                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
  2658                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
  2659             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
  2660             20  PI-BROWSE-SW                 PIC X.
  2661                 88  PI-GOOD-BROWSE             VALUE 'Y'.
  2662                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
  2663             20  PI-SV-CARRIER                PIC X.
  2664             20  PI-SV-GROUPING               PIC X(6).
  2665             20  PI-SV-STATE                  PIC XX.
  2666             20  PI-EDIT-SW                   PIC X.
  2667             20  PI-DISPLAY-SW                PIC XX.
  2668                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  51
* EL6311.cbl
  2669                 88 PI-DISPLAY-AH          VALUE 'AH'.
  2670             20  PI-CRITERIA-DATA             PIC X(350).
  2671             20  PI-BMODE                     PIC X.
  2672             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
  2673             20  PI-BPMTS                     PIC S999     COMP-3.
  2674             20  PI-BTYPE                     PIC XXX OCCURS 2.
  2675             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
  2676             20  PI-CSR-SESSION-SW            PIC X.
  2677                 88  CSR-EDIT-SESSION           VALUE 'Y'.
  2678             20  PI-ERRORS-SW                 PIC X.
  2679                 88  FATAL-ERRORS               VALUE 'X'.
  2680*                88  FATAL-OR-UNFORCED          VALUE 'X'.
  2681             20  pi-unforced-sw               pic x.
  2682                 88  unforced-errors            value 'X'.
  2683             20  FILLER                       PIC X(4).
  2684
  2685        16  FILLER             PIC X(94).
  2686
  2687 01  W-LETTER-COMMUNICATION-AREAS.
  2688*    COPY ELC1042.
  2689******************************************************************
  2690*                                                                *
  2691*                                                                *
  2692*                           ELC1042                              *
  2693*                            VMOD=2.002                          *
  2694*                                                                *
  2695*    NOTE                                                        *
  2696*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  2697*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  2698*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  2699*        TO THESE PROGRAMS.                                      *
  2700*                                                                *
  2701*    NOTE                                                        *
  2702*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  2703*        USE ONLY!                                               *
  2704*                                                                *
  2705******************************************************************
  2706
  2707         16  PI-1042-WA.
  2708             20  PI-ACTION       PIC  X(01).
  2709                 88 PI-SHOW-MODE           VALUE '1'.
  2710                 88 PI-CLEAR-MODE          VALUE '2'.
  2711                 88 PI-CREATE-MODE         VALUE '3'.
  2712             20  PI-COMM-CONTROL PIC  X(12).
  2713             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  2714             20  PI-EOF-SW       PIC  X(01).
  2715                 88  PI-FILE-EOF           VALUE 'Y'.
  2716             20  PI-FILETYP      PIC  X(01).
  2717             20  PI-FORM-SQUEEZE-CONTROL
  2718                                 PIC  X(01).
  2719                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  2720                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  2721             20  PI-LAST-CONTROL PIC  X(12).
  2722             20  PI-TEMP-STOR-ITEMS
  2723                                 PIC S9(04) COMP.
  2724             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  2725             20  PI-UPDATE-SW    PIC  9(01).
  2726                 88 ANY-UPDATES            VALUE 1.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  52
* EL6311.cbl
  2727             20  PI-104-SCREEN-SENT-IND
  2728                                 PIC  X(01).
  2729                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  2730                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  2731             20  PI-1042-SCREEN-SENT-IND
  2732                                 PIC  X(01).
  2733                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  2734                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  2735             20  PI-1042-ARCHIVE-IND
  2736                                 PIC  X(01).
  2737                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  2738             20  FILLER          PIC  X(29).
  2739*    COPY ELC689PI.
  2740******************************************************************
  2741*                                                                *
  2742*                            ELC689PI                            *
  2743*                            VMOD=2.003                          *
  2744*                                                                *
  2745*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  2746*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  2747*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  2748*                                                                *
  2749*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  2750*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  2751*    BETWEEN PROGRAMS.                                           *
  2752*                                                                *
  2753*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  2754*                                                                *
  2755*               EL631 - EL689  - EL6891 - EL6892                 *
  2756*                                                                *
  2757******************************************************************
  2758*                   C H A N G E   L O G
  2759*
  2760* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2761*-----------------------------------------------------------------
  2762*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2763* EFFECTIVE    NUMBER
  2764*-----------------------------------------------------------------
  2765* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  2766* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  2767* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2768******************************************************************
  2769
  2770
  2771         16  PI-689-WORK-AREA.
  2772             20  PI-689-ALT-PRINTER-ID
  2773                                 PIC  X(04).
  2774             20  PI-689-ARCHIVE-NUMBER
  2775                                 PIC  9(08).
  2776             20  PI-689-ARCHIVE-SW
  2777                                 PIC  X(01).
  2778                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  2779             20  PI-689-DATA-SOURCE
  2780                                 PIC  X(01).
  2781                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  2782                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  2783                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  2784                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  53
* EL6311.cbl
  2785                 88  PI-689-SRC-CHECKS         VALUE '5'.
  2786             20  PI-689-ERROR-IND
  2787                                 PIC  X(01).
  2788                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  2789             20  PI-689-ERROR    PIC  9(04).
  2790                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  2791                 88  PI-689-FATAL-ERROR
  2792                     VALUES 0004 0006 0008 0013 0023 0029 0033
  2793                            0042 0047 0051 0066 0067 0070
  2794                            0168 0169 0174 0175 0176 0177 0179
  2795                            0180 0181 0182 0184 0185 0189 0190
  2796                            0191
  2797                            0215 0279 0280
  2798                            0412 0413 0454
  2799                            0533 0537
  2800                            2055 2114 2208 2209 2216 2232 2369
  2801                            2398 2433 2908 2999
  2802                            3000 3770 3771 3775
  2803                            7250 7365 7367 7368 7369 7370 7371
  2804                            7272 7373 7374 7376 7377 7378 7379
  2805                            7381 7388 7390 7393 7395 7396 7398
  2806                            9095 9096 9281 9298 9299 9320 9327
  2807                            9426 9427.
  2808                 88  PI-689-STOP-ERROR
  2809                     VALUES 0004 0008 0013 0023 0029 0033
  2810                            0042 0047 0066 0067 0070
  2811                            0168 0169 0174 0175 0176 0177
  2812                            0181 0182 0184 0185 0189 0190
  2813                            0279 0280
  2814                            0412 0413 0454
  2815                            2055 2208 2209 2216 2232
  2816                            2398 2999
  2817                            3000 3770 3771 3775
  2818                            7250 7365 7369 7370 7371
  2819                            7272 7373 7374 7376 7377 7378 7379
  2820                            7381 7388 7390 7393 7396 7398
  2821                            9095 9096 9299 9320 9426.
  2822             20  PI-689-FOLLOW-UP-DATE
  2823                                 PIC  X(02).
  2824             20  PI-689-FORM-NUMBER
  2825                                 PIC  X(04).
  2826             20  PI-689-LABEL-SOURCE
  2827                                 PIC X(01).
  2828                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  2829                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  2830                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  2831                 88  PI-689-SOURCE-COMP     VALUE '4'.
  2832                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  2833                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  2834                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  2835             20  PI-689-NUMBER-COPIES
  2836                                 PIC  9(01).
  2837             20  PI-689-NUMBER-LABEL-LINES
  2838                                 PIC  9(01).
  2839             20  PI-689-NUMBER-TEXT-RECORDS
  2840                                 PIC  9(03).
  2841             20  PI-689-PRINT-ORDER-SW
  2842                                 PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  54
* EL6311.cbl
  2843                 88  PI-689-PRINT-FIRST     VALUE '1'.
  2844                 88  PI-689-PRINT-SECOND    VALUE '2'.
  2845                 88  PI-689-PRINT-LATER     VALUE '3'.
  2846                 88  PI-689-PRINT-ONLY      VALUE '4'.
  2847             20  PI-689-PRINT-RESTRICTION
  2848                                 PIC  X(01).
  2849                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  2850                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  2851                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  2852             20  PI-689-PRINT-SW PIC  X(01).
  2853                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  2854             20  PI-689-RESEND-DATE-1
  2855                                 PIC  X(02).
  2856             20  PI-689-RESEND-LETR-1
  2857                                 PIC X(4).
  2858             20  PI-689-TEMP-STOR-ID
  2859                                 PIC  X(08).
  2860             20  PI-689-USE-SCREEN-IND
  2861                                 PIC  X(01).
  2862                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  2863             20  PI-689-ARCH-POINTER
  2864                                 PIC S9(08) COMP.
  2865                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  2866             20  PI-689-ARCT-POINTER
  2867                                 PIC S9(08) COMP.
  2868                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  2869             20  PI-689-VARIABLE-DATA-GRP.
  2870                 24  PI-689-VARIABLE-DATA-1
  2871                                 PIC  X(30).
  2872                 24  PI-689-VARIABLE-DATA-2
  2873                                 PIC  X(30).
  2874                 24  PI-689-VARIABLE-DATA-3
  2875                                 PIC  X(30).
  2876                 24  PI-689-VARIABLE-DATA-4
  2877                                 PIC  X(30).
  2878
  2879         16  PI-689-KEY-DATA-FIELDS.
  2880             20  PI-689-ACCOUNT  PIC  X(10).
  2881             20  PI-689-CARRIER  PIC  X(01).
  2882             20  PI-689-CERT-NO.
  2883                 24  PI-689-CERT-PRIME
  2884                                 PIC  X(10).
  2885                 24  PI-689-CERT-SFX
  2886                                 PIC  X(01).
  2887             20  PI-689-CHG-SEQ-NO
  2888                                 PIC S9(04)    COMP.
  2889             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  2890                                 PIC  X(02).
  2891             20  PI-689-ENTRY-BATCH
  2892                                 PIC  X(06).
  2893             20  PI-689-EFF-DATE PIC  X(02).
  2894             20  PI-689-EXP-DATE PIC  X(02).
  2895             20  PI-689-GROUPING PIC  X(06).
  2896             20  PI-689-RESP-PERSON
  2897                                 PIC  X(10).
  2898             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  2899             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  2900                                 PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  55
* EL6311.cbl
  2901             20  PI-689-STATE    PIC  X(02).
  2902             20  PI-689-TYPE     PIC  X(01).
  2903             20  PI-689-CONTROL  PIC S9(08)    COMP.
  2904             20  PI-689-ALT-SEQ-NO
  2905                                 PIC S9(04)    COMP.
  2906         16  PI-689-DATE-EDIT    PIC  X(08).
  2907         16  PI-689-FOLLOW-UP-EDIT
  2908                                 PIC  X(08).
  2909         16  PI-689-RESEND1-EDIT PIC  X(08).
  2910         16  PI-689-SEQ-EDIT     PIC  X(08).
  2911         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  2912         16  PI-689-LBL-OVERRIDE PIC  X(01).
  2913             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  2914         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  2915         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  56
* EL6311.cbl
  2917
  2918 01  WS-EL6315-PASS-AREA.
  2919        16  PI-6315-ISS-CAN-SW      PIC X.
  2920        16  FILLER                  PIC X(120).
  2921        16  PI-RES-REF-CLM-TYPE     PIC X.
  2922        16  FILLER                  PIC X.
  2923        16  PI-6315-PASS-AREA.
  2924            20 FILLER               PIC X(236).
  2925            20 PI-6315-FINALIZED    PIC X.
  2926            20 FILLER               PIC X(280).
  2927
  2928 01  WS-EL6316-PASS-AREA.
  2929        16  PI-ISS-CAN-SW           PIC X.
  2930        16  FILLER                  PIC X(121).
  2931        16  PI-CLM-RESC-IND         PIC X.
  2932        16  PI-6316-PASS-AREA.
  2933            20 FILLER               PIC X(236).
  2934            20 PI-6316-FINALIZED    PIC X.
  2935            20 FILLER               PIC X(280).
  2936
  2937******************************************************************
  2938*                                                                *
  2939*         P A S S   A R E A   F O R   E D I T                    *
  2940*                                                                *
  2941******************************************************************
  2942
  2943 01  PASSED-RECORD.
  2944     12  RECORD-SAVE                  PIC X(585).
  2945* COPYBOOK FOR ADDITIONAL DFHCOMMAREA WK-WORK-AREA.
  2946*    COPY ELC50W1 REPLACING WK-CANCEL-EXIT-DT
  2947*                    BY  WK-CURRENT-DATE.
  2948******************************************************************
  2949*                                                                *
  2950*                                                                *
  2951*                             ELC50W1                            *
  2952*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2953*                            VMOD=2.004                          *
  2954*                                                                *
  2955*       THIS COPYBOOK IS USED BY EL050, EL051, AND EL517.        *
  2956*                                                                *
  2957*                                                                *
  2958******************************************************************
  2959
  2960     12  WK-WORK-AREA.
  2961         16  WK-CNTL-RECORD-FOUND-SW  PIC X   VALUE ' '.
  2962         16  WK-LAST-CARRIER          PIC X   VALUE ' '.
  2963         16  WK-CR-REM-TERM-CALC      PIC X   VALUE ' '.
  2964         16  WK-CR-R78-METHOD         PIC X   VALUE ' '.
  2965         16  WK-CO-MAX-CAP          PIC S9(3)V99  COMP-3 VALUE +0.
  2966         16  WK-CO-TOL-CLAIM        PIC S9(3)V99  COMP-3 VALUE +0.
  2967         16  WK-CO-TOL-PREM         PIC S9(3)V99  COMP-3 VALUE +0.
  2968         16  WK-CO-TOL-REFUND       PIC S9(3)V99  COMP-3 VALUE +0.
  2969         16  WK-CO-TOL-PREM-PCT     PIC S9V9(4)   COMP-3 VALUE +0.
  2970         16  WK-CO-TOL-REFUND-PCT   PIC S9V9(4)   COMP-3 VALUE +0.
  2971         16  WK-CO-PREM-REJECT-SW     PIC X   VALUE ' '.
  2972         16  WK-CO-REF-REJECT-SW      PIC X   VALUE ' '.
  2973         16  WK-BIRTH-DATE-INPUT      PIC X   VALUE ' '.
  2974         16  WK-JOINT-AGE-INPUT       PIC X   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  57
* EL6311.cbl
  2975         16  WK-CURRENT-MONTH-END     PIC XX     VALUE LOW-VALUE.
  2976         16  WK-CREDIT-EDIT-CONTROLS.
  2977             20  WK-MIN-PREMIUM       PIC S9(3)V99  COMP-3.
  2978             20  WK-MIN-AGE           PIC 99  VALUE 00.
  2979             20  WK-DEFAULT-AGE       PIC 99  VALUE 00.
  2980             20  WK-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  2981             20  WK-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  2982             20  WK-DEFAULT-SEX       PIC X  VALUE ' '.
  2983         16  WK-CURRENT-DATE        PIC XX VALUE LOW-VALUE.
  2984         16  WK-SAVE-REIN-DATA.
  2985             20  WK-REIN-TABLE        PIC X(3) VALUE SPACES.
  2986             20  WK-REIN-ST-AH        PIC X(2) VALUE SPACES.
  2987             20  WK-REIN-ST-LF        PIC X(2) VALUE SPACES.
  2988         16  WK-ENTRY-SW              PIC X    VALUE ' '.
  2989             88  ENTRY-FROM-EL6311       VALUE '6'.
  2990         16  WK-REM-TRM-CALC-OPTION   PIC X    VALUE ' '.
  2991         16  WK-DEFAULT-APR           PIC S9(3)V9(4) COMP-3.
  2992     12  WK-RECORD-ADDRESSES.
  2993         16  WK-ACCT-ADDR             PIC S9(8) COMP VALUE ZEROS.
  2994         16  WK-LIFE-EDIT-ADDR        PIC S9(8) COMP VALUE ZEROS.
  2995         16  WK-AH-EDIT-ADDR          PIC S9(8) COMP VALUE ZEROS.
  2996         16  WK-LIFE-BEN-ADDR         PIC S9(8) COMP VALUE ZEROS.
  2997         16  WK-AH-BEN-ADDR           PIC S9(8) COMP VALUE ZEROS.
  2998         16  WK-STATE-ADDR            PIC S9(8) COMP VALUE ZEROS.
  2999         16  WK-PLAN-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3000         16  WK-FORM-ADDR             PIC S9(8) COMP VALUE ZEROS.
  3001     12  WK-OVER-SHORT-AREA.
  3002         16  WK-REFUND-OVS-AMT        PIC S999V99 COMP-3 VALUE +0.
  3003         16  WK-REFUND-OVS-PCT        PIC S9V9(4) COMP-3 VALUE +0.
  3004         16  WK-CSR-SESSION-SW        PIC X  VALUE ' '.
  3005             88  WK-CSR-EDIT-SESSION       VALUE 'Y'.
  3006         16  FILLER                   PIC X(5) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  58
* EL6311.cbl
  3008
  3009*    COPY ELCEDITC.
  3010******************************************************************
  3011*                                                                *
  3012*                                                                *
  3013*                            ELCEDITC                            *
  3014*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3015*                            VMOD=2.012                          *
  3016*                                                                *
  3017*       THIS COPYBOOK IS USED BY EL6311, EL6312,                 *
  3018*                     EL6313, EL050 AND EL517.                   *
  3019*                                                                *
  3020******************************************************************
  3021******************************************************************
  3022*                   C H A N G E   L O G
  3023*
  3024* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3025*-----------------------------------------------------------------
  3026*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3027* EFFECTIVE    NUMBER
  3028*-----------------------------------------------------------------
  3029* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3030******************************************************************
  3031
  3032     12  EDIT-CRITERIA-DATA.
  3033         16  EC-CO-MONTH-END-DT       PIC XX.
  3034         16  EC-CO-TOL-PREM           PIC S9(3)V99  COMP-3.
  3035         16  EC-CO-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3036         16  EC-CO-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3037         16  EC-CO-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3038         16  EC-CO-MIN-AGE            PIC S9(3)     COMP-3.
  3039         16  EC-CO-MIN-PREMIUM        PIC S9(5)V99  COMP-3.
  3040         16  EC-CO-MIN-TERM           PIC S9(3)     COMP-3.
  3041         16  EC-CO-MAX-TERM           PIC S9(3)     COMP-3.
  3042         16  EC-CO-REM-TERM-CALC      PIC X.
  3043               88  EC-CO-EARN-AFTER-15TH           VALUE '1'.
  3044               88  EC-CO-EARN-ON-HALF-MO           VALUE '2'.
  3045               88  EC-CO-EARN-ON-1ST-DAY           VALUE '3'.
  3046               88  EC-CO-EARN-ON-FULL-MO           VALUE '4'.
  3047
  3048         16  EC-BR-LF-EARNINGS-CALC    PIC X.
  3049               88  EC-BR-LF-EARNING-NOT-USED        VALUE SPACE.
  3050               88  EC-BR-LF-EARN-BY-R78             VALUE '1'.
  3051               88  EC-BR-LF-EARN-BY-PRO-RATA        VALUE '2'.
  3052               88  EC-BR-LF-EARN-AS-TEXAS           VALUE '4'.
  3053               88  EC-BR-LF-EARN-AS-FARM-PLAN       VALUE '4'.
  3054               88  EC-BR-LF-EARN-IS-NET-PAY         VALUE '5'.
  3055               88  EC-BR-LF-EARN-ANTICIPATION       VALUE '6'.
  3056               88  EC-BR-LF-EARN-MEAN               VALUE '8'.
  3057               88  EC-BR-LF-EARN-SUM-OF-DIGIT       VALUE '9'.
  3058               88  EC-BR-LF-EARN-REG-BALLOON        VALUE 'B'.
  3059
  3060         16  EC-BR-AH-EARNINGS-CALC    PIC X.
  3061               88  EC-BR-AH-EARNING-NOT-USED        VALUE SPACE.
  3062               88  EC-BR-AH-EARN-BY-R78             VALUE '1'.
  3063               88  EC-BR-AH-EARN-BY-PRO-RATA        VALUE '2'.
  3064               88  EC-BR-AH-EARN-AS-CALIF           VALUE '3'.
  3065               88  EC-BR-AH-EARN-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  59
* EL6311.cbl
  3066               88  EC-BR-AH-EARN-ANTICIPATION       VALUE '6'.
  3067               88  EC-BR-AH-EARN-MEAN               VALUE '8'.
  3068               88  EC-BR-AH-EARN-REG-BALLOON        VALUE 'B'.
  3069
  3070         16  EC-BR-AH-SPECIAL-CALC-CD  PIC X.
  3071                 88  EC-CF-AH-OUTSTANDING-BAL         VALUE 'O'.
  3072                 88  EC-CF-AH-CRITICAL-PERIOD         VALUE 'C'.
  3073
  3074         16  EC-BR-LF-SPECIAL-CALC-CD  PIC X.
  3075                 88  EC-CF-LF-OUTSTANDING-BAL         VALUE 'O'.
  3076                 88  EC-CF-LF-TRUNCATED-LIFE-0        VALUE 'T'.
  3077                 88  EC-CF-LF-TRUNCATED-LIFE-1        VALUE 'U'.
  3078                 88  EC-CF-LF-TRUNCATED-LIFE-2        VALUE 'V'.
  3079                 88  EC-CF-LF-ALTERNATE-NET-PAY       VALUE 'A'.
  3080                 88  EC-CF-LF-NET-PAY-SIMPLE          VALUE 'S'.
  3081                 88  EC-CF-LF-CRITICAL-PERIOD         VALUE 'C'.
  3082                 88  EC-CF-LF-TERM-IN-DAYS            VALUE 'D'.
  3083
  3084         16  EC-BR-LF-COVERAGE-TYPE    PIC X.
  3085               88  EC-BR-REDUCING                   VALUE 'R'.
  3086               88  EC-BR-LEVEL                      VALUE 'L' 'P'.
  3087
  3088         16  EC-BR-AH-COVERAGE-TYPE    PIC X(3).
  3089         16  EC-BR-LF-DESC             PIC X(10).
  3090         16  EC-BR-AH-DESC             PIC X(10).
  3091         16  EC-BR-LF-COMMENT          PIC X(10).
  3092         16  EC-BR-AH-COMMENT          PIC X(10).
  3093
  3094         16  EC-BR-LF-REM-TERM-CALC    PIC X.
  3095               88  EC-BR-LF-EARN-AFTER-15TH         VALUE '1'.
  3096               88  EC-BR-LF-EARN-ON-HALF-MO         VALUE '2'.
  3097               88  EC-BR-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3098               88  EC-BR-LF-EARN-ON-FULL-MO         VALUE '4'.
  3099
  3100         16  EC-BR-AH-REM-TERM-CALC    PIC X.
  3101               88  EC-BR-AH-EARN-AFTER-15TH         VALUE '1'.
  3102               88  EC-BR-AH-EARN-ON-HALF-MO         VALUE '2'.
  3103               88  EC-BR-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3104               88  EC-BR-AH-EARN-ON-FULL-MO         VALUE '4'.
  3105
  3106         16  EC-BR-LF-REFUND-CALC      PIC X.
  3107                 88  EC-BR-LF-REFD-BY-R78           VALUE '1'.
  3108                 88  EC-BR-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3109                 88  EC-BR-LF-REFD-AS-TEXAS         VALUE '4'.
  3110                 88  EC-BR-LF-REFD-IS-NET-PAY       VALUE '5'.
  3111                 88  EC-BR-LF-REFD-ANTICIPATION     VALUE '6'.
  3112                 88  EC-BR-LF-REFD-IS-MEAN          VALUE '8'.
  3113                 88  EC-BR-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3114
  3115         16  EC-BR-AH-REFUND-CALC      PIC X.
  3116                 88  EC-BR-AH-REFD-BY-R78           VALUE '1'.
  3117                 88  EC-BR-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3118                 88  EC-BR-AH-REFD-AS-CALIF         VALUE '3'.
  3119                 88  EC-BR-AH-REFD-AS-TEXAS         VALUE '4'.
  3120                 88  EC-BR-AH-REFD-IS-NET-PAY       VALUE '5'.
  3121                 88  EC-BR-AH-REFD-ANTICIPATION     VALUE '6'.
  3122                 88  EC-BR-AH-REFD-IS-MEAN          VALUE '8'.
  3123                 88  EC-BR-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  60
* EL6311.cbl
  3124
  3125         16  EC-BR-LF-BEN-I-G-CD       PIC X.
  3126                 88  EC-BR-LF-I-G-NOT-USED          VALUE ' '.
  3127                 88  EC-BR-LF-I-G-IS-INDV           VALUE 'I'.
  3128                 88  EC-BR-LF-I-G-IS-GRP            VALUE 'G'.
  3129
  3130         16  EC-BR-AH-BEN-I-G-CD       PIC X.
  3131                 88  EC-BR-AH-I-G-NOT-USED          VALUE ' '.
  3132                 88  EC-BR-AH-I-G-IS-INDV           VALUE 'I'.
  3133                 88  EC-BR-AH-I-G-IS-GRP            VALUE 'G'.
  3134
  3135         16  EC-ST-TOL-PREM           PIC S9(3)V99  COMP-3.
  3136         16  EC-ST-TOL-REFUND         PIC S9(3)V99  COMP-3.
  3137         16  EC-ST-TOL-PREM-PCT       PIC S9V9(4)   COMP-3.
  3138         16  EC-ST-TOL-REFUND-PCT     PIC S9V9(4)   COMP-3.
  3139
  3140         16  EC-ST-FST-PMT-DAYS-MAX   PIC S9(3)     COMP-3.
  3141         16  EC-ST-FST-PMT-DAYS-CHG   PIC X.
  3142                 88  EC-ST-EXT-NO-CHG               VALUE ' '.
  3143                 88  EC-ST-EXT-CHG-LF               VALUE '1'.
  3144                 88  EC-ST-EXT-CHG-AH               VALUE '2'.
  3145                 88  EC-ST-EXT-CHG-LF-AH            VALUE '3'.
  3146
  3147         16  EC-ST-LF-REM-TERM-CALC    PIC X.
  3148               88  EC-ST-LF-EARN-AFTER-15TH         VALUE '1'.
  3149               88  EC-ST-LF-EARN-ON-HALF-MO         VALUE '2'.
  3150               88  EC-ST-LF-EARN-ON-1ST-DAY         VALUE '3'.
  3151               88  EC-ST-LF-EARN-ON-FULL-MO         VALUE '4'.
  3152               88  EC-ST-LF-EARN-WITH-NO-DAYS       VALUE '5'.
  3153
  3154         16  EC-ST-AH-REM-TERM-CALC    PIC X.
  3155               88  EC-ST-AH-EARN-AFTER-15TH         VALUE '1'.
  3156               88  EC-ST-AH-EARN-ON-HALF-MO         VALUE '2'.
  3157               88  EC-ST-AH-EARN-ON-1ST-DAY         VALUE '3'.
  3158               88  EC-ST-AH-EARN-ON-FULL-MO         VALUE '4'.
  3159               88  EC-ST-AH-EARN-WITH-NO-DAYS       VALUE '5'.
  3160
  3161         16  EC-ST-LF-REFUND-CALC      PIC X.
  3162                 88  EC-ST-LF-REFD-BY-R78           VALUE '1'.
  3163                 88  EC-ST-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3164                 88  EC-ST-LF-REFD-AS-CALIF         VALUE '3'.
  3165                 88  EC-ST-LF-REFD-AS-TEXAS         VALUE '4'.
  3166                 88  EC-ST-LF-REFD-IS-NET-PAY       VALUE '5'.
  3167                 88  EC-ST-LF-REFD-ANTICIPATION     VALUE '6'.
  3168                 88  EC-ST-LF-REFD-IS-MEAN          VALUE '8'.
  3169                 88  EC-ST-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3170
  3171         16  EC-ST-AH-REFUND-CALC      PIC X.
  3172                 88  EC-ST-AH-REFD-BY-R78           VALUE '1'.
  3173                 88  EC-ST-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3174                 88  EC-ST-AH-REFD-AS-CALIF         VALUE '3'.
  3175                 88  EC-ST-AH-REFD-AS-TEXAS         VALUE '4'.
  3176                 88  EC-ST-AH-REFD-IS-NET-PAY       VALUE '5'.
  3177                 88  EC-ST-AH-REFD-ANTICIPATION     VALUE '6'.
  3178                 88  EC-ST-AH-REFD-IS-MEAN          VALUE '8'.
  3179                 88  EC-ST-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3180
  3181         16  EC-AM-LF-TOL-PREM         PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  61
* EL6311.cbl
  3182         16  EC-AM-AH-TOL-PREM         PIC S9(3)V99  COMP-3.
  3183         16  EC-AM-LF-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3184         16  EC-AM-AH-TOL-REFUND       PIC S9(3)V99  COMP-3.
  3185         16  EC-AM-EXPIRATION-DT       PIC XX.
  3186         16  EC-AM-EFFECTIVE-DT        PIC XX.
  3187         16  EC-AM-CLASS-CD            PIC XX.
  3188         16  EC-AM-LF-DEVIATION        PIC XXX.
  3189         16  EC-AM-LF-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3190         16  EC-AM-AH-DEVIATION        PIC XXX.
  3191         16  EC-AM-AH-DEV-PERCENT      PIC S9V9(6)  COMP-3.
  3192         16  EC-AM-PHONE-NO            PIC X(10).
  3193
  3194         16  EC-AM-LF-REFUND-CALC      PIC X.
  3195                 88  EC-AM-LF-REFD-BY-R78           VALUE '1'.
  3196                 88  EC-AM-LF-REFD-BY-PRO-RATA      VALUE '2'.
  3197                 88  EC-AM-LF-REFD-AS-TEXAS         VALUE '4'.
  3198                 88  EC-AM-LF-REFD-IS-NET-PAY       VALUE '5'.
  3199                 88  EC-AM-LF-REFD-ANTICIPATION     VALUE '6'.
  3200                 88  EC-AM-LF-REFD-IS-MEAN          VALUE '8'.
  3201                 88  EC-AM-LF-REFD-IS-SUM-OF-DIGIT  VALUE '9'.
  3202
  3203         16  EC-AM-AH-REFUND-CALC      PIC X.
  3204                 88  EC-AM-AH-REFD-BY-R78           VALUE '1'.
  3205                 88  EC-AM-AH-REFD-BY-PRO-RATA      VALUE '2'.
  3206                 88  EC-AM-AH-REFD-AS-CALIF         VALUE '3'.
  3207                 88  EC-AM-AH-REFD-IS-NET           VALUE '5'.
  3208                 88  EC-AM-AH-REFD-ANTICIPATION     VALUE '6'.
  3209                 88  EC-AM-AH-REFD-IS-MEAN          VALUE '8'.
  3210                 88  EC-AM-AH-REFD-SUM-OF-DIGIT     VALUE '9'.
  3211
  3212         16  EC-AM-BEN-I-G-CD          PIC X.
  3213                 88  WK-AM-I-G-NOT-USED             VALUE ' '.
  3214                 88  EC-AM-I-G-IS-INDV              VALUE 'I'.
  3215                 88  EC-AM-I-G-IS-GRP               VALUE 'G'.
  3216
  3217         16  EC-AM-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3218         16  EC-AM-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3219         16  EC-AM-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3220         16  EC-AM-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3221         16  EC-AM-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3222         16  EC-AM-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3223         16  EC-AM-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3224         16  EC-AM-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3225         16  EC-AM-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3226
  3227         16  EC-RT-LF-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3228         16  EC-RT-LF-MAX-AGE          PIC S9(3)       COMP-3.
  3229         16  EC-RT-LF-MAX-TERM         PIC S9(3)       COMP-3.
  3230         16  EC-RT-LF-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3231         16  EC-RT-AH-MAX-ATT-AGE      PIC S9(3)       COMP-3.
  3232         16  EC-RT-AH-MAX-AGE          PIC S9(3)       COMP-3.
  3233         16  EC-RT-AH-MAX-TERM         PIC S9(3)       COMP-3.
  3234         16  EC-RT-AH-MAX-MON-BEN      PIC S9(7)V99    COMP-3.
  3235         16  EC-RT-AH-MAX-TOT-BEN      PIC S9(7)V99    COMP-3.
  3236         16  EC-RT-AH-RATE             PIC S9(3)V9(5)  COMP-3.
  3237         16  EC-RT-LF-RATE             PIC S9(3)V9(5)  COMP-3.
  3238         16  EC-RT-LF-NSP-ST           PIC XX.
  3239         16  EC-RT-AH-NSP-ST           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  62
* EL6311.cbl
  3240         16  EC-RT-LF-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3241         16  EC-RT-AH-NSP-RATE         PIC S9(3)V9(5)  COMP-3.
  3242
  3243         16  EC-CM-LF-PRIOR-STATUS     PIC X.
  3244             88  EC-CM-LF-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3245                                             'M' '5' '9' '2'.
  3246             88  EC-CM-LF-NORMAL-ENTRY         VALUE '1'.
  3247             88  EC-CM-LF-POLICY-PENDING       VALUE '2'.
  3248             88  EC-CM-LF-POLICY-IS-RESTORE    VALUE '3'.
  3249             88  EC-CM-LF-CONVERSION-ENTRY     VALUE '4'.
  3250             88  EC-CM-LF-POLICY-IS-REISSUE    VALUE '5'.
  3251             88  EC-CM-LF-POLICY-IS-MONTHLY    VALUE 'M'.
  3252             88  EC-CM-LF-LUMP-SUM-DISAB       VALUE '6'.
  3253             88  EC-CM-LF-DEATH-CLAIM-APPLIED  VALUE '7'.
  3254             88  EC-CM-LF-CANCEL-APPLIED       VALUE '8'.
  3255             88  EC-CM-LF-IS-REIN-ONLY         VALUE '9'.
  3256
  3257         16  EC-CM-AH-PRIOR-STATUS     PIC X.
  3258             88  EC-CM-AH-POLICY-IS-ACTIVE     VALUE '1' '3' '4'
  3259                                             'M' '5' '9' '2'.
  3260             88  EC-CM-AH-NORMAL-ENTRY         VALUE '1'.
  3261             88  EC-CM-AH-POLICY-PENDING       VALUE '2'.
  3262             88  EC-CM-AH-POLICY-IS-RESTORE    VALUE '3'.
  3263             88  EC-CM-AH-CONVERSION-ENTRY     VALUE '4'.
  3264             88  EC-CM-AH-POLICY-IS-REISSUE    VALUE '5'.
  3265             88  EC-CM-AH-POLICY-IS-MONTHLY    VALUE 'M'.
  3266             88  EC-CM-AH-LUMP-SUM-DISAB       VALUE '6'.
  3267             88  EC-CM-AH-DEATH-CLAIM-APPLIED  VALUE '7'.
  3268             88  EC-CM-AH-CANCEL-APPLIED       VALUE '8'.
  3269             88  EC-CM-AH-IS-REIN-ONLY         VALUE '9'.
  3270
  3271         16  EC-CM-LF-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3272         16  EC-CM-AH-PRIOR-REFUND     PIC S9(7)V99     COMP-3.
  3273         16  EC-CM-LF-CANCEL-DT        PIC XX.
  3274         16  EC-CM-AH-CANCEL-DT        PIC XX.
  3275         16  EC-CM-DEATH-DT            PIC XX.
  3276
  3277*DMD CUSTOM CODING FIELDS BELOW
  3278*POPULATED BY CF-RATING-SWITCH AT EL050 TIME
  3279         16  EC-BR-DMD-RATING-SW       PIC X.
  3280                 88  EC-DMD-AH-RATING            VALUE 'Y'.
  3281                 88  EC-DMD-LF-RATING            VALUE 'Y'.
  3282                 88  NO-DMD-RATING               VALUE 'N'.
  3283
  3284         16  EC-NEW-CERT               PIC X(11).
  3285         16  EC-NEW-STATE              PIC XX.
  3286         16  FILLER                    PIC X.
  3287*FIELDS FOR THE REFUND OVER AND SHORT TOLERANCES.
  3288         16  OVER-SHORT-EDIT-FIELDS.
  3289             20  EC-CO-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3290             20  EC-CO-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3291             20  EC-ST-OVR-SHT-AMT     PIC S999V99   COMP-3.
  3292             20  EC-ST-OVR-SHT-PCT     PIC S9V9(4)   COMP-3.
  3293             20  EC-AM-TOL-REF-PCT     PIC S9V9(4)   COMP-3.
  3294             20  EC-AM-LF-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3295             20  EC-AM-LF-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
  3296             20  EC-AM-AH-OVR-SHT-AMT  PIC S999V99   COMP-3.
  3297             20  EC-AM-AH-OVR-SHT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  63
* EL6311.cbl
  3298         16  FILLER                    PIC X(71).
  3299
  3300******************************************************************
  3301
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  64
* EL6311.cbl
  3303
  3304*    COPY ELCJPFX.
  3305******************************************************************
  3306*                                                                *
  3307*                                                                *
  3308*                            ELCJPFX.                            *
  3309*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3310*                            VMOD=2.002                          *
  3311*                                                                *
  3312*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  3313*                                                                *
  3314*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  3315*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  3316*        ELCNTL - CONTROL FILE                                   *
  3317*        ELMSTR - CLAIM MASTERS                                  *
  3318*        ELTRLR - ACTIVITY TRAILERS                              *
  3319*        ELCHKQ - CHECK QUE                                      *
  3320******************************************************************
  3321 01  JOURNAL-RECORD.
  3322     12  jp-date                     pic s9(5) comp-3.
  3323     12  jp-time                     pic s9(7) comp-3.
  3324     12  JP-USER-ID                  PIC X(4).
  3325     12  JP-FILE-ID                  PIC X(8).
  3326     12  JP-PROGRAM-ID               PIC X(8).
  3327     12  JP-RECORD-TYPE              PIC X.
  3328         88 JP-ADD              VALUE 'A'.
  3329         88 JP-BEFORE-CHANGE    VALUE 'B'.
  3330         88 JP-AFTER-CHANGE     VALUE 'C'.
  3331         88 JP-DELETE           VALUE 'D'.
  3332         88 JP-GENERIC-DELETE   VALUE 'G'.
  3333         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  3334         88 JP-KEY-CHG-ADD      VALUE 'N'.
  3335     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  3336     12  JP-RECORD-AREA
  3337
  3338
  3339                             PIC X(825).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  65
* EL6311.cbl
  3341*    COPY ELCAID.
  3342******************************************************************
  3343*                                                                *
  3344*                            ELCAID.                             *
  3345*                            VMOD=2.001                          *
  3346*                                                                *
  3347*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3348*                                                                *
  3349*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3350*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3351******************************************************************
  3352
  3353 01  DFHAID.
  3354   02  DFHNULL   PIC  X  VALUE  ' '.
  3355   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3356   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3357   02  DFHPEN    PIC  X  VALUE  '='.
  3358   02  DFHOPID   PIC  X  VALUE  'W'.
  3359   02  DFHPA1    PIC  X  VALUE  '%'.
  3360   02  DFHPA2    PIC  X  VALUE  '>'.
  3361   02  DFHPA3    PIC  X  VALUE  ','.
  3362   02  DFHPF1    PIC  X  VALUE  '1'.
  3363   02  DFHPF2    PIC  X  VALUE  '2'.
  3364   02  DFHPF3    PIC  X  VALUE  '3'.
  3365   02  DFHPF4    PIC  X  VALUE  '4'.
  3366   02  DFHPF5    PIC  X  VALUE  '5'.
  3367   02  DFHPF6    PIC  X  VALUE  '6'.
  3368   02  DFHPF7    PIC  X  VALUE  '7'.
  3369   02  DFHPF8    PIC  X  VALUE  '8'.
  3370   02  DFHPF9    PIC  X  VALUE  '9'.
  3371   02  DFHPF10   PIC  X  VALUE  ':'.
  3372   02  DFHPF11   PIC  X  VALUE  '#'.
  3373   02  DFHPF12   PIC  X  VALUE  '@'.
  3374   02  DFHPF13   PIC  X  VALUE  'A'.
  3375   02  DFHPF14   PIC  X  VALUE  'B'.
  3376   02  DFHPF15   PIC  X  VALUE  'C'.
  3377   02  DFHPF16   PIC  X  VALUE  'D'.
  3378   02  DFHPF17   PIC  X  VALUE  'E'.
  3379   02  DFHPF18   PIC  X  VALUE  'F'.
  3380   02  DFHPF19   PIC  X  VALUE  'G'.
  3381   02  DFHPF20   PIC  X  VALUE  'H'.
  3382   02  DFHPF21   PIC  X  VALUE  'I'.
  3383*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3384   02  DFHPF22   PIC  X  VALUE  '['.
  3385   02  DFHPF23   PIC  X  VALUE  '.'.
  3386   02  DFHPF24   PIC  X  VALUE  '<'.
  3387   02  DFHMSRE   PIC  X  VALUE  'X'.
  3388   02  DFHSTRF   PIC  X  VALUE  'h'.
  3389   02  DFHTRIG   PIC  X  VALUE  '"'.
  3390
  3391 01  FILLER    REDEFINES DFHAID.
  3392     12  FILLER              PIC X(8).
  3393     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  3394
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  66
* EL6311.cbl
  3396*    COPY EL6311S.
  3397 01  EL631BI.
  3398     05  FILLER            PIC  X(0012).
  3399*    -------------------------------
  3400     05  BDATEL PIC S9(0004) COMP.
  3401     05  BDATEF PIC  X(0001).
  3402     05  FILLER REDEFINES BDATEF.
  3403         10  BDATEA PIC  X(0001).
  3404     05  BDATEI PIC  X(0008).
  3405*    -------------------------------
  3406     05  BTIMEL PIC S9(0004) COMP.
  3407     05  BTIMEF PIC  X(0001).
  3408     05  FILLER REDEFINES BTIMEF.
  3409         10  BTIMEA PIC  X(0001).
  3410     05  BTIMEI PIC  X(0005).
  3411*    -------------------------------
  3412     05  BHEADL PIC S9(0004) COMP.
  3413     05  BHEADF PIC  X(0001).
  3414     05  FILLER REDEFINES BHEADF.
  3415         10  BHEADA PIC  X(0001).
  3416     05  BHEADI PIC  X(0038).
  3417*    -------------------------------
  3418     05  BNCERTLL PIC S9(0004) COMP.
  3419     05  BNCERTLF PIC  X(0001).
  3420     05  FILLER REDEFINES BNCERTLF.
  3421         10  BNCERTLA PIC  X(0001).
  3422     05  BNCERTLI PIC  X(0008).
  3423*    -------------------------------
  3424     05  BNCERTL PIC S9(0004) COMP.
  3425     05  BNCERTF PIC  X(0001).
  3426     05  FILLER REDEFINES BNCERTF.
  3427         10  BNCERTA PIC  X(0001).
  3428     05  BNCERTI PIC  X(0011).
  3429*    -------------------------------
  3430     05  BNSTATLL PIC S9(0004) COMP.
  3431     05  BNSTATLF PIC  X(0001).
  3432     05  FILLER REDEFINES BNSTATLF.
  3433         10  BNSTATLA PIC  X(0001).
  3434     05  BNSTATLI PIC  X(0009).
  3435*    -------------------------------
  3436     05  BNSTATL PIC S9(0004) COMP.
  3437     05  BNSTATF PIC  X(0001).
  3438     05  FILLER REDEFINES BNSTATF.
  3439         10  BNSTATA PIC  X(0001).
  3440     05  BNSTATI PIC  X(0002).
  3441*    -------------------------------
  3442     05  BCHGTL PIC S9(0004) COMP.
  3443     05  BCHGTF PIC  X(0001).
  3444     05  FILLER REDEFINES BCHGTF.
  3445         10  BCHGTA PIC  X(0001).
  3446     05  BCHGTI PIC  X(0004).
  3447*    -------------------------------
  3448     05  BCHGL PIC S9(0004) COMP.
  3449     05  BCHGF PIC  X(0001).
  3450     05  FILLER REDEFINES BCHGF.
  3451         10  BCHGA PIC  X(0001).
  3452     05  BCHGI PIC  X(0004).
  3453*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  67
* EL6311.cbl
  3454     05  BCOMPIDL PIC S9(0004) COMP.
  3455     05  BCOMPIDF PIC  X(0001).
  3456     05  FILLER REDEFINES BCOMPIDF.
  3457         10  BCOMPIDA PIC  X(0001).
  3458     05  BCOMPIDI PIC  X(0003).
  3459*    -------------------------------
  3460     05  BREGIONL PIC S9(0004) COMP.
  3461     05  BREGIONF PIC  X(0001).
  3462     05  FILLER REDEFINES BREGIONF.
  3463         10  BREGIONA PIC  X(0001).
  3464     05  BREGIONI PIC  X(0006).
  3465*    -------------------------------
  3466     05  BUSERL PIC S9(0004) COMP.
  3467     05  BUSERF PIC  X(0001).
  3468     05  FILLER REDEFINES BUSERF.
  3469         10  BUSERA PIC  X(0001).
  3470     05  BUSERI PIC  X(0004).
  3471*    -------------------------------
  3472     05  BMAINTL PIC S9(0004) COMP.
  3473     05  BMAINTF PIC  X(0001).
  3474     05  FILLER REDEFINES BMAINTF.
  3475         10  BMAINTA PIC  X(0001).
  3476     05  BMAINTI PIC  X(0001).
  3477*    -------------------------------
  3478     05  BMANTBYL PIC S9(0004) COMP.
  3479     05  BMANTBYF PIC  X(0001).
  3480     05  FILLER REDEFINES BMANTBYF.
  3481         10  BMANTBYA PIC  X(0001).
  3482     05  BMANTBYI PIC  X(0004).
  3483*    -------------------------------
  3484     05  BCHGHDGL PIC S9(0004) COMP.
  3485     05  BCHGHDGF PIC  X(0001).
  3486     05  FILLER REDEFINES BCHGHDGF.
  3487         10  BCHGHDGA PIC  X(0001).
  3488     05  BCHGHDGI PIC  X(0003).
  3489*    -------------------------------
  3490     05  BMANTDTL PIC S9(0004) COMP.
  3491     05  BMANTDTF PIC  X(0001).
  3492     05  FILLER REDEFINES BMANTDTF.
  3493         10  BMANTDTA PIC  X(0001).
  3494     05  BMANTDTI PIC  X(0008).
  3495*    -------------------------------
  3496     05  BMANTATL PIC S9(0004) COMP.
  3497     05  BMANTATF PIC  X(0001).
  3498     05  FILLER REDEFINES BMANTATF.
  3499         10  BMANTATA PIC  X(0001).
  3500     05  BMANTATI PIC  X(0005).
  3501*    -------------------------------
  3502     05  BCSRL PIC S9(0004) COMP.
  3503     05  BCSRF PIC  X(0001).
  3504     05  FILLER REDEFINES BCSRF.
  3505         10  BCSRA PIC  X(0001).
  3506     05  BCSRI PIC  X(0004).
  3507*    -------------------------------
  3508     05  BBATCHL PIC S9(0004) COMP.
  3509     05  BBATCHF PIC  X(0001).
  3510     05  FILLER REDEFINES BBATCHF.
  3511         10  BBATCHA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  68
* EL6311.cbl
  3512     05  BBATCHI PIC  X(0006).
  3513*    -------------------------------
  3514     05  BSEQL PIC S9(0004) COMP.
  3515     05  BSEQF PIC  X(0001).
  3516     05  FILLER REDEFINES BSEQF.
  3517         10  BSEQA PIC  X(0001).
  3518     05  BSEQI PIC  X(0004).
  3519*    -------------------------------
  3520     05  BMOENDTL PIC S9(0004) COMP.
  3521     05  BMOENDTF PIC  X(0001).
  3522     05  FILLER REDEFINES BMOENDTF.
  3523         10  BMOENDTA PIC  X(0001).
  3524     05  BMOENDTI PIC  X(0008).
  3525*    -------------------------------
  3526     05  BCARRL PIC S9(0004) COMP.
  3527     05  BCARRF PIC  X(0001).
  3528     05  FILLER REDEFINES BCARRF.
  3529         10  BCARRA PIC  X(0001).
  3530     05  BCARRI PIC  X(0001).
  3531*    -------------------------------
  3532     05  BGROUPL PIC S9(0004) COMP.
  3533     05  BGROUPF PIC  X(0001).
  3534     05  FILLER REDEFINES BGROUPF.
  3535         10  BGROUPA PIC  X(0001).
  3536     05  BGROUPI PIC  X(0006).
  3537*    -------------------------------
  3538     05  BSTATEL PIC S9(0004) COMP.
  3539     05  BSTATEF PIC  X(0001).
  3540     05  FILLER REDEFINES BSTATEF.
  3541         10  BSTATEA PIC  X(0001).
  3542     05  BSTATEI PIC  X(0002).
  3543*    -------------------------------
  3544     05  BACCTL PIC S9(0004) COMP.
  3545     05  BACCTF PIC  X(0001).
  3546     05  FILLER REDEFINES BACCTF.
  3547         10  BACCTA PIC  X(0001).
  3548     05  BACCTI PIC  X(0010).
  3549*    -------------------------------
  3550     05  BVINHL PIC S9(0004) COMP.
  3551     05  BVINHF PIC  X(0001).
  3552     05  FILLER REDEFINES BVINHF.
  3553         10  BVINHA PIC  X(0001).
  3554     05  BVINHI PIC  X(0004).
  3555*    -------------------------------
  3556     05  BVINL PIC S9(0004) COMP.
  3557     05  BVINF PIC  X(0001).
  3558     05  FILLER REDEFINES BVINF.
  3559         10  BVINA PIC  X(0001).
  3560     05  BVINI PIC  X(0017).
  3561*    -------------------------------
  3562     05  BREFHDGL PIC S9(0004) COMP.
  3563     05  BREFHDGF PIC  X(0001).
  3564     05  FILLER REDEFINES BREFHDGF.
  3565         10  BREFHDGA PIC  X(0001).
  3566     05  BREFHDGI PIC  X(0004).
  3567*    -------------------------------
  3568     05  BREFL PIC S9(0004) COMP.
  3569     05  BREFF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  69
* EL6311.cbl
  3570     05  FILLER REDEFINES BREFF.
  3571         10  BREFA PIC  X(0001).
  3572     05  BREFI PIC  X(0012).
  3573*    -------------------------------
  3574     05  BAGEDEFL PIC S9(0004) COMP.
  3575     05  BAGEDEFF PIC  X(0001).
  3576     05  FILLER REDEFINES BAGEDEFF.
  3577         10  BAGEDEFA PIC  X(0001).
  3578     05  BAGEDEFI PIC  X(0004).
  3579*    -------------------------------
  3580     05  BCERTNOL PIC S9(0004) COMP.
  3581     05  BCERTNOF PIC  X(0001).
  3582     05  FILLER REDEFINES BCERTNOF.
  3583         10  BCERTNOA PIC  X(0001).
  3584     05  BCERTNOI PIC  X(0010).
  3585*    -------------------------------
  3586     05  BSUFIXL PIC S9(0004) COMP.
  3587     05  BSUFIXF PIC  X(0001).
  3588     05  FILLER REDEFINES BSUFIXF.
  3589         10  BSUFIXA PIC  X(0001).
  3590     05  BSUFIXI PIC  X(0001).
  3591*    -------------------------------
  3592     05  BEFFDTL PIC S9(0004) COMP.
  3593     05  BEFFDTF PIC  X(0001).
  3594     05  FILLER REDEFINES BEFFDTF.
  3595         10  BEFFDTA PIC  X(0001).
  3596     05  BEFFDTI PIC  X(0008).
  3597*    -------------------------------
  3598     05  BLSTNML PIC S9(0004) COMP.
  3599     05  BLSTNMF PIC  X(0001).
  3600     05  FILLER REDEFINES BLSTNMF.
  3601         10  BLSTNMA PIC  X(0001).
  3602     05  BLSTNMI PIC  X(0015).
  3603*    -------------------------------
  3604     05  B1STNML PIC S9(0004) COMP.
  3605     05  B1STNMF PIC  X(0001).
  3606     05  FILLER REDEFINES B1STNMF.
  3607         10  B1STNMA PIC  X(0001).
  3608     05  B1STNMI PIC  X(0010).
  3609*    -------------------------------
  3610     05  BINITL PIC S9(0004) COMP.
  3611     05  BINITF PIC  X(0001).
  3612     05  FILLER REDEFINES BINITF.
  3613         10  BINITA PIC  X(0001).
  3614     05  BINITI PIC  X(0001).
  3615*    -------------------------------
  3616     05  BSEXL PIC S9(0004) COMP.
  3617     05  BSEXF PIC  X(0001).
  3618     05  FILLER REDEFINES BSEXF.
  3619         10  BSEXA PIC  X(0001).
  3620     05  BSEXI PIC  X(0001).
  3621*    -------------------------------
  3622     05  BAGEL PIC S9(0004) COMP.
  3623     05  BAGEF PIC  X(0001).
  3624     05  FILLER REDEFINES BAGEF.
  3625         10  BAGEA PIC  X(0001).
  3626     05  BAGEI PIC  X(0002).
  3627*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  70
* EL6311.cbl
  3628     05  BBIRTHL PIC S9(0004) COMP.
  3629     05  BBIRTHF PIC  X(0001).
  3630     05  FILLER REDEFINES BBIRTHF.
  3631         10  BBIRTHA PIC  X(0001).
  3632     05  BBIRTHI PIC  X(0008).
  3633*    -------------------------------
  3634     05  B1STPMTL PIC S9(0004) COMP.
  3635     05  B1STPMTF PIC  X(0001).
  3636     05  FILLER REDEFINES B1STPMTF.
  3637         10  B1STPMTA PIC  X(0001).
  3638     05  B1STPMTI PIC  X(0008).
  3639*    -------------------------------
  3640     05  BDAYSL PIC S9(0004) COMP.
  3641     05  BDAYSF PIC  X(0001).
  3642     05  FILLER REDEFINES BDAYSF.
  3643         10  BDAYSA PIC  X(0001).
  3644     05  BDAYSI PIC  X(0003).
  3645*    -------------------------------
  3646     05  BLNTRML PIC S9(0004) COMP.
  3647     05  BLNTRMF PIC  X(0001).
  3648     05  FILLER REDEFINES BLNTRMF.
  3649         10  BLNTRMA PIC  X(0001).
  3650     05  BLNTRMI PIC  X(0003).
  3651*    -------------------------------
  3652     05  BLNOFCRL PIC S9(0004) COMP.
  3653     05  BLNOFCRF PIC  X(0001).
  3654     05  FILLER REDEFINES BLNOFCRF.
  3655         10  BLNOFCRA PIC  X(0001).
  3656     05  BLNOFCRI PIC  X(0005).
  3657*    -------------------------------
  3658     05  BMODEL PIC S9(0004) COMP.
  3659     05  BMODEF PIC  X(0001).
  3660     05  FILLER REDEFINES BMODEF.
  3661         10  BMODEA PIC  X(0001).
  3662     05  BMODEI PIC  X(0001).
  3663*    -------------------------------
  3664     05  BFREQL PIC S9(0004) COMP.
  3665     05  BFREQF PIC  X(0001).
  3666     05  FILLER REDEFINES BFREQF.
  3667         10  BFREQA PIC  X(0001).
  3668     05  BFREQI PIC  X(0002).
  3669*    -------------------------------
  3670     05  BPMTSL PIC S9(0004) COMP.
  3671     05  BPMTSF PIC  X(0001).
  3672     05  FILLER REDEFINES BPMTSF.
  3673         10  BPMTSA PIC  X(0001).
  3674     05  BPMTSI PIC  999.
  3675*    -------------------------------
  3676     05  BPMTAMTL PIC S9(0004) COMP.
  3677     05  BPMTAMTF PIC  X(0001).
  3678     05  FILLER REDEFINES BPMTAMTF.
  3679         10  BPMTAMTA PIC  X(0001).
  3680     05  BPMTAMTI PIC  9(7)V99.
  3681*    -------------------------------
  3682     05  BAPRL PIC S9(0004) COMP.
  3683     05  BAPRF PIC  X(0001).
  3684     05  FILLER REDEFINES BAPRF.
  3685         10  BAPRA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  71
* EL6311.cbl
  3686     05  BAPRI PIC  X(7).
  3687*    -------------------------------
  3688     05  BLIVESL PIC S9(0004) COMP.
  3689     05  BLIVESF PIC  X(0001).
  3690     05  FILLER REDEFINES BLIVESF.
  3691         10  BLIVESA PIC  X(0001).
  3692     05  BLIVESI PIC  X(0009).
  3693*    -------------------------------
  3694     05  BMEMCAPL PIC S9(0004) COMP.
  3695     05  BMEMCAPF PIC  X(0001).
  3696     05  FILLER REDEFINES BMEMCAPF.
  3697         10  BMEMCAPA PIC  X(0001).
  3698     05  BMEMCAPI PIC  X(0011).
  3699*    -------------------------------
  3700     05  BORIGHDL PIC S9(0004) COMP.
  3701     05  BORIGHDF PIC  X(0001).
  3702     05  FILLER REDEFINES BORIGHDF.
  3703         10  BORIGHDA PIC  X(0001).
  3704     05  BORIGHDI PIC  X(0009).
  3705*    -------------------------------
  3706     05  DMDBILL PIC S9(0004) COMP.
  3707     05  DMDBILF PIC  X(0001).
  3708     05  FILLER REDEFINES DMDBILF.
  3709         10  DMDBILA PIC  X(0001).
  3710     05  DMDBILI PIC  X(0006).
  3711*    -------------------------------
  3712     05  BFORCEL PIC S9(0004) COMP.
  3713     05  BFORCEF PIC  X(0001).
  3714     05  FILLER REDEFINES BFORCEF.
  3715         10  BFORCEA PIC  X(0001).
  3716     05  BFORCEI PIC  X(0001).
  3717*    -------------------------------
  3718     05  BENTRYL PIC S9(0004) COMP.
  3719     05  BENTRYF PIC  X(0001).
  3720     05  FILLER REDEFINES BENTRYF.
  3721         10  BENTRYA PIC  X(0001).
  3722     05  BENTRYI PIC  X(0001).
  3723*    -------------------------------
  3724     05  BREINL PIC S9(0004) COMP.
  3725     05  BREINF PIC  X(0001).
  3726     05  FILLER REDEFINES BREINF.
  3727         10  BREINA PIC  X(0001).
  3728     05  BREINI PIC  X(0001).
  3729*    -------------------------------
  3730     05  BBILCDL PIC S9(0004) COMP.
  3731     05  BBILCDF PIC  X(0001).
  3732     05  FILLER REDEFINES BBILCDF.
  3733         10  BBILCDA PIC  X(0001).
  3734     05  BBILCDI PIC  X(0001).
  3735*    -------------------------------
  3736     05  BUNWRITL PIC S9(0004) COMP.
  3737     05  BUNWRITF PIC  X(0001).
  3738     05  FILLER REDEFINES BUNWRITF.
  3739         10  BUNWRITA PIC  X(0001).
  3740     05  BUNWRITI PIC  X(0001).
  3741*    -------------------------------
  3742     05  BSKPCDL PIC S9(0004) COMP.
  3743     05  BSKPCDF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  72
* EL6311.cbl
  3744     05  FILLER REDEFINES BSKPCDF.
  3745         10  BSKPCDA PIC  X(0001).
  3746     05  BSKPCDI PIC  X(0001).
  3747*    -------------------------------
  3748     05  BINDGRPL PIC S9(0004) COMP.
  3749     05  BINDGRPF PIC  X(0001).
  3750     05  FILLER REDEFINES BINDGRPF.
  3751         10  BINDGRPA PIC  X(0001).
  3752     05  BINDGRPI PIC  X(0001).
  3753*    -------------------------------
  3754     05  BSIGL PIC S9(0004) COMP.
  3755     05  BSIGF PIC  X(0001).
  3756     05  FILLER REDEFINES BSIGF.
  3757         10  BSIGA PIC  X(0001).
  3758     05  BSIGI PIC  X(0001).
  3759*    -------------------------------
  3760     05  BRTCLSL PIC S9(0004) COMP.
  3761     05  BRTCLSF PIC  X(0001).
  3762     05  FILLER REDEFINES BRTCLSF.
  3763         10  BRTCLSA PIC  X(0001).
  3764     05  BRTCLSI PIC  X(0002).
  3765*    -------------------------------
  3766     05  BCHGCNTL PIC S9(0004) COMP.
  3767     05  BCHGCNTF PIC  X(0001).
  3768     05  FILLER REDEFINES BCHGCNTF.
  3769         10  BCHGCNTA PIC  X(0001).
  3770     05  BCHGCNTI PIC  X(0003).
  3771*    -------------------------------
  3772     05  BMEMBERL PIC S9(0004) COMP.
  3773     05  BMEMBERF PIC  X(0001).
  3774     05  FILLER REDEFINES BMEMBERF.
  3775         10  BMEMBERA PIC  X(0001).
  3776     05  BMEMBERI PIC  X(0012).
  3777*    -------------------------------
  3778     05  BORGNOL PIC S9(0004) COMP.
  3779     05  BORGNOF PIC  X(0001).
  3780     05  FILLER REDEFINES BORGNOF.
  3781         10  BORGNOA PIC  X(0001).
  3782     05  BORGNOI PIC  X(0006).
  3783*    -------------------------------
  3784     05  BORGSEQL PIC S9(0004) COMP.
  3785     05  BORGSEQF PIC  X(0001).
  3786     05  FILLER REDEFINES BORGSEQF.
  3787         10  BORGSEQA PIC  X(0001).
  3788     05  BORGSEQI PIC  X(0004).
  3789*    -------------------------------
  3790     05  BBILLEDL PIC S9(0004) COMP.
  3791     05  BBILLEDF PIC  X(0001).
  3792     05  FILLER REDEFINES BBILLEDF.
  3793         10  BBILLEDA PIC  X(0001).
  3794     05  BBILLEDI PIC  9(9).
  3795*    -------------------------------
  3796     05  BKIND1L PIC S9(0004) COMP.
  3797     05  BKIND1F PIC  X(0001).
  3798     05  FILLER REDEFINES BKIND1F.
  3799         10  BKIND1A PIC  X(0001).
  3800     05  BKIND1I PIC  X(0002).
  3801*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  73
* EL6311.cbl
  3802     05  BTYPE1L PIC S9(0004) COMP.
  3803     05  BTYPE1F PIC  X(0001).
  3804     05  FILLER REDEFINES BTYPE1F.
  3805         10  BTYPE1A PIC  X(0001).
  3806     05  BTYPE1I PIC  X(0003).
  3807*    -------------------------------
  3808     05  BTERM1L PIC S9(0004) COMP.
  3809     05  BTERM1F PIC  X(0001).
  3810     05  FILLER REDEFINES BTERM1F.
  3811         10  BTERM1A PIC  X(0001).
  3812     05  BTERM1I PIC  X(0003).
  3813*    -------------------------------
  3814     05  BBEN1L PIC S9(0004) COMP.
  3815     05  BBEN1F PIC  X(0001).
  3816     05  FILLER REDEFINES BBEN1F.
  3817         10  BBEN1A PIC  X(0001).
  3818     05  BBEN1I PIC  X(0012).
  3819*    -------------------------------
  3820     05  BPREM1L PIC S9(0004) COMP.
  3821     05  BPREM1F PIC  X(0001).
  3822     05  FILLER REDEFINES BPREM1F.
  3823         10  BPREM1A PIC  X(0001).
  3824     05  BPREM1I PIC  X(0011).
  3825*    -------------------------------
  3826     05  BEXPIR1L PIC S9(0004) COMP.
  3827     05  BEXPIR1F PIC  X(0001).
  3828     05  FILLER REDEFINES BEXPIR1F.
  3829         10  BEXPIR1A PIC  X(0001).
  3830     05  BEXPIR1I PIC  X(0008).
  3831*    -------------------------------
  3832     05  BCP1L PIC S9(0004) COMP.
  3833     05  BCP1F PIC  X(0001).
  3834     05  FILLER REDEFINES BCP1F.
  3835         10  BCP1A PIC  X(0001).
  3836     05  BCP1I PIC  X(0002).
  3837*    -------------------------------
  3838     05  BALTBN1L PIC S9(0004) COMP.
  3839     05  BALTBN1F PIC  X(0001).
  3840     05  FILLER REDEFINES BALTBN1F.
  3841         10  BALTBN1A PIC  X(0001).
  3842     05  BALTBN1I PIC  X(0012).
  3843*    -------------------------------
  3844     05  BALTPR1L PIC S9(0004) COMP.
  3845     05  BALTPR1F PIC  X(0001).
  3846     05  FILLER REDEFINES BALTPR1F.
  3847         10  BALTPR1A PIC  X(0001).
  3848     05  BALTPR1I PIC  X(0011).
  3849*    -------------------------------
  3850     05  BBNCD1L PIC S9(0004) COMP.
  3851     05  BBNCD1F PIC  X(0001).
  3852     05  FILLER REDEFINES BBNCD1F.
  3853         10  BBNCD1A PIC  X(0001).
  3854     05  BBNCD1I PIC  X(0003).
  3855*    -------------------------------
  3856     05  BCPRM1L PIC S9(0004) COMP.
  3857     05  BCPRM1F PIC  X(0001).
  3858     05  FILLER REDEFINES BCPRM1F.
  3859         10  BCPRM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  74
* EL6311.cbl
  3860     05  BCPRM1I PIC  X(0011).
  3861*    -------------------------------
  3862     05  BCAPRM1L PIC S9(0004) COMP.
  3863     05  BCAPRM1F PIC  X(0001).
  3864     05  FILLER REDEFINES BCAPRM1F.
  3865         10  BCAPRM1A PIC  X(0001).
  3866     05  BCAPRM1I PIC  X(0011).
  3867*    -------------------------------
  3868     05  BENABR1L PIC S9(0004) COMP.
  3869     05  BENABR1F PIC  X(0001).
  3870     05  FILLER REDEFINES BENABR1F.
  3871         10  BENABR1A PIC  X(0001).
  3872     05  BENABR1I PIC  X(0005).
  3873*    -------------------------------
  3874     05  BDIFF1L PIC S9(0004) COMP.
  3875     05  BDIFF1F PIC  X(0001).
  3876     05  FILLER REDEFINES BDIFF1F.
  3877         10  BDIFF1A PIC  X(0001).
  3878     05  BDIFF1I PIC  X(0011).
  3879*    -------------------------------
  3880     05  BBILIT1L PIC S9(0004) COMP.
  3881     05  BBILIT1F PIC  X(0001).
  3882     05  FILLER REDEFINES BBILIT1F.
  3883         10  BBILIT1A PIC  X(0001).
  3884     05  BBILIT1I PIC  X(0008).
  3885*    -------------------------------
  3886     05  BADIFF1L PIC S9(0004) COMP.
  3887     05  BADIFF1F PIC  X(0001).
  3888     05  FILLER REDEFINES BADIFF1F.
  3889         10  BADIFF1A PIC  X(0001).
  3890     05  BADIFF1I PIC  X(0011).
  3891*    -------------------------------
  3892     05  BKIND2L PIC S9(0004) COMP.
  3893     05  BKIND2F PIC  X(0001).
  3894     05  FILLER REDEFINES BKIND2F.
  3895         10  BKIND2A PIC  X(0001).
  3896     05  BKIND2I PIC  X(0002).
  3897*    -------------------------------
  3898     05  BTYPE2L PIC S9(0004) COMP.
  3899     05  BTYPE2F PIC  X(0001).
  3900     05  FILLER REDEFINES BTYPE2F.
  3901         10  BTYPE2A PIC  X(0001).
  3902     05  BTYPE2I PIC  X(0003).
  3903*    -------------------------------
  3904     05  BTERM2L PIC S9(0004) COMP.
  3905     05  BTERM2F PIC  X(0001).
  3906     05  FILLER REDEFINES BTERM2F.
  3907         10  BTERM2A PIC  X(0001).
  3908     05  BTERM2I PIC  X(0003).
  3909*    -------------------------------
  3910     05  BBEN2L PIC S9(0004) COMP.
  3911     05  BBEN2F PIC  X(0001).
  3912     05  FILLER REDEFINES BBEN2F.
  3913         10  BBEN2A PIC  X(0001).
  3914     05  BBEN2I PIC  X(0012).
  3915*    -------------------------------
  3916     05  BPREM2L PIC S9(0004) COMP.
  3917     05  BPREM2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  75
* EL6311.cbl
  3918     05  FILLER REDEFINES BPREM2F.
  3919         10  BPREM2A PIC  X(0001).
  3920     05  BPREM2I PIC  X(0011).
  3921*    -------------------------------
  3922     05  BEXPIR2L PIC S9(0004) COMP.
  3923     05  BEXPIR2F PIC  X(0001).
  3924     05  FILLER REDEFINES BEXPIR2F.
  3925         10  BEXPIR2A PIC  X(0001).
  3926     05  BEXPIR2I PIC  X(0008).
  3927*    -------------------------------
  3928     05  BCP2L PIC S9(0004) COMP.
  3929     05  BCP2F PIC  X(0001).
  3930     05  FILLER REDEFINES BCP2F.
  3931         10  BCP2A PIC  X(0001).
  3932     05  BCP2I PIC  X(0002).
  3933*    -------------------------------
  3934     05  BALTBN2L PIC S9(0004) COMP.
  3935     05  BALTBN2F PIC  X(0001).
  3936     05  FILLER REDEFINES BALTBN2F.
  3937         10  BALTBN2A PIC  X(0001).
  3938     05  BALTBN2I PIC  X(0012).
  3939*    -------------------------------
  3940     05  BALTPR2L PIC S9(0004) COMP.
  3941     05  BALTPR2F PIC  X(0001).
  3942     05  FILLER REDEFINES BALTPR2F.
  3943         10  BALTPR2A PIC  X(0001).
  3944     05  BALTPR2I PIC  X(0011).
  3945*    -------------------------------
  3946     05  BBNCD2L PIC S9(0004) COMP.
  3947     05  BBNCD2F PIC  X(0001).
  3948     05  FILLER REDEFINES BBNCD2F.
  3949         10  BBNCD2A PIC  X(0001).
  3950     05  BBNCD2I PIC  X(0003).
  3951*    -------------------------------
  3952     05  BCPRM2L PIC S9(0004) COMP.
  3953     05  BCPRM2F PIC  X(0001).
  3954     05  FILLER REDEFINES BCPRM2F.
  3955         10  BCPRM2A PIC  X(0001).
  3956     05  BCPRM2I PIC  X(0011).
  3957*    -------------------------------
  3958     05  BCAPRM2L PIC S9(0004) COMP.
  3959     05  BCAPRM2F PIC  X(0001).
  3960     05  FILLER REDEFINES BCAPRM2F.
  3961         10  BCAPRM2A PIC  X(0001).
  3962     05  BCAPRM2I PIC  X(0011).
  3963*    -------------------------------
  3964     05  BENABR2L PIC S9(0004) COMP.
  3965     05  BENABR2F PIC  X(0001).
  3966     05  FILLER REDEFINES BENABR2F.
  3967         10  BENABR2A PIC  X(0001).
  3968     05  BENABR2I PIC  X(0005).
  3969*    -------------------------------
  3970     05  BDIFF2L PIC S9(0004) COMP.
  3971     05  BDIFF2F PIC  X(0001).
  3972     05  FILLER REDEFINES BDIFF2F.
  3973         10  BDIFF2A PIC  X(0001).
  3974     05  BDIFF2I PIC  X(0011).
  3975*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  76
* EL6311.cbl
  3976     05  BBILIT2L PIC S9(0004) COMP.
  3977     05  BBILIT2F PIC  X(0001).
  3978     05  FILLER REDEFINES BBILIT2F.
  3979         10  BBILIT2A PIC  X(0001).
  3980     05  BBILIT2I PIC  X(0008).
  3981*    -------------------------------
  3982     05  BADIFF2L PIC S9(0004) COMP.
  3983     05  BADIFF2F PIC  X(0001).
  3984     05  FILLER REDEFINES BADIFF2F.
  3985         10  BADIFF2A PIC  X(0001).
  3986     05  BADIFF2I PIC  X(0011).
  3987*    -------------------------------
  3988     05  BERMSG1L PIC S9(0004) COMP.
  3989     05  BERMSG1F PIC  X(0001).
  3990     05  FILLER REDEFINES BERMSG1F.
  3991         10  BERMSG1A PIC  X(0001).
  3992     05  BERMSG1I PIC  X(0078).
  3993*    -------------------------------
  3994     05  BERMSG2L PIC S9(0004) COMP.
  3995     05  BERMSG2F PIC  X(0001).
  3996     05  FILLER REDEFINES BERMSG2F.
  3997         10  BERMSG2A PIC  X(0001).
  3998     05  BERMSG2I PIC  X(0078).
  3999*    -------------------------------
  4000     05  BERMSG3L PIC S9(0004) COMP.
  4001     05  BERMSG3F PIC  X(0001).
  4002     05  FILLER REDEFINES BERMSG3F.
  4003         10  BERMSG3A PIC  X(0001).
  4004     05  BERMSG3I PIC  X(0078).
  4005*    -------------------------------
  4006     05  BPFENTRL PIC S9(0004) COMP.
  4007     05  BPFENTRF PIC  X(0001).
  4008     05  FILLER REDEFINES BPFENTRF.
  4009         10  BPFENTRA PIC  X(0001).
  4010     05  BPFENTRI PIC  9(2).
  4011*    -------------------------------
  4012     05  BPF5HDRL PIC S9(0004) COMP.
  4013     05  BPF5HDRF PIC  X(0001).
  4014     05  FILLER REDEFINES BPF5HDRF.
  4015         10  BPF5HDRA PIC  X(0001).
  4016     05  BPF5HDRI PIC  X(0005).
  4017*    -------------------------------
  4018     05  BPF4HDRL PIC S9(0004) COMP.
  4019     05  BPF4HDRF PIC  X(0001).
  4020     05  FILLER REDEFINES BPF4HDRF.
  4021         10  BPF4HDRA PIC  X(0001).
  4022     05  BPF4HDRI PIC  X(0013).
  4023*    -------------------------------
  4024     05  BF15HDRL PIC S9(0004) COMP.
  4025     05  BF15HDRF PIC  X(0001).
  4026     05  FILLER REDEFINES BF15HDRF.
  4027         10  BF15HDRA PIC  X(0001).
  4028     05  BF15HDRI PIC  X(0010).
  4029 01  EL631BO REDEFINES EL631BI.
  4030     05  FILLER            PIC  X(0012).
  4031*    -------------------------------
  4032     05  FILLER            PIC  X(0003).
  4033     05  BDATEO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  77
* EL6311.cbl
  4034*    -------------------------------
  4035     05  FILLER            PIC  X(0003).
  4036     05  BTIMEO PIC  99.99.
  4037*    -------------------------------
  4038     05  FILLER            PIC  X(0003).
  4039     05  BHEADO PIC  X(0038).
  4040*    -------------------------------
  4041     05  FILLER            PIC  X(0003).
  4042     05  BNCERTLO PIC  X(0008).
  4043*    -------------------------------
  4044     05  FILLER            PIC  X(0003).
  4045     05  BNCERTO PIC  X(0011).
  4046*    -------------------------------
  4047     05  FILLER            PIC  X(0003).
  4048     05  BNSTATLO PIC  X(0009).
  4049*    -------------------------------
  4050     05  FILLER            PIC  X(0003).
  4051     05  BNSTATO PIC  X(0002).
  4052*    -------------------------------
  4053     05  FILLER            PIC  X(0003).
  4054     05  BCHGTO PIC  X(0004).
  4055*    -------------------------------
  4056     05  FILLER            PIC  X(0003).
  4057     05  BCHGO PIC  ZZZ9.
  4058*    -------------------------------
  4059     05  FILLER            PIC  X(0003).
  4060     05  BCOMPIDO PIC  X(0003).
  4061*    -------------------------------
  4062     05  FILLER            PIC  X(0003).
  4063     05  BREGIONO PIC  X(0006).
  4064*    -------------------------------
  4065     05  FILLER            PIC  X(0003).
  4066     05  BUSERO PIC  X(0004).
  4067*    -------------------------------
  4068     05  FILLER            PIC  X(0003).
  4069     05  BMAINTO PIC  X(0001).
  4070*    -------------------------------
  4071     05  FILLER            PIC  X(0003).
  4072     05  BMANTBYO PIC  X(0004).
  4073*    -------------------------------
  4074     05  FILLER            PIC  X(0003).
  4075     05  BCHGHDGO PIC  X(0003).
  4076*    -------------------------------
  4077     05  FILLER            PIC  X(0003).
  4078     05  BMANTDTO PIC  X(0008).
  4079*    -------------------------------
  4080     05  FILLER            PIC  X(0003).
  4081     05  BMANTATO PIC  99.99.
  4082*    -------------------------------
  4083     05  FILLER            PIC  X(0003).
  4084     05  BCSRO PIC  X(0004).
  4085*    -------------------------------
  4086     05  FILLER            PIC  X(0003).
  4087     05  BBATCHO PIC  X(0006).
  4088*    -------------------------------
  4089     05  FILLER            PIC  X(0003).
  4090     05  BSEQO PIC  X(0004).
  4091*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  78
* EL6311.cbl
  4092     05  FILLER            PIC  X(0003).
  4093     05  BMOENDTO PIC  X(0008).
  4094*    -------------------------------
  4095     05  FILLER            PIC  X(0003).
  4096     05  BCARRO PIC  X(0001).
  4097*    -------------------------------
  4098     05  FILLER            PIC  X(0003).
  4099     05  BGROUPO PIC  X(0006).
  4100*    -------------------------------
  4101     05  FILLER            PIC  X(0003).
  4102     05  BSTATEO PIC  X(0002).
  4103*    -------------------------------
  4104     05  FILLER            PIC  X(0003).
  4105     05  BACCTO PIC  X(0010).
  4106*    -------------------------------
  4107     05  FILLER            PIC  X(0003).
  4108     05  BVINHO PIC  X(0004).
  4109*    -------------------------------
  4110     05  FILLER            PIC  X(0003).
  4111     05  BVINO PIC  X(0017).
  4112*    -------------------------------
  4113     05  FILLER            PIC  X(0003).
  4114     05  BREFHDGO PIC  X(0004).
  4115*    -------------------------------
  4116     05  FILLER            PIC  X(0003).
  4117     05  BREFO PIC  X(0012).
  4118*    -------------------------------
  4119     05  FILLER            PIC  X(0003).
  4120     05  BAGEDEFO PIC  X(0004).
  4121*    -------------------------------
  4122     05  FILLER            PIC  X(0003).
  4123     05  BCERTNOO PIC  X(0010).
  4124*    -------------------------------
  4125     05  FILLER            PIC  X(0003).
  4126     05  BSUFIXO PIC  X(0001).
  4127*    -------------------------------
  4128     05  FILLER            PIC  X(0003).
  4129     05  BEFFDTO PIC  X(0008).
  4130*    -------------------------------
  4131     05  FILLER            PIC  X(0003).
  4132     05  BLSTNMO PIC  X(0015).
  4133*    -------------------------------
  4134     05  FILLER            PIC  X(0003).
  4135     05  B1STNMO PIC  X(0010).
  4136*    -------------------------------
  4137     05  FILLER            PIC  X(0003).
  4138     05  BINITO PIC  X(0001).
  4139*    -------------------------------
  4140     05  FILLER            PIC  X(0003).
  4141     05  BSEXO PIC  X(0001).
  4142*    -------------------------------
  4143     05  FILLER            PIC  X(0003).
  4144     05  BAGEO PIC  X(0002).
  4145*    -------------------------------
  4146     05  FILLER            PIC  X(0003).
  4147     05  BBIRTHO PIC  X(0008).
  4148*    -------------------------------
  4149     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  79
* EL6311.cbl
  4150     05  B1STPMTO PIC  X(0008).
  4151*    -------------------------------
  4152     05  FILLER            PIC  X(0003).
  4153     05  BDAYSO PIC  X(0003).
  4154*    -------------------------------
  4155     05  FILLER            PIC  X(0003).
  4156     05  BLNTRMO PIC  X(0003).
  4157*    -------------------------------
  4158     05  FILLER            PIC  X(0003).
  4159     05  BLNOFCRO PIC  X(0005).
  4160*    -------------------------------
  4161     05  FILLER            PIC  X(0003).
  4162     05  BMODEO PIC  X(0001).
  4163*    -------------------------------
  4164     05  FILLER            PIC  X(0003).
  4165     05  BFREQO PIC  X(0002).
  4166*    -------------------------------
  4167     05  FILLER            PIC  X(0003).
  4168     05  BPMTSO PIC  X(0003).
  4169*    -------------------------------
  4170     05  FILLER            PIC  X(0003).
  4171     05  BPMTAMTO PIC  ZZZZZ9.99.
  4172*    -------------------------------
  4173     05  FILLER            PIC  X(0003).
  4174     05  BAPRO PIC  99.9999.
  4175*    -------------------------------
  4176     05  FILLER            PIC  X(0003).
  4177     05  BLIVESO PIC  Z,ZZZ,ZZZ.
  4178*    -------------------------------
  4179     05  FILLER            PIC  X(0003).
  4180     05  BMEMCAPO PIC  X(0011).
  4181*    -------------------------------
  4182     05  FILLER            PIC  X(0003).
  4183     05  BORIGHDO PIC  X(0009).
  4184*    -------------------------------
  4185     05  FILLER            PIC  X(0003).
  4186     05  DMDBILO PIC  X(0006).
  4187*    -------------------------------
  4188     05  FILLER            PIC  X(0003).
  4189     05  BFORCEO PIC  X(0001).
  4190*    -------------------------------
  4191     05  FILLER            PIC  X(0003).
  4192     05  BENTRYO PIC  X(0001).
  4193*    -------------------------------
  4194     05  FILLER            PIC  X(0003).
  4195     05  BREINO PIC  X(0001).
  4196*    -------------------------------
  4197     05  FILLER            PIC  X(0003).
  4198     05  BBILCDO PIC  X(0001).
  4199*    -------------------------------
  4200     05  FILLER            PIC  X(0003).
  4201     05  BUNWRITO PIC  X(0001).
  4202*    -------------------------------
  4203     05  FILLER            PIC  X(0003).
  4204     05  BSKPCDO PIC  X(0001).
  4205*    -------------------------------
  4206     05  FILLER            PIC  X(0003).
  4207     05  BINDGRPO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  80
* EL6311.cbl
  4208*    -------------------------------
  4209     05  FILLER            PIC  X(0003).
  4210     05  BSIGO PIC  X(0001).
  4211*    -------------------------------
  4212     05  FILLER            PIC  X(0003).
  4213     05  BRTCLSO PIC  X(0002).
  4214*    -------------------------------
  4215     05  FILLER            PIC  X(0003).
  4216     05  BCHGCNTO PIC  X(0003).
  4217*    -------------------------------
  4218     05  FILLER            PIC  X(0003).
  4219     05  BMEMBERO PIC  X(0012).
  4220*    -------------------------------
  4221     05  FILLER            PIC  X(0003).
  4222     05  BORGNOO PIC  X(0006).
  4223*    -------------------------------
  4224     05  FILLER            PIC  X(0003).
  4225     05  BORGSEQO PIC  X(0004).
  4226*    -------------------------------
  4227     05  FILLER            PIC  X(0003).
  4228     05  BBILLEDO PIC  Z,ZZZ,ZZZ.
  4229*    -------------------------------
  4230     05  FILLER            PIC  X(0003).
  4231     05  BKIND1O PIC  X(0002).
  4232*    -------------------------------
  4233     05  FILLER            PIC  X(0003).
  4234     05  BTYPE1O PIC  X(0003).
  4235*    -------------------------------
  4236     05  FILLER            PIC  X(0003).
  4237     05  BTERM1O PIC  X(0003).
  4238*    -------------------------------
  4239     05  FILLER            PIC  X(0003).
  4240     05  BBEN1O PIC  X(0012).
  4241*    -------------------------------
  4242     05  FILLER            PIC  X(0003).
  4243     05  BPREM1O PIC  X(0011).
  4244*    -------------------------------
  4245     05  FILLER            PIC  X(0003).
  4246     05  BEXPIR1O PIC  X(0008).
  4247*    -------------------------------
  4248     05  FILLER            PIC  X(0003).
  4249     05  BCP1O PIC  X(0002).
  4250*    -------------------------------
  4251     05  FILLER            PIC  X(0003).
  4252     05  BALTBN1O PIC  X(0012).
  4253*    -------------------------------
  4254     05  FILLER            PIC  X(0003).
  4255     05  BALTPR1O PIC  X(0011).
  4256*    -------------------------------
  4257     05  FILLER            PIC  X(0003).
  4258     05  BBNCD1O PIC  X(0003).
  4259*    -------------------------------
  4260     05  FILLER            PIC  X(0003).
  4261     05  BCPRM1O PIC  X(0011).
  4262*    -------------------------------
  4263     05  FILLER            PIC  X(0003).
  4264     05  BCAPRM1O PIC  X(0011).
  4265*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  81
* EL6311.cbl
  4266     05  FILLER            PIC  X(0003).
  4267     05  BENABR1O PIC  X(0005).
  4268*    -------------------------------
  4269     05  FILLER            PIC  X(0003).
  4270     05  BDIFF1O PIC  X(0011).
  4271*    -------------------------------
  4272     05  FILLER            PIC  X(0003).
  4273     05  BBILIT1O PIC  X(0008).
  4274*    -------------------------------
  4275     05  FILLER            PIC  X(0003).
  4276     05  BADIFF1O PIC  X(0011).
  4277*    -------------------------------
  4278     05  FILLER            PIC  X(0003).
  4279     05  BKIND2O PIC  X(0002).
  4280*    -------------------------------
  4281     05  FILLER            PIC  X(0003).
  4282     05  BTYPE2O PIC  X(0003).
  4283*    -------------------------------
  4284     05  FILLER            PIC  X(0003).
  4285     05  BTERM2O PIC  X(0003).
  4286*    -------------------------------
  4287     05  FILLER            PIC  X(0003).
  4288     05  BBEN2O PIC  X(0012).
  4289*    -------------------------------
  4290     05  FILLER            PIC  X(0003).
  4291     05  BPREM2O PIC  X(0011).
  4292*    -------------------------------
  4293     05  FILLER            PIC  X(0003).
  4294     05  BEXPIR2O PIC  X(0008).
  4295*    -------------------------------
  4296     05  FILLER            PIC  X(0003).
  4297     05  BCP2O PIC  X(0002).
  4298*    -------------------------------
  4299     05  FILLER            PIC  X(0003).
  4300     05  BALTBN2O PIC  X(0012).
  4301*    -------------------------------
  4302     05  FILLER            PIC  X(0003).
  4303     05  BALTPR2O PIC  X(0011).
  4304*    -------------------------------
  4305     05  FILLER            PIC  X(0003).
  4306     05  BBNCD2O PIC  X(0003).
  4307*    -------------------------------
  4308     05  FILLER            PIC  X(0003).
  4309     05  BCPRM2O PIC  X(0011).
  4310*    -------------------------------
  4311     05  FILLER            PIC  X(0003).
  4312     05  BCAPRM2O PIC  X(0011).
  4313*    -------------------------------
  4314     05  FILLER            PIC  X(0003).
  4315     05  BENABR2O PIC  X(0005).
  4316*    -------------------------------
  4317     05  FILLER            PIC  X(0003).
  4318     05  BDIFF2O PIC  X(0011).
  4319*    -------------------------------
  4320     05  FILLER            PIC  X(0003).
  4321     05  BBILIT2O PIC  X(0008).
  4322*    -------------------------------
  4323     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  82
* EL6311.cbl
  4324     05  BADIFF2O PIC  X(0011).
  4325*    -------------------------------
  4326     05  FILLER            PIC  X(0003).
  4327     05  BERMSG1O PIC  X(0078).
  4328*    -------------------------------
  4329     05  FILLER            PIC  X(0003).
  4330     05  BERMSG2O PIC  X(0078).
  4331*    -------------------------------
  4332     05  FILLER            PIC  X(0003).
  4333     05  BERMSG3O PIC  X(0078).
  4334*    -------------------------------
  4335     05  FILLER            PIC  X(0003).
  4336     05  BPFENTRO PIC  X(0002).
  4337*    -------------------------------
  4338     05  FILLER            PIC  X(0003).
  4339     05  BPF5HDRO PIC  X(0005).
  4340*    -------------------------------
  4341     05  FILLER            PIC  X(0003).
  4342     05  BPF4HDRO PIC  X(0013).
  4343*    -------------------------------
  4344     05  FILLER            PIC  X(0003).
  4345     05  BF15HDRO PIC  X(0010).
  4346*    -------------------------------
  4347 01  EL631CI REDEFINES EL631BI.
  4348     05  FILLER            PIC  X(0012).
  4349*    -------------------------------
  4350     05  CDATEL PIC S9(0004) COMP.
  4351     05  CDATEF PIC  X(0001).
  4352     05  FILLER REDEFINES CDATEF.
  4353         10  CDATEA PIC  X(0001).
  4354     05  CDATEI PIC  X(0008).
  4355*    -------------------------------
  4356     05  CTIMEL PIC S9(0004) COMP.
  4357     05  CTIMEF PIC  X(0001).
  4358     05  FILLER REDEFINES CTIMEF.
  4359         10  CTIMEA PIC  X(0001).
  4360     05  CTIMEI PIC  X(0005).
  4361*    -------------------------------
  4362     05  CHEADL PIC S9(0004) COMP.
  4363     05  CHEADF PIC  X(0001).
  4364     05  FILLER REDEFINES CHEADF.
  4365         10  CHEADA PIC  X(0001).
  4366     05  CHEADI PIC  X(0038).
  4367*    -------------------------------
  4368     05  CCHGTL PIC S9(0004) COMP.
  4369     05  CCHGTF PIC  X(0001).
  4370     05  FILLER REDEFINES CCHGTF.
  4371         10  CCHGTA PIC  X(0001).
  4372     05  CCHGTI PIC  X(0004).
  4373*    -------------------------------
  4374     05  CCHGL PIC S9(0004) COMP.
  4375     05  CCHGF PIC  X(0001).
  4376     05  FILLER REDEFINES CCHGF.
  4377         10  CCHGA PIC  X(0001).
  4378     05  CCHGI PIC  X(0004).
  4379*    -------------------------------
  4380     05  CMAINTL PIC S9(0004) COMP.
  4381     05  CMAINTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  83
* EL6311.cbl
  4382     05  FILLER REDEFINES CMAINTF.
  4383         10  CMAINTA PIC  X(0001).
  4384     05  CMAINTI PIC  X(0001).
  4385*    -------------------------------
  4386     05  CMANTBYL PIC S9(0004) COMP.
  4387     05  CMANTBYF PIC  X(0001).
  4388     05  FILLER REDEFINES CMANTBYF.
  4389         10  CMANTBYA PIC  X(0001).
  4390     05  CMANTBYI PIC  X(0004).
  4391*    -------------------------------
  4392     05  CCHGHDGL PIC S9(0004) COMP.
  4393     05  CCHGHDGF PIC  X(0001).
  4394     05  FILLER REDEFINES CCHGHDGF.
  4395         10  CCHGHDGA PIC  X(0001).
  4396     05  CCHGHDGI PIC  X(0003).
  4397*    -------------------------------
  4398     05  CMANTDTL PIC S9(0004) COMP.
  4399     05  CMANTDTF PIC  X(0001).
  4400     05  FILLER REDEFINES CMANTDTF.
  4401         10  CMANTDTA PIC  X(0001).
  4402     05  CMANTDTI PIC  X(0008).
  4403*    -------------------------------
  4404     05  CMANTATL PIC S9(0004) COMP.
  4405     05  CMANTATF PIC  X(0001).
  4406     05  FILLER REDEFINES CMANTATF.
  4407         10  CMANTATA PIC  X(0001).
  4408     05  CMANTATI PIC  X(0005).
  4409*    -------------------------------
  4410     05  CCSRL PIC S9(0004) COMP.
  4411     05  CCSRF PIC  X(0001).
  4412     05  FILLER REDEFINES CCSRF.
  4413         10  CCSRA PIC  X(0001).
  4414     05  CCSRI PIC  X(0004).
  4415*    -------------------------------
  4416     05  CBATCHL PIC S9(0004) COMP.
  4417     05  CBATCHF PIC  X(0001).
  4418     05  FILLER REDEFINES CBATCHF.
  4419         10  CBATCHA PIC  X(0001).
  4420     05  CBATCHI PIC  X(0006).
  4421*    -------------------------------
  4422     05  CSEQL PIC S9(0004) COMP.
  4423     05  CSEQF PIC  X(0001).
  4424     05  FILLER REDEFINES CSEQF.
  4425         10  CSEQA PIC  X(0001).
  4426     05  CSEQI PIC  X(0004).
  4427*    -------------------------------
  4428     05  CMOENDTL PIC S9(0004) COMP.
  4429     05  CMOENDTF PIC  X(0001).
  4430     05  FILLER REDEFINES CMOENDTF.
  4431         10  CMOENDTA PIC  X(0001).
  4432     05  CMOENDTI PIC  X(0008).
  4433*    -------------------------------
  4434     05  CCARRL PIC S9(0004) COMP.
  4435     05  CCARRF PIC  X(0001).
  4436     05  FILLER REDEFINES CCARRF.
  4437         10  CCARRA PIC  X(0001).
  4438     05  CCARRI PIC  X(0001).
  4439*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  84
* EL6311.cbl
  4440     05  CGROUPL PIC S9(0004) COMP.
  4441     05  CGROUPF PIC  X(0001).
  4442     05  FILLER REDEFINES CGROUPF.
  4443         10  CGROUPA PIC  X(0001).
  4444     05  CGROUPI PIC  X(0006).
  4445*    -------------------------------
  4446     05  CSTATEL PIC S9(0004) COMP.
  4447     05  CSTATEF PIC  X(0001).
  4448     05  FILLER REDEFINES CSTATEF.
  4449         10  CSTATEA PIC  X(0001).
  4450     05  CSTATEI PIC  X(0002).
  4451*    -------------------------------
  4452     05  CACCTL PIC S9(0004) COMP.
  4453     05  CACCTF PIC  X(0001).
  4454     05  FILLER REDEFINES CACCTF.
  4455         10  CACCTA PIC  X(0001).
  4456     05  CACCTI PIC  X(0010).
  4457*    -------------------------------
  4458     05  CORIGHDL PIC S9(0004) COMP.
  4459     05  CORIGHDF PIC  X(0001).
  4460     05  FILLER REDEFINES CORIGHDF.
  4461         10  CORIGHDA PIC  X(0001).
  4462     05  CORIGHDI PIC  X(0011).
  4463*    -------------------------------
  4464     05  CORGNOL PIC S9(0004) COMP.
  4465     05  CORGNOF PIC  X(0001).
  4466     05  FILLER REDEFINES CORGNOF.
  4467         10  CORGNOA PIC  X(0001).
  4468     05  CORGNOI PIC  X(0006).
  4469*    -------------------------------
  4470     05  CORGSEQL PIC S9(0004) COMP.
  4471     05  CORGSEQF PIC  X(0001).
  4472     05  FILLER REDEFINES CORGSEQF.
  4473         10  CORGSEQA PIC  X(0001).
  4474     05  CORGSEQI PIC  X(0004).
  4475*    -------------------------------
  4476     05  CREFHDGL PIC S9(0004) COMP.
  4477     05  CREFHDGF PIC  X(0001).
  4478     05  FILLER REDEFINES CREFHDGF.
  4479         10  CREFHDGA PIC  X(0001).
  4480     05  CREFHDGI PIC  X(0010).
  4481*    -------------------------------
  4482     05  CREFL PIC S9(0004) COMP.
  4483     05  CREFF PIC  X(0001).
  4484     05  FILLER REDEFINES CREFF.
  4485         10  CREFA PIC  X(0001).
  4486     05  CREFI PIC  X(0012).
  4487*    -------------------------------
  4488     05  CNHINTL PIC S9(0004) COMP.
  4489     05  CNHINTF PIC  X(0001).
  4490     05  FILLER REDEFINES CNHINTF.
  4491         10  CNHINTA PIC  X(0001).
  4492     05  CNHINTI PIC  9(7)V99.
  4493*    -------------------------------
  4494     05  CCERTNOL PIC S9(0004) COMP.
  4495     05  CCERTNOF PIC  X(0001).
  4496     05  FILLER REDEFINES CCERTNOF.
  4497         10  CCERTNOA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  85
* EL6311.cbl
  4498     05  CCERTNOI PIC  X(0010).
  4499*    -------------------------------
  4500     05  CSUFIXL PIC S9(0004) COMP.
  4501     05  CSUFIXF PIC  X(0001).
  4502     05  FILLER REDEFINES CSUFIXF.
  4503         10  CSUFIXA PIC  X(0001).
  4504     05  CSUFIXI PIC  X(0001).
  4505*    -------------------------------
  4506     05  CEFFDTL PIC S9(0004) COMP.
  4507     05  CEFFDTF PIC  X(0001).
  4508     05  FILLER REDEFINES CEFFDTF.
  4509         10  CEFFDTA PIC  X(0001).
  4510     05  CEFFDTI PIC  X(0008).
  4511*    -------------------------------
  4512     05  CLSTNML PIC S9(0004) COMP.
  4513     05  CLSTNMF PIC  X(0001).
  4514     05  FILLER REDEFINES CLSTNMF.
  4515         10  CLSTNMA PIC  X(0001).
  4516     05  CLSTNMI PIC  X(0015).
  4517*    -------------------------------
  4518     05  CPCYNL PIC S9(0004) COMP.
  4519     05  CPCYNF PIC  X(0001).
  4520     05  FILLER REDEFINES CPCYNF.
  4521         10  CPCYNA PIC  X(0001).
  4522     05  CPCYNI PIC  X(0001).
  4523*    -------------------------------
  4524     05  CINAMEL PIC S9(0004) COMP.
  4525     05  CINAMEF PIC  X(0001).
  4526     05  FILLER REDEFINES CINAMEF.
  4527         10  CINAMEA PIC  X(0001).
  4528     05  CINAMEI PIC  X(0015).
  4529*    -------------------------------
  4530     05  CINITSL PIC S9(0004) COMP.
  4531     05  CINITSF PIC  X(0001).
  4532     05  FILLER REDEFINES CINITSF.
  4533         10  CINITSA PIC  X(0001).
  4534     05  CINITSI PIC  X(0010).
  4535*    -------------------------------
  4536     05  CCANREAL PIC S9(0004) COMP.
  4537     05  CCANREAF PIC  X(0001).
  4538     05  FILLER REDEFINES CCANREAF.
  4539         10  CCANREAA PIC  X(0001).
  4540     05  CCANREAI PIC  X(0001).
  4541*    -------------------------------
  4542     05  CKIND1L PIC S9(0004) COMP.
  4543     05  CKIND1F PIC  X(0001).
  4544     05  FILLER REDEFINES CKIND1F.
  4545         10  CKIND1A PIC  X(0001).
  4546     05  CKIND1I PIC  X(0002).
  4547*    -------------------------------
  4548     05  CCANDT1L PIC S9(0004) COMP.
  4549     05  CCANDT1F PIC  X(0001).
  4550     05  FILLER REDEFINES CCANDT1F.
  4551         10  CCANDT1A PIC  X(0001).
  4552     05  CCANDT1I PIC  X(0008).
  4553*    -------------------------------
  4554     05  CREFND1L PIC S9(0004) COMP.
  4555     05  CREFND1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  86
* EL6311.cbl
  4556     05  FILLER REDEFINES CREFND1F.
  4557         10  CREFND1A PIC  X(0001).
  4558     05  CREFND1I PIC  S9(9)V99.
  4559*    -------------------------------
  4560     05  CMTHD1L PIC S9(0004) COMP.
  4561     05  CMTHD1F PIC  X(0001).
  4562     05  FILLER REDEFINES CMTHD1F.
  4563         10  CMTHD1A PIC  X(0001).
  4564     05  CMTHD1I PIC  X(0001).
  4565*    -------------------------------
  4566     05  CKIND2L PIC S9(0004) COMP.
  4567     05  CKIND2F PIC  X(0001).
  4568     05  FILLER REDEFINES CKIND2F.
  4569         10  CKIND2A PIC  X(0001).
  4570     05  CKIND2I PIC  X(0002).
  4571*    -------------------------------
  4572     05  CCANDT2L PIC S9(0004) COMP.
  4573     05  CCANDT2F PIC  X(0001).
  4574     05  FILLER REDEFINES CCANDT2F.
  4575         10  CCANDT2A PIC  X(0001).
  4576     05  CCANDT2I PIC  X(0008).
  4577*    -------------------------------
  4578     05  CREFND2L PIC S9(0004) COMP.
  4579     05  CREFND2F PIC  X(0001).
  4580     05  FILLER REDEFINES CREFND2F.
  4581         10  CREFND2A PIC  X(0001).
  4582     05  CREFND2I PIC  S9(9)V99.
  4583*    -------------------------------
  4584     05  CMTHD2L PIC S9(0004) COMP.
  4585     05  CMTHD2F PIC  X(0001).
  4586     05  FILLER REDEFINES CMTHD2F.
  4587         10  CMTHD2A PIC  X(0001).
  4588     05  CMTHD2I PIC  X(0001).
  4589*    -------------------------------
  4590     05  CLIVESL PIC S9(0004) COMP.
  4591     05  CLIVESF PIC  X(0001).
  4592     05  FILLER REDEFINES CLIVESF.
  4593         10  CLIVESA PIC  X(0001).
  4594     05  CLIVESI PIC  X(0003).
  4595*    -------------------------------
  4596     05  CFORCEL PIC S9(0004) COMP.
  4597     05  CFORCEF PIC  X(0001).
  4598     05  FILLER REDEFINES CFORCEF.
  4599         10  CFORCEA PIC  X(0001).
  4600     05  CFORCEI PIC  X(0001).
  4601*    -------------------------------
  4602     05  CBILCDL PIC S9(0004) COMP.
  4603     05  CBILCDF PIC  X(0001).
  4604     05  FILLER REDEFINES CBILCDF.
  4605         10  CBILCDA PIC  X(0001).
  4606     05  CBILCDI PIC  X(0001).
  4607*    -------------------------------
  4608     05  CCRFND1L PIC S9(0004) COMP.
  4609     05  CCRFND1F PIC  X(0001).
  4610     05  FILLER REDEFINES CCRFND1F.
  4611         10  CCRFND1A PIC  X(0001).
  4612     05  CCRFND1I PIC  X(0011).
  4613*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  87
* EL6311.cbl
  4614     05  CCRFND2L PIC S9(0004) COMP.
  4615     05  CCRFND2F PIC  X(0001).
  4616     05  FILLER REDEFINES CCRFND2F.
  4617         10  CCRFND2A PIC  X(0001).
  4618     05  CCRFND2I PIC  X(0011).
  4619*    -------------------------------
  4620     05  CBILIT1L PIC S9(0004) COMP.
  4621     05  CBILIT1F PIC  X(0001).
  4622     05  FILLER REDEFINES CBILIT1F.
  4623         10  CBILIT1A PIC  X(0001).
  4624     05  CBILIT1I PIC  X(0008).
  4625*    -------------------------------
  4626     05  CDRFND1L PIC S9(0004) COMP.
  4627     05  CDRFND1F PIC  X(0001).
  4628     05  FILLER REDEFINES CDRFND1F.
  4629         10  CDRFND1A PIC  X(0001).
  4630     05  CDRFND1I PIC  X(0011).
  4631*    -------------------------------
  4632     05  CBILIT2L PIC S9(0004) COMP.
  4633     05  CBILIT2F PIC  X(0001).
  4634     05  FILLER REDEFINES CBILIT2F.
  4635         10  CBILIT2A PIC  X(0001).
  4636     05  CBILIT2I PIC  X(0008).
  4637*    -------------------------------
  4638     05  CDRFND2L PIC S9(0004) COMP.
  4639     05  CDRFND2F PIC  X(0001).
  4640     05  FILLER REDEFINES CDRFND2F.
  4641         10  CDRFND2A PIC  X(0001).
  4642     05  CDRFND2I PIC  X(0011).
  4643*    -------------------------------
  4644     05  CCANTXTL PIC S9(0004) COMP.
  4645     05  CCANTXTF PIC  X(0001).
  4646     05  FILLER REDEFINES CCANTXTF.
  4647         10  CCANTXTA PIC  X(0001).
  4648     05  CCANTXTI PIC  X(0005).
  4649*    -------------------------------
  4650     05  CCANFEEL PIC S9(0004) COMP.
  4651     05  CCANFEEF PIC  X(0001).
  4652     05  FILLER REDEFINES CCANFEEF.
  4653         10  CCANFEEA PIC  X(0001).
  4654     05  CCANFEEI PIC  X(0002).
  4655*    -------------------------------
  4656     05  CTERM1L PIC S9(0004) COMP.
  4657     05  CTERM1F PIC  X(0001).
  4658     05  FILLER REDEFINES CTERM1F.
  4659         10  CTERM1A PIC  X(0001).
  4660     05  CTERM1I PIC  X(0003).
  4661*    -------------------------------
  4662     05  CRTERM1L PIC S9(0004) COMP.
  4663     05  CRTERM1F PIC  X(0001).
  4664     05  FILLER REDEFINES CRTERM1F.
  4665         10  CRTERM1A PIC  X(0001).
  4666     05  CRTERM1I PIC  X(0003).
  4667*    -------------------------------
  4668     05  CPREM1L PIC S9(0004) COMP.
  4669     05  CPREM1F PIC  X(0001).
  4670     05  FILLER REDEFINES CPREM1F.
  4671         10  CPREM1A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  88
* EL6311.cbl
  4672     05  CPREM1I PIC  X(0011).
  4673*    -------------------------------
  4674     05  CTERM2L PIC S9(0004) COMP.
  4675     05  CTERM2F PIC  X(0001).
  4676     05  FILLER REDEFINES CTERM2F.
  4677         10  CTERM2A PIC  X(0001).
  4678     05  CTERM2I PIC  X(0003).
  4679*    -------------------------------
  4680     05  CRTERM2L PIC S9(0004) COMP.
  4681     05  CRTERM2F PIC  X(0001).
  4682     05  FILLER REDEFINES CRTERM2F.
  4683         10  CRTERM2A PIC  X(0001).
  4684     05  CRTERM2I PIC  X(0003).
  4685*    -------------------------------
  4686     05  CPREM2L PIC S9(0004) COMP.
  4687     05  CPREM2F PIC  X(0001).
  4688     05  FILLER REDEFINES CPREM2F.
  4689         10  CPREM2A PIC  X(0001).
  4690     05  CPREM2I PIC  X(0011).
  4691*    -------------------------------
  4692     05  CENTRDTL PIC S9(0004) COMP.
  4693     05  CENTRDTF PIC  X(0001).
  4694     05  FILLER REDEFINES CENTRDTF.
  4695         10  CENTRDTA PIC  X(0001).
  4696     05  CENTRDTI PIC  X(0008).
  4697*    -------------------------------
  4698     05  CPAYEEL PIC S9(0004) COMP.
  4699     05  CPAYEEF PIC  X(0001).
  4700     05  FILLER REDEFINES CPAYEEF.
  4701         10  CPAYEEA PIC  X(0001).
  4702     05  CPAYEEI PIC  X(0006).
  4703*    -------------------------------
  4704     05  CRFNDSWL PIC S9(0004) COMP.
  4705     05  CRFNDSWF PIC  X(0001).
  4706     05  FILLER REDEFINES CRFNDSWF.
  4707         10  CRFNDSWA PIC  X(0001).
  4708     05  CRFNDSWI PIC  X(0003).
  4709*    -------------------------------
  4710     05  CLFHDGL PIC S9(0004) COMP.
  4711     05  CLFHDGF PIC  X(0001).
  4712     05  FILLER REDEFINES CLFHDGF.
  4713         10  CLFHDGA PIC  X(0001).
  4714     05  CLFHDGI PIC  X(0006).
  4715*    -------------------------------
  4716     05  CAHHDGL PIC S9(0004) COMP.
  4717     05  CAHHDGF PIC  X(0001).
  4718     05  FILLER REDEFINES CAHHDGF.
  4719         10  CAHHDGA PIC  X(0001).
  4720     05  CAHHDGI PIC  X(0006).
  4721*    -------------------------------
  4722     05  CENTDTL PIC S9(0004) COMP.
  4723     05  CENTDTF PIC  X(0001).
  4724     05  FILLER REDEFINES CENTDTF.
  4725         10  CENTDTA PIC  X(0001).
  4726     05  CENTDTI PIC  X(0008).
  4727*    -------------------------------
  4728     05  CENTBYL PIC S9(0004) COMP.
  4729     05  CENTBYF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  89
* EL6311.cbl
  4730     05  FILLER REDEFINES CENTBYF.
  4731         10  CENTBYA PIC  X(0001).
  4732     05  CENTBYI PIC  X(0004).
  4733*    -------------------------------
  4734     05  CCHGCNTL PIC S9(0004) COMP.
  4735     05  CCHGCNTF PIC  X(0001).
  4736     05  FILLER REDEFINES CCHGCNTF.
  4737         10  CCHGCNTA PIC  X(0001).
  4738     05  CCHGCNTI PIC  X(0003).
  4739*    -------------------------------
  4740     05  CLFREFNL PIC S9(0004) COMP.
  4741     05  CLFREFNF PIC  X(0001).
  4742     05  FILLER REDEFINES CLFREFNF.
  4743         10  CLFREFNA PIC  X(0001).
  4744     05  CLFREFNI PIC  X(0006).
  4745*    -------------------------------
  4746     05  CAHREFNL PIC S9(0004) COMP.
  4747     05  CAHREFNF PIC  X(0001).
  4748     05  FILLER REDEFINES CAHREFNF.
  4749         10  CAHREFNA PIC  X(0001).
  4750     05  CAHREFNI PIC  X(0006).
  4751*    -------------------------------
  4752     05  CREINCDL PIC S9(0004) COMP.
  4753     05  CREINCDF PIC  X(0001).
  4754     05  FILLER REDEFINES CREINCDF.
  4755         10  CREINCDA PIC  X(0001).
  4756     05  CREINCDI PIC  X(0003).
  4757*    -------------------------------
  4758     05  CAEFFDTL PIC S9(0004) COMP.
  4759     05  CAEFFDTF PIC  X(0001).
  4760     05  FILLER REDEFINES CAEFFDTF.
  4761         10  CAEFFDTA PIC  X(0001).
  4762     05  CAEFFDTI PIC  X(0008).
  4763*    -------------------------------
  4764     05  CAEXPDTL PIC S9(0004) COMP.
  4765     05  CAEXPDTF PIC  X(0001).
  4766     05  FILLER REDEFINES CAEXPDTF.
  4767         10  CAEXPDTA PIC  X(0001).
  4768     05  CAEXPDTI PIC  X(0008).
  4769*    -------------------------------
  4770     05  COMMLFL PIC S9(0004) COMP.
  4771     05  COMMLFF PIC  X(0001).
  4772     05  FILLER REDEFINES COMMLFF.
  4773         10  COMMLFA PIC  X(0001).
  4774     05  COMMLFI PIC  X(0006).
  4775*    -------------------------------
  4776     05  COMMAHL PIC S9(0004) COMP.
  4777     05  COMMAHF PIC  X(0001).
  4778     05  FILLER REDEFINES COMMAHF.
  4779         10  COMMAHA PIC  X(0001).
  4780     05  COMMAHI PIC  X(0006).
  4781*    -------------------------------
  4782     05  CERMSG1L PIC S9(0004) COMP.
  4783     05  CERMSG1F PIC  X(0001).
  4784     05  FILLER REDEFINES CERMSG1F.
  4785         10  CERMSG1A PIC  X(0001).
  4786     05  CERMSG1I PIC  X(0078).
  4787*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  90
* EL6311.cbl
  4788     05  CERMSG2L PIC S9(0004) COMP.
  4789     05  CERMSG2F PIC  X(0001).
  4790     05  FILLER REDEFINES CERMSG2F.
  4791         10  CERMSG2A PIC  X(0001).
  4792     05  CERMSG2I PIC  X(0078).
  4793*    -------------------------------
  4794     05  CERMSG3L PIC S9(0004) COMP.
  4795     05  CERMSG3F PIC  X(0001).
  4796     05  FILLER REDEFINES CERMSG3F.
  4797         10  CERMSG3A PIC  X(0001).
  4798     05  CERMSG3I PIC  X(0078).
  4799*    -------------------------------
  4800     05  CPFENTRL PIC S9(0004) COMP.
  4801     05  CPFENTRF PIC  X(0001).
  4802     05  FILLER REDEFINES CPFENTRF.
  4803         10  CPFENTRA PIC  X(0001).
  4804     05  CPFENTRI PIC  9(2).
  4805*    -------------------------------
  4806     05  CPF5HDRL PIC S9(0004) COMP.
  4807     05  CPF5HDRF PIC  X(0001).
  4808     05  FILLER REDEFINES CPF5HDRF.
  4809         10  CPF5HDRA PIC  X(0001).
  4810     05  CPF5HDRI PIC  X(0005).
  4811*    -------------------------------
  4812     05  CPF4HDRL PIC S9(0004) COMP.
  4813     05  CPF4HDRF PIC  X(0001).
  4814     05  FILLER REDEFINES CPF4HDRF.
  4815         10  CPF4HDRA PIC  X(0001).
  4816     05  CPF4HDRI PIC  X(0013).
  4817*    -------------------------------
  4818     05  CF15HDRL PIC S9(0004) COMP.
  4819     05  CF15HDRF PIC  X(0001).
  4820     05  FILLER REDEFINES CF15HDRF.
  4821         10  CF15HDRA PIC  X(0001).
  4822     05  CF15HDRI PIC  X(0022).
  4823 01  EL631CO REDEFINES EL631BI.
  4824     05  FILLER            PIC  X(0012).
  4825*    -------------------------------
  4826     05  FILLER            PIC  X(0003).
  4827     05  CDATEO PIC  X(0008).
  4828*    -------------------------------
  4829     05  FILLER            PIC  X(0003).
  4830     05  CTIMEO PIC  99.99.
  4831*    -------------------------------
  4832     05  FILLER            PIC  X(0003).
  4833     05  CHEADO PIC  X(0038).
  4834*    -------------------------------
  4835     05  FILLER            PIC  X(0003).
  4836     05  CCHGTO PIC  X(0004).
  4837*    -------------------------------
  4838     05  FILLER            PIC  X(0003).
  4839     05  CCHGO PIC  ZZZ9.
  4840*    -------------------------------
  4841     05  FILLER            PIC  X(0003).
  4842     05  CMAINTO PIC  X(0001).
  4843*    -------------------------------
  4844     05  FILLER            PIC  X(0003).
  4845     05  CMANTBYO PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  91
* EL6311.cbl
  4846*    -------------------------------
  4847     05  FILLER            PIC  X(0003).
  4848     05  CCHGHDGO PIC  X(0003).
  4849*    -------------------------------
  4850     05  FILLER            PIC  X(0003).
  4851     05  CMANTDTO PIC  X(0008).
  4852*    -------------------------------
  4853     05  FILLER            PIC  X(0003).
  4854     05  CMANTATO PIC  99.99.
  4855*    -------------------------------
  4856     05  FILLER            PIC  X(0003).
  4857     05  CCSRO PIC  X(0004).
  4858*    -------------------------------
  4859     05  FILLER            PIC  X(0003).
  4860     05  CBATCHO PIC  X(0006).
  4861*    -------------------------------
  4862     05  FILLER            PIC  X(0003).
  4863     05  CSEQO PIC  X(0004).
  4864*    -------------------------------
  4865     05  FILLER            PIC  X(0003).
  4866     05  CMOENDTO PIC  X(0008).
  4867*    -------------------------------
  4868     05  FILLER            PIC  X(0003).
  4869     05  CCARRO PIC  X(0001).
  4870*    -------------------------------
  4871     05  FILLER            PIC  X(0003).
  4872     05  CGROUPO PIC  X(0006).
  4873*    -------------------------------
  4874     05  FILLER            PIC  X(0003).
  4875     05  CSTATEO PIC  X(0002).
  4876*    -------------------------------
  4877     05  FILLER            PIC  X(0003).
  4878     05  CACCTO PIC  X(0010).
  4879*    -------------------------------
  4880     05  FILLER            PIC  X(0003).
  4881     05  CORIGHDO PIC  X(0011).
  4882*    -------------------------------
  4883     05  FILLER            PIC  X(0003).
  4884     05  CORGNOO PIC  X(0006).
  4885*    -------------------------------
  4886     05  FILLER            PIC  X(0003).
  4887     05  CORGSEQO PIC  X(0004).
  4888*    -------------------------------
  4889     05  FILLER            PIC  X(0003).
  4890     05  CREFHDGO PIC  X(0010).
  4891*    -------------------------------
  4892     05  FILLER            PIC  X(0003).
  4893     05  CREFO PIC  X(0012).
  4894*    -------------------------------
  4895     05  FILLER            PIC  X(0003).
  4896     05  CNHINTO PIC  999999.99.
  4897*    -------------------------------
  4898     05  FILLER            PIC  X(0003).
  4899     05  CCERTNOO PIC  X(0010).
  4900*    -------------------------------
  4901     05  FILLER            PIC  X(0003).
  4902     05  CSUFIXO PIC  X(0001).
  4903*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  92
* EL6311.cbl
  4904     05  FILLER            PIC  X(0003).
  4905     05  CEFFDTO PIC  X(0008).
  4906*    -------------------------------
  4907     05  FILLER            PIC  X(0003).
  4908     05  CLSTNMO PIC  X(0015).
  4909*    -------------------------------
  4910     05  FILLER            PIC  X(0003).
  4911     05  CPCYNO PIC  X(0001).
  4912*    -------------------------------
  4913     05  FILLER            PIC  X(0003).
  4914     05  CINAMEO PIC  X(0015).
  4915*    -------------------------------
  4916     05  FILLER            PIC  X(0003).
  4917     05  CINITSO PIC  X(0010).
  4918*    -------------------------------
  4919     05  FILLER            PIC  X(0003).
  4920     05  CCANREAO PIC  X(0001).
  4921*    -------------------------------
  4922     05  FILLER            PIC  X(0003).
  4923     05  CKIND1O PIC  X(0002).
  4924*    -------------------------------
  4925     05  FILLER            PIC  X(0003).
  4926     05  CCANDT1O PIC  X(0008).
  4927*    -------------------------------
  4928     05  FILLER            PIC  X(0003).
  4929     05  CREFND1O PIC  Z(7).99-.
  4930*    -------------------------------
  4931     05  FILLER            PIC  X(0003).
  4932     05  CMTHD1O PIC  X(0001).
  4933*    -------------------------------
  4934     05  FILLER            PIC  X(0003).
  4935     05  CKIND2O PIC  X(0002).
  4936*    -------------------------------
  4937     05  FILLER            PIC  X(0003).
  4938     05  CCANDT2O PIC  X(0008).
  4939*    -------------------------------
  4940     05  FILLER            PIC  X(0003).
  4941     05  CREFND2O PIC  Z(7).99-.
  4942*    -------------------------------
  4943     05  FILLER            PIC  X(0003).
  4944     05  CMTHD2O PIC  X(0001).
  4945*    -------------------------------
  4946     05  FILLER            PIC  X(0003).
  4947     05  CLIVESO PIC  X(0003).
  4948*    -------------------------------
  4949     05  FILLER            PIC  X(0003).
  4950     05  CFORCEO PIC  X(0001).
  4951*    -------------------------------
  4952     05  FILLER            PIC  X(0003).
  4953     05  CBILCDO PIC  X(0001).
  4954*    -------------------------------
  4955     05  FILLER            PIC  X(0003).
  4956     05  CCRFND1O PIC  Z(7).99-.
  4957*    -------------------------------
  4958     05  FILLER            PIC  X(0003).
  4959     05  CCRFND2O PIC  Z(7).99-.
  4960*    -------------------------------
  4961     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  93
* EL6311.cbl
  4962     05  CBILIT1O PIC  X(0008).
  4963*    -------------------------------
  4964     05  FILLER            PIC  X(0003).
  4965     05  CDRFND1O PIC  Z(7).99-.
  4966*    -------------------------------
  4967     05  FILLER            PIC  X(0003).
  4968     05  CBILIT2O PIC  X(0008).
  4969*    -------------------------------
  4970     05  FILLER            PIC  X(0003).
  4971     05  CDRFND2O PIC  Z(7).99-.
  4972*    -------------------------------
  4973     05  FILLER            PIC  X(0003).
  4974     05  CCANTXTO PIC  X(0005).
  4975*    -------------------------------
  4976     05  FILLER            PIC  X(0003).
  4977     05  CCANFEEO PIC  Z9.
  4978*    -------------------------------
  4979     05  FILLER            PIC  X(0003).
  4980     05  CTERM1O PIC  ZZ9.
  4981*    -------------------------------
  4982     05  FILLER            PIC  X(0003).
  4983     05  CRTERM1O PIC  ZZ9.
  4984*    -------------------------------
  4985     05  FILLER            PIC  X(0003).
  4986     05  CPREM1O PIC  ZZZZZZ9.99-.
  4987*    -------------------------------
  4988     05  FILLER            PIC  X(0003).
  4989     05  CTERM2O PIC  ZZ9.
  4990*    -------------------------------
  4991     05  FILLER            PIC  X(0003).
  4992     05  CRTERM2O PIC  ZZ9.
  4993*    -------------------------------
  4994     05  FILLER            PIC  X(0003).
  4995     05  CPREM2O PIC  ZZZZZZ9.99-.
  4996*    -------------------------------
  4997     05  FILLER            PIC  X(0003).
  4998     05  CENTRDTO PIC  X(0008).
  4999*    -------------------------------
  5000     05  FILLER            PIC  X(0003).
  5001     05  CPAYEEO PIC  X(0006).
  5002*    -------------------------------
  5003     05  FILLER            PIC  X(0003).
  5004     05  CRFNDSWO PIC  X(0003).
  5005*    -------------------------------
  5006     05  FILLER            PIC  X(0003).
  5007     05  CLFHDGO PIC  X(0006).
  5008*    -------------------------------
  5009     05  FILLER            PIC  X(0003).
  5010     05  CAHHDGO PIC  X(0006).
  5011*    -------------------------------
  5012     05  FILLER            PIC  X(0003).
  5013     05  CENTDTO PIC  X(0008).
  5014*    -------------------------------
  5015     05  FILLER            PIC  X(0003).
  5016     05  CENTBYO PIC  X(0004).
  5017*    -------------------------------
  5018     05  FILLER            PIC  X(0003).
  5019     05  CCHGCNTO PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  94
* EL6311.cbl
  5020*    -------------------------------
  5021     05  FILLER            PIC  X(0003).
  5022     05  CLFREFNO PIC  X(0006).
  5023*    -------------------------------
  5024     05  FILLER            PIC  X(0003).
  5025     05  CAHREFNO PIC  X(0006).
  5026*    -------------------------------
  5027     05  FILLER            PIC  X(0003).
  5028     05  CREINCDO PIC  X(0003).
  5029*    -------------------------------
  5030     05  FILLER            PIC  X(0003).
  5031     05  CAEFFDTO PIC  X(0008).
  5032*    -------------------------------
  5033     05  FILLER            PIC  X(0003).
  5034     05  CAEXPDTO PIC  X(0008).
  5035*    -------------------------------
  5036     05  FILLER            PIC  X(0003).
  5037     05  COMMLFO PIC  .99999.
  5038*    -------------------------------
  5039     05  FILLER            PIC  X(0003).
  5040     05  COMMAHO PIC  .99999.
  5041*    -------------------------------
  5042     05  FILLER            PIC  X(0003).
  5043     05  CERMSG1O PIC  X(0078).
  5044*    -------------------------------
  5045     05  FILLER            PIC  X(0003).
  5046     05  CERMSG2O PIC  X(0078).
  5047*    -------------------------------
  5048     05  FILLER            PIC  X(0003).
  5049     05  CERMSG3O PIC  X(0078).
  5050*    -------------------------------
  5051     05  FILLER            PIC  X(0003).
  5052     05  CPFENTRO PIC  X(0002).
  5053*    -------------------------------
  5054     05  FILLER            PIC  X(0003).
  5055     05  CPF5HDRO PIC  X(0005).
  5056*    -------------------------------
  5057     05  FILLER            PIC  X(0003).
  5058     05  CPF4HDRO PIC  X(0013).
  5059*    -------------------------------
  5060     05  FILLER            PIC  X(0003).
  5061     05  CF15HDRO PIC  X(0022).
  5062*    -------------------------------
  5063 01  EL631DI REDEFINES EL631BI.
  5064     05  FILLER            PIC  X(0012).
  5065*    -------------------------------
  5066     05  DDATEL PIC S9(0004) COMP.
  5067     05  DDATEF PIC  X(0001).
  5068     05  FILLER REDEFINES DDATEF.
  5069         10  DDATEA PIC  X(0001).
  5070     05  DDATEI PIC  X(0008).
  5071*    -------------------------------
  5072     05  DTIMEL PIC S9(0004) COMP.
  5073     05  DTIMEF PIC  X(0001).
  5074     05  FILLER REDEFINES DTIMEF.
  5075         10  DTIMEA PIC  X(0001).
  5076     05  DTIMEI PIC  X(0005).
  5077*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  95
* EL6311.cbl
  5078     05  DHEADL PIC S9(0004) COMP.
  5079     05  DHEADF PIC  X(0001).
  5080     05  FILLER REDEFINES DHEADF.
  5081         10  DHEADA PIC  X(0001).
  5082     05  DHEADI PIC  X(0038).
  5083*    -------------------------------
  5084     05  DLDATEL PIC S9(0004) COMP.
  5085     05  DLDATEF PIC  X(0001).
  5086     05  FILLER REDEFINES DLDATEF.
  5087         10  DLDATEA PIC  X(0001).
  5088     05  DLDATEI PIC  X(0010).
  5089*    -------------------------------
  5090     05  DBATCHL PIC S9(0004) COMP.
  5091     05  DBATCHF PIC  X(0001).
  5092     05  FILLER REDEFINES DBATCHF.
  5093         10  DBATCHA PIC  X(0001).
  5094     05  DBATCHI PIC  X(0011).
  5095*    -------------------------------
  5096     05  DACCTNML PIC S9(0004) COMP.
  5097     05  DACCTNMF PIC  X(0001).
  5098     05  FILLER REDEFINES DACCTNMF.
  5099         10  DACCTNMA PIC  X(0001).
  5100     05  DACCTNMI PIC  X(0030).
  5101*    -------------------------------
  5102     05  DPROCDTL PIC S9(0004) COMP.
  5103     05  DPROCDTF PIC  X(0001).
  5104     05  FILLER REDEFINES DPROCDTF.
  5105         10  DPROCDTA PIC  X(0001).
  5106     05  DPROCDTI PIC  X(0008).
  5107*    -------------------------------
  5108     05  DINPUTL PIC S9(0004) COMP.
  5109     05  DINPUTF PIC  X(0001).
  5110     05  FILLER REDEFINES DINPUTF.
  5111         10  DINPUTA PIC  X(0001).
  5112     05  DINPUTI PIC  X(0008).
  5113*    -------------------------------
  5114     05  DMAINDTL PIC S9(0004) COMP.
  5115     05  DMAINDTF PIC  X(0001).
  5116     05  FILLER REDEFINES DMAINDTF.
  5117         10  DMAINDTA PIC  X(0001).
  5118     05  DMAINDTI PIC  X(0008).
  5119*    -------------------------------
  5120     05  DCARRL PIC S9(0004) COMP.
  5121     05  DCARRF PIC  X(0001).
  5122     05  FILLER REDEFINES DCARRF.
  5123         10  DCARRA PIC  X(0001).
  5124     05  DCARRI PIC  X(0001).
  5125*    -------------------------------
  5126     05  DGROUPL PIC S9(0004) COMP.
  5127     05  DGROUPF PIC  X(0001).
  5128     05  FILLER REDEFINES DGROUPF.
  5129         10  DGROUPA PIC  X(0001).
  5130     05  DGROUPI PIC  X(0006).
  5131*    -------------------------------
  5132     05  DSTATEL PIC S9(0004) COMP.
  5133     05  DSTATEF PIC  X(0001).
  5134     05  FILLER REDEFINES DSTATEF.
  5135         10  DSTATEA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  96
* EL6311.cbl
  5136     05  DSTATEI PIC  X(0002).
  5137*    -------------------------------
  5138     05  DACCTL PIC S9(0004) COMP.
  5139     05  DACCTF PIC  X(0001).
  5140     05  FILLER REDEFINES DACCTF.
  5141         10  DACCTA PIC  X(0001).
  5142     05  DACCTI PIC  X(0010).
  5143*    -------------------------------
  5144     05  DRECVDTL PIC S9(0004) COMP.
  5145     05  DRECVDTF PIC  X(0001).
  5146     05  FILLER REDEFINES DRECVDTF.
  5147         10  DRECVDTA PIC  X(0001).
  5148     05  DRECVDTI PIC  X(0008).
  5149*    -------------------------------
  5150     05  DCSRL PIC S9(0004) COMP.
  5151     05  DCSRF PIC  X(0001).
  5152     05  FILLER REDEFINES DCSRF.
  5153         10  DCSRA PIC  X(0001).
  5154     05  DCSRI PIC  X(0004).
  5155*    -------------------------------
  5156     05  DREFHDGL PIC S9(0004) COMP.
  5157     05  DREFHDGF PIC  X(0001).
  5158     05  FILLER REDEFINES DREFHDGF.
  5159         10  DREFHDGA PIC  X(0001).
  5160     05  DREFHDGI PIC  X(0010).
  5161*    -------------------------------
  5162     05  DREFL PIC S9(0004) COMP.
  5163     05  DREFF PIC  X(0001).
  5164     05  FILLER REDEFINES DREFF.
  5165         10  DREFA PIC  X(0001).
  5166     05  DREFI PIC  X(0012).
  5167*    -------------------------------
  5168     05  DLFPHDGL PIC S9(0004) COMP.
  5169     05  DLFPHDGF PIC  X(0001).
  5170     05  FILLER REDEFINES DLFPHDGF.
  5171         10  DLFPHDGA PIC  X(0001).
  5172     05  DLFPHDGI PIC  X(0010).
  5173*    -------------------------------
  5174     05  DAHPHDGL PIC S9(0004) COMP.
  5175     05  DAHPHDGF PIC  X(0001).
  5176     05  FILLER REDEFINES DAHPHDGF.
  5177         10  DAHPHDGA PIC  X(0001).
  5178     05  DAHPHDGI PIC  X(0010).
  5179*    -------------------------------
  5180     05  DLFRHDGL PIC S9(0004) COMP.
  5181     05  DLFRHDGF PIC  X(0001).
  5182     05  FILLER REDEFINES DLFRHDGF.
  5183         10  DLFRHDGA PIC  X(0001).
  5184     05  DLFRHDGI PIC  X(0009).
  5185*    -------------------------------
  5186     05  DAHRHDGL PIC S9(0004) COMP.
  5187     05  DAHRHDGF PIC  X(0001).
  5188     05  FILLER REDEFINES DAHRHDGF.
  5189         10  DAHRHDGA PIC  X(0001).
  5190     05  DAHRHDGI PIC  X(0009).
  5191*    -------------------------------
  5192     05  DRISSL PIC S9(0004) COMP.
  5193     05  DRISSF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  97
* EL6311.cbl
  5194     05  FILLER REDEFINES DRISSF.
  5195         10  DRISSA PIC  X(0001).
  5196     05  DRISSI PIC  X(0005).
  5197*    -------------------------------
  5198     05  DRLFPRML PIC S9(0004) COMP.
  5199     05  DRLFPRMF PIC  X(0001).
  5200     05  FILLER REDEFINES DRLFPRMF.
  5201         10  DRLFPRMA PIC  X(0001).
  5202     05  DRLFPRMI PIC  S9(9)V99.
  5203*    -------------------------------
  5204     05  DRAHPRML PIC S9(0004) COMP.
  5205     05  DRAHPRMF PIC  X(0001).
  5206     05  FILLER REDEFINES DRAHPRMF.
  5207         10  DRAHPRMA PIC  X(0001).
  5208     05  DRAHPRMI PIC  S9(9)V99.
  5209*    -------------------------------
  5210     05  DRCANCL PIC S9(0004) COMP.
  5211     05  DRCANCF PIC  X(0001).
  5212     05  FILLER REDEFINES DRCANCF.
  5213         10  DRCANCA PIC  X(0001).
  5214     05  DRCANCI PIC  X(0005).
  5215*    -------------------------------
  5216     05  DRLFRFDL PIC S9(0004) COMP.
  5217     05  DRLFRFDF PIC  X(0001).
  5218     05  FILLER REDEFINES DRLFRFDF.
  5219         10  DRLFRFDA PIC  X(0001).
  5220     05  DRLFRFDI PIC  S9(9)V99.
  5221*    -------------------------------
  5222     05  DRAHRFDL PIC S9(0004) COMP.
  5223     05  DRAHRFDF PIC  X(0001).
  5224     05  FILLER REDEFINES DRAHRFDF.
  5225         10  DRAHRFDA PIC  X(0001).
  5226     05  DRAHRFDI PIC  S9(9)V99.
  5227*    -------------------------------
  5228     05  DEISSL PIC S9(0004) COMP.
  5229     05  DEISSF PIC  X(0001).
  5230     05  FILLER REDEFINES DEISSF.
  5231         10  DEISSA PIC  X(0001).
  5232     05  DEISSI PIC  X(0005).
  5233*    -------------------------------
  5234     05  DELFPRML PIC S9(0004) COMP.
  5235     05  DELFPRMF PIC  X(0001).
  5236     05  FILLER REDEFINES DELFPRMF.
  5237         10  DELFPRMA PIC  X(0001).
  5238     05  DELFPRMI PIC  X(0011).
  5239*    -------------------------------
  5240     05  DEAHPRML PIC S9(0004) COMP.
  5241     05  DEAHPRMF PIC  X(0001).
  5242     05  FILLER REDEFINES DEAHPRMF.
  5243         10  DEAHPRMA PIC  X(0001).
  5244     05  DEAHPRMI PIC  X(0011).
  5245*    -------------------------------
  5246     05  DECANCL PIC S9(0004) COMP.
  5247     05  DECANCF PIC  X(0001).
  5248     05  FILLER REDEFINES DECANCF.
  5249         10  DECANCA PIC  X(0001).
  5250     05  DECANCI PIC  X(0005).
  5251*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  98
* EL6311.cbl
  5252     05  DELFRFDL PIC S9(0004) COMP.
  5253     05  DELFRFDF PIC  X(0001).
  5254     05  FILLER REDEFINES DELFRFDF.
  5255         10  DELFRFDA PIC  X(0001).
  5256     05  DELFRFDI PIC  X(0011).
  5257*    -------------------------------
  5258     05  DEAHRFDL PIC S9(0004) COMP.
  5259     05  DEAHRFDF PIC  X(0001).
  5260     05  FILLER REDEFINES DEAHRFDF.
  5261         10  DEAHRFDA PIC  X(0001).
  5262     05  DEAHRFDI PIC  X(0011).
  5263*    -------------------------------
  5264     05  DCISSL PIC S9(0004) COMP.
  5265     05  DCISSF PIC  X(0001).
  5266     05  FILLER REDEFINES DCISSF.
  5267         10  DCISSA PIC  X(0001).
  5268     05  DCISSI PIC  X(0005).
  5269*    -------------------------------
  5270     05  DCLFPRML PIC S9(0004) COMP.
  5271     05  DCLFPRMF PIC  X(0001).
  5272     05  FILLER REDEFINES DCLFPRMF.
  5273         10  DCLFPRMA PIC  X(0001).
  5274     05  DCLFPRMI PIC  X(0011).
  5275*    -------------------------------
  5276     05  DCAHPRML PIC S9(0004) COMP.
  5277     05  DCAHPRMF PIC  X(0001).
  5278     05  FILLER REDEFINES DCAHPRMF.
  5279         10  DCAHPRMA PIC  X(0001).
  5280     05  DCAHPRMI PIC  X(0011).
  5281*    -------------------------------
  5282     05  DCCANCL PIC S9(0004) COMP.
  5283     05  DCCANCF PIC  X(0001).
  5284     05  FILLER REDEFINES DCCANCF.
  5285         10  DCCANCA PIC  X(0001).
  5286     05  DCCANCI PIC  X(0005).
  5287*    -------------------------------
  5288     05  DCLFRFDL PIC S9(0004) COMP.
  5289     05  DCLFRFDF PIC  X(0001).
  5290     05  FILLER REDEFINES DCLFRFDF.
  5291         10  DCLFRFDA PIC  X(0001).
  5292     05  DCLFRFDI PIC  X(0011).
  5293*    -------------------------------
  5294     05  DCAHRFDL PIC S9(0004) COMP.
  5295     05  DCAHRFDF PIC  X(0001).
  5296     05  FILLER REDEFINES DCAHRFDF.
  5297         10  DCAHRFDA PIC  X(0001).
  5298     05  DCAHRFDI PIC  X(0011).
  5299*    -------------------------------
  5300     05  DOISSL PIC S9(0004) COMP.
  5301     05  DOISSF PIC  X(0001).
  5302     05  FILLER REDEFINES DOISSF.
  5303         10  DOISSA PIC  X(0001).
  5304     05  DOISSI PIC  X(0005).
  5305*    -------------------------------
  5306     05  DOLFPRML PIC S9(0004) COMP.
  5307     05  DOLFPRMF PIC  X(0001).
  5308     05  FILLER REDEFINES DOLFPRMF.
  5309         10  DOLFPRMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page  99
* EL6311.cbl
  5310     05  DOLFPRMI PIC  X(0011).
  5311*    -------------------------------
  5312     05  DOAHPRML PIC S9(0004) COMP.
  5313     05  DOAHPRMF PIC  X(0001).
  5314     05  FILLER REDEFINES DOAHPRMF.
  5315         10  DOAHPRMA PIC  X(0001).
  5316     05  DOAHPRMI PIC  X(0011).
  5317*    -------------------------------
  5318     05  DOCANCL PIC S9(0004) COMP.
  5319     05  DOCANCF PIC  X(0001).
  5320     05  FILLER REDEFINES DOCANCF.
  5321         10  DOCANCA PIC  X(0001).
  5322     05  DOCANCI PIC  X(0005).
  5323*    -------------------------------
  5324     05  DOLFRFDL PIC S9(0004) COMP.
  5325     05  DOLFRFDF PIC  X(0001).
  5326     05  FILLER REDEFINES DOLFRFDF.
  5327         10  DOLFRFDA PIC  X(0001).
  5328     05  DOLFRFDI PIC  X(0011).
  5329*    -------------------------------
  5330     05  DOAHRFDL PIC S9(0004) COMP.
  5331     05  DOAHRFDF PIC  X(0001).
  5332     05  FILLER REDEFINES DOAHRFDF.
  5333         10  DOAHRFDA PIC  X(0001).
  5334     05  DOAHRFDI PIC  X(0011).
  5335*    -------------------------------
  5336     05  DITOTALL PIC S9(0004) COMP.
  5337     05  DITOTALF PIC  X(0001).
  5338     05  FILLER REDEFINES DITOTALF.
  5339         10  DITOTALA PIC  X(0001).
  5340     05  DITOTALI PIC  X(0005).
  5341*    -------------------------------
  5342     05  DIFATALL PIC S9(0004) COMP.
  5343     05  DIFATALF PIC  X(0001).
  5344     05  FILLER REDEFINES DIFATALF.
  5345         10  DIFATALA PIC  X(0001).
  5346     05  DIFATALI PIC  X(0005).
  5347*    -------------------------------
  5348     05  DIFORCEL PIC S9(0004) COMP.
  5349     05  DIFORCEF PIC  X(0001).
  5350     05  FILLER REDEFINES DIFORCEF.
  5351         10  DIFORCEA PIC  X(0001).
  5352     05  DIFORCEI PIC  X(0005).
  5353*    -------------------------------
  5354     05  DIHOLDL PIC S9(0004) COMP.
  5355     05  DIHOLDF PIC  X(0001).
  5356     05  FILLER REDEFINES DIHOLDF.
  5357         10  DIHOLDA PIC  X(0001).
  5358     05  DIHOLDI PIC  X(0005).
  5359*    -------------------------------
  5360     05  DIAVAILL PIC S9(0004) COMP.
  5361     05  DIAVAILF PIC  X(0001).
  5362     05  FILLER REDEFINES DIAVAILF.
  5363         10  DIAVAILA PIC  X(0001).
  5364     05  DIAVAILI PIC  X(0005).
  5365*    -------------------------------
  5366     05  DIGPREML PIC S9(0004) COMP.
  5367     05  DIGPREMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 100
* EL6311.cbl
  5368     05  FILLER REDEFINES DIGPREMF.
  5369         10  DIGPREMA PIC  X(0001).
  5370     05  DIGPREMI PIC  X(0011).
  5371*    -------------------------------
  5372     05  DIBPREML PIC S9(0004) COMP.
  5373     05  DIBPREMF PIC  X(0001).
  5374     05  FILLER REDEFINES DIBPREMF.
  5375         10  DIBPREMA PIC  X(0001).
  5376     05  DIBPREMI PIC  X(0011).
  5377*    -------------------------------
  5378     05  DCTOTALL PIC S9(0004) COMP.
  5379     05  DCTOTALF PIC  X(0001).
  5380     05  FILLER REDEFINES DCTOTALF.
  5381         10  DCTOTALA PIC  X(0001).
  5382     05  DCTOTALI PIC  X(0005).
  5383*    -------------------------------
  5384     05  DCFATALL PIC S9(0004) COMP.
  5385     05  DCFATALF PIC  X(0001).
  5386     05  FILLER REDEFINES DCFATALF.
  5387         10  DCFATALA PIC  X(0001).
  5388     05  DCFATALI PIC  X(0005).
  5389*    -------------------------------
  5390     05  DCFORCEL PIC S9(0004) COMP.
  5391     05  DCFORCEF PIC  X(0001).
  5392     05  FILLER REDEFINES DCFORCEF.
  5393         10  DCFORCEA PIC  X(0001).
  5394     05  DCFORCEI PIC  X(0005).
  5395*    -------------------------------
  5396     05  DCHOLDL PIC S9(0004) COMP.
  5397     05  DCHOLDF PIC  X(0001).
  5398     05  FILLER REDEFINES DCHOLDF.
  5399         10  DCHOLDA PIC  X(0001).
  5400     05  DCHOLDI PIC  X(0005).
  5401*    -------------------------------
  5402     05  DCAVAILL PIC S9(0004) COMP.
  5403     05  DCAVAILF PIC  X(0001).
  5404     05  FILLER REDEFINES DCAVAILF.
  5405         10  DCAVAILA PIC  X(0001).
  5406     05  DCAVAILI PIC  X(0005).
  5407*    -------------------------------
  5408     05  DCGPREML PIC S9(0004) COMP.
  5409     05  DCGPREMF PIC  X(0001).
  5410     05  FILLER REDEFINES DCGPREMF.
  5411         10  DCGPREMA PIC  X(0001).
  5412     05  DCGPREMI PIC  X(0011).
  5413*    -------------------------------
  5414     05  DCBPREML PIC S9(0004) COMP.
  5415     05  DCBPREMF PIC  X(0001).
  5416     05  FILLER REDEFINES DCBPREMF.
  5417         10  DCBPREMA PIC  X(0001).
  5418     05  DCBPREMI PIC  X(0011).
  5419*    -------------------------------
  5420     05  DNTOTALL PIC S9(0004) COMP.
  5421     05  DNTOTALF PIC  X(0001).
  5422     05  FILLER REDEFINES DNTOTALF.
  5423         10  DNTOTALA PIC  X(0001).
  5424     05  DNTOTALI PIC  X(0005).
  5425*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 101
* EL6311.cbl
  5426     05  DNFATALL PIC S9(0004) COMP.
  5427     05  DNFATALF PIC  X(0001).
  5428     05  FILLER REDEFINES DNFATALF.
  5429         10  DNFATALA PIC  X(0001).
  5430     05  DNFATALI PIC  X(0005).
  5431*    -------------------------------
  5432     05  DNFORCEL PIC S9(0004) COMP.
  5433     05  DNFORCEF PIC  X(0001).
  5434     05  FILLER REDEFINES DNFORCEF.
  5435         10  DNFORCEA PIC  X(0001).
  5436     05  DNFORCEI PIC  X(0005).
  5437*    -------------------------------
  5438     05  DNHOLDL PIC S9(0004) COMP.
  5439     05  DNHOLDF PIC  X(0001).
  5440     05  FILLER REDEFINES DNHOLDF.
  5441         10  DNHOLDA PIC  X(0001).
  5442     05  DNHOLDI PIC  X(0005).
  5443*    -------------------------------
  5444     05  DNAVAILL PIC S9(0004) COMP.
  5445     05  DNAVAILF PIC  X(0001).
  5446     05  FILLER REDEFINES DNAVAILF.
  5447         10  DNAVAILA PIC  X(0001).
  5448     05  DNAVAILI PIC  X(0005).
  5449*    -------------------------------
  5450     05  DNGPREML PIC S9(0004) COMP.
  5451     05  DNGPREMF PIC  X(0001).
  5452     05  FILLER REDEFINES DNGPREMF.
  5453         10  DNGPREMA PIC  X(0001).
  5454     05  DNGPREMI PIC  X(0011).
  5455*    -------------------------------
  5456     05  DNBPREML PIC S9(0004) COMP.
  5457     05  DNBPREMF PIC  X(0001).
  5458     05  FILLER REDEFINES DNBPREMF.
  5459         10  DNBPREMA PIC  X(0001).
  5460     05  DNBPREMI PIC  X(0011).
  5461*    -------------------------------
  5462     05  DERMSGL PIC S9(0004) COMP.
  5463     05  DERMSGF PIC  X(0001).
  5464     05  FILLER REDEFINES DERMSGF.
  5465         10  DERMSGA PIC  X(0001).
  5466     05  DERMSGI PIC  X(0075).
  5467*    -------------------------------
  5468     05  DPFENTRL PIC S9(0004) COMP.
  5469     05  DPFENTRF PIC  X(0001).
  5470     05  FILLER REDEFINES DPFENTRF.
  5471         10  DPFENTRA PIC  X(0001).
  5472     05  DPFENTRI PIC  9(2).
  5473 01  EL631DO REDEFINES EL631BI.
  5474     05  FILLER            PIC  X(0012).
  5475*    -------------------------------
  5476     05  FILLER            PIC  X(0003).
  5477     05  DDATEO PIC  X(0008).
  5478*    -------------------------------
  5479     05  FILLER            PIC  X(0003).
  5480     05  DTIMEO PIC  99.99.
  5481*    -------------------------------
  5482     05  FILLER            PIC  X(0003).
  5483     05  DHEADO PIC  X(0038).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 102
* EL6311.cbl
  5484*    -------------------------------
  5485     05  FILLER            PIC  X(0003).
  5486     05  DLDATEO PIC  X(0010).
  5487*    -------------------------------
  5488     05  FILLER            PIC  X(0003).
  5489     05  DBATCHO PIC  X(0011).
  5490*    -------------------------------
  5491     05  FILLER            PIC  X(0003).
  5492     05  DACCTNMO PIC  X(0030).
  5493*    -------------------------------
  5494     05  FILLER            PIC  X(0003).
  5495     05  DPROCDTO PIC  X(0008).
  5496*    -------------------------------
  5497     05  FILLER            PIC  X(0003).
  5498     05  DINPUTO PIC  X(0008).
  5499*    -------------------------------
  5500     05  FILLER            PIC  X(0003).
  5501     05  DMAINDTO PIC  X(0008).
  5502*    -------------------------------
  5503     05  FILLER            PIC  X(0003).
  5504     05  DCARRO PIC  X(0001).
  5505*    -------------------------------
  5506     05  FILLER            PIC  X(0003).
  5507     05  DGROUPO PIC  X(0006).
  5508*    -------------------------------
  5509     05  FILLER            PIC  X(0003).
  5510     05  DSTATEO PIC  X(0002).
  5511*    -------------------------------
  5512     05  FILLER            PIC  X(0003).
  5513     05  DACCTO PIC  X(0010).
  5514*    -------------------------------
  5515     05  FILLER            PIC  X(0003).
  5516     05  DRECVDTO PIC  X(0008).
  5517*    -------------------------------
  5518     05  FILLER            PIC  X(0003).
  5519     05  DCSRO PIC  X(0004).
  5520*    -------------------------------
  5521     05  FILLER            PIC  X(0003).
  5522     05  DREFHDGO PIC  X(0010).
  5523*    -------------------------------
  5524     05  FILLER            PIC  X(0003).
  5525     05  DREFO PIC  X(0012).
  5526*    -------------------------------
  5527     05  FILLER            PIC  X(0003).
  5528     05  DLFPHDGO PIC  X(0010).
  5529*    -------------------------------
  5530     05  FILLER            PIC  X(0003).
  5531     05  DAHPHDGO PIC  X(0010).
  5532*    -------------------------------
  5533     05  FILLER            PIC  X(0003).
  5534     05  DLFRHDGO PIC  X(0009).
  5535*    -------------------------------
  5536     05  FILLER            PIC  X(0003).
  5537     05  DAHRHDGO PIC  X(0009).
  5538*    -------------------------------
  5539     05  FILLER            PIC  X(0003).
  5540     05  DRISSO PIC  ZZ99-.
  5541*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 103
* EL6311.cbl
  5542     05  FILLER            PIC  X(0003).
  5543     05  DRLFPRMO PIC  ZZZZZZ9.99-.
  5544*    -------------------------------
  5545     05  FILLER            PIC  X(0003).
  5546     05  DRAHPRMO PIC  ZZZZZZ9.99-.
  5547*    -------------------------------
  5548     05  FILLER            PIC  X(0003).
  5549     05  DRCANCO PIC  ZZ99-.
  5550*    -------------------------------
  5551     05  FILLER            PIC  X(0003).
  5552     05  DRLFRFDO PIC  ZZZZZZ9.99-.
  5553*    -------------------------------
  5554     05  FILLER            PIC  X(0003).
  5555     05  DRAHRFDO PIC  ZZZZZZ9.99-.
  5556*    -------------------------------
  5557     05  FILLER            PIC  X(0003).
  5558     05  DEISSO PIC  ZZ99-.
  5559*    -------------------------------
  5560     05  FILLER            PIC  X(0003).
  5561     05  DELFPRMO PIC  ZZZZZZ9.99-.
  5562*    -------------------------------
  5563     05  FILLER            PIC  X(0003).
  5564     05  DEAHPRMO PIC  ZZZZZZ9.99-.
  5565*    -------------------------------
  5566     05  FILLER            PIC  X(0003).
  5567     05  DECANCO PIC  ZZ99-.
  5568*    -------------------------------
  5569     05  FILLER            PIC  X(0003).
  5570     05  DELFRFDO PIC  ZZZZZZ9.99-.
  5571*    -------------------------------
  5572     05  FILLER            PIC  X(0003).
  5573     05  DEAHRFDO PIC  ZZZZZZ9.99-.
  5574*    -------------------------------
  5575     05  FILLER            PIC  X(0003).
  5576     05  DCISSO PIC  ZZ99-.
  5577*    -------------------------------
  5578     05  FILLER            PIC  X(0003).
  5579     05  DCLFPRMO PIC  ZZZZZZ9.99-.
  5580*    -------------------------------
  5581     05  FILLER            PIC  X(0003).
  5582     05  DCAHPRMO PIC  ZZZZZZ9.99-.
  5583*    -------------------------------
  5584     05  FILLER            PIC  X(0003).
  5585     05  DCCANCO PIC  ZZ99-.
  5586*    -------------------------------
  5587     05  FILLER            PIC  X(0003).
  5588     05  DCLFRFDO PIC  ZZZZZZ9.99-.
  5589*    -------------------------------
  5590     05  FILLER            PIC  X(0003).
  5591     05  DCAHRFDO PIC  ZZZZZZ9.99-.
  5592*    -------------------------------
  5593     05  FILLER            PIC  X(0003).
  5594     05  DOISSO PIC  ZZ99-.
  5595*    -------------------------------
  5596     05  FILLER            PIC  X(0003).
  5597     05  DOLFPRMO PIC  ZZZZZZ9.99-.
  5598*    -------------------------------
  5599     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 104
* EL6311.cbl
  5600     05  DOAHPRMO PIC  ZZZZZZ9.99-.
  5601*    -------------------------------
  5602     05  FILLER            PIC  X(0003).
  5603     05  DOCANCO PIC  ZZ99-.
  5604*    -------------------------------
  5605     05  FILLER            PIC  X(0003).
  5606     05  DOLFRFDO PIC  ZZZZZZ9.99-.
  5607*    -------------------------------
  5608     05  FILLER            PIC  X(0003).
  5609     05  DOAHRFDO PIC  ZZZZZZ9.99-.
  5610*    -------------------------------
  5611     05  FILLER            PIC  X(0003).
  5612     05  DITOTALO PIC  ZZZ99.
  5613*    -------------------------------
  5614     05  FILLER            PIC  X(0003).
  5615     05  DIFATALO PIC  ZZZ99.
  5616*    -------------------------------
  5617     05  FILLER            PIC  X(0003).
  5618     05  DIFORCEO PIC  ZZZ99.
  5619*    -------------------------------
  5620     05  FILLER            PIC  X(0003).
  5621     05  DIHOLDO PIC  ZZZ99.
  5622*    -------------------------------
  5623     05  FILLER            PIC  X(0003).
  5624     05  DIAVAILO PIC  ZZZ99.
  5625*    -------------------------------
  5626     05  FILLER            PIC  X(0003).
  5627     05  DIGPREMO PIC  ZZZZZZZ9.99.
  5628*    -------------------------------
  5629     05  FILLER            PIC  X(0003).
  5630     05  DIBPREMO PIC  ZZZZZZZ9.99.
  5631*    -------------------------------
  5632     05  FILLER            PIC  X(0003).
  5633     05  DCTOTALO PIC  ZZZ99.
  5634*    -------------------------------
  5635     05  FILLER            PIC  X(0003).
  5636     05  DCFATALO PIC  ZZZ99.
  5637*    -------------------------------
  5638     05  FILLER            PIC  X(0003).
  5639     05  DCFORCEO PIC  ZZZ99.
  5640*    -------------------------------
  5641     05  FILLER            PIC  X(0003).
  5642     05  DCHOLDO PIC  ZZZ99.
  5643*    -------------------------------
  5644     05  FILLER            PIC  X(0003).
  5645     05  DCAVAILO PIC  ZZZ99.
  5646*    -------------------------------
  5647     05  FILLER            PIC  X(0003).
  5648     05  DCGPREMO PIC  ZZZZZZZ9.99.
  5649*    -------------------------------
  5650     05  FILLER            PIC  X(0003).
  5651     05  DCBPREMO PIC  ZZZZZZZ9.99.
  5652*    -------------------------------
  5653     05  FILLER            PIC  X(0003).
  5654     05  DNTOTALO PIC  ---99.
  5655*    -------------------------------
  5656     05  FILLER            PIC  X(0003).
  5657     05  DNFATALO PIC  ---99.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 105
* EL6311.cbl
  5658*    -------------------------------
  5659     05  FILLER            PIC  X(0003).
  5660     05  DNFORCEO PIC  ---99.
  5661*    -------------------------------
  5662     05  FILLER            PIC  X(0003).
  5663     05  DNHOLDO PIC  ---99.
  5664*    -------------------------------
  5665     05  FILLER            PIC  X(0003).
  5666     05  DNAVAILO PIC  ---99.
  5667*    -------------------------------
  5668     05  FILLER            PIC  X(0003).
  5669     05  DNGPREMO PIC  -------9.99.
  5670*    -------------------------------
  5671     05  FILLER            PIC  X(0003).
  5672     05  DNBPREMO PIC  -------9.99.
  5673*    -------------------------------
  5674     05  FILLER            PIC  X(0003).
  5675     05  DERMSGO PIC  X(0075).
  5676*    -------------------------------
  5677     05  FILLER            PIC  X(0003).
  5678     05  DPFENTRO PIC  X(0002).
  5679*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 106
* EL6311.cbl
  5681 01  MAP-B REDEFINES EL631BI.
  5682     12  FILLER                  PIC X(591).
  5683*    12  FILLER                  PIC X(512).
  5684*    12  FILLER                  PIC X(510).
  5685     12  MAP-B-COVERAGE OCCURS 2 TIMES.
  5686         16  BKIND-LEN               PIC S9(4)  COMP.
  5687         16  BKIND-ATTRB             PIC X.
  5688         16  BKIND                   PIC XX.
  5689         16  BTYPE-LEN               PIC S9(4)  COMP.
  5690         16  BTYPE-ATTRB             PIC X.
  5691         16  BTYPE                   PIC X(3).
  5692         16  BTERM-LEN               PIC S9(4)  COMP.
  5693         16  BTERM-ATTRB             PIC X.
  5694         16  BTERMI                  PIC 999.
  5695         16  BTERMO REDEFINES BTERMI PIC ZZZ.
  5696         16  BBEN-LEN                PIC S9(4)  COMP.
  5697         16  BBEN-ATTRB              PIC X.
  5698         16  BBENI                   PIC 9(10)V99.
  5699*        16  BBENI                   PIC 9(12).
  5700         16  BBENO REDEFINES BBENI   PIC Z(9).99.
  5701         16  BPREM-LEN               PIC S9(4)  COMP.
  5702         16  BPREM-ATTRB             PIC X.
  5703         16  BPREMI                  PIC S9(9)V99.
  5704*        16  BPREMI                  PIC 9(11).
  5705         16  BPREMO REDEFINES BPREMI PIC Z(7).99-.
  5706         16  BPREM-ALPHA REDEFINES BPREMI PIC X(11).
  5707         16  BEXPIRE-LEN             PIC S9(4)  COMP.
  5708         16  BEXPIRE-ATTRB           PIC X.
  5709         16  BEXPIRE                 PIC X(8).
  5710         16  BCRIT-PERD-LEN          PIC S9(4)  COMP.
  5711         16  BCRIT-PERD-ATTRB        PIC X.
  5712         16  BCRIT-PERDI             PIC 99.
  5713         16  BCRIT-PERDO REDEFINES
  5714                         BCRIT-PERDI PIC ZZ.
  5715         16  BALT-BEN-LEN            PIC S9(4)  COMP.
  5716         16  BALT-BEN-ATTRB          PIC X.
  5717         16  BALT-BENI               PIC 9(10)V99.
  5718*        16  BALT-BENI               PIC 9(12).
  5719         16  BALT-BENO REDEFINES
  5720                           BALT-BENI PIC Z(9).ZZ.
  5721         16  BALT-PREM-LEN           PIC S9(4)  COMP.
  5722         16  BALT-PREM-ATTRB         PIC X.
  5723         16  BALT-PREMI              PIC 9(9)V99.
  5724*        16  BALT-PREMI              PIC 9(11).
  5725         16  BALT-PREMO REDEFINES
  5726                          BALT-PREMI PIC Z(7).ZZ-.
  5727         16  BBEN-CD-LEN             PIC S9(4)  COMP.
  5728         16  BBEN-CD-ATTRB           PIC X.
  5729         16  BBEN-CD                 PIC XXX.
  5730         16  BCPREM-LEN              PIC S9(4)  COMP.
  5731         16  BCPREM-ATTRB            PIC X.
  5732         16  BCPREMI                 PIC S9(9)V99.
  5733*        16  BCPREMI                 PIC X(11).
  5734         16  BCPREMO REDEFINES BCPREMI
  5735                                     PIC Z(7).99-.
  5736         16  BCALT-PREM-LEN          PIC S9(4)  COMP.
  5737         16  BCALT-PREM-ATTRB        PIC X.
  5738         16  BCALT-PREM              PIC Z(7).99-.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 107
* EL6311.cbl
  5739         16  BBEN-ABBR-LEN           PIC S9(4)  COMP.
  5740         16  BBEN-ABBR-ATTRB         PIC X.
  5741         16  BBEN-ABBR               PIC X(5).
  5742         16  BDIFF-LEN               PIC S9(4)  COMP.
  5743         16  BDIFF-ATTRB             PIC X.
  5744         16  BDIFFO                  PIC Z(7).99-.
  5745         16  BBILL-LIT-LEN           PIC S9(4)  COMP.
  5746         16  BBILL-LIT-ATTRB         PIC X.
  5747         16  BBILL-LIT               PIC X(8).
  5748         16  BDALT-PREM-LEN          PIC S9(4)  COMP.
  5749         16  BDALT-PREM-ATTRB        PIC X.
  5750         16  BDALT-PREM              PIC Z(7).99-.
  5751
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 108
* EL6311.cbl
  5753
  5754****************************************************************
  5755*
  5756* Copyright (c) 2007-2013 Dell Inc.
  5757* All rights reserved.
  5758*
  5759****************************************************************
  5760 01  DFHEIV.
  5761   02  DFHEIV0               PIC X(35).
  5762   02  DFHEIV1               PIC X(08).
  5763   02  DFHEIV2               PIC X(08).
  5764   02  DFHEIV3               PIC X(08).
  5765   02  DFHEIV4               PIC X(06).
  5766   02  DFHEIV5               PIC X(04).
  5767   02  DFHEIV6               PIC X(04).
  5768   02  DFHEIV7               PIC X(02).
  5769   02  DFHEIV8               PIC X(02).
  5770   02  DFHEIV9               PIC X(01).
  5771   02  DFHEIV10              PIC S9(7) COMP-3.
  5772   02  DFHEIV11              PIC S9(4) COMP SYNC.
  5773   02  DFHEIV12              PIC S9(4) COMP SYNC.
  5774   02  DFHEIV13              PIC S9(4) COMP SYNC.
  5775   02  DFHEIV14              PIC S9(4) COMP SYNC.
  5776   02  DFHEIV15              PIC S9(4) COMP SYNC.
  5777   02  DFHEIV16              PIC S9(9) COMP SYNC.
  5778   02  DFHEIV17              PIC X(04).
  5779   02  DFHEIV18              PIC X(04).
  5780   02  DFHEIV19              PIC X(04).
  5781   02  DFHEIV20              USAGE IS POINTER.
  5782   02  DFHEIV21              USAGE IS POINTER.
  5783   02  DFHEIV22              USAGE IS POINTER.
  5784   02  DFHEIV23              USAGE IS POINTER.
  5785   02  DFHEIV24              USAGE IS POINTER.
  5786   02  DFHEIV25              PIC S9(9) COMP SYNC.
  5787   02  DFHEIV26              PIC S9(9) COMP SYNC.
  5788   02  DFHEIV27              PIC S9(9) COMP SYNC.
  5789   02  DFHEIV28              PIC S9(9) COMP SYNC.
  5790   02  DFHEIV29              PIC S9(9) COMP SYNC.
  5791   02  DFHEIV30              PIC S9(9) COMP SYNC.
  5792   02  DFHEIV31              PIC S9(9) COMP SYNC.
  5793   02  DFHEIV32              PIC S9(4) COMP SYNC.
  5794   02  DFHEIV33              PIC S9(4) COMP SYNC.
  5795   02  DFHEIV34              PIC S9(4) COMP SYNC.
  5796   02  DFHEIV35              PIC S9(4) COMP SYNC.
  5797   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  5798   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  5799   02  FILLER                PIC X(02).
  5800   02  DFHEIV99              PIC X(08) VALUE SPACE.
  5801   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  5802   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  5803   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  5804   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  5805   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  5806   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  5807 LINKAGE  SECTION.
  5808*****************************************************************
  5809*                                                               *
  5810* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 109
* EL6311.cbl
  5811* All rights reserved.                                          *
  5812*                                                               *
  5813*****************************************************************
  5814 01  dfheiblk.
  5815     02  eibtime          pic s9(7) comp-3.
  5816     02  eibdate          pic s9(7) comp-3.
  5817     02  eibtrnid         pic x(4).
  5818     02  eibtaskn         pic s9(7) comp-3.
  5819     02  eibtrmid         pic x(4).
  5820     02  dfheigdi         pic s9(4) comp.
  5821     02  eibcposn         pic s9(4) comp.
  5822     02  eibcalen         pic s9(4) comp.
  5823     02  eibaid           pic x(1).
  5824     02  eibfiller1       pic x(1).
  5825     02  eibfn            pic x(2).
  5826     02  eibfiller2       pic x(2).
  5827     02  eibrcode         pic x(6).
  5828     02  eibfiller3       pic x(2).
  5829     02  eibds            pic x(8).
  5830     02  eibreqid         pic x(8).
  5831     02  eibrsrce         pic x(8).
  5832     02  eibsync          pic x(1).
  5833     02  eibfree          pic x(1).
  5834     02  eibrecv          pic x(1).
  5835     02  eibsend          pic x(1).
  5836     02  eibatt           pic x(1).
  5837     02  eibeoc           pic x(1).
  5838     02  eibfmh           pic x(1).
  5839     02  eibcompl         pic x(1).
  5840     02  eibsig           pic x(1).
  5841     02  eibconf          pic x(1).
  5842     02  eiberr           pic x(1).
  5843     02  eibrldbk         pic x(1).
  5844     02  eiberrcd         pic x(4).
  5845     02  eibsynrb         pic x(1).
  5846     02  eibnodat         pic x(1).
  5847     02  eibfiller5       pic x(2).
  5848     02  eibresp          pic s9(8) comp.
  5849     02  eibresp2         pic s9(8) comp.
  5850     02  dfheigdj         pic s9(4) comp.
  5851     02  dfheigdk         pic s9(4) comp.
  5852 01  DFHCOMMAREA                 PIC X(1300).
  5853*                                COPY ERCPNDB.
  5854******************************************************************
  5855*                                                                *
  5856*                                                                *
  5857*                            ERCPNDB.                            *
  5858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5859*                            VMOD=2.025                          *
  5860*                                                                *
  5861*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  5862*                                                                *
  5863******************************************************************
  5864*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  5865*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  5866******************************************************************
  5867*                                                                *
  5868*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 110
* EL6311.cbl
  5869*   FILE TYPE = VSAM,KSDS                                        *
  5870*   RECORD SIZE = 585  RECFORM = FIXED                           *
  5871*                                                                *
  5872*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  5873*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  5874*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  5875*                                                 RKP=13,LEN=36  *
  5876*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  5877*                                      AND CHG-SEQ.)             *
  5878*                                                RKP=49,LEN=11   *
  5879*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  5880*                                      AND CHG-SEQ.)             *
  5881*                                                RKP=60,LEN=15   *
  5882*                                                                *
  5883*   LOG = NO                                                     *
  5884*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5885******************************************************************
  5886******************************************************************
  5887*                   C H A N G E   L O G
  5888*
  5889* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5890*-----------------------------------------------------------------
  5891*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5892* EFFECTIVE    NUMBER
  5893*-----------------------------------------------------------------
  5894* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5895* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5896* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  5897* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5898* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  5899* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5900* 032306                   PEMA  ADD BOW LOAN NUMBER
  5901* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  5902* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  5903* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  5904* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5905* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  5906* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  5907* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5908* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  5909* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  5910* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  5911* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  5912******************************************************************
  5913
  5914 01  PENDING-BUSINESS.
  5915     12  PB-RECORD-ID                     PIC XX.
  5916         88  VALID-PB-ID                        VALUE 'PB'.
  5917
  5918     12  PB-CONTROL-PRIMARY.
  5919         16  PB-COMPANY-CD                PIC X.
  5920         16  PB-ENTRY-BATCH               PIC X(6).
  5921         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  5922         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  5923
  5924     12  PB-CONTROL-BY-ACCOUNT.
  5925         16  PB-COMPANY-CD-A1             PIC X.
  5926         16  PB-CARRIER                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 111
* EL6311.cbl
  5927         16  PB-GROUPING.
  5928             20  PB-GROUPING-PREFIX       PIC XXX.
  5929             20  PB-GROUPING-PRIME        PIC XXX.
  5930         16  PB-STATE                     PIC XX.
  5931         16  PB-ACCOUNT.
  5932             20  PB-ACCOUNT-PREFIX        PIC X(4).
  5933             20  PB-ACCOUNT-PRIME         PIC X(6).
  5934         16  PB-CERT-EFF-DT               PIC XX.
  5935         16  PB-CERT-NO.
  5936             20  PB-CERT-PRIME            PIC X(10).
  5937             20  PB-CERT-SFX              PIC X.
  5938         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  5939
  5940         16  PB-RECORD-TYPE               PIC X.
  5941             88  PB-MAILING-DATA                VALUE '0'.
  5942             88  PB-ISSUE                       VALUE '1'.
  5943             88  PB-CANCELLATION                VALUE '2'.
  5944             88  PB-BATCH-TRAILER               VALUE '9'.
  5945
  5946     12  PB-CONTROL-BY-ORIG-BATCH.
  5947         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  5948         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  5949         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  5950         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  5951
  5952     12  PB-CONTROL-BY-CSR.
  5953         16  PB-CSR-COMPANY-CD            PIC X.
  5954         16  PB-CSR-ID                    PIC X(4).
  5955         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  5956         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  5957         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  5958******************************************************************
  5959*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  5960******************************************************************
  5961
  5962     12  PB-LAST-MAINT-DT                 PIC XX.
  5963     12  PB-LAST-MAINT-BY                 PIC X(4).
  5964     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  5965
  5966     12  PB-RECORD-BODY                   PIC X(375).
  5967
  5968     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  5969         16  PB-CERT-ORIGIN               PIC X.
  5970             88  CLASIC-CREATED-CERT         VALUE '1'.
  5971         16  PB-I-NAME.
  5972             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  5973             20  PB-I-INSURED-FIRST-NAME.
  5974                 24  PB-I-INSURED-1ST-INIT PIC X.
  5975                 24  FILLER                PIC X(9).
  5976             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  5977         16  PB-I-AGE                     PIC S99   COMP-3.
  5978         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  5979         16  PB-I-BIRTHDAY                PIC XX.
  5980         16  PB-I-INSURED-SEX             PIC X.
  5981             88  PB-SEX-MALE     VALUE 'M'.
  5982             88  PB-SEX-FEMALE   VALUE 'F'.
  5983
  5984         16  PB-I-LF-TERM                 PIC S999   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 112
* EL6311.cbl
  5985         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  5986         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  5987         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  5988         16  PB-I-SKIP-CODE               PIC X.
  5989             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  5990             88  PB-SKIP-JULY              VALUE '1'.
  5991             88  PB-SKIP-AUGUST            VALUE '2'.
  5992             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  5993             88  PB-SKIP-JULY-AUG          VALUE '4'.
  5994             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  5995             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  5996             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  5997             88  PB-SKIP-JUNE              VALUE '8'.
  5998             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  5999             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  6000             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  6001         16  PB-I-TERM-TYPE               PIC X.
  6002             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  6003             88  PB-PAID-WEEKLY            VALUE 'W'.
  6004             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  6005             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  6006             88  PB-PAID-13-YEARLY         VALUE 'T'.
  6007         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  6008         16  PB-I-POLICY-FORM-NO          PIC X(12).
  6009         16  PB-I-DATA-ENTRY-SW           PIC X.
  6010             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  6011             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  6012             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  6013             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  6014         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  6015         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  6016*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  6017         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  6018         16  FILLER                       PIC X.
  6019
  6020         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  6021             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  6022             88  PB-INVALID-LIFE             VALUE '  ' '00'
  6023                                                   '90' THRU '99'.
  6024         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  6025                                          PIC XX.
  6026         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  6027         16  PB-I-AMOUNT-FINANCED REDEFINES
  6028                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  6029         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  6030         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  6031                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  6032         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6033         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  6034         16  PB-I-CLP-AMOUNT REDEFINES
  6035                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  6036         16  PB-I-LF-CALC-FLAG            PIC X.
  6037             88 PB-COMP-LF-PREM               VALUE '?'.
  6038         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  6039         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  6040         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  6041         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  6042         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 113
* EL6311.cbl
  6043         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  6044         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  6045         16  PB-I-LF-ABBR                 PIC XXX.
  6046         16  PB-I-LF-INPUT-CD             PIC XX.
  6047
  6048         16  PB-I-AH-BENEFIT-CD           PIC XX.
  6049             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  6050             88  PB-INVALID-AH               VALUE '  ' '00'
  6051                                                   '90' THRU '99'.
  6052         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  6053         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  6054         16  PB-I-AH-CALC-FLAG            PIC X.
  6055             88 PB-COMP-AH-PREM                  VALUE '?'.
  6056         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  6057         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  6058         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  6059         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  6060         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  6061         16  PB-I-AH-ABBR                 PIC XXX.
  6062         16  PB-I-AH-INPUT-CD             PIC XXX.
  6063
  6064         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  6065         16  PB-I-REIN-TABLE              PIC XXX.
  6066         16  PB-I-BUSINESS-TYPE           PIC 99.
  6067         16  PB-I-INDV-GRP-CD             PIC X.
  6068         16  PB-I-MORT-CODE.
  6069             20  PB-I-TABLE               PIC X.
  6070             20  PB-I-INTEREST            PIC XX.
  6071             20  PB-I-MORT-TYP            PIC X.
  6072         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  6073         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  6074         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  6075         16  PB-I-INDV-GRP-OVRD           PIC X.
  6076         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  6077         16  PB-I-SIG-SW                  PIC X.
  6078             88  PB-POLICY-SIGNED             VALUE 'Y'.
  6079         16  PB-I-RATE-CLASS              PIC XX.
  6080         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  6081         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  6082         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  6083         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  6084         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  6085         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  6086         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  6087         16  PB-I-BENEFIT-TYPE            PIC XXX.
  6088         16  PB-I-OB-FLAG                 PIC X.
  6089             88  PB-I-OB                      VALUE 'B'.
  6090             88  PB-I-SUMMARY                 VALUE 'Z'.
  6091         16  PB-I-ENTRY-STATUS            PIC X.
  6092             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  6093                                              'M' '5' '9' '2'.
  6094             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  6095             88  PB-I-POLICY-PENDING          VALUE '2'.
  6096             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  6097             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  6098             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  6099             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  6100             88  PB-I-REIN-ONLY               VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 114
* EL6311.cbl
  6101             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  6102             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  6103             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  6104             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  6105         16  PB-I-INT-CODE                PIC X.
  6106             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  6107             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  6108         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  6109         16  PB-I-SOC-SEC-NO              PIC X(11).
  6110         16  PB-I-MEMBER-NO               PIC X(12).
  6111         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  6112*        16  PB-I-LOAN-OFFICER            PIC XXX.
  6113         16  PB-I-OLD-LOF                 PIC XXX.
  6114         16  PB-I-LF-EXPIRE-DT            PIC XX.
  6115         16  PB-I-AH-EXPIRE-DT            PIC XX.
  6116         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  6117         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  6118         16  PB-I-LIFE-INDICATOR          PIC X.
  6119             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  6120         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  6121         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  6122                                          PIC S9(5)V99    COMP-3.
  6123         16  PB-I-MAIL-ADDRS-SW           PIC X.
  6124             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  6125             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  6126         16  PB-I-1ST-PMT-DT              PIC XX.
  6127         16  PB-I-JOINT-INSURED.
  6128             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  6129             20 PB-I-JOINT-FIRST-NAME.
  6130                24  PB-I-JOINT-FIRST-INIT PIC X.
  6131                24  FILLER                PIC X(9).
  6132             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  6133*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  6134         16  PB-I-BENEFICIARY-NAME.
  6135             20  PB-I-BANK-NUMBER         PIC X(10).
  6136             20  FILLER                   PIC X(15).
  6137         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  6138         16  PB-I-REFERENCE               PIC X(12).
  6139         16  FILLER REDEFINES PB-I-REFERENCE.
  6140             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  6141             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  6142             20  PB-I-CLP-STATE           PIC XX.
  6143         16  PB-I-UNDERWRITING-STATUS     PIC X.
  6144             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  6145             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  6146             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  6147         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  6148         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  6149         16  PB-I-RESIDENT-STATE          PIC XX.
  6150         16  PB-I-RATE-CODE               PIC X(4).
  6151         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  6152         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6153         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6154         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  6155         16  PB-I-BANK-NOCHRGB            PIC 99.
  6156         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  6157         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  6158
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 115
* EL6311.cbl
  6159     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  6160         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  6161             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  6162         16  PB-C-CANCEL-ORIGIN           PIC X.
  6163             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  6164         16  PB-C-LF-CANCEL-DT            PIC XX.
  6165         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6166         16  PB-C-LF-CALC-REQ             PIC X.
  6167             88 PB-COMP-LF-CANCEL            VALUE '?'.
  6168         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  6169         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  6170         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  6171             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  6172         16  PB-C-AH-CANCEL-DT            PIC XX.
  6173         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  6174         16  PB-C-AH-CALC-REQ             PIC X.
  6175             88 PB-COMP-AH-CANCEL            VALUE '?'.
  6176         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  6177         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  6178         16  PB-C-LAST-NAME               PIC X(15).
  6179         16  PB-C-REFUND-SW               PIC X.
  6180             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  6181             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  6182         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  6183         16  PB-C-PAYEE-CODE              PIC X(6).
  6184         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  6185         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  6186         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  6187         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  6188         16  PB-C-REFERENCE               PIC X(12).
  6189         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  6190         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  6191         16  PB-C-POST-CARD-IND           PIC X.
  6192         16  PB-C-CANCEL-REASON           PIC X.
  6193         16  PB-C-REF-INTERFACE-SW        PIC X.
  6194         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  6195         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  6196         16  FILLER                       PIC X(01).
  6197*        16  FILLER                       PIC X(18).
  6198         16  PB-C-POLICY-FORM-NO          PIC X(12).
  6199*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  6200         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  6201         16  PB-CANCELED-CERT-DATA.
  6202             20  PB-CI-INSURED-NAME.
  6203                 24  PB-CI-LAST-NAME      PIC X(15).
  6204                 24  PB-CI-INITIALS       PIC XX.
  6205             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  6206             20  PB-CI-INSURED-SEX        PIC X.
  6207             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  6208             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  6209             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  6210             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  6211             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  6212             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  6213             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  6214             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  6215             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  6216             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 116
* EL6311.cbl
  6217             20  PB-CI-RATE-CLASS         PIC XX.
  6218             20  PB-CI-RATE-DEV-LF        PIC XXX.
  6219             20  PB-CI-RATE-DEV-AH        PIC XXX.
  6220             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  6221             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  6222             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  6223             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  6224             20  PB-CI-LF-ABBR            PIC X(3).
  6225             20  PB-CI-AH-ABBR            PIC X(3).
  6226             20  PB-CI-OB-FLAG            PIC X.
  6227                 88  PB-CI-OB                VALUE 'B'.
  6228             20  PB-CI-LF-POLICY-STATUS   PIC X.
  6229                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  6230                                           'M' '4' '5' '9' '2'.
  6231                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  6232                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  6233                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  6234                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  6235                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  6236                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  6237                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6238                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  6239                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6240                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  6241                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  6242                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  6243                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  6244             20  PB-CI-AH-POLICY-STATUS   PIC X.
  6245                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  6246                                           'M' '4' '5' '9' '2'.
  6247                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  6248                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  6249                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  6250                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  6251                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  6252                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  6253                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6254                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  6255                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6256                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  6257                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  6258                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  6259                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  6260             20  PB-CI-PAY-FREQUENCY      PIC 99.
  6261             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  6262             20  PB-CI-SOC-SEC-NO         PIC X(11).
  6263             20  PB-CI-MEMBER-NO          PIC X(12).
  6264             20  PB-CI-INT-CODE           PIC X.
  6265                 88  PB-CI-ADD-ON                  VALUE 'A'.
  6266                 88  PB-CI-SIMPLE                  VALUE 'S'.
  6267             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  6268             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  6269             20  PB-CI-COMP-EXCP-SW       PIC X.
  6270                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  6271                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  6272             20  PB-CI-ENTRY-STATUS       PIC X.
  6273             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  6274             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 117
* EL6311.cbl
  6275             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  6276             20  PB-CI-DEATH-DT           PIC XX.
  6277             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  6278             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  6279             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6280             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  6281             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  6282             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  6283             20  PB-CI-ENTRY-DT              PIC XX.
  6284             20  PB-CI-ENTRY-BATCH           PIC X(6).
  6285             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  6286             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  6287             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  6288             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  6289             20  PB-CI-OLD-LOF               PIC XXX.
  6290*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  6291             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  6292             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  6293             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  6294             20  PB-CI-INDV-GRP-CD           PIC X.
  6295             20  PB-CI-BENEFICIARY-NAME.
  6296                 24  PB-CI-BANK-NUMBER       PIC X(10).
  6297                 24  FILLER                  PIC X(15).
  6298             20  PB-CI-NOTE-SW               PIC X.
  6299             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  6300             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  6301             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  6302             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  6303             20  PB-CI-LOAN-OFFICER          PIC X(5).
  6304             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  6305             20  PB-CI-FIRST-NAME            PIC X(10).
  6306             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  6307
  6308         16  FILLER                       PIC X(13).
  6309*032306  16  FILLER                       PIC X(27).
  6310*        16  FILLER                       PIC X(46).
  6311
  6312     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  6313         16  FILLER                       PIC X(10).
  6314         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  6315         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  6316         16  PB-M-INSURED-MID-INIT        PIC X.
  6317         16  PB-M-INSURED-AGE             PIC 99.
  6318         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  6319         16  PB-M-INSURED-SEX             PIC X.
  6320         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  6321         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  6322         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  6323         16  PB-M-INSURED-CITY-STATE.
  6324             20  PB-M-INSURED-CITY        PIC X(28).
  6325             20  PB-M-INSURED-STATE       PIC XX.
  6326         16  PB-M-INSURED-ZIP-CODE.
  6327             20  PB-M-INSURED-ZIP-PRIME.
  6328                 24  PB-M-INSURED-ZIP-1   PIC X.
  6329                     88  PB-M-CANADIAN-POST-CODE
  6330                                             VALUE 'A' THRU 'Z'.
  6331                 24  FILLER               PIC X(4).
  6332             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 118
* EL6311.cbl
  6333         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  6334                                        PB-M-INSURED-ZIP-CODE.
  6335             20  PM-M-INS-CAN-POST1       PIC XXX.
  6336             20  PM-M-INS-CAN-POST2       PIC XXX.
  6337             20  FILLER                   PIC XXX.
  6338         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  6339         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  6340         16  PB-M-CRED-BENE-NAME          PIC X(30).
  6341         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  6342         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  6343         16  PB-M-CRED-BENE-CITYST.
  6344             20  PB-M-CRED-BENE-CITY      PIC X(28).
  6345             20  PB-M-CRED-BENE-STATE     PIC XX.
  6346         16  FILLER                       PIC X(92).
  6347
  6348     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  6349         16  FILLER                       PIC X(10).
  6350         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6351         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6352         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6353         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6354         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6355         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6356         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6357         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6358         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6359         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  6360         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  6361         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  6362         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  6363         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  6364         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  6365         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  6366         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  6367         16  PB-ACCOUNT-NAME              PIC X(30).
  6368         16  PB-PREM-REF-RPT-FLAG         PIC X.
  6369         16  PB-REFERENCE                 PIC X(12).
  6370         16  PB-B-RECEIVED-DT             PIC XX.
  6371         16  FILLER                       PIC X(234).
  6372
  6373     12  PB-RECORD-STATUS.
  6374         16  PB-CREDIT-SELECT-DT          PIC XX.
  6375         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  6376         16  PB-BILLED-DT                 PIC XX.
  6377         16  PB-BILLING-STATUS            PIC X.
  6378             88  PB-ENTRY-REVERSED            VALUE 'R'.
  6379             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  6380             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  6381         16  PB-RECORD-BILL               PIC X.
  6382             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  6383             88  PB-RECORD-RETURNED           VALUE 'R'.
  6384             88  PB-RECORD-ENDORSED           VALUE 'E'.
  6385             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  6386             88  PB-OVERRIDE-AH               VALUE 'A'.
  6387             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  6388         16  PB-BATCH-ENTRY               PIC X.
  6389             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  6390             88  PB-REIN-ONLY-CERT            VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 119
* EL6311.cbl
  6391             88  PB-REISSUED-CERT             VALUE 'E'.
  6392             88  PB-CASH-CERT                 VALUE 'C'.
  6393             88  PB-MONTHLY-CERT              VALUE 'M'.
  6394             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  6395             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  6396             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  6397         16  PB-FORCE-CODE                PIC X.
  6398             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  6399             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  6400             88  PB-CANCEL-FORCE              VALUE '8'.
  6401             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  6402             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  6403             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  6404             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  6405             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  6406             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  6407             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  6408             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  6409         16  PB-FATAL-FLAG                PIC X.
  6410             88  PB-FATAL-ERRORS              VALUE 'X'.
  6411         16  PB-FORCE-ER-CD               PIC X.
  6412             88  PB-FORCE-ERRORS              VALUE 'F'.
  6413             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  6414         16  PB-WARN-ER-CD                PIC X.
  6415             88  PB-WARNING-ERRORS            VALUE 'W'.
  6416         16  FILLER                       PIC X.
  6417         16  PB-OUT-BAL-CD                PIC X.
  6418             88  PB-OUT-OF-BAL                VALUE 'O'.
  6419         16  PB-LIFE-OVERRIDE-L1          PIC X.
  6420         16  PB-AH-OVERRIDE-L1            PIC X.
  6421         16  PB-INPUT-DT                  PIC XX.
  6422         16  PB-INPUT-BY                  PIC X(4).
  6423         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  6424         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  6425         16  PB-TOLERANCE-REJECT-SW       PIC X.
  6426         16  PB-LF-EARNING-METHOD         PIC X.
  6427         16  PB-AH-EARNING-METHOD         PIC X.
  6428         16  PB-LF-TERM-CALC-METHOD       PIC X.
  6429         16  PB-AH-TERM-CALC-METHOD       PIC X.
  6430         16  PB-REIN-CD                   PIC XXX.
  6431         16  PB-LF-REFUND-TYPE            PIC X.
  6432         16  PB-AH-REFUND-TYPE            PIC X.
  6433         16  PB-ACCT-EFF-DT               PIC XX.
  6434         16  PB-ACCT-EXP-DT               PIC XX.
  6435         16  PB-COMPANY-ID                PIC X(3).
  6436         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6437         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  6438         16  PB-SV-CARRIER                PIC X.
  6439         16  PB-SV-GROUPING               PIC X(6).
  6440         16  PB-SV-STATE                  PIC XX.
  6441         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  6442         16  PB-GA-BILLING-INFO.
  6443             20  PB-GA-BILL-DT OCCURS 5 TIMES
  6444                                          PIC XX.
  6445         16  PB-SV-REMIT-TO  REDEFINES
  6446             PB-GA-BILLING-INFO           PIC X(10).
  6447         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  6448         16  PB-I-LOAN-OFFICER            PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 120
* EL6311.cbl
  6449         16  PB-I-VIN                     PIC X(17).
  6450
  6451         16  FILLER                       PIC X(04).
  6452         16  IMNET-BYPASS-SW              PIC X.
  6453
  6454******************************************************************
  6455*                COMMON EDIT ERRORS                              *
  6456******************************************************************
  6457
  6458     12  PB-COMMON-ERRORS.
  6459         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  6460                                           PIC S9(4)     COMP.
  6461
  6462******************************************************************
  6463*                                COPY ELCCERT.
  6464******************************************************************
  6465*                                                                *
  6466*                            ELCCERT.                            *
  6467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6468*                            VMOD=2.013                          *
  6469*                                                                *
  6470*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  6471*                                                                *
  6472*   FILE TYPE = VSAM,KSDS                                        *
  6473*   RECORD SIZE = 450  RECFORM = FIXED                           *
  6474*                                                                *
  6475*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  6476*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  6477*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  6478*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  6479*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  6480*                                                                *
  6481*   LOG = YES                                                    *
  6482*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6483******************************************************************
  6484*                   C H A N G E   L O G
  6485*
  6486* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6487*-----------------------------------------------------------------
  6488*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6489* EFFECTIVE    NUMBER
  6490*-----------------------------------------------------------------
  6491* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  6492* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  6493* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  6494* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  6495* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  6496* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  6497* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6498* 032612  CR2011110200001  PEMA  AHL CHANGES
  6499* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  6500* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  6501******************************************************************
  6502
  6503 01  CERTIFICATE-MASTER.
  6504     12  CM-RECORD-ID                      PIC XX.
  6505         88  VALID-CM-ID                      VALUE 'CM'.
  6506
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 121
* EL6311.cbl
  6507     12  CM-CONTROL-PRIMARY.
  6508         16  CM-COMPANY-CD                 PIC X.
  6509         16  CM-CARRIER                    PIC X.
  6510         16  CM-GROUPING.
  6511             20  CM-GROUPING-PREFIX        PIC X(3).
  6512             20  CM-GROUPING-PRIME         PIC X(3).
  6513         16  CM-STATE                      PIC XX.
  6514         16  CM-ACCOUNT.
  6515             20  CM-ACCOUNT-PREFIX         PIC X(4).
  6516             20  CM-ACCOUNT-PRIME          PIC X(6).
  6517         16  CM-CERT-EFF-DT                PIC XX.
  6518         16  CM-CERT-NO.
  6519             20  CM-CERT-PRIME             PIC X(10).
  6520             20  CM-CERT-SFX               PIC X.
  6521
  6522     12  CM-CONTROL-BY-NAME.
  6523         16  CM-COMPANY-CD-A1              PIC X.
  6524         16  CM-INSURED-LAST-NAME          PIC X(15).
  6525         16  CM-INSURED-INITIALS.
  6526             20  CM-INSURED-INITIAL1       PIC X.
  6527             20  CM-INSURED-INITIAL2       PIC X.
  6528
  6529     12  CM-CONTROL-BY-SSN.
  6530         16  CM-COMPANY-CD-A2              PIC X.
  6531         16  CM-SOC-SEC-NO.
  6532             20  CM-SSN-STATE              PIC XX.
  6533             20  CM-SSN-ACCOUNT            PIC X(6).
  6534             20  CM-SSN-LN3.
  6535                 25  CM-INSURED-INITIALS-A2.
  6536                     30 CM-INSURED-INITIAL1-A2   PIC X.
  6537                     30 CM-INSURED-INITIAL2-A2   PIC X.
  6538                 25 CM-PART-LAST-NAME-A2         PIC X.
  6539
  6540     12  CM-CONTROL-BY-CERT-NO.
  6541         16  CM-COMPANY-CD-A4              PIC X.
  6542         16  CM-CERT-NO-A4                 PIC X(11).
  6543
  6544     12  CM-CONTROL-BY-MEMB.
  6545         16  CM-COMPANY-CD-A5              PIC X.
  6546         16  CM-MEMBER-NO.
  6547             20  CM-MEMB-STATE             PIC XX.
  6548             20  CM-MEMB-ACCOUNT           PIC X(6).
  6549             20  CM-MEMB-LN4.
  6550                 25  CM-INSURED-INITIALS-A5.
  6551                     30 CM-INSURED-INITIAL1-A5   PIC X.
  6552                     30 CM-INSURED-INITIAL2-A5   PIC X.
  6553                 25 CM-PART-LAST-NAME-A5         PIC XX.
  6554
  6555     12  CM-INSURED-PROFILE-DATA.
  6556         16  CM-INSURED-FIRST-NAME.
  6557             20  CM-INSURED-1ST-INIT       PIC X.
  6558             20  FILLER                    PIC X(9).
  6559         16  CM-INSURED-ISSUE-AGE          PIC 99.
  6560         16  CM-INSURED-SEX                PIC X.
  6561             88  CM-SEX-MALE                  VALUE 'M'.
  6562             88  CM-SEX-FEMAL                 VALUE 'F'.
  6563         16  CM-INSURED-JOINT-AGE          PIC 99.
  6564         16  CM-JOINT-INSURED-NAME.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 122
* EL6311.cbl
  6565             20  CM-JT-LAST-NAME           PIC X(15).
  6566             20  CM-JT-FIRST-NAME.
  6567                 24  CM-JT-1ST-INIT        PIC X.
  6568                 24  FILLER                PIC X(9).
  6569             20  CM-JT-INITIAL             PIC X.
  6570
  6571     12  CM-LIFE-DATA.
  6572         16  CM-LF-BENEFIT-CD              PIC XX.
  6573         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  6574         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  6575         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  6576         16  CM-LF-DEV-CODE                PIC XXX.
  6577         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6578         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  6579         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6580         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  6581         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6582         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6583         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  6584         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6585         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  6586         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6587         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  6588         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  6589         16  cm-temp-epiq                  pic xx.
  6590             88  EPIQ-CLASS                  value 'EQ'.
  6591*        16  FILLER                        PIC XX.
  6592
  6593     12  CM-AH-DATA.
  6594         16  CM-AH-BENEFIT-CD              PIC XX.
  6595         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  6596         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  6597         16  CM-AH-DEV-CODE                PIC XXX.
  6598         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  6599         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  6600         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  6601         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  6602         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  6603         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  6604         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  6605         16  CM-AH-PAID-THRU-DT            PIC XX.
  6606             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  6607         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  6608         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  6609         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  6610         16  FILLER                        PIC X.
  6611
  6612     12  CM-LOAN-INFORMATION.
  6613         16  CM-LIVES                      PIC S9(7)     COMP-3.
  6614         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  6615                                           PIC S9(5)V99  COMP-3.
  6616         16  CM-BILLED                     PIC S9(7)     COMP-3.
  6617         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  6618         16  CM-PAY-FREQUENCY              PIC S99.
  6619         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  6620         16  CM-RATE-CLASS                 PIC XX.
  6621         16  CM-BENEFICIARY                PIC X(25).
  6622         16  CM-POLICY-FORM-NO             PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 123
* EL6311.cbl
  6623         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  6624         16  CM-LAST-ADD-ON-DT             PIC XX.
  6625         16  CM-DEDUCTIBLE-AMOUNTS.
  6626             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  6627             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  6628         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6629             20  CM-RESIDENT-STATE         PIC XX.
  6630             20  CM-RATE-CODE              PIC X(4).
  6631             20  FILLER                    PIC XX.
  6632         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  6633             20  CM-LOAN-OFFICER           PIC X(5).
  6634             20  FILLER                    PIC XXX.
  6635         16  CM-CSR-CODE                   PIC XXX.
  6636         16  CM-UNDERWRITING-CODE          PIC X.
  6637             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  6638         16  CM-POST-CARD-IND              PIC X.
  6639         16  CM-NH-INTERFACE-SW            PIC X.
  6640         16  CM-PREMIUM-TYPE               PIC X.
  6641             88  CM-SING-PRM                  VALUE '1'.
  6642             88  CM-O-B-COVERAGE              VALUE '2'.
  6643             88  CM-OPEN-END                  VALUE '3'.
  6644         16  CM-IND-GRP-TYPE               PIC X.
  6645             88  CM-INDIVIDUAL                VALUE 'I'.
  6646             88  CM-GROUP                     VALUE 'G'.
  6647         16  CM-SKIP-CODE                  PIC X.
  6648             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  6649             88  SKIP-JULY                    VALUE '1'.
  6650             88  SKIP-AUGUST                  VALUE '2'.
  6651             88  SKIP-SEPTEMBER               VALUE '3'.
  6652             88  SKIP-JULY-AUG                VALUE '4'.
  6653             88  SKIP-AUG-SEPT                VALUE '5'.
  6654             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  6655             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  6656             88  SKIP-JUNE                    VALUE '8'.
  6657             88  SKIP-JUNE-JULY               VALUE '9'.
  6658             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  6659             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  6660         16  CM-PAYMENT-MODE               PIC X.
  6661             88  PAY-MONTHLY                  VALUE SPACE.
  6662             88  PAY-WEEKLY                   VALUE '1'.
  6663             88  PAY-SEMI-MONTHLY             VALUE '2'.
  6664             88  PAY-BI-WEEKLY                VALUE '3'.
  6665             88  PAY-SEMI-ANUALLY             VALUE '4'.
  6666         16  CM-LOAN-NUMBER                PIC X(8).
  6667         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  6668         16  CM-OLD-LOF                    PIC XXX.
  6669*        16  CM-LOAN-OFFICER               PIC XXX.
  6670         16  CM-REIN-TABLE                 PIC XXX.
  6671         16  CM-SPECIAL-REIN-CODE          PIC X.
  6672         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  6673         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  6674         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  6675
  6676     12  CM-STATUS-DATA.
  6677         16  CM-ENTRY-STATUS               PIC X.
  6678         16  CM-ENTRY-DT                   PIC XX.
  6679
  6680         16  CM-LF-STATUS-AT-CANCEL        PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 124
* EL6311.cbl
  6681         16  CM-LF-CANCEL-DT               PIC XX.
  6682         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  6683
  6684         16  CM-LF-STATUS-AT-DEATH         PIC X.
  6685         16  CM-LF-DEATH-DT                PIC XX.
  6686         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  6687
  6688         16  CM-LF-CURRENT-STATUS          PIC X.
  6689             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6690                                                'M' '4' '5' '9'.
  6691             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  6692             88  CM-LF-POLICY-PENDING         VALUE '2'.
  6693             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  6694             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  6695             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  6696             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  6697             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  6698             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  6699             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  6700             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  6701             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  6702             88  CM-LF-DECLINED               VALUE 'D'.
  6703             88  CM-LF-VOIDED                 VALUE 'V'.
  6704
  6705         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  6706         16  CM-AH-CANCEL-DT               PIC XX.
  6707         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  6708
  6709         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  6710         16  CM-AH-SETTLEMENT-DT           PIC XX.
  6711         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  6712
  6713         16  CM-AH-CURRENT-STATUS          PIC X.
  6714             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  6715                                                'M' '4' '5' '9'.
  6716             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  6717             88  CM-AH-POLICY-PENDING         VALUE '2'.
  6718             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  6719             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  6720             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  6721             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  6722             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  6723             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  6724             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  6725             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  6726             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  6727             88  CM-AH-DECLINED               VALUE 'D'.
  6728             88  CM-AH-VOIDED                 VALUE 'V'.
  6729
  6730         16  CM-CLAIM-INTERFACE-SW         PIC X.
  6731             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  6732             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  6733             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  6734         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  6735
  6736         16  CM-ENTRY-BATCH                PIC X(6).
  6737         16  CM-LF-EXIT-BATCH              PIC X(6).
  6738         16  CM-AH-EXIT-BATCH              PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 125
* EL6311.cbl
  6739         16  CM-LAST-MONTH-END             PIC XX.
  6740
  6741     12  CM-NOTE-SW                        PIC X.
  6742         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  6743         88  CERT-NOTES-PRESENT               VALUE '1'.
  6744         88  BILLING-NOTES-PRESENT            VALUE '2'.
  6745         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  6746         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  6747         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  6748         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  6749         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  6750     12  CM-COMP-EXCP-SW                   PIC X.
  6751         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  6752         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  6753     12  CM-INSURED-ADDRESS-SW             PIC X.
  6754         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  6755         88  INSURED-ADDR-PRESENT             VALUE '1'.
  6756
  6757*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  6758     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  6759     12  FILLER                            PIC X.
  6760
  6761*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  6762     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  6763     12  FILLER                            PIC X.
  6764*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  6765     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  6766
  6767     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  6768         88  CERT-ADDED-BATCH                 VALUE ' '.
  6769         88  CERT-ADDED-ONLINE                VALUE '1'.
  6770         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  6771         88  CERT-PURGED-OFFLINE              VALUE '3'.
  6772         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  6773     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  6774         88  CERT-AS-LOADED                   VALUE ' '.
  6775         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  6776         88  CERT-CLAIM-ONLINE                VALUE '2'.
  6777         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  6778         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  6779         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  6780         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  6781         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  6782
  6783     12  CM-ACCOUNT-COMM-PCTS.
  6784         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  6785         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  6786
  6787     12  CM-USER-FIELD                     PIC X.
  6788     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  6789     12  CM-CLP-STATE                      PIC XX.
  6790     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  6791     12  CM-USER-RESERVED                  PIC XXX.
  6792     12  FILLER REDEFINES CM-USER-RESERVED.
  6793         16  CM-AH-CLASS-CD                PIC XX.
  6794         16  F                             PIC X.
  6795******************************************************************
  6796*                                COPY ERCNOTE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 126
* EL6311.cbl
  6797******************************************************************
  6798*                                                                *
  6799*                                                                *
  6800*                            ERCNOTE                             *
  6801*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6802*                            VMOD=2.003                          *
  6803*                                                                *
  6804*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  6805*                                                                *
  6806*        FILE TYPE= VSAM,KSDS                                    *
  6807*        RECORD SIZE = 825    RECFORM = FIXED                    *
  6808*                                                                *
  6809*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  6810*                                                                *
  6811*        LOG = YES                                               *
  6812*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  6813*                                                                *
  6814******************************************************************
  6815*                   C H A N G E   L O G
  6816*
  6817* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6818*-----------------------------------------------------------------
  6819*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6820* EFFECTIVE    NUMBER
  6821*-----------------------------------------------------------------
  6822* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  6823*                                FILE WILL CONTAIN BILLING NOTES O
  6824******************************************************************
  6825
  6826 01  CERTIFICATE-NOTE.
  6827     12  CN-RECORD-ID                PIC  XX.
  6828         88  VALID-CN-ID                  VALUE 'CN'.
  6829
  6830     12  CN-CONTROL-PRIMARY.
  6831         16  CN-COMPANY-CD           PIC X.
  6832         16  CN-CARRIER              PIC X.
  6833         16  CN-GROUPING.
  6834             20 CN-GROUPING-PREFIX   PIC XXX.
  6835             20 CN-GROUPING-PRIME    PIC XXX.
  6836         16  CN-STATE                PIC XX.
  6837         16  CN-ACCOUNT.
  6838             20 CN-ACCOUNT-PREFIX    PIC X(4).
  6839             20 CN-ACCOUNT-PRIME     PIC X(6).
  6840         16  CN-CERT-EFF-DT          PIC XX.
  6841         16  CN-CERT-NO.
  6842             20  CN-CERT-PRIME       PIC X(10).
  6843             20  CN-CERT-SFX         PIC X.
  6844
  6845     12  CN-BILLING-START-LINE-NO    PIC 99.
  6846     12  CN-BILLING-END-LINE-NO      PIC 99.
  6847
  6848     12  CN-LINES.
  6849         16  CN-LINE OCCURS 10       PIC X(77).
  6850
  6851     12  CN-LAST-MAINT-DT            PIC XX.
  6852     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  6853     12  CN-LAST-MAINT-USER          PIC X(4).
  6854     12  FILLER                      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 127
* EL6311.cbl
  6855******************************************************************
  6856*                                COPY ERCPNDM.
  6857******************************************************************
  6858*                                                                *
  6859*                                                                *
  6860*                            ERCPNDM                             *
  6861*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6862*                            VMOD=2.003                          *
  6863*                                                                *
  6864*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  6865*                                                                *
  6866*   FILE TYPE = VSAM,KSDS                                        *
  6867*   RECORD SIZE = 374   RECFORM = FIX                            *
  6868*                                                                *
  6869*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  6870*   ALTERNATE PATH    = NOT USED                                 *
  6871*                                                                *
  6872*   LOG = YES                                                    *
  6873*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6874******************************************************************
  6875*                   C H A N G E   L O G
  6876*
  6877* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6878*-----------------------------------------------------------------
  6879*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6880* EFFECTIVE    NUMBER
  6881*-----------------------------------------------------------------
  6882* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  6883* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  6884* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  6885******************************************************************
  6886
  6887 01  PENDING-MAILING-DATA.
  6888     12  PM-RECORD-ID                      PIC XX.
  6889         88  VALID-MA-ID                       VALUE 'PM'.
  6890
  6891     12  PM-CONTROL-PRIMARY.
  6892         16  PM-COMPANY-CD                 PIC X.
  6893         16  PM-ENTRY-BATCH                PIC X(6).
  6894         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  6895         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  6896
  6897     12  FILLER                            PIC X(14).
  6898
  6899     12  PM-ACCESS-CONTROL.
  6900         16  PM-SOURCE-SYSTEM              PIC XX.
  6901             88  PM-FROM-CREDIT                VALUE 'CR'.
  6902             88  PM-FROM-VSI                   VALUE 'VS'.
  6903             88  PM-FROM-WARRANTY              VALUE 'WA'.
  6904             88  PM-FROM-OTHER                 VALUE 'OT'.
  6905         16  PM-RECORD-ADD-DT              PIC XX.
  6906         16  PM-RECORD-ADDED-BY            PIC XXXX.
  6907         16  PM-LAST-MAINT-DT              PIC XX.
  6908         16  PM-LAST-MAINT-BY              PIC XXXX.
  6909         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  6910
  6911     12  PM-PROFILE-INFO.
  6912         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 128
* EL6311.cbl
  6913         16  PM-QUALIFY-CODE-2             PIC XX.
  6914         16  PM-QUALIFY-CODE-3             PIC XX.
  6915         16  PM-QUALIFY-CODE-4             PIC XX.
  6916         16  PM-QUALIFY-CODE-5             PIC XX.
  6917
  6918         16  PM-INSURED-LAST-NAME          PIC X(15).
  6919         16  PM-INSURED-FIRST-NAME         PIC X(10).
  6920         16  PM-INSURED-MIDDLE-INIT        PIC X.
  6921         16  PM-INSURED-ISSUE-AGE          PIC 99.
  6922         16  PM-INSURED-BIRTH-DT           PIC XX.
  6923         16  PM-INSURED-SEX                PIC X.
  6924             88  PM-SEX-MALE                   VALUE 'M'.
  6925             88  PM-SEX-FEMALE                 VALUE 'F'.
  6926         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  6927
  6928         16  PM-ADDRESS-CORRECTED          PIC X.
  6929         16  PM-JOINT-BIRTH-DT             PIC XX.
  6930*        16  FILLER                        PIC X(12).
  6931
  6932         16  PM-ADDRESS-LINE-1             PIC X(30).
  6933         16  PM-ADDRESS-LINE-2             PIC X(30).
  6934         16  PM-CITY-STATE.
  6935             20  PM-CITY                   PIC X(28).
  6936             20  PM-STATE                  PIC XX.
  6937         16  PM-ZIP.
  6938             20  PM-ZIP-CODE.
  6939                 24  PM-ZIP-1              PIC X.
  6940                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6941                 24  FILLER                PIC X(4).
  6942             20  PM-ZIP-PLUS4              PIC X(4).
  6943         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  6944             20  PM-CAN-POST1              PIC XXX.
  6945             20  PM-CAN-POST2              PIC XXX.
  6946             20  FILLER                    PIC XXX.
  6947
  6948         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  6949
  6950         16  FILLER                        PIC X(03).
  6951
  6952     12  PM-CRED-BENE-INFO.
  6953         16  PM-CRED-BENE-NAME             PIC X(25).
  6954         16  PM-CRED-BENE-ADDR             PIC X(30).
  6955         16  PM-CRED-BENE-ADDR2            PIC X(30).
  6956         16  PM-CRED-BENE-CTYST.
  6957             20  PM-CRED-BENE-CITY         PIC X(28).
  6958             20  PM-CRED-BENE-STATE        PIC XX.
  6959         16  PM-CRED-BENE-ZIP.
  6960             20  PM-CB-ZIP-CODE.
  6961                 24  PM-CB-ZIP-1           PIC X.
  6962                     88  PM-CB-CANADIAN-POST-CODE
  6963                                  VALUE 'A' THRU 'Z'.
  6964                 24  FILLER                PIC X(4).
  6965             20  PM-CB-ZIP-PLUS4           PIC X(4).
  6966         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  6967             20  PM-CB-CAN-POST1           PIC XXX.
  6968             20  PM-CB-CAN-POST2           PIC XXX.
  6969             20  FILLER                    PIC XXX.
  6970     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 129
* EL6311.cbl
  6971         16  PM-MAIL-DATA OCCURS 7.
  6972             20  PM-MAIL-TYPE              PIC X.
  6973                 88  PM-12MO-MAILING           VALUE '1'.
  6974                 88  PM-EXP-MAILING            VALUE '2'.
  6975             20  PM-MAIL-STATUS            PIC X.
  6976                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  6977                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  6978                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  6979             20  PM-MAIL-DATE              PIC XX.
  6980     12  FILLER                            PIC XX.
  6981     12  FILLER                            PIC X(12).
  6982*    12  FILLER                            PIC X(30).
  6983
  6984******************************************************************
  6985*                                COPY ERCMAIL.
  6986******************************************************************
  6987*                                                                *
  6988*                                                                *
  6989*                            ERCMAIL                             *
  6990*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6991*                            VMOD=2.003                          *
  6992*                                                                *
  6993*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  6994*                                                                *
  6995*   FILE TYPE = VSAM,KSDS                                        *
  6996*   RECORD SIZE = 374   RECFORM = FIX                            *
  6997*                                                                *
  6998*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  6999*   ALTERNATE PATH    = NOT USED                                 *
  7000*                                                                *
  7001*   LOG = YES                                                    *
  7002*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7003******************************************************************
  7004*                   C H A N G E   L O G
  7005*
  7006* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7007*-----------------------------------------------------------------
  7008*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7009* EFFECTIVE    NUMBER
  7010*-----------------------------------------------------------------
  7011* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7012* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7013* 111108                   PEMA  ADD CRED BENE ADDR2
  7014******************************************************************
  7015
  7016 01  MAILING-DATA.
  7017     12  MA-RECORD-ID                      PIC XX.
  7018         88  VALID-MA-ID                       VALUE 'MA'.
  7019
  7020     12  MA-CONTROL-PRIMARY.
  7021         16  MA-COMPANY-CD                 PIC X.
  7022         16  MA-CARRIER                    PIC X.
  7023         16  MA-GROUPING.
  7024             20  MA-GROUPING-PREFIX        PIC XXX.
  7025             20  MA-GROUPING-PRIME         PIC XXX.
  7026         16  MA-STATE                      PIC XX.
  7027         16  MA-ACCOUNT.
  7028             20  MA-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 130
* EL6311.cbl
  7029             20  MA-ACCOUNT-PRIME          PIC X(6).
  7030         16  MA-CERT-EFF-DT                PIC XX.
  7031         16  MA-CERT-NO.
  7032             20  MA-CERT-PRIME             PIC X(10).
  7033             20  MA-CERT-SFX               PIC X.
  7034
  7035     12  FILLER                            PIC XX.
  7036
  7037     12  MA-ACCESS-CONTROL.
  7038         16  MA-SOURCE-SYSTEM              PIC XX.
  7039             88  MA-FROM-CREDIT                VALUE 'CR'.
  7040             88  MA-FROM-VSI                   VALUE 'VS'.
  7041             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7042             88  MA-FROM-OTHER                 VALUE 'OT'.
  7043         16  MA-RECORD-ADD-DT              PIC XX.
  7044         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7045         16  MA-LAST-MAINT-DT              PIC XX.
  7046         16  MA-LAST-MAINT-BY              PIC XXXX.
  7047         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7048
  7049     12  MA-PROFILE-INFO.
  7050         16  MA-QUALIFY-CODE-1             PIC XX.
  7051         16  MA-QUALIFY-CODE-2             PIC XX.
  7052         16  MA-QUALIFY-CODE-3             PIC XX.
  7053         16  MA-QUALIFY-CODE-4             PIC XX.
  7054         16  MA-QUALIFY-CODE-5             PIC XX.
  7055
  7056         16  MA-INSURED-LAST-NAME          PIC X(15).
  7057         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7058         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7059         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7060         16  MA-INSURED-BIRTH-DT           PIC XX.
  7061         16  MA-INSURED-SEX                PIC X.
  7062             88  MA-SEX-MALE                   VALUE 'M'.
  7063             88  MA-SEX-FEMALE                 VALUE 'F'.
  7064         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7065
  7066         16  MA-ADDRESS-CORRECTED          PIC X.
  7067         16  MA-JOINT-BIRTH-DT             PIC XX.
  7068*        16  FILLER                        PIC X(12).
  7069
  7070         16  MA-ADDRESS-LINE-1             PIC X(30).
  7071         16  MA-ADDRESS-LINE-2             PIC X(30).
  7072         16  MA-CITY-STATE.
  7073             20  MA-CITY                   PIC X(28).
  7074             20  MA-ADDR-STATE             PIC XX.
  7075         16  MA-ZIP.
  7076             20  MA-ZIP-CODE.
  7077                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7078                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7079                 24  FILLER                PIC X(4).
  7080             20  MA-ZIP-PLUS4              PIC X(4).
  7081         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7082             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7083             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7084             20  FILLER                    PIC X(3).
  7085
  7086         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 131
* EL6311.cbl
  7087
  7088         16  FILLER                        PIC XXX.
  7089*        16  FILLER                        PIC X(10).
  7090
  7091     12  MA-CRED-BENE-INFO.
  7092         16  MA-CRED-BENE-NAME                 PIC X(25).
  7093         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7094         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7095         16  MA-CRED-BENE-CTYST.
  7096             20  MA-CRED-BENE-CITY             PIC X(28).
  7097             20  MA-CRED-BENE-STATE            PIC XX.
  7098         16  MA-CRED-BENE-ZIP.
  7099             20  MA-CB-ZIP-CODE.
  7100                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  7101                     88  MA-CB-CANADIAN-POST-CODE
  7102                                           VALUE 'A' THRU 'Z'.
  7103                 24  FILLER                    PIC X(4).
  7104             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7105         16  MA-CB-CANADIAN-POSTAL-CODE
  7106                            REDEFINES MA-CRED-BENE-ZIP.
  7107             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7108             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7109             20  FILLER                        PIC X(3).
  7110     12  MA-POST-CARD-MAIL-DATA.
  7111         16  MA-MAIL-DATA OCCURS 7.
  7112             20  MA-MAIL-TYPE              PIC X.
  7113                 88  MA-12MO-MAILING           VALUE '1'.
  7114                 88  MA-EXP-MAILING            VALUE '2'.
  7115             20  MA-MAIL-STATUS            PIC X.
  7116                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7117                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7118                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7119             20  MA-MAIL-DATE              PIC XX.
  7120     12  FILLER                            PIC XX.
  7121     12  FILLER                            PIC XX.
  7122*    12  FILLER                            PIC X(30).
  7123******************************************************************
  7124*                                COPY ERCRQST.
  7125******************************************************************
  7126*                                                                *
  7127*                                                                *
  7128*                            ERCRQST.                            *
  7129*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7130*                            VMOD=2.002                          *
  7131*                                                                *
  7132*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  7133*                                                                *
  7134*   FILE TYPE = VSAM,KSDS                                        *
  7135*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7136*                                                                *
  7137*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  7138*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  7139*                                   ACCOUNT, REF, BATCH)         *
  7140*                                                RKP=9, LEN=38   *
  7141*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  7142*                                   ACCOUNT, REF, BATCH)         *
  7143*                                                RKP=47, LEN=46  *
  7144*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 132
* EL6311.cbl
  7145*                                   BATCH)                       *
  7146*                                                RKP=93, LEN=24  *
  7147*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  7148*                                   REF, BATCH)                  *
  7149*                                                RKP=117, LEN=35 *
  7150*   LOG = NO                                                     *
  7151*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7152******************************************************************
  7153
  7154 01  AR-REQUEST-RECORD.
  7155     12  RQ-RECORD-ID                     PIC XX.
  7156         88  VALID-RQ-ID                        VALUE 'RQ'.
  7157
  7158     12  RQ-CONTROL-PRIMARY.
  7159         16  RQ-COMPANY-CD                PIC X.
  7160         16  RQ-ENTRY-BATCH               PIC X(6).
  7161
  7162     12  RQ-CONTROL-BY-ACCT-REF.
  7163         16  RQ-COMPANY-CD-A1             PIC X.
  7164         16  RQ-CARRIER-A1                PIC X.
  7165         16  RQ-GROUPING-A1               PIC X(6).
  7166         16  RQ-STATE-A1                  PIC XX.
  7167         16  RQ-ACCOUNT-A1                PIC X(10).
  7168         16  RQ-REFERENCE-A1              PIC X(12).
  7169         16  RQ-BATCH-A1                  PIC X(6).
  7170
  7171     12  RQ-CONTROL-BY-FIN-RESP.
  7172         16  RQ-COMPANY-CD-A2             PIC X.
  7173         16  RQ-CARRIER-A2                PIC X.
  7174         16  RQ-GROUPING-A2               PIC X(6).
  7175         16  RQ-FIN-RESP-A2               PIC X(10).
  7176         16  RQ-ACCT-AGENT-A2             PIC X(10).
  7177         16  RQ-REFERENCE-A2              PIC X(12).
  7178         16  RQ-BATCH-A2                  PIC X(6).
  7179
  7180     12  RQ-CONTROL-BY-ACCT-AGENT.
  7181         16  RQ-COMPANY-CD-A3             PIC X.
  7182         16  RQ-CARRIER-A3                PIC X.
  7183         16  RQ-GROUPING-A3               PIC X(6).
  7184         16  RQ-ACCT-AGENT-A3             PIC X(10).
  7185         16  RQ-BATCH-A3                  PIC X(6).
  7186
  7187     12  RQ-CONTROL-BY-SUMMARY.
  7188         16  RQ-COMPANY-CD-A4             PIC X.
  7189         16  RQ-SUMMARY-CODE              PIC X(6).
  7190         16  RQ-ACCOUNT-A4                PIC X(10).
  7191         16  RQ-REFERENCE-A4              PIC X(12).
  7192         16  RQ-BATCH-A4                  PIC X(6).
  7193
  7194     12  RQ-REQUEST-METHOD                PIC X.
  7195         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  7196         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  7197         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  7198         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  7199     12  FILLER                           PIC X.
  7200     12  RQ-STATUS                        PIC X.
  7201         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  7202         88  RQ-RESUBMIT                      VALUE 'R'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 133
* EL6311.cbl
  7203     12  RQ-PROCESSOR-ID                  PIC X(4).
  7204     12  RQ-ENTRY-DT                      PIC XX.
  7205     12  RQ-MO-END-DT                     PIC XX.
  7206     12  RQ-REQUEST-DT                    PIC XX.
  7207     12  RQ-STMT-DT                       PIC XX.
  7208     12  RQ-REVERSAL-DT                   PIC XX.
  7209     12  RQ-CREDIT-SELECT-DT              PIC XX.
  7210     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  7211
  7212     12  FILLER                           PIC X(27).
  7213
  7214******************************************************************
  7215
  7216*                                COPY ERCLOFC.
  7217******************************************************************
  7218*                                                                *
  7219*                                                                *
  7220*                            ERCLOFC                             *
  7221*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7222*                            VMOD=2.003                          *
  7223*                                                                *
  7224*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
  7225*                                                                *
  7226*   FILE TYPE = VSAM,KSDS                                        *
  7227*   RECORD SIZE = 670   RECFORM = FIX                            *
  7228*                                                                *
  7229*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
  7230*                                                                *
  7231*   LOG = YES                                                    *
  7232*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7233*                                                                *
  7234******************************************************************
  7235
  7236 01  LOAN-OFFICER-MASTER.
  7237     12  LO-RECORD-ID                PIC XX.
  7238         88  VALID-LO-ID                VALUE 'LO'.
  7239
  7240     12  LO-CONTROL-PRIMARY.
  7241         16  LO-COMPANY-CD           PIC X.
  7242         16  LO-CARRIER              PIC X.
  7243         16  LO-GROUPING.
  7244             20  LO-GROUPING-PREFIX  PIC XXX.
  7245             20  LO-GROUPING-PRIME   PIC XXX.
  7246         16  LO-STATE                PIC XX.
  7247         16  LO-ACCOUNT.
  7248             20  LO-ACCOUNT-PREFIX   PIC X(4).
  7249             20  LO-ACCOUNT-PRIME    PIC X(6).
  7250         16  LO-OFFICER-CODE         PIC X(5).
  7251
  7252     12  LO-OFFICER-NAME             PIC X(30).
  7253
  7254     12  LO-LAST-MAINT-DT            PIC XX.
  7255     12  LO-LAST-USER                PIC X(4).
  7256     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
  7257
  7258     12  LO-COMP-CONTROL             PIC X.
  7259             88  LO-SHOW-COMP           VALUE 'Y'.
  7260             88  LO-SUPPRESS-COMP       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 134
* EL6311.cbl
  7261     12  LO-DETAIL-CONTROL           PIC X.
  7262             88  LO-PRINT-DETAIL        VALUE 'D'.
  7263             88  LO-PRINT-SUMMARY       VALUE 'S'.
  7264
  7265     12  LO-SV-CARRIER               PIC X.
  7266     12  LO-SV-GROUPING              PIC X(6).
  7267     12  LO-SV-STATE                 PIC XX.
  7268
  7269     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
  7270     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
  7271
  7272     12  LO-OFFICER-INFO.
  7273         16  FILLER OCCURS 12 TIMES.
  7274             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
  7275             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
  7276             20  LO-LF-COUNT         PIC S9(5) COMP-3.
  7277             20  LO-LF-PREM          PIC S9(7) COMP-3.
  7278             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
  7279             20  LO-AH-COUNT         PIC S9(5) COMP-3.
  7280             20  LO-AH-PREM          PIC S9(7) COMP-3.
  7281             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
  7282     12  FILLER                      PIC X(198).
  7283******************************************************************
  7284*                                COPY ERCPYAJ.
  7285******************************************************************
  7286*                                                                *
  7287*                            ERCPYAJ                             *
  7288*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7289*                            VMOD=2.015                          *
  7290*                                                                *
  7291*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7292*                                                                *
  7293*                                                                *
  7294*   FILE TYPE = VSAM,KSDS                                        *
  7295*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7296*                                                                *
  7297*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7298*       ALTERNATE PATHS = NONE                                   *
  7299*                                                                *
  7300*   LOG = YES                                                    *
  7301*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7302******************************************************************
  7303******************************************************************
  7304*                   C H A N G E   L O G
  7305*
  7306* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7307*-----------------------------------------------------------------
  7308*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7309* EFFECTIVE    NUMBER
  7310*-----------------------------------------------------------------
  7311* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7312* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7313******************************************************************
  7314
  7315 01  PENDING-PAY-ADJ.
  7316     12  PY-RECORD-ID                     PIC XX.
  7317         88  VALID-PY-ID                        VALUE 'PY'.
  7318
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 135
* EL6311.cbl
  7319     12  PY-CONTROL-PRIMARY.
  7320         16  PY-COMPANY-CD                PIC X.
  7321         16  PY-CARRIER                   PIC X.
  7322         16  PY-GROUPING                  PIC X(6).
  7323         16  PY-FIN-RESP                  PIC X(10).
  7324         16  PY-ACCOUNT                   PIC X(10).
  7325         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7326                                          PIC X(10).
  7327         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7328         16  PY-RECORD-TYPE               PIC X.
  7329             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7330             88  PY-DEPOSIT                   VALUE 'D'.
  7331             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7332             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7333             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7334             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7335             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7336             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7337             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7338             88  PY-FICA-ENTRY                VALUE 'F'.
  7339             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7340             88  PY-POLICY-FEE                VALUE 'W'.
  7341             88  PY-DUE-PREM-ADJ              VALUE 'P'.
  7342
  7343     12  PY-PYMT-TYPE                     PIC X.
  7344             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7345             88  PY-REINS-PYMT                VALUE 'R'.
  7346             88  PY-EXP-PYMT                  VALUE 'E'.
  7347
  7348     12  PY-BIL-INV                       PIC X(6).
  7349     12  PY-REF-NO                        PIC X(12).
  7350
  7351     12  PY-LAST-MAINT-DT                 PIC XX.
  7352     12  PY-LAST-MAINT-BY                 PIC X(4).
  7353     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7354
  7355     12  PY-PYADJ-RECORD.
  7356         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7357         16  PY-ENTRY-COMMENT             PIC X(30).
  7358         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7359             20  PY-GL-ACCOUNT            PIC X(10).
  7360             20  PY-GL-STATE              PIC X(02).
  7361             20  PY-GL-CANC-SW            PIC X(01).
  7362                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7363                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7364             20  PY-GL-COMMENT            PIC X(10).
  7365             20  FILLER      REDEFINES PY-GL-COMMENT.
  7366                 24  PY-GL-CHECK-NO       PIC 9(06).
  7367                 24  FILLER               PIC X(04).
  7368             20  FILLER                   PIC X(07).
  7369         16  PY-SAVE-ACCOUNT              PIC X(10).
  7370         16  PY-SAVE-TYPE                 PIC X(01).
  7371
  7372         16  PY-LETTERS.
  7373             20  PY-LETTER OCCURS 3 TIMES
  7374                           INDEXED BY PY-LET-NDX
  7375                                          PIC X(04).
  7376
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 136
* EL6311.cbl
  7377         16  PY-ERCOMP-TYPE               PIC X.
  7378             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7379             88  PY-GA-TYPE                   VALUE 'G'.
  7380             88  PY-BANK-TYPE                 VALUE 'B'.
  7381         16  FILLER                       PIC X(05).
  7382
  7383     12  PY-RECORD-STATUS.
  7384         16  PY-CREDIT-SELECT-DT          PIC XX.
  7385         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7386         16  PY-BILLED-DATE               PIC XX.
  7387         16  PY-REPORTED-DT               PIC XX.
  7388         16  PY-PMT-APPLIED               PIC X.
  7389             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7390             88  PY-GA-PMT                    VALUE 'G'.
  7391             88  PY-OVWRITE-PMT               VALUE 'O'.
  7392             88  PY-NON-AR-PMT                VALUE 'N'.
  7393         16  FILLER                       PIC X(5).
  7394         16  PY-INPUT-DT                  PIC XX.
  7395         16  PY-CHECK-NUMBER              PIC X(6).
  7396         16  PY-VOID-SW                   PIC X.
  7397             88  PY-CHECK-VOIDED              VALUE 'V'.
  7398         16  PY-CHECK-ORIGIN-SW           PIC X.
  7399             88  PY-BILLING-CHECK             VALUE 'B'.
  7400             88  PY-REFUND-CHECK              VALUE 'R'.
  7401             88  PY-GA-CHECK                  VALUE 'G'.
  7402             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7403             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7404         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7405         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7406         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7407         16  PY-BILL-FLAG                 PIC X.
  7408             88  PY-BILLED                    VALUE 'B'.
  7409         16  PY-AR-FLAG                   PIC X.
  7410             88  PY-AR-CYCLE                  VALUE 'C'.
  7411             88  PY-AR-MONTH-END              VALUE 'M'.
  7412         16  PY-AR-DATE                   PIC XX.
  7413
  7414     12  PY-GL-CODES.
  7415         16  PY-GL-DB                     PIC X(14).
  7416         16  PY-GL-CR                     PIC X(14).
  7417         16  PY-GL-FLAG                   PIC X.
  7418         16  PY-GL-DATE                   PIC XX.
  7419
  7420     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  7421     12  FILLER                           PIC X(3).
  7422******************************************************************
  7423*                                COPY ERCCNOT.
  7424******************************************************************
  7425*                                                                *
  7426*                            ERCCNOT                             *
  7427*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7428*                            VMOD=2.003                          *
  7429*                                                                *
  7430*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  7431*                                                                *
  7432*        FILE TYPE= VSAM,KSDS                                    *
  7433*        RECORD SIZE = 150    RECFORM = FIXED                    *
  7434*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 137
* EL6311.cbl
  7435*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  7436*                                                                *
  7437*        LOG = YES                                               *
  7438*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  7439*                                                                *
  7440******************************************************************
  7441*                   C H A N G E   L O G
  7442*
  7443* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7444*-----------------------------------------------------------------
  7445*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7446* EFFECTIVE    NUMBER
  7447*-----------------------------------------------------------------
  7448* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  7449******************************************************************
  7450
  7451 01  CERT-NOTE-FILE.
  7452     12  CZ-RECORD-ID                PIC  XX.
  7453         88  VALID-CZ-ID                  VALUE 'CZ'.
  7454
  7455     12  CZ-CONTROL-PRIMARY.
  7456         16  CZ-COMPANY-CD           PIC X.
  7457         16  CZ-CARRIER              PIC X.
  7458         16  CZ-GROUPING.
  7459             20 CZ-GROUPING-PREFIX   PIC XXX.
  7460             20 CZ-GROUPING-PRIME    PIC XXX.
  7461         16  CZ-STATE                PIC XX.
  7462         16  CZ-ACCOUNT.
  7463             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  7464             20 CZ-ACCOUNT-PRIME     PIC X(6).
  7465         16  CZ-CERT-EFF-DT          PIC XX.
  7466         16  CZ-CERT-NO.
  7467             20  CZ-CERT-PRIME       PIC X(10).
  7468             20  CZ-CERT-SFX         PIC X.
  7469         16  CZ-RECORD-TYPE          PIC X.
  7470             88  CERT-NOTE           VALUE '1'.
  7471             88  CLAIM-CERT-NOTE     VALUE '2'.
  7472         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  7473
  7474     12  CZ-LAST-MAINT-DT            PIC XX.
  7475     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  7476     12  CZ-LAST-MAINT-USER          PIC X(4).
  7477
  7478     12  CZ-NOTE-INFORMATION.
  7479         16  CZ-NOTE                 PIC X(63).
  7480         16  FILLER                  PIC X(39).
  7481******************************************************************
  7482*                                COPY ELCMSTR.
  7483******************************************************************
  7484*                                                                *
  7485*                            ELCMSTR.                            *
  7486*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7487*                            VMOD=2.012                          *
  7488*                                                                *
  7489*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  7490*                                                                *
  7491*   FILE TYPE = VSAM,KSDS                                        *
  7492*   RECORD SIZE = 350  RECFORM = FIXED                           *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 138
* EL6311.cbl
  7493*                                                                *
  7494*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  7495*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  7496*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  7497*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  7498*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  7499*                                                 RKP=75,LEN=21  *
  7500*                                                                *
  7501*   **** NOTE ****                                               *
  7502*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  7503*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  7504*                                                                *
  7505*   LOG = YES                                                    *
  7506*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7507******************************************************************
  7508*                   C H A N G E   L O G
  7509*
  7510* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7511*-----------------------------------------------------------------
  7512*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7513* EFFECTIVE    NUMBER
  7514*-----------------------------------------------------------------
  7515* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  7516* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  7517* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  7518* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7519* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7520******************************************************************
  7521 01  CLAIM-MASTER.
  7522     12  CL-RECORD-ID                PIC XX.
  7523         88  VALID-CL-ID         VALUE 'CL'.
  7524
  7525     12  CL-CONTROL-PRIMARY.
  7526         16  CL-COMPANY-CD           PIC X.
  7527         16  CL-CARRIER              PIC X.
  7528         16  CL-CLAIM-NO             PIC X(7).
  7529         16  CL-CERT-NO.
  7530             20  CL-CERT-PRIME       PIC X(10).
  7531             20  CL-CERT-SFX         PIC X.
  7532
  7533     12  CL-CONTROL-BY-NAME.
  7534         16  CL-COMPANY-CD-A1        PIC X.
  7535         16  CL-INSURED-LAST-NAME    PIC X(15).
  7536         16  CL-INSURED-NAME.
  7537             20  CL-INSURED-1ST-NAME PIC X(12).
  7538             20  CL-INSURED-MID-INIT PIC X.
  7539
  7540     12  CL-CONTROL-BY-SSN.
  7541         16  CL-COMPANY-CD-A2        PIC X.
  7542         16  CL-SOC-SEC-NO.
  7543             20  CL-SSN-STATE        PIC XX.
  7544             20  CL-SSN-ACCOUNT      PIC X(6).
  7545             20  CL-SSN-LN3          PIC X(3).
  7546
  7547     12  CL-CONTROL-BY-CERT-NO.
  7548         16  CL-COMPANY-CD-A4        PIC X.
  7549         16  CL-CERT-NO-A4.
  7550             20  CL-CERT-A4-PRIME    PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 139
* EL6311.cbl
  7551             20  CL-CERT-A4-SFX      PIC X.
  7552
  7553     12  CL-CONTROL-BY-CCN.
  7554         16  CL-COMPANY-CD-A5        PIC X.
  7555         16  CL-CCN-A5.
  7556             20  CL-CCN.
  7557                 24  CL-CCN-PREFIX-A5 PIC X(4).
  7558                 24  CL-CCN-PRIME-A5 PIC X(12).
  7559             20  CL-CCN-FILLER-A5    PIC X(4).
  7560
  7561     12  CL-INSURED-PROFILE-DATA.
  7562         16  CL-INSURED-BIRTH-DT     PIC XX.
  7563         16  CL-INSURED-SEX-CD       PIC X.
  7564             88  INSURED-IS-MALE        VALUE 'M'.
  7565             88  INSURED-IS-FEMALE      VALUE 'F'.
  7566             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  7567         16  CL-INSURED-OCC-CD       PIC X(6).
  7568         16  FILLER                  PIC X(5).
  7569
  7570     12  CL-PROCESSING-INFO.
  7571         16  CL-PROCESSOR-ID         PIC X(4).
  7572         16  CL-CLAIM-STATUS         PIC X.
  7573             88  CLAIM-IS-OPEN          VALUE 'O'.
  7574             88  CLAIM-IS-CLOSED        VALUE 'C'.
  7575         16  CL-CLAIM-TYPE           PIC X.
  7576*            88  AH-CLAIM               VALUE 'A'.
  7577*            88  LIFE-CLAIM             VALUE 'L'.
  7578*            88  PROPERTY-CLAIM         VALUE 'P'.
  7579*            88  IUI-CLAIM              VALUE 'I'.
  7580*            88  GAP-CLAIM              VALUE 'G'.
  7581*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  7582         16  CL-CLAIM-PREM-TYPE      PIC X.
  7583             88  SINGLE-PREMIUM         VALUE '1'.
  7584             88  O-B-COVERAGE           VALUE '2'.
  7585             88  OPEN-END-COVERAGE      VALUE '3'.
  7586         16  CL-INCURRED-DT          PIC XX.
  7587         16  CL-REPORTED-DT          PIC XX.
  7588         16  CL-FILE-ESTABLISH-DT    PIC XX.
  7589         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  7590         16  CL-LAST-PMT-DT          PIC XX.
  7591         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  7592         16  CL-PAID-THRU-DT         PIC XX.
  7593         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  7594         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
  7595         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  7596         16  CL-PMT-CALC-METHOD      PIC X.
  7597             88  CL-360-DAY-YR          VALUE '1'.
  7598             88  CL-365-DAY-YR          VALUE '2'.
  7599             88  CL-FULL-MONTHS         VALUE '3'.
  7600         16  CL-CAUSE-CD             PIC X(6).
  7601
  7602         16  CL-PRIME-CERT-NO.
  7603             20  CL-PRIME-CERT-PRIME PIC X(10).
  7604             20  CL-PRIME-CERT-SFX   PIC X.
  7605
  7606         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  7607             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  7608             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 140
* EL6311.cbl
  7609
  7610         16  CL-MICROFILM-NO         PIC X(10).
  7611         16  FILLER REDEFINES CL-MICROFILM-NO.
  7612             20  CL-BENEFIT-PERIOD   PIC 99.
  7613             20  FILLER              PIC X(8).
  7614         16  CL-PROG-FORM-TYPE       PIC X.
  7615         16  CL-LAST-ADD-ON-DT       PIC XX.
  7616
  7617         16  CL-LAST-REOPEN-DT       PIC XX.
  7618         16  CL-LAST-CLOSE-DT        PIC XX.
  7619         16  CL-LAST-CLOSE-REASON    PIC X(01).
  7620             88  FINAL-PAID             VALUE '1'.
  7621             88  CLAIM-DENIED           VALUE '2'.
  7622             88  AUTO-CLOSE             VALUE '3'.
  7623             88  MANUAL-CLOSE           VALUE '4'.
  7624             88  BENEFITS-CHANGED       VALUE 'C'.
  7625             88  SETUP-ERRORS           VALUE 'E'.
  7626         16  CL-ASSOC-CERT-SEQU      PIC S99.
  7627         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  7628         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  7629             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  7630         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  7631         16  FILLER                  PIC X.
  7632
  7633     12  CL-CERTIFICATE-DATA.
  7634         16  CL-CERT-ORIGIN          PIC X.
  7635             88  CERT-WAS-ONLINE        VALUE '1'.
  7636             88  CERT-WAS-CREATED       VALUE '2'.
  7637             88  COVERAGE-WAS-ADDED     VALUE '3'.
  7638         16  CL-CERT-KEY-DATA.
  7639             20  CL-CERT-CARRIER     PIC X.
  7640             20  CL-CERT-GROUPING    PIC X(6).
  7641             20  CL-CERT-STATE       PIC XX.
  7642             20  CL-CERT-ACCOUNT.
  7643                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  7644                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  7645             20  CL-CERT-EFF-DT      PIC XX.
  7646
  7647     12  CL-STATUS-CONTROLS.
  7648         16  CL-PRIORITY-CD          PIC X.
  7649             88  CONFIDENTIAL-DATA      VALUE '8'.
  7650             88  HIGHEST-PRIORITY       VALUE '9'.
  7651         16  CL-SUPV-ATTN-CD         PIC X.
  7652             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
  7653             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  7654         16  CL-PURGED-DT            PIC XX.
  7655         16  CL-RESTORED-DT          PIC XX.
  7656         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  7657         16  CL-NEXT-RESEND-DT       PIC XX.
  7658         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  7659         16  CL-CRITICAL-PERIOD      PIC 99.
  7660*        16  FILLER                  PIC XX.
  7661         16  CL-LAST-MAINT-DT        PIC XX.
  7662         16  CL-LAST-MAINT-USER      PIC X(4).
  7663         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  7664         16  CL-LAST-MAINT-TYPE      PIC X.
  7665             88  CLAIM-SET-UP           VALUE ' '.
  7666             88  PAYMENT-MADE           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 141
* EL6311.cbl
  7667             88  LETTER-SENT            VALUE '2'.
  7668             88  MASTER-WAS-ALTERED     VALUE '3'.
  7669             88  MASTER-WAS-RESTORED    VALUE '4'.
  7670             88  INCURRED-DATE-CHANGED  VALUE '5'.
  7671             88  FILE-CONVERTED         VALUE '6'.
  7672             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  7673             88  ERROR-CORRECTION       VALUE 'E'.
  7674         16  CL-RELATED-CLAIM-NO     PIC X(7).
  7675         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  7676         16  CL-BENEFICIARY          PIC X(10).
  7677         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  7678         16  CL-DENIAL-TYPE          PIC X.
  7679             88  CL-TYPE-DENIAL          VALUE '1'.
  7680             88  CL-TYPE-RESCISSION      VALUE '2'.
  7681             88  CL-TYPE-REFORMATION     VALUE '3'.
  7682             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  7683             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  7684         16  filler                  pic x(5).
  7685*        16  CL-CRIT-PER-RECURRENT   PIC X.
  7686*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  7687*        16  CL-RTW-DT               PIC XX.
  7688
  7689     12  CL-TRAILER-CONTROLS.
  7690         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  7691             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  7692             88  CL-LAST-TRL-AVAIL      VALUE +100.
  7693             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  7694         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  7695         16  FILLER                  PIC XX.
  7696         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  7697         16  CL-ADDRESS-TRAILER-CNT.
  7698             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  7699                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  7700             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  7701                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  7702             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  7703                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  7704             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  7705                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  7706             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  7707                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  7708             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  7709                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
  7710             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  7711                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  7712
  7713     12  CL-CV-REFERENCE-NO.
  7714         16  CL-CV-REFNO-PRIME       PIC X(18).
  7715         16  CL-CV-REFNO-SFX         PIC XX.
  7716
  7717     12  CL-FILE-LOCATION            PIC X(4).
  7718
  7719     12  CL-PROCESS-ERRORS.
  7720         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  7721             88  NO-FATAL-ERRORS        VALUE ZERO.
  7722         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  7723             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  7724
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 142
* EL6311.cbl
  7725     12  CL-PRODUCT-CD               PIC X.
  7726
  7727     12  CL-CURRENT-KEY-DATA.
  7728         16  CL-CURRENT-CARRIER      PIC X.
  7729         16  CL-CURRENT-GROUPING     PIC X(6).
  7730         16  CL-CURRENT-STATE        PIC XX.
  7731         16  CL-CURRENT-ACCOUNT      PIC X(10).
  7732
  7733     12  CL-ASSOCIATES               PIC X.
  7734         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  7735         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  7736         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  7737         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  7738
  7739     12  CL-ACTIVITY-CODE            PIC 99.
  7740     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  7741     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  7742
  7743     12  CL-LAPSE-REPORT-CODE        PIC 9.
  7744     12  CL-LAG-REPORT-CODE          PIC 9.
  7745     12  CL-LOAN-TYPE                PIC XX.
  7746     12  CL-LEGAL-STATE              PIC XX.
  7747
  7748     12  CL-YESNOSW                  PIC X.
  7749     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  7750         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  7751         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  7752         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  7753     12  cl-insured-type             pic x.
  7754         88  cl-claim-on-primary         value 'P'.
  7755         88  cl-claim-on-co-borrower     value 'C'.
  7756     12  cl-benefit-expiration-dt    PIC XX.
  7757*                                COPY ERCENDT.
  7758******************************************************************
  7759*                                                                *
  7760*                                                                *
  7761*                            ERCENDT.                            *
  7762*                            VMOD=2.001                          *
  7763*                                                                *
  7764*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  7765*                                                                *
  7766*   FILE TYPE = VSAM,KSDS                                        *
  7767*   RECORD SIZE = 579  RECFORM = FIXED                           *
  7768*                                                                *
  7769*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  7770*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  7771*                                                                *
  7772*   LOG = NO                                                     *
  7773*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7774******************************************************************
  7775*-----------------------------------------------------------------
  7776*                   C H A N G E   L O G
  7777*
  7778* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7779*-----------------------------------------------------------------
  7780*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7781* EFFECTIVE    NUMBER
  7782*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 143
* EL6311.cbl
  7783* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  7784*                                WITH OPEN CLAIMS
  7785* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  7786* 110612    2012101700002  AJRA  ADD NEW FIELDS
  7787* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7788* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  7789*-----------------------------------------------------------------
  7790 01  ENDORSEMENT-RECORD.
  7791     12  EN-RECORD-ID                PIC XX.
  7792         88  VALID-EN-ID                VALUE 'EN'.
  7793     12  EN-CONTROL-PRIMARY.
  7794         16  EN-COMPANY-CD           PIC X.
  7795         16  EN-CARRIER              PIC X.
  7796         16  EN-GROUPING             PIC X(6).
  7797         16  EN-STATE                PIC XX.
  7798         16  EN-ACCOUNT              PIC X(10).
  7799         16  EN-CERT-EFF-DT          PIC XX.
  7800         16  EN-CERT-NO.
  7801             20  EN-CERT-PRIME       PIC X(10).
  7802             20  EN-CERT-SFX         PIC X.
  7803         16  EN-REC-TYPE             PIC X.
  7804             88  EN-ISSUE               VALUE 'I'.
  7805             88  EN-CANCELLATION        VALUE 'C'.
  7806         16  EN-SEQ-NO               PIC 9(04) BINARY.
  7807     12  EN-CONTROL-BY-ARCH-NO.
  7808         16  EN-COMPANY-CD-A1              PIC X.
  7809         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  7810     12  EN-LAST-MAINT-DT            PIC XX.
  7811     12  EN-LAST-MAINT-BY            PIC X(4).
  7812     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  7813     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  7814     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7815         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  7816         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  7817         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  7818         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  7819         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  7820         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  7821         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  7822         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  7823         16  EN-LF-ORIG-BENCD        PIC XX.
  7824         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  7825         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7826         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7827         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  7828         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  7829         16  EN-LF-ORIG-EXP-DT       PIC XX.
  7830*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  7831         16  EN-ORIG-CRED-BENE       PIC X(25).
  7832         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7833         16  FILLER                  PIC X.
  7834         16  EN-AH-ORIG-BENCD        PIC XX.
  7835         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  7836         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  7837         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  7838         16  EN-AH-ORIG-EXP-DT       PIC XX.
  7839*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  7840*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 144
* EL6311.cbl
  7841         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  7842         16  F                       PIC X(09).
  7843         16  EN-AH-ORIG-CP           PIC 99.
  7844         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  7845         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  7846         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  7847         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  7848         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  7849         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  7850         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  7851         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  7852         16  EN-LF-NEW-BENCD         PIC XX.
  7853         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  7854         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7855         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7856         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  7857         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  7858         16  EN-LF-NEW-EXP-DT        PIC XX.
  7859         16  EN-NEW-CRED-BENE        PIC X(25).
  7860         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7861         16  FILLER                  PIC X.
  7862         16  EN-AH-NEW-BENCD         PIC XX.
  7863         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  7864         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  7865         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  7866         16  EN-AH-NEW-EXP-DT        PIC XX.
  7867*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  7868*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  7869*        16  F                       PIC X(12).
  7870         16  EN-AH-NEW-CP            PIC 99.
  7871         16  EN-SIG-SW               PIC X.
  7872         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  7873         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  7874         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  7875         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  7876         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  7877         16  FILLER                  PIC X(33).
  7878     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  7879         16  EN-LF-ORIG-REF-DT       PIC XX.
  7880         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7881         16  EN-AH-ORIG-REF-DT       PIC XX.
  7882         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  7883         16  EN-LF-NEW-REF-DT        PIC XX.
  7884         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7885         16  EN-AH-NEW-REF-DT        PIC XX.
  7886         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  7887         16  EN-FLAG-CERT            PIC X.
  7888         16  EN-INS-LAST-NAME        PIC X(15).
  7889         16  EN-INS-FIRST-NAME       PIC X(10).
  7890         16  EN-INS-MIDDLE-INIT      PIC X.
  7891         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7892         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  7893         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7894         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  7895         16  FILLER                  PIC X(262).
  7896     12  EN-MONEY-SW             PIC X.
  7897     12  EN-HEALTH-APP           PIC X.
  7898     12  EN-VOUCHER-SW           PIC X.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 145
* EL6311.cbl
  7899     12  EN-PAYEE                PIC X(14).
  7900     12  EN-INPUT-DT             PIC XX.
  7901     12  EN-PROCESS-DT           PIC XX.
  7902     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  7903     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  7904     12  EN-REASON-CODES.
  7905         16  F OCCURS 12.
  7906             20  EN-REASON-CODE  PIC X(4).
  7907     12  EN-TEMPLATE-USED        PIC X(8).
  7908     12  EN-DOCU-TYPE            PIC X.
  7909         88  EN-VERI-DOCU          VALUE 'V'.
  7910         88  EN-GCE-DOCU           VALUE 'G'.
  7911         88  EN-CANC-DOCU          VALUE 'C'.
  7912     12  EN-COMMENTS1            PIC X(13).
  7913     12  EN-COMMENTS2            PIC X(70).
  7914     12  EN-COMM-CHGBK           PIC X.
  7915         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  7916         88  EN-CHG-ACCT           VALUE 'Y'.
  7917     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  7918     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  7919     12  EN-BATCH-NUMBER         PIC X(6).
  7920     12  EN-ACCT-SUMM            PIC X.
  7921     12  EN-CSO-SUMM             PIC X.
  7922     12  en-check-type           pic x.
  7923     12  FILLER                  PIC X(12).
  7924******************************************************************
  7925*                                COPY ELCCRTT.
  7926******************************************************************
  7927*                                                                *
  7928*                            ELCCRTT.                            *
  7929*                                                                *
  7930*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  7931*                                                                *
  7932*   FILE TYPE = VSAM,KSDS                                        *
  7933*   RECORD SIZE = 552  RECFORM = FIXED                           *
  7934*                                                                *
  7935*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  7936*                                                                *
  7937*   LOG = YES                                                    *
  7938*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7939******************************************************************
  7940*                   C H A N G E   L O G
  7941*
  7942* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7943*-----------------------------------------------------------------
  7944*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7945* EFFECTIVE    NUMBER
  7946*-----------------------------------------------------------------
  7947* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  7948* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  7949* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  7950* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  7951* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  7952* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  7953* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  7954* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  7955* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  7956******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 146
* EL6311.cbl
  7957
  7958 01  CERTIFICATE-TRAILERS.
  7959     12  CS-RECORD-ID                      PIC XX.
  7960         88  VALID-CS-ID                      VALUE 'CS'.
  7961
  7962     12  CS-CONTROL-PRIMARY.
  7963         16  CS-COMPANY-CD                 PIC X.
  7964         16  CS-CARRIER                    PIC X.
  7965         16  CS-GROUPING                   PIC X(6).
  7966         16  CS-STATE                      PIC XX.
  7967         16  CS-ACCOUNT                    PIC X(10).
  7968         16  CS-CERT-EFF-DT                PIC XX.
  7969         16  CS-CERT-NO.
  7970             20  CS-CERT-PRIME             PIC X(10).
  7971             20  CS-CERT-SFX               PIC X.
  7972         16  CS-TRAILER-TYPE               PIC X.
  7973             88  COMM-TRLR           VALUE 'A'.
  7974             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  7975             88  CERT-DATA-TRLR      VALUE 'C'.
  7976
  7977     12  CS-DATA-AREA                      PIC X(516).
  7978
  7979     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  7980         16  CS-BANK-COMMISSION-AREA.
  7981             20  CS-BANK-COMMS       OCCURS 10.
  7982                 24  CS-AGT                PIC X(10).
  7983                 24  CS-COM-TYP            PIC X.
  7984                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  7985                 24  CS-RECALC-LV-INDIC    PIC X.
  7986                 24  FILLER                PIC X(10).
  7987         16  FILLER                        PIC X(256).
  7988
  7989     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  7990****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  7991         16  CS-MB-CLAIM-DATA OCCURS 24.
  7992             20  CS-CLAIM-NO               PIC X(7).
  7993             20  CS-CLAIM-TYPE             PIC X.
  7994                 88  CS-AH-CLM               VALUE 'A'.
  7995                 88  CS-IU-CLM               VALUE 'I'.
  7996                 88  CS-GP-CLM               VALUE 'G'.
  7997                 88  CS-LF-CLM               VALUE 'L'.
  7998                 88  CS-PR-CLM               VALUE 'P'.
  7999                 88  CS-FL-CLM               VALUE 'F'.
  8000             20  CS-INSURED-TYPE           PIC X.
  8001                 88  CS-PRIM-INSURED          VALUE 'P'.
  8002                 88  CS-CO-BORROWER           VALUE 'C'.
  8003             20  CS-BENEFIT-PERIOD         PIC 99.
  8004             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  8005             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  8006             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  8007         16  FILLER                        PIC X(12).
  8008     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  8009         16  CS-VIN-NUMBER                 PIC X(17).
  8010         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  8011         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  8012         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  8013         16  cs-agent-name.
  8014             20  cs-agent-fname            pic x(20).
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 147
* EL6311.cbl
  8015             20  cs-agent-mi               pic x.
  8016             20  cs-agent-lname            pic x(25).
  8017         16  cs-license-no                 pic x(15).
  8018         16  cs-npn-number                 pic x(10).
  8019         16  cs-agent-edit-status          pic x.
  8020             88  cs-ae-refer-to-manager      value 'M'.
  8021             88  cs-ae-cover-sheet           value 'C'.
  8022             88  cs-ae-sig-form              value 'S'.
  8023             88  cs-ae-verified              value 'V'.
  8024             88  cs-unidentified-signature   value 'U'.
  8025             88  cs-cert-returned            value 'R'.
  8026             88  cs-accept-no-commission     value 'N'.
  8027         16  cs-year                       pic 9999.
  8028         16  cs-make                       pic x(20).
  8029         16  cs-model                      pic x(20).
  8030         16  cs-future                     pic x(20).
  8031         16  cs-vehicle-odometer           pic s9(7) comp-3.
  8032         16  FILLER                        PIC X(356). *> was 420
  8033*        16  FILLER                        PIC X(496).
  8034*                                COPY ERCCHEK.
  8035******************************************************************
  8036*                                                                *
  8037*                                                                *
  8038*                            ERCCHEK                             *
  8039*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8040*                            VMOD=2.008                          *
  8041*                                                                *
  8042*   FILE DESCRIPTION = CHECK RECORDS                             *
  8043*                                                                *
  8044*   FILE TYPE = VSAM,KSDS                                        *
  8045*   RECORD SIZE = 600    RECFORM = FIXED                         *
  8046*                                                                *
  8047*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  8048*       ALTERNATE INDEX = NONE                                   *
  8049*                                                                *
  8050*   LOG = YES                                                    *
  8051*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8052******************************************************************
  8053*                   C H A N G E   L O G
  8054*
  8055* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8056*-----------------------------------------------------------------
  8057*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8058* EFFECTIVE    NUMBER
  8059*-----------------------------------------------------------------
  8060* 021414    2003053000001  PEMA  changes for auto chk request
  8061******************************************************************
  8062 01  CHECK-RECORDS.
  8063     12  CH-RECORD-ID                      PIC XX.
  8064         88  VALID-CH-ID                      VALUE 'CH'.
  8065
  8066     12  CH-CONTROL-PRIMARY.
  8067         16  CH-COMPANY-CD                 PIC X.
  8068         16  CH-CARRIER                    PIC X.
  8069         16  CH-GROUPING                   PIC X(6).
  8070         16  CH-STATE                      PIC XX.
  8071         16  CH-ACCOUNT                    PIC X(10).
  8072         16  CH-CERT-EFF-DT                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 148
* EL6311.cbl
  8073         16  CH-CERT-NO.
  8074             20  CH-CERT-PRIME             PIC X(10).
  8075             20  CH-CERT-SFX               PIC X.
  8076         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  8077
  8078     12  CH-RECORDED-DT                    PIC XX.
  8079     12  CH-RECORDED-BY                    PIC X(4).
  8080     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  8081
  8082     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  8083     12  CH-CHECK-NO                       PIC X(7).
  8084     12  CH-REASON-FOR-CHECK               PIC X(25).
  8085     12  CH-CHECK-WRITTEN-DT               PIC XX.
  8086     12  FILLER                            PIC X.
  8087
  8088     12  CH-PAYEE-INFO.
  8089         16  CH-PAYEE-NAME-1               PIC X(30).
  8090         16  CH-PAYEE-NAME-2               PIC X(30).
  8091         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  8092         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  8093         16  CH-PAYEE-CITY-ST.
  8094             20  CH-PAYEE-CITY             PIC X(28).
  8095             20  CH-PAYEE-STATE            PIC XX.
  8096         16  CH-PAYEE-ZIP-CODE.
  8097             20  CH-PAYEE-ZIP.
  8098                 24  CH-ZIP-PRI-1ST        PIC X.
  8099                     88  CH-CANADIAN-POST-CODE
  8100                                           VALUES 'A' THRU 'Z'.
  8101                 24  FILLER                PIC X(4).
  8102             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  8103         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  8104             20  CH-CAN-POSTAL-1           PIC XXX.
  8105             20  CH-CAN-POSTAL-2           PIC XXX.
  8106             20  FILLER                    PIC XXX.
  8107
  8108     12  CH-CHECK-STUB-TEXT.
  8109         16  CH-STUB-LINE-1                PIC X(30).
  8110         16  CH-TEXT-LINE-1                PIC X(50).
  8111         16  CH-TEXT-LINE-2                PIC X(50).
  8112         16  CH-TEXT-LINE-3                PIC X(40).
  8113     12  CH-RETURN-TO                      PIC X(30).
  8114
  8115     12  CH-COMPENSATION-CONTROL.
  8116         16  CH-COMP-CARRIER               PIC X.
  8117         16  CH-COMP-GROUPING              PIC X(6).
  8118         16  CH-COMP-FIN-RESP              PIC X(10).
  8119         16  CH-COMP-ACCOUNT               PIC X(10).
  8120
  8121     12  CH-CREDIT-SELECT-DT               PIC XX.
  8122     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  8123     12  CH-PAYEE-CODE                     PIC X(6).
  8124
  8125     12  CH-VOID-DATA.
  8126         20  CH-VOID-DT                    PIC XX.
  8127         20  CH-VOID-BY                    PIC X(4).
  8128         20  CH-VOID-REASON                PIC X(25).
  8129
  8130     12  CH-APPROVAL-DATA.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 149
* EL6311.cbl
  8131         20  CH-APPROVAL-DT                PIC XX.
  8132         20  CH-APPROVAL-STATUS            PIC X.
  8133             88  CH-IN-LIMBO                  VALUE ' '.
  8134             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  8135             88  CH-APPROVED                  VALUE 'A'.
  8136             88  CH-DENIED                    VALUE 'D'.
  8137         20  CH-APPROVED-BY                PIC XXXX.
  8138     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  8139             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  8140     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  8141
  8142     12  ch-released-dt                    pic xx.
  8143     12  ch-check-cashed-dt                pic xx.
  8144     12  FILLER                            PIC X.
  8145*    12  CH-CHECK-REFERENCE                PIC X(12).
  8146     12  CH-CHECK-ORIGIN-SW                PIC X.
  8147             88  CH-REFUND-CHECK              VALUE 'R'.
  8148             88  CH-MAINT-CHECK               VALUE 'M'.
  8149
  8150     12  CH-CANC-DT                        PIC XX.
  8151     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  8152     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  8153
  8154     12  CH-INSURED-NAME                   PIC X(28).
  8155
  8156     12  ch-released-by                    pic x(4).
  8157     12  ch-csr                            pic x(4).
  8158     12  ch-deduct-commission              pic x.
  8159         88  ch-deduct-comm                  value 'Y'.
  8160         88  ch-do-not-deduct-comm           value 'N'.
  8161
  8162     12  FILLER                            PIC X(11).
  8163*    12  CH-LETTER-TABLE.
  8164*        16  CH-LETTERS OCCURS 3 TIMES
  8165*                       INDEXED BY CH-LT-NDX
  8166*                                          PIC X(04).
  8167
  8168     12  FILLER                            PIC X(07).
  8169
  8170 01  var                         pic x(30).
  8171 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  8172                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  8173                          PENDING-MAILING-DATA MAILING-DATA
  8174                          AR-REQUEST-RECORD LOAN-OFFICER-MASTER
  8175                          PENDING-PAY-ADJ CERT-NOTE-FILE
  8176                          CLAIM-MASTER ENDORSEMENT-RECORD
  8177                          CERTIFICATE-TRAILERS CHECK-RECORDS
  8178                          VAR.
  8179 0000-DFHEXIT SECTION.
  8180     MOVE '9#                    $   ' TO DFHEIV0.
  8181     MOVE 'EL6311' TO DFHEIV1.
  8182     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8183
  8184     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  8185     MOVE EIBTRMID               TO QID-TERM.
  8186     MOVE 3                      TO EMI-NUMBER-OF-LINES.
  8187     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6.
  8188     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 150
* EL6311.cbl
  8189     MOVE 2                      TO EMI-SWITCH2.
  8190
  8191     move spaces to ws-kix-myenv
  8192     set P to address of KIXSYS
  8193     CALL "getenv" using by value P returning var-ptr
  8194     if var-ptr = null then
  8195        display ' kixsys not set '
  8196     else
  8197        set address of var to var-ptr
  8198        move 0 to env-var-len
  8199        inspect var tallying env-var-len
  8200          for characters before X'00'
  8201        unstring var (1:env-var-len) delimited by '/'
  8202           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8203              WS-KIX-SYS
  8204        end-unstring
  8205     end-if
  8206     perform varying a1 from +1 by +1 until a1 > +10
  8207        if ws-kix-myenv (a1:1) = low-values or high-values
  8208           display ' found low or hi val '
  8209           move spaces to ws-kix-myenv (a1:1)
  8210        end-if
  8211     end-perform
  8212*    display ' env *' ws-kix-myenv '*'
  8213     IF EIBCALEN = 0
  8214         GO TO 8800-UNAUTHORIZED-ACCESS.
  8215
  8216     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  8217     MOVE '5'                   TO DC-OPTION-CODE.
  8218     PERFORM 9700-DATE-LINK.
  8219     MOVE DC-GREG-DATE-1-EDIT   TO  WS-CURRENT-DT.
  8220     MOVE DC-BIN-DATE-1         TO  WS-CURRENT-BIN-DT.
  8221
  8222     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
  8223     MOVE SPACE                  TO DC-OPTION-CODE.
  8224     PERFORM 9700-DATE-LINK.
  8225     MOVE DC-GREG-DATE-1-EDIT    TO WS-MONTH-END-DT.
  8226     MOVE LOW-VALUES             TO EL631BI.
  8227
  8228
  8229* EXEC CICS HANDLE CONDITION
  8230*        PGMIDERR  (9600-PGMID-ERROR)
  8231*        ERROR     (9990-ABEND)
  8232*        INVREQ    (9990-ABEND)
  8233*        QIDERR    (0010-MAIN-LOGIC)
  8234*    END-EXEC.
  8235*    MOVE '"$L.8N                ! " #00008224' TO DFHEIV0
  8236     MOVE X'22244C2E384E202020202020' TO DFHEIV0(1:12)
  8237     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8238     MOVE X'2220233030303038323234' TO DFHEIV0(25:11)
  8239     CALL 'kxdfhei1' USING DFHEIV0
  8240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8241
  8242
  8243     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  8244         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  8245             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  8246             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 151
* EL6311.cbl
  8247             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  8248             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  8249             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  8250             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  8251             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  8252             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  8253
  8254             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL631'
  8255                 PERFORM 6050-DELETE-TEMP-STORAGE THRU 6050-EXIT
  8256
  8257             ELSE
  8258                 NEXT SENTENCE
  8259
  8260         ELSE
  8261             MOVE PI-CALLING-PROGRAM   TO PGM-NAME
  8262             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  8263             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  8264             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  8265             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  8266             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  8267             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  8268             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  8269             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  8270             PERFORM 6050-RECOVER-TEMP-STORAGE THRU 6050-EXIT
  8271             MOVE LOW-VALUES TO EC-NEW-CERT EC-NEW-STATE
  8272             GO TO 3900-RE-DISPLAY-RECORD
  8273     ELSE
  8274         GO TO 0020-MAIN-LOGIC.
  8275
  8276 0010-MAIN-LOGIC.
  8277     MOVE 'Y'                    TO WS-FIRST-TIME-SW
  8278                                    WS-FIRST-ENTRY-SW.
  8279
  8280     MOVE ' '                    TO WS-CANCEL-LETTER-SW.
  8281
  8282     MOVE LOW-VALUES             TO EC-NEW-CERT
  8283                                    EC-NEW-STATE.
  8284
  8285     IF PI-DISPLAY-ORIGINAL-BATCH
  8286         NEXT SENTENCE
  8287     ELSE
  8288         IF ALL-OUT-OF-BAL   OR  ONLY-BATCH-HEADERS
  8289             GO TO 5000-BROWSE-BATCH-HEADERS.
  8290
  8291     IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  8292         GO TO 4100-BROWSE-PRIMARY-FORWARD.
  8293
  8294     IF PI-CSR-BROWSE
  8295        GO TO 4200-BROWSE-CSR-FORWARD.
  8296
  8297     IF PI-FILE-BROWSE
  8298         GO TO 4300-BROWSE-FILE-FORWARD.
  8299
  8300     GO TO 4000-BROWSE-DETAIL-FORWARD.
  8301
  8302 0020-MAIN-LOGIC.
  8303     IF EIBAID = DFHCLEAR
  8304         GO TO 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 152
* EL6311.cbl
  8305
  8306     MOVE LOW-VALUES             TO EC-NEW-CERT
  8307                                    EC-NEW-STATE.
  8308
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 153
* EL6311.cbl
  8310
  8311******************************************************************
  8312*                                                                *
  8313*              R E C E I V E   M A P                             *
  8314*                                                                *
  8315******************************************************************
  8316
  8317 0200-RECEIVE.
  8318     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  8319         MOVE ER-0008            TO EMI-ERROR
  8320         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8321         IF PI-MAP-NAME = EL631B
  8322             MOVE -1                 TO BMAINTL
  8323             GO TO 8200-SEND-DATAONLY
  8324         ELSE
  8325             IF PI-MAP-NAME = EL631C
  8326                 MOVE -1                 TO CMAINTL
  8327                 GO TO 8200-SEND-DATAONLY
  8328             ELSE
  8329                 IF PI-MAP-NAME = EL631D
  8330                     MOVE -1                 TO DPFENTRL
  8331                     GO TO 8200-SEND-DATAONLY.
  8332
  8333
  8334* EXEC CICS RECEIVE
  8335*        MAP      (PI-MAP-NAME)
  8336*        MAPSET   (MAPSET-EL6311S)
  8337*        INTO     (EL631BI)
  8338*    END-EXEC.
  8339     MOVE LENGTH OF
  8340      EL631BI
  8341       TO DFHEIV11
  8342*    MOVE '8"T I  L              ''   #00008321' TO DFHEIV0
  8343     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8344     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8345     MOVE X'2020233030303038333231' TO DFHEIV0(25:11)
  8346     CALL 'kxdfhei1' USING DFHEIV0,
  8347           PI-MAP-NAME,
  8348           EL631BI,
  8349           DFHEIV11,
  8350           MAPSET-EL6311S,
  8351           DFHEIV99,
  8352           DFHEIV99
  8353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8354
  8355
  8356******************************************************************
  8357*        TRANSFORM  UNDERLINE CHARACTERS TO SPACES               *
  8358******************************************************************
  8359
  8360     IF BTYPE-LEN (1) EQUAL +3
  8361        IF BTYPE (1) EQUAL ALL ' '
  8362            MOVE 'Y' TO WS-REMOVE-LF-SW.
  8363
  8364     IF BTYPE-LEN (2) EQUAL +3
  8365        IF BTYPE (2) EQUAL ALL ' '
  8366            MOVE 'Y' TO WS-REMOVE-AH-SW.
  8367
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 154
* EL6311.cbl
  8368     INSPECT EL631BI CONVERTING '_' TO ' '.
  8369
  8370     IF PI-MAP-NAME = EL631B
  8371         IF BPFENTRL GREATER THAN ZEROS
  8372             IF EIBAID NOT = DFHENTER
  8373                 MOVE ER-0004       TO EMI-ERROR
  8374                 MOVE -1            TO BPFENTRL
  8375                 MOVE AL-UNBOF      TO BPFENTRA
  8376                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8377                 GO TO 8200-SEND-DATAONLY
  8378             ELSE
  8379                 IF BPFENTRI NUMERIC AND
  8380                   (BPFENTRI GREATER 0 AND LESS 25)
  8381                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  8382                 ELSE
  8383                     MOVE ER-0029  TO EMI-ERROR
  8384                     MOVE AL-UNBON TO BPFENTRA
  8385                     MOVE -1       TO BPFENTRL
  8386                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8387                     GO TO 8200-SEND-DATAONLY
  8388         ELSE
  8389             NEXT SENTENCE
  8390     ELSE
  8391         IF PI-MAP-NAME = EL631C
  8392            IF CPFENTRL GREATER THAN ZEROS
  8393                IF EIBAID NOT = DFHENTER
  8394                 MOVE ER-0004         TO EMI-ERROR
  8395                 MOVE -1              TO CPFENTRL
  8396                 MOVE AL-UNBOF        TO CPFENTRA
  8397                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8398                 GO TO 8200-SEND-DATAONLY
  8399             ELSE
  8400                 IF CPFENTRI NUMERIC AND
  8401                   (CPFENTRI GREATER 0 AND LESS 25)
  8402                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  8403                 ELSE
  8404                     MOVE ER-0029      TO EMI-ERROR
  8405                     MOVE AL-UNBON     TO CPFENTRA
  8406                     MOVE -1           TO CPFENTRL
  8407                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8408                     GO TO 8200-SEND-DATAONLY
  8409         ELSE
  8410             NEXT SENTENCE
  8411     ELSE
  8412     IF PI-MAP-NAME = EL631D
  8413         IF DPFENTRL GREATER THAN ZEROS
  8414             IF EIBAID NOT = DFHENTER
  8415                 MOVE ER-0004         TO EMI-ERROR
  8416                 MOVE -1              TO DPFENTRL
  8417                 MOVE AL-UNBOF        TO DPFENTRA
  8418                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8419                 GO TO 8200-SEND-DATAONLY
  8420             ELSE
  8421                 IF DPFENTRI NUMERIC AND
  8422                   (DPFENTRI GREATER 0 AND LESS 25)
  8423                     MOVE PF-VALUES (DPFENTRI) TO EIBAID
  8424                 ELSE
  8425                     MOVE ER-0029      TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 155
* EL6311.cbl
  8426                     MOVE AL-UNBON     TO DPFENTRA
  8427                     MOVE -1           TO DPFENTRL
  8428                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8429                     GO TO 8200-SEND-DATAONLY.
  8430
  8431     IF EIBAID = DFHPF23
  8432         GO TO 8810-PF23.
  8433
  8434     IF EIBAID = DFHPF24
  8435         GO TO 9200-RETURN-MAIN-MENU.
  8436
  8437     IF EIBAID = DFHPF12
  8438         GO TO 9500-PF12.
  8439
  8440     IF PI-MAP-NAME = EL631B
  8441        GO TO 0300-CHECK-ISSUE-PF-KEYS.
  8442
  8443     IF PI-MAP-NAME = EL631C
  8444        GO TO 0400-CHECK-CANCEL-PF-KEYS.
  8445
  8446     IF PI-MAP-NAME = EL631D
  8447        GO TO 0500-CHECK-BATCH-PF-KEYS.
  8448
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 156
* EL6311.cbl
  8450
  8451******************************************************************
  8452*                                                                *
  8453*      ISSUE SCREEN PF KEY CHECKING                              *
  8454*                                                                *
  8455******************************************************************
  8456
  8457******************************************************************
  8458*                                                                *
  8459*      PF KEY FUNCTIONS:                                         *
  8460*                                                                *
  8461*      PF1  = BROWSE FORWARD                                     *
  8462*      PF2  = BROWSE BACKWARD                                    *
  8463*      PF3  = CERTIFICATE LOOKUP                                 *
  8464*      PF4  = DISPLAY BATCH HEADER                               *
  8465*      PF5  = ADD ISSUE  SCREEN                                  *
  8466*      PF6  = ADD CANCEL SCREEN                                  *
  8467*      PF7  = CERTIFICATE DISPLAY                                *
  8468*      PF8  = CERTIFICATE NOTES                                  *
  8469*      PF9  = EDIT CONTROL                                       *
  8470*      PF10 = DISPLAY LETTER SCREEN                              *
  8471*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8472*      PF12 = HELP SCREEN                                        *
  8473*      PF13 = CONTINUE ISSUE DISPLAY (SECOND SCREEN)             *
  8474*      PF14 = ACCOUNT MASTER                                     *
  8475*      PF15 = PROCESS CERT VERIFICATION OR GENERAL CHG ENDORSEMNT*
  8476*      PF16 = DISPLAY LETTER REVIEW                              *
  8477*                                                                *
  8478******************************************************************
  8479
  8480 0300-CHECK-ISSUE-PF-KEYS.
  8481     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8482        MOVE ER-2337            TO EMI-ERROR
  8483        MOVE -1                  TO BMAINTL
  8484        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8485        GO TO 8200-SEND-DATAONLY.
  8486
  8487     IF EIBAID = DFHPF1
  8488        MOVE '0'                TO PI-EDIT-SW
  8489        IF PI-PRIMARY-BROWSE
  8490           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8491        ELSE
  8492           IF PI-PRIMARY-WITH-SELECT
  8493              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8494           ELSE
  8495              IF PI-FILE-BROWSE
  8496                 GO TO 4300-BROWSE-FILE-FORWARD
  8497              ELSE
  8498                 IF PI-CSR-BROWSE
  8499                    GO TO 4200-BROWSE-CSR-FORWARD
  8500                 ELSE
  8501                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8502
  8503     IF EIBAID = DFHPF2
  8504        MOVE '0'                TO PI-EDIT-SW
  8505        IF PI-PRIMARY-BROWSE
  8506           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8507        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 157
* EL6311.cbl
  8508           IF PI-PRIMARY-WITH-SELECT
  8509              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8510           ELSE
  8511              IF PI-FILE-BROWSE
  8512                 GO TO 4800-BROWSE-FILE-BACKWARD
  8513              ELSE
  8514                 IF PI-CSR-BROWSE
  8515                    GO TO 4900-BROWSE-CSR-BACKWARD
  8516                 ELSE
  8517                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8518
  8519     IF EIBAID = DFHPF3
  8520        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8521        MOVE XCTL-EL127         TO PGM-NAME
  8522        GO TO 9300-XCTL.
  8523
  8524     IF (EIBAID = DFHPF15 OR DFHPF6)
  8525        AND (CSR-EDIT-SESSION)
  8526*       AND (FATAL-OR-UNFORCED)
  8527        AND (FATAL-ERRORS)
  8528        MOVE ER-1819             TO EMI-ERROR
  8529        MOVE -1                  TO BMAINTL
  8530        MOVE AL-UANON            TO BMAINTA
  8531        PERFORM 9900-ERROR-FORMAT
  8532                                 THRU 9900-EXIT
  8533        GO TO 8200-SEND-DATAONLY
  8534     END-IF
  8535     IF (EIBAID = DFHPF15 AND CSR-EDIT-SESSION)
  8536      OR (EIBAID = DFHPF10)
  8537        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8538        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8539        IF (RESP-NORMAL)
  8540           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8541              AM-CONTROL-PRIMARY (1:20))
  8542            IF AM-NAME NOT GREATER THAN SPACES OR
  8543               AM-ADDRS NOT GREATER THAN SPACES  OR
  8544               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8545               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8546               AM-ZIP NOT GREATER THAN SPACES
  8547               MOVE ER-3834             TO EMI-ERROR
  8548               MOVE -1                  TO BMAINTL
  8549               MOVE AL-UANON            TO BMAINTA
  8550               PERFORM 9900-ERROR-FORMAT
  8551                                 THRU 9900-EXIT
  8552               GO TO 8200-SEND-DATAONLY
  8553            END-IF
  8554        ELSE
  8555           MOVE ER-1609             TO EMI-ERROR
  8556           MOVE -1                  TO BMAINTL
  8557           MOVE AL-UANON            TO BMAINTA
  8558           PERFORM 9900-ERROR-FORMAT
  8559                                THRU 9900-EXIT
  8560           GO TO 8200-SEND-DATAONLY
  8561        END-IF
  8562
  8563        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8564        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8565        IF (ERMAIL-FOUND)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 158
* EL6311.cbl
  8566            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
  8567               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8568               MA-CITY NOT GREATER THAN SPACES OR
  8569               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8570               MA-ZIP-CODE NOT GREATER THAN SPACES
  8571               MOVE ER-3835             TO EMI-ERROR
  8572               MOVE -1                  TO BMAINTL
  8573               MOVE AL-UANON            TO BMAINTA
  8574               PERFORM 9900-ERROR-FORMAT
  8575                                 THRU 9900-EXIT
  8576               GO TO 8200-SEND-DATAONLY
  8577            END-IF
  8578        ELSE
  8579           MOVE ER-3000             TO EMI-ERROR
  8580           MOVE -1                  TO BMAINTL
  8581           MOVE AL-UANON            TO BMAINTA
  8582           PERFORM 9900-ERROR-FORMAT
  8583                                THRU 9900-EXIT
  8584           GO TO 8200-SEND-DATAONLY
  8585        END-IF
  8586
  8587     END-IF
  8588     IF (EIBAID = DFHPF15)
  8589        AND (CSR-EDIT-SESSION)
  8590        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  8591        MOVE PI-SV-CARRIER       TO PI-CARRIER
  8592        MOVE PI-SV-GROUPING      TO PI-GROUPING
  8593        MOVE PI-SV-STATE         TO PI-STATE
  8594        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  8595        MOVE BCERTNOI            TO PI-CERT-PRIME
  8596        MOVE BSUFIXI             TO PI-CERT-SFX
  8597        MOVE BEFFDTI             TO DEEDIT-FIELD
  8598        PERFORM 8600-DEEDIT
  8599        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  8600        MOVE '4'                 TO DC-OPTION-CODE
  8601        PERFORM 9700-DATE-LINK
  8602        IF DATE-CONVERSION-ERROR
  8603           MOVE ER-0348          TO EMI-ERROR
  8604           MOVE -1               TO BEFFDTL
  8605           MOVE AL-UABON         TO BEFFDTA
  8606           PERFORM 9900-ERROR-FORMAT
  8607                                 THRU 9900-EXIT
  8608           GO TO 8200-SEND-DATAONLY
  8609        ELSE
  8610           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  8611           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8612           MOVE XCTL-EL6315      TO PGM-NAME
  8613           MOVE '1'              TO PI-6315-ISS-CAN-SW
  8614           MOVE LOW-VALUES       TO PI-6315-PASS-AREA
  8615           PERFORM 6400-CHECK-FOR-RES-REF-CLAIM THRU 6400-EXIT
  8616           MOVE WS-EL6315-PASS-AREA TO PI-PROGRAM-WORK-AREA
  8617           GO TO 9300-XCTL
  8618        END-IF
  8619     END-IF
  8620
  8621     IF EIBAID = DFHPF4
  8622        MOVE '0'                TO PI-EDIT-SW
  8623        IF PI-DISPLAY-ORIGINAL-BATCH
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 159
* EL6311.cbl
  8624           NEXT SENTENCE
  8625        ELSE
  8626           GO TO 7200-DISPLAY-BATCHES.
  8627
  8628     IF EIBAID = DFHPF5
  8629        MOVE ER-0029                TO EMI-ERROR
  8630        MOVE -1                     TO BPFENTRL
  8631        MOVE AL-UNBON               TO BPFENTRA
  8632        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8633        GO TO 8200-SEND-DATAONLY.
  8634*        MOVE '0'                TO PI-EDIT-SW
  8635*        IF PI-DISPLAY-ORIGINAL-BATCH
  8636*           NEXT SENTENCE
  8637*        ELSE
  8638*           MOVE EL631B              TO PI-MAP-NAME
  8639*           MOVE LOW-VALUES          TO EL631BI
  8640*           MOVE 'A'                 TO BMAINTO
  8641*           MOVE AL-UANON            TO BMAINTA
  8642*           MOVE -1                  TO BMAINTL
  8643*           MOVE '5'                 TO PI-MAINT-FUNCTION
  8644*           GO TO 8100-SEND-INITIAL-MAP.
  8645
  8646     IF EIBAID = DFHPF6
  8647        IF NOT CSR-EDIT-SESSION
  8648           MOVE ER-0029                TO EMI-ERROR
  8649           MOVE -1                     TO BPFENTRL
  8650           MOVE AL-UNBON               TO BPFENTRA
  8651           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8652           GO TO 8200-SEND-DATAONLY
  8653*           MOVE '0'              TO PI-EDIT-SW
  8654*           IF PI-DISPLAY-ORIGINAL-BATCH
  8655*              NEXT SENTENCE
  8656*           ELSE
  8657*              MOVE EL631C        TO PI-MAP-NAME
  8658*              MOVE LOW-VALUES    TO EL631CI
  8659*              MOVE 'A'           TO CMAINTO
  8660*              MOVE AL-UANON      TO CMAINTA
  8661*              MOVE -1            TO CMAINTL
  8662*              MOVE '6'           TO PI-MAINT-FUNCTION
  8663*              GO TO 8100-SEND-INITIAL-MAP
  8664*           END-IF
  8665        ELSE
  8666           PERFORM 5100-PROCESS-POL-RESC
  8667                                 THRU 5100-EXIT
  8668           MOVE CG-BATCH-NO      TO PI-PB-ENTRY-BATCH
  8669           MOVE CG-BATCH-SEQ-NO  TO PI-PB-BATCH-SEQ-NO
  8670                                    PI-PREV-SEQ-NO
  8671           MOVE 'Y'              TO WS-FIRST-TIME-SW
  8672*                                    WS-CANCEL-LETTER-SW
  8673                                    PI-ALL-ISSUES-SW
  8674                                    PI-ALL-CANCELS-SW
  8675           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8676        END-IF
  8677     END-IF
  8678     IF EIBAID = DFHPF7
  8679        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8680        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8681        MOVE PI-SV-GROUPING         TO PI-GROUPING
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 160
* EL6311.cbl
  8682        MOVE PI-SV-STATE            TO PI-STATE
  8683        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8684        MOVE BCERTNOI               TO PI-CERT-PRIME
  8685        MOVE BSUFIXI                TO PI-CERT-SFX
  8686        MOVE BEFFDTI                TO DEEDIT-FIELD
  8687        PERFORM 8600-DEEDIT
  8688        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8689        MOVE '4'                    TO DC-OPTION-CODE
  8690        PERFORM 9700-DATE-LINK
  8691        IF DATE-CONVERSION-ERROR
  8692           MOVE ER-0348            TO EMI-ERROR
  8693           MOVE -1                  TO BEFFDTL
  8694           MOVE AL-UABON            TO BEFFDTA
  8695           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8696           GO TO 8200-SEND-DATAONLY
  8697        ELSE
  8698           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8699           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8700           MOVE XCTL-EL1273        TO PGM-NAME
  8701           GO TO 9300-XCTL.
  8702
  8703     IF EIBAID = DFHPF8
  8704        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8705        MOVE PI-SV-CARRIER          TO PI-CARRIER
  8706        MOVE PI-SV-GROUPING         TO PI-GROUPING
  8707        MOVE PI-SV-STATE            TO PI-STATE
  8708        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  8709        MOVE BCERTNOI               TO PI-CERT-PRIME
  8710        MOVE BSUFIXI                TO PI-CERT-SFX
  8711        MOVE BEFFDTI                TO DEEDIT-FIELD
  8712        PERFORM 8600-DEEDIT
  8713        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  8714        MOVE '4'                    TO DC-OPTION-CODE
  8715        PERFORM 9700-DATE-LINK
  8716        IF DATE-CONVERSION-ERROR
  8717           MOVE ER-0348            TO EMI-ERROR
  8718           MOVE -1                  TO BEFFDTL
  8719           MOVE AL-UABON            TO BEFFDTA
  8720           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8721           GO TO 8200-SEND-DATAONLY
  8722        ELSE
  8723           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  8724           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8725           IF PI-COMPANY-ID = 'DMD'
  8726               MOVE XCTL-EL401DMD      TO PGM-NAME
  8727             ELSE
  8728               MOVE XCTL-EL1279        TO PGM-NAME
  8729           END-IF
  8730           GO TO 9300-XCTL.
  8731
  8732     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  8733        MOVE XCTL-EL6312         TO PGM-NAME
  8734
  8735* EXEC CICS XCTL
  8736*           PROGRAM   (PGM-NAME)
  8737*           COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  8738*           LENGTH    (WS-COMM-LENGTH)
  8739*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 161
* EL6311.cbl
  8740*    MOVE '.$C                   %   #00008705' TO DFHEIV0
  8741     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8742     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8743     MOVE X'2020233030303038373035' TO DFHEIV0(25:11)
  8744     CALL 'kxdfhei1' USING DFHEIV0,
  8745           PGM-NAME,
  8746           PROGRAM-INTERFACE-BLOCK,
  8747           WS-COMM-LENGTH,
  8748           DFHEIV99
  8749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8750     ELSE
  8751        MOVE '0'                 TO  PI-EDIT-SW.
  8752
  8753     IF  EIBAID = DFHPF10
  8754         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8755         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8756         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8757                                    PI-1042-WA
  8758         MOVE 4                  TO PI-689-DATA-SOURCE
  8759         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8760         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8761         MOVE PI-SV-STATE        TO PI-689-STATE
  8762         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8763         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8764         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8765         MOVE PI-PB-ALT-CHG-SEQ-NO
  8766                                 TO PI-689-ALT-SEQ-NO
  8767         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8768         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8769         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8770         MOVE +0                 TO PI-689-CONTROL
  8771         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  8772                                    PI-689-EXP-DATE
  8773                                    PI-689-RESP-PERSON
  8774                                    PI-689-TYPE
  8775                                    PI-689-FOLLOW-UP-EDIT
  8776                                    PI-689-RESEND1-EDIT
  8777                                    PI-689-SEQ-EDIT
  8778                                    PI-689-BCSEQ-EDIT
  8779                                    PI-689-LBL-OVERRIDE
  8780         MOVE W-LETTER-COMMUNICATION-AREAS
  8781                                 TO PI-PROGRAM-WORK-AREA
  8782         MOVE XCTL-EL689         TO PGM-NAME
  8783         GO TO 9300-XCTL.
  8784
  8785     IF  EIBAID = DFHPF16
  8786         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8787         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  8788         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  8789                                    PI-1042-WA
  8790         MOVE 4                  TO PI-689-DATA-SOURCE
  8791         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  8792         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  8793         MOVE PI-SV-STATE        TO PI-689-STATE
  8794         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  8795         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  8796         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  8797         MOVE PI-PB-ALT-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 162
* EL6311.cbl
  8798                                 TO PI-689-ALT-SEQ-NO
  8799         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
  8800         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  8801         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  8802         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  8803         MOVE W-LETTER-COMMUNICATION-AREAS
  8804                                 TO PI-PROGRAM-WORK-AREA
  8805         MOVE XCTL-EL690         TO PGM-NAME
  8806         GO TO 9300-XCTL.
  8807
  8808     IF EIBAID = DFHPF13
  8809         MOVE XCTL-EL6313        TO PGM-NAME
  8810         GO TO 9300-XCTL.
  8811
  8812     IF EIBAID = DFHPF17
  8813        PERFORM 6200-CREATE-VADS THRU 6200-EXIT
  8814        IF (PB-I-LOAN-APR numeric)
  8815           and (pb-i-loan-apr < 99.9999)
  8816           AND (PB-I-BENEFICIARY-NAME NOT
  8817              = SPACES AND LOW-VALUES)
  8818
  8819           MOVE LINK-ELVADS          TO PGM-NAME
  8820
  8821* EXEC CICS LINK
  8822*              PROGRAM    (PGM-NAME)
  8823*              COMMAREA   (WS-PASS-AREA)
  8824*              LENGTH     (WS-PASS-AREA-LENGTH)
  8825*          END-EXEC
  8826*    MOVE '."C                   (   #00008780' TO DFHEIV0
  8827     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8828     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8829     MOVE X'2020233030303038373830' TO DFHEIV0(25:11)
  8830     CALL 'kxdfhei1' USING DFHEIV0,
  8831           PGM-NAME,
  8832           WS-PASS-AREA,
  8833           WS-PASS-AREA-LENGTH,
  8834           DFHEIV99,
  8835           DFHEIV99,
  8836           DFHEIV99,
  8837           DFHEIV99
  8838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8839
  8840           MOVE 0000             TO EMI-ERROR
  8841           MOVE -1               TO BMAINTL
  8842           PERFORM 9900-ERROR-FORMAT
  8843                                 THRU 9900-EXIT
  8844           GO TO 8200-SEND-DATAONLY
  8845        ELSE
  8846           MOVE ER-0877            TO EMI-ERROR
  8847           MOVE -1                  TO BEFFDTL
  8848           MOVE AL-UABON            TO BEFFDTA
  8849           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8850           GO TO 8200-SEND-DATAONLY
  8851        END-IF
  8852     END-IF
  8853     IF EIBAID = DFHPF14
  8854        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  8855        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 163
* EL6311.cbl
  8856        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  8857        MOVE PI-SV-STATE            TO PI-CR-STATE
  8858        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  8859        MOVE SPACE                  TO PI-EDIT-SW
  8860        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8861        MOVE XCTL-EL650             TO PGM-NAME
  8862        GO TO 9300-XCTL.
  8863
  8864     IF EIBAID = DFHPF15
  8865        IF PI-COMPANY-ID  =  'HER'
  8866            PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8867            MOVE XCTL-EL680         TO PGM-NAME
  8868            GO TO 9300-XCTL.
  8869
  8870     IF EIBAID = DFHENTER OR DFHPF11
  8871        GO TO 1000-ISSUE-MAINLINE.
  8872
  8873     MOVE ER-0029                TO EMI-ERROR
  8874     MOVE -1                     TO BPFENTRL
  8875     MOVE AL-UNBON               TO BPFENTRA
  8876     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8877     GO TO 8200-SEND-DATAONLY.
  8878
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 164
* EL6311.cbl
  8880
  8881******************************************************************
  8882*                                                                *
  8883*      CANCEL SCREEN PF KEY CHECKING                             *
  8884*                                                                *
  8885******************************************************************
  8886
  8887******************************************************************
  8888*                                                                *
  8889*      PF KEY FUNCTIONS:                                         *
  8890*                                                                *
  8891*      PF1  = BROWSE FORWARD                                     *
  8892*      PF2  = BROWSE BACKWARD                                    *
  8893*      PF3  = CERTIFICATE LOOKUP                                 *
  8894*      PF4  = DISPLAY BATCH HEADER                               *
  8895*      PF5  = ADD ISSUE SCREEN                                   *
  8896*      PF6  = ADD CANCEL SCREEN                                  *
  8897*      PF7  = CERTIFICATE DISPLAY                                *
  8898*      PF8  = CERTIFICATE NOTES                                  *
  8899*      PF9  = EDIT CONTROL                                       *
  8900*      PF10 = DISPLAY LETTER SCREEN                              *
  8901*      PF11 = DISPLAY EXPANDED LIST OF ERRORS                    *
  8902*      PF12 = DISPLAY HELP SCREEN                                *
  8903*      PF13 = CHECK WRITER FOR CANCEL SETTLEMENTS                *
  8904*      PF14 = ACCOUNT MASTER                                     *
  8905*      PF16 = LETTER REVIEW                                      *
  8906*                                                                *
  8907******************************************************************
  8908
  8909 0400-CHECK-CANCEL-PF-KEYS.
  8910     IF EIBAID = DFHPF9 AND PI-EDIT-SW NOT = '1'
  8911        MOVE ER-2337             TO EMI-ERROR
  8912        MOVE -1                  TO CMAINTL
  8913        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8914        GO TO 8200-SEND-DATAONLY.
  8915
  8916     IF EIBAID = DFHPF1
  8917        MOVE '0'                TO PI-EDIT-SW
  8918        IF PI-PRIMARY-BROWSE
  8919           GO TO 4100-BROWSE-PRIMARY-FORWARD
  8920        ELSE
  8921           IF PI-PRIMARY-WITH-SELECT
  8922              GO TO 4100-BROWSE-PRIMARY-FORWARD
  8923           ELSE
  8924              IF PI-FILE-BROWSE
  8925                 GO TO 4300-BROWSE-FILE-FORWARD
  8926              ELSE
  8927                 IF PI-CSR-BROWSE
  8928                    GO TO 4200-BROWSE-CSR-FORWARD
  8929                 ELSE
  8930                    GO TO 4000-BROWSE-DETAIL-FORWARD.
  8931
  8932     IF EIBAID = DFHPF2
  8933        MOVE '0'                TO PI-EDIT-SW
  8934        IF PI-PRIMARY-BROWSE
  8935           GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8936        ELSE
  8937           IF PI-PRIMARY-WITH-SELECT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 165
* EL6311.cbl
  8938              GO TO 4600-BROWSE-PRIMARY-BACKWARD
  8939           ELSE
  8940              IF PI-FILE-BROWSE
  8941                 GO TO 4800-BROWSE-FILE-BACKWARD
  8942              ELSE
  8943                 IF PI-CSR-BROWSE
  8944                    GO TO 4900-BROWSE-CSR-BACKWARD
  8945                 ELSE
  8946                    GO TO 4500-BROWSE-DETAIL-BACKWARD.
  8947
  8948     IF EIBAID = DFHPF3
  8949        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  8950        MOVE XCTL-EL127         TO PGM-NAME
  8951        GO TO 9300-XCTL.
  8952
  8953     IF (EIBAID = DFHPF15 OR DFHPF17)
  8954        AND (CSR-EDIT-SESSION)
  8955*       AND (FATAL-OR-UNFORCED)
  8956        AND (FATAL-ERRORS)
  8957        MOVE ER-1819             TO EMI-ERROR
  8958        MOVE -1                  TO CMAINTL
  8959        MOVE AL-UANON            TO CMAINTA
  8960        PERFORM 9900-ERROR-FORMAT
  8961                                 THRU 9900-EXIT
  8962        GO TO 8200-SEND-DATAONLY
  8963     END-IF
  8964     IF (EIBAID = DFHPF15 OR DFHPF17 OR DFHPF10)
  8965       AND (CSR-EDIT-SESSION)
  8966        MOVE PI-PREV-ALT-KEY     TO PB-CONTROL-BY-ACCOUNT
  8967        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
  8968        IF (RESP-NORMAL)
  8969           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
  8970              AM-CONTROL-PRIMARY (1:20))
  8971            IF AM-NAME NOT GREATER THAN SPACES OR
  8972               AM-ADDRS NOT GREATER THAN SPACES  OR
  8973               AM-ADDR-CITY NOT GREATER THAN SPACES OR
  8974               AM-ADDR-STATE NOT GREATER THAN SPACES OR
  8975               AM-ZIP NOT GREATER THAN SPACES
  8976               MOVE ER-3834             TO EMI-ERROR
  8977               MOVE -1                  TO BMAINTL
  8978               MOVE AL-UANON            TO BMAINTA
  8979               PERFORM 9900-ERROR-FORMAT
  8980                                 THRU 9900-EXIT
  8981               GO TO 8200-SEND-DATAONLY
  8982            END-IF
  8983        ELSE
  8984           MOVE ER-1609             TO EMI-ERROR
  8985           MOVE -1                  TO BMAINTL
  8986           MOVE AL-UANON            TO BMAINTA
  8987           PERFORM 9900-ERROR-FORMAT
  8988                                THRU 9900-EXIT
  8989           GO TO 8200-SEND-DATAONLY
  8990        END-IF
  8991
  8992        MOVE PI-PREV-ALT-KEY (1:33) TO ELCERT-KEY
  8993        PERFORM 6220-READ-ERMAIL THRU 6220-EXIT
  8994        IF (ERMAIL-FOUND)
  8995            IF (MA-ADDRESS-LINE-1 NOT GREATER THAN SPACES AND
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 166
* EL6311.cbl
  8996               MA-ADDRESS-LINE-2 NOT GREATER THAN SPACES)  OR
  8997               MA-CITY NOT GREATER THAN SPACES OR
  8998               MA-ADDR-STATE NOT GREATER THAN SPACES OR
  8999               MA-ZIP-CODE NOT GREATER THAN SPACES
  9000               MOVE ER-3835             TO EMI-ERROR
  9001               MOVE -1                  TO BMAINTL
  9002               MOVE AL-UANON            TO BMAINTA
  9003               PERFORM 9900-ERROR-FORMAT
  9004                                 THRU 9900-EXIT
  9005               GO TO 8200-SEND-DATAONLY
  9006            END-IF
  9007        ELSE
  9008           MOVE ER-3000             TO EMI-ERROR
  9009           MOVE -1                  TO BMAINTL
  9010           MOVE AL-UANON            TO BMAINTA
  9011           PERFORM 9900-ERROR-FORMAT
  9012                                THRU 9900-EXIT
  9013           GO TO 8200-SEND-DATAONLY
  9014        END-IF
  9015
  9016     END-IF
  9017     IF (EIBAID = DFHPF15 OR DFHPF17)
  9018        AND (CSR-EDIT-SESSION)
  9019        MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
  9020        MOVE PI-SV-CARRIER       TO PI-CARRIER
  9021        MOVE PI-SV-GROUPING      TO PI-GROUPING
  9022        MOVE PI-SV-STATE         TO PI-STATE
  9023        MOVE ERPNDB-ACCOUNT      TO PI-ACCOUNT
  9024        MOVE CCERTNOI            TO PI-CERT-PRIME
  9025        MOVE CSUFIXI             TO PI-CERT-SFX
  9026        MOVE CEFFDTI             TO DEEDIT-FIELD
  9027        PERFORM 8600-DEEDIT
  9028        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  9029        MOVE '4'                 TO DC-OPTION-CODE
  9030        PERFORM 9700-DATE-LINK
  9031        IF DATE-CONVERSION-ERROR
  9032           MOVE ER-0348          TO EMI-ERROR
  9033           MOVE -1               TO CEFFDTL
  9034           MOVE AL-UABON         TO CEFFDTA
  9035           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9036           GO TO 8200-SEND-DATAONLY
  9037        ELSE
  9038           MOVE DC-BIN-DATE-1    TO PI-CERT-EFF-DT
  9039           PERFORM 6000-CREATE-TEMP-STORAGE
  9040                                 THRU 6000-EXIT
  9041           IF EIBAID = DFHPF17
  9042               PERFORM 6400-CHECK-FOR-RES-REF-CLAIM
  9043                                  THRU 6400-EXIT
  9044               IF PI-RES-REF-CLM-TYPE NOT EQUAL
  9045                                 '2' AND '3' AND '4'
  9046                  MOVE ER-3831     TO  EMI-ERROR
  9047                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9048                  GO TO 8200-SEND-DATAONLY
  9049               END-IF
  9050               MOVE 'Y'          TO PI-CLM-RESC-IND
  9051           ELSE
  9052               MOVE 'N'          TO PI-CLM-RESC-IND
  9053           END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 167
* EL6311.cbl
  9054           MOVE XCTL-EL6316      TO PGM-NAME
  9055           MOVE '2'              TO PI-ISS-CAN-SW
  9056           MOVE LOW-VALUES       TO PI-6316-PASS-AREA
  9057           MOVE WS-EL6316-PASS-AREA TO PI-PROGRAM-WORK-AREA
  9058           GO TO 9300-XCTL
  9059        END-IF
  9060     END-IF
  9061
  9062     IF EIBAID = DFHPF4
  9063        MOVE '0'                TO PI-EDIT-SW
  9064        IF PI-DISPLAY-ORIGINAL-BATCH
  9065           NEXT SENTENCE
  9066        ELSE
  9067           GO TO 7200-DISPLAY-BATCHES.
  9068
  9069     IF EIBAID = DFHPF5
  9070        MOVE ER-0029                TO EMI-ERROR
  9071        MOVE -1                     TO BPFENTRL
  9072        MOVE AL-UNBON               TO BPFENTRA
  9073        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9074        GO TO 8200-SEND-DATAONLY.
  9075*        MOVE '0'                TO PI-EDIT-SW
  9076*        IF PI-DISPLAY-ORIGINAL-BATCH
  9077*           NEXT SENTENCE
  9078*        ELSE
  9079*           MOVE EL631B              TO PI-MAP-NAME
  9080*           MOVE LOW-VALUES          TO EL631BI
  9081*           MOVE 'A'                 TO BMAINTO
  9082*           MOVE AL-UANON            TO BMAINTA
  9083*           MOVE -1                  TO BMAINTL
  9084*           MOVE '5'                 TO PI-MAINT-FUNCTION
  9085*           GO TO 8100-SEND-INITIAL-MAP.
  9086
  9087     IF EIBAID = DFHPF6
  9088        MOVE ER-0029                TO EMI-ERROR
  9089        MOVE -1                     TO BPFENTRL
  9090        MOVE AL-UNBON               TO BPFENTRA
  9091        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9092        GO TO 8200-SEND-DATAONLY.
  9093*        MOVE '0'                TO PI-EDIT-SW
  9094*        IF PI-DISPLAY-ORIGINAL-BATCH
  9095*           NEXT SENTENCE
  9096*        ELSE
  9097*           MOVE EL631C              TO PI-MAP-NAME
  9098*           MOVE LOW-VALUES          TO EL631CI
  9099*           MOVE 'A'                 TO CMAINTO
  9100*           MOVE AL-UANON            TO CMAINTA
  9101*           MOVE -1                  TO CMAINTL
  9102*           MOVE '6'                 TO PI-MAINT-FUNCTION
  9103*           GO TO 8100-SEND-INITIAL-MAP.
  9104
  9105     IF EIBAID = DFHPF7
  9106        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9107        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9108        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9109        MOVE PI-SV-STATE            TO PI-STATE
  9110        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9111        MOVE CCERTNOI               TO PI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 168
* EL6311.cbl
  9112        MOVE CSUFIXI                TO PI-CERT-SFX
  9113        MOVE CEFFDTI                TO DEEDIT-FIELD
  9114        PERFORM 8600-DEEDIT
  9115        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9116        MOVE '4'                    TO DC-OPTION-CODE
  9117        PERFORM 9700-DATE-LINK
  9118        IF DATE-CONVERSION-ERROR
  9119           MOVE ER-0348            TO EMI-ERROR
  9120           MOVE -1                  TO BEFFDTL
  9121           MOVE AL-UABON            TO BEFFDTA
  9122           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9123           GO TO 8200-SEND-DATAONLY
  9124        ELSE
  9125           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9126           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9127           MOVE XCTL-EL1273        TO PGM-NAME
  9128           GO TO 9300-XCTL.
  9129
  9130     IF EIBAID = DFHPF8
  9131        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9132        MOVE PI-SV-CARRIER          TO PI-CARRIER
  9133        MOVE PI-SV-GROUPING         TO PI-GROUPING
  9134        MOVE PI-SV-STATE            TO PI-STATE
  9135        MOVE ERPNDB-ACCOUNT         TO PI-ACCOUNT
  9136        MOVE CCERTNOI               TO PI-CERT-PRIME
  9137        MOVE CSUFIXI                TO PI-CERT-SFX
  9138        MOVE CEFFDTI                TO DEEDIT-FIELD
  9139        PERFORM 8600-DEEDIT
  9140        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  9141        MOVE '4'                    TO DC-OPTION-CODE
  9142        PERFORM 9700-DATE-LINK
  9143        IF DATE-CONVERSION-ERROR
  9144           MOVE ER-0348             TO EMI-ERROR
  9145           MOVE -1                  TO BEFFDTL
  9146           MOVE AL-UABON            TO BEFFDTA
  9147           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9148           GO TO 8200-SEND-DATAONLY
  9149        ELSE
  9150           MOVE DC-BIN-DATE-1       TO PI-CERT-EFF-DT
  9151           PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9152           IF PI-COMPANY-ID = 'DMD'
  9153               MOVE XCTL-EL401DMD      TO PGM-NAME
  9154             ELSE
  9155               MOVE XCTL-EL1279        TO PGM-NAME
  9156           END-IF
  9157           GO TO 9300-XCTL.
  9158
  9159     IF EIBAID = DFHPF9 AND PI-EDIT-SW = '1'
  9160        MOVE XCTL-EL6312     TO PGM-NAME
  9161
  9162* EXEC CICS XCTL
  9163*           PROGRAM  (PGM-NAME)
  9164*           COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9165*           LENGTH   (WS-COMM-LENGTH)
  9166*       END-EXEC
  9167*    MOVE '.$C                   %   #00009107' TO DFHEIV0
  9168     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9169     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 169
* EL6311.cbl
  9170     MOVE X'2020233030303039313037' TO DFHEIV0(25:11)
  9171     CALL 'kxdfhei1' USING DFHEIV0,
  9172           PGM-NAME,
  9173           PROGRAM-INTERFACE-BLOCK,
  9174           WS-COMM-LENGTH,
  9175           DFHEIV99
  9176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9177     ELSE
  9178        MOVE '0'                 TO  PI-EDIT-SW.
  9179
  9180     IF EIBAID = DFHPF10
  9181         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9182         MOVE PI-PREV-KEY        TO PI-ERPNDB-KEY
  9183         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9184         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9185                                    PI-1042-WA
  9186         MOVE 4                  TO PI-689-DATA-SOURCE
  9187         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9188         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9189         MOVE PI-SV-STATE        TO PI-689-STATE
  9190         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9191         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9192         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9193         MOVE PI-PB-ALT-CHG-SEQ-NO
  9194                                 TO PI-689-ALT-SEQ-NO
  9195         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9196         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9197         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9198         MOVE +0                 TO PI-689-CONTROL
  9199         MOVE LOW-VALUES         TO PI-689-DATE-EDIT
  9200                                    PI-689-EXP-DATE
  9201                                    PI-689-RESP-PERSON
  9202                                    PI-689-TYPE
  9203                                    PI-689-FOLLOW-UP-EDIT
  9204                                    PI-689-RESEND1-EDIT
  9205                                    PI-689-SEQ-EDIT
  9206                                    PI-689-BCSEQ-EDIT
  9207                                    PI-689-LBL-OVERRIDE
  9208         MOVE W-LETTER-COMMUNICATION-AREAS
  9209                                 TO PI-PROGRAM-WORK-AREA
  9210         MOVE XCTL-EL689         TO PGM-NAME
  9211         GO TO 9300-XCTL.
  9212
  9213     IF  EIBAID = DFHPF16
  9214         PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9215         MOVE PI-PREV-ALT-KEY    TO PI-ERPNDB-ALT-KEY
  9216         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  9217                                    PI-1042-WA
  9218         MOVE 4                  TO PI-689-DATA-SOURCE
  9219         MOVE PI-SV-CARRIER      TO PI-689-CARRIER
  9220         MOVE PI-SV-GROUPING     TO PI-689-GROUPING
  9221         MOVE PI-SV-STATE        TO PI-689-STATE
  9222         MOVE PI-PB-ACCOUNT      TO PI-689-ACCOUNT
  9223         MOVE PI-PB-CERT-EFF-DT  TO PI-689-EFF-DATE
  9224         MOVE PI-PB-CERT-NO      TO PI-689-CERT-NO
  9225         MOVE PI-PB-ALT-CHG-SEQ-NO
  9226                                 TO PI-689-ALT-SEQ-NO
  9227         MOVE PI-PB-RECORD-TYPE  TO PI-689-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 170
* EL6311.cbl
  9228         MOVE PI-PREV-BATCH      TO PI-689-ENTRY-BATCH
  9229         MOVE PI-PREV-SEQ-NO     TO PI-689-SEQ-NO
  9230         MOVE PI-PREV-CHG-SEQ-NO TO PI-689-CHG-SEQ-NO
  9231         MOVE W-LETTER-COMMUNICATION-AREAS
  9232                                 TO PI-PROGRAM-WORK-AREA
  9233         MOVE XCTL-EL690         TO PGM-NAME
  9234         GO TO 9300-XCTL.
  9235     IF (EIBAID = DFHPF13)
  9236        if (not fatal-errors)
  9237           and (not unforced-errors)
  9238           MOVE PI-PREV-ALT-KEY  TO ERPNDB-ALT-KEY
  9239           MOVE PI-SV-CARRIER    TO PI-CARRIER
  9240           MOVE PI-SV-GROUPING   TO PI-GROUPING
  9241           MOVE PI-SV-STATE      TO PI-STATE
  9242           MOVE ERPNDB-ACCOUNT   TO PI-ACCOUNT
  9243           MOVE CCERTNOI         TO PI-CERT-PRIME
  9244           MOVE CSUFIXI          TO PI-CERT-SFX
  9245           MOVE CEFFDTI          TO DEEDIT-FIELD
  9246           PERFORM 8600-DEEDIT
  9247           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9248           MOVE '4'              TO DC-OPTION-CODE
  9249           PERFORM 9700-DATE-LINK
  9250           IF DATE-CONVERSION-ERROR
  9251              MOVE ER-0348       TO EMI-ERROR
  9252              MOVE -1            TO CEFFDTL
  9253              MOVE AL-UABON      TO CEFFDTA
  9254              PERFORM 9900-ERROR-FORMAT
  9255                                 THRU 9900-EXIT
  9256              GO TO 8200-SEND-DATAONLY
  9257           ELSE
  9258              MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
  9259              MOVE AL-UANON      TO CEFFDTA
  9260              MOVE DC-BIN-DATE-1 TO PI-CERT-EFF-DT
  9261              PERFORM 6000-CREATE-TEMP-STORAGE
  9262                                 THRU 6000-EXIT
  9263              MOVE XCTL-EL677    TO PGM-NAME
  9264              GO TO 9300-XCTL
  9265           end-if
  9266        else
  9267           MOVE ER-3444          TO EMI-ERROR
  9268           MOVE -1               TO CPFENTRL
  9269           MOVE AL-UNBON         TO CPFENTRA
  9270           PERFORM 9900-ERROR-FORMAT
  9271                                 THRU 9900-EXIT
  9272           GO TO 8200-SEND-DATAONLY
  9273        end-if
  9274     end-if
  9275
  9276     IF EIBAID = DFHPF14
  9277        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9278        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9279        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9280        MOVE PI-SV-STATE            TO PI-CR-STATE
  9281        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9282        MOVE SPACE                  TO PI-EDIT-SW
  9283        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9284        MOVE XCTL-EL650             TO PGM-NAME
  9285        GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 171
* EL6311.cbl
  9286
  9287     IF EIBAID = DFHENTER OR DFHPF11
  9288        GO TO 2000-CANCEL-MAINLINE.
  9289
  9290     MOVE ER-0029                TO EMI-ERROR.
  9291     MOVE -1                     TO CPFENTRL.
  9292     MOVE AL-UNBON               TO CPFENTRA.
  9293     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9294     GO TO 8200-SEND-DATAONLY.
  9295
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 172
* EL6311.cbl
  9297
  9298******************************************************************
  9299*                                                                *
  9300*      BATCH SCREEN PF KEY CHECKING                              *
  9301*                                                                *
  9302******************************************************************
  9303
  9304******************************************************************
  9305*                                                                *
  9306*      PF KEY FUNCTIONS:                                         *
  9307*                                                                *
  9308*      PF1 = BROWSE FORWARD                                      *
  9309*      PF2 = BROWSE BACKWARD                                     *
  9310*      PF3 = DISPLAY PREMIUM TOTALS                              *
  9311*      PF4 = TRANSFER TO ACCOUNT BILLING                         *
  9312*                                                                *
  9313*                                                                *
  9314******************************************************************
  9315
  9316 0500-CHECK-BATCH-PF-KEYS.
  9317     IF EIBAID = DFHPF1
  9318        MOVE '0'                TO PI-EDIT-SW
  9319        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9320           GO TO 5000-BROWSE-BATCH-HEADERS
  9321        ELSE
  9322           IF PI-GOOD-BROWSE
  9323              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9324                 GO TO 4100-BROWSE-PRIMARY-FORWARD
  9325              ELSE
  9326                 IF PI-FILE-BROWSE
  9327                    GO TO 4300-BROWSE-FILE-FORWARD
  9328                 ELSE
  9329                    IF PI-CSR-BROWSE
  9330                       GO TO 4200-BROWSE-CSR-FORWARD
  9331                    ELSE
  9332                       GO TO 4000-BROWSE-DETAIL-FORWARD
  9333           ELSE
  9334              GO TO 0800-BROWSE-ERROR.
  9335
  9336     IF EIBAID = DFHPF2
  9337        MOVE '0'                TO PI-EDIT-SW
  9338        IF ONLY-BATCH-HEADERS  OR ALL-OUT-OF-BAL
  9339           GO TO 5500-BROWSE-BATCH-BACKWARD
  9340        ELSE
  9341           IF PI-GOOD-BROWSE
  9342              IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
  9343                 GO TO 4600-BROWSE-PRIMARY-BACKWARD
  9344              ELSE
  9345                 IF PI-FILE-BROWSE
  9346                    GO TO 4800-BROWSE-FILE-BACKWARD
  9347                 ELSE
  9348                    IF PI-CSR-BROWSE
  9349                       GO TO 4900-BROWSE-CSR-BACKWARD
  9350                    ELSE
  9351                       GO TO 4500-BROWSE-DETAIL-BACKWARD
  9352           ELSE
  9353              GO TO 0800-BROWSE-ERROR.
  9354
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 173
* EL6311.cbl
  9355     IF EIBAID = DFHPF3
  9356        GO TO 3000-BATCH-MAINLINE.
  9357
  9358     IF  EIBAID = DFHPF4
  9359        MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
  9360        MOVE PI-SV-CARRIER          TO PI-CR-CARRIER
  9361        MOVE PI-SV-GROUPING         TO PI-CR-GROUPING
  9362        MOVE PI-SV-STATE            TO PI-CR-STATE
  9363        MOVE ERPNDB-ACCOUNT         TO PI-CR-ACCOUNT
  9364                                       PI-CR-FIN-RESP
  9365        MOVE 'A'                    TO PI-CR-TYPE
  9366        MOVE SPACE                  TO PI-EDIT-SW
  9367        PERFORM 6000-CREATE-TEMP-STORAGE THRU 6000-EXIT
  9368        MOVE XCTL-EL640             TO PGM-NAME
  9369        GO TO 9300-XCTL.
  9370
  9371     IF (ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL)
  9372       AND
  9373        (EIBAID = DFHENTER)
  9374           GO TO 3500-EDIT-BATCH-DATA.
  9375
  9376     IF EIBAID = DFHENTER
  9377        GO TO 3500-EDIT-BATCH-DATA.
  9378
  9379     MOVE ER-0029             TO EMI-ERROR.
  9380     MOVE -1                  TO DPFENTRL.
  9381     MOVE AL-UNBON            TO DPFENTRA.
  9382     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9383     GO TO 8200-SEND-DATAONLY.
  9384
  9385 0800-BROWSE-ERROR.
  9386     MOVE ER-2258                TO EMI-ERROR.
  9387     MOVE -1                     TO DPFENTRL.
  9388     MOVE AL-UNBON               TO DPFENTRA.
  9389     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9390     GO TO 8200-SEND-DATAONLY.
  9391
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 174
* EL6311.cbl
  9393
  9394******************************************************************
  9395*                                                                *
  9396*                I S S U E   M A I N L I N E                     *
  9397*                                                                *
  9398******************************************************************
  9399
  9400 1000-ISSUE-MAINLINE.
  9401     IF PI-DISPLAY-ORIGINAL-BATCH
  9402        IF BMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
  9403           MOVE ER-0023             TO EMI-ERROR
  9404           MOVE -1                  TO BMAINTL
  9405           MOVE AL-UABON            TO BMAINTA
  9406           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9407           GO TO 8200-SEND-DATAONLY
  9408        ELSE
  9409           NEXT SENTENCE
  9410     ELSE
  9411        IF BMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
  9412           MOVE ER-0023             TO EMI-ERROR
  9413           MOVE -1                  TO BMAINTL
  9414           MOVE AL-UABON            TO BMAINTA
  9415           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9416           GO TO 8200-SEND-DATAONLY.
  9417
  9418     IF BMAINTI = 'S'
  9419        GO TO 1100-SHOW-REQUEST.
  9420
  9421     IF NOT MODIFY-CAP
  9422         MOVE 'UPDATE'       TO SM-READ
  9423         PERFORM 9995-SECURITY-VIOLATION
  9424         MOVE ER-0070        TO EMI-ERROR
  9425         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9426         GO TO 8100-SEND-INITIAL-MAP.
  9427
  9428     IF BMAINTL GREATER THAN ZEROS
  9429        IF PI-PF5-FUNCTION
  9430           IF BMAINTI NOT = 'A'
  9431              MOVE AL-UABON  TO BMAINTA
  9432              MOVE -1        TO BMAINTL
  9433              MOVE ER-2260   TO EMI-ERROR
  9434              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9435              GO TO 8200-SEND-DATAONLY.
  9436
  9437     IF BCERTNOL = ZEROS
  9438       AND (BMAINTI = 'C' OR 'K' OR 'D')
  9439         NEXT SENTENCE
  9440     ELSE
  9441         IF BCERTNOL NOT = ZEROS
  9442             MOVE AL-UANON       TO BCERTNOA
  9443         ELSE
  9444             MOVE -1             TO BCERTNOL
  9445             MOVE  1             TO SET-CURSOR-SW
  9446             MOVE ER-2218        TO EMI-ERROR
  9447             MOVE AL-UABON       TO BCERTNOA
  9448             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9449
  9450     IF BSUFIXL NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 175
* EL6311.cbl
  9451         MOVE AL-UANON       TO BSUFIXA
  9452     ELSE
  9453         MOVE AL-SANOF       TO BSUFIXA.
  9454
  9455     IF BEFFDTL = ZEROS AND (BMAINTI = 'C' OR 'K' OR 'D')
  9456        NEXT SENTENCE
  9457     ELSE
  9458        IF BEFFDTL NOT = ZEROS
  9459           MOVE AL-UNNON             TO BEFFDTA
  9460           MOVE BEFFDTI              TO DEEDIT-FIELD
  9461           PERFORM 8600-DEEDIT
  9462           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9463           MOVE 4                    TO DC-OPTION-CODE
  9464           PERFORM 9700-DATE-LINK
  9465           IF NO-CONVERSION-ERROR
  9466              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-EFFDT
  9467              ELSE
  9468              MOVE -1                TO BEFFDTL
  9469              MOVE  1                TO SET-CURSOR-SW
  9470              MOVE ER-2226           TO EMI-ERROR
  9471              MOVE AL-UNBON          TO BEFFDTA
  9472              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9473           ELSE
  9474              MOVE -1                TO BEFFDTL
  9475              MOVE  1                TO SET-CURSOR-SW
  9476              MOVE ER-2220           TO EMI-ERROR
  9477              MOVE AL-UNBON          TO BEFFDTA
  9478              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9479
  9480     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
  9481
  9482     IF BCERTNOL NOT = ZEROS
  9483        MOVE BCERTNOI                TO WS-NEW-PRIME
  9484     ELSE
  9485        MOVE SPACES                  TO WS-NEW-PRIME.
  9486
  9487     IF BSUFIXL NOT = ZEROS
  9488        MOVE BSUFIXI                 TO WS-NEW-SUFFIX
  9489     ELSE
  9490        MOVE SPACE                   TO WS-NEW-SUFFIX.
  9491
  9492     IF BEFFDTL NOT = ZEROS
  9493        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
  9494     ELSE
  9495        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
  9496
  9497     IF BMAINTI = 'A' OR 'K' OR 'S'
  9498        NEXT SENTENCE
  9499     ELSE
  9500        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
  9501        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO      OR
  9502           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT  OR
  9503           WS-PB-RECORD-TYPE NOT = '1'
  9504           IF BMAINTI = 'C'
  9505               MOVE ER-2287          TO EMI-ERROR
  9506               MOVE -1               TO BCERTNOL
  9507               MOVE AL-UABON         TO BCERTNOA BEFFDTA
  9508               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 176
* EL6311.cbl
  9509               GO TO 8200-SEND-DATAONLY
  9510             ELSE
  9511               MOVE ER-2260          TO EMI-ERROR
  9512               MOVE -1               TO BCERTNOL
  9513               MOVE AL-UABON         TO BCERTNOA
  9514               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9515               GO TO 8200-SEND-DATAONLY.
  9516
  9517     IF BMAINTI = 'D'
  9518         GO TO 1400-DELETE-ISSUE-ROUTINE.
  9519
  9520*    IF BMICRNOL  NOT =  ZEROS
  9521*        IF BMICRNOI  NUMERIC
  9522*            MOVE AL-UNNON       TO  BMICRNOA
  9523*        ELSE
  9524*            MOVE -1             TO  BMICRNOL
  9525*            MOVE 1              TO  SET-CURSOR-SW
  9526*            MOVE AL-UNBON       TO  BMICRNOA
  9527*            MOVE ER-2701        TO  EMI-ERROR
  9528*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9529     IF BVINL NOT = ZEROS
  9530        MOVE AL-UANON            TO BVINA
  9531     END-IF
  9532     IF B1STNML NOT = ZEROS
  9533         MOVE AL-UANON                TO B1STNMA.
  9534
  9535     IF BINITL  NOT = ZEROS
  9536        MOVE AL-UANON                TO BINITA.
  9537
  9538     IF BSEXL NOT = ZEROS
  9539        IF BSEXI = 'M' OR 'F'
  9540           MOVE AL-UANON             TO BSEXA
  9541        ELSE
  9542           MOVE -1               TO BSEXL
  9543           MOVE ER-2629          TO EMI-ERROR
  9544           MOVE AL-UABON         TO BSEXA
  9545           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9546
  9547     IF BAGEL NOT = ZEROS
  9548         IF BAGEI NUMERIC
  9549             MOVE BAGEI              TO WS-BAGE
  9550             MOVE AL-UNNON           TO BAGEA
  9551         ELSE
  9552             MOVE -1                 TO BAGEL
  9553             MOVE  1                 TO SET-CURSOR-SW
  9554             MOVE ER-2223            TO EMI-ERROR
  9555             MOVE AL-UNBON           TO BAGEA
  9556             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9557
  9558     IF BLSTNML NOT = ZERO  OR
  9559        B1STNML NOT = ZERO  OR
  9560        BINITL NOT = ZERO
  9561         IF BAGEL = ZEROS
  9562             MOVE -1                 TO BAGEL
  9563             MOVE  1                 TO SET-CURSOR-SW
  9564             MOVE ER-3269            TO EMI-ERROR
  9565             MOVE AL-UNBON           TO BAGEA
  9566             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 177
* EL6311.cbl
  9567         END-IF
  9568     END-IF.
  9569
  9570     MOVE LOW-VALUES             TO WS-CONVERTED-BIRTH
  9571
  9572     IF (BBIRTHL GREATER THAN +0) AND
  9573        (BBIRTHI NOT EQUAL SPACES)
  9574        NEXT SENTENCE
  9575     ELSE
  9576        GO TO 1010-CHECK-AGE.
  9577
  9578     MOVE BBIRTHI                TO DEEDIT-FIELD.
  9579     PERFORM 8600-DEEDIT.
  9580     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  9581     MOVE DC-GREG-DATE-1-MDY     TO WS-SAVE-BIRTH-DATE
  9582     MOVE AL-UNNON               TO BBIRTHA.
  9583     MOVE '4'                    TO DC-OPTION-CODE.
  9584     PERFORM 9700-DATE-LINK.
  9585     IF DATE-CONVERSION-ERROR
  9586        MOVE -1                  TO BBIRTHL
  9587        MOVE  1                  TO SET-CURSOR-SW
  9588        MOVE ER-2228             TO EMI-ERROR
  9589        MOVE AL-UNBON            TO BBIRTHA
  9590        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9591        GO TO 1010-CHECK-AGE.
  9592
  9593     IF (NO-CONVERSION-ERROR) AND
  9594        (DC-BIN-DATE-1 GREATER THAN WS-CONVERTED-EFFDT)
  9595        MOVE DC-BIN-DATE-1       TO WS-WORK-BIN-DT
  9596        SUBTRACT CENTURY-ADJ FROM WS-WORK-BIN-RED
  9597        MOVE WS-WORK-BIN-DT      TO DC-BIN-DATE-1
  9598                                    WS-CONVERTED-BIRTH
  9599        MOVE AL-UANON            TO BBIRTHA
  9600     ELSE
  9601        MOVE DC-BIN-DATE-1       TO WS-CONVERTED-BIRTH
  9602        MOVE AL-UANON            TO BBIRTHA.
  9603
  9604 1010-CHECK-AGE.
  9605
  9606*    IF BAGEL = ZERO
  9607*       IF BBIRTHL GREATER THAN ZERO
  9608*          PERFORM 1095-CALC-AGE THRU 1099-EXIT.
  9609
  9610     IF B1STPMTL NOT = ZEROS
  9611        IF B1STPMTI = SPACES
  9612           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  9613        ELSE
  9614           MOVE B1STPMTI             TO DEEDIT-FIELD
  9615           PERFORM 8600-DEEDIT
  9616           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
  9617           MOVE AL-UNNON             TO B1STPMTA
  9618           MOVE 4                    TO DC-OPTION-CODE
  9619           PERFORM 9700-DATE-LINK
  9620           IF NO-CONVERSION-ERROR
  9621              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  9622              MOVE AL-UANON          TO B1STPMTA
  9623           ELSE
  9624              MOVE -1                TO B1STPMTL
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 178
* EL6311.cbl
  9625              MOVE  1                TO SET-CURSOR-SW
  9626              MOVE ER-2200           TO EMI-ERROR
  9627              MOVE AL-UNBON          TO B1STPMTA
  9628              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9629
  9630     IF BDAYSL NOT = ZEROS
  9631         IF BDAYSI NUMERIC
  9632             MOVE AL-UNNON           TO BDAYSA
  9633         ELSE
  9634             MOVE -1                 TO BDAYSL
  9635             MOVE ER-2530            TO EMI-ERROR
  9636             MOVE AL-UNBON           TO BDAYSA
  9637             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9638
  9639     IF BLNTRML NOT = ZEROS
  9640         IF BLNTRMI NUMERIC
  9641             MOVE AL-UNNON       TO BLNTRMA
  9642         ELSE
  9643             MOVE -1             TO BLNTRML
  9644             MOVE ER-2533        TO EMI-ERROR
  9645             MOVE AL-UNBON       TO BLNTRMA
  9646             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9647
  9648**   IF PI-COMPANY-ID = 'DMD'
  9649     IF PI-COMPANY-ID = 'DMD' OR 'CID' or 'AHL'
  9650        NEXT SENTENCE
  9651     ELSE
  9652         IF BLNOFCRL NOT = ZEROS
  9653            PERFORM 7500-READ-ERLOFC THRU 7599-EXIT
  9654            IF LOAN-OFFICER-FOUND
  9655                MOVE AL-UANON        TO BLNOFCRA
  9656             ELSE
  9657                 MOVE SPACE          TO WS-LOAN-OFFICER
  9658                 MOVE -1             TO BLNOFCRL
  9659                 MOVE  1             TO SET-CURSOR-SW
  9660                 MOVE ER-3006        TO EMI-ERROR
  9661                 MOVE AL-UNBON       TO BLNOFCRA
  9662                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9663
  9664     IF BFREQL NOT = ZEROS
  9665         IF BFREQI NUMERIC
  9666             MOVE AL-UNNON       TO BFREQA
  9667         ELSE
  9668             MOVE -1             TO BFREQL
  9669             MOVE  1             TO SET-CURSOR-SW
  9670             MOVE ER-2223        TO EMI-ERROR
  9671             MOVE AL-UNBON       TO BFREQA
  9672             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9673
  9674     IF BMODEL NOT = ZEROS
  9675         MOVE BMODEI             TO WS-MODE-CODE
  9676                                    PI-BMODE
  9677         IF WS-MODE-CODE-VALID
  9678             MOVE AL-UANON       TO BMODEA
  9679         ELSE
  9680             MOVE -1             TO BMODEL
  9681             MOVE ER-2591        TO EMI-ERROR
  9682             MOVE AL-UABON       TO BMODEA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 179
* EL6311.cbl
  9683             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9684
  9685     IF BPMTSL NOT = ZEROS
  9686         IF BPMTSI NUMERIC
  9687             MOVE AL-UNNON           TO BPMTSA
  9688             MOVE BPMTSI             TO PI-BPMTS
  9689         ELSE
  9690             MOVE -1                 TO BPMTSL
  9691             MOVE ER-2592            TO EMI-ERROR
  9692             MOVE AL-UNBON           TO BPMTSA
  9693             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9694
  9695     IF BPMTAMTL NOT = ZEROS
  9696
  9697* EXEC CICS BIF DEEDIT
  9698*            FIELD  (BPMTAMTI)
  9699*            LENGTH (9)
  9700*       END-EXEC
  9701     MOVE 9
  9702       TO DFHEIV11
  9703*    MOVE '@"L                   #   #00009631' TO DFHEIV0
  9704     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9705     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9706     MOVE X'2020233030303039363331' TO DFHEIV0(25:11)
  9707     CALL 'kxdfhei1' USING DFHEIV0,
  9708           BPMTAMTI,
  9709           DFHEIV11
  9710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9711        MOVE BPMTAMTI           TO PI-BPMTAMT.
  9712*        MOVE BPMTAMTI           TO DEEDIT-FIELD-V2
  9713*        PERFORM 8600-DEEDIT
  9714*        MOVE DEEDIT-FIELD-V2    TO PI-BPMTAMT.
  9715
  9716*    IF BAPRL NOT = ZEROS
  9717*        EXEC CICS BIF DEEDIT
  9718*            FIELD  (BAPRI)
  9719*            LENGTH (7)
  9720*        END-EXEC
  9721*        MOVE BAPRI              TO WS-BAPR.
  9722
  9723     IF BAPRL > 0
  9724        MOVE +0                  TO  WS-BAPR
  9725        PERFORM VARYING WS-SUB FROM +1 BY +1 UNTIL
  9726           (WS-SUB > 7)
  9727           OR (BAPRI (WS-SUB:1) NUMERIC)
  9728           OR (BAPRI (WS-SUB:1) = '.')
  9729        END-PERFORM
  9730        IF WS-SUB > 7
  9731           MOVE ER-2471       TO EMI-ERROR
  9732           MOVE -1            TO BAPRL
  9733           MOVE AL-UNBON      TO BAPRA
  9734           PERFORM 9900-ERROR-FORMAT
  9735                                 THRU 9900-EXIT
  9736        ELSE
  9737           IF BAPRI (WS-SUB:1) NUMERIC
  9738              MOVE WS-SUB           TO WS-BEG
  9739              PERFORM VARYING WS-SUB FROM WS-SUB BY +1 UNTIL
  9740                 (WS-SUB > 7)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 180
* EL6311.cbl
  9741                 OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9742              END-PERFORM
  9743              COMPUTE WS-END = WS-SUB - WS-BEG
  9744              MOVE BAPRI (WS-BEG:WS-END)
  9745                                 TO WS-APR-WHOLE-NUM
  9746           END-IF
  9747           IF BAPRI (WS-SUB:1) = '.'
  9748              COMPUTE WS-BEG = WS-SUB + 1
  9749              IF (WS-BEG < 8)
  9750                 AND (BAPRI (WS-BEG:1) NUMERIC)
  9751                 PERFORM VARYING WS-SUB FROM WS-BEG BY +1 UNTIL
  9752                    (WS-SUB > 7)
  9753                    OR (BAPRI (WS-SUB:1) NOT NUMERIC)
  9754                 END-PERFORM
  9755                 COMPUTE WS-END = WS-SUB - WS-BEG
  9756                 MOVE BAPRI (WS-BEG:WS-END)
  9757                                 TO WS-APR-DEC (1:WS-END)
  9758              END-IF
  9759           END-IF
  9760           MOVE AL-UNNON      TO BAPRA
  9761           MOVE WS-BAPR       TO BAPRO
  9762        END-IF
  9763     END-IF
  9764*     IF BAPRL NOT = ZEROS
  9765*        MOVE BAPRI              TO DEEDIT-FIELD-V4
  9766*        PERFORM 8600-DEEDIT
  9767*        MOVE DEEDIT-FIELD-V4    TO WS-BAPR.
  9768
  9769     IF BLIVESL NOT = ZEROS
  9770        MOVE BLIVESI             TO DEEDIT-FIELD
  9771        PERFORM 8600-DEEDIT
  9772        IF DEEDIT-FIELD-V0 NUMERIC
  9773           MOVE DEEDIT-FIELD-V0  TO WS-BLIVES
  9774           MOVE AL-UNNON         TO BLIVESA
  9775        ELSE
  9776           MOVE -1               TO BLIVESL
  9777           MOVE AL-UNBON         TO BLIVESA
  9778           MOVE ER-2223          TO EMI-ERROR
  9779           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9780
  9781*DMD CUSTOM CODING*************START
  9782*NOTE PI-I-NUM-BILLED IS A FIELD FOR 'DMD' ONLY
  9783     IF PI-COMPANY-ID NOT = 'DMD'
  9784         MOVE ZEROS               TO BBILLEDL
  9785         GO TO 1010-EDIT-CONT.
  9786
  9787     IF BBILLEDL NOT = ZEROS
  9788        MOVE BBILLEDI            TO WS-EDIT-CSO-FIELD
  9789        MOVE 'Y'                 TO WS-NUMERIC-SW
  9790        MOVE +1                  TO WS-CSO-SUB
  9791        PERFORM 1030-EDIT-FOR-NUMERICS THRU 1030-EDIT-EXIT
  9792        IF CSO-NUMERIC-FIELD
  9793
  9794* EXEC CICS BIF DEEDIT
  9795*              FIELD  (BBILLEDI)
  9796*              LENGTH (9)
  9797*          END-EXEC
  9798     MOVE 9
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 181
* EL6311.cbl
  9799       TO DFHEIV11
  9800*    MOVE '@"L                   #   #00009717' TO DFHEIV0
  9801     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9802     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9803     MOVE X'2020233030303039373137' TO DFHEIV0(25:11)
  9804     CALL 'kxdfhei1' USING DFHEIV0,
  9805           BBILLEDI,
  9806           DFHEIV11
  9807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9808           MOVE BBILLEDI         TO WS-BILLED
  9809           MOVE AL-UNNON         TO BBILLEDA
  9810        ELSE
  9811           MOVE -1               TO BBILLEDL
  9812           MOVE AL-UNBON         TO BBILLEDA
  9813           MOVE ER-2547          TO EMI-ERROR
  9814           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9815     ELSE
  9816        IF BMAINTI EQUAL 'A'
  9817           MOVE -1               TO BBILLEDL
  9818           MOVE AL-UNBON         TO BBILLEDA
  9819           MOVE ER-8148          TO EMI-ERROR
  9820           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9821
  9822 1010-EDIT-CONT.
  9823
  9824     IF BFORCEL  NOT = ZEROS
  9825         IF FORCE-CAP
  9826            MOVE AL-UANON            TO BFORCEA
  9827         ELSE
  9828            MOVE ER-2945             TO EMI-ERROR
  9829            MOVE AL-UABON            TO BFORCEA
  9830            MOVE -1                  TO BFORCEL
  9831            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9832
  9833     if (bforcel not = zeros)
  9834        and (bforcei = 'L')
  9835        and (not csr-edit-session)
  9836        and (emi-error <> er-2945)
  9837        MOVE ER-2670             TO EMI-ERROR
  9838        MOVE AL-UABON            TO BFORCEA
  9839        MOVE -1                  TO BFORCEL
  9840        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9841     end-if
  9842     IF BENTRYL NOT = ZEROS
  9843        IF BENTRYI NOT = ' ' AND 'E' AND 'R' AND 'P' AND
  9844                 'C' and 'D' AND 'V' AND 'U' AND 'M'
  9845           MOVE ER-2224              TO EMI-ERROR
  9846           MOVE AL-UABON             TO BENTRYA
  9847           MOVE -1                   TO BENTRYL
  9848           MOVE  1                   TO SET-CURSOR-SW
  9849           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9850        ELSE
  9851           MOVE AL-UANON             TO BENTRYA.
  9852
  9853     IF BUNWRITL NOT = ZEROS
  9854        IF BUNWRITI NOT = ' ' AND 'A' AND 'D' AND 'U' AND 'N'
  9855           MOVE ER-7574              TO EMI-ERROR
  9856           MOVE AL-UABON             TO BUNWRITA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 182
* EL6311.cbl
  9857           MOVE -1                   TO BUNWRITL
  9858           MOVE  1                   TO SET-CURSOR-SW
  9859           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9860        ELSE
  9861           MOVE AL-UANON             TO BUNWRITA.
  9862
  9863     IF BREINL  NOT = ZEROS
  9864         MOVE AL-UANON               TO BREINA.
  9865
  9866     IF BBILCDL NOT = ZEROS
  9867        IF BBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
  9868                             AND 'A' AND 'B' AND 'E'
  9869           MOVE ER-2225              TO EMI-ERROR
  9870           MOVE AL-UABON             TO BBILCDA
  9871           MOVE -1                   TO BBILCDL
  9872           MOVE  1                   TO SET-CURSOR-SW
  9873           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9874        ELSE
  9875           MOVE AL-UANON             TO BBILCDA.
  9876
  9877     IF BSKPCDL NOT = ZEROS
  9878         MOVE AL-UANON               TO BSKPCDA.
  9879
  9880     IF BINDGRPL NOT = ZEROS
  9881         MOVE AL-UANON               TO BINDGRPA.
  9882
  9883     IF BSIGL   NOT = ZEROS
  9884         MOVE AL-UANON               TO BSIGA.
  9885
  9886     IF BRTCLSL NOT = ZEROS
  9887         MOVE AL-UANON               TO BRTCLSA.
  9888
  9889     IF BMEMBERL NOT = ZEROS
  9890         MOVE AL-UANON               TO BMEMBERA.
  9891
  9892     MOVE +0                         TO WS-SUB1.
  9893
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 183
* EL6311.cbl
  9895
  9896******************************************************************
  9897*                                                                *
  9898*           E D I T   I S S U E   C O V E R A G E S              *
  9899*                                                                *
  9900******************************************************************
  9901
  9902 1020-EDIT-COVERAGES.
  9903     ADD +1                      TO WS-SUB1.
  9904
  9905     IF WS-SUB1 GREATER +2
  9906        GO TO 1025-EDIT-CONTINUE
  9907     END-IF
  9908
  9909     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9910       IF (BMODEL   GREATER ZERO  OR
  9911            BPMTSL   GREATER ZERO  OR
  9912            BPMTAMTL GREATER ZERO)
  9913          AND
  9914            BTYPE-LEN (WS-SUB1) GREATER THAN +0
  9915               GO TO 1021-CONT-EDIT.
  9916
  9917     IF BTYPE-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9918        BTERM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9919        BBEN-LEN       (WS-SUB1) GREATER THAN ZEROS OR
  9920        BPREM-LEN      (WS-SUB1) GREATER THAN ZEROS OR
  9921        BCRIT-PERD-LEN (WS-SUB1) GREATER THAN ZEROS OR
  9922        BEXPIRE-LEN    (WS-SUB1) GREATER THAN ZEROS OR
  9923        BALT-PREM-LEN  (WS-SUB1) GREATER THAN ZEROS OR
  9924        BALT-BEN-LEN   (WS-SUB1) GREATER THAN ZEROS
  9925        NEXT SENTENCE
  9926         ELSE
  9927            GO TO 1020-EDIT-COVERAGES.
  9928
  9929 1021-CONT-EDIT.
  9930
  9931     IF BMAINTI = 'A'
  9932        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9933           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  9934        ELSE
  9935           MOVE  -1              TO BTYPE-LEN         (WS-SUB1)
  9936           MOVE ER-7404          TO EMI-ERROR
  9937           MOVE AL-SABON         TO BKIND-ATTRB       (WS-SUB1)
  9938           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9939     ELSE
  9940        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  9941           MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1).
  9942
  9943     IF BTERM-LEN (WS-SUB1) NOT EQUAL +0
  9944        MOVE BTERMI (WS-SUB1)    TO DEEDIT-FIELD
  9945        PERFORM 8600-DEEDIT
  9946        IF DEEDIT-FIELD-V0 NUMERIC
  9947           MOVE DEEDIT-FIELD-V0  TO WS-BTERM (WS-SUB1)
  9948        ELSE
  9949           MOVE ZEROS            TO WS-BTERM (WS-SUB1).
  9950
  9951     IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
  9952*      IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 184
* EL6311.cbl
  9953        IF BMODEL  GREATER THAN ZEROS  AND
  9954           BPMTSL  GREATER THAN ZEROS
  9955           PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9956
  9957     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
  9958         IF BMODEL   GREATER THAN ZEROS  OR
  9959            BPMTSL   GREATER THAN ZEROS  OR
  9960            BPMTAMTL GREATER THAN ZEROS
  9961             PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
  9962
  9963     IF BMAINTI = ('C' OR 'K')
  9964        IF BTERM-LEN (WS-SUB1)  = ZEROS
  9965           NEXT SENTENCE
  9966        ELSE
  9967           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9968           PERFORM 8600-DEEDIT
  9969           IF DEEDIT-FIELD-V0 NUMERIC
  9970              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  9971              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  9972                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  9973              ELSE
  9974                    MOVE ER-2241      TO EMI-ERROR
  9975                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  9976                    MOVE AL-UNBON     TO BTERM-ATTRB (WS-SUB1)
  9977                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9978           ELSE
  9979              MOVE ER-2223          TO EMI-ERROR
  9980              MOVE -1               TO BTERM-LEN     (WS-SUB1)
  9981              MOVE AL-UNBON         TO BTERM-ATTRB   (WS-SUB1)
  9982              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9983     ELSE
  9984        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  9985            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  9986            PERFORM 8600-DEEDIT
  9987            IF DEEDIT-FIELD-V0      NUMERIC
  9988               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  9989                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  9990                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  9991               ELSE
  9992                  MOVE ER-2241         TO EMI-ERROR
  9993                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  9994                  MOVE AL-UNBON        TO BTERM-ATTRB (WS-SUB1)
  9995                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9996            ELSE
  9997              MOVE ER-2223             TO EMI-ERROR
  9998              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  9999              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
 10000              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10001        ELSE
 10002            MOVE ER-2240               TO EMI-ERROR
 10003            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
 10004            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10005*    IF PI-COMPANY-ID NOT = CLIENT-CRI AND CLIENT-LGX
 10006*        IF BMODEL  GREATER THAN ZEROS  AND
 10007*           BPMTSL  GREATER THAN ZEROS
 10008*            PERFORM 6100-TERM-CONVERSION THRU 6199-EXIT.
 10009
 10010     IF BBEN-LEN (WS-SUB1) = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 185
* EL6311.cbl
 10011        AND BMAINTI = ('C' OR 'K')
 10012           NEXT SENTENCE
 10013     ELSE
 10014        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
 10015           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
 10016
 10017* EXEC CICS BIF DEEDIT
 10018*              FIELD  (BBENI (WS-SUB1))
 10019*              LENGTH (12)
 10020*          END-EXEC
 10021     MOVE 12
 10022       TO DFHEIV11
 10023*    MOVE '@"L                   #   #00009929' TO DFHEIV0
 10024     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10025     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10026     MOVE X'2020233030303039393239' TO DFHEIV0(25:11)
 10027     CALL 'kxdfhei1' USING DFHEIV0,
 10028           BBENI(WS-SUB1),
 10029           DFHEIV11
 10030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10031           IF BBENI (WS-SUB1)  NUMERIC
 10032              IF BBENI (WS-SUB1) GREATER THAN ZEROS
 10033                 MOVE BBENI (WS-SUB1) TO WS-BBEN    (WS-SUB1)
 10034*          MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
 10035*          PERFORM 8600-DEEDIT
 10036*          IF DEEDIT-FIELD-V2  NUMERIC
 10037*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10038*                MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
 10039              ELSE
 10040                 MOVE ER-7632    TO EMI-ERROR
 10041                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10042                 MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10043                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10044           ELSE
 10045              MOVE ER-2223         TO EMI-ERROR
 10046              MOVE -1              TO BBEN-LEN   (WS-SUB1)
 10047              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
 10048              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10049        ELSE
 10050           MOVE ER-7632    TO EMI-ERROR
 10051           MOVE -1         TO BBEN-LEN   (WS-SUB1)
 10052           MOVE AL-UNBON   TO BBEN-ATTRB (WS-SUB1)
 10053           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10054
 10055     IF (BPREM-LEN    (WS-SUB1) = ZEROS)
 10056        AND (BMAINTI = ('C' OR 'K'))
 10057        CONTINUE
 10058     ELSE
 10059        IF BPREM-LEN   (WS-SUB1) GREATER THAN ZEROS
 10060           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
 10061           INSPECT BPREM-ALPHA (WS-SUB1) TALLYING WS-TALLY
 10062              FOR ALL '.'
 10063           IF WS-TALLY > 1
 10064              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10065                 BPREM-ALPHA (WS-SUB1) (A1:1) = '.'
 10066              END-PERFORM
 10067              IF A1 < 9
 10068                 ADD 3 TO A1
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 186
* EL6311.cbl
 10069                 MOVE SPACES TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10070              END-IF
 10071           ELSE
 10072              PERFORM VARYING A1 FROM 1 BY 1 UNTIL
 10073                (A1 > 11)
 10074                OR (BPREM-ALPHA (WS-SUB1) (A1:1) =
 10075                  LOW-VALUES OR SPACES)
 10076              END-PERFORM
 10077              IF A1 > 1 AND < 12
 10078                 MOVE SPACES
 10079                           TO BPREM-ALPHA (WS-SUB1) (A1:12 - A1)
 10080              END-IF
 10081           END-IF
 10082
 10083* EXEC CICS BIF DEEDIT
 10084*              FIELD  (BPREMI (WS-SUB1))
 10085*              LENGTH (11)
 10086*          END-EXEC
 10087     MOVE 11
 10088       TO DFHEIV11
 10089*    MOVE '@"L                   #   #00009984' TO DFHEIV0
 10090     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10091     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10092     MOVE X'2020233030303039393834' TO DFHEIV0(25:11)
 10093     CALL 'kxdfhei1' USING DFHEIV0,
 10094           BPREMI(WS-SUB1),
 10095           DFHEIV11
 10096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10097           IF BPREMI (WS-SUB1) NUMERIC
 10098              IF BPREMI (WS-SUB1) GREATER THAN ZEROS
 10099                 MOVE BPREMI (WS-SUB1) TO WS-BPREM   (WS-SUB1)
 10100*          MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
 10101*          PERFORM 8600-DEEDIT
 10102*          IF DEEDIT-FIELD-V2  NUMERIC
 10103*             IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
 10104*                MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
 10105              ELSE
 10106                 IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10107                    MOVE ER-7633    TO EMI-ERROR
 10108                    MOVE -1         TO BPREM-LEN   (WS-SUB1)
 10109                    MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
 10110                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10111                 END-IF
 10112              END-IF
 10113           ELSE
 10114              MOVE ER-2223         TO EMI-ERROR
 10115              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10116              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10117              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10118           END-IF
 10119        ELSE
 10120           IF PI-COMPANY-ID NOT = 'DCC' and 'VPP'
 10121              MOVE ER-7633         TO EMI-ERROR
 10122              MOVE -1              TO BPREM-LEN   (WS-SUB1)
 10123              MOVE AL-UNBON        TO BPREM-ATTRB (WS-SUB1)
 10124              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10125           END-IF
 10126        END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 187
* EL6311.cbl
 10127     END-IF
 10128
 10129     IF BCPREM-LEN   (WS-SUB1) = ZEROS
 10130        NEXT SENTENCE
 10131     ELSE
 10132        MOVE AL-UNNON           TO BCPREM-ATTRB (WS-SUB1)
 10133
 10134* EXEC CICS BIF DEEDIT
 10135*           FIELD  (BCPREMI (WS-SUB1))
 10136*           LENGTH (11)
 10137*       END-EXEC
 10138     MOVE 11
 10139       TO DFHEIV11
 10140*    MOVE '@"L                   #   #00010024' TO DFHEIV0
 10141     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10142     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10143     MOVE X'2020233030303130303234' TO DFHEIV0(25:11)
 10144     CALL 'kxdfhei1' USING DFHEIV0,
 10145           BCPREMI(WS-SUB1),
 10146           DFHEIV11
 10147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10148        IF BCPREMI (WS-SUB1) NUMERIC
 10149           MOVE BCPREMI (WS-SUB1) TO WS-BCPREM  (WS-SUB1)
 10150*       MOVE BCPREMI (WS-SUB1)  TO DEEDIT-FIELD-X11
 10151*       PERFORM 8600-DEEDIT
 10152*       IF DEEDIT-FIELD-V2  NUMERIC
 10153*          MOVE DEEDIT-FIELD-V2 TO WS-BCPREM  (WS-SUB1)
 10154        ELSE
 10155           MOVE ER-2223         TO EMI-ERROR
 10156           MOVE -1              TO BCPREM-LEN   (WS-SUB1)
 10157           MOVE AL-UNBON        TO BCPREM-ATTRB (WS-SUB1)
 10158           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10159
 10160     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10161        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
 10162        PERFORM 8600-DEEDIT
 10163        IF DEEDIT-FIELD-V0 NUMERIC
 10164           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
 10165           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10166         ELSE
 10167           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
 10168           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
 10169           MOVE ER-2223              TO EMI-ERROR
 10170           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10171
 10172     IF BEXPIRE-LEN  (WS-SUB1)    GREATER THAN ZEROS
 10173        IF BEXPIRE   (WS-SUB1) = SPACES
 10174           MOVE LOW-VALUES       TO WS-CONVERTED-EXPIRDT (WS-SUB1)
 10175        ELSE
 10176           MOVE BEXPIRE (WS-SUB1)   TO DEEDIT-FIELD
 10177           PERFORM 8600-DEEDIT
 10178           IF DEEDIT-FIELD-V0        NUMERIC
 10179              MOVE AL-UNNON         TO BEXPIRE-ATTRB (WS-SUB1)
 10180              MOVE 4                TO DC-OPTION-CODE
 10181              MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
 10182              PERFORM 9700-DATE-LINK
 10183              MOVE DC-BIN-DATE-1    TO WS-CONVERTED-EXPIRDT
 10184                                                        (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 188
* EL6311.cbl
 10185              IF NO-CONVERSION-ERROR
 10186                 NEXT SENTENCE
 10187              ELSE
 10188                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
 10189                 MOVE ER-2531    TO EMI-ERROR
 10190                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
 10191                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10192           ELSE
 10193             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
 10194             MOVE ER-2532        TO EMI-ERROR
 10195             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
 10196             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10197
 10198     IF BALT-BEN-LEN   (WS-SUB1)  = ZEROS
 10199        NEXT SENTENCE
 10200     ELSE
 10201
 10202* EXEC CICS BIF DEEDIT
 10203*           FIELD  (BALT-BENI (WS-SUB1))
 10204*           LENGTH (12)
 10205*       END-EXEC
 10206     MOVE 12
 10207       TO DFHEIV11
 10208*    MOVE '@"L                   #   #00010081' TO DFHEIV0
 10209     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10210     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10211     MOVE X'2020233030303130303831' TO DFHEIV0(25:11)
 10212     CALL 'kxdfhei1' USING DFHEIV0,
 10213           BALT-BENI(WS-SUB1),
 10214           DFHEIV11
 10215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10216        IF BALT-BENI (WS-SUB1) NUMERIC
 10217           MOVE BALT-BENI (WS-SUB1) TO WS-BALT-BEN    (WS-SUB1)
 10218*       MOVE BALT-BENI (WS-SUB1) TO DEEDIT-FIELD
 10219*       PERFORM 8600-DEEDIT
 10220*       IF DEEDIT-FIELD-V0 NUMERIC
 10221*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN        (WS-SUB1)
 10222        ELSE
 10223           MOVE ER-2223         TO EMI-ERROR
 10224           MOVE -1              TO BALT-BEN-LEN       (WS-SUB1)
 10225           MOVE AL-UNBON        TO BALT-BEN-ATTRB     (WS-SUB1)
 10226           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10227
 10228     IF BALT-PREM-LEN (WS-SUB1)  = ZEROS
 10229        NEXT SENTENCE
 10230     ELSE
 10231
 10232* EXEC CICS BIF DEEDIT
 10233*           FIELD  (BALT-PREMI (WS-SUB1))
 10234*           LENGTH (11)
 10235*       END-EXEC
 10236     MOVE 11
 10237       TO DFHEIV11
 10238*    MOVE '@"L                   #   #00010100' TO DFHEIV0
 10239     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10240     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10241     MOVE X'2020233030303130313030' TO DFHEIV0(25:11)
 10242     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 189
* EL6311.cbl
 10243           BALT-PREMI(WS-SUB1),
 10244           DFHEIV11
 10245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10246        IF BALT-PREMI (WS-SUB1) NUMERIC
 10247           MOVE BALT-PREMI (WS-SUB1) TO WS-BALT-PREM  (WS-SUB1)
 10248*       MOVE BALT-PREMI    (WS-SUB1)   TO DEEDIT-FIELD
 10249*       PERFORM 8600-DEEDIT
 10250*       IF DEEDIT-FIELD-V0 NUMERIC
 10251*          MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM       (WS-SUB1)
 10252        ELSE
 10253           MOVE ER-2223         TO EMI-ERROR
 10254           MOVE -1              TO BALT-PREM-LEN      (WS-SUB1)
 10255           MOVE AL-UNBON        TO BALT-PREM-ATTRB    (WS-SUB1)
 10256           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10257
 10258      GO TO 1020-EDIT-COVERAGES.
 10259     .
 10260 1025-edit-continue.
 10261     IF PI-COMPANY-ID  =  'DMD'
 10262        MOVE LOW-VALUES             TO BNCERTI
 10263                                       BNSTATI.
 10264
 10265     IF EMI-ERROR = ZEROS
 10266         NEXT SENTENCE
 10267     ELSE
 10268         GO TO 8200-SEND-DATAONLY.
 10269
 10270     IF BMAINTI = 'A'
 10271         GO TO 1200-ADD-ISSUE-ROUTINE.
 10272
 10273     IF BMAINTI = 'C'
 10274         GO TO 1300-CHANGE-ISSUE-ROUTINE.
 10275
 10276     GO TO 2800-REWRITE-ISSUE-CERT-KEY.
 10277
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 190
* EL6311.cbl
 10279
 10280 1030-EDIT-FOR-NUMERICS.
 10281     IF WS-CSO-SUB EQUAL 10
 10282        GO TO 1030-EDIT-EXIT.
 10283
 10284     IF (WS-EDIT-BYTE (WS-CSO-SUB) NUMERIC OR
 10285        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL ',' OR
 10286        WS-EDIT-BYTE (WS-CSO-SUB) EQUAL LOW-VALUES)
 10287           ADD +1               TO WS-CSO-SUB
 10288           GO TO 1030-EDIT-FOR-NUMERICS.
 10289
 10290     MOVE 'N'                   TO WS-NUMERIC-SW.
 10291
 10292 1030-EDIT-EXIT.
 10293******************************************************************
 10294*                                                                *
 10295*                 C A L C U L A T E   A G E                      *
 10296*                                                                *
 10297******************************************************************
 10298
 10299
 10300 1095-CALC-AGE.
 10301
 10302     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
 10303     MOVE WS-CURRENT-BIN-DT  TO DC-BIN-DATE-2.
 10304     MOVE 1                  TO DC-OPTION-CODE.
 10305     PERFORM 9700-DATE-LINK
 10306     IF NO-CONVERSION-ERROR
 10307         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
 10308         MOVE WS-BAGE            TO BAGEI
 10309         MOVE +2                 TO BAGEL
 10310         MOVE AL-UNNON TO BAGEA.
 10311
 10312 1099-EXIT.
 10313     EXIT.
 10314
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 191
* EL6311.cbl
 10316
 10317******************************************************************
 10318*                                                                *
 10319*                   S H O W   I S S U E                          *
 10320*                                                                *
 10321******************************************************************
 10322
 10323 1100-SHOW-REQUEST.
 10324     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 10325
 10326     IF BCERTNOL = ZEROS AND
 10327        BEFFDTL  = ZEROS
 10328        MOVE -1                  TO BMAINTL
 10329        GO TO 8200-SEND-DATAONLY.
 10330
 10331     MOVE BCERTNOI               TO WS-NEW-PRIME.
 10332
 10333     IF BSUFIXL NOT = ZEROS
 10334        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 10335     ELSE
 10336        MOVE SPACE               TO WS-NEW-SUFFIX.
 10337
 10338     MOVE BEFFDTI                TO DEEDIT-FIELD.
 10339     PERFORM 8600-DEEDIT.
 10340     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 10341     MOVE '4'                    TO DC-OPTION-CODE.
 10342     PERFORM 9700-DATE-LINK.
 10343     IF DATE-CONVERSION-ERROR
 10344        MOVE ER-0348             TO EMI-ERROR
 10345        MOVE -1                  TO BEFFDTL
 10346        MOVE AL-UABON            TO BEFFDTA
 10347        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10348        GO TO 8200-SEND-DATAONLY
 10349     ELSE
 10350        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 10351        MOVE AL-UANON            TO BEFFDTA
 10352        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 10353
 10354     MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY
 10355
 10356     IF ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO   OR
 10357        ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT
 10358          MOVE 'Y'                    TO WS-SHOW-SW
 10359          IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 10360             GO TO 4100-BROWSE-PRIMARY-FORWARD
 10361           ELSE
 10362             IF PI-FILE-BROWSE
 10363                GO TO 4300-BROWSE-FILE-FORWARD
 10364              ELSE
 10365                IF PI-CSR-BROWSE
 10366                   GO TO 4200-BROWSE-CSR-FORWARD
 10367                ELSE
 10368                   GO TO 4000-BROWSE-DETAIL-FORWARD
 10369        ELSE
 10370           GO TO 3900-RE-DISPLAY-RECORD.
 10371
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 192
* EL6311.cbl
 10373
 10374******************************************************************
 10375*                                                                *
 10376*            A D D   I S S U E   R O U T I N E                   *
 10377*                                                                *
 10378******************************************************************
 10379
 10380***************************************************************
 10381*     1. GETMAIN FOR PENDING BUSINESS RECORDS.                *
 10382*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 10383*     3. INITIALIZE RECORD WITH INITIAL DATA FROM SCREEN.     *
 10384*     4. LINK TO THE EDIT ROUTINE.                            *
 10385*     5. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 10386*     6. WRITE THE NEW ISSUE RECORD.                          *
 10387*     7. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 10388*     8. IF ANY ERRORS ARE DETECTED, THE ISSUE SCREEN IS      *
 10389*           DISPLAYED WITH ANY ASSOCIATED ERRORS,             *
 10390*        ELSE                                                 *
 10391*           A NEW INITIALIZED SCREEN WILL BE DISPLAYED.       *
 10392***************************************************************
 10393
 10394 1200-ADD-ISSUE-ROUTINE.
 10395     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 10396
 10397
 10398* EXEC CICS GETMAIN
 10399*        SET     (ADDRESS OF PENDING-BUSINESS)
 10400*        LENGTH  (ERPNDB-RECORD-LENGTH)
 10401*    END-EXEC.
 10402*    MOVE '," L                  $   #00010255' TO DFHEIV0
 10403     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 10404     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 10405     MOVE X'2020233030303130323535' TO DFHEIV0(25:11)
 10406     CALL 'kxdfhei1' USING DFHEIV0,
 10407           DFHEIV20,
 10408           ERPNDB-RECORD-LENGTH,
 10409           DFHEIV99
 10410     SET ADDRESS OF PENDING-BUSINESS TO
 10411         DFHEIV20
 10412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10413
 10414
 10415
 10416* EXEC CICS HANDLE CONDITION
 10417*         NOTFND    (1280-BATCH-HDR-NOT-FOUND)
 10418*    END-EXEC.
 10419*    MOVE '"$I                   ! # #00010260' TO DFHEIV0
 10420     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10422     MOVE X'2320233030303130323630' TO DFHEIV0(25:11)
 10423     CALL 'kxdfhei1' USING DFHEIV0
 10424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10425
 10426
 10427     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 10428     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 10429     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 10430
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 193
* EL6311.cbl
 10431
 10432* EXEC CICS READ
 10433*        INTO    (PENDING-BUSINESS)
 10434*        DATASET (FILE-ID-ERPNDB)
 10435*        RIDFLD  (ERPNDB-KEY)
 10436*    END-EXEC.
 10437     MOVE LENGTH OF
 10438      PENDING-BUSINESS
 10439       TO DFHEIV11
 10440*    MOVE '&"IL       E          (   #00010268' TO DFHEIV0
 10441     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 10442     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10443     MOVE X'2020233030303130323638' TO DFHEIV0(25:11)
 10444     CALL 'kxdfhei1' USING DFHEIV0,
 10445           FILE-ID-ERPNDB,
 10446           PENDING-BUSINESS,
 10447           DFHEIV11,
 10448           ERPNDB-KEY,
 10449           DFHEIV99,
 10450           DFHEIV99,
 10451           DFHEIV99
 10452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10453
 10454
 10455     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 10456
 10457     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 10458     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 10459     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 10460     MOVE SPACES                 TO PENDING-BUSINESS.
 10461     MOVE 'PB'                   TO PB-RECORD-ID.
 10462     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 10463     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 10464     MOVE SPACES                 TO PB-CERT-SFX.
 10465     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 10466     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 10467                                    PB-ALT-CHG-SEQ-NO.
 10468
 10469     MOVE BCERTNOI               TO PB-CERT-PRIME.
 10470     MOVE '1'                    TO PB-RECORD-TYPE.
 10471
 10472     IF BSUFIXL NOT = ZEROS
 10473        MOVE BSUFIXI             TO PB-CERT-SFX.
 10474
 10475     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 10476
 10477     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 10478     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 10479
 10480     MOVE ZEROS                  TO PB-I-LOAN-TERM
 10481                                    PB-I-LF-PREM-CALC
 10482                                    PB-I-LF-ALT-PREM-CALC
 10483                                    PB-I-LF-RATE
 10484                                    PB-I-LF-ALT-RATE
 10485                                    PB-I-LF-REI-RATE
 10486                                    PB-I-LF-ALT-REI-RATE
 10487                                    PB-I-RATE-DEV-PCT-LF
 10488                                    PB-I-AH-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 194
* EL6311.cbl
 10489                                    PB-I-AH-RATE
 10490                                    PB-I-AH-REI-RATE
 10491                                    PB-I-AH-RATE-TRM
 10492                                    PB-I-RATE-DEV-PCT-AH
 10493                                    PB-I-BUSINESS-TYPE
 10494                                    PB-I-LIFE-COMMISSION
 10495                                    PB-I-JOINT-COMMISSION
 10496                                    PB-I-JOINT-AGE
 10497                                    PB-I-AH-COMMISSION
 10498                                    PB-I-CURR-SEQ
 10499                                    PB-CHG-COUNT
 10500                                    PB-LF-BILLED-AMTS
 10501                                    PB-AH-BILLED-AMTS
 10502                                    PB-CALC-TOLERANCE
 10503                                    PB-I-EXTENTION-DAYS
 10504*                                   PB-I-MICROFILM-NO
 10505                                    PB-I-TERM-IN-DAYS.
 10506
 10507     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
 10508                                    PB-I-LF-EXPIRE-DT
 10509                                    PB-I-AH-EXPIRE-DT
 10510                                    PB-BILLED-DT
 10511                                    PB-ACCT-EFF-DT
 10512                                    PB-ACCT-EXP-DT
 10513                                    PB-I-1ST-PMT-DT.
 10514
 10515     MOVE 'X'                    TO PB-FATAL-FLAG.
 10516
 10517     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 10518
 10519     IF BLSTNML GREATER THAN ZEROS
 10520         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 10521
 10522*    IF BMICRNOL  GREATER  ZEROS
 10523*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO
 10524*    ELSE
 10525*        MOVE ZEROS              TO  PB-I-MICROFILM-NO.
 10526     IF BVINL > ZEROS
 10527        MOVE BVINI               TO PB-I-VIN
 10528     END-IF
 10529     IF B1STNML GREATER THAN ZEROS
 10530         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 10531
 10532     IF BINITL  GREATER THAN ZEROS
 10533         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 10534
 10535     IF BBIRTHL GREATER THAN ZERO
 10536         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
 10537     ELSE
 10538         MOVE LOW-VALUES         TO PB-I-BIRTHDAY.
 10539
 10540     IF B1STPMTL GREATER THAN ZERO
 10541         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT
 10542     ELSE
 10543         MOVE LOW-VALUES              TO PB-I-1ST-PMT-DT.
 10544
 10545     IF BAGEL    GREATER THAN ZEROS
 10546         MOVE BAGEI              TO PB-I-AGE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 195
* EL6311.cbl
 10547        ELSE
 10548         MOVE ZEROS              TO PB-I-AGE.
 10549
 10550     IF BSEXL    GREATER THAN ZEROS
 10551         MOVE BSEXI              TO PB-I-INSURED-SEX.
 10552
 10553     IF BTERM-LEN (1) GREATER THAN ZEROS
 10554        MOVE WS-BTERM (1)        TO PB-I-LF-TERM
 10555     ELSE
 10556        MOVE ZEROS               TO PB-I-LF-TERM.
 10557
 10558     IF BTERM-LEN (2) GREATER THAN ZEROS
 10559        MOVE WS-BTERM (2)        TO PB-I-AH-TERM
 10560     ELSE
 10561        MOVE ZEROS               TO PB-I-AH-TERM.
 10562
 10563     IF BLNTRML       GREATER THAN ZEROS
 10564         MOVE BLNTRMI            TO PB-I-LOAN-TERM
 10565        ELSE
 10566         MOVE ZEROS              TO PB-I-LOAN-TERM.
 10567
 10568     IF BFREQL        GREATER THAN ZEROS
 10569         MOVE BFREQI             TO PB-I-PAY-FREQUENCY
 10570        ELSE
 10571         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
 10572
 10573     IF BSKPCDL       GREATER THAN ZEROS
 10574         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 10575
 10576     IF BMODEL        GREATER THAN ZEROS
 10577         MOVE BMODEI             TO PB-I-TERM-TYPE
 10578                                    PI-BMODE.
 10579
 10580     IF BPMTSL        GREATER THAN ZEROS
 10581         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 10582                                    PI-BPMTS
 10583        ELSE
 10584         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS
 10585                                    PI-BPMTS.
 10586
 10587     IF BPMTAMTL      GREATER THAN ZEROS
 10588         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT
 10589        ELSE
 10590         MOVE ZEROS              TO PB-I-PAYMENT-AMOUNT.
 10591
 10592     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 10593        IF BTYPE  (1)   NOT = ZEROS
 10594           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 10595                                    PI-BTYPE (1)
 10596           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10597           MOVE SPACES           TO PB-I-LF-ABBR
 10598        ELSE
 10599           MOVE SPACES           TO PB-I-LF-INPUT-CD
 10600                                    PB-I-LF-ABBR
 10601           MOVE ZEROS            TO PB-I-LF-BENEFIT-CD
 10602     ELSE
 10603        MOVE SPACES              TO PB-I-LF-INPUT-CD
 10604                                    PB-I-LF-ABBR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 196
* EL6311.cbl
 10605        MOVE ZEROS               TO PB-I-LF-BENEFIT-CD.
 10606
 10607     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 10608         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
 10609     ELSE
 10610         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
 10611
 10612     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 10613         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
 10614     ELSE
 10615         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
 10616
 10617     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 10618         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 10619            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 10620            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10621         ELSE
 10622            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 10623*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 10624*           MOVE '?'             TO PB-I-LF-CALC-FLAG
 10625         END-IF
 10626     ELSE
 10627         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
 10628
 10629     IF  BCPREM-LEN     (1)  GREATER THAN ZEROS
 10630         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 10631
 10632     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 10633         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 10634         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT
 10635     ELSE
 10636         MOVE ZEROS            TO PB-I-LF-ALT-PREMIUM-AMT.
 10637
 10638     IF  BALT-PREM-LEN     (2) > ZEROS
 10639         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES
 10640     ELSE
 10641         MOVE ZEROS            TO PB-I-TOT-FEES.
 10642
 10643     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
 10644        IF BTYPE      (2)   NOT = ZEROS
 10645           MOVE BTYPE (2)      TO PB-I-AH-INPUT-CD
 10646                                  PI-BTYPE (2)
 10647           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10648           MOVE SPACES         TO PB-I-AH-ABBR
 10649        ELSE
 10650           MOVE SPACES         TO PB-I-AH-INPUT-CD
 10651                                  PB-I-AH-ABBR
 10652           MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
 10653     ELSE
 10654        MOVE SPACES            TO PB-I-AH-INPUT-CD
 10655                                  PB-I-AH-ABBR
 10656        MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
 10657
 10658     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
 10659         MOVE WS-BBEN     (2)  TO PB-I-AH-BENEFIT-AMT
 10660     ELSE
 10661         MOVE ZEROS            TO PB-I-AH-BENEFIT-AMT.
 10662
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 197
* EL6311.cbl
 10663     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 10664         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 10665            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 10666            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10667         ELSE
 10668            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 10669*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 10670*           MOVE '?'             TO PB-I-AH-CALC-FLAG
 10671         END-IF
 10672     ELSE
 10673         MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT.
 10674
 10675     IF  BCPREM-LEN     (2)  GREATER THAN ZEROS
 10676         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 10677
 10678     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 10679        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
 10680     ELSE
 10681        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
 10682
 10683     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 10684        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
 10685     ELSE
 10686        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
 10687
 10688     IF BINDGRPL  GREATER THAN ZEROS
 10689         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 10690
 10691     IF BRTCLSL   GREATER THAN ZEROS
 10692         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 10693
 10694     IF BSIGL     GREATER THAN ZEROS
 10695         MOVE BSIGI              TO PB-I-SIG-SW.
 10696     IF BAPRL > ZEROS
 10697         MOVE WS-BAPR            TO PB-I-LOAN-APR
 10698     ELSE
 10699        if pi-company-id = 'CID'
 10700           move +99.9999         to pb-i-loan-apr
 10701        else
 10702           MOVE ZEROS            TO PB-I-LOAN-APR
 10703        end-if
 10704     end-if
 10705     IF BMEMBERL  GREATER THAN ZEROS
 10706         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 10707
 10708     IF BLNOFCRL  GREATER THAN ZEROS
 10709         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 10710
 10711     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10712        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
 10713     ELSE
 10714        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
 10715
 10716     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10717        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
 10718     ELSE
 10719        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
 10720
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 198
* EL6311.cbl
 10721     IF BDAYSL   GREATER THAN ZEROS
 10722        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 10723                                    PB-I-EXTENTION-DAYS
 10724     ELSE
 10725        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
 10726                                    PB-I-EXTENTION-DAYS.
 10727
 10728     IF BDAYSL GREATER THAN ZEROS
 10729        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 10730
 10731     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 10732        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 10733           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10734
 10735     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 10736        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 10737           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 10738
 10739     IF B1STPMTL GREATER THAN ZEROS
 10740        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 10741
 10742     IF PB-EXT-DAYS-PROCESSING
 10743        IF PB-I-EXTENTION-DAYS = ZEROS
 10744           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10745
 10746     IF PB-EXPIRE-DT-PROCESSING
 10747        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 10748           PB-I-AH-EXPIRE-DT = LOW-VALUES
 10749             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 10750
 10751     IF PB-1ST-PMT-DT-PROCESSING
 10752        IF PB-I-1ST-PMT-DT = LOW-VALUES
 10753           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 10754
 10755     IF BREINL GREATER THAN ZEROS
 10756        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 10757
 10758     IF BENTRYL NOT = ZEROS
 10759        MOVE BENTRYI             TO PB-BATCH-ENTRY
 10760        IF PI-COMPANY-ID = 'CID'
 10761           AND (PB-BATCH-ENTRY = 'P')
 10762           AND (PB-STATE = 'VA')
 10763           PERFORM 1500-UPDATE-ERNOTE
 10764                                 THRU 1500-EXIT
 10765        END-IF
 10766     END-IF
 10767     IF BUNWRITL NOT = ZEROS
 10768        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 10769
 10770     IF BFORCEL NOT = ZEROS
 10771        MOVE BFORCEI             TO PB-FORCE-CODE.
 10772
 10773     IF BBILCDL NOT = ZEROS
 10774        MOVE BBILCDI             TO PB-RECORD-BILL.
 10775
 10776     IF BLIVESL GREATER THAN ZEROS
 10777        MOVE WS-BLIVES           TO PB-I-LIVES
 10778     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 199
* EL6311.cbl
 10779        MOVE ZEROS               TO PB-I-LIVES.
 10780
 10781     IF BBILLEDL GREATER THAN ZEROS
 10782        MOVE WS-BILLED           TO PB-I-NUM-BILLED
 10783     ELSE
 10784        MOVE ZEROS               TO PB-I-NUM-BILLED.
 10785
 10786*    MOVE WS-REFERENCE           TO PB-I-REFERENCE.
 10787
 10788 1260-WRITE-PB-RECORD.
 10789     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10790                                    PB-INPUT-BY.
 10791     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10792     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10793                                    PB-INPUT-DT.
 10794
 10795     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 10796     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 10797                                    PB-CONTROL-BY-ORIG-BATCH.
 10798
 10799
 10800     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 10801     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 10802     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 10803     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 10804     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 10805
 10806     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 10807
 10808     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 10809
 10810     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 10811     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 10812     MOVE PB-SV-STATE            TO PI-SV-STATE.
 10813
 10814     ADD PB-I-LF-PREM-CALC       TO WS-B-LF-ISS-PRM-COMPUTED.
 10815     ADD PB-I-AH-PREM-CALC       TO WS-B-AH-ISS-PRM-COMPUTED.
 10816
 10817 1275-WRITE-PENDING-BUSINESS.
 10818     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10819     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 10820     MOVE 'A'                    TO JP-RECORD-TYPE.
 10821     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10822
 10823
 10824* EXEC CICS HANDLE CONDITION
 10825*        DUPREC (1290-DUPLICATE-ALT-INDEX)
 10826*    END-EXEC.
 10827*    MOVE '"$%                   ! $ #00010642' TO DFHEIV0
 10828     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10829     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10830     MOVE X'2420233030303130363432' TO DFHEIV0(25:11)
 10831     CALL 'kxdfhei1' USING DFHEIV0
 10832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10833
 10834
 10835
 10836* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 200
* EL6311.cbl
 10837*        DATASET (FILE-ID-ERPNDB)
 10838*        FROM    (PENDING-BUSINESS)
 10839*        RIDFLD  (PB-CONTROL-PRIMARY)
 10840*    END-EXEC.
 10841     MOVE LENGTH OF
 10842      PENDING-BUSINESS
 10843       TO DFHEIV11
 10844*    MOVE '&$ L                  ''   #00010646' TO DFHEIV0
 10845     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10846     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10847     MOVE X'2020233030303130363436' TO DFHEIV0(25:11)
 10848     CALL 'kxdfhei1' USING DFHEIV0,
 10849           FILE-ID-ERPNDB,
 10850           PENDING-BUSINESS,
 10851           DFHEIV11,
 10852           PB-CONTROL-PRIMARY,
 10853           DFHEIV99,
 10854           DFHEIV99
 10855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10856
 10857
 10858     ADD +1                      TO  WS-B-ISSUE-CNT-ENTERED.
 10859
 10860     PERFORM 8400-LOG-JOURNAL-RECORD.
 10861
 10862******************************************************************
 10863*       A D D  O R I G I N A L  C E R T  I N F O                 *
 10864******************************************************************
 10865     MOVE ELCERT-KEY             TO ERMAIL-KEY
 10866     MOVE ' '                    TO WS-ERMAIL-SW
 10867
 10868* EXEC CICS READ
 10869*       DATASET   (FILE-ID-ERMAIL)
 10870*       SET       (ADDRESS OF MAILING-DATA)
 10871*       RIDFLD    (ERMAIL-KEY)
 10872*       RESP      (WS-RESPONSE)
 10873*    END-EXEC
 10874*    MOVE '&"S        E          (  N#00010662' TO DFHEIV0
 10875     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10876     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10877     MOVE X'204E233030303130363632' TO DFHEIV0(25:11)
 10878     CALL 'kxdfhei1' USING DFHEIV0,
 10879           FILE-ID-ERMAIL,
 10880           DFHEIV20,
 10881           DFHEIV99,
 10882           ERMAIL-KEY,
 10883           DFHEIV99,
 10884           DFHEIV99,
 10885           DFHEIV99
 10886     SET ADDRESS OF MAILING-DATA TO
 10887         DFHEIV20
 10888     MOVE EIBRESP  TO WS-RESPONSE
 10889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10890     IF RESP-NORMAL
 10891        SET ERMAIL-FOUND TO TRUE
 10892     END-IF
 10893
 10894     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 201
* EL6311.cbl
 10895     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 10896     MOVE 'OC'                   TO OC-RECORD-ID
 10897     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 10898                                 TO OC-CONTROL-PRIMARY (1:33)
 10899     MOVE 'I'                    TO OC-RECORD-TYPE
 10900     MOVE +4096                  TO OC-KEY-SEQ-NO
 10901     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 10902     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 10903     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 10904     MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 10905     MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 10906     MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 10907     MOVE PB-I-AGE               TO OC-INS-AGE
 10908     MOVE PB-I-JOINT-LAST-NAME   TO OC-JNT-LAST-NAME
 10909     MOVE PB-I-JOINT-FIRST-NAME  TO OC-JNT-FIRST-NAME
 10910     MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 10911     MOVE PB-I-JOINT-AGE         TO OC-JNT-AGE
 10912     MOVE PB-I-LF-BENEFIT-CD     TO OC-LF-BENCD
 10913     MOVE PB-I-LF-TERM           TO OC-LF-TERM
 10914     MOVE PB-I-LF-BENEFIT-AMT    TO OC-LF-BEN-AMT
 10915     MOVE PB-I-LF-PREMIUM-AMT    TO OC-LF-PRM-AMT
 10916     MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 10917     MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 10918     MOVE PB-I-LF-EXPIRE-DT      TO OC-LF-EXP-DT
 10919     IF PB-I-JOINT-COMMISSION > +0
 10920         MOVE PB-I-JOINT-COMMISSION TO OC-LF-COMM-PCT
 10921     ELSE
 10922         MOVE PB-I-LIFE-COMMISSION  TO OC-LF-COMM-PCT
 10923     END-IF
 10924     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
 10925     MOVE +0                     TO OC-LF-CANCEL-AMT
 10926                                    OC-LF-ITD-CANCEL-AMT
 10927     MOVE PB-I-AH-BENEFIT-CD     TO OC-AH-BENCD
 10928     MOVE PB-I-AH-TERM           TO OC-AH-TERM
 10929     MOVE PB-I-AH-BENEFIT-AMT    TO OC-AH-BEN-AMT
 10930     MOVE PB-I-AH-PREMIUM-AMT    TO OC-AH-PRM-AMT
 10931     MOVE PB-I-AH-EXPIRE-DT      TO OC-AH-EXP-DT
 10932     MOVE PB-I-AH-COMMISSION     TO OC-AH-COMM-PCT
 10933     MOVE PB-I-AH-CRIT-PER       TO OC-AH-CP
 10934     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
 10935     MOVE +0                     TO OC-AH-CANCEL-AMT
 10936                                    OC-AH-ITD-CANCEL-AMT
 10937     MOVE PB-I-1ST-PMT-DT        TO OC-1ST-PMT-DT
 10938     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
 10939     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
 10940     IF ERMAIL-FOUND
 10941        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 10942     END-IF
 10943     IF NOT CERT-TRL-REC-NOT-FOUND
 10944        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 10945                           OC-INS-AGE-DEFAULT-FLAG
 10946        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 10947                           OC-JNT-AGE-DEFAULT-FLAG
 10948     END-IF
 10949     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 10950     .
 10951 1275-WRITE-ELCRTO.
 10952
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 202
* EL6311.cbl
 10953* EXEC CICS WRITE
 10954*       DATASET   ('ELCRTO')
 10955*       FROM      (ORIGINAL-CERTIFICATE)
 10956*       RIDFLD    (OC-CONTROL-PRIMARY)
 10957*       RESP      (WS-RESPONSE)
 10958*    END-EXEC
 10959     MOVE LENGTH OF
 10960      ORIGINAL-CERTIFICATE
 10961       TO DFHEIV11
 10962     MOVE 'ELCRTO' TO DFHEIV1
 10963*    MOVE '&$ L                  ''  N#00010730' TO DFHEIV0
 10964     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10965     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10966     MOVE X'204E233030303130373330' TO DFHEIV0(25:11)
 10967     CALL 'kxdfhei1' USING DFHEIV0,
 10968           DFHEIV1,
 10969           ORIGINAL-CERTIFICATE,
 10970           DFHEIV11,
 10971           OC-CONTROL-PRIMARY,
 10972           DFHEIV99,
 10973           DFHEIV99
 10974     MOVE EIBRESP  TO WS-RESPONSE
 10975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10976*    display ' just wrote 1275 ' ws-response
 10977     IF RESP-DUPKEY
 10978        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 10979        GO TO 1275-WRITE-ELCRTO
 10980     ELSE
 10981        IF NOT RESP-NORMAL
 10982           MOVE -1               TO BMAINTL
 10983           MOVE ER-7450          TO EMI-ERROR
 10984           PERFORM 9900-ERROR-FORMAT
 10985                                 THRU 9900-EXIT
 10986           GO TO 8200-SEND-DATAONLY
 10987        END-IF
 10988     END-IF
 10989******************************************************************
 10990*       U P D A T E   T H E   B A T C H   H E A D E R            *
 10991******************************************************************
 10992
 10993
 10994* EXEC CICS READ
 10995*        INTO    (PENDING-BUSINESS)
 10996*        DATASET (FILE-ID-ERPNDB)
 10997*        RIDFLD  (ERPNDB-KEY)
 10998*        UPDATE
 10999*    END-EXEC.
 11000     MOVE LENGTH OF
 11001      PENDING-BUSINESS
 11002       TO DFHEIV11
 11003*    MOVE '&"IL       EU         (   #00010753' TO DFHEIV0
 11004     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11005     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11006     MOVE X'2020233030303130373533' TO DFHEIV0(25:11)
 11007     CALL 'kxdfhei1' USING DFHEIV0,
 11008           FILE-ID-ERPNDB,
 11009           PENDING-BUSINESS,
 11010           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 203
* EL6311.cbl
 11011           ERPNDB-KEY,
 11012           DFHEIV99,
 11013           DFHEIV99,
 11014           DFHEIV99
 11015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11016
 11017
 11018     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11019     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11020     MOVE 'B'                    TO JP-RECORD-TYPE.
 11021     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11022
 11023     PERFORM 8400-LOG-JOURNAL-RECORD.
 11024
 11025     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 11026
 11027
 11028* EXEC CICS REWRITE
 11029*        DATASET (FILE-ID-ERPNDB)
 11030*        FROM    (PENDING-BUSINESS)
 11031*    END-EXEC.
 11032     MOVE LENGTH OF
 11033      PENDING-BUSINESS
 11034       TO DFHEIV11
 11035*    MOVE '&& L                  %   #00010769' TO DFHEIV0
 11036     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11037     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11038     MOVE X'2020233030303130373639' TO DFHEIV0(25:11)
 11039     CALL 'kxdfhei1' USING DFHEIV0,
 11040           FILE-ID-ERPNDB,
 11041           PENDING-BUSINESS,
 11042           DFHEIV11,
 11043           DFHEIV99
 11044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11045
 11046
 11047     MOVE 'C'                    TO JP-RECORD-TYPE.
 11048     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11049
 11050     PERFORM 8400-LOG-JOURNAL-RECORD.
 11051
 11052     IF WS-ERRORS-PRESENT
 11053         GO TO 3900-RE-DISPLAY-RECORD.
 11054
 11055     MOVE ZEROS                  TO EMI-ERROR.
 11056     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11057     MOVE LOW-VALUES             TO EL631BI.
 11058     MOVE  -1                    TO BMAINTL.
 11059     GO TO 8100-SEND-INITIAL-MAP.
 11060
 11061 1280-BATCH-HDR-NOT-FOUND.
 11062     MOVE -1                     TO BMAINTL.
 11063     MOVE ER-7450                TO EMI-ERROR.
 11064     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11065     GO TO 8200-SEND-DATAONLY.
 11066
 11067 1290-DUPLICATE-ALT-INDEX.
 11068
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 204
* EL6311.cbl
 11069******************************************************************
 11070*                                                                *
 11071*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 11072*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 11073*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 11074*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 11075*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 11076*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 11077*                                                                *
 11078******************************************************************
 11079
 11080     IF LCP-ONCTR-01 =  0
 11081         ADD 1 TO LCP-ONCTR-01
 11082        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 11083
 11084     ADD +1                      TO WS-SEQ-NO-COUNTER.
 11085
 11086     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 11087         NEXT SENTENCE
 11088     ELSE
 11089         ADD +1 TO PB-BATCH-SEQ-NO
 11090                   PB-CSR-BATCH-SEQ-NO
 11091         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 11092         GO TO 1275-WRITE-PENDING-BUSINESS.
 11093
 11094     MOVE -1                     TO BCERTNOL.
 11095     MOVE AL-UABON               TO BCERTNOA.
 11096     MOVE AL-UNBON               TO BEFFDTA.
 11097
 11098     MOVE 1                      TO EMI-SUB
 11099                                    EMI-SWITCH1
 11100                                    EMI-SWITCH-AREA-1
 11101                                    EMI-SWITCH-AREA-2.
 11102
 11103     MOVE SPACES                 TO EMI-ERROR-LINES.
 11104
 11105
 11106* EXEC CICS SYNCPOINT ROLLBACK
 11107*    END-EXEC.
 11108*    MOVE '6"R                   !   #00010832' TO DFHEIV0
 11109     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 11110     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11111     MOVE X'2020233030303130383332' TO DFHEIV0(25:11)
 11112     CALL 'kxdfhei1' USING DFHEIV0
 11113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11114
 11115
 11116     MOVE ER-2247                TO EMI-ERROR.
 11117     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11118     GO TO 8200-SEND-DATAONLY.
 11119
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 205
* EL6311.cbl
 11121
 11122
 11123 1295-READ-CERT-TRAILER.
 11124
 11125
 11126* EXEC CICS GETMAIN
 11127*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 11128*        LENGTH  (ELCRTT-RECORD-LENGTH)
 11129*        INITIMG (GETMAIN-SPACE)
 11130*    END-EXEC
 11131*    MOVE ',"IL                  $   #00010844' TO DFHEIV0
 11132     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11133     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11134     MOVE X'2020233030303130383434' TO DFHEIV0(25:11)
 11135     CALL 'kxdfhei1' USING DFHEIV0,
 11136           DFHEIV20,
 11137           ELCRTT-RECORD-LENGTH,
 11138           GETMAIN-SPACE
 11139     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 11140         DFHEIV20
 11141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11142
 11143     MOVE +0                     TO  WS-CERT-TRL-REC-NOT-FOUND.
 11144     MOVE ELCERT-KEY             TO  ELCRTT-PRIMARY.
 11145     MOVE 'C'                    TO  ELCRTT-REC-TYPE.
 11146
 11147
 11148* EXEC CICS HANDLE CONDITION
 11149*        NOTFND (1295-CERT-TRL-REC-NOTFND)
 11150*    END-EXEC.
 11151*    MOVE '"$I                   ! % #00010854' TO DFHEIV0
 11152     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11154     MOVE X'2520233030303130383534' TO DFHEIV0(25:11)
 11155     CALL 'kxdfhei1' USING DFHEIV0
 11156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11157
 11158
 11159
 11160* EXEC CICS READ
 11161*        DATASET  (CRTT-ID)
 11162*        RIDFLD   (ELCRTT-KEY)
 11163*        INTO     (CERTIFICATE-TRAILERS)
 11164*    END-EXEC.
 11165     MOVE LENGTH OF
 11166      CERTIFICATE-TRAILERS
 11167       TO DFHEIV11
 11168*    MOVE '&"IL       E          (   #00010858' TO DFHEIV0
 11169     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11170     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11171     MOVE X'2020233030303130383538' TO DFHEIV0(25:11)
 11172     CALL 'kxdfhei1' USING DFHEIV0,
 11173           CRTT-ID,
 11174           CERTIFICATE-TRAILERS,
 11175           DFHEIV11,
 11176           ELCRTT-KEY,
 11177           DFHEIV99,
 11178           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 206
* EL6311.cbl
 11179           DFHEIV99
 11180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11181
 11182
 11183     GO TO 1295-EXIT.
 11184
 11185 1295-CERT-TRL-REC-NOTFND.
 11186     MOVE +1                     TO WS-CERT-TRL-REC-NOT-FOUND.
 11187
 11188 1295-EXIT.
 11189     EXIT.
 11190
 11191******************************************************************
 11192*                                                                *
 11193*          C H A N G E   I S S U E   R O U T I N E               *
 11194*                                                                *
 11195******************************************************************
 11196
 11197***************************************************************
 11198*                                                             *
 11199*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 11200*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 11201*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 11202*              BILLED.  IF IT HAS THEN SAVE A -COPY- OF THE   *
 11203*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 11204*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 11205*     5. LINK TO THE EDIT ROUTINE.                            *
 11206*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 11207*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 11208*              THE EDIT ROUTINE.                              *
 11209*     7. REWRITE THE NEW ISSUE                                *
 11210*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 11211*                                                             *
 11212***************************************************************
 11213
 11214 1300-CHANGE-ISSUE-ROUTINE.
 11215     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 11216
 11217     IF BCHGL NOT = ZEROS
 11218        MOVE ER-2196             TO EMI-ERROR
 11219        MOVE AL-UABON            TO BMAINTA
 11220        MOVE -1                  TO BMAINTL
 11221        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11222        GO TO 8200-SEND-DATAONLY.
 11223
 11224     MOVE BCERTNOI               TO WS-NEW-PRIME.
 11225
 11226     IF BSUFIXL NOT = ZEROS
 11227        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 11228     ELSE
 11229        MOVE SPACE               TO WS-NEW-SUFFIX.
 11230
 11231     MOVE BEFFDTI                TO DEEDIT-FIELD.
 11232     PERFORM 8600-DEEDIT.
 11233     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 11234     MOVE '4'                    TO DC-OPTION-CODE.
 11235     PERFORM 9700-DATE-LINK.
 11236     IF DATE-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 207
* EL6311.cbl
 11237        MOVE ER-0348             TO EMI-ERROR
 11238        MOVE -1                  TO BEFFDTL
 11239        MOVE AL-UABON            TO BEFFDTA
 11240        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11241        GO TO 8200-SEND-DATAONLY
 11242     ELSE
 11243        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 11244        MOVE AL-UANON            TO BEFFDTA
 11245        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 11246
 11247 1325-PROCESS-ISSUE-CHANGES.
 11248
 11249* EXEC CICS HANDLE CONDITION
 11250*         NOTFND    (1380-BATCH-HDR-NOT-FOUND)
 11251*    END-EXEC.
 11252*    MOVE '"$I                   ! & #00010929' TO DFHEIV0
 11253     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11254     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11255     MOVE X'2620233030303130393239' TO DFHEIV0(25:11)
 11256     CALL 'kxdfhei1' USING DFHEIV0
 11257     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11258
 11259
 11260     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 11261     MOVE +9999                   TO ERPNDB-BATCH-SEQ-NO.
 11262     MOVE ZEROS                   TO ERPNDB-BATCH-CHG-SEQ-NO.
 11263
 11264
 11265* EXEC CICS GETMAIN
 11266*        SET      (ADDRESS OF PENDING-BUSINESS)
 11267*        LENGTH   (ERPNDB-RECORD-LENGTH)
 11268*        INITIMG  (GETMAIN-SPACE)
 11269*     END-EXEC.
 11270*    MOVE ',"IL                  $   #00010937' TO DFHEIV0
 11271     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 11272     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11273     MOVE X'2020233030303130393337' TO DFHEIV0(25:11)
 11274     CALL 'kxdfhei1' USING DFHEIV0,
 11275           DFHEIV20,
 11276           ERPNDB-RECORD-LENGTH,
 11277           GETMAIN-SPACE
 11278     SET ADDRESS OF PENDING-BUSINESS TO
 11279         DFHEIV20
 11280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11281
 11282
 11283
 11284* EXEC CICS READ
 11285*        INTO    (PENDING-BUSINESS)
 11286*        DATASET (FILE-ID-ERPNDB)
 11287*        RIDFLD  (ERPNDB-KEY)
 11288*    END-EXEC.
 11289     MOVE LENGTH OF
 11290      PENDING-BUSINESS
 11291       TO DFHEIV11
 11292*    MOVE '&"IL       E          (   #00010943' TO DFHEIV0
 11293     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11294     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 208
* EL6311.cbl
 11295     MOVE X'2020233030303130393433' TO DFHEIV0(25:11)
 11296     CALL 'kxdfhei1' USING DFHEIV0,
 11297           FILE-ID-ERPNDB,
 11298           PENDING-BUSINESS,
 11299           DFHEIV11,
 11300           ERPNDB-KEY,
 11301           DFHEIV99,
 11302           DFHEIV99,
 11303           DFHEIV99
 11304     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11305
 11306
 11307     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 11308
 11309
 11310* EXEC CICS HANDLE CONDITION
 11311*         NOTFND     (1385-REC-NOT-FOUND)
 11312*    END-EXEC.
 11313*    MOVE '"$I                   ! '' #00010951' TO DFHEIV0
 11314     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 11315     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11316     MOVE X'2720233030303130393531' TO DFHEIV0(25:11)
 11317     CALL 'kxdfhei1' USING DFHEIV0
 11318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11319
 11320
 11321**********************************************************
 11322*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 11323*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 11324**********************************************************
 11325
 11326
 11327* EXEC CICS READ
 11328*        DATASET (FILE-ID-ERPNDB)
 11329*        INTO    (PENDING-BUSINESS)
 11330*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11331*    END-EXEC.
 11332     MOVE LENGTH OF
 11333      PENDING-BUSINESS
 11334       TO DFHEIV11
 11335*    MOVE '&"IL       E          (   #00010960' TO DFHEIV0
 11336     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11337     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11338     MOVE X'2020233030303130393630' TO DFHEIV0(25:11)
 11339     CALL 'kxdfhei1' USING DFHEIV0,
 11340           FILE-ID-ERPNDB,
 11341           PENDING-BUSINESS,
 11342           DFHEIV11,
 11343           PI-PREV-CONTROL-PRIMARY,
 11344           DFHEIV99,
 11345           DFHEIV99,
 11346           DFHEIV99
 11347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11348
 11349
 11350********** DO NOT ALLOW CHANGES IF THRU A/R
 11351     IF BMAINTI = 'C'
 11352         IF PB-EL860-INTERNAL-PROCESS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 209
* EL6311.cbl
 11353             MOVE ER-4005          TO EMI-ERROR
 11354             MOVE -1               TO BMAINTL
 11355             MOVE AL-UABON         TO BMAINTA
 11356             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11357             GO TO 8200-SEND-DATAONLY.
 11358**********
 11359
 11360     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 11361        MOVE -1                 TO BMAINTL
 11362        MOVE ER-2197            TO EMI-ERROR
 11363        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11364        GO TO 8200-SEND-DATAONLY.
 11365
 11366     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 11367        MOVE ER-2196             TO EMI-ERROR
 11368        MOVE AL-UABON            TO BMAINTA
 11369        MOVE -1                  TO BMAINTL
 11370        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11371        GO TO 8200-SEND-DATAONLY.
 11372
 11373     MOVE ZEROS                  TO WS-SEQ-SAVE.
 11374
 11375     IF PB-BILLED-DT = LOW-VALUES AND
 11376        PB-CHG-COUNT = ZEROS
 11377        NEXT SENTENCE
 11378     ELSE
 11379        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11380            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11381           OR
 11382           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11383            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11384           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 11385     move zeros                  to ws-check-amts
 11386     move ' '                    to ws-stop-sw
 11387                                    ws-check-sw
 11388                                    ws-proc-check-sw
 11389                                    ws-any-check-sw
 11390                                    ws-chek-browse-sw
 11391
 11392     perform 2500-browse-checks  thru 2500-exit
 11393
 11394     if i-have-processed-checks
 11395        or i-have-checks
 11396        continue
 11397     else
 11398        go to 1330-continue
 11399     end-if
 11400
 11401     compute ws-tot-orig-prem =
 11402        pb-i-lf-premium-amt + pb-i-ah-premium-amt +
 11403        pb-i-lf-alt-premium-amt
 11404
 11405     if bprem1l <> zeros
 11406        MOVE AL-UNNON            TO bprem1a
 11407        move ws-bprem (1)        to ws-new-iss-total
 11408     else
 11409        move pb-i-lf-premium-amt to ws-new-iss-total
 11410     end-if
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 210
* EL6311.cbl
 11411     display ' new iss totala ' ws-new-iss-total
 11412
 11413     if baltpr1l <> zeros
 11414        MOVE AL-UNNON            TO baltpr1a
 11415        compute ws-new-iss-total =
 11416           ws-new-iss-total + ws-balt-prem(1)
 11417     else
 11418        compute ws-new-iss-total =
 11419           ws-new-iss-total + pb-i-lf-alt-premium-amt
 11420     end-if
 11421
 11422     if bprem2l <> zeros
 11423        MOVE AL-UNNON            TO bprem2a
 11424        compute ws-new-iss-total = ws-new-iss-total +
 11425           ws-bprem (2)
 11426     else
 11427        compute ws-new-iss-total = ws-new-iss-total +
 11428           pb-i-ah-premium-amt
 11429     end-if
 11430
 11431     if (ws-new-iss-total + ws-check-amts) = ws-tot-orig-prem
 11432        if ((bprem1l <> zeros)
 11433           and (ws-bprem (1) <> pb-i-lf-premium-amt))
 11434                      or
 11435           ((bprem2l <> zeros)
 11436           and (ws-bprem (2) <> pb-i-ah-premium-amt))
 11437           move er-3456          to emi-error
 11438           perform 9900-error-format
 11439                                 thru 9900-exit
 11440           go to 1330-continue
 11441        end-if
 11442     end-if
 11443
 11444     if ws-new-iss-total > ws-tot-orig-prem
 11445        move er-3458             to emi-error
 11446        perform 9900-error-format thru 9900-exit
 11447        move al-uabon            to bmainta
 11448        move -1                  to bmaintl
 11449        go to 8200-send-dataonly
 11450     end-if
 11451
 11452     if ws-new-iss-total < ws-tot-orig-prem
 11453        move er-3457             to emi-error
 11454        move al-uabon            to bprem1a
 11455                                    bprem2a
 11456        move +0 to bprem1l bprem2l
 11457        perform 9900-error-format thru 9900-exit
 11458        move -1                  to bmaintl
 11459        go to 1330-continue
 11460     end-if
 11461
 11462     .
 11463 1330-continue.
 11464
 11465
 11466* EXEC CICS READ
 11467*        DATASET (FILE-ID-ERPNDB)
 11468*        INTO    (PENDING-BUSINESS)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 211
* EL6311.cbl
 11469*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 11470*        UPDATE
 11471*    END-EXEC.
 11472     MOVE LENGTH OF
 11473      PENDING-BUSINESS
 11474       TO DFHEIV11
 11475*    MOVE '&"IL       EU         (   #00011081' TO DFHEIV0
 11476     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11477     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11478     MOVE X'2020233030303131303831' TO DFHEIV0(25:11)
 11479     CALL 'kxdfhei1' USING DFHEIV0,
 11480           FILE-ID-ERPNDB,
 11481           PENDING-BUSINESS,
 11482           DFHEIV11,
 11483           PI-PREV-CONTROL-PRIMARY,
 11484           DFHEIV99,
 11485           DFHEIV99,
 11486           DFHEIV99
 11487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11488
 11489
 11490     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11491     MOVE 'B'                    TO JP-RECORD-TYPE
 11492     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11493     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11494
 11495     PERFORM 8400-LOG-JOURNAL-RECORD.
 11496
 11497     IF PB-BILLED-DT NOT = LOW-VALUES OR
 11498        PB-CHG-COUNT NOT = ZEROS
 11499        IF (BPREM-LEN (1) GREATER THAN ZEROS AND
 11500            WS-BPREM  (1) NOT = PB-I-LF-PREMIUM-AMT)
 11501           OR
 11502           (BPREM-LEN (2) GREATER THAN ZEROS AND
 11503            WS-BPREM  (2) NOT = PB-I-AH-PREMIUM-AMT)
 11504            MOVE LOW-VALUES             TO PB-BILLED-DT
 11505            ADD +1                      TO PB-CHG-COUNT.
 11506
 11507     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11508     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 11509     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 11510     MOVE '5'                    TO DC-OPTION-CODE.
 11511     PERFORM 9700-DATE-LINK
 11512     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 11513
 11514*    IF BMICRNOL  GREATER  ZEROS
 11515*        MOVE BMICRNOI           TO  PB-I-MICROFILM-NO.
 11516
 11517     IF BVINL > ZEROS
 11518        MOVE BVINI               TO PB-I-VIN
 11519     END-IF
 11520     IF (BFORCEL NOT = ZEROS)
 11521        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11522        AND (BFORCEI = ' ')
 11523        AND (PB-FORCE-CODE = 'O')
 11524        COMPUTE PB-I-AH-PREMIUM-AMT =
 11525           PB-I-DCC-OVER-CHG-AMT + PB-I-AH-PREM-CALC
 11526        PERFORM 1800-REMOVE-CERT-NOTES
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 212
* EL6311.cbl
 11527                                 THRU 1800-EXIT
 11528        PERFORM 1900-DELETE-ERPYAJ
 11529                                 THRU 1900-EXIT
 11530        MOVE +0                  TO PB-I-DCC-OVER-CHG-AMT
 11531     END-IF
 11532     IF (BFORCEL NOT = ZEROS)
 11533        AND (PB-COMPANY-ID = 'DCC' or 'VPP')
 11534        AND (BFORCEI = 'O')
 11535        AND (PB-FORCE-CODE NOT = 'O')
 11536        COMPUTE WS-OC-AMT = PB-I-AH-PREMIUM-AMT -
 11537           PB-I-AH-PREM-CALC
 11538        MOVE WS-CURRENT-BIN-DT   TO DC-BIN-DATE-1
 11539        MOVE SPACE               TO DC-OPTION-CODE
 11540        PERFORM 9700-DATE-LINK
 11541        MOVE DC-GREG-DATE-A-EDIT TO WS-OC-DATE
 11542        MOVE WS-OC-AMT           TO PB-I-DCC-OVER-CHG-AMT
 11543        MOVE PB-I-AH-PREM-CALC   TO PB-I-AH-PREMIUM-AMT
 11544        MOVE WS-OC-AMT           TO WS-OC-DIS-AMT
 11545        PERFORM 1500-UPDATE-ERNOTE
 11546                                 THRU 1500-EXIT
 11547        PERFORM 1600-UPDATE-ERPYAJ
 11548                                 THRU 1600-EXIT
 11549     END-IF
 11550     IF BLSTNML  GREATER THAN ZEROS
 11551         MOVE BLSTNMI            TO PB-I-INSURED-LAST-NAME.
 11552
 11553     IF B1STNML  GREATER THAN ZEROS
 11554         MOVE B1STNMI            TO PB-I-INSURED-FIRST-NAME.
 11555
 11556     IF BINITL   GREATER THAN ZEROS
 11557         MOVE BINITI             TO PB-I-INSURED-MIDDLE-INIT.
 11558
 11559     IF BBIRTHL  GREATER THAN ZERO
 11560         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
 11561
 11562     IF B1STPMTL GREATER THAN ZERO
 11563         MOVE WS-CONVERTED-1ST-PMT-DT TO PB-I-1ST-PMT-DT.
 11564
 11565     IF BAGEL    GREATER THAN ZEROS
 11566         MOVE BAGEI              TO PB-I-AGE.
 11567
 11568     MOVE 'N'                    TO WS-INS-AGE-SET
 11569                                    WS-JNT-AGE-SET.
 11570     IF BAGEL    GREATER THAN ZEROS
 11571        MOVE 'Y'                TO WS-INS-AGE-SET
 11572        IF BAGEI = ZERO AND
 11573             (PB-I-BIRTHDAY = LOW-VALUES OR SPACES)
 11574           MOVE 'Y'             TO WS-INS-AGE-DEFAULTED
 11575           MOVE 'AGE*'          TO BAGEDEFO
 11576        ELSE
 11577           MOVE 'N'             TO WS-INS-AGE-DEFAULTED
 11578           MOVE 'AGE '          TO BAGEDEFO
 11579        END-IF
 11580        PERFORM 1386-UPDATE-AGE-FLAGS THRU 1386-EXIT
 11581     END-IF.
 11582
 11583     IF BSEXL    GREATER THAN ZEROS
 11584         MOVE BSEXI              TO PB-I-INSURED-SEX.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 213
* EL6311.cbl
 11585
 11586     IF BTERM-LEN (1)   GREATER THAN ZEROS
 11587        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
 11588
 11589     IF BTERM-LEN (2)   GREATER THAN ZEROS
 11590        MOVE WS-BTERM (2)        TO PB-I-AH-TERM.
 11591
 11592     IF BLNTRML  GREATER THAN ZEROS
 11593         MOVE BLNTRMI            TO PB-I-LOAN-TERM.
 11594
 11595     IF BFREQL   GREATER THAN ZEROS
 11596         MOVE BFREQI             TO PB-I-PAY-FREQUENCY.
 11597
 11598     IF BSKPCDL  GREATER THAN ZEROS
 11599         MOVE BSKPCDI            TO PB-I-SKIP-CODE.
 11600
 11601     IF BMODEL   GREATER THAN ZEROS
 11602         MOVE BMODEI             TO PB-I-TERM-TYPE
 11603                                    PI-BMODE.
 11604
 11605     IF BPMTSL   GREATER THAN ZEROS
 11606         MOVE BPMTSI             TO PB-I-NO-OF-PAYMENTS
 11607                                    PI-BPMTS.
 11608
 11609     IF BPMTAMTL GREATER THAN ZEROS
 11610         MOVE PI-BPMTAMT         TO PB-I-PAYMENT-AMOUNT.
 11611
 11612     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
 11613         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
 11614
 11615     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
 11616         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT.
 11617
 11618     MOVE SPACE TO PB-I-LF-CALC-FLAG.
 11619
 11620     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
 11621         IF WS-BPREM   (1)  NOT = WS-ALL-NINES
 11622            SUBTRACT PB-I-LF-PREMIUM-AMT
 11623                     FROM WS-B-LF-ISS-PRM-ENTERED
 11624            ADD  WS-BPREM (1)    TO WS-B-LF-ISS-PRM-ENTERED
 11625            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11626            MOVE SPACE           TO PB-I-LF-CALC-FLAG
 11627         ELSE
 11628            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
 11629*           MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
 11630*           MOVE '?'             TO PB-I-LF-CALC-FLAG.
 11631         END-IF
 11632     END-IF.
 11633
 11634     IF  BALT-PREM-LEN     (1)  GREATER THAN ZEROS
 11635            SUBTRACT PB-I-LF-ALT-PREMIUM-AMT
 11636                     FROM WS-B-LF-ISS-PRM-ENTERED
 11637         ADD  WS-BALT-PREM (1) TO WS-B-LF-ISS-PRM-ENTERED
 11638         MOVE WS-BALT-PREM (1) TO PB-I-LF-ALT-PREMIUM-AMT.
 11639
 11640     IF  BALT-PREM-LEN     (2)  > ZEROS
 11641         MOVE WS-BALT-PREM (2) TO PB-I-TOT-FEES.
 11642
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 214
* EL6311.cbl
 11643     IF  BBEN-LEN (2)  GREATER THAN ZEROS
 11644         MOVE WS-BBEN (2)  TO PB-I-AH-BENEFIT-AMT.
 11645
 11646     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
 11647         IF WS-BPREM   (2)  NOT = WS-ALL-NINES
 11648            SUBTRACT PB-I-AH-PREMIUM-AMT
 11649                     FROM WS-B-AH-ISS-PRM-ENTERED
 11650            ADD  WS-BPREM (2)    TO WS-B-AH-ISS-PRM-ENTERED
 11651            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11652            MOVE SPACE           TO PB-I-AH-CALC-FLAG
 11653         ELSE
 11654            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
 11655*           MOVE ZEROS           TO PB-I-AH-PREMIUM-AMT
 11656*           MOVE '?'             TO PB-I-AH-CALC-FLAG.
 11657         END-IF
 11658     END-IF
 11659
 11660     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
 11661        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
 11662
 11663     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
 11664        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
 11665
 11666     IF BINDGRPL            GREATER THAN ZEROS
 11667         MOVE BINDGRPI           TO PB-I-INDV-GRP-OVRD.
 11668
 11669     IF BRTCLSL             GREATER THAN ZEROS
 11670         MOVE BRTCLSI            TO PB-I-RATE-CLASS-OVRD.
 11671
 11672     IF BSIGL               GREATER THAN ZEROS
 11673         MOVE BSIGI              TO PB-I-SIG-SW.
 11674
 11675     IF BAPRL               GREATER THAN ZEROS
 11676         MOVE WS-BAPR            TO PB-I-LOAN-APR.
 11677
 11678     IF BMEMBERL            GREATER THAN ZEROS
 11679         MOVE BMEMBERI       TO PB-I-MEMBER-NO.
 11680
 11681     IF BLNOFCRL            GREATER THAN ZEROS
 11682         MOVE BLNOFCRI           TO PB-I-LOAN-OFFICER.
 11683
 11684     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11685        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
 11686
 11687     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11688        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
 11689
 11690     IF BDAYSL              GREATER THAN ZEROS
 11691        MOVE BDAYSI              TO PB-I-TERM-IN-DAYS
 11692                                    PB-I-EXTENTION-DAYS.
 11693
 11694     IF BDAYSL GREATER THAN ZEROS
 11695        MOVE '2'                 TO PB-I-DATA-ENTRY-SW.
 11696
 11697     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
 11698        IF WS-CONVERTED-EXPIRDT   (1) GREATER THAN LOW-VALUES
 11699           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11700
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 215
* EL6311.cbl
 11701     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
 11702        IF WS-CONVERTED-EXPIRDT   (2) GREATER THAN LOW-VALUES
 11703           MOVE '3'              TO PB-I-DATA-ENTRY-SW.
 11704
 11705     IF B1STPMTL GREATER THAN ZEROS
 11706        MOVE '4'                 TO PB-I-DATA-ENTRY-SW.
 11707
 11708     IF PB-EXT-DAYS-PROCESSING
 11709        IF PB-I-EXTENTION-DAYS = ZEROS
 11710           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11711
 11712     IF PB-EXPIRE-DT-PROCESSING
 11713        IF PB-I-LF-EXPIRE-DT = LOW-VALUES AND
 11714           PB-I-AH-EXPIRE-DT = LOW-VALUES
 11715             MOVE '1'            TO PB-I-DATA-ENTRY-SW.
 11716
 11717     IF PB-1ST-PMT-DT-PROCESSING
 11718        IF PB-I-1ST-PMT-DT = LOW-VALUES
 11719           MOVE '1'              TO PB-I-DATA-ENTRY-SW.
 11720
 11721     IF BREINL GREATER THAN ZEROS
 11722        MOVE BREINI              TO PB-I-SPECIAL-REIN-CODE.
 11723
 11724     IF BFORCEL NOT = ZEROS
 11725        MOVE BFORCEI             TO PB-FORCE-CODE.
 11726     IF (BENTRYL NOT = ZEROS)
 11727        AND (PB-COMPANY-ID = 'CID')
 11728        AND (PB-STATE = 'VA')
 11729        AND (BENTRYI NOT = 'P')
 11730        AND (PB-BATCH-ENTRY = 'P')
 11731        PERFORM 1800-REMOVE-CERT-NOTES
 11732                                 THRU 1800-EXIT
 11733     END-IF
 11734     IF BENTRYL NOT = ZEROS
 11735        MOVE BENTRYI             TO PB-BATCH-ENTRY
 11736        IF PI-COMPANY-ID = 'CID'
 11737           AND (PB-BATCH-ENTRY = 'P')
 11738           AND (PB-STATE = 'VA')
 11739           PERFORM 1500-UPDATE-ERNOTE
 11740                                 THRU 1500-EXIT
 11741        END-IF
 11742     END-IF
 11743
 11744     IF BUNWRITL NOT = ZEROS
 11745        MOVE BUNWRITI            TO PB-I-UNDERWRITING-STATUS.
 11746
 11747     IF BBILCDL NOT = ZEROS
 11748        MOVE BBILCDI             TO PB-RECORD-BILL.
 11749
 11750     IF BLIVESL GREATER THAN ZEROS
 11751        MOVE WS-BLIVES           TO PB-I-LIVES.
 11752
 11753
 11754*DMD CUSTOM CODING*************START
 11755     IF PI-COMPANY-ID NOT = 'DMD'
 11756         MOVE ZEROS               TO BBILLEDL.
 11757*DMD CUSTOM CODING*************END
 11758
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 216
* EL6311.cbl
 11759     IF BBILLEDL GREATER THAN ZEROS
 11760        MOVE WS-BILLED           TO PB-I-NUM-BILLED.
 11761
 11762
 11763*****************************************************************
 11764*        IF BTYPE = ZEROS OR SPACES DELETE COVERAGE             *
 11765*****************************************************************
 11766
 11767     IF BTYPE-LEN (1)   GREATER THAN ZEROS
 11768        IF BTYPE  (1)   = ZEROS OR SPACES
 11769           IF REMOVE-LF-COVERAGE
 11770               MOVE SPACES           TO PB-I-LF-INPUT-CD
 11771                                        PI-BTYPE (1)
 11772               SUBTRACT PB-I-LF-PREMIUM-AMT FROM
 11773                                        WS-B-LF-ISS-PRM-ENTERED
 11774               SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 11775                                        WS-B-LF-ISS-PRM-ENTERED
 11776               SUBTRACT PB-I-LF-PREM-CALC FROM
 11777                                        WS-B-LF-ISS-PRM-COMPUTED
 11778               MOVE ZEROS            TO PB-I-LF-TERM
 11779                                        PB-I-LF-BENEFIT-AMT
 11780                                        PB-I-LF-PREMIUM-AMT
 11781                                        PB-I-LF-BENEFIT-CD
 11782                                        PB-I-LF-PREM-CALC
 11783                                        PB-I-LF-CRIT-PER
 11784                                        PB-I-LF-ALT-BENEFIT-AMT
 11785                                        PB-I-LF-ALT-PREMIUM-AMT
 11786               MOVE LOW-VALUES       TO PB-I-LF-EXPIRE-DT
 11787           ELSE
 11788               NEXT SENTENCE
 11789        ELSE
 11790           MOVE BTYPE (1)        TO PB-I-LF-INPUT-CD
 11791                                    PI-BTYPE (1).
 11792     IF BTYPE-LEN (2)   GREATER THAN ZEROS
 11793        IF BTYPE  (2)   = ZEROS OR SPACES
 11794           IF  REMOVE-AH-COVERAGE
 11795               MOVE SPACES           TO PB-I-AH-INPUT-CD
 11796                                        PI-BTYPE (2)
 11797               SUBTRACT PB-I-AH-PREMIUM-AMT FROM
 11798                                        WS-B-AH-ISS-PRM-ENTERED
 11799               SUBTRACT PB-I-AH-PREM-CALC FROM
 11800                                        WS-B-AH-ISS-PRM-COMPUTED
 11801               MOVE ZEROS            TO PB-I-AH-TERM
 11802                                        PB-I-AH-BENEFIT-AMT
 11803                                        PB-I-AH-PREMIUM-AMT
 11804                                        PB-I-AH-BENEFIT-CD
 11805                                        PB-I-AH-PREM-CALC
 11806                                        PB-I-AH-CRIT-PER
 11807               MOVE LOW-VALUES       TO PB-I-AH-EXPIRE-DT
 11808           ELSE
 11809               NEXT SENTENCE
 11810        ELSE
 11811           MOVE BTYPE (2)        TO PB-I-AH-INPUT-CD
 11812                                    PI-BTYPE (2).
 11813 1360-REWRITE-PB-RECORD.
 11814     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 11815
 11816     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 217
* EL6311.cbl
 11817     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 11818
 11819     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 11820
 11821     SUBTRACT PB-I-LF-PREM-CALC  FROM WS-B-LF-ISS-PRM-COMPUTED.
 11822     SUBTRACT PB-I-AH-PREM-CALC  FROM WS-B-AH-ISS-PRM-COMPUTED.
 11823
 11824     IF BCPREM-LEN (1)  GREATER THAN ZEROS
 11825         MOVE WS-BCPREM (1)      TO PB-I-LF-PREM-CALC.
 11826
 11827     IF BCPREM-LEN (2)  GREATER THAN ZEROS
 11828         MOVE WS-BCPREM (2)      TO PB-I-AH-PREM-CALC.
 11829
 11830     PERFORM 1390-UPDATE-ERPNDM THRU 1399-EXIT.
 11831
 11832     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 11833
 11834     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 11835
 11836     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 11837     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 11838     MOVE PB-SV-STATE            TO PI-SV-STATE.
 11839
 11840     ADD  PB-I-LF-PREM-CALC      TO WS-B-LF-ISS-PRM-COMPUTED.
 11841     ADD  PB-I-AH-PREM-CALC      TO WS-B-AH-ISS-PRM-COMPUTED.
 11842
 11843 1375-REWRITE-PB-RECORD.
 11844     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 11845     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 11846     MOVE 'C'                    TO JP-RECORD-TYPE.
 11847     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 11848
 11849
 11850* EXEC CICS REWRITE
 11851*        DATASET (FILE-ID-ERPNDB)
 11852*        FROM    (PENDING-BUSINESS)
 11853*    END-EXEC.
 11854     MOVE LENGTH OF
 11855      PENDING-BUSINESS
 11856       TO DFHEIV11
 11857*    MOVE '&& L                  %   #00011447' TO DFHEIV0
 11858     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11859     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11860     MOVE X'2020233030303131343437' TO DFHEIV0(25:11)
 11861     CALL 'kxdfhei1' USING DFHEIV0,
 11862           FILE-ID-ERPNDB,
 11863           PENDING-BUSINESS,
 11864           DFHEIV11,
 11865           DFHEIV99
 11866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11867
 11868
 11869     PERFORM 8400-LOG-JOURNAL-RECORD.
 11870******************************************************************
 11871*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 11872******************************************************************
 11873     MOVE ELCERT-KEY             TO ERMAIL-KEY
 11874     MOVE ' '                    TO WS-ERMAIL-SW
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 218
* EL6311.cbl
 11875
 11876* EXEC CICS READ
 11877*       DATASET   (FILE-ID-ERMAIL)
 11878*       SET       (ADDRESS OF MAILING-DATA)
 11879*       RIDFLD    (ERMAIL-KEY)
 11880*       RESP      (WS-RESPONSE)
 11881*    END-EXEC
 11882*    MOVE '&"S        E          (  N#00011458' TO DFHEIV0
 11883     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11884     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11885     MOVE X'204E233030303131343538' TO DFHEIV0(25:11)
 11886     CALL 'kxdfhei1' USING DFHEIV0,
 11887           FILE-ID-ERMAIL,
 11888           DFHEIV20,
 11889           DFHEIV99,
 11890           ERMAIL-KEY,
 11891           DFHEIV99,
 11892           DFHEIV99,
 11893           DFHEIV99
 11894     SET ADDRESS OF MAILING-DATA TO
 11895         DFHEIV20
 11896     MOVE EIBRESP  TO WS-RESPONSE
 11897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11898     IF RESP-NORMAL
 11899        SET ERMAIL-FOUND TO TRUE
 11900     END-IF
 11901
 11902     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 11903     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 11904                                 TO ELCRTO-KEY
 11905     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 11906     MOVE +0                     TO ELCRTO-SEQ-NO
 11907
 11908* EXEC CICS READ
 11909*       DATASET   ('ELCRTO')
 11910*       INTO      (ORIGINAL-CERTIFICATE)
 11911*       RIDFLD    (ELCRTO-KEY)
 11912*       GTEQ
 11913*       RESP      (WS-RESPONSE)
 11914*    END-EXEC
 11915     MOVE LENGTH OF
 11916      ORIGINAL-CERTIFICATE
 11917       TO DFHEIV11
 11918     MOVE 'ELCRTO' TO DFHEIV1
 11919*    MOVE '&"IL       G          (  N#00011473' TO DFHEIV0
 11920     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 11921     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 11922     MOVE X'204E233030303131343733' TO DFHEIV0(25:11)
 11923     CALL 'kxdfhei1' USING DFHEIV0,
 11924           DFHEIV1,
 11925           ORIGINAL-CERTIFICATE,
 11926           DFHEIV11,
 11927           ELCRTO-KEY,
 11928           DFHEIV99,
 11929           DFHEIV99,
 11930           DFHEIV99
 11931     MOVE EIBRESP  TO WS-RESPONSE
 11932     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 219
* EL6311.cbl
 11933*    display ' just read gteq ' ws-response
 11934     IF RESP-NORMAL
 11935        AND (OC-CONTROL-PRIMARY (1:33) =
 11936                 PB-CONTROL-BY-ACCOUNT (1:33))
 11937        AND (OC-RECORD-TYPE = 'I')
 11938        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 11939           display ' csr edit session ' PI-CSR-SESSION-SW
 11940           IF NOT CSR-EDIT-SESSION
 11941
 11942* EXEC CICS READ
 11943*                DATASET   ('ELCRTO')
 11944*                INTO      (ORIGINAL-CERTIFICATE)
 11945*                RIDFLD    (OC-CONTROL-PRIMARY)
 11946*                UPDATE
 11947*                RESP      (WS-RESPONSE)
 11948*             END-EXEC
 11949     MOVE LENGTH OF
 11950      ORIGINAL-CERTIFICATE
 11951       TO DFHEIV11
 11952     MOVE 'ELCRTO' TO DFHEIV1
 11953*    MOVE '&"IL       EU         (  N#00011490' TO DFHEIV0
 11954     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 11955     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11956     MOVE X'204E233030303131343930' TO DFHEIV0(25:11)
 11957     CALL 'kxdfhei1' USING DFHEIV0,
 11958           DFHEIV1,
 11959           ORIGINAL-CERTIFICATE,
 11960           DFHEIV11,
 11961           OC-CONTROL-PRIMARY,
 11962           DFHEIV99,
 11963           DFHEIV99,
 11964           DFHEIV99
 11965     MOVE EIBRESP  TO WS-RESPONSE
 11966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 11967              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 11968              IF RESP-NORMAL
 11969                 display ' good read upd '
 11970                 MOVE PB-I-INSURED-LAST-NAME TO
 11971                         OC-INS-LAST-NAME
 11972                 MOVE PB-I-INSURED-FIRST-NAME TO
 11973                         OC-INS-FIRST-NAME
 11974                 MOVE PB-I-INSURED-MIDDLE-INIT TO
 11975                         OC-INS-MIDDLE-INIT
 11976                 MOVE PB-I-AGE         TO OC-INS-AGE
 11977                 MOVE PB-I-JOINT-LAST-NAME   TO
 11978                         OC-JNT-LAST-NAME
 11979                 MOVE PB-I-JOINT-FIRST-NAME  TO
 11980                         OC-JNT-FIRST-NAME
 11981                 MOVE PB-I-JOINT-MIDDLE-INIT TO
 11982                         OC-JNT-MIDDLE-INIT
 11983                 MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 11984                 MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 11985                 MOVE PB-I-LF-TERM     TO OC-LF-TERM
 11986                 MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 11987                 MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 11988                 MOVE PB-I-LF-ALT-BENEFIT-AMT TO
 11989                         OC-LF-ALT-BEN-AMT
 11990                 MOVE PB-I-LF-ALT-PREMIUM-AMT TO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 220
* EL6311.cbl
 11991                         OC-LF-ALT-PRM-AMT
 11992                 MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 11993                 MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 11994                 MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 11995                 MOVE PB-I-AH-TERM     TO OC-AH-TERM
 11996                 MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 11997                 MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 11998                 MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 11999                 MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12000                 MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12001                 MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12002                 IF OC-CANCEL-TRAN-IND = 'N'
 12003                    MOVE LOW-VALUES    TO OC-LF-CANCEL-DT
 12004                    MOVE +0            TO OC-LF-CANCEL-AMT
 12005                                          OC-LF-ITD-CANCEL-AMT
 12006                    MOVE LOW-VALUES    TO OC-AH-CANCEL-DT
 12007                    MOVE +0            TO OC-AH-CANCEL-AMT
 12008                                          OC-AH-ITD-CANCEL-AMT
 12009                 END-IF
 12010                 MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12011                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12012                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12013                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12014                 IF ERMAIL-FOUND
 12015                    MOVE MA-CRED-BENE-NAME
 12016                                 TO OC-CRED-BENE-NAME
 12017                 END-IF
 12018                 IF NOT CERT-TRL-REC-NOT-FOUND
 12019                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12020                           OC-INS-AGE-DEFAULT-FLAG
 12021                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12022                           OC-JNT-AGE-DEFAULT-FLAG
 12023                 END-IF
 12024
 12025* EXEC CICS REWRITE
 12026*                   DATASET   ('ELCRTO')
 12027*                   FROM      (ORIGINAL-CERTIFICATE)
 12028*                   RESP      (WS-RESPONSE)
 12029*                END-EXEC
 12030     MOVE LENGTH OF
 12031      ORIGINAL-CERTIFICATE
 12032       TO DFHEIV11
 12033     MOVE 'ELCRTO' TO DFHEIV1
 12034*    MOVE '&& L                  %  N#00011554' TO DFHEIV0
 12035     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12036     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12037     MOVE X'204E233030303131353534' TO DFHEIV0(25:11)
 12038     CALL 'kxdfhei1' USING DFHEIV0,
 12039           DFHEIV1,
 12040           ORIGINAL-CERTIFICATE,
 12041           DFHEIV11,
 12042           DFHEIV99
 12043     MOVE EIBRESP  TO WS-RESPONSE
 12044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12045                 display ' just rewrote ' ws-response
 12046              END-IF
 12047           END-IF
 12048        ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 221
* EL6311.cbl
 12049           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 12050           MOVE 'OC'             TO OC-RECORD-ID
 12051           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 12052           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 12053           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 12054           MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12055           MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12056           MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12057           MOVE PB-I-AGE         TO OC-INS-AGE
 12058           MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12059           MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12060           MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12061           MOVE PB-I-JOINT-AGE   TO OC-JNT-AGE
 12062           MOVE PB-I-LF-BENEFIT-CD TO OC-LF-BENCD
 12063           MOVE PB-I-LF-TERM     TO OC-LF-TERM
 12064           MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12065           MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12066           MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12067           MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12068           MOVE PB-I-LF-EXPIRE-DT TO OC-LF-EXP-DT
 12069           MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12070           MOVE LOW-VALUES       TO OC-LF-CANCEL-DT
 12071           MOVE +0               TO OC-LF-CANCEL-AMT
 12072                                    OC-LF-ITD-CANCEL-AMT
 12073           MOVE PB-I-AH-BENEFIT-CD TO OC-AH-BENCD
 12074           MOVE PB-I-AH-TERM     TO OC-AH-TERM
 12075           MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12076           MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12077           MOVE PB-I-AH-EXPIRE-DT TO OC-AH-EXP-DT
 12078           MOVE PB-I-AH-COMMISSION TO OC-AH-COMM-PCT
 12079           MOVE PB-I-AH-CRIT-PER TO OC-AH-CP
 12080           MOVE LOW-VALUES       TO OC-AH-CANCEL-DT
 12081           MOVE +0               TO OC-AH-CANCEL-AMT
 12082                                    OC-AH-ITD-CANCEL-AMT
 12083           MOVE PB-I-1ST-PMT-DT  TO OC-1ST-PMT-DT
 12084           MOVE 'Y'              TO OC-ISSUE-TRAN-IND
 12085           MOVE 'N'              TO OC-CANCEL-TRAN-IND
 12086           IF ERMAIL-FOUND
 12087              MOVE MA-CRED-BENE-NAME
 12088                                 TO OC-CRED-BENE-NAME
 12089           END-IF
 12090           IF NOT CERT-TRL-REC-NOT-FOUND
 12091              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12092                           OC-INS-AGE-DEFAULT-FLAG
 12093              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12094                           OC-JNT-AGE-DEFAULT-FLAG
 12095           END-IF
 12096           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 12097
 12098* EXEC CICS WRITE
 12099*             DATASET   ('ELCRTO')
 12100*             FROM      (ORIGINAL-CERTIFICATE)
 12101*             RIDFLD    (OC-CONTROL-PRIMARY)
 12102*             RESP      (WS-RESPONSE)
 12103*          END-EXEC
 12104     MOVE LENGTH OF
 12105      ORIGINAL-CERTIFICATE
 12106       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 222
* EL6311.cbl
 12107     MOVE 'ELCRTO' TO DFHEIV1
 12108*    MOVE '&$ L                  ''  N#00011611' TO DFHEIV0
 12109     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12110     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12111     MOVE X'204E233030303131363131' TO DFHEIV0(25:11)
 12112     CALL 'kxdfhei1' USING DFHEIV0,
 12113           DFHEIV1,
 12114           ORIGINAL-CERTIFICATE,
 12115           DFHEIV11,
 12116           OC-CONTROL-PRIMARY,
 12117           DFHEIV99,
 12118           DFHEIV99
 12119     MOVE EIBRESP  TO WS-RESPONSE
 12120     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12121        END-IF
 12122     ELSE
 12123        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 12124        MOVE 'OC'                TO OC-RECORD-ID
 12125        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 12126                                 TO OC-CONTROL-PRIMARY (1:33)
 12127        MOVE 'I'                 TO OC-RECORD-TYPE
 12128        MOVE +4096               TO OC-KEY-SEQ-NO
 12129        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 12130        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 12131        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 12132        MOVE PB-I-INSURED-LAST-NAME TO OC-INS-LAST-NAME
 12133        MOVE PB-I-INSURED-FIRST-NAME TO OC-INS-FIRST-NAME
 12134        MOVE PB-I-INSURED-MIDDLE-INIT TO OC-INS-MIDDLE-INIT
 12135        MOVE PB-I-AGE            TO OC-INS-AGE
 12136        MOVE PB-I-JOINT-LAST-NAME TO OC-JNT-LAST-NAME
 12137        MOVE PB-I-JOINT-FIRST-NAME TO OC-JNT-FIRST-NAME
 12138        MOVE PB-I-JOINT-MIDDLE-INIT TO OC-JNT-MIDDLE-INIT
 12139        MOVE PB-I-JOINT-AGE      TO OC-JNT-AGE
 12140        MOVE PB-I-LF-BENEFIT-CD  TO OC-LF-BENCD
 12141        MOVE PB-I-LF-TERM        TO OC-LF-TERM
 12142        MOVE PB-I-LF-BENEFIT-AMT TO OC-LF-BEN-AMT
 12143        MOVE PB-I-LF-PREMIUM-AMT TO OC-LF-PRM-AMT
 12144        MOVE PB-I-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
 12145        MOVE PB-I-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
 12146        MOVE PB-I-LF-EXPIRE-DT   TO OC-LF-EXP-DT
 12147        MOVE PB-I-LIFE-COMMISSION TO OC-LF-COMM-PCT
 12148        MOVE LOW-VALUES          TO OC-LF-CANCEL-DT
 12149        MOVE +0                  TO OC-LF-CANCEL-AMT
 12150                                    OC-LF-ITD-CANCEL-AMT
 12151        MOVE PB-I-AH-BENEFIT-CD  TO OC-AH-BENCD
 12152        MOVE PB-I-AH-TERM        TO OC-AH-TERM
 12153        MOVE PB-I-AH-BENEFIT-AMT TO OC-AH-BEN-AMT
 12154        MOVE PB-I-AH-PREMIUM-AMT TO OC-AH-PRM-AMT
 12155        MOVE PB-I-AH-EXPIRE-DT   TO OC-AH-EXP-DT
 12156        MOVE PB-I-AH-COMMISSION  TO OC-AH-COMM-PCT
 12157        MOVE PB-I-AH-CRIT-PER    TO OC-AH-CP
 12158        MOVE LOW-VALUES          TO OC-AH-CANCEL-DT
 12159        MOVE +0                  TO OC-AH-CANCEL-AMT
 12160                                    OC-AH-ITD-CANCEL-AMT
 12161        MOVE PB-I-1ST-PMT-DT     TO OC-1ST-PMT-DT
 12162        MOVE 'Y'                 TO OC-ISSUE-TRAN-IND
 12163        MOVE 'N'                 TO OC-CANCEL-TRAN-IND
 12164        IF ERMAIL-FOUND
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 223
* EL6311.cbl
 12165           MOVE MA-CRED-BENE-NAME
 12166                                 TO OC-CRED-BENE-NAME
 12167        END-IF
 12168        IF NOT CERT-TRL-REC-NOT-FOUND
 12169           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 12170                           OC-INS-AGE-DEFAULT-FLAG
 12171           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 12172                           OC-JNT-AGE-DEFAULT-FLAG
 12173        END-IF
 12174        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 12175
 12176* EXEC CICS WRITE
 12177*          DATASET   ('ELCRTO')
 12178*          FROM      (ORIGINAL-CERTIFICATE)
 12179*          RIDFLD    (OC-CONTROL-PRIMARY)
 12180*          RESP      (WS-RESPONSE)
 12181*       END-EXEC
 12182     MOVE LENGTH OF
 12183      ORIGINAL-CERTIFICATE
 12184       TO DFHEIV11
 12185     MOVE 'ELCRTO' TO DFHEIV1
 12186*    MOVE '&$ L                  ''  N#00011671' TO DFHEIV0
 12187     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12188     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12189     MOVE X'204E233030303131363731' TO DFHEIV0(25:11)
 12190     CALL 'kxdfhei1' USING DFHEIV0,
 12191           DFHEIV1,
 12192           ORIGINAL-CERTIFICATE,
 12193           DFHEIV11,
 12194           OC-CONTROL-PRIMARY,
 12195           DFHEIV99,
 12196           DFHEIV99
 12197     MOVE EIBRESP  TO WS-RESPONSE
 12198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12199     END-IF
 12200******************************************************************
 12201*       U P D A T E   T H E   B A T C H   H E A D E R            *
 12202******************************************************************
 12203
 12204     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12205     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12206
 12207
 12208* EXEC CICS READ
 12209*        INTO    (PENDING-BUSINESS)
 12210*        DATASET (FILE-ID-ERPNDB)
 12211*        RIDFLD  (ERPNDB-KEY)
 12212*        UPDATE
 12213*    END-EXEC.
 12214     MOVE LENGTH OF
 12215      PENDING-BUSINESS
 12216       TO DFHEIV11
 12217*    MOVE '&"IL       EU         (   #00011685' TO DFHEIV0
 12218     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12219     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12220     MOVE X'2020233030303131363835' TO DFHEIV0(25:11)
 12221     CALL 'kxdfhei1' USING DFHEIV0,
 12222           FILE-ID-ERPNDB,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 224
* EL6311.cbl
 12223           PENDING-BUSINESS,
 12224           DFHEIV11,
 12225           ERPNDB-KEY,
 12226           DFHEIV99,
 12227           DFHEIV99,
 12228           DFHEIV99
 12229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12230
 12231
 12232     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 12233     MOVE 'B'                    TO JP-RECORD-TYPE.
 12234     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12235
 12236     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12237
 12238     PERFORM 8400-LOG-JOURNAL-RECORD.
 12239
 12240     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD
 12241
 12242     MOVE 'C'                    TO JP-RECORD-TYPE.
 12243     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 12244
 12245
 12246* EXEC CICS REWRITE
 12247*        DATASET    (FILE-ID-ERPNDB)
 12248*        FROM       (PENDING-BUSINESS)
 12249*    END-EXEC.
 12250     MOVE LENGTH OF
 12251      PENDING-BUSINESS
 12252       TO DFHEIV11
 12253*    MOVE '&& L                  %   #00011705' TO DFHEIV0
 12254     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12255     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12256     MOVE X'2020233030303131373035' TO DFHEIV0(25:11)
 12257     CALL 'kxdfhei1' USING DFHEIV0,
 12258           FILE-ID-ERPNDB,
 12259           PENDING-BUSINESS,
 12260           DFHEIV11,
 12261           DFHEIV99
 12262     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12263
 12264
 12265     PERFORM 8400-LOG-JOURNAL-RECORD.
 12266
 12267     IF WS-ERRORS-PRESENT
 12268        GO TO 3900-RE-DISPLAY-RECORD.
 12269
 12270     MOVE ZEROS                  TO EMI-ERROR.
 12271     MOVE -1                     TO BMAINTL.
 12272     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12273     GO TO 3900-RE-DISPLAY-RECORD.
 12274
 12275 1380-BATCH-HDR-NOT-FOUND.
 12276     MOVE -1                     TO BMAINTL.
 12277     MOVE ER-7450                TO EMI-ERROR.
 12278     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12279     GO TO 8200-SEND-DATAONLY.
 12280
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 225
* EL6311.cbl
 12281 1385-REC-NOT-FOUND.
 12282     MOVE -1                     TO BMAINTL.
 12283     MOVE ER-7451                TO EMI-ERROR.
 12284     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12285     GO TO 8200-SEND-DATAONLY.
 12286
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 226
* EL6311.cbl
 12288
 12289 1386-UPDATE-AGE-FLAGS.
 12290
 12291
 12292* EXEC CICS GETMAIN
 12293*        SET     (ADDRESS OF CERTIFICATE-TRAILERS)
 12294*        LENGTH  (ELCRTT-RECORD-LENGTH)
 12295*        INITIMG (GETMAIN-SPACE)
 12296*    END-EXEC
 12297*    MOVE ',"IL                  $   #00011736' TO DFHEIV0
 12298     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 12299     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 12300     MOVE X'2020233030303131373336' TO DFHEIV0(25:11)
 12301     CALL 'kxdfhei1' USING DFHEIV0,
 12302           DFHEIV20,
 12303           ELCRTT-RECORD-LENGTH,
 12304           GETMAIN-SPACE
 12305     SET ADDRESS OF CERTIFICATE-TRAILERS TO
 12306         DFHEIV20
 12307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12308
 12309
 12310* EXEC CICS HANDLE CONDITION
 12311*        NOTFND   (1386-NOTFND)
 12312*    END-EXEC.
 12313*    MOVE '"$I                   ! ( #00011742' TO DFHEIV0
 12314     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12315     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12316     MOVE X'2820233030303131373432' TO DFHEIV0(25:11)
 12317     CALL 'kxdfhei1' USING DFHEIV0
 12318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12319
 12320
 12321     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY
 12322     MOVE 'C'                TO ELCRTT-REC-TYPE
 12323
 12324
 12325* EXEC CICS READ
 12326*        UPDATE
 12327*        DATASET  (CRTT-ID)
 12328*        RIDFLD   (ELCRTT-KEY)
 12329*        INTO     (CERTIFICATE-TRAILERS)
 12330*    END-EXEC.
 12331     MOVE LENGTH OF
 12332      CERTIFICATE-TRAILERS
 12333       TO DFHEIV11
 12334*    MOVE '&"IL       EU         (   #00011749' TO DFHEIV0
 12335     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12336     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12337     MOVE X'2020233030303131373439' TO DFHEIV0(25:11)
 12338     CALL 'kxdfhei1' USING DFHEIV0,
 12339           CRTT-ID,
 12340           CERTIFICATE-TRAILERS,
 12341           DFHEIV11,
 12342           ELCRTT-KEY,
 12343           DFHEIV99,
 12344           DFHEIV99,
 12345           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 227
* EL6311.cbl
 12346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12347
 12348
 12349     IF WS-INS-AGE-SET = 'Y'
 12350        MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG
 12351     END-IF
 12352     IF WS-JNT-AGE-SET = 'Y'
 12353        MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG
 12354     END-IF
 12355
 12356
 12357* EXEC CICS REWRITE
 12358*       DATASET  (CRTT-ID)
 12359*       FROM     (CERTIFICATE-TRAILERS)
 12360*    END-EXEC.
 12361     MOVE LENGTH OF
 12362      CERTIFICATE-TRAILERS
 12363       TO DFHEIV11
 12364*    MOVE '&& L                  %   #00011763' TO DFHEIV0
 12365     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12366     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12367     MOVE X'2020233030303131373633' TO DFHEIV0(25:11)
 12368     CALL 'kxdfhei1' USING DFHEIV0,
 12369           CRTT-ID,
 12370           CERTIFICATE-TRAILERS,
 12371           DFHEIV11,
 12372           DFHEIV99
 12373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12374
 12375
 12376     GO TO 1386-EXIT.
 12377
 12378 1386-NOTFND.
 12379
 12380     MOVE SPACES       TO CERTIFICATE-TRAILERS.
 12381     MOVE 'CS'         TO CS-RECORD-ID.
 12382     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ELCRTT-PRIMARY.
 12383     MOVE 'C'          TO ELCRTT-REC-TYPE.
 12384     MOVE ELCRTT-KEY TO CS-CONTROL-PRIMARY.
 12385     MOVE WS-INS-AGE-DEFAULTED TO CS-INS-AGE-DEFAULT-FLAG.
 12386     MOVE WS-JNT-AGE-DEFAULTED TO CS-JNT-AGE-DEFAULT-FLAG.
 12387
 12388* EXEC CICS WRITE
 12389*       DATASET  (CRTT-ID)
 12390*       RIDFLD   (ELCRTT-KEY)
 12391*       FROM     (CERTIFICATE-TRAILERS)
 12392*    END-EXEC.
 12393     MOVE LENGTH OF
 12394      CERTIFICATE-TRAILERS
 12395       TO DFHEIV11
 12396*    MOVE '&$ L                  ''   #00011779' TO DFHEIV0
 12397     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12398     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12399     MOVE X'2020233030303131373739' TO DFHEIV0(25:11)
 12400     CALL 'kxdfhei1' USING DFHEIV0,
 12401           CRTT-ID,
 12402           CERTIFICATE-TRAILERS,
 12403           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 228
* EL6311.cbl
 12404           ELCRTT-KEY,
 12405           DFHEIV99,
 12406           DFHEIV99
 12407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12408
 12409
 12410 1386-EXIT.
 12411     EXIT.
 12412
 12413 1390-UPDATE-ERPNDM.
 12414
 12415
 12416* EXEC CICS HANDLE CONDITION
 12417*        NOTFND (1399-EXIT)
 12418*    END-EXEC.
 12419*    MOVE '"$I                   ! ) #00011790' TO DFHEIV0
 12420     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12421     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12422     MOVE X'2920233030303131373930' TO DFHEIV0(25:11)
 12423     CALL 'kxdfhei1' USING DFHEIV0
 12424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12425
 12426
 12427     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 12428
 12429
 12430* EXEC CICS READ
 12431*        SET     (ADDRESS OF PENDING-MAILING-DATA)
 12432*        DATASET (FILE-ID-ERPNDM)
 12433*        RIDFLD  (ERPNDM-KEY)
 12434*        UPDATE
 12435*    END-EXEC.
 12436*    MOVE '&"S        EU         (   #00011796' TO DFHEIV0
 12437     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12438     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12439     MOVE X'2020233030303131373936' TO DFHEIV0(25:11)
 12440     CALL 'kxdfhei1' USING DFHEIV0,
 12441           FILE-ID-ERPNDM,
 12442           DFHEIV20,
 12443           DFHEIV99,
 12444           ERPNDM-KEY,
 12445           DFHEIV99,
 12446           DFHEIV99,
 12447           DFHEIV99
 12448     SET ADDRESS OF PENDING-MAILING-DATA TO
 12449         DFHEIV20
 12450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12451
 12452
 12453     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
 12454     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
 12455     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
 12456
 12457     IF BLSTNML GREATER THAN ZEROS
 12458         MOVE BLSTNMI            TO PM-INSURED-LAST-NAME.
 12459
 12460     IF B1STNML GREATER  THAN ZEROS
 12461         MOVE B1STNMI            TO PM-INSURED-FIRST-NAME.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 229
* EL6311.cbl
 12462
 12463     IF BINITL GREATER THAN ZEROS
 12464         MOVE BINITI             TO PM-INSURED-MIDDLE-INIT.
 12465
 12466     IF BAGEL GREATER THAN ZEROS
 12467         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
 12468
 12469     IF BBIRTHL GREATER THAN ZEROS
 12470         MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
 12471
 12472     IF BSEXL GREATER THAN ZEROS
 12473         MOVE  BSEXI             TO PM-INSURED-SEX.
 12474
 12475
 12476* EXEC CICS REWRITE
 12477*        DATASET (FILE-ID-ERPNDM)
 12478*        FROM    (PENDING-MAILING-DATA)
 12479*    END-EXEC.
 12480     MOVE LENGTH OF
 12481      PENDING-MAILING-DATA
 12482       TO DFHEIV11
 12483*    MOVE '&& L                  %   #00011825' TO DFHEIV0
 12484     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12485     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12486     MOVE X'2020233030303131383235' TO DFHEIV0(25:11)
 12487     CALL 'kxdfhei1' USING DFHEIV0,
 12488           FILE-ID-ERPNDM,
 12489           PENDING-MAILING-DATA,
 12490           DFHEIV11,
 12491           DFHEIV99
 12492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12493
 12494
 12495 1399-EXIT.
 12496     EXIT.
 12497
 12498******************************************************************
 12499*                                                                *
 12500*          D E L E T E   I S S U E   R O U T I N E               *
 12501*                                                                *
 12502******************************************************************
 12503
 12504 1400-DELETE-ISSUE-ROUTINE.
 12505     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 12506
 12507     IF BCHGL NOT = ZEROS
 12508        MOVE ER-2196             TO EMI-ERROR
 12509        MOVE AL-UABON            TO BMAINTA
 12510        MOVE -1                  TO BMAINTL
 12511        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12512        GO TO 8200-SEND-DATAONLY.
 12513
 12514
 12515* EXEC CICS HANDLE CONDITION
 12516*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 12517*    END-EXEC.
 12518*    MOVE '"$I                   ! * #00011849' TO DFHEIV0
 12519     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 230
* EL6311.cbl
 12520     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12521     MOVE X'2A20233030303131383439' TO DFHEIV0(25:11)
 12522     CALL 'kxdfhei1' USING DFHEIV0
 12523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12524
 12525
 12526     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 12527     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 12528     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 12529
 12530
 12531* EXEC CICS READ
 12532*        SET     (ADDRESS OF PENDING-BUSINESS)
 12533*        DATASET (FILE-ID-ERPNDB)
 12534*        RIDFLD  (ERPNDB-KEY)
 12535*    END-EXEC.
 12536*    MOVE '&"S        E          (   #00011857' TO DFHEIV0
 12537     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12538     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12539     MOVE X'2020233030303131383537' TO DFHEIV0(25:11)
 12540     CALL 'kxdfhei1' USING DFHEIV0,
 12541           FILE-ID-ERPNDB,
 12542           DFHEIV20,
 12543           DFHEIV99,
 12544           ERPNDB-KEY,
 12545           DFHEIV99,
 12546           DFHEIV99,
 12547           DFHEIV99
 12548     SET ADDRESS OF PENDING-BUSINESS TO
 12549         DFHEIV20
 12550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12551
 12552
 12553     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 12554
 12555     MOVE BCERTNOI               TO WS-NEW-PRIME.
 12556
 12557     IF BSUFIXL NOT = ZEROS
 12558        MOVE BSUFIXI             TO WS-NEW-SUFFIX
 12559     ELSE
 12560        MOVE SPACE               TO WS-NEW-SUFFIX.
 12561
 12562     MOVE BEFFDTI                TO DEEDIT-FIELD.
 12563     PERFORM 8600-DEEDIT.
 12564     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 12565     MOVE '4'                    TO DC-OPTION-CODE.
 12566     PERFORM 9700-DATE-LINK.
 12567     IF DATE-CONVERSION-ERROR
 12568        MOVE ER-0348             TO EMI-ERROR
 12569        MOVE -1                  TO BEFFDTL
 12570        MOVE AL-UABON            TO BEFFDTA
 12571        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12572        GO TO 8200-SEND-DATAONLY
 12573     ELSE
 12574        MOVE DC-GREG-DATE-1-EDIT TO BEFFDTI
 12575        MOVE AL-UANON            TO BEFFDTA
 12576        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 12577
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 231
* EL6311.cbl
 12578
 12579* EXEC CICS HANDLE CONDITION
 12580*         NOTFND    (1490-RECORD-NOT-FOUND)
 12581*    END-EXEC.
 12582*    MOVE '"$I                   ! + #00011888' TO DFHEIV0
 12583     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12584     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12585     MOVE X'2B20233030303131383838' TO DFHEIV0(25:11)
 12586     CALL 'kxdfhei1' USING DFHEIV0
 12587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12588
 12589
 12590
 12591* EXEC CICS READ
 12592*        SET     (ADDRESS OF PENDING-BUSINESS)
 12593*        DATASET (FILE-ID-ERPNDB)
 12594*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 12595*        UPDATE
 12596*    END-EXEC.
 12597*    MOVE '&"S        EU         (   #00011892' TO DFHEIV0
 12598     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12599     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12600     MOVE X'2020233030303131383932' TO DFHEIV0(25:11)
 12601     CALL 'kxdfhei1' USING DFHEIV0,
 12602           FILE-ID-ERPNDB,
 12603           DFHEIV20,
 12604           DFHEIV99,
 12605           PI-PREV-CONTROL-PRIMARY,
 12606           DFHEIV99,
 12607           DFHEIV99,
 12608           DFHEIV99
 12609     SET ADDRESS OF PENDING-BUSINESS TO
 12610         DFHEIV20
 12611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12612
 12613
 12614     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 12615        MOVE -1                 TO BMAINTL
 12616        MOVE ER-2197            TO EMI-ERROR
 12617        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12618        GO TO 8200-SEND-DATAONLY.
 12619
 12620     IF PB-BILLED-DT NOT = LOW-VALUES
 12621        MOVE -1                 TO BMAINTL
 12622        MOVE ER-2129            TO EMI-ERROR
 12623        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12624        GO TO 8200-SEND-DATAONLY.
 12625
 12626     IF PB-CHG-COUNT NOT = ZEROS
 12627        MOVE ER-2336            TO EMI-ERROR
 12628        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12629        MOVE AL-UABON            TO BMAINTA
 12630        MOVE -1                  TO BMAINTL
 12631        GO TO 8200-SEND-DATAONLY.
 12632
 12633     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 12634        PB-CHG-COUNT NOT = ZEROS
 12635        MOVE ER-2196             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 232
* EL6311.cbl
 12636        MOVE AL-UABON            TO BMAINTA
 12637        MOVE -1                  TO BMAINTL
 12638        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12639        GO TO 8200-SEND-DATAONLY.
 12640******************************************************************
 12641*                                                                *
 12642*       Determine if there have been any checks created          *
 12643*                                                                *
 12644******************************************************************
 12645
 12646     perform 2500-browse-checks  thru 2500-exit
 12647
 12648     if i-have-processed-checks
 12649        or i-have-checks
 12650        or i-have-a-check-period
 12651        move er-3446             to emi-error
 12652        perform 9900-error-format thru 9900-exit
 12653        move al-uabon            to bmainta
 12654        move -1                  to bmaintl
 12655        go to 8200-send-dataonly
 12656     end-if
 12657******************************************************************
 12658*                                                                *
 12659*       DELETE ORIGINAL CERTIFICATE INFO                         *
 12660*                                                                *
 12661******************************************************************
 12662     MOVE PI-PREV-ALT-KEY (1:33) TO ELCRTO-KEY (1:33)
 12663     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 12664     MOVE +0                     TO ELCRTO-SEQ-NO
 12665
 12666* EXEC CICS READ
 12667*       DATASET   ('ELCRTO')
 12668*       INTO      (ORIGINAL-CERTIFICATE)
 12669*       RIDFLD    (ELCRTO-KEY)
 12670*       GTEQ
 12671*       RESP      (WS-RESPONSE)
 12672*    END-EXEC
 12673     MOVE LENGTH OF
 12674      ORIGINAL-CERTIFICATE
 12675       TO DFHEIV11
 12676     MOVE 'ELCRTO' TO DFHEIV1
 12677*    MOVE '&"IL       G          (  N#00011950' TO DFHEIV0
 12678     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 12679     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12680     MOVE X'204E233030303131393530' TO DFHEIV0(25:11)
 12681     CALL 'kxdfhei1' USING DFHEIV0,
 12682           DFHEIV1,
 12683           ORIGINAL-CERTIFICATE,
 12684           DFHEIV11,
 12685           ELCRTO-KEY,
 12686           DFHEIV99,
 12687           DFHEIV99,
 12688           DFHEIV99
 12689     MOVE EIBRESP  TO WS-RESPONSE
 12690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12691     IF RESP-NORMAL
 12692        AND (OC-CONTROL-PRIMARY (1:33) =
 12693                 PB-CONTROL-BY-ACCOUNT (1:33))
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 233
* EL6311.cbl
 12694        AND (OC-RECORD-TYPE = 'I')
 12695
 12696* EXEC CICS READ
 12697*          DATASET   ('ELCRTO')
 12698*          INTO      (ORIGINAL-CERTIFICATE)
 12699*          RIDFLD    (ELCRTO-KEY)
 12700*          UPDATE
 12701*          RESP      (WS-RESPONSE)
 12702*       END-EXEC
 12703     MOVE LENGTH OF
 12704      ORIGINAL-CERTIFICATE
 12705       TO DFHEIV11
 12706     MOVE 'ELCRTO' TO DFHEIV1
 12707*    MOVE '&"IL       EU         (  N#00011961' TO DFHEIV0
 12708     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12709     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12710     MOVE X'204E233030303131393631' TO DFHEIV0(25:11)
 12711     CALL 'kxdfhei1' USING DFHEIV0,
 12712           DFHEIV1,
 12713           ORIGINAL-CERTIFICATE,
 12714           DFHEIV11,
 12715           ELCRTO-KEY,
 12716           DFHEIV99,
 12717           DFHEIV99,
 12718           DFHEIV99
 12719     MOVE EIBRESP  TO WS-RESPONSE
 12720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12721        IF RESP-NORMAL
 12722
 12723* EXEC CICS DELETE
 12724*             DATASET   ('ELCRTO')
 12725*          END-EXEC
 12726     MOVE 'ELCRTO' TO DFHEIV1
 12727*    MOVE '&(                    &   #00011969' TO DFHEIV0
 12728     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12729     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12730     MOVE X'2020233030303131393639' TO DFHEIV0(25:11)
 12731     CALL 'kxdfhei1' USING DFHEIV0,
 12732           DFHEIV1,
 12733           DFHEIV99,
 12734           DFHEIV99,
 12735           DFHEIV99,
 12736           DFHEIV99
 12737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12738        END-IF
 12739     END-IF
 12740******************************************************************
 12741*                                                                *
 12742*       DELETE PENDING MAILING ADDRESS RECORDS                   *
 12743*                                                                *
 12744******************************************************************
 12745
 12746* EXEC CICS HANDLE CONDITION
 12747*        NOTFND    (1405-DELETE-CERTIFICATE)
 12748*    END-EXEC.
 12749*    MOVE '"$I                   ! , #00011979' TO DFHEIV0
 12750     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12751     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 234
* EL6311.cbl
 12752     MOVE X'2C20233030303131393739' TO DFHEIV0(25:11)
 12753     CALL 'kxdfhei1' USING DFHEIV0
 12754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12755
 12756
 12757
 12758* EXEC CICS READ
 12759*        EQUAL
 12760*        DATASET   (FILE-ID-ERPNDM)
 12761*        SET       (ADDRESS OF PENDING-MAILING-DATA)
 12762*        RIDFLD    (PI-PREV-CONTROL-PRIMARY)
 12763*        UPDATE
 12764*    END-EXEC.
 12765*    MOVE '&"S        EU         (   #00011983' TO DFHEIV0
 12766     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12767     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12768     MOVE X'2020233030303131393833' TO DFHEIV0(25:11)
 12769     CALL 'kxdfhei1' USING DFHEIV0,
 12770           FILE-ID-ERPNDM,
 12771           DFHEIV20,
 12772           DFHEIV99,
 12773           PI-PREV-CONTROL-PRIMARY,
 12774           DFHEIV99,
 12775           DFHEIV99,
 12776           DFHEIV99
 12777     SET ADDRESS OF PENDING-MAILING-DATA TO
 12778         DFHEIV20
 12779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12780
 12781
 12782     MOVE FILE-ID-ERPNDM         TO  JP-FILE-ID.
 12783     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12784     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
 12785
 12786     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12787
 12788
 12789* EXEC CICS DELETE
 12790*        DATASET   (FILE-ID-ERPNDM)
 12791*    END-EXEC.
 12792*    MOVE '&(                    &   #00011997' TO DFHEIV0
 12793     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12794     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12795     MOVE X'2020233030303131393937' TO DFHEIV0(25:11)
 12796     CALL 'kxdfhei1' USING DFHEIV0,
 12797           FILE-ID-ERPNDM,
 12798           DFHEIV99,
 12799           DFHEIV99,
 12800           DFHEIV99,
 12801           DFHEIV99
 12802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12803
 12804
 12805******************************************************************
 12806*                PROCESS   CERTIFICATE                           *
 12807******************************************************************
 12808
 12809 1405-DELETE-CERTIFICATE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 235
* EL6311.cbl
 12810
 12811* EXEC CICS HANDLE CONDITION
 12812*         NOTFND  (1420-CONTINUE-DELETE)
 12813*    END-EXEC.
 12814*    MOVE '"$I                   ! - #00012006' TO DFHEIV0
 12815     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12816     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12817     MOVE X'2D20233030303132303036' TO DFHEIV0(25:11)
 12818     CALL 'kxdfhei1' USING DFHEIV0
 12819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12820
 12821
 12822     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 12823     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 12824     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 12825     MOVE PB-SV-STATE            TO ELCERT-STATE.
 12826
 12827
 12828* EXEC CICS READ
 12829*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 12830*        DATASET (FILE-ID-ELCERT)
 12831*        RIDFLD  (ELCERT-KEY)
 12832*        UPDATE
 12833*    END-EXEC.
 12834*    MOVE '&"S        EU         (   #00012015' TO DFHEIV0
 12835     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12836     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12837     MOVE X'2020233030303132303135' TO DFHEIV0(25:11)
 12838     CALL 'kxdfhei1' USING DFHEIV0,
 12839           FILE-ID-ELCERT,
 12840           DFHEIV20,
 12841           DFHEIV99,
 12842           ELCERT-KEY,
 12843           DFHEIV99,
 12844           DFHEIV99,
 12845           DFHEIV99
 12846     SET ADDRESS OF CERTIFICATE-MASTER TO
 12847         DFHEIV20
 12848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12849
 12850
 12851     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12852
 12853     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 12854     MOVE 'B'                    TO JP-RECORD-TYPE
 12855     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 12856
 12857     PERFORM 8400-LOG-JOURNAL-RECORD.
 12858
 12859     IF CERT-NOTES-ARE-NOT-PRESENT
 12860        MOVE ' '                 TO WS-CERT-NOTE-SW
 12861     ELSE
 12862        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 12863
 12864     IF INSURED-ADDR-PRESENT
 12865        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 12866
 12867******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 236
* EL6311.cbl
 12868******* THIS CODE SHOULD BYPASS SETTING THE CLAIM-INTERFACE-SW  **
 12869******* IF THE CERTIFICATE HAS ALREADY GONE THROUGH A MONTH END **
 12870******************************************************************
 12871******************************************************************
 12872
 12873     IF CERT-ADDED-BATCH AND
 12874        (NOT NO-CLAIM-ATTACHED
 12875         OR
 12876         CM-CLAIM-ATTACHED-COUNT GREATER THAN +0)
 12877        GO TO 1410-REWRITE-CERT.
 12878
 12879******************************************************************
 12880******************************************************************
 12881
 12882     IF CERT-ADDED-BATCH  AND
 12883        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
 12884        GO TO 1410-REWRITE-CERT.
 12885
 12886     IF NO-CLAIM-ATTACHED
 12887        NEXT SENTENCE
 12888     ELSE
 12889        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
 12890        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
 12891        GO TO 1410-REWRITE-CERT.
 12892
 12893     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 12894     MOVE 'D'                      TO JP-RECORD-TYPE.
 12895     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 12896
 12897
 12898* EXEC CICS DELETE
 12899*         DATASET    (FILE-ID-ELCERT)
 12900*    END-EXEC.
 12901*    MOVE '&(                    &   #00012068' TO DFHEIV0
 12902     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 12903     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12904     MOVE X'2020233030303132303638' TO DFHEIV0(25:11)
 12905     CALL 'kxdfhei1' USING DFHEIV0,
 12906           FILE-ID-ELCERT,
 12907           DFHEIV99,
 12908           DFHEIV99,
 12909           DFHEIV99,
 12910           DFHEIV99
 12911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12912
 12913
 12914     PERFORM 8400-LOG-JOURNAL-RECORD.
 12915
 12916******************************************************************
 12917*                                                                *
 12918*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 12919*                                                                *
 12920******************************************************************
 12921
 12922     IF  CERT-NOTES-ARE-PRESENT
 12923         NEXT SENTENCE
 12924     ELSE
 12925         GO TO 1407-DELETE-MAILING.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 237
* EL6311.cbl
 12926
 12927
 12928* EXEC CICS HANDLE CONDITION
 12929*         NOTFND  (1406-DELETE-ERNOTE)
 12930*    END-EXEC.
 12931*    MOVE '"$I                   ! . #00012085' TO DFHEIV0
 12932     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 12933     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12934     MOVE X'2E20233030303132303835' TO DFHEIV0(25:11)
 12935     CALL 'kxdfhei1' USING DFHEIV0
 12936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12937
 12938
 12939     MOVE ELCERT-KEY            TO ERCNOT-KEY.
 12940     MOVE '0'                   TO ERCNOT-REC-TYPE.
 12941     MOVE 0                     TO ERCNOT-SEQUENCE.
 12942
 12943 1406-DELETE-ERCNOT-LOOP.
 12944
 12945
 12946* EXEC CICS READ
 12947*        GTEQ
 12948*        DATASET   (FILE-ID-ERCNOT)
 12949*        SET       (ADDRESS OF CERT-NOTE-FILE)
 12950*        RIDFLD    (ERCNOT-KEY)
 12951*    END-EXEC.
 12952*    MOVE '&"S        G          (   #00012095' TO DFHEIV0
 12953     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 12954     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12955     MOVE X'2020233030303132303935' TO DFHEIV0(25:11)
 12956     CALL 'kxdfhei1' USING DFHEIV0,
 12957           FILE-ID-ERCNOT,
 12958           DFHEIV20,
 12959           DFHEIV99,
 12960           ERCNOT-KEY,
 12961           DFHEIV99,
 12962           DFHEIV99,
 12963           DFHEIV99
 12964     SET ADDRESS OF CERT-NOTE-FILE TO
 12965         DFHEIV20
 12966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12967
 12968
 12969     MOVE CZ-CONTROL-PRIMARY      TO ERCNOT-KEY
 12970     IF ERCNOT-PART-KEY NOT EQUAL ELCERT-KEY
 12971         GO TO 1406-DELETE-ERNOTE
 12972     END-IF.
 12973
 12974     MOVE FILE-ID-ERCNOT         TO  JP-FILE-ID.
 12975     MOVE 'D'                    TO  JP-RECORD-TYPE.
 12976     MOVE CERT-NOTE-FILE         TO  JP-RECORD-AREA.
 12977
 12978     MOVE ERCNOT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 12979
 12980
 12981* EXEC CICS DELETE
 12982*        DATASET   (FILE-ID-ERCNOT)
 12983*        RIDFLD    (ERCNOT-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 238
* EL6311.cbl
 12984*        END-EXEC.
 12985*    MOVE '&(  R                 &   #00012113' TO DFHEIV0
 12986     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 12987     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12988     MOVE X'2020233030303132313133' TO DFHEIV0(25:11)
 12989     CALL 'kxdfhei1' USING DFHEIV0,
 12990           FILE-ID-ERCNOT,
 12991           ERCNOT-KEY,
 12992           DFHEIV99,
 12993           DFHEIV99,
 12994           DFHEIV99
 12995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12996
 12997
 12998     PERFORM 8400-LOG-JOURNAL-RECORD.
 12999
 13000     GO TO 1406-DELETE-ERCNOT-LOOP.
 13001
 13002 1406-DELETE-ERNOTE.
 13003
 13004
 13005* EXEC CICS HANDLE CONDITION
 13006*         NOTFND  (1407-DELETE-MAILING)
 13007*    END-EXEC.
 13008*    MOVE '"$I                   ! / #00012124' TO DFHEIV0
 13009     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13010     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13011     MOVE X'2F20233030303132313234' TO DFHEIV0(25:11)
 13012     CALL 'kxdfhei1' USING DFHEIV0
 13013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13014
 13015
 13016
 13017* EXEC CICS READ
 13018*        EQUAL
 13019*        DATASET   (FILE-ID-ERNOTE)
 13020*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 13021*        RIDFLD    (ELCERT-KEY)
 13022*        UPDATE
 13023*    END-EXEC.
 13024*    MOVE '&"S        EU         (   #00012128' TO DFHEIV0
 13025     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13026     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13027     MOVE X'2020233030303132313238' TO DFHEIV0(25:11)
 13028     CALL 'kxdfhei1' USING DFHEIV0,
 13029           FILE-ID-ERNOTE,
 13030           DFHEIV20,
 13031           DFHEIV99,
 13032           ELCERT-KEY,
 13033           DFHEIV99,
 13034           DFHEIV99,
 13035           DFHEIV99
 13036     SET ADDRESS OF CERTIFICATE-NOTE TO
 13037         DFHEIV20
 13038     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13039
 13040
 13041     MOVE FILE-ID-ERNOTE         TO  JP-FILE-ID.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 239
* EL6311.cbl
 13042     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13043     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 13044
 13045     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13046
 13047
 13048* EXEC CICS DELETE
 13049*        DATASET   (FILE-ID-ERNOTE)
 13050*        END-EXEC.
 13051*    MOVE '&(                    &   #00012142' TO DFHEIV0
 13052     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13053     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13054     MOVE X'2020233030303132313432' TO DFHEIV0(25:11)
 13055     CALL 'kxdfhei1' USING DFHEIV0,
 13056           FILE-ID-ERNOTE,
 13057           DFHEIV99,
 13058           DFHEIV99,
 13059           DFHEIV99,
 13060           DFHEIV99
 13061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13062
 13063
 13064     PERFORM 8400-LOG-JOURNAL-RECORD.
 13065
 13066******************************************************************
 13067*                                                                *
 13068*                DELETE MAILING ADDRESS RECORDS                  *
 13069*                                                                *
 13070******************************************************************
 13071
 13072 1407-DELETE-MAILING.
 13073     IF CERT-ADDRESS-PRESENT
 13074        NEXT SENTENCE
 13075     ELSE
 13076        GO TO 1420-CONTINUE-DELETE.
 13077
 13078
 13079* EXEC CICS HANDLE CONDITION
 13080*         NOTFND  (1420-CONTINUE-DELETE)
 13081*    END-EXEC.
 13082*    MOVE '"$I                   ! 0 #00012160' TO DFHEIV0
 13083     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13084     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13085     MOVE X'3020233030303132313630' TO DFHEIV0(25:11)
 13086     CALL 'kxdfhei1' USING DFHEIV0
 13087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13088
 13089
 13090
 13091* EXEC CICS READ
 13092*        EQUAL
 13093*        DATASET   (FILE-ID-ERMAIL)
 13094*        SET       (ADDRESS OF MAILING-DATA)
 13095*        RIDFLD    (ELCERT-KEY)
 13096*        UPDATE
 13097*    END-EXEC.
 13098*    MOVE '&"S        EU         (   #00012164' TO DFHEIV0
 13099     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 240
* EL6311.cbl
 13100     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13101     MOVE X'2020233030303132313634' TO DFHEIV0(25:11)
 13102     CALL 'kxdfhei1' USING DFHEIV0,
 13103           FILE-ID-ERMAIL,
 13104           DFHEIV20,
 13105           DFHEIV99,
 13106           ELCERT-KEY,
 13107           DFHEIV99,
 13108           DFHEIV99,
 13109           DFHEIV99
 13110     SET ADDRESS OF MAILING-DATA TO
 13111         DFHEIV20
 13112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13113
 13114
 13115     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 13116     MOVE 'D'                    TO  JP-RECORD-TYPE.
 13117     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 13118
 13119     MOVE ERMAIL-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13120
 13121
 13122* EXEC CICS DELETE
 13123*        DATASET   (FILE-ID-ERMAIL)
 13124*    END-EXEC.
 13125*    MOVE '&(                    &   #00012178' TO DFHEIV0
 13126     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13127     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13128     MOVE X'2020233030303132313738' TO DFHEIV0(25:11)
 13129     CALL 'kxdfhei1' USING DFHEIV0,
 13130           FILE-ID-ERMAIL,
 13131           DFHEIV99,
 13132           DFHEIV99,
 13133           DFHEIV99,
 13134           DFHEIV99
 13135     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13136
 13137
 13138     GO TO 1420-CONTINUE-DELETE.
 13139
 13140 1410-REWRITE-CERT.
 13141     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 13142     MOVE 'C'                      TO JP-RECORD-TYPE.
 13143     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 13144     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13145
 13146
 13147* EXEC CICS REWRITE
 13148*         DATASET    (FILE-ID-ELCERT)
 13149*         FROM       (CERTIFICATE-MASTER)
 13150*         END-EXEC.
 13151     MOVE LENGTH OF
 13152      CERTIFICATE-MASTER
 13153       TO DFHEIV11
 13154*    MOVE '&& L                  %   #00012190' TO DFHEIV0
 13155     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13156     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13157     MOVE X'2020233030303132313930' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 241
* EL6311.cbl
 13158     CALL 'kxdfhei1' USING DFHEIV0,
 13159           FILE-ID-ELCERT,
 13160           CERTIFICATE-MASTER,
 13161           DFHEIV11,
 13162           DFHEIV99
 13163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13164
 13165
 13166     PERFORM 8400-LOG-JOURNAL-RECORD.
 13167
 13168 1420-CONTINUE-DELETE.
 13169     SUBTRACT PB-I-LF-PREMIUM-AMT FROM WS-B-LF-ISS-PRM-ENTERED.
 13170     SUBTRACT PB-I-LF-PREM-CALC   FROM WS-B-LF-ISS-PRM-COMPUTED.
 13171
 13172     SUBTRACT PB-I-AH-PREMIUM-AMT FROM WS-B-AH-ISS-PRM-ENTERED.
 13173     SUBTRACT PB-I-AH-PREM-CALC   FROM WS-B-AH-ISS-PRM-COMPUTED.
 13174
 13175     SUBTRACT +1 FROM WS-B-ISSUE-CNT-ENTERED.
 13176
 13177 1450-DELETE-PB-RECORD.
 13178     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID
 13179     MOVE 'D'                      TO JP-RECORD-TYPE
 13180     MOVE PENDING-BUSINESS         TO JP-RECORD-AREA.
 13181
 13182
 13183* EXEC CICS DELETE
 13184*        DATASET    (FILE-ID-ERPNDB)
 13185*    END-EXEC.
 13186*    MOVE '&(                    &   #00012211' TO DFHEIV0
 13187     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13188     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13189     MOVE X'2020233030303132323131' TO DFHEIV0(25:11)
 13190     CALL 'kxdfhei1' USING DFHEIV0,
 13191           FILE-ID-ERPNDB,
 13192           DFHEIV99,
 13193           DFHEIV99,
 13194           DFHEIV99,
 13195           DFHEIV99
 13196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13197
 13198
 13199     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 13200
 13201     PERFORM 8400-LOG-JOURNAL-RECORD.
 13202
 13203     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 13204     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 13205     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 13206
 13207
 13208* EXEC CICS HANDLE CONDITION
 13209*         NOTFND    (1480-BATCH-HDR-NOT-FOUND)
 13210*    END-EXEC.
 13211*    MOVE '"$I                   ! 1 #00012223' TO DFHEIV0
 13212     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13213     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13214     MOVE X'3120233030303132323233' TO DFHEIV0(25:11)
 13215     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 242
* EL6311.cbl
 13216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13217
 13218
 13219
 13220* EXEC CICS READ
 13221*        SET     (ADDRESS OF PENDING-BUSINESS)
 13222*        DATASET (FILE-ID-ERPNDB)
 13223*        RIDFLD  (ERPNDB-KEY)
 13224*        UPDATE
 13225*    END-EXEC.
 13226*    MOVE '&"S        EU         (   #00012227' TO DFHEIV0
 13227     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13228     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13229     MOVE X'2020233030303132323237' TO DFHEIV0(25:11)
 13230     CALL 'kxdfhei1' USING DFHEIV0,
 13231           FILE-ID-ERPNDB,
 13232           DFHEIV20,
 13233           DFHEIV99,
 13234           ERPNDB-KEY,
 13235           DFHEIV99,
 13236           DFHEIV99,
 13237           DFHEIV99
 13238     SET ADDRESS OF PENDING-BUSINESS TO
 13239         DFHEIV20
 13240     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13241
 13242
 13243     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13244
 13245     MOVE  FILE-ID-ERPNDB          TO JP-FILE-ID.
 13246
 13247     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13248        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13249        MOVE 'D'                   TO JP-RECORD-TYPE
 13250        MOVE PENDING-BUSINESS      TO JP-RECORD-AREA
 13251
 13252* EXEC CICS DELETE
 13253*            DATASET    (FILE-ID-ERPNDB)
 13254*       END-EXEC
 13255*    MOVE '&(                    &   #00012242' TO DFHEIV0
 13256     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13257     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13258     MOVE X'2020233030303132323432' TO DFHEIV0(25:11)
 13259     CALL 'kxdfhei1' USING DFHEIV0,
 13260           FILE-ID-ERPNDB,
 13261           DFHEIV99,
 13262           DFHEIV99,
 13263           DFHEIV99,
 13264           DFHEIV99
 13265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13266        PERFORM 8400-LOG-JOURNAL-RECORD
 13267     ELSE
 13268        MOVE 'B'                 TO JP-RECORD-TYPE
 13269        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 13270        PERFORM 8400-LOG-JOURNAL-RECORD
 13271        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 13272        MOVE 'C'                 TO JP-RECORD-TYPE
 13273        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 243
* EL6311.cbl
 13274
 13275* EXEC CICS REWRITE
 13276*            DATASET    (FILE-ID-ERPNDB)
 13277*            FROM       (PENDING-BUSINESS)
 13278*       END-EXEC
 13279     MOVE LENGTH OF
 13280      PENDING-BUSINESS
 13281       TO DFHEIV11
 13282*    MOVE '&& L                  %   #00012253' TO DFHEIV0
 13283     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13284     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13285     MOVE X'2020233030303132323533' TO DFHEIV0(25:11)
 13286     CALL 'kxdfhei1' USING DFHEIV0,
 13287           FILE-ID-ERPNDB,
 13288           PENDING-BUSINESS,
 13289           DFHEIV11,
 13290           DFHEIV99
 13291     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13292        PERFORM 8400-LOG-JOURNAL-RECORD.
 13293
 13294******************************************************************
 13295*                                                                *
 13296*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 13297*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 13298*                                                                *
 13299******************************************************************
 13300
 13301     IF NOT PI-AR-PROCESSING
 13302        GO TO 1475-DELETE-FINISHED.
 13303
 13304     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 13305        WS-B-CANCEL-CNT-ENTERED = ZEROS
 13306        NEXT SENTENCE
 13307     ELSE
 13308        GO TO 1475-DELETE-FINISHED.
 13309
 13310
 13311* EXEC CICS HANDLE CONDITION
 13312*         NOTFND    (1475-DELETE-FINISHED)
 13313*         END-EXEC.
 13314*    MOVE '"$I                   ! 2 #00012275' TO DFHEIV0
 13315     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 13316     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13317     MOVE X'3220233030303132323735' TO DFHEIV0(25:11)
 13318     CALL 'kxdfhei1' USING DFHEIV0
 13319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13320
 13321
 13322     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 13323     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 13324
 13325
 13326* EXEC CICS READ
 13327*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 13328*        DATASET (FILE-ID-ERRQST)
 13329*        RIDFLD  (ERRQST-KEY)
 13330*        UPDATE
 13331*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 244
* EL6311.cbl
 13332*    MOVE '&"S        EU         (   #00012282' TO DFHEIV0
 13333     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13334     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13335     MOVE X'2020233030303132323832' TO DFHEIV0(25:11)
 13336     CALL 'kxdfhei1' USING DFHEIV0,
 13337           FILE-ID-ERRQST,
 13338           DFHEIV20,
 13339           DFHEIV99,
 13340           ERRQST-KEY,
 13341           DFHEIV99,
 13342           DFHEIV99,
 13343           DFHEIV99
 13344     SET ADDRESS OF AR-REQUEST-RECORD TO
 13345         DFHEIV20
 13346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13347
 13348
 13349     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 13350
 13351     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 13352
 13353     MOVE 'D'                      TO JP-RECORD-TYPE.
 13354     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 13355
 13356
 13357* EXEC CICS DELETE
 13358*         DATASET    (FILE-ID-ERRQST)
 13359*    END-EXEC.
 13360*    MOVE '&(                    &   #00012296' TO DFHEIV0
 13361     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13362     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13363     MOVE X'2020233030303132323936' TO DFHEIV0(25:11)
 13364     CALL 'kxdfhei1' USING DFHEIV0,
 13365           FILE-ID-ERRQST,
 13366           DFHEIV99,
 13367           DFHEIV99,
 13368           DFHEIV99,
 13369           DFHEIV99
 13370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13371
 13372
 13373     PERFORM 8400-LOG-JOURNAL-RECORD.
 13374
 13375 1475-DELETE-FINISHED.
 13376     MOVE ZEROS                  TO EMI-ERROR.
 13377     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13378     MOVE LOW-VALUES             TO EL631BI.
 13379     MOVE -1                     TO BMAINTL.
 13380     GO TO 8100-SEND-INITIAL-MAP.
 13381
 13382 1480-BATCH-HDR-NOT-FOUND.
 13383     MOVE -1                     TO BMAINTL.
 13384     MOVE ER-7450                TO EMI-ERROR.
 13385     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13386     GO TO 8200-SEND-DATAONLY.
 13387
 13388 1490-RECORD-NOT-FOUND.
 13389     MOVE -1                     TO BMAINTL.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 245
* EL6311.cbl
 13390     MOVE ER-7451                TO EMI-ERROR.
 13391     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13392     GO TO 8200-SEND-DATAONLY.
 13393
 13394******************************************************************
 13395*            O V E R   C H A R G E   P R O C E S S I N G         *
 13396******************************************************************
 13397 1500-UPDATE-ERNOTE.
 13398     PERFORM 1510-ADD-ERNOTE-REC THRU 1510-EXIT
 13399     MOVE 'A'                    TO WS-NOTE-SW
 13400     PERFORM 1520-UPDATE-ELCERT  THRU 1520-EXIT
 13401     .
 13402 1500-EXIT.
 13403     EXIT.
 13404 1510-ADD-ERNOTE-REC.
 13405
 13406* EXEC CICS GETMAIN
 13407*        SET     (ADDRESS OF CERTIFICATE-NOTE)
 13408*        LENGTH  (ERNOTE-RECORD-LENGTH)
 13409*        INITIMG (GETMAIN-SPACE)
 13410*    END-EXEC
 13411*    MOVE ',"IL                  $   #00012332' TO DFHEIV0
 13412     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13413     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13414     MOVE X'2020233030303132333332' TO DFHEIV0(25:11)
 13415     CALL 'kxdfhei1' USING DFHEIV0,
 13416           DFHEIV20,
 13417           ERNOTE-RECORD-LENGTH,
 13418           GETMAIN-SPACE
 13419     SET ADDRESS OF CERTIFICATE-NOTE TO
 13420         DFHEIV20
 13421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13422     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13423                                 TO ERNOTE-KEY
 13424
 13425* EXEC CICS READ
 13426*       DATASET    (FILE-ID-ERNOTE)
 13427*       RIDFLD     (ERNOTE-KEY)
 13428*       INTO       (CERTIFICATE-NOTE)
 13429*       RESP       (WS-RESPONSE)
 13430*       UPDATE
 13431*    END-EXEC
 13432     MOVE LENGTH OF
 13433      CERTIFICATE-NOTE
 13434       TO DFHEIV11
 13435*    MOVE '&"IL       EU         (  N#00012339' TO DFHEIV0
 13436     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 13437     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13438     MOVE X'204E233030303132333339' TO DFHEIV0(25:11)
 13439     CALL 'kxdfhei1' USING DFHEIV0,
 13440           FILE-ID-ERNOTE,
 13441           CERTIFICATE-NOTE,
 13442           DFHEIV11,
 13443           ERNOTE-KEY,
 13444           DFHEIV99,
 13445           DFHEIV99,
 13446           DFHEIV99
 13447     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 246
* EL6311.cbl
 13448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13449     IF RESP-NORMAL
 13450        IF CN-BILLING-START-LINE-NO NOT NUMERIC
 13451           MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 13452        END-IF
 13453        IF CN-BILLING-END-LINE-NO NOT NUMERIC
 13454           MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 13455        END-IF
 13456        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13457           (N1 > +10)
 13458           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13459           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13460        END-PERFORM
 13461        IF (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13462          OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13463
 13464* EXEC CICS UNLOCK
 13465*            DATASET    (FILE-ID-ERNOTE)
 13466*          END-EXEC
 13467*    MOVE '&*                    #   #00012360' TO DFHEIV0
 13468     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 13469     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 13470     MOVE X'2020233030303132333630' TO DFHEIV0(25:11)
 13471     CALL 'kxdfhei1' USING DFHEIV0,
 13472           FILE-ID-ERNOTE,
 13473           DFHEIV99
 13474     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13475        ELSE
 13476          PERFORM VARYING N1 FROM +1 BY +1
 13477           UNTIL (N1 > +10)
 13478           OR (CN-LINE (N1) = SPACES OR LOW-VALUES)
 13479          END-PERFORM
 13480          IF (N1 < +11)
 13481            IF N1 >= CN-BILLING-START-LINE-NO AND
 13482              N1 <= CN-BILLING-END-LINE-NO
 13483              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13484                 MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13485              ELSE
 13486                 MOVE WS-VA-NO-COMM-MESS
 13487                                    TO CN-LINE (N1)
 13488              END-IF
 13489            ELSE
 13490              IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 13491               (N1 = (CN-BILLING-END-LINE-NO + +1))
 13492                IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13493                  MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13494                ELSE
 13495                  MOVE WS-VA-NO-COMM-MESS
 13496                                    TO CN-LINE (N1)
 13497                END-IF
 13498                MOVE N1             TO CN-BILLING-END-LINE-NO
 13499              ELSE
 13500                IF (CN-BILLING-END-LINE-NO = ZEROS)
 13501                  IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13502                     MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13503                  ELSE
 13504                     MOVE WS-VA-NO-COMM-MESS
 13505                                    TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 247
* EL6311.cbl
 13506                  END-IF
 13507                  MOVE N1            TO CN-BILLING-END-LINE-NO
 13508                                      CN-BILLING-START-LINE-NO
 13509                ELSE
 13510                  IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 13511                    (N1 = (CN-BILLING-START-LINE-NO - +1))
 13512                     IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13513                       MOVE WS-OC-MESSAGE TO CN-LINE (N1)
 13514                     ELSE
 13515                       MOVE WS-VA-NO-COMM-MESS
 13516                                    TO CN-LINE (N1)
 13517                     END-IF
 13518                     MOVE N1         TO CN-BILLING-START-LINE-NO
 13519                  ELSE
 13520                     PERFORM 1700-SQUEEZE-IT-IN
 13521                                 THRU 1700-EXIT
 13522                  END-IF
 13523                END-IF
 13524              END-IF
 13525            END-IF
 13526            MOVE 'E631'              TO CN-LAST-MAINT-USER
 13527            MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13528            MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13529
 13530* EXEC CICS REWRITE
 13531*              DATASET    (FILE-ID-ERNOTE)
 13532*              FROM       (CERTIFICATE-NOTE)
 13533*              RESP       (WS-RESPONSE)
 13534*           END-EXEC
 13535     MOVE LENGTH OF
 13536      CERTIFICATE-NOTE
 13537       TO DFHEIV11
 13538*    MOVE '&& L                  %  N#00012417' TO DFHEIV0
 13539     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13540     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13541     MOVE X'204E233030303132343137' TO DFHEIV0(25:11)
 13542     CALL 'kxdfhei1' USING DFHEIV0,
 13543           FILE-ID-ERNOTE,
 13544           CERTIFICATE-NOTE,
 13545           DFHEIV11,
 13546           DFHEIV99
 13547     MOVE EIBRESP  TO WS-RESPONSE
 13548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13549          END-IF
 13550        END-IF
 13551     ELSE
 13552        MOVE SPACES              TO CERTIFICATE-NOTE
 13553        MOVE 'CN'                TO CN-RECORD-ID
 13554        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13555                                 TO CN-CONTROL-PRIMARY
 13556                                    ERNOTE-KEY
 13557        MOVE 01                  TO CN-BILLING-START-LINE-NO
 13558                                    CN-BILLING-END-LINE-NO
 13559        IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13560           MOVE WS-OC-MESSAGE    TO CN-LINE (1)
 13561        ELSE
 13562           MOVE WS-VA-NO-COMM-MESS
 13563                                 TO CN-LINE (1)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 248
* EL6311.cbl
 13564        END-IF
 13565        MOVE 'E631'              TO CN-LAST-MAINT-USER
 13566        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
 13567        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 13568
 13569* EXEC CICS WRITE
 13570*          DATASET    (FILE-ID-ERNOTE)
 13571*          FROM       (CERTIFICATE-NOTE)
 13572*          RIDFLD     (ERNOTE-KEY)
 13573*          RESP       (WS-RESPONSE)
 13574*       END-EXEC
 13575     MOVE LENGTH OF
 13576      CERTIFICATE-NOTE
 13577       TO DFHEIV11
 13578*    MOVE '&$ L                  ''  N#00012441' TO DFHEIV0
 13579     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13580     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13581     MOVE X'204E233030303132343431' TO DFHEIV0(25:11)
 13582     CALL 'kxdfhei1' USING DFHEIV0,
 13583           FILE-ID-ERNOTE,
 13584           CERTIFICATE-NOTE,
 13585           DFHEIV11,
 13586           ERNOTE-KEY,
 13587           DFHEIV99,
 13588           DFHEIV99
 13589     MOVE EIBRESP  TO WS-RESPONSE
 13590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13591     END-IF
 13592     .
 13593 1510-EXIT.
 13594     EXIT.
 13595 1520-UPDATE-ELCERT.
 13596     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13597                                 TO ELCERT-KEY
 13598
 13599* EXEC CICS READ
 13600*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 13601*        DATASET (FILE-ID-ELCERT)
 13602*        RIDFLD  (ELCERT-KEY)
 13603*        UPDATE
 13604*        RESP    (WS-RESPONSE)
 13605*    END-EXEC
 13606*    MOVE '&"S        EU         (  N#00012454' TO DFHEIV0
 13607     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13608     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13609     MOVE X'204E233030303132343534' TO DFHEIV0(25:11)
 13610     CALL 'kxdfhei1' USING DFHEIV0,
 13611           FILE-ID-ELCERT,
 13612           DFHEIV20,
 13613           DFHEIV99,
 13614           ELCERT-KEY,
 13615           DFHEIV99,
 13616           DFHEIV99,
 13617           DFHEIV99
 13618     SET ADDRESS OF CERTIFICATE-MASTER TO
 13619         DFHEIV20
 13620     MOVE EIBRESP  TO WS-RESPONSE
 13621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 249
* EL6311.cbl
 13622     IF RESP-NORMAL
 13623        IF WS-NOTE-SW = 'A'
 13624           IF CM-NOTE-SW = ' '
 13625              MOVE '2'             TO CM-NOTE-SW
 13626           ELSE
 13627             IF CM-NOTE-SW = '1'
 13628                MOVE '3'           TO CM-NOTE-SW
 13629             ELSE
 13630               IF CM-NOTE-SW = '4'
 13631                  MOVE '6'         TO CM-NOTE-SW
 13632               ELSE
 13633                 IF CM-NOTE-SW = '5'
 13634                    MOVE '7'       TO CM-NOTE-SW
 13635                 END-IF
 13636               END-IF
 13637             END-IF
 13638           END-IF
 13639        ELSE
 13640           IF CM-NOTE-SW = '2'
 13641              MOVE ' '             TO CM-NOTE-SW
 13642           ELSE
 13643             IF CM-NOTE-SW = '3'
 13644                MOVE '1'           TO CM-NOTE-SW
 13645             ELSE
 13646               IF CM-NOTE-SW = '6'
 13647                  MOVE '4'         TO CM-NOTE-SW
 13648               ELSE
 13649                 IF CM-NOTE-SW = '7'
 13650                    MOVE '5'       TO CM-NOTE-SW
 13651                 END-IF
 13652               END-IF
 13653             END-IF
 13654           END-IF
 13655        END-IF
 13656
 13657* EXEC CICS REWRITE
 13658*          DATASET    (FILE-ID-ELCERT)
 13659*          FROM       (CERTIFICATE-MASTER)
 13660*          RESP       (WS-RESPONSE)
 13661*       END-EXEC
 13662     MOVE LENGTH OF
 13663      CERTIFICATE-MASTER
 13664       TO DFHEIV11
 13665*    MOVE '&& L                  %  N#00012495' TO DFHEIV0
 13666     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13667     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13668     MOVE X'204E233030303132343935' TO DFHEIV0(25:11)
 13669     CALL 'kxdfhei1' USING DFHEIV0,
 13670           FILE-ID-ELCERT,
 13671           CERTIFICATE-MASTER,
 13672           DFHEIV11,
 13673           DFHEIV99
 13674     MOVE EIBRESP  TO WS-RESPONSE
 13675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13676        IF RESP-NORMAL
 13677           CONTINUE
 13678        ELSE
 13679           MOVE WS-RESPONSE TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 250
* EL6311.cbl
 13680           PERFORM 9900-ERROR-FORMAT
 13681                                 THRU 9900-EXIT
 13682           GO TO 8200-SEND-DATAONLY
 13683        END-IF
 13684     ELSE
 13685        MOVE -1                  TO BMAINTL
 13686        MOVE 0249                TO EMI-ERROR
 13687        PERFORM 9900-ERROR-FORMAT
 13688                                 THRU 9900-EXIT
 13689        GO TO 8200-SEND-DATAONLY
 13690     END-IF
 13691     .
 13692 1520-EXIT.
 13693     EXIT.
 13694 1600-UPDATE-ERPYAJ.
 13695     PERFORM 1610-ADD-ERPYAJ-BANK-REC
 13696                                 THRU 1610-EXIT
 13697     PERFORM 1620-ADD-ERPYAJ-DLR-REC
 13698                                 THRU 1620-EXIT
 13699     .
 13700 1600-EXIT.
 13701     EXIT.
 13702 1610-ADD-ERPYAJ-BANK-REC.
 13703
 13704* EXEC CICS GETMAIN
 13705*        SET     (ADDRESS OF PENDING-PAY-ADJ)
 13706*        LENGTH  (ERPYAJ-RECORD-LENGTH)
 13707*        INITIMG (GETMAIN-SPACE)
 13708*    END-EXEC
 13709*    MOVE ',"IL                  $   #00012527' TO DFHEIV0
 13710     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 13711     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13712     MOVE X'2020233030303132353237' TO DFHEIV0(25:11)
 13713     CALL 'kxdfhei1' USING DFHEIV0,
 13714           DFHEIV20,
 13715           ERPYAJ-RECORD-LENGTH,
 13716           GETMAIN-SPACE
 13717     SET ADDRESS OF PENDING-PAY-ADJ TO
 13718         DFHEIV20
 13719     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13720     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13721     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13722     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13723     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13724     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13725     MOVE +10                    TO ERPYAJ-SEQ-NO
 13726     MOVE 'R'                    TO ERPYAJ-TYPE
 13727     IF REVERSAL
 13728        MOVE 'C'                 TO ERPYAJ-TYPE
 13729     END-IF
 13730     MOVE SPACES                 TO PENDING-PAY-ADJ
 13731     MOVE 'PY'                   TO PY-RECORD-ID
 13732     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13733     MOVE WS-OC-AMT              TO PY-ENTRY-AMT
 13734     IF REVERSAL
 13735        MOVE PB-I-DCC-OVER-CHG-AMT
 13736                                 TO PY-ENTRY-AMT
 13737     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 251
* EL6311.cbl
 13738     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT
 13739                                    PY-INPUT-DT
 13740*    MOVE X'A15F'                TO PY-LAST-MAINT-DT
 13741*                                   PY-INPUT-DT
 13742     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY
 13743     MOVE PI-CR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT
 13744     MOVE 'OVERCHARGE'           TO PY-GL-COMMENT
 13745     MOVE 'B'                    TO PY-ERCOMP-TYPE
 13746     IF PB-CARRIER = '2'
 13747        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13748     ELSE
 13749        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13750     END-IF
 13751     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT
 13752                                    PY-BILLED-DATE
 13753                                    PY-AR-DATE
 13754                                    PY-REPORTED-DT
 13755                                    PY-CHECK-WRITTEN-DT
 13756     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL
 13757                                    PY-CHECK-QUE-SEQUENCE
 13758     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS
 13759     PERFORM WITH TEST AFTER
 13760        UNTIL (NOT RESP-DUPKEY)
 13761           AND (NOT RESP-DUPREC)
 13762
 13763* EXEC CICS WRITE
 13764*          DATASET    (FILE-ID-ERPYAJ)
 13765*          FROM       (PENDING-PAY-ADJ)
 13766*          RIDFLD     (ERPYAJ-KEY)
 13767*          RESP       (WS-RESPONSE)
 13768*       END-EXEC
 13769     MOVE LENGTH OF
 13770      PENDING-PAY-ADJ
 13771       TO DFHEIV11
 13772*    MOVE '&$ L                  ''  N#00012574' TO DFHEIV0
 13773     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13774     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13775     MOVE X'204E233030303132353734' TO DFHEIV0(25:11)
 13776     CALL 'kxdfhei1' USING DFHEIV0,
 13777           FILE-ID-ERPYAJ,
 13778           PENDING-PAY-ADJ,
 13779           DFHEIV11,
 13780           ERPYAJ-KEY,
 13781           DFHEIV99,
 13782           DFHEIV99
 13783     MOVE EIBRESP  TO WS-RESPONSE
 13784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13785        IF RESP-DUPKEY OR RESP-DUPREC
 13786           ADD +1                TO ERPYAJ-SEQ-NO
 13787           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13788        END-IF
 13789     END-PERFORM
 13790     .
 13791 1610-EXIT.
 13792     EXIT.
 13793 1620-ADD-ERPYAJ-DLR-REC.
 13794     MOVE 'C'                    TO ERPYAJ-TYPE
 13795     IF REVERSAL
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 252
* EL6311.cbl
 13796        MOVE 'R'                 TO ERPYAJ-TYPE
 13797     END-IF
 13798     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 13799                                    ERPYAJ-ACCOUNT
 13800     ADD +1                      TO ERPYAJ-SEQ-NO
 13801     MOVE ERPYAJ-KEY             TO PY-CONTROL-PRIMARY
 13802     MOVE 'A'                    TO PY-ERCOMP-TYPE
 13803     IF PB-CARRIER = '2'
 13804        MOVE '2725040330'        TO PY-GL-ACCOUNT
 13805     ELSE
 13806        MOVE '2725040130'        TO PY-GL-ACCOUNT
 13807     END-IF
 13808     PERFORM WITH TEST AFTER
 13809        UNTIL (NOT RESP-DUPKEY)
 13810           AND (NOT RESP-DUPREC)
 13811
 13812* EXEC CICS WRITE
 13813*          DATASET    (FILE-ID-ERPYAJ)
 13814*          FROM       (PENDING-PAY-ADJ)
 13815*          RIDFLD     (ERPYAJ-KEY)
 13816*          RESP       (WS-RESPONSE)
 13817*       END-EXEC
 13818     MOVE LENGTH OF
 13819      PENDING-PAY-ADJ
 13820       TO DFHEIV11
 13821*    MOVE '&$ L                  ''  N#00012606' TO DFHEIV0
 13822     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 13823     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 13824     MOVE X'204E233030303132363036' TO DFHEIV0(25:11)
 13825     CALL 'kxdfhei1' USING DFHEIV0,
 13826           FILE-ID-ERPYAJ,
 13827           PENDING-PAY-ADJ,
 13828           DFHEIV11,
 13829           ERPYAJ-KEY,
 13830           DFHEIV99,
 13831           DFHEIV99
 13832     MOVE EIBRESP  TO WS-RESPONSE
 13833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13834        IF RESP-DUPKEY OR RESP-DUPREC
 13835           ADD +1                TO ERPYAJ-SEQ-NO
 13836           MOVE ERPYAJ-SEQ-NO    TO PY-FILE-SEQ-NO
 13837        END-IF
 13838     END-PERFORM
 13839     .
 13840 1620-EXIT.
 13841     EXIT.
 13842 1700-SQUEEZE-IT-IN.
 13843     IF (N1 > CN-BILLING-END-LINE-NO)
 13844        PERFORM VARYING N1 FROM N1 BY -1 UNTIL
 13845           N1 = +1
 13846           MOVE CN-LINE (N1 - 1)    TO CN-LINE (N1)
 13847           IF (N1 - 1) = (CN-BILLING-END-LINE-NO + 1)
 13848              IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13849                 MOVE WS-OC-MESSAGE TO CN-LINE (N1 - 1)
 13850              ELSE
 13851                 MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 - 1)
 13852              END-IF
 13853              COMPUTE CN-BILLING-END-LINE-NO = N1 - 1
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 253
* EL6311.cbl
 13854              MOVE +2 TO N1
 13855           END-IF
 13856        END-PERFORM
 13857     ELSE
 13858        IF (N1 < CN-BILLING-START-LINE-NO)
 13859           PERFORM VARYING N1 FROM N1 BY +1 UNTIL
 13860              N1 = +10
 13861              MOVE CN-LINE (N1 + 1) TO CN-LINE (N1)
 13862              IF (N1 + 1) = (CN-BILLING-START-LINE-NO - 1)
 13863                 IF PI-COMPANY-ID = 'DCC' or 'VPP'
 13864                    MOVE WS-OC-MESSAGE TO CN-LINE (N1 + 1)
 13865                 ELSE
 13866                    MOVE WS-VA-NO-COMM-MESS TO CN-LINE (N1 + 1)
 13867                 END-IF
 13868                 COMPUTE CN-BILLING-START-LINE-NO = N1 + 1
 13869                 MOVE +9 TO N1
 13870              END-IF
 13871           END-PERFORM
 13872        END-IF
 13873     END-IF
 13874     .
 13875 1700-EXIT.
 13876     EXIT.
 13877 1800-REMOVE-CERT-NOTES.
 13878     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 13879                                 TO ERNOTE-KEY
 13880
 13881* EXEC CICS READ
 13882*       SET        (ADDRESS OF CERTIFICATE-NOTE)
 13883*       DATASET    (FILE-ID-ERNOTE)
 13884*       RIDFLD     (ERNOTE-KEY)
 13885*       RESP       (WS-RESPONSE)
 13886*       UPDATE
 13887*    END-EXEC
 13888*    MOVE '&"S        EU         (  N#00012658' TO DFHEIV0
 13889     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13890     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 13891     MOVE X'204E233030303132363538' TO DFHEIV0(25:11)
 13892     CALL 'kxdfhei1' USING DFHEIV0,
 13893           FILE-ID-ERNOTE,
 13894           DFHEIV20,
 13895           DFHEIV99,
 13896           ERNOTE-KEY,
 13897           DFHEIV99,
 13898           DFHEIV99,
 13899           DFHEIV99
 13900     SET ADDRESS OF CERTIFICATE-NOTE TO
 13901         DFHEIV20
 13902     MOVE EIBRESP  TO WS-RESPONSE
 13903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13904     IF RESP-NORMAL
 13905        PERFORM VARYING N1 FROM +1 BY +1 UNTIL
 13906           (N1 > +10)
 13907           OR (CN-LINE (N1) (1:10) = 'OVERCHARGE')
 13908           OR (CN-LINE (N1) (1:20) = 'MAXIMUM AGE EXCEEDED')
 13909        END-PERFORM
 13910        IF N1 < +11
 13911           MOVE SPACES              TO CN-LINE (N1)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 254
* EL6311.cbl
 13912           IF N1 >= CN-BILLING-START-LINE-NO  AND
 13913              N1 <= CN-BILLING-END-LINE-NO
 13914              SUBTRACT 1 FROM CN-BILLING-END-LINE-NO
 13915              IF CN-BILLING-END-LINE-NO <
 13916                               CN-BILLING-START-LINE-NO
 13917                 MOVE ZEROS         TO CN-BILLING-END-LINE-NO
 13918                                     CN-BILLING-START-LINE-NO
 13919              END-IF
 13920              PERFORM 1820-SQUEEZE-ERNOTE
 13921                                  THRU 1820-EXIT
 13922           END-IF
 13923           IF CN-LINES = SPACES
 13924
 13925* EXEC CICS DELETE
 13926*                DATASET    (FILE-ID-ERNOTE)
 13927*                RESP       (WS-RESPONSE)
 13928*             END-EXEC
 13929*    MOVE '&(                    &  N#00012685' TO DFHEIV0
 13930     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 13931     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13932     MOVE X'204E233030303132363835' TO DFHEIV0(25:11)
 13933     CALL 'kxdfhei1' USING DFHEIV0,
 13934           FILE-ID-ERNOTE,
 13935           DFHEIV99,
 13936           DFHEIV99,
 13937           DFHEIV99,
 13938           DFHEIV99
 13939     MOVE EIBRESP  TO WS-RESPONSE
 13940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13941              IF RESP-NORMAL
 13942                 MOVE 'D'        TO WS-NOTE-SW
 13943                 PERFORM 1520-UPDATE-ELCERT
 13944                                 THRU 1520-EXIT
 13945              END-IF
 13946           ELSE
 13947
 13948* EXEC CICS REWRITE
 13949*                DATASET    (FILE-ID-ERNOTE)
 13950*                FROM       (CERTIFICATE-NOTE)
 13951*                RESP       (WS-RESPONSE)
 13952*             END-EXEC
 13953     MOVE LENGTH OF
 13954      CERTIFICATE-NOTE
 13955       TO DFHEIV11
 13956*    MOVE '&& L                  %  N#00012695' TO DFHEIV0
 13957     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 13958     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 13959     MOVE X'204E233030303132363935' TO DFHEIV0(25:11)
 13960     CALL 'kxdfhei1' USING DFHEIV0,
 13961           FILE-ID-ERNOTE,
 13962           CERTIFICATE-NOTE,
 13963           DFHEIV11,
 13964           DFHEIV99
 13965     MOVE EIBRESP  TO WS-RESPONSE
 13966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13967           END-IF
 13968        END-IF
 13969     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 255
* EL6311.cbl
 13970     .
 13971 1800-EXIT.
 13972     EXIT.
 13973 1820-SQUEEZE-ERNOTE.
 13974     MOVE CN-BILLING-START-LINE-NO TO N2
 13975     IF N2 = 0
 13976         MOVE +1                 TO N2
 13977     END-IF
 13978     PERFORM VARYING N1 FROM N2 BY +1 UNTIL
 13979        (N1 > +9)
 13980        IF CN-LINE (N1) = SPACES
 13981           MOVE CN-LINE (N1 + +1)
 13982                                 TO CN-LINE (N1)
 13983           MOVE SPACES           TO CN-LINE (N1 + +1)
 13984        END-IF
 13985     END-PERFORM
 13986     .
 13987 1820-EXIT.
 13988     EXIT.
 13989 1900-DELETE-ERPYAJ.
 13990     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 13991     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 13992     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 13993     MOVE PB-I-BANK-NUMBER       TO ERPYAJ-FIN-RESP
 13994     MOVE LOW-VALUES             TO ERPYAJ-ACCOUNT
 13995     MOVE +10                    TO ERPYAJ-SEQ-NO
 13996     MOVE 'R'                    TO ERPYAJ-TYPE
 13997     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 13998
 13999* EXEC CICS STARTBR
 14000*       DATASET    (FILE-ID-ERPYAJ)
 14001*       RIDFLD     (ERPYAJ-KEY)
 14002*       RESP       (WS-RESPONSE)
 14003*    END-EXEC
 14004     MOVE 0
 14005       TO DFHEIV11
 14006*    MOVE '&,         G          &  N#00012731' TO DFHEIV0
 14007     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14008     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14009     MOVE X'204E233030303132373331' TO DFHEIV0(25:11)
 14010     CALL 'kxdfhei1' USING DFHEIV0,
 14011           FILE-ID-ERPYAJ,
 14012           ERPYAJ-KEY,
 14013           DFHEIV99,
 14014           DFHEIV11,
 14015           DFHEIV99
 14016     MOVE EIBRESP  TO WS-RESPONSE
 14017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14018     IF RESP-NORMAL
 14019        CONTINUE
 14020     ELSE
 14021        GO TO 1900-GET-DEALER
 14022     END-IF
 14023     .
 14024 1900-READNEXT-ERPYAJ-B.
 14025*  GET THE BANK ERPYAJ RECORD
 14026
 14027* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 256
* EL6311.cbl
 14028*       DATASET    (FILE-ID-ERPYAJ)
 14029*       RIDFLD     (ERPYAJ-KEY)
 14030*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14031*       RESP       (WS-RESPONSE)
 14032*    END-EXEC
 14033     MOVE 0
 14034       TO DFHEIV11
 14035*    MOVE '&.S                   )  N#00012744' TO DFHEIV0
 14036     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14037     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14038     MOVE X'204E233030303132373434' TO DFHEIV0(25:11)
 14039     CALL 'kxdfhei1' USING DFHEIV0,
 14040           FILE-ID-ERPYAJ,
 14041           DFHEIV20,
 14042           DFHEIV99,
 14043           ERPYAJ-KEY,
 14044           DFHEIV99,
 14045           DFHEIV11,
 14046           DFHEIV99,
 14047           DFHEIV99
 14048     SET ADDRESS OF PENDING-PAY-ADJ TO
 14049         DFHEIV20
 14050     MOVE EIBRESP  TO WS-RESPONSE
 14051     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14052     IF RESP-NORMAL
 14053        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14054           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14055              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14056                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14057
 14058* EXEC CICS READ
 14059*                   DATASET    (FILE-ID-ERPYAJ)
 14060*                   RIDFLD     (ERPYAJ-KEY)
 14061*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14062*                   RESP       (WS-RESPONSE)
 14063*                   UPDATE
 14064*                END-EXEC
 14065*    MOVE '&"S        EU         (  N#00012755' TO DFHEIV0
 14066     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14067     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14068     MOVE X'204E233030303132373535' TO DFHEIV0(25:11)
 14069     CALL 'kxdfhei1' USING DFHEIV0,
 14070           FILE-ID-ERPYAJ,
 14071           DFHEIV20,
 14072           DFHEIV99,
 14073           ERPYAJ-KEY,
 14074           DFHEIV99,
 14075           DFHEIV99,
 14076           DFHEIV99
 14077     SET ADDRESS OF PENDING-PAY-ADJ TO
 14078         DFHEIV20
 14079     MOVE EIBRESP  TO WS-RESPONSE
 14080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14081                 IF RESP-NORMAL
 14082
 14083* EXEC CICS DELETE
 14084*                      DATASET   (FILE-ID-ERPYAJ)
 14085*                      RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 257
* EL6311.cbl
 14086*                   END-EXEC
 14087*    MOVE '&(                    &  N#00012763' TO DFHEIV0
 14088     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14089     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14090     MOVE X'204E233030303132373633' TO DFHEIV0(25:11)
 14091     CALL 'kxdfhei1' USING DFHEIV0,
 14092           FILE-ID-ERPYAJ,
 14093           DFHEIV99,
 14094           DFHEIV99,
 14095           DFHEIV99,
 14096           DFHEIV99
 14097     MOVE EIBRESP  TO WS-RESPONSE
 14098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14099                 END-IF
 14100              ELSE
 14101                 SET REVERSAL    TO TRUE
 14102                 PERFORM 1600-UPDATE-ERPYAJ
 14103                                 THRU 1600-EXIT
 14104                 GO TO 1900-EXIT
 14105              END-IF
 14106           ELSE
 14107              GO TO 1900-READNEXT-ERPYAJ-B
 14108           END-IF
 14109        END-IF
 14110
 14111* EXEC CICS ENDBR
 14112*          DATASET   (FILE-ID-ERPYAJ)
 14113*       END-EXEC
 14114     MOVE 0
 14115       TO DFHEIV11
 14116*    MOVE '&2                    $   #00012778' TO DFHEIV0
 14117     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14118     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14119     MOVE X'2020233030303132373738' TO DFHEIV0(25:11)
 14120     CALL 'kxdfhei1' USING DFHEIV0,
 14121           FILE-ID-ERPYAJ,
 14122           DFHEIV11,
 14123           DFHEIV99
 14124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14125     END-IF
 14126     .
 14127 1900-GET-DEALER.
 14128     MOVE PB-COMPANY-CD          TO ERPYAJ-COMPANY-CD
 14129     MOVE PB-CARRIER             TO ERPYAJ-CARRIER
 14130     MOVE PB-GROUPING            TO ERPYAJ-GROUPING
 14131     MOVE PB-ACCOUNT             TO ERPYAJ-FIN-RESP
 14132     MOVE PB-ACCOUNT             TO ERPYAJ-ACCOUNT
 14133     MOVE +10                    TO ERPYAJ-SEQ-NO
 14134     MOVE 'C'                    TO ERPYAJ-TYPE
 14135     MOVE ERPYAJ-KEY             TO WS-SAVE-ERPYAJ-KEY
 14136
 14137* EXEC CICS STARTBR
 14138*       DATASET    (FILE-ID-ERPYAJ)
 14139*       RIDFLD     (ERPYAJ-KEY)
 14140*       RESP       (WS-RESPONSE)
 14141*    END-EXEC
 14142     MOVE 0
 14143       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 258
* EL6311.cbl
 14144*    MOVE '&,         G          &  N#00012792' TO DFHEIV0
 14145     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14146     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14147     MOVE X'204E233030303132373932' TO DFHEIV0(25:11)
 14148     CALL 'kxdfhei1' USING DFHEIV0,
 14149           FILE-ID-ERPYAJ,
 14150           ERPYAJ-KEY,
 14151           DFHEIV99,
 14152           DFHEIV11,
 14153           DFHEIV99
 14154     MOVE EIBRESP  TO WS-RESPONSE
 14155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14156     IF RESP-NORMAL
 14157        CONTINUE
 14158     ELSE
 14159        GO TO 1900-EXIT
 14160     END-IF
 14161     .
 14162 1900-READNEXT-ERPYAJ-D.
 14163*  GET THE DEALER ERPYAJ RECORD
 14164
 14165* EXEC CICS READNEXT
 14166*       DATASET    (FILE-ID-ERPYAJ)
 14167*       RIDFLD     (ERPYAJ-KEY)
 14168*       SET        (ADDRESS OF PENDING-PAY-ADJ)
 14169*       RESP       (WS-RESPONSE)
 14170*    END-EXEC
 14171     MOVE 0
 14172       TO DFHEIV11
 14173*    MOVE '&.S                   )  N#00012805' TO DFHEIV0
 14174     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14175     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14176     MOVE X'204E233030303132383035' TO DFHEIV0(25:11)
 14177     CALL 'kxdfhei1' USING DFHEIV0,
 14178           FILE-ID-ERPYAJ,
 14179           DFHEIV20,
 14180           DFHEIV99,
 14181           ERPYAJ-KEY,
 14182           DFHEIV99,
 14183           DFHEIV11,
 14184           DFHEIV99,
 14185           DFHEIV99
 14186     SET ADDRESS OF PENDING-PAY-ADJ TO
 14187         DFHEIV20
 14188     MOVE EIBRESP  TO WS-RESPONSE
 14189     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14190     IF RESP-NORMAL
 14191        IF PY-CONTROL-PRIMARY (1:28) = WS-SAVE-ERPYAJ-KEY (1:28)
 14192           IF (PB-I-DCC-OVER-CHG-AMT = PY-ENTRY-AMT)
 14193              IF (PY-INPUT-DT = WS-CURRENT-BIN-DT)
 14194                 AND (PY-LAST-MAINT-BY = PI-PROCESSOR-ID)
 14195
 14196* EXEC CICS READ
 14197*                   DATASET    (FILE-ID-ERPYAJ)
 14198*                   RIDFLD     (ERPYAJ-KEY)
 14199*                   SET        (ADDRESS OF PENDING-PAY-ADJ)
 14200*                   RESP       (WS-RESPONSE)
 14201*                   UPDATE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 259
* EL6311.cbl
 14202*                END-EXEC
 14203*    MOVE '&"S        EU         (  N#00012816' TO DFHEIV0
 14204     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14205     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 14206     MOVE X'204E233030303132383136' TO DFHEIV0(25:11)
 14207     CALL 'kxdfhei1' USING DFHEIV0,
 14208           FILE-ID-ERPYAJ,
 14209           DFHEIV20,
 14210           DFHEIV99,
 14211           ERPYAJ-KEY,
 14212           DFHEIV99,
 14213           DFHEIV99,
 14214           DFHEIV99
 14215     SET ADDRESS OF PENDING-PAY-ADJ TO
 14216         DFHEIV20
 14217     MOVE EIBRESP  TO WS-RESPONSE
 14218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14219                 IF RESP-NORMAL
 14220
 14221* EXEC CICS DELETE
 14222*                      DATASET   (FILE-ID-ERPYAJ)
 14223*                      RESP      (WS-RESPONSE)
 14224*                   END-EXEC
 14225*    MOVE '&(                    &  N#00012824' TO DFHEIV0
 14226     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 14227     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14228     MOVE X'204E233030303132383234' TO DFHEIV0(25:11)
 14229     CALL 'kxdfhei1' USING DFHEIV0,
 14230           FILE-ID-ERPYAJ,
 14231           DFHEIV99,
 14232           DFHEIV99,
 14233           DFHEIV99,
 14234           DFHEIV99
 14235     MOVE EIBRESP  TO WS-RESPONSE
 14236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14237                 END-IF
 14238              ELSE
 14239                 SET REVERSAL    TO TRUE
 14240              END-IF
 14241           ELSE
 14242              GO TO 1900-READNEXT-ERPYAJ-D
 14243           END-IF
 14244        END-IF
 14245
 14246* EXEC CICS ENDBR
 14247*          DATASET   (FILE-ID-ERPYAJ)
 14248*       END-EXEC
 14249     MOVE 0
 14250       TO DFHEIV11
 14251*    MOVE '&2                    $   #00012836' TO DFHEIV0
 14252     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14253     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14254     MOVE X'2020233030303132383336' TO DFHEIV0(25:11)
 14255     CALL 'kxdfhei1' USING DFHEIV0,
 14256           FILE-ID-ERPYAJ,
 14257           DFHEIV11,
 14258           DFHEIV99
 14259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 260
* EL6311.cbl
 14260     END-IF
 14261     .
 14262 1900-EXIT.
 14263     EXIT.
 14264******************************************************************
 14265*            C A N C E L   M A I N L I N E                       *
 14266******************************************************************
 14267
 14268 2000-CANCEL-MAINLINE.
 14269     IF PI-DISPLAY-ORIGINAL-BATCH
 14270        IF CMAINTI NOT = 'C' AND 'D' AND 'S' AND 'K'
 14271           MOVE ER-0023             TO EMI-ERROR
 14272           MOVE -1                  TO CMAINTL
 14273           MOVE AL-UABON            TO CMAINTA
 14274           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14275           GO TO 8200-SEND-DATAONLY
 14276        ELSE
 14277           NEXT SENTENCE
 14278     ELSE
 14279        IF CMAINTI NOT = 'A' AND 'C' AND 'D' AND 'S' AND 'K'
 14280           MOVE ER-0023             TO EMI-ERROR
 14281           MOVE -1                  TO CMAINTL
 14282           MOVE AL-UABON            TO CMAINTA
 14283           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14284           GO TO 8200-SEND-DATAONLY.
 14285
 14286     IF CMAINTI = 'S'
 14287        GO TO 2100-SHOW-REQUEST.
 14288
 14289     IF NOT MODIFY-CAP
 14290         MOVE 'UPDATE'       TO SM-READ
 14291         PERFORM 9995-SECURITY-VIOLATION
 14292         MOVE ER-0070        TO EMI-ERROR
 14293         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14294         GO TO 8100-SEND-INITIAL-MAP.
 14295
 14296     IF CMAINTL GREATER THAN ZEROS
 14297        IF PI-PF6-FUNCTION
 14298           IF CMAINTI NOT = 'A'
 14299              MOVE AL-UABON  TO CMAINTA
 14300              MOVE -1        TO CMAINTL
 14301              MOVE ER-2260   TO EMI-ERROR
 14302              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14303              GO TO 8200-SEND-DATAONLY.
 14304
 14305     IF CCERTNOL = ZEROS
 14306       AND (CMAINTI = 'C' OR 'K' OR 'D')
 14307         NEXT SENTENCE
 14308     ELSE
 14309         IF CCERTNOL NOT = ZEROS
 14310             MOVE AL-UANON       TO CCERTNOA
 14311         ELSE
 14312             MOVE -1             TO CCERTNOL
 14313             MOVE  1             TO SET-CURSOR-SW
 14314             MOVE ER-2218       TO EMI-ERROR
 14315             MOVE AL-UABON       TO CCERTNOA
 14316             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14317
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 261
* EL6311.cbl
 14318     IF CEFFDTL = ZEROS AND (CMAINTI = 'C' OR 'K' OR 'D')
 14319        NEXT SENTENCE
 14320     ELSE
 14321        IF CEFFDTL NOT = ZEROS
 14322           MOVE AL-UNNON         TO CEFFDTA
 14323           MOVE CEFFDTI TO DEEDIT-FIELD
 14324           PERFORM 8600-DEEDIT
 14325           MOVE 4                TO DC-OPTION-CODE
 14326           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14327           PERFORM 9700-DATE-LINK
 14328           IF NO-CONVERSION-ERROR
 14329              MOVE DC-BIN-DATE-1 TO WS-CONVERTED-EFFDT
 14330              ELSE
 14331              MOVE -1            TO CEFFDTL
 14332              MOVE  1            TO SET-CURSOR-SW
 14333              MOVE ER-2226      TO EMI-ERROR
 14334              MOVE AL-UNBON      TO CEFFDTA
 14335              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14336          ELSE
 14337          MOVE -1                 TO CEFFDTL
 14338          MOVE  1                 TO SET-CURSOR-SW
 14339          MOVE ER-2220            TO EMI-ERROR
 14340          MOVE AL-UNBON           TO CEFFDTA
 14341          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14342
 14343     MOVE PI-PREV-ALT-KEY            TO WS-ERPNDB-ALT-KEY.
 14344
 14345     IF CCERTNOL NOT = ZEROS
 14346        MOVE CCERTNOI                TO WS-NEW-PRIME
 14347     ELSE
 14348        MOVE SPACES                  TO WS-NEW-PRIME.
 14349
 14350     IF CSUFIXL NOT = ZEROS
 14351        MOVE CSUFIXI                 TO WS-NEW-SUFFIX
 14352     ELSE
 14353        MOVE SPACE                   TO WS-NEW-SUFFIX.
 14354
 14355     IF CEFFDTL NOT = ZEROS
 14356        MOVE WS-CONVERTED-EFFDT      TO WS-NEW-CERT-EFF-DT
 14357     ELSE
 14358        MOVE LOW-VALUES              TO WS-NEW-CERT-EFF-DT.
 14359
 14360     IF CMAINTI = 'A' OR 'K' OR 'S'
 14361        NEXT SENTENCE
 14362     ELSE
 14363        MOVE PI-PREV-ALT-KEY     TO WS-ERPNDB-ALT-KEY
 14364        IF WS-PB-CERT-NO     NOT = WS-NEW-CERT-NO     OR
 14365           WS-PB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT OR
 14366           WS-PB-RECORD-TYPE NOT = '2'
 14367           IF CMAINTI = 'C'
 14368              MOVE ER-2287          TO EMI-ERROR
 14369              MOVE -1               TO CCERTNOL
 14370              MOVE AL-UABON         TO CCERTNOA CEFFDTA
 14371              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14372              GO TO 8200-SEND-DATAONLY
 14373             ELSE
 14374              MOVE ER-2260          TO EMI-ERROR
 14375              MOVE -1               TO CCERTNOL
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 262
* EL6311.cbl
 14376              MOVE AL-UABON         TO CCERTNOA
 14377              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14378              GO TO 8200-SEND-DATAONLY.
 14379
 14380     IF CMAINTI = 'D'
 14381        GO TO 2400-DELETE-CANCEL-ROUTINE.
 14382
 14383     IF CLSTNML GREATER THAN ZEROS
 14384         MOVE AL-UANON           TO CLSTNMA.
 14385
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 263
* EL6311.cbl
 14387
 14388******************************************************************
 14389*                                                                *
 14390*           E D I T   C A N C E L   C O V E R A G E S            *
 14391*                                                                *
 14392******************************************************************
 14393
 14394 2015-EDIT-COVERAGES.
 14395     IF CCANDT1L      GREATER THAN ZEROS OR
 14396        CREFND1L      GREATER THAN ZEROS OR
 14397        CCANDT2L      GREATER THAN ZEROS OR
 14398        CREFND2L      GREATER THAN ZEROS OR
 14399        CMTHD1L       GREATER THAN ZEROS OR
 14400        CMTHD2L       GREATER THAN ZEROS OR
 14401        CLIVESL       GREATER THAN ZEROS OR
 14402        CPAYEEL       GREATER THAN ZEROS OR
 14403        CFORCEL       GREATER THAN ZEROS OR
 14404        CBILCDL       GREATER THAN ZEROS OR
 14405        CCANREAL      GREATER THAN ZEROS
 14406            NEXT SENTENCE
 14407         ELSE
 14408            GO TO 2030-EDIT-COMPLETE.
 14409
 14410     IF CCANDT1L = ZEROS
 14411        AND (CMAINTI = 'C' OR 'K')
 14412        NEXT SENTENCE
 14413     ELSE
 14414        IF CCANDT1L      GREATER THAN ZEROS
 14415            MOVE AL-UNNON            TO CCANDT1A
 14416            IF CCANDT1I = SPACES
 14417               MOVE LOW-VALUES       TO WS-CONVERTED-CANDT1
 14418            ELSE
 14419               MOVE CCANDT1I            TO DEEDIT-FIELD
 14420               PERFORM 8600-DEEDIT
 14421               IF DEEDIT-FIELD-V0   NUMERIC
 14422                  MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14423                  MOVE 4                TO DC-OPTION-CODE
 14424                  PERFORM 9700-DATE-LINK
 14425                  IF NO-CONVERSION-ERROR
 14426                     MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT1
 14427                  ELSE
 14428                      MOVE -1        TO CCANDT1L
 14429                      MOVE ER-2227   TO EMI-ERROR
 14430                      MOVE AL-UNBON  TO CCANDT1A
 14431                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14432               ELSE
 14433                  MOVE -1         TO CCANDT1L
 14434                  MOVE ER-2223    TO EMI-ERROR
 14435                  MOVE AL-UNBON   TO CCANDT1A
 14436                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14437        ELSE
 14438            IF CREFND1L GREATER THAN ZEROS
 14439               MOVE -1             TO CCANDT1L
 14440               MOVE ER-2222        TO EMI-ERROR
 14441               MOVE AL-UNBOF       TO CCANDT1A
 14442               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14443
 14444     IF CREFND1L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 264
* EL6311.cbl
 14445        AND (CMAINTI = 'C' OR 'K')
 14446         NEXT SENTENCE
 14447     ELSE
 14448         IF CREFND1L NOT = ZEROS
 14449            MOVE AL-UNNON        TO CREFND1A
 14450
 14451* EXEC CICS BIF DEEDIT
 14452*               FIELD  (CREFND1I)
 14453*               LENGTH (11)
 14454*           END-EXEC
 14455     MOVE 11
 14456       TO DFHEIV11
 14457*    MOVE '@"L                   #   #00013029' TO DFHEIV0
 14458     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14459     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14460     MOVE X'2020233030303133303239' TO DFHEIV0(25:11)
 14461     CALL 'kxdfhei1' USING DFHEIV0,
 14462           CREFND1I,
 14463           DFHEIV11
 14464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14465            MOVE CREFND1I        TO WS-CREFND1
 14466*           MOVE CREFND1I        TO DEEDIT-FIELD-X11
 14467*           PERFORM 8600-DEEDIT
 14468*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND1
 14469            IF WS-CREFND1  = ZEROS
 14470               AND CMAINTI = 'A'
 14471             MOVE ER-2437        TO EMI-ERROR
 14472             MOVE -1             TO CREFND1L
 14473             MOVE AL-UNBON       TO CREFND1A
 14474             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14475
 14476     IF CCANREAL > +0
 14477        MOVE AL-UANON            TO CCANREAA
 14478        IF CCANREAI = 'R' OR ' '
 14479           CONTINUE
 14480        ELSE
 14481           MOVE ER-9841        TO EMI-ERROR
 14482           MOVE -1             TO CCANREAL
 14483           MOVE AL-UABON       TO CCANREAA
 14484           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14485        END-IF
 14486     END-IF
 14487     IF CMTHD1L EQUAL +0
 14488        NEXT SENTENCE
 14489     ELSE
 14490        IF CMTHD1L NOT = +0
 14491           MOVE AL-UNNON        TO CMTHD1A
 14492           IF CMTHD1I EQUAL '1' OR '2' OR '3' OR '4'
 14493                         OR '5' OR '6' OR '8' OR '9'
 14494                         OR 'R' OR ' '
 14495              NEXT SENTENCE
 14496           ELSE
 14497              MOVE ER-0582        TO EMI-ERROR
 14498              MOVE -1             TO CMTHD1L
 14499              MOVE AL-UNBON       TO CMTHD1A
 14500              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14501
 14502     IF CCANDT2L = ZEROS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 265
* EL6311.cbl
 14503        AND (CMAINTI = 'C' OR 'K')
 14504         NEXT SENTENCE
 14505     ELSE
 14506         IF CCANDT2L  GREATER THAN ZEROS
 14507             MOVE AL-UNNON       TO CCANDT2A
 14508             IF CCANDT2I = SPACES
 14509                MOVE LOW-VALUES  TO WS-CONVERTED-CANDT2
 14510             ELSE
 14511                MOVE CCANDT2I       TO DEEDIT-FIELD
 14512                PERFORM 8600-DEEDIT
 14513                IF DEEDIT-FIELD-V0   NUMERIC
 14514                   MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 14515                   MOVE 4                TO DC-OPTION-CODE
 14516                   PERFORM 9700-DATE-LINK
 14517                   IF NO-CONVERSION-ERROR
 14518                      MOVE DC-BIN-DATE-1    TO WS-CONVERTED-CANDT2
 14519                   ELSE
 14520                      MOVE -1       TO CCANDT2L
 14521                      MOVE ER-2227  TO EMI-ERROR
 14522                      MOVE AL-UNBON TO CCANDT2A
 14523                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14524                ELSE
 14525                   MOVE -1         TO CCANDT2L
 14526                   MOVE ER-2223    TO EMI-ERROR
 14527                   MOVE AL-UNBON   TO CCANDT2A
 14528                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14529         ELSE
 14530            IF CREFND2L GREATER THAN ZEROS
 14531               MOVE -1             TO CCANDT2L
 14532               MOVE ER-2222        TO EMI-ERROR
 14533               MOVE AL-UNBOF       TO CCANDT2A
 14534               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14535
 14536     IF CREFND2L = ZEROS
 14537        AND (CMAINTI = 'C' OR 'K')
 14538         NEXT SENTENCE
 14539     ELSE
 14540         IF CREFND2L NOT = ZEROS
 14541            MOVE AL-UNNON        TO CREFND2A
 14542
 14543* EXEC CICS BIF DEEDIT
 14544*               FIELD  (CREFND2I)
 14545*               LENGTH (11)
 14546*           END-EXEC
 14547     MOVE 11
 14548       TO DFHEIV11
 14549*    MOVE '@"L                   #   #00013110' TO DFHEIV0
 14550     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 14551     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 14552     MOVE X'2020233030303133313130' TO DFHEIV0(25:11)
 14553     CALL 'kxdfhei1' USING DFHEIV0,
 14554           CREFND2I,
 14555           DFHEIV11
 14556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 14557            MOVE CREFND2I        TO WS-CREFND2
 14558*           MOVE CREFND2I        TO DEEDIT-FIELD-X11
 14559*           PERFORM 8600-DEEDIT
 14560*           MOVE DEEDIT-FIELD-V2 TO WS-CREFND2
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 266
* EL6311.cbl
 14561            IF WS-CREFND2  = ZEROS
 14562               AND CMAINTI = 'A'
 14563             MOVE ER-2437        TO EMI-ERROR
 14564             MOVE -1             TO CREFND2L
 14565             MOVE AL-UNBON       TO CREFND2A
 14566             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14567
 14568     IF CMTHD2L EQUAL +0
 14569        NEXT SENTENCE
 14570     ELSE
 14571        IF CMTHD2L NOT = +0
 14572           MOVE AL-UNNON        TO CMTHD2A
 14573           IF CMTHD2I EQUAL '1' OR '2' OR '3' OR '4'
 14574                         OR '5' OR '6' OR '8' OR '9'
 14575                         OR ' ' OR 'R'
 14576              NEXT SENTENCE
 14577           ELSE
 14578              MOVE ER-0582        TO EMI-ERROR
 14579              MOVE -1             TO CMTHD2L
 14580              MOVE AL-UNBON       TO CMTHD2A
 14581              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14582
 14583     IF CLIVESL GREATER THAN ZEROS
 14584         MOVE CLIVESI            TO DEEDIT-FIELD
 14585         PERFORM 8600-DEEDIT
 14586         IF DEEDIT-FIELD-V0 NUMERIC
 14587             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES
 14588             MOVE AL-UNNON       TO CLIVESA
 14589         ELSE
 14590             MOVE -1             TO CLIVESL
 14591             MOVE AL-UNBON       TO CLIVESA
 14592             MOVE ER-2223        TO EMI-ERROR
 14593             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14594
 14595     IF CFORCEL  NOT = ZEROS
 14596         IF FORCE-CAP
 14597            MOVE AL-UANON            TO CFORCEA
 14598         ELSE
 14599            MOVE ER-2945             TO EMI-ERROR
 14600            MOVE AL-UABON            TO CFORCEA
 14601            MOVE -1                  TO CFORCEL
 14602            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14603
 14604     IF CPAYEEL GREATER THAN ZEROS
 14605        MOVE AL-UANON            TO CPAYEEA.
 14606
 14607     IF CBILCDL NOT = ZEROS
 14608        IF CBILCDI NOT = ' ' AND 'H' AND 'R' AND 'L'
 14609                             AND 'A' AND 'B' AND 'E'
 14610           MOVE ER-2225              TO EMI-ERROR
 14611           MOVE AL-UABON             TO CBILCDA
 14612           MOVE -1                   TO CBILCDL
 14613           MOVE  1                   TO SET-CURSOR-SW
 14614           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14615        ELSE
 14616           MOVE AL-UANON             TO CBILCDA.
 14617
 14618 2030-EDIT-COMPLETE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 267
* EL6311.cbl
 14619     IF EMI-ERROR = ZEROS
 14620         NEXT SENTENCE
 14621     ELSE
 14622         GO TO 8200-SEND-DATAONLY.
 14623
 14624     IF CMAINTI = 'A'
 14625        GO TO 2200-ADD-CANCEL-ROUTINE.
 14626
 14627     IF CMAINTI = 'C'
 14628        GO TO 2300-CHANGE-CANCEL-ROUTINE.
 14629
 14630     GO TO 2900-REWRITE-CAN-CERT-KEY.
 14631
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 268
* EL6311.cbl
 14633
 14634******************************************************************
 14635*                                                                *
 14636*                   S H O W   C A N C E L                        *
 14637*                                                                *
 14638******************************************************************
 14639
 14640 2100-SHOW-REQUEST.
 14641     MOVE 'S'                    TO PI-MAINT-FUNCTION.
 14642
 14643     IF CCERTNOL = ZEROS AND CEFFDTL = ZEROS
 14644        MOVE -1                  TO CMAINTL
 14645        GO TO 8200-SEND-DATAONLY.
 14646
 14647     MOVE CCERTNOI            TO WS-NEW-PRIME.
 14648
 14649     IF CSUFIXL NOT = ZEROS
 14650        MOVE CSUFIXI          TO WS-NEW-SUFFIX
 14651       ELSE
 14652        MOVE SPACE            TO WS-NEW-SUFFIX.
 14653
 14654     MOVE CEFFDTI                TO DEEDIT-FIELD.
 14655     PERFORM 8600-DEEDIT.
 14656     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 14657     MOVE '4'                    TO DC-OPTION-CODE.
 14658     PERFORM 9700-DATE-LINK.
 14659     IF DATE-CONVERSION-ERROR
 14660        MOVE ER-0348             TO EMI-ERROR
 14661        MOVE -1                  TO CEFFDTL
 14662        MOVE AL-UABON            TO CEFFDTA
 14663        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14664        GO TO 8200-SEND-DATAONLY
 14665     ELSE
 14666        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 14667        MOVE AL-UANON            TO CEFFDTA
 14668        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 14669
 14670     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY
 14671
 14672     IF (ERPNDB-CERT-NO     NOT = WS-NEW-CERT-NO)      OR
 14673        (ERPNDB-CERT-EFF-DT NOT = WS-NEW-CERT-EFF-DT)
 14674        MOVE 'Y'                    TO WS-SHOW-SW
 14675        IF PI-PRIMARY-BROWSE OR PI-PRIMARY-WITH-SELECT
 14676           GO TO 4100-BROWSE-PRIMARY-FORWARD
 14677        ELSE
 14678           IF PI-FILE-BROWSE
 14679              GO TO 4300-BROWSE-FILE-FORWARD
 14680           ELSE
 14681              IF PI-CSR-BROWSE
 14682                 GO TO 4200-BROWSE-CSR-FORWARD
 14683              ELSE
 14684                 GO TO 4000-BROWSE-DETAIL-FORWARD
 14685     ELSE
 14686        GO TO 3900-RE-DISPLAY-RECORD.
 14687
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 269
* EL6311.cbl
 14689
 14690
 14691******************************************************************
 14692*                                                                *
 14693*            A D D   C A N C E L   R O U T I N E                 *
 14694*                                                                *
 14695******************************************************************
 14696
 14697 2200-ADD-CANCEL-ROUTINE.
 14698     MOVE 'A'                    TO PI-MAINT-FUNCTION.
 14699
 14700
 14701* EXEC CICS GETMAIN
 14702*        SET     (ADDRESS OF PENDING-BUSINESS)
 14703*        LENGTH  (ERPNDB-RECORD-LENGTH)
 14704*    END-EXEC.
 14705*    MOVE '," L                  $   #00013257' TO DFHEIV0
 14706     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
 14707     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14708     MOVE X'2020233030303133323537' TO DFHEIV0(25:11)
 14709     CALL 'kxdfhei1' USING DFHEIV0,
 14710           DFHEIV20,
 14711           ERPNDB-RECORD-LENGTH,
 14712           DFHEIV99
 14713     SET ADDRESS OF PENDING-BUSINESS TO
 14714         DFHEIV20
 14715     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14716
 14717
 14718
 14719* EXEC CICS HANDLE CONDITION
 14720*         NOTFND    (2280-BATCH-HDR-NOT-FOUND)
 14721*    END-EXEC.
 14722*    MOVE '"$I                   ! 3 #00013262' TO DFHEIV0
 14723     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 14724     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14725     MOVE X'3320233030303133323632' TO DFHEIV0(25:11)
 14726     CALL 'kxdfhei1' USING DFHEIV0
 14727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14728
 14729
 14730     MOVE PI-PREV-KEY            TO ERPNDB-KEY
 14731     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 14732     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 14733
 14734
 14735* EXEC CICS READ
 14736*        INTO    (PENDING-BUSINESS)
 14737*        DATASET (FILE-ID-ERPNDB)
 14738*        RIDFLD  (ERPNDB-KEY)
 14739*    END-EXEC.
 14740     MOVE LENGTH OF
 14741      PENDING-BUSINESS
 14742       TO DFHEIV11
 14743*    MOVE '&"IL       E          (   #00013270' TO DFHEIV0
 14744     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 14745     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14746     MOVE X'2020233030303133323730' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 270
* EL6311.cbl
 14747     CALL 'kxdfhei1' USING DFHEIV0,
 14748           FILE-ID-ERPNDB,
 14749           PENDING-BUSINESS,
 14750           DFHEIV11,
 14751           ERPNDB-KEY,
 14752           DFHEIV99,
 14753           DFHEIV99,
 14754           DFHEIV99
 14755     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14756
 14757
 14758     MOVE PB-CSR-ID              TO WS-BATCH-CSR-ID.
 14759
 14760     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 14761     ADD +1                      TO WS-B-HIGHEST-SEQ-NO.
 14762     MOVE PB-CREDIT-SELECT-DT    TO WS-CREDIT-SELECT-DT.
 14763     MOVE SPACES                 TO PENDING-BUSINESS.
 14764     MOVE 'PB'                   TO PB-RECORD-ID.
 14765     MOVE PI-PREV-KEY            TO PB-CONTROL-PRIMARY.
 14766     MOVE PI-PREV-ALT-KEY        TO PB-CONTROL-BY-ACCOUNT.
 14767     MOVE SPACES                 TO PB-CERT-SFX.
 14768     MOVE WS-B-HIGHEST-SEQ-NO    TO PB-BATCH-SEQ-NO.
 14769     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14770                                    PB-ALT-CHG-SEQ-NO.
 14771
 14772     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
 14773     MOVE CCERTNOI               TO PB-CERT-PRIME.
 14774     MOVE '2'                    TO PB-RECORD-TYPE.
 14775
 14776     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD.
 14777     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
 14778
 14779
 14780     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
 14781                                    PB-ALT-CHG-SEQ-NO
 14782                                    PB-C-LF-REF-CALC
 14783                                    PB-C-AH-REF-CALC
 14784                                    PB-C-LF-RFND-CLP
 14785                                    PB-C-AH-RFND-CLP
 14786                                    PB-CI-INSURED-AGE
 14787                                    PB-CI-LF-TERM
 14788                                    PB-CI-AH-TERM
 14789                                    PB-CI-LF-BENEFIT-CD
 14790                                    PB-CI-LF-BENEFIT-AMT
 14791                                    PB-CI-LF-ALT-BENEFIT-AMT
 14792                                    PB-CI-LF-PREMIUM-AMT
 14793                                    PB-CI-LF-ALT-PREMIUM-AMT
 14794                                    PB-CI-AH-BENEFIT-CD
 14795                                    PB-CI-AH-BENEFIT-AMT
 14796                                    PB-CI-AH-PREMIUM-AMT
 14797                                    PB-CI-PAY-FREQUENCY
 14798                                    PB-CI-LOAN-APR
 14799                                    PB-CI-LOAN-TERM
 14800                                    PB-CI-LIFE-COMMISSION
 14801                                    PB-CI-AH-COMMISSION
 14802                                    PB-CI-CURR-SEQ
 14803                                    PB-CI-AH-CANCEL-AMT
 14804                                    PB-CI-LF-CANCEL-AMT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 271
* EL6311.cbl
 14805                                    PB-CI-RATE-DEV-PCT-LF
 14806                                    PB-CI-RATE-DEV-PCT-AH
 14807                                    PB-CI-EXTENTION-DAYS
 14808                                    PB-CI-TERM-IN-DAYS
 14809                                    PB-CI-LIVES
 14810                                    PB-CI-LF-CRIT-PER
 14811                                    PB-CI-AH-CRIT-PER
 14812                                    PB-C-LF-REM-TERM
 14813                                    PB-C-AH-REM-TERM
 14814                                    PB-CHG-COUNT
 14815                                    PB-LF-BILLED-AMTS
 14816                                    PB-AH-BILLED-AMTS
 14817                                    PB-C-NH-INT-ON-REFS
 14818*                                   PB-C-MICROFILM-NO
 14819                                    PB-CALC-TOLERANCE.
 14820
 14821     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 14822                                    PB-CI-AH-SETTLEMENT-DT
 14823                                    PB-CI-DEATH-DT
 14824                                    PB-CI-LF-PRIOR-CANCEL-DT
 14825                                    PB-CI-AH-PRIOR-CANCEL-DT
 14826                                    PB-CI-ENTRY-DT
 14827                                    PB-CI-LF-EXPIRE-DT
 14828                                    PB-CI-AH-EXPIRE-DT
 14829                                    PB-CI-LOAN-1ST-PMT-DT
 14830                                    PB-C-LF-CANCEL-DT
 14831                                    PB-C-AH-CANCEL-DT
 14832                                    PB-CREDIT-ACCEPT-DT
 14833                                    PB-BILLED-DT
 14834                                    PB-ACCT-EFF-DT
 14835                                    PB-ACCT-EXP-DT.
 14836
 14837     MOVE 'X'                    TO PB-FATAL-FLAG.
 14838
 14839     MOVE WS-CREDIT-SELECT-DT    TO PB-CREDIT-SELECT-DT.
 14840
 14841     IF CSUFIXL     GREATER THAN ZEROS
 14842        MOVE CSUFIXI             TO PB-CERT-SFX.
 14843
 14844*    IF CMICRNOL  GREATER  ZEROS
 14845*        IF CMICRNOI  NUMERIC
 14846*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 14847*            MOVE AL-UNNON       TO  CMICRNOA
 14848*        ELSE
 14849*            MOVE -1             TO  CMICRNOL
 14850*            MOVE AL-UNBON       TO  CMICRNOA
 14851*            MOVE ER-2701        TO  EMI-ERROR
 14852*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14853
 14854     IF CLSTNML     GREATER THAN ZEROS
 14855        MOVE CLSTNMI             TO PB-C-LAST-NAME.
 14856
 14857     IF CCANREAL > ZEROS
 14858        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 14859     END-IF
 14860     IF CPCYNL > ZEROS
 14861        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 14862     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 272
* EL6311.cbl
 14863     IF CCANDT1L    GREATER THAN ZEROS
 14864        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 14865
 14866     IF CCANDT2L    GREATER THAN ZEROS
 14867        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 14868
 14869     IF CMTHD1L    GREATER THAN +0
 14870        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 14871
 14872     IF CMTHD2L    GREATER THAN +0
 14873        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 14874
 14875     IF CREFND1L    GREATER THAN ZEROS
 14876        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
 14877        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 14878     ELSE
 14879        MOVE ZEROS               TO PB-C-LF-CANCEL-AMT.
 14880
 14881     IF CREFND2L    GREATER THAN ZEROS
 14882        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 14883        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 14884     ELSE
 14885        MOVE ZEROS               TO PB-C-AH-CANCEL-AMT.
 14886
 14887     IF CLIVESL     GREATER THAN ZEROS
 14888        MOVE WS-CLIVES           TO PB-C-LIVES
 14889     ELSE
 14890        MOVE ZEROS               TO PB-C-LIVES.
 14891
 14892     IF CPAYEEL     GREATER THAN ZEROS
 14893        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 14894
 14895     IF CFORCEL     GREATER THAN ZEROS
 14896        MOVE CFORCEI             TO PB-FORCE-CODE.
 14897
 14898     IF CBILCDL     GREATER THAN ZEROS
 14899        MOVE CBILCDI             TO PB-RECORD-BILL.
 14900
 14901*    MOVE WS-REFERENCE           TO PB-C-REFERENCE.
 14902
 14903 2260-WRITE-PB-RECORD.
 14904     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 14905                                    PB-INPUT-BY.
 14906     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 14907     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 14908                                    PB-INPUT-DT.
 14909
 14910     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 14911     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 14912                                    PB-CONTROL-BY-ORIG-BATCH.
 14913
 14914     MOVE PB-COMPANY-CD          TO PB-CSR-COMPANY-CD.
 14915     MOVE WS-BATCH-CSR-ID        TO PB-CSR-ID.
 14916     MOVE PB-ENTRY-BATCH         TO PB-CSR-ENTRY-BATCH.
 14917     MOVE PB-BATCH-SEQ-NO        TO PB-CSR-BATCH-SEQ-NO.
 14918     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-CSR-BATCH-CHG-SEQ-NO.
 14919
 14920     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 273
* EL6311.cbl
 14921
 14922     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 14923
 14924     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 14925     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 14926     MOVE PB-SV-STATE            TO PI-SV-STATE.
 14927
 14928     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 14929     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 14930
 14931 2275-WRITE-PENDING-BUSINESS.
 14932     MOVE 'A'                    TO JP-RECORD-TYPE.
 14933     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 14934     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 14935     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 14936
 14937
 14938* EXEC CICS HANDLE CONDITION
 14939*        DUPREC (2290-DUPLICATE-ALT-INDEX)
 14940*    END-EXEC.
 14941*    MOVE '"$%                   ! 4 #00013455' TO DFHEIV0
 14942     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 14943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14944     MOVE X'3420233030303133343535' TO DFHEIV0(25:11)
 14945     CALL 'kxdfhei1' USING DFHEIV0
 14946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14947
 14948
 14949
 14950* EXEC CICS WRITE
 14951*        DATASET (FILE-ID-ERPNDB)
 14952*        FROM    (PENDING-BUSINESS)
 14953*        RIDFLD  (PB-CONTROL-PRIMARY)
 14954*    END-EXEC.
 14955     MOVE LENGTH OF
 14956      PENDING-BUSINESS
 14957       TO DFHEIV11
 14958*    MOVE '&$ L                  ''   #00013459' TO DFHEIV0
 14959     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 14960     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 14961     MOVE X'2020233030303133343539' TO DFHEIV0(25:11)
 14962     CALL 'kxdfhei1' USING DFHEIV0,
 14963           FILE-ID-ERPNDB,
 14964           PENDING-BUSINESS,
 14965           DFHEIV11,
 14966           PB-CONTROL-PRIMARY,
 14967           DFHEIV99,
 14968           DFHEIV99
 14969     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14970
 14971
 14972     ADD +1                      TO WS-B-CANCEL-CNT-ENTERED.
 14973
 14974     PERFORM 8400-LOG-JOURNAL-RECORD.
 14975
 14976******************************************************************
 14977*       A D D  O R I G I N A L  C E R T  I N F O                 *
 14978******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 274
* EL6311.cbl
 14979
 14980     display ' made it to add orig CANCEL cert '
 14981     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 14982     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 14983     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 14984     MOVE PB-SV-STATE            TO ELCERT-STATE.
 14985
 14986
 14987* EXEC CICS READ
 14988*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 14989*        DATASET (FILE-ID-ELCERT)
 14990*        RIDFLD  (ELCERT-KEY)
 14991*        RESP    (WS-RESPONSE)
 14992*    END-EXEC.
 14993*    MOVE '&"S        E          (  N#00013479' TO DFHEIV0
 14994     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14995     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14996     MOVE X'204E233030303133343739' TO DFHEIV0(25:11)
 14997     CALL 'kxdfhei1' USING DFHEIV0,
 14998           FILE-ID-ELCERT,
 14999           DFHEIV20,
 15000           DFHEIV99,
 15001           ELCERT-KEY,
 15002           DFHEIV99,
 15003           DFHEIV99,
 15004           DFHEIV99
 15005     SET ADDRESS OF CERTIFICATE-MASTER TO
 15006         DFHEIV20
 15007     MOVE EIBRESP  TO WS-RESPONSE
 15008     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15009
 15010
 15011     IF NOT RESP-NORMAL
 15012        GO TO 2276-BYPASS-CRTO
 15013     END-IF
 15014
 15015     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15016     MOVE ' '                    TO WS-ERMAIL-SW
 15017
 15018
 15019* EXEC CICS READ
 15020*       DATASET   (FILE-ID-ERMAIL)
 15021*       SET       (ADDRESS OF MAILING-DATA)
 15022*       RIDFLD    (ERMAIL-KEY)
 15023*       RESP      (WS-RESPONSE)
 15024*    END-EXEC
 15025*    MOVE '&"S        E          (  N#00013493' TO DFHEIV0
 15026     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15027     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15028     MOVE X'204E233030303133343933' TO DFHEIV0(25:11)
 15029     CALL 'kxdfhei1' USING DFHEIV0,
 15030           FILE-ID-ERMAIL,
 15031           DFHEIV20,
 15032           DFHEIV99,
 15033           ERMAIL-KEY,
 15034           DFHEIV99,
 15035           DFHEIV99,
 15036           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 275
* EL6311.cbl
 15037     SET ADDRESS OF MAILING-DATA TO
 15038         DFHEIV20
 15039     MOVE EIBRESP  TO WS-RESPONSE
 15040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15041
 15042     IF RESP-NORMAL
 15043        SET ERMAIL-FOUND TO TRUE
 15044     END-IF
 15045
 15046     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15047
 15048     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
 15049     MOVE 'OC'                   TO OC-RECORD-ID
 15050     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15051                                 TO OC-CONTROL-PRIMARY (1:33)
 15052     MOVE 'I'                    TO OC-RECORD-TYPE
 15053     MOVE +4096                  TO OC-KEY-SEQ-NO
 15054     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
 15055     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
 15056     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
 15057
 15058     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15059     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15060     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15061     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15062     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15063     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15064     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15065     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15066     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15067     MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15068     MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15069     MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15070     MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15071     MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15072     MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15073     MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15074     MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15075     MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15076     MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15077     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15078     MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15079     MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15080     MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15081     MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15082     MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 15083     MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15084     MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15085     MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15086     MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15087     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15088     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15089     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15090
 15091     IF ERMAIL-FOUND
 15092        MOVE MA-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
 15093     END-IF
 15094     IF NOT CERT-TRL-REC-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 276
* EL6311.cbl
 15095        MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15096                           OC-INS-AGE-DEFAULT-FLAG
 15097        MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15098                           OC-JNT-AGE-DEFAULT-FLAG
 15099     END-IF
 15100     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
 15101     .
 15102 2275-WRITE-ELCRTO.
 15103
 15104
 15105* EXEC CICS WRITE
 15106*       DATASET   ('ELCRTO')
 15107*       FROM      (ORIGINAL-CERTIFICATE)
 15108*       RIDFLD    (OC-CONTROL-PRIMARY)
 15109*       RESP      (WS-RESPONSE)
 15110*    END-EXEC
 15111     MOVE LENGTH OF
 15112      ORIGINAL-CERTIFICATE
 15113       TO DFHEIV11
 15114     MOVE 'ELCRTO' TO DFHEIV1
 15115*    MOVE '&$ L                  ''  N#00013562' TO DFHEIV0
 15116     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 15117     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 15118     MOVE X'204E233030303133353632' TO DFHEIV0(25:11)
 15119     CALL 'kxdfhei1' USING DFHEIV0,
 15120           DFHEIV1,
 15121           ORIGINAL-CERTIFICATE,
 15122           DFHEIV11,
 15123           OC-CONTROL-PRIMARY,
 15124           DFHEIV99,
 15125           DFHEIV99
 15126     MOVE EIBRESP  TO WS-RESPONSE
 15127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15128
 15129     display ' just wrote 2275 ' ws-response
 15130     IF RESP-DUPKEY
 15131        SUBTRACT +1              FROM OC-KEY-SEQ-NO
 15132        GO TO 2275-WRITE-ELCRTO
 15133     ELSE
 15134        IF NOT RESP-NORMAL
 15135           MOVE -1               TO BMAINTL
 15136           MOVE ER-7450          TO EMI-ERROR
 15137           PERFORM 9900-ERROR-FORMAT
 15138                                 THRU 9900-EXIT
 15139           GO TO 8200-SEND-DATAONLY
 15140        END-IF
 15141     END-IF.
 15142
 15143 2276-BYPASS-CRTO.
 15144******************************************************************
 15145*       U P D A T E   T H E   B A T C H   H E A D E R            *
 15146******************************************************************
 15147
 15148
 15149* EXEC CICS READ
 15150*        INTO    (PENDING-BUSINESS)
 15151*        DATASET (FILE-ID-ERPNDB)
 15152*        RIDFLD  (ERPNDB-KEY)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 277
* EL6311.cbl
 15153*        UPDATE
 15154*    END-EXEC.
 15155     MOVE LENGTH OF
 15156      PENDING-BUSINESS
 15157       TO DFHEIV11
 15158*    MOVE '&"IL       EU         (   #00013588' TO DFHEIV0
 15159     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15160     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15161     MOVE X'2020233030303133353838' TO DFHEIV0(25:11)
 15162     CALL 'kxdfhei1' USING DFHEIV0,
 15163           FILE-ID-ERPNDB,
 15164           PENDING-BUSINESS,
 15165           DFHEIV11,
 15166           ERPNDB-KEY,
 15167           DFHEIV99,
 15168           DFHEIV99,
 15169           DFHEIV99
 15170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15171
 15172
 15173     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15174     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15175     MOVE 'B'                    TO JP-RECORD-TYPE.
 15176     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15177
 15178     PERFORM 8400-LOG-JOURNAL-RECORD.
 15179
 15180     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 15181
 15182
 15183* EXEC CICS REWRITE
 15184*        DATASET (FILE-ID-ERPNDB)
 15185*        FROM    (PENDING-BUSINESS)
 15186*    END-EXEC.
 15187     MOVE LENGTH OF
 15188      PENDING-BUSINESS
 15189       TO DFHEIV11
 15190*    MOVE '&& L                  %   #00013604' TO DFHEIV0
 15191     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15192     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15193     MOVE X'2020233030303133363034' TO DFHEIV0(25:11)
 15194     CALL 'kxdfhei1' USING DFHEIV0,
 15195           FILE-ID-ERPNDB,
 15196           PENDING-BUSINESS,
 15197           DFHEIV11,
 15198           DFHEIV99
 15199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15200
 15201
 15202     MOVE 'C'                    TO JP-RECORD-TYPE.
 15203     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15204
 15205     PERFORM 8400-LOG-JOURNAL-RECORD.
 15206
 15207     IF WS-ERRORS-PRESENT
 15208        GO TO 3900-RE-DISPLAY-RECORD.
 15209
 15210     MOVE ZEROS                  TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 278
* EL6311.cbl
 15211     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15212     MOVE LOW-VALUES             TO EL631CI.
 15213     MOVE  -1                    TO CMAINTL.
 15214     GO TO 8100-SEND-INITIAL-MAP.
 15215
 15216 2280-BATCH-HDR-NOT-FOUND.
 15217     MOVE -1                     TO BMAINTL.
 15218     MOVE ER-7450                TO EMI-ERROR.
 15219     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15220     GO TO 8200-SEND-DATAONLY.
 15221
 15222 2290-DUPLICATE-ALT-INDEX.
 15223
 15224******************************************************************
 15225*                                                                *
 15226*      IF THE PB-B-HIGHEST-SEQ-NO WAS NOT UPDATED IN THE DATA    *
 15227*         ENTRY SESSION, ADD +1 TO THE HIGHEST SEQUENCE NUMBER   *
 15228*         AND ATTEMPT TO WRITE THE RECORD AGAIN. REPEAT THIS     *
 15229*         50 TIMES.  IF DUPREC CONDITION IS STILL ENCOUNTERED    *
 15230*         AFTER 50 TIMES, ASSUME THE DUPLICATE RECORD WAS        *
 15231*         CAUSED BY A DUPLICATE ALTERNATE KEY.                   *
 15232*                                                                *
 15233******************************************************************
 15234
 15235     IF LCP-ONCTR-02 =  0
 15236         ADD 1 TO LCP-ONCTR-02
 15237        MOVE +0                  TO WS-SEQ-NO-COUNTER.
 15238
 15239     ADD +1                      TO WS-SEQ-NO-COUNTER.
 15240
 15241     IF  WS-SEQ-NO-COUNTER GREATER THAN +50
 15242         NEXT SENTENCE
 15243     ELSE
 15244         ADD +1 TO PB-BATCH-SEQ-NO
 15245                   PB-CSR-BATCH-SEQ-NO
 15246         MOVE PB-BATCH-SEQ-NO TO WS-B-HIGHEST-SEQ-NO
 15247         GO TO 2275-WRITE-PENDING-BUSINESS.
 15248
 15249     MOVE -1                     TO CCERTNOL.
 15250     MOVE AL-UABON               TO CCERTNOA.
 15251     MOVE AL-UNBON               TO CEFFDTA.
 15252
 15253     MOVE 1                      TO EMI-SUB
 15254                                    EMI-SWITCH1
 15255                                    EMI-SWITCH-AREA-1
 15256                                    EMI-SWITCH-AREA-2.
 15257
 15258     MOVE SPACES                 TO EMI-ERROR-LINES.
 15259
 15260
 15261* EXEC CICS SYNCPOINT ROLLBACK
 15262*    END-EXEC.
 15263*    MOVE '6"R                   !   #00013667' TO DFHEIV0
 15264     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 15265     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15266     MOVE X'2020233030303133363637' TO DFHEIV0(25:11)
 15267     CALL 'kxdfhei1' USING DFHEIV0
 15268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 279
* EL6311.cbl
 15269
 15270
 15271     MOVE ER-2247                TO EMI-ERROR.
 15272     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15273     GO TO 8200-SEND-DATAONLY.
 15274
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 280
* EL6311.cbl
 15276
 15277******************************************************************
 15278*                                                                *
 15279*          C H A N G E   C A N C E L   R O U T I N E             *
 15280*                                                                *
 15281******************************************************************
 15282
 15283***************************************************************
 15284*                                                             *
 15285*     1. GETMAIN FOR PENDING BUSINESS RECORD.                 *
 15286*     2. SAVE THE BATCH TOTAL DATA FOR UPDATING WITH NEW DATA.*
 15287*     3. GET THE RECORD TO BE UPDATED AND SEE IF IT HAS BEEN  *
 15288*              BILLED.  IF IT HAS THEN SAVE A COPY OF THE     *
 15289*              ZERO RECORD FOR CREATING REVERSAL ENTRIES.     *
 15290*     4. UPDATE THE RECORD WITH THE SCREEN DATA               *
 15291*     5. LINK TO THE EDIT ROUTINE.                            *
 15292*     6. FLAG ALL FIELDS SHOWN IN ERROR BY THE EDIT ROUTINE.  *
 15293*     7. REDISPLAY SCREEN DATA WITH NEW DATA RETURNED FROM    *
 15294*              THE EDIT ROUTINE.                              *
 15295*     7. REWRITE THE NEW ISSUE                                *
 15296*     8. UPDATE THE BATCH TOTAL RECORD WITH NEW TOTALS.       *
 15297*                                                             *
 15298***************************************************************
 15299 2300-CHANGE-CANCEL-ROUTINE.
 15300     MOVE 'C'                    TO PI-MAINT-FUNCTION.
 15301
 15302     IF CCHGL NOT = ZEROS
 15303        MOVE ER-2196             TO EMI-ERROR
 15304        MOVE AL-UABON            TO CMAINTA
 15305        MOVE -1                  TO CMAINTL
 15306        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15307        GO TO 8200-SEND-DATAONLY.
 15308
 15309     MOVE CCERTNOI               TO WS-NEW-PRIME.
 15310
 15311     IF CSUFIXL NOT = ZEROS
 15312        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 15313     ELSE
 15314        MOVE SPACE               TO WS-NEW-SUFFIX.
 15315
 15316     MOVE CEFFDTI                TO DEEDIT-FIELD.
 15317     PERFORM 8600-DEEDIT.
 15318     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 15319     MOVE '4'                    TO DC-OPTION-CODE.
 15320
 15321     PERFORM 9700-DATE-LINK.
 15322
 15323     IF DATE-CONVERSION-ERROR
 15324        MOVE ER-0348             TO EMI-ERROR
 15325        MOVE -1                  TO CEFFDTL
 15326        MOVE AL-UABON            TO CEFFDTA
 15327        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15328        GO TO 8200-SEND-DATAONLY
 15329     ELSE
 15330        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 15331        MOVE AL-UANON            TO CEFFDTA
 15332        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 15333
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 281
* EL6311.cbl
 15334 2325-PROCESS-CANCEL-CHANGES.
 15335
 15336* EXEC CICS HANDLE CONDITION
 15337*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 15338*    END-EXEC.
 15339*    MOVE '"$I                   ! 5 #00013734' TO DFHEIV0
 15340     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15341     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15342     MOVE X'3520233030303133373334' TO DFHEIV0(25:11)
 15343     CALL 'kxdfhei1' USING DFHEIV0
 15344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15345
 15346
 15347     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 15348     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 15349     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 15350
 15351
 15352* EXEC CICS GETMAIN
 15353*        SET      (ADDRESS OF PENDING-BUSINESS)
 15354*        LENGTH   (ERPNDB-RECORD-LENGTH)
 15355*        INITIMG  (GETMAIN-SPACE)
 15356*     END-EXEC.
 15357*    MOVE ',"IL                  $   #00013742' TO DFHEIV0
 15358     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 15359     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 15360     MOVE X'2020233030303133373432' TO DFHEIV0(25:11)
 15361     CALL 'kxdfhei1' USING DFHEIV0,
 15362           DFHEIV20,
 15363           ERPNDB-RECORD-LENGTH,
 15364           GETMAIN-SPACE
 15365     SET ADDRESS OF PENDING-BUSINESS TO
 15366         DFHEIV20
 15367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15368
 15369
 15370
 15371* EXEC CICS READ
 15372*        INTO    (PENDING-BUSINESS)
 15373*        DATASET (FILE-ID-ERPNDB)
 15374*        RIDFLD  (ERPNDB-KEY)
 15375*    END-EXEC.
 15376     MOVE LENGTH OF
 15377      PENDING-BUSINESS
 15378       TO DFHEIV11
 15379*    MOVE '&"IL       E          (   #00013748' TO DFHEIV0
 15380     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15381     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15382     MOVE X'2020233030303133373438' TO DFHEIV0(25:11)
 15383     CALL 'kxdfhei1' USING DFHEIV0,
 15384           FILE-ID-ERPNDB,
 15385           PENDING-BUSINESS,
 15386           DFHEIV11,
 15387           ERPNDB-KEY,
 15388           DFHEIV99,
 15389           DFHEIV99,
 15390           DFHEIV99
 15391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 282
* EL6311.cbl
 15392
 15393
 15394     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 15395
 15396
 15397* EXEC CICS HANDLE CONDITION
 15398*         NOTFND     (2385-REC-NOT-FOUND)
 15399*    END-EXEC.
 15400*    MOVE '"$I                   ! 6 #00013756' TO DFHEIV0
 15401     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 15402     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15403     MOVE X'3620233030303133373536' TO DFHEIV0(25:11)
 15404     CALL 'kxdfhei1' USING DFHEIV0
 15405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15406
 15407
 15408**********************************************************
 15409*      DONT READ THE RECORD FOR UPDATE UNTIL             *
 15410*      AFTER THE CHANGE RECORD HAS BEEN CREATED.         *
 15411**********************************************************
 15412
 15413
 15414* EXEC CICS READ
 15415*        DATASET (FILE-ID-ERPNDB)
 15416*        INTO    (PENDING-BUSINESS)
 15417*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15418*    END-EXEC.
 15419     MOVE LENGTH OF
 15420      PENDING-BUSINESS
 15421       TO DFHEIV11
 15422*    MOVE '&"IL       E          (   #00013765' TO DFHEIV0
 15423     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15424     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15425     MOVE X'2020233030303133373635' TO DFHEIV0(25:11)
 15426     CALL 'kxdfhei1' USING DFHEIV0,
 15427           FILE-ID-ERPNDB,
 15428           PENDING-BUSINESS,
 15429           DFHEIV11,
 15430           PI-PREV-CONTROL-PRIMARY,
 15431           DFHEIV99,
 15432           DFHEIV99,
 15433           DFHEIV99
 15434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15435
 15436
 15437********** DO NOT ALLOW CHANGES IF THRU A/R
 15438     IF BMAINTI = 'C'
 15439         IF PB-EL860-INTERNAL-PROCESS
 15440             MOVE ER-4005          TO EMI-ERROR
 15441             MOVE -1               TO BMAINTL
 15442             MOVE AL-UABON         TO BMAINTA
 15443             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15444             GO TO 8200-SEND-DATAONLY.
 15445**********
 15446
 15447     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 15448        MOVE -1                 TO CMAINTL
 15449        MOVE ER-2197            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 283
* EL6311.cbl
 15450        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15451        GO TO 8200-SEND-DATAONLY.
 15452
 15453     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 15454        MOVE ER-2196             TO EMI-ERROR
 15455        MOVE AL-UABON            TO CMAINTA
 15456        MOVE -1                  TO CMAINTL
 15457        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15458        GO TO 8200-SEND-DATAONLY.
 15459     MOVE ZEROS                  TO WS-SEQ-SAVE.
 15460
 15461     IF PB-BILLED-DT = LOW-VALUES AND
 15462        PB-CHG-COUNT = ZEROS
 15463        NEXT SENTENCE
 15464     ELSE
 15465        IF (CREFND1L GREATER THAN ZEROS AND
 15466            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15467           OR
 15468           (CREFND2L GREATER THAN ZEROS AND
 15469            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15470           PERFORM 2700-BUILD-CORRECTION-RECORD THRU 2799-EXIT.
 15471     if ((crefnd1l <> zeros)
 15472        and (ws-crefnd1 <> pb-c-lf-cancel-amt))
 15473                      or
 15474        ((crefnd2l <> zeros)
 15475        and (ws-crefnd2 <> pb-c-ah-cancel-amt))
 15476        continue
 15477     else
 15478        go to 2330-continue-change
 15479     end-if
 15480
 15481     move zeros                  to ws-check-amts
 15482     move ' '                    to ws-stop-sw
 15483                                    ws-check-sw
 15484                                    ws-any-check-sw
 15485                                    ws-proc-check-sw
 15486                                    ws-chek-browse-sw
 15487
 15488     perform 2500-browse-checks  thru 2500-exit
 15489
 15490     if i-have-processed-checks
 15491        or i-have-checks
 15492        continue
 15493     else
 15494        go to 2330-continue-change
 15495     end-if
 15496
 15497     if crefnd1l <> zeros
 15498        compute ws-lf-diff = ws-crefnd1 - pb-c-lf-cancel-amt
 15499        move ws-crefnd1 to ws-new-ref-total
 15500     else
 15501        move pb-c-lf-cancel-amt  to ws-new-ref-total
 15502     end-if
 15503     if crefnd2l <> zeros
 15504        compute ws-ah-diff = ws-crefnd2 - pb-c-ah-cancel-amt
 15505        compute ws-new-ref-total = ws-new-ref-total +
 15506           ws-crefnd2
 15507     else
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 284
* EL6311.cbl
 15508        compute ws-new-ref-total = ws-new-ref-total +
 15509           pb-c-ah-cancel-amt
 15510     end-if
 15511
 15512     if zeros = (ws-lf-diff + ws-ah-diff)
 15513        move er-3449             to emi-error
 15514        perform 9900-error-format thru 9900-exit
 15515        go to 2330-continue-change
 15516     end-if
 15517
 15518     if (ws-new-ref-total < ws-check-amts)
 15519        and (pb-c-refund-sw = 'Y')
 15520        move er-3447             to emi-error
 15521        perform 9900-error-format thru 9900-exit
 15522        move al-uabon            to cmainta
 15523        move -1                  to cmaintl
 15524        go to 8200-send-dataonly
 15525     end-if
 15526
 15527     if (ws-new-ref-total > ws-check-amts)
 15528        and (ws-check-amts not = zeros)
 15529        move er-3448             to emi-error
 15530        move al-uabon            to crefnd1a
 15531                                    crefnd2a
 15532        perform 9900-error-format thru 9900-exit
 15533     end-if
 15534
 15535*     if (ws-lf-diff + ws-ah-diff) < zeros
 15536*        move er-3447             to emi-error
 15537*        perform 9900-error-format thru 9900-exit
 15538*        move al-uabon            to cmainta
 15539*        move -1                  to cmaintl
 15540*        go to 8200-send-dataonly
 15541*     end-if
 15542     .
 15543 2330-continue-change.
 15544
 15545
 15546* EXEC CICS READ
 15547*        DATASET (FILE-ID-ERPNDB)
 15548*        INTO    (PENDING-BUSINESS)
 15549*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 15550*        UPDATE
 15551*    END-EXEC.
 15552     MOVE LENGTH OF
 15553      PENDING-BUSINESS
 15554       TO DFHEIV11
 15555*    MOVE '&"IL       EU         (   #00013879' TO DFHEIV0
 15556     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15557     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15558     MOVE X'2020233030303133383739' TO DFHEIV0(25:11)
 15559     CALL 'kxdfhei1' USING DFHEIV0,
 15560           FILE-ID-ERPNDB,
 15561           PENDING-BUSINESS,
 15562           DFHEIV11,
 15563           PI-PREV-CONTROL-PRIMARY,
 15564           DFHEIV99,
 15565           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 285
* EL6311.cbl
 15566           DFHEIV99
 15567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15568
 15569
 15570     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15571     MOVE 'B'                    TO JP-RECORD-TYPE
 15572     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15573     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15574
 15575     PERFORM 8400-LOG-JOURNAL-RECORD.
 15576
 15577     IF PB-BILLED-DT NOT = LOW-VALUES OR
 15578          PB-CHG-COUNT NOT = ZEROS
 15579        IF (CREFND1L GREATER THAN ZEROS AND
 15580            WS-CREFND1 NOT = PB-C-LF-CANCEL-AMT)
 15581           OR
 15582           (CREFND2L GREATER THAN ZEROS AND
 15583            WS-CREFND2 NOT = PB-C-AH-CANCEL-AMT)
 15584            ADD +1                      TO PB-CHG-COUNT
 15585            MOVE LOW-VALUES             TO PB-BILLED-DT.
 15586
 15587*    IF CMICRNOL  GREATER  ZEROS
 15588*        IF CMICRNOI  NUMERIC
 15589*            MOVE CMICRNOI       TO  PB-C-MICROFILM-NO
 15590*            MOVE AL-UNNON       TO  CMICRNOA
 15591*        ELSE
 15592*            MOVE -1             TO  CMICRNOL
 15593*            MOVE AL-UNBON       TO  CMICRNOA
 15594*            MOVE ER-2701        TO  EMI-ERROR
 15595*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 15596
 15597     IF CSUFIXL GREATER THAN ZEROS
 15598        MOVE CSUFIXI             TO PB-CERT-SFX.
 15599
 15600     IF CLSTNML GREATER THAN ZEROS
 15601         MOVE CLSTNMI            TO PB-C-LAST-NAME.
 15602
 15603     IF CCANREAL > ZEROS
 15604        MOVE CCANREAI            TO PB-C-CANCEL-REASON
 15605     END-IF
 15606     IF CPCYNL > ZEROS
 15607        MOVE CPCYNI              TO PB-C-POST-CARD-IND
 15608     END-IF
 15609     IF CCANDT1L    GREATER THAN ZEROS
 15610        MOVE WS-CONVERTED-CANDT1 TO PB-C-LF-CANCEL-DT.
 15611
 15612     IF CCANDT2L    GREATER THAN ZEROS
 15613        MOVE WS-CONVERTED-CANDT2 TO PB-C-AH-CANCEL-DT.
 15614
 15615     IF CMTHD1L    GREATER THAN +0
 15616        MOVE CMTHD1I             TO PB-C-LF-REFUND-OVERRIDE.
 15617
 15618     IF CMTHD2L    GREATER THAN +0
 15619        MOVE CMTHD2I             TO PB-C-AH-REFUND-OVERRIDE.
 15620
 15621     IF CREFND1L    GREATER THAN ZEROS
 15622        SUBTRACT PB-C-LF-CANCEL-AMT FROM WS-B-LF-CAN-PRM-ENTERED
 15623        ADD  WS-CREFND1          TO WS-B-LF-CAN-PRM-ENTERED
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 286
* EL6311.cbl
 15624        MOVE WS-CREFND1          TO PB-C-LF-CANCEL-AMT
 15625        MOVE SPACE               TO PB-C-LF-CALC-REQ.
 15626
 15627     IF CREFND2L    GREATER THAN ZEROS
 15628        SUBTRACT PB-C-AH-CANCEL-AMT FROM WS-B-AH-CAN-PRM-ENTERED
 15629        ADD  WS-CREFND2          TO WS-B-AH-CAN-PRM-ENTERED
 15630        MOVE WS-CREFND2          TO PB-C-AH-CANCEL-AMT
 15631        MOVE SPACE               TO PB-C-AH-CALC-REQ.
 15632
 15633     IF CLIVESL     GREATER THAN ZEROS
 15634        MOVE WS-CLIVES           TO PB-C-LIVES.
 15635
 15636     IF CPAYEEL     GREATER THAN ZEROS
 15637        MOVE CPAYEEI             TO PB-C-PAYEE-CODE.
 15638
 15639     IF CFORCEL     GREATER THAN ZEROS
 15640        MOVE CFORCEI             TO PB-FORCE-CODE.
 15641
 15642     IF CBILCDL     GREATER THAN ZEROS
 15643        MOVE CBILCDI             TO PB-RECORD-BILL.
 15644
 15645 2360-REWRITE-PB-RECORD.
 15646     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 15647     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 15648     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
 15649     MOVE 'C'                    TO JP-RECORD-TYPE.
 15650     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15651     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15652     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15653
 15654     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 15655
 15656     SUBTRACT PB-C-LF-REF-CALC   FROM WS-B-LF-CAN-PRM-COMPUTED.
 15657     SUBTRACT PB-C-AH-REF-CALC   FROM WS-B-AH-CAN-PRM-COMPUTED.
 15658
 15659     PERFORM 9800-LINK-PENDING-EDIT THRU 9800-EXIT.
 15660
 15661     PERFORM 7300-FORMAT-ERRORS  THRU 7399-EXIT.
 15662
 15663     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 15664     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
 15665     MOVE PB-SV-STATE            TO PI-SV-STATE.
 15666
 15667     ADD PB-C-LF-REF-CALC        TO WS-B-LF-CAN-PRM-COMPUTED.
 15668     ADD PB-C-AH-REF-CALC        TO WS-B-AH-CAN-PRM-COMPUTED.
 15669
 15670 2375-REWRITE-PENDING-BUSINESS.
 15671     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 15672     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 15673     MOVE 'C'                    TO JP-RECORD-TYPE.
 15674     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 15675
 15676
 15677* EXEC CICS REWRITE
 15678*        DATASET (FILE-ID-ERPNDB)
 15679*        FROM    (PENDING-BUSINESS)
 15680*    END-EXEC.
 15681     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 287
* EL6311.cbl
 15682      PENDING-BUSINESS
 15683       TO DFHEIV11
 15684*    MOVE '&& L                  %   #00013992' TO DFHEIV0
 15685     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15686     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15687     MOVE X'2020233030303133393932' TO DFHEIV0(25:11)
 15688     CALL 'kxdfhei1' USING DFHEIV0,
 15689           FILE-ID-ERPNDB,
 15690           PENDING-BUSINESS,
 15691           DFHEIV11,
 15692           DFHEIV99
 15693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15694
 15695
 15696     PERFORM 8400-LOG-JOURNAL-RECORD.
 15697
 15698******************************************************************
 15699*       U P D A T E   T H E   O R I G   C E R T   I N F O        *
 15700******************************************************************
 15701
 15702     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 15703     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 15704     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 15705     MOVE PB-SV-STATE            TO ELCERT-STATE.
 15706
 15707
 15708* EXEC CICS READ
 15709*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 15710*        DATASET (FILE-ID-ELCERT)
 15711*        RIDFLD  (ELCERT-KEY)
 15712*        RESP    (WS-RESPONSE)
 15713*    END-EXEC.
 15714*    MOVE '&"S        E          (  N#00014008' TO DFHEIV0
 15715     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15716     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15717     MOVE X'204E233030303134303038' TO DFHEIV0(25:11)
 15718     CALL 'kxdfhei1' USING DFHEIV0,
 15719           FILE-ID-ELCERT,
 15720           DFHEIV20,
 15721           DFHEIV99,
 15722           ELCERT-KEY,
 15723           DFHEIV99,
 15724           DFHEIV99,
 15725           DFHEIV99
 15726     SET ADDRESS OF CERTIFICATE-MASTER TO
 15727         DFHEIV20
 15728     MOVE EIBRESP  TO WS-RESPONSE
 15729     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15730
 15731
 15732     IF NOT RESP-NORMAL
 15733        GO TO 2376-BYPASS-CRTO
 15734     END-IF
 15735
 15736
 15737     MOVE ELCERT-KEY             TO ERMAIL-KEY
 15738     MOVE ' '                    TO WS-ERMAIL-SW
 15739
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 288
* EL6311.cbl
 15740
 15741* EXEC CICS READ
 15742*       DATASET   (FILE-ID-ERMAIL)
 15743*       SET       (ADDRESS OF MAILING-DATA)
 15744*       RIDFLD    (ERMAIL-KEY)
 15745*       RESP      (WS-RESPONSE)
 15746*    END-EXEC
 15747*    MOVE '&"S        E          (  N#00014023' TO DFHEIV0
 15748     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 15749     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15750     MOVE X'204E233030303134303233' TO DFHEIV0(25:11)
 15751     CALL 'kxdfhei1' USING DFHEIV0,
 15752           FILE-ID-ERMAIL,
 15753           DFHEIV20,
 15754           DFHEIV99,
 15755           ERMAIL-KEY,
 15756           DFHEIV99,
 15757           DFHEIV99,
 15758           DFHEIV99
 15759     SET ADDRESS OF MAILING-DATA TO
 15760         DFHEIV20
 15761     MOVE EIBRESP  TO WS-RESPONSE
 15762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15763
 15764     IF RESP-NORMAL
 15765        SET ERMAIL-FOUND TO TRUE
 15766     END-IF
 15767
 15768     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 15769
 15770     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 15771                                 TO ELCRTO-KEY
 15772     MOVE 'I'                    TO ELCRTO-RECORD-TYPE
 15773     MOVE +0                     TO ELCRTO-SEQ-NO
 15774
 15775
 15776* EXEC CICS READ
 15777*       DATASET   ('ELCRTO')
 15778*       INTO      (ORIGINAL-CERTIFICATE)
 15779*       RIDFLD    (ELCRTO-KEY)
 15780*       GTEQ
 15781*       RESP      (WS-RESPONSE)
 15782*    END-EXEC
 15783     MOVE LENGTH OF
 15784      ORIGINAL-CERTIFICATE
 15785       TO DFHEIV11
 15786     MOVE 'ELCRTO' TO DFHEIV1
 15787*    MOVE '&"IL       G          (  N#00014041' TO DFHEIV0
 15788     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 15789     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15790     MOVE X'204E233030303134303431' TO DFHEIV0(25:11)
 15791     CALL 'kxdfhei1' USING DFHEIV0,
 15792           DFHEIV1,
 15793           ORIGINAL-CERTIFICATE,
 15794           DFHEIV11,
 15795           ELCRTO-KEY,
 15796           DFHEIV99,
 15797           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 289
* EL6311.cbl
 15798           DFHEIV99
 15799     MOVE EIBRESP  TO WS-RESPONSE
 15800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15801
 15802     IF RESP-NORMAL
 15803        AND (OC-CONTROL-PRIMARY (1:33) =
 15804                 PB-CONTROL-BY-ACCOUNT (1:33))
 15805        AND (OC-RECORD-TYPE = 'I')
 15806        display ' resp norm, key =, type i '
 15807        IF (OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES)
 15808           display ' end proc blank '
 15809           display ' csr edit session ' PI-CSR-SESSION-SW
 15810           IF NOT CSR-EDIT-SESSION
 15811
 15812* EXEC CICS READ
 15813*                DATASET   ('ELCRTO')
 15814*                INTO      (ORIGINAL-CERTIFICATE)
 15815*                RIDFLD    (OC-CONTROL-PRIMARY)
 15816*                UPDATE
 15817*                RESP      (WS-RESPONSE)
 15818*             END-EXEC
 15819     MOVE LENGTH OF
 15820      ORIGINAL-CERTIFICATE
 15821       TO DFHEIV11
 15822     MOVE 'ELCRTO' TO DFHEIV1
 15823*    MOVE '&"IL       EU         (  N#00014058' TO DFHEIV0
 15824     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 15825     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 15826     MOVE X'204E233030303134303538' TO DFHEIV0(25:11)
 15827     CALL 'kxdfhei1' USING DFHEIV0,
 15828           DFHEIV1,
 15829           ORIGINAL-CERTIFICATE,
 15830           DFHEIV11,
 15831           OC-CONTROL-PRIMARY,
 15832           DFHEIV99,
 15833           DFHEIV99,
 15834           DFHEIV99
 15835     MOVE EIBRESP  TO WS-RESPONSE
 15836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15837              DISPLAY ' JUST DID READ UPD ' WS-RESPONSE
 15838              IF RESP-NORMAL
 15839                 display ' good read upd '
 15840                 IF OC-ISSUE-TRAN-IND = 'N'
 15841                    MOVE CM-INSURED-LAST-NAME   TO
 15842                         OC-INS-LAST-NAME
 15843                    MOVE CM-INSURED-FIRST-NAME  TO
 15844                         OC-INS-FIRST-NAME
 15845                    MOVE CM-INSURED-INITIAL2    TO
 15846                         OC-INS-MIDDLE-INIT
 15847                    MOVE CM-INSURED-ISSUE-AGE   TO
 15848                         OC-INS-AGE
 15849                    MOVE CM-JT-LAST-NAME        TO
 15850                         OC-JNT-LAST-NAME
 15851                    MOVE CM-JT-FIRST-NAME       TO
 15852                         OC-JNT-FIRST-NAME
 15853                    MOVE CM-JT-INITIAL          TO
 15854                         OC-JNT-MIDDLE-INIT
 15855                    MOVE CM-INSURED-JOINT-AGE   TO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 290
* EL6311.cbl
 15856                         OC-JNT-AGE
 15857                    MOVE CM-LF-BENEFIT-CD       TO
 15858                         OC-LF-BENCD
 15859                    MOVE CM-LF-ORIG-TERM        TO
 15860                         OC-LF-TERM
 15861                    MOVE CM-LF-BENEFIT-AMT      TO
 15862                         OC-LF-BEN-AMT
 15863                    MOVE CM-LF-PREMIUM-AMT      TO
 15864                         OC-LF-PRM-AMT
 15865                    MOVE CM-LF-ALT-BENEFIT-AMT  TO
 15866                         OC-LF-ALT-BEN-AMT
 15867                    MOVE CM-LF-ALT-PREMIUM-AMT  TO
 15868                         OC-LF-ALT-PRM-AMT
 15869                    MOVE CM-LF-LOAN-EXPIRE-DT   TO
 15870                         OC-LF-EXP-DT
 15871                    MOVE CM-LIFE-COMM-PCT       TO
 15872                         OC-LF-COMM-PCT
 15873                    MOVE CM-AH-BENEFIT-CD       TO
 15874                         OC-AH-BENCD
 15875                    MOVE CM-AH-ORIG-TERM        TO
 15876                         OC-AH-TERM
 15877                    MOVE CM-AH-BENEFIT-AMT      TO
 15878                         OC-AH-BEN-AMT
 15879                    MOVE CM-AH-PREMIUM-AMT      TO
 15880                         OC-AH-PRM-AMT
 15881                    MOVE CM-AH-LOAN-EXPIRE-DT   TO
 15882                         OC-AH-EXP-DT
 15883                    MOVE CM-AH-COMM-PCT         TO
 15884                         OC-AH-COMM-PCT
 15885                    MOVE CM-AH-CRITICAL-PERIOD  TO
 15886                         OC-AH-CP
 15887                    MOVE CM-LOAN-1ST-PMT-DT     TO
 15888                         OC-1ST-PMT-DT
 15889                 END-IF
 15890                 MOVE PB-C-LF-CANCEL-DT      TO
 15891                         OC-LF-CANCEL-DT
 15892                 MOVE PB-C-LF-CANCEL-AMT     TO
 15893                         OC-LF-CANCEL-AMT
 15894                 MOVE CM-LF-ITD-CANCEL-AMT   TO
 15895                         OC-LF-ITD-CANCEL-AMT
 15896                 MOVE PB-C-AH-CANCEL-DT      TO
 15897                         OC-AH-CANCEL-DT
 15898                 MOVE PB-C-AH-CANCEL-AMT     TO
 15899                         OC-AH-CANCEL-AMT
 15900                 MOVE CM-AH-ITD-CANCEL-AMT   TO
 15901                         OC-AH-ITD-CANCEL-AMT
 15902                 MOVE 'Y'                    TO
 15903                         OC-CANCEL-TRAN-IND
 15904                 MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15905                 MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15906                 MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15907                 IF ERMAIL-FOUND
 15908                    MOVE MA-CRED-BENE-NAME
 15909                                 TO OC-CRED-BENE-NAME
 15910                 END-IF
 15911                 IF NOT CERT-TRL-REC-NOT-FOUND
 15912                    MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15913                           OC-INS-AGE-DEFAULT-FLAG
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 291
* EL6311.cbl
 15914                    MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15915                           OC-JNT-AGE-DEFAULT-FLAG
 15916                 END-IF
 15917
 15918* EXEC CICS REWRITE
 15919*                   DATASET   ('ELCRTO')
 15920*                   FROM      (ORIGINAL-CERTIFICATE)
 15921*                   RESP      (WS-RESPONSE)
 15922*                END-EXEC
 15923     MOVE LENGTH OF
 15924      ORIGINAL-CERTIFICATE
 15925       TO DFHEIV11
 15926     MOVE 'ELCRTO' TO DFHEIV1
 15927*    MOVE '&& L                  %  N#00014145' TO DFHEIV0
 15928     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 15929     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 15930     MOVE X'204E233030303134313435' TO DFHEIV0(25:11)
 15931     CALL 'kxdfhei1' USING DFHEIV0,
 15932           DFHEIV1,
 15933           ORIGINAL-CERTIFICATE,
 15934           DFHEIV11,
 15935           DFHEIV99
 15936     MOVE EIBRESP  TO WS-RESPONSE
 15937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 15938                 display ' just rewrote ' ws-response
 15939              END-IF
 15940           END-IF
 15941        ELSE
 15942           SUBTRACT +1 FROM OC-KEY-SEQ-NO
 15943           MOVE 'OC'             TO OC-RECORD-ID
 15944           MOVE PI-PROCESSOR-ID  TO OC-LAST-MAINT-BY
 15945           MOVE EIBTIME          TO OC-LAST-MAINT-HHMMSS
 15946           MOVE WS-CURRENT-BIN-DT TO OC-LAST-MAINT-DT
 15947           MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 15948           MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 15949           MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 15950           MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 15951           MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
 15952           MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 15953           MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 15954           MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 15955           MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 15956           MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 15957           MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 15958           MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 15959           MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 15960           MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 15961           MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 15962           MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 15963           MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 15964           MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 15965           MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 15966           MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 15967           MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 15968           MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 15969           MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 15970           MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 15971           MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 292
* EL6311.cbl
 15972           MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 15973           MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 15974           MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 15975           MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 15976           MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 15977           MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 15978           MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 15979           IF ERMAIL-FOUND
 15980              MOVE MA-CRED-BENE-NAME
 15981                                 TO OC-CRED-BENE-NAME
 15982           END-IF
 15983           IF NOT CERT-TRL-REC-NOT-FOUND
 15984              MOVE CS-INS-AGE-DEFAULT-FLAG TO
 15985                           OC-INS-AGE-DEFAULT-FLAG
 15986              MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 15987                           OC-JNT-AGE-DEFAULT-FLAG
 15988           END-IF
 15989           MOVE LOW-VALUES       TO OC-ENDORSEMENT-PROCESSED-DT
 15990
 15991* EXEC CICS WRITE
 15992*             DATASET   ('ELCRTO')
 15993*             FROM      (ORIGINAL-CERTIFICATE)
 15994*             RIDFLD    (OC-CONTROL-PRIMARY)
 15995*             RESP      (WS-RESPONSE)
 15996*          END-EXEC
 15997     MOVE LENGTH OF
 15998      ORIGINAL-CERTIFICATE
 15999       TO DFHEIV11
 16000     MOVE 'ELCRTO' TO DFHEIV1
 16001*    MOVE '&$ L                  ''  N#00014202' TO DFHEIV0
 16002     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16003     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16004     MOVE X'204E233030303134323032' TO DFHEIV0(25:11)
 16005     CALL 'kxdfhei1' USING DFHEIV0,
 16006           DFHEIV1,
 16007           ORIGINAL-CERTIFICATE,
 16008           DFHEIV11,
 16009           OC-CONTROL-PRIMARY,
 16010           DFHEIV99,
 16011           DFHEIV99
 16012     MOVE EIBRESP  TO WS-RESPONSE
 16013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16014        END-IF
 16015     ELSE
 16016        MOVE SPACES              TO ORIGINAL-CERTIFICATE
 16017        MOVE 'OC'                TO OC-RECORD-ID
 16018        MOVE PB-CONTROL-BY-ACCOUNT (1:33)
 16019                                 TO OC-CONTROL-PRIMARY (1:33)
 16020        MOVE 'I'                 TO OC-RECORD-TYPE
 16021        MOVE +4096               TO OC-KEY-SEQ-NO
 16022        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
 16023        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
 16024        MOVE WS-CURRENT-BIN-DT   TO OC-LAST-MAINT-DT
 16025        MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
 16026        MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
 16027        MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
 16028        MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
 16029        MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 293
* EL6311.cbl
 16030        MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
 16031        MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
 16032        MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
 16033        MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
 16034        MOVE CM-LF-ORIG-TERM        TO OC-LF-TERM
 16035        MOVE CM-LF-BENEFIT-AMT      TO OC-LF-BEN-AMT
 16036        MOVE CM-LF-PREMIUM-AMT      TO OC-LF-PRM-AMT
 16037        MOVE CM-LF-ALT-BENEFIT-AMT  TO OC-LF-ALT-BEN-AMT
 16038        MOVE CM-LF-ALT-PREMIUM-AMT  TO OC-LF-ALT-PRM-AMT
 16039        MOVE CM-LF-LOAN-EXPIRE-DT   TO OC-LF-EXP-DT
 16040        MOVE CM-LIFE-COMM-PCT       TO OC-LF-COMM-PCT
 16041        MOVE PB-C-LF-CANCEL-DT      TO OC-LF-CANCEL-DT
 16042        MOVE PB-C-LF-CANCEL-AMT     TO OC-LF-CANCEL-AMT
 16043        MOVE CM-LF-ITD-CANCEL-AMT   TO OC-LF-ITD-CANCEL-AMT
 16044        MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
 16045        MOVE CM-AH-ORIG-TERM        TO OC-AH-TERM
 16046        MOVE CM-AH-BENEFIT-AMT      TO OC-AH-BEN-AMT
 16047        MOVE CM-AH-PREMIUM-AMT      TO OC-AH-PRM-AMT
 16048        MOVE CM-AH-LOAN-EXPIRE-DT   TO OC-AH-EXP-DT
 16049        MOVE CM-AH-COMM-PCT         TO OC-AH-COMM-PCT
 16050        MOVE CM-AH-CRITICAL-PERIOD  TO OC-AH-CP
 16051        MOVE PB-C-AH-CANCEL-DT      TO OC-AH-CANCEL-DT
 16052        MOVE PB-C-AH-CANCEL-AMT     TO OC-AH-CANCEL-AMT
 16053        MOVE CM-AH-ITD-CANCEL-AMT   TO OC-AH-ITD-CANCEL-AMT
 16054        MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
 16055        MOVE 'N'                    TO OC-ISSUE-TRAN-IND
 16056        MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
 16057        IF ERMAIL-FOUND
 16058           MOVE MA-CRED-BENE-NAME
 16059                                 TO OC-CRED-BENE-NAME
 16060        END-IF
 16061        IF NOT CERT-TRL-REC-NOT-FOUND
 16062           MOVE CS-INS-AGE-DEFAULT-FLAG TO
 16063                           OC-INS-AGE-DEFAULT-FLAG
 16064           MOVE CS-JNT-AGE-DEFAULT-FLAG TO
 16065                           OC-JNT-AGE-DEFAULT-FLAG
 16066        END-IF
 16067        MOVE LOW-VALUES          TO OC-ENDORSEMENT-PROCESSED-DT
 16068
 16069
 16070* EXEC CICS WRITE
 16071*          DATASET   ('ELCRTO')
 16072*          FROM      (ORIGINAL-CERTIFICATE)
 16073*          RIDFLD    (OC-CONTROL-PRIMARY)
 16074*          RESP      (WS-RESPONSE)
 16075*       END-EXEC
 16076     MOVE LENGTH OF
 16077      ORIGINAL-CERTIFICATE
 16078       TO DFHEIV11
 16079     MOVE 'ELCRTO' TO DFHEIV1
 16080*    MOVE '&$ L                  ''  N#00014263' TO DFHEIV0
 16081     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 16082     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16083     MOVE X'204E233030303134323633' TO DFHEIV0(25:11)
 16084     CALL 'kxdfhei1' USING DFHEIV0,
 16085           DFHEIV1,
 16086           ORIGINAL-CERTIFICATE,
 16087           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 294
* EL6311.cbl
 16088           OC-CONTROL-PRIMARY,
 16089           DFHEIV99,
 16090           DFHEIV99
 16091     MOVE EIBRESP  TO WS-RESPONSE
 16092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16093     END-IF.
 16094
 16095 2376-BYPASS-CRTO.
 16096******************************************************************
 16097*       U P D A T E   T H E   B A T C H   H E A D E R            *
 16098******************************************************************
 16099
 16100
 16101* EXEC CICS HANDLE CONDITION
 16102*         NOTFND    (2380-BATCH-HDR-NOT-FOUND)
 16103*    END-EXEC.
 16104*    MOVE '"$I                   ! 7 #00014276' TO DFHEIV0
 16105     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16107     MOVE X'3720233030303134323736' TO DFHEIV0(25:11)
 16108     CALL 'kxdfhei1' USING DFHEIV0
 16109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16110
 16111
 16112
 16113* EXEC CICS READ
 16114*        INTO    (PENDING-BUSINESS)
 16115*        DATASET (FILE-ID-ERPNDB)
 16116*        RIDFLD  (ERPNDB-KEY)
 16117*        UPDATE
 16118*    END-EXEC.
 16119     MOVE LENGTH OF
 16120      PENDING-BUSINESS
 16121       TO DFHEIV11
 16122*    MOVE '&"IL       EU         (   #00014280' TO DFHEIV0
 16123     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 16124     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16125     MOVE X'2020233030303134323830' TO DFHEIV0(25:11)
 16126     CALL 'kxdfhei1' USING DFHEIV0,
 16127           FILE-ID-ERPNDB,
 16128           PENDING-BUSINESS,
 16129           DFHEIV11,
 16130           ERPNDB-KEY,
 16131           DFHEIV99,
 16132           DFHEIV99,
 16133           DFHEIV99
 16134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16135
 16136
 16137     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16138     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 16139     MOVE 'B'                    TO JP-RECORD-TYPE.
 16140     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16141
 16142     PERFORM 8400-LOG-JOURNAL-RECORD.
 16143
 16144     MOVE WS-BATCH-RECORD        TO PB-BATCH-RECORD.
 16145
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 295
* EL6311.cbl
 16146
 16147* EXEC CICS REWRITE
 16148*        DATASET (FILE-ID-ERPNDB)
 16149*        FROM    (PENDING-BUSINESS)
 16150*    END-EXEC.
 16151     MOVE LENGTH OF
 16152      PENDING-BUSINESS
 16153       TO DFHEIV11
 16154*    MOVE '&& L                  %   #00014296' TO DFHEIV0
 16155     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16156     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16157     MOVE X'2020233030303134323936' TO DFHEIV0(25:11)
 16158     CALL 'kxdfhei1' USING DFHEIV0,
 16159           FILE-ID-ERPNDB,
 16160           PENDING-BUSINESS,
 16161           DFHEIV11,
 16162           DFHEIV99
 16163     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16164
 16165
 16166     MOVE 'C'                    TO JP-RECORD-TYPE.
 16167     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 16168
 16169     PERFORM 8400-LOG-JOURNAL-RECORD.
 16170
 16171     IF WS-ERRORS-PRESENT
 16172         GO TO 3900-RE-DISPLAY-RECORD.
 16173
 16174     MOVE ZEROS                  TO EMI-ERROR
 16175     MOVE -1                     TO CMAINTL
 16176     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16177     GO TO 3900-RE-DISPLAY-RECORD.
 16178
 16179 2380-BATCH-HDR-NOT-FOUND.
 16180     MOVE -1                     TO BMAINTL.
 16181     MOVE ER-7450                TO EMI-ERROR.
 16182     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16183     GO TO 8200-SEND-DATAONLY.
 16184
 16185 2385-REC-NOT-FOUND.
 16186     MOVE -1                     TO BMAINTL.
 16187     MOVE ER-7451                TO EMI-ERROR.
 16188     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16189     GO TO 8200-SEND-DATAONLY.
 16190
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 296
* EL6311.cbl
 16192
 16193******************************************************************
 16194*                                                                *
 16195*          D E L E T E   C A N C E L   R O U T I N E             *
 16196*                                                                *
 16197******************************************************************
 16198
 16199 2400-DELETE-CANCEL-ROUTINE.
 16200     MOVE 'D'                    TO PI-MAINT-FUNCTION.
 16201
 16202     IF CCHGL NOT = ZEROS
 16203        MOVE ER-2196             TO EMI-ERROR
 16204        MOVE AL-UABON            TO CMAINTA
 16205        MOVE -1                  TO CMAINTL
 16206        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16207        GO TO 8200-SEND-DATAONLY.
 16208
 16209
 16210* EXEC CICS HANDLE CONDITION
 16211*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16212*    END-EXEC.
 16213*    MOVE '"$I                   ! 8 #00014344' TO DFHEIV0
 16214     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16215     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16216     MOVE X'3820233030303134333434' TO DFHEIV0(25:11)
 16217     CALL 'kxdfhei1' USING DFHEIV0
 16218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16219
 16220
 16221     MOVE PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 16222     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16223     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16224
 16225
 16226* EXEC CICS READ
 16227*        SET     (ADDRESS OF PENDING-BUSINESS)
 16228*        DATASET (FILE-ID-ERPNDB)
 16229*        RIDFLD  (ERPNDB-KEY)
 16230*    END-EXEC.
 16231*    MOVE '&"S        E          (   #00014352' TO DFHEIV0
 16232     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16233     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16234     MOVE X'2020233030303134333532' TO DFHEIV0(25:11)
 16235     CALL 'kxdfhei1' USING DFHEIV0,
 16236           FILE-ID-ERPNDB,
 16237           DFHEIV20,
 16238           DFHEIV99,
 16239           ERPNDB-KEY,
 16240           DFHEIV99,
 16241           DFHEIV99,
 16242           DFHEIV99
 16243     SET ADDRESS OF PENDING-BUSINESS TO
 16244         DFHEIV20
 16245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16246
 16247
 16248     MOVE PB-BATCH-RECORD        TO WS-BATCH-RECORD.
 16249
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 297
* EL6311.cbl
 16250     MOVE CCERTNOI               TO WS-NEW-PRIME.
 16251
 16252     IF CSUFIXL NOT = ZEROS
 16253        MOVE CSUFIXI             TO WS-NEW-SUFFIX
 16254     ELSE
 16255        MOVE SPACE               TO WS-NEW-SUFFIX.
 16256
 16257     MOVE CEFFDTI                TO DEEDIT-FIELD.
 16258
 16259     PERFORM 8600-DEEDIT.
 16260     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
 16261     MOVE '4'                    TO DC-OPTION-CODE.
 16262     PERFORM 9700-DATE-LINK.
 16263
 16264     IF DATE-CONVERSION-ERROR
 16265        MOVE ER-0348             TO EMI-ERROR
 16266        MOVE -1                  TO CEFFDTL
 16267        MOVE AL-UABON            TO CEFFDTA
 16268        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16269        GO TO 8200-SEND-DATAONLY
 16270     ELSE
 16271        MOVE DC-GREG-DATE-1-EDIT TO CEFFDTI
 16272        MOVE AL-UANON            TO CEFFDTA
 16273        MOVE DC-BIN-DATE-1       TO WS-NEW-CERT-EFF-DT.
 16274
 16275
 16276* EXEC CICS HANDLE CONDITION
 16277*         NOTFND    (2490-RECORD-NOT-FOUND)
 16278*    END-EXEC.
 16279*    MOVE '"$I                   ! 9 #00014385' TO DFHEIV0
 16280     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16281     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16282     MOVE X'3920233030303134333835' TO DFHEIV0(25:11)
 16283     CALL 'kxdfhei1' USING DFHEIV0
 16284     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16285
 16286
 16287
 16288* EXEC CICS READ
 16289*        SET     (ADDRESS OF PENDING-BUSINESS)
 16290*        DATASET (FILE-ID-ERPNDB)
 16291*        RIDFLD  (PI-PREV-CONTROL-PRIMARY)
 16292*        UPDATE
 16293*    END-EXEC.
 16294*    MOVE '&"S        EU         (   #00014389' TO DFHEIV0
 16295     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16296     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16297     MOVE X'2020233030303134333839' TO DFHEIV0(25:11)
 16298     CALL 'kxdfhei1' USING DFHEIV0,
 16299           FILE-ID-ERPNDB,
 16300           DFHEIV20,
 16301           DFHEIV99,
 16302           PI-PREV-CONTROL-PRIMARY,
 16303           DFHEIV99,
 16304           DFHEIV99,
 16305           DFHEIV99
 16306     SET ADDRESS OF PENDING-BUSINESS TO
 16307         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 298
* EL6311.cbl
 16308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16309
 16310
 16311     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 16312        MOVE -1                 TO CMAINTL
 16313        MOVE ER-2197            TO EMI-ERROR
 16314        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16315        GO TO 8200-SEND-DATAONLY.
 16316
 16317     IF PB-BILLED-DT NOT = LOW-VALUES
 16318        MOVE -1                 TO CMAINTL
 16319        MOVE ER-2129            TO EMI-ERROR
 16320        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16321        GO TO 8200-SEND-DATAONLY.
 16322
 16323     IF PB-CHG-COUNT NOT = ZEROS
 16324        MOVE ER-2336            TO EMI-ERROR
 16325        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16326        MOVE AL-UABON            TO CMAINTA
 16327        MOVE -1                  TO CMAINTL
 16328        GO TO 8200-SEND-DATAONLY.
 16329
 16330     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 16331        PB-CHG-COUNT NOT = ZEROS
 16332        MOVE ER-2196             TO EMI-ERROR
 16333        MOVE AL-UABON            TO CMAINTA
 16334        MOVE -1                  TO CMAINTL
 16335        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16336        GO TO 8200-SEND-DATAONLY.
 16337
 16338     IF PB-CONFIRMATION-REPT-DT NOT = SPACES AND LOW-VALUES
 16339        MOVE ER-2900 TO EMI-ERROR
 16340        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16341        MOVE AL-UABON         TO CMAINTA
 16342        MOVE -1               TO CMAINTL
 16343        GO TO 8200-SEND-DATAONLY.
 16344     move ' '                    to ws-stop-sw
 16345                                    ws-check-sw
 16346                                    ws-any-check-sw
 16347                                    ws-proc-check-sw
 16348                                    ws-chek-browse-sw
 16349
 16350     perform 2500-browse-checks  thru 2500-exit
 16351     if (i-have-processed-checks)
 16352        and (pb-c-refund-sw = 'Y')
 16353        move er-3446             to emi-error
 16354        perform 9900-error-format thru 9900-exit
 16355        move al-uabon            to cmainta
 16356        move -1                  to cmaintl
 16357        go to 8200-send-dataonly
 16358     end-if
 16359
 16360* EXEC CICS HANDLE CONDITION
 16361*         NOTFND  (2475-CONTINUE-DELETE)
 16362*    END-EXEC
 16363*    MOVE '"$I                   ! : #00014444' TO DFHEIV0
 16364     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16365     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 299
* EL6311.cbl
 16366     MOVE X'3A20233030303134343434' TO DFHEIV0(25:11)
 16367     CALL 'kxdfhei1' USING DFHEIV0
 16368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16369
 16370     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 16371     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 16372     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 16373     MOVE PB-SV-STATE            TO ELCERT-STATE.
 16374
 16375
 16376* EXEC CICS READ
 16377*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 16378*        DATASET (FILE-ID-ELCERT)
 16379*        RIDFLD  (ELCERT-KEY)
 16380*        UPDATE
 16381*    END-EXEC.
 16382*    MOVE '&"S        EU         (   #00014453' TO DFHEIV0
 16383     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16384     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16385     MOVE X'2020233030303134343533' TO DFHEIV0(25:11)
 16386     CALL 'kxdfhei1' USING DFHEIV0,
 16387           FILE-ID-ELCERT,
 16388           DFHEIV20,
 16389           DFHEIV99,
 16390           ELCERT-KEY,
 16391           DFHEIV99,
 16392           DFHEIV99,
 16393           DFHEIV99
 16394     SET ADDRESS OF CERTIFICATE-MASTER TO
 16395         DFHEIV20
 16396     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16397
 16398
 16399     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16400
 16401     MOVE FILE-ID-ELCERT         TO JP-FILE-ID.
 16402     MOVE 'B'                    TO JP-RECORD-TYPE.
 16403     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 16404     PERFORM 8400-LOG-JOURNAL-RECORD.
 16405
 16406     IF PB-CI-LIVES NOT NUMERIC
 16407         MOVE ZERO                    TO PB-CI-LIVES.
 16408
 16409     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16410        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 16411           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16412           MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 16413           MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 16414                                            CM-LF-CANCEL-DT
 16415           MOVE SPACE                    TO CM-LF-EXIT-BATCH
 16416        ELSE
 16417           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16418           MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 16419           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 16420           MOVE PB-CI-LIVES              TO CM-LIVES.
 16421
 16422     IF PB-C-LF-CANCEL-DT GREATER THAN LOW-VALUES
 16423        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 300
* EL6311.cbl
 16424           IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16425               MOVE CM-LF-STATUS-AT-CANCEL
 16426                                        TO CM-LF-CURRENT-STATUS
 16427               MOVE SPACE
 16428                                        TO CM-LF-STATUS-AT-CANCEL
 16429           ELSE
 16430               MOVE PB-CI-LF-POLICY-STATUS
 16431                                        TO CM-LF-CURRENT-STATUS
 16432        ELSE
 16433           MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 16434
 16435
 16436     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16437        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16438           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16439           MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 16440           MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 16441                                            CM-AH-CANCEL-DT
 16442           MOVE SPACE                    TO CM-AH-EXIT-BATCH
 16443        ELSE
 16444           MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-2
 16445           MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 16446           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 16447           MOVE PB-CI-LIVES              TO CM-LIVES.
 16448
 16449     IF PB-C-AH-CANCEL-DT GREATER THAN LOW-VALUES
 16450        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 16451           IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 16452               MOVE CM-AH-STATUS-AT-CANCEL
 16453                                        TO CM-AH-CURRENT-STATUS
 16454               MOVE SPACE
 16455                                        TO CM-AH-STATUS-AT-CANCEL
 16456           ELSE
 16457               MOVE PB-CI-AH-POLICY-STATUS
 16458                                        TO CM-AH-CURRENT-STATUS
 16459        ELSE
 16460           MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 16461
 16462 2450-REWRITE-CERT.
 16463     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 16464     MOVE 'C'                      TO JP-RECORD-TYPE.
 16465     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 16466
 16467
 16468* EXEC CICS REWRITE
 16469*        DATASET  (FILE-ID-ELCERT)
 16470*        FROM     (CERTIFICATE-MASTER)
 16471*    END-EXEC.
 16472     MOVE LENGTH OF
 16473      CERTIFICATE-MASTER
 16474       TO DFHEIV11
 16475*    MOVE '&& L                  %   #00014528' TO DFHEIV0
 16476     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16477     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16478     MOVE X'2020233030303134353238' TO DFHEIV0(25:11)
 16479     CALL 'kxdfhei1' USING DFHEIV0,
 16480           FILE-ID-ELCERT,
 16481           CERTIFICATE-MASTER,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 301
* EL6311.cbl
 16482           DFHEIV11,
 16483           DFHEIV99
 16484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16485
 16486
 16487     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16488
 16489     PERFORM 8400-LOG-JOURNAL-RECORD.
 16490
 16491     move ' '                    to ws-stop-sw
 16492                                    ws-any-check-sw
 16493                                    ws-proc-check-sw
 16494                                    ws-chek-browse-sw
 16495
 16496     if i-have-checks
 16497        perform until i-say-stop
 16498           perform 2510-startbr-erchek
 16499                                 thru 2510-exit
 16500           if resp-normal
 16501              perform 2520-readnext-erchek
 16502                                 thru 2520-exit
 16503           end-if
 16504           if (not resp-normal)
 16505              or (pb-control-by-account (1:33) not =
 16506                 ch-control-primary (1:33))
 16507                 set i-say-stop to true
 16508           else
 16509              perform 2530-readupd-erchek
 16510                                 thru 2530-exit
 16511              if resp-normal
 16512                 perform 2540-delete-erchek
 16513                                 thru 2540-exit
 16514              end-if
 16515              if ws-chek-browse-sw = 'Y'
 16516                 perform 2525-endbr-erchek
 16517                                 thru 2525-exit
 16518                 move ' '        to ws-chek-browse-sw
 16519              end-if
 16520           end-if
 16521        end-perform
 16522     end-if
 16523
 16524     if ws-chek-browse-sw = 'Y'
 16525        perform 2525-endbr-erchek thru 2525-exit
 16526     end-if
 16527     .
 16528 2475-CONTINUE-DELETE.
 16529     SUBTRACT PB-C-LF-CANCEL-AMT  FROM WS-B-LF-CAN-PRM-ENTERED.
 16530     SUBTRACT PB-C-AH-CANCEL-AMT  FROM WS-B-AH-CAN-PRM-ENTERED.
 16531
 16532     SUBTRACT PB-C-LF-REF-CALC    FROM WS-B-LF-CAN-PRM-COMPUTED.
 16533     SUBTRACT PB-C-AH-REF-CALC    FROM WS-B-AH-CAN-PRM-COMPUTED.
 16534
 16535     SUBTRACT +1 FROM WS-B-CANCEL-CNT-ENTERED.
 16536
 16537     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID
 16538     MOVE 'D'                    TO JP-RECORD-TYPE
 16539     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 302
* EL6311.cbl
 16540
 16541
 16542* EXEC CICS DELETE
 16543*        DATASET    (FILE-ID-ERPNDB)
 16544*    END-EXEC.
 16545*    MOVE '&(                    &   #00014587' TO DFHEIV0
 16546     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16547     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16548     MOVE X'2020233030303134353837' TO DFHEIV0(25:11)
 16549     CALL 'kxdfhei1' USING DFHEIV0,
 16550           FILE-ID-ERPNDB,
 16551           DFHEIV99,
 16552           DFHEIV99,
 16553           DFHEIV99,
 16554           DFHEIV99
 16555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16556
 16557
 16558     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 16559
 16560     PERFORM 8400-LOG-JOURNAL-RECORD.
 16561
 16562     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 16563     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 16564
 16565
 16566* EXEC CICS HANDLE CONDITION
 16567*         NOTFND    (2485-BATCH-HDR-NOT-FOUND)
 16568*    END-EXEC.
 16569*    MOVE '"$I                   ! ; #00014598' TO DFHEIV0
 16570     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16571     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16572     MOVE X'3B20233030303134353938' TO DFHEIV0(25:11)
 16573     CALL 'kxdfhei1' USING DFHEIV0
 16574     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16575
 16576
 16577
 16578* EXEC CICS READ
 16579*        SET     (ADDRESS OF PENDING-BUSINESS)
 16580*        DATASET (FILE-ID-ERPNDB)
 16581*        RIDFLD  (ERPNDB-KEY)
 16582*        UPDATE
 16583*    END-EXEC.
 16584*    MOVE '&"S        EU         (   #00014602' TO DFHEIV0
 16585     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16586     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16587     MOVE X'2020233030303134363032' TO DFHEIV0(25:11)
 16588     CALL 'kxdfhei1' USING DFHEIV0,
 16589           FILE-ID-ERPNDB,
 16590           DFHEIV20,
 16591           DFHEIV99,
 16592           ERPNDB-KEY,
 16593           DFHEIV99,
 16594           DFHEIV99,
 16595           DFHEIV99
 16596     SET ADDRESS OF PENDING-BUSINESS TO
 16597         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 303
* EL6311.cbl
 16598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16599
 16600
 16601     MOVE FILE-ID-ERPNDB           TO JP-FILE-ID.
 16602     MOVE ERPNDB-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16603
 16604     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16605        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16606        MOVE 'D'                 TO JP-RECORD-TYPE
 16607        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16608
 16609* EXEC CICS DELETE
 16610*            DATASET    (FILE-ID-ERPNDB)
 16611*       END-EXEC
 16612*    MOVE '&(                    &   #00014616' TO DFHEIV0
 16613     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16614     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16615     MOVE X'2020233030303134363136' TO DFHEIV0(25:11)
 16616     CALL 'kxdfhei1' USING DFHEIV0,
 16617           FILE-ID-ERPNDB,
 16618           DFHEIV99,
 16619           DFHEIV99,
 16620           DFHEIV99,
 16621           DFHEIV99
 16622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16623        PERFORM 8400-LOG-JOURNAL-RECORD
 16624     ELSE
 16625        MOVE 'B'                 TO JP-RECORD-TYPE
 16626        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16627        PERFORM 8400-LOG-JOURNAL-RECORD
 16628        MOVE WS-BATCH-RECORD     TO PB-BATCH-RECORD
 16629        MOVE 'C'                 TO JP-RECORD-TYPE
 16630        MOVE PENDING-BUSINESS    TO JP-RECORD-AREA
 16631
 16632* EXEC CICS REWRITE
 16633*            DATASET    (FILE-ID-ERPNDB)
 16634*            FROM       (PENDING-BUSINESS)
 16635*       END-EXEC
 16636     MOVE LENGTH OF
 16637      PENDING-BUSINESS
 16638       TO DFHEIV11
 16639*    MOVE '&& L                  %   #00014627' TO DFHEIV0
 16640     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16641     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16642     MOVE X'2020233030303134363237' TO DFHEIV0(25:11)
 16643     CALL 'kxdfhei1' USING DFHEIV0,
 16644           FILE-ID-ERPNDB,
 16645           PENDING-BUSINESS,
 16646           DFHEIV11,
 16647           DFHEIV99
 16648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16649        PERFORM 8400-LOG-JOURNAL-RECORD.
 16650
 16651******************************************************************
 16652*                                                                *
 16653*       DELETE THE A/R REQUEST RECORD IF THE COMPANY USES        *
 16654*       THE ACCOUNTS RECEIVABLE SYSTEM.                          *
 16655*                                                                *
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 304
* EL6311.cbl
 16656******************************************************************
 16657
 16658     IF NOT PI-AR-PROCESSING
 16659        GO TO 2480-DELETE-FINISHED.
 16660
 16661     IF WS-B-ISSUE-CNT-ENTERED  = ZEROS AND
 16662        WS-B-CANCEL-CNT-ENTERED = ZEROS
 16663        NEXT SENTENCE
 16664     ELSE
 16665        GO TO 2480-DELETE-FINISHED.
 16666
 16667
 16668* EXEC CICS HANDLE CONDITION
 16669*         NOTFND    (2480-DELETE-FINISHED)
 16670*    END-EXEC.
 16671*    MOVE '"$I                   ! < #00014649' TO DFHEIV0
 16672     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 16673     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16674     MOVE X'3C20233030303134363439' TO DFHEIV0(25:11)
 16675     CALL 'kxdfhei1' USING DFHEIV0
 16676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16677
 16678
 16679     MOVE ERPNDB-COMPANY-CD      TO ERRQST-COMPANY-CD.
 16680     MOVE ERPNDB-ENTRY-BATCH     TO ERRQST-ENTRY-BATCH.
 16681
 16682
 16683* EXEC CICS READ
 16684*        SET     (ADDRESS OF AR-REQUEST-RECORD)
 16685*        DATASET (FILE-ID-ERRQST)
 16686*        RIDFLD  (ERRQST-KEY)
 16687*        UPDATE
 16688*    END-EXEC.
 16689*    MOVE '&"S        EU         (   #00014656' TO DFHEIV0
 16690     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16691     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16692     MOVE X'2020233030303134363536' TO DFHEIV0(25:11)
 16693     CALL 'kxdfhei1' USING DFHEIV0,
 16694           FILE-ID-ERRQST,
 16695           DFHEIV20,
 16696           DFHEIV99,
 16697           ERRQST-KEY,
 16698           DFHEIV99,
 16699           DFHEIV99,
 16700           DFHEIV99
 16701     SET ADDRESS OF AR-REQUEST-RECORD TO
 16702         DFHEIV20
 16703     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16704
 16705
 16706     MOVE ERRQST-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 16707
 16708     MOVE  FILE-ID-ERRQST          TO JP-FILE-ID.
 16709
 16710     MOVE 'D'                      TO JP-RECORD-TYPE.
 16711     MOVE AR-REQUEST-RECORD        TO JP-RECORD-AREA.
 16712
 16713
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 305
* EL6311.cbl
 16714* EXEC CICS DELETE
 16715*         DATASET    (FILE-ID-ERRQST)
 16716*    END-EXEC.
 16717*    MOVE '&(                    &   #00014670' TO DFHEIV0
 16718     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16719     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16720     MOVE X'2020233030303134363730' TO DFHEIV0(25:11)
 16721     CALL 'kxdfhei1' USING DFHEIV0,
 16722           FILE-ID-ERRQST,
 16723           DFHEIV99,
 16724           DFHEIV99,
 16725           DFHEIV99,
 16726           DFHEIV99
 16727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16728
 16729
 16730     PERFORM 8400-LOG-JOURNAL-RECORD.
 16731
 16732 2480-DELETE-FINISHED.
 16733     MOVE ZEROS                  TO EMI-ERROR.
 16734     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16735     MOVE LOW-VALUES             TO EL631CI.
 16736     MOVE -1                     TO CMAINTL.
 16737     GO TO 8100-SEND-INITIAL-MAP.
 16738
 16739 2485-BATCH-HDR-NOT-FOUND.
 16740     MOVE -1                     TO CMAINTL
 16741     MOVE AL-UABON               TO CMAINTA.
 16742     MOVE ER-7450                TO EMI-ERROR.
 16743     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16744     GO TO 8200-SEND-DATAONLY.
 16745
 16746 2490-RECORD-NOT-FOUND.
 16747     MOVE -1                     TO CMAINTL
 16748     MOVE AL-UABON               TO CMAINTA.
 16749     MOVE ER-7451                TO EMI-ERROR.
 16750     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16751     GO TO 8200-SEND-DATAONLY.
 16752***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
 16753***                                                            ***
 16754***     2500  B R O W S E   C H E C K S                        ***
 16755***  We perform this routine from 2 different places.          ***
 16756***  1. If the user changes the refund amount on a cancel, we  ***
 16757***    want to.........                                        ***
 16758***    a. determine if prior checks have been processed        ***
 16759***    b. If the amt is larger, display message instructing    ***
 16760***     them to create another check to make up the difference.***
 16761***    c. If the amt is less, do not allow the change and      ***
 16762***     display a FATAL error suggesting they deal with check  ***
 16763***     records befor continuing.                              ***
 16764***  2. If the user wants to delete a cancel record we......   ***
 16765***    a. browse through all the checks and if there is a      ***
 16766***     processed check, send FATAL message.                   ***
 16767***    b. If there is a non-released check, then delete that   ***
 16768***     check after you delete the pending cancel record.      ***
 16769***                                                            ***
 16770***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
 16771
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 306
* EL6311.cbl
 16772 2500-browse-checks.
 16773
 16774     perform 2510-startbr-erchek thru 2510-exit
 16775
 16776     if not resp-normal
 16777        go to 2500-exit
 16778     end-if
 16779
 16780     perform until i-say-stop
 16781        perform 2520-readnext-erchek
 16782                                 thru 2520-exit
 16783        if (not resp-normal)
 16784           or (pb-control-by-account (1:33) not =
 16785              ch-control-primary (1:33))
 16786              set i-say-stop to true
 16787        else
 16788           set i-have-a-check-period to true
 16789           if (ch-approval-status) = ' '
 16790              and (ch-void-dt = low-values)
 16791              and (ch-released-dt = low-values)
 16792              set i-have-checks to true
 16793           else
 16794              if ch-void-dt = low-values
 16795                 set i-have-processed-checks to true
 16796              end-if
 16797           end-if
 16798           if (ch-credit-accept-dt = low-values)
 16799              and (ch-void-dt = low-values)
 16800              and (ch-approval-status = ' ' OR 'P' OR 'A')
 16801              if (ch-check-origin-sw not = 'R')
 16802                 and (pb-record-type = '2')
 16803                 continue
 16804              else
 16805                 compute ws-check-amts =
 16806                    ws-check-amts + ch-amount-paid
 16807              end-if
 16808           end-if
 16809        end-if
 16810     end-perform
 16811
 16812     if ws-chek-browse-sw = 'Y'
 16813        perform 2525-endbr-erchek thru 2525-exit
 16814     end-if
 16815
 16816    .
 16817 2500-exit.
 16818     exit.
 16819
 16820 2510-startbr-erchek.
 16821
 16822     move pb-control-by-account  to erchek-key
 16823     move +0                     to chek-record-seq
 16824
 16825
 16826* exec cics startbr
 16827*       dataset   ('ERCHEK')
 16828*       ridfld    (erchek-key)
 16829*       gteq
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 307
* EL6311.cbl
 16830*       resp      (ws-response)
 16831*    end-exec
 16832     MOVE 'ERCHEK' TO DFHEIV1
 16833     MOVE 0
 16834       TO DFHEIV11
 16835*    MOVE '&,         G          &  N#00014769' TO DFHEIV0
 16836     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 16837     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16838     MOVE X'204E233030303134373639' TO DFHEIV0(25:11)
 16839     CALL 'kxdfhei1' USING DFHEIV0,
 16840           DFHEIV1,
 16841           erchek-key,
 16842           DFHEIV99,
 16843           DFHEIV11,
 16844           DFHEIV99
 16845     MOVE EIBRESP  TO ws-response
 16846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16847
 16848     IF RESP-NORMAL
 16849        move 'Y'                 to ws-chek-browse-sw
 16850     end-if
 16851
 16852     .
 16853 2510-exit.
 16854     exit.
 16855
 16856 2520-readnext-erchek.
 16857
 16858
 16859* EXEC CICS READNEXT
 16860*       SET     (ADDRESS OF CHECK-RECORDS)
 16861*       DATASET ('ERCHEK')
 16862*       RIDFLD  (ERCHEK-KEY)
 16863*       RESP    (WS-RESPONSE)
 16864*    END-EXEC
 16865     MOVE 'ERCHEK' TO DFHEIV1
 16866     MOVE 0
 16867       TO DFHEIV11
 16868*    MOVE '&.S                   )  N#00014786' TO DFHEIV0
 16869     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 16870     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 16871     MOVE X'204E233030303134373836' TO DFHEIV0(25:11)
 16872     CALL 'kxdfhei1' USING DFHEIV0,
 16873           DFHEIV1,
 16874           DFHEIV20,
 16875           DFHEIV99,
 16876           ERCHEK-KEY,
 16877           DFHEIV99,
 16878           DFHEIV11,
 16879           DFHEIV99,
 16880           DFHEIV99
 16881     SET ADDRESS OF CHECK-RECORDS TO
 16882         DFHEIV20
 16883     MOVE EIBRESP  TO WS-RESPONSE
 16884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16885
 16886     .
 16887 2520-exit.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 308
* EL6311.cbl
 16888     exit.
 16889
 16890 2525-endbr-erchek.
 16891
 16892
 16893* exec cics endbr
 16894*       dataset  ('ERCHEK')
 16895*    end-exec
 16896     MOVE 'ERCHEK' TO DFHEIV1
 16897     MOVE 0
 16898       TO DFHEIV11
 16899*    MOVE '&2                    $   #00014799' TO DFHEIV0
 16900     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 16901     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 16902     MOVE X'2020233030303134373939' TO DFHEIV0(25:11)
 16903     CALL 'kxdfhei1' USING DFHEIV0,
 16904           DFHEIV1,
 16905           DFHEIV11,
 16906           DFHEIV99
 16907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16908
 16909     .
 16910 2525-exit.
 16911     exit.
 16912
 16913 2530-readupd-erchek.
 16914
 16915
 16916* EXEC CICS READ
 16917*       UPDATE
 16918*       SET     (ADDRESS OF CHECK-RECORDS)
 16919*       DATASET ('ERCHEK')
 16920*       RIDFLD  (ERCHEK-KEY)
 16921*       RESP    (WS-RESPONSE)
 16922*    END-EXEC
 16923     MOVE 'ERCHEK' TO DFHEIV1
 16924*    MOVE '&"S        EU         (  N#00014809' TO DFHEIV0
 16925     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16926     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16927     MOVE X'204E233030303134383039' TO DFHEIV0(25:11)
 16928     CALL 'kxdfhei1' USING DFHEIV0,
 16929           DFHEIV1,
 16930           DFHEIV20,
 16931           DFHEIV99,
 16932           ERCHEK-KEY,
 16933           DFHEIV99,
 16934           DFHEIV99,
 16935           DFHEIV99
 16936     SET ADDRESS OF CHECK-RECORDS TO
 16937         DFHEIV20
 16938     MOVE EIBRESP  TO WS-RESPONSE
 16939     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16940
 16941     .
 16942 2530-exit.
 16943     exit.
 16944
 16945 2540-delete-erchek.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 309
* EL6311.cbl
 16946
 16947
 16948* EXEC CICS DELETE
 16949*       DATASET ('ERCHEK')
 16950*       RESP    (WS-RESPONSE)
 16951*    END-EXEC
 16952     MOVE 'ERCHEK' TO DFHEIV1
 16953*    MOVE '&(                    &  N#00014823' TO DFHEIV0
 16954     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 16955     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 16956     MOVE X'204E233030303134383233' TO DFHEIV0(25:11)
 16957     CALL 'kxdfhei1' USING DFHEIV0,
 16958           DFHEIV1,
 16959           DFHEIV99,
 16960           DFHEIV99,
 16961           DFHEIV99,
 16962           DFHEIV99
 16963     MOVE EIBRESP  TO WS-RESPONSE
 16964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16965
 16966     .
 16967 2540-exit.
 16968     exit.
 16969***************************************************************
 16970*                                                             *
 16971*       B U I L D   C O R R E C T I O N   R E C O R D         *
 16972*                                                             *
 16973***************************************************************
 16974
 16975***************************************************************
 16976*     ROUTINE TO CREATE COPY OF ZERO RECORD WHEN CHANGING     *
 16977*     AN ALREADY BILLED RECORD.                               *
 16978***************************************************************
 16979
 16980 2700-BUILD-CORRECTION-RECORD.
 16981     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 16982     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 16983     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 16984     MOVE '5'                    TO DC-OPTION-CODE.
 16985     PERFORM 9700-DATE-LINK.
 16986     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 16987
 16988     IF PB-CHG-COUNT = ZEROS
 16989        MOVE +1                  TO WS-SEQ-SAVE
 16990     ELSE
 16991        ADD +1  PB-CHG-COUNT     TO WS-SEQ-SAVE.
 16992
 16993     COMPUTE PB-BATCH-CHG-SEQ-NO = 1000 - WS-SEQ-SAVE.
 16994     MOVE PB-BATCH-CHG-SEQ-NO    TO PB-ALT-CHG-SEQ-NO.
 16995
 16996     MOVE PB-CONTROL-PRIMARY     TO PB-CONTROL-BY-ORIG-BATCH.
 16997
 16998     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 16999     MOVE 'A'                    TO JP-RECORD-TYPE.
 17000     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17001
 17002
 17003* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 310
* EL6311.cbl
 17004*        DATASET    (FILE-ID-ERPNDB)
 17005*        FROM       (PENDING-BUSINESS)
 17006*        RIDFLD     (PB-CONTROL-PRIMARY)
 17007*    END-EXEC.
 17008     MOVE LENGTH OF
 17009      PENDING-BUSINESS
 17010       TO DFHEIV11
 17011*    MOVE '&$ L                  ''   #00014864' TO DFHEIV0
 17012     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17013     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17014     MOVE X'2020233030303134383634' TO DFHEIV0(25:11)
 17015     CALL 'kxdfhei1' USING DFHEIV0,
 17016           FILE-ID-ERPNDB,
 17017           PENDING-BUSINESS,
 17018           DFHEIV11,
 17019           PB-CONTROL-PRIMARY,
 17020           DFHEIV99,
 17021           DFHEIV99
 17022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17023
 17024
 17025     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17026
 17027     PERFORM 8400-LOG-JOURNAL-RECORD.
 17028
 17029 2799-EXIT.
 17030      EXIT.
 17031
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 311
* EL6311.cbl
 17033
 17034******************************************************************
 17035*                                                                *
 17036*        R E W R I T E   I S S U E   C E R T.   K E Y            *
 17037*                                                                *
 17038******************************************************************
 17039
 17040 2800-REWRITE-ISSUE-CERT-KEY.
 17041     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17042
 17043     IF  BCERTNOL GREATER THAN ZEROS
 17044         MOVE BCERTNOI           TO  ERPNDB-CERT-PRIME.
 17045
 17046     IF  BSUFIXL  GREATER THAN ZEROS
 17047         MOVE BSUFIXI            TO  ERPNDB-CERT-SFX.
 17048
 17049     IF  BEFFDTL  GREATER THAN ZEROS
 17050         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17051
 17052 2810-READ-BY-ACCOUNT.
 17053
 17054* EXEC CICS HANDLE CONDITION
 17055*         NOTFND    (2820-PROCESS-REWRITE)
 17056*    END-EXEC.
 17057*    MOVE '"$I                   ! = #00014898' TO DFHEIV0
 17058     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17059     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17060     MOVE X'3D20233030303134383938' TO DFHEIV0(25:11)
 17061     CALL 'kxdfhei1' USING DFHEIV0
 17062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17063
 17064
 17065***  read pndb using new key
 17066
 17067* EXEC CICS READ
 17068*        SET     (ADDRESS OF PENDING-BUSINESS)
 17069*        DATASET (FILE-ID-ERPNDB2)
 17070*        RIDFLD  (ERPNDB-ALT-KEY)
 17071*    END-EXEC.
 17072*    MOVE '&"S        E          (   #00014903' TO DFHEIV0
 17073     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17074     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17075     MOVE X'2020233030303134393033' TO DFHEIV0(25:11)
 17076     CALL 'kxdfhei1' USING DFHEIV0,
 17077           FILE-ID-ERPNDB2,
 17078           DFHEIV20,
 17079           DFHEIV99,
 17080           ERPNDB-ALT-KEY,
 17081           DFHEIV99,
 17082           DFHEIV99,
 17083           DFHEIV99
 17084     SET ADDRESS OF PENDING-BUSINESS TO
 17085         DFHEIV20
 17086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17087
 17088
 17089     GO TO 2890-DUPLICATE-RECORD.
 17090
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 312
* EL6311.cbl
 17091  2820-PROCESS-REWRITE.
 17092
 17093* EXEC CICS HANDLE CONDITION
 17094*         NOTFND    (2885-RECORD-MISSING)
 17095*    END-EXEC.
 17096*    MOVE '"$I                   ! > #00014912' TO DFHEIV0
 17097     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17099     MOVE X'3E20233030303134393132' TO DFHEIV0(25:11)
 17100     CALL 'kxdfhei1' USING DFHEIV0
 17101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17102
 17103
 17104     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17105
 17106***  read pndb using original key
 17107
 17108* EXEC CICS READ
 17109*        SET     (ADDRESS OF PENDING-BUSINESS)
 17110*        DATASET (FILE-ID-ERPNDB)
 17111*        RIDFLD  (ERPNDB-KEY)
 17112*        UPDATE
 17113*    END-EXEC.
 17114*    MOVE '&"S        EU         (   #00014919' TO DFHEIV0
 17115     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17116     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17117     MOVE X'2020233030303134393139' TO DFHEIV0(25:11)
 17118     CALL 'kxdfhei1' USING DFHEIV0,
 17119           FILE-ID-ERPNDB,
 17120           DFHEIV20,
 17121           DFHEIV99,
 17122           ERPNDB-KEY,
 17123           DFHEIV99,
 17124           DFHEIV99,
 17125           DFHEIV99
 17126     SET ADDRESS OF PENDING-BUSINESS TO
 17127         DFHEIV20
 17128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17129
 17130
 17131     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17132     MOVE 'D'                    TO JP-RECORD-TYPE.
 17133     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17134     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17135
 17136     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17137
 17138     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17139     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17140     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17141
 17142***  delete pndb using original key
 17143
 17144* EXEC CICS DELETE
 17145*        DATASET    (FILE-ID-ERPNDB)
 17146*    END-EXEC.
 17147*    MOVE '&(                    &   #00014938' TO DFHEIV0
 17148     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 313
* EL6311.cbl
 17149     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17150     MOVE X'2020233030303134393338' TO DFHEIV0(25:11)
 17151     CALL 'kxdfhei1' USING DFHEIV0,
 17152           FILE-ID-ERPNDB,
 17153           DFHEIV99,
 17154           DFHEIV99,
 17155           DFHEIV99,
 17156           DFHEIV99
 17157     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17158
 17159
 17160     PERFORM 8400-LOG-JOURNAL-RECORD.
 17161
 17162
 17163* EXEC CICS GETMAIN
 17164*        SET      (ADDRESS OF PENDING-BUSINESS)
 17165*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17166*        INITIMG  (GETMAIN-SPACE)
 17167*    END-EXEC.
 17168*    MOVE ',"IL                  $   #00014944' TO DFHEIV0
 17169     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17170     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17171     MOVE X'2020233030303134393434' TO DFHEIV0(25:11)
 17172     CALL 'kxdfhei1' USING DFHEIV0,
 17173           DFHEIV20,
 17174           ERPNDB-RECORD-LENGTH,
 17175           GETMAIN-SPACE
 17176     SET ADDRESS OF PENDING-BUSINESS TO
 17177         DFHEIV20
 17178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17179
 17180
 17181***  pending-business now has original record
 17182     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17183
 17184
 17185* EXEC CICS HANDLE CONDITION
 17186*        NOTFND   (2830-BUILD-NEW-ISSUE-RECORD)
 17187*    END-EXEC.
 17188*    MOVE '"$I                   ! ? #00014953' TO DFHEIV0
 17189     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17190     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17191     MOVE X'3F20233030303134393533' TO DFHEIV0(25:11)
 17192     CALL 'kxdfhei1' USING DFHEIV0
 17193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17194
 17195
 17196***  read elcert using original key
 17197
 17198* EXEC CICS READ
 17199*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17200*        DATASET (FILE-ID-ELCERT)
 17201*        RIDFLD  (ELCERT-KEY)
 17202*        UPDATE
 17203*    END-EXEC.
 17204*    MOVE '&"S        EU         (   #00014958' TO DFHEIV0
 17205     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17206     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 314
* EL6311.cbl
 17207     MOVE X'2020233030303134393538' TO DFHEIV0(25:11)
 17208     CALL 'kxdfhei1' USING DFHEIV0,
 17209           FILE-ID-ELCERT,
 17210           DFHEIV20,
 17211           DFHEIV99,
 17212           ELCERT-KEY,
 17213           DFHEIV99,
 17214           DFHEIV99,
 17215           DFHEIV99
 17216     SET ADDRESS OF CERTIFICATE-MASTER TO
 17217         DFHEIV20
 17218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17219
 17220
 17221     MOVE  FILE-ID-ELCERT        TO JP-FILE-ID.
 17222     MOVE 'B'                    TO JP-RECORD-TYPE
 17223     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17224     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17225
 17226     IF INSURED-ADDR-PRESENT
 17227        MOVE 'Y'                 TO WS-CERT-ADDRESS-SW.
 17228
 17229     IF CERT-NOTES-ARE-NOT-PRESENT
 17230        MOVE SPACE               TO WS-CERT-NOTE-SW
 17231     ELSE
 17232        MOVE 'Y'                 TO WS-CERT-NOTE-SW.
 17233
 17234     IF CERT-ADDED-BATCH      OR
 17235        CERT-AND-CLAIM-ONLINE OR
 17236        CERT-WAS-CREATED-FOR-CLAIM
 17237        NEXT SENTENCE
 17238     ELSE
 17239        GO TO 2825-DELETE-CERTIFICATE.
 17240
 17241     PERFORM 8400-LOG-JOURNAL-RECORD.
 17242
 17243*********************************************************
 17244** DO NOT SET CERT-ADDED-BATCH AS CLAIM-CREATED CERT **
 17245     IF CERT-ADDED-BATCH
 17246         GO TO 2822-REWRITE-ELCERT.
 17247*********************************************************
 17248
 17249     IF NO-CLAIM-ATTACHED
 17250        NEXT SENTENCE
 17251     ELSE
 17252        MOVE SPACE               TO CM-CREDIT-INTERFACE-SW-1
 17253        MOVE '2'                 TO CM-CLAIM-INTERFACE-SW.
 17254
 17255 2822-REWRITE-ELCERT.
 17256     MOVE 'C'                    TO JP-RECORD-TYPE
 17257     MOVE CERTIFICATE-MASTER     TO JP-RECORD-AREA.
 17258
 17259     MOVE ELCERT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17260
 17261
 17262* EXEC CICS REWRITE
 17263*         DATASET    (FILE-ID-ELCERT)
 17264*         FROM       (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 315
* EL6311.cbl
 17265*    END-EXEC.
 17266     MOVE LENGTH OF
 17267      CERTIFICATE-MASTER
 17268       TO DFHEIV11
 17269*    MOVE '&& L                  %   #00015005' TO DFHEIV0
 17270     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17271     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17272     MOVE X'2020233030303135303035' TO DFHEIV0(25:11)
 17273     CALL 'kxdfhei1' USING DFHEIV0,
 17274           FILE-ID-ELCERT,
 17275           CERTIFICATE-MASTER,
 17276           DFHEIV11,
 17277           DFHEIV99
 17278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17279
 17280
 17281     PERFORM 8400-LOG-JOURNAL-RECORD.
 17282
 17283     GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17284
 17285 2825-DELETE-CERTIFICATE.
 17286     MOVE 'D'                      TO JP-RECORD-TYPE.
 17287     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17288
 17289     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17290
 17291
 17292* EXEC CICS DELETE
 17293*         DATASET    (FILE-ID-ELCERT)
 17294*    END-EXEC.
 17295*    MOVE '&(                    &   #00015020' TO DFHEIV0
 17296     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17297     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17298     MOVE X'2020233030303135303230' TO DFHEIV0(25:11)
 17299     CALL 'kxdfhei1' USING DFHEIV0,
 17300           FILE-ID-ELCERT,
 17301           DFHEIV99,
 17302           DFHEIV99,
 17303           DFHEIV99,
 17304           DFHEIV99
 17305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17306
 17307
 17308     PERFORM 8400-LOG-JOURNAL-RECORD.
 17309
 17310******************************************************************
 17311*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
 17312******************************************************************
 17313
 17314     IF CERT-NOTES-ARE-PRESENT
 17315        NEXT SENTENCE
 17316     ELSE
 17317        GO TO 2827-DELETE-MAILING.
 17318
 17319
 17320* EXEC CICS HANDLE CONDITION
 17321*         NOTFND  (2827-DELETE-MAILING)
 17322*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 316
* EL6311.cbl
 17323*    MOVE '"$I                   ! @ #00015035' TO DFHEIV0
 17324     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17325     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17326     MOVE X'4020233030303135303335' TO DFHEIV0(25:11)
 17327     CALL 'kxdfhei1' USING DFHEIV0
 17328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17329
 17330
 17331
 17332* EXEC CICS READ
 17333*        EQUAL
 17334*        DATASET   (FILE-ID-ERNOTE)
 17335*        SET       (ADDRESS OF CERTIFICATE-NOTE)
 17336*        RIDFLD    (ELCERT-KEY)
 17337*        UPDATE
 17338*    END-EXEC.
 17339*    MOVE '&"S        EU         (   #00015039' TO DFHEIV0
 17340     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17341     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17342     MOVE X'2020233030303135303339' TO DFHEIV0(25:11)
 17343     CALL 'kxdfhei1' USING DFHEIV0,
 17344           FILE-ID-ERNOTE,
 17345           DFHEIV20,
 17346           DFHEIV99,
 17347           ELCERT-KEY,
 17348           DFHEIV99,
 17349           DFHEIV99,
 17350           DFHEIV99
 17351     SET ADDRESS OF CERTIFICATE-NOTE TO
 17352         DFHEIV20
 17353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17354
 17355
 17356     MOVE  FILE-ID-ERNOTE        TO  JP-FILE-ID.
 17357     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17358     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
 17359
 17360     MOVE ERNOTE-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17361
 17362
 17363* EXEC CICS DELETE
 17364*        DATASET   (FILE-ID-ERNOTE)
 17365*    END-EXEC.
 17366*    MOVE '&(                    &   #00015053' TO DFHEIV0
 17367     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17368     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17369     MOVE X'2020233030303135303533' TO DFHEIV0(25:11)
 17370     CALL 'kxdfhei1' USING DFHEIV0,
 17371           FILE-ID-ERNOTE,
 17372           DFHEIV99,
 17373           DFHEIV99,
 17374           DFHEIV99,
 17375           DFHEIV99
 17376     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17377
 17378
 17379     PERFORM 8400-LOG-JOURNAL-RECORD.
 17380
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 317
* EL6311.cbl
 17381******************************************************************
 17382*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
 17383******************************************************************
 17384
 17385 2827-DELETE-MAILING.
 17386     IF CERT-ADDRESS-PRESENT
 17387        NEXT SENTENCE
 17388     ELSE
 17389        GO TO 2830-BUILD-NEW-ISSUE-RECORD.
 17390
 17391
 17392* EXEC CICS HANDLE CONDITION
 17393*         NOTFND  (2830-BUILD-NEW-ISSUE-RECORD)
 17394*    END-EXEC.
 17395*    MOVE '"$I                   ! A #00015069' TO DFHEIV0
 17396     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17397     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17398     MOVE X'4120233030303135303639' TO DFHEIV0(25:11)
 17399     CALL 'kxdfhei1' USING DFHEIV0
 17400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17401
 17402
 17403     MOVE ELCERT-KEY             TO ERMAIL-KEY.
 17404
 17405
 17406* EXEC CICS READ
 17407*        EQUAL
 17408*        DATASET   (FILE-ID-ERMAIL)
 17409*        SET       (ADDRESS OF MAILING-DATA)
 17410*        RIDFLD    (ERMAIL-KEY)
 17411*        UPDATE
 17412*    END-EXEC.
 17413*    MOVE '&"S        EU         (   #00015075' TO DFHEIV0
 17414     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17415     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17416     MOVE X'2020233030303135303735' TO DFHEIV0(25:11)
 17417     CALL 'kxdfhei1' USING DFHEIV0,
 17418           FILE-ID-ERMAIL,
 17419           DFHEIV20,
 17420           DFHEIV99,
 17421           ERMAIL-KEY,
 17422           DFHEIV99,
 17423           DFHEIV99,
 17424           DFHEIV99
 17425     SET ADDRESS OF MAILING-DATA TO
 17426         DFHEIV20
 17427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17428
 17429
 17430     MOVE FILE-ID-ERMAIL         TO  JP-FILE-ID.
 17431     MOVE 'D'                    TO  JP-RECORD-TYPE.
 17432     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
 17433
 17434     MOVE ERMAIL-JOURNAL-LENGTH  TO  WS-JOURNAL-RECORD-LENGTH.
 17435
 17436
 17437* EXEC CICS DELETE
 17438*        DATASET   (FILE-ID-ERMAIL)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 318
* EL6311.cbl
 17439*    END-EXEC.
 17440*    MOVE '&(                    &   #00015089' TO DFHEIV0
 17441     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17442     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17443     MOVE X'2020233030303135303839' TO DFHEIV0(25:11)
 17444     CALL 'kxdfhei1' USING DFHEIV0,
 17445           FILE-ID-ERMAIL,
 17446           DFHEIV99,
 17447           DFHEIV99,
 17448           DFHEIV99,
 17449           DFHEIV99
 17450     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17451
 17452
 17453     PERFORM 8400-LOG-JOURNAL-RECORD.
 17454
 17455 2830-BUILD-NEW-ISSUE-RECORD.
 17456     MOVE SPACES                 TO ELCERT-KEY.
 17457
 17458     IF  BCERTNOL GREATER THAN ZEROS
 17459         MOVE BCERTNOI           TO  PB-CERT-PRIME.
 17460
 17461     IF  BSUFIXL  GREATER THAN ZEROS
 17462         MOVE BSUFIXI            TO  PB-CERT-SFX.
 17463
 17464     IF BEFFDTL GREATER THAN ZEROS
 17465        MOVE  WS-CONVERTED-EFFDT TO  PB-CERT-EFF-DT.
 17466
 17467 2870-WRITE-PENDING-BUSINESS.
 17468     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17469     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17470     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17471     MOVE '5'                    TO DC-OPTION-CODE.
 17472     PERFORM 9700-DATE-LINK.
 17473     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17474
 17475     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17476
 17477     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17478     MOVE 'A'                    TO JP-RECORD-TYPE.
 17479     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17480
 17481
 17482* EXEC CICS WRITE
 17483*        DATASET  (FILE-ID-ERPNDB)
 17484*        FROM     (PENDING-BUSINESS)
 17485*        RIDFLD   (PB-CONTROL-PRIMARY)
 17486*    END-EXEC.
 17487     MOVE LENGTH OF
 17488      PENDING-BUSINESS
 17489       TO DFHEIV11
 17490*    MOVE '&$ L                  ''   #00015121' TO DFHEIV0
 17491     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17492     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17493     MOVE X'2020233030303135313231' TO DFHEIV0(25:11)
 17494     CALL 'kxdfhei1' USING DFHEIV0,
 17495           FILE-ID-ERPNDB,
 17496           PENDING-BUSINESS,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 319
* EL6311.cbl
 17497           DFHEIV11,
 17498           PB-CONTROL-PRIMARY,
 17499           DFHEIV99,
 17500           DFHEIV99
 17501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17502
 17503
 17504     MOVE ERPNDB-JOURNAL-LENGTH TO WS-JOURNAL-RECORD-LENGTH.
 17505
 17506     PERFORM 8400-LOG-JOURNAL-RECORD.
 17507
 17508     GO TO 1325-PROCESS-ISSUE-CHANGES.
 17509
 17510 2885-RECORD-MISSING.
 17511     MOVE -1                     TO BMAINTL
 17512     MOVE AL-UABON               TO BMAINTA
 17513     MOVE ER-2902                TO EMI-ERROR.
 17514     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17515     GO TO 8200-SEND-DATAONLY.
 17516
 17517 2890-DUPLICATE-RECORD.
 17518     MOVE -1                     TO BMAINTL.
 17519     MOVE AL-UABON               TO BCERTNOA.
 17520     MOVE AL-UNBON               TO BEFFDTA.
 17521     MOVE SPACE                  TO BMAINTI.
 17522
 17523     MOVE 1                      TO EMI-SUB
 17524                                    EMI-SWITCH1
 17525                                    EMI-SWITCH-AREA-1
 17526                                    EMI-SWITCH-AREA-2.
 17527
 17528     MOVE SPACES                 TO EMI-ERROR-LINES.
 17529
 17530
 17531* EXEC CICS SYNCPOINT ROLLBACK
 17532*    END-EXEC.
 17533*    MOVE '6"R                   !   #00015153' TO DFHEIV0
 17534     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17535     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17536     MOVE X'2020233030303135313533' TO DFHEIV0(25:11)
 17537     CALL 'kxdfhei1' USING DFHEIV0
 17538     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17539
 17540
 17541     MOVE ER-2247                TO EMI-ERROR.
 17542     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT.
 17543     GO TO 8200-SEND-DATAONLY.
 17544
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 320
* EL6311.cbl
 17546
 17547******************************************************************
 17548*                                                                *
 17549*         R E W R I T E   C A N C E L   C E R T.   K E Y         *
 17550*                                                                *
 17551******************************************************************
 17552
 17553 2900-REWRITE-CAN-CERT-KEY.
 17554     MOVE  PI-PREV-ALT-KEY       TO  ERPNDB-ALT-KEY.
 17555
 17556     IF  CCERTNOL GREATER THAN ZEROS
 17557         MOVE  CCERTNOI          TO  ERPNDB-CERT-PRIME.
 17558
 17559     IF  CSUFIXL  GREATER THAN ZEROS
 17560         MOVE  CSUFIXI           TO  ERPNDB-CERT-SFX.
 17561
 17562     IF  CEFFDTL  GREATER THAN ZEROS
 17563         MOVE WS-CONVERTED-EFFDT TO  ERPNDB-CERT-EFF-DT.
 17564
 17565 2910-READ-BY-ACCOUNT.
 17566
 17567* EXEC CICS HANDLE CONDITION
 17568*         NOTFND    (2920-PROCESS-REWRITE)
 17569*    END-EXEC.
 17570*    MOVE '"$I                   ! B #00015181' TO DFHEIV0
 17571     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17572     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17573     MOVE X'4220233030303135313831' TO DFHEIV0(25:11)
 17574     CALL 'kxdfhei1' USING DFHEIV0
 17575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17576
 17577
 17578
 17579* EXEC CICS READ
 17580*        SET     (ADDRESS OF PENDING-BUSINESS)
 17581*        DATASET (FILE-ID-ERPNDB2)
 17582*        RIDFLD  (ERPNDB-ALT-KEY)
 17583*    END-EXEC.
 17584*    MOVE '&"S        E          (   #00015185' TO DFHEIV0
 17585     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17586     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17587     MOVE X'2020233030303135313835' TO DFHEIV0(25:11)
 17588     CALL 'kxdfhei1' USING DFHEIV0,
 17589           FILE-ID-ERPNDB2,
 17590           DFHEIV20,
 17591           DFHEIV99,
 17592           ERPNDB-ALT-KEY,
 17593           DFHEIV99,
 17594           DFHEIV99,
 17595           DFHEIV99
 17596     SET ADDRESS OF PENDING-BUSINESS TO
 17597         DFHEIV20
 17598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17599
 17600
 17601     GO TO 2990-DUPLICATE-RECORD.
 17602
 17603  2920-PROCESS-REWRITE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 321
* EL6311.cbl
 17604
 17605* EXEC CICS HANDLE CONDITION
 17606*         NOTFND    (2985-RECORD-MISSING)
 17607*    END-EXEC.
 17608*    MOVE '"$I                   ! C #00015194' TO DFHEIV0
 17609     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17610     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17611     MOVE X'4320233030303135313934' TO DFHEIV0(25:11)
 17612     CALL 'kxdfhei1' USING DFHEIV0
 17613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17614
 17615
 17616     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY.
 17617
 17618
 17619* EXEC CICS READ
 17620*        SET     (ADDRESS OF PENDING-BUSINESS)
 17621*        DATASET (FILE-ID-ERPNDB)
 17622*        RIDFLD  (ERPNDB-KEY)
 17623*        UPDATE
 17624*    END-EXEC.
 17625*    MOVE '&"S        EU         (   #00015200' TO DFHEIV0
 17626     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17627     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17628     MOVE X'2020233030303135323030' TO DFHEIV0(25:11)
 17629     CALL 'kxdfhei1' USING DFHEIV0,
 17630           FILE-ID-ERPNDB,
 17631           DFHEIV20,
 17632           DFHEIV99,
 17633           ERPNDB-KEY,
 17634           DFHEIV99,
 17635           DFHEIV99,
 17636           DFHEIV99
 17637     SET ADDRESS OF PENDING-BUSINESS TO
 17638         DFHEIV20
 17639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17640
 17641
 17642     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 17643     MOVE 'D'                    TO JP-RECORD-TYPE.
 17644     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17645     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 17646
 17647     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 17648
 17649     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 17650     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 17651     MOVE PB-SV-STATE            TO ELCERT-STATE.
 17652
 17653
 17654* EXEC CICS DELETE
 17655*        DATASET    (FILE-ID-ERPNDB)
 17656*    END-EXEC.
 17657*    MOVE '&(                    &   #00015218' TO DFHEIV0
 17658     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 17659     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 17660     MOVE X'2020233030303135323138' TO DFHEIV0(25:11)
 17661     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 322
* EL6311.cbl
 17662           FILE-ID-ERPNDB,
 17663           DFHEIV99,
 17664           DFHEIV99,
 17665           DFHEIV99,
 17666           DFHEIV99
 17667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17668
 17669
 17670     PERFORM 8400-LOG-JOURNAL-RECORD.
 17671
 17672
 17673* EXEC CICS GETMAIN
 17674*        SET      (ADDRESS OF PENDING-BUSINESS)
 17675*        LENGTH   (ERPNDB-RECORD-LENGTH)
 17676*        INITIMG  (GETMAIN-SPACE)
 17677*    END-EXEC.
 17678*    MOVE ',"IL                  $   #00015224' TO DFHEIV0
 17679     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 17680     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 17681     MOVE X'2020233030303135323234' TO DFHEIV0(25:11)
 17682     CALL 'kxdfhei1' USING DFHEIV0,
 17683           DFHEIV20,
 17684           ERPNDB-RECORD-LENGTH,
 17685           GETMAIN-SPACE
 17686     SET ADDRESS OF PENDING-BUSINESS TO
 17687         DFHEIV20
 17688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17689
 17690
 17691     MOVE JP-RECORD-AREA         TO PENDING-BUSINESS.
 17692
 17693 2950-PROCESS-CANCELS.
 17694
 17695
 17696* EXEC CICS HANDLE CONDITION
 17697*         NOTFND  (2960-BUILD-NEW-CANCEL-RECORD)
 17698*    END-EXEC.
 17699*    MOVE '"$I                   ! D #00015234' TO DFHEIV0
 17700     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 17701     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17702     MOVE X'4420233030303135323334' TO DFHEIV0(25:11)
 17703     CALL 'kxdfhei1' USING DFHEIV0
 17704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17705
 17706
 17707
 17708* EXEC CICS READ
 17709*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 17710*        DATASET (FILE-ID-ELCERT)
 17711*        RIDFLD  (ELCERT-KEY)
 17712*        UPDATE
 17713*    END-EXEC.
 17714*    MOVE '&"S        EU         (   #00015238' TO DFHEIV0
 17715     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 17716     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 17717     MOVE X'2020233030303135323338' TO DFHEIV0(25:11)
 17718     CALL 'kxdfhei1' USING DFHEIV0,
 17719           FILE-ID-ELCERT,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 323
* EL6311.cbl
 17720           DFHEIV20,
 17721           DFHEIV99,
 17722           ELCERT-KEY,
 17723           DFHEIV99,
 17724           DFHEIV99,
 17725           DFHEIV99
 17726     SET ADDRESS OF CERTIFICATE-MASTER TO
 17727         DFHEIV20
 17728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17729
 17730
 17731     MOVE ELCERT-JOURNAL-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17732
 17733     MOVE  FILE-ID-ELCERT          TO JP-FILE-ID.
 17734     MOVE 'B'                      TO JP-RECORD-TYPE.
 17735     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17736     PERFORM 8400-LOG-JOURNAL-RECORD.
 17737
 17738     IF PB-CI-LIVES NOT NUMERIC
 17739         MOVE ZERO                    TO PB-CI-LIVES.
 17740
 17741     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17742        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17743        MOVE ZERO                     TO CM-LF-ITD-CANCEL-AMT
 17744        MOVE LOW-VALUES               TO CM-LF-CANCEL-EXIT-DT
 17745                                         CM-LF-CANCEL-DT
 17746     ELSE
 17747        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17748        MOVE PB-CI-LF-CANCEL-AMT      TO CM-LF-ITD-CANCEL-AMT
 17749        MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
 17750        MOVE PB-CI-LIVES              TO CM-LIVES.
 17751
 17752     IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
 17753        IF CM-LF-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17754            MOVE CM-LF-STATUS-AT-CANCEL
 17755                                     TO CM-LF-CURRENT-STATUS
 17756            MOVE SPACE
 17757                                     TO CM-LF-STATUS-AT-CANCEL
 17758        ELSE
 17759            MOVE PB-CI-LF-POLICY-STATUS
 17760                                     TO CM-LF-CURRENT-STATUS
 17761     ELSE
 17762        MOVE PB-CI-LF-POLICY-STATUS  TO CM-LF-CURRENT-STATUS.
 17763
 17764     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17765        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17766        MOVE ZERO                     TO CM-AH-ITD-CANCEL-AMT
 17767        MOVE LOW-VALUES               TO CM-AH-CANCEL-EXIT-DT
 17768                                         CM-AH-CANCEL-DT
 17769     ELSE
 17770        MOVE SPACE                    TO CM-CREDIT-INTERFACE-SW-2
 17771        MOVE PB-CI-AH-CANCEL-AMT      TO CM-AH-ITD-CANCEL-AMT
 17772        MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
 17773        MOVE PB-CI-LIVES              TO CM-LIVES.
 17774
 17775     IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
 17776        IF CM-AH-STATUS-AT-CANCEL NOT EQUAL TO SPACE
 17777            MOVE CM-AH-STATUS-AT-CANCEL
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 324
* EL6311.cbl
 17778                                     TO CM-AH-CURRENT-STATUS
 17779            MOVE SPACE
 17780                                     TO CM-AH-STATUS-AT-CANCEL
 17781        ELSE
 17782            MOVE PB-CI-AH-POLICY-STATUS
 17783                                     TO CM-AH-CURRENT-STATUS
 17784     ELSE
 17785        MOVE PB-CI-AH-POLICY-STATUS  TO CM-AH-CURRENT-STATUS.
 17786
 17787 2975-REWRITE-CERT.
 17788     MOVE 'C'                      TO JP-RECORD-TYPE.
 17789     MOVE CERTIFICATE-MASTER       TO JP-RECORD-AREA.
 17790
 17791
 17792* EXEC CICS REWRITE
 17793*        DATASET    (FILE-ID-ELCERT)
 17794*        FROM       (CERTIFICATE-MASTER)
 17795*    END-EXEC.
 17796     MOVE LENGTH OF
 17797      CERTIFICATE-MASTER
 17798       TO DFHEIV11
 17799*    MOVE '&& L                  %   #00015305' TO DFHEIV0
 17800     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 17801     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17802     MOVE X'2020233030303135333035' TO DFHEIV0(25:11)
 17803     CALL 'kxdfhei1' USING DFHEIV0,
 17804           FILE-ID-ELCERT,
 17805           CERTIFICATE-MASTER,
 17806           DFHEIV11,
 17807           DFHEIV99
 17808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17809
 17810
 17811     PERFORM 8400-LOG-JOURNAL-RECORD.
 17812
 17813 2960-BUILD-NEW-CANCEL-RECORD.
 17814     IF  CCERTNOL GREATER THAN ZEROS
 17815         MOVE CCERTNOI            TO PB-CERT-PRIME.
 17816
 17817     IF  CSUFIXL  GREATER THAN ZEROS
 17818         MOVE CSUFIXI             TO PB-CERT-SFX.
 17819
 17820     IF  CEFFDTL  GREATER  THAN ZEROS
 17821         MOVE WS-CONVERTED-EFFDT  TO PB-CERT-EFF-DT.
 17822
 17823 2970-WRITE-PENDING-BUSINESS.
 17824     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
 17825     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 17826     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
 17827     MOVE '5'                    TO DC-OPTION-CODE.
 17828     PERFORM 9700-DATE-LINK.
 17829     MOVE DC-BIN-DATE-1          TO PB-LAST-MAINT-DT.
 17830
 17831     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 17832
 17833     MOVE SPACES                 TO PB-CI-INSURED-NAME
 17834                                    PB-CI-INSURED-SEX
 17835                                    PB-CI-LF-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 325
* EL6311.cbl
 17836                                    PB-CI-AH-BENEFIT-CD
 17837                                    PB-CI-RATE-CLASS
 17838                                    PB-CI-RATE-DEV-LF
 17839                                    PB-CI-RATE-DEV-AH
 17840                                    PB-CI-LF-ABBR
 17841                                    PB-CI-AH-ABBR
 17842                                    PB-CI-OB-FLAG
 17843                                    PB-CI-LF-POLICY-STATUS
 17844                                    PB-CI-AH-POLICY-STATUS
 17845                                    PB-CI-INDV-GRP-CD
 17846                                    PB-CI-BENEFICIARY-NAME
 17847                                    PB-CI-NOTE-SW
 17848                                    PB-CI-SOC-SEC-NO
 17849                                    PB-CI-MEMBER-NO
 17850                                    PB-CI-INT-CODE
 17851                                    PB-CI-COMP-EXCP-SW
 17852                                    PB-CI-ENTRY-STATUS
 17853                                    PB-CI-CREDIT-INTERFACE-SW-1
 17854                                    PB-CI-CREDIT-INTERFACE-SW-2
 17855                                    PB-CI-ENTRY-BATCH.
 17856
 17857     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 17858                                    PB-CI-AH-SETTLEMENT-DT
 17859                                    PB-CI-DEATH-DT
 17860                                    PB-CI-LF-PRIOR-CANCEL-DT
 17861                                    PB-CI-AH-PRIOR-CANCEL-DT
 17862                                    PB-CI-LOAN-1ST-PMT-DT
 17863                                    PB-CI-ENTRY-DT
 17864                                    PB-CI-LF-EXPIRE-DT
 17865                                    PB-CI-AH-EXPIRE-DT.
 17866
 17867     MOVE ZEROS                  TO PB-CI-INSURED-AGE
 17868                                    PB-CI-LF-TERM
 17869                                    PB-CI-LF-BENEFIT-AMT
 17870                                    PB-CI-LF-ALT-BENEFIT-AMT
 17871                                    PB-CI-LF-PREMIUM-AMT
 17872                                    PB-CI-LF-ALT-PREMIUM-AMT
 17873                                    PB-CI-AH-TERM
 17874                                    PB-CI-AH-BENEFIT-AMT
 17875                                    PB-CI-AH-PREMIUM-AMT
 17876                                    PB-CI-RATE-DEV-PCT-LF
 17877                                    PB-CI-RATE-DEV-PCT-AH
 17878                                    PB-CI-LIFE-COMMISSION
 17879                                    PB-CI-AH-COMMISSION
 17880                                    PB-CI-PAY-FREQUENCY
 17881                                    PB-CI-LOAN-APR
 17882                                    PB-CI-LOAN-TERM
 17883                                    PB-CI-CURR-SEQ
 17884                                    PB-CI-AH-CANCEL-AMT
 17885                                    PB-CI-LF-CANCEL-AMT
 17886                                    PB-CI-EXTENTION-DAYS
 17887                                    PB-CI-TERM-IN-DAYS
 17888                                    PB-CI-LOAN-OFFICER
 17889                                    PB-CI-LIVES
 17890                                    PB-CI-LF-CRIT-PER
 17891                                    PB-CI-AH-CRIT-PER
 17892                                    PB-C-LF-REM-TERM
 17893                                    PB-C-AH-REM-TERM.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 326
* EL6311.cbl
 17894
 17895     MOVE  FILE-ID-ERPNDB        TO JP-FILE-ID.
 17896     MOVE 'A'                    TO JP-RECORD-TYPE.
 17897     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 17898
 17899
 17900* EXEC CICS HANDLE CONDITION
 17901*        DUPREC   (2990-DUPLICATE-RECORD)
 17902*    END-EXEC.
 17903*    MOVE '"$%                   ! E #00015398' TO DFHEIV0
 17904     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 17905     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17906     MOVE X'4520233030303135333938' TO DFHEIV0(25:11)
 17907     CALL 'kxdfhei1' USING DFHEIV0
 17908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17909
 17910
 17911
 17912* EXEC CICS WRITE
 17913*        DATASET  (FILE-ID-ERPNDB)
 17914*        FROM     (PENDING-BUSINESS)
 17915*        RIDFLD   (PB-CONTROL-PRIMARY)
 17916*    END-EXEC.
 17917     MOVE LENGTH OF
 17918      PENDING-BUSINESS
 17919       TO DFHEIV11
 17920*    MOVE '&$ L                  ''   #00015402' TO DFHEIV0
 17921     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 17922     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17923     MOVE X'2020233030303135343032' TO DFHEIV0(25:11)
 17924     CALL 'kxdfhei1' USING DFHEIV0,
 17925           FILE-ID-ERPNDB,
 17926           PENDING-BUSINESS,
 17927           DFHEIV11,
 17928           PB-CONTROL-PRIMARY,
 17929           DFHEIV99,
 17930           DFHEIV99
 17931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17932
 17933
 17934     MOVE ERPNDB-RECORD-LENGTH    TO WS-JOURNAL-RECORD-LENGTH.
 17935
 17936     PERFORM 8400-LOG-JOURNAL-RECORD.
 17937
 17938     GO TO 2325-PROCESS-CANCEL-CHANGES.
 17939
 17940 2985-RECORD-MISSING.
 17941     MOVE -1                     TO CMAINTL
 17942     MOVE AL-UABON               TO CMAINTA.
 17943
 17944     MOVE ER-2902                TO EMI-ERROR.
 17945     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17946     GO TO 8200-SEND-DATAONLY.
 17947
 17948 2990-DUPLICATE-RECORD.
 17949     MOVE SPACE                  TO CMAINTI.
 17950     MOVE -1                     TO CMAINTL.
 17951     MOVE AL-UABON               TO CCERTNOA.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 327
* EL6311.cbl
 17952     MOVE AL-UNBON               TO CEFFDTA.
 17953
 17954     MOVE 1                      TO EMI-SUB
 17955                                    EMI-SWITCH1
 17956                                    EMI-SWITCH-AREA-1
 17957                                    EMI-SWITCH-AREA-2.
 17958     MOVE SPACES                 TO EMI-ERROR-LINES.
 17959
 17960
 17961* EXEC CICS SYNCPOINT ROLLBACK
 17962*    END-EXEC.
 17963*    MOVE '6"R                   !   #00015434' TO DFHEIV0
 17964     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 17965     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17966     MOVE X'2020233030303135343334' TO DFHEIV0(25:11)
 17967     CALL 'kxdfhei1' USING DFHEIV0
 17968     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17969
 17970
 17971     MOVE ER-2247                TO EMI-ERROR.
 17972     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17973     GO TO 8200-SEND-DATAONLY.
 17974
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 328
* EL6311.cbl
 17976
 17977***************************************************************
 17978*     ROUTINE TO CALCULATE THE TOTAL OF ALL GOOD AND BAD      *
 17979*     PREMIUM FOR A SINGLE BATCH.                             *
 17980*         ACTIVATED VIA THE PF3 FROM THE BATCH TOTAL SCREEN.  *
 17981***************************************************************
 17982
 17983 3000-BATCH-MAINLINE.
 17984     IF PI-PREV-KEY NOT = SPACES
 17985         MOVE PI-PREV-KEY        TO ERPNDB-KEY
 17986     ELSE
 17987         MOVE PI-ERPNDB-KEY      TO ERPNDB-KEY.
 17988
 17989     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 17990
 17991 3010-READNEXT.
 17992
 17993* EXEC CICS READ
 17994*         DATASET    (FILE-ID-ERPNDB)
 17995*         SET        (ADDRESS OF PENDING-BUSINESS)
 17996*         RIDFLD     (ERPNDB-KEY)
 17997*         GTEQ
 17998*    END-EXEC.
 17999*    MOVE '&"S        G          (   #00015458' TO DFHEIV0
 18000     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 18001     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18002     MOVE X'2020233030303135343538' TO DFHEIV0(25:11)
 18003     CALL 'kxdfhei1' USING DFHEIV0,
 18004           FILE-ID-ERPNDB,
 18005           DFHEIV20,
 18006           DFHEIV99,
 18007           ERPNDB-KEY,
 18008           DFHEIV99,
 18009           DFHEIV99,
 18010           DFHEIV99
 18011     SET ADDRESS OF PENDING-BUSINESS TO
 18012         DFHEIV20
 18013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18014
 18015
 18016     IF PB-COMPANY-CD  NOT = ERPNDB-COMPANY-CD OR
 18017        PB-ENTRY-BATCH NOT = ERPNDB-ENTRY-BATCH
 18018          GO TO 3030-END-BATCH.
 18019
 18020     MOVE PB-CONTROL-PRIMARY     TO ERPNDB-KEY.
 18021
 18022     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS OR
 18023        PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 18024          GO TO 3020-BUMP-SEQ.
 18025
 18026     IF PB-ISSUE
 18027        ADD +1                   TO WS-ISS-TOTAL-CNT
 18028        IF PB-FATAL-ERRORS
 18029           ADD +1                      TO WS-ISS-FATAL-CNT
 18030           PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18031           GO TO 3020-BUMP-SEQ
 18032        ELSE
 18033           IF PB-UNFORCED-ERRORS
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 329
* EL6311.cbl
 18034              ADD +1                      TO WS-ISS-FORCE-CNT
 18035              PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18036              GO TO 3020-BUMP-SEQ
 18037           ELSE
 18038              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18039                 ADD +1                      TO WS-ISS-HOLD-CNT
 18040                 PERFORM 3100-ADD-BAD-ISSUE-PREM  THRU  3199-EXIT
 18041                 GO TO 3020-BUMP-SEQ
 18042              ELSE
 18043                 PERFORM 3200-ADD-GOOD-ISSUE-PREM
 18044                     THRU  3299-EXIT
 18045                 GO TO 3020-BUMP-SEQ.
 18046
 18047     IF PB-CANCELLATION
 18048        ADD +1                   TO WS-CAN-TOTAL-CNT
 18049        IF PB-FATAL-ERRORS
 18050           ADD +1                 TO WS-CAN-FATAL-CNT
 18051           PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18052           GO TO 3020-BUMP-SEQ
 18053        ELSE
 18054           IF PB-UNFORCED-ERRORS
 18055              ADD +1                 TO WS-CAN-FORCE-CNT
 18056              PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18057              GO TO 3020-BUMP-SEQ
 18058           ELSE
 18059              IF PB-RECORD-ON-HOLD OR PB-RECORD-RETURNED
 18060                 ADD +1                 TO WS-CAN-HOLD-CNT
 18061                 PERFORM 3300-ADD-BAD-CANCEL-PREM  THRU  3399-EXIT
 18062                 GO TO 3020-BUMP-SEQ
 18063              ELSE
 18064                 PERFORM 3400-ADD-GOOD-CANCEL-PREM
 18065                     THRU  3499-EXIT
 18066                 GO TO 3020-BUMP-SEQ.
 18067
 18068     IF PB-BATCH-TRAILER
 18069         GO TO 3030-END-BATCH.
 18070
 18071 3020-BUMP-SEQ.
 18072     ADD +1                      TO ERPNDB-BATCH-SEQ-NO.
 18073     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18074     GO TO 3010-READNEXT.
 18075
 18076 3030-END-BATCH.
 18077     MOVE WS-ISS-TOTAL-CNT       TO DITOTALO.
 18078     MOVE WS-ISS-FATAL-CNT       TO DIFATALO.
 18079     MOVE WS-ISS-FORCE-CNT       TO DIFORCEO.
 18080     MOVE WS-ISS-HOLD-CNT        TO DIHOLDO.
 18081
 18082     COMPUTE DIAVAILO = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18083                                          - WS-ISS-FORCE-CNT
 18084                                          - WS-ISS-HOLD-CNT).
 18085
 18086     MOVE WS-ISS-GOOD-PREM       TO DIGPREMO.
 18087     MOVE WS-ISS-BAD-PREM        TO DIBPREMO.
 18088
 18089     MOVE WS-CAN-TOTAL-CNT       TO DCTOTALO.
 18090     MOVE WS-CAN-FATAL-CNT       TO DCFATALO.
 18091     MOVE WS-CAN-FORCE-CNT       TO DCFORCEO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 330
* EL6311.cbl
 18092     MOVE WS-CAN-HOLD-CNT        TO DCHOLDO.
 18093     COMPUTE DCAVAILO = (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18094                                          - WS-CAN-FORCE-CNT
 18095                                          - WS-CAN-HOLD-CNT).
 18096     MOVE WS-CAN-GOOD-PREM       TO DCGPREMO.
 18097     MOVE WS-CAN-BAD-PREM        TO DCBPREMO.
 18098
 18099     COMPUTE WS-NET-TOTAL-CNT
 18100         = WS-ISS-TOTAL-CNT - WS-CAN-TOTAL-CNT.
 18101     MOVE WS-NET-TOTAL-CNT       TO DNTOTALO.
 18102     COMPUTE WS-NET-FATAL-CNT
 18103         = WS-ISS-FATAL-CNT - WS-CAN-FATAL-CNT.
 18104     MOVE WS-NET-FATAL-CNT       TO DNFATALO.
 18105     COMPUTE WS-NET-FORCE-CNT
 18106         = WS-ISS-FORCE-CNT - WS-CAN-FORCE-CNT.
 18107     MOVE WS-NET-FORCE-CNT       TO DNFORCEO.
 18108     COMPUTE WS-NET-HOLD-CNT
 18109         = WS-ISS-HOLD-CNT - WS-CAN-HOLD-CNT.
 18110     MOVE WS-NET-HOLD-CNT        TO DNHOLDO.
 18111
 18112     COMPUTE WS-NET-AVAIL-CNT
 18113          = (WS-ISS-TOTAL-CNT - WS-ISS-FATAL-CNT
 18114                              - WS-ISS-FORCE-CNT
 18115                              - WS-ISS-HOLD-CNT)
 18116          - (WS-CAN-TOTAL-CNT - WS-CAN-FATAL-CNT
 18117                              - WS-CAN-FORCE-CNT
 18118                              - WS-CAN-HOLD-CNT).
 18119     MOVE WS-NET-AVAIL-CNT       TO DNAVAILO.
 18120
 18121     COMPUTE WS-NET-GOOD-PREM
 18122         = WS-ISS-GOOD-PREM - WS-CAN-GOOD-PREM.
 18123     MOVE WS-NET-GOOD-PREM       TO DNGPREMO.
 18124     COMPUTE WS-NET-BAD-PREM
 18125         = WS-ISS-BAD-PREM - WS-CAN-BAD-PREM.
 18126     MOVE WS-NET-BAD-PREM        TO DNBPREMO.
 18127
 18128     MOVE 0000                   TO EMI-ERROR.
 18129     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18130     MOVE -1                     TO DPFENTRL.
 18131     GO TO 8200-SEND-DATAONLY.
 18132
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 331
* EL6311.cbl
 18134
 18135******************************************************************
 18136*                                                                *
 18137*           A D D    B A D   I S S U E   P R E M I U M           *
 18138*                                                                *
 18139******************************************************************
 18140
 18141 3100-ADD-BAD-ISSUE-PREM.
 18142     IF PB-OVERRIDE-LIFE
 18143       OR PB-OVERRIDE-BOTH
 18144           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-BAD-PREM
 18145           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-BAD-PREM
 18146       ELSE
 18147           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-BAD-PREM
 18148           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-BAD-PREM.
 18149
 18150     IF PB-OVERRIDE-AH
 18151       OR PB-OVERRIDE-BOTH
 18152           ADD PB-I-AH-PREM-CALC       TO  WS-ISS-BAD-PREM
 18153       ELSE
 18154           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-BAD-PREM.
 18155
 18156 3199-EXIT.
 18157     EXIT.
 18158
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 332
* EL6311.cbl
 18160
 18161******************************************************************
 18162*                                                                *
 18163*       A D D   G O O D   I S S U E   P R E M I U M              *
 18164*                                                                *
 18165******************************************************************
 18166
 18167 3200-ADD-GOOD-ISSUE-PREM.
 18168     IF PB-OVERRIDE-LIFE
 18169       OR PB-OVERRIDE-BOTH
 18170           ADD PB-I-LF-PREM-CALC       TO  WS-ISS-GOOD-PREM
 18171           ADD PB-I-LF-ALT-PREM-CALC   TO  WS-ISS-GOOD-PREM
 18172       ELSE
 18173           ADD PB-I-LF-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18174           ADD PB-I-LF-ALT-PREMIUM-AMT TO  WS-ISS-GOOD-PREM.
 18175
 18176     IF PB-OVERRIDE-AH
 18177       OR PB-OVERRIDE-BOTH
 18178           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM
 18179       ELSE
 18180           ADD PB-I-AH-PREMIUM-AMT     TO  WS-ISS-GOOD-PREM.
 18181
 18182 3299-EXIT.
 18183     EXIT.
 18184
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 333
* EL6311.cbl
 18186
 18187
 18188******************************************************************
 18189*                                                                *
 18190*        A D D   B A D   C A N C E L   P R E M I U M             *
 18191*                                                                *
 18192******************************************************************
 18193
 18194 3300-ADD-BAD-CANCEL-PREM.
 18195     IF PB-OVERRIDE-LIFE
 18196       OR PB-OVERRIDE-BOTH
 18197           ADD PB-C-LF-REF-CALC   TO  WS-CAN-BAD-PREM
 18198       ELSE
 18199           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18200
 18201     IF PB-OVERRIDE-AH
 18202       OR PB-OVERRIDE-BOTH
 18203           ADD PB-C-AH-REF-CALC   TO  WS-CAN-BAD-PREM
 18204       ELSE
 18205           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-BAD-PREM.
 18206
 18207 3399-EXIT.
 18208     EXIT.
 18209
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 334
* EL6311.cbl
 18211
 18212******************************************************************
 18213*                                                                *
 18214*       A D D   G O O D   C A N C E L   P R E M I U M            *
 18215*                                                                *
 18216******************************************************************
 18217
 18218 3400-ADD-GOOD-CANCEL-PREM.
 18219     IF PB-OVERRIDE-LIFE
 18220       OR PB-OVERRIDE-BOTH
 18221           ADD PB-C-LF-REF-CALC   TO  WS-CAN-GOOD-PREM
 18222       ELSE
 18223           ADD PB-C-LF-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18224
 18225     IF PB-OVERRIDE-AH
 18226       OR PB-OVERRIDE-BOTH
 18227           ADD PB-C-AH-REF-CALC   TO  WS-CAN-GOOD-PREM
 18228       ELSE
 18229           ADD PB-C-AH-CANCEL-AMT TO  WS-CAN-GOOD-PREM.
 18230
 18231 3499-EXIT.
 18232     EXIT.
 18233
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 335
* EL6311.cbl
 18235
 18236******************************************************************
 18237*                                                                *
 18238*           E D I T   B A T C H   D A T A                        *
 18239*                                                                *
 18240******************************************************************
 18241
 18242 3500-EDIT-BATCH-DATA.
 18243     IF PI-PREV-KEY NOT = SPACES
 18244        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 18245     ELSE
 18246        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY.
 18247
 18248     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 18249     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 18250
 18251
 18252* EXEC CICS HANDLE CONDITION
 18253*         NOTFND      (3590-NOT-FOUND)
 18254*    END-EXEC.
 18255*    MOVE '"$I                   ! F #00015700' TO DFHEIV0
 18256     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18257     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18258     MOVE X'4620233030303135373030' TO DFHEIV0(25:11)
 18259     CALL 'kxdfhei1' USING DFHEIV0
 18260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18261
 18262
 18263     IF DRISSL   GREATER THAN ZEROS OR
 18264        DRISSL   GREATER THAN ZEROS OR
 18265        DRLFPRML GREATER THAN ZEROS OR
 18266        DRAHPRML GREATER THAN ZEROS OR
 18267        DRCANCL  GREATER THAN ZEROS OR
 18268        DRLFRFDL GREATER THAN ZEROS OR
 18269        DRAHRFDL GREATER THAN ZEROS
 18270              NEXT SENTENCE
 18271          ELSE
 18272              MOVE ER-3224    TO EMI-ERROR
 18273              MOVE -1         TO DPFENTRL
 18274              MOVE AL-UNBON   TO DPFENTRA
 18275              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18276              GO TO 8200-SEND-DATAONLY.
 18277
 18278     IF NOT MODIFY-CAP
 18279         MOVE 'UPDATE'       TO SM-READ
 18280         PERFORM 9995-SECURITY-VIOLATION
 18281         MOVE ER-0070        TO EMI-ERROR
 18282         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 18283         GO TO 8100-SEND-INITIAL-MAP.
 18284
 18285        IF DRISSL GREATER THAN ZEROS
 18286           MOVE AL-UNNON         TO DRISSA
 18287           MOVE DRISSI           TO DEEDIT-FIELD
 18288           PERFORM 8600-DEEDIT
 18289           IF DEEDIT-FIELD-V0  NUMERIC
 18290              MOVE DEEDIT-FIELD-V0 TO WS-DRISS
 18291           ELSE
 18292              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 336
* EL6311.cbl
 18293              MOVE -1         TO DRISSL
 18294              MOVE AL-UNBON   TO DRISSA
 18295              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18296
 18297        IF DRLFPRML GREATER THAN ZEROS
 18298           MOVE AL-UNNON         TO DRLFPRMA
 18299
 18300* EXEC CICS BIF DEEDIT
 18301*              FIELD  (DRLFPRMI)
 18302*              LENGTH (11)
 18303*          END-EXEC
 18304     MOVE 11
 18305       TO DFHEIV11
 18306*    MOVE '@"L                   #   #00015740' TO DFHEIV0
 18307     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18308     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18309     MOVE X'2020233030303135373430' TO DFHEIV0(25:11)
 18310     CALL 'kxdfhei1' USING DFHEIV0,
 18311           DRLFPRMI,
 18312           DFHEIV11
 18313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18314           IF DRLFPRMI NUMERIC
 18315              MOVE DRLFPRMI   TO WS-DRLFPRM
 18316*          MOVE DRLFPRMI         TO DEEDIT-FIELD
 18317*          PERFORM 8600-DEEDIT
 18318*          IF DEEDIT-FIELD-V2  NUMERIC
 18319*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFPRM
 18320           ELSE
 18321              MOVE ER-2223    TO EMI-ERROR
 18322              MOVE -1         TO DRLFPRML
 18323              MOVE AL-UNBON   TO DRLFPRMA
 18324              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18325
 18326        IF DRAHPRML GREATER THAN ZEROS
 18327           MOVE AL-UNNON         TO DRAHPRMA
 18328
 18329* EXEC CICS BIF DEEDIT
 18330*              FIELD  (DRAHPRMI)
 18331*              LENGTH (11)
 18332*          END-EXEC
 18333     MOVE 11
 18334       TO DFHEIV11
 18335*    MOVE '@"L                   #   #00015758' TO DFHEIV0
 18336     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18337     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18338     MOVE X'2020233030303135373538' TO DFHEIV0(25:11)
 18339     CALL 'kxdfhei1' USING DFHEIV0,
 18340           DRAHPRMI,
 18341           DFHEIV11
 18342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18343           IF DRAHPRMI NUMERIC
 18344              MOVE DRAHPRMI   TO WS-DRAHPRM
 18345*          MOVE DRAHPRMI         TO DEEDIT-FIELD
 18346*          PERFORM 8600-DEEDIT
 18347*          IF DEEDIT-FIELD-V2  NUMERIC
 18348*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHPRM
 18349           ELSE
 18350              MOVE ER-2223    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 337
* EL6311.cbl
 18351              MOVE -1         TO DRAHPRML
 18352              MOVE AL-UNBON   TO DRAHPRMA
 18353              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18354
 18355        IF DRCANCL GREATER THAN ZEROS
 18356           MOVE AL-UNNON         TO DRCANCA
 18357           MOVE DRCANCI          TO DEEDIT-FIELD
 18358           PERFORM 8600-DEEDIT
 18359           IF DEEDIT-FIELD-V0  NUMERIC
 18360              MOVE DEEDIT-FIELD-V0 TO WS-DRCANC
 18361           ELSE
 18362              MOVE ER-2223    TO EMI-ERROR
 18363              MOVE -1         TO DRCANCL
 18364              MOVE AL-UNBON   TO DRCANCL
 18365              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18366
 18367        IF DRLFRFDL GREATER THAN ZEROS
 18368           MOVE AL-UNNON         TO DRLFRFDA
 18369
 18370* EXEC CICS BIF DEEDIT
 18371*              FIELD  (DRLFRFDI)
 18372*              LENGTH (11)
 18373*          END-EXEC
 18374     MOVE 11
 18375       TO DFHEIV11
 18376*    MOVE '@"L                   #   #00015788' TO DFHEIV0
 18377     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18378     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18379     MOVE X'2020233030303135373838' TO DFHEIV0(25:11)
 18380     CALL 'kxdfhei1' USING DFHEIV0,
 18381           DRLFRFDI,
 18382           DFHEIV11
 18383     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18384           IF DRLFRFDI NUMERIC
 18385              MOVE DRLFRFDI   TO WS-DRLFRFD
 18386*          MOVE DRLFRFDI         TO DEEDIT-FIELD
 18387*          PERFORM 8600-DEEDIT
 18388*          IF DEEDIT-FIELD-V2  NUMERIC
 18389*             MOVE DEEDIT-FIELD-V2 TO WS-DRLFRFD
 18390           ELSE
 18391              MOVE ER-2223    TO EMI-ERROR
 18392              MOVE -1         TO DRLFRFDL
 18393              MOVE AL-UNBON   TO DRLFRFDA
 18394              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18395
 18396        IF DRAHRFDL GREATER THAN ZEROS
 18397           MOVE AL-UNNON         TO DRAHRFDA
 18398
 18399* EXEC CICS BIF DEEDIT
 18400*              FIELD  (DRAHRFDI)
 18401*              LENGTH (11)
 18402*          END-EXEC
 18403     MOVE 11
 18404       TO DFHEIV11
 18405*    MOVE '@"L                   #   #00015806' TO DFHEIV0
 18406     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 18407     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 18408     MOVE X'2020233030303135383036' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 338
* EL6311.cbl
 18409     CALL 'kxdfhei1' USING DFHEIV0,
 18410           DRAHRFDI,
 18411           DFHEIV11
 18412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 18413           IF DRAHRFDI NUMERIC
 18414              MOVE DRAHRFDI   TO WS-DRAHRFD
 18415*          MOVE DRAHRFDI         TO DEEDIT-FIELD
 18416*          PERFORM 8600-DEEDIT
 18417*          IF DEEDIT-FIELD-V2  NUMERIC
 18418*             MOVE DEEDIT-FIELD-V2 TO WS-DRAHRFD
 18419           ELSE
 18420              MOVE ER-2223    TO EMI-ERROR
 18421              MOVE -1         TO DRAHRFDL
 18422              MOVE AL-UNBON   TO DRAHRFDA
 18423              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18424
 18425     IF EMI-ERROR = ZEROS
 18426        GO 3600-UPDATE-BATCH-HEADER.
 18427
 18428     GO TO 8200-SEND-DATAONLY.
 18429
 18430 3590-NOT-FOUND.
 18431     MOVE ER-2192                TO EMI-ERROR.
 18432     MOVE -1                     TO DPFENTRL.
 18433     MOVE AL-UNBON               TO DPFENTRA.
 18434     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18435     GO TO 8200-SEND-DATAONLY.
 18436
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 339
* EL6311.cbl
 18438
 18439******************************************************************
 18440*                                                                *
 18441*           U P D A T E   B A T C H   H E A D E R                *
 18442*                                                                *
 18443******************************************************************
 18444
 18445 3600-UPDATE-BATCH-HEADER.
 18446
 18447* EXEC CICS HANDLE CONDITION
 18448*         NOTFND      (3690-NOT-FOUND)
 18449*    END-EXEC.
 18450*    MOVE '"$I                   ! G #00015843' TO DFHEIV0
 18451     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18452     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18453     MOVE X'4720233030303135383433' TO DFHEIV0(25:11)
 18454     CALL 'kxdfhei1' USING DFHEIV0
 18455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18456
 18457
 18458
 18459* EXEC CICS READ
 18460*        DATASET (FILE-ID-ERPNDB)
 18461*        RIDFLD  (ERPNDB-KEY)
 18462*        SET     (ADDRESS OF PENDING-BUSINESS)
 18463*        UPDATE
 18464*    END-EXEC.
 18465*    MOVE '&"S        EU         (   #00015847' TO DFHEIV0
 18466     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18467     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 18468     MOVE X'2020233030303135383437' TO DFHEIV0(25:11)
 18469     CALL 'kxdfhei1' USING DFHEIV0,
 18470           FILE-ID-ERPNDB,
 18471           DFHEIV20,
 18472           DFHEIV99,
 18473           ERPNDB-KEY,
 18474           DFHEIV99,
 18475           DFHEIV99,
 18476           DFHEIV99
 18477     SET ADDRESS OF PENDING-BUSINESS TO
 18478         DFHEIV20
 18479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18480
 18481
 18482     MOVE FILE-ID-ERPNDB         TO JP-FILE-ID.
 18483     MOVE 'B'                    TO JP-RECORD-TYPE.
 18484     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18485
 18486     MOVE ERPNDB-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 18487
 18488     PERFORM 8400-LOG-JOURNAL-RECORD.
 18489
 18490     IF DRISSL GREATER THAN ZEROS
 18491        MOVE WS-DRISS            TO PB-B-ISSUE-CNT-REMITTED.
 18492
 18493     IF DRCANCL GREATER THAN ZEROS
 18494        MOVE WS-DRCANC           TO PB-B-CANCEL-CNT-REMITTED.
 18495
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 340
* EL6311.cbl
 18496
 18497     IF DRLFPRML GREATER THAN ZEROS
 18498        MOVE WS-DRLFPRM       TO PB-B-LF-ISS-PRM-REMITTED.
 18499
 18500     IF DRAHPRML GREATER THAN ZEROS
 18501        MOVE WS-DRAHPRM       TO PB-B-AH-ISS-PRM-REMITTED.
 18502
 18503     IF DRLFRFDL GREATER THAN ZEROS
 18504        MOVE WS-DRLFRFD       TO PB-B-LF-CAN-PRM-REMITTED.
 18505
 18506     IF DRAHRFDL GREATER THAN ZEROS
 18507        MOVE WS-DRAHRFD       TO PB-B-AH-CAN-PRM-REMITTED.
 18508
 18509 3670-REWRITE-BATCH-HEADER.
 18510     IF PB-B-ISSUE-CNT-REMITTED  =  PB-B-ISSUE-CNT-ENTERED   AND
 18511        PB-B-LF-ISS-PRM-ENTERED  =  PB-B-LF-ISS-PRM-REMITTED AND
 18512        PB-B-AH-ISS-PRM-ENTERED  =  PB-B-AH-ISS-PRM-REMITTED AND
 18513        PB-B-CANCEL-CNT-REMITTED =  PB-B-CANCEL-CNT-ENTERED  AND
 18514        PB-B-LF-CAN-PRM-ENTERED  =  PB-B-LF-CAN-PRM-REMITTED AND
 18515        PB-B-AH-CAN-PRM-ENTERED  =  PB-B-AH-CAN-PRM-REMITTED
 18516        MOVE SPACE               TO PB-OUT-BAL-CD
 18517     ELSE
 18518        MOVE 'O'                 TO PB-OUT-BAL-CD.
 18519
 18520     MOVE 'C'                    TO JP-RECORD-TYPE.
 18521     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 18522
 18523
 18524* EXEC CICS REWRITE
 18525*         DATASET      (FILE-ID-ERPNDB)
 18526*         FROM         (PENDING-BUSINESS)
 18527*    END-EXEC.
 18528     MOVE LENGTH OF
 18529      PENDING-BUSINESS
 18530       TO DFHEIV11
 18531*    MOVE '&& L                  %   #00015895' TO DFHEIV0
 18532     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 18533     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 18534     MOVE X'2020233030303135383935' TO DFHEIV0(25:11)
 18535     CALL 'kxdfhei1' USING DFHEIV0,
 18536           FILE-ID-ERPNDB,
 18537           PENDING-BUSINESS,
 18538           DFHEIV11,
 18539           DFHEIV99
 18540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18541
 18542
 18543     PERFORM 8400-LOG-JOURNAL-RECORD.
 18544
 18545     GO TO 7200-DISPLAY-BATCHES.
 18546
 18547 3690-NOT-FOUND.
 18548     MOVE ER-2192                TO EMI-ERROR.
 18549     MOVE -1                     TO DPFENTRL.
 18550     MOVE AL-UNBON               TO DPFENTRA.
 18551     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18552     GO TO 8200-SEND-DATAONLY.
 18553
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 341
* EL6311.cbl
 18555
 18556******************************************************************
 18557*                                                                *
 18558*           R E - D I S P L A Y   R E C O R D                    *
 18559*                                                                *
 18560******************************************************************
 18561
 18562 3900-RE-DISPLAY-RECORD.
 18563
 18564* EXEC CICS HANDLE CONDITION
 18565*         NOTFND   (3990-NOT-FOUND)
 18566*    END-EXEC.
 18567*    MOVE '"$I                   ! H #00015920' TO DFHEIV0
 18568     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 18569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18570     MOVE X'4820233030303135393230' TO DFHEIV0(25:11)
 18571     CALL 'kxdfhei1' USING DFHEIV0
 18572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18573
 18574
 18575     IF PI-DISPLAY-ORIGINAL-BATCH
 18576         MOVE FILE-ID-ERPNDB3     TO FILE-ID
 18577     ELSE
 18578         MOVE FILE-ID-ERPNDB      TO FILE-ID.
 18579
 18580
 18581* EXEC CICS READ
 18582*         DATASET   (FILE-ID)
 18583*         RIDFLD    (PI-PREV-KEY)
 18584*         SET       (ADDRESS OF PENDING-BUSINESS)
 18585*    END-EXEC.
 18586*    MOVE '&"S        E          (   #00015929' TO DFHEIV0
 18587     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 18588     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 18589     MOVE X'2020233030303135393239' TO DFHEIV0(25:11)
 18590     CALL 'kxdfhei1' USING DFHEIV0,
 18591           FILE-ID,
 18592           DFHEIV20,
 18593           DFHEIV99,
 18594           PI-PREV-KEY,
 18595           DFHEIV99,
 18596           DFHEIV99,
 18597           DFHEIV99
 18598     SET ADDRESS OF PENDING-BUSINESS TO
 18599         DFHEIV20
 18600     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18601
 18602
 18603     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 18604
 18605     IF PB-ISSUE
 18606         GO TO 7000-DISPLAY-ISSUES.
 18607
 18608     IF PB-CANCELLATION
 18609         GO TO 7100-DISPLAY-CANCELS.
 18610
 18611     IF PB-BATCH-TRAILER
 18612         GO TO 7200-DISPLAY-BATCHES.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 342
* EL6311.cbl
 18613
 18614 3990-NOT-FOUND.
 18615     MOVE LOW-VALUES             TO EL631BI.
 18616
 18617     IF PI-MAP-NAME = EL631B
 18618         MOVE -1                  TO BMAINTL
 18619     ELSE
 18620         MOVE -1                  TO CMAINTL.
 18621
 18622     GO TO 8100-SEND-INITIAL-MAP.
 18623
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 343
* EL6311.cbl
 18625
 18626***************************************************************
 18627*     FORWARD BROWSING ROUTINE   (BY ALTERNATE KEY)           *
 18628*                                                             *
 18629*      1. START BROWSE WITH                                   *
 18630*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 18631*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 18632*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 18633*                                                             *
 18634*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 18635*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 18636*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 18637*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 18638*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 18639*               AND IS IT TO BE DISPLAYED.                    *
 18640*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 18641*               DISPLAYED.                                    *
 18642*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 18643*               DISPLAYED.                                    *
 18644*                                                             *
 18645*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 18646*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 18647***************************************************************
 18648
 18649 4000-BROWSE-DETAIL-FORWARD.
 18650     IF FIRST-TIME
 18651        MOVE PI-ERPNDB-ALT-KEY      TO ERPNDB-ALT-KEY
 18652     ELSE
 18653        IF SHOW-RECORD
 18654           MOVE PI-ERPNDB-ALT-KEY   TO ERPNDB-ALT-KEY
 18655           MOVE WS-NEW-CERT-NO      TO ERPNDB-CERT-NO
 18656           MOVE WS-NEW-CERT-EFF-DT  TO ERPNDB-CERT-EFF-DT
 18657           MOVE LOW-VALUES          TO ERPNDB-RECORD-TYPE
 18658           MOVE ZEROS               TO ERPNDB-ALT-CHG-SEQ-NO
 18659        ELSE
 18660           MOVE PI-PREV-ALT-KEY     TO ERPNDB-ALT-KEY.
 18661
 18662
 18663* EXEC CICS HANDLE CONDITION
 18664*         NOTFND   (4050-END-RECORDS)
 18665*         ENDFILE  (4050-END-RECORDS)
 18666*    END-EXEC.
 18667*    MOVE '"$I''                  ! I #00015994' TO DFHEIV0
 18668     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 18669     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 18670     MOVE X'4920233030303135393934' TO DFHEIV0(25:11)
 18671     CALL 'kxdfhei1' USING DFHEIV0
 18672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18673
 18674
 18675
 18676* EXEC CICS STARTBR
 18677*         DATASET   (FILE-ID-ERPNDB2)
 18678*         RIDFLD    (ERPNDB-ALT-KEY)
 18679*    END-EXEC.
 18680     MOVE 0
 18681       TO DFHEIV11
 18682*    MOVE '&,         G          &   #00015999' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 344
* EL6311.cbl
 18683     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 18684     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 18685     MOVE X'2020233030303135393939' TO DFHEIV0(25:11)
 18686     CALL 'kxdfhei1' USING DFHEIV0,
 18687           FILE-ID-ERPNDB2,
 18688           ERPNDB-ALT-KEY,
 18689           DFHEIV99,
 18690           DFHEIV11,
 18691           DFHEIV99
 18692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18693
 18694
 18695     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 18696
 18697     IF FIRST-TIME OR SHOW-RECORD
 18698        MOVE SPACE               TO WS-FIRST-TIME-SW
 18699        GO TO 4005-READ-NEXT-RECORD.
 18700
 18701
 18702* EXEC CICS READNEXT
 18703*         DATASET    (FILE-ID-ERPNDB2)
 18704*         SET        (ADDRESS OF PENDING-BUSINESS)
 18705*         RIDFLD     (ERPNDB-ALT-KEY)
 18706*    END-EXEC.
 18707     MOVE 0
 18708       TO DFHEIV11
 18709*    MOVE '&.S                   )   #00016010' TO DFHEIV0
 18710     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18711     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18712     MOVE X'2020233030303136303130' TO DFHEIV0(25:11)
 18713     CALL 'kxdfhei1' USING DFHEIV0,
 18714           FILE-ID-ERPNDB2,
 18715           DFHEIV20,
 18716           DFHEIV99,
 18717           ERPNDB-ALT-KEY,
 18718           DFHEIV99,
 18719           DFHEIV11,
 18720           DFHEIV99,
 18721           DFHEIV99
 18722     SET ADDRESS OF PENDING-BUSINESS TO
 18723         DFHEIV20
 18724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18725
 18726
 18727 4005-READ-NEXT-RECORD.
 18728
 18729* EXEC CICS READNEXT
 18730*         DATASET    (FILE-ID-ERPNDB2)
 18731*         SET        (ADDRESS OF PENDING-BUSINESS)
 18732*         RIDFLD     (ERPNDB-ALT-KEY)
 18733*    END-EXEC.
 18734     MOVE 0
 18735       TO DFHEIV11
 18736*    MOVE '&.S                   )   #00016017' TO DFHEIV0
 18737     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 18738     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 18739     MOVE X'2020233030303136303137' TO DFHEIV0(25:11)
 18740     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 345
* EL6311.cbl
 18741           FILE-ID-ERPNDB2,
 18742           DFHEIV20,
 18743           DFHEIV99,
 18744           ERPNDB-ALT-KEY,
 18745           DFHEIV99,
 18746           DFHEIV11,
 18747           DFHEIV99,
 18748           DFHEIV99
 18749     SET ADDRESS OF PENDING-BUSINESS TO
 18750         DFHEIV20
 18751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18752
 18753
 18754     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 18755
 18756     IF WS-BATCH-PREFIX = '#CL'
 18757        GO TO 4005-READ-NEXT-RECORD.
 18758
 18759     IF SHOW-RECORD
 18760        IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD        OR
 18761           PB-CARRIER       NOT = PI-PB-CARRIER        OR
 18762           PB-GROUPING      NOT = PI-PB-GROUPING       OR
 18763           PB-STATE         NOT = PI-PB-STATE          OR
 18764           PB-ACCOUNT       NOT = PI-PB-ACCOUNT        OR
 18765           PB-CERT-EFF-DT   NOT = WS-NEW-CERT-EFF-DT   OR
 18766           PB-CERT-NO       NOT = WS-NEW-CERT-NO
 18767           GO TO 4050-END-RECORDS
 18768        ELSE
 18769           GO TO 4010-CHECK-REC-TYPE.
 18770
 18771     IF PB-COMPANY-CD-A1    NOT = PI-COMPANY-CD        OR
 18772        PB-CARRIER          NOT = PI-PB-CARRIER        OR
 18773        PB-GROUPING         NOT = PI-PB-GROUPING       OR
 18774        PB-STATE            NOT = PI-PB-STATE          OR
 18775        PB-ACCOUNT          NOT = PI-PB-ACCOUNT
 18776        GO TO 4050-END-RECORDS.
 18777
 18778     IF PB-BATCH-TRAILER
 18779        GO TO 4005-READ-NEXT-RECORD.
 18780
 18781     IF PI-PB-CERT-NO NOT = LOW-VALUES
 18782        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 18783           GO TO 4005-READ-NEXT-RECORD
 18784        ELSE
 18785           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 18786              GO TO 4010-CHECK-REC-TYPE
 18787           ELSE
 18788              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 18789                 GO TO 4010-CHECK-REC-TYPE
 18790              ELSE
 18791                 GO TO 4005-READ-NEXT-RECORD.
 18792
 18793     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 18794        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 18795           GO TO 4005-READ-NEXT-RECORD.
 18796
 18797 4010-CHECK-REC-TYPE.
 18798     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 346
* EL6311.cbl
 18799         IF  PB-CARRIER = PI-CARRIER-SECURITY
 18800             NEXT SENTENCE
 18801         ELSE
 18802             GO TO 4005-READ-NEXT-RECORD.
 18803
 18804     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 18805         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 18806             NEXT SENTENCE
 18807        ELSE
 18808             GO TO 4005-READ-NEXT-RECORD.
 18809
 18810     IF NOT DISPLAY-CHANGE-RECORDS AND
 18811            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 18812        GO TO 4005-READ-NEXT-RECORD.
 18813
 18814     IF DISPLAY-HOLD-RECORDS AND
 18815        NOT PB-RECORD-ON-HOLD
 18816          GO TO 4005-READ-NEXT-RECORD.
 18817
 18818     IF PB-ISSUE
 18819        IF DISPLAY-CHK-REQ-RECORDS
 18820            GO TO 4005-READ-NEXT-RECORD.
 18821
 18822     IF PB-ISSUE
 18823        IF ISSUE-WITH-WARNING
 18824           IF PB-WARNING-ERRORS
 18825              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18826                  GO TO 4005-READ-NEXT-RECORD
 18827              ELSE
 18828                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18829                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18830                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18831                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18832                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18833                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18834                 GO TO 7000-DISPLAY-ISSUES
 18835           ELSE
 18836              GO TO 4005-READ-NEXT-RECORD.
 18837
 18838     IF PB-ISSUE
 18839        IF (ISSUES-IN-ERROR AND
 18840            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18841            ALL-ISSUES
 18842            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18843            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18844            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18845            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18846            MOVE PB-SV-STATE            TO PI-SV-STATE
 18847            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18848            GO TO 7000-DISPLAY-ISSUES
 18849        ELSE
 18850            GO TO 4005-READ-NEXT-RECORD.
 18851
 18852     IF PB-CANCELLATION
 18853        IF DISPLAY-CHK-REQ-RECORDS
 18854           IF PB-C-REFUND-REQUESTED
 18855              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18856              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 347
* EL6311.cbl
 18857              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18858              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18859              MOVE PB-SV-STATE            TO PI-SV-STATE
 18860              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18861              GO TO 7100-DISPLAY-CANCELS
 18862           ELSE
 18863               GO TO 4005-READ-NEXT-RECORD.
 18864
 18865     IF PB-CANCELLATION
 18866        IF CANCEL-WITH-WARNING
 18867           IF PB-WARNING-ERRORS
 18868              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 18869                  GO TO 4005-READ-NEXT-RECORD
 18870              ELSE
 18871                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18872                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18873                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18874                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18875                 MOVE PB-SV-STATE            TO PI-SV-STATE
 18876                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18877                 GO TO 7100-DISPLAY-CANCELS
 18878           ELSE
 18879              GO TO 4005-READ-NEXT-RECORD.
 18880
 18881     IF PB-CANCELLATION
 18882        IF (CANCEL-IN-ERROR  AND
 18883            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 18884            ALL-CANCELS
 18885            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 18886            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 18887            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 18888            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 18889            MOVE PB-SV-STATE            TO PI-SV-STATE
 18890            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 18891            GO TO 7100-DISPLAY-CANCELS.
 18892
 18893     GO TO 4005-READ-NEXT-RECORD.
 18894
 18895 4050-END-RECORDS.
 18896******************************************************************
 18897*                                                                *
 18898*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 18899*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 18900*         PROGRAM.                                               *
 18901*                                                                *
 18902******************************************************************
 18903
 18904     IF BROWSE-STARTED
 18905        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 18906
 18907* EXEC CICS ENDBR
 18908*            DATASET  (FILE-ID-ERPNDB2)
 18909*       END-EXEC.
 18910     MOVE 0
 18911       TO DFHEIV11
 18912*    MOVE '&2                    $   #00016175' TO DFHEIV0
 18913     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 18914     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 348
* EL6311.cbl
 18915     MOVE X'2020233030303136313735' TO DFHEIV0(25:11)
 18916     CALL 'kxdfhei1' USING DFHEIV0,
 18917           FILE-ID-ERPNDB2,
 18918           DFHEIV11,
 18919           DFHEIV99
 18920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 18921
 18922
 18923     IF  EIBTRNID NOT = TRANS-EXB1
 18924         IF PENDING-BUS-RECS-FOUND
 18925             NEXT SENTENCE
 18926           ELSE
 18927             MOVE '9'            TO PI-BROWSE-SW
 18928             GO TO 9400-CLEAR.
 18929
 18930     IF SHOW-RECORD
 18931        MOVE ER-2253            TO EMI-ERROR
 18932       ELSE
 18933        MOVE ER-2254            TO EMI-ERROR.
 18934
 18935     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 18936
 18937     IF PI-MAP-NAME = SPACES
 18938        MOVE -1                  TO DPFENTRL
 18939        MOVE EL631D               TO PI-MAP-NAME
 18940        GO TO 8100-SEND-INITIAL-MAP.
 18941
 18942     IF PI-MAP-NAME = EL631B
 18943        MOVE -1                  TO BMAINTL
 18944     ELSE
 18945        IF PI-MAP-NAME = EL631C
 18946           MOVE -1               TO CMAINTL
 18947        ELSE
 18948           MOVE -1               TO DPFENTRL.
 18949
 18950     GO TO 8200-SEND-DATAONLY.
 18951
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 349
* EL6311.cbl
 18953
 18954***************************************************************
 18955*                                                             *
 18956*     FORWARD BROWSING ROUTINE   (BY BATCH)                   *
 18957*                                                             *
 18958*       1. READ RECORDS WITHIN THE BATCH BASED ON             *
 18959*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 18960*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 18961*          C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.      *
 18962*                                                             *
 18963*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 18964*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 18965*          A. IS IT WITHIN THE SAME KEY GROUP?                *
 18966*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 18967*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 18968*                AND IS IT TO BE DISPLAYED.                   *
 18969*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 18970*                DISPLAYED.                                   *
 18971*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 18972*                DISPLAYED.                                   *
 18973*                                                             *
 18974*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 18975*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 18976*                                                             *
 18977*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 18978*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 18979*                THEY ARE NOT TO BE DISPLAYED.                *
 18980*                                                             *
 18981***************************************************************
 18982
 18983 4100-BROWSE-PRIMARY-FORWARD.
 18984     IF FIRST-TIME  OR SHOW-RECORD
 18985        MOVE PI-ERPNDB-KEY         TO ERPNDB-KEY
 18986        MOVE +1                    TO ERPNDB-BATCH-SEQ-NO
 18987        MOVE ZEROS                 TO ERPNDB-BATCH-CHG-SEQ-NO
 18988     ELSE
 18989        MOVE PI-PREV-KEY           TO ERPNDB-KEY
 18990        IF ERPNDB-BATCH-SEQ-NO = +9999
 18991           GO TO 4150-END-BATCH
 18992        ELSE
 18993           IF DISPLAY-CHANGE-RECORDS
 18994              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 18995           ELSE
 18996              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 18997              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 18998
 18999     IF FIRST-TIME
 19000         IF ERPNDB-BATCH-SEQ-NO = +1  AND
 19001            PI-PB-BATCH-SEQ-NO NOT = ZERO
 19002              MOVE PI-PB-BATCH-SEQ-NO TO ERPNDB-BATCH-SEQ-NO.
 19003
 19004
 19005* EXEC CICS HANDLE CONDITION
 19006*         ENDFILE  (4150-END-BATCH)
 19007*    END-EXEC.
 19008*    MOVE '"$''                   ! J #00016260' TO DFHEIV0
 19009     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 19010     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 350
* EL6311.cbl
 19011     MOVE X'4A20233030303136323630' TO DFHEIV0(25:11)
 19012     CALL 'kxdfhei1' USING DFHEIV0
 19013     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19014
 19015
 19016 4105-READ-NEXT.
 19017
 19018* EXEC CICS HANDLE CONDITION
 19019*         NOTFND    (4150-END-BATCH)
 19020*    END-EXEC.
 19021*    MOVE '"$I                   ! K #00016265' TO DFHEIV0
 19022     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 19023     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19024     MOVE X'4B20233030303136323635' TO DFHEIV0(25:11)
 19025     CALL 'kxdfhei1' USING DFHEIV0
 19026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19027
 19028
 19029     MOVE SPACES                 TO WS-REC-FOUND-SW.
 19030
 19031     IF PI-DISPLAY-ORIGINAL-BATCH
 19032        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19033     ELSE
 19034        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19035
 19036
 19037* EXEC CICS READ
 19038*         DATASET   (FILE-ID)
 19039*         SET       (ADDRESS OF PENDING-BUSINESS)
 19040*         RIDFLD    (ERPNDB-KEY)
 19041*         GTEQ
 19042*    END-EXEC.
 19043*    MOVE '&"S        G          (   #00016276' TO DFHEIV0
 19044     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19046     MOVE X'2020233030303136323736' TO DFHEIV0(25:11)
 19047     CALL 'kxdfhei1' USING DFHEIV0,
 19048           FILE-ID,
 19049           DFHEIV20,
 19050           DFHEIV99,
 19051           ERPNDB-KEY,
 19052           DFHEIV99,
 19053           DFHEIV99,
 19054           DFHEIV99
 19055     SET ADDRESS OF PENDING-BUSINESS TO
 19056         DFHEIV20
 19057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19058
 19059
 19060     IF PI-DISPLAY-ORIGINAL-BATCH
 19061        IF (PB-ORIGINAL-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19062           (PB-ORIGINAL-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19063           GO TO 4150-END-BATCH
 19064        ELSE
 19065           IF PB-BATCH-TRAILER
 19066              MOVE HIGH-VALUES   TO ERPNDB-BATCH-SEQ-ALPHA
 19067              GO TO 4105-READ-NEXT
 19068           ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 351
* EL6311.cbl
 19069              NEXT SENTENCE
 19070     ELSE
 19071        IF (PB-COMPANY-CD  NOT = PI-COMPANY-CD) OR
 19072           (PB-ENTRY-BATCH NOT = PI-PB-ENTRY-BATCH)
 19073           GO TO 4150-END-BATCH.
 19074
 19075     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19076
 19077     IF WS-BATCH-PREFIX = '#CL'
 19078         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19079         GO TO 4105-READ-NEXT.
 19080
 19081     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19082     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19083     MOVE PB-STATE               TO PI-PB-STATE.
 19084     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19085
 19086     IF PB-BATCH-TRAILER
 19087        IF SHOW-RECORD
 19088           GO TO 4150-END-BATCH
 19089        ELSE
 19090           MOVE ER-2251         TO EMI-ERROR
 19091           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 19092           MOVE 1               TO PI-BROWSE-TYPE
 19093           GO TO 7200-DISPLAY-BATCHES.
 19094
 19095     IF SHOW-RECORD
 19096           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19097              GO TO 4110-BUMP-SEQ
 19098           ELSE
 19099              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19100                 GO TO 4110-BUMP-SEQ
 19101              ELSE
 19102                 GO TO 4107-CHECK-REC-TYPE.
 19103
 19104     IF NOT  PI-PRIMARY-WITH-SELECT
 19105        GO TO 4107-CHECK-REC-TYPE.
 19106
 19107     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19108        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19109           GO TO 4110-BUMP-SEQ
 19110        ELSE
 19111           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19112              GO TO 4107-CHECK-REC-TYPE
 19113           ELSE
 19114              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19115                 GO TO 4107-CHECK-REC-TYPE
 19116              ELSE
 19117                 GO TO 4110-BUMP-SEQ.
 19118
 19119     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19120        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19121           GO TO 4110-BUMP-SEQ.
 19122
 19123 4107-CHECK-REC-TYPE.
 19124     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19125         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19126             NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 352
* EL6311.cbl
 19127           ELSE
 19128             GO TO 4110-BUMP-SEQ.
 19129
 19130     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19131         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19132             NEXT SENTENCE
 19133           ELSE
 19134             GO TO 4110-BUMP-SEQ.
 19135
 19136     IF NOT DISPLAY-CHANGE-RECORDS AND
 19137        PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19138           GO TO 4110-BUMP-SEQ.
 19139
 19140     IF DISPLAY-HOLD-RECORDS AND
 19141        NOT PB-RECORD-ON-HOLD
 19142          GO TO 4110-BUMP-SEQ.
 19143
 19144     IF PB-ISSUE
 19145        IF DISPLAY-CHK-REQ-RECORDS
 19146            GO TO 4110-BUMP-SEQ.
 19147
 19148     IF PB-ISSUE
 19149        IF ISSUE-WITH-WARNING
 19150           IF PB-WARNING-ERRORS
 19151              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19152                  GO TO 4110-BUMP-SEQ
 19153              ELSE
 19154                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19155                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19156                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19157                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19158                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19159                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19160                 GO TO 7000-DISPLAY-ISSUES
 19161        ELSE
 19162            GO TO 4110-BUMP-SEQ.
 19163
 19164     IF PB-ISSUE
 19165        IF (ISSUES-IN-ERROR AND
 19166            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19167            ALL-ISSUES
 19168            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19169            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19170            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19171            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19172            MOVE PB-SV-STATE            TO PI-SV-STATE
 19173            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19174            GO TO 7000-DISPLAY-ISSUES
 19175        ELSE
 19176            GO TO 4110-BUMP-SEQ.
 19177
 19178     IF PB-CANCELLATION
 19179        IF DISPLAY-CHK-REQ-RECORDS
 19180           IF PB-C-REFUND-REQUESTED
 19181              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19182              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19183              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19184              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 353
* EL6311.cbl
 19185              MOVE PB-SV-STATE            TO PI-SV-STATE
 19186              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19187              GO TO 7100-DISPLAY-CANCELS
 19188           ELSE
 19189              GO TO 4110-BUMP-SEQ.
 19190
 19191     IF PB-CANCELLATION
 19192        IF CANCEL-WITH-WARNING
 19193           IF PB-WARNING-ERRORS
 19194              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19195                  GO TO 4110-BUMP-SEQ
 19196              ELSE
 19197                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19198                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19199                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19200                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19201                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19202                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19203                 GO TO 7100-DISPLAY-CANCELS
 19204           ELSE
 19205              GO TO 4110-BUMP-SEQ.
 19206
 19207     IF PB-CANCELLATION
 19208        IF (CANCEL-IN-ERROR  AND
 19209            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19210            ALL-CANCELS
 19211            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19212            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19213            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19214            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19215            MOVE PB-SV-STATE            TO PI-SV-STATE
 19216            MOVE 'Y'                    TO WS-PB-RECORDS-FOUND-SW
 19217            GO TO 7100-DISPLAY-CANCELS.
 19218
 19219 4110-BUMP-SEQ.
 19220     IF NOT DISPLAY-CHANGE-RECORDS
 19221        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19222        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19223     ELSE
 19224        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19225           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19226           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19227        ELSE
 19228           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19229           ADD +1                    TO ERPNDB-BATCH-CHG-SEQ-NO.
 19230
 19231     GO TO 4105-READ-NEXT.
 19232
 19233 4150-END-BATCH.
 19234******************************************************************
 19235*                                                                *
 19236*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19237*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 19238*         PROGRAM.                                               *
 19239*                                                                *
 19240******************************************************************
 19241
 19242     IF  EIBTRNID NOT = TRANS-EXB1
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 354
* EL6311.cbl
 19243         IF PENDING-BUS-RECS-FOUND
 19244             NEXT SENTENCE
 19245           ELSE
 19246             MOVE '9'            TO PI-BROWSE-SW
 19247             GO TO 9400-CLEAR.
 19248
 19249     IF SHOW-RECORD
 19250        MOVE ER-2253             TO EMI-ERROR
 19251     ELSE
 19252        MOVE ER-2251             TO EMI-ERROR.
 19253
 19254     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19255
 19256     IF PI-MAP-NAME = SPACES
 19257        MOVE -1                  TO BMAINTL
 19258        MOVE EL631B              TO PI-MAP-NAME
 19259        GO TO 8100-SEND-INITIAL-MAP.
 19260
 19261     IF PI-MAP-NAME = EL631B
 19262        MOVE -1                  TO BMAINTL
 19263     ELSE
 19264        IF PI-MAP-NAME = EL631C
 19265           MOVE -1               TO CMAINTL
 19266        ELSE
 19267           MOVE -1               TO DPFENTRL.
 19268
 19269     GO TO 8200-SEND-DATAONLY.
 19270
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 355
* EL6311.cbl
 19272
 19273***************************************************************
 19274*     FORWARD BROWSING ROUTINE   (BY CSR)                     *
 19275*                                                             *
 19276*      1. START BROWSE WITH                                   *
 19277*         A. FIRST RECORD SPECIFIED FROM FIRST SCREEN         *
 19278*         B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN       *
 19279*         C. RECORD REQUESTED VIA A SHOW MAINT REQUEST.       *
 19280*                                                             *
 19281*      2. READ RECORDS AND DETERMINE IF THEY ARE TO BE        *
 19282*         DISPLAYED BY USING THE FOLLOWING CHECKS.            *
 19283*         A. IS IT WITHIN THE SAME KEY GROUP?                 *
 19284*         B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED. *
 19285*         C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM   *
 19286*               AND IS IT TO BE DISPLAYED.                    *
 19287*         D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE        *
 19288*               DISPLAYED.                                    *
 19289*         E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE       *
 19290*               DISPLAYED.                                    *
 19291*                                                             *
 19292*      3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE      *
 19293*               RECORD KEY AND GO TO THE DISPLAY ROUTINE.     *
 19294***************************************************************
 19295
 19296 4200-BROWSE-CSR-FORWARD.
 19297
 19298     IF FIRST-TIME
 19299        MOVE PI-ERPNDB-CSR-KEY      TO ERPNDB-CSR-KEY
 19300     ELSE
 19301        MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 19302
 19303
 19304* EXEC CICS HANDLE CONDITION
 19305*         NOTFND   (4250-END-RECORDS)
 19306*         ENDFILE  (4250-END-RECORDS)
 19307*    END-EXEC.
 19308*    MOVE '"$I''                  ! L #00016526' TO DFHEIV0
 19309     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19310     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19311     MOVE X'4C20233030303136353236' TO DFHEIV0(25:11)
 19312     CALL 'kxdfhei1' USING DFHEIV0
 19313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19314
 19315
 19316
 19317* EXEC CICS STARTBR
 19318*         DATASET   (FILE-ID-ERPNDB4)
 19319*         RIDFLD    (ERPNDB-CSR-KEY)
 19320*    END-EXEC.
 19321     MOVE 0
 19322       TO DFHEIV11
 19323*    MOVE '&,         G          &   #00016531' TO DFHEIV0
 19324     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19325     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19326     MOVE X'2020233030303136353331' TO DFHEIV0(25:11)
 19327     CALL 'kxdfhei1' USING DFHEIV0,
 19328           FILE-ID-ERPNDB4,
 19329           ERPNDB-CSR-KEY,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 356
* EL6311.cbl
 19330           DFHEIV99,
 19331           DFHEIV11,
 19332           DFHEIV99
 19333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19334
 19335
 19336     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 19337
 19338     IF FIRST-TIME
 19339        MOVE SPACE               TO WS-FIRST-TIME-SW
 19340        GO TO 4205-READ-NEXT-RECORD.
 19341
 19342
 19343* EXEC CICS READNEXT
 19344*         DATASET    (FILE-ID-ERPNDB4)
 19345*         SET        (ADDRESS OF PENDING-BUSINESS)
 19346*         RIDFLD     (ERPNDB-CSR-KEY)
 19347*    END-EXEC.
 19348     MOVE 0
 19349       TO DFHEIV11
 19350*    MOVE '&.S                   )   #00016542' TO DFHEIV0
 19351     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19352     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19353     MOVE X'2020233030303136353432' TO DFHEIV0(25:11)
 19354     CALL 'kxdfhei1' USING DFHEIV0,
 19355           FILE-ID-ERPNDB4,
 19356           DFHEIV20,
 19357           DFHEIV99,
 19358           ERPNDB-CSR-KEY,
 19359           DFHEIV99,
 19360           DFHEIV11,
 19361           DFHEIV99,
 19362           DFHEIV99
 19363     SET ADDRESS OF PENDING-BUSINESS TO
 19364         DFHEIV20
 19365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19366
 19367
 19368 4205-READ-NEXT-RECORD.
 19369
 19370
 19371* EXEC CICS READNEXT
 19372*         DATASET    (FILE-ID-ERPNDB4)
 19373*         SET        (ADDRESS OF PENDING-BUSINESS)
 19374*         RIDFLD     (ERPNDB-CSR-KEY)
 19375*    END-EXEC.
 19376     MOVE 0
 19377       TO DFHEIV11
 19378*    MOVE '&.S                   )   #00016550' TO DFHEIV0
 19379     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 19380     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 19381     MOVE X'2020233030303136353530' TO DFHEIV0(25:11)
 19382     CALL 'kxdfhei1' USING DFHEIV0,
 19383           FILE-ID-ERPNDB4,
 19384           DFHEIV20,
 19385           DFHEIV99,
 19386           ERPNDB-CSR-KEY,
 19387           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 357
* EL6311.cbl
 19388           DFHEIV11,
 19389           DFHEIV99,
 19390           DFHEIV99
 19391     SET ADDRESS OF PENDING-BUSINESS TO
 19392         DFHEIV20
 19393     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19394
 19395
 19396     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19397
 19398     IF WS-BATCH-PREFIX = '#CL'
 19399        GO TO 4205-READ-NEXT-RECORD.
 19400
 19401     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 19402        PB-CSR-ID           NOT = PI-PB-CSR-ID
 19403        GO TO 4250-END-RECORDS.
 19404
 19405     IF PB-BATCH-TRAILER
 19406        GO TO 4205-READ-NEXT-RECORD.
 19407
 19408     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19409        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19410           GO TO 4205-READ-NEXT-RECORD
 19411        ELSE
 19412           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19413              GO TO 4210-CHECK-REC-TYPE
 19414           ELSE
 19415              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19416                 GO TO 4210-CHECK-REC-TYPE
 19417              ELSE
 19418                 GO TO 4205-READ-NEXT-RECORD.
 19419
 19420     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19421        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19422           GO TO 4205-READ-NEXT-RECORD.
 19423
 19424 4210-CHECK-REC-TYPE.
 19425     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19426         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19427             NEXT SENTENCE
 19428         ELSE
 19429             GO TO 4205-READ-NEXT-RECORD.
 19430
 19431     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19432         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19433             NEXT SENTENCE
 19434        ELSE
 19435             GO TO 4205-READ-NEXT-RECORD.
 19436
 19437     IF NOT DISPLAY-CHANGE-RECORDS AND
 19438            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19439        GO TO 4205-READ-NEXT-RECORD.
 19440
 19441     IF DISPLAY-HOLD-RECORDS AND
 19442        NOT PB-RECORD-ON-HOLD
 19443          GO TO 4205-READ-NEXT-RECORD.
 19444
 19445     IF PB-ISSUE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 358
* EL6311.cbl
 19446        IF DISPLAY-CHK-REQ-RECORDS
 19447            GO TO 4205-READ-NEXT-RECORD.
 19448
 19449     IF PB-ISSUE
 19450        IF ISSUE-WITH-WARNING
 19451           IF PB-WARNING-ERRORS
 19452              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19453                  GO TO 4205-READ-NEXT-RECORD
 19454              ELSE
 19455                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19456                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19457                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19458                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19459                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19460                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19461                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19462                 GO TO 7000-DISPLAY-ISSUES
 19463           ELSE
 19464              GO TO 4205-READ-NEXT-RECORD.
 19465
 19466     IF PB-ISSUE
 19467        IF (ISSUES-IN-ERROR AND
 19468            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19469            ALL-ISSUES
 19470            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19471            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19472            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19473            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19474            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19475            MOVE PB-SV-STATE            TO PI-SV-STATE
 19476            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19477            GO TO 7000-DISPLAY-ISSUES
 19478        ELSE
 19479            GO TO 4205-READ-NEXT-RECORD.
 19480
 19481     IF PB-CANCELLATION
 19482        IF DISPLAY-CHK-REQ-RECORDS
 19483           IF PB-C-REFUND-REQUESTED
 19484              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19485              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19486              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19487              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19488              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19489              MOVE PB-SV-STATE            TO PI-SV-STATE
 19490              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19491              GO TO 7100-DISPLAY-CANCELS
 19492           ELSE
 19493               GO TO 4205-READ-NEXT-RECORD.
 19494
 19495     IF PB-CANCELLATION
 19496        IF CANCEL-WITH-WARNING
 19497           IF PB-WARNING-ERRORS
 19498              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19499                  GO TO 4205-READ-NEXT-RECORD
 19500              ELSE
 19501                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19502                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19503                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 359
* EL6311.cbl
 19504                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19505                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19506                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19507                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19508                 GO TO 7100-DISPLAY-CANCELS
 19509           ELSE
 19510              GO TO 4205-READ-NEXT-RECORD.
 19511
 19512     IF PB-CANCELLATION
 19513        IF (CANCEL-IN-ERROR  AND
 19514            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19515            ALL-CANCELS
 19516            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19517            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 19518            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19519            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19520            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19521            MOVE PB-SV-STATE            TO PI-SV-STATE
 19522            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19523            GO TO 7100-DISPLAY-CANCELS.
 19524
 19525     GO TO 4205-READ-NEXT-RECORD.
 19526
 19527 4250-END-RECORDS.
 19528******************************************************************
 19529*                                                                *
 19530*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19531*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING
 19532*         PROGRAM.                                               *
 19533*                                                                *
 19534******************************************************************
 19535
 19536     IF BROWSE-STARTED
 19537        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 19538
 19539* EXEC CICS ENDBR
 19540*            DATASET  (FILE-ID-ERPNDB4)
 19541*       END-EXEC.
 19542     MOVE 0
 19543       TO DFHEIV11
 19544*    MOVE '&2                    $   #00016698' TO DFHEIV0
 19545     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 19546     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 19547     MOVE X'2020233030303136363938' TO DFHEIV0(25:11)
 19548     CALL 'kxdfhei1' USING DFHEIV0,
 19549           FILE-ID-ERPNDB4,
 19550           DFHEIV11,
 19551           DFHEIV99
 19552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19553
 19554
 19555     IF  EIBTRNID NOT = TRANS-EXB1
 19556         IF PENDING-BUS-RECS-FOUND
 19557             NEXT SENTENCE
 19558           ELSE
 19559             MOVE '9'            TO PI-BROWSE-SW
 19560             GO TO 9400-CLEAR.
 19561
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 360
* EL6311.cbl
 19562     IF SHOW-RECORD
 19563        MOVE ER-2253            TO EMI-ERROR
 19564       ELSE
 19565        MOVE ER-2254            TO EMI-ERROR.
 19566
 19567     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19568
 19569     IF PI-MAP-NAME = SPACES
 19570        MOVE -1                  TO DPFENTRL
 19571        MOVE EL631D               TO PI-MAP-NAME
 19572        GO TO 8100-SEND-INITIAL-MAP.
 19573
 19574     IF PI-MAP-NAME = EL631B
 19575        MOVE -1                  TO BMAINTL
 19576     ELSE
 19577        IF PI-MAP-NAME = EL631C
 19578           MOVE -1               TO CMAINTL
 19579        ELSE
 19580           MOVE -1               TO DPFENTRL.
 19581
 19582     GO TO 8200-SEND-DATAONLY.
 19583
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 361
* EL6311.cbl
 19585
 19586***************************************************************
 19587*                                                             *
 19588*     FORWARD BROWSING ROUTINE   (BY FILE)                    *
 19589*                                                             *
 19590*       1. READ RECORDS WITHIN THE FILE BY COMPANY            *
 19591*          A. FIRST TIME INTO PROGRAM FROM FIRST SCREEN       *
 19592*          B. LAST RECORD DISPLAYED FROM PREVIOUS SCREEN      *
 19593*                                                             *
 19594*       2. READ RECORDS AND DETERMINE IF THEY ARE TO BE       *
 19595*          DISPLAYED BY USING THE FOLLOWING CHECKS.           *
 19596*          A. IS IT WITHIN THE SAME COMPANY                   *
 19597*          B. IF IT IS A BILLED REC AND IS IT TO BE DISPLAYED.*
 19598*          C. IF IT HAS BEEN PROCESSED THRU THE BATCH SYSTEM  *
 19599*                AND IS IT TO BE DISPLAYED.                   *
 19600*          D. IF IT IS AN ISSUE AND IF ERRORS ARE TO BE       *
 19601*                DISPLAYED.                                   *
 19602*          E. IF IT IS AN CANCEL AND IF ERRORS ARE TO BE      *
 19603*                DISPLAYED.                                   *
 19604*                                                             *
 19605*       3. IF THE RECORD MEETS ALL REQUIREMENTS, SAVE THE     *
 19606*                RECORD KEY AND GO TO THE DISPLAY ROUTINE.    *
 19607*                                                             *
 19608*       4. WHEN READING ADDITION RECORDS ADJUSTMENTS MUST BE  *
 19609*                MADE TO BYPASS THE CORRECTION RECORDS IF     *
 19610*                THEY ARE NOT TO BE DISPLAYED.                *
 19611*                                                             *
 19612***************************************************************
 19613
 19614 4300-BROWSE-FILE-FORWARD.
 19615     IF FIRST-TIME OR SHOW-RECORD
 19616        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 19617        MOVE +1                  TO ERPNDB-BATCH-SEQ-NO
 19618        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 19619     ELSE
 19620        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 19621        IF ERPNDB-BATCH-SEQ-NO = +9999
 19622           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 19623        ELSE
 19624           IF DISPLAY-CHANGE-RECORDS
 19625              ADD +1             TO ERPNDB-BATCH-CHG-SEQ-NO
 19626           ELSE
 19627              MOVE ZEROS         TO ERPNDB-BATCH-CHG-SEQ-NO
 19628              ADD +1             TO ERPNDB-BATCH-SEQ-NO.
 19629
 19630
 19631* EXEC CICS HANDLE CONDITION
 19632*         ENDFILE  (4350-END-BATCH)
 19633*         NOTFND   (4350-END-BATCH)
 19634*    END-EXEC.
 19635*    MOVE '"$''I                  ! M #00016777' TO DFHEIV0
 19636     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
 19637     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19638     MOVE X'4D20233030303136373737' TO DFHEIV0(25:11)
 19639     CALL 'kxdfhei1' USING DFHEIV0
 19640     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19641
 19642
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 362
* EL6311.cbl
 19643 4305-READ-NEXT.
 19644     IF PI-DISPLAY-ORIGINAL-BATCH
 19645        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 19646     ELSE
 19647        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 19648
 19649
 19650* EXEC CICS READ
 19651*         DATASET   (FILE-ID)
 19652*         SET       (ADDRESS OF PENDING-BUSINESS)
 19653*         RIDFLD    (ERPNDB-KEY)
 19654*         GTEQ
 19655*    END-EXEC.
 19656*    MOVE '&"S        G          (   #00016788' TO DFHEIV0
 19657     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 19658     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 19659     MOVE X'2020233030303136373838' TO DFHEIV0(25:11)
 19660     CALL 'kxdfhei1' USING DFHEIV0,
 19661           FILE-ID,
 19662           DFHEIV20,
 19663           DFHEIV99,
 19664           ERPNDB-KEY,
 19665           DFHEIV99,
 19666           DFHEIV99,
 19667           DFHEIV99
 19668     SET ADDRESS OF PENDING-BUSINESS TO
 19669         DFHEIV20
 19670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19671
 19672
 19673     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 19674        GO TO 4350-END-BATCH.
 19675
 19676     MOVE PB-ENTRY-BATCH         TO ERPNDB-ENTRY-BATCH
 19677                                    WS-BATCH-NO.
 19678
 19679     IF  WS-BATCH-PREFIX = '#CL'
 19680         MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 19681         GO TO 4305-READ-NEXT.
 19682
 19683     MOVE PB-CONTROL-PRIMARY     TO PI-ERPNDB-KEY.
 19684     MOVE PB-CARRIER             TO PI-PB-CARRIER.
 19685     MOVE PB-GROUPING            TO PI-PB-GROUPING.
 19686     MOVE PB-STATE               TO PI-PB-STATE.
 19687     MOVE PB-ACCOUNT             TO PI-PB-ACCOUNT.
 19688
 19689     IF PB-BATCH-TRAILER
 19690        MOVE HIGH-VALUES         TO ERPNDB-BATCH-SEQ-ALPHA
 19691        GO TO 4305-READ-NEXT.
 19692
 19693     IF SHOW-RECORD
 19694           IF WS-NEW-CERT-NO NOT = PB-CERT-NO
 19695              GO TO 4310-BUMP-SEQ
 19696           ELSE
 19697              IF WS-NEW-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19698                 GO TO 4310-BUMP-SEQ
 19699              ELSE
 19700                 GO TO 4307-CHECK-REC-TYPE.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 363
* EL6311.cbl
 19701
 19702     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19703        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19704           GO TO 4310-BUMP-SEQ
 19705        ELSE
 19706           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19707              GO TO 4307-CHECK-REC-TYPE
 19708           ELSE
 19709              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19710                 GO TO 4307-CHECK-REC-TYPE
 19711              ELSE
 19712                 GO TO 4310-BUMP-SEQ.
 19713
 19714     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19715        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19716           GO TO 4310-BUMP-SEQ.
 19717
 19718 4307-CHECK-REC-TYPE.
 19719     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19720         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19721             NEXT SENTENCE
 19722         ELSE
 19723             GO TO 4310-BUMP-SEQ.
 19724
 19725     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19726         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19727             NEXT SENTENCE
 19728        ELSE
 19729             GO TO 4310-BUMP-SEQ.
 19730
 19731     IF NOT DISPLAY-CHANGE-RECORDS AND
 19732            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19733        GO TO 4310-BUMP-SEQ.
 19734
 19735     IF DISPLAY-HOLD-RECORDS AND
 19736        NOT PB-RECORD-ON-HOLD
 19737          GO TO 4310-BUMP-SEQ.
 19738
 19739     IF PB-ISSUE
 19740        IF DISPLAY-CHK-REQ-RECORDS
 19741           GO TO 4310-BUMP-SEQ.
 19742
 19743     IF PB-ISSUE
 19744        IF ISSUE-WITH-WARNING
 19745           IF PB-WARNING-ERRORS
 19746              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19747                  GO TO 4310-BUMP-SEQ
 19748              ELSE
 19749                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19750                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19751                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19752                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19753                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19754                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19755                 GO TO 7000-DISPLAY-ISSUES
 19756           ELSE
 19757              GO TO 4310-BUMP-SEQ.
 19758
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 364
* EL6311.cbl
 19759     IF PB-ISSUE
 19760        IF (ISSUES-IN-ERROR AND
 19761            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19762            ALL-ISSUES
 19763            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19764            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19765            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19766            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19767            MOVE PB-SV-STATE            TO PI-SV-STATE
 19768            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19769            GO TO 7000-DISPLAY-ISSUES
 19770        ELSE
 19771            GO TO 4310-BUMP-SEQ.
 19772
 19773     IF PB-CANCELLATION
 19774        IF DISPLAY-CHK-REQ-RECORDS
 19775           IF PB-C-REFUND-REQUESTED
 19776              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19777              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19778              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19779              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19780              MOVE PB-SV-STATE            TO PI-SV-STATE
 19781              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19782              GO TO 7100-DISPLAY-CANCELS
 19783           ELSE
 19784              GO TO 4310-BUMP-SEQ.
 19785
 19786     IF PB-CANCELLATION
 19787        IF CANCEL-WITH-WARNING
 19788           IF PB-WARNING-ERRORS
 19789              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 19790                  GO TO 4310-BUMP-SEQ
 19791              ELSE
 19792                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19793                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19794                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19795                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19796                 MOVE PB-SV-STATE            TO PI-SV-STATE
 19797                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19798                 GO TO 7100-DISPLAY-CANCELS
 19799           ELSE
 19800              GO TO 4310-BUMP-SEQ.
 19801
 19802     IF PB-CANCELLATION
 19803        IF (CANCEL-IN-ERROR  AND
 19804            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 19805            ALL-CANCELS
 19806            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 19807            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 19808            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 19809            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 19810            MOVE PB-SV-STATE            TO PI-SV-STATE
 19811            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 19812            GO TO 7100-DISPLAY-CANCELS.
 19813
 19814 4310-BUMP-SEQ.
 19815     IF NOT DISPLAY-CHANGE-RECORDS
 19816        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 365
* EL6311.cbl
 19817        ADD +1                   TO ERPNDB-BATCH-SEQ-NO
 19818     ELSE
 19819        IF PB-BATCH-SEQ-NO NOT = ERPNDB-BATCH-SEQ-NO
 19820           MOVE PB-BATCH-SEQ-NO  TO ERPNDB-BATCH-SEQ-NO
 19821           MOVE +999             TO ERPNDB-BATCH-CHG-SEQ-NO
 19822        ELSE
 19823           MOVE PB-BATCH-CHG-SEQ-NO  TO ERPNDB-BATCH-CHG-SEQ-NO
 19824           ADD +1                TO ERPNDB-BATCH-CHG-SEQ-NO.
 19825
 19826     GO TO 4305-READ-NEXT.
 19827
 19828 4350-END-BATCH.
 19829
 19830******************************************************************
 19831*                                                                *
 19832*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 19833*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING    *
 19834*         PROGRAM.                                               *
 19835*                                                                *
 19836******************************************************************
 19837
 19838     IF  EIBTRNID NOT = TRANS-EXB1
 19839         IF PENDING-BUS-RECS-FOUND
 19840             NEXT SENTENCE
 19841           ELSE
 19842             MOVE '9'            TO PI-BROWSE-SW
 19843             GO TO 9400-CLEAR.
 19844
 19845     IF SHOW-RECORD
 19846        MOVE ER-2253            TO EMI-ERROR
 19847     ELSE
 19848        MOVE ER-2251            TO EMI-ERROR.
 19849
 19850     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 19851
 19852     IF PI-MAP-NAME = SPACES
 19853        MOVE -1                  TO BMAINTL
 19854        MOVE EL631B               TO PI-MAP-NAME
 19855        GO TO 8100-SEND-INITIAL-MAP.
 19856
 19857     IF PI-MAP-NAME = EL631B
 19858        MOVE -1                  TO BMAINTL
 19859     ELSE
 19860        IF PI-MAP-NAME = EL631C
 19861           MOVE -1               TO CMAINTL
 19862        ELSE
 19863           MOVE -1               TO DPFENTRL.
 19864
 19865     GO TO 8200-SEND-DATAONLY.
 19866
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 366
* EL6311.cbl
 19868
 19869******************************************************************
 19870*                                                                *
 19871*        B R O W S E   D E T A I L   B A C K W A R D             *
 19872*                                                                *
 19873******************************************************************
 19874
 19875 4500-BROWSE-DETAIL-BACKWARD.
 19876
 19877     MOVE PI-PREV-ALT-KEY        TO ERPNDB-ALT-KEY.
 19878
 19879
 19880* EXEC CICS HANDLE CONDITION
 19881*         NOTFND   (4570-NOT-FOUND)
 19882*         ENDFILE  (4550-END-RECORDS)
 19883*    END-EXEC
 19884*    MOVE '"$I''                  ! N #00017001' TO DFHEIV0
 19885     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 19886     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 19887     MOVE X'4E20233030303137303031' TO DFHEIV0(25:11)
 19888     CALL 'kxdfhei1' USING DFHEIV0
 19889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 19890
 19891
 19892* EXEC CICS STARTBR
 19893*         DATASET   (FILE-ID-ERPNDB2)
 19894*         RIDFLD    (ERPNDB-ALT-KEY)
 19895*    END-EXEC.
 19896     MOVE 0
 19897       TO DFHEIV11
 19898*    MOVE '&,         G          &   #00017006' TO DFHEIV0
 19899     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 19900     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 19901     MOVE X'2020233030303137303036' TO DFHEIV0(25:11)
 19902     CALL 'kxdfhei1' USING DFHEIV0,
 19903           FILE-ID-ERPNDB2,
 19904           ERPNDB-ALT-KEY,
 19905           DFHEIV99,
 19906           DFHEIV11,
 19907           DFHEIV99
 19908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19909
 19910
 19911     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 19912                                    WS-FIRST-TIME-SW.
 19913
 19914 4505-READ-PREV-RECORD.
 19915
 19916* EXEC CICS READPREV
 19917*         DATASET    (FILE-ID-ERPNDB2)
 19918*         SET        (ADDRESS OF PENDING-BUSINESS)
 19919*         RIDFLD     (ERPNDB-ALT-KEY)
 19920*    END-EXEC.
 19921     MOVE 0
 19922       TO DFHEIV11
 19923*    MOVE '&0S                   )   #00017015' TO DFHEIV0
 19924     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 19925     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 367
* EL6311.cbl
 19926     MOVE X'2020233030303137303135' TO DFHEIV0(25:11)
 19927     CALL 'kxdfhei1' USING DFHEIV0,
 19928           FILE-ID-ERPNDB2,
 19929           DFHEIV20,
 19930           DFHEIV99,
 19931           ERPNDB-ALT-KEY,
 19932           DFHEIV99,
 19933           DFHEIV11,
 19934           DFHEIV99,
 19935           DFHEIV99
 19936     SET ADDRESS OF PENDING-BUSINESS TO
 19937         DFHEIV20
 19938     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 19939
 19940
 19941     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19942
 19943     IF WS-BATCH-PREFIX = '#CL'
 19944         GO TO 4505-READ-PREV-RECORD.
 19945
 19946     IF FIRST-TIME
 19947         MOVE SPACE               TO WS-FIRST-TIME-SW
 19948         GO TO 4505-READ-PREV-RECORD.
 19949
 19950     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD  OR
 19951        PB-CARRIER       NOT = PI-PB-CARRIER  OR
 19952        PB-GROUPING      NOT = PI-PB-GROUPING OR
 19953        PB-STATE         NOT = PI-PB-STATE    OR
 19954        PB-ACCOUNT       NOT = PI-PB-ACCOUNT
 19955          GO TO 4550-END-RECORDS.
 19956
 19957
 19958     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 19959
 19960     IF PB-BATCH-TRAILER
 19961        GO TO 4505-READ-PREV-RECORD.
 19962
 19963     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 19964
 19965     IF  WS-BATCH-PREFIX = '#CL'
 19966         GO TO 4505-READ-PREV-RECORD.
 19967
 19968     IF PI-PB-CERT-NO NOT = LOW-VALUES
 19969        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 19970           GO TO 4505-READ-PREV-RECORD
 19971        ELSE
 19972           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 19973              GO TO 4510-CHECK-REC-TYPE
 19974           ELSE
 19975              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 19976                 GO TO 4510-CHECK-REC-TYPE
 19977              ELSE
 19978                 GO TO 4505-READ-PREV-RECORD.
 19979
 19980     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 19981        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 19982           GO TO 4505-READ-PREV-RECORD.
 19983
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 368
* EL6311.cbl
 19984 4510-CHECK-REC-TYPE.
 19985     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 19986         IF  PB-CARRIER = PI-CARRIER-SECURITY
 19987             NEXT SENTENCE
 19988         ELSE
 19989             GO TO 4505-READ-PREV-RECORD.
 19990
 19991     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 19992         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 19993             NEXT SENTENCE
 19994        ELSE
 19995             GO TO 4505-READ-PREV-RECORD.
 19996
 19997     IF NOT DISPLAY-CHANGE-RECORDS AND
 19998            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 19999        GO TO 4505-READ-PREV-RECORD.
 20000
 20001     IF DISPLAY-HOLD-RECORDS AND
 20002        NOT PB-RECORD-ON-HOLD
 20003          GO TO 4505-READ-PREV-RECORD.
 20004
 20005     IF PB-ISSUE
 20006        IF DISPLAY-CHK-REQ-RECORDS
 20007           GO TO 4505-READ-PREV-RECORD.
 20008
 20009     IF PB-ISSUE
 20010        IF ISSUE-WITH-WARNING
 20011           IF PB-WARNING-ERRORS
 20012              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20013                  GO TO 4505-READ-PREV-RECORD
 20014              ELSE
 20015                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20016                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20017                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20018                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20019                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20020                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20021                 GO TO 7000-DISPLAY-ISSUES
 20022           ELSE
 20023              GO TO 4505-READ-PREV-RECORD.
 20024
 20025     IF PB-ISSUE
 20026        IF (ISSUES-IN-ERROR AND
 20027            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20028            ALL-ISSUES
 20029            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20030            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20031            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20032            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20033            MOVE PB-SV-STATE            TO PI-SV-STATE
 20034            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20035            GO TO 7000-DISPLAY-ISSUES
 20036        ELSE
 20037            GO TO 4505-READ-PREV-RECORD.
 20038
 20039     IF PB-CANCELLATION
 20040        IF DISPLAY-CHK-REQ-RECORDS
 20041           IF PB-C-REFUND-REQUESTED
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 369
* EL6311.cbl
 20042              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20043              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20044              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20045              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20046              MOVE PB-SV-STATE            TO PI-SV-STATE
 20047              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20048              GO TO 7100-DISPLAY-CANCELS
 20049           ELSE
 20050              GO TO 4505-READ-PREV-RECORD.
 20051
 20052     IF PB-CANCELLATION
 20053        IF CANCEL-WITH-WARNING
 20054           IF PB-WARNING-ERRORS
 20055              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20056                  GO TO 4505-READ-PREV-RECORD
 20057              ELSE
 20058                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20059                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20060                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20061                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20062                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20063                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20064                 GO TO 7100-DISPLAY-CANCELS
 20065           ELSE
 20066              GO TO 4505-READ-PREV-RECORD.
 20067
 20068     IF PB-CANCELLATION
 20069        IF (CANCEL-IN-ERROR  AND
 20070            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20071            ALL-CANCELS
 20072            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20073            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20074            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20075            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20076            MOVE PB-SV-STATE            TO PI-SV-STATE
 20077            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20078            GO TO 7100-DISPLAY-CANCELS.
 20079
 20080     GO TO 4505-READ-PREV-RECORD.
 20081
 20082 4550-END-RECORDS.
 20083     IF PI-MAP-NAME = EL631B
 20084        MOVE -1                  TO BMAINTL
 20085     ELSE
 20086        IF PI-MAP-NAME = EL631C
 20087           MOVE -1               TO CMAINTL
 20088        ELSE
 20089           MOVE -1               TO DPFENTRL.
 20090
 20091     MOVE ER-2255               TO EMI-ERROR.
 20092     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20093     GO TO 8200-SEND-DATAONLY.
 20094
 20095 4570-NOT-FOUND.
 20096
 20097******************************************************************
 20098*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20099******************************************************************
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 370
* EL6311.cbl
 20100
 20101
 20102* EXEC CICS RESETBR
 20103*         DATASET    (FILE-ID-ERPNDB2)
 20104*         RIDFLD     (ERPNDB-ALT-KEY)
 20105*    END-EXEC.
 20106     MOVE 0
 20107       TO DFHEIV11
 20108*    MOVE '&4         G          &   #00017181' TO DFHEIV0
 20109     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20110     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20111     MOVE X'2020233030303137313831' TO DFHEIV0(25:11)
 20112     CALL 'kxdfhei1' USING DFHEIV0,
 20113           FILE-ID-ERPNDB2,
 20114           ERPNDB-ALT-KEY,
 20115           DFHEIV99,
 20116           DFHEIV11,
 20117           DFHEIV99
 20118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20119
 20120
 20121
 20122* EXEC CICS READNEXT
 20123*         DATASET    (FILE-ID-ERPNDB2)
 20124*         SET        (ADDRESS OF PENDING-BUSINESS)
 20125*         RIDFLD     (ERPNDB-ALT-KEY)
 20126*    END-EXEC.
 20127     MOVE 0
 20128       TO DFHEIV11
 20129*    MOVE '&.S                   )   #00017186' TO DFHEIV0
 20130     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20131     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20132     MOVE X'2020233030303137313836' TO DFHEIV0(25:11)
 20133     CALL 'kxdfhei1' USING DFHEIV0,
 20134           FILE-ID-ERPNDB2,
 20135           DFHEIV20,
 20136           DFHEIV99,
 20137           ERPNDB-ALT-KEY,
 20138           DFHEIV99,
 20139           DFHEIV11,
 20140           DFHEIV99,
 20141           DFHEIV99
 20142     SET ADDRESS OF PENDING-BUSINESS TO
 20143         DFHEIV20
 20144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20145
 20146
 20147
 20148* EXEC CICS READPREV
 20149*         DATASET    (FILE-ID-ERPNDB2)
 20150*         SET        (ADDRESS OF PENDING-BUSINESS)
 20151*         RIDFLD     (ERPNDB-ALT-KEY)
 20152*    END-EXEC.
 20153     MOVE 0
 20154       TO DFHEIV11
 20155*    MOVE '&0S                   )   #00017192' TO DFHEIV0
 20156     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20157     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 371
* EL6311.cbl
 20158     MOVE X'2020233030303137313932' TO DFHEIV0(25:11)
 20159     CALL 'kxdfhei1' USING DFHEIV0,
 20160           FILE-ID-ERPNDB2,
 20161           DFHEIV20,
 20162           DFHEIV99,
 20163           ERPNDB-ALT-KEY,
 20164           DFHEIV99,
 20165           DFHEIV11,
 20166           DFHEIV99,
 20167           DFHEIV99
 20168     SET ADDRESS OF PENDING-BUSINESS TO
 20169         DFHEIV20
 20170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20171
 20172
 20173 4580-READ-PREV-RECORD.
 20174
 20175* EXEC CICS READPREV
 20176*         DATASET    (FILE-ID-ERPNDB2)
 20177*         SET        (ADDRESS OF PENDING-BUSINESS)
 20178*         RIDFLD     (ERPNDB-ALT-KEY)
 20179*    END-EXEC.
 20180     MOVE 0
 20181       TO DFHEIV11
 20182*    MOVE '&0S                   )   #00017199' TO DFHEIV0
 20183     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20184     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20185     MOVE X'2020233030303137313939' TO DFHEIV0(25:11)
 20186     CALL 'kxdfhei1' USING DFHEIV0,
 20187           FILE-ID-ERPNDB2,
 20188           DFHEIV20,
 20189           DFHEIV99,
 20190           ERPNDB-ALT-KEY,
 20191           DFHEIV99,
 20192           DFHEIV11,
 20193           DFHEIV99,
 20194           DFHEIV99
 20195     SET ADDRESS OF PENDING-BUSINESS TO
 20196         DFHEIV20
 20197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20198
 20199
 20200     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20201
 20202     IF WS-BATCH-PREFIX = '#CL'
 20203        GO TO 4580-READ-PREV-RECORD.
 20204
 20205     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 20206     GO TO 4505-READ-PREV-RECORD.
 20207
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 372
* EL6311.cbl
 20209
 20210******************************************************************
 20211*                                                                *
 20212*        B R O W S E   P R I M A R Y   B A C K W A R D           *
 20213*                                                                *
 20214******************************************************************
 20215
 20216 4600-BROWSE-PRIMARY-BACKWARD.
 20217        MOVE PI-PREV-KEY         TO ERPNDB-KEY.
 20218
 20219     IF ERPNDB-BATCH-SEQ-NO = +9999
 20220        MOVE PI-HIGH-SEQ-NO      TO ERPNDB-BATCH-SEQ-NO.
 20221
 20222        IF ERPNDB-BATCH-SEQ-NO = +0000
 20223           GO TO 4650-END-BATCH
 20224        ELSE
 20225           IF PI-MAP-NAME NOT = EL631D
 20226              IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20227                 SUBTRACT +1      FROM ERPNDB-BATCH-CHG-SEQ-NO
 20228              ELSE
 20229                 SUBTRACT +1      FROM ERPNDB-BATCH-SEQ-NO
 20230                 IF DISPLAY-CHANGE-RECORDS
 20231                    MOVE +999     TO ERPNDB-BATCH-CHG-SEQ-NO
 20232                 ELSE
 20233                    MOVE ZEROS    TO ERPNDB-BATCH-CHG-SEQ-NO.
 20234
 20235
 20236* EXEC CICS HANDLE CONDITION
 20237*         NOTFND    (4680-NOT-FOUND)
 20238*         ENDFILE   (4680-NOT-FOUND)
 20239*    END-EXEC.
 20240*    MOVE '"$I''                  ! O #00017240' TO DFHEIV0
 20241     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20242     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20243     MOVE X'4F20233030303137323430' TO DFHEIV0(25:11)
 20244     CALL 'kxdfhei1' USING DFHEIV0
 20245     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20246
 20247
 20248 4605-READ-NEXT.
 20249     IF ERPNDB-BATCH-SEQ-NO = +0000
 20250        GO TO 4650-END-BATCH.
 20251
 20252     IF PI-DISPLAY-ORIGINAL-BATCH
 20253        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20254     ELSE
 20255        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20256
 20257
 20258* EXEC CICS READ
 20259*         DATASET   (FILE-ID)
 20260*         SET       (ADDRESS OF PENDING-BUSINESS)
 20261*         RIDFLD    (ERPNDB-KEY)
 20262*    END-EXEC.
 20263*    MOVE '&"S        E          (   #00017254' TO DFHEIV0
 20264     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 20265     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 20266     MOVE X'2020233030303137323534' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 373
* EL6311.cbl
 20267     CALL 'kxdfhei1' USING DFHEIV0,
 20268           FILE-ID,
 20269           DFHEIV20,
 20270           DFHEIV99,
 20271           ERPNDB-KEY,
 20272           DFHEIV99,
 20273           DFHEIV99,
 20274           DFHEIV99
 20275     SET ADDRESS OF PENDING-BUSINESS TO
 20276         DFHEIV20
 20277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20278
 20279
 20280     IF NOT  PI-PRIMARY-WITH-SELECT
 20281        GO TO 4607-CHECK-REC-TYPE.
 20282
 20283     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20284
 20285     IF  WS-BATCH-PREFIX = '#CL'
 20286         GO TO 4610-BUMP-SEQ.
 20287
 20288     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20289        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20290           GO TO 4610-BUMP-SEQ
 20291        ELSE
 20292           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20293              GO TO 4607-CHECK-REC-TYPE
 20294           ELSE
 20295              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20296                 GO TO 4607-CHECK-REC-TYPE
 20297              ELSE
 20298                 GO TO 4610-BUMP-SEQ.
 20299
 20300     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20301        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20302           GO TO 4610-BUMP-SEQ.
 20303
 20304 4607-CHECK-REC-TYPE.
 20305     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20306         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20307             NEXT SENTENCE
 20308         ELSE
 20309             GO TO 4610-BUMP-SEQ.
 20310
 20311     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20312         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20313             NEXT SENTENCE
 20314        ELSE
 20315             GO TO 4610-BUMP-SEQ.
 20316
 20317     IF NOT DISPLAY-CHANGE-RECORDS AND
 20318            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20319        GO TO 4610-BUMP-SEQ.
 20320
 20321     IF DISPLAY-HOLD-RECORDS AND
 20322        NOT PB-RECORD-ON-HOLD
 20323          GO TO 4610-BUMP-SEQ.
 20324
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 374
* EL6311.cbl
 20325     IF PB-ISSUE
 20326        IF DISPLAY-CHK-REQ-RECORDS
 20327           GO TO 4610-BUMP-SEQ.
 20328
 20329     IF PB-ISSUE
 20330        IF ISSUE-WITH-WARNING
 20331           IF PB-WARNING-ERRORS
 20332              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20333                  GO TO 4610-BUMP-SEQ
 20334              ELSE
 20335                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20336                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20337                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20338                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20339                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20340                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20341                 GO TO 7000-DISPLAY-ISSUES
 20342           ELSE
 20343              GO TO 4610-BUMP-SEQ.
 20344
 20345     IF PB-ISSUE
 20346        IF (ISSUES-IN-ERROR AND
 20347            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20348            ALL-ISSUES
 20349            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20350            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20351            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20352            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20353            MOVE PB-SV-STATE            TO PI-SV-STATE
 20354            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20355            GO TO 7000-DISPLAY-ISSUES
 20356        ELSE
 20357            GO TO 4610-BUMP-SEQ.
 20358
 20359     IF PB-CANCELLATION
 20360        IF DISPLAY-CHK-REQ-RECORDS
 20361           IF PB-C-REFUND-REQUESTED
 20362              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20363              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20364              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20365              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20366              MOVE PB-SV-STATE            TO PI-SV-STATE
 20367              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20368              GO TO 7100-DISPLAY-CANCELS
 20369           ELSE
 20370              GO TO 4610-BUMP-SEQ.
 20371
 20372     IF PB-CANCELLATION
 20373        IF CANCEL-WITH-WARNING
 20374           IF PB-WARNING-ERRORS
 20375              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20376                  GO TO 4610-BUMP-SEQ
 20377              ELSE
 20378                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20379                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20380                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20381                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20382                 MOVE PB-SV-STATE            TO PI-SV-STATE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 375
* EL6311.cbl
 20383                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20384                 GO TO 7100-DISPLAY-CANCELS
 20385           ELSE
 20386              GO TO 4610-BUMP-SEQ.
 20387
 20388     IF PB-CANCELLATION
 20389        IF (CANCEL-IN-ERROR  AND
 20390            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20391            ALL-CANCELS
 20392            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20393            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20394            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20395            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20396            MOVE PB-SV-STATE            TO PI-SV-STATE
 20397            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20398            GO TO 7100-DISPLAY-CANCELS.
 20399
 20400 4610-BUMP-SEQ.
 20401     IF ERPNDB-BATCH-SEQ-NO = ZEROS
 20402        GO TO 4650-END-BATCH.
 20403
 20404     IF DISPLAY-CHANGE-RECORDS
 20405        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20406           SUBTRACT +1           FROM ERPNDB-BATCH-CHG-SEQ-NO
 20407        ELSE
 20408           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20409           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20410        ELSE
 20411           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20412           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO.
 20413
 20414        GO TO 4605-READ-NEXT.
 20415
 20416 4650-END-BATCH.
 20417     IF PI-MAP-NAME = EL631B
 20418        MOVE -1                  TO BMAINTL
 20419     ELSE
 20420        IF PI-MAP-NAME = EL631C
 20421           MOVE -1               TO CMAINTL
 20422        ELSE
 20423           MOVE -1               TO DPFENTRL.
 20424
 20425     MOVE ER-2252               TO EMI-ERROR.
 20426     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20427     GO TO 8200-SEND-DATAONLY.
 20428
 20429 4680-NOT-FOUND.
 20430     IF DISPLAY-CHANGE-RECORDS
 20431        IF ERPNDB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20432           MOVE ZEROS            TO   ERPNDB-BATCH-CHG-SEQ-NO
 20433        ELSE
 20434           MOVE +999             TO   ERPNDB-BATCH-CHG-SEQ-NO
 20435           SUBTRACT +1           FROM ERPNDB-BATCH-SEQ-NO
 20436     ELSE
 20437        SUBTRACT +1              FROM ERPNDB-BATCH-SEQ-NO.
 20438
 20439     GO TO 4605-READ-NEXT.
 20440
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 376
* EL6311.cbl
 20442
 20443******************************************************************
 20444*                                                                *
 20445*        B R O W S E   F I L E   B A C K W A R D S               *
 20446*                                                                *
 20447******************************************************************
 20448
 20449 4800-BROWSE-FILE-BACKWARD.
 20450
 20451* EXEC CICS HANDLE CONDITION
 20452*         NOTFND   (4860-NOT-FOUND)
 20453*         ENDFILE  (4850-END-RECORDS)
 20454*    END-EXEC.
 20455*    MOVE '"$I''                  ! P #00017430' TO DFHEIV0
 20456     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20457     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20458     MOVE X'5020233030303137343330' TO DFHEIV0(25:11)
 20459     CALL 'kxdfhei1' USING DFHEIV0
 20460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20461
 20462
 20463     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 20464
 20465     IF PI-DISPLAY-ORIGINAL-BATCH
 20466        MOVE FILE-ID-ERPNDB3     TO FILE-ID
 20467     ELSE
 20468        MOVE FILE-ID-ERPNDB      TO FILE-ID.
 20469
 20470
 20471* EXEC CICS STARTBR
 20472*         DATASET   (FILE-ID)
 20473*         RIDFLD    (ERPNDB-KEY)
 20474*    END-EXEC.
 20475     MOVE 0
 20476       TO DFHEIV11
 20477*    MOVE '&,         G          &   #00017442' TO DFHEIV0
 20478     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20479     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20480     MOVE X'2020233030303137343432' TO DFHEIV0(25:11)
 20481     CALL 'kxdfhei1' USING DFHEIV0,
 20482           FILE-ID,
 20483           ERPNDB-KEY,
 20484           DFHEIV99,
 20485           DFHEIV11,
 20486           DFHEIV99
 20487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20488
 20489
 20490     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 20491
 20492
 20493* EXEC CICS READPREV
 20494*         DATASET    (FILE-ID-ERPNDB)
 20495*         SET        (ADDRESS OF PENDING-BUSINESS)
 20496*         RIDFLD     (ERPNDB-KEY)
 20497*    END-EXEC.
 20498     MOVE 0
 20499       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 377
* EL6311.cbl
 20500*    MOVE '&0S                   )   #00017449' TO DFHEIV0
 20501     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20502     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20503     MOVE X'2020233030303137343439' TO DFHEIV0(25:11)
 20504     CALL 'kxdfhei1' USING DFHEIV0,
 20505           FILE-ID-ERPNDB,
 20506           DFHEIV20,
 20507           DFHEIV99,
 20508           ERPNDB-KEY,
 20509           DFHEIV99,
 20510           DFHEIV11,
 20511           DFHEIV99,
 20512           DFHEIV99
 20513     SET ADDRESS OF PENDING-BUSINESS TO
 20514         DFHEIV20
 20515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20516
 20517
 20518 4810-READ-PREV-RECORD.
 20519
 20520* EXEC CICS READPREV
 20521*         DATASET    (FILE-ID-ERPNDB)
 20522*         SET        (ADDRESS OF PENDING-BUSINESS)
 20523*         RIDFLD     (ERPNDB-KEY)
 20524*    END-EXEC.
 20525     MOVE 0
 20526       TO DFHEIV11
 20527*    MOVE '&0S                   )   #00017456' TO DFHEIV0
 20528     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20529     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20530     MOVE X'2020233030303137343536' TO DFHEIV0(25:11)
 20531     CALL 'kxdfhei1' USING DFHEIV0,
 20532           FILE-ID-ERPNDB,
 20533           DFHEIV20,
 20534           DFHEIV99,
 20535           ERPNDB-KEY,
 20536           DFHEIV99,
 20537           DFHEIV11,
 20538           DFHEIV99,
 20539           DFHEIV99
 20540     SET ADDRESS OF PENDING-BUSINESS TO
 20541         DFHEIV20
 20542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20543
 20544
 20545     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 20546        GO TO 4850-END-RECORDS.
 20547
 20548     IF PB-BATCH-TRAILER
 20549        GO TO 4810-READ-PREV-RECORD.
 20550
 20551     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20552
 20553     IF  WS-BATCH-PREFIX = '#CL'
 20554         GO TO 4810-READ-PREV-RECORD.
 20555
 20556     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20557        IF PI-PB-CERT-NO NOT = PB-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 378
* EL6311.cbl
 20558           GO TO 4810-READ-PREV-RECORD
 20559        ELSE
 20560           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20561              GO TO 4820-CHECK-REC-TYPE
 20562           ELSE
 20563              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20564                 GO TO 4820-CHECK-REC-TYPE
 20565              ELSE
 20566                 GO TO 4810-READ-PREV-RECORD.
 20567
 20568     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20569        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20570           GO TO 4810-READ-PREV-RECORD.
 20571
 20572 4820-CHECK-REC-TYPE.
 20573     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20574         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20575             NEXT SENTENCE
 20576         ELSE
 20577             GO TO 4810-READ-PREV-RECORD.
 20578
 20579     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20580         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20581             NEXT SENTENCE
 20582        ELSE
 20583             GO TO 4810-READ-PREV-RECORD.
 20584
 20585     IF NOT DISPLAY-CHANGE-RECORDS AND
 20586            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20587        GO TO 4810-READ-PREV-RECORD.
 20588
 20589     IF DISPLAY-HOLD-RECORDS AND
 20590        NOT PB-RECORD-ON-HOLD
 20591          GO TO 4810-READ-PREV-RECORD.
 20592
 20593     IF PB-ISSUE
 20594        IF DISPLAY-CHK-REQ-RECORDS
 20595           GO TO 4810-READ-PREV-RECORD.
 20596
 20597     IF PB-ISSUE
 20598        IF ISSUE-WITH-WARNING
 20599           IF PB-WARNING-ERRORS
 20600              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20601                  GO TO 4810-READ-PREV-RECORD
 20602              ELSE
 20603                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20604                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20605                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20606                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20607                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20608                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20609                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20610                 GO TO 7000-DISPLAY-ISSUES
 20611           ELSE
 20612              GO TO 4810-READ-PREV-RECORD.
 20613
 20614     IF PB-ISSUE
 20615        IF (ISSUES-IN-ERROR AND
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 379
* EL6311.cbl
 20616            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20617            ALL-ISSUES
 20618            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20619            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20620            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20621            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20622            MOVE PB-SV-STATE            TO PI-SV-STATE
 20623            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20624            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20625            GO TO 7000-DISPLAY-ISSUES
 20626        ELSE
 20627            GO TO 4810-READ-PREV-RECORD.
 20628
 20629     IF PB-CANCELLATION
 20630        IF DISPLAY-CHK-REQ-RECORDS
 20631           IF PB-C-REFUND-REQUESTED
 20632              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20633              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20634              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20635              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20636              MOVE PB-SV-STATE            TO PI-SV-STATE
 20637              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20638              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20639              GO TO 7100-DISPLAY-CANCELS
 20640           ELSE
 20641              GO TO 4810-READ-PREV-RECORD.
 20642
 20643     IF PB-CANCELLATION
 20644        IF CANCEL-WITH-WARNING
 20645           IF PB-WARNING-ERRORS
 20646              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20647                  GO TO 4810-READ-PREV-RECORD
 20648              ELSE
 20649                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20650                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20651                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20652                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20653                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20654                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20655                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20656                 GO TO 7100-DISPLAY-CANCELS
 20657           ELSE
 20658              GO TO 4810-READ-PREV-RECORD.
 20659
 20660     IF PB-CANCELLATION
 20661        IF (CANCEL-IN-ERROR  AND
 20662            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20663            ALL-CANCELS
 20664            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20665            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20666            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20667            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20668            MOVE PB-SV-STATE            TO PI-SV-STATE
 20669            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20670            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20671            GO TO 7100-DISPLAY-CANCELS.
 20672
 20673     GO TO 4810-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 380
* EL6311.cbl
 20674
 20675 4850-END-RECORDS.
 20676     MOVE ER-2252                TO EMI-ERROR.
 20677     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20678
 20679     IF PI-MAP-NAME = EL631B
 20680        MOVE -1                  TO BPFENTRL
 20681     ELSE
 20682        MOVE -1                  TO CPFENTRL.
 20683
 20684     GO TO 8200-SEND-DATAONLY.
 20685
 20686 4860-NOT-FOUND.
 20687
 20688******************************************************************
 20689*       CONDITION MAY OCCUR IF PREV RECORD HAS BEEN DELETED.     *
 20690******************************************************************
 20691
 20692
 20693* EXEC CICS RESETBR
 20694*         DATASET    (FILE-ID-ERPNDB)
 20695*         RIDFLD     (ERPNDB-KEY)
 20696*     END-EXEC.
 20697     MOVE 0
 20698       TO DFHEIV11
 20699*    MOVE '&4         G          &   #00017609' TO DFHEIV0
 20700     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 20701     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20702     MOVE X'2020233030303137363039' TO DFHEIV0(25:11)
 20703     CALL 'kxdfhei1' USING DFHEIV0,
 20704           FILE-ID-ERPNDB,
 20705           ERPNDB-KEY,
 20706           DFHEIV99,
 20707           DFHEIV11,
 20708           DFHEIV99
 20709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20710
 20711
 20712
 20713* EXEC CICS READNEXT
 20714*         DATASET    (FILE-ID-ERPNDB)
 20715*         SET        (ADDRESS OF PENDING-BUSINESS)
 20716*         RIDFLD     (ERPNDB-KEY)
 20717*    END-EXEC.
 20718     MOVE 0
 20719       TO DFHEIV11
 20720*    MOVE '&.S                   )   #00017614' TO DFHEIV0
 20721     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 20722     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20723     MOVE X'2020233030303137363134' TO DFHEIV0(25:11)
 20724     CALL 'kxdfhei1' USING DFHEIV0,
 20725           FILE-ID-ERPNDB,
 20726           DFHEIV20,
 20727           DFHEIV99,
 20728           ERPNDB-KEY,
 20729           DFHEIV99,
 20730           DFHEIV11,
 20731           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 381
* EL6311.cbl
 20732           DFHEIV99
 20733     SET ADDRESS OF PENDING-BUSINESS TO
 20734         DFHEIV20
 20735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20736
 20737
 20738
 20739* EXEC CICS READPREV
 20740*         DATASET    (FILE-ID-ERPNDB)
 20741*         SET        (ADDRESS OF PENDING-BUSINESS)
 20742*         RIDFLD     (ERPNDB-KEY)
 20743*    END-EXEC.
 20744     MOVE 0
 20745       TO DFHEIV11
 20746*    MOVE '&0S                   )   #00017620' TO DFHEIV0
 20747     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20748     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 20749     MOVE X'2020233030303137363230' TO DFHEIV0(25:11)
 20750     CALL 'kxdfhei1' USING DFHEIV0,
 20751           FILE-ID-ERPNDB,
 20752           DFHEIV20,
 20753           DFHEIV99,
 20754           ERPNDB-KEY,
 20755           DFHEIV99,
 20756           DFHEIV11,
 20757           DFHEIV99,
 20758           DFHEIV99
 20759     SET ADDRESS OF PENDING-BUSINESS TO
 20760         DFHEIV20
 20761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20762
 20763
 20764     GO TO 4810-READ-PREV-RECORD.
 20765
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 382
* EL6311.cbl
 20767
 20768******************************************************************
 20769*                                                                *
 20770*           B R O W S E   C S R   B A C K W A R D                *
 20771*                                                                *
 20772******************************************************************
 20773
 20774 4900-BROWSE-CSR-BACKWARD.
 20775
 20776     MOVE PI-PREV-CSR-KEY        TO ERPNDB-CSR-KEY.
 20777
 20778
 20779* EXEC CICS HANDLE CONDITION
 20780*         NOTFND   (4970-NOT-FOUND)
 20781*         ENDFILE  (4950-END-RECORDS)
 20782*    END-EXEC
 20783*    MOVE '"$I''                  ! Q #00017640' TO DFHEIV0
 20784     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 20785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 20786     MOVE X'5120233030303137363430' TO DFHEIV0(25:11)
 20787     CALL 'kxdfhei1' USING DFHEIV0
 20788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 20789
 20790
 20791* EXEC CICS STARTBR
 20792*         DATASET   (FILE-ID-ERPNDB4)
 20793*         RIDFLD    (ERPNDB-CSR-KEY)
 20794*    END-EXEC.
 20795     MOVE 0
 20796       TO DFHEIV11
 20797*    MOVE '&,         G          &   #00017645' TO DFHEIV0
 20798     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 20799     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 20800     MOVE X'2020233030303137363435' TO DFHEIV0(25:11)
 20801     CALL 'kxdfhei1' USING DFHEIV0,
 20802           FILE-ID-ERPNDB4,
 20803           ERPNDB-CSR-KEY,
 20804           DFHEIV99,
 20805           DFHEIV11,
 20806           DFHEIV99
 20807     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20808
 20809
 20810     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW
 20811                                    WS-FIRST-TIME-SW.
 20812
 20813 4905-READ-PREV-RECORD.
 20814
 20815* EXEC CICS READPREV
 20816*         DATASET    (FILE-ID-ERPNDB4)
 20817*         SET        (ADDRESS OF PENDING-BUSINESS)
 20818*         RIDFLD     (ERPNDB-CSR-KEY)
 20819*    END-EXEC.
 20820     MOVE 0
 20821       TO DFHEIV11
 20822*    MOVE '&0S                   )   #00017654' TO DFHEIV0
 20823     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 20824     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 383
* EL6311.cbl
 20825     MOVE X'2020233030303137363534' TO DFHEIV0(25:11)
 20826     CALL 'kxdfhei1' USING DFHEIV0,
 20827           FILE-ID-ERPNDB4,
 20828           DFHEIV20,
 20829           DFHEIV99,
 20830           ERPNDB-CSR-KEY,
 20831           DFHEIV99,
 20832           DFHEIV11,
 20833           DFHEIV99,
 20834           DFHEIV99
 20835     SET ADDRESS OF PENDING-BUSINESS TO
 20836         DFHEIV20
 20837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 20838
 20839
 20840     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20841
 20842     IF WS-BATCH-PREFIX = '#CL'
 20843         GO TO 4905-READ-PREV-RECORD.
 20844
 20845     IF FIRST-TIME
 20846         MOVE SPACE               TO WS-FIRST-TIME-SW
 20847         GO TO 4905-READ-PREV-RECORD.
 20848
 20849     IF PB-CSR-COMPANY-CD   NOT = PI-COMPANY-CD OR
 20850        PB-CSR-ID           NOT = PI-PB-CSR-ID
 20851        GO TO 4950-END-RECORDS.
 20852
 20853     IF PB-BATCH-TRAILER
 20854        GO TO 4905-READ-PREV-RECORD.
 20855
 20856     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 20857
 20858     IF  WS-BATCH-PREFIX = '#CL'
 20859         GO TO 4905-READ-PREV-RECORD.
 20860
 20861     IF PI-PB-CERT-NO NOT = LOW-VALUES
 20862        IF PI-PB-CERT-NO NOT = PB-CERT-NO
 20863           GO TO 4905-READ-PREV-RECORD
 20864        ELSE
 20865           IF PI-PB-CERT-EFF-DT = LOW-VALUES
 20866              GO TO 4910-CHECK-REC-TYPE
 20867           ELSE
 20868              IF PI-PB-CERT-EFF-DT = PB-CERT-EFF-DT
 20869                 GO TO 4910-CHECK-REC-TYPE
 20870              ELSE
 20871                 GO TO 4905-READ-PREV-RECORD.
 20872
 20873     IF PI-PB-CERT-EFF-DT NOT = LOW-VALUES
 20874        IF PI-PB-CERT-EFF-DT NOT = PB-CERT-EFF-DT
 20875           GO TO 4905-READ-PREV-RECORD.
 20876
 20877 4910-CHECK-REC-TYPE.
 20878     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 20879         IF  PB-CARRIER = PI-CARRIER-SECURITY
 20880             NEXT SENTENCE
 20881         ELSE
 20882             GO TO 4905-READ-PREV-RECORD.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 384
* EL6311.cbl
 20883
 20884     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 20885         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 20886             NEXT SENTENCE
 20887        ELSE
 20888             GO TO 4905-READ-PREV-RECORD.
 20889
 20890     IF NOT DISPLAY-CHANGE-RECORDS AND
 20891            PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 20892        GO TO 4905-READ-PREV-RECORD.
 20893
 20894     IF DISPLAY-HOLD-RECORDS AND
 20895        NOT PB-RECORD-ON-HOLD
 20896          GO TO 4905-READ-PREV-RECORD.
 20897
 20898     IF PB-ISSUE
 20899        IF DISPLAY-CHK-REQ-RECORDS
 20900           GO TO 4905-READ-PREV-RECORD.
 20901
 20902     IF PB-ISSUE
 20903        IF ISSUE-WITH-WARNING
 20904           IF PB-WARNING-ERRORS
 20905              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20906                  GO TO 4505-READ-PREV-RECORD
 20907              ELSE
 20908                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20909                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20910                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20911                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20912                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20913                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20914                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20915                 GO TO 7000-DISPLAY-ISSUES
 20916           ELSE
 20917              GO TO 4905-READ-PREV-RECORD.
 20918
 20919     IF PB-ISSUE
 20920        IF (ISSUES-IN-ERROR AND
 20921            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20922            ALL-ISSUES
 20923            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20924            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20925            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20926            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20927            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20928            MOVE PB-SV-STATE            TO PI-SV-STATE
 20929            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20930            GO TO 7000-DISPLAY-ISSUES
 20931        ELSE
 20932            GO TO 4905-READ-PREV-RECORD.
 20933
 20934     IF PB-CANCELLATION
 20935        IF DISPLAY-CHK-REQ-RECORDS
 20936           IF PB-C-REFUND-REQUESTED
 20937              MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20938              MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20939              MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20940              MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 385
* EL6311.cbl
 20941              MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20942              MOVE PB-SV-STATE            TO PI-SV-STATE
 20943              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20944              GO TO 7100-DISPLAY-CANCELS
 20945           ELSE
 20946              GO TO 4905-READ-PREV-RECORD.
 20947
 20948     IF PB-CANCELLATION
 20949        IF CANCEL-WITH-WARNING
 20950           IF PB-WARNING-ERRORS
 20951              IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)
 20952                  GO TO 4505-READ-PREV-RECORD
 20953              ELSE
 20954                 MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20955                 MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20956                 MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20957                 MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20958                 MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20959                 MOVE PB-SV-STATE            TO PI-SV-STATE
 20960                 MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20961                 GO TO 7100-DISPLAY-CANCELS
 20962           ELSE
 20963              GO TO 4905-READ-PREV-RECORD.
 20964
 20965     IF PB-CANCELLATION
 20966        IF (CANCEL-IN-ERROR  AND
 20967            (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS)) OR
 20968            ALL-CANCELS
 20969            MOVE PB-CONTROL-BY-CSR      TO PI-PREV-CSR-KEY
 20970            MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY
 20971            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 20972            MOVE PB-SV-CARRIER          TO PI-SV-CARRIER
 20973            MOVE PB-SV-GROUPING         TO PI-SV-GROUPING
 20974            MOVE PB-SV-STATE            TO PI-SV-STATE
 20975            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 20976            GO TO 7100-DISPLAY-CANCELS.
 20977
 20978     GO TO 4905-READ-PREV-RECORD.
 20979
 20980 4950-END-RECORDS.
 20981     IF PI-MAP-NAME = EL631B
 20982        MOVE -1                  TO BMAINTL
 20983     ELSE
 20984        IF PI-MAP-NAME = EL631C
 20985           MOVE -1               TO CMAINTL
 20986        ELSE
 20987           MOVE -1               TO DPFENTRL.
 20988
 20989     MOVE ER-2255               TO EMI-ERROR.
 20990     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 20991     GO TO 8200-SEND-DATAONLY.
 20992
 20993 4970-NOT-FOUND.
 20994
 20995******************************************************************
 20996*      CONDITION MAY OCCUR IF PREV. RECORD HAS BEEN DELETED.     *
 20997******************************************************************
 20998
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 386
* EL6311.cbl
 20999
 21000* EXEC CICS RESETBR
 21001*         DATASET    (FILE-ID-ERPNDB4)
 21002*         RIDFLD     (ERPNDB-CSR-KEY)
 21003*    END-EXEC.
 21004     MOVE 0
 21005       TO DFHEIV11
 21006*    MOVE '&4         G          &   #00017819' TO DFHEIV0
 21007     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 21008     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21009     MOVE X'2020233030303137383139' TO DFHEIV0(25:11)
 21010     CALL 'kxdfhei1' USING DFHEIV0,
 21011           FILE-ID-ERPNDB4,
 21012           ERPNDB-CSR-KEY,
 21013           DFHEIV99,
 21014           DFHEIV11,
 21015           DFHEIV99
 21016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21017
 21018
 21019
 21020* EXEC CICS READNEXT
 21021*         DATASET    (FILE-ID-ERPNDB4)
 21022*         SET        (ADDRESS OF PENDING-BUSINESS)
 21023*         RIDFLD     (ERPNDB-CSR-KEY)
 21024*    END-EXEC.
 21025     MOVE 0
 21026       TO DFHEIV11
 21027*    MOVE '&.S                   )   #00017824' TO DFHEIV0
 21028     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21029     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21030     MOVE X'2020233030303137383234' TO DFHEIV0(25:11)
 21031     CALL 'kxdfhei1' USING DFHEIV0,
 21032           FILE-ID-ERPNDB4,
 21033           DFHEIV20,
 21034           DFHEIV99,
 21035           ERPNDB-CSR-KEY,
 21036           DFHEIV99,
 21037           DFHEIV11,
 21038           DFHEIV99,
 21039           DFHEIV99
 21040     SET ADDRESS OF PENDING-BUSINESS TO
 21041         DFHEIV20
 21042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21043
 21044
 21045
 21046* EXEC CICS READPREV
 21047*         DATASET    (FILE-ID-ERPNDB4)
 21048*         SET        (ADDRESS OF PENDING-BUSINESS)
 21049*         RIDFLD     (ERPNDB-CSR-KEY)
 21050*    END-EXEC.
 21051     MOVE 0
 21052       TO DFHEIV11
 21053*    MOVE '&0S                   )   #00017830' TO DFHEIV0
 21054     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21055     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21056     MOVE X'2020233030303137383330' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 387
* EL6311.cbl
 21057     CALL 'kxdfhei1' USING DFHEIV0,
 21058           FILE-ID-ERPNDB4,
 21059           DFHEIV20,
 21060           DFHEIV99,
 21061           ERPNDB-CSR-KEY,
 21062           DFHEIV99,
 21063           DFHEIV11,
 21064           DFHEIV99,
 21065           DFHEIV99
 21066     SET ADDRESS OF PENDING-BUSINESS TO
 21067         DFHEIV20
 21068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21069
 21070
 21071 4980-READ-PREV-RECORD.
 21072
 21073* EXEC CICS READPREV
 21074*         DATASET    (FILE-ID-ERPNDB4)
 21075*         SET        (ADDRESS OF PENDING-BUSINESS)
 21076*         RIDFLD     (ERPNDB-CSR-KEY)
 21077*    END-EXEC.
 21078     MOVE 0
 21079       TO DFHEIV11
 21080*    MOVE '&0S                   )   #00017837' TO DFHEIV0
 21081     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21082     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21083     MOVE X'2020233030303137383337' TO DFHEIV0(25:11)
 21084     CALL 'kxdfhei1' USING DFHEIV0,
 21085           FILE-ID-ERPNDB4,
 21086           DFHEIV20,
 21087           DFHEIV99,
 21088           ERPNDB-CSR-KEY,
 21089           DFHEIV99,
 21090           DFHEIV11,
 21091           DFHEIV99,
 21092           DFHEIV99
 21093     SET ADDRESS OF PENDING-BUSINESS TO
 21094         DFHEIV20
 21095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21096
 21097
 21098     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21099
 21100     IF WS-BATCH-PREFIX = '#CL'
 21101        GO TO 4980-READ-PREV-RECORD.
 21102
 21103     MOVE SPACE                  TO WS-FIRST-TIME-SW.
 21104     GO TO 4905-READ-PREV-RECORD.
 21105
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 388
* EL6311.cbl
 21107
 21108
 21109******************************************************************
 21110*                                                                *
 21111*        B R O W S E   B A T C H   H E A D E R S                 *
 21112*                                                                *
 21113******************************************************************
 21114
 21115 5000-BROWSE-BATCH-HEADERS.
 21116
 21117     IF EIBTRNID NOT = TRANS-EXB1
 21118        MOVE PI-ERPNDB-KEY       TO ERPNDB-KEY
 21119        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21120        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21121        GO TO 5010-READ-NEXT-RECORD.
 21122
 21123     IF EIBAID = DFHPF4
 21124        MOVE '0'                TO PI-EDIT-SW
 21125        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 21126        MOVE +9999               TO ERPNDB-BATCH-SEQ-NO
 21127        MOVE ZEROS               TO ERPNDB-BATCH-CHG-SEQ-NO
 21128        GO TO 5010-READ-NEXT-RECORD.
 21129
 21130     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21131     MOVE HIGH-VALUES            TO ERPNDB-BATCH-SEQ-ALPHA.
 21132     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21133
 21134
 21135* EXEC CICS HANDLE CONDITION
 21136*         ENDFILE  (5050-NOT-FOUND)
 21137*    END-EXEC.
 21138*    MOVE '"$''                   ! R #00017879' TO DFHEIV0
 21139     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 21140     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21141     MOVE X'5220233030303137383739' TO DFHEIV0(25:11)
 21142     CALL 'kxdfhei1' USING DFHEIV0
 21143     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21144
 21145
 21146 5010-READ-NEXT-RECORD.
 21147
 21148* EXEC CICS HANDLE CONDITION
 21149*         NOTFND    (5050-NOT-FOUND)
 21150*    END-EXEC.
 21151*    MOVE '"$I                   ! S #00017884' TO DFHEIV0
 21152     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21154     MOVE X'5320233030303137383834' TO DFHEIV0(25:11)
 21155     CALL 'kxdfhei1' USING DFHEIV0
 21156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21157
 21158
 21159
 21160* EXEC CICS READ
 21161*         DATASET   (FILE-ID-ERPNDB)
 21162*         SET       (ADDRESS OF PENDING-BUSINESS)
 21163*         RIDFLD    (ERPNDB-KEY)
 21164*         GTEQ
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 389
* EL6311.cbl
 21165*    END-EXEC.
 21166*    MOVE '&"S        G          (   #00017888' TO DFHEIV0
 21167     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21168     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21169     MOVE X'2020233030303137383838' TO DFHEIV0(25:11)
 21170     CALL 'kxdfhei1' USING DFHEIV0,
 21171           FILE-ID-ERPNDB,
 21172           DFHEIV20,
 21173           DFHEIV99,
 21174           ERPNDB-KEY,
 21175           DFHEIV99,
 21176           DFHEIV99,
 21177           DFHEIV99
 21178     SET ADDRESS OF PENDING-BUSINESS TO
 21179         DFHEIV20
 21180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21181
 21182
 21183     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
 21184         GO TO 5050-NOT-FOUND.
 21185
 21186     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21187
 21188     IF WS-BATCH-PREFIX = '#CL'
 21189         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21190         MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
 21191         GO TO 5010-READ-NEXT-RECORD.
 21192
 21193     IF NOT PB-BATCH-TRAILER
 21194         MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21195         MOVE +9999            TO ERPNDB-BATCH-SEQ-NO
 21196         GO TO 5010-READ-NEXT-RECORD.
 21197
 21198     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21199         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21200             NEXT SENTENCE
 21201         ELSE
 21202             MOVE PB-ENTRY-BATCH     TO ERPNDB-ENTRY-BATCH
 21203             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21204             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21205             GO TO 5010-READ-NEXT-RECORD.
 21206
 21207     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21208         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21209             NEXT SENTENCE
 21210        ELSE
 21211             MOVE HIGH-VALUES        TO ERPNDB-BATCH-SEQ-ALPHA
 21212             MOVE ZEROS              TO ERPNDB-BATCH-CHG-SEQ-NO
 21213             GO TO 5010-READ-NEXT-RECORD.
 21214
 21215     IF EIBAID = DFHPF4
 21216        MOVE '0'                TO PI-EDIT-SW
 21217        GO TO 7200-DISPLAY-BATCHES.
 21218
 21219     IF PI-CSR-BROWSE
 21220        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21221           MOVE PB-ENTRY-BATCH   TO ERPNDB-ENTRY-BATCH
 21222           MOVE HIGH-VALUES      TO ERPNDB-BATCH-SEQ-ALPHA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 390
* EL6311.cbl
 21223           GO TO 5010-READ-NEXT-RECORD.
 21224
 21225     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21226       IF PI-PB-CARRIER    = SPACES AND
 21227          PI-PB-GROUPING   = SPACES AND
 21228          PI-PB-STATE      = SPACES AND
 21229          PI-PB-ACCOUNT    = SPACES
 21230            MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY
 21231            MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21232            GO TO 7200-DISPLAY-BATCHES
 21233         ELSE
 21234           IF PI-PB-CARRIER    = PB-CARRIER  AND
 21235              PI-PB-GROUPING   = PB-GROUPING AND
 21236              PI-PB-STATE      = PB-STATE    AND
 21237              PI-PB-ACCOUNT    = PB-ACCOUNT
 21238              MOVE PB-CONTROL-PRIMARY  TO PI-PREV-KEY
 21239              MOVE 'Y' TO WS-PB-RECORDS-FOUND-SW
 21240              GO TO 7200-DISPLAY-BATCHES.
 21241
 21242     MOVE PB-CONTROL-PRIMARY        TO ERPNDB-KEY.
 21243     MOVE HIGH-VALUE                TO ERPNDB-BATCH-SEQ-ALPHA.
 21244
 21245
 21246* EXEC CICS HANDLE CONDITION
 21247*         NOTFND    (5050-NOT-FOUND)
 21248*    END-EXEC.
 21249*    MOVE '"$I                   ! T #00017957' TO DFHEIV0
 21250     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 21251     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21252     MOVE X'5420233030303137393537' TO DFHEIV0(25:11)
 21253     CALL 'kxdfhei1' USING DFHEIV0
 21254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21255
 21256
 21257
 21258* EXEC CICS READ
 21259*         DATASET   (FILE-ID-ERPNDB)
 21260*         SET       (ADDRESS OF PENDING-BUSINESS)
 21261*         RIDFLD    (ERPNDB-KEY)
 21262*         GTEQ
 21263*    END-EXEC.
 21264*    MOVE '&"S        G          (   #00017961' TO DFHEIV0
 21265     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 21266     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21267     MOVE X'2020233030303137393631' TO DFHEIV0(25:11)
 21268     CALL 'kxdfhei1' USING DFHEIV0,
 21269           FILE-ID-ERPNDB,
 21270           DFHEIV20,
 21271           DFHEIV99,
 21272           ERPNDB-KEY,
 21273           DFHEIV99,
 21274           DFHEIV99,
 21275           DFHEIV99
 21276     SET ADDRESS OF PENDING-BUSINESS TO
 21277         DFHEIV20
 21278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21279
 21280
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 391
* EL6311.cbl
 21281     GO TO 5010-READ-NEXT-RECORD.
 21282
 21283 5050-NOT-FOUND.
 21284
 21285******************************************************************
 21286*                                                                *
 21287*         IF THERE ARE NO PENDING BUS. RECORDS FOUND DURING      *
 21288*         THE INITIAL ENTRY OF EL6311, RETURN TO THE CALLING     *
 21289*         PROGRAM.                                               *
 21290*                                                                *
 21291******************************************************************
 21292
 21293     IF EIBTRNID NOT = TRANS-EXB1
 21294        IF PENDING-BUS-RECS-FOUND
 21295            NEXT SENTENCE
 21296          ELSE
 21297            MOVE '9'            TO PI-BROWSE-SW
 21298            GO TO 9400-CLEAR.
 21299
 21300     MOVE ER-2256                TO EMI-ERROR.
 21301     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21302
 21303     IF PI-MAP-NAME = SPACES
 21304        MOVE EL631D              TO PI-MAP-NAME
 21305        MOVE -1                  TO DPFENTRL
 21306        GO TO 8100-SEND-INITIAL-MAP.
 21307
 21308     IF PI-MAP-NAME = EL631B
 21309        MOVE -1                  TO BMAINTL
 21310     ELSE
 21311        IF PI-MAP-NAME = EL631C
 21312           MOVE -1               TO CMAINTL
 21313        ELSE
 21314           MOVE -1               TO DPFENTRL
 21315           GO TO 8200-SEND-DATAONLY.
 21316
 21317     GO TO 8100-SEND-INITIAL-MAP.
 21318
 21319     .
 21320 5100-PROCESS-POL-RESC.
 21321     MOVE ZEROS                  TO CG-LF-BENCD
 21322                                    CG-AH-BENCD
 21323                                    CG-LF-CAN-AMT
 21324                                    CG-AH-CAN-AMT
 21325     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21326                                    CG-AH-CAN-DT
 21327     MOVE SPACES                 TO CG-BATCH-NO
 21328     MOVE '4'                    TO CG-OPTION-CODE
 21329     MOVE PI-COMPANY-ID          TO CG-COMPANY-ID
 21330     MOVE PI-PROCESSOR-ID        TO CG-PROC-ID
 21331     MOVE PI-CR-MONTH-END-DT     TO CG-MONTH-END-DT
 21332     MOVE PI-COMPANY-CD          TO CG-CERT-COMPANY-CD
 21333     MOVE PI-SV-CARRIER          TO CG-CERT-CARRIER
 21334     MOVE PI-SV-GROUPING         TO CG-CERT-GROUP
 21335     MOVE PI-SV-STATE            TO CG-CERT-STATE
 21336     MOVE PI-PB-ACCOUNT          TO CG-CERT-ACCOUNT
 21337     MOVE PI-PB-CERT-EFF-DT      TO CG-CERT-EFF-DT
 21338     MOVE PI-PB-CERT-NO          TO CG-CERT-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 392
* EL6311.cbl
 21339     MOVE PI-PREV-ALT-KEY (1:33)
 21340                                 TO CG-CERT-KEY
 21341     MOVE WS-CURRENT-BIN-DT      TO CG-CURRENT-DT
 21342     MOVE ZEROS                  TO CG-LF-CAN-AMT
 21343                                    CG-AH-CAN-AMT
 21344     MOVE LOW-VALUES             TO CG-LF-CAN-DT
 21345                                    CG-AH-CAN-DT
 21346     MOVE PI-PREV-BATCH          TO CG-BATCH-NO
 21347     MOVE ZERO                   TO CG-BATCH-SEQ-NO
 21348      display 'about to cancel ' cg-cert-key
 21349
 21350* EXEC CICS LINK
 21351*        PROGRAM  ('ELCANC')
 21352*        COMMAREA (CANCEL-GEN-PASS-AREA)
 21353*    END-EXEC
 21354     MOVE LENGTH OF
 21355      CANCEL-GEN-PASS-AREA
 21356       TO DFHEIV11
 21357     MOVE 'ELCANC' TO DFHEIV1
 21358*    MOVE '."C                   (   #00018036' TO DFHEIV0
 21359     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 21360     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21361     MOVE X'2020233030303138303336' TO DFHEIV0(25:11)
 21362     CALL 'kxdfhei1' USING DFHEIV0,
 21363           DFHEIV1,
 21364           CANCEL-GEN-PASS-AREA,
 21365           DFHEIV11,
 21366           DFHEIV99,
 21367           DFHEIV99,
 21368           DFHEIV99,
 21369           DFHEIV99
 21370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21371     IF CG-SUCCESS
 21372        CONTINUE
 21373     ELSE
 21374        MOVE SPACES              TO EMI-MESSAGE-AREA (1)
 21375        MOVE '3'                 TO EMI-SWITCH1
 21376        MOVE CG-ERROR-CODE TO EMI-TEXT-VARIABLE (1)
 21377        EVALUATE TRUE
 21378           WHEN CG-DATE-ERROR
 21379             MOVE WS-01-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21380           WHEN CG-CERT-NOT-FOUND
 21381             MOVE WS-02-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21382           WHEN CG-AMOUNT-ERROR
 21383             MOVE WS-04-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21384           WHEN CG-OPTION-ERROR
 21385             MOVE WS-05-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21386           WHEN CG-PREV-CAN
 21387             MOVE WS-06-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21388           WHEN CG-INVALID-DATA
 21389             MOVE WS-07-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21390           WHEN CG-NO-ACCT-MSTR
 21391             MOVE WS-08-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21392           WHEN CG-SFX-A-EXIST
 21393             MOVE WS-09-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21394           WHEN CG-MISC-ERROR
 21395             MOVE WS-99-CANCEL-ERR TO EMI-ERROR-TEXT (1) (12:25)
 21396           WHEN OTHER
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 393
* EL6311.cbl
 21397             MOVE ' ERROR - ELCANC - RETURN '
 21398                                 TO EMI-ERROR-TEXT (1) (12:25)
 21399        END-EVALUATE
 21400        GO TO 8200-SEND-DATAONLY
 21401     END-IF
 21402     .
 21403 5100-EXIT.
 21404     EXIT.
 21405
 21406******************************************************************
 21407*                                                                *
 21408*        B R O W S E   B A T C H   B A C K W A R D S             *
 21409*                                                                *
 21410******************************************************************
 21411
 21412 5500-BROWSE-BATCH-BACKWARD.
 21413
 21414* EXEC CICS HANDLE CONDITION
 21415*         NOTFND   (5550-END-RECORDS)
 21416*         ENDFILE  (5550-END-RECORDS)
 21417*    END-EXEC.
 21418*    MOVE '"$I''                  ! U #00018082' TO DFHEIV0
 21419     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 21420     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21421     MOVE X'5520233030303138303832' TO DFHEIV0(25:11)
 21422     CALL 'kxdfhei1' USING DFHEIV0
 21423     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21424
 21425
 21426 5505-START-BROWSE.
 21427     MOVE PI-PREV-KEY            TO ERPNDB-KEY.
 21428     MOVE +1                     TO ERPNDB-BATCH-SEQ-NO.
 21429     MOVE ZEROS                  TO ERPNDB-BATCH-CHG-SEQ-NO.
 21430
 21431
 21432* EXEC CICS STARTBR
 21433*         DATASET   (FILE-ID-ERPNDB)
 21434*         RIDFLD    (ERPNDB-ALT-KEY)
 21435*    END-EXEC.
 21436     MOVE 0
 21437       TO DFHEIV11
 21438*    MOVE '&,         G          &   #00018092' TO DFHEIV0
 21439     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 21440     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 21441     MOVE X'2020233030303138303932' TO DFHEIV0(25:11)
 21442     CALL 'kxdfhei1' USING DFHEIV0,
 21443           FILE-ID-ERPNDB,
 21444           ERPNDB-ALT-KEY,
 21445           DFHEIV99,
 21446           DFHEIV11,
 21447           DFHEIV99
 21448     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21449
 21450
 21451     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 21452
 21453
 21454* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 394
* EL6311.cbl
 21455*         DATASET    (FILE-ID-ERPNDB)
 21456*         SET        (ADDRESS OF PENDING-BUSINESS)
 21457*         RIDFLD     (ERPNDB-KEY)
 21458*    END-EXEC.
 21459     MOVE 0
 21460       TO DFHEIV11
 21461*    MOVE '&.S                   )   #00018099' TO DFHEIV0
 21462     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 21463     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21464     MOVE X'2020233030303138303939' TO DFHEIV0(25:11)
 21465     CALL 'kxdfhei1' USING DFHEIV0,
 21466           FILE-ID-ERPNDB,
 21467           DFHEIV20,
 21468           DFHEIV99,
 21469           ERPNDB-KEY,
 21470           DFHEIV99,
 21471           DFHEIV11,
 21472           DFHEIV99,
 21473           DFHEIV99
 21474     SET ADDRESS OF PENDING-BUSINESS TO
 21475         DFHEIV20
 21476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21477
 21478
 21479
 21480* EXEC CICS READPREV
 21481*         DATASET    (FILE-ID-ERPNDB)
 21482*         SET        (ADDRESS OF PENDING-BUSINESS)
 21483*         RIDFLD     (ERPNDB-KEY)
 21484*    END-EXEC.
 21485     MOVE 0
 21486       TO DFHEIV11
 21487*    MOVE '&0S                   )   #00018105' TO DFHEIV0
 21488     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21489     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21490     MOVE X'2020233030303138313035' TO DFHEIV0(25:11)
 21491     CALL 'kxdfhei1' USING DFHEIV0,
 21492           FILE-ID-ERPNDB,
 21493           DFHEIV20,
 21494           DFHEIV99,
 21495           ERPNDB-KEY,
 21496           DFHEIV99,
 21497           DFHEIV11,
 21498           DFHEIV99,
 21499           DFHEIV99
 21500     SET ADDRESS OF PENDING-BUSINESS TO
 21501         DFHEIV20
 21502     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21503
 21504
 21505
 21506* EXEC CICS READPREV
 21507*         DATASET    (FILE-ID-ERPNDB)
 21508*         SET        (ADDRESS OF PENDING-BUSINESS)
 21509*         RIDFLD     (ERPNDB-KEY)
 21510*    END-EXEC.
 21511     MOVE 0
 21512       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 395
* EL6311.cbl
 21513*    MOVE '&0S                   )   #00018111' TO DFHEIV0
 21514     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
 21515     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 21516     MOVE X'2020233030303138313131' TO DFHEIV0(25:11)
 21517     CALL 'kxdfhei1' USING DFHEIV0,
 21518           FILE-ID-ERPNDB,
 21519           DFHEIV20,
 21520           DFHEIV99,
 21521           ERPNDB-KEY,
 21522           DFHEIV99,
 21523           DFHEIV11,
 21524           DFHEIV99,
 21525           DFHEIV99
 21526     SET ADDRESS OF PENDING-BUSINESS TO
 21527         DFHEIV20
 21528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21529
 21530
 21531     IF PB-COMPANY-CD-A1 NOT = PI-COMPANY-CD
 21532        GO TO 5550-END-RECORDS.
 21533
 21534     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 21535
 21536     MOVE PB-ENTRY-BATCH         TO WS-BATCH-NO.
 21537
 21538     IF  WS-BATCH-PREFIX = '#CL'
 21539             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21540
 21541* EXEC CICS ENDBR
 21542*                 DATASET  (FILE-ID-ERPNDB)
 21543*            END-EXEC
 21544     MOVE 0
 21545       TO DFHEIV11
 21546*    MOVE '&2                    $   #00018126' TO DFHEIV0
 21547     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21548     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21549     MOVE X'2020233030303138313236' TO DFHEIV0(25:11)
 21550     CALL 'kxdfhei1' USING DFHEIV0,
 21551           FILE-ID-ERPNDB,
 21552           DFHEIV11,
 21553           DFHEIV99
 21554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21555         GO TO 5505-START-BROWSE.
 21556
 21557     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
 21558         IF  PB-CARRIER = PI-CARRIER-SECURITY
 21559             NEXT SENTENCE
 21560         ELSE
 21561             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21562
 21563* EXEC CICS ENDBR
 21564*                 DATASET  (FILE-ID-ERPNDB)
 21565*            END-EXEC
 21566     MOVE 0
 21567       TO DFHEIV11
 21568*    MOVE '&2                    $   #00018136' TO DFHEIV0
 21569     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21570     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 396
* EL6311.cbl
 21571     MOVE X'2020233030303138313336' TO DFHEIV0(25:11)
 21572     CALL 'kxdfhei1' USING DFHEIV0,
 21573           FILE-ID-ERPNDB,
 21574           DFHEIV11,
 21575           DFHEIV99
 21576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21577             GO TO 5505-START-BROWSE.
 21578
 21579
 21580     IF  PI-ACCOUNT-SECURITY GREATER THAN SPACES
 21581         IF  PB-ACCOUNT = PI-ACCOUNT-SECURITY
 21582             NEXT SENTENCE
 21583        ELSE
 21584             MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21585
 21586* EXEC CICS ENDBR
 21587*                 DATASET  (FILE-ID-ERPNDB)
 21588*            END-EXEC
 21589     MOVE 0
 21590       TO DFHEIV11
 21591*    MOVE '&2                    $   #00018147' TO DFHEIV0
 21592     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21593     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21594     MOVE X'2020233030303138313437' TO DFHEIV0(25:11)
 21595     CALL 'kxdfhei1' USING DFHEIV0,
 21596           FILE-ID-ERPNDB,
 21597           DFHEIV11,
 21598           DFHEIV99
 21599     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21600             GO TO 5505-START-BROWSE.
 21601
 21602     IF NOT PB-BATCH-TRAILER
 21603        MOVE SPACE               TO WS-BROWSE-STARTED-SW
 21604
 21605* EXEC CICS ENDBR
 21606*            DATASET  (FILE-ID-ERPNDB)
 21607*       END-EXEC
 21608     MOVE 0
 21609       TO DFHEIV11
 21610*    MOVE '&2                    $   #00018154' TO DFHEIV0
 21611     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21612     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21613     MOVE X'2020233030303138313534' TO DFHEIV0(25:11)
 21614     CALL 'kxdfhei1' USING DFHEIV0,
 21615           FILE-ID-ERPNDB,
 21616           DFHEIV11,
 21617           DFHEIV99
 21618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21619        GO TO 5505-START-BROWSE.
 21620
 21621     IF PI-CSR-BROWSE
 21622        IF PB-CSR-ID           NOT = PI-PB-CSR-ID
 21623           MOVE SPACE            TO WS-BROWSE-STARTED-SW
 21624
 21625* EXEC CICS ENDBR
 21626*               DATASET  (FILE-ID-ERPNDB)
 21627*          END-EXEC
 21628     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 397
* EL6311.cbl
 21629       TO DFHEIV11
 21630*    MOVE '&2                    $   #00018162' TO DFHEIV0
 21631     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21632     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21633     MOVE X'2020233030303138313632' TO DFHEIV0(25:11)
 21634     CALL 'kxdfhei1' USING DFHEIV0,
 21635           FILE-ID-ERPNDB,
 21636           DFHEIV11,
 21637           DFHEIV99
 21638     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21639           GO TO 5505-START-BROWSE.
 21640
 21641     IF ONLY-BATCH-HEADERS OR PB-OUT-OF-BAL
 21642        IF PI-PB-CARRIER    = SPACES AND
 21643           PI-PB-GROUPING   = SPACES AND
 21644           PI-PB-STATE      = SPACES AND
 21645           PI-PB-ACCOUNT    = SPACES
 21646             GO TO 7200-DISPLAY-BATCHES
 21647          ELSE
 21648            IF PI-PB-CARRIER    = PB-CARRIER  AND
 21649               PI-PB-GROUPING   = PB-GROUPING AND
 21650               PI-PB-STATE      = PB-STATE    AND
 21651               PI-PB-ACCOUNT    = PB-ACCOUNT
 21652                 GO TO 7200-DISPLAY-BATCHES.
 21653
 21654     MOVE SPACE                  TO WS-BROWSE-STARTED-SW.
 21655
 21656
 21657* EXEC CICS ENDBR
 21658*         DATASET  (FILE-ID-ERPNDB)
 21659*    END-EXEC.
 21660     MOVE 0
 21661       TO DFHEIV11
 21662*    MOVE '&2                    $   #00018182' TO DFHEIV0
 21663     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 21664     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21665     MOVE X'2020233030303138313832' TO DFHEIV0(25:11)
 21666     CALL 'kxdfhei1' USING DFHEIV0,
 21667           FILE-ID-ERPNDB,
 21668           DFHEIV11,
 21669           DFHEIV99
 21670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21671
 21672
 21673     GO TO 5505-START-BROWSE.
 21674
 21675 5550-END-RECORDS.
 21676     MOVE ER-2257                TO EMI-ERROR.
 21677     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21678     MOVE -1                     TO DPFENTRL.
 21679
 21680     GO TO 8200-SEND-DATAONLY.
 21681
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 398
* EL6311.cbl
 21683
 21684******************************************************************
 21685*                                                                *
 21686*        C R E A T E   T E M P O R A R Y   S T O R A G E         *
 21687*                                                                *
 21688******************************************************************
 21689
 21690 6000-CREATE-TEMP-STORAGE.
 21691
 21692
 21693* EXEC CICS HANDLE CONDITION
 21694*        QIDERR  (6050-QID-ERROR)
 21695*    END-EXEC.
 21696*    MOVE '"$N                   ! V #00018205' TO DFHEIV0
 21697     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21698     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21699     MOVE X'5620233030303138323035' TO DFHEIV0(25:11)
 21700     CALL 'kxdfhei1' USING DFHEIV0
 21701     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21702
 21703
 21704
 21705* EXEC CICS WRITEQ TS
 21706*        QUEUE    (QID)
 21707*        FROM     (PROGRAM-INTERFACE-BLOCK)
 21708*        LENGTH   (WS-COMM-LENGTH)
 21709*        ITEM     (W-ONE)
 21710*    END-EXEC.
 21711*    MOVE '*" I   L              ''   #00018209' TO DFHEIV0
 21712     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 21713     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21714     MOVE X'2020233030303138323039' TO DFHEIV0(25:11)
 21715     CALL 'kxdfhei1' USING DFHEIV0,
 21716           QID,
 21717           PROGRAM-INTERFACE-BLOCK,
 21718           WS-COMM-LENGTH,
 21719           W-ONE,
 21720           DFHEIV99,
 21721           DFHEIV99
 21722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21723
 21724
 21725 6000-EXIT.
 21726      EXIT.
 21727
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 399
* EL6311.cbl
 21729
 21730******************************************************************
 21731*                                                                *
 21732*        R E C O V E R   T E M P O R A R Y   S T O R A G E       *
 21733*                                                                *
 21734******************************************************************
 21735
 21736 6050-RECOVER-TEMP-STORAGE.
 21737     IF PGM-NAME = XCTL-EL6312
 21738        GO TO 6050-EXIT.
 21739
 21740     IF PGM-NAME = XCTL-EL6313
 21741        GO TO 6050-EXIT.
 21742
 21743     IF PGM-NAME = XCTL-EL6315
 21744         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6315-PASS-AREA
 21745     END-IF
 21746
 21747     IF PGM-NAME = XCTL-EL6316
 21748         MOVE PI-PROGRAM-WORK-AREA TO WS-EL6316-PASS-AREA
 21749     END-IF
 21750
 21751
 21752* EXEC CICS HANDLE CONDITION
 21753*        QIDERR  (6050-QID-ERROR)
 21754*    END-EXEC.
 21755*    MOVE '"$N                   ! W #00018242' TO DFHEIV0
 21756     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 21757     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 21758     MOVE X'5720233030303138323432' TO DFHEIV0(25:11)
 21759     CALL 'kxdfhei1' USING DFHEIV0
 21760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21761
 21762
 21763
 21764* EXEC CICS READQ TS
 21765*         QUEUE   (QID)
 21766*         INTO    (PROGRAM-INTERFACE-BLOCK)
 21767*         LENGTH  (WS-COMM-LENGTH)
 21768*         ITEM    (W-ONE)
 21769*     END-EXEC.
 21770*    MOVE '*$II   L              ''   #00018246' TO DFHEIV0
 21771     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 21772     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 21773     MOVE X'2020233030303138323436' TO DFHEIV0(25:11)
 21774     CALL 'kxdfhei1' USING DFHEIV0,
 21775           QID,
 21776           PROGRAM-INTERFACE-BLOCK,
 21777           WS-COMM-LENGTH,
 21778           W-ONE,
 21779           DFHEIV99,
 21780           DFHEIV99
 21781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21782
 21783
 21784 6050-DELETE-TEMP-STORAGE.
 21785
 21786
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 400
* EL6311.cbl
 21787* EXEC CICS DELETEQ TS
 21788*        QUEUE   (QID)
 21789*    END-EXEC.
 21790*    MOVE '*&                    #   #00018255' TO DFHEIV0
 21791     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 21792     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 21793     MOVE X'2020233030303138323535' TO DFHEIV0(25:11)
 21794     CALL 'kxdfhei1' USING DFHEIV0,
 21795           QID,
 21796           DFHEIV99
 21797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 21798
 21799
 21800     GO TO 6050-EXIT.
 21801
 21802 6050-QID-ERROR.
 21803     MOVE ER-0033                TO EMI-ERROR
 21804     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21805
 21806 6050-EXIT.
 21807      EXIT.
 21808
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 401
* EL6311.cbl
 21810
 21811******************************************************************
 21812*                                                                *
 21813*            T E R M   C O N V E R S I O N                       *
 21814*                                                                *
 21815******************************************************************
 21816
 21817 6100-TERM-CONVERSION.
 21818
 21819     IF PI-BPMTS = ZERO
 21820         GO TO 6199-EXIT.
 21821
 21822     IF PI-BMODE = ' ' OR 'M'
 21823         MOVE PI-BPMTS      TO WS-CALC-TERM-WHOLE
 21824         GO TO 6105-ROUND-TERM.
 21825
 21826     IF PI-BMODE = 'S'
 21827         COMPUTE WS-CALC-TERM = PI-BPMTS / 2
 21828         GO TO 6105-ROUND-TERM.
 21829
 21830     IF PI-BMODE = 'W'
 21831         COMPUTE WS-CALC-TERM = PI-BPMTS / 4.33333
 21832         GO TO 6105-ROUND-TERM.
 21833
 21834     IF PI-BMODE = 'B'
 21835         COMPUTE WS-CALC-TERM = PI-BPMTS / 2.16667
 21836         GO TO 6105-ROUND-TERM.
 21837
 21838     IF PI-BMODE = 'T'
 21839         COMPUTE WS-CALC-TERM = PI-BPMTS / 1.08334.
 21840
 21841 6105-ROUND-TERM.
 21842
 21843     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
 21844         ADD +1                  TO WS-CALC-TERM-WHOLE
 21845         MOVE ZEROS              TO WS-CALC-TERM-REMAIN.
 21846
 21847     IF PI-COMPANY-ID = CLIENT-CRI OR CLIENT-LGX
 21848         GO TO 6125-COMPUTE-TERM-BENEFIT.
 21849
 21850     IF BTERM-LEN (WS-SUB1) NOT GREATER THAN +0
 21851         MOVE WS-CALC-TERM-WHOLE   TO BTERMO      (WS-SUB1)
 21852                                      WS-BTERM    (WS-SUB1)
 21853         MOVE +3                   TO BTERM-LEN   (WS-SUB1).
 21854
 21855     IF BTERM-LEN (WS-SUB1) GREATER THAN +0
 21856         IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
 21857             MOVE -1               TO BMODEL
 21858             MOVE ER-2593          TO EMI-ERROR
 21859             MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
 21860             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 21861
 21862 6124-CHECK-BENEFIT.
 21863
 21864     IF BBEN-LEN (WS-SUB1) NOT GREATER THAN +0
 21865        GO TO 6126-COMPUTE-BENEFIT.
 21866
 21867     GO TO 6199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 402
* EL6311.cbl
 21868
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 403
* EL6311.cbl
 21870******************************************************************
 21871**         COMPUTE TERM AND BENEFIT
 21872******************************************************************
 21873 6125-COMPUTE-TERM-BENEFIT.
 21874
 21875     IF PI-BTYPE (WS-SUB1) = SPACES  OR
 21876        PI-BPMTAMT = ZERO
 21877         GO TO 6199-EXIT.
 21878
 21879     MOVE WS-CALC-TERM-WHOLE     TO  BTERMI    (WS-SUB1)
 21880                                     WS-BTERM  (WS-SUB1).
 21881     MOVE +3                     TO  BTERM-LEN (WS-SUB1).
 21882
 21883 6126-COMPUTE-BENEFIT.
 21884
 21885     IF PI-BMODE = 'M' OR  ' '
 21886         MOVE PI-BPMTAMT        TO  WS-BBEN (WS-SUB1).
 21887
 21888     IF PI-BMODE = 'W'
 21889         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 4.33333.
 21890
 21891     IF PI-BMODE = 'S'
 21892         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = PI-BPMTAMT * 2.
 21893
 21894     IF PI-BMODE = 'B'
 21895         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 2.16667.
 21896
 21897     IF PI-BMODE = 'T'
 21898         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = PI-BPMTAMT * 1.08334.
 21899
 21900     IF WS-SUB1 = +1
 21901        COMPUTE WS-BBEN (WS-SUB1) =
 21902                WS-BBEN (WS-SUB1) * WS-CALC-TERM.
 21903
 21904     MOVE WS-BBEN (WS-SUB1)           TO BBENO       (WS-SUB1).
 21905     MOVE +12                         TO BBEN-LEN    (WS-SUB1).
 21906     MOVE AL-UNNON                    TO BBEN-ATTRB  (WS-SUB1).
 21907
 21908 6199-EXIT.
 21909     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 404
* EL6311.cbl
 21911
 21912******************************************************************
 21913*                                                                *
 21914*             D I S P L A Y   I S S U E S                        *
 21915*                                                                *
 21916******************************************************************
 21917
 21918 6200-CREATE-VADS.
 21919     MOVE PI-PREV-KEY            TO PI-ERPNDB-KEY
 21920     MOVE  PI-PREV-CONTROL-PRIMARY TO ERPNDB-KEY
 21921     MOVE SPACES                 TO WS-PASS-VADS-REC
 21922
 21923* EXEC CICS GETMAIN
 21924*       SET      (ADDRESS OF PENDING-BUSINESS)
 21925*       LENGTH   (ERPNDB-RECORD-LENGTH)
 21926*       INITIMG  (GETMAIN-SPACE)
 21927*       RESP     (WS-RESPONSE)
 21928*    END-EXEC
 21929*    MOVE ',"IL                  $  N#00018381' TO DFHEIV0
 21930     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 21931     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 21932     MOVE X'204E233030303138333831' TO DFHEIV0(25:11)
 21933     CALL 'kxdfhei1' USING DFHEIV0,
 21934           DFHEIV20,
 21935           ERPNDB-RECORD-LENGTH,
 21936           GETMAIN-SPACE
 21937     SET ADDRESS OF PENDING-BUSINESS TO
 21938         DFHEIV20
 21939     MOVE EIBRESP  TO WS-RESPONSE
 21940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21941
 21942* EXEC CICS READ
 21943*       INTO    (PENDING-BUSINESS)
 21944*       DATASET (FILE-ID-ERPNDB)
 21945*       RIDFLD  (ERPNDB-KEY)
 21946*       RESP    (WS-RESPONSE)
 21947*    END-EXEC
 21948     MOVE LENGTH OF
 21949      PENDING-BUSINESS
 21950       TO DFHEIV11
 21951*    MOVE '&"IL       E          (  N#00018387' TO DFHEIV0
 21952     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 21953     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 21954     MOVE X'204E233030303138333837' TO DFHEIV0(25:11)
 21955     CALL 'kxdfhei1' USING DFHEIV0,
 21956           FILE-ID-ERPNDB,
 21957           PENDING-BUSINESS,
 21958           DFHEIV11,
 21959           ERPNDB-KEY,
 21960           DFHEIV99,
 21961           DFHEIV99,
 21962           DFHEIV99
 21963     MOVE EIBRESP  TO WS-RESPONSE
 21964     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 21965     IF RESP-NORMAL
 21966        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 21967        IF (RESP-NORMAL)
 21968           AND (PB-CONTROL-BY-ACCOUNT (1:20) =
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 405
* EL6311.cbl
 21969              AM-CONTROL-PRIMARY (1:20))
 21970           MOVE AM-NAME          TO VD-ACCOUNT-NAME
 21971        ELSE
 21972           MOVE 'ACCOUNT NOT FOUND'
 21973                                 TO VD-ACCOUNT-NAME
 21974        END-IF
 21975        MOVE FUNCTION LENGTH(VD-ACCOUNT-NAME)
 21976                                    TO M1
 21977        MOVE VD-ACCOUNT-NAME        TO WS-WORK-FIELD
 21978        PERFORM VARYING A2 FROM +1 BY +1 UNTIL
 21979           (A2 > M1)
 21980           OR (WS-WORK-FIELD (A2:1) = '*')
 21981           OR (WS-WORK-FIELD (A2:4) = ' DBA' OR ' AKA')
 21982           OR (WS-WORK-FIELD (A2:4) = '(DBA' OR '(AKA')
 21983        END-PERFORM
 21984        IF A2 > M1
 21985           CONTINUE
 21986        ELSE
 21987           MOVE WS-WORK-FIELD (1:A2 - 1)
 21988                                    TO VD-ACCOUNT-NAME
 21989        END-IF
 21990        MOVE PB-COMPANY-CD       TO VD-COMPANY-CD
 21991        MOVE PB-CARRIER          TO VD-CARRIER
 21992        MOVE PB-GROUPING         TO VD-GROUPING
 21993        MOVE PB-STATE            TO VD-STATE
 21994        MOVE PB-ACCOUNT          TO VD-ACCOUNT
 21995        MOVE PB-CERT-EFF-DT      TO VD-CERT-EFF-DT
 21996        MOVE PB-CERT-NO          TO VD-CERT-NO
 21997        MOVE PB-I-INSURED-LAST-NAME TO VD-INSURED-LAST-NAME
 21998        MOVE PB-I-INSURED-FIRST-NAME TO VD-INSURED-FIRST-NAME
 21999        MOVE PB-I-INSURED-MIDDLE-INIT TO VD-INSURED-MIDDLE-INIT
 22000        MOVE PB-I-JOINT-LAST-NAME TO VD-JOINT-LAST-NAME
 22001        MOVE PB-I-JOINT-FIRST-NAME TO VD-JOINT-FIRST-NAME
 22002        MOVE PB-I-JOINT-MIDDLE-INIT TO VD-JOINT-MIDDLE-INIT
 22003        MOVE PB-I-BENEFICIARY-NAME TO VD-BENEFICIARY-NAME
 22004        MOVE PB-ENTRY-BATCH      TO VD-ENTRY-BATCH
 22005        MOVE PB-CSR-ID           TO VD-CSR-ID
 22006        MOVE PB-I-LF-BENEFIT-CD  TO VD-LF-BENEFIT-CD
 22007        MOVE PB-I-LF-PREMIUM-AMT TO VD-LF-PREMIUM-AMT
 22008        MOVE PB-I-LF-BENEFIT-AMT TO VD-LF-BENEFIT-AMT
 22009        MOVE PB-I-LF-TERM        TO VD-LF-TERM
 22010        MOVE PB-I-LF-RATE        TO VD-LF-RATE
 22011        MOVE PB-I-AH-BENEFIT-CD  TO VD-AH-BENEFIT-CD
 22012        MOVE PB-I-AH-PREMIUM-AMT TO VD-AH-PREMIUM-AMT
 22013        MOVE PB-I-AH-BENEFIT-AMT TO VD-AH-BENEFIT-AMT
 22014        MOVE PB-I-AH-TERM        TO VD-AH-TERM
 22015        MOVE PB-I-AH-RATE        TO VD-AH-RATE
 22016        MOVE PB-I-LOAN-TERM      TO VD-LOAN-TERM
 22017        MOVE PB-I-LOAN-APR       TO VD-LOAN-APR
 22018        MOVE PB-I-1ST-PMT-DT     TO VD-1ST-PMT-DT
 22019     END-IF
 22020     MOVE PB-CONTROL-PRIMARY     TO  ERPNDM-KEY.
 22021
 22022
 22023* EXEC CICS GETMAIN
 22024*       SET      (ADDRESS OF PENDING-MAILING-DATA)
 22025*       LENGTH   (ERPNDM-RECORD-LENGTH)
 22026*       INITIMG  (GETMAIN-SPACE)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 406
* EL6311.cbl
 22027*       RESP     (WS-RESPONSE)
 22028*    END-EXEC
 22029*    MOVE ',"IL                  $  N#00018450' TO DFHEIV0
 22030     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
 22031     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22032     MOVE X'204E233030303138343530' TO DFHEIV0(25:11)
 22033     CALL 'kxdfhei1' USING DFHEIV0,
 22034           DFHEIV20,
 22035           ERPNDM-RECORD-LENGTH,
 22036           GETMAIN-SPACE
 22037     SET ADDRESS OF PENDING-MAILING-DATA TO
 22038         DFHEIV20
 22039     MOVE EIBRESP  TO WS-RESPONSE
 22040     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22041
 22042
 22043* EXEC CICS READ
 22044*       INTO    (PENDING-MAILING-DATA)
 22045*       DATASET (FILE-ID-ERPNDM)
 22046*       RIDFLD  (ERPNDM-KEY)
 22047*       RESP    (WS-RESPONSE)
 22048*    END-EXEC
 22049     MOVE LENGTH OF
 22050      PENDING-MAILING-DATA
 22051       TO DFHEIV11
 22052*    MOVE '&"IL       E          (  N#00018457' TO DFHEIV0
 22053     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 22054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22055     MOVE X'204E233030303138343537' TO DFHEIV0(25:11)
 22056     CALL 'kxdfhei1' USING DFHEIV0,
 22057           FILE-ID-ERPNDM,
 22058           PENDING-MAILING-DATA,
 22059           DFHEIV11,
 22060           ERPNDM-KEY,
 22061           DFHEIV99,
 22062           DFHEIV99,
 22063           DFHEIV99
 22064     MOVE EIBRESP  TO WS-RESPONSE
 22065     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22066
 22067     IF RESP-NORMAL
 22068        MOVE PM-ADDRESS-LINE-1    TO VD-INSURED-ADDRESS-1
 22069        MOVE PM-ADDRESS-LINE-2    TO VD-INSURED-ADDRESS-2
 22070        MOVE PM-CITY              TO VD-INSURED-CITY
 22071        MOVE PM-STATE             TO VD-INSURED-STATE
 22072        MOVE PM-ZIP               TO VD-INSURED-ZIP-CODE
 22073     END-IF
 22074
 22075     MOVE 'VAC1'                  TO VD-LETTER-ID
 22076     MOVE PI-PROCESSOR-ID         TO VD-PROC-ID
 22077     MOVE PI-COMPANY-ID           TO VD-COMP-ID
 22078     MOVE EIBTIME                 TO VD-CURRENT-TIME
 22079     MOVE WS-CURRENT-BIN-DT       TO VD-CURRENT-DATE
 22080     MOVE +0                      TO VD-ARCHIVE-NO
 22081     MOVE VIRGINIA-DISCLOSURE     TO WS-PASS-VADS-REC
 22082     .
 22083 6200-EXIT.
 22084     EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 407
* EL6311.cbl
 22085 6210-READ-ERACCT.
 22086     MOVE PB-CONTROL-BY-ACCOUNT  TO ERACCT-KEY
 22087     MOVE LOW-VALUES             TO ERACCT-FILL
 22088
 22089* EXEC CICS READ
 22090*         DATASET   ('ERACCT')
 22091*         INTO      (ACCOUNT-MASTER)
 22092*         RIDFLD    (ERACCT-KEY)
 22093*         GTEQ
 22094*         RESP      (WS-RESPONSE)
 22095*    END-EXEC
 22096     MOVE LENGTH OF
 22097      ACCOUNT-MASTER
 22098       TO DFHEIV11
 22099     MOVE 'ERACCT' TO DFHEIV1
 22100*    MOVE '&"IL       G          (  N#00018485' TO DFHEIV0
 22101     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
 22102     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22103     MOVE X'204E233030303138343835' TO DFHEIV0(25:11)
 22104     CALL 'kxdfhei1' USING DFHEIV0,
 22105           DFHEIV1,
 22106           ACCOUNT-MASTER,
 22107           DFHEIV11,
 22108           ERACCT-KEY,
 22109           DFHEIV99,
 22110           DFHEIV99,
 22111           DFHEIV99
 22112     MOVE EIBRESP  TO WS-RESPONSE
 22113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22114     .
 22115 6210-EXIT.
 22116     EXIT.
 22117
 22118 6220-READ-ERMAIL.
 22119
 22120     MOVE ELCERT-KEY             TO ERMAIL-KEY
 22121     MOVE ' '                    TO WS-ERMAIL-SW
 22122
 22123
 22124* EXEC CICS READ
 22125*       DATASET   (FILE-ID-ERMAIL)
 22126*       SET       (ADDRESS OF MAILING-DATA)
 22127*       RIDFLD    (ERMAIL-KEY)
 22128*       RESP      (WS-RESPONSE)
 22129*    END-EXEC
 22130*    MOVE '&"S        E          (  N#00018501' TO DFHEIV0
 22131     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22132     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22133     MOVE X'204E233030303138353031' TO DFHEIV0(25:11)
 22134     CALL 'kxdfhei1' USING DFHEIV0,
 22135           FILE-ID-ERMAIL,
 22136           DFHEIV20,
 22137           DFHEIV99,
 22138           ERMAIL-KEY,
 22139           DFHEIV99,
 22140           DFHEIV99,
 22141           DFHEIV99
 22142     SET ADDRESS OF MAILING-DATA TO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 408
* EL6311.cbl
 22143         DFHEIV20
 22144     MOVE EIBRESP  TO WS-RESPONSE
 22145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22146
 22147     IF RESP-NORMAL
 22148        SET ERMAIL-FOUND TO TRUE
 22149     END-IF
 22150     .
 22151 6220-EXIT.
 22152     EXIT.
 22153
 22154 6400-CHECK-FOR-RES-REF-CLAIM.
 22155     display 'made it to 6400- for ' pi-cert-no
 22156     MOVE LOW-VALUES             TO PI-RES-REF-CLM-TYPE
 22157
 22158     MOVE PI-COMPANY-CD          TO MSTR-COMP-CD
 22159                                    W-CL-COMP-CD.
 22160     MOVE PI-CERT-NO             TO MSTR-CERT-NO
 22161                                    W-CL-CERT-NO.
 22162     MOVE SPACES                 TO MSTR-CERT-SFX.
 22163
 22164
 22165* EXEC CICS HANDLE CONDITION
 22166*        NOTFND  (6400-CONTINUE)
 22167*        ENDFILE (6400-CONTINUE)
 22168*    END-EXEC.
 22169*    MOVE '"$I''                  ! X #00018525' TO DFHEIV0
 22170     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
 22171     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22172     MOVE X'5820233030303138353235' TO DFHEIV0(25:11)
 22173     CALL 'kxdfhei1' USING DFHEIV0
 22174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22175
 22176
 22177
 22178* EXEC CICS IGNORE CONDITION
 22179*        DUPKEY
 22180*    END-EXEC.
 22181*    MOVE '"*$                   !   #00018530' TO DFHEIV0
 22182     MOVE X'222A24202020202020202020' TO DFHEIV0(1:12)
 22183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22184     MOVE X'2020233030303138353330' TO DFHEIV0(25:11)
 22185     CALL 'kxdfhei1' USING DFHEIV0
 22186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22187
 22188
 22189
 22190* EXEC CICS STARTBR
 22191*        DATASET   (CLMS-ID)
 22192*        RIDFLD    (ELMSTR-KEY)
 22193*        GENERIC   EQUAL
 22194*        KEYLENGTH (ELMSTR-LENGTH)
 22195*    END-EXEC.
 22196     MOVE 0
 22197       TO DFHEIV11
 22198*    MOVE '&,   KG    E          &   #00018534' TO DFHEIV0
 22199     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
 22200     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 409
* EL6311.cbl
 22201     MOVE X'2020233030303138353334' TO DFHEIV0(25:11)
 22202     CALL 'kxdfhei1' USING DFHEIV0,
 22203           CLMS-ID,
 22204           ELMSTR-KEY,
 22205           ELMSTR-LENGTH,
 22206           DFHEIV11,
 22207           DFHEIV99
 22208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22209
 22210
 22211     display 'browse started'
 22212     MOVE 'Y'                    TO WS-BROWSE-STARTED-SW.
 22213
 22214 6400-NEXT-CLAIM.
 22215
 22216
 22217* EXEC CICS READNEXT
 22218*        DATASET   (CLMS-ID)
 22219*        RIDFLD    (ELMSTR-KEY)
 22220*        SET       (ADDRESS OF CLAIM-MASTER)
 22221*    END-EXEC.
 22222     MOVE 0
 22223       TO DFHEIV11
 22224*    MOVE '&.S                   )   #00018546' TO DFHEIV0
 22225     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 22226     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 22227     MOVE X'2020233030303138353436' TO DFHEIV0(25:11)
 22228     CALL 'kxdfhei1' USING DFHEIV0,
 22229           CLMS-ID,
 22230           DFHEIV20,
 22231           DFHEIV99,
 22232           ELMSTR-KEY,
 22233           DFHEIV99,
 22234           DFHEIV11,
 22235           DFHEIV99,
 22236           DFHEIV99
 22237     SET ADDRESS OF CLAIM-MASTER TO
 22238         DFHEIV20
 22239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22240
 22241
 22242     display 'read claim for ' mstr-cert-no
 22243     IF MSTR-COMP-CD NOT = W-CL-COMP-CD  OR
 22244        MSTR-CERT-PRIME NOT = W-CL-CERT-PRIME
 22245         GO TO 6400-CONTINUE
 22246     END-IF.
 22247
 22248     IF PI-CARRIER     NOT = CL-CARRIER        OR
 22249        PI-GROUPING    NOT = CL-CERT-GROUPING  OR
 22250        PI-STATE       NOT = CL-CERT-STATE     OR
 22251        PI-ACCOUNT     NOT = CL-CERT-ACCOUNT   OR
 22252        PI-CERT-EFF-DT NOT = CL-CERT-EFF-DT
 22253         GO TO 6400-NEXT-CLAIM
 22254     END-IF.
 22255
 22256     display 'found claim ' cl-claim-no
 22257        ' with denial type ' cl-denial-type
 22258     IF CL-DENIAL-TYPE = '2' OR '3' OR '4'
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 410
* EL6311.cbl
 22259         MOVE CL-DENIAL-TYPE TO PI-RES-REF-CLM-TYPE
 22260         GO TO 6400-CONTINUE
 22261     END-IF.
 22262
 22263     GO TO 6400-NEXT-CLAIM.
 22264
 22265 6400-CONTINUE.
 22266
 22267     IF WS-BROWSE-STARTED-SW = 'Y'
 22268
 22269* EXEC CICS ENDBR
 22270*            DATASET   (CLMS-ID)
 22271*        END-EXEC
 22272     MOVE 0
 22273       TO DFHEIV11
 22274*    MOVE '&2                    $   #00018578' TO DFHEIV0
 22275     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 22276     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 22277     MOVE X'2020233030303138353738' TO DFHEIV0(25:11)
 22278     CALL 'kxdfhei1' USING DFHEIV0,
 22279           CLMS-ID,
 22280           DFHEIV11,
 22281           DFHEIV99
 22282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 22283         MOVE 'N' TO WS-BROWSE-STARTED-SW
 22284     END-IF.
 22285
 22286 6400-EXIT.
 22287     EXIT.
 22288
 22289 7000-DISPLAY-ISSUES.
 22290
 22291     IF PI-DISPLAY-ORIGINAL-BATCH
 22292        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22293        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22294     ELSE
 22295        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22296
 22297     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22298
 22299     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22300     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22301
 22302     MOVE LOW-VALUES                 TO EL631BI.
 22303     MOVE ZEROS                      TO PI-BPMTAMT
 22304                                        PI-BPMTS.
 22305     MOVE SPACE                      TO PI-BMODE
 22306                                        PI-BTYPE (1)
 22307                                        PI-BTYPE (2).
 22308     MOVE EL631B                     TO PI-MAP-NAME.
 22309     MOVE 'Y'                        TO PI-BROWSE-SW.
 22310     MOVE PB-BATCH-SEQ-NO            TO BSEQO
 22311                                        PI-HIGH-SEQ-NO.
 22312
 22313     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22314        MOVE AL-SABOF                TO BCHGTA
 22315        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING BCHGO
 22316        MOVE AL-SANON                TO BCHGA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 411
* EL6311.cbl
 22317     ELSE
 22318        MOVE AL-SADOF                TO BCHGTA
 22319                                        BCHGA
 22320        MOVE PB-CHG-COUNT            TO BCHGO.
 22321
 22322     MOVE PB-LAST-MAINT-BY           TO BMANTBYO.
 22323     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22324     MOVE WS-HR-MINS                 TO BMANTATO.
 22325
 22326     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22327        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22328        MOVE SPACE                   TO DC-OPTION-CODE
 22329        PERFORM 9700-DATE-LINK
 22330        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22331        MOVE 'INACTIVE'              TO BMOENDTO
 22332     ELSE
 22333        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22334        MOVE SPACE                   TO DC-OPTION-CODE
 22335        PERFORM 9700-DATE-LINK
 22336        MOVE DC-GREG-DATE-1-EDIT     TO BMANTDTO
 22337        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22338        MOVE SPACE                   TO DC-OPTION-CODE
 22339        PERFORM 9700-DATE-LINK
 22340        MOVE DC-GREG-DATE-1-EDIT     TO BMOENDTO.
 22341
 22342*    MOVE PB-I-REFERENCE             TO BREFO.
 22343
 22344*    IF PI-COMPANY-ID EQUAL 'HER'
 22345*        MOVE PB-I-MEMBER-NO     TO  WS-MEMBER-NO
 22346*        IF WS-MEMBER-NO-1-8  IS NUMERIC
 22347*            IF WS-MEMBER-NO-1-8  GREATER  ZEROS
 22348*                MOVE WS-MEMBER-NO-1-8
 22349*                                TO  BMICRNOO.
 22350
 22351*    IF PB-I-MICROFILM-NO  IS NUMERIC
 22352*        IF PB-I-MICROFILM-NO  GREATER  ZEROS
 22353*            MOVE PB-I-MICROFILM-NO
 22354*                                TO  BMICRNOO.
 22355     IF PB-I-VIN NOT = SPACES
 22356        MOVE PB-I-VIN            TO BVINO
 22357     END-IF
 22358
 22359     MOVE PB-CERT-PRIME              TO BCERTNOO.
 22360     MOVE PB-CERT-SFX                TO BSUFIXO.
 22361     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22362     MOVE SPACE                      TO DC-OPTION-CODE.
 22363     PERFORM 9700-DATE-LINK.
 22364     MOVE DC-GREG-DATE-1-EDIT        TO BEFFDTO
 22365
 22366     MOVE PB-I-INSURED-LAST-NAME     TO BLSTNMO.
 22367     MOVE PB-I-INSURED-FIRST-NAME    TO B1STNMO.
 22368     MOVE PB-I-INSURED-MIDDLE-INIT   TO BINITO.
 22369     MOVE PB-I-INSURED-SEX           TO BSEXO
 22370
 22371     IF PB-I-AGE NOT = ZEROS
 22372         MOVE PB-I-AGE               TO BAGEO.
 22373
 22374     MOVE PB-CONTROL-BY-ACCOUNT (1:33)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 412
* EL6311.cbl
 22375                                 TO ELCERT-KEY
 22376     PERFORM 1295-READ-CERT-TRAILER THRU 1295-EXIT
 22377     IF NOT CERT-TRL-REC-NOT-FOUND
 22378         IF CS-INS-AGE-DEFAULT-FLAG = 'Y'
 22379             MOVE 'AGE*'             TO BAGEDEFO
 22380         ELSE
 22381             MOVE 'AGE '             TO BAGEDEFO
 22382         END-IF
 22383     ELSE
 22384         MOVE 'AGE '             TO BAGEDEFO
 22385     END-IF
 22386
 22387     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 22388         MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1
 22389         MOVE SPACE                  TO DC-OPTION-CODE
 22390         PERFORM 9700-DATE-LINK
 22391         IF NO-CONVERSION-ERROR
 22392            MOVE DC-GREG-DATE-1-EDIT TO BBIRTHO.
 22393
 22394     IF PB-I-1ST-PMT-DT NOT = LOW-VALUES
 22395         MOVE PB-I-1ST-PMT-DT        TO DC-BIN-DATE-1
 22396         MOVE SPACE                  TO DC-OPTION-CODE
 22397         PERFORM 9700-DATE-LINK
 22398         IF NO-CONVERSION-ERROR
 22399            MOVE DC-GREG-DATE-1-EDIT TO B1STPMTO.
 22400
 22401     IF PB-I-EXTENTION-DAYS NUMERIC
 22402        IF PB-I-EXTENTION-DAYS GREATER THAN ZEROS
 22403           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 22404        ELSE
 22405           IF PB-I-TERM-IN-DAYS NUMERIC
 22406              IF PB-I-TERM-IN-DAYS GREATER THAN ZEROS
 22407                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 22408
 22409     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 22410        MOVE PB-I-LOAN-TERM          TO BLNTRMO.
 22411
 22412     MOVE PB-FORCE-CODE              TO BFORCEO.
 22413     MOVE PB-I-TERM-TYPE             TO BMODEO
 22414                                        PI-BMODE.
 22415
 22416     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 22417        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 22418
 22419     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 22420         MOVE PB-I-NO-OF-PAYMENTS    TO BPMTSO
 22421                                        PI-BPMTS.
 22422
 22423     IF PB-I-PAYMENT-AMOUNT NUMERIC
 22424         IF PB-I-PAYMENT-AMOUNT GREATER THAN ZEROS
 22425           MOVE PB-I-PAYMENT-AMOUNT  TO BPMTAMTO
 22426                                        PI-BPMTAMT.
 22427
 22428     MOVE PB-I-LOAN-OFFICER          TO BLNOFCRO.
 22429     MOVE PB-BATCH-ENTRY             TO BENTRYO.
 22430     MOVE PB-I-UNDERWRITING-STATUS   TO BUNWRITO.
 22431     MOVE PB-I-SKIP-CODE             TO BSKPCDO.
 22432     MOVE PB-I-INDV-GRP-CD           TO BINDGRPO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 413
* EL6311.cbl
 22433     MOVE PB-I-SIG-SW                TO BSIGO.
 22434     MOVE PB-I-RATE-CLASS-OVRD       TO BRTCLSO.
 22435     MOVE PB-I-SPECIAL-REIN-CODE     TO BREINO.
 22436     MOVE PB-RECORD-BILL             TO BBILCDO.
 22437     MOVE PB-FORCE-CODE              TO BFORCEO.
 22438
 22439     IF (PB-I-LIVES NUMERIC)
 22440        AND (PB-I-LIVES > ZEROS)
 22441        PERFORM 6210-READ-ERACCT THRU 6210-EXIT
 22442        IF (RESP-NORMAL)
 22443           AND (AM-DCC-PRODUCT-CODE = 'DDF')
 22444           CONTINUE
 22445        ELSE
 22446           MOVE PB-I-LIVES       TO BLIVESO
 22447        END-IF
 22448     END-IF
 22449
 22450     IF PB-I-NUM-BILLED NUMERIC AND
 22451        PB-I-NUM-BILLED GREATER THAN ZEROS
 22452        MOVE PB-I-NUM-BILLED         TO BBILLEDO.
 22453*    ELSE
 22454*       MOVE ZEROS                   TO BBILLEDO.
 22455
 22456     MOVE PB-CHG-COUNT               TO BCHGCNTO.
 22457
 22458     IF PB-I-LOAN-APR NOT = +99.9999
 22459        MOVE PB-I-LOAN-APR           TO BAPRO.
 22460
 22461     IF PB-I-MEMBER-NO  GREATER THAN SPACES
 22462        MOVE PB-I-MEMBER-NO          TO BMEMBERO.
 22463
 22464     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22465        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22466           MOVE AL-SANOF                TO BORIGHDA
 22467           MOVE PB-ORIGINAL-ENTRY-BATCH TO BORGNOO
 22468           MOVE PB-ORIGINAL-SEQ-NO      TO BORGSEQO.
 22469
 22470     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 22471
 22472     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 22473        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 22474
 22475     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 22476        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1)
 22477                                        PI-BTYPE (1).
 22478
 22479     IF PB-I-LF-TERM     GREATER THAN ZEROS
 22480        MOVE PB-I-LF-TERM            TO BTERMO (1).
 22481
 22482     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 22483        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO  (1).
 22484
 22485     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 22486        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO   (1).
 22487
 22488     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 22489        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO      (1).
 22490
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 414
* EL6311.cbl
 22491     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22492        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO  (1).
 22493
 22494     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 22495         MOVE PB-I-LF-EXPIRE-DT      TO DC-BIN-DATE-1
 22496         MOVE SPACE                  TO DC-OPTION-CODE
 22497         PERFORM 9700-DATE-LINK
 22498         IF NO-CONVERSION-ERROR
 22499            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE   (1).
 22500
 22501     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22502        MOVE PB-I-LF-BENEFIT-CD      TO BBEN-CD     (1)
 22503        MOVE PB-I-LF-ABBR            TO BBEN-ABBR   (1)
 22504        MOVE PB-I-LF-PREM-CALC       TO BCPREMO     (1)
 22505        SUBTRACT PB-I-LF-PREMIUM-AMT FROM PB-I-LF-PREM-CALC
 22506                 GIVING BDIFFO (1)
 22507     ELSE
 22508        MOVE SPACES                  TO BBEN-CD     (1)
 22509                                        BBEN-ABBR   (1).
 22510
 22511     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 22512        MOVE PB-I-LF-ALT-PREM-CALC   TO BCALT-PREM  (1)
 22513        SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
 22514                 PB-I-LF-ALT-PREM-CALC   GIVING BDALT-PREM (1).
 22515
 22516     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22517       IF PB-RECORD-ON-HOLD
 22518          MOVE 'ON HOLD'           TO BBILL-LIT     (1).
 22519
 22520     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22521       IF PB-RECORD-RETURNED
 22522          MOVE 'RETURNED'          TO BBILL-LIT     (1).
 22523
 22524     IF PB-I-LF-BENEFIT-CD NOT = ZEROS
 22525        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22526             MOVE 'OVERRIDE'          TO BBILL-LIT  (1).
 22527
 22528     MOVE PI-AH-OVERRIDE-L2          TO BKIND       (2).
 22529
 22530     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 22531        MOVE PB-I-AH-CRIT-PER        TO BCRIT-PERDO (2).
 22532
 22533     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 22534        MOVE PB-I-AH-INPUT-CD        TO BTYPE       (2)
 22535                                        PI-BTYPE (2).
 22536
 22537     IF PB-I-AH-TERM     GREATER THAN ZEROS
 22538        MOVE PB-I-AH-TERM            TO BTERMO      (2).
 22539
 22540     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 22541        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO       (2).
 22542
 22543     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 22544        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO      (2).
 22545
 22546     IF PB-I-TOT-FEES NOT NUMERIC
 22547        MOVE ZEROS               TO PB-I-TOT-FEES
 22548     END-IF
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 415
* EL6311.cbl
 22549     IF PB-I-TOT-FEES > ZEROS
 22550        MOVE PB-I-TOT-FEES       TO BALT-PREMO  (2).
 22551
 22552     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 22553         MOVE PB-I-AH-EXPIRE-DT      TO DC-BIN-DATE-1
 22554         MOVE SPACE                  TO DC-OPTION-CODE
 22555         PERFORM 9700-DATE-LINK
 22556         IF NO-CONVERSION-ERROR
 22557            MOVE DC-GREG-DATE-1-EDIT TO BEXPIRE       (2).
 22558
 22559     IF PB-I-TOT-FEES > ZEROS
 22560        MOVE PB-I-TOT-FEES-CALC      TO BCALT-PREM  (2)
 22561        SUBTRACT PB-I-TOT-FEES FROM
 22562                 PB-I-TOT-FEES-CALC GIVING BDALT-PREM (2).
 22563
 22564     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22565        MOVE PB-I-AH-BENEFIT-CD      TO BBEN-CD     (2)
 22566        MOVE PB-I-AH-ABBR            TO BBEN-ABBR   (2)
 22567        MOVE PB-I-AH-PREM-CALC       TO BCPREMO     (2)
 22568        SUBTRACT PB-I-AH-PREMIUM-AMT FROM PB-I-AH-PREM-CALC
 22569                 GIVING BDIFFO (2)
 22570     ELSE
 22571        MOVE SPACES                  TO BBEN-CD     (2)
 22572                                        BBEN-ABBR   (2).
 22573
 22574     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22575       IF PB-RECORD-ON-HOLD
 22576          MOVE 'ON HOLD'           TO BBILL-LIT     (2).
 22577
 22578     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22579       IF PB-RECORD-RETURNED
 22580          MOVE 'RETURNED'          TO BBILL-LIT     (2).
 22581
 22582     IF PB-I-AH-BENEFIT-CD NOT = ZEROS
 22583        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22584             MOVE 'OVERRIDE'          TO BBILL-LIT  (2).
 22585
 22586     MOVE PB-CSR-ID                  TO BCSRO.
 22587
 22588     IF PI-COMPANY-ID  =  'DMD'
 22589        IF (EC-NEW-CERT = SPACES OR LOW-VALUES)
 22590            NEXT SENTENCE
 22591        ELSE
 22592            IF (PB-CERT-NO  NOT =  EC-NEW-CERT)
 22593               MOVE 'NEW CERT'       TO BNCERTLI
 22594               MOVE EC-NEW-CERT      TO BNCERTO.
 22595
 22596     IF PI-COMPANY-ID  =  'DMD'
 22597        IF (EC-NEW-STATE = LOW-VALUES OR SPACES)
 22598            NEXT SENTENCE
 22599        ELSE
 22600           IF (PB-SV-STATE  NOT =  EC-NEW-STATE)
 22601               MOVE 'NEW STATE'      TO BNSTATLI
 22602               MOVE EC-NEW-STATE     TO BNSTATO.
 22603
 22604 7000-CONTINUE.
 22605     MOVE 'C'                        TO BMAINTI.
 22606     MOVE AL-UANON                   TO BMAINTA.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 416
* EL6311.cbl
 22607
 22608     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22609        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22610
 22611     IF PI-6315-FINALIZED = 'Y'   AND
 22612        PB-UNFORCED-ERRORS
 22613          MOVE -1                TO BFORCEL
 22614          MOVE  1                TO SET-CURSOR-SW
 22615     END-IF
 22616
 22617     IF NO-CURSOR-SET
 22618        MOVE -1                      TO BMAINTL.
 22619
 22620     GO TO 8100-SEND-INITIAL-MAP.
 22621
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 417
* EL6311.cbl
 22623
 22624******************************************************************
 22625*                                                                *
 22626*             D I S P L A Y   C A N C E L S                      *
 22627*                                                                *
 22628******************************************************************
 22629
 22630 7100-DISPLAY-CANCELS.
 22631     IF PI-DISPLAY-ORIGINAL-BATCH
 22632        MOVE PB-CONTROL-BY-ORIG-BATCH TO PI-PREV-KEY
 22633        MOVE ZEROS                    TO PI-PREV-CHG-SEQ-NO
 22634     ELSE
 22635        MOVE PB-CONTROL-PRIMARY      TO PI-PREV-KEY.
 22636
 22637     MOVE PB-CONTROL-PRIMARY         TO PI-PREV-CONTROL-PRIMARY.
 22638
 22639     MOVE 'Y'                        TO WS-DISPLAY-SW.
 22640     MOVE 'Y'                        TO PI-DISPLAY-SCREEN-SW.
 22641
 22642     MOVE LOW-VALUES                 TO EL631CI.
 22643     MOVE EL631C                     TO PI-MAP-NAME.
 22644     MOVE 'Y'                        TO PI-BROWSE-SW.
 22645     MOVE PB-BATCH-SEQ-NO            TO CSEQO
 22646                                        PI-HIGH-SEQ-NO.
 22647
 22648     IF PB-BATCH-CHG-SEQ-NO NOT = ZEROS
 22649        MOVE AL-SABOF                TO CCHGTA
 22650        SUBTRACT PB-BATCH-CHG-SEQ-NO FROM 1000 GIVING CCHGO
 22651        MOVE AL-SANON                TO CCHGA
 22652      ELSE
 22653        MOVE AL-SADOF                TO CCHGTA
 22654                                        CCHGA
 22655        MOVE PB-CHG-COUNT            TO CCHGCNTO.
 22656
 22657*    MOVE PB-C-REFERENCE             TO CREFO.
 22658
 22659*    IF PB-C-MICROFILM-NO IS NUMERIC
 22660*       IF PB-C-MICROFILM-NO  NOT = ZEROS
 22661*          MOVE PB-C-MICROFILM-NO
 22662*                                TO CMICRNOO
 22663*          MOVE AL-UNNON         TO CMICRNOA
 22664*       END-IF
 22665*    END-IF
 22666     IF PB-C-NH-INT-ON-REFS NUMERIC
 22667        IF PB-C-NH-INT-ON-REFS NOT = ZEROS
 22668           MOVE PB-C-NH-INT-ON-REFS
 22669                                 TO CNHINTO
 22670           MOVE AL-SANOF         TO CNHINTA
 22671        END-IF
 22672     END-IF
 22673     MOVE PB-CERT-PRIME              TO CCERTNOO.
 22674     MOVE PB-CERT-SFX                TO CSUFIXO.
 22675     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 22676     MOVE SPACE                      TO DC-OPTION-CODE.
 22677     PERFORM 9700-DATE-LINK.
 22678     MOVE DC-GREG-DATE-1-EDIT        TO CEFFDTO.
 22679
 22680     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 418
* EL6311.cbl
 22681        MOVE PB-C-LF-CANCEL-DT       TO DC-BIN-DATE-1
 22682        MOVE SPACE                   TO DC-OPTION-CODE
 22683        PERFORM 9700-DATE-LINK
 22684        IF NO-CONVERSION-ERROR
 22685           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT1O.
 22686
 22687     IF PB-C-LF-REFUND-OVERRIDE EQUAL SPACES
 22688        NEXT SENTENCE
 22689     ELSE
 22690        MOVE PB-C-LF-REFUND-OVERRIDE TO CMTHD1I.
 22691
 22692     IF PB-C-AH-REFUND-OVERRIDE EQUAL SPACES
 22693        NEXT SENTENCE
 22694     ELSE
 22695        MOVE PB-C-AH-REFUND-OVERRIDE TO CMTHD2I.
 22696
 22697     IF PB-C-AH-CANCEL-DT   NOT = LOW-VALUES
 22698        MOVE PB-C-AH-CANCEL-DT       TO DC-BIN-DATE-1
 22699        MOVE SPACE                   TO DC-OPTION-CODE
 22700        PERFORM 9700-DATE-LINK
 22701        IF NO-CONVERSION-ERROR
 22702           MOVE DC-GREG-DATE-1-EDIT  TO CCANDT2O.
 22703
 22704     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22705         MOVE PB-C-LF-CANCEL-AMT     TO CREFND1O.
 22706
 22707     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22708         MOVE PB-C-AH-CANCEL-AMT     TO CREFND2O.
 22709
 22710     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 22711        MOVE PB-C-LF-REF-CALC        TO CCRFND1O
 22712        SUBTRACT PB-C-LF-CANCEL-AMT FROM PB-C-LF-REF-CALC
 22713                 GIVING CDRFND1O.
 22714
 22715     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 22716        MOVE PB-C-AH-REF-CALC        TO CCRFND2O
 22717        SUBTRACT PB-C-AH-CANCEL-AMT FROM PB-C-AH-REF-CALC
 22718                 GIVING CDRFND2O.
 22719
 22720     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22721       IF PB-RECORD-ON-HOLD
 22722          MOVE 'ON HOLD'             TO CBILIT1O.
 22723
 22724     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22725       IF PB-RECORD-RETURNED
 22726          MOVE 'RETURNED'            TO CBILIT1O.
 22727
 22728     IF PB-C-LF-CANCEL-AMT NOT = ZEROS
 22729        AND (PB-OVERRIDE-LIFE OR PB-OVERRIDE-BOTH)
 22730             MOVE 'OVERRIDE'         TO CBILIT1O.
 22731
 22732     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22733       IF PB-RECORD-ON-HOLD
 22734          MOVE 'ON HOLD'             TO CBILIT2O.
 22735
 22736     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22737       IF PB-RECORD-RETURNED
 22738          MOVE 'RETURNED'            TO CBILIT2O.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 419
* EL6311.cbl
 22739
 22740     IF PB-C-AH-CANCEL-AMT NOT = ZEROS
 22741        AND (PB-OVERRIDE-AH OR PB-OVERRIDE-BOTH)
 22742             MOVE 'OVERRIDE'         TO CBILIT2O.
 22743
 22744     MOVE PB-C-LAST-NAME             TO CLSTNMO.
 22745     MOVE PB-C-CANCEL-REASON         TO CCANREAO
 22746     IF PB-C-POST-CARD-IND = 'Y'
 22747        MOVE 'Y'                     TO CPCYNO
 22748     ELSE
 22749        MOVE 'N'                     TO CPCYNO
 22750     END-IF
 22751     MOVE PB-FORCE-CODE              TO CFORCEO.
 22752     MOVE PB-RECORD-BILL             TO CBILCDO.
 22753     MOVE PB-CI-LAST-NAME            TO CINAMEO.
 22754     MOVE SPACES                     TO CINITSO.
 22755     IF PB-CI-FIRST-NAME GREATER THAN SPACES
 22756         MOVE PB-CI-FIRST-NAME       TO CINITSO
 22757     ELSE
 22758         MOVE PB-CI-INITIALS         TO CINITSO
 22759     END-IF.
 22760
 22761     IF PB-CI-CANCEL-FEE NUMERIC
 22762        MOVE PB-CI-CANCEL-FEE        TO W-CANCEL-FEE-LONG
 22763        MOVE W-CANCEL-FEE-LONG       TO W-CANCEL-FEE
 22764     ELSE
 22765        MOVE ZEROES                  TO W-CANCEL-FEE.
 22766
 22767     MOVE W-CANCEL-FEE               TO CCANFEEO.
 22768
 22769     IF PB-CI-LF-PREMIUM-AMT NOT = ZEROS
 22770        ADD PB-CI-LF-PREMIUM-AMT
 22771             PB-CI-LF-ALT-PREMIUM-AMT  GIVING  CPREM1O.
 22772
 22773     IF PB-CI-AH-PREMIUM-AMT NOT = ZEROS
 22774        MOVE PB-CI-AH-PREMIUM-AMT       TO CPREM2O.
 22775
 22776     MOVE PB-CI-LF-TERM              TO CTERM1O.
 22777     MOVE PB-C-LF-REM-TERM           TO CRTERM1O.
 22778     MOVE PB-CI-AH-TERM              TO CTERM2O.
 22779     MOVE PB-C-AH-REM-TERM           TO CRTERM2O.
 22780
 22781     IF PB-C-LIVES NUMERIC
 22782        MOVE PB-C-LIVES              TO CLIVESO.
 22783
 22784     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 22785        MOVE PB-C-PAYEE-CODE         TO CPAYEEO.
 22786
 22787     IF PB-CI-ENTRY-DT NOT = LOW-VALUES
 22788        MOVE PB-CI-ENTRY-DT          TO DC-BIN-DATE-1
 22789        MOVE SPACE                   TO DC-OPTION-CODE
 22790        PERFORM 9700-DATE-LINK
 22791        IF NO-CONVERSION-ERROR
 22792           MOVE DC-GREG-DATE-1-EDIT  TO CENTRDTO.
 22793
 22794     IF  PB-C-REFUND-CREATED
 22795         MOVE 'YES'                  TO CRFNDSWO
 22796     ELSE
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 420
* EL6311.cbl
 22797         IF PB-C-REFUND-REQUESTED
 22798            MOVE 'REQ'               TO CRFNDSWO
 22799         ELSE
 22800            MOVE 'NO'                TO CRFNDSWO.
 22801
 22802     MOVE PB-INPUT-DT                TO DC-BIN-DATE-1.
 22803     MOVE SPACE                      TO DC-OPTION-CODE.
 22804     PERFORM 9700-DATE-LINK.
 22805     MOVE DC-GREG-DATE-1-EDIT        TO CENTDTO.
 22806     MOVE PB-INPUT-BY                TO CENTBYO.
 22807
 22808     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22809        MOVE PB-CREDIT-ACCEPT-DT     TO DC-BIN-DATE-1
 22810        MOVE SPACE                   TO DC-OPTION-CODE
 22811        PERFORM 9700-DATE-LINK
 22812        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22813        MOVE 'INACTIVE'              TO CMOENDTO
 22814     ELSE
 22815        MOVE PB-LAST-MAINT-DT        TO DC-BIN-DATE-1
 22816        MOVE SPACE                   TO DC-OPTION-CODE
 22817        PERFORM 9700-DATE-LINK
 22818        MOVE DC-GREG-DATE-1-EDIT     TO CMANTDTO
 22819        MOVE PB-CREDIT-SELECT-DT     TO DC-BIN-DATE-1
 22820        MOVE SPACE                   TO DC-OPTION-CODE
 22821        PERFORM 9700-DATE-LINK
 22822        MOVE DC-GREG-DATE-1-EDIT     TO CMOENDTO.
 22823
 22824     MOVE PB-LAST-MAINT-BY           TO CMANTBYO.
 22825
 22826     MOVE PB-LAST-MAINT-HHMMSS       TO WS-TIME.
 22827     MOVE WS-HR-MINS                 TO CMANTATO.
 22828
 22829     EVALUATE PB-LF-REFUND-TYPE
 22830        WHEN '1'
 22831           MOVE 'RULE78'            TO CLFREFNO
 22832        WHEN '2'
 22833           MOVE 'PRORAT'            TO CLFREFNO
 22834        WHEN '3'
 22835           MOVE 'CALIF'             TO CLFREFNO
 22836        WHEN '4'
 22837           MOVE 'IRREG'             TO CLFREFNO
 22838        WHEN '5'
 22839           MOVE 'NETPAY'            TO CLFREFNO
 22840        WHEN '6'
 22841           MOVE 'ATCP'              TO CLFREFNO
 22842        WHEN '7'
 22843           MOVE 'UTAH'              TO CLFREFNO
 22844        WHEN '8'
 22845           MOVE 'MEAN'              TO CLFREFNO
 22846        WHEN '9'
 22847           MOVE 'SUM '              TO CLFREFNO
 22848        WHEN 'B'
 22849           MOVE 'BALN'              TO CLFREFNO
 22850     END-EVALUATE.
 22851
 22852     EVALUATE TRUE
 22853        WHEN PB-AH-REFUND-TYPE =  '1'
 22854           MOVE 'RULE78'            TO CAHREFNO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 421
* EL6311.cbl
 22855        WHEN PB-AH-REFUND-TYPE =  '2'
 22856           MOVE 'PRORAT'            TO CAHREFNO
 22857        WHEN PB-AH-REFUND-TYPE =  ('3' OR 'S')
 22858           MOVE 'CALIF'             TO CAHREFNO
 22859        WHEN PB-AH-REFUND-TYPE =  '4'
 22860           MOVE 'IRREG'             TO CAHREFNO
 22861        WHEN PB-AH-REFUND-TYPE =  '5'
 22862           MOVE 'NETPAY'            TO CAHREFNO
 22863        WHEN PB-AH-REFUND-TYPE =  '6'
 22864           MOVE 'ATCP'              TO CAHREFNO
 22865        WHEN PB-AH-REFUND-TYPE =  '7'
 22866           MOVE 'UTAH'              TO CAHREFNO
 22867        WHEN PB-AH-REFUND-TYPE =  '8'
 22868           MOVE 'MEAN'              TO CAHREFNO
 22869        WHEN PB-AH-REFUND-TYPE =  '9'
 22870           MOVE 'SUM '              TO CAHREFNO
 22871        WHEN PB-AH-REFUND-TYPE =  'B'
 22872           MOVE 'BALN'              TO CAHREFNO
 22873     END-EVALUATE.
 22874
 22875     MOVE PB-REIN-CD                 TO CREINCDO.
 22876
 22877     IF PB-ACCT-EFF-DT NOT = LOW-VALUES AND SPACES
 22878        MOVE PB-ACCT-EFF-DT          TO DC-BIN-DATE-1
 22879        MOVE SPACE                   TO DC-OPTION-CODE
 22880        PERFORM 9700-DATE-LINK
 22881        IF NO-CONVERSION-ERROR
 22882           MOVE DC-GREG-DATE-1-EDIT  TO CAEFFDTO.
 22883
 22884     IF PB-ACCT-EXP-DT  = HIGH-VALUES
 22885        MOVE 999999                  TO WS-EXP-DT-EDIT
 22886        INSPECT WS-EXP-DT-EDIT CONVERTING SPACES TO '/'
 22887        MOVE WS-EXP-DT-EDIT          TO CAEXPDTO
 22888     ELSE
 22889        IF PB-ACCT-EXP-DT NOT = LOW-VALUES
 22890           MOVE PB-ACCT-EXP-DT          TO DC-BIN-DATE-1
 22891           MOVE SPACE                   TO DC-OPTION-CODE
 22892           PERFORM 9700-DATE-LINK
 22893           IF NO-CONVERSION-ERROR
 22894              MOVE DC-GREG-DATE-1-EDIT  TO CAEXPDTO.
 22895
 22896     IF PB-ORIGINAL-ENTRY-BATCH NOT = SPACES
 22897        IF PB-ORIGINAL-ENTRY-BATCH NOT = PB-ENTRY-BATCH
 22898           MOVE AL-SANOF                TO CORIGHDA
 22899           MOVE PB-ORIGINAL-ENTRY-BATCH TO CORGNOO
 22900           MOVE PB-ORIGINAL-SEQ-NO      TO CORGSEQO.
 22901
 22902     MOVE PB-CSR-ID              TO CCSRO.
 22903
 22904     MOVE PB-CI-LIFE-COMMISSION  TO COMMLFO.
 22905     MOVE PB-CI-AH-COMMISSION    TO COMMAHO.
 22906
 22907     MOVE 'C'                    TO CMAINTI.
 22908     MOVE AL-UANON               TO CMAINTA.
 22909
 22910     IF PI-6316-FINALIZED = 'Y'  AND
 22911        PB-UNFORCED-ERRORS
 22912          MOVE -1                TO CFORCEL
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 422
* EL6311.cbl
 22913          MOVE  1                TO SET-CURSOR-SW
 22914     END-IF
 22915
 22916     IF PB-BATCH-CHG-SEQ-NO = ZEROS
 22917        PERFORM 7300-FORMAT-ERRORS THRU 7399-EXIT.
 22918
 22919     IF NO-CURSOR-SET
 22920        MOVE -1                  TO CMAINTL.
 22921
 22922     GO TO 8100-SEND-INITIAL-MAP.
 22923
 22924
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 423
* EL6311.cbl
 22926***************************************************************
 22927*     ROUTINE THAT MOVES ALL DATA FROM THE BATCH TOTAL        *
 22928*     RECORD TO THE BATCH TOTAL SCREEN.                       *
 22929***************************************************************
 22930
 22931 7200-DISPLAY-BATCHES.
 22932     MOVE EL631D                 TO PI-MAP-NAME.
 22933     MOVE LOW-VALUES             TO EL631DI.
 22934
 22935     MOVE 'Y'                    TO WS-DISPLAY-SW.
 22936
 22937
 22938* EXEC CICS HANDLE CONDITION
 22939*         NOTFND   (3690-NOT-FOUND)
 22940*    END-EXEC.
 22941*    MOVE '"$I                   ! Y #00019235' TO DFHEIV0
 22942     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 22943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 22944     MOVE X'5920233030303139323335' TO DFHEIV0(25:11)
 22945     CALL 'kxdfhei1' USING DFHEIV0
 22946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22947
 22948
 22949     IF PI-DISPLAY-SCREEN
 22950        MOVE PI-PREV-KEY         TO ERPNDB-KEY
 22951     ELSE
 22952        MOVE PB-CONTROL-PRIMARY  TO ERPNDB-KEY.
 22953
 22954     MOVE +9999                  TO ERPNDB-BATCH-SEQ-NO.
 22955     MOVE +0                     TO ERPNDB-BATCH-CHG-SEQ-NO.
 22956
 22957
 22958* EXEC CICS READ
 22959*         DATASET   (FILE-ID-ERPNDB)
 22960*         RIDFLD    (ERPNDB-KEY)
 22961*         SET       (ADDRESS OF PENDING-BUSINESS)
 22962*    END-EXEC.
 22963*    MOVE '&"S        E          (   #00019247' TO DFHEIV0
 22964     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 22965     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 22966     MOVE X'2020233030303139323437' TO DFHEIV0(25:11)
 22967     CALL 'kxdfhei1' USING DFHEIV0,
 22968           FILE-ID-ERPNDB,
 22969           DFHEIV20,
 22970           DFHEIV99,
 22971           ERPNDB-KEY,
 22972           DFHEIV99,
 22973           DFHEIV99,
 22974           DFHEIV99
 22975     SET ADDRESS OF PENDING-BUSINESS TO
 22976         DFHEIV20
 22977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 22978
 22979
 22980     MOVE PB-CONTROL-BY-ACCOUNT  TO PI-PREV-ALT-KEY.
 22981     MOVE PB-CONTROL-PRIMARY     TO PI-PREV-KEY.
 22982     MOVE PB-SV-CARRIER          TO PI-SV-CARRIER.
 22983     MOVE PB-SV-GROUPING         TO PI-SV-GROUPING.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 424
* EL6311.cbl
 22984     MOVE PB-SV-STATE            TO PI-SV-STATE.
 22985
 22986     MOVE EL631D                 TO PI-MAP-NAME.
 22987     MOVE LOW-VALUES             TO EL631DI.
 22988     MOVE PB-ENTRY-BATCH         TO DBATCHO.
 22989
 22990*    IF PI-AR-PROCESSING
 22991*       MOVE PB-REFERENCE        TO DREFO.
 22992
 22993     MOVE PB-CSR-ID              TO DCSRO.
 22994
 22995     IF PB-CREDIT-ACCEPT-DT NOT = LOW-VALUES
 22996        MOVE PB-CREDIT-ACCEPT-DT TO DC-BIN-DATE-1
 22997        MOVE SPACE               TO DC-OPTION-CODE
 22998        PERFORM 9700-DATE-LINK
 22999        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO
 23000        MOVE AL-SABOF            TO DLDATEA  DMAINDTA
 23001        MOVE 'INACTIVE'          TO DLDATEO
 23002     ELSE
 23003        MOVE PB-LAST-MAINT-DT    TO DC-BIN-DATE-1
 23004        MOVE SPACE               TO DC-OPTION-CODE
 23005        PERFORM 9700-DATE-LINK
 23006        MOVE DC-GREG-DATE-1-EDIT TO DMAINDTO.
 23007
 23008     MOVE PB-INPUT-DT            TO DC-BIN-DATE-1.
 23009     MOVE SPACE                  TO DC-OPTION-CODE.
 23010     PERFORM 9700-DATE-LINK.
 23011     MOVE DC-GREG-DATE-1-EDIT    TO DINPUTO.
 23012
 23013     IF PB-B-RECEIVED-DT = SPACES OR LOW-VALUES
 23014        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO
 23015     ELSE
 23016        MOVE PB-B-RECEIVED-DT    TO DC-BIN-DATE-1
 23017        MOVE SPACE               TO DC-OPTION-CODE
 23018        PERFORM 9700-DATE-LINK
 23019        MOVE DC-GREG-DATE-1-EDIT TO DRECVDTO.
 23020
 23021     MOVE PB-CREDIT-SELECT-DT    TO DC-BIN-DATE-1.
 23022     MOVE SPACE                  TO DC-OPTION-CODE.
 23023     PERFORM 9700-DATE-LINK.
 23024     MOVE DC-GREG-DATE-1-EDIT        TO DPROCDTO.
 23025
 23026     MOVE PB-B-ISSUE-CNT-REMITTED    TO DRISSO.
 23027     MOVE PB-B-ISSUE-CNT-ENTERED     TO DEISSO.
 23028
 23029     IF PB-B-ISSUE-CNT-REMITTED NOT = PB-B-ISSUE-CNT-ENTERED
 23030        SUBTRACT PB-B-ISSUE-CNT-ENTERED FROM
 23031                 PB-B-ISSUE-CNT-REMITTED GIVING DOISSO.
 23032
 23033     MOVE PB-B-LF-ISS-PRM-REMITTED   TO DRLFPRMO.
 23034     MOVE PB-B-LF-ISS-PRM-ENTERED    TO DELFPRMO.
 23035     MOVE PB-B-LF-ISS-PRM-COMPUTED   TO DCLFPRMO.
 23036
 23037     IF PB-B-LF-ISS-PRM-ENTERED NOT = PB-B-LF-ISS-PRM-REMITTED
 23038        SUBTRACT PB-B-LF-ISS-PRM-ENTERED FROM
 23039                 PB-B-LF-ISS-PRM-REMITTED  GIVING DOLFPRMO.
 23040
 23041     MOVE PB-B-AH-ISS-PRM-REMITTED   TO DRAHPRMO.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 425
* EL6311.cbl
 23042     MOVE PB-B-AH-ISS-PRM-ENTERED    TO DEAHPRMO.
 23043     MOVE PB-B-AH-ISS-PRM-COMPUTED   TO DCAHPRMO.
 23044
 23045     IF PB-B-AH-ISS-PRM-ENTERED NOT = PB-B-AH-ISS-PRM-REMITTED
 23046        SUBTRACT PB-B-AH-ISS-PRM-ENTERED FROM
 23047                 PB-B-AH-ISS-PRM-REMITTED  GIVING DOAHPRMO.
 23048
 23049     MOVE PB-B-CANCEL-CNT-REMITTED     TO DRCANCO.
 23050     MOVE PB-B-CANCEL-CNT-ENTERED      TO DECANCO.
 23051
 23052     IF PB-B-CANCEL-CNT-REMITTED NOT = PB-B-CANCEL-CNT-ENTERED
 23053        SUBTRACT PB-B-CANCEL-CNT-ENTERED FROM
 23054                 PB-B-CANCEL-CNT-REMITTED GIVING DOCANCO.
 23055
 23056     MOVE PB-B-LF-CAN-PRM-REMITTED   TO DRLFRFDO.
 23057     MOVE PB-B-LF-CAN-PRM-ENTERED    TO DELFRFDO.
 23058     MOVE PB-B-LF-CAN-PRM-COMPUTED   TO DCLFRFDO.
 23059
 23060     IF PB-B-LF-CAN-PRM-ENTERED NOT = PB-B-LF-CAN-PRM-REMITTED
 23061        SUBTRACT PB-B-LF-CAN-PRM-ENTERED FROM
 23062                 PB-B-LF-CAN-PRM-REMITTED  GIVING DOLFRFDO.
 23063
 23064     MOVE PB-B-AH-CAN-PRM-REMITTED   TO DRAHRFDO.
 23065     MOVE PB-B-AH-CAN-PRM-ENTERED    TO DEAHRFDO.
 23066     MOVE PB-B-AH-CAN-PRM-COMPUTED   TO DCAHRFDO.
 23067
 23068     IF PB-B-AH-CAN-PRM-ENTERED NOT = PB-B-AH-CAN-PRM-REMITTED
 23069        SUBTRACT PB-B-AH-CAN-PRM-ENTERED FROM
 23070                 PB-B-AH-CAN-PRM-REMITTED  GIVING DOAHRFDO.
 23071
 23072     MOVE -1                     TO DPFENTRL.
 23073     GO TO 8100-SEND-INITIAL-MAP.
 23074
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 426
* EL6311.cbl
 23076
 23077***************************************************************
 23078*     THIS ROUTINE DETERMINES IF EL050 ENCOUNTERED ANY        *
 23079*     ERRORS.  IF ERRORS WERE DETECTED, THE ONLINE ERROR      *
 23080*     PROCESSING ROUTINE IS CALLED TO FORMAT THE ERROR        *
 23081*     MESSAGES AND ACCUMULATE TOTALS FOR THE DIFFERENT        *
 23082*     SEVERITY LEVELS. THE SEVERITY FLAGS WITHIN THE RECORDS  *
 23083*     ARE THEN SET ACCORDINGLY.                               *
 23084*         ERROR NUMBERS FOR THE STANDARD ERRORS START AT 2600 *
 23085*         ERROR NUMBERS FOR ISSUE TRANSACTIONS  START AT 2625 *
 23086*         ERROR NUMBERS FOR CANCEL TRANSACTIONS START AT 2725 *
 23087***************************************************************
 23088
 23089******************************************************************
 23090*                                                                *
 23091*            E R R O R   A N A L Y S I S                         *
 23092*                                                                *
 23093******************************************************************
 23094
 23095******************************************************************
 23096*                                                                *
 23097*   THIS ROUTINE DETERMINES IF EL050 (EDIT PROGRAM) ENCOUNTERED  *
 23098*   ANY ERRORS.  IF ERRORS WERE DETECTED, THE ROUTINE READS THE  *
 23099*   ERROR FILE TO DETERMINE THE SEVERITY OF THE ERRORS.  ONCE    *
 23100*   THE SEVERITY OF ERRORS IS ESTABLISHED THE APPROPRIATE ERROR  *
 23101*   FLAGS ARE SET (FORCIBLE, UNFORCIBLE, WARNING, ETC.).         *
 23102*                                                                *
 23103*   IF ANY UNFORCED OR FATAL ERRORS, OR RECORD IS RETURNED       *
 23104*   OR PLACED ON HOLD UPDATE THE CERTIFICATE ACCORDINGLY.        *
 23105*                                                                *
 23106******************************************************************
 23107
 23108 7300-FORMAT-ERRORS.
 23109     MOVE ' '                    TO PI-ERRORS-SW
 23110     IF PB-COMMON-ERRORS = LOW-VALUES
 23111        IF PB-FATAL-ERRORS
 23112           MOVE ER-2695          TO EMI-ERROR
 23113           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23114           GO TO 7399-EXIT.
 23115
 23116     MOVE +0                     TO WS-SUB4.
 23117
 23118 7310-ERROR-LOOP.
 23119
 23120     ADD +1                      TO WS-SUB4.
 23121
 23122     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23123        GO TO 7350-SET-ERROR-FLAGS.
 23124
 23125     IF PI-COMPANY-ID = 'UCL'
 23126         IF PB-COMMON-ERROR (WS-SUB4) = ER-2799
 23127             MOVE WS-CERT-EFF-DT        TO DC-BIN-DATE-1
 23128             MOVE ' '                   TO DC-OPTION-CODE
 23129             PERFORM 9700-DATE-LINK
 23130             MOVE DC-GREG-DATE-1-MDY    TO EMI-AH-OVERRIDE-L6.
 23131
 23132     MOVE PB-COMMON-ERROR (WS-SUB4) TO EMI-ERROR.
 23133     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 427
* EL6311.cbl
 23134     PERFORM 7400-SET-ATTRIBUTES THRU 7499-EXIT.
 23135
 23136     GO TO 7310-ERROR-LOOP.
 23137
 23138
 23139 7350-SET-ERROR-FLAGS.
 23140
 23141     IF EMI-FATAL-CTR NOT = ZEROS
 23142        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23143        MOVE 'X'                 TO PB-FATAL-FLAG
 23144                                    PI-ERRORS-SW
 23145        GO TO 7355-SET-ERROR-FLAGS.
 23146
 23147     move ' ' to pi-unforced-sw
 23148     IF EMI-FORCABLE-CTR NOT = ZEROS
 23149        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23150        IF PB-ISSUE
 23151           IF PB-ISSUE-FORCE
 23152              MOVE 'F'           TO PB-FORCE-ER-CD
 23153              MOVE ER-2600       TO EMI-ERROR
 23154              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23155             ELSE
 23156              MOVE 'X'           TO PB-FORCE-ER-CD
 23157*                                   PI-ERRORS-SW
 23158          ELSE
 23159           IF PB-CANCEL-FORCE OR PB-ALL-CANCEL-FORCED-NO-FEE
 23160              MOVE 'F'           TO PB-FORCE-ER-CD
 23161                                    pi-unforced-sw
 23162              MOVE ER-2600       TO EMI-ERROR
 23163              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23164             ELSE
 23165              MOVE 'X'           TO PB-FORCE-ER-CD
 23166                                    pi-unforced-sw.
 23167*                                   PI-ERRORS-SW.
 23168
 23169     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO ERENDT-KEY (1:33)
 23170     IF PB-ISSUE
 23171         MOVE 'I'                TO ENDT-RECORD-TYPE
 23172     ELSE
 23173         MOVE 'C'                TO ENDT-RECORD-TYPE
 23174     END-IF
 23175     MOVE +0                     TO ENDT-SEQ-NO
 23176
 23177
 23178* EXEC CICS READ
 23179*        DATASET   (FILE-ID-ERENDT)
 23180*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
 23181*        RIDFLD    (ERENDT-KEY)
 23182*        RESP      (WS-RESPONSE)
 23183*        GTEQ
 23184*    END-EXEC
 23185*    MOVE '&"S        G          (  N#00019450' TO DFHEIV0
 23186     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 23187     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 23188     MOVE X'204E233030303139343530' TO DFHEIV0(25:11)
 23189     CALL 'kxdfhei1' USING DFHEIV0,
 23190           FILE-ID-ERENDT,
 23191           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 428
* EL6311.cbl
 23192           DFHEIV99,
 23193           ERENDT-KEY,
 23194           DFHEIV99,
 23195           DFHEIV99,
 23196           DFHEIV99
 23197     SET ADDRESS OF ENDORSEMENT-RECORD TO
 23198         DFHEIV20
 23199     MOVE EIBRESP  TO WS-RESPONSE
 23200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23201
 23202     IF RESP-NORMAL
 23203        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
 23204        IF EN-BATCH-NUMBER = PB-ENTRY-BATCH
 23205            MOVE ER-0280          TO EMI-ERROR
 23206            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 23207            MOVE EN-ARCHIVE-NO    TO ARCH-SUPPRESS
 23208            EVALUATE TRUE
 23209              WHEN EMI-ERROR-NUMBER (1) EQUAL ER-0280
 23210                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (1)
 23211              WHEN EMI-ERROR-NUMBER (2) EQUAL ER-0280
 23212                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (2)
 23213              WHEN EMI-ERROR-NUMBER (3) EQUAL ER-0280
 23214                 MOVE ARCH-EDIT   TO EMI-TEXT-VARIABLE (3)
 23215            END-EVALUATE
 23216        END-IF
 23217     END-IF
 23218
 23219
 23220
 23221     IF FIRST-ENTRY OR
 23222        EIBAID = DFHPF1 OR DFHPF2
 23223        MOVE '0'                TO PI-EDIT-SW
 23224        GO TO 7399-EXIT.
 23225
 23226 7355-SET-ERROR-FLAGS.
 23227
 23228     IF EMI-WARNING-CTR NOT = ZEROS
 23229        MOVE 'Y'                 TO WS-ERRORS-PRESENT-SW
 23230        MOVE 'W'                 TO PB-WARN-ER-CD.
 23231
 23232     IF PB-UNFORCED-ERRORS OR
 23233        PB-FATAL-ERRORS    OR
 23234        PB-RECORD-ON-HOLD  OR
 23235        PB-RECORD-RETURNED OR
 23236        PB-CANCELLATION
 23237          NEXT SENTENCE
 23238        ELSE
 23239          GO TO 7399-EXIT.
 23240
 23241
 23242* EXEC CICS  HANDLE CONDITION
 23243*           NOTFND   (7399-EXIT)
 23244*    END-EXEC.
 23245*    MOVE '"$I                   ! Z #00019497' TO DFHEIV0
 23246     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 23247     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 23248     MOVE X'5A20233030303139343937' TO DFHEIV0(25:11)
 23249     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 429
* EL6311.cbl
 23250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23251
 23252
 23253     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
 23254     MOVE PB-SV-CARRIER          TO ELCERT-CARRIER.
 23255     MOVE PB-SV-GROUPING         TO ELCERT-GROUPING.
 23256     MOVE PB-SV-STATE            TO ELCERT-STATE.
 23257
 23258
 23259* EXEC CICS READ
 23260*        SET     (ADDRESS OF CERTIFICATE-MASTER)
 23261*        DATASET (FILE-ID-ELCERT)
 23262*        RIDFLD  (ELCERT-KEY)
 23263*        UPDATE
 23264*    END-EXEC.
 23265*    MOVE '&"S        EU         (   #00019506' TO DFHEIV0
 23266     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 23267     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 23268     MOVE X'2020233030303139353036' TO DFHEIV0(25:11)
 23269     CALL 'kxdfhei1' USING DFHEIV0,
 23270           FILE-ID-ELCERT,
 23271           DFHEIV20,
 23272           DFHEIV99,
 23273           ELCERT-KEY,
 23274           DFHEIV99,
 23275           DFHEIV99,
 23276           DFHEIV99
 23277     SET ADDRESS OF CERTIFICATE-MASTER TO
 23278         DFHEIV20
 23279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23280
 23281
 23282
 23283     MOVE CM-CREDIT-INTERFACE-SW-1         TO WS-SW-1
 23284     MOVE CM-CREDIT-INTERFACE-SW-2         TO WS-SW-2
 23285
 23286     IF (CERT-ADDED-BATCH OR CERT-PURGED-OFFLINE) AND PB-ISSUE
 23287        GO TO 7360-REWRITE-CERT-MASTER.
 23288
 23289     IF PB-ISSUE
 23290        IF PB-RECORD-RETURNED
 23291            MOVE '4'  TO CM-CREDIT-INTERFACE-SW-1
 23292            GO TO 7360-REWRITE-CERT-MASTER
 23293        ELSE
 23294            MOVE '2' TO CM-CREDIT-INTERFACE-SW-1
 23295            GO TO 7360-REWRITE-CERT-MASTER.
 23296
 23297     IF PB-RECORD-RETURNED
 23298         MOVE '7'      TO CM-CREDIT-INTERFACE-SW-2
 23299         GO TO 7360-REWRITE-CERT-MASTER.
 23300
 23301     IF (PB-C-LF-CANCEL-VOIDED)
 23302        or (pb-c-ah-cancel-voided)
 23303        IF (PB-UNFORCED-ERRORS OR
 23304            PB-FATAL-ERRORS    OR
 23305            PB-RECORD-ON-HOLD)
 23306            MOVE '6'             TO CM-CREDIT-INTERFACE-SW-2
 23307            GO TO 7360-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 430
* EL6311.cbl
 23308        ELSE
 23309            MOVE '5'             TO CM-CREDIT-INTERFACE-SW-2
 23310            GO TO 7360-REWRITE-CERT-MASTER.
 23311
 23312     IF (PB-UNFORCED-ERRORS OR PB-FATAL-ERRORS
 23313                            OR PB-RECORD-ON-HOLD)
 23314        MOVE '4'                 TO CM-CREDIT-INTERFACE-SW-2
 23315     ELSE
 23316        MOVE '1'                 TO CM-CREDIT-INTERFACE-SW-2.
 23317
 23318 7360-REWRITE-CERT-MASTER.
 23319
 23320     IF WS-SW-1 = CM-CREDIT-INTERFACE-SW-1 AND
 23321        WS-SW-2 = CM-CREDIT-INTERFACE-SW-2
 23322
 23323* EXEC CICS UNLOCK
 23324*            DATASET    (FILE-ID-ELCERT)
 23325*       END-EXEC
 23326*    MOVE '&*                    #   #00019553' TO DFHEIV0
 23327     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 23328     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 23329     MOVE X'2020233030303139353533' TO DFHEIV0(25:11)
 23330     CALL 'kxdfhei1' USING DFHEIV0,
 23331           FILE-ID-ELCERT,
 23332           DFHEIV99
 23333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 23334        GO TO 7399-EXIT.
 23335
 23336
 23337* EXEC CICS REWRITE
 23338*         DATASET    (FILE-ID-ELCERT)
 23339*         FROM       (CERTIFICATE-MASTER)
 23340*    END-EXEC.
 23341     MOVE LENGTH OF
 23342      CERTIFICATE-MASTER
 23343       TO DFHEIV11
 23344*    MOVE '&& L                  %   #00019558' TO DFHEIV0
 23345     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 23346     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 23347     MOVE X'2020233030303139353538' TO DFHEIV0(25:11)
 23348     CALL 'kxdfhei1' USING DFHEIV0,
 23349           FILE-ID-ELCERT,
 23350           CERTIFICATE-MASTER,
 23351           DFHEIV11,
 23352           DFHEIV99
 23353     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 23354
 23355
 23356 7399-EXIT.
 23357      EXIT.
 23358
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 431
* EL6311.cbl
 23360
 23361*************************************************************
 23362*                                                           *
 23363*              S E T   A T T R I B U T E S                  *
 23364*                                                           *
 23365*************************************************************
 23366
 23367 7400-SET-ATTRIBUTES.
 23368
 23369     IF WS-SUB4 GREATER THAN PB-NO-OF-ERRORS
 23370        GO TO 7499-EXIT.
 23371
 23372**2601**
 23373
 23374     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2601
 23375        IF PB-ISSUE
 23376           MOVE AL-UABON         TO BEFFDTA
 23377           GO TO 7499-EXIT
 23378         ELSE
 23379           MOVE AL-UABON         TO CEFFDTA
 23380           GO TO 7499-EXIT.
 23381
 23382**2604**
 23383
 23384     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2604
 23385        IF PB-ISSUE
 23386           MOVE AL-UABON         TO BTYPE1A
 23387           MOVE -1               TO BTYPE1L
 23388           MOVE  1               TO SET-CURSOR-SW
 23389           GO TO 7499-EXIT.
 23390
 23391**2605**
 23392
 23393     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2605
 23394        IF PB-ISSUE
 23395           MOVE AL-UABON         TO BTYPE2A
 23396           MOVE -1               TO BTYPE2L
 23397           MOVE  1               TO SET-CURSOR-SW
 23398           GO TO 7499-EXIT.
 23399
 23400**2606**
 23401
 23402     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2606
 23403        IF PB-ISSUE
 23404           MOVE AL-UABON         TO BSIGA
 23405           MOVE -1               TO BSIGL
 23406           MOVE  1               TO SET-CURSOR-SW
 23407           GO TO 7499-EXIT.
 23408
 23409**2607**
 23410
 23411     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23412        IF PB-ISSUE
 23413           MOVE AL-UABON         TO BSIGA
 23414           MOVE -1               TO BSIGL
 23415           MOVE  1               TO SET-CURSOR-SW
 23416           GO TO 7499-EXIT.
 23417
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 432
* EL6311.cbl
 23418**2615**
 23419
 23420     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2607
 23421        IF PB-ISSUE
 23422           MOVE AL-UABOF         TO BREINA
 23423           MOVE -1               TO BREINL
 23424           GO TO 7499-EXIT.
 23425
 23426**2622**
 23427
 23428     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2622
 23429        IF PB-ISSUE
 23430           MOVE AL-UABON         TO BEFFDTA
 23431           GO TO 7499-EXIT
 23432        ELSE
 23433           MOVE AL-UABON         TO CEFFDTA
 23434           GO TO 7499-EXIT.
 23435
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 433
* EL6311.cbl
 23437
 23438*************************************************************
 23439*                                                           *
 23440*              I S S U E   E R R O R S                      *
 23441*                                                           *
 23442*************************************************************
 23443
 23444 7420-ISSUE-ERRORS.
 23445
 23446**2626**
 23447
 23448     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2626
 23449        MOVE AL-UABON            TO BCERTNOA
 23450        GO TO 7499-EXIT.
 23451
 23452**2627**
 23453
 23454     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2627
 23455        MOVE AL-UNBON            TO BAGEA
 23456        MOVE -1                  TO BAGEL
 23457        MOVE  1                  TO SET-CURSOR-SW
 23458        GO TO 7499-EXIT.
 23459
 23460**2628**
 23461
 23462     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2628
 23463        MOVE AL-UNBON            TO BAGEA
 23464        MOVE -1                  TO BAGEL
 23465        MOVE  1                  TO SET-CURSOR-SW
 23466        GO TO 7499-EXIT.
 23467
 23468**2629**
 23469
 23470     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2629
 23471        MOVE AL-UABON            TO BSEXA
 23472        MOVE -1                  TO BSEXL
 23473        MOVE  1                  TO SET-CURSOR-SW
 23474        GO TO 7499-EXIT.
 23475
 23476**2630**
 23477
 23478     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2630
 23479        MOVE -1                  TO BTYPE1L
 23480        MOVE  1                  TO SET-CURSOR-SW
 23481        GO TO 7499-EXIT.
 23482
 23483**2631**
 23484
 23485     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2631
 23486        MOVE -1                  TO BTYPE1L
 23487        MOVE  1                  TO SET-CURSOR-SW
 23488        GO TO 7499-EXIT.
 23489
 23490**2632**
 23491
 23492     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2632
 23493        MOVE AL-UNBON            TO BBEN1A
 23494        MOVE -1                  TO BBEN1L
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 434
* EL6311.cbl
 23495        MOVE  1                  TO SET-CURSOR-SW
 23496        GO TO 7499-EXIT.
 23497
 23498**2633**
 23499
 23500     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2633
 23501        MOVE AL-UNBON            TO BPREM1A
 23502        MOVE -1                  TO BPREM1L
 23503        MOVE  1                  TO SET-CURSOR-SW
 23504        GO TO 7499-EXIT.
 23505
 23506**2634**
 23507
 23508     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2634
 23509        MOVE -1                  TO BTYPE2L
 23510        MOVE  1                  TO SET-CURSOR-SW
 23511        GO TO 7499-EXIT.
 23512
 23513**2635**
 23514
 23515     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2635
 23516        MOVE AL-UNBON            TO BBEN2A
 23517        MOVE -1                  TO BBEN2L
 23518        MOVE  1                  TO SET-CURSOR-SW
 23519        GO TO 7499-EXIT.
 23520
 23521**2636**
 23522
 23523     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2636
 23524        MOVE AL-UNBON            TO BPREM2A
 23525        MOVE -1                  TO BPREM2L
 23526        MOVE  1                  TO SET-CURSOR-SW
 23527        GO TO 7499-EXIT.
 23528
 23529**2639**
 23530
 23531     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2639
 23532        MOVE AL-UNBON            TO BBEN1A
 23533        MOVE -1                  TO BBEN1L
 23534        MOVE  1                  TO SET-CURSOR-SW
 23535        GO TO 7499-EXIT.
 23536
 23537**2640**
 23538
 23539     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2640
 23540        MOVE AL-UNBON            TO BBEN2A
 23541        MOVE -1                  TO BBEN2L
 23542        MOVE  1                  TO SET-CURSOR-SW
 23543        GO TO 7499-EXIT.
 23544
 23545**2647**
 23546
 23547     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2647
 23548        MOVE AL-UNBON            TO BTERM1A
 23549        MOVE -1                  TO BTERM1L
 23550        MOVE  1                  TO SET-CURSOR-SW
 23551        GO TO 7499-EXIT.
 23552
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 435
* EL6311.cbl
 23553**2648**
 23554
 23555     IF PB-COMMON-ERROR (WS-SUB4) = ER-2648 OR ER-1575
 23556        MOVE AL-UNBON            TO BLNTRMA
 23557        MOVE -1                  TO BLNTRML
 23558        MOVE  1                  TO SET-CURSOR-SW
 23559        GO TO 7499-EXIT.
 23560
 23561**2649**
 23562
 23563     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23564        AND PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23565            MOVE AL-UNBON            TO BPREM1A
 23566            MOVE -1                  TO BPREM1L
 23567            MOVE  1                  TO SET-CURSOR-SW
 23568            GO TO 7499-EXIT
 23569     ELSE
 23570        IF PB-COMMON-ERROR    (WS-SUB4) = ER-2649
 23571           AND PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23572            MOVE AL-UNBON            TO BPREM2A
 23573            MOVE -1                  TO BPREM2L
 23574            MOVE  1                  TO SET-CURSOR-SW
 23575            GO TO 7499-EXIT.
 23576
 23577**2650**
 23578
 23579     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23580        IF  PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 23581            MOVE AL-UNBON        TO BPREM1A
 23582            MOVE -1              TO BPREM1L
 23583            MOVE  1              TO SET-CURSOR-SW
 23584            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23585                MOVE AL-UNBON        TO BPREM2A
 23586                MOVE -1              TO BPREM2L
 23587                MOVE  1              TO SET-CURSOR-SW
 23588                GO TO 7499-EXIT
 23589            ELSE
 23590                GO TO 7499-EXIT
 23591        ELSE
 23592            IF  PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 23593                MOVE AL-UNBON        TO BPREM2A
 23594                MOVE -1              TO BPREM2L
 23595                MOVE  1              TO SET-CURSOR-SW
 23596                GO TO 7499-EXIT
 23597            ELSE
 23598                GO TO 7499-EXIT.
 23599
 23600**2651**
 23601
 23602     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2650
 23603        MOVE AL-UABON            TO BSIGA
 23604        MOVE -1                  TO BSIGL
 23605        MOVE  1                  TO SET-CURSOR-SW
 23606        GO TO 7499-EXIT.
 23607
 23608**2653**
 23609
 23610     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2653
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 436
* EL6311.cbl
 23611        MOVE AL-UABON            TO BFREQA
 23612        MOVE -1                  TO BFREQL
 23613        MOVE  1                  TO SET-CURSOR-SW
 23614        GO TO 7499-EXIT.
 23615
 23616**2654**
 23617
 23618     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2654
 23619        MOVE AL-UABON            TO BFREQA
 23620        MOVE -1                  TO BFREQL
 23621        MOVE  1                  TO SET-CURSOR-SW
 23622        GO TO 7499-EXIT.
 23623
 23624**2655**
 23625
 23626     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2655
 23627        MOVE AL-UABON            TO BFREQA
 23628        MOVE -1                  TO BFREQL
 23629        MOVE  1                  TO SET-CURSOR-SW
 23630        GO TO 7499-EXIT.
 23631
 23632**2656**
 23633
 23634     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2656
 23635        MOVE AL-UNBON            TO BAPRA
 23636        MOVE -1                  TO BAPRL
 23637        MOVE  1                  TO SET-CURSOR-SW
 23638        GO TO 7499-EXIT.
 23639
 23640**2657**
 23641
 23642     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23643        MOVE AL-UNBON            TO BAPRA
 23644        MOVE -1                  TO BAPRL
 23645        MOVE  1                  TO SET-CURSOR-SW
 23646        GO TO 7499-EXIT.
 23647
 23648**2658**
 23649
 23650     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2657
 23651        MOVE AL-UNBON            TO BTERM2A
 23652        MOVE -1                  TO BTERM2L
 23653        MOVE  1                  TO SET-CURSOR-SW
 23654        GO TO 7499-EXIT.
 23655
 23656**2660**
 23657
 23658     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2660
 23659        MOVE AL-UABON            TO BLSTNMA B1STNMA BINITA
 23660        MOVE -1                  TO BLSTNML
 23661        MOVE  1                  TO SET-CURSOR-SW
 23662        GO TO 7499-EXIT.
 23663
 23664
 23665**2662**
 23666
 23667     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2662
 23668        MOVE AL-UNBON            TO BAGEA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 437
* EL6311.cbl
 23669        MOVE -1                  TO BAGEL
 23670        MOVE  1                  TO SET-CURSOR-SW
 23671        GO TO 7499-EXIT.
 23672
 23673**2663**
 23674
 23675     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2663
 23676        MOVE AL-UNBON            TO BAGEA
 23677        MOVE -1                  TO BAGEL
 23678        MOVE  1                  TO SET-CURSOR-SW
 23679        GO TO 7499-EXIT.
 23680
 23681**2664**
 23682
 23683     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2664
 23684        MOVE AL-UABON            TO BREINA
 23685        MOVE -1                  TO BREINL
 23686        MOVE  1                  TO SET-CURSOR-SW
 23687        GO TO 7499-EXIT.
 23688
 23689**2667**
 23690
 23691     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2667
 23692        MOVE AL-UNBON            TO BBEN2A
 23693        MOVE -1                  TO BBEN2L
 23694        MOVE  1                  TO SET-CURSOR-SW
 23695        GO TO 7499-EXIT.
 23696
 23697**2668**
 23698
 23699     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2668
 23700        MOVE AL-UABON            TO BEFFDTA
 23701        GO TO 7499-EXIT.
 23702
 23703**2669**
 23704
 23705     IF PB-COMMON-ERROR (WS-SUB4) = ER-2669 OR ER-1570
 23706       OR ER-2077 OR ER-2628 OR ER-2661 OR ER-3054 OR ER-3504
 23707       OR ER-3513 OR ER-7144 OR ER-9063 OR ER-9076 OR ER-9618
 23708        MOVE AL-UNBON            TO BAGEA
 23709        MOVE -1                  TO BAGEL
 23710        MOVE  1                  TO SET-CURSOR-SW
 23711        GO TO 7499-EXIT.
 23712
 23713**2670**
 23714
 23715     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2670
 23716        MOVE AL-UABON            TO BFORCEA
 23717        MOVE -1                  TO BFORCEL
 23718        MOVE  1                  TO SET-CURSOR-SW
 23719        GO TO 7499-EXIT.
 23720
 23721**2671**
 23722
 23723     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2671
 23724        MOVE AL-UABON            TO BEFFDTA
 23725        GO TO 7499-EXIT.
 23726
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 438
* EL6311.cbl
 23727**2672**
 23728
 23729     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2672
 23730        MOVE AL-UABON            TO BEFFDTA
 23731        GO TO 7499-EXIT.
 23732
 23733**2673**
 23734
 23735     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23736        MOVE AL-UABON            TO BEFFDTA
 23737        GO TO 7499-EXIT.
 23738
 23739**2674**
 23740
 23741     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2673
 23742        MOVE AL-UABON            TO BTYPE1A BTYPE2A
 23743        MOVE -1                  TO BTYPE1L
 23744        MOVE  1                  TO SET-CURSOR-SW
 23745        GO TO 7499-EXIT.
 23746
 23747**2677**
 23748
 23749     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2677
 23750        MOVE AL-UNBON            TO BTERM1A
 23751        MOVE -1                  TO BTERM1L
 23752        MOVE  1                  TO SET-CURSOR-SW
 23753        GO TO 7499-EXIT.
 23754
 23755**2678**
 23756
 23757     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2678
 23758        MOVE AL-UNBON            TO BTERM2A
 23759        MOVE -1                  TO BTERM2L
 23760        MOVE  1                  TO SET-CURSOR-SW
 23761        GO TO 7499-EXIT.
 23762
 23763**2679**
 23764
 23765     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2679
 23766        MOVE AL-UABON            TO BTYPE1A
 23767        MOVE -1                  TO BTYPE1L
 23768        MOVE  1                  TO SET-CURSOR-SW
 23769        GO TO 7499-EXIT.
 23770
 23771**2680**
 23772
 23773     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2680
 23774        MOVE AL-UABOF            TO B1STPMTA
 23775        MOVE -1                  TO B1STPMTL
 23776        MOVE  1                  TO SET-CURSOR-SW
 23777        GO TO 7499-EXIT.
 23778
 23779**2681**
 23780
 23781     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2681
 23782        MOVE AL-UABON            TO BDAYSA
 23783        MOVE -1                  TO BDAYSL
 23784        MOVE  1                  TO SET-CURSOR-SW
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 439
* EL6311.cbl
 23785        GO TO 7499-EXIT.
 23786
 23787**2682**
 23788
 23789     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2682
 23790        MOVE AL-UABON            TO BTERM1A
 23791        MOVE -1                  TO BTERM1L
 23792        MOVE  1                  TO SET-CURSOR-SW
 23793        GO TO 7499-EXIT.
 23794
 23795**2683**
 23796
 23797     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2683
 23798        MOVE AL-UABON            TO BSKPCDA
 23799        MOVE -1                  TO BSKPCDL
 23800        MOVE  1                  TO SET-CURSOR-SW
 23801        GO TO 7499-EXIT.
 23802
 23803**2684**
 23804
 23805     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2684
 23806        MOVE AL-UABON            TO BTYPE2A
 23807        MOVE -1                  TO BTYPE2L
 23808        MOVE  1                  TO SET-CURSOR-SW
 23809        GO TO 7499-EXIT.
 23810
 23811**2686**
 23812
 23813     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2686
 23814        MOVE AL-UABON            TO BTYPE2A
 23815        MOVE -1                  TO BTYPE2L
 23816        MOVE  1                  TO SET-CURSOR-SW
 23817        GO TO 7499-EXIT.
 23818
 23819**2689**
 23820
 23821     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2689
 23822        MOVE AL-UABON            TO BSIGA
 23823        MOVE -1                  TO BSIGL
 23824        MOVE  1                  TO SET-CURSOR-SW
 23825        GO TO 7499-EXIT.
 23826
 23827**2690**
 23828
 23829     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2690
 23830        MOVE AL-UABOF            TO BLNOFCRA
 23831        MOVE -1                  TO BLNOFCRL
 23832        MOVE  1                  TO SET-CURSOR-SW
 23833        GO TO 7499-EXIT.
 23834
 23835**2693**
 23836
 23837     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2693
 23838        MOVE AL-UABOF            TO BLNOFCRA
 23839        MOVE AL-UNBON            TO BBEN1A
 23840        MOVE -1                  TO BBEN1L
 23841        MOVE  1                  TO SET-CURSOR-SW
 23842        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 440
* EL6311.cbl
 23843
 23844**2720**
 23845
 23846     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2720
 23847        MOVE AL-UNBON            TO BBEN1A
 23848        MOVE -1                  TO BBEN1L
 23849        MOVE  1                  TO SET-CURSOR-SW
 23850        GO TO 7499-EXIT.
 23851
 23852**2709**
 23853
 23854*    IF PB-COMMON-ERROR    (WS-SUB4) = ER-2709
 23855*       MOVE AL-UNBON            TO BBEN1A
 23856*       MOVE -1                  TO BBEN1L
 23857*       MOVE  1                  TO SET-CURSOR-SW
 23858*       GO TO 7499-EXIT.
 23859
 23860*************************************************************
 23861*                                                           *
 23862*            C A N C E L   E R R O R S                      *
 23863*                                                           *
 23864*************************************************************
 23865
 23866**2726**
 23867
 23868     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2726
 23869        MOVE AL-UABON            TO CCERTNOA
 23870        GO TO 7499-EXIT.
 23871
 23872**2728**
 23873
 23874     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2728
 23875        MOVE AL-UABON            TO CCERTNOA
 23876        GO TO 7499-EXIT.
 23877
 23878**2729**
 23879
 23880     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23881        MOVE AL-UABON            TO CCERTNOA
 23882        GO TO 7499-EXIT.
 23883
 23884**2730**
 23885
 23886     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2729
 23887        MOVE AL-UABON            TO CCERTNOA
 23888        GO TO 7499-EXIT.
 23889
 23890**2731**
 23891
 23892     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2731
 23893        MOVE AL-UABON            TO CCANDT1A
 23894        MOVE -1                  TO CCANDT1L
 23895        MOVE  1                  TO SET-CURSOR-SW
 23896        GO TO 7499-EXIT.
 23897
 23898**2732**
 23899
 23900     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2732
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 441
* EL6311.cbl
 23901        MOVE AL-UABON            TO CCANDT1A
 23902        MOVE -1                  TO CCANDT1L
 23903        MOVE  1                  TO SET-CURSOR-SW
 23904        GO TO 7499-EXIT.
 23905
 23906**2733**
 23907
 23908     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23909        MOVE AL-UABON            TO CCANDT1A
 23910        MOVE -1                  TO CCANDT1L
 23911        MOVE  1                  TO SET-CURSOR-SW
 23912        GO TO 7499-EXIT.
 23913
 23914**2734**
 23915
 23916     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2733
 23917        MOVE AL-UNBON            TO CREFND1A
 23918        MOVE -1                  TO CREFND1L
 23919        MOVE  1                  TO SET-CURSOR-SW
 23920        GO TO 7499-EXIT.
 23921
 23922**2735**
 23923
 23924     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23925        MOVE AL-UABON            TO CCANDT2A
 23926        MOVE -1                  TO CCANDT2L
 23927        MOVE  1                  TO SET-CURSOR-SW
 23928        GO TO 7499-EXIT.
 23929
 23930**2736**
 23931
 23932     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2735
 23933        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 23934            MOVE AL-UNBON        TO CREFND1A
 23935            MOVE -1              TO CREFND1L
 23936            MOVE  1              TO SET-CURSOR-SW
 23937            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23938                MOVE AL-UNBON        TO CREFND2A
 23939                MOVE -1              TO CREFND2L
 23940                MOVE  1              TO SET-CURSOR-SW
 23941                GO TO 7499-EXIT
 23942            ELSE
 23943                GO TO 7499-EXIT
 23944        ELSE
 23945            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 23946                MOVE AL-UNBON        TO CREFND2A
 23947                MOVE -1              TO CREFND2L
 23948                MOVE  1              TO SET-CURSOR-SW
 23949                GO TO 7499-EXIT
 23950            ELSE
 23951                GO TO 7499-EXIT.
 23952
 23953**2738**
 23954
 23955     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23956        MOVE -1                  TO CREFND2L
 23957        MOVE  1                  TO SET-CURSOR-SW
 23958        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 442
* EL6311.cbl
 23959
 23960**2739**
 23961
 23962     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23963        MOVE -1                  TO CREFND1L
 23964        MOVE  1                  TO SET-CURSOR-SW
 23965        GO TO 7499-EXIT.
 23966
 23967**2741**
 23968
 23969     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2738
 23970        MOVE -1                  TO CREFND1L
 23971        MOVE  1                  TO SET-CURSOR-SW
 23972        GO TO 7499-EXIT.
 23973
 23974**2743**
 23975
 23976     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2743
 23977        MOVE AL-UNBON            TO CCANDT1A
 23978        MOVE -1                  TO CCANDT1L
 23979        MOVE  1                  TO SET-CURSOR-SW
 23980        GO TO 7499-EXIT.
 23981
 23982**2744**
 23983
 23984     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2744
 23985        MOVE AL-UNBON            TO CCANDT2A
 23986        MOVE -1                  TO CCANDT2L
 23987        MOVE  1                  TO SET-CURSOR-SW
 23988        GO TO 7499-EXIT.
 23989
 23990**2747**
 23991
 23992     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2747
 23993        MOVE AL-UABON            TO CLSTNMA
 23994        MOVE -1                  TO CLSTNML
 23995        MOVE  1                  TO SET-CURSOR-SW
 23996        GO TO 7499-EXIT.
 23997
 23998**2749**
 23999
 24000     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2749
 24001        MOVE AL-UABON            TO CFORCEA
 24002        MOVE -1                  TO CFORCEL
 24003        MOVE  1                  TO SET-CURSOR-SW
 24004        GO TO 7499-EXIT.
 24005
 24006**2753**
 24007
 24008     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2753
 24009        MOVE AL-UNBON            TO CCANDT1A
 24010        MOVE -1                  TO CCANDT1L
 24011        MOVE  1                  TO SET-CURSOR-SW
 24012        GO TO 7499-EXIT.
 24013
 24014**2755**
 24015
 24016     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2755
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 443
* EL6311.cbl
 24017        IF  PB-C-LF-CANCEL-AMT GREATER THAN ZEROS
 24018            MOVE AL-UNBON        TO CREFND1A
 24019            MOVE -1              TO CREFND1L
 24020            MOVE  1              TO SET-CURSOR-SW
 24021            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24022                MOVE AL-UNBON        TO CREFND2A
 24023                MOVE -1              TO CREFND2L
 24024                MOVE  1              TO SET-CURSOR-SW
 24025                GO TO 7499-EXIT
 24026            ELSE
 24027                GO TO 7499-EXIT
 24028        ELSE
 24029            IF  PB-C-AH-CANCEL-AMT GREATER THAN ZEROS
 24030                MOVE AL-UNBON        TO CREFND2A
 24031                MOVE -1              TO CREFND2L
 24032                MOVE  1              TO SET-CURSOR-SW
 24033            ELSE
 24034                GO TO 7499-EXIT.
 24035
 24036**2757**
 24037
 24038     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2757
 24039        MOVE AL-UNBON            TO CLIVESA
 24040        MOVE -1                  TO CLIVESL
 24041        MOVE  1                  TO SET-CURSOR-SW
 24042        GO TO 7499-EXIT.
 24043
 24044**2771**
 24045
 24046     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2771
 24047        MOVE AL-UABON            TO CCANDT2A
 24048        MOVE -1                  TO CCANDT2L
 24049        MOVE  1                  TO SET-CURSOR-SW
 24050        GO TO 7499-EXIT.
 24051
 24052**2774**
 24053
 24054     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2774
 24055        MOVE AL-UABON            TO CCANDT1A
 24056        MOVE -1                  TO CCANDT1L
 24057        MOVE  1                  TO SET-CURSOR-SW
 24058        GO TO 7499-EXIT.
 24059
 24060**2775**
 24061
 24062     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2775
 24063        MOVE AL-UABON            TO CCANDT2A
 24064        MOVE -1                  TO CCANDT2L
 24065        MOVE  1                  TO SET-CURSOR-SW
 24066        GO TO 7499-EXIT.
 24067
 24068**2776**
 24069
 24070     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2776
 24071        MOVE AL-UABON            TO CCANDT1A
 24072        MOVE -1                  TO CCANDT1L
 24073        MOVE  1                  TO SET-CURSOR-SW
 24074        GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 444
* EL6311.cbl
 24075
 24076
 24077**2777**
 24078
 24079     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2777
 24080        MOVE AL-UABON            TO CCANDT2A
 24081        MOVE -1                  TO CCANDT2L
 24082        MOVE  1                  TO SET-CURSOR-SW
 24083        GO TO 7499-EXIT.
 24084
 24085**2794**
 24086
 24087     IF PB-COMMON-ERROR    (WS-SUB4) = ER-2794
 24088        MOVE AL-UABON            TO CFORCEA
 24089        MOVE -1                  TO CFORCEL
 24090        MOVE  1                  TO SET-CURSOR-SW
 24091        GO TO 7499-EXIT.
 24092
 24093**2799**
 24094
 24095     IF PI-COMPANY-ID = 'UCL'
 24096         IF PB-COMMON-ERROR    (WS-SUB4) = ER-2799
 24097             MOVE AL-UNBON            TO BEFFDTA
 24098             MOVE -1                  TO BEFFDTL
 24099             MOVE  1                  TO SET-CURSOR-SW
 24100             GO TO 7499-EXIT.
 24101
 24102 7499-EXIT.
 24103      EXIT.
 24104
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 445
* EL6311.cbl
 24106
 24107 7500-READ-ERLOFC.
 24108     MOVE SPACES                 TO  WS-LOAN-OFFICER
 24109                                     ERLOFC-KEY.
 24110
 24111     MOVE PI-COMPANY-CD          TO  ERLOFC-COMPANY-CD.
 24112
 24113     IF ST-ACCNT-CNTL
 24114         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24115
 24116     IF CARR-GROUP-ST-ACCNT-CNTL
 24117         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24118         MOVE PI-SV-STATE        TO  ERLOFC-STATE
 24119         MOVE PI-SV-GROUPING     TO  ERLOFC-GROUPING.
 24120
 24121     IF CARR-ST-ACCNT-CNTL
 24122         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER
 24123         MOVE PI-SV-STATE        TO  ERLOFC-STATE.
 24124
 24125     IF CARR-ACCNT-CNTL
 24126         MOVE PI-SV-CARRIER      TO  ERLOFC-CARRIER.
 24127
 24128     MOVE PI-PB-ACCOUNT          TO  ERLOFC-ACCOUNT.
 24129
 24130     MOVE BLNOFCRI               TO ERLOFC-OFFICER-CODE.
 24131
 24132
 24133* EXEC CICS HANDLE CONDITION
 24134*        NOTFND   (7550-OFFICER-NOTFND)
 24135*    END-EXEC.
 24136*    MOVE '"$I                   ! [ #00020339' TO DFHEIV0
 24137     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 24138     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24139     MOVE X'5B20233030303230333339' TO DFHEIV0(25:11)
 24140     CALL 'kxdfhei1' USING DFHEIV0
 24141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24142
 24143
 24144
 24145* EXEC CICS READ
 24146*        DATASET   (FILE-ID-ERLOFC)
 24147*        SET       (ADDRESS OF LOAN-OFFICER-MASTER)
 24148*        RIDFLD    (ERLOFC-KEY)
 24149*        EQUAL
 24150*    END-EXEC.
 24151*    MOVE '&"S        E          (   #00020343' TO DFHEIV0
 24152     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 24153     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24154     MOVE X'2020233030303230333433' TO DFHEIV0(25:11)
 24155     CALL 'kxdfhei1' USING DFHEIV0,
 24156           FILE-ID-ERLOFC,
 24157           DFHEIV20,
 24158           DFHEIV99,
 24159           ERLOFC-KEY,
 24160           DFHEIV99,
 24161           DFHEIV99,
 24162           DFHEIV99
 24163     SET ADDRESS OF LOAN-OFFICER-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 446
* EL6311.cbl
 24164         DFHEIV20
 24165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24166
 24167
 24168     GO TO 7599-EXIT.
 24169
 24170 7550-OFFICER-NOTFND.
 24171     MOVE 'X'                    TO WS-LOAN-OFFICER.
 24172
 24173 7599-EXIT.
 24174      EXIT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 447
* EL6311.cbl
 24176******************************************************************
 24177*                                                                *
 24178*            S  E N D    I N I T I A L   M A P                   *
 24179*                                                                *
 24180******************************************************************
 24181
 24182 8100-SEND-INITIAL-MAP.
 24183     MOVE EIBTIME                TO TIME-IN.
 24184
 24185     IF EIBAID = DFHPF11
 24186        MOVE 'Y'                 TO EMI-ROLL-SWITCH
 24187        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 24188
 24189
 24190     IF PI-COMPANY-ID = CLIENT-GIC
 24191        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24192                                       BCPREM-ATTRB (2).
 24193
 24194     IF PI-COMPANY-ID = (CLIENT-MIC OR
 24195                         CLIENT-PEM OR
 24196                         CLIENT-CSO)
 24197        AND PI-DISPLAY-ORIGINAL-BATCH
 24198          IF PI-MAP-NAME = EL631B
 24199             MOVE AL-SADOF               TO BPF5HDRA
 24200                                            BPF4HDRA
 24201          ELSE
 24202             IF PI-MAP-NAME = EL631C
 24203                MOVE AL-SADOF            TO CPF5HDRA
 24204                                            CPF4HDRA.
 24205
 24206     IF PI-MAP-NAME = EL631B
 24207        MOVE AL-SADOF               TO BPF5HDRA
 24208     ELSE
 24209        MOVE AL-SADOF               TO CPF5HDRA
 24210     END-IF
 24211
 24212*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24213     IF PI-MAP-NAME = EL631B
 24214          IF PI-COMPANY-ID NOT = 'DMD'
 24215             MOVE AL-SANOF            TO BBILLEDA
 24216             MOVE AL-SADOF            TO DMDBILA.
 24217*DMD CUSTOM CODING*************END
 24218
 24219     IF PI-PROCESSOR-ID = 'LGXX'
 24220        IF PI-MAP-NAME = EL631B
 24221           MOVE AL-SABOF                    TO BREFHDGA
 24222           MOVE AL-SANOF                    TO BREFA
 24223        ELSE
 24224           IF PI-MAP-NAME = EL631C
 24225              MOVE AL-SABOF                 TO CREFHDGA
 24226              MOVE AL-SANOF                 TO CREFA.
 24227
 24228     IF PI-COMPANY-ID = 'ACE' or 'LGX' or 'DCC' or 'VPP'
 24229        continue
 24230     ELSE
 24231        IF PI-MAP-NAME = EL631C
 24232           MOVE AL-SADOF         TO CCANTXTA
 24233                                    CCANFEEA
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 448
* EL6311.cbl
 24234        end-if
 24235     end-if
 24236     IF PI-MAP-NAME = EL631D
 24237        IF PI-AR-PROCESSING
 24238           MOVE AL-SANOF            TO DREFHDGA
 24239        ELSE
 24240           MOVE AL-SADOF            TO DREFHDGA.
 24241
 24242     IF (PI-COMPANY-ID NOT = 'DCC' and 'VPP' and 'CID')
 24243        AND (PI-MAP-NAME = EL631B)
 24244        MOVE AL-SADOF            TO BVINHA
 24245                                    BVINA
 24246     END-IF
 24247     IF PI-MAP-NAME = EL631B
 24248        MOVE PI-COMPANY-ID          TO BCOMPIDO
 24249        MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 24250                                 TO BREGIONO
 24251        MOVE PI-PROCESSOR-ID     TO BUSERO
 24252        IF CSR-EDIT-SESSION
 24253           MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24254                                 TO BHEADO
 24255           MOVE '4=B-HDR 6=RES'  TO BPF4HDRO
 24256        ELSE
 24257           MOVE AL-SADOF         TO BF15HDRA
 24258           MOVE '4=B-HDR      '  TO BPF4HDRO
 24259        END-IF
 24260        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24261        MOVE PI-LIFE-OVERRIDE-L2    TO BKIND1O
 24262        MOVE PI-AH-OVERRIDE-L2      TO BKIND2O
 24263        MOVE WS-CURRENT-DT          TO BDATEO
 24264        MOVE TIME-OUT               TO BTIMEO
 24265        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24266        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24267        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24268        IF   WS-DISPLAY-SCREEN
 24269             MOVE PB-ENTRY-BATCH    TO BBATCHO
 24270             MOVE PB-SV-CARRIER     TO BCARRO
 24271             MOVE PB-SV-GROUPING    TO BGROUPO
 24272             MOVE PB-SV-STATE       TO BSTATEO
 24273             MOVE PB-ACCOUNT        TO BACCTO
 24274        ELSE
 24275             MOVE PI-PB-ENTRY-BATCH TO BBATCHO
 24276     ELSE
 24277        IF PI-MAP-NAME = EL631C
 24278           MOVE '4=B-HDR      '     TO CPF4HDRO
 24279           IF CSR-EDIT-SESSION
 24280              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24281                                 TO CHEADO
 24282           ELSE
 24283              MOVE AL-SADOF      TO CF15HDRA
 24284           END-IF
 24285           MOVE PI-PB-ENTRY-BATCH      TO CBATCHO
 24286           MOVE WS-CURRENT-DT          TO CDATEO
 24287           MOVE TIME-OUT               TO CTIMEO
 24288           MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1O
 24289           MOVE PI-AH-OVERRIDE-L2      TO CKIND2O
 24290           MOVE PI-LIFE-OVERRIDE-L2    TO WS-REF-HDG-OVERRIDE
 24291           MOVE WS-C-HDG               TO CLFHDGO
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 449
* EL6311.cbl
 24292           MOVE PI-AH-OVERRIDE-L2      TO WS-REF-HDG-OVERRIDE
 24293           MOVE WS-C-HDG               TO CAHHDGO
 24294           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24295           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24296           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24297           IF   WS-DISPLAY-SCREEN
 24298                MOVE PB-ENTRY-BATCH    TO CBATCHO
 24299                MOVE PB-SV-CARRIER     TO CCARRO
 24300                MOVE PB-SV-GROUPING    TO CGROUPO
 24301                MOVE PB-SV-STATE       TO CSTATEO
 24302                MOVE PB-ACCOUNT        TO CACCTO
 24303           ELSE
 24304                MOVE PI-PB-ENTRY-BATCH TO CBATCHO
 24305        ELSE
 24306           MOVE WS-CURRENT-DT          TO DDATEO
 24307           MOVE TIME-OUT               TO DTIMEO
 24308           MOVE PI-LIFE-OVERRIDE-L2    TO WS-PREM-HDG-OVERRIDE
 24309                                          WS-REFUND-HDG-OVERRIDE
 24310           MOVE WS-D-PREM-HDG          TO DLFPHDGO
 24311           MOVE WS-D-REFUND-HDG        TO DLFRHDGO
 24312           MOVE PI-AH-OVERRIDE-L2      TO WS-PREM-HDG-OVERRIDE
 24313                                          WS-REFUND-HDG-OVERRIDE
 24314           MOVE WS-D-PREM-HDG          TO DAHPHDGO
 24315           MOVE WS-D-REFUND-HDG        TO DAHRHDGO
 24316           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO
 24317           IF CSR-EDIT-SESSION
 24318              MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
 24319                                 TO DHEADO
 24320           END-IF
 24321           IF  WS-DISPLAY-SCREEN
 24322               MOVE PB-ENTRY-BATCH     TO DBATCHO
 24323               MOVE PB-CARRIER         TO DCARRO
 24324               MOVE PB-GROUPING        TO DGROUPO
 24325               MOVE PB-STATE           TO DSTATEO
 24326               MOVE PB-ACCOUNT         TO DACCTO
 24327               MOVE PB-ACCOUNT-NAME    TO DACCTNMO
 24328           ELSE
 24329               MOVE EL631D             TO PI-MAP-NAME
 24330               MOVE PI-PB-ENTRY-BATCH  TO DBATCHO
 24331               MOVE PB-ACCOUNT-NAME TO DACCTNMO.
 24332
 24333     MOVE SPACE                        TO WS-DISPLAY-SW.
 24334
 24335
 24336* EXEC CICS SEND
 24337*        MAP      (PI-MAP-NAME)
 24338*        MAPSET   (MAPSET-EL6311S)
 24339*        FROM     (EL631BI)
 24340*        ERASE
 24341*        CURSOR
 24342*    END-EXEC.
 24343     MOVE LENGTH OF
 24344      EL631BI
 24345       TO DFHEIV12
 24346     MOVE -1
 24347       TO DFHEIV11
 24348*    MOVE '8$     CT  E    H L F ,   #00020517' TO DFHEIV0
 24349     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 450
* EL6311.cbl
 24350     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24351     MOVE X'2020233030303230353137' TO DFHEIV0(25:11)
 24352     CALL 'kxdfhei1' USING DFHEIV0,
 24353           PI-MAP-NAME,
 24354           EL631BI,
 24355           DFHEIV12,
 24356           MAPSET-EL6311S,
 24357           DFHEIV99,
 24358           DFHEIV99,
 24359           DFHEIV99,
 24360           DFHEIV11,
 24361           DFHEIV99,
 24362           DFHEIV99,
 24363           DFHEIV99
 24364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24365
 24366
 24367     GO TO 9100-RETURN-TRAN.
 24368
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 451
* EL6311.cbl
 24370
 24371******************************************************************
 24372*                                                                *
 24373*              S E N D    D A T A O N L Y                        *
 24374*                                                                *
 24375******************************************************************
 24376
 24377 8200-SEND-DATAONLY.
 24378     MOVE EIBTIME                TO TIME-IN.
 24379
 24380     IF PI-COMPANY-ID = CLIENT-GIC
 24381        MOVE AL-UNNOF               TO BCPREM-ATTRB (1)
 24382                                       BCPREM-ATTRB (2).
 24383
 24384     IF PI-MAP-NAME = EL631B
 24385        MOVE PI-MEMBER-CAPTION      TO BMEMCAPO
 24386        MOVE WS-CURRENT-DT          TO BDATEO
 24387        MOVE TIME-OUT               TO BTIMEO
 24388        MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 24389        MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 24390        MOVE EMI-MESSAGE-AREA (3)   TO BERMSG3O
 24391        MOVE SPACES                 TO BPFENTRO
 24392        MOVE AL-UANOF               TO BPFENTRA
 24393
 24394*DMD CUSTOM CODING*************START    DO IT WHEN SCREEN=EL631B &
 24395        IF PI-COMPANY-ID NOT = 'DMD'
 24396             MOVE AL-SANOF            TO BBILLEDA
 24397             MOVE AL-SADOF            TO DMDBILA
 24398         ELSE
 24399            NEXT SENTENCE
 24400*DMD CUSTOM CODING*************END
 24401     ELSE
 24402        IF PI-MAP-NAME = EL631C
 24403           MOVE WS-CURRENT-DT          TO CDATEO
 24404           MOVE TIME-OUT               TO CTIMEO
 24405           MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 24406           MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 24407           MOVE EMI-MESSAGE-AREA (3)   TO CERMSG3O
 24408           MOVE SPACES                 TO CPFENTRO
 24409           MOVE AL-UANOF               TO CPFENTRA
 24410        ELSE
 24411           MOVE WS-CURRENT-DT          TO DDATEO
 24412           MOVE TIME-OUT               TO DTIMEO
 24413           MOVE EMI-MESSAGE-AREA (1)   TO DERMSGO.
 24414
 24415
 24416* EXEC CICS SEND
 24417*        MAP      (PI-MAP-NAME)
 24418*        MAPSET   (MAPSET-EL6311S)
 24419*        FROM     (EL631BI)
 24420*        DATAONLY
 24421*        CURSOR
 24422*    END-EXEC.
 24423     MOVE LENGTH OF
 24424      EL631BI
 24425       TO DFHEIV12
 24426     MOVE -1
 24427       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 452
* EL6311.cbl
 24428*    MOVE '8$D    CT       H L F ,   #00020573' TO DFHEIV0
 24429     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 24430     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 24431     MOVE X'2020233030303230353733' TO DFHEIV0(25:11)
 24432     CALL 'kxdfhei1' USING DFHEIV0,
 24433           PI-MAP-NAME,
 24434           EL631BI,
 24435           DFHEIV12,
 24436           MAPSET-EL6311S,
 24437           DFHEIV99,
 24438           DFHEIV99,
 24439           DFHEIV99,
 24440           DFHEIV11,
 24441           DFHEIV99,
 24442           DFHEIV99,
 24443           DFHEIV99
 24444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24445
 24446
 24447     GO TO 9100-RETURN-TRAN.
 24448
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 453
* EL6311.cbl
 24450
 24451******************************************************************
 24452*                                                                *
 24453*           U T I L I T Y   R O U T I N E S                      *
 24454*                                                                *
 24455******************************************************************
 24456
 24457 8300-SEND-TEXT.
 24458
 24459* EXEC CICS SEND TEXT
 24460*        FROM     (LOGOFF-TEXT)
 24461*        LENGTH   (LOGOFF-LENGTH)
 24462*        ERASE
 24463*        FREEKB
 24464*    END-EXEC.
 24465*    MOVE '8&      T  E F  H   F -   #00020592' TO DFHEIV0
 24466     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 24467     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 24468     MOVE X'2020233030303230353932' TO DFHEIV0(25:11)
 24469     CALL 'kxdfhei1' USING DFHEIV0,
 24470           LOGOFF-TEXT,
 24471           LOGOFF-LENGTH,
 24472           DFHEIV99,
 24473           DFHEIV99,
 24474           DFHEIV99,
 24475           DFHEIV99,
 24476           DFHEIV99,
 24477           DFHEIV99,
 24478           DFHEIV99,
 24479           DFHEIV99,
 24480           DFHEIV99,
 24481           DFHEIV99
 24482     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24483
 24484
 24485
 24486* EXEC CICS RETURN
 24487*    END-EXEC.
 24488*    MOVE '.(                    ''   #00020599' TO DFHEIV0
 24489     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 24490     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24491     MOVE X'2020233030303230353939' TO DFHEIV0(25:11)
 24492     CALL 'kxdfhei1' USING DFHEIV0,
 24493           DFHEIV99,
 24494           DFHEIV99,
 24495           DFHEIV99,
 24496           DFHEIV99,
 24497           DFHEIV99,
 24498           DFHEIV99
 24499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24500
 24501
 24502 8400-LOG-JOURNAL-RECORD.
 24503     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 24504     MOVE THIS-PGM               TO JP-PROGRAM-ID.
 24505
 24506*    EXEC CICS JOURNAL
 24507*        JFILEID     (PI-JOURNAL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 454
* EL6311.cbl
 24508*        JTYPEID     ('EL')
 24509*        FROM        (JOURNAL-RECORD)
 24510*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 24511*    END-EXEC.
 24512
 24513 8600-DEEDIT.
 24514
 24515* EXEC CICS BIF DEEDIT
 24516*         FIELD   (DEEDIT-FIELD)
 24517*         LENGTH  (15)
 24518*    END-EXEC.
 24519     MOVE 15
 24520       TO DFHEIV11
 24521*    MOVE '@"L                   #   #00020614' TO DFHEIV0
 24522     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 24523     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 24524     MOVE X'2020233030303230363134' TO DFHEIV0(25:11)
 24525     CALL 'kxdfhei1' USING DFHEIV0,
 24526           DEEDIT-FIELD,
 24527           DFHEIV11
 24528     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24529
 24530
 24531 8800-UNAUTHORIZED-ACCESS.
 24532     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 24533     GO TO 8300-SEND-TEXT.
 24534
 24535 8810-PF23.
 24536     MOVE EIBAID                 TO PI-ENTRY-CD-1.
 24537     MOVE XCTL-EL005             TO PGM-NAME.
 24538     GO TO 9300-XCTL.
 24539
 24540 9100-RETURN-TRAN.
 24541     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 24542
 24543     IF  PI-MAP-NAME =  EL631B
 24544         MOVE '631B'             TO PI-CURRENT-SCREEN-NO.
 24545
 24546     IF  PI-MAP-NAME =  EL631C
 24547         MOVE '631C'             TO PI-CURRENT-SCREEN-NO.
 24548
 24549     IF  PI-MAP-NAME =  EL631D
 24550         MOVE '631D'             TO PI-CURRENT-SCREEN-NO.
 24551
 24552
 24553* EXEC CICS RETURN
 24554*        TRANSID    (TRANS-EXB1)
 24555*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24556*        LENGTH     (1300)
 24557*    END-EXEC.
 24558     MOVE 1300
 24559       TO DFHEIV11
 24560*    MOVE '.(CT                  ''   #00020640' TO DFHEIV0
 24561     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 24562     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 24563     MOVE X'2020233030303230363430' TO DFHEIV0(25:11)
 24564     CALL 'kxdfhei1' USING DFHEIV0,
 24565           TRANS-EXB1,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 455
* EL6311.cbl
 24566           PROGRAM-INTERFACE-BLOCK,
 24567           DFHEIV11,
 24568           DFHEIV99,
 24569           DFHEIV99,
 24570           DFHEIV99
 24571     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24572
 24573
 24574 9200-RETURN-MAIN-MENU.
 24575     MOVE XCTL-EL626             TO PGM-NAME.
 24576     GO TO 9300-XCTL.
 24577
 24578 9300-XCTL.
 24579
 24580* EXEC CICS XCTL
 24581*        PROGRAM    (PGM-NAME)
 24582*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 24583*        LENGTH     (PI-COMM-LENGTH)
 24584*    END-EXEC.
 24585*    MOVE '.$C                   %   #00020651' TO DFHEIV0
 24586     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 24587     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 24588     MOVE X'2020233030303230363531' TO DFHEIV0(25:11)
 24589     CALL 'kxdfhei1' USING DFHEIV0,
 24590           PGM-NAME,
 24591           PROGRAM-INTERFACE-BLOCK,
 24592           PI-COMM-LENGTH,
 24593           DFHEIV99
 24594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24595
 24596
 24597 9400-CLEAR.
 24598     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
 24599     GO TO 9300-XCTL.
 24600
 24601 9500-PF12.
 24602     MOVE XCTL-EL010             TO PGM-NAME.
 24603     GO TO 9300-XCTL.
 24604
 24605 9600-PGMID-ERROR.
 24606
 24607* EXEC CICS HANDLE CONDITION
 24608*        PGMIDERR    (8300-SEND-TEXT)
 24609*    END-EXEC.
 24610*    MOVE '"$L                   ! \ #00020666' TO DFHEIV0
 24611     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 24612     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 24613     MOVE X'5C20233030303230363636' TO DFHEIV0(25:11)
 24614     CALL 'kxdfhei1' USING DFHEIV0
 24615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24616
 24617
 24618     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 24619     MOVE ' '                    TO PI-ENTRY-CD-1.
 24620     MOVE XCTL-EL005             TO PGM-NAME.
 24621     MOVE PGM-NAME               TO LOGOFF-PGM.
 24622     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 24623     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 456
* EL6311.cbl
 24624
 24625 9700-DATE-LINK.
 24626     MOVE LINK-ELDATCV           TO PGM-NAME.
 24627
 24628* EXEC CICS LINK
 24629*        PROGRAM    (PGM-NAME)
 24630*        COMMAREA   (DATE-CONVERSION-DATA)
 24631*        LENGTH     (DC-COMM-LENGTH)
 24632*    END-EXEC.
 24633*    MOVE '."C                   (   #00020679' TO DFHEIV0
 24634     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24635     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24636     MOVE X'2020233030303230363739' TO DFHEIV0(25:11)
 24637     CALL 'kxdfhei1' USING DFHEIV0,
 24638           PGM-NAME,
 24639           DATE-CONVERSION-DATA,
 24640           DC-COMM-LENGTH,
 24641           DFHEIV99,
 24642           DFHEIV99,
 24643           DFHEIV99,
 24644           DFHEIV99
 24645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24646
 24647
 24648 9800-LINK-PENDING-EDIT.
 24649     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 24650     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 24651
 24652     MOVE LINK-EL050             TO PGM-NAME
 24653     MOVE PENDING-BUSINESS       TO PASSED-RECORD
 24654     MOVE ZEROS                  TO WK-CO-MAX-CAP
 24655                                    WK-CO-TOL-CLAIM
 24656                                    WK-CO-TOL-PREM
 24657                                    WK-CO-TOL-REFUND
 24658                                    WK-CO-TOL-PREM-PCT
 24659                                    WK-CO-TOL-REFUND-PCT
 24660                                    WK-REFUND-OVS-AMT
 24661                                    WK-REFUND-OVS-PCT
 24662                                    WK-ACCT-ADDR
 24663                                    WK-LIFE-EDIT-ADDR
 24664                                    WK-AH-EDIT-ADDR
 24665                                    WK-LIFE-BEN-ADDR
 24666                                    WK-AH-BEN-ADDR
 24667                                    WK-STATE-ADDR
 24668                                    WK-PLAN-ADDR
 24669                                    WK-FORM-ADDR
 24670     MOVE PI-CSR-SESSION-SW      TO WK-CSR-SESSION-SW
 24671
 24672     MOVE '6'                    TO WK-ENTRY-SW.
 24673
 24674     MOVE SPACES                 TO EDIT-CRITERIA-DATA.
 24675
 24676     MOVE LOW-VALUES             TO EC-CO-MONTH-END-DT
 24677                                    EC-AM-EXPIRATION-DT
 24678                                    EC-AM-EFFECTIVE-DT
 24679                                    EC-CM-LF-CANCEL-DT
 24680                                    EC-CM-AH-CANCEL-DT
 24681                                    EC-CM-DEATH-DT.
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 457
* EL6311.cbl
 24682
 24683     MOVE ZEROS                  TO EC-CO-TOL-PREM
 24684                                    EC-CO-TOL-REFUND
 24685                                    EC-CO-MIN-AGE
 24686                                    EC-CO-MIN-PREMIUM
 24687                                    EC-CO-MIN-TERM
 24688                                    EC-CO-MAX-TERM
 24689                                    EC-ST-TOL-PREM
 24690                                    EC-ST-TOL-REFUND
 24691                                    EC-AM-LF-TOL-PREM
 24692                                    EC-AM-AH-TOL-PREM
 24693                                    EC-AM-LF-MAX-ATT-AGE
 24694                                    EC-AM-LF-MAX-AGE
 24695                                    EC-AM-LF-MAX-TERM
 24696                                    EC-AM-LF-MAX-TOT-BEN
 24697                                    EC-AM-AH-MAX-ATT-AGE
 24698                                    EC-AM-AH-MAX-AGE
 24699                                    EC-AM-AH-MAX-TERM
 24700                                    EC-AM-AH-MAX-TOT-BEN
 24701                                    EC-AM-AH-MAX-MON-BEN
 24702                                    EC-RT-LF-MAX-ATT-AGE
 24703                                    EC-RT-LF-MAX-AGE
 24704                                    EC-RT-LF-MAX-TERM
 24705                                    EC-RT-LF-MAX-TOT-BEN
 24706                                    EC-RT-AH-MAX-ATT-AGE
 24707                                    EC-RT-AH-MAX-AGE
 24708                                    EC-RT-AH-MAX-TERM
 24709                                    EC-RT-AH-MAX-TOT-BEN
 24710                                    EC-RT-AH-MAX-MON-BEN
 24711                                    EC-RT-AH-RATE
 24712                                    EC-RT-LF-RATE
 24713                                    EC-RT-LF-NSP-RATE
 24714                                    EC-RT-AH-NSP-RATE
 24715                                    EC-CM-LF-PRIOR-REFUND
 24716                                    EC-CM-AH-PRIOR-REFUND.
 24717
 24718     MOVE ZEROS                  TO EC-CO-TOL-PREM-PCT
 24719                                    EC-ST-TOL-PREM-PCT
 24720                                    EC-AM-LF-TOL-REFUND
 24721                                    EC-AM-LF-DEV-PERCENT
 24722                                    EC-CO-TOL-REFUND-PCT
 24723                                    EC-ST-TOL-REFUND-PCT
 24724                                    EC-AM-AH-TOL-REFUND
 24725                                    EC-AM-AH-DEV-PERCENT.
 24726
 24727
 24728* EXEC CICS LINK
 24729*         PROGRAM   (PGM-NAME)
 24730*         COMMAREA  (PASSED-RECORD)
 24731*         LENGTH    (WS-EDIT-PASS-LENGTH)
 24732*    END-EXEC.
 24733*    MOVE '."C                   (   #00020764' TO DFHEIV0
 24734     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24735     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24736     MOVE X'2020233030303230373634' TO DFHEIV0(25:11)
 24737     CALL 'kxdfhei1' USING DFHEIV0,
 24738           PGM-NAME,
 24739           PASSED-RECORD,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 458
* EL6311.cbl
 24740           WS-EDIT-PASS-LENGTH,
 24741           DFHEIV99,
 24742           DFHEIV99,
 24743           DFHEIV99,
 24744           DFHEIV99
 24745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24746
 24747
 24748     MOVE '1'                    TO PI-EDIT-SW.
 24749     MOVE EDIT-CRITERIA-DATA     TO PI-CRITERIA-DATA.
 24750
 24751     MOVE PASSED-RECORD          TO PENDING-BUSINESS.
 24752
 24753     IF PI-COMPANY-ID = 'UCL'
 24754         MOVE EC-AM-EFFECTIVE-DT TO WS-CERT-EFF-DT.
 24755
 24756     IF VALID-PB-ID
 24757        GO TO 9800-EXIT.
 24758
 24759     MOVE PENDING-BUSINESS       TO EMI-LINE1.
 24760
 24761     IF PI-MAP-NAME = EL631B
 24762        MOVE -1                  TO BMAINTL
 24763       ELSE
 24764        MOVE -1                  TO CMAINTL.
 24765
 24766     GO TO 8200-SEND-DATAONLY.
 24767
 24768 9800-EXIT.
 24769      EXIT.
 24770
 24771 9900-ERROR-FORMAT.
 24772
 24773     MOVE PI-COMPANY-ID TO EMI-CLIENT-ID.
 24774
 24775     IF NOT EMI-ERRORS-COMPLETE
 24776         MOVE LINK-EL001         TO PGM-NAME
 24777
 24778* EXEC CICS LINK
 24779*            PROGRAM    (PGM-NAME)
 24780*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 24781*            LENGTH     (EMI-COMM-LENGTH)
 24782*        END-EXEC.
 24783*    MOVE '."C                   (   #00020799' TO DFHEIV0
 24784     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24785     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24786     MOVE X'2020233030303230373939' TO DFHEIV0(25:11)
 24787     CALL 'kxdfhei1' USING DFHEIV0,
 24788           PGM-NAME,
 24789           ERROR-MESSAGE-INTERFACE-BLOCK,
 24790           EMI-COMM-LENGTH,
 24791           DFHEIV99,
 24792           DFHEIV99,
 24793           DFHEIV99,
 24794           DFHEIV99
 24795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24796
 24797
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 459
* EL6311.cbl
 24798 9900-EXIT.
 24799     EXIT.
 24800
 24801 9990-ABEND.
 24802     MOVE LINK-EL004             TO PGM-NAME.
 24803     MOVE DFHEIBLK               TO EMI-LINE1.
 24804
 24805* EXEC CICS LINK
 24806*        PROGRAM   (PGM-NAME)
 24807*        COMMAREA  (EMI-LINE1)
 24808*        LENGTH    (72)
 24809*    END-EXEC.
 24810     MOVE 72
 24811       TO DFHEIV11
 24812*    MOVE '."C                   (   #00020811' TO DFHEIV0
 24813     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24814     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24815     MOVE X'2020233030303230383131' TO DFHEIV0(25:11)
 24816     CALL 'kxdfhei1' USING DFHEIV0,
 24817           PGM-NAME,
 24818           EMI-LINE1,
 24819           DFHEIV11,
 24820           DFHEIV99,
 24821           DFHEIV99,
 24822           DFHEIV99,
 24823           DFHEIV99
 24824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24825
 24826
 24827     IF PI-MAP-NAME = EL631B
 24828        MOVE -1                  TO BMAINTL
 24829       ELSE
 24830        MOVE -1                  TO CMAINTL.
 24831
 24832     IF EIBTRNID NOT = TRANS-EXB1
 24833        GO TO 8100-SEND-INITIAL-MAP
 24834       ELSE
 24835        GO TO 8200-SEND-DATAONLY.
 24836
 24837 9995-SECURITY-VIOLATION.
 24838*                            COPY ELCSCTP.
 24839******************************************************************
 24840*                                                                *
 24841*                            ELCSCTP                             *
 24842*                            VMOD=2.001                          *
 24843*                                                                *
 24844*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 24845******************************************************************
 24846
 24847
 24848     MOVE EIBDATE          TO SM-JUL-DATE.
 24849     MOVE EIBTRMID         TO SM-TERMID.
 24850     MOVE THIS-PGM         TO SM-PGM.
 24851     MOVE EIBTIME          TO TIME-IN.
 24852     MOVE TIME-OUT         TO SM-TIME.
 24853     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 24854
 24855
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 460
* EL6311.cbl
 24856* EXEC CICS LINK
 24857*         PROGRAM  ('EL003')
 24858*         COMMAREA (SECURITY-MESSAGE)
 24859*         LENGTH   (80)
 24860*    END-EXEC.
 24861     MOVE 'EL003' TO DFHEIV1
 24862     MOVE 80
 24863       TO DFHEIV11
 24864*    MOVE '."C                   (   #00020845' TO DFHEIV0
 24865     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 24866     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 24867     MOVE X'2020233030303230383435' TO DFHEIV0(25:11)
 24868     CALL 'kxdfhei1' USING DFHEIV0,
 24869           DFHEIV1,
 24870           SECURITY-MESSAGE,
 24871           DFHEIV11,
 24872           DFHEIV99,
 24873           DFHEIV99,
 24874           DFHEIV99,
 24875           DFHEIV99
 24876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 24877
 24878
 24879******************************************************************
 24880
 24881
 24882 9999-DFHBACK SECTION.
 24883     MOVE '9%                    "   ' TO DFHEIV0
 24884     MOVE 'EL6311' TO DFHEIV1
 24885     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 24886     GOBACK.
 24887 9999-DFHEXIT.
 24888     IF DFHEIGDJ EQUAL 0001
 24889         NEXT SENTENCE
 24890     ELSE IF DFHEIGDJ EQUAL 2
 24891         GO TO 9600-PGMID-ERROR,
 24892               9990-ABEND,
 24893               9990-ABEND,
 24894               0010-MAIN-LOGIC
 24895         DEPENDING ON DFHEIGDI
 24896     ELSE IF DFHEIGDJ EQUAL 3
 24897         GO TO 1280-BATCH-HDR-NOT-FOUND
 24898         DEPENDING ON DFHEIGDI
 24899     ELSE IF DFHEIGDJ EQUAL 4
 24900         GO TO 1290-DUPLICATE-ALT-INDEX
 24901         DEPENDING ON DFHEIGDI
 24902     ELSE IF DFHEIGDJ EQUAL 5
 24903         GO TO 1295-CERT-TRL-REC-NOTFND
 24904         DEPENDING ON DFHEIGDI
 24905     ELSE IF DFHEIGDJ EQUAL 6
 24906         GO TO 1380-BATCH-HDR-NOT-FOUND
 24907         DEPENDING ON DFHEIGDI
 24908     ELSE IF DFHEIGDJ EQUAL 7
 24909         GO TO 1385-REC-NOT-FOUND
 24910         DEPENDING ON DFHEIGDI
 24911     ELSE IF DFHEIGDJ EQUAL 8
 24912         GO TO 1386-NOTFND
 24913         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 461
* EL6311.cbl
 24914     ELSE IF DFHEIGDJ EQUAL 9
 24915         GO TO 1399-EXIT
 24916         DEPENDING ON DFHEIGDI
 24917     ELSE IF DFHEIGDJ EQUAL 10
 24918         GO TO 1480-BATCH-HDR-NOT-FOUND
 24919         DEPENDING ON DFHEIGDI
 24920     ELSE IF DFHEIGDJ EQUAL 11
 24921         GO TO 1490-RECORD-NOT-FOUND
 24922         DEPENDING ON DFHEIGDI
 24923     ELSE IF DFHEIGDJ EQUAL 12
 24924         GO TO 1405-DELETE-CERTIFICATE
 24925         DEPENDING ON DFHEIGDI
 24926     ELSE IF DFHEIGDJ EQUAL 13
 24927         GO TO 1420-CONTINUE-DELETE
 24928         DEPENDING ON DFHEIGDI
 24929     ELSE IF DFHEIGDJ EQUAL 14
 24930         GO TO 1406-DELETE-ERNOTE
 24931         DEPENDING ON DFHEIGDI
 24932     ELSE IF DFHEIGDJ EQUAL 15
 24933         GO TO 1407-DELETE-MAILING
 24934         DEPENDING ON DFHEIGDI
 24935     ELSE IF DFHEIGDJ EQUAL 16
 24936         GO TO 1420-CONTINUE-DELETE
 24937         DEPENDING ON DFHEIGDI
 24938     ELSE IF DFHEIGDJ EQUAL 17
 24939         GO TO 1480-BATCH-HDR-NOT-FOUND
 24940         DEPENDING ON DFHEIGDI
 24941     ELSE IF DFHEIGDJ EQUAL 18
 24942         GO TO 1475-DELETE-FINISHED
 24943         DEPENDING ON DFHEIGDI
 24944     ELSE IF DFHEIGDJ EQUAL 19
 24945         GO TO 2280-BATCH-HDR-NOT-FOUND
 24946         DEPENDING ON DFHEIGDI
 24947     ELSE IF DFHEIGDJ EQUAL 20
 24948         GO TO 2290-DUPLICATE-ALT-INDEX
 24949         DEPENDING ON DFHEIGDI
 24950     ELSE IF DFHEIGDJ EQUAL 21
 24951         GO TO 2380-BATCH-HDR-NOT-FOUND
 24952         DEPENDING ON DFHEIGDI
 24953     ELSE IF DFHEIGDJ EQUAL 22
 24954         GO TO 2385-REC-NOT-FOUND
 24955         DEPENDING ON DFHEIGDI
 24956     ELSE IF DFHEIGDJ EQUAL 23
 24957         GO TO 2380-BATCH-HDR-NOT-FOUND
 24958         DEPENDING ON DFHEIGDI
 24959     ELSE IF DFHEIGDJ EQUAL 24
 24960         GO TO 2485-BATCH-HDR-NOT-FOUND
 24961         DEPENDING ON DFHEIGDI
 24962     ELSE IF DFHEIGDJ EQUAL 25
 24963         GO TO 2490-RECORD-NOT-FOUND
 24964         DEPENDING ON DFHEIGDI
 24965     ELSE IF DFHEIGDJ EQUAL 26
 24966         GO TO 2475-CONTINUE-DELETE
 24967         DEPENDING ON DFHEIGDI
 24968     ELSE IF DFHEIGDJ EQUAL 27
 24969         GO TO 2485-BATCH-HDR-NOT-FOUND
 24970         DEPENDING ON DFHEIGDI
 24971     ELSE IF DFHEIGDJ EQUAL 28
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 462
* EL6311.cbl
 24972         GO TO 2480-DELETE-FINISHED
 24973         DEPENDING ON DFHEIGDI
 24974     ELSE IF DFHEIGDJ EQUAL 29
 24975         GO TO 2820-PROCESS-REWRITE
 24976         DEPENDING ON DFHEIGDI
 24977     ELSE IF DFHEIGDJ EQUAL 30
 24978         GO TO 2885-RECORD-MISSING
 24979         DEPENDING ON DFHEIGDI
 24980     ELSE IF DFHEIGDJ EQUAL 31
 24981         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24982         DEPENDING ON DFHEIGDI
 24983     ELSE IF DFHEIGDJ EQUAL 32
 24984         GO TO 2827-DELETE-MAILING
 24985         DEPENDING ON DFHEIGDI
 24986     ELSE IF DFHEIGDJ EQUAL 33
 24987         GO TO 2830-BUILD-NEW-ISSUE-RECORD
 24988         DEPENDING ON DFHEIGDI
 24989     ELSE IF DFHEIGDJ EQUAL 34
 24990         GO TO 2920-PROCESS-REWRITE
 24991         DEPENDING ON DFHEIGDI
 24992     ELSE IF DFHEIGDJ EQUAL 35
 24993         GO TO 2985-RECORD-MISSING
 24994         DEPENDING ON DFHEIGDI
 24995     ELSE IF DFHEIGDJ EQUAL 36
 24996         GO TO 2960-BUILD-NEW-CANCEL-RECORD
 24997         DEPENDING ON DFHEIGDI
 24998     ELSE IF DFHEIGDJ EQUAL 37
 24999         GO TO 2990-DUPLICATE-RECORD
 25000         DEPENDING ON DFHEIGDI
 25001     ELSE IF DFHEIGDJ EQUAL 38
 25002         GO TO 3590-NOT-FOUND
 25003         DEPENDING ON DFHEIGDI
 25004     ELSE IF DFHEIGDJ EQUAL 39
 25005         GO TO 3690-NOT-FOUND
 25006         DEPENDING ON DFHEIGDI
 25007     ELSE IF DFHEIGDJ EQUAL 40
 25008         GO TO 3990-NOT-FOUND
 25009         DEPENDING ON DFHEIGDI
 25010     ELSE IF DFHEIGDJ EQUAL 41
 25011         GO TO 4050-END-RECORDS,
 25012               4050-END-RECORDS
 25013         DEPENDING ON DFHEIGDI
 25014     ELSE IF DFHEIGDJ EQUAL 42
 25015         GO TO 4150-END-BATCH
 25016         DEPENDING ON DFHEIGDI
 25017     ELSE IF DFHEIGDJ EQUAL 43
 25018         GO TO 4150-END-BATCH
 25019         DEPENDING ON DFHEIGDI
 25020     ELSE IF DFHEIGDJ EQUAL 44
 25021         GO TO 4250-END-RECORDS,
 25022               4250-END-RECORDS
 25023         DEPENDING ON DFHEIGDI
 25024     ELSE IF DFHEIGDJ EQUAL 45
 25025         GO TO 4350-END-BATCH,
 25026               4350-END-BATCH
 25027         DEPENDING ON DFHEIGDI
 25028     ELSE IF DFHEIGDJ EQUAL 46
 25029         GO TO 4570-NOT-FOUND,
* Micro Focus Server Express         V5.1 revision 000 22-May-17 09:59 Page 463
* EL6311.cbl
 25030               4550-END-RECORDS
 25031         DEPENDING ON DFHEIGDI
 25032     ELSE IF DFHEIGDJ EQUAL 47
 25033         GO TO 4680-NOT-FOUND,
 25034               4680-NOT-FOUND
 25035         DEPENDING ON DFHEIGDI
 25036     ELSE IF DFHEIGDJ EQUAL 48
 25037         GO TO 4860-NOT-FOUND,
 25038               4850-END-RECORDS
 25039         DEPENDING ON DFHEIGDI
 25040     ELSE IF DFHEIGDJ EQUAL 49
 25041         GO TO 4970-NOT-FOUND,
 25042               4950-END-RECORDS
 25043         DEPENDING ON DFHEIGDI
 25044     ELSE IF DFHEIGDJ EQUAL 50
 25045         GO TO 5050-NOT-FOUND
 25046         DEPENDING ON DFHEIGDI
 25047     ELSE IF DFHEIGDJ EQUAL 51
 25048         GO TO 5050-NOT-FOUND
 25049         DEPENDING ON DFHEIGDI
 25050     ELSE IF DFHEIGDJ EQUAL 52
 25051         GO TO 5050-NOT-FOUND
 25052         DEPENDING ON DFHEIGDI
 25053     ELSE IF DFHEIGDJ EQUAL 53
 25054         GO TO 5550-END-RECORDS,
 25055               5550-END-RECORDS
 25056         DEPENDING ON DFHEIGDI
 25057     ELSE IF DFHEIGDJ EQUAL 54
 25058         GO TO 6050-QID-ERROR
 25059         DEPENDING ON DFHEIGDI
 25060     ELSE IF DFHEIGDJ EQUAL 55
 25061         GO TO 6050-QID-ERROR
 25062         DEPENDING ON DFHEIGDI
 25063     ELSE IF DFHEIGDJ EQUAL 56
 25064         GO TO 6400-CONTINUE,
 25065               6400-CONTINUE
 25066         DEPENDING ON DFHEIGDI
 25067     ELSE IF DFHEIGDJ EQUAL 57
 25068         GO TO 3690-NOT-FOUND
 25069         DEPENDING ON DFHEIGDI
 25070     ELSE IF DFHEIGDJ EQUAL 58
 25071         GO TO 7399-EXIT
 25072         DEPENDING ON DFHEIGDI
 25073     ELSE IF DFHEIGDJ EQUAL 59
 25074         GO TO 7550-OFFICER-NOTFND
 25075         DEPENDING ON DFHEIGDI
 25076     ELSE IF DFHEIGDJ EQUAL 60
 25077         GO TO 8300-SEND-TEXT
 25078         DEPENDING ON DFHEIGDI.
 25079     MOVE '9%                    "   ' TO DFHEIV0
 25080     MOVE 'EL6311' TO DFHEIV1
 25081     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 25082     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       15820     Code:       99263
