* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* SOCK03.cbl
* Options: int("SOCK03.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK03.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK03.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK03.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2001 by Sun Microsystems, Inc.                  *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK03.
     9*         This program is the first invoked by the SOC3
    10*         transaction. This transaction must be submited
    11*         by a message transmited over a stream socket.
    12*         The message format is:
    13*         xxxx,12345678901234567890123456789012345
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* SOCK03.cbl
    14*         where "xxxx" is the tran id SOCK (1 to 4 characters)
    15*         and "123456.........5" is up to 35 characters of
    16*         optional text.
    17*         Information on the originating message and
    18*         remote socket is provided in the DFHCOMMAREA.
    19*         As its first action this program must send a
    20*         message to the requesting socket. This lets the
    21*         remote program know its request has been
    22*         accepted and the transaction started.
    23*         The program will make four transmissions to
    24*         the initating program in response to received
    25*         messages and then close the socket.
    26*         This program is provided to show method and
    27*         has minimal checking and error messages.
    28*         The Cobol compiler, unless instructed otherwise,
    29*         will hold its working storage integer data items in
    30*         machine idependent form. This matches the network
    31*         ordering of information. Care should be exercised
    32*         to ensure that this data ordering is correct when
    33*         calling system library functions or passing data
    34*         structure containing such data to functions.
    35******************************************************************
    36*                   C H A N G E   L O G
    37*
    38* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    39*-----------------------------------------------------------------
    40*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    41* EFFECTIVE    NUMBER
    42*-----------------------------------------------------------------
    43* 071112  IR2012042700001  PEMA  AHL CHANGES
    44******************************************************************
    45 environment division.
    46 data division.
    47 working-storage section.
    48 01  DFH-START PIC X(04).
    49*
    50* program buffers
    51*
    52 77  WS-BUFF-SENT-SW             PIC X  VALUE SPACES.
    53     88  ALREADY-SENT              VALUE 'Y'.
    54 77  WS-LENGTH                   PIC S9(4) COMP VALUE +0.
    55 77  WS-ELCERT-SW                PIC X  VALUE SPACES.
    56     88  ELCERT-FINISHED            VALUE 'Y'.
    57 77  WS-BIN-EFF-DT               PIC XX VALUE LOW-VALUES.
    58 77  WS-ERACCT-SW                PIC X VALUE SPACES.
    59     88  ERACCT-FOUND               VALUE 'Y'.
    60 77  WS-FREE-LOOK                PIC S999 COMP-3 VALUE +0.
    61 77 ws-send-msg-size           pic s9(8) comp value 4096.
    62 77 ws-recv-msg-size           pic s9(8) comp value 4096.
    63 77 ws-recv-buf                pic x(4096).
    64 77 ws-send-buf                pic x(4096) VALUE SPACES.
    65 77 ws-recv-total              pic s9(8) comp value 0.
    66 77 ws-recv-left               pic s9(8) comp value 0.
    67 77 ws-seq-num                 pic s9(8) comp value 0.
    68 77 ws-flags                   pic s9(8) comp value 0.
    69 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    70 77  WS-COMP-ID                  PIC XXX  VALUE SPACES.
    71 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* SOCK03.cbl
    72 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    73 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    74 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    75 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    76 77 S1                           PIC S999 COMP-3 VALUE +0.
    77 77 S2                           PIC S999 COMP-3 VALUE +0.
    78 77 L1                           PIC S999 COMP-3 VALUE +0.
    79 77 L2                           PIC S999 COMP-3 VALUE +0.
    80 77 F1                           PIC S999 COMP-3 VALUE +0.
    81 77 WS-BUILD-SW                  PIC X.
    82    88  TIME-TO-BUILD               VALUE 'Y'.
    83 77 WS-SAVE-ERACCT               PIC X(2000).
    84 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    85 77 WS-STOP-SW                   PIC X  VALUE ' '.
    86    88  TOLD-TO-STOP               VALUE 'Y'.
    87 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    88    88  GET-RATES                    VALUE 'R'.
    89    88  GET-ACT-ACCTS                VALUE 'A'.
    90 77 ws-bin-1st-pay-dt            pic xx  value low-values.
    91 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    92 77 ws-disp-rate                 pic z9.99999.
    93 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    94     88  END-OF-ERCTBL                 VALUE 'Y'.
    95 77  WS-STATUS                   PIC X.
    96 77  WS-CF-DEFAULT-APR           PIC S9(03)V9(04) COMP-3.
    97 77  WS-CF-CR-R78-METHOD         PIC X          VALUE SPACE.
    98 77  WS-CF-CR-REM-TERM-CALC      PIC X          VALUE SPACE.
    99 77  WS-BIN-VAL-DT               PIC XX         VALUE LOW-VALUES.
   100 77  WS-TOT-LF-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   101 77  WS-TOT-AH-RFND              PIC S9(7)V99  COMP-3 VALUE +0.
   102 77  WS-TOT-LF-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   103 77  WS-TOT-AH-PREM              PIC S9(7)V99  COMP-3 VALUE +0.
   104 77  WS-TOT-LF-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   105 77  WS-TOT-AH-COMM              PIC S9(7)V99  COMP-3 VALUE +0.
   106 77  WS-WORK-FACTOR              PIC S9V9(7)   COMP-3 VALUE +0.
   107 77  WS-ELCERT-KEY-SW            PIC X  VALUE SPACES.
   108     88  WS-ELCERT-FULL             VALUE '1'.
   109     88  WS-ELCERT-NAME             VALUE '2'.
   110     88  WS-ELCERT-CERT-NO          VALUE '3'.
   111     88  WS-ELCERT-ACT-NAME         VALUE '4'.
   112 77  ELMSTR-LENGTH               PIC S9(4) COMP VALUE +12.
   113 77  WS-CLM-STOP-SW              PIC X  VALUE ' '.
   114     88  I-SAY-TO-STOP      VALUE 'Y'.
   115 77  WS-HEX-0A                   PIC X.
   116 77  WS-CALL-TYPE                PIC X(6).
   117 77  WS-NCB-DIFF-MONTHS          PIC 999   VALUE ZEROS.
   118 77  WS-NCB-DIFF-ODD-DAYS        PIC 999   VALUE ZEROS.
   119 77  WS-STATE-EXT-DAYS-CHG       PIC X  VALUE ' '.
   120 01  WS-STRING-DATA.
   121     05  WS-COMMENT              PIC X(30)    VALUE SPACES.
   122     05  WS-RESP                 PIC 99999    VALUE ZEROS.
   123     05  WS-CARRIER              PIC X        VALUE SPACES.
   124     05  WS-GROUPING             PIC X(6)     VALUE SPACES.
   125     05  WS-STATE                PIC XX       VALUE SPACES.
   126     05  WS-ACCOUNT              PIC X(10)    VALUE SPACES.
   127     05  WS-CERT-NO              PIC X(11)    VALUE SPACES.
   128     05  WS-CERT-EFF-DATE        PIC 9(8)     VALUE ZEROS.
   129     05  WS-LAST-NAME            PIC X(15)    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* SOCK03.cbl
   130     05  WS-FIRST-NAME           PIC X(15)    VALUE SPACES.
   131     05  WS-MID-INIT             PIC X        VALUE SPACES.
   132     05  WS-POST-CARD-SW         PIC X        VALUE SPACES.
   133     05  WS-LF-STATUS            PIC X        VALUE SPACES.
   134     05  WS-LF-BEN-CODE          PIC XX       VALUE SPACES.
   135     05  WS-LF-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   136     05  WS-LF-TERM              PIC 999      VALUE ZEROS.
   137     05  WS-LF-REM-TERM          PIC 999      VALUE ZEROS.
   138     05  WS-LF-PREM              PIC 9(7).99  VALUE ZEROS.
   139     05  WS-LF-REFUND            PIC 9(7).99  VALUE ZEROS.
   140     05  WS-LF-METHOD            PIC X(10)    VALUE SPACES.
   141     05  WS-LF-ORIG-BENEFIT      PIC 9(9).99  VALUE ZEROS.
   142     05  WS-LF-REM-BEN           PIC 9(9).99  VALUE ZEROS.
   143     05  WS-AH-STATUS            PIC X        VALUE SPACES.
   144     05  WS-AH-BEN-CODE          PIC XX       VALUE SPACES.
   145     05  WS-AH-BEN-CODE-DESC     PIC X(10)    VALUE SPACES.
   146     05  WS-AH-TERM              PIC 999      VALUE ZEROS.
   147     05  WS-AH-REM-TERM          PIC 999      VALUE ZEROS.
   148     05  WS-AH-PREM              PIC 9(7).99  VALUE ZEROS.
   149     05  WS-AH-REFUND            PIC 9(7).99  VALUE ZEROS.
   150     05  WS-AH-METHOD            PIC X(10)    VALUE SPACES.
   151     05  WS-AH-ORIG-BENEFIT      PIC 9(7).99  VALUE ZEROS.
   152     05  WS-AH-REM-BEN           PIC 9(7).99  VALUE ZEROS.
   153     05  WS-ACCOUNT-NAME         PIC X(30)    VALUE SPACES.
   154     05  WS-REPORT-CODE-1        PIC X(10)    VALUE SPACES.
   155     05  WS-REPORT-CODE-2        PIC X(10)    VALUE SPACES.
   156     05  WS-REPORT-CODE-3        PIC X(10)    VALUE SPACES.
   157     05  WS-LF-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   158     05  WS-AH-EXPIRE-DATE       PIC 9(8)     VALUE ZEROS.
   159     05  WS-LF-COMM              PIC 9(7).99  VALUE ZEROS.
   160     05  WS-AH-COMM              PIC 9(7).99  VALUE ZEROS.
   161     05  WS-LF-UEC               PIC 9(7).99  VALUE ZEROS.
   162     05  WS-AH-UEC               PIC 9(7).99  VALUE ZEROS.
   163     05  WS-LAST-JNAME           PIC X(15)    VALUE SPACES.
   164     05  WS-FIRST-JNAME          PIC X(15)    VALUE SPACES.
   165     05  WS-MID-JINIT            PIC X        VALUE SPACES.
   166     05  WS-CLM-PAID-THRU-DT     PIC 9(8)   VALUE ZEROS.
   167     05  WS-LF-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   168     05  WS-AH-BIN-PAID-THRU-DT  PIC XX     VALUE LOW-VALUES.
   169 01  ws-work-date.
   170     05  ws-work-ccyy            pic x(4).
   171     05  ws-work-mm              pic xx.
   172     05  ws-work-dd              pic xx.
   173 01  ws-work-date-num redefines ws-work-date
   174                                 pic 9(8).
   175 01  FILLER.
   176     12  WS-CF-REM-TRM-CALC-OPTION PIC X  VALUE SPACE.
   177     12  WS-BALLOON-RTRM         PIC 999  VALUE ZEROS.
   178     12  WS-STATE-ABBREVIATION   PIC XX.
   179     12  WS-ACCT-USER-FLD-5      PIC  X(02).
   180     12  WS-AH-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   181     12  WS-AH-BEN-CATEGORY      PIC  X          VALUE SPACE.
   182     12  WS-LF-SPECIAL-CALC-CD   PIC  X(01)      VALUE SPACE.
   183     12  WS-AH-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   184     12  WS-LF-CO-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   185     12  WS-AH-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   186     12  WS-LF-CO-EARNINGS-CALC  PIC  X(01)      VALUE SPACE.
   187     12  WS-AH-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* SOCK03.cbl
   188     12  WS-LF-CO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   189     12  WS-AH-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   190     12  WS-LF-ST-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   191     12  WS-AH-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   192     12  WS-LF-FO-REFUND-CALC    PIC  X(01)      VALUE SPACE.
   193     12  WS-AH-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   194     12  WS-LF-ST-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   195     12  WS-AH-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   196     12  WS-LF-AM-REM-TERM-CALC  PIC  X(01)      VALUE SPACE.
   197     12  WS-AM-EARN-METHOD-A     PIC  X(01)      VALUE SPACE.
   198     12  WS-AM-EARN-METHOD-L     PIC  X(01)      VALUE SPACE.
   199     12  WS-AM-EARN-METHOD-R     PIC  X(01)      VALUE SPACE.
   200     12  WS-LF-OVERRIDE-L1       PIC  X(01).
   201     12  WS-LF-OVERRIDE-L2       PIC  X(02).
   202     12  WS-AH-OVERRIDE-L1       PIC  X(01).
   203     12  WS-AH-OVERRIDE-L2       PIC  X(02).
   204     12  WS-CF-LF-COVERAGE-TYPE  PIC  X(01)      VALUE SPACE.
   205         88  WS-REDUCING                         VALUE 'R'.
   206         88  WS-LEVEL                            VALUE 'L'  'P'.
   207 01  ELMSTR-KEY.
   208     12  ELMSTR-COMP-CD          PIC X.
   209     12  ELMSTR-CERT-NO          PIC X(11).
   210 01  WS-AM3-KEY.
   211     12  WS-AM3-ACCOUNT          PIC X(10).
   212     12  WS-AM3-EXP-DT           PIC XX.
   213 01  WS-AM-KEY.
   214     12  WS-AM-COMPANY-CD        PIC X.
   215     12  WS-AM-CARRIER           PIC X.
   216     12  WS-AM-GROUPING          PIC X(6).
   217     12  WS-AM-STATE             PIC XX.
   218     12  WS-AM-ACCOUNT           PIC X(10).
   219     12  WS-AM-EXPIRATION-DT     PIC XX.
   220     12  WS-AM-FILLER            PIC XXXX.
   221 01  WS-CO-DATA.
   222     05  WS-CO-NUM               PIC X(10).
   223     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   224     05  WS-CO-NAME              PIC X(30).
   225     05  WS-CO-MAIL-NAME         PIC X(30).
   226     05  WS-CO-ADDR1             PIC X(30).
   227     05  WS-CO-ADDR2             PIC X(30).
   228     05  WS-CO-ADDR3             PIC X(30).
   229     05  WS-CO-ZIP               PIC X(9).
   230     05  WS-CO-PHONE             PIC X(10).
   231 01  WS-CF-KEY.
   232     12  WS-CF-COMPANY-ID        PIC  X(03)      VALUE SPACES.
   233     12  WS-CF-RECORD-TYPE       PIC  X(01)      VALUE ZERO.
   234*        88  COMPANY-MASTER                      VALUE '1'.
   235*        88  STATE-MASTER                        VALUE '3'.
   236*        88  LF-BENEFIT-MASTER                   VALUE '4'.
   237*        88  AH-BENEFIT-MASTER                   VALUE '5'.
   238     12  WS-CF-ACCESS.
   239         16  WS-CF-STATE         PIC  X(02)      VALUE SPACES.
   240         16  WS-CF-BENEFIT-NO                    VALUE SPACES.
   241             20  FILLER          PIC  X(01).
   242             20  WS-CF-CARRIER   PIC  X(01).
   243     12  WS-CF-SEQUENCE-NO       PIC S9(04) COMP VALUE ZERO.
   244 01  WS-CM-KEY.
   245     05  WS-CM-COMPANY-CD        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* SOCK03.cbl
   246     05  WS-CM-CARRIER           PIC X.
   247     05  WS-CM-GROUP             PIC X(6).
   248     05  WS-CM-STATE             PIC XX.
   249     05  WS-CM-ACCOUNT           PIC X(10).
   250     05  WS-CM-EFF-DT            PIC XX.
   251     05  WS-CM-CERT-NO           PIC X(11).
   252 01  WS-CM-KEY-A1.
   253     05  WS-CM-COMPANY-CD-A1     PIC X.
   254     05  WS-CM-LAST-NAME         PIC X(15).
   255     05  WS-CM-INITIALS          PIC XX.
   256 01  WS-CM-KEY-A4.
   257     05  WS-CM-COMPANY-CD-A4     PIC X.
   258     05  WS-CM-CERT-NO-A4        PIC X(11).
   259 01  WS-CID-NO                   PIC X(8).
   260 01  WS-DISP-RESP                PIC 9(5).
   261 01  WS-RESPONSE                 PIC S9(8)   COMP.
   262     88  RESP-NORMAL                  VALUE +00.
   263     88  RESP-NOTFND                  VALUE +13.
   264     88  RESP-DUPKEY                  VALUE +15.
   265     88  RESP-NOTOPEN                 VALUE +19.
   266     88  RESP-ENDFILE                 VALUE +20.
   267*                                 COPY ELCCERT.
   268******************************************************************
   269*                                                                *
   270*                            ELCCERT.                            *
   271*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   272*                            VMOD=2.013                          *
   273*                                                                *
   274*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   275*                                                                *
   276*   FILE TYPE = VSAM,KSDS                                        *
   277*   RECORD SIZE = 450  RECFORM = FIXED                           *
   278*                                                                *
   279*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   280*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   281*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   282*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   283*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   284*                                                                *
   285*   LOG = YES                                                    *
   286*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   287******************************************************************
   288*                   C H A N G E   L O G
   289*
   290* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   291*-----------------------------------------------------------------
   292*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   293* EFFECTIVE    NUMBER
   294*-----------------------------------------------------------------
   295* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   296* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   297* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   298* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   299* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   300* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   301* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   302* 032612  CR2011110200001  PEMA  AHL CHANGES
   303******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* SOCK03.cbl
   304
   305 01  CERTIFICATE-MASTER.
   306     12  CM-RECORD-ID                      PIC XX.
   307         88  VALID-CM-ID                      VALUE 'CM'.
   308
   309     12  CM-CONTROL-PRIMARY.
   310         16  CM-COMPANY-CD                 PIC X.
   311         16  CM-CARRIER                    PIC X.
   312         16  CM-GROUPING.
   313             20  CM-GROUPING-PREFIX        PIC X(3).
   314             20  CM-GROUPING-PRIME         PIC X(3).
   315         16  CM-STATE                      PIC XX.
   316         16  CM-ACCOUNT.
   317             20  CM-ACCOUNT-PREFIX         PIC X(4).
   318             20  CM-ACCOUNT-PRIME          PIC X(6).
   319         16  CM-CERT-EFF-DT                PIC XX.
   320         16  CM-CERT-NO.
   321             20  CM-CERT-PRIME             PIC X(10).
   322             20  CM-CERT-SFX               PIC X.
   323
   324     12  CM-CONTROL-BY-NAME.
   325         16  CM-COMPANY-CD-A1              PIC X.
   326         16  CM-INSURED-LAST-NAME          PIC X(15).
   327         16  CM-INSURED-INITIALS.
   328             20  CM-INSURED-INITIAL1       PIC X.
   329             20  CM-INSURED-INITIAL2       PIC X.
   330
   331     12  CM-CONTROL-BY-SSN.
   332         16  CM-COMPANY-CD-A2              PIC X.
   333         16  CM-SOC-SEC-NO.
   334             20  CM-SSN-STATE              PIC XX.
   335             20  CM-SSN-ACCOUNT            PIC X(6).
   336             20  CM-SSN-LN3.
   337                 25  CM-INSURED-INITIALS-A2.
   338                     30 CM-INSURED-INITIAL1-A2   PIC X.
   339                     30 CM-INSURED-INITIAL2-A2   PIC X.
   340                 25 CM-PART-LAST-NAME-A2         PIC X.
   341
   342     12  CM-CONTROL-BY-CERT-NO.
   343         16  CM-COMPANY-CD-A4              PIC X.
   344         16  CM-CERT-NO-A4                 PIC X(11).
   345
   346     12  CM-CONTROL-BY-MEMB.
   347         16  CM-COMPANY-CD-A5              PIC X.
   348         16  CM-MEMBER-NO.
   349             20  CM-MEMB-STATE             PIC XX.
   350             20  CM-MEMB-ACCOUNT           PIC X(6).
   351             20  CM-MEMB-LN4.
   352                 25  CM-INSURED-INITIALS-A5.
   353                     30 CM-INSURED-INITIAL1-A5   PIC X.
   354                     30 CM-INSURED-INITIAL2-A5   PIC X.
   355                 25 CM-PART-LAST-NAME-A5         PIC XX.
   356
   357     12  CM-INSURED-PROFILE-DATA.
   358         16  CM-INSURED-FIRST-NAME.
   359             20  CM-INSURED-1ST-INIT       PIC X.
   360             20  FILLER                    PIC X(9).
   361         16  CM-INSURED-ISSUE-AGE          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* SOCK03.cbl
   362         16  CM-INSURED-SEX                PIC X.
   363             88  CM-SEX-MALE                  VALUE 'M'.
   364             88  CM-SEX-FEMAL                 VALUE 'F'.
   365         16  CM-INSURED-JOINT-AGE          PIC 99.
   366         16  CM-JOINT-INSURED-NAME.
   367             20  CM-JT-LAST-NAME           PIC X(15).
   368             20  CM-JT-FIRST-NAME.
   369                 24  CM-JT-1ST-INIT        PIC X.
   370                 24  FILLER                PIC X(9).
   371             20  CM-JT-INITIAL             PIC X.
   372
   373     12  CM-LIFE-DATA.
   374         16  CM-LF-BENEFIT-CD              PIC XX.
   375         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
   376         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   377         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   378         16  CM-LF-DEV-CODE                PIC XXX.
   379         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   380         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   381         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   382         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   383         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   384         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   385         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   386         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   387         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   388         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   389         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   390         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   391         16  FILLER                        PIC XX.
   392
   393     12  CM-AH-DATA.
   394         16  CM-AH-BENEFIT-CD              PIC XX.
   395         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   396         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   397         16  CM-AH-DEV-CODE                PIC XXX.
   398         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   399         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   400         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   401         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   402         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   403         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   404         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   405         16  CM-AH-PAID-THRU-DT            PIC XX.
   406             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   407         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   408         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
   409         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   410         16  FILLER                        PIC X.
   411
   412     12  CM-LOAN-INFORMATION.
   413         16  CM-LIVES                      PIC S9(7)     COMP-3.
   414         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   415                                           PIC S9(5)V99  COMP-3.
   416         16  CM-BILLED                     PIC S9(7)     COMP-3.
   417         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   418         16  CM-PAY-FREQUENCY              PIC S99.
   419         16  CM-LOAN-TERM                  PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* SOCK03.cbl
   420         16  CM-RATE-CLASS                 PIC XX.
   421         16  CM-BENEFICIARY                PIC X(25).
   422         16  CM-POLICY-FORM-NO             PIC X(12).
   423         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   424         16  CM-LAST-ADD-ON-DT             PIC XX.
   425         16  CM-DEDUCTIBLE-AMOUNTS.
   426             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   427             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   428         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   429             20  CM-RESIDENT-STATE         PIC XX.
   430             20  CM-RATE-CODE              PIC X(4).
   431             20  FILLER                    PIC XX.
   432         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   433             20  CM-LOAN-OFFICER           PIC X(5).
   434             20  FILLER                    PIC XXX.
   435         16  CM-CSR-CODE                   PIC XXX.
   436         16  CM-UNDERWRITING-CODE          PIC X.
   437             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   438         16  CM-POST-CARD-IND              PIC X.
   439         16  CM-NH-INTERFACE-SW            PIC X.
   440         16  CM-PREMIUM-TYPE               PIC X.
   441             88  CM-SING-PRM                  VALUE '1'.
   442             88  CM-O-B-COVERAGE              VALUE '2'.
   443             88  CM-OPEN-END                  VALUE '3'.
   444         16  CM-IND-GRP-TYPE               PIC X.
   445             88  CM-INDIVIDUAL                VALUE 'I'.
   446             88  CM-GROUP                     VALUE 'G'.
   447         16  CM-SKIP-CODE                  PIC X.
   448             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   449             88  SKIP-JULY                    VALUE '1'.
   450             88  SKIP-AUGUST                  VALUE '2'.
   451             88  SKIP-SEPTEMBER               VALUE '3'.
   452             88  SKIP-JULY-AUG                VALUE '4'.
   453             88  SKIP-AUG-SEPT                VALUE '5'.
   454             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   455             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   456             88  SKIP-JUNE                    VALUE '8'.
   457             88  SKIP-JUNE-JULY               VALUE '9'.
   458             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   459             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   460         16  CM-PAYMENT-MODE               PIC X.
   461             88  PAY-MONTHLY                  VALUE SPACE.
   462             88  PAY-WEEKLY                   VALUE '1'.
   463             88  PAY-SEMI-MONTHLY             VALUE '2'.
   464             88  PAY-BI-WEEKLY                VALUE '3'.
   465             88  PAY-SEMI-ANUALLY             VALUE '4'.
   466         16  CM-LOAN-NUMBER                PIC X(8).
   467         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   468         16  CM-OLD-LOF                    PIC XXX.
   469*        16  CM-LOAN-OFFICER               PIC XXX.
   470         16  CM-REIN-TABLE                 PIC XXX.
   471         16  CM-SPECIAL-REIN-CODE          PIC X.
   472         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   473         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   474         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   475
   476     12  CM-STATUS-DATA.
   477         16  CM-ENTRY-STATUS               PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* SOCK03.cbl
   478         16  CM-ENTRY-DT                   PIC XX.
   479
   480         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   481         16  CM-LF-CANCEL-DT               PIC XX.
   482         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   483
   484         16  CM-LF-STATUS-AT-DEATH         PIC X.
   485         16  CM-LF-DEATH-DT                PIC XX.
   486         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   487
   488         16  CM-LF-CURRENT-STATUS          PIC X.
   489             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   490                                                'M' '4' '5' '9'.
   491             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   492             88  CM-LF-POLICY-PENDING         VALUE '2'.
   493             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   494             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   495             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   496             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   497             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   498             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   499             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   500             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   501             88  CM-LF-DECLINED               VALUE 'D'.
   502             88  CM-LF-VOIDED                 VALUE 'V'.
   503
   504         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   505         16  CM-AH-CANCEL-DT               PIC XX.
   506         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   507
   508         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   509         16  CM-AH-SETTLEMENT-DT           PIC XX.
   510         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   511
   512         16  CM-AH-CURRENT-STATUS          PIC X.
   513             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   514                                                'M' '4' '5' '9'.
   515             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   516             88  CM-AH-POLICY-PENDING         VALUE '2'.
   517             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   518             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   519             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   520             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   521             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   522             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   523             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   524             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   525             88  CM-AH-DECLINED               VALUE 'D'.
   526             88  CM-AH-VOIDED                 VALUE 'V'.
   527
   528         16  CM-CLAIM-INTERFACE-SW         PIC X.
   529             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   530             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   531             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   532         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   533
   534         16  CM-ENTRY-BATCH                PIC X(6).
   535         16  CM-LF-EXIT-BATCH              PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* SOCK03.cbl
   536         16  CM-AH-EXIT-BATCH              PIC X(6).
   537         16  CM-LAST-MONTH-END             PIC XX.
   538
   539     12  CM-NOTE-SW                        PIC X.
   540         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   541         88  CERT-NOTES-PRESENT               VALUE '1'.
   542         88  BILLING-NOTES-PRESENT            VALUE '2'.
   543         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   544         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   545         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   546         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   547         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   548     12  CM-COMP-EXCP-SW                   PIC X.
   549         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   550         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   551     12  CM-INSURED-ADDRESS-SW             PIC X.
   552         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   553         88  INSURED-ADDR-PRESENT             VALUE '1'.
   554
   555*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   556     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   557     12  FILLER                            PIC X.
   558
   559*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   560     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   561     12  FILLER                            PIC X.
   562*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   563     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
   564
   565     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   566         88  CERT-ADDED-BATCH                 VALUE ' '.
   567         88  CERT-ADDED-ONLINE                VALUE '1'.
   568         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   569         88  CERT-PURGED-OFFLINE              VALUE '3'.
   570         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   571     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   572         88  CERT-AS-LOADED                   VALUE ' '.
   573         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   574         88  CERT-CLAIM-ONLINE                VALUE '2'.
   575         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   576         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   577         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   578         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   579         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   580
   581     12  CM-ACCOUNT-COMM-PCTS.
   582         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   583         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   584
   585     12  CM-USER-FIELD                     PIC X.
   586     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   587     12  CM-CLP-STATE                      PIC XX.
   588     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   589     12  CM-USER-RESERVED                  PIC XXX.
   590     12  FILLER REDEFINES CM-USER-RESERVED.
   591         16  CM-AH-CLASS-CD                PIC XX.
   592         16  F                             PIC X.
   593******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* SOCK03.cbl
   594*                                 COPY ELCMSTR.
   595******************************************************************
   596*                                                                *
   597*                            ELCMSTR.                            *
   598*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   599*                            VMOD=2.012                          *
   600*                                                                *
   601*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
   602*                                                                *
   603*   FILE TYPE = VSAM,KSDS                                        *
   604*   RECORD SIZE = 350  RECFORM = FIXED                           *
   605*                                                                *
   606*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
   607*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
   608*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
   609*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
   610*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
   611*                                                 RKP=75,LEN=21  *
   612*                                                                *
   613*   **** NOTE ****                                               *
   614*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
   615*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
   616*                                                                *
   617*   LOG = YES                                                    *
   618*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   619******************************************************************
   620*                   C H A N G E   L O G
   621*
   622* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   623*-----------------------------------------------------------------
   624*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   625* EFFECTIVE    NUMBER
   626*-----------------------------------------------------------------
   627* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
   628* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
   629******************************************************************
   630 01  CLAIM-MASTER.
   631     12  CL-RECORD-ID                PIC XX.
   632         88  VALID-CL-ID         VALUE 'CL'.
   633
   634     12  CL-CONTROL-PRIMARY.
   635         16  CL-COMPANY-CD           PIC X.
   636         16  CL-CARRIER              PIC X.
   637         16  CL-CLAIM-NO             PIC X(7).
   638         16  CL-CERT-NO.
   639             20  CL-CERT-PRIME       PIC X(10).
   640             20  CL-CERT-SFX         PIC X.
   641
   642     12  CL-CONTROL-BY-NAME.
   643         16  CL-COMPANY-CD-A1        PIC X.
   644         16  CL-INSURED-LAST-NAME    PIC X(15).
   645         16  CL-INSURED-NAME.
   646             20  CL-INSURED-1ST-NAME PIC X(12).
   647             20  CL-INSURED-MID-INIT PIC X.
   648
   649     12  CL-CONTROL-BY-SSN.
   650         16  CL-COMPANY-CD-A2        PIC X.
   651         16  CL-SOC-SEC-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* SOCK03.cbl
   652             20  CL-SSN-STATE        PIC XX.
   653             20  CL-SSN-ACCOUNT      PIC X(6).
   654             20  CL-SSN-LN3          PIC X(3).
   655
   656     12  CL-CONTROL-BY-CERT-NO.
   657         16  CL-COMPANY-CD-A4        PIC X.
   658         16  CL-CERT-NO-A4.
   659             20  CL-CERT-A4-PRIME    PIC X(10).
   660             20  CL-CERT-A4-SFX      PIC X.
   661
   662     12  CL-CONTROL-BY-CCN.
   663         16  CL-COMPANY-CD-A5        PIC X.
   664         16  CL-CCN-A5.
   665             20  CL-CCN.
   666                 24  CL-CCN-PREFIX-A5 PIC X(4).
   667                 24  CL-CCN-PRIME-A5 PIC X(12).
   668             20  CL-CCN-FILLER-A5    PIC X(4).
   669
   670     12  CL-INSURED-PROFILE-DATA.
   671         16  CL-INSURED-BIRTH-DT     PIC XX.
   672         16  CL-INSURED-SEX-CD       PIC X.
   673             88  INSURED-IS-MALE        VALUE 'M'.
   674             88  INSURED-IS-FEMALE      VALUE 'F'.
   675             88  INSURED-SEX-UNKNOWN    VALUE ' '.
   676         16  CL-INSURED-OCC-CD       PIC X(6).
   677         16  FILLER                  PIC X(5).
   678
   679     12  CL-PROCESSING-INFO.
   680         16  CL-PROCESSOR-ID         PIC X(4).
   681         16  CL-CLAIM-STATUS         PIC X.
   682             88  CLAIM-IS-OPEN          VALUE 'O'.
   683             88  CLAIM-IS-CLOSED        VALUE 'C'.
   684         16  CL-CLAIM-TYPE           PIC X.
   685*            88  AH-CLAIM               VALUE 'A'.
   686*            88  LIFE-CLAIM             VALUE 'L'.
   687*            88  PROPERTY-CLAIM         VALUE 'P'.
   688*            88  IUI-CLAIM              VALUE 'I'.
   689*            88  GAP-CLAIM              VALUE 'G'.
   690         16  CL-CLAIM-PREM-TYPE      PIC X.
   691             88  SINGLE-PREMIUM         VALUE '1'.
   692             88  O-B-COVERAGE           VALUE '2'.
   693             88  OPEN-END-COVERAGE      VALUE '3'.
   694         16  CL-INCURRED-DT          PIC XX.
   695         16  CL-REPORTED-DT          PIC XX.
   696         16  CL-FILE-ESTABLISH-DT    PIC XX.
   697         16  CL-EST-END-OF-DISAB-DT  PIC XX.
   698         16  CL-LAST-PMT-DT          PIC XX.
   699         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
   700         16  CL-PAID-THRU-DT         PIC XX.
   701         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
   702         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
   703         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
   704         16  CL-PMT-CALC-METHOD      PIC X.
   705             88  CL-360-DAY-YR          VALUE '1'.
   706             88  CL-365-DAY-YR          VALUE '2'.
   707             88  CL-FULL-MONTHS         VALUE '3'.
   708         16  CL-CAUSE-CD             PIC X(6).
   709
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* SOCK03.cbl
   710         16  CL-PRIME-CERT-NO.
   711             20  CL-PRIME-CERT-PRIME PIC X(10).
   712             20  CL-PRIME-CERT-SFX   PIC X.
   713
   714         16  CL-SYSTEM-IDENTIFIER    PIC XX.
   715             88  CL-CREDIT-CLAIM        VALUE 'CR'.
   716             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
   717
   718         16  CL-MICROFILM-NO         PIC X(10).
   719         16  CL-PROG-FORM-TYPE       PIC X.
   720         16  CL-LAST-ADD-ON-DT       PIC XX.
   721
   722         16  CL-LAST-REOPEN-DT       PIC XX.
   723         16  CL-LAST-CLOSE-DT        PIC XX.
   724         16  CL-LAST-CLOSE-REASON    PIC X(01).
   725             88  FINAL-PAID             VALUE '1'.
   726             88  CLAIM-DENIED           VALUE '2'.
   727             88  AUTO-CLOSE             VALUE '3'.
   728             88  MANUAL-CLOSE           VALUE '4'.
   729             88  BENEFITS-CHANGED       VALUE 'C'.
   730             88  SETUP-ERRORS           VALUE 'E'.
   731         16  CL-ASSOC-CERT-SEQU      PIC S99.
   732         16  CL-ASSOC-CERT-TOTAL     PIC S99.
   733         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
   734             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
   735         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
   736         16  FILLER                  PIC X.
   737
   738     12  CL-CERTIFICATE-DATA.
   739         16  CL-CERT-ORIGIN          PIC X.
   740             88  CERT-WAS-ONLINE        VALUE '1'.
   741             88  CERT-WAS-CREATED       VALUE '2'.
   742             88  COVERAGE-WAS-ADDED     VALUE '3'.
   743         16  CL-CERT-KEY-DATA.
   744             20  CL-CERT-CARRIER     PIC X.
   745             20  CL-CERT-GROUPING    PIC X(6).
   746             20  CL-CERT-STATE       PIC XX.
   747             20  CL-CERT-ACCOUNT.
   748                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
   749                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
   750             20  CL-CERT-EFF-DT      PIC XX.
   751
   752     12  CL-STATUS-CONTROLS.
   753         16  CL-PRIORITY-CD          PIC X.
   754             88  CONFIDENTIAL-DATA      VALUE '8'.
   755             88  HIGHEST-PRIORITY       VALUE '9'.
   756         16  CL-SUPV-ATTN-CD         PIC X.
   757             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
   758             88  SUPV-IS-REQUIRED       VALUE 'Y'.
   759         16  CL-PURGED-DT            PIC XX.
   760         16  CL-RESTORED-DT          PIC XX.
   761         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
   762         16  CL-NEXT-RESEND-DT       PIC XX.
   763         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
   764         16  FILLER                  PIC XX.
   765         16  CL-LAST-MAINT-DT        PIC XX.
   766         16  CL-LAST-MAINT-USER      PIC X(4).
   767         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* SOCK03.cbl
   768         16  CL-LAST-MAINT-TYPE      PIC X.
   769             88  CLAIM-SET-UP           VALUE ' '.
   770             88  PAYMENT-MADE           VALUE '1'.
   771             88  LETTER-SENT            VALUE '2'.
   772             88  MASTER-WAS-ALTERED     VALUE '3'.
   773             88  MASTER-WAS-RESTORED    VALUE '4'.
   774             88  INCURRED-DATE-CHANGED  VALUE '5'.
   775             88  FILE-CONVERTED         VALUE '6'.
   776             88  CHANGE-OF-BENEFITS     VALUE 'C'.
   777             88  ERROR-CORRECTION       VALUE 'E'.
   778         16  CL-RELATED-CLAIM-NO     PIC X(7).
   779         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
   780         16  CL-BENEFICIARY          PIC X(10).
   781         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
   782         16  CL-DENIAL-TYPE          PIC X.
   783             88  CL-TYPE-DENIAL          VALUE '1'.
   784             88  CL-TYPE-RESCISSION      VALUE '2'.
   785             88  CL-TYPE-REFORMATION     VALUE '3'.
   786             88  CL-TYPE-REF-TO-RES      VALUE '4'.
   787             88  CL-TYPE-RECONSIDERED    VALUE '5'.
   788         16  FILLER                  PIC X(5).
   789
   790     12  CL-TRAILER-CONTROLS.
   791         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
   792             88  CL-1ST-TRL-AVAIL       VALUE +4095.
   793             88  CL-LAST-TRL-AVAIL      VALUE +100.
   794             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
   795         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
   796         16  FILLER                  PIC XX.
   797         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
   798         16  CL-ADDRESS-TRAILER-CNT.
   799             20  CL-INSURED-ADDR-CNT  PIC S9(1).
   800                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
   801             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
   802                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
   803             20  CL-BENIF-ADDR-CNT    PIC S9(1).
   804                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
   805             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
   806                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
   807             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
   808                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
   809             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
   810                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
   811             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
   812                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
   813
   814     12  CL-CV-REFERENCE-NO.
   815         16  CL-CV-REFNO-PRIME       PIC X(18).
   816         16  CL-CV-REFNO-SFX         PIC XX.
   817
   818     12  CL-FILE-LOCATION            PIC X(4).
   819
   820     12  CL-PROCESS-ERRORS.
   821         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
   822             88  NO-FATAL-ERRORS        VALUE ZERO.
   823         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
   824             88  NO-FORCABLE-ERRORS     VALUE ZERO.
   825
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* SOCK03.cbl
   826     12  CL-PRODUCT-CD               PIC X.
   827
   828     12  CL-CURRENT-KEY-DATA.
   829         16  CL-CURRENT-CARRIER      PIC X.
   830         16  CL-CURRENT-GROUPING     PIC X(6).
   831         16  CL-CURRENT-STATE        PIC XX.
   832         16  CL-CURRENT-ACCOUNT      PIC X(10).
   833
   834     12  CL-ASSOCIATES               PIC X.
   835         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
   836         88  CL-ASSOC-INTERFACE         VALUE 'I'.
   837         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
   838         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
   839
   840     12  CL-ACTIVITY-CODE            PIC 99.
   841     12  CL-ACTIVITY-MAINT-DT        PIC XX.
   842     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
   843
   844     12  CL-LAPSE-REPORT-CODE        PIC 9.
   845     12  CL-LAG-REPORT-CODE          PIC 9.
   846     12  CL-LOAN-TYPE                PIC XX.
   847     12  CL-LEGAL-STATE              PIC XX.
   848
   849*    12  FILLER                      PIC X(5).
   850     12  CL-YESNOSW                  PIC X.
   851     12  FILLER                      PIC X(4).
   852*                                 COPY ELCCNTL.
   853******************************************************************
   854*                                                                *
   855*                                                                *
   856*                            ELCCNTL.                            *
   857*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   858*                            VMOD=2.059                          *
   859*                                                                *
   860*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
   861*                                                                *
   862*   FILE TYPE = VSAM,KSDS                                        *
   863*   RECORD SIZE = 750  RECFORM = FIXED                           *
   864*                                                                *
   865*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
   866*       ALTERNATE INDEX = NONE                                   *
   867*                                                                *
   868*   LOG = YES                                                    *
   869*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   870******************************************************************
   871*                   C H A N G E   L O G
   872*
   873* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   874*-----------------------------------------------------------------
   875*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   876* EFFECTIVE    NUMBER
   877*-----------------------------------------------------------------
   878* 082503                   PEMA  ADD BENEFIT GROUP
   879* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   880* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   881* 092705    2005050300006  PEMA  ADD SPP LEASES
   882* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
   883* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* SOCK03.cbl
   884* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
   885* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
   886* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
   887******************************************************************
   888*
   889 01  CONTROL-FILE.
   890     12  CF-RECORD-ID                       PIC XX.
   891         88  VALID-CF-ID                        VALUE 'CF'.
   892
   893     12  CF-CONTROL-PRIMARY.
   894         16  CF-COMPANY-ID                  PIC XXX.
   895         16  CF-RECORD-TYPE                 PIC X.
   896             88  CF-COMPANY-MASTER              VALUE '1'.
   897             88  CF-PROCESSOR-MASTER            VALUE '2'.
   898             88  CF-STATE-MASTER                VALUE '3'.
   899             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
   900             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
   901             88  CF-CARRIER-MASTER              VALUE '6'.
   902             88  CF-MORTALITY-MASTER            VALUE '7'.
   903             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
   904             88  CF-TERMINAL-MASTER             VALUE '9'.
   905             88  CF-AH-EDIT-MASTER              VALUE 'A'.
   906             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
   907             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
   908             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
   909             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
   910             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
   911             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
   912             88  CF-REMINDERS-MASTER            VALUE 'R'.
   913             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
   914         16  CF-ACCESS-CD-GENL              PIC X(4).
   915         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
   916             20  CF-PROCESSOR               PIC X(4).
   917         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
   918             20  CF-STATE-CODE              PIC XX.
   919             20  FILLER                     PIC XX.
   920         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
   921             20  FILLER                     PIC XX.
   922             20  CF-HI-BEN-IN-REC           PIC XX.
   923         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
   924             20  FILLER                     PIC XXX.
   925             20  CF-CARRIER-CNTL            PIC X.
   926         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
   927             20  FILLER                     PIC XX.
   928             20  CF-HI-TYPE-IN-REC          PIC 99.
   929         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
   930             20  CF-CRDB-TABLE-INDICATOR    PIC X.
   931                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
   932             20  CF-CRDB-BENEFIT-TYPE       PIC X.
   933             20  CF-CRDB-WAITING-PERIOD     PIC XX.
   934         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
   935             20  FILLER                     PIC X.
   936             20  CF-CUSTOM-REPORT-NO        PIC 999.
   937         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
   938             20  FILLER                     PIC XX.
   939             20  CF-MORTGAGE-PLAN           PIC XX.
   940         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
   941
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* SOCK03.cbl
   942     12  CF-LAST-MAINT-DT                   PIC XX.
   943     12  CF-LAST-MAINT-BY                   PIC X(4).
   944     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
   945
   946     12  CF-RECORD-BODY                     PIC X(728).
   947
   948
   949****************************************************************
   950*             COMPANY MASTER RECORD                            *
   951****************************************************************
   952
   953     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
   954         16  CF-COMPANY-ADDRESS.
   955             20  CF-CL-MAIL-TO-NAME         PIC X(30).
   956             20  CF-CL-IN-CARE-OF           PIC X(30).
   957             20  CF-CL-ADDR-LINE-1          PIC X(30).
   958             20  CF-CL-ADDR-LINE-2          PIC X(30).
   959             20  CF-CL-CITY-STATE           PIC X(30).
   960             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
   961             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
   962         16  CF-COMPANY-CD                  PIC X.
   963         16  CF-COMPANY-PASSWORD            PIC X(8).
   964         16  CF-SECURITY-OPTION             PIC X.
   965             88  ALL-SECURITY                   VALUE '1'.
   966             88  COMPANY-VERIFY                 VALUE '2'.
   967             88  PROCESSOR-VERIFY               VALUE '3'.
   968             88  NO-SECURITY                    VALUE '4'.
   969             88  ALL-BUT-TERM                   VALUE '5'.
   970         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
   971             88  USE-ACTUAL-CARRIER             VALUE SPACE.
   972         16  CF-LGX-INTERFACE-CNTL          PIC X.
   973             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
   974         16  CF-INFORCE-LOCATION            PIC X.
   975             88  CERTS-ARE-ONLINE               VALUE '1'.
   976             88  CERTS-ARE-OFFLINE              VALUE '2'.
   977             88  NO-CERTS-AVAILABLE             VALUE '3'.
   978         16  CF-LOWER-CASE-LETTERS          PIC X.
   979         16  CF-CERT-ACCESS-CONTROL         PIC X.
   980             88  CF-ST-ACCNT-CNTL               VALUE ' '.
   981             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   982             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
   983             88  CF-ACCNT-CNTL                  VALUE '3'.
   984             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
   985
   986         16  CF-FORMS-PRINTER-ID            PIC X(4).
   987         16  CF-CHECK-PRINTER-ID            PIC X(4).
   988
   989         16  CF-LGX-CREDIT-USER             PIC X.
   990             88  CO-IS-NOT-USER                 VALUE 'N'.
   991             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
   992
   993         16 CF-CREDIT-CALC-CODES.
   994             20  CF-CR-REM-TERM-CALC PIC X.
   995               88  CR-EARN-AFTER-15TH           VALUE '1'.
   996               88  CR-EARN-ON-HALF-MO           VALUE '2'.
   997               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
   998               88  CR-EARN-ON-FULL-MO           VALUE '4'.
   999               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* SOCK03.cbl
  1000               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1001               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1002             20  CF-CR-R78-METHOD           PIC X.
  1003               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1004               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1005
  1006         16  CF-CLAIM-CONTROL-COUNTS.
  1007             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1008                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1009
  1010             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1011                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1012
  1013             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1014                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1015
  1016             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1017                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1018
  1019         16  CF-CURRENT-MONTH-END           PIC XX.
  1020
  1021         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1022             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1023             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1024             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1025             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1026                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1027                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1028             20  CF-CO-PREM-REJECT-SW       PIC X.
  1029                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1030                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1031             20  CF-CO-REF-REJECT-SW        PIC X.
  1032                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1033                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1034
  1035         16  CF-CO-REPORTING-DT             PIC XX.
  1036         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1037         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1038           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1039           88  CF-CO-MONTH-END                  VALUE '1'.
  1040
  1041         16  CF-LGX-CLAIM-USER              PIC X.
  1042             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1043             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1044
  1045         16  CF-CREDIT-EDIT-CONTROLS.
  1046             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1047             20  CF-MIN-AGE                 PIC 99.
  1048             20  CF-DEFAULT-AGE             PIC 99.
  1049             20  CF-MIN-TERM                PIC S999      COMP-3.
  1050             20  CF-MAX-TERM                PIC S999      COMP-3.
  1051             20  CF-DEFAULT-SEX             PIC X.
  1052             20  CF-JOINT-AGE-INPUT         PIC X.
  1053                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1054             20  CF-BIRTH-DATE-INPUT        PIC X.
  1055                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1056             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1057                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* SOCK03.cbl
  1058                 88  CF-ZERO-CARRIER            VALUE '1'.
  1059                 88  CF-ZERO-GROUPING           VALUE '2'.
  1060                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1061             20  CF-EDIT-SW                 PIC X.
  1062                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1063             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1064             20  CF-CR-PR-METHOD            PIC X.
  1065               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1066               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1067             20  FILLER                     PIC X.
  1068
  1069         16  CF-CREDIT-MISC-CONTROLS.
  1070             20  CF-REIN-TABLE-SW           PIC X.
  1071                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1072             20  CF-COMP-TABLE-SW           PIC X.
  1073                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1074             20  CF-EXPERIENCE-RETENTION-AGE
  1075                                            PIC S9        COMP-3.
  1076             20  CF-CONVERSION-DT           PIC XX.
  1077             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1078             20  CF-RUN-FREQUENCY-SW        PIC X.
  1079                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1080                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1081
  1082             20  CF-CR-CHECK-NO-CONTROL.
  1083                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1084                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1085                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1086                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1087                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1088                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1089
  1090                 24  CF-CR-CHECK-COUNT       REDEFINES
  1091                     CF-CR-CHECK-COUNTER      PIC X(4).
  1092
  1093                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1094                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1095
  1096                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1097                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1098                 24  CF-MAIL-PROCESSING       PIC X.
  1099                     88  MAIL-PROCESSING          VALUE 'Y'.
  1100
  1101         16  CF-MISC-SYSTEM-CONTROL.
  1102             20  CF-SYSTEM-C                 PIC X.
  1103                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1104             20  CF-SYSTEM-D                 PIC X.
  1105                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1106             20  CF-SOC-SEC-NO-SW            PIC X.
  1107                 88  SOC-SEC-NO-USED             VALUE '1'.
  1108             20  CF-MEMBER-NO-SW             PIC X.
  1109                 88  MEMBER-NO-USED              VALUE '1'.
  1110             20  CF-TAX-ID-NUMBER            PIC X(11).
  1111             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1112             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1113                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1114                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1115                 88  CF-ALL-APPROVED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* SOCK03.cbl
  1116                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1117             20  CF-SYSTEM-E                 PIC X.
  1118                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1119
  1120         16  CF-LGX-LIFE-USER               PIC X.
  1121             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1122             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1123
  1124         16  CF-CR-MONTH-END-DT             PIC XX.
  1125
  1126         16  CF-FILE-MAINT-DATES.
  1127             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1128                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1129             20  CF-LAST-BATCH       REDEFINES
  1130                 CF-LAST-BATCH-NO               PIC X(4).
  1131             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1132             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1133             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1134             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1135             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1136             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1137             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1138             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1139             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1140             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1141
  1142         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1143         16  FILLER                         PIC X.
  1144
  1145         16  CF-ALT-MORT-CODE               PIC X(4).
  1146         16  CF-MEMBER-CAPTION              PIC X(10).
  1147
  1148         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1149             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1150             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1151             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1152             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1153             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1154
  1155         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1156
  1157         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1158         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1159         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1160         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1161
  1162         16  CF-AH-OVERRIDE-L1              PIC X.
  1163         16  CF-AH-OVERRIDE-L2              PIC XX.
  1164         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1165         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1166
  1167         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1168         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1169
  1170         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1171         16  CF-AR-LAST-EL860-DT            PIC XX.
  1172         16  CF-MP-MONTH-END-DT             PIC XX.
  1173
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* SOCK03.cbl
  1174         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1175         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1176             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1177
  1178         16  CF-AR-MONTH-END-DT             PIC XX.
  1179
  1180         16  CF-CRDTCRD-USER                PIC X.
  1181             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1182             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1183
  1184         16  CF-CC-MONTH-END-DT             PIC XX.
  1185
  1186         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1187
  1188         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1189             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1190             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1191             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1192         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1193         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1194         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1195         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1196             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1197             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1198         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1199         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1200         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1201             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1202         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1203
  1204         16  CF-CL-ZIP-CODE.
  1205             20  CF-CL-ZIP-PRIME.
  1206                 24  CF-CL-ZIP-1ST          PIC X.
  1207                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1208                 24  FILLER                 PIC X(4).
  1209             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1210         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1211             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1212             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1213             20  FILLER                     PIC XXX.
  1214
  1215         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1216         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1217         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1218         16  CF-CO-OPTION-START-DATE        PIC XX.
  1219         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1220           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1221                                                      '3' '4'.
  1222           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1223           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1224           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1225           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1226           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1227           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1228
  1229         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1230
  1231         16  CF-PAYMENT-APPROVAL-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* SOCK03.cbl
  1232             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1233             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1234             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1235             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1236             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1237             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1238
  1239         16  CF-END-USER-REPORTING-USER     PIC X.
  1240             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1241             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1242
  1243         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1244             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1245             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1246
  1247         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1248
  1249         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1250         16  FILLER                         PIC X.
  1251
  1252         16  CF-CREDIT-ARCHIVE-CNTL.
  1253             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1254             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1255             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1256
  1257         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1258
  1259         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1260             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1261             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1262
  1263         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1264             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1265             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1266
  1267         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1268
  1269         16  CF-CO-ACH-ID-CODE              PIC  X.
  1270             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1271             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1272             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1273         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1274         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1275         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1276         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1277         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1278         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1279         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1280         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1281         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1282                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1283         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1284                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1285
  1286         16  CF-CO-OVER-SHORT.
  1287             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1288             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1289
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* SOCK03.cbl
  1290*         16  FILLER                         PIC X(102).
  1291         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1292             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1293             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1294
  1295         16  CF-AH-APPROVAL-DAYS.
  1296             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1297             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1298             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1299             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1300
  1301         16  FILLER                         PIC X(82).
  1302****************************************************************
  1303*             PROCESSOR/USER RECORD                            *
  1304****************************************************************
  1305
  1306     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1307         16  CF-PROCESSOR-NAME              PIC X(30).
  1308         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1309         16  CF-PROCESSOR-TITLE             PIC X(26).
  1310         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1311                 88  MESSAGE-YES                VALUE 'Y'.
  1312                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1313
  1314*****************************************************
  1315****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1316****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1317****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1318****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1319*****************************************************
  1320
  1321         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1322             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1323             20  CF-APPLICATION-FORCE       PIC X.
  1324             20  CF-INDIVIDUAL-APP.
  1325                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1326                     28  CF-BROWSE-APP      PIC X.
  1327                     28  CF-UPDATE-APP      PIC X.
  1328
  1329         16  CF-CURRENT-TERM-ON             PIC X(4).
  1330         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1331             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1332             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1333             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1334             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1335             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1336             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1337             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1338         16  CF-PROCESSOR-CARRIER           PIC X.
  1339             88  NO-CARRIER-SECURITY            VALUE ' '.
  1340         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1341             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1342         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1343             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1344         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1345             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1346
  1347         16  CF-PROC-SYS-ACCESS-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* SOCK03.cbl
  1348             20  CF-PROC-CREDIT-CLAIMS-SW.
  1349                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1350                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1351                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1352                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1353             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1354                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1355                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1356             20  CF-PROC-LIFE-GNRLDGR-SW.
  1357                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1358                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1359                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1360                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1361             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1362                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1363                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1364         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1365             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1366             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1367         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1368
  1369         16  CF-APPROVAL-LEVEL                  PIC X.
  1370             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1371             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1372             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1373             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1374
  1375         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1376
  1377         16  CF-LANGUAGE-TYPE                   PIC X.
  1378             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1379             88  CF-LANG-IS-FR                      VALUE 'F'.
  1380         16  FILLER                             PIC  X(240).
  1381
  1382****************************************************************
  1383*             PROCESSOR/REMINDERS RECORD                       *
  1384****************************************************************
  1385
  1386     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1387         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1388             20  CF-START-REMIND-DT         PIC XX.
  1389             20  CF-END-REMIND-DT           PIC XX.
  1390             20  CF-REMINDER-TEXT           PIC X(50).
  1391         16  FILLER                         PIC X(296).
  1392
  1393
  1394****************************************************************
  1395*             STATE MASTER RECORD                              *
  1396****************************************************************
  1397
  1398     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1399         16  CF-STATE-ABBREVIATION          PIC XX.
  1400         16  CF-STATE-NAME                  PIC X(25).
  1401         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1402         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1403             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1404             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1405             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* SOCK03.cbl
  1406             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1407                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1408                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1409             20  CF-ST-PREM-REJECT-SW       PIC X.
  1410                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1411                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1412             20  CF-ST-REF-REJECT-SW        PIC X.
  1413                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1414                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1415         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1416         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1417         16  CF-ST-REFUND-RULES.
  1418             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1419             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1420             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1421         16  CF-ST-FST-PMT-EXTENSION.
  1422             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1423             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1424                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1425                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1426                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1427                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1428         16  CF-ST-STATE-CALL.
  1429             20  CF-ST-CALL-UNEARNED        PIC X.
  1430             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1431             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1432         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1433             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1434             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1435         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1436         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1437         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1438         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1439         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1440         16  FILLER                         PIC X.
  1441         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1442             20  CF-ST-BENEFIT-CD           PIC XX.
  1443             20  CF-ST-BENEFIT-KIND         PIC X.
  1444                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1445                 88  CF-ST-AH-KIND              VALUE 'A'.
  1446             20  CF-ST-REM-TERM-CALC        PIC X.
  1447                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1448                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1449                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1450                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1451                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1452                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1453                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1454                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1455
  1456             20  CF-ST-REFUND-CALC          PIC X.
  1457                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1458                 88  ST-REFD-BY-R78             VALUE '1'.
  1459                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1460                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1461                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1462                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1463                 88  ST-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* SOCK03.cbl
  1464                 88  ST-REFD-UTAH               VALUE '7'.
  1465                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1466                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1467                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1468
  1469             20  CF-ST-EARNING-CALC         PIC X.
  1470                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1471                 88  ST-EARN-BY-R78             VALUE '1'.
  1472                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1473                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1474                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1475                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1476                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1477                 88  ST-EARN-MEAN               VALUE '8'.
  1478                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1479
  1480             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1481                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1482                 88  ST-OVRD-BY-R78             VALUE '1'.
  1483                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1484                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1485                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1486                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1487                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1488                 88  ST-OVRD-MEAN               VALUE '8'.
  1489                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1490             20  FILLER                     PIC X.
  1491
  1492         16  CF-ST-COMMISSION-CAPS.
  1493             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1494             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1495             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1496             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1497         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1498                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1499
  1500         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1501
  1502         16  CF-ST-STATUTORY-INTEREST.
  1503             20  CF-ST-STAT-DATE-FROM       PIC X.
  1504                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1505                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1506             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1507             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1508             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1509             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1510             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1511
  1512         16  CF-ST-OVER-SHORT.
  1513             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1514             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1515
  1516         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1517
  1518         16  CF-ST-RT-CALC                  PIC X.
  1519
  1520         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1521         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* SOCK03.cbl
  1522         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1523         16  CF-ST-RF-LR-CALC               PIC X.
  1524         16  CF-ST-RF-LL-CALC               PIC X.
  1525         16  CF-ST-RF-LN-CALC               PIC X.
  1526         16  CF-ST-RF-AH-CALC               PIC X.
  1527         16  CF-ST-RF-CP-CALC               PIC X.
  1528*        16  FILLER                         PIC X(206).
  1529*CIDMOD         16  FILLER                         PIC X(192).
  1530         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1531             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1532         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1533         16  CF-ST-VFY-2ND-BENE             PIC X.
  1534         16  FILLER                         PIC X(186).
  1535
  1536****************************************************************
  1537*             BENEFIT MASTER RECORD                            *
  1538****************************************************************
  1539
  1540     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1541         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1542             20  CF-BENEFIT-CODE            PIC XX.
  1543             20  CF-BENEFIT-NUMERIC  REDEFINES
  1544                 CF-BENEFIT-CODE            PIC XX.
  1545             20  CF-BENEFIT-ALPHA           PIC XXX.
  1546             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1547             20  CF-BENEFIT-COMMENT         PIC X(10).
  1548
  1549             20  CF-LF-COVERAGE-TYPE        PIC X.
  1550                 88  CF-REDUCING                VALUE 'R'.
  1551                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1552
  1553             20  CF-SPECIAL-CALC-CD         PIC X.
  1554                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1555                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1556                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1557                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1558                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1559                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1560                 88  CF-FARM-PLAN               VALUE 'F'.
  1561                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1562                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1563                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1564                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1565                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1566                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1567                 88  CF-PRUDENTIAL              VALUE 'P'.
  1568                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1569                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1570                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1571                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1572                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1573                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1574
  1575             20  CF-JOINT-INDICATOR         PIC X.
  1576                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1577
  1578*            20  FILLER                     PIC X(12).
  1579             20  FILLER                     PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* SOCK03.cbl
  1580             20  CF-BENEFIT-CATEGORY        PIC X.
  1581             20  CF-LOAN-TYPE               PIC X(8).
  1582
  1583             20  CF-CO-REM-TERM-CALC        PIC X.
  1584                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1585                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1586                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1587                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1588                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1589
  1590             20  CF-CO-EARNINGS-CALC        PIC X.
  1591                 88  CO-EARN-BY-R78             VALUE '1'.
  1592                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1593                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1594                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1595                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1596                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1597                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1598                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1599
  1600             20  CF-CO-REFUND-CALC          PIC X.
  1601                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1602                 88  CO-REFD-BY-R78             VALUE '1'.
  1603                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1604                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1605                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1606                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1607                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  1608                 88  CO-REFD-MEAN               VALUE '8'.
  1609                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1610                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1611                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1612
  1613             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1614                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1615                 88  CO-OVRD-BY-R78             VALUE '1'.
  1616                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1617                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1618                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1619                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1620                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1621                 88  CO-OVRD-MEAN               VALUE '8'.
  1622                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1623
  1624             20  CF-CO-BEN-I-G-CD           PIC X.
  1625                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1626                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1627                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1628
  1629         16  FILLER                         PIC X(304).
  1630
  1631
  1632****************************************************************
  1633*             CARRIER MASTER RECORD                            *
  1634****************************************************************
  1635
  1636     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1637         16  CF-ADDRESS-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* SOCK03.cbl
  1638             20  CF-MAIL-TO-NAME            PIC X(30).
  1639             20  CF-IN-CARE-OF              PIC X(30).
  1640             20  CF-ADDRESS-LINE-1          PIC X(30).
  1641             20  CF-ADDRESS-LINE-2          PIC X(30).
  1642             20  CF-CITY-STATE              PIC X(30).
  1643             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1644             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1645
  1646         16  CF-CLAIM-NO-CONTROL.
  1647             20  CF-CLAIM-NO-METHOD         PIC X.
  1648                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1649                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1650                 88  CLAIM-NO-SEQ               VALUE '3'.
  1651                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1652             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1653                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1654                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1655                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1656
  1657         16  CF-CHECK-NO-CONTROL.
  1658             20  CF-CHECK-NO-METHOD         PIC X.
  1659                 88  CHECK-NO-MANUAL            VALUE '1'.
  1660                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1661                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1662                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1663             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1664                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1665
  1666         16  CF-DOMICILE-STATE              PIC XX.
  1667
  1668         16  CF-EXPENSE-CONTROLS.
  1669             20  CF-EXPENSE-METHOD          PIC X.
  1670                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1671                 88  DOLLARS-PER-PMT            VALUE '2'.
  1672                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1673                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1674             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1675             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1676
  1677         16  CF-CORRESPONDENCE-CONTROL.
  1678             20  CF-LETTER-RESEND-OPT       PIC X.
  1679                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1680                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1681             20  FILLER                     PIC X(4).
  1682
  1683         16  CF-RESERVE-CONTROLS.
  1684             20  CF-MANUAL-SW               PIC X.
  1685                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1686             20  CF-FUTURE-SW               PIC X.
  1687                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1688             20  CF-PTC-SW                  PIC X.
  1689                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1690             20  CF-IBNR-SW                 PIC X.
  1691                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1692             20  CF-PTC-LF-SW               PIC X.
  1693                 88  CF-LF-PTC-USED             VALUE '1'.
  1694             20  CF-CDT-ACCESS-METHOD       PIC X.
  1695                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* SOCK03.cbl
  1696                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1697                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1698             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1699
  1700         16  CF-CLAIM-CALC-METHOD           PIC X.
  1701             88  360-PLUS-MONTHS                VALUE '1'.
  1702             88  365-PLUS-MONTHS                VALUE '2'.
  1703             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1704             88  360-DAILY                      VALUE '4'.
  1705             88  365-DAILY                      VALUE '5'.
  1706
  1707         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1708         16  FILLER                         PIC X(11).
  1709
  1710         16  CF-LIMIT-AMOUNTS.
  1711             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1712             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1713             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1714             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1715             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1716             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1717             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1718             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1719             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1720             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1721
  1722         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1723         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  1724         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1725
  1726         16  CF-ZIP-CODE.
  1727             20  CF-ZIP-PRIME.
  1728                 24  CF-ZIP-1ST             PIC X.
  1729                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1730                 24  FILLER                 PIC X(4).
  1731             20  CF-ZIP-PLUS4               PIC X(4).
  1732         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1733             20  CF-CAN-POSTAL-1            PIC XXX.
  1734             20  CF-CAN-POSTAL-2            PIC XXX.
  1735             20  FILLER                     PIC XXX.
  1736
  1737         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1738         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1739         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1740
  1741         16  CF-RATING-SWITCH               PIC X.
  1742             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  1743             88  CF-NO-RATING                   VALUE 'N'.
  1744
  1745         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  1746
  1747         16  CF-CARRIER-OVER-SHORT.
  1748             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1749             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1750
  1751         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  1752         16  CF-SECPAY-SWITCH               PIC X.
  1753             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* SOCK03.cbl
  1754             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  1755         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  1756         16  FILLER                         PIC X(448).
  1757*        16  FILLER                         PIC X(452).
  1758
  1759
  1760****************************************************************
  1761*             MORTALITY MASTER RECORD                          *
  1762****************************************************************
  1763
  1764     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1765         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  1766                                INDEXED BY CF-MORT-NDX.
  1767             20  CF-MORT-TABLE              PIC X(5).
  1768             20  CF-MORT-TABLE-TYPE         PIC X.
  1769                 88  CF-MORT-JOINT              VALUE 'J'.
  1770                 88  CF-MORT-SINGLE             VALUE 'S'.
  1771                 88  CF-MORT-COMBINED           VALUE 'C'.
  1772                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  1773                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  1774             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  1775             20  CF-MORT-AGE-METHOD         PIC XX.
  1776                 88  CF-AGE-LAST                VALUE 'AL'.
  1777                 88  CF-AGE-NEAR                VALUE 'AN'.
  1778             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  1779             20  CF-MORT-ADJUSTMENT-DIRECTION
  1780                                            PIC X.
  1781                 88  CF-MINUS                   VALUE '-'.
  1782                 88  CF-PLUS                    VALUE '+'.
  1783             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  1784             20  CF-MORT-JOINT-CODE         PIC X.
  1785                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  1786             20  CF-MORT-PC-Q               PIC X.
  1787                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  1788             20  CF-MORT-TABLE-CODE         PIC X(4).
  1789             20  CF-MORT-COMMENTS           PIC X(15).
  1790             20  FILLER                     PIC X(14).
  1791
  1792         16  FILLER                         PIC X(251).
  1793
  1794
  1795****************************************************************
  1796*             BUSSINESS TYPE MASTER RECORD                     *
  1797****************************************************************
  1798
  1799     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1800* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  1801* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  1802* AND RECORD 05 IS TYPES 81-99
  1803         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  1804             20  CF-BUSINESS-TITLE          PIC  X(19).
  1805             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  1806                                            PIC S9V9(4) COMP-3.
  1807             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  1808             20  FILLER                     PIC  X.
  1809         16  FILLER                         PIC  X(248).
  1810
  1811
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* SOCK03.cbl
  1812****************************************************************
  1813*             TERMINAL MASTER RECORD                           *
  1814****************************************************************
  1815
  1816     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1817
  1818         16  CF-COMPANY-TERMINALS.
  1819             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  1820                                  PIC X(4).
  1821         16  FILLER               PIC X(248).
  1822
  1823
  1824****************************************************************
  1825*             LIFE EDIT MASTER RECORD                          *
  1826****************************************************************
  1827
  1828     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1829         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  1830             20  CF-LIFE-CODE-IN            PIC XX.
  1831             20  CF-LIFE-CODE-OUT           PIC XX.
  1832         16  FILLER                         PIC X(248).
  1833
  1834
  1835****************************************************************
  1836*             AH EDIT MASTER RECORD                            *
  1837****************************************************************
  1838
  1839     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1840         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  1841             20  CF-AH-CODE-IN              PIC XXX.
  1842             20  CF-AH-CODE-OUT             PIC XX.
  1843         16  FILLER                         PIC X(248).
  1844
  1845
  1846****************************************************************
  1847*             CREDIBILITY TABLES                               *
  1848****************************************************************
  1849
  1850     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  1851         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  1852                             INDEXED BY CF-CRDB-NDX.
  1853             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  1854             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  1855             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  1856         16  FILLER                         PIC  X(332).
  1857
  1858
  1859****************************************************************
  1860*             REPORT CUSTOMIZATION RECORD                      *
  1861****************************************************************
  1862
  1863     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  1864         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  1865             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  1866             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  1867             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  1868**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  1869****       A T-TRANSFER.                                   ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* SOCK03.cbl
  1870             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  1871
  1872         16  FILLER                         PIC XX.
  1873
  1874         16  CF-CARRIER-CNTL-OPT.
  1875             20  CF-CARRIER-OPT-SEQ         PIC 9.
  1876                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  1877                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  1878             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  1879                                            PIC X.
  1880         16  CF-GROUP-CNTL-OPT.
  1881             20  CF-GROUP-OPT-SEQ           PIC 9.
  1882                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  1883                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  1884             20  CF-GROUP-SELECT OCCURS 3 TIMES
  1885                                            PIC X(6).
  1886         16  CF-STATE-CNTL-OPT.
  1887             20  CF-STATE-OPT-SEQ           PIC 9.
  1888                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  1889                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  1890             20  CF-STATE-SELECT OCCURS 3 TIMES
  1891                                            PIC XX.
  1892         16  CF-ACCOUNT-CNTL-OPT.
  1893             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  1894                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  1895                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  1896             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  1897                                            PIC X(10).
  1898         16  CF-BUS-TYP-CNTL-OPT.
  1899             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  1900                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  1901                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  1902             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  1903                                            PIC XX.
  1904         16  CF-LF-TYP-CNTL-OPT.
  1905             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  1906                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  1907                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  1908             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  1909                                            PIC XX.
  1910         16  CF-AH-TYP-CNTL-OPT.
  1911             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  1912                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  1913                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  1914             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  1915                                            PIC XX.
  1916         16  CF-REPTCD1-CNTL-OPT.
  1917             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  1918                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  1919                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  1920             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  1921                                            PIC X(10).
  1922         16  CF-REPTCD2-CNTL-OPT.
  1923             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  1924                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  1925                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  1926             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  1927                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* SOCK03.cbl
  1928         16  CF-USER1-CNTL-OPT.
  1929             20  CF-USER1-OPT-SEQ           PIC 9.
  1930                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  1931                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  1932             20  CF-USER1-SELECT OCCURS 3 TIMES
  1933                                            PIC X(10).
  1934         16  CF-USER2-CNTL-OPT.
  1935             20  CF-USER2-OPT-SEQ           PIC 9.
  1936                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  1937                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  1938             20  CF-USER2-SELECT OCCURS 3 TIMES
  1939                                            PIC X(10).
  1940         16  CF-USER3-CNTL-OPT.
  1941             20  CF-USER3-OPT-SEQ           PIC 9.
  1942                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  1943                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  1944             20  CF-USER3-SELECT OCCURS 3 TIMES
  1945                                            PIC X(10).
  1946         16  CF-USER4-CNTL-OPT.
  1947             20  CF-USER4-OPT-SEQ           PIC 9.
  1948                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  1949                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  1950             20  CF-USER4-SELECT OCCURS 3 TIMES
  1951                                            PIC X(10).
  1952         16  CF-USER5-CNTL-OPT.
  1953             20  CF-USER5-OPT-SEQ           PIC 9.
  1954                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  1955                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  1956             20  CF-USER5-SELECT OCCURS 3 TIMES
  1957                                            PIC X(10).
  1958         16  CF-REINS-CNTL-OPT.
  1959             20  CF-REINS-OPT-SEQ           PIC 9.
  1960                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  1961                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  1962             20  CF-REINS-SELECT OCCURS 3 TIMES.
  1963                 24  CF-REINS-PRIME         PIC XXX.
  1964                 24  CF-REINS-SUB           PIC XXX.
  1965
  1966         16  CF-AGENT-CNTL-OPT.
  1967             20  CF-AGENT-OPT-SEQ           PIC 9.
  1968                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  1969                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  1970             20  CF-AGENT-SELECT OCCURS 3 TIMES
  1971                                            PIC X(10).
  1972
  1973         16  FILLER                         PIC X(43).
  1974
  1975         16  CF-LOSS-RATIO-SELECT.
  1976             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  1977             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  1978         16  CF-ENTRY-DATE-SELECT.
  1979             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  1980             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  1981         16  CF-EFFECTIVE-DATE-SELECT.
  1982             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  1983             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  1984
  1985         16  CF-EXCEPTION-LIST-IND          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* SOCK03.cbl
  1986             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  1987
  1988         16  FILLER                         PIC X(318).
  1989
  1990****************************************************************
  1991*                  EXCEPTION REPORTING RECORD                  *
  1992****************************************************************
  1993
  1994     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  1995         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  1996             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  1997
  1998         16  CF-COMBINED-LIFE-AH-OPT.
  1999             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2000             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2001             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2002             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2003
  2004         16  CF-LIFE-OPT.
  2005             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2006             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2007             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2008             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2009             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2010             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2011             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2012             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2013             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2014             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2015
  2016         16  CF-AH-OPT.
  2017             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2018             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2019             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2020             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2021             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2022             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2023             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2024             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2025             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2026             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2027
  2028         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2029             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2030             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2031             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2032
  2033         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2034
  2035         16  FILLER                         PIC X(673).
  2036
  2037
  2038****************************************************************
  2039*             MORTGAGE SYSTEM PLAN RECORD                      *
  2040****************************************************************
  2041
  2042     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2043         16  CF-PLAN-TYPE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* SOCK03.cbl
  2044             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2045             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2046             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2047         16  CF-PLAN-ABBREV                 PIC XXX.
  2048         16  CF-PLAN-DESCRIPT               PIC X(10).
  2049         16  CF-PLAN-NOTES                  PIC X(20).
  2050         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2051         16  CF-PLAN-UNDERWRITING.
  2052             20  CF-PLAN-TERM-DATA.
  2053                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2054                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2055             20  CF-PLAN-AGE-DATA.
  2056                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2057                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2058                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2059             20  CF-PLAN-BENEFIT-DATA.
  2060                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2061                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2062                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2063                                            PIC S9(7)V99  COMP-3.
  2064         16  CF-PLAN-POLICY-FORMS.
  2065             20  CF-POLICY-FORM             PIC X(12).
  2066             20  CF-MASTER-APPLICATION      PIC X(12).
  2067             20  CF-MASTER-POLICY           PIC X(12).
  2068         16  CF-PLAN-RATING.
  2069             20  CF-RATE-CODE               PIC X(5).
  2070             20  CF-SEX-RATING              PIC X.
  2071                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2072                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2073             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2074             20  CF-SUB-STD-TYPE            PIC X.
  2075                 88  CF-PCT-OF-PREM            VALUE '1'.
  2076                 88  CF-PCT-OF-BENE            VALUE '2'.
  2077         16  CF-PLAN-PREM-TOLERANCES.
  2078             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2079             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2080         16  CF-PLAN-PYMT-TOLERANCES.
  2081             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2082             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2083         16  CF-PLAN-MISC-DATA.
  2084             20  FILLER                     PIC X.
  2085             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2086             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2087         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2088         16  CF-PLAN-IND-GRP                PIC X.
  2089             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2090                                                     '1'.
  2091             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2092                                                     '2'.
  2093         16  CF-MIB-SEARCH-SW               PIC X.
  2094             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2095             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2096             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2097             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2098         16  CF-ALPHA-SEARCH-SW             PIC X.
  2099             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2100             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2101             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* SOCK03.cbl
  2102             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2103             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2104             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2105             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2106             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2107             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2108             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2109                                                     'A' 'B' 'C'
  2110                                                     'X' 'Y' 'Z'.
  2111         16  CF-EFF-DT-RULE-SW              PIC X.
  2112             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2113             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2114             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2115             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2116             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2117         16  FILLER                         PIC X(4).
  2118         16  CF-HEALTH-QUESTIONS            PIC X.
  2119             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2120         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2121         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2122         16  CF-PLAN-SNGL-JNT               PIC X.
  2123             88  CF-COMBINED-PLAN              VALUE 'C'.
  2124             88  CF-JNT-PLAN                   VALUE 'J'.
  2125             88  CF-SNGL-PLAN                  VALUE 'S'.
  2126         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2127         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2128         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2129         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2130         16  CF-RERATE-CNTL                 PIC  X.
  2131             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2132             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2133             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2134             88  CF-AUTO-RECALC                 VALUE '4'.
  2135         16  CF-BENEFIT-TYPE                PIC  X.
  2136             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2137             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2138         16  CF-POLICY-FEE                  PIC S999V99
  2139                                                    COMP-3.
  2140         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2141         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2142         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2143         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2144         16  FILLER                         PIC  X(32).
  2145         16  CF-TERMINATION-FORM            PIC  X(04).
  2146         16  FILLER                         PIC  X(08).
  2147         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2148                                                       COMP-3.
  2149         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2150         16  CF-ISSUE-LETTER                PIC  X(4).
  2151         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2152         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2153             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2154             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2155         16  CF-MP-REFUND-CALC              PIC X.
  2156             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2157             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2158             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2159             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* SOCK03.cbl
  2160             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2161             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2162             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2163             88  CF-MP-REFD-MEAN                VALUE '8'.
  2164         16  CF-ALT-RATE-CODE               PIC  X(5).
  2165
  2166
  2167         16  FILLER                         PIC X(498).
  2168****************************************************************
  2169*             MORTGAGE COMPANY MASTER RECORD                   *
  2170****************************************************************
  2171
  2172     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2173         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2174         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2175             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2176             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2177             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2178             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2179             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2180
  2181         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2182         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2183         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2184         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2185         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2186
  2187         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2188             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2189         16  CF-MP-RECON-USE-IND            PIC X(1).
  2190             88  CF-MP-USE-RECON             VALUE 'Y'.
  2191         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2192             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2193         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2194             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2195             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2196         16  FILLER                         PIC X(1).
  2197         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2198             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2199         16  CF-MORTG-MIB-VERSION           PIC X.
  2200             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2201             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2202             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2203         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2204             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2205                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2206             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2207                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2208             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2209                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2210             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2211                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2212             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2213                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2214             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2215                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2216         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2217         16  FILLER                         PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* SOCK03.cbl
  2218         16  CF-MORTG-DESTINATION-SYMBOL.
  2219             20  CF-MORTG-MIB-COMM          PIC X(5).
  2220             20  CF-MORTG-MIB-TERM          PIC X(5).
  2221         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2222             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2223         16  FILLER                         PIC X(03).
  2224         16  CF-MP-CHECK-NO-CONTROL.
  2225             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2226                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2227                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2228                                                ' ' LOW-VALUES.
  2229                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2230                                               VALUE '3'.
  2231         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2232         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2233         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2234             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2235                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2236             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2237                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2238             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2239                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2240             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2241                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2242             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2243                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2244             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2245                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2246         16  CF-MORTG-BILLING-AREA.
  2247             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2248                                            PIC X.
  2249         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2250         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2251         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2252         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2253             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2254             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2255         16  FILLER                         PIC X.
  2256         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2257             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2258             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2259         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2260         16  FILLER                         PIC X(8).
  2261         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2262         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2263         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2264         16  CF-ACH-COMPANY-ID.
  2265             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2266                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2267                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2268                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2269             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2270         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2271             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2272         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2273             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2274             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2275         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* SOCK03.cbl
  2276         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2277         16  FILLER                         PIC X(536).
  2278
  2279****************************************************************
  2280*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2281****************************************************************
  2282
  2283     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2284         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2285             20  CF-FEMALE-HEIGHT.
  2286                 24  CF-FEMALE-FT           PIC 99.
  2287                 24  CF-FEMALE-IN           PIC 99.
  2288             20  CF-FEMALE-MIN-WT           PIC 999.
  2289             20  CF-FEMALE-MAX-WT           PIC 999.
  2290         16  FILLER                         PIC X(428).
  2291
  2292     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2293         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2294             20  CF-MALE-HEIGHT.
  2295                 24  CF-MALE-FT             PIC 99.
  2296                 24  CF-MALE-IN             PIC 99.
  2297             20  CF-MALE-MIN-WT             PIC 999.
  2298             20  CF-MALE-MAX-WT             PIC 999.
  2299         16  FILLER                         PIC X(428).
  2300******************************************************************
  2301*             AUTOMATIC ACTIVITY RECORD                          *
  2302******************************************************************
  2303     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2304         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2305             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2306             20  CF-SYS-LETTER-ID           PIC X(04).
  2307             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2308             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2309             20  CF-SYS-RESET-SW            PIC X(01).
  2310             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2311             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2312
  2313         16  FILLER                         PIC X(50).
  2314
  2315         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2316             20  CF-USER-ACTIVE-SW          PIC X(01).
  2317             20  CF-USER-LETTER-ID          PIC X(04).
  2318             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2319             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2320             20  CF-USER-RESET-SW           PIC X(01).
  2321             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2322             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2323             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2324
  2325         16  FILLER                         PIC X(246).
  2326*                                 COPY ERCACCT.
  2327******************************************************************
  2328*                                                                *
  2329*                                                                *
  2330*                            ERCACCT                             *
  2331*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2332*                            VMOD=2.031                          *
  2333*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* SOCK03.cbl
  2334*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2335*                                                                *
  2336*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2337*   VSAM ACCOUNT MASTER FILES.                                   *
  2338*                                                                *
  2339*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2340*                                                                *
  2341*   FILE TYPE = VSAM,KSDS                                        *
  2342*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2343*                                                                *
  2344*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2345*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2346*                                                                *
  2347*   LOG = NO                                                     *
  2348*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2349*                                                                *
  2350*                                                                *
  2351******************************************************************
  2352*                   C H A N G E   L O G
  2353*
  2354* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2355*-----------------------------------------------------------------
  2356*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2357* EFFECTIVE    NUMBER
  2358*-----------------------------------------------------------------
  2359* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2360* 092705    2005050300006  PEMA  ADD SPP LEASES
  2361* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2362* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2363* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2364* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2365* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2366******************************************************************
  2367
  2368 01  ACCOUNT-MASTER.
  2369     12  AM-RECORD-ID                      PIC XX.
  2370         88  VALID-AM-ID                      VALUE 'AM'.
  2371
  2372     12  AM-CONTROL-PRIMARY.
  2373         16  AM-COMPANY-CD                 PIC X.
  2374         16  AM-MSTR-CNTRL.
  2375             20  AM-CONTROL-A.
  2376                 24  AM-CARRIER            PIC X.
  2377                 24  AM-GROUPING.
  2378                     28 AM-GROUPING-PREFIX PIC XXX.
  2379                     28 AM-GROUPING-PRIME  PIC XXX.
  2380                 24  AM-STATE              PIC XX.
  2381                 24  AM-ACCOUNT.
  2382                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2383                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2384             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2385                                           PIC X(19).
  2386             20  AM-CNTRL-B.
  2387                 24  AM-EXPIRATION-DT      PIC XX.
  2388                 24  FILLER                PIC X(4).
  2389             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2390                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2391
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* SOCK03.cbl
  2392     12  AM-CONTROL-BY-VAR-GRP.
  2393         16  AM-COMPANY-CD-A1              PIC X.
  2394         16  AM-VG-CARRIER                 PIC X.
  2395         16  AM-VG-GROUPING                PIC X(6).
  2396         16  AM-VG-STATE                   PIC XX.
  2397         16  AM-VG-ACCOUNT                 PIC X(10).
  2398         16  AM-VG-DATE.
  2399             20  AM-VG-EXPIRATION-DT       PIC XX.
  2400             20  FILLER                    PIC X(4).
  2401         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2402                                           PIC 9(11)      COMP-3.
  2403     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2404         16  FILLER                        PIC X(10).
  2405         16  AM-VG-KEY3.
  2406             20  AM-VG3-ACCOUNT            PIC X(10).
  2407             20  AM-VG3-EXP-DT             PIC XX.
  2408         16  FILLER                        PIC X(4).
  2409     12  AM-MAINT-INFORMATION.
  2410         16  AM-LAST-MAINT-DT              PIC XX.
  2411         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2412         16  AM-LAST-MAINT-USER            PIC X(4).
  2413         16  FILLER                        PIC XX.
  2414
  2415     12  AM-EFFECTIVE-DT                   PIC XX.
  2416     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2417
  2418     12  AM-PREV-DATES  COMP-3.
  2419         16  AM-PREV-EXP-DT                PIC 9(11).
  2420         16  AM-PREV-EFF-DT                PIC 9(11).
  2421
  2422     12  AM-REPORT-CODE-1                  PIC X(10).
  2423     12  AM-REPORT-CODE-2                  PIC X(10).
  2424
  2425     12  AM-CITY-CODE                      PIC X(4).
  2426     12  AM-COUNTY-PARISH                  PIC X(6).
  2427
  2428     12  AM-NAME                           PIC X(30).
  2429     12  AM-PERSON                         PIC X(30).
  2430     12  AM-ADDRS                          PIC X(30).
  2431     12  AM-CITY.
  2432         16  AM-ADDR-CITY                  PIC X(28).
  2433         16  AM-ADDR-STATE                 PIC XX.
  2434     12  AM-ZIP.
  2435         16  AM-ZIP-PRIME.
  2436             20  AM-ZIP-PRI-1ST            PIC X.
  2437                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2438             20  FILLER                    PIC X(4).
  2439         16  AM-ZIP-PLUS4                  PIC X(4).
  2440     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2441         16  AM-CAN-POSTAL-1               PIC XXX.
  2442         16  AM-CAN-POSTAL-2               PIC XXX.
  2443         16  FILLER                        PIC XXX.
  2444     12  AM-TEL-NO.
  2445         16  AM-AREA-CODE                  PIC 999.
  2446         16  AM-TEL-PRE                    PIC 999.
  2447         16  AM-TEL-NBR                    PIC 9(4).
  2448     12  AM-TEL-LOC                        PIC X.
  2449         88  AM-TEL-AT-HOME                   VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* SOCK03.cbl
  2450         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2451
  2452     12  AM-COMM-STRUCTURE.
  2453         16  AM-DEFN-1.
  2454             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2455                 24  AM-AGT.
  2456                     28  AM-AGT-PREFIX     PIC X(4).
  2457                     28  AM-AGT-PRIME      PIC X(6).
  2458                 24  AM-COM-TYP            PIC X.
  2459                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2460                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2461                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2462                 24  AM-RECALC-LV-INDIC    PIC X.
  2463                 24  AM-RETRO-LV-INDIC     PIC X.
  2464                 24  AM-GL-CODES           PIC X.
  2465                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2466                 24  FILLER                PIC X(01).
  2467         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2468             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2469                 24  FILLER                PIC X(11).
  2470                 24  AM-L-COMA             PIC XXX.
  2471                 24  AM-J-COMA             PIC XXX.
  2472                 24  AM-A-COMA             PIC XXX.
  2473                 24  FILLER                PIC X(6).
  2474
  2475     12  AM-COMM-CHANGE-STATUS             PIC X.
  2476         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2477
  2478     12  AM-CSR-CODE                       PIC X(4).
  2479
  2480     12  AM-BILLING-STATUS                 PIC X.
  2481         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2482         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2483     12  AM-AUTO-REFUND-SW                 PIC X.
  2484         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2485         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2486     12  AM-GPCD                           PIC 99.
  2487     12  AM-IG                             PIC X.
  2488         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2489         88  AM-HAS-GROUP                     VALUE '2'.
  2490     12  AM-STATUS                         PIC X.
  2491         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2492         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2493         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2494         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2495         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2496         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2497     12  AM-REMIT-TO                       PIC 99.
  2498     12  AM-ID-NO                          PIC X(11).
  2499
  2500     12  AM-CAL-TABLE                      PIC XX.
  2501     12  AM-LF-DEVIATION                   PIC XXX.
  2502     12  AM-AH-DEVIATION                   PIC XXX.
  2503     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2504     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2505     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2506     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2507     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* SOCK03.cbl
  2508     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2509
  2510     12  AM-USER-FIELDS.
  2511         16  AM-FLD-1                      PIC XX.
  2512         16  AM-FLD-2                      PIC XX.
  2513         16  AM-FLD-3                      PIC XX.
  2514         16  AM-FLD-4                      PIC XX.
  2515         16  AM-FLD-5                      PIC XX.
  2516
  2517     12  AM-1ST-PROD-DATE.
  2518         16  AM-1ST-PROD-YR                PIC XX.
  2519         16  AM-1ST-PROD-MO                PIC XX.
  2520         16  AM-1ST-PROD-DA                PIC XX.
  2521     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2522     12  AM-CERTS-PURGED-DATE.
  2523         16  AM-PUR-YR                     PIC XX.
  2524         16  AM-PUR-MO                     PIC XX.
  2525         16  AM-PUR-DA                     PIC XX.
  2526     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2527     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2528     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2529     12  AM-INACTIVE-DATE.
  2530         16  AM-INA-MO                     PIC 99.
  2531         16  AM-INA-DA                     PIC 99.
  2532         16  AM-INA-YR                     PIC 99.
  2533     12  AM-AR-HI-CERT-DATE                PIC XX.
  2534
  2535     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2536     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2537
  2538     12  AM-OB-PAYMENT-MODE                PIC X.
  2539         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2540         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2541         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2542         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2543
  2544     12  AM-AH-ONLY-INDICATOR              PIC X.
  2545         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2546         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2547
  2548     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2549
  2550     12  AM-OVER-SHORT.
  2551         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2552         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2553
  2554     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2555     12  AM-DCC-CLP-STATE                  PIC XX.
  2556
  2557     12  AM-RECALC-COMM                    PIC X.
  2558     12  AM-RECALC-REIN                    PIC X.
  2559
  2560     12  AM-REI-TABLE                      PIC XXX.
  2561     12  AM-REI-ET-LF                      PIC X.
  2562     12  AM-REI-ET-AH                      PIC X.
  2563     12  AM-REI-PE-LF                      PIC X.
  2564     12  AM-REI-PE-AH                      PIC X.
  2565     12  AM-REI-PRT-ST                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* SOCK03.cbl
  2566     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2567     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2568     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2569     12  AM-REI-GROUP-A                    PIC X(6).
  2570     12  AM-REI-MORT                       PIC X(4).
  2571     12  AM-REI-PRT-OW                     PIC X.
  2572     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2573     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2574     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2575     12  AM-REI-GROUP-B                    PIC X(6).
  2576
  2577     12  AM-TRUST-TYPE                     PIC X(2).
  2578
  2579     12  AM-EMPLOYER-STMT-USED             PIC X.
  2580     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2581
  2582     12  AM-STD-AH-TYPE                    PIC XX.
  2583     12  AM-EARN-METHODS.
  2584         16  AM-EARN-METHOD-R              PIC X.
  2585             88 AM-REF-RL-R78                 VALUE 'R'.
  2586             88 AM-REF-RL-PR                  VALUE 'P'.
  2587             88 AM-REF-RL-MEAN                VALUE 'M'.
  2588             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2589         16  AM-EARN-METHOD-L              PIC X.
  2590             88 AM-REF-LL-R78                 VALUE 'R'.
  2591             88 AM-REF-LL-PR                  VALUE 'P'.
  2592             88 AM-REF-LL-MEAN                VALUE 'M'.
  2593             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2594         16  AM-EARN-METHOD-A              PIC X.
  2595             88 AM-REF-AH-R78                 VALUE 'R'.
  2596             88 AM-REF-AH-PR                  VALUE 'P'.
  2597             88 AM-REF-AH-MEAN                VALUE 'M'.
  2598             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2599             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2600             88 AM-REF-AH-NET                 VALUE 'N'.
  2601
  2602     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2603     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2604     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2605
  2606     12  AM-RET-Y-N                        PIC X.
  2607     12  AM-RET-P-E                        PIC X.
  2608     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2609     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2610     12  AM-RET-GRP                        PIC X(6).
  2611     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2612         16  AM-POOL-PRIME                 PIC XXX.
  2613         16  AM-POOL-SUB                   PIC XXX.
  2614     12  AM-RETRO-EARNINGS.
  2615         16  AM-RET-EARN-R                 PIC X.
  2616         16  AM-RET-EARN-L                 PIC X.
  2617         16  AM-RET-EARN-A                 PIC X.
  2618     12  AM-RET-ST-TAX-USE                 PIC X.
  2619         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2620         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2621     12  AM-RETRO-BEG-EARNINGS.
  2622         16  AM-RET-BEG-EARN-R             PIC X.
  2623         16  AM-RET-BEG-EARN-L             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* SOCK03.cbl
  2624         16  AM-RET-BEG-EARN-A             PIC X.
  2625     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2626     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2627
  2628     12  AM-USER-SELECT-OPTIONS.
  2629         16  AM-USER-SELECT-1              PIC X(10).
  2630         16  AM-USER-SELECT-2              PIC X(10).
  2631         16  AM-USER-SELECT-3              PIC X(10).
  2632         16  AM-USER-SELECT-4              PIC X(10).
  2633         16  AM-USER-SELECT-5              PIC X(10).
  2634
  2635     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2636
  2637     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2638
  2639     12  AM-RPT045A-SWITCH                 PIC X.
  2640         88  RPT045A-OFF                   VALUE 'N'.
  2641
  2642     12  AM-INSURANCE-LIMITS.
  2643         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2644         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2645
  2646     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2647         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2648
  2649     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2650         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2651         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2652
  2653     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2654
  2655     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2656     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2657     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2658     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2659     12  AM-DCC-UEF-STATE                  PIC XX.
  2660     12  FILLER                            PIC XXX.
  2661     12  AM-REPORT-CODE-3                  PIC X(10).
  2662*    12  FILLER                            PIC X(22).
  2663
  2664     12  AM-RESERVE-DATE.
  2665         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2666         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2667         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2668
  2669     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2670     12  AM-NOTIFICATION-TYPES.
  2671         16  AM-NOTIF-OF-LETTERS           PIC X.
  2672         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2673         16  AM-NOTIF-OF-REPORTS           PIC X.
  2674         16  AM-NOTIF-OF-STATUS            PIC X.
  2675
  2676     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2677         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2678         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2679         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2680         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2681
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* SOCK03.cbl
  2682     12  AM-BENEFIT-CONTROLS.
  2683         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2684             20  AM-BENEFIT-CODE           PIC XX.
  2685             20  AM-BENEFIT-TYPE           PIC X.
  2686             20  AM-BENEFIT-REVISION       PIC XXX.
  2687             20  AM-BENEFIT-REM-TERM       PIC X.
  2688             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2689             20  FILLER                    PIC XX.
  2690         16  FILLER                        PIC X(80).
  2691
  2692     12  AM-TRANSFER-DATA.
  2693         16  AM-TRANSFERRED-FROM.
  2694             20  AM-TRNFROM-CARRIER        PIC X.
  2695             20  AM-TRNFROM-GROUPING.
  2696                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2697                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2698             20  AM-TRNFROM-STATE          PIC XX.
  2699             20  AM-TRNFROM-ACCOUNT.
  2700                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2701                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2702             20  AM-TRNFROM-DTE            PIC XX.
  2703         16  AM-TRANSFERRED-TO.
  2704             20  AM-TRNTO-CARRIER          PIC X.
  2705             20  AM-TRNTO-GROUPING.
  2706                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2707                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2708             20  AM-TRNTO-STATE            PIC XX.
  2709             20  AM-TRNTO-ACCOUNT.
  2710                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2711                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2712             20  AM-TRNTO-DTE              PIC XX.
  2713         16  FILLER                        PIC X(10).
  2714
  2715     12  AM-SAVED-REMIT-TO                 PIC 99.
  2716
  2717     12  AM-COMM-STRUCTURE-SAVED.
  2718         16  AM-DEFN-1-SAVED.
  2719             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2720                 24  AM-AGT-SV             PIC X(10).
  2721                 24  AM-COM-TYP-SV         PIC X.
  2722                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2723                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2724                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2725                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2726                 24  FILLER                PIC X.
  2727                 24  AM-GL-CODES-SV        PIC X.
  2728                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2729                 24  FILLER                PIC X.
  2730         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2731             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2732                 24  FILLER                PIC X(11).
  2733                 24  AM-L-COMA-SV          PIC XXX.
  2734                 24  AM-J-COMA-SV          PIC XXX.
  2735                 24  AM-A-COMA-SV          PIC XXX.
  2736                 24  FILLER                PIC X(6).
  2737
  2738     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2739         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* SOCK03.cbl
  2740            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2741            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2742            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2743
  2744     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2745     12  FILLER                            PIC X(120).
  2746
  2747     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2748         16  AM-CONTROL-NAME               PIC X(30).
  2749         16  AM-EXECUTIVE-ONE.
  2750             20  AM-EXEC1-NAME             PIC X(15).
  2751             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2752                                                          COMP-3.
  2753             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2754                                                          COMP-3.
  2755         16  AM-EXECUTIVE-TWO.
  2756             20  AM-EXEC2-NAME             PIC X(15).
  2757             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2758                                                          COMP-3.
  2759             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2760                                                          COMP-3.
  2761
  2762     12  AM-RETRO-ADDITIONAL-DATA.
  2763         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2764         16  AM-RETRO-PREM-P-E             PIC X.
  2765         16  AM-RETRO-CLMS-P-I             PIC X.
  2766         16  AM-RETRO-RET-BRACKET-LF.
  2767             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2768                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2769                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2770             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2771                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2772                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2773             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2774                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2775                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2776         16  AM-RETRO-RET-BRACKET-AH.
  2777             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2778                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2779                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2780                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2781             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2782                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2783                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2784             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2785                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2786                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2787
  2788     12  AM-COMMENTS.
  2789         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2790
  2791     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2792         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2793         16  AM-FLI-BILLING-CODE           PIC X.
  2794         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2795         16  AM-FLI-UNITED-IDENT           PIC X.
  2796         16  AM-FLI-INTEREST-LOST-DATA.
  2797             20  AM-FLI-BANK-NO            PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* SOCK03.cbl
  2798             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2799             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2800             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2801         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2802             20  AM-FLI-AGT                PIC X(9).
  2803             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2804             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2805         16  FILLER                        PIC X(102).
  2806
  2807     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2808         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2809             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2810             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2811             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2812             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2813             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2814         16  FILLER                          PIC X(10).
  2815******************************************************************
  2816*                                 COPY ELCDATE.
  2817******************************************************************
  2818*                                                                *
  2819*                                                                *
  2820*                            ELCDATE.                            *
  2821*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2822*                            VMOD=2.003
  2823*                                                                *
  2824*                                                                *
  2825*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2826*                 LENGTH = 200                                   *
  2827******************************************************************
  2828
  2829 01  DATE-CONVERSION-DATA.
  2830     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2831     12  DC-OPTION-CODE                PIC X.
  2832         88  BIN-TO-GREG                VALUE ' '.
  2833         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2834         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2835         88  YMD-GREG-TO-BIN            VALUE '3'.
  2836         88  MDY-GREG-TO-BIN            VALUE '4'.
  2837         88  JULIAN-TO-BIN              VALUE '5'.
  2838         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2839         88  FIND-CENTURY               VALUE '7'.
  2840         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2841         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2842         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2843         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2844         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2845         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2846         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2847         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2848         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2849         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2850         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2851         88  BIN-3-TO-GREG              VALUE 'I'.
  2852         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2853         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2854         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2855         88  MDCY-GREG-TO-BIN           VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* SOCK03.cbl
  2856         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2857         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2858         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2859         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2860         88  THREE-CHARACTER-BIN
  2861                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2862         88  GREGORIAN-TO-BIN
  2863                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2864         88  BIN-TO-GREGORIAN
  2865                  VALUES ' ' '1' 'I' '8' 'G'.
  2866         88  JULIAN-TO-BINARY
  2867                  VALUES '5' 'C' 'E' 'F'.
  2868     12  DC-ERROR-CODE                 PIC X.
  2869         88  NO-CONVERSION-ERROR        VALUE ' '.
  2870         88  DATE-CONVERSION-ERROR
  2871                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2872         88  DATE-IS-ZERO               VALUE '1'.
  2873         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  2874         88  DATE-IS-INVALID            VALUE '3'.
  2875         88  DATE1-GREATER-DATE2        VALUE '4'.
  2876         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2877         88  DATE-INVALID-OPTION        VALUE '9'.
  2878         88  INVALID-CENTURY            VALUE 'A'.
  2879         88  ONLY-CENTURY               VALUE 'B'.
  2880         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2881         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2882     12  DC-END-OF-MONTH               PIC X.
  2883         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2884     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2885         88  USE-NORMAL-PROCESS         VALUE ' '.
  2886         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2887         88  ADJUST-UP-100-YRS          VALUE '2'.
  2888     12  FILLER                        PIC X.
  2889     12  DC-CONVERSION-DATES.
  2890         16  DC-BIN-DATE-1             PIC XX.
  2891         16  DC-BIN-DATE-2             PIC XX.
  2892         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2893         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2894                       DC-GREG-DATE-1-EDIT.
  2895             20  DC-EDIT1-MONTH        PIC 99.
  2896             20  SLASH1-1              PIC X.
  2897             20  DC-EDIT1-DAY          PIC 99.
  2898             20  SLASH1-2              PIC X.
  2899             20  DC-EDIT1-YEAR         PIC 99.
  2900         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2901         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2902                     DC-GREG-DATE-2-EDIT.
  2903             20  DC-EDIT2-MONTH        PIC 99.
  2904             20  SLASH2-1              PIC X.
  2905             20  DC-EDIT2-DAY          PIC 99.
  2906             20  SLASH2-2              PIC X.
  2907             20  DC-EDIT2-YEAR         PIC 99.
  2908         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2909         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2910                     DC-GREG-DATE-1-YMD.
  2911             20  DC-YMD-YEAR           PIC 99.
  2912             20  DC-YMD-MONTH          PIC 99.
  2913             20  DC-YMD-DAY            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* SOCK03.cbl
  2914         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2915         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2916                      DC-GREG-DATE-1-MDY.
  2917             20  DC-MDY-MONTH          PIC 99.
  2918             20  DC-MDY-DAY            PIC 99.
  2919             20  DC-MDY-YEAR           PIC 99.
  2920         16  DC-GREG-DATE-1-ALPHA.
  2921             20  DC-ALPHA-MONTH        PIC X(10).
  2922             20  DC-ALPHA-DAY          PIC 99.
  2923             20  FILLER                PIC XX.
  2924             20  DC-ALPHA-CENTURY.
  2925                 24 DC-ALPHA-CEN-N     PIC 99.
  2926             20  DC-ALPHA-YEAR         PIC 99.
  2927         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2928         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2929         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2930         16  DC-JULIAN-DATE            PIC 9(05).
  2931         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  2932                                       PIC 9(05).
  2933         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2934             20  DC-JULIAN-YEAR        PIC 99.
  2935             20  DC-JULIAN-DAYS        PIC 999.
  2936         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2937         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2938         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2939     12  DATE-CONVERSION-VARIBLES.
  2940         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2941         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2942             20  FILLER                PIC 9(3).
  2943             20  HOLD-CEN-1-CCYY.
  2944                 24  HOLD-CEN-1-CC     PIC 99.
  2945                 24  HOLD-CEN-1-YY     PIC 99.
  2946             20  HOLD-CEN-1-MO         PIC 99.
  2947             20  HOLD-CEN-1-DA         PIC 99.
  2948         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2949             20  HOLD-CEN-1-R-MO       PIC 99.
  2950             20  HOLD-CEN-1-R-DA       PIC 99.
  2951             20  HOLD-CEN-1-R-CCYY.
  2952                 24  HOLD-CEN-1-R-CC   PIC 99.
  2953                 24  HOLD-CEN-1-R-YY   PIC 99.
  2954             20  FILLER                PIC 9(3).
  2955         16  HOLD-CENTURY-1-X.
  2956             20  FILLER                PIC X(3)  VALUE SPACES.
  2957             20  HOLD-CEN-1-X-CCYY.
  2958                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2959                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2960             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2961             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2962         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2963             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2964             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2965             20  HOLD-CEN-1-R-X-CCYY.
  2966                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2967                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2968             20  FILLER                PIC XXX.
  2969         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2970         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2971         16  DC-JULIAN-DATE-1          PIC 9(07).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* SOCK03.cbl
  2972         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2973             20  DC-JULIAN-1-CCYY.
  2974                 24  DC-JULIAN-1-CC    PIC 99.
  2975                 24  DC-JULIAN-1-YR    PIC 99.
  2976             20  DC-JULIAN-DA-1        PIC 999.
  2977         16  DC-JULIAN-DATE-2          PIC 9(07).
  2978         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2979             20  DC-JULIAN-2-CCYY.
  2980                 24  DC-JULIAN-2-CC    PIC 99.
  2981                 24  DC-JULIAN-2-YR    PIC 99.
  2982             20  DC-JULIAN-DA-2        PIC 999.
  2983         16  DC-GREG-DATE-A-EDIT.
  2984             20  DC-EDITA-MONTH        PIC 99.
  2985             20  SLASHA-1              PIC X VALUE '/'.
  2986             20  DC-EDITA-DAY          PIC 99.
  2987             20  SLASHA-2              PIC X VALUE '/'.
  2988             20  DC-EDITA-CCYY.
  2989                 24  DC-EDITA-CENT     PIC 99.
  2990                 24  DC-EDITA-YEAR     PIC 99.
  2991         16  DC-GREG-DATE-B-EDIT.
  2992             20  DC-EDITB-MONTH        PIC 99.
  2993             20  SLASHB-1              PIC X VALUE '/'.
  2994             20  DC-EDITB-DAY          PIC 99.
  2995             20  SLASHB-2              PIC X VALUE '/'.
  2996             20  DC-EDITB-CCYY.
  2997                 24  DC-EDITB-CENT     PIC 99.
  2998                 24  DC-EDITB-YEAR     PIC 99.
  2999         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3000         16  DC-GREG-DATE-CYMD-R REDEFINES
  3001                              DC-GREG-DATE-CYMD.
  3002             20  DC-CYMD-CEN           PIC 99.
  3003             20  DC-CYMD-YEAR          PIC 99.
  3004             20  DC-CYMD-MONTH         PIC 99.
  3005             20  DC-CYMD-DAY           PIC 99.
  3006         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3007         16  DC-GREG-DATE-MDCY-R REDEFINES
  3008                              DC-GREG-DATE-MDCY.
  3009             20  DC-MDCY-MONTH         PIC 99.
  3010             20  DC-MDCY-DAY           PIC 99.
  3011             20  DC-MDCY-CEN           PIC 99.
  3012             20  DC-MDCY-YEAR          PIC 99.
  3013    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3014        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3015    12  DC-EL310-DATE                  PIC X(21).
  3016    12  FILLER                         PIC X(28).
  3017*                                 COPY ELCCALC.
  3018******************************************************************
  3019*                                                                *
  3020*                           ELCCALC.                            *
  3021*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3022*                            VMOD=2.025                          *
  3023*                                                                *
  3024*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *
  3025*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *
  3026*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *
  3027*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *
  3028*                                                                *
  3029*  PASSED TO ELRTRM                                              *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* SOCK03.cbl
  3030*  -----------------                                             *
  3031*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *
  3032*  ORIGINAL TERM                                                 *
  3033*  BEGINNING DATE                                                *
  3034*  ENDING DATE                                                   *
  3035*  COMPANY I.D.                                                  *
  3036*  ACCOUNT MASTER USER FIELD                                     *
  3037*  PROCESS SWITCH (CANCEL, CLAIM)                                *
  3038*  FREE LOOK DAYS                                                *
  3039*                                                                *
  3040*  RETURNED FROM ELRTRM                                          *
  3041*  ---------------------                                         *
  3042*  REMAINING TERM 1 - USED FOR EARNINGS                          *
  3043*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *
  3044*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *
  3045*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *
  3046*----------------------------------------------------------------*
  3047*  PASSED TO ELRAMT                                              *
  3048*  ----------------                                              *
  3049*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *
  3050*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3051*  ORIGINAL AMOUNT                                               *
  3052*  ALTERNATE BENEFIT (BALLON)                                    *
  3053*  A.P.R. - NET PAY ONLY                                         *
  3054*  METHOD
  3055*  PAYMENT FREQUENCY - FOR FARM PLAN                             *
  3056*  COMPANY I.D.                                                  *
  3057*  BENEFIT TYPE                                                  *
  3058*                                                                *
  3059*  RETURNED FROM ELRAMT                                          *
  3060*  --------------------                                          *
  3061*  REMAINING AMOUNT 1 - CURRENT                                  *
  3062*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *
  3063*  REMAINING AMOUNT FACTOR
  3064*----------------------------------------------------------------*
  3065*  PASSED TO ELRESV                                              *
  3066*  -----------------                                             *
  3067*  CERTIFICATE EFFECTIVE DATE                                    *
  3068*  VALUATION DATE                                                *
  3069*  PAID THRU DATE                                                *
  3070*  BENEFIT                                                       *
  3071*  INCURRED DATE                                                 *
  3072*  REPORTED DATE                                                 *
  3073*  ISSUE AGE                                                     *
  3074*  TERM                                                          *
  3075*  CDT PERCENT                                                   *
  3076*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *
  3077* *CLAIM TYPE (LIFE, A/H)                                        *
  3078* *REMAINING BENEFIT (FROM ELRAMT)                               *
  3079* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *
  3080*                                                                *
  3081*  RETURNED FROM ELRESV                                          *
  3082*  --------------------                                          *
  3083*  CDT TABLE USED                                                *
  3084*  CDT FACTOR USED                                               *
  3085*  PAY TO CURRENT RESERVE                                        *
  3086*  I.B.N.R. - A/H ONLY                                           *
  3087*  FUTURE (ACCRUED) AH ONLY                                      *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* SOCK03.cbl
  3088*----------------------------------------------------------------*
  3089*  PASSED TO ELRATE                                              *
  3090*  ----------------                                              *
  3091*  CERT ISSUE DATE                                               *
  3092*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3093*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3094*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *
  3095*  STATE CODE (CLIENT DEFINED)                                   *
  3096*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3097*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3098*  DEVIATION CODE                                                *
  3099*  ISSUE AGE                                                     *
  3100*  ORIGINAL BENEFIT AMOUNT                                       *
  3101*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3102*  PROCESS TYPE (ISSUE OR CANCEL)                                *
  3103*  BENEFIT KIND (LIFE OR A/H)                                    *
  3104*  A.P.R.                                                        *
  3105*  METHOD
  3106*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3107*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3108*  COMPANY I.D. (3 CHARACTER)                                    *
  3109*  BENEFIT CODE                                                  *
  3110*  BENEFIT OVERRIDE CODE                                         *
  3111*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *
  3112*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *
  3113*  JOINT INDICATOR (CSL ONLY)                                    *
  3114*  FIRST PAYMENT DATE (CSL ONLY)                                 *
  3115*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *
  3116*                                                                *
  3117*  RETURNED FROM ELRATE                                          *
  3118*  --------------------                                          *
  3119*  CALCULATED PREMIUM                                            *
  3120*  PREMIUM RATE                                                  *
  3121*  MORTALITY CODE                                                *
  3122*  MAX ATTAINED AGE                                              *
  3123*  MAX AGE                                                       *
  3124*  MAX TERM                                                      *
  3125*  MAX MONTHLY BENEFIT                                           *
  3126*  MAX TOTAL BENIFIT                                             *
  3127*  COMPOSITE RATE (OPEN-END ONLY)                                *
  3128*----------------------------------------------------------------*
  3129*  PASSED TO ELRFND                                              *
  3130*  ----------------                                              *
  3131*  CERT ISSUE DATE                                               *
  3132*  REFUND DATE                                                   *
  3133*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3134*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3135*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *
  3136*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3137*  STATE CODE (CLIENT DEFINED)                                   *
  3138*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3139*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3140*  DEVIATION CODE                                                *
  3141*  ISSUE AGE                                                     *
  3142*  ORIGINAL BENEFIT AMOUNT                                       *
  3143*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *
  3144*  PROCESS TYPE (CANCEL)                                         *
  3145*  BENEFIT KIND (LIFE OR A/H)                                    *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* SOCK03.cbl
  3146*  A.P.R.                                                        *
  3147*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *
  3148*  RATING METHOD -  (CODE FROM BENEFIT)                          *
  3149*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3150*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3151*  COMPANY I.D. (3 CHARACTER)                                    *
  3152*  BENEFIT CODE                                                  *
  3153*  BENEFIT OVERRIDE CODE                                         *
  3154*                                                                *
  3155*  RETURNED FROM ELRFND                                          *
  3156*  --------------------                                          *
  3157*  CALCULATED REFUND                                             *
  3158*----------------------------------------------------------------*
  3159*  PASSED TO ELEARN                                              *
  3160*  ----------------                                              *
  3161*  CERT ISSUE DATE                                               *
  3162*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *
  3163*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *
  3164*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *
  3165*  STATE CODE (CLIENT DEFINED)                                   *
  3166*  STATE CODE (STANDARD P.O. ABBRV)                              *
  3167*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *
  3168*  DEVIATION CODE                                                *
  3169*  ISSUE AGE                                                     *
  3170*  ORIGINAL BENEFIT AMOUNT                                       *
  3171*  BENEFIT KIND (LIFE OR A/H)                                    *
  3172*  A.P.R.                                                        *
  3173*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *
  3174*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *
  3175*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *
  3176*  COMPANY I.D. (3 CHARACTER)                                    *
  3177*  BENEFIT CODE                                                  *
  3178*  BENEFIT OVERRIDE CODE                                         *
  3179*                                                                *
  3180*  RETURNED FROM ELEARN                                          *
  3181*  --------------------                                          *
  3182*  INDICATED  EARNINGS                                           *
  3183*----------------------------------------------------------------*
  3184*                 LENGTH = 450                                   *
  3185*                                                                *
  3186******************************************************************
  3187******************************************************************
  3188*                   C H A N G E   L O G
  3189*
  3190* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3191*-----------------------------------------------------------------
  3192*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3193* EFFECTIVE    NUMBER
  3194*-----------------------------------------------------------------
  3195* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  3196* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3197* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  3198* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  3199* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  3200* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  3201* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  3202* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  3203* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* SOCK03.cbl
  3204******************************************************************
  3205
  3206 01  CALCULATION-PASS-AREA.
  3207     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450
  3208                                     COMP.
  3209
  3210     12  CP-RETURN-CODE            PIC X             VALUE ZERO.
  3211       88  NO-CP-ERROR                             VALUE ZERO.
  3212       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'
  3213                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.
  3214       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.
  3215       88  CP-ERROR-IN-DATES                       VALUE '2'.
  3216       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.
  3217       88  CP-ERROR-IN-TERMS                       VALUE '4'.
  3218       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.
  3219       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.
  3220       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.
  3221       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.
  3222       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.
  3223       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.
  3224       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.
  3225       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.
  3226       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.
  3227       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.
  3228       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.
  3229       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.
  3230       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.
  3231
  3232     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.
  3233       88  NO-CP-ERROR-2                           VALUE ZERO.
  3234***********************  INPUT AREAS ****************************
  3235
  3236     12  CP-CALCULATION-AREA.
  3237         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.
  3238         16  CP-CERT-EFF-DT        PIC XX.
  3239         16  CP-VALUATION-DT       PIC XX.
  3240         16  CP-PAID-THRU-DT       PIC XX.
  3241         16  CP-BENEFIT-TYPE       PIC X.
  3242           88  CP-AH                               VALUE 'A' 'D'
  3243                                                   'I' 'U'.
  3244           88  CP-REDUCING-LIFE                    VALUE 'R'.
  3245           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.
  3246         16  CP-INCURRED-DT        PIC XX.
  3247         16  CP-REPORTED-DT        PIC XX.
  3248         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.
  3249         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.
  3250         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO
  3251                                     COMP-3.
  3252         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO
  3253                                     COMP-3.
  3254         16  CP-CDT-METHOD         PIC X.
  3255           88  CP-CDT-ROUND-NEAR                   VALUE '1'.
  3256           88  CP-CDT-ROUND-HIGH                   VALUE '2'.
  3257           88  CP-CDT-INTERPOLATED                 VALUE '3'.
  3258         16  CP-CLAIM-TYPE         PIC X.
  3259           88  CP-AH-CLAIM                         VALUE 'A'.
  3260           88  CP-LIFE-CLAIM                       VALUE 'L'.
  3261         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* SOCK03.cbl
  3262                                     COMP-3.
  3263         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO
  3264                                     COMP-3.
  3265         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO
  3266                                     COMP-3.
  3267         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO
  3268                                     COMP-3.
  3269         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3270                                     COMP-3.
  3271         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO
  3272                                     COMP-3.
  3273         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO
  3274                                     COMP-3.
  3275         16  CP-REM-TERM-METHOD    PIC X.
  3276           88  CP-EARN-AFTER-15TH                  VALUE '1'.
  3277           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.
  3278           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.
  3279           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.
  3280           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.
  3281           88  CP-EARN-AFTER-14TH                  VALUE '6'.
  3282           88  CP-EARN-AFTER-16TH                  VALUE '7'.
  3283         16  CP-EARNING-METHOD     PIC X.
  3284           88  CP-EARN-BY-R78                      VALUE '1' 'R'.
  3285           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.
  3286           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.
  3287           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.
  3288           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.
  3289           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.
  3290           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.
  3291           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.
  3292           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.
  3293           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.
  3294           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  3295           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  3296           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  3297           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  3298         16  CP-PROCESS-TYPE       PIC X.
  3299           88  CP-CLAIM                            VALUE '1'.
  3300           88  CP-CANCEL                           VALUE '2'.
  3301           88  CP-ISSUE                            VALUE '3'.
  3302         16  CP-SPECIAL-CALC-CD    PIC X.
  3303           88  CP-OUTSTANDING-BAL              VALUE 'O'.
  3304           88  CP-1-MTH-INTEREST               VALUE ' '.
  3305           88  CP-0-MTH-INTEREST               VALUE 'A'.
  3306           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.
  3307           88  CP-CRITICAL-PERIOD              VALUE 'C'.
  3308           88  CP-TERM-IS-DAYS                 VALUE 'D'.
  3309           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.
  3310           88  CP-FARM-PLAN                    VALUE 'F'.
  3311           88  CP-RATE-AS-STANDARD             VALUE 'G'.
  3312           88  CP-2-MTH-INTEREST               VALUE 'I'.
  3313           88  CP-3-MTH-INTEREST               VALUE 'J'.
  3314           88  CP-4-MTH-INTEREST               VALUE 'K'.
  3315           88  CP-BALLOON-LAST-PMT             VALUE 'L'.
  3316           88  CP-MORTGAGE-REC                 VALUE 'M'.
  3317           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.
  3318           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.
  3319           88  CP-NET-PAY-SIMPLE               VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* SOCK03.cbl
  3320           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'
  3321                                                     'W' 'X'.
  3322           88  CP-TRUNCATE-0-MTH               VALUE 'T'.
  3323           88  CP-TRUNCATE-1-MTH               VALUE 'U'.
  3324           88  CP-TRUNCATE-2-MTH               VALUE 'V'.
  3325           88  CP-TRUNCATE-3-MTH               VALUE 'W'.
  3326           88  CP-TRUNCATE-4-MTH               VALUE 'X'.
  3327           88  CP-SUMMARY-REC                  VALUE 'Z'.
  3328           88  CP-PROPERTY-BENEFIT             VALUE '2'.
  3329           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.
  3330           88  CP-AD-D-BENEFIT                 VALUE '4'.
  3331           88  CP-CSL-METH-1                   VALUE '5'.
  3332           88  CP-CSL-METH-2                   VALUE '6'.
  3333           88  CP-CSL-METH-3                   VALUE '7'.
  3334           88  CP-CSL-METH-4                   VALUE '8'.
  3335
  3336         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO
  3337                                     COMP-3.
  3338         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.
  3339         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.
  3340         16  CP-STATE              PIC XX          VALUE SPACE.
  3341         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.
  3342         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.
  3343           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'
  3344               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.
  3345         16  CP-R78-OPTION         PIC X.
  3346           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.
  3347           88  CP-TERM-TIMES-TERM                  VALUE '1'.
  3348
  3349         16  CP-COMPANY-CD         PIC X             VALUE SPACE.
  3350         16  CP-IBNR-RESERVE-SW    PIC X.
  3351         16  CP-CLAIM-STATUS       PIC X.
  3352         16  CP-RATE-FILE          PIC X.
  3353         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO
  3354                                     COMP-3.
  3355
  3356         16  CP-LIFE-OVERRIDE-CODE PIC X.
  3357         16  CP-AH-OVERRIDE-CODE   PIC X.
  3358
  3359         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO
  3360                                     COMP-3.
  3361         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  3362                                   PIC S9(5)V99 COMP-3.
  3363         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO
  3364                                     COMP-3.
  3365         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO
  3366                                     COMP-3.
  3367         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO
  3368                                     COMP-3.
  3369         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  3370                                  PIC S9(7)V99 COMP-3.
  3371
  3372         16  CP-PAID-FROM-DATE     PIC X(02).
  3373         16  CP-CLAIM-CALC-METHOD  PIC X(01).
  3374         16  CP-EXT-DAYS-CALC      PIC X.
  3375           88  CP-EXT-NO-CHG                   VALUE ' '.
  3376           88  CP-EXT-CHG-LF                   VALUE '1'.
  3377           88  CP-EXT-CHG-AH                   VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* SOCK03.cbl
  3378           88  CP-EXT-CHG-LF-AH                VALUE '3'.
  3379         16  CP-DOMICILE-STATE     PIC XX.
  3380         16  CP-CARRIER            PIC X.
  3381         16  CP-REIN-FLAG          PIC X.
  3382         16  CP-REM-TRM-CALC-OPTION PIC X.
  3383           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'
  3384                      '2' '3' '4' '5'.
  3385           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.
  3386           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.
  3387           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.
  3388           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.
  3389           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.
  3390           88  CP-EXT-30-DAY-MONTH          VALUE '3'.
  3391           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.
  3392           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  3393         16  CP-SIG-SWITCH         PIC X.
  3394         16  CP-RATING-METHOD      PIC X.
  3395           88  CP-RATE-AS-R78                      VALUE '1' 'R'.
  3396           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.
  3397           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.
  3398           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.
  3399           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.
  3400           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.
  3401           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.
  3402           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.
  3403           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.
  3404         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS
  3405                                     COMP-3.
  3406         16  CP-BEN-CATEGORY       PIC X.
  3407         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3408         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  3409                                   PIC S99V9(5) COMP-3.
  3410         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  3411         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  3412                                   PIC S99V9(5) COMP-3.
  3413         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  3414         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  3415         16  CP-EXPIRE-DT          PIC XX.
  3416         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  3417         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  3418         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  3419         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  3420         16  CP-DDF-SPEC-CALC      PIC X.
  3421             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  3422             88  CP-CALC-CLP              VALUE 'C'.
  3423         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  3424         16  CP-CANCEL-REASON      PIC X.
  3425         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  3426         16  CP-PMT-MODE           PIC X.
  3427         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  3428         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  3429         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  3430         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  3431         16  FILLER                PIC X.
  3432
  3433***************    OUTPUT FROM ELRESV   ************************
  3434
  3435         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* SOCK03.cbl
  3436
  3437         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO
  3438                                     COMP-3.
  3439         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO
  3440                                     COMP-3.
  3441         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO
  3442                                     COMP-3.
  3443         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO
  3444                                     COMP-3.
  3445         16  FILLER                PIC X(09).
  3446***************    OUTPUT FROM ELRTRM   *************************
  3447
  3448         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO
  3449                                     COMP-3.
  3450         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO
  3451                                     COMP-3.
  3452         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO
  3453                                     COMP-3.
  3454         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO
  3455                                     COMP-3.
  3456         16  FILLER                PIC X(12).
  3457
  3458***************    OUTPUT FROM ELRAMT   *************************
  3459
  3460         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO
  3461                                     COMP-3.
  3462         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO
  3463                                     COMP-3.
  3464         16  FILLER                PIC X(12).
  3465
  3466***************    OUTPUT FROM ELRATE   *************************
  3467
  3468         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO
  3469                                     COMP-3.
  3470         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO
  3471                                     COMP-3.
  3472         16  CP-MORTALITY-CODE     PIC X(4).
  3473         16  CP-RATE-EDIT-FLAG     PIC X.
  3474             88  CP-RATES-NEED-APR                  VALUE '1'.
  3475         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO
  3476                                     COMP-3.
  3477         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.
  3478         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  3479         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  3480                                   PIC S9(7)V99 COMP-3.
  3481         16  FILLER                PIC X(07).
  3482
  3483***************    OUTPUT FROM ELRFND   *************************
  3484
  3485         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO
  3486                                     COMP-3.
  3487         16  CP-REFUND-TYPE-USED   PIC X.
  3488           88  CP-R-AS-R78                         VALUE '1'.
  3489           88  CP-R-AS-PRORATA                     VALUE '2'.
  3490           88  CP-R-AS-CALIF                       VALUE '3'.
  3491           88  CP-R-AS-TEXAS                       VALUE '4'.
  3492           88  CP-R-AS-FARM-PLAN                   VALUE '4'.
  3493           88  CP-R-AS-NET-PAY                     VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* SOCK03.cbl
  3494           88  CP-R-AS-ANTICIPATION                VALUE '6'.
  3495           88  CP-R-AS-MEAN                        VALUE '8'.
  3496           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.
  3497           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  3498           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  3499           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  3500           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  3501           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  3502         16  FILLER                PIC X(12).
  3503
  3504***************    OUTPUT FROM ELEARN   *************************
  3505
  3506         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO
  3507                                     COMP-3.
  3508         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO
  3509                                     COMP-3.
  3510         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO
  3511                                     COMP-3.
  3512         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO
  3513                                     COMP-3.
  3514         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO
  3515                                     COMP-3.
  3516         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO
  3517                                     COMP-3.
  3518         16  CP-EARNING-TYPE-USED  PIC X.
  3519           88  CP-E-AS-SPECIAL                     VALUE 'S'.
  3520           88  CP-E-AS-R78                         VALUE '1'.
  3521           88  CP-E-AS-PRORATA                     VALUE '2'.
  3522           88  CP-E-AS-TEXAS                       VALUE '4'.
  3523           88  CP-E-AS-FARM-PLAN                   VALUE '4'.
  3524           88  CP-E-AS-NET-PAY                     VALUE '5'.
  3525           88  CP-E-AS-ANTICIPATION                VALUE '6'.
  3526           88  CP-E-AS-MEAN                        VALUE '8'.
  3527           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.
  3528         16  FILLER                PIC X(12).
  3529
  3530***************    OUTPUT FROM ELPMNT   *************************
  3531
  3532         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO
  3533                                     COMP-3.
  3534         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO
  3535                                     COMP-3.
  3536         16  FILLER                PIC X(12).
  3537
  3538***************   MISC WORK AREAS    *****************************
  3539         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO
  3540                                     COMP-3.
  3541         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO
  3542                                     COMP-3.
  3543         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO
  3544                                     COMP-3.
  3545         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO
  3546                                     COMP-3.
  3547         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO
  3548                                     COMP-3.
  3549         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO
  3550                                     COMP-3.
  3551         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* SOCK03.cbl
  3552             88  OPEN-RATE-FILE                   VALUE 'O'.
  3553             88  CLOSE-RATE-FILE                  VALUE 'C'.
  3554             88  IO-ERROR                         VALUE 'E'.
  3555
  3556         16  CP-FIRST-PAY-DATE     PIC XX.
  3557
  3558         16  CP-JOINT-INDICATOR    PIC X.
  3559
  3560         16  CP-RESERVE-REMAINING-TERM
  3561                                   PIC S9(4)V9    VALUE ZERO
  3562                                     COMP-3.
  3563
  3564         16  CP-INSURED-BIRTH-DT   PIC XX.
  3565
  3566         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO
  3567                                     COMP-3.
  3568
  3569         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO
  3570                                     COMP-3.
  3571
  3572         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO
  3573                                     COMP-3.
  3574
  3575         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO
  3576                                     COMP-3.
  3577
  3578         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO
  3579                                     COMP-3.
  3580
  3581         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS
  3582                                     COMP-3.
  3583
  3584         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO
  3585                                     COMP-3.
  3586
  3587         16  CP-ROA-REFUND         PIC X          VALUE 'N'.
  3588             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.
  3589
  3590         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO
  3591                                     COMP-3.
  3592         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  3593                                     COMP-3.
  3594         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  3595         16  FILLER                PIC X(15).
  3596******************************************************************
  3597****************************************************************
  3598*
  3599* Copyright (c) 2007 by Clerity Solutions, Inc.
  3600* All rights reserved.
  3601*
  3602****************************************************************
  3603 01  DFHEIV.
  3604   02  DFHEIV0               PIC X(35).
  3605   02  DFHEIV1               PIC X(08).
  3606   02  DFHEIV2               PIC X(08).
  3607   02  DFHEIV3               PIC X(08).
  3608   02  DFHEIV4               PIC X(06).
  3609   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* SOCK03.cbl
  3610   02  DFHEIV6               PIC X(04).
  3611   02  DFHEIV7               PIC X(02).
  3612   02  DFHEIV8               PIC X(02).
  3613   02  DFHEIV9               PIC X(01).
  3614   02  DFHEIV10              PIC S9(7) COMP-3.
  3615   02  DFHEIV11              PIC S9(4) COMP SYNC.
  3616   02  DFHEIV12              PIC S9(4) COMP SYNC.
  3617   02  DFHEIV13              PIC S9(4) COMP SYNC.
  3618   02  DFHEIV14              PIC S9(4) COMP SYNC.
  3619   02  DFHEIV15              PIC S9(4) COMP SYNC.
  3620   02  DFHEIV16              PIC S9(9) COMP SYNC.
  3621   02  DFHEIV17              PIC X(04).
  3622   02  DFHEIV18              PIC X(04).
  3623   02  DFHEIV19              PIC X(04).
  3624   02  DFHEIV20              USAGE IS POINTER.
  3625   02  DFHEIV21              USAGE IS POINTER.
  3626   02  DFHEIV22              USAGE IS POINTER.
  3627   02  DFHEIV23              USAGE IS POINTER.
  3628   02  DFHEIV24              USAGE IS POINTER.
  3629   02  DFHEIV25              PIC S9(9) COMP SYNC.
  3630   02  DFHEIV26              PIC S9(9) COMP SYNC.
  3631   02  DFHEIV27              PIC S9(9) COMP SYNC.
  3632   02  DFHEIV28              PIC S9(9) COMP SYNC.
  3633   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  3634   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  3635   02  FILLER                PIC X(02).
  3636   02  DFHEIV99              PIC X(08) VALUE SPACE.
  3637   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  3638   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  3639   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  3640   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  3641 LINKAGE  SECTION.
  3642*****************************************************************
  3643*                                                               *
  3644* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  3645* All rights reserved.                                          *
  3646*                                                               *
  3647*****************************************************************
  3648 01  dfheiblk.
  3649     02  eibtime          pic s9(7) comp-3.
  3650     02  eibdate          pic s9(7) comp-3.
  3651     02  eibtrnid         pic x(4).
  3652     02  eibtaskn         pic s9(7) comp-3.
  3653     02  eibtrmid         pic x(4).
  3654     02  dfheigdi         pic s9(4) comp.
  3655     02  eibcposn         pic s9(4) comp.
  3656     02  eibcalen         pic s9(4) comp.
  3657     02  eibaid           pic x(1).
  3658     02  eibfiller1       pic x(1).
  3659     02  eibfn            pic x(2).
  3660     02  eibfiller2       pic x(2).
  3661     02  eibrcode         pic x(6).
  3662     02  eibfiller3       pic x(2).
  3663     02  eibds            pic x(8).
  3664     02  eibreqid         pic x(8).
  3665     02  eibrsrce         pic x(8).
  3666     02  eibsync          pic x(1).
  3667     02  eibfree          pic x(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* SOCK03.cbl
  3668     02  eibrecv          pic x(1).
  3669     02  eibsend          pic x(1).
  3670     02  eibatt           pic x(1).
  3671     02  eibeoc           pic x(1).
  3672     02  eibfmh           pic x(1).
  3673     02  eibcompl         pic x(1).
  3674     02  eibsig           pic x(1).
  3675     02  eibconf          pic x(1).
  3676     02  eiberr           pic x(1).
  3677     02  eibrldbk         pic x(1).
  3678     02  eiberrcd         pic x(4).
  3679     02  eibsynrb         pic x(1).
  3680     02  eibnodat         pic x(1).
  3681     02  eibfiller5       pic x(2).
  3682     02  eibresp          pic 9(09) comp.
  3683     02  eibresp2         pic 9(09) comp.
  3684     02  dfheigdj         pic s9(4) comp.
  3685     02  dfheigdk         pic s9(4) comp.
  3686 01  DFHCOMMAREA.
  3687   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  3688   05 LSTN-NAME                PIC X(8).
  3689   05 LSTN-SUBNAME             PIC X(8).
  3690   05 CLIENT-IN-DATA.
  3691      15  CLIENT-CAR           PIC X.
  3692      15  CLIENT-GRP           PIC X(6).
  3693      15  CLIENT-STATE         PIC XX.
  3694      15  CLIENT-ACCOUNT       PIC X(10).
  3695*  DATES ARE IN FORMAT CCYYMMDD  ie. 20090330
  3696      15  CLIENT-EFF-DT        PIC X(8).
  3697      15  CLIENT-CERT-NO       PIC X(11).
  3698      15  CLIENT-LAST-NAME     PIC X(15).
  3699      15  CLIENT-FIRST-NAME    PIC X(10).
  3700      15  CLIENT-VAL-DT        PIC X(8).
  3701   05 SOCKADDR-IN-PARM.
  3702     15 SIN-FAMILY             PIC 9(4) COMP.
  3703     15 SIN-PORT               PIC 9(4) COMP.
  3704     15 SIN-ADDRESS            PIC 9(8) COMP.
  3705     15 SIN-ZERO               PIC X(8).
  3706 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  3707 0000-DFHEXIT SECTION.
  3708     MOVE '9#                    $   ' TO DFHEIV0.
  3709     MOVE 'SOCK03' TO DFHEIV1.
  3710     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3711     display '  BEGIN SOCK03 '
  3712     display 'SOCK03:transaction data =', CLIENT-IN-DATA (1:10)
  3713     display 'SOCK03:socket number    =', GIVE-TAKE-SOCKET.
  3714     IF CLIENT-IN-DATA (1:6) = 'REFUND' OR 'NEWBUS'
  3715        MOVE CLIENT-IN-DATA (1:6) TO WS-CALL-TYPE
  3716        IF CLIENT-IN-DATA (8:3) = 'AHL'
  3717           MOVE X'06'            TO WS-COMP-CD
  3718           MOVE 'AHL'            TO WS-SEND-BUF (5:3)
  3719                                    WS-COMP-ID
  3720        ELSE
  3721           IF CLIENT-IN-DATA (8:3) = 'DCC'
  3722              MOVE X'05'         TO WS-COMP-CD
  3723              MOVE 'DCC'         TO WS-SEND-BUF (5:3)
  3724                                    WS-COMP-ID
  3725           ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* SOCK03.cbl
  3726              MOVE X'04'         TO WS-COMP-CD
  3727              MOVE 'CID'         TO WS-SEND-BUF (5:3)
  3728                                    WS-COMP-ID
  3729           END-IF
  3730        END-IF
  3731        move 'CSO'               to ws-send-buf (1:3)
  3732        move +25                 to ws-send-msg-size
  3733     END-IF
  3734     display 'SOCK03:sequence number  =', ws-seq-num.
  3735     display 'SOCK03:send buffer      =', ws-send-buf(1:25).
  3736     call "send" using by value GIVE-TAKE-SOCKET,
  3737         by reference ws-send-buf,
  3738         by value ws-send-msg-size,
  3739         by value ws-flags.
  3740     if return-code <= zero
  3741         display 'SOCK03:send error ',
  3742         go to socket-error.
  3743     move low-values to ws-recv-buf.
  3744     set ws-recv-total to zero.
  3745     compute ws-recv-left = ws-recv-msg-size.
  3746     display 'SOCK03:About to recv '
  3747     call "recv" using by value GIVE-TAKE-SOCKET,
  3748         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3749         by value ws-recv-left,
  3750         by value ws-flags.
  3751     if return-code < zero
  3752        display 'SOCK03:recv error ',
  3753        go to socket-error.
  3754     if return-code = zero
  3755        display 'SOCK03:client disconnected',
  3756        go to socket-error.
  3757*
  3758     display 'SOCK03:Good recv  '
  3759     display 'SOCK03:return code      = ', return-code
  3760     display 'SOCK03:receive buffer   = ', ws-recv-buf(1:75)
  3761     move +4096                  to ws-send-msg-size
  3762*    move +750                   to ws-send-msg-size
  3763     move ws-recv-buf (1:71)     to client-in-data
  3764     MOVE SPACES                 TO WS-ELCERT-SW
  3765     MOVE X'0A'                  TO WS-HEX-0A
  3766     EVALUATE TRUE
  3767        WHEN (CLIENT-CAR NOT = SPACES)
  3768           AND (CLIENT-STATE NOT = SPACES)
  3769           AND (CLIENT-ACCOUNT NOT = SPACES)
  3770           AND (CLIENT-EFF-DT NOT = SPACES)
  3771           AND (CLIENT-CERT-NO NOT = SPACES)
  3772           SET WS-ELCERT-FULL    TO TRUE
  3773           DISPLAY ' SETTING FULL '
  3774        WHEN (CLIENT-CERT-NO NOT = SPACES)
  3775           SET WS-ELCERT-CERT-NO TO TRUE
  3776           DISPLAY ' SETTING CERT NO '
  3777*       WHEN (CLIENT-EFF-DT NOT = SPACES)
  3778*          AND (CLIENT-LAST-NAME NOT = SPACES)
  3779        WHEN (CLIENT-ACCOUNT NOT = SPACES)
  3780           AND (CLIENT-LAST-NAME NOT = SPACES)
  3781           SET WS-ELCERT-ACT-NAME TO TRUE
  3782        WHEN CLIENT-LAST-NAME NOT = SPACES
  3783           SET WS-ELCERT-NAME    TO TRUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* SOCK03.cbl
  3784           DISPLAY ' SETTING NAME '
  3785        WHEN OTHER
  3786           MOVE ' BAD SELECTION OPTION ' TO WS-COMMENT
  3787           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  3788           MOVE ZEROS            TO WS-RESP
  3789           PERFORM 0030-BUILD-BUFFER
  3790                                 THRU 0030-EXIT
  3791           PERFORM 0020-SEND-BUFFER
  3792                                 THRU 0020-EXIT
  3793           PERFORM 0025-CLOSE-SOCKET
  3794                                 THRU 0025-EXIT
  3795           GO TO 0010-RETURN
  3796     END-EVALUATE
  3797     IF WS-ELCERT-KEY-SW NOT = SPACES
  3798        PERFORM 0050-BEGIN-REFUND-PROCESS
  3799                                 THRU 0050-EXIT
  3800     END-IF
  3801     PERFORM 0025-CLOSE-SOCKET   THRU 0025-EXIT
  3802     .
  3803 0010-RETURN.
  3804
  3805* exec cics return end-exec.
  3806*    MOVE '.(                    &   #00003800' TO DFHEIV0
  3807     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3808     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3809     MOVE X'2020233030303033383030' TO DFHEIV0(25:11)
  3810     CALL 'kxdfhei1' USING DFHEIV0,
  3811           DFHEIV99,
  3812           DFHEIV99,
  3813           DFHEIV99,
  3814           DFHEIV99,
  3815           DFHEIV99
  3816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3817
  3818
  3819* goback.
  3820     MOVE '9%                    "   ' TO DFHEIV0
  3821     MOVE 'SOCK03' TO DFHEIV1
  3822     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3823     goback.
  3824*    PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  3825     .
  3826 0020-SEND-BUFFER.
  3827     display 'SOCK03:About to send      '
  3828     display 'SOCK03:sequence number  =', ws-seq-num.
  3829     display 'SOCK03:send buffer      =', ws-send-buf(1:300).
  3830     call "send" using by value GIVE-TAKE-SOCKET,
  3831         by reference ws-send-buf,
  3832         by value ws-send-msg-size,
  3833         by value ws-flags.
  3834     if return-code <= zero
  3835         display 'SOCK03:send error ' return-code,
  3836         go to socket-error.
  3837 0020-EXIT.
  3838     EXIT.
  3839 0025-CLOSE-SOCKET.
  3840     display 'SOCK03:closing socket'.
  3841     call "close" using by value GIVE-TAKE-SOCKET .
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* SOCK03.cbl
  3842     display 'SOCK03:done'.
  3843     .
  3844 0025-EXIT.
  3845     EXIT.
  3846*
  3847* set up the receive buffer
  3848*
  3849     move low-values to ws-recv-buf.
  3850     set ws-recv-total to zero.
  3851     compute ws-recv-left = ws-recv-msg-size.
  3852*
  3853* receive data
  3854*
  3855 recv-1.
  3856     call "recv" using by value GIVE-TAKE-SOCKET,
  3857         by reference ws-recv-buf(1+ws-recv-total:ws-recv-left),
  3858         by value ws-recv-left,
  3859         by value ws-flags.
  3860*
  3861* test what was received and decide what we should do
  3862*
  3863     if return-code < zero
  3864        display 'SOCK03:recv error ',
  3865        go to socket-error.
  3866     if return-code = zero
  3867        display 'SOCK03:client disconnected',
  3868        go to socket-error.
  3869*
  3870* have we received all the data yet?
  3871*
  3872     compute ws-recv-total = ws-recv-total + return-code.
  3873     compute ws-recv-left = ws-recv-msg-size - ws-recv-total.
  3874*
  3875* not yet
  3876*
  3877     if ws-recv-left > 0 go to recv-1.
  3878*
  3879* received all the data
  3880*
  3881     display 'SOCK03:receive buffer   =', ws-recv-buf(1:50).
  3882*
  3883* make sure what we received was what we sent
  3884*
  3885*    if ws-recv-buf <> ws-send-buf
  3886*        display "SOCK03:data doesn't match",
  3887*        go to socket-error.
  3888*
  3889* end of pass
  3890*
  3891*loop-end.
  3892*    if ws-seq-num = 5 go to socket-error.
  3893*    go to loop-1.
  3894*
  3895* program end
  3896*
  3897 socket-error.
  3898     if ws-seq-num <> 0
  3899         display "SOCK03:did not complete".
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* SOCK03.cbl
  3900*
  3901* flush the send buffer and deallocate
  3902*
  3903*    display 'SOCK03:closing socket'.
  3904*    call "close" using by value GIVE-TAKE-SOCKET .
  3905*
  3906* finised return to cics
  3907*
  3908 socket-fin.
  3909     display 'SOCK03:closing socket'.
  3910     call "close" using by value GIVE-TAKE-SOCKET .
  3911     display 'SOCK03:done'.
  3912
  3913* exec cics return end-exec.
  3914*    MOVE '.(                    &   #00003890' TO DFHEIV0
  3915     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3916     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3917     MOVE X'2020233030303033383930' TO DFHEIV0(25:11)
  3918     CALL 'kxdfhei1' USING DFHEIV0,
  3919           DFHEIV99,
  3920           DFHEIV99,
  3921           DFHEIV99,
  3922           DFHEIV99,
  3923           DFHEIV99
  3924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3925
  3926
  3927* goback.
  3928     MOVE '9%                    "   ' TO DFHEIV0
  3929     MOVE 'SOCK03' TO DFHEIV1
  3930     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3931     goback.
  3932 0030-BUILD-BUFFER.
  3933     MOVE SPACES                 TO WS-SEND-BUF
  3934     IF WS-CALL-TYPE = 'NEWBUS'
  3935        STRING
  3936           WS-COMMENT            ';'
  3937           WS-RESP               ';'
  3938           WS-CARRIER            ';'
  3939           WS-GROUPING           ';'
  3940           WS-STATE              ';'
  3941           WS-ACCOUNT            ';'
  3942           WS-CERT-EFF-DATE      ';'
  3943           WS-CERT-NO            ';'
  3944           WS-LAST-NAME          ';'
  3945           WS-FIRST-NAME         ';'
  3946           WS-MID-INIT           ';'
  3947           WS-LAST-JNAME         ';'
  3948           WS-FIRST-JNAME        ';'
  3949           WS-MID-JINIT          ';'
  3950           WS-POST-CARD-SW       ';'
  3951           WS-LF-STATUS          ';'
  3952           WS-LF-BEN-CODE        ';'
  3953           WS-LF-BEN-CODE-DESC   ';'
  3954           WS-LF-TERM            ';'
  3955           WS-LF-REM-TERM        ';'
  3956           WS-LF-PREM            ';'
  3957           WS-LF-REFUND          ';'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* SOCK03.cbl
  3958           WS-LF-METHOD          ';'
  3959           WS-LF-ORIG-BENEFIT    ';'
  3960           WS-LF-REM-BEN         ';'
  3961           WS-LF-EXPIRE-DATE     ';'
  3962           WS-LF-COMM            ';'
  3963           WS-LF-UEC             ';'
  3964           WS-AH-STATUS          ';'
  3965           WS-AH-BEN-CODE        ';'
  3966           WS-AH-BEN-CODE-DESC   ';'
  3967           WS-AH-TERM            ';'
  3968           WS-AH-REM-TERM        ';'
  3969           WS-AH-PREM            ';'
  3970           WS-AH-REFUND          ';'
  3971           WS-AH-METHOD          ';'
  3972           WS-AH-ORIG-BENEFIT    ';'
  3973           WS-AH-REM-BEN         ';'
  3974           WS-AH-EXPIRE-DATE     ';'
  3975           WS-AH-COMM            ';'
  3976           WS-AH-UEC             ';'
  3977           WS-ACCOUNT-NAME       ';'
  3978           WS-REPORT-CODE-1      ';'
  3979           WS-REPORT-CODE-2      ';'
  3980           WS-REPORT-CODE-3      ';'
  3981           WS-CLM-PAID-THRU-DT   ';'
  3982           WS-HEX-0A
  3983            DELIMITED BY '  ' INTO WS-SEND-BUF
  3984        END-STRING
  3985     ELSE
  3986        STRING
  3987           WS-COMMENT            ';'
  3988           WS-RESP               ';'
  3989           WS-CARRIER            ';'
  3990           WS-GROUPING           ';'
  3991           WS-STATE              ';'
  3992           WS-ACCOUNT            ';'
  3993           WS-CERT-EFF-DATE      ';'
  3994           WS-CERT-NO            ';'
  3995           WS-LAST-NAME          ';'
  3996           WS-FIRST-NAME         ';'
  3997           WS-MID-INIT           ';'
  3998           WS-LAST-JNAME         ';'
  3999           WS-FIRST-JNAME        ';'
  4000           WS-MID-JINIT          ';'
  4001           WS-POST-CARD-SW       ';'
  4002           WS-LF-STATUS          ';'
  4003           WS-LF-BEN-CODE        ';'
  4004           WS-LF-BEN-CODE-DESC   ';'
  4005           WS-LF-TERM            ';'
  4006           WS-LF-REM-TERM        ';'
  4007           WS-LF-PREM            ';'
  4008           WS-LF-REFUND          ';'
  4009           WS-LF-METHOD          ';'
  4010           WS-LF-ORIG-BENEFIT    ';'
  4011           WS-LF-REM-BEN         ';'
  4012           WS-LF-EXPIRE-DATE     ';'
  4013           WS-LF-COMM            ';'
  4014           WS-LF-UEC             ';'
  4015           WS-AH-STATUS          ';'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* SOCK03.cbl
  4016           WS-AH-BEN-CODE        ';'
  4017           WS-AH-BEN-CODE-DESC   ';'
  4018           WS-AH-TERM            ';'
  4019           WS-AH-REM-TERM        ';'
  4020           WS-AH-PREM            ';'
  4021           WS-AH-REFUND          ';'
  4022           WS-AH-METHOD          ';'
  4023           WS-AH-ORIG-BENEFIT    ';'
  4024           WS-AH-REM-BEN         ';'
  4025           WS-AH-EXPIRE-DATE     ';'
  4026           WS-AH-COMM            ';'
  4027           WS-AH-UEC             ';'
  4028           WS-ACCOUNT-NAME       ';'
  4029           WS-REPORT-CODE-1      ';'
  4030           WS-REPORT-CODE-2      ';'
  4031           WS-REPORT-CODE-3      ';'
  4032           WS-CLM-PAID-THRU-DT   ';'
  4033           'E'                   ';'
  4034            DELIMITED BY '  ' INTO WS-SEND-BUF
  4035        END-STRING
  4036     END-IF
  4037     .
  4038 0030-EXIT.
  4039     EXIT.
  4040 0050-BEGIN-REFUND-PROCESS.
  4041     IF WS-ELCERT-ACT-NAME
  4042        PERFORM 0060-FIND-FULL-KEY
  4043                                 THRU 0060-EXIT
  4044        MOVE AM-CARRIER          TO CLIENT-CAR
  4045        MOVE AM-GROUPING         TO CLIENT-GRP
  4046        MOVE AM-STATE            TO CLIENT-STATE
  4047     END-IF
  4048     PERFORM 0100-START-ELCERT     THRU 0100-EXIT
  4049     IF NOT RESP-NORMAL
  4050        MOVE ' CERT NOT FOUND - START ' TO WS-COMMENT
  4051        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4052        MOVE WS-RESPONSE         TO WS-RESP
  4053        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4054        PERFORM 0020-SEND-BUFFER
  4055                                 THRU 0020-EXIT
  4056        PERFORM 0025-CLOSE-SOCKET
  4057                                 THRU 0025-EXIT
  4058        GO TO 0010-RETURN
  4059     END-IF
  4060     PERFORM 0150-READ-NEXT-ELCERT
  4061                                 THRU 0150-EXIT
  4062*    display ' came back from 0150 ' ws-response
  4063     IF (NOT RESP-NORMAL AND NOT RESP-DUPKEY)
  4064        DISPLAY ' CERT NOT FOUND '
  4065        MOVE ' CERT NOT FOUND - READ ' TO WS-COMMENT
  4066        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4067        MOVE WS-RESPONSE         TO WS-RESP
  4068        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4069        PERFORM 0020-SEND-BUFFER
  4070                                 THRU 0020-EXIT
  4071        PERFORM 0025-CLOSE-SOCKET
  4072                                 THRU 0025-EXIT
  4073        GO TO 0010-RETURN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* SOCK03.cbl
  4074     END-IF
  4075     PERFORM 0200-BEGIN-REFUND-PROCESS
  4076                                 THRU 0200-EXIT UNTIL
  4077        ELCERT-FINISHED
  4078     .
  4079 0050-EXIT.
  4080     EXIT.
  4081 0060-FIND-FULL-KEY.
  4082     MOVE ' ' TO WS-STOP-SW
  4083     MOVE CLIENT-ACCOUNT         TO WS-AM3-ACCOUNT
  4084     MOVE LOW-VALUES             TO WS-AM3-EXP-DT
  4085
  4086* EXEC CICS STARTBR
  4087*       DATASET  ('ERACCT3')
  4088*       RIDFLD   (WS-AM3-KEY)
  4089*       GTEQ
  4090*       RESP (WS-RESPONSE)
  4091*    END-EXEC
  4092     MOVE 'ERACCT3' TO DFHEIV1
  4093     MOVE 0
  4094       TO DFHEIV11
  4095*    MOVE '&,         G          &  N#00004045' TO DFHEIV0
  4096     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4097     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4098     MOVE X'204E233030303034303435' TO DFHEIV0(25:11)
  4099     CALL 'kxdfhei1' USING DFHEIV0,
  4100           DFHEIV1,
  4101           WS-AM3-KEY,
  4102           DFHEIV99,
  4103           DFHEIV11,
  4104           DFHEIV99
  4105     MOVE EIBRESP  TO WS-RESPONSE
  4106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4107     IF RESP-NORMAL
  4108        PERFORM UNTIL TOLD-TO-STOP
  4109
  4110* EXEC CICS READNEXT
  4111*             DATASET  ('ERACCT3')
  4112*             INTO     (ACCOUNT-MASTER)
  4113*             RIDFLD   (WS-AM3-KEY)
  4114*          END-EXEC
  4115     MOVE LENGTH OF
  4116      ACCOUNT-MASTER
  4117       TO DFHEIV12
  4118     MOVE 'ERACCT3' TO DFHEIV1
  4119     MOVE 0
  4120       TO DFHEIV11
  4121*    MOVE '&.IL                  )   #00004053' TO DFHEIV0
  4122     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4123     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4124     MOVE X'2020233030303034303533' TO DFHEIV0(25:11)
  4125     CALL 'kxdfhei1' USING DFHEIV0,
  4126           DFHEIV1,
  4127           ACCOUNT-MASTER,
  4128           DFHEIV12,
  4129           WS-AM3-KEY,
  4130           DFHEIV99,
  4131           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* SOCK03.cbl
  4132           DFHEIV99,
  4133           DFHEIV99
  4134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4135           EVALUATE TRUE
  4136              WHEN (RESP-NORMAL)
  4137                 AND (AM-ACCOUNT = CLIENT-ACCOUNT)
  4138                 AND (AM-COMPANY-CD = WS-COMP-CD)
  4139                 SET TOLD-TO-STOP TO TRUE
  4140              WHEN (AM-ACCOUNT = CLIENT-ACCOUNT)
  4141                 AND (AM-COMPANY-CD NOT = WS-COMP-CD)
  4142                 CONTINUE
  4143              WHEN AM-ACCOUNT NOT = CLIENT-ACCOUNT
  4144                 MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4145                 MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4146                 MOVE ZEROS      TO WS-RESP
  4147                 PERFORM 0030-BUILD-BUFFER
  4148                                 THRU 0030-EXIT
  4149                 PERFORM 0020-SEND-BUFFER
  4150                                 THRU 0020-EXIT
  4151                 PERFORM 0025-CLOSE-SOCKET
  4152                                 THRU 0025-EXIT
  4153                 GO TO 0010-RETURN
  4154           END-EVALUATE
  4155        END-PERFORM
  4156
  4157* EXEC CICS ENDBR
  4158*          DATASET   ('ERACCT3')
  4159*       END-EXEC
  4160     MOVE 'ERACCT3' TO DFHEIV1
  4161     MOVE 0
  4162       TO DFHEIV11
  4163*    MOVE '&2                    $   #00004079' TO DFHEIV0
  4164     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4165     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4166     MOVE X'2020233030303034303739' TO DFHEIV0(25:11)
  4167     CALL 'kxdfhei1' USING DFHEIV0,
  4168           DFHEIV1,
  4169           DFHEIV11,
  4170           DFHEIV99
  4171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4172     ELSE
  4173        MOVE 'INVALID ACCOUNT NO ' TO WS-COMMENT
  4174        MOVE 'X'        TO WS-LF-STATUS WS-AH-STATUS
  4175        MOVE ZEROS      TO WS-RESP
  4176        PERFORM 0030-BUILD-BUFFER
  4177                                 THRU 0030-EXIT
  4178        PERFORM 0020-SEND-BUFFER
  4179                                 THRU 0020-EXIT
  4180        PERFORM 0025-CLOSE-SOCKET
  4181                                 THRU 0025-EXIT
  4182        GO TO 0010-RETURN
  4183     END-IF
  4184     .
  4185 0060-EXIT.
  4186     EXIT.
  4187 0100-START-ELCERT.
  4188*    DISPLAY ' MADE 0100 START '
  4189     MOVE SPACES                 TO WS-SEND-BUF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* SOCK03.cbl
  4190     INITIALIZE WS-STRING-DATA
  4191     MOVE LOW-VALUES             TO WS-CM-KEY
  4192                                    WS-CM-KEY-A1
  4193                                    WS-CM-KEY-A4
  4194     MOVE WS-COMP-CD             TO WS-CM-COMPANY-CD
  4195                                    WS-CM-COMPANY-CD-A1
  4196                                    WS-CM-COMPANY-CD-A4
  4197     MOVE CLIENT-VAL-DT          TO DC-GREG-DATE-CYMD
  4198     MOVE 'L'                    TO DC-OPTION-CODE
  4199     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4200     IF NO-CONVERSION-ERROR
  4201        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DT
  4202     ELSE
  4203        MOVE 'BAD VAL DT CONVERT ' TO WS-COMMENT
  4204        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4205        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4206        PERFORM 0020-SEND-BUFFER
  4207                                 THRU 0020-EXIT
  4208        PERFORM 0025-CLOSE-SOCKET
  4209                                 THRU 0025-EXIT
  4210        GO TO 0010-RETURN
  4211     END-IF
  4212     IF CLIENT-EFF-DT NOT = SPACES AND ZEROS
  4213        MOVE CLIENT-EFF-DT       TO DC-GREG-DATE-CYMD
  4214        MOVE 'L'                 TO DC-OPTION-CODE
  4215        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  4216        IF NO-CONVERSION-ERROR
  4217           MOVE DC-BIN-DATE-1    TO WS-BIN-EFF-DT
  4218        ELSE
  4219           MOVE 'BAD EFF DT CONVERT '
  4220                                 TO WS-COMMENT
  4221           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4222           PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4223           PERFORM 0020-SEND-BUFFER
  4224                                 THRU 0020-EXIT
  4225           PERFORM 0025-CLOSE-SOCKET
  4226                                 THRU 0025-EXIT
  4227           GO TO 0010-RETURN
  4228        END-IF
  4229     END-IF
  4230     PERFORM VARYING F1 FROM +1 BY +1 UNTIL
  4231        (F1 > +10)
  4232        OR (CLIENT-FIRST-NAME (F1:1) = SPACES OR LOW-VALUES)
  4233     END-PERFORM
  4234     IF F1 > +1
  4235        SUBTRACT +1 FROM F1
  4236     END-IF
  4237     PERFORM VARYING L1 FROM +1 BY +1 UNTIL
  4238        (L1 > +15)
  4239        OR (CLIENT-LAST-NAME (L1:1) = SPACES OR LOW-VALUES)
  4240     END-PERFORM
  4241     IF L1 > +1
  4242        SUBTRACT +1 FROM L1
  4243     END-IF
  4244     EVALUATE TRUE
  4245        WHEN WS-ELCERT-FULL
  4246           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4247           MOVE CLIENT-GRP          TO WS-CM-GROUP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* SOCK03.cbl
  4248           MOVE CLIENT-STATE        TO WS-CM-STATE
  4249           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4250           MOVE WS-BIN-EFF-DT       TO WS-CM-EFF-DT
  4251           MOVE CLIENT-CERT-NO (1:10)
  4252                                    TO WS-CM-CERT-NO
  4253
  4254* EXEC CICS READ
  4255*             INTO    (CERTIFICATE-MASTER)
  4256*             DATASET ('ELCERT')
  4257*             RIDFLD  (WS-CM-KEY)
  4258*             RESP    (WS-RESPONSE)
  4259*          END-EXEC
  4260     MOVE LENGTH OF
  4261      CERTIFICATE-MASTER
  4262       TO DFHEIV11
  4263     MOVE 'ELCERT' TO DFHEIV1
  4264*    MOVE '&"IL       E          (  N#00004163' TO DFHEIV0
  4265     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4266     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4267     MOVE X'204E233030303034313633' TO DFHEIV0(25:11)
  4268     CALL 'kxdfhei1' USING DFHEIV0,
  4269           DFHEIV1,
  4270           CERTIFICATE-MASTER,
  4271           DFHEIV11,
  4272           WS-CM-KEY,
  4273           DFHEIV99,
  4274           DFHEIV99,
  4275           DFHEIV99
  4276     MOVE EIBRESP  TO WS-RESPONSE
  4277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4278        WHEN WS-ELCERT-ACT-NAME
  4279           MOVE CLIENT-CAR          TO WS-CM-CARRIER
  4280           MOVE CLIENT-GRP          TO WS-CM-GROUP
  4281           MOVE CLIENT-STATE        TO WS-CM-STATE
  4282           MOVE CLIENT-ACCOUNT      TO WS-CM-ACCOUNT
  4283           MOVE LOW-VALUES          TO WS-CM-EFF-DT
  4284           MOVE ZEROS               TO WS-CM-CERT-NO
  4285
  4286* EXEC CICS STARTBR
  4287*             DATASET ('ELCERT')
  4288*             RIDFLD  (WS-CM-KEY)
  4289*             RESP    (WS-RESPONSE)
  4290*          END-EXEC
  4291     MOVE 'ELCERT' TO DFHEIV1
  4292     MOVE 0
  4293       TO DFHEIV11
  4294*    MOVE '&,         G          &  N#00004176' TO DFHEIV0
  4295     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4296     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4297     MOVE X'204E233030303034313736' TO DFHEIV0(25:11)
  4298     CALL 'kxdfhei1' USING DFHEIV0,
  4299           DFHEIV1,
  4300           WS-CM-KEY,
  4301           DFHEIV99,
  4302           DFHEIV11,
  4303           DFHEIV99
  4304     MOVE EIBRESP  TO WS-RESPONSE
  4305     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* SOCK03.cbl
  4306        WHEN WS-ELCERT-NAME
  4307           MOVE CLIENT-LAST-NAME TO WS-CM-LAST-NAME
  4308           MOVE SPACES           TO WS-CM-INITIALS
  4309           COMPUTE WS-LENGTH = L1 + +1
  4310
  4311* EXEC CICS STARTBR
  4312*             DATASET   ('ELCERT2')
  4313*             RIDFLD    (WS-CM-KEY-A1)
  4314*             GENERIC
  4315*             KEYLENGTH (WS-LENGTH)
  4316*             GTEQ
  4317*             RESP      (WS-RESPONSE)
  4318*          END-EXEC
  4319     MOVE 'ELCERT2' TO DFHEIV1
  4320     MOVE 0
  4321       TO DFHEIV11
  4322*    MOVE '&,   KG    G          &  N#00004185' TO DFHEIV0
  4323     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4324     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4325     MOVE X'204E233030303034313835' TO DFHEIV0(25:11)
  4326     CALL 'kxdfhei1' USING DFHEIV0,
  4327           DFHEIV1,
  4328           WS-CM-KEY-A1,
  4329           WS-LENGTH,
  4330           DFHEIV11,
  4331           DFHEIV99
  4332     MOVE EIBRESP  TO WS-RESPONSE
  4333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4334*          DISPLAY ' STARTBR RESP ' WS-RESPONSE
  4335*          DISPLAY ' KEY ' WS-CM-KEY-A1
  4336        WHEN WS-ELCERT-CERT-NO
  4337* DO NOT INCLUDE THE SUFFIX AS PART OF THE KEY
  4338           MOVE +11 TO WS-LENGTH
  4339           MOVE CLIENT-CERT-NO    TO WS-CM-CERT-NO-A4
  4340
  4341* EXEC CICS STARTBR
  4342*             DATASET   ('ELCERT5')
  4343*             RIDFLD    (WS-CM-KEY-A4)
  4344*             GENERIC
  4345*             KEYLENGTH (WS-LENGTH)
  4346*             GTEQ
  4347*             RESP      (WS-RESPONSE)
  4348*          END-EXEC
  4349     MOVE 'ELCERT5' TO DFHEIV1
  4350     MOVE 0
  4351       TO DFHEIV11
  4352*    MOVE '&,   KG    G          &  N#00004199' TO DFHEIV0
  4353     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4354     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4355     MOVE X'204E233030303034313939' TO DFHEIV0(25:11)
  4356     CALL 'kxdfhei1' USING DFHEIV0,
  4357           DFHEIV1,
  4358           WS-CM-KEY-A4,
  4359           WS-LENGTH,
  4360           DFHEIV11,
  4361           DFHEIV99
  4362     MOVE EIBRESP  TO WS-RESPONSE
  4363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* SOCK03.cbl
  4364     END-EVALUATE
  4365     .
  4366 0100-EXIT.
  4367     EXIT.
  4368 0150-READ-NEXT-ELCERT.
  4369*    DISPLAY ' MADE 0150 NEXT '
  4370     EVALUATE TRUE
  4371        WHEN WS-ELCERT-ACT-NAME
  4372*          DISPLAY ' ABOUT TO READ NEXT - ACT NAME'
  4373
  4374* EXEC CICS READNEXT
  4375*             DATASET   ('ELCERT')
  4376*             RIDFLD    (WS-CM-KEY)
  4377*             INTO      (CERTIFICATE-MASTER)
  4378*             RESP      (WS-RESPONSE)
  4379*          END-EXEC
  4380     MOVE LENGTH OF
  4381      CERTIFICATE-MASTER
  4382       TO DFHEIV12
  4383     MOVE 'ELCERT' TO DFHEIV1
  4384     MOVE 0
  4385       TO DFHEIV11
  4386*    MOVE '&.IL                  )  N#00004216' TO DFHEIV0
  4387     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4388     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4389     MOVE X'204E233030303034323136' TO DFHEIV0(25:11)
  4390     CALL 'kxdfhei1' USING DFHEIV0,
  4391           DFHEIV1,
  4392           CERTIFICATE-MASTER,
  4393           DFHEIV12,
  4394           WS-CM-KEY,
  4395           DFHEIV99,
  4396           DFHEIV11,
  4397           DFHEIV99,
  4398           DFHEIV99
  4399     MOVE EIBRESP  TO WS-RESPONSE
  4400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4401        WHEN WS-ELCERT-NAME
  4402*          DISPLAY ' ABOUT TO READ NEXT - NAME'
  4403
  4404* EXEC CICS READNEXT
  4405*             DATASET   ('ELCERT2')
  4406*             RIDFLD    (WS-CM-KEY-A1)
  4407*             INTO      (CERTIFICATE-MASTER)
  4408*             RESP      (WS-RESPONSE)
  4409*          END-EXEC
  4410     MOVE LENGTH OF
  4411      CERTIFICATE-MASTER
  4412       TO DFHEIV12
  4413     MOVE 'ELCERT2' TO DFHEIV1
  4414     MOVE 0
  4415       TO DFHEIV11
  4416*    MOVE '&.IL                  )  N#00004224' TO DFHEIV0
  4417     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4418     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4419     MOVE X'204E233030303034323234' TO DFHEIV0(25:11)
  4420     CALL 'kxdfhei1' USING DFHEIV0,
  4421           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* SOCK03.cbl
  4422           CERTIFICATE-MASTER,
  4423           DFHEIV12,
  4424           WS-CM-KEY-A1,
  4425           DFHEIV99,
  4426           DFHEIV11,
  4427           DFHEIV99,
  4428           DFHEIV99
  4429     MOVE EIBRESP  TO WS-RESPONSE
  4430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4431        WHEN WS-ELCERT-CERT-NO
  4432
  4433* EXEC CICS READNEXT
  4434*             DATASET   ('ELCERT5')
  4435*             RIDFLD    (WS-CM-KEY-A4)
  4436*             INTO      (CERTIFICATE-MASTER)
  4437*             RESP      (WS-RESPONSE)
  4438*          END-EXEC
  4439     MOVE LENGTH OF
  4440      CERTIFICATE-MASTER
  4441       TO DFHEIV12
  4442     MOVE 'ELCERT5' TO DFHEIV1
  4443     MOVE 0
  4444       TO DFHEIV11
  4445*    MOVE '&.IL                  )  N#00004231' TO DFHEIV0
  4446     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  4447     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4448     MOVE X'204E233030303034323331' TO DFHEIV0(25:11)
  4449     CALL 'kxdfhei1' USING DFHEIV0,
  4450           DFHEIV1,
  4451           CERTIFICATE-MASTER,
  4452           DFHEIV12,
  4453           WS-CM-KEY-A4,
  4454           DFHEIV99,
  4455           DFHEIV11,
  4456           DFHEIV99,
  4457           DFHEIV99
  4458     MOVE EIBRESP  TO WS-RESPONSE
  4459     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4460     END-EVALUATE
  4461     .
  4462 0150-EXIT.
  4463     EXIT.
  4464 0200-BEGIN-REFUND-PROCESS.
  4465*    DISPLAY ' MADE 0200 BEGIN '
  4466     MOVE SPACES                 TO WS-BUFF-SENT-SW
  4467                                    WS-ERACCT-SW
  4468     MOVE ZEROS                  TO WS-NCB-DIFF-MONTHS
  4469                                    WS-NCB-DIFF-ODD-DAYS
  4470     INITIALIZE WS-STRING-DATA
  4471     IF RESP-NORMAL OR RESP-DUPKEY
  4472        EVALUATE TRUE
  4473           WHEN WS-ELCERT-ACT-NAME
  4474              EVALUATE TRUE
  4475                 WHEN (CM-COMPANY-CD NOT = WS-COMP-CD)
  4476                    OR (CM-CARRIER NOT = CLIENT-CAR)
  4477                    OR (CM-GROUPING NOT = CLIENT-GRP)
  4478                    OR (CM-STATE NOT = CLIENT-STATE)
  4479                    OR (CM-ACCOUNT NOT = CLIENT-ACCOUNT)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* SOCK03.cbl
  4480                    SET ELCERT-FINISHED TO TRUE
  4481                 WHEN (CM-INSURED-LAST-NAME (1:L1) NOT =
  4482                    CLIENT-LAST-NAME (1:L1))
  4483                    GO TO 0200-CONTINUE
  4484                 WHEN ((CLIENT-EFF-DT NOT = SPACES)
  4485                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4486                    GO TO 0200-CONTINUE
  4487                 WHEN ((CLIENT-FIRST-NAME NOT = SPACES)
  4488                    AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4489                     CLIENT-FIRST-NAME (1:F1)))
  4490                    GO TO 0200-CONTINUE
  4491                 WHEN ((CLIENT-ACCOUNT NOT = SPACES)
  4492                    AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4493                    GO TO 0200-CONTINUE
  4494              END-EVALUATE
  4495           WHEN WS-ELCERT-CERT-NO
  4496              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4497                 OR (CM-CERT-PRIME NOT = CLIENT-CERT-NO (1:10))
  4498                 SET ELCERT-FINISHED TO TRUE
  4499              ELSE
  4500                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4501                     AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4502                              OR
  4503                    ((CLIENT-LAST-NAME NOT = SPACES)
  4504                     AND (CM-INSURED-LAST-NAME (1:L1) NOT =
  4505                        CLIENT-LAST-NAME (1:L1)))
  4506                              OR
  4507                    ((CLIENT-FIRST-NAME NOT = SPACES)
  4508                     AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4509                        CLIENT-FIRST-NAME (1:F1)))
  4510                              OR
  4511                    ((CLIENT-ACCOUNT NOT = SPACES)
  4512                     AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4513                     GO TO 0200-CONTINUE
  4514                 END-IF
  4515              END-IF
  4516           WHEN WS-ELCERT-NAME
  4517              IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4518                 OR (CM-INSURED-LAST-NAME (1:L1) NOT =
  4519                    CLIENT-LAST-NAME (1:L1))
  4520                  SET ELCERT-FINISHED TO TRUE
  4521              ELSE
  4522                 IF ((CLIENT-EFF-DT NOT = SPACES)
  4523                    AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4524                           OR
  4525                 ((CLIENT-FIRST-NAME NOT = SPACES)
  4526                  AND (CM-INSURED-FIRST-NAME (1:F1) NOT =
  4527                     CLIENT-FIRST-NAME (1:F1)))
  4528                           OR
  4529                 ((CLIENT-ACCOUNT NOT = SPACES)
  4530                  AND (CM-ACCOUNT NOT = CLIENT-ACCOUNT))
  4531                  GO TO 0200-CONTINUE
  4532                 END-IF
  4533              END-IF
  4534           WHEN OTHER
  4535              SET ELCERT-FINISHED   TO TRUE
  4536        END-EVALUATE
  4537     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* SOCK03.cbl
  4538        SET ELCERT-FINISHED TO TRUE
  4539     END-IF
  4540*       IF WS-ELCERT-CERT-NO
  4541*          IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4542*             OR (CM-CERT-NO NOT = CLIENT-CERT-NO)
  4543*                          OR
  4544*                ((CLIENT-EFF-DT NOT = SPACES)
  4545*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4546*                          OR
  4547*                ((CLIENT-LAST-NAME NOT = SPACES)
  4548*                 AND (CM-INSURED-LAST-NAME NOT =
  4549*                    CLIENT-LAST-NAME))
  4550*                 SET ELCERT-FINISHED TO TRUE
  4551*          END-IF
  4552*          IF WS-ELCERT-NAME
  4553*             IF (CM-COMPANY-CD NOT = WS-COMP-CD)
  4554*                OR (CM-INSURED-LAST-NAME NOT =
  4555*                   CLIENT-LAST-NAME)
  4556*                            OR
  4557*                ((CLIENT-EFF-DT NOT = SPACES)
  4558*                 AND (CM-CERT-EFF-DT NOT = WS-BIN-EFF-DT))
  4559*                 SET ELCERT-FINISHED TO TRUE
  4560*             END-IF
  4561*          ELSE
  4562*             SET ELCERT-FINISHED   TO TRUE
  4563*          END-IF
  4564     IF NOT WS-ELCERT-FULL
  4565        IF ELCERT-FINISHED
  4566           GO TO 0200-EXIT
  4567        END-IF
  4568     END-IF
  4569     IF CM-ENTRY-STATUS = 'M' OR '9' OR 'D' OR 'V' OR 'U'
  4570        MOVE 'CERT NOT ACTIVE '  TO WS-COMMENT
  4571        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4572        PERFORM 0030-BUILD-BUFFER
  4573                                 THRU 0030-EXIT
  4574        PERFORM 0020-SEND-BUFFER
  4575                                 THRU 0020-EXIT
  4576        GO TO 0200-CONTINUE
  4577     END-IF
  4578     PERFORM 0300-GET-ELCNTL-RECORDS
  4579                                 THRU 0300-EXIT
  4580     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  4581     MOVE WS-BIN-VAL-DT          TO DC-BIN-DATE-2
  4582     MOVE +0                     TO DC-ELAPSED-MONTHS
  4583                                    DC-ELAPSED-DAYS
  4584     MOVE '1'                    TO DC-OPTION-CODE
  4585     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  4586     IF NO-CONVERSION-ERROR
  4587        MOVE DC-ELAPSED-MONTHS   TO WS-NCB-DIFF-MONTHS
  4588        MOVE DC-ODD-DAYS-OVER    TO WS-NCB-DIFF-ODD-DAYS
  4589     END-IF
  4590     PERFORM 0400-PROCESS-LIFE   THRU 0400-EXIT
  4591     PERFORM 0500-PROCESS-AH     THRU 0500-EXIT
  4592     PERFORM 0030-BUILD-BUFFER   THRU 0030-EXIT
  4593     IF NOT ALREADY-SENT
  4594        PERFORM 0020-SEND-BUFFER THRU 0020-EXIT
  4595     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* SOCK03.cbl
  4596     .
  4597 0200-CONTINUE.
  4598     PERFORM 0150-READ-NEXT-ELCERT
  4599                                 THRU 0150-EXIT
  4600     .
  4601 0200-EXIT.
  4602     EXIT.
  4603 0300-GET-ELCNTL-RECORDS.
  4604     PERFORM 0310-GET-COMPANY    THRU 0310-EXIT
  4605     IF NOT RESP-NORMAL
  4606        MOVE ' COMPANY RECORD NOT FOUND '
  4607                                 TO WS-COMMENT
  4608        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4609        PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  4610        PERFORM 0020-SEND-BUFFER
  4611                                 THRU 0020-EXIT
  4612        PERFORM 0025-CLOSE-SOCKET
  4613                                 THRU 0025-EXIT
  4614        GO TO 0010-RETURN
  4615     END-IF
  4616     IF CM-LF-BENEFIT-CD NOT = '  ' AND '00'
  4617        PERFORM 0320-GET-LIFE-RECORD
  4618                                 THRU 0320-EXIT
  4619        IF NOT RESP-NORMAL
  4620           MOVE ' LIFE BENEFIT RECORD NOT FOUND '
  4621                                 TO WS-COMMENT
  4622           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4623           PERFORM 0030-BUILD-BUFFER
  4624                                 THRU 0030-EXIT
  4625           PERFORM 0020-SEND-BUFFER
  4626                                 THRU 0020-EXIT
  4627           PERFORM 0025-CLOSE-SOCKET
  4628                                 THRU 0025-EXIT
  4629           GO TO 0010-RETURN
  4630        END-IF
  4631     END-IF
  4632     IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  4633        PERFORM 0330-GET-AH-RECORD
  4634                                 THRU 0330-EXIT
  4635        IF NOT RESP-NORMAL
  4636           MOVE ' AH BENEFIT RECORD NOT FOUND '
  4637                                 TO WS-COMMENT
  4638           MOVE 'X'              TO WS-LF-STATUS WS-AH-STATUS
  4639           PERFORM 0030-BUILD-BUFFER
  4640                                 THRU 0030-EXIT
  4641           PERFORM 0020-SEND-BUFFER
  4642                                 THRU 0020-EXIT
  4643           PERFORM 0025-CLOSE-SOCKET
  4644                                 THRU 0025-EXIT
  4645           GO TO 0010-RETURN
  4646        END-IF
  4647     END-IF
  4648     PERFORM 0340-GET-STATE-RECORD
  4649                                 THRU 0340-EXIT
  4650     IF NOT RESP-NORMAL
  4651        MOVE ' STATE RECORD NOT FOUND '
  4652                                 TO WS-COMMENT
  4653        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* SOCK03.cbl
  4654        PERFORM 0030-BUILD-BUFFER
  4655                                 THRU 0030-EXIT
  4656        PERFORM 0020-SEND-BUFFER
  4657                                 THRU 0020-EXIT
  4658        PERFORM 0025-CLOSE-SOCKET
  4659                                 THRU 0025-EXIT
  4660        GO TO 0010-RETURN
  4661     END-IF
  4662     PERFORM 0350-GET-ERACCT     THRU 0350-EXIT
  4663     IF NOT ERACCT-FOUND
  4664        MOVE ' ACCOUNT NOT FOUND '
  4665                                 TO WS-COMMENT
  4666        MOVE 'X'                 TO WS-LF-STATUS WS-AH-STATUS
  4667        PERFORM 0030-BUILD-BUFFER
  4668                                 THRU 0030-EXIT
  4669        PERFORM 0020-SEND-BUFFER
  4670                                 THRU 0020-EXIT
  4671        PERFORM 0025-CLOSE-SOCKET
  4672                                 THRU 0025-EXIT
  4673        GO TO 0010-RETURN
  4674     ELSE
  4675        MOVE AM-NAME             TO WS-ACCOUNT-NAME
  4676        MOVE AM-REPORT-CODE-1    TO WS-REPORT-CODE-1
  4677        MOVE AM-REPORT-CODE-2    TO WS-REPORT-CODE-2
  4678        MOVE AM-REPORT-CODE-3    TO WS-REPORT-CODE-3
  4679     END-IF
  4680     .
  4681 0300-EXIT.
  4682     EXIT.
  4683 0310-GET-COMPANY.
  4684     MOVE WS-COMP-ID             TO  WS-CF-COMPANY-ID
  4685     MOVE '1'                    TO  WS-CF-RECORD-TYPE
  4686     MOVE SPACES                 TO  WS-CF-ACCESS
  4687     MOVE +0                     TO  WS-CF-SEQUENCE-NO
  4688
  4689* EXEC CICS READ
  4690*       INTO    (CONTROL-FILE)
  4691*       DATASET ('ELCNTL')
  4692*       RIDFLD  (WS-CF-KEY)
  4693*       RESP    (WS-RESPONSE)
  4694*    END-EXEC
  4695     MOVE LENGTH OF
  4696      CONTROL-FILE
  4697       TO DFHEIV11
  4698     MOVE 'ELCNTL' TO DFHEIV1
  4699*    MOVE '&"IL       E          (  N#00004465' TO DFHEIV0
  4700     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4701     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4702     MOVE X'204E233030303034343635' TO DFHEIV0(25:11)
  4703     CALL 'kxdfhei1' USING DFHEIV0,
  4704           DFHEIV1,
  4705           CONTROL-FILE,
  4706           DFHEIV11,
  4707           WS-CF-KEY,
  4708           DFHEIV99,
  4709           DFHEIV99,
  4710           DFHEIV99
  4711     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* SOCK03.cbl
  4712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4713     IF (RESP-NORMAL)
  4714        AND (CF-COMPANY-ID = WS-COMP-ID)
  4715        AND (CF-RECORD-TYPE = '1')
  4716        MOVE CF-CR-REM-TERM-CALC TO WS-CF-CR-REM-TERM-CALC
  4717        MOVE CF-CR-R78-METHOD    TO WS-CF-CR-R78-METHOD
  4718        MOVE CF-LIFE-OVERRIDE-L1 TO WS-LF-OVERRIDE-L1
  4719        MOVE CF-AH-OVERRIDE-L1   TO WS-AH-OVERRIDE-L1
  4720        IF CF-DEFAULT-APR NUMERIC
  4721           MOVE CF-DEFAULT-APR   TO WS-CF-DEFAULT-APR
  4722        ELSE
  4723           MOVE ZEROS            TO WS-CF-DEFAULT-APR
  4724        END-IF
  4725        IF CF-VALID-REM-TRM-OPTION
  4726           MOVE CF-REM-TRM-CALC-OPTION
  4727                                 TO WS-CF-REM-TRM-CALC-OPTION
  4728        ELSE
  4729           MOVE SPACES           TO WS-CF-REM-TRM-CALC-OPTION
  4730        END-IF
  4731     END-IF
  4732     .
  4733 0310-EXIT.
  4734     EXIT.
  4735 0320-GET-LIFE-RECORD.
  4736     MOVE '4'                    TO WS-CF-RECORD-TYPE
  4737     MOVE CM-LF-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  4738                                    WS-LF-BEN-CODE
  4739     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4740
  4741* EXEC CICS READ
  4742*       INTO    (CONTROL-FILE)
  4743*       DATASET ('ELCNTL')
  4744*       RIDFLD  (WS-CF-KEY)
  4745*       GTEQ
  4746*       RESP    (WS-RESPONSE)
  4747*    END-EXEC
  4748     MOVE LENGTH OF
  4749      CONTROL-FILE
  4750       TO DFHEIV11
  4751     MOVE 'ELCNTL' TO DFHEIV1
  4752*    MOVE '&"IL       G          (  N#00004498' TO DFHEIV0
  4753     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4754     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4755     MOVE X'204E233030303034343938' TO DFHEIV0(25:11)
  4756     CALL 'kxdfhei1' USING DFHEIV0,
  4757           DFHEIV1,
  4758           CONTROL-FILE,
  4759           DFHEIV11,
  4760           WS-CF-KEY,
  4761           DFHEIV99,
  4762           DFHEIV99,
  4763           DFHEIV99
  4764     MOVE EIBRESP  TO WS-RESPONSE
  4765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4766     IF RESP-NORMAL
  4767        AND (CF-COMPANY-ID  = WS-COMP-ID)
  4768        AND (CF-RECORD-TYPE = '4')
  4769        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* SOCK03.cbl
  4770           (S1 > +8)
  4771           OR (CM-LF-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  4772        END-PERFORM
  4773        IF S1 > +8
  4774           CONTINUE
  4775        ELSE
  4776           MOVE CF-BENEFIT-DESCRIP (S1)
  4777                                 TO WS-LF-BEN-CODE-DESC
  4778           MOVE CF-LF-COVERAGE-TYPE (S1)
  4779                                 TO WS-CF-LF-COVERAGE-TYPE
  4780           IF CF-CO-REM-TERM-CALC (S1) > '0'
  4781               MOVE CF-CO-REM-TERM-CALC (S1)
  4782                                 TO WS-LF-CO-REM-TERM-CALC
  4783           END-IF
  4784           IF CF-CO-EARNINGS-CALC (S1)  > ' '
  4785               MOVE CF-CO-EARNINGS-CALC (S1)
  4786                                 TO WS-LF-CO-EARNINGS-CALC
  4787                                    WS-LF-CO-REFUND-CALC
  4788           END-IF
  4789           IF CF-SPECIAL-CALC-CD (S1) > ' '
  4790               MOVE CF-SPECIAL-CALC-CD (S1)
  4791                                 TO WS-LF-SPECIAL-CALC-CD
  4792           END-IF
  4793           IF CF-CO-REFUND-CALC (S1) > '0'
  4794               MOVE CF-CO-REFUND-CALC (S1)
  4795                                 TO WS-LF-CO-REFUND-CALC
  4796        END-IF
  4797     END-IF
  4798     .
  4799 0320-EXIT.
  4800     EXIT.
  4801 0330-GET-AH-RECORD.
  4802     MOVE '5'                    TO WS-CF-RECORD-TYPE
  4803     MOVE CM-AH-BENEFIT-CD       TO WS-CF-BENEFIT-NO
  4804     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4805
  4806* EXEC CICS READ
  4807*       INTO    (CONTROL-FILE)
  4808*       DATASET ('ELCNTL')
  4809*       RIDFLD  (WS-CF-KEY)
  4810*       GTEQ
  4811*       RESP    (WS-RESPONSE)
  4812*    END-EXEC
  4813     MOVE LENGTH OF
  4814      CONTROL-FILE
  4815       TO DFHEIV11
  4816     MOVE 'ELCNTL' TO DFHEIV1
  4817*    MOVE '&"IL       G          (  N#00004544' TO DFHEIV0
  4818     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  4819     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4820     MOVE X'204E233030303034353434' TO DFHEIV0(25:11)
  4821     CALL 'kxdfhei1' USING DFHEIV0,
  4822           DFHEIV1,
  4823           CONTROL-FILE,
  4824           DFHEIV11,
  4825           WS-CF-KEY,
  4826           DFHEIV99,
  4827           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* SOCK03.cbl
  4828           DFHEIV99
  4829     MOVE EIBRESP  TO WS-RESPONSE
  4830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4831     IF RESP-NORMAL
  4832        AND (CF-COMPANY-ID  = WS-COMP-ID)
  4833        AND (CF-RECORD-TYPE = '5')
  4834        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4835           (S1 > +8)
  4836           OR (CM-AH-BENEFIT-CD = CF-BENEFIT-CODE (S1))
  4837        END-PERFORM
  4838        IF S1 > +8
  4839           CONTINUE
  4840        ELSE
  4841           MOVE CF-BENEFIT-DESCRIP (S1)
  4842                                 TO WS-AH-BEN-CODE-DESC
  4843           IF CF-CO-REM-TERM-CALC (S1) > '0'
  4844              MOVE CF-CO-REM-TERM-CALC (S1)
  4845                                 TO WS-AH-CO-REM-TERM-CALC
  4846           END-IF
  4847           IF CF-CO-EARNINGS-CALC (S1) > ' '
  4848              MOVE CF-CO-EARNINGS-CALC (S1)
  4849                                 TO WS-AH-CO-EARNINGS-CALC
  4850                                    WS-AH-CO-REFUND-CALC
  4851           END-IF
  4852           IF CF-SPECIAL-CALC-CD (S1) >  ' '
  4853              MOVE CF-SPECIAL-CALC-CD (S1)
  4854                                 TO WS-AH-SPECIAL-CALC-CD
  4855           END-IF
  4856           IF CF-CO-REFUND-CALC (S1) > '0'
  4857              MOVE CF-CO-REFUND-CALC (S1)
  4858                                 TO WS-AH-CO-REFUND-CALC
  4859           END-IF
  4860           IF CF-BENEFIT-CATEGORY (S1) > ' '
  4861              MOVE CF-BENEFIT-CATEGORY (S1)
  4862                                 TO WS-AH-BEN-CATEGORY
  4863           END-IF
  4864        END-IF
  4865     END-IF
  4866     .
  4867 0330-EXIT.
  4868     EXIT.
  4869 0340-GET-STATE-RECORD.
  4870     MOVE WS-COMP-ID             TO WS-CF-COMPANY-ID
  4871     MOVE '3'                    TO WS-CF-RECORD-TYPE
  4872     MOVE CM-STATE               TO WS-CF-ACCESS
  4873     MOVE +0                     TO WS-CF-SEQUENCE-NO
  4874
  4875* EXEC CICS READ
  4876*       INTO    (CONTROL-FILE)
  4877*       DATASET ('ELCNTL')
  4878*       RIDFLD  (WS-CF-KEY)
  4879*       RESP    (WS-RESPONSE)
  4880*    END-EXEC
  4881     MOVE LENGTH OF
  4882      CONTROL-FILE
  4883       TO DFHEIV11
  4884     MOVE 'ELCNTL' TO DFHEIV1
  4885*    MOVE '&"IL       E          (  N#00004594' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* SOCK03.cbl
  4886     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  4887     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4888     MOVE X'204E233030303034353934' TO DFHEIV0(25:11)
  4889     CALL 'kxdfhei1' USING DFHEIV0,
  4890           DFHEIV1,
  4891           CONTROL-FILE,
  4892           DFHEIV11,
  4893           WS-CF-KEY,
  4894           DFHEIV99,
  4895           DFHEIV99,
  4896           DFHEIV99
  4897     MOVE EIBRESP  TO WS-RESPONSE
  4898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4899     IF (RESP-NORMAL)
  4900        AND (CF-COMPANY-ID = WS-COMP-ID)
  4901        AND (CF-RECORD-TYPE = '3')
  4902        AND (CF-STATE-CODE = CM-STATE)
  4903        MOVE CF-ST-FREE-LOOK-PERIOD
  4904                                 TO WS-FREE-LOOK
  4905        MOVE CF-STATE-ABBREVIATION
  4906                                 TO WS-STATE-ABBREVIATION
  4907        MOVE CF-ST-FST-PMT-DAYS-CHG
  4908                                 TO  WS-STATE-EXT-DAYS-CHG
  4909        IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  4910           MOVE '0'              TO WS-LF-ST-REM-TERM-CALC
  4911           IF CF-ST-RT-CALC NOT = SPACES
  4912              MOVE CF-ST-RT-CALC TO WS-LF-ST-REM-TERM-CALC
  4913           END-IF
  4914           IF WS-CF-LF-COVERAGE-TYPE = 'R'
  4915              IF CF-ST-RF-LR-CALC > '0'
  4916                 MOVE CF-ST-RF-LR-CALC
  4917                                 TO WS-LF-ST-REFUND-CALC
  4918              END-IF
  4919              IF WS-LF-CO-EARNINGS-CALC = 'N' OR '5'
  4920                 IF CF-ST-RF-LN-CALC > '0'
  4921                    MOVE CF-ST-RF-LN-CALC
  4922                                 TO WS-LF-ST-REFUND-CALC
  4923                 END-IF
  4924              END-IF
  4925           ELSE
  4926              IF CF-ST-RF-LL-CALC > '0'
  4927                 MOVE CF-ST-RF-LL-CALC
  4928                                 TO WS-LF-ST-REFUND-CALC
  4929              END-IF
  4930           END-IF
  4931           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4932              (S1 > 50)
  4933              OR ((WS-LF-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  4934                 AND (CF-ST-BENEFIT-CD (S1) = CM-LF-BENEFIT-CD))
  4935           END-PERFORM
  4936           IF S1 < +51
  4937              IF CF-ST-REM-TERM-CALC (S1) > '0'
  4938                 MOVE CF-ST-REM-TERM-CALC (S1)
  4939                                 TO WS-LF-ST-REM-TERM-CALC
  4940              END-IF
  4941              IF CF-ST-REFUND-CALC (S1) > '0'
  4942                 MOVE CF-ST-REFUND-CALC (S1)
  4943                                 TO WS-LF-ST-REFUND-CALC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* SOCK03.cbl
  4944              END-IF
  4945           END-IF
  4946        END-IF
  4947        IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  4948           MOVE '0'              TO WS-AH-ST-REM-TERM-CALC
  4949           IF CF-ST-RT-CALC NOT = SPACES
  4950              MOVE CF-ST-RT-CALC TO WS-AH-ST-REM-TERM-CALC
  4951           END-IF
  4952           IF CF-ST-RF-AH-CALC > '0'
  4953              MOVE CF-ST-RF-AH-CALC
  4954                                 TO WS-AH-ST-REFUND-CALC
  4955           END-IF
  4956           IF WS-AH-SPECIAL-CALC-CD = 'C'
  4957              IF CF-ST-RF-CP-CALC > '0'
  4958                 MOVE CF-ST-RF-CP-CALC
  4959                                 TO WS-AH-ST-REFUND-CALC
  4960              END-IF
  4961           END-IF
  4962           PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  4963              (S1 > 50)
  4964              OR ((WS-AH-OVERRIDE-L1 = CF-ST-BENEFIT-KIND (S1))
  4965                 AND (CF-ST-BENEFIT-CD (S1) = CM-AH-BENEFIT-CD))
  4966           END-PERFORM
  4967           IF S1 < +51
  4968              IF CF-ST-REM-TERM-CALC (S1) > '0'
  4969                 MOVE CF-ST-REM-TERM-CALC (S1)
  4970                                 TO WS-AH-ST-REM-TERM-CALC
  4971              END-IF
  4972              IF CF-ST-REFUND-CALC (S1) > '0'
  4973                 MOVE CF-ST-REFUND-CALC (S1)
  4974                                 TO WS-AH-ST-REFUND-CALC
  4975              END-IF
  4976           END-IF
  4977        END-IF
  4978     END-IF
  4979     .
  4980 0340-EXIT.
  4981     EXIT.
  4982 0350-GET-ERACCT.
  4983     MOVE '0'                    TO WS-AM-EARN-METHOD-L
  4984                                    WS-AM-EARN-METHOD-R
  4985                                    WS-AM-EARN-METHOD-A
  4986                                    WS-LF-AM-REM-TERM-CALC
  4987                                    WS-AH-AM-REM-TERM-CALC
  4988     MOVE CM-COMPANY-CD          TO WS-AM-COMPANY-CD
  4989     MOVE CM-CARRIER             TO WS-AM-CARRIER
  4990     MOVE CM-GROUPING            TO WS-AM-GROUPING
  4991     MOVE CM-STATE               TO WS-AM-STATE
  4992     MOVE CM-ACCOUNT             TO WS-AM-ACCOUNT
  4993     MOVE CM-CERT-EFF-DT         TO WS-AM-EXPIRATION-DT
  4994     MOVE LOW-VALUES             TO WS-AM-FILLER
  4995     MOVE ' '                    TO WS-STOP-SW
  4996
  4997* EXEC CICS STARTBR
  4998*       DATASET  ('ERACCT')
  4999*       RIDFLD   (WS-AM-KEY)
  5000*       GTEQ
  5001*       RESP (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* SOCK03.cbl
  5002*    END-EXEC
  5003     MOVE 'ERACCT' TO DFHEIV1
  5004     MOVE 0
  5005       TO DFHEIV11
  5006*    MOVE '&,         G          &  N#00004697' TO DFHEIV0
  5007     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5008     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5009     MOVE X'204E233030303034363937' TO DFHEIV0(25:11)
  5010     CALL 'kxdfhei1' USING DFHEIV0,
  5011           DFHEIV1,
  5012           WS-AM-KEY,
  5013           DFHEIV99,
  5014           DFHEIV11,
  5015           DFHEIV99
  5016     MOVE EIBRESP  TO WS-RESPONSE
  5017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5018     IF RESP-NORMAL
  5019        PERFORM UNTIL TOLD-TO-STOP
  5020
  5021* EXEC CICS READNEXT
  5022*             DATASET  ('ERACCT')
  5023*             INTO     (ACCOUNT-MASTER)
  5024*             RIDFLD   (WS-AM-KEY)
  5025*          END-EXEC
  5026     MOVE LENGTH OF
  5027      ACCOUNT-MASTER
  5028       TO DFHEIV12
  5029     MOVE 'ERACCT' TO DFHEIV1
  5030     MOVE 0
  5031       TO DFHEIV11
  5032*    MOVE '&.IL                  )   #00004705' TO DFHEIV0
  5033     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5034     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5035     MOVE X'2020233030303034373035' TO DFHEIV0(25:11)
  5036     CALL 'kxdfhei1' USING DFHEIV0,
  5037           DFHEIV1,
  5038           ACCOUNT-MASTER,
  5039           DFHEIV12,
  5040           WS-AM-KEY,
  5041           DFHEIV99,
  5042           DFHEIV11,
  5043           DFHEIV99,
  5044           DFHEIV99
  5045     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5046           IF RESP-NORMAL
  5047              EVALUATE TRUE
  5048                 WHEN AM-CONTROL-PRIMARY (1:20) NOT =
  5049                    CM-CONTROL-PRIMARY (1:20)
  5050                    SET TOLD-TO-STOP TO TRUE
  5051                 WHEN (AM-CONTROL-PRIMARY (1:20) =
  5052                    CM-CONTROL-PRIMARY (1:20))
  5053                    AND (CM-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  5054                    AND (CM-CERT-EFF-DT < AM-EXPIRATION-DT)
  5055                    SET ERACCT-FOUND      TO TRUE
  5056                    SET TOLD-TO-STOP TO TRUE
  5057              END-EVALUATE
  5058           ELSE
  5059              SET TOLD-TO-STOP TO TRUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* SOCK03.cbl
  5060           END-IF
  5061        END-PERFORM
  5062
  5063* EXEC CICS ENDBR
  5064*          DATASET   ('ERACCT')
  5065*       END-EXEC
  5066     MOVE 'ERACCT' TO DFHEIV1
  5067     MOVE 0
  5068       TO DFHEIV11
  5069*    MOVE '&2                    $   #00004726' TO DFHEIV0
  5070     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5071     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5072     MOVE X'2020233030303034373236' TO DFHEIV0(25:11)
  5073     CALL 'kxdfhei1' USING DFHEIV0,
  5074           DFHEIV1,
  5075           DFHEIV11,
  5076           DFHEIV99
  5077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5078     END-IF
  5079     .
  5080 0350-EXIT.
  5081     EXIT.
  5082 0400-PROCESS-LIFE.
  5083     MOVE SPACES                 TO WS-BUFF-SENT-SW
  5084     MOVE CM-INSURED-LAST-NAME   TO WS-LAST-NAME
  5085     MOVE CM-INSURED-FIRST-NAME  TO WS-FIRST-NAME
  5086     MOVE CM-INSURED-INITIAL2    TO WS-MID-INIT
  5087     MOVE CM-JT-LAST-NAME        TO WS-LAST-JNAME
  5088     MOVE CM-JT-FIRST-NAME       TO WS-FIRST-JNAME
  5089     MOVE CM-JT-INITIAL          TO WS-MID-JINIT
  5090     MOVE CM-POST-CARD-IND       TO WS-POST-CARD-SW
  5091     MOVE CM-CARRIER             TO WS-CARRIER
  5092     MOVE CM-GROUPING            TO WS-GROUPING
  5093     MOVE CM-STATE               TO WS-STATE
  5094     MOVE CM-ACCOUNT             TO WS-ACCOUNT
  5095     MOVE CM-CERT-NO             TO WS-CERT-NO
  5096     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5097     MOVE ' '                    TO  DC-OPTION-CODE.
  5098     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5099     IF NO-CONVERSION-ERROR
  5100        MOVE DC-GREG-DATE-CYMD   TO WS-CERT-EFF-DATE
  5101     ELSE
  5102        MOVE 99999999            TO WS-CERT-EFF-DATE
  5103     END-IF
  5104     IF CM-LF-BENEFIT-CD = '  ' OR '00'
  5105        GO TO 0400-EXIT
  5106     END-IF
  5107     MOVE ZEROS                  TO WS-TOT-LF-RFND
  5108                                    WS-TOT-LF-PREM
  5109                                    WS-TOT-LF-COMM
  5110     MOVE CM-LF-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5111     MOVE ' '                    TO  DC-OPTION-CODE
  5112     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5113     IF NO-CONVERSION-ERROR
  5114        MOVE DC-GREG-DATE-CYMD   TO WS-LF-EXPIRE-DATE
  5115     ELSE
  5116        MOVE ZEROS               TO WS-LF-EXPIRE-DATE
  5117     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* SOCK03.cbl
  5118     MOVE WS-LF-OVERRIDE-L1      TO CP-LIFE-OVERRIDE-CODE
  5119     MOVE CM-CERT-EFF-DT         TO CP-CERT-EFF-DT
  5120     MOVE CM-LOAN-1ST-PMT-DT     TO CP-FIRST-PAY-DATE
  5121     MOVE WS-BIN-VAL-DT          TO CP-VALUATION-DT
  5122     MOVE CM-STATE               TO CP-STATE
  5123     MOVE WS-STATE-ABBREVIATION  TO CP-STATE-STD-ABBRV
  5124     MOVE WS-CF-LF-COVERAGE-TYPE TO CP-BENEFIT-TYPE
  5125     MOVE WS-LF-SPECIAL-CALC-CD  TO CP-SPECIAL-CALC-CD
  5126     MOVE CM-PAY-FREQUENCY       TO CP-PAY-FREQUENCY
  5127     MOVE CM-LOAN-APR            TO CP-LOAN-APR
  5128     MOVE '2'                    TO CP-PROCESS-TYPE
  5129     MOVE WS-COMP-ID             TO CP-COMPANY-ID
  5130     MOVE CM-COMPANY-CD          TO CP-COMPANY-CD
  5131     MOVE WS-ACCT-USER-FLD-5     TO CP-ACCT-FLD-5
  5132     MOVE WS-CF-REM-TRM-CALC-OPTION
  5133                                 TO CP-REM-TRM-CALC-OPTION
  5134     MOVE WS-CF-CR-REM-TERM-CALC TO CP-REM-TERM-METHOD
  5135     IF WS-LF-CO-REM-TERM-CALC > '0'
  5136        MOVE WS-LF-CO-REM-TERM-CALC
  5137                                 TO CP-REM-TERM-METHOD
  5138     END-IF
  5139     IF WS-LF-ST-REM-TERM-CALC > '0'
  5140         MOVE WS-LF-ST-REM-TERM-CALC
  5141                                 TO  CP-REM-TERM-METHOD.
  5142     IF WS-LF-AM-REM-TERM-CALC > '0'
  5143         MOVE WS-LF-AM-REM-TERM-CALC
  5144                                 TO  CP-REM-TERM-METHOD.
  5145     IF (WS-COMP-ID = 'CID')
  5146        AND (CP-STATE-STD-ABBRV = 'WI')
  5147        MOVE '7'                 TO CP-REM-TERM-METHOD
  5148        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5149     END-IF
  5150     IF (WS-COMP-ID = 'CID')
  5151        AND (CP-STATE-STD-ABBRV = 'MO')
  5152        AND (CM-CERT-EFF-DT >= X'9B41')
  5153        AND (CM-CERT-EFF-DT <= X'A2FB')
  5154        MOVE '7'                 TO CP-REM-TERM-METHOD
  5155        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5156     END-IF
  5157     MOVE CM-LF-ORIG-TERM        TO CP-ORIGINAL-TERM
  5158                                    CP-LOAN-TERM
  5159                                    WS-LF-TERM
  5160     IF CP-TRUNCATED-LIFE
  5161         MOVE CM-LOAN-TERM       TO  CP-LOAN-TERM.
  5162     IF CP-TERM-IS-DAYS
  5163        IF CM-LF-TERM-IN-DAYS NUMERIC
  5164           MOVE CM-LF-TERM-IN-DAYS
  5165                                 TO CP-TERM-OR-EXT-DAYS
  5166        ELSE
  5167           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5168        END-IF
  5169     ELSE
  5170        IF CM-PMT-EXTENSION-DAYS NUMERIC
  5171           MOVE CM-PMT-EXTENSION-DAYS
  5172                                 TO CP-TERM-OR-EXT-DAYS
  5173        ELSE
  5174           MOVE ZEROS            TO CP-TERM-OR-EXT-DAYS
  5175        END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* SOCK03.cbl
  5176     END-IF
  5177     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5178     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5179        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5180        ADD +1   TO CP-ORIGINAL-TERM CP-LOAN-TERM
  5181     END-IF
  5182     DISPLAY ' STARTING OPEN LIFE CLAIM TEST '
  5183     MOVE LOW-VALUES             TO WS-LF-BIN-PAID-THRU-DT
  5184     MOVE ' '                    TO WS-CLM-STOP-SW
  5185     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5186     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5187
  5188* EXEC CICS STARTBR
  5189*       DATASET     ('ELMSTR5')
  5190*       RIDFLD      (ELMSTR-KEY)
  5191*       RESP        (WS-RESPONSE)
  5192*    END-EXEC
  5193     MOVE 'ELMSTR5' TO DFHEIV1
  5194     MOVE 0
  5195       TO DFHEIV11
  5196*    MOVE '&,         G          &  N#00004838' TO DFHEIV0
  5197     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5198     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5199     MOVE X'204E233030303034383338' TO DFHEIV0(25:11)
  5200     CALL 'kxdfhei1' USING DFHEIV0,
  5201           DFHEIV1,
  5202           ELMSTR-KEY,
  5203           DFHEIV99,
  5204           DFHEIV11,
  5205           DFHEIV99
  5206     MOVE EIBRESP  TO WS-RESPONSE
  5207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5208     DISPLAY ' AFTER START ' WS-RESPONSE
  5209     IF RESP-NORMAL
  5210        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5211
  5212* EXEC CICS READNEXT
  5213*             DATASET   ('ELMSTR5')
  5214*             RIDFLD    (ELMSTR-KEY)
  5215*             INTO      (CLAIM-MASTER)
  5216*             RESP      (WS-RESPONSE)
  5217*          END-EXEC
  5218     MOVE LENGTH OF
  5219      CLAIM-MASTER
  5220       TO DFHEIV12
  5221     MOVE 'ELMSTR5' TO DFHEIV1
  5222     MOVE 0
  5223       TO DFHEIV11
  5224*    MOVE '&.IL                  )  N#00004846' TO DFHEIV0
  5225     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5226     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5227     MOVE X'204E233030303034383436' TO DFHEIV0(25:11)
  5228     CALL 'kxdfhei1' USING DFHEIV0,
  5229           DFHEIV1,
  5230           CLAIM-MASTER,
  5231           DFHEIV12,
  5232           ELMSTR-KEY,
  5233           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* SOCK03.cbl
  5234           DFHEIV11,
  5235           DFHEIV99,
  5236           DFHEIV99
  5237     MOVE EIBRESP  TO WS-RESPONSE
  5238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5239        IF (RESP-NORMAL OR RESP-DUPKEY)
  5240           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5241           AND (CM-CERT-NO = CL-CERT-NO)
  5242           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5243              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5244              IF CL-CLAIM-TYPE = 'L'
  5245                 IF CM-AH-BENEFIT-CD NOT = '  ' AND '00'
  5246                    MOVE 'D'     TO WS-AH-STATUS
  5247                 END-IF
  5248                 IF CLAIM-IS-OPEN
  5249                    MOVE ' OPEN LIFE CLAIM '
  5250                                 TO WS-COMMENT
  5251                    MOVE 'L'     TO WS-LF-STATUS
  5252                    GO TO 0400-EXIT
  5253                 ELSE
  5254                    MOVE ' DEATH CLAIM APPLIED '
  5255                                 TO WS-COMMENT
  5256                    MOVE 'D'     TO WS-LF-STATUS
  5257*                   IF CL-PAID-THRU-DT > WS-LF-BIN-PAID-THRU-DT
  5258*                      MOVE CL-PAID-THRU-DT
  5259*                                TO WS-LF-BIN-PAID-THRU-DT
  5260*                   END-IF
  5261                 END-IF
  5262              END-IF
  5263           END-IF
  5264        ELSE
  5265           SET I-SAY-TO-STOP TO TRUE
  5266        END-IF
  5267        END-PERFORM
  5268
  5269* EXEC CICS ENDBR
  5270*          DATASET   ('ELMSTR5')
  5271*       END-EXEC
  5272     MOVE 'ELMSTR5' TO DFHEIV1
  5273     MOVE 0
  5274       TO DFHEIV11
  5275*    MOVE '&2                    $   #00004881' TO DFHEIV0
  5276     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5277     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5278     MOVE X'2020233030303034383831' TO DFHEIV0(25:11)
  5279     CALL 'kxdfhei1' USING DFHEIV0,
  5280           DFHEIV1,
  5281           DFHEIV11,
  5282           DFHEIV99
  5283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5284     END-IF
  5285     IF WS-LF-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5286*       THIS WILL BE TRUE IF WE FOUND A CLOSED LIFE CLAIM
  5287        MOVE WS-LF-BIN-PAID-THRU-DT
  5288                                 TO DC-BIN-DATE-1
  5289        MOVE ' '                 TO DC-OPTION-CODE
  5290        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5291        IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* SOCK03.cbl
  5292           MOVE DC-GREG-DATE-CYMD
  5293                                 TO WS-CLM-PAID-THRU-DT
  5294        ELSE
  5295           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5296        END-IF
  5297*       IF WS-BIN-VAL-DT <= WS-LF-BIN-PAID-THRU-DT
  5298*          MOVE 'CAN DT =< CLM PD THRU DT'
  5299*                                TO WS-COMMENT
  5300*          MOVE 'P'              TO WS-LF-STATUS
  5301*          GO TO 0400-EXIT
  5302*       END-IF
  5303        GO TO 0400-EXIT
  5304     END-IF
  5305     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5306     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5307        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5308        MOVE CP-REMAINING-TERM-1   TO WS-BALLOON-RTRM
  5309        COMPUTE CP-REMAINING-TERM-1 =
  5310                CP-REMAINING-TERM-1 - +1
  5311        COMPUTE CP-REMAINING-TERM-2 =
  5312                CP-REMAINING-TERM-2 - +1
  5313     END-IF
  5314     IF CP-REMAINING-TERM-1 NEGATIVE
  5315        MOVE ZEROS               TO CP-REMAINING-TERM-1
  5316     END-IF
  5317     IF CP-REMAINING-TERM-2 NEGATIVE
  5318        MOVE ZEROS               TO CP-REMAINING-TERM-2
  5319     END-IF
  5320     IF CM-LIFE-COMM-PCT NOT NUMERIC
  5321        MOVE ZERO                TO CM-LIFE-COMM-PCT
  5322     END-IF
  5323     IF CM-LIFE-COMM-PCT > ZEROS
  5324        COMPUTE WS-TOT-LF-COMM = CM-LIFE-COMM-PCT *
  5325           (CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT)
  5326     END-IF
  5327     MOVE WS-TOT-LF-COMM         TO WS-LF-COMM
  5328     MOVE CP-REMAINING-TERM-1    TO WS-LF-REM-TERM
  5329     IF CM-LF-CURRENT-STATUS = '8'
  5330        IF CM-LF-CANCEL-DT NOT = LOW-VALUES
  5331           MOVE ' LIFE COVERAGE PREVIOUSLY CANCELLED '
  5332                                 TO WS-COMMENT
  5333           MOVE 'C'              TO WS-LF-STATUS
  5334*          PERFORM 0030-BUILD-BUFFER
  5335*                                THRU 0030-EXIT
  5336*          PERFORM 0020-SEND-BUFFER
  5337*                                THRU 0020-EXIT
  5338*          SET ALREADY-SENT      TO TRUE
  5339*          MOVE SPACES           TO WS-COMMENT
  5340           GO TO 0400-EXIT
  5341*          PERFORM 0025-CLOSE-SOCKET
  5342*                                THRU 0025-EXIT
  5343*          GO TO 0010-RETURN
  5344        END-IF
  5345     END-IF
  5346     IF CM-LF-CURRENT-STATUS = '7'
  5347        IF CM-LF-DEATH-DT NOT = LOW-VALUES
  5348           MOVE ' DEATH CLAIM APPLIED '
  5349                                 TO WS-COMMENT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* SOCK03.cbl
  5350           MOVE 'D'              TO WS-LF-STATUS
  5351*          PERFORM 0030-BUILD-BUFFER
  5352*                                THRU 0030-EXIT
  5353*          IF NOT ALREADY-SENT
  5354*             PERFORM 0020-SEND-BUFFER
  5355*                                THRU 0020-EXIT
  5356*             SET ALREADY-SENT   TO TRUE
  5357*          END-IF
  5358           GO TO 0400-EXIT
  5359*          PERFORM 0025-CLOSE-SOCKET
  5360*                                THRU 0025-EXIT
  5361*          GO TO 0010-RETURN
  5362        END-IF
  5363     END-IF
  5364     IF ((CM-LF-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  5365        AND (CM-LF-LOAN-EXPIRE-DT > LOW-VALUES))
  5366        MOVE 'LF COVERAGE EXPIRED '
  5367                                 TO WS-COMMENT
  5368        MOVE 'E'                 TO WS-LF-STATUS
  5369        GO TO 0400-EXIT
  5370     END-IF
  5371     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5372        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5373        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5374     ELSE
  5375        MOVE CP-REMAINING-TERM-2 TO CP-REMAINING-TERM
  5376     END-IF
  5377     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-EARNING-METHOD.
  5378     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT.
  5379*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE
  5380     if ws-comp-id = 'AHL'
  5381        move cm-lf-class-cd      to cp-class-code
  5382        if cp-class-code = spaces
  5383           move zeros            to cp-class-code
  5384        end-if
  5385     else
  5386        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5387     end-if
  5388     PERFORM 0710-LINK-REM-AMOUNT THRU 0710-EXIT
  5389*    MOVE CM-LF-BENEFIT-AMT      TO WS-LF-ORIG-BENEFIT
  5390     COMPUTE WS-LF-ORIG-BENEFIT = CM-LF-BENEFIT-AMT +
  5391        CM-LF-ALT-BENEFIT-AMT
  5392*    ADD CM-LF-ALT-BENEFIT-AMT   TO WS-LF-ORIG-BENEFIT
  5393     MOVE CP-REMAINING-AMT       TO CP-REMAINING-BENEFIT
  5394                                    WS-LF-REM-BEN
  5395     COMPUTE WS-TOT-LF-PREM = CM-LF-PREMIUM-AMT
  5396                             + CM-LF-ALT-PREMIUM-AMT
  5397     MOVE WS-TOT-LF-PREM         TO WS-LF-PREM
  5398     IF (WS-LF-CO-EARNINGS-CALC = 'B') AND
  5399        (WS-LF-SPECIAL-CALC-CD NOT = 'L')
  5400        MOVE WS-BALLOON-RTRM     TO CP-REMAINING-TERM
  5401     ELSE
  5402        MOVE CP-REMAINING-TERM-1 TO  CP-REMAINING-TERM
  5403     END-IF
  5404     MOVE WS-LF-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  5405     MOVE WS-LF-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  5406     IF WS-LF-ST-REFUND-CALC > ZERO
  5407         MOVE WS-LF-ST-REFUND-CALC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* SOCK03.cbl
  5408                                 TO  CP-EARNING-METHOD.
  5409     IF WS-LF-FO-REFUND-CALC > ZERO
  5410         MOVE WS-LF-FO-REFUND-CALC
  5411                                 TO  CP-EARNING-METHOD.
  5412     IF CP-RATING-METHOD = '4'
  5413        MOVE '4'                 TO CP-EARNING-METHOD
  5414     END-IF
  5415*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  5416     if ws-comp-id = 'AHL'
  5417        move cm-lf-class-cd      to cp-class-code
  5418        if cp-class-code = spaces
  5419           move zeros            to cp-class-code
  5420        end-if
  5421     else
  5422        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5423     end-if
  5424     MOVE CM-LF-BENEFIT-CD       TO  CP-BENEFIT-CD.
  5425     MOVE CM-LF-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  5426                                     CP-RATING-BENEFIT-AMT.
  5427     IF CP-STATE-STD-ABBRV = 'OR'
  5428         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5429                                         CM-LF-ALT-BENEFIT-AMT.
  5430****   N O T E   ****
  5431*      CID DOES NOT WANT THE REFUND METHOD TO OVERRIDE
  5432*      THE OH HARD CODING IN ELCRFNDP
  5433     IF WS-COMP-ID = 'CID'
  5434        IF CP-STATE-STD-ABBRV = 'OH'
  5435           MOVE WS-LF-CO-EARNINGS-CALC
  5436                                 TO CP-EARNING-METHOD
  5437        END-IF
  5438     END-IF
  5439****   N O T E   ****
  5440     MOVE CM-LF-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  5441     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  5442     MOVE CM-LF-DEV-CODE         TO  CP-DEVIATION-CODE.
  5443     MOVE CM-LF-DEV-PCT          TO  CP-RATE-DEV-PCT.
  5444     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  5445     IF CP-EARN-AS-NET-PAY
  5446        IF CP-LOAN-APR <= ZEROS
  5447           IF WS-CF-DEFAULT-APR > ZEROS
  5448              MOVE WS-CF-DEFAULT-APR
  5449                                 TO  CP-LOAN-APR
  5450           END-IF
  5451        END-IF
  5452     END-IF
  5453*    DISPLAY ' SOCK REM AMT      ' CP-REMAINING-BENEFIT
  5454*    DISPLAY ' SOCK REM TRM      ' CP-REMAINING-TERM
  5455*    DISPLAY ' SOCK EARN METH    ' CP-EARNING-METHOD
  5456*    DISPLAY ' SOCK RATE METH    ' CP-RATING-METHOD
  5457*    DISPLAY ' SOCK CLASS        ' CP-CLASS-CODE
  5458*    DISPLAY ' SOCK BENE CODE    ' CP-BENEFIT-CD
  5459*    DISPLAY ' SOCK ORIG BENE    ' CP-ORIGINAL-BENEFIT
  5460*    DISPLAY ' SOCK RATE BENE    ' CP-RATING-BENEFIT-AMT
  5461*    DISPLAY ' SOCK ORIG PREM    ' CP-ORIGINAL-PREMIUM
  5462*    DISPLAY ' SOCK ISS AGE      ' CP-ISSUE-AGE
  5463*    DISPLAY ' SOCK DEV CODE     ' CP-DEVIATION-CODE
  5464*    DISPLAY ' SOCK DEV PCT      ' CP-RATE-DEV-PCT
  5465*    DISPLAY ' SOCK APR          ' CP-LOAN-APR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* SOCK03.cbl
  5466*    DISPLAY ' SOCK EXT DAYS     ' CP-TERM-OR-EXT-DAYS
  5467*    DISPLAY ' SOCK LOAN TERM    ' CP-LOAN-TERM
  5468*    DISPLAY ' SOCK SPEC CALC    ' CP-SPECIAL-CALC-CD
  5469*    DISPLAY ' SOCK ST STD ABB   ' CP-STATE-STD-ABBRV
  5470     MOVE WS-STATE-EXT-DAYS-CHG  TO CP-EXT-DAYS-CALC
  5471     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  5472     DISPLAY ' SOCK REF          ' CP-CALC-REFUND
  5473     DISPLAY ' MADE IT BACK FROM ELRFND '
  5474     IF (CP-ERROR-RATE-IS-ZERO)
  5475        OR (CP-ERROR-RATE-NOT-FOUND)
  5476        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5477        STRING ' ERROR WITH LIFE REFUND ' CP-RETURN-CODE
  5478          DELIMITED BY SIZE INTO WS-COMMENT
  5479        END-STRING
  5480        MOVE 'X'                 TO WS-LF-STATUS
  5481        GO TO 0400-EXIT
  5482*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5483*       IF NOT ALREADY-SENT
  5484*          PERFORM 0020-SEND-BUFFER
  5485*                                THRU 0020-EXIT
  5486*          SET ALREADY-SENT      TO TRUE
  5487*       END-IF
  5488*       PERFORM 0025-CLOSE-SOCKET
  5489*                                THRU 0025-EXIT
  5490*       GO TO 0010-RETURN
  5491     END-IF
  5492     MOVE CP-CALC-REFUND         TO WS-LF-REFUND
  5493                                    WS-TOT-LF-RFND
  5494     IF (WS-LF-STATUS = SPACES)
  5495        OR (CP-CALC-REFUND > ZEROS)
  5496        MOVE 'A'                 TO WS-LF-STATUS
  5497     END-IF
  5498     EVALUATE TRUE
  5499        WHEN CP-R-AS-R78
  5500           MOVE 'RULE 78'          TO  WS-LF-METHOD
  5501        WHEN  CP-R-AS-PRORATA
  5502           MOVE 'PRO RATA'         TO  WS-LF-METHOD
  5503        WHEN CP-R-AS-CALIF
  5504           MOVE 'CALIF'            TO  WS-LF-METHOD
  5505        WHEN CP-R-AS-TEXAS
  5506           MOVE 'IRREG'            TO  WS-LF-METHOD
  5507        WHEN CP-REFUND-TYPE-USED IS EQUAL TO 'S'
  5508           MOVE 'UTAH'             TO  WS-LF-METHOD
  5509        WHEN CP-R-AS-FARM-PLAN
  5510           MOVE 'FARM PLAN'        TO  WS-LF-METHOD
  5511        WHEN CP-R-AS-NET-PAY
  5512           MOVE 'NET PAY'          TO  WS-LF-METHOD
  5513        WHEN CP-R-AS-ANTICIPATION
  5514           MOVE 'ANTICIPATION'     TO  WS-LF-METHOD
  5515        WHEN CP-R-AS-MEAN
  5516           MOVE 'MEAN'             TO  WS-LF-METHOD
  5517        WHEN CP-R-AS-SUM-OF-DIGITS
  5518           MOVE 'SUM OF DIGIT'     TO  WS-LF-METHOD
  5519     END-EVALUATE
  5520     IF WS-TOT-LF-RFND > ZEROS
  5521        COMPUTE WS-WORK-FACTOR ROUNDED =
  5522           WS-TOT-LF-RFND / WS-TOT-LF-PREM
  5523        COMPUTE WS-LF-UEC ROUNDED = WS-WORK-FACTOR *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* SOCK03.cbl
  5524           WS-TOT-LF-COMM
  5525     END-IF
  5526     IF ERACCT-FOUND
  5527        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  5528           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  5529        END-IF
  5530        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5531           IF (AM-COMM-CHARGEBACK (1) = 99)
  5532                     OR
  5533              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5534                     OR
  5535              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5536              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5537              MOVE ZEROS         TO WS-LF-UEC
  5538           END-IF
  5539        END-IF
  5540     END-IF
  5541     IF WS-LF-CO-EARNINGS-CALC NOT = 'B'
  5542        GO TO 0400-EXIT
  5543     END-IF
  5544     MOVE 'L'                    TO  CP-BENEFIT-TYPE.
  5545     MOVE '2'                    TO  CP-EARNING-METHOD
  5546                                     CP-RATING-METHOD.
  5547     MOVE CM-LF-ALT-BENEFIT-AMT  TO  CP-ORIGINAL-BENEFIT
  5548                                     CP-REMAINING-BENEFIT
  5549                                     CP-RATING-BENEFIT-AMT.
  5550     IF CP-STATE-STD-ABBRV = 'OR'
  5551         COMPUTE CP-RATING-BENEFIT-AMT = CM-LF-BENEFIT-AMT +
  5552                                         CM-LF-ALT-BENEFIT-AMT.
  5553     MOVE CM-LF-ALT-PREMIUM-AMT  TO  CP-ORIGINAL-PREMIUM.
  5554     MOVE 'LEV'                  TO  CP-DEVIATION-CODE.
  5555     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT.
  5556     IF (CP-ERROR-RATE-IS-ZERO)
  5557        OR (CP-ERROR-RATE-NOT-FOUND)
  5558        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5559        STRING ' ERROR WITH BALLOON REFUND ' CP-RETURN-CODE
  5560          DELIMITED BY SIZE INTO WS-COMMENT
  5561        END-STRING
  5562        MOVE 'X'              TO WS-LF-STATUS
  5563        GO TO 0400-EXIT
  5564*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5565*       IF NOT ALREADY-SENT
  5566*          PERFORM 0020-SEND-BUFFER
  5567*                                THRU 0020-EXIT
  5568*          SET ALREADY-SENT      TO TRUE
  5569*       END-IF
  5570*       PERFORM 0025-CLOSE-SOCKET
  5571*                                THRU 0025-EXIT
  5572*       GO TO 0010-RETURN
  5573     END-IF
  5574     ADD CP-CALC-REFUND          TO WS-TOT-LF-RFND
  5575     MOVE WS-TOT-LF-RFND         TO WS-LF-REFUND
  5576     IF WS-TOT-LF-RFND > ZEROS
  5577        COMPUTE WS-LF-UEC = (WS-TOT-LF-RFND / WS-TOT-LF-PREM) *
  5578           WS-TOT-LF-COMM
  5579     END-IF
  5580     IF ERACCT-FOUND
  5581        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* SOCK03.cbl
  5582           IF (AM-COMM-CHARGEBACK (1) = 99)
  5583                     OR
  5584              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5585                     OR
  5586              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5587              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5588              MOVE ZEROS         TO WS-LF-UEC
  5589           END-IF
  5590        END-IF
  5591     END-IF
  5592     .
  5593 0400-EXIT.
  5594     EXIT.
  5595 0500-PROCESS-AH.
  5596     IF CM-AH-BENEFIT-CD = '  ' OR '00'
  5597        GO TO 0500-EXIT
  5598     END-IF
  5599     MOVE ZEROS                  TO WS-TOT-AH-RFND
  5600                                    WS-TOT-AH-PREM
  5601                                    WS-TOT-AH-COMM
  5602     MOVE CM-AH-LOAN-EXPIRE-DT   TO  DC-BIN-DATE-1
  5603     MOVE ' '                    TO  DC-OPTION-CODE
  5604     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5605     IF NO-CONVERSION-ERROR
  5606        MOVE DC-GREG-DATE-CYMD   TO WS-AH-EXPIRE-DATE
  5607     ELSE
  5608        MOVE ZEROS               TO WS-AH-EXPIRE-DATE
  5609     END-IF
  5610     MOVE CM-AH-BENEFIT-CD       TO WS-AH-BEN-CODE
  5611     MOVE CM-AH-ORIG-TERM        TO WS-AH-TERM
  5612     MOVE WS-AH-OVERRIDE-L1      TO CP-AH-OVERRIDE-CODE
  5613     MOVE CM-CERT-EFF-DT         TO  CP-CERT-EFF-DT.
  5614     MOVE CM-LOAN-1ST-PMT-DT     TO  CP-FIRST-PAY-DATE.
  5615     MOVE WS-BIN-VAL-DT          TO  CP-VALUATION-DT.
  5616     MOVE CM-STATE               TO  CP-STATE.
  5617     MOVE WS-STATE-ABBREVIATION  TO  CP-STATE-STD-ABBRV.
  5618     MOVE 'A'                    TO  CP-BENEFIT-TYPE.
  5619     MOVE WS-AH-SPECIAL-CALC-CD  TO  CP-SPECIAL-CALC-CD.
  5620     MOVE '2'                    TO  CP-PROCESS-TYPE.
  5621     MOVE WS-COMP-ID             TO  CP-COMPANY-ID.
  5622     MOVE CM-COMPANY-CD          TO  CP-COMPANY-CD.
  5623     MOVE WS-ACCT-USER-FLD-5     TO  CP-ACCT-FLD-5.
  5624     MOVE WS-CF-REM-TRM-CALC-OPTION TO CP-REM-TRM-CALC-OPTION
  5625     MOVE WS-CF-CR-REM-TERM-CALC
  5626                                 TO  CP-REM-TERM-METHOD.
  5627     IF WS-AH-CO-REM-TERM-CALC > '0'
  5628         MOVE WS-AH-CO-REM-TERM-CALC
  5629                                 TO  CP-REM-TERM-METHOD.
  5630     IF WS-AH-ST-REM-TERM-CALC > '0'
  5631         MOVE WS-AH-ST-REM-TERM-CALC
  5632                                 TO  CP-REM-TERM-METHOD.
  5633     IF WS-AH-AM-REM-TERM-CALC > '0'
  5634         MOVE WS-AH-AM-REM-TERM-CALC
  5635                                 TO  CP-REM-TERM-METHOD.
  5636     IF (WS-COMP-ID = 'CID')
  5637        AND (CP-STATE-STD-ABBRV = 'WI')
  5638        MOVE '7'                 TO CP-REM-TERM-METHOD
  5639        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* SOCK03.cbl
  5640     END-IF
  5641     IF (WS-COMP-ID = 'CID')
  5642        AND (CP-STATE-STD-ABBRV = 'MO')
  5643        AND (CM-CERT-EFF-DT >= X'9B41')
  5644        AND (CM-CERT-EFF-DT <= X'A2FB')
  5645        MOVE '7'                 TO CP-REM-TERM-METHOD
  5646        MOVE '5'                 TO CP-REM-TRM-CALC-OPTION
  5647     END-IF
  5648     MOVE CM-AH-ORIG-TERM        TO  CP-ORIGINAL-TERM
  5649                                     CP-LOAN-TERM.
  5650     IF  NOT  CP-TERM-IS-DAYS
  5651         IF CM-PMT-EXTENSION-DAYS  IS NUMERIC
  5652             MOVE CM-PMT-EXTENSION-DAYS
  5653                                 TO  CP-TERM-OR-EXT-DAYS
  5654         ELSE
  5655             MOVE ZEROS          TO  CP-TERM-OR-EXT-DAYS.
  5656     MOVE WS-FREE-LOOK           TO CP-FREE-LOOK
  5657     IF CM-AH-COMM-PCT > ZEROS
  5658        COMPUTE WS-TOT-AH-COMM = CM-AH-COMM-PCT *
  5659           CM-AH-PREMIUM-AMT
  5660     END-IF
  5661     MOVE WS-TOT-AH-COMM         TO WS-AH-COMM
  5662     IF WS-AH-STATUS = 'D'
  5663        GO TO 0500-EXIT
  5664     END-IF
  5665     DISPLAY ' BEGIN OPEN AH CLAIM TEST '
  5666     MOVE LOW-VALUES             TO WS-AH-BIN-PAID-THRU-DT
  5667     MOVE ' '                    TO WS-CLM-STOP-SW
  5668     MOVE CM-COMPANY-CD          TO ELMSTR-COMP-CD
  5669     MOVE CM-CERT-NO             TO ELMSTR-CERT-NO
  5670
  5671* EXEC CICS STARTBR
  5672*       DATASET     ('ELMSTR5')
  5673*       RIDFLD      (ELMSTR-KEY)
  5674*       RESP        (WS-RESPONSE)
  5675*    END-EXEC
  5676     MOVE 'ELMSTR5' TO DFHEIV1
  5677     MOVE 0
  5678       TO DFHEIV11
  5679*    MOVE '&,         G          &  N#00005270' TO DFHEIV0
  5680     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5681     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5682     MOVE X'204E233030303035323730' TO DFHEIV0(25:11)
  5683     CALL 'kxdfhei1' USING DFHEIV0,
  5684           DFHEIV1,
  5685           ELMSTR-KEY,
  5686           DFHEIV99,
  5687           DFHEIV11,
  5688           DFHEIV99
  5689     MOVE EIBRESP  TO WS-RESPONSE
  5690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5691     DISPLAY ' AFTER START ' WS-RESPONSE
  5692     IF RESP-NORMAL
  5693        PERFORM WITH TEST AFTER UNTIL I-SAY-TO-STOP
  5694           DISPLAY ' AH READNEXT '
  5695
  5696* EXEC CICS READNEXT
  5697*             DATASET   ('ELMSTR5')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* SOCK03.cbl
  5698*             RIDFLD    (ELMSTR-KEY)
  5699*             INTO      (CLAIM-MASTER)
  5700*             RESP      (WS-RESPONSE)
  5701*          END-EXEC
  5702     MOVE LENGTH OF
  5703      CLAIM-MASTER
  5704       TO DFHEIV12
  5705     MOVE 'ELMSTR5' TO DFHEIV1
  5706     MOVE 0
  5707       TO DFHEIV11
  5708*    MOVE '&.IL                  )  N#00005279' TO DFHEIV0
  5709     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  5710     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5711     MOVE X'204E233030303035323739' TO DFHEIV0(25:11)
  5712     CALL 'kxdfhei1' USING DFHEIV0,
  5713           DFHEIV1,
  5714           CLAIM-MASTER,
  5715           DFHEIV12,
  5716           ELMSTR-KEY,
  5717           DFHEIV99,
  5718           DFHEIV11,
  5719           DFHEIV99,
  5720           DFHEIV99
  5721     MOVE EIBRESP  TO WS-RESPONSE
  5722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5723        IF (RESP-NORMAL OR RESP-DUPKEY)
  5724           AND (CM-COMPANY-CD = CL-COMPANY-CD)
  5725           AND (CM-CERT-NO = CL-CERT-NO)
  5726           IF (CM-ACCOUNT = CL-CERT-ACCOUNT)
  5727              AND (CM-CERT-EFF-DT = CL-CERT-EFF-DT)
  5728              IF (CL-CLAIM-TYPE = 'A' OR 'I' OR 'G')
  5729                 IF CLAIM-IS-OPEN
  5730                    DISPLAY ' FOUND OPEN AH CLAIM '
  5731                    MOVE ' OPEN HEALTH CLAIM '
  5732                                 TO WS-COMMENT
  5733                    MOVE 'H'     TO WS-AH-STATUS
  5734                 ELSE
  5735                    DISPLAY ' FOUND CLOSED AH CLAIM '
  5736                    MOVE ' CLOSED HEALTH CLAIM '
  5737                                 TO WS-COMMENT
  5738                    IF CL-PAID-THRU-DT > WS-AH-BIN-PAID-THRU-DT
  5739                       MOVE CL-PAID-THRU-DT
  5740                                 TO WS-AH-BIN-PAID-THRU-DT
  5741                    END-IF
  5742                 END-IF
  5743              END-IF
  5744           END-IF
  5745        ELSE
  5746           SET I-SAY-TO-STOP TO TRUE
  5747        END-IF
  5748        END-PERFORM
  5749
  5750* EXEC CICS ENDBR
  5751*          DATASET   ('ELMSTR5')
  5752*       END-EXEC
  5753     MOVE 'ELMSTR5' TO DFHEIV1
  5754     MOVE 0
  5755       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* SOCK03.cbl
  5756*    MOVE '&2                    $   #00005311' TO DFHEIV0
  5757     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5758     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5759     MOVE X'2020233030303035333131' TO DFHEIV0(25:11)
  5760     CALL 'kxdfhei1' USING DFHEIV0,
  5761           DFHEIV1,
  5762           DFHEIV11,
  5763           DFHEIV99
  5764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5765     END-IF
  5766     IF WS-AH-BIN-PAID-THRU-DT NOT = LOW-VALUES
  5767*       THIS WILL BE TRUE IF WE FOUND A CLOSED AH CLAIM
  5768        MOVE WS-AH-BIN-PAID-THRU-DT
  5769                                 TO DC-BIN-DATE-1
  5770        MOVE ' '                 TO DC-OPTION-CODE
  5771        PERFORM 9700-DATE-LINK   THRU 9700-EXIT
  5772        IF NO-CONVERSION-ERROR
  5773           MOVE DC-GREG-DATE-CYMD
  5774                                 TO WS-CLM-PAID-THRU-DT
  5775        ELSE
  5776           MOVE 99999999         TO WS-CLM-PAID-THRU-DT
  5777        END-IF
  5778        IF WS-BIN-VAL-DT <= WS-AH-BIN-PAID-THRU-DT
  5779           MOVE 'CAN DT NOT > CLM CLOSE DT '
  5780                                 TO WS-COMMENT
  5781           MOVE 'P'              TO WS-AH-STATUS
  5782           GO TO 0500-EXIT
  5783        END-IF
  5784     END-IF
  5785     PERFORM 0700-LINK-REM-TERM  THRU  0700-EXIT
  5786     IF CM-AH-CURRENT-STATUS = '8'
  5787        IF CM-AH-CANCEL-DT NOT = LOW-VALUES
  5788           MOVE ' AH COVERAGE PREVIOUSLY CANCELLED '
  5789                                 TO WS-COMMENT
  5790           MOVE 'C'              TO WS-AH-STATUS
  5791           GO TO 0500-EXIT
  5792        END-IF
  5793     END-IF
  5794     IF CM-AH-CURRENT-STATUS = '6'  OR  '7'
  5795        IF CM-AH-SETTLEMENT-DT NOT = LOW-VALUES
  5796           MOVE ' SETTLEMENT CLAIM APPLIED '
  5797                                 TO WS-COMMENT
  5798           MOVE 'S'              TO WS-AH-STATUS
  5799*          PERFORM 0030-BUILD-BUFFER
  5800*                                THRU 0030-EXIT
  5801*          IF NOT ALREADY-SENT
  5802*             PERFORM 0020-SEND-BUFFER
  5803*                                THRU 0020-EXIT
  5804*             SET ALREADY-SENT   TO TRUE
  5805*          END-IF
  5806           GO TO 0500-EXIT
  5807*          PERFORM 0025-CLOSE-SOCKET
  5808*                                THRU 0025-EXIT
  5809*          GO TO 0010-RETURN
  5810        END-IF
  5811     END-IF
  5812     IF ((CM-AH-LOAN-EXPIRE-DT < WS-BIN-VAL-DT)
  5813        AND (CM-AH-LOAN-EXPIRE-DT > LOW-VALUES))
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* SOCK03.cbl
  5814        MOVE 'AH COVERAGE EXPIRED '
  5815                                 TO WS-COMMENT
  5816        MOVE 'E'                 TO WS-AH-STATUS
  5817        GO TO 0500-EXIT
  5818     END-IF
  5819     MOVE CM-AH-PREMIUM-AMT      TO WS-TOT-AH-PREM
  5820                                    WS-AH-PREM
  5821     MOVE CM-AH-BENEFIT-AMT      TO WS-AH-ORIG-BENEFIT
  5822     COMPUTE WS-AH-REM-BEN = CM-AH-BENEFIT-AMT
  5823        * CP-REMAINING-TERM-1
  5824     MOVE CP-REMAINING-TERM-1    TO  CP-REMAINING-TERM
  5825                                     WS-AH-REM-TERM
  5826     MOVE WS-AH-CO-REFUND-CALC   TO  CP-EARNING-METHOD.
  5827     MOVE WS-AH-CO-EARNINGS-CALC TO  CP-RATING-METHOD.
  5828     IF WS-AH-ST-REFUND-CALC > ZERO
  5829         MOVE WS-AH-ST-REFUND-CALC
  5830                                 TO  CP-EARNING-METHOD.
  5831     IF WS-AH-FO-REFUND-CALC > ZERO
  5832         MOVE WS-AH-FO-REFUND-CALC
  5833                                 TO  CP-EARNING-METHOD.
  5834*    MOVE CM-RATE-CLASS          TO  CP-CLASS-CODE.
  5835     if ws-comp-id = 'AHL'
  5836        move cm-ah-class-cd      to cp-class-code
  5837        if cp-class-code = spaces
  5838           move zeros            to cp-class-code
  5839        end-if
  5840     else
  5841        MOVE CM-RATE-CLASS       TO  CP-CLASS-CODE
  5842     end-if
  5843     MOVE CM-AH-BENEFIT-CD       TO  CP-BENEFIT-CD.
  5844     MOVE CM-AH-BENEFIT-AMT      TO  CP-ORIGINAL-BENEFIT
  5845                                     CP-RATING-BENEFIT-AMT.
  5846     IF CP-STATE-STD-ABBRV = 'OR'
  5847         COMPUTE CP-RATING-BENEFIT-AMT = CM-AH-BENEFIT-AMT *
  5848                                         CM-AH-ORIG-TERM.
  5849     MOVE CM-AH-PREMIUM-AMT      TO  CP-ORIGINAL-PREMIUM.
  5850     MOVE CM-PAY-FREQUENCY       TO  CP-PAY-FREQUENCY.
  5851     MOVE CM-INSURED-ISSUE-AGE   TO  CP-ISSUE-AGE.
  5852     MOVE CM-AH-DEV-CODE         TO  CP-DEVIATION-CODE.
  5853     MOVE CM-AH-DEV-PCT          TO  CP-RATE-DEV-PCT.
  5854     MOVE CM-LOAN-APR            TO  CP-LOAN-APR.
  5855     MOVE WS-CF-CR-R78-METHOD    TO  CP-R78-OPTION.
  5856     MOVE CM-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  5857     MOVE ' '                    TO  DC-OPTION-CODE.
  5858     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  5859     IF CP-STATE-STD-ABBRV = 'OH'
  5860        IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  5861         IF (CP-ORIGINAL-TERM > 60)
  5862           AND (DC-GREG-DATE-1-YMD > '831101')
  5863           AND (CM-LF-BENEFIT-CD  IS NOT EQUAL TO  ZERO)
  5864             MOVE '6'            TO  CP-EARNING-METHOD
  5865         END-IF
  5866        END-IF
  5867        IF WS-COMP-ID = 'CID'
  5868           IF CM-LF-BENEFIT-CD = (SPACES OR ZEROS OR
  5869                           LOW-VALUES)
  5870              IF CP-CRITICAL-PERIOD
  5871                 MOVE '2'       TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* SOCK03.cbl
  5872              ELSE
  5873                 MOVE '6'       TO CP-EARNING-METHOD
  5874              END-IF
  5875           ELSE
  5876              IF WS-CF-LF-COVERAGE-TYPE = 'L'
  5877                 MOVE '2'       TO CP-EARNING-METHOD
  5878              ELSE
  5879                 IF ((CM-LF-ORIG-TERM > 60) AND
  5880                    (CM-RATE-CLASS NOT = 'L '))
  5881                               OR
  5882                    (WS-LF-CO-EARNINGS-CALC = '5')
  5883                    IF CP-CRITICAL-PERIOD
  5884                       MOVE '2'  TO CP-EARNING-METHOD
  5885                    ELSE
  5886                       MOVE '6'  TO CP-EARNING-METHOD
  5887                    END-IF
  5888                 ELSE
  5889                    MOVE '1'     TO CP-EARNING-METHOD
  5890                 END-IF
  5891              END-IF
  5892           END-IF
  5893        END-IF
  5894     END-IF
  5895     IF CP-STATE-STD-ABBRV = 'VA'
  5896       IF WS-COMP-ID NOT = 'NCL' AND 'CID'
  5897         IF DC-GREG-DATE-1-YMD > '921231'
  5898            IF CP-ORIGINAL-TERM > 61
  5899                MOVE '6'            TO  CP-EARNING-METHOD
  5900            ELSE
  5901                MOVE '1'            TO  CP-EARNING-METHOD.
  5902     IF CP-EARN-AS-NET-PAY
  5903        IF CP-LOAN-APR <= ZEROS
  5904           IF WS-CF-DEFAULT-APR > ZEROS
  5905              MOVE WS-CF-DEFAULT-APR
  5906                                 TO  CP-LOAN-APR
  5907           END-IF
  5908        END-IF
  5909     END-IF
  5910     IF WS-COMP-ID = 'DCC'
  5911        IF (WS-AH-BEN-CATEGORY = 'G' OR 'L')
  5912           AND (CP-EARNING-METHOD NOT = 'G')
  5913           MOVE 'S'              TO CP-EARNING-METHOD
  5914        END-IF
  5915     END-IF
  5916     PERFORM 0720-LINK-REFUND  THRU  0720-EXIT
  5917     IF (CP-ERROR-RATE-IS-ZERO)
  5918        OR (CP-ERROR-RATE-NOT-FOUND)
  5919        OR (CP-ERROR-RATE-FILE-NOTOPEN)
  5920        STRING ' ERROR WITH AH REFUND ' CP-RETURN-CODE
  5921          DELIMITED BY SIZE INTO WS-COMMENT
  5922        END-STRING
  5923        IF WS-AH-STATUS NOT = 'H'
  5924           MOVE 'X'                 TO WS-AH-STATUS
  5925        END-IF
  5926        GO TO 0500-EXIT
  5927*       PERFORM 0030-BUILD-BUFFER THRU 0030-EXIT
  5928*       IF NOT ALREADY-SENT
  5929*          PERFORM 0020-SEND-BUFFER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* SOCK03.cbl
  5930*                                THRU 0020-EXIT
  5931*          SET ALREADY-SENT      TO TRUE
  5932*       END-IF
  5933*       PERFORM 0025-CLOSE-SOCKET
  5934*                                THRU 0025-EXIT
  5935*       GO TO 0010-RETURN
  5936     END-IF
  5937     MOVE CP-CALC-REFUND         TO WS-AH-REFUND
  5938                                    WS-TOT-AH-RFND
  5939     MOVE CP-REFUND-TYPE-USED    TO WS-AH-METHOD
  5940     IF ((WS-AH-STATUS = SPACES)
  5941        OR (CP-CALC-REFUND > ZEROS))
  5942                  AND
  5943          (WS-AH-STATUS NOT = 'H')
  5944        MOVE 'A'                 TO WS-AH-STATUS
  5945     END-IF
  5946     EVALUATE TRUE
  5947        WHEN CP-R-AS-R78
  5948           MOVE 'RULE 78'          TO  WS-AH-METHOD
  5949        WHEN CP-R-AS-PRORATA
  5950           MOVE 'PRO RATA'         TO  WS-AH-METHOD
  5951        WHEN CP-REFUND-TYPE-USED = '3'
  5952           MOVE 'CALIF'            TO  WS-AH-METHOD
  5953        WHEN CP-R-AS-TEXAS
  5954           MOVE 'IRREG'            TO  WS-AH-METHOD
  5955        WHEN CP-R-AS-FARM-PLAN
  5956           MOVE 'FARM PLAN'        TO  WS-AH-METHOD
  5957        WHEN CP-R-AS-NET-PAY
  5958           MOVE 'NET PAY'          TO  WS-AH-METHOD
  5959        WHEN CP-R-AS-ANTICIPATION
  5960           MOVE 'ANTICIPATION'     TO  WS-AH-METHOD
  5961        WHEN CP-R-AS-MEAN
  5962           MOVE 'MEAN'             TO  WS-AH-METHOD
  5963        WHEN CP-R-AS-SUM-OF-DIGITS
  5964           MOVE 'SUM OF DIGIT'     TO  WS-AH-METHOD
  5965        WHEN CP-GAP-ACTUARIAL
  5966           MOVE 'SP ACTUARIAL'     TO WS-AH-METHOD
  5967     END-EVALUATE
  5968     IF WS-TOT-AH-RFND > ZEROS
  5969        COMPUTE WS-WORK-FACTOR ROUNDED =
  5970           WS-TOT-AH-RFND / WS-TOT-AH-PREM
  5971        COMPUTE WS-AH-UEC ROUNDED = WS-WORK-FACTOR *
  5972           WS-TOT-AH-COMM
  5973     END-IF
  5974     IF ERACCT-FOUND
  5975        IF AM-COMM-CHARGEBACK (1) NOT NUMERIC
  5976           MOVE ZEROS            TO AM-COMM-CHARGEBACK (1)
  5977        END-IF
  5978        IF AM-COMM-CHARGEBACK (1) NOT = ZEROS
  5979           IF (AM-COMM-CHARGEBACK (1) = 99)
  5980                     OR
  5981              (WS-NCB-DIFF-MONTHS > AM-COMM-CHARGEBACK (1))
  5982                     OR
  5983              ((WS-NCB-DIFF-MONTHS = AM-COMM-CHARGEBACK (1))
  5984              AND (WS-NCB-DIFF-ODD-DAYS > ZEROS))
  5985              MOVE ZEROS         TO WS-AH-UEC
  5986           END-IF
  5987        END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* SOCK03.cbl
  5988     END-IF
  5989     .
  5990 0500-EXIT.
  5991     EXIT.
  5992 0700-LINK-REM-TERM.
  5993
  5994* EXEC CICS LINK
  5995*        PROGRAM   ('ELRTRM')
  5996*        COMMAREA  (CALCULATION-PASS-AREA)
  5997*        LENGTH    (CP-COMM-LENGTH)
  5998*    END-EXEC.
  5999     MOVE 'ELRTRM' TO DFHEIV1
  6000*    MOVE '."C                   ''   #00005542' TO DFHEIV0
  6001     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6002     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6003     MOVE X'2020233030303035353432' TO DFHEIV0(25:11)
  6004     CALL 'kxdfhei1' USING DFHEIV0,
  6005           DFHEIV1,
  6006           CALCULATION-PASS-AREA,
  6007           CP-COMM-LENGTH,
  6008           DFHEIV99,
  6009           DFHEIV99,
  6010           DFHEIV99
  6011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6012
  6013 0700-EXIT.
  6014     EXIT.
  6015 0710-LINK-REM-AMOUNT.
  6016
  6017* EXEC CICS LINK
  6018*        PROGRAM   ('ELRAMT')
  6019*        COMMAREA  (CALCULATION-PASS-AREA)
  6020*        LENGTH    (CP-COMM-LENGTH)
  6021*    END-EXEC
  6022     MOVE 'ELRAMT' TO DFHEIV1
  6023*    MOVE '."C                   ''   #00005550' TO DFHEIV0
  6024     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6025     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6026     MOVE X'2020233030303035353530' TO DFHEIV0(25:11)
  6027     CALL 'kxdfhei1' USING DFHEIV0,
  6028           DFHEIV1,
  6029           CALCULATION-PASS-AREA,
  6030           CP-COMM-LENGTH,
  6031           DFHEIV99,
  6032           DFHEIV99,
  6033           DFHEIV99
  6034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6035     .
  6036 0710-EXIT.
  6037     EXIT.
  6038 0720-LINK-REFUND.
  6039
  6040* EXEC CICS LINK
  6041*        PROGRAM   ('ELRFND')
  6042*        COMMAREA  (CALCULATION-PASS-AREA)
  6043*        LENGTH    (CP-COMM-LENGTH)
  6044*    END-EXEC
  6045     MOVE 'ELRFND' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* SOCK03.cbl
  6046*    MOVE '."C                   ''   #00005559' TO DFHEIV0
  6047     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6048     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6049     MOVE X'2020233030303035353539' TO DFHEIV0(25:11)
  6050     CALL 'kxdfhei1' USING DFHEIV0,
  6051           DFHEIV1,
  6052           CALCULATION-PASS-AREA,
  6053           CP-COMM-LENGTH,
  6054           DFHEIV99,
  6055           DFHEIV99,
  6056           DFHEIV99
  6057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6058     .
  6059 0720-EXIT.
  6060     EXIT.
  6061 9700-DATE-LINK.
  6062
  6063* EXEC CICS LINK
  6064*         PROGRAM  ('ELDATCV')
  6065*         COMMAREA (DATE-CONVERSION-DATA)
  6066*         LENGTH   (DC-COMM-LENGTH)
  6067*    END-EXEC.
  6068     MOVE 'ELDATCV' TO DFHEIV1
  6069*    MOVE '."C                   ''   #00005568' TO DFHEIV0
  6070     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6071     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6072     MOVE X'2020233030303035353638' TO DFHEIV0(25:11)
  6073     CALL 'kxdfhei1' USING DFHEIV0,
  6074           DFHEIV1,
  6075           DATE-CONVERSION-DATA,
  6076           DC-COMM-LENGTH,
  6077           DFHEIV99,
  6078           DFHEIV99,
  6079           DFHEIV99
  6080     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6081
  6082 9700-EXIT.
  6083      EXIT.
  6084
  6085 9999-DFHBACK SECTION.
  6086     MOVE '9%                    "   ' TO DFHEIV0
  6087     MOVE 'SOCK03' TO DFHEIV1
  6088     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6089     GOBACK.
  6090 9999-DFHEXIT.
  6091     IF DFHEIGDJ EQUAL 0001
  6092         NEXT SENTENCE.
  6093     MOVE '9%                    "   ' TO DFHEIV0
  6094     MOVE 'SOCK03' TO DFHEIV1
  6095     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6096     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       16688     Code:       24947
